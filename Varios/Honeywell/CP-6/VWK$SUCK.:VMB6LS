VERSION B06

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:1    
        1        1        /*M* VWK$SUCK - Send transfer request to a distant node. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*F**
        9        9        *
       10       10        *   NAME:  VWK$SUCK
       11       11        *
       12       12        *   PURPOSE:
       13       13        *       To generate a remote file retrieval request packet.
       14       14        *
       15       15        *   DESCRIPTION:
       16       16        *       SUCK generates a remote file retrieval request packet (SUCK) to
       17       17        *       be shipped to a distant system.  The file to be retrieved exists
       18       18        *       on that system.
       19       19        *
       20       20        *   REFERENCE:
       21       21        *       See the appropriate Architecture File document for a description
       22       22        *       of a SUCK packet.
       23       23        *
       24       24        ****/
       25       25
       26       26        /*D**
       27       27        *
       28       28        *   NAME:  VWK$SUCK
       29       29        *
       30       30        *   CALL:
       31       31        *       CALL VWK$SUCK ALTRET...
       32       32        *
       33       33        *   PARAMETERS:
       34       34        *       None.
       35       35        *
       36       36        *   INTERFACE:
       37       37        *       Calls VWX$MAIL (MOVE's version), VWH$HEADER, VWF$FOOTER, and
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:2    
       38       38        *       VWO$TRANSO.
       39       39        *
       40       40        *   ENVIRONMENT:
       41       41        *       The VW_OPTIONS# block must have been filled in by the caller,
       42       42        *       MOVE.
       43       43        *
       44       44        *   INPUT:
       45       45        *       Data from the SUCK block in VW_OPTIONS# is used to direct the
       46       46        *       packet.  VW_SCRAMBLE# is consulted for scrambling information.
       47       47        *       VW_IAM# is consulted for the name of the "home" node.
       48       48        *
       49       49        *   OUTPUT:
       50       50        *       VW_OUTCNT# may be modified.
       51       51        *
       52       52        *   SCRATCH:
       53       53        *       None.
       54       54        *
       55       55        *   DESCRIPTION:
       56       56        *       The SUCK subroutine packages a retrieval request for transmis-
       57       57        *       sion and sends it across the HASP link.  It expects to find the
       58       58        *       VW_OPTIONS# block filled in by the calling program.  Communication
       59       59        *       back to the sender is accomplished via the MAIL subprogram,
       60       60        *       which is different for the MOVE program and the SCOTTY ghost.
       61       61        *       The BREAK subroutine is not used.  ALTRET is taken if the
       62       62        *       transport process aborts.
       63       63        *
       64       64        ****/
       65       65
       66       66        VWK$SUCK: PROC ALTRET;
       67       67
       68       68        /****
       69       69        *
       70       70        *   %INCLUDEs
       71       71        *
       72       72        ****/
       73       73
       74       74        %INCLUDE CP_6;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:3    
       75     5633        %INCLUDE CP_6_SUBS;
       76     6173        %INCLUDE VW_MOVE_E;
       77     6251        %INCLUDE VWM_ERRS_E;
       78     6625        %INCLUDE VW_OPTS_M;
       79     7309        %MOVE_OPTIONS;
       80     7812        %INCLUDE VW_NODEATER_E;
       81     7868        %INCLUDE VW_FPTS_M;
       82     8289
       83     8290        /****
       84     8291        *
       85     8292        *   FPTs
       86     8293        *
       87     8294        ****/
       88     8295
       89     8296        %FPT_OPEN(FPTN=OPEN_INP,
       90     8297                  NAME=NAME_INP,
       91     8298                  ACCT=ACCT_INP,
       92     8299                  PASS=PASS_INP,
       93     8300                  SN=SN_INP);
       94     8409
       95     8410        %VLP_NAME(FPTN=NAME_INP,
       96     8411                  LEN=31,
       97     8412                  NAME=' ');
       98     8439
       99     8440        %VLP_ACCT(FPTN=ACCT_INP,
      100     8441                  ACCT='        ');
      101     8454
      102     8455        %VLP_PASS(FPTN=PASS_INP,
      103     8456                  PASS='        ');
      104     8469
      105     8470        %VLP_SN(FPTN=SN_INP,
      106     8471                N=6);
      107     8484
      108     8485        %FPT_FID(FPTN=FID_INP,
      109     8486                 NAME=NAME_INP,
      110     8487                 ACCT=ACCT_INP,
      111     8488                 PASS=PASS_INP,
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:4    
      112     8489                 SN=SN_INP,
      113     8490                 ASN=OPEN_INP.V.ASN#,
      114     8491                 RES=OPEN_INP.V.RES#,
      115     8492                 RESULTS=VLR_INP);
      116     8515
      117     8516        %VLR_FID(FPTN=VLR_INP);
      118     8535
      119     8536        %FPT_OPEN(FPTN=OPEN_OUT,
      120     8537                  DCB=M$OUT,
      121     8538                  NAME=NAME_OUT,
      122     8539                  ACCT=ACCT_OUT,
      123     8540                  PASS=PASS_OUT,
      124     8541                  SN=SN_OUT,
      125     8542                  FUN=IN,
      126     8543                  SCRUB=YES,
      127     8544                  EXIST=OLDFILE,
      128     8545                  TEST=YES);
      129     8654
      130     8655        %VLP_NAME(FPTN=NAME_OUT,
      131     8656                  LEN=31,
      132     8657                  NAME=' ');
      133     8684
      134     8685        %VLP_ACCT(FPTN=ACCT_OUT,
      135     8686                  ACCT='        ');
      136     8699
      137     8700        %VLP_PASS(FPTN=PASS_OUT,
      138     8701                  PASS='        ');
      139     8714
      140     8715        %VLP_SN(FPTN=SN_OUT,
      141     8716                N=6);
      142     8729
      143     8730        %FPT_FID(FPTN=FID_OUT,
      144     8731                 NAME=NAME_OUT,
      145     8732                 ACCT=ACCT_OUT,
      146     8733                 PASS=PASS_OUT,
      147     8734                 SN=SN_OUT,
      148     8735                 ASN=OPEN_OUT.V.ASN#,
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:5    
      149     8736                 RES=OPEN_OUT.V.RES#,
      150     8737                 RESULTS=VLR_OUT);
      151     8760
      152     8761        %VLR_FID(FPTN=VLR_OUT);
      153     8780
      154     8781        %FPT_UNFID(FPTN=UNFID_INP,
      155     8782                   ACCT=ACCT_INP,
      156     8783                   ASN=OPEN_INP.V.ASN#,
      157     8784                   NAME=NAME_INP,
      158     8785                   RES=OPEN_INP.V.RES#,
      159     8786                   SN=SN_INP);
      160     8804
      161     8805        %FPT_UNFID(FPTN=UNFID_OUT,
      162     8806                   ACCT=ACCT_OUT,
      163     8807                   ASN=OPEN_OUT.V.ASN#,
      164     8808                   NAME=NAME_OUT,
      165     8809                   RES=OPEN_OUT.V.RES#,
      166     8810                   SN=SN_OUT);
      167     8828
      168     8829        %FPT_OPEN(FPTN=OPEN_JE,
      169     8830                  DCB=M$JE,
      170     8831                  ASN=DEVICE,
      171     8832                  RES='JE  ',
      172     8833                  FUN=CREATE,
      173     8834                  EXIST=ERROR,
      174     8835                  SCRUB=YES,
      175     8836                  WSN=WSN_JE);
      176     8945
      177     8946        %VLP_WSN(FPTN=WSN_JE,
      178     8947                 WSN='        ');
      179     8960
      180     8961        %FPT_WRITE(FPTN=WRITE_JE,
      181     8962                   DCB=M$JE);
      182     8993
      183     8994        %FPT_CLOSE(FPTN=CLOSE_JE,
      184     8995                   DCB=M$JE,
      185     8996                   DISP=SAVE);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:6    
      186     9038
      187     9039        %FPT_JOBSTATS(ORDER=CHECKF,
      188     9040                      CRITERIA=VLP_CRITERIA,
      189     9041                      RESULTS=VLR_JOBSTATS_CHECK);
      190     9061
      191     9062        %VLP_CRITERIA;
      192     9090
      193     9091                  %VLR_JOBSTATS_CHECK;
      194     9110
      195     9111        %FPT_WAIT(UNITS=1);
      196     9125
      197     9126        %B$TCB;
      198     9129
      199     9130        %B$ALT;
      200     9138
      201     9139        %F$DCB(DCBN=DUMMY);
      202     9196
      203     9197        /****
      204     9198        *
      205     9199        *   Local variables.
      206     9200        *
      207     9201        ****/
      208     9202
      209     9203    1   DCL M$OUT                          DCB;
      210     9204    1   DCL M$JE                           DCB;
      211     9205    1   DCL M$LM                           DCB;
      212     9206    1   DCL M$NODE                         DCB;
      213     9207
      214     9208    1   DCL VWX$MAIL                       ENTRY(5);
      215     9209    1   DCL VWH$HEADER                     ENTRY(3) ALTRET;
      216     9210    1   DCL VWF$FOOTER                     ENTRY(3) ALTRET;
      217     9211    1   DCL VWO$TRANSO                     ENTRY(1);
      218     9212
      219     9213    1   DCL I                              SBIN;
      220     9214    1   DCL J                              SBIN;
      221     9215    1   DCL K                              SBIN;
      222     9216    1   DCL VW_OUTCNT# SYMREF              SBIN;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:7    
      223     9217    1   DCL VW_BROKEN# SYMREF              SBIN;
      224     9218    1   DCL ERRDCB                         SBIN;
      225     9219
      226     9220    1   DCL ERRCODE                        SBIN;
      227     9221    1   DCL 1 ERRBITS REDEF ERRCODE,
      228     9222    1         2 FCG                        UNAL BIT(18),
      229     9223    1         2 M                          UNAL BIT(1),
      230     9224    1         2 CODE                       UNAL UBIN(14),
      231     9225    1         2 SEV                        UNAL UBIN(3);
      232     9226
      233     9227
      234     9228    1   DCL B$TCB$ SYMREF                  PTR;
      235     9229    1   DCL JEPTR                          PTR;
      236     9230
      237     9231    1   DCL FITBUF                         CHAR(4096);
      238     9232    1   DCL LOBUF                          CHAR(256);
      239     9233    1   DCL JEBUF                          CHAR(80);
      240     9234    1   DCL TWORK                          CHAR(12);
      241     9235    1   DCL DWORK                          CHAR(8);
      242     9236    1   DCL VW_IAM# SYMREF                 CHAR(8);
      243     9237
      244     9238    1   DCL VW_SCRAMBLE# SYMREF            BIT(1);
      245     9239
      246     9240    1   DCL 1 U1,
      247     9241    1         2 L UNAL                     UBIN BYTE,
      248     9242    1         2 C UNAL                     CHAR(79);
      249     9243    1   DCL 1 U2,
      250     9244    1         2 L UNAL                     UBIN BYTE,
      251     9245    1         2 C UNAL                     CHAR(79);
      252     9246    1   DCL 1 U3,
      253     9247    1         2 L UNAL                     UBIN BYTE,
      254     9248    1         2 C UNAL                     CHAR(79);
      255     9249    1   DCL 1 U4,
      256     9250    1         2 L UNAL                     UBIN BYTE,
      257     9251    1         2 C UNAL                     CHAR(79);
      258     9252
      259     9253        %EJECT;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:8    
      260     9254        /****
      261     9255        *
      262     9256        *   Initialize FPTs.
      263     9257        *
      264     9258        ****/
      265     9259
      266     9260    1           JEPTR=DCBADDR(DCBNUM(M$JE));
      267     9261    1           NAME_OUT.L#=31;
      268     9262    1           SN_OUT.NUM#=6;
      269     9263    1           WRITE_JE.BUF_.BUF$=ADDR(JEBUF);
      270     9264    1           WRITE_JE.BUF_.BOUND=79;
      271     9265    1           UNFID_INP.TEXTFID_=VECTOR(U1.C);
      272     9266    1           UNFID_INP.LEN_=VECTOR(I);
      273     9267    1           UNFID_OUT.TEXTFID_=VECTOR(U2.C);
      274     9268    1           UNFID_OUT.LEN_=VECTOR(I);
      275     9269    1           NODEKEY.L=8;
      276     9270
      277     9271        /****
      278     9272        *
      279     9273        *   Check output node to make sure it exists.
      280     9274        *
      281     9275        ****/
      282     9276
      283     9277    2           IF OPTS.OUT.NODE~=' ' AND OPTS.OUT.NODE~=VW_IAM# THEN DO;
      284     9278    2              NODEKEY.C=OPTS.OUT.NODE;
      285     9279    2              CALL M$READ(READ_NODE) ALTRET(SUCK_BAD_DST);
      286     9280    2              END;
      287     9281    1           ELSE
      288     9282    1              OPTS.OUT.NODE=VW_IAM#;
      289     9283
      290     9284        /****
      291     9285        *
      292     9286        *   Check input node to make sure it exists, then open the JE stream.
      293     9287        *
      294     9288        ****/
      295     9289
      296     9290    1           NODEKEY.C=OPTS.INP.NODE;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:9    
      297     9291    1           CALL M$READ(READ_NODE) ALTRET(SUCK_BAD_SRC);
      298     9292    2           IF DCBADDR(DCBNUM(M$NODE))->DUMMY.ARS#=8 THEN DO;
      299     9293    2              NODEKEY.C=NODEOVR.PATH_NAME;
      300     9294    2              CALL M$READ(READ_NODE) ALTRET(SUCK_BAD_SRC);
      301     9295    2              END;
      302     9296    1           WSN_JE.WSN#=NODEOVR.PATH_NAME;
      303     9297    1           CALL M$OPEN(OPEN_JE) ALTRET(SUCK_BAD_NODE);
      304     9298
      305     9299        /****
      306     9300        *
      307     9301        *   Work with input FID to make sure it is a legal FID.
      308     9302        *
      309     9303        ****/
      310     9304
      311     9305    2           IF SUBSTR(OPTS.INP.FID,0,1)~='''' THEN DO;
      312     9306    2              I=OPTS.INP.L-ASCBIN('/');
      313     9307    2              IF I<1 OR I>79 THEN
      314     9308    2                 GOTO SUCK_BAD_ITL;
      315     9309    2              FID_INP.TEXTFID_=VECTOR(SUBSTR(OPTS.INP.FID,0,I));
      316     9310    2              CALL M$FID(FID_INP) ALTRET(SUCK_BAD_INP);
      317     9311    2              END;
      318     9312
      319     9313        /****
      320     9314        *
      321     9315        *   Work with output FID to make sure it is a legal FID.
      322     9316        *
      323     9317        ****/
      324     9318
      325     9319    2           IF SUBSTR(OPTS.OUT.FID,0,1)~='''' THEN DO;
      326     9320    2              I=OPTS.OUT.L-ASCBIN('/');
      327     9321    2              IF I<1 OR I>79 THEN
      328     9322    2                 GOTO SUCK_BAD_OTL;
      329     9323    2              FID_OUT.TEXTFID_=VECTOR(SUBSTR(OPTS.OUT.FID,0,I));
      330     9324    2              CALL M$FID(FID_OUT) ALTRET(SUCK_BAD_OUT);
      331     9325    2              END;
      332     9326
      333     9327        /****
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:10   
      334     9328        *
      335     9329        *   Tell the user what's happening ("Moving FID@wsn to FID@wsn...")
      336     9330        *
      337     9331        ****/
      338     9332
      339     9333    2           IF SUBSTR(OPTS.INP.FID,0,1)='''' THEN DO;
      340     9334    2              U1.C=OPTS.INP.FID;
      341     9335    2              I=OPTS.INP.L-ASCBIN('/');
      342     9336    2              END;
      343     9337    1           ELSE
      344     9338    1              CALL M$UNFID(UNFID_INP);
      345     9339    2           IF OPTS.INP.NODE~=VW_IAM# THEN DO;
      346     9340    2              CALL INSERT(U1.C,I,,'@',OPTS.INP.NODE);
      347     9341    2              CALL INDEX(I,'  ',U1.C,I);
      348     9342    2              END;
      349     9343    1           U1.L=I;
      350     9344
      351     9345    2           IF SUBSTR(OPTS.OUT.FID,0,1)='''' THEN DO;
      352     9346    2              U2.C=OPTS.OUT.FID;
      353     9347    2              I=OPTS.OUT.L-ASCBIN('/');
      354     9348    2              END;
      355     9349    1           ELSE
      356     9350    1              CALL M$UNFID(UNFID_OUT);
      357     9351    2           IF OPTS.OUT.NODE~=VW_IAM# THEN DO;
      358     9352    2              CALL INSERT(U2.C,I,,'@',OPTS.OUT.NODE);
      359     9353    2              CALL INDEX(I,'  ',U2.C,I);
      360     9354    2              END;
      361     9355    1           U2.L=I;
      362     9356
      363     9357    1           CALL VWX$MAIL(%E$VWM_MOV,VECTOR(U1),VECTOR(U2));
      364     9358
      365     9359        /****
      366     9360        *
      367     9361        *   Build the header appropriate for this system.
      368     9362        *
      369     9363        ****/
      370     9364
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:11   
      371     9365    1           OPTS.INP.NODE=NODEKEY.C;
      372     9366    1           I=NODEOVR.TYPE_PATH;
      373     9367    1           CALL VWH$HEADER(DCBNUM(M$JE),JEBUF,I) ALTRET(SUCK_BAD_WRJ);
      374     9368
      375     9369        /****
      376     9370        *
      377     9371        *   Ship the header block information, four "cards" (SUCK and BEAM).
      378     9372        *
      379     9373        ****/
      380     9374
      381     9375    1           VW_SCRAMBLE#=OPTS.INP.MISC.TRAN;
      382     9376
      383     9377    1           JEBUF=CARD(0);
      384     9378    1           IF VW_SCRAMBLE# THEN
      385     9379    1              CALL VWO$TRANSO(JEBUF);
      386     9380    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      387     9381    1           JEBUF=CARD(1);
      388     9382    1           IF VW_SCRAMBLE# THEN
      389     9383    1              CALL VWO$TRANSO(JEBUF);
      390     9384    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      391     9385
      392     9386    1           JEBUF=CARD(2);
      393     9387    1           IF VW_SCRAMBLE# THEN
      394     9388    1              CALL VWO$TRANSO(JEBUF);
      395     9389    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      396     9390    1           JEBUF=CARD(3);
      397     9391    1           IF VW_SCRAMBLE# THEN
      398     9392    1              CALL VWO$TRANSO(JEBUF);
      399     9393    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      400     9394    1           VW_OUTCNT#=5;
      401     9395
      402     9396        /****
      403     9397        *
      404     9398        *   Send the sender MAIL records if needed.
      405     9399        *
      406     9400        ****/
      407     9401
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:12   
      408     9402    2           IF OPTS.MAILSNDR.WHO~=' ' THEN DO;
      409     9403    2              JEBUF=CARD(4);
      410     9404    2              IF VW_SCRAMBLE# THEN
      411     9405    2                 CALL VWO$TRANSO(JEBUF);
      412     9406    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      413     9407    2              JEBUF=CARD(5);
      414     9408    2              IF VW_SCRAMBLE# THEN
      415     9409    2                 CALL VWO$TRANSO(JEBUF);
      416     9410    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      417     9411    2              VW_OUTCNT#=VW_OUTCNT#+2;
      418     9412    2              END;
      419     9413
      420     9414        /****
      421     9415        *
      422     9416        *   Send the receiver MAIL records if needed.
      423     9417        *
      424     9418        ****/
      425     9419
      426     9420    2           IF OPTS.MAILRCVR.WHO~=' ' THEN DO;
      427     9421    2              JEBUF=CARD(6);
      428     9422    2              IF VW_SCRAMBLE# THEN
      429     9423    2                 CALL VWO$TRANSO(JEBUF);
      430     9424    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      431     9425    2              JEBUF=CARD(7);
      432     9426    2              IF VW_SCRAMBLE# THEN
      433     9427    2                 CALL VWO$TRANSO(JEBUF);
      434     9428    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      435     9429    2              VW_OUTCNT#=VW_OUTCNT#+2;
      436     9430    2              END;
      437     9431
      438     9432        /****
      439     9433        *
      440     9434        *   Send the initiator MAIL records if needed.
      441     9435        *
      442     9436        ****/
      443     9437
      444     9438    2           IF OPTS.MAILINIT.WHO~=' ' THEN DO;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:13   
      445     9439    2              JEBUF=CARD(8);
      446     9440    2              IF VW_SCRAMBLE# THEN
      447     9441    2                 CALL VWO$TRANSO(JEBUF);
      448     9442    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      449     9443    2              JEBUF=CARD(9);
      450     9444    2              IF VW_SCRAMBLE# THEN
      451     9445    2                 CALL VWO$TRANSO(JEBUF);
      452     9446    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      453     9447    2              VW_OUTCNT#=VW_OUTCNT#+2;
      454     9448    2              END;
      455     9449
      456     9450        /****
      457     9451        *
      458     9452        *   Send the options records, if any.
      459     9453        *
      460     9454        ****/
      461     9455
      462     9456    1           I=10;
      463     9457    2           DO WHILE(I<LENGTHC(OPTS)/80 AND SUBSTR(CARD(I),0,4)='OPTS');
      464     9458    2              JEBUF=CARD(I);
      465     9459    2              IF VW_SCRAMBLE# THEN
      466     9460    2                 CALL VWO$TRANSO(JEBUF);
      467     9461    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
      468     9462    2              VW_OUTCNT#=VW_OUTCNT#+1;
      469     9463    2              I=I+1;
      470     9464    2              END;
      471     9465
      472     9466        /****
      473     9467        *
      474     9468        *   Supply the footer appropriate for this system.
      475     9469        *
      476     9470        ****/
      477     9471
      478     9472    1           I=NODEOVR.TYPE_PATH;
      479     9473    1           CALL VWF$FOOTER(DCBNUM(M$JE),JEBUF,I) ALTRET(SUCK_BAD_WRJ);
      480     9474
      481     9475        /****
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:14   
      482     9476        *
      483     9477        *   Ship it, then tell the user what happened.
      484     9478        *
      485     9479        ****/
      486     9480
      487     9481    1           CLOSE_JE.V.DISP#=%SAVE#;
      488     9482    1           CALL M$CLOSE(CLOSE_JE) ALTRET(SUCK_BAD_ONE);
      489     9483
      490     9484        /****
      491     9485        *
      492     9486        *   Fetch the symbiont file name from the DCB (assigned after M$CLOSE)
      493     9487        *   and format it into "sysid-subid", suppressing leading zeros.
      494     9488        *
      495     9489        ****/
      496     9490
      497     9491    1           TWORK=SUBSTR(JEPTR->DUMMY.NAME#.C,3,12);
      498     9492    1           I=0;
      499     9493    2           DO WHILE(SUBSTR(TWORK,I,1)='0');
      500     9494    2              I=I+1;
      501     9495    2              END;
      502     9496    1           J=6;
      503     9497    2           DO WHILE(SUBSTR(TWORK,J,1)='0');
      504     9498    2              J=J+1;
      505     9499    2              END;
      506     9500    1           CALL CONCAT(U3.C,SUBSTR(TWORK,I,6-I),'-',SUBSTR(TWORK,J,12-J));
      507     9501    1           U3.L=19-I-J;
      508     9502
      509     9503        /****
      510     9504        *
      511     9505        *   Get the status of the output.  It is necessary to relinquish control
      512     9506        *   of the system (via M$WAIT) to allow the system to do something with
      513     9507        *   the output file so that JOBSTATS knows about it.  This may result in
      514     9508        *   the file being "lost", if it is small and transmitted during the
      515     9509        *   M$WAIT interval.
      516     9510        *
      517     9511        ****/
      518     9512
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:15   
      519     9513    1           CALL CHARBIN(I,SUBSTR(JEPTR->DUMMY.NAME#.C,3,6));
      520     9514    1           FPT_JOBSTATS.V.SYSID#=I;
      521     9515    1           CALL CHARBIN(I,SUBSTR(JEPTR->DUMMY.NAME#.C,9,6));
      522     9516    1           FPT_JOBSTATS.V.NUM#=I;
      523     9517    1           CALL M$WAIT(FPT_WAIT);
      524     9518    1           VLP_CRITERIA.WSN#=OPTS.OUT.NODE;
      525     9519    1           CALL M$JOBSTATS(FPT_JOBSTATS);
      526     9520
      527     9521    2           IF VLR_JOBSTATS_CHECK.FCODE=%FS_PWAIT# THEN DO;
      528     9522    2              CALL BINCHAR(DWORK,VLR_JOBSTATS_CHECK.AHEAD);
      529     9523    2              K=0;
      530     9524    3              DO WHILE(K<7 AND SUBSTR(DWORK,K,1)='0');
      531     9525    3                 K=K+1;
      532     9526    3                 END;
      533     9527    2              U4.C=SUBSTR(DWORK,K,8-K);
      534     9528    2              U4.L=8-K;
      535     9529    2              CALL VWX$MAIL(%E$VWM_XWT,VECTOR(U3),VECTOR(U4));
      536     9530    2              END;
      537     9531    2           ELSE IF VLR_JOBSTATS_CHECK.FCODE=%FS_PRT# THEN DO;
      538     9532    2                 U4.C=VLR_JOBSTATS_CHECK.DEVNAME;
      539     9533    2                 U4.L=4;
      540     9534    2                 CALL VWX$MAIL(%E$VWM_XMT,VECTOR(U3),VECTOR(U4));
      541     9535    2                 END;
      542     9536    2              ELSE DO;
      543     9537    2                 CALL VWX$MAIL(%E$VWM_XBB,VECTOR(U3));
      544     9538    2                 END;
      545     9539
      546     9540        /****
      547     9541        *
      548     9542        *   Return to caller.
      549     9543        *
      550     9544        ****/
      551     9545
      552     9546    1           RETURN;
      553     9547
      554     9548        /****
      555     9549        *
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:16   
      556     9550        *   Input FID too long.
      557     9551        *
      558     9552        ****/
      559     9553
      560     9554    1   SUCK_BAD_ITL:
      561     9555    1           ERRCODE=%E$VWM_ITL;
      562     9556    1           GOTO SUCK_USRERR;
      563     9557
      564     9558        /****
      565     9559        *
      566     9560        *   Output FID too long.
      567     9561        *
      568     9562        ****/
      569     9563
      570     9564    1   SUCK_BAD_OTL:
      571     9565    1           ERRCODE=%E$VWM_OTL;
      572     9566    1           GOTO SUCK_USRERR;
      573     9567
      574     9568        /****
      575     9569        *
      576     9570        *   Error from M$FID on input FID.
      577     9571        *
      578     9572        ****/
      579     9573
      580     9574    1   SUCK_BAD_INP:
      581     9575    1           ERRCODE=%E$VWM_INP;
      582     9576    1           GOTO SUCK_USRERR;
      583     9577
      584     9578        /****
      585     9579        *
      586     9580        *   Error from M$FID on output FID.
      587     9581        *
      588     9582        ****/
      589     9583
      590     9584    1   SUCK_BAD_OUT:
      591     9585    1           ERRCODE=%E$VWM_OUT;
      592     9586    1           GOTO SUCK_USRERR;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:17   
      593     9587
      594     9588        /****
      595     9589        *
      596     9590        *   Unknown or invalid destination node.
      597     9591        *
      598     9592        ****/
      599     9593
      600     9594    1   SUCK_BAD_DST:
      601     9595    1           ERRCODE=%E$VWM_DST;
      602     9596    1           GOTO SUCK_USRERR;
      603     9597
      604     9598        /****
      605     9599        *
      606     9600        *   Unknown or invalid source node.
      607     9601        *
      608     9602        ****/
      609     9603
      610     9604    1   SUCK_BAD_SRC:
      611     9605    1           ERRCODE=%E$VWM_SRC;
      612     9606    1           GOTO SUCK_USRERR;
      613     9607
      614     9608        /****
      615     9609        *
      616     9610        *   Unable to open JE@source node.
      617     9611        *
      618     9612        ****/
      619     9613
      620     9614    1   SUCK_BAD_NODE:
      621     9615    1           ERRDCB=DCBNUM(M$JE);
      622     9616    1           GOTO SUCK_SYSERR;
      623     9617
      624     9618        /****
      625     9619        *
      626     9620        *   Error closing JE@source node.
      627     9621        *
      628     9622        ****/
      629     9623
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:18   
      630     9624    1   SUCK_BAD_ONE:
      631     9625    1           ERRDCB=DCBNUM(M$JE);
      632     9626    1           GOTO SUCK_SYSERR;
      633     9627
      634     9628        /****
      635     9629        *
      636     9630        *   Error writing to JE@source node.
      637     9631        *
      638     9632        ****/
      639     9633
      640     9634    1   SUCK_BAD_WRJ:
      641     9635    1           ERRDCB=DCBNUM(M$JE);
      642     9636    1           GOTO SUCK_SYSERR;
      643     9637
      644     9638        /****
      645     9639        *
      646     9640        *   Handle user-error conditions.
      647     9641        *
      648     9642        ****/
      649     9643
      650     9644    1   SUCK_USRERR:
      651     9645    1           CALL VWX$MAIL(ERRCODE);
      652     9646    1           GOTO SUCK_ABORT;
      653     9647
      654     9648        /****
      655     9649        *
      656     9650        *   Report the error and DCB for monitor errors.
      657     9651        *
      658     9652        ****/
      659     9653
      660     9654    1   SUCK_SYSERR:
      661     9655    1           ERRBITS=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      662     9656    1           ERRBITS.SEV=0;
      663     9657    1           CALL VWX$MAIL(ERRCODE,,,,ERRDCB);
      664     9658    1           GOTO SUCK_ABORT;
      665     9659
      666     9660        /****
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:19   
      667     9661        *
      668     9662        *   Close and release the symbiont file (otherwise, it gets shipped!).
      669     9663        *
      670     9664        ****/
      671     9665
      672     9666    1   SUCK_ABORT:
      673     9667    1           CLOSE_JE.V.DISP#=%RELEASE#;
      674     9668    1           IF JEPTR->DUMMY.FCD# THEN
      675     9669    1              CALL M$CLOSE(CLOSE_JE);
      676     9670    1           ALTRETURN;
      677     9671
      678     9672    1   END;

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:20   
--  Include file information  --

   VW_FPTS_M.:VMB6TOU  cannot be made into a system file and is referenced.
   VW_NODEATER_E.:VMB6TOU  is referenced.
   VW_OPTS_M.:VMB6TOU  is referenced.
   VWM_ERRS_E.:VMB6TOU  is referenced.
   VW_MOVE_E.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VWK$SUCK.

   Procedure VWK$SUCK requires 729 words for executable code.
   Procedure VWK$SUCK requires 1218 words of local(AUTO) storage.

    No errors detected in file VWK$SUCK.:VMB6TSI    .

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:21   

 Object Unit name= VWK$SUCK                                   File name= VWK$SUCK.:VMB6TOU
 UTS= AUG 20 '97 15:41:09.64 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   562   1062  VWK$SUCK
    2  RtLbCm even  none     2      2  ACCT_NODE
    3  RoData even  UTS     35     43  VWK$SUCK
    4   DCB   even  none     0      0  M$OUT
    5   DCB   even  none     0      0  M$JE
    6   DCB   even  none     0      0  M$LM
    7   DCB   even  none     0      0  M$NODE
    8   Proc  even  none   729   1331  VWK$SUCK
    9  RoData even  none    35     43  VWK$SUCK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     8      0   yes    yes     yes      Std        0  VWK$SUCK
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:22   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 VWX$MAIL
 yes     yes           Std       3 VWH$HEADER
         yes           Std       1 VWO$TRANSO
 yes     yes           Std       3 VWF$FOOTER
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VW_OPTIONS#                           M$OUT
     M$JE                                  M$LM                                  M$NODE
     VW_OUTCNT#                            VW_BROKEN#                            B$TCB$
     VW_IAM#                               VW_SCRAMBLE#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:23   


        1        1        /*M* VWK$SUCK - Send transfer request to a distant node. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*F**
        9        9        *
       10       10        *   NAME:  VWK$SUCK
       11       11        *
       12       12        *   PURPOSE:
       13       13        *       To generate a remote file retrieval request packet.
       14       14        *
       15       15        *   DESCRIPTION:
       16       16        *       SUCK generates a remote file retrieval request packet (SUCK) to
       17       17        *       be shipped to a distant system.  The file to be retrieved exists
       18       18        *       on that system.
       19       19        *
       20       20        *   REFERENCE:
       21       21        *       See the appropriate Architecture File document for a description
       22       22        *       of a SUCK packet.
       23       23        *
       24       24        ****/
       25       25
       26       26        /*D**
       27       27        *
       28       28        *   NAME:  VWK$SUCK
       29       29        *
       30       30        *   CALL:
       31       31        *       CALL VWK$SUCK ALTRET...
       32       32        *
       33       33        *   PARAMETERS:
       34       34        *       None.
       35       35        *
       36       36        *   INTERFACE:
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:24   
       37       37        *       Calls VWX$MAIL (MOVE's version), VWH$HEADER, VWF$FOOTER, and
       38       38        *       VWO$TRANSO.
       39       39        *
       40       40        *   ENVIRONMENT:
       41       41        *       The VW_OPTIONS# block must have been filled in by the caller,
       42       42        *       MOVE.
       43       43        *
       44       44        *   INPUT:
       45       45        *       Data from the SUCK block in VW_OPTIONS# is used to direct the
       46       46        *       packet.  VW_SCRAMBLE# is consulted for scrambling information.
       47       47        *       VW_IAM# is consulted for the name of the "home" node.
       48       48        *
       49       49        *   OUTPUT:
       50       50        *       VW_OUTCNT# may be modified.
       51       51        *
       52       52        *   SCRATCH:
       53       53        *       None.
       54       54        *
       55       55        *   DESCRIPTION:
       56       56        *       The SUCK subroutine packages a retrieval request for transmis-
       57       57        *       sion and sends it across the HASP link.  It expects to find the
       58       58        *       VW_OPTIONS# block filled in by the calling program.  Communication
       59       59        *       back to the sender is accomplished via the MAIL subprogram,
       60       60        *       which is different for the MOVE program and the SCOTTY ghost.
       61       61        *       The BREAK subroutine is not used.  ALTRET is taken if the
       62       62        *       transport process aborts.
       63       63        *
       64       64        ****/
       65       65
       66       66        VWK$SUCK: PROC ALTRET;

     66  8 000000   000000 700200 xent  VWK$SUCK     TSX0  ! X66_AUTO_0
         8 000001   002302 000000                    ZERO    1218,0

       67       67
       68       68        /****
       69       69        *
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:25   
       70       70        *   %INCLUDEs
       71       71        *
       72       72        ****/
       73       73
       74       74        %INCLUDE CP_6;
       75     5633        %INCLUDE CP_6_SUBS;
       76     6173        %INCLUDE VW_MOVE_E;
       77     6251        %INCLUDE VWM_ERRS_E;
       78     6625        %INCLUDE VW_OPTS_M;
       79     7309        %MOVE_OPTIONS;
       80     7812        %INCLUDE VW_NODEATER_E;
       81     7868        %INCLUDE VW_FPTS_M;
       82     8289
       83     8290        /****
       84     8291        *
       85     8292        *   FPTs
       86     8293        *
       87     8294        ****/
       88     8295
       89     8296        %FPT_OPEN(FPTN=OPEN_INP,
       90     8297                  NAME=NAME_INP,
       91     8298                  ACCT=ACCT_INP,
       92     8299                  PASS=PASS_INP,
       93     8300                  SN=SN_INP);
       94     8409
       95     8410        %VLP_NAME(FPTN=NAME_INP,
       96     8411                  LEN=31,
       97     8412                  NAME=' ');
       98     8439
       99     8440        %VLP_ACCT(FPTN=ACCT_INP,
      100     8441                  ACCT='        ');
      101     8454
      102     8455        %VLP_PASS(FPTN=PASS_INP,
      103     8456                  PASS='        ');
      104     8469
      105     8470        %VLP_SN(FPTN=SN_INP,
      106     8471                N=6);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:26   
      107     8484
      108     8485        %FPT_FID(FPTN=FID_INP,
      109     8486                 NAME=NAME_INP,
      110     8487                 ACCT=ACCT_INP,
      111     8488                 PASS=PASS_INP,
      112     8489                 SN=SN_INP,
      113     8490                 ASN=OPEN_INP.V.ASN#,
      114     8491                 RES=OPEN_INP.V.RES#,
      115     8492                 RESULTS=VLR_INP);
      116     8515
      117     8516        %VLR_FID(FPTN=VLR_INP);
      118     8535
      119     8536        %FPT_OPEN(FPTN=OPEN_OUT,
      120     8537                  DCB=M$OUT,
      121     8538                  NAME=NAME_OUT,
      122     8539                  ACCT=ACCT_OUT,
      123     8540                  PASS=PASS_OUT,
      124     8541                  SN=SN_OUT,
      125     8542                  FUN=IN,
      126     8543                  SCRUB=YES,
      127     8544                  EXIST=OLDFILE,
      128     8545                  TEST=YES);
      129     8654
      130     8655        %VLP_NAME(FPTN=NAME_OUT,
      131     8656                  LEN=31,
      132     8657                  NAME=' ');
      133     8684
      134     8685        %VLP_ACCT(FPTN=ACCT_OUT,
      135     8686                  ACCT='        ');
      136     8699
      137     8700        %VLP_PASS(FPTN=PASS_OUT,
      138     8701                  PASS='        ');
      139     8714
      140     8715        %VLP_SN(FPTN=SN_OUT,
      141     8716                N=6);
      142     8729
      143     8730        %FPT_FID(FPTN=FID_OUT,
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:27   
      144     8731                 NAME=NAME_OUT,
      145     8732                 ACCT=ACCT_OUT,
      146     8733                 PASS=PASS_OUT,
      147     8734                 SN=SN_OUT,
      148     8735                 ASN=OPEN_OUT.V.ASN#,
      149     8736                 RES=OPEN_OUT.V.RES#,
      150     8737                 RESULTS=VLR_OUT);
      151     8760
      152     8761        %VLR_FID(FPTN=VLR_OUT);
      153     8780
      154     8781        %FPT_UNFID(FPTN=UNFID_INP,
      155     8782                   ACCT=ACCT_INP,
      156     8783                   ASN=OPEN_INP.V.ASN#,
      157     8784                   NAME=NAME_INP,
      158     8785                   RES=OPEN_INP.V.RES#,
      159     8786                   SN=SN_INP);
      160     8804
      161     8805        %FPT_UNFID(FPTN=UNFID_OUT,
      162     8806                   ACCT=ACCT_OUT,
      163     8807                   ASN=OPEN_OUT.V.ASN#,
      164     8808                   NAME=NAME_OUT,
      165     8809                   RES=OPEN_OUT.V.RES#,
      166     8810                   SN=SN_OUT);
      167     8828
      168     8829        %FPT_OPEN(FPTN=OPEN_JE,
      169     8830                  DCB=M$JE,
      170     8831                  ASN=DEVICE,
      171     8832                  RES='JE  ',
      172     8833                  FUN=CREATE,
      173     8834                  EXIST=ERROR,
      174     8835                  SCRUB=YES,
      175     8836                  WSN=WSN_JE);
      176     8945
      177     8946        %VLP_WSN(FPTN=WSN_JE,
      178     8947                 WSN='        ');
      179     8960
      180     8961        %FPT_WRITE(FPTN=WRITE_JE,
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:28   
      181     8962                   DCB=M$JE);
      182     8993
      183     8994        %FPT_CLOSE(FPTN=CLOSE_JE,
      184     8995                   DCB=M$JE,
      185     8996                   DISP=SAVE);
      186     9038
      187     9039        %FPT_JOBSTATS(ORDER=CHECKF,
      188     9040                      CRITERIA=VLP_CRITERIA,
      189     9041                      RESULTS=VLR_JOBSTATS_CHECK);
      190     9061
      191     9062        %VLP_CRITERIA;
      192     9090
      193     9091                  %VLR_JOBSTATS_CHECK;
      194     9110
      195     9111        %FPT_WAIT(UNITS=1);
      196     9125
      197     9126        %B$TCB;
      198     9129
      199     9130        %B$ALT;
      200     9138
      201     9139        %F$DCB(DCBN=DUMMY);
      202     9196
      203     9197        /****
      204     9198        *
      205     9199        *   Local variables.
      206     9200        *
      207     9201        ****/
      208     9202
      209     9203    1   DCL M$OUT                          DCB;
      210     9204    1   DCL M$JE                           DCB;
      211     9205    1   DCL M$LM                           DCB;
      212     9206    1   DCL M$NODE                         DCB;
      213     9207
      214     9208    1   DCL VWX$MAIL                       ENTRY(5);
      215     9209    1   DCL VWH$HEADER                     ENTRY(3) ALTRET;
      216     9210    1   DCL VWF$FOOTER                     ENTRY(3) ALTRET;
      217     9211    1   DCL VWO$TRANSO                     ENTRY(1);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:29   
      218     9212
      219     9213    1   DCL I                              SBIN;
      220     9214    1   DCL J                              SBIN;
      221     9215    1   DCL K                              SBIN;
      222     9216    1   DCL VW_OUTCNT# SYMREF              SBIN;
      223     9217    1   DCL VW_BROKEN# SYMREF              SBIN;
      224     9218    1   DCL ERRDCB                         SBIN;
      225     9219
      226     9220    1   DCL ERRCODE                        SBIN;
      227     9221    1   DCL 1 ERRBITS REDEF ERRCODE,
      228     9222    1         2 FCG                        UNAL BIT(18),
      229     9223    1         2 M                          UNAL BIT(1),
      230     9224    1         2 CODE                       UNAL UBIN(14),
      231     9225    1         2 SEV                        UNAL UBIN(3);
      232     9226
      233     9227
      234     9228    1   DCL B$TCB$ SYMREF                  PTR;
      235     9229    1   DCL JEPTR                          PTR;
      236     9230
      237     9231    1   DCL FITBUF                         CHAR(4096);
      238     9232    1   DCL LOBUF                          CHAR(256);
      239     9233    1   DCL JEBUF                          CHAR(80);
      240     9234    1   DCL TWORK                          CHAR(12);
      241     9235    1   DCL DWORK                          CHAR(8);
      242     9236    1   DCL VW_IAM# SYMREF                 CHAR(8);
      243     9237
      244     9238    1   DCL VW_SCRAMBLE# SYMREF            BIT(1);
      245     9239
      246     9240    1   DCL 1 U1,
      247     9241    1         2 L UNAL                     UBIN BYTE,
      248     9242    1         2 C UNAL                     CHAR(79);
      249     9243    1   DCL 1 U2,
      250     9244    1         2 L UNAL                     UBIN BYTE,
      251     9245    1         2 C UNAL                     CHAR(79);
      252     9246    1   DCL 1 U3,
      253     9247    1         2 L UNAL                     UBIN BYTE,
      254     9248    1         2 C UNAL                     CHAR(79);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:30   
      255     9249    1   DCL 1 U4,
      256     9250    1         2 L UNAL                     UBIN BYTE,
      257     9251    1         2 C UNAL                     CHAR(79);
      258     9252
      259     9253        %EJECT;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:31   
      260     9254        /****
      261     9255        *
      262     9256        *   Initialize FPTs.
      263     9257        *
      264     9258        ****/
      265     9259
      266     9260    1           JEPTR=DCBADDR(DCBNUM(M$JE));

   9260  8 000002   000000 236007 xsym               LDQ     M$JE,DL
         8 000003   000000 470400 9                  LDP0    0
         8 000004   000000 471500                    LDP1    0,,PR0
         8 000005   100000 236106                    LDQ     0,QL,PR1
         8 000006   200010 756100                    STQ     JEPTR,,AUTO

      267     9261    1           NAME_OUT.L#=31;

   9261  8 000007   037000 236003                    LDQ     15872,DU
         8 000010   000436 552040 1                  STBQ    NAME_OUT,'40'O

      268     9262    1           SN_OUT.NUM#=6;

   9262  8 000011   000006 235007                    LDA     6,DL
         8 000012   000452 755000 1                  STA     SN_OUT

      269     9263    1           WRITE_JE.BUF_.BUF$=ADDR(JEBUF);

   9263  8 000013   202111 633500                    EPPR3   JEBUF,,AUTO
         8 000014   000703 453400 1                  STP3    WRITE_JE+5

      270     9264    1           WRITE_JE.BUF_.BOUND=79;

   9264  8 000015   000702 236000 1                  LDQ     WRITE_JE+4
         8 000016   177777 376007                    ANQ     65535,DL
         8 000017   000001 276000 9                  ORQ     1
         8 000020   000702 756000 1                  STQ     WRITE_JE+4

      271     9265    1           UNFID_INP.TEXTFID_=VECTOR(U1.C);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:32   

   9265  8 000021   000002 235000 9                  LDA     2
         8 000022   202262 452500                    STP2    U4+20,,AUTO
         8 000023   202262 236100                    LDQ     U4+20,,AUTO
         8 000024   000003 036000 9                  ADLQ    3
         8 000025   000530 757000 1                  STAQ    UNFID_INP+2

      272     9266    1           UNFID_INP.LEN_=VECTOR(I);

   9266  8 000026   777640 235007                    LDA     -96,DL
         8 000027   202262 452500                    STP2    U4+20,,AUTO
         8 000030   202262 236100                    LDQ     U4+20,,AUTO
         8 000031   000003 036003                    ADLQ    3,DU
         8 000032   000550 757000 1                  STAQ    UNFID_INP+18

      273     9267    1           UNFID_OUT.TEXTFID_=VECTOR(U2.C);

   9267  8 000033   000002 235000 9                  LDA     2
         8 000034   202262 452500                    STP2    U4+20,,AUTO
         8 000035   202262 236100                    LDQ     U4+20,,AUTO
         8 000036   000004 036000 9                  ADLQ    4
         8 000037   000556 757000 1                  STAQ    UNFID_OUT+2

      274     9268    1           UNFID_OUT.LEN_=VECTOR(I);

   9268  8 000040   777640 235007                    LDA     -96,DL
         8 000041   202262 452500                    STP2    U4+20,,AUTO
         8 000042   202262 236100                    LDQ     U4+20,,AUTO
         8 000043   000003 036003                    ADLQ    3,DU
         8 000044   000576 757000 1                  STAQ    UNFID_OUT+18

      275     9269    1           NODEKEY.L=8;

   9269  8 000045   010000 236003                    LDQ     4096,DU
         8 000046   000150 552040 1                  STBQ    NODEKEY,'40'O

      276     9270
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:33   
      277     9271        /****
      278     9272        *
      279     9273        *   Check output node to make sure it exists.
      280     9274        *
      281     9275        ****/
      282     9276
      283     9277    2           IF OPTS.OUT.NODE~=' ' AND OPTS.OUT.NODE~=VW_IAM# THEN DO;

   9277  8 000047   040000 106400                    CMPC    fill='040'O
         8 000050   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8
         8 000051   000005 000001 9                  ADSC9   5                        cn=0,n=1
         8 000052   000067 600000 8                  TZE     s:9282
         8 000053   040000 106400                    CMPC    fill='040'O
         8 000054   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8
         8 000055   000000 000010 xsym               ADSC9   VW_IAM#                  cn=0,n=8
         8 000056   000067 600000 8                  TZE     s:9282

      284     9278    2              NODEKEY.C=OPTS.OUT.NODE;

   9278  8 000057   040000 100400                    MLR     fill='040'O
         8 000060   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8
         8 000061   000150 200010 1                  ADSC9   NODEKEY                  cn=1,n=8

      285     9279    2              CALL M$READ(READ_NODE) ALTRET(SUCK_BAD_DST);

   9279  8 000062   000074 630400 1                  EPPR0   READ_NODE
         8 000063   440000 713400                    CLIMB   alt,read
         8 000064   401400 401760                    pmme    nvectors=4
         8 000065   001245 702000 8                  TSX2    SUCK_BAD_DST

      286     9280    2              END;

   9280  8 000066   000072 710000 8                  TRA     s:9290

      287     9281    1           ELSE
      288     9282    1              OPTS.OUT.NODE=VW_IAM#;

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:34   
   9282  8 000067   040000 100400                    MLR     fill='040'O
         8 000070   000000 000010 xsym               ADSC9   VW_IAM#                  cn=0,n=8
         8 000071   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8

      289     9283
      290     9284        /****
      291     9285        *
      292     9286        *   Check input node to make sure it exists, then open the JE stream.
      293     9287        *
      294     9288        ****/
      295     9289
      296     9290    1           NODEKEY.C=OPTS.INP.NODE;

   9290  8 000072   040000 100400                    MLR     fill='040'O
         8 000073   000022 000010 xsym               ADSC9   VW_OPTIONS#+18           cn=0,n=8
         8 000074   000150 200010 1                  ADSC9   NODEKEY                  cn=1,n=8

      297     9291    1           CALL M$READ(READ_NODE) ALTRET(SUCK_BAD_SRC);

   9291  8 000075   000074 630400 1                  EPPR0   READ_NODE
         8 000076   440000 713400                    CLIMB   alt,read
         8 000077   401400 401760                    pmme    nvectors=4
         8 000100   001250 702000 8                  TSX2    SUCK_BAD_SRC

      298     9292    2           IF DCBADDR(DCBNUM(M$NODE))->DUMMY.ARS#=8 THEN DO;

   9292  8 000101   000000 236007 xsym               LDQ     M$NODE,DL
         8 000102   000000 470400 9                  LDP0    0
         8 000103   000000 471500                    LDP1    0,,PR0
         8 000104   100000 473506                    LDP3    0,QL,PR1
         8 000105   300000 235100                    LDA     0,,PR3
         8 000106   000010 115007                    CMPA    8,DL
         8 000107   000117 601000 8                  TNZ     s:9296

      299     9293    2              NODEKEY.C=NODEOVR.PATH_NAME;

   9293  8 000110   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:35   
         8 000111   000153 000010 1                  ADSC9   NODEOVR                  cn=0,n=8
         8 000112   000150 200010 1                  ADSC9   NODEKEY                  cn=1,n=8

      300     9294    2              CALL M$READ(READ_NODE) ALTRET(SUCK_BAD_SRC);

   9294  8 000113   000074 630400 1                  EPPR0   READ_NODE
         8 000114   440000 713400                    CLIMB   alt,read
         8 000115   401400 401760                    pmme    nvectors=4
         8 000116   001250 702000 8                  TSX2    SUCK_BAD_SRC

      301     9295    2              END;

      302     9296    1           WSN_JE.WSN#=NODEOVR.PATH_NAME;

   9296  8 000117   040000 100400                    MLR     fill='040'O
         8 000120   000153 000010 1                  ADSC9   NODEOVR                  cn=0,n=8
         8 000121   000674 000010 1                  ADSC9   WSN_JE                   cn=0,n=8

      303     9297    1           CALL M$OPEN(OPEN_JE) ALTRET(SUCK_BAD_NODE);

   9297  8 000122   000602 630400 1                  EPPR0   OPEN_JE
         8 000123   450000 713400                    CLIMB   alt,open
         8 000124   410400 401760                    pmme    nvectors=18
         8 000125   001253 702000 8                  TSX2    SUCK_BAD_NODE

      304     9298
      305     9299        /****
      306     9300        *
      307     9301        *   Work with input FID to make sure it is a legal FID.
      308     9302        *
      309     9303        ****/
      310     9304
      311     9305    2           IF SUBSTR(OPTS.INP.FID,0,1)~='''' THEN DO;

   9305  8 000126   000024 236000 xsym               LDQ     VW_OPTIONS#+20
         8 000127   000777 376003                    ANQ     511,DU
         8 000130   000047 116003                    CMPQ    39,DU
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:36   
         8 000131   000152 600000 8                  TZE     s:9319

      312     9306    2              I=OPTS.INP.L-ASCBIN('/');

   9306  8 000132   000024 236000 xsym               LDQ     VW_OPTIONS#+20
         8 000133   000033 772000                    QRL     27
         8 000134   000057 136007                    SBLQ    47,DL
         8 000135   200003 756100                    STQ     I,,AUTO

      313     9307    2              IF I<1 OR I>79 THEN

   9307  8 000136   001231 604400 8                  TMOZ    SUCK_BAD_ITL
         8 000137   000117 116007                    CMPQ    79,DL
         8 000140   001231 605400 8                  TPNZ    SUCK_BAD_ITL

      314     9308    2                 GOTO SUCK_BAD_ITL;
      315     9309    2              FID_INP.TEXTFID_=VECTOR(SUBSTR(OPTS.INP.FID,0,I));

   9309  8 000141   200003 235100                    LDA     I,,AUTO
         8 000142   000020 735000                    ALS     16
         8 000143   000140 135007                    SBLA    96,DL
         8 000144   000006 236000 9                  LDQ     6
         8 000145   000304 757000 1                  STAQ    FID_INP+2

      316     9310    2              CALL M$FID(FID_INP) ALTRET(SUCK_BAD_INP);

   9310  8 000146   000302 630400 1                  EPPR0   FID_INP
         8 000147   420001 713400                    CLIMB   alt,+8193
         8 000150   404400 401760                    pmme    nvectors=10
         8 000151   001237 702000 8                  TSX2    SUCK_BAD_INP

      317     9311    2              END;

      318     9312
      319     9313        /****
      320     9314        *
      321     9315        *   Work with output FID to make sure it is a legal FID.
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:37   
      322     9316        *
      323     9317        ****/
      324     9318
      325     9319    2           IF SUBSTR(OPTS.OUT.FID,0,1)~='''' THEN DO;

   9319  8 000152   000074 236000 xsym               LDQ     VW_OPTIONS#+60
         8 000153   000777 376003                    ANQ     511,DU
         8 000154   000047 116003                    CMPQ    39,DU
         8 000155   000176 600000 8                  TZE     s:9333

      326     9320    2              I=OPTS.OUT.L-ASCBIN('/');

   9320  8 000156   000074 236000 xsym               LDQ     VW_OPTIONS#+60
         8 000157   000033 772000                    QRL     27
         8 000160   000057 136007                    SBLQ    47,DL
         8 000161   200003 756100                    STQ     I,,AUTO

      327     9321    2              IF I<1 OR I>79 THEN

   9321  8 000162   001234 604400 8                  TMOZ    SUCK_BAD_OTL
         8 000163   000117 116007                    CMPQ    79,DL
         8 000164   001234 605400 8                  TPNZ    SUCK_BAD_OTL

      328     9322    2                 GOTO SUCK_BAD_OTL;
      329     9323    2              FID_OUT.TEXTFID_=VECTOR(SUBSTR(OPTS.OUT.FID,0,I));

   9323  8 000165   200003 235100                    LDA     I,,AUTO
         8 000166   000020 735000                    ALS     16
         8 000167   000140 135007                    SBLA    96,DL
         8 000170   000007 236000 9                  LDQ     7
         8 000171   000466 757000 1                  STAQ    FID_OUT+2

      330     9324    2              CALL M$FID(FID_OUT) ALTRET(SUCK_BAD_OUT);

   9324  8 000172   000464 630400 1                  EPPR0   FID_OUT
         8 000173   420001 713400                    CLIMB   alt,+8193
         8 000174   404400 401760                    pmme    nvectors=10
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:38   
         8 000175   001242 702000 8                  TSX2    SUCK_BAD_OUT

      331     9325    2              END;

      332     9326
      333     9327        /****
      334     9328        *
      335     9329        *   Tell the user what's happening ("Moving FID@wsn to FID@wsn...")
      336     9330        *
      337     9331        ****/
      338     9332
      339     9333    2           IF SUBSTR(OPTS.INP.FID,0,1)='''' THEN DO;

   9333  8 000176   000024 236000 xsym               LDQ     VW_OPTIONS#+20
         8 000177   000777 376003                    ANQ     511,DU
         8 000200   000047 116003                    CMPQ    39,DU
         8 000201   000212 601000 8                  TNZ     s:9338

      340     9334    2              U1.C=OPTS.INP.FID;

   9334  8 000202   040100 100400                    MLR     fill='040'O
         8 000203   000024 200117 xsym               ADSC9   VW_OPTIONS#+20           cn=1,n=79
         8 000204   202142 200117                    ADSC9   U1,,AUTO                 cn=1,n=79

      341     9335    2              I=OPTS.INP.L-ASCBIN('/');

   9335  8 000205   000024 236000 xsym               LDQ     VW_OPTIONS#+20
         8 000206   000033 772000                    QRL     27
         8 000207   000057 136007                    SBLQ    47,DL
         8 000210   200003 756100                    STQ     I,,AUTO

      342     9336    2              END;

   9336  8 000211   000215 710000 8                  TRA     s:9339

      343     9337    1           ELSE
      344     9338    1              CALL M$UNFID(UNFID_INP);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:39   

   9338  8 000212   000526 630400 1                  EPPR0   UNFID_INP
         8 000213   020021 713400                    CLIMB   8209
         8 000214   404400 401760                    pmme    nvectors=10

      345     9339    2           IF OPTS.INP.NODE~=VW_IAM# THEN DO;

   9339  8 000215   040000 106400                    CMPC    fill='040'O
         8 000216   000022 000010 xsym               ADSC9   VW_OPTIONS#+18           cn=0,n=8
         8 000217   000000 000010 xsym               ADSC9   VW_IAM#                  cn=0,n=8
         8 000220   000254 600000 8                  TZE     s:9343

      346     9340    2              CALL INSERT(U1.C,I,,'@',OPTS.INP.NODE);

   9340  8 000221   200003 720100                    LXL0    I,,AUTO
         8 000222   777660 620010                    EAX0    -80,X0
         8 000223   777777 660003                    ERX0    -1,DU
         8 000224   200003 235100                    LDA     I,,AUTO
         8 000225   040145 100400                    MLR     fill='040'O
         8 000226   000010 000001 9                  ADSC9   8                        cn=0,n=1
         8 000227   202142 200010                    ADSC9   U1,A,AUTO                cn=1,n=*X0
         8 000230   200003 236100                    LDQ     I,,AUTO
         8 000231   000116 116007                    CMPQ    78,DL
         8 000232   000240 605000 8                  TPL     s:9341
         8 000233   777661 620006                    EAX0    -79,QL
         8 000234   777777 660003                    ERX0    -1,DU
         8 000235   040146 100400                    MLR     fill='040'O
         8 000236   000022 000010 xsym               ADSC9   VW_OPTIONS#+18           cn=0,n=8
         8 000237   202142 400010                    ADSC9   U1,Q,AUTO                cn=2,n=*X0

      347     9341    2              CALL INDEX(I,'  ',U1.C,I);

   9341  8 000240   200003 720100                    LXL0    I,,AUTO
         8 000241   777660 620010                    EAX0    -80,X0
         8 000242   777777 660003                    ERX0    -1,DU
         8 000243   200003 236100                    LDQ     I,,AUTO
         8 000244   200003 235100                    LDA     I,,AUTO
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:40   
         8 000245   000000 120545                    SCD
         8 000246   202142 200010                    ADSC9   U1,A,AUTO                cn=1,n=*X0
         8 000247   000041 000002 3                  ADSC9   TYPE+27                  cn=0,n=2
         8 000250   200003 000100                    ARG     I,,AUTO
         8 000251   200003 056100                    ASQ     I,,AUTO
         8 000252   000254 607000 8                  TTF     s:9343
         8 000253   200003 054100                    AOS     I,,AUTO

      348     9342    2              END;

      349     9343    1           U1.L=I;

   9343  8 000254   200003 236100                    LDQ     I,,AUTO
         8 000255   000033 736000                    QLS     27
         8 000256   202142 552140                    STBQ    U1,'40'O,AUTO

      350     9344
      351     9345    2           IF SUBSTR(OPTS.OUT.FID,0,1)='''' THEN DO;

   9345  8 000257   000074 236000 xsym               LDQ     VW_OPTIONS#+60
         8 000260   000777 376003                    ANQ     511,DU
         8 000261   000047 116003                    CMPQ    39,DU
         8 000262   000273 601000 8                  TNZ     s:9350

      352     9346    2              U2.C=OPTS.OUT.FID;

   9346  8 000263   040100 100400                    MLR     fill='040'O
         8 000264   000074 200117 xsym               ADSC9   VW_OPTIONS#+60           cn=1,n=79
         8 000265   202166 200117                    ADSC9   U2,,AUTO                 cn=1,n=79

      353     9347    2              I=OPTS.OUT.L-ASCBIN('/');

   9347  8 000266   000074 236000 xsym               LDQ     VW_OPTIONS#+60
         8 000267   000033 772000                    QRL     27
         8 000270   000057 136007                    SBLQ    47,DL
         8 000271   200003 756100                    STQ     I,,AUTO

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:41   
      354     9348    2              END;

   9348  8 000272   000276 710000 8                  TRA     s:9351

      355     9349    1           ELSE
      356     9350    1              CALL M$UNFID(UNFID_OUT);

   9350  8 000273   000554 630400 1                  EPPR0   UNFID_OUT
         8 000274   020021 713400                    CLIMB   8209
         8 000275   404400 401760                    pmme    nvectors=10

      357     9351    2           IF OPTS.OUT.NODE~=VW_IAM# THEN DO;

   9351  8 000276   040000 106400                    CMPC    fill='040'O
         8 000277   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8
         8 000300   000000 000010 xsym               ADSC9   VW_IAM#                  cn=0,n=8
         8 000301   000335 600000 8                  TZE     s:9355

      358     9352    2              CALL INSERT(U2.C,I,,'@',OPTS.OUT.NODE);

   9352  8 000302   200003 720100                    LXL0    I,,AUTO
         8 000303   777660 620010                    EAX0    -80,X0
         8 000304   777777 660003                    ERX0    -1,DU
         8 000305   200003 235100                    LDA     I,,AUTO
         8 000306   040145 100400                    MLR     fill='040'O
         8 000307   000010 000001 9                  ADSC9   8                        cn=0,n=1
         8 000310   202166 200010                    ADSC9   U2,A,AUTO                cn=1,n=*X0
         8 000311   200003 236100                    LDQ     I,,AUTO
         8 000312   000116 116007                    CMPQ    78,DL
         8 000313   000321 605000 8                  TPL     s:9353
         8 000314   777661 620006                    EAX0    -79,QL
         8 000315   777777 660003                    ERX0    -1,DU
         8 000316   040146 100400                    MLR     fill='040'O
         8 000317   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8
         8 000320   202166 400010                    ADSC9   U2,Q,AUTO                cn=2,n=*X0

      359     9353    2              CALL INDEX(I,'  ',U2.C,I);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:42   

   9353  8 000321   200003 720100                    LXL0    I,,AUTO
         8 000322   777660 620010                    EAX0    -80,X0
         8 000323   777777 660003                    ERX0    -1,DU
         8 000324   200003 236100                    LDQ     I,,AUTO
         8 000325   200003 235100                    LDA     I,,AUTO
         8 000326   000000 120545                    SCD
         8 000327   202166 200010                    ADSC9   U2,A,AUTO                cn=1,n=*X0
         8 000330   000041 000002 3                  ADSC9   TYPE+27                  cn=0,n=2
         8 000331   200003 000100                    ARG     I,,AUTO
         8 000332   200003 056100                    ASQ     I,,AUTO
         8 000333   000335 607000 8                  TTF     s:9355
         8 000334   200003 054100                    AOS     I,,AUTO

      360     9354    2              END;

      361     9355    1           U2.L=I;

   9355  8 000335   200003 236100                    LDQ     I,,AUTO
         8 000336   000033 736000                    QLS     27
         8 000337   202166 552140                    STBQ    U2,'40'O,AUTO

      362     9356
      363     9357    1           CALL VWX$MAIL(%E$VWM_MOV,VECTOR(U1),VECTOR(U2));

   9357  8 000340   000011 235000 9                  LDA     9
         8 000341   202262 452500                    STP2    U4+20,,AUTO
         8 000342   202262 236100                    LDQ     U4+20,,AUTO
         8 000343   002142 036003                    ADLQ    1122,DU
         8 000344   202264 757100                    STAQ    U4+22,,AUTO
         8 000345   000011 235000 9                  LDA     9
         8 000346   202266 452500                    STP2    U4+24,,AUTO
         8 000347   202266 236100                    LDQ     U4+24,,AUTO
         8 000350   002166 036003                    ADLQ    1142,DU
         8 000351   202272 757100                    STAQ    U4+28,,AUTO
         8 000352   202264 237100                    LDAQ    U4+22,,AUTO
         8 000353   202270 757100                    STAQ    U4+26,,AUTO
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:43   
         8 000354   202272 237100                    LDAQ    U4+28,,AUTO
         8 000355   202274 757100                    STAQ    U4+30,,AUTO
         8 000356   202274 630500                    EPPR0   U4+30,,AUTO
         8 000357   202300 450500                    STP0    U4+34,,AUTO
         8 000360   202270 631500                    EPPR1   U4+26,,AUTO
         8 000361   202277 451500                    STP1    U4+33,,AUTO
         8 000362   000014 236000 9                  LDQ     12
         8 000363   202276 756100                    STQ     U4+32,,AUTO
         8 000364   202276 630500                    EPPR0   U4+32,,AUTO
         8 000365   000012 631400 9                  EPPR1   10
         8 000366   000000 701000 xent               TSX1    VWX$MAIL
         8 000367   000000 011000                    NOP     0

      364     9358
      365     9359        /****
      366     9360        *
      367     9361        *   Build the header appropriate for this system.
      368     9362        *
      369     9363        ****/
      370     9364
      371     9365    1           OPTS.INP.NODE=NODEKEY.C;

   9365  8 000370   040000 100400                    MLR     fill='040'O
         8 000371   000150 200010 1                  ADSC9   NODEKEY                  cn=1,n=8
         8 000372   000022 000010 xsym               ADSC9   VW_OPTIONS#+18           cn=0,n=8

      372     9366    1           I=NODEOVR.TYPE_PATH;

   9366  8 000373   000157 236000 1                  LDQ     NODEOVR+4
         8 000374   000011 772000                    QRL     9
         8 000375   000777 376007                    ANQ     511,DL
         8 000376   200003 756100                    STQ     I,,AUTO

      373     9367    1           CALL VWH$HEADER(DCBNUM(M$JE),JEBUF,I) ALTRET(SUCK_BAD_WRJ);

   9367  8 000377   000000 236007 xsym               LDQ     M$JE,DL
         8 000400   202262 756100                    STQ     U4+20,,AUTO
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:44   
         8 000401   200003 630500                    EPPR0   I,,AUTO
         8 000402   202265 450500                    STP0    U4+23,,AUTO
         8 000403   202111 631500                    EPPR1   JEBUF,,AUTO
         8 000404   202264 451500                    STP1    U4+22,,AUTO
         8 000405   202262 633500                    EPPR3   U4+20,,AUTO
         8 000406   202263 453500                    STP3    U4+21,,AUTO
         8 000407   202263 630500                    EPPR0   U4+21,,AUTO
         8 000410   000012 631400 9                  EPPR1   10
         8 000411   000000 701000 xent               TSX1    VWH$HEADER
         8 000412   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      374     9368
      375     9369        /****
      376     9370        *
      377     9371        *   Ship the header block information, four "cards" (SUCK and BEAM).
      378     9372        *
      379     9373        ****/
      380     9374
      381     9375    1           VW_SCRAMBLE#=OPTS.INP.MISC.TRAN;

   9375  8 000413   000021 236000 xsym               LDQ     VW_OPTIONS#+17
         8 000414   000040 736000                    QLS     32
         8 000415   400000 376003                    ANQ     -131072,DU
         8 000416   000000 756000 xsym               STQ     VW_SCRAMBLE#

      382     9376
      383     9377    1           JEBUF=CARD(0);

   9377  8 000417   040100 100400                    MLR     fill='040'O
         8 000420   000000 000120 xsym               ADSC9   VW_OPTIONS#              cn=0,n=80
         8 000421   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      384     9378    1           IF VW_SCRAMBLE# THEN

   9378  8 000422   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000423   000432 605000 8                  TPL     s:9380

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:45   
      385     9379    1              CALL VWO$TRANSO(JEBUF);

   9379  8 000424   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000425   202262 450500                    STP0    U4+20,,AUTO
         8 000426   202262 630500                    EPPR0   U4+20,,AUTO
         8 000427   000015 631400 9                  EPPR1   13
         8 000430   000000 701000 xent               TSX1    VWO$TRANSO
         8 000431   000000 011000                    NOP     0

      386     9380    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9380  8 000432   000676 630400 1                  EPPR0   WRITE_JE
         8 000433   440001 713400                    CLIMB   alt,write
         8 000434   401400 401760                    pmme    nvectors=4
         8 000435   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      387     9381    1           JEBUF=CARD(1);

   9381  8 000436   040100 100400                    MLR     fill='040'O
         8 000437   000024 000120 xsym               ADSC9   VW_OPTIONS#+20           cn=0,n=80
         8 000440   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      388     9382    1           IF VW_SCRAMBLE# THEN

   9382  8 000441   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000442   000451 605000 8                  TPL     s:9384

      389     9383    1              CALL VWO$TRANSO(JEBUF);

   9383  8 000443   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000444   202262 450500                    STP0    U4+20,,AUTO
         8 000445   202262 630500                    EPPR0   U4+20,,AUTO
         8 000446   000015 631400 9                  EPPR1   13
         8 000447   000000 701000 xent               TSX1    VWO$TRANSO
         8 000450   000000 011000                    NOP     0

      390     9384    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:46   

   9384  8 000451   000676 630400 1                  EPPR0   WRITE_JE
         8 000452   440001 713400                    CLIMB   alt,write
         8 000453   401400 401760                    pmme    nvectors=4
         8 000454   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      391     9385
      392     9386    1           JEBUF=CARD(2);

   9386  8 000455   040100 100400                    MLR     fill='040'O
         8 000456   000050 000120 xsym               ADSC9   VW_OPTIONS#+40           cn=0,n=80
         8 000457   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      393     9387    1           IF VW_SCRAMBLE# THEN

   9387  8 000460   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000461   000470 605000 8                  TPL     s:9389

      394     9388    1              CALL VWO$TRANSO(JEBUF);

   9388  8 000462   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000463   202262 450500                    STP0    U4+20,,AUTO
         8 000464   202262 630500                    EPPR0   U4+20,,AUTO
         8 000465   000015 631400 9                  EPPR1   13
         8 000466   000000 701000 xent               TSX1    VWO$TRANSO
         8 000467   000000 011000                    NOP     0

      395     9389    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9389  8 000470   000676 630400 1                  EPPR0   WRITE_JE
         8 000471   440001 713400                    CLIMB   alt,write
         8 000472   401400 401760                    pmme    nvectors=4
         8 000473   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      396     9390    1           JEBUF=CARD(3);

   9390  8 000474   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:47   
         8 000475   000074 000120 xsym               ADSC9   VW_OPTIONS#+60           cn=0,n=80
         8 000476   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      397     9391    1           IF VW_SCRAMBLE# THEN

   9391  8 000477   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000500   000507 605000 8                  TPL     s:9393

      398     9392    1              CALL VWO$TRANSO(JEBUF);

   9392  8 000501   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000502   202262 450500                    STP0    U4+20,,AUTO
         8 000503   202262 630500                    EPPR0   U4+20,,AUTO
         8 000504   000015 631400 9                  EPPR1   13
         8 000505   000000 701000 xent               TSX1    VWO$TRANSO
         8 000506   000000 011000                    NOP     0

      399     9393    1           CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9393  8 000507   000676 630400 1                  EPPR0   WRITE_JE
         8 000510   440001 713400                    CLIMB   alt,write
         8 000511   401400 401760                    pmme    nvectors=4
         8 000512   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      400     9394    1           VW_OUTCNT#=5;

   9394  8 000513   000005 235007                    LDA     5,DL
         8 000514   000000 755000 xsym               STA     VW_OUTCNT#

      401     9395
      402     9396        /****
      403     9397        *
      404     9398        *   Send the sender MAIL records if needed.
      405     9399        *
      406     9400        ****/
      407     9401
      408     9402    2           IF OPTS.MAILSNDR.WHO~=' ' THEN DO;
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:48   

   9402  8 000515   000121 236000 xsym               LDQ     VW_OPTIONS#+81
         8 000516   777000 376003                    ANQ     -512,DU
         8 000517   040000 116003                    CMPQ    16384,DU
         8 000520   000561 600000 8                  TZE     s:9420

      409     9403    2              JEBUF=CARD(4);

   9403  8 000521   040100 100400                    MLR     fill='040'O
         8 000522   000120 000120 xsym               ADSC9   VW_OPTIONS#+80           cn=0,n=80
         8 000523   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      410     9404    2              IF VW_SCRAMBLE# THEN

   9404  8 000524   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000525   000534 605000 8                  TPL     s:9406

      411     9405    2                 CALL VWO$TRANSO(JEBUF);

   9405  8 000526   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000527   202262 450500                    STP0    U4+20,,AUTO
         8 000530   202262 630500                    EPPR0   U4+20,,AUTO
         8 000531   000015 631400 9                  EPPR1   13
         8 000532   000000 701000 xent               TSX1    VWO$TRANSO
         8 000533   000000 011000                    NOP     0

      412     9406    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9406  8 000534   000676 630400 1                  EPPR0   WRITE_JE
         8 000535   440001 713400                    CLIMB   alt,write
         8 000536   401400 401760                    pmme    nvectors=4
         8 000537   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      413     9407    2              JEBUF=CARD(5);

   9407  8 000540   040100 100400                    MLR     fill='040'O
         8 000541   000144 000120 xsym               ADSC9   VW_OPTIONS#+100          cn=0,n=80
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:49   
         8 000542   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      414     9408    2              IF VW_SCRAMBLE# THEN

   9408  8 000543   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000544   000553 605000 8                  TPL     s:9410

      415     9409    2                 CALL VWO$TRANSO(JEBUF);

   9409  8 000545   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000546   202262 450500                    STP0    U4+20,,AUTO
         8 000547   202262 630500                    EPPR0   U4+20,,AUTO
         8 000550   000015 631400 9                  EPPR1   13
         8 000551   000000 701000 xent               TSX1    VWO$TRANSO
         8 000552   000000 011000                    NOP     0

      416     9410    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9410  8 000553   000676 630400 1                  EPPR0   WRITE_JE
         8 000554   440001 713400                    CLIMB   alt,write
         8 000555   401400 401760                    pmme    nvectors=4
         8 000556   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      417     9411    2              VW_OUTCNT#=VW_OUTCNT#+2;

   9411  8 000557   000002 236007                    LDQ     2,DL
         8 000560   000000 056000 xsym               ASQ     VW_OUTCNT#

      418     9412    2              END;

      419     9413
      420     9414        /****
      421     9415        *
      422     9416        *   Send the receiver MAIL records if needed.
      423     9417        *
      424     9418        ****/
      425     9419
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:50   
      426     9420    2           IF OPTS.MAILRCVR.WHO~=' ' THEN DO;

   9420  8 000561   000171 236000 xsym               LDQ     VW_OPTIONS#+121
         8 000562   777000 376003                    ANQ     -512,DU
         8 000563   040000 116003                    CMPQ    16384,DU
         8 000564   000625 600000 8                  TZE     s:9438

      427     9421    2              JEBUF=CARD(6);

   9421  8 000565   040100 100400                    MLR     fill='040'O
         8 000566   000170 000120 xsym               ADSC9   VW_OPTIONS#+120          cn=0,n=80
         8 000567   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      428     9422    2              IF VW_SCRAMBLE# THEN

   9422  8 000570   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000571   000600 605000 8                  TPL     s:9424

      429     9423    2                 CALL VWO$TRANSO(JEBUF);

   9423  8 000572   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000573   202262 450500                    STP0    U4+20,,AUTO
         8 000574   202262 630500                    EPPR0   U4+20,,AUTO
         8 000575   000015 631400 9                  EPPR1   13
         8 000576   000000 701000 xent               TSX1    VWO$TRANSO
         8 000577   000000 011000                    NOP     0

      430     9424    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9424  8 000600   000676 630400 1                  EPPR0   WRITE_JE
         8 000601   440001 713400                    CLIMB   alt,write
         8 000602   401400 401760                    pmme    nvectors=4
         8 000603   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      431     9425    2              JEBUF=CARD(7);

   9425  8 000604   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:51   
         8 000605   000214 000120 xsym               ADSC9   VW_OPTIONS#+140          cn=0,n=80
         8 000606   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      432     9426    2              IF VW_SCRAMBLE# THEN

   9426  8 000607   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000610   000617 605000 8                  TPL     s:9428

      433     9427    2                 CALL VWO$TRANSO(JEBUF);

   9427  8 000611   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000612   202262 450500                    STP0    U4+20,,AUTO
         8 000613   202262 630500                    EPPR0   U4+20,,AUTO
         8 000614   000015 631400 9                  EPPR1   13
         8 000615   000000 701000 xent               TSX1    VWO$TRANSO
         8 000616   000000 011000                    NOP     0

      434     9428    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9428  8 000617   000676 630400 1                  EPPR0   WRITE_JE
         8 000620   440001 713400                    CLIMB   alt,write
         8 000621   401400 401760                    pmme    nvectors=4
         8 000622   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      435     9429    2              VW_OUTCNT#=VW_OUTCNT#+2;

   9429  8 000623   000002 236007                    LDQ     2,DL
         8 000624   000000 056000 xsym               ASQ     VW_OUTCNT#

      436     9430    2              END;

      437     9431
      438     9432        /****
      439     9433        *
      440     9434        *   Send the initiator MAIL records if needed.
      441     9435        *
      442     9436        ****/
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:52   
      443     9437
      444     9438    2           IF OPTS.MAILINIT.WHO~=' ' THEN DO;

   9438  8 000625   000241 236000 xsym               LDQ     VW_OPTIONS#+161
         8 000626   777000 376003                    ANQ     -512,DU
         8 000627   040000 116003                    CMPQ    16384,DU
         8 000630   000671 600000 8                  TZE     s:9456

      445     9439    2              JEBUF=CARD(8);

   9439  8 000631   040100 100400                    MLR     fill='040'O
         8 000632   000240 000120 xsym               ADSC9   VW_OPTIONS#+160          cn=0,n=80
         8 000633   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      446     9440    2              IF VW_SCRAMBLE# THEN

   9440  8 000634   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000635   000644 605000 8                  TPL     s:9442

      447     9441    2                 CALL VWO$TRANSO(JEBUF);

   9441  8 000636   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000637   202262 450500                    STP0    U4+20,,AUTO
         8 000640   202262 630500                    EPPR0   U4+20,,AUTO
         8 000641   000015 631400 9                  EPPR1   13
         8 000642   000000 701000 xent               TSX1    VWO$TRANSO
         8 000643   000000 011000                    NOP     0

      448     9442    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9442  8 000644   000676 630400 1                  EPPR0   WRITE_JE
         8 000645   440001 713400                    CLIMB   alt,write
         8 000646   401400 401760                    pmme    nvectors=4
         8 000647   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      449     9443    2              JEBUF=CARD(9);

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:53   
   9443  8 000650   040100 100400                    MLR     fill='040'O
         8 000651   000264 000120 xsym               ADSC9   VW_OPTIONS#+180          cn=0,n=80
         8 000652   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      450     9444    2              IF VW_SCRAMBLE# THEN

   9444  8 000653   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000654   000663 605000 8                  TPL     s:9446

      451     9445    2                 CALL VWO$TRANSO(JEBUF);

   9445  8 000655   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000656   202262 450500                    STP0    U4+20,,AUTO
         8 000657   202262 630500                    EPPR0   U4+20,,AUTO
         8 000660   000015 631400 9                  EPPR1   13
         8 000661   000000 701000 xent               TSX1    VWO$TRANSO
         8 000662   000000 011000                    NOP     0

      452     9446    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9446  8 000663   000676 630400 1                  EPPR0   WRITE_JE
         8 000664   440001 713400                    CLIMB   alt,write
         8 000665   401400 401760                    pmme    nvectors=4
         8 000666   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      453     9447    2              VW_OUTCNT#=VW_OUTCNT#+2;

   9447  8 000667   000002 236007                    LDQ     2,DL
         8 000670   000000 056000 xsym               ASQ     VW_OUTCNT#

      454     9448    2              END;

      455     9449
      456     9450        /****
      457     9451        *
      458     9452        *   Send the options records, if any.
      459     9453        *
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:54   
      460     9454        ****/
      461     9455
      462     9456    1           I=10;

   9456  8 000671   000012 235007                    LDA     10,DL
         8 000672   200003 755100                    STA     I,,AUTO

      463     9457    2           DO WHILE(I<LENGTHC(OPTS)/80 AND SUBSTR(CARD(I),0,4)='OPTS');

   9457  8 000673   000717 710000 8                  TRA     s:9464

      464     9458    2              JEBUF=CARD(I);

   9458  8 000674   200003 236100                    LDQ     I,,AUTO
         8 000675   000120 402007                    MPY     80,DL
         8 000676   040100 100406                    MLR     fill='040'O
         8 000677   000000 000120 xsym               ADSC9   VW_OPTIONS#,Q            cn=0,n=80
         8 000700   202111 000120                    ADSC9   JEBUF,,AUTO              cn=0,n=80

      465     9459    2              IF VW_SCRAMBLE# THEN

   9459  8 000701   000000 234000 xsym               SZN     VW_SCRAMBLE#
         8 000702   000711 605000 8                  TPL     s:9461

      466     9460    2                 CALL VWO$TRANSO(JEBUF);

   9460  8 000703   202111 630500                    EPPR0   JEBUF,,AUTO
         8 000704   202262 450500                    STP0    U4+20,,AUTO
         8 000705   202262 630500                    EPPR0   U4+20,,AUTO
         8 000706   000015 631400 9                  EPPR1   13
         8 000707   000000 701000 xent               TSX1    VWO$TRANSO
         8 000710   000000 011000                    NOP     0

      467     9461    2              CALL M$WRITE(WRITE_JE) ALTRET(SUCK_BAD_WRJ);

   9461  8 000711   000676 630400 1                  EPPR0   WRITE_JE
         8 000712   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:55   
         8 000713   401400 401760                    pmme    nvectors=4
         8 000714   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      468     9462    2              VW_OUTCNT#=VW_OUTCNT#+1;

   9462  8 000715   000000 054000 xsym               AOS     VW_OUTCNT#

      469     9463    2              I=I+1;

   9463  8 000716   200003 054100                    AOS     I,,AUTO

      470     9464    2              END;

   9464  8 000717   200003 235100                    LDA     I,,AUTO
         8 000720   000031 115007                    CMPA    25,DL
         8 000721   000727 605000 8                  TPL     s:9472
         8 000722   200003 236100                    LDQ     I,,AUTO
         8 000723   000024 402007                    MPY     20,DL
         8 000724   000000 236006 xsym               LDQ     VW_OPTIONS#,QL
         8 000725   000042 116000 3                  CMPQ    TYPE+28
         8 000726   000674 600000 8                  TZE     s:9458

      471     9465
      472     9466        /****
      473     9467        *
      474     9468        *   Supply the footer appropriate for this system.
      475     9469        *
      476     9470        ****/
      477     9471
      478     9472    1           I=NODEOVR.TYPE_PATH;

   9472  8 000727   000157 236000 1                  LDQ     NODEOVR+4
         8 000730   000011 772000                    QRL     9
         8 000731   000777 376007                    ANQ     511,DL
         8 000732   200003 756100                    STQ     I,,AUTO

      479     9473    1           CALL VWF$FOOTER(DCBNUM(M$JE),JEBUF,I) ALTRET(SUCK_BAD_WRJ);
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:56   

   9473  8 000733   000000 236007 xsym               LDQ     M$JE,DL
         8 000734   202262 756100                    STQ     U4+20,,AUTO
         8 000735   200003 630500                    EPPR0   I,,AUTO
         8 000736   202265 450500                    STP0    U4+23,,AUTO
         8 000737   202111 631500                    EPPR1   JEBUF,,AUTO
         8 000740   202264 451500                    STP1    U4+22,,AUTO
         8 000741   202262 633500                    EPPR3   U4+20,,AUTO
         8 000742   202263 453500                    STP3    U4+21,,AUTO
         8 000743   202263 630500                    EPPR0   U4+21,,AUTO
         8 000744   000012 631400 9                  EPPR1   10
         8 000745   000000 701000 xent               TSX1    VWF$FOOTER
         8 000746   001261 702000 8                  TSX2    SUCK_BAD_WRJ

      480     9474
      481     9475        /****
      482     9476        *
      483     9477        *   Ship it, then tell the user what happened.
      484     9478        *
      485     9479        ****/
      486     9480
      487     9481    1           CLOSE_JE.V.DISP#=%SAVE#;

   9481  8 000747   000002 236007                    LDQ     2,DL
         8 000750   000744 552004 1                  STBQ    CLOSE_JE+26,'04'O

      488     9482    1           CALL M$CLOSE(CLOSE_JE) ALTRET(SUCK_BAD_ONE);

   9482  8 000751   000712 630400 1                  EPPR0   CLOSE_JE
         8 000752   450001 713400                    CLIMB   alt,close
         8 000753   406000 401760                    pmme    nvectors=13
         8 000754   001256 702000 8                  TSX2    SUCK_BAD_ONE

      489     9483
      490     9484        /****
      491     9485        *
      492     9486        *   Fetch the symbiont file name from the DCB (assigned after M$CLOSE)
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:57   
      493     9487        *   and format it into "sysid-subid", suppressing leading zeros.
      494     9488        *
      495     9489        ****/
      496     9490
      497     9491    1           TWORK=SUBSTR(JEPTR->DUMMY.NAME#.C,3,12);

   9491  8 000755   200010 470500                    LDP0    JEPTR,,AUTO
         8 000756   040100 100500                    MLR     fill='040'O
         8 000757   000011 000014                    ADSC9   9,,PR0                   cn=0,n=12
         8 000760   202135 000014                    ADSC9   TWORK,,AUTO              cn=0,n=12

      498     9492    1           I=0;

   9492  8 000761   200003 450100                    STZ     I,,AUTO

      499     9493    2           DO WHILE(SUBSTR(TWORK,I,1)='0');

   9493  8 000762   000764 710000 8                  TRA     s:9495

      500     9494    2              I=I+1;

   9494  8 000763   200003 054100                    AOS     I,,AUTO

      501     9495    2              END;

   9495  8 000764   200003 235100                    LDA     I,,AUTO
         8 000765   040000 106505                    CMPC    fill='040'O
         8 000766   202135 000001                    ADSC9   TWORK,A,AUTO             cn=0,n=1
         8 000767   000016 000001 9                  ADSC9   14                       cn=0,n=1
         8 000770   000763 600000 8                  TZE     s:9494

      502     9496    1           J=6;

   9496  8 000771   000006 236007                    LDQ     6,DL
         8 000772   200004 756100                    STQ     J,,AUTO

      503     9497    2           DO WHILE(SUBSTR(TWORK,J,1)='0');
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:58   

   9497  8 000773   000775 710000 8                  TRA     s:9499

      504     9498    2              J=J+1;

   9498  8 000774   200004 054100                    AOS     J,,AUTO

      505     9499    2              END;

   9499  8 000775   200004 235100                    LDA     J,,AUTO
         8 000776   040000 106505                    CMPC    fill='040'O
         8 000777   202135 000001                    ADSC9   TWORK,A,AUTO             cn=0,n=1
         8 001000   000016 000001 9                  ADSC9   14                       cn=0,n=1
         8 001001   000774 600000 8                  TZE     s:9498

      506     9500    1           CALL CONCAT(U3.C,SUBSTR(TWORK,I,6-I),'-',SUBSTR(TWORK,J,12-J));

   9500  8 001002   200003 720100                    LXL0    I,,AUTO
         8 001003   777771 620010                    EAX0    -7,X0
         8 001004   777777 660003                    ERX0    -1,DU
         8 001005   200003 236100                    LDQ     I,,AUTO
         8 001006   040100 100546                    MLR     fill='040'O
         8 001007   202135 000010                    ADSC9   TWORK,Q,AUTO             cn=0,n=*X0
         8 001010   202212 200117                    ADSC9   U3,,AUTO                 cn=1,n=79
         8 001011   000017 116000 9                  CMPQ    15
         8 001012   001034 604400 8                  TMOZ    s:9501
         8 001013   000111 621006                    EAX1    73,QL
         8 001014   200003 335100                    LCA     I,,AUTO
         8 001015   040145 100400                    MLR     fill='040'O
         8 001016   000020 000001 9                  ADSC9   16                       cn=0,n=1
         8 001017   202213 600011                    ADSC9   U3+1,A,AUTO              cn=3,n=*X1
         8 001020   200003 236100                    LDQ     I,,AUTO
         8 001021   000021 116000 9                  CMPQ    17
         8 001022   001034 604400 8                  TMOZ    s:9501
         8 001023   200004 720100                    LXL0    J,,AUTO
         8 001024   777763 620010                    EAX0    -13,X0
         8 001025   777777 660003                    ERX0    -1,DU
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:59   
         8 001026   000110 621006                    EAX1    72,QL
         8 001027   200003 335100                    LCA     I,,AUTO
         8 001030   200004 236100                    LDQ     J,,AUTO
         8 001031   040145 100546                    MLR     fill='040'O
         8 001032   202135 000010                    ADSC9   TWORK,Q,AUTO             cn=0,n=*X0
         8 001033   202214 000011                    ADSC9   U3+2,A,AUTO              cn=0,n=*X1

      507     9501    1           U3.L=19-I-J;

   9501  8 001034   200003 236100                    LDQ     I,,AUTO
         8 001035   200004 036100                    ADLQ    J,,AUTO
         8 001036   000022 676000 9                  ERQ     18
         8 001037   000024 036007                    ADLQ    20,DL
         8 001040   000033 736000                    QLS     27
         8 001041   202212 552140                    STBQ    U3,'40'O,AUTO

      508     9502
      509     9503        /****
      510     9504        *
      511     9505        *   Get the status of the output.  It is necessary to relinquish control
      512     9506        *   of the system (via M$WAIT) to allow the system to do something with
      513     9507        *   the output file so that JOBSTATS knows about it.  This may result in
      514     9508        *   the file being "lost", if it is small and transmitted during the
      515     9509        *   M$WAIT interval.
      516     9510        *
      517     9511        ****/
      518     9512
      519     9513    1           CALL CHARBIN(I,SUBSTR(JEPTR->DUMMY.NAME#.C,3,6));

   9513  8 001042   200010 470500                    LDP0    JEPTR,,AUTO
         8 001043   000100 305500                    DTB
         8 001044   000011 030006                    NDSC9   9,,PR0                   cn=0,s=nosgn,sf=0,n=6
         8 001045   200003 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      520     9514    1           FPT_JOBSTATS.V.SYSID#=I;

   9514  8 001046   200003 235100                    LDA     I,,AUTO
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:60   
         8 001047   001001 755000 1                  STA     FPT_JOBSTATS+25

      521     9515    1           CALL CHARBIN(I,SUBSTR(JEPTR->DUMMY.NAME#.C,9,6));

   9515  8 001050   000100 305500                    DTB
         8 001051   000012 430006                    NDSC9   10,,PR0                  cn=2,s=nosgn,sf=0,n=6
         8 001052   200003 000004                    NDSC9   I,,AUTO                  cn=0,s=lsgnf,sf=0,n=4

      522     9516    1           FPT_JOBSTATS.V.NUM#=I;

   9516  8 001053   200003 720100                    LXL0    I,,AUTO
         8 001054   001004 740000 1                  STX0    FPT_JOBSTATS+28

      523     9517    1           CALL M$WAIT(FPT_WAIT);

   9517  8 001055   001054 630400 1                  EPPR0   FPT_WAIT
         8 001056   020006 713400                    CLIMB   8198
         8 001057   400400 401760                    pmme    nvectors=2

      524     9518    1           VLP_CRITERIA.WSN#=OPTS.OUT.NODE;

   9518  8 001060   040000 100400                    MLR     fill='040'O
         8 001061   000072 000010 xsym               ADSC9   VW_OPTIONS#+58           cn=0,n=8
         8 001062   001016 000010 1                  ADSC9   VLP_CRITERIA+2           cn=0,n=8

      525     9519    1           CALL M$JOBSTATS(FPT_JOBSTATS);

   9519  8 001063   000750 630400 1                  EPPR0   FPT_JOBSTATS
         8 001064   170001 713400                    CLIMB   61441
         8 001065   405400 401760                    pmme    nvectors=12

      526     9520
      527     9521    2           IF VLR_JOBSTATS_CHECK.FCODE=%FS_PWAIT# THEN DO;

   9521  8 001066   001044 220000 1                  LDX0    VLR_JOBSTATS_CHECK+4
         8 001067   000002 100003                    CMPX0   2,DU
         8 001070   001153 601000 8                  TNZ     s:9531
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:61   

      528     9522    2              CALL BINCHAR(DWORK,VLR_JOBSTATS_CHECK.AHEAD);

   9522  8 001071   001042 235000 1                  LDA     VLR_JOBSTATS_CHECK+2
         8 001072   000044 773000                    LRL     36
         8 001073   202262 757100                    STAQ    U4+20,,AUTO
         8 001074   000100 301500                    BTD
         8 001075   202262 000010                    NDSC9   U4+20,,AUTO              cn=0,s=lsgnf,sf=0,n=8
         8 001076   202140 030010                    NDSC9   DWORK,,AUTO              cn=0,s=nosgn,sf=0,n=8

      529     9523    2              K=0;

   9523  8 001077   200005 450100                    STZ     K,,AUTO

      530     9524    3              DO WHILE(K<7 AND SUBSTR(DWORK,K,1)='0');

   9524  8 001100   001102 710000 8                  TRA     s:9526

      531     9525    3                 K=K+1;

   9525  8 001101   200005 054100                    AOS     K,,AUTO

      532     9526    3                 END;

   9526  8 001102   200005 235100                    LDA     K,,AUTO
         8 001103   000007 115007                    CMPA    7,DL
         8 001104   001111 605000 8                  TPL     s:9527
         8 001105   040000 106505                    CMPC    fill='040'O
         8 001106   202140 000001                    ADSC9   DWORK,A,AUTO             cn=0,n=1
         8 001107   000016 000001 9                  ADSC9   14                       cn=0,n=1
         8 001110   001101 600000 8                  TZE     s:9525

      533     9527    2              U4.C=SUBSTR(DWORK,K,8-K);

   9527  8 001111   777767 620005                    EAX0    -9,AL
         8 001112   777777 660003                    ERX0    -1,DU
         8 001113   040100 100545                    MLR     fill='040'O
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:62   
         8 001114   202140 000010                    ADSC9   DWORK,A,AUTO             cn=0,n=*X0
         8 001115   202236 200117                    ADSC9   U4,,AUTO                 cn=1,n=79

      534     9528    2              U4.L=8-K;

   9528  8 001116   000010 236007                    LDQ     8,DL
         8 001117   200005 136100                    SBLQ    K,,AUTO
         8 001120   000033 736000                    QLS     27
         8 001121   202236 552140                    STBQ    U4,'40'O,AUTO

      535     9529    2              CALL VWX$MAIL(%E$VWM_XWT,VECTOR(U3),VECTOR(U4));

   9529  8 001122   000011 235000 9                  LDA     9
         8 001123   202262 452500                    STP2    U4+20,,AUTO
         8 001124   202262 236100                    LDQ     U4+20,,AUTO
         8 001125   002212 036003                    ADLQ    1162,DU
         8 001126   202264 757100                    STAQ    U4+22,,AUTO
         8 001127   000011 235000 9                  LDA     9
         8 001130   202266 452500                    STP2    U4+24,,AUTO
         8 001131   202266 236100                    LDQ     U4+24,,AUTO
         8 001132   002236 036003                    ADLQ    1182,DU
         8 001133   202272 757100                    STAQ    U4+28,,AUTO
         8 001134   202264 237100                    LDAQ    U4+22,,AUTO
         8 001135   202270 757100                    STAQ    U4+26,,AUTO
         8 001136   202272 237100                    LDAQ    U4+28,,AUTO
         8 001137   202274 757100                    STAQ    U4+30,,AUTO
         8 001140   202274 630500                    EPPR0   U4+30,,AUTO
         8 001141   202300 450500                    STP0    U4+34,,AUTO
         8 001142   202270 631500                    EPPR1   U4+26,,AUTO
         8 001143   202277 451500                    STP1    U4+33,,AUTO
         8 001144   000024 236000 9                  LDQ     20
         8 001145   202276 756100                    STQ     U4+32,,AUTO
         8 001146   202276 630500                    EPPR0   U4+32,,AUTO
         8 001147   000012 631400 9                  EPPR1   10
         8 001150   000000 701000 xent               TSX1    VWX$MAIL
         8 001151   000000 011000                    NOP     0

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:63   
      536     9530    2              END;

   9530  8 001152   001230 710000 8                  TRA     s:9546

      537     9531    2           ELSE IF VLR_JOBSTATS_CHECK.FCODE=%FS_PRT# THEN DO;

   9531  8 001153   000003 100003                    CMPX0   3,DU
         8 001154   001213 601000 8                  TNZ     s:9537

      538     9532    2                 U4.C=VLR_JOBSTATS_CHECK.DEVNAME;

   9532  8 001155   040100 100400                    MLR     fill='040'O
         8 001156   001047 000004 1                  ADSC9   VLR_JOBSTATS_CHECK+7     cn=0,n=4
         8 001157   202236 200117                    ADSC9   U4,,AUTO                 cn=1,n=79

      539     9533    2                 U4.L=4;

   9533  8 001160   004000 236003                    LDQ     2048,DU
         8 001161   202236 552140                    STBQ    U4,'40'O,AUTO

      540     9534    2                 CALL VWX$MAIL(%E$VWM_XMT,VECTOR(U3),VECTOR(U4));

   9534  8 001162   000011 235000 9                  LDA     9
         8 001163   202262 452500                    STP2    U4+20,,AUTO
         8 001164   202262 236100                    LDQ     U4+20,,AUTO
         8 001165   002212 036003                    ADLQ    1162,DU
         8 001166   202264 757100                    STAQ    U4+22,,AUTO
         8 001167   000011 235000 9                  LDA     9
         8 001170   202266 452500                    STP2    U4+24,,AUTO
         8 001171   202266 236100                    LDQ     U4+24,,AUTO
         8 001172   002236 036003                    ADLQ    1182,DU
         8 001173   202272 757100                    STAQ    U4+28,,AUTO
         8 001174   202264 237100                    LDAQ    U4+22,,AUTO
         8 001175   202270 757100                    STAQ    U4+26,,AUTO
         8 001176   202272 237100                    LDAQ    U4+28,,AUTO
         8 001177   202274 757100                    STAQ    U4+30,,AUTO
         8 001200   202274 630500                    EPPR0   U4+30,,AUTO
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:64   
         8 001201   202300 450500                    STP0    U4+34,,AUTO
         8 001202   202270 631500                    EPPR1   U4+26,,AUTO
         8 001203   202277 451500                    STP1    U4+33,,AUTO
         8 001204   000026 236000 9                  LDQ     22
         8 001205   202276 756100                    STQ     U4+32,,AUTO
         8 001206   202276 630500                    EPPR0   U4+32,,AUTO
         8 001207   000012 631400 9                  EPPR1   10
         8 001210   000000 701000 xent               TSX1    VWX$MAIL
         8 001211   000000 011000                    NOP     0

      541     9535    2                 END;

   9535  8 001212   001230 710000 8                  TRA     s:9546

      542     9536    2              ELSE DO;

      543     9537    2                 CALL VWX$MAIL(%E$VWM_XBB,VECTOR(U3));

   9537  8 001213   000011 235000 9                  LDA     9
         8 001214   202262 452500                    STP2    U4+20,,AUTO
         8 001215   202262 236100                    LDQ     U4+20,,AUTO
         8 001216   002212 036003                    ADLQ    1162,DU
         8 001217   202264 757100                    STAQ    U4+22,,AUTO
         8 001220   202264 630500                    EPPR0   U4+22,,AUTO
         8 001221   202267 450500                    STP0    U4+25,,AUTO
         8 001222   000031 236000 9                  LDQ     25
         8 001223   202266 756100                    STQ     U4+24,,AUTO
         8 001224   202266 630500                    EPPR0   U4+24,,AUTO
         8 001225   000027 631400 9                  EPPR1   23
         8 001226   000000 701000 xent               TSX1    VWX$MAIL
         8 001227   000000 011000                    NOP     0

      544     9538    2                 END;

      545     9539
      546     9540        /****
      547     9541        *
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:65   
      548     9542        *   Return to caller.
      549     9543        *
      550     9544        ****/
      551     9545
      552     9546    1           RETURN;

   9546  8 001230   000000 702200 xent               TSX2  ! X66_ARET

      553     9547
      554     9548        /****
      555     9549        *
      556     9550        *   Input FID too long.
      557     9551        *
      558     9552        ****/
      559     9553
      560     9554    1   SUCK_BAD_ITL:
      561     9555    1           ERRCODE=%E$VWM_ITL;

   9555  8 001231   000032 235000 9     SUCK_BAD_ITL LDA     26
         8 001232   200007 755100                    STA     ERRCODE,,AUTO

      562     9556    1           GOTO SUCK_USRERR;

   9556  8 001233   001264 710000 8                  TRA     SUCK_USRERR

      563     9557
      564     9558        /****
      565     9559        *
      566     9560        *   Output FID too long.
      567     9561        *
      568     9562        ****/
      569     9563
      570     9564    1   SUCK_BAD_OTL:
      571     9565    1           ERRCODE=%E$VWM_OTL;

   9565  8 001234   000033 235000 9     SUCK_BAD_OTL LDA     27
         8 001235   200007 755100                    STA     ERRCODE,,AUTO
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:66   

      572     9566    1           GOTO SUCK_USRERR;

   9566  8 001236   001264 710000 8                  TRA     SUCK_USRERR

      573     9567
      574     9568        /****
      575     9569        *
      576     9570        *   Error from M$FID on input FID.
      577     9571        *
      578     9572        ****/
      579     9573
      580     9574    1   SUCK_BAD_INP:
      581     9575    1           ERRCODE=%E$VWM_INP;

   9575  8 001237   000034 235000 9     SUCK_BAD_INP LDA     28
         8 001240   200007 755100                    STA     ERRCODE,,AUTO

      582     9576    1           GOTO SUCK_USRERR;

   9576  8 001241   001264 710000 8                  TRA     SUCK_USRERR

      583     9577
      584     9578        /****
      585     9579        *
      586     9580        *   Error from M$FID on output FID.
      587     9581        *
      588     9582        ****/
      589     9583
      590     9584    1   SUCK_BAD_OUT:
      591     9585    1           ERRCODE=%E$VWM_OUT;

   9585  8 001242   000035 235000 9     SUCK_BAD_OUT LDA     29
         8 001243   200007 755100                    STA     ERRCODE,,AUTO

      592     9586    1           GOTO SUCK_USRERR;

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:67   
   9586  8 001244   001264 710000 8                  TRA     SUCK_USRERR

      593     9587
      594     9588        /****
      595     9589        *
      596     9590        *   Unknown or invalid destination node.
      597     9591        *
      598     9592        ****/
      599     9593
      600     9594    1   SUCK_BAD_DST:
      601     9595    1           ERRCODE=%E$VWM_DST;

   9595  8 001245   000036 235000 9     SUCK_BAD_DST LDA     30
         8 001246   200007 755100                    STA     ERRCODE,,AUTO

      602     9596    1           GOTO SUCK_USRERR;

   9596  8 001247   001264 710000 8                  TRA     SUCK_USRERR

      603     9597
      604     9598        /****
      605     9599        *
      606     9600        *   Unknown or invalid source node.
      607     9601        *
      608     9602        ****/
      609     9603
      610     9604    1   SUCK_BAD_SRC:
      611     9605    1           ERRCODE=%E$VWM_SRC;

   9605  8 001250   000037 235000 9     SUCK_BAD_SRC LDA     31
         8 001251   200007 755100                    STA     ERRCODE,,AUTO

      612     9606    1           GOTO SUCK_USRERR;

   9606  8 001252   001264 710000 8                  TRA     SUCK_USRERR

      613     9607
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:68   
      614     9608        /****
      615     9609        *
      616     9610        *   Unable to open JE@source node.
      617     9611        *
      618     9612        ****/
      619     9613
      620     9614    1   SUCK_BAD_NODE:
      621     9615    1           ERRDCB=DCBNUM(M$JE);

   9615  8 001253   000000 236007 xsym  SUCK_BAD_NO* LDQ     M$JE,DL
         8 001254   200006 756100                    STQ     ERRDCB,,AUTO

      622     9616    1           GOTO SUCK_SYSERR;

   9616  8 001255   001273 710000 8                  TRA     SUCK_SYSERR

      623     9617
      624     9618        /****
      625     9619        *
      626     9620        *   Error closing JE@source node.
      627     9621        *
      628     9622        ****/
      629     9623
      630     9624    1   SUCK_BAD_ONE:
      631     9625    1           ERRDCB=DCBNUM(M$JE);

   9625  8 001256   000000 236007 xsym  SUCK_BAD_ONE LDQ     M$JE,DL
         8 001257   200006 756100                    STQ     ERRDCB,,AUTO

      632     9626    1           GOTO SUCK_SYSERR;

   9626  8 001260   001273 710000 8                  TRA     SUCK_SYSERR

      633     9627
      634     9628        /****
      635     9629        *
      636     9630        *   Error writing to JE@source node.
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:69   
      637     9631        *
      638     9632        ****/
      639     9633
      640     9634    1   SUCK_BAD_WRJ:
      641     9635    1           ERRDCB=DCBNUM(M$JE);

   9635  8 001261   000000 236007 xsym  SUCK_BAD_WRJ LDQ     M$JE,DL
         8 001262   200006 756100                    STQ     ERRDCB,,AUTO

      642     9636    1           GOTO SUCK_SYSERR;

   9636  8 001263   001273 710000 8                  TRA     SUCK_SYSERR

      643     9637
      644     9638        /****
      645     9639        *
      646     9640        *   Handle user-error conditions.
      647     9641        *
      648     9642        ****/
      649     9643
      650     9644    1   SUCK_USRERR:
      651     9645    1           CALL VWX$MAIL(ERRCODE);

   9645  8 001264   200007 630500       SUCK_USRERR  EPPR0   ERRCODE,,AUTO
         8 001265   202262 450500                    STP0    U4+20,,AUTO
         8 001266   202262 630500                    EPPR0   U4+20,,AUTO
         8 001267   000015 631400 9                  EPPR1   13
         8 001270   000000 701000 xent               TSX1    VWX$MAIL
         8 001271   000000 011000                    NOP     0

      652     9646    1           GOTO SUCK_ABORT;

   9646  8 001272   001317 710000 8                  TRA     SUCK_ABORT

      653     9647
      654     9648        /****
      655     9649        *
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:70   
      656     9650        *   Report the error and DCB for monitor errors.
      657     9651        *
      658     9652        ****/
      659     9653
      660     9654    1   SUCK_SYSERR:
      661     9655    1           ERRBITS=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   9655  8 001273   000000 470400 xsym  SUCK_SYSERR  LDP0    B$TCB$
         8 001274   000000 471500                    LDP1    0,,PR0
         8 001275   100102 236100                    LDQ     66,,PR1
         8 001276   200007 756100                    STQ     ERRCODE,,AUTO

      662     9656    1           ERRBITS.SEV=0;

   9656  8 001277   000040 236000 9                  LDQ     32
         8 001300   200007 356100                    ANSQ    ERRCODE,,AUTO

      663     9657    1           CALL VWX$MAIL(ERRCODE,,,,ERRDCB);

   9657  8 001301   200006 631500                    EPPR1   ERRDCB,,AUTO
         8 001302   202266 451500                    STP1    U4+24,,AUTO
         8 001303   000042 236000 9                  LDQ     34
         8 001304   000042 235000 9                  LDA     34
         8 001305   202264 757100                    STAQ    U4+22,,AUTO
         8 001306   000042 236000 9                  LDQ     34
         8 001307   202263 756100                    STQ     U4+21,,AUTO
         8 001310   200007 633500                    EPPR3   ERRCODE,,AUTO
         8 001311   202262 453500                    STP3    U4+20,,AUTO
         8 001312   202262 630500                    EPPR0   U4+20,,AUTO
         8 001313   000041 631400 9                  EPPR1   33
         8 001314   000000 701000 xent               TSX1    VWX$MAIL
         8 001315   000000 011000                    NOP     0

      664     9658    1           GOTO SUCK_ABORT;

   9658  8 001316   001317 710000 8                  TRA     SUCK_ABORT

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:71   
      665     9659
      666     9660        /****
      667     9661        *
      668     9662        *   Close and release the symbiont file (otherwise, it gets shipped!).
      669     9663        *
      670     9664        ****/
      671     9665
      672     9666    1   SUCK_ABORT:
      673     9667    1           CLOSE_JE.V.DISP#=%RELEASE#;

   9667  8 001317   000001 236007       SUCK_ABORT   LDQ     1,DL
         8 001320   000744 552004 1                  STBQ    CLOSE_JE+26,'04'O

      674     9668    1           IF JEPTR->DUMMY.FCD# THEN

   9668  8 001321   200010 470500                    LDP0    JEPTR,,AUTO
         8 001322   000031 236100                    LDQ     25,,PR0
         8 001323   020000 316007                    CANQ    8192,DL
         8 001324   001330 600000 8                  TZE     s:9670

      675     9669    1              CALL M$CLOSE(CLOSE_JE);

   9669  8 001325   000712 630400 1                  EPPR0   CLOSE_JE
         8 001326   050001 713400                    CLIMB   close
         8 001327   406000 401760                    pmme    nvectors=13

      676     9670    1           ALTRETURN;

   9670  8 001330   000000 702200 xent               TSX2  ! X66_AALT

OPEN_NODE
 Sect OctLoc
   1     000   000025 777640   000044 006000   000000 177640   000000 006014    .....$..........
   1     004   000000 177640   000000 006014   000001 577640   000072 006000    .............:..
   1     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     024*  000001 777640   000000 006000   000000 177640   000000 006014    ................
   1     030   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:72   
   1     044*  000000 000042   000000 002001   252525 002002   000040 252520    ..."......... ..
   1     050   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     060   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     064   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     070   000000 000000   ****** ******                                    ........

NAME_NODE
 Sect OctLoc
   1     072   006072 116117   104105 123***                                    .:NODES.

READ_NODE
 Sect OctLoc
   1     074   000005 777640   000104 006000   000002 177640   000150 006000    .....D.......h..
   1     100   000005 377640   000153 006000   000000 177640   000000 006014    .....k..........
   1     104   000000 600000   000000 000000   000000 000000   000000 000000    ................
   1     110   000000 000000   000000 000000                                    ........

CLOSE_NODE
 Sect OctLoc
   1     112   000003 777640   000144 006000   000000 177640   000000 006014    .....d..........
   1     116   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     142*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     146   000220 000000   000000 000000                                    ........

NODEKEY
 Sect OctLoc
   1     150   010*** ******   ****** ******   ****** ******                    ............

NODEOVR
 Sect OctLoc
   1     153   ****** ******   ****** ******   ****** ******   ****** ******    ................

OPEN_INP
 Sect OctLoc
   1     162   000025 777640   000226 006000   000011 777640   000270 006000    ................
   1     166   000000 177640   000000 006014   000007 777640   000254 006000    ................
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:73   
   1     172   000001 777640   000266 006000   000000 177640   000000 006014    ................
   1     176   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     206*  000001 777640   000264 006000   000000 177640   000000 006014    ................
   1     212   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     226*  000000 000042   000000 000000   252525 000000   000040 252520    ..."......... ..
   1     232   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     236   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     242   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     246   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     252   000000 000000   ****** ******                                    ........

NAME_INP
 Sect OctLoc
   1     254   001040 040040   040040 040040   040040 040040   040040 040040    .
   1     260   040040 040040   040040 040040   040040 040040   040040 040040

ACCT_INP
 Sect OctLoc
   1     264   040040 040040   040040 040040

PASS_INP
 Sect OctLoc
   1     266   040040 040040   040040 040040

SN_INP
 Sect OctLoc
   1     270   000000 000006   040040 040040   040040 040040   040040 040040    ....
   1     274   040040 040040   040040 040040   040040 040040   040040 040040
   1     300   040040 040040   040040 040040

FID_INP
 Sect OctLoc
   1     302   000003 777640   000326 006000   000000 177640   000000 006014    ................
   1     306   000007 777640   000254 006000   000001 777640   000264 006000    ................
   1     312   000001 777640   000266 006000   000011 777640   000270 006000    ................
   1     316   000000 177640   000000 006014   000000 177640   000227 606000    ................
   1     322   000000 777640   000232 006000   000011 777640   000332 006000    ................
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:74   
   1     326   777000 000000   000000 000000   000000 000000   ****** ******    ................

VLR_INP
 Sect OctLoc
   1     332   ****** ******   ****** ******   ****** ******   ****** ******    ................

OPEN_OUT
 Sect OctLoc
   1     344   000025 777640   000410 006000   000011 777640   000452 006000    ................
   1     350   000000 177640   000000 006014   000007 777640   000436 006000    ................
   1     354   000001 777640   000450 006000   000000 177640   000000 006014    ................
   1     360   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     370*  000001 777640   000446 006000   000000 177640   000000 006014    ................
   1     374   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     410*  000000 420442   000000 002000   252525 000000   000040 252520    ............. ..
   1     414   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     420   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     424   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     430   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     434   000000 000000   ****** ******                                    ........

NAME_OUT
 Sect OctLoc
   1     436   001040 040040   040040 040040   040040 040040   040040 040040    .
   1     442   040040 040040   040040 040040   040040 040040   040040 040040

ACCT_OUT
 Sect OctLoc
   1     446   040040 040040   040040 040040

PASS_OUT
 Sect OctLoc
   1     450   040040 040040   040040 040040

SN_OUT
 Sect OctLoc
   1     452   000000 000006   040040 040040   040040 040040   040040 040040    ....
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:75   
   1     456   040040 040040   040040 040040   040040 040040   040040 040040
   1     462   040040 040040   040040 040040

FID_OUT
 Sect OctLoc
   1     464   000003 777640   000510 006000   000000 177640   000000 006014    ................
   1     470   000007 777640   000436 006000   000001 777640   000446 006000    ................
   1     474   000001 777640   000450 006000   000011 777640   000452 006000    ................
   1     500   000000 177640   000000 006014   000000 177640   000411 606000    ................
   1     504   000000 777640   000414 006000   000011 777640   000514 006000    ................
   1     510   777000 000000   000000 000000   000000 000000   ****** ******    ................

VLR_OUT
 Sect OctLoc
   1     514   ****** ******   ****** ******   ****** ******   ****** ******    ................

UNFID_INP
 Sect OctLoc
   1     526   000001 777640   000552 006000   000000 177640   000000 006014    ................
   1     532   000007 777640   000254 006000   000001 777640   000264 006000    ................
   1     536   000000 177640   000000 006014   000011 777640   000270 006000    ................
   1     542   000000 177640   000000 006014   000000 177640   000227 606000    ................
   1     546   000000 777640   000232 006000   000000 177640   000000 006014    ................
   1     552   000000 000000   0***** ******                                    ........

UNFID_OUT
 Sect OctLoc
   1     554   000001 777640   000600 006000   000000 177640   000000 006014    ................
   1     560   000007 777640   000436 006000   000001 777640   000446 006000    ................
   1     564   000000 177640   000000 006014   000011 777640   000452 006000    ................
   1     570   000000 177640   000000 006014   000000 177640   000411 606000    ................
   1     574   000000 777640   000414 006000   000000 177640   000000 006014    ................
   1     600   000000 000000   0***** ******                                    ........

OPEN_JE
 Sect OctLoc
   1     602   000025 777640   000646 006000   000000 177640   000000 006014    ................
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:76   
   1     606   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     632*  000000 177640   000000 006014   000001 777640   000674 006000    ................
   1     636   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     646*  000000 400242   000000 003003   252525 000000   000040 252520    ............. ..
   1     652   112105 040040   000000 000000   000000 777777   000000 000000    JE  ............
   1     656   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     662   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     666   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     672   000000 000000   ****** ******                                    ........

WSN_JE
 Sect OctLoc
   1     674   040040 040040   040040 040040

WRITE_JE
 Sect OctLoc
   1     676   000003 777640   000706 006000   000000 177640   000000 006014    ................
   1     702   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     706   000000 400400   000000 000000   000000 000000   000000 000000    ................

CLOSE_JE
 Sect OctLoc
   1     712   000003 777640   000744 006000   000000 177640   000000 006014    ................
   1     716   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     742*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     746   000220 000000   000000 000000                                    ........

FPT_JOBSTATS
 Sect OctLoc
   1     750   000013 777640   001000 006000   000000 177640   000000 006014    ................
   1     754   000013 777640   001040 006000   000023 777640   001014 006000    ..... ..........
   1     760   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1    1000*  000000 000007   000000 000000   000000 000000   000000 000000    ................
   1    1004   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    1010   000000 000000   000000 000000   000000 000000   000000 000000    ................

VLP_CRITERIA
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:77   
 Sect OctLoc
   1    1014   040040 040040   040040 040040   040040 040040   040040 040040
   1    1020   040040 040040   040040 040040   000000 000000   000000 000000            ........
   1    1024   000000 000000   000000 000377   000000 000377   040040 ******    ............  ..
   1    1030   000000 000000   040040 040040   040040 000000   000000 000000    ....      ......
   1    1034   000000 000000   000000 000000   000000 000000   000000 ******    ................

VLR_JOBSTATS_CHECK
 Sect OctLoc
   1    1040   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1    1044   000000 000000   000000 000000   000000 000000   040040 040040    ............
   1    1050   000000 000000   040040 040040   040040 040040                    ....

FPT_WAIT
 Sect OctLoc
   1    1054   000001 777640   001060 006000   000000 177640   000000 006014    .....0..........
   1    1060   000000 000001   000000 000001                                    ........

ACCT_NODE
 Sect OctLoc
   2     000   072123 131123   040040 040040                                    :SYS

MODE
 Sect OctLoc
   3     000   006144 151141   154165 160040   040040 040040   010150 141162    .dialup     .har
   3     004   144167 151162   145040 040040                                    dwire

TYPE
 Sect OctLoc
   3     006   006103 120066   103060 060040   040006 103120   066102 060063    .CP6C00  .CP6B03
   3     012   040040 006103   120066 102060   062040 040003   103120 066040      .CP6B02  .CP6
   3     016   040040 040040   004103 120055   066040 040040   040003 103120        .CP-6    .CP
   3     022   126040 040040   040040 004103   120055 126040   040040 040005    V     .CP-V    .
   3     026   107103 117123   063040 040040   005107 103117   123070 040040    GCOS3   .GCOS8
   3     032   040007 107103   117123 066120   106040 005107   103117 123066     .GCOS6PF .GCOS6
   3     036   040040 040010   105130 124105   122116 101114                       .EXTERNAL

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:78   
(unnamed)
 Sect OctLoc
   3     041   040040 040040   117120 124123                                        OPTS

(unnamed)
 Sect OctLoc
   9     000   000000 006003   000023 600000   000023 577640   002142 200000    .............b..
   9     004   002166 200000   040040 040040   000024 206000   000074 206000    .v..    .....<..
   9     010   100040 040040   000023 777640   000003 000000   262715 000540    @   ............
   9     014   000013 006000   000001 000000   060040 040040   777777 777667    ........0   ....
   9     020   055040 040040   777777 777670   777777 777777   262715 000510    -   ............
   9     024   000023 006000   262715 000520   000025 006000   000002 000000    ................
   9     030   262715 000530   000030 006000   262715 000050   262715 000060    ...........(...0
   9     034   262715 000010   262715 000020   262715 000220   262715 000230    ................
   9     040   777777 777770   000005 000000   000000 006014                    ............
      677     9671
      678     9672    1   END;

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:79   
--  Include file information  --

   VW_FPTS_M.:VMB6TOU  cannot be made into a system file and is referenced.
   VW_NODEATER_E.:VMB6TOU  is referenced.
   VW_OPTS_M.:VMB6TOU  is referenced.
   VWM_ERRS_E.:VMB6TOU  is referenced.
   VW_MOVE_E.:VMB6TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6_C.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure VWK$SUCK.
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:80   

 **** Variables and constants ****

  ****  Section 001  Data  VWK$SUCK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   264-0-0/c STRC(72)    r     1 ACCT_INP                 446-0-0/c STRC(72)    r     1 ACCT_OUT
   712-0-0/d STRC(1080)  r     1 CLOSE_JE                 112-0-0/d STRC(1080)  r     1 CLOSE_NODE
   302-0-0/d STRC(864)   r     1 FID_INP                  464-0-0/d STRC(864)   r     1 FID_OUT
   750-0-0/d STRC(1296)  r     1 FPT_JOBSTATS            1054-0-0/d STRC(216)   r     1 FPT_WAIT
   254-0-0/c STRC(288)   r     1 NAME_INP                  72-0-0/c STRC(63)    r     1 NAME_NODE
   436-0-0/c STRC(288)   r     1 NAME_OUT                 150-0-0/c STRC(81)    r     1 NODEKEY
   153-0-0/c STRC(198)   r     1 NODEOVR                  153-0-0/c CHAR(22)    r     1 NODEREC
   162-0-0/d STRC(2088)  r     1 OPEN_INP                 602-0-0/d STRC(2088)  r     1 OPEN_JE
     0-0-0/d STRC(2088)  r     1 OPEN_NODE                344-0-0/d STRC(2088)  r     1 OPEN_OUT
   266-0-0/c STRC(72)    r     1 PASS_INP                 450-0-0/c STRC(72)    r     1 PASS_OUT
    74-0-0/d STRC(504)   r     1 READ_NODE                270-0-0/d STRC(360)   r     1 SN_INP
   452-0-0/d STRC(360)   r     1 SN_OUT                   526-0-0/d STRC(792)   r     1 UNFID_INP
   554-0-0/d STRC(792)   r     1 UNFID_OUT               1014-0-0/d STRC(702)   r     1 VLP_CRITERIA
   332-0-0/d STRC(324)   r     1 VLR_INP                 1040-0-0/d STRC(396)   r     1 VLR_JOBSTATS_CHECK
   514-0-0/d STRC(324)   r     1 VLR_OUT                  676-0-0/d STRC(432)   r     1 WRITE_JE
   674-0-0/c STRC(72)    r     1 WSN_JE

  ****  Section 002 RtLmCm ACCT_NODE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(72)    r     1 ACCT_NODE

  ****  Section 003 RoData VWK$SUCK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(108)         1 MODE(0:1)                  6-0-0/c STRC(81)          1 TYPE(0:11)
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:81   

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  2140-0-0/c CHAR(8)     r     1 DWORK                      7-0-0/w STRC        r     1 ERRBITS
     7-0-0/w SBIN        r     1 ERRCODE                    6-0-0/w SBIN        r     1 ERRDCB
    11-0-0/c CHAR(4096)        1 FITBUF                     3-0-0/w SBIN        r     1 I
     4-0-0/w SBIN        r     1 J                       2111-0-0/c CHAR(80)    r     1 JEBUF
    10-0-0/w PTR         r     1 JEPTR                      5-0-0/w SBIN        r     1 K
  2011-0-0/c CHAR(256)         1 LOBUF                   2135-0-0/c CHAR(12)    r     1 TWORK
  2142-0-0/c STRC(720)   r     1 U1                      2166-0-0/c STRC(720)   r     1 U2
  2212-0-0/c STRC(720)   r     1 U3                      2236-0-0/c STRC(720)   r     1 U4

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/c CHAR(80)    r     1 CARD(0:24)
     0-0-0/c STRC(18000) r     1 OPTS                       0-0-0/w SBIN              1 VW_BROKEN#
     0-0-0/c CHAR(8)     r     1 VW_IAM#                    0-0-0/c CHAR(2000)  r     1 VW_OPTIONS#
     0-0-0/w SBIN        r     1 VW_OUTCNT#                 0-0-0/b BIT         r     1 VW_SCRAMBLE#

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 DUMMY                      0-0-0N  NULL        r     1 M$JE
     0-0-0N  NULL        r     1 M$LM                       0-0-0N  NULL        r     1 M$NODE
     0-0-0N  NULL        r     1 M$OUT                      0-0-0N  NULL        r     1 M$UC
     0-0-0/c STRC(720)         1 OPTSCHAR                   0-0-0/c STRC(720)         1 OPTSDATE
     0-0-0/c STRC(720)         1 OPTSRECS

PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:82   

   Procedure VWK$SUCK requires 729 words for executable code.
   Procedure VWK$SUCK requires 1218 words of local(AUTO) storage.

    No errors detected in file VWK$SUCK.:VMB6TSI    .
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:84   
          MINI XREF LISTING

ACCT_INP
      8452**DCL      8370--DCLINIT  8504--DCLINIT  8798--DCLINIT
ACCT_NODE
      8054**DCL      7971--DCLINIT
ACCT_OUT
      8697**DCL      8615--DCLINIT  8749--DCLINIT  8822--DCLINIT
B$ALT.CODE
      9132**DCL      9132--REDEF    9133--REDEF    9133--REDEF
B$ALT.ERR
      9133**DCL      9655>>ASSIGN
B$ALT.ERR.ERR#
      9134**DCL      9134--REDEF
B$ALT.EVID
      9133**DCL      9133--REDEF    9133--REDEF
B$TCB.ALT$
      9127**DCL      9655>>ASSIGN
B$TCB$
      9228**DCL      9655>>ASSIGN
CARD
      7684**DCL      9377>>ASSIGN   9381>>ASSIGN   9386>>ASSIGN   9390>>ASSIGN   9403>>ASSIGN   9407>>ASSIGN
      9421>>ASSIGN   9425>>ASSIGN   9439>>ASSIGN   9443>>ASSIGN   9457>>DOWHILE  9458>>ASSIGN
CLOSE_JE
      9019**DCL      9482<>CALL     9669<>CALL
CLOSE_JE.SN_
      9019**DCL      9019--REDEF
CLOSE_JE.UTL_
      9020**DCL      9020--REDEF
CLOSE_JE.V
      9024**DCL      9019--DCLINIT
CLOSE_JE.V.DISP#
      9028**DCL      9481<<ASSIGN   9667<<ASSIGN
CLOSE_JE.V.EXPIRE#
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:85   
      9034**DCL      9034--REDEF
CLOSE_JE.V.TYPE#
      9032**DCL      9032--REDEF
CLOSE_JE.V.XTNSIZE#
      9029**DCL      9029--REDEF    9031--REDEF
CLOSE_NODE.SN_
      8126**DCL      8126--REDEF
CLOSE_NODE.UTL_
      8127**DCL      8127--REDEF
CLOSE_NODE.V
      8131**DCL      8126--DCLINIT
CLOSE_NODE.V.EXPIRE#
      8141**DCL      8141--REDEF
CLOSE_NODE.V.TYPE#
      8139**DCL      8139--REDEF
CLOSE_NODE.V.XTNSIZE#
      8136**DCL      8136--REDEF    8138--REDEF
DUMMY.ACTPOS
      9172**DCL      9172--REDEF
DUMMY.ARS#
      9146**DCL      9146--REDEF    9292>>IF
DUMMY.ATTR
      9165**DCL      9166--REDEF
DUMMY.BORROW
      9180**DCL      9180--REDEF    9180--REDEF    9180--REDEF
DUMMY.DCBNAME.L
      9194**DCL      9194--IMP-SIZ
DUMMY.EOMCHAR#
      9150**DCL      9150--REDEF
DUMMY.FCD#
      9159**DCL      9668>>IF
DUMMY.FLDID
      9175**DCL      9175--REDEF
DUMMY.FORM$
      9169**DCL      9169--REDEF
DUMMY.FSECT
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:86   
      9185**DCL      9185--REDEF
DUMMY.FSN#
      9162**DCL      9162--REDEF    9162--REDEF    9163--REDEF
DUMMY.HEADER$
      9168**DCL      9168--REDEF
DUMMY.IXTNSIZE#
      9166**DCL      9166--REDEF
DUMMY.LASTSTA$
      9155**DCL      9155--REDEF
DUMMY.LVL
      9181**DCL      9181--REDEF
DUMMY.NAME#.C
      9156**DCL      9156--REDEF    9491>>ASSIGN   9513>>CALLBLT  9515>>CALLBLT
DUMMY.NOEOF
      9178**DCL      9178--REDEF
DUMMY.NRECS#
      9167**DCL      9167--REDEF
DUMMY.NRECX
      9186**DCL      9186--REDEF
DUMMY.OHDR
      9178**DCL      9178--REDEF
DUMMY.ORG#
      9161**DCL      9161--REDEF
DUMMY.PRECNO
      9184**DCL      9184--REDEF
DUMMY.RCSZ
      9190**DCL      9190--REDEF
DUMMY.RES#
      9157**DCL      9157--REDEF
DUMMY.SETX
      9169**DCL      9169--REDEF
DUMMY.TAB$
      9169**DCL      9169--REDEF
DUMMY.TDA
      9183**DCL      9184--REDEF
DUMMY.WSN#
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:87   
      9157**DCL      9157--REDEF
DWORK
      9235**DCL      9522<<CALLBLT  9524>>DOWHILE  9527>>ASSIGN
ERRBITS
      9221**DCL      9655<<ASSIGN
ERRBITS.SEV
      9225**DCL      9656<<ASSIGN
ERRCODE
      9220**DCL      9221--REDEF    9555<<ASSIGN   9565<<ASSIGN   9575<<ASSIGN   9585<<ASSIGN   9595<<ASSIGN
      9605<<ASSIGN   9645<>CALL     9657<>CALL
ERRDCB
      9218**DCL      9615<<ASSIGN   9625<<ASSIGN   9635<<ASSIGN   9657<>CALL
FID_INP
      8503**DCL      9310<>CALL
FID_INP.TEXTFID_
      8503**DCL      9309<<ASSIGN
FID_INP.V
      8507**DCL      8503--DCLINIT
FID_OUT
      8748**DCL      9324<>CALL
FID_OUT.TEXTFID_
      8748**DCL      9323<<ASSIGN
FID_OUT.V
      8752**DCL      8748--DCLINIT
FPT_JOBSTATS
      9052**DCL      9519<>CALL
FPT_JOBSTATS.V
      9056**DCL      9052--DCLINIT
FPT_JOBSTATS.V.NUM#
      9058**DCL      9516<<ASSIGN
FPT_JOBSTATS.V.SYSID#
      9056**DCL      9514<<ASSIGN
FPT_WAIT
      9122**DCL      9517<>CALL
FPT_WAIT.V
      9123**DCL      9122--DCLINIT
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:88   
I
      9213**DCL      9266--ASSIGN   9268--ASSIGN   9306<<ASSIGN   9307>>IF       9307>>IF       9309>>ASSIGN
      9320<<ASSIGN   9321>>IF       9321>>IF       9323>>ASSIGN   9335<<ASSIGN   9340>>CALLBLT  9341<<CALLBLT
      9341>>CALLBLT  9343>>ASSIGN   9347<<ASSIGN   9352>>CALLBLT  9353<<CALLBLT  9353>>CALLBLT  9355>>ASSIGN
      9366<<ASSIGN   9367<>CALL     9456<<ASSIGN   9457>>DOWHILE  9457>>DOWHILE  9458>>ASSIGN   9463<<ASSIGN
      9463>>ASSIGN   9472<<ASSIGN   9473<>CALL     9492<<ASSIGN   9493>>DOWHILE  9494<<ASSIGN   9494>>ASSIGN
      9500>>CALLBLT  9500>>CALLBLT  9501>>ASSIGN   9513<<CALLBLT  9514>>ASSIGN   9515<<CALLBLT  9516>>ASSIGN
J
      9214**DCL      9496<<ASSIGN   9497>>DOWHILE  9498<<ASSIGN   9498>>ASSIGN   9500>>CALLBLT  9500>>CALLBLT
      9501>>ASSIGN
JEBUF
      9233**DCL      9263--ASSIGN   9367<>CALL     9377<<ASSIGN   9379<>CALL     9381<<ASSIGN   9383<>CALL
      9386<<ASSIGN   9388<>CALL     9390<<ASSIGN   9392<>CALL     9403<<ASSIGN   9405<>CALL     9407<<ASSIGN
      9409<>CALL     9421<<ASSIGN   9423<>CALL     9425<<ASSIGN   9427<>CALL     9439<<ASSIGN   9441<>CALL
      9443<<ASSIGN   9445<>CALL     9458<<ASSIGN   9460<>CALL     9473<>CALL
JEPTR
      9229**DCL      9260<<ASSIGN   9491>>ASSIGN   9513>>CALLBLT  9515>>CALLBLT  9668>>IF
K
      9215**DCL      9523<<ASSIGN   9524>>DOWHILE  9524>>DOWHILE  9525<<ASSIGN   9525>>ASSIGN   9527>>ASSIGN
      9527>>ASSIGN   9528>>ASSIGN
M$CLOSE
      5561**DCL-ENT  9482--CALL     9669--CALL
M$FID
      5624**DCL-ENT  9310--CALL     9324--CALL
M$JE
      9204**DCL      9260--ASSIGN   9367<>CALL     9473<>CALL     9615>>ASSIGN   9625>>ASSIGN   9635>>ASSIGN
M$JOBSTATS
      5626**DCL-ENT  9519--CALL
M$NODE
      9206**DCL      9292--IF
M$OPEN
      5561**DCL-ENT  9297--CALL
M$READ
      5562**DCL-ENT  9279--CALL     9291--CALL     9294--CALL
M$UNFID
      5624**DCL-ENT  9338--CALL     9350--CALL
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:89   
M$WAIT
      5619**DCL-ENT  9517--CALL
M$WRITE
      5562**DCL-ENT  9380--CALL     9384--CALL     9389--CALL     9393--CALL     9406--CALL     9410--CALL
      9424--CALL     9428--CALL     9442--CALL     9446--CALL     9461--CALL
NAME_INP
      8437**DCL      8366--DCLINIT  8504--DCLINIT  8798--DCLINIT
NAME_NODE
      8038**DCL      7967--DCLINIT
NAME_OUT
      8682**DCL      8611--DCLINIT  8749--DCLINIT  8822--DCLINIT
NAME_OUT.L#
      8682**DCL      9261<<ASSIGN
NODEKEY
      8182**DCL      8078--DCLINIT  8079--DCLINIT
NODEKEY.C
      8184**DCL      9278<<ASSIGN   9290<<ASSIGN   9293<<ASSIGN   9365>>ASSIGN
NODEKEY.L
      8183**DCL      9269<<ASSIGN
NODEOVR
      8193**DCL      8288--REDEF
NODEOVR.PATH_NAME
      8202**DCL      8213--REDEF    9293>>ASSIGN   9296>>ASSIGN
NODEOVR.TYPE_PATH
      8251**DCL      9366>>ASSIGN   9472>>ASSIGN
NODEREC
      8288**DCL      8080--DCLINIT  8081--DCLINIT
OPEN_INP.ACSVEH_
      8367**DCL      8368--REDEF
OPEN_INP.ALTKEYS_
      8373**DCL      8374--REDEF    8374--REDEF
OPEN_INP.HDR_
      8372**DCL      8373--REDEF
OPEN_INP.TAB_
      8371**DCL      8372--REDEF
OPEN_INP.UHL_
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:90   
      8365**DCL      8366--REDEF    8366--REDEF
OPEN_INP.V
      8374**DCL      8365--DCLINIT
OPEN_INP.V.ASN#
      8384**DCL      8506--DCLINIT  8800--DCLINIT
OPEN_INP.V.FSN#
      8405**DCL      8405--REDEF    8405--REDEF
OPEN_INP.V.RES#
      8389**DCL      8506--DCLINIT  8800--DCLINIT
OPEN_INP.WSN_
      8371**DCL      8371--REDEF
OPEN_JE
      8901**DCL      9297<>CALL
OPEN_JE.ACSVEH_
      8903**DCL      8904--REDEF
OPEN_JE.ALTKEYS_
      8909**DCL      8910--REDEF    8910--REDEF
OPEN_JE.HDR_
      8908**DCL      8909--REDEF
OPEN_JE.TAB_
      8907**DCL      8908--REDEF
OPEN_JE.UHL_
      8901**DCL      8902--REDEF    8902--REDEF
OPEN_JE.V
      8910**DCL      8901--DCLINIT
OPEN_JE.V.FSN#
      8941**DCL      8941--REDEF    8941--REDEF
OPEN_JE.WSN_
      8907**DCL      8907--REDEF
OPEN_NODE.ACSVEH_
      7968**DCL      7969--REDEF
OPEN_NODE.ALTKEYS_
      7974**DCL      7975--REDEF    7975--REDEF
OPEN_NODE.HDR_
      7973**DCL      7974--REDEF
OPEN_NODE.TAB_
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:91   
      7972**DCL      7973--REDEF
OPEN_NODE.UHL_
      7966**DCL      7967--REDEF    7967--REDEF
OPEN_NODE.V
      7975**DCL      7966--DCLINIT
OPEN_NODE.V.FSN#
      8006**DCL      8006--REDEF    8006--REDEF
OPEN_NODE.WSN_
      7972**DCL      7972--REDEF
OPEN_OUT.ACSVEH_
      8612**DCL      8613--REDEF
OPEN_OUT.ALTKEYS_
      8618**DCL      8619--REDEF    8619--REDEF
OPEN_OUT.HDR_
      8617**DCL      8618--REDEF
OPEN_OUT.TAB_
      8616**DCL      8617--REDEF
OPEN_OUT.UHL_
      8610**DCL      8611--REDEF    8611--REDEF
OPEN_OUT.V
      8619**DCL      8610--DCLINIT
OPEN_OUT.V.ASN#
      8629**DCL      8751--DCLINIT  8824--DCLINIT
OPEN_OUT.V.FSN#
      8650**DCL      8650--REDEF    8650--REDEF
OPEN_OUT.V.RES#
      8634**DCL      8751--DCLINIT  8824--DCLINIT
OPEN_OUT.WSN_
      8616**DCL      8616--REDEF
OPTS
      7321**DCL      9457--DOWHILE
OPTS.INP.FID
      7429**DCL      9305>>IF       9309--ASSIGN   9333>>IF       9334>>ASSIGN
OPTS.INP.L
      7423**DCL      9306>>ASSIGN   9335>>ASSIGN
OPTS.INP.MISC.TRAN
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:92   
      7388**DCL      9375>>ASSIGN
OPTS.INP.NODE
      7413**DCL      9290>>ASSIGN   9339>>IF       9340>>CALLBLT  9365<<ASSIGN
OPTS.MAILINIT.WHO
      7643**DCL      9438>>IF
OPTS.MAILRCVR.WHO
      7597**DCL      9420>>IF
OPTS.MAILSNDR.WHO
      7554**DCL      9402>>IF
OPTS.OUT.FID
      7536**DCL      9319>>IF       9323--ASSIGN   9345>>IF       9346>>ASSIGN
OPTS.OUT.L
      7530**DCL      9320>>ASSIGN   9347>>ASSIGN
OPTS.OUT.NODE
      7520**DCL      9277>>IF       9277>>IF       9278>>ASSIGN   9282<<ASSIGN   9351>>IF       9352>>CALLBLT
      9518>>ASSIGN
PASS_INP
      8467**DCL      8367--DCLINIT  8505--DCLINIT
PASS_OUT
      8712**DCL      8612--DCLINIT  8750--DCLINIT
READ_NODE
      8078**DCL      9279<>CALL     9291<>CALL     9294<>CALL
READ_NODE.STATION_
      8081**DCL      8082--REDEF
READ_NODE.V
      8082**DCL      8078--DCLINIT
READ_NODE.V.DVBYTE.REREAD#
      8093**DCL      8093--REDEF
READ_NODE.V.INDX#
      8091**DCL      8091--REDEF
SN_INP
      8482**DCL      8365--DCLINIT  8505--DCLINIT  8799--DCLINIT
SN_OUT
      8727**DCL      8610--DCLINIT  8750--DCLINIT  8823--DCLINIT
SN_OUT.NUM#
      8727**DCL      9262<<ASSIGN
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:93   
SUCK_ABORT
      9667**LABEL    9646--GOTO     9658--GOTO
SUCK_BAD_DST
      9595**LABEL    9279--CALLALT
SUCK_BAD_INP
      9575**LABEL    9310--CALLALT
SUCK_BAD_ITL
      9555**LABEL    9308--GOTO
SUCK_BAD_NODE
      9615**LABEL    9297--CALLALT
SUCK_BAD_ONE
      9625**LABEL    9482--CALLALT
SUCK_BAD_OTL
      9565**LABEL    9322--GOTO
SUCK_BAD_OUT
      9585**LABEL    9324--CALLALT
SUCK_BAD_SRC
      9605**LABEL    9291--CALLALT  9294--CALLALT
SUCK_BAD_WRJ
      9635**LABEL    9367--CALLALT  9380--CALLALT  9384--CALLALT  9389--CALLALT  9393--CALLALT  9406--CALLALT
      9410--CALLALT  9424--CALLALT  9428--CALLALT  9442--CALLALT  9446--CALLALT  9461--CALLALT  9473--CALLALT
SUCK_SYSERR
      9655**LABEL    9616--GOTO     9626--GOTO     9636--GOTO
SUCK_USRERR
      9645**LABEL    9556--GOTO     9566--GOTO     9576--GOTO     9586--GOTO     9596--GOTO     9606--GOTO
TWORK
      9234**DCL      9491<<ASSIGN   9493>>DOWHILE  9497>>DOWHILE  9500>>CALLBLT  9500>>CALLBLT
U1
      9240**DCL      9357--CALL
U1.C
      9242**DCL      9265--ASSIGN   9334<<ASSIGN   9340<<CALLBLT  9341>>CALLBLT
U1.L
      9241**DCL      9343<<ASSIGN
U2
      9243**DCL      9357--CALL
U2.C
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:94   
      9245**DCL      9267--ASSIGN   9346<<ASSIGN   9352<<CALLBLT  9353>>CALLBLT
U2.L
      9244**DCL      9355<<ASSIGN
U3
      9246**DCL      9529--CALL     9534--CALL     9537--CALL
U3.C
      9248**DCL      9500<<CALLBLT
U3.L
      9247**DCL      9501<<ASSIGN
U4
      9249**DCL      9529--CALL     9534--CALL
U4.C
      9251**DCL      9527<<ASSIGN   9532<<ASSIGN
U4.L
      9250**DCL      9528<<ASSIGN   9533<<ASSIGN
UNFID_INP
      8797**DCL      9338<>CALL
UNFID_INP.LEN_
      8800**DCL      9266<<ASSIGN
UNFID_INP.TEXTFID_
      8797**DCL      9265<<ASSIGN
UNFID_INP.V
      8801**DCL      8797--DCLINIT
UNFID_OUT
      8821**DCL      9350<>CALL
UNFID_OUT.LEN_
      8824**DCL      9268<<ASSIGN
UNFID_OUT.TEXTFID_
      8821**DCL      9267<<ASSIGN
UNFID_OUT.V
      8825**DCL      8821--DCLINIT
VLP_CRITERIA
      9074**DCL      9053--DCLINIT
VLP_CRITERIA.WSN#
      9078**DCL      9518<<ASSIGN
VLR_INP
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:95   
      8527**DCL      8507--DCLINIT
VLR_JOBSTATS_CHECK
      9102**DCL      9053--DCLINIT
VLR_JOBSTATS_CHECK.AHEAD
      9103**DCL      9522>>CALLBLT
VLR_JOBSTATS_CHECK.DEVNAME
      9106**DCL      9532>>ASSIGN
VLR_JOBSTATS_CHECK.FCODE
      9104**DCL      9521>>IF       9531>>IF
VLR_OUT
      8772**DCL      8752--DCLINIT
VWF$FOOTER
      9210**DCL-ENT  9473--CALL
VWH$HEADER
      9209**DCL-ENT  9367--CALL
VWO$TRANSO
      9211**DCL-ENT  9379--CALL     9383--CALL     9388--CALL     9392--CALL     9405--CALL     9409--CALL
      9423--CALL     9427--CALL     9441--CALL     9445--CALL     9460--CALL
VWX$MAIL
      9208**DCL-ENT  9357--CALL     9529--CALL     9534--CALL     9537--CALL     9645--CALL     9657--CALL
VW_IAM#
      9236**DCL      9277>>IF       9282>>ASSIGN   9339>>IF       9351>>IF
VW_OPTIONS#
      7315**DCL      7321--REDEF    7684--REDEF
VW_OUTCNT#
      9216**DCL      9394<<ASSIGN   9411<<ASSIGN   9411>>ASSIGN   9429<<ASSIGN   9429>>ASSIGN   9447<<ASSIGN
      9447>>ASSIGN   9462<<ASSIGN   9462>>ASSIGN
VW_SCRAMBLE#
      9238**DCL      9375<<ASSIGN   9378>>IF       9382>>IF       9387>>IF       9391>>IF       9404>>IF
      9408>>IF       9422>>IF       9426>>IF       9440>>IF       9444>>IF       9459>>IF
WRITE_JE
      8979**DCL      9380<>CALL     9384<>CALL     9389<>CALL     9393<>CALL     9406<>CALL     9410<>CALL
      9424<>CALL     9428<>CALL     9442<>CALL     9446<>CALL     9461<>CALL
WRITE_JE.BUF_.BOUND
      8979**DCL      9264<<ASSIGN
WRITE_JE.BUF_.BUF$
PL6.E3A0      #001=VWK$SUCK File=VWK$SUCK.:VMB6TSI                               WED 08/20/97 15:41 Page:96   
      8981**DCL      9263<<ASSIGN
WRITE_JE.STATION_
      8981**DCL      8981--REDEF
WRITE_JE.V
      8982**DCL      8979--DCLINIT
WRITE_JE.V.DVBYTE.VFC#
      8988**DCL      8988--REDEF
WSN_JE
      8958**DCL      8907--DCLINIT
WSN_JE.WSN#
      8958**DCL      9296<<ASSIGN
