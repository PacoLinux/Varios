
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:1    
        1        1        /*M*     ZIG$V_PROHIB      I-D-S/II            DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*     NAME: ZIG$V_PROHIB
        8        8                  PURPOSE:
        9        9              This procedure is to be called by two different processes
       10       10            in DBACS. First the validator will call it if prohibited
       11       11            list is asked for on the validation command. Second will
       12       12            be the call from the subschema display processor to display
       13       13            the prohibited list for a subschema.
       14       14
       15       15              Things that must be setup before calling is the SSS$ pointer
       16       16            to the schema subset and the schema subset in memory. The
       17       17            schema file open for update and retrieval.
       18       18
       19       19        */
       20       20        ZIG$V_PROHIB:
       21       21            PROC;
       22       22    1   DCL FIRST_FIELD BIT (1) STATIC ALIGNED;
       23       23    1   DCL NO_MEMBER_PRESENT BIT (1) STATIC;
       24       24    1   DCL SM BIT (1) STATIC;
       25       25    1   DCL DONE BIT (1);
       26       26    1   DCL TEMP_WORD CHAR (30) STATIC;
       27       27    1   DCL EOFC CHAR (120) EXT INIT ('/*/*/*/*/*/*/*/*/*');
       28       28    1   DCL LIST_STRING CHAR (128) EXT;
       29       29    1   DCL READSF ENTRY (2);
       30       30    1   DCL NUM_PROHIB UBIN (36) EXT;
       31       31    1   DCL NUM_FR UBIN (36) STATIC;
       32       32    1   DCL NUM_SM UBIN (36) STATIC;
       33       33    1   DCL FIRST_RC BIT (1) STATIC;
       34       34        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:2    
       35       35        %INCLUDE ZI_ERRORS_SUBS;
       36      555        %INCLUDE ZIG_GENERAL;
       37      663        %INCLUDE ZIG_DBA_INT;
       38      711        %INCLUDE ZI_SUB4_CAN;
       39     1368        %RVA;
       40     1645        %UWA;
       41     1980        %INCLUDE ZI_SUB_LANG;
       42     3695        %DESC_TYPE_9(NAME_MAIN=TYPE_9);
       43     3872        %GENERAL;
       44     3996    1   DCL IO_BUF CHAR (128) EXT;
       45     3997        %TEXT_LINE(STCLASS="REDEF IO_BUF");
       46     4034        %DESC_TYPE_9(STCLASS="REDEF IO_BUF");
       47     4211        %DESC_TYPE_100(STCLASS="REDEF IO_BUF");
       48     4251        %DESC_TYPE_110(STCLASS="REDEF IO_BUF");
       49     4315        %DESC_TYPE_200(STCLASS="REDEF IO_BUF");
       50     4368        %DESC_TYPE_210(STCLASS="REDEF IO_BUF");
       51     4423        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       52     4492        %DESC_TYPE_350(STCLASS="REDEF IO_BUF");
       53     4530        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
       54     4589        %DESC_TYPE_410(STCLASS="REDEF IO_BUF");
       55     4645        %DESC_TYPE_420(STCLASS="REDEF IO_BUF");
       56     4678        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
       57     4837        %CONTROL_BLOCK;
       58     4945        %DESC_TYPE_36;
       59     4984        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:3    
       60     4985        /*
       61     4986              Now comes the sturctures for the schema subset.
       62     4987        */
       63     4988        %INCLUDE ZIG_SSS;
       64     5558        %SS_GENERAL(PSTCLASS=EXT);
       65     5579        %AC(PSTCLASS=EXT);
       66     5674        %AC1(PSTCLASS=EXT);
       67     5682        %FR(PSTCLASS=EXT);
       68     5728        %FR1(PSTCLASS=EXT);
       69     5736        %SC(PSTCLASS=EXT);
       70     5763        %SC1(PSTCLASS=EXT);
       71     5773        %RC(PSTCLASS=EXT);
       72     5806        %RC1(PSTCLASS=EXT);
       73     5816        %OA(PSTCLASS=EXT);
       74     5883        %OA1(PSTCLASS=EXT);
       75     5891        %RA(PSTCLASS=EXT);
       76     5911        %RS(PSTCLASS=EXT);
       77     5985        %SM1(PSTCLASS=EXT);
       78     5993        %SS(PSTCLASS=EXT);
       79     6007        %CD(PSTCLASS=EXT);
       80     6026        %DP(PSTCLASS=EXT);
       81     6040        %DP1(PSTCLASS=EXT);
       82     6048        %AG(PSTCLASS=EXT);
       83     6078        %AG1(PSTCLASS=EXT);
       84     6086        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:4    
       85     6087    1   WARNING_INT:
       86     6088    1       PROC (ERROR_CODE);
       87     6089    2   DCL ERROR_CODE UBIN (36);
       88     6090    2       NUM_PROHIB = NUM_PROHIB + 1;
       89     6091    2       CALL WARNING(ERROR_CODE + SUB_LANGUAGE -1);
       90     6092    2   END WARNING_INT;
       91     6093        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:5    
       92     6094        /*
       93     6095              Lets first do throw all the Type 200-430 descriptor in the
       94     6096            subschema to print out witch one are in the schema file and
       95     6097            witch ones are not in schema so we can tell the DBA.
       96     6098        */
       97     6099    1       CALL CONCAT(HEADING_TEXT,LANG_TEXT(SUB_LANGUAGE),
       98     6100    1          'SUBSCHEMA PROHIBITED LIST.');
       99     6101    1       CALL SUBLST(HEADING_TEXT);
      100     6102    1       NUM_PROHIB = 0;
      101     6103    1       IF ~CONTROL.BITS.ALL_FIELDS
      102     6104    2       THEN DO;
      103     6105    2           FIRST_FIELD = '1'B;
      104     6106    2           CURRENT_RECORD = CONTROL.FIRST_SDS_RECORD;
      105     6107    2           CALL READSF(CURRENT_RECORD,IO_BUF);
      106     6108    3           DO WHILE(SUBSTR(IO_BUF,0,12) ~= SUBSTR(EOFC,0,12));
      107     6109    4               DO CASE(TYPE_100.TYPE/10);
      108     6110    4               CASE (20,30,35,40,42);
      109     6111        /*W*
      110     6112              No error with any of these else the subschema validation
      111     6113            would have had errors!
      112     6114        */
      113     6115        /*
      114     6116              Areas that are in the subschema must be in the schema
      115     6117            so if the not no DML statement can be performed with the
      116     6118            subschema since a error in validation has occurred and the
      117     6119            subschema is not build correctly.
      118     6120        */
      119     6121    4                   CALL SET_FIELDS(2,30,TYPE_200.SUB_AREA_NAME);
      120     6122    4               CASE(43);
      121     6123        /*
      122     6124              These are the fields for the subschema and some might be in
      123     6125            groups so no DML calls can be done with them and other might
      124     6126            not have any corresponding item in the schema so no entry can
      125     6127            be in the schema subset. These fields must be written out as
      126     6128            fields that can't be gotten.
      127     6129        */
      128     6130    4                   CALL SET_FIELDS(3,30,TYPE_430.SUB_FIELD_NAME);
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:6    
      129     6131    4                   IF TYPE_430.FLAGS.TYPE = '7777'O
      130     6132    5                   THEN DO;
      131     6133    5                       CALL SET_FIELDS(1,9,'IN GROUP    ');
      132     6134    5                       END;
      133     6135    4                   IF TYPE_430.FLAGS.TYPE = '7776'O
      134     6136    5                   THEN DO;
      135     6137    5                       CALL SET_FIELDS(1,8,'ERRORED ');
      136     6138    5                       END;
      137     6139    4                   IF TYPE_430.FLAGS.TYPE = '7777'O OR
      138     6140    4                      TYPE_430.FLAGS.TYPE = '7776'O
      139     6141    5                   THEN DO;
      140     6142    5                       CALL WARNING_INT(%FIELD_NOT_SO_GOOD -SUB_LANGUAGE +1);
      141     6143        /*E*     ERROR:    ZIG-FIELD_NOT_SO_GOOD-C
      142     6144        MESSAGE: The field "%U3" in "%U2" was %U1 so no DML call allowed.
      143     6145        */
      144     6146    5                       END;
      145     6147    4                   END;
      146     6148    3               CURRENT_RECORD = CURRENT_RECORD + 1;
      147     6149    3               CALL READSF(CURRENT_RECORD, IO_BUF);
      148     6150    3               END;
      149     6151    2           END;
      150     6152        /*
      151     6153              Now go throw all the schema subset and check what things are
      152     6154            prohibited for this subschema and tell the user why this
      153     6155            call can't be done for this record, set or key.
      154     6156
      155     6157              As you see things are driven off of records, set, and keys
      156     6158            at this point and not DML call types. This will cause the list
      157     6159            of prohibited calls for each record in a different format then
      158     6160            GCOS but it will be more in a form that a programer would want
      159     6161            to see it in.
      160     6162
      161     6163              The basic assumption is that users want to see what can't
      162     6164            be done to this record not for this DML call this can't be
      163     6165            performed by the DBCS.
      164     6166        */
      165     6167        /*
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:7    
      166     6168              Go through all the areas and see what calls can't be done for
      167     6169            that area. Note that if no records are present in the subschema
      168     6170            then some finds within areas can't be done.
      169     6171        */
      170     6172    1       AC$ = PINCRW(SSS$, OA.OAACN);
      171     6173    2       DO WHILE (AC$ ~= SSS$);
      172     6174    2           IF AC.ACRAN = 0
      173     6175    3           THEN DO;
      174     6176    3               TEMP_WORD = AC.ANAM;
      175     6177    3               CALL SET_FIELDS(1,30,TEMP_WORD);
      176     6178    3               CALL WARNING_INT(%ZIG_PRO_NO_REC_AREA);
      177     6179        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_COBOL-C
      178     6180        MESSAGE: For the area %U1 these calls are invalid because no
      179     6181                 records belong to this area:
      180     6182                 FIND (NEXT, PRIOR, CURRENT) [record_name] WITHIN %U1
      181     6183                 FIND (FIRST, LAST, INTEGER, IDENTIFIER) [record_name] WITHIN %U1
      182     6184        */
      183     6185        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_FORT-C
      184     6186        MESSAGE: For the area %U1 these calls are invalid because no
      185     6187                 records belong to this area:
      186     6188                 CALL FIND (NEXT|PRIOR|CURRENT, [record_name,] %U1)
      187     6189                 CALL FIND (FIRST|LAST|INTEGER|IDENTIFIER, [record_name,] %U1)
      188     6190        */
      189     6191        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_APL-C
      190     6192        MESSAGE: For the area %U1 these calls are invalid because no
      191     6193                 records belong to this area:
      192     6194                 []DBFIND 'NEXT|PRIOR|CURRENT [record_name] WITHIN %U1'
      193     6195                 []DBFIND 'FIRST|LAST|INTEGER|IDENTIFIER [record_name] WITHIN %U1'
      194     6196        */
      195     6197        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_BASIC-C
      196     6198        MESSAGE: For the area %U1 these calls are invalid because no
      197     6199                 records belong to this area:
      198     6200                 [line no] DB FIND NEXT/PRIOR/CURRENT [record_name] [WITHIN] %U1
      199     6201                 [line no] DB FIND FIRST/LAST/INTEGER/IDENTIFIER [record_name] [WITHIN] %U1
      200     6202        */
      201     6203    3               END;
      202     6204    2           AC$ = PINCRW(SSS$, AC.OAACN);
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:8    
      203     6205    2           END;
      204     6206        /*
      205     6207              Well start the sets.
      206     6208        */
      207     6209    1       SC$ = PINCRW(SSS$,OA.OASCN);
      208     6210    2       DO WHILE (SC$ ~= SSS$);
      209     6211    2           IF SC.DEF.SETT = 0 AND ~SC.DEF.SNSS
      210     6212    3           THEN DO;
      211     6213        /*
      212     6214              A user set so come on lets tell him if any thing can't
      213     6215            be done with it.
      214     6216        */
      215     6217    3               TEMP_WORD = SC.SNAM;
      216     6218    3               CALL SET_FIELDS (1,30,TEMP_WORD);
      217     6219    3               RS$ = PINCRW(SSS$,SC.SCRSN);
      218     6220    3               NO_MEMBER_PRESENT = '0'B;
      219     6221    3               SM = '0'B;
      220     6222    4               DO WHILE (RS$ ~= SSS$);
      221     6223    4                   RC$ = PINCRW(SSS$,RS.RCRSH);
      222     6224    4                   IF RS.DEF.TYPE = '0100'O
      223     6225    5                   THEN DO;
      224     6226    5                       IF RC.DEF.SR
      225     6227    6                       THEN DO;
      226     6228    6                           CALL WARNING_INT(%ZIG_V_SET_OWNER);
      227     6229        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_COBOL-C
      228     6230        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      229     6231                 because the owner record is not present in the subschema:
      230     6232                 FIND OWNER WITHIN %U1
      231     6233                 IF %U1 OWNER
      232     6234                 IF %U1 TENANT
      233     6235        */
      234     6236        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_FORT-C
      235     6237        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      236     6238                 because the owner record is not present in the subschema:
      237     6239                 CALL FIND (OWNER, %U1)
      238     6240        */
      239     6241        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_APL-C
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:9    
      240     6242        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      241     6243                 because the owner record is not present in the subschema:
      242     6244                 []DBFIND 'OWNER WITHIN %U1'
      243     6245        */
      244     6246        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_BASIC-C
      245     6247        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      246     6248                 because the owner record is not present in the subschema:
      247     6249                 [line no] DB FIND OWNER [WITHIN] %U1
      248     6250        */
      249     6251    6                           END;
      250     6252    5                       IF RS.DEF.OSM
      251     6253    6                       THEN DO;
      252     6254    6                           CALL WARNING_INT(%ZIG_PRO_NO_CON_DIS_OWN);
      253     6255        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_COBOL-C
      254     6256        MESSAGE: For the set %U1 these calls are invalid because the owner
      255     6257                 is not present in the subschema:
      256     6258                 CONNECT [record_name] TO %U1
      257     6259                 DISCONNECT [record_name] FROM %U1
      258     6260        */
      259     6261        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_FORT-C
      260     6262        MESSAGE: For the set %U1 these calls are invalid because the owner
      261     6263                 is not present in the subschema:
      262     6264                 CALL CONNECT ([record_name,] %U1)
      263     6265                 CALL DISCONNECT ([record_name,] %U1)
      264     6266        */
      265     6267        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_APL-C
      266     6268        MESSAGE: For the set %U1 these calls are invalid because the owner
      267     6269                 is not present in the subschema:
      268     6270                 []DBCONNECT '[record_name] TO %U1'
      269     6271                 []DBDISCONNECT '[record_name] FROM %U1'
      270     6272        */
      271     6273        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_BASIC-C
      272     6274        MESSAGE: For the set %U1 these calls are invalid because the owner
      273     6275                 is not present in the subschema:
      274     6276                 [line no] DB CONNECT [record_name] [TO] %U1
      275     6277                 [line no] DB DISCONNECT [record_name] [FROM] %U1
      276     6278        */
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:10   
      277     6279    6                           END;
      278     6280    5                       END;
      279     6281    5                   ELSE DO;
      280     6282    5                       SM = '1'B;
      281     6283    5                       IF RC.DEF.SR
      282     6284    6                       THEN DO;
      283     6285    6                           IF RS.DEF.OSM AND SUBSTR(RC.RNAM,0,1) ~= '*'
      284     6286    7                           THEN DO;
      285     6287    7                               NO_MEMBER_PRESENT = '1'B;
      286     6288    7                               TEMP_WORD = RC.RNAM;
      287     6289    7                               CALL SET_FIELDS(2,30,TEMP_WORD);
      288     6290    7                               CALL WARNING_INT(%ZIG_PRO_NO_CON_DIS_MEM);
      289     6291        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_COBOL-C
      290     6292        MESSAGE: For the set %U1 these calls are invalid because the member
      291     6293                 %U2 is not present in the subschema:
      292     6294                 CONNECT %U2 TO %U1
      293     6295                 DISCONNECT %U2 TO %U1
      294     6296        */
      295     6297        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_FORT-C
      296     6298        MESSAGE: For the set %U1 these calls are invalid because the member
      297     6299                 %U2 is not present in the subschema:
      298     6300                 CALL CONNECT (%U2, %U1)
      299     6301                 CALL DISCONNECT (%U2, %U1)
      300     6302        */
      301     6303        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_APL-C
      302     6304        MESSAGE: For the set %U1 these calls are invalid because the member
      303     6305                 %U2 is not present in the subschema:
      304     6306                 []DBCONNECT '%U2 TO %U1'
      305     6307                 []DBDISCONNECT '%U2 TO %U1'
      306     6308        */
      307     6309        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_BASIC-C
      308     6310        MESSAGE: For the set %U1 these calls are invalid because the member
      309     6311                 %U2 is not present in the subschema:
      310     6312                 [line no] DB CONNECT %U2 [TO] %U1
      311     6313                 [line no] DB DISCONNECT %U2 [FROM] %U1
      312     6314        */
      313     6315    7                               END;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:11   
      314     6316    6                           END;
      315     6317    6                       ELSE DO;
      316     6318    6                           NO_MEMBER_PRESENT = '0'B;
      317     6319    6                           SS$ = PINCRW(SSS$, RS.RSSSN);
      318     6320    6                           DONE = '0'B;
      319     6321    7                           DO WHILE (SS$ ~= SSS$ AND ~DONE);
      320     6322    7                               CD$ = PINCRW(SSS$, SS.RSCDN);
      321     6323    8                               DO WHILE (CD$ ~= SSS$ AND ~DONE);
      322     6324    8                                   FR$ = PINCRW(SSS$, CD.CDRH);
      323     6325    8                                   IF FR.DEF.FSR AND ~FR.DEF.SYN
      324     6326    9                                   THEN DO;
      325     6327    9                                       DONE = '1'B;
      326     6328    9                                       TEMP_WORD = RC.RNAM;
      327     6329    9                                       CALL SET_FIELDS(2,30,TEMP_WORD);
      328     6330    9                                       CALL WARNING_INT(%ZIG_PRO_MEM_NOT_IN_SET);
      329     6331        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_COBOL-C
      330     6332        MESSAGE: For the set %U1 this call is invalid because not all the
      331     6333                 control fields are present in the subschema:
      332     6334                 CONNECT %U2 TO %U1
      333     6335        */
      334     6336        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_FORT-C
      335     6337        MESSAGE: For the set %U1 this call is invalid because not all the
      336     6338                 control fields are present in the subschema:
      337     6339                 CALL CONNECT (%U2, %U1)
      338     6340        */
      339     6341        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_APL-C
      340     6342        MESSAGE: For the set %U1 this call is invalid because not all the
      341     6343                 control fields are present in the subschema:
      342     6344                 []DBCONNECT '%U2 TO %U1'
      343     6345        */
      344     6346        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_BASIC-C
      345     6347        MESSAGE: For the set %U1 this call is invalid because not all the
      346     6348                 control fields are present in the subschema:
      347     6349                 [line no] DB CONNECT %U2 [TO] %U1
      348     6350        */
      349     6351    9                                       END;
      350     6352    8                                   CD$ = PINCRW(SSS$, CD.RSCDN);
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:12   
      351     6353    8                                   END;
      352     6354    7                               SS$ = PINCRW(SSS$, SS.RSSSN);
      353     6355    7                               END;
      354     6356    6                           END;
      355     6357    5                       END;
      356     6358    4                   RS$ = PINCRW(SSS$,RS.SCRSN);
      357     6359    4                   END;
      358     6360    3               IF NO_MEMBER_PRESENT AND SM
      359     6361    4               THEN DO;
      360     6362    4                   CALL WARNING_INT(%ZIG_V_SET_MEMBER);
      361     6363        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_COBOL-C
      362     6364        MESSAGE: For the set %U1 these DML calls are invalid
      363     6365                 because the set has no members present in the subschema:
      364     6366                 FIND (NEXT, PRIOR) [RECORD-NAME] WITHIN %U1
      365     6367                 FIND (FIRST, LAST, INTEGER, IDENTIFIER) [RECORD-NAME]  WITHIN %U1
      366     6368                 IF %U1 MEMBER
      367     6369                 IF %U1 TENANT
      368     6370        */
      369     6371        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_FORT-C
      370     6372        MESSAGE: For the set %U1 these DML calls are invalid
      371     6373                 because the set has no members present in the subschema:
      372     6374                 CALL FIND (NEXT|PRIOR, [RECORD-NAME,] %U1)
      373     6375                 CALL FIND (FIRST|LAST|INTEGER|IDENTIFIER, [RECORD-NAME,] %U1)
      374     6376        */
      375     6377        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_APL-C
      376     6378        MESSAGE: For the set %U1 these DML calls are invalid
      377     6379                 because the set has no members present in the subschema:
      378     6380                 []DBFIND 'NEXT|PRIOR [RECORD-NAME] WITHIN %U1'
      379     6381                 []DBFIND 'FIRST|LAST|INTEGER|IDENTIFIER [RECORD-NAME] WITHIN %U1'
      380     6382        */
      381     6383        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_BASIC-C
      382     6384        MESSAGE: For the set %U1 these DML calls are invalid
      383     6385                 because the set has not members present in the subschema:
      384     6386                 [line no] DB FIND NEXT/PRIOR [RECORD-NAME] [WITHIN] %U1
      385     6387                 []DBFIND 'FIRST/LAST/INTEGER/IDENTIFIER [RECORD-NAME] WITHIN %U1'
      386     6388        */
      387     6389    4                   END;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:13   
      388     6390    3               END;
      389     6391    2           SC$ = PINCRW(SSS$,SC.OASCN);
      390     6392    2           END;
      391     6393        /*
      392     6394              Now go through all the RC records determine what
      393     6395            functions can't be done to this record and print out them
      394     6396            as warning messages.
      395     6397
      396     6398              The things that can't be done to a record are:
      397     6399            STORE, ERASE, ERASE ALL, MODIFY ALL (if in a sorted PA set),
      398     6400            and (some) FIND.
      399     6401        */
      400     6402
      401     6403    1       RC$ = PINCRW(SSS$, OA.OARCN);
      402     6404    2       DO WHILE (RC$ ~= SSS$);
      403     6405    2           TEMP_WORD = RC.RNAM;
      404     6406    2           CALL SET_FIELDS(1,30,TEMP_WORD);
      405     6407    2           IF RC.DEF.SR AND SUBSTR(RC.RNAM,0,1) ~= '*'
      406     6408    3           THEN DO;
      407     6409    3               CALL WARNING_INT(%ZIG_PRO_RECORD_NOT_THERE -SUB_LANGUAGE +1);
      408     6410        /*E*     ERROR:    ZIG-ZIG_PRO_RECORD_NOT_THERE-C
      409     6411        MESSAGE: The record "%U1" is not present in the subschema so no
      410     6412                 DML calls are allowed on it or its fields.
      411     6413        */
      412     6414    3               END;
      413     6415    2           IF ~RC.DEF.SR AND SUBSTR(RC.RNAM,0,1) ~= '*'
      414     6416    3           THEN DO;
      415     6417        /*
      416     6418              Now check things in the record.
      417     6419        */
      418     6420    3               NUM_FR = 0;
      419     6421    3               FR$ = PINCRW(SSS$, RC.RCFRN);
      420     6422    4               DO WHILE (SSS$ ~= FR$ AND NUM_FR = 0);
      421     6423    4                   IF ~FR.DEF.FSR AND ~FR.DEF.SYN
      422     6424    5                   THEN DO;
      423     6425    5                       NUM_FR = 1;
      424     6426    5                       END;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:14   
      425     6427    4                   FR$ = PINCRW(SSS$, FR.RCFRN);
      426     6428    4                   END;
      427     6429    3               IF NUM_FR = 0
      428     6430    4               THEN DO;
      429     6431    4                   CALL WARNING_INT(%ZIG_PRO_REC_NO_FIELD);
      430     6432        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_FORT-C
      431     6433        MESSAGE: CALL GET (%U1)
      432     6434                 CALL MODIFY (%U1)
      433     6435                 Are invalid because the record contains no fields.
      434     6436        */
      435     6437        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_APL-C
      436     6438        MESSAGE: []DBGET '%U1'
      437     6439                 []DBMODIFY '%U1'
      438     6440                 Are invalid because the record contains no fields.
      439     6441        */
      440     6442        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_BASIC-C
      441     6443        MESSAGE: [line no] DB GET %U1
      442     6444                 [line no] DB MODIFY %U1
      443     6445                 Are invalid because the record contains no fields.
      444     6446        */
      445     6447        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_COBOL-C
      446     6448        MESSAGE: GET %U1
      447     6449                 MODIFY %U1
      448     6450                 Are invalid because the record contains no fields.
      449     6451        */
      450     6452    4                   END;
      451     6453    3               IF RC.DEF.RSTO
      452     6454    4               THEN DO;
      453     6455    4                   CALL WARNING_INT(%ZIG_PRO_RC_NOSTORE);
      454     6456        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_COBOL-C
      455     6457        MESSAGE: STORE %U1
      456     6458        */
      457     6459        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_FORT-C
      458     6460        MESSAGE: CALL STORE (%U1)
      459     6461        */
      460     6462        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_APL-C
      461     6463        MESSAGE: []DBSTORE '%U1'
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:15   
      462     6464        */
      463     6465        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_BASIC-C
      464     6466        MESSAGE: [line no] DB STORE %U1
      465     6467        */
      466     6468    4                   END;
      467     6469    3               IF RC.DEF.RERA
      468     6470    4               THEN DO;
      469     6471    4                   DONE = '0'B;
      470     6472    4                   RS$ = PINCRW(SSS$, RC.RCRSN);
      471     6473    5                   DO WHILE (RS$ ~= SSS$ AND ~DONE);
      472     6474    5                       SC$ = PINCRW(SSS$, RS.SCRSH);
      473     6475    5                       IF RS.DEF.TYPE = '0100'O AND SC.DEF.SETT = 0
      474     6476    6                       THEN DO;
      475     6477    6                           DONE = '1'B;
      476     6478    6                           CALL WARNING_INT(%ZIG_PRO_RC_NOERASEA);
      477     6479        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_COBOL-C
      478     6480        MESSAGE: ERASE %U1 ALL
      479     6481        */
      480     6482        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_FORT-C
      481     6483        MESSAGE: CALL ERASE (%U1, ALL)
      482     6484        */
      483     6485        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_APL-C
      484     6486        MESSAGE: []DBERASE '%U1 ALL'
      485     6487        */
      486     6488        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_BASIC-C
      487     6489        MESSAGE: [line no] DB ERASE %U1 ALL
      488     6490        */
      489     6491    6                           END;
      490     6492    5                       RS$ = PINCRW(SSS$, RS.RCRSN);
      491     6493    5                       END;
      492     6494    4                   END;
      493     6495    3               IF RC.DEF.RERS
      494     6496    4               THEN DO;
      495     6497    4                   CALL WARNING_INT(%ZIG_PRO_RC_NOERASE);
      496     6498        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_COBOL-C
      497     6499        MESSAGE: ERASE %U1
      498     6500        */
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:16   
      499     6501        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_FORT-C
      500     6502        MESSAGE: CALL ERASE (%U1)
      501     6503        */
      502     6504        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_APL-C
      503     6505        MESSAGE: []DBERASE '%U1'
      504     6506        */
      505     6507        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_BASIC-C
      506     6508        MESSAGE: [line no] DB ERASE %U1
      507     6509        */
      508     6510    4                   END;
      509     6511    3               RS$ = PINCRW(SSS$, RC.RCRSN);
      510     6512    4               DO WHILE (RS$ ~= SSS$);
      511     6513    4                   SC$ = PINCRW(SSS$, RS.SCRSH);
      512     6514    4                   TEMP_WORD = SC.SNAM;
      513     6515    4                   CALL SET_FIELDS(3,30,TEMP_WORD);
      514     6516    4                   IF RS.DEF.TYPE = '0040'O AND SC.DEF.SETT = 0
      515     6517    5                   THEN DO;
      516     6518    5                       DONE = '0'B;
      517     6519    5                       CD$ = PINCRW(SSS$, RS.RSCDN);
      518     6520    6                       DO WHILE (CD$ ~= SSS$ AND ~DONE);
      519     6521    6                           IF CD.CDSH ~= 0
      520     6522    7                           THEN DO;
      521     6523    7                               FR$ = PINCRW(SSS$, CD.CDSH);
      522     6524    7                               END;
      523     6525    7                           ELSE DO;
      524     6526    7                               FR$ = PINCRW(SSS$, CD.CDRH);
      525     6527    7                               END;
      526     6528    6                           IF (FR.DEF.FSR AND NOT FR.DEF.SYN)
      527     6529    6                              OR (NOT FR.DEF.FSR AND FR.DEF.FMOD)
      528     6530    7                           THEN DO;
      529     6531    7                               IF FR.FNL = 0
      530     6532    8                               THEN DO;
      531     6533    8                                   CURRENT_RECORD = PINCRW(FR$,-1)->FR1.NLIND;
      532     6534    8                                   CALL READSF(CURRENT_RECORD, IO_BUF);
      533     6535    8                                   CALL SET_FIELDS(2,30,TYPE_430.SUB_FIELD_NAME);
      534     6536    8                                   END;
      535     6537    8                               ELSE DO;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:17   
      536     6538    8                                   TEMP_WORD = FR.FNAM;
      537     6539    8                                   CALL SET_FIELDS(2,30,TEMP_WORD);
      538     6540    8                                   END;
      539     6541    7                               IF SC.SNAM = '*CALC'
      540     6542    8                               THEN DO;
      541     6543    8                                   IF FR.DEF.FSR
      542     6544    9                                   THEN DO;
      543     6545    9                                       CALL WARNING_INT(%ZIG_PRO_FIND_ANY);
      544     6546        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_COBOL-C
      545     6547        MESSAGE: FIND ANY %U1
      546     6548                 Is invalid because not all control fields are present
      547     6549                 in the subschema.
      548     6550        */
      549     6551        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_FORT-C
      550     6552        MESSAGE: CALL FIND (ANY, %U1)
      551     6553                 Is invalid because not all control fields are present
      552     6554                 in the subschema.
      553     6555        */
      554     6556        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_APL-C
      555     6557        MESSAGE: []DBFIND 'ANY %U1'
      556     6558                 Is invalid because not all control fields are present
      557     6559                 in the subschema.
      558     6560        */
      559     6561        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_BASIC-C
      560     6562        MESSAGE: [line no] DB FIND ANY %U1
      561     6563                 Is invalid because not all control fields are present
      562     6564                 in the subschema.
      563     6565        */
      564     6566    9                                       END;
      565     6567    8                                   END;
      566     6568    8                               ELSE DO;
      567     6569    8                                   CALL WARNING_INT(%ZIG_PRO_SET_NOT_INCLUDE);
      568     6570    8                                   END;
      569     6571        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_COBOL-C
      570     6572        MESSAGE: MODIFY %U1
      571     6573                 Is invalid because the field %U2 cannot be modified because
      572     6574                 of the set %U3.
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:18   
      573     6575        */
      574     6576        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_FORT-C
      575     6577        MESSAGE: CALL MODIFY (%U1)
      576     6578                 Is invalid because the field %U2 cannot be modified because
      577     6579                 of the set %U3.
      578     6580        */
      579     6581        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_APL-C
      580     6582        MESSAGE: []DBMODIFY '%U1'
      581     6583                 Is invalid because the field %U2 cannot be modified because
      582     6584                 of the set %U3.
      583     6585        */
      584     6586        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_BASIC-C
      585     6587        MESSAGE: [line no] DB MODIFY %U1
      586     6588                 Is invalid because the field %U2 cannot be modified because
      587     6589                 of the set %U3.
      588     6590        */
      589     6591    7                               DONE = '1'B;
      590     6592    7                               END;
      591     6593    6                           CD$ = PINCRW(SSS$, CD.RSCDN);
      592     6594    6                           END;
      593     6595    5                       END;
      594     6596    4                   RS$ = PINCRW(SSS$, RS.RCRSN);
      595     6597    4                   END;
      596     6598    3               END;
      597     6599    2           RC$ = PINCRW(SSS$, RC.OARCN);
      598     6600    2           END;
      599     6601    1       FIRST_RC = '1'B;
      600     6602    1       RC$ = PINCRW(SSS$, OA.OARCN);
      601     6603    2       DO WHILE (SSS$ ~= RC$);
      602     6604    2           IF ~RC.DEF.SR
      603     6605    3           THEN DO;
      604     6606    3               NUM_SM = 0;
      605     6607    3               RS$ = PINCRW(SSS$, RC.RCRSN);
      606     6608    4               DO WHILE (SSS$ ~= RS$ AND NUM_SM = 0);
      607     6609    4                   SC$ = PINCRW(SSS$, RS.SCRSH);
      608     6610    4                   IF RS.DEF.TYPE = '0040'O AND ~SC.DEF.SNSS AND SC.DEF.SETT = 0
      609     6611    5                   THEN DO;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:19   
      610     6612    5                       NUM_SM = 1;
      611     6613    5                       END;
      612     6614    4                   RS$ = PINCRW(SSS$, RS.RCRSN);
      613     6615    4                   END;
      614     6616    3               IF NUM_SM = 0
      615     6617    4               THEN DO;
      616     6618    4                   TEMP_WORD = RC.RNAM;
      617     6619    4                   CALL SET_FIELDS(2,30,TEMP_WORD);
      618     6620    4                   IF FIRST_RC
      619     6621    5                   THEN DO;
      620     6622    5                       CALL WARNING_INT(%ZIG_PRO_MODIFY_ONLY);
      621     6623        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_COBOL-C
      622     6624        MESSAGE: MODIFY record_name ONLY|INCLUDING ...
      623     6625                 Is invalid because the record is not a member of any set
      624     6626                 present in the subschema.
      625     6627                 record_name = %U2
      626     6628        */
      627     6629        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_FORT-C
      628     6630        MESSAGE: CALL MODIFY (record_name, ONLY|INCLUDING, set_name)
      629     6631                 Is invalid because the record is not a member of any set
      630     6632                 present in the subschema.
      631     6633                 record_name = %U2
      632     6634        */
      633     6635        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_APL-C
      634     6636        MESSAGE: []DBMODIFY 'record_name ONLY|INCLUDING ...'
      635     6637                 Is invalid because the record is not a member of any set
      636     6638                 present in the subschema.
      637     6639                 record_name = %U2
      638     6640        */
      639     6641        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_BASIC-C
      640     6642        MESSAGE: [line no] DB MODIFY record_name ONLY/INCLUDING ...
      641     6643                 Is invalid because the record is not the member of any set
      642     6644                 present in the subschema.
      643     6645                 record_name = %U2
      644     6646        */
      645     6647    5                       FIRST_RC = '0'B;
      646     6648    5                       END;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:20   
      647     6649    5                   ELSE DO;
      648     6650    5                       NUM_PROHIB = NUM_PROHIB + 1;
      649     6651    5                       CALL WARNING(%ZIG_PER_MORE_AREAS);
      650     6652    5                       END;
      651     6653    4                   END;
      652     6654    3               END;
      653     6655    2           RC$ = PINCRW(SSS$, RC.OARCN);
      654     6656    2           END;
      655     6657    1       IF NUM_PROHIB = 0
      656     6658    2       THEN DO;
      657     6659    2           CALL INFO_ONLY(%ZIG_PRO_NO_PROHIB);
      658     6660        /*E*     ERROR:    ZIG-ZIG_PRO_NO_PROHIB-C
      659     6661        MESSAGE: No prohibited statements were found for the this subschema.
      660     6662        */
      661     6663    2           END;
      662     6664    1       RETURN;
      663     6665    1   END ZIG$V_PROHIB;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:21   
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_PROHIB.

   Procedure ZIG$V_PROHIB requires 688 words for executable code.
   Procedure ZIG$V_PROHIB requires 10 words of local(AUTO) storage.

    No errors detected in file ZIG$V_PROHIB.:ZIC0TSI    .

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:22   

 Object Unit name= ZIG$V_PROHIB                               File name= ZIG$V_PROHIB.:ZIC0TOU
 UTS= SEP 05 '97 12:23:09.24 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    14     16  ZIG$V_PROHIB
    1  LblCom even  none    30     36  EOFC
    2  LblCom even  none    32     40  LIST_STRING
    3  LblCom even  none     1      1  NUM_PROHIB
    4  LblCom even  none     1      1  NUM_ERROR_MSG
    5  LblCom even  none     1      1  NUM_WARN_MSG
    6  LblCom even  none     1      1  ALLOCATE_END
    7  LblCom even  none     2      2  SUBSCHEMA_KEY
    8  LblCom even  none     1      1  BUFFER$
    9  LblCom even  none     1      1  ERROR_IO
   10  LblCom even  none     1      1  BUFFER_LEN
   11  LblCom even  none     2      2  UWA_KEY
   12  LblCom even  none     1      1  NEXT_UWA_SECOND_HALF
   13  LblCom even  none     2      2  RVA_KEY
   14  LblCom even  none     2      2  IA__KEY
   15  LblCom even  none     1      1  NEXT_RVA_SECOND_HALF
   16  LblCom even  none    32     40  SEARCHR_NB
   17  LblCom even  none    32     40  SEM_COM
   18  LblCom even  none    32     40  DMCL_XLATE
   19  LblCom even  none    32     40  Q2_PERCENT
   20  LblCom even  none   106    152  RVA
   21  LblCom even  none   656   1220  UWA
   22  LblCom even  none    32     40  TYPE_9
   23  LblCom even  none     5      5  LANG_ALLOWED
   24  LblCom even  none     1      1  SUB_LANGUAGE
   25  LblCom even  none    16     20  HEADING_TEXT
   26  LblCom even  none    13     15  LANG_TEXT
   27  LblCom even  none     1      1  HASH_SCHEMA_NAME
   28  LblCom even  none     1      1  CURRENT_RECORD
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:23   
   29  LblCom even  none    32     40  IO_BUF
   30  LblCom even  none    64    100  CONTROL
   31  LblCom even  none    32     40  TYPE_36
   32  LblCom even  none     1      1  SSS$
   33  LblCom even  none     1      1  AC$
   34  LblCom even  none     1      1  AC1$
   35  LblCom even  none     1      1  FR$
   36  LblCom even  none     1      1  FR1$
   37  LblCom even  none     1      1  SC$
   38  LblCom even  none     1      1  SC1$
   39  LblCom even  none     1      1  RC$
   40  LblCom even  none     1      1  RC1$
   41  LblCom even  none     1      1  OA$
   42  LblCom even  none     1      1  OA1$
   43  LblCom even  none     1      1  RA$
   44  LblCom even  none     1      1  RS$
   45  LblCom even  none     1      1  SM1$
   46  LblCom even  none     1      1  SS$
   47  LblCom even  none     1      1  CD$
   48  LblCom even  none     1      1  DP$
   49  LblCom even  none     1      1  DP1$
   50  LblCom even  none     1      1  AG$
   51  LblCom even  none     1      1  AG1$
   52  RoData even  UTS     14     16  ZIG$V_PROHIB
   53   Proc  even  none   688   1260  ZIG$V_PROHIB
   54  RoData even  none    63     77  ZIG$V_PROHIB

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    53      0   yes            yes      Std        0  ZIG$V_PROHIB
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 SUBLST
         yes           Std       2 READSF
         yes           Std       3 SET_FIELDS
         yes           Std       1 INFO_ONLY
         yes           Std       1 WARNING
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:25   


        1        1        /*M*     ZIG$V_PROHIB      I-D-S/II            DBACS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*     NAME: ZIG$V_PROHIB
        8        8                  PURPOSE:
        9        9              This procedure is to be called by two different processes
       10       10            in DBACS. First the validator will call it if prohibited
       11       11            list is asked for on the validation command. Second will
       12       12            be the call from the subschema display processor to display
       13       13            the prohibited list for a subschema.
       14       14
       15       15              Things that must be setup before calling is the SSS$ pointer
       16       16            to the schema subset and the schema subset in memory. The
       17       17            schema file open for update and retrieval.
       18       18
       19       19        */
       20       20        ZIG$V_PROHIB:
       21       21            PROC;

     21 53 000000   000000 700200 xent  ZIG$V_PROHIB TSX0  ! X66_AUTO_0
        53 000001   000012 000000                    ZERO    10,0
        53 000002   000024 710000 53                 TRA     s:6099

       22       22    1   DCL FIRST_FIELD BIT (1) STATIC ALIGNED;
       23       23    1   DCL NO_MEMBER_PRESENT BIT (1) STATIC;
       24       24    1   DCL SM BIT (1) STATIC;
       25       25    1   DCL DONE BIT (1);
       26       26    1   DCL TEMP_WORD CHAR (30) STATIC;
       27       27    1   DCL EOFC CHAR (120) EXT INIT ('/*/*/*/*/*/*/*/*/*');
       28       28    1   DCL LIST_STRING CHAR (128) EXT;
       29       29    1   DCL READSF ENTRY (2);
       30       30    1   DCL NUM_PROHIB UBIN (36) EXT;
       31       31    1   DCL NUM_FR UBIN (36) STATIC;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:26   
       32       32    1   DCL NUM_SM UBIN (36) STATIC;
       33       33    1   DCL FIRST_RC BIT (1) STATIC;
       34       34        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:27   
       35       35        %INCLUDE ZI_ERRORS_SUBS;
       36      555        %INCLUDE ZIG_GENERAL;
       37      663        %INCLUDE ZIG_DBA_INT;
       38      711        %INCLUDE ZI_SUB4_CAN;
       39     1368        %RVA;
       40     1645        %UWA;
       41     1980        %INCLUDE ZI_SUB_LANG;
       42     3695        %DESC_TYPE_9(NAME_MAIN=TYPE_9);
       43     3872        %GENERAL;
       44     3996    1   DCL IO_BUF CHAR (128) EXT;
       45     3997        %TEXT_LINE(STCLASS="REDEF IO_BUF");
       46     4034        %DESC_TYPE_9(STCLASS="REDEF IO_BUF");
       47     4211        %DESC_TYPE_100(STCLASS="REDEF IO_BUF");
       48     4251        %DESC_TYPE_110(STCLASS="REDEF IO_BUF");
       49     4315        %DESC_TYPE_200(STCLASS="REDEF IO_BUF");
       50     4368        %DESC_TYPE_210(STCLASS="REDEF IO_BUF");
       51     4423        %DESC_TYPE_300(STCLASS="REDEF IO_BUF");
       52     4492        %DESC_TYPE_350(STCLASS="REDEF IO_BUF");
       53     4530        %DESC_TYPE_400(STCLASS="REDEF IO_BUF");
       54     4589        %DESC_TYPE_410(STCLASS="REDEF IO_BUF");
       55     4645        %DESC_TYPE_420(STCLASS="REDEF IO_BUF");
       56     4678        %DESC_TYPE_430(STCLASS="REDEF IO_BUF");
       57     4837        %CONTROL_BLOCK;
       58     4945        %DESC_TYPE_36;
       59     4984        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:28   
       60     4985        /*
       61     4986              Now comes the sturctures for the schema subset.
       62     4987        */
       63     4988        %INCLUDE ZIG_SSS;
       64     5558        %SS_GENERAL(PSTCLASS=EXT);
       65     5579        %AC(PSTCLASS=EXT);
       66     5674        %AC1(PSTCLASS=EXT);
       67     5682        %FR(PSTCLASS=EXT);
       68     5728        %FR1(PSTCLASS=EXT);
       69     5736        %SC(PSTCLASS=EXT);
       70     5763        %SC1(PSTCLASS=EXT);
       71     5773        %RC(PSTCLASS=EXT);
       72     5806        %RC1(PSTCLASS=EXT);
       73     5816        %OA(PSTCLASS=EXT);
       74     5883        %OA1(PSTCLASS=EXT);
       75     5891        %RA(PSTCLASS=EXT);
       76     5911        %RS(PSTCLASS=EXT);
       77     5985        %SM1(PSTCLASS=EXT);
       78     5993        %SS(PSTCLASS=EXT);
       79     6007        %CD(PSTCLASS=EXT);
       80     6026        %DP(PSTCLASS=EXT);
       81     6040        %DP1(PSTCLASS=EXT);
       82     6048        %AG(PSTCLASS=EXT);
       83     6078        %AG1(PSTCLASS=EXT);
       84     6086        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:29   
       85     6087    1   WARNING_INT:

   6087 53 000003   200004 741300       WARNING_INT  STX1  ! DONE+1,,AUTO

       86     6088    1       PROC (ERROR_CODE);
       87     6089    2   DCL ERROR_CODE UBIN (36);
       88     6090    2       NUM_PROHIB = NUM_PROHIB + 1;

   6090 53 000004   000000 235000 3                  LDA     NUM_PROHIB
        53 000005   000001 035007                    ADLA    1,DL
        53 000006   000000 755000 3                  STA     NUM_PROHIB

       89     6091    2       CALL WARNING(ERROR_CODE + SUB_LANGUAGE -1);

   6091 53 000007   200005 470500                    LDP0    @ERROR_CODE,,AUTO
        53 000010   000000 236100                    LDQ     0,,PR0
        53 000011   000000 036000 24                 ADLQ    SUB_LANGUAGE
        53 000012   000001 136007                    SBLQ    1,DL
        53 000013   200006 756100                    STQ     @ERROR_CODE+1,,AUTO
        53 000014   200006 631500                    EPPR1   @ERROR_CODE+1,,AUTO
        53 000015   200007 451500                    STP1    @ERROR_CODE+2,,AUTO
        53 000016   200007 630500                    EPPR0   @ERROR_CODE+2,,AUTO
        53 000017   000000 631400 54                 EPPR1   0
        53 000020   000000 701000 xent               TSX1    WARNING
        53 000021   000000 011000                    NOP     0

       90     6092    2   END WARNING_INT;

   6092 53 000022   200004 221300                    LDX1  ! DONE+1,,AUTO
        53 000023   000001 702211                    TSX2  ! 1,X1

       91     6093        %EJECT;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:30   
       92     6094        /*
       93     6095              Lets first do throw all the Type 200-430 descriptor in the
       94     6096            subschema to print out witch one are in the schema file and
       95     6097            witch ones are not in schema so we can tell the DBA.
       96     6098        */
       97     6099    1       CALL CONCAT(HEADING_TEXT,LANG_TEXT(SUB_LANGUAGE),

   6099 53 000024   000000 236000 24                 LDQ     SUB_LANGUAGE
        53 000025   000012 402007                    MPY     10,DL
        53 000026   040000 100406                    MLR     fill='040'O
        53 000027   000000 000012 26                 ADSC9   LANG_TEXT,Q              cn=0,n=10
        53 000030   000000 000012 25                 ADSC9   HEADING_TEXT             cn=0,n=10
        53 000031   040000 100400                    MLR     fill='040'O
        53 000032   000000 000032 52                 ADSC9   0                        cn=0,n=26
        53 000033   000002 400066 25                 ADSC9   HEADING_TEXT+2           cn=2,n=54

       98     6100    1          'SUBSCHEMA PROHIBITED LIST.');
       99     6101    1       CALL SUBLST(HEADING_TEXT);

   6101 53 000034   000001 630400 54                 EPPR0   1
        53 000035   000000 631400 54                 EPPR1   0
        53 000036   000000 701000 xent               TSX1    SUBLST
        53 000037   000000 011000                    NOP     0

      100     6102    1       NUM_PROHIB = 0;

   6102 53 000040   000000 450000 3                  STZ     NUM_PROHIB

      101     6103    1       IF ~CONTROL.BITS.ALL_FIELDS

   6103 53 000041   000071 236000 30                 LDQ     CONTROL+57
        53 000042   400000 376003                    ANQ     -131072,DU
        53 000043   400000 676003                    ERQ     -131072,DU
        53 000044   000200 600000 53                 TZE     s:6172

      102     6104    2       THEN DO;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:31   
      103     6105    2           FIRST_FIELD = '1'B;

   6105 53 000045   400000 236003                    LDQ     -131072,DU
        53 000046   000000 756000 0                  STQ     FIRST_FIELD

      104     6106    2           CURRENT_RECORD = CONTROL.FIRST_SDS_RECORD;

   6106 53 000047   000075 235000 30                 LDA     CONTROL+61
        53 000050   000000 755000 28                 STA     CURRENT_RECORD

      105     6107    2           CALL READSF(CURRENT_RECORD,IO_BUF);

   6107 53 000051   000003 630400 54                 EPPR0   3
        53 000052   000002 631400 54                 EPPR1   2
        53 000053   000000 701000 xent               TSX1    READSF
        53 000054   000000 011000                    NOP     0

      106     6108    3           DO WHILE(SUBSTR(IO_BUF,0,12) ~= SUBSTR(EOFC,0,12));

   6108 53 000055   000174 710000 53                 TRA     s:6150

      107     6109    4               DO CASE(TYPE_100.TYPE/10);

   6109 53 000056   000000 236000 29                 LDQ     IO_BUF
        53 000057   000001 772000                    QRL     1
        53 000060   000005 506007                    DIV     5,DL
        53 000061   000024 136007                    SBLQ    20,DL
        53 000062   000030 116007                    CMPQ    24,DL
        53 000063   000065 602006 53                 TNC     s:6109+7,QL
        53 000064   000165 710000 53                 TRA     s:6148
        53 000065   000115 710000 53                 TRA     s:6121
        53 000066   000165 710000 53                 TRA     s:6148
        53 000067   000165 710000 53                 TRA     s:6148
        53 000070   000165 710000 53                 TRA     s:6148
        53 000071   000165 710000 53                 TRA     s:6148
        53 000072   000165 710000 53                 TRA     s:6148
        53 000073   000165 710000 53                 TRA     s:6148
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:32   
        53 000074   000165 710000 53                 TRA     s:6148
        53 000075   000165 710000 53                 TRA     s:6148
        53 000076   000165 710000 53                 TRA     s:6148
        53 000077   000115 710000 53                 TRA     s:6121
        53 000100   000165 710000 53                 TRA     s:6148
        53 000101   000165 710000 53                 TRA     s:6148
        53 000102   000165 710000 53                 TRA     s:6148
        53 000103   000165 710000 53                 TRA     s:6148
        53 000104   000115 710000 53                 TRA     s:6121
        53 000105   000165 710000 53                 TRA     s:6148
        53 000106   000165 710000 53                 TRA     s:6148
        53 000107   000165 710000 53                 TRA     s:6148
        53 000110   000165 710000 53                 TRA     s:6148
        53 000111   000115 710000 53                 TRA     s:6121
        53 000112   000165 710000 53                 TRA     s:6148
        53 000113   000115 710000 53                 TRA     s:6121
        53 000114   000122 710000 53                 TRA     s:6130

      108     6110    4               CASE (20,30,35,40,42);

      109     6111        /*W*
      110     6112              No error with any of these else the subschema validation
      111     6113            would have had errors!
      112     6114        */
      113     6115        /*
      114     6116              Areas that are in the subschema must be in the schema
      115     6117            so if the not no DML statement can be performed with the
      116     6118            subschema since a error in validation has occurred and the
      117     6119            subschema is not build correctly.
      118     6120        */
      119     6121    4                   CALL SET_FIELDS(2,30,TYPE_200.SUB_AREA_NAME);

   6121 53 000115   000010 630400 54                 EPPR0   8
        53 000116   000005 631400 54                 EPPR1   5
        53 000117   000000 701000 xent               TSX1    SET_FIELDS
        53 000120   000000 011000                    NOP     0
        53 000121   000165 710000 53                 TRA     s:6148
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:33   

      120     6122    4               CASE(43);

      121     6123        /*
      122     6124              These are the fields for the subschema and some might be in
      123     6125            groups so no DML calls can be done with them and other might
      124     6126            not have any corresponding item in the schema so no entry can
      125     6127            be in the schema subset. These fields must be written out as
      126     6128            fields that can't be gotten.
      127     6129        */
      128     6130    4                   CALL SET_FIELDS(3,30,TYPE_430.SUB_FIELD_NAME);

   6130 53 000122   000014 630400 54                 EPPR0   12
        53 000123   000005 631400 54                 EPPR1   5
        53 000124   000000 701000 xent               TSX1    SET_FIELDS
        53 000125   000000 011000                    NOP     0

      129     6131    4                   IF TYPE_430.FLAGS.TYPE = '7777'O

   6131 53 000126   000032 236000 29                 LDQ     IO_BUF+26
        53 000127   777700 376003                    ANQ     -64,DU
        53 000130   777700 116003                    CMPQ    -64,DU
        53 000131   000136 601000 53                 TNZ     s:6135

      130     6132    5                   THEN DO;

      131     6133    5                       CALL SET_FIELDS(1,9,'IN GROUP    ');

   6133 53 000132   000021 630400 54                 EPPR0   17
        53 000133   000005 631400 54                 EPPR1   5
        53 000134   000000 701000 xent               TSX1    SET_FIELDS
        53 000135   000000 011000                    NOP     0

      132     6134    5                       END;

      133     6135    4                   IF TYPE_430.FLAGS.TYPE = '7776'O

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:34   
   6135 53 000136   000032 236000 29                 LDQ     IO_BUF+26
        53 000137   777700 376003                    ANQ     -64,DU
        53 000140   777600 116003                    CMPQ    -128,DU
        53 000141   000146 601000 53                 TNZ     s:6139

      134     6136    5                   THEN DO;

      135     6137    5                       CALL SET_FIELDS(1,8,'ERRORED ');

   6137 53 000142   000025 630400 54                 EPPR0   21
        53 000143   000005 631400 54                 EPPR1   5
        53 000144   000000 701000 xent               TSX1    SET_FIELDS
        53 000145   000000 011000                    NOP     0

      136     6138    5                       END;

      137     6139    4                   IF TYPE_430.FLAGS.TYPE = '7777'O OR

   6139 53 000146   000032 236000 29                 LDQ     IO_BUF+26
        53 000147   777700 376003                    ANQ     -64,DU
        53 000150   777700 116003                    CMPQ    -64,DU
        53 000151   000156 600000 53                 TZE     s:6142
        53 000152   000032 236000 29                 LDQ     IO_BUF+26
        53 000153   777700 376003                    ANQ     -64,DU
        53 000154   777600 116003                    CMPQ    -128,DU
        53 000155   000165 601000 53                 TNZ     s:6148

      138     6140    4                      TYPE_430.FLAGS.TYPE = '7776'O
      139     6141    5                   THEN DO;

      140     6142    5                       CALL WARNING_INT(%FIELD_NOT_SO_GOOD -SUB_LANGUAGE +1);

   6142 53 000156   021513 235007                    LDA     9035,DL
        53 000157   000000 135000 24                 SBLA    SUB_LANGUAGE
        53 000160   200010 755100                    STA     @ERROR_CODE+3,,AUTO
        53 000161   200010 630500                    EPPR0   @ERROR_CODE+3,,AUTO
        53 000162   200005 450500                    STP0    DONE+2,,AUTO
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:35   
        53 000163   000003 701000 53                 TSX1    WARNING_INT
        53 000164   000000 011000                    NOP     0

      141     6143        /*E*     ERROR:    ZIG-FIELD_NOT_SO_GOOD-C
      142     6144        MESSAGE: The field "%U3" in "%U2" was %U1 so no DML call allowed.
      143     6145        */
      144     6146    5                       END;

      145     6147    4                   END;

      146     6148    3               CURRENT_RECORD = CURRENT_RECORD + 1;

   6148 53 000165   000000 235000 28                 LDA     CURRENT_RECORD
        53 000166   000001 035007                    ADLA    1,DL
        53 000167   000000 755000 28                 STA     CURRENT_RECORD

      147     6149    3               CALL READSF(CURRENT_RECORD, IO_BUF);

   6149 53 000170   000003 630400 54                 EPPR0   3
        53 000171   000002 631400 54                 EPPR1   2
        53 000172   000000 701000 xent               TSX1    READSF
        53 000173   000000 011000                    NOP     0

      148     6150    3               END;

   6150 53 000174   040000 106400                    CMPC    fill='040'O
        53 000175   000000 000014 29                 ADSC9   IO_BUF                   cn=0,n=12
        53 000176   000000 000014 1                  ADSC9   EOFC                     cn=0,n=12
        53 000177   000056 601000 53                 TNZ     s:6109

      149     6151    2           END;

      150     6152        /*
      151     6153              Now go throw all the schema subset and check what things are
      152     6154            prohibited for this subschema and tell the user why this
      153     6155            call can't be done for this record, set or key.
      154     6156
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:36   
      155     6157              As you see things are driven off of records, set, and keys
      156     6158            at this point and not DML call types. This will cause the list
      157     6159            of prohibited calls for each record in a different format then
      158     6160            GCOS but it will be more in a form that a programer would want
      159     6161            to see it in.
      160     6162
      161     6163              The basic assumption is that users want to see what can't
      162     6164            be done to this record not for this DML call this can't be
      163     6165            performed by the DBCS.
      164     6166        */
      165     6167        /*
      166     6168              Go through all the areas and see what calls can't be done for
      167     6169            that area. Note that if no records are present in the subschema
      168     6170            then some finds within areas can't be done.
      169     6171        */
      170     6172    1       AC$ = PINCRW(SSS$, OA.OAACN);

   6172 53 000200   000000 470400 41                 LDP0    OA$
        53 000201   000001 220100                    LDX0    1,,PR0
        53 000202   000000 636010                    EAQ     0,X0
        53 000203   000000 036000 32                 ADLQ    SSS$
        53 000204   000000 756000 33                 STQ     AC$

      171     6173    2       DO WHILE (AC$ ~= SSS$);

   6173 53 000205   000000 116000 32                 CMPQ    SSS$
        53 000206   000236 600000 53                 TZE     s:6209

      172     6174    2           IF AC.ACRAN = 0

   6174 53 000207   000000 470400 33                 LDP0    AC$
        53 000210   000001 720100                    LXL0    1,,PR0
        53 000211   000227 601000 53                 TNZ     s:6204

      173     6175    3           THEN DO;

      174     6176    3               TEMP_WORD = AC.ANAM;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:37   

   6176 53 000212   000000 721100                    LXL1    0,,PR0
        53 000213   000077 361003                    ANX1    63,DU
        53 000214   040000 100540                    MLR     fill='040'O
        53 000215   000026 000011                    ADSC9   22,,PR0                  cn=0,n=*X1
        53 000216   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      175     6177    3               CALL SET_FIELDS(1,30,TEMP_WORD);

   6177 53 000217   000030 630400 54                 EPPR0   24
        53 000220   000005 631400 54                 EPPR1   5
        53 000221   000000 701000 xent               TSX1    SET_FIELDS
        53 000222   000000 011000                    NOP     0

      176     6178    3               CALL WARNING_INT(%ZIG_PRO_NO_REC_AREA);

   6178 53 000223   000034 236000 54                 LDQ     28
        53 000224   200005 756100                    STQ     DONE+2,,AUTO
        53 000225   000003 701000 53                 TSX1    WARNING_INT
        53 000226   000000 011000                    NOP     0

      177     6179        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_COBOL-C
      178     6180        MESSAGE: For the area %U1 these calls are invalid because no
      179     6181                 records belong to this area:
      180     6182                 FIND (NEXT, PRIOR, CURRENT) [record_name] WITHIN %U1
      181     6183                 FIND (FIRST, LAST, INTEGER, IDENTIFIER) [record_name] WITHIN %U1
      182     6184        */
      183     6185        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_FORT-C
      184     6186        MESSAGE: For the area %U1 these calls are invalid because no
      185     6187                 records belong to this area:
      186     6188                 CALL FIND (NEXT|PRIOR|CURRENT, [record_name,] %U1)
      187     6189                 CALL FIND (FIRST|LAST|INTEGER|IDENTIFIER, [record_name,] %U1)
      188     6190        */
      189     6191        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_APL-C
      190     6192        MESSAGE: For the area %U1 these calls are invalid because no
      191     6193                 records belong to this area:
      192     6194                 []DBFIND 'NEXT|PRIOR|CURRENT [record_name] WITHIN %U1'
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:38   
      193     6195                 []DBFIND 'FIRST|LAST|INTEGER|IDENTIFIER [record_name] WITHIN %U1'
      194     6196        */
      195     6197        /*E*     ERROR:    ZIG-ZIG_PRO_NO_REC_AREA_BASIC-C
      196     6198        MESSAGE: For the area %U1 these calls are invalid because no
      197     6199                 records belong to this area:
      198     6200                 [line no] DB FIND NEXT/PRIOR/CURRENT [record_name] [WITHIN] %U1
      199     6201                 [line no] DB FIND FIRST/LAST/INTEGER/IDENTIFIER [record_name] [WITHIN] %U1
      200     6202        */
      201     6203    3               END;

      202     6204    2           AC$ = PINCRW(SSS$, AC.OAACN);

   6204 53 000227   000000 470400 33                 LDP0    AC$
        53 000230   000001 220100                    LDX0    1,,PR0
        53 000231   000000 636010                    EAQ     0,X0
        53 000232   000000 036000 32                 ADLQ    SSS$
        53 000233   000000 756000 33                 STQ     AC$

      203     6205    2           END;

   6205 53 000234   000000 116000 32                 CMPQ    SSS$
        53 000235   000207 601000 53                 TNZ     s:6174

      204     6206        /*
      205     6207              Well start the sets.
      206     6208        */
      207     6209    1       SC$ = PINCRW(SSS$,OA.OASCN);

   6209 53 000236   000000 470400 41                 LDP0    OA$
        53 000237   000001 720100                    LXL0    1,,PR0
        53 000240   000000 636010                    EAQ     0,X0
        53 000241   000000 036000 32                 ADLQ    SSS$
        53 000242   000000 756000 37                 STQ     SC$

      208     6210    2       DO WHILE (SC$ ~= SSS$);

   6210 53 000243   000000 116000 32                 CMPQ    SSS$
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:39   
        53 000244   000516 600000 53                 TZE     s:6403

      209     6211    2           IF SC.DEF.SETT = 0 AND ~SC.DEF.SNSS

   6211 53 000245   000000 470400 37                 LDP0    SC$
        53 000246   000000 236100                    LDQ     0,,PR0
        53 000247   000700 316007                    CANQ    448,DL
        53 000250   000507 601000 53                 TNZ     s:6391
        53 000251   000000 236100                    LDQ     0,,PR0
        53 000252   000026 736000                    QLS     22
        53 000253   400000 376003                    ANQ     -131072,DU
        53 000254   400000 676003                    ERQ     -131072,DU
        53 000255   000507 600000 53                 TZE     s:6391

      210     6212    3           THEN DO;

      211     6213        /*
      212     6214              A user set so come on lets tell him if any thing can't
      213     6215            be done with it.
      214     6216        */
      215     6217    3               TEMP_WORD = SC.SNAM;

   6217 53 000256   000000 720100                    LXL0    0,,PR0
        53 000257   000077 360003                    ANX0    63,DU
        53 000260   040000 100540                    MLR     fill='040'O
        53 000261   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        53 000262   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      216     6218    3               CALL SET_FIELDS (1,30,TEMP_WORD);

   6218 53 000263   000030 630400 54                 EPPR0   24
        53 000264   000005 631400 54                 EPPR1   5
        53 000265   000000 701000 xent               TSX1    SET_FIELDS
        53 000266   000000 011000                    NOP     0

      217     6219    3               RS$ = PINCRW(SSS$,SC.SCRSN);

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:40   
   6219 53 000267   000000 470400 37                 LDP0    SC$
        53 000270   000002 220100                    LDX0    2,,PR0
        53 000271   000000 636010                    EAQ     0,X0
        53 000272   000000 036000 32                 ADLQ    SSS$
        53 000273   000000 756000 44                 STQ     RS$

      218     6220    3               NO_MEMBER_PRESENT = '0'B;

   6220 53 000274   000001 450000 0                  STZ     NO_MEMBER_PRESENT

      219     6221    3               SM = '0'B;

   6221 53 000275   000002 450000 0                  STZ     SM

      220     6222    4               DO WHILE (RS$ ~= SSS$);

   6222 53 000276   000000 116000 32                 CMPQ    SSS$
        53 000277   000477 600000 53                 TZE     s:6360

      221     6223    4                   RC$ = PINCRW(SSS$,RS.RCRSH);

   6223 53 000300   000000 470400 44                 LDP0    RS$
        53 000301   000003 220100                    LDX0    3,,PR0
        53 000302   000000 636010                    EAQ     0,X0
        53 000303   000000 036000 32                 ADLQ    SSS$
        53 000304   000000 756000 39                 STQ     RC$

      222     6224    4                   IF RS.DEF.TYPE = '0100'O

   6224 53 000305   000000 236100                    LDQ     0,,PR0
        53 000306   777700 376003                    ANQ     -64,DU
        53 000307   010000 116003                    CMPQ    4096,DU
        53 000310   000332 601000 53                 TNZ     s:6282

      223     6225    5                   THEN DO;

      224     6226    5                       IF RC.DEF.SR
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:41   

   6226 53 000311   000000 471400 39                 LDP1    RC$
        53 000312   100000 236100                    LDQ     0,,PR1
        53 000313   100000 316007                    CANQ    32768,DL
        53 000314   000321 600000 53                 TZE     s:6252

      225     6227    6                       THEN DO;

      226     6228    6                           CALL WARNING_INT(%ZIG_V_SET_OWNER);

   6228 53 000315   000036 236000 54                 LDQ     30
        53 000316   200005 756100                    STQ     DONE+2,,AUTO
        53 000317   000003 701000 53                 TSX1    WARNING_INT
        53 000320   000000 011000                    NOP     0

      227     6229        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_COBOL-C
      228     6230        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      229     6231                 because the owner record is not present in the subschema:
      230     6232                 FIND OWNER WITHIN %U1
      231     6233                 IF %U1 OWNER
      232     6234                 IF %U1 TENANT
      233     6235        */
      234     6236        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_FORT-C
      235     6237        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      236     6238                 because the owner record is not present in the subschema:
      237     6239                 CALL FIND (OWNER, %U1)
      238     6240        */
      239     6241        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_APL-C
      240     6242        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      241     6243                 because the owner record is not present in the subschema:
      242     6244                 []DBFIND 'OWNER WITHIN %U1'
      243     6245        */
      244     6246        /*E*     ERROR:    ZIG-ZIG_V_SET_OWNER_BASIC-C
      245     6247        MESSAGE: For the set %U1 the calls to these DML functions are invalid
      246     6248                 because the owner record is not present in the subschema:
      247     6249                 [line no] DB FIND OWNER [WITHIN] %U1
      248     6250        */
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:42   
      249     6251    6                           END;

      250     6252    5                       IF RS.DEF.OSM

   6252 53 000321   000000 470400 44                 LDP0    RS$
        53 000322   000000 236100                    LDQ     0,,PR0
        53 000323   100000 316007                    CANQ    32768,DL
        53 000324   000470 600000 53                 TZE     s:6358

      251     6253    6                       THEN DO;

      252     6254    6                           CALL WARNING_INT(%ZIG_PRO_NO_CON_DIS_OWN);

   6254 53 000325   000040 236000 54                 LDQ     32
        53 000326   200005 756100                    STQ     DONE+2,,AUTO
        53 000327   000003 701000 53                 TSX1    WARNING_INT
        53 000330   000000 011000                    NOP     0

      253     6255        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_COBOL-C
      254     6256        MESSAGE: For the set %U1 these calls are invalid because the owner
      255     6257                 is not present in the subschema:
      256     6258                 CONNECT [record_name] TO %U1
      257     6259                 DISCONNECT [record_name] FROM %U1
      258     6260        */
      259     6261        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_FORT-C
      260     6262        MESSAGE: For the set %U1 these calls are invalid because the owner
      261     6263                 is not present in the subschema:
      262     6264                 CALL CONNECT ([record_name,] %U1)
      263     6265                 CALL DISCONNECT ([record_name,] %U1)
      264     6266        */
      265     6267        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_APL-C
      266     6268        MESSAGE: For the set %U1 these calls are invalid because the owner
      267     6269                 is not present in the subschema:
      268     6270                 []DBCONNECT '[record_name] TO %U1'
      269     6271                 []DBDISCONNECT '[record_name] FROM %U1'
      270     6272        */
      271     6273        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_OWN_BASIC-C
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:43   
      272     6274        MESSAGE: For the set %U1 these calls are invalid because the owner
      273     6275                 is not present in the subschema:
      274     6276                 [line no] DB CONNECT [record_name] [TO] %U1
      275     6277                 [line no] DB DISCONNECT [record_name] [FROM] %U1
      276     6278        */
      277     6279    6                           END;

      278     6280    5                       END;

   6280 53 000331   000470 710000 53                 TRA     s:6358

      279     6281    5                   ELSE DO;

      280     6282    5                       SM = '1'B;

   6282 53 000332   400000 236003                    LDQ     -131072,DU
        53 000333   000002 756000 0                  STQ     SM

      281     6283    5                       IF RC.DEF.SR

   6283 53 000334   000000 471400 39                 LDP1    RC$
        53 000335   100000 236100                    LDQ     0,,PR1
        53 000336   100000 316007                    CANQ    32768,DL
        53 000337   000367 600000 53                 TZE     s:6318

      282     6284    6                       THEN DO;

      283     6285    6                           IF RS.DEF.OSM AND SUBSTR(RC.RNAM,0,1) ~= '*'

   6285 53 000340   000000 236100                    LDQ     0,,PR0
        53 000341   100000 316007                    CANQ    32768,DL
        53 000342   000470 600000 53                 TZE     s:6358
        53 000343   100000 721100                    LXL1    0,,PR1
        53 000344   000077 361003                    ANX1    63,DU
        53 000345   100005 236100                    LDQ     5,,PR1
        53 000346   777000 376003                    ANQ     -512,DU
        53 000347   052000 116003                    CMPQ    21504,DU
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:44   
        53 000350   000470 600000 53                 TZE     s:6358

      284     6286    7                           THEN DO;

      285     6287    7                               NO_MEMBER_PRESENT = '1'B;

   6287 53 000351   400000 236003                    LDQ     -131072,DU
        53 000352   000001 756000 0                  STQ     NO_MEMBER_PRESENT

      286     6288    7                               TEMP_WORD = RC.RNAM;

   6288 53 000353   040000 100540                    MLR     fill='040'O
        53 000354   100005 000011                    ADSC9   5,,PR1                   cn=0,n=*X1
        53 000355   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      287     6289    7                               CALL SET_FIELDS(2,30,TEMP_WORD);

   6289 53 000356   000041 630400 54                 EPPR0   33
        53 000357   000005 631400 54                 EPPR1   5
        53 000360   000000 701000 xent               TSX1    SET_FIELDS
        53 000361   000000 011000                    NOP     0

      288     6290    7                               CALL WARNING_INT(%ZIG_PRO_NO_CON_DIS_MEM);

   6290 53 000362   000045 236000 54                 LDQ     37
        53 000363   200005 756100                    STQ     DONE+2,,AUTO
        53 000364   000003 701000 53                 TSX1    WARNING_INT
        53 000365   000000 011000                    NOP     0

      289     6291        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_COBOL-C
      290     6292        MESSAGE: For the set %U1 these calls are invalid because the member
      291     6293                 %U2 is not present in the subschema:
      292     6294                 CONNECT %U2 TO %U1
      293     6295                 DISCONNECT %U2 TO %U1
      294     6296        */
      295     6297        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_FORT-C
      296     6298        MESSAGE: For the set %U1 these calls are invalid because the member
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:45   
      297     6299                 %U2 is not present in the subschema:
      298     6300                 CALL CONNECT (%U2, %U1)
      299     6301                 CALL DISCONNECT (%U2, %U1)
      300     6302        */
      301     6303        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_APL-C
      302     6304        MESSAGE: For the set %U1 these calls are invalid because the member
      303     6305                 %U2 is not present in the subschema:
      304     6306                 []DBCONNECT '%U2 TO %U1'
      305     6307                 []DBDISCONNECT '%U2 TO %U1'
      306     6308        */
      307     6309        /*E*     ERROR:    ZIG-ZIG_PRO_NO_CON_DIS_MEM_BASIC-C
      308     6310        MESSAGE: For the set %U1 these calls are invalid because the member
      309     6311                 %U2 is not present in the subschema:
      310     6312                 [line no] DB CONNECT %U2 [TO] %U1
      311     6313                 [line no] DB DISCONNECT %U2 [FROM] %U1
      312     6314        */
      313     6315    7                               END;

      314     6316    6                           END;

   6316 53 000366   000470 710000 53                 TRA     s:6358

      315     6317    6                       ELSE DO;

      316     6318    6                           NO_MEMBER_PRESENT = '0'B;

   6318 53 000367   000001 450000 0                  STZ     NO_MEMBER_PRESENT

      317     6319    6                           SS$ = PINCRW(SSS$, RS.RSSSN);

   6319 53 000370   000001 721100                    LXL1    1,,PR0
        53 000371   000000 636011                    EAQ     0,X1
        53 000372   000000 036000 32                 ADLQ    SSS$
        53 000373   000000 756000 46                 STQ     SS$

      318     6320    6                           DONE = '0'B;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:46   
   6320 53 000374   200003 450100                    STZ     DONE,,AUTO

      319     6321    7                           DO WHILE (SS$ ~= SSS$ AND ~DONE);

   6321 53 000375   000462 710000 53                 TRA     s:6355

      320     6322    7                               CD$ = PINCRW(SSS$, SS.RSCDN);

   6322 53 000376   000000 470400 46                 LDP0    SS$
        53 000377   000001 220100                    LDX0    1,,PR0
        53 000400   000000 636010                    EAQ     0,X0
        53 000401   000000 036000 32                 ADLQ    SSS$
        53 000402   000000 756000 47                 STQ     CD$

      321     6323    8                               DO WHILE (CD$ ~= SSS$ AND ~DONE);

   6323 53 000403   000447 710000 53                 TRA     s:6353

      322     6324    8                                   FR$ = PINCRW(SSS$, CD.CDRH);

   6324 53 000404   000000 470400 47                 LDP0    CD$
        53 000405   000002 720100                    LXL0    2,,PR0
        53 000406   000000 636010                    EAQ     0,X0
        53 000407   000000 036000 32                 ADLQ    SSS$
        53 000410   000000 756000 35                 STQ     FR$

      323     6325    8                                   IF FR.DEF.FSR AND ~FR.DEF.SYN

   6325 53 000411   000000 471400 35                 LDP1    FR$
        53 000412   100000 236100                    LDQ     0,,PR1
        53 000413   000100 316007                    CANQ    64,DL
        53 000414   000442 600000 53                 TZE     s:6352
        53 000415   100000 236100                    LDQ     0,,PR1
        53 000416   000030 736000                    QLS     24
        53 000417   400000 376003                    ANQ     -131072,DU
        53 000420   400000 676003                    ERQ     -131072,DU
        53 000421   000442 600000 53                 TZE     s:6352
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:47   

      324     6326    9                                   THEN DO;

      325     6327    9                                       DONE = '1'B;

   6327 53 000422   400000 236003                    LDQ     -131072,DU
        53 000423   200003 756100                    STQ     DONE,,AUTO

      326     6328    9                                       TEMP_WORD = RC.RNAM;

   6328 53 000424   000000 473400 39                 LDP3    RC$
        53 000425   300000 721100                    LXL1    0,,PR3
        53 000426   000077 361003                    ANX1    63,DU
        53 000427   040000 100540                    MLR     fill='040'O
        53 000430   300005 000011                    ADSC9   5,,PR3                   cn=0,n=*X1
        53 000431   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      327     6329    9                                       CALL SET_FIELDS(2,30,TEMP_WORD);

   6329 53 000432   000041 630400 54                 EPPR0   33
        53 000433   000005 631400 54                 EPPR1   5
        53 000434   000000 701000 xent               TSX1    SET_FIELDS
        53 000435   000000 011000                    NOP     0

      328     6330    9                                       CALL WARNING_INT(%ZIG_PRO_MEM_NOT_IN_SET);

   6330 53 000436   000047 236000 54                 LDQ     39
        53 000437   200005 756100                    STQ     DONE+2,,AUTO
        53 000440   000003 701000 53                 TSX1    WARNING_INT
        53 000441   000000 011000                    NOP     0

      329     6331        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_COBOL-C
      330     6332        MESSAGE: For the set %U1 this call is invalid because not all the
      331     6333                 control fields are present in the subschema:
      332     6334                 CONNECT %U2 TO %U1
      333     6335        */
      334     6336        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_FORT-C
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:48   
      335     6337        MESSAGE: For the set %U1 this call is invalid because not all the
      336     6338                 control fields are present in the subschema:
      337     6339                 CALL CONNECT (%U2, %U1)
      338     6340        */
      339     6341        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_APL-C
      340     6342        MESSAGE: For the set %U1 this call is invalid because not all the
      341     6343                 control fields are present in the subschema:
      342     6344                 []DBCONNECT '%U2 TO %U1'
      343     6345        */
      344     6346        /*E*     ERROR:    ZIG-ZIG_PRO_MEM_NOT_IN_SET_BASIC-C
      345     6347        MESSAGE: For the set %U1 this call is invalid because not all the
      346     6348                 control fields are present in the subschema:
      347     6349                 [line no] DB CONNECT %U2 [TO] %U1
      348     6350        */
      349     6351    9                                       END;

      350     6352    8                                   CD$ = PINCRW(SSS$, CD.RSCDN);

   6352 53 000442   000000 470400 47                 LDP0    CD$
        53 000443   000001 220100                    LDX0    1,,PR0
        53 000444   000000 636010                    EAQ     0,X0
        53 000445   000000 036000 32                 ADLQ    SSS$
        53 000446   000000 756000 47                 STQ     CD$

      351     6353    8                                   END;

   6353 53 000447   000000 116000 32                 CMPQ    SSS$
        53 000450   000455 600000 53                 TZE     s:6354
        53 000451   200003 236100                    LDQ     DONE,,AUTO
        53 000452   400000 376003                    ANQ     -131072,DU
        53 000453   400000 676003                    ERQ     -131072,DU
        53 000454   000404 601000 53                 TNZ     s:6324

      352     6354    7                               SS$ = PINCRW(SSS$, SS.RSSSN);

   6354 53 000455   000000 470400 46                 LDP0    SS$
        53 000456   000001 720100                    LXL0    1,,PR0
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:49   
        53 000457   000000 636010                    EAQ     0,X0
        53 000460   000000 036000 32                 ADLQ    SSS$
        53 000461   000000 756000 46                 STQ     SS$

      353     6355    7                               END;

   6355 53 000462   000000 116000 32                 CMPQ    SSS$
        53 000463   000470 600000 53                 TZE     s:6358
        53 000464   200003 236100                    LDQ     DONE,,AUTO
        53 000465   400000 376003                    ANQ     -131072,DU
        53 000466   400000 676003                    ERQ     -131072,DU
        53 000467   000376 601000 53                 TNZ     s:6322

      354     6356    6                           END;

      355     6357    5                       END;

      356     6358    4                   RS$ = PINCRW(SSS$,RS.SCRSN);

   6358 53 000470   000000 470400 44                 LDP0    RS$
        53 000471   000002 220100                    LDX0    2,,PR0
        53 000472   000000 636010                    EAQ     0,X0
        53 000473   000000 036000 32                 ADLQ    SSS$
        53 000474   000000 756000 44                 STQ     RS$

      357     6359    4                   END;

   6359 53 000475   000000 116000 32                 CMPQ    SSS$
        53 000476   000300 601000 53                 TNZ     s:6223

      358     6360    3               IF NO_MEMBER_PRESENT AND SM

   6360 53 000477   000001 234000 0                  SZN     NO_MEMBER_PRESENT
        53 000500   000507 605000 53                 TPL     s:6391
        53 000501   000002 234000 0                  SZN     SM
        53 000502   000507 605000 53                 TPL     s:6391

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:50   
      359     6361    4               THEN DO;

      360     6362    4                   CALL WARNING_INT(%ZIG_V_SET_MEMBER);

   6362 53 000503   000051 236000 54                 LDQ     41
        53 000504   200005 756100                    STQ     DONE+2,,AUTO
        53 000505   000003 701000 53                 TSX1    WARNING_INT
        53 000506   000000 011000                    NOP     0

      361     6363        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_COBOL-C
      362     6364        MESSAGE: For the set %U1 these DML calls are invalid
      363     6365                 because the set has no members present in the subschema:
      364     6366                 FIND (NEXT, PRIOR) [RECORD-NAME] WITHIN %U1
      365     6367                 FIND (FIRST, LAST, INTEGER, IDENTIFIER) [RECORD-NAME]  WITHIN %U1
      366     6368                 IF %U1 MEMBER
      367     6369                 IF %U1 TENANT
      368     6370        */
      369     6371        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_FORT-C
      370     6372        MESSAGE: For the set %U1 these DML calls are invalid
      371     6373                 because the set has no members present in the subschema:
      372     6374                 CALL FIND (NEXT|PRIOR, [RECORD-NAME,] %U1)
      373     6375                 CALL FIND (FIRST|LAST|INTEGER|IDENTIFIER, [RECORD-NAME,] %U1)
      374     6376        */
      375     6377        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_APL-C
      376     6378        MESSAGE: For the set %U1 these DML calls are invalid
      377     6379                 because the set has no members present in the subschema:
      378     6380                 []DBFIND 'NEXT|PRIOR [RECORD-NAME] WITHIN %U1'
      379     6381                 []DBFIND 'FIRST|LAST|INTEGER|IDENTIFIER [RECORD-NAME] WITHIN %U1'
      380     6382        */
      381     6383        /*E*     ERROR:    ZIG-ZIG_V_SET_MEMBER_BASIC-C
      382     6384        MESSAGE: For the set %U1 these DML calls are invalid
      383     6385                 because the set has not members present in the subschema:
      384     6386                 [line no] DB FIND NEXT/PRIOR [RECORD-NAME] [WITHIN] %U1
      385     6387                 []DBFIND 'FIRST/LAST/INTEGER/IDENTIFIER [RECORD-NAME] WITHIN %U1'
      386     6388        */
      387     6389    4                   END;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:51   
      388     6390    3               END;

      389     6391    2           SC$ = PINCRW(SSS$,SC.OASCN);

   6391 53 000507   000000 470400 37                 LDP0    SC$
        53 000510   000001 720100                    LXL0    1,,PR0
        53 000511   000000 636010                    EAQ     0,X0
        53 000512   000000 036000 32                 ADLQ    SSS$
        53 000513   000000 756000 37                 STQ     SC$

      390     6392    2           END;

   6392 53 000514   000000 116000 32                 CMPQ    SSS$
        53 000515   000245 601000 53                 TNZ     s:6211

      391     6393        /*
      392     6394              Now go through all the RC records determine what
      393     6395            functions can't be done to this record and print out them
      394     6396            as warning messages.
      395     6397
      396     6398              The things that can't be done to a record are:
      397     6399            STORE, ERASE, ERASE ALL, MODIFY ALL (if in a sorted PA set),
      398     6400            and (some) FIND.
      399     6401        */
      400     6402
      401     6403    1       RC$ = PINCRW(SSS$, OA.OARCN);

   6403 53 000516   000000 470400 41                 LDP0    OA$
        53 000517   000002 220100                    LDX0    2,,PR0
        53 000520   000000 636010                    EAQ     0,X0
        53 000521   000000 036000 32                 ADLQ    SSS$
        53 000522   000000 756000 39                 STQ     RC$

      402     6404    2       DO WHILE (RC$ ~= SSS$);

   6404 53 000523   000000 116000 32                 CMPQ    SSS$
        53 000524   001126 600000 53                 TZE     s:6601
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:52   

      403     6405    2           TEMP_WORD = RC.RNAM;

   6405 53 000525   000000 470400 39                 LDP0    RC$
        53 000526   000000 720100                    LXL0    0,,PR0
        53 000527   000077 360003                    ANX0    63,DU
        53 000530   040000 100540                    MLR     fill='040'O
        53 000531   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        53 000532   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      404     6406    2           CALL SET_FIELDS(1,30,TEMP_WORD);

   6406 53 000533   000030 630400 54                 EPPR0   24
        53 000534   000005 631400 54                 EPPR1   5
        53 000535   000000 701000 xent               TSX1    SET_FIELDS
        53 000536   000000 011000                    NOP     0

      405     6407    2           IF RC.DEF.SR AND SUBSTR(RC.RNAM,0,1) ~= '*'

   6407 53 000537   000000 470400 39                 LDP0    RC$
        53 000540   000000 236100                    LDQ     0,,PR0
        53 000541   100000 316007                    CANQ    32768,DL
        53 000542   000560 600000 53                 TZE     s:6415
        53 000543   000000 720100                    LXL0    0,,PR0
        53 000544   000077 360003                    ANX0    63,DU
        53 000545   000005 236100                    LDQ     5,,PR0
        53 000546   777000 376003                    ANQ     -512,DU
        53 000547   052000 116003                    CMPQ    21504,DU
        53 000550   000560 600000 53                 TZE     s:6415

      406     6408    3           THEN DO;

      407     6409    3               CALL WARNING_INT(%ZIG_PRO_RECORD_NOT_THERE -SUB_LANGUAGE +1);

   6409 53 000551   021516 235007                    LDA     9038,DL
        53 000552   000000 135000 24                 SBLA    SUB_LANGUAGE
        53 000553   200011 755100                    STA     @ERROR_CODE+4,,AUTO
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:53   
        53 000554   200011 631500                    EPPR1   @ERROR_CODE+4,,AUTO
        53 000555   200005 451500                    STP1    DONE+2,,AUTO
        53 000556   000003 701000 53                 TSX1    WARNING_INT
        53 000557   000000 011000                    NOP     0

      408     6410        /*E*     ERROR:    ZIG-ZIG_PRO_RECORD_NOT_THERE-C
      409     6411        MESSAGE: The record "%U1" is not present in the subschema so no
      410     6412                 DML calls are allowed on it or its fields.
      411     6413        */
      412     6414    3               END;

      413     6415    2           IF ~RC.DEF.SR AND SUBSTR(RC.RNAM,0,1) ~= '*'

   6415 53 000560   000000 470400 39                 LDP0    RC$
        53 000561   000000 236100                    LDQ     0,,PR0
        53 000562   000024 736000                    QLS     20
        53 000563   400000 376003                    ANQ     -131072,DU
        53 000564   400000 676003                    ERQ     -131072,DU
        53 000565   001117 600000 53                 TZE     s:6599
        53 000566   000000 720100                    LXL0    0,,PR0
        53 000567   000077 360003                    ANX0    63,DU
        53 000570   000005 236100                    LDQ     5,,PR0
        53 000571   777000 376003                    ANQ     -512,DU
        53 000572   052000 116003                    CMPQ    21504,DU
        53 000573   001117 600000 53                 TZE     s:6599

      414     6416    3           THEN DO;

      415     6417        /*
      416     6418              Now check things in the record.
      417     6419        */
      418     6420    3               NUM_FR = 0;

   6420 53 000574   000013 450000 0                  STZ     NUM_FR

      419     6421    3               FR$ = PINCRW(SSS$, RC.RCFRN);

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:54   
   6421 53 000575   000004 721100                    LXL1    4,,PR0
        53 000576   000000 636011                    EAQ     0,X1
        53 000577   000000 036000 32                 ADLQ    SSS$
        53 000600   000000 756000 35                 STQ     FR$

      420     6422    4               DO WHILE (SSS$ ~= FR$ AND NUM_FR = 0);

   6422 53 000601   000623 710000 53                 TRA     s:6428

      421     6423    4                   IF ~FR.DEF.FSR AND ~FR.DEF.SYN

   6423 53 000602   000000 470400 35                 LDP0    FR$
        53 000603   000000 236100                    LDQ     0,,PR0
        53 000604   000035 736000                    QLS     29
        53 000605   400000 376003                    ANQ     -131072,DU
        53 000606   400000 676003                    ERQ     -131072,DU
        53 000607   000617 600000 53                 TZE     s:6427
        53 000610   000000 236100                    LDQ     0,,PR0
        53 000611   000030 736000                    QLS     24
        53 000612   400000 376003                    ANQ     -131072,DU
        53 000613   400000 676003                    ERQ     -131072,DU
        53 000614   000617 600000 53                 TZE     s:6427

      422     6424    5                   THEN DO;

      423     6425    5                       NUM_FR = 1;

   6425 53 000615   000001 235007                    LDA     1,DL
        53 000616   000013 755000 0                  STA     NUM_FR

      424     6426    5                       END;

      425     6427    4                   FR$ = PINCRW(SSS$, FR.RCFRN);

   6427 53 000617   000004 720100                    LXL0    4,,PR0
        53 000620   000000 636010                    EAQ     0,X0
        53 000621   000000 036000 32                 ADLQ    SSS$
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:55   
        53 000622   000000 756000 35                 STQ     FR$

      426     6428    4                   END;

   6428 53 000623   000000 116000 32                 CMPQ    SSS$
        53 000624   000627 600000 53                 TZE     s:6429
        53 000625   000013 235000 0                  LDA     NUM_FR
        53 000626   000602 600000 53                 TZE     s:6423

      427     6429    3               IF NUM_FR = 0

   6429 53 000627   000013 235000 0                  LDA     NUM_FR
        53 000630   000635 601000 53                 TNZ     s:6453

      428     6430    4               THEN DO;

      429     6431    4                   CALL WARNING_INT(%ZIG_PRO_REC_NO_FIELD);

   6431 53 000631   000053 236000 54                 LDQ     43
        53 000632   200005 756100                    STQ     DONE+2,,AUTO
        53 000633   000003 701000 53                 TSX1    WARNING_INT
        53 000634   000000 011000                    NOP     0

      430     6432        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_FORT-C
      431     6433        MESSAGE: CALL GET (%U1)
      432     6434                 CALL MODIFY (%U1)
      433     6435                 Are invalid because the record contains no fields.
      434     6436        */
      435     6437        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_APL-C
      436     6438        MESSAGE: []DBGET '%U1'
      437     6439                 []DBMODIFY '%U1'
      438     6440                 Are invalid because the record contains no fields.
      439     6441        */
      440     6442        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_BASIC-C
      441     6443        MESSAGE: [line no] DB GET %U1
      442     6444                 [line no] DB MODIFY %U1
      443     6445                 Are invalid because the record contains no fields.
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:56   
      444     6446        */
      445     6447        /*E*     ERROR:    ZIG-ZIG_PRO_REC_NO_FIELD_COBOL-C
      446     6448        MESSAGE: GET %U1
      447     6449                 MODIFY %U1
      448     6450                 Are invalid because the record contains no fields.
      449     6451        */
      450     6452    4                   END;

      451     6453    3               IF RC.DEF.RSTO

   6453 53 000635   000000 470400 39                 LDP0    RC$
        53 000636   000000 236100                    LDQ     0,,PR0
        53 000637   200000 316007                    CANQ    65536,DL
        53 000640   000645 600000 53                 TZE     s:6469

      452     6454    4               THEN DO;

      453     6455    4                   CALL WARNING_INT(%ZIG_PRO_RC_NOSTORE);

   6455 53 000641   000055 236000 54                 LDQ     45
        53 000642   200005 756100                    STQ     DONE+2,,AUTO
        53 000643   000003 701000 53                 TSX1    WARNING_INT
        53 000644   000000 011000                    NOP     0

      454     6456        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_COBOL-C
      455     6457        MESSAGE: STORE %U1
      456     6458        */
      457     6459        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_FORT-C
      458     6460        MESSAGE: CALL STORE (%U1)
      459     6461        */
      460     6462        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_APL-C
      461     6463        MESSAGE: []DBSTORE '%U1'
      462     6464        */
      463     6465        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOSTORE_BASIC-C
      464     6466        MESSAGE: [line no] DB STORE %U1
      465     6467        */
      466     6468    4                   END;
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:57   

      467     6469    3               IF RC.DEF.RERA

   6469 53 000645   000000 470400 39                 LDP0    RC$
        53 000646   000000 236100                    LDQ     0,,PR0
        53 000647   004000 316007                    CANQ    2048,DL
        53 000650   000715 600000 53                 TZE     s:6495

      468     6470    4               THEN DO;

      469     6471    4                   DONE = '0'B;

   6471 53 000651   200003 450100                    STZ     DONE,,AUTO

      470     6472    4                   RS$ = PINCRW(SSS$, RC.RCRSN);

   6472 53 000652   000002 720100                    LXL0    2,,PR0
        53 000653   000000 636010                    EAQ     0,X0
        53 000654   000000 036000 32                 ADLQ    SSS$
        53 000655   000000 756000 44                 STQ     RS$

      471     6473    5                   DO WHILE (RS$ ~= SSS$ AND ~DONE);

   6473 53 000656   000707 710000 53                 TRA     s:6493

      472     6474    5                       SC$ = PINCRW(SSS$, RS.SCRSH);

   6474 53 000657   000000 470400 44                 LDP0    RS$
        53 000660   000003 720100                    LXL0    3,,PR0
        53 000661   000000 636010                    EAQ     0,X0
        53 000662   000000 036000 32                 ADLQ    SSS$
        53 000663   000000 756000 37                 STQ     SC$

      473     6475    5                       IF RS.DEF.TYPE = '0100'O AND SC.DEF.SETT = 0

   6475 53 000664   000000 236100                    LDQ     0,,PR0
        53 000665   777700 376003                    ANQ     -64,DU
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:58   
        53 000666   010000 116003                    CMPQ    4096,DU
        53 000667   000702 601000 53                 TNZ     s:6492
        53 000670   000000 471400 37                 LDP1    SC$
        53 000671   100000 236100                    LDQ     0,,PR1
        53 000672   000700 316007                    CANQ    448,DL
        53 000673   000702 601000 53                 TNZ     s:6492

      474     6476    6                       THEN DO;

      475     6477    6                           DONE = '1'B;

   6477 53 000674   400000 236003                    LDQ     -131072,DU
        53 000675   200003 756100                    STQ     DONE,,AUTO

      476     6478    6                           CALL WARNING_INT(%ZIG_PRO_RC_NOERASEA);

   6478 53 000676   000057 236000 54                 LDQ     47
        53 000677   200005 756100                    STQ     DONE+2,,AUTO
        53 000700   000003 701000 53                 TSX1    WARNING_INT
        53 000701   000000 011000                    NOP     0

      477     6479        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_COBOL-C
      478     6480        MESSAGE: ERASE %U1 ALL
      479     6481        */
      480     6482        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_FORT-C
      481     6483        MESSAGE: CALL ERASE (%U1, ALL)
      482     6484        */
      483     6485        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_APL-C
      484     6486        MESSAGE: []DBERASE '%U1 ALL'
      485     6487        */
      486     6488        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASEA_BASIC-C
      487     6489        MESSAGE: [line no] DB ERASE %U1 ALL
      488     6490        */
      489     6491    6                           END;

      490     6492    5                       RS$ = PINCRW(SSS$, RS.RCRSN);

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:59   
   6492 53 000702   000000 470400 44                 LDP0    RS$
        53 000703   000002 720100                    LXL0    2,,PR0
        53 000704   000000 636010                    EAQ     0,X0
        53 000705   000000 036000 32                 ADLQ    SSS$
        53 000706   000000 756000 44                 STQ     RS$

      491     6493    5                       END;

   6493 53 000707   000000 116000 32                 CMPQ    SSS$
        53 000710   000715 600000 53                 TZE     s:6495
        53 000711   200003 236100                    LDQ     DONE,,AUTO
        53 000712   400000 376003                    ANQ     -131072,DU
        53 000713   400000 676003                    ERQ     -131072,DU
        53 000714   000657 601000 53                 TNZ     s:6474

      492     6494    4                   END;

      493     6495    3               IF RC.DEF.RERS

   6495 53 000715   000000 470400 39                 LDP0    RC$
        53 000716   000000 236100                    LDQ     0,,PR0
        53 000717   400000 316007                    CANQ    -131072,DL
        53 000720   000725 600000 53                 TZE     s:6511

      494     6496    4               THEN DO;

      495     6497    4                   CALL WARNING_INT(%ZIG_PRO_RC_NOERASE);

   6497 53 000721   000061 236000 54                 LDQ     49
        53 000722   200005 756100                    STQ     DONE+2,,AUTO
        53 000723   000003 701000 53                 TSX1    WARNING_INT
        53 000724   000000 011000                    NOP     0

      496     6498        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_COBOL-C
      497     6499        MESSAGE: ERASE %U1
      498     6500        */
      499     6501        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_FORT-C
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:60   
      500     6502        MESSAGE: CALL ERASE (%U1)
      501     6503        */
      502     6504        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_APL-C
      503     6505        MESSAGE: []DBERASE '%U1'
      504     6506        */
      505     6507        /*E*     ERROR:    ZIG-ZIG_PRO_RC_NOERASE_BASIC-C
      506     6508        MESSAGE: [line no] DB ERASE %U1
      507     6509        */
      508     6510    4                   END;

      509     6511    3               RS$ = PINCRW(SSS$, RC.RCRSN);

   6511 53 000725   000000 470400 39                 LDP0    RC$
        53 000726   000002 720100                    LXL0    2,,PR0
        53 000727   000000 636010                    EAQ     0,X0
        53 000730   000000 036000 32                 ADLQ    SSS$
        53 000731   000000 756000 44                 STQ     RS$

      510     6512    4               DO WHILE (RS$ ~= SSS$);

   6512 53 000732   000000 116000 32                 CMPQ    SSS$
        53 000733   001117 600000 53                 TZE     s:6599

      511     6513    4                   SC$ = PINCRW(SSS$, RS.SCRSH);

   6513 53 000734   000000 470400 44                 LDP0    RS$
        53 000735   000003 720100                    LXL0    3,,PR0
        53 000736   000000 636010                    EAQ     0,X0
        53 000737   000000 036000 32                 ADLQ    SSS$
        53 000740   000000 756000 37                 STQ     SC$

      512     6514    4                   TEMP_WORD = SC.SNAM;

   6514 53 000741   000000 471400 37                 LDP1    SC$
        53 000742   100000 721100                    LXL1    0,,PR1
        53 000743   000077 361003                    ANX1    63,DU
        53 000744   040000 100540                    MLR     fill='040'O
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:61   
        53 000745   100003 000011                    ADSC9   3,,PR1                   cn=0,n=*X1
        53 000746   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      513     6515    4                   CALL SET_FIELDS(3,30,TEMP_WORD);

   6515 53 000747   000062 630400 54                 EPPR0   50
        53 000750   000005 631400 54                 EPPR1   5
        53 000751   000000 701000 xent               TSX1    SET_FIELDS
        53 000752   000000 011000                    NOP     0

      514     6516    4                   IF RS.DEF.TYPE = '0040'O AND SC.DEF.SETT = 0

   6516 53 000753   000000 470400 44                 LDP0    RS$
        53 000754   000000 236100                    LDQ     0,,PR0
        53 000755   777700 376003                    ANQ     -64,DU
        53 000756   004000 116003                    CMPQ    2048,DU
        53 000757   001110 601000 53                 TNZ     s:6596
        53 000760   000000 471400 37                 LDP1    SC$
        53 000761   100000 236100                    LDQ     0,,PR1
        53 000762   000700 316007                    CANQ    448,DL
        53 000763   001110 601000 53                 TNZ     s:6596

      515     6517    5                   THEN DO;

      516     6518    5                       DONE = '0'B;

   6518 53 000764   200003 450100                    STZ     DONE,,AUTO

      517     6519    5                       CD$ = PINCRW(SSS$, RS.RSCDN);

   6519 53 000765   000001 220100                    LDX0    1,,PR0
        53 000766   000000 636010                    EAQ     0,X0
        53 000767   000000 036000 32                 ADLQ    SSS$
        53 000770   000000 756000 47                 STQ     CD$

      518     6520    6                       DO WHILE (CD$ ~= SSS$ AND ~DONE);

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:62   
   6520 53 000771   001102 710000 53                 TRA     s:6594

      519     6521    6                           IF CD.CDSH ~= 0

   6521 53 000772   000000 470400 47                 LDP0    CD$
        53 000773   000002 220100                    LDX0    2,,PR0
        53 000774   001001 600000 53                 TZE     s:6526

      520     6522    7                           THEN DO;

      521     6523    7                               FR$ = PINCRW(SSS$, CD.CDSH);

   6523 53 000775   000000 636010                    EAQ     0,X0
        53 000776   000000 036000 32                 ADLQ    SSS$
        53 000777   000000 756000 35                 STQ     FR$

      522     6524    7                               END;

   6524 53 001000   001005 710000 53                 TRA     s:6528

      523     6525    7                           ELSE DO;

      524     6526    7                               FR$ = PINCRW(SSS$, CD.CDRH);

   6526 53 001001   000002 721100                    LXL1    2,,PR0
        53 001002   000000 636011                    EAQ     0,X1
        53 001003   000000 036000 32                 ADLQ    SSS$
        53 001004   000000 756000 35                 STQ     FR$

      525     6527    7                               END;

      526     6528    6                           IF (FR.DEF.FSR AND NOT FR.DEF.SYN)

   6528 53 001005   000000 471400 35                 LDP1    FR$
        53 001006   100000 236100                    LDQ     0,,PR1
        53 001007   000100 316007                    CANQ    64,DL
        53 001010   001013 600000 53                 TZE     s:6528+6
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:63   
        53 001011   004000 316007                    CANQ    2048,DL
        53 001012   001017 600000 53                 TZE     s:6531
        53 001013   000100 316007                    CANQ    64,DL
        53 001014   001075 601000 53                 TNZ     s:6593
        53 001015   000200 316007                    CANQ    128,DL
        53 001016   001075 600000 53                 TZE     s:6593

      527     6529    6                              OR (NOT FR.DEF.FSR AND FR.DEF.FMOD)
      528     6530    7                           THEN DO;

      529     6531    7                               IF FR.FNL = 0

   6531 53 001017   100004 236100                    LDQ     4,,PR1
        53 001020   000077 316003                    CANQ    63,DU
        53 001021   001036 601000 53                 TNZ     s:6538

      530     6532    8                               THEN DO;

      531     6533    8                                   CURRENT_RECORD = PINCRW(FR$,-1)->FR1.NLIND;

   6533 53 001022   177777 236100                    LDQ     -1,,PR1
        53 001023   777777 376007                    ANQ     -1,DL
        53 001024   000000 756000 28                 STQ     CURRENT_RECORD

      532     6534    8                                   CALL READSF(CURRENT_RECORD, IO_BUF);

   6534 53 001025   000003 630400 54                 EPPR0   3
        53 001026   000002 631400 54                 EPPR1   2
        53 001027   000000 701000 xent               TSX1    READSF
        53 001030   000000 011000                    NOP     0

      533     6535    8                                   CALL SET_FIELDS(2,30,TYPE_430.SUB_FIELD_NAME);

   6535 53 001031   000010 630400 54                 EPPR0   8
        53 001032   000005 631400 54                 EPPR1   5
        53 001033   000000 701000 xent               TSX1    SET_FIELDS
        53 001034   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:64   

      534     6536    8                                   END;

   6536 53 001035   001047 710000 53                 TRA     s:6541

      535     6537    8                               ELSE DO;

      536     6538    8                                   TEMP_WORD = FR.FNAM;

   6538 53 001036   100004 221100                    LDX1    4,,PR1
        53 001037   000077 361003                    ANX1    63,DU
        53 001040   040000 100540                    MLR     fill='040'O
        53 001041   100006 000011                    ADSC9   6,,PR1                   cn=0,n=*X1
        53 001042   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      537     6539    8                                   CALL SET_FIELDS(2,30,TEMP_WORD);

   6539 53 001043   000041 630400 54                 EPPR0   33
        53 001044   000005 631400 54                 EPPR1   5
        53 001045   000000 701000 xent               TSX1    SET_FIELDS
        53 001046   000000 011000                    NOP     0

      538     6540    8                                   END;

      539     6541    7                               IF SC.SNAM = '*CALC'

   6541 53 001047   000000 470400 37                 LDP0    SC$
        53 001050   000000 720100                    LXL0    0,,PR0
        53 001051   000077 360003                    ANX0    63,DU
        53 001052   040000 106540                    CMPC    fill='040'O
        53 001053   000003 000010                    ADSC9   3,,PR0                   cn=0,n=*X0
        53 001054   000014 000005 52                 ADSC9   12                       cn=0,n=5
        53 001055   001067 601000 53                 TNZ     s:6569

      540     6542    8                               THEN DO;

      541     6543    8                                   IF FR.DEF.FSR
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:65   

   6543 53 001056   000000 471400 35                 LDP1    FR$
        53 001057   100000 236100                    LDQ     0,,PR1
        53 001060   000100 316007                    CANQ    64,DL
        53 001061   001073 600000 53                 TZE     s:6591

      542     6544    9                                   THEN DO;

      543     6545    9                                       CALL WARNING_INT(%ZIG_PRO_FIND_ANY);

   6545 53 001062   000066 236000 54                 LDQ     54
        53 001063   200005 756100                    STQ     DONE+2,,AUTO
        53 001064   000003 701000 53                 TSX1    WARNING_INT
        53 001065   000000 011000                    NOP     0

      544     6546        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_COBOL-C
      545     6547        MESSAGE: FIND ANY %U1
      546     6548                 Is invalid because not all control fields are present
      547     6549                 in the subschema.
      548     6550        */
      549     6551        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_FORT-C
      550     6552        MESSAGE: CALL FIND (ANY, %U1)
      551     6553                 Is invalid because not all control fields are present
      552     6554                 in the subschema.
      553     6555        */
      554     6556        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_APL-C
      555     6557        MESSAGE: []DBFIND 'ANY %U1'
      556     6558                 Is invalid because not all control fields are present
      557     6559                 in the subschema.
      558     6560        */
      559     6561        /*E*     ERROR:    ZIG-ZIG_PRO_FIND_ANY_BASIC-C
      560     6562        MESSAGE: [line no] DB FIND ANY %U1
      561     6563                 Is invalid because not all control fields are present
      562     6564                 in the subschema.
      563     6565        */
      564     6566    9                                       END;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:66   
      565     6567    8                                   END;

   6567 53 001066   001073 710000 53                 TRA     s:6591

      566     6568    8                               ELSE DO;

      567     6569    8                                   CALL WARNING_INT(%ZIG_PRO_SET_NOT_INCLUDE);

   6569 53 001067   000070 236000 54                 LDQ     56
        53 001070   200005 756100                    STQ     DONE+2,,AUTO
        53 001071   000003 701000 53                 TSX1    WARNING_INT
        53 001072   000000 011000                    NOP     0

      568     6570    8                                   END;

      569     6571        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_COBOL-C
      570     6572        MESSAGE: MODIFY %U1
      571     6573                 Is invalid because the field %U2 cannot be modified because
      572     6574                 of the set %U3.
      573     6575        */
      574     6576        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_FORT-C
      575     6577        MESSAGE: CALL MODIFY (%U1)
      576     6578                 Is invalid because the field %U2 cannot be modified because
      577     6579                 of the set %U3.
      578     6580        */
      579     6581        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_APL-C
      580     6582        MESSAGE: []DBMODIFY '%U1'
      581     6583                 Is invalid because the field %U2 cannot be modified because
      582     6584                 of the set %U3.
      583     6585        */
      584     6586        /*E*     ERROR:    ZIG-ZIG_PRO_SET_NOT_INCLUDE_BASIC-C
      585     6587        MESSAGE: [line no] DB MODIFY %U1
      586     6588                 Is invalid because the field %U2 cannot be modified because
      587     6589                 of the set %U3.
      588     6590        */
      589     6591    7                               DONE = '1'B;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:67   
   6591 53 001073   400000 236003                    LDQ     -131072,DU
        53 001074   200003 756100                    STQ     DONE,,AUTO

      590     6592    7                               END;

      591     6593    6                           CD$ = PINCRW(SSS$, CD.RSCDN);

   6593 53 001075   000000 470400 47                 LDP0    CD$
        53 001076   000001 220100                    LDX0    1,,PR0
        53 001077   000000 636010                    EAQ     0,X0
        53 001100   000000 036000 32                 ADLQ    SSS$
        53 001101   000000 756000 47                 STQ     CD$

      592     6594    6                           END;

   6594 53 001102   000000 116000 32                 CMPQ    SSS$
        53 001103   001110 600000 53                 TZE     s:6596
        53 001104   200003 236100                    LDQ     DONE,,AUTO
        53 001105   400000 376003                    ANQ     -131072,DU
        53 001106   400000 676003                    ERQ     -131072,DU
        53 001107   000772 601000 53                 TNZ     s:6521

      593     6595    5                       END;

      594     6596    4                   RS$ = PINCRW(SSS$, RS.RCRSN);

   6596 53 001110   000000 470400 44                 LDP0    RS$
        53 001111   000002 720100                    LXL0    2,,PR0
        53 001112   000000 636010                    EAQ     0,X0
        53 001113   000000 036000 32                 ADLQ    SSS$
        53 001114   000000 756000 44                 STQ     RS$

      595     6597    4                   END;

   6597 53 001115   000000 116000 32                 CMPQ    SSS$
        53 001116   000734 601000 53                 TNZ     s:6513

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:68   
      596     6598    3               END;

      597     6599    2           RC$ = PINCRW(SSS$, RC.OARCN);

   6599 53 001117   000000 470400 39                 LDP0    RC$
        53 001120   000002 220100                    LDX0    2,,PR0
        53 001121   000000 636010                    EAQ     0,X0
        53 001122   000000 036000 32                 ADLQ    SSS$
        53 001123   000000 756000 39                 STQ     RC$

      598     6600    2           END;

   6600 53 001124   000000 116000 32                 CMPQ    SSS$
        53 001125   000525 601000 53                 TNZ     s:6405

      599     6601    1       FIRST_RC = '1'B;

   6601 53 001126   400000 236003                    LDQ     -131072,DU
        53 001127   000015 756000 0                  STQ     FIRST_RC

      600     6602    1       RC$ = PINCRW(SSS$, OA.OARCN);

   6602 53 001130   000000 470400 41                 LDP0    OA$
        53 001131   000002 220100                    LDX0    2,,PR0
        53 001132   000000 636010                    EAQ     0,X0
        53 001133   000000 036000 32                 ADLQ    SSS$
        53 001134   000000 756000 39                 STQ     RC$

      601     6603    2       DO WHILE (SSS$ ~= RC$);

   6603 53 001135   000000 116000 32                 CMPQ    SSS$
        53 001136   001251 600000 53                 TZE     s:6657

      602     6604    2           IF ~RC.DEF.SR

   6604 53 001137   000000 470400 39                 LDP0    RC$
        53 001140   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:69   
        53 001141   000024 736000                    QLS     20
        53 001142   400000 376003                    ANQ     -131072,DU
        53 001143   400000 676003                    ERQ     -131072,DU
        53 001144   001242 600000 53                 TZE     s:6655

      603     6605    3           THEN DO;

      604     6606    3               NUM_SM = 0;

   6606 53 001145   000014 450000 0                  STZ     NUM_SM

      605     6607    3               RS$ = PINCRW(SSS$, RC.RCRSN);

   6607 53 001146   000002 720100                    LXL0    2,,PR0
        53 001147   000000 636010                    EAQ     0,X0
        53 001150   000000 036000 32                 ADLQ    SSS$
        53 001151   000000 756000 44                 STQ     RS$

      606     6608    4               DO WHILE (SSS$ ~= RS$ AND NUM_SM = 0);

   6608 53 001152   001203 710000 53                 TRA     s:6615

      607     6609    4                   SC$ = PINCRW(SSS$, RS.SCRSH);

   6609 53 001153   000000 470400 44                 LDP0    RS$
        53 001154   000003 720100                    LXL0    3,,PR0
        53 001155   000000 636010                    EAQ     0,X0
        53 001156   000000 036000 32                 ADLQ    SSS$
        53 001157   000000 756000 37                 STQ     SC$

      608     6610    4                   IF RS.DEF.TYPE = '0040'O AND ~SC.DEF.SNSS AND SC.DEF.SETT = 0

   6610 53 001160   000000 236100                    LDQ     0,,PR0
        53 001161   777700 376003                    ANQ     -64,DU
        53 001162   004000 116003                    CMPQ    2048,DU
        53 001163   001177 601000 53                 TNZ     s:6614
        53 001164   000000 471400 37                 LDP1    SC$
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:70   
        53 001165   100000 236100                    LDQ     0,,PR1
        53 001166   000026 736000                    QLS     22
        53 001167   400000 376003                    ANQ     -131072,DU
        53 001170   400000 676003                    ERQ     -131072,DU
        53 001171   001177 600000 53                 TZE     s:6614
        53 001172   100000 236100                    LDQ     0,,PR1
        53 001173   000700 316007                    CANQ    448,DL
        53 001174   001177 601000 53                 TNZ     s:6614

      609     6611    5                   THEN DO;

      610     6612    5                       NUM_SM = 1;

   6612 53 001175   000001 235007                    LDA     1,DL
        53 001176   000014 755000 0                  STA     NUM_SM

      611     6613    5                       END;

      612     6614    4                   RS$ = PINCRW(SSS$, RS.RCRSN);

   6614 53 001177   000002 721100                    LXL1    2,,PR0
        53 001200   000000 636011                    EAQ     0,X1
        53 001201   000000 036000 32                 ADLQ    SSS$
        53 001202   000000 756000 44                 STQ     RS$

      613     6615    4                   END;

   6615 53 001203   000000 116000 32                 CMPQ    SSS$
        53 001204   001207 600000 53                 TZE     s:6616
        53 001205   000014 235000 0                  LDA     NUM_SM
        53 001206   001153 600000 53                 TZE     s:6609

      614     6616    3               IF NUM_SM = 0

   6616 53 001207   000014 235000 0                  LDA     NUM_SM
        53 001210   001242 601000 53                 TNZ     s:6655

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:71   
      615     6617    4               THEN DO;

      616     6618    4                   TEMP_WORD = RC.RNAM;

   6618 53 001211   000000 470400 39                 LDP0    RC$
        53 001212   000000 720100                    LXL0    0,,PR0
        53 001213   000077 360003                    ANX0    63,DU
        53 001214   040000 100540                    MLR     fill='040'O
        53 001215   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
        53 001216   000003 000036 0                  ADSC9   TEMP_WORD                cn=0,n=30

      617     6619    4                   CALL SET_FIELDS(2,30,TEMP_WORD);

   6619 53 001217   000041 630400 54                 EPPR0   33
        53 001220   000005 631400 54                 EPPR1   5
        53 001221   000000 701000 xent               TSX1    SET_FIELDS
        53 001222   000000 011000                    NOP     0

      618     6620    4                   IF FIRST_RC

   6620 53 001223   000015 234000 0                  SZN     FIRST_RC
        53 001224   001233 605000 53                 TPL     s:6650

      619     6621    5                   THEN DO;

      620     6622    5                       CALL WARNING_INT(%ZIG_PRO_MODIFY_ONLY);

   6622 53 001225   000072 236000 54                 LDQ     58
        53 001226   200005 756100                    STQ     DONE+2,,AUTO
        53 001227   000003 701000 53                 TSX1    WARNING_INT
        53 001230   000000 011000                    NOP     0

      621     6623        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_COBOL-C
      622     6624        MESSAGE: MODIFY record_name ONLY|INCLUDING ...
      623     6625                 Is invalid because the record is not a member of any set
      624     6626                 present in the subschema.
      625     6627                 record_name = %U2
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:72   
      626     6628        */
      627     6629        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_FORT-C
      628     6630        MESSAGE: CALL MODIFY (record_name, ONLY|INCLUDING, set_name)
      629     6631                 Is invalid because the record is not a member of any set
      630     6632                 present in the subschema.
      631     6633                 record_name = %U2
      632     6634        */
      633     6635        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_APL-C
      634     6636        MESSAGE: []DBMODIFY 'record_name ONLY|INCLUDING ...'
      635     6637                 Is invalid because the record is not a member of any set
      636     6638                 present in the subschema.
      637     6639                 record_name = %U2
      638     6640        */
      639     6641        /*E*     ERROR:    ZIG-ZIG_PRO_MODIFY_ONLY_BASIC-C
      640     6642        MESSAGE: [line no] DB MODIFY record_name ONLY/INCLUDING ...
      641     6643                 Is invalid because the record is not the member of any set
      642     6644                 present in the subschema.
      643     6645                 record_name = %U2
      644     6646        */
      645     6647    5                       FIRST_RC = '0'B;

   6647 53 001231   000015 450000 0                  STZ     FIRST_RC

      646     6648    5                       END;

   6648 53 001232   001242 710000 53                 TRA     s:6655

      647     6649    5                   ELSE DO;

      648     6650    5                       NUM_PROHIB = NUM_PROHIB + 1;

   6650 53 001233   000000 235000 3                  LDA     NUM_PROHIB
        53 001234   000001 035007                    ADLA    1,DL
        53 001235   000000 755000 3                  STA     NUM_PROHIB

      649     6651    5                       CALL WARNING(%ZIG_PER_MORE_AREAS);

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:73   
   6651 53 001236   000074 630400 54                 EPPR0   60
        53 001237   000000 631400 54                 EPPR1   0
        53 001240   000000 701000 xent               TSX1    WARNING
        53 001241   000000 011000                    NOP     0

      650     6652    5                       END;

      651     6653    4                   END;

      652     6654    3               END;

      653     6655    2           RC$ = PINCRW(SSS$, RC.OARCN);

   6655 53 001242   000000 470400 39                 LDP0    RC$
        53 001243   000002 220100                    LDX0    2,,PR0
        53 001244   000000 636010                    EAQ     0,X0
        53 001245   000000 036000 32                 ADLQ    SSS$
        53 001246   000000 756000 39                 STQ     RC$

      654     6656    2           END;

   6656 53 001247   000000 116000 32                 CMPQ    SSS$
        53 001250   001137 601000 53                 TNZ     s:6604

      655     6657    1       IF NUM_PROHIB = 0

   6657 53 001251   000000 235000 3                  LDA     NUM_PROHIB
        53 001252   001257 601000 53                 TNZ     s:6664

      656     6658    2       THEN DO;

      657     6659    2           CALL INFO_ONLY(%ZIG_PRO_NO_PROHIB);

   6659 53 001253   000076 630400 54                 EPPR0   62
        53 001254   000000 631400 54                 EPPR1   0
        53 001255   000000 701000 xent               TSX1    INFO_ONLY
        53 001256   000000 011000                    NOP     0
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:74   

      658     6660        /*E*     ERROR:    ZIG-ZIG_PRO_NO_PROHIB-C
      659     6661        MESSAGE: No prohibited statements were found for the this subschema.
      660     6662        */
      661     6663    2           END;

      662     6664    1       RETURN;

   6664 53 001257   000000 702200 xent               TSX2  ! X66_ARET

TEMP_WORD
 Sect OctLoc
   0     003   ****** ******   ****** ******   ****** ******   ****** ******    ................

EOFC
 Sect OctLoc
   1     000   057052 057052   057052 057052   057052 057052   057052 057052    /*/*/*/*/*/*/*/*
   1     004   057052 040040   040040 040040   040040 040040   040040 040040    /*
   1     010   040040 040040   040040 040040   040040 040040   040040 040040
   1     034*  040040 040040   040040 040040

LIST_STRING
 Sect OctLoc
   2     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

UWA_KEY
 Sect OctLoc
  11     000   007125 127101   ****** ******                                    .UWA....

RVA_KEY
 Sect OctLoc
  13     000   007122 126101   ****** ******                                    .RVA....

IA__KEY
 Sect OctLoc
  14     000   007111 101137   ****** ******                                    .IA_....

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:75   
SEARCHR_NB
 Sect OctLoc
  16     000   001001 001001   001001 001001   001001 001001   001001 001001    ................
  16     010*  000001 001001   001001 001001   001001 001001   001001 001001    ................
  16     014   001001 001001   001001 001001   001001 001001   001001 001001    ................
  16     034*  001001 001001   001001 001001   001001 001001   001001 001001    ................

SEM_COM
 Sect OctLoc
  17     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  17     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  17     010   040041 042043   044045 046047   050051 052053   054055 056057     !"#$%&'()*+,-./
  17     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  17     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  17     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  17     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  17     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

DMCL_XLATE
 Sect OctLoc
  18     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  18     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  18     010   040041 041043   044045 046047   050051 052053   054055 136057     !!#$%&'()*+,-^/
  18     014   060061 062063   064065 066067   070071 072040   074075 076077    0123456789: <=>?
  18     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  18     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
  18     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  18     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

Q2_PERCENT
 Sect OctLoc
  19     000   000001 002003   004005 006007   010011 012013   014015 016017    ................
  19     004   020021 022023   024025 026027   030031 032033   034035 036037    ................
  19     010   040041 045043   044045 046047   050051 052053   054055 056057     !%#$%&'()*+,-./
  19     014   060061 062063   064065 066067   070071 072073   074075 076077    0123456789:;<=>?
  19     020   100101 102103   104105 106107   110111 112113   114115 116117    @ABCDEFGHIJKLMNO
  19     024   120121 122123   124125 126127   130131 132133   134135 136137    PQRSTUVWXYZ[\]^_
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:76   
  19     030   140141 142143   144145 146147   150151 152153   154155 156157    `abcdefghijklmno
  19     034   160161 162163   164165 166167   170171 172173   174175 176177    pqrstuvwxyz{|}~.

RVA
 Sect OctLoc
  20     000   000151 000000   000000 000001   000001 000002   000001 000003    .i..............
  20     004   000001 000004   000001 000005   000001 000006   000001 000007    ................
  20     010   000001 000010   000001 000011   000001 000012   000001 000013    ................
  20     014   000001 000014   000001 000015   000001 000016   000001 000017    ................
  20     020   000001 000020   000001 000021   000001 000022   000001 000023    ................
  20     024   000001 000024   000001 000025   000001 000026   000001 000027    ................
  20     030   000001 000030   000001 000031   000001 000032   000001 000033    ................
  20     034   000001 000034   000001 000035   000001 000036   000001 000037    ................
  20     040   000001 000040   000001 000041   000001 000042   000001 000043    ... ...!..."...#
  20     044   000001 000044   000001 000045   000001 000046   000001 000047    ...$...%...&...'
  20     050   000001 000050   000001 000051   000001 000052   000002 000600    ...(...)...*....
  20     054   000002 000660   000002 001040   000002 001260   000002 001460    ....... ........
  20     060   000002 001540   000002 001660   000002 001700   000002 002140    ...............`
  20     064   000002 002320   000002 002700   000002 003100   000002 003260    ...........@....
  20     070   000002 003320   000002 003540   000002 003600   000002 003740    ................
  20     074   000002 004000   000002 004060   000002 004220   000002 004400    .......0........
  20     100   000002 004540   000002 004660   000002 004720   000002 004760    ................
  20     104   000002 005000   000002 005020   000002 005220   000002 005240    ................
  20     110   000002 005500   000002 005740   000002 005760   000002 006000    ................
  20     114   000002 006020   000002 006040   000002 006220   000002 006340    ....... ........
  20     120   000002 006640   000002 006760   000002 007120   000002 007240    ...........P....
  20     124   000002 007320   000002 007420   000002 007560   000002 007640    ................
  20     130   000002 007760   000002 010120   000002 010360   000002 010460    .......P........
  20     134   000002 010620   000002 010720   000002 011060   000002 011160    ...........0...p
  20     140   000002 011220   000002 011320   000002 011400   000002 011460    ................
  20     144   000002 011540   000002 011620   000002 011700   000002 011760    ................
  20     150   000002 012040   000004 000000                                    ... ....

UWA
 Sect OctLoc
  21     000   000000 000000   040040 040040   040040 040040   040040 040040    ....
  21     004   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:77   
  21     010   040040 040040   040040 040040   040040 000000   040040 040040              ..
  21     014   040040 040040   040040 040040   040040 040040   040040 040040
  21     020   040040 040040   040040 040040   040040 000000   040040 040040              ..
  21     024   040040 040040   040040 040040   040040 040040   040040 040040
  21     030   040040 040040   040040 040040   040040 000000   040040 040040              ..
  21     034   040040 040040   040040 040040   000000 000000   040040 040040            ....
  21     040   040040 040040   040040 040040   040040 040040   040040 040040
  21     044   040040 040040   040040 040040   040040 000000   040040 040040              ..
  21     050   040040 040040   040040 040040   040040 040040   040040 040040
  21     054   040040 040040   040040 040040   040040 000000   000000 000000              ......
  21     060   040040 040040   040*** ******   000000 000000   000000 000000         ...........
  21     064   000000 000000   000000 000000   040040 040040   040040 040040    ........
  21     070   040040 040040   040040 040040   040040 040040   040040 040040
  21     100*  040040 ******   000000 000000   040040 040040   040040 040040      ......
  21     104   040040 040040   040040 040040   040040 040040   040040 040040
  21     124*  040040 040040   040040 040040   000000 000000   040040 040040            ....
  21     130   040040 040040   040040 040040   040040 040040   040040 040040
  21     134   040040 040040   040040 040040   040040 ******   000000 000000              ......
  21     140   040040 040040   040040 040040   040040 040040   040040 040040
  21     144   040040 040040   040040 040040   000000 000000   000000 000000            ........
  21     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     154   040040 040040   040040 040040   040040 040040   040040 040040
  21     160   040040 040040   040040 040040   040040 040040   040040 ******                  ..
  21     164   000000 000000   ****** ******   000000 000000   000000 000000    ................
  21     170   000000 000000   040040 040040   040040 040040   040040 040040    ....
  21     174   040040 040040   040040 040040   040040 040040   040040 040040
  21     210*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  21     214   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     224*  000000 000000   000000 000000   000000 000000   040040 ******    ............  ..
  21     230   000000 000000   ****** ******   000000 000000   040040 040040    ............
  21     234   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     264*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  21     270   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     324*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  21     330   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     350*  000000 000000   000000 000000   000000 000000   ****** ******    ................
  21     360*  000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:78   
  21     404*  000000 000000   ****** ******   000000 000000   000000 000000    ................
  21     410   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     424*  000000 000000   000000 000000   000000 000000   040040 040040    ............
  21     430   040040 040040   040040 040040   040040 040040   040040 040040
  21     434   040040 040040   040040 040040   040040 ******   ****** ******              ......
  21     440   040040 040040   040040 040040   040040 040040   040040 040040
  21     450*  040040 040040   040040 040040   040040 ******   ****** ******              ......
  21     454   000000 000000   040040 040040   040040 040040   040040 040040    ....
  21     460   040040 040040   040040 040040   040040 040040   040040 040040
  21     464   040040 ******   ****** ******   000000 000000   000000 000000      ..............
  21     470   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     474   000000 000000   ****** ******   000000 000000   000000 000000    ................
  21     500   000000 000000   000000 000000   040040 040040   040040 040040    ........
  21     504   040040 040040   040040 040040   040040 040040   040040 040040
  21     520*  040040 040040   ****** ******   000000 000000   000000 000000        ............
  21     524   040040 040040   040040 040040   040040 040040   040040 040040
  21     574*  000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     600   000000 000000   000000 000000   000000 000000   ****** ******    ................
  21     604   000000 000000   000000 000000   000000 000000   000000 000000    ................
  21     610   000000 000000   000000 000000   040040 040040   040040 040040    ........
  21     614   040040 040040   040040 040040   040040 040040   040040 040040
  21     620   040040 040040   040040 ******   040040 040040   040040 040040          ..
  21     624   040040 040040   040040 040040   040040 040040   040040 040040
  21     660*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  21     664   040040 040040   040040 040040   040040 040040   040040 040040
  21     674*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21     700   040040 040040   040040 040040   040040 040040   040040 040040
  21     710*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21     714   040040 040040   040040 040040   040040 040040   040040 040040
  21     720   040040 040040   040040 040040   040040 040040   ****** ******                ....
  21     724   040040 040040   040040 040040   040040 040040   040040 040040
  21     740*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21     744   040040 040040   040040 040040   040040 040040   040040 040040
  21     774*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21    1000   040040 040040   040040 040040   040040 040040   040040 040040
  21    1034*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21    1040   040040 040040   040040 040040   040040 040040   040040 040040
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:79   
  21    1060*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21    1064   040040 040040   040040 040040   040040 040040   040040 040040
  21    1114*  040040 040040   ****** ******   040040 040040   040040 040040        ....
  21    1120   040040 040040   040040 040040   040040 040040   040040 040040
  21    1134*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  21    1140   040040 040040   040040 040040   040040 040040   040040 040040
  21    1144   040040 040040   ****** ******   040040 040040   040040 040040        ....
  21    1150   040040 040040   040040 040040   040040 040040   ****** ******                ....
  21    1154   040040 040040   040040 040040   040040 040040   040040 040040
  21    1160   040040 040040   ****** ******   040040 040040   040040 040040        ....
  21    1164   040040 040040   040040 040040   040040 040040   ****** ******                ....
  21    1170   040040 040040   040040 040040   040040 040040   040040 040040
  21    1200*  040040 040040   040040 040040   040040 040040   ****** ******                ....
  21    1204   040040 040040   040040 040040   040040 040040   040040 040040
  21    1214*  040040 040040   040040 040040   040040 040040   040040 040040

TYPE_9
 Sect OctLoc
  22     000   000000 000160   000000 000000   000000 000000   000000 000011    ...p............
  22     004   000000 000000   000000 000000   000000 000000   000000 000000    ................
  22     020*  000000 000000   200000 000000   000000 000000   000000 000000    ................
  22     024   000000 000000   000000 000000   000000 000000   000000 000000    ................
  22     030   040040 040040   040040 040040   040040 040040   040040 040040
  22     034   040040 040040   040040 040040   040040 040040   040040 040040

LANG_ALLOWED
 Sect OctLoc
  23     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

HEADING_TEXT
 Sect OctLoc
  25     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

LANG_TEXT
 Sect OctLoc
  26     000   116117 124040   125123 105104   040040 103117   102117 114040    NOT USED  COBOL
  26     004   040040 040040   106117 122124   122101 116040   040040 101120        FORTRAN   AP
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:80   
  26     010   114040 040040   040040 040040   102101 123111   103040 040040    L       BASIC
  26     014   040040 ******                                                      ..

HASH_SCHEMA_NAME
 Sect OctLoc
  27     000   0***** ******                                                    ....

IO_BUF
 Sect OctLoc
  29     000   ****** ******   ****** ******   ****** ******   ****** ******    ................

CONTROL
 Sect OctLoc
  30     000   777777 777777   000000 000001   000000 000000   000000 000036    ................
  30     004   000000 000060   000000 000000   000000 000000   000000 000000    ...0............
  30     010   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     020*  040040 040040   040040 040040   040040 040040   040040 040040
  30     040*  000000 000144   000000 000000   400000 000000   042116 125114    ...d........"NUL
  30     044   114042 040040   040040 040040   042116 125114   114042 040040    L"      "NULL"
  30     050   040040 040040   000000 000060   000000 000000   000000 000000        ...0........
  30     054   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     064*  000000 000000   040040 040040   040040 040040   040040 040040    ....
  30     070   000000 000000   000000 000000   000000 000000   000000 000000    ................
  30     074   000000 000002   000000 000000   000000 000000   000000 000000    ................

TYPE_36
 Sect OctLoc
  31     000   000000 000044   000000 000000   000000 000000   000000 000044    ...$...........$
  31     004   000000 000000   040040 040040   040040 040040   040040 040040    ....
  31     010   040040 040040   040040 040040   040040 040040   040040 040040
  31     034*  040040 040040   000000 000000   000000 000000   000000 000000        ............

(unnamed)
 Sect OctLoc
  52     000   123125 102123   103110 105115   101040 120122   117110 111102    SUBSCHEMA PROHIB
  52     004   111124 105104   040114 111123   124056 040040   111116 040107    ITED LIST.  IN G
  52     010   122117 125120   040040 040040   105122 122117   122105 104040    ROUP    ERRORED
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:81   
  52     014   052103 101114   103040 040040                                    *CALC

(unnamed)
 Sect OctLoc
  54     000   000001 000000   000000 006000   000002 000000   000000 006000    ................
  54     004   000000 006000   000003 000000   000000 000002   000000 000036    ................
  54     010   000006 006000   000007 006000   000013 006000   000000 000003    ................
  54     014   000013 006000   000007 006000   000013 006000   000000 000001    ................
  54     020   000000 000011   000017 006000   000020 006000   000007 006000    ................
  54     024   000000 000010   000017 006000   000024 006000   000012 006000    ................
  54     030   000017 006000   000007 006000   000003 006000   000000 022441    ................
  54     034   000033 006000   000000 022446   000035 006000   000000 022460    ................
  54     040   000037 006000   000006 006000   000007 006000   000003 006000    ................
  54     044   000000 022453   000044 006000   000000 022465   000046 006000    .....$.......&..
  54     050   000000 022472   000050 006000   000000 022542   000052 006000    .....(.......*..
  54     054   000000 022504   000054 006000   000000 022511   000056 006000    .....,..........
  54     060   000000 022516   000060 006000   000013 006000   000007 006000    .....0..........
  54     064   000003 006000   000000 022523   000065 006000   000000 022530    .........5......
  54     070   000067 006000   000000 022535   000071 006000   000000 022270    .7.......9......
  54     074   000073 006000   000000 021533   000075 006000                    .;.......=..
      663     6665    1   END ZIG$V_PROHIB;

PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:82   
--  Include file information  --

   ZIG_SSS.:ZIC0TOU  is referenced.
   ZI_SUB_LANG.:ZIC0TOU  is referenced.
   ZI_SUB4_CAN.:ZIC0TOU  is referenced.
   ZIG_DBA_INT.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZIG_GENERAL.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI_ERRORS_SUBS.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ZIG$V_PROHIB.

   Procedure ZIG$V_PROHIB requires 688 words for executable code.
   Procedure ZIG$V_PROHIB requires 10 words of local(AUTO) storage.

    No errors detected in file ZIG$V_PROHIB.:ZIC0TSI    .
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:83   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:84   
          MINI XREF LISTING

AC.ACRAN
      5601**DCL      6174>>IF
AC.ANAM
      5670**DCL      6176>>ASSIGN
AC.DEF.ANL
      5599**DCL      5670--IMP-SIZ  6176>>ASSIGN
AC.DEF.FORG
      5586**DCL      5590--REDEF
AC.OAACN
      5600**DCL      6204>>ASSIGN
AC$
      5582**DCL      5583--IMP-PTR  6172<<ASSIGN   6173>>DOWHILE  6174>>IF       6176>>ASSIGN   6176>>ASSIGN
      6204<<ASSIGN   6204>>ASSIGN
AC1$
      5676**DCL      5677--IMP-PTR
AG$
      6050**DCL      6051--IMP-PTR
AG1$
      6080**DCL      6081--IMP-PTR
CD.CDRH
      6022**DCL      6324>>ASSIGN   6526>>ASSIGN
CD.CDSH
      6021**DCL      6521>>IF       6523>>ASSIGN
CD.RSCDN
      6019**DCL      6352>>ASSIGN   6593>>ASSIGN
CD$
      6009**DCL      6010--IMP-PTR  6322<<ASSIGN   6323>>DOWHILE  6324>>ASSIGN   6352<<ASSIGN   6352>>ASSIGN
      6519<<ASSIGN   6520>>DOWHILE  6521>>IF       6523>>ASSIGN   6526>>ASSIGN   6593<<ASSIGN   6593>>ASSIGN
CONTROL.BITS.ALL_FIELDS
      4936**DCL      6103>>IF
CONTROL.FIRST_SDS_RECORD
      4941**DCL      6106>>ASSIGN
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:85   
CURRENT_RECORD
      3982**DCL      6106<<ASSIGN   6107<>CALL     6148<<ASSIGN   6148>>ASSIGN   6149<>CALL     6533<<ASSIGN
      6534<>CALL
DONE
        25**DCL      6320<<ASSIGN   6321>>DOWHILE  6323>>DOWHILE  6327<<ASSIGN   6471<<ASSIGN   6473>>DOWHILE
      6477<<ASSIGN   6518<<ASSIGN   6520>>DOWHILE  6591<<ASSIGN
DP$
      6028**DCL      6029--IMP-PTR
DP1$
      6042**DCL      6043--IMP-PTR
EOFC
        27**DCL      6108>>DOWHILE
ERROR_CODE IN PROCEDURE WARNING_INT
      6089**DCL      6088--PROC     6091>>CALL
FIRST_FIELD
        22**DCL      6105<<ASSIGN
FIRST_RC
        33**DCL      6601<<ASSIGN   6620>>IF       6647<<ASSIGN
FR.DEF.FMOD
      5696**DCL      6528>>IF
FR.DEF.FSR
      5697**DCL      6325>>IF       6423>>IF       6528>>IF       6528>>IF       6543>>IF
FR.DEF.SYN
      5694**DCL      6325>>IF       6423>>IF       6528>>IF
FR.FNAM
      5725**DCL      6538>>ASSIGN
FR.FNL
      5721**DCL      5725--IMP-SIZ  6531>>IF       6538>>ASSIGN
FR.RCFRN
      5722**DCL      6427>>ASSIGN
FR.UOFST.EIS.OFFSET
      5711**DCL      5714--REDEF
FR$
      5685**DCL      5686--IMP-PTR  6324<<ASSIGN   6325>>IF       6325>>IF       6421<<ASSIGN   6422>>DOWHILE
      6423>>IF       6423>>IF       6427<<ASSIGN   6427>>ASSIGN   6523<<ASSIGN   6526<<ASSIGN   6528>>IF
      6528>>IF       6528>>IF       6528>>IF       6531>>IF       6533>>ASSIGN   6538>>ASSIGN   6538>>ASSIGN
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:86   
      6543>>IF
FR1.NLIND
      5733**DCL      6533>>ASSIGN
FR1$
      5730**DCL      5731--IMP-PTR
HEADING_TEXT
      3893**DCL      6099<<CALLBLT  6101<>CALL
INFO_ONLY
       570**DCL-ENT  6659--CALL
IO_BUF
      3996**DCL      4022--REDEF    4137--REDEF    4240--REDEF    4289--REDEF    4348--REDEF    4397--REDEF
      4449--REDEF    4517--REDEF    4556--REDEF    4619--REDEF    4668--REDEF    4735--REDEF    6107<>CALL
      6108>>DOWHILE  6149<>CALL     6534<>CALL
LANG_TEXT
      3894**DCL      6099>>CALLBLT
NO_MEMBER_PRESENT
        23**DCL      6220<<ASSIGN   6287<<ASSIGN   6318<<ASSIGN   6360>>IF
NUM_FR
        31**DCL      6420<<ASSIGN   6422>>DOWHILE  6425<<ASSIGN   6429>>IF
NUM_PROHIB
        30**DCL      6090<<ASSIGN   6090>>ASSIGN   6102<<ASSIGN   6650<<ASSIGN   6650>>ASSIGN   6657>>IF
NUM_SM
        32**DCL      6606<<ASSIGN   6608>>DOWHILE  6612<<ASSIGN   6616>>IF
OA.OAACN
      5827**DCL      6172>>ASSIGN
OA.OARCN
      5829**DCL      6403>>ASSIGN   6602>>ASSIGN
OA.OASCN
      5828**DCL      6209>>ASSIGN
OA.SCNAM.EIS.COUNT
      5841**DCL      5878--IMP-SIZ
OA$
      5819**DCL      5820--IMP-PTR  6172>>ASSIGN   6209>>ASSIGN   6403>>ASSIGN   6602>>ASSIGN
OA1$
      5885**DCL      5886--IMP-PTR
RA$
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:87   
      5893**DCL      5894--IMP-PTR
RC.DEF.RERA
      5788**DCL      6469>>IF
RC.DEF.RERS
      5782**DCL      6495>>IF
RC.DEF.RNL
      5793**DCL      5803--IMP-SIZ  6285>>IF       6288>>ASSIGN   6328>>ASSIGN   6405>>ASSIGN   6407>>IF
      6415>>IF       6618>>ASSIGN
RC.DEF.RSTO
      5783**DCL      6453>>IF
RC.DEF.SR
      5784**DCL      6226>>IF       6283>>IF       6407>>IF       6415>>IF       6604>>IF
RC.OARCN
      5796**DCL      6599>>ASSIGN   6655>>ASSIGN
RC.RCFRN
      5802**DCL      6421>>ASSIGN
RC.RCRSN
      5797**DCL      6472>>ASSIGN   6511>>ASSIGN   6607>>ASSIGN
RC.RNAM
      5803**DCL      6285>>IF       6288>>ASSIGN   6328>>ASSIGN   6405>>ASSIGN   6407>>IF       6415>>IF
      6618>>ASSIGN
RC$
      5776**DCL      5777--IMP-PTR  6223<<ASSIGN   6226>>IF       6283>>IF       6285>>IF       6285>>IF
      6288>>ASSIGN   6288>>ASSIGN   6328>>ASSIGN   6328>>ASSIGN   6403<<ASSIGN   6404>>DOWHILE  6405>>ASSIGN
      6405>>ASSIGN   6407>>IF       6407>>IF       6407>>IF       6415>>IF       6415>>IF       6415>>IF
      6421>>ASSIGN   6453>>IF       6469>>IF       6472>>ASSIGN   6495>>IF       6511>>ASSIGN   6599<<ASSIGN
      6599>>ASSIGN   6602<<ASSIGN   6603>>DOWHILE  6604>>IF       6607>>ASSIGN   6618>>ASSIGN   6618>>ASSIGN
      6655<<ASSIGN   6655>>ASSIGN
RC1$
      5808**DCL      5809--IMP-PTR
READSF
        29**DCL-ENT  6107--CALL     6149--CALL     6534--CALL
RS.DEF.OSM
      5926**DCL      6252>>IF       6285>>IF
RS.DEF.TYPE
      5916**DCL      6224>>IF       6475>>IF       6516>>IF       6610>>IF
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:88   
RS.NPOS
      5939**DCL      5948--REDEF
RS.RCRSH
      5937**DCL      6223>>ASSIGN
RS.RCRSN
      5936**DCL      6492>>ASSIGN   6596>>ASSIGN   6614>>ASSIGN
RS.RSCDN
      5933**DCL      6519>>ASSIGN
RS.RSSSN
      5934**DCL      6319>>ASSIGN
RS.SCRSH
      5938**DCL      6474>>ASSIGN   6513>>ASSIGN   6609>>ASSIGN
RS.SCRSN
      5935**DCL      6358>>ASSIGN
RS$
      5913**DCL      5914--IMP-PTR  6219<<ASSIGN   6222>>DOWHILE  6223>>ASSIGN   6224>>IF       6252>>IF
      6285>>IF       6319>>ASSIGN   6358<<ASSIGN   6358>>ASSIGN   6472<<ASSIGN   6473>>DOWHILE  6474>>ASSIGN
      6475>>IF       6492<<ASSIGN   6492>>ASSIGN   6511<<ASSIGN   6512>>DOWHILE  6513>>ASSIGN   6516>>IF
      6519>>ASSIGN   6596<<ASSIGN   6596>>ASSIGN   6607<<ASSIGN   6608>>DOWHILE  6609>>ASSIGN   6610>>IF
      6614<<ASSIGN   6614>>ASSIGN
SC.DEF.SETT
      5751**DCL      6211>>IF       6475>>IF       6516>>IF       6610>>IF
SC.DEF.SNL
      5752**DCL      5757--IMP-SIZ  6217>>ASSIGN   6514>>ASSIGN   6541>>IF
SC.DEF.SNSS
      5746**DCL      6211>>IF       6610>>IF
SC.OASCN
      5754**DCL      6391>>ASSIGN
SC.SCRSN
      5755**DCL      6219>>ASSIGN
SC.SNAM
      5757**DCL      6217>>ASSIGN   6514>>ASSIGN   6541>>IF
SC$
      5739**DCL      5740--IMP-PTR  6209<<ASSIGN   6210>>DOWHILE  6211>>IF       6211>>IF       6217>>ASSIGN
      6217>>ASSIGN   6219>>ASSIGN   6391<<ASSIGN   6391>>ASSIGN   6474<<ASSIGN   6475>>IF       6513<<ASSIGN
      6514>>ASSIGN   6514>>ASSIGN   6516>>IF       6541>>IF       6541>>IF       6609<<ASSIGN   6610>>IF
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:89   
      6610>>IF
SC1$
      5765**DCL      5766--IMP-PTR
SET_FIELDS
       571**DCL-ENT  6121--CALL     6130--CALL     6133--CALL     6137--CALL     6177--CALL     6218--CALL
      6289--CALL     6329--CALL     6406--CALL     6515--CALL     6535--CALL     6539--CALL     6619--CALL
SM
        24**DCL      6221<<ASSIGN   6282<<ASSIGN   6360>>IF
SM1$
      5987**DCL      5988--IMP-PTR
SS.RSCDN
      6002**DCL      6322>>ASSIGN
SS.RSSSN
      6003**DCL      6354>>ASSIGN
SS$
      5995**DCL      5996--IMP-PTR  6319<<ASSIGN   6321>>DOWHILE  6322>>ASSIGN   6354<<ASSIGN   6354>>ASSIGN
SSS$
      5577**DCL      6172>>ASSIGN   6173>>DOWHILE  6204>>ASSIGN   6209>>ASSIGN   6210>>DOWHILE  6219>>ASSIGN
      6222>>DOWHILE  6223>>ASSIGN   6319>>ASSIGN   6321>>DOWHILE  6322>>ASSIGN   6323>>DOWHILE  6324>>ASSIGN
      6352>>ASSIGN   6354>>ASSIGN   6358>>ASSIGN   6391>>ASSIGN   6403>>ASSIGN   6404>>DOWHILE  6421>>ASSIGN
      6422>>DOWHILE  6427>>ASSIGN   6472>>ASSIGN   6473>>DOWHILE  6474>>ASSIGN   6492>>ASSIGN   6511>>ASSIGN
      6512>>DOWHILE  6513>>ASSIGN   6519>>ASSIGN   6520>>DOWHILE  6523>>ASSIGN   6526>>ASSIGN   6593>>ASSIGN
      6596>>ASSIGN   6599>>ASSIGN   6602>>ASSIGN   6603>>DOWHILE  6607>>ASSIGN   6608>>DOWHILE  6609>>ASSIGN
      6614>>ASSIGN   6655>>ASSIGN
SUBLST
       585**DCL-ENT  6101--CALL
SUBSCHEMA_KEY
       603**DCL       604--REDEF
SUB_LANGUAGE
      3880**DCL      6091>>CALL     6099>>CALLBLT  6142>>CALL     6409>>CALL
TEMP_WORD
        26**DCL      6176<<ASSIGN   6177<>CALL     6217<<ASSIGN   6218<>CALL     6288<<ASSIGN   6289<>CALL
      6328<<ASSIGN   6329<>CALL     6405<<ASSIGN   6406<>CALL     6514<<ASSIGN   6515<>CALL     6538<<ASSIGN
      6539<>CALL     6618<<ASSIGN   6619<>CALL
TYPE_100.TYPE
      4241**DCL      6109>>DOCASE
PL6.E3A0      #001=ZIG$V_PROHIB File=ZIG$V_PROHIB.:ZIC0TSI                       FRI 09/05/97 12:23 Page:90   
TYPE_200.SUB_AREA_NAME
      4354**DCL      6121<>CALL
TYPE_300.INFO
      4458**DCL      4459--REDEF
TYPE_400.INFO
      4565**DCL      4566--REDEF
TYPE_430.EIS.ADDER
      4754**DCL      4755--REDEF    4756--REDEF
TYPE_430.EIS.EIS_BITS
      4759**DCL      4760--REDEF    4764--REDEF    4792--REDEF
TYPE_430.FLAGS.TYPE
      4803**DCL      6131>>IF       6135>>IF       6139>>IF       6139>>IF
TYPE_430.INFO
      4801**DCL      4802--REDEF
TYPE_430.SUB_FIELD_NAME
      4741**DCL      6130<>CALL     6535<>CALL
UWA.AC.CALC_NEXT
      1756**DCL      1757--REDEF
UWA.AC.CALC_PRIOR
      1765**DCL      1766--REDEF
UWA.AC.DEFAULTS
      1717**DCL      1718--REDEF
UWA.AC.FILE_CODE
      1722**DCL      1723--REDEF
UWA.AC.FLAG1.ERROR_TYPE
      1719**DCL      1720--REDEF
WARNING
       569**DCL-ENT  6091--CALL     6651--CALL
WARNING_INT
      6088**PROC     6142--CALL     6178--CALL     6228--CALL     6254--CALL     6290--CALL     6330--CALL
      6362--CALL     6409--CALL     6431--CALL     6455--CALL     6478--CALL     6497--CALL     6545--CALL
      6569--CALL     6622--CALL
