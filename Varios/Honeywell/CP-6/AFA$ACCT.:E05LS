VERSION E05

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:1    
        1        1        /*M* AFA$ACCT Monitor procedure used to implement the M$ACCT pmme            */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8        /*F* NAME: AFA$ACCT
        9        9             PURPOSE: To perform accounting statistics gathering for CP_6
       10       10             DESCRIPTION: This module contains the AFA$ACCT external procedure
       11       11             which is used to implement the M$ACCT monitor service. This service
       12       12             gathers accounting statistics on a user. It is designed to be used
       13       13             by Recovery at recovery, by command processors at Jobend, and by
       14       14             the monitor at step start and stop (if step accounting is on) and
       15       15             at proprietary accounting period start and stop (if running a
       16       16             proprietarily charged processor). It writes these accounting
       17       17             records into the user's *S file when requested, however, this
       18       18             should not be requested on jobend or recovery.
       19       19        */
       20       20        AFA$ACCT: PROC;
       21       21        /*D* NAME: AFA$ACCT
       22       22             PURPOSE: To implement the M$ACCT pmme
       23       23             CALL: CALL M$ACCT(FPT_ACCT) ALTRET(LABEL);  ...for CP's and Recovery
       24       24                   CALL M$MACCT(FPT_ACCT) ALTRET(LABEL); ...for the monitor
       25       25             DESCRIPTION: This procedure implements the M$ACCT pmme for use by
       26       26             Recovery, CP's at Jobend, and the monitor. It collects accounting
       27       27             statistics on the user and 1) writes this record to the user's *S
       28       28             file, or 2) writes this record to a user-specified buffer.
       29       29        */
       30       30        %INCLUDE AZ_MACRO_C;
       31     2617        %INCLUDE AZ_SUBS_C;
       32     2686        %INCLUDE B_ERRORS_C;
       33     3813        %INCLUDE B_PTRS_R;
       34     3821        %INCLUDE B_STRINGS_C;
       35     3950        %INCLUDE B$JIT_C;
       36     4264        %INCLUDE CP_6;
       37     9823        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:2    
       38    10363        %INCLUDE CP_MACROS_C;
       39    11115        %INCLUDE FR_SUBS;
       40    11183        %INCLUDE JS$CP6V_C;
       41    11246        %INCLUDE M_INFO_C;
       42    11386        %INCLUDE XUD_UTS_M;
       43    11468        %XUD$UTS_ENTRIES;
       44    11500        %XUD_UTS_EQU;
       45    11511        %SUB V_PS#     = 0;
       46    11512        %SUB BUF_PS#   = 1;
       47    11513        %SUB LEN_PS#   = 2;
       48    11514        %SUB PNAME_PS# = 3;
       49    11515        %SUB JIT_PS#   = 4;
       50    11516        %B$JIT0(STCLASS="BASED(JIT$)");
       51    11605        %U$JIT1;
       52    11679        %M$JIT2;
       53    11689        %F$JIT3;
       54    11694        %S$JIT4;
       55    11700        %J$JIT5;
       56    11788        %A$JIT6;
       57    11798        %B$TCB;
       58    11801        %B$ALT;
       59    11809        %FPT_JOBSTATS(FPTN = FPT_JOBSTATSC,STCLASS = CONSTANT,
       60    11810                      ORDER = SRCH,
       61    11811                      OUTPUT = NO);
       62    11831        %FPT_JOBSTATS(FPTN=FPT_JOBSTATS,STCLASS="BASED(FPT$)");
       63    11851        %VLP_CRITERIA(FPTN = VLP_CRITERIAC,STCLASS = CONSTANT);
       64    11879        %SUDO$TIME(NAME = SUDO_TIME,STCLASS = "BASED(VLP$)");
       65    11925        %FPT_PRECORD(FPTN = FPT_PRECORDC,STCLASS = CONSTANT,KEYS=YES);
       66    11946        %FPT_PRECORD(FPTN=FPT$PRECORD,STCLASS="BASED(FPT$)");
       67    11967        %FPT_READ(FPTN = FPT_READC,STCLASS = CONSTANT);
       68    12006        %FPT_READ(FPTN = FPT$READ,STCLASS="BASED(FPT$)");
       69    12045        %FPT_WRITE(FPTN = FPT_WRITEC,STCLASS = CONSTANT);
       70    12076        %FPT_WRITE(FPTN = FPT$WRITE,STCLASS="BASED(FPT$)");
       71    12107    1   DCL 1 IN_KEY,
       72    12108    1         2 LEN UBIN BYTE UNAL,
       73    12109    1         2 KEY CHAR(31),
       74    12110    1         2 FORM_KEY REDEF KEY,
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:3    
       75    12111    1           3 TYPE CHAR(1),
       76    12112    1           3 STEP UBIN(18) UNAL,
       77    12113    1           3 * CHAR(28);
       78    12114        %VLP_NAME(FPTN = ATITLE_KEY,
       79    12115                NAME   = 'ATITLE',
       80    12116                STCLASS= CONSTANT);
       81    12143        %VLP_NAME(FPTN = LIMIT_KEY,
       82    12144                NAME   = 'LIMIT',
       83    12145                STCLASS = CONSTANT);
       84    12172        %SUDO_KEY(NAME = SUDO_KEY,
       85    12173                STCLASS= CONSTANT);
       86    12187        %RES_KEY(NAME = RES_KEY,
       87    12188                STCLASS = CONSTANT);
       88    12219        %FORM_KEY(NAME = FORM_KEY,
       89    12220                STCLASS= CONSTANT);
       90    12255    1   DCL TYP UBIN WORD;
       91    12256    1   DCL STARS_DA UBIN WORD;
       92    12257    1   DCL RECLEN UBIN WORD;                   /* Character length of the JSP record */
       93    12258                                                /* being built.                       */
       94    12259    1   DCL TEMP UBIN WORD;
       95    12260    1   DCL CUR_CPU UBIN WORD;
       96    12261    1   DCL FPT$ PTR;
       97    12262    1   DCL VLP$ PTR;
       98    12263    1   DCL CUR_UTS UBIN WORD;
       99    12264    1   DCL JIT$ PTR;
      100    12265        %ACCT_KEY(NAME = ACCT_KEY,STCLASS =);
      101    12325    1   DCL B$SBUF2$ PTR SYMREF;
      102    12326    1   DCL B$JIT$ PTR SYMREF;
      103    12327    1   DCL UBIN$WORD UBIN WORD BASED;
      104    12328    1   DCL OUT$BUF CHAR(RECLEN) BASED(B$SBUF2$);
      105    12329    1   DCL DTIME SBIN AUTO;
      106    12330    1   DCL 1 TEXT$C BASED,
      107    12331    1         2 L UBIN BYTE UNAL,
      108    12332    1         2 C CHAR(TEXT$C.L);
      109    12333        %FPT$ACCT_V(FPTN = FPT$ACCT_V);
      110    12336        %JSP(NAME = JSP,STCLASS="BASED(B$SBUF2$)");
      111    12886        %VLP_ERRCODE(FPTN = LD_ERR,STCLASS = CONSTANT,
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:4    
      112    12887                     FCG = '0106'O,
      113    12888                     MID = '01'O,
      114    12889                     MON = '1'B,
      115    12890                     ERR#= %E$LD,
      116    12891                     SEV = 2);
      117    12936        %VLP_ERRCODE(FPTN = DOMAIN_ERR,STCLASS = CONSTANT,
      118    12937                     FCG = '0106'O,
      119    12938                     MID = '01'O,
      120    12939                     MON = '1'B,
      121    12940                     ERR#=%E$DOMAIN,
      122    12941                     SEV = 2);
      123    12986    1   DCL HFF$DSIZ ENTRY(2);
      124    12987    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      125    12988    1   DCL FGH$UPDBUCKET ENTRY(4);
      126    12989    1   DCL FMO$GETDOMAIN ENTRY(1);
      127    12990    1   DCL FRS$OPSTRS ENTRY;                   /* OPEN *S file                       */
      128    12991    1   DCL FRS$CLSTRS ENTRY;                   /* CLOSE *S file                      */
      129    12992    1   DCL MME$WFVP ENTRY(4) ALTRET;
      130    12993    1   DCL MME$WGVP ENTRY(4) ALTRET;
      131    12994    1   DCL M$MJOBSTATS ENTRY(1) ALTRET;
      132    12995    1   DCL M$MPRECORD ENTRY(1) ALTRET;
      133    12996    1   DCL M$MREAD ENTRY(1) ALTRET;
      134    12997    1   DCL M$MWRITE ENTRY(1) ALTRET;
      135    12998    1   DCL SSS$CURTIME ENTRY(1);
      136    12999        /*****************************************************************************/
      137    13000        /*             CODE STARTS HERE                                              */
      138    13001        /*****************************************************************************/
      139    13002        /**/
      140    13003        /* Miscellaneous set up                                                      */
      141    13004        /**/
      142    13005    1      FPT$ = PINCRW(B$SBUF2$,1024-SIZEW(FPT_JOBSTATS));
             13005               /* This FPT's area is used for all */
      143    13006                                                /* other FPTs also                    */
      144    13007    1      VLP$ = PINCRW(FPT$,-SIZEW(SUDO_TIME));
      145    13008    1      TYP = B$PS$(V_PS#)->FPT$ACCT_V.TYP;
      146    13009        /**/
      147    13010        /* Check for legal call                                                      */
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:5    
      148    13011        /**/
      149    13012    1      CALL FMO$GETDOMAIN(TEMP);
      150    13013    1      IF NOT (B$JIT$->B$JIT.USER=1         /* Recovery - GHOST1                  */
      151    13014    1        OR TEMP=%MONWSR
      152    13015    1        OR NOT B$PS$(V_PS#) -> FPT$ACCT_V.STAROUT
      153    13016    1        OR (TEMP=%CPWSR AND TYP=%JOBEND#))
      154    13017    2      THEN DO;
      155    13018    2           B$JIT$->B$JIT.ERR = DOMAIN_ERR;
      156    13019        /*E* ERROR: AFA-E$DOMAIN-2
      157    13020           MESSAGE: You may not use that form of M$ACCT from your domain
      158    13021        */
      159    13022    2           RETURN;
      160    13023    2           END;
      161    13024        /**/
      162    13025        /* Get a buffer to build JSP record into                                     */
      163    13026        /**/
      164    13027    1      CALL MME$WGVP(%USERWSQ,%SBUF2PG,BITBIN(%PGINMEM|%PGWRITE|%PGIOM),
      165    13028    1        TEMP) ALTRET(NO_PAGE);
      166    13029    2      DO WHILE('0'B);
      167    13030    2   NO_PAGE: B$JIT$->B$JIT.ERR = LD_ERR;    /*Any skeleton*/
      168    13031    2           B$JIT$->B$JIT.ERR.CODE = TEMP;
      169    13032    2           RETURN;
      170    13033    2           END;
      171    13034        /**/
      172    13035        /* Set up JIT$, CUR_UTS and *S disk address for Recovery or normal mode      */
      173    13036        /**/
      174    13037    1      IF TYP=%RCVRY#
      175    13038    2      THEN DO;
      176    13039    2           CUR_UTS = B$PS$(V_PS#)->FPT$ACCT_V.UTS;
      177    13040    2           JIT$ = B$PS$(JIT_PS#);          /* Use passed JIT                     */
      178    13041    2           STARS_DA = B$JIT$->B$JIT.STAR.DA(4);
      179    13042                                                /* Save the real *S disk address      */
      180    13043    2           B$JIT$->B$JIT.STAR.DA(4) = JIT$->B$JIT.STAR.DA(4);
      181    13044                                                /* Place the disk address of the *S   */
      182    13045                                                /* file to gather statistics from     */
      183    13046    2           END;
      184    13047    2      ELSE DO;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:6    
      185    13048    2           CALL SSS$CURTIME(CUR_UTS);      /* Get the current UTS                */
      186    13049    2           JIT$ = B$JIT$;                  /* Use caller's JIT                   */
      187    13050    2           END;
      188    13051        /**/
      189    13052        /* OPEN *S file                                                            */
      190    13053        /**/
      191    13054    1      CALL FRS$OPSTRS;
      192    13055        /**/
      193    13056        /* Fill the JSP record  */
      194    13057        /**/
      195    13058    1      CALL FILL_REC ALTRET(JUSTRET);
      196    13059        /**/
      197    13060        /* Return the JSP record to the user or write it to the *S file              */
      198    13061        /**/
      199    13062    1      IF B$PS$(V_PS#)->FPT$ACCT_V.STAROUT
      200    13063    2      THEN DO;                             /* Write it to *S                     */
      201    13064    2           IF TYP=%PSTART#
      202    13065    2           THEN B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STARPROC#;
      203    13066                                                /* Set the bit saying that there are  */
      204    13067                                                /* proprietary accounting records in  */
      205    13068                                                /* the *S file                        */
      206    13069    2           ACCT_KEY.L = SIZEC(ACCT_KEY)-1;
      207    13070    2           ACCT_KEY.ACCT# = 'a';
      208    13071    2           ACCT_KEY.STEP# = JSP.STEP;
      209    13072    3           DO CASE(TYP);
      210    13073    3            CASE(%PSTART#,%PSTOP#);
      211    13074    3              ACCT_KEY.PROC# = B$JIT.CURPNUM;
      212    13075    3            CASE(%SSTART#,%SSTOP#);
      213    13076    3              ACCT_KEY.PROC# = 510;
      214    13077    3            CASE(%JOBEND#,%RCVRY#);
      215    13078    3              ACCT_KEY.PROC# = 511;
      216    13079    3              END;
      217    13080    2           ACCT_KEY.UTS# = CUR_UTS;
      218    13081    2           ACCT_KEY.TYPE# = TYP;
      219    13082    2           FPT$WRITE = FPT_WRITEC;
      220    13083    2           FPT$WRITE.V_ = VECTOR(FPT$WRITE.V);
      221    13084    2           FPT$WRITE.KEY_ = VECTOR(ACCT_KEY);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:7    
      222    13085    2           FPT$WRITE.V.DCB# = %M$STAR#;
      223    13086    2           FPT$WRITE.BUF_ = VECTOR(OUT$BUF);
      224    13087    2           CALL M$MWRITE(FPT$WRITE) ALTRET(JUSTRET);
      225    13088    2           END;
      226    13089    2      ELSE DO;                             /* Place it into the caller's BUF     */
      227    13090    2           CALL HFF$NILERASE (LEN_PS#)
      228    13091    3           WHENRETURN DO;
      229    13092    3                B$PS$(LEN_PS#)->UBIN$WORD = RECLEN;
      230    13093    3                END;
      231    13094    2           CALL HFF$DSIZ(BUF_PS#,TEMP);
      232    13095    2           IF RECLEN>TEMP
      233    13096    3           THEN DO;                        /* BUF not large enough               */
      234    13097    3                B$JIT$->B$JIT.ERR = LD_ERR;
      235    13098    3                GOTO JUSTRET;              /* To do some final cleanup           */
      236    13099    3                END;
      237    13100    2           B$PS$(BUF_PS#)->OUT$BUF = OUT$BUF;
      238    13101    2           END;
      239    13102        /**/
      240    13103        /* Clean up and return                                                       */
      241    13104        /**/
      242    13105    1   JUSTRET: CALL FRS$CLSTRS;               /* CLOSE *S file                      */
      243    13106    1      IF TYP=%RCVRY#
      244    13107    1      THEN B$JIT$->B$JIT.STAR.DA(4) = STARS_DA;
      245    13108    1      CALL MME$WFVP(%USERWSQ,%SBUF2PG,TEMP,TEMP);
      246    13109    1      RETURN;
      247    13110        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:8    
      248    13111    1   FILL_REC: PROC ALTRET;
      249    13112        /*I* NAME: GET_FILL_REC
      250    13113             PURPOSE: To build the JSP record
      251    13114        */
      252    13115    2      RECLEN = SIZEC(JSP);
      253    13116    2      JSP = '0'B;                          /* Clear out the record first         */
      254    13117    2      JSP.PEXEC = B$JIT.TPEXT + ((B$JIT.XTIME+B$JIT.EXTUS)/10000);
      255    13118    2      JSP.UEXEC = B$JIT.TUEXT;
      256    13119    2      JSP.PSTIME = B$JIT.TPSVT + ((B$JIT.STIME+B$JIT.SVTUS)/10000);
      257    13120    2      JSP.USTIME = B$JIT.TUSVT;
      258    13121    2      CUR_CPU = JSP.PEXEC + JSP.UEXEC + JSP.PSTIME + JSP.USTIME;
      259    13122    2      JSP.CUR_UTS = CUR_UTS;
      260    13123    2      JSP.PMEMTIM = B$JIT.PMEMTIM;
      261    13124    2      JSP.UMEMTIM = B$JIT.UMEMTIM;
      262    13125    2      CALL XUD$UTS_DIFF (TEMP, CUR_UTS, B$JIT.TMPGAC.TIME);
      263    13126    2      CALL FGH$UPDBUCKET(JSP.UFTPS,B$JIT.TMPGAC.N,TEMP,B$JIT.CURTMPDP);
      264    13127    2      JSP.MTACCESS = B$JIT.ACCESS.TAPES;
      265    13128    2      JSP.DPACCESS = B$JIT.ACCESS.PACKS;
      266    13129    2      JSP.ORACCESS = B$JIT.ACCESS.FORMS;
      267    13130    2      JSP.MTMOUNT = B$JIT.MOUNTS(1);
      268    13131    2      JSP.DPMOUNT = B$JIT.MOUNTS(0);
      269    13132    2      JSP.ORMOUNT = B$JIT.MOUNTS(2);
      270    13133    2      JSP.TINTER = B$JIT.INTER;
      271    13134    2      JSP.PMMES = B$JIT.CALCNT;
      272    13135    2      JSP.CODE = %AZ$JSP;
      273    13136    2      JSP.ACCT = B$JIT.ACCN;
      274    13137    2      JSP.USERNAME = B$JIT.UNAME;
      275    13138    2      JSP.WOO = B$JIT.WOO;
      276    13139    2      JSP.MODE = B$JIT.MODE;
      277    13140    2      JSP.SYSID = B$JIT.SYSID;
      278    13141    2      JSP.STEP = B$JIT.STEPS;
      279    13142    2      JSP.JORG = B$JIT.JORG;
      280    13143    2      JSP.STEPCC = B$JIT.STEPCC;
      281    13144    2      JSP.RNST = B$JIT.USRRNST;
      282    13145    2      IF B$JIT.USRRNST & %RS_LIMX#
      283    13146    2      THEN
      284    13147    2           JSP.XLIMFLG = B$JIT.XLIMFLG;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:9    
      285    13148    2      JSP.TSLINE = B$JIT.TSLINE;
      286    13149    2      JSP.ORIGINATOR_MODE = B$JIT.ORIGINATOR_MODE;
      287    13150    2      JSP.JOBNAME.C = B$JIT.JOBNAME;
      288    13151    2      CALL INDEX(TEMP,' ',JSP.JOBNAME.C);
      289    13152    2      JSP.JOBNAME.L = TEMP;
      290    13153        /**/
      291    13154        /* JSP.TYPE                                                                  */
      292    13155        /**/
      293    13156    3      DO CASE(TYP);
      294    13157    3       CASE(%RCVRY#);
      295    13158    3         JSP.TYPE = %AZ$RECOVERY;
      296    13159    3       CASE(%JOBEND#);
      297    13160    3         JSP.TYPE = %AZ$JOBEND;
      298    13161    3       CASE(%PSTART#,%PSTOP#);
      299    13162    3         JSP.TYPE = %AZ$PROC;
      300    13163    3       CASE(%SSTART#,%SSTOP#);
      301    13164    3         JSP.TYPE = %AZ$STEP;
      302    13165    3         END;
      303    13166        /**/
      304    13167        /* JSP.ATITLE                                                                */
      305    13168        /**/
      306    13169    2      JSP.ATITLE = ' ';                    /* Blank fill                         */
      307    13170    2      FPT$READ = FPT_READC;
      308    13171    2      FPT$READ.V_ = VECTOR(FPT$READ.V);
      309    13172    2      FPT$READ.V.DCB# = %M$STAR#;
      310    13173    2      FPT$READ.KEY_ = VECTOR(IN_KEY);
      311    13174    2      FPT$READ.V.KEYS# = %YES#;
      312    13175    2      IN_KEY = ATITLE_KEY;
      313    13176    2      FPT$READ.BUF_ = VECTOR(JSP.ATITLE);
      314    13177    2      CALL M$MREAD(FPT$READ) ALTRET(ATITLE_ALT);
      315    13178    3      DO WHILE('0'B);
      316    13179    3   ATITLE_ALT: IF B$JIT$->B$JIT.ERR.CODE~=%E$NOKEY
      317    13180    3           THEN ALTRETURN;                 /* Just return with the error         */
      318    13181    3           ELSE B$JIT$->B$JIT.ERR='0'B;
      319    13182                                                /* Clear the error. It's OK.          */
      320    13183    3           END;
      321    13184        /**/
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:10   
      322    13185        /* JSP.PRDPUSED                                                              */
      323    13186        /**/
      324    13187    2      CALL PRDPUSED ALTRET(JUSTALT);
      325    13188        /**/
      326    13189        /* JSP.JSUNITS, JSP.START, JSP.PKCO, JSP.TMDPPK and JSP.PROCNAME             */
      327    13190        /**/
      328    13191    2      IF TYP=%JOBEND# OR TYP=%RCVRY#
      329    13192    3      THEN DO;
      330    13193    3           JSP.JSUNITS = B$JIT.JOBUNIT;
      331    13194    3           JSP.START = B$JIT.LOGONTIME;
      332    13195    3           JSP.PKCO = B$JIT.JPEAK;
      333    13196    3           JSP.TMDPPK = B$JIT.JTMPDPPK;
      334    13197    3           JSP.RESPEAK = B$JIT.JRESPEAK;
      335    13198    3           END;
      336    13199    3      ELSE DO;
      337    13200    3           JSP.JSUNITS = B$JIT.STEPUNIT;
      338    13201    3           JSP.START = CUR_UTS;
      339    13202    3           IF TYP=%SSTOP#
      340    13203    4           THEN DO;
      341    13204    4                JSP.PKCO = B$JIT.SPEAK;
      342    13205    4                JSP.TMDPPK = B$JIT.STMPDPPK;
      343    13206    4                JSP.RESPEAK = B$JIT.SRESPEAK;
      344    13207    4                END;
      345    13208    3           CALL HFF$NILERASE(%PNAME_PS#) ALTRET(NO_PNAME);
      346    13209    3           JSP.PROCNAME = B$PS$(PNAME_PS#)->TEXT$C;
      347    13210    3   NO_PNAME: END;
      348    13211        /**/
      349    13212        /* JSP.SUBMIT, JSP.FLG, JSP.HOLD_UTS, JSP.PRIO, JSP.PART# and JSP.PART_MASK  */
      350    13213        /**/
      351    13214    2      IF B$JIT.MODE=%M_BATCH#
      352    13215    2      THEN CALL JOBSTATS;
      353    13216    2      ELSE JSP.SUBMIT = B$JIT.LOGONTIME;
      354    13217        /**/
      355    13218        /* JSP.SUDOX                                                                 */
      356    13219        /**/
      357    13220    2      CALL SUDOS ALTRET(JUSTALT);          /* Process pseudo-resource info       */
      358    13221        /**/
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:11   
      359    13222        /* JSP.RESX                                                                  */
      360    13223        /**/
      361    13224    2      CALL RESOURCES ALTRET(JUSTALT);      /* Process resource allocation        */
      362    13225                                                /* time info for this call            */
      363    13226        /**/
      364    13227        /* JSP.FORMX                                                                 */
      365    13228        /**/
      366    13229    2      CALL FORMS ALTRET(JUSTALT);          /* Process forms information          */
      367    13230    2      RETURN;
      368    13231    2   JUSTALT: ALTRETURN;
      369    13232        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:12   
      370    13233    2   PRDPUSED: PROC ALTRET;
      371    13234        %CP_LIMREC(NAME = CP_LIMREC,STCLASS = "BASED(VLP$)");
      372    13272    3      IN_KEY = LIMIT_KEY;
      373    13273    3      FPT$READ.BUF_ = VECTOR(CP_LIMREC);
      374    13274    3      CALL M$MREAD(FPT$READ) ALTRET(LIMREC_ALT);
      375    13275    3      IF CP_LIMREC.STEP_MAX.PRDPRM=0
      376    13276    3      THEN
      377    13277    3           JSP.PRDPUSED = CP_LIMREC.CUMUL.PRDPRM
      378    13278    3             + CP_LIMREC.CUR_MAX.PRDPRM
      379    13279    3             - B$JIT.PRDPRM;
      380    13280    3      ELSE
      381    13281    3           JSP.PRDPUSED = CP_LIMREC.CUMUL.PRDPRM
      382    13282    3             + CP_LIMREC.STEP_MAX.PRDPRM
      383    13283    3             - B$JIT.PRDPRM;
      384    13284    4      DO WHILE('0'B);
      385    13285    4   LIMREC_ALT: IF B$JIT$->B$JIT.ERR.CODE~=%E$NOKEY
      386    13286    4           THEN ALTRETURN;                 /* Report unexpected error            */
      387    13287    4           B$JIT$->B$JIT.ERR = '0'B;       /* Clear the error                    */
      388    13288    4           JSP.PRDPUSED = B$JIT.PRDPRM;
      389    13289    4           END;
      390    13290    3      RETURN;
      391    13291    3   END PRDPUSED;
      392    13292        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:13   
      393    13293    2   JOBSTATS: PROC  ALTRET;
      394    13294        %VLP_CRITERIA(FPTN = VLP_CRITERIA,STCLASS ="BASED(VLP$)");
      395    13322        %VLR_JOBSTATS_ISRCH(FPTN = VLR_JOBSTATS_ISRCH,STCLASS ="BASED(VLR$)");
      396    13336        %VLA_JOBSTATS_ISRCH(FPTN = VLA$JOBSTATS$ISRCH,STCLASS="BASED(VLA$)");
      397    13363    3   DCL VLA$ PTR;
      398    13364    3   DCL VLR$ PTR;
      399    13365    3      VLR$ = PINCRW (VLP$ , -SIZEW (VLR_JOBSTATS_ISRCH));
      400    13366    3      VLP_CRITERIA = VLP_CRITERIAC;
      401    13367    3      VLP_CRITERIA.SYSID# = B$JIT.SYSID;
      402    13368    3      VLP_CRITERIA.SYSID1# = B$JIT.SYSID;
      403    13369    3      FPT_JOBSTATS = FPT_JOBSTATSC;
      404    13370    3      FPT_JOBSTATS.V_ = VECTOR(FPT_JOBSTATS.V);
      405    13371    3      FPT_JOBSTATS.CRITERIA_ = VECTOR(VLP_CRITERIA);
      406    13372    3      FPT_JOBSTATS.RESULTS_ = VECTOR(VLR_JOBSTATS_ISRCH);
      407    13373    3      CALL M$MJOBSTATS(FPT_JOBSTATS) ALTRET(JUSTALT);
      408    13374    3      VLA$ = ADDR(VLR_JOBSTATS_ISRCH.J);
      409    13375    3      JSP.SUBMIT = VLA$JOBSTATS$ISRCH.SUBMIT_TIME;
      410    13376    3      JSP.FLG = VLA$JOBSTATS$ISRCH.FLG;
      411    13377    3      IF VLA$JOBSTATS$ISRCH.FLG.RA
      412    13378    3      THEN JSP.HOLD_UTS = VLA$JOBSTATS$ISRCH.RATIM;
      413    13379    3      JSP.PRIO = VLA$JOBSTATS$ISRCH.IPRIO;
      414    13380    3      JSP.PART# = VLA$JOBSTATS$ISRCH.PNUM;
      415    13381    3      JSP.PART_MASK = VLA$JOBSTATS$ISRCH.PART;
      416    13382    3      RETURN;
      417    13383    3   JUSTALT: ALTRETURN;
      418    13384    3   END JOBSTATS;
      419    13385        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:14   
      420    13386    2   SUDOS: PROC ALTRET;
      421    13387        /*I* NAME: SUDOS
      422    13388             PURPOSE: To process the pseudo-resource information for this call        */
      423    13389        %SUDO(NAME = SUDO,STCLASS="BASED(SUDO$)");
      424    13420    3   DCL SUDO$ PTR;
      425    13421    3   DCL I SBIN;
      426    13422    3      IN_KEY = SUDO_KEY;
      427    13423    3      FPT$READ = FPT_READC;
      428    13424    3      FPT$READ.V_ = VECTOR(FPT$READ.V);
      429    13425    3      FPT$READ.V.DCB# = %M$STAR#;
      430    13426    3      FPT$READ.KEY_ = VECTOR(IN_KEY);
      431    13427    3      FPT$READ.V.KEYS# = %YES#;
      432    13428    3      FPT$READ.BUF_ = VECTOR(SUDO_TIME);
      433    13429    3      CALL M$MREAD(FPT$READ) ALTRET(NO_SUDOS);
      434    13430    3      SUDO$ = PINCRC(B$SBUF2$,RECLEN);
      435    13431    3      IF TYP=%JOBEND# OR TYP=%RCVRY#
      436    13432    4      THEN DO I = 0 TO 7;
      437    13433    4           IF SUDO_TIME.JMAX(I)>0
      438    13434    5           THEN DO;                        /* This pseudo-resource was active    */
      439    13435    5                SUDO.NAM(JSP.SUDO_CNT) = SUDO_TIME.NAM(I);
      440    13436    5                SUDO.MAX(JSP.SUDO_CNT) = SUDO_TIME.JMAX(I);
      441    13437    5                CALL XUD$UTS_DIFF (DTIME, CUR_UTS, SUDO_TIME.CLOCK.LAST(I));
      442    13438    5                SUDO.CLOCK(JSP.SUDO_CNT) = SUDO_TIME.CLOCK.INTEGRAL(I)
      443    13439    5                  + DTIME * SUDO_TIME.ACTIVE(I);
      444    13440    5                SUDO.CPU(JSP.SUDO_CNT) = SUDO_TIME.CPU.INTEGRAL(I)
      445    13441    5                  +(CUR_CPU-SUDO_TIME.CPU.LAST(I))*SUDO_TIME.ACTIVE(I);
      446    13442    5                JSP.SUDO_CNT = JSP.SUDO_CNT+1;
      447    13443    5                END;
      448    13444    4           END;
      449    13445    4      ELSE DO I = 0 TO 7;
      450    13446    4           IF SUDO_TIME.ACTIVE(I)>0
      451    13447    5           THEN DO;                        /* This pseudo-resource will be       */
      452    13448                                                /* active this step or period         */
      453    13449    5                SUDO.NAM(JSP.SUDO_CNT) = SUDO_TIME.NAM(I);
      454    13450    5                SUDO.MAX(JSP.SUDO_CNT) = SUDO_TIME.ACTIVE(I);
      455    13451    5                CALL XUD$UTS_DIFF (DTIME, CUR_UTS, SUDO_TIME.CLOCK.LAST(I));
      456    13452    5                SUDO.CLOCK(JSP.SUDO_CNT) = SUDO_TIME.CLOCK.INTEGRAL(I)
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:15   
      457    13453    5                  + DTIME * SUDO_TIME.ACTIVE(I);
      458    13454    5                SUDO.CPU(JSP.SUDO_CNT) = SUDO_TIME.CPU.INTEGRAL(I)
      459    13455    5                  +(CUR_CPU-SUDO_TIME.CPU.LAST(I))*SUDO_TIME.ACTIVE(I);
      460    13456    5                JSP.SUDO_CNT = JSP.SUDO_CNT+1;
      461    13457    5                END;
      462    13458    4           END;
      463    13459    3      IF JSP.SUDO_CNT~=0
      464    13460    4      THEN DO;
      465    13461    4           JSP.SUDOX = SIZEW(JSP);
      466    13462    4           RECLEN = RECLEN + JSP.SUDO_CNT*SIZEC(SUDO);
      467    13463    4           END;
      468    13464    4      DO WHILE('0'B);
      469    13465    4   NO_SUDOS: IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY
      470    13466    4             OR B$JIT$->B$JIT.ERR.CODE=%E$LD
      471    13467    4           THEN B$JIT$->B$JIT.ERR = '0'B;
      472    13468                                                /* Clear the error. It's OK.          */
      473    13469    4           ELSE ALTRETURN;                 /* ALTRETURN with the error           */
      474    13470    4           END;
      475    13471    3      RETURN;
      476    13472    3   END SUDOS;
      477    13473        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:16   
      478    13474    2   RESOURCES: PROC ALTRET;
      479    13475        /*I* NAME: RESOURCES
      480    13476             PURPOSE: To process resource allocation time records from *S into JSP    */
      481    13477        %RES$TIME(NAME = RES_TIME,STCLASS = "BASED(VLP$)");
      482    13537        %RES(NAME = RES,STCLASS="BASED(RES$)");
      483    13594    3   DCL RES$ PTR;
      484    13595    3   DCL I$ PTR;
      485    13596    3   DCL RES_ID BASED CHAR(24) ALIGNED;
      486    13597    3      IN_KEY = RES_KEY;
      487    13598    3      FPT$PRECORD = FPT_PRECORDC;
      488    13599    3      FPT$PRECORD.V_ = VECTOR(FPT$PRECORD.V);
      489    13600    3      FPT$PRECORD.V.DCB# = %M$STAR#;
      490    13601    3      FPT$PRECORD.KEY_ = VECTOR(IN_KEY);
      491    13602    3      CALL M$MPRECORD(FPT$PRECORD) ALTRET(PREC_ALT);
      492    13603    4      DO WHILE('0'B);
      493    13604    4   PREC_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY
      494    13605    4           THEN B$JIT$->B$JIT.ERR='0'B;
      495    13606                                                /* Clear the error. It's OK.          */
      496    13607    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */
      497    13608    4           END;
      498    13609    3      FPT$READ = FPT_READC;
      499    13610    3      FPT$READ.V_ = VECTOR(FPT$READ.V);
      500    13611    3      FPT$READ.V.DCB# = %M$STAR#;
      501    13612    3      FPT$READ.KEY_ = VECTOR(IN_KEY);
      502    13613    3      FPT$READ.V.KEYR# = %YES#;
      503    13614    3      FPT$READ.BUF_ = VECTOR(RES_TIME);
      504    13615    3      CALL M$MREAD(FPT$READ) ALTRET(RES_ALT);
      505    13616    3      RES$ = PINCRC(B$SBUF2$,RECLEN);
      506    13617    4      DO WHILE(IN_KEY.FORM_KEY.TYPE='r' AND IN_KEY.FORM_KEY.STEP~=262143);
      507    13618                                                /* Process all resource records       */
      508    13619    4           IF RES_TIME.REL.CLOCK>0
      509    13620    4           THEN
      510    13621    5           DO;                             /* Resource has been released         */
      511    13622    5                CALL XUD$UTS_DIFF (RES_TIME.START.CLOCK, RES_TIME.START.CLOCK,
      512    13623    5                  RES_TIME.REL.CLOCK);
      513    13624    5                RES_TIME.START.CPU = RES_TIME.START.CPU
      514    13625    5                  - RES_TIME.REL.CPU;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:17   
      515    13626    5                END;
      516    13627    4           ELSE
      517    13628    5           DO;                             /* Not released yet...use current     */
      518    13629    5                CALL XUD$UTS_DIFF (RES_TIME.START.CLOCK, RES_TIME.START.CLOCK,
      519    13630    5                  CUR_UTS);
      520    13631    5                RES_TIME.START.CPU = RES_TIME.START.CPU - CUR_CPU;
      521    13632    5                END;
      522    13633    4           I$ = PINCRC(B$SBUF2$,RECLEN);
      523    13634    5           DO WHILE I$<RES$;               /* Find any corresponding entry       */
      524    13635    5                IF I$->RES.TYPE(0) = RES_TIME.TYPE
      525    13636    5                  AND ADDR(I$->RES.WSN(0))->RES_ID = ADDR(RES_TIME.WSN)->RES_ID
      526    13637    5                THEN EXIT;
      527    13638    5                I$ = PINCRC(I$,SIZEC(RES));
      528    13639    5                END;
      529    13640    4           IF I$=RES$
      530    13641    5           THEN DO;
      531    13642    5                RES.TYPE(0) = RES_TIME.TYPE;
      532    13643    5                ADDR(RES.WSN(0))->RES_ID = ADDR(RES_TIME.WSN)->RES_ID;
      533    13644    5                RES.CLOCK(0) = 0;
      534    13645    5                RES.CPU(0) = 0;
      535    13646    5                IF PINCRC(RES$,200)>VLP$ THEN EXIT; /* Leave room for some forms */
      536    13647    5                RES$ = PINCRC(RES$,SIZEC(RES));
      537    13648    5                JSP.RES_CNT = JSP.RES_CNT+1;
      538    13649    5                END;
      539    13650    4           IF RES_TIME.START.CLOCK~=0
      540    13651    5           THEN DO;
      541    13652    5                CALL XUD$UTS_DIFF (I$->RES.CLOCK(0), I$->RES.CLOCK(0),
      542    13653    5                  RES_TIME.START.CLOCK);
      543    13654    5                I$->RES.CPU(0) = I$->RES.CPU(0) - RES_TIME.START.CPU;
      544    13655    6                DO CASE(RES_TIME.TYPE);
      545    13656    6                 CASE(FR_DP);
      546    13657    6                   CALL XUD$UTS_DIFF (JSP.DPTIM_CLK, JSP.DPTIM_CLK,
      547    13658    6                     RES_TIME.START.CLOCK);
      548    13659    6                   JSP.DPTIM_CPU = JSP.DPTIM_CPU - RES_TIME.START.CPU;
      549    13660    6                 CASE(FR_MT);
      550    13661    6                   CALL XUD$UTS_DIFF (JSP.MTTIM_CLK, JSP.MTTIM_CLK,
      551    13662    6                     RES_TIME.START.CLOCK);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:18   
      552    13663    6                   JSP.MTTIM_CPU = JSP.MTTIM_CPU - RES_TIME.START.CPU;
      553    13664    6                 CASE(FR_NPOOL);
      554    13665    6                   CALL XUD$UTS_DIFF (JSP.ORTIM_CLK, JSP.ORTIM_CLK,
      555    13666    6                     RES_TIME.START.CLOCK);
      556    13667    6                   JSP.ORTIM_CPU = JSP.ORTIM_CPU - RES_TIME.START.CPU;
      557    13668    6                   END;                    /* CASE                               */
      558    13669    5                END;
      559    13670    4           CALL M$MREAD(FPT$READ) ALTRET(RES_ALT);
      560    13671    4           END;
      561    13672    4      DO WHILE('0'B);
      562    13673    4   RES_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$EOF
      563    13674    4             OR B$JIT$->B$JIT.ERR.CODE=%E$NOFILE
      564    13675    4             OR B$JIT$->B$JIT.ERR.CODE=%E$LD
      565    13676    4           THEN B$JIT$->B$JIT.ERR = '0'B;
      566    13677                                                /* All's well. Clear the error.       */
      567    13678    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */
      568    13679    4           END;
      569    13680    3      IF JSP.RES_CNT>0
      570    13681    4      THEN DO;
      571    13682    4           JSP.RESX = RECLEN/4;
      572    13683    4           RECLEN = RECLEN + JSP.RES_CNT*SIZEC(RES);
      573    13684    4           END;
      574    13685    3      RETURN;
      575    13686    3   END RESOURCES;
      576    13687        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:19   
      577    13688    2   FORMS: PROC ALTRET;
      578    13689        /*I* NAME: FORMS
      579    13690             PURPOSE: To process the forms records from the *S file for this call     */
      580    13691        %FORM$REC(NAME = FORM_REC,STCLASS = "BASED(VLP$)");
      581    13745        %FORM(NAME = FORM1,STCLASS="BASED(FORM1$)");
      582    13791    3   DCL FORM1$ PTR;
      583    13792    3   DCL FRMS  SBIN;
      584    13793    3   DCL I SBIN;
      585    13794    3   DCL J SBIN;
      586    13795    3   DCL FOUND BIT(1) ALIGNED;
      587    13796    3      FORM1$ = PINCRC(B$SBUF2$,RECLEN);
      588    13797    3      IF B$JIT.STDLOPGS ~= 0
      589    13798    4      THEN DO;                             /* Must special case standard         */
      590    13799                                                /* lineprinter form count             */
      591    13800    4           FORM1.FORMS(0) = B$JIT.STDLOPGS;
      592    13801    4           FORM1.MOUNTS(0) = 0;
      593    13802    4           FORM1.S1.FORMNAME(0) = 'STDLP';
      594    13803    4           FORM1.S1.DD(0) = 'LP';
      595    13804    4           FORM1.S1.WSN(0) = B$JIT.WOO;
      596    13805    4           JSP.FORM_CNT = 1;
      597    13806    4           END;
      598    13807    3      IN_KEY = FORM_KEY;
      599    13808    3      IF TYP=%SSTOP# OR TYP=%SSTART# OR TYP=%PSTOP# OR TYP=%PSTART#
      600    13809    3      THEN IN_KEY.FORM_KEY.STEP = B$JIT.STEPS; /* Start at last step             */
      601    13810    3      FPT$PRECORD = FPT_PRECORDC;
      602    13811    3      FPT$PRECORD.V_ = VECTOR(FPT$PRECORD.V);
      603    13812    3      FPT$PRECORD.V.DCB# = %M$STAR#;
      604    13813    3      FPT$PRECORD.KEY_ = VECTOR(IN_KEY);
      605    13814    3      CALL M$MPRECORD(FPT$PRECORD) ALTRET(PREC_ALT);
      606    13815    4      DO WHILE('0'B);
      607    13816    4   PREC_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY
      608    13817    4           THEN B$JIT$->B$JIT.ERR = '0'B;
      609    13818                                                /* Clear the error. All's well.       */
      610    13819    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */
      611    13820    4           END;
      612    13821    3      FPT$READ = FPT_READC;
      613    13822    3      FPT$READ.V_ = VECTOR(FPT$READ.V);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:20   
      614    13823    3      FPT$READ.V.DCB# = %M$STAR#;
      615    13824    3      FPT$READ.KEY_ = VECTOR(IN_KEY);
      616    13825    3      FPT$READ.V.KEYR# = %YES#;
      617    13826    3      FPT$READ.BUF_ = VECTOR(FORM_REC);
      618    13827    3      CALL M$MREAD(FPT$READ) ALTRET(FORM_ALT);
      619    13828    4      DO WHILE(IN_KEY.FORM_KEY.TYPE='f');
      620    13829    4           FOUND = %NO#;
      621    13830    4           I = 0;
      622    13831    5           DO WHILE(NOT FOUND AND I<JSP.FORM_CNT);
      623    13832                                                /* Find corresponding FORM entry      */
      624    13833    5                IF FORM1.S1(I)=FORM_REC.S1
      625    13834    5                THEN FOUND = %YES#;
      626    13835    5                ELSE I=I+1;
      627    13836    5                END;
      628    13837    4           IF NOT FOUND
      629    13838    5           THEN DO;                        /* A new entry                        */
      630    13839    5                FORM1(I) = '0'B;
      631    13840    5                FORM1.S1(I) = FORM_REC.S1;
      632    13841    5                IF ADDR(FORM1(I+1))<=VLP$
      633    13842    5                THEN JSP.FORM_CNT = JSP.FORM_CNT + 1;
      634    13843    5                END;
      635    13844    4           IF FORM_REC.DDEV.LP
      636    13845    4           THEN FRMS = FORM_REC.PAGES;     /* DDEV.LP counts by the page         */
      637    13846    4           ELSE FRMS = FORM_REC.RECS;      /* all others count by the record     */
      638    13847    4           FORM1.FORMS(I) = FORM1.FORMS(I) + FRMS*FORM_REC.COPIES;
      639    13848    4           FORM1.MOUNTS(I) = FORM1.MOUNTS(I) + FORM_REC.MOUNTS;
      640    13849    4           IF FORM1.FORMS(I)=0 AND FORM1.MOUNTS(I)=0
      641    13850    5           THEN DO;                        /* Delete this empty entry            */
      642    13851    6                DO J=I+1 TO JSP.FORM_CNT-1;
      643    13852    6                     FORM1(J-1) = FORM1(J);
      644    13853    6                     END;
      645    13854    5                JSP.FORM_CNT = JSP.FORM_CNT-1;
      646    13855    5                END;
      647    13856    4           CALL M$MREAD(FPT$READ) ALTRET(FORM_ALT);
      648    13857    4           END;
      649    13858    4      DO WHILE('0'B);
      650    13859    4   FORM_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$EOF
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:21   
      651    13860    4             OR B$JIT$->B$JIT.ERR.CODE=%E$LD
      652    13861    4           THEN B$JIT$->B$JIT.ERR = '0'B;
      653    13862                                                /* Clear the error. It's OK.          */
      654    13863    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */
      655    13864    4           END;
      656    13865    3      IF JSP.FORM_CNT>0
      657    13866    4      THEN DO;
      658    13867    4           JSP.FORMX = RECLEN/4;
      659    13868    4           RECLEN = RECLEN + JSP.FORM_CNT*SIZEC(FORM1);
      660    13869    4           END;
      661    13870    3      RETURN;
      662    13871    3   END FORMS;
      663    13872    2   END FILL_REC;
      664    13873    1   END AFA$ACCT;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:22   
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   JS$CP6V_C.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_PTRS_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure AFA$ACCT.

   Procedure AFA$ACCT requires 1247 words for executable code.
   Procedure AFA$ACCT requires 36 words of local(AUTO) storage.

    No errors detected in file AFA$ACCT.:E05TSI    .

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:23   

 Object Unit name= AFA$ACCT                                   File name= AFA$ACCT.:E05TOU
 UTS= JUL 29 '97 08:24:38.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    105    151  AFA$ACCT
    2   Proc  even  none  1247   2337  AFA$ACCT
    3  RoData even  none    20     24  AFA$ACCT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  AFA$ACCT
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:24   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 FMO$GETDOMAIN
 yes     yes           Std       4 MME$WFVP
 yes     yes           Std       4 MME$WGVP
         yes           Std       0 FRS$OPSTRS
 yes     yes           Std       1 M$MWRITE
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       2 HFF$DSIZ
         yes           Std       0 FRS$CLSTRS
         yes           Std       1 SSS$CURTIME
 yes     yes           Std       3 XUD$UTS_DIFF
         yes           Std       4 FGH$UPDBUCKET
 yes     yes           Std       1 M$MREAD
 yes     yes           Std       1 M$MJOBSTATS
 yes     yes           Std       1 M$MPRECORD
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$PS$                                 M$UC                                  B$SBUF2$
     B$JIT$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:25   


        1        1        /*M* AFA$ACCT Monitor procedure used to implement the M$ACCT pmme            */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8        /*F* NAME: AFA$ACCT
        9        9             PURPOSE: To perform accounting statistics gathering for CP_6
       10       10             DESCRIPTION: This module contains the AFA$ACCT external procedure
       11       11             which is used to implement the M$ACCT monitor service. This service
       12       12             gathers accounting statistics on a user. It is designed to be used
       13       13             by Recovery at recovery, by command processors at Jobend, and by
       14       14             the monitor at step start and stop (if step accounting is on) and
       15       15             at proprietary accounting period start and stop (if running a
       16       16             proprietarily charged processor). It writes these accounting
       17       17             records into the user's *S file when requested, however, this
       18       18             should not be requested on jobend or recovery.
       19       19        */
       20       20        AFA$ACCT: PROC;

     20  2 000000   000000 700200 xent  AFA$ACCT     TSX0  ! X66_AUTO_0
         2 000001   000044 000000                    ZERO    36,0

       21       21        /*D* NAME: AFA$ACCT
       22       22             PURPOSE: To implement the M$ACCT pmme
       23       23             CALL: CALL M$ACCT(FPT_ACCT) ALTRET(LABEL);  ...for CP's and Recovery
       24       24                   CALL M$MACCT(FPT_ACCT) ALTRET(LABEL); ...for the monitor
       25       25             DESCRIPTION: This procedure implements the M$ACCT pmme for use by
       26       26             Recovery, CP's at Jobend, and the monitor. It collects accounting
       27       27             statistics on the user and 1) writes this record to the user's *S
       28       28             file, or 2) writes this record to a user-specified buffer.
       29       29        */
       30       30        %INCLUDE AZ_MACRO_C;
       31     2617        %INCLUDE AZ_SUBS_C;
       32     2686        %INCLUDE B_ERRORS_C;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:26   
       33     3813        %INCLUDE B_PTRS_R;
       34     3821        %INCLUDE B_STRINGS_C;
       35     3950        %INCLUDE B$JIT_C;
       36     4264        %INCLUDE CP_6;
       37     9823        %INCLUDE CP_6_SUBS;
       38    10363        %INCLUDE CP_MACROS_C;
       39    11115        %INCLUDE FR_SUBS;
       40    11183        %INCLUDE JS$CP6V_C;
       41    11246        %INCLUDE M_INFO_C;
       42    11386        %INCLUDE XUD_UTS_M;
       43    11468        %XUD$UTS_ENTRIES;
       44    11500        %XUD_UTS_EQU;
       45    11511        %SUB V_PS#     = 0;
       46    11512        %SUB BUF_PS#   = 1;
       47    11513        %SUB LEN_PS#   = 2;
       48    11514        %SUB PNAME_PS# = 3;
       49    11515        %SUB JIT_PS#   = 4;
       50    11516        %B$JIT0(STCLASS="BASED(JIT$)");
       51    11605        %U$JIT1;
       52    11679        %M$JIT2;
       53    11689        %F$JIT3;
       54    11694        %S$JIT4;
       55    11700        %J$JIT5;
       56    11788        %A$JIT6;
       57    11798        %B$TCB;
       58    11801        %B$ALT;
       59    11809        %FPT_JOBSTATS(FPTN = FPT_JOBSTATSC,STCLASS = CONSTANT,
       60    11810                      ORDER = SRCH,
       61    11811                      OUTPUT = NO);
       62    11831        %FPT_JOBSTATS(FPTN=FPT_JOBSTATS,STCLASS="BASED(FPT$)");
       63    11851        %VLP_CRITERIA(FPTN = VLP_CRITERIAC,STCLASS = CONSTANT);
       64    11879        %SUDO$TIME(NAME = SUDO_TIME,STCLASS = "BASED(VLP$)");
       65    11925        %FPT_PRECORD(FPTN = FPT_PRECORDC,STCLASS = CONSTANT,KEYS=YES);
       66    11946        %FPT_PRECORD(FPTN=FPT$PRECORD,STCLASS="BASED(FPT$)");
       67    11967        %FPT_READ(FPTN = FPT_READC,STCLASS = CONSTANT);
       68    12006        %FPT_READ(FPTN = FPT$READ,STCLASS="BASED(FPT$)");
       69    12045        %FPT_WRITE(FPTN = FPT_WRITEC,STCLASS = CONSTANT);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:27   
       70    12076        %FPT_WRITE(FPTN = FPT$WRITE,STCLASS="BASED(FPT$)");
       71    12107    1   DCL 1 IN_KEY,
       72    12108    1         2 LEN UBIN BYTE UNAL,
       73    12109    1         2 KEY CHAR(31),
       74    12110    1         2 FORM_KEY REDEF KEY,
       75    12111    1           3 TYPE CHAR(1),
       76    12112    1           3 STEP UBIN(18) UNAL,
       77    12113    1           3 * CHAR(28);
       78    12114        %VLP_NAME(FPTN = ATITLE_KEY,
       79    12115                NAME   = 'ATITLE',
       80    12116                STCLASS= CONSTANT);
       81    12143        %VLP_NAME(FPTN = LIMIT_KEY,
       82    12144                NAME   = 'LIMIT',
       83    12145                STCLASS = CONSTANT);
       84    12172        %SUDO_KEY(NAME = SUDO_KEY,
       85    12173                STCLASS= CONSTANT);
       86    12187        %RES_KEY(NAME = RES_KEY,
       87    12188                STCLASS = CONSTANT);
       88    12219        %FORM_KEY(NAME = FORM_KEY,
       89    12220                STCLASS= CONSTANT);
       90    12255    1   DCL TYP UBIN WORD;
       91    12256    1   DCL STARS_DA UBIN WORD;
       92    12257    1   DCL RECLEN UBIN WORD;                   /* Character length of the JSP record */
       93    12258                                                /* being built.                       */
       94    12259    1   DCL TEMP UBIN WORD;
       95    12260    1   DCL CUR_CPU UBIN WORD;
       96    12261    1   DCL FPT$ PTR;
       97    12262    1   DCL VLP$ PTR;
       98    12263    1   DCL CUR_UTS UBIN WORD;
       99    12264    1   DCL JIT$ PTR;
      100    12265        %ACCT_KEY(NAME = ACCT_KEY,STCLASS =);
      101    12325    1   DCL B$SBUF2$ PTR SYMREF;
      102    12326    1   DCL B$JIT$ PTR SYMREF;
      103    12327    1   DCL UBIN$WORD UBIN WORD BASED;
      104    12328    1   DCL OUT$BUF CHAR(RECLEN) BASED(B$SBUF2$);
      105    12329    1   DCL DTIME SBIN AUTO;
      106    12330    1   DCL 1 TEXT$C BASED,
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:28   
      107    12331    1         2 L UBIN BYTE UNAL,
      108    12332    1         2 C CHAR(TEXT$C.L);
      109    12333        %FPT$ACCT_V(FPTN = FPT$ACCT_V);
      110    12336        %JSP(NAME = JSP,STCLASS="BASED(B$SBUF2$)");
      111    12886        %VLP_ERRCODE(FPTN = LD_ERR,STCLASS = CONSTANT,
      112    12887                     FCG = '0106'O,
      113    12888                     MID = '01'O,
      114    12889                     MON = '1'B,
      115    12890                     ERR#= %E$LD,
      116    12891                     SEV = 2);
      117    12936        %VLP_ERRCODE(FPTN = DOMAIN_ERR,STCLASS = CONSTANT,
      118    12937                     FCG = '0106'O,
      119    12938                     MID = '01'O,
      120    12939                     MON = '1'B,
      121    12940                     ERR#=%E$DOMAIN,
      122    12941                     SEV = 2);
      123    12986    1   DCL HFF$DSIZ ENTRY(2);
      124    12987    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
      125    12988    1   DCL FGH$UPDBUCKET ENTRY(4);
      126    12989    1   DCL FMO$GETDOMAIN ENTRY(1);
      127    12990    1   DCL FRS$OPSTRS ENTRY;                   /* OPEN *S file                       */
      128    12991    1   DCL FRS$CLSTRS ENTRY;                   /* CLOSE *S file                      */
      129    12992    1   DCL MME$WFVP ENTRY(4) ALTRET;
      130    12993    1   DCL MME$WGVP ENTRY(4) ALTRET;
      131    12994    1   DCL M$MJOBSTATS ENTRY(1) ALTRET;
      132    12995    1   DCL M$MPRECORD ENTRY(1) ALTRET;
      133    12996    1   DCL M$MREAD ENTRY(1) ALTRET;
      134    12997    1   DCL M$MWRITE ENTRY(1) ALTRET;
      135    12998    1   DCL SSS$CURTIME ENTRY(1);
      136    12999        /*****************************************************************************/
      137    13000        /*             CODE STARTS HERE                                              */
      138    13001        /*****************************************************************************/
      139    13002        /**/
      140    13003        /* Miscellaneous set up                                                      */
      141    13004        /**/
      142    13005    1      FPT$ = PINCRW(B$SBUF2$,1024-SIZEW(FPT_JOBSTATS));
             13005               /* This FPT's area is used for all */
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:29   

  13005  2 000002   000000 236000 xsym               LDQ     B$SBUF2$
         2 000003   001734 036003                    ADLQ    988,DU
         2 000004   200020 756100                    STQ     FPT$,,AUTO

      143    13006                                                /* other FPTs also                    */
      144    13007    1      VLP$ = PINCRW(FPT$,-SIZEW(SUDO_TIME));

  13007  2 000005   777700 036003                    ADLQ    -64,DU
         2 000006   200021 756100                    STQ     VLP$,,AUTO

      145    13008    1      TYP = B$PS$(V_PS#)->FPT$ACCT_V.TYP;

  13008  2 000007   000000 470400 xsym               LDP0    B$PS$
         2 000010   000001 236100                    LDQ     1,,PR0
         2 000011   000033 772000                    QRL     27
         2 000012   200013 756100                    STQ     TYP,,AUTO

      146    13009        /**/
      147    13010        /* Check for legal call                                                      */
      148    13011        /**/
      149    13012    1      CALL FMO$GETDOMAIN(TEMP);

  13012  2 000013   200016 631500                    EPPR1   TEMP,,AUTO
         2 000014   200040 451500                    STP1    FOUND+1,,AUTO
         2 000015   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000016   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000017   000000 701000 xent               TSX1    FMO$GETDOMAIN
         2 000020   000000 011000                    NOP     0

      150    13013    1      IF NOT (B$JIT$->B$JIT.USER=1         /* Recovery - GHOST1                  */

  13013  2 000021   000000 470400 xsym               LDP0    B$JIT$
         2 000022   000000 236100                    LDQ     0,,PR0
         2 000023   000777 376003                    ANQ     511,DU
         2 000024   000001 116003                    CMPQ    1,DU
         2 000025   000044 600000 2                  TZE     s:13027
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:30   
         2 000026   200016 235100                    LDA     TEMP,,AUTO
         2 000027   000044 600000 2                  TZE     s:13027
         2 000030   000000 471400 xsym               LDP1    B$PS$
         2 000031   100001 236100                    LDQ     1,,PR1
         2 000032   000400 316003                    CANQ    256,DU
         2 000033   000044 600000 2                  TZE     s:13027
         2 000034   000004 115007                    CMPA    4,DL
         2 000035   000041 601000 2                  TNZ     s:13018
         2 000036   200013 235100                    LDA     TYP,,AUTO
         2 000037   000005 115007                    CMPA    5,DL
         2 000040   000044 600000 2                  TZE     s:13027

      151    13014    1        OR TEMP=%MONWSR
      152    13015    1        OR NOT B$PS$(V_PS#) -> FPT$ACCT_V.STAROUT
      153    13016    1        OR (TEMP=%CPWSR AND TYP=%JOBEND#))
      154    13017    2      THEN DO;

      155    13018    2           B$JIT$->B$JIT.ERR = DOMAIN_ERR;

  13018  2 000041   000145 236000 1                  LDQ     DOMAIN_ERR
         2 000042   000012 756100                    STQ     10,,PR0

      156    13019        /*E* ERROR: AFA-E$DOMAIN-2
      157    13020           MESSAGE: You may not use that form of M$ACCT from your domain
      158    13021        */
      159    13022    2           RETURN;

  13022  2 000043   000000 702200 xent               TSX2  ! X66_ARET

      160    13023    2           END;
      161    13024        /**/
      162    13025        /* Get a buffer to build JSP record into                                     */
      163    13026        /**/
      164    13027    1      CALL MME$WGVP(%USERWSQ,%SBUF2PG,BITBIN(%PGINMEM|%PGWRITE|%PGIOM),

  13027  2 000044   200016 631500                    EPPR1   TEMP,,AUTO
         2 000045   200043 451500                    STP1    FOUND+4,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:31   
         2 000046   000002 236000 3                  LDQ     2
         2 000047   200042 756100                    STQ     FOUND+3,,AUTO
         2 000050   000004 237000 3                  LDAQ    4
         2 000051   200040 757100                    STAQ    FOUND+1,,AUTO
         2 000052   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000053   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000054   000000 701000 xent               TSX1    MME$WGVP
         2 000055   000057 702000 2                  TSX2    NO_PAGE

      165    13028    1        TEMP) ALTRET(NO_PAGE);
      166    13029    2      DO WHILE('0'B);

  13029  2 000056   000070 710000 2                  TRA     s:13037

      167    13030    2   NO_PAGE: B$JIT$->B$JIT.ERR = LD_ERR;    /*Any skeleton*/

  13030  2 000057   000144 236000 1     NO_PAGE      LDQ     LD_ERR
         2 000060   000000 470400 xsym               LDP0    B$JIT$
         2 000061   000012 756100                    STQ     10,,PR0

      168    13031    2           B$JIT$->B$JIT.ERR.CODE = TEMP;

  13031  2 000062   200016 236100                    LDQ     TEMP,,AUTO
         2 000063   000003 736000                    QLS     3
         2 000064   000012 676100                    ERQ     10,,PR0
         2 000065   377770 376007                    ANQ     131064,DL
         2 000066   000012 656100                    ERSQ    10,,PR0

      169    13032    2           RETURN;

  13032  2 000067   000000 702200 xent               TSX2  ! X66_ARET

      170    13033    2           END;

      171    13034        /**/
      172    13035        /* Set up JIT$, CUR_UTS and *S disk address for Recovery or normal mode      */
      173    13036        /**/
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:32   
      174    13037    1      IF TYP=%RCVRY#

  13037  2 000070   200013 235100                    LDA     TYP,,AUTO
         2 000071   000006 115007                    CMPA    6,DL
         2 000072   000107 601000 2                  TNZ     s:13048

      175    13038    2      THEN DO;

      176    13039    2           CUR_UTS = B$PS$(V_PS#)->FPT$ACCT_V.UTS;

  13039  2 000073   000000 470400 xsym               LDP0    B$PS$
         2 000074   000000 235100                    LDA     0,,PR0
         2 000075   200022 755100                    STA     CUR_UTS,,AUTO

      177    13040    2           JIT$ = B$PS$(JIT_PS#);          /* Use passed JIT                     */

  13040  2 000076   000004 236000 xsym               LDQ     B$PS$+4
         2 000077   200023 756100                    STQ     JIT$,,AUTO

      178    13041    2           STARS_DA = B$JIT$->B$JIT.STAR.DA(4);

  13041  2 000100   000000 471400 xsym               LDP1    B$JIT$
         2 000101   100226 235100                    LDA     150,,PR1
         2 000102   200014 755100                    STA     STARS_DA,,AUTO

      179    13042                                                /* Save the real *S disk address      */
      180    13043    2           B$JIT$->B$JIT.STAR.DA(4) = JIT$->B$JIT.STAR.DA(4);

  13043  2 000103   200023 473500                    LDP3    JIT$,,AUTO
         2 000104   300226 235100                    LDA     150,,PR3
         2 000105   100226 755100                    STA     150,,PR1

      181    13044                                                /* Place the disk address of the *S   */
      182    13045                                                /* file to gather statistics from     */
      183    13046    2           END;

  13046  2 000106   000117 710000 2                  TRA     s:13054
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:33   

      184    13047    2      ELSE DO;

      185    13048    2           CALL SSS$CURTIME(CUR_UTS);      /* Get the current UTS                */

  13048  2 000107   200022 630500                    EPPR0   CUR_UTS,,AUTO
         2 000110   200040 450500                    STP0    FOUND+1,,AUTO
         2 000111   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000113   000000 701000 xent               TSX1    SSS$CURTIME
         2 000114   000000 011000                    NOP     0

      186    13049    2           JIT$ = B$JIT$;                  /* Use caller's JIT                   */

  13049  2 000115   000000 236000 xsym               LDQ     B$JIT$
         2 000116   200023 756100                    STQ     JIT$,,AUTO

      187    13050    2           END;

      188    13051        /**/
      189    13052        /* OPEN *S file                                                            */
      190    13053        /**/
      191    13054    1      CALL FRS$OPSTRS;

  13054  2 000117   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000120   000000 701000 xent               TSX1    FRS$OPSTRS
         2 000121   000000 011000                    NOP     0

      192    13055        /**/
      193    13056        /* Fill the JSP record  */
      194    13057        /**/
      195    13058    1      CALL FILL_REC ALTRET(JUSTRET);

  13058  2 000122   000311 701000 2                  TSX1    FILL_REC
         2 000123   000265 702000 2                  TSX2    JUSTRET

      196    13059        /**/
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:34   
      197    13060        /* Return the JSP record to the user or write it to the *S file              */
      198    13061        /**/
      199    13062    1      IF B$PS$(V_PS#)->FPT$ACCT_V.STAROUT

  13062  2 000124   000000 470400 xsym               LDP0    B$PS$
         2 000125   000001 236100                    LDQ     1,,PR0
         2 000126   000400 316003                    CANQ    256,DU
         2 000127   000231 600000 2                  TZE     s:13090

      200    13063    2      THEN DO;                             /* Write it to *S                     */

      201    13064    2           IF TYP=%PSTART#

  13064  2 000130   200013 235100                    LDA     TYP,,AUTO
         2 000131   000001 115007                    CMPA    1,DL
         2 000132   000137 601000 2                  TNZ     s:13069

      202    13065    2           THEN B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STARPROC#;

  13065  2 000133   200023 471500                    LDP1    JIT$,,AUTO
         2 000134   100143 236100                    LDQ     99,,PR1
         2 000135   000017 276000 xsym               ORQ     B_VECTNIL+15
         2 000136   100143 756100                    STQ     99,,PR1

      203    13066                                                /* Set the bit saying that there are  */
      204    13067                                                /* proprietary accounting records in  */
      205    13068                                                /* the *S file                        */
      206    13069    2           ACCT_KEY.L = SIZEC(ACCT_KEY)-1;

  13069  2 000137   011000 236003                    LDQ     4608,DU
         2 000140   200024 552140                    STBQ    ACCT_KEY,'40'O,AUTO

      207    13070    2           ACCT_KEY.ACCT# = 'a';

  13070  2 000141   000141 236003                    LDQ     97,DU
         2 000142   200024 552120                    STBQ    ACCT_KEY,'20'O,AUTO

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:35   
      208    13071    2           ACCT_KEY.STEP# = JSP.STEP;

  13071  2 000143   000000 471400 xsym               LDP1    B$SBUF2$
         2 000144   100056 220100                    LDX0    46,,PR1
         2 000145   200024 440100                    SXL0    ACCT_KEY,,AUTO

      209    13072    3           DO CASE(TYP);

  13072  2 000146   000007 115007                    CMPA    7,DL
         2 000147   000151 602005 2                  TNC     s:13072+3,AL
         2 000150   000172 710000 2                  TRA     s:13080
         2 000151   000172 710000 2                  TRA     s:13080
         2 000152   000160 710000 2                  TRA     s:13074
         2 000153   000160 710000 2                  TRA     s:13074
         2 000154   000165 710000 2                  TRA     s:13076
         2 000155   000165 710000 2                  TRA     s:13076
         2 000156   000170 710000 2                  TRA     s:13078
         2 000157   000170 710000 2                  TRA     s:13078

      210    13073    3            CASE(%PSTART#,%PSTOP#);

      211    13074    3              ACCT_KEY.PROC# = B$JIT.CURPNUM;

  13074  2 000160   200023 473500                    LDP3    JIT$,,AUTO
         2 000161   300320 236100                    LDQ     208,,PR3
         2 000162   000011 736000                    QLS     9
         2 000163   200025 552140                    STBQ    ACCT_KEY+1,'40'O,AUTO
         2 000164   000172 710000 2                  TRA     s:13080

      212    13075    3            CASE(%SSTART#,%SSTOP#);

      213    13076    3              ACCT_KEY.PROC# = 510;

  13076  2 000165   776000 236003                    LDQ     -1024,DU
         2 000166   200025 552140                    STBQ    ACCT_KEY+1,'40'O,AUTO
         2 000167   000172 710000 2                  TRA     s:13080

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:36   
      214    13077    3            CASE(%JOBEND#,%RCVRY#);

      215    13078    3              ACCT_KEY.PROC# = 511;

  13078  2 000170   777000 236003                    LDQ     -512,DU
         2 000171   200025 552140                    STBQ    ACCT_KEY+1,'40'O,AUTO

      216    13079    3              END;

      217    13080    2           ACCT_KEY.UTS# = CUR_UTS;

  13080  2 000172   000100 100500                    MLR     fill='000'O
         2 000173   200022 000004                    ADSC9   CUR_UTS,,AUTO            cn=0,n=4
         2 000174   200025 200004                    ADSC9   ACCT_KEY+1,,AUTO         cn=1,n=4

      218    13081    2           ACCT_KEY.TYPE# = TYP;

  13081  2 000175   200013 236100                    LDQ     TYP,,AUTO
         2 000176   000022 736000                    QLS     18
         2 000177   200026 552120                    STBQ    ACCT_KEY+2,'20'O,AUTO

      219    13082    2           FPT$WRITE = FPT_WRITEC;

  13082  2 000200   200020 473500                    LDP3    FPT$,,AUTO
         2 000201   000100 100400                    MLR     fill='000'O
         2 000202   000120 000060 1                  ADSC9   FPT_WRITEC               cn=0,n=48
         2 000203   300000 000060                    ADSC9   0,,PR3                   cn=0,n=48

      220    13083    2           FPT$WRITE.V_ = VECTOR(FPT$WRITE.V);

  13083  2 000204   000006 235000 3                  LDA     6
         2 000205   200020 236100                    LDQ     FPT$,,AUTO
         2 000206   000010 036003                    ADLQ    8,DU
         2 000207   300000 757100                    STAQ    0,,PR3

      221    13084    2           FPT$WRITE.KEY_ = VECTOR(ACCT_KEY);

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:37   
  13084  2 000210   000007 235000 3                  LDA     7
         2 000211   200040 452500                    STP2    FOUND+1,,AUTO
         2 000212   200040 236100                    LDQ     FOUND+1,,AUTO
         2 000213   000024 036003                    ADLQ    20,DU
         2 000214   300002 757100                    STAQ    2,,PR3

      222    13085    2           FPT$WRITE.V.DCB# = %M$STAR#;

  13085  2 000215   000001 220003                    LDX0    1,DU
         2 000216   300010 740100                    STX0    8,,PR3

      223    13086    2           FPT$WRITE.BUF_ = VECTOR(OUT$BUF);

  13086  2 000217   200015 235100                    LDA     RECLEN,,AUTO
         2 000220   000020 735000                    ALS     16
         2 000221   000140 135007                    SBLA    96,DL
         2 000222   000000 236000 xsym               LDQ     B$SBUF2$
         2 000223   300004 757100                    STAQ    4,,PR3

      224    13087    2           CALL M$MWRITE(FPT$WRITE) ALTRET(JUSTRET);

  13087  2 000224   200020 630500                    EPPR0   FPT$,,AUTO
         2 000225   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000226   000000 701000 xent               TSX1    M$MWRITE
         2 000227   000265 702000 2                  TSX2    JUSTRET

      225    13088    2           END;

  13088  2 000230   000265 710000 2                  TRA     JUSTRET

      226    13089    2      ELSE DO;                             /* Place it into the caller's BUF     */

      227    13090    2           CALL HFF$NILERASE (LEN_PS#)

  13090  2 000231   000010 630400 3                  EPPR0   8
         2 000232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000233   000000 701000 xent               TSX1    HFF$NILERASE
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:38   
         2 000234   000240 702000 2                  TSX2    s:13094

      228    13091    3           WHENRETURN DO;

      229    13092    3                B$PS$(LEN_PS#)->UBIN$WORD = RECLEN;

  13092  2 000235   000002 470400 xsym               LDP0    B$PS$+2
         2 000236   200015 235100                    LDA     RECLEN,,AUTO
         2 000237   000000 755100                    STA     0,,PR0

      230    13093    3                END;

      231    13094    2           CALL HFF$DSIZ(BUF_PS#,TEMP);

  13094  2 000240   200016 630500                    EPPR0   TEMP,,AUTO
         2 000241   200041 450500                    STP0    FOUND+2,,AUTO
         2 000242   000011 236000 3                  LDQ     9
         2 000243   200040 756100                    STQ     FOUND+1,,AUTO
         2 000244   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000245   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000246   000000 701000 xent               TSX1    HFF$DSIZ
         2 000247   000000 011000                    NOP     0

      232    13095    2           IF RECLEN>TEMP

  13095  2 000250   200016 236100                    LDQ     TEMP,,AUTO
         2 000251   200015 116100                    CMPQ    RECLEN,,AUTO
         2 000252   000257 603000 2                  TRC     s:13100

      233    13096    3           THEN DO;                        /* BUF not large enough               */

      234    13097    3                B$JIT$->B$JIT.ERR = LD_ERR;

  13097  2 000253   000144 236000 1                  LDQ     LD_ERR
         2 000254   000000 470400 xsym               LDP0    B$JIT$
         2 000255   000012 756100                    STQ     10,,PR0

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:39   
      235    13098    3                GOTO JUSTRET;              /* To do some final cleanup           */

  13098  2 000256   000265 710000 2                  TRA     JUSTRET

      236    13099    3                END;
      237    13100    2           B$PS$(BUF_PS#)->OUT$BUF = OUT$BUF;

  13100  2 000257   000000 470400 xsym               LDP0    B$SBUF2$
         2 000260   200015 720100                    LXL0    RECLEN,,AUTO
         2 000261   000001 471400 xsym               LDP1    B$PS$+1
         2 000262   040140 100540                    MLR     fill='040'O
         2 000263   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         2 000264   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      238    13101    2           END;

      239    13102        /**/
      240    13103        /* Clean up and return                                                       */
      241    13104        /**/
      242    13105    1   JUSTRET: CALL FRS$CLSTRS;               /* CLOSE *S file                      */

  13105  2 000265   000002 631400 xsym  JUSTRET      EPPR1   B_VECTNIL+2
         2 000266   000000 701000 xent               TSX1    FRS$CLSTRS
         2 000267   000000 011000                    NOP     0

      243    13106    1      IF TYP=%RCVRY#

  13106  2 000270   200013 235100                    LDA     TYP,,AUTO
         2 000271   000006 115007                    CMPA    6,DL
         2 000272   000276 601000 2                  TNZ     s:13108

      244    13107    1      THEN B$JIT$->B$JIT.STAR.DA(4) = STARS_DA;

  13107  2 000273   000000 470400 xsym               LDP0    B$JIT$
         2 000274   200014 236100                    LDQ     STARS_DA,,AUTO
         2 000275   000226 756100                    STQ     150,,PR0

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:40   
      245    13108    1      CALL MME$WFVP(%USERWSQ,%SBUF2PG,TEMP,TEMP);

  13108  2 000276   200016 630500                    EPPR0   TEMP,,AUTO
         2 000277   200043 450500                    STP0    FOUND+4,,AUTO
         2 000300   200016 631500                    EPPR1   TEMP,,AUTO
         2 000301   200042 451500                    STP1    FOUND+3,,AUTO
         2 000302   000004 237000 3                  LDAQ    4
         2 000303   200040 757100                    STAQ    FOUND+1,,AUTO
         2 000304   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000305   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000306   000000 701000 xent               TSX1    MME$WFVP
         2 000307   000000 011000                    NOP     0

      246    13109    1      RETURN;

  13109  2 000310   000000 702200 xent               TSX2  ! X66_ARET

      247    13110        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:41   
      248    13111    1   FILL_REC: PROC ALTRET;

  13111  2 000311   200030 741300       FILL_REC     STX1  ! DTIME+1,,AUTO

      249    13112        /*I* NAME: GET_FILL_REC
      250    13113             PURPOSE: To build the JSP record
      251    13114        */
      252    13115    2      RECLEN = SIZEC(JSP);

  13115  2 000312   000604 235007                    LDA     388,DL
         2 000313   200015 755100                    STA     RECLEN,,AUTO

      253    13116    2      JSP = '0'B;                          /* Clear out the record first         */

  13116  2 000314   000000 470400 xsym               LDP0    B$SBUF2$
         2 000315   000100 100400                    MLR     fill='000'O
         2 000316   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000317   000000 000604                    ADSC9   0,,PR0                   cn=0,n=388

      254    13117    2      JSP.PEXEC = B$JIT.TPEXT + ((B$JIT.XTIME+B$JIT.EXTUS)/10000);

  13117  2 000320   200023 470500                    LDP0    JIT$,,AUTO
         2 000321   000262 236100                    LDQ     178,,PR0
         2 000322   000303 036100                    ADLQ    195,,PR0
         2 000323   023420 506007                    DIV     10000,DL
         2 000324   000270 036100                    ADLQ    184,,PR0
         2 000325   000000 471400 xsym               LDP1    B$SBUF2$
         2 000326   100111 756100                    STQ     73,,PR1

      255    13118    2      JSP.UEXEC = B$JIT.TUEXT;

  13118  2 000327   000273 235100                    LDA     187,,PR0
         2 000330   100112 755100                    STA     74,,PR1

      256    13119    2      JSP.PSTIME = B$JIT.TPSVT + ((B$JIT.STIME+B$JIT.SVTUS)/10000);

  13119  2 000331   000261 236100                    LDQ     177,,PR0
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:42   
         2 000332   000304 036100                    ADLQ    196,,PR0
         2 000333   023420 506007                    DIV     10000,DL
         2 000334   000271 036100                    ADLQ    185,,PR0
         2 000335   100113 756100                    STQ     75,,PR1

      257    13120    2      JSP.USTIME = B$JIT.TUSVT;

  13120  2 000336   000274 235100                    LDA     188,,PR0
         2 000337   100114 755100                    STA     76,,PR1

      258    13121    2      CUR_CPU = JSP.PEXEC + JSP.UEXEC + JSP.PSTIME + JSP.USTIME;

  13121  2 000340   100111 236100                    LDQ     73,,PR1
         2 000341   100112 036100                    ADLQ    74,,PR1
         2 000342   100113 036100                    ADLQ    75,,PR1
         2 000343   100114 036100                    ADLQ    76,,PR1
         2 000344   200017 756100                    STQ     CUR_CPU,,AUTO

      259    13122    2      JSP.CUR_UTS = CUR_UTS;

  13122  2 000345   200022 235100                    LDA     CUR_UTS,,AUTO
         2 000346   100034 755100                    STA     28,,PR1

      260    13123    2      JSP.PMEMTIM = B$JIT.PMEMTIM;

  13123  2 000347   000272 235100                    LDA     186,,PR0
         2 000350   100070 755100                    STA     56,,PR1

      261    13124    2      JSP.UMEMTIM = B$JIT.UMEMTIM;

  13124  2 000351   000275 235100                    LDA     189,,PR0
         2 000352   100071 755100                    STA     57,,PR1

      262    13125    2      CALL XUD$UTS_DIFF (TEMP, CUR_UTS, B$JIT.TMPGAC.TIME);

  13125  2 000353   200023 236100                    LDQ     JIT$,,AUTO
         2 000354   000247 036003                    ADLQ    167,DU
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:43   
         2 000355   200042 756100                    STQ     FOUND+3,,AUTO
         2 000356   200022 633500                    EPPR3   CUR_UTS,,AUTO
         2 000357   200041 453500                    STP3    FOUND+2,,AUTO
         2 000360   200016 634500                    EPPR4   TEMP,,AUTO
         2 000361   200040 454500                    STP4    FOUND+1,,AUTO
         2 000362   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000363   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000364   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 000365   000000 011000                    NOP     0

      263    13126    2      CALL FGH$UPDBUCKET(JSP.UFTPS,B$JIT.TMPGAC.N,TEMP,B$JIT.CURTMPDP);

  13126  2 000366   200023 236100                    LDQ     JIT$,,AUTO
         2 000367   000240 036003                    ADLQ    160,DU
         2 000370   200043 756100                    STQ     FOUND+4,,AUTO
         2 000371   200016 630500                    EPPR0   TEMP,,AUTO
         2 000372   200042 450500                    STP0    FOUND+3,,AUTO
         2 000373   200023 236100                    LDQ     JIT$,,AUTO
         2 000374   000246 036003                    ADLQ    166,DU
         2 000375   200041 756100                    STQ     FOUND+2,,AUTO
         2 000376   000000 236000 xsym               LDQ     B$SBUF2$
         2 000377   000067 036003                    ADLQ    55,DU
         2 000400   200040 756100                    STQ     FOUND+1,,AUTO
         2 000401   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 000402   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000403   000000 701000 xent               TSX1    FGH$UPDBUCKET
         2 000404   000000 011000                    NOP     0

      264    13127    2      JSP.MTACCESS = B$JIT.ACCESS.TAPES;

  13127  2 000405   200023 470500                    LDP0    JIT$,,AUTO
         2 000406   000000 471400 xsym               LDP1    B$SBUF2$
         2 000407   000330 235100                    LDA     216,,PR0
         2 000410   100101 755100                    STA     65,,PR1

      265    13128    2      JSP.DPACCESS = B$JIT.ACCESS.PACKS;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:44   
  13128  2 000411   000327 235100                    LDA     215,,PR0
         2 000412   100102 755100                    STA     66,,PR1

      266    13129    2      JSP.ORACCESS = B$JIT.ACCESS.FORMS;

  13129  2 000413   000331 235100                    LDA     217,,PR0
         2 000414   100103 755100                    STA     67,,PR1

      267    13130    2      JSP.MTMOUNT = B$JIT.MOUNTS(1);

  13130  2 000415   000332 236100                    LDQ     218,,PR0
         2 000416   000022 736000                    QLS     18
         2 000417   000022 732000                    QRS     18
         2 000420   100104 756100                    STQ     68,,PR1

      268    13131    2      JSP.DPMOUNT = B$JIT.MOUNTS(0);

  13131  2 000421   000332 236100                    LDQ     218,,PR0
         2 000422   000022 732000                    QRS     18
         2 000423   100105 756100                    STQ     69,,PR1

      269    13132    2      JSP.ORMOUNT = B$JIT.MOUNTS(2);

  13132  2 000424   000333 236100                    LDQ     219,,PR0
         2 000425   000022 732000                    QRS     18
         2 000426   100106 756100                    STQ     70,,PR1

      270    13133    2      JSP.TINTER = B$JIT.INTER;

  13133  2 000427   000325 236100                    LDQ     213,,PR0
         2 000430   000022 736000                    QLS     18
         2 000431   000022 732000                    QRS     18
         2 000432   100107 756100                    STQ     71,,PR1

      271    13134    2      JSP.PMMES = B$JIT.CALCNT;

  13134  2 000433   000267 235100                    LDA     183,,PR0
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:45   
         2 000434   100110 755100                    STA     72,,PR1

      272    13135    2      JSP.CODE = %AZ$JSP;

  13135  2 000435   001000 236003                    LDQ     512,DU
         2 000436   100000 756100                    STQ     0,,PR1

      273    13136    2      JSP.ACCT = B$JIT.ACCN;

  13136  2 000437   000000 471400 xsym               LDP1    B$SBUF2$
         2 000440   040100 100500                    MLR     fill='040'O
         2 000441   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 000442   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      274    13137    2      JSP.USERNAME = B$JIT.UNAME;

  13137  2 000443   040100 100500                    MLR     fill='040'O
         2 000444   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 000445   100003 000014                    ADSC9   3,,PR1                   cn=0,n=12

      275    13138    2      JSP.WOO = B$JIT.WOO;

  13138  2 000446   000010 237100                    LDAQ    8,,PR0
         2 000447   100016 755100                    STA     14,,PR1
         2 000450   100017 756100                    STQ     15,,PR1

      276    13139    2      JSP.MODE = B$JIT.MODE;

  13139  2 000451   000000 236100                    LDQ     0,,PR0
         2 000452   740000 376003                    ANQ     -16384,DU
         2 000453   000005 772000                    QRL     5
         2 000454   100036 552140                    STBQ    30,'40'O,PR1

      277    13140    2      JSP.SYSID = B$JIT.SYSID;

  13140  2 000455   000000 720100                    LXL0    0,,PR0
         2 000456   100036 440100                    SXL0    30,,PR1
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:46   

      278    13141    2      JSP.STEP = B$JIT.STEPS;

  13141  2 000457   000315 721100                    LXL1    205,,PR0
         2 000460   100056 741100                    STX1    46,,PR1

      279    13142    2      JSP.JORG = B$JIT.JORG;

  13142  2 000461   000145 222100                    LDX2    101,,PR0
         2 000462   100056 442100                    SXL2    46,,PR1

      280    13143    2      JSP.STEPCC = B$JIT.STEPCC;

  13143  2 000463   000316 236100                    LDQ     206,,PR0
         2 000464   000011 736000                    QLS     9
         2 000465   100057 552140                    STBQ    47,'40'O,PR1

      281    13144    2      JSP.RNST = B$JIT.USRRNST;

  13144  2 000466   000145 236100                    LDQ     101,,PR0
         2 000467   000011 736000                    QLS     9
         2 000470   100057 552120                    STBQ    47,'20'O,PR1

      282    13145    2      IF B$JIT.USRRNST & %RS_LIMX#

  13145  2 000471   000145 236100                    LDQ     101,,PR0
         2 000472   000022 736000                    QLS     18
         2 000473   777000 376003                    ANQ     -512,DU
         2 000474   100000 376003                    ANQ     32768,DU
         2 000475   000500 600000 2                  TZE     s:13148

      283    13146    2      THEN
      284    13147    2           JSP.XLIMFLG = B$JIT.XLIMFLG;

  13147  2 000476   000316 236100                    LDQ     206,,PR0
         2 000477   100057 552110                    STBQ    47,'10'O,PR1

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:47   
      285    13148    2      JSP.TSLINE = B$JIT.TSLINE;

  13148  2 000500   000100 100500                    MLR     fill='000'O
         2 000501   000337 000014                    ADSC9   223,,PR0                 cn=0,n=12
         2 000502   100060 000014                    ADSC9   48,,PR1                  cn=0,n=12

      286    13149    2      JSP.ORIGINATOR_MODE = B$JIT.ORIGINATOR_MODE;

  13149  2 000503   000325 236100                    LDQ     213,,PR0
         2 000504   000004 772000                    QRL     4
         2 000505   100054 676100                    ERQ     44,,PR1
         2 000506   740000 376007                    ANQ     -16384,DL
         2 000507   100054 656100                    ERSQ    44,,PR1

      287    13150    2      JSP.JOBNAME.C = B$JIT.JOBNAME;

  13150  2 000510   040100 100500                    MLR     fill='040'O
         2 000511   000156 200037                    ADSC9   110,,PR0                 cn=1,n=31
         2 000512   100006 200037                    ADSC9   6,,PR1                   cn=1,n=31

      288    13151    2      CALL INDEX(TEMP,' ',JSP.JOBNAME.C);

  13151  2 000513   000000 124500                    SCM     mask='000'O
         2 000514   100006 200037                    ADSC9   6,,PR1                   cn=1,n=31
         2 000515   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000516   200016 000100                    ARG     TEMP,,AUTO

      289    13152    2      JSP.JOBNAME.L = TEMP;

  13152  2 000517   200016 236100                    LDQ     TEMP,,AUTO
         2 000520   000033 736000                    QLS     27
         2 000521   100006 552140                    STBQ    6,'40'O,PR1

      290    13153        /**/
      291    13154        /* JSP.TYPE                                                                  */
      292    13155        /**/
      293    13156    3      DO CASE(TYP);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:48   

  13156  2 000522   200013 235100                    LDA     TYP,,AUTO
         2 000523   000007 115007                    CMPA    7,DL
         2 000524   000526 602005 2                  TNC     s:13156+4,AL
         2 000525   000550 710000 2                  TRA     s:13169
         2 000526   000550 710000 2                  TRA     s:13169
         2 000527   000543 710000 2                  TRA     s:13162
         2 000530   000543 710000 2                  TRA     s:13162
         2 000531   000546 710000 2                  TRA     s:13164
         2 000532   000546 710000 2                  TRA     s:13164
         2 000533   000540 710000 2                  TRA     s:13160
         2 000534   000535 710000 2                  TRA     s:13158

      294    13157    3       CASE(%RCVRY#);

      295    13158    3         JSP.TYPE = %AZ$RECOVERY;

  13158  2 000535   000001 236003                    LDQ     1,DU
         2 000536   100036 552120                    STBQ    30,'20'O,PR1
         2 000537   000550 710000 2                  TRA     s:13169

      296    13159    3       CASE(%JOBEND#);

      297    13160    3         JSP.TYPE = %AZ$JOBEND;

  13160  2 000540   000002 236003                    LDQ     2,DU
         2 000541   100036 552120                    STBQ    30,'20'O,PR1
         2 000542   000550 710000 2                  TRA     s:13169

      298    13161    3       CASE(%PSTART#,%PSTOP#);

      299    13162    3         JSP.TYPE = %AZ$PROC;

  13162  2 000543   000005 236003                    LDQ     5,DU
         2 000544   100036 552120                    STBQ    30,'20'O,PR1
         2 000545   000550 710000 2                  TRA     s:13169

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:49   
      300    13163    3       CASE(%SSTART#,%SSTOP#);

      301    13164    3         JSP.TYPE = %AZ$STEP;

  13164  2 000546   000004 236003                    LDQ     4,DU
         2 000547   100036 552120                    STBQ    30,'20'O,PR1

      302    13165    3         END;

      303    13166        /**/
      304    13167        /* JSP.ATITLE                                                                */
      305    13168        /**/
      306    13169    2      JSP.ATITLE = ' ';                    /* Blank fill                         */

  13169  2 000550   040100 100400                    MLR     fill='040'O
         2 000551   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000552   100020 000040                    ADSC9   16,,PR1                  cn=0,n=32

      307    13170    2      FPT$READ = FPT_READC;

  13170  2 000553   200020 473500                    LDP3    FPT$,,AUTO
         2 000554   000100 100400                    MLR     fill='000'O
         2 000555   000102 000070 1                  ADSC9   FPT_READC                cn=0,n=56
         2 000556   300000 000070                    ADSC9   0,,PR3                   cn=0,n=56

      308    13171    2      FPT$READ.V_ = VECTOR(FPT$READ.V);

  13171  2 000557   000012 235000 3                  LDA     10
         2 000560   200020 236100                    LDQ     FPT$,,AUTO
         2 000561   000010 036003                    ADLQ    8,DU
         2 000562   300000 757100                    STAQ    0,,PR3

      309    13172    2      FPT$READ.V.DCB# = %M$STAR#;

  13172  2 000563   000001 220003                    LDX0    1,DU
         2 000564   300010 740100                    STX0    8,,PR3

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:50   
      310    13173    2      FPT$READ.KEY_ = VECTOR(IN_KEY);

  13173  2 000565   000013 235000 3                  LDA     11
         2 000566   200040 452500                    STP2    FOUND+1,,AUTO
         2 000567   200040 236100                    LDQ     FOUND+1,,AUTO
         2 000570   000003 036003                    ADLQ    3,DU
         2 000571   300002 757100                    STAQ    2,,PR3

      311    13174    2      FPT$READ.V.KEYS# = %YES#;

  13174  2 000572   200000 236007                    LDQ     65536,DL
         2 000573   300010 256100                    ORSQ    8,,PR3

      312    13175    2      IN_KEY = ATITLE_KEY;

  13175  2 000574   000100 100400                    MLR     fill='000'O
         2 000575   000134 000007 1                  ADSC9   ATITLE_KEY               cn=0,n=7
         2 000576   200003 000040                    ADSC9   IN_KEY,,AUTO             cn=0,n=32

      313    13176    2      FPT$READ.BUF_ = VECTOR(JSP.ATITLE);

  13176  2 000577   000013 235000 3                  LDA     11
         2 000600   000000 236000 xsym               LDQ     B$SBUF2$
         2 000601   000020 036003                    ADLQ    16,DU
         2 000602   300004 757100                    STAQ    4,,PR3

      314    13177    2      CALL M$MREAD(FPT$READ) ALTRET(ATITLE_ALT);

  13177  2 000603   200020 630500                    EPPR0   FPT$,,AUTO
         2 000604   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000605   000000 701000 xent               TSX1    M$MREAD
         2 000606   000610 702000 2                  TSX2    ATITLE_ALT

      315    13178    3      DO WHILE('0'B);

  13178  2 000607   000620 710000 2                  TRA     s:13187

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:51   
      316    13179    3   ATITLE_ALT: IF B$JIT$->B$JIT.ERR.CODE~=%E$NOKEY

  13179  2 000610   000000 470400 xsym  ATITLE_ALT   LDP0    B$JIT$
         2 000611   000012 236100                    LDQ     10,,PR0
         2 000612   377770 376007                    ANQ     131064,DL
         2 000613   001020 116007                    CMPQ    528,DL
         2 000614   000617 600000 2                  TZE     s:13181

      317    13180    3           THEN ALTRETURN;                 /* Just return with the error         */

  13180  2 000615   200030 221300                    LDX1  ! DTIME+1,,AUTO
         2 000616   000000 702211                    TSX2  ! 0,X1

      318    13181    3           ELSE B$JIT$->B$JIT.ERR='0'B;

  13181  2 000617   000012 450100                    STZ     10,,PR0

      319    13182                                                /* Clear the error. It's OK.          */
      320    13183    3           END;

      321    13184        /**/
      322    13185        /* JSP.PRDPUSED                                                              */
      323    13186        /**/
      324    13187    2      CALL PRDPUSED ALTRET(JUSTALT);

  13187  2 000620   000727 701000 2                  TSX1    PRDPUSED
         2 000621   000725 702000 2                  TSX2    JUSTALT

      325    13188        /**/
      326    13189        /* JSP.JSUNITS, JSP.START, JSP.PKCO, JSP.TMDPPK and JSP.PROCNAME             */
      327    13190        /**/
      328    13191    2      IF TYP=%JOBEND# OR TYP=%RCVRY#

  13191  2 000622   200013 235100                    LDA     TYP,,AUTO
         2 000623   000005 115007                    CMPA    5,DL
         2 000624   000627 600000 2                  TZE     s:13193
         2 000625   000006 115007                    CMPA    6,DL
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:52   
         2 000626   000645 601000 2                  TNZ     s:13200

      329    13192    3      THEN DO;

      330    13193    3           JSP.JSUNITS = B$JIT.JOBUNIT;

  13193  2 000627   200023 470500                    LDP0    JIT$,,AUTO
         2 000630   000000 471400 xsym               LDP1    B$SBUF2$
         2 000631   000100 100500                    MLR     fill='000'O
         2 000632   000137 000010                    ADSC9   95,,PR0                  cn=0,n=8
         2 000633   100115 000010                    ADSC9   77,,PR1                  cn=0,n=8

      331    13194    3           JSP.START = B$JIT.LOGONTIME;

  13194  2 000634   000150 235100                    LDA     104,,PR0
         2 000635   100031 755100                    STA     25,,PR1

      332    13195    3           JSP.PKCO = B$JIT.JPEAK;

  13195  2 000636   000211 720100                    LXL0    137,,PR0
         2 000637   100055 440100                    SXL0    45,,PR1

      333    13196    3           JSP.TMDPPK = B$JIT.JTMPDPPK;

  13196  2 000640   000237 235100                    LDA     159,,PR0
         2 000641   100063 755100                    STA     51,,PR1

      334    13197    3           JSP.RESPEAK = B$JIT.JRESPEAK;

  13197  2 000642   000212 221100                    LDX1    138,,PR0
         2 000643   100055 741100                    STX1    45,,PR1

      335    13198    3           END;

  13198  2 000644   000702 710000 2                  TRA     NO_PNAME

      336    13199    3      ELSE DO;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:53   

      337    13200    3           JSP.JSUNITS = B$JIT.STEPUNIT;

  13200  2 000645   200023 470500                    LDP0    JIT$,,AUTO
         2 000646   000000 471400 xsym               LDP1    B$SBUF2$
         2 000647   000100 100500                    MLR     fill='000'O
         2 000650   000141 000010                    ADSC9   97,,PR0                  cn=0,n=8
         2 000651   100115 000010                    ADSC9   77,,PR1                  cn=0,n=8

      338    13201    3           JSP.START = CUR_UTS;

  13201  2 000652   200022 236100                    LDQ     CUR_UTS,,AUTO
         2 000653   100031 756100                    STQ     25,,PR1

      339    13202    3           IF TYP=%SSTOP#

  13202  2 000654   000004 115007                    CMPA    4,DL
         2 000655   000664 601000 2                  TNZ     s:13208

      340    13203    4           THEN DO;

      341    13204    4                JSP.PKCO = B$JIT.SPEAK;

  13204  2 000656   000211 220100                    LDX0    137,,PR0
         2 000657   100055 440100                    SXL0    45,,PR1

      342    13205    4                JSP.TMDPPK = B$JIT.STMPDPPK;

  13205  2 000660   000236 235100                    LDA     158,,PR0
         2 000661   100063 755100                    STA     51,,PR1

      343    13206    4                JSP.RESPEAK = B$JIT.SRESPEAK;

  13206  2 000662   000213 221100                    LDX1    139,,PR0
         2 000663   100055 741100                    STX1    45,,PR1

      344    13207    4                END;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:54   

      345    13208    3           CALL HFF$NILERASE(%PNAME_PS#) ALTRET(NO_PNAME);

  13208  2 000664   000014 630400 3                  EPPR0   12
         2 000665   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000666   000000 701000 xent               TSX1    HFF$NILERASE
         2 000667   000702 702000 2                  TSX2    NO_PNAME

      346    13209    3           JSP.PROCNAME = B$PS$(PNAME_PS#)->TEXT$C;

  13209  2 000670   000003 470400 xsym               LDP0    B$PS$+3
         2 000671   000100 101500                    MRL     fill='000'O
         2 000672   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000673   200040 000002                    ADSC9   FOUND+1,,AUTO            cn=0,n=2
         2 000674   200040 220100                    LDX0    FOUND+1,,AUTO
         2 000675   000001 621010                    EAX1    1,X0
         2 000676   000000 471400 xsym               LDP1    B$SBUF2$
         2 000677   000100 100540                    MLR     fill='000'O
         2 000700   000000 000011                    ADSC9   0,,PR0                   cn=0,n=*X1
         2 000701   100037 000040                    ADSC9   31,,PR1                  cn=0,n=32

      347    13210    3   NO_PNAME: END;

  13210  2 000702                       NO_PNAME     null
      348    13211        /**/
      349    13212        /* JSP.SUBMIT, JSP.FLG, JSP.HOLD_UTS, JSP.PRIO, JSP.PART# and JSP.PART_MASK  */
      350    13213        /**/
      351    13214    2      IF B$JIT.MODE=%M_BATCH#

  13214  2 000702   200023 470500                    LDP0    JIT$,,AUTO
         2 000703   000000 236100                    LDQ     0,,PR0
         2 000704   740000 376003                    ANQ     -16384,DU
         2 000705   040000 116003                    CMPQ    16384,DU
         2 000706   000712 601000 2                  TNZ     s:13216

      352    13215    2      THEN CALL JOBSTATS;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:55   
  13215  2 000707   001002 701000 2                  TSX1    JOBSTATS
         2 000710   000000 011000                    NOP     0
         2 000711   000715 710000 2                  TRA     s:13220

      353    13216    2      ELSE JSP.SUBMIT = B$JIT.LOGONTIME;

  13216  2 000712   000000 471400 xsym               LDP1    B$SBUF2$
         2 000713   000150 235100                    LDA     104,,PR0
         2 000714   100030 755100                    STA     24,,PR1

      354    13217        /**/
      355    13218        /* JSP.SUDOX                                                                 */
      356    13219        /**/
      357    13220    2      CALL SUDOS ALTRET(JUSTALT);          /* Process pseudo-resource info       */

  13220  2 000715   001101 701000 2                  TSX1    SUDOS
         2 000716   000725 702000 2                  TSX2    JUSTALT

      358    13221        /**/
      359    13222        /* JSP.RESX                                                                  */
      360    13223        /**/
      361    13224    2      CALL RESOURCES ALTRET(JUSTALT);      /* Process resource allocation        */

  13224  2 000717   001424 701000 2                  TSX1    RESOURCES
         2 000720   000725 702000 2                  TSX2    JUSTALT

      362    13225                                                /* time info for this call            */
      363    13226        /**/
      364    13227        /* JSP.FORMX                                                                 */
      365    13228        /**/
      366    13229    2      CALL FORMS ALTRET(JUSTALT);          /* Process forms information          */

  13229  2 000721   002016 701000 2                  TSX1    FORMS
         2 000722   000725 702000 2                  TSX2    JUSTALT

      367    13230    2      RETURN;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:56   
  13230  2 000723   200030 221300                    LDX1  ! DTIME+1,,AUTO
         2 000724   000001 702211                    TSX2  ! 1,X1

      368    13231    2   JUSTALT: ALTRETURN;

  13231  2 000725   200030 221300       JUSTALT      LDX1  ! DTIME+1,,AUTO
         2 000726   000000 702211                    TSX2  ! 0,X1

      369    13232        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:57   
      370    13233    2   PRDPUSED: PROC ALTRET;

  13233  2 000727   200032 741300       PRDPUSED     STX1  ! DTIME+3,,AUTO

      371    13234        %CP_LIMREC(NAME = CP_LIMREC,STCLASS = "BASED(VLP$)");
      372    13272    3      IN_KEY = LIMIT_KEY;

  13272  2 000730   000100 100400                    MLR     fill='000'O
         2 000731   000136 000006 1                  ADSC9   LIMIT_KEY                cn=0,n=6
         2 000732   200003 000040                    ADSC9   IN_KEY,,AUTO             cn=0,n=32

      373    13273    3      FPT$READ.BUF_ = VECTOR(CP_LIMREC);

  13273  2 000733   000015 235000 3                  LDA     13
         2 000734   200021 236100                    LDQ     VLP$,,AUTO
         2 000735   200020 470500                    LDP0    FPT$,,AUTO
         2 000736   000004 757100                    STAQ    4,,PR0

      374    13274    3      CALL M$MREAD(FPT$READ) ALTRET(LIMREC_ALT);

  13274  2 000737   200020 630500                    EPPR0   FPT$,,AUTO
         2 000740   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000741   000000 701000 xent               TSX1    M$MREAD
         2 000742   000764 702000 2                  TSX2    LIMREC_ALT

      375    13275    3      IF CP_LIMREC.STEP_MAX.PRDPRM=0

  13275  2 000743   200021 470500                    LDP0    VLP$,,AUTO
         2 000744   000022 235100                    LDA     18,,PR0
         2 000745   000755 601000 2                  TNZ     s:13281

      376    13276    3      THEN
      377    13277    3           JSP.PRDPUSED = CP_LIMREC.CUMUL.PRDPRM

  13277  2 000746   000031 236100                    LDQ     25,,PR0
         2 000747   000013 036100                    ADLQ    11,,PR0
         2 000750   200023 471500                    LDP1    JIT$,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:58   
         2 000751   100242 136100                    SBLQ    162,,PR1
         2 000752   000000 473400 xsym               LDP3    B$SBUF2$
         2 000753   300064 756100                    STQ     52,,PR3
         2 000754   000763 710000 2                  TRA     s:13284

      378    13278    3             + CP_LIMREC.CUR_MAX.PRDPRM
      379    13279    3             - B$JIT.PRDPRM;
      380    13280    3      ELSE
      381    13281    3           JSP.PRDPUSED = CP_LIMREC.CUMUL.PRDPRM

  13281  2 000755   000031 236100                    LDQ     25,,PR0
         2 000756   000022 036100                    ADLQ    18,,PR0
         2 000757   200023 471500                    LDP1    JIT$,,AUTO
         2 000760   100242 136100                    SBLQ    162,,PR1
         2 000761   000000 473400 xsym               LDP3    B$SBUF2$
         2 000762   300064 756100                    STQ     52,,PR3

      382    13282    3             + CP_LIMREC.STEP_MAX.PRDPRM
      383    13283    3             - B$JIT.PRDPRM;
      384    13284    4      DO WHILE('0'B);

  13284  2 000763   001000 710000 2                  TRA     s:13290

      385    13285    4   LIMREC_ALT: IF B$JIT$->B$JIT.ERR.CODE~=%E$NOKEY

  13285  2 000764   000000 470400 xsym  LIMREC_ALT   LDP0    B$JIT$
         2 000765   000012 236100                    LDQ     10,,PR0
         2 000766   377770 376007                    ANQ     131064,DL
         2 000767   001020 116007                    CMPQ    528,DL
         2 000770   000773 600000 2                  TZE     s:13287

      386    13286    4           THEN ALTRETURN;                 /* Report unexpected error            */

  13286  2 000771   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 000772   000000 702211                    TSX2  ! 0,X1

      387    13287    4           B$JIT$->B$JIT.ERR = '0'B;       /* Clear the error                    */
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:59   

  13287  2 000773   000012 450100                    STZ     10,,PR0

      388    13288    4           JSP.PRDPUSED = B$JIT.PRDPRM;

  13288  2 000774   200023 471500                    LDP1    JIT$,,AUTO
         2 000775   000000 473400 xsym               LDP3    B$SBUF2$
         2 000776   100242 235100                    LDA     162,,PR1
         2 000777   300064 755100                    STA     52,,PR3

      389    13289    4           END;

      390    13290    3      RETURN;

  13290  2 001000   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 001001   000001 702211                    TSX2  ! 1,X1

      391    13291    3   END PRDPUSED;
      392    13292        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:60   
      393    13293    2   JOBSTATS: PROC  ALTRET;

  13293  2 001002   200032 741300       JOBSTATS     STX1  ! DTIME+3,,AUTO

      394    13294        %VLP_CRITERIA(FPTN = VLP_CRITERIA,STCLASS ="BASED(VLP$)");
      395    13322        %VLR_JOBSTATS_ISRCH(FPTN = VLR_JOBSTATS_ISRCH,STCLASS ="BASED(VLR$)");
      396    13336        %VLA_JOBSTATS_ISRCH(FPTN = VLA$JOBSTATS$ISRCH,STCLASS="BASED(VLA$)");
      397    13363    3   DCL VLA$ PTR;
      398    13364    3   DCL VLR$ PTR;
      399    13365    3      VLR$ = PINCRW (VLP$ , -SIZEW (VLR_JOBSTATS_ISRCH));

  13365  2 001003   200021 236100                    LDQ     VLP$,,AUTO
         2 001004   777676 036003                    ADLQ    -66,DU
         2 001005   200034 756100                    STQ     VLR$,,AUTO

      400    13366    3      VLP_CRITERIA = VLP_CRITERIAC;

  13366  2 001006   200021 470500                    LDP0    VLP$,,AUTO
         2 001007   000100 100400                    MLR     fill='000'O
         2 001010   000044 000116 1                  ADSC9   VLP_CRITERIAC            cn=0,n=78
         2 001011   000000 000116                    ADSC9   0,,PR0                   cn=0,n=78

      401    13367    3      VLP_CRITERIA.SYSID# = B$JIT.SYSID;

  13367  2 001012   200023 471500                    LDP1    JIT$,,AUTO
         2 001013   100000 236100                    LDQ     0,,PR1
         2 001014   777777 376007                    ANQ     -1,DL
         2 001015   000006 756100                    STQ     6,,PR0

      402    13368    3      VLP_CRITERIA.SYSID1# = B$JIT.SYSID;

  13368  2 001016   100000 236100                    LDQ     0,,PR1
         2 001017   777777 376007                    ANQ     -1,DL
         2 001020   000007 756100                    STQ     7,,PR0

      403    13369    3      FPT_JOBSTATS = FPT_JOBSTATSC;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:61   
  13369  2 001021   200020 473500                    LDP3    FPT$,,AUTO
         2 001022   000100 100400                    MLR     fill='000'O
         2 001023   000000 000220 1                  ADSC9   FPT_JOBSTATSC            cn=0,n=144
         2 001024   300000 000220                    ADSC9   0,,PR3                   cn=0,n=144

      404    13370    3      FPT_JOBSTATS.V_ = VECTOR(FPT_JOBSTATS.V);

  13370  2 001025   000016 235000 3                  LDA     14
         2 001026   200020 236100                    LDQ     FPT$,,AUTO
         2 001027   000030 036003                    ADLQ    24,DU
         2 001030   300000 757100                    STAQ    0,,PR3

      405    13371    3      FPT_JOBSTATS.CRITERIA_ = VECTOR(VLP_CRITERIA);

  13371  2 001031   000017 235000 3                  LDA     15
         2 001032   200021 236100                    LDQ     VLP$,,AUTO
         2 001033   300006 757100                    STAQ    6,,PR3

      406    13372    3      FPT_JOBSTATS.RESULTS_ = VECTOR(VLR_JOBSTATS_ISRCH);

  13372  2 001034   000020 235000 3                  LDA     16
         2 001035   200034 236100                    LDQ     VLR$,,AUTO
         2 001036   300004 757100                    STAQ    4,,PR3

      407    13373    3      CALL M$MJOBSTATS(FPT_JOBSTATS) ALTRET(JUSTALT);

  13373  2 001037   200020 630500                    EPPR0   FPT$,,AUTO
         2 001040   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001041   000000 701000 xent               TSX1    M$MJOBSTATS
         2 001042   001077 702000 2                  TSX2    JUSTALT

      408    13374    3      VLA$ = ADDR(VLR_JOBSTATS_ISRCH.J);

  13374  2 001043   200034 236100                    LDQ     VLR$,,AUTO
         2 001044   000002 036003                    ADLQ    2,DU
         2 001045   200033 756100                    STQ     VLA$,,AUTO

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:62   
      409    13375    3      JSP.SUBMIT = VLA$JOBSTATS$ISRCH.SUBMIT_TIME;

  13375  2 001046   200033 470500                    LDP0    VLA$,,AUTO
         2 001047   000000 471400 xsym               LDP1    B$SBUF2$
         2 001050   000004 235100                    LDA     4,,PR0
         2 001051   100030 755100                    STA     24,,PR1

      410    13376    3      JSP.FLG = VLA$JOBSTATS$ISRCH.FLG;

  13376  2 001052   000006 236100                    LDQ     6,,PR0
         2 001053   000033 772000                    QRL     27
         2 001054   100057 552104                    STBQ    47,'04'O,PR1

      411    13377    3      IF VLA$JOBSTATS$ISRCH.FLG.RA

  13377  2 001055   000006 236100                    LDQ     6,,PR0
         2 001056   002000 316003                    CANQ    1024,DU
         2 001057   001062 600000 2                  TZE     s:13379

      412    13378    3      THEN JSP.HOLD_UTS = VLA$JOBSTATS$ISRCH.RATIM;

  13378  2 001060   000031 235100                    LDA     25,,PR0
         2 001061   100033 755100                    STA     27,,PR1

      413    13379    3      JSP.PRIO = VLA$JOBSTATS$ISRCH.IPRIO;

  13379  2 001062   000003 236100                    LDQ     3,,PR0
         2 001063   000022 736000                    QLS     18
         2 001064   100035 552140                    STBQ    29,'40'O,PR1

      414    13380    3      JSP.PART# = VLA$JOBSTATS$ISRCH.PNUM;

  13380  2 001065   000003 236100                    LDQ     3,,PR0
         2 001066   000011 772000                    QRL     9
         2 001067   100035 552120                    STBQ    29,'20'O,PR1

      415    13381    3      JSP.PART_MASK = VLA$JOBSTATS$ISRCH.PART;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:63   

  13381  2 001070   000002 236100                    LDQ     2,,PR0
         2 001071   000002 736000                    QLS     2
         2 001072   100035 676100                    ERQ     29,,PR1
         2 001073   777774 376007                    ANQ     -4,DL
         2 001074   100035 656100                    ERSQ    29,,PR1

      416    13382    3      RETURN;

  13382  2 001075   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 001076   000001 702211                    TSX2  ! 1,X1

      417    13383    3   JUSTALT: ALTRETURN;

  13383  2 001077   200032 221300       JUSTALT      LDX1  ! DTIME+3,,AUTO
         2 001100   000000 702211                    TSX2  ! 0,X1

      418    13384    3   END JOBSTATS;
      419    13385        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:64   
      420    13386    2   SUDOS: PROC ALTRET;

  13386  2 001101   200032 741300       SUDOS        STX1  ! DTIME+3,,AUTO

      421    13387        /*I* NAME: SUDOS
      422    13388             PURPOSE: To process the pseudo-resource information for this call        */
      423    13389        %SUDO(NAME = SUDO,STCLASS="BASED(SUDO$)");
      424    13420    3   DCL SUDO$ PTR;
      425    13421    3   DCL I SBIN;
      426    13422    3      IN_KEY = SUDO_KEY;

  13422  2 001102   000100 100400                    MLR     fill='000'O
         2 001103   000140 000004 1                  ADSC9   SUDO_KEY                 cn=0,n=4
         2 001104   200003 000040                    ADSC9   IN_KEY,,AUTO             cn=0,n=32

      427    13423    3      FPT$READ = FPT_READC;

  13423  2 001105   200020 470500                    LDP0    FPT$,,AUTO
         2 001106   000100 100400                    MLR     fill='000'O
         2 001107   000102 000070 1                  ADSC9   FPT_READC                cn=0,n=56
         2 001110   000000 000070                    ADSC9   0,,PR0                   cn=0,n=56

      428    13424    3      FPT$READ.V_ = VECTOR(FPT$READ.V);

  13424  2 001111   000012 235000 3                  LDA     10
         2 001112   200020 236100                    LDQ     FPT$,,AUTO
         2 001113   000010 036003                    ADLQ    8,DU
         2 001114   000000 757100                    STAQ    0,,PR0

      429    13425    3      FPT$READ.V.DCB# = %M$STAR#;

  13425  2 001115   000001 220003                    LDX0    1,DU
         2 001116   000010 740100                    STX0    8,,PR0

      430    13426    3      FPT$READ.KEY_ = VECTOR(IN_KEY);

  13426  2 001117   000013 235000 3                  LDA     11
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:65   
         2 001120   200040 452500                    STP2    FOUND+1,,AUTO
         2 001121   200040 236100                    LDQ     FOUND+1,,AUTO
         2 001122   000003 036003                    ADLQ    3,DU
         2 001123   000002 757100                    STAQ    2,,PR0

      431    13427    3      FPT$READ.V.KEYS# = %YES#;

  13427  2 001124   200000 236007                    LDQ     65536,DL
         2 001125   000010 256100                    ORSQ    8,,PR0

      432    13428    3      FPT$READ.BUF_ = VECTOR(SUDO_TIME);

  13428  2 001126   000021 235000 3                  LDA     17
         2 001127   200021 236100                    LDQ     VLP$,,AUTO
         2 001130   000004 757100                    STAQ    4,,PR0

      433    13429    3      CALL M$MREAD(FPT$READ) ALTRET(NO_SUDOS);

  13429  2 001131   200020 630500                    EPPR0   FPT$,,AUTO
         2 001132   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001133   000000 701000 xent               TSX1    M$MREAD
         2 001134   001407 702000 2                  TSX2    NO_SUDOS

      434    13430    3      SUDO$ = PINCRC(B$SBUF2$,RECLEN);

  13430  2 001135   200015 236100                    LDQ     RECLEN,,AUTO
         2 001136   000020 736000                    QLS     16
         2 001137   000000 036000 xsym               ADLQ    B$SBUF2$
         2 001140   200033 756100                    STQ     SUDO$,,AUTO

      435    13431    3      IF TYP=%JOBEND# OR TYP=%RCVRY#

  13431  2 001141   200013 235100                    LDA     TYP,,AUTO
         2 001142   000005 115007                    CMPA    5,DL
         2 001143   001146 600000 2                  TZE     s:13432
         2 001144   000006 115007                    CMPA    6,DL
         2 001145   001262 601000 2                  TNZ     s:13445
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:66   

      436    13432    4      THEN DO I = 0 TO 7;

  13432  2 001146   200034 450100                    STZ     I,,AUTO

      437    13433    4           IF SUDO_TIME.JMAX(I)>0

  13433  2 001147   200034 235100                    LDA     I,,AUTO
         2 001150   000003 735000                    ALS     3
         2 001151   200021 470500                    LDP0    VLP$,,AUTO
         2 001152   000003 235105                    LDA     3,AL,PR0
         2 001153   001255 600000 2                  TZE     s:13444

      438    13434    5           THEN DO;                        /* This pseudo-resource was active    */

      439    13435    5                SUDO.NAM(JSP.SUDO_CNT) = SUDO_TIME.NAM(I);

  13435  2 001154   000000 471400 xsym               LDP1    B$SBUF2$
         2 001155   100134 236100                    LDQ     92,,PR1
         2 001156   000005 402007                    MPY     5,DL
         2 001157   200034 235100                    LDA     I,,AUTO
         2 001160   000005 735000                    ALS     5
         2 001161   000002 736000                    QLS     2
         2 001162   200033 473500                    LDP3    SUDO$,,AUTO
         2 001163   040106 100505                    MLR     fill='040'O
         2 001164   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         2 001165   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8

      440    13436    5                SUDO.MAX(JSP.SUDO_CNT) = SUDO_TIME.JMAX(I);

  13436  2 001166   000000 471400 xsym               LDP1    B$SBUF2$
         2 001167   100134 236100                    LDQ     92,,PR1
         2 001170   000005 402007                    MPY     5,DL
         2 001171   200034 235100                    LDA     I,,AUTO
         2 001172   000003 735000                    ALS     3
         2 001173   000000 620006                    EAX0    0,QL
         2 001174   000003 236105                    LDQ     3,AL,PR0
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:67   
         2 001175   000033 736000                    QLS     27
         2 001176   300002 676110                    ERQ     2,X0,PR3
         2 001177   777000 376003                    ANQ     -512,DU
         2 001200   300002 656110                    ERSQ    2,X0,PR3

      441    13437    5                CALL XUD$UTS_DIFF (DTIME, CUR_UTS, SUDO_TIME.CLOCK.LAST(I));

  13437  2 001201   200034 236100                    LDQ     I,,AUTO
         2 001202   000025 736000                    QLS     21
         2 001203   000007 036003                    ADLQ    7,DU
         2 001204   200021 036100                    ADLQ    VLP$,,AUTO
         2 001205   200042 756100                    STQ     FOUND+3,,AUTO
         2 001206   200022 631500                    EPPR1   CUR_UTS,,AUTO
         2 001207   200041 451500                    STP1    FOUND+2,,AUTO
         2 001210   200027 634500                    EPPR4   DTIME,,AUTO
         2 001211   200040 454500                    STP4    FOUND+1,,AUTO
         2 001212   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001213   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001214   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001215   000000 011000                    NOP     0

      442    13438    5                SUDO.CLOCK(JSP.SUDO_CNT) = SUDO_TIME.CLOCK.INTEGRAL(I)

  13438  2 001216   000000 470400 xsym               LDP0    B$SBUF2$
         2 001217   000134 236100                    LDQ     92,,PR0
         2 001220   000005 402007                    MPY     5,DL
         2 001221   200034 235100                    LDA     I,,AUTO
         2 001222   000003 735000                    ALS     3
         2 001223   200021 471500                    LDP1    VLP$,,AUTO
         2 001224   200040 756100                    STQ     FOUND+1,,AUTO
         2 001225   200027 236100                    LDQ     DTIME,,AUTO
         2 001226   100002 402105                    MPY     2,AL,PR1
         2 001227   200034 235100                    LDA     I,,AUTO
         2 001230   000003 735000                    ALS     3
         2 001231   100006 036105                    ADLQ    6,AL,PR1
         2 001232   200033 473500                    LDP3    SUDO$,,AUTO
         2 001233   200040 720100                    LXL0    FOUND+1,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:68   
         2 001234   300004 756110                    STQ     4,X0,PR3

      443    13439    5                  + DTIME * SUDO_TIME.ACTIVE(I);
      444    13440    5                SUDO.CPU(JSP.SUDO_CNT) = SUDO_TIME.CPU.INTEGRAL(I)

  13440  2 001235   000000 470400 xsym               LDP0    B$SBUF2$
         2 001236   000134 236100                    LDQ     92,,PR0
         2 001237   000005 402007                    MPY     5,DL
         2 001240   200034 235100                    LDA     I,,AUTO
         2 001241   000003 735000                    ALS     3
         2 001242   200040 756100                    STQ     FOUND+1,,AUTO
         2 001243   200017 236100                    LDQ     CUR_CPU,,AUTO
         2 001244   100005 136105                    SBLQ    5,AL,PR1
         2 001245   100002 402105                    MPY     2,AL,PR1
         2 001246   200034 235100                    LDA     I,,AUTO
         2 001247   000003 735000                    ALS     3
         2 001250   100004 036105                    ADLQ    4,AL,PR1
         2 001251   200040 720100                    LXL0    FOUND+1,,AUTO
         2 001252   300003 756110                    STQ     3,X0,PR3

      445    13441    5                  +(CUR_CPU-SUDO_TIME.CPU.LAST(I))*SUDO_TIME.ACTIVE(I);
      446    13442    5                JSP.SUDO_CNT = JSP.SUDO_CNT+1;

  13442  2 001253   000000 470400 xsym               LDP0    B$SBUF2$
         2 001254   000134 054100                    AOS     92,,PR0

      447    13443    5                END;

      448    13444    4           END;

  13444  2 001255   200034 054100                    AOS     I,,AUTO
         2 001256   200034 235100                    LDA     I,,AUTO
         2 001257   000007 115007                    CMPA    7,DL
         2 001260   001147 604400 2                  TMOZ    s:13433
         2 001261   001375 710000 2                  TRA     s:13459

      449    13445    4      ELSE DO I = 0 TO 7;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:69   

  13445  2 001262   200034 450100                    STZ     I,,AUTO

      450    13446    4           IF SUDO_TIME.ACTIVE(I)>0

  13446  2 001263   200034 235100                    LDA     I,,AUTO
         2 001264   000003 735000                    ALS     3
         2 001265   200021 470500                    LDP0    VLP$,,AUTO
         2 001266   000002 235105                    LDA     2,AL,PR0
         2 001267   001371 600000 2                  TZE     s:13458

      451    13447    5           THEN DO;                        /* This pseudo-resource will be       */

      452    13448                                                /* active this step or period         */
      453    13449    5                SUDO.NAM(JSP.SUDO_CNT) = SUDO_TIME.NAM(I);

  13449  2 001270   000000 471400 xsym               LDP1    B$SBUF2$
         2 001271   100134 236100                    LDQ     92,,PR1
         2 001272   000005 402007                    MPY     5,DL
         2 001273   200034 235100                    LDA     I,,AUTO
         2 001274   000005 735000                    ALS     5
         2 001275   000002 736000                    QLS     2
         2 001276   200033 473500                    LDP3    SUDO$,,AUTO
         2 001277   040106 100505                    MLR     fill='040'O
         2 001300   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8
         2 001301   300000 000010                    ADSC9   0,Q,PR3                  cn=0,n=8

      454    13450    5                SUDO.MAX(JSP.SUDO_CNT) = SUDO_TIME.ACTIVE(I);

  13450  2 001302   000000 471400 xsym               LDP1    B$SBUF2$
         2 001303   100134 236100                    LDQ     92,,PR1
         2 001304   000005 402007                    MPY     5,DL
         2 001305   200034 235100                    LDA     I,,AUTO
         2 001306   000003 735000                    ALS     3
         2 001307   000000 620006                    EAX0    0,QL
         2 001310   000002 236105                    LDQ     2,AL,PR0
         2 001311   000033 736000                    QLS     27
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:70   
         2 001312   300002 676110                    ERQ     2,X0,PR3
         2 001313   777000 376003                    ANQ     -512,DU
         2 001314   300002 656110                    ERSQ    2,X0,PR3

      455    13451    5                CALL XUD$UTS_DIFF (DTIME, CUR_UTS, SUDO_TIME.CLOCK.LAST(I));

  13451  2 001315   200034 236100                    LDQ     I,,AUTO
         2 001316   000025 736000                    QLS     21
         2 001317   000007 036003                    ADLQ    7,DU
         2 001320   200021 036100                    ADLQ    VLP$,,AUTO
         2 001321   200042 756100                    STQ     FOUND+3,,AUTO
         2 001322   200022 631500                    EPPR1   CUR_UTS,,AUTO
         2 001323   200041 451500                    STP1    FOUND+2,,AUTO
         2 001324   200027 634500                    EPPR4   DTIME,,AUTO
         2 001325   200040 454500                    STP4    FOUND+1,,AUTO
         2 001326   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001327   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001330   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001331   000000 011000                    NOP     0

      456    13452    5                SUDO.CLOCK(JSP.SUDO_CNT) = SUDO_TIME.CLOCK.INTEGRAL(I)

  13452  2 001332   000000 470400 xsym               LDP0    B$SBUF2$
         2 001333   000134 236100                    LDQ     92,,PR0
         2 001334   000005 402007                    MPY     5,DL
         2 001335   200034 235100                    LDA     I,,AUTO
         2 001336   000003 735000                    ALS     3
         2 001337   200021 471500                    LDP1    VLP$,,AUTO
         2 001340   200040 756100                    STQ     FOUND+1,,AUTO
         2 001341   200027 236100                    LDQ     DTIME,,AUTO
         2 001342   100002 402105                    MPY     2,AL,PR1
         2 001343   200034 235100                    LDA     I,,AUTO
         2 001344   000003 735000                    ALS     3
         2 001345   100006 036105                    ADLQ    6,AL,PR1
         2 001346   200033 473500                    LDP3    SUDO$,,AUTO
         2 001347   200040 720100                    LXL0    FOUND+1,,AUTO
         2 001350   300004 756110                    STQ     4,X0,PR3
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:71   

      457    13453    5                  + DTIME * SUDO_TIME.ACTIVE(I);
      458    13454    5                SUDO.CPU(JSP.SUDO_CNT) = SUDO_TIME.CPU.INTEGRAL(I)

  13454  2 001351   000000 470400 xsym               LDP0    B$SBUF2$
         2 001352   000134 236100                    LDQ     92,,PR0
         2 001353   000005 402007                    MPY     5,DL
         2 001354   200034 235100                    LDA     I,,AUTO
         2 001355   000003 735000                    ALS     3
         2 001356   200040 756100                    STQ     FOUND+1,,AUTO
         2 001357   200017 236100                    LDQ     CUR_CPU,,AUTO
         2 001360   100005 136105                    SBLQ    5,AL,PR1
         2 001361   100002 402105                    MPY     2,AL,PR1
         2 001362   200034 235100                    LDA     I,,AUTO
         2 001363   000003 735000                    ALS     3
         2 001364   100004 036105                    ADLQ    4,AL,PR1
         2 001365   200040 720100                    LXL0    FOUND+1,,AUTO
         2 001366   300003 756110                    STQ     3,X0,PR3

      459    13455    5                  +(CUR_CPU-SUDO_TIME.CPU.LAST(I))*SUDO_TIME.ACTIVE(I);
      460    13456    5                JSP.SUDO_CNT = JSP.SUDO_CNT+1;

  13456  2 001367   000000 470400 xsym               LDP0    B$SBUF2$
         2 001370   000134 054100                    AOS     92,,PR0

      461    13457    5                END;

      462    13458    4           END;

  13458  2 001371   200034 054100                    AOS     I,,AUTO
         2 001372   200034 235100                    LDA     I,,AUTO
         2 001373   000007 115007                    CMPA    7,DL
         2 001374   001263 604400 2                  TMOZ    s:13446

      463    13459    3      IF JSP.SUDO_CNT~=0

  13459  2 001375   000000 470400 xsym               LDP0    B$SBUF2$
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:72   
         2 001376   000134 235100                    LDA     92,,PR0
         2 001377   001406 600000 2                  TZE     s:13464

      464    13460    4      THEN DO;

      465    13461    4           JSP.SUDOX = SIZEW(JSP);

  13461  2 001400   000141 236007                    LDQ     97,DL
         2 001401   000133 756100                    STQ     91,,PR0

      466    13462    4           RECLEN = RECLEN + JSP.SUDO_CNT*SIZEC(SUDO);

  13462  2 001402   000134 236100                    LDQ     92,,PR0
         2 001403   000024 402007                    MPY     20,DL
         2 001404   200015 036100                    ADLQ    RECLEN,,AUTO
         2 001405   200015 756100                    STQ     RECLEN,,AUTO

      467    13463    4           END;

      468    13464    4      DO WHILE('0'B);

  13464  2 001406   001422 710000 2                  TRA     s:13471

      469    13465    4   NO_SUDOS: IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY

  13465  2 001407   000000 470400 xsym  NO_SUDOS     LDP0    B$JIT$
         2 001410   000012 236100                    LDQ     10,,PR0
         2 001411   377770 376007                    ANQ     131064,DL
         2 001412   001020 116007                    CMPQ    528,DL
         2 001413   001416 600000 2                  TZE     s:13467
         2 001414   000070 116007                    CMPQ    56,DL
         2 001415   001420 601000 2                  TNZ     s:13469

      470    13466    4             OR B$JIT$->B$JIT.ERR.CODE=%E$LD
      471    13467    4           THEN B$JIT$->B$JIT.ERR = '0'B;

  13467  2 001416   000012 450100                    STZ     10,,PR0
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:73   
         2 001417   001422 710000 2                  TRA     s:13471

      472    13468                                                /* Clear the error. It's OK.          */
      473    13469    4           ELSE ALTRETURN;                 /* ALTRETURN with the error           */

  13469  2 001420   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 001421   000000 702211                    TSX2  ! 0,X1

      474    13470    4           END;

      475    13471    3      RETURN;

  13471  2 001422   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 001423   000001 702211                    TSX2  ! 1,X1

      476    13472    3   END SUDOS;
      477    13473        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:74   
      478    13474    2   RESOURCES: PROC ALTRET;

  13474  2 001424   200032 741300       RESOURCES    STX1  ! DTIME+3,,AUTO

      479    13475        /*I* NAME: RESOURCES
      480    13476             PURPOSE: To process resource allocation time records from *S into JSP    */
      481    13477        %RES$TIME(NAME = RES_TIME,STCLASS = "BASED(VLP$)");
      482    13537        %RES(NAME = RES,STCLASS="BASED(RES$)");
      483    13594    3   DCL RES$ PTR;
      484    13595    3   DCL I$ PTR;
      485    13596    3   DCL RES_ID BASED CHAR(24) ALIGNED;
      486    13597    3      IN_KEY = RES_KEY;

  13597  2 001425   000100 100400                    MLR     fill='000'O
         2 001426   000141 000004 1                  ADSC9   RES_KEY                  cn=0,n=4
         2 001427   200003 000040                    ADSC9   IN_KEY,,AUTO             cn=0,n=32

      487    13598    3      FPT$PRECORD = FPT_PRECORDC;

  13598  2 001430   200020 470500                    LDP0    FPT$,,AUTO
         2 001431   000100 100400                    MLR     fill='000'O
         2 001432   000070 000050 1                  ADSC9   FPT_PRECORDC             cn=0,n=40
         2 001433   000000 000050                    ADSC9   0,,PR0                   cn=0,n=40

      488    13599    3      FPT$PRECORD.V_ = VECTOR(FPT$PRECORD.V);

  13599  2 001434   000006 235000 3                  LDA     6
         2 001435   200020 236100                    LDQ     FPT$,,AUTO
         2 001436   000006 036003                    ADLQ    6,DU
         2 001437   000000 757100                    STAQ    0,,PR0

      489    13600    3      FPT$PRECORD.V.DCB# = %M$STAR#;

  13600  2 001440   000001 220003                    LDX0    1,DU
         2 001441   000006 740100                    STX0    6,,PR0

      490    13601    3      FPT$PRECORD.KEY_ = VECTOR(IN_KEY);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:75   

  13601  2 001442   000013 235000 3                  LDA     11
         2 001443   200040 452500                    STP2    FOUND+1,,AUTO
         2 001444   200040 236100                    LDQ     FOUND+1,,AUTO
         2 001445   000003 036003                    ADLQ    3,DU
         2 001446   000002 757100                    STAQ    2,,PR0

      491    13602    3      CALL M$MPRECORD(FPT$PRECORD) ALTRET(PREC_ALT);

  13602  2 001447   200020 630500                    EPPR0   FPT$,,AUTO
         2 001450   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001451   000000 701000 xent               TSX1    M$MPRECORD
         2 001452   001454 702000 2                  TSX2    PREC_ALT

      492    13603    4      DO WHILE('0'B);

  13603  2 001453   001465 710000 2                  TRA     s:13609

      493    13604    4   PREC_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY

  13604  2 001454   000000 470400 xsym  PREC_ALT     LDP0    B$JIT$
         2 001455   000012 236100                    LDQ     10,,PR0
         2 001456   377770 376007                    ANQ     131064,DL
         2 001457   001020 116007                    CMPQ    528,DL
         2 001460   001463 601000 2                  TNZ     s:13607

      494    13605    4           THEN B$JIT$->B$JIT.ERR='0'B;

  13605  2 001461   000012 450100                    STZ     10,,PR0
         2 001462   001465 710000 2                  TRA     s:13609

      495    13606                                                /* Clear the error. It's OK.          */
      496    13607    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */

  13607  2 001463   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 001464   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:76   
      497    13608    4           END;

      498    13609    3      FPT$READ = FPT_READC;

  13609  2 001465   200020 470500                    LDP0    FPT$,,AUTO
         2 001466   000100 100400                    MLR     fill='000'O
         2 001467   000102 000070 1                  ADSC9   FPT_READC                cn=0,n=56
         2 001470   000000 000070                    ADSC9   0,,PR0                   cn=0,n=56

      499    13610    3      FPT$READ.V_ = VECTOR(FPT$READ.V);

  13610  2 001471   000012 235000 3                  LDA     10
         2 001472   200020 236100                    LDQ     FPT$,,AUTO
         2 001473   000010 036003                    ADLQ    8,DU
         2 001474   000000 757100                    STAQ    0,,PR0

      500    13611    3      FPT$READ.V.DCB# = %M$STAR#;

  13611  2 001475   000001 220003                    LDX0    1,DU
         2 001476   000010 740100                    STX0    8,,PR0

      501    13612    3      FPT$READ.KEY_ = VECTOR(IN_KEY);

  13612  2 001477   000013 235000 3                  LDA     11
         2 001500   200040 452500                    STP2    FOUND+1,,AUTO
         2 001501   200040 236100                    LDQ     FOUND+1,,AUTO
         2 001502   000003 036003                    ADLQ    3,DU
         2 001503   000002 757100                    STAQ    2,,PR0

      502    13613    3      FPT$READ.V.KEYR# = %YES#;

  13613  2 001504   100000 236007                    LDQ     32768,DL
         2 001505   000010 256100                    ORSQ    8,,PR0

      503    13614    3      FPT$READ.BUF_ = VECTOR(RES_TIME);

  13614  2 001506   000022 235000 3                  LDA     18
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:77   
         2 001507   200021 236100                    LDQ     VLP$,,AUTO
         2 001510   000004 757100                    STAQ    4,,PR0

      504    13615    3      CALL M$MREAD(FPT$READ) ALTRET(RES_ALT);

  13615  2 001511   200020 630500                    EPPR0   FPT$,,AUTO
         2 001512   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001513   000000 701000 xent               TSX1    M$MREAD
         2 001514   001765 702000 2                  TSX2    RES_ALT

      505    13616    3      RES$ = PINCRC(B$SBUF2$,RECLEN);

  13616  2 001515   200015 236100                    LDQ     RECLEN,,AUTO
         2 001516   000020 736000                    QLS     16
         2 001517   000000 036000 xsym               ADLQ    B$SBUF2$
         2 001520   200033 756100                    STQ     RES$,,AUTO

      506    13617    4      DO WHILE(IN_KEY.FORM_KEY.TYPE='r' AND IN_KEY.FORM_KEY.STEP~=262143);

  13617  2 001521   001755 710000 2                  TRA     s:13671

      507    13618                                                /* Process all resource records       */
      508    13619    4           IF RES_TIME.REL.CLOCK>0

  13619  2 001522   200021 470500                    LDP0    VLP$,,AUTO
         2 001523   000003 235100                    LDA     3,,PR0
         2 001524   001545 604400 2                  TMOZ    s:13629

      509    13620    4           THEN
      510    13621    5           DO;                             /* Resource has been released         */

      511    13622    5                CALL XUD$UTS_DIFF (RES_TIME.START.CLOCK, RES_TIME.START.CLOCK,

  13622  2 001525   200021 236100                    LDQ     VLP$,,AUTO
         2 001526   000003 036003                    ADLQ    3,DU
         2 001527   200042 756100                    STQ     FOUND+3,,AUTO
         2 001530   200021 236100                    LDQ     VLP$,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:78   
         2 001531   000001 036003                    ADLQ    1,DU
         2 001532   200041 756100                    STQ     FOUND+2,,AUTO
         2 001533   200040 756100                    STQ     FOUND+1,,AUTO
         2 001534   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001535   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001536   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001537   000000 011000                    NOP     0

      512    13623    5                  RES_TIME.REL.CLOCK);
      513    13624    5                RES_TIME.START.CPU = RES_TIME.START.CPU

  13624  2 001540   200021 470500                    LDP0    VLP$,,AUTO
         2 001541   000002 236100                    LDQ     2,,PR0
         2 001542   000004 136100                    SBLQ    4,,PR0
         2 001543   000002 756100                    STQ     2,,PR0

      514    13625    5                  - RES_TIME.REL.CPU;
      515    13626    5                END;

  13626  2 001544   001563 710000 2                  TRA     s:13633

      516    13627    4           ELSE
      517    13628    5           DO;                             /* Not released yet...use current     */

      518    13629    5                CALL XUD$UTS_DIFF (RES_TIME.START.CLOCK, RES_TIME.START.CLOCK,

  13629  2 001545   200022 631500                    EPPR1   CUR_UTS,,AUTO
         2 001546   200042 451500                    STP1    FOUND+3,,AUTO
         2 001547   200021 236100                    LDQ     VLP$,,AUTO
         2 001550   000001 036003                    ADLQ    1,DU
         2 001551   200041 756100                    STQ     FOUND+2,,AUTO
         2 001552   200040 756100                    STQ     FOUND+1,,AUTO
         2 001553   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001554   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001555   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001556   000000 011000                    NOP     0

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:79   
      519    13630    5                  CUR_UTS);
      520    13631    5                RES_TIME.START.CPU = RES_TIME.START.CPU - CUR_CPU;

  13631  2 001557   200021 470500                    LDP0    VLP$,,AUTO
         2 001560   000002 236100                    LDQ     2,,PR0
         2 001561   200017 136100                    SBLQ    CUR_CPU,,AUTO
         2 001562   000002 756100                    STQ     2,,PR0

      521    13632    5                END;

      522    13633    4           I$ = PINCRC(B$SBUF2$,RECLEN);

  13633  2 001563   200015 236100                    LDQ     RECLEN,,AUTO
         2 001564   000020 736000                    QLS     16
         2 001565   000000 036000 xsym               ADLQ    B$SBUF2$
         2 001566   200034 756100                    STQ     I$,,AUTO

      523    13634    5           DO WHILE I$<RES$;               /* Find any corresponding entry       */

  13634  2 001567   200033 116100                    CMPQ    RES$,,AUTO
         2 001570   001607 603000 2                  TRC     s:13640

      524    13635    5                IF I$->RES.TYPE(0) = RES_TIME.TYPE

  13635  2 001571   200034 470500                    LDP0    I$,,AUTO
         2 001572   200021 471500                    LDP1    VLP$,,AUTO
         2 001573   000000 236100                    LDQ     0,,PR0
         2 001574   100000 116100                    CMPQ    0,,PR1
         2 001575   001602 601000 2                  TNZ     s:13638
         2 001576   040100 106500                    CMPC    fill='040'O
         2 001577   000003 000030                    ADSC9   3,,PR0                   cn=0,n=24
         2 001600   100005 000030                    ADSC9   5,,PR1                   cn=0,n=24
         2 001601   001607 600000 2                  TZE     s:13640

      525    13636    5                  AND ADDR(I$->RES.WSN(0))->RES_ID = ADDR(RES_TIME.WSN)->RES_ID
      526    13637    5                THEN EXIT;
      527    13638    5                I$ = PINCRC(I$,SIZEC(RES));
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:80   

  13638  2 001602   200034 236100                    LDQ     I$,,AUTO
         2 001603   000011 036003                    ADLQ    9,DU
         2 001604   200034 756100                    STQ     I$,,AUTO

      528    13639    5                END;

  13639  2 001605   200033 116100                    CMPQ    RES$,,AUTO
         2 001606   001571 602000 2                  TNC     s:13635

      529    13640    4           IF I$=RES$

  13640  2 001607   200034 236100                    LDQ     I$,,AUTO
         2 001610   200033 116100                    CMPQ    RES$,,AUTO
         2 001611   001635 601000 2                  TNZ     s:13650

      530    13641    5           THEN DO;

      531    13642    5                RES.TYPE(0) = RES_TIME.TYPE;

  13642  2 001612   200021 470500                    LDP0    VLP$,,AUTO
         2 001613   200033 471500                    LDP1    RES$,,AUTO
         2 001614   000000 235100                    LDA     0,,PR0
         2 001615   100000 755100                    STA     0,,PR1

      532    13643    5                ADDR(RES.WSN(0))->RES_ID = ADDR(RES_TIME.WSN)->RES_ID;

  13643  2 001616   040100 100500                    MLR     fill='040'O
         2 001617   000005 000030                    ADSC9   5,,PR0                   cn=0,n=24
         2 001620   100003 000030                    ADSC9   3,,PR1                   cn=0,n=24

      533    13644    5                RES.CLOCK(0) = 0;

  13644  2 001621   100001 450100                    STZ     1,,PR1

      534    13645    5                RES.CPU(0) = 0;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:81   
  13645  2 001622   100002 450100                    STZ     2,,PR1

      535    13646    5                IF PINCRC(RES$,200)>VLP$ THEN EXIT; /* Leave room for some forms */

  13646  2 001623   200033 236100                    LDQ     RES$,,AUTO
         2 001624   000062 036003                    ADLQ    50,DU
         2 001625   200021 116100                    CMPQ    VLP$,,AUTO
         2 001626   001630 600000 2                  TZE     s:13647
         2 001627   001635 603000 2                  TRC     s:13650

      536    13647    5                RES$ = PINCRC(RES$,SIZEC(RES));

  13647  2 001630   200033 236100                    LDQ     RES$,,AUTO
         2 001631   000011 036003                    ADLQ    9,DU
         2 001632   200033 756100                    STQ     RES$,,AUTO

      537    13648    5                JSP.RES_CNT = JSP.RES_CNT+1;

  13648  2 001633   000000 471400 xsym               LDP1    B$SBUF2$
         2 001634   100136 054100                    AOS     94,,PR1

      538    13649    5                END;

      539    13650    4           IF RES_TIME.START.CLOCK~=0

  13650  2 001635   200021 470500                    LDP0    VLP$,,AUTO
         2 001636   000001 235100                    LDA     1,,PR0
         2 001637   001751 600000 2                  TZE     s:13670

      540    13651    5           THEN DO;

      541    13652    5                CALL XUD$UTS_DIFF (I$->RES.CLOCK(0), I$->RES.CLOCK(0),

  13652  2 001640   200021 236100                    LDQ     VLP$,,AUTO
         2 001641   000001 036003                    ADLQ    1,DU
         2 001642   200042 756100                    STQ     FOUND+3,,AUTO
         2 001643   200034 236100                    LDQ     I$,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:82   
         2 001644   000001 036003                    ADLQ    1,DU
         2 001645   200041 756100                    STQ     FOUND+2,,AUTO
         2 001646   200040 756100                    STQ     FOUND+1,,AUTO
         2 001647   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001650   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001651   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001652   000000 011000                    NOP     0

      542    13653    5                  RES_TIME.START.CLOCK);
      543    13654    5                I$->RES.CPU(0) = I$->RES.CPU(0) - RES_TIME.START.CPU;

  13654  2 001653   200021 470500                    LDP0    VLP$,,AUTO
         2 001654   200034 471500                    LDP1    I$,,AUTO
         2 001655   100002 236100                    LDQ     2,,PR1
         2 001656   000002 136100                    SBLQ    2,,PR0
         2 001657   100002 756100                    STQ     2,,PR1

      544    13655    6                DO CASE(RES_TIME.TYPE);

  13655  2 001660   000000 235100                    LDA     0,,PR0
         2 001661   000003 115007                    CMPA    3,DL
         2 001662   001664 602005 2                  TNC     s:13655+4,AL
         2 001663   001751 710000 2                  TRA     s:13670
         2 001664   001667 710000 2                  TRA     s:13657
         2 001665   001710 710000 2                  TRA     s:13661
         2 001666   001731 710000 2                  TRA     s:13665

      545    13656    6                 CASE(FR_DP);

      546    13657    6                   CALL XUD$UTS_DIFF (JSP.DPTIM_CLK, JSP.DPTIM_CLK,

  13657  2 001667   200021 236100                    LDQ     VLP$,,AUTO
         2 001670   000001 036003                    ADLQ    1,DU
         2 001671   200042 756100                    STQ     FOUND+3,,AUTO
         2 001672   000000 236000 xsym               LDQ     B$SBUF2$
         2 001673   000073 036003                    ADLQ    59,DU
         2 001674   200041 756100                    STQ     FOUND+2,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:83   
         2 001675   200040 756100                    STQ     FOUND+1,,AUTO
         2 001676   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001677   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001700   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001701   000000 011000                    NOP     0

      547    13658    6                     RES_TIME.START.CLOCK);
      548    13659    6                   JSP.DPTIM_CPU = JSP.DPTIM_CPU - RES_TIME.START.CPU;

  13659  2 001702   200021 470500                    LDP0    VLP$,,AUTO
         2 001703   000000 471400 xsym               LDP1    B$SBUF2$
         2 001704   100076 236100                    LDQ     62,,PR1
         2 001705   000002 136100                    SBLQ    2,,PR0
         2 001706   100076 756100                    STQ     62,,PR1
         2 001707   001751 710000 2                  TRA     s:13670

      549    13660    6                 CASE(FR_MT);

      550    13661    6                   CALL XUD$UTS_DIFF (JSP.MTTIM_CLK, JSP.MTTIM_CLK,

  13661  2 001710   200021 236100                    LDQ     VLP$,,AUTO
         2 001711   000001 036003                    ADLQ    1,DU
         2 001712   200042 756100                    STQ     FOUND+3,,AUTO
         2 001713   000000 236000 xsym               LDQ     B$SBUF2$
         2 001714   000072 036003                    ADLQ    58,DU
         2 001715   200041 756100                    STQ     FOUND+2,,AUTO
         2 001716   200040 756100                    STQ     FOUND+1,,AUTO
         2 001717   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001720   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001721   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001722   000000 011000                    NOP     0

      551    13662    6                     RES_TIME.START.CLOCK);
      552    13663    6                   JSP.MTTIM_CPU = JSP.MTTIM_CPU - RES_TIME.START.CPU;

  13663  2 001723   200021 470500                    LDP0    VLP$,,AUTO
         2 001724   000000 471400 xsym               LDP1    B$SBUF2$
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:84   
         2 001725   100075 236100                    LDQ     61,,PR1
         2 001726   000002 136100                    SBLQ    2,,PR0
         2 001727   100075 756100                    STQ     61,,PR1
         2 001730   001751 710000 2                  TRA     s:13670

      553    13664    6                 CASE(FR_NPOOL);

      554    13665    6                   CALL XUD$UTS_DIFF (JSP.ORTIM_CLK, JSP.ORTIM_CLK,

  13665  2 001731   200021 236100                    LDQ     VLP$,,AUTO
         2 001732   000001 036003                    ADLQ    1,DU
         2 001733   200042 756100                    STQ     FOUND+3,,AUTO
         2 001734   000000 236000 xsym               LDQ     B$SBUF2$
         2 001735   000074 036003                    ADLQ    60,DU
         2 001736   200041 756100                    STQ     FOUND+2,,AUTO
         2 001737   200040 756100                    STQ     FOUND+1,,AUTO
         2 001740   200040 630500                    EPPR0   FOUND+1,,AUTO
         2 001741   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001742   000000 701000 xent               TSX1    XUD$UTS_DIFF
         2 001743   000000 011000                    NOP     0

      555    13666    6                     RES_TIME.START.CLOCK);
      556    13667    6                   JSP.ORTIM_CPU = JSP.ORTIM_CPU - RES_TIME.START.CPU;

  13667  2 001744   200021 470500                    LDP0    VLP$,,AUTO
         2 001745   000000 471400 xsym               LDP1    B$SBUF2$
         2 001746   100077 236100                    LDQ     63,,PR1
         2 001747   000002 136100                    SBLQ    2,,PR0
         2 001750   100077 756100                    STQ     63,,PR1

      557    13668    6                   END;                    /* CASE                               */

      558    13669    5                END;

      559    13670    4           CALL M$MREAD(FPT$READ) ALTRET(RES_ALT);

  13670  2 001751   200020 630500                    EPPR0   FPT$,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:85   
         2 001752   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001753   000000 701000 xent               TSX1    M$MREAD
         2 001754   001765 702000 2                  TSX2    RES_ALT

      560    13671    4           END;

  13671  2 001755   200003 236100                    LDQ     IN_KEY,,AUTO
         2 001756   000777 376003                    ANQ     511,DU
         2 001757   000162 116003                    CMPQ    114,DU
         2 001760   001764 601000 2                  TNZ     s:13672
         2 001761   200003 720100                    LXL0    IN_KEY,,AUTO
         2 001762   777777 100003                    CMPX0   -1,DU
         2 001763   001522 601000 2                  TNZ     s:13619

      561    13672    4      DO WHILE('0'B);

  13672  2 001764   002002 710000 2                  TRA     s:13680

      562    13673    4   RES_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$EOF

  13673  2 001765   000000 470400 xsym  RES_ALT      LDP0    B$JIT$
         2 001766   000012 236100                    LDQ     10,,PR0
         2 001767   377770 376007                    ANQ     131064,DL
         2 001770   000060 116007                    CMPQ    48,DL
         2 001771   001776 600000 2                  TZE     s:13676
         2 001772   001610 116007                    CMPQ    904,DL
         2 001773   001776 600000 2                  TZE     s:13676
         2 001774   000070 116007                    CMPQ    56,DL
         2 001775   002000 601000 2                  TNZ     s:13678

      563    13674    4             OR B$JIT$->B$JIT.ERR.CODE=%E$NOFILE
      564    13675    4             OR B$JIT$->B$JIT.ERR.CODE=%E$LD
      565    13676    4           THEN B$JIT$->B$JIT.ERR = '0'B;

  13676  2 001776   000012 450100                    STZ     10,,PR0
         2 001777   002002 710000 2                  TRA     s:13680

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:86   
      566    13677                                                /* All's well. Clear the error.       */
      567    13678    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */

  13678  2 002000   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 002001   000000 702211                    TSX2  ! 0,X1

      568    13679    4           END;

      569    13680    3      IF JSP.RES_CNT>0

  13680  2 002002   000000 470400 xsym               LDP0    B$SBUF2$
         2 002003   000136 235100                    LDA     94,,PR0
         2 002004   002014 604400 2                  TMOZ    s:13685

      570    13681    4      THEN DO;

      571    13682    4           JSP.RESX = RECLEN/4;

  13682  2 002005   200015 236100                    LDQ     RECLEN,,AUTO
         2 002006   000002 772000                    QRL     2
         2 002007   000135 756100                    STQ     93,,PR0

      572    13683    4           RECLEN = RECLEN + JSP.RES_CNT*SIZEC(RES);

  13683  2 002010   000136 236100                    LDQ     94,,PR0
         2 002011   000044 402007                    MPY     36,DL
         2 002012   200015 036100                    ADLQ    RECLEN,,AUTO
         2 002013   200015 756100                    STQ     RECLEN,,AUTO

      573    13684    4           END;

      574    13685    3      RETURN;

  13685  2 002014   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 002015   000001 702211                    TSX2  ! 1,X1

      575    13686    3   END RESOURCES;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:87   
      576    13687        %EJECT;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:88   
      577    13688    2   FORMS: PROC ALTRET;

  13688  2 002016   200032 741300       FORMS        STX1  ! DTIME+3,,AUTO

      578    13689        /*I* NAME: FORMS
      579    13690             PURPOSE: To process the forms records from the *S file for this call     */
      580    13691        %FORM$REC(NAME = FORM_REC,STCLASS = "BASED(VLP$)");
      581    13745        %FORM(NAME = FORM1,STCLASS="BASED(FORM1$)");
      582    13791    3   DCL FORM1$ PTR;
      583    13792    3   DCL FRMS  SBIN;
      584    13793    3   DCL I SBIN;
      585    13794    3   DCL J SBIN;
      586    13795    3   DCL FOUND BIT(1) ALIGNED;
      587    13796    3      FORM1$ = PINCRC(B$SBUF2$,RECLEN);

  13796  2 002017   200015 236100                    LDQ     RECLEN,,AUTO
         2 002020   000020 736000                    QLS     16
         2 002021   000000 036000 xsym               ADLQ    B$SBUF2$
         2 002022   200033 756100                    STQ     FORM1$,,AUTO

      588    13797    3      IF B$JIT.STDLOPGS ~= 0

  13797  2 002023   200023 470500                    LDP0    JIT$,,AUTO
         2 002024   000326 235100                    LDA     214,,PR0
         2 002025   002044 600000 2                  TZE     s:13807

      589    13798    4      THEN DO;                             /* Must special case standard         */

      590    13799                                                /* lineprinter form count             */
      591    13800    4           FORM1.FORMS(0) = B$JIT.STDLOPGS;

  13800  2 002026   200033 471500                    LDP1    FORM1$,,AUTO
         2 002027   100000 755100                    STA     0,,PR1

      592    13801    4           FORM1.MOUNTS(0) = 0;

  13801  2 002030   100001 450100                    STZ     1,,PR1
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:89   

      593    13802    4           FORM1.S1.FORMNAME(0) = 'STDLP';

  13802  2 002031   040100 100400                    MLR     fill='040'O
         2 002032   000146 000005 1                  ADSC9   DOMAIN_ERR+1             cn=0,n=5
         2 002033   100002 000014                    ADSC9   2,,PR1                   cn=0,n=12

      594    13803    4           FORM1.S1.DD(0) = 'LP';

  13803  2 002034   000150 220000 1                  LDX0    DOMAIN_ERR+3
         2 002035   100005 740100                    STX0    5,,PR1

      595    13804    4           FORM1.S1.WSN(0) = B$JIT.WOO;

  13804  2 002036   040100 100500                    MLR     fill='040'O
         2 002037   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         2 002040   100005 400010                    ADSC9   5,,PR1                   cn=2,n=8

      596    13805    4           JSP.FORM_CNT = 1;

  13805  2 002041   000001 235007                    LDA     1,DL
         2 002042   000000 473400 xsym               LDP3    B$SBUF2$
         2 002043   300140 755100                    STA     96,,PR3

      597    13806    4           END;

      598    13807    3      IN_KEY = FORM_KEY;

  13807  2 002044   000100 100400                    MLR     fill='000'O
         2 002045   000142 000006 1                  ADSC9   FORM_KEY                 cn=0,n=6
         2 002046   200003 000040                    ADSC9   IN_KEY,,AUTO             cn=0,n=32

      599    13808    3      IF TYP=%SSTOP# OR TYP=%SSTART# OR TYP=%PSTOP# OR TYP=%PSTART#

  13808  2 002047   200013 235100                    LDA     TYP,,AUTO
         2 002050   000004 115007                    CMPA    4,DL
         2 002051   002060 600000 2                  TZE     s:13809
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:90   
         2 002052   000003 115007                    CMPA    3,DL
         2 002053   002060 600000 2                  TZE     s:13809
         2 002054   000002 115007                    CMPA    2,DL
         2 002055   002060 600000 2                  TZE     s:13809
         2 002056   000001 115007                    CMPA    1,DL
         2 002057   002062 601000 2                  TNZ     s:13810

      600    13809    3      THEN IN_KEY.FORM_KEY.STEP = B$JIT.STEPS; /* Start at last step             */

  13809  2 002060   000315 720100                    LXL0    205,,PR0
         2 002061   200003 440100                    SXL0    IN_KEY,,AUTO

      601    13810    3      FPT$PRECORD = FPT_PRECORDC;

  13810  2 002062   200020 471500                    LDP1    FPT$,,AUTO
         2 002063   000100 100400                    MLR     fill='000'O
         2 002064   000070 000050 1                  ADSC9   FPT_PRECORDC             cn=0,n=40
         2 002065   100000 000050                    ADSC9   0,,PR1                   cn=0,n=40

      602    13811    3      FPT$PRECORD.V_ = VECTOR(FPT$PRECORD.V);

  13811  2 002066   000006 235000 3                  LDA     6
         2 002067   200020 236100                    LDQ     FPT$,,AUTO
         2 002070   000006 036003                    ADLQ    6,DU
         2 002071   100000 757100                    STAQ    0,,PR1

      603    13812    3      FPT$PRECORD.V.DCB# = %M$STAR#;

  13812  2 002072   000001 220003                    LDX0    1,DU
         2 002073   100006 740100                    STX0    6,,PR1

      604    13813    3      FPT$PRECORD.KEY_ = VECTOR(IN_KEY);

  13813  2 002074   000013 235000 3                  LDA     11
         2 002075   200040 452500                    STP2    FOUND+1,,AUTO
         2 002076   200040 236100                    LDQ     FOUND+1,,AUTO
         2 002077   000003 036003                    ADLQ    3,DU
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:91   
         2 002100   100002 757100                    STAQ    2,,PR1

      605    13814    3      CALL M$MPRECORD(FPT$PRECORD) ALTRET(PREC_ALT);

  13814  2 002101   200020 630500                    EPPR0   FPT$,,AUTO
         2 002102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002103   000000 701000 xent               TSX1    M$MPRECORD
         2 002104   002106 702000 2                  TSX2    PREC_ALT

      606    13815    4      DO WHILE('0'B);

  13815  2 002105   002117 710000 2                  TRA     s:13821

      607    13816    4   PREC_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$NOKEY

  13816  2 002106   000000 470400 xsym  PREC_ALT     LDP0    B$JIT$
         2 002107   000012 236100                    LDQ     10,,PR0
         2 002110   377770 376007                    ANQ     131064,DL
         2 002111   001020 116007                    CMPQ    528,DL
         2 002112   002115 601000 2                  TNZ     s:13819

      608    13817    4           THEN B$JIT$->B$JIT.ERR = '0'B;

  13817  2 002113   000012 450100                    STZ     10,,PR0
         2 002114   002117 710000 2                  TRA     s:13821

      609    13818                                                /* Clear the error. All's well.       */
      610    13819    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */

  13819  2 002115   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 002116   000000 702211                    TSX2  ! 0,X1

      611    13820    4           END;

      612    13821    3      FPT$READ = FPT_READC;

  13821  2 002117   200020 470500                    LDP0    FPT$,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:92   
         2 002120   000100 100400                    MLR     fill='000'O
         2 002121   000102 000070 1                  ADSC9   FPT_READC                cn=0,n=56
         2 002122   000000 000070                    ADSC9   0,,PR0                   cn=0,n=56

      613    13822    3      FPT$READ.V_ = VECTOR(FPT$READ.V);

  13822  2 002123   000012 235000 3                  LDA     10
         2 002124   200020 236100                    LDQ     FPT$,,AUTO
         2 002125   000010 036003                    ADLQ    8,DU
         2 002126   000000 757100                    STAQ    0,,PR0

      614    13823    3      FPT$READ.V.DCB# = %M$STAR#;

  13823  2 002127   000001 220003                    LDX0    1,DU
         2 002130   000010 740100                    STX0    8,,PR0

      615    13824    3      FPT$READ.KEY_ = VECTOR(IN_KEY);

  13824  2 002131   000013 235000 3                  LDA     11
         2 002132   200040 452500                    STP2    FOUND+1,,AUTO
         2 002133   200040 236100                    LDQ     FOUND+1,,AUTO
         2 002134   000003 036003                    ADLQ    3,DU
         2 002135   000002 757100                    STAQ    2,,PR0

      616    13825    3      FPT$READ.V.KEYR# = %YES#;

  13825  2 002136   100000 236007                    LDQ     32768,DL
         2 002137   000010 256100                    ORSQ    8,,PR0

      617    13826    3      FPT$READ.BUF_ = VECTOR(FORM_REC);

  13826  2 002140   000023 235000 3                  LDA     19
         2 002141   200021 236100                    LDQ     VLP$,,AUTO
         2 002142   000004 757100                    STAQ    4,,PR0

      618    13827    3      CALL M$MREAD(FPT$READ) ALTRET(FORM_ALT);

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:93   
  13827  2 002143   200020 630500                    EPPR0   FPT$,,AUTO
         2 002144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002145   000000 701000 xent               TSX1    M$MREAD
         2 002146   002310 702000 2                  TSX2    FORM_ALT

      619    13828    4      DO WHILE(IN_KEY.FORM_KEY.TYPE='f');

  13828  2 002147   200003 236100                    LDQ     IN_KEY,,AUTO
         2 002150   000777 376003                    ANQ     511,DU
         2 002151   000146 116003                    CMPQ    102,DU
         2 002152   002307 601000 2                  TNZ     s:13858

      620    13829    4           FOUND = %NO#;

  13829  2 002153   200037 450100                    STZ     FOUND,,AUTO

      621    13830    4           I = 0;

  13830  2 002154   200035 450100                    STZ     I,,AUTO

      622    13831    5           DO WHILE(NOT FOUND AND I<JSP.FORM_CNT);

  13831  2 002155   002172 710000 2                  TRA     s:13836

      623    13832                                                /* Find corresponding FORM entry      */
      624    13833    5                IF FORM1.S1(I)=FORM_REC.S1

  13833  2 002156   200035 236100                    LDQ     I,,AUTO
         2 002157   000064 402007                    MPY     52,DL
         2 002160   200033 470500                    LDP0    FORM1$,,AUTO
         2 002161   200021 471500                    LDP1    VLP$,,AUTO
         2 002162   000100 106506                    CMPC    fill='000'O
         2 002163   000002 000026                    ADSC9   2,Q,PR0                  cn=0,n=22
         2 002164   100003 400026                    ADSC9   3,,PR1                   cn=2,n=22
         2 002165   002171 601000 2                  TNZ     s:13835

      625    13834    5                THEN FOUND = %YES#;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:94   

  13834  2 002166   400000 236003                    LDQ     -131072,DU
         2 002167   200037 756100                    STQ     FOUND,,AUTO
         2 002170   002172 710000 2                  TRA     s:13836

      626    13835    5                ELSE I=I+1;

  13835  2 002171   200035 054100                    AOS     I,,AUTO

      627    13836    5                END;

  13836  2 002172   200037 234100                    SZN     FOUND,,AUTO
         2 002173   002200 604000 2                  TMI     s:13837
         2 002174   000000 470400 xsym               LDP0    B$SBUF2$
         2 002175   200035 236100                    LDQ     I,,AUTO
         2 002176   000140 116100                    CMPQ    96,,PR0
         2 002177   002156 604000 2                  TMI     s:13833

      628    13837    4           IF NOT FOUND

  13837  2 002200   200037 234100                    SZN     FOUND,,AUTO
         2 002201   002225 604000 2                  TMI     s:13844

      629    13838    5           THEN DO;                        /* A new entry                        */

      630    13839    5                FORM1(I) = '0'B;

  13839  2 002202   200035 236100                    LDQ     I,,AUTO
         2 002203   000064 402007                    MPY     52,DL
         2 002204   200033 470500                    LDP0    FORM1$,,AUTO
         2 002205   000106 100400                    MLR     fill='000'O
         2 002206   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 002207   000000 000061                    ADSC9   0,Q,PR0                  cn=0,n=49

      631    13840    5                FORM1.S1(I) = FORM_REC.S1;

  13840  2 002210   200021 471500                    LDP1    VLP$,,AUTO
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:95   
         2 002211   000106 100500                    MLR     fill='000'O
         2 002212   100003 400026                    ADSC9   3,,PR1                   cn=2,n=22
         2 002213   000002 000026                    ADSC9   2,Q,PR0                  cn=0,n=22

      632    13841    5                IF ADDR(FORM1(I+1))<=VLP$

  13841  2 002214   200035 236100                    LDQ     I,,AUTO
         2 002215   000015 402003                    MPY     13,DU
         2 002216   000015 036003                    ADLQ    13,DU
         2 002217   200033 036100                    ADLQ    FORM1$,,AUTO
         2 002220   200021 116100                    CMPQ    VLP$,,AUTO
         2 002221   002223 600000 2                  TZE     s:13842
         2 002222   002225 603000 2                  TRC     s:13844

      633    13842    5                THEN JSP.FORM_CNT = JSP.FORM_CNT + 1;

  13842  2 002223   000000 473400 xsym               LDP3    B$SBUF2$
         2 002224   300140 054100                    AOS     96,,PR3

      634    13843    5                END;

      635    13844    4           IF FORM_REC.DDEV.LP

  13844  2 002225   200021 470500                    LDP0    VLP$,,AUTO
         2 002226   000003 234100                    SZN     3,,PR0
         2 002227   002234 605000 2                  TPL     s:13846

      636    13845    4           THEN FRMS = FORM_REC.PAGES;     /* DDEV.LP counts by the page         */

  13845  2 002230   000002 236100                    LDQ     2,,PR0
         2 002231   000022 732000                    QRS     18
         2 002232   200034 756100                    STQ     FRMS,,AUTO
         2 002233   002236 710000 2                  TRA     s:13847

      637    13846    4           ELSE FRMS = FORM_REC.RECS;      /* all others count by the record     */

  13846  2 002234   000001 235100                    LDA     1,,PR0
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:96   
         2 002235   200034 755100                    STA     FRMS,,AUTO

      638    13847    4           FORM1.FORMS(I) = FORM1.FORMS(I) + FRMS*FORM_REC.COPIES;

  13847  2 002236   200035 236100                    LDQ     I,,AUTO
         2 002237   000015 402007                    MPY     13,DL
         2 002240   000000 620006                    EAX0    0,QL
         2 002241   000002 236100                    LDQ     2,,PR0
         2 002242   777777 376007                    ANQ     -1,DL
         2 002243   200034 402100                    MPY     FRMS,,AUTO
         2 002244   200033 471500                    LDP1    FORM1$,,AUTO
         2 002245   100000 036110                    ADLQ    0,X0,PR1
         2 002246   100000 756110                    STQ     0,X0,PR1

      639    13848    4           FORM1.MOUNTS(I) = FORM1.MOUNTS(I) + FORM_REC.MOUNTS;

  13848  2 002247   100001 236110                    LDQ     1,X0,PR1
         2 002250   000000 036100                    ADLQ    0,,PR0
         2 002251   100001 756110                    STQ     1,X0,PR1

      640    13849    4           IF FORM1.FORMS(I)=0 AND FORM1.MOUNTS(I)=0

  13849  2 002252   100000 235110                    LDA     0,X0,PR1
         2 002253   002277 601000 2                  TNZ     s:13856
         2 002254   000000 116003                    CMPQ    0,DU
         2 002255   002277 601000 2                  TNZ     s:13856

      641    13850    5           THEN DO;                        /* Delete this empty entry            */

      642    13851    6                DO J=I+1 TO JSP.FORM_CNT-1;

  13851  2 002256   200035 235100                    LDA     I,,AUTO
         2 002257   000001 035007                    ADLA    1,DL
         2 002260   200036 755100                    STA     J,,AUTO
         2 002261   002271 710000 2                  TRA     s:13853+1

      643    13852    6                     FORM1(J-1) = FORM1(J);
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:97   

  13852  2 002262   200036 236100                    LDQ     J,,AUTO
         2 002263   000064 402007                    MPY     52,DL
         2 002264   200033 470500                    LDP0    FORM1$,,AUTO
         2 002265   000106 100506                    MLR     fill='000'O
         2 002266   000000 000061                    ADSC9   0,Q,PR0                  cn=0,n=49
         2 002267   077763 000061                    ADSC9   -13,Q,PR0                cn=0,n=49

      644    13853    6                     END;

  13853  2 002270   200036 054100                    AOS     J,,AUTO
         2 002271   000000 470400 xsym               LDP0    B$SBUF2$
         2 002272   200036 236100                    LDQ     J,,AUTO
         2 002273   000140 116100                    CMPQ    96,,PR0
         2 002274   002262 604000 2                  TMI     s:13852

      645    13854    5                JSP.FORM_CNT = JSP.FORM_CNT-1;

  13854  2 002275   000001 336007                    LCQ     1,DL
         2 002276   000140 056100                    ASQ     96,,PR0

      646    13855    5                END;

      647    13856    4           CALL M$MREAD(FPT$READ) ALTRET(FORM_ALT);

  13856  2 002277   200020 630500                    EPPR0   FPT$,,AUTO
         2 002300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002301   000000 701000 xent               TSX1    M$MREAD
         2 002302   002310 702000 2                  TSX2    FORM_ALT

      648    13857    4           END;

  13857  2 002303   200003 236100                    LDQ     IN_KEY,,AUTO
         2 002304   000777 376003                    ANQ     511,DU
         2 002305   000146 116003                    CMPQ    102,DU
         2 002306   002153 600000 2                  TZE     s:13829

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:98   
      649    13858    4      DO WHILE('0'B);

  13858  2 002307   002323 710000 2                  TRA     s:13865

      650    13859    4   FORM_ALT: IF B$JIT$->B$JIT.ERR.CODE=%E$EOF

  13859  2 002310   000000 470400 xsym  FORM_ALT     LDP0    B$JIT$
         2 002311   000012 236100                    LDQ     10,,PR0
         2 002312   377770 376007                    ANQ     131064,DL
         2 002313   000060 116007                    CMPQ    48,DL
         2 002314   002317 600000 2                  TZE     s:13861
         2 002315   000070 116007                    CMPQ    56,DL
         2 002316   002321 601000 2                  TNZ     s:13863

      651    13860    4             OR B$JIT$->B$JIT.ERR.CODE=%E$LD
      652    13861    4           THEN B$JIT$->B$JIT.ERR = '0'B;

  13861  2 002317   000012 450100                    STZ     10,,PR0
         2 002320   002323 710000 2                  TRA     s:13865

      653    13862                                                /* Clear the error. It's OK.          */
      654    13863    4           ELSE ALTRETURN;                 /* Just altreturn with the error      */

  13863  2 002321   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 002322   000000 702211                    TSX2  ! 0,X1

      655    13864    4           END;

      656    13865    3      IF JSP.FORM_CNT>0

  13865  2 002323   000000 470400 xsym               LDP0    B$SBUF2$
         2 002324   000140 235100                    LDA     96,,PR0
         2 002325   002335 604400 2                  TMOZ    s:13870

      657    13866    4      THEN DO;

      658    13867    4           JSP.FORMX = RECLEN/4;
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:99   

  13867  2 002326   200015 236100                    LDQ     RECLEN,,AUTO
         2 002327   000002 772000                    QRL     2
         2 002330   000137 756100                    STQ     95,,PR0

      659    13868    4           RECLEN = RECLEN + JSP.FORM_CNT*SIZEC(FORM1);

  13868  2 002331   000140 236100                    LDQ     96,,PR0
         2 002332   000064 402007                    MPY     52,DL
         2 002333   200015 036100                    ADLQ    RECLEN,,AUTO
         2 002334   200015 756100                    STQ     RECLEN,,AUTO

      660    13869    4           END;

      661    13870    3      RETURN;

  13870  2 002335   200032 221300                    LDX1  ! DTIME+3,,AUTO
         2 002336   000001 702211                    TSX2  ! 1,X1

FPT_JOBSTATSC
 Sect OctLoc
   1     000   000013 777640   000030 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     030*  000000 000002   000000 000000   000000 000000   000000 000000    ................
   1     034   000000 000000   000000 000000   000000 000000   000000 000000    ................
   1     040   000000 000000   000000 000000   000000 000000   000000 000000    ................

VLP_CRITERIAC
 Sect OctLoc
   1     044   040040 040040   040040 040040   040040 040040   040040 040040
   1     050   040040 040040   040040 040040   000000 000000   000000 000000            ........
   1     054   000000 000000   000000 000377   000000 000377   040040 ******    ............  ..
   1     060   000000 000000   040040 040040   040040 000000   000000 000000    ....      ......
   1     064   000000 000000   000000 000000   000000 000000   000000 ******    ................

FPT_PRECORDC
 Sect OctLoc
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:100  
   1     070   000003 777640   000076 006000   000000 177640   000000 006014    .....>..........
   1     074   000000 177640   000000 006014   000000 400000   000000 000000    ................
   1     100   000000 000000   0***** ******                                    ........

FPT_READC
 Sect OctLoc
   1     102   000005 777640   000112 006000   000000 177640   000000 006014    .....J..........
   1     106   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     112   000000 400000   000000 000000   000000 000000   000000 000000    ................
   1     116   000000 000000   000000 000000                                    ........

FPT_WRITEC
 Sect OctLoc
   1     120   000003 777640   000130 006000   000000 177640   000000 006014    .....X..........
   1     124   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     130   000000 400400   000000 000000   000000 000000   000000 000000    ................

ATITLE_KEY
 Sect OctLoc
   1     134   006101 124111   124114 105***                                    .ATITLE.

LIMIT_KEY
 Sect OctLoc
   1     136   005114 111115   111124 ******                                    .LIMIT..

SUDO_KEY
 Sect OctLoc
   1     140   003162 777777                                                    .r..

RES_KEY
 Sect OctLoc
   1     141   003162 000000                                                    .r..

FORM_KEY
 Sect OctLoc
   1     142   005146 000000   000000 ******                                    .f......

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:101  
LD_ERR
 Sect OctLoc
   1     144   010601 400072                                                    ...:

DOMAIN_ERR
 Sect OctLoc
   1     145   010601 406262                                                    ....

(unnamed)
 Sect OctLoc
   1     146   123124 104114   120040 040040   114120 040040                    STDLP   LP

(unnamed)
 Sect OctLoc
   3     000   000000 000500   000000 000064   000001 006000   000000 000000    .......4........
   3     004   000012 006000   000000 006000   000003 777640   000002 377640    ................
   3     010   000004 006000   000003 006000   000005 777640   000007 777640    ................
   3     014   000005 006000   000032 777640   000013 777640   000023 777640    ................
   3     020   000101 777640   000077 777640   000012 777640   000010 777640    .A...?..........
      662    13871    3   END FORMS;
      663    13872    2   END FILL_REC;
      664    13873    1   END AFA$ACCT;

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:102  
--  Include file information  --

   XUD_UTS_M.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   JS$CP6V_C.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_PTRS_R.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AZ_SUBS_C.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   AZ_MACRO_C.:E05TOU  is referenced.
      No diagnostics issued in procedure AFA$ACCT.
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:103  

 **** Variables and constants ****

  ****  Section 001 RoData AFA$ACCT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   134-0-0/c STRC(63)    r     1 ATITLE_KEY               145-0-0/w STRC        r     1 DOMAIN_ERR
   142-0-0/c STRC(54)    r     1 FORM_KEY                   0-0-0/d STRC(1296)  r     1 FPT_JOBSTATSC
    70-0-0/d STRC(360)   r     1 FPT_PRECORDC             102-0-0/d STRC(504)   r     1 FPT_READC
   120-0-0/d STRC(432)   r     1 FPT_WRITEC               144-0-0/w STRC        r     1 LD_ERR
   136-0-0/c STRC(54)    r     1 LIMIT_KEY                141-0-0/c STRC        r     1 RES_KEY
   140-0-0/c STRC        r     1 SUDO_KEY                  44-0-0/d STRC(702)   r     1 VLP_CRITERIAC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/c STRC(90)    r     1 ACCT_KEY                  17-0-0/w UBIN        r     1 CUR_CPU
    22-0-0/w UBIN        r     1 CUR_UTS                   27-0-0/w SBIN        r     1 DTIME
    33-0-0/w PTR         r     1 FORM1$                    37-0-0/w BIT         r     1 FOUND
    20-0-0/w PTR         r     1 FPT$                      34-0-0/w SBIN        r     1 FRMS
    34-0-0/w SBIN        r     1 I                         35-0-0/w SBIN        r     1 I
    34-0-0/w PTR         r     1 I$                         3-0-0/c STRC(288)   r     1 IN_KEY
    36-0-0/w SBIN        r     1 J                         23-0-0/w PTR         r     1 JIT$
    15-0-0/w UBIN        r     1 RECLEN                    33-0-0/w PTR         r     1 RES$
    14-0-0/w UBIN        r     1 STARS_DA                  33-0-0/w PTR         r     1 SUDO$
    16-0-0/w UBIN        r     1 TEMP                      13-0-0/w UBIN        r     1 TYP
    33-0-0/w PTR         r     1 VLA$                      21-0-0/w PTR         r     1 VLP$
    34-0-0/w PTR         r     1 VLR$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:104  
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS$(0:19)
     0-0-0/w PTR         r     1 B$SBUF2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(972)   r     1 CP_LIMREC
     0-0-0/w STRC(441)   r     1 FORM1(0:0)                 0-0-0/w STRC(324)   r     1 FORM_REC
     0-0-0/w STRC(72)    r     1 FPT$ACCT_V                 0-0-0/d STRC(360)   r     1 FPT$PRECORD
     0-0-0/d STRC(504)   r     1 FPT$READ                   0-0-0/d STRC(432)   r     1 FPT$WRITE
     0-0-0/d STRC(1296)  r     1 FPT_JOBSTATS               0-0-0/w STRC(3492)  r     1 JSP
     0-0-0/c ACHR        r     1 OUT$BUF                    0-0-0/w STRC(324)   r     1 RES(0:0)
     0-0-0/w CHAR(24)    r     1 RES_ID                     0-0-0/w STRC(396)   r     1 RES_TIME
     0-0-0/w STRC(180)   r     1 SUDO(0:0)
     0-0-0/w STRC(288)   r     1 SUDO_TIME(0:7)
     0-0-0/c ASTR(9)     r     1 TEXT$C                     0-0-0/w UBIN        r     1 UBIN$WORD
     0-0-0/w STRC(2304)  r     1 VLA$JOBSTATS$ISRCH         0-0-0/d STRC(702)   r     1 VLP_CRITERIA
     0-0-0/d STRC(2376)  r     1 VLR_JOBSTATS_ISRCH


   Procedure AFA$ACCT requires 1247 words for executable code.
   Procedure AFA$ACCT requires 36 words of local(AUTO) storage.

    No errors detected in file AFA$ACCT.:E05TSI    .
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:105  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:106  
          MINI XREF LISTING

ACCT_KEY
     12279**DCL     13069--ASSIGN  13084--ASSIGN
ACCT_KEY.ACCT#
     12282**DCL     13070<<ASSIGN
ACCT_KEY.AREC_TYPE
     12281**DCL     12282--REDEF
ACCT_KEY.L
     12280**DCL     13069<<ASSIGN
ACCT_KEY.PROC#
     12296**DCL     13074<<ASSIGN  13076<<ASSIGN  13078<<ASSIGN
ACCT_KEY.STEP#
     12290**DCL     13071<<ASSIGN
ACCT_KEY.TYPE#
     12310**DCL     13081<<ASSIGN
ACCT_KEY.UTS#
     12304**DCL     13080<<ASSIGN
ATITLE_ALT IN PROCEDURE FILL_REC
     13179**LABEL   13177--CALLALT
ATITLE_KEY
     12141**DCL     13175>>ASSIGN
B$ALT.CODE
     11803**DCL     11803--REDEF   11804--REDEF   11804--REDEF
B$ALT.ERR.ERR#
     11805**DCL     11805--REDEF
B$ALT.EVID
     11804**DCL     11804--REDEF   11804--REDEF
B$JIT.ACCESS.FORMS
     11790**DCL     13129>>ASSIGN
B$JIT.ACCESS.PACKS
     11790**DCL     13128>>ASSIGN
B$JIT.ACCESS.TAPES
     11790**DCL     13127>>ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:107  
B$JIT.ACCN
     11522**DCL     13136>>ASSIGN
B$JIT.CALCNT
     11696**DCL     13134>>ASSIGN
B$JIT.CPFLAGS1
     11611**DCL     13065<<ASSIGN  13065>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
     11616**DCL     11616--REDEF
B$JIT.CURPNUM
     11776**DCL     13074>>ASSIGN
B$JIT.CURTMPDP
     11691**DCL     13126<>CALL
B$JIT.ERR
     11522**DCL     13018<<ASSIGN  13030<<ASSIGN  13097<<ASSIGN  13181<<ASSIGN  13287<<ASSIGN  13467<<ASSIGN
     13605<<ASSIGN  13676<<ASSIGN  13817<<ASSIGN  13861<<ASSIGN
B$JIT.ERR.CODE
     11523**DCL     13031<<ASSIGN  13179>>IF      13285>>IF      13465>>IF      13465>>IF      13604>>IF
     13673>>IF      13673>>IF      13673>>IF      13816>>IF      13859>>IF      13859>>IF
B$JIT.ERR.MID
     11523**DCL     11523--REDEF
B$JIT.EXTUS
     11698**DCL     13117>>ASSIGN
B$JIT.INTER
     11789**DCL     13133>>ASSIGN
B$JIT.JOBNAME
     11671**DCL     13150>>ASSIGN
B$JIT.JOBUNIT
     11611**DCL     13193>>ASSIGN
B$JIT.JORG
     11658**DCL     13142>>ASSIGN
B$JIT.JPEAK
     11684**DCL     13195>>ASSIGN
B$JIT.JRESPEAK
     11684**DCL     11685--REDEF   13197>>ASSIGN
B$JIT.JTMPDPPK
     11691**DCL     13196>>ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:108  
B$JIT.LOGONTIME
     11659**DCL     13194>>ASSIGN  13216>>ASSIGN
B$JIT.MODE
     11517**DCL     13139>>ASSIGN  13214>>IF
B$JIT.MOUNTS
     11790**DCL     13130>>ASSIGN  13131>>ASSIGN  13132>>ASSIGN
B$JIT.ORIGINATOR_MODE
     11789**DCL     13149>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
     11793**DCL     11793--REDEF   11794--REDEF
B$JIT.PMEMTIM
     11696**DCL     13123>>ASSIGN
B$JIT.PNR
     11697**DCL     11697--REDEF
B$JIT.PRDPRM
     11691**DCL     13277>>ASSIGN  13281>>ASSIGN  13288>>ASSIGN
B$JIT.SPEAK
     11684**DCL     13204>>ASSIGN
B$JIT.SRESPEAK
     11685**DCL     13206>>ASSIGN
B$JIT.STAR.DA
     11690**DCL     13041>>ASSIGN  13043<<ASSIGN  13043>>ASSIGN  13107<<ASSIGN
B$JIT.STDLOPGS
     11790**DCL     13797>>IF      13800>>ASSIGN
B$JIT.STEPCC
     11749**DCL     13143>>ASSIGN
B$JIT.STEPS
     11743**DCL     13141>>ASSIGN  13809>>ASSIGN
B$JIT.STEPUNIT
     11611**DCL     13200>>ASSIGN
B$JIT.STIME
     11695**DCL     13119>>ASSIGN
B$JIT.STMPDPPK
     11691**DCL     13205>>ASSIGN
B$JIT.SVTUS
     11698**DCL     13119>>ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:109  
B$JIT.SYSID
     11522**DCL     13140>>ASSIGN  13367>>ASSIGN  13368>>ASSIGN
B$JIT.TMPGAC.N
     11691**DCL     13126<>CALL
B$JIT.TMPGAC.TIME
     11691**DCL     13125<>CALL
B$JIT.TPEXT
     11696**DCL     13117>>ASSIGN
B$JIT.TPSVT
     11696**DCL     13119>>ASSIGN
B$JIT.TSLINE
     11791**DCL     11792--REDEF   13148>>ASSIGN
B$JIT.TUEXT
     11696**DCL     13118>>ASSIGN
B$JIT.TUSVT
     11696**DCL     13120>>ASSIGN
B$JIT.UMEMTIM
     11696**DCL     13124>>ASSIGN
B$JIT.UNAME
     11522**DCL     13137>>ASSIGN
B$JIT.USER
     11522**DCL     13013>>IF
B$JIT.USRRNST
     11658**DCL     13144>>ASSIGN  13145>>IF
B$JIT.WOO
     11522**DCL     13138>>ASSIGN  13804>>ASSIGN
B$JIT.XLIMFLG
     11753**DCL     13147>>ASSIGN
B$JIT.XTIME
     11695**DCL     13117>>ASSIGN
B$JIT$
     12326**DCL     13013>>IF      13018>>ASSIGN  13030>>ASSIGN  13031>>ASSIGN  13041>>ASSIGN  13043>>ASSIGN
     13049>>ASSIGN  13097>>ASSIGN  13107>>ASSIGN  13179>>IF      13181>>ASSIGN  13285>>IF      13287>>ASSIGN
     13465>>IF      13465>>IF      13467>>ASSIGN  13604>>IF      13605>>ASSIGN  13673>>IF      13673>>IF
     13673>>IF      13676>>ASSIGN  13816>>IF      13817>>ASSIGN  13859>>IF      13859>>IF      13861>>ASSIGN
B$PS$
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:110  
      3820**DCL     13008>>ASSIGN  13013>>IF      13039>>ASSIGN  13040>>ASSIGN  13062>>IF      13092>>ASSIGN
     13100>>ASSIGN  13209>>ASSIGN  13209>>ASSIGN
B$SBUF2$
     12325**DCL     12328--IMP-PTR 12350--IMP-PTR 13005>>ASSIGN  13071>>ASSIGN  13086>>ASSIGN  13100>>ASSIGN
     13116>>ASSIGN  13117>>ASSIGN  13118>>ASSIGN  13119>>ASSIGN  13120>>ASSIGN  13121>>ASSIGN  13121>>ASSIGN
     13121>>ASSIGN  13121>>ASSIGN  13122>>ASSIGN  13123>>ASSIGN  13124>>ASSIGN  13126>>CALL    13127>>ASSIGN
     13128>>ASSIGN  13129>>ASSIGN  13130>>ASSIGN  13131>>ASSIGN  13132>>ASSIGN  13133>>ASSIGN  13134>>ASSIGN
     13135>>ASSIGN  13136>>ASSIGN  13137>>ASSIGN  13138>>ASSIGN  13139>>ASSIGN  13140>>ASSIGN  13141>>ASSIGN
     13142>>ASSIGN  13143>>ASSIGN  13144>>ASSIGN  13147>>ASSIGN  13148>>ASSIGN  13149>>ASSIGN  13150>>ASSIGN
     13151>>CALLBLT 13152>>ASSIGN  13158>>ASSIGN  13160>>ASSIGN  13162>>ASSIGN  13164>>ASSIGN  13169>>ASSIGN
     13176>>ASSIGN  13193>>ASSIGN  13194>>ASSIGN  13195>>ASSIGN  13196>>ASSIGN  13197>>ASSIGN  13200>>ASSIGN
     13201>>ASSIGN  13204>>ASSIGN  13205>>ASSIGN  13206>>ASSIGN  13209>>ASSIGN  13216>>ASSIGN  13277>>ASSIGN
     13281>>ASSIGN  13288>>ASSIGN  13375>>ASSIGN  13376>>ASSIGN  13378>>ASSIGN  13379>>ASSIGN  13380>>ASSIGN
     13381>>ASSIGN  13430>>ASSIGN  13435>>ASSIGN  13436>>ASSIGN  13438>>ASSIGN  13440>>ASSIGN  13442>>ASSIGN
     13442>>ASSIGN  13449>>ASSIGN  13450>>ASSIGN  13452>>ASSIGN  13454>>ASSIGN  13456>>ASSIGN  13456>>ASSIGN
     13459>>IF      13461>>ASSIGN  13462>>ASSIGN  13616>>ASSIGN  13633>>ASSIGN  13648>>ASSIGN  13648>>ASSIGN
     13657>>CALL    13657>>CALL    13659>>ASSIGN  13659>>ASSIGN  13661>>CALL    13661>>CALL    13663>>ASSIGN
     13663>>ASSIGN  13665>>CALL    13665>>CALL    13667>>ASSIGN  13667>>ASSIGN  13680>>IF      13682>>ASSIGN
     13683>>ASSIGN  13796>>ASSIGN  13805>>ASSIGN  13831>>DOWHILE 13842>>ASSIGN  13842>>ASSIGN  13851>>DOINDEX
     13854>>ASSIGN  13854>>ASSIGN  13865>>IF      13867>>ASSIGN  13868>>ASSIGN
CP_LIMREC IN PROCEDURE PRDPUSED
     13235**DCL     13273--ASSIGN
CP_LIMREC.CUMUL.PRDPRM IN PROCEDURE PRDPUSED
     13269**DCL     13277>>ASSIGN  13281>>ASSIGN
CP_LIMREC.CUR_MAX.PRDPRM IN PROCEDURE PRDPUSED
     13252**DCL     13277>>ASSIGN
CP_LIMREC.STEP_MAX.PRDPRM IN PROCEDURE PRDPUSED
     13261**DCL     13275>>IF      13281>>ASSIGN
CUR_CPU
     12260**DCL     13121<<ASSIGN  13440>>ASSIGN  13454>>ASSIGN  13631>>ASSIGN
CUR_UTS
     12263**DCL     13039<<ASSIGN  13048<>CALL    13080>>ASSIGN  13122>>ASSIGN  13125<>CALL    13201>>ASSIGN
     13437<>CALL    13451<>CALL    13629<>CALL
DOMAIN_ERR
     12953**DCL     13018>>ASSIGN
DTIME
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:111  
     12329**DCL     13437<>CALL    13438>>ASSIGN  13451<>CALL    13452>>ASSIGN
FGH$UPDBUCKET
     12988**DCL-ENT 13126--CALL
FILL_REC
     13111**PROC    13058--CALL
FMO$GETDOMAIN
     12989**DCL-ENT 13012--CALL
FORM1 IN PROCEDURE FORMS
     13751**DCL     13839<<ASSIGN  13841--IF      13852<<ASSIGN  13852>>ASSIGN  13868--ASSIGN
FORM1.FORMS IN PROCEDURE FORMS
     13752**DCL     13800<<ASSIGN  13847<<ASSIGN  13847>>ASSIGN  13849>>IF
FORM1.MOUNTS IN PROCEDURE FORMS
     13757**DCL     13801<<ASSIGN  13848<<ASSIGN  13848>>ASSIGN  13849>>IF
FORM1.S1 IN PROCEDURE FORMS
     13765**DCL     13833>>IF      13840<<ASSIGN
FORM1.S1.DD IN PROCEDURE FORMS
     13770**DCL     13803<<ASSIGN
FORM1.S1.FORMNAME IN PROCEDURE FORMS
     13766**DCL     13802<<ASSIGN
FORM1.S1.WSN IN PROCEDURE FORMS
     13774**DCL     13804<<ASSIGN
FORM1$ IN PROCEDURE FORMS
     13791**DCL     13751--IMP-PTR 13796<<ASSIGN  13800>>ASSIGN  13801>>ASSIGN  13802>>ASSIGN  13803>>ASSIGN
     13804>>ASSIGN  13833>>IF      13839>>ASSIGN  13840>>ASSIGN  13841>>IF      13847>>ASSIGN  13847>>ASSIGN
     13848>>ASSIGN  13848>>ASSIGN  13849>>IF      13849>>IF      13852>>ASSIGN  13852>>ASSIGN
FORMS IN PROCEDURE FILL_REC
     13688**PROC    13229--CALL
FORM_ALT IN PROCEDURE FORMS
     13859**LABEL   13827--CALLALT 13856--CALLALT
FORM_KEY
     12234**DCL     13807>>ASSIGN
FORM_KEY.AREC_TYPE
     12236**DCL     12237--REDEF
FORM_REC IN PROCEDURE FORMS
     13697**DCL     13826--ASSIGN
FORM_REC.COPIES IN PROCEDURE FORMS
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:112  
     13712**DCL     13847>>ASSIGN
FORM_REC.DDEV.LP IN PROCEDURE FORMS
     13722**DCL     13844>>IF
FORM_REC.MOUNTS IN PROCEDURE FORMS
     13698**DCL     13848>>ASSIGN
FORM_REC.PAGES IN PROCEDURE FORMS
     13708**DCL     13845>>ASSIGN
FORM_REC.RECS IN PROCEDURE FORMS
     13704**DCL     13846>>ASSIGN
FORM_REC.S1 IN PROCEDURE FORMS
     13728**DCL     13833>>IF      13840>>ASSIGN
FOUND IN PROCEDURE FORMS
     13795**DCL     13829<<ASSIGN  13831>>DOWHILE 13834<<ASSIGN  13837>>IF
FPT$
     12261**DCL     11842--IMP-PTR 11957--IMP-PTR 12023--IMP-PTR 12093--IMP-PTR 13005<<ASSIGN  13007>>ASSIGN
     13082>>ASSIGN  13083>>ASSIGN  13083>>ASSIGN  13084>>ASSIGN  13085>>ASSIGN  13086>>ASSIGN  13087>>CALL
     13170>>ASSIGN  13171>>ASSIGN  13171>>ASSIGN  13172>>ASSIGN  13173>>ASSIGN  13174>>ASSIGN  13176>>ASSIGN
     13177>>CALL    13273>>ASSIGN  13274>>CALL    13369>>ASSIGN  13370>>ASSIGN  13370>>ASSIGN  13371>>ASSIGN
     13372>>ASSIGN  13373>>CALL    13423>>ASSIGN  13424>>ASSIGN  13424>>ASSIGN  13425>>ASSIGN  13426>>ASSIGN
     13427>>ASSIGN  13428>>ASSIGN  13429>>CALL    13598>>ASSIGN  13599>>ASSIGN  13599>>ASSIGN  13600>>ASSIGN
     13601>>ASSIGN  13602>>CALL    13609>>ASSIGN  13610>>ASSIGN  13610>>ASSIGN  13611>>ASSIGN  13612>>ASSIGN
     13613>>ASSIGN  13614>>ASSIGN  13615>>CALL    13670>>CALL    13810>>ASSIGN  13811>>ASSIGN  13811>>ASSIGN
     13812>>ASSIGN  13813>>ASSIGN  13814>>CALL    13821>>ASSIGN  13822>>ASSIGN  13822>>ASSIGN  13823>>ASSIGN
     13824>>ASSIGN  13825>>ASSIGN  13826>>ASSIGN  13827>>CALL    13856>>CALL
FPT$ACCT_V.STAROUT
     12334**DCL     13013>>IF      13062>>IF
FPT$ACCT_V.TYP
     12334**DCL     13008>>ASSIGN
FPT$ACCT_V.UTS
     12334**DCL     13039>>ASSIGN
FPT$PRECORD
     11957**DCL     13598<<ASSIGN  13602<>CALL    13810<<ASSIGN  13814<>CALL
FPT$PRECORD.KEY_
     11957**DCL     13601<<ASSIGN  13813<<ASSIGN
FPT$PRECORD.V
     11959**DCL     13599--ASSIGN  13811--ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:113  
FPT$PRECORD.V.DCB#
     11959**DCL     13600<<ASSIGN  13812<<ASSIGN
FPT$PRECORD.V_
     11957**DCL     13599<<ASSIGN  13811<<ASSIGN
FPT$READ
     12023**DCL     13170<<ASSIGN  13177<>CALL    13274<>CALL    13423<<ASSIGN  13429<>CALL    13609<<ASSIGN
     13615<>CALL    13670<>CALL    13821<<ASSIGN  13827<>CALL    13856<>CALL
FPT$READ.BUF_
     12025**DCL     13176<<ASSIGN  13273<<ASSIGN  13428<<ASSIGN  13614<<ASSIGN  13826<<ASSIGN
FPT$READ.KEY_
     12023**DCL     13173<<ASSIGN  13426<<ASSIGN  13612<<ASSIGN  13824<<ASSIGN
FPT$READ.STATION_
     12026**DCL     12027--REDEF
FPT$READ.V
     12027**DCL     13171--ASSIGN  13424--ASSIGN  13610--ASSIGN  13822--ASSIGN
FPT$READ.V.DCB#
     12027**DCL     13172<<ASSIGN  13425<<ASSIGN  13611<<ASSIGN  13823<<ASSIGN
FPT$READ.V.DVBYTE.REREAD#
     12038**DCL     12038--REDEF
FPT$READ.V.INDX#
     12036**DCL     12036--REDEF
FPT$READ.V.KEYR#
     12028**DCL     13613<<ASSIGN  13825<<ASSIGN
FPT$READ.V.KEYS#
     12028**DCL     13174<<ASSIGN  13427<<ASSIGN
FPT$READ.V_
     12023**DCL     13171<<ASSIGN  13424<<ASSIGN  13610<<ASSIGN  13822<<ASSIGN
FPT$WRITE
     12093**DCL     13082<<ASSIGN  13087<>CALL
FPT$WRITE.BUF_
     12093**DCL     13086<<ASSIGN
FPT$WRITE.KEY_
     12093**DCL     13084<<ASSIGN
FPT$WRITE.STATION_
     12095**DCL     12095--REDEF
FPT$WRITE.V
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:114  
     12096**DCL     13083--ASSIGN
FPT$WRITE.V.DCB#
     12096**DCL     13085<<ASSIGN
FPT$WRITE.V.DVBYTE.VFC#
     12102**DCL     12102--REDEF
FPT$WRITE.V_
     12093**DCL     13083<<ASSIGN
FPT_JOBSTATS
     11842**DCL     13005--ASSIGN  13369<<ASSIGN  13373<>CALL
FPT_JOBSTATS.CRITERIA_
     11843**DCL     13371<<ASSIGN
FPT_JOBSTATS.RESULTS_
     11842**DCL     13372<<ASSIGN
FPT_JOBSTATS.V
     11846**DCL     13370--ASSIGN
FPT_JOBSTATS.V_
     11842**DCL     13370<<ASSIGN
FPT_JOBSTATSC
     11822**DCL     13369>>ASSIGN
FPT_JOBSTATSC.V
     11826**DCL     11822--DCLINIT
FPT_PRECORDC
     11936**DCL     13598>>ASSIGN  13810>>ASSIGN
FPT_PRECORDC.V
     11938**DCL     11936--DCLINIT
FPT_READC
     11984**DCL     13170>>ASSIGN  13423>>ASSIGN  13609>>ASSIGN  13821>>ASSIGN
FPT_READC.STATION_
     11987**DCL     11988--REDEF
FPT_READC.V
     11988**DCL     11984--DCLINIT
FPT_READC.V.DVBYTE.REREAD#
     11999**DCL     11999--REDEF
FPT_READC.V.INDX#
     11997**DCL     11997--REDEF
FPT_WRITEC
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:115  
     12062**DCL     13082>>ASSIGN
FPT_WRITEC.STATION_
     12064**DCL     12064--REDEF
FPT_WRITEC.V
     12065**DCL     12062--DCLINIT
FPT_WRITEC.V.DVBYTE.VFC#
     12071**DCL     12071--REDEF
FRMS IN PROCEDURE FORMS
     13792**DCL     13845<<ASSIGN  13846<<ASSIGN  13847>>ASSIGN
FRS$CLSTRS
     12991**DCL-ENT 13105--CALL
FRS$OPSTRS
     12990**DCL-ENT 13054--CALL
HFF$DSIZ
     12986**DCL-ENT 13094--CALL
HFF$NILERASE
     12987**DCL-ENT 13090--CALL    13208--CALL
I IN PROCEDURE FORMS
     13793**DCL     13830<<ASSIGN  13831>>DOWHILE 13833>>IF      13835<<ASSIGN  13835>>ASSIGN  13839>>ASSIGN
     13840>>ASSIGN  13841>>IF      13847>>ASSIGN  13847>>ASSIGN  13848>>ASSIGN  13848>>ASSIGN  13849>>IF
     13849>>IF      13851>>DOINDEX
I IN PROCEDURE SUDOS
     13421**DCL     13432<<DOINDEX 13433>>IF      13435>>ASSIGN  13436>>ASSIGN  13437>>CALL    13438>>ASSIGN
     13438>>ASSIGN  13440>>ASSIGN  13440>>ASSIGN  13440>>ASSIGN  13445<<DOINDEX 13446>>IF      13449>>ASSIGN
     13450>>ASSIGN  13451>>CALL    13452>>ASSIGN  13452>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN
I$ IN PROCEDURE RESOURCES
     13595**DCL     13633<<ASSIGN  13634>>DOWHILE 13635>>IF      13635>>IF      13638<<ASSIGN  13638>>ASSIGN
     13640>>IF      13652>>CALL    13652>>CALL    13654>>ASSIGN  13654>>ASSIGN
IN_KEY
     12107**DCL     13173--ASSIGN  13175<<ASSIGN  13272<<ASSIGN  13422<<ASSIGN  13426--ASSIGN  13597<<ASSIGN
     13601--ASSIGN  13612--ASSIGN  13807<<ASSIGN  13813--ASSIGN  13824--ASSIGN
IN_KEY.FORM_KEY.STEP
     12112**DCL     13617>>DOWHILE 13809<<ASSIGN
IN_KEY.FORM_KEY.TYPE
     12111**DCL     13617>>DOWHILE 13828>>DOWHILE
IN_KEY.KEY
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:116  
     12109**DCL     12110--REDEF
J IN PROCEDURE FORMS
     13794**DCL     13851<<DOINDEX 13852>>ASSIGN  13852>>ASSIGN
JIT$
     12264**DCL     11517--IMP-PTR 13040<<ASSIGN  13043>>ASSIGN  13049<<ASSIGN  13065>>ASSIGN  13065>>ASSIGN
     13074>>ASSIGN  13117>>ASSIGN  13117>>ASSIGN  13117>>ASSIGN  13118>>ASSIGN  13119>>ASSIGN  13119>>ASSIGN
     13119>>ASSIGN  13120>>ASSIGN  13123>>ASSIGN  13124>>ASSIGN  13125>>CALL    13126>>CALL    13126>>CALL
     13127>>ASSIGN  13128>>ASSIGN  13129>>ASSIGN  13130>>ASSIGN  13131>>ASSIGN  13132>>ASSIGN  13133>>ASSIGN
     13134>>ASSIGN  13136>>ASSIGN  13137>>ASSIGN  13138>>ASSIGN  13139>>ASSIGN  13140>>ASSIGN  13141>>ASSIGN
     13142>>ASSIGN  13143>>ASSIGN  13144>>ASSIGN  13145>>IF      13147>>ASSIGN  13148>>ASSIGN  13149>>ASSIGN
     13150>>ASSIGN  13193>>ASSIGN  13194>>ASSIGN  13195>>ASSIGN  13196>>ASSIGN  13197>>ASSIGN  13200>>ASSIGN
     13204>>ASSIGN  13205>>ASSIGN  13206>>ASSIGN  13214>>IF      13216>>ASSIGN  13277>>ASSIGN  13281>>ASSIGN
     13288>>ASSIGN  13367>>ASSIGN  13368>>ASSIGN  13797>>IF      13800>>ASSIGN  13804>>ASSIGN  13809>>ASSIGN
JOBSTATS IN PROCEDURE FILL_REC
     13293**PROC    13215--CALL
JSP
     12350**DCL     13115--ASSIGN  13116<<ASSIGN  13461--ASSIGN
JSP.ACCESS_FORM
     12781**DCL     12782--REDEF
JSP.ACCESS_PACKS
     12774**DCL     12775--REDEF
JSP.ACCESS_TAPE
     12767**DCL     12768--REDEF
JSP.ACCN
     12356**DCL     12357--REDEF
JSP.ACCT
     12357**DCL     13136<<ASSIGN
JSP.ATITLE
     12380**DCL     13169<<ASSIGN  13176--ASSIGN
JSP.CODE
     12351**DCL     13135<<ASSIGN
JSP.CUR_UTS
     12412**DCL     13122<<ASSIGN
JSP.DPACCESS
     12775**DCL     13128<<ASSIGN
JSP.DPMOUNT
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:117  
     12793**DCL     13131<<ASSIGN
JSP.DPTIM_CLK
     12731**DCL     13657<>CALL    13657<>CALL
JSP.DPTIM_CPU
     12749**DCL     13659<<ASSIGN  13659>>ASSIGN
JSP.FLG
     12566**DCL     13376<<ASSIGN
JSP.FORMX
     12873**DCL     13867<<ASSIGN
JSP.FORM_CNT
     12879**DCL     13805<<ASSIGN  13831>>DOWHILE 13842<<ASSIGN  13842>>ASSIGN  13851>>DOINDEX 13854<<ASSIGN
     13854>>ASSIGN  13865>>IF      13868>>ASSIGN
JSP.HOLD_UTS
     12406**DCL     13378<<ASSIGN
JSP.JOBNAME.C
     12375**DCL     13150<<ASSIGN  13151>>CALLBLT
JSP.JOBNAME.L
     12374**DCL     13152<<ASSIGN
JSP.JORG
     12545**DCL     13142<<ASSIGN
JSP.JSPEAK
     12526**DCL     12527--REDEF
JSP.JSUNITS
     12832**DCL     13193<<ASSIGN  13200<<ASSIGN
JSP.MODE
     12439**DCL     13139<<ASSIGN
JSP.MTACCESS
     12768**DCL     13127<<ASSIGN
JSP.MTMOUNT
     12788**DCL     13130<<ASSIGN
JSP.MTTIM_CLK
     12725**DCL     13661<>CALL    13661<>CALL
JSP.MTTIM_CPU
     12743**DCL     13663<<ASSIGN  13663>>ASSIGN
JSP.ORACCESS
     12782**DCL     13129<<ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:118  
JSP.ORIGINATOR_MODE
     12497**DCL     13149<<ASSIGN
JSP.ORIGINATOR_PORT.FROM_CR
     12639**DCL     12653--REDEF   12665--REDEF
JSP.ORMOUNT
     12798**DCL     13132<<ASSIGN
JSP.ORTIM_CLK
     12737**DCL     13665<>CALL    13665<>CALL
JSP.ORTIM_CPU
     12755**DCL     13667<<ASSIGN  13667>>ASSIGN
JSP.PART#
     12426**DCL     13380<<ASSIGN
JSP.PART_MASK
     12432**DCL     13381<<ASSIGN
JSP.PEXEC
     12812**DCL     13117<<ASSIGN  13121>>ASSIGN
JSP.PKCO
     12527**DCL     13195<<ASSIGN  13204<<ASSIGN
JSP.PMEMTIM
     12715**DCL     13123<<ASSIGN
JSP.PMMES
     12807**DCL     13134<<ASSIGN
JSP.PRDPUSED
     12689**DCL     13277<<ASSIGN  13281<<ASSIGN  13288<<ASSIGN
JSP.PRIO
     12420**DCL     13379<<ASSIGN
JSP.PROCNAME
     12470**DCL     13209<<ASSIGN
JSP.PSTIME
     12822**DCL     13119<<ASSIGN  13121>>ASSIGN
JSP.RESPEAK
     12518**DCL     13197<<ASSIGN  13206<<ASSIGN
JSP.RESX
     12862**DCL     13682<<ASSIGN
JSP.RES_CNT
     12868**DCL     13648<<ASSIGN  13648>>ASSIGN  13680>>IF      13683>>ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:119  
JSP.RNST
     12554**DCL     13144<<ASSIGN
JSP.START
     12391**DCL     13194<<ASSIGN  13201<<ASSIGN
JSP.STEP
     12538**DCL     13071>>ASSIGN  13141<<ASSIGN
JSP.STEPCC
     12548**DCL     13143<<ASSIGN
JSP.SUBMIT
     12385**DCL     13216<<ASSIGN  13375<<ASSIGN
JSP.SUDOX
     12851**DCL     13461<<ASSIGN
JSP.SUDO_CNT
     12857**DCL     13435>>ASSIGN  13436>>ASSIGN  13438>>ASSIGN  13440>>ASSIGN  13442<<ASSIGN  13442>>ASSIGN
     13449>>ASSIGN  13450>>ASSIGN  13452>>ASSIGN  13454>>ASSIGN  13456<<ASSIGN  13456>>ASSIGN  13459>>IF
     13462>>ASSIGN
JSP.SYSID
     12466**DCL     13140<<ASSIGN
JSP.TINTER
     12803**DCL     13133<<ASSIGN
JSP.TMDPPK
     12678**DCL     13196<<ASSIGN  13205<<ASSIGN
JSP.TSLINE
     12595**DCL     12633--REDEF   13148<<ASSIGN
JSP.TYPE
     12444**DCL     13158<<ASSIGN  13160<<ASSIGN  13162<<ASSIGN  13164<<ASSIGN
JSP.UEXEC
     12817**DCL     13118<<ASSIGN  13121>>ASSIGN
JSP.UFTPS
     12708**DCL     13126<>CALL
JSP.UMEMTIM
     12720**DCL     13124<<ASSIGN
JSP.UNAME
     12363**DCL     12364--REDEF
JSP.USERNAME
     12364**DCL     13137<<ASSIGN
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:120  
JSP.USTIME
     12827**DCL     13120<<ASSIGN  13121>>ASSIGN
JSP.WOO
     12376**DCL     13138<<ASSIGN
JSP.XLIMFLG
     12560**DCL     13147<<ASSIGN
JUSTALT IN PROCEDURE FILL_REC
     13231**LABEL   13187--CALLALT 13220--CALLALT 13224--CALLALT 13229--CALLALT
JUSTALT IN PROCEDURE JOBSTATS
     13383**LABEL   13373--CALLALT
JUSTRET
     13105**LABEL   13058--CALLALT 13087--CALLALT 13098--GOTO
LD_ERR
     12903**DCL     13030>>ASSIGN  13097>>ASSIGN
LIMIT_KEY
     12170**DCL     13272>>ASSIGN
LIMREC_ALT IN PROCEDURE PRDPUSED
     13285**LABEL   13274--CALLALT
M$MJOBSTATS
     12994**DCL-ENT 13373--CALL
M$MPRECORD
     12995**DCL-ENT 13602--CALL    13814--CALL
M$MREAD
     12996**DCL-ENT 13177--CALL    13274--CALL    13429--CALL    13615--CALL    13670--CALL    13827--CALL
     13856--CALL
M$MWRITE
     12997**DCL-ENT 13087--CALL
MME$WFVP
     12992**DCL-ENT 13108--CALL
MME$WGVP
     12993**DCL-ENT 13027--CALL
NO_PAGE
     13030**LABEL   13027--CALLALT
NO_PNAME IN PROCEDURE FILL_REC
     13210**LABEL   13208--CALLALT
NO_SUDOS IN PROCEDURE SUDOS
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:121  
     13465**LABEL   13429--CALLALT
OUT$BUF
     12328**DCL     13086--ASSIGN  13100<<ASSIGN  13100>>ASSIGN
PRDPUSED IN PROCEDURE FILL_REC
     13233**PROC    13187--CALL
PREC_ALT IN PROCEDURE FORMS
     13816**LABEL   13814--CALLALT
PREC_ALT IN PROCEDURE RESOURCES
     13604**LABEL   13602--CALLALT
RECLEN
     12257**DCL     12328--IMP-SIZ 13086>>ASSIGN  13092>>ASSIGN  13095>>IF      13100>>ASSIGN  13100>>ASSIGN
     13115<<ASSIGN  13430>>ASSIGN  13462<<ASSIGN  13462>>ASSIGN  13616>>ASSIGN  13633>>ASSIGN  13682>>ASSIGN
     13683<<ASSIGN  13683>>ASSIGN  13796>>ASSIGN  13867>>ASSIGN  13868<<ASSIGN  13868>>ASSIGN
RES IN PROCEDURE RESOURCES
     13543**DCL     13638--ASSIGN  13647--ASSIGN  13683--ASSIGN
RES.CLOCK IN PROCEDURE RESOURCES
     13554**DCL     13644<<ASSIGN  13652<>CALL    13652<>CALL
RES.CPU IN PROCEDURE RESOURCES
     13560**DCL     13645<<ASSIGN  13654<<ASSIGN  13654>>ASSIGN
RES.TYPE IN PROCEDURE RESOURCES
     13544**DCL     13635>>IF      13642<<ASSIGN
RES.WSN IN PROCEDURE RESOURCES
     13566**DCL     13635--IF      13643--ASSIGN
RES$ IN PROCEDURE RESOURCES
     13594**DCL     13543--IMP-PTR 13616<<ASSIGN  13634>>DOWHILE 13640>>IF      13642>>ASSIGN  13643>>ASSIGN
     13644>>ASSIGN  13645>>ASSIGN  13646>>IF      13647<<ASSIGN  13647>>ASSIGN
RESOURCES IN PROCEDURE FILL_REC
     13474**PROC    13224--CALL
RES_ALT IN PROCEDURE RESOURCES
     13673**LABEL   13615--CALLALT 13670--CALLALT
RES_ID IN PROCEDURE RESOURCES
     13596**DCL     13635>>IF      13635>>IF      13643<<ASSIGN  13643>>ASSIGN
RES_KEY
     12202**DCL     13597>>ASSIGN
RES_KEY.AREC_TYPE
     12204**DCL     12205--REDEF
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:122  
RES_TIME IN PROCEDURE RESOURCES
     13483**DCL     13614--ASSIGN
RES_TIME.LOGNAME IN PROCEDURE RESOURCES
     13513**DCL     13517--REDEF
RES_TIME.REL.CLOCK IN PROCEDURE RESOURCES
     13498**DCL     13619>>IF      13622<>CALL
RES_TIME.REL.CPU IN PROCEDURE RESOURCES
     13503**DCL     13624>>ASSIGN
RES_TIME.START.CLOCK IN PROCEDURE RESOURCES
     13489**DCL     13622<>CALL    13622<>CALL    13629<>CALL    13629<>CALL    13650>>IF      13652<>CALL
     13657<>CALL    13661<>CALL    13665<>CALL
RES_TIME.START.CPU IN PROCEDURE RESOURCES
     13493**DCL     13624<<ASSIGN  13624>>ASSIGN  13631<<ASSIGN  13631>>ASSIGN  13654>>ASSIGN  13659>>ASSIGN
     13663>>ASSIGN  13667>>ASSIGN
RES_TIME.TYPE IN PROCEDURE RESOURCES
     13484**DCL     13635>>IF      13642>>ASSIGN  13655>>DOCASE
RES_TIME.WSN IN PROCEDURE RESOURCES
     13508**DCL     13635--IF      13643--ASSIGN
SSS$CURTIME
     12998**DCL-ENT 13048--CALL
STARS_DA
     12256**DCL     13041<<ASSIGN  13107>>ASSIGN
SUDO IN PROCEDURE SUDOS
     13395**DCL     13462--ASSIGN
SUDO.CLOCK IN PROCEDURE SUDOS
     13412**DCL     13438<<ASSIGN  13452<<ASSIGN
SUDO.CPU IN PROCEDURE SUDOS
     13406**DCL     13440<<ASSIGN  13454<<ASSIGN
SUDO.MAX IN PROCEDURE SUDOS
     13400**DCL     13436<<ASSIGN  13450<<ASSIGN
SUDO.NAM IN PROCEDURE SUDOS
     13396**DCL     13435<<ASSIGN  13449<<ASSIGN
SUDO$ IN PROCEDURE SUDOS
     13420**DCL     13395--IMP-PTR 13430<<ASSIGN  13435>>ASSIGN  13436>>ASSIGN  13438>>ASSIGN  13440>>ASSIGN
     13449>>ASSIGN  13450>>ASSIGN  13452>>ASSIGN  13454>>ASSIGN
SUDOS IN PROCEDURE FILL_REC
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:123  
     13386**PROC    13220--CALL
SUDO_KEY
     12174**DCL     13422>>ASSIGN
SUDO_TIME
     11885**DCL     13007--ASSIGN  13428--ASSIGN
SUDO_TIME.ACTIVE
     11890**DCL     13438>>ASSIGN  13440>>ASSIGN  13446>>IF      13450>>ASSIGN  13452>>ASSIGN  13454>>ASSIGN
SUDO_TIME.CLOCK.INTEGRAL
     11913**DCL     13438>>ASSIGN  13452>>ASSIGN
SUDO_TIME.CLOCK.LAST
     11918**DCL     13437<>CALL    13451<>CALL
SUDO_TIME.CPU.INTEGRAL
     11901**DCL     13440>>ASSIGN  13454>>ASSIGN
SUDO_TIME.CPU.LAST
     11907**DCL     13440>>ASSIGN  13454>>ASSIGN
SUDO_TIME.JMAX
     11895**DCL     13433>>IF      13436>>ASSIGN
SUDO_TIME.NAM
     11886**DCL     13435>>ASSIGN  13449>>ASSIGN
TEMP
     12259**DCL     13012<>CALL    13013>>IF      13013>>IF      13027<>CALL    13031>>ASSIGN  13094<>CALL
     13095>>IF      13108<>CALL    13108<>CALL    13125<>CALL    13126<>CALL    13151<<CALLBLT 13152>>ASSIGN
TEXT$C
     12330**DCL     13209>>ASSIGN
TEXT$C.L
     12331**DCL     12332--IMP-SIZ 13209>>ASSIGN
TYP
     12255**DCL     13008<<ASSIGN  13013>>IF      13037>>IF      13064>>IF      13072>>DOCASE  13081>>ASSIGN
     13106>>IF      13156>>DOCASE  13191>>IF      13191>>IF      13202>>IF      13431>>IF      13431>>IF
     13808>>IF      13808>>IF      13808>>IF      13808>>IF
UBIN$WORD
     12327**DCL     13092<<ASSIGN
VLA$ IN PROCEDURE JOBSTATS
     13363**DCL     13347--IMP-PTR 13374<<ASSIGN  13375>>ASSIGN  13376>>ASSIGN  13377>>IF      13378>>ASSIGN
     13379>>ASSIGN  13380>>ASSIGN  13381>>ASSIGN
VLA$JOBSTATS$ISRCH.FLG IN PROCEDURE JOBSTATS
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:124  
     13351**DCL     13376>>ASSIGN
VLA$JOBSTATS$ISRCH.FLG.RA IN PROCEDURE JOBSTATS
     13354**DCL     13377>>IF
VLA$JOBSTATS$ISRCH.IPRIO IN PROCEDURE JOBSTATS
     13350**DCL     13379>>ASSIGN
VLA$JOBSTATS$ISRCH.PART IN PROCEDURE JOBSTATS
     13349**DCL     13381>>ASSIGN
VLA$JOBSTATS$ISRCH.PNUM IN PROCEDURE JOBSTATS
     13349**DCL     13380>>ASSIGN
VLA$JOBSTATS$ISRCH.RATIM IN PROCEDURE JOBSTATS
     13357**DCL     13378>>ASSIGN
VLA$JOBSTATS$ISRCH.SUBMIT_TIME IN PROCEDURE JOBSTATS
     13351**DCL     13375>>ASSIGN
VLP$
     12262**DCL     11885--IMP-PTR 13007<<ASSIGN  13235--IMP-PTR 13273>>ASSIGN  13275>>IF      13277>>ASSIGN
     13277>>ASSIGN  13281>>ASSIGN  13281>>ASSIGN  13306--IMP-PTR 13365>>ASSIGN  13366>>ASSIGN  13367>>ASSIGN
     13368>>ASSIGN  13371>>ASSIGN  13428>>ASSIGN  13433>>IF      13435>>ASSIGN  13436>>ASSIGN  13437>>CALL
     13438>>ASSIGN  13438>>ASSIGN  13440>>ASSIGN  13440>>ASSIGN  13440>>ASSIGN  13446>>IF      13449>>ASSIGN
     13450>>ASSIGN  13451>>CALL    13452>>ASSIGN  13452>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN  13454>>ASSIGN
     13483--IMP-PTR 13614>>ASSIGN  13619>>IF      13622>>CALL    13622>>CALL    13622>>CALL    13624>>ASSIGN
     13624>>ASSIGN  13624>>ASSIGN  13629>>CALL    13629>>CALL    13631>>ASSIGN  13631>>ASSIGN  13635>>IF
     13635>>IF      13642>>ASSIGN  13643>>ASSIGN  13646>>IF      13650>>IF      13652>>CALL    13654>>ASSIGN
     13655>>DOCASE  13657>>CALL    13659>>ASSIGN  13661>>CALL    13663>>ASSIGN  13665>>CALL    13667>>ASSIGN
     13697--IMP-PTR 13826>>ASSIGN  13833>>IF      13840>>ASSIGN  13841>>IF      13844>>IF      13845>>ASSIGN
     13846>>ASSIGN  13847>>ASSIGN  13848>>ASSIGN
VLP_CRITERIA IN PROCEDURE JOBSTATS
     13306**DCL     13366<<ASSIGN  13371--ASSIGN
VLP_CRITERIA.SYSID# IN PROCEDURE JOBSTATS
     13311**DCL     13367<<ASSIGN
VLP_CRITERIA.SYSID1# IN PROCEDURE JOBSTATS
     13311**DCL     13368<<ASSIGN
VLP_CRITERIAC
     11863**DCL     13366>>ASSIGN
VLR$ IN PROCEDURE JOBSTATS
     13364**DCL     13333--IMP-PTR 13365<<ASSIGN  13372>>ASSIGN  13374>>ASSIGN
VLR_JOBSTATS_ISRCH IN PROCEDURE JOBSTATS
PL6.E3A0      #001=AFA$ACCT File=AFA$ACCT.:E05TSI                                TUE 07/29/97 08:24 Page:125  
     13333**DCL     13365--ASSIGN  13372--ASSIGN
VLR_JOBSTATS_ISRCH.J IN PROCEDURE JOBSTATS
     13333**DCL     13374--ASSIGN
XUD$UTS_DIFF
     11469**DCL-ENT 13125--CALL    13437--CALL    13451--CALL    13622--CALL    13629--CALL    13652--CALL
     13657--CALL    13661--CALL    13665--CALL
