
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZIM$JSET: PROC(RECVAR$,EIS,NEWP)
        7        7               AVOID($PR5,$PR6,$PR7);
        8        8        %INCLUDE ZI$GLOBAL;
        9      494            %GLOBALS;
       10      802            %ADSC;
       11      814            %BUFFERS;
       12      829        %INCLUDE ZI$DBCB;
       13     1471            %RECVAR(STCLASS="BASED(RECVAR$)");
       14     1505            %AWS;
       15     1545        %INCLUDE ZI$JRNL;
       16     1653            %JRNL_REC(STCLASS=AUTO);
       17     1728        %INCLUDE CP_6;
       18     1809            %B$TCB;
       19     1812            %B$ALT;
       20     1820            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
       21     1851            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
       22     1870        %INCLUDE CP_6_SUBS;
       23     2410        %INCLUDE B_ERRORS_C;
       24     3537        %INCLUDE B$JIT;
       25     3827        %INCLUDE ZI_ERRORS_C;
       26     4153    1   DCL RECVAR$ PTR;
       27     4154    1   DCL EIS UBIN(36);
       28     4155    1   DCL OLDP UBIN(36);
       29     4156    1   DCL COLDP REDEF OLDP CHAR(4);
       30     4157    1   DCL NEWP UBIN(36);
       31     4158    1   DCL CNEWP REDEF NEWP CHAR(4);
       32     4159    1   DCL LENGTH UBIN(36);
       33     4160    1   DCL OFFSET UBIN(36);
       34     4161    1   DCL SETP CHAR(LENGTH) BASED UNAL;
       35     4162    1   DCL ERROR UBIN(36);
       36     4163    1   DCL WRTJ$ PTR;
       37     4164    1   DCL SET$ PTR;
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:2    
       38     4165    1   DCL B$JIT$ PTR SYMREF;
       39     4166    1   DCL B$TCB$ PTR SYMREF;
       40     4167    1       ERROR=0;
       41     4168    1       LENGTH=ADDR(EIS)->ADSC.N;
       42     4169    1       OFFSET=BITBIN(ADDR(EIS)->ADSC.OFFSET);
       43     4170    1       OLDP=0;
       44     4171    1       SET$=PINCRC(RECVAR.RADDR$,OFFSET);
       45     4172    1       CALL INSERT(COLDP,4-LENGTH,LENGTH,SET$->SETP);
       46     4173    1       SET$->SETP=SUBSTR(CNEWP,4-LENGTH,LENGTH);
       47     4174        /*       Now write journal records */
       48     4175    1       AWS$=RECVAR.AWS$;
       49     4176    1       IF ~GLOBAL.PENDING.ROLL AND
       50     4177    1          (AWS.ATRIB.CJRNL OR AWS.ATRIB.TJRNL) THEN
       51     4178    2       DO;
       52     4179    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
       53     4180    2           JRNL$=ADDR(GLOBAL.JRECORD);
       54     4181    2           JREC.TYPE=T#MSET;
       55     4182    2           JREC.TIME=GLOBAL.TIME.TSTAMP;
       56     4183    2           JREC.USER#=B$JIT$->B$JIT.USER;
       57     4184    2           JREC.DCB#=AWS.DDCB;
       58     4185    2           JREC.PAGE=PINCRW(RECVAR.BADDR$,-3)->BLOCK.PGNO;
       59     4186    2           JREC.LENGTH=LENGTH;
       60     4187    2           JREC.LINE=0;
       61     4188    2           JREC.OFFSET=POFFC(SET$,RECVAR.BADDR$);
       62     4189    2           WRTJ$=GLOBAL.WRTJ$;
       63     4190    2           FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
       64     4191    2           IF AWS.ATRIB.CJRNL THEN
       65     4192    3           DO;
       66     4193    3               JREC.VALUE=SUBSTR(CNEWP,4-LENGTH,LENGTH);
       67     4194    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
       68     4195    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
       69     4196    3               END;
       70     4197    2           IF AWS.ATRIB.TJRNL THEN
       71     4198    3           DO;
       72     4199    3               JREC.VALUE=SUBSTR(COLDP,4-LENGTH,LENGTH);
       73     4200    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
       74     4201    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:3    
       75     4202    3               END;
       76     4203    2           END;
       77     4204    1       RETURN;
       78     4205    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
       79     4206    1           ERROR=ERR#IO#NOOWNER;
       80     4207    1       ELSE
       81     4208    1           ERROR=ERR#IO#WRTC;
       82     4209    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
       83     4210    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
       84     4211    1       GOTO ALT;
       85     4212    1   ER_WRTT: ERROR=ERR#IO#WRTT;
       86     4213    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
       87     4214    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
       88     4215    1       GOTO ALT;
       89     4216    1   ALT: ;
       90     4217    1       GLOBAL.RET.ERROR#=ERROR;
       91     4218    1       CALL M$ERR;
       92     4219    1   END ZIM$JSET;
       93     4220        %EOD;

PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:4    
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JSET.

   Procedure ZIM$JSET requires 170 words for executable code.
   Procedure ZIM$JSET requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:5    

 Object Unit name= ZIM$JSET                                   File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 12:59:08.56 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   170    252  ZIM$JSET
    2  RoData even  none     1      1  ZIM$JSET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       3  ZIM$JSET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:6    


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ZIM$JSET: PROC(RECVAR$,EIS,NEWP)

      6  1 000000   000000 700200 xent  ZIM$JSET     TSX0  ! X66_AUTO_3
         1 000001   000020 000003                    ZERO    16,3

        7        7               AVOID($PR5,$PR6,$PR7);
        8        8        %INCLUDE ZI$GLOBAL;
        9      494            %GLOBALS;
       10      802            %ADSC;
       11      814            %BUFFERS;
       12      829        %INCLUDE ZI$DBCB;
       13     1471            %RECVAR(STCLASS="BASED(RECVAR$)");
       14     1505            %AWS;
       15     1545        %INCLUDE ZI$JRNL;
       16     1653            %JRNL_REC(STCLASS=AUTO);
       17     1728        %INCLUDE CP_6;
       18     1809            %B$TCB;
       19     1812            %B$ALT;
       20     1820            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
       21     1851            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
       22     1870        %INCLUDE CP_6_SUBS;
       23     2410        %INCLUDE B_ERRORS_C;
       24     3537        %INCLUDE B$JIT;
       25     3827        %INCLUDE ZI_ERRORS_C;
       26     4153    1   DCL RECVAR$ PTR;
       27     4154    1   DCL EIS UBIN(36);
       28     4155    1   DCL OLDP UBIN(36);
       29     4156    1   DCL COLDP REDEF OLDP CHAR(4);
       30     4157    1   DCL NEWP UBIN(36);
       31     4158    1   DCL CNEWP REDEF NEWP CHAR(4);
       32     4159    1   DCL LENGTH UBIN(36);
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:7    
       33     4160    1   DCL OFFSET UBIN(36);
       34     4161    1   DCL SETP CHAR(LENGTH) BASED UNAL;
       35     4162    1   DCL ERROR UBIN(36);
       36     4163    1   DCL WRTJ$ PTR;
       37     4164    1   DCL SET$ PTR;
       38     4165    1   DCL B$JIT$ PTR SYMREF;
       39     4166    1   DCL B$TCB$ PTR SYMREF;
       40     4167    1       ERROR=0;

   4167  1 000002   200013 450100                    STZ     ERROR,,AUTO

       41     4168    1       LENGTH=ADDR(EIS)->ADSC.N;

   4168  1 000003   200004 470500                    LDP0    @EIS,,AUTO
         1 000004   000000 236100                    LDQ     0,,PR0
         1 000005   007777 376007                    ANQ     4095,DL
         1 000006   200011 756100                    STQ     LENGTH,,AUTO

       42     4169    1       OFFSET=BITBIN(ADDR(EIS)->ADSC.OFFSET);

   4169  1 000007   000000 236100                    LDQ     0,,PR0
         1 000010   000020 772000                    QRL     16
         1 000011   377777 376007                    ANQ     131071,DL
         1 000012   200012 756100                    STQ     OFFSET,,AUTO

       43     4170    1       OLDP=0;

   4170  1 000013   200010 450100                    STZ     OLDP,,AUTO

       44     4171    1       SET$=PINCRC(RECVAR.RADDR$,OFFSET);

   4171  1 000014   200003 471500                    LDP1    @RECVAR$,,AUTO
         1 000015   100000 473500                    LDP3    0,,PR1
         1 000016   300002 474500                    LDP4    2,,PR3
         1 000017   000011 402007                    MPY     9,DL
         1 000020   400000 503506                    ABD     0,QL,PR4
         1 000021   200015 454500                    STP4    SET$,,AUTO
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:8    

       45     4172    1       CALL INSERT(COLDP,4-LENGTH,LENGTH,SET$->SETP);

   4172  1 000022   000000 235003                    LDA     0,DU
         1 000023   200011 135100                    SBLA    LENGTH,,AUTO
         1 000024   200011 720100                    LXL0    LENGTH,,AUTO
         1 000025   040145 100540                    MLR     fill='040'O
         1 000026   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0
         1 000027   200011 000010                    ADSC9   LENGTH,A,AUTO            cn=0,n=*X0

       46     4173    1       SET$->SETP=SUBSTR(CNEWP,4-LENGTH,LENGTH);

   4173  1 000030   200005 470500                    LDP0    @NEWP,,AUTO
         1 000031   040140 100545                    MLR     fill='040'O
         1 000032   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0
         1 000033   400000 000010                    ADSC9   0,,PR4                   cn=0,n=*X0

       47     4174        /*       Now write journal records */
       48     4175    1       AWS$=RECVAR.AWS$;

   4175  1 000034   100000 473500                    LDP3    0,,PR1
         1 000035   300013 236100                    LDQ     11,,PR3
         1 000036   200006 756100                    STQ     AWS$,,AUTO

       49     4176    1       IF ~GLOBAL.PENDING.ROLL AND

   4176  1 000037   000000 470400 xsym               LDP0    GLOBAL$
         1 000040   000017 236100                    LDQ     15,,PR0
         1 000041   000010 736000                    QLS     8
         1 000042   400000 376003                    ANQ     -131072,DU
         1 000043   400000 676003                    ERQ     -131072,DU
         1 000044   000212 600000 1                  TZE     s:4204
         1 000045   200006 470500                    LDP0    AWS$,,AUTO
         1 000046   000000 236100                    LDQ     0,,PR0
         1 000047   100000 316003                    CANQ    32768,DU
         1 000050   000053 601000 1                  TNZ     s:4179
         1 000051   020000 316003                    CANQ    8192,DU
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:9    
         1 000052   000212 600000 1                  TZE     s:4204

       50     4177    1          (AWS.ATRIB.CJRNL OR AWS.ATRIB.TJRNL) THEN
       51     4178    2       DO;

       52     4179    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4179  1 000053   000000 470400 xsym               LDP0    GLOBAL$
         1 000054   005117 471500                    LDP1    2639,,PR0
         1 000055   100000 630500                    EPPR0   0,,PR1
         1 000056   020004 713400                    CLIMB   8196
         1 000057   402000 401760                    pmme    nvectors=5

       53     4180    2           JRNL$=ADDR(GLOBAL.JRECORD);

   4180  1 000060   000000 236000 xsym               LDQ     GLOBAL$
         1 000061   002622 036003                    ADLQ    1426,DU
         1 000062   200007 756100                    STQ     JRNL$,,AUTO

       54     4181    2           JREC.TYPE=T#MSET;

   4181  1 000063   200007 470500                    LDP0    JRNL$,,AUTO
         1 000064   005000 236003                    LDQ     2560,DU
         1 000065   000001 552140                    STBQ    1,'40'O,PR0

       55     4182    2           JREC.TIME=GLOBAL.TIME.TSTAMP;

   4182  1 000066   000000 471400 xsym               LDP1    GLOBAL$
         1 000067   105001 235100                    LDA     2561,,PR1
         1 000070   000000 755100                    STA     0,,PR0

       56     4183    2           JREC.USER#=B$JIT$->B$JIT.USER;

   4183  1 000071   000000 473400 xsym               LDP3    B$JIT$
         1 000072   300000 236100                    LDQ     0,,PR3
         1 000073   000001 552120                    STBQ    1,'20'O,PR0

PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:10   
       57     4184    2           JREC.DCB#=AWS.DDCB;

   4184  1 000074   200006 474500                    LDP4    AWS$,,AUTO
         1 000075   400006 220100                    LDX0    6,,PR4
         1 000076   000001 440100                    SXL0    1,,PR0

       58     4185    2           JREC.PAGE=PINCRW(RECVAR.BADDR$,-3)->BLOCK.PGNO;

   4185  1 000077   200003 470500                    LDP0    @RECVAR$,,AUTO
         1 000100   000000 471500                    LDP1    0,,PR0
         1 000101   100001 470500                    LDP0    1,,PR1
         1 000102   200007 471500                    LDP1    JRNL$,,AUTO
         1 000103   000001 235100                    LDA     1,,PR0
         1 000104   100002 755100                    STA     2,,PR1

       59     4186    2           JREC.LENGTH=LENGTH;

   4186  1 000105   200011 720100                    LXL0    LENGTH,,AUTO
         1 000106   100003 740100                    STX0    3,,PR1

       60     4187    2           JREC.LINE=0;

   4187  1 000107   000000 221003                    LDX1    0,DU
         1 000110   100003 441100                    SXL1    3,,PR1

       61     4188    2           JREC.OFFSET=POFFC(SET$,RECVAR.BADDR$);

   4188  1 000111   200003 470500                    LDP0    @RECVAR$,,AUTO
         1 000112   000000 471500                    LDP1    0,,PR0
         1 000113   100001 236100                    LDQ     1,,PR1
         1 000114   000020 772000                    QRL     16
         1 000115   200016 756100                    STQ     SET$+1,,AUTO
         1 000116   200015 236100                    LDQ     SET$,,AUTO
         1 000117   000020 772000                    QRL     16
         1 000120   200016 136100                    SBLQ    SET$+1,,AUTO
         1 000121   000000 622006                    EAX2    0,QL
         1 000122   200007 471500                    LDP1    JRNL$,,AUTO
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:11   
         1 000123   100004 742100                    STX2    4,,PR1

       62     4189    2           WRTJ$=GLOBAL.WRTJ$;

   4189  1 000124   000000 470400 xsym               LDP0    GLOBAL$
         1 000125   005115 236100                    LDQ     2637,,PR0
         1 000126   200014 756100                    STQ     WRTJ$,,AUTO

       63     4190    2           FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   4190  1 000127   100003 223100                    LDX3    3,,PR1
         1 000130   000022 624013                    EAX4    18,X3
         1 000131   000000 636014                    EAQ     0,X4
         1 000132   000022 772000                    QRL     18
         1 000133   000011 402007                    MPY     9,DL
         1 000134   000043 036007                    ADLQ    35,DL
         1 000135   000044 506007                    DIV     36,DL
         1 000136   200014 470500                    LDP0    WRTJ$,,AUTO
         1 000137   000002 736000                    QLS     2
         1 000140   000001 136007                    SBLQ    1,DL
         1 000141   000020 736000                    QLS     16
         1 000142   000004 676100                    ERQ     4,,PR0
         1 000143   000000 376000 2                  ANQ     0
         1 000144   000004 656100                    ERSQ    4,,PR0

       64     4191    2           IF AWS.ATRIB.CJRNL THEN

   4191  1 000145   400000 236100                    LDQ     0,,PR4
         1 000146   100000 316003                    CANQ    32768,DU
         1 000147   000166 600000 1                  TZE     s:4197

       65     4192    3           DO;

       66     4193    3               JREC.VALUE=SUBSTR(CNEWP,4-LENGTH,LENGTH);

   4193  1 000150   100003 222100                    LDX2    3,,PR1
         1 000151   000000 235003                    LDA     0,DU
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:12   
         1 000152   200011 135100                    SBLA    LENGTH,,AUTO
         1 000153   200005 470500                    LDP0    @NEWP,,AUTO
         1 000154   040140 100545                    MLR     fill='040'O
         1 000155   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0
         1 000156   100004 400012                    ADSC9   4,,PR1                   cn=2,n=*X2

       67     4194    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4194  1 000157   000000 470400 xsym               LDP0    GLOBAL$
         1 000160   002610 723100                    LXL3    1416,,PR0
         1 000161   200014 470500                    LDP0    WRTJ$,,AUTO
         1 000162   000010 743100                    STX3    8,,PR0

       68     4195    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4195  1 000163   440001 713400                    CLIMB   alt,write
         1 000164   401400 401760                    pmme    nvectors=4
         1 000165   000213 702000 1                  TSX2    ER_WRTC

       69     4196    3               END;

       70     4197    2           IF AWS.ATRIB.TJRNL THEN

   4197  1 000166   200006 470500                    LDP0    AWS$,,AUTO
         1 000167   000000 236100                    LDQ     0,,PR0
         1 000170   020000 316003                    CANQ    8192,DU
         1 000171   000212 600000 1                  TZE     s:4204

       71     4198    3           DO;

       72     4199    3               JREC.VALUE=SUBSTR(COLDP,4-LENGTH,LENGTH);

   4199  1 000172   200007 471500                    LDP1    JRNL$,,AUTO
         1 000173   100003 220100                    LDX0    3,,PR1
         1 000174   000000 235003                    LDA     0,DU
         1 000175   200011 135100                    SBLA    LENGTH,,AUTO
         1 000176   200011 721100                    LXL1    LENGTH,,AUTO
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:13   
         1 000177   040140 100545                    MLR     fill='040'O
         1 000200   200011 000011                    ADSC9   LENGTH,A,AUTO            cn=0,n=*X1
         1 000201   100004 400010                    ADSC9   4,,PR1                   cn=2,n=*X0

       73     4200    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4200  1 000202   000000 473400 xsym               LDP3    GLOBAL$
         1 000203   302604 722100                    LXL2    1412,,PR3
         1 000204   200014 474500                    LDP4    WRTJ$,,AUTO
         1 000205   400010 742100                    STX2    8,,PR4

       74     4201    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   4201  1 000206   400000 630500                    EPPR0   0,,PR4
         1 000207   440001 713400                    CLIMB   alt,write
         1 000210   401400 401760                    pmme    nvectors=4
         1 000211   000234 702000 1                  TSX2    ER_WRTT

       75     4202    3               END;

       76     4203    2           END;

       77     4204    1       RETURN;

   4204  1 000212   000000 702200 xent               TSX2  ! X66_ARET

       78     4205    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   4205  1 000213   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         1 000214   000000 471500                    LDP1    0,,PR0
         1 000215   100102 236100                    LDQ     66,,PR1
         1 000216   377770 376007                    ANQ     131064,DL
         1 000217   001160 116007                    CMPQ    624,DL
         1 000220   000224 601000 1                  TNZ     s:4208

       79     4206    1           ERROR=ERR#IO#NOOWNER;

PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:14   
   4206  1 000221   210762 235007                    LDA     70130,DL
         1 000222   200013 755100                    STA     ERROR,,AUTO
         1 000223   000226 710000 1                  TRA     s:4209

       80     4207    1       ELSE
       81     4208    1           ERROR=ERR#IO#WRTC;

   4208  1 000224   210721 235007                    LDA     70097,DL
         1 000225   200013 755100                    STA     ERROR,,AUTO

       82     4209    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4209  1 000226   100102 236100                    LDQ     66,,PR1
         1 000227   000000 473400 xsym               LDP3    GLOBAL$
         1 000230   300007 756100                    STQ     7,,PR3

       83     4210    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   4210  1 000231   302610 720100                    LXL0    1416,,PR3
         1 000232   300014 740100                    STX0    12,,PR3

       84     4211    1       GOTO ALT;

   4211  1 000233   000246 710000 1                  TRA     ALT

       85     4212    1   ER_WRTT: ERROR=ERR#IO#WRTT;

   4212  1 000234   210720 235007       ER_WRTT      LDA     70096,DL
         1 000235   200013 755100                    STA     ERROR,,AUTO

       86     4213    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4213  1 000236   000000 470400 xsym               LDP0    B$TCB$
         1 000237   000000 471500                    LDP1    0,,PR0
         1 000240   100102 236100                    LDQ     66,,PR1
         1 000241   000000 473400 xsym               LDP3    GLOBAL$
         1 000242   300007 756100                    STQ     7,,PR3
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:15   

       87     4214    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

   4214  1 000243   302604 720100                    LXL0    1412,,PR3
         1 000244   300014 740100                    STX0    12,,PR3

       88     4215    1       GOTO ALT;

   4215  1 000245   000246 710000 1                  TRA     ALT

   4214  1 000246                       ALT          null
       89     4216    1   ALT: ;
       90     4217    1       GLOBAL.RET.ERROR#=ERROR;

   4217  1 000246   300006 755100                    STA     6,,PR3

       91     4218    1       CALL M$ERR;

   4218  1 000247   000002 713400                    CLIMB   err
         1 000250   000000 401760                    pmme    nvectors=0

       92     4219    1   END ZIM$JSET;

   4219  1 000251   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   777777 600000                                                    ....
       93     4220        %EOD;

PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:16   
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JSET.

   Procedure ZIM$JSET requires 170 words for executable code.
   Procedure ZIM$JSET requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:17   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:18   
          MINI XREF LISTING

ADSC.N
       811**DCL      4168>>ASSIGN
ADSC.OFFSET
       805**DCL      4169>>ASSIGN
ALT
      4214**LABEL    4211--GOTO     4215--GOTO
AWS.ATRIB.CJRNL
      1511**DCL      4176>>IF       4191>>IF
AWS.ATRIB.TJRNL
      1513**DCL      4176>>IF       4197>>IF
AWS.DDCB
      1532**DCL      4184>>ASSIGN
AWS$
      1506**DCL      1507--IMP-PTR  4175<<ASSIGN   4176>>IF       4176>>IF       4184>>ASSIGN   4191>>IF
      4197>>IF
B$ALT.CODE
      1814**DCL      1814--REDEF    1815--REDEF    1815--REDEF
B$ALT.ERR
      1815**DCL      4209>>ASSIGN   4213>>ASSIGN
B$ALT.ERR.ERR#
      1816**DCL      1816--REDEF    4205>>IF
B$ALT.EVID
      1815**DCL      1815--REDEF    1815--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3645**DCL      3645--REDEF
B$JIT.ERR.MID
      3552**DCL      3552--REDEF
B$JIT.JRESPEAK
      3713**DCL      3714--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      3822**DCL      3822--REDEF    3823--REDEF
B$JIT.PNR
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:19   
      3726**DCL      3726--REDEF
B$JIT.TSLINE
      3820**DCL      3821--REDEF
B$JIT.USER
      3551**DCL      4183>>ASSIGN
B$JIT$
      4165**DCL      3546--IMP-PTR  4183>>ASSIGN
B$TCB.ALT$
      1810**DCL      4205>>IF       4209>>ASSIGN   4213>>ASSIGN
B$TCB$
      4166**DCL      4205>>IF       4209>>ASSIGN   4213>>ASSIGN
BERC.DCB#
      1696**DCL      1697--REDEF
BLOCK.PGNO
       824**DCL      4185>>ASSIGN
CNEWP
      4158**DCL      4173>>ASSIGN   4193>>ASSIGN
COLDP
      4156**DCL      4172<<CALLBLT  4199>>ASSIGN
EIS
      4154**DCL         6--PROC     4168--ASSIGN   4169--ASSIGN
ERROR
      4162**DCL      4167<<ASSIGN   4206<<ASSIGN   4208<<ASSIGN   4212<<ASSIGN   4217>>ASSIGN
ER_WRTC
      4205**LABEL    4195--CALLALT
ER_WRTT
      4212**LABEL    4201--CALLALT
FPT$TIME
      1862**DCL      4179<>CALL
FPT$WRTJ
      1837**DCL      4195<>CALL     4201<>CALL
FPT$WRTJ.BUF_.BOUND
      1837**DCL      4190<<ASSIGN
FPT$WRTJ.STATION_
      1839**DCL      1839--REDEF
FPT$WRTJ.V.DCB#
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:20   
      1840**DCL      4194<<ASSIGN   4200<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      1846**DCL      1846--REDEF
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF
GLOBAL.CJRNL.DCB#
       690**DCL      4194>>ASSIGN   4210>>ASSIGN
GLOBAL.JRECORD
       700**DCL      4180--ASSIGN
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.ROLL
       536**DCL      4176>>IF
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.RET.DCB#
       521**DCL      4210<<ASSIGN   4214<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      4217<<ASSIGN
GLOBAL.RET.SYSERR#
       516**DCL      4209<<ASSIGN   4213<<ASSIGN
GLOBAL.TIME.TSTAMP
       728**DCL      4182>>ASSIGN
GLOBAL.TIME$
       777**DCL      4179>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      4200>>ASSIGN   4214>>ASSIGN
GLOBAL.WRTJ$
       775**DCL      4189>>ASSIGN
GLOBAL$
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:21   
       799**DCL       495--IMP-PTR  4176>>IF       4179>>CALL     4180>>ASSIGN   4182>>ASSIGN   4189>>ASSIGN
      4194>>ASSIGN   4200>>ASSIGN   4209>>ASSIGN   4210>>ASSIGN   4210>>ASSIGN   4213>>ASSIGN   4214>>ASSIGN
      4214>>ASSIGN   4217>>ASSIGN
JREC
      1675**DCL      4190--ASSIGN
JREC.DCB#
      1679**DCL      4184<<ASSIGN
JREC.LENGTH
      1681**DCL      1684--IMP-SIZ  4186<<ASSIGN   4190>>ASSIGN   4193>>ASSIGN   4199>>ASSIGN
JREC.LINE
      1682**DCL      4187<<ASSIGN
JREC.OFFSET
      1683**DCL      4188<<ASSIGN
JREC.PAGE
      1680**DCL      4185<<ASSIGN
JREC.TIME
      1676**DCL      4182<<ASSIGN
JREC.TYPE
      1677**DCL      4181<<ASSIGN
JREC.USER#
      1678**DCL      4183<<ASSIGN
JREC.VALUE
      1684**DCL      4193<<ASSIGN   4199<<ASSIGN
JRNL$
      1654**DCL      1655--IMP-PTR  1675--IMP-PTR  1685--IMP-PTR  1692--IMP-PTR  1698--IMP-PTR  4180<<ASSIGN
      4181>>ASSIGN   4182>>ASSIGN   4183>>ASSIGN   4184>>ASSIGN   4185>>ASSIGN   4186>>ASSIGN   4187>>ASSIGN
      4188>>ASSIGN   4190>>ASSIGN   4190>>ASSIGN   4193>>ASSIGN   4193>>ASSIGN   4199>>ASSIGN   4199>>ASSIGN
LENGTH
      4159**DCL      4161--IMP-SIZ  4168<<ASSIGN   4172>>CALLBLT  4172>>CALLBLT  4172>>CALLBLT  4173>>ASSIGN
      4173>>ASSIGN   4173>>ASSIGN   4186>>ASSIGN   4193>>ASSIGN   4193>>ASSIGN   4199>>ASSIGN   4199>>ASSIGN
M$ERR
      1749**DCL-ENT  4218--CALL
M$TIME
      1804**DCL-ENT  4179--CALL
M$WRITE
      1738**DCL-ENT  4195--CALL     4201--CALL
PL6.E3A0      #001=ZIM$JSET File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 12:59 Page:22   
NEWP
      4157**DCL         6--PROC     4158--REDEF
OFFSET
      4160**DCL      4169<<ASSIGN   4171>>ASSIGN
OLDP
      4155**DCL      4156--REDEF    4170<<ASSIGN
RECVAR.AWS$
      1498**DCL      4175>>ASSIGN
RECVAR.BADDR
      1474**DCL      1477--REDEF
RECVAR.BADDR$
      1477**DCL      4185>>ASSIGN   4188>>ASSIGN
RECVAR.RADDR
      1478**DCL      1482--REDEF
RECVAR.RADDR$
      1482**DCL      4171>>ASSIGN
RECVAR$
      4153**DCL         6--PROC     1472--IMP-PTR  4171>>ASSIGN   4175>>ASSIGN   4185>>ASSIGN   4188>>ASSIGN
SET$
      4164**DCL      4171<<ASSIGN   4172>>CALLBLT  4173>>ASSIGN   4188>>ASSIGN
SETP
      4161**DCL      4172>>CALLBLT  4173<<ASSIGN
WRTJ$
      4163**DCL      1837--IMP-PTR  4189<<ASSIGN   4190>>ASSIGN   4194>>ASSIGN   4195>>CALL     4200>>ASSIGN
      4201>>CALL

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:23   
       94        1        /*T***********************************************************/
       95        2        /*T*                                                         */
       96        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       97        4        /*T*                                                         */
       98        5        /*T***********************************************************/
       99        6        ZIM$JBEGIN: PROC
      100        7               AVOID($PR5,$PR6,$PR7);
      101        8        %INCLUDE ZI$GLOBAL;
      102      494            %GLOBALS;
      103      802        %INCLUDE ZI$DBCB;
      104     1444            %AWS;
      105     1484        %INCLUDE ZI$JRNL;
      106     1592            %JRNL_REC(STCLASS=AUTO);
      107     1667        %INCLUDE B$JIT;
      108     1957        %INCLUDE CP_6;
      109     2038            %B$TCB;
      110     2041            %B$ALT;
      111     2049            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      112     2068            %FPT_OPEN(FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      113     2177            %FPT_OPEN(FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      114     2286            %FPT_OPEN(FPTN=FPT$OPNSCRB,STCLASS="BASED(FPT$)");
      115     2395            %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      116     2437            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      117     2468            %FPT_READ(FPTN=FPT$READJ,STCLASS=BASED);
      118     2507            %FPT_PFIL(FPTN=FPT$PFIL,STCLASS=BASED);
      119     2522            %FPT_PRECORD(FPTN=FPT$PRECJ,STCLASS=BASED);
      120     2543            %FPT_GETDCB(FPTN=FPT$GETDCB,STCLASS=BASED);
      121     2558            %FPT_RELDCB(FPTN=FPT$RELDCB,STCLASS=BASED);
      122     2572            %FPT_TRUNC(FPTN=FPT$TRUNC,STCLASS=BASED);
      123     2586            %F$DCB(BASED="BASED(F$DCB$)");
      124     2643        %INCLUDE CP_6_SUBS;
      125     3183        %INCLUDE B_ERRORS_C;
      126     4310        %INCLUDE ZI_ERRORS_C;
      127     4636    1   DCL DEVICE CHAR(4) CONSTANT INIT('FILE');
      128     4637    1   DCL ZI_TJNAME CHAR(4) SYMREF;
      129     4638    1   DCL ERROR UBIN(36) UNAL;
      130     4639    1   DCL DCB# UBIN(36);
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:24   
      131     4640    1   DCL 1 FIDRECORD,
      132     4641    1         2 * CHAR(67) UNAL;
      133     4642    1   DCL WRTJ$ PTR;
      134     4643    1   DCL ZI_TEST BIT(1) SYMREF;
      135     4644    1   DCL ZI_USER BIT(1) SYMREF;
      136     4645    1   DCL B$JIT$ PTR SYMREF;
      137     4646    1   DCL B$TCB$ PTR SYMREF;
      138     4647    1   DCL F$DCB$ PTR;
      139     4648    1   DCL FPT$ PTR;
      140     4649    1       ERROR=0;
      141     4650    1       AWS$=GLOBAL.PARAN.IO.AWS$;
      142     4651    1       IF ~GLOBAL.PENDING.ROLL AND
      143     4652    1          (AWS.ATRIB.CJRNL OR AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT) THEN
      144     4653    2       DO;
      145     4654    2           JRNL$=ADDR(GLOBAL.JRECORD);
      146     4655    2           WRTJ$=GLOBAL.WRTJ$;
      147     4656    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      148     4657    2           IF AWS.ATRIB.CJRNL AND GLOBAL.CJRNL.DCB#=0 THEN
      149     4658    3           DO;
      150     4659    3               GLOBAL.DCBNAME.LENGTH=7;
      151     4660    3               GLOBAL.DCBNAME.TEXT='JOURNAL';
      152     4661    3               GLOBAL.FILENAME.LENGTH=7;
      153     4662    3               GLOBAL.FILENAME.TEXT='JOURNAL';
      154     4663    3               GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%YES#;
      155     4664    3               CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_OPNC);
      156     4665    4               IF GLOBAL.DCBNUMBER=0 THEN DO;
      157     4666    4                   GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;
      158     4667    4                   CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_OPNC);
      159     4668    4                   FPT$=GLOBAL.OPNDFLT$;
      160     4669    4                   FPT$OPNDFLT.V.DCB#=GLOBAL.DCBNUMBER;
      161     4670    4                   FPT$OPNDFLT.V.ASN#=%FILE#;
      162     4671    4                   FPT$OPNDFLT.V.IXTNSIZE#=AWS.HIGHPG/20;
      163     4672    4                   FPT$OPNDFLT.V.XTNSIZE#=AWS.HIGHPG/20;
      164     4673    4                   FPT$OPNDFLT.V.DISP#=%NAMED#;
      165     4674    4                   FPT$OPNDFLT.V.CTG#=%YES#;
      166     4675    4                   FPT$OPNDFLT.V.TYPE#=' ';
      167     4676    4                   GLOBAL.FILENAME=GLOBAL.DCBNAME;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:25   
      168     4677    4                   GLOBAL.ACCT=' ';
      169     4678    4                   CALL M$OPEN(FPT$OPNDFLT) ALTRET(ER_OPNC);
      170     4679    4                   END;
      171     4680    3               F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);
      172     4681    3               FPT$=GLOBAL.OPEN$;
      173     4682    3               FPT$OPEN.V.DCB#=GLOBAL.DCBNUMBER;
      174     4683    3               FPT$OPEN.V.ASN#=0;
      175     4684    3               FPT$OPEN.V.FUN#=%CREATE#;
      176     4685    3               FPT$OPEN.V.EXIST#=%OLDFILE#;
      177     4686    3               FPT$OPEN.V.ORG#=%CONSEC#;
      178     4687    3               FPT$OPEN.V.ACS#=%JRNL#;
      179     4688    3               FPT$OPEN.V.GHSTACS#=%JRNLOPN#;
      180     4689    3               CALL M$OPEN(FPT$OPEN)
      181     4690    4               WHENALTRETURN DO;
      182     4691    4                   FPT$OPEN.V.GHSTACS#=0;
      183     4692    4                   GOTO ER_OPNC;
      184     4693    4                   END;
      185     4694    3               FPT$OPEN.V.GHSTACS#=0;
      186     4695    3               F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);
      187     4696    3               GLOBAL.CJRNL.DCB#=GLOBAL.DCBNUMBER;
      188     4697    3               BERC.TYPE=T#BGN;
      189     4698    3               BERC.TIME=GLOBAL.TIME.TSTAMP;
      190     4699    3               BERC.USER#=B$JIT$->B$JIT.USER;
      191     4700    3               BERC.SYSID=B$JIT$->B$JIT.SYSID;
      192     4701    3               FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);
      193     4702    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      194     4703    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      195     4704    3               END;
      196     4705    2           IF (AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT) AND
      197     4706    2              GLOBAL.TJRNL.DCB#=0 THEN
      198     4707    3           DO;
      199     4708    3               GLOBAL.DCBNAME.LENGTH=5;
      200     4709    3               GLOBAL.DCBNAME.TEXT='TJRNL';
      201     4710    3               GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;
      202     4711    3               CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_GDCB);
      203     4712    3               GLOBAL.ACCT=' ';
      204     4713    3               GLOBAL.FILENAME.LENGTH=2;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:26   
      205     4714    3               FPT$=GLOBAL.OPNSCRB$;
      206     4715    4               IF ZI_TEST OR ZI_USER THEN DO;
      207     4716    4                   GLOBAL.FILENAME.LENGTH=2;
      208     4717    4                   GLOBAL.FILENAME.TEXT='*J';
      209     4718    4                   FPT$OPNSCRB.V.SHARE#=%ALL#;
      210     4719    4                   FPT$OPNSCRB.V.TYPE#='  ';
      211     4720    4                   END;
      212     4721    4               ELSE DO;
      213     4722    4                   GLOBAL.FILENAME.LENGTH=2;
      214     4723    4                   GLOBAL.FILENAME.TEXT=ZI_TJNAME;
      215     4724    4                   FPT$OPNSCRB.V.SHARE#=%NONE#;
      216     4725    4                   FPT$OPNSCRB.V.TYPE#='*I';
      217     4726    4                   END;
      218     4727    3               FPT$OPNSCRB.V.DCB#=GLOBAL.DCBNUMBER;
      219     4728    3               FPT$OPNSCRB.V.FUN#=%CREATE#;
      220     4729    3               FPT$OPNSCRB.V.EXIST#=%NEWFILE#;
      221     4730    3               FPT$OPNSCRB.V.DISP#=%NAMED#;
      222     4731    3               FPT$OPNSCRB.V.ORG#=%CONSEC#;
      223     4732    3               FPT$OPNSCRB.V.CTG#=%YES#;
      224     4733    3               FPT$OPNSCRB.V.ACS#=%SEQUEN#;
      225     4734    3               CALL M$OPEN(FPT$OPNSCRB) ALTRET(ER_OPNT);
      226     4735    3               GLOBAL.TJRNL.DCB#=GLOBAL.DCBNUMBER;
      227     4736    3               END;
      228     4737    2           FILE.TYPE=T#FID;
      229     4738    2           FILE.TIME=GLOBAL.TIME.TSTAMP;
      230     4739    2           FILE.USER#=B$JIT$->B$JIT.USER;
      231     4740    2           FILE.DCB#=AWS.DDCB;
      232     4741    2           FILE.CRPT=AWS.ENCRP;
      233     4742    2           F$DCB$=DCBADDR(AWS.DDCB);
      234     4743    2           FILE.KEYED=AWS.ATRIB.KEYED;
      235     4744    2           FILE.CHKSUM=AWS.ATRIB.CHKSUM;
      236     4745    2           FILE.ATMP=AWS.ATRIB.ATMP;
      237     4746    2           FILE.ID.ACCT#=F$DCB.ACCT#;
      238     4747    2           FILE.ID.PASS#=F$DCB.PASS#;
      239     4748    2           FILE.ID.PSN#=F$DCB.PSN#;
      240     4749    2           FILE.ID.NAME#.L=F$DCB.NAME#.L;
      241     4750    2           FILE.ID.NAME#.C=F$DCB.NAME#.C;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:27   
      242     4751    2           FPT$WRTJ.BUF_.BOUND=SIZEV(FILE);
      243     4752    2           IF AWS.ATRIB.CJRNL THEN
      244     4753    3           DO;
      245     4754    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      246     4755    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      247     4756    3               END;
      248     4757    2           IF AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT THEN
      249     4758    3           DO;
      250     4759    3               FILE.UNPROTECT=AWS.ATRIB.UNPROTECT;
      251     4760    3               GLOBAL.PFIL$->FPT$PFIL.V.DCB#=GLOBAL.TJRNL.DCB#;
      252     4761    3               GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%YES#;
      253     4762    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);
      254     4763    3               GLOBAL.PRECJ$->FPT$PRECJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      255     4764    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=GLOBAL.TJRNL.FIDCOUNT;
      256     4765    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      257     4766    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      258     4767    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      259     4768    3               GLOBAL.TJRNL.FIDCOUNT=GLOBAL.TJRNL.FIDCOUNT+1;
      260     4769    3               END;
      261     4770    2           END;
      262     4771    1       GOTO RET;
      263     4772        %EJECT;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:28   
      264     4773    1   ZIM$JCLOSE: ENTRY;
      265     4774    1       ERROR=0;
      266     4775    1       AWS$=GLOBAL.PARAN.IO.AWS$;
      267     4776    1       WRTJ$=GLOBAL.WRTJ$;
      268     4777    1       JRNL$=ADDR(GLOBAL.JRECORD);
      269     4778    1       IF AWS.ATRIB.CJRNL AND ~GLOBAL.PENDING.ROLL THEN
      270     4779    2       DO;
      271     4780    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      272     4781    2           BERC.TYPE=T#CFID;
      273     4782    2           BERC.TIME=GLOBAL.TIME.TSTAMP;
      274     4783    2           BERC.USER#=B$JIT$->B$JIT.USER;
      275     4784    2           BERC.DCB#=AWS.DDCB;
      276     4785    2           FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);
      277     4786    2           FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      278     4787    2           CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      279     4788    2           END;
      280     4789    1       IF (AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT) AND
      281     4790    1          GLOBAL.PENDING.ROLL='0'B THEN /* FID IS IN *I */
      282     4791    2       DO;
      283     4792    2           GLOBAL.TJRNL.FIDCOUNT=GLOBAL.TJRNL.FIDCOUNT-1;
      284     4793    2           GLOBAL.PFIL$->FPT$PFIL.V.DCB#=GLOBAL.TJRNL.DCB#;
      285     4794    2           GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%YES#;
      286     4795    2           CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);
      287     4796    2           GLOBAL.PRECJ$->FPT$PRECJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      288     4797    2           GLOBAL.PRECJ$->FPT$PRECJ.V.N#=GLOBAL.TJRNL.FIDCOUNT;
      289     4798    2           CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      290     4799    2           GLOBAL.READJ$->FPT$READJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      291     4800    2           CALL M$READ(GLOBAL.READJ$->FPT$READJ) ALTRET(ER_WRTT);
      292     4801    2           FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      293     4802    3           IF AWS.DDCB~=FILE.DCB# THEN DO;
      294     4803    3               FIDRECORD=GLOBAL.JRECORD;
      295     4804    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);
      296     4805    4               DO WHILE (AWS.DDCB~=FILE.DCB#);
      297     4806    4                   CALL M$READ(GLOBAL.READJ$->FPT$READJ) ALTRET(ER_WRTT);
      298     4807    4                   IF FILE.TYPE~=T#FID THEN
      299     4808    4                       GOTO ER_WRTT;
      300     4809    4                   END;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:29   
      301     4810    3               GLOBAL.JRECORD=FIDRECORD;
      302     4811    3               FPT$WRTJ.BUF_.BOUND=SIZEV(FILE);
      303     4812    3               FPT$WRTJ.V.REWRITE#=%YES#;
      304     4813    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_REWRTT);
      305     4814    3               FPT$WRTJ.V.REWRITE#=%NO#;
      306     4815    3               GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%NO#;
      307     4816    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-1;
      308     4817    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);
      309     4818    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      310     4819    3               END; /* FILE IS POSITIONED TO THE LAST REC(T#CKPT) */
      311     4820    2           CALL M$READ(GLOBAL.READJ$->FPT$READJ) ALTRET(E_O_F);
      312     4821    2           GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-2;
      313     4822    2           CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      314     4823    2           FPT$WRTJ.BUF_.BOUND=SIZEV(CKPT)-SIZEC(CKPT.FILLER);
      315     4824    2           CALL M$WRITE(FPT$WRTJ) ALTRET(ER_REWRTT);
      316     4825    2           GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-1;
      317     4826    2           CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      318     4827    2           GLOBAL.TRUNC$->FPT$TRUNC.V.DCB#=GLOBAL.TJRNL.DCB#;
      319     4828    2           CALL M$TRUNC(GLOBAL.TRUNC$->FPT$TRUNC) ALTRET(ER_WRTT);
      320     4829    2           END;
      321     4830    1       GOTO RET;
      322     4831        %EJECT;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:30   
      323     4832    1   ZIM$JEND: ENTRY;
      324     4833    1       ERROR=0;
      325     4834    1       IF GLOBAL.TJRNL.DCB#~=0 THEN
      326     4835    2       DO;
      327     4836    2           DCB#=GLOBAL.TJRNL.DCB#;
      328     4837    2           GLOBAL.TJRNL.DCB#=0;
      329     4838    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=DCB#;
      330     4839    2           IF ~ZI_TEST THEN
      331     4840    2               GLOBAL.CLOSE$->FPT$CLOSE.V.DISP#=%RELEASE#;
      332     4841    2           CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);
      333     4842    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DISP#=%NAMED#;
      334     4843    2           GLOBAL.RELDCB$->FPT$RELDCB.V.DCB#=DCB#;
      335     4844    2           CALL M$RELDCB(GLOBAL.RELDCB$->FPT$RELDCB);
      336     4845    2           END;
      337     4846    1       IF GLOBAL.CJRNL.DCB#~=0 THEN
      338     4847    2       DO;
      339     4848    2           IF ~GLOBAL.PENDING.ROLL THEN
      340     4849    3           DO; /* Don't write end if abort during rollback */
      341     4850    3               JRNL$=ADDR(GLOBAL.JRECORD);
      342     4851    3               CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      343     4852    3               BERC.TYPE=T#END;
      344     4853    3               BERC.TIME=GLOBAL.TIME.TSTAMP;
      345     4854    3               BERC.USER#=B$JIT$->B$JIT.USER;
      346     4855    3               BERC.SYSID=B$JIT$->B$JIT.SYSID;
      347     4856    3               WRTJ$=GLOBAL.WRTJ$;
      348     4857    3               FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);
      349     4858    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      350     4859    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      351     4860    3               END;
      352     4861    2           DCB#=GLOBAL.CJRNL.DCB#;
      353     4862    2           GLOBAL.CJRNL.DCB#=0;
      354     4863    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=DCB#;
      355     4864    2           CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);
      356     4865    2           GLOBAL.RELDCB$->FPT$RELDCB.V.DCB#=DCB#;
      357     4866    2           CALL M$RELDCB(GLOBAL.RELDCB$->FPT$RELDCB);
      358     4867    2           END;
      359     4868    1   RET: RETURN;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:31   
      360     4869    1   ER_GDCB: ERROR=ERR#IO#GDCB;
      361     4870    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      362     4871    1       GOTO ALT;
      363     4872    1   ER_OPNC: ERROR=ERR#IO#OPNC;
      364     4873    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      365     4874    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;
      366     4875    1       GOTO ALT;
      367     4876    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
      368     4877    1           ERROR=ERR#IO#NOOWNER;
      369     4878    1       ELSE
      370     4879    1           ERROR=ERR#IO#WRTC;
      371     4880    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      372     4881    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
      373     4882    1       GLOBAL.CJRNL.DCB#=0;
      374     4883    1       GOTO ALT;
      375     4884    1   E_O_F: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$EOF THEN
      376     4885    1           GOTO RET;
      377     4886    1       GOTO ER_WRTT;
      378     4887    1   ER_OPNT: ERROR=ERR#IO#OPNT;
      379     4888    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      380     4889    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;
      381     4890    1       GOTO ALT;
      382     4891    1   ER_REWRTT: FPT$WRTJ.V.REWRITE#=%NO#;
      383     4892    1   ER_WRTT: ERROR=ERR#IO#WRTT;
      384     4893    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      385     4894    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
      386     4895    1       GOTO ALT;
      387     4896    1   ALT: ;
      388     4897    1       GLOBAL.RET.ERROR#=ERROR;
      389     4898    1       CALL M$ERR;
      390     4899    1   END ZIM$JBEGIN;
      391     4900        %EOD;

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:32   
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JBEGIN.

   Procedure ZIM$JBEGIN requires 729 words for executable code.
   Procedure ZIM$JBEGIN requires 28 words of local(AUTO) storage.

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:33   

 Object Unit name= ZIM$JBEGIN                                 File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 12:59:21.20 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      8     10  ZIM$JBEGIN
    2   Proc  even  none   729   1331  ZIM$JBEGIN
    3  RoData even  none    13     15  ZIM$JBEGIN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      XStd       0  ZIM$JBEGIN
     2    551                  yes      XStd       0  ZIM$JCLOSE
     2   1067                  yes      XStd       0  ZIM$JEND

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:34   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  ZI_TJNAME
     ZI_TEST                               ZI_USER                               B$JIT$
     B$TCB$

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 NULLSID
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:35   


       94        1        /*T***********************************************************/
       95        2        /*T*                                                         */
       96        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       97        4        /*T*                                                         */
       98        5        /*T***********************************************************/
       99        6        ZIM$JBEGIN: PROC

      6  2 000000   000000 700200 xent  ZIM$JBEGIN   TSX0  ! X66_AUTO_0
         2 000001   000034 000000                    ZERO    28,0

      100        7               AVOID($PR5,$PR6,$PR7);
      101        8        %INCLUDE ZI$GLOBAL;
      102      494            %GLOBALS;
      103      802        %INCLUDE ZI$DBCB;
      104     1444            %AWS;
      105     1484        %INCLUDE ZI$JRNL;
      106     1592            %JRNL_REC(STCLASS=AUTO);
      107     1667        %INCLUDE B$JIT;
      108     1957        %INCLUDE CP_6;
      109     2038            %B$TCB;
      110     2041            %B$ALT;
      111     2049            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      112     2068            %FPT_OPEN(FPTN=FPT$OPEN,STCLASS="BASED(FPT$)");
      113     2177            %FPT_OPEN(FPTN=FPT$OPNDFLT,STCLASS="BASED(FPT$)");
      114     2286            %FPT_OPEN(FPTN=FPT$OPNSCRB,STCLASS="BASED(FPT$)");
      115     2395            %FPT_CLOSE(FPTN=FPT$CLOSE,STCLASS=BASED);
      116     2437            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      117     2468            %FPT_READ(FPTN=FPT$READJ,STCLASS=BASED);
      118     2507            %FPT_PFIL(FPTN=FPT$PFIL,STCLASS=BASED);
      119     2522            %FPT_PRECORD(FPTN=FPT$PRECJ,STCLASS=BASED);
      120     2543            %FPT_GETDCB(FPTN=FPT$GETDCB,STCLASS=BASED);
      121     2558            %FPT_RELDCB(FPTN=FPT$RELDCB,STCLASS=BASED);
      122     2572            %FPT_TRUNC(FPTN=FPT$TRUNC,STCLASS=BASED);
      123     2586            %F$DCB(BASED="BASED(F$DCB$)");
      124     2643        %INCLUDE CP_6_SUBS;
      125     3183        %INCLUDE B_ERRORS_C;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:36   
      126     4310        %INCLUDE ZI_ERRORS_C;
      127     4636    1   DCL DEVICE CHAR(4) CONSTANT INIT('FILE');
      128     4637    1   DCL ZI_TJNAME CHAR(4) SYMREF;
      129     4638    1   DCL ERROR UBIN(36) UNAL;
      130     4639    1   DCL DCB# UBIN(36);
      131     4640    1   DCL 1 FIDRECORD,
      132     4641    1         2 * CHAR(67) UNAL;
      133     4642    1   DCL WRTJ$ PTR;
      134     4643    1   DCL ZI_TEST BIT(1) SYMREF;
      135     4644    1   DCL ZI_USER BIT(1) SYMREF;
      136     4645    1   DCL B$JIT$ PTR SYMREF;
      137     4646    1   DCL B$TCB$ PTR SYMREF;
      138     4647    1   DCL F$DCB$ PTR;
      139     4648    1   DCL FPT$ PTR;
      140     4649    1       ERROR=0;

   4649  2 000002   200005 450100                    STZ     ERROR,,AUTO

      141     4650    1       AWS$=GLOBAL.PARAN.IO.AWS$;

   4650  2 000003   000000 470400 xsym               LDP0    GLOBAL$
         2 000004   000020 236100                    LDQ     16,,PR0
         2 000005   200003 756100                    STQ     AWS$,,AUTO

      142     4651    1       IF ~GLOBAL.PENDING.ROLL AND

   4651  2 000006   000017 236100                    LDQ     15,,PR0
         2 000007   000010 736000                    QLS     8
         2 000010   400000 376003                    ANQ     -131072,DU
         2 000011   400000 676003                    ERQ     -131072,DU
         2 000012   000550 600000 2                  TZE     s:4771
         2 000013   200003 471500                    LDP1    AWS$,,AUTO
         2 000014   100000 236100                    LDQ     0,,PR1
         2 000015   100000 316003                    CANQ    32768,DU
         2 000016   000023 601000 2                  TNZ     s:4654
         2 000017   020000 316003                    CANQ    8192,DU
         2 000020   000023 601000 2                  TNZ     s:4654
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:37   
         2 000021   400000 316007                    CANQ    -131072,DL
         2 000022   000550 600000 2                  TZE     s:4771

      143     4652    1          (AWS.ATRIB.CJRNL OR AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT) THEN
      144     4653    2       DO;

      145     4654    2           JRNL$=ADDR(GLOBAL.JRECORD);

   4654  2 000023   000000 236000 xsym               LDQ     GLOBAL$
         2 000024   002622 036003                    ADLQ    1426,DU
         2 000025   200004 756100                    STQ     JRNL$,,AUTO

      146     4655    2           WRTJ$=GLOBAL.WRTJ$;

   4655  2 000026   005115 236100                    LDQ     2637,,PR0
         2 000027   200030 756100                    STQ     WRTJ$,,AUTO

      147     4656    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4656  2 000030   005117 473500                    LDP3    2639,,PR0
         2 000031   300000 630500                    EPPR0   0,,PR3
         2 000032   020004 713400                    CLIMB   8196
         2 000033   402000 401760                    pmme    nvectors=5

      148     4657    2           IF AWS.ATRIB.CJRNL AND GLOBAL.CJRNL.DCB#=0 THEN

   4657  2 000034   200003 470500                    LDP0    AWS$,,AUTO
         2 000035   000000 236100                    LDQ     0,,PR0
         2 000036   100000 316003                    CANQ    32768,DU
         2 000037   000247 600000 2                  TZE     s:4705
         2 000040   000000 471400 xsym               LDP1    GLOBAL$
         2 000041   102610 235100                    LDA     1416,,PR1
         2 000042   000247 601000 2                  TNZ     s:4705

      149     4658    3           DO;

      150     4659    3               GLOBAL.DCBNAME.LENGTH=7;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:38   

   4659  2 000043   007000 236003                    LDQ     3584,DU
         2 000044   104734 552140                    STBQ    2524,'40'O,PR1

      151     4660    3               GLOBAL.DCBNAME.TEXT='JOURNAL';

   4660  2 000045   040100 100400                    MLR     fill='040'O
         2 000046   000001 000007 1                  ADSC9   DEVICE+1                 cn=0,n=7
         2 000047   104734 200037                    ADSC9   2524,,PR1                cn=1,n=31

      152     4661    3               GLOBAL.FILENAME.LENGTH=7;

   4661  2 000050   104724 552140                    STBQ    2516,'40'O,PR1

      153     4662    3               GLOBAL.FILENAME.TEXT='JOURNAL';

   4662  2 000051   040100 100400                    MLR     fill='040'O
         2 000052   000001 000007 1                  ADSC9   DEVICE+1                 cn=0,n=7
         2 000053   104724 200037                    ADSC9   2516,,PR1                cn=1,n=31

      154     4663    3               GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%YES#;

   4663  2 000054   105104 473500                    LDP3    2628,,PR1
         2 000055   200000 236007                    LDQ     65536,DL
         2 000056   300006 256100                    ORSQ    6,,PR3

      155     4664    3               CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_OPNC);

   4664  2 000057   105104 473500                    LDP3    2628,,PR1
         2 000060   300000 630500                    EPPR0   0,,PR3
         2 000061   460002 713400                    CLIMB   alt,+24578
         2 000062   401000 401760                    pmme    nvectors=3
         2 000063   001233 702000 2                  TSX2    ER_OPNC

      156     4665    4               IF GLOBAL.DCBNUMBER=0 THEN DO;

   4665  2 000064   000000 470400 xsym               LDP0    GLOBAL$
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:39   
         2 000065   004623 235100                    LDA     2451,,PR0
         2 000066   000143 601000 2                  TNZ     s:4680

      157     4666    4                   GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;

   4666  2 000067   005104 471500                    LDP1    2628,,PR0
         2 000070   000000 236000 3                  LDQ     0
         2 000071   100006 356100                    ANSQ    6,,PR1

      158     4667    4                   CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_OPNC);

   4667  2 000072   005104 471500                    LDP1    2628,,PR0
         2 000073   100000 630500                    EPPR0   0,,PR1
         2 000074   460002 713400                    CLIMB   alt,+24578
         2 000075   401000 401760                    pmme    nvectors=3
         2 000076   001233 702000 2                  TSX2    ER_OPNC

      159     4668    4                   FPT$=GLOBAL.OPNDFLT$;

   4668  2 000077   000000 470400 xsym               LDP0    GLOBAL$
         2 000100   005067 236100                    LDQ     2615,,PR0
         2 000101   200032 756100                    STQ     FPT$,,AUTO

      160     4669    4                   FPT$OPNDFLT.V.DCB#=GLOBAL.DCBNUMBER;

   4669  2 000102   004623 720100                    LXL0    2451,,PR0
         2 000103   200032 471500                    LDP1    FPT$,,AUTO
         2 000104   100044 740100                    STX0    36,,PR1

      161     4670    4                   FPT$OPNDFLT.V.ASN#=%FILE#;

   4670  2 000105   000001 236007                    LDQ     1,DL
         2 000106   100045 552104                    STBQ    37,'04'O,PR1

      162     4671    4                   FPT$OPNDFLT.V.IXTNSIZE#=AWS.HIGHPG/20;

   4671  2 000107   200003 473500                    LDP3    AWS$,,AUTO
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:40   
         2 000110   300004 236100                    LDQ     4,,PR3
         2 000111   000001 772000                    QRL     1
         2 000112   000012 506007                    DIV     10,DL
         2 000113   100055 756100                    STQ     45,,PR1

      163     4672    4                   FPT$OPNDFLT.V.XTNSIZE#=AWS.HIGHPG/20;

   4672  2 000114   300004 236100                    LDQ     4,,PR3
         2 000115   000001 772000                    QRL     1
         2 000116   000012 506007                    DIV     10,DL
         2 000117   000000 621006                    EAX1    0,QL
         2 000120   100054 441100                    SXL1    44,,PR1

      164     4673    4                   FPT$OPNDFLT.V.DISP#=%NAMED#;

   4673  2 000121   000002 236007                    LDQ     2,DL
         2 000122   100051 552104                    STBQ    41,'04'O,PR1

      165     4674    4                   FPT$OPNDFLT.V.CTG#=%YES#;

   4674  2 000123   100044 236100                    LDQ     36,,PR1
         2 000124   000001 376000 3                  ANQ     1
         2 000125   000100 276007                    ORQ     64,DL
         2 000126   100044 756100                    STQ     36,,PR1

      166     4675    4                   FPT$OPNDFLT.V.TYPE#=' ';

   4675  2 000127   040040 222003                    LDX2    16416,DU
         2 000130   100047 742100                    STX2    39,,PR1

      167     4676    4                   GLOBAL.FILENAME=GLOBAL.DCBNAME;

   4676  2 000131   000100 100500                    MLR     fill='000'O
         2 000132   004734 000040                    ADSC9   2524,,PR0                cn=0,n=32
         2 000133   004724 000040                    ADSC9   2516,,PR0                cn=0,n=32

      168     4677    4                   GLOBAL.ACCT=' ';
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:41   

   4677  2 000134   000002 235000 3                  LDA     2
         2 000135   000002 236000 3                  LDQ     2
         2 000136   004744 757100                    STAQ    2532,,PR0

      169     4678    4                   CALL M$OPEN(FPT$OPNDFLT) ALTRET(ER_OPNC);

   4678  2 000137   100000 630500                    EPPR0   0,,PR1
         2 000140   450000 713400                    CLIMB   alt,open
         2 000141   410400 401760                    pmme    nvectors=18
         2 000142   001233 702000 2                  TSX2    ER_OPNC

      170     4679    4                   END;

      171     4680    3               F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);

   4680  2 000143   000003 470400 3                  LDP0    3
         2 000144   000000 471500                    LDP1    0,,PR0
         2 000145   000000 473400 xsym               LDP3    GLOBAL$
         2 000146   304623 720100                    LXL0    2451,,PR3
         2 000147   100000 236110                    LDQ     0,X0,PR1
         2 000150   200031 756100                    STQ     F$DCB$,,AUTO

      172     4681    3               FPT$=GLOBAL.OPEN$;

   4681  2 000151   305066 236100                    LDQ     2614,,PR3
         2 000152   200032 756100                    STQ     FPT$,,AUTO

      173     4682    3               FPT$OPEN.V.DCB#=GLOBAL.DCBNUMBER;

   4682  2 000153   200032 474500                    LDP4    FPT$,,AUTO
         2 000154   400044 740100                    STX0    36,,PR4

      174     4683    3               FPT$OPEN.V.ASN#=0;

   4683  2 000155   000000 236003                    LDQ     0,DU
         2 000156   400045 552104                    STBQ    37,'04'O,PR4
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:42   

      175     4684    3               FPT$OPEN.V.FUN#=%CREATE#;

   4684  2 000157   003000 236007                    LDQ     1536,DL
         2 000160   400045 552110                    STBQ    37,'10'O,PR4

      176     4685    3               FPT$OPEN.V.EXIST#=%OLDFILE#;

   4685  2 000161   400044 236100                    LDQ     36,,PR4
         2 000162   000004 376000 3                  ANQ     4
         2 000163   000400 276007                    ORQ     256,DL
         2 000164   400044 756100                    STQ     36,,PR4

      177     4686    3               FPT$OPEN.V.ORG#=%CONSEC#;

   4686  2 000165   001000 236007                    LDQ     512,DL
         2 000166   400046 552110                    STBQ    38,'10'O,PR4

      178     4687    3               FPT$OPEN.V.ACS#=%JRNL#;

   4687  2 000167   000004 236007                    LDQ     4,DL
         2 000170   400046 552104                    STBQ    38,'04'O,PR4

      179     4688    3               FPT$OPEN.V.GHSTACS#=%JRNLOPN#;

   4688  2 000171   400047 236100                    LDQ     39,,PR4
         2 000172   000005 376000 3                  ANQ     5
         2 000173   000002 276007                    ORQ     2,DL
         2 000174   400047 756100                    STQ     39,,PR4

      180     4689    3               CALL M$OPEN(FPT$OPEN)

   4689  2 000175   400000 630500                    EPPR0   0,,PR4
         2 000176   450000 713400                    CLIMB   alt,open
         2 000177   410400 401760                    pmme    nvectors=18
         2 000200   000202 702000 2                  TSX2    s:4691
         2 000201   000206 710000 2                  TRA     s:4694
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:43   

      181     4690    4               WHENALTRETURN DO;

      182     4691    4                   FPT$OPEN.V.GHSTACS#=0;

   4691  2 000202   200032 470500                    LDP0    FPT$,,AUTO
         2 000203   000005 236000 3                  LDQ     5
         2 000204   000047 356100                    ANSQ    39,,PR0

      183     4692    4                   GOTO ER_OPNC;

   4692  2 000205   001233 710000 2                  TRA     ER_OPNC

      184     4693    4                   END;
      185     4694    3               FPT$OPEN.V.GHSTACS#=0;

   4694  2 000206   200032 470500                    LDP0    FPT$,,AUTO
         2 000207   000005 236000 3                  LDQ     5
         2 000210   000047 356100                    ANSQ    39,,PR0

      186     4695    3               F$DCB$=DCBADDR(GLOBAL.DCBNUMBER);

   4695  2 000211   000003 471400 3                  LDP1    3
         2 000212   100000 473500                    LDP3    0,,PR1
         2 000213   000000 474400 xsym               LDP4    GLOBAL$
         2 000214   404623 720100                    LXL0    2451,,PR4
         2 000215   300000 236110                    LDQ     0,X0,PR3
         2 000216   200031 756100                    STQ     F$DCB$,,AUTO

      187     4696    3               GLOBAL.CJRNL.DCB#=GLOBAL.DCBNUMBER;

   4696  2 000217   404623 235100                    LDA     2451,,PR4
         2 000220   402610 755100                    STA     1416,,PR4

      188     4697    3               BERC.TYPE=T#BGN;

   4697  2 000221   200004 470500                    LDP0    JRNL$,,AUTO
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:44   
         2 000222   001000 236003                    LDQ     512,DU
         2 000223   000001 552140                    STBQ    1,'40'O,PR0

      189     4698    3               BERC.TIME=GLOBAL.TIME.TSTAMP;

   4698  2 000224   405001 235100                    LDA     2561,,PR4
         2 000225   000000 755100                    STA     0,,PR0

      190     4699    3               BERC.USER#=B$JIT$->B$JIT.USER;

   4699  2 000226   000000 470400 xsym               LDP0    B$JIT$
         2 000227   200004 471500                    LDP1    JRNL$,,AUTO
         2 000230   000000 236100                    LDQ     0,,PR0
         2 000231   100001 552120                    STBQ    1,'20'O,PR1

      191     4700    3               BERC.SYSID=B$JIT$->B$JIT.SYSID;

   4700  2 000232   000000 720100                    LXL0    0,,PR0
         2 000233   100001 440100                    SXL0    1,,PR1

      192     4701    3               FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);

   4701  2 000234   200030 473500                    LDP3    WRTJ$,,AUTO
         2 000235   300004 236100                    LDQ     4,,PR3
         2 000236   177777 376007                    ANQ     65535,DL
         2 000237   000007 276000 3                  ORQ     7
         2 000240   300004 756100                    STQ     4,,PR3

      193     4702    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4702  2 000241   402610 720100                    LXL0    1416,,PR4
         2 000242   300010 740100                    STX0    8,,PR3

      194     4703    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4703  2 000243   300000 630500                    EPPR0   0,,PR3
         2 000244   440001 713400                    CLIMB   alt,write
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:45   
         2 000245   401400 401760                    pmme    nvectors=4
         2 000246   001245 702000 2                  TSX2    ER_WRTC

      195     4704    3               END;

      196     4705    2           IF (AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT) AND

   4705  2 000247   200003 470500                    LDP0    AWS$,,AUTO
         2 000250   000000 236100                    LDQ     0,,PR0
         2 000251   020000 316003                    CANQ    8192,DU
         2 000252   000255 601000 2                  TNZ     s:4705+6
         2 000253   400000 316007                    CANQ    -131072,DL
         2 000254   000367 600000 2                  TZE     s:4737
         2 000255   000000 471400 xsym               LDP1    GLOBAL$
         2 000256   102604 235100                    LDA     1412,,PR1
         2 000257   000367 601000 2                  TNZ     s:4737

      197     4706    2              GLOBAL.TJRNL.DCB#=0 THEN
      198     4707    3           DO;

      199     4708    3               GLOBAL.DCBNAME.LENGTH=5;

   4708  2 000260   005000 236003                    LDQ     2560,DU
         2 000261   104734 552140                    STBQ    2524,'40'O,PR1

      200     4709    3               GLOBAL.DCBNAME.TEXT='TJRNL';

   4709  2 000262   040100 100400                    MLR     fill='040'O
         2 000263   000003 000005 1                  ADSC9   DEVICE+3                 cn=0,n=5
         2 000264   104734 200037                    ADSC9   2524,,PR1                cn=1,n=31

      201     4710    3               GLOBAL.GETDCB$->FPT$GETDCB.V.TEST#=%NO#;

   4710  2 000265   105104 473500                    LDP3    2628,,PR1
         2 000266   000000 236000 3                  LDQ     0
         2 000267   300006 356100                    ANSQ    6,,PR3

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:46   
      202     4711    3               CALL M$GETDCB(GLOBAL.GETDCB$->FPT$GETDCB) ALTRET(ER_GDCB);

   4711  2 000270   105104 473500                    LDP3    2628,,PR1
         2 000271   300000 630500                    EPPR0   0,,PR3
         2 000272   460002 713400                    CLIMB   alt,+24578
         2 000273   401000 401760                    pmme    nvectors=3
         2 000274   001223 702000 2                  TSX2    ER_GDCB

      203     4712    3               GLOBAL.ACCT=' ';

   4712  2 000275   000002 235000 3                  LDA     2
         2 000276   000002 236000 3                  LDQ     2
         2 000277   000000 470400 xsym               LDP0    GLOBAL$
         2 000300   004744 757100                    STAQ    2532,,PR0

      204     4713    3               GLOBAL.FILENAME.LENGTH=2;

   4713  2 000301   002000 236003                    LDQ     1024,DU
         2 000302   004724 552140                    STBQ    2516,'40'O,PR0

      205     4714    3               FPT$=GLOBAL.OPNSCRB$;

   4714  2 000303   005070 236100                    LDQ     2616,,PR0
         2 000304   200032 756100                    STQ     FPT$,,AUTO

      206     4715    4               IF ZI_TEST OR ZI_USER THEN DO;

   4715  2 000305   000000 234000 xsym               SZN     ZI_TEST
         2 000306   000311 604000 2                  TMI     s:4716
         2 000307   000000 234000 xsym               SZN     ZI_USER
         2 000310   000326 605000 2                  TPL     s:4722

      207     4716    4                   GLOBAL.FILENAME.LENGTH=2;

   4716  2 000311   002000 236003                    LDQ     1024,DU
         2 000312   004724 552140                    STBQ    2516,'40'O,PR0

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:47   
      208     4717    4                   GLOBAL.FILENAME.TEXT='*J';

   4717  2 000313   040100 100400                    MLR     fill='040'O
         2 000314   000005 000002 1                  ADSC9   DEVICE+5                 cn=0,n=2
         2 000315   004724 200037                    ADSC9   2516,,PR0                cn=1,n=31

      209     4718    4                   FPT$OPNSCRB.V.SHARE#=%ALL#;

   4718  2 000316   200032 471500                    LDP1    FPT$,,AUTO
         2 000317   100044 236100                    LDQ     36,,PR1
         2 000320   000010 376000 3                  ANQ     8
         2 000321   000010 276007                    ORQ     8,DL
         2 000322   100044 756100                    STQ     36,,PR1

      210     4719    4                   FPT$OPNSCRB.V.TYPE#='  ';

   4719  2 000323   000006 220000 1                  LDX0    DEVICE+6
         2 000324   100047 740100                    STX0    39,,PR1

      211     4720    4                   END;

   4720  2 000325   000340 710000 2                  TRA     s:4727

      212     4721    4               ELSE DO;

      213     4722    4                   GLOBAL.FILENAME.LENGTH=2;

   4722  2 000326   002000 236003                    LDQ     1024,DU
         2 000327   004724 552140                    STBQ    2516,'40'O,PR0

      214     4723    4                   GLOBAL.FILENAME.TEXT=ZI_TJNAME;

   4723  2 000330   040100 100400                    MLR     fill='040'O
         2 000331   000000 000004 xsym               ADSC9   ZI_TJNAME                cn=0,n=4
         2 000332   004724 200037                    ADSC9   2516,,PR0                cn=1,n=31

      215     4724    4                   FPT$OPNSCRB.V.SHARE#=%NONE#;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:48   

   4724  2 000333   200032 471500                    LDP1    FPT$,,AUTO
         2 000334   000030 236007                    LDQ     24,DL
         2 000335   100044 256100                    ORSQ    36,,PR1

      216     4725    4                   FPT$OPNSCRB.V.TYPE#='*I';

   4725  2 000336   000007 220000 1                  LDX0    DEVICE+7
         2 000337   100047 740100                    STX0    39,,PR1

      217     4726    4                   END;

      218     4727    3               FPT$OPNSCRB.V.DCB#=GLOBAL.DCBNUMBER;

   4727  2 000340   004623 721100                    LXL1    2451,,PR0
         2 000341   100044 741100                    STX1    36,,PR1

      219     4728    3               FPT$OPNSCRB.V.FUN#=%CREATE#;

   4728  2 000342   003000 236007                    LDQ     1536,DL
         2 000343   100045 552110                    STBQ    37,'10'O,PR1

      220     4729    3               FPT$OPNSCRB.V.EXIST#=%NEWFILE#;

   4729  2 000344   000600 236007                    LDQ     384,DL
         2 000345   100044 256100                    ORSQ    36,,PR1

      221     4730    3               FPT$OPNSCRB.V.DISP#=%NAMED#;

   4730  2 000346   000002 236007                    LDQ     2,DL
         2 000347   100051 552104                    STBQ    41,'04'O,PR1

      222     4731    3               FPT$OPNSCRB.V.ORG#=%CONSEC#;

   4731  2 000350   001000 236007                    LDQ     512,DL
         2 000351   100046 552110                    STBQ    38,'10'O,PR1

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:49   
      223     4732    3               FPT$OPNSCRB.V.CTG#=%YES#;

   4732  2 000352   100044 236100                    LDQ     36,,PR1
         2 000353   000001 376000 3                  ANQ     1
         2 000354   000100 276007                    ORQ     64,DL
         2 000355   100044 756100                    STQ     36,,PR1

      224     4733    3               FPT$OPNSCRB.V.ACS#=%SEQUEN#;

   4733  2 000356   000001 236007                    LDQ     1,DL
         2 000357   100046 552104                    STBQ    38,'04'O,PR1

      225     4734    3               CALL M$OPEN(FPT$OPNSCRB) ALTRET(ER_OPNT);

   4734  2 000360   100000 630500                    EPPR0   0,,PR1
         2 000361   450000 713400                    CLIMB   alt,open
         2 000362   410400 401760                    pmme    nvectors=18
         2 000363   001276 702000 2                  TSX2    ER_OPNT

      226     4735    3               GLOBAL.TJRNL.DCB#=GLOBAL.DCBNUMBER;

   4735  2 000364   000000 470400 xsym               LDP0    GLOBAL$
         2 000365   004623 235100                    LDA     2451,,PR0
         2 000366   002604 755100                    STA     1412,,PR0

      227     4736    3               END;

      228     4737    2           FILE.TYPE=T#FID;

   4737  2 000367   200004 470500                    LDP0    JRNL$,,AUTO
         2 000370   003000 236003                    LDQ     1536,DU
         2 000371   000001 552140                    STBQ    1,'40'O,PR0

      229     4738    2           FILE.TIME=GLOBAL.TIME.TSTAMP;

   4738  2 000372   000000 471400 xsym               LDP1    GLOBAL$
         2 000373   105001 235100                    LDA     2561,,PR1
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:50   
         2 000374   000000 755100                    STA     0,,PR0

      230     4739    2           FILE.USER#=B$JIT$->B$JIT.USER;

   4739  2 000375   000000 473400 xsym               LDP3    B$JIT$
         2 000376   300000 236100                    LDQ     0,,PR3
         2 000377   000001 552120                    STBQ    1,'20'O,PR0

      231     4740    2           FILE.DCB#=AWS.DDCB;

   4740  2 000400   200003 474500                    LDP4    AWS$,,AUTO
         2 000401   400006 220100                    LDX0    6,,PR4
         2 000402   000001 440100                    SXL0    1,,PR0

      232     4741    2           FILE.CRPT=AWS.ENCRP;

   4741  2 000403   400007 236100                    LDQ     7,,PR4
         2 000404   000002 756100                    STQ     2,,PR0

      233     4742    2           F$DCB$=DCBADDR(AWS.DDCB);

   4742  2 000405   000003 470400 3                  LDP0    3
         2 000406   000000 471500                    LDP1    0,,PR0
         2 000407   400006 220100                    LDX0    6,,PR4
         2 000410   100000 236110                    LDQ     0,X0,PR1
         2 000411   200031 756100                    STQ     F$DCB$,,AUTO

      234     4743    2           FILE.KEYED=AWS.ATRIB.KEYED;

   4743  2 000412   200004 470500                    LDP0    JRNL$,,AUTO
         2 000413   400000 236100                    LDQ     0,,PR4
         2 000414   000017 736000                    QLS     15
         2 000415   000003 676100                    ERQ     3,,PR0
         2 000416   400000 376003                    ANQ     -131072,DU
         2 000417   000003 656100                    ERSQ    3,,PR0

      235     4744    2           FILE.CHKSUM=AWS.ATRIB.CHKSUM;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:51   

   4744  2 000420   400000 236100                    LDQ     0,,PR4
         2 000421   000004 736000                    QLS     4
         2 000422   000003 676100                    ERQ     3,,PR0
         2 000423   200000 376003                    ANQ     65536,DU
         2 000424   000003 656100                    ERSQ    3,,PR0

      236     4745    2           FILE.ATMP=AWS.ATRIB.ATMP;

   4745  2 000425   400000 236100                    LDQ     0,,PR4
         2 000426   000011 736000                    QLS     9
         2 000427   000003 676100                    ERQ     3,,PR0
         2 000430   100000 376003                    ANQ     32768,DU
         2 000431   000003 656100                    ERSQ    3,,PR0

      237     4746    2           FILE.ID.ACCT#=F$DCB.ACCT#;

   4746  2 000432   200031 471500                    LDP1    F$DCB$,,AUTO
         2 000433   040100 100500                    MLR     fill='040'O
         2 000434   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         2 000435   000003 200010                    ADSC9   3,,PR0                   cn=1,n=8

      238     4747    2           FILE.ID.PASS#=F$DCB.PASS#;

   4747  2 000436   040100 100500                    MLR     fill='040'O
         2 000437   100022 000010                    ADSC9   18,,PR1                  cn=0,n=8
         2 000440   000005 200010                    ADSC9   5,,PR0                   cn=1,n=8

      239     4748    2           FILE.ID.PSN#=F$DCB.PSN#;

   4748  2 000441   040100 100500                    MLR     fill='040'O
         2 000442   100024 000006                    ADSC9   20,,PR1                  cn=0,n=6
         2 000443   000007 200006                    ADSC9   7,,PR0                   cn=1,n=6

      240     4749    2           FILE.ID.NAME#.L=F$DCB.NAME#.L;

   4749  2 000444   100010 236100                    LDQ     8,,PR1
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:52   
         2 000445   000033 772000                    QRL     27
         2 000446   000010 552104                    STBQ    8,'04'O,PR0

      241     4750    2           FILE.ID.NAME#.C=F$DCB.NAME#.C;

   4750  2 000447   040100 100500                    MLR     fill='040'O
         2 000450   100010 200037                    ADSC9   8,,PR1                   cn=1,n=31
         2 000451   000011 000037                    ADSC9   9,,PR0                   cn=0,n=31

      242     4751    2           FPT$WRTJ.BUF_.BOUND=SIZEV(FILE);

   4751  2 000452   200030 470500                    LDP0    WRTJ$,,AUTO
         2 000453   000004 236100                    LDQ     4,,PR0
         2 000454   177777 376007                    ANQ     65535,DL
         2 000455   000011 276000 3                  ORQ     9
         2 000456   000004 756100                    STQ     4,,PR0

      243     4752    2           IF AWS.ATRIB.CJRNL THEN

   4752  2 000457   400000 236100                    LDQ     0,,PR4
         2 000460   100000 316003                    CANQ    32768,DU
         2 000461   000471 600000 2                  TZE     s:4757

      244     4753    3           DO;

      245     4754    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4754  2 000462   000000 470400 xsym               LDP0    GLOBAL$
         2 000463   002610 720100                    LXL0    1416,,PR0
         2 000464   200030 470500                    LDP0    WRTJ$,,AUTO
         2 000465   000010 740100                    STX0    8,,PR0

      246     4755    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4755  2 000466   440001 713400                    CLIMB   alt,write
         2 000467   401400 401760                    pmme    nvectors=4
         2 000470   001245 702000 2                  TSX2    ER_WRTC
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:53   

      247     4756    3               END;

      248     4757    2           IF AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT THEN

   4757  2 000471   200003 470500                    LDP0    AWS$,,AUTO
         2 000472   000000 236100                    LDQ     0,,PR0
         2 000473   020000 316003                    CANQ    8192,DU
         2 000474   000477 601000 2                  TNZ     s:4759
         2 000475   400000 316007                    CANQ    -131072,DL
         2 000476   000550 600000 2                  TZE     s:4771

      249     4758    3           DO;

      250     4759    3               FILE.UNPROTECT=AWS.ATRIB.UNPROTECT;

   4759  2 000477   200004 471500                    LDP1    JRNL$,,AUTO
         2 000500   000015 736000                    QLS     13
         2 000501   100003 676100                    ERQ     3,,PR1
         2 000502   010000 376003                    ANQ     4096,DU
         2 000503   100003 656100                    ERSQ    3,,PR1

      251     4760    3               GLOBAL.PFIL$->FPT$PFIL.V.DCB#=GLOBAL.TJRNL.DCB#;

   4760  2 000504   000000 473400 xsym               LDP3    GLOBAL$
         2 000505   305114 474500                    LDP4    2636,,PR3
         2 000506   302604 720100                    LXL0    1412,,PR3
         2 000507   400002 740100                    STX0    2,,PR4

      252     4761    3               GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%YES#;

   4761  2 000510   305114 474500                    LDP4    2636,,PR3
         2 000511   400000 236007                    LDQ     -131072,DL
         2 000512   400002 256100                    ORSQ    2,,PR4

      253     4762    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:54   
   4762  2 000513   305114 474500                    LDP4    2636,,PR3
         2 000514   400000 630500                    EPPR0   0,,PR4
         2 000515   440004 713400                    CLIMB   alt,+16388
         2 000516   400000 401760                    pmme    nvectors=1
         2 000517   001313 702000 2                  TSX2    ER_WRTT

      254     4763    3               GLOBAL.PRECJ$->FPT$PRECJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4763  2 000520   000000 470400 xsym               LDP0    GLOBAL$
         2 000521   005124 471500                    LDP1    2644,,PR0
         2 000522   002604 720100                    LXL0    1412,,PR0
         2 000523   100006 740100                    STX0    6,,PR1

      255     4764    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=GLOBAL.TJRNL.FIDCOUNT;

   4764  2 000524   005124 471500                    LDP1    2644,,PR0
         2 000525   002605 235100                    LDA     1413,,PR0
         2 000526   100007 755100                    STA     7,,PR1

      256     4765    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

   4765  2 000527   005124 471500                    LDP1    2644,,PR0
         2 000530   100000 630500                    EPPR0   0,,PR1
         2 000531   440003 713400                    CLIMB   alt,+16387
         2 000532   401000 401760                    pmme    nvectors=3
         2 000533   001313 702000 2                  TSX2    ER_WRTT

      257     4766    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4766  2 000534   000000 470400 xsym               LDP0    GLOBAL$
         2 000535   002604 720100                    LXL0    1412,,PR0
         2 000536   200030 471500                    LDP1    WRTJ$,,AUTO
         2 000537   100010 740100                    STX0    8,,PR1

      258     4767    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   4767  2 000540   100000 630500                    EPPR0   0,,PR1
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:55   
         2 000541   440001 713400                    CLIMB   alt,write
         2 000542   401400 401760                    pmme    nvectors=4
         2 000543   001313 702000 2                  TSX2    ER_WRTT

      259     4768    3               GLOBAL.TJRNL.FIDCOUNT=GLOBAL.TJRNL.FIDCOUNT+1;

   4768  2 000544   000000 470400 xsym               LDP0    GLOBAL$
         2 000545   002605 235100                    LDA     1413,,PR0
         2 000546   000001 035007                    ADLA    1,DL
         2 000547   002605 755100                    STA     1413,,PR0

      260     4769    3               END;

      261     4770    2           END;

      262     4771    1       GOTO RET;

   4771  2 000550   001222 710000 2                  TRA     RET

      263     4772        %EJECT;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:56   
      264     4773    1   ZIM$JCLOSE: ENTRY;

   4773  2 000551   000000 700200 xent  ZIM$JCLOSE   TSX0  ! X66_AUTO_0
         2 000552   000034 000000                    ZERO    28,0

      265     4774    1       ERROR=0;

   4774  2 000553   200005 450100                    STZ     ERROR,,AUTO

      266     4775    1       AWS$=GLOBAL.PARAN.IO.AWS$;

   4775  2 000554   000000 470400 xsym               LDP0    GLOBAL$
         2 000555   000020 236100                    LDQ     16,,PR0
         2 000556   200003 756100                    STQ     AWS$,,AUTO

      267     4776    1       WRTJ$=GLOBAL.WRTJ$;

   4776  2 000557   005115 236100                    LDQ     2637,,PR0
         2 000560   200030 756100                    STQ     WRTJ$,,AUTO

      268     4777    1       JRNL$=ADDR(GLOBAL.JRECORD);

   4777  2 000561   000000 236000 xsym               LDQ     GLOBAL$
         2 000562   002622 036003                    ADLQ    1426,DU
         2 000563   200004 756100                    STQ     JRNL$,,AUTO

      269     4778    1       IF AWS.ATRIB.CJRNL AND ~GLOBAL.PENDING.ROLL THEN

   4778  2 000564   200003 471500                    LDP1    AWS$,,AUTO
         2 000565   100000 236100                    LDQ     0,,PR1
         2 000566   100000 316003                    CANQ    32768,DU
         2 000567   000627 600000 2                  TZE     s:4789
         2 000570   000017 236100                    LDQ     15,,PR0
         2 000571   000010 736000                    QLS     8
         2 000572   400000 376003                    ANQ     -131072,DU
         2 000573   400000 676003                    ERQ     -131072,DU
         2 000574   000627 600000 2                  TZE     s:4789
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:57   

      270     4779    2       DO;

      271     4780    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4780  2 000575   005117 473500                    LDP3    2639,,PR0
         2 000576   300000 630500                    EPPR0   0,,PR3
         2 000577   020004 713400                    CLIMB   8196
         2 000600   402000 401760                    pmme    nvectors=5

      272     4781    2           BERC.TYPE=T#CFID;

   4781  2 000601   200004 470500                    LDP0    JRNL$,,AUTO
         2 000602   004000 236003                    LDQ     2048,DU
         2 000603   000001 552140                    STBQ    1,'40'O,PR0

      273     4782    2           BERC.TIME=GLOBAL.TIME.TSTAMP;

   4782  2 000604   000000 471400 xsym               LDP1    GLOBAL$
         2 000605   105001 235100                    LDA     2561,,PR1
         2 000606   000000 755100                    STA     0,,PR0

      274     4783    2           BERC.USER#=B$JIT$->B$JIT.USER;

   4783  2 000607   000000 473400 xsym               LDP3    B$JIT$
         2 000610   300000 236100                    LDQ     0,,PR3
         2 000611   000001 552120                    STBQ    1,'20'O,PR0

      275     4784    2           BERC.DCB#=AWS.DDCB;

   4784  2 000612   200003 474500                    LDP4    AWS$,,AUTO
         2 000613   400006 220100                    LDX0    6,,PR4
         2 000614   000001 440100                    SXL0    1,,PR0

      276     4785    2           FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);

   4785  2 000615   200030 470500                    LDP0    WRTJ$,,AUTO
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:58   
         2 000616   000004 236100                    LDQ     4,,PR0
         2 000617   177777 376007                    ANQ     65535,DL
         2 000620   000007 276000 3                  ORQ     7
         2 000621   000004 756100                    STQ     4,,PR0

      277     4786    2           FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4786  2 000622   102610 720100                    LXL0    1416,,PR1
         2 000623   000010 740100                    STX0    8,,PR0

      278     4787    2           CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4787  2 000624   440001 713400                    CLIMB   alt,write
         2 000625   401400 401760                    pmme    nvectors=4
         2 000626   001245 702000 2                  TSX2    ER_WRTC

      279     4788    2           END;

      280     4789    1       IF (AWS.ATRIB.TJRNL OR AWS.ATRIB.UNPROTECT) AND

   4789  2 000627   200003 470500                    LDP0    AWS$,,AUTO
         2 000630   000000 236100                    LDQ     0,,PR0
         2 000631   020000 316003                    CANQ    8192,DU
         2 000632   000635 601000 2                  TNZ     s:4789+6
         2 000633   400000 316007                    CANQ    -131072,DL
         2 000634   001066 600000 2                  TZE     s:4830
         2 000635   000000 471400 xsym               LDP1    GLOBAL$
         2 000636   100017 430100                    FSZN    15,,PR1
         2 000637   001066 604000 2                  TMI     s:4830

      281     4790    1          GLOBAL.PENDING.ROLL='0'B THEN /* FID IS IN *I */
      282     4791    2       DO;

      283     4792    2           GLOBAL.TJRNL.FIDCOUNT=GLOBAL.TJRNL.FIDCOUNT-1;

   4792  2 000640   102605 235100                    LDA     1413,,PR1
         2 000641   000001 135007                    SBLA    1,DL
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:59   
         2 000642   102605 755100                    STA     1413,,PR1

      284     4793    2           GLOBAL.PFIL$->FPT$PFIL.V.DCB#=GLOBAL.TJRNL.DCB#;

   4793  2 000643   105114 473500                    LDP3    2636,,PR1
         2 000644   102604 720100                    LXL0    1412,,PR1
         2 000645   300002 740100                    STX0    2,,PR3

      285     4794    2           GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%YES#;

   4794  2 000646   105114 473500                    LDP3    2636,,PR1
         2 000647   400000 236007                    LDQ     -131072,DL
         2 000650   300002 256100                    ORSQ    2,,PR3

      286     4795    2           CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);

   4795  2 000651   105114 473500                    LDP3    2636,,PR1
         2 000652   300000 630500                    EPPR0   0,,PR3
         2 000653   440004 713400                    CLIMB   alt,+16388
         2 000654   400000 401760                    pmme    nvectors=1
         2 000655   001313 702000 2                  TSX2    ER_WRTT

      287     4796    2           GLOBAL.PRECJ$->FPT$PRECJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4796  2 000656   000000 470400 xsym               LDP0    GLOBAL$
         2 000657   005124 471500                    LDP1    2644,,PR0
         2 000660   002604 720100                    LXL0    1412,,PR0
         2 000661   100006 740100                    STX0    6,,PR1

      288     4797    2           GLOBAL.PRECJ$->FPT$PRECJ.V.N#=GLOBAL.TJRNL.FIDCOUNT;

   4797  2 000662   005124 471500                    LDP1    2644,,PR0
         2 000663   002605 235100                    LDA     1413,,PR0
         2 000664   100007 755100                    STA     7,,PR1

      289     4798    2           CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:60   
   4798  2 000665   005124 471500                    LDP1    2644,,PR0
         2 000666   100000 630500                    EPPR0   0,,PR1
         2 000667   440003 713400                    CLIMB   alt,+16387
         2 000670   401000 401760                    pmme    nvectors=3
         2 000671   001313 702000 2                  TSX2    ER_WRTT

      290     4799    2           GLOBAL.READJ$->FPT$READJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4799  2 000672   000000 470400 xsym               LDP0    GLOBAL$
         2 000673   005116 471500                    LDP1    2638,,PR0
         2 000674   002604 720100                    LXL0    1412,,PR0
         2 000675   100010 740100                    STX0    8,,PR1

      291     4800    2           CALL M$READ(GLOBAL.READJ$->FPT$READJ) ALTRET(ER_WRTT);

   4800  2 000676   005116 471500                    LDP1    2638,,PR0
         2 000677   100000 630500                    EPPR0   0,,PR1
         2 000700   440000 713400                    CLIMB   alt,read
         2 000701   401400 401760                    pmme    nvectors=4
         2 000702   001313 702000 2                  TSX2    ER_WRTT

      292     4801    2           FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4801  2 000703   000000 470400 xsym               LDP0    GLOBAL$
         2 000704   002604 720100                    LXL0    1412,,PR0
         2 000705   200030 471500                    LDP1    WRTJ$,,AUTO
         2 000706   100010 740100                    STX0    8,,PR1

      293     4802    3           IF AWS.DDCB~=FILE.DCB# THEN DO;

   4802  2 000707   200004 473500                    LDP3    JRNL$,,AUTO
         2 000710   300001 721100                    LXL1    1,,PR3
         2 000711   200003 474500                    LDP4    AWS$,,AUTO
         2 000712   400006 101100                    CMPX1   6,,PR4
         2 000713   001015 600000 2                  TZE     s:4820

      294     4803    3               FIDRECORD=GLOBAL.JRECORD;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:61   

   4803  2 000714   000100 100500                    MLR     fill='000'O
         2 000715   002622 000103                    ADSC9   1426,,PR0                cn=0,n=67
         2 000716   200007 000103                    ADSC9   FIDRECORD,,AUTO          cn=0,n=67

      295     4804    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);

   4804  2 000717   005114 471500                    LDP1    2636,,PR0
         2 000720   100000 630500                    EPPR0   0,,PR1
         2 000721   440004 713400                    CLIMB   alt,+16388
         2 000722   400000 401760                    pmme    nvectors=1
         2 000723   001313 702000 2                  TSX2    ER_WRTT

      296     4805    4               DO WHILE (AWS.DDCB~=FILE.DCB#);

   4805  2 000724   200004 470500                    LDP0    JRNL$,,AUTO
         2 000725   000001 720100                    LXL0    1,,PR0
         2 000726   200003 471500                    LDP1    AWS$,,AUTO
         2 000727   100006 100100                    CMPX0   6,,PR1
         2 000730   000750 600000 2                  TZE     s:4810

      297     4806    4                   CALL M$READ(GLOBAL.READJ$->FPT$READJ) ALTRET(ER_WRTT);

   4806  2 000731   000000 470400 xsym               LDP0    GLOBAL$
         2 000732   005116 471500                    LDP1    2638,,PR0
         2 000733   100000 630500                    EPPR0   0,,PR1
         2 000734   440000 713400                    CLIMB   alt,read
         2 000735   401400 401760                    pmme    nvectors=4
         2 000736   001313 702000 2                  TSX2    ER_WRTT

      298     4807    4                   IF FILE.TYPE~=T#FID THEN

   4807  2 000737   200004 470500                    LDP0    JRNL$,,AUTO
         2 000740   000001 236100                    LDQ     1,,PR0
         2 000741   777000 376003                    ANQ     -512,DU
         2 000742   003000 116003                    CMPQ    1536,DU
         2 000743   001313 601000 2                  TNZ     ER_WRTT
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:62   

      299     4808    4                       GOTO ER_WRTT;
      300     4809    4                   END;

   4809  2 000744   000001 720100                    LXL0    1,,PR0
         2 000745   200003 471500                    LDP1    AWS$,,AUTO
         2 000746   100006 100100                    CMPX0   6,,PR1
         2 000747   000731 601000 2                  TNZ     s:4806

      301     4810    3               GLOBAL.JRECORD=FIDRECORD;

   4810  2 000750   000000 473400 xsym               LDP3    GLOBAL$
         2 000751   010000 221003                    LDX1    4096,DU
         2 000752   000140 100500                    MLR     fill='000'O
         2 000753   200007 000103                    ADSC9   FIDRECORD,,AUTO          cn=0,n=67
         2 000754   302622 000011                    ADSC9   1426,,PR3                cn=0,n=*X1

      302     4811    3               FPT$WRTJ.BUF_.BOUND=SIZEV(FILE);

   4811  2 000755   200030 474500                    LDP4    WRTJ$,,AUTO
         2 000756   400004 236100                    LDQ     4,,PR4
         2 000757   177777 376007                    ANQ     65535,DL
         2 000760   000011 276000 3                  ORQ     9
         2 000761   400004 756100                    STQ     4,,PR4

      303     4812    3               FPT$WRTJ.V.REWRITE#=%YES#;

   4812  2 000762   000100 236007                    LDQ     64,DL
         2 000763   400010 256100                    ORSQ    8,,PR4

      304     4813    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_REWRTT);

   4813  2 000764   400000 630500                    EPPR0   0,,PR4
         2 000765   440001 713400                    CLIMB   alt,write
         2 000766   401400 401760                    pmme    nvectors=4
         2 000767   001310 702000 2                  TSX2    ER_REWRTT

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:63   
      305     4814    3               FPT$WRTJ.V.REWRITE#=%NO#;

   4814  2 000770   200030 470500                    LDP0    WRTJ$,,AUTO
         2 000771   000012 236000 3                  LDQ     10
         2 000772   000010 356100                    ANSQ    8,,PR0

      306     4815    3               GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%NO#;

   4815  2 000773   000000 471400 xsym               LDP1    GLOBAL$
         2 000774   105114 473500                    LDP3    2636,,PR1
         2 000775   000013 236000 3                  LDQ     11
         2 000776   300002 356100                    ANSQ    2,,PR3

      307     4816    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-1;

   4816  2 000777   105124 473500                    LDP3    2644,,PR1
         2 001000   000001 335007                    LCA     1,DL
         2 001001   300007 755100                    STA     7,,PR3

      308     4817    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);

   4817  2 001002   105114 473500                    LDP3    2636,,PR1
         2 001003   300000 630500                    EPPR0   0,,PR3
         2 001004   440004 713400                    CLIMB   alt,+16388
         2 001005   400000 401760                    pmme    nvectors=1
         2 001006   001313 702000 2                  TSX2    ER_WRTT

      309     4818    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

   4818  2 001007   000000 470400 xsym               LDP0    GLOBAL$
         2 001010   005124 471500                    LDP1    2644,,PR0
         2 001011   100000 630500                    EPPR0   0,,PR1
         2 001012   440003 713400                    CLIMB   alt,+16387
         2 001013   401000 401760                    pmme    nvectors=3
         2 001014   001313 702000 2                  TSX2    ER_WRTT

      310     4819    3               END; /* FILE IS POSITIONED TO THE LAST REC(T#CKPT) */
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:64   

      311     4820    2           CALL M$READ(GLOBAL.READJ$->FPT$READJ) ALTRET(E_O_F);

   4820  2 001015   000000 470400 xsym               LDP0    GLOBAL$
         2 001016   005116 471500                    LDP1    2638,,PR0
         2 001017   100000 630500                    EPPR0   0,,PR1
         2 001020   440000 713400                    CLIMB   alt,read
         2 001021   401400 401760                    pmme    nvectors=4
         2 001022   001267 702000 2                  TSX2    E_O_F

      312     4821    2           GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-2;

   4821  2 001023   000000 470400 xsym               LDP0    GLOBAL$
         2 001024   005124 471500                    LDP1    2644,,PR0
         2 001025   000002 335007                    LCA     2,DL
         2 001026   100007 755100                    STA     7,,PR1

      313     4822    2           CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

   4822  2 001027   005124 471500                    LDP1    2644,,PR0
         2 001030   100000 630500                    EPPR0   0,,PR1
         2 001031   440003 713400                    CLIMB   alt,+16387
         2 001032   401000 401760                    pmme    nvectors=3
         2 001033   001313 702000 2                  TSX2    ER_WRTT

      314     4823    2           FPT$WRTJ.BUF_.BOUND=SIZEV(CKPT)-SIZEC(CKPT.FILLER);

   4823  2 001034   200030 470500                    LDP0    WRTJ$,,AUTO
         2 001035   000004 236100                    LDQ     4,,PR0
         2 001036   177777 376007                    ANQ     65535,DL
         2 001037   000014 276000 3                  ORQ     12
         2 001040   000004 756100                    STQ     4,,PR0

      315     4824    2           CALL M$WRITE(FPT$WRTJ) ALTRET(ER_REWRTT);

   4824  2 001041   440001 713400                    CLIMB   alt,write
         2 001042   401400 401760                    pmme    nvectors=4
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:65   
         2 001043   001310 702000 2                  TSX2    ER_REWRTT

      316     4825    2           GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-1;

   4825  2 001044   000000 470400 xsym               LDP0    GLOBAL$
         2 001045   005124 471500                    LDP1    2644,,PR0
         2 001046   000001 335007                    LCA     1,DL
         2 001047   100007 755100                    STA     7,,PR1

      317     4826    2           CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

   4826  2 001050   005124 471500                    LDP1    2644,,PR0
         2 001051   100000 630500                    EPPR0   0,,PR1
         2 001052   440003 713400                    CLIMB   alt,+16387
         2 001053   401000 401760                    pmme    nvectors=3
         2 001054   001313 702000 2                  TSX2    ER_WRTT

      318     4827    2           GLOBAL.TRUNC$->FPT$TRUNC.V.DCB#=GLOBAL.TJRNL.DCB#;

   4827  2 001055   000000 470400 xsym               LDP0    GLOBAL$
         2 001056   005121 471500                    LDP1    2641,,PR0
         2 001057   002604 720100                    LXL0    1412,,PR0
         2 001060   100002 740100                    STX0    2,,PR1

      319     4828    2           CALL M$TRUNC(GLOBAL.TRUNC$->FPT$TRUNC) ALTRET(ER_WRTT);

   4828  2 001061   005121 471500                    LDP1    2641,,PR0
         2 001062   100000 630500                    EPPR0   0,,PR1
         2 001063   450003 713400                    CLIMB   alt,+20483
         2 001064   400000 401760                    pmme    nvectors=1
         2 001065   001313 702000 2                  TSX2    ER_WRTT

      320     4829    2           END;

      321     4830    1       GOTO RET;

   4830  2 001066   001222 710000 2                  TRA     RET
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:66   

      322     4831        %EJECT;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:67   
      323     4832    1   ZIM$JEND: ENTRY;

   4832  2 001067   000000 700200 xent  ZIM$JEND     TSX0  ! X66_AUTO_0
         2 001070   000034 000000                    ZERO    28,0

      324     4833    1       ERROR=0;

   4833  2 001071   200005 450100                    STZ     ERROR,,AUTO

      325     4834    1       IF GLOBAL.TJRNL.DCB#~=0 THEN

   4834  2 001072   000000 470400 xsym               LDP0    GLOBAL$
         2 001073   002604 235100                    LDA     1412,,PR0
         2 001074   001130 600000 2                  TZE     s:4846

      326     4835    2       DO;

      327     4836    2           DCB#=GLOBAL.TJRNL.DCB#;

   4836  2 001075   200006 755100                    STA     DCB#,,AUTO

      328     4837    2           GLOBAL.TJRNL.DCB#=0;

   4837  2 001076   002604 450100                    STZ     1412,,PR0

      329     4838    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=DCB#;

   4838  2 001077   005072 471500                    LDP1    2618,,PR0
         2 001100   000000 620005                    EAX0    0,AL
         2 001101   100032 740100                    STX0    26,,PR1

      330     4839    2           IF ~ZI_TEST THEN

   4839  2 001102   000000 236000 xsym               LDQ     ZI_TEST
         2 001103   400000 376003                    ANQ     -131072,DU
         2 001104   400000 676003                    ERQ     -131072,DU
         2 001105   001111 600000 2                  TZE     s:4841
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:68   

      331     4840    2               GLOBAL.CLOSE$->FPT$CLOSE.V.DISP#=%RELEASE#;

   4840  2 001106   005072 471500                    LDP1    2618,,PR0
         2 001107   000001 236007                    LDQ     1,DL
         2 001110   100032 552104                    STBQ    26,'04'O,PR1

      332     4841    2           CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);

   4841  2 001111   005072 471500                    LDP1    2618,,PR0
         2 001112   100000 630500                    EPPR0   0,,PR1
         2 001113   050001 713400                    CLIMB   close
         2 001114   406000 401760                    pmme    nvectors=13

      333     4842    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DISP#=%NAMED#;

   4842  2 001115   000000 470400 xsym               LDP0    GLOBAL$
         2 001116   005072 471500                    LDP1    2618,,PR0
         2 001117   000002 236007                    LDQ     2,DL
         2 001120   100032 552104                    STBQ    26,'04'O,PR1

      334     4843    2           GLOBAL.RELDCB$->FPT$RELDCB.V.DCB#=DCB#;

   4843  2 001121   005105 471500                    LDP1    2629,,PR0
         2 001122   200006 720100                    LXL0    DCB#,,AUTO
         2 001123   100002 740100                    STX0    2,,PR1

      335     4844    2           CALL M$RELDCB(GLOBAL.RELDCB$->FPT$RELDCB);

   4844  2 001124   005105 471500                    LDP1    2629,,PR0
         2 001125   100000 630500                    EPPR0   0,,PR1
         2 001126   060003 713400                    CLIMB   24579
         2 001127   400000 401760                    pmme    nvectors=1

      336     4845    2           END;

      337     4846    1       IF GLOBAL.CJRNL.DCB#~=0 THEN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:69   

   4846  2 001130   000000 470400 xsym               LDP0    GLOBAL$
         2 001131   002610 235100                    LDA     1416,,PR0
         2 001132   001222 600000 2                  TZE     RET

      338     4847    2       DO;

      339     4848    2           IF ~GLOBAL.PENDING.ROLL THEN

   4848  2 001133   000017 236100                    LDQ     15,,PR0
         2 001134   000010 736000                    QLS     8
         2 001135   400000 376003                    ANQ     -131072,DU
         2 001136   400000 676003                    ERQ     -131072,DU
         2 001137   001177 600000 2                  TZE     s:4861

      340     4849    3           DO; /* Don't write end if abort during rollback */

      341     4850    3               JRNL$=ADDR(GLOBAL.JRECORD);

   4850  2 001140   000000 236000 xsym               LDQ     GLOBAL$
         2 001141   002622 036003                    ADLQ    1426,DU
         2 001142   200004 756100                    STQ     JRNL$,,AUTO

      342     4851    3               CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4851  2 001143   005117 471500                    LDP1    2639,,PR0
         2 001144   100000 630500                    EPPR0   0,,PR1
         2 001145   020004 713400                    CLIMB   8196
         2 001146   402000 401760                    pmme    nvectors=5

      343     4852    3               BERC.TYPE=T#END;

   4852  2 001147   200004 470500                    LDP0    JRNL$,,AUTO
         2 001150   002000 236003                    LDQ     1024,DU
         2 001151   000001 552140                    STBQ    1,'40'O,PR0

      344     4853    3               BERC.TIME=GLOBAL.TIME.TSTAMP;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:70   

   4853  2 001152   000000 471400 xsym               LDP1    GLOBAL$
         2 001153   105001 235100                    LDA     2561,,PR1
         2 001154   000000 755100                    STA     0,,PR0

      345     4854    3               BERC.USER#=B$JIT$->B$JIT.USER;

   4854  2 001155   000000 473400 xsym               LDP3    B$JIT$
         2 001156   300000 236100                    LDQ     0,,PR3
         2 001157   000001 552120                    STBQ    1,'20'O,PR0

      346     4855    3               BERC.SYSID=B$JIT$->B$JIT.SYSID;

   4855  2 001160   300000 720100                    LXL0    0,,PR3
         2 001161   000001 440100                    SXL0    1,,PR0

      347     4856    3               WRTJ$=GLOBAL.WRTJ$;

   4856  2 001162   105115 236100                    LDQ     2637,,PR1
         2 001163   200030 756100                    STQ     WRTJ$,,AUTO

      348     4857    3               FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);

   4857  2 001164   200030 474500                    LDP4    WRTJ$,,AUTO
         2 001165   400004 236100                    LDQ     4,,PR4
         2 001166   177777 376007                    ANQ     65535,DL
         2 001167   000007 276000 3                  ORQ     7
         2 001170   400004 756100                    STQ     4,,PR4

      349     4858    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4858  2 001171   102610 720100                    LXL0    1416,,PR1
         2 001172   400010 740100                    STX0    8,,PR4

      350     4859    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4859  2 001173   400000 630500                    EPPR0   0,,PR4
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:71   
         2 001174   440001 713400                    CLIMB   alt,write
         2 001175   401400 401760                    pmme    nvectors=4
         2 001176   001245 702000 2                  TSX2    ER_WRTC

      351     4860    3               END;

      352     4861    2           DCB#=GLOBAL.CJRNL.DCB#;

   4861  2 001177   000000 470400 xsym               LDP0    GLOBAL$
         2 001200   002610 235100                    LDA     1416,,PR0
         2 001201   200006 755100                    STA     DCB#,,AUTO

      353     4862    2           GLOBAL.CJRNL.DCB#=0;

   4862  2 001202   002610 450100                    STZ     1416,,PR0

      354     4863    2           GLOBAL.CLOSE$->FPT$CLOSE.V.DCB#=DCB#;

   4863  2 001203   005072 471500                    LDP1    2618,,PR0
         2 001204   000000 620005                    EAX0    0,AL
         2 001205   100032 740100                    STX0    26,,PR1

      355     4864    2           CALL M$CLOSE(GLOBAL.CLOSE$->FPT$CLOSE);

   4864  2 001206   005072 471500                    LDP1    2618,,PR0
         2 001207   100000 630500                    EPPR0   0,,PR1
         2 001210   050001 713400                    CLIMB   close
         2 001211   406000 401760                    pmme    nvectors=13

      356     4865    2           GLOBAL.RELDCB$->FPT$RELDCB.V.DCB#=DCB#;

   4865  2 001212   000000 470400 xsym               LDP0    GLOBAL$
         2 001213   005105 471500                    LDP1    2629,,PR0
         2 001214   200006 720100                    LXL0    DCB#,,AUTO
         2 001215   100002 740100                    STX0    2,,PR1

      357     4866    2           CALL M$RELDCB(GLOBAL.RELDCB$->FPT$RELDCB);
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:72   

   4866  2 001216   005105 471500                    LDP1    2629,,PR0
         2 001217   100000 630500                    EPPR0   0,,PR1
         2 001220   060003 713400                    CLIMB   24579
         2 001221   400000 401760                    pmme    nvectors=1

      358     4867    2           END;

      359     4868    1   RET: RETURN;

   4868  2 001222   000000 702200 xent  RET          TSX2  ! X66_ARET

      360     4869    1   ER_GDCB: ERROR=ERR#IO#GDCB;

   4869  2 001223   210676 235007       ER_GDCB      LDA     70078,DL
         2 001224   200005 755100                    STA     ERROR,,AUTO

      361     4870    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4870  2 001225   000000 470400 xsym               LDP0    B$TCB$
         2 001226   000000 471500                    LDP1    0,,PR0
         2 001227   100102 236100                    LDQ     66,,PR1
         2 001230   000000 473400 xsym               LDP3    GLOBAL$
         2 001231   300007 756100                    STQ     7,,PR3

      362     4871    1       GOTO ALT;

   4871  2 001232   001325 710000 2                  TRA     ALT

      363     4872    1   ER_OPNC: ERROR=ERR#IO#OPNC;

   4872  2 001233   210717 235007       ER_OPNC      LDA     70095,DL
         2 001234   200005 755100                    STA     ERROR,,AUTO

      364     4873    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4873  2 001235   000000 470400 xsym               LDP0    B$TCB$
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:73   
         2 001236   000000 471500                    LDP1    0,,PR0
         2 001237   100102 236100                    LDQ     66,,PR1
         2 001240   000000 473400 xsym               LDP3    GLOBAL$
         2 001241   300007 756100                    STQ     7,,PR3

      365     4874    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;

   4874  2 001242   304623 720100                    LXL0    2451,,PR3
         2 001243   300014 740100                    STX0    12,,PR3

      366     4875    1       GOTO ALT;

   4875  2 001244   001325 710000 2                  TRA     ALT

      367     4876    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   4876  2 001245   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         2 001246   000000 471500                    LDP1    0,,PR0
         2 001247   100102 236100                    LDQ     66,,PR1
         2 001250   377770 376007                    ANQ     131064,DL
         2 001251   001160 116007                    CMPQ    624,DL
         2 001252   001256 601000 2                  TNZ     s:4879

      368     4877    1           ERROR=ERR#IO#NOOWNER;

   4877  2 001253   210762 235007                    LDA     70130,DL
         2 001254   200005 755100                    STA     ERROR,,AUTO
         2 001255   001260 710000 2                  TRA     s:4880

      369     4878    1       ELSE
      370     4879    1           ERROR=ERR#IO#WRTC;

   4879  2 001256   210721 235007                    LDA     70097,DL
         2 001257   200005 755100                    STA     ERROR,,AUTO

      371     4880    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:74   
   4880  2 001260   100102 236100                    LDQ     66,,PR1
         2 001261   000000 473400 xsym               LDP3    GLOBAL$
         2 001262   300007 756100                    STQ     7,,PR3

      372     4881    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   4881  2 001263   302610 720100                    LXL0    1416,,PR3
         2 001264   300014 740100                    STX0    12,,PR3

      373     4882    1       GLOBAL.CJRNL.DCB#=0;

   4882  2 001265   302610 450100                    STZ     1416,,PR3

      374     4883    1       GOTO ALT;

   4883  2 001266   001325 710000 2                  TRA     ALT

      375     4884    1   E_O_F: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$EOF THEN

   4884  2 001267   000000 470400 xsym  E_O_F        LDP0    B$TCB$
         2 001270   000000 471500                    LDP1    0,,PR0
         2 001271   100102 236100                    LDQ     66,,PR1
         2 001272   377770 376007                    ANQ     131064,DL
         2 001273   000060 116007                    CMPQ    48,DL
         2 001274   001222 600000 2                  TZE     RET

      376     4885    1           GOTO RET;
      377     4886    1       GOTO ER_WRTT;

   4886  2 001275   001313 710000 2                  TRA     ER_WRTT

      378     4887    1   ER_OPNT: ERROR=ERR#IO#OPNT;

   4887  2 001276   210716 235007       ER_OPNT      LDA     70094,DL
         2 001277   200005 755100                    STA     ERROR,,AUTO

      379     4888    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:75   

   4888  2 001300   000000 470400 xsym               LDP0    B$TCB$
         2 001301   000000 471500                    LDP1    0,,PR0
         2 001302   100102 236100                    LDQ     66,,PR1
         2 001303   000000 473400 xsym               LDP3    GLOBAL$
         2 001304   300007 756100                    STQ     7,,PR3

      380     4889    1       GLOBAL.RET.DCB#=GLOBAL.DCBNUMBER;

   4889  2 001305   304623 720100                    LXL0    2451,,PR3
         2 001306   300014 740100                    STX0    12,,PR3

      381     4890    1       GOTO ALT;

   4890  2 001307   001325 710000 2                  TRA     ALT

      382     4891    1   ER_REWRTT: FPT$WRTJ.V.REWRITE#=%NO#;

   4891  2 001310   200030 470500       ER_REWRTT    LDP0    WRTJ$,,AUTO
         2 001311   000012 236000 3                  LDQ     10
         2 001312   000010 356100                    ANSQ    8,,PR0

      383     4892    1   ER_WRTT: ERROR=ERR#IO#WRTT;

   4892  2 001313   210720 235007       ER_WRTT      LDA     70096,DL
         2 001314   200005 755100                    STA     ERROR,,AUTO

      384     4893    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4893  2 001315   000000 470400 xsym               LDP0    B$TCB$
         2 001316   000000 471500                    LDP1    0,,PR0
         2 001317   100102 236100                    LDQ     66,,PR1
         2 001320   000000 473400 xsym               LDP3    GLOBAL$
         2 001321   300007 756100                    STQ     7,,PR3

      385     4894    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:76   
   4894  2 001322   302604 720100                    LXL0    1412,,PR3
         2 001323   300014 740100                    STX0    12,,PR3

      386     4895    1       GOTO ALT;

   4895  2 001324   001325 710000 2                  TRA     ALT

   4894  2 001325                       ALT          null
      387     4896    1   ALT: ;
      388     4897    1       GLOBAL.RET.ERROR#=ERROR;

   4897  2 001325   300006 755100                    STA     6,,PR3

      389     4898    1       CALL M$ERR;

   4898  2 001326   000002 713400                    CLIMB   err
         2 001327   000000 401760                    pmme    nvectors=0

      390     4899    1   END ZIM$JBEGIN;

   4899  2 001330   000000 702200 xent               TSX2  ! X66_ARET

DEVICE
 Sect OctLoc
   1     000   106111 114105                                                    FILE

(unnamed)
 Sect OctLoc
   1     001   112117 125122   116101 114040   124112 122116   114040 040040    JOURNAL TJRNL
   1     005   052112 040040   040040 040040   052111 040040                    *J      *I

(unnamed)
 Sect OctLoc
   3     000   777777 577777   777777 777637   040040 040040   000000 006003    ........    ....
   3     004   777777 777177   777777 777760   000000 006014   000001 600000    ................
   3     010   777777 777747   000020 600000   777777 777677   777777 377777    ................
   3     014   000004 200000                                                    ....
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:77   
      391     4900        %EOD;

PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:78   
--  Include file information  --

   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JBEGIN.

   Procedure ZIM$JBEGIN requires 729 words for executable code.
   Procedure ZIM$JBEGIN requires 28 words of local(AUTO) storage.
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:79   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:80   
          MINI XREF LISTING

ALT
      4894**LABEL    4871--GOTO     4875--GOTO     4883--GOTO     4890--GOTO     4895--GOTO
AWS.ATRIB.ATMP
      1458**DCL      4745>>ASSIGN
AWS.ATRIB.CHKSUM
      1453**DCL      4744>>ASSIGN
AWS.ATRIB.CJRNL
      1450**DCL      4651>>IF       4657>>IF       4752>>IF       4778>>IF
AWS.ATRIB.KEYED
      1461**DCL      4743>>ASSIGN
AWS.ATRIB.TJRNL
      1452**DCL      4651>>IF       4705>>IF       4757>>IF       4789>>IF
AWS.ATRIB.UNPROTECT
      1464**DCL      4651>>IF       4705>>IF       4757>>IF       4759>>ASSIGN   4789>>IF
AWS.DDCB
      1471**DCL      4740>>ASSIGN   4742--ASSIGN   4784>>ASSIGN   4802>>IF       4805>>DOWHILE
AWS.ENCRP
      1473**DCL      4741>>ASSIGN
AWS.HIGHPG
      1469**DCL      4671>>ASSIGN   4672>>ASSIGN
AWS$
      1445**DCL      1446--IMP-PTR  4650<<ASSIGN   4651>>IF       4651>>IF       4651>>IF       4657>>IF
      4671>>ASSIGN   4672>>ASSIGN   4705>>IF       4705>>IF       4740>>ASSIGN   4741>>ASSIGN   4742>>ASSIGN
      4743>>ASSIGN   4744>>ASSIGN   4745>>ASSIGN   4752>>IF       4757>>IF       4757>>IF       4759>>ASSIGN
      4775<<ASSIGN   4778>>IF       4784>>ASSIGN   4789>>IF       4789>>IF       4802>>IF       4805>>DOWHILE
B$ALT.CODE
      2043**DCL      2043--REDEF    2044--REDEF    2044--REDEF
B$ALT.ERR
      2044**DCL      4870>>ASSIGN   4873>>ASSIGN   4880>>ASSIGN   4888>>ASSIGN   4893>>ASSIGN
B$ALT.ERR.ERR#
      2045**DCL      2045--REDEF    4876>>IF       4884>>IF
B$ALT.EVID
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:81   
      2044**DCL      2044--REDEF    2044--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1775**DCL      1775--REDEF
B$JIT.ERR.MID
      1682**DCL      1682--REDEF
B$JIT.JRESPEAK
      1843**DCL      1844--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      1952**DCL      1952--REDEF    1953--REDEF
B$JIT.PNR
      1856**DCL      1856--REDEF
B$JIT.SYSID
      1681**DCL      4700>>ASSIGN   4855>>ASSIGN
B$JIT.TSLINE
      1950**DCL      1951--REDEF
B$JIT.USER
      1681**DCL      4699>>ASSIGN   4739>>ASSIGN   4783>>ASSIGN   4854>>ASSIGN
B$JIT$
      4645**DCL      1676--IMP-PTR  4699>>ASSIGN   4700>>ASSIGN   4739>>ASSIGN   4783>>ASSIGN   4854>>ASSIGN
      4855>>ASSIGN
B$TCB.ALT$
      2039**DCL      4870>>ASSIGN   4873>>ASSIGN   4876>>IF       4880>>ASSIGN   4884>>IF       4888>>ASSIGN
      4893>>ASSIGN
B$TCB$
      4646**DCL      4870>>ASSIGN   4873>>ASSIGN   4876>>IF       4880>>ASSIGN   4884>>IF       4888>>ASSIGN
      4893>>ASSIGN
BERC
      1631**DCL      4701--ASSIGN   4785--ASSIGN   4857--ASSIGN
BERC.DCB#
      1635**DCL      1636--REDEF    4784<<ASSIGN
BERC.SYSID
      1636**DCL      4700<<ASSIGN   4855<<ASSIGN
BERC.TIME
      1632**DCL      4698<<ASSIGN   4782<<ASSIGN   4853<<ASSIGN
BERC.TYPE
      1633**DCL      4697<<ASSIGN   4781<<ASSIGN   4852<<ASSIGN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:82   
BERC.USER#
      1634**DCL      4699<<ASSIGN   4783<<ASSIGN   4854<<ASSIGN
CKPT
      1637**DCL      4823--ASSIGN
CKPT.FILLER
      1645**DCL      4823--ASSIGN
DCB#
      4639**DCL      4836<<ASSIGN   4838>>ASSIGN   4843>>ASSIGN   4861<<ASSIGN   4863>>ASSIGN   4865>>ASSIGN
ERROR
      4638**DCL      4649<<ASSIGN   4774<<ASSIGN   4833<<ASSIGN   4869<<ASSIGN   4872<<ASSIGN   4877<<ASSIGN
      4879<<ASSIGN   4887<<ASSIGN   4892<<ASSIGN   4897>>ASSIGN
ER_GDCB
      4869**LABEL    4711--CALLALT
ER_OPNC
      4872**LABEL    4664--CALLALT  4667--CALLALT  4678--CALLALT  4692--GOTO
ER_OPNT
      4887**LABEL    4734--CALLALT
ER_REWRTT
      4891**LABEL    4813--CALLALT  4824--CALLALT
ER_WRTC
      4876**LABEL    4703--CALLALT  4755--CALLALT  4787--CALLALT  4859--CALLALT
ER_WRTT
      4892**LABEL    4762--CALLALT  4765--CALLALT  4767--CALLALT  4795--CALLALT  4798--CALLALT  4800--CALLALT
      4804--CALLALT  4806--CALLALT  4808--GOTO     4817--CALLALT  4818--CALLALT  4822--CALLALT  4826--CALLALT
      4828--CALLALT  4886--GOTO
E_O_F
      4884**LABEL    4820--CALLALT
F$DCB.ACCT#
      2603**DCL      4746>>ASSIGN
F$DCB.ACTPOS
      2619**DCL      2619--REDEF
F$DCB.ARS#
      2593**DCL      2593--REDEF
F$DCB.ATTR
      2612**DCL      2613--REDEF
F$DCB.BORROW
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:83   
      2627**DCL      2627--REDEF    2627--REDEF    2627--REDEF
F$DCB.DCBNAME.L
      2641**DCL      2641--IMP-SIZ
F$DCB.EOMCHAR#
      2597**DCL      2597--REDEF
F$DCB.FLDID
      2622**DCL      2622--REDEF
F$DCB.FORM$
      2616**DCL      2616--REDEF
F$DCB.FSECT
      2632**DCL      2632--REDEF
F$DCB.FSN#
      2609**DCL      2609--REDEF    2609--REDEF    2610--REDEF
F$DCB.HEADER$
      2615**DCL      2615--REDEF
F$DCB.IXTNSIZE#
      2613**DCL      2613--REDEF
F$DCB.LASTSTA$
      2602**DCL      2602--REDEF
F$DCB.LVL
      2628**DCL      2628--REDEF
F$DCB.NAME#.C
      2603**DCL      2603--REDEF    4750>>ASSIGN
F$DCB.NAME#.L
      2603**DCL      4749>>ASSIGN
F$DCB.NOEOF
      2625**DCL      2625--REDEF
F$DCB.NRECS#
      2614**DCL      2614--REDEF
F$DCB.NRECX
      2633**DCL      2633--REDEF
F$DCB.OHDR
      2625**DCL      2625--REDEF
F$DCB.ORG#
      2608**DCL      2608--REDEF
F$DCB.PASS#
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:84   
      2603**DCL      4747>>ASSIGN
F$DCB.PRECNO
      2631**DCL      2631--REDEF
F$DCB.PSN#
      2603**DCL      4748>>ASSIGN
F$DCB.RCSZ
      2637**DCL      2637--REDEF
F$DCB.RES#
      2604**DCL      2604--REDEF
F$DCB.SETX
      2616**DCL      2616--REDEF
F$DCB.TAB$
      2616**DCL      2616--REDEF
F$DCB.TDA
      2630**DCL      2631--REDEF
F$DCB.WSN#
      2604**DCL      2604--REDEF
F$DCB$
      4647**DCL      2587--IMP-PTR  4680<<ASSIGN   4695<<ASSIGN   4742<<ASSIGN   4746>>ASSIGN   4747>>ASSIGN
      4748>>ASSIGN   4749>>ASSIGN   4750>>ASSIGN
FIDRECORD
      4640**DCL      4803<<ASSIGN   4810>>ASSIGN
FILE
      1594**DCL      4751--ASSIGN   4811--ASSIGN
FILE.ATMP
      1602**DCL      4745<<ASSIGN
FILE.CHKSUM
      1601**DCL      4744<<ASSIGN
FILE.CRPT
      1599**DCL      4741<<ASSIGN
FILE.DCB#
      1598**DCL      4740<<ASSIGN   4802>>IF       4805>>DOWHILE
FILE.ID.ACCT#
      1608**DCL      4746<<ASSIGN
FILE.ID.NAME#.C
      1613**DCL      4750<<ASSIGN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:85   
FILE.ID.NAME#.L
      1612**DCL      4749<<ASSIGN
FILE.ID.PASS#
      1609**DCL      4747<<ASSIGN
FILE.ID.PSN#
      1610**DCL      4748<<ASSIGN
FILE.KEYED
      1600**DCL      4743<<ASSIGN
FILE.TIME
      1595**DCL      4738<<ASSIGN
FILE.TYPE
      1596**DCL      4737<<ASSIGN   4807>>IF
FILE.UNPROTECT
      1605**DCL      4759<<ASSIGN
FILE.USER#
      1597**DCL      4739<<ASSIGN
FPT$
      4648**DCL      2133--IMP-PTR  2242--IMP-PTR  2351--IMP-PTR  4668<<ASSIGN   4669>>ASSIGN   4670>>ASSIGN
      4671>>ASSIGN   4672>>ASSIGN   4673>>ASSIGN   4674>>ASSIGN   4675>>ASSIGN   4678>>CALL     4681<<ASSIGN
      4682>>ASSIGN   4683>>ASSIGN   4684>>ASSIGN   4685>>ASSIGN   4686>>ASSIGN   4687>>ASSIGN   4688>>ASSIGN
      4689>>CALL     4691>>ASSIGN   4694>>ASSIGN   4714<<ASSIGN   4718>>ASSIGN   4719>>ASSIGN   4724>>ASSIGN
      4725>>ASSIGN   4727>>ASSIGN   4728>>ASSIGN   4729>>ASSIGN   4730>>ASSIGN   4731>>ASSIGN   4732>>ASSIGN
      4733>>ASSIGN   4734>>CALL
FPT$CLOSE
      2418**DCL      4841<>CALL     4864<>CALL
FPT$CLOSE.SN_
      2418**DCL      2418--REDEF
FPT$CLOSE.UTL_
      2419**DCL      2419--REDEF
FPT$CLOSE.V.DCB#
      2424**DCL      4838<<ASSIGN   4863<<ASSIGN
FPT$CLOSE.V.DISP#
      2427**DCL      4840<<ASSIGN   4842<<ASSIGN
FPT$CLOSE.V.EXPIRE#
      2433**DCL      2433--REDEF
FPT$CLOSE.V.TYPE#
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:86   
      2431**DCL      2431--REDEF
FPT$CLOSE.V.XTNSIZE#
      2428**DCL      2428--REDEF    2430--REDEF
FPT$GETDCB
      2554**DCL      4664<>CALL     4667<>CALL     4711<>CALL
FPT$GETDCB.V.TEST#
      2556**DCL      4663<<ASSIGN   4666<<ASSIGN   4710<<ASSIGN
FPT$OPEN
      2133**DCL      4689<>CALL
FPT$OPEN.ACSVEH_
      2135**DCL      2136--REDEF
FPT$OPEN.ALTKEYS_
      2141**DCL      2142--REDEF    2142--REDEF
FPT$OPEN.HDR_
      2140**DCL      2141--REDEF
FPT$OPEN.TAB_
      2139**DCL      2140--REDEF
FPT$OPEN.UHL_
      2133**DCL      2134--REDEF    2134--REDEF
FPT$OPEN.V.ACS#
      2153**DCL      4687<<ASSIGN
FPT$OPEN.V.ASN#
      2152**DCL      4683<<ASSIGN
FPT$OPEN.V.DCB#
      2142**DCL      4682<<ASSIGN
FPT$OPEN.V.EXIST#
      2146**DCL      4685<<ASSIGN
FPT$OPEN.V.FSN#
      2173**DCL      2173--REDEF    2173--REDEF
FPT$OPEN.V.FUN#
      2152**DCL      4684<<ASSIGN
FPT$OPEN.V.GHSTACS#
      2157**DCL      4688<<ASSIGN   4691<<ASSIGN   4694<<ASSIGN
FPT$OPEN.V.ORG#
      2153**DCL      4686<<ASSIGN
FPT$OPEN.WSN_
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:87   
      2139**DCL      2139--REDEF
FPT$OPNDFLT
      2242**DCL      4678<>CALL
FPT$OPNDFLT.ACSVEH_
      2244**DCL      2245--REDEF
FPT$OPNDFLT.ALTKEYS_
      2250**DCL      2251--REDEF    2251--REDEF
FPT$OPNDFLT.HDR_
      2249**DCL      2250--REDEF
FPT$OPNDFLT.TAB_
      2248**DCL      2249--REDEF
FPT$OPNDFLT.UHL_
      2242**DCL      2243--REDEF    2243--REDEF
FPT$OPNDFLT.V.ASN#
      2261**DCL      4670<<ASSIGN
FPT$OPNDFLT.V.CTG#
      2255**DCL      4674<<ASSIGN
FPT$OPNDFLT.V.DCB#
      2251**DCL      4669<<ASSIGN
FPT$OPNDFLT.V.DISP#
      2267**DCL      4673<<ASSIGN
FPT$OPNDFLT.V.FSN#
      2282**DCL      2282--REDEF    2282--REDEF
FPT$OPNDFLT.V.IXTNSIZE#
      2270**DCL      4671<<ASSIGN
FPT$OPNDFLT.V.TYPE#
      2263**DCL      4675<<ASSIGN
FPT$OPNDFLT.V.XTNSIZE#
      2270**DCL      4672<<ASSIGN
FPT$OPNDFLT.WSN_
      2248**DCL      2248--REDEF
FPT$OPNSCRB
      2351**DCL      4734<>CALL
FPT$OPNSCRB.ACSVEH_
      2353**DCL      2354--REDEF
FPT$OPNSCRB.ALTKEYS_
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:88   
      2359**DCL      2360--REDEF    2360--REDEF
FPT$OPNSCRB.HDR_
      2358**DCL      2359--REDEF
FPT$OPNSCRB.TAB_
      2357**DCL      2358--REDEF
FPT$OPNSCRB.UHL_
      2351**DCL      2352--REDEF    2352--REDEF
FPT$OPNSCRB.V.ACS#
      2371**DCL      4733<<ASSIGN
FPT$OPNSCRB.V.CTG#
      2364**DCL      4732<<ASSIGN
FPT$OPNSCRB.V.DCB#
      2360**DCL      4727<<ASSIGN
FPT$OPNSCRB.V.DISP#
      2376**DCL      4730<<ASSIGN
FPT$OPNSCRB.V.EXIST#
      2364**DCL      4729<<ASSIGN
FPT$OPNSCRB.V.FSN#
      2391**DCL      2391--REDEF    2391--REDEF
FPT$OPNSCRB.V.FUN#
      2370**DCL      4728<<ASSIGN
FPT$OPNSCRB.V.ORG#
      2371**DCL      4731<<ASSIGN
FPT$OPNSCRB.V.SHARE#
      2365**DCL      4718<<ASSIGN   4724<<ASSIGN
FPT$OPNSCRB.V.TYPE#
      2372**DCL      4719<<ASSIGN   4725<<ASSIGN
FPT$OPNSCRB.WSN_
      2357**DCL      2357--REDEF
FPT$PFIL
      2518**DCL      4762<>CALL     4795<>CALL     4804<>CALL     4817<>CALL
FPT$PFIL.V.BOF#
      2519**DCL      4761<<ASSIGN   4794<<ASSIGN   4815<<ASSIGN
FPT$PFIL.V.DCB#
      2518**DCL      4760<<ASSIGN   4793<<ASSIGN
FPT$PRECJ
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:89   
      2533**DCL      4765<>CALL     4798<>CALL     4818<>CALL     4822<>CALL     4826<>CALL
FPT$PRECJ.V.DCB#
      2535**DCL      4763<<ASSIGN   4796<<ASSIGN
FPT$PRECJ.V.N#
      2539**DCL      4764<<ASSIGN   4797<<ASSIGN   4816<<ASSIGN   4821<<ASSIGN   4825<<ASSIGN
FPT$READJ
      2485**DCL      4800<>CALL     4806<>CALL     4820<>CALL
FPT$READJ.STATION_
      2488**DCL      2489--REDEF
FPT$READJ.V.DCB#
      2489**DCL      4799<<ASSIGN
FPT$READJ.V.DVBYTE.REREAD#
      2500**DCL      2500--REDEF
FPT$READJ.V.INDX#
      2498**DCL      2498--REDEF
FPT$RELDCB
      2569**DCL      4844<>CALL     4866<>CALL
FPT$RELDCB.V.DCB#
      2569**DCL      4843<<ASSIGN   4865<<ASSIGN
FPT$TIME
      2060**DCL      4656<>CALL     4780<>CALL     4851<>CALL
FPT$TRUNC
      2583**DCL      4828<>CALL
FPT$TRUNC.V.DCB#
      2583**DCL      4827<<ASSIGN
FPT$WRTJ
      2454**DCL      4703<>CALL     4755<>CALL     4767<>CALL     4787<>CALL     4813<>CALL     4824<>CALL
      4859<>CALL
FPT$WRTJ.BUF_.BOUND
      2454**DCL      4701<<ASSIGN   4751<<ASSIGN   4785<<ASSIGN   4811<<ASSIGN   4823<<ASSIGN   4857<<ASSIGN
FPT$WRTJ.STATION_
      2456**DCL      2456--REDEF
FPT$WRTJ.V.DCB#
      2457**DCL      4702<<ASSIGN   4754<<ASSIGN   4766<<ASSIGN   4786<<ASSIGN   4801<<ASSIGN   4858<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      2463**DCL      2463--REDEF
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:90   
FPT$WRTJ.V.REWRITE#
      2460**DCL      4812<<ASSIGN   4814<<ASSIGN   4891<<ASSIGN
GLOBAL.ACCT
       718**DCL      4677<<ASSIGN   4712<<ASSIGN
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF
GLOBAL.CJRNL.DCB#
       690**DCL      4657>>IF       4696<<ASSIGN   4702>>ASSIGN   4754>>ASSIGN   4786>>ASSIGN   4846>>IF
      4858>>ASSIGN   4861>>ASSIGN   4862<<ASSIGN   4881>>ASSIGN   4882<<ASSIGN
GLOBAL.CLOSE$
       756**DCL      4838>>ASSIGN   4840>>ASSIGN   4841>>CALL     4842>>ASSIGN   4863>>ASSIGN   4864>>CALL
GLOBAL.DCBNAME
       715**DCL      4676>>ASSIGN
GLOBAL.DCBNAME.LENGTH
       716**DCL      4659<<ASSIGN   4708<<ASSIGN
GLOBAL.DCBNAME.TEXT
       717**DCL      4660<<ASSIGN   4709<<ASSIGN
GLOBAL.DCBNUMBER
       704**DCL      4665>>IF       4669>>ASSIGN   4680--ASSIGN   4682>>ASSIGN   4695--ASSIGN   4696>>ASSIGN
      4727>>ASSIGN   4735>>ASSIGN   4874>>ASSIGN   4889>>ASSIGN
GLOBAL.FILENAME
       712**DCL      4676<<ASSIGN
GLOBAL.FILENAME.LENGTH
       713**DCL      4661<<ASSIGN   4713<<ASSIGN   4716<<ASSIGN   4722<<ASSIGN
GLOBAL.FILENAME.TEXT
       714**DCL      4662<<ASSIGN   4717<<ASSIGN   4723<<ASSIGN
GLOBAL.GETDCB$
       766**DCL      4663>>ASSIGN   4664>>CALL     4666>>ASSIGN   4667>>CALL     4710>>ASSIGN   4711>>CALL
GLOBAL.JRECORD
       700**DCL      4654--ASSIGN   4777--ASSIGN   4803>>ASSIGN   4810<<ASSIGN   4850--ASSIGN
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.OPEN$
       752**DCL      4681>>ASSIGN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:91   
GLOBAL.OPNDFLT$
       753**DCL      4668>>ASSIGN
GLOBAL.OPNSCRB$
       754**DCL      4714>>ASSIGN
GLOBAL.PARAN.IO.AWS$
       544**DCL      4650>>ASSIGN   4775>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.ROLL
       536**DCL      4651>>IF       4778>>IF       4789>>IF       4848>>IF
GLOBAL.PFIL$
       774**DCL      4760>>ASSIGN   4761>>ASSIGN   4762>>CALL     4793>>ASSIGN   4794>>ASSIGN   4795>>CALL
      4804>>CALL     4815>>ASSIGN   4817>>CALL
GLOBAL.PRECJ$
       782**DCL      4763>>ASSIGN   4764>>ASSIGN   4765>>CALL     4796>>ASSIGN   4797>>ASSIGN   4798>>CALL
      4816>>ASSIGN   4818>>CALL     4821>>ASSIGN   4822>>CALL     4825>>ASSIGN   4826>>CALL
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.READJ$
       776**DCL      4799>>ASSIGN   4800>>CALL     4806>>CALL     4820>>CALL
GLOBAL.RELDCB$
       767**DCL      4843>>ASSIGN   4844>>CALL     4865>>ASSIGN   4866>>CALL
GLOBAL.RET.DCB#
       521**DCL      4874<<ASSIGN   4881<<ASSIGN   4889<<ASSIGN   4894<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      4897<<ASSIGN
GLOBAL.RET.SYSERR#
       516**DCL      4870<<ASSIGN   4873<<ASSIGN   4880<<ASSIGN   4888<<ASSIGN   4893<<ASSIGN
GLOBAL.TIME.TSTAMP
       728**DCL      4698>>ASSIGN   4738>>ASSIGN   4782>>ASSIGN   4853>>ASSIGN
GLOBAL.TIME$
       777**DCL      4656>>CALL     4780>>CALL     4851>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      4705>>IF       4735<<ASSIGN   4760>>ASSIGN   4763>>ASSIGN   4766>>ASSIGN   4793>>ASSIGN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:92   
      4796>>ASSIGN   4799>>ASSIGN   4801>>ASSIGN   4827>>ASSIGN   4834>>IF       4836>>ASSIGN   4837<<ASSIGN
      4894>>ASSIGN
GLOBAL.TJRNL.FIDCOUNT
       685**DCL      4764>>ASSIGN   4768<<ASSIGN   4768>>ASSIGN   4792<<ASSIGN   4792>>ASSIGN   4797>>ASSIGN
GLOBAL.TRUNC$
       779**DCL      4827>>ASSIGN   4828>>CALL
GLOBAL.WRTJ$
       775**DCL      4655>>ASSIGN   4776>>ASSIGN   4856>>ASSIGN
GLOBAL$
       799**DCL       495--IMP-PTR  4650>>ASSIGN   4651>>IF       4654>>ASSIGN   4655>>ASSIGN   4656>>CALL
      4657>>IF       4659>>ASSIGN   4660>>ASSIGN   4661>>ASSIGN   4662>>ASSIGN   4663>>ASSIGN   4664>>CALL
      4665>>IF       4666>>ASSIGN   4667>>CALL     4668>>ASSIGN   4669>>ASSIGN   4676>>ASSIGN   4676>>ASSIGN
      4677>>ASSIGN   4680>>ASSIGN   4681>>ASSIGN   4682>>ASSIGN   4695>>ASSIGN   4696>>ASSIGN   4696>>ASSIGN
      4698>>ASSIGN   4702>>ASSIGN   4705>>IF       4708>>ASSIGN   4709>>ASSIGN   4710>>ASSIGN   4711>>CALL
      4712>>ASSIGN   4713>>ASSIGN   4714>>ASSIGN   4716>>ASSIGN   4717>>ASSIGN   4722>>ASSIGN   4723>>ASSIGN
      4727>>ASSIGN   4735>>ASSIGN   4735>>ASSIGN   4738>>ASSIGN   4754>>ASSIGN   4760>>ASSIGN   4760>>ASSIGN
      4761>>ASSIGN   4762>>CALL     4763>>ASSIGN   4763>>ASSIGN   4764>>ASSIGN   4764>>ASSIGN   4765>>CALL
      4766>>ASSIGN   4768>>ASSIGN   4768>>ASSIGN   4775>>ASSIGN   4776>>ASSIGN   4777>>ASSIGN   4778>>IF
      4780>>CALL     4782>>ASSIGN   4786>>ASSIGN   4789>>IF       4792>>ASSIGN   4792>>ASSIGN   4793>>ASSIGN
      4793>>ASSIGN   4794>>ASSIGN   4795>>CALL     4796>>ASSIGN   4796>>ASSIGN   4797>>ASSIGN   4797>>ASSIGN
      4798>>CALL     4799>>ASSIGN   4799>>ASSIGN   4800>>CALL     4801>>ASSIGN   4803>>ASSIGN   4804>>CALL
      4806>>CALL     4810>>ASSIGN   4815>>ASSIGN   4816>>ASSIGN   4817>>CALL     4818>>CALL     4820>>CALL
      4821>>ASSIGN   4822>>CALL     4825>>ASSIGN   4826>>CALL     4827>>ASSIGN   4827>>ASSIGN   4828>>CALL
      4834>>IF       4836>>ASSIGN   4837>>ASSIGN   4838>>ASSIGN   4840>>ASSIGN   4841>>CALL     4842>>ASSIGN
      4843>>ASSIGN   4844>>CALL     4846>>IF       4848>>IF       4850>>ASSIGN   4851>>CALL     4853>>ASSIGN
      4856>>ASSIGN   4858>>ASSIGN   4861>>ASSIGN   4862>>ASSIGN   4863>>ASSIGN   4864>>CALL     4865>>ASSIGN
      4866>>CALL     4870>>ASSIGN   4873>>ASSIGN   4874>>ASSIGN   4874>>ASSIGN   4880>>ASSIGN   4881>>ASSIGN
      4881>>ASSIGN   4882>>ASSIGN   4888>>ASSIGN   4889>>ASSIGN   4889>>ASSIGN   4893>>ASSIGN   4894>>ASSIGN
      4894>>ASSIGN   4897>>ASSIGN
JREC.LENGTH
      1620**DCL      1623--IMP-SIZ
JRNL$
      1593**DCL      1594--IMP-PTR  1614--IMP-PTR  1624--IMP-PTR  1631--IMP-PTR  1637--IMP-PTR  4654<<ASSIGN
      4697>>ASSIGN   4698>>ASSIGN   4699>>ASSIGN   4700>>ASSIGN   4737>>ASSIGN   4738>>ASSIGN   4739>>ASSIGN
      4740>>ASSIGN   4741>>ASSIGN   4743>>ASSIGN   4744>>ASSIGN   4745>>ASSIGN   4746>>ASSIGN   4747>>ASSIGN
      4748>>ASSIGN   4749>>ASSIGN   4750>>ASSIGN   4759>>ASSIGN   4777<<ASSIGN   4781>>ASSIGN   4782>>ASSIGN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:93   
      4783>>ASSIGN   4784>>ASSIGN   4802>>IF       4805>>DOWHILE  4807>>IF       4850<<ASSIGN   4852>>ASSIGN
      4853>>ASSIGN   4854>>ASSIGN   4855>>ASSIGN
M$CLOSE
      1966**DCL-ENT  4841--CALL     4864--CALL
M$ERR
      1978**DCL-ENT  4898--CALL
M$GETDCB
      1972**DCL-ENT  4664--CALL     4667--CALL     4711--CALL
M$OPEN
      1966**DCL-ENT  4678--CALL     4689--CALL     4734--CALL
M$PFIL
      1968**DCL-ENT  4762--CALL     4795--CALL     4804--CALL     4817--CALL
M$PRECORD
      1970**DCL-ENT  4765--CALL     4798--CALL     4818--CALL     4822--CALL     4826--CALL
M$READ
      1967**DCL-ENT  4800--CALL     4806--CALL     4820--CALL
M$RELDCB
      1972**DCL-ENT  4844--CALL     4866--CALL
M$TIME
      2033**DCL-ENT  4656--CALL     4780--CALL     4851--CALL
M$TRUNC
      1967**DCL-ENT  4828--CALL
M$WRITE
      1967**DCL-ENT  4703--CALL     4755--CALL     4767--CALL     4787--CALL     4813--CALL     4824--CALL
      4859--CALL
RET
      4868**LABEL    4771--GOTO     4830--GOTO     4885--GOTO
WRTJ$
      4642**DCL      2454--IMP-PTR  4655<<ASSIGN   4701>>ASSIGN   4702>>ASSIGN   4703>>CALL     4751>>ASSIGN
      4754>>ASSIGN   4755>>CALL     4766>>ASSIGN   4767>>CALL     4776<<ASSIGN   4785>>ASSIGN   4786>>ASSIGN
      4787>>CALL     4801>>ASSIGN   4811>>ASSIGN   4812>>ASSIGN   4813>>CALL     4814>>ASSIGN   4823>>ASSIGN
      4824>>CALL     4856<<ASSIGN   4857>>ASSIGN   4858>>ASSIGN   4859>>CALL     4891>>ASSIGN
ZI_TEST
      4643**DCL      4715>>IF       4839>>IF
ZI_TJNAME
      4637**DCL      4723>>ASSIGN
PL6.E3A0      #002=ZIM$JBEGIN File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:94   
ZI_USER
      4644**DCL      4715>>IF

PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:95   
      392        1        /*T***********************************************************/
      393        2        /*T*                                                         */
      394        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      395        4        /*T*                                                         */
      396        5        /*T***********************************************************/
      397        6        ZIM$JCKSMC: PROC(BUFNUM)
      398        7               AVOID($PR5,$PR6,$PR7);
      399        8        %INCLUDE ZI$GLOBAL;
      400      494            %GLOBALS;
      401      802            %BUFFERS;
      402      817        %INCLUDE ZI$DBCB;
      403     1459            %AWS;
      404     1499        %INCLUDE ZI$JRNL;
      405     1607            %JRNL_REC(STCLASS=AUTO);
      406     1682        %INCLUDE CP_6;
      407     1763            %B$TCB;
      408     1766            %B$ALT;
      409     1774            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      410     1793            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      411     1824        %INCLUDE CP_6_SUBS;
      412     2364        %INCLUDE ZI_ERRORS_C;
      413     2690        %INCLUDE B_ERRORS_C;
      414     3817        %INCLUDE B$JIT;
      415     4107    1   DCL ZIM$ICKSMJ ENTRY;
      416     4108    1   DCL ERROR UBIN(36);
      417     4109    1   DCL TYPE UBIN(36);
      418     4110    1   DCL BUFNUM UBIN(36);
      419     4111    1   DCL WRTJ$ PTR;
      420     4112    1   DCL B$JIT$ PTR SYMREF;
      421     4113    1   DCL B$TCB$ PTR SYMREF;
      422     4114    1       TYPE=T#CKA;
      423     4115    1       GOTO COM;
      424     4116    1   ZIM$JCKSMT: ENTRY(BUFNUM);
      425     4117    1       TYPE=T#CKB;
      426     4118    1   COM: ERROR=0;
      427     4119    1       IF ~GLOBAL.PENDING.ROLL THEN
      428     4120    2       DO;
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:96   
      429     4121    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      430     4122    2           JRNL$=ADDR(GLOBAL.JRECORD);
      431     4123    2           CKSM.TYPE=TYPE;
      432     4124    2           CKSM.TIME=GLOBAL.TIME.TSTAMP;
      433     4125    2           CKSM.USER#=B$JIT.USER;
      434     4126    2           CKSM.DCB#=GLOBAL.BCB.BUF.AWS$(BUFNUM)->AWS.DDCB;
      435     4127    2           CKSM.PAGE=PINCRW(GLOBAL.BCB.BUF.BUF$(BUFNUM),-3)->BLOCK.PGNO;
      436     4128    2           GLOBAL.PARAN.ICKSM.P$=PINCRW(GLOBAL.BCB.BUF.BUF$(BUFNUM),-3);
      437     4129    2           CALL ZIM$ICKSMJ;
      438     4130    2           CKSM.CKSM=GLOBAL.PARAN.ICKSM.V;
      439     4131    2           WRTJ$=GLOBAL.WRTJ$;
      440     4132    2           FPT$WRTJ.BUF_.BOUND=SIZEV(CKSM);
      441     4133    2           IF TYPE=T#CKA THEN
      442     4134    3           DO;
      443     4135    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      444     4136    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      445     4137    3               END;
      446     4138    2           ELSE
      447     4139    3           DO;
      448     4140    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      449     4141    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      450     4142    3               END;
      451     4143    2           END;
      452     4144    1       RETURN;
      453     4145    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
      454     4146    1           ERROR=ERR#IO#NOOWNER;
      455     4147    1       ELSE
      456     4148    1           ERROR=ERR#IO#WRTC;
      457     4149    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      458     4150    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
      459     4151    1       GLOBAL.CJRNL.DCB#=0;
      460     4152    1       GOTO ALT;
      461     4153    1   ER_WRTT: ERROR=ERR#IO#WRTT;
      462     4154    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      463     4155    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
      464     4156    1       GOTO ALT;
      465     4157    1   ALT: ;
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:97   
      466     4158    1       GLOBAL.RET.ERROR#=ERROR;
      467     4159    1       CALL M$ERR;
      468     4160    1   END ZIM$JCKSMC;
      469     4161        %EOD;

PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:98   
--  Include file information  --

   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JCKSMC.

   Procedure ZIM$JCKSMC requires 115 words for executable code.
   Procedure ZIM$JCKSMC requires 10 words of local(AUTO) storage.

PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:99   

 Object Unit name= ZIM$JCKSMC                                 File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 12:59:48.16 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   115    163  ZIM$JCKSMC
    2  RoData even  none     3      3  ZIM$JCKSMC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       1  ZIM$JCKSMC
     1      5                  yes      XStd       1  ZIM$JCKSMT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      0 ZIM$ICKSMJ
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:100  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:101  


      392        1        /*T***********************************************************/
      393        2        /*T*                                                         */
      394        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      395        4        /*T*                                                         */
      396        5        /*T***********************************************************/
      397        6        ZIM$JCKSMC: PROC(BUFNUM)

      6  1 000000   000000 700200 xent  ZIM$JCKSMC   TSX0  ! X66_AUTO_1
         1 000001   000012 000001                    ZERO    10,1

      398        7               AVOID($PR5,$PR6,$PR7);
      399        8        %INCLUDE ZI$GLOBAL;
      400      494            %GLOBALS;
      401      802            %BUFFERS;
      402      817        %INCLUDE ZI$DBCB;
      403     1459            %AWS;
      404     1499        %INCLUDE ZI$JRNL;
      405     1607            %JRNL_REC(STCLASS=AUTO);
      406     1682        %INCLUDE CP_6;
      407     1763            %B$TCB;
      408     1766            %B$ALT;
      409     1774            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      410     1793            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      411     1824        %INCLUDE CP_6_SUBS;
      412     2364        %INCLUDE ZI_ERRORS_C;
      413     2690        %INCLUDE B_ERRORS_C;
      414     3817        %INCLUDE B$JIT;
      415     4107    1   DCL ZIM$ICKSMJ ENTRY;
      416     4108    1   DCL ERROR UBIN(36);
      417     4109    1   DCL TYPE UBIN(36);
      418     4110    1   DCL BUFNUM UBIN(36);
      419     4111    1   DCL WRTJ$ PTR;
      420     4112    1   DCL B$JIT$ PTR SYMREF;
      421     4113    1   DCL B$TCB$ PTR SYMREF;
      422     4114    1       TYPE=T#CKA;

PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:102  
   4114  1 000002   000012 235007                    LDA     10,DL
         1 000003   200007 755100                    STA     TYPE,,AUTO

      423     4115    1       GOTO COM;

   4115  1 000004   000011 710000 1                  TRA     COM

      424     4116    1   ZIM$JCKSMT: ENTRY(BUFNUM);

   4116  1 000005   000000 700200 xent  ZIM$JCKSMT   TSX0  ! X66_AUTO_1
         1 000006   000012 000001                    ZERO    10,1

      425     4117    1       TYPE=T#CKB;

   4117  1 000007   000011 235007                    LDA     9,DL
         1 000010   200007 755100                    STA     TYPE,,AUTO

      426     4118    1   COM: ERROR=0;

   4118  1 000011   200006 450100       COM          STZ     ERROR,,AUTO

      427     4119    1       IF ~GLOBAL.PENDING.ROLL THEN

   4119  1 000012   000000 470400 xsym               LDP0    GLOBAL$
         1 000013   000017 236100                    LDQ     15,,PR0
         1 000014   000010 736000                    QLS     8
         1 000015   400000 376003                    ANQ     -131072,DU
         1 000016   400000 676003                    ERQ     -131072,DU
         1 000017   000122 600000 1                  TZE     s:4144

      428     4120    2       DO;

      429     4121    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4121  1 000020   005117 471500                    LDP1    2639,,PR0
         1 000021   100000 630500                    EPPR0   0,,PR1
         1 000022   020004 713400                    CLIMB   8196
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:103  
         1 000023   402000 401760                    pmme    nvectors=5

      430     4122    2           JRNL$=ADDR(GLOBAL.JRECORD);

   4122  1 000024   000000 236000 xsym               LDQ     GLOBAL$
         1 000025   002622 036003                    ADLQ    1426,DU
         1 000026   200005 756100                    STQ     JRNL$,,AUTO

      431     4123    2           CKSM.TYPE=TYPE;

   4123  1 000027   200005 470500                    LDP0    JRNL$,,AUTO
         1 000030   200007 236100                    LDQ     TYPE,,AUTO
         1 000031   000033 736000                    QLS     27
         1 000032   000001 552140                    STBQ    1,'40'O,PR0

      432     4124    2           CKSM.TIME=GLOBAL.TIME.TSTAMP;

   4124  1 000033   000000 471400 xsym               LDP1    GLOBAL$
         1 000034   105001 235100                    LDA     2561,,PR1
         1 000035   000000 755100                    STA     0,,PR0

      433     4125    2           CKSM.USER#=B$JIT.USER;

   4125  1 000036   000000 473400 xsym               LDP3    B$JIT$
         1 000037   300000 236100                    LDQ     0,,PR3
         1 000040   000001 552120                    STBQ    1,'20'O,PR0

      434     4126    2           CKSM.DCB#=GLOBAL.BCB.BUF.AWS$(BUFNUM)->AWS.DDCB;

   4126  1 000041   200003 474500                    LDP4    @BUFNUM,,AUTO
         1 000042   400000 236100                    LDQ     0,,PR4
         1 000043   000005 402007                    MPY     5,DL
         1 000044   100204 470506                    LDP0    132,QL,PR1
         1 000045   000006 220100                    LDX0    6,,PR0
         1 000046   200005 470500                    LDP0    JRNL$,,AUTO
         1 000047   000001 440100                    SXL0    1,,PR0

PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:104  
      435     4127    2           CKSM.PAGE=PINCRW(GLOBAL.BCB.BUF.BUF$(BUFNUM),-3)->BLOCK.PGNO;

   4127  1 000050   400000 236100                    LDQ     0,,PR4
         1 000051   000005 402007                    MPY     5,DL
         1 000052   100202 470506                    LDP0    130,QL,PR1
         1 000053   200005 471500                    LDP1    JRNL$,,AUTO
         1 000054   000001 235100                    LDA     1,,PR0
         1 000055   100002 755100                    STA     2,,PR1

      436     4128    2           GLOBAL.PARAN.ICKSM.P$=PINCRW(GLOBAL.BCB.BUF.BUF$(BUFNUM),-3);

   4128  1 000056   400000 236100                    LDQ     0,,PR4
         1 000057   000005 402007                    MPY     5,DL
         1 000060   000000 470400 xsym               LDP0    GLOBAL$
         1 000061   000202 236106                    LDQ     130,QL,PR0
         1 000062   777775 036003                    ADLQ    -3,DU
         1 000063   000023 756100                    STQ     19,,PR0

      437     4129    2           CALL ZIM$ICKSMJ;

   4129  1 000064   000000 631400 2                  EPPR1   0
         1 000065   000000 701000 xent               TSX1    ZIM$ICKSMJ
         1 000066   000000 011000                    NOP     0

      438     4130    2           CKSM.CKSM=GLOBAL.PARAN.ICKSM.V;

   4130  1 000067   000000 470400 xsym               LDP0    GLOBAL$
         1 000070   200005 471500                    LDP1    JRNL$,,AUTO
         1 000071   000024 235100                    LDA     20,,PR0
         1 000072   100003 755100                    STA     3,,PR1

      439     4131    2           WRTJ$=GLOBAL.WRTJ$;

   4131  1 000073   005115 236100                    LDQ     2637,,PR0
         1 000074   200010 756100                    STQ     WRTJ$,,AUTO

      440     4132    2           FPT$WRTJ.BUF_.BOUND=SIZEV(CKSM);
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:105  

   4132  1 000075   200010 473500                    LDP3    WRTJ$,,AUTO
         1 000076   300004 236100                    LDQ     4,,PR3
         1 000077   177777 376007                    ANQ     65535,DL
         1 000100   000002 276000 2                  ORQ     2
         1 000101   300004 756100                    STQ     4,,PR3

      441     4133    2           IF TYPE=T#CKA THEN

   4133  1 000102   200007 235100                    LDA     TYPE,,AUTO
         1 000103   000012 115007                    CMPA    10,DL
         1 000104   000114 601000 1                  TNZ     s:4140

      442     4134    3           DO;

      443     4135    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4135  1 000105   002610 720100                    LXL0    1416,,PR0
         1 000106   300010 740100                    STX0    8,,PR3

      444     4136    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4136  1 000107   300000 630500                    EPPR0   0,,PR3
         1 000110   440001 713400                    CLIMB   alt,write
         1 000111   401400 401760                    pmme    nvectors=4
         1 000112   000123 702000 1                  TSX2    ER_WRTC

      445     4137    3               END;

   4137  1 000113   000122 710000 1                  TRA     s:4144

      446     4138    2           ELSE
      447     4139    3           DO;

      448     4140    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4140  1 000114   002604 720100                    LXL0    1412,,PR0
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:106  
         1 000115   300010 740100                    STX0    8,,PR3

      449     4141    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   4141  1 000116   300000 630500                    EPPR0   0,,PR3
         1 000117   440001 713400                    CLIMB   alt,write
         1 000120   401400 401760                    pmme    nvectors=4
         1 000121   000145 702000 1                  TSX2    ER_WRTT

      450     4142    3               END;

      451     4143    2           END;

      452     4144    1       RETURN;

   4144  1 000122   000000 702200 xent               TSX2  ! X66_ARET

      453     4145    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   4145  1 000123   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         1 000124   000000 471500                    LDP1    0,,PR0
         1 000125   100102 236100                    LDQ     66,,PR1
         1 000126   377770 376007                    ANQ     131064,DL
         1 000127   001160 116007                    CMPQ    624,DL
         1 000130   000134 601000 1                  TNZ     s:4148

      454     4146    1           ERROR=ERR#IO#NOOWNER;

   4146  1 000131   210762 235007                    LDA     70130,DL
         1 000132   200006 755100                    STA     ERROR,,AUTO
         1 000133   000136 710000 1                  TRA     s:4149

      455     4147    1       ELSE
      456     4148    1           ERROR=ERR#IO#WRTC;

   4148  1 000134   210721 235007                    LDA     70097,DL
         1 000135   200006 755100                    STA     ERROR,,AUTO
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:107  

      457     4149    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4149  1 000136   100102 236100                    LDQ     66,,PR1
         1 000137   000000 473400 xsym               LDP3    GLOBAL$
         1 000140   300007 756100                    STQ     7,,PR3

      458     4150    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   4150  1 000141   302610 720100                    LXL0    1416,,PR3
         1 000142   300014 740100                    STX0    12,,PR3

      459     4151    1       GLOBAL.CJRNL.DCB#=0;

   4151  1 000143   302610 450100                    STZ     1416,,PR3

      460     4152    1       GOTO ALT;

   4152  1 000144   000157 710000 1                  TRA     ALT

      461     4153    1   ER_WRTT: ERROR=ERR#IO#WRTT;

   4153  1 000145   210720 235007       ER_WRTT      LDA     70096,DL
         1 000146   200006 755100                    STA     ERROR,,AUTO

      462     4154    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4154  1 000147   000000 470400 xsym               LDP0    B$TCB$
         1 000150   000000 471500                    LDP1    0,,PR0
         1 000151   100102 236100                    LDQ     66,,PR1
         1 000152   000000 473400 xsym               LDP3    GLOBAL$
         1 000153   300007 756100                    STQ     7,,PR3

      463     4155    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

   4155  1 000154   302604 720100                    LXL0    1412,,PR3
         1 000155   300014 740100                    STX0    12,,PR3
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:108  

      464     4156    1       GOTO ALT;

   4156  1 000156   000157 710000 1                  TRA     ALT

   4155  1 000157                       ALT          null
      465     4157    1   ALT: ;
      466     4158    1       GLOBAL.RET.ERROR#=ERROR;

   4158  1 000157   300006 755100                    STA     6,,PR3

      467     4159    1       CALL M$ERR;

   4159  1 000160   000002 713400                    CLIMB   err
         1 000161   000000 401760                    pmme    nvectors=0

      468     4160    1   END ZIM$JCKSMC;

   4160  1 000162   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000000 000000   000000 006014   000003 600000                    ............
      469     4161        %EOD;

PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:109  
--  Include file information  --

   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JCKSMC.

   Procedure ZIM$JCKSMC requires 115 words for executable code.
   Procedure ZIM$JCKSMC requires 10 words of local(AUTO) storage.
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:110  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:111  
          MINI XREF LISTING

ALT
      4155**LABEL    4152--GOTO     4156--GOTO
AWS.DDCB
      1486**DCL      4126>>ASSIGN
AWS$
      1460**DCL      1461--IMP-PTR
B$ALT.CODE
      1768**DCL      1768--REDEF    1769--REDEF    1769--REDEF
B$ALT.ERR
      1769**DCL      4149>>ASSIGN   4154>>ASSIGN
B$ALT.ERR.ERR#
      1770**DCL      1770--REDEF    4145>>IF
B$ALT.EVID
      1769**DCL      1769--REDEF    1769--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3925**DCL      3925--REDEF
B$JIT.ERR.MID
      3832**DCL      3832--REDEF
B$JIT.JRESPEAK
      3993**DCL      3994--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4102**DCL      4102--REDEF    4103--REDEF
B$JIT.PNR
      4006**DCL      4006--REDEF
B$JIT.TSLINE
      4100**DCL      4101--REDEF
B$JIT.USER
      3831**DCL      4125>>ASSIGN
B$JIT$
      4112**DCL      3826--IMP-PTR  4125>>ASSIGN
B$TCB.ALT$
      1764**DCL      4145>>IF       4149>>ASSIGN   4154>>ASSIGN
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:112  
B$TCB$
      4113**DCL      4145>>IF       4149>>ASSIGN   4154>>ASSIGN
BERC.DCB#
      1650**DCL      1651--REDEF
BLOCK.PGNO
       812**DCL      4127>>ASSIGN
BUFNUM
      4110**DCL         6--PROC     4116--ENTRY    4126>>ASSIGN   4127>>ASSIGN   4128>>ASSIGN
CKSM
      1639**DCL      4132--ASSIGN
CKSM.CKSM
      1645**DCL      4130<<ASSIGN
CKSM.DCB#
      1643**DCL      4126<<ASSIGN
CKSM.PAGE
      1644**DCL      4127<<ASSIGN
CKSM.TIME
      1640**DCL      4124<<ASSIGN
CKSM.TYPE
      1641**DCL      4123<<ASSIGN
CKSM.USER#
      1642**DCL      4125<<ASSIGN
COM
      4118**LABEL    4115--GOTO
ERROR
      4108**DCL      4118<<ASSIGN   4146<<ASSIGN   4148<<ASSIGN   4153<<ASSIGN   4158>>ASSIGN
ER_WRTC
      4145**LABEL    4136--CALLALT
ER_WRTT
      4153**LABEL    4141--CALLALT
FPT$TIME
      1785**DCL      4121<>CALL
FPT$WRTJ
      1810**DCL      4136<>CALL     4141<>CALL
FPT$WRTJ.BUF_.BOUND
      1810**DCL      4132<<ASSIGN
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:113  
FPT$WRTJ.STATION_
      1812**DCL      1812--REDEF
FPT$WRTJ.V.DCB#
      1813**DCL      4135<<ASSIGN   4140<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      1819**DCL      1819--REDEF
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF
GLOBAL.BCB.BUF.AWS$
       610**DCL      4126>>ASSIGN
GLOBAL.BCB.BUF.BUF$
       608**DCL      4127>>ASSIGN   4128>>ASSIGN
GLOBAL.CJRNL.DCB#
       690**DCL      4135>>ASSIGN   4150>>ASSIGN   4151<<ASSIGN
GLOBAL.JRECORD
       700**DCL      4122--ASSIGN
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.PARAN.ICKSM.P$
       548**DCL      4128<<ASSIGN
GLOBAL.PARAN.ICKSM.V
       549**DCL      4130>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.ROLL
       536**DCL      4119>>IF
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.RET.DCB#
       521**DCL      4150<<ASSIGN   4155<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      4158<<ASSIGN
PL6.E3A0      #003=ZIM$JCKSMC File=ZIM$JRNL.:ZIC0TSI                             FRI 09/05/97 12:59 Page:114  
GLOBAL.RET.SYSERR#
       516**DCL      4149<<ASSIGN   4154<<ASSIGN
GLOBAL.TIME.TSTAMP
       728**DCL      4124>>ASSIGN
GLOBAL.TIME$
       777**DCL      4121>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      4140>>ASSIGN   4155>>ASSIGN
GLOBAL.WRTJ$
       775**DCL      4131>>ASSIGN
GLOBAL$
       799**DCL       495--IMP-PTR  4119>>IF       4121>>CALL     4122>>ASSIGN   4124>>ASSIGN   4126>>ASSIGN
      4127>>ASSIGN   4128>>ASSIGN   4128>>ASSIGN   4130>>ASSIGN   4131>>ASSIGN   4135>>ASSIGN   4140>>ASSIGN
      4149>>ASSIGN   4150>>ASSIGN   4150>>ASSIGN   4151>>ASSIGN   4154>>ASSIGN   4155>>ASSIGN   4155>>ASSIGN
      4158>>ASSIGN
JREC.LENGTH
      1635**DCL      1638--IMP-SIZ
JRNL$
      1608**DCL      1609--IMP-PTR  1629--IMP-PTR  1639--IMP-PTR  1646--IMP-PTR  1652--IMP-PTR  4122<<ASSIGN
      4123>>ASSIGN   4124>>ASSIGN   4125>>ASSIGN   4126>>ASSIGN   4127>>ASSIGN   4130>>ASSIGN
M$ERR
      1703**DCL-ENT  4159--CALL
M$TIME
      1758**DCL-ENT  4121--CALL
M$WRITE
      1692**DCL-ENT  4136--CALL     4141--CALL
TYPE
      4109**DCL      4114<<ASSIGN   4117<<ASSIGN   4123>>ASSIGN   4133>>IF
WRTJ$
      4111**DCL      1810--IMP-PTR  4131<<ASSIGN   4132>>ASSIGN   4135>>ASSIGN   4136>>CALL     4140>>ASSIGN
      4141>>CALL
ZIM$ICKSMJ
      4107**DCL-ENT  4129--CALL

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:115  
      470        1        /*T***********************************************************/
      471        2        /*T*                                                         */
      472        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      473        4        /*T*                                                         */
      474        5        /*T***********************************************************/
      475        6        ZIM$JCKPT: PROC(CKPTNO)
      476        7               AVOID($PR5,$PR6,$PR7);
      477        8        %INCLUDE ZI$GLOBAL;
      478      494            %GLOBALS;
      479      802        %INCLUDE ZI$JRNL;
      480      910            %JRNL_REC(STCLASS=AUTO);
      481      985        %INCLUDE CP_6;
      482     1066            %B$TCB;
      483     1069            %B$ALT;
      484     1077            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      485     1096            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      486     1127            %FPT_PFIL(FPTN=FPT$PFIL,STCLASS=BASED);
      487     1142            %FPT_PRECORD(FPTN=FPT$PRECJ,STCLASS=BASED);
      488     1163            %FPT_TRUNC(FPTN=FPT$TRUNC,STCLASS=BASED);
      489     1177        %INCLUDE CP_6_SUBS;
      490     1717        %INCLUDE B$JIT;
      491     2007        %INCLUDE ZI_ERRORS_C;
      492     2333        %INCLUDE B_ERRORS_C;
      493     3460    1   DCL ERROR UBIN(36);
      494     3461    1   DCL CKPTNO UBIN(36);
      495     3462    1   DCL TYPE UBIN(36);
      496     3463    1   DCL WRTJ$ PTR;
      497     3464    1   DCL B$JIT$ PTR SYMREF;
      498     3465    1   DCL B$TCB$ PTR SYMREF;
      499     3466    1       TYPE=T#CKPT;
      500     3467    1       GOTO COM;
      501     3468    1   ZIM$JROLL: ENTRY;
      502     3469    1       TYPE=T#ROL;
      503     3470    1   COM: ERROR=0;
      504     3471    1       IF ~GLOBAL.PENDING.ROLL THEN
      505     3472    2       DO;
      506     3473    2           WRTJ$=GLOBAL.WRTJ$;
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:116  
      507     3474    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      508     3475    2           JRNL$=ADDR(GLOBAL.JRECORD);
      509     3476    3           IF TYPE=T#CKPT THEN DO;
      510     3477    3               CKPT.TYPE=TYPE;
      511     3478    3               CKPT.TIME=GLOBAL.TIME.TSTAMP;
      512     3479    3               CKPT.USER#=B$JIT$->B$JIT.USER;
      513     3480    3               CKPT.CKPTNO=CKPTNO;
      514     3481    3               CKPT.MSGID=B$JIT$->B$JIT.MSGID;
      515     3482    3               FPT$WRTJ.BUF_.BOUND=SIZEV(CKPT)-SIZEC(CKPT.FILLER);
      516     3483    3               END;
      517     3484    2           ELSE
      518     3485    3           DO;
      519     3486    3               BERC.TYPE=TYPE;
      520     3487    3               BERC.TIME=GLOBAL.TIME.TSTAMP;
      521     3488    3               BERC.USER#=B$JIT$->B$JIT.USER;
      522     3489    3               BERC.SYSID=B$JIT$->B$JIT.SYSID;
      523     3490    3               FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);
      524     3491    3               END;
      525     3492    2           IF GLOBAL.CJRNL.DCB#~=0 THEN
      526     3493    3           DO;
      527     3494    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      528     3495    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      529     3496    3               GLOBAL.TRUNC$->FPT$TRUNC.V.DCB#=GLOBAL.CJRNL.DCB#;
      530     3497    3               CALL M$TRUNC(GLOBAL.TRUNC$->FPT$TRUNC) ALTRET(ER_WRTC);
      531     3498    3               END;
      532     3499    2           IF GLOBAL.TJRNL.DCB#~=0 THEN
      533     3500    3           DO;
      534     3501    3               GLOBAL.PFIL$->FPT$PFIL.V.DCB#=GLOBAL.TJRNL.DCB#;
      535     3502    3               GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%YES#;
      536     3503    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);
      537     3504    3               GLOBAL.PRECJ$->FPT$PRECJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      538     3505    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=GLOBAL.TJRNL.FIDCOUNT;
      539     3506    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      540     3507    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      541     3508    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      542     3509    3               GLOBAL.TJRNL.UNCHECK = '0'B; /* SET FLAG DB IN CLEAN STATUS */
      543     3510    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-1;
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:117  
      544     3511    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);
      545     3512    3               GLOBAL.TRUNC$->FPT$TRUNC.V.DCB#=GLOBAL.TJRNL.DCB#;
      546     3513    3               CALL M$TRUNC(GLOBAL.TRUNC$->FPT$TRUNC) ALTRET(ER_WRTT);
      547     3514    3               END;
      548     3515    2           END;
      549     3516    1       RETURN;
      550     3517    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
      551     3518    1           ERROR=ERR#IO#NOOWNER;
      552     3519    1       ELSE
      553     3520    1           ERROR=ERR#IO#WRTC;
      554     3521    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      555     3522    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
      556     3523    1       GLOBAL.CJRNL.DCB#=0;
      557     3524    1       GOTO ALT;
      558     3525    1   ER_WRTT: ERROR=ERR#IO#WRTT;
      559     3526    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      560     3527    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
      561     3528    1       GOTO ALT;
      562     3529    1   ALT: ;
      563     3530    1       GLOBAL.RET.ERROR#=ERROR;
      564     3531    1       CALL M$ERR;
      565     3532        %EJECT;
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:118  
      566     3533        /*
      567     3534              ENTRY    ZIM$UNCHECK:  SET STATUS TO A UN-CHECKED POINT
      568     3535                                     FOR UNPROTECTED USERS WHEN PAGES UPDATED.
      569     3536        */
      570     3537    1   ZIM$UNCHECK: ENTRY;
      571     3538
      572     3539    1       IF ~GLOBAL.TJRNL.UNCHECK AND ~GLOBAL.PENDING.ROLL AND
      573     3540    1          ~GLOBAL.PENDING.RECVRY THEN
      574     3541    1           GLOBAL.TJRNL.UNCHECK=%YES#;
      575     3542    1       RETURN;
      576     3543    1   END ZIM$JCKPT;
      577     3544        %EOD;

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:119  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JCKPT.

   Procedure ZIM$JCKPT requires 192 words for executable code.
   Procedure ZIM$JCKPT requires 8 words of local(AUTO) storage.

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:120  

 Object Unit name= ZIM$JCKPT                                  File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:00:00.00 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   192    300  ZIM$JCKPT
    2  RoData even  none     4      4  ZIM$JCKPT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       1  ZIM$JCKPT
     1      5                  yes      XStd       0  ZIM$JROLL
     1    254                  yes      XStd       0  ZIM$UNCHECK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:121  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:122  


      470        1        /*T***********************************************************/
      471        2        /*T*                                                         */
      472        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      473        4        /*T*                                                         */
      474        5        /*T***********************************************************/
      475        6        ZIM$JCKPT: PROC(CKPTNO)

      6  1 000000   000000 700200 xent  ZIM$JCKPT    TSX0  ! X66_AUTO_1
         1 000001   000010 000001                    ZERO    8,1

      476        7               AVOID($PR5,$PR6,$PR7);
      477        8        %INCLUDE ZI$GLOBAL;
      478      494            %GLOBALS;
      479      802        %INCLUDE ZI$JRNL;
      480      910            %JRNL_REC(STCLASS=AUTO);
      481      985        %INCLUDE CP_6;
      482     1066            %B$TCB;
      483     1069            %B$ALT;
      484     1077            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      485     1096            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      486     1127            %FPT_PFIL(FPTN=FPT$PFIL,STCLASS=BASED);
      487     1142            %FPT_PRECORD(FPTN=FPT$PRECJ,STCLASS=BASED);
      488     1163            %FPT_TRUNC(FPTN=FPT$TRUNC,STCLASS=BASED);
      489     1177        %INCLUDE CP_6_SUBS;
      490     1717        %INCLUDE B$JIT;
      491     2007        %INCLUDE ZI_ERRORS_C;
      492     2333        %INCLUDE B_ERRORS_C;
      493     3460    1   DCL ERROR UBIN(36);
      494     3461    1   DCL CKPTNO UBIN(36);
      495     3462    1   DCL TYPE UBIN(36);
      496     3463    1   DCL WRTJ$ PTR;
      497     3464    1   DCL B$JIT$ PTR SYMREF;
      498     3465    1   DCL B$TCB$ PTR SYMREF;
      499     3466    1       TYPE=T#CKPT;

   3466  1 000002   000014 235007                    LDA     12,DL
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:123  
         1 000003   200006 755100                    STA     TYPE,,AUTO

      500     3467    1       GOTO COM;

   3467  1 000004   000011 710000 1                  TRA     COM

      501     3468    1   ZIM$JROLL: ENTRY;

   3468  1 000005   000000 700200 xent  ZIM$JROLL    TSX0  ! X66_AUTO_1
         1 000006   000010 000001                    ZERO    8,1

      502     3469    1       TYPE=T#ROL;

   3469  1 000007   000013 235007                    LDA     11,DL
         1 000010   200006 755100                    STA     TYPE,,AUTO

      503     3470    1   COM: ERROR=0;

   3470  1 000011   200005 450100       COM          STZ     ERROR,,AUTO

      504     3471    1       IF ~GLOBAL.PENDING.ROLL THEN

   3471  1 000012   000000 470400 xsym               LDP0    GLOBAL$
         1 000013   000017 236100                    LDQ     15,,PR0
         1 000014   000010 736000                    QLS     8
         1 000015   400000 376003                    ANQ     -131072,DU
         1 000016   400000 676003                    ERQ     -131072,DU
         1 000017   000213 600000 1                  TZE     s:3516

      505     3472    2       DO;

      506     3473    2           WRTJ$=GLOBAL.WRTJ$;

   3473  1 000020   005115 236100                    LDQ     2637,,PR0
         1 000021   200007 756100                    STQ     WRTJ$,,AUTO

      507     3474    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:124  

   3474  1 000022   005117 471500                    LDP1    2639,,PR0
         1 000023   100000 630500                    EPPR0   0,,PR1
         1 000024   020004 713400                    CLIMB   8196
         1 000025   402000 401760                    pmme    nvectors=5

      508     3475    2           JRNL$=ADDR(GLOBAL.JRECORD);

   3475  1 000026   000000 236000 xsym               LDQ     GLOBAL$
         1 000027   002622 036003                    ADLQ    1426,DU
         1 000030   200004 756100                    STQ     JRNL$,,AUTO

      509     3476    3           IF TYPE=T#CKPT THEN DO;

   3476  1 000031   200006 235100                    LDA     TYPE,,AUTO
         1 000032   000014 115007                    CMPA    12,DL
         1 000033   000063 601000 1                  TNZ     s:3486

      510     3477    3               CKPT.TYPE=TYPE;

   3477  1 000034   200004 470500                    LDP0    JRNL$,,AUTO
         1 000035   200006 236100                    LDQ     TYPE,,AUTO
         1 000036   000033 736000                    QLS     27
         1 000037   000001 552140                    STBQ    1,'40'O,PR0

      511     3478    3               CKPT.TIME=GLOBAL.TIME.TSTAMP;

   3478  1 000040   000000 471400 xsym               LDP1    GLOBAL$
         1 000041   105001 235100                    LDA     2561,,PR1
         1 000042   000000 755100                    STA     0,,PR0

      512     3479    3               CKPT.USER#=B$JIT$->B$JIT.USER;

   3479  1 000043   000000 473400 xsym               LDP3    B$JIT$
         1 000044   300000 236100                    LDQ     0,,PR3
         1 000045   000001 552120                    STBQ    1,'20'O,PR0

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:125  
      513     3480    3               CKPT.CKPTNO=CKPTNO;

   3480  1 000046   200003 474500                    LDP4    @CKPTNO,,AUTO
         1 000047   000100 100500                    MLR     fill='000'O
         1 000050   400000 000004                    ADSC9   0,,PR4                   cn=0,n=4
         1 000051   000001 400004                    ADSC9   1,,PR0                   cn=2,n=4

      514     3481    3               CKPT.MSGID=B$JIT$->B$JIT.MSGID;

   3481  1 000052   000100 100500                    MLR     fill='000'O
         1 000053   300166 000010                    ADSC9   118,,PR3                 cn=0,n=8
         1 000054   000002 400010                    ADSC9   2,,PR0                   cn=2,n=8

      515     3482    3               FPT$WRTJ.BUF_.BOUND=SIZEV(CKPT)-SIZEC(CKPT.FILLER);

   3482  1 000055   200007 470500                    LDP0    WRTJ$,,AUTO
         1 000056   000004 236100                    LDQ     4,,PR0
         1 000057   177777 376007                    ANQ     65535,DL
         1 000060   000001 276000 2                  ORQ     1
         1 000061   000004 756100                    STQ     4,,PR0

      516     3483    3               END;

   3483  1 000062   000104 710000 1                  TRA     s:3492

      517     3484    2           ELSE
      518     3485    3           DO;

      519     3486    3               BERC.TYPE=TYPE;

   3486  1 000063   200004 470500                    LDP0    JRNL$,,AUTO
         1 000064   200006 236100                    LDQ     TYPE,,AUTO
         1 000065   000033 736000                    QLS     27
         1 000066   000001 552140                    STBQ    1,'40'O,PR0

      520     3487    3               BERC.TIME=GLOBAL.TIME.TSTAMP;

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:126  
   3487  1 000067   000000 471400 xsym               LDP1    GLOBAL$
         1 000070   105001 235100                    LDA     2561,,PR1
         1 000071   000000 755100                    STA     0,,PR0

      521     3488    3               BERC.USER#=B$JIT$->B$JIT.USER;

   3488  1 000072   000000 473400 xsym               LDP3    B$JIT$
         1 000073   300000 236100                    LDQ     0,,PR3
         1 000074   000001 552120                    STBQ    1,'20'O,PR0

      522     3489    3               BERC.SYSID=B$JIT$->B$JIT.SYSID;

   3489  1 000075   300000 720100                    LXL0    0,,PR3
         1 000076   000001 440100                    SXL0    1,,PR0

      523     3490    3               FPT$WRTJ.BUF_.BOUND=SIZEV(BERC);

   3490  1 000077   200007 474500                    LDP4    WRTJ$,,AUTO
         1 000100   400004 236100                    LDQ     4,,PR4
         1 000101   177777 376007                    ANQ     65535,DL
         1 000102   000002 276000 2                  ORQ     2
         1 000103   400004 756100                    STQ     4,,PR4

      524     3491    3               END;

      525     3492    2           IF GLOBAL.CJRNL.DCB#~=0 THEN

   3492  1 000104   102610 235100                    LDA     1416,,PR1
         1 000105   000125 600000 1                  TZE     s:3499

      526     3493    3           DO;

      527     3494    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   3494  1 000106   102610 720100                    LXL0    1416,,PR1
         1 000107   200007 470500                    LDP0    WRTJ$,,AUTO
         1 000110   000010 740100                    STX0    8,,PR0
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:127  

      528     3495    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   3495  1 000111   440001 713400                    CLIMB   alt,write
         1 000112   401400 401760                    pmme    nvectors=4
         1 000113   000214 702000 1                  TSX2    ER_WRTC

      529     3496    3               GLOBAL.TRUNC$->FPT$TRUNC.V.DCB#=GLOBAL.CJRNL.DCB#;

   3496  1 000114   000000 470400 xsym               LDP0    GLOBAL$
         1 000115   005121 471500                    LDP1    2641,,PR0
         1 000116   002610 720100                    LXL0    1416,,PR0
         1 000117   100002 740100                    STX0    2,,PR1

      530     3497    3               CALL M$TRUNC(GLOBAL.TRUNC$->FPT$TRUNC) ALTRET(ER_WRTC);

   3497  1 000120   005121 471500                    LDP1    2641,,PR0
         1 000121   100000 630500                    EPPR0   0,,PR1
         1 000122   450003 713400                    CLIMB   alt,+20483
         1 000123   400000 401760                    pmme    nvectors=1
         1 000124   000214 702000 1                  TSX2    ER_WRTC

      531     3498    3               END;

      532     3499    2           IF GLOBAL.TJRNL.DCB#~=0 THEN

   3499  1 000125   000000 470400 xsym               LDP0    GLOBAL$
         1 000126   002604 235100                    LDA     1412,,PR0
         1 000127   000213 600000 1                  TZE     s:3516

      533     3500    3           DO;

      534     3501    3               GLOBAL.PFIL$->FPT$PFIL.V.DCB#=GLOBAL.TJRNL.DCB#;

   3501  1 000130   005114 471500                    LDP1    2636,,PR0
         1 000131   002604 720100                    LXL0    1412,,PR0
         1 000132   100002 740100                    STX0    2,,PR1
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:128  

      535     3502    3               GLOBAL.PFIL$->FPT$PFIL.V.BOF#=%YES#;

   3502  1 000133   005114 471500                    LDP1    2636,,PR0
         1 000134   400000 236007                    LDQ     -131072,DL
         1 000135   100002 256100                    ORSQ    2,,PR1

      536     3503    3               CALL M$PFIL(GLOBAL.PFIL$->FPT$PFIL) ALTRET(ER_WRTT);

   3503  1 000136   005114 471500                    LDP1    2636,,PR0
         1 000137   100000 630500                    EPPR0   0,,PR1
         1 000140   440004 713400                    CLIMB   alt,+16388
         1 000141   400000 401760                    pmme    nvectors=1
         1 000142   000236 702000 1                  TSX2    ER_WRTT

      537     3504    3               GLOBAL.PRECJ$->FPT$PRECJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   3504  1 000143   000000 470400 xsym               LDP0    GLOBAL$
         1 000144   005124 471500                    LDP1    2644,,PR0
         1 000145   002604 720100                    LXL0    1412,,PR0
         1 000146   100006 740100                    STX0    6,,PR1

      538     3505    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=GLOBAL.TJRNL.FIDCOUNT;

   3505  1 000147   005124 471500                    LDP1    2644,,PR0
         1 000150   002605 235100                    LDA     1413,,PR0
         1 000151   100007 755100                    STA     7,,PR1

      539     3506    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

   3506  1 000152   005124 471500                    LDP1    2644,,PR0
         1 000153   100000 630500                    EPPR0   0,,PR1
         1 000154   440003 713400                    CLIMB   alt,+16387
         1 000155   401000 401760                    pmme    nvectors=3
         1 000156   000236 702000 1                  TSX2    ER_WRTT

      540     3507    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:129  

   3507  1 000157   000000 470400 xsym               LDP0    GLOBAL$
         1 000160   002604 720100                    LXL0    1412,,PR0
         1 000161   200007 471500                    LDP1    WRTJ$,,AUTO
         1 000162   100010 740100                    STX0    8,,PR1

      541     3508    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   3508  1 000163   100000 630500                    EPPR0   0,,PR1
         1 000164   440001 713400                    CLIMB   alt,write
         1 000165   401400 401760                    pmme    nvectors=4
         1 000166   000236 702000 1                  TSX2    ER_WRTT

      542     3509    3               GLOBAL.TJRNL.UNCHECK = '0'B; /* SET FLAG DB IN CLEAN STATUS */

   3509  1 000167   000000 470400 xsym               LDP0    GLOBAL$
         1 000170   000003 236000 2                  LDQ     3
         1 000171   002606 356100                    ANSQ    1414,,PR0

      543     3510    3               GLOBAL.PRECJ$->FPT$PRECJ.V.N#=-1;

   3510  1 000172   005124 471500                    LDP1    2644,,PR0
         1 000173   000001 335007                    LCA     1,DL
         1 000174   100007 755100                    STA     7,,PR1

      544     3511    3               CALL M$PRECORD(GLOBAL.PRECJ$->FPT$PRECJ) ALTRET(ER_WRTT);

   3511  1 000175   005124 471500                    LDP1    2644,,PR0
         1 000176   100000 630500                    EPPR0   0,,PR1
         1 000177   440003 713400                    CLIMB   alt,+16387
         1 000200   401000 401760                    pmme    nvectors=3
         1 000201   000236 702000 1                  TSX2    ER_WRTT

      545     3512    3               GLOBAL.TRUNC$->FPT$TRUNC.V.DCB#=GLOBAL.TJRNL.DCB#;

   3512  1 000202   000000 470400 xsym               LDP0    GLOBAL$
         1 000203   005121 471500                    LDP1    2641,,PR0
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:130  
         1 000204   002604 720100                    LXL0    1412,,PR0
         1 000205   100002 740100                    STX0    2,,PR1

      546     3513    3               CALL M$TRUNC(GLOBAL.TRUNC$->FPT$TRUNC) ALTRET(ER_WRTT);

   3513  1 000206   005121 471500                    LDP1    2641,,PR0
         1 000207   100000 630500                    EPPR0   0,,PR1
         1 000210   450003 713400                    CLIMB   alt,+20483
         1 000211   400000 401760                    pmme    nvectors=1
         1 000212   000236 702000 1                  TSX2    ER_WRTT

      547     3514    3               END;

      548     3515    2           END;

      549     3516    1       RETURN;

   3516  1 000213   000000 702200 xent               TSX2  ! X66_ARET

      550     3517    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   3517  1 000214   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         1 000215   000000 471500                    LDP1    0,,PR0
         1 000216   100102 236100                    LDQ     66,,PR1
         1 000217   377770 376007                    ANQ     131064,DL
         1 000220   001160 116007                    CMPQ    624,DL
         1 000221   000225 601000 1                  TNZ     s:3520

      551     3518    1           ERROR=ERR#IO#NOOWNER;

   3518  1 000222   210762 235007                    LDA     70130,DL
         1 000223   200005 755100                    STA     ERROR,,AUTO
         1 000224   000227 710000 1                  TRA     s:3521

      552     3519    1       ELSE
      553     3520    1           ERROR=ERR#IO#WRTC;

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:131  
   3520  1 000225   210721 235007                    LDA     70097,DL
         1 000226   200005 755100                    STA     ERROR,,AUTO

      554     3521    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3521  1 000227   100102 236100                    LDQ     66,,PR1
         1 000230   000000 473400 xsym               LDP3    GLOBAL$
         1 000231   300007 756100                    STQ     7,,PR3

      555     3522    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   3522  1 000232   302610 720100                    LXL0    1416,,PR3
         1 000233   300014 740100                    STX0    12,,PR3

      556     3523    1       GLOBAL.CJRNL.DCB#=0;

   3523  1 000234   302610 450100                    STZ     1416,,PR3

      557     3524    1       GOTO ALT;

   3524  1 000235   000250 710000 1                  TRA     ALT

      558     3525    1   ER_WRTT: ERROR=ERR#IO#WRTT;

   3525  1 000236   210720 235007       ER_WRTT      LDA     70096,DL
         1 000237   200005 755100                    STA     ERROR,,AUTO

      559     3526    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   3526  1 000240   000000 470400 xsym               LDP0    B$TCB$
         1 000241   000000 471500                    LDP1    0,,PR0
         1 000242   100102 236100                    LDQ     66,,PR1
         1 000243   000000 473400 xsym               LDP3    GLOBAL$
         1 000244   300007 756100                    STQ     7,,PR3

      560     3527    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:132  
   3527  1 000245   302604 720100                    LXL0    1412,,PR3
         1 000246   300014 740100                    STX0    12,,PR3

      561     3528    1       GOTO ALT;

   3528  1 000247   000250 710000 1                  TRA     ALT

   3527  1 000250                       ALT          null
      562     3529    1   ALT: ;
      563     3530    1       GLOBAL.RET.ERROR#=ERROR;

   3530  1 000250   300006 755100                    STA     6,,PR3

      564     3531    1       CALL M$ERR;

   3531  1 000251   000002 713400                    CLIMB   err
         1 000252   000000 401760                    pmme    nvectors=0
         1 000253   000256 710000 1                  TRA     s:3539

      565     3532        %EJECT;
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:133  
      566     3533        /*
      567     3534              ENTRY    ZIM$UNCHECK:  SET STATUS TO A UN-CHECKED POINT
      568     3535                                     FOR UNPROTECTED USERS WHEN PAGES UPDATED.
      569     3536        */
      570     3537    1   ZIM$UNCHECK: ENTRY;

   3537  1 000254   000000 700200 xent  ZIM$UNCHECK  TSX0  ! X66_AUTO_1
         1 000255   000010 000001                    ZERO    8,1

      571     3538
      572     3539    1       IF ~GLOBAL.TJRNL.UNCHECK AND ~GLOBAL.PENDING.ROLL AND

   3539  1 000256   000000 470400 xsym               LDP0    GLOBAL$
         1 000257   002606 236100                    LDQ     1414,,PR0
         1 000260   400000 376003                    ANQ     -131072,DU
         1 000261   400000 676003                    ERQ     -131072,DU
         1 000262   000277 600000 1                  TZE     s:3542
         1 000263   000017 236100                    LDQ     15,,PR0
         1 000264   000010 736000                    QLS     8
         1 000265   400000 376003                    ANQ     -131072,DU
         1 000266   400000 676003                    ERQ     -131072,DU
         1 000267   000277 600000 1                  TZE     s:3542
         1 000270   000017 236100                    LDQ     15,,PR0
         1 000271   000005 736000                    QLS     5
         1 000272   400000 376003                    ANQ     -131072,DU
         1 000273   400000 676003                    ERQ     -131072,DU
         1 000274   000277 600000 1                  TZE     s:3542

      573     3540    1          ~GLOBAL.PENDING.RECVRY THEN
      574     3541    1           GLOBAL.TJRNL.UNCHECK=%YES#;

   3541  1 000275   400000 236003                    LDQ     -131072,DU
         1 000276   002606 256100                    ORSQ    1414,,PR0

      575     3542    1       RETURN;

   3542  1 000277   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:134  

(unnamed)
 Sect OctLoc
   2     000   000000 006014   000004 200000   000001 600000   377777 777777    ................
      576     3543    1   END ZIM$JCKPT;
      577     3544        %EOD;

PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:135  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JCKPT.

   Procedure ZIM$JCKPT requires 192 words for executable code.
   Procedure ZIM$JCKPT requires 8 words of local(AUTO) storage.
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:136  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:137  
          MINI XREF LISTING

ALT
      3527**LABEL    3524--GOTO     3528--GOTO
B$ALT.CODE
      1071**DCL      1071--REDEF    1072--REDEF    1072--REDEF
B$ALT.ERR
      1072**DCL      3521>>ASSIGN   3526>>ASSIGN
B$ALT.ERR.ERR#
      1073**DCL      1073--REDEF    3517>>IF
B$ALT.EVID
      1072**DCL      1072--REDEF    1072--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1825**DCL      1825--REDEF
B$JIT.ERR.MID
      1732**DCL      1732--REDEF
B$JIT.JRESPEAK
      1893**DCL      1894--REDEF
B$JIT.MSGID
      1880**DCL      3481>>ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      2002**DCL      2002--REDEF    2003--REDEF
B$JIT.PNR
      1906**DCL      1906--REDEF
B$JIT.SYSID
      1731**DCL      3489>>ASSIGN
B$JIT.TSLINE
      2000**DCL      2001--REDEF
B$JIT.USER
      1731**DCL      3479>>ASSIGN   3488>>ASSIGN
B$JIT$
      3464**DCL      1726--IMP-PTR  3479>>ASSIGN   3481>>ASSIGN   3488>>ASSIGN   3489>>ASSIGN
B$TCB.ALT$
      1067**DCL      3517>>IF       3521>>ASSIGN   3526>>ASSIGN
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:138  
B$TCB$
      3465**DCL      3517>>IF       3521>>ASSIGN   3526>>ASSIGN
BERC
       949**DCL      3490--ASSIGN
BERC.DCB#
       953**DCL       954--REDEF
BERC.SYSID
       954**DCL      3489<<ASSIGN
BERC.TIME
       950**DCL      3487<<ASSIGN
BERC.TYPE
       951**DCL      3486<<ASSIGN
BERC.USER#
       952**DCL      3488<<ASSIGN
CKPT
       955**DCL      3482--ASSIGN
CKPT.CKPTNO
       959**DCL      3480<<ASSIGN
CKPT.FILLER
       963**DCL      3482--ASSIGN
CKPT.MSGID
       960**DCL      3481<<ASSIGN
CKPT.TIME
       956**DCL      3478<<ASSIGN
CKPT.TYPE
       957**DCL      3477<<ASSIGN
CKPT.USER#
       958**DCL      3479<<ASSIGN
CKPTNO
      3461**DCL         6--PROC     3480>>ASSIGN
COM
      3470**LABEL    3467--GOTO
ERROR
      3460**DCL      3470<<ASSIGN   3518<<ASSIGN   3520<<ASSIGN   3525<<ASSIGN   3530>>ASSIGN
ER_WRTC
      3517**LABEL    3495--CALLALT  3497--CALLALT
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:139  
ER_WRTT
      3525**LABEL    3503--CALLALT  3506--CALLALT  3508--CALLALT  3511--CALLALT  3513--CALLALT
FPT$PFIL
      1138**DCL      3503<>CALL
FPT$PFIL.V.BOF#
      1139**DCL      3502<<ASSIGN
FPT$PFIL.V.DCB#
      1138**DCL      3501<<ASSIGN
FPT$PRECJ
      1153**DCL      3506<>CALL     3511<>CALL
FPT$PRECJ.V.DCB#
      1155**DCL      3504<<ASSIGN
FPT$PRECJ.V.N#
      1159**DCL      3505<<ASSIGN   3510<<ASSIGN
FPT$TIME
      1088**DCL      3474<>CALL
FPT$TRUNC
      1174**DCL      3497<>CALL     3513<>CALL
FPT$TRUNC.V.DCB#
      1174**DCL      3496<<ASSIGN   3512<<ASSIGN
FPT$WRTJ
      1113**DCL      3495<>CALL     3508<>CALL
FPT$WRTJ.BUF_.BOUND
      1113**DCL      3482<<ASSIGN   3490<<ASSIGN
FPT$WRTJ.STATION_
      1115**DCL      1115--REDEF
FPT$WRTJ.V.DCB#
      1116**DCL      3494<<ASSIGN   3507<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      1122**DCL      1122--REDEF
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF
GLOBAL.CJRNL.DCB#
       690**DCL      3492>>IF       3494>>ASSIGN   3496>>ASSIGN   3522>>ASSIGN   3523<<ASSIGN
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:140  
GLOBAL.JRECORD
       700**DCL      3475--ASSIGN
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.RECVRY
       533**DCL      3539>>IF
GLOBAL.PENDING.ROLL
       536**DCL      3471>>IF       3539>>IF
GLOBAL.PFIL$
       774**DCL      3501>>ASSIGN   3502>>ASSIGN   3503>>CALL
GLOBAL.PRECJ$
       782**DCL      3504>>ASSIGN   3505>>ASSIGN   3506>>CALL     3510>>ASSIGN   3511>>CALL
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.RET.DCB#
       521**DCL      3522<<ASSIGN   3527<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      3530<<ASSIGN
GLOBAL.RET.SYSERR#
       516**DCL      3521<<ASSIGN   3526<<ASSIGN
GLOBAL.TIME.TSTAMP
       728**DCL      3478>>ASSIGN   3487>>ASSIGN
GLOBAL.TIME$
       777**DCL      3474>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      3499>>IF       3501>>ASSIGN   3504>>ASSIGN   3507>>ASSIGN   3512>>ASSIGN   3527>>ASSIGN
GLOBAL.TJRNL.FIDCOUNT
       685**DCL      3505>>ASSIGN
GLOBAL.TJRNL.UNCHECK
       686**DCL      3509<<ASSIGN   3539>>IF       3541<<ASSIGN
GLOBAL.TRUNC$
       779**DCL      3496>>ASSIGN   3497>>CALL     3512>>ASSIGN   3513>>CALL
PL6.E3A0      #004=ZIM$JCKPT File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:141  
GLOBAL.WRTJ$
       775**DCL      3473>>ASSIGN
GLOBAL$
       799**DCL       495--IMP-PTR  3471>>IF       3473>>ASSIGN   3474>>CALL     3475>>ASSIGN   3478>>ASSIGN
      3487>>ASSIGN   3492>>IF       3494>>ASSIGN   3496>>ASSIGN   3496>>ASSIGN   3497>>CALL     3499>>IF
      3501>>ASSIGN   3501>>ASSIGN   3502>>ASSIGN   3503>>CALL     3504>>ASSIGN   3504>>ASSIGN   3505>>ASSIGN
      3505>>ASSIGN   3506>>CALL     3507>>ASSIGN   3509>>ASSIGN   3510>>ASSIGN   3511>>CALL     3512>>ASSIGN
      3512>>ASSIGN   3513>>CALL     3521>>ASSIGN   3522>>ASSIGN   3522>>ASSIGN   3523>>ASSIGN   3526>>ASSIGN
      3527>>ASSIGN   3527>>ASSIGN   3530>>ASSIGN   3539>>IF       3539>>IF       3539>>IF       3541>>ASSIGN
JREC.LENGTH
       938**DCL       941--IMP-SIZ
JRNL$
       911**DCL       912--IMP-PTR   932--IMP-PTR   942--IMP-PTR   949--IMP-PTR   955--IMP-PTR  3475<<ASSIGN
      3477>>ASSIGN   3478>>ASSIGN   3479>>ASSIGN   3480>>ASSIGN   3481>>ASSIGN   3486>>ASSIGN   3487>>ASSIGN
      3488>>ASSIGN   3489>>ASSIGN
M$ERR
      1006**DCL-ENT  3531--CALL
M$PFIL
       996**DCL-ENT  3503--CALL
M$PRECORD
       998**DCL-ENT  3506--CALL     3511--CALL
M$TIME
      1061**DCL-ENT  3474--CALL
M$TRUNC
       995**DCL-ENT  3497--CALL     3513--CALL
M$WRITE
       995**DCL-ENT  3495--CALL     3508--CALL
TYPE
      3462**DCL      3466<<ASSIGN   3469<<ASSIGN   3476>>IF       3477>>ASSIGN   3486>>ASSIGN
WRTJ$
      3463**DCL      1113--IMP-PTR  3473<<ASSIGN   3482>>ASSIGN   3490>>ASSIGN   3494>>ASSIGN   3495>>CALL
      3507>>ASSIGN   3508>>CALL

PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:142  
      578        1        /*T***********************************************************/
      579        2        /*T*                                                         */
      580        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      581        4        /*T*                                                         */
      582        5        /*T***********************************************************/
      583        6        ZIM$JKSTO: PROC(AWS$)
      584        7               AVOID($PR5,$PR6,$PR7);
      585        8        %INCLUDE ZI$GLOBAL;
      586      494            %GLOBALS;
      587      802        %INCLUDE ZI$DBCB;
      588     1444            %AWS;
      589     1484        %INCLUDE ZI$JRNL;
      590     1592            %JRNL_REC(STCLASS=AUTO);
      591     1667        %INCLUDE CP_6;
      592     1748            %B$TCB;
      593     1751            %B$ALT;
      594     1759            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      595     1778            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      596     1809        %INCLUDE CP_6_SUBS;
      597     2349        %INCLUDE ZI_ERRORS_C;
      598     2675        %INCLUDE B_ERRORS_C;
      599     3802        %INCLUDE B$JIT;
      600     4092    1   DCL ERROR UBIN(36);
      601     4093    1   DCL TYPE UBIN(36);
      602     4094    1   DCL WRTJ$ PTR;
      603     4095    1   DCL B$JIT$ PTR SYMREF;
      604     4096    1   DCL B$TCB$ PTR SYMREF;
      605     4097    1   DCL ZIM$UNCHECK ENTRY;
      606     4098
      607     4099    1       TYPE=T#KSTO;
      608     4100    1       GOTO COM;
      609     4101    1   ZIM$JKDEL: ENTRY(AWS$);
      610     4102    1       TYPE=T#KDEL;
      611     4103    1   COM: ERROR=0;
      612     4104    1       IF GLOBAL.PENDING.ROLL THEN GOTO RET;
      613     4105    1       IF AWS.ATRIB.CJRNL OR AWS.ATRIB.TJRNL THEN
      614     4106    2       DO;
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:143  
      615     4107    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      616     4108    2           JRNL$=ADDR(GLOBAL.JRECORD);
      617     4109    2           JREC.TYPE=TYPE;
      618     4110    2           JREC.TIME=GLOBAL.TIME.TSTAMP;
      619     4111    2           JREC.USER#=B$JIT$->B$JIT.USER;
      620     4112    2           JREC.DCB#=AWS.DDCB;
      621     4113    2           JREC.PAGE=0;
      622     4114    2           JREC.LENGTH=GLOBAL.SKEY.LENGTH;
      623     4115    2           JREC.LINE=0;
      624     4116    2           JREC.OFFSET=0;
      625     4117    2           JREC.VALUE=SUBSTR(GLOBAL.KEY.VALUE,0,GLOBAL.KEY.LENGTH);
      626     4118    2           WRTJ$=GLOBAL.WRTJ$;
      627     4119    2           FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      628     4120    2           IF AWS.ATRIB.TJRNL THEN
      629     4121    3           DO;
      630     4122    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      631     4123    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      632     4124    3               END;
      633     4125    2           IF AWS.ATRIB.CJRNL THEN
      634     4126    3           DO;
      635     4127    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      636     4128    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      637     4129    3               END;
      638     4130    2           END;
      639     4131    1   RET: RETURN;
      640     4132    1   ER_WRTT: ERROR=ERR#IO#WRTT;
      641     4133    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      642     4134    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
      643     4135    1       GOTO ALT;
      644     4136    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
      645     4137    1           ERROR=ERR#IO#NOOWNER;
      646     4138    1       ELSE
      647     4139    1           ERROR=ERR#IO#WRTC;
      648     4140    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      649     4141    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
      650     4142    1       GLOBAL.CJRNL.DCB#=0;
      651     4143    1       GOTO ALT;
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:144  
      652     4144    1   ALT: ;
      653     4145    1       GLOBAL.RET.ERROR#=ERROR;
      654     4146    1       CALL M$ERR;
      655     4147    1   END ZIM$JKSTO;
      656     4148        %EOD;

PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:145  
--  Include file information  --

   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JKSTO.

   Procedure ZIM$JKSTO requires 127 words for executable code.
   Procedure ZIM$JKSTO requires 8 words of local(AUTO) storage.

PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:146  

 Object Unit name= ZIM$JKSTO                                  File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:00:29.68 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   127    177  ZIM$JKSTO
    2  RoData even  none     1      1  ZIM$JKSTO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       1  ZIM$JKSTO
     1      5                  yes      XStd       1  ZIM$JKDEL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:147  


      578        1        /*T***********************************************************/
      579        2        /*T*                                                         */
      580        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      581        4        /*T*                                                         */
      582        5        /*T***********************************************************/
      583        6        ZIM$JKSTO: PROC(AWS$)

      6  1 000000   000000 700200 xent  ZIM$JKSTO    TSX0  ! X66_AUTO_1
         1 000001   000010 000001                    ZERO    8,1

      584        7               AVOID($PR5,$PR6,$PR7);
      585        8        %INCLUDE ZI$GLOBAL;
      586      494            %GLOBALS;
      587      802        %INCLUDE ZI$DBCB;
      588     1444            %AWS;
      589     1484        %INCLUDE ZI$JRNL;
      590     1592            %JRNL_REC(STCLASS=AUTO);
      591     1667        %INCLUDE CP_6;
      592     1748            %B$TCB;
      593     1751            %B$ALT;
      594     1759            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      595     1778            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      596     1809        %INCLUDE CP_6_SUBS;
      597     2349        %INCLUDE ZI_ERRORS_C;
      598     2675        %INCLUDE B_ERRORS_C;
      599     3802        %INCLUDE B$JIT;
      600     4092    1   DCL ERROR UBIN(36);
      601     4093    1   DCL TYPE UBIN(36);
      602     4094    1   DCL WRTJ$ PTR;
      603     4095    1   DCL B$JIT$ PTR SYMREF;
      604     4096    1   DCL B$TCB$ PTR SYMREF;
      605     4097    1   DCL ZIM$UNCHECK ENTRY;
      606     4098
      607     4099    1       TYPE=T#KSTO;

   4099  1 000002   000016 235007                    LDA     14,DL
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:148  
         1 000003   200006 755100                    STA     TYPE,,AUTO

      608     4100    1       GOTO COM;

   4100  1 000004   000011 710000 1                  TRA     COM

      609     4101    1   ZIM$JKDEL: ENTRY(AWS$);

   4101  1 000005   000000 700200 xent  ZIM$JKDEL    TSX0  ! X66_AUTO_1
         1 000006   000010 000001                    ZERO    8,1

      610     4102    1       TYPE=T#KDEL;

   4102  1 000007   000017 235007                    LDA     15,DL
         1 000010   200006 755100                    STA     TYPE,,AUTO

      611     4103    1   COM: ERROR=0;

   4103  1 000011   200005 450100       COM          STZ     ERROR,,AUTO

      612     4104    1       IF GLOBAL.PENDING.ROLL THEN GOTO RET;

   4104  1 000012   000000 470400 xsym               LDP0    GLOBAL$
         1 000013   000017 430100                    FSZN    15,,PR0
         1 000014   000136 604000 1                  TMI     RET

      613     4105    1       IF AWS.ATRIB.CJRNL OR AWS.ATRIB.TJRNL THEN

   4105  1 000015   200003 471500                    LDP1    @AWS$,,AUTO
         1 000016   100000 473500                    LDP3    0,,PR1
         1 000017   300000 236100                    LDQ     0,,PR3
         1 000020   100000 316003                    CANQ    32768,DU
         1 000021   000024 601000 1                  TNZ     s:4107
         1 000022   020000 316003                    CANQ    8192,DU
         1 000023   000136 600000 1                  TZE     RET

      614     4106    2       DO;
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:149  

      615     4107    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   4107  1 000024   005117 474500                    LDP4    2639,,PR0
         1 000025   400000 630500                    EPPR0   0,,PR4
         1 000026   020004 713400                    CLIMB   8196
         1 000027   402000 401760                    pmme    nvectors=5

      616     4108    2           JRNL$=ADDR(GLOBAL.JRECORD);

   4108  1 000030   000000 236000 xsym               LDQ     GLOBAL$
         1 000031   002622 036003                    ADLQ    1426,DU
         1 000032   200004 756100                    STQ     JRNL$,,AUTO

      617     4109    2           JREC.TYPE=TYPE;

   4109  1 000033   200004 470500                    LDP0    JRNL$,,AUTO
         1 000034   200006 236100                    LDQ     TYPE,,AUTO
         1 000035   000033 736000                    QLS     27
         1 000036   000001 552140                    STBQ    1,'40'O,PR0

      618     4110    2           JREC.TIME=GLOBAL.TIME.TSTAMP;

   4110  1 000037   000000 471400 xsym               LDP1    GLOBAL$
         1 000040   105001 235100                    LDA     2561,,PR1
         1 000041   000000 755100                    STA     0,,PR0

      619     4111    2           JREC.USER#=B$JIT$->B$JIT.USER;

   4111  1 000042   000000 473400 xsym               LDP3    B$JIT$
         1 000043   300000 236100                    LDQ     0,,PR3
         1 000044   000001 552120                    STBQ    1,'20'O,PR0

      620     4112    2           JREC.DCB#=AWS.DDCB;

   4112  1 000045   200003 474500                    LDP4    @AWS$,,AUTO
         1 000046   400000 470500                    LDP0    0,,PR4
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:150  
         1 000047   000006 220100                    LDX0    6,,PR0
         1 000050   200004 470500                    LDP0    JRNL$,,AUTO
         1 000051   000001 440100                    SXL0    1,,PR0

      621     4113    2           JREC.PAGE=0;

   4113  1 000052   000002 450100                    STZ     2,,PR0

      622     4114    2           JREC.LENGTH=GLOBAL.SKEY.LENGTH;

   4114  1 000053   104624 236100                    LDQ     2452,,PR1
         1 000054   000033 772000                    QRL     27
         1 000055   000000 621006                    EAX1    0,QL
         1 000056   000003 741100                    STX1    3,,PR0

      623     4115    2           JREC.LINE=0;

   4115  1 000057   000000 222003                    LDX2    0,DU
         1 000060   000003 442100                    SXL2    3,,PR0

      624     4116    2           JREC.OFFSET=0;

   4116  1 000061   000004 742100                    STX2    4,,PR0

      625     4117    2           JREC.VALUE=SUBSTR(GLOBAL.KEY.VALUE,0,GLOBAL.KEY.LENGTH);

   4117  1 000062   104624 236100                    LDQ     2452,,PR1
         1 000063   000033 772000                    QRL     27
         1 000064   000000 623006                    EAX3    0,QL
         1 000065   040140 100540                    MLR     fill='040'O
         1 000066   104624 200013                    ADSC9   2452,,PR1                cn=1,n=*X3
         1 000067   000004 400011                    ADSC9   4,,PR0                   cn=2,n=*X1

      626     4118    2           WRTJ$=GLOBAL.WRTJ$;

   4118  1 000070   105115 236100                    LDQ     2637,,PR1
         1 000071   200007 756100                    STQ     WRTJ$,,AUTO
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:151  

      627     4119    2           FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   4119  1 000072   000022 623011                    EAX3    18,X1
         1 000073   000000 636013                    EAQ     0,X3
         1 000074   000022 772000                    QRL     18
         1 000075   000011 402007                    MPY     9,DL
         1 000076   000043 036007                    ADLQ    35,DL
         1 000077   000044 506007                    DIV     36,DL
         1 000100   200007 470500                    LDP0    WRTJ$,,AUTO
         1 000101   000002 736000                    QLS     2
         1 000102   000001 136007                    SBLQ    1,DL
         1 000103   000020 736000                    QLS     16
         1 000104   000004 676100                    ERQ     4,,PR0
         1 000105   000000 376000 2                  ANQ     0
         1 000106   000004 656100                    ERSQ    4,,PR0

      628     4120    2           IF AWS.ATRIB.TJRNL THEN

   4120  1 000107   400000 470500                    LDP0    0,,PR4
         1 000110   000000 236100                    LDQ     0,,PR0
         1 000111   020000 316003                    CANQ    8192,DU
         1 000112   000121 600000 1                  TZE     s:4125

      629     4121    3           DO;

      630     4122    3               FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   4122  1 000113   102604 720100                    LXL0    1412,,PR1
         1 000114   200007 470500                    LDP0    WRTJ$,,AUTO
         1 000115   000010 740100                    STX0    8,,PR0

      631     4123    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   4123  1 000116   440001 713400                    CLIMB   alt,write
         1 000117   401400 401760                    pmme    nvectors=4
         1 000120   000137 702000 1                  TSX2    ER_WRTT
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:152  

      632     4124    3               END;

      633     4125    2           IF AWS.ATRIB.CJRNL THEN

   4125  1 000121   200003 470500                    LDP0    @AWS$,,AUTO
         1 000122   000000 471500                    LDP1    0,,PR0
         1 000123   100000 236100                    LDQ     0,,PR1
         1 000124   100000 316003                    CANQ    32768,DU
         1 000125   000136 600000 1                  TZE     RET

      634     4126    3           DO;

      635     4127    3               FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   4127  1 000126   000000 473400 xsym               LDP3    GLOBAL$
         1 000127   302610 720100                    LXL0    1416,,PR3
         1 000130   200007 474500                    LDP4    WRTJ$,,AUTO
         1 000131   400010 740100                    STX0    8,,PR4

      636     4128    3               CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   4128  1 000132   400000 630500                    EPPR0   0,,PR4
         1 000133   440001 713400                    CLIMB   alt,write
         1 000134   401400 401760                    pmme    nvectors=4
         1 000135   000151 702000 1                  TSX2    ER_WRTC

      637     4129    3               END;

      638     4130    2           END;

      639     4131    1   RET: RETURN;

   4131  1 000136   000000 702200 xent  RET          TSX2  ! X66_ARET

      640     4132    1   ER_WRTT: ERROR=ERR#IO#WRTT;

PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:153  
   4132  1 000137   210720 235007       ER_WRTT      LDA     70096,DL
         1 000140   200005 755100                    STA     ERROR,,AUTO

      641     4133    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4133  1 000141   000000 470400 xsym               LDP0    B$TCB$
         1 000142   000000 471500                    LDP1    0,,PR0
         1 000143   100102 236100                    LDQ     66,,PR1
         1 000144   000000 473400 xsym               LDP3    GLOBAL$
         1 000145   300007 756100                    STQ     7,,PR3

      642     4134    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

   4134  1 000146   302604 720100                    LXL0    1412,,PR3
         1 000147   300014 740100                    STX0    12,,PR3

      643     4135    1       GOTO ALT;

   4135  1 000150   000173 710000 1                  TRA     ALT

      644     4136    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   4136  1 000151   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         1 000152   000000 471500                    LDP1    0,,PR0
         1 000153   100102 236100                    LDQ     66,,PR1
         1 000154   377770 376007                    ANQ     131064,DL
         1 000155   001160 116007                    CMPQ    624,DL
         1 000156   000162 601000 1                  TNZ     s:4139

      645     4137    1           ERROR=ERR#IO#NOOWNER;

   4137  1 000157   210762 235007                    LDA     70130,DL
         1 000160   200005 755100                    STA     ERROR,,AUTO
         1 000161   000164 710000 1                  TRA     s:4140

      646     4138    1       ELSE
      647     4139    1           ERROR=ERR#IO#WRTC;
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:154  

   4139  1 000162   210721 235007                    LDA     70097,DL
         1 000163   200005 755100                    STA     ERROR,,AUTO

      648     4140    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   4140  1 000164   100102 236100                    LDQ     66,,PR1
         1 000165   000000 473400 xsym               LDP3    GLOBAL$
         1 000166   300007 756100                    STQ     7,,PR3

      649     4141    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   4141  1 000167   302610 720100                    LXL0    1416,,PR3
         1 000170   300014 740100                    STX0    12,,PR3

      650     4142    1       GLOBAL.CJRNL.DCB#=0;

   4142  1 000171   302610 450100                    STZ     1416,,PR3

      651     4143    1       GOTO ALT;

   4143  1 000172   000173 710000 1                  TRA     ALT

   4142  1 000173                       ALT          null
      652     4144    1   ALT: ;
      653     4145    1       GLOBAL.RET.ERROR#=ERROR;

   4145  1 000173   300006 755100                    STA     6,,PR3

      654     4146    1       CALL M$ERR;

   4146  1 000174   000002 713400                    CLIMB   err
         1 000175   000000 401760                    pmme    nvectors=0

      655     4147    1   END ZIM$JKSTO;

   4147  1 000176   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:155  

(unnamed)
 Sect OctLoc
   2     000   777777 600000                                                    ....
      656     4148        %EOD;

PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:156  
--  Include file information  --

   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JKSTO.

   Procedure ZIM$JKSTO requires 127 words for executable code.
   Procedure ZIM$JKSTO requires 8 words of local(AUTO) storage.
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:157  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:158  
          MINI XREF LISTING

ALT
      4142**LABEL    4135--GOTO     4143--GOTO
AWS.ATRIB.CJRNL
      1450**DCL      4105>>IF       4125>>IF
AWS.ATRIB.TJRNL
      1452**DCL      4105>>IF       4120>>IF
AWS.DDCB
      1471**DCL      4112>>ASSIGN
AWS$
      1445**DCL         6--PROC     1446--IMP-PTR  4101--ENTRY    4105>>IF       4105>>IF       4112>>ASSIGN
      4120>>IF       4125>>IF
B$ALT.CODE
      1753**DCL      1753--REDEF    1754--REDEF    1754--REDEF
B$ALT.ERR
      1754**DCL      4133>>ASSIGN   4140>>ASSIGN
B$ALT.ERR.ERR#
      1755**DCL      1755--REDEF    4136>>IF
B$ALT.EVID
      1754**DCL      1754--REDEF    1754--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3910**DCL      3910--REDEF
B$JIT.ERR.MID
      3817**DCL      3817--REDEF
B$JIT.JRESPEAK
      3978**DCL      3979--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      4087**DCL      4087--REDEF    4088--REDEF
B$JIT.PNR
      3991**DCL      3991--REDEF
B$JIT.TSLINE
      4085**DCL      4086--REDEF
B$JIT.USER
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:159  
      3816**DCL      4111>>ASSIGN
B$JIT$
      4095**DCL      3811--IMP-PTR  4111>>ASSIGN
B$TCB.ALT$
      1749**DCL      4133>>ASSIGN   4136>>IF       4140>>ASSIGN
B$TCB$
      4096**DCL      4133>>ASSIGN   4136>>IF       4140>>ASSIGN
BERC.DCB#
      1635**DCL      1636--REDEF
COM
      4103**LABEL    4100--GOTO
ERROR
      4092**DCL      4103<<ASSIGN   4132<<ASSIGN   4137<<ASSIGN   4139<<ASSIGN   4145>>ASSIGN
ER_WRTC
      4136**LABEL    4128--CALLALT
ER_WRTT
      4132**LABEL    4123--CALLALT
FPT$TIME
      1770**DCL      4107<>CALL
FPT$WRTJ
      1795**DCL      4123<>CALL     4128<>CALL
FPT$WRTJ.BUF_.BOUND
      1795**DCL      4119<<ASSIGN
FPT$WRTJ.STATION_
      1797**DCL      1797--REDEF
FPT$WRTJ.V.DCB#
      1798**DCL      4122<<ASSIGN   4127<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      1804**DCL      1804--REDEF
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF
GLOBAL.CJRNL.DCB#
       690**DCL      4127>>ASSIGN   4141>>ASSIGN   4142<<ASSIGN
GLOBAL.JRECORD
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:160  
       700**DCL      4108--ASSIGN
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.KEY.LENGTH
       706**DCL      4117>>ASSIGN
GLOBAL.KEY.VALUE
       707**DCL      4117>>ASSIGN
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.ROLL
       536**DCL      4104>>IF
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.RET.DCB#
       521**DCL      4134<<ASSIGN   4141<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      4145<<ASSIGN
GLOBAL.RET.SYSERR#
       516**DCL      4133<<ASSIGN   4140<<ASSIGN
GLOBAL.SKEY.LENGTH
       709**DCL      4114>>ASSIGN
GLOBAL.TIME.TSTAMP
       728**DCL      4110>>ASSIGN
GLOBAL.TIME$
       777**DCL      4107>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      4122>>ASSIGN   4134>>ASSIGN
GLOBAL.WRTJ$
       775**DCL      4118>>ASSIGN
GLOBAL$
       799**DCL       495--IMP-PTR  4104>>IF       4107>>CALL     4108>>ASSIGN   4110>>ASSIGN   4114>>ASSIGN
      4117>>ASSIGN   4117>>ASSIGN   4118>>ASSIGN   4122>>ASSIGN   4127>>ASSIGN   4133>>ASSIGN   4134>>ASSIGN
      4134>>ASSIGN   4140>>ASSIGN   4141>>ASSIGN   4141>>ASSIGN   4142>>ASSIGN   4145>>ASSIGN
JREC
PL6.E3A0      #005=ZIM$JKSTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:00 Page:161  
      1614**DCL      4119--ASSIGN
JREC.DCB#
      1618**DCL      4112<<ASSIGN
JREC.LENGTH
      1620**DCL      1623--IMP-SIZ  4114<<ASSIGN   4117>>ASSIGN   4119>>ASSIGN
JREC.LINE
      1621**DCL      4115<<ASSIGN
JREC.OFFSET
      1622**DCL      4116<<ASSIGN
JREC.PAGE
      1619**DCL      4113<<ASSIGN
JREC.TIME
      1615**DCL      4110<<ASSIGN
JREC.TYPE
      1616**DCL      4109<<ASSIGN
JREC.USER#
      1617**DCL      4111<<ASSIGN
JREC.VALUE
      1623**DCL      4117<<ASSIGN
JRNL$
      1593**DCL      1594--IMP-PTR  1614--IMP-PTR  1624--IMP-PTR  1631--IMP-PTR  1637--IMP-PTR  4108<<ASSIGN
      4109>>ASSIGN   4110>>ASSIGN   4111>>ASSIGN   4112>>ASSIGN   4113>>ASSIGN   4114>>ASSIGN   4115>>ASSIGN
      4116>>ASSIGN   4117>>ASSIGN   4117>>ASSIGN   4119>>ASSIGN   4119>>ASSIGN
M$ERR
      1688**DCL-ENT  4146--CALL
M$TIME
      1743**DCL-ENT  4107--CALL
M$WRITE
      1677**DCL-ENT  4123--CALL     4128--CALL
RET
      4131**LABEL    4104--GOTO
TYPE
      4093**DCL      4099<<ASSIGN   4102<<ASSIGN   4109>>ASSIGN
WRTJ$
      4094**DCL      1795--IMP-PTR  4118<<ASSIGN   4119>>ASSIGN   4122>>ASSIGN   4123>>CALL     4127>>ASSIGN
      4128>>CALL

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:162  
      657        1        /*T***********************************************************/
      658        2        /*T*                                                         */
      659        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      660        4        /*T*                                                         */
      661        5        /*T***********************************************************/
      662        6        ZIM$JSTO: PROC
      663        7               AVOID($PR5,$PR6,$PR7);
      664        8        %INCLUDE ZI$GLOBAL;
      665      494            %GLOBALS;
      666      802            %RECCW;
      667      807        %INCLUDE ZI$SSS;
      668     1356            %AC;
      669     1451        %INCLUDE ZI$DBCB;
      670     2093            %DBCB;
      671     2571            %RECVAR(STCLASS="BASED(RECVAR$)");
      672     2605            %AWS;
      673     2645        %INCLUDE ZI$JRNL;
      674     2753            %JRNL_REC(STCLASS=AUTO);
      675     2828        %INCLUDE CP_6;
      676     2909            %B$TCB;
      677     2912            %B$ALT;
      678     2920            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      679     2951            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      680     2970        %INCLUDE CP_6_SUBS;
      681     3510        %INCLUDE B$JIT;
      682     3800        %INCLUDE ZI_ERRORS_C;
      683     4126        %INCLUDE B_ERRORS_C;
      684     5253    1   DCL RECVAR$ PTR;
      685     5254    1   DCL WRTJ$ PTR;
      686     5255    1   DCL B$JIT$ PTR SYMREF;
      687     5256    1   DCL B$TCB$ PTR SYMREF;
      688     5257    1   DCL ERROR UBIN(36);
      689     5258    1   DCL LENGTH UBIN(36);
      690     5259    1   DCL RECORD BASED CHAR(LENGTH);
      691     5260    1   DCL TYPE UBIN(36);
      692     5261    1       TYPE=T#STO;
      693     5262    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:163  
      694     5263    1       GOTO COM;
      695     5264    1   ZIM$JDEL: ENTRY;
      696     5265    1       TYPE=T#DEL;
      697     5266    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVI);
      698     5267    1       GOTO COM;
      699     5268    1   ZIM$JMOD: ENTRY;
      700     5269    1       TYPE=T#MOD;
      701     5270    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);
      702     5271    1   COM: ERROR=0;
      703     5272    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
      704     5273    1       SSS$=GLOBAL.ACTIVE.SSS$;
      705     5274    1       AWS$=RECVAR.AWS$;
      706     5275    1       IF ~GLOBAL.PENDING.ROLL AND
      707     5276    1          (AWS.ATRIB.TJRNL OR AWS.ATRIB.CJRNL) THEN
      708     5277    2       DO;
      709     5278    2           JRNL$=ADDR(GLOBAL.JRECORD);
      710     5279    2           WRTJ$=GLOBAL.WRTJ$;
      711     5280    2           AC$=PINCRW(SSS$,RECVAR.ACPTR);
      712     5281    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      713     5282    2           JREC.TYPE=TYPE;
      714     5283    2           JREC.TIME=GLOBAL.TIME.TSTAMP;
      715     5284    2           JREC.USER#=B$JIT$->B$JIT.USER;
      716     5285    2           JREC.DCB#=AWS.DDCB;
      717     5286    2           JREC.PAGE=(RECVAR.DBKEY-AC.DBLIM.LOWDBK)/AC.LPP+1;
      718     5287    2           JREC.LINE=MOD(RECVAR.DBKEY-AC.DBLIM.LOWDBK,AC.LPP);
      719     5288    2           JREC.OFFSET=POFFC(RECVAR.RADDR$,RECVAR.BADDR$);
      720     5289    2           IF TYPE=T#STO THEN
      721     5290    3           DO;
      722     5291    3               IF AWS.ATRIB.TJRNL THEN
      723     5292    4               DO;
      724     5293    4                   JREC.LENGTH=4; /* Just control word */
      725     5294    4                   LENGTH=4;
      726     5295    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
      727     5296    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      728     5297    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      729     5298    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      730     5299    4                   END;
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:164  
      731     5300    3               IF AWS.ATRIB.CJRNL THEN
      732     5301    4               DO;
      733     5302    4                   JREC.LENGTH=RECVAR.RECSZ;
      734     5303    4                   LENGTH=JREC.LENGTH;
      735     5304    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
      736     5305    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      737     5306    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      738     5307    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      739     5308    4                   END;
      740     5309    3               END;
      741     5310    2           IF TYPE=T#DEL THEN
      742     5311    3           DO;
      743     5312    3               IF AWS.ATRIB.TJRNL THEN
      744     5313    4               DO;
      745     5314    4                   JREC.LENGTH=RECVAR.RECSZ;
      746     5315    4                   LENGTH=JREC.LENGTH;
      747     5316    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
      748     5317    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      749     5318    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      750     5319    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      751     5320    4                   END;
      752     5321    3               IF AWS.ATRIB.CJRNL THEN
      753     5322    4               DO;
      754     5323    4                   JREC.LENGTH=4;
      755     5324    4                   LENGTH=4;
      756     5325    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
      757     5326    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      758     5327    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      759     5328    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      760     5329    4                   END;
      761     5330    3               END;
      762     5331    2           IF TYPE=T#MOD THEN
      763     5332    3           DO;
      764     5333    3               IF AWS.ATRIB.TJRNL THEN
      765     5334    4               DO;
      766     5335    4                   JREC.LENGTH=RECVAR.RADDR$->RECCW.SIZE;
      767     5336    4                   LENGTH=JREC.LENGTH;
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:165  
      768     5337    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
      769     5338    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      770     5339    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      771     5340    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      772     5341    4                   END;
      773     5342    3               IF AWS.ATRIB.CJRNL THEN
      774     5343    4               DO;
      775     5344    4                   JREC.LENGTH=DBCB.CSECT.TBUF$->RECCW.SIZE;
      776     5345    4                   LENGTH=JREC.LENGTH;
      777     5346    4                   JREC.VALUE=DBCB.CSECT.TBUF$->RECORD;
      778     5347    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      779     5348    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      780     5349    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
      781     5350    4                   END;
      782     5351    3               END;
      783     5352    2           END;
      784     5353    1       RETURN;
      785     5354    1   ER_WRTT: ERROR=ERR#IO#WRTT;
      786     5355    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      787     5356    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
      788     5357    1       GOTO ALT;
      789     5358    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
      790     5359    1           ERROR=ERR#IO#NOOWNER;
      791     5360    1       ELSE
      792     5361    1           ERROR=ERR#IO#WRTC;
      793     5362    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      794     5363    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
      795     5364    1       GLOBAL.CJRNL.DCB#=0;
      796     5365    1       GOTO ALT;
      797     5366    1   ALT: ;
      798     5367    1       GLOBAL.RET.ERROR#=ERROR;
      799     5368    1       CALL M$ERR;
      800     5369    1   END ZIM$JSTO;
      801     5370        %EOD;

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:166  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JSTO.

   Procedure ZIM$JSTO requires 367 words for executable code.
   Procedure ZIM$JSTO requires 16 words of local(AUTO) storage.

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:167  

 Object Unit name= ZIM$JSTO                                   File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:00:45.32 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   367    557  ZIM$JSTO
    2  RoData even  none     1      1  ZIM$JSTO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       0  ZIM$JSTO
     1     12                  yes      XStd       0  ZIM$JDEL
     1     24                  yes      XStd       0  ZIM$JMOD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:168  


      657        1        /*T***********************************************************/
      658        2        /*T*                                                         */
      659        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      660        4        /*T*                                                         */
      661        5        /*T***********************************************************/
      662        6        ZIM$JSTO: PROC

      6  1 000000   000000 700200 xent  ZIM$JSTO     TSX0  ! X66_AUTO_0
         1 000001   000020 000000                    ZERO    16,0

      663        7               AVOID($PR5,$PR6,$PR7);
      664        8        %INCLUDE ZI$GLOBAL;
      665      494            %GLOBALS;
      666      802            %RECCW;
      667      807        %INCLUDE ZI$SSS;
      668     1356            %AC;
      669     1451        %INCLUDE ZI$DBCB;
      670     2093            %DBCB;
      671     2571            %RECVAR(STCLASS="BASED(RECVAR$)");
      672     2605            %AWS;
      673     2645        %INCLUDE ZI$JRNL;
      674     2753            %JRNL_REC(STCLASS=AUTO);
      675     2828        %INCLUDE CP_6;
      676     2909            %B$TCB;
      677     2912            %B$ALT;
      678     2920            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      679     2951            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      680     2970        %INCLUDE CP_6_SUBS;
      681     3510        %INCLUDE B$JIT;
      682     3800        %INCLUDE ZI_ERRORS_C;
      683     4126        %INCLUDE B_ERRORS_C;
      684     5253    1   DCL RECVAR$ PTR;
      685     5254    1   DCL WRTJ$ PTR;
      686     5255    1   DCL B$JIT$ PTR SYMREF;
      687     5256    1   DCL B$TCB$ PTR SYMREF;
      688     5257    1   DCL ERROR UBIN(36);
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:169  
      689     5258    1   DCL LENGTH UBIN(36);
      690     5259    1   DCL RECORD BASED CHAR(LENGTH);
      691     5260    1   DCL TYPE UBIN(36);
      692     5261    1       TYPE=T#STO;

   5261  1 000002   000006 235007                    LDA     6,DL
         1 000003   200014 755100                    STA     TYPE,,AUTO

      693     5262    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);

   5262  1 000004   000000 470400 xsym               LDP0    GLOBAL$
         1 000005   000001 471500                    LDP1    1,,PR0
         1 000006   100512 220100                    LDX0    330,,PR1
         1 000007   100000 633510                    EPPR3   0,X0,PR1
         1 000010   200010 453500                    STP3    RECVAR$,,AUTO

      694     5263    1       GOTO COM;

   5263  1 000011   000035 710000 1                  TRA     COM

      695     5264    1   ZIM$JDEL: ENTRY;

   5264  1 000012   000000 700200 xent  ZIM$JDEL     TSX0  ! X66_AUTO_0
         1 000013   000020 000000                    ZERO    16,0

      696     5265    1       TYPE=T#DEL;

   5265  1 000014   000007 235007                    LDA     7,DL
         1 000015   200014 755100                    STA     TYPE,,AUTO

      697     5266    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVI);

   5266  1 000016   000000 470400 xsym               LDP0    GLOBAL$
         1 000017   000001 471500                    LDP1    1,,PR0
         1 000020   100510 220100                    LDX0    328,,PR1
         1 000021   100000 633510                    EPPR3   0,X0,PR1
         1 000022   200010 453500                    STP3    RECVAR$,,AUTO
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:170  

      698     5267    1       GOTO COM;

   5267  1 000023   000035 710000 1                  TRA     COM

      699     5268    1   ZIM$JMOD: ENTRY;

   5268  1 000024   000000 700200 xent  ZIM$JMOD     TSX0  ! X66_AUTO_0
         1 000025   000020 000000                    ZERO    16,0

      700     5269    1       TYPE=T#MOD;

   5269  1 000026   000010 235007                    LDA     8,DL
         1 000027   200014 755100                    STA     TYPE,,AUTO

      701     5270    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);

   5270  1 000030   000000 470400 xsym               LDP0    GLOBAL$
         1 000031   000001 471500                    LDP1    1,,PR0
         1 000032   100512 220100                    LDX0    330,,PR1
         1 000033   100000 633510                    EPPR3   0,X0,PR1
         1 000034   200010 453500                    STP3    RECVAR$,,AUTO

      702     5271    1   COM: ERROR=0;

   5271  1 000035   200012 450100       COM          STZ     ERROR,,AUTO

      703     5272    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   5272  1 000036   000001 236100                    LDQ     1,,PR0
         1 000037   200005 756100                    STQ     DBCB$,,AUTO

      704     5273    1       SSS$=GLOBAL.ACTIVE.SSS$;

   5273  1 000040   000000 236100                    LDQ     0,,PR0
         1 000041   200003 756100                    STQ     SSS$,,AUTO

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:171  
      705     5274    1       AWS$=RECVAR.AWS$;

   5274  1 000042   300013 236100                    LDQ     11,,PR3
         1 000043   200006 756100                    STQ     AWS$,,AUTO

      706     5275    1       IF ~GLOBAL.PENDING.ROLL AND

   5275  1 000044   000017 236100                    LDQ     15,,PR0
         1 000045   000010 736000                    QLS     8
         1 000046   400000 376003                    ANQ     -131072,DU
         1 000047   400000 676003                    ERQ     -131072,DU
         1 000050   000516 600000 1                  TZE     s:5353
         1 000051   200006 474500                    LDP4    AWS$,,AUTO
         1 000052   400000 236100                    LDQ     0,,PR4
         1 000053   020000 316003                    CANQ    8192,DU
         1 000054   000057 601000 1                  TNZ     s:5278
         1 000055   100000 316003                    CANQ    32768,DU
         1 000056   000516 600000 1                  TZE     s:5353

      707     5276    1          (AWS.ATRIB.TJRNL OR AWS.ATRIB.CJRNL) THEN
      708     5277    2       DO;

      709     5278    2           JRNL$=ADDR(GLOBAL.JRECORD);

   5278  1 000057   000000 236000 xsym               LDQ     GLOBAL$
         1 000060   002622 036003                    ADLQ    1426,DU
         1 000061   200007 756100                    STQ     JRNL$,,AUTO

      710     5279    2           WRTJ$=GLOBAL.WRTJ$;

   5279  1 000062   005115 236100                    LDQ     2637,,PR0
         1 000063   200011 756100                    STQ     WRTJ$,,AUTO

      711     5280    2           AC$=PINCRW(SSS$,RECVAR.ACPTR);

   5280  1 000064   300005 220100                    LDX0    5,,PR3
         1 000065   000000 636010                    EAQ     0,X0
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:172  
         1 000066   200003 036100                    ADLQ    SSS$,,AUTO
         1 000067   200004 756100                    STQ     AC$,,AUTO

      712     5281    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   5281  1 000070   005117 471500                    LDP1    2639,,PR0
         1 000071   100000 630500                    EPPR0   0,,PR1
         1 000072   020004 713400                    CLIMB   8196
         1 000073   402000 401760                    pmme    nvectors=5

      713     5282    2           JREC.TYPE=TYPE;

   5282  1 000074   200007 470500                    LDP0    JRNL$,,AUTO
         1 000075   200014 236100                    LDQ     TYPE,,AUTO
         1 000076   000033 736000                    QLS     27
         1 000077   000001 552140                    STBQ    1,'40'O,PR0

      714     5283    2           JREC.TIME=GLOBAL.TIME.TSTAMP;

   5283  1 000100   000000 471400 xsym               LDP1    GLOBAL$
         1 000101   105001 235100                    LDA     2561,,PR1
         1 000102   000000 755100                    STA     0,,PR0

      715     5284    2           JREC.USER#=B$JIT$->B$JIT.USER;

   5284  1 000103   000000 473400 xsym               LDP3    B$JIT$
         1 000104   300000 236100                    LDQ     0,,PR3
         1 000105   000001 552120                    STBQ    1,'20'O,PR0

      716     5285    2           JREC.DCB#=AWS.DDCB;

   5285  1 000106   200006 474500                    LDP4    AWS$,,AUTO
         1 000107   400006 220100                    LDX0    6,,PR4
         1 000110   000001 440100                    SXL0    1,,PR0

      717     5286    2           JREC.PAGE=(RECVAR.DBKEY-AC.DBLIM.LOWDBK)/AC.LPP+1;

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:173  
   5286  1 000111   200004 470500                    LDP0    AC$,,AUTO
         1 000112   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000113   100000 236100                    LDQ     0,,PR1
         1 000114   000010 136100                    SBLQ    8,,PR0
         1 000115   200016 756100                    STQ     TYPE+2,,AUTO
         1 000116   000012 236100                    LDQ     10,,PR0
         1 000117   777777 376007                    ANQ     -1,DL
         1 000120   200017 756100                    STQ     TYPE+3,,AUTO
         1 000121   200016 236100                    LDQ     TYPE+2,,AUTO
         1 000122   200017 506100                    DIV     TYPE+3,,AUTO
         1 000123   000001 036007                    ADLQ    1,DL
         1 000124   200007 470500                    LDP0    JRNL$,,AUTO
         1 000125   000002 756100                    STQ     2,,PR0

      718     5287    2           JREC.LINE=MOD(RECVAR.DBKEY-AC.DBLIM.LOWDBK,AC.LPP);

   5287  1 000126   200004 470500                    LDP0    AC$,,AUTO
         1 000127   100000 236100                    LDQ     0,,PR1
         1 000130   000010 136100                    SBLQ    8,,PR0
         1 000131   200016 756100                    STQ     TYPE+2,,AUTO
         1 000132   000012 236100                    LDQ     10,,PR0
         1 000133   777777 376007                    ANQ     -1,DL
         1 000134   200017 756100                    STQ     TYPE+3,,AUTO
         1 000135   200016 236100                    LDQ     TYPE+2,,AUTO
         1 000136   200017 506100                    DIV     TYPE+3,,AUTO
         1 000137   000000 620005                    EAX0    0,AL
         1 000140   200007 470500                    LDP0    JRNL$,,AUTO
         1 000141   000003 440100                    SXL0    3,,PR0

      719     5288    2           JREC.OFFSET=POFFC(RECVAR.RADDR$,RECVAR.BADDR$);

   5288  1 000142   100001 236100                    LDQ     1,,PR1
         1 000143   000020 772000                    QRL     16
         1 000144   200016 756100                    STQ     TYPE+2,,AUTO
         1 000145   100002 236100                    LDQ     2,,PR1
         1 000146   000020 772000                    QRL     16
         1 000147   200016 136100                    SBLQ    TYPE+2,,AUTO
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:174  
         1 000150   000000 620006                    EAX0    0,QL
         1 000151   000004 740100                    STX0    4,,PR0

      720     5289    2           IF TYPE=T#STO THEN

   5289  1 000152   200014 235100                    LDA     TYPE,,AUTO
         1 000153   000006 115007                    CMPA    6,DL
         1 000154   000263 601000 1                  TNZ     s:5310

      721     5290    3           DO;

      722     5291    3               IF AWS.ATRIB.TJRNL THEN

   5291  1 000155   400000 236100                    LDQ     0,,PR4
         1 000156   020000 316003                    CANQ    8192,DU
         1 000157   000217 600000 1                  TZE     s:5300

      723     5292    4               DO;

      724     5293    4                   JREC.LENGTH=4; /* Just control word */

   5293  1 000160   000004 221003                    LDX1    4,DU
         1 000161   000003 741100                    STX1    3,,PR0

      725     5294    4                   LENGTH=4;

   5294  1 000162   000004 236007                    LDQ     4,DL
         1 000163   200013 756100                    STQ     LENGTH,,AUTO

      726     5295    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5295  1 000164   100002 470500                    LDP0    2,,PR1
         1 000165   000000 620006                    EAX0    0,QL
         1 000166   200007 471500                    LDP1    JRNL$,,AUTO
         1 000167   040140 100540                    MLR     fill='040'O
         1 000170   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 000171   100004 400011                    ADSC9   4,,PR1                   cn=2,n=*X1
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:175  

      727     5296    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5296  1 000172   100003 220100                    LDX0    3,,PR1
         1 000173   000022 622010                    EAX2    18,X0
         1 000174   000000 636012                    EAQ     0,X2
         1 000175   000022 772000                    QRL     18
         1 000176   000011 402007                    MPY     9,DL
         1 000177   000043 036007                    ADLQ    35,DL
         1 000200   000044 506007                    DIV     36,DL
         1 000201   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000202   000002 736000                    QLS     2
         1 000203   000001 136007                    SBLQ    1,DL
         1 000204   000020 736000                    QLS     16
         1 000205   000004 676100                    ERQ     4,,PR0
         1 000206   000000 376000 2                  ANQ     0
         1 000207   000004 656100                    ERSQ    4,,PR0

      728     5297    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5297  1 000210   000000 470400 xsym               LDP0    GLOBAL$
         1 000211   002604 720100                    LXL0    1412,,PR0
         1 000212   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000213   000010 740100                    STX0    8,,PR0

      729     5298    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5298  1 000214   440001 713400                    CLIMB   alt,write
         1 000215   401400 401760                    pmme    nvectors=4
         1 000216   000517 702000 1                  TSX2    ER_WRTT

      730     5299    4                   END;

      731     5300    3               IF AWS.ATRIB.CJRNL THEN

   5300  1 000217   200006 470500                    LDP0    AWS$,,AUTO
         1 000220   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:176  
         1 000221   100000 316003                    CANQ    32768,DU
         1 000222   000263 600000 1                  TZE     s:5310

      732     5301    4               DO;

      733     5302    4                   JREC.LENGTH=RECVAR.RECSZ;

   5302  1 000223   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000224   100003 220100                    LDX0    3,,PR1
         1 000225   200007 473500                    LDP3    JRNL$,,AUTO
         1 000226   300003 740100                    STX0    3,,PR3

      734     5303    4                   LENGTH=JREC.LENGTH;

   5303  1 000227   300003 236100                    LDQ     3,,PR3
         1 000230   000022 772000                    QRL     18
         1 000231   200013 756100                    STQ     LENGTH,,AUTO

      735     5304    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5304  1 000232   100002 474500                    LDP4    2,,PR1
         1 000233   000000 621006                    EAX1    0,QL
         1 000234   040140 100540                    MLR     fill='040'O
         1 000235   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         1 000236   300004 400010                    ADSC9   4,,PR3                   cn=2,n=*X0

      736     5305    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5305  1 000237   000022 621010                    EAX1    18,X0
         1 000240   000000 636011                    EAQ     0,X1
         1 000241   000022 772000                    QRL     18
         1 000242   000011 402007                    MPY     9,DL
         1 000243   000043 036007                    ADLQ    35,DL
         1 000244   000044 506007                    DIV     36,DL
         1 000245   200011 474500                    LDP4    WRTJ$,,AUTO
         1 000246   000002 736000                    QLS     2
         1 000247   000001 136007                    SBLQ    1,DL
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:177  
         1 000250   000020 736000                    QLS     16
         1 000251   400004 676100                    ERQ     4,,PR4
         1 000252   000000 376000 2                  ANQ     0
         1 000253   400004 656100                    ERSQ    4,,PR4

      737     5306    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5306  1 000254   000000 470400 xsym               LDP0    GLOBAL$
         1 000255   002610 720100                    LXL0    1416,,PR0
         1 000256   400010 740100                    STX0    8,,PR4

      738     5307    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   5307  1 000257   400000 630500                    EPPR0   0,,PR4
         1 000260   440001 713400                    CLIMB   alt,write
         1 000261   401400 401760                    pmme    nvectors=4
         1 000262   000531 702000 1                  TSX2    ER_WRTC

      739     5308    4                   END;

      740     5309    3               END;

      741     5310    2           IF TYPE=T#DEL THEN

   5310  1 000263   200014 235100                    LDA     TYPE,,AUTO
         1 000264   000007 115007                    CMPA    7,DL
         1 000265   000375 601000 1                  TNZ     s:5331

      742     5311    3           DO;

      743     5312    3               IF AWS.ATRIB.TJRNL THEN

   5312  1 000266   200006 470500                    LDP0    AWS$,,AUTO
         1 000267   000000 236100                    LDQ     0,,PR0
         1 000270   020000 316003                    CANQ    8192,DU
         1 000271   000332 600000 1                  TZE     s:5321

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:178  
      744     5313    4               DO;

      745     5314    4                   JREC.LENGTH=RECVAR.RECSZ;

   5314  1 000272   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000273   100003 220100                    LDX0    3,,PR1
         1 000274   200007 473500                    LDP3    JRNL$,,AUTO
         1 000275   300003 740100                    STX0    3,,PR3

      746     5315    4                   LENGTH=JREC.LENGTH;

   5315  1 000276   300003 236100                    LDQ     3,,PR3
         1 000277   000022 772000                    QRL     18
         1 000300   200013 756100                    STQ     LENGTH,,AUTO

      747     5316    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5316  1 000301   100002 474500                    LDP4    2,,PR1
         1 000302   000000 621006                    EAX1    0,QL
         1 000303   040140 100540                    MLR     fill='040'O
         1 000304   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         1 000305   300004 400010                    ADSC9   4,,PR3                   cn=2,n=*X0

      748     5317    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5317  1 000306   000022 621010                    EAX1    18,X0
         1 000307   000000 636011                    EAQ     0,X1
         1 000310   000022 772000                    QRL     18
         1 000311   000011 402007                    MPY     9,DL
         1 000312   000043 036007                    ADLQ    35,DL
         1 000313   000044 506007                    DIV     36,DL
         1 000314   200011 474500                    LDP4    WRTJ$,,AUTO
         1 000315   000002 736000                    QLS     2
         1 000316   000001 136007                    SBLQ    1,DL
         1 000317   000020 736000                    QLS     16
         1 000320   400004 676100                    ERQ     4,,PR4
         1 000321   000000 376000 2                  ANQ     0
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:179  
         1 000322   400004 656100                    ERSQ    4,,PR4

      749     5318    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5318  1 000323   000000 470400 xsym               LDP0    GLOBAL$
         1 000324   002604 720100                    LXL0    1412,,PR0
         1 000325   400010 740100                    STX0    8,,PR4

      750     5319    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5319  1 000326   400000 630500                    EPPR0   0,,PR4
         1 000327   440001 713400                    CLIMB   alt,write
         1 000330   401400 401760                    pmme    nvectors=4
         1 000331   000517 702000 1                  TSX2    ER_WRTT

      751     5320    4                   END;

      752     5321    3               IF AWS.ATRIB.CJRNL THEN

   5321  1 000332   200006 470500                    LDP0    AWS$,,AUTO
         1 000333   000000 236100                    LDQ     0,,PR0
         1 000334   100000 316003                    CANQ    32768,DU
         1 000335   000375 600000 1                  TZE     s:5331

      753     5322    4               DO;

      754     5323    4                   JREC.LENGTH=4;

   5323  1 000336   000004 220003                    LDX0    4,DU
         1 000337   200007 471500                    LDP1    JRNL$,,AUTO
         1 000340   100003 740100                    STX0    3,,PR1

      755     5324    4                   LENGTH=4;

   5324  1 000341   000004 235007                    LDA     4,DL
         1 000342   200013 755100                    STA     LENGTH,,AUTO

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:180  
      756     5325    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5325  1 000343   200010 473500                    LDP3    RECVAR$,,AUTO
         1 000344   300002 474500                    LDP4    2,,PR3
         1 000345   000000 621005                    EAX1    0,AL
         1 000346   040140 100540                    MLR     fill='040'O
         1 000347   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         1 000350   100004 400010                    ADSC9   4,,PR1                   cn=2,n=*X0

      757     5326    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5326  1 000351   000022 621010                    EAX1    18,X0
         1 000352   000000 636011                    EAQ     0,X1
         1 000353   000022 772000                    QRL     18
         1 000354   000011 402007                    MPY     9,DL
         1 000355   000043 036007                    ADLQ    35,DL
         1 000356   000044 506007                    DIV     36,DL
         1 000357   200011 474500                    LDP4    WRTJ$,,AUTO
         1 000360   000002 736000                    QLS     2
         1 000361   000001 136007                    SBLQ    1,DL
         1 000362   000020 736000                    QLS     16
         1 000363   400004 676100                    ERQ     4,,PR4
         1 000364   000000 376000 2                  ANQ     0
         1 000365   400004 656100                    ERSQ    4,,PR4

      758     5327    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5327  1 000366   000000 470400 xsym               LDP0    GLOBAL$
         1 000367   002610 722100                    LXL2    1416,,PR0
         1 000370   400010 742100                    STX2    8,,PR4

      759     5328    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   5328  1 000371   400000 630500                    EPPR0   0,,PR4
         1 000372   440001 713400                    CLIMB   alt,write
         1 000373   401400 401760                    pmme    nvectors=4
         1 000374   000531 702000 1                  TSX2    ER_WRTC
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:181  

      760     5329    4                   END;

      761     5330    3               END;

      762     5331    2           IF TYPE=T#MOD THEN

   5331  1 000375   200014 235100                    LDA     TYPE,,AUTO
         1 000376   000010 115007                    CMPA    8,DL
         1 000377   000516 601000 1                  TNZ     s:5353

      763     5332    3           DO;

      764     5333    3               IF AWS.ATRIB.TJRNL THEN

   5333  1 000400   200006 470500                    LDP0    AWS$,,AUTO
         1 000401   000000 236100                    LDQ     0,,PR0
         1 000402   020000 316003                    CANQ    8192,DU
         1 000403   000447 600000 1                  TZE     s:5342

      765     5334    4               DO;

      766     5335    4                   JREC.LENGTH=RECVAR.RADDR$->RECCW.SIZE;

   5335  1 000404   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000405   100002 473500                    LDP3    2,,PR1
         1 000406   200007 474500                    LDP4    JRNL$,,AUTO
         1 000407   003100 060500                    CSL     bolr='003'O
         1 000410   300000 400022                    BDSC    0,,PR3                   by=2,bit=0,n=18
         1 000411   400003 000022                    BDSC    3,,PR4                   by=0,bit=0,n=18

      767     5336    4                   LENGTH=JREC.LENGTH;

   5336  1 000412   400003 236100                    LDQ     3,,PR4
         1 000413   000022 772000                    QRL     18
         1 000414   200013 756100                    STQ     LENGTH,,AUTO

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:182  
      768     5337    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5337  1 000415   400003 220100                    LDX0    3,,PR4
         1 000416   100002 473500                    LDP3    2,,PR1
         1 000417   000000 621006                    EAX1    0,QL
         1 000420   040140 100540                    MLR     fill='040'O
         1 000421   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         1 000422   400004 400010                    ADSC9   4,,PR4                   cn=2,n=*X0

      769     5338    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5338  1 000423   000022 621010                    EAX1    18,X0
         1 000424   000000 636011                    EAQ     0,X1
         1 000425   000022 772000                    QRL     18
         1 000426   000011 402007                    MPY     9,DL
         1 000427   000043 036007                    ADLQ    35,DL
         1 000430   000044 506007                    DIV     36,DL
         1 000431   200011 473500                    LDP3    WRTJ$,,AUTO
         1 000432   000002 736000                    QLS     2
         1 000433   000001 136007                    SBLQ    1,DL
         1 000434   000020 736000                    QLS     16
         1 000435   300004 676100                    ERQ     4,,PR3
         1 000436   000000 376000 2                  ANQ     0
         1 000437   300004 656100                    ERSQ    4,,PR3

      770     5339    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5339  1 000440   000000 470400 xsym               LDP0    GLOBAL$
         1 000441   002604 720100                    LXL0    1412,,PR0
         1 000442   300010 740100                    STX0    8,,PR3

      771     5340    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5340  1 000443   300000 630500                    EPPR0   0,,PR3
         1 000444   440001 713400                    CLIMB   alt,write
         1 000445   401400 401760                    pmme    nvectors=4
         1 000446   000517 702000 1                  TSX2    ER_WRTT
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:183  

      772     5341    4                   END;

      773     5342    3               IF AWS.ATRIB.CJRNL THEN

   5342  1 000447   200006 470500                    LDP0    AWS$,,AUTO
         1 000450   000000 236100                    LDQ     0,,PR0
         1 000451   100000 316003                    CANQ    32768,DU
         1 000452   000516 600000 1                  TZE     s:5353

      774     5343    4               DO;

      775     5344    4                   JREC.LENGTH=DBCB.CSECT.TBUF$->RECCW.SIZE;

   5344  1 000453   200005 471500                    LDP1    DBCB$,,AUTO
         1 000454   100004 473500                    LDP3    4,,PR1
         1 000455   200007 474500                    LDP4    JRNL$,,AUTO
         1 000456   003100 060500                    CSL     bolr='003'O
         1 000457   300000 400022                    BDSC    0,,PR3                   by=2,bit=0,n=18
         1 000460   400003 000022                    BDSC    3,,PR4                   by=0,bit=0,n=18

      776     5345    4                   LENGTH=JREC.LENGTH;

   5345  1 000461   400003 236100                    LDQ     3,,PR4
         1 000462   000022 772000                    QRL     18
         1 000463   200013 756100                    STQ     LENGTH,,AUTO

      777     5346    4                   JREC.VALUE=DBCB.CSECT.TBUF$->RECORD;

   5346  1 000464   400003 220100                    LDX0    3,,PR4
         1 000465   100004 473500                    LDP3    4,,PR1
         1 000466   000000 621006                    EAX1    0,QL
         1 000467   040140 100540                    MLR     fill='040'O
         1 000470   300000 000011                    ADSC9   0,,PR3                   cn=0,n=*X1
         1 000471   400004 400010                    ADSC9   4,,PR4                   cn=2,n=*X0

      778     5347    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:184  

   5347  1 000472   000022 621010                    EAX1    18,X0
         1 000473   000000 636011                    EAQ     0,X1
         1 000474   000022 772000                    QRL     18
         1 000475   000011 402007                    MPY     9,DL
         1 000476   000043 036007                    ADLQ    35,DL
         1 000477   000044 506007                    DIV     36,DL
         1 000500   200011 473500                    LDP3    WRTJ$,,AUTO
         1 000501   000002 736000                    QLS     2
         1 000502   000001 136007                    SBLQ    1,DL
         1 000503   000020 736000                    QLS     16
         1 000504   300004 676100                    ERQ     4,,PR3
         1 000505   000000 376000 2                  ANQ     0
         1 000506   300004 656100                    ERSQ    4,,PR3

      779     5348    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5348  1 000507   000000 470400 xsym               LDP0    GLOBAL$
         1 000510   002610 720100                    LXL0    1416,,PR0
         1 000511   300010 740100                    STX0    8,,PR3

      780     5349    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   5349  1 000512   300000 630500                    EPPR0   0,,PR3
         1 000513   440001 713400                    CLIMB   alt,write
         1 000514   401400 401760                    pmme    nvectors=4
         1 000515   000531 702000 1                  TSX2    ER_WRTC

      781     5350    4                   END;

      782     5351    3               END;

      783     5352    2           END;

      784     5353    1       RETURN;

   5353  1 000516   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:185  

      785     5354    1   ER_WRTT: ERROR=ERR#IO#WRTT;

   5354  1 000517   210720 235007       ER_WRTT      LDA     70096,DL
         1 000520   200012 755100                    STA     ERROR,,AUTO

      786     5355    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5355  1 000521   000000 470400 xsym               LDP0    B$TCB$
         1 000522   000000 471500                    LDP1    0,,PR0
         1 000523   100102 236100                    LDQ     66,,PR1
         1 000524   000000 473400 xsym               LDP3    GLOBAL$
         1 000525   300007 756100                    STQ     7,,PR3

      787     5356    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

   5356  1 000526   302604 720100                    LXL0    1412,,PR3
         1 000527   300014 740100                    STX0    12,,PR3

      788     5357    1       GOTO ALT;

   5357  1 000530   000553 710000 1                  TRA     ALT

      789     5358    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   5358  1 000531   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         1 000532   000000 471500                    LDP1    0,,PR0
         1 000533   100102 236100                    LDQ     66,,PR1
         1 000534   377770 376007                    ANQ     131064,DL
         1 000535   001160 116007                    CMPQ    624,DL
         1 000536   000542 601000 1                  TNZ     s:5361

      790     5359    1           ERROR=ERR#IO#NOOWNER;

   5359  1 000537   210762 235007                    LDA     70130,DL
         1 000540   200012 755100                    STA     ERROR,,AUTO
         1 000541   000544 710000 1                  TRA     s:5362
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:186  

      791     5360    1       ELSE
      792     5361    1           ERROR=ERR#IO#WRTC;

   5361  1 000542   210721 235007                    LDA     70097,DL
         1 000543   200012 755100                    STA     ERROR,,AUTO

      793     5362    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5362  1 000544   100102 236100                    LDQ     66,,PR1
         1 000545   000000 473400 xsym               LDP3    GLOBAL$
         1 000546   300007 756100                    STQ     7,,PR3

      794     5363    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   5363  1 000547   302610 720100                    LXL0    1416,,PR3
         1 000550   300014 740100                    STX0    12,,PR3

      795     5364    1       GLOBAL.CJRNL.DCB#=0;

   5364  1 000551   302610 450100                    STZ     1416,,PR3

      796     5365    1       GOTO ALT;

   5365  1 000552   000553 710000 1                  TRA     ALT

   5364  1 000553                       ALT          null
      797     5366    1   ALT: ;
      798     5367    1       GLOBAL.RET.ERROR#=ERROR;

   5367  1 000553   300006 755100                    STA     6,,PR3

      799     5368    1       CALL M$ERR;

   5368  1 000554   000002 713400                    CLIMB   err
         1 000555   000000 401760                    pmme    nvectors=0

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:187  
      800     5369    1   END ZIM$JSTO;

   5369  1 000556   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   777777 600000                                                    ....
      801     5370        %EOD;

PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:188  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JSTO.

   Procedure ZIM$JSTO requires 367 words for executable code.
   Procedure ZIM$JSTO requires 16 words of local(AUTO) storage.
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:189  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:190  
          MINI XREF LISTING

AC.DBLIM.LOWDBK
      1397**DCL      5286>>ASSIGN   5287>>ASSIGN
AC.DEF.ANL
      1376**DCL      1447--IMP-SIZ
AC.DEF.FORG
      1363**DCL      1367--REDEF
AC.LPP
      1400**DCL      5286>>ASSIGN   5287>>ASSIGN
AC$
      1359**DCL      1360--IMP-PTR  5280<<ASSIGN   5286>>ASSIGN   5286>>ASSIGN   5287>>ASSIGN   5287>>ASSIGN
ALT
      5364**LABEL    5357--GOTO     5365--GOTO
AWS.ATRIB.CJRNL
      2611**DCL      5275>>IF       5300>>IF       5321>>IF       5342>>IF
AWS.ATRIB.TJRNL
      2613**DCL      5275>>IF       5291>>IF       5312>>IF       5333>>IF
AWS.DDCB
      2632**DCL      5285>>ASSIGN
AWS$
      2606**DCL      2607--IMP-PTR  5274<<ASSIGN   5275>>IF       5275>>IF       5285>>ASSIGN   5291>>IF
      5300>>IF       5312>>IF       5321>>IF       5333>>IF       5342>>IF
B$ALT.CODE
      2914**DCL      2914--REDEF    2915--REDEF    2915--REDEF
B$ALT.ERR
      2915**DCL      5355>>ASSIGN   5362>>ASSIGN
B$ALT.ERR.ERR#
      2916**DCL      2916--REDEF    5358>>IF
B$ALT.EVID
      2915**DCL      2915--REDEF    2915--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3618**DCL      3618--REDEF
B$JIT.ERR.MID
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:191  
      3525**DCL      3525--REDEF
B$JIT.JRESPEAK
      3686**DCL      3687--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      3795**DCL      3795--REDEF    3796--REDEF
B$JIT.PNR
      3699**DCL      3699--REDEF
B$JIT.TSLINE
      3793**DCL      3794--REDEF
B$JIT.USER
      3524**DCL      5284>>ASSIGN
B$JIT$
      5255**DCL      3519--IMP-PTR  5284>>ASSIGN
B$TCB.ALT$
      2910**DCL      5355>>ASSIGN   5358>>IF       5362>>ASSIGN
B$TCB$
      5256**DCL      5355>>ASSIGN   5358>>IF       5362>>ASSIGN
BERC.DCB#
      2796**DCL      2797--REDEF
COM
      5271**LABEL    5263--GOTO     5267--GOTO
DBCB.CSECT.TBUF$
      2105**DCL      5344>>ASSIGN   5346>>ASSIGN
DBCB.IOWS.CFCT
      2523**DCL      2524--REDEF
DBCB.IOWS.DBKF.RQ
      2466**DCL      2467--REDEF
DBCB.IOWS.DBKR
      2463**DCL      2464--REDEF
DBCB.IOWS.NOBF
      2525**DCL      2526--REDEF
DBCB.IOWS.SPND
      2451**DCL      2452--REDEF
DBCB.PCB.RVI
      2299**DCL      5266>>ASSIGN
DBCB.PCB.RVT
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:192  
      2303**DCL      5262>>ASSIGN   5270>>ASSIGN
DBCB.SWS.RDYCW
      2189**DCL      2190--REDEF
DBCB.SWS.TEMP.PTR1$
      2223**DCL      2224--REDEF    2225--REDEF
DBCB.SWS.TEMP.PTR2$
      2226**DCL      2227--REDEF
DBCB$
      2094**DCL      2095--IMP-PTR  5272<<ASSIGN   5344>>ASSIGN   5346>>ASSIGN
ERROR
      5257**DCL      5271<<ASSIGN   5354<<ASSIGN   5359<<ASSIGN   5361<<ASSIGN   5367>>ASSIGN
ER_WRTC
      5358**LABEL    5307--CALLALT  5328--CALLALT  5349--CALLALT
ER_WRTT
      5354**LABEL    5298--CALLALT  5319--CALLALT  5340--CALLALT
FPT$TIME
      2962**DCL      5281<>CALL
FPT$WRTJ
      2937**DCL      5298<>CALL     5307<>CALL     5319<>CALL     5328<>CALL     5340<>CALL     5349<>CALL
FPT$WRTJ.BUF_.BOUND
      2937**DCL      5296<<ASSIGN   5305<<ASSIGN   5317<<ASSIGN   5326<<ASSIGN   5338<<ASSIGN   5347<<ASSIGN
FPT$WRTJ.STATION_
      2939**DCL      2939--REDEF
FPT$WRTJ.V.DCB#
      2940**DCL      5297<<ASSIGN   5306<<ASSIGN   5318<<ASSIGN   5327<<ASSIGN   5339<<ASSIGN   5348<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      2946**DCL      2946--REDEF
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF    5262>>ASSIGN   5262>>ASSIGN   5266>>ASSIGN   5266>>ASSIGN   5270>>ASSIGN
      5270>>ASSIGN   5272>>ASSIGN
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF    5273>>ASSIGN
GLOBAL.CJRNL.DCB#
       690**DCL      5306>>ASSIGN   5327>>ASSIGN   5348>>ASSIGN   5363>>ASSIGN   5364<<ASSIGN
GLOBAL.JRECORD
       700**DCL      5278--ASSIGN
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:193  
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.ROLL
       536**DCL      5275>>IF
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.RET.DCB#
       521**DCL      5356<<ASSIGN   5363<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      5367<<ASSIGN
GLOBAL.RET.SYSERR#
       516**DCL      5355<<ASSIGN   5362<<ASSIGN
GLOBAL.TIME.TSTAMP
       728**DCL      5283>>ASSIGN
GLOBAL.TIME$
       777**DCL      5281>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      5297>>ASSIGN   5318>>ASSIGN   5339>>ASSIGN   5356>>ASSIGN
GLOBAL.WRTJ$
       775**DCL      5279>>ASSIGN
GLOBAL$
       799**DCL       495--IMP-PTR  5262>>ASSIGN   5262>>ASSIGN   5266>>ASSIGN   5266>>ASSIGN   5270>>ASSIGN
      5270>>ASSIGN   5272>>ASSIGN   5273>>ASSIGN   5275>>IF       5278>>ASSIGN   5279>>ASSIGN   5281>>CALL
      5283>>ASSIGN   5297>>ASSIGN   5306>>ASSIGN   5318>>ASSIGN   5327>>ASSIGN   5339>>ASSIGN   5348>>ASSIGN
      5355>>ASSIGN   5356>>ASSIGN   5356>>ASSIGN   5362>>ASSIGN   5363>>ASSIGN   5363>>ASSIGN   5364>>ASSIGN
      5367>>ASSIGN
JREC
      2775**DCL      5296--ASSIGN   5305--ASSIGN   5317--ASSIGN   5326--ASSIGN   5338--ASSIGN   5347--ASSIGN
JREC.DCB#
      2779**DCL      5285<<ASSIGN
JREC.LENGTH
      2781**DCL      2784--IMP-SIZ  5293<<ASSIGN   5295>>ASSIGN   5296>>ASSIGN   5302<<ASSIGN   5303>>ASSIGN
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:194  
      5304>>ASSIGN   5305>>ASSIGN   5314<<ASSIGN   5315>>ASSIGN   5316>>ASSIGN   5317>>ASSIGN   5323<<ASSIGN
      5325>>ASSIGN   5326>>ASSIGN   5335<<ASSIGN   5336>>ASSIGN   5337>>ASSIGN   5338>>ASSIGN   5344<<ASSIGN
      5345>>ASSIGN   5346>>ASSIGN   5347>>ASSIGN
JREC.LINE
      2782**DCL      5287<<ASSIGN
JREC.OFFSET
      2783**DCL      5288<<ASSIGN
JREC.PAGE
      2780**DCL      5286<<ASSIGN
JREC.TIME
      2776**DCL      5283<<ASSIGN
JREC.TYPE
      2777**DCL      5282<<ASSIGN
JREC.USER#
      2778**DCL      5284<<ASSIGN
JREC.VALUE
      2784**DCL      5295<<ASSIGN   5304<<ASSIGN   5316<<ASSIGN   5325<<ASSIGN   5337<<ASSIGN   5346<<ASSIGN
JRNL$
      2754**DCL      2755--IMP-PTR  2775--IMP-PTR  2785--IMP-PTR  2792--IMP-PTR  2798--IMP-PTR  5278<<ASSIGN
      5282>>ASSIGN   5283>>ASSIGN   5284>>ASSIGN   5285>>ASSIGN   5286>>ASSIGN   5287>>ASSIGN   5288>>ASSIGN
      5293>>ASSIGN   5295>>ASSIGN   5295>>ASSIGN   5296>>ASSIGN   5296>>ASSIGN   5302>>ASSIGN   5303>>ASSIGN
      5304>>ASSIGN   5304>>ASSIGN   5305>>ASSIGN   5305>>ASSIGN   5314>>ASSIGN   5315>>ASSIGN   5316>>ASSIGN
      5316>>ASSIGN   5317>>ASSIGN   5317>>ASSIGN   5323>>ASSIGN   5325>>ASSIGN   5325>>ASSIGN   5326>>ASSIGN
      5326>>ASSIGN   5335>>ASSIGN   5336>>ASSIGN   5337>>ASSIGN   5337>>ASSIGN   5338>>ASSIGN   5338>>ASSIGN
      5344>>ASSIGN   5345>>ASSIGN   5346>>ASSIGN   5346>>ASSIGN   5347>>ASSIGN   5347>>ASSIGN
LENGTH
      5258**DCL      5259--IMP-SIZ  5294<<ASSIGN   5295>>ASSIGN   5303<<ASSIGN   5304>>ASSIGN   5315<<ASSIGN
      5316>>ASSIGN   5324<<ASSIGN   5325>>ASSIGN   5336<<ASSIGN   5337>>ASSIGN   5345<<ASSIGN   5346>>ASSIGN
M$ERR
      2849**DCL-ENT  5368--CALL
M$TIME
      2904**DCL-ENT  5281--CALL
M$WRITE
      2838**DCL-ENT  5298--CALL     5307--CALL     5319--CALL     5328--CALL     5340--CALL     5349--CALL
RECCW.SIZE
       805**DCL      5335>>ASSIGN   5344>>ASSIGN
PL6.E3A0      #006=ZIM$JSTO File=ZIM$JRNL.:ZIC0TSI                               FRI 09/05/97 13:00 Page:195  
RECORD
      5259**DCL      5295>>ASSIGN   5304>>ASSIGN   5316>>ASSIGN   5325>>ASSIGN   5337>>ASSIGN   5346>>ASSIGN
RECVAR.ACPTR
      2592**DCL      5280>>ASSIGN
RECVAR.AWS$
      2598**DCL      5274>>ASSIGN
RECVAR.BADDR
      2574**DCL      2577--REDEF
RECVAR.BADDR$
      2577**DCL      5288>>ASSIGN
RECVAR.DBKEY
      2573**DCL      5286>>ASSIGN   5287>>ASSIGN
RECVAR.RADDR
      2578**DCL      2582--REDEF
RECVAR.RADDR$
      2582**DCL      5288>>ASSIGN   5295>>ASSIGN   5304>>ASSIGN   5316>>ASSIGN   5325>>ASSIGN   5335>>ASSIGN
      5337>>ASSIGN
RECVAR.RECSZ
      2583**DCL      5302>>ASSIGN   5314>>ASSIGN
RECVAR$
      5253**DCL      2572--IMP-PTR  5262<<ASSIGN   5266<<ASSIGN   5270<<ASSIGN   5274>>ASSIGN   5280>>ASSIGN
      5286>>ASSIGN   5287>>ASSIGN   5288>>ASSIGN   5288>>ASSIGN   5295>>ASSIGN   5302>>ASSIGN   5304>>ASSIGN
      5314>>ASSIGN   5316>>ASSIGN   5325>>ASSIGN   5335>>ASSIGN   5337>>ASSIGN
SSS$
       814**DCL      5273<<ASSIGN   5280>>ASSIGN
TYPE
      5260**DCL      5261<<ASSIGN   5265<<ASSIGN   5269<<ASSIGN   5282>>ASSIGN   5289>>IF       5310>>IF
      5331>>IF
WRTJ$
      5254**DCL      2937--IMP-PTR  5279<<ASSIGN   5296>>ASSIGN   5297>>ASSIGN   5298>>CALL     5305>>ASSIGN
      5306>>ASSIGN   5307>>CALL     5317>>ASSIGN   5318>>ASSIGN   5319>>CALL     5326>>ASSIGN   5327>>ASSIGN
      5328>>CALL     5338>>ASSIGN   5339>>ASSIGN   5340>>CALL     5347>>ASSIGN   5348>>ASSIGN   5349>>CALL

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:196  
      802        1        /*T***********************************************************/
      803        2        /*T*                                                         */
      804        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      805        4        /*T*                                                         */
      806        5        /*T***********************************************************/
      807        6        ZIM$JPA: PROC
      808        7               MATERIALIZE($PR6 IN SSS$,$PR7 IN DBCB$)
      809        8               AVOID($PR5,$PR6,$PR7);
      810        9        %INCLUDE ZI$GLOBAL;
      811      495            %GLOBALS;
      812      803            %RECCW;
      813      808        %INCLUDE ZI$SSS;
      814     1357            %AC;
      815     1452            %RS;
      816     1528        %INCLUDE ZI$DBCB;
      817     2170            %DBCB;
      818     2648            %RECVAR(STCLASS="BASED(RECVAR$)");
      819     2682            %AWS;
      820     2722        %INCLUDE ZI$JRNL;
      821     2830            %JRNL_REC(STCLASS=AUTO);
      822     2905        %INCLUDE CP_6;
      823     2986            %B$TCB;
      824     2989            %B$ALT;
      825     2997            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      826     3028            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      827     3047        %INCLUDE CP_6_SUBS;
      828     3587        %INCLUDE B$JIT;
      829     3877        %INCLUDE ZI_ERRORS_C;
      830     4203        %INCLUDE B_ERRORS_C;
      831     5330    1   DCL RECVAR$ PTR;
      832     5331    1   DCL WRTJ$ PTR;
      833     5332    1   DCL B$JIT$ PTR SYMREF;
      834     5333    1   DCL B$TCB$ PTR SYMREF;
      835     5334    1   DCL ERROR UBIN(36);
      836     5335    1   DCL LENGTH UBIN(36);
      837     5336    1   DCL RECORD BASED CHAR(LENGTH);
      838     5337    1   DCL TYPE UBIN(36);
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:197  
      839     5338    1   DCL 1 PRCW_EIS ALIGNED, /* FIRST HALF WORD OF PA CONTROL WORD */
      840     5339    1         2 OFFSET UBIN(20) UNAL,
      841     5340    1         2 LENGTH UBIN(16) UNAL;
      842     5341    1   DCL 1 NEW_PRCW ALIGNED,
      843     5342    1         2 * BIT(2) UNAL,
      844     5343    1         2 PAFIL BIT(1) UNAL,
      845     5344    1         2 PALIL BIT(1) UNAL,
      846     5345    1         2 * BIT(32) UNAL;
      847     5346    1   DCL 1 PA_REC BASED UNAL,
      848     5347    1         2 * BIT(36) UNAL,
      849     5348    1         2 PRCW BIT(36) UNAL;
      850     5349    1   DCL ZIM$JSET ENTRY(3);
      851     5350
      852     5351    1   COMMON_PA: PROC ALTRET;
      853     5352
      854     5353    2       JRNL$=ADDR(GLOBAL.JRECORD);
      855     5354    2       AC$=PINCRW(SSS$,RECVAR.ACPTR);
      856     5355    2       CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
      857     5356    2       JREC.TYPE=T#MOD;
      858     5357    2       JREC.TIME=GLOBAL.TIME.TSTAMP;
      859     5358    2       JREC.USER#=B$JIT$->B$JIT.USER;
      860     5359    2       JREC.DCB#=AWS.DDCB;
      861     5360    2       JREC.PAGE=(RECVAR.DBKEY-AC.DBLIM.LOWDBK)/AC.LPP+1;
      862     5361    2       JREC.LINE=MOD(RECVAR.DBKEY-AC.DBLIM.LOWDBK,AC.LPP);
      863     5362    2       JREC.OFFSET=POFFC(RECVAR.RADDR$,RECVAR.BADDR$);
      864     5363    2       JREC.LENGTH=RECVAR.RECSZ;
      865     5364    2       LENGTH=JREC.LENGTH;
      866     5365    2       JREC.VALUE=RECVAR.RADDR$->RECORD;
      867     5366    2       FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
      868     5367    2       CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
      869     5368    2       RETURN;
      870     5369
      871     5370    2   ER_WRTT:
      872     5371    3       IF FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB# THEN DO;
      873     5372    3           ERROR=ERR#IO#WRTT;
      874     5373    3           GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
      875     5374    3           END;
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:198  
      876     5375    3       ELSE DO;
      877     5376    3           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
      878     5377    3               ERROR=ERR#IO#NOOWNER;
      879     5378    3           ELSE
      880     5379    3               ERROR=ERR#IO#WRTC;
      881     5380    3           GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
      882     5381    3           GLOBAL.CJRNL.DCB#=0;
      883     5382    3           END;
      884     5383    2       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      885     5384    2       ALTRETURN;
      886     5385    2   END COMMON_PA;
      887     5386
      888     5387    1   ZIM$JBEFPA: ENTRY;
      889     5388
      890     5389    1       ERROR=0;
      891     5390    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVPA);
      892     5391    1       AWS$=RECVAR.AWS$;
      893     5392    1       WRTJ$=GLOBAL.WRTJ$;
      894     5393    1       FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
      895     5394    1       IF AWS.ATRIB.TJRNL THEN
      896     5395    1           CALL COMMON_PA ALTRET(ALTRTN);
      897     5396    1       RETURN;
      898     5397
      899     5398    1   ZIM$JAFTPA: ENTRY;
      900     5399
      901     5400    1       ERROR=0;
      902     5401    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVPA);
      903     5402    1       AWS$=RECVAR.AWS$;
      904     5403    1       WRTJ$=GLOBAL.WRTJ$;
      905     5404    1       IF AWS.ATRIB.CJRNL THEN
      906     5405    2       DO;
      907     5406    2           FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
      908     5407    2           CALL COMMON_PA ALTRET(ALTRTN);
      909     5408    2           IF DBCB.PWS.PASPLT ~=0 THEN
      910     5409    3           DO;
      911     5410    3               RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVO);
      912     5411    3               CALL COMMON_PA ALTRET(ALTRTN);
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:199  
      913     5412    3               END;
      914     5413    2           END;
      915     5414    1       RETURN;
      916     5415    1   ALTRTN: ;
      917     5416    1       GLOBAL.RET.ERROR#=ERROR;
      918     5417    1       CALL M$ERR;
      919     5418
      920     5419    1   ZIM$JPASET: ENTRY;
      921     5420
      922     5421        /*    UPDATE THE NEXT POINTER IF THE REC IN RVT IS A MEMBER OF PA SET
      923     5422              OR UPDATE THE OWNER POINTER IN THE REC IF IT IS A PA_REC */
      924     5423
      925     5424    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);
      926     5425    1       RS$=PINCRW(SSS$,RECVAR.RSPTR);
      927     5426    1       IF RS.DEF.MEMT=2 THEN /* REC IS A PA_REC */
      928     5427    1           CALL ZIM$JSET(RECVAR$,RS.HPOS.EIS,DBCB.PWS.PAOPTR);
      929     5428    1       ELSE
      930     5429    1           CALL ZIM$JSET(RECVAR$,RS.CSPAH.EIS,DBCB.PWS.PAOPTR);
      931     5430    1       RETURN;
      932     5431
      933     5432
      934     5433    1   ZIM$JPAMEM: ENTRY;
      935     5434
      936     5435        /*    STORE THE TWO PTRS IN A PA MEMBER */
      937     5436
      938     5437    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);
      939     5438    1       RS$=PINCRW(SSS$,RECVAR.RSPTR);
      940     5439    1       CALL ZIM$JSET(RECVAR$,RS.CSPAH.EIS,DBCB.PWS.PAOPTR);
      941     5440    1       CALL ZIM$JSET(RECVAR$,RS.HPOS.EIS,DBCB.PWS.NPOPTR);
      942     5441    1       RETURN;
      943     5442
      944     5443    1   ZIM$JPAFIL: ENTRY;
      945     5444
      946     5445        /*    UPDATE THE PA FIRST_IN_LEVEL BIT IN PA REC CONTROL WORD
      947     5446                     AND JOURNAL THE CONTROL WORD */
      948     5447
      949     5448    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVO); /* USE RVO */
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:200  
      950     5449    1       PRCW_EIS.LENGTH=4; /* JOURNAL FOUR BYTES */
      951     5450    1       PRCW_EIS.OFFSET=4; /* PARCW IS ALWAYS OFFSET BY 4 */
      952     5451    1       NEW_PRCW=RECVAR.RADDR$->PA_REC.PRCW; /* SET NEW PRCW = OLD */
      953     5452    1       NEW_PRCW.PAFIL='1'B; /* THEN SET FIL BIT */
      954     5453    1       CALL ZIM$JSET(RECVAR$,PRCW_EIS,NEW_PRCW);
      955     5454    1       RETURN;
      956     5455
      957     5456    1   ZIM$JPALIL: ENTRY;
      958     5457
      959     5458    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);
      960     5459    1       PRCW_EIS.LENGTH=4;
      961     5460    1       PRCW_EIS.OFFSET=4;
      962     5461    1       NEW_PRCW=RECVAR.RADDR$->PA_REC.PRCW;
      963     5462    1       NEW_PRCW.PALIL='1'B;
      964     5463    1       CALL ZIM$JSET(RECVAR$,PRCW_EIS,NEW_PRCW);
      965     5464    1       RETURN;
      966     5465
      967     5466
      968     5467    1   END ZIM$JPA;
      969     5468        %EOD;

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:201  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JPA.

   Procedure ZIM$JPA requires 349 words for executable code.
   Procedure ZIM$JPA requires 22 words of local(AUTO) storage.

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:202  

 Object Unit name= ZIM$JPA                                    File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:01:02.92 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   349    535  ZIM$JPA
    2  RoData even  none     2      2  ZIM$JPA

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       0  ZIM$JPA
     1    205                  yes      XStd       0  ZIM$JBEFPA
     1    236                  yes      XStd       0  ZIM$JAFTPA
     1    306                  yes      XStd       0  ZIM$JPASET
     1    363                  yes      XStd       0  ZIM$JPAMEM
     1    431                  yes      XStd       0  ZIM$JPAFIL
     1    473                  yes      XStd       0  ZIM$JPALIL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           XStd      3 ZIM$JSET
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:203  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:204  


      802        1        /*T***********************************************************/
      803        2        /*T*                                                         */
      804        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      805        4        /*T*                                                         */
      806        5        /*T***********************************************************/
      807        6        ZIM$JPA: PROC

      6  1 000000   000000 700200 xent  ZIM$JPA      TSX0  ! X66_AUTO_0
         1 000001   000026 000000                    ZERO    22,0
         1 000002   200003 456700                    STP6  ! SSS$,,AUTO
         1 000003   200006 457700                    STP7  ! DBCB$,,AUTO
         1 000004   000204 710000 1                  TRA     s:5384+2

      808        7               MATERIALIZE($PR6 IN SSS$,$PR7 IN DBCB$)
      809        8               AVOID($PR5,$PR6,$PR7);
      810        9        %INCLUDE ZI$GLOBAL;
      811      495            %GLOBALS;
      812      803            %RECCW;
      813      808        %INCLUDE ZI$SSS;
      814     1357            %AC;
      815     1452            %RS;
      816     1528        %INCLUDE ZI$DBCB;
      817     2170            %DBCB;
      818     2648            %RECVAR(STCLASS="BASED(RECVAR$)");
      819     2682            %AWS;
      820     2722        %INCLUDE ZI$JRNL;
      821     2830            %JRNL_REC(STCLASS=AUTO);
      822     2905        %INCLUDE CP_6;
      823     2986            %B$TCB;
      824     2989            %B$ALT;
      825     2997            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      826     3028            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      827     3047        %INCLUDE CP_6_SUBS;
      828     3587        %INCLUDE B$JIT;
      829     3877        %INCLUDE ZI_ERRORS_C;
      830     4203        %INCLUDE B_ERRORS_C;
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:205  
      831     5330    1   DCL RECVAR$ PTR;
      832     5331    1   DCL WRTJ$ PTR;
      833     5332    1   DCL B$JIT$ PTR SYMREF;
      834     5333    1   DCL B$TCB$ PTR SYMREF;
      835     5334    1   DCL ERROR UBIN(36);
      836     5335    1   DCL LENGTH UBIN(36);
      837     5336    1   DCL RECORD BASED CHAR(LENGTH);
      838     5337    1   DCL TYPE UBIN(36);
      839     5338    1   DCL 1 PRCW_EIS ALIGNED, /* FIRST HALF WORD OF PA CONTROL WORD */
      840     5339    1         2 OFFSET UBIN(20) UNAL,
      841     5340    1         2 LENGTH UBIN(16) UNAL;
      842     5341    1   DCL 1 NEW_PRCW ALIGNED,
      843     5342    1         2 * BIT(2) UNAL,
      844     5343    1         2 PAFIL BIT(1) UNAL,
      845     5344    1         2 PALIL BIT(1) UNAL,
      846     5345    1         2 * BIT(32) UNAL;
      847     5346    1   DCL 1 PA_REC BASED UNAL,
      848     5347    1         2 * BIT(36) UNAL,
      849     5348    1         2 PRCW BIT(36) UNAL;
      850     5349    1   DCL ZIM$JSET ENTRY(3);
      851     5350
      852     5351    1   COMMON_PA: PROC ALTRET;

   5351  1 000005   200020 741300       COMMON_PA    STX1  ! NEW_PRCW+1,,AUTO

      853     5352
      854     5353    2       JRNL$=ADDR(GLOBAL.JRECORD);

   5353  1 000006   000000 236000 xsym               LDQ     GLOBAL$
         1 000007   002622 036003                    ADLQ    1426,DU
         1 000010   200010 756100                    STQ     JRNL$,,AUTO

      855     5354    2       AC$=PINCRW(SSS$,RECVAR.ACPTR);

   5354  1 000011   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000012   000005 220100                    LDX0    5,,PR0
         1 000013   000000 636010                    EAQ     0,X0
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:206  
         1 000014   200003 036100                    ADLQ    SSS$,,AUTO
         1 000015   200004 756100                    STQ     AC$,,AUTO

      856     5355    2       CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   5355  1 000016   000000 471400 xsym               LDP1    GLOBAL$
         1 000017   105117 473500                    LDP3    2639,,PR1
         1 000020   300000 630500                    EPPR0   0,,PR3
         1 000021   020004 713400                    CLIMB   8196
         1 000022   402000 401760                    pmme    nvectors=5

      857     5356    2       JREC.TYPE=T#MOD;

   5356  1 000023   200010 470500                    LDP0    JRNL$,,AUTO
         1 000024   010000 236003                    LDQ     4096,DU
         1 000025   000001 552140                    STBQ    1,'40'O,PR0

      858     5357    2       JREC.TIME=GLOBAL.TIME.TSTAMP;

   5357  1 000026   000000 471400 xsym               LDP1    GLOBAL$
         1 000027   105001 235100                    LDA     2561,,PR1
         1 000030   000000 755100                    STA     0,,PR0

      859     5358    2       JREC.USER#=B$JIT$->B$JIT.USER;

   5358  1 000031   000000 473400 xsym               LDP3    B$JIT$
         1 000032   300000 236100                    LDQ     0,,PR3
         1 000033   000001 552120                    STBQ    1,'20'O,PR0

      860     5359    2       JREC.DCB#=AWS.DDCB;

   5359  1 000034   200007 474500                    LDP4    AWS$,,AUTO
         1 000035   400006 220100                    LDX0    6,,PR4
         1 000036   000001 440100                    SXL0    1,,PR0

      861     5360    2       JREC.PAGE=(RECVAR.DBKEY-AC.DBLIM.LOWDBK)/AC.LPP+1;

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:207  
   5360  1 000037   200004 470500                    LDP0    AC$,,AUTO
         1 000040   200011 471500                    LDP1    RECVAR$,,AUTO
         1 000041   100000 236100                    LDQ     0,,PR1
         1 000042   000010 136100                    SBLQ    8,,PR0
         1 000043   200022 756100                    STQ     NEW_PRCW+3,,AUTO
         1 000044   000012 236100                    LDQ     10,,PR0
         1 000045   777777 376007                    ANQ     -1,DL
         1 000046   200023 756100                    STQ     NEW_PRCW+4,,AUTO
         1 000047   200022 236100                    LDQ     NEW_PRCW+3,,AUTO
         1 000050   200023 506100                    DIV     NEW_PRCW+4,,AUTO
         1 000051   000001 036007                    ADLQ    1,DL
         1 000052   200010 470500                    LDP0    JRNL$,,AUTO
         1 000053   000002 756100                    STQ     2,,PR0

      862     5361    2       JREC.LINE=MOD(RECVAR.DBKEY-AC.DBLIM.LOWDBK,AC.LPP);

   5361  1 000054   200004 471500                    LDP1    AC$,,AUTO
         1 000055   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000056   000000 236100                    LDQ     0,,PR0
         1 000057   100010 136100                    SBLQ    8,,PR1
         1 000060   200022 756100                    STQ     NEW_PRCW+3,,AUTO
         1 000061   100012 236100                    LDQ     10,,PR1
         1 000062   777777 376007                    ANQ     -1,DL
         1 000063   200023 756100                    STQ     NEW_PRCW+4,,AUTO
         1 000064   200022 236100                    LDQ     NEW_PRCW+3,,AUTO
         1 000065   200023 506100                    DIV     NEW_PRCW+4,,AUTO
         1 000066   000000 620005                    EAX0    0,AL
         1 000067   200010 470500                    LDP0    JRNL$,,AUTO
         1 000070   000003 440100                    SXL0    3,,PR0

      863     5362    2       JREC.OFFSET=POFFC(RECVAR.RADDR$,RECVAR.BADDR$);

   5362  1 000071   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000072   000001 236100                    LDQ     1,,PR0
         1 000073   000020 772000                    QRL     16
         1 000074   200022 756100                    STQ     NEW_PRCW+3,,AUTO
         1 000075   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:208  
         1 000076   000020 772000                    QRL     16
         1 000077   200022 136100                    SBLQ    NEW_PRCW+3,,AUTO
         1 000100   000000 620006                    EAX0    0,QL
         1 000101   200010 470500                    LDP0    JRNL$,,AUTO
         1 000102   000004 740100                    STX0    4,,PR0

      864     5363    2       JREC.LENGTH=RECVAR.RECSZ;

   5363  1 000103   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000104   000003 220100                    LDX0    3,,PR0
         1 000105   200010 470500                    LDP0    JRNL$,,AUTO
         1 000106   000003 740100                    STX0    3,,PR0

      865     5364    2       LENGTH=JREC.LENGTH;

   5364  1 000107   000003 236100                    LDQ     3,,PR0
         1 000110   000022 772000                    QRL     18
         1 000111   200014 756100                    STQ     LENGTH,,AUTO

      866     5365    2       JREC.VALUE=RECVAR.RADDR$->RECORD;

   5365  1 000112   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000113   000002 471500                    LDP1    2,,PR0
         1 000114   000000 621006                    EAX1    0,QL
         1 000115   200010 470500                    LDP0    JRNL$,,AUTO
         1 000116   040140 100540                    MLR     fill='040'O
         1 000117   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1
         1 000120   000004 400010                    ADSC9   4,,PR0                   cn=2,n=*X0

      867     5366    2       FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5366  1 000121   000003 220100                    LDX0    3,,PR0
         1 000122   000022 621010                    EAX1    18,X0
         1 000123   000000 636011                    EAQ     0,X1
         1 000124   000022 772000                    QRL     18
         1 000125   000011 402007                    MPY     9,DL
         1 000126   000043 036007                    ADLQ    35,DL
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:209  
         1 000127   000044 506007                    DIV     36,DL
         1 000130   200012 471500                    LDP1    WRTJ$,,AUTO
         1 000131   000002 736000                    QLS     2
         1 000132   000001 136007                    SBLQ    1,DL
         1 000133   000020 736000                    QLS     16
         1 000134   100004 676100                    ERQ     4,,PR1
         1 000135   000000 376000 2                  ANQ     0
         1 000136   100004 656100                    ERSQ    4,,PR1

      868     5367    2       CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5367  1 000137   100000 630500                    EPPR0   0,,PR1
         1 000140   440001 713400                    CLIMB   alt,write
         1 000141   401400 401760                    pmme    nvectors=4
         1 000142   000145 702000 1                  TSX2    ER_WRTT

      869     5368    2       RETURN;

   5368  1 000143   200020 221300                    LDX1  ! NEW_PRCW+1,,AUTO
         1 000144   000001 702211                    TSX2  ! 1,X1

      870     5369
      871     5370    2   ER_WRTT:
      872     5371    3       IF FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB# THEN DO;

   5371  1 000145   000000 470400 xsym  ER_WRTT      LDP0    GLOBAL$
         1 000146   200012 471500                    LDP1    WRTJ$,,AUTO
         1 000147   100010 236100                    LDQ     8,,PR1
         1 000150   000022 772000                    QRL     18
         1 000151   002604 116100                    CMPQ    1412,,PR0
         1 000152   000160 601000 1                  TNZ     s:5376

      873     5372    3           ERROR=ERR#IO#WRTT;

   5372  1 000153   210720 235007                    LDA     70096,DL
         1 000154   200013 755100                    STA     ERROR,,AUTO

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:210  
      874     5373    3           GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

   5373  1 000155   002604 720100                    LXL0    1412,,PR0
         1 000156   000014 740100                    STX0    12,,PR0

      875     5374    3           END;

   5374  1 000157   000176 710000 1                  TRA     s:5383

      876     5375    3       ELSE DO;

      877     5376    3           IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   5376  1 000160   000000 473400 xsym               LDP3    B$TCB$
         1 000161   300000 474500                    LDP4    0,,PR3
         1 000162   400102 236100                    LDQ     66,,PR4
         1 000163   377770 376007                    ANQ     131064,DL
         1 000164   001160 116007                    CMPQ    624,DL
         1 000165   000171 601000 1                  TNZ     s:5379

      878     5377    3               ERROR=ERR#IO#NOOWNER;

   5377  1 000166   210762 235007                    LDA     70130,DL
         1 000167   200013 755100                    STA     ERROR,,AUTO
         1 000170   000173 710000 1                  TRA     s:5380

      879     5378    3           ELSE
      880     5379    3               ERROR=ERR#IO#WRTC;

   5379  1 000171   210721 235007                    LDA     70097,DL
         1 000172   200013 755100                    STA     ERROR,,AUTO

      881     5380    3           GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   5380  1 000173   002610 720100                    LXL0    1416,,PR0
         1 000174   000014 740100                    STX0    12,,PR0

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:211  
      882     5381    3           GLOBAL.CJRNL.DCB#=0;

   5381  1 000175   002610 450100                    STZ     1416,,PR0

      883     5382    3           END;

      884     5383    2       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5383  1 000176   000000 473400 xsym               LDP3    B$TCB$
         1 000177   300000 474500                    LDP4    0,,PR3
         1 000200   400102 236100                    LDQ     66,,PR4
         1 000201   000007 756100                    STQ     7,,PR0

      885     5384    2       ALTRETURN;

   5384  1 000202   200020 221300                    LDX1  ! NEW_PRCW+1,,AUTO
         1 000203   000000 702211                    TSX2  ! 0,X1
         1 000204   000211 710000 1                  TRA     s:5389

      886     5385    2   END COMMON_PA;
      887     5386
      888     5387    1   ZIM$JBEFPA: ENTRY;

   5387  1 000205   000000 700200 xent  ZIM$JBEFPA   TSX0  ! X66_AUTO_0
         1 000206   000026 000000                    ZERO    22,0
         1 000207   200003 456700                    STP6  ! SSS$,,AUTO
         1 000210   200006 457700                    STP7  ! DBCB$,,AUTO

      889     5388
      890     5389    1       ERROR=0;

   5389  1 000211   200013 450100                    STZ     ERROR,,AUTO

      891     5390    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVPA);

   5390  1 000212   700513 220100                    LDX0    331,,PR7
         1 000213   000000 636010                    EAQ     0,X0
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:212  
         1 000214   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000215   200011 756100                    STQ     RECVAR$,,AUTO

      892     5391    1       AWS$=RECVAR.AWS$;

   5391  1 000216   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000217   000013 236100                    LDQ     11,,PR0
         1 000220   200007 756100                    STQ     AWS$,,AUTO

      893     5392    1       WRTJ$=GLOBAL.WRTJ$;

   5392  1 000221   000000 471400 xsym               LDP1    GLOBAL$
         1 000222   105115 236100                    LDQ     2637,,PR1
         1 000223   200012 756100                    STQ     WRTJ$,,AUTO

      894     5393    1       FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5393  1 000224   102604 721100                    LXL1    1412,,PR1
         1 000225   200012 473500                    LDP3    WRTJ$,,AUTO
         1 000226   300010 741100                    STX1    8,,PR3

      895     5394    1       IF AWS.ATRIB.TJRNL THEN

   5394  1 000227   200007 470500                    LDP0    AWS$,,AUTO
         1 000230   000000 236100                    LDQ     0,,PR0
         1 000231   020000 316003                    CANQ    8192,DU
         1 000232   000235 600000 1                  TZE     s:5396

      896     5395    1           CALL COMMON_PA ALTRET(ALTRTN);

   5395  1 000233   000005 701000 1                  TSX1    COMMON_PA
         1 000234   000300 702000 1                  TSX2    ALTRTN

      897     5396    1       RETURN;

   5396  1 000235   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:213  
      898     5397
      899     5398    1   ZIM$JAFTPA: ENTRY;

   5398  1 000236   000000 700200 xent  ZIM$JAFTPA   TSX0  ! X66_AUTO_0
         1 000237   000026 000000                    ZERO    22,0
         1 000240   200003 456700                    STP6  ! SSS$,,AUTO
         1 000241   200006 457700                    STP7  ! DBCB$,,AUTO

      900     5399
      901     5400    1       ERROR=0;

   5400  1 000242   200013 450100                    STZ     ERROR,,AUTO

      902     5401    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVPA);

   5401  1 000243   700513 220100                    LDX0    331,,PR7
         1 000244   000000 636010                    EAQ     0,X0
         1 000245   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000246   200011 756100                    STQ     RECVAR$,,AUTO

      903     5402    1       AWS$=RECVAR.AWS$;

   5402  1 000247   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000250   000013 236100                    LDQ     11,,PR0
         1 000251   200007 756100                    STQ     AWS$,,AUTO

      904     5403    1       WRTJ$=GLOBAL.WRTJ$;

   5403  1 000252   000000 471400 xsym               LDP1    GLOBAL$
         1 000253   105115 236100                    LDQ     2637,,PR1
         1 000254   200012 756100                    STQ     WRTJ$,,AUTO

      905     5404    1       IF AWS.ATRIB.CJRNL THEN

   5404  1 000255   200007 473500                    LDP3    AWS$,,AUTO
         1 000256   300000 236100                    LDQ     0,,PR3
         1 000257   100000 316003                    CANQ    32768,DU
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:214  
         1 000260   000277 600000 1                  TZE     s:5414

      906     5405    2       DO;

      907     5406    2           FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5406  1 000261   102610 721100                    LXL1    1416,,PR1
         1 000262   200012 474500                    LDP4    WRTJ$,,AUTO
         1 000263   400010 741100                    STX1    8,,PR4

      908     5407    2           CALL COMMON_PA ALTRET(ALTRTN);

   5407  1 000264   000005 701000 1                  TSX1    COMMON_PA
         1 000265   000300 702000 1                  TSX2    ALTRTN

      909     5408    2           IF DBCB.PWS.PASPLT ~=0 THEN

   5408  1 000266   200006 470500                    LDP0    DBCB$,,AUTO
         1 000267   000724 720100                    LXL0    468,,PR0
         1 000270   000277 600000 1                  TZE     s:5414

      910     5409    3           DO;

      911     5410    3               RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVO);

   5410  1 000271   000511 221100                    LDX1    329,,PR0
         1 000272   000000 636011                    EAQ     0,X1
         1 000273   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000274   200011 756100                    STQ     RECVAR$,,AUTO

      912     5411    3               CALL COMMON_PA ALTRET(ALTRTN);

   5411  1 000275   000005 701000 1                  TSX1    COMMON_PA
         1 000276   000300 702000 1                  TSX2    ALTRTN

      913     5412    3               END;

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:215  
      914     5413    2           END;

      915     5414    1       RETURN;

   5414  1 000277   000000 702200 xent               TSX2  ! X66_ARET

   5411  1 000300                       ALTRTN       null
      916     5415    1   ALTRTN: ;
      917     5416    1       GLOBAL.RET.ERROR#=ERROR;

   5416  1 000300   000000 470400 xsym               LDP0    GLOBAL$
         1 000301   200013 235100                    LDA     ERROR,,AUTO
         1 000302   000006 755100                    STA     6,,PR0

      918     5417    1       CALL M$ERR;

   5417  1 000303   000002 713400                    CLIMB   err
         1 000304   000000 401760                    pmme    nvectors=0
         1 000305   000312 710000 1                  TRA     s:5424

      919     5418
      920     5419    1   ZIM$JPASET: ENTRY;

   5419  1 000306   000000 700200 xent  ZIM$JPASET   TSX0  ! X66_AUTO_0
         1 000307   000026 000000                    ZERO    22,0
         1 000310   200003 456700                    STP6  ! SSS$,,AUTO
         1 000311   200006 457700                    STP7  ! DBCB$,,AUTO

      921     5420
      922     5421        /*    UPDATE THE NEXT POINTER IF THE REC IN RVT IS A MEMBER OF PA SET
      923     5422              OR UPDATE THE OWNER POINTER IN THE REC IF IT IS A PA_REC */
      924     5423
      925     5424    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);

   5424  1 000312   200006 470500                    LDP0    DBCB$,,AUTO
         1 000313   000512 220100                    LDX0    330,,PR0
         1 000314   000000 636010                    EAQ     0,X0
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:216  
         1 000315   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000316   200011 756100                    STQ     RECVAR$,,AUTO

      926     5425    1       RS$=PINCRW(SSS$,RECVAR.RSPTR);

   5425  1 000317   200011 471500                    LDP1    RECVAR$,,AUTO
         1 000320   100004 721100                    LXL1    4,,PR1
         1 000321   000000 636011                    EAQ     0,X1
         1 000322   200003 036100                    ADLQ    SSS$,,AUTO
         1 000323   200005 756100                    STQ     RS$,,AUTO

      927     5426    1       IF RS.DEF.MEMT=2 THEN /* REC IS A PA_REC */

   5426  1 000324   200005 473500                    LDP3    RS$,,AUTO
         1 000325   300000 236100                    LDQ     0,,PR3
         1 000326   000007 376003                    ANQ     7,DU
         1 000327   000002 116003                    CMPQ    2,DU
         1 000330   000346 601000 1                  TNZ     s:5429

      928     5427    1           CALL ZIM$JSET(RECVAR$,RS.HPOS.EIS,DBCB.PWS.PAOPTR);

   5427  1 000331   200006 236100                    LDQ     DBCB$,,AUTO
         1 000332   000731 036003                    ADLQ    473,DU
         1 000333   200024 756100                    STQ     NEW_PRCW+5,,AUTO
         1 000334   200005 236100                    LDQ     RS$,,AUTO
         1 000335   000006 036003                    ADLQ    6,DU
         1 000336   200023 756100                    STQ     NEW_PRCW+4,,AUTO
         1 000337   200011 634500                    EPPR4   RECVAR$,,AUTO
         1 000340   200022 454500                    STP4    NEW_PRCW+3,,AUTO
         1 000341   200022 630500                    EPPR0   NEW_PRCW+3,,AUTO
         1 000342   000001 631400 2                  EPPR1   1
         1 000343   000000 701000 xent               TSX1    ZIM$JSET
         1 000344   000000 011000                    NOP     0
         1 000345   000362 710000 1                  TRA     s:5430

      929     5428    1       ELSE
      930     5429    1           CALL ZIM$JSET(RECVAR$,RS.CSPAH.EIS,DBCB.PWS.PAOPTR);
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:217  

   5429  1 000346   200006 236100                    LDQ     DBCB$,,AUTO
         1 000347   000731 036003                    ADLQ    473,DU
         1 000350   200024 756100                    STQ     NEW_PRCW+5,,AUTO
         1 000351   200005 236100                    LDQ     RS$,,AUTO
         1 000352   000004 036003                    ADLQ    4,DU
         1 000353   200023 756100                    STQ     NEW_PRCW+4,,AUTO
         1 000354   200011 634500                    EPPR4   RECVAR$,,AUTO
         1 000355   200022 454500                    STP4    NEW_PRCW+3,,AUTO
         1 000356   200022 630500                    EPPR0   NEW_PRCW+3,,AUTO
         1 000357   000001 631400 2                  EPPR1   1
         1 000360   000000 701000 xent               TSX1    ZIM$JSET
         1 000361   000000 011000                    NOP     0

      931     5430    1       RETURN;

   5430  1 000362   000000 702200 xent               TSX2  ! X66_ARET

      932     5431
      933     5432
      934     5433    1   ZIM$JPAMEM: ENTRY;

   5433  1 000363   000000 700200 xent  ZIM$JPAMEM   TSX0  ! X66_AUTO_0
         1 000364   000026 000000                    ZERO    22,0
         1 000365   200003 456700                    STP6  ! SSS$,,AUTO
         1 000366   200006 457700                    STP7  ! DBCB$,,AUTO

      935     5434
      936     5435        /*    STORE THE TWO PTRS IN A PA MEMBER */
      937     5436
      938     5437    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);

   5437  1 000367   700512 220100                    LDX0    330,,PR7
         1 000370   000000 636010                    EAQ     0,X0
         1 000371   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000372   200011 756100                    STQ     RECVAR$,,AUTO

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:218  
      939     5438    1       RS$=PINCRW(SSS$,RECVAR.RSPTR);

   5438  1 000373   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000374   000004 721100                    LXL1    4,,PR0
         1 000375   000000 636011                    EAQ     0,X1
         1 000376   200003 036100                    ADLQ    SSS$,,AUTO
         1 000377   200005 756100                    STQ     RS$,,AUTO

      940     5439    1       CALL ZIM$JSET(RECVAR$,RS.CSPAH.EIS,DBCB.PWS.PAOPTR);

   5439  1 000400   200006 236100                    LDQ     DBCB$,,AUTO
         1 000401   000731 036003                    ADLQ    473,DU
         1 000402   200024 756100                    STQ     NEW_PRCW+5,,AUTO
         1 000403   200005 236100                    LDQ     RS$,,AUTO
         1 000404   000004 036003                    ADLQ    4,DU
         1 000405   200023 756100                    STQ     NEW_PRCW+4,,AUTO
         1 000406   200011 631500                    EPPR1   RECVAR$,,AUTO
         1 000407   200022 451500                    STP1    NEW_PRCW+3,,AUTO
         1 000410   200022 630500                    EPPR0   NEW_PRCW+3,,AUTO
         1 000411   000001 631400 2                  EPPR1   1
         1 000412   000000 701000 xent               TSX1    ZIM$JSET
         1 000413   000000 011000                    NOP     0

      941     5440    1       CALL ZIM$JSET(RECVAR$,RS.HPOS.EIS,DBCB.PWS.NPOPTR);

   5440  1 000414   200006 236100                    LDQ     DBCB$,,AUTO
         1 000415   000631 036003                    ADLQ    409,DU
         1 000416   200024 756100                    STQ     NEW_PRCW+5,,AUTO
         1 000417   200005 236100                    LDQ     RS$,,AUTO
         1 000420   000006 036003                    ADLQ    6,DU
         1 000421   200023 756100                    STQ     NEW_PRCW+4,,AUTO
         1 000422   200011 630500                    EPPR0   RECVAR$,,AUTO
         1 000423   200022 450500                    STP0    NEW_PRCW+3,,AUTO
         1 000424   200022 630500                    EPPR0   NEW_PRCW+3,,AUTO
         1 000425   000001 631400 2                  EPPR1   1
         1 000426   000000 701000 xent               TSX1    ZIM$JSET
         1 000427   000000 011000                    NOP     0
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:219  

      942     5441    1       RETURN;

   5441  1 000430   000000 702200 xent               TSX2  ! X66_ARET

      943     5442
      944     5443    1   ZIM$JPAFIL: ENTRY;

   5443  1 000431   000000 700200 xent  ZIM$JPAFIL   TSX0  ! X66_AUTO_0
         1 000432   000026 000000                    ZERO    22,0
         1 000433   200003 456700                    STP6  ! SSS$,,AUTO
         1 000434   200006 457700                    STP7  ! DBCB$,,AUTO

      945     5444
      946     5445        /*    UPDATE THE PA FIRST_IN_LEVEL BIT IN PA REC CONTROL WORD
      947     5446                     AND JOURNAL THE CONTROL WORD */
      948     5447
      949     5448    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVO); /* USE RVO */

   5448  1 000435   700511 220100                    LDX0    329,,PR7
         1 000436   000000 636010                    EAQ     0,X0
         1 000437   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000440   200011 756100                    STQ     RECVAR$,,AUTO

      950     5449    1       PRCW_EIS.LENGTH=4; /* JOURNAL FOUR BYTES */

   5449  1 000441   200016 236100                    LDQ     PRCW_EIS,,AUTO
         1 000442   000000 376000 2                  ANQ     0
         1 000443   000004 276007                    ORQ     4,DL
         1 000444   200016 756100                    STQ     PRCW_EIS,,AUTO

      951     5450    1       PRCW_EIS.OFFSET=4; /* PARCW IS ALWAYS OFFSET BY 4 */

   5450  1 000445   200016 236100                    LDQ     PRCW_EIS,,AUTO
         1 000446   177777 376007                    ANQ     65535,DL
         1 000447   000001 276003                    ORQ     1,DU
         1 000450   200016 756100                    STQ     PRCW_EIS,,AUTO
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:220  

      952     5451    1       NEW_PRCW=RECVAR.RADDR$->PA_REC.PRCW; /* SET NEW PRCW = OLD */

   5451  1 000451   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000452   000002 471500                    LDP1    2,,PR0
         1 000453   003100 060500                    CSL     bolr='003'O
         1 000454   100001 000044                    BDSC    1,,PR1                   by=0,bit=0,n=36
         1 000455   200017 000044                    BDSC    NEW_PRCW,,AUTO           by=0,bit=0,n=36

      953     5452    1       NEW_PRCW.PAFIL='1'B; /* THEN SET FIL BIT */

   5452  1 000456   100000 236003                    LDQ     32768,DU
         1 000457   200017 256100                    ORSQ    NEW_PRCW,,AUTO

      954     5453    1       CALL ZIM$JSET(RECVAR$,PRCW_EIS,NEW_PRCW);

   5453  1 000460   200017 631500                    EPPR1   NEW_PRCW,,AUTO
         1 000461   200024 451500                    STP1    NEW_PRCW+5,,AUTO
         1 000462   200016 633500                    EPPR3   PRCW_EIS,,AUTO
         1 000463   200023 453500                    STP3    NEW_PRCW+4,,AUTO
         1 000464   200011 634500                    EPPR4   RECVAR$,,AUTO
         1 000465   200022 454500                    STP4    NEW_PRCW+3,,AUTO
         1 000466   200022 630500                    EPPR0   NEW_PRCW+3,,AUTO
         1 000467   000001 631400 2                  EPPR1   1
         1 000470   000000 701000 xent               TSX1    ZIM$JSET
         1 000471   000000 011000                    NOP     0

      955     5454    1       RETURN;

   5454  1 000472   000000 702200 xent               TSX2  ! X66_ARET

      956     5455
      957     5456    1   ZIM$JPALIL: ENTRY;

   5456  1 000473   000000 700200 xent  ZIM$JPALIL   TSX0  ! X66_AUTO_0
         1 000474   000026 000000                    ZERO    22,0
         1 000475   200003 456700                    STP6  ! SSS$,,AUTO
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:221  
         1 000476   200006 457700                    STP7  ! DBCB$,,AUTO

      958     5457
      959     5458    1       RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);

   5458  1 000477   700512 220100                    LDX0    330,,PR7
         1 000500   000000 636010                    EAQ     0,X0
         1 000501   200006 036100                    ADLQ    DBCB$,,AUTO
         1 000502   200011 756100                    STQ     RECVAR$,,AUTO

      960     5459    1       PRCW_EIS.LENGTH=4;

   5459  1 000503   200016 236100                    LDQ     PRCW_EIS,,AUTO
         1 000504   000000 376000 2                  ANQ     0
         1 000505   000004 276007                    ORQ     4,DL
         1 000506   200016 756100                    STQ     PRCW_EIS,,AUTO

      961     5460    1       PRCW_EIS.OFFSET=4;

   5460  1 000507   200016 236100                    LDQ     PRCW_EIS,,AUTO
         1 000510   177777 376007                    ANQ     65535,DL
         1 000511   000001 276003                    ORQ     1,DU
         1 000512   200016 756100                    STQ     PRCW_EIS,,AUTO

      962     5461    1       NEW_PRCW=RECVAR.RADDR$->PA_REC.PRCW;

   5461  1 000513   200011 470500                    LDP0    RECVAR$,,AUTO
         1 000514   000002 471500                    LDP1    2,,PR0
         1 000515   003100 060500                    CSL     bolr='003'O
         1 000516   100001 000044                    BDSC    1,,PR1                   by=0,bit=0,n=36
         1 000517   200017 000044                    BDSC    NEW_PRCW,,AUTO           by=0,bit=0,n=36

      963     5462    1       NEW_PRCW.PALIL='1'B;

   5462  1 000520   040000 236003                    LDQ     16384,DU
         1 000521   200017 256100                    ORSQ    NEW_PRCW,,AUTO

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:222  
      964     5463    1       CALL ZIM$JSET(RECVAR$,PRCW_EIS,NEW_PRCW);

   5463  1 000522   200017 631500                    EPPR1   NEW_PRCW,,AUTO
         1 000523   200024 451500                    STP1    NEW_PRCW+5,,AUTO
         1 000524   200016 633500                    EPPR3   PRCW_EIS,,AUTO
         1 000525   200023 453500                    STP3    NEW_PRCW+4,,AUTO
         1 000526   200011 634500                    EPPR4   RECVAR$,,AUTO
         1 000527   200022 454500                    STP4    NEW_PRCW+3,,AUTO
         1 000530   200022 630500                    EPPR0   NEW_PRCW+3,,AUTO
         1 000531   000001 631400 2                  EPPR1   1
         1 000532   000000 701000 xent               TSX1    ZIM$JSET
         1 000533   000000 011000                    NOP     0

      965     5464    1       RETURN;

   5464  1 000534   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   777777 600000   000003 000000                                    ........
      966     5465
      967     5466
      968     5467    1   END ZIM$JPA;
      969     5468        %EOD;

PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:223  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JPA.

   Procedure ZIM$JPA requires 349 words for executable code.
   Procedure ZIM$JPA requires 22 words of local(AUTO) storage.
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:224  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:225  
          MINI XREF LISTING

AC.DBLIM.LOWDBK
      1398**DCL      5360>>ASSIGN   5361>>ASSIGN
AC.DEF.ANL
      1377**DCL      1448--IMP-SIZ
AC.DEF.FORG
      1364**DCL      1368--REDEF
AC.LPP
      1401**DCL      5360>>ASSIGN   5361>>ASSIGN
AC$
      1360**DCL      1361--IMP-PTR  5354<<ASSIGN   5360>>ASSIGN   5360>>ASSIGN   5361>>ASSIGN   5361>>ASSIGN
ALTRTN
      5411**LABEL    5395--CALLALT  5407--CALLALT  5411--CALLALT
AWS.ATRIB.CJRNL
      2688**DCL      5404>>IF
AWS.ATRIB.TJRNL
      2690**DCL      5394>>IF
AWS.DDCB
      2709**DCL      5359>>ASSIGN
AWS$
      2683**DCL      2684--IMP-PTR  5359>>ASSIGN   5391<<ASSIGN   5394>>IF       5402<<ASSIGN   5404>>IF
B$ALT.CODE
      2991**DCL      2991--REDEF    2992--REDEF    2992--REDEF
B$ALT.ERR
      2992**DCL      5383>>ASSIGN
B$ALT.ERR.ERR#
      2993**DCL      2993--REDEF    5376>>IF
B$ALT.EVID
      2992**DCL      2992--REDEF    2992--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3695**DCL      3695--REDEF
B$JIT.ERR.MID
      3602**DCL      3602--REDEF
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:226  
B$JIT.JRESPEAK
      3763**DCL      3764--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      3872**DCL      3872--REDEF    3873--REDEF
B$JIT.PNR
      3776**DCL      3776--REDEF
B$JIT.TSLINE
      3870**DCL      3871--REDEF
B$JIT.USER
      3601**DCL      5358>>ASSIGN
B$JIT$
      5332**DCL      3596--IMP-PTR  5358>>ASSIGN
B$TCB.ALT$
      2987**DCL      5376>>IF       5383>>ASSIGN
B$TCB$
      5333**DCL      5376>>IF       5383>>ASSIGN
BERC.DCB#
      2873**DCL      2874--REDEF
COMMON_PA
      5351**PROC     5395--CALL     5407--CALL     5411--CALL
DBCB.IOWS.CFCT
      2600**DCL      2601--REDEF
DBCB.IOWS.DBKF.RQ
      2543**DCL      2544--REDEF
DBCB.IOWS.DBKR
      2540**DCL      2541--REDEF
DBCB.IOWS.NOBF
      2602**DCL      2603--REDEF
DBCB.IOWS.SPND
      2528**DCL      2529--REDEF
DBCB.PCB.RVO
      2378**DCL      5410>>ASSIGN   5448>>ASSIGN
DBCB.PCB.RVPA
      2382**DCL      5390>>ASSIGN   5401>>ASSIGN
DBCB.PCB.RVT
      2380**DCL      5424>>ASSIGN   5437>>ASSIGN   5458>>ASSIGN
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:227  
DBCB.PWS.NPOPTR
      2410**DCL      5440<>CALL
DBCB.PWS.PAOPTR
      2491**DCL      5427<>CALL     5429<>CALL     5439<>CALL
DBCB.PWS.PASPLT
      2484**DCL      5408>>IF
DBCB.SWS.RDYCW
      2266**DCL      2267--REDEF
DBCB.SWS.TEMP.PTR1$
      2300**DCL      2301--REDEF    2302--REDEF
DBCB.SWS.TEMP.PTR2$
      2303**DCL      2304--REDEF
DBCB$
      2171**DCL         6--MATRLIZ  2172--IMP-PTR  5390>>ASSIGN   5390>>ASSIGN   5401>>ASSIGN   5401>>ASSIGN
      5408>>IF       5410>>ASSIGN   5410>>ASSIGN   5424>>ASSIGN   5424>>ASSIGN   5427>>CALL     5429>>CALL
      5437>>ASSIGN   5437>>ASSIGN   5439>>CALL     5440>>CALL     5448>>ASSIGN   5448>>ASSIGN   5458>>ASSIGN
      5458>>ASSIGN
ERROR
      5334**DCL      5372<<ASSIGN   5377<<ASSIGN   5379<<ASSIGN   5389<<ASSIGN   5400<<ASSIGN   5416>>ASSIGN
ER_WRTT IN PROCEDURE COMMON_PA
      5371**LABEL    5367--CALLALT
FPT$TIME
      3039**DCL      5355<>CALL
FPT$WRTJ
      3014**DCL      5367<>CALL
FPT$WRTJ.BUF_.BOUND
      3014**DCL      5366<<ASSIGN
FPT$WRTJ.STATION_
      3016**DCL      3016--REDEF
FPT$WRTJ.V.DCB#
      3017**DCL      5371>>IF       5393<<ASSIGN   5406<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      3023**DCL      3023--REDEF
GLOBAL.ACTIVE.DBCB$
       502**DCL       503--REDEF
GLOBAL.ACTIVE.SSS$
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:228  
       498**DCL       499--REDEF
GLOBAL.CJRNL.DCB#
       691**DCL      5380>>ASSIGN   5381<<ASSIGN   5406>>ASSIGN
GLOBAL.JRECORD
       701**DCL      5353--ASSIGN
GLOBAL.KEY
       706**DCL       709--REDEF
GLOBAL.PARAN.TRACE.MODE
       581**DCL       588--REDEF
GLOBAL.PRINTBUF.BUFFER
       740**DCL       741--REDEF     742--REDEF     743--REDEF
GLOBAL.PRINTBUF.ERR.V
       745**DCL       748--REDEF     749--REDEF     750--REDEF
GLOBAL.RET.DCB#
       522**DCL      5373<<ASSIGN   5380<<ASSIGN
GLOBAL.RET.ERROR#
       516**DCL      5416<<ASSIGN
GLOBAL.RET.SYSERR#
       517**DCL      5383<<ASSIGN
GLOBAL.TIME.TSTAMP
       729**DCL      5357>>ASSIGN
GLOBAL.TIME$
       778**DCL      5355>>CALL
GLOBAL.TJRNL.DCB#
       685**DCL      5371>>IF       5373>>ASSIGN   5393>>ASSIGN
GLOBAL.WRTJ$
       776**DCL      5392>>ASSIGN   5403>>ASSIGN
GLOBAL$
       800**DCL       496--IMP-PTR  5353>>ASSIGN   5355>>CALL     5357>>ASSIGN   5371>>IF       5373>>ASSIGN
      5373>>ASSIGN   5380>>ASSIGN   5380>>ASSIGN   5381>>ASSIGN   5383>>ASSIGN   5392>>ASSIGN   5393>>ASSIGN
      5403>>ASSIGN   5406>>ASSIGN   5416>>ASSIGN
JREC
      2852**DCL      5366--ASSIGN
JREC.DCB#
      2856**DCL      5359<<ASSIGN
JREC.LENGTH
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:229  
      2858**DCL      2861--IMP-SIZ  5363<<ASSIGN   5364>>ASSIGN   5365>>ASSIGN   5366>>ASSIGN
JREC.LINE
      2859**DCL      5361<<ASSIGN
JREC.OFFSET
      2860**DCL      5362<<ASSIGN
JREC.PAGE
      2857**DCL      5360<<ASSIGN
JREC.TIME
      2853**DCL      5357<<ASSIGN
JREC.TYPE
      2854**DCL      5356<<ASSIGN
JREC.USER#
      2855**DCL      5358<<ASSIGN
JREC.VALUE
      2861**DCL      5365<<ASSIGN
JRNL$
      2831**DCL      2832--IMP-PTR  2852--IMP-PTR  2862--IMP-PTR  2869--IMP-PTR  2875--IMP-PTR  5353<<ASSIGN
      5356>>ASSIGN   5357>>ASSIGN   5358>>ASSIGN   5359>>ASSIGN   5360>>ASSIGN   5361>>ASSIGN   5362>>ASSIGN
      5363>>ASSIGN   5364>>ASSIGN   5365>>ASSIGN   5365>>ASSIGN   5366>>ASSIGN   5366>>ASSIGN
LENGTH
      5335**DCL      5336--IMP-SIZ  5364<<ASSIGN   5365>>ASSIGN
M$ERR
      2926**DCL-ENT  5417--CALL
M$TIME
      2981**DCL-ENT  5355--CALL
M$WRITE
      2915**DCL-ENT  5367--CALL
NEW_PRCW
      5341**DCL      5451<<ASSIGN   5453<>CALL     5461<<ASSIGN   5463<>CALL
NEW_PRCW.PAFIL
      5343**DCL      5452<<ASSIGN
NEW_PRCW.PALIL
      5344**DCL      5462<<ASSIGN
PA_REC.PRCW
      5348**DCL      5451>>ASSIGN   5461>>ASSIGN
PRCW_EIS
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:230  
      5338**DCL      5453<>CALL     5463<>CALL
PRCW_EIS.LENGTH
      5340**DCL      5449<<ASSIGN   5459<<ASSIGN
PRCW_EIS.OFFSET
      5339**DCL      5450<<ASSIGN   5460<<ASSIGN
RECORD
      5336**DCL      5365>>ASSIGN
RECVAR.ACPTR
      2669**DCL      5354>>ASSIGN
RECVAR.AWS$
      2675**DCL      5391>>ASSIGN   5402>>ASSIGN
RECVAR.BADDR
      2651**DCL      2654--REDEF
RECVAR.BADDR$
      2654**DCL      5362>>ASSIGN
RECVAR.DBKEY
      2650**DCL      5360>>ASSIGN   5361>>ASSIGN
RECVAR.RADDR
      2655**DCL      2659--REDEF
RECVAR.RADDR$
      2659**DCL      5362>>ASSIGN   5365>>ASSIGN   5451>>ASSIGN   5461>>ASSIGN
RECVAR.RECSZ
      2660**DCL      5363>>ASSIGN
RECVAR.RSPTR
      2668**DCL      5425>>ASSIGN   5438>>ASSIGN
RECVAR$
      5330**DCL      2649--IMP-PTR  5354>>ASSIGN   5360>>ASSIGN   5361>>ASSIGN   5362>>ASSIGN   5362>>ASSIGN
      5363>>ASSIGN   5365>>ASSIGN   5390<<ASSIGN   5391>>ASSIGN   5401<<ASSIGN   5402>>ASSIGN   5410<<ASSIGN
      5424<<ASSIGN   5425>>ASSIGN   5427<>CALL     5429<>CALL     5437<<ASSIGN   5438>>ASSIGN   5439<>CALL
      5440<>CALL     5448<<ASSIGN   5451>>ASSIGN   5453<>CALL     5458<<ASSIGN   5461>>ASSIGN   5463<>CALL
RS.CSPAH.EIS
      1490**DCL      5429<>CALL     5439<>CALL
RS.DEF.MEMT
      1462**DCL      5426>>IF
RS.HPOS.EIS
      1508**DCL      5427<>CALL     5440<>CALL
PL6.E3A0      #007=ZIM$JPA File=ZIM$JRNL.:ZIC0TSI                                FRI 09/05/97 13:01 Page:231  
RS.NPOS
      1480**DCL      1489--REDEF
RS$
      1454**DCL      1455--IMP-PTR  5425<<ASSIGN   5426>>IF       5427>>CALL     5429>>CALL     5438<<ASSIGN
      5439>>CALL     5440>>CALL
SSS$
       815**DCL         6--MATRLIZ  5354>>ASSIGN   5425>>ASSIGN   5438>>ASSIGN
WRTJ$
      5331**DCL      3014--IMP-PTR  5366>>ASSIGN   5367>>CALL     5371>>IF       5392<<ASSIGN   5393>>ASSIGN
      5403<<ASSIGN   5406>>ASSIGN
ZIM$JSET
      5349**DCL-ENT  5427--CALL     5429--CALL     5439--CALL     5440--CALL     5453--CALL     5463--CALL

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:232  
      970        1        /*T***********************************************************/
      971        2        /*T*                                                         */
      972        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      973        4        /*T*                                                         */
      974        5        /*T***********************************************************/
      975        6        ZIM$JISTO: PROC
      976        7               AVOID($PR5,$PR6,$PR7);
      977        8        %INCLUDE ZI$GLOBAL;
      978      494            %GLOBALS;
      979      802        %INCLUDE ZI$SSS;
      980     1351            %AC;
      981     1446        %INCLUDE ZI$DBCB;
      982     2088            %DBCB;
      983     2566            %RECVAR(STCLASS="BASED(RECVAR$)");
      984     2600            %AWS;
      985     2640            %CRUNI;
      986     2645        %INCLUDE ZI$JRNL;
      987     2753            %JRNL_REC(STCLASS=AUTO);
      988     2828        %INCLUDE CP_6;
      989     2909            %B$TCB;
      990     2912            %F$DCB;
      991     2969            %B$ALT;
      992     2977            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      993     3008            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      994     3027        %INCLUDE CP_6_SUBS;
      995     3567        %INCLUDE B$JIT;
      996     3857        %INCLUDE ZI_ERRORS_C;
      997     4183        %INCLUDE B_ERRORS_C;
      998     5310    1   DCL RECVAR$ PTR;
      999     5311    1   DCL WRTJ$ PTR;
     1000     5312    1   DCL B$JIT$ PTR SYMREF;
     1001     5313    1   DCL B$TCB$ PTR SYMREF;
     1002     5314    1   DCL ERROR UBIN(36);
     1003     5315    1   DCL TYPE UBIN(36);
     1004     5316    1   DCL LENGTH UBIN(36);
     1005     5317    1   DCL KEYX# UBIN(18);
     1006     5318    1   DCL RECORD CHAR(LENGTH) BASED CALIGNED;
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:233  
     1007     5319    1       TYPE=T#ISTO;
     1008     5320    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);
     1009     5321    1       GOTO COM;
     1010     5322    1   ZIM$JIDEL: ENTRY;
     1011     5323    1       TYPE=T#IDEL;
     1012     5324    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVI);
     1013     5325    1       GOTO COM;
     1014     5326    1   ZIM$JIMOD: ENTRY;
     1015     5327    1       TYPE=T#IMOD;
     1016     5328    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);
     1017     5329    1   COM: ERROR=0;
     1018     5330    1       DBCB$=GLOBAL.ACTIVE.DBCB$;
     1019     5331    1       SSS$=GLOBAL.ACTIVE.SSS$;
     1020     5332    1       AWS$=RECVAR.AWS$;
     1021     5333    1       IF ~GLOBAL.PENDING.ROLL AND
     1022     5334    2          (AWS.ATRIB.TJRNL OR AWS.ATRIB.CJRNL) THEN DO;
     1023     5335    2           JRNL$=ADDR(GLOBAL.JRECORD);
     1024     5336    2           WRTJ$=GLOBAL.WRTJ$;
     1025     5337    2           AC$=PINCRW(SSS$,RECVAR.ACPTR);
     1026     5338    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);
     1027     5339    2           JREC.TYPE=TYPE;
     1028     5340    2           JREC.TIME=GLOBAL.TIME.TSTAMP;
     1029     5341    2           JREC.USER#=B$JIT$->B$JIT.USER;
     1030     5342    2           JREC.DCB#=AWS.DDCB;
     1031     5343    2           JREC.PAGE=0;
     1032     5344    2           JREC.LINE=0;
     1033     5345    2           JREC.OFFSET=0;
     1034     5346    3           IF TYPE=T#ISTO THEN DO;
     1035     5347    4               IF AWS.ATRIB.TJRNL THEN DO;
     1036     5348    4                   LENGTH=DCBADDR(AWS.DDCB)->F$DCB.KEYL#;
     1037     5349    4                   KEYX#=DCBADDR(AWS.DDCB)->F$DCB.KEYX#;
     1038     5350    4                   JREC.LENGTH=LENGTH;
     1039     5351    4                   JREC.VALUE=SUBSTR(RECVAR.RADDR$->RECORD,KEYX#,LENGTH);
     1040     5352    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
     1041     5353    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
     1042     5354    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
     1043     5355    4                   END;
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:234  
     1044     5356    4               IF AWS.ATRIB.CJRNL THEN DO;
     1045     5357    4                   LENGTH=RECVAR.RECSZ;
     1046     5358    4                   JREC.LENGTH=LENGTH;
     1047     5359    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
     1048     5360    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
     1049     5361    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
     1050     5362    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
     1051     5363    4                   END;
     1052     5364    3               END;
     1053     5365    3           IF TYPE=T#IDEL THEN DO;
     1054     5366    4               IF AWS.ATRIB.TJRNL THEN DO;
     1055     5367    4                   LENGTH=RECVAR.RECSZ;
     1056     5368    4                   JREC.LENGTH=LENGTH;
     1057     5369    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
     1058     5370    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
     1059     5371    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
     1060     5372    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
     1061     5373    4                   END;
     1062     5374    4               IF AWS.ATRIB.CJRNL THEN DO;
     1063     5375    4                   LENGTH=DCBADDR(AWS.DDCB)->F$DCB.KEYL#;
     1064     5376    4                   KEYX#=DCBADDR(AWS.DDCB)->F$DCB.KEYX#;
     1065     5377    4                   JREC.LENGTH=LENGTH;
     1066     5378    4                   JREC.VALUE=SUBSTR(RECVAR.RADDR$->RECORD,KEYX#,LENGTH);
     1067     5379    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
     1068     5380    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
     1069     5381    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
     1070     5382    4                   END;
     1071     5383    3               END;
     1072     5384    3           IF TYPE=T#IMOD THEN DO;
     1073     5385    4               IF AWS.ATRIB.TJRNL THEN DO;
     1074     5386    4                   RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVI);
     1075     5387    4                   LENGTH=RECVAR.RECSZ;
     1076     5388    4                   JREC.LENGTH=LENGTH;
     1077     5389    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
     1078     5390    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
     1079     5391    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;
     1080     5392    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:235  
     1081     5393    4                   END;
     1082     5394    4               IF AWS.ATRIB.CJRNL THEN DO;
     1083     5395    4                   RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);
     1084     5396    4                   LENGTH=RECVAR.RECSZ;
     1085     5397    4                   JREC.LENGTH=LENGTH;
     1086     5398    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;
     1087     5399    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);
     1088     5400    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;
     1089     5401    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);
     1090     5402    4                   END;
     1091     5403    3               END;
     1092     5404    2           END;
     1093     5405    1       RETURN;
     1094     5406    1   ER_WRTT: ERROR=ERR#IO#WRTT;
     1095     5407    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1096     5408    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;
     1097     5409    1       GOTO ALT;
     1098     5410    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN
     1099     5411    1           ERROR=ERR#IO#NOOWNER;
     1100     5412    1       ELSE
     1101     5413    1           ERROR=ERR#IO#WRTC;
     1102     5414    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1103     5415    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;
     1104     5416    1       GLOBAL.CJRNL.DCB#=0;
     1105     5417    1       GOTO ALT;
     1106     5418    1   ALT: ;
     1107     5419    1       GLOBAL.RET.ERROR#=ERROR;
     1108     5420    1       CALL M$ERR;
     1109     5421    1   END ZIM$JISTO;

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:236  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JISTO.

   Procedure ZIM$JISTO requires 368 words for executable code.
   Procedure ZIM$JISTO requires 14 words of local(AUTO) storage.

    No errors detected in file ZIM$JRNL.:ZIC0TSI    .

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:237  

 Object Unit name= ZIM$JISTO                                  File name= ZIM$JRNL.:ZIC0TOU
 UTS= SEP 05 '97 13:01:20.68 FRI                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   368    560  ZIM$JISTO
    2  RoData even  none     2      2  ZIM$JISTO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      XStd       0  ZIM$JISTO
     1     12                  yes      XStd       0  ZIM$JIDEL
     1     24                  yes      XStd       0  ZIM$JIMOD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    GLOBAL$                               M$UC                                  B$JIT$
     B$TCB$
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:238  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:239  


      970        1        /*T***********************************************************/
      971        2        /*T*                                                         */
      972        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      973        4        /*T*                                                         */
      974        5        /*T***********************************************************/
      975        6        ZIM$JISTO: PROC

      6  1 000000   000000 700200 xent  ZIM$JISTO    TSX0  ! X66_AUTO_0
         1 000001   000016 000000                    ZERO    14,0

      976        7               AVOID($PR5,$PR6,$PR7);
      977        8        %INCLUDE ZI$GLOBAL;
      978      494            %GLOBALS;
      979      802        %INCLUDE ZI$SSS;
      980     1351            %AC;
      981     1446        %INCLUDE ZI$DBCB;
      982     2088            %DBCB;
      983     2566            %RECVAR(STCLASS="BASED(RECVAR$)");
      984     2600            %AWS;
      985     2640            %CRUNI;
      986     2645        %INCLUDE ZI$JRNL;
      987     2753            %JRNL_REC(STCLASS=AUTO);
      988     2828        %INCLUDE CP_6;
      989     2909            %B$TCB;
      990     2912            %F$DCB;
      991     2969            %B$ALT;
      992     2977            %FPT_WRITE(FPTN=FPT$WRTJ,STCLASS="BASED(WRTJ$)");
      993     3008            %FPT_TIME(FPTN=FPT$TIME,STCLASS=BASED);
      994     3027        %INCLUDE CP_6_SUBS;
      995     3567        %INCLUDE B$JIT;
      996     3857        %INCLUDE ZI_ERRORS_C;
      997     4183        %INCLUDE B_ERRORS_C;
      998     5310    1   DCL RECVAR$ PTR;
      999     5311    1   DCL WRTJ$ PTR;
     1000     5312    1   DCL B$JIT$ PTR SYMREF;
     1001     5313    1   DCL B$TCB$ PTR SYMREF;
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:240  
     1002     5314    1   DCL ERROR UBIN(36);
     1003     5315    1   DCL TYPE UBIN(36);
     1004     5316    1   DCL LENGTH UBIN(36);
     1005     5317    1   DCL KEYX# UBIN(18);
     1006     5318    1   DCL RECORD CHAR(LENGTH) BASED CALIGNED;
     1007     5319    1       TYPE=T#ISTO;

   5319  1 000002   000020 235007                    LDA     16,DL
         1 000003   200013 755100                    STA     TYPE,,AUTO

     1008     5320    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);

   5320  1 000004   000000 470400 xsym               LDP0    GLOBAL$
         1 000005   000001 471500                    LDP1    1,,PR0
         1 000006   100512 220100                    LDX0    330,,PR1
         1 000007   100000 633510                    EPPR3   0,X0,PR1
         1 000010   200010 453500                    STP3    RECVAR$,,AUTO

     1009     5321    1       GOTO COM;

   5321  1 000011   000035 710000 1                  TRA     COM

     1010     5322    1   ZIM$JIDEL: ENTRY;

   5322  1 000012   000000 700200 xent  ZIM$JIDEL    TSX0  ! X66_AUTO_0
         1 000013   000016 000000                    ZERO    14,0

     1011     5323    1       TYPE=T#IDEL;

   5323  1 000014   000021 235007                    LDA     17,DL
         1 000015   200013 755100                    STA     TYPE,,AUTO

     1012     5324    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVI);

   5324  1 000016   000000 470400 xsym               LDP0    GLOBAL$
         1 000017   000001 471500                    LDP1    1,,PR0
         1 000020   100510 220100                    LDX0    328,,PR1
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:241  
         1 000021   100000 633510                    EPPR3   0,X0,PR1
         1 000022   200010 453500                    STP3    RECVAR$,,AUTO

     1013     5325    1       GOTO COM;

   5325  1 000023   000035 710000 1                  TRA     COM

     1014     5326    1   ZIM$JIMOD: ENTRY;

   5326  1 000024   000000 700200 xent  ZIM$JIMOD    TSX0  ! X66_AUTO_0
         1 000025   000016 000000                    ZERO    14,0

     1015     5327    1       TYPE=T#IMOD;

   5327  1 000026   000022 235007                    LDA     18,DL
         1 000027   200013 755100                    STA     TYPE,,AUTO

     1016     5328    1       RECVAR$=PINCRW(GLOBAL.ACTIVE.DBCB$,GLOBAL.ACTIVE.DBCB$->DBCB.PCB.RVT);

   5328  1 000030   000000 470400 xsym               LDP0    GLOBAL$
         1 000031   000001 471500                    LDP1    1,,PR0
         1 000032   100512 220100                    LDX0    330,,PR1
         1 000033   100000 633510                    EPPR3   0,X0,PR1
         1 000034   200010 453500                    STP3    RECVAR$,,AUTO

     1017     5329    1   COM: ERROR=0;

   5329  1 000035   200012 450100       COM          STZ     ERROR,,AUTO

     1018     5330    1       DBCB$=GLOBAL.ACTIVE.DBCB$;

   5330  1 000036   000001 236100                    LDQ     1,,PR0
         1 000037   200005 756100                    STQ     DBCB$,,AUTO

     1019     5331    1       SSS$=GLOBAL.ACTIVE.SSS$;

   5331  1 000040   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:242  
         1 000041   200003 756100                    STQ     SSS$,,AUTO

     1020     5332    1       AWS$=RECVAR.AWS$;

   5332  1 000042   300013 236100                    LDQ     11,,PR3
         1 000043   200006 756100                    STQ     AWS$,,AUTO

     1021     5333    1       IF ~GLOBAL.PENDING.ROLL AND

   5333  1 000044   000017 236100                    LDQ     15,,PR0
         1 000045   000010 736000                    QLS     8
         1 000046   400000 376003                    ANQ     -131072,DU
         1 000047   400000 676003                    ERQ     -131072,DU
         1 000050   000517 600000 1                  TZE     s:5405
         1 000051   200006 474500                    LDP4    AWS$,,AUTO
         1 000052   400000 236100                    LDQ     0,,PR4
         1 000053   020000 316003                    CANQ    8192,DU
         1 000054   000057 601000 1                  TNZ     s:5335
         1 000055   100000 316003                    CANQ    32768,DU
         1 000056   000517 600000 1                  TZE     s:5405

     1022     5334    2          (AWS.ATRIB.TJRNL OR AWS.ATRIB.CJRNL) THEN DO;

     1023     5335    2           JRNL$=ADDR(GLOBAL.JRECORD);

   5335  1 000057   000000 236000 xsym               LDQ     GLOBAL$
         1 000060   002622 036003                    ADLQ    1426,DU
         1 000061   200007 756100                    STQ     JRNL$,,AUTO

     1024     5336    2           WRTJ$=GLOBAL.WRTJ$;

   5336  1 000062   005115 236100                    LDQ     2637,,PR0
         1 000063   200011 756100                    STQ     WRTJ$,,AUTO

     1025     5337    2           AC$=PINCRW(SSS$,RECVAR.ACPTR);

   5337  1 000064   300005 220100                    LDX0    5,,PR3
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:243  
         1 000065   000000 636010                    EAQ     0,X0
         1 000066   200003 036100                    ADLQ    SSS$,,AUTO
         1 000067   200004 756100                    STQ     AC$,,AUTO

     1026     5338    2           CALL M$TIME(GLOBAL.TIME$->FPT$TIME);

   5338  1 000070   005117 471500                    LDP1    2639,,PR0
         1 000071   100000 630500                    EPPR0   0,,PR1
         1 000072   020004 713400                    CLIMB   8196
         1 000073   402000 401760                    pmme    nvectors=5

     1027     5339    2           JREC.TYPE=TYPE;

   5339  1 000074   200007 470500                    LDP0    JRNL$,,AUTO
         1 000075   200013 236100                    LDQ     TYPE,,AUTO
         1 000076   000033 736000                    QLS     27
         1 000077   000001 552140                    STBQ    1,'40'O,PR0

     1028     5340    2           JREC.TIME=GLOBAL.TIME.TSTAMP;

   5340  1 000100   000000 471400 xsym               LDP1    GLOBAL$
         1 000101   105001 235100                    LDA     2561,,PR1
         1 000102   000000 755100                    STA     0,,PR0

     1029     5341    2           JREC.USER#=B$JIT$->B$JIT.USER;

   5341  1 000103   000000 473400 xsym               LDP3    B$JIT$
         1 000104   300000 236100                    LDQ     0,,PR3
         1 000105   000001 552120                    STBQ    1,'20'O,PR0

     1030     5342    2           JREC.DCB#=AWS.DDCB;

   5342  1 000106   200006 474500                    LDP4    AWS$,,AUTO
         1 000107   400006 220100                    LDX0    6,,PR4
         1 000110   000001 440100                    SXL0    1,,PR0

     1031     5343    2           JREC.PAGE=0;
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:244  

   5343  1 000111   000002 450100                    STZ     2,,PR0

     1032     5344    2           JREC.LINE=0;

   5344  1 000112   000000 221003                    LDX1    0,DU
         1 000113   000003 441100                    SXL1    3,,PR0

     1033     5345    2           JREC.OFFSET=0;

   5345  1 000114   000004 741100                    STX1    4,,PR0

     1034     5346    3           IF TYPE=T#ISTO THEN DO;

   5346  1 000115   200013 236100                    LDQ     TYPE,,AUTO
         1 000116   000020 116007                    CMPQ    16,DL
         1 000117   000245 601000 1                  TNZ     s:5365

     1035     5347    4               IF AWS.ATRIB.TJRNL THEN DO;

   5347  1 000120   400000 236100                    LDQ     0,,PR4
         1 000121   020000 316003                    CANQ    8192,DU
         1 000122   000201 600000 1                  TZE     s:5356

     1036     5348    4                   LENGTH=DCBADDR(AWS.DDCB)->F$DCB.KEYL#;

   5348  1 000123   000000 470400 2                  LDP0    0
         1 000124   000000 471500                    LDP1    0,,PR0
         1 000125   400006 220100                    LDX0    6,,PR4
         1 000126   100000 470510                    LDP0    0,X0,PR1
         1 000127   000036 236100                    LDQ     30,,PR0
         1 000130   000011 772000                    QRL     9
         1 000131   000777 376007                    ANQ     511,DL
         1 000132   200014 756100                    STQ     LENGTH,,AUTO

     1037     5349    4                   KEYX#=DCBADDR(AWS.DDCB)->F$DCB.KEYX#;

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:245  
   5349  1 000133   000000 470400 2                  LDP0    0
         1 000134   000000 471500                    LDP1    0,,PR0
         1 000135   100000 470510                    LDP0    0,X0,PR1
         1 000136   000036 222100                    LDX2    30,,PR0
         1 000137   200015 742100                    STX2    KEYX#,,AUTO

     1038     5350    4                   JREC.LENGTH=LENGTH;

   5350  1 000140   000000 623006                    EAX3    0,QL
         1 000141   200007 470500                    LDP0    JRNL$,,AUTO
         1 000142   000003 743100                    STX3    3,,PR0

     1039     5351    4                   JREC.VALUE=SUBSTR(RECVAR.RADDR$->RECORD,KEYX#,LENGTH);

   5351  1 000143   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000144   100002 470500                    LDP0    2,,PR1
         1 000145   200014 720100                    LXL0    LENGTH,,AUTO
         1 000146   200015 235100                    LDA     KEYX#,,AUTO
         1 000147   000022 771000                    ARL     18
         1 000150   200007 471500                    LDP1    JRNL$,,AUTO
         1 000151   040140 100545                    MLR     fill='040'O
         1 000152   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         1 000153   100004 400013                    ADSC9   4,,PR1                   cn=2,n=*X3

     1040     5352    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5352  1 000154   100003 223100                    LDX3    3,,PR1
         1 000155   000022 624013                    EAX4    18,X3
         1 000156   000000 636014                    EAQ     0,X4
         1 000157   000022 772000                    QRL     18
         1 000160   000011 402007                    MPY     9,DL
         1 000161   000043 036007                    ADLQ    35,DL
         1 000162   000044 506007                    DIV     36,DL
         1 000163   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000164   000002 736000                    QLS     2
         1 000165   000001 136007                    SBLQ    1,DL
         1 000166   000020 736000                    QLS     16
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:246  
         1 000167   000004 676100                    ERQ     4,,PR0
         1 000170   000001 376000 2                  ANQ     1
         1 000171   000004 656100                    ERSQ    4,,PR0

     1041     5353    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5353  1 000172   000000 470400 xsym               LDP0    GLOBAL$
         1 000173   002604 723100                    LXL3    1412,,PR0
         1 000174   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000175   000010 743100                    STX3    8,,PR0

     1042     5354    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5354  1 000176   440001 713400                    CLIMB   alt,write
         1 000177   401400 401760                    pmme    nvectors=4
         1 000200   000520 702000 1                  TSX2    ER_WRTT

     1043     5355    4                   END;

     1044     5356    4               IF AWS.ATRIB.CJRNL THEN DO;

   5356  1 000201   200006 470500                    LDP0    AWS$,,AUTO
         1 000202   000000 236100                    LDQ     0,,PR0
         1 000203   100000 316003                    CANQ    32768,DU
         1 000204   000245 600000 1                  TZE     s:5365

     1045     5357    4                   LENGTH=RECVAR.RECSZ;

   5357  1 000205   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000206   100003 236100                    LDQ     3,,PR1
         1 000207   000022 772000                    QRL     18
         1 000210   200014 756100                    STQ     LENGTH,,AUTO

     1046     5358    4                   JREC.LENGTH=LENGTH;

   5358  1 000211   000000 620006                    EAX0    0,QL
         1 000212   200007 473500                    LDP3    JRNL$,,AUTO
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:247  
         1 000213   300003 740100                    STX0    3,,PR3

     1047     5359    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5359  1 000214   100002 474500                    LDP4    2,,PR1
         1 000215   200014 721100                    LXL1    LENGTH,,AUTO
         1 000216   040140 100540                    MLR     fill='040'O
         1 000217   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         1 000220   300004 400010                    ADSC9   4,,PR3                   cn=2,n=*X0

     1048     5360    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5360  1 000221   000022 622010                    EAX2    18,X0
         1 000222   000000 636012                    EAQ     0,X2
         1 000223   000022 772000                    QRL     18
         1 000224   000011 402007                    MPY     9,DL
         1 000225   000043 036007                    ADLQ    35,DL
         1 000226   000044 506007                    DIV     36,DL
         1 000227   200011 474500                    LDP4    WRTJ$,,AUTO
         1 000230   000002 736000                    QLS     2
         1 000231   000001 136007                    SBLQ    1,DL
         1 000232   000020 736000                    QLS     16
         1 000233   400004 676100                    ERQ     4,,PR4
         1 000234   000001 376000 2                  ANQ     1
         1 000235   400004 656100                    ERSQ    4,,PR4

     1049     5361    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5361  1 000236   000000 470400 xsym               LDP0    GLOBAL$
         1 000237   002610 720100                    LXL0    1416,,PR0
         1 000240   400010 740100                    STX0    8,,PR4

     1050     5362    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   5362  1 000241   400000 630500                    EPPR0   0,,PR4
         1 000242   440001 713400                    CLIMB   alt,write
         1 000243   401400 401760                    pmme    nvectors=4
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:248  
         1 000244   000532 702000 1                  TSX2    ER_WRTC

     1051     5363    4                   END;

     1052     5364    3               END;

     1053     5365    3           IF TYPE=T#IDEL THEN DO;

   5365  1 000245   200013 235100                    LDA     TYPE,,AUTO
         1 000246   000021 115007                    CMPA    17,DL
         1 000247   000372 601000 1                  TNZ     s:5384

     1054     5366    4               IF AWS.ATRIB.TJRNL THEN DO;

   5366  1 000250   200006 470500                    LDP0    AWS$,,AUTO
         1 000251   000000 236100                    LDQ     0,,PR0
         1 000252   020000 316003                    CANQ    8192,DU
         1 000253   000314 600000 1                  TZE     s:5374

     1055     5367    4                   LENGTH=RECVAR.RECSZ;

   5367  1 000254   200010 471500                    LDP1    RECVAR$,,AUTO
         1 000255   100003 236100                    LDQ     3,,PR1
         1 000256   000022 772000                    QRL     18
         1 000257   200014 756100                    STQ     LENGTH,,AUTO

     1056     5368    4                   JREC.LENGTH=LENGTH;

   5368  1 000260   000000 620006                    EAX0    0,QL
         1 000261   200007 473500                    LDP3    JRNL$,,AUTO
         1 000262   300003 740100                    STX0    3,,PR3

     1057     5369    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5369  1 000263   100002 474500                    LDP4    2,,PR1
         1 000264   200014 721100                    LXL1    LENGTH,,AUTO
         1 000265   040140 100540                    MLR     fill='040'O
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:249  
         1 000266   400000 000011                    ADSC9   0,,PR4                   cn=0,n=*X1
         1 000267   300004 400010                    ADSC9   4,,PR3                   cn=2,n=*X0

     1058     5370    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5370  1 000270   000022 622010                    EAX2    18,X0
         1 000271   000000 636012                    EAQ     0,X2
         1 000272   000022 772000                    QRL     18
         1 000273   000011 402007                    MPY     9,DL
         1 000274   000043 036007                    ADLQ    35,DL
         1 000275   000044 506007                    DIV     36,DL
         1 000276   200011 474500                    LDP4    WRTJ$,,AUTO
         1 000277   000002 736000                    QLS     2
         1 000300   000001 136007                    SBLQ    1,DL
         1 000301   000020 736000                    QLS     16
         1 000302   400004 676100                    ERQ     4,,PR4
         1 000303   000001 376000 2                  ANQ     1
         1 000304   400004 656100                    ERSQ    4,,PR4

     1059     5371    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5371  1 000305   000000 470400 xsym               LDP0    GLOBAL$
         1 000306   002604 720100                    LXL0    1412,,PR0
         1 000307   400010 740100                    STX0    8,,PR4

     1060     5372    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5372  1 000310   400000 630500                    EPPR0   0,,PR4
         1 000311   440001 713400                    CLIMB   alt,write
         1 000312   401400 401760                    pmme    nvectors=4
         1 000313   000520 702000 1                  TSX2    ER_WRTT

     1061     5373    4                   END;

     1062     5374    4               IF AWS.ATRIB.CJRNL THEN DO;

   5374  1 000314   200006 470500                    LDP0    AWS$,,AUTO
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:250  
         1 000315   000000 236100                    LDQ     0,,PR0
         1 000316   100000 316003                    CANQ    32768,DU
         1 000317   000372 600000 1                  TZE     s:5384

     1063     5375    4                   LENGTH=DCBADDR(AWS.DDCB)->F$DCB.KEYL#;

   5375  1 000320   000000 471400 2                  LDP1    0
         1 000321   100000 473500                    LDP3    0,,PR1
         1 000322   000006 220100                    LDX0    6,,PR0
         1 000323   300000 474510                    LDP4    0,X0,PR3
         1 000324   400036 236100                    LDQ     30,,PR4
         1 000325   000011 772000                    QRL     9
         1 000326   000777 376007                    ANQ     511,DL
         1 000327   200014 756100                    STQ     LENGTH,,AUTO

     1064     5376    4                   KEYX#=DCBADDR(AWS.DDCB)->F$DCB.KEYX#;

   5376  1 000330   400036 221100                    LDX1    30,,PR4
         1 000331   200015 741100                    STX1    KEYX#,,AUTO

     1065     5377    4                   JREC.LENGTH=LENGTH;

   5377  1 000332   000000 622006                    EAX2    0,QL
         1 000333   200007 470500                    LDP0    JRNL$,,AUTO
         1 000334   000003 742100                    STX2    3,,PR0

     1066     5378    4                   JREC.VALUE=SUBSTR(RECVAR.RADDR$->RECORD,KEYX#,LENGTH);

   5378  1 000335   200010 474500                    LDP4    RECVAR$,,AUTO
         1 000336   400002 470500                    LDP0    2,,PR4
         1 000337   200014 720100                    LXL0    LENGTH,,AUTO
         1 000340   200015 235100                    LDA     KEYX#,,AUTO
         1 000341   000022 771000                    ARL     18
         1 000342   200007 471500                    LDP1    JRNL$,,AUTO
         1 000343   040140 100545                    MLR     fill='040'O
         1 000344   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         1 000345   100004 400012                    ADSC9   4,,PR1                   cn=2,n=*X2
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:251  

     1067     5379    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5379  1 000346   100003 222100                    LDX2    3,,PR1
         1 000347   000022 623012                    EAX3    18,X2
         1 000350   000000 636013                    EAQ     0,X3
         1 000351   000022 772000                    QRL     18
         1 000352   000011 402007                    MPY     9,DL
         1 000353   000043 036007                    ADLQ    35,DL
         1 000354   000044 506007                    DIV     36,DL
         1 000355   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000356   000002 736000                    QLS     2
         1 000357   000001 136007                    SBLQ    1,DL
         1 000360   000020 736000                    QLS     16
         1 000361   000004 676100                    ERQ     4,,PR0
         1 000362   000001 376000 2                  ANQ     1
         1 000363   000004 656100                    ERSQ    4,,PR0

     1068     5380    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5380  1 000364   000000 473400 xsym               LDP3    GLOBAL$
         1 000365   302610 722100                    LXL2    1416,,PR3
         1 000366   000010 742100                    STX2    8,,PR0

     1069     5381    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   5381  1 000367   440001 713400                    CLIMB   alt,write
         1 000370   401400 401760                    pmme    nvectors=4
         1 000371   000532 702000 1                  TSX2    ER_WRTC

     1070     5382    4                   END;

     1071     5383    3               END;

     1072     5384    3           IF TYPE=T#IMOD THEN DO;

   5384  1 000372   200013 235100                    LDA     TYPE,,AUTO
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:252  
         1 000373   000022 115007                    CMPA    18,DL
         1 000374   000517 601000 1                  TNZ     s:5405

     1073     5385    4               IF AWS.ATRIB.TJRNL THEN DO;

   5385  1 000375   200006 470500                    LDP0    AWS$,,AUTO
         1 000376   000000 236100                    LDQ     0,,PR0
         1 000377   020000 316003                    CANQ    8192,DU
         1 000400   000446 600000 1                  TZE     s:5394

     1074     5386    4                   RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVI);

   5386  1 000401   200005 471500                    LDP1    DBCB$,,AUTO
         1 000402   100510 220100                    LDX0    328,,PR1
         1 000403   000000 636010                    EAQ     0,X0
         1 000404   200005 036100                    ADLQ    DBCB$,,AUTO
         1 000405   200010 756100                    STQ     RECVAR$,,AUTO

     1075     5387    4                   LENGTH=RECVAR.RECSZ;

   5387  1 000406   200010 473500                    LDP3    RECVAR$,,AUTO
         1 000407   300003 236100                    LDQ     3,,PR3
         1 000410   000022 772000                    QRL     18
         1 000411   200014 756100                    STQ     LENGTH,,AUTO

     1076     5388    4                   JREC.LENGTH=LENGTH;

   5388  1 000412   000000 621006                    EAX1    0,QL
         1 000413   200007 474500                    LDP4    JRNL$,,AUTO
         1 000414   400003 741100                    STX1    3,,PR4

     1077     5389    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5389  1 000415   300002 470500                    LDP0    2,,PR3
         1 000416   200014 720100                    LXL0    LENGTH,,AUTO
         1 000417   040140 100540                    MLR     fill='040'O
         1 000420   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:253  
         1 000421   400004 400011                    ADSC9   4,,PR4                   cn=2,n=*X1

     1078     5390    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5390  1 000422   000022 622011                    EAX2    18,X1
         1 000423   000000 636012                    EAQ     0,X2
         1 000424   000022 772000                    QRL     18
         1 000425   000011 402007                    MPY     9,DL
         1 000426   000043 036007                    ADLQ    35,DL
         1 000427   000044 506007                    DIV     36,DL
         1 000430   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000431   000002 736000                    QLS     2
         1 000432   000001 136007                    SBLQ    1,DL
         1 000433   000020 736000                    QLS     16
         1 000434   000004 676100                    ERQ     4,,PR0
         1 000435   000001 376000 2                  ANQ     1
         1 000436   000004 656100                    ERSQ    4,,PR0

     1079     5391    4                   FPT$WRTJ.V.DCB#=GLOBAL.TJRNL.DCB#;

   5391  1 000437   000000 470400 xsym               LDP0    GLOBAL$
         1 000440   002604 721100                    LXL1    1412,,PR0
         1 000441   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000442   000010 741100                    STX1    8,,PR0

     1080     5392    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTT);

   5392  1 000443   440001 713400                    CLIMB   alt,write
         1 000444   401400 401760                    pmme    nvectors=4
         1 000445   000520 702000 1                  TSX2    ER_WRTT

     1081     5393    4                   END;

     1082     5394    4               IF AWS.ATRIB.CJRNL THEN DO;

   5394  1 000446   200006 470500                    LDP0    AWS$,,AUTO
         1 000447   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:254  
         1 000450   100000 316003                    CANQ    32768,DU
         1 000451   000517 600000 1                  TZE     s:5405

     1083     5395    4                   RECVAR$=PINCRW(DBCB$,DBCB.PCB.RVT);

   5395  1 000452   200005 471500                    LDP1    DBCB$,,AUTO
         1 000453   100512 220100                    LDX0    330,,PR1
         1 000454   000000 636010                    EAQ     0,X0
         1 000455   200005 036100                    ADLQ    DBCB$,,AUTO
         1 000456   200010 756100                    STQ     RECVAR$,,AUTO

     1084     5396    4                   LENGTH=RECVAR.RECSZ;

   5396  1 000457   200010 473500                    LDP3    RECVAR$,,AUTO
         1 000460   300003 236100                    LDQ     3,,PR3
         1 000461   000022 772000                    QRL     18
         1 000462   200014 756100                    STQ     LENGTH,,AUTO

     1085     5397    4                   JREC.LENGTH=LENGTH;

   5397  1 000463   000000 621006                    EAX1    0,QL
         1 000464   200007 474500                    LDP4    JRNL$,,AUTO
         1 000465   400003 741100                    STX1    3,,PR4

     1086     5398    4                   JREC.VALUE=RECVAR.RADDR$->RECORD;

   5398  1 000466   300002 470500                    LDP0    2,,PR3
         1 000467   200014 720100                    LXL0    LENGTH,,AUTO
         1 000470   040140 100540                    MLR     fill='040'O
         1 000471   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         1 000472   400004 400011                    ADSC9   4,,PR4                   cn=2,n=*X1

     1087     5399    4                   FPT$WRTJ.BUF_.BOUND=SIZEV(JREC);

   5399  1 000473   000022 622011                    EAX2    18,X1
         1 000474   000000 636012                    EAQ     0,X2
         1 000475   000022 772000                    QRL     18
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:255  
         1 000476   000011 402007                    MPY     9,DL
         1 000477   000043 036007                    ADLQ    35,DL
         1 000500   000044 506007                    DIV     36,DL
         1 000501   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000502   000002 736000                    QLS     2
         1 000503   000001 136007                    SBLQ    1,DL
         1 000504   000020 736000                    QLS     16
         1 000505   000004 676100                    ERQ     4,,PR0
         1 000506   000001 376000 2                  ANQ     1
         1 000507   000004 656100                    ERSQ    4,,PR0

     1088     5400    4                   FPT$WRTJ.V.DCB#=GLOBAL.CJRNL.DCB#;

   5400  1 000510   000000 470400 xsym               LDP0    GLOBAL$
         1 000511   002610 721100                    LXL1    1416,,PR0
         1 000512   200011 470500                    LDP0    WRTJ$,,AUTO
         1 000513   000010 741100                    STX1    8,,PR0

     1089     5401    4                   CALL M$WRITE(FPT$WRTJ) ALTRET(ER_WRTC);

   5401  1 000514   440001 713400                    CLIMB   alt,write
         1 000515   401400 401760                    pmme    nvectors=4
         1 000516   000532 702000 1                  TSX2    ER_WRTC

     1090     5402    4                   END;

     1091     5403    3               END;

     1092     5404    2           END;

     1093     5405    1       RETURN;

   5405  1 000517   000000 702200 xent               TSX2  ! X66_ARET

     1094     5406    1   ER_WRTT: ERROR=ERR#IO#WRTT;

   5406  1 000520   210720 235007       ER_WRTT      LDA     70096,DL
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:256  
         1 000521   200012 755100                    STA     ERROR,,AUTO

     1095     5407    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5407  1 000522   000000 470400 xsym               LDP0    B$TCB$
         1 000523   000000 471500                    LDP1    0,,PR0
         1 000524   100102 236100                    LDQ     66,,PR1
         1 000525   000000 473400 xsym               LDP3    GLOBAL$
         1 000526   300007 756100                    STQ     7,,PR3

     1096     5408    1       GLOBAL.RET.DCB#=GLOBAL.TJRNL.DCB#;

   5408  1 000527   302604 720100                    LXL0    1412,,PR3
         1 000530   300014 740100                    STX0    12,,PR3

     1097     5409    1       GOTO ALT;

   5409  1 000531   000554 710000 1                  TRA     ALT

     1098     5410    1   ER_WRTC: IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.ERR#=%E$JRNLCLSD THEN

   5410  1 000532   000000 470400 xsym  ER_WRTC      LDP0    B$TCB$
         1 000533   000000 471500                    LDP1    0,,PR0
         1 000534   100102 236100                    LDQ     66,,PR1
         1 000535   377770 376007                    ANQ     131064,DL
         1 000536   001160 116007                    CMPQ    624,DL
         1 000537   000543 601000 1                  TNZ     s:5413

     1099     5411    1           ERROR=ERR#IO#NOOWNER;

   5411  1 000540   210762 235007                    LDA     70130,DL
         1 000541   200012 755100                    STA     ERROR,,AUTO
         1 000542   000545 710000 1                  TRA     s:5414

     1100     5412    1       ELSE
     1101     5413    1           ERROR=ERR#IO#WRTC;

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:257  
   5413  1 000543   210721 235007                    LDA     70097,DL
         1 000544   200012 755100                    STA     ERROR,,AUTO

     1102     5414    1       GLOBAL.RET.SYSERR#=B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   5414  1 000545   100102 236100                    LDQ     66,,PR1
         1 000546   000000 473400 xsym               LDP3    GLOBAL$
         1 000547   300007 756100                    STQ     7,,PR3

     1103     5415    1       GLOBAL.RET.DCB#=GLOBAL.CJRNL.DCB#;

   5415  1 000550   302610 720100                    LXL0    1416,,PR3
         1 000551   300014 740100                    STX0    12,,PR3

     1104     5416    1       GLOBAL.CJRNL.DCB#=0;

   5416  1 000552   302610 450100                    STZ     1416,,PR3

     1105     5417    1       GOTO ALT;

   5417  1 000553   000554 710000 1                  TRA     ALT

   5416  1 000554                       ALT          null
     1106     5418    1   ALT: ;
     1107     5419    1       GLOBAL.RET.ERROR#=ERROR;

   5419  1 000554   300006 755100                    STA     6,,PR3

     1108     5420    1       CALL M$ERR;

   5420  1 000555   000002 713400                    CLIMB   err
         1 000556   000000 401760                    pmme    nvectors=0

     1109     5421    1   END ZIM$JISTO;

   5421  1 000557   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:258  
(unnamed)
 Sect OctLoc
   2     000   000000 006003   777777 600000                                    ........

PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:259  
--  Include file information  --

   B_ERRORS_C.:LIB_E05  is referenced.
   ZI_ERRORS_C.:ZIC0TOU  is referenced.
   B$JIT.:LIB_E05  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E05  is referenced.
   CP_6.:LIB_E05  cannot be made into a system file and is referenced.
   ZI$JRNL.:ZIC0TOU  is referenced.
   ZI$DBCB.:ZIC0TOU  is referenced.
   ZI$SSS.:ZIC0TOU  cannot be made into a system file and is referenced.
   ZI$GLOBAL.:ZIC0TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ZIM$JISTO.

   Procedure ZIM$JISTO requires 368 words for executable code.
   Procedure ZIM$JISTO requires 14 words of local(AUTO) storage.

    No errors detected in file ZIM$JRNL.:ZIC0TSI    .
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:260  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:261  
          MINI XREF LISTING

AC.DEF.ANL
      1371**DCL      1442--IMP-SIZ
AC.DEF.FORG
      1358**DCL      1362--REDEF
AC$
      1354**DCL      1355--IMP-PTR  5337<<ASSIGN
ALT
      5416**LABEL    5409--GOTO     5417--GOTO
AWS.ATRIB.CJRNL
      2606**DCL      5333>>IF       5356>>IF       5374>>IF       5394>>IF
AWS.ATRIB.TJRNL
      2608**DCL      5333>>IF       5347>>IF       5366>>IF       5385>>IF
AWS.DDCB
      2627**DCL      5342>>ASSIGN   5348--ASSIGN   5349--ASSIGN   5375--ASSIGN   5376--ASSIGN
AWS$
      2601**DCL      2602--IMP-PTR  5332<<ASSIGN   5333>>IF       5333>>IF       5342>>ASSIGN   5347>>IF
      5348>>ASSIGN   5349>>ASSIGN   5356>>IF       5366>>IF       5374>>IF       5375>>ASSIGN   5376>>ASSIGN
      5385>>IF       5394>>IF
B$ALT.CODE
      2971**DCL      2971--REDEF    2972--REDEF    2972--REDEF
B$ALT.ERR
      2972**DCL      5407>>ASSIGN   5414>>ASSIGN
B$ALT.ERR.ERR#
      2973**DCL      2973--REDEF    5410>>IF
B$ALT.EVID
      2972**DCL      2972--REDEF    2972--REDEF
B$JIT.CPFLAGS1.SLEAZE
      3675**DCL      3675--REDEF
B$JIT.ERR.MID
      3582**DCL      3582--REDEF
B$JIT.JRESPEAK
      3743**DCL      3744--REDEF
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:262  
B$JIT.ORIGINATOR_PORT.FROM_CR
      3852**DCL      3852--REDEF    3853--REDEF
B$JIT.PNR
      3756**DCL      3756--REDEF
B$JIT.TSLINE
      3850**DCL      3851--REDEF
B$JIT.USER
      3581**DCL      5341>>ASSIGN
B$JIT$
      5312**DCL      3576--IMP-PTR  5341>>ASSIGN
B$TCB.ALT$
      2910**DCL      5407>>ASSIGN   5410>>IF       5414>>ASSIGN
B$TCB$
      5313**DCL      5407>>ASSIGN   5410>>IF       5414>>ASSIGN
BERC.DCB#
      2796**DCL      2797--REDEF
COM
      5329**LABEL    5321--GOTO     5325--GOTO
CRUNI.LENGTH
      2642**DCL      2643--IMP-SIZ
DBCB.IOWS.CFCT
      2518**DCL      2519--REDEF
DBCB.IOWS.DBKF.RQ
      2461**DCL      2462--REDEF
DBCB.IOWS.DBKR
      2458**DCL      2459--REDEF
DBCB.IOWS.NOBF
      2520**DCL      2521--REDEF
DBCB.IOWS.SPND
      2446**DCL      2447--REDEF
DBCB.PCB.RVI
      2294**DCL      5324>>ASSIGN   5386>>ASSIGN
DBCB.PCB.RVT
      2298**DCL      5320>>ASSIGN   5328>>ASSIGN   5395>>ASSIGN
DBCB.SWS.RDYCW
      2184**DCL      2185--REDEF
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:263  
DBCB.SWS.TEMP.PTR1$
      2218**DCL      2219--REDEF    2220--REDEF
DBCB.SWS.TEMP.PTR2$
      2221**DCL      2222--REDEF
DBCB$
      2089**DCL      2090--IMP-PTR  5330<<ASSIGN   5386>>ASSIGN   5386>>ASSIGN   5395>>ASSIGN   5395>>ASSIGN
ERROR
      5314**DCL      5329<<ASSIGN   5406<<ASSIGN   5411<<ASSIGN   5413<<ASSIGN   5419>>ASSIGN
ER_WRTC
      5410**LABEL    5362--CALLALT  5381--CALLALT  5401--CALLALT
ER_WRTT
      5406**LABEL    5354--CALLALT  5372--CALLALT  5392--CALLALT
F$DCB.ACTPOS
      2945**DCL      2945--REDEF
F$DCB.ARS#
      2919**DCL      2919--REDEF
F$DCB.ATTR
      2938**DCL      2939--REDEF
F$DCB.BORROW
      2953**DCL      2953--REDEF    2953--REDEF    2953--REDEF
F$DCB.DCBNAME.L
      2967**DCL      2967--IMP-SIZ
F$DCB.EOMCHAR#
      2923**DCL      2923--REDEF
F$DCB.FLDID
      2948**DCL      2948--REDEF
F$DCB.FORM$
      2942**DCL      2942--REDEF
F$DCB.FSECT
      2958**DCL      2958--REDEF
F$DCB.FSN#
      2935**DCL      2935--REDEF    2935--REDEF    2936--REDEF
F$DCB.HEADER$
      2941**DCL      2941--REDEF
F$DCB.IXTNSIZE#
      2939**DCL      2939--REDEF
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:264  
F$DCB.KEYL#
      2936**DCL      5348>>ASSIGN   5375>>ASSIGN
F$DCB.KEYX#
      2936**DCL      5349>>ASSIGN   5376>>ASSIGN
F$DCB.LASTSTA$
      2928**DCL      2928--REDEF
F$DCB.LVL
      2954**DCL      2954--REDEF
F$DCB.NAME#.C
      2929**DCL      2929--REDEF
F$DCB.NOEOF
      2951**DCL      2951--REDEF
F$DCB.NRECS#
      2940**DCL      2940--REDEF
F$DCB.NRECX
      2959**DCL      2959--REDEF
F$DCB.OHDR
      2951**DCL      2951--REDEF
F$DCB.ORG#
      2934**DCL      2934--REDEF
F$DCB.PRECNO
      2957**DCL      2957--REDEF
F$DCB.RCSZ
      2963**DCL      2963--REDEF
F$DCB.RES#
      2930**DCL      2930--REDEF
F$DCB.SETX
      2942**DCL      2942--REDEF
F$DCB.TAB$
      2942**DCL      2942--REDEF
F$DCB.TDA
      2956**DCL      2957--REDEF
F$DCB.WSN#
      2930**DCL      2930--REDEF
FPT$TIME
      3019**DCL      5338<>CALL
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:265  
FPT$WRTJ
      2994**DCL      5354<>CALL     5362<>CALL     5372<>CALL     5381<>CALL     5392<>CALL     5401<>CALL
FPT$WRTJ.BUF_.BOUND
      2994**DCL      5352<<ASSIGN   5360<<ASSIGN   5370<<ASSIGN   5379<<ASSIGN   5390<<ASSIGN   5399<<ASSIGN
FPT$WRTJ.STATION_
      2996**DCL      2996--REDEF
FPT$WRTJ.V.DCB#
      2997**DCL      5353<<ASSIGN   5361<<ASSIGN   5371<<ASSIGN   5380<<ASSIGN   5391<<ASSIGN   5400<<ASSIGN
FPT$WRTJ.V.DVBYTE.VFC#
      3003**DCL      3003--REDEF
GLOBAL.ACTIVE.DBCB$
       501**DCL       502--REDEF    5320>>ASSIGN   5320>>ASSIGN   5324>>ASSIGN   5324>>ASSIGN   5328>>ASSIGN
      5328>>ASSIGN   5330>>ASSIGN
GLOBAL.ACTIVE.SSS$
       497**DCL       498--REDEF    5331>>ASSIGN
GLOBAL.CJRNL.DCB#
       690**DCL      5361>>ASSIGN   5380>>ASSIGN   5400>>ASSIGN   5415>>ASSIGN   5416<<ASSIGN
GLOBAL.JRECORD
       700**DCL      5335--ASSIGN
GLOBAL.KEY
       705**DCL       708--REDEF
GLOBAL.PARAN.TRACE.MODE
       580**DCL       587--REDEF
GLOBAL.PENDING.ROLL
       536**DCL      5333>>IF
GLOBAL.PRINTBUF.BUFFER
       739**DCL       740--REDEF     741--REDEF     742--REDEF
GLOBAL.PRINTBUF.ERR.V
       744**DCL       747--REDEF     748--REDEF     749--REDEF
GLOBAL.RET.DCB#
       521**DCL      5408<<ASSIGN   5415<<ASSIGN
GLOBAL.RET.ERROR#
       515**DCL      5419<<ASSIGN
GLOBAL.RET.SYSERR#
       516**DCL      5407<<ASSIGN   5414<<ASSIGN
GLOBAL.TIME.TSTAMP
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:266  
       728**DCL      5340>>ASSIGN
GLOBAL.TIME$
       777**DCL      5338>>CALL
GLOBAL.TJRNL.DCB#
       684**DCL      5353>>ASSIGN   5371>>ASSIGN   5391>>ASSIGN   5408>>ASSIGN
GLOBAL.WRTJ$
       775**DCL      5336>>ASSIGN
GLOBAL$
       799**DCL       495--IMP-PTR  5320>>ASSIGN   5320>>ASSIGN   5324>>ASSIGN   5324>>ASSIGN   5328>>ASSIGN
      5328>>ASSIGN   5330>>ASSIGN   5331>>ASSIGN   5333>>IF       5335>>ASSIGN   5336>>ASSIGN   5338>>CALL
      5340>>ASSIGN   5353>>ASSIGN   5361>>ASSIGN   5371>>ASSIGN   5380>>ASSIGN   5391>>ASSIGN   5400>>ASSIGN
      5407>>ASSIGN   5408>>ASSIGN   5408>>ASSIGN   5414>>ASSIGN   5415>>ASSIGN   5415>>ASSIGN   5416>>ASSIGN
      5419>>ASSIGN
JREC
      2775**DCL      5352--ASSIGN   5360--ASSIGN   5370--ASSIGN   5379--ASSIGN   5390--ASSIGN   5399--ASSIGN
JREC.DCB#
      2779**DCL      5342<<ASSIGN
JREC.LENGTH
      2781**DCL      2784--IMP-SIZ  5350<<ASSIGN   5351>>ASSIGN   5352>>ASSIGN   5358<<ASSIGN   5359>>ASSIGN
      5360>>ASSIGN   5368<<ASSIGN   5369>>ASSIGN   5370>>ASSIGN   5377<<ASSIGN   5378>>ASSIGN   5379>>ASSIGN
      5388<<ASSIGN   5389>>ASSIGN   5390>>ASSIGN   5397<<ASSIGN   5398>>ASSIGN   5399>>ASSIGN
JREC.LINE
      2782**DCL      5344<<ASSIGN
JREC.OFFSET
      2783**DCL      5345<<ASSIGN
JREC.PAGE
      2780**DCL      5343<<ASSIGN
JREC.TIME
      2776**DCL      5340<<ASSIGN
JREC.TYPE
      2777**DCL      5339<<ASSIGN
JREC.USER#
      2778**DCL      5341<<ASSIGN
JREC.VALUE
      2784**DCL      5351<<ASSIGN   5359<<ASSIGN   5369<<ASSIGN   5378<<ASSIGN   5389<<ASSIGN   5398<<ASSIGN
JRNL$
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:267  
      2754**DCL      2755--IMP-PTR  2775--IMP-PTR  2785--IMP-PTR  2792--IMP-PTR  2798--IMP-PTR  5335<<ASSIGN
      5339>>ASSIGN   5340>>ASSIGN   5341>>ASSIGN   5342>>ASSIGN   5343>>ASSIGN   5344>>ASSIGN   5345>>ASSIGN
      5350>>ASSIGN   5351>>ASSIGN   5351>>ASSIGN   5352>>ASSIGN   5352>>ASSIGN   5358>>ASSIGN   5359>>ASSIGN
      5359>>ASSIGN   5360>>ASSIGN   5360>>ASSIGN   5368>>ASSIGN   5369>>ASSIGN   5369>>ASSIGN   5370>>ASSIGN
      5370>>ASSIGN   5377>>ASSIGN   5378>>ASSIGN   5378>>ASSIGN   5379>>ASSIGN   5379>>ASSIGN   5388>>ASSIGN
      5389>>ASSIGN   5389>>ASSIGN   5390>>ASSIGN   5390>>ASSIGN   5397>>ASSIGN   5398>>ASSIGN   5398>>ASSIGN
      5399>>ASSIGN   5399>>ASSIGN
KEYX#
      5317**DCL      5349<<ASSIGN   5351>>ASSIGN   5376<<ASSIGN   5378>>ASSIGN
LENGTH
      5316**DCL      5318--IMP-SIZ  5348<<ASSIGN   5350>>ASSIGN   5351>>ASSIGN   5351>>ASSIGN   5357<<ASSIGN
      5358>>ASSIGN   5359>>ASSIGN   5367<<ASSIGN   5368>>ASSIGN   5369>>ASSIGN   5375<<ASSIGN   5377>>ASSIGN
      5378>>ASSIGN   5378>>ASSIGN   5387<<ASSIGN   5388>>ASSIGN   5389>>ASSIGN   5396<<ASSIGN   5397>>ASSIGN
      5398>>ASSIGN
M$ERR
      2849**DCL-ENT  5420--CALL
M$TIME
      2904**DCL-ENT  5338--CALL
M$WRITE
      2838**DCL-ENT  5354--CALL     5362--CALL     5372--CALL     5381--CALL     5392--CALL     5401--CALL
RECORD
      5318**DCL      5351>>ASSIGN   5359>>ASSIGN   5369>>ASSIGN   5378>>ASSIGN   5389>>ASSIGN   5398>>ASSIGN
RECVAR.ACPTR
      2587**DCL      5337>>ASSIGN
RECVAR.AWS$
      2593**DCL      5332>>ASSIGN
RECVAR.BADDR
      2569**DCL      2572--REDEF
RECVAR.RADDR
      2573**DCL      2577--REDEF
RECVAR.RADDR$
      2577**DCL      5351>>ASSIGN   5359>>ASSIGN   5369>>ASSIGN   5378>>ASSIGN   5389>>ASSIGN   5398>>ASSIGN
RECVAR.RECSZ
      2578**DCL      5357>>ASSIGN   5367>>ASSIGN   5387>>ASSIGN   5396>>ASSIGN
RECVAR$
      5310**DCL      2567--IMP-PTR  5320<<ASSIGN   5324<<ASSIGN   5328<<ASSIGN   5332>>ASSIGN   5337>>ASSIGN
PL6.E3A0      #008=ZIM$JISTO File=ZIM$JRNL.:ZIC0TSI                              FRI 09/05/97 13:01 Page:268  
      5351>>ASSIGN   5357>>ASSIGN   5359>>ASSIGN   5367>>ASSIGN   5369>>ASSIGN   5378>>ASSIGN   5386<<ASSIGN
      5387>>ASSIGN   5389>>ASSIGN   5395<<ASSIGN   5396>>ASSIGN   5398>>ASSIGN
SSS$
       809**DCL      5331<<ASSIGN   5337>>ASSIGN
TYPE
      5315**DCL      5319<<ASSIGN   5323<<ASSIGN   5327<<ASSIGN   5339>>ASSIGN   5346>>IF       5365>>IF
      5384>>IF
WRTJ$
      5311**DCL      2994--IMP-PTR  5336<<ASSIGN   5352>>ASSIGN   5353>>ASSIGN   5354>>CALL     5360>>ASSIGN
      5361>>ASSIGN   5362>>CALL     5370>>ASSIGN   5371>>ASSIGN   5372>>CALL     5379>>ASSIGN   5380>>ASSIGN
      5381>>CALL     5390>>ASSIGN   5391>>ASSIGN   5392>>CALL     5399>>ASSIGN   5400>>ASSIGN   5401>>CALL
