VERSION A06

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:1    
        1        1        /*M*    Z8FL$LABEL_REFERENCE  Label reference resolution  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8               NAME:  Z8FL$LABEL_REFERENCE
        9        9            PURPOSE:  Check the correctness of a label reference.  If the label is
       10       10                      unqualified then reset the pointer from the DNT entry to the ST.
       11       11        */
       12       12
       13       13        /*D*
       14       14               NAME:  Z8FL$LABEL_REFERENCE
       15       15               CALL:  CALL Z8FL$LABEL_REFERENCE ;
       16       16
       17       17              INPUT:  The QLT, ILL, and ST are accessed.
       18       18             OUTPUT:  LBL$ -- The ptr to the ST entry for the label is stored
       19       19                              in either ILL.ROP or ILL.LOP depending on the call.
       20       20            SCRATCH:  COMCOM.CURRENT.LINE  For error message
       21       21
       22       22        DESCRIPTION:  This procedure performs resolution of label references.
       23       23                      Phase 1 can't determine all label references due to undefined
       24       24                      labels or ambiguity. A reference that at one point is defined may
       25       25                      later turn out to be ambiguous.  Z8FB links all label
       26       26                      references together as well as the labels themselves and
       27       27                      then this procedures searches thru the list to operate on
       28       28                      each item.
       29       29
       30       30                       examples:
       31       31                           1)  (legal)
       32       32
       33       33                                  GO TO B OF A.
       34       34                               A SECTION.
       35       35                               B.
       36       36
       37       37                           2)   ERROR-ambiguous reference because there are two
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:2    
       38       38                                      paragraphs of the same name. It is legal to have
       39       39                                      an ambiguous paragraph structure like this as long
       40       40                                      as neither label is referenced.
       41       41
       42       42                                  GO TO B OF A.
       43       43                               A SECTION.
       44       44                               B.
       45       45                                  MOVE 5 TO COMP6.
       46       46                               B.
       47       47
       48       48                           3)  interpreted by this procedure to be GO TO B OF A.
       49       49
       50       50                                  GO TO B.
       51       51                               A SECTION.
       52       52                               B.
       53       53                                  MOVE 5 TO COMP6.
       54       54                               C SECTION.
       55       55                               B.
       56       56
       57       57
       58       58        */
       59       59        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:3    
       60       60        Z8FL$LABEL_REFERENCE: PROC NOAUTO ;
       61       61        %EQU PHASE = 2 ;
       62       62        %INCLUDE Z8A_DEFC ;
       63      130        %INCLUDE Z8A_SUPP_MAC ;
       64     2530        %INCLUDE Z9A_FLAGS ;
       65     2544        %INCLUDE Z8A_COMCOM ;
       66     3194        %INCLUDE Z8A_DNT ;
       67     3415        %INCLUDE Z8A_ERR_NUMS ;
       68     4179        %INCLUDE Z8A_ETT ;
       69     4480        %INCLUDE Z8A_LTS ;
       70     6557        %INCLUDE Z8F_O2COM ;
       71     6667        %INCLUDE Z8A_ST ;
       72    10326        %INCLUDE Z8A_TYPES ;
       73    10500        %INCLUDE Z8A_ILL ;
       74    11193        %INCLUDE Z8A_ILS ;
       75    11302        %INCLUDE Z8A_LIBRARY ;
       76    11516        %INCLUDE Z8A_MKCN ;
       77    11533        %INCLUDE Z8A_XREF ;
       78    11605        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:4    
       79    11606    1   DCL Z8AE$ERROR  ENTRY (12) ;
       80    11607    1   DCL Z8AT$CREATE_TEMPORARY ENTRY (2) ;
       81    11608    1   DCL Z8AF$NEW_BASE  ENTRY (3) ;
       82    11609    1   DCL Z8AC$MAKE_CONST  ENTRY (1);
       83    11610
       84    11611    1   DCL END_LBL_SYM$ PTR STATIC ; /* Ptr to created label entry in ST  */
       85    11612    1   DCL END_TEMP$    PTR STATIC ; /* Ptr to temp created for the end label */
       86    11613    1   DCL END_ILS$     PTR STATIC ; /* Ptr to created label entry in ILS */
       87    11614    1   DCL SRCH_LBL$    PTR STATIC ; /* Ptr to labels being searched for end */
       88    11615    1   DCL PREV_LBL$    PTR STATIC ; /* Ptr to prior label in search */
       89    11616    1   DCL TEMP_ILS$    PTR ;        /* Ptr to where end label to be put */
       90    11617    1   DCL START_LBL$   PTR STATIC ; /* Ptr to start label in section search */
       91    11618    1   DCL FIRST_LBL$   PTR STATIC ; /* Ptr to LOP of ILL for PFORM */
       92    11619    1   DCL PRESET_ILS$  PTR STATIC ; /* Ptr to PRESET entry for ALTERs */
       93    11620    1   DCL FATHER$      PTR ; /* PTR to father of internal program */
       94    11621    1   DCL SYMREF$$     PTR ; /* PTR to the SYMREF_ for a CALL literal */
       95    11622    1   DCL SYMDEF$$ REDEF SYMREF$$ PTR ; /* PTR to SYMDEF for an ENTRY */
       96    11623    1   DCL CURRENT_PROC$ PTR ; /* PTR to current Proc_ ST item */
       97    11624    1   DCL PROC_SUPP$   PTR ; /* PTR to current PROC_SUPP item */
       98    11625    1   DCL CURRENT_SCOPE$ PTR ; /* PTR to last SCOPE ILL encountered. */
       99    11626    1   DCL INIT_LINOI$  PTR ; /* PTR to ILS for first LINOI of an init proc */
      100    11627    1   DCL TEMP$        PTR ;
      101    11628    1   DCL BASED$PTR$   PTR BASED ;
      102    11629    1   DCL TEMP_UBIN    UBIN ;
      103    11630    1   DCL LABEL_REFERENCE$ PTR STATIC ; /* Ptr to label being referenced */
      104    11631    1   DCL DUPLICATE_LBL BIT(1) ALIGNED STATIC ;
             11631            /* Duplicate label found in section search */
      105    11632        %IF GCOS ;
      107    11634        %ENDIF ;
      108    11635    1   DCL ERR_LINE     SBIN ;       /* Line at which last error detected */
      109    11636    1   DCL ERR_COL      SBIN ;       /* Column at which last error detected */
      110    11637    1   DCL ERR_DNT$     PTR ;        /* PTR to DNT item for last error */
      111    11638    1   DCL LTS$$          PTR;
      112    11639    1   DCL SEG_LTS$       PTR;
      113    11640
      114    11641        %MACRO SET_END_LBL_VALUES(@ITEM$=ILL$ -> ILL.LOP) ;
      115    11642               DO ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:5    
      116    11643                 ILL$ -> ILL.ROP = @ITEM$ -> LABEL.P_END$ ;
      117    11644                 ILL$ -> ILL.ROP -> LABEL.B.ONE_REF = FALSE ;
      118    11645               END ;
      119    11646        %MEND ;
      120    11647        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:6    
      121    11648
      122    11649    1   RESERVE_PRESET_ITEM: PROC (PREV_ENTRY$, ALTER_LBL$, POINTER$) ;
      123    11650
      124    11651        /*I*
      125    11652               NAME:  RESERVE_PRESET_ITEM
      126    11653               CALL:  CALL RESERVE_PRESET_ITEM(PREV_ENTRY$, ALTER_LBL$, POINTER$) ;
      127    11654
      128    11655              INPUT:  PREV_ENTRY$ - Pointer to previous entry in ILS.
      129    11656                      ALTER_LBL$ - Label to be assigned to POINTER variable
      130    11657                      POINTER$ - Pointer to POINTER variable being set
      131    11658             OUTPUT:  PREV_ENTRY$ -> ILS.NEXT is assigned the PRESET item.
      132    11659
      133    11660        DESCRIPTION:  This procedure creates a OPN entry in the ILS to include a PRESET
      134    11661                      item. The PRESET entry is used to set the POINTER variable
      135    11662                      to label entry of the GO statement in the ALTER paragraph.
      136    11663                      The POINTER variable is assigned a storage location and the storage
      137    11664                      counter is incremented.
      138    11665        */
      139    11666
      140    11667    2   DCL  PREV_ENTRY$   PTR ; /* Pointer to previous entry in ILS */
      141    11668    2   DCL  ALTER_LBL$    PTR ; /* Pointer to label being assigned to POINTER */
      142    11669    2   DCL  POINTER$       PTR ; /* Pointer to POINTER variable */
      143    11670
      144    11671    2   DCL  PRESET_ILS$    PTR ; /* Pointer to OPN item above PRESET */
      145    11672    2   DCL  SEG_NO#        SBIN WORD;
      146    11673        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:7    
      147    11674    2          SEG_NO# = 0;
      148    11675    2          IF ALTER_LBL$ -> LABEL.ID ~= %SECTION AND
      149    11676    2            ALTER_LBL$ -> LABEL.SECTION$ ~= ADDR(NIL) AND
      150    11677    2            ALTER_LBL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      151    11678    2            SEG_NO# = ALTER_LBL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      152    11679    2                      SEGMENT_LTS.SEGMENT_NO#;
      153    11680    2          ELSE
      154    11681    2            IF ALTER_LBL$ -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      155    11682    2              SEG_NO# = ALTER_LBL$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#;
      156    11683
      157    11684               %RESERVE_ILS(ITEM=%OPN, POINTER=PRESET_ILS$) ;
      158    11713    2          PRESET_ILS$ -> ILS.NEXT = PREV_ENTRY$ -> ILS.NEXT ;
      159    11714    2          PREV_ENTRY$ -> ILS.NEXT = PRESET_ILS$ ;
      160    11715
      161    11716    2          IF SEG_NO# < COMCOM.SEG_LIMIT THEN
      162    11717    3            DO;
      163    11718                   %RESERVE_ILL(ITEM=%PRESET, POINTER=PRESET_ILS$ -> ILS.ILL$) ;
      164    11728
      165    11729    3              PRESET_ILS$ -> ILS.ILL$ -> ILL.LOP = POINTER$ ;
      166    11730    3              PRESET_ILS$ -> ILS.ILL$ -> ILL.ROP = ALTER_LBL$ ;
      167    11731    3            END;
      168    11732    2          ELSE
      169    11733    3            DO;
      170    11734                   %RESERVE_ILL (ITEM = %P_A_PRESET,
      171    11735                                 POINTER = PRESET_ILS$ -> ILS.ILL$);
      172    11745    3              PRESET_ILS$ -> ILS.ILL$ -> P_A_PRESET.LOP = ALTER_LBL$;
      173    11746    3              PRESET_ILS$ -> ILS.ILL$ -> P_A_PRESET.ROPCON = SEG_NO#;
      174    11747    3              PRESET_ILS$ -> ILS.ILL$ -> P_A_PRESET.TO_ = POINTER$;
      175    11748    3            END;
      176    11749
      177    11750    2   END RESERVE_PRESET_ITEM ;
      178    11751        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:8    
      179    11752    1   CREATE_END_LABEL: PROC (PREV_ENTRY$) ;
      180    11753
      181    11754        /*I*
      182    11755               NAME:  CREATE_END_LABEL
      183    11756               CALL:  CALL CREATE_END_LABEL(PREV_ENTRY$) ;
      184    11757          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create a paragraph item.
      185    11758
      186    11759              INPUT:  PREV_ENTRY$ - Ptr to the ILS entry preceding target location
      187    11760                                    of end label being created.
      188    11761             OUTPUT:  A DEFLB entry together with the associated ILS and LINOI
      189    11762                      entries are entered into the tables and link.
      190    11763
      191    11764        DESCRIPTION:  CREATE_END_LABEL is called to create a label at the end of
      192    11765                      a paragraph or section.  These are used to conclude a PERFORM
      193    11766                      code group.
      194    11767
      195    11768                      A paragraph symbol is created. A DEFLB is set up for it.
      196    11769                      The pointers are then reset in the ILS to enter the item in
      197    11770                      its proper position.
      198    11771        */
      199    11772
      200    11773    2   DCL PREV_ENTRY$   PTR ; /* Pointer to previous entry in ILS */
      201    11774        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:9    
      202    11775
      203    11776    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, END_LBL_SYM$) ;
      204    11777    2          END_LBL_SYM$ -> LABEL.B.REFERENCED = TRUE ;
      205    11778    2          END_LBL_SYM$ -> LABEL.B.ONE_REF = TRUE ;
      206    11779    2          END_LBL_SYM$ -> LABEL.B.PFORM_END_LBL = TRUE ;
      207    11780    2          END_LBL_SYM$ -> LABEL.PREV_ILS$ = PREV_ENTRY$ ;
      208    11781    2          END_LBL_SYM$ -> LABEL.PROC$ = CURRENT_PROC$ ;
      209    11782    2          END_LBL_SYM$ -> LABEL.P_START$ = ILL$ -> ILL.LOP ;
      210    11783
      211    11784               %RESERVE_ILS(ITEM=%OPN, POINTER=END_ILS$) ;
      212    11813               %RESERVE_ILL(ITEM=%LINOI, POINTER=END_ILS$ -> ILS.ILL$) ;
      213    11823
      214    11824               %RESERVE_ILS(ITEM=%OPN, POINTER=END_ILS$ -> ILS.NEXT) ;
      215    11853               %RESERVE_ILL(ITEM=%DEFLB, POINTER=END_ILS$ -> ILS.NEXT->ILS.ILL$) ;
      216    11863    2          END_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP = END_LBL_SYM$ ;
      217    11864    2          END_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.LBL = PREV_LBL$ -> ILS.ILL$ -> ILL.LBL
             11864                   ;
      218    11865    2          PREV_LBL$ -> ILS.ILL$ -> ILL.LBL = END_ILS$ -> ILS.NEXT ;
      219    11866
      220    11867    2          TEMP$ = PREV_ENTRY$ ;
      221    11868    3          DO UNTIL TEMP$ -> ILS.ILL$ -> ILL.ID = %LINOI ;
      222    11869                 %NEXT_ILS (POINTER=TEMP$) ;
      223    11874    3          END ;
      224    11875    2          END_ILS$ -> ILS.ILL$ -> LINOI = TEMP$ -> ILS.ILL$ -> LINOI ;
      225    11876    2          END_ILS$ -> ILS.NEXT->ILS.NEXT = PREV_ENTRY$ -> ILS.NEXT ;
      226    11877    2          PREV_ENTRY$ -> ILS.NEXT = END_ILS$ ;
      227    11878
      228    11879    2   END CREATE_END_LABEL ;
      229    11880        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:10   
      230    11881        /*V*
      231    11882            FIND_LABEL_END -- Search the perform code group to see if the end label
      232    11883                              has already been created.  If it hasn't,an end label is
      233    11884                              created.
      234    11885        */
      235    11886
      236    11887    1   FIND_LABEL_END: PROC (LBL_SYM$) ;
      237    11888
      238    11889    2   DCL  LBL_SYM$  PTR  ; /* Ptr to called PERFORM's end label ST entry */
      239    11890        /*I*
      240    11891               NAME:  FIND_LABEL_END
      241    11892               CALL:  CALL FIND_LABEL_END(LBL_SYM$) ;
      242    11893          INTERFACE:  CREATE_END_LABEL is called to create the end label after finding
      243    11894                      its location.
      244    11895
      245    11896              INPUT:  LBL_SYM$  Pointer to label that needs an end label.
      246    11897             OUTPUT:  An end label is created in its proper location.
      247    11898
      248    11899        DESCRIPTION:  This procedure finds the location of the end label and calls
      249    11900                      CREATE_END_LABEL to create one in the desired location.
      250    11901
      251    11902                      The PREV_LBL$ pointer and SRCH_LBL$ are initialized and then a
      252    11903                      search is made thru the label list.  The search continues until
      253    11904                      we find a noncompiler created label ending the PARA or
      254    11905                      SECTION or upon reaching the end of the program.
      255    11906
      256    11907                      *** IMPORTANT NOTE *** - If the PERFORM code group is ended by
      257    11908                      a SECTION label that is also a program entry point, Z8FB has
      258    11909                      set the label's PREV_ILS$ to point not to the previous non-LINOI,
      259    11910                      the GO around the entry point, but to the non-LINOI ILS before
      260    11911                      this GO. That is because the GO must not be PERFORMed.
      261    11912        */
      262    11913        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:11   
      263    11914    2          PREV_LBL$ = LBL_SYM$ -> LABEL.PREV_ILS$ ;
      264    11915               /* Find start label. %NEXT_NON_SUPPORT will not quite do it,
      265    11916                  because the start label could be a program entry point. */
      266    11917    3          DO UNTIL PREV_LBL$ -> ILS.ILL$ -> ILL.ID = %DEFLB ; /*#35059*/
      267    11918                 %NEXT_ILS (POINTER=PREV_LBL$) ;
      268    11923    3          END ;
      269    11924    2          SRCH_LBL$ = PREV_LBL$ -> ILS.ILL$ -> ILL.LBL ;
      270    11925
      271    11926        /*V*
      272    11927            LABEL_SEARCH -- Search the labels until one is found with the same id type
      273    11928                            (PARA or SECTION) or higher (a PARA can end at a SECTION
      274    11929                            label) and it is not compiler-created. This loop is exited
      275    11930                            when the above happens or at the end of the label chain.
      276    11931        */
      277    11932
      278    11933    2   LABEL_SEARCH:
      279    11934    3          DO WHILE SRCH_LBL$ ~= ADDR(NIL) ;
      280    11935    3            IF SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PROC$ ~= CURRENT_PROC$
      281    11936    3            OR SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.INIT_PROC
      282    11937    3              THEN SRCH_LBL$ = ADDR (NIL) ;
      283    11938                   /* PERFORM block can be ended by anything in a different
      284    11939                      (nested or consecutive) program, or by the initialization
      285    11940                      procedure for any program. */
      286    11941    4              ELSE DO ;
      287    11942    4                IF SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN
      288    11943    4                  EXIT LABEL_SEARCH ;
      289    11944                        /* Paragraph or section can end at a section label. */
      290    11945                        /* See note under DESCRIPTION of this internal procedure for
      291    11946                           info about if the section label is a program entry point.
      292    11947                           The GO around the entry point must not be PERFORMed. */
      293    11948    4                IF LBL_SYM$ -> LABEL.ID = %PARA AND
      294    11949    4                  NOT SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.COMPILER_CREATED THEN
      295    11950    4                    EXIT LABEL_SEARCH ;
      296    11951                          /* Para. can end at a non-compiler-created paragraph. */
      297    11952    4                IF LBL_SYM$ -> LABEL.SECTION$ ~= ADDR (NIL) AND /* Para. in section */
      298    11953    4                   LBL_SYM$ -> LABEL.SECTION$ -> LABEL.ID = %SECTION THEN
      299    11954    4                  IF LBL_SYM$ -> LABEL.SECTION$ -> LABEL.P_END$ =
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:12   
      300    11955    4                      SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP THEN
      301    11956    4                    EXIT LABEL_SEARCH ; /* PERFORM of section already compiled.
      302    11957                                   PERFORM of paragraph needs its own end label. */
      303    11958    4                PREV_LBL$ = SRCH_LBL$ ;
      304    11959    4                SRCH_LBL$ = SRCH_LBL$ -> ILS.ILL$ -> ILL.LBL ;
      305    11960    4              END ;
      306    11961    3          END ;
      307    11962
      308    11963
      309    11964        /*V*
      310    11965            END_LABEL_CHAIN -- The perform code group is at the end of the program.  If
      311    11966                               there is no end label created for the particular
      312    11967                               code group then one is created.  If one is already
      313    11968                               created then the one_ref bit is set off.
      314    11969        */
      315    11970
      316    11971    2          IF SRCH_LBL$ = ADDR(NIL) THEN
      317    11972    3            DO ;
      318    11973    3              CALL CREATE_END_LABEL(CURRENT_SCOPE$ -> SCOPE.END_ILS$) ;
      319    11974    3              CURRENT_SCOPE$ -> SCOPE.END_ILS$ = END_ILS$ ;
      320    11975                   %NEXT_ILS (POINTER=CURRENT_SCOPE$ -> SCOPE.END_ILS$) ;
      321    11980    3            END ;
      322    11981    2          ELSE
      323    11982    3            DO ;
      324    11983    3              IF SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.DUPLICATE THEN
      325    11984    4                DO ;
      326    11985        /*V*
      327    11986            DUPLICATE_CLOSING_LABEL -- The label that ends the PERFORM code group
      328    11987                                       is one that occurs twice but is itself not
      329    11988                                       referenced. This is legal, but it makes it
      330    11989                                       necessary to use a much slower method to find
      331    11990                                       where to insert the end label.
      332    11991        */
      333    11992    4                  TEMP_ILS$ = PREV_LBL$ ;
      334    11993    4                  TEMP$ = TEMP_ILS$ ;
      335    11994                       %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      336    12009    5                  DO WHILE (TEMP$ -> ILS.ILL$ = ADDR (NIL)
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:13   
      337    12010    5                            OR TEMP$ -> ILS.ILL$ -> ILL.LOP ~=
      338    12011    5                               SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP) ;
      339    12012    5                    TEMP_ILS$ = TEMP$ ;
      340    12013                         %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      341    12028    5                  END ;
      342    12029    4                END ;
      343    12030    3              ELSE TEMP_ILS$ = SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ ;
      344    12031
      345    12032        /*V*
      346    12033            CLOSING_LABEL_FOUND -- A label was found closing the perform code group. If
      347    12034                                   an end label has not been created then one is created
      348    12035                                   else the one_ref bit of the end label is set off.
      349    12036        */
      350    12037
      351    12038    3              CALL CREATE_END_LABEL(TEMP_ILS$) ;
      352    12039    3              SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ = END_ILS$ -> ILS.
             12039                       NEXT ;
      353    12040    3            END ;
      354    12041
      355    12042    2          IF LBL_SYM$ -> LABEL.ID = %SECTION THEN
      356    12043    2            END_LBL_SYM$ -> LABEL.SECTION$ = LBL_SYM$;
      357    12044    2          ELSE
      358    12045    2            END_LBL_SYM$ -> LABEL.SECTION$ = LBL_SYM$ -> LABEL.SECTION$;
      359    12046
      360    12047    2          LBL_SYM$ -> LABEL.P_END$ = END_LBL_SYM$ ;
      361    12048    2          ILL$ -> ILL.ROP = END_LBL_SYM$ ;
      362    12049
      363    12050    2   END FIND_LABEL_END ;
      364    12051        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:14   
      365    12052    1   REFERENCE_RESOLUTION: PROC (REF_PTR$, GOTO_DEST) ;
      366    12053
      367    12054    2   DCL  REF_PTR$ PTR ;
      368    12055    2   DCL  REF_PTR$$ PTR ;
      369    12056    2   DCL  REF$ITEM$ PTR BASED (REF_PTR$$) ;
      370    12057    2   DCL  GOTO_DEST BIT (1) ALIGNED ;
      371    12058    2   DCL  BAD_REFERENCE BOOLEAN ; /* TRUE if the reference cannot be resolved */
      372    12059    2   DCL  ITEM_NOT_ETT BOOLEAN ; /* Should be self-explanatory */
      373    12060
      374    12061        /*I*
      375    12062               NAME:  REFERENCE_RESOLUTION
      376    12063               CALL:  CALL REFERENCE_RESOLUTION(ADDR(REF$ITEM$)) ;
      377    12064          INTERFACE:  Z8AE$ERROR is called to produce error messages.
      378    12065
      379    12066              INPUT:  REF_PTR$ -> REF$ITEM$ - ptr to reference to be checked.  It may
      380    12067                      be a ST entry, ETT item, or a DNT entry.
      381    12068                      GOTO_DEST - TRUE if the reference is the destination of a GOTO,
      382    12069                      or if a GOTO is ALTERed to go to it.
      383    12070             OUTPUT:  REF$ITEM$ - ptr to the correct reference if one exists or to
      384    12071                      nil if no correct reference is there.
      385    12072
      386    12073        DESCRIPTION:  This procedure finds the correct reference if one exists and flags
      387    12074                      an error message otherwise.
      388    12075
      389    12076                      If the reference is qualified then the item is checked only to
      390    12077                      make sure there aren't duplicate labels within the same section
      391    12078                      and that the paragraph is defined.
      392    12079
      393    12080                      If the reference is unqualified then a check is made to see if a
      394    12081                      label exists by the given name.  If one does then a search is made
      395    12082                      to find the paragraph located in the current section if one exists.
      396    12083
      397    12084                      If GOTO_DEST then the GOTO_LABEL bit is set in the ST entry.
      398    12085        */
      399    12086        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:15   
      400    12087        %MACRO NO_LABEL_ERRORS ;
      401    12088               DO ;
      402    12089                 %FIND_LINE_NO ;
      403    12090
      404    12091                 IF ERR_LINE ~= COMCOM.CURRENT.LINE OR ERR_COL ~=
      405    12092                   COMCOM.CURRENT.COLUMN OR ERR_DNT$ ~= REF$ITEM$ THEN DO ;
      406    12093
      407    12094                     ERR_LINE = COMCOM.CURRENT.LINE ;
      408    12095                     ERR_COL = COMCOM.CURRENT.COLUMN ;
      409    12096                     ERR_DNT$ = REF$ITEM$ ;
      410    12097
      411    12098                     IF REF$ITEM$ -> DNT.ST$ -> LABEL.ID = %PARA THEN DO ;
      412    12099                       IF NOT REF$ITEM$ -> DNT.ST$ -> LABEL.B.COMPILER_CREATED THEN
      413    12100
      414    12101        /*E*
      415    12102              ERROR:  NO_LABEL
      416    12103            MESSAGE:  The label !0 is not defined.
      417    12104        DESCRIPTION:  If a reference is made to a nonexistent label name then
      418    12105                      this error is flagged.  The operand of the ILL is
      419    12106                      assigned a pointer to the created ST item.
      420    12107        */
      421    12108
      422    12109                         CALL Z8AE$ERROR (%E$NO_LABEL,,, REF$ITEM$) ;
      423    12110                     END ;
      424    12111                     ELSE
      425    12112
      426    12113        /*E*
      427    12114              ERROR:  NO_LABEL_DATA
      428    12115           MESSAGE:  The label !0 is not defined though a data item is present by this name.
      429    12116        DESCRIPTION:  If a reference is made to a nonexistent label name but
      430    12117                a data item is present then this error is flagged.
      431    12118                The operand of the ILL is assigned a pointer to the
      432    12119                created ST item.  Set BAD_REFERENCE to TRUE so that the ILL
      433    12120                item is deleted in Z8FF$FLOW_ANALYSIS.
      434    12121        */
      435    12122
      436    12123                       IF NOT REF$ITEM$ -> DNT.B.ERROR_VARIABLE THEN
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:16   
      437    12124                         CALL Z8AE$ERROR (%E$NO_LABEL_DATA,,, REF$ITEM$) ;
      438    12125                     END ;
      439    12126
      440    12127                 BAD_REFERENCE = TRUE ;
      441    12128               END ;
      442    12129        %MEND ;
      443    12130        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:17   
      444    12131        /*E*
      445    12132              ERROR:  DUP_LABEL
      446    12133            MESSAGE:  The reference to the duplicate label !0 is unqualified.
      447    12134        DESCRIPTION:  This error is produced when there are two section labels of the
      448    12135                      same name or two paragraph labels of the same name within one
      449    12136                      section that is referenced.
      450    12137        */
      451    12138
      452    12139        %MACRO DUP_LABEL_ERROR ;
      453    12140               DO ;
      454    12141
      455    12142                 IF ERR_LINE ~= COMCOM.CURRENT.LINE OR ERR_COL ~=
      456    12143                   COMCOM.CURRENT.COLUMN OR ERR_DNT$ ~= REF$ITEM$ THEN DO ;
      457    12144
      458    12145                     ERR_LINE = COMCOM.CURRENT.LINE ;
      459    12146                     ERR_COL = COMCOM.CURRENT.COLUMN ;
      460    12147                     ERR_DNT$ = REF$ITEM$ ;
      461    12148                     IF ILS$ = ADDR (NIL)
      462    12149                   /* Flag this error in USE procedures at the USE procedure entry. */
      463    12150                       THEN COMCOM.CURRENT.LINE = LABEL_REFERENCE$ -> LABEL.LINE_NO ;
      464    12151                   /* In other cases flag it where the label is referenced. */
      465    12152                       ELSE
      466    12153                         %FIND_LINE_NO ;
      467    12154
      468    12155                     CALL Z8AE$ERROR (%E$DUP_LABEL,,, LABEL_REFERENCE$ -> LABEL.DNT$) ;
      469    12156                     END ;
      470    12157                 BAD_REFERENCE = TRUE ;
      471    12158               END ;
      472    12159        %MEND ;
      473    12160        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:18   
      474    12161        /*V*
      475    12162            EVALUATE_ETT -- Go thru zero or more ETT items, taking the LOP.
      476    12163        */
      477    12164    2          REF_PTR$$ = REF_PTR$ ;
      478    12165
      479    12166    2          IF REF$ITEM$ = ADDR (NIL) THEN /* Nothing to resolve */ RETURN ;
      480    12167
      481    12168    2          ITEM_NOT_ETT = FALSE ;
      482    12169
      483    12170    3          DO UNTIL (ITEM_NOT_ETT) ;
      484    12171    4            DO CASE (REF$ITEM$ -> ETT.ID) ;
      485    12172    4              CASE (%SSOP, %OFF, %BASE) ;
      486    12173    4                REF_PTR$$ = ADDR (REF$ITEM$ -> ETT.LOP) ;
      487    12174    4              CASE (ELSE) ;
      488    12175    4                ITEM_NOT_ETT = TRUE ;
      489    12176    4            END ;
      490    12177    3          END ;
      491    12178
      492    12179    2          BAD_REFERENCE = FALSE ; /* Be optimistic */
      493    12180
      494    12181    2          IF REF$ITEM$ -> LABEL.ID = %PARA OR REF$ITEM$ -> LABEL.ID = %SECTION THEN
      495    12182
      496    12183        /*V*
      497    12184            QUALIFIED_REF -- Qualified reference, make sure label is not a duplicate.
      498    12185                             Check to make sure that a defined label is found.
      499    12186
      500    12187                             Phase 1 creates symbol table entries for both the paragraph
      501    12188                             and section name and assigns the reference pointer to the
      502    12189                             symbol table entry of the paragraph.  Phase 1 also checks
      503    12190                             to see if the paragraph name is the same as a data name as
      504    12191                             that is illegal.
      505    12192        */
      506    12193
      507    12194    3            DO ;
      508    12195    3              LABEL_REFERENCE$ = REF$ITEM$ ;
      509    12196
      510    12197    3              IF NOT LABEL_REFERENCE$ -> LABEL.B.DEFINED THEN
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:19   
      511    12198    4                DO ;
      512    12199
      513    12200        /*E*
      514    12201              ERROR:  NO_LABEL_IN_SECTION
      515    12202            MESSAGE:  There is no label !0 defined in section !1.
      516    12203        DESCRIPTION:  This error is produced when a qualified reference to a
      517    12204                      label references a non defined label.  The line number
      518    12205                      is found and the left operand of the ILL is set to NIL.
      519    12206        */
      520    12207
      521    12208                       %FIND_LINE_NO ;
      522    12224
      523    12225    4                IF ERR_LINE ~= COMCOM.CURRENT.LINE OR ERR_COL ~=
      524    12226    4                  COMCOM.CURRENT.COLUMN OR ERR_DNT$ ~= REF$ITEM$ -> LABEL.DNT$
      525    12227    5                    THEN DO ;
      526    12228
      527    12229    5                      ERR_LINE = COMCOM.CURRENT.LINE ;
      528    12230    5                      ERR_COL = COMCOM.CURRENT.COLUMN ;
      529    12231    5                      ERR_DNT$ = REF$ITEM$ -> LABEL.DNT$ ;
      530    12232    5                      IF REF$ITEM$ -> LABEL.SECTION$ = ADDR (NIL) THEN
      531    12233                             %IF GCOS ;
      539    12241                             %ENDIF ;
      540    12242    5                            ;
      541    12243                           /* If reference like X OF Y OF Z, SECTION$ =
      542    12244                              ADDR (NIL) and Phase 1 has already reported
      543    12245                              this error. */
      544    12246    5                      ELSE IF REF$ITEM$ -> LABEL.SECTION$ -> LABEL.ID = %SECTION AND
      545    12247    5                         NOT REF$ITEM$ -> LABEL.SECTION$ ->
      546    12248    5                          SECTION.B.COMPILER_CREATED THEN
      547    12249    5                        CALL Z8AE$ERROR (%E$NO_LABEL_IN_SECTION,,,
      548    12250    5                                        REF$ITEM$ -> LABEL.DNT$,
      549    12251    5                                        REF$ITEM$ -> LABEL.SECTION$ -> LABEL.DNT$) ;
      550    12252    5                    END ;
      551    12253    4                  BAD_REFERENCE = TRUE ;
      552    12254    4                END ;
      553    12255    3              ELSE
      554    12256    4                DO ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:20   
      555    12257    4                  IF LABEL_REFERENCE$ -> LABEL.B.DUPLICATE THEN
      556    12258                         %DUP_LABEL_ERROR ;
      557    12291    4                END ;
      558    12292    3            END ;
      559    12293    2          ELSE
      560    12294        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:21   
      561    12295        /*V*
      562    12296            UNQUALIFIED_REF -- Assign ILL.LOP the pointer to the label.
      563    12297        */
      564    12298
      565    12299    3            DO ;
      566    12300    3              LABEL_REFERENCE$ = REF$ITEM$ -> DNT.ST$ ;
      567    12301
      568    12302        /*V*
      569    12303            GET_LABEL -- Search the ST items with the correct name to make sure that
      570    12304                         there is a PARA or SECTION item for the label.  Phase 1 flags
      571    12305                         all conflicts with data names but a search is needed to see if
      572    12306                         any label by the given name exists.  An error is flagged if no
      573    12307                         label exists.
      574    12308        */
      575    12309
      576    12310    3   RESOLUTION_1:
      577    12311    4              DO WHILE LABEL_REFERENCE$ ~= ADDR(NIL) ;
      578    12312    5                IF LABEL_REFERENCE$ -> LABEL.ID = %POINTER THEN DO ;
      579    12313                       %FIND_LINE_NO ;
      580    12329    5                  CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;
      581    12330    5                  BAD_REFERENCE = TRUE ;
      582    12331    5                  EXIT RESOLUTION_1 ;
      583    12332    5                END ;
      584    12333    4                IF LABEL_REFERENCE$ -> LABEL.B.DEFINED AND
      585    12334    4                   (LABEL_REFERENCE$ -> LABEL.ID = %PARA OR
      586    12335    4                   LABEL_REFERENCE$ -> LABEL.ID = %SECTION) AND
      587    12336    4                   LABEL_REFERENCE$ -> LABEL.PROC$ = CURRENT_PROC$ THEN
      588    12337    4                  EXIT RESOLUTION_1 ;
      589    12338    4                ELSE
      590    12339    4                  LABEL_REFERENCE$ = LABEL_REFERENCE$ -> LABEL.NEXT ;
      591    12340    4              END ; /* RESOLUTION_1 */
      592    12341
      593    12342    3              IF LABEL_REFERENCE$ = ADDR(NIL) THEN
      594    12343                     %NO_LABEL_ERRORS ;
      595    12393    3              ELSE
      596    12394    4                DO ;
      597    12395        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:22   
      598    12396        /*V*
      599    12397            ONE_LABEL -- If the ST.NEXT field is nil then that means that the label
      600    12398                         exists in only one section.  The label is then checked to make
      601    12399                         sure that there are not duplicates within the same section but
      602    12400                         if not the reference is valid.
      603    12401        */
      604    12402
      605    12403    4                  TEMP$ = LABEL_REFERENCE$ ;
      606    12404    4                  DUPLICATE_LBL = FALSE ;
      607    12405    5   IS_LAB_UNIQUE: DO WHILE TEMP$ -> LABEL.NEXT ~= ADDR (NIL) ; /*#30242*/
      608    12406    5                    TEMP$ = TEMP$ -> LABEL.NEXT ;
      609    12407    5                    IF TEMP$ -> LABEL.ID = %PARA OR TEMP$ -> LABEL.ID = %SECTION
      610    12408    6                        THEN DO ;
      611    12409                           /* %CONST, e.g., is OK */
      612    12410    6                      IF TEMP$ -> LABEL.PROC$ ~= CURRENT_PROC$ THEN EXIT IS_LAB_UNIQUE
             12410                               ;
      613    12411    6                      DUPLICATE_LBL = TRUE ;
      614    12412    6                    END ;
      615    12413    5                  END ; /* IS_LAB_UNIQUE */
      616    12414    4                  IF NOT DUPLICATE_LBL THEN
      617    12415    5                    DO ;
      618    12416
      619    12417    5                      IF LABEL_REFERENCE$ -> LABEL.B.DUPLICATE THEN
      620    12418                             %DUP_LABEL_ERROR ;
      621    12451    5                    END ;
      622    12452    4                  ELSE
      623    12453
      624    12454        /*V*
      625    12455            MULTIPLE_LABELS -- There are multiple label entries by this name in the
      626    12456                               program. If it is a section label then it's an error but
      627    12457                               if it's a paragraph name or switch and a section exists,
      628    12458                               then search for the correct one.
      629    12459        */
      630    12460
      631    12461    5                    DO ;
      632    12462    5                      IF (O2COM.SECTION$ = ADDR(NIL) AND
      633    12463    5                          LABEL_REFERENCE$ -> LABEL.ID = %PARA) OR
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:23   
      634    12464    5                          LABEL_REFERENCE$ -> LABEL.ID = %SECTION THEN
      635    12465                             %DUP_LABEL_ERROR ;
      636    12498    5                      ELSE
      637    12499    6                        DO ;
      638    12500        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:24   
      639    12501        /*V*
      640    12502            SEARCH_FOR_LABEL -- Unqualified label reference.  This loop looks thru the
      641    12503                                label entries of this name in the ST to find the correct
      642    12504                                one.  QUAL$ is the pointer to the label entry's father
      643    12505                                and QLT$ points to the current section name entry in the
      644    12506                                QLT.  They will be equal when the correct label entry is
      645    12507                                found.
      646    12508        */
      647    12509
      648    12510    6                        DUPLICATE_LBL = FALSE ;
      649    12511    6                        START_LBL$ = LABEL_REFERENCE$ ;
      650    12512
      651    12513    7                        DO WHILE LABEL_REFERENCE$ -> LABEL.SECTION$ ~=
      652    12514    7                                 O2COM.SECTION$ OR
      653    12515    7                                 LABEL_REFERENCE$ -> LABEL.PROC$ ~= CURRENT_PROC$ ;
      654    12516    7                          LABEL_REFERENCE$ = LABEL_REFERENCE$ -> LABEL.NEXT ;
      655    12517    7                          IF LABEL_REFERENCE$ = ADDR(NIL) THEN
      656    12518    7                            EXIT ;
      657    12519    7                          IF LABEL_REFERENCE$ -> LABEL.ID = %PARA THEN
      658    12520    7                            DUPLICATE_LBL = TRUE ;
      659    12521    7                        END ;
      660    12522
      661    12523    6                        IF LABEL_REFERENCE$ = ADDR(NIL) AND DUPLICATE_LBL THEN
      662    12524
      663    12525        /*V*
      664    12526            NO_LABEL_IN_SECTION -- There is no label by this name in the appropriate
      665    12527                                   section.  There are duplicate labels in the
      666    12528                                   program so the correct one cannot be distinguished.
      667    12529                                   The ILL's operand will be assigned the pointer of
      668    12530                                   the first label entry in the ST with this name
      669    12531                                   and an error will be produced.
      670    12532        */
      671    12533
      672    12534    7                          DO ;
      673    12535    7                            LABEL_REFERENCE$ = REF$ITEM$ -> DNT.ST$ ;
      674    12536                                 %DUP_LABEL_ERROR ;
      675    12569    7                          END ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:25   
      676    12570    6                        ELSE
      677    12571        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:26   
      678    12572        /*V*
      679    12573            LABEL_IN_SECTION -- A label with the correct name was found in the current
      680    12574                                section.  The pointer is assigned to the ILL entry and
      681    12575                                if there's more than one label entry of this name in the
      682    12576                                section an error is produced.
      683    12577        */
      684    12578
      685    12579    7                          DO ;
      686    12580    7                            IF NOT DUPLICATE_LBL THEN
      687    12581    7                              LABEL_REFERENCE$ = START_LBL$ ;
      688    12582    7                            IF LABEL_REFERENCE$ -> LABEL.B.DUPLICATE THEN
      689    12583                                   %DUP_LABEL_ERROR ;
      690    12616    7                          END ;
      691    12617    6                        END ;
      692    12618    5                    END ;
      693    12619    4                END ;
      694    12620    3            END ;
      695    12621
      696    12622        /*V*
      697    12623            REFERENCE_CLEAN_UP -- Set the referenced and one_ref bits.  Assign the ILL
      698    12624                                  operand the address of the ST entry.
      699    12625        */
      700    12626
      701    12627    2          IF NOT BAD_REFERENCE THEN
      702    12628    3            DO ;
      703    12629    4              IF GOTO_DEST THEN DO ;
      704    12630    5                IF LABEL_REFERENCE$ -> LABEL.B.ENTRY_POINT THEN DO ;
      705    12631                       /* Label to be transferred to is also a program entry point.
      706    12632                          This must be handled with great care, to prevent the
      707    12633                          program entry code from being executed again, which would
      708    12634                          cause a runtime abort. It is necessary to transfer instead
      709    12635                          to the compiler-created label after the %ENTRY. */
      710    12636    5                  TEMP$ = LABEL_REFERENCE$ -> LABEL.PREV_ILS$ ;
      711    12637                       /* This points not to the %GO before the label -- see comments
      712    12638                          in FIND_LABEL_END -- but to what's before the %GO. */
      713    12639                       %NEXT_NON_SUPPORT (POINTER=TEMP$) ; /* ILS for the %GO */
      714    12654    5                  LABEL_REFERENCE$ = TEMP$ -> ILS.ILL$ -> ILL.LOP ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:27   
      715    12655                       /* The %GO's LOP is the desired label to transfer to. */
      716    12656    5                END ;
      717    12657    4                LABEL_REFERENCE$ -> LABEL.B.GOTO_LABEL = TRUE ;
      718    12658    4              END ;
      719    12659    3              IF LABEL_REFERENCE$ -> LABEL.B.REFERENCED THEN
      720    12660    3                LABEL_REFERENCE$ -> LABEL.B.ONE_REF = FALSE ;
      721    12661    3              ELSE
      722    12662    4                DO ;
      723    12663    4                  LABEL_REFERENCE$ -> LABEL.B.REFERENCED = TRUE ;
      724    12664    4                  LABEL_REFERENCE$ -> LABEL.B.ONE_REF = TRUE ;
      725    12665    4                END ;
      726    12666
      727    12667
      728    12668                                                             /*#25279*/
      729    12669    3                IF COMCOM.OB.XREF THEN
      730    12670    3                   IF NOT LABEL_REFERENCE$ -> LABEL.B.COMPILER_CREATED THEN
      731    12671    4                   DO; IF ILS$ = ADDR(NIL) THEN
      732    12672    4                          COMCOM.CURRENT.LINE = LABEL_REFERENCE$ -> LABEL.LINE_NO;
      733    12673    4                       ELSE
      734    12674                              %FIND_LINE_NO;
      735    12690
      736    12691                            %ADD_XREF (SYM  = LABEL_REFERENCE$,
      737    12692                                       ISN  = COMCOM.CURRENT.LINE,
      738    12693                                       TYPE = %XREF_REF);
      739    12711    4                   END;
      740    12712
      741    12713    3              REF$ITEM$ = LABEL_REFERENCE$ ;
      742    12714    3            END ;
      743    12715    2          ELSE
      744    12716                 %IF GCOS ;
      746    12718                 %ENDIF ;
      747    12719    2            REF$ITEM$ = ADDR (NIL) ; /* Mark for Z8FF$FLOW_ANALYSIS */
      748    12720    2   END REFERENCE_RESOLUTION ;
      749    12721        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:28   
      750    12722    1   ALTER_CHECK: PROC ;
      751    12723
      752    12724        /*I*
      753    12725               NAME:  ALTER_CHECK
      754    12726               CALL:  CALL ALTER_CHECK ;
      755    12727
      756    12728              INPUT:  ILL$ -- Ptr to ALTER item
      757    12729             OUTPUT:  LABEL.B.ALTER_CHECK turned on and PRESET created.
      758    12730
      759    12731        DESCRIPTION:  This procedure checks the paragraph that is being altered
      760    12732                      to make sure it can be altered.  A preset item must be created.
      761    12733                      If there is no initial field, a dummy preset (to the altered
      762    12734                      paragraph itself) is still needed, so the tag field will not
      763    12735                      be garbage when the GO TO is actually executed.
      764    12736        */
      765    12737
      766    12738    2   DCL  GO_ILS$ PTR ; /* Ptr to ILS item above GO item in ALTER paragraph */
      767    12739    2   DCL  ALTER_ILS$ PTR ; /* PTR to ILS for paragraph being ALTERed */
      768    12740    2   DCL  TEMP_ILS$  PTR;
      769    12741    2   DCL  LINOI$  PTR; /* PTR for LINOI in GO statement. */
      770    12742
      771    12743        %MACRO CREATE_POINTER_ITEM ;
      772    12744               DO ;
      773    12745                 %NEW_SCALAR (@ST$ = LABEL_REFERENCE$,
      774    12746                              @TYPE = %TYI,
      775    12747                              @DNT$ = ILL$ -> ILL.LOP -> LABEL.DNT$,
      776    12748                              @ELEMENTARY = TRUE) ;
      777    12749                 LABEL_REFERENCE$ -> VARIABLE.ID = %POINTER ;
      778    12750                 LABEL_REFERENCE$ -> VARIABLE.TYPE = %TYP ;
      779    12751                 LABEL_REFERENCE$ -> VARIABLE.ADSC.N = %BYTES_PER_WORD ;
      780    12752
      781    12753                 %INCREMENT_STORAGE_CNT(@ITEM$=LABEL_REFERENCE$) ;
      782    12754
      783    12755                 ILL$ -> ILL.LOP -> LABEL.POINTER$ = LABEL_REFERENCE$ ;
      784    12756               END ;
      785    12757        %MEND ;
      786    12758        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:29   
      787    12759    3          IF ILL$ -> ILL.LOP -> LABEL.ID = %SECTION AND NOT ILL$ -> ILL.LOP -> LABEL.
             12759                   DNT$ -> DNT.B.ERROR_VARIABLE THEN DO ;
      788    12760                 %FIND_LINE_NO ;
      789    12776    3            CALL Z8AE$ERROR(%E$ALTER_SECTION_ERROR,,, ILL$ -> ILL.LOP -> LABEL.DNT$) ;
      790    12777    3            ILL$ -> ILL.LOP = ADDR (NIL) ;
      791    12778    3            RETURN ;
      792    12779    3          END ;
      793    12780
      794    12781    2          ALTER_ILS$ = ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ ;
      795    12782               %NEXT_NON_SUPPORT (POINTER=ALTER_ILS$) ;
      796    12797    2          GO_ILS$ = ALTER_ILS$ ;
      797    12798               %NEXT_NON_SUPPORT (POINTER=GO_ILS$) ;
      798    12813    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.ID = %OS_CALL AND
      799    12814    2              GO_ILS$ -> ILS.ILL$ -> ILL.CODE = %OP_PARA_ENTRY THEN
      800    12815                 %NEXT_NON_SUPPORT (POINTER=GO_ILS$) ;
      801    12830
      802    12831    2          TEMP$ = GO_ILS$ ;
      803    12832               %NEXT_NON_SUPPORT (POINTER=TEMP$) ;
      804    12847    2          TEMP_ILS$ = TEMP$ ;
      805    12848               %NEXT_NON_SUPPORT (POINTER=TEMP_ILS$) ;
      806    12863    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.ID ~= %GO OR
      807    12864    2             (GO_ILS$ -> ILS.ILL$ -> ILL.CODE ~= %GO_UNCONDITIONAL AND
      808    12865    2             GO_ILS$ -> ILS.ILL$ -> ILL.CODE ~= %GO_INVALID_LABEL) OR
      809    12866    2             (TEMP$ -> ILS.ILL$ -> ILL.ID = %DEFLB AND
      810    12867    2             TEMP$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.ENTRY_POINT) OR
      811    12868    2             (TEMP$ -> ILS.ILL$ -> ILL.ID = %GO AND
      812    12869    2             (TEMP_ILS$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB OR
      813    12870    2             TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %PARA OR
      814    12871    2             NOT TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP -> SECTION.B.ENTRY_POINT)) OR
      815    12872                  /* Oh the complications caused by entry points ... */
      816    12873    2             (TEMP$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB AND
      817    12874    2             TEMP$ -> ILS.ILL$ -> ILL.ID ~= %SCOPE AND
      818    12875    2             TEMP$ -> ILS.ILL$ -> ILL.ID ~= %GO AND
      819    12876    2             TEMP$ -> ILS.ILL$ -> ILL.ID ~= %END) THEN
      820    12877    3            DO ;
      821    12878                   %FIND_LINE_NO ;
      822    12894    3              CALL Z8AE$ERROR(%E$ALTER_PARA_ERROR,,, ILL$ -> ILL.LOP -> LABEL.DNT$) ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:30   
      823    12895    3              ILL$ -> ILL.LOP = ADDR(NIL) ;
      824    12896    3              RETURN ;
      825    12897    3            END ;
      826    12898
      827    12899    2          ILL$ -> ILL.LOP -> LABEL.B.ALTER_CHECK = TRUE ; /*ALTER statement valid */
      828    12900
      829    12901    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP ~= ADDR(NIL) AND
      830    12902    2            GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> DNT.ID = %LEXEME THEN
      831    12903    3            DO;
      832    12904    3              TEMP_ILS$ = ILS$;
      833    12905    3              ILS$ = GO_ILS$;
      834    12906    3              CALL REFERENCE_RESOLUTION (ADDR(GO_ILS$ -> ILS.ILL$ -> ILL.LOP), FALSE);
      835    12907    3              ILS$ = TEMP_ILS$;
      836    12908    3            END;
      837    12909
      838    12910               %CREATE_POINTER_ITEM ;
      839    13118
      840    13119    3          IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL) THEN DO ;
      841    13120    4            IF COMCOM.OB.COUNT THEN DO ;
      842    13121    4              TEMP_ILS$ = ALTER_ILS$ ;
      843    13122                   %NEXT_NON_SUPPORT (POINTER=TEMP_ILS$) ;
      844    13137    4              LINOI$ = TEMP_ILS$ ;
      845    13138    5              DO UNTIL LINOI$ -> ILS.ILL$ ~= ADDR (NIL) AND
      846    13139    5                  LINOI$ -> ILS.ILL$ -> ILL.ID = %LINOI ;
      847    13140                     %NEXT_ILS (POINTER=LINOI$) ;
      848    13145    5              END ;
      849    13146    4              TEMP$ = TEMP_ILS$ -> ILS.NEXT ;
      850    13147                   %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP_ILS$->ILS.NEXT) ;
      851    13176                   %NEXT_ILS (POINTER=TEMP_ILS$) ;
      852    13181                   %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP_ILS$->ILS.ILL$) ;
      853    13191    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE = LINOI$ -> ILS.ILL$ -> LINOI.
             13191                       PREV_LINE ;
      854    13192    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.LINE_NO = LINOI$ -> ILS.ILL$ -> LINOI.
             13192                       PREV_LINE ;
      855    13193    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_COL = LINOI$ -> ILS.ILL$ -> LINOI.
             13193                       PREV_COL ;
      856    13194    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.COLUMN_NO = LINOI$ -> ILS.ILL$ -> LINOI.
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:31   
             13194                       PREV_COL ;
      857    13195                   %RESERVE_ILS (ITEM=%OPA, POINTER=TEMP_ILS$->ILS.NEXT) ;
      858    13224                   %NEXT_ILS (POINTER=TEMP_ILS$) ;
      859    13229    4              TEMP_ILS$ -> ILS.DEF = ADDR (NIL) ;
      860    13230                   %RESERVE_ILL (ITEM=%DEFLB, POINTER=TEMP_ILS$->ILS.ILL$) ;
      861    13240    4              CALL Z8AT$CREATE_TEMPORARY (%PARA, TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP) ;
      862    13241    4              TEMP_ILS$ -> ILS.ILL$ -> ILL.LBL = ADDR (NIL) ;
      863    13242    4              TEMP_ILS$ -> ILS.NEXT = TEMP$ ;
      864    13243    4              GO_ILS$ -> ILS.ILL$ -> ILL.LOP = TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ;
      865    13244    4            END ;
      866    13245    3            ELSE
      867    13246    3              GO_ILS$ -> ILS.ILL$ -> ILL.LOP = ILS$ -> ILS.ILL$ -> ILL.LOP ;
      868    13247                   /* If "GO TO." (no destination specified) then set initial
      869    13248                      destination to the label before the GOTO. */
      870    13249    4            IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV OR COMCOM.OB.FIPS.OBS THEN DO ;
      871    13250                   %FIND_LINE_NO (@START_ITEM$=GO_ILS$) ;
      872    13266    4              IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN
      873    13267    4                CALL Z8AE$ERROR (%E$LEVEL_CHECK) ;
      874    13268    4              IF COMCOM.OB.FIPS.OBS THEN
      875    13269    4                CALL Z8AE$ERROR (%E$OBSOLETE) ;
      876    13270    4            END ;
      877    13271    3            ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.GOTO_LABEL = TRUE ;
      878    13272    3          END ;
      879    13273               /* The new %POINTER needs a %PRESET. */
      880    13274    2          CALL RESERVE_PRESET_ITEM(ALTER_ILS$ -> ILS.NEXT, GO_ILS$ -> ILS.ILL$ -> ILL.
             13274                   LOP,
      881    13275    2                                   LABEL_REFERENCE$) ;
      882    13276    3          IF INIT_LINOI$ ~= ADDR (NIL) THEN DO ;
      883    13277                 /* The INIT proc needs to initialize the %POINTER, too. */
      884    13278                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$) ;
      885    13307                 %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP$ -> ILS.ILL$) ;
      886    13317    3            TEMP$ -> ILS.ILL$ -> LINOI = INIT_LINOI$ -> ILS.ILL$ -> LINOI ;
      887    13318                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$ -> ILS.NEXT) ;
      888    13347                 %RESERVE_ILL (ITEM=%ALTER, POINTER=TEMP$ -> ILS.NEXT->ILS.ILL$) ;
      889    13357    3            TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP = ILL$ -> ILL.LOP;
      890    13358    3            TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP = GO_ILS$ -> ILS.ILL$ -> ILL.LOP ;
      891    13359    3            TEMP$ -> ILS.NEXT->ILS.NEXT = INIT_LINOI$ -> ILS.NEXT->ILS.NEXT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:32   
      892    13360    3            INIT_LINOI$ -> ILS.NEXT->ILS.NEXT = TEMP$ ;
      893    13361    3          END ;
      894    13362    2          TEMP_ILS$ = ILS$ ;
      895    13363    2          ILS$ = ALTER_ILS$ ;
      896    13364               %NEXT_NON_LINOI ;
      897    13374    2          ALTER_ILS$ = TEMP$;
      898    13375    2          IF ILS$ -> ILS.ILL$ -> ILL.ID = %PRESET AND
      899    13376    3            ILS$ -> ILS.ILL$ -> ILL.ROP -> DNT.ID = %LEXEME THEN DO ;
      900    13377    3            CALL REFERENCE_RESOLUTION (ADDR (ILS$ -> ILS.ILL$ -> ILL.ROP), FALSE) ;
      901    13378    3            IF ILS$ -> ILS.ILL$ -> ILL.ROP = ADDR (NIL) THEN /* Don't PRESET to nil */
      902    13379    3              ILS$ -> ILS.ILL$ -> ILL.ROP = TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ;
      903    13380    3            IF INIT_LINOI$ ~= ADDR(NIL) THEN
      904    13381    3              ALTER_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP =
      905    13382    3                  ILS$ -> ILS.ILL$ -> ILL.ROP;
      906    13383    3          END ;
      907    13384    2          ELSE IF ILS$ -> ILS.ILL$ -> ILL.ID = %P_A_PRESET AND
      908    13385    3            ILS$ -> ILS.ILL$ -> ILL.LOP -> DNT.ID = %LEXEME THEN DO ;
      909    13386    3            CALL REFERENCE_RESOLUTION (ADDR (ILS$ -> ILS.ILL$ -> ILL.LOP), FALSE) ;
      910    13387    3            IF ILS$ -> ILS.ILL$ -> ILL.LOP = ADDR (NIL) THEN /* Don't PRESET to nil */
      911    13388    3              ILS$ -> ILS.ILL$ -> ILL.LOP = TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ;
      912    13389    3            IF INIT_LINOI$ ~= ADDR(NIL) THEN
      913    13390    3              ALTER_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP =
      914    13391    3                  ILS$ -> ILS.ILL$ -> ILL.LOP;
      915    13392    3          END ;
      916    13393                /* This is in case the GO item has not yet been processed, in which
      917    13394                   case ILL.LOP of the GO item points to DNT instead of ST. */
      918    13395    2          ALTER_ILS$ = ILS$;
      919    13396    2          ILS$ = TEMP_ILS$ ;
      920    13397
      921    13398    2          IF COMCOM.SEGMENTC <= 1 THEN
      922    13399    2            RETURN;
      923    13400
      924    13401         /*
      925    13402            The alter switches in the independent segment need to be reset
      926    13403            each time that segment is brought in, the ILS and ILL items
      927    13404            that will refresh the switch are created and saved on the LTS item
      928    13405            of this segment.
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:33   
      929    13406         */
      930    13407    2        IF ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND
      931    13408    2           ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ~= ADDR(NIL) AND
      932    13409    2           ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      933    13410    2           SEGMENT_LTS.SEGMENT_NO# > %MAX_FIXED_SEG# THEN
      934    13411    3         DO;
      935    13412
      936    13413                 %FIND_LINE_NO (@START_ITEM$ = ILL$ -> ILL.LOP -> LABEL.PREV_ILS$);
      937    13429                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP_ILS$) ;
      938    13458                 %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP_ILS$ -> ILS.ILL$) ;
      939    13468
      940    13469    3            TEMP_ILS$ -> ILS.ILL$ -> LINOI = O2COM.LINE_NO$ -> ILS.ILL$ -> LINOI;
      941    13470
      942    13471                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP_ILS$ -> ILS.NEXT) ;
      943    13500                 %RESERVE_ILL (ITEM=%ALTER, POINTER=TEMP_ILS$ -> ILS.NEXT->ILS.ILL$) ;
      944    13510    3            TEMP_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP = ILL$ -> ILL.LOP;
      945    13511    3            TEMP_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP = GO_ILS$ -> ILS.ILL$ -> ILL.LOP
             13511                     ;
      946    13512    3            TEMP$ = TEMP_ILS$;
      947    13513
      948    13514                 %NEXT_ILS (POINTER=TEMP$);
      949    13519                 %RESERVE_ILS (ITEM=%OPN, POINTER = TEMP$ -> ILS.NEXT);
      950    13548                 %RESERVE_ILL (ITEM=%MVANO, POINTER = TEMP$ -> ILS.NEXT->ILS.ILL$);
      951    13558
      952    13559    3            TEMP$ -> ILS.NEXT-> ILS.ILL$ -> ILL.CODE = %MVANO_LOWER_TO_LOWER;
      953    13560    3            MKCN.CON=ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      954    13561    3                     SEGMENT_LTS.SEGMENT_NO#;
      955    13562
      956    13563    3            CALL Z8AC$MAKE_CONST (TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP);
      957    13564
      958    13565    3            CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,
      959    13566    3                                ADDR(NIL),
      960    13567    3                                TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP);
      961    13568
      962    13569    3            TEMP$ -> ILS.NEXT->ILS.NEXT = ILL$ -> ILL.LOP -> LABEL.SECTION$ ->
      963    13570    3                     SECTION.SEGMENT$ -> SEGMENT_LTS.ALTER_RESET$;
      964    13571    3            ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:34   
      965    13572    3                     SEGMENT_LTS.ALTER_RESET$ = TEMP_ILS$;
      966    13573
      967    13574    3          END;
      968    13575
      969    13576         /*
      970    13577           For an altered GO TO item it might transfer the program control
      971    13578           to several different addresses, the labels in this ALTER statement
      972    13579           are checked and if any independent segment overlay might be
      973    13580           brought in, an ALTER_LTS item is created to save the independent
      974    13581           segment information and chained to the pointer st item's
      975    13582           LTS$ field for later process.
      976    13583         */
      977    13584    2          SEG_LTS$ = ADDR(NIL);
      978    13585    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN
      979    13586    2            SEG_LTS$ = GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> SECTION.SEGMENT$;
      980    13587    2          ELSE
      981    13588    2            IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) THEN
      982    13589    2              SEG_LTS$ = GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.
             13589                       SEGMENT$;
      983    13590
      984    13591    2          IF (SEG_LTS$ ~= ADDR(NIL) AND
      985    13592    2            SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) OR
      986    13593    2            (ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND
      987    13594    2             ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$~= ADDR(NIL) AND
      988    13595    2             ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      989    13596    2             SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) THEN
      990    13597    3            DO;
      991    13598                   %NEW_ALTER_LTS (@POINTER  = LTS$$,
      992    13599                               @SEG_NO#  = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#,
      993    13600                               @LABEL$   = GO_ILS$ -> ILS.ILL$ -> ILL.LOP,
      994    13601                               @NEXT     = ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$)
             13601                                   ;
      995    13696
      996    13697    3              ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$ = LTS$$;
      997    13698    3            END;
      998    13699
      999    13700
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:35   
     1000    13701    2   END ALTER_CHECK ;
     1001    13702        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:36   
     1002    13703    1   CHECK_USE_PROC: PROC (REF_PTR$) ;
     1003    13704        /*I*
     1004    13705               NAME:  CHECK_USE_PROC
     1005    13706               CALL:  CALL CHECK_USE_PROC (ADDR (ST_POINTER$));
     1006    13707          INTERFACE:  CHECK_USE_PROC is called to set the REFERENCED and GOTO_LABEL
     1007    13708                      bits for all USE procedures.
     1008    13709
     1009    13710              INPUT:  REF_PTR$ - PTR to USE procedure entry label.
     1010    13711             OUTPUT:  ST$ -> LABEL.B.REFERENCED, ST$ -> LABEL.B.ONE_REF,
     1011    13712                      ST$ -> LABEL.B.GOTO_LABEL - Attributes of label, as appropriate.
     1012    13713
     1013    13714        DESCRIPTION:  If there is any USE procedure then call REFERENCE_RESOLUTION
     1014    13715                      to mark the SECTION and PARAGRAPH labels as being referenced.
     1015    13716        */
     1016    13717    2   DCL REF_PTR$ PTR ;
     1017    13718    2   DCL REF$ITEM$ PTR BASED (REF_PTR$) ;
     1018    13719    2   DCL REF$ITEM_EPTR EPTR BASED (REF_PTR$) ;
     1019    13720
     1020    13721    2          IF REF$ITEM_EPTR = ENTADDR (NIL) THEN /* No USE procedure */ RETURN ;
     1021    13722    2          CALL REFERENCE_RESOLUTION (REF_PTR$, TRUE) ;
     1022    13723    2          TEMP_ILS$ = REF$ITEM$ -> LABEL.PREV_ILS$ ;
     1023    13724               %NEXT_NON_SUPPORT (POINTER=TEMP_ILS$) ; /* ILS for section label. */
     1024    13739    2          TEMP_ILS$ = TEMP_ILS$ -> ILS.ILL$ -> ILL.LBL ; /* ILS for paragraph. */
     1025    13740    2          CALL REFERENCE_RESOLUTION (ADDR (TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP), FALSE) ;
     1026    13741
     1027    13742    2   END CHECK_USE_PROC ;
     1028    13743        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:37   
     1029    13744    1   SEARCH_FOR_INTDEF: PROC (DNT$$, INTDEF$$) ALTRET ;
     1030    13745        /*I*
     1031    13746               NAME:  SEARCH_FOR_INTDEF
     1032    13747               CALL:  CALL SEARCH_FOR_INTDEF (DNT$,ST$) WHENRETURN DO;
     1033    13748                      < success code >; END ;
     1034    13749          INTERFACE:  None.
     1035    13750              INPUT:  DNT$$ - Pointer to DNT item for which an INTDEF may exist.
     1036    13751             OUTPUT:  INTDEF$$ - Pointer to the INTDEF item if one is found.
     1037    13752        DESCRIPTION:  Search thru the chain of ST items from the DNT item. If one
     1038    13753                      is INTDEF and it can legally satisfy the CALL or CANCEL then
     1039    13754                      return a pointer to it; if none can be found then ALTRETURN.
     1040    13755        */
     1041    13756    2   DCL DNT$$ PTR ;
     1042    13757    2   DCL INTDEF$$ PTR ;
     1043    13758    2          ST$ = DNT$$ -> DNT.ST$ ;
     1044    13759    3          DO WHILE ST$ ~= ADDR (NIL) ;
     1045    13760    4            IF ST$ -> ST.ID = %INTDEF THEN DO ;
     1046    13761    4              FATHER$ = ST$ -> INTDEF.PROC$ -> PROC_.FATHER ;
     1047    13762    5              IF ST$ -> INTDEF.PROC$ -> PROC_.B.COMMON THEN DO ;
     1048    13763    5                TEMP$ = CURRENT_PROC$ ;
     1049    13764    5   CHECK_COMMON_PROGRAM:
     1050    13765    6                DO UNTIL TEMP$ = ADDR (NIL) ;
     1051    13766                       /* COMMON program can be called from its father or
     1052    13767                          any of the father's descendants, but not from its
     1053    13768                          own descendants. Son or grandson cannot call it,
     1054    13769                          but brother, nephew, great nephew, etc., can. */
     1055    13770    6                  IF TEMP$ = ST$ -> INTDEF.PROC$ /* CALL by descendant */
     1056    13771    6                    THEN EXIT CHECK_COMMON_PROGRAM ;
     1057    13772    7                  IF TEMP$ = FATHER$ THEN DO ;
     1058    13773    7                    INTDEF$$ = ST$ ;
     1059    13774    7                    RETURN ;
     1060    13775    7                  END ;
     1061    13776    6                  TEMP$ = TEMP$ -> PROC_.FATHER ;
     1062    13777    6                END ; /* CHECK_COMMON_PROGRAM */
     1063    13778    5              END ;
     1064    13779    5              ELSE IF CURRENT_PROC$ = FATHER$ THEN DO ;
     1065    13780    5                INTDEF$$ = ST$ ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:38   
     1066    13781    5                RETURN ;
     1067    13782    5              END ;
     1068    13783    4            END ;
     1069    13784    3            ST$ = ST$ -> ST.NEXT ;
     1070    13785    3          END ;
     1071    13786    2          ALTRETURN ; /* Sorry - can't find any INTDEF that will do the job. */
     1072    13787    2   END SEARCH_FOR_INTDEF ;
     1073    13788        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:39   
     1074    13789        /*                     MAIN PROGRAM                        */
     1075    13790
     1076    13791    1          ILS$ = COMCOM.H_BRANCH ;
     1077    13792    1          CURRENT_PROC$ = ADDR (NIL) ; /* Since no SCOPE item found yet */
     1078    13793    1          ERR_LINE = -1 ; /* No line */
     1079    13794    1          ERR_DNT$ = ADDR (NIL) ; /* No DNT item either for last error */
     1080    13795
     1081    13796        /*V*
     1082    13797            BRANCH_LIST -- Search the items linked into the branch list.  The ones needing
     1083    13798                           reference resolution (GO, PFORM) will use the procedure
     1084    13799                           REFERENCE RESOLUTION.  Label items are checked to see
     1085    13800                           if it is a section.  If this is true then O2COM.SECTION$
     1086    13801                           is updated as reference resolution needs this information.
     1087    13802        */
     1088    13803
     1089    13804    2          DO WHILE ILS$ ~= ADDR(NIL) ;
     1090    13805    2            ILL$ = ILS$ -> ILS.ILL$ ;
     1091    13806
     1092    13807    2   CASE_STMT:
     1093    13808    3            DO CASE (ILL$ -> ILL.ID) ;
     1094    13809
     1095    13810        /*V*
     1096    13811            SCOPE -- Change CURRENT_SCOPE$ and CURRENT_PROC$ so addresses in this
     1097    13812                     program can be properly resolved.
     1098    13813        */
     1099    13814
     1100    13815    3              CASE (%SCOPE) ;
     1101    13816    3                CURRENT_SCOPE$ = ILL$ ;
     1102    13817    4                IF CURRENT_PROC$ ~= ILL$ -> SCOPE.PROC$ THEN DO ;
     1103    13818    4                  IF ILL$ -> SCOPE.PROC$ = ADDR (NIL) THEN INIT_LINOI$ = ADDR (NIL) ;
     1104    13819    5                  ELSE DO ;
     1105    13820    5                    PROC_SUPP$ = ILL$ -> SCOPE.PROC$ -> PROC_.PROC_SUPP$ ;
     1106    13821        /*V*
     1107    13822            IO_USE_PROCEDURES -- Check USE procedure references for INPUT, etc.,
     1108    13823                                 and mark the procedures as referenced.
     1109    13824        */
     1110    13825    5                    CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.USE_INPUT_LABEL$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:40   
             13825                             ));
     1111    13826    5                    CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.USE_IO_LABEL$));
     1112    13827    5                    CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.
             13827                             USE_OUTPUT_LABEL$));
     1113    13828    5                    CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.
             13828                             USE_EXTEND_LABEL$));
     1114    13829    5                    TEMP$ = PROC_SUPP$ -> PROC_SUPP.INIT_PROC$;
     1115    13830    5                    IF TEMP$ = ADDR (NIL) THEN INIT_LINOI$ = ADDR (NIL) ;
     1116    13831                                                    /* There is no INIT proc */
     1117    13832    6                    ELSE DO ;
     1118    13833    6                      TEMP$ = TEMP$ -> ILS.ILL$ /* PTR to PTR_SET */
     1119    13834    6                              -> ILL.ROP -> LABEL.PREV_ILS$ ;
     1120    13835                           /* Found the beginning of INIT proc; now step forward to the
     1121    13836                              USE_ENTRY */
     1122    13837    7                      DO UNTIL TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.ID = %USE_ENTRY ;
     1123    13838                             %NEXT_ILS (POINTER=TEMP$) ;
     1124    13843    7                      END ;
     1125    13844    6                      INIT_LINOI$ = TEMP$ ; /* ILS for LINOI before USE_ENTRY */
     1126    13845    6                    END ;
     1127    13846    5                  END ;
     1128    13847    4                END ;
     1129    13848    3                CURRENT_PROC$ = ILL$ -> SCOPE.PROC$ ;
     1130    13849    3                O2COM.SECTION$ = ADDR (NIL) ;
     1131    13850        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:41   
     1132    13851        /*V*
     1133    13852            GO -- REFERENCE_RESOLUTION is called and if the reference is valid then
     1134    13853                  the label is marked as having a GO TO reference.
     1135    13854        */
     1136    13855
     1137    13856    3              CASE (%GO) ;
     1138    13857    4                IF ILL$ -> ILL.LOP ~= ADDR (NIL) THEN DO ;
     1139    13858    4                  CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), TRUE) ;
     1140    13859    4                  IF ILL$ -> ILL.LOP = ADDR (NIL) /*#33670*/
     1141    13860    4                    THEN ILL$ -> ILL.CODE = %GO_INVALID_LABEL ;
     1142    13861    4                END ;
     1143    13862
     1144    13863        /*V*
     1145    13864            MULTI_GO -- This is a conditional transfer to both LOP and ROP.
     1146    13865                        Both are marked as having a GO TO reference.
     1147    13866        */
     1148    13867
     1149    13868    3              CASE (%MULTI_GO) ;
     1150    13869    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> MULTI_GO.LOP), TRUE) ;
     1151    13870    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> MULTI_GO.ROP), TRUE) ;
     1152    13871
     1153    13872        /*V*
     1154    13873            DEFLB -- The current section variable is updated to point to the
     1155    13874                     correct section if the DEFLB is for a section.
     1156    13875        */
     1157    13876
     1158    13877    3              CASE (%DEFLB) ;
     1159    13878    3                IF ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN
     1160    13879    3                  O2COM.SECTION$ = ILL$ -> ILL.LOP ;
     1161    13880
     1162    13881        /*V*
     1163    13882             REMEM -- Label passed to a PL6 routine as a REMEMBER arg.
     1164    13883        */
     1165    13884
     1166    13885    3               CASE( %REMEM );
     1167    13886    3                 IF NOT ILL$ -> ILL.LOP -> LABEL.B.DEFINED THEN
     1168    13887    3                   ILL$ -> ILL.LOP = ILL$ -> ILL.LOP -> LABEL.DNT$;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:42   
     1169    13888
     1170    13889    3                 CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), TRUE);
     1171    13890
     1172    13891    3                 IF ILL$ -> ILL.LOP = ADDR(NIL) THEN
     1173    13892    3                   ILS$ -> ILS.ILL$ = ADDR(NIL);
     1174    13893
     1175    13894        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:43   
     1176    13895        /*V*
     1177    13896             PFORM -- Reference resolution is performed on the LOP of the ILL.  If there
     1178    13897                      is an error then no further work is done on the item.  The label
     1179    13898                      in the LOP is marked as a PFORM_START label.  If there is no ROP
     1180    13899                      (PFORM A) then the end label is found for A.  If there is a ROP
     1181    13900                      (PFORM A THRU B) then reference resolution is performed on B and
     1182    13901                      the end label is found for B.
     1183    13902        */
     1184    13903
     1185    13904    3              CASE (%PFORM) ;
     1186    13905    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), FALSE) ;
     1187    13906    3                IF ILL$ -> ILL.LOP ~= ADDR(NIL) THEN
     1188    13907    4                  DO ;
     1189    13908
     1190    13909    4                    IF ILL$ -> ILL.ROP = ADDR(NIL) THEN
     1191    13910    5                      DO ;
     1192    13911    5                        IF ILL$ -> ILL.LOP -> LABEL.P_END$ = ADDR(NIL) THEN
     1193    13912    5                          CALL FIND_LABEL_END(ILL$ -> ILL.LOP) ;
     1194    13913    5                        ELSE
     1195    13914                               %SET_END_LBL_VALUES(@ITEM$=ILL$ -> ILL.LOP) ;
     1196    13920    5                      END ;
     1197    13921    4                    ELSE
     1198    13922    5                      DO ;
     1199    13923    5                        FIRST_LBL$ = ILL$ -> ILL.LOP ;
     1200    13924    5                        CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.ROP), FALSE) ;
     1201    13925    5                        IF ILL$ -> ILL.ROP ~= ADDR(NIL) THEN
     1202    13926    6                          DO ;
     1203    13927
     1204    13928    6                            IF ILL$ -> ILL.ROP -> LABEL.P_END$ = ADDR(NIL) THEN
     1205    13929    6                              CALL FIND_LABEL_END(ILL$ -> ILL.ROP) ;
     1206    13930    6                            ELSE
     1207    13931                                   %SET_END_LBL_VALUES(@ITEM$=ILL$ -> ILL.ROP) ;
     1208    13937    6                          END ;
     1209    13938    5                        ELSE ILL$ -> ILL.LOP = ADDR (NIL) ;
     1210    13939    5                      END ;
     1211    13940    4                  END ;
     1212    13941        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:44   
     1213    13942        /*V*
     1214    13943            ALTER -- REFERENCE_RESOLUTION is called for both the right and left
     1215    13944                     operands.  If the POINTER item has not been checked for validity
     1216    13945                     then that is done.
     1217    13946        */
     1218    13947
     1219    13948    3              CASE (%ALTER) ;
     1220    13949    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), FALSE) ;
     1221    13950    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.ROP), TRUE) ;
     1222    13951
     1223    13952    3                IF ILL$ -> ILL.ROP = ADDR(NIL) THEN
     1224    13953    3                  ILL$ -> ILL.LOP = ADDR(NIL) ;
     1225    13954    3                ELSE
     1226    13955    4                  DO ;
     1227    13956    4                    IF ILL$ -> ILL.LOP ~= ADDR(NIL) THEN
     1228    13957    5                      DO ;
     1229    13958    5                        IF ILL$ -> ILL.LOP -> LABEL.B.ALTER_CHECK THEN
     1230    13959                       /* The item has already been checked for a correct ALTER paragraph */
     1231    13960    5                          ;
     1232    13961    5                        ELSE
     1233    13962    5                          CALL ALTER_CHECK ;
     1234    13963    5                      END;
     1235    13964    4                  END;
     1236    13965
     1237    13966    3                IF COMCOM.SEGMENTC > 1 AND
     1238    13967    3                  ILL$ -> ILL.LOP ~= ADDR(NIL) THEN
     1239    13968    4                  DO;
     1240    13969    4                    IF ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND
     1241    13970    4                       ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ~= ADDR(
             13970                                NIL) AND
     1242    13971    4                       ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
     1243    13972    4                          SEGMENT_LTS.SEGMENT_NO# > %MAX_FIXED_SEG# THEN
     1244    13973    5                      DO;
     1245    13974    5                        IF O2COM.SECTION$ -> SECTION.SEGMENT$ = ADDR(NIL) OR
     1246    13975    5                          ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
     1247    13976    5                          SEGMENT_LTS.SEGMENT_NO# ~=
     1248    13977    5                          O2COM.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:45   
             13977                                   THEN
     1249    13978    6                          DO;
     1250    13979                                 %FIND_LINE_NO;
     1251    13995
     1252    13996    6                            CALL Z8AE$ERROR (%E$ALTER_IND_GOTO);
     1253    13997
     1254    13998    6                          END;
     1255    13999    5                      END;
     1256    14000
     1257    14001    4                      SEG_LTS$ = ADDR(NIL);
     1258    14002    4                      IF ILL$ -> ILL.ROP -> LABEL.ID = %SECTION THEN
     1259    14003    4                        SEG_LTS$ = ILL$ -> ILL.ROP -> SECTION.SEGMENT$;
     1260    14004    4                      ELSE
     1261    14005    4                        IF ILL$ -> ILL.ROP -> LABEL.SECTION$ ~= ADDR(NIL) THEN
     1262    14006    4                          SEG_LTS$ = ILL$ -> ILL.ROP -> LABEL.SECTION$ -> SECTION.
             14006                                   SEGMENT$;
     1263    14007
     1264    14008    4                      IF (SEG_LTS$ ~= ADDR(NIL) AND
     1265    14009    4                        SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) OR
     1266    14010    4                        (ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND
     1267    14011    4                         ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$~= ADDR(
             14011                                  NIL) AND
     1268    14012    4                         ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
     1269    14013    4                         SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) THEN
     1270    14014    5                        DO;
     1271    14015                               %NEW_ALTER_LTS (@POINTER  = LTS$$,
     1272    14016                                           @SEG_NO#  = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#,
     1273    14017                                           @LABEL$   = ILL$ -> ILL.ROP,
     1274    14018                                           @NEXT     =
             14018                                            ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$
             14018                                               );
     1275    14113
     1276    14114    5                          ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$ = LTS$$;
     1277    14115    5                        END;
     1278    14116
     1279    14117    4                        IF SEG_LTS$ ~= ADDR(NIL) THEN
     1280    14118    5                          DO;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:46   
     1281    14119                                   %RESERVE_ILS (ITEM = %OPV, POINTER = TEMP$);
     1282    14148
     1283    14149    5                              TEMP$ -> ILS.DNAME = ILL$ -> ILL.LOP -> LABEL.POINTER$;
     1284    14150
     1285    14151                                   %RESERVE_ILL (ITEM = %MVANO,
     1286    14152                                                 POINTER = TEMP$ -> ILS.ILL$);
     1287    14162
     1288    14163    5                              TEMP$ -> ILS.NEXT = ILS$ -> ILS.NEXT;
     1289    14164    5                              ILS$ -> ILS.NEXT = TEMP$;
     1290    14165    5                              TEMP$ -> ILS.ILL$ -> ILL.CODE = %MVANO_LOWER_TO_LOWER;
     1291    14166    5                              MKCN.CON = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;
     1292    14167
     1293    14168    5                              CALL Z8AC$MAKE_CONST (TEMP$ -> ILS.ILL$ -> ILL.ROP);
     1294    14169
     1295    14170    5                              CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,
     1296    14171    5                                                  ADDR(NIL),
     1297    14172    5                                                  TEMP$ -> ILS.ILL$ -> ILL.LOP);
     1298    14173
     1299    14174    5                              TEMP_ILS$ = TEMP$;
     1300    14175
     1301    14176                                   %NEXT_NON_SUPPORT (POINTER = TEMP_ILS$);
     1302    14191
     1303    14192    5                              IF TEMP_ILS$ -> ILS.ILL$ -> ILL.ID = %DEFLB THEN
     1304    14193    5                                TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ->
     1305    14194    5                                  LABEL.PREV_ILS$ = TEMP$ ;
     1306    14195
     1307    14196    5                          END;
     1308    14197
     1309    14198    4                    END ;
     1310    14199        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:47   
     1311    14200        /*V*
     1312    14201            USER_CALL -- Find out if this CALL can be satisfied by an internal
     1313    14202                         program. If so, plug in the INTDEF pointer in place of the
     1314    14203                         SYMREF pointer, decrement the SYMREF's reference count, and
     1315    14204                         make sure ALTRET$ is ADDR (NIL).
     1316    14205        */
     1317    14206    3              CASE (%USER_CALL) ;
     1318    14207    3                SYMREF$$ = ILL$ -> USER_CALL.DESTINATION$ ;
     1319    14208    3                CALL SEARCH_FOR_INTDEF (SYMREF$$ -> SYMREF_.DNT$,
     1320    14209    3                    ILL$ -> USER_CALL.DESTINATION$)
     1321    14210    4                  WHENRETURN DO ;
     1322    14211    4                    TEMP$ = ILL$->USER_CALL.DESTINATION$->INTDEF.PROC$->
     1323    14212    4                        PROC_.PROC_SUPP$ ;
     1324    14213    4                    TEMP$->PROC_SUPP.REF_COUNT = TEMP$->PROC_SUPP.REF_COUNT + 1 ;
     1325    14214    4                    SYMREF$$ -> SYMREF_.REF_COUNT =
     1326    14215    4                        SYMREF$$ -> SYMREF_.REF_COUNT - 1 ;
     1327    14216    5                    IF ILL$ -> USER_CALL.ALTRET$ ~= ADDR (NIL) THEN DO ;
     1328    14217                           %FIND_LINE_NO ;
     1329    14233    5                      CALL Z8AE$ERROR (%E$INTERNAL_CALL_ALTRET) ;
     1330    14234        /*E*
     1331    14235              ERROR: INTERNAL_CALL_ALTRET
     1332    14236            MESSAGE: OVERFLOW cannot occur on CALLs to internal programs.
     1333    14237        */
     1334    14238    5                      ILL$ -> USER_CALL.ALTRET$ = ADDR (NIL) ;
     1335    14239    5                    END ;
     1336    14240    4                  END ;
     1337    14241    4                  WHENALTRETURN DO ;
     1338    14242    4                    CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> USER_CALL.ALTRET$),
     1339    14243    4                        TRUE) ;
     1340    14244    4                  END ;
     1341    14245                     %IF GCOS ;
     1354    14258                     %ENDIF ;
     1355    14259        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:48   
     1356    14260    3              CASE (%OS_CALL) ;
     1357    14261        /*V*
     1358    14262            OS_CALL -- If CALL identifier or CANCEL then plug in the CSIB pointer.
     1359    14263                       For CANCEL literal also see if it can be satisfied by an
     1360    14264                       internal program. If so, replace the CONST pointer with a
     1361    14265                       pointer to the INTDEF and change the ILL.CODE value.
     1362    14266                       If there is an ON OVERFLOW clause then resolve the address.
     1363    14267        */
     1364    14268    4                IF CURRENT_PROC$ = ADDR (NIL) THEN DO ; /* Can't happen case */
     1365    14269    4                  IF ILL$ -> OS_CALL.CODE ~= %OP_CLOSE_CANCEL THEN
     1366    14270                         /* Except, for this CODE value, it can. */
     1367    14271    4                    CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;
     1368    14272    4                  EXIT CASE_STMT ;
     1369    14273    4                END ;
     1370    14274    3                IF ILL$ -> OS_CALL.CODE = %OP_CALL_ID /* CALL identifier */
     1371    14275    4                  THEN DO ;
     1372    14276    4                    O2COM.CALL_ID = TRUE ;
     1373    14277    4                    TEMP_UBIN = ILL$ -> OS_CALL.LOP -> ARGLIST.N - 2 ;
     1374    14278    4                    ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (TEMP_UBIN) =
     1375    14279    4                        CURRENT_PROC$ -> PROC_.CSIB$ ;
     1376    14280    4                  END ;
     1377    14281    4                ELSE IF ILL$ -> OS_CALL.CODE = %OP_CANCEL THEN DO ;
     1378    14282    4                  ETT$ = ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (0) ;
     1379    14283    4                  ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (1) =
     1380    14284    4                      CURRENT_PROC$ -> PROC_.CSIB$ ;
     1381    14285    4                  IF ETT$ -> ETT.ID = %TRIAD /* CANCEL literal */ THEN
     1382    14286    4                    CALL SEARCH_FOR_INTDEF (ETT$ -> ETT.LOP -> CONST.DNT$, TEMP$)
     1383    14287    5                      WHENRETURN DO ;
     1384    14288    5                        TEMP$ -> INTDEF.PROC$ -> PROC_.B.CANCELED = TRUE ;
     1385    14289                             %NEW_ARGLIST (@POINTER=ILL$ -> OS_CALL.LOP) ;
     1386    14380                             /* Default # of args = 1 and that's what we need. */
     1387    14381    5                        ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (0) =
     1388    14382    5                            TEMP$ -> INTDEF.PROC$ -> PROC_.CSIB$ ;
     1389    14383    5                        ILL$ -> OS_CALL.CODE = %OP_CANCEL_INT ;
     1390    14384    5                      END ;
     1391    14385    5                      WHENALTRETURN DO ;
     1392    14386    5                        SYMREF$$ = COMCOM.SYMREF$ ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:49   
     1393    14387    6                        DO UNTIL SYMREF$$ = ADDR (NIL) ;
     1394    14388    6                          IF SYMREF$$ -> SYMREF_.DNT$ = ETT$ -> ETT.LOP -> CONST.DNT$
     1395    14389    7                            THEN /* SYMREF_ already exists */ DO ;
     1396    14390    7                              SYMREF$$ -> SYMREF_.REF_COUNT =
     1397    14391    7                                  SYMREF$$ -> SYMREF_.REF_COUNT + 1 ;
     1398    14392    7                              EXIT CASE_STMT ;
     1399    14393    7                            END ;
     1400    14394    7                          IF SYMREF$$ -> SYMREF_.NEXT = ADDR (NIL) THEN DO ;
     1401    14395                                 %FIND_LINE_NO ;
     1402    14411                                 %NEW_SYMREF_ (@ST$ = SYMREF$$ -> SYMREF_.NEXT,
     1403    14412                                   @R     = %EXT_PROGRAM,
     1404    14413                                   @DNT$ = ETT$ -> ETT.LOP -> CONST.DNT$,
     1405    14414                                   @PROC$ = CURRENT_PROC$ ) ;
     1406    14479    7                          END ;
     1407    14480    6                          SYMREF$$ = SYMREF$$ -> SYMREF_.NEXT ;
     1408    14481    6                        END ;
     1409    14482    5                      END ;
     1410    14483    4                END ;
     1411    14484    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> OS_CALL.ALTRET$), TRUE) ;
     1412    14485                     %IF GCOS ;
     1427    14500                     %ENDIF ;
     1428    14501
     1429    14502    3            END ; /* CASE_STMT */
     1430    14503
     1431    14504    2            ILS$ = ILL$ -> ILL.BRANCH$ ;
     1432    14505    2          END ;
     1433    14506        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:50   
     1434    14507        /*V*
     1435    14508            DELETE_SATISFIED_SYMREFS -- For all SYMREFs check, if all references are
     1436    14509                                        satisfied then delete the SYMREF from the
     1437    14510                                        chain.
     1438    14511        */
     1439    14512    1          TEMP$ = ADDR (COMCOM.SYMREF$) ;
     1440    14513    2          DO WHILE TEMP$ -> BASED$PTR$ ~= ADDR (NIL) ;
     1441    14514    2            IF TEMP$ -> BASED$PTR$ -> SYMREF_.REF_COUNT = 0 THEN
     1442    14515    2              TEMP$ -> BASED$PTR$ = TEMP$ -> BASED$PTR$ -> SYMREF_.NEXT ;
     1443    14516                   /* Unlink from chain as all references are satisfied already. */
     1444    14517    2            ELSE
     1445    14518    2              TEMP$ = ADDR (TEMP$ -> BASED$PTR$ -> SYMREF_.NEXT) ;
     1446    14519    2          END ;
     1447    14520
     1448    14521    1          TEMP$ = COMCOM.SYMREF$;
     1449    14522    1          COMCOM.SYMREFC = 0;
     1450    14523    2          DO WHILE TEMP$ ~= ADDR(NIL);
     1451    14524
     1452    14525    2            COMCOM.SYMREFC = COMCOM.SYMREFC + 1;
     1453    14526    2            TEMP$ -> SYMREF_.COUNT = COMCOM.SYMREFC;
     1454    14527    2            TEMP$ = TEMP$ -> SYMREF_.NEXT;
     1455    14528
     1456    14529    2          END;
     1457    14530        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:51   
     1458    14531        /*V*
     1459    14532            DUPLICATE_ENTRY_CHECK -- For each ENTRY specified on the PROCEDURE
     1460    14533                                     DIVISION statement, if it is satisfied by more
     1461    14534                                     than one SECTION header then issue an error
     1462    14535                                     message.
     1463    14536        */
     1464    14537    1          ILS$ = COMCOM.H_ENTRY$ ;
     1465    14538    2          DO WHILE ILS$ ~= ADDR (NIL) ;
     1466    14539    2            ILL$ = ILS$ -> ILS.ILL$ ;
     1467    14540    3            IF ILL$ -> ENTRY_ILL.CODE = %SUBROUTINE_ENTRY THEN DO ;
     1468    14541    3              SYMDEF$$ = ILL$ -> ENTRY_ILL.LOP ;
     1469    14542    3              LABEL_REFERENCE$ = SYMDEF$$ -> SYMDEF_.DNT$ -> DNT.ST$ ;
     1470    14543                   /* Will be ADDR (NIL) for main entry point. */
     1471    14544    3   CHECK_ENTRY:
     1472    14545    4              DO WHILE LABEL_REFERENCE$ ~= ADDR (NIL) ;
     1473    14546    4                IF LABEL_REFERENCE$ -> ST.ID = %SECTION THEN
     1474    14547    4                  IF LABEL_REFERENCE$ -> SECTION.PROC$ = SYMDEF$$ -> SYMDEF_.PROC$
     1475    14548    5                    THEN IF LABEL_REFERENCE$ -> SECTION.B.DUPLICATE THEN DO;
     1476    14549    5                      TEMP$ = ILL$ ;
     1477    14550    6                      DO UNTIL TEMP$ -> ENTRY_ILL.CODE ~= %SUBROUTINE_ENTRY ;
     1478    14551    6                        TEMP_ILS$ = TEMP$ -> ENTRY_ILL.PREV_ENTRY_ILS$ ;
     1479    14552    6                        TEMP$ = TEMP_ILS$ -> ILS.ILL$ ;
     1480    14553    6                      END ;
     1481    14554                           %NEXT_ILS (POINTER = TEMP_ILS$) ;
     1482    14559    5                      COMCOM.CURRENT.LINE = TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE ;
     1483    14560    5                      COMCOM.CURRENT.COLUMN = TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_COL ;
     1484    14561    5                      CALL Z8AE$ERROR (%E$DUP_LABEL,,, SYMDEF$$ -> SYMDEF_.DNT$) ;
     1485    14562    5                      EXIT CHECK_ENTRY ;
     1486    14563    5                    END ;
     1487    14564    4                LABEL_REFERENCE$ = LABEL_REFERENCE$ -> ST.NEXT ;
     1488    14565    4              END ;
     1489    14566    3            END ;
     1490    14567    2            ILS$ = ILL$ -> ENTRY_ILL.PREV_ENTRY_ILS$ ;
     1491    14568    2          END ;
     1492    14569        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:52   
     1493    14570        /*V*
     1494    14571            WALK_FILE_LTS_CHAIN -- Check all elements in the file lts chain. If any
     1495    14572                                   reference USE procedures then resolve the
     1496    14573                                   USE procedure references.
     1497    14574        */
     1498    14575    1          LTS$ = COMCOM.USE_PROC_CHAIN$ ;
     1499    14576    2          DO WHILE LTS$ ~= ADDR (NIL) ;
     1500    14577    2            CALL CHECK_USE_PROC (ADDR (LTS$ -> USE.PROC_LABEL$));
     1501    14578                 /* Actually the USE procedure is referenced by CALL, not GOTO,
     1502    14579                    but to Phase 2 there is no difference. If the same procedure is
     1503    14580                    the object of a PERFORM then that PERFORM must not be
     1504    14581                    optimized. */
     1505    14582    2            LTS$ = LTS$ -> USE.PROC_CHAIN$ ;
     1506    14583    2          END ;
     1507    14584    1   END Z8FL$LABEL_REFERENCE ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:53   
--  Include file information  --

   Z8A_XREF.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8FL$LABEL_REFERENCE.

   Procedure Z8FL$LABEL_REFERENCE requires 3536 words for executable code.
   Procedure Z8FL$LABEL_REFERENCE is declared NOAUTO and requires 84 words of local(STATIC) storage.

    No errors detected in file Z8FL.:Z8A6TSI    .

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:54   

 Object Unit name= Z8FL$LABEL_REFERENCE                       File name= Z8FL.:Z8A6TOU
 UTS= AUG 09 '97 13:08:21.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    84    124  Z8FL$LABEL_REFERENCE
    1  LblCom even  none     1      1  ITERATION
    2  LblCom even  none     1      1  DNT$
    3  LblCom even  none     5      5  DNT_
    4  LblCom even  none     1      1  DNT_BUCKET_NUMBER
    5  LblCom even  none     1      1  DNT_OF_1$
    6  LblCom even  none     1      1  ETT$
    7  LblCom even  none     1      1  HEAD_ETT$
    8  LblCom even  none   512   1000  ETT_BUCKETS
    9  LblCom even  none     5      5  ETT_
   10  LblCom even  none     1      1  LTS$
   11  LblCom even  none     5      5  LTS_
   12  LblCom even  none    12     14  O2COM
   13  LblCom even  none     1      1  ST$
   14  LblCom even  none     5      5  ST_
   15  LblCom even  none     1      1  ILL$
   16  LblCom even  none     5      5  ILL_
   17  LblCom even  none     1      1  ILS$
   18  LblCom even  none     5      5  ILS_
   19  LblCom even  none     2      2  MKCN
   20  LblCom even  none     1      1  XREF$
   21  LblCom even  none     5      5  XREF_
   22   Proc  even  none  3536   6720  Z8FL$LABEL_REFERENCE
   23  RoData even  none    45     55  Z8FL$LABEL_REFERENCE
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:55   

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    22      0   yes            yes      Std        0  Z8FL$LABEL_REFERENCE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std      12 Z8AE$ERROR
         yes           Std       1 Z8AR$RESERVER
         yes           Std       3 Z8AF$NEW_BASE
         yes           Std       1 Z8AC$MAKE_CONST
         yes           Std       2 Z8AT$CREATE_TEMPORARY

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     COMCOM                           r    LTS_STEP                         r    ILL_STEP
r    ILS_STEP_TABLE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:56   


        1        1        /*M*    Z8FL$LABEL_REFERENCE  Label reference resolution  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8               NAME:  Z8FL$LABEL_REFERENCE
        9        9            PURPOSE:  Check the correctness of a label reference.  If the label is
       10       10                      unqualified then reset the pointer from the DNT entry to the ST.
       11       11        */
       12       12
       13       13        /*D*
       14       14               NAME:  Z8FL$LABEL_REFERENCE
       15       15               CALL:  CALL Z8FL$LABEL_REFERENCE ;
       16       16
       17       17              INPUT:  The QLT, ILL, and ST are accessed.
       18       18             OUTPUT:  LBL$ -- The ptr to the ST entry for the label is stored
       19       19                              in either ILL.ROP or ILL.LOP depending on the call.
       20       20            SCRATCH:  COMCOM.CURRENT.LINE  For error message
       21       21
       22       22        DESCRIPTION:  This procedure performs resolution of label references.
       23       23                      Phase 1 can't determine all label references due to undefined
       24       24                      labels or ambiguity. A reference that at one point is defined may
       25       25                      later turn out to be ambiguous.  Z8FB links all label
       26       26                      references together as well as the labels themselves and
       27       27                      then this procedures searches thru the list to operate on
       28       28                      each item.
       29       29
       30       30                       examples:
       31       31                           1)  (legal)
       32       32
       33       33                                  GO TO B OF A.
       34       34                               A SECTION.
       35       35                               B.
       36       36
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:57   
       37       37                           2)   ERROR-ambiguous reference because there are two
       38       38                                      paragraphs of the same name. It is legal to have
       39       39                                      an ambiguous paragraph structure like this as long
       40       40                                      as neither label is referenced.
       41       41
       42       42                                  GO TO B OF A.
       43       43                               A SECTION.
       44       44                               B.
       45       45                                  MOVE 5 TO COMP6.
       46       46                               B.
       47       47
       48       48                           3)  interpreted by this procedure to be GO TO B OF A.
       49       49
       50       50                                  GO TO B.
       51       51                               A SECTION.
       52       52                               B.
       53       53                                  MOVE 5 TO COMP6.
       54       54                               C SECTION.
       55       55                               B.
       56       56
       57       57
       58       58        */
       59       59        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:58   
       60       60        Z8FL$LABEL_REFERENCE: PROC NOAUTO ;

     60 22 000000   000000 741200 0     Z8FL$LABEL_* STX1  ! 0
        22 000001   004737 710000 22                 TRA     s:13791

       61       61        %EQU PHASE = 2 ;
       62       62        %INCLUDE Z8A_DEFC ;
       63      130        %INCLUDE Z8A_SUPP_MAC ;
       64     2530        %INCLUDE Z9A_FLAGS ;
       65     2544        %INCLUDE Z8A_COMCOM ;
       66     3194        %INCLUDE Z8A_DNT ;
       67     3415        %INCLUDE Z8A_ERR_NUMS ;
       68     4179        %INCLUDE Z8A_ETT ;
       69     4480        %INCLUDE Z8A_LTS ;
       70     6557        %INCLUDE Z8F_O2COM ;
       71     6667        %INCLUDE Z8A_ST ;
       72    10326        %INCLUDE Z8A_TYPES ;
       73    10500        %INCLUDE Z8A_ILL ;
       74    11193        %INCLUDE Z8A_ILS ;
       75    11302        %INCLUDE Z8A_LIBRARY ;
       76    11516        %INCLUDE Z8A_MKCN ;
       77    11533        %INCLUDE Z8A_XREF ;
       78    11605        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:59   
       79    11606    1   DCL Z8AE$ERROR  ENTRY (12) ;
       80    11607    1   DCL Z8AT$CREATE_TEMPORARY ENTRY (2) ;
       81    11608    1   DCL Z8AF$NEW_BASE  ENTRY (3) ;
       82    11609    1   DCL Z8AC$MAKE_CONST  ENTRY (1);
       83    11610
       84    11611    1   DCL END_LBL_SYM$ PTR STATIC ; /* Ptr to created label entry in ST  */
       85    11612    1   DCL END_TEMP$    PTR STATIC ; /* Ptr to temp created for the end label */
       86    11613    1   DCL END_ILS$     PTR STATIC ; /* Ptr to created label entry in ILS */
       87    11614    1   DCL SRCH_LBL$    PTR STATIC ; /* Ptr to labels being searched for end */
       88    11615    1   DCL PREV_LBL$    PTR STATIC ; /* Ptr to prior label in search */
       89    11616    1   DCL TEMP_ILS$    PTR ;        /* Ptr to where end label to be put */
       90    11617    1   DCL START_LBL$   PTR STATIC ; /* Ptr to start label in section search */
       91    11618    1   DCL FIRST_LBL$   PTR STATIC ; /* Ptr to LOP of ILL for PFORM */
       92    11619    1   DCL PRESET_ILS$  PTR STATIC ; /* Ptr to PRESET entry for ALTERs */
       93    11620    1   DCL FATHER$      PTR ; /* PTR to father of internal program */
       94    11621    1   DCL SYMREF$$     PTR ; /* PTR to the SYMREF_ for a CALL literal */
       95    11622    1   DCL SYMDEF$$ REDEF SYMREF$$ PTR ; /* PTR to SYMDEF for an ENTRY */
       96    11623    1   DCL CURRENT_PROC$ PTR ; /* PTR to current Proc_ ST item */
       97    11624    1   DCL PROC_SUPP$   PTR ; /* PTR to current PROC_SUPP item */
       98    11625    1   DCL CURRENT_SCOPE$ PTR ; /* PTR to last SCOPE ILL encountered. */
       99    11626    1   DCL INIT_LINOI$  PTR ; /* PTR to ILS for first LINOI of an init proc */
      100    11627    1   DCL TEMP$        PTR ;
      101    11628    1   DCL BASED$PTR$   PTR BASED ;
      102    11629    1   DCL TEMP_UBIN    UBIN ;
      103    11630    1   DCL LABEL_REFERENCE$ PTR STATIC ; /* Ptr to label being referenced */
      104    11631    1   DCL DUPLICATE_LBL BIT(1) ALIGNED STATIC ;
             11631            /* Duplicate label found in section search */
      105    11632        %IF GCOS ;
      107    11634        %ENDIF ;
      108    11635    1   DCL ERR_LINE     SBIN ;       /* Line at which last error detected */
      109    11636    1   DCL ERR_COL      SBIN ;       /* Column at which last error detected */
      110    11637    1   DCL ERR_DNT$     PTR ;        /* PTR to DNT item for last error */
      111    11638    1   DCL LTS$$          PTR;
      112    11639    1   DCL SEG_LTS$       PTR;
      113    11640
      114    11641        %MACRO SET_END_LBL_VALUES(@ITEM$=ILL$ -> ILL.LOP) ;
      115    11642               DO ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:60   
      116    11643                 ILL$ -> ILL.ROP = @ITEM$ -> LABEL.P_END$ ;
      117    11644                 ILL$ -> ILL.ROP -> LABEL.B.ONE_REF = FALSE ;
      118    11645               END ;
      119    11646        %MEND ;
      120    11647        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:61   
      121    11648
      122    11649    1   RESERVE_PRESET_ITEM: PROC (PREV_ENTRY$, ALTER_LBL$, POINTER$) ;

  11649 22 000002   000042 741200 0     RESERVE_PRE* STX1  ! SEG_LTS$+1

      123    11650
      124    11651        /*I*
      125    11652               NAME:  RESERVE_PRESET_ITEM
      126    11653               CALL:  CALL RESERVE_PRESET_ITEM(PREV_ENTRY$, ALTER_LBL$, POINTER$) ;
      127    11654
      128    11655              INPUT:  PREV_ENTRY$ - Pointer to previous entry in ILS.
      129    11656                      ALTER_LBL$ - Label to be assigned to POINTER variable
      130    11657                      POINTER$ - Pointer to POINTER variable being set
      131    11658             OUTPUT:  PREV_ENTRY$ -> ILS.NEXT is assigned the PRESET item.
      132    11659
      133    11660        DESCRIPTION:  This procedure creates a OPN entry in the ILS to include a PRESET
      134    11661                      item. The PRESET entry is used to set the POINTER variable
      135    11662                      to label entry of the GO statement in the ALTER paragraph.
      136    11663                      The POINTER variable is assigned a storage location and the storage
      137    11664                      counter is incremented.
      138    11665        */
      139    11666
      140    11667    2   DCL  PREV_ENTRY$   PTR ; /* Pointer to previous entry in ILS */
      141    11668    2   DCL  ALTER_LBL$    PTR ; /* Pointer to label being assigned to POINTER */
      142    11669    2   DCL  POINTER$       PTR ; /* Pointer to POINTER variable */
      143    11670
      144    11671    2   DCL  PRESET_ILS$    PTR ; /* Pointer to OPN item above PRESET */
      145    11672    2   DCL  SEG_NO#        SBIN WORD;
      146    11673        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:62   
      147    11674    2          SEG_NO# = 0;

  11674 22 000003   000047 450000 0                  STZ     SEG_NO#

      148    11675    2          IF ALTER_LBL$ -> LABEL.ID ~= %SECTION AND

  11675 22 000004   000044 470400 0                  LDP0    @ALTER_LBL$
        22 000005   000000 471500                    LDP1    0,,PR0
        22 000006   100000 220100                    LDX0    0,,PR1
        22 000007   000770 100003                    CMPX0   504,DU
        22 000010   000024 600000 22                 TZE     s:11681
        22 000011   100007 236100                    LDQ     7,,PR1
        22 000012   000000 116000 23                 CMPQ    0
        22 000013   000024 600000 22                 TZE     s:11681
        22 000014   100007 473500                    LDP3    7,,PR1
        22 000015   300007 236100                    LDQ     7,,PR3
        22 000016   000000 116000 23                 CMPQ    0
        22 000017   000024 600000 22                 TZE     s:11681

      149    11676    2            ALTER_LBL$ -> LABEL.SECTION$ ~= ADDR(NIL) AND
      150    11677    2            ALTER_LBL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN
      151    11678    2            SEG_NO# = ALTER_LBL$ -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->

  11678 22 000020   300007 474500                    LDP4    7,,PR3
        22 000021   400002 235100                    LDA     2,,PR4
        22 000022   000047 755000 0                  STA     SEG_NO#
        22 000023   000032 710000 22                 TRA     s:11704

      152    11679    2                      SEGMENT_LTS.SEGMENT_NO#;
      153    11680    2          ELSE
      154    11681    2            IF ALTER_LBL$ -> SECTION.SEGMENT$ ~= ADDR(NIL) THEN

  11681 22 000024   100007 236100                    LDQ     7,,PR1
        22 000025   000000 116000 23                 CMPQ    0
        22 000026   000032 600000 22                 TZE     s:11704

      155    11682    2              SEG_NO# = ALTER_LBL$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:63   

  11682 22 000027   100007 473500                    LDP3    7,,PR1
        22 000030   300002 235100                    LDA     2,,PR3
        22 000031   000047 755000 0                  STA     SEG_NO#

      156    11683
      157    11684               %RESERVE_ILS(ITEM=%OPN, POINTER=PRESET_ILS$) ;

  11704 22 000032   000002 236000 18                 LDQ     ILS_+2
        22 000033   000004 036007                    ADLQ    4,DL
        22 000034   000003 116000 18                 CMPQ    ILS_+3
        22 000035   000046 602000 22                 TNC     s:11706

  11705 22 000036   000002 236000 23                 LDQ     2
        22 000037   000074 756000 0                  STQ     @INTDEF$$+1
        22 000040   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 000041   000075 451400 0                  STP1    @INTDEF$$+2
        22 000042   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000043   000001 631400 23                 EPPR1   1
        22 000044   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000045   000000 011000                    NOP     0

  11706 22 000046   000002 236000 18                 LDQ     ILS_+2
        22 000047   000022 736000                    QLS     18
        22 000050   000001 036000 18                 ADLQ    ILS_+1
        22 000051   000046 756000 0                  STQ     PRESET_ILS$

  11707 22 000052   000002 235000 18                 LDA     ILS_+2
        22 000053   000004 035007                    ADLA    4,DL
        22 000054   000002 755000 18                 STA     ILS_+2

  11708 22 000055   000740 220003                    LDX0    480,DU
        22 000056   000046 470400 0                  LDP0    PRESET_ILS$
        22 000057   000000 740100                    STX0    0,,PR0

  11709 22 000060   000000 236000 23                 LDQ     0
        22 000061   000002 756100                    STQ     2,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:64   

      158    11713    2          PRESET_ILS$ -> ILS.NEXT = PREV_ENTRY$ -> ILS.NEXT ;

  11713 22 000062   000043 471400 0                  LDP1    @PREV_ENTRY$
        22 000063   100000 473500                    LDP3    0,,PR1
        22 000064   300002 236100                    LDQ     2,,PR3
        22 000065   000002 756100                    STQ     2,,PR0

      159    11714    2          PREV_ENTRY$ -> ILS.NEXT = PRESET_ILS$ ;

  11714 22 000066   100000 473500                    LDP3    0,,PR1
        22 000067   000046 236000 0                  LDQ     PRESET_ILS$
        22 000070   300002 756100                    STQ     2,,PR3

      160    11715
      161    11716    2          IF SEG_NO# < COMCOM.SEG_LIMIT THEN

  11716 22 000071   000047 236000 0                  LDQ     SEG_NO#
        22 000072   000502 116000 xsym               CMPQ    COMCOM+322
        22 000073   000136 605000 22                 TPL     s:11737

      162    11717    3            DO;

      163    11718                   %RESERVE_ILL(ITEM=%PRESET, POINTER=PRESET_ILS$ -> ILS.ILL$) ;

  11720 22 000074   000174 235000 xsym               LDA     ILL_STEP+124
        22 000075   000000 755000 1                  STA     ITERATION

  11721 22 000076   000002 236000 16                 LDQ     ILL_+2
        22 000077   000000 036000 1                  ADLQ    ITERATION
        22 000100   000003 116000 16                 CMPQ    ILL_+3
        22 000101   000112 604000 22                 TMI     s:11723

  11722 22 000102   000003 236000 23                 LDQ     3
        22 000103   000074 756000 0                  STQ     @INTDEF$$+1
        22 000104   000074 633400 0                  EPPR3   @INTDEF$$+1
        22 000105   000075 453400 0                  STP3    @INTDEF$$+2
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:65   
        22 000106   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000107   000001 631400 23                 EPPR1   1
        22 000110   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000111   000000 011000                    NOP     0

  11723 22 000112   000002 236000 16                 LDQ     ILL_+2
        22 000113   000022 736000                    QLS     18
        22 000114   000001 036000 16                 ADLQ    ILL_+1
        22 000115   000046 470400 0                  LDP0    PRESET_ILS$
        22 000116   000003 756100                    STQ     3,,PR0

  11724 22 000117   000002 236000 16                 LDQ     ILL_+2
        22 000120   000000 036000 1                  ADLQ    ITERATION
        22 000121   000002 756000 16                 STQ     ILL_+2

  11725 22 000122   000003 471500                    LDP1    3,,PR0
        22 000123   000422 220003                    LDX0    274,DU
        22 000124   100000 740100                    STX0    0,,PR1

      164    11728
      165    11729    3              PRESET_ILS$ -> ILS.ILL$ -> ILL.LOP = POINTER$ ;

  11729 22 000125   000003 471500                    LDP1    3,,PR0
        22 000126   000045 473400 0                  LDP3    @POINTER$
        22 000127   300000 236100                    LDQ     0,,PR3
        22 000130   100001 756100                    STQ     1,,PR1

      166    11730    3              PRESET_ILS$ -> ILS.ILL$ -> ILL.ROP = ALTER_LBL$ ;

  11730 22 000131   000003 471500                    LDP1    3,,PR0
        22 000132   000044 474400 0                  LDP4    @ALTER_LBL$
        22 000133   400000 236100                    LDQ     0,,PR4
        22 000134   100002 756100                    STQ     2,,PR1

      167    11731    3            END;

  11731 22 000135   000202 710000 22                 TRA     s:11750
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:66   

      168    11732    2          ELSE
      169    11733    3            DO;

      170    11734                   %RESERVE_ILL (ITEM = %P_A_PRESET,
      171    11735                                 POINTER = PRESET_ILS$ -> ILS.ILL$);

  11737 22 000136   000220 235000 xsym               LDA     ILL_STEP+144
        22 000137   000000 755000 1                  STA     ITERATION

  11738 22 000140   000002 236000 16                 LDQ     ILL_+2
        22 000141   000000 036000 1                  ADLQ    ITERATION
        22 000142   000003 116000 16                 CMPQ    ILL_+3
        22 000143   000154 604000 22                 TMI     s:11740

  11739 22 000144   000003 236000 23                 LDQ     3
        22 000145   000074 756000 0                  STQ     @INTDEF$$+1
        22 000146   000074 633400 0                  EPPR3   @INTDEF$$+1
        22 000147   000075 453400 0                  STP3    @INTDEF$$+2
        22 000150   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000151   000001 631400 23                 EPPR1   1
        22 000152   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000153   000000 011000                    NOP     0

  11740 22 000154   000002 236000 16                 LDQ     ILL_+2
        22 000155   000022 736000                    QLS     18
        22 000156   000001 036000 16                 ADLQ    ILL_+1
        22 000157   000046 470400 0                  LDP0    PRESET_ILS$
        22 000160   000003 756100                    STQ     3,,PR0

  11741 22 000161   000002 236000 16                 LDQ     ILL_+2
        22 000162   000000 036000 1                  ADLQ    ITERATION
        22 000163   000002 756000 16                 STQ     ILL_+2

  11742 22 000164   000003 471500                    LDP1    3,,PR0
        22 000165   000446 220003                    LDX0    294,DU
        22 000166   100000 740100                    STX0    0,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:67   

      172    11745    3              PRESET_ILS$ -> ILS.ILL$ -> P_A_PRESET.LOP = ALTER_LBL$;

  11745 22 000167   000003 471500                    LDP1    3,,PR0
        22 000170   000044 473400 0                  LDP3    @ALTER_LBL$
        22 000171   300000 236100                    LDQ     0,,PR3
        22 000172   100001 756100                    STQ     1,,PR1

      173    11746    3              PRESET_ILS$ -> ILS.ILL$ -> P_A_PRESET.ROPCON = SEG_NO#;

  11746 22 000173   000003 471500                    LDP1    3,,PR0
        22 000174   000047 235000 0                  LDA     SEG_NO#
        22 000175   100002 755100                    STA     2,,PR1

      174    11747    3              PRESET_ILS$ -> ILS.ILL$ -> P_A_PRESET.TO_ = POINTER$;

  11747 22 000176   000003 471500                    LDP1    3,,PR0
        22 000177   000045 474400 0                  LDP4    @POINTER$
        22 000200   400000 236100                    LDQ     0,,PR4
        22 000201   100003 756100                    STQ     3,,PR1

      175    11748    3            END;

      176    11749
      177    11750    2   END RESERVE_PRESET_ITEM ;

  11750 22 000202   000042 221200 0                  LDX1  ! SEG_LTS$+1
        22 000203   000001 702211                    TSX2  ! 1,X1

      178    11751        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:68   
      179    11752    1   CREATE_END_LABEL: PROC (PREV_ENTRY$) ;

  11752 22 000204   000050 741200 0     CREATE_END_* STX1  ! SEG_NO#+1

      180    11753
      181    11754        /*I*
      182    11755               NAME:  CREATE_END_LABEL
      183    11756               CALL:  CALL CREATE_END_LABEL(PREV_ENTRY$) ;
      184    11757          INTERFACE:  Z8AT$CREATE_TEMPORARY is called to create a paragraph item.
      185    11758
      186    11759              INPUT:  PREV_ENTRY$ - Ptr to the ILS entry preceding target location
      187    11760                                    of end label being created.
      188    11761             OUTPUT:  A DEFLB entry together with the associated ILS and LINOI
      189    11762                      entries are entered into the tables and link.
      190    11763
      191    11764        DESCRIPTION:  CREATE_END_LABEL is called to create a label at the end of
      192    11765                      a paragraph or section.  These are used to conclude a PERFORM
      193    11766                      code group.
      194    11767
      195    11768                      A paragraph symbol is created. A DEFLB is set up for it.
      196    11769                      The pointers are then reset in the ILS to enter the item in
      197    11770                      its proper position.
      198    11771        */
      199    11772
      200    11773    2   DCL PREV_ENTRY$   PTR ; /* Pointer to previous entry in ILS */
      201    11774        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:69   
      202    11775
      203    11776    2          CALL Z8AT$CREATE_TEMPORARY(%PARA, END_LBL_SYM$) ;

  11776 22 000205   000006 630400 23                 EPPR0   6
        22 000206   000004 631400 23                 EPPR1   4
        22 000207   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 000210   000000 011000                    NOP     0

      204    11777    2          END_LBL_SYM$ -> LABEL.B.REFERENCED = TRUE ;

  11777 22 000211   000012 470400 0                  LDP0    END_LBL_SYM$
        22 000212   400000 236003                    LDQ     -131072,DU
        22 000213   000003 256100                    ORSQ    3,,PR0

      205    11778    2          END_LBL_SYM$ -> LABEL.B.ONE_REF = TRUE ;

  11778 22 000214   000012 470400 0                  LDP0    END_LBL_SYM$
        22 000215   010000 236003                    LDQ     4096,DU
        22 000216   000003 256100                    ORSQ    3,,PR0

      206    11779    2          END_LBL_SYM$ -> LABEL.B.PFORM_END_LBL = TRUE ;

  11779 22 000217   000012 470400 0                  LDP0    END_LBL_SYM$
        22 000220   000400 236007                    LDQ     256,DL
        22 000221   000003 256100                    ORSQ    3,,PR0

      207    11780    2          END_LBL_SYM$ -> LABEL.PREV_ILS$ = PREV_ENTRY$ ;

  11780 22 000222   000051 470400 0                  LDP0    @PREV_ENTRY$
        22 000223   000000 236100                    LDQ     0,,PR0
        22 000224   000012 471400 0                  LDP1    END_LBL_SYM$
        22 000225   100010 756100                    STQ     8,,PR1

      208    11781    2          END_LBL_SYM$ -> LABEL.PROC$ = CURRENT_PROC$ ;

  11781 22 000226   000025 236000 0                  LDQ     CURRENT_PROC$
        22 000227   000012 471400 0                  LDP1    END_LBL_SYM$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:70   
        22 000230   100011 756100                    STQ     9,,PR1

      209    11782    2          END_LBL_SYM$ -> LABEL.P_START$ = ILL$ -> ILL.LOP ;

  11782 22 000231   000000 471400 15                 LDP1    ILL$
        22 000232   100001 236100                    LDQ     1,,PR1
        22 000233   000012 473400 0                  LDP3    END_LBL_SYM$
        22 000234   300001 756100                    STQ     1,,PR3

      210    11783
      211    11784               %RESERVE_ILS(ITEM=%OPN, POINTER=END_ILS$) ;

  11804 22 000235   000002 236000 18                 LDQ     ILS_+2
        22 000236   000004 036007                    ADLQ    4,DL
        22 000237   000003 116000 18                 CMPQ    ILS_+3
        22 000240   000251 602000 22                 TNC     s:11806

  11805 22 000241   000002 236000 23                 LDQ     2
        22 000242   000074 756000 0                  STQ     @INTDEF$$+1
        22 000243   000074 633400 0                  EPPR3   @INTDEF$$+1
        22 000244   000075 453400 0                  STP3    @INTDEF$$+2
        22 000245   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000246   000001 631400 23                 EPPR1   1
        22 000247   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000250   000000 011000                    NOP     0

  11806 22 000251   000002 236000 18                 LDQ     ILS_+2
        22 000252   000022 736000                    QLS     18
        22 000253   000001 036000 18                 ADLQ    ILS_+1
        22 000254   000014 756000 0                  STQ     END_ILS$

  11807 22 000255   000002 235000 18                 LDA     ILS_+2
        22 000256   000004 035007                    ADLA    4,DL
        22 000257   000002 755000 18                 STA     ILS_+2

  11808 22 000260   000740 220003                    LDX0    480,DU
        22 000261   000014 470400 0                  LDP0    END_ILS$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:71   
        22 000262   000000 740100                    STX0    0,,PR0

  11809 22 000263   000000 236000 23                 LDQ     0
        22 000264   000002 756100                    STQ     2,,PR0

      212    11813               %RESERVE_ILL(ITEM=%LINOI, POINTER=END_ILS$ -> ILS.ILL$) ;

  11815 22 000265   000145 235000 xsym               LDA     ILL_STEP+101
        22 000266   000000 755000 1                  STA     ITERATION

  11816 22 000267   000002 236000 16                 LDQ     ILL_+2
        22 000270   000000 036000 1                  ADLQ    ITERATION
        22 000271   000003 116000 16                 CMPQ    ILL_+3
        22 000272   000303 604000 22                 TMI     s:11818

  11817 22 000273   000003 236000 23                 LDQ     3
        22 000274   000074 756000 0                  STQ     @INTDEF$$+1
        22 000275   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 000276   000075 451400 0                  STP1    @INTDEF$$+2
        22 000277   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000300   000001 631400 23                 EPPR1   1
        22 000301   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000302   000000 011000                    NOP     0

  11818 22 000303   000002 236000 16                 LDQ     ILL_+2
        22 000304   000022 736000                    QLS     18
        22 000305   000001 036000 16                 ADLQ    ILL_+1
        22 000306   000014 470400 0                  LDP0    END_ILS$
        22 000307   000003 756100                    STQ     3,,PR0

  11819 22 000310   000002 236000 16                 LDQ     ILL_+2
        22 000311   000000 036000 1                  ADLQ    ITERATION
        22 000312   000002 756000 16                 STQ     ILL_+2

  11820 22 000313   000003 471500                    LDP1    3,,PR0
        22 000314   000373 220003                    LDX0    251,DU
        22 000315   100000 740100                    STX0    0,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:72   

      213    11823
      214    11824               %RESERVE_ILS(ITEM=%OPN, POINTER=END_ILS$ -> ILS.NEXT) ;

  11844 22 000316   000002 236000 18                 LDQ     ILS_+2
        22 000317   000004 036007                    ADLQ    4,DL
        22 000320   000003 116000 18                 CMPQ    ILS_+3
        22 000321   000332 602000 22                 TNC     s:11846

  11845 22 000322   000002 236000 23                 LDQ     2
        22 000323   000074 756000 0                  STQ     @INTDEF$$+1
        22 000324   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 000325   000075 451400 0                  STP1    @INTDEF$$+2
        22 000326   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000327   000001 631400 23                 EPPR1   1
        22 000330   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000331   000000 011000                    NOP     0

  11846 22 000332   000002 236000 18                 LDQ     ILS_+2
        22 000333   000022 736000                    QLS     18
        22 000334   000001 036000 18                 ADLQ    ILS_+1
        22 000335   000014 470400 0                  LDP0    END_ILS$
        22 000336   000002 756100                    STQ     2,,PR0

  11847 22 000337   000002 235000 18                 LDA     ILS_+2
        22 000340   000004 035007                    ADLA    4,DL
        22 000341   000002 755000 18                 STA     ILS_+2

  11848 22 000342   000002 471500                    LDP1    2,,PR0
        22 000343   000740 220003                    LDX0    480,DU
        22 000344   100000 740100                    STX0    0,,PR1

  11849 22 000345   000002 471500                    LDP1    2,,PR0
        22 000346   000000 236000 23                 LDQ     0
        22 000347   100002 756100                    STQ     2,,PR1

      215    11853               %RESERVE_ILL(ITEM=%DEFLB, POINTER=END_ILS$ -> ILS.NEXT->ILS.ILL$) ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:73   

  11855 22 000350   000120 235000 xsym               LDA     ILL_STEP+80
        22 000351   000000 755000 1                  STA     ITERATION

  11856 22 000352   000002 236000 16                 LDQ     ILL_+2
        22 000353   000000 036000 1                  ADLQ    ITERATION
        22 000354   000003 116000 16                 CMPQ    ILL_+3
        22 000355   000366 604000 22                 TMI     s:11858

  11857 22 000356   000003 236000 23                 LDQ     3
        22 000357   000074 756000 0                  STQ     @INTDEF$$+1
        22 000360   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 000361   000075 451400 0                  STP1    @INTDEF$$+2
        22 000362   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 000363   000001 631400 23                 EPPR1   1
        22 000364   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 000365   000000 011000                    NOP     0

  11858 22 000366   000014 470400 0                  LDP0    END_ILS$
        22 000367   000002 471500                    LDP1    2,,PR0
        22 000370   000002 236000 16                 LDQ     ILL_+2
        22 000371   000022 736000                    QLS     18
        22 000372   000001 036000 16                 ADLQ    ILL_+1
        22 000373   100003 756100                    STQ     3,,PR1

  11859 22 000374   000002 236000 16                 LDQ     ILL_+2
        22 000375   000000 036000 1                  ADLQ    ITERATION
        22 000376   000002 756000 16                 STQ     ILL_+2

  11860 22 000377   000002 471500                    LDP1    2,,PR0
        22 000400   100003 473500                    LDP3    3,,PR1
        22 000401   000346 220003                    LDX0    230,DU
        22 000402   300000 740100                    STX0    0,,PR3

      216    11863    2          END_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP = END_LBL_SYM$ ;

  11863 22 000403   000002 471500                    LDP1    2,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:74   
        22 000404   100003 473500                    LDP3    3,,PR1
        22 000405   000012 236000 0                  LDQ     END_LBL_SYM$
        22 000406   300001 756100                    STQ     1,,PR3

      217    11864    2          END_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.LBL = PREV_LBL$ -> ILS.ILL$ -> ILL.LBL
             11864                   ;

  11864 22 000407   000002 471500                    LDP1    2,,PR0
        22 000410   100003 473500                    LDP3    3,,PR1
        22 000411   000016 474400 0                  LDP4    PREV_LBL$
        22 000412   400003 475500                    LDP5    3,,PR4
        22 000413   500002 236100                    LDQ     2,,PR5
        22 000414   300002 756100                    STQ     2,,PR3

      218    11865    2          PREV_LBL$ -> ILS.ILL$ -> ILL.LBL = END_ILS$ -> ILS.NEXT ;

  11865 22 000415   400003 471500                    LDP1    3,,PR4
        22 000416   000002 236100                    LDQ     2,,PR0
        22 000417   100002 756100                    STQ     2,,PR1

      219    11866
      220    11867    2          TEMP$ = PREV_ENTRY$ ;

  11867 22 000420   000051 471400 0                  LDP1    @PREV_ENTRY$
        22 000421   100000 236100                    LDQ     0,,PR1
        22 000422   000031 756000 0                  STQ     TEMP$

      221    11868    3          DO UNTIL TEMP$ -> ILS.ILL$ -> ILL.ID = %LINOI ;

      222    11869                 %NEXT_ILS (POINTER=TEMP$) ;

  11871 22 000423   000031 470400 0                  LDP0    TEMP$
        22 000424   000002 236100                    LDQ     2,,PR0
        22 000425   000031 756000 0                  STQ     TEMP$

      223    11874    3          END ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:75   
  11874 22 000426   000031 470400 0                  LDP0    TEMP$
        22 000427   000003 471500                    LDP1    3,,PR0
        22 000430   100000 220100                    LDX0    0,,PR1
        22 000431   000373 100003                    CMPX0   251,DU
        22 000432   000423 601000 22                 TNZ     s:11871

      224    11875    2          END_ILS$ -> ILS.ILL$ -> LINOI = TEMP$ -> ILS.ILL$ -> LINOI ;

  11875 22 000433   000014 473400 0                  LDP3    END_ILS$
        22 000434   300003 474500                    LDP4    3,,PR3
        22 000435   000100 100500                    MLR     fill='000'O
        22 000436   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12
        22 000437   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12

      225    11876    2          END_ILS$ -> ILS.NEXT->ILS.NEXT = PREV_ENTRY$ -> ILS.NEXT ;

  11876 22 000440   300002 470500                    LDP0    2,,PR3
        22 000441   000051 471400 0                  LDP1    @PREV_ENTRY$
        22 000442   100000 474500                    LDP4    0,,PR1
        22 000443   400002 236100                    LDQ     2,,PR4
        22 000444   000002 756100                    STQ     2,,PR0

      226    11877    2          PREV_ENTRY$ -> ILS.NEXT = END_ILS$ ;

  11877 22 000445   100000 470500                    LDP0    0,,PR1
        22 000446   000014 236000 0                  LDQ     END_ILS$
        22 000447   000002 756100                    STQ     2,,PR0

      227    11878
      228    11879    2   END CREATE_END_LABEL ;

  11879 22 000450   000050 221200 0                  LDX1  ! SEG_NO#+1
        22 000451   000001 702211                    TSX2  ! 1,X1

      229    11880        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:76   
      230    11881        /*V*
      231    11882            FIND_LABEL_END -- Search the perform code group to see if the end label
      232    11883                              has already been created.  If it hasn't,an end label is
      233    11884                              created.
      234    11885        */
      235    11886
      236    11887    1   FIND_LABEL_END: PROC (LBL_SYM$) ;

  11887 22 000452   000052 741200 0     FIND_LABEL_* STX1  ! @PREV_ENTRY$+1

      237    11888
      238    11889    2   DCL  LBL_SYM$  PTR  ; /* Ptr to called PERFORM's end label ST entry */
      239    11890        /*I*
      240    11891               NAME:  FIND_LABEL_END
      241    11892               CALL:  CALL FIND_LABEL_END(LBL_SYM$) ;
      242    11893          INTERFACE:  CREATE_END_LABEL is called to create the end label after finding
      243    11894                      its location.
      244    11895
      245    11896              INPUT:  LBL_SYM$  Pointer to label that needs an end label.
      246    11897             OUTPUT:  An end label is created in its proper location.
      247    11898
      248    11899        DESCRIPTION:  This procedure finds the location of the end label and calls
      249    11900                      CREATE_END_LABEL to create one in the desired location.
      250    11901
      251    11902                      The PREV_LBL$ pointer and SRCH_LBL$ are initialized and then a
      252    11903                      search is made thru the label list.  The search continues until
      253    11904                      we find a noncompiler created label ending the PARA or
      254    11905                      SECTION or upon reaching the end of the program.
      255    11906
      256    11907                      *** IMPORTANT NOTE *** - If the PERFORM code group is ended by
      257    11908                      a SECTION label that is also a program entry point, Z8FB has
      258    11909                      set the label's PREV_ILS$ to point not to the previous non-LINOI,
      259    11910                      the GO around the entry point, but to the non-LINOI ILS before
      260    11911                      this GO. That is because the GO must not be PERFORMed.
      261    11912        */
      262    11913        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:77   
      263    11914    2          PREV_LBL$ = LBL_SYM$ -> LABEL.PREV_ILS$ ;

  11914 22 000453   000053 470400 0                  LDP0    @LBL_SYM$
        22 000454   000000 471500                    LDP1    0,,PR0
        22 000455   100010 236100                    LDQ     8,,PR1
        22 000456   000016 756000 0                  STQ     PREV_LBL$

      264    11915               /* Find start label. %NEXT_NON_SUPPORT will not quite do it,
      265    11916                  because the start label could be a program entry point. */
      266    11917    3          DO UNTIL PREV_LBL$ -> ILS.ILL$ -> ILL.ID = %DEFLB ; /*#35059*/

      267    11918                 %NEXT_ILS (POINTER=PREV_LBL$) ;

  11920 22 000457   000016 470400 0                  LDP0    PREV_LBL$
        22 000460   000002 236100                    LDQ     2,,PR0
        22 000461   000016 756000 0                  STQ     PREV_LBL$

      268    11923    3          END ;

  11923 22 000462   000016 470400 0                  LDP0    PREV_LBL$
        22 000463   000003 471500                    LDP1    3,,PR0
        22 000464   100000 220100                    LDX0    0,,PR1
        22 000465   000346 100003                    CMPX0   230,DU
        22 000466   000457 601000 22                 TNZ     s:11920

      269    11924    2          SRCH_LBL$ = PREV_LBL$ -> ILS.ILL$ -> ILL.LBL ;

  11924 22 000467   100002 236100                    LDQ     2,,PR1
        22 000470   000015 756000 0                  STQ     SRCH_LBL$

      270    11925
      271    11926        /*V*
      272    11927            LABEL_SEARCH -- Search the labels until one is found with the same id type
      273    11928                            (PARA or SECTION) or higher (a PARA can end at a SECTION
      274    11929                            label) and it is not compiler-created. This loop is exited
      275    11930                            when the above happens or at the end of the label chain.
      276    11931        */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:78   
      277    11932
      278    11933    2   LABEL_SEARCH:
      279    11934    3          DO WHILE SRCH_LBL$ ~= ADDR(NIL) ;

  11934 22 000471   000536 710000 22    LABEL_SEARCH TRA     s:11961

      280    11935    3            IF SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PROC$ ~= CURRENT_PROC$

  11935 22 000472   000015 470400 0                  LDP0    SRCH_LBL$
        22 000473   000003 471500                    LDP1    3,,PR0
        22 000474   100001 473500                    LDP3    1,,PR1
        22 000475   300011 236100                    LDQ     9,,PR3
        22 000476   000025 116000 0                  CMPQ    CURRENT_PROC$
        22 000477   000502 601000 22                 TNZ     s:11937
        22 000500   300003 430100                    FSZN    3,,PR3
        22 000501   000505 605000 22                 TPL     s:11942

      281    11936    3            OR SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.INIT_PROC
      282    11937    3              THEN SRCH_LBL$ = ADDR (NIL) ;

  11937 22 000502   000000 236000 23                 LDQ     0
        22 000503   000015 756000 0                  STQ     SRCH_LBL$
        22 000504   000536 710000 22                 TRA     s:11961

      283    11938                   /* PERFORM block can be ended by anything in a different
      284    11939                      (nested or consecutive) program, or by the initialization
      285    11940                      procedure for any program. */
      286    11941    4              ELSE DO ;

      287    11942    4                IF SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN

  11942 22 000505   300000 220100                    LDX0    0,,PR3
        22 000506   000770 100003                    CMPX0   504,DU
        22 000507   000540 600000 22                 TZE     s:11971

      288    11943    4                  EXIT LABEL_SEARCH ;
      289    11944                        /* Paragraph or section can end at a section label. */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:79   
      290    11945                        /* See note under DESCRIPTION of this internal procedure for
      291    11946                           info about if the section label is a program entry point.
      292    11947                           The GO around the entry point must not be PERFORMed. */
      293    11948    4                IF LBL_SYM$ -> LABEL.ID = %PARA AND

  11948 22 000510   000053 474400 0                  LDP4    @LBL_SYM$
        22 000511   400000 475500                    LDP5    0,,PR4
        22 000512   500000 221100                    LDX1    0,,PR5
        22 000513   000771 101003                    CMPX1   505,DU
        22 000514   000520 601000 22                 TNZ     s:11952
        22 000515   300003 236100                    LDQ     3,,PR3
        22 000516   100000 316003                    CANQ    32768,DU
        22 000517   000540 600000 22                 TZE     s:11971

      294    11949    4                 NOT SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.COMPILER_CREATED THEN
      295    11950    4                    EXIT LABEL_SEARCH ;
      296    11951                          /* Para. can end at a non-compiler-created paragraph. */
      297    11952    4                IF LBL_SYM$ -> LABEL.SECTION$ ~= ADDR (NIL) AND /* Para. in section */

  11952 22 000520   500007 236100                    LDQ     7,,PR5
        22 000521   000000 116000 23                 CMPQ    0
        22 000522   000532 600000 22                 TZE     s:11958
        22 000523   500007 476500                    LDP6    7,,PR5
        22 000524   600000 222100                    LDX2    0,,PR6
        22 000525   000770 102003                    CMPX2   504,DU
        22 000526   000532 601000 22                 TNZ     s:11958

      298    11953    4                   LBL_SYM$ -> LABEL.SECTION$ -> LABEL.ID = %SECTION THEN
      299    11954    4                  IF LBL_SYM$ -> LABEL.SECTION$ -> LABEL.P_END$ =

  11954 22 000527   600001 236100                    LDQ     1,,PR6
        22 000530   100001 116100                    CMPQ    1,,PR1
        22 000531   000540 600000 22                 TZE     s:11971

      300    11955    4                      SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP THEN
      301    11956    4                    EXIT LABEL_SEARCH ; /* PERFORM of section already compiled.
      302    11957                                   PERFORM of paragraph needs its own end label. */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:80   
      303    11958    4                PREV_LBL$ = SRCH_LBL$ ;

  11958 22 000532   000015 236000 0                  LDQ     SRCH_LBL$
        22 000533   000016 756000 0                  STQ     PREV_LBL$

      304    11959    4                SRCH_LBL$ = SRCH_LBL$ -> ILS.ILL$ -> ILL.LBL ;

  11959 22 000534   100002 236100                    LDQ     2,,PR1
        22 000535   000015 756000 0                  STQ     SRCH_LBL$

      305    11960    4              END ;

      306    11961    3          END ;

  11961 22 000536   000000 116000 23                 CMPQ    0
        22 000537   000472 601000 22                 TNZ     s:11935

      307    11962
      308    11963
      309    11964        /*V*
      310    11965            END_LABEL_CHAIN -- The perform code group is at the end of the program.  If
      311    11966                               there is no end label created for the particular
      312    11967                               code group then one is created.  If one is already
      313    11968                               created then the one_ref bit is set off.
      314    11969        */
      315    11970
      316    11971    2          IF SRCH_LBL$ = ADDR(NIL) THEN

  11971 22 000540   000015 236000 0                  LDQ     SRCH_LBL$
        22 000541   000000 116000 23                 CMPQ    0
        22 000542   000557 601000 22                 TNZ     s:11983

      317    11972    3            DO ;

      318    11973    3              CALL CREATE_END_LABEL(CURRENT_SCOPE$ -> SCOPE.END_ILS$) ;

  11973 22 000543   000027 236000 0                  LDQ     CURRENT_SCOPE$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:81   
        22 000544   000002 036003                    ADLQ    2,DU
        22 000545   000051 756000 0                  STQ     @PREV_ENTRY$
        22 000546   000204 701000 22                 TSX1    CREATE_END_LABEL
        22 000547   000000 011000                    NOP     0

      319    11974    3              CURRENT_SCOPE$ -> SCOPE.END_ILS$ = END_ILS$ ;

  11974 22 000550   000014 236000 0                  LDQ     END_ILS$
        22 000551   000027 470400 0                  LDP0    CURRENT_SCOPE$
        22 000552   000002 756100                    STQ     2,,PR0

      320    11975                   %NEXT_ILS (POINTER=CURRENT_SCOPE$ -> SCOPE.END_ILS$) ;

  11977 22 000553   000002 471500                    LDP1    2,,PR0
        22 000554   100002 236100                    LDQ     2,,PR1
        22 000555   000002 756100                    STQ     2,,PR0

      321    11980    3            END ;

  11980 22 000556   000671 710000 22                 TRA     s:12042

      322    11981    2          ELSE
      323    11982    3            DO ;

      324    11983    3              IF SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.DUPLICATE THEN

  11983 22 000557   000015 470400 0                  LDP0    SRCH_LBL$
        22 000560   000003 471500                    LDP1    3,,PR0
        22 000561   100001 473500                    LDP3    1,,PR1
        22 000562   300003 236100                    LDQ     3,,PR3
        22 000563   020000 316003                    CANQ    8192,DU
        22 000564   000655 600000 22                 TZE     s:12030

      325    11984    4                DO ;

      326    11985        /*V*
      327    11986            DUPLICATE_CLOSING_LABEL -- The label that ends the PERFORM code group
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:82   
      328    11987                                       is one that occurs twice but is itself not
      329    11988                                       referenced. This is legal, but it makes it
      330    11989                                       necessary to use a much slower method to find
      331    11990                                       where to insert the end label.
      332    11991        */
      333    11992    4                  TEMP_ILS$ = PREV_LBL$ ;

  11992 22 000565   000016 236000 0                  LDQ     PREV_LBL$
        22 000566   000017 756000 0                  STQ     TEMP_ILS$

      334    11993    4                  TEMP$ = TEMP_ILS$ ;

  11993 22 000567   000031 756000 0                  STQ     TEMP$

      335    11994                       %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  12004 22 000570   000031 470400 0                  LDP0    TEMP$
        22 000571   000002 236100                    LDQ     2,,PR0
        22 000572   000031 756000 0                  STQ     TEMP$

  12007 22 000573   000031 470400 0                  LDP0    TEMP$
        22 000574   000003 236100                    LDQ     3,,PR0
        22 000575   000000 116000 23                 CMPQ    0
        22 000576   000570 600000 22                 TZE     s:12004
        22 000577   000003 471500                    LDP1    3,,PR0
        22 000600   100000 220100                    LDX0    0,,PR1
        22 000601   000343 100003                    CMPX0   227,DU
        22 000602   000570 600000 22                 TZE     s:12004
        22 000603   000422 100003                    CMPX0   274,DU
        22 000604   000570 600000 22                 TZE     s:12004
        22 000605   000446 100003                    CMPX0   294,DU
        22 000606   000570 600000 22                 TZE     s:12004
        22 000607   000336 100003                    CMPX0   222,DU
        22 000610   000570 600000 22                 TZE     s:12004
        22 000611   000420 100003                    CMPX0   272,DU
        22 000612   000570 600000 22                 TZE     s:12004
        22 000613   000373 100003                    CMPX0   251,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:83   
        22 000614   000570 600000 22                 TZE     s:12004

      336    12009    5                  DO WHILE (TEMP$ -> ILS.ILL$ = ADDR (NIL)

  12009 22 000615   000645 710000 22                 TRA     s:12028

      337    12010    5                            OR TEMP$ -> ILS.ILL$ -> ILL.LOP ~=
      338    12011    5                               SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP) ;
      339    12012    5                    TEMP_ILS$ = TEMP$ ;

  12012 22 000616   000031 236000 0                  LDQ     TEMP$
        22 000617   000017 756000 0                  STQ     TEMP_ILS$

      340    12013                         %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  12023 22 000620   000031 470400 0                  LDP0    TEMP$
        22 000621   000002 236100                    LDQ     2,,PR0
        22 000622   000031 756000 0                  STQ     TEMP$

  12026 22 000623   000031 470400 0                  LDP0    TEMP$
        22 000624   000003 236100                    LDQ     3,,PR0
        22 000625   000000 116000 23                 CMPQ    0
        22 000626   000620 600000 22                 TZE     s:12023
        22 000627   000003 471500                    LDP1    3,,PR0
        22 000630   100000 220100                    LDX0    0,,PR1
        22 000631   000343 100003                    CMPX0   227,DU
        22 000632   000620 600000 22                 TZE     s:12023
        22 000633   000422 100003                    CMPX0   274,DU
        22 000634   000620 600000 22                 TZE     s:12023
        22 000635   000446 100003                    CMPX0   294,DU
        22 000636   000620 600000 22                 TZE     s:12023
        22 000637   000336 100003                    CMPX0   222,DU
        22 000640   000620 600000 22                 TZE     s:12023
        22 000641   000420 100003                    CMPX0   272,DU
        22 000642   000620 600000 22                 TZE     s:12023
        22 000643   000373 100003                    CMPX0   251,DU
        22 000644   000620 600000 22                 TZE     s:12023
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:84   

      341    12028    5                  END ;

  12028 22 000645   000000 116000 23                 CMPQ    0
        22 000646   000616 600000 22                 TZE     s:12012
        22 000647   000015 473400 0                  LDP3    SRCH_LBL$
        22 000650   300003 474500                    LDP4    3,,PR3
        22 000651   100001 236100                    LDQ     1,,PR1
        22 000652   400001 116100                    CMPQ    1,,PR4
        22 000653   000616 601000 22                 TNZ     s:12012

      342    12029    4                END ;

  12029 22 000654   000657 710000 22                 TRA     s:12038

      343    12030    3              ELSE TEMP_ILS$ = SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ ;

  12030 22 000655   300010 236100                    LDQ     8,,PR3
        22 000656   000017 756000 0                  STQ     TEMP_ILS$

      344    12031
      345    12032        /*V*
      346    12033            CLOSING_LABEL_FOUND -- A label was found closing the perform code group. If
      347    12034                                   an end label has not been created then one is created
      348    12035                                   else the one_ref bit of the end label is set off.
      349    12036        */
      350    12037
      351    12038    3              CALL CREATE_END_LABEL(TEMP_ILS$) ;

  12038 22 000657   000010 236000 23                 LDQ     8
        22 000660   000051 756000 0                  STQ     @PREV_ENTRY$
        22 000661   000204 701000 22                 TSX1    CREATE_END_LABEL
        22 000662   000000 011000                    NOP     0

      352    12039    3              SRCH_LBL$ -> ILS.ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ = END_ILS$ -> ILS.
             12039                       NEXT ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:85   
  12039 22 000663   000015 470400 0                  LDP0    SRCH_LBL$
        22 000664   000003 471500                    LDP1    3,,PR0
        22 000665   100001 473500                    LDP3    1,,PR1
        22 000666   000014 474400 0                  LDP4    END_ILS$
        22 000667   400002 236100                    LDQ     2,,PR4
        22 000670   300010 756100                    STQ     8,,PR3

      353    12040    3            END ;

      354    12041
      355    12042    2          IF LBL_SYM$ -> LABEL.ID = %SECTION THEN

  12042 22 000671   000053 470400 0                  LDP0    @LBL_SYM$
        22 000672   000000 471500                    LDP1    0,,PR0
        22 000673   100000 220100                    LDX0    0,,PR1
        22 000674   000770 100003                    CMPX0   504,DU
        22 000675   000702 601000 22                 TNZ     s:12045

      356    12043    2            END_LBL_SYM$ -> LABEL.SECTION$ = LBL_SYM$;

  12043 22 000676   000000 236100                    LDQ     0,,PR0
        22 000677   000012 473400 0                  LDP3    END_LBL_SYM$
        22 000700   300007 756100                    STQ     7,,PR3
        22 000701   000705 710000 22                 TRA     s:12047

      357    12044    2          ELSE
      358    12045    2            END_LBL_SYM$ -> LABEL.SECTION$ = LBL_SYM$ -> LABEL.SECTION$;

  12045 22 000702   100007 236100                    LDQ     7,,PR1
        22 000703   000012 473400 0                  LDP3    END_LBL_SYM$
        22 000704   300007 756100                    STQ     7,,PR3

      359    12046
      360    12047    2          LBL_SYM$ -> LABEL.P_END$ = END_LBL_SYM$ ;

  12047 22 000705   000000 471500                    LDP1    0,,PR0
        22 000706   000012 236000 0                  LDQ     END_LBL_SYM$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:86   
        22 000707   100001 756100                    STQ     1,,PR1

      361    12048    2          ILL$ -> ILL.ROP = END_LBL_SYM$ ;

  12048 22 000710   000012 236000 0                  LDQ     END_LBL_SYM$
        22 000711   000000 471400 15                 LDP1    ILL$
        22 000712   100002 756100                    STQ     2,,PR1

      362    12049
      363    12050    2   END FIND_LABEL_END ;

  12050 22 000713   000052 221200 0                  LDX1  ! @PREV_ENTRY$+1
        22 000714   000001 702211                    TSX2  ! 1,X1

      364    12051        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:87   
      365    12052    1   REFERENCE_RESOLUTION: PROC (REF_PTR$, GOTO_DEST) ;

  12052 22 000715   000054 741200 0     REFERENCE_R* STX1  ! @LBL_SYM$+1

      366    12053
      367    12054    2   DCL  REF_PTR$ PTR ;
      368    12055    2   DCL  REF_PTR$$ PTR ;
      369    12056    2   DCL  REF$ITEM$ PTR BASED (REF_PTR$$) ;
      370    12057    2   DCL  GOTO_DEST BIT (1) ALIGNED ;
      371    12058    2   DCL  BAD_REFERENCE BOOLEAN ; /* TRUE if the reference cannot be resolved */
      372    12059    2   DCL  ITEM_NOT_ETT BOOLEAN ; /* Should be self-explanatory */
      373    12060
      374    12061        /*I*
      375    12062               NAME:  REFERENCE_RESOLUTION
      376    12063               CALL:  CALL REFERENCE_RESOLUTION(ADDR(REF$ITEM$)) ;
      377    12064          INTERFACE:  Z8AE$ERROR is called to produce error messages.
      378    12065
      379    12066              INPUT:  REF_PTR$ -> REF$ITEM$ - ptr to reference to be checked.  It may
      380    12067                      be a ST entry, ETT item, or a DNT entry.
      381    12068                      GOTO_DEST - TRUE if the reference is the destination of a GOTO,
      382    12069                      or if a GOTO is ALTERed to go to it.
      383    12070             OUTPUT:  REF$ITEM$ - ptr to the correct reference if one exists or to
      384    12071                      nil if no correct reference is there.
      385    12072
      386    12073        DESCRIPTION:  This procedure finds the correct reference if one exists and flags
      387    12074                      an error message otherwise.
      388    12075
      389    12076                      If the reference is qualified then the item is checked only to
      390    12077                      make sure there aren't duplicate labels within the same section
      391    12078                      and that the paragraph is defined.
      392    12079
      393    12080                      If the reference is unqualified then a check is made to see if a
      394    12081                      label exists by the given name.  If one does then a search is made
      395    12082                      to find the paragraph located in the current section if one exists.
      396    12083
      397    12084                      If GOTO_DEST then the GOTO_LABEL bit is set in the ST entry.
      398    12085        */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:88   
      399    12086        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:89   
      400    12087        %MACRO NO_LABEL_ERRORS ;
      401    12088               DO ;
      402    12089                 %FIND_LINE_NO ;
      403    12090
      404    12091                 IF ERR_LINE ~= COMCOM.CURRENT.LINE OR ERR_COL ~=
      405    12092                   COMCOM.CURRENT.COLUMN OR ERR_DNT$ ~= REF$ITEM$ THEN DO ;
      406    12093
      407    12094                     ERR_LINE = COMCOM.CURRENT.LINE ;
      408    12095                     ERR_COL = COMCOM.CURRENT.COLUMN ;
      409    12096                     ERR_DNT$ = REF$ITEM$ ;
      410    12097
      411    12098                     IF REF$ITEM$ -> DNT.ST$ -> LABEL.ID = %PARA THEN DO ;
      412    12099                       IF NOT REF$ITEM$ -> DNT.ST$ -> LABEL.B.COMPILER_CREATED THEN
      413    12100
      414    12101        /*E*
      415    12102              ERROR:  NO_LABEL
      416    12103            MESSAGE:  The label !0 is not defined.
      417    12104        DESCRIPTION:  If a reference is made to a nonexistent label name then
      418    12105                      this error is flagged.  The operand of the ILL is
      419    12106                      assigned a pointer to the created ST item.
      420    12107        */
      421    12108
      422    12109                         CALL Z8AE$ERROR (%E$NO_LABEL,,, REF$ITEM$) ;
      423    12110                     END ;
      424    12111                     ELSE
      425    12112
      426    12113        /*E*
      427    12114              ERROR:  NO_LABEL_DATA
      428    12115           MESSAGE: The label !0 is not defined though a data item is present by this name.
      429    12116        DESCRIPTION:  If a reference is made to a nonexistent label name but
      430    12117                a data item is present then this error is flagged.
      431    12118                The operand of the ILL is assigned a pointer to the
      432    12119                created ST item.  Set BAD_REFERENCE to TRUE so that the ILL
      433    12120                item is deleted in Z8FF$FLOW_ANALYSIS.
      434    12121        */
      435    12122
      436    12123                       IF NOT REF$ITEM$ -> DNT.B.ERROR_VARIABLE THEN
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:90   
      437    12124                         CALL Z8AE$ERROR (%E$NO_LABEL_DATA,,, REF$ITEM$) ;
      438    12125                     END ;
      439    12126
      440    12127                 BAD_REFERENCE = TRUE ;
      441    12128               END ;
      442    12129        %MEND ;
      443    12130        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:91   
      444    12131        /*E*
      445    12132              ERROR:  DUP_LABEL
      446    12133            MESSAGE:  The reference to the duplicate label !0 is unqualified.
      447    12134        DESCRIPTION:  This error is produced when there are two section labels of the
      448    12135                      same name or two paragraph labels of the same name within one
      449    12136                      section that is referenced.
      450    12137        */
      451    12138
      452    12139        %MACRO DUP_LABEL_ERROR ;
      453    12140               DO ;
      454    12141
      455    12142                 IF ERR_LINE ~= COMCOM.CURRENT.LINE OR ERR_COL ~=
      456    12143                   COMCOM.CURRENT.COLUMN OR ERR_DNT$ ~= REF$ITEM$ THEN DO ;
      457    12144
      458    12145                     ERR_LINE = COMCOM.CURRENT.LINE ;
      459    12146                     ERR_COL = COMCOM.CURRENT.COLUMN ;
      460    12147                     ERR_DNT$ = REF$ITEM$ ;
      461    12148                     IF ILS$ = ADDR (NIL)
      462    12149                   /* Flag this error in USE procedures at the USE procedure entry. */
      463    12150                       THEN COMCOM.CURRENT.LINE = LABEL_REFERENCE$ -> LABEL.LINE_NO ;
      464    12151                   /* In other cases flag it where the label is referenced. */
      465    12152                       ELSE
      466    12153                         %FIND_LINE_NO ;
      467    12154
      468    12155                     CALL Z8AE$ERROR (%E$DUP_LABEL,,, LABEL_REFERENCE$ -> LABEL.DNT$) ;
      469    12156                     END ;
      470    12157                 BAD_REFERENCE = TRUE ;
      471    12158               END ;
      472    12159        %MEND ;
      473    12160        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:92   
      474    12161        /*V*
      475    12162            EVALUATE_ETT -- Go thru zero or more ETT items, taking the LOP.
      476    12163        */
      477    12164    2          REF_PTR$$ = REF_PTR$ ;

  12164 22 000716   000055 470400 0                  LDP0    @REF_PTR$
        22 000717   000000 236100                    LDQ     0,,PR0
        22 000720   000057 756000 0                  STQ     REF_PTR$$

      478    12165
      479    12166    2          IF REF$ITEM$ = ADDR (NIL) THEN /* Nothing to resolve */ RETURN ;

  12166 22 000721   000057 471400 0                  LDP1    REF_PTR$$
        22 000722   100000 236100                    LDQ     0,,PR1
        22 000723   000000 116000 23                 CMPQ    0
        22 000724   000726 601000 22                 TNZ     s:12168

  12166 22 000725   000001 702211                    TSX2  ! 1,X1

      480    12167
      481    12168    2          ITEM_NOT_ETT = FALSE ;

  12168 22 000726   000061 450000 0                  STZ     ITEM_NOT_ETT

      482    12169
      483    12170    3          DO UNTIL (ITEM_NOT_ETT) ;

      484    12171    4            DO CASE (REF$ITEM$ -> ETT.ID) ;

  12171 22 000727   000057 470400 0                  LDP0    REF_PTR$$
        22 000730   000000 471500                    LDP1    0,,PR0
        22 000731   100000 220100                    LDX0    0,,PR1
        22 000732   000006 100003                    CMPX0   6,DU
        22 000733   000735 602010 22                 TNC     s:12171+6,X0
        22 000734   000746 710000 22                 TRA     s:12175
        22 000735   000746 710000 22                 TRA     s:12175
        22 000736   000743 710000 22                 TRA     s:12173
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:93   
        22 000737   000746 710000 22                 TRA     s:12175
        22 000740   000743 710000 22                 TRA     s:12173
        22 000741   000746 710000 22                 TRA     s:12175
        22 000742   000743 710000 22                 TRA     s:12173

      485    12172    4              CASE (%SSOP, %OFF, %BASE) ;

      486    12173    4                REF_PTR$$ = ADDR (REF$ITEM$ -> ETT.LOP) ;

  12173 22 000743   100001 633500                    EPPR3   1,,PR1
        22 000744   000057 453400 0                  STP3    REF_PTR$$
        22 000745   000750 710000 22                 TRA     s:12177

      487    12174    4              CASE (ELSE) ;

      488    12175    4                ITEM_NOT_ETT = TRUE ;

  12175 22 000746   400000 236003                    LDQ     -131072,DU
        22 000747   000061 756000 0                  STQ     ITEM_NOT_ETT

      489    12176    4            END ;

      490    12177    3          END ;

  12177 22 000750   000061 234000 0                  SZN     ITEM_NOT_ETT
        22 000751   000727 605000 22                 TPL     s:12171

      491    12178
      492    12179    2          BAD_REFERENCE = FALSE ; /* Be optimistic */

  12179 22 000752   000060 450000 0                  STZ     BAD_REFERENCE

      493    12180
      494    12181    2          IF REF$ITEM$ -> LABEL.ID = %PARA OR REF$ITEM$ -> LABEL.ID = %SECTION THEN

  12181 22 000753   000057 470400 0                  LDP0    REF_PTR$$
        22 000754   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:94   
        22 000755   100000 220100                    LDX0    0,,PR1
        22 000756   000771 100003                    CMPX0   505,DU
        22 000757   000762 600000 22                 TZE     s:12195
        22 000760   000770 100003                    CMPX0   504,DU
        22 000761   001177 601000 22                 TNZ     s:12300

      495    12182
      496    12183        /*V*
      497    12184            QUALIFIED_REF -- Qualified reference, make sure label is not a duplicate.
      498    12185                             Check to make sure that a defined label is found.
      499    12186
      500    12187                             Phase 1 creates symbol table entries for both the paragraph
      501    12188                             and section name and assigns the reference pointer to the
      502    12189                             symbol table entry of the paragraph.  Phase 1 also checks
      503    12190                             to see if the paragraph name is the same as a data name as
      504    12191                             that is illegal.
      505    12192        */
      506    12193
      507    12194    3            DO ;

      508    12195    3              LABEL_REFERENCE$ = REF$ITEM$ ;

  12195 22 000762   000000 236100                    LDQ     0,,PR0
        22 000763   000033 756000 0                  STQ     LABEL_REFERENCE$

      509    12196
      510    12197    3              IF NOT LABEL_REFERENCE$ -> LABEL.B.DEFINED THEN

  12197 22 000764   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 000765   100003 236100                    LDQ     3,,PR1
        22 000766   200000 316003                    CANQ    65536,DU
        22 000767   001077 601000 22                 TNZ     s:12257

      511    12198    4                DO ;

      512    12199
      513    12200        /*E*
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:95   
      514    12201              ERROR:  NO_LABEL_IN_SECTION
      515    12202            MESSAGE:  There is no label !0 defined in section !1.
      516    12203        DESCRIPTION:  This error is produced when a qualified reference to a
      517    12204                      label references a non defined label.  The line number
      518    12205                      is found and the left operand of the ILL is set to NIL.
      519    12206        */
      520    12207
      521    12208                       %FIND_LINE_NO ;

  12210 22 000770   000000 236000 17                 LDQ     ILS$
        22 000771   000004 756000 12                 STQ     O2COM+4

  12211 22 000772   000004 473400 12                 LDP3    O2COM+4
        22 000773   300003 474500                    LDP4    3,,PR3
        22 000774   400000 220100                    LDX0    0,,PR4
        22 000775   000373 100003                    CMPX0   251,DU
        22 000776   001012 600000 22                 TZE     s:12220

  12215 22 000777   000004 470400 12                 LDP0    O2COM+4
        22 001000   000002 236100                    LDQ     2,,PR0
        22 001001   000004 756000 12                 STQ     O2COM+4

  12218 22 001002   000004 470400 12                 LDP0    O2COM+4
        22 001003   000003 236100                    LDQ     3,,PR0
        22 001004   000000 116000 23                 CMPQ    0
        22 001005   000777 600000 22                 TZE     s:12215

  12219 22 001006   000003 471500                    LDP1    3,,PR0
        22 001007   100000 220100                    LDX0    0,,PR1
        22 001010   000373 100003                    CMPX0   251,DU
        22 001011   000777 601000 22                 TNZ     s:12215

  12220 22 001012   000004 470400 12                 LDP0    O2COM+4
        22 001013   000003 471500                    LDP1    3,,PR0
        22 001014   100000 236100                    LDQ     0,,PR1
        22 001015   777777 376007                    ANQ     -1,DL
        22 001016   000133 756000 xsym               STQ     COMCOM+91
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:96   

  12221 22 001017   000003 471500                    LDP1    3,,PR0
        22 001020   100002 236100                    LDQ     2,,PR1
        22 001021   777777 376007                    ANQ     -1,DL
        22 001022   000134 756000 xsym               STQ     COMCOM+92

      522    12224
      523    12225    4                IF ERR_LINE ~= COMCOM.CURRENT.LINE OR ERR_COL ~=

  12225 22 001023   000035 236000 0                  LDQ     ERR_LINE
        22 001024   000133 116000 xsym               CMPQ    COMCOM+91
        22 001025   001036 601000 22                 TNZ     s:12229
        22 001026   000036 236000 0                  LDQ     ERR_COL
        22 001027   000134 116000 xsym               CMPQ    COMCOM+92
        22 001030   001036 601000 22                 TNZ     s:12229
        22 001031   000057 471400 0                  LDP1    REF_PTR$$
        22 001032   100000 473500                    LDP3    0,,PR1
        22 001033   000037 236000 0                  LDQ     ERR_DNT$
        22 001034   300006 116100                    CMPQ    6,,PR3
        22 001035   001074 600000 22                 TZE     s:12253

      524    12226    4                  COMCOM.CURRENT.COLUMN OR ERR_DNT$ ~= REF$ITEM$ -> LABEL.DNT$
      525    12227    5                    THEN DO ;

      526    12228
      527    12229    5                      ERR_LINE = COMCOM.CURRENT.LINE ;

  12229 22 001036   000133 235000 xsym               LDA     COMCOM+91
        22 001037   000035 755000 0                  STA     ERR_LINE

      528    12230    5                      ERR_COL = COMCOM.CURRENT.COLUMN ;

  12230 22 001040   000134 236000 xsym               LDQ     COMCOM+92
        22 001041   000036 756000 0                  STQ     ERR_COL

      529    12231    5                      ERR_DNT$ = REF$ITEM$ -> LABEL.DNT$ ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:97   
  12231 22 001042   000057 471400 0                  LDP1    REF_PTR$$
        22 001043   100000 473500                    LDP3    0,,PR1
        22 001044   300006 236100                    LDQ     6,,PR3
        22 001045   000037 756000 0                  STQ     ERR_DNT$

      530    12232    5                      IF REF$ITEM$ -> LABEL.SECTION$ = ADDR (NIL) THEN

  12232 22 001046   300007 236100                    LDQ     7,,PR3
        22 001047   000000 116000 23                 CMPQ    0
        22 001050   001074 600000 22                 TZE     s:12253

      531    12233                             %IF GCOS ;
      539    12241                             %ENDIF ;
      540    12242    5                            ;
      541    12243                           /* If reference like X OF Y OF Z, SECTION$ =
      542    12244                              ADDR (NIL) and Phase 1 has already reported
      543    12245                              this error. */
      544    12246    5                      ELSE IF REF$ITEM$ -> LABEL.SECTION$ -> LABEL.ID = %SECTION AND

  12246 22 001051   300007 474500                    LDP4    7,,PR3
        22 001052   400000 220100                    LDX0    0,,PR4
        22 001053   000770 100003                    CMPX0   504,DU
        22 001054   001074 601000 22                 TNZ     s:12253
        22 001055   400003 236100                    LDQ     3,,PR4
        22 001056   100000 316003                    CANQ    32768,DU
        22 001057   001074 601000 22                 TNZ     s:12253

      545    12247    5                         NOT REF$ITEM$ -> LABEL.SECTION$ ->
      546    12248    5                          SECTION.B.COMPILER_CREATED THEN
      547    12249    5                        CALL Z8AE$ERROR (%E$NO_LABEL_IN_SECTION,,,

  12249 22 001060   400006 635500                    EPPR5   6,,PR4
        22 001061   000100 455400 0                  STP5    @INTDEF$$+5
        22 001062   300006 634500                    EPPR4   6,,PR3
        22 001063   000077 454400 0                  STP4    @INTDEF$$+4
        22 001064   000000 236000 23                 LDQ     0
        22 001065   000076 756000 0                  STQ     @INTDEF$$+3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:98   
        22 001066   000013 235000 23                 LDA     11
        22 001067   000074 757000 0                  STAQ    @INTDEF$$+1
        22 001070   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 001071   000011 631400 23                 EPPR1   9
        22 001072   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001073   000000 011000                    NOP     0

      548    12250    5                                        REF$ITEM$ -> LABEL.DNT$,
      549    12251    5                                        REF$ITEM$ -> LABEL.SECTION$ -> LABEL.DNT$) ;
      550    12252    5                    END ;

      551    12253    4                  BAD_REFERENCE = TRUE ;

  12253 22 001074   400000 236003                    LDQ     -131072,DU
        22 001075   000060 756000 0                  STQ     BAD_REFERENCE

      552    12254    4                END ;

  12254 22 001076   002121 710000 22                 TRA     s:12627

      553    12255    3              ELSE
      554    12256    4                DO ;

      555    12257    4                  IF LABEL_REFERENCE$ -> LABEL.B.DUPLICATE THEN

  12257 22 001077   020000 316003                    CANQ    8192,DU
        22 001100   002121 600000 22                 TZE     s:12627

      556    12258                         %DUP_LABEL_ERROR ;

  12260 22 001101   000035 236000 0                  LDQ     ERR_LINE
        22 001102   000133 116000 xsym               CMPQ    COMCOM+91
        22 001103   001112 601000 22                 TNZ     s:12262
        22 001104   000036 236000 0                  LDQ     ERR_COL
        22 001105   000134 116000 xsym               CMPQ    COMCOM+92
        22 001106   001112 601000 22                 TNZ     s:12262
        22 001107   000037 236000 0                  LDQ     ERR_DNT$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:99   
        22 001110   000000 116100                    CMPQ    0,,PR0
        22 001111   001174 600000 22                 TZE     s:12288

  12262 22 001112   000133 235000 xsym               LDA     COMCOM+91
        22 001113   000035 755000 0                  STA     ERR_LINE

  12263 22 001114   000134 236000 xsym               LDQ     COMCOM+92
        22 001115   000036 756000 0                  STQ     ERR_COL

  12264 22 001116   000000 236100                    LDQ     0,,PR0
        22 001117   000037 756000 0                  STQ     ERR_DNT$

  12265 22 001120   000000 236000 17                 LDQ     ILS$
        22 001121   000000 116000 23                 CMPQ    0
        22 001122   001127 601000 22                 TNZ     s:12272

  12267 22 001123   100002 236100                    LDQ     2,,PR1
        22 001124   777777 376007                    ANQ     -1,DL
        22 001125   000133 756000 xsym               STQ     COMCOM+91
        22 001126   001161 710000 22                 TRA     s:12286

  12272 22 001127   000004 756000 12                 STQ     O2COM+4

  12273 22 001130   000004 473400 12                 LDP3    O2COM+4
        22 001131   300003 474500                    LDP4    3,,PR3
        22 001132   400000 220100                    LDX0    0,,PR4
        22 001133   000373 100003                    CMPX0   251,DU
        22 001134   001150 600000 22                 TZE     s:12282

  12277 22 001135   000004 470400 12                 LDP0    O2COM+4
        22 001136   000002 236100                    LDQ     2,,PR0
        22 001137   000004 756000 12                 STQ     O2COM+4

  12280 22 001140   000004 470400 12                 LDP0    O2COM+4
        22 001141   000003 236100                    LDQ     3,,PR0
        22 001142   000000 116000 23                 CMPQ    0
        22 001143   001135 600000 22                 TZE     s:12277
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:100  

  12281 22 001144   000003 471500                    LDP1    3,,PR0
        22 001145   100000 220100                    LDX0    0,,PR1
        22 001146   000373 100003                    CMPX0   251,DU
        22 001147   001135 601000 22                 TNZ     s:12277

  12282 22 001150   000004 470400 12                 LDP0    O2COM+4
        22 001151   000003 471500                    LDP1    3,,PR0
        22 001152   100000 236100                    LDQ     0,,PR1
        22 001153   777777 376007                    ANQ     -1,DL
        22 001154   000133 756000 xsym               STQ     COMCOM+91

  12283 22 001155   000003 471500                    LDP1    3,,PR0
        22 001156   100002 236100                    LDQ     2,,PR1
        22 001157   777777 376007                    ANQ     -1,DL
        22 001160   000134 756000 xsym               STQ     COMCOM+92

  12286 22 001161   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001162   000006 036003                    ADLQ    6,DU
        22 001163   000000 235000 23                 LDA     0
        22 001164   000076 757000 0                  STAQ    @INTDEF$$+3
        22 001165   000000 236000 23                 LDQ     0
        22 001166   000016 235000 23                 LDA     14
        22 001167   000074 757000 0                  STAQ    @INTDEF$$+1
        22 001170   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 001171   000014 631400 23                 EPPR1   12
        22 001172   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001173   000000 011000                    NOP     0

  12288 22 001174   400000 236003                    LDQ     -131072,DU
        22 001175   000060 756000 0                  STQ     BAD_REFERENCE

      557    12291    4                END ;

      558    12292    3            END ;

  12292 22 001176   002121 710000 22                 TRA     s:12627
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:101  

      559    12293    2          ELSE
      560    12294        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:102  
      561    12295        /*V*
      562    12296            UNQUALIFIED_REF -- Assign ILL.LOP the pointer to the label.
      563    12297        */
      564    12298
      565    12299    3            DO ;

      566    12300    3              LABEL_REFERENCE$ = REF$ITEM$ -> DNT.ST$ ;

  12300 22 001177   100001 236100                    LDQ     1,,PR1
        22 001200   000033 756000 0                  STQ     LABEL_REFERENCE$

      567    12301
      568    12302        /*V*
      569    12303            GET_LABEL -- Search the ST items with the correct name to make sure that
      570    12304                         there is a PARA or SECTION item for the label.  Phase 1 flags
      571    12305                         all conflicts with data names but a search is needed to see if
      572    12306                         any label by the given name exists.  An error is flagged if no
      573    12307                         label exists.
      574    12308        */
      575    12309
      576    12310    3   RESOLUTION_1:
      577    12311    4              DO WHILE LABEL_REFERENCE$ ~= ADDR(NIL) ;

  12311 22 001201   001264 710000 22    RESOLUTION_1 TRA     s:12340

      578    12312    5                IF LABEL_REFERENCE$ -> LABEL.ID = %POINTER THEN DO ;

  12312 22 001202   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 001203   000000 220100                    LDX0    0,,PR0
        22 001204   000777 100003                    CMPX0   511,DU
        22 001205   001250 601000 22                 TNZ     s:12333

      579    12313                       %FIND_LINE_NO ;

  12315 22 001206   000000 236000 17                 LDQ     ILS$
        22 001207   000004 756000 12                 STQ     O2COM+4

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:103  
  12316 22 001210   000004 471400 12                 LDP1    O2COM+4
        22 001211   100003 473500                    LDP3    3,,PR1
        22 001212   300000 220100                    LDX0    0,,PR3
        22 001213   000373 100003                    CMPX0   251,DU
        22 001214   001230 600000 22                 TZE     s:12325

  12320 22 001215   000004 470400 12                 LDP0    O2COM+4
        22 001216   000002 236100                    LDQ     2,,PR0
        22 001217   000004 756000 12                 STQ     O2COM+4

  12323 22 001220   000004 470400 12                 LDP0    O2COM+4
        22 001221   000003 236100                    LDQ     3,,PR0
        22 001222   000000 116000 23                 CMPQ    0
        22 001223   001215 600000 22                 TZE     s:12320

  12324 22 001224   000003 471500                    LDP1    3,,PR0
        22 001225   100000 220100                    LDX0    0,,PR1
        22 001226   000373 100003                    CMPX0   251,DU
        22 001227   001215 601000 22                 TNZ     s:12320

  12325 22 001230   000004 470400 12                 LDP0    O2COM+4
        22 001231   000003 471500                    LDP1    3,,PR0
        22 001232   100000 236100                    LDQ     0,,PR1
        22 001233   777777 376007                    ANQ     -1,DL
        22 001234   000133 756000 xsym               STQ     COMCOM+91

  12326 22 001235   000003 471500                    LDP1    3,,PR0
        22 001236   100002 236100                    LDQ     2,,PR1
        22 001237   777777 376007                    ANQ     -1,DL
        22 001240   000134 756000 xsym               STQ     COMCOM+92

      580    12329    5                  CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;

  12329 22 001241   000020 630400 23                 EPPR0   16
        22 001242   000001 631400 23                 EPPR1   1
        22 001243   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001244   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:104  

      581    12330    5                  BAD_REFERENCE = TRUE ;

  12330 22 001245   400000 236003                    LDQ     -131072,DU
        22 001246   000060 756000 0                  STQ     BAD_REFERENCE

      582    12331    5                  EXIT RESOLUTION_1 ;

  12331 22 001247   001266 710000 22                 TRA     s:12342

      583    12332    5                END ;
      584    12333    4                IF LABEL_REFERENCE$ -> LABEL.B.DEFINED AND

  12333 22 001250   000003 236100                    LDQ     3,,PR0
        22 001251   200000 316003                    CANQ    65536,DU
        22 001252   001262 600000 22                 TZE     s:12339
        22 001253   000771 100003                    CMPX0   505,DU
        22 001254   001257 600000 22                 TZE     s:12333+7
        22 001255   000770 100003                    CMPX0   504,DU
        22 001256   001262 601000 22                 TNZ     s:12339
        22 001257   000011 236100                    LDQ     9,,PR0
        22 001260   000025 116000 0                  CMPQ    CURRENT_PROC$
        22 001261   001266 600000 22                 TZE     s:12342

      585    12334    4                   (LABEL_REFERENCE$ -> LABEL.ID = %PARA OR
      586    12335    4                   LABEL_REFERENCE$ -> LABEL.ID = %SECTION) AND
      587    12336    4                   LABEL_REFERENCE$ -> LABEL.PROC$ = CURRENT_PROC$ THEN
      588    12337    4                  EXIT RESOLUTION_1 ;
      589    12338    4                ELSE
      590    12339    4                  LABEL_REFERENCE$ = LABEL_REFERENCE$ -> LABEL.NEXT ;

  12339 22 001262   000004 236100                    LDQ     4,,PR0
        22 001263   000033 756000 0                  STQ     LABEL_REFERENCE$

      591    12340    4              END ; /* RESOLUTION_1 */

  12340 22 001264   000000 116000 23                 CMPQ    0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:105  
        22 001265   001202 601000 22                 TNZ     s:12312

      592    12341
      593    12342    3              IF LABEL_REFERENCE$ = ADDR(NIL) THEN

  12342 22 001266   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001267   000000 116000 23                 CMPQ    0
        22 001270   001406 601000 22                 TNZ     s:12403

      594    12343                     %NO_LABEL_ERRORS ;

  12347 22 001271   000000 236000 17                 LDQ     ILS$
        22 001272   000004 756000 12                 STQ     O2COM+4

  12348 22 001273   000004 470400 12                 LDP0    O2COM+4
        22 001274   000003 471500                    LDP1    3,,PR0
        22 001275   100000 220100                    LDX0    0,,PR1
        22 001276   000373 100003                    CMPX0   251,DU
        22 001277   001313 600000 22                 TZE     s:12357

  12352 22 001300   000004 470400 12                 LDP0    O2COM+4
        22 001301   000002 236100                    LDQ     2,,PR0
        22 001302   000004 756000 12                 STQ     O2COM+4

  12355 22 001303   000004 470400 12                 LDP0    O2COM+4
        22 001304   000003 236100                    LDQ     3,,PR0
        22 001305   000000 116000 23                 CMPQ    0
        22 001306   001300 600000 22                 TZE     s:12352

  12356 22 001307   000003 471500                    LDP1    3,,PR0
        22 001310   100000 220100                    LDX0    0,,PR1
        22 001311   000373 100003                    CMPX0   251,DU
        22 001312   001300 601000 22                 TNZ     s:12352

  12357 22 001313   100000 236100                    LDQ     0,,PR1
        22 001314   777777 376007                    ANQ     -1,DL
        22 001315   000133 756000 xsym               STQ     COMCOM+91
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:106  

  12358 22 001316   000003 471500                    LDP1    3,,PR0
        22 001317   100002 236100                    LDQ     2,,PR1
        22 001320   777777 376007                    ANQ     -1,DL
        22 001321   000134 756000 xsym               STQ     COMCOM+92

  12361 22 001322   000035 236000 0                  LDQ     ERR_LINE
        22 001323   000133 116000 xsym               CMPQ    COMCOM+91
        22 001324   001334 601000 22                 TNZ     s:12363
        22 001325   000036 236000 0                  LDQ     ERR_COL
        22 001326   000134 116000 xsym               CMPQ    COMCOM+92
        22 001327   001334 601000 22                 TNZ     s:12363
        22 001330   000057 471400 0                  LDP1    REF_PTR$$
        22 001331   000037 236000 0                  LDQ     ERR_DNT$
        22 001332   100000 116100                    CMPQ    0,,PR1
        22 001333   001403 600000 22                 TZE     s:12390

  12363 22 001334   000133 235000 xsym               LDA     COMCOM+91
        22 001335   000035 755000 0                  STA     ERR_LINE

  12364 22 001336   000134 236000 xsym               LDQ     COMCOM+92
        22 001337   000036 756000 0                  STQ     ERR_COL

  12365 22 001340   000057 471400 0                  LDP1    REF_PTR$$
        22 001341   100000 236100                    LDQ     0,,PR1
        22 001342   000037 756000 0                  STQ     ERR_DNT$

  12366 22 001343   100000 473500                    LDP3    0,,PR1
        22 001344   300001 474500                    LDP4    1,,PR3
        22 001345   400000 220100                    LDX0    0,,PR4
        22 001346   000771 100003                    CMPX0   505,DU
        22 001347   001366 601000 22                 TNZ     s:12387

  12367 22 001350   400003 236100                    LDQ     3,,PR4
        22 001351   100000 316003                    CANQ    32768,DU
        22 001352   001403 601000 22                 TNZ     s:12390

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:107  
  12375 22 001353   000057 236000 0                  LDQ     REF_PTR$$
        22 001354   000000 235000 23                 LDA     0
        22 001355   000076 757000 0                  STAQ    @INTDEF$$+3
        22 001356   000000 236000 23                 LDQ     0
        22 001357   000022 235000 23                 LDA     18
        22 001360   000074 757000 0                  STAQ    @INTDEF$$+1
        22 001361   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 001362   000014 631400 23                 EPPR1   12
        22 001363   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001364   000000 011000                    NOP     0

  12376 22 001365   001403 710000 22                 TRA     s:12390

  12387 22 001366   300003 236100                    LDQ     3,,PR3
        22 001367   000100 316003                    CANQ    64,DU
        22 001370   001403 601000 22                 TNZ     s:12390

  12388 22 001371   000057 236000 0                  LDQ     REF_PTR$$
        22 001372   000000 235000 23                 LDA     0
        22 001373   000076 757000 0                  STAQ    @INTDEF$$+3
        22 001374   000000 236000 23                 LDQ     0
        22 001375   000024 235000 23                 LDA     20
        22 001376   000074 757000 0                  STAQ    @INTDEF$$+1
        22 001377   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 001400   000014 631400 23                 EPPR1   12
        22 001401   000000 701000 xent               TSX1    Z8AE$ERROR
        22 001402   000000 011000                    NOP     0

  12390 22 001403   400000 236003                    LDQ     -131072,DU
        22 001404   000060 756000 0                  STQ     BAD_REFERENCE

  12391 22 001405   002121 710000 22                 TRA     s:12627

      595    12393    3              ELSE
      596    12394    4                DO ;

      597    12395        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:108  
      598    12396        /*V*
      599    12397            ONE_LABEL -- If the ST.NEXT field is nil then that means that the label
      600    12398                         exists in only one section.  The label is then checked to make
      601    12399                         sure that there are not duplicates within the same section but
      602    12400                         if not the reference is valid.
      603    12401        */
      604    12402
      605    12403    4                  TEMP$ = LABEL_REFERENCE$ ;

  12403 22 001406   000031 756000 0                  STQ     TEMP$

      606    12404    4                  DUPLICATE_LBL = FALSE ;

  12404 22 001407   000034 450000 0                  STZ     DUPLICATE_LBL

      607    12405    5   IS_LAB_UNIQUE: DO WHILE TEMP$ -> LABEL.NEXT ~= ADDR (NIL) ; /*#30242*/

  12405 22 001410   001427 710000 22    IS_LAB_UNIQ* TRA     s:12413

      608    12406    5                    TEMP$ = TEMP$ -> LABEL.NEXT ;

  12406 22 001411   000031 470400 0                  LDP0    TEMP$
        22 001412   000004 236100                    LDQ     4,,PR0
        22 001413   000031 756000 0                  STQ     TEMP$

      609    12407    5                    IF TEMP$ -> LABEL.ID = %PARA OR TEMP$ -> LABEL.ID = %SECTION

  12407 22 001414   000031 470400 0                  LDP0    TEMP$
        22 001415   000000 220100                    LDX0    0,,PR0
        22 001416   000771 100003                    CMPX0   505,DU
        22 001417   001422 600000 22                 TZE     s:12410
        22 001420   000770 100003                    CMPX0   504,DU
        22 001421   001427 601000 22                 TNZ     s:12413

      610    12408    6                        THEN DO ;

      611    12409                           /* %CONST, e.g., is OK */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:109  
      612    12410    6                      IF TEMP$ -> LABEL.PROC$ ~= CURRENT_PROC$ THEN EXIT IS_LAB_UNIQUE
             12410                               ;

  12410 22 001422   000011 236100                    LDQ     9,,PR0
        22 001423   000025 116000 0                  CMPQ    CURRENT_PROC$
        22 001424   001433 601000 22                 TNZ     s:12414

      613    12411    6                      DUPLICATE_LBL = TRUE ;

  12411 22 001425   400000 236003                    LDQ     -131072,DU
        22 001426   000034 756000 0                  STQ     DUPLICATE_LBL

      614    12412    6                    END ;

      615    12413    5                  END ; /* IS_LAB_UNIQUE */

  12413 22 001427   000031 470400 0                  LDP0    TEMP$
        22 001430   000004 236100                    LDQ     4,,PR0
        22 001431   000000 116000 23                 CMPQ    0
        22 001432   001411 601000 22                 TNZ     s:12406

      616    12414    4                  IF NOT DUPLICATE_LBL THEN

  12414 22 001433   000034 234000 0                  SZN     DUPLICATE_LBL
        22 001434   001541 604000 22                 TMI     s:12462

      617    12415    5                    DO ;

      618    12416
      619    12417    5                      IF LABEL_REFERENCE$ -> LABEL.B.DUPLICATE THEN

  12417 22 001435   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 001436   100003 236100                    LDQ     3,,PR1
        22 001437   020000 316003                    CANQ    8192,DU
        22 001440   002121 600000 22                 TZE     s:12627

      620    12418                             %DUP_LABEL_ERROR ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:110  

  12420 22 001441   000035 236000 0                  LDQ     ERR_LINE
        22 001442   000133 116000 xsym               CMPQ    COMCOM+91
        22 001443   001453 601000 22                 TNZ     s:12422
        22 001444   000036 236000 0                  LDQ     ERR_COL
        22 001445   000134 116000 xsym               CMPQ    COMCOM+92
        22 001446   001453 601000 22                 TNZ     s:12422
        22 001447   000057 473400 0                  LDP3    REF_PTR$$
        22 001450   000037 236000 0                  LDQ     ERR_DNT$
        22 001451   300000 116100                    CMPQ    0,,PR3
        22 001452   001536 600000 22                 TZE     s:12448

  12422 22 001453   000133 235000 xsym               LDA     COMCOM+91
        22 001454   000035 755000 0                  STA     ERR_LINE

  12423 22 001455   000134 236000 xsym               LDQ     COMCOM+92
        22 001456   000036 756000 0                  STQ     ERR_COL

  12424 22 001457   000057 473400 0                  LDP3    REF_PTR$$
        22 001460   300000 236100                    LDQ     0,,PR3
        22 001461   000037 756000 0                  STQ     ERR_DNT$

  12425 22 001462   000000 236000 17                 LDQ     ILS$
        22 001463   000000 116000 23                 CMPQ    0
        22 001464   001471 601000 22                 TNZ     s:12432

  12427 22 001465   100002 236100                    LDQ     2,,PR1
        22 001466   777777 376007                    ANQ     -1,DL
        22 001467   000133 756000 xsym               STQ     COMCOM+91
        22 001470   001523 710000 22                 TRA     s:12446

  12432 22 001471   000004 756000 12                 STQ     O2COM+4

  12433 22 001472   000004 474400 12                 LDP4    O2COM+4
        22 001473   400003 475500                    LDP5    3,,PR4
        22 001474   500000 220100                    LDX0    0,,PR5
        22 001475   000373 100003                    CMPX0   251,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:111  
        22 001476   001512 600000 22                 TZE     s:12442

  12437 22 001477   000004 470400 12                 LDP0    O2COM+4
        22 001500   000002 236100                    LDQ     2,,PR0
        22 001501   000004 756000 12                 STQ     O2COM+4

  12440 22 001502   000004 470400 12                 LDP0    O2COM+4
        22 001503   000003 236100                    LDQ     3,,PR0
        22 001504   000000 116000 23                 CMPQ    0
        22 001505   001477 600000 22                 TZE     s:12437

  12441 22 001506   000003 471500                    LDP1    3,,PR0
        22 001507   100000 220100                    LDX0    0,,PR1
        22 001510   000373 100003                    CMPX0   251,DU
        22 001511   001477 601000 22                 TNZ     s:12437

  12442 22 001512   000004 470400 12                 LDP0    O2COM+4
        22 001513   000003 471500                    LDP1    3,,PR0
        22 001514   100000 236100                    LDQ     0,,PR1
        22 001515   777777 376007                    ANQ     -1,DL
        22 001516   000133 756000 xsym               STQ     COMCOM+91

  12443 22 001517   000003 471500                    LDP1    3,,PR0
        22 001520   100002 236100                    LDQ     2,,PR1
        22 001521   777777 376007                    ANQ     -1,DL
        22 001522   000134 756000 xsym               STQ     COMCOM+92

  12446 22 001523   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001524   000006 036003                    ADLQ    6,DU
        22 001525   000000 235000 23                 LDA     0
        22 001526   000076 757000 0                  STAQ    @INTDEF$$+3
        22 001527   000000 236000 23                 LDQ     0
        22 001530   000016 235000 23                 LDA     14
        22 001531   000074 757000 0                  STAQ    @INTDEF$$+1
        22 001532   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 001533   000014 631400 23                 EPPR1   12
        22 001534   000000 701000 xent               TSX1    Z8AE$ERROR
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:112  
        22 001535   000000 011000                    NOP     0

  12448 22 001536   400000 236003                    LDQ     -131072,DU
        22 001537   000060 756000 0                  STQ     BAD_REFERENCE

      621    12451    5                    END ;

  12451 22 001540   002121 710000 22                 TRA     s:12627

      622    12452    4                  ELSE
      623    12453
      624    12454        /*V*
      625    12455            MULTIPLE_LABELS -- There are multiple label entries by this name in the
      626    12456                               program. If it is a section label then it's an error but
      627    12457                               if it's a paragraph name or switch and a section exists,
      628    12458                               then search for the correct one.
      629    12459        */
      630    12460
      631    12461    5                    DO ;

      632    12462    5                      IF (O2COM.SECTION$ = ADDR(NIL) AND

  12462 22 001541   000003 236000 12                 LDQ     O2COM+3
        22 001542   000000 116000 23                 CMPQ    0
        22 001543   001550 601000 22                 TNZ     s:12462+7
        22 001544   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 001545   100000 220100                    LDX0    0,,PR1
        22 001546   000771 100003                    CMPX0   505,DU
        22 001547   001554 600000 22                 TZE     s:12467
        22 001550   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 001551   100000 220100                    LDX0    0,,PR1
        22 001552   000770 100003                    CMPX0   504,DU
        22 001553   001654 601000 22                 TNZ     s:12510

      633    12463    5                          LABEL_REFERENCE$ -> LABEL.ID = %PARA) OR
      634    12464    5                          LABEL_REFERENCE$ -> LABEL.ID = %SECTION THEN
      635    12465                             %DUP_LABEL_ERROR ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:113  

  12467 22 001554   000035 236000 0                  LDQ     ERR_LINE
        22 001555   000133 116000 xsym               CMPQ    COMCOM+91
        22 001556   001566 601000 22                 TNZ     s:12469
        22 001557   000036 236000 0                  LDQ     ERR_COL
        22 001560   000134 116000 xsym               CMPQ    COMCOM+92
        22 001561   001566 601000 22                 TNZ     s:12469
        22 001562   000057 473400 0                  LDP3    REF_PTR$$
        22 001563   000037 236000 0                  LDQ     ERR_DNT$
        22 001564   300000 116100                    CMPQ    0,,PR3
        22 001565   001651 600000 22                 TZE     s:12495

  12469 22 001566   000133 235000 xsym               LDA     COMCOM+91
        22 001567   000035 755000 0                  STA     ERR_LINE

  12470 22 001570   000134 236000 xsym               LDQ     COMCOM+92
        22 001571   000036 756000 0                  STQ     ERR_COL

  12471 22 001572   000057 473400 0                  LDP3    REF_PTR$$
        22 001573   300000 236100                    LDQ     0,,PR3
        22 001574   000037 756000 0                  STQ     ERR_DNT$

  12472 22 001575   000000 236000 17                 LDQ     ILS$
        22 001576   000000 116000 23                 CMPQ    0
        22 001577   001604 601000 22                 TNZ     s:12479

  12474 22 001600   100002 236100                    LDQ     2,,PR1
        22 001601   777777 376007                    ANQ     -1,DL
        22 001602   000133 756000 xsym               STQ     COMCOM+91
        22 001603   001636 710000 22                 TRA     s:12493

  12479 22 001604   000004 756000 12                 STQ     O2COM+4

  12480 22 001605   000004 474400 12                 LDP4    O2COM+4
        22 001606   400003 475500                    LDP5    3,,PR4
        22 001607   500000 220100                    LDX0    0,,PR5
        22 001610   000373 100003                    CMPX0   251,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:114  
        22 001611   001625 600000 22                 TZE     s:12489

  12484 22 001612   000004 470400 12                 LDP0    O2COM+4
        22 001613   000002 236100                    LDQ     2,,PR0
        22 001614   000004 756000 12                 STQ     O2COM+4

  12487 22 001615   000004 470400 12                 LDP0    O2COM+4
        22 001616   000003 236100                    LDQ     3,,PR0
        22 001617   000000 116000 23                 CMPQ    0
        22 001620   001612 600000 22                 TZE     s:12484

  12488 22 001621   000003 471500                    LDP1    3,,PR0
        22 001622   100000 220100                    LDX0    0,,PR1
        22 001623   000373 100003                    CMPX0   251,DU
        22 001624   001612 601000 22                 TNZ     s:12484

  12489 22 001625   000004 470400 12                 LDP0    O2COM+4
        22 001626   000003 471500                    LDP1    3,,PR0
        22 001627   100000 236100                    LDQ     0,,PR1
        22 001630   777777 376007                    ANQ     -1,DL
        22 001631   000133 756000 xsym               STQ     COMCOM+91

  12490 22 001632   000003 471500                    LDP1    3,,PR0
        22 001633   100002 236100                    LDQ     2,,PR1
        22 001634   777777 376007                    ANQ     -1,DL
        22 001635   000134 756000 xsym               STQ     COMCOM+92

  12493 22 001636   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001637   000006 036003                    ADLQ    6,DU
        22 001640   000000 235000 23                 LDA     0
        22 001641   000076 757000 0                  STAQ    @INTDEF$$+3
        22 001642   000000 236000 23                 LDQ     0
        22 001643   000016 235000 23                 LDA     14
        22 001644   000074 757000 0                  STAQ    @INTDEF$$+1
        22 001645   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 001646   000014 631400 23                 EPPR1   12
        22 001647   000000 701000 xent               TSX1    Z8AE$ERROR
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:115  
        22 001650   000000 011000                    NOP     0

  12495 22 001651   400000 236003                    LDQ     -131072,DU
        22 001652   000060 756000 0                  STQ     BAD_REFERENCE

  12496 22 001653   002121 710000 22                 TRA     s:12627

      636    12498    5                      ELSE
      637    12499    6                        DO ;

      638    12500        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:116  
      639    12501        /*V*
      640    12502            SEARCH_FOR_LABEL -- Unqualified label reference.  This loop looks thru the
      641    12503                                label entries of this name in the ST to find the correct
      642    12504                                one.  QUAL$ is the pointer to the label entry's father
      643    12505                                and QLT$ points to the current section name entry in the
      644    12506                                QLT.  They will be equal when the correct label entry is
      645    12507                                found.
      646    12508        */
      647    12509
      648    12510    6                        DUPLICATE_LBL = FALSE ;

  12510 22 001654   000034 450000 0                  STZ     DUPLICATE_LBL

      649    12511    6                        START_LBL$ = LABEL_REFERENCE$ ;

  12511 22 001655   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001656   000020 756000 0                  STQ     START_LBL$

      650    12512
      651    12513    7                        DO WHILE LABEL_REFERENCE$ -> LABEL.SECTION$ ~=

  12513 22 001657   001673 710000 22                 TRA     s:12521

      652    12514    7                                 O2COM.SECTION$ OR
      653    12515    7                                 LABEL_REFERENCE$ -> LABEL.PROC$ ~= CURRENT_PROC$ ;
      654    12516    7                          LABEL_REFERENCE$ = LABEL_REFERENCE$ -> LABEL.NEXT ;

  12516 22 001660   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 001661   000004 236100                    LDQ     4,,PR0
        22 001662   000033 756000 0                  STQ     LABEL_REFERENCE$

      655    12517    7                          IF LABEL_REFERENCE$ = ADDR(NIL) THEN

  12517 22 001663   000000 116000 23                 CMPQ    0
        22 001664   001702 600000 22                 TZE     s:12523

      656    12518    7                            EXIT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:117  
      657    12519    7                          IF LABEL_REFERENCE$ -> LABEL.ID = %PARA THEN

  12519 22 001665   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 001666   000000 220100                    LDX0    0,,PR0
        22 001667   000771 100003                    CMPX0   505,DU
        22 001670   001673 601000 22                 TNZ     s:12521

      658    12520    7                            DUPLICATE_LBL = TRUE ;

  12520 22 001671   400000 236003                    LDQ     -131072,DU
        22 001672   000034 756000 0                  STQ     DUPLICATE_LBL

      659    12521    7                        END ;

  12521 22 001673   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 001674   000007 236100                    LDQ     7,,PR0
        22 001675   000003 116000 12                 CMPQ    O2COM+3
        22 001676   001660 601000 22                 TNZ     s:12516
        22 001677   000011 236100                    LDQ     9,,PR0
        22 001700   000025 116000 0                  CMPQ    CURRENT_PROC$
        22 001701   001660 601000 22                 TNZ     s:12516

      660    12522
      661    12523    6                        IF LABEL_REFERENCE$ = ADDR(NIL) AND DUPLICATE_LBL THEN

  12523 22 001702   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001703   000000 116000 23                 CMPQ    0
        22 001704   002012 601000 22                 TNZ     s:12580
        22 001705   000034 234000 0                  SZN     DUPLICATE_LBL
        22 001706   002012 605000 22                 TPL     s:12580

      662    12524
      663    12525        /*V*
      664    12526            NO_LABEL_IN_SECTION -- There is no label by this name in the appropriate
      665    12527                                   section.  There are duplicate labels in the
      666    12528                                   program so the correct one cannot be distinguished.
      667    12529                                   The ILL's operand will be assigned the pointer of
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:118  
      668    12530                                   the first label entry in the ST with this name
      669    12531                                   and an error will be produced.
      670    12532        */
      671    12533
      672    12534    7                          DO ;

      673    12535    7                            LABEL_REFERENCE$ = REF$ITEM$ -> DNT.ST$ ;

  12535 22 001707   000057 470400 0                  LDP0    REF_PTR$$
        22 001710   000000 471500                    LDP1    0,,PR0
        22 001711   100001 236100                    LDQ     1,,PR1
        22 001712   000033 756000 0                  STQ     LABEL_REFERENCE$

      674    12536                                 %DUP_LABEL_ERROR ;

  12538 22 001713   000035 236000 0                  LDQ     ERR_LINE
        22 001714   000133 116000 xsym               CMPQ    COMCOM+91
        22 001715   001724 601000 22                 TNZ     s:12540
        22 001716   000036 236000 0                  LDQ     ERR_COL
        22 001717   000134 116000 xsym               CMPQ    COMCOM+92
        22 001720   001724 601000 22                 TNZ     s:12540
        22 001721   000037 236000 0                  LDQ     ERR_DNT$
        22 001722   000000 116100                    CMPQ    0,,PR0
        22 001723   002007 600000 22                 TZE     s:12566

  12540 22 001724   000133 235000 xsym               LDA     COMCOM+91
        22 001725   000035 755000 0                  STA     ERR_LINE

  12541 22 001726   000134 236000 xsym               LDQ     COMCOM+92
        22 001727   000036 756000 0                  STQ     ERR_COL

  12542 22 001730   000000 236100                    LDQ     0,,PR0
        22 001731   000037 756000 0                  STQ     ERR_DNT$

  12543 22 001732   000000 236000 17                 LDQ     ILS$
        22 001733   000000 116000 23                 CMPQ    0
        22 001734   001742 601000 22                 TNZ     s:12550
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:119  

  12545 22 001735   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 001736   100002 236100                    LDQ     2,,PR1
        22 001737   777777 376007                    ANQ     -1,DL
        22 001740   000133 756000 xsym               STQ     COMCOM+91
        22 001741   001774 710000 22                 TRA     s:12564

  12550 22 001742   000004 756000 12                 STQ     O2COM+4

  12551 22 001743   000004 471400 12                 LDP1    O2COM+4
        22 001744   100003 473500                    LDP3    3,,PR1
        22 001745   300000 220100                    LDX0    0,,PR3
        22 001746   000373 100003                    CMPX0   251,DU
        22 001747   001763 600000 22                 TZE     s:12560

  12555 22 001750   000004 470400 12                 LDP0    O2COM+4
        22 001751   000002 236100                    LDQ     2,,PR0
        22 001752   000004 756000 12                 STQ     O2COM+4

  12558 22 001753   000004 470400 12                 LDP0    O2COM+4
        22 001754   000003 236100                    LDQ     3,,PR0
        22 001755   000000 116000 23                 CMPQ    0
        22 001756   001750 600000 22                 TZE     s:12555

  12559 22 001757   000003 471500                    LDP1    3,,PR0
        22 001760   100000 220100                    LDX0    0,,PR1
        22 001761   000373 100003                    CMPX0   251,DU
        22 001762   001750 601000 22                 TNZ     s:12555

  12560 22 001763   000004 470400 12                 LDP0    O2COM+4
        22 001764   000003 471500                    LDP1    3,,PR0
        22 001765   100000 236100                    LDQ     0,,PR1
        22 001766   777777 376007                    ANQ     -1,DL
        22 001767   000133 756000 xsym               STQ     COMCOM+91

  12561 22 001770   000003 471500                    LDP1    3,,PR0
        22 001771   100002 236100                    LDQ     2,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:120  
        22 001772   777777 376007                    ANQ     -1,DL
        22 001773   000134 756000 xsym               STQ     COMCOM+92

  12564 22 001774   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 001775   000006 036003                    ADLQ    6,DU
        22 001776   000000 235000 23                 LDA     0
        22 001777   000076 757000 0                  STAQ    @INTDEF$$+3
        22 002000   000000 236000 23                 LDQ     0
        22 002001   000016 235000 23                 LDA     14
        22 002002   000074 757000 0                  STAQ    @INTDEF$$+1
        22 002003   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 002004   000014 631400 23                 EPPR1   12
        22 002005   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002006   000000 011000                    NOP     0

  12566 22 002007   400000 236003                    LDQ     -131072,DU
        22 002010   000060 756000 0                  STQ     BAD_REFERENCE

      675    12569    7                          END ;

  12569 22 002011   002121 710000 22                 TRA     s:12627

      676    12570    6                        ELSE
      677    12571        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:121  
      678    12572        /*V*
      679    12573            LABEL_IN_SECTION -- A label with the correct name was found in the current
      680    12574                                section.  The pointer is assigned to the ILL entry and
      681    12575                                if there's more than one label entry of this name in the
      682    12576                                section an error is produced.
      683    12577        */
      684    12578
      685    12579    7                          DO ;

      686    12580    7                            IF NOT DUPLICATE_LBL THEN

  12580 22 002012   000034 234000 0                  SZN     DUPLICATE_LBL
        22 002013   002016 604000 22                 TMI     s:12582

      687    12581    7                              LABEL_REFERENCE$ = START_LBL$ ;

  12581 22 002014   000020 236000 0                  LDQ     START_LBL$
        22 002015   000033 756000 0                  STQ     LABEL_REFERENCE$

      688    12582    7                            IF LABEL_REFERENCE$ -> LABEL.B.DUPLICATE THEN

  12582 22 002016   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002017   000003 236100                    LDQ     3,,PR0
        22 002020   020000 316003                    CANQ    8192,DU
        22 002021   002121 600000 22                 TZE     s:12627

      689    12583                                   %DUP_LABEL_ERROR ;

  12585 22 002022   000035 236000 0                  LDQ     ERR_LINE
        22 002023   000133 116000 xsym               CMPQ    COMCOM+91
        22 002024   002034 601000 22                 TNZ     s:12587
        22 002025   000036 236000 0                  LDQ     ERR_COL
        22 002026   000134 116000 xsym               CMPQ    COMCOM+92
        22 002027   002034 601000 22                 TNZ     s:12587
        22 002030   000057 471400 0                  LDP1    REF_PTR$$
        22 002031   000037 236000 0                  LDQ     ERR_DNT$
        22 002032   100000 116100                    CMPQ    0,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:122  
        22 002033   002117 600000 22                 TZE     s:12613

  12587 22 002034   000133 235000 xsym               LDA     COMCOM+91
        22 002035   000035 755000 0                  STA     ERR_LINE

  12588 22 002036   000134 236000 xsym               LDQ     COMCOM+92
        22 002037   000036 756000 0                  STQ     ERR_COL

  12589 22 002040   000057 471400 0                  LDP1    REF_PTR$$
        22 002041   100000 236100                    LDQ     0,,PR1
        22 002042   000037 756000 0                  STQ     ERR_DNT$

  12590 22 002043   000000 236000 17                 LDQ     ILS$
        22 002044   000000 116000 23                 CMPQ    0
        22 002045   002052 601000 22                 TNZ     s:12597

  12592 22 002046   000002 236100                    LDQ     2,,PR0
        22 002047   777777 376007                    ANQ     -1,DL
        22 002050   000133 756000 xsym               STQ     COMCOM+91
        22 002051   002104 710000 22                 TRA     s:12611

  12597 22 002052   000004 756000 12                 STQ     O2COM+4

  12598 22 002053   000004 473400 12                 LDP3    O2COM+4
        22 002054   300003 474500                    LDP4    3,,PR3
        22 002055   400000 220100                    LDX0    0,,PR4
        22 002056   000373 100003                    CMPX0   251,DU
        22 002057   002073 600000 22                 TZE     s:12607

  12602 22 002060   000004 470400 12                 LDP0    O2COM+4
        22 002061   000002 236100                    LDQ     2,,PR0
        22 002062   000004 756000 12                 STQ     O2COM+4

  12605 22 002063   000004 470400 12                 LDP0    O2COM+4
        22 002064   000003 236100                    LDQ     3,,PR0
        22 002065   000000 116000 23                 CMPQ    0
        22 002066   002060 600000 22                 TZE     s:12602
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:123  

  12606 22 002067   000003 471500                    LDP1    3,,PR0
        22 002070   100000 220100                    LDX0    0,,PR1
        22 002071   000373 100003                    CMPX0   251,DU
        22 002072   002060 601000 22                 TNZ     s:12602

  12607 22 002073   000004 470400 12                 LDP0    O2COM+4
        22 002074   000003 471500                    LDP1    3,,PR0
        22 002075   100000 236100                    LDQ     0,,PR1
        22 002076   777777 376007                    ANQ     -1,DL
        22 002077   000133 756000 xsym               STQ     COMCOM+91

  12608 22 002100   000003 471500                    LDP1    3,,PR0
        22 002101   100002 236100                    LDQ     2,,PR1
        22 002102   777777 376007                    ANQ     -1,DL
        22 002103   000134 756000 xsym               STQ     COMCOM+92

  12611 22 002104   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 002105   000006 036003                    ADLQ    6,DU
        22 002106   000000 235000 23                 LDA     0
        22 002107   000076 757000 0                  STAQ    @INTDEF$$+3
        22 002110   000000 236000 23                 LDQ     0
        22 002111   000016 235000 23                 LDA     14
        22 002112   000074 757000 0                  STAQ    @INTDEF$$+1
        22 002113   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 002114   000014 631400 23                 EPPR1   12
        22 002115   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002116   000000 011000                    NOP     0

  12613 22 002117   400000 236003                    LDQ     -131072,DU
        22 002120   000060 756000 0                  STQ     BAD_REFERENCE

      690    12616    7                          END ;

      691    12617    6                        END ;

      692    12618    5                    END ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:124  

      693    12619    4                END ;

      694    12620    3            END ;

      695    12621
      696    12622        /*V*
      697    12623            REFERENCE_CLEAN_UP -- Set the referenced and one_ref bits.  Assign the ILL
      698    12624                                  operand the address of the ST entry.
      699    12625        */
      700    12626
      701    12627    2          IF NOT BAD_REFERENCE THEN

  12627 22 002121   000060 234000 0                  SZN     BAD_REFERENCE
        22 002122   002312 604000 22                 TMI     s:12719

      702    12628    3            DO ;

      703    12629    4              IF GOTO_DEST THEN DO ;

  12629 22 002123   000056 470400 0                  LDP0    @GOTO_DEST
        22 002124   000000 234100                    SZN     0,,PR0
        22 002125   002166 605000 22                 TPL     s:12659

      704    12630    5                IF LABEL_REFERENCE$ -> LABEL.B.ENTRY_POINT THEN DO ;

  12630 22 002126   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 002127   100003 236100                    LDQ     3,,PR1
        22 002130   000002 316003                    CANQ    2,DU
        22 002131   002163 600000 22                 TZE     s:12657

      705    12631                       /* Label to be transferred to is also a program entry point.
      706    12632                          This must be handled with great care, to prevent the
      707    12633                          program entry code from being executed again, which would
      708    12634                          cause a runtime abort. It is necessary to transfer instead
      709    12635                          to the compiler-created label after the %ENTRY. */
      710    12636    5                  TEMP$ = LABEL_REFERENCE$ -> LABEL.PREV_ILS$ ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:125  

  12636 22 002132   100010 236100                    LDQ     8,,PR1
        22 002133   000031 756000 0                  STQ     TEMP$

      711    12637                       /* This points not to the %GO before the label -- see comments
      712    12638                          in FIND_LABEL_END -- but to what's before the %GO. */
      713    12639                       %NEXT_NON_SUPPORT (POINTER=TEMP$) ; /* ILS for the %GO */

  12649 22 002134   000031 470400 0                  LDP0    TEMP$
        22 002135   000002 236100                    LDQ     2,,PR0
        22 002136   000031 756000 0                  STQ     TEMP$

  12652 22 002137   000031 470400 0                  LDP0    TEMP$
        22 002140   000003 236100                    LDQ     3,,PR0
        22 002141   000000 116000 23                 CMPQ    0
        22 002142   002134 600000 22                 TZE     s:12649
        22 002143   000003 471500                    LDP1    3,,PR0
        22 002144   100000 220100                    LDX0    0,,PR1
        22 002145   000343 100003                    CMPX0   227,DU
        22 002146   002134 600000 22                 TZE     s:12649
        22 002147   000422 100003                    CMPX0   274,DU
        22 002150   002134 600000 22                 TZE     s:12649
        22 002151   000446 100003                    CMPX0   294,DU
        22 002152   002134 600000 22                 TZE     s:12649
        22 002153   000336 100003                    CMPX0   222,DU
        22 002154   002134 600000 22                 TZE     s:12649
        22 002155   000420 100003                    CMPX0   272,DU
        22 002156   002134 600000 22                 TZE     s:12649
        22 002157   000373 100003                    CMPX0   251,DU
        22 002160   002134 600000 22                 TZE     s:12649

      714    12654    5                  LABEL_REFERENCE$ = TEMP$ -> ILS.ILL$ -> ILL.LOP ;

  12654 22 002161   100001 236100                    LDQ     1,,PR1
        22 002162   000033 756000 0                  STQ     LABEL_REFERENCE$

      715    12655                       /* The %GO's LOP is the desired label to transfer to. */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:126  
      716    12656    5                END ;

      717    12657    4                LABEL_REFERENCE$ -> LABEL.B.GOTO_LABEL = TRUE ;

  12657 22 002163   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002164   040000 236003                    LDQ     16384,DU
        22 002165   000003 256100                    ORSQ    3,,PR0

      718    12658    4              END ;

      719    12659    3              IF LABEL_REFERENCE$ -> LABEL.B.REFERENCED THEN

  12659 22 002166   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002167   000003 234100                    SZN     3,,PR0
        22 002170   002174 605000 22                 TPL     s:12663

      720    12660    3                LABEL_REFERENCE$ -> LABEL.B.ONE_REF = FALSE ;

  12660 22 002171   000025 236000 23                 LDQ     21
        22 002172   000003 356100                    ANSQ    3,,PR0
        22 002173   002201 710000 22                 TRA     s:12669

      721    12661    3              ELSE
      722    12662    4                DO ;

      723    12663    4                  LABEL_REFERENCE$ -> LABEL.B.REFERENCED = TRUE ;

  12663 22 002174   400000 236003                    LDQ     -131072,DU
        22 002175   000003 256100                    ORSQ    3,,PR0

      724    12664    4                  LABEL_REFERENCE$ -> LABEL.B.ONE_REF = TRUE ;

  12664 22 002176   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002177   010000 236003                    LDQ     4096,DU
        22 002200   000003 256100                    ORSQ    3,,PR0

      725    12665    4                END ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:127  

      726    12666
      727    12667
      728    12668                                                             /*#25279*/
      729    12669    3                IF COMCOM.OB.XREF THEN

  12669 22 002201   000055 234000 xsym               SZN     COMCOM+45
        22 002202   002306 605000 22                 TPL     s:12713

      730    12670    3                   IF NOT LABEL_REFERENCE$ -> LABEL.B.COMPILER_CREATED THEN

  12670 22 002203   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002204   000003 236100                    LDQ     3,,PR0
        22 002205   100000 316003                    CANQ    32768,DU
        22 002206   002306 601000 22                 TNZ     s:12713

      731    12671    4                   DO; IF ILS$ = ADDR(NIL) THEN

  12671 22 002207   000000 236000 17                 LDQ     ILS$
        22 002210   000000 116000 23                 CMPQ    0
        22 002211   002216 601000 22                 TNZ     s:12676

      732    12672    4                          COMCOM.CURRENT.LINE = LABEL_REFERENCE$ -> LABEL.LINE_NO;

  12672 22 002212   000002 236100                    LDQ     2,,PR0
        22 002213   777777 376007                    ANQ     -1,DL
        22 002214   000133 756000 xsym               STQ     COMCOM+91
        22 002215   002250 710000 22                 TRA     s:12695

      733    12673    4                       ELSE
      734    12674                              %FIND_LINE_NO;

  12676 22 002216   000004 756000 12                 STQ     O2COM+4

  12677 22 002217   000004 471400 12                 LDP1    O2COM+4
        22 002220   100003 473500                    LDP3    3,,PR1
        22 002221   300000 220100                    LDX0    0,,PR3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:128  
        22 002222   000373 100003                    CMPX0   251,DU
        22 002223   002237 600000 22                 TZE     s:12686

  12681 22 002224   000004 470400 12                 LDP0    O2COM+4
        22 002225   000002 236100                    LDQ     2,,PR0
        22 002226   000004 756000 12                 STQ     O2COM+4

  12684 22 002227   000004 470400 12                 LDP0    O2COM+4
        22 002230   000003 236100                    LDQ     3,,PR0
        22 002231   000000 116000 23                 CMPQ    0
        22 002232   002224 600000 22                 TZE     s:12681

  12685 22 002233   000003 471500                    LDP1    3,,PR0
        22 002234   100000 220100                    LDX0    0,,PR1
        22 002235   000373 100003                    CMPX0   251,DU
        22 002236   002224 601000 22                 TNZ     s:12681

  12686 22 002237   000004 470400 12                 LDP0    O2COM+4
        22 002240   000003 471500                    LDP1    3,,PR0
        22 002241   100000 236100                    LDQ     0,,PR1
        22 002242   777777 376007                    ANQ     -1,DL
        22 002243   000133 756000 xsym               STQ     COMCOM+91

  12687 22 002244   000003 471500                    LDP1    3,,PR0
        22 002245   100002 236100                    LDQ     2,,PR1
        22 002246   777777 376007                    ANQ     -1,DL
        22 002247   000134 756000 xsym               STQ     COMCOM+92

      735    12690
      736    12691                            %ADD_XREF (SYM  = LABEL_REFERENCE$,
      737    12692                                       ISN  = COMCOM.CURRENT.LINE,
      738    12693                                       TYPE = %XREF_REF);

  12695 22 002250   000055 234000 xsym               SZN     COMCOM+45
        22 002251   002306 605000 22                 TPL     s:12713

  12699 22 002252   000002 236000 21                 LDQ     XREF_+2
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:129  
        22 002253   000002 036007                    ADLQ    2,DL
        22 002254   000003 116000 21                 CMPQ    XREF_+3
        22 002255   002266 602000 22                 TNC     s:12701

  12700 22 002256   000026 236000 23                 LDQ     22
        22 002257   000074 756000 0                  STQ     @INTDEF$$+1
        22 002260   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 002261   000075 450400 0                  STP0    @INTDEF$$+2
        22 002262   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 002263   000001 631400 23                 EPPR1   1
        22 002264   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 002265   000000 011000                    NOP     0

  12701 22 002266   000002 236000 21                 LDQ     XREF_+2
        22 002267   000022 736000                    QLS     18
        22 002270   000001 036000 21                 ADLQ    XREF_+1
        22 002271   000000 756000 20                 STQ     XREF$

  12702 22 002272   000002 235000 21                 LDA     XREF_+2
        22 002273   000002 035007                    ADLA    2,DL
        22 002274   000002 755000 21                 STA     XREF_+2

  12703 22 002275   000001 220003                    LDX0    1,DU
        22 002276   000000 470400 20                 LDP0    XREF$
        22 002277   000000 740100                    STX0    0,,PR0

  12706 22 002300   000133 721000 xsym               LXL1    COMCOM+91
        22 002301   000000 470400 20                 LDP0    XREF$
        22 002302   000000 441100                    SXL1    0,,PR0

  12707 22 002303   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 002304   000000 470400 20                 LDP0    XREF$
        22 002305   000001 756100                    STQ     1,,PR0

      739    12711    4                   END;

      740    12712
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:130  
      741    12713    3              REF$ITEM$ = LABEL_REFERENCE$ ;

  12713 22 002306   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 002307   000057 470400 0                  LDP0    REF_PTR$$
        22 002310   000000 756100                    STQ     0,,PR0

      742    12714    3            END ;

  12714 22 002311   002315 710000 22                 TRA     s:12720

      743    12715    2          ELSE
      744    12716                 %IF GCOS ;
      746    12718                 %ENDIF ;
      747    12719    2            REF$ITEM$ = ADDR (NIL) ; /* Mark for Z8FF$FLOW_ANALYSIS */

  12719 22 002312   000000 236000 23                 LDQ     0
        22 002313   000057 470400 0                  LDP0    REF_PTR$$
        22 002314   000000 756100                    STQ     0,,PR0

      748    12720    2   END REFERENCE_RESOLUTION ;

  12720 22 002315   000054 221200 0                  LDX1  ! @LBL_SYM$+1
        22 002316   000001 702211                    TSX2  ! 1,X1

      749    12721        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:131  
      750    12722    1   ALTER_CHECK: PROC ;

  12722 22 002317   000062 741200 0     ALTER_CHECK  STX1  ! ITEM_NOT_ETT+1

      751    12723
      752    12724        /*I*
      753    12725               NAME:  ALTER_CHECK
      754    12726               CALL:  CALL ALTER_CHECK ;
      755    12727
      756    12728              INPUT:  ILL$ -- Ptr to ALTER item
      757    12729             OUTPUT:  LABEL.B.ALTER_CHECK turned on and PRESET created.
      758    12730
      759    12731        DESCRIPTION:  This procedure checks the paragraph that is being altered
      760    12732                      to make sure it can be altered.  A preset item must be created.
      761    12733                      If there is no initial field, a dummy preset (to the altered
      762    12734                      paragraph itself) is still needed, so the tag field will not
      763    12735                      be garbage when the GO TO is actually executed.
      764    12736        */
      765    12737
      766    12738    2   DCL  GO_ILS$ PTR ; /* Ptr to ILS item above GO item in ALTER paragraph */
      767    12739    2   DCL  ALTER_ILS$ PTR ; /* PTR to ILS for paragraph being ALTERed */
      768    12740    2   DCL  TEMP_ILS$  PTR;
      769    12741    2   DCL  LINOI$  PTR; /* PTR for LINOI in GO statement. */
      770    12742
      771    12743        %MACRO CREATE_POINTER_ITEM ;
      772    12744               DO ;
      773    12745                 %NEW_SCALAR (@ST$ = LABEL_REFERENCE$,
      774    12746                              @TYPE = %TYI,
      775    12747                              @DNT$ = ILL$ -> ILL.LOP -> LABEL.DNT$,
      776    12748                              @ELEMENTARY = TRUE) ;
      777    12749                 LABEL_REFERENCE$ -> VARIABLE.ID = %POINTER ;
      778    12750                 LABEL_REFERENCE$ -> VARIABLE.TYPE = %TYP ;
      779    12751                 LABEL_REFERENCE$ -> VARIABLE.ADSC.N = %BYTES_PER_WORD ;
      780    12752
      781    12753                 %INCREMENT_STORAGE_CNT(@ITEM$=LABEL_REFERENCE$) ;
      782    12754
      783    12755                 ILL$ -> ILL.LOP -> LABEL.POINTER$ = LABEL_REFERENCE$ ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:132  
      784    12756               END ;
      785    12757        %MEND ;
      786    12758        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:133  
      787    12759    3          IF ILL$ -> ILL.LOP -> LABEL.ID = %SECTION AND NOT ILL$ -> ILL.LOP -> LABEL.
             12759                   DNT$ -> DNT.B.ERROR_VARIABLE THEN DO ;

  12759 22 002320   000000 470400 15                 LDP0    ILL$
        22 002321   000001 471500                    LDP1    1,,PR0
        22 002322   100000 220100                    LDX0    0,,PR1
        22 002323   000770 100003                    CMPX0   504,DU
        22 002324   002405 601000 22                 TNZ     s:12781
        22 002325   100006 473500                    LDP3    6,,PR1
        22 002326   300003 236100                    LDQ     3,,PR3
        22 002327   000100 316003                    CANQ    64,DU
        22 002330   002405 601000 22                 TNZ     s:12781

      788    12760                 %FIND_LINE_NO ;

  12762 22 002331   000000 236000 17                 LDQ     ILS$
        22 002332   000004 756000 12                 STQ     O2COM+4

  12763 22 002333   000004 471400 12                 LDP1    O2COM+4
        22 002334   100003 473500                    LDP3    3,,PR1
        22 002335   300000 220100                    LDX0    0,,PR3
        22 002336   000373 100003                    CMPX0   251,DU
        22 002337   002353 600000 22                 TZE     s:12772

  12767 22 002340   000004 470400 12                 LDP0    O2COM+4
        22 002341   000002 236100                    LDQ     2,,PR0
        22 002342   000004 756000 12                 STQ     O2COM+4

  12770 22 002343   000004 470400 12                 LDP0    O2COM+4
        22 002344   000003 236100                    LDQ     3,,PR0
        22 002345   000000 116000 23                 CMPQ    0
        22 002346   002340 600000 22                 TZE     s:12767

  12771 22 002347   000003 471500                    LDP1    3,,PR0
        22 002350   100000 220100                    LDX0    0,,PR1
        22 002351   000373 100003                    CMPX0   251,DU
        22 002352   002340 601000 22                 TNZ     s:12767
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:134  

  12772 22 002353   000004 470400 12                 LDP0    O2COM+4
        22 002354   000003 471500                    LDP1    3,,PR0
        22 002355   100000 236100                    LDQ     0,,PR1
        22 002356   777777 376007                    ANQ     -1,DL
        22 002357   000133 756000 xsym               STQ     COMCOM+91

  12773 22 002360   000003 471500                    LDP1    3,,PR0
        22 002361   100002 236100                    LDQ     2,,PR1
        22 002362   777777 376007                    ANQ     -1,DL
        22 002363   000134 756000 xsym               STQ     COMCOM+92

      789    12776    3            CALL Z8AE$ERROR(%E$ALTER_SECTION_ERROR,,, ILL$ -> ILL.LOP -> LABEL.DNT$) ;

  12776 22 002364   000000 471400 15                 LDP1    ILL$
        22 002365   100001 473500                    LDP3    1,,PR1
        22 002366   300006 634500                    EPPR4   6,,PR3
        22 002367   000077 454400 0                  STP4    @INTDEF$$+4
        22 002370   000000 236000 23                 LDQ     0
        22 002371   000076 756000 0                  STQ     @INTDEF$$+3
        22 002372   000030 235000 23                 LDA     24
        22 002373   000074 757000 0                  STAQ    @INTDEF$$+1
        22 002374   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 002375   000014 631400 23                 EPPR1   12
        22 002376   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002377   000000 011000                    NOP     0

      790    12777    3            ILL$ -> ILL.LOP = ADDR (NIL) ;

  12777 22 002400   000000 236000 23                 LDQ     0
        22 002401   000000 470400 15                 LDP0    ILL$
        22 002402   000001 756100                    STQ     1,,PR0

      791    12778    3            RETURN ;

  12778 22 002403   000062 221200 0                  LDX1  ! ITEM_NOT_ETT+1
        22 002404   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:135  

      792    12779    3          END ;
      793    12780
      794    12781    2          ALTER_ILS$ = ILL$ -> ILL.LOP -> LABEL.PREV_ILS$ ;

  12781 22 002405   100010 236100                    LDQ     8,,PR1
        22 002406   000064 756000 0                  STQ     ALTER_ILS$

      795    12782               %NEXT_NON_SUPPORT (POINTER=ALTER_ILS$) ;

  12792 22 002407   000064 470400 0                  LDP0    ALTER_ILS$
        22 002410   000002 236100                    LDQ     2,,PR0
        22 002411   000064 756000 0                  STQ     ALTER_ILS$

  12795 22 002412   000064 470400 0                  LDP0    ALTER_ILS$
        22 002413   000003 236100                    LDQ     3,,PR0
        22 002414   000000 116000 23                 CMPQ    0
        22 002415   002407 600000 22                 TZE     s:12792
        22 002416   000003 471500                    LDP1    3,,PR0
        22 002417   100000 220100                    LDX0    0,,PR1
        22 002420   000343 100003                    CMPX0   227,DU
        22 002421   002407 600000 22                 TZE     s:12792
        22 002422   000422 100003                    CMPX0   274,DU
        22 002423   002407 600000 22                 TZE     s:12792
        22 002424   000446 100003                    CMPX0   294,DU
        22 002425   002407 600000 22                 TZE     s:12792
        22 002426   000336 100003                    CMPX0   222,DU
        22 002427   002407 600000 22                 TZE     s:12792
        22 002430   000420 100003                    CMPX0   272,DU
        22 002431   002407 600000 22                 TZE     s:12792
        22 002432   000373 100003                    CMPX0   251,DU
        22 002433   002407 600000 22                 TZE     s:12792

      796    12797    2          GO_ILS$ = ALTER_ILS$ ;

  12797 22 002434   000064 236000 0                  LDQ     ALTER_ILS$
        22 002435   000063 756000 0                  STQ     GO_ILS$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:136  

      797    12798               %NEXT_NON_SUPPORT (POINTER=GO_ILS$) ;

  12808 22 002436   000063 470400 0                  LDP0    GO_ILS$
        22 002437   000002 236100                    LDQ     2,,PR0
        22 002440   000063 756000 0                  STQ     GO_ILS$

  12811 22 002441   000063 470400 0                  LDP0    GO_ILS$
        22 002442   000003 236100                    LDQ     3,,PR0
        22 002443   000000 116000 23                 CMPQ    0
        22 002444   002436 600000 22                 TZE     s:12808
        22 002445   000003 471500                    LDP1    3,,PR0
        22 002446   100000 220100                    LDX0    0,,PR1
        22 002447   000343 100003                    CMPX0   227,DU
        22 002450   002436 600000 22                 TZE     s:12808
        22 002451   000422 100003                    CMPX0   274,DU
        22 002452   002436 600000 22                 TZE     s:12808
        22 002453   000446 100003                    CMPX0   294,DU
        22 002454   002436 600000 22                 TZE     s:12808
        22 002455   000336 100003                    CMPX0   222,DU
        22 002456   002436 600000 22                 TZE     s:12808
        22 002457   000420 100003                    CMPX0   272,DU
        22 002460   002436 600000 22                 TZE     s:12808
        22 002461   000373 100003                    CMPX0   251,DU
        22 002462   002436 600000 22                 TZE     s:12808

      798    12813    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.ID = %OS_CALL AND

  12813 22 002463   000362 100003                    CMPX0   242,DU
        22 002464   002515 601000 22                 TNZ     s:12831
        22 002465   100000 721100                    LXL1    0,,PR1
        22 002466   000055 101003                    CMPX1   45,DU
        22 002467   002515 601000 22                 TNZ     s:12831

      799    12814    2              GO_ILS$ -> ILS.ILL$ -> ILL.CODE = %OP_PARA_ENTRY THEN
      800    12815                 %NEXT_NON_SUPPORT (POINTER=GO_ILS$) ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:137  
  12825 22 002470   000063 470400 0                  LDP0    GO_ILS$
        22 002471   000002 236100                    LDQ     2,,PR0
        22 002472   000063 756000 0                  STQ     GO_ILS$

  12828 22 002473   000063 470400 0                  LDP0    GO_ILS$
        22 002474   000003 236100                    LDQ     3,,PR0
        22 002475   000000 116000 23                 CMPQ    0
        22 002476   002470 600000 22                 TZE     s:12825
        22 002477   000003 471500                    LDP1    3,,PR0
        22 002500   100000 220100                    LDX0    0,,PR1
        22 002501   000343 100003                    CMPX0   227,DU
        22 002502   002470 600000 22                 TZE     s:12825
        22 002503   000422 100003                    CMPX0   274,DU
        22 002504   002470 600000 22                 TZE     s:12825
        22 002505   000446 100003                    CMPX0   294,DU
        22 002506   002470 600000 22                 TZE     s:12825
        22 002507   000336 100003                    CMPX0   222,DU
        22 002510   002470 600000 22                 TZE     s:12825
        22 002511   000420 100003                    CMPX0   272,DU
        22 002512   002470 600000 22                 TZE     s:12825
        22 002513   000373 100003                    CMPX0   251,DU
        22 002514   002470 600000 22                 TZE     s:12825

      801    12830
      802    12831    2          TEMP$ = GO_ILS$ ;

  12831 22 002515   000063 236000 0                  LDQ     GO_ILS$
        22 002516   000031 756000 0                  STQ     TEMP$

      803    12832               %NEXT_NON_SUPPORT (POINTER=TEMP$) ;

  12842 22 002517   000031 470400 0                  LDP0    TEMP$
        22 002520   000002 236100                    LDQ     2,,PR0
        22 002521   000031 756000 0                  STQ     TEMP$

  12845 22 002522   000031 470400 0                  LDP0    TEMP$
        22 002523   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:138  
        22 002524   000000 116000 23                 CMPQ    0
        22 002525   002517 600000 22                 TZE     s:12842
        22 002526   000003 471500                    LDP1    3,,PR0
        22 002527   100000 220100                    LDX0    0,,PR1
        22 002530   000343 100003                    CMPX0   227,DU
        22 002531   002517 600000 22                 TZE     s:12842
        22 002532   000422 100003                    CMPX0   274,DU
        22 002533   002517 600000 22                 TZE     s:12842
        22 002534   000446 100003                    CMPX0   294,DU
        22 002535   002517 600000 22                 TZE     s:12842
        22 002536   000336 100003                    CMPX0   222,DU
        22 002537   002517 600000 22                 TZE     s:12842
        22 002540   000420 100003                    CMPX0   272,DU
        22 002541   002517 600000 22                 TZE     s:12842
        22 002542   000373 100003                    CMPX0   251,DU
        22 002543   002517 600000 22                 TZE     s:12842

      804    12847    2          TEMP_ILS$ = TEMP$ ;

  12847 22 002544   000031 236000 0                  LDQ     TEMP$
        22 002545   000065 756000 0                  STQ     TEMP_ILS$

      805    12848               %NEXT_NON_SUPPORT (POINTER=TEMP_ILS$) ;

  12858 22 002546   000065 470400 0                  LDP0    TEMP_ILS$
        22 002547   000002 236100                    LDQ     2,,PR0
        22 002550   000065 756000 0                  STQ     TEMP_ILS$

  12861 22 002551   000065 470400 0                  LDP0    TEMP_ILS$
        22 002552   000003 236100                    LDQ     3,,PR0
        22 002553   000000 116000 23                 CMPQ    0
        22 002554   002546 600000 22                 TZE     s:12858
        22 002555   000003 471500                    LDP1    3,,PR0
        22 002556   100000 220100                    LDX0    0,,PR1
        22 002557   000343 100003                    CMPX0   227,DU
        22 002560   002546 600000 22                 TZE     s:12858
        22 002561   000422 100003                    CMPX0   274,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:139  
        22 002562   002546 600000 22                 TZE     s:12858
        22 002563   000446 100003                    CMPX0   294,DU
        22 002564   002546 600000 22                 TZE     s:12858
        22 002565   000336 100003                    CMPX0   222,DU
        22 002566   002546 600000 22                 TZE     s:12858
        22 002567   000420 100003                    CMPX0   272,DU
        22 002570   002546 600000 22                 TZE     s:12858
        22 002571   000373 100003                    CMPX0   251,DU
        22 002572   002546 600000 22                 TZE     s:12858

      806    12863    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.ID ~= %GO OR

  12863 22 002573   000063 473400 0                  LDP3    GO_ILS$
        22 002574   300003 474500                    LDP4    3,,PR3
        22 002575   400000 221100                    LDX1    0,,PR4
        22 002576   000344 101003                    CMPX1   228,DU
        22 002577   002640 601000 22                 TNZ     s:12880
        22 002600   400000 722100                    LXL2    0,,PR4
        22 002601   002604 600000 22                 TZE     s:12863+9
        22 002602   000033 102003                    CMPX2   27,DU
        22 002603   002640 601000 22                 TNZ     s:12880
        22 002604   000031 475400 0                  LDP5    TEMP$
        22 002605   500003 476500                    LDP6    3,,PR5
        22 002606   600000 223100                    LDX3    0,,PR6
        22 002607   000346 103003                    CMPX3   230,DU
        22 002610   002615 601000 22                 TNZ     s:12863+18
        22 002611   600001 477500                    LDP7    1,,PR6
        22 002612   700003 236100                    LDQ     3,,PR7
        22 002613   000002 316003                    CANQ    2,DU
        22 002614   002640 601000 22                 TNZ     s:12880
        22 002615   000344 103003                    CMPX3   228,DU
        22 002616   002630 601000 22                 TNZ     s:12863+29
        22 002617   000346 100003                    CMPX0   230,DU
        22 002620   002640 601000 22                 TNZ     s:12880
        22 002621   100001 477500                    LDP7    1,,PR1
        22 002622   700000 224100                    LDX4    0,,PR7
        22 002623   000771 104003                    CMPX4   505,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:140  
        22 002624   002640 600000 22                 TZE     s:12880
        22 002625   700003 236100                    LDQ     3,,PR7
        22 002626   000002 316003                    CANQ    2,DU
        22 002627   002640 600000 22                 TZE     s:12880
        22 002630   000346 103003                    CMPX3   230,DU
        22 002631   002714 600000 22                 TZE     s:12899
        22 002632   000445 103003                    CMPX3   293,DU
        22 002633   002714 600000 22                 TZE     s:12899
        22 002634   000344 103003                    CMPX3   228,DU
        22 002635   002714 600000 22                 TZE     s:12899
        22 002636   000374 103003                    CMPX3   252,DU
        22 002637   002714 600000 22                 TZE     s:12899

      807    12864    2             (GO_ILS$ -> ILS.ILL$ -> ILL.CODE ~= %GO_UNCONDITIONAL AND
      808    12865    2             GO_ILS$ -> ILS.ILL$ -> ILL.CODE ~= %GO_INVALID_LABEL) OR
      809    12866    2             (TEMP$ -> ILS.ILL$ -> ILL.ID = %DEFLB AND
      810    12867    2             TEMP$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.ENTRY_POINT) OR
      811    12868    2             (TEMP$ -> ILS.ILL$ -> ILL.ID = %GO AND
      812    12869    2             (TEMP_ILS$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB OR
      813    12870    2             TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %PARA OR
      814    12871    2             NOT TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP -> SECTION.B.ENTRY_POINT)) OR
      815    12872                  /* Oh the complications caused by entry points ... */
      816    12873    2             (TEMP$ -> ILS.ILL$ -> ILL.ID ~= %DEFLB AND
      817    12874    2             TEMP$ -> ILS.ILL$ -> ILL.ID ~= %SCOPE AND
      818    12875    2             TEMP$ -> ILS.ILL$ -> ILL.ID ~= %GO AND
      819    12876    2             TEMP$ -> ILS.ILL$ -> ILL.ID ~= %END) THEN
      820    12877    3            DO ;

      821    12878                   %FIND_LINE_NO ;

  12880 22 002640   000000 236000 17                 LDQ     ILS$
        22 002641   000004 756000 12                 STQ     O2COM+4

  12881 22 002642   000004 471400 12                 LDP1    O2COM+4
        22 002643   100003 474500                    LDP4    3,,PR1
        22 002644   400000 220100                    LDX0    0,,PR4
        22 002645   000373 100003                    CMPX0   251,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:141  
        22 002646   002662 600000 22                 TZE     s:12890

  12885 22 002647   000004 470400 12                 LDP0    O2COM+4
        22 002650   000002 236100                    LDQ     2,,PR0
        22 002651   000004 756000 12                 STQ     O2COM+4

  12888 22 002652   000004 470400 12                 LDP0    O2COM+4
        22 002653   000003 236100                    LDQ     3,,PR0
        22 002654   000000 116000 23                 CMPQ    0
        22 002655   002647 600000 22                 TZE     s:12885

  12889 22 002656   000003 471500                    LDP1    3,,PR0
        22 002657   100000 220100                    LDX0    0,,PR1
        22 002660   000373 100003                    CMPX0   251,DU
        22 002661   002647 601000 22                 TNZ     s:12885

  12890 22 002662   000004 470400 12                 LDP0    O2COM+4
        22 002663   000003 471500                    LDP1    3,,PR0
        22 002664   100000 236100                    LDQ     0,,PR1
        22 002665   777777 376007                    ANQ     -1,DL
        22 002666   000133 756000 xsym               STQ     COMCOM+91

  12891 22 002667   000003 471500                    LDP1    3,,PR0
        22 002670   100002 236100                    LDQ     2,,PR1
        22 002671   777777 376007                    ANQ     -1,DL
        22 002672   000134 756000 xsym               STQ     COMCOM+92

      822    12894    3              CALL Z8AE$ERROR(%E$ALTER_PARA_ERROR,,, ILL$ -> ILL.LOP -> LABEL.DNT$) ;

  12894 22 002673   000000 471400 15                 LDP1    ILL$
        22 002674   100001 473500                    LDP3    1,,PR1
        22 002675   300006 634500                    EPPR4   6,,PR3
        22 002676   000077 454400 0                  STP4    @INTDEF$$+4
        22 002677   000000 236000 23                 LDQ     0
        22 002700   000076 756000 0                  STQ     @INTDEF$$+3
        22 002701   000032 235000 23                 LDA     26
        22 002702   000074 757000 0                  STAQ    @INTDEF$$+1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:142  
        22 002703   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 002704   000014 631400 23                 EPPR1   12
        22 002705   000000 701000 xent               TSX1    Z8AE$ERROR
        22 002706   000000 011000                    NOP     0

      823    12895    3              ILL$ -> ILL.LOP = ADDR(NIL) ;

  12895 22 002707   000000 236000 23                 LDQ     0
        22 002710   000000 470400 15                 LDP0    ILL$
        22 002711   000001 756100                    STQ     1,,PR0

      824    12896    3              RETURN ;

  12896 22 002712   000062 221200 0                  LDX1  ! ITEM_NOT_ETT+1
        22 002713   000001 702211                    TSX2  ! 1,X1

      825    12897    3            END ;
      826    12898
      827    12899    2          ILL$ -> ILL.LOP -> LABEL.B.ALTER_CHECK = TRUE ; /*ALTER statement valid */

  12899 22 002714   000000 477400 15                 LDP7    ILL$
        22 002715   700001 470500                    LDP0    1,,PR7
        22 002716   000040 236003                    LDQ     32,DU
        22 002717   000003 256100                    ORSQ    3,,PR0

      828    12900
      829    12901    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP ~= ADDR(NIL) AND

  12901 22 002720   300003 470500                    LDP0    3,,PR3
        22 002721   000001 236100                    LDQ     1,,PR0
        22 002722   000000 116000 23                 CMPQ    0
        22 002723   002746 600000 22                 TZE     s:12919
        22 002724   000001 471500                    LDP1    1,,PR0
        22 002725   100000 220100                    LDX0    0,,PR1
        22 002726   001046 100003                    CMPX0   550,DU
        22 002727   002746 601000 22                 TNZ     s:12919

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:143  
      830    12902    2            GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> DNT.ID = %LEXEME THEN
      831    12903    3            DO;

      832    12904    3              TEMP_ILS$ = ILS$;

  12904 22 002730   000000 236000 17                 LDQ     ILS$
        22 002731   000065 756000 0                  STQ     TEMP_ILS$

      833    12905    3              ILS$ = GO_ILS$;

  12905 22 002732   000063 236000 0                  LDQ     GO_ILS$
        22 002733   000000 756000 17                 STQ     ILS$

      834    12906    3              CALL REFERENCE_RESOLUTION (ADDR(GO_ILS$ -> ILS.ILL$ -> ILL.LOP), FALSE);

  12906 22 002734   000001 634500                    EPPR4   1,,PR0
        22 002735   000101 454400 0                  STP4    @INTDEF$$+6
        22 002736   000034 236000 23                 LDQ     28
        22 002737   000056 756000 0                  STQ     @GOTO_DEST
        22 002740   000101 630400 0                  EPPR0   @INTDEF$$+6
        22 002741   000055 450400 0                  STP0    @REF_PTR$
        22 002742   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 002743   000000 011000                    NOP     0

      835    12907    3              ILS$ = TEMP_ILS$;

  12907 22 002744   000065 236000 0                  LDQ     TEMP_ILS$
        22 002745   000000 756000 17                 STQ     ILS$

      836    12908    3            END;

      837    12909
      838    12910               %CREATE_POINTER_ITEM ;

  12919 22 002746   000002 236000 14                 LDQ     ST_+2
        22 002747   000013 036007                    ADLQ    11,DL
        22 002750   000003 116000 14                 CMPQ    ST_+3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:144  
        22 002751   002762 604000 22                 TMI     s:12921

  12920 22 002752   000035 236000 23                 LDQ     29
        22 002753   000074 756000 0                  STQ     @INTDEF$$+1
        22 002754   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 002755   000075 450400 0                  STP0    @INTDEF$$+2
        22 002756   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 002757   000001 631400 23                 EPPR1   1
        22 002760   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 002761   000000 011000                    NOP     0

  12921 22 002762   000002 236000 14                 LDQ     ST_+2
        22 002763   000022 736000                    QLS     18
        22 002764   000001 036000 14                 ADLQ    ST_+1
        22 002765   000033 756000 0                  STQ     LABEL_REFERENCE$

  12922 22 002766   000013 236007                    LDQ     11,DL
        22 002767   000002 056000 14                 ASQ     ST_+2

  12970 22 002770   000766 220003                    LDX0    502,DU
        22 002771   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002772   000000 740100                    STX0    0,,PR0

  12971 22 002773   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002774   003000 236007                    LDQ     1536,DL
        22 002775   000000 552110                    STBQ    0,'10'O,PR0

  12972 22 002776   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 002777   000001 236007                    LDQ     1,DL
        22 003000   000000 552104                    STBQ    0,'04'O,PR0

  12973 22 003001   000000 221003                    LDX1    0,DU
        22 003002   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003003   000001 741100                    STX1    1,,PR0

  12974 22 003004   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003005   000001 441100                    SXL1    1,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:145  

  12975 22 003006   000133 722000 xsym               LXL2    COMCOM+91
        22 003007   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003010   000002 442100                    SXL2    2,,PR0

  12976 22 003011   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003012   000003 450100                    STZ     3,,PR0

  12977 22 003013   000000 236000 23                 LDQ     0
        22 003014   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003015   000004 756100                    STQ     4,,PR0

  12978 22 003016   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003017   000005 756100                    STQ     5,,PR0

  12979 22 003020   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003021   000007 756100                    STQ     7,,PR0

  12980 22 003022   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003023   000010 741100                    STX1    8,,PR0

  12981 22 003024   777777 222003                    LDX2    -1,DU
        22 003025   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003026   000010 442100                    SXL2    8,,PR0

  12985 22 003027   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003030   000012 756100                    STQ     10,,PR0

  13011 22 003031   000001 223003                    LDX3    1,DU
        22 003032   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003033   000002 743100                    STX3    2,,PR0

  13016 22 003034   000000 470400 15                 LDP0    ILL$
        22 003035   000001 471500                    LDP1    1,,PR0
        22 003036   100006 236100                    LDQ     6,,PR1
        22 003037   000033 473400 0                  LDP3    LABEL_REFERENCE$
        22 003040   300006 756100                    STQ     6,,PR3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:146  

  13033 22 003041   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 003042   010000 236003                    LDQ     4096,DU
        22 003043   100003 256100                    ORSQ    3,,PR1

  13102 22 003044   000777 224003                    LDX4    511,DU
        22 003045   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 003046   100000 744100                    STX4    0,,PR1

  13103 22 003047   000022 225003                    LDX5    18,DU
        22 003050   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003051   000002 745100                    STX5    2,,PR0

  13104 22 003052   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 003053   000004 236007                    LDQ     4,DL
        22 003054   000001 752103                    STCQ    1,'03'O,PR0

  13107 22 003055   000145 470400 xsym               LDP0    COMCOM+101
        22 003056   000002 226100                    LDX6    2,,PR0
        22 003057   000033 471400 0                  LDP1    LABEL_REFERENCE$
        22 003060   100001 746100                    STX6    1,,PR1

  13108 22 003061   000145 470400 xsym               LDP0    COMCOM+101
        22 003062   000002 226100                    LDX6    2,,PR0
        22 003063   000001 627016                    EAX7    1,X6
        22 003064   000002 747100                    STX7    2,,PR0

  13115 22 003065   000000 470400 15                 LDP0    ILL$
        22 003066   000001 471500                    LDP1    1,,PR0
        22 003067   000033 236000 0                  LDQ     LABEL_REFERENCE$
        22 003070   100005 756100                    STQ     5,,PR1

      839    13118
      840    13119    3          IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP = ADDR(NIL) THEN DO ;

  13119 22 003071   000063 471400 0                  LDP1    GO_ILS$
        22 003072   100003 473500                    LDP3    3,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:147  
        22 003073   300001 236100                    LDQ     1,,PR3
        22 003074   000000 116000 23                 CMPQ    0
        22 003075   003457 601000 22                 TNZ     s:13274

      841    13120    4            IF COMCOM.OB.COUNT THEN DO ;

  13120 22 003076   000112 235000 xsym               LDA     COMCOM+74
        22 003077   003372 600000 22                 TZE     s:13246

      842    13121    4              TEMP_ILS$ = ALTER_ILS$ ;

  13121 22 003100   000064 236000 0                  LDQ     ALTER_ILS$
        22 003101   000065 756000 0                  STQ     TEMP_ILS$

      843    13122                   %NEXT_NON_SUPPORT (POINTER=TEMP_ILS$) ;

  13132 22 003102   000065 470400 0                  LDP0    TEMP_ILS$
        22 003103   000002 236100                    LDQ     2,,PR0
        22 003104   000065 756000 0                  STQ     TEMP_ILS$

  13135 22 003105   000065 470400 0                  LDP0    TEMP_ILS$
        22 003106   000003 236100                    LDQ     3,,PR0
        22 003107   000000 116000 23                 CMPQ    0
        22 003110   003102 600000 22                 TZE     s:13132
        22 003111   000003 471500                    LDP1    3,,PR0
        22 003112   100000 220100                    LDX0    0,,PR1
        22 003113   000343 100003                    CMPX0   227,DU
        22 003114   003102 600000 22                 TZE     s:13132
        22 003115   000422 100003                    CMPX0   274,DU
        22 003116   003102 600000 22                 TZE     s:13132
        22 003117   000446 100003                    CMPX0   294,DU
        22 003120   003102 600000 22                 TZE     s:13132
        22 003121   000336 100003                    CMPX0   222,DU
        22 003122   003102 600000 22                 TZE     s:13132
        22 003123   000420 100003                    CMPX0   272,DU
        22 003124   003102 600000 22                 TZE     s:13132
        22 003125   000373 100003                    CMPX0   251,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:148  
        22 003126   003102 600000 22                 TZE     s:13132

      844    13137    4              LINOI$ = TEMP_ILS$ ;

  13137 22 003127   000065 236000 0                  LDQ     TEMP_ILS$
        22 003130   000066 756000 0                  STQ     LINOI$

      845    13138    5              DO UNTIL LINOI$ -> ILS.ILL$ ~= ADDR (NIL) AND

      846    13139    5                  LINOI$ -> ILS.ILL$ -> ILL.ID = %LINOI ;
      847    13140                     %NEXT_ILS (POINTER=LINOI$) ;

  13142 22 003131   000066 470400 0                  LDP0    LINOI$
        22 003132   000002 236100                    LDQ     2,,PR0
        22 003133   000066 756000 0                  STQ     LINOI$

      848    13145    5              END ;

  13145 22 003134   000066 470400 0                  LDP0    LINOI$
        22 003135   000003 236100                    LDQ     3,,PR0
        22 003136   000000 116000 23                 CMPQ    0
        22 003137   003131 600000 22                 TZE     s:13142
        22 003140   000003 471500                    LDP1    3,,PR0
        22 003141   100000 220100                    LDX0    0,,PR1
        22 003142   000373 100003                    CMPX0   251,DU
        22 003143   003131 601000 22                 TNZ     s:13142

      849    13146    4              TEMP$ = TEMP_ILS$ -> ILS.NEXT ;

  13146 22 003144   000065 473400 0                  LDP3    TEMP_ILS$
        22 003145   300002 236100                    LDQ     2,,PR3
        22 003146   000031 756000 0                  STQ     TEMP$

      850    13147                   %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP_ILS$->ILS.NEXT) ;

  13167 22 003147   000002 236000 18                 LDQ     ILS_+2
        22 003150   000004 036007                    ADLQ    4,DL
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:149  
        22 003151   000003 116000 18                 CMPQ    ILS_+3
        22 003152   003163 602000 22                 TNC     s:13169

  13168 22 003153   000002 236000 23                 LDQ     2
        22 003154   000074 756000 0                  STQ     @INTDEF$$+1
        22 003155   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 003156   000075 451400 0                  STP1    @INTDEF$$+2
        22 003157   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003160   000001 631400 23                 EPPR1   1
        22 003161   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003162   000000 011000                    NOP     0

  13169 22 003163   000002 236000 18                 LDQ     ILS_+2
        22 003164   000022 736000                    QLS     18
        22 003165   000001 036000 18                 ADLQ    ILS_+1
        22 003166   000065 470400 0                  LDP0    TEMP_ILS$
        22 003167   000002 756100                    STQ     2,,PR0

  13170 22 003170   000002 235000 18                 LDA     ILS_+2
        22 003171   000004 035007                    ADLA    4,DL
        22 003172   000002 755000 18                 STA     ILS_+2

  13171 22 003173   000002 471500                    LDP1    2,,PR0
        22 003174   000740 220003                    LDX0    480,DU
        22 003175   100000 740100                    STX0    0,,PR1

  13172 22 003176   000002 471500                    LDP1    2,,PR0
        22 003177   000000 236000 23                 LDQ     0
        22 003200   100002 756100                    STQ     2,,PR1

      851    13176                   %NEXT_ILS (POINTER=TEMP_ILS$) ;

  13178 22 003201   000002 236100                    LDQ     2,,PR0
        22 003202   000065 756000 0                  STQ     TEMP_ILS$

      852    13181                   %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP_ILS$->ILS.ILL$) ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:150  
  13183 22 003203   000145 235000 xsym               LDA     ILL_STEP+101
        22 003204   000000 755000 1                  STA     ITERATION

  13184 22 003205   000002 236000 16                 LDQ     ILL_+2
        22 003206   000000 036000 1                  ADLQ    ITERATION
        22 003207   000003 116000 16                 CMPQ    ILL_+3
        22 003210   003221 604000 22                 TMI     s:13186

  13185 22 003211   000003 236000 23                 LDQ     3
        22 003212   000074 756000 0                  STQ     @INTDEF$$+1
        22 003213   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 003214   000075 450400 0                  STP0    @INTDEF$$+2
        22 003215   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003216   000001 631400 23                 EPPR1   1
        22 003217   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003220   000000 011000                    NOP     0

  13186 22 003221   000002 236000 16                 LDQ     ILL_+2
        22 003222   000022 736000                    QLS     18
        22 003223   000001 036000 16                 ADLQ    ILL_+1
        22 003224   000065 470400 0                  LDP0    TEMP_ILS$
        22 003225   000003 756100                    STQ     3,,PR0

  13187 22 003226   000002 236000 16                 LDQ     ILL_+2
        22 003227   000000 036000 1                  ADLQ    ITERATION
        22 003230   000002 756000 16                 STQ     ILL_+2

  13188 22 003231   000003 471500                    LDP1    3,,PR0
        22 003232   000373 220003                    LDX0    251,DU
        22 003233   100000 740100                    STX0    0,,PR1

      853    13191    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE = LINOI$ -> ILS.ILL$ -> LINOI.
             13191                       PREV_LINE ;

  13191 22 003234   000003 471500                    LDP1    3,,PR0
        22 003235   000066 473400 0                  LDP3    LINOI$
        22 003236   300003 474500                    LDP4    3,,PR3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:151  
        22 003237   400000 721100                    LXL1    0,,PR4
        22 003240   100000 441100                    SXL1    0,,PR1

      854    13192    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.LINE_NO = LINOI$ -> ILS.ILL$ -> LINOI.
             13192                       PREV_LINE ;

  13192 22 003241   000003 471500                    LDP1    3,,PR0
        22 003242   300003 474500                    LDP4    3,,PR3
        22 003243   400000 721100                    LXL1    0,,PR4
        22 003244   100001 441100                    SXL1    1,,PR1

      855    13193    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_COL = LINOI$ -> ILS.ILL$ -> LINOI.
             13193                       PREV_COL ;

  13193 22 003245   000003 471500                    LDP1    3,,PR0
        22 003246   300003 474500                    LDP4    3,,PR3
        22 003247   400002 721100                    LXL1    2,,PR4
        22 003250   100002 441100                    SXL1    2,,PR1

      856    13194    4              TEMP_ILS$ -> ILS.ILL$ -> LINOI.COLUMN_NO = LINOI$ -> ILS.ILL$ -> LINOI.
             13194                       PREV_COL ;

  13194 22 003251   000003 471500                    LDP1    3,,PR0
        22 003252   300003 474500                    LDP4    3,,PR3
        22 003253   400002 721100                    LXL1    2,,PR4
        22 003254   100001 741100                    STX1    1,,PR1

      857    13195                   %RESERVE_ILS (ITEM=%OPA, POINTER=TEMP_ILS$->ILS.NEXT) ;

  13215 22 003255   000002 236000 18                 LDQ     ILS_+2
        22 003256   000005 036007                    ADLQ    5,DL
        22 003257   000003 116000 18                 CMPQ    ILS_+3
        22 003260   003271 602000 22                 TNC     s:13217

  13216 22 003261   000002 236000 23                 LDQ     2
        22 003262   000074 756000 0                  STQ     @INTDEF$$+1
        22 003263   000074 631400 0                  EPPR1   @INTDEF$$+1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:152  
        22 003264   000075 451400 0                  STP1    @INTDEF$$+2
        22 003265   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003266   000001 631400 23                 EPPR1   1
        22 003267   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003270   000000 011000                    NOP     0

  13217 22 003271   000002 236000 18                 LDQ     ILS_+2
        22 003272   000022 736000                    QLS     18
        22 003273   000001 036000 18                 ADLQ    ILS_+1
        22 003274   000065 470400 0                  LDP0    TEMP_ILS$
        22 003275   000002 756100                    STQ     2,,PR0

  13218 22 003276   000002 235000 18                 LDA     ILS_+2
        22 003277   000005 035007                    ADLA    5,DL
        22 003300   000002 755000 18                 STA     ILS_+2

  13219 22 003301   000002 471500                    LDP1    2,,PR0
        22 003302   000742 220003                    LDX0    482,DU
        22 003303   100000 740100                    STX0    0,,PR1

  13220 22 003304   000002 471500                    LDP1    2,,PR0
        22 003305   000000 236000 23                 LDQ     0
        22 003306   100002 756100                    STQ     2,,PR1

      858    13224                   %NEXT_ILS (POINTER=TEMP_ILS$) ;

  13226 22 003307   000002 236100                    LDQ     2,,PR0
        22 003310   000065 756000 0                  STQ     TEMP_ILS$

      859    13229    4              TEMP_ILS$ -> ILS.DEF = ADDR (NIL) ;

  13229 22 003311   000000 236000 23                 LDQ     0
        22 003312   000065 470400 0                  LDP0    TEMP_ILS$
        22 003313   000004 756100                    STQ     4,,PR0

      860    13230                   %RESERVE_ILL (ITEM=%DEFLB, POINTER=TEMP_ILS$->ILS.ILL$) ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:153  
  13232 22 003314   000120 235000 xsym               LDA     ILL_STEP+80
        22 003315   000000 755000 1                  STA     ITERATION

  13233 22 003316   000002 236000 16                 LDQ     ILL_+2
        22 003317   000000 036000 1                  ADLQ    ITERATION
        22 003320   000003 116000 16                 CMPQ    ILL_+3
        22 003321   003332 604000 22                 TMI     s:13235

  13234 22 003322   000003 236000 23                 LDQ     3
        22 003323   000074 756000 0                  STQ     @INTDEF$$+1
        22 003324   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 003325   000075 451400 0                  STP1    @INTDEF$$+2
        22 003326   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003327   000001 631400 23                 EPPR1   1
        22 003330   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003331   000000 011000                    NOP     0

  13235 22 003332   000002 236000 16                 LDQ     ILL_+2
        22 003333   000022 736000                    QLS     18
        22 003334   000001 036000 16                 ADLQ    ILL_+1
        22 003335   000065 470400 0                  LDP0    TEMP_ILS$
        22 003336   000003 756100                    STQ     3,,PR0

  13236 22 003337   000002 236000 16                 LDQ     ILL_+2
        22 003340   000000 036000 1                  ADLQ    ITERATION
        22 003341   000002 756000 16                 STQ     ILL_+2

  13237 22 003342   000003 471500                    LDP1    3,,PR0
        22 003343   000346 220003                    LDX0    230,DU
        22 003344   100000 740100                    STX0    0,,PR1

      861    13240    4              CALL Z8AT$CREATE_TEMPORARY (%PARA, TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP) ;

  13240 22 003345   000003 471500                    LDP1    3,,PR0
        22 003346   100001 633500                    EPPR3   1,,PR1
        22 003347   000075 453400 0                  STP3    @INTDEF$$+2
        22 003350   000006 236000 23                 LDQ     6
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:154  
        22 003351   000074 756000 0                  STQ     @INTDEF$$+1
        22 003352   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 003353   000004 631400 23                 EPPR1   4
        22 003354   000000 701000 xent               TSX1    Z8AT$CREATE_TEMPORARY
        22 003355   000000 011000                    NOP     0

      862    13241    4              TEMP_ILS$ -> ILS.ILL$ -> ILL.LBL = ADDR (NIL) ;

  13241 22 003356   000065 470400 0                  LDP0    TEMP_ILS$
        22 003357   000003 471500                    LDP1    3,,PR0
        22 003360   000000 236000 23                 LDQ     0
        22 003361   100002 756100                    STQ     2,,PR1

      863    13242    4              TEMP_ILS$ -> ILS.NEXT = TEMP$ ;

  13242 22 003362   000031 236000 0                  LDQ     TEMP$
        22 003363   000002 756100                    STQ     2,,PR0

      864    13243    4              GO_ILS$ -> ILS.ILL$ -> ILL.LOP = TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ;

  13243 22 003364   000063 471400 0                  LDP1    GO_ILS$
        22 003365   100003 473500                    LDP3    3,,PR1
        22 003366   000003 474500                    LDP4    3,,PR0
        22 003367   400001 236100                    LDQ     1,,PR4
        22 003370   300001 756100                    STQ     1,,PR3

      865    13244    4            END ;

  13244 22 003371   003376 710000 22                 TRA     s:13249

      866    13245    3            ELSE
      867    13246    3              GO_ILS$ -> ILS.ILL$ -> ILL.LOP = ILS$ -> ILS.ILL$ -> ILL.LOP ;

  13246 22 003372   000000 474400 17                 LDP4    ILS$
        22 003373   400003 475500                    LDP5    3,,PR4
        22 003374   500001 236100                    LDQ     1,,PR5
        22 003375   300001 756100                    STQ     1,,PR3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:155  

      868    13247                   /* If "GO TO." (no destination specified) then set initial
      869    13248                      destination to the label before the GOTO. */
      870    13249    4            IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV OR COMCOM.OB.FIPS.OBS THEN DO ;

  13249 22 003376   000036 720000 xsym               LXL0    COMCOM+30
        22 003377   000002 100003                    CMPX0   2,DU
        22 003400   003403 605000 22                 TPL     s:13252
        22 003401   000036 234000 xsym               SZN     COMCOM+30
        22 003402   003452 605000 22                 TPL     s:13271

      871    13250                   %FIND_LINE_NO (@START_ITEM$=GO_ILS$) ;

  13252 22 003403   000063 236000 0                  LDQ     GO_ILS$
        22 003404   000004 756000 12                 STQ     O2COM+4

  13253 22 003405   000004 470400 12                 LDP0    O2COM+4
        22 003406   000003 473500                    LDP3    3,,PR0
        22 003407   300000 221100                    LDX1    0,,PR3
        22 003410   000373 101003                    CMPX1   251,DU
        22 003411   003425 600000 22                 TZE     s:13262

  13257 22 003412   000004 470400 12                 LDP0    O2COM+4
        22 003413   000002 236100                    LDQ     2,,PR0
        22 003414   000004 756000 12                 STQ     O2COM+4

  13260 22 003415   000004 470400 12                 LDP0    O2COM+4
        22 003416   000003 236100                    LDQ     3,,PR0
        22 003417   000000 116000 23                 CMPQ    0
        22 003420   003412 600000 22                 TZE     s:13257

  13261 22 003421   000003 471500                    LDP1    3,,PR0
        22 003422   100000 220100                    LDX0    0,,PR1
        22 003423   000373 100003                    CMPX0   251,DU
        22 003424   003412 601000 22                 TNZ     s:13257

  13262 22 003425   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:156  
        22 003426   100000 236100                    LDQ     0,,PR1
        22 003427   777777 376007                    ANQ     -1,DL
        22 003430   000133 756000 xsym               STQ     COMCOM+91

  13263 22 003431   000003 471500                    LDP1    3,,PR0
        22 003432   100002 236100                    LDQ     2,,PR1
        22 003433   777777 376007                    ANQ     -1,DL
        22 003434   000134 756000 xsym               STQ     COMCOM+92

      872    13266    4              IF COMCOM.OB.FIPS.LEVEL >= %INT_LEV THEN

  13266 22 003435   000036 720000 xsym               LXL0    COMCOM+30
        22 003436   000002 100003                    CMPX0   2,DU
        22 003437   003444 604000 22                 TMI     s:13268

      873    13267    4                CALL Z8AE$ERROR (%E$LEVEL_CHECK) ;

  13267 22 003440   000037 630400 23                 EPPR0   31
        22 003441   000001 631400 23                 EPPR1   1
        22 003442   000000 701000 xent               TSX1    Z8AE$ERROR
        22 003443   000000 011000                    NOP     0

      874    13268    4              IF COMCOM.OB.FIPS.OBS THEN

  13268 22 003444   000036 234000 xsym               SZN     COMCOM+30
        22 003445   003452 605000 22                 TPL     s:13271

      875    13269    4                CALL Z8AE$ERROR (%E$OBSOLETE) ;

  13269 22 003446   000041 630400 23                 EPPR0   33
        22 003447   000001 631400 23                 EPPR1   1
        22 003450   000000 701000 xent               TSX1    Z8AE$ERROR
        22 003451   000000 011000                    NOP     0

      876    13270    4            END ;

      877    13271    3            ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.B.GOTO_LABEL = TRUE ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:157  

  13271 22 003452   000000 470400 17                 LDP0    ILS$
        22 003453   000003 471500                    LDP1    3,,PR0
        22 003454   100001 473500                    LDP3    1,,PR1
        22 003455   040000 236003                    LDQ     16384,DU
        22 003456   300003 256100                    ORSQ    3,,PR3

      878    13272    3          END ;

      879    13273               /* The new %POINTER needs a %PRESET. */
      880    13274    2          CALL RESERVE_PRESET_ITEM(ALTER_ILS$ -> ILS.NEXT, GO_ILS$ -> ILS.ILL$ -> ILL.
             13274                   LOP,

  13274 22 003457   000063 470400 0                  LDP0    GO_ILS$
        22 003460   000003 471500                    LDP1    3,,PR0
        22 003461   000042 236000 23                 LDQ     34
        22 003462   000045 756000 0                  STQ     @POINTER$
        22 003463   100001 633500                    EPPR3   1,,PR1
        22 003464   000044 453400 0                  STP3    @ALTER_LBL$
        22 003465   000064 236000 0                  LDQ     ALTER_ILS$
        22 003466   000002 036003                    ADLQ    2,DU
        22 003467   000043 756000 0                  STQ     @PREV_ENTRY$
        22 003470   000002 701000 22                 TSX1    RESERVE_PRESET_ITEM
        22 003471   000000 011000                    NOP     0

      881    13275    2                                   LABEL_REFERENCE$) ;
      882    13276    3          IF INIT_LINOI$ ~= ADDR (NIL) THEN DO ;

  13276 22 003472   000030 236000 0                  LDQ     INIT_LINOI$
        22 003473   000000 116000 23                 CMPQ    0
        22 003474   003705 600000 22                 TZE     s:13362

      883    13277                 /* The INIT proc needs to initialize the %POINTER, too. */
      884    13278                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$) ;

  13298 22 003475   000002 236000 18                 LDQ     ILS_+2
        22 003476   000004 036007                    ADLQ    4,DL
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:158  
        22 003477   000003 116000 18                 CMPQ    ILS_+3
        22 003500   003511 602000 22                 TNC     s:13300

  13299 22 003501   000002 236000 23                 LDQ     2
        22 003502   000074 756000 0                  STQ     @INTDEF$$+1
        22 003503   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 003504   000075 450400 0                  STP0    @INTDEF$$+2
        22 003505   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003506   000001 631400 23                 EPPR1   1
        22 003507   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003510   000000 011000                    NOP     0

  13300 22 003511   000002 236000 18                 LDQ     ILS_+2
        22 003512   000022 736000                    QLS     18
        22 003513   000001 036000 18                 ADLQ    ILS_+1
        22 003514   000031 756000 0                  STQ     TEMP$

  13301 22 003515   000002 235000 18                 LDA     ILS_+2
        22 003516   000004 035007                    ADLA    4,DL
        22 003517   000002 755000 18                 STA     ILS_+2

  13302 22 003520   000740 220003                    LDX0    480,DU
        22 003521   000031 470400 0                  LDP0    TEMP$
        22 003522   000000 740100                    STX0    0,,PR0

  13303 22 003523   000000 236000 23                 LDQ     0
        22 003524   000031 470400 0                  LDP0    TEMP$
        22 003525   000002 756100                    STQ     2,,PR0

      885    13307                 %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP$ -> ILS.ILL$) ;

  13309 22 003526   000145 235000 xsym               LDA     ILL_STEP+101
        22 003527   000000 755000 1                  STA     ITERATION

  13310 22 003530   000002 236000 16                 LDQ     ILL_+2
        22 003531   000000 036000 1                  ADLQ    ITERATION
        22 003532   000003 116000 16                 CMPQ    ILL_+3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:159  
        22 003533   003544 604000 22                 TMI     s:13312

  13311 22 003534   000003 236000 23                 LDQ     3
        22 003535   000074 756000 0                  STQ     @INTDEF$$+1
        22 003536   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 003537   000075 450400 0                  STP0    @INTDEF$$+2
        22 003540   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003541   000001 631400 23                 EPPR1   1
        22 003542   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003543   000000 011000                    NOP     0

  13312 22 003544   000002 236000 16                 LDQ     ILL_+2
        22 003545   000022 736000                    QLS     18
        22 003546   000001 036000 16                 ADLQ    ILL_+1
        22 003547   000031 470400 0                  LDP0    TEMP$
        22 003550   000003 756100                    STQ     3,,PR0

  13313 22 003551   000002 236000 16                 LDQ     ILL_+2
        22 003552   000000 036000 1                  ADLQ    ITERATION
        22 003553   000002 756000 16                 STQ     ILL_+2

  13314 22 003554   000031 470400 0                  LDP0    TEMP$
        22 003555   000003 471500                    LDP1    3,,PR0
        22 003556   000373 220003                    LDX0    251,DU
        22 003557   100000 740100                    STX0    0,,PR1

      886    13317    3            TEMP$ -> ILS.ILL$ -> LINOI = INIT_LINOI$ -> ILS.ILL$ -> LINOI ;

  13317 22 003560   000031 470400 0                  LDP0    TEMP$
        22 003561   000003 471500                    LDP1    3,,PR0
        22 003562   000030 473400 0                  LDP3    INIT_LINOI$
        22 003563   300003 474500                    LDP4    3,,PR3
        22 003564   000100 100500                    MLR     fill='000'O
        22 003565   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        22 003566   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      887    13318                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP$ -> ILS.NEXT) ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:160  

  13338 22 003567   000002 236000 18                 LDQ     ILS_+2
        22 003570   000004 036007                    ADLQ    4,DL
        22 003571   000003 116000 18                 CMPQ    ILS_+3
        22 003572   003603 602000 22                 TNC     s:13340

  13339 22 003573   000002 236000 23                 LDQ     2
        22 003574   000074 756000 0                  STQ     @INTDEF$$+1
        22 003575   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 003576   000075 450400 0                  STP0    @INTDEF$$+2
        22 003577   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003600   000001 631400 23                 EPPR1   1
        22 003601   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003602   000000 011000                    NOP     0

  13340 22 003603   000002 236000 18                 LDQ     ILS_+2
        22 003604   000022 736000                    QLS     18
        22 003605   000001 036000 18                 ADLQ    ILS_+1
        22 003606   000031 470400 0                  LDP0    TEMP$
        22 003607   000002 756100                    STQ     2,,PR0

  13341 22 003610   000002 235000 18                 LDA     ILS_+2
        22 003611   000004 035007                    ADLA    4,DL
        22 003612   000002 755000 18                 STA     ILS_+2

  13342 22 003613   000031 470400 0                  LDP0    TEMP$
        22 003614   000002 471500                    LDP1    2,,PR0
        22 003615   000740 220003                    LDX0    480,DU
        22 003616   100000 740100                    STX0    0,,PR1

  13343 22 003617   000031 470400 0                  LDP0    TEMP$
        22 003620   000002 471500                    LDP1    2,,PR0
        22 003621   000000 236000 23                 LDQ     0
        22 003622   100002 756100                    STQ     2,,PR1

      888    13347                 %RESERVE_ILL (ITEM=%ALTER, POINTER=TEMP$ -> ILS.NEXT->ILS.ILL$) ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:161  
  13349 22 003623   000164 235000 xsym               LDA     ILL_STEP+116
        22 003624   000000 755000 1                  STA     ITERATION

  13350 22 003625   000002 236000 16                 LDQ     ILL_+2
        22 003626   000000 036000 1                  ADLQ    ITERATION
        22 003627   000003 116000 16                 CMPQ    ILL_+3
        22 003630   003641 604000 22                 TMI     s:13352

  13351 22 003631   000003 236000 23                 LDQ     3
        22 003632   000074 756000 0                  STQ     @INTDEF$$+1
        22 003633   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 003634   000075 450400 0                  STP0    @INTDEF$$+2
        22 003635   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 003636   000001 631400 23                 EPPR1   1
        22 003637   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 003640   000000 011000                    NOP     0

  13352 22 003641   000031 470400 0                  LDP0    TEMP$
        22 003642   000002 471500                    LDP1    2,,PR0
        22 003643   000002 236000 16                 LDQ     ILL_+2
        22 003644   000022 736000                    QLS     18
        22 003645   000001 036000 16                 ADLQ    ILL_+1
        22 003646   100003 756100                    STQ     3,,PR1

  13353 22 003647   000002 236000 16                 LDQ     ILL_+2
        22 003650   000000 036000 1                  ADLQ    ITERATION
        22 003651   000002 756000 16                 STQ     ILL_+2

  13354 22 003652   000031 470400 0                  LDP0    TEMP$
        22 003653   000002 471500                    LDP1    2,,PR0
        22 003654   100003 473500                    LDP3    3,,PR1
        22 003655   000412 220003                    LDX0    266,DU
        22 003656   300000 740100                    STX0    0,,PR3

      889    13357    3            TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP = ILL$ -> ILL.LOP;

  13357 22 003657   000031 470400 0                  LDP0    TEMP$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:162  
        22 003660   000002 471500                    LDP1    2,,PR0
        22 003661   100003 473500                    LDP3    3,,PR1
        22 003662   000000 474400 15                 LDP4    ILL$
        22 003663   400001 236100                    LDQ     1,,PR4
        22 003664   300001 756100                    STQ     1,,PR3

      890    13358    3            TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP = GO_ILS$ -> ILS.ILL$ -> ILL.LOP ;

  13358 22 003665   000031 470400 0                  LDP0    TEMP$
        22 003666   000002 471500                    LDP1    2,,PR0
        22 003667   100003 473500                    LDP3    3,,PR1
        22 003670   000063 475400 0                  LDP5    GO_ILS$
        22 003671   500003 476500                    LDP6    3,,PR5
        22 003672   600001 236100                    LDQ     1,,PR6
        22 003673   300002 756100                    STQ     2,,PR3

      891    13359    3            TEMP$ -> ILS.NEXT->ILS.NEXT = INIT_LINOI$ -> ILS.NEXT->ILS.NEXT ;

  13359 22 003674   000031 470400 0                  LDP0    TEMP$
        22 003675   000002 471500                    LDP1    2,,PR0
        22 003676   000030 473400 0                  LDP3    INIT_LINOI$
        22 003677   300002 476500                    LDP6    2,,PR3
        22 003700   600002 236100                    LDQ     2,,PR6
        22 003701   100002 756100                    STQ     2,,PR1

      892    13360    3            INIT_LINOI$ -> ILS.NEXT->ILS.NEXT = TEMP$ ;

  13360 22 003702   300002 470500                    LDP0    2,,PR3
        22 003703   000031 236000 0                  LDQ     TEMP$
        22 003704   000002 756100                    STQ     2,,PR0

      893    13361    3          END ;

      894    13362    2          TEMP_ILS$ = ILS$ ;

  13362 22 003705   000000 236000 17                 LDQ     ILS$
        22 003706   000065 756000 0                  STQ     TEMP_ILS$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:163  

      895    13363    2          ILS$ = ALTER_ILS$ ;

  13363 22 003707   000064 236000 0                  LDQ     ALTER_ILS$
        22 003710   000000 756000 17                 STQ     ILS$

      896    13364               %NEXT_NON_LINOI ;

  13369 22 003711   000000 470400 17                 LDP0    ILS$
        22 003712   000002 236100                    LDQ     2,,PR0
        22 003713   000000 756000 17                 STQ     ILS$

  13372 22 003714   000000 470400 17                 LDP0    ILS$
        22 003715   000003 236100                    LDQ     3,,PR0
        22 003716   000000 116000 23                 CMPQ    0
        22 003717   003711 600000 22                 TZE     s:13369
        22 003720   000003 471500                    LDP1    3,,PR0
        22 003721   100000 220100                    LDX0    0,,PR1
        22 003722   000373 100003                    CMPX0   251,DU
        22 003723   003711 600000 22                 TZE     s:13369

      897    13374    2          ALTER_ILS$ = TEMP$;

  13374 22 003724   000031 236000 0                  LDQ     TEMP$
        22 003725   000064 756000 0                  STQ     ALTER_ILS$

      898    13375    2          IF ILS$ -> ILS.ILL$ -> ILL.ID = %PRESET AND

  13375 22 003726   000422 100003                    CMPX0   274,DU
        22 003727   003767 601000 22                 TNZ     s:13384
        22 003730   100002 473500                    LDP3    2,,PR1
        22 003731   300000 221100                    LDX1    0,,PR3
        22 003732   001046 101003                    CMPX1   550,DU
        22 003733   003767 601000 22                 TNZ     s:13384

      899    13376    3            ILS$ -> ILS.ILL$ -> ILL.ROP -> DNT.ID = %LEXEME THEN DO ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:164  
      900    13377    3            CALL REFERENCE_RESOLUTION (ADDR (ILS$ -> ILS.ILL$ -> ILL.ROP), FALSE) ;

  13377 22 003734   100002 634500                    EPPR4   2,,PR1
        22 003735   000102 454400 0                  STP4    @INTDEF$$+7
        22 003736   000034 236000 23                 LDQ     28
        22 003737   000056 756000 0                  STQ     @GOTO_DEST
        22 003740   000102 631400 0                  EPPR1   @INTDEF$$+7
        22 003741   000055 451400 0                  STP1    @REF_PTR$
        22 003742   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 003743   000000 011000                    NOP     0

      901    13378    3            IF ILS$ -> ILS.ILL$ -> ILL.ROP = ADDR (NIL) THEN /* Don't PRESET to nil */

  13378 22 003744   000000 470400 17                 LDP0    ILS$
        22 003745   000003 471500                    LDP1    3,,PR0
        22 003746   100002 236100                    LDQ     2,,PR1
        22 003747   000000 116000 23                 CMPQ    0
        22 003750   003755 601000 22                 TNZ     s:13380

      902    13379    3              ILS$ -> ILS.ILL$ -> ILL.ROP = TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ;

  13379 22 003751   000065 473400 0                  LDP3    TEMP_ILS$
        22 003752   300003 474500                    LDP4    3,,PR3
        22 003753   400001 236100                    LDQ     1,,PR4
        22 003754   100002 756100                    STQ     2,,PR1

      903    13380    3            IF INIT_LINOI$ ~= ADDR(NIL) THEN

  13380 22 003755   000030 236000 0                  LDQ     INIT_LINOI$
        22 003756   000000 116000 23                 CMPQ    0
        22 003757   004027 600000 22                 TZE     s:13395

      904    13381    3              ALTER_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP =

  13381 22 003760   000064 471400 0                  LDP1    ALTER_ILS$
        22 003761   100002 473500                    LDP3    2,,PR1
        22 003762   300003 474500                    LDP4    3,,PR3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:165  
        22 003763   000003 475500                    LDP5    3,,PR0
        22 003764   500002 236100                    LDQ     2,,PR5
        22 003765   400002 756100                    STQ     2,,PR4

      905    13382    3                  ILS$ -> ILS.ILL$ -> ILL.ROP;
      906    13383    3          END ;

  13383 22 003766   004027 710000 22                 TRA     s:13395

      907    13384    2          ELSE IF ILS$ -> ILS.ILL$ -> ILL.ID = %P_A_PRESET AND

  13384 22 003767   000446 100003                    CMPX0   294,DU
        22 003770   004027 601000 22                 TNZ     s:13395
        22 003771   100001 473500                    LDP3    1,,PR1
        22 003772   300000 221100                    LDX1    0,,PR3
        22 003773   001046 101003                    CMPX1   550,DU
        22 003774   004027 601000 22                 TNZ     s:13395

      908    13385    3            ILS$ -> ILS.ILL$ -> ILL.LOP -> DNT.ID = %LEXEME THEN DO ;

      909    13386    3            CALL REFERENCE_RESOLUTION (ADDR (ILS$ -> ILS.ILL$ -> ILL.LOP), FALSE) ;

  13386 22 003775   100001 634500                    EPPR4   1,,PR1
        22 003776   000103 454400 0                  STP4    @INTDEF$$+8
        22 003777   000034 236000 23                 LDQ     28
        22 004000   000056 756000 0                  STQ     @GOTO_DEST
        22 004001   000103 631400 0                  EPPR1   @INTDEF$$+8
        22 004002   000055 451400 0                  STP1    @REF_PTR$
        22 004003   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 004004   000000 011000                    NOP     0

      910    13387    3            IF ILS$ -> ILS.ILL$ -> ILL.LOP = ADDR (NIL) THEN /* Don't PRESET to nil */

  13387 22 004005   000000 470400 17                 LDP0    ILS$
        22 004006   000003 471500                    LDP1    3,,PR0
        22 004007   100001 236100                    LDQ     1,,PR1
        22 004010   000000 116000 23                 CMPQ    0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:166  
        22 004011   004016 601000 22                 TNZ     s:13389

      911    13388    3              ILS$ -> ILS.ILL$ -> ILL.LOP = TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ;

  13388 22 004012   000065 473400 0                  LDP3    TEMP_ILS$
        22 004013   300003 474500                    LDP4    3,,PR3
        22 004014   400001 236100                    LDQ     1,,PR4
        22 004015   100001 756100                    STQ     1,,PR1

      912    13389    3            IF INIT_LINOI$ ~= ADDR(NIL) THEN

  13389 22 004016   000030 236000 0                  LDQ     INIT_LINOI$
        22 004017   000000 116000 23                 CMPQ    0
        22 004020   004027 600000 22                 TZE     s:13395

      913    13390    3              ALTER_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP =

  13390 22 004021   000064 471400 0                  LDP1    ALTER_ILS$
        22 004022   100002 473500                    LDP3    2,,PR1
        22 004023   300003 474500                    LDP4    3,,PR3
        22 004024   000003 475500                    LDP5    3,,PR0
        22 004025   500001 236100                    LDQ     1,,PR5
        22 004026   400002 756100                    STQ     2,,PR4

      914    13391    3                  ILS$ -> ILS.ILL$ -> ILL.LOP;
      915    13392    3          END ;

      916    13393                /* This is in case the GO item has not yet been processed, in which
      917    13394                   case ILL.LOP of the GO item points to DNT instead of ST. */
      918    13395    2          ALTER_ILS$ = ILS$;

  13395 22 004027   000000 236000 17                 LDQ     ILS$
        22 004030   000064 756000 0                  STQ     ALTER_ILS$

      919    13396    2          ILS$ = TEMP_ILS$ ;

  13396 22 004031   000065 236000 0                  LDQ     TEMP_ILS$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:167  
        22 004032   000000 756000 17                 STQ     ILS$

      920    13397
      921    13398    2          IF COMCOM.SEGMENTC <= 1 THEN

  13398 22 004033   000314 235000 xsym               LDA     COMCOM+204
        22 004034   000001 115007                    CMPA    1,DL
        22 004035   004040 605400 22                 TPNZ    s:13407

      922    13399    2            RETURN;

  13399 22 004036   000062 221200 0                  LDX1  ! ITEM_NOT_ETT+1
        22 004037   000001 702211                    TSX2  ! 1,X1

      923    13400
      924    13401         /*
      925    13402            The alter switches in the independent segment need to be reset
      926    13403            each time that segment is brought in, the ILS and ILL items
      927    13404            that will refresh the switch are created and saved on the LTS item
      928    13405            of this segment.
      929    13406         */
      930    13407    2        IF ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND

  13407 22 004040   000000 470400 15                 LDP0    ILL$
        22 004041   000001 471500                    LDP1    1,,PR0
        22 004042   100007 236100                    LDQ     7,,PR1
        22 004043   000000 116000 23                 CMPQ    0
        22 004044   004456 600000 22                 TZE     s:13584
        22 004045   100007 473500                    LDP3    7,,PR1
        22 004046   300007 236100                    LDQ     7,,PR3
        22 004047   000000 116000 23                 CMPQ    0
        22 004050   004456 600000 22                 TZE     s:13584
        22 004051   300007 474500                    LDP4    7,,PR3
        22 004052   400002 235100                    LDA     2,,PR4
        22 004053   000061 115007                    CMPA    49,DL
        22 004054   004456 604400 22                 TMOZ    s:13584

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:168  
      931    13408    2           ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ~= ADDR(NIL) AND
      932    13409    2           ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      933    13410    2           SEGMENT_LTS.SEGMENT_NO# > %MAX_FIXED_SEG# THEN
      934    13411    3         DO;

      935    13412
      936    13413                 %FIND_LINE_NO (@START_ITEM$ = ILL$ -> ILL.LOP -> LABEL.PREV_ILS$);

  13415 22 004055   100010 236100                    LDQ     8,,PR1
        22 004056   000004 756000 12                 STQ     O2COM+4

  13416 22 004057   000004 471400 12                 LDP1    O2COM+4
        22 004060   100003 473500                    LDP3    3,,PR1
        22 004061   300000 220100                    LDX0    0,,PR3
        22 004062   000373 100003                    CMPX0   251,DU
        22 004063   004077 600000 22                 TZE     s:13425

  13420 22 004064   000004 470400 12                 LDP0    O2COM+4
        22 004065   000002 236100                    LDQ     2,,PR0
        22 004066   000004 756000 12                 STQ     O2COM+4

  13423 22 004067   000004 470400 12                 LDP0    O2COM+4
        22 004070   000003 236100                    LDQ     3,,PR0
        22 004071   000000 116000 23                 CMPQ    0
        22 004072   004064 600000 22                 TZE     s:13420

  13424 22 004073   000003 471500                    LDP1    3,,PR0
        22 004074   100000 220100                    LDX0    0,,PR1
        22 004075   000373 100003                    CMPX0   251,DU
        22 004076   004064 601000 22                 TNZ     s:13420

  13425 22 004077   000004 470400 12                 LDP0    O2COM+4
        22 004100   000003 471500                    LDP1    3,,PR0
        22 004101   100000 236100                    LDQ     0,,PR1
        22 004102   777777 376007                    ANQ     -1,DL
        22 004103   000133 756000 xsym               STQ     COMCOM+91

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:169  
  13426 22 004104   000003 471500                    LDP1    3,,PR0
        22 004105   100002 236100                    LDQ     2,,PR1
        22 004106   777777 376007                    ANQ     -1,DL
        22 004107   000134 756000 xsym               STQ     COMCOM+92

      937    13429                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP_ILS$) ;

  13449 22 004110   000002 236000 18                 LDQ     ILS_+2
        22 004111   000004 036007                    ADLQ    4,DL
        22 004112   000003 116000 18                 CMPQ    ILS_+3
        22 004113   004124 602000 22                 TNC     s:13451

  13450 22 004114   000002 236000 23                 LDQ     2
        22 004115   000074 756000 0                  STQ     @INTDEF$$+1
        22 004116   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 004117   000075 451400 0                  STP1    @INTDEF$$+2
        22 004120   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004121   000001 631400 23                 EPPR1   1
        22 004122   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004123   000000 011000                    NOP     0

  13451 22 004124   000002 236000 18                 LDQ     ILS_+2
        22 004125   000022 736000                    QLS     18
        22 004126   000001 036000 18                 ADLQ    ILS_+1
        22 004127   000065 756000 0                  STQ     TEMP_ILS$

  13452 22 004130   000002 235000 18                 LDA     ILS_+2
        22 004131   000004 035007                    ADLA    4,DL
        22 004132   000002 755000 18                 STA     ILS_+2

  13453 22 004133   000740 220003                    LDX0    480,DU
        22 004134   000065 470400 0                  LDP0    TEMP_ILS$
        22 004135   000000 740100                    STX0    0,,PR0

  13454 22 004136   000000 236000 23                 LDQ     0
        22 004137   000002 756100                    STQ     2,,PR0

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:170  
      938    13458                 %RESERVE_ILL (ITEM=%LINOI, POINTER=TEMP_ILS$ -> ILS.ILL$) ;

  13460 22 004140   000145 235000 xsym               LDA     ILL_STEP+101
        22 004141   000000 755000 1                  STA     ITERATION

  13461 22 004142   000002 236000 16                 LDQ     ILL_+2
        22 004143   000000 036000 1                  ADLQ    ITERATION
        22 004144   000003 116000 16                 CMPQ    ILL_+3
        22 004145   004156 604000 22                 TMI     s:13463

  13462 22 004146   000003 236000 23                 LDQ     3
        22 004147   000074 756000 0                  STQ     @INTDEF$$+1
        22 004150   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 004151   000075 451400 0                  STP1    @INTDEF$$+2
        22 004152   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004153   000001 631400 23                 EPPR1   1
        22 004154   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004155   000000 011000                    NOP     0

  13463 22 004156   000002 236000 16                 LDQ     ILL_+2
        22 004157   000022 736000                    QLS     18
        22 004160   000001 036000 16                 ADLQ    ILL_+1
        22 004161   000065 470400 0                  LDP0    TEMP_ILS$
        22 004162   000003 756100                    STQ     3,,PR0

  13464 22 004163   000002 236000 16                 LDQ     ILL_+2
        22 004164   000000 036000 1                  ADLQ    ITERATION
        22 004165   000002 756000 16                 STQ     ILL_+2

  13465 22 004166   000003 471500                    LDP1    3,,PR0
        22 004167   000373 220003                    LDX0    251,DU
        22 004170   100000 740100                    STX0    0,,PR1

      939    13468
      940    13469    3            TEMP_ILS$ -> ILS.ILL$ -> LINOI = O2COM.LINE_NO$ -> ILS.ILL$ -> LINOI;

  13469 22 004171   000003 471500                    LDP1    3,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:171  
        22 004172   000004 473400 12                 LDP3    O2COM+4
        22 004173   300003 474500                    LDP4    3,,PR3
        22 004174   000100 100500                    MLR     fill='000'O
        22 004175   400000 000014                    ADSC9   0,,PR4                   cn=0,n=12
        22 004176   100000 000014                    ADSC9   0,,PR1                   cn=0,n=12

      941    13470
      942    13471                 %RESERVE_ILS (ITEM=%OPN, POINTER=TEMP_ILS$ -> ILS.NEXT) ;

  13491 22 004177   000002 236000 18                 LDQ     ILS_+2
        22 004200   000004 036007                    ADLQ    4,DL
        22 004201   000003 116000 18                 CMPQ    ILS_+3
        22 004202   004213 602000 22                 TNC     s:13493

  13492 22 004203   000002 236000 23                 LDQ     2
        22 004204   000074 756000 0                  STQ     @INTDEF$$+1
        22 004205   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 004206   000075 451400 0                  STP1    @INTDEF$$+2
        22 004207   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004210   000001 631400 23                 EPPR1   1
        22 004211   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004212   000000 011000                    NOP     0

  13493 22 004213   000002 236000 18                 LDQ     ILS_+2
        22 004214   000022 736000                    QLS     18
        22 004215   000001 036000 18                 ADLQ    ILS_+1
        22 004216   000065 470400 0                  LDP0    TEMP_ILS$
        22 004217   000002 756100                    STQ     2,,PR0

  13494 22 004220   000002 235000 18                 LDA     ILS_+2
        22 004221   000004 035007                    ADLA    4,DL
        22 004222   000002 755000 18                 STA     ILS_+2

  13495 22 004223   000002 471500                    LDP1    2,,PR0
        22 004224   000740 220003                    LDX0    480,DU
        22 004225   100000 740100                    STX0    0,,PR1

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:172  
  13496 22 004226   000002 471500                    LDP1    2,,PR0
        22 004227   000000 236000 23                 LDQ     0
        22 004230   100002 756100                    STQ     2,,PR1

      943    13500                 %RESERVE_ILL (ITEM=%ALTER, POINTER=TEMP_ILS$ -> ILS.NEXT->ILS.ILL$) ;

  13502 22 004231   000164 235000 xsym               LDA     ILL_STEP+116
        22 004232   000000 755000 1                  STA     ITERATION

  13503 22 004233   000002 236000 16                 LDQ     ILL_+2
        22 004234   000000 036000 1                  ADLQ    ITERATION
        22 004235   000003 116000 16                 CMPQ    ILL_+3
        22 004236   004247 604000 22                 TMI     s:13505

  13504 22 004237   000003 236000 23                 LDQ     3
        22 004240   000074 756000 0                  STQ     @INTDEF$$+1
        22 004241   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 004242   000075 451400 0                  STP1    @INTDEF$$+2
        22 004243   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004244   000001 631400 23                 EPPR1   1
        22 004245   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004246   000000 011000                    NOP     0

  13505 22 004247   000065 470400 0                  LDP0    TEMP_ILS$
        22 004250   000002 471500                    LDP1    2,,PR0
        22 004251   000002 236000 16                 LDQ     ILL_+2
        22 004252   000022 736000                    QLS     18
        22 004253   000001 036000 16                 ADLQ    ILL_+1
        22 004254   100003 756100                    STQ     3,,PR1

  13506 22 004255   000002 236000 16                 LDQ     ILL_+2
        22 004256   000000 036000 1                  ADLQ    ITERATION
        22 004257   000002 756000 16                 STQ     ILL_+2

  13507 22 004260   000002 471500                    LDP1    2,,PR0
        22 004261   100003 473500                    LDP3    3,,PR1
        22 004262   000412 220003                    LDX0    266,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:173  
        22 004263   300000 740100                    STX0    0,,PR3

      944    13510    3            TEMP_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP = ILL$ -> ILL.LOP;

  13510 22 004264   000002 471500                    LDP1    2,,PR0
        22 004265   100003 473500                    LDP3    3,,PR1
        22 004266   000000 474400 15                 LDP4    ILL$
        22 004267   400001 236100                    LDQ     1,,PR4
        22 004270   300001 756100                    STQ     1,,PR3

      945    13511    3           TEMP_ILS$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP = GO_ILS$ -> ILS.ILL$ -> ILL.LOP
             13511                     ;

  13511 22 004271   000002 471500                    LDP1    2,,PR0
        22 004272   100003 473500                    LDP3    3,,PR1
        22 004273   000063 475400 0                  LDP5    GO_ILS$
        22 004274   500003 476500                    LDP6    3,,PR5
        22 004275   600001 236100                    LDQ     1,,PR6
        22 004276   300002 756100                    STQ     2,,PR3

      946    13512    3            TEMP$ = TEMP_ILS$;

  13512 22 004277   000065 236000 0                  LDQ     TEMP_ILS$
        22 004300   000031 756000 0                  STQ     TEMP$

      947    13513
      948    13514                 %NEXT_ILS (POINTER=TEMP$);

  13516 22 004301   000031 471400 0                  LDP1    TEMP$
        22 004302   100002 236100                    LDQ     2,,PR1
        22 004303   000031 756000 0                  STQ     TEMP$

      949    13519                 %RESERVE_ILS (ITEM=%OPN, POINTER = TEMP$ -> ILS.NEXT);

  13539 22 004304   000002 236000 18                 LDQ     ILS_+2
        22 004305   000004 036007                    ADLQ    4,DL
        22 004306   000003 116000 18                 CMPQ    ILS_+3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:174  
        22 004307   004320 602000 22                 TNC     s:13541

  13540 22 004310   000002 236000 23                 LDQ     2
        22 004311   000074 756000 0                  STQ     @INTDEF$$+1
        22 004312   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 004313   000075 451400 0                  STP1    @INTDEF$$+2
        22 004314   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004315   000001 631400 23                 EPPR1   1
        22 004316   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004317   000000 011000                    NOP     0

  13541 22 004320   000002 236000 18                 LDQ     ILS_+2
        22 004321   000022 736000                    QLS     18
        22 004322   000001 036000 18                 ADLQ    ILS_+1
        22 004323   000031 470400 0                  LDP0    TEMP$
        22 004324   000002 756100                    STQ     2,,PR0

  13542 22 004325   000002 235000 18                 LDA     ILS_+2
        22 004326   000004 035007                    ADLA    4,DL
        22 004327   000002 755000 18                 STA     ILS_+2

  13543 22 004330   000031 470400 0                  LDP0    TEMP$
        22 004331   000002 471500                    LDP1    2,,PR0
        22 004332   000740 220003                    LDX0    480,DU
        22 004333   100000 740100                    STX0    0,,PR1

  13544 22 004334   000031 470400 0                  LDP0    TEMP$
        22 004335   000002 471500                    LDP1    2,,PR0
        22 004336   000000 236000 23                 LDQ     0
        22 004337   100002 756100                    STQ     2,,PR1

      950    13548                 %RESERVE_ILL (ITEM=%MVANO, POINTER = TEMP$ -> ILS.NEXT->ILS.ILL$);

  13550 22 004340   000027 235000 xsym               LDA     ILL_STEP+23
        22 004341   000000 755000 1                  STA     ITERATION

  13551 22 004342   000002 236000 16                 LDQ     ILL_+2
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:175  
        22 004343   000000 036000 1                  ADLQ    ITERATION
        22 004344   000003 116000 16                 CMPQ    ILL_+3
        22 004345   004356 604000 22                 TMI     s:13553

  13552 22 004346   000003 236000 23                 LDQ     3
        22 004347   000074 756000 0                  STQ     @INTDEF$$+1
        22 004350   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 004351   000075 450400 0                  STP0    @INTDEF$$+2
        22 004352   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004353   000001 631400 23                 EPPR1   1
        22 004354   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004355   000000 011000                    NOP     0

  13553 22 004356   000031 470400 0                  LDP0    TEMP$
        22 004357   000002 471500                    LDP1    2,,PR0
        22 004360   000002 236000 16                 LDQ     ILL_+2
        22 004361   000022 736000                    QLS     18
        22 004362   000001 036000 16                 ADLQ    ILL_+1
        22 004363   100003 756100                    STQ     3,,PR1

  13554 22 004364   000002 236000 16                 LDQ     ILL_+2
        22 004365   000000 036000 1                  ADLQ    ITERATION
        22 004366   000002 756000 16                 STQ     ILL_+2

  13555 22 004367   000031 470400 0                  LDP0    TEMP$
        22 004370   000002 471500                    LDP1    2,,PR0
        22 004371   100003 473500                    LDP3    3,,PR1
        22 004372   000255 220003                    LDX0    173,DU
        22 004373   300000 740100                    STX0    0,,PR3

      951    13558
      952    13559    3            TEMP$ -> ILS.NEXT-> ILS.ILL$ -> ILL.CODE = %MVANO_LOWER_TO_LOWER;

  13559 22 004374   000031 470400 0                  LDP0    TEMP$
        22 004375   000002 471500                    LDP1    2,,PR0
        22 004376   100003 473500                    LDP3    3,,PR1
        22 004377   000003 221003                    LDX1    3,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:176  
        22 004400   300000 441100                    SXL1    0,,PR3

      953    13560    3            MKCN.CON=ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->

  13560 22 004401   000000 470400 15                 LDP0    ILL$
        22 004402   000001 471500                    LDP1    1,,PR0
        22 004403   100007 473500                    LDP3    7,,PR1
        22 004404   300007 474500                    LDP4    7,,PR3
        22 004405   400002 235100                    LDA     2,,PR4
        22 004406   000000 755000 19                 STA     MKCN

      954    13561    3                     SEGMENT_LTS.SEGMENT_NO#;
      955    13562
      956    13563    3            CALL Z8AC$MAKE_CONST (TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.ROP);

  13563 22 004407   000031 475400 0                  LDP5    TEMP$
        22 004410   500002 476500                    LDP6    2,,PR5
        22 004411   600003 477500                    LDP7    3,,PR6
        22 004412   700002 630500                    EPPR0   2,,PR7
        22 004413   000074 450400 0                  STP0    @INTDEF$$+1
        22 004414   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 004415   000001 631400 23                 EPPR1   1
        22 004416   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        22 004417   000000 011000                    NOP     0

      957    13564
      958    13565    3            CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,

  13565 22 004420   000000 470400 15                 LDP0    ILL$
        22 004421   000001 471500                    LDP1    1,,PR0
        22 004422   000031 473400 0                  LDP3    TEMP$
        22 004423   300002 474500                    LDP4    2,,PR3
        22 004424   400003 475500                    LDP5    3,,PR4
        22 004425   000000 236000 23                 LDQ     0
        22 004426   000074 756000 0                  STQ     @INTDEF$$+1
        22 004427   500001 634500                    EPPR4   1,,PR5
        22 004430   000077 454400 0                  STP4    @INTDEF$$+4
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:177  
        22 004431   000074 635400 0                  EPPR5   @INTDEF$$+1
        22 004432   000076 455400 0                  STP5    @INTDEF$$+3
        22 004433   100005 636500                    EPPR6   5,,PR1
        22 004434   000075 456400 0                  STP6    @INTDEF$$+2
        22 004435   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004436   000043 631400 23                 EPPR1   35
        22 004437   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        22 004440   000000 011000                    NOP     0

      959    13566    3                                ADDR(NIL),
      960    13567    3                                TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.LOP);
      961    13568
      962    13569    3            TEMP$ -> ILS.NEXT->ILS.NEXT = ILL$ -> ILL.LOP -> LABEL.SECTION$ ->

  13569 22 004441   000031 470400 0                  LDP0    TEMP$
        22 004442   000002 471500                    LDP1    2,,PR0
        22 004443   000000 473400 15                 LDP3    ILL$
        22 004444   300001 474500                    LDP4    1,,PR3
        22 004445   400007 475500                    LDP5    7,,PR4
        22 004446   500007 476500                    LDP6    7,,PR5
        22 004447   600004 236100                    LDQ     4,,PR6
        22 004450   100002 756100                    STQ     2,,PR1

      963    13570    3                     SECTION.SEGMENT$ -> SEGMENT_LTS.ALTER_RESET$;
      964    13571    3            ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->

  13571 22 004451   300001 470500                    LDP0    1,,PR3
        22 004452   000007 471500                    LDP1    7,,PR0
        22 004453   100007 474500                    LDP4    7,,PR1
        22 004454   000065 236000 0                  LDQ     TEMP_ILS$
        22 004455   400004 756100                    STQ     4,,PR4

      965    13572    3                     SEGMENT_LTS.ALTER_RESET$ = TEMP_ILS$;
      966    13573
      967    13574    3          END;

      968    13575
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:178  
      969    13576         /*
      970    13577           For an altered GO TO item it might transfer the program control
      971    13578           to several different addresses, the labels in this ALTER statement
      972    13579           are checked and if any independent segment overlay might be
      973    13580           brought in, an ALTER_LTS item is created to save the independent
      974    13581           segment information and chained to the pointer st item's
      975    13582           LTS$ field for later process.
      976    13583         */
      977    13584    2          SEG_LTS$ = ADDR(NIL);

  13584 22 004456   000000 236000 23                 LDQ     0
        22 004457   000041 756000 0                  STQ     SEG_LTS$

      978    13585    2          IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN

  13585 22 004460   000063 470400 0                  LDP0    GO_ILS$
        22 004461   000003 471500                    LDP1    3,,PR0
        22 004462   100001 473500                    LDP3    1,,PR1
        22 004463   300000 220100                    LDX0    0,,PR3
        22 004464   000770 100003                    CMPX0   504,DU
        22 004465   004471 601000 22                 TNZ     s:13588

      979    13586    2            SEG_LTS$ = GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> SECTION.SEGMENT$;

  13586 22 004466   300007 236100                    LDQ     7,,PR3
        22 004467   000041 756000 0                  STQ     SEG_LTS$
        22 004470   004477 710000 22                 TRA     s:13591

      980    13587    2          ELSE
      981    13588    2            IF GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) THEN

  13588 22 004471   300007 236100                    LDQ     7,,PR3
        22 004472   000000 116000 23                 CMPQ    0
        22 004473   004477 600000 22                 TZE     s:13591

      982    13589    2              SEG_LTS$ = GO_ILS$ -> ILS.ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.
             13589                       SEGMENT$;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:179  

  13589 22 004474   300007 474500                    LDP4    7,,PR3
        22 004475   400007 236100                    LDQ     7,,PR4
        22 004476   000041 756000 0                  STQ     SEG_LTS$

      983    13590
      984    13591    2          IF (SEG_LTS$ ~= ADDR(NIL) AND

  13591 22 004477   000041 236000 0                  LDQ     SEG_LTS$
        22 004500   000000 116000 23                 CMPQ    0
        22 004501   004506 600000 22                 TZE     s:13591+7
        22 004502   000041 474400 0                  LDP4    SEG_LTS$
        22 004503   400002 236100                    LDQ     2,,PR4
        22 004504   000502 116000 xsym               CMPQ    COMCOM+322
        22 004505   004523 605000 22                 TPL     s:13680
        22 004506   000000 474400 15                 LDP4    ILL$
        22 004507   400001 475500                    LDP5    1,,PR4
        22 004510   500007 236100                    LDQ     7,,PR5
        22 004511   000000 116000 23                 CMPQ    0
        22 004512   004571 600000 22                 TZE     s:13701
        22 004513   500007 476500                    LDP6    7,,PR5
        22 004514   600007 236100                    LDQ     7,,PR6
        22 004515   000000 116000 23                 CMPQ    0
        22 004516   004571 600000 22                 TZE     s:13701
        22 004517   600007 477500                    LDP7    7,,PR6
        22 004520   700002 236100                    LDQ     2,,PR7
        22 004521   000502 116000 xsym               CMPQ    COMCOM+322
        22 004522   004571 604000 22                 TMI     s:13701

      985    13592    2            SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) OR
      986    13593    2            (ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND
      987    13594    2             ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$~= ADDR(NIL) AND
      988    13595    2             ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
      989    13596    2             SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) THEN
      990    13597    3            DO;

      991    13598                   %NEW_ALTER_LTS (@POINTER  = LTS$$,
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:180  
      992    13599                               @SEG_NO#  = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#,
      993    13600                               @LABEL$   = GO_ILS$ -> ILS.ILL$ -> ILL.LOP,
      994    13601                               @NEXT    = ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$)
             13601                                   ;

  13680 22 004523   000002 236000 11                 LDQ     LTS_+2
        22 004524   000004 036007                    ADLQ    4,DL
        22 004525   000003 116000 11                 CMPQ    LTS_+3
        22 004526   004537 604000 22                 TMI     s:13682

  13681 22 004527   000044 236000 23                 LDQ     36
        22 004530   000074 756000 0                  STQ     @INTDEF$$+1
        22 004531   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 004532   000075 451400 0                  STP1    @INTDEF$$+2
        22 004533   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 004534   000001 631400 23                 EPPR1   1
        22 004535   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 004536   000000 011000                    NOP     0

  13682 22 004537   000002 236000 11                 LDQ     LTS_+2
        22 004540   000022 736000                    QLS     18
        22 004541   000001 036000 11                 ADLQ    LTS_+1
        22 004542   000040 756000 0                  STQ     LTS$$

  13683 22 004543   000004 236007                    LDQ     4,DL
        22 004544   000002 056000 11                 ASQ     LTS_+2

  13684 22 004545   001073 220003                    LDX0    571,DU
        22 004546   000040 470400 0                  LDP0    LTS$$
        22 004547   000000 740100                    STX0    0,,PR0

  13690 22 004550   000000 740100                    STX0    0,,PR0

  13691 22 004551   000041 471400 0                  LDP1    SEG_LTS$
        22 004552   100002 235100                    LDA     2,,PR1
        22 004553   000002 755100                    STA     2,,PR0

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:181  
  13692 22 004554   000063 473400 0                  LDP3    GO_ILS$
        22 004555   300003 474500                    LDP4    3,,PR3
        22 004556   400001 236100                    LDQ     1,,PR4
        22 004557   000001 756100                    STQ     1,,PR0

  13693 22 004560   000000 474400 15                 LDP4    ILL$
        22 004561   400001 475500                    LDP5    1,,PR4
        22 004562   500005 476500                    LDP6    5,,PR5
        22 004563   600005 236100                    LDQ     5,,PR6
        22 004564   000003 756100                    STQ     3,,PR0

      995    13696
      996    13697    3              ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$ = LTS$$;

  13697 22 004565   400001 475500                    LDP5    1,,PR4
        22 004566   500005 476500                    LDP6    5,,PR5
        22 004567   000040 236000 0                  LDQ     LTS$$
        22 004570   600005 756100                    STQ     5,,PR6

      997    13698    3            END;

      998    13699
      999    13700
     1000    13701    2   END ALTER_CHECK ;

  13701 22 004571   000062 221200 0                  LDX1  ! ITEM_NOT_ETT+1
        22 004572   000001 702211                    TSX2  ! 1,X1

     1001    13702        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:182  
     1002    13703    1   CHECK_USE_PROC: PROC (REF_PTR$) ;

  13703 22 004573   000067 741200 0     CHECK_USE_P* STX1  ! LINOI$+1

     1003    13704        /*I*
     1004    13705               NAME:  CHECK_USE_PROC
     1005    13706               CALL:  CALL CHECK_USE_PROC (ADDR (ST_POINTER$));
     1006    13707          INTERFACE:  CHECK_USE_PROC is called to set the REFERENCED and GOTO_LABEL
     1007    13708                      bits for all USE procedures.
     1008    13709
     1009    13710              INPUT:  REF_PTR$ - PTR to USE procedure entry label.
     1010    13711             OUTPUT:  ST$ -> LABEL.B.REFERENCED, ST$ -> LABEL.B.ONE_REF,
     1011    13712                      ST$ -> LABEL.B.GOTO_LABEL - Attributes of label, as appropriate.
     1012    13713
     1013    13714        DESCRIPTION:  If there is any USE procedure then call REFERENCE_RESOLUTION
     1014    13715                      to mark the SECTION and PARAGRAPH labels as being referenced.
     1015    13716        */
     1016    13717    2   DCL REF_PTR$ PTR ;
     1017    13718    2   DCL REF$ITEM$ PTR BASED (REF_PTR$) ;
     1018    13719    2   DCL REF$ITEM_EPTR EPTR BASED (REF_PTR$) ;
     1019    13720
     1020    13721    2          IF REF$ITEM_EPTR = ENTADDR (NIL) THEN /* No USE procedure */ RETURN ;

  13721 22 004574   000070 470400 0                  LDP0    @REF_PTR$
        22 004575   000000 471500                    LDP1    0,,PR0
        22 004576   100000 236100                    LDQ     0,,PR1
        22 004577   000033 116000 23                 CMPQ    27
        22 004600   004602 601000 22                 TNZ     s:13722

  13721 22 004601   000001 702211                    TSX2  ! 1,X1

     1021    13722    2          CALL REFERENCE_RESOLUTION (REF_PTR$, TRUE) ;

  13722 22 004602   000046 236000 23                 LDQ     38
        22 004603   000056 756000 0                  STQ     @GOTO_DEST
        22 004604   000070 236000 0                  LDQ     @REF_PTR$
        22 004605   000055 756000 0                  STQ     @REF_PTR$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:183  
        22 004606   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 004607   000000 011000                    NOP     0

     1022    13723    2          TEMP_ILS$ = REF$ITEM$ -> LABEL.PREV_ILS$ ;

  13723 22 004610   000070 470400 0                  LDP0    @REF_PTR$
        22 004611   000000 471500                    LDP1    0,,PR0
        22 004612   100000 473500                    LDP3    0,,PR1
        22 004613   300010 236100                    LDQ     8,,PR3
        22 004614   000017 756000 0                  STQ     TEMP_ILS$

     1023    13724               %NEXT_NON_SUPPORT (POINTER=TEMP_ILS$) ; /* ILS for section label. */

  13734 22 004615   000017 470400 0                  LDP0    TEMP_ILS$
        22 004616   000002 236100                    LDQ     2,,PR0
        22 004617   000017 756000 0                  STQ     TEMP_ILS$

  13737 22 004620   000017 470400 0                  LDP0    TEMP_ILS$
        22 004621   000003 236100                    LDQ     3,,PR0
        22 004622   000000 116000 23                 CMPQ    0
        22 004623   004615 600000 22                 TZE     s:13734
        22 004624   000003 471500                    LDP1    3,,PR0
        22 004625   100000 220100                    LDX0    0,,PR1
        22 004626   000343 100003                    CMPX0   227,DU
        22 004627   004615 600000 22                 TZE     s:13734
        22 004630   000422 100003                    CMPX0   274,DU
        22 004631   004615 600000 22                 TZE     s:13734
        22 004632   000446 100003                    CMPX0   294,DU
        22 004633   004615 600000 22                 TZE     s:13734
        22 004634   000336 100003                    CMPX0   222,DU
        22 004635   004615 600000 22                 TZE     s:13734
        22 004636   000420 100003                    CMPX0   272,DU
        22 004637   004615 600000 22                 TZE     s:13734
        22 004640   000373 100003                    CMPX0   251,DU
        22 004641   004615 600000 22                 TZE     s:13734

     1024    13739    2          TEMP_ILS$ = TEMP_ILS$ -> ILS.ILL$ -> ILL.LBL ; /* ILS for paragraph. */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:184  

  13739 22 004642   100002 236100                    LDQ     2,,PR1
        22 004643   000017 756000 0                  STQ     TEMP_ILS$

     1025    13740    2          CALL REFERENCE_RESOLUTION (ADDR (TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP), FALSE) ;

  13740 22 004644   000017 470400 0                  LDP0    TEMP_ILS$
        22 004645   000003 471500                    LDP1    3,,PR0
        22 004646   100001 633500                    EPPR3   1,,PR1
        22 004647   000104 453400 0                  STP3    @INTDEF$$+9
        22 004650   000034 236000 23                 LDQ     28
        22 004651   000056 756000 0                  STQ     @GOTO_DEST
        22 004652   000104 631400 0                  EPPR1   @INTDEF$$+9
        22 004653   000055 451400 0                  STP1    @REF_PTR$
        22 004654   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 004655   000000 011000                    NOP     0

     1026    13741
     1027    13742    2   END CHECK_USE_PROC ;

  13742 22 004656   000067 221200 0                  LDX1  ! LINOI$+1
        22 004657   000001 702211                    TSX2  ! 1,X1

     1028    13743        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:185  
     1029    13744    1   SEARCH_FOR_INTDEF: PROC (DNT$$, INTDEF$$) ALTRET ;

  13744 22 004660   000071 741200 0     SEARCH_FOR_* STX1  ! @REF_PTR$+1

     1030    13745        /*I*
     1031    13746               NAME:  SEARCH_FOR_INTDEF
     1032    13747               CALL:  CALL SEARCH_FOR_INTDEF (DNT$,ST$) WHENRETURN DO;
     1033    13748                      < success code >; END ;
     1034    13749          INTERFACE:  None.
     1035    13750              INPUT:  DNT$$ - Pointer to DNT item for which an INTDEF may exist.
     1036    13751             OUTPUT:  INTDEF$$ - Pointer to the INTDEF item if one is found.
     1037    13752        DESCRIPTION:  Search thru the chain of ST items from the DNT item. If one
     1038    13753                      is INTDEF and it can legally satisfy the CALL or CANCEL then
     1039    13754                      return a pointer to it; if none can be found then ALTRETURN.
     1040    13755        */
     1041    13756    2   DCL DNT$$ PTR ;
     1042    13757    2   DCL INTDEF$$ PTR ;
     1043    13758    2          ST$ = DNT$$ -> DNT.ST$ ;

  13758 22 004661   000072 470400 0                  LDP0    @DNT$$
        22 004662   000000 471500                    LDP1    0,,PR0
        22 004663   100001 236100                    LDQ     1,,PR1
        22 004664   000000 756000 13                 STQ     ST$

     1044    13759    3          DO WHILE ST$ ~= ADDR (NIL) ;

  13759 22 004665   004733 710000 22                 TRA     s:13785

     1045    13760    4            IF ST$ -> ST.ID = %INTDEF THEN DO ;

  13760 22 004666   000000 470400 13                 LDP0    ST$
        22 004667   000000 220100                    LDX0    0,,PR0
        22 004670   000776 100003                    CMPX0   510,DU
        22 004671   004731 601000 22                 TNZ     s:13784

     1046    13761    4              FATHER$ = ST$ -> INTDEF.PROC$ -> PROC_.FATHER ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:186  
  13761 22 004672   000011 471500                    LDP1    9,,PR0
        22 004673   100011 236100                    LDQ     9,,PR1
        22 004674   000023 756000 0                  STQ     FATHER$

     1047    13762    5              IF ST$ -> INTDEF.PROC$ -> PROC_.B.COMMON THEN DO ;

  13762 22 004675   100003 234100                    SZN     3,,PR1
        22 004676   004722 605000 22                 TPL     s:13779

     1048    13763    5                TEMP$ = CURRENT_PROC$ ;

  13763 22 004677   000025 236000 0                  LDQ     CURRENT_PROC$
        22 004700   000031 756000 0                  STQ     TEMP$

     1049    13764    5   CHECK_COMMON_PROGRAM:
     1050    13765    6                DO UNTIL TEMP$ = ADDR (NIL) ;

  13765 22 004701                       CHECK_COMMO* null
     1051    13766                       /* COMMON program can be called from its father or
     1052    13767                          any of the father's descendants, but not from its
     1053    13768                          own descendants. Son or grandson cannot call it,
     1054    13769                          but brother, nephew, great nephew, etc., can. */
     1055    13770    6                  IF TEMP$ = ST$ -> INTDEF.PROC$ /* CALL by descendant */

  13770 22 004701   000000 470400 13                 LDP0    ST$
        22 004702   000031 236000 0                  LDQ     TEMP$
        22 004703   000011 116100                    CMPQ    9,,PR0
        22 004704   004721 600000 22                 TZE     s:13778

     1056    13771    6                    THEN EXIT CHECK_COMMON_PROGRAM ;
     1057    13772    7                  IF TEMP$ = FATHER$ THEN DO ;

  13772 22 004705   000023 116000 0                  CMPQ    FATHER$
        22 004706   004714 601000 22                 TNZ     s:13776

     1058    13773    7                    INTDEF$$ = ST$ ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:187  
  13773 22 004707   000000 236000 13                 LDQ     ST$
        22 004710   000073 471400 0                  LDP1    @INTDEF$$
        22 004711   100000 756100                    STQ     0,,PR1

     1059    13774    7                    RETURN ;

  13774 22 004712   000071 221200 0                  LDX1  ! @REF_PTR$+1
        22 004713   000001 702211                    TSX2  ! 1,X1

     1060    13775    7                  END ;
     1061    13776    6                  TEMP$ = TEMP$ -> PROC_.FATHER ;

  13776 22 004714   000031 471400 0                  LDP1    TEMP$
        22 004715   100011 236100                    LDQ     9,,PR1
        22 004716   000031 756000 0                  STQ     TEMP$

     1062    13777    6                END ; /* CHECK_COMMON_PROGRAM */

  13777 22 004717   000000 116000 23                 CMPQ    0
        22 004720   004701 601000 22                 TNZ     CHECK_COMMON_PROGRAM

     1063    13778    5              END ;

  13778 22 004721   004731 710000 22                 TRA     s:13784

     1064    13779    5              ELSE IF CURRENT_PROC$ = FATHER$ THEN DO ;

  13779 22 004722   000025 116000 0                  CMPQ    CURRENT_PROC$
        22 004723   004731 601000 22                 TNZ     s:13784

     1065    13780    5                INTDEF$$ = ST$ ;

  13780 22 004724   000000 236000 13                 LDQ     ST$
        22 004725   000073 473400 0                  LDP3    @INTDEF$$
        22 004726   300000 756100                    STQ     0,,PR3

     1066    13781    5                RETURN ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:188  

  13781 22 004727   000071 221200 0                  LDX1  ! @REF_PTR$+1
        22 004730   000001 702211                    TSX2  ! 1,X1

     1067    13782    5              END ;
     1068    13783    4            END ;
     1069    13784    3            ST$ = ST$ -> ST.NEXT ;

  13784 22 004731   000004 236100                    LDQ     4,,PR0
        22 004732   000000 756000 13                 STQ     ST$

     1070    13785    3          END ;

  13785 22 004733   000000 116000 23                 CMPQ    0
        22 004734   004666 601000 22                 TNZ     s:13760

     1071    13786    2          ALTRETURN ; /* Sorry - can't find any INTDEF that will do the job. */

  13786 22 004735   000071 221200 0                  LDX1  ! @REF_PTR$+1
        22 004736   000000 702211                    TSX2  ! 0,X1

     1072    13787    2   END SEARCH_FOR_INTDEF ;
     1073    13788        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:189  
     1074    13789        /*                     MAIN PROGRAM                        */
     1075    13790
     1076    13791    1          ILS$ = COMCOM.H_BRANCH ;

  13791 22 004737   000333 236000 xsym               LDQ     COMCOM+219
        22 004740   000000 756000 17                 STQ     ILS$

     1077    13792    1          CURRENT_PROC$ = ADDR (NIL) ; /* Since no SCOPE item found yet */

  13792 22 004741   000000 236000 23                 LDQ     0
        22 004742   000025 756000 0                  STQ     CURRENT_PROC$

     1078    13793    1          ERR_LINE = -1 ; /* No line */

  13793 22 004743   000001 335007                    LCA     1,DL
        22 004744   000035 755000 0                  STA     ERR_LINE

     1079    13794    1          ERR_DNT$ = ADDR (NIL) ; /* No DNT item either for last error */

  13794 22 004745   000037 756000 0                  STQ     ERR_DNT$

     1080    13795
     1081    13796        /*V*
     1082    13797            BRANCH_LIST -- Search the items linked into the branch list.  The ones needing
     1083    13798                           reference resolution (GO, PFORM) will use the procedure
     1084    13799                           REFERENCE RESOLUTION.  Label items are checked to see
     1085    13800                           if it is a section.  If this is true then O2COM.SECTION$
     1086    13801                           is updated as reference resolution needs this information.
     1087    13802        */
     1088    13803
     1089    13804    2          DO WHILE ILS$ ~= ADDR(NIL) ;

  13804 22 004746   006527 710000 22                 TRA     s:14505

     1090    13805    2            ILL$ = ILS$ -> ILS.ILL$ ;

  13805 22 004747   000000 470400 17                 LDP0    ILS$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:190  
        22 004750   000003 236100                    LDQ     3,,PR0
        22 004751   000000 756000 15                 STQ     ILL$

     1091    13806
     1092    13807    2   CASE_STMT:
     1093    13808    3            DO CASE (ILL$ -> ILL.ID) ;

  13808 22 004752   000000 471400 15    CASE_STMT    LDP1    ILL$
        22 004753   100000 236100                    LDQ     0,,PR1
        22 004754   000022 772000                    QRL     18
        22 004755   000313 136007                    SBLQ    203,DL
        22 004756   000133 116007                    CMPQ    91,DL
        22 004757   004761 602006 22                 TNC     CASE_STMT+7,QL
        22 004760   006524 710000 22                 TRA     s:14504
        22 004761   005277 710000 22                 TRA     s:13886
        22 004762   006524 710000 22                 TRA     s:14504
        22 004763   006524 710000 22                 TRA     s:14504
        22 004764   006524 710000 22                 TRA     s:14504
        22 004765   006524 710000 22                 TRA     s:14504
        22 004766   006524 710000 22                 TRA     s:14504
        22 004767   006524 710000 22                 TRA     s:14504
        22 004770   006524 710000 22                 TRA     s:14504
        22 004771   006524 710000 22                 TRA     s:14504
        22 004772   006524 710000 22                 TRA     s:14504
        22 004773   006524 710000 22                 TRA     s:14504
        22 004774   006524 710000 22                 TRA     s:14504
        22 004775   006524 710000 22                 TRA     s:14504
        22 004776   006524 710000 22                 TRA     s:14504
        22 004777   006524 710000 22                 TRA     s:14504
        22 005000   006524 710000 22                 TRA     s:14504
        22 005001   006524 710000 22                 TRA     s:14504
        22 005002   006524 710000 22                 TRA     s:14504
        22 005003   006524 710000 22                 TRA     s:14504
        22 005004   006524 710000 22                 TRA     s:14504
        22 005005   006524 710000 22                 TRA     s:14504
        22 005006   006524 710000 22                 TRA     s:14504
        22 005007   006524 710000 22                 TRA     s:14504
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:191  
        22 005010   006524 710000 22                 TRA     s:14504
        22 005011   006524 710000 22                 TRA     s:14504
        22 005012   005222 710000 22                 TRA     s:13857
        22 005013   005245 710000 22                 TRA     s:13869
        22 005014   005270 710000 22                 TRA     s:13878
        22 005015   006524 710000 22                 TRA     s:14504
        22 005016   006524 710000 22                 TRA     s:14504
        22 005017   006524 710000 22                 TRA     s:14504
        22 005020   006524 710000 22                 TRA     s:14504
        22 005021   006524 710000 22                 TRA     s:14504
        22 005022   006524 710000 22                 TRA     s:14504
        22 005023   006524 710000 22                 TRA     s:14504
        22 005024   006524 710000 22                 TRA     s:14504
        22 005025   006524 710000 22                 TRA     s:14504
        22 005026   006524 710000 22                 TRA     s:14504
        22 005027   006524 710000 22                 TRA     s:14504
        22 005030   006174 710000 22                 TRA     s:14268
        22 005031   006066 710000 22                 TRA     s:14207
        22 005032   006524 710000 22                 TRA     s:14504
        22 005033   006524 710000 22                 TRA     s:14504
        22 005034   006524 710000 22                 TRA     s:14504
        22 005035   006524 710000 22                 TRA     s:14504
        22 005036   006524 710000 22                 TRA     s:14504
        22 005037   006524 710000 22                 TRA     s:14504
        22 005040   006524 710000 22                 TRA     s:14504
        22 005041   006524 710000 22                 TRA     s:14504
        22 005042   006524 710000 22                 TRA     s:14504
        22 005043   006524 710000 22                 TRA     s:14504
        22 005044   006524 710000 22                 TRA     s:14504
        22 005045   006524 710000 22                 TRA     s:14504
        22 005046   006524 710000 22                 TRA     s:14504
        22 005047   006524 710000 22                 TRA     s:14504
        22 005050   006524 710000 22                 TRA     s:14504
        22 005051   006524 710000 22                 TRA     s:14504
        22 005052   005326 710000 22                 TRA     s:13905
        22 005053   006524 710000 22                 TRA     s:14504
        22 005054   006524 710000 22                 TRA     s:14504
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:192  
        22 005055   006524 710000 22                 TRA     s:14504
        22 005056   006524 710000 22                 TRA     s:14504
        22 005057   006524 710000 22                 TRA     s:14504
        22 005060   005426 710000 22                 TRA     s:13949
        22 005061   006524 710000 22                 TRA     s:14504
        22 005062   006524 710000 22                 TRA     s:14504
        22 005063   006524 710000 22                 TRA     s:14504
        22 005064   006524 710000 22                 TRA     s:14504
        22 005065   006524 710000 22                 TRA     s:14504
        22 005066   006524 710000 22                 TRA     s:14504
        22 005067   006524 710000 22                 TRA     s:14504
        22 005070   006524 710000 22                 TRA     s:14504
        22 005071   006524 710000 22                 TRA     s:14504
        22 005072   006524 710000 22                 TRA     s:14504
        22 005073   006524 710000 22                 TRA     s:14504
        22 005074   006524 710000 22                 TRA     s:14504
        22 005075   006524 710000 22                 TRA     s:14504
        22 005076   006524 710000 22                 TRA     s:14504
        22 005077   006524 710000 22                 TRA     s:14504
        22 005100   006524 710000 22                 TRA     s:14504
        22 005101   006524 710000 22                 TRA     s:14504
        22 005102   006524 710000 22                 TRA     s:14504
        22 005103   006524 710000 22                 TRA     s:14504
        22 005104   006524 710000 22                 TRA     s:14504
        22 005105   006524 710000 22                 TRA     s:14504
        22 005106   006524 710000 22                 TRA     s:14504
        22 005107   006524 710000 22                 TRA     s:14504
        22 005110   006524 710000 22                 TRA     s:14504
        22 005111   006524 710000 22                 TRA     s:14504
        22 005112   006524 710000 22                 TRA     s:14504
        22 005113   005114 710000 22                 TRA     s:13816

     1094    13809
     1095    13810        /*V*
     1096    13811            SCOPE -- Change CURRENT_SCOPE$ and CURRENT_PROC$ so addresses in this
     1097    13812                     program can be properly resolved.
     1098    13813        */
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:193  
     1099    13814
     1100    13815    3              CASE (%SCOPE) ;

     1101    13816    3                CURRENT_SCOPE$ = ILL$ ;

  13816 22 005114   000000 236000 15                 LDQ     ILL$
        22 005115   000027 756000 0                  STQ     CURRENT_SCOPE$

     1102    13817    4                IF CURRENT_PROC$ ~= ILL$ -> SCOPE.PROC$ THEN DO ;

  13817 22 005116   000025 236000 0                  LDQ     CURRENT_PROC$
        22 005117   100001 116100                    CMPQ    1,,PR1
        22 005120   005214 600000 22                 TZE     s:13848

     1103    13818    4                  IF ILL$ -> SCOPE.PROC$ = ADDR (NIL) THEN INIT_LINOI$ = ADDR (NIL) ;

  13818 22 005121   100001 236100                    LDQ     1,,PR1
        22 005122   000000 116000 23                 CMPQ    0
        22 005123   005127 601000 22                 TNZ     s:13820

  13818 22 005124   000000 236000 23                 LDQ     0
        22 005125   000030 756000 0                  STQ     INIT_LINOI$
        22 005126   005214 710000 22                 TRA     s:13848

     1104    13819    5                  ELSE DO ;

     1105    13820    5                    PROC_SUPP$ = ILL$ -> SCOPE.PROC$ -> PROC_.PROC_SUPP$ ;

  13820 22 005127   100001 473500                    LDP3    1,,PR1
        22 005130   300001 236100                    LDQ     1,,PR3
        22 005131   000026 756000 0                  STQ     PROC_SUPP$

     1106    13821        /*V*
     1107    13822            IO_USE_PROCEDURES -- Check USE procedure references for INPUT, etc.,
     1108    13823                                 and mark the procedures as referenced.
     1109    13824        */
     1110    13825    5                   CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.USE_INPUT_LABEL$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:194  
             13825                             ));

  13825 22 005132   000025 036003                    ADLQ    21,DU
        22 005133   000105 756000 0                  STQ     @INTDEF$$+10
        22 005134   000105 633400 0                  EPPR3   @INTDEF$$+10
        22 005135   000070 453400 0                  STP3    LINOI$+2
        22 005136   004573 701000 22                 TSX1    CHECK_USE_PROC
        22 005137   000000 011000                    NOP     0

     1111    13826    5                   CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.USE_IO_LABEL$));

  13826 22 005140   000026 236000 0                  LDQ     PROC_SUPP$
        22 005141   000027 036003                    ADLQ    23,DU
        22 005142   000106 756000 0                  STQ     @INTDEF$$+11
        22 005143   000106 630400 0                  EPPR0   @INTDEF$$+11
        22 005144   000070 450400 0                  STP0    LINOI$+2
        22 005145   004573 701000 22                 TSX1    CHECK_USE_PROC
        22 005146   000000 011000                    NOP     0

     1112    13827    5                    CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.
             13827                             USE_OUTPUT_LABEL$));

  13827 22 005147   000026 236000 0                  LDQ     PROC_SUPP$
        22 005150   000026 036003                    ADLQ    22,DU
        22 005151   000107 756000 0                  STQ     @INTDEF$$+12
        22 005152   000107 630400 0                  EPPR0   @INTDEF$$+12
        22 005153   000070 450400 0                  STP0    LINOI$+2
        22 005154   004573 701000 22                 TSX1    CHECK_USE_PROC
        22 005155   000000 011000                    NOP     0

     1113    13828    5                    CALL CHECK_USE_PROC (ADDR (PROC_SUPP$ -> PROC_SUPP.
             13828                             USE_EXTEND_LABEL$));

  13828 22 005156   000026 236000 0                  LDQ     PROC_SUPP$
        22 005157   000030 036003                    ADLQ    24,DU
        22 005160   000110 756000 0                  STQ     @INTDEF$$+13
        22 005161   000110 630400 0                  EPPR0   @INTDEF$$+13
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:195  
        22 005162   000070 450400 0                  STP0    LINOI$+2
        22 005163   004573 701000 22                 TSX1    CHECK_USE_PROC
        22 005164   000000 011000                    NOP     0

     1114    13829    5                    TEMP$ = PROC_SUPP$ -> PROC_SUPP.INIT_PROC$;

  13829 22 005165   000026 470400 0                  LDP0    PROC_SUPP$
        22 005166   000003 236100                    LDQ     3,,PR0
        22 005167   000031 756000 0                  STQ     TEMP$

     1115    13830    5                    IF TEMP$ = ADDR (NIL) THEN INIT_LINOI$ = ADDR (NIL) ;

  13830 22 005170   000000 116000 23                 CMPQ    0
        22 005171   005175 601000 22                 TNZ     s:13833

  13830 22 005172   000000 236000 23                 LDQ     0
        22 005173   000030 756000 0                  STQ     INIT_LINOI$
        22 005174   005214 710000 22                 TRA     s:13848

     1116    13831                                                    /* There is no INIT proc */
     1117    13832    6                    ELSE DO ;

     1118    13833    6                      TEMP$ = TEMP$ -> ILS.ILL$ /* PTR to PTR_SET */

  13833 22 005175   000031 471400 0                  LDP1    TEMP$
        22 005176   100003 473500                    LDP3    3,,PR1
        22 005177   300002 474500                    LDP4    2,,PR3
        22 005200   400010 236100                    LDQ     8,,PR4
        22 005201   000031 756000 0                  STQ     TEMP$

     1119    13834    6                              -> ILL.ROP -> LABEL.PREV_ILS$ ;
     1120    13835                           /* Found the beginning of INIT proc; now step forward to the
     1121    13836                              USE_ENTRY */
     1122    13837    7                      DO UNTIL TEMP$ -> ILS.NEXT->ILS.ILL$ -> ILL.ID = %USE_ENTRY ;

     1123    13838                             %NEXT_ILS (POINTER=TEMP$) ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:196  
  13840 22 005202   000031 470400 0                  LDP0    TEMP$
        22 005203   000002 236100                    LDQ     2,,PR0
        22 005204   000031 756000 0                  STQ     TEMP$

     1124    13843    7                      END ;

  13843 22 005205   000031 470400 0                  LDP0    TEMP$
        22 005206   000002 471500                    LDP1    2,,PR0
        22 005207   100003 473500                    LDP3    3,,PR1
        22 005210   300000 220100                    LDX0    0,,PR3
        22 005211   000364 100003                    CMPX0   244,DU
        22 005212   005202 601000 22                 TNZ     s:13840

     1125    13844    6                      INIT_LINOI$ = TEMP$ ; /* ILS for LINOI before USE_ENTRY */

  13844 22 005213   000030 756000 0                  STQ     INIT_LINOI$

     1126    13845    6                    END ;

     1127    13846    5                  END ;

     1128    13847    4                END ;

     1129    13848    3                CURRENT_PROC$ = ILL$ -> SCOPE.PROC$ ;

  13848 22 005214   000000 470400 15                 LDP0    ILL$
        22 005215   000001 236100                    LDQ     1,,PR0
        22 005216   000025 756000 0                  STQ     CURRENT_PROC$

     1130    13849    3                O2COM.SECTION$ = ADDR (NIL) ;

  13849 22 005217   000000 236000 23                 LDQ     0
        22 005220   000003 756000 12                 STQ     O2COM+3
        22 005221   006524 710000 22                 TRA     s:14504

     1131    13850        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:197  
     1132    13851        /*V*
     1133    13852            GO -- REFERENCE_RESOLUTION is called and if the reference is valid then
     1134    13853                  the label is marked as having a GO TO reference.
     1135    13854        */
     1136    13855
     1137    13856    3              CASE (%GO) ;

     1138    13857    4                IF ILL$ -> ILL.LOP ~= ADDR (NIL) THEN DO ;

  13857 22 005222   100001 236100                    LDQ     1,,PR1
        22 005223   000000 116000 23                 CMPQ    0
        22 005224   006524 600000 22                 TZE     s:14504

     1139    13858    4                  CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), TRUE) ;

  13858 22 005225   000000 236000 15                 LDQ     ILL$
        22 005226   000001 036003                    ADLQ    1,DU
        22 005227   000111 756000 0                  STQ     @INTDEF$$+14
        22 005230   000046 236000 23                 LDQ     38
        22 005231   000056 756000 0                  STQ     @REF_PTR$+1
        22 005232   000111 633400 0                  EPPR3   @INTDEF$$+14
        22 005233   000055 453400 0                  STP3    @LBL_SYM$+2
        22 005234   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005235   000000 011000                    NOP     0

     1140    13859    4                  IF ILL$ -> ILL.LOP = ADDR (NIL) /*#33670*/

  13859 22 005236   000000 470400 15                 LDP0    ILL$
        22 005237   000001 236100                    LDQ     1,,PR0
        22 005240   000000 116000 23                 CMPQ    0
        22 005241   006524 601000 22                 TNZ     s:14504

     1141    13860    4                    THEN ILL$ -> ILL.CODE = %GO_INVALID_LABEL ;

  13860 22 005242   000033 220003                    LDX0    27,DU
        22 005243   000000 440100                    SXL0    0,,PR0

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:198  
     1142    13861    4                END ;

  13861 22 005244   006524 710000 22                 TRA     s:14504

     1143    13862
     1144    13863        /*V*
     1145    13864            MULTI_GO -- This is a conditional transfer to both LOP and ROP.
     1146    13865                        Both are marked as having a GO TO reference.
     1147    13866        */
     1148    13867
     1149    13868    3              CASE (%MULTI_GO) ;

     1150    13869    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> MULTI_GO.LOP), TRUE) ;

  13869 22 005245   000000 236000 15                 LDQ     ILL$
        22 005246   000001 036003                    ADLQ    1,DU
        22 005247   000112 756000 0                  STQ     @INTDEF$$+15
        22 005250   000046 236000 23                 LDQ     38
        22 005251   000056 756000 0                  STQ     @REF_PTR$+1
        22 005252   000112 633400 0                  EPPR3   @INTDEF$$+15
        22 005253   000055 453400 0                  STP3    @LBL_SYM$+2
        22 005254   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005255   000000 011000                    NOP     0

     1151    13870    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> MULTI_GO.ROP), TRUE) ;

  13870 22 005256   000000 236000 15                 LDQ     ILL$
        22 005257   000002 036003                    ADLQ    2,DU
        22 005260   000113 756000 0                  STQ     @INTDEF$$+16
        22 005261   000046 236000 23                 LDQ     38
        22 005262   000056 756000 0                  STQ     @REF_PTR$+1
        22 005263   000113 630400 0                  EPPR0   @INTDEF$$+16
        22 005264   000055 450400 0                  STP0    @LBL_SYM$+2
        22 005265   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005266   000000 011000                    NOP     0
        22 005267   006524 710000 22                 TRA     s:14504

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:199  
     1152    13871
     1153    13872        /*V*
     1154    13873            DEFLB -- The current section variable is updated to point to the
     1155    13874                     correct section if the DEFLB is for a section.
     1156    13875        */
     1157    13876
     1158    13877    3              CASE (%DEFLB) ;

     1159    13878    3                IF ILL$ -> ILL.LOP -> LABEL.ID = %SECTION THEN

  13878 22 005270   100001 473500                    LDP3    1,,PR1
        22 005271   300000 220100                    LDX0    0,,PR3
        22 005272   000770 100003                    CMPX0   504,DU
        22 005273   006524 601000 22                 TNZ     s:14504

     1160    13879    3                  O2COM.SECTION$ = ILL$ -> ILL.LOP ;

  13879 22 005274   100001 236100                    LDQ     1,,PR1
        22 005275   000003 756000 12                 STQ     O2COM+3
        22 005276   006524 710000 22                 TRA     s:14504

     1161    13880
     1162    13881        /*V*
     1163    13882             REMEM -- Label passed to a PL6 routine as a REMEMBER arg.
     1164    13883        */
     1165    13884
     1166    13885    3               CASE( %REMEM );

     1167    13886    3                 IF NOT ILL$ -> ILL.LOP -> LABEL.B.DEFINED THEN

  13886 22 005277   100001 473500                    LDP3    1,,PR1
        22 005300   300003 236100                    LDQ     3,,PR3
        22 005301   200000 316003                    CANQ    65536,DU
        22 005302   005305 601000 22                 TNZ     s:13889

     1168    13887    3                   ILL$ -> ILL.LOP = ILL$ -> ILL.LOP -> LABEL.DNT$;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:200  
  13887 22 005303   300006 236100                    LDQ     6,,PR3
        22 005304   100001 756100                    STQ     1,,PR1

     1169    13888
     1170    13889    3                 CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), TRUE);

  13889 22 005305   000000 236000 15                 LDQ     ILL$
        22 005306   000001 036003                    ADLQ    1,DU
        22 005307   000114 756000 0                  STQ     @INTDEF$$+17
        22 005310   000046 236000 23                 LDQ     38
        22 005311   000056 756000 0                  STQ     @REF_PTR$+1
        22 005312   000114 633400 0                  EPPR3   @INTDEF$$+17
        22 005313   000055 453400 0                  STP3    @LBL_SYM$+2
        22 005314   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005315   000000 011000                    NOP     0

     1171    13890
     1172    13891    3                 IF ILL$ -> ILL.LOP = ADDR(NIL) THEN

  13891 22 005316   000000 470400 15                 LDP0    ILL$
        22 005317   000001 236100                    LDQ     1,,PR0
        22 005320   000000 116000 23                 CMPQ    0
        22 005321   006524 601000 22                 TNZ     s:14504

     1173    13892    3                   ILS$ -> ILS.ILL$ = ADDR(NIL);

  13892 22 005322   000000 236000 23                 LDQ     0
        22 005323   000000 471400 17                 LDP1    ILS$
        22 005324   100003 756100                    STQ     3,,PR1
        22 005325   006524 710000 22                 TRA     s:14504

     1174    13893
     1175    13894        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:201  
     1176    13895        /*V*
     1177    13896             PFORM -- Reference resolution is performed on the LOP of the ILL.  If there
     1178    13897                      is an error then no further work is done on the item.  The label
     1179    13898                      in the LOP is marked as a PFORM_START label.  If there is no ROP
     1180    13899                      (PFORM A) then the end label is found for A.  If there is a ROP
     1181    13900                      (PFORM A THRU B) then reference resolution is performed on B and
     1182    13901                      the end label is found for B.
     1183    13902        */
     1184    13903
     1185    13904    3              CASE (%PFORM) ;

     1186    13905    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), FALSE) ;

  13905 22 005326   000000 236000 15                 LDQ     ILL$
        22 005327   000001 036003                    ADLQ    1,DU
        22 005330   000115 756000 0                  STQ     @INTDEF$$+18
        22 005331   000034 236000 23                 LDQ     28
        22 005332   000056 756000 0                  STQ     @REF_PTR$+1
        22 005333   000115 633400 0                  EPPR3   @INTDEF$$+18
        22 005334   000055 453400 0                  STP3    @LBL_SYM$+2
        22 005335   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005336   000000 011000                    NOP     0

     1187    13906    3                IF ILL$ -> ILL.LOP ~= ADDR(NIL) THEN

  13906 22 005337   000000 470400 15                 LDP0    ILL$
        22 005340   000001 236100                    LDQ     1,,PR0
        22 005341   000000 116000 23                 CMPQ    0
        22 005342   006524 600000 22                 TZE     s:14504

     1188    13907    4                  DO ;

     1189    13908
     1190    13909    4                    IF ILL$ -> ILL.ROP = ADDR(NIL) THEN

  13909 22 005343   000002 236100                    LDQ     2,,PR0
        22 005344   000000 116000 23                 CMPQ    0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:202  
        22 005345   005365 601000 22                 TNZ     s:13923

     1191    13910    5                      DO ;

     1192    13911    5                        IF ILL$ -> ILL.LOP -> LABEL.P_END$ = ADDR(NIL) THEN

  13911 22 005346   000001 471500                    LDP1    1,,PR0
        22 005347   100001 236100                    LDQ     1,,PR1
        22 005350   000000 116000 23                 CMPQ    0
        22 005351   005360 601000 22                 TNZ     s:13916

     1193    13912    5                          CALL FIND_LABEL_END(ILL$ -> ILL.LOP) ;

  13912 22 005352   000000 236000 15                 LDQ     ILL$
        22 005353   000001 036003                    ADLQ    1,DU
        22 005354   000053 756000 0                  STQ     @PREV_ENTRY$+2
        22 005355   000452 701000 22                 TSX1    FIND_LABEL_END
        22 005356   000000 011000                    NOP     0
        22 005357   006524 710000 22                 TRA     s:14504

     1194    13913    5                        ELSE
     1195    13914                               %SET_END_LBL_VALUES(@ITEM$=ILL$ -> ILL.LOP) ;

  13916 22 005360   000002 756100                    STQ     2,,PR0

  13917 22 005361   000002 473500                    LDP3    2,,PR0
        22 005362   000025 236000 23                 LDQ     21
        22 005363   300003 356100                    ANSQ    3,,PR3

     1196    13920    5                      END ;

  13920 22 005364   006524 710000 22                 TRA     s:14504

     1197    13921    4                    ELSE
     1198    13922    5                      DO ;

     1199    13923    5                        FIRST_LBL$ = ILL$ -> ILL.LOP ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:203  

  13923 22 005365   000001 236100                    LDQ     1,,PR0
        22 005366   000021 756000 0                  STQ     FIRST_LBL$

     1200    13924    5                        CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.ROP), FALSE) ;

  13924 22 005367   000000 236000 15                 LDQ     ILL$
        22 005370   000002 036003                    ADLQ    2,DU
        22 005371   000116 756000 0                  STQ     @INTDEF$$+19
        22 005372   000034 236000 23                 LDQ     28
        22 005373   000056 756000 0                  STQ     @REF_PTR$+1
        22 005374   000116 631400 0                  EPPR1   @INTDEF$$+19
        22 005375   000055 451400 0                  STP1    @LBL_SYM$+2
        22 005376   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005377   000000 011000                    NOP     0

     1201    13925    5                        IF ILL$ -> ILL.ROP ~= ADDR(NIL) THEN

  13925 22 005400   000000 470400 15                 LDP0    ILL$
        22 005401   000002 236100                    LDQ     2,,PR0
        22 005402   000000 116000 23                 CMPQ    0
        22 005403   005423 600000 22                 TZE     s:13938

     1202    13926    6                          DO ;

     1203    13927
     1204    13928    6                            IF ILL$ -> ILL.ROP -> LABEL.P_END$ = ADDR(NIL) THEN

  13928 22 005404   000002 471500                    LDP1    2,,PR0
        22 005405   100001 236100                    LDQ     1,,PR1
        22 005406   000000 116000 23                 CMPQ    0
        22 005407   005416 601000 22                 TNZ     s:13933

     1205    13929    6                              CALL FIND_LABEL_END(ILL$ -> ILL.ROP) ;

  13929 22 005410   000000 236000 15                 LDQ     ILL$
        22 005411   000002 036003                    ADLQ    2,DU
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:204  
        22 005412   000053 756000 0                  STQ     @PREV_ENTRY$+2
        22 005413   000452 701000 22                 TSX1    FIND_LABEL_END
        22 005414   000000 011000                    NOP     0
        22 005415   006524 710000 22                 TRA     s:14504

     1206    13930    6                            ELSE
     1207    13931                                   %SET_END_LBL_VALUES(@ITEM$=ILL$ -> ILL.ROP) ;

  13933 22 005416   000002 756100                    STQ     2,,PR0

  13934 22 005417   000002 471500                    LDP1    2,,PR0
        22 005420   000025 236000 23                 LDQ     21
        22 005421   100003 356100                    ANSQ    3,,PR1

     1208    13937    6                          END ;

  13937 22 005422   006524 710000 22                 TRA     s:14504

     1209    13938    5                        ELSE ILL$ -> ILL.LOP = ADDR (NIL) ;

  13938 22 005423   000000 236000 23                 LDQ     0
        22 005424   000001 756100                    STQ     1,,PR0

     1210    13939    5                      END ;

     1211    13940    4                  END ;

  13940 22 005425   006524 710000 22                 TRA     s:14504

     1212    13941        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:205  
     1213    13942        /*V*
     1214    13943            ALTER -- REFERENCE_RESOLUTION is called for both the right and left
     1215    13944                     operands.  If the POINTER item has not been checked for validity
     1216    13945                     then that is done.
     1217    13946        */
     1218    13947
     1219    13948    3              CASE (%ALTER) ;

     1220    13949    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.LOP), FALSE) ;

  13949 22 005426   000000 236000 15                 LDQ     ILL$
        22 005427   000001 036003                    ADLQ    1,DU
        22 005430   000117 756000 0                  STQ     @INTDEF$$+20
        22 005431   000034 236000 23                 LDQ     28
        22 005432   000056 756000 0                  STQ     @REF_PTR$+1
        22 005433   000117 633400 0                  EPPR3   @INTDEF$$+20
        22 005434   000055 453400 0                  STP3    @LBL_SYM$+2
        22 005435   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005436   000000 011000                    NOP     0

     1221    13950    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> ILL.ROP), TRUE) ;

  13950 22 005437   000000 236000 15                 LDQ     ILL$
        22 005440   000002 036003                    ADLQ    2,DU
        22 005441   000120 756000 0                  STQ     @INTDEF$$+21
        22 005442   000046 236000 23                 LDQ     38
        22 005443   000056 756000 0                  STQ     @REF_PTR$+1
        22 005444   000120 630400 0                  EPPR0   @INTDEF$$+21
        22 005445   000055 450400 0                  STP0    @LBL_SYM$+2
        22 005446   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 005447   000000 011000                    NOP     0

     1222    13951
     1223    13952    3                IF ILL$ -> ILL.ROP = ADDR(NIL) THEN

  13952 22 005450   000000 470400 15                 LDP0    ILL$
        22 005451   000002 236100                    LDQ     2,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:206  
        22 005452   000000 116000 23                 CMPQ    0
        22 005453   005457 601000 22                 TNZ     s:13956

     1224    13953    3                  ILL$ -> ILL.LOP = ADDR(NIL) ;

  13953 22 005454   000000 236000 23                 LDQ     0
        22 005455   000001 756100                    STQ     1,,PR0
        22 005456   005470 710000 22                 TRA     s:13966

     1225    13954    3                ELSE
     1226    13955    4                  DO ;

     1227    13956    4                    IF ILL$ -> ILL.LOP ~= ADDR(NIL) THEN

  13956 22 005457   000001 236100                    LDQ     1,,PR0
        22 005460   000000 116000 23                 CMPQ    0
        22 005461   005470 600000 22                 TZE     s:13966

     1228    13957    5                      DO ;

     1229    13958    5                        IF ILL$ -> ILL.LOP -> LABEL.B.ALTER_CHECK THEN

  13958 22 005462   000001 471500                    LDP1    1,,PR0
        22 005463   100003 236100                    LDQ     3,,PR1
        22 005464   000040 316003                    CANQ    32,DU
        22 005465   005470 601000 22                 TNZ     s:13966

     1230    13959                      /* The item has already been checked for a correct ALTER paragraph */
     1231    13960    5                          ;
     1232    13961    5                        ELSE
     1233    13962    5                          CALL ALTER_CHECK ;

  13962 22 005466   002317 701000 22                 TSX1    ALTER_CHECK
        22 005467   000000 011000                    NOP     0

     1234    13963    5                      END;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:207  
     1235    13964    4                  END;

     1236    13965
     1237    13966    3                IF COMCOM.SEGMENTC > 1 AND

  13966 22 005470   000314 235000 xsym               LDA     COMCOM+204
        22 005471   000001 115007                    CMPA    1,DL
        22 005472   006524 604400 22                 TMOZ    s:14504
        22 005473   000000 470400 15                 LDP0    ILL$
        22 005474   000001 236100                    LDQ     1,,PR0
        22 005475   000000 116000 23                 CMPQ    0
        22 005476   006524 600000 22                 TZE     s:14504

     1238    13967    3                  ILL$ -> ILL.LOP ~= ADDR(NIL) THEN
     1239    13968    4                  DO;

     1240    13969    4                    IF ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND

  13969 22 005477   000001 471500                    LDP1    1,,PR0
        22 005500   100007 236100                    LDQ     7,,PR1
        22 005501   000000 116000 23                 CMPQ    0
        22 005502   005562 600000 22                 TZE     s:14001
        22 005503   100007 473500                    LDP3    7,,PR1
        22 005504   300007 236100                    LDQ     7,,PR3
        22 005505   000000 116000 23                 CMPQ    0
        22 005506   005562 600000 22                 TZE     s:14001
        22 005507   300007 474500                    LDP4    7,,PR3
        22 005510   400002 235100                    LDA     2,,PR4
        22 005511   000061 115007                    CMPA    49,DL
        22 005512   005562 604400 22                 TMOZ    s:14001

     1241    13970    4                       ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ~= ADDR(
             13970                                NIL) AND
     1242    13971    4                       ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
     1243    13972    4                          SEGMENT_LTS.SEGMENT_NO# > %MAX_FIXED_SEG# THEN
     1244    13973    5                      DO;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:208  
     1245    13974    5                        IF O2COM.SECTION$ -> SECTION.SEGMENT$ = ADDR(NIL) OR

  13974 22 005513   000003 475400 12                 LDP5    O2COM+3
        22 005514   500007 236100                    LDQ     7,,PR5
        22 005515   000000 116000 23                 CMPQ    0
        22 005516   005523 600000 22                 TZE     s:13981
        22 005517   500007 476500                    LDP6    7,,PR5
        22 005520   400002 236100                    LDQ     2,,PR4
        22 005521   600002 116100                    CMPQ    2,,PR6
        22 005522   005562 600000 22                 TZE     s:14001

     1246    13975    5                          ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
     1247    13976    5                          SEGMENT_LTS.SEGMENT_NO# ~=
     1248    13977    5                         O2COM.SECTION$ -> SECTION.SEGMENT$ -> SEGMENT_LTS.SEGMENT_NO#
             13977                                   THEN
     1249    13978    6                          DO;

     1250    13979                                 %FIND_LINE_NO;

  13981 22 005523   000000 236000 17                 LDQ     ILS$
        22 005524   000004 756000 12                 STQ     O2COM+4

  13982 22 005525   000004 471400 12                 LDP1    O2COM+4
        22 005526   100003 473500                    LDP3    3,,PR1
        22 005527   300000 220100                    LDX0    0,,PR3
        22 005530   000373 100003                    CMPX0   251,DU
        22 005531   005545 600000 22                 TZE     s:13991

  13986 22 005532   000004 470400 12                 LDP0    O2COM+4
        22 005533   000002 236100                    LDQ     2,,PR0
        22 005534   000004 756000 12                 STQ     O2COM+4

  13989 22 005535   000004 470400 12                 LDP0    O2COM+4
        22 005536   000003 236100                    LDQ     3,,PR0
        22 005537   000000 116000 23                 CMPQ    0
        22 005540   005532 600000 22                 TZE     s:13986

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:209  
  13990 22 005541   000003 471500                    LDP1    3,,PR0
        22 005542   100000 220100                    LDX0    0,,PR1
        22 005543   000373 100003                    CMPX0   251,DU
        22 005544   005532 601000 22                 TNZ     s:13986

  13991 22 005545   000004 470400 12                 LDP0    O2COM+4
        22 005546   000003 471500                    LDP1    3,,PR0
        22 005547   100000 236100                    LDQ     0,,PR1
        22 005550   777777 376007                    ANQ     -1,DL
        22 005551   000133 756000 xsym               STQ     COMCOM+91

  13992 22 005552   000003 471500                    LDP1    3,,PR0
        22 005553   100002 236100                    LDQ     2,,PR1
        22 005554   777777 376007                    ANQ     -1,DL
        22 005555   000134 756000 xsym               STQ     COMCOM+92

     1251    13995
     1252    13996    6                            CALL Z8AE$ERROR (%E$ALTER_IND_GOTO);

  13996 22 005556   000050 630400 23                 EPPR0   40
        22 005557   000001 631400 23                 EPPR1   1
        22 005560   000000 701000 xent               TSX1    Z8AE$ERROR
        22 005561   000000 011000                    NOP     0

     1253    13997
     1254    13998    6                          END;

     1255    13999    5                      END;

     1256    14000
     1257    14001    4                      SEG_LTS$ = ADDR(NIL);

  14001 22 005562   000000 236000 23                 LDQ     0
        22 005563   000041 756000 0                  STQ     SEG_LTS$

     1258    14002    4                      IF ILL$ -> ILL.ROP -> LABEL.ID = %SECTION THEN

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:210  
  14002 22 005564   000000 470400 15                 LDP0    ILL$
        22 005565   000002 471500                    LDP1    2,,PR0
        22 005566   100000 220100                    LDX0    0,,PR1
        22 005567   000770 100003                    CMPX0   504,DU
        22 005570   005574 601000 22                 TNZ     s:14005

     1259    14003    4                        SEG_LTS$ = ILL$ -> ILL.ROP -> SECTION.SEGMENT$;

  14003 22 005571   100007 236100                    LDQ     7,,PR1
        22 005572   000041 756000 0                  STQ     SEG_LTS$
        22 005573   005602 710000 22                 TRA     s:14008

     1260    14004    4                      ELSE
     1261    14005    4                        IF ILL$ -> ILL.ROP -> LABEL.SECTION$ ~= ADDR(NIL) THEN

  14005 22 005574   100007 236100                    LDQ     7,,PR1
        22 005575   000000 116000 23                 CMPQ    0
        22 005576   005602 600000 22                 TZE     s:14008

     1262    14006    4                          SEG_LTS$ = ILL$ -> ILL.ROP -> LABEL.SECTION$ -> SECTION.
             14006                                   SEGMENT$;

  14006 22 005577   100007 473500                    LDP3    7,,PR1
        22 005600   300007 236100                    LDQ     7,,PR3
        22 005601   000041 756000 0                  STQ     SEG_LTS$

     1263    14007
     1264    14008    4                      IF (SEG_LTS$ ~= ADDR(NIL) AND

  14008 22 005602   000041 236000 0                  LDQ     SEG_LTS$
        22 005603   000000 116000 23                 CMPQ    0
        22 005604   005611 600000 22                 TZE     s:14008+7
        22 005605   000041 473400 0                  LDP3    SEG_LTS$
        22 005606   300002 236100                    LDQ     2,,PR3
        22 005607   000502 116000 xsym               CMPQ    COMCOM+322
        22 005610   005625 605000 22                 TPL     s:14097
        22 005611   000001 473500                    LDP3    1,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:211  
        22 005612   300007 236100                    LDQ     7,,PR3
        22 005613   000000 116000 23                 CMPQ    0
        22 005614   005671 600000 22                 TZE     s:14117
        22 005615   300007 474500                    LDP4    7,,PR3
        22 005616   400007 236100                    LDQ     7,,PR4
        22 005617   000000 116000 23                 CMPQ    0
        22 005620   005671 600000 22                 TZE     s:14117
        22 005621   400007 475500                    LDP5    7,,PR4
        22 005622   500002 236100                    LDQ     2,,PR5
        22 005623   000502 116000 xsym               CMPQ    COMCOM+322
        22 005624   005671 604000 22                 TMI     s:14117

     1265    14009    4                        SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) OR
     1266    14010    4                        (ILL$ -> ILL.LOP -> LABEL.SECTION$ ~= ADDR(NIL) AND
     1267    14011    4                         ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$~= ADDR(
             14011                                  NIL) AND
     1268    14012    4                         ILL$ -> ILL.LOP -> LABEL.SECTION$ -> SECTION.SEGMENT$ ->
     1269    14013    4                         SEGMENT_LTS.SEGMENT_NO# >= COMCOM.SEG_LIMIT) THEN
     1270    14014    5                        DO;

     1271    14015                               %NEW_ALTER_LTS (@POINTER  = LTS$$,
     1272    14016                                           @SEG_NO#  = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#,
     1273    14017                                           @LABEL$   = ILL$ -> ILL.ROP,
     1274    14018                                           @NEXT     =
             14018                                           ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$
             14018                                               );

  14097 22 005625   000002 236000 11                 LDQ     LTS_+2
        22 005626   000004 036007                    ADLQ    4,DL
        22 005627   000003 116000 11                 CMPQ    LTS_+3
        22 005630   005641 604000 22                 TMI     s:14099

  14098 22 005631   000044 236000 23                 LDQ     36
        22 005632   000074 756000 0                  STQ     @INTDEF$$+1
        22 005633   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 005634   000075 451400 0                  STP1    @INTDEF$$+2
        22 005635   000075 630400 0                  EPPR0   @INTDEF$$+2
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:212  
        22 005636   000001 631400 23                 EPPR1   1
        22 005637   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 005640   000000 011000                    NOP     0

  14099 22 005641   000002 236000 11                 LDQ     LTS_+2
        22 005642   000022 736000                    QLS     18
        22 005643   000001 036000 11                 ADLQ    LTS_+1
        22 005644   000040 756000 0                  STQ     LTS$$

  14100 22 005645   000004 236007                    LDQ     4,DL
        22 005646   000002 056000 11                 ASQ     LTS_+2

  14101 22 005647   001073 220003                    LDX0    571,DU
        22 005650   000040 470400 0                  LDP0    LTS$$
        22 005651   000000 740100                    STX0    0,,PR0

  14107 22 005652   000000 740100                    STX0    0,,PR0

  14108 22 005653   000041 471400 0                  LDP1    SEG_LTS$
        22 005654   100002 235100                    LDA     2,,PR1
        22 005655   000002 755100                    STA     2,,PR0

  14109 22 005656   000000 473400 15                 LDP3    ILL$
        22 005657   300002 236100                    LDQ     2,,PR3
        22 005660   000001 756100                    STQ     1,,PR0

  14110 22 005661   300001 474500                    LDP4    1,,PR3
        22 005662   400005 475500                    LDP5    5,,PR4
        22 005663   500005 236100                    LDQ     5,,PR5
        22 005664   000003 756100                    STQ     3,,PR0

     1275    14113
     1276    14114    5                          ILL$ -> ILL.LOP -> LABEL.POINTER$ -> SCALAR.LTS$ = LTS$$;

  14114 22 005665   300001 474500                    LDP4    1,,PR3
        22 005666   400005 475500                    LDP5    5,,PR4
        22 005667   000040 236000 0                  LDQ     LTS$$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:213  
        22 005670   500005 756100                    STQ     5,,PR5

     1277    14115    5                        END;

     1278    14116
     1279    14117    4                        IF SEG_LTS$ ~= ADDR(NIL) THEN

  14117 22 005671   000041 236000 0                  LDQ     SEG_LTS$
        22 005672   000000 116000 23                 CMPQ    0
        22 005673   006524 600000 22                 TZE     s:14504

     1280    14118    5                          DO;

     1281    14119                                   %RESERVE_ILS (ITEM = %OPV, POINTER = TEMP$);

  14139 22 005674   000002 236000 18                 LDQ     ILS_+2
        22 005675   000005 036007                    ADLQ    5,DL
        22 005676   000003 116000 18                 CMPQ    ILS_+3
        22 005677   005710 602000 22                 TNC     s:14141

  14140 22 005700   000002 236000 23                 LDQ     2
        22 005701   000074 756000 0                  STQ     @INTDEF$$+1
        22 005702   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 005703   000075 450400 0                  STP0    @INTDEF$$+2
        22 005704   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 005705   000001 631400 23                 EPPR1   1
        22 005706   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 005707   000000 011000                    NOP     0

  14141 22 005710   000002 236000 18                 LDQ     ILS_+2
        22 005711   000022 736000                    QLS     18
        22 005712   000001 036000 18                 ADLQ    ILS_+1
        22 005713   000031 756000 0                  STQ     TEMP$

  14142 22 005714   000002 235000 18                 LDA     ILS_+2
        22 005715   000005 035007                    ADLA    5,DL
        22 005716   000002 755000 18                 STA     ILS_+2
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:214  

  14143 22 005717   000741 220003                    LDX0    481,DU
        22 005720   000031 470400 0                  LDP0    TEMP$
        22 005721   000000 740100                    STX0    0,,PR0

  14144 22 005722   000000 236000 23                 LDQ     0
        22 005723   000031 470400 0                  LDP0    TEMP$
        22 005724   000002 756100                    STQ     2,,PR0

     1282    14148
     1283    14149    5                              TEMP$ -> ILS.DNAME = ILL$ -> ILL.LOP -> LABEL.POINTER$;

  14149 22 005725   000000 470400 15                 LDP0    ILL$
        22 005726   000001 471500                    LDP1    1,,PR0
        22 005727   100005 236100                    LDQ     5,,PR1
        22 005730   000031 473400 0                  LDP3    TEMP$
        22 005731   300004 756100                    STQ     4,,PR3

     1284    14150
     1285    14151                                   %RESERVE_ILL (ITEM = %MVANO,
     1286    14152                                                 POINTER = TEMP$ -> ILS.ILL$);

  14154 22 005732   000027 235000 xsym               LDA     ILL_STEP+23
        22 005733   000000 755000 1                  STA     ITERATION

  14155 22 005734   000002 236000 16                 LDQ     ILL_+2
        22 005735   000000 036000 1                  ADLQ    ITERATION
        22 005736   000003 116000 16                 CMPQ    ILL_+3
        22 005737   005750 604000 22                 TMI     s:14157

  14156 22 005740   000003 236000 23                 LDQ     3
        22 005741   000074 756000 0                  STQ     @INTDEF$$+1
        22 005742   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 005743   000075 451400 0                  STP1    @INTDEF$$+2
        22 005744   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 005745   000001 631400 23                 EPPR1   1
        22 005746   000000 701000 xent               TSX1    Z8AR$RESERVER
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:215  
        22 005747   000000 011000                    NOP     0

  14157 22 005750   000002 236000 16                 LDQ     ILL_+2
        22 005751   000022 736000                    QLS     18
        22 005752   000001 036000 16                 ADLQ    ILL_+1
        22 005753   000031 470400 0                  LDP0    TEMP$
        22 005754   000003 756100                    STQ     3,,PR0

  14158 22 005755   000002 236000 16                 LDQ     ILL_+2
        22 005756   000000 036000 1                  ADLQ    ITERATION
        22 005757   000002 756000 16                 STQ     ILL_+2

  14159 22 005760   000031 470400 0                  LDP0    TEMP$
        22 005761   000003 471500                    LDP1    3,,PR0
        22 005762   000255 220003                    LDX0    173,DU
        22 005763   100000 740100                    STX0    0,,PR1

     1287    14162
     1288    14163    5                              TEMP$ -> ILS.NEXT = ILS$ -> ILS.NEXT;

  14163 22 005764   000000 470400 17                 LDP0    ILS$
        22 005765   000002 236100                    LDQ     2,,PR0
        22 005766   000031 471400 0                  LDP1    TEMP$
        22 005767   100002 756100                    STQ     2,,PR1

     1289    14164    5                              ILS$ -> ILS.NEXT = TEMP$;

  14164 22 005770   000031 236000 0                  LDQ     TEMP$
        22 005771   000002 756100                    STQ     2,,PR0

     1290    14165    5                              TEMP$ -> ILS.ILL$ -> ILL.CODE = %MVANO_LOWER_TO_LOWER;

  14165 22 005772   000031 471400 0                  LDP1    TEMP$
        22 005773   100003 473500                    LDP3    3,,PR1
        22 005774   000003 221003                    LDX1    3,DU
        22 005775   300000 441100                    SXL1    0,,PR3

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:216  
     1291    14166    5                              MKCN.CON = SEG_LTS$ -> SEGMENT_LTS.SEGMENT_NO#;

  14166 22 005776   000041 470400 0                  LDP0    SEG_LTS$
        22 005777   000002 235100                    LDA     2,,PR0
        22 006000   000000 755000 19                 STA     MKCN

     1292    14167
     1293    14168    5                              CALL Z8AC$MAKE_CONST (TEMP$ -> ILS.ILL$ -> ILL.ROP);

  14168 22 006001   000031 471400 0                  LDP1    TEMP$
        22 006002   100003 473500                    LDP3    3,,PR1
        22 006003   300002 634500                    EPPR4   2,,PR3
        22 006004   000074 454400 0                  STP4    @INTDEF$$+1
        22 006005   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 006006   000001 631400 23                 EPPR1   1
        22 006007   000000 701000 xent               TSX1    Z8AC$MAKE_CONST
        22 006010   000000 011000                    NOP     0

     1294    14169
     1295    14170    5                              CALL Z8AF$NEW_BASE (ILL$ -> ILL.LOP -> LABEL.POINTER$,

  14170 22 006011   000000 470400 15                 LDP0    ILL$
        22 006012   000001 471500                    LDP1    1,,PR0
        22 006013   000031 473400 0                  LDP3    TEMP$
        22 006014   300003 474500                    LDP4    3,,PR3
        22 006015   000000 236000 23                 LDQ     0
        22 006016   000074 756000 0                  STQ     @INTDEF$$+1
        22 006017   400001 635500                    EPPR5   1,,PR4
        22 006020   000077 455400 0                  STP5    @INTDEF$$+4
        22 006021   000074 634400 0                  EPPR4   @INTDEF$$+1
        22 006022   000076 454400 0                  STP4    @INTDEF$$+3
        22 006023   100005 636500                    EPPR6   5,,PR1
        22 006024   000075 456400 0                  STP6    @INTDEF$$+2
        22 006025   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 006026   000043 631400 23                 EPPR1   35
        22 006027   000000 701000 xent               TSX1    Z8AF$NEW_BASE
        22 006030   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:217  

     1296    14171    5                                                  ADDR(NIL),
     1297    14172    5                                                  TEMP$ -> ILS.ILL$ -> ILL.LOP);
     1298    14173
     1299    14174    5                              TEMP_ILS$ = TEMP$;

  14174 22 006031   000031 236000 0                  LDQ     TEMP$
        22 006032   000017 756000 0                  STQ     TEMP_ILS$

     1300    14175
     1301    14176                                   %NEXT_NON_SUPPORT (POINTER = TEMP_ILS$);

  14186 22 006033   000017 470400 0                  LDP0    TEMP_ILS$
        22 006034   000002 236100                    LDQ     2,,PR0
        22 006035   000017 756000 0                  STQ     TEMP_ILS$

  14189 22 006036   000017 470400 0                  LDP0    TEMP_ILS$
        22 006037   000003 236100                    LDQ     3,,PR0
        22 006040   000000 116000 23                 CMPQ    0
        22 006041   006033 600000 22                 TZE     s:14186
        22 006042   000003 471500                    LDP1    3,,PR0
        22 006043   100000 220100                    LDX0    0,,PR1
        22 006044   000343 100003                    CMPX0   227,DU
        22 006045   006033 600000 22                 TZE     s:14186
        22 006046   000422 100003                    CMPX0   274,DU
        22 006047   006033 600000 22                 TZE     s:14186
        22 006050   000446 100003                    CMPX0   294,DU
        22 006051   006033 600000 22                 TZE     s:14186
        22 006052   000336 100003                    CMPX0   222,DU
        22 006053   006033 600000 22                 TZE     s:14186
        22 006054   000420 100003                    CMPX0   272,DU
        22 006055   006033 600000 22                 TZE     s:14186
        22 006056   000373 100003                    CMPX0   251,DU
        22 006057   006033 600000 22                 TZE     s:14186

     1302    14191
     1303    14192    5                              IF TEMP_ILS$ -> ILS.ILL$ -> ILL.ID = %DEFLB THEN
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:218  

  14192 22 006060   000346 100003                    CMPX0   230,DU
        22 006061   006524 601000 22                 TNZ     s:14504

     1304    14193    5                                TEMP_ILS$ -> ILS.ILL$ -> ILL.LOP ->

  14193 22 006062   100001 473500                    LDP3    1,,PR1
        22 006063   000031 236000 0                  LDQ     TEMP$
        22 006064   300010 756100                    STQ     8,,PR3

     1305    14194    5                                  LABEL.PREV_ILS$ = TEMP$ ;
     1306    14195
     1307    14196    5                          END;

     1308    14197
     1309    14198    4                    END ;

  14198 22 006065   006524 710000 22                 TRA     s:14504

     1310    14199        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:219  
     1311    14200        /*V*
     1312    14201            USER_CALL -- Find out if this CALL can be satisfied by an internal
     1313    14202                         program. If so, plug in the INTDEF pointer in place of the
     1314    14203                         SYMREF pointer, decrement the SYMREF's reference count, and
     1315    14204                         make sure ALTRET$ is ADDR (NIL).
     1316    14205        */
     1317    14206    3              CASE (%USER_CALL) ;

     1318    14207    3                SYMREF$$ = ILL$ -> USER_CALL.DESTINATION$ ;

  14207 22 006066   100005 236100                    LDQ     5,,PR1
        22 006067   000024 756000 0                  STQ     SYMREF$$

     1319    14208    3                CALL SEARCH_FOR_INTDEF (SYMREF$$ -> SYMREF_.DNT$,

  14208 22 006070   000000 236000 15                 LDQ     ILL$
        22 006071   000005 036003                    ADLQ    5,DU
        22 006072   000073 756000 0                  STQ     @DNT$$+1
        22 006073   000024 236000 0                  LDQ     SYMREF$$
        22 006074   000006 036003                    ADLQ    6,DU
        22 006075   000072 756000 0                  STQ     @REF_PTR$+2
        22 006076   004660 701000 22                 TSX1    SEARCH_FOR_INTDEF
        22 006077   006162 702000 22                 TSX2    s:14242

     1320    14209    3                    ILL$ -> USER_CALL.DESTINATION$)
     1321    14210    4                  WHENRETURN DO ;

     1322    14211    4                    TEMP$ = ILL$->USER_CALL.DESTINATION$->INTDEF.PROC$->

  14211 22 006100   000000 470400 15                 LDP0    ILL$
        22 006101   000005 471500                    LDP1    5,,PR0
        22 006102   100011 473500                    LDP3    9,,PR1
        22 006103   300001 236100                    LDQ     1,,PR3
        22 006104   000031 756000 0                  STQ     TEMP$

     1323    14212    4                        PROC_.PROC_SUPP$ ;
     1324    14213    4                    TEMP$->PROC_SUPP.REF_COUNT = TEMP$->PROC_SUPP.REF_COUNT + 1 ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:220  

  14213 22 006105   000031 471400 0                  LDP1    TEMP$
        22 006106   100020 235100                    LDA     16,,PR1
        22 006107   000001 035007                    ADLA    1,DL
        22 006110   100020 755100                    STA     16,,PR1

     1325    14214    4                    SYMREF$$ -> SYMREF_.REF_COUNT =

  14214 22 006111   000024 471400 0                  LDP1    SYMREF$$
        22 006112   000001 336007                    LCQ     1,DL
        22 006113   100010 056100                    ASQ     8,,PR1

     1326    14215    4                        SYMREF$$ -> SYMREF_.REF_COUNT - 1 ;
     1327    14216    5                    IF ILL$ -> USER_CALL.ALTRET$ ~= ADDR (NIL) THEN DO ;

  14216 22 006114   000004 236100                    LDQ     4,,PR0
        22 006115   000000 116000 23                 CMPQ    0
        22 006116   006161 600000 22                 TZE     s:14240

     1328    14217                           %FIND_LINE_NO ;

  14219 22 006117   000000 236000 17                 LDQ     ILS$
        22 006120   000004 756000 12                 STQ     O2COM+4

  14220 22 006121   000004 473400 12                 LDP3    O2COM+4
        22 006122   300003 474500                    LDP4    3,,PR3
        22 006123   400000 220100                    LDX0    0,,PR4
        22 006124   000373 100003                    CMPX0   251,DU
        22 006125   006141 600000 22                 TZE     s:14229

  14224 22 006126   000004 470400 12                 LDP0    O2COM+4
        22 006127   000002 236100                    LDQ     2,,PR0
        22 006130   000004 756000 12                 STQ     O2COM+4

  14227 22 006131   000004 470400 12                 LDP0    O2COM+4
        22 006132   000003 236100                    LDQ     3,,PR0
        22 006133   000000 116000 23                 CMPQ    0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:221  
        22 006134   006126 600000 22                 TZE     s:14224

  14228 22 006135   000003 471500                    LDP1    3,,PR0
        22 006136   100000 220100                    LDX0    0,,PR1
        22 006137   000373 100003                    CMPX0   251,DU
        22 006140   006126 601000 22                 TNZ     s:14224

  14229 22 006141   000004 470400 12                 LDP0    O2COM+4
        22 006142   000003 471500                    LDP1    3,,PR0
        22 006143   100000 236100                    LDQ     0,,PR1
        22 006144   777777 376007                    ANQ     -1,DL
        22 006145   000133 756000 xsym               STQ     COMCOM+91

  14230 22 006146   000003 471500                    LDP1    3,,PR0
        22 006147   100002 236100                    LDQ     2,,PR1
        22 006150   777777 376007                    ANQ     -1,DL
        22 006151   000134 756000 xsym               STQ     COMCOM+92

     1329    14233    5                      CALL Z8AE$ERROR (%E$INTERNAL_CALL_ALTRET) ;

  14233 22 006152   000052 630400 23                 EPPR0   42
        22 006153   000001 631400 23                 EPPR1   1
        22 006154   000000 701000 xent               TSX1    Z8AE$ERROR
        22 006155   000000 011000                    NOP     0

     1330    14234        /*E*
     1331    14235              ERROR: INTERNAL_CALL_ALTRET
     1332    14236            MESSAGE: OVERFLOW cannot occur on CALLs to internal programs.
     1333    14237        */
     1334    14238    5                      ILL$ -> USER_CALL.ALTRET$ = ADDR (NIL) ;

  14238 22 006156   000000 236000 23                 LDQ     0
        22 006157   000000 470400 15                 LDP0    ILL$
        22 006160   000004 756100                    STQ     4,,PR0

     1335    14239    5                    END ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:222  
     1336    14240    4                  END ;

  14240 22 006161   006173 710000 22                 TRA     s:14244

     1337    14241    4                  WHENALTRETURN DO ;

     1338    14242    4                    CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> USER_CALL.ALTRET$),

  14242 22 006162   000000 236000 15                 LDQ     ILL$
        22 006163   000004 036003                    ADLQ    4,DU
        22 006164   000121 756000 0                  STQ     @INTDEF$$+22
        22 006165   000046 236000 23                 LDQ     38
        22 006166   000056 756000 0                  STQ     @REF_PTR$+1
        22 006167   000121 630400 0                  EPPR0   @INTDEF$$+22
        22 006170   000055 450400 0                  STP0    @LBL_SYM$+2
        22 006171   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 006172   000000 011000                    NOP     0

     1339    14243    4                        TRUE) ;
     1340    14244    4                  END ;

  14244 22 006173   006524 710000 22                 TRA     s:14504

     1341    14245                     %IF GCOS ;
     1354    14258                     %ENDIF ;
     1355    14259        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:223  
     1356    14260    3              CASE (%OS_CALL) ;

     1357    14261        /*V*
     1358    14262            OS_CALL -- If CALL identifier or CANCEL then plug in the CSIB pointer.
     1359    14263                       For CANCEL literal also see if it can be satisfied by an
     1360    14264                       internal program. If so, replace the CONST pointer with a
     1361    14265                       pointer to the INTDEF and change the ILL.CODE value.
     1362    14266                       If there is an ON OVERFLOW clause then resolve the address.
     1363    14267        */
     1364    14268    4                IF CURRENT_PROC$ = ADDR (NIL) THEN DO ; /* Can't happen case */

  14268 22 006174   000025 236000 0                  LDQ     CURRENT_PROC$
        22 006175   000000 116000 23                 CMPQ    0
        22 006176   006207 601000 22                 TNZ     s:14274

     1365    14269    4                  IF ILL$ -> OS_CALL.CODE ~= %OP_CLOSE_CANCEL THEN

  14269 22 006177   100000 720100                    LXL0    0,,PR1
        22 006200   000052 100003                    CMPX0   42,DU
        22 006201   006206 600000 22                 TZE     s:14272

     1366    14270                         /* Except, for this CODE value, it can. */
     1367    14271    4                    CALL Z8AE$ERROR (%E$UNEXPECTED_CASE) ;

  14271 22 006202   000020 630400 23                 EPPR0   16
        22 006203   000001 631400 23                 EPPR1   1
        22 006204   000000 701000 xent               TSX1    Z8AE$ERROR
        22 006205   000000 011000                    NOP     0

     1368    14272    4                  EXIT CASE_STMT ;

  14272 22 006206   006524 710000 22                 TRA     s:14504

     1369    14273    4                END ;
     1370    14274    3                IF ILL$ -> OS_CALL.CODE = %OP_CALL_ID /* CALL identifier */

  14274 22 006207   100000 720100                    LXL0    0,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:224  
        22 006210   000057 100003                    CMPX0   47,DU
        22 006211   006226 601000 22                 TNZ     s:14281

     1371    14275    4                  THEN DO ;

     1372    14276    4                    O2COM.CALL_ID = TRUE ;

  14276 22 006212   400000 236003                    LDQ     -131072,DU
        22 006213   000011 756000 12                 STQ     O2COM+9

     1373    14277    4                    TEMP_UBIN = ILL$ -> OS_CALL.LOP -> ARGLIST.N - 2 ;

  14277 22 006214   100001 473500                    LDP3    1,,PR1
        22 006215   300000 236100                    LDQ     0,,PR3
        22 006216   777777 376007                    ANQ     -1,DL
        22 006217   000002 136007                    SBLQ    2,DL
        22 006220   000032 756000 0                  STQ     TEMP_UBIN

     1374    14278    4                    ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (TEMP_UBIN) =

  14278 22 006221   000025 474400 0                  LDP4    CURRENT_PROC$
        22 006222   400005 236100                    LDQ     5,,PR4
        22 006223   000032 720000 0                  LXL0    TEMP_UBIN
        22 006224   300001 756110                    STQ     1,X0,PR3

     1375    14279    4                        CURRENT_PROC$ -> PROC_.CSIB$ ;
     1376    14280    4                  END ;

  14280 22 006225   006513 710000 22                 TRA     s:14484

     1377    14281    4                ELSE IF ILL$ -> OS_CALL.CODE = %OP_CANCEL THEN DO ;

  14281 22 006226   000063 100003                    CMPX0   51,DU
        22 006227   006513 601000 22                 TNZ     s:14484

     1378    14282    4                  ETT$ = ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (0) ;

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:225  
  14282 22 006230   100001 473500                    LDP3    1,,PR1
        22 006231   300001 236100                    LDQ     1,,PR3
        22 006232   000000 756000 6                  STQ     ETT$

     1379    14283    4                  ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (1) =

  14283 22 006233   000025 474400 0                  LDP4    CURRENT_PROC$
        22 006234   400005 236100                    LDQ     5,,PR4
        22 006235   300002 756100                    STQ     2,,PR3

     1380    14284    4                      CURRENT_PROC$ -> PROC_.CSIB$ ;
     1381    14285    4                  IF ETT$ -> ETT.ID = %TRIAD /* CANCEL literal */ THEN

  14285 22 006236   000000 473400 6                  LDP3    ETT$
        22 006237   300000 220100                    LDX0    0,,PR3
        22 006240   000015 100003                    CMPX0   13,DU
        22 006241   006513 601000 22                 TNZ     s:14484

     1382    14286    4                    CALL SEARCH_FOR_INTDEF (ETT$ -> ETT.LOP -> CONST.DNT$, TEMP$)

  14286 22 006242   300001 475500                    LDP5    1,,PR3
        22 006243   000053 236000 23                 LDQ     43
        22 006244   000073 756000 0                  STQ     @DNT$$+1
        22 006245   500006 636500                    EPPR6   6,,PR5
        22 006246   000072 456400 0                  STP6    @REF_PTR$+2
        22 006247   004660 701000 22                 TSX1    SEARCH_FOR_INTDEF
        22 006250   006323 702000 22                 TSX2    s:14386

     1383    14287    5                      WHENRETURN DO ;

     1384    14288    5                        TEMP$ -> INTDEF.PROC$ -> PROC_.B.CANCELED = TRUE ;

  14288 22 006251   000031 470400 0                  LDP0    TEMP$
        22 006252   000011 471500                    LDP1    9,,PR0
        22 006253   100000 236003                    LDQ     32768,DU
        22 006254   100003 256100                    ORSQ    3,,PR1

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:226  
     1385    14289                             %NEW_ARGLIST (@POINTER=ILL$ -> OS_CALL.LOP) ;

  14291 22 006255   000002 235007                    LDA     2,DL
        22 006256   000000 755000 1                  STA     ITERATION

  14368 22 006257   000002 236000 11                 LDQ     LTS_+2
        22 006260   000000 036000 1                  ADLQ    ITERATION
        22 006261   000003 116000 11                 CMPQ    LTS_+3
        22 006262   006273 604000 22                 TMI     s:14370

  14369 22 006263   000044 236000 23                 LDQ     36
        22 006264   000074 756000 0                  STQ     @INTDEF$$+1
        22 006265   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 006266   000075 450400 0                  STP0    @INTDEF$$+2
        22 006267   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 006270   000001 631400 23                 EPPR1   1
        22 006271   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 006272   000000 011000                    NOP     0

  14370 22 006273   000002 236000 11                 LDQ     LTS_+2
        22 006274   000022 736000                    QLS     18
        22 006275   000001 036000 11                 ADLQ    LTS_+1
        22 006276   000000 470400 15                 LDP0    ILL$
        22 006277   000001 756100                    STQ     1,,PR0

  14371 22 006300   000002 236000 11                 LDQ     LTS_+2
        22 006301   000000 036000 1                  ADLQ    ITERATION
        22 006302   000002 756000 11                 STQ     LTS_+2

  14372 22 006303   000001 471500                    LDP1    1,,PR0
        22 006304   001112 220003                    LDX0    586,DU
        22 006305   100000 740100                    STX0    0,,PR1

  14374 22 006306   000000 470400 15                 LDP0    ILL$
        22 006307   000001 471500                    LDP1    1,,PR0
        22 006310   000000 721000 1                  LXL1    ITERATION
        22 006311   100000 441100                    SXL1    0,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:227  

     1386    14380                             /* Default # of args = 1 and that's what we need. */
     1387    14381    5                        ILL$ -> OS_CALL.LOP -> ARGLIST.ARG$ (0) =

  14381 22 006312   000000 470400 15                 LDP0    ILL$
        22 006313   000001 471500                    LDP1    1,,PR0
        22 006314   000031 473400 0                  LDP3    TEMP$
        22 006315   300011 474500                    LDP4    9,,PR3
        22 006316   400005 236100                    LDQ     5,,PR4
        22 006317   100001 756100                    STQ     1,,PR1

     1388    14382    5                            TEMP$ -> INTDEF.PROC$ -> PROC_.CSIB$ ;
     1389    14383    5                        ILL$ -> OS_CALL.CODE = %OP_CANCEL_INT ;

  14383 22 006320   000061 221003                    LDX1    49,DU
        22 006321   000000 441100                    SXL1    0,,PR0

     1390    14384    5                      END ;

  14384 22 006322   006513 710000 22                 TRA     s:14484

     1391    14385    5                      WHENALTRETURN DO ;

     1392    14386    5                        SYMREF$$ = COMCOM.SYMREF$ ;

  14386 22 006323   000436 236000 xsym               LDQ     COMCOM+286
        22 006324   000024 756000 0                  STQ     SYMREF$$

     1393    14387    6                        DO UNTIL SYMREF$$ = ADDR (NIL) ;

     1394    14388    6                          IF SYMREF$$ -> SYMREF_.DNT$ = ETT$ -> ETT.LOP -> CONST.DNT$

  14388 22 006325   000000 470400 6                  LDP0    ETT$
        22 006326   000001 471500                    LDP1    1,,PR0
        22 006327   000024 473400 0                  LDP3    SYMREF$$
        22 006330   300006 236100                    LDQ     6,,PR3
        22 006331   100006 116100                    CMPQ    6,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:228  
        22 006332   006335 601000 22                 TNZ     s:14394

     1395    14389    7                            THEN /* SYMREF_ already exists */ DO ;

     1396    14390    7                              SYMREF$$ -> SYMREF_.REF_COUNT =

  14390 22 006333   300010 054100                    AOS     8,,PR3

     1397    14391    7                                  SYMREF$$ -> SYMREF_.REF_COUNT + 1 ;
     1398    14392    7                              EXIT CASE_STMT ;

  14392 22 006334   006524 710000 22                 TRA     s:14504

     1399    14393    7                            END ;
     1400    14394    7                          IF SYMREF$$ -> SYMREF_.NEXT = ADDR (NIL) THEN DO ;

  14394 22 006335   300004 236100                    LDQ     4,,PR3
        22 006336   000000 116000 23                 CMPQ    0
        22 006337   006506 601000 22                 TNZ     s:14480

     1401    14395                                 %FIND_LINE_NO ;

  14397 22 006340   000000 236000 17                 LDQ     ILS$
        22 006341   000004 756000 12                 STQ     O2COM+4

  14398 22 006342   000004 471400 12                 LDP1    O2COM+4
        22 006343   100003 474500                    LDP4    3,,PR1
        22 006344   400000 220100                    LDX0    0,,PR4
        22 006345   000373 100003                    CMPX0   251,DU
        22 006346   006362 600000 22                 TZE     s:14407

  14402 22 006347   000004 470400 12                 LDP0    O2COM+4
        22 006350   000002 236100                    LDQ     2,,PR0
        22 006351   000004 756000 12                 STQ     O2COM+4

  14405 22 006352   000004 470400 12                 LDP0    O2COM+4
        22 006353   000003 236100                    LDQ     3,,PR0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:229  
        22 006354   000000 116000 23                 CMPQ    0
        22 006355   006347 600000 22                 TZE     s:14402

  14406 22 006356   000003 471500                    LDP1    3,,PR0
        22 006357   100000 220100                    LDX0    0,,PR1
        22 006360   000373 100003                    CMPX0   251,DU
        22 006361   006347 601000 22                 TNZ     s:14402

  14407 22 006362   000004 470400 12                 LDP0    O2COM+4
        22 006363   000003 471500                    LDP1    3,,PR0
        22 006364   100000 236100                    LDQ     0,,PR1
        22 006365   777777 376007                    ANQ     -1,DL
        22 006366   000133 756000 xsym               STQ     COMCOM+91

  14408 22 006367   000003 471500                    LDP1    3,,PR0
        22 006370   100002 236100                    LDQ     2,,PR1
        22 006371   777777 376007                    ANQ     -1,DL
        22 006372   000134 756000 xsym               STQ     COMCOM+92

     1402    14411                                 %NEW_SYMREF_ (@ST$ = SYMREF$$ -> SYMREF_.NEXT,
     1403    14412                                   @R     = %EXT_PROGRAM,
     1404    14413                                   @DNT$ = ETT$ -> ETT.LOP -> CONST.DNT$,
     1405    14414                                   @PROC$ = CURRENT_PROC$ ) ;

  14418 22 006373   000002 236000 14                 LDQ     ST_+2
        22 006374   000013 036007                    ADLQ    11,DL
        22 006375   000003 116000 14                 CMPQ    ST_+3
        22 006376   006407 604000 22                 TMI     s:14420

  14419 22 006377   000035 236000 23                 LDQ     29
        22 006400   000074 756000 0                  STQ     @INTDEF$$+1
        22 006401   000074 631400 0                  EPPR1   @INTDEF$$+1
        22 006402   000075 451400 0                  STP1    @INTDEF$$+2
        22 006403   000075 630400 0                  EPPR0   @INTDEF$$+2
        22 006404   000001 631400 23                 EPPR1   1
        22 006405   000000 701000 xent               TSX1    Z8AR$RESERVER
        22 006406   000000 011000                    NOP     0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:230  

  14420 22 006407   000002 236000 14                 LDQ     ST_+2
        22 006410   000022 736000                    QLS     18
        22 006411   000001 036000 14                 ADLQ    ST_+1
        22 006412   000024 470400 0                  LDP0    SYMREF$$
        22 006413   000004 756100                    STQ     4,,PR0

  14421 22 006414   000013 236007                    LDQ     11,DL
        22 006415   000002 056000 14                 ASQ     ST_+2

  14424 22 006416   000004 471500                    LDP1    4,,PR0
        22 006417   000772 220003                    LDX0    506,DU
        22 006420   100000 740100                    STX0    0,,PR1

  14425 22 006421   000004 471500                    LDP1    4,,PR0
        22 006422   002000 236007                    LDQ     1024,DL
        22 006423   100000 552110                    STBQ    0,'10'O,PR1

  14426 22 006424   000004 471500                    LDP1    4,,PR0
        22 006425   000000 236003                    LDQ     0,DU
        22 006426   100000 552104                    STBQ    0,'04'O,PR1

  14427 22 006427   000004 471500                    LDP1    4,,PR0
        22 006430   000001 235007                    LDA     1,DL
        22 006431   100010 755100                    STA     8,,PR1

  14428 22 006432   000004 471500                    LDP1    4,,PR0
        22 006433   000020 221003                    LDX1    16,DU
        22 006434   100002 741100                    STX1    2,,PR1

  14429 22 006435   000004 471500                    LDP1    4,,PR0
        22 006436   000133 722000 xsym               LXL2    COMCOM+91
        22 006437   100002 442100                    SXL2    2,,PR1

  14430 22 006440   000004 471500                    LDP1    4,,PR0
        22 006441   000000 236000 23                 LDQ     0
        22 006442   100004 756100                    STQ     4,,PR1
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:231  

  14431 22 006443   000004 471500                    LDP1    4,,PR0
        22 006444   100003 450100                    STZ     3,,PR1

  14433 22 006445   000004 471500                    LDP1    4,,PR0
        22 006446   000001 236007                    LDQ     1,DL
        22 006447   100003 256100                    ORSQ    3,,PR1

  14435 22 006450   000004 471500                    LDP1    4,,PR0
        22 006451   000000 473400 6                  LDP3    ETT$
        22 006452   300001 474500                    LDP4    1,,PR3
        22 006453   400006 236100                    LDQ     6,,PR4
        22 006454   100006 756100                    STQ     6,,PR1

  14439 22 006455   000004 471500                    LDP1    4,,PR0
        22 006456   000000 236000 23                 LDQ     0
        22 006457   100012 756100                    STQ     10,,PR1

  14458 22 006460   000004 471500                    LDP1    4,,PR0
        22 006461   000025 236000 0                  LDQ     CURRENT_PROC$
        22 006462   100011 756100                    STQ     9,,PR1

  14459 22 006463   000000 116000 23                 CMPQ    0
        22 006464   006506 600000 22                 TZE     s:14480

  14463 22 006465   000025 471400 0                  LDP1    CURRENT_PROC$
        22 006466   100001 474500                    LDP4    1,,PR1
        22 006467   400012 236100                    LDQ     10,,PR4
        22 006470   000000 116000 23                 CMPQ    0
        22 006471   006500 601000 22                 TNZ     s:14470

  14465 22 006472   000004 236100                    LDQ     4,,PR0
        22 006473   400011 756100                    STQ     9,,PR4

  14466 22 006474   100001 474500                    LDP4    1,,PR1
        22 006475   000004 236100                    LDQ     4,,PR0
        22 006476   400012 756100                    STQ     10,,PR4
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:232  

  14467 22 006477   006506 710000 22                 TRA     s:14480

  14470 22 006500   400012 475500                    LDP5    10,,PR4
        22 006501   000004 236100                    LDQ     4,,PR0
        22 006502   500012 756100                    STQ     10,,PR5

  14471 22 006503   100001 474500                    LDP4    1,,PR1
        22 006504   000004 236100                    LDQ     4,,PR0
        22 006505   400012 756100                    STQ     10,,PR4

     1406    14479    7                          END ;

     1407    14480    6                          SYMREF$$ = SYMREF$$ -> SYMREF_.NEXT ;

  14480 22 006506   000024 470400 0                  LDP0    SYMREF$$
        22 006507   000004 236100                    LDQ     4,,PR0
        22 006510   000024 756000 0                  STQ     SYMREF$$

     1408    14481    6                        END ;

  14481 22 006511   000000 116000 23                 CMPQ    0
        22 006512   006325 601000 22                 TNZ     s:14388

     1409    14482    5                      END ;

     1410    14483    4                END ;

     1411    14484    3                CALL REFERENCE_RESOLUTION (ADDR (ILL$ -> OS_CALL.ALTRET$), TRUE) ;

  14484 22 006513   000000 236000 15                 LDQ     ILL$
        22 006514   000004 036003                    ADLQ    4,DU
        22 006515   000122 756000 0                  STQ     @INTDEF$$+23
        22 006516   000046 236000 23                 LDQ     38
        22 006517   000056 756000 0                  STQ     @REF_PTR$+1
        22 006520   000122 630400 0                  EPPR0   @INTDEF$$+23
        22 006521   000055 450400 0                  STP0    @LBL_SYM$+2
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:233  
        22 006522   000715 701000 22                 TSX1    REFERENCE_RESOLUTION
        22 006523   000000 011000                    NOP     0

     1412    14485                     %IF GCOS ;
     1427    14500                     %ENDIF ;
     1428    14501
     1429    14502    3            END ; /* CASE_STMT */

     1430    14503
     1431    14504    2            ILS$ = ILL$ -> ILL.BRANCH$ ;

  14504 22 006524   000000 470400 15                 LDP0    ILL$
        22 006525   000003 236100                    LDQ     3,,PR0
        22 006526   000000 756000 17                 STQ     ILS$

     1432    14505    2          END ;

  14505 22 006527   000000 236000 17                 LDQ     ILS$
        22 006530   000000 116000 23                 CMPQ    0
        22 006531   004747 601000 22                 TNZ     s:13805

     1433    14506        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:234  
     1434    14507        /*V*
     1435    14508            DELETE_SATISFIED_SYMREFS -- For all SYMREFs check, if all references are
     1436    14509                                        satisfied then delete the SYMREF from the
     1437    14510                                        chain.
     1438    14511        */
     1439    14512    1          TEMP$ = ADDR (COMCOM.SYMREF$) ;

  14512 22 006532   000054 236000 23                 LDQ     44
        22 006533   000031 756000 0                  STQ     TEMP$

     1440    14513    2          DO WHILE TEMP$ -> BASED$PTR$ ~= ADDR (NIL) ;

  14513 22 006534   006546 710000 22                 TRA     s:14519

     1441    14514    2            IF TEMP$ -> BASED$PTR$ -> SYMREF_.REF_COUNT = 0 THEN

  14514 22 006535   000031 470400 0                  LDP0    TEMP$
        22 006536   000000 471500                    LDP1    0,,PR0
        22 006537   100010 235100                    LDA     8,,PR1
        22 006540   006544 601000 22                 TNZ     s:14518

     1442    14515    2              TEMP$ -> BASED$PTR$ = TEMP$ -> BASED$PTR$ -> SYMREF_.NEXT ;

  14515 22 006541   100004 236100                    LDQ     4,,PR1
        22 006542   000000 756100                    STQ     0,,PR0
        22 006543   006546 710000 22                 TRA     s:14519

     1443    14516                   /* Unlink from chain as all references are satisfied already. */
     1444    14517    2            ELSE
     1445    14518    2              TEMP$ = ADDR (TEMP$ -> BASED$PTR$ -> SYMREF_.NEXT) ;

  14518 22 006544   100004 633500                    EPPR3   4,,PR1
        22 006545   000031 453400 0                  STP3    TEMP$

     1446    14519    2          END ;

  14519 22 006546   000031 470400 0                  LDP0    TEMP$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:235  
        22 006547   000000 236100                    LDQ     0,,PR0
        22 006550   000000 116000 23                 CMPQ    0
        22 006551   006535 601000 22                 TNZ     s:14514

     1447    14520
     1448    14521    1          TEMP$ = COMCOM.SYMREF$;

  14521 22 006552   000436 236000 xsym               LDQ     COMCOM+286
        22 006553   000031 756000 0                  STQ     TEMP$

     1449    14522    1          COMCOM.SYMREFC = 0;

  14522 22 006554   000437 450000 xsym               STZ     COMCOM+287

     1450    14523    2          DO WHILE TEMP$ ~= ADDR(NIL);

  14523 22 006555   006565 710000 22                 TRA     s:14529

     1451    14524
     1452    14525    2            COMCOM.SYMREFC = COMCOM.SYMREFC + 1;

  14525 22 006556   000437 054000 xsym               AOS     COMCOM+287

     1453    14526    2            TEMP$ -> SYMREF_.COUNT = COMCOM.SYMREFC;

  14526 22 006557   000031 470400 0                  LDP0    TEMP$
        22 006560   000437 236000 xsym               LDQ     COMCOM+287
        22 006561   000000 552104                    STBQ    0,'04'O,PR0

     1454    14527    2            TEMP$ = TEMP$ -> SYMREF_.NEXT;

  14527 22 006562   000031 470400 0                  LDP0    TEMP$
        22 006563   000004 236100                    LDQ     4,,PR0
        22 006564   000031 756000 0                  STQ     TEMP$

     1455    14528
     1456    14529    2          END;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:236  

  14529 22 006565   000000 116000 23                 CMPQ    0
        22 006566   006556 601000 22                 TNZ     s:14525

     1457    14530        %EJECT;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:237  
     1458    14531        /*V*
     1459    14532            DUPLICATE_ENTRY_CHECK -- For each ENTRY specified on the PROCEDURE
     1460    14533                                     DIVISION statement, if it is satisfied by more
     1461    14534                                     than one SECTION header then issue an error
     1462    14535                                     message.
     1463    14536        */
     1464    14537    1          ILS$ = COMCOM.H_ENTRY$ ;

  14537 22 006567   000423 236000 xsym               LDQ     COMCOM+275
        22 006570   000000 756000 17                 STQ     ILS$

     1465    14538    2          DO WHILE ILS$ ~= ADDR (NIL) ;

  14538 22 006571   006675 710000 22                 TRA     s:14568

     1466    14539    2            ILL$ = ILS$ -> ILS.ILL$ ;

  14539 22 006572   000000 470400 17                 LDP0    ILS$
        22 006573   000003 236100                    LDQ     3,,PR0
        22 006574   000000 756000 15                 STQ     ILL$

     1467    14540    3            IF ILL$ -> ENTRY_ILL.CODE = %SUBROUTINE_ENTRY THEN DO ;

  14540 22 006575   000000 471400 15                 LDP1    ILL$
        22 006576   100000 720100                    LXL0    0,,PR1
        22 006577   000002 100003                    CMPX0   2,DU
        22 006600   006672 601000 22                 TNZ     s:14567

     1468    14541    3              SYMDEF$$ = ILL$ -> ENTRY_ILL.LOP ;

  14541 22 006601   100001 236100                    LDQ     1,,PR1
        22 006602   000024 756000 0                  STQ     SYMREF$$

     1469    14542    3              LABEL_REFERENCE$ = SYMDEF$$ -> SYMDEF_.DNT$ -> DNT.ST$ ;

  14542 22 006603   000024 473400 0                  LDP3    SYMREF$$
        22 006604   300006 474500                    LDP4    6,,PR3
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:238  
        22 006605   400001 236100                    LDQ     1,,PR4
        22 006606   000033 756000 0                  STQ     LABEL_REFERENCE$

     1470    14543                   /* Will be ADDR (NIL) for main entry point. */
     1471    14544    3   CHECK_ENTRY:
     1472    14545    4              DO WHILE LABEL_REFERENCE$ ~= ADDR (NIL) ;

  14545 22 006607   006670 710000 22    CHECK_ENTRY  TRA     s:14565

     1473    14546    4                IF LABEL_REFERENCE$ -> ST.ID = %SECTION THEN

  14546 22 006610   000033 470400 0                  LDP0    LABEL_REFERENCE$
        22 006611   000000 220100                    LDX0    0,,PR0
        22 006612   000770 100003                    CMPX0   504,DU
        22 006613   006666 601000 22                 TNZ     s:14564

     1474    14547    4                  IF LABEL_REFERENCE$ -> SECTION.PROC$ = SYMDEF$$ -> SYMDEF_.PROC$

  14547 22 006614   000024 471400 0                  LDP1    SYMREF$$
        22 006615   000011 236100                    LDQ     9,,PR0
        22 006616   100011 116100                    CMPQ    9,,PR1
        22 006617   006666 601000 22                 TNZ     s:14564

     1475    14548    5                    THEN IF LABEL_REFERENCE$ -> SECTION.B.DUPLICATE THEN DO;

  14548 22 006620   000003 236100                    LDQ     3,,PR0
        22 006621   020000 316003                    CANQ    8192,DU
        22 006622   006666 600000 22                 TZE     s:14564

     1476    14549    5                      TEMP$ = ILL$ ;

  14549 22 006623   000000 236000 15                 LDQ     ILL$
        22 006624   000031 756000 0                  STQ     TEMP$

     1477    14550    6                      DO UNTIL TEMP$ -> ENTRY_ILL.CODE ~= %SUBROUTINE_ENTRY ;

     1478    14551    6                        TEMP_ILS$ = TEMP$ -> ENTRY_ILL.PREV_ENTRY_ILS$ ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:239  

  14551 22 006625   000031 470400 0                  LDP0    TEMP$
        22 006626   000003 236100                    LDQ     3,,PR0
        22 006627   000017 756000 0                  STQ     TEMP_ILS$

     1479    14552    6                        TEMP$ = TEMP_ILS$ -> ILS.ILL$ ;

  14552 22 006630   000017 471400 0                  LDP1    TEMP_ILS$
        22 006631   100003 236100                    LDQ     3,,PR1
        22 006632   000031 756000 0                  STQ     TEMP$

     1480    14553    6                      END ;

  14553 22 006633   000031 470400 0                  LDP0    TEMP$
        22 006634   000000 720100                    LXL0    0,,PR0
        22 006635   000002 100003                    CMPX0   2,DU
        22 006636   006625 600000 22                 TZE     s:14551

     1481    14554                           %NEXT_ILS (POINTER = TEMP_ILS$) ;

  14556 22 006637   100002 236100                    LDQ     2,,PR1
        22 006640   000017 756000 0                  STQ     TEMP_ILS$

     1482    14559    5                      COMCOM.CURRENT.LINE = TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_LINE ;

  14559 22 006641   000017 471400 0                  LDP1    TEMP_ILS$
        22 006642   100003 473500                    LDP3    3,,PR1
        22 006643   300000 236100                    LDQ     0,,PR3
        22 006644   777777 376007                    ANQ     -1,DL
        22 006645   000133 756000 xsym               STQ     COMCOM+91

     1483    14560    5                     COMCOM.CURRENT.COLUMN = TEMP_ILS$ -> ILS.ILL$ -> LINOI.PREV_COL ;

  14560 22 006646   100003 473500                    LDP3    3,,PR1
        22 006647   300002 236100                    LDQ     2,,PR3
        22 006650   777777 376007                    ANQ     -1,DL
        22 006651   000134 756000 xsym               STQ     COMCOM+92
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:240  

     1484    14561    5                      CALL Z8AE$ERROR (%E$DUP_LABEL,,, SYMDEF$$ -> SYMDEF_.DNT$) ;

  14561 22 006652   000024 236000 0                  LDQ     SYMREF$$
        22 006653   000006 036003                    ADLQ    6,DU
        22 006654   000000 235000 23                 LDA     0
        22 006655   000076 757000 0                  STAQ    @INTDEF$$+3
        22 006656   000000 236000 23                 LDQ     0
        22 006657   000016 235000 23                 LDA     14
        22 006660   000074 757000 0                  STAQ    @INTDEF$$+1
        22 006661   000074 630400 0                  EPPR0   @INTDEF$$+1
        22 006662   000014 631400 23                 EPPR1   12
        22 006663   000000 701000 xent               TSX1    Z8AE$ERROR
        22 006664   000000 011000                    NOP     0

     1485    14562    5                      EXIT CHECK_ENTRY ;

  14562 22 006665   006672 710000 22                 TRA     s:14567

     1486    14563    5                    END ;
     1487    14564    4                LABEL_REFERENCE$ = LABEL_REFERENCE$ -> ST.NEXT ;

  14564 22 006666   000004 236100                    LDQ     4,,PR0
        22 006667   000033 756000 0                  STQ     LABEL_REFERENCE$

     1488    14565    4              END ;

  14565 22 006670   000000 116000 23                 CMPQ    0
        22 006671   006610 601000 22                 TNZ     s:14546

     1489    14566    3            END ;

     1490    14567    2            ILS$ = ILL$ -> ENTRY_ILL.PREV_ENTRY_ILS$ ;

  14567 22 006672   000000 470400 15                 LDP0    ILL$
        22 006673   000003 236100                    LDQ     3,,PR0
        22 006674   000000 756000 17                 STQ     ILS$
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:241  

     1491    14568    2          END ;

  14568 22 006675   000000 116000 23                 CMPQ    0
        22 006676   006572 601000 22                 TNZ     s:14539

     1492    14569        %EJECT ;
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:242  
     1493    14570        /*V*
     1494    14571            WALK_FILE_LTS_CHAIN -- Check all elements in the file lts chain. If any
     1495    14572                                   reference USE procedures then resolve the
     1496    14573                                   USE procedure references.
     1497    14574        */
     1498    14575    1          LTS$ = COMCOM.USE_PROC_CHAIN$ ;

  14575 22 006677   000476 236000 xsym               LDQ     COMCOM+318
        22 006700   000000 756000 10                 STQ     LTS$

     1499    14576    2          DO WHILE LTS$ ~= ADDR (NIL) ;

  14576 22 006701   006714 710000 22                 TRA     s:14583

     1500    14577    2            CALL CHECK_USE_PROC (ADDR (LTS$ -> USE.PROC_LABEL$));

  14577 22 006702   000000 236000 10                 LDQ     LTS$
        22 006703   000002 036003                    ADLQ    2,DU
        22 006704   000123 756000 0                  STQ     @INTDEF$$+24
        22 006705   000123 630400 0                  EPPR0   @INTDEF$$+24
        22 006706   000070 450400 0                  STP0    LINOI$+2
        22 006707   004573 701000 22                 TSX1    CHECK_USE_PROC
        22 006710   000000 011000                    NOP     0

     1501    14578                 /* Actually the USE procedure is referenced by CALL, not GOTO,
     1502    14579                    but to Phase 2 there is no difference. If the same procedure is
     1503    14580                    the object of a PERFORM then that PERFORM must not be
     1504    14581                    optimized. */
     1505    14582    2            LTS$ = LTS$ -> USE.PROC_CHAIN$ ;

  14582 22 006711   000000 470400 10                 LDP0    LTS$
        22 006712   000001 236100                    LDQ     1,,PR0
        22 006713   000000 756000 10                 STQ     LTS$

     1506    14583    2          END ;

  14583 22 006714   000000 116000 23                 CMPQ    0
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:243  
        22 006715   006702 601000 22                 TNZ     s:14577

     1507    14584    1   END Z8FL$LABEL_REFERENCE ;

  14584 22 006716   000000 221200 0                  LDX1  ! 0
        22 006717   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:244  
--  Include file information  --

   Z8A_XREF.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_MKCN.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LIBRARY.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ILL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_TYPES.:Z8A6TOU  is referenced.
   Z8A_ST.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8F_O2COM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_LTS.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ETT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_ERR_NUMS.:Z8A6TOU  is referenced.
   Z8A_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8A_COMCOM.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   X8A_COM_MACS.:X8A6TOU  is referenced.
   Z8A_NAMES.:Z8A6TOU  is referenced.
   Z8A_SUPP_MAC.:Z8A6TOU  is referenced.
   Z8A_DEFC.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure Z8FL$LABEL_REFERENCE.
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:245  

 **** Variables and constants ****

  ****  Section 000  Data  Z8FL$LABEL_REFERENCE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/w PTR         r     1 @ALTER_LBL$               72-0-0/w PTR         r     1 @DNT$$
    56-0-0/w PTR         r     1 @GOTO_DEST                73-0-0/w PTR         r     1 @INTDEF$$
    53-0-0/w PTR         r     1 @LBL_SYM$                 45-0-0/w PTR         r     1 @POINTER$
    43-0-0/w PTR         r     1 @PREV_ENTRY$              51-0-0/w PTR         r     1 @PREV_ENTRY$
    55-0-0/w PTR         r     1 @REF_PTR$                 70-0-0/w PTR         r     1 @REF_PTR$
    64-0-0/w PTR         r     1 ALTER_ILS$                *0-0-0/w PTR         r     1 ALTER_LBL$
    60-0-0/b BIT         r     1 BAD_REFERENCE             25-0-0/w PTR         r     1 CURRENT_PROC$
    27-0-0/w PTR         r     1 CURRENT_SCOPE$            *0-0-0/w PTR         r     1 DNT$$
    34-0-0/w BIT         r     1 DUPLICATE_LBL             14-0-0/w PTR         r     1 END_ILS$
    12-0-0/w PTR         r     1 END_LBL_SYM$              13-0-0/w PTR               1 END_TEMP$
    36-0-0/w SBIN        r     1 ERR_COL                   37-0-0/w PTR         r     1 ERR_DNT$
    35-0-0/w SBIN        r     1 ERR_LINE                  23-0-0/w PTR         r     1 FATHER$
    21-0-0/w PTR         r     1 FIRST_LBL$                *0-0-0/w BIT         r     1 GOTO_DEST
    63-0-0/w PTR         r     1 GO_ILS$                   30-0-0/w PTR         r     1 INIT_LINOI$
    *0-0-0/w PTR         r     1 INTDEF$$                  61-0-0/b BIT         r     1 ITEM_NOT_ETT
    33-0-0/w PTR         r     1 LABEL_REFERENCE$          *0-0-0/w PTR         r     1 LBL_SYM$
    66-0-0/w PTR         r     1 LINOI$                    40-0-0/w PTR         r     1 LTS$$
     1-0-0/w STRC(324)         1 NAME                      *0-0-0/w PTR         r     1 POINTER$
    22-0-0/w PTR               1 PRESET_ILS$               46-0-0/w PTR         r     1 PRESET_ILS$
    *0-0-0/w PTR         r     1 PREV_ENTRY$               *0-0-0/w PTR         r     1 PREV_ENTRY$
    16-0-0/w PTR         r     1 PREV_LBL$                 26-0-0/w PTR         r     1 PROC_SUPP$
    *0-0-0/w PTR         r     1 REF_PTR$                  *0-0-0/w PTR         r     1 REF_PTR$
    57-0-0/w PTR         r     1 REF_PTR$$                 41-0-0/w PTR         r     1 SEG_LTS$
    47-0-0/w SBIN        r     1 SEG_NO#                   15-0-0/w PTR         r     1 SRCH_LBL$
    20-0-0/w PTR         r     1 START_LBL$                24-0-0/w PTR         r     1 SYMDEF$$
    24-0-0/w PTR         r     1 SYMREF$$                  31-0-0/w PTR         r     1 TEMP$
    17-0-0/w PTR         r     1 TEMP_ILS$                 65-0-0/w PTR         r     1 TEMP_ILS$
    32-0-0/w UBIN        r     1 TEMP_UBIN

  ****  Section 001 LblCom ITERATION
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:246  

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ITERATION

  ****  Section 002 LblCom DNT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DNT$

  ****  Section 003 LblCom DNT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 DNT_

  ****  Section 004 LblCom DNT_BUCKET_NUMBER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 DNT_BUCKET_NUMBER

  ****  Section 005 LblCom DNT_OF_1$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 DNT_OF_1$

  ****  Section 006 LblCom ETT$

  ****  Scalars and arrays  ****
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:247  
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ETT$

  ****  Section 007 LblCom HEAD_ETT$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 HEAD_ETT$

  ****  Section 008 LblCom ETT_BUCKETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 ETT_BUCKETS(0:511)

  ****  Section 009 LblCom ETT_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)         1 ETT_

  ****  Section 010 LblCom LTS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR               1 LONG_ITEM$                 0-0-0/w PTR         r     1 LTS$

  ****  Section 011 LblCom LTS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:248  
     0-0-0/w STRC(180)   r     1 LTS_

  ****  Section 012 LblCom O2COM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 O2COM

  ****  Section 013 LblCom ST$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ST$

  ****  Section 014 LblCom ST_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ST_

  ****  Section 015 LblCom ILL$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILL$

  ****  Section 016 LblCom ILL_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILL_

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:249  
  ****  Section 017 LblCom ILS$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 ILS$

  ****  Section 018 LblCom ILS_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ILS_

  ****  Section 019 LblCom MKCN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 MKCN

  ****  Section 020 LblCom XREF$

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 XREF$

  ****  Section 021 LblCom XREF_

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 XREF_

  ****  SYMREF variables  ****

PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:250  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(13248) r     1 COMCOM                     0-0-0/w UBIN        r     1 ILL_STEP(0:144)
     0-0-0/w UBIN              1 ILS_STEP_TABLE(0:2)
     0-0-0/w UBIN              1 LTS_STEP(0:37)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(108)         1 ACCEPT_DISPLAY             0-0-0/w STRC(396)         1 ALPHABET
     0-0-0/w STRC(144)   r     1 ALTER_LTS                  0-0-0/w STRC(3672)        1 ALT_KEY
     0-0-0/w STRC(36864) r     1 ARGLIST                    0-0-0/w STRC(396)         1 ARRAY
     0-0-0/w STRC(180)         1 ARRAY_PRESET_LTS           0-0-0/w PTR         r     1 BASED$PTR$
     0-0-0/w STRC(288)         1 BASE_LTS                   0-0-0/w STRC(108)         1 BINARY_ILL
     0-0-0/w STRC(396)   r     1 BLOCK                      0-0-0/w STRC(144)         1 BRANCH_ILL
     0-0-0/w STRC(144)         1 BT                         0-0-0/w STRC(216)         1 CCOSU
     0-0-0/w STRC(396)         1 CD                         0-0-0/w STRC(288)         1 CD_LTS
     0-0-0/w CHAR(4096)        1 CHARS                      0-0-0/w STRC(396)         1 CLASS
     0-0-0/w STRC(108)         1 CODED_MOVE                 0-0-0/w STRC(396)         1 CONDITION
     0-0-0/w STRC(396)   r     1 CONST                      0-0-0/w STRC(72)          1 CONT
     0-0-0/w STRC(540)         1 CONTROL_NAME_LTS           0-0-0/w STRC(1872)        1 COPY_FILE
     0-0-0/w STRC(396)         1 DB                         0-0-0/w STRC(396)         1 DCB_
     0-0-0/w STRC(144)         1 DEFLB                      0-0-0/w STRC(108)         1 DEPENDING_SIZE
     0-0-0/w STRC(5472)        1 DIMS                       0-0-0/w STRC(396)         1 DML_ITEM
     0-0-0/w STRC(216)         1 DML_REC                    0-0-0/w ASTR(180)   r     1 DNT
     0-0-0/w STRC(144)         1 DOEND                      0-0-0/w STRC(396)         1 DO_N
     0-0-0/w STRC(180)         1 DV4I                       0-0-0/w STRC(180)   r     1 ENTRY_ILL
     0-0-0/w STRC(180)   r     1 ETT                        0-0-0/w STRC(108)         1 EVALU
     0-0-0/w STRC(73836)       1 EVALUATE                   0-0-0/w STRC(396)         1 FD
     0-0-0/w STRC(1692)        1 FILE_LTS                   0-0-0/w STRC(144)         1 GO
     0-0-0/w STRC(180)   r     1 ILL                        0-0-0/w STRC              1 ILL_NO_OPS
     0-0-0/w STRC(180)   r     1 ILS                        0-0-0/w STRC(108)         1 INDEXES
     0-0-0/w STRC(360)         1 INIT_LTS                   0-0-0/w STRC(396)   r     1 INTDEF
     0-0-0/w STRC(180)         1 IO_RESTORE_CHAIN           0-0-0/w STRC(144)         1 KEY
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:251  
     0-0-0/w STRC(396)   r     1 LABEL                      0-0-0/w STRC(36864)       1 LCNST
     0-0-0/w STRC(108)   r     1 LINOI                      0-0-0/w STRC(72)          1 LONG
     0-0-0/w STRC        r     1 LTS                        0-0-0/w STRC(360)         1 LTSS
     0-0-0/w STRC(36936)       1 LTS_PTR_ARRAY              0-0-0/w STRC(72)          1 MFILL
     0-0-0/w STRC(396)         1 MNEMONIC                   0-0-0/w STRC(180)   r     1 MULTI_GO
     0-0-0/w STRC(180)         1 MVEAL                      0-0-0/w STRC(108)         1 MVFIL
     0-0-0/w STRC(72)          1 MVIIS                      0-0-0/w STRC(144)         1 NEL
     0-0-0/w STRC(216)         1 OPEN_LTS                   0-0-0/w STRC(144)   r     1 OPN
     0-0-0/w STRC(180)   r     1 OS_CALL                    0-0-0/w STRC(36864)       1 PAGE
     0-0-0/w STRC(396)         1 PARA                       0-0-0/w STRC(216)         1 PFORM
     0-0-0/w STRC(144)         1 PINC                       0-0-0/w STRC(144)         1 PREOFF
     0-0-0/w STRC(108)         1 PRESET                     0-0-0/w STRC(144)         1 PRIME
     0-0-0/w STRC(396)   r     1 PROC_                      0-0-0/w STRC(396)         1 PROC_DEF
     0-0-0/w STRC(900)   r     1 PROC_SUPP                  0-0-0/w STRC(144)   r     1 P_A_PRESET
     0-0-0/w STRC(144)         1 P_P_PRESET                 0-0-0/w STRC(396)         1 RD
     0-0-0/w STRC(216)         1 REF                        0-0-0/w PTR         r     1 REF$ITEM$
     0-0-0/w PTR         r     1 REF$ITEM$                  0-0-0/w EPTR        r     1 REF$ITEM_EPTR
     0-0-0/w STRC(144)         1 REMEM                      0-0-0/w STRC(108)         1 RENAMES
     0-0-0/w STRC(720)         1 REPORT_01_LTS              0-0-0/w STRC(432)         1 REPORT_ELEM_LTS
     0-0-0/w STRC(252)         1 REPORT_GRP_LTS             0-0-0/w STRC(1332)        1 REPORT_LTS
     0-0-0/w STRC(144)         1 RVA_LTS                    0-0-0/w STRC(396)   r     1 SCALAR
     0-0-0/w STRC(144)   r     1 SCOPE                      0-0-0/w STRC(396)         1 SD
     0-0-0/w STRC(216)         1 SEARCH_                    0-0-0/w STRC(396)   r     1 SECTION
     0-0-0/w STRC(396)         1 SEGMENT                    0-0-0/w STRC(360)   r     1 SEGMENT_LTS
     0-0-0/w STRC(396)   r     1 ST                         0-0-0/w STRC(72)          1 STP2
     0-0-0/w STRC(252)         1 SUM_LTS                    0-0-0/w STRC(396)         1 SWITCH
     0-0-0/w STRC(396)         1 SYMBOLIC_CHAR              0-0-0/w STRC(396)   r     1 SYMDEF_
     0-0-0/w STRC(396)   r     1 SYMREF_                    0-0-0/w STRC(396)         1 TEMP
     0-0-0/w STRC(144)         1 TRINARY_ILL                0-0-0/w STRC(72)          1 UNARY_ILL
     0-0-0/d STRC(612)   r     1 USE                        0-0-0/w STRC(216)   r     1 USER_CALL
     0-0-0/w STRC(252)         1 USE_SUPP                   0-0-0/w STRC(108)         1 VAL
     0-0-0/w STRC(108)         1 VAL_END                    0-0-0/w STRC(396)   r     1 VARIABLE
     0-0-0/w STRC(72)          1 WHEN                       0-0-0/w STRC(72)    r     1 XREF


   Procedure Z8FL$LABEL_REFERENCE requires 3536 words for executable code.
PL6.E3A0      #001=Z8FL$LABEL_REFERENCE File=Z8FL.:Z8A6TSI                       SAT 08/09/97 13:08 Page:252  
   Procedure Z8FL$LABEL_REFERENCE is declared NOAUTO and requires 84 words of local(STATIC) storage.

    No errors detected in file Z8FL.:Z8A6TSI    .
