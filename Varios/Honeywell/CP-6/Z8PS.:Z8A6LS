VERSION A06

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:1    
        1        1         /*M* Z8PS - System independent module for PCA scanner and utilities */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7         /*P*
        8        8              NAME: Z8PS
        9        9              DESCRIPTION: System independent module for the scanner
       10       10                           and utilities routines. Some of the procedures
       11       11                           were derived from an example parser for LALR1 which
       12       12                           did not contain comments. I have continued this
       13       13                           this tradition in those procedures.
       14       14               */
       15       15         %EJECT;
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:2    
       16       16         STDSCANNER : PROC MAIN;
       17       17
       18       18         /*D*
       19       19              NAME: STDSCANNER
       20       20              CALL:
       21       21                    Main routine for the PSEUDO-CODE ASSEMBLER
       22       22              ENVIRONMENT:
       23       23                   LALR1 Parser
       24       24              INPUT:
       25       25                   Pseudo code program
       26       26              OUTPUT:
       27       27                   Pseudo code tables
       28       28         */
       29       29         %INCLUDE Z8A_SYS_FILE;
       30     6304         %INCLUDE SCDPDA_SUBS;
       31     6698         %INCLUDE Z8P_SCAN_EXT;
       32     6887
       33     6888         %DCBPTR (STCLASS=STATIC SYMDEF);
       34     6898         %IF GCOS;
       35     6899 C       %FPT_CLOSE(FPTN=CLOSE_LO,DCB=%M$LO);
       36     6900 C       %FPT_CLOSE(FPTN=CLOSE_DO,DCB=%M$DO);
       37     6901         %ENDIF;
       38     6902
       39     6903    1    DCL PARSER ENTRY;
       40     6904    1    DCL INIT_SCANNER ENTRY;
       41     6905    1    DCL OPEN_INPUT ENTRY;
       42     6906    1    DCL COMMAND_LINE_OPTIONS ENTRY;
       43     6907    1    DCL START ENTRY;
       44     6908    1    DCL Z9P1$INIT ENTRY;
       45     6909
       46     6910    1    DCL TERM_INTEGER SBIN WORD EXT;
       47     6911    1    DCL TERM_STRING_SYM SBIN WORD EXT;
       48     6912    1    DCL TERM_IDENTIFIER SBIN WORD EXT;
       49     6913    1    DCL TERM_EOF SBIN WORD EXT;
       50     6914    1    DCL TERM_EOL SBIN WORD EXT;
       51     6915    1    DCL TERM_LOCAL_LABEL SBIN WORD EXT;
       52     6916
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:3    
       53     6917    1    DCL I SBIN;
       54     6918
       55     6919    1    CALL Z9P1$INIT; /* CP6- or GCOS-specific initialization */
       56     6920
       57     6921    1    CALL START;
       58     6922
       59     6923    1    KEY_REC = '          ';
       60     6924    1    INSTR_LISTED = TRUE;
       61     6925         %SELECT_LO;
       62     6928    1    LINELEN = 0;
       63     6929
       64     6930    2    DO I = 0 TO 25;
       65     6931    2      OPTIONS(I) = FALSE;
       66     6932    2    END;
       67     6933    1    OPTIONS(OU_OPT) = TRUE;
       68     6934    1    OPTIONS(LS_OPT) = TRUE;
       69     6935    1    OPTIONS(XREF_OPT) = TRUE;
       70     6936
       71     6937    1    EOF_FLAG = FALSE;
       72     6938    1    ERR_SEV = 0;
       73     6939    1    INSTR_LEN  = 0;
       74     6940    1    INSTR_INDX = 1;
       75     6941    1    TERM_INTEGER = 0;
       76     6942    1    TERM_STRING_SYM= 0;
       77     6943    1    TERM_IDENTIFIER = 0;
       78     6944    1    TERM_EOF = 0;
       79     6945    1    TERM_EOL = 0;
       80     6946    1    TERM_LOCAL_LABEL = 0;
       81     6947    1    CALL OPEN_INPUT;
       82     6948    1    CALL COMMAND_LINE_OPTIONS;
       83     6949         %SELECT_LO;
       84     6952    1    IF OPTIONS(LS_OPT) THEN
       85     6953    1      CALL OUTPUT_HEADER;
       86     6954    1    CALL INIT_SCANNER;
       87     6955    1    PHASE = %PARSING;
       88     6956    1    CALL PARSER;
       89     6957         %IF GCOS;
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:4    
       90     6958 C       CALL M$CLOSE(CLOSE_LO);
       91     6959 C       CALL M$CLOSE(CLOSE_DO);
       92     6960         %ENDIF;
       93     6961    1    END STDSCANNER;
       94     6962         %EOD;

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:5    
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure STDSCANNER.

   Procedure STDSCANNER requires 66 words for executable code.
   Procedure STDSCANNER requires 4 words of local(AUTO) storage.

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:6    

 Object Unit name= STDSCANNER                                 File name= Z8PS.:Z8A6TOU
 UTS= AUG 09 '97 09:42:23.76 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none     1      1  OUT_DCBN
    2  LblCom even  none     1      1  SAVE_OUT_DCBN
    3  LblCom even  none     1      1  SAVE_DCBN2
    4   DCB   even  none     0      0  M$OU
    5   DCB   even  none     0      0  M$SO
    6   DCB   even  none     0      0  M$LO
    7   DCB   even  none     0      0  M$SI
    8   DCB   even  none     0      0  M$UI
    9   DCB   even  none     0      0  M$DO
   10  LblCom even  none     1      1  ERR_SEV
   11  LblCom even  none     1      1  OPTIONS
   12  LblCom even  none     1      1  DO_REQ
   13  LblCom even  none    26     32  OPTIONS_TEXT
   14  LblCom even  none   128    200  INSTR
   15  LblCom even  none     1      1  INSTR_LISTED
   16  LblCom even  none     1      1  INSTR_LEN
   17  LblCom even  none     1      1  INSTR_INDX
   18  LblCom even  none     1      1  EOF_FLAG
   19  LblCom even  none     5      5  KEY_REC
   20  LblCom even  none     1      1  LINES_OUT
   21  LblCom even  none    25     31  HEADER_LINE1
   22  LblCom even  none    25     31  HEADER_LINE3
   23  LblCom even  none    25     31  HEADER_LINE2
   24  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   25  LblCom even  none    28     34  LINE
   26  LblCom even  none     1      1  LINELEN
   27  LblCom even  none     1      1  PHASE
   28  LblCom even  none     1      1  ERROR_COUNT
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:7    
   29   Data  even  none     8     10  STDSCANNER
   30  LblCom even  none     1      1  TERM_INTEGER
   31  LblCom even  none     1      1  TERM_STRING_SYM
   32  LblCom even  none     1      1  TERM_IDENTIFIER
   33  LblCom even  none     1      1  TERM_EOF
   34  LblCom even  none     1      1  TERM_EOL
   35  LblCom even  none     1      1  TERM_LOCAL_LABEL
   36  RoData even  UTS      3      3  STDSCANNER
   37   Proc  even  none    66    102  STDSCANNER
   38  RoData even  none     1      1  STDSCANNER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    37      0   yes            yes      Main       0  STDSCANNER

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
   29      0  Z8PS$M$OU$                        29      1  Z8PS$M$LO$
   29      2  Z8PS$M$DO$                        29      3  Z8PS$M$SO$
   29      4  Z8PS$M$OU#                        29      5  Z8PS$M$LO#
   29      6  Z8PS$M$DO#                        29      7  Z8PS$M$SO#
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:8    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 Z9P1$INIT
         yes           Std       0 START
         yes           Std       0 OPEN_INPUT
         yes           Std       0 INIT_SCANNER
         yes           Std       0 PARSER
         yes           Std       0 COMMAND_LINE_OPTIONS
         yes           Std       0 OUTPUT_HEADER
                       nStd      0 X66_MAUTO
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$OU                                  M$SO
     M$LO                                  M$SI                                  M$UI
     M$DO
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:9    


        1        1         /*M* Z8PS - System independent module for PCA scanner and utilities */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7         /*P*
        8        8              NAME: Z8PS
        9        9              DESCRIPTION: System independent module for the scanner
       10       10                           and utilities routines. Some of the procedures
       11       11                           were derived from an example parser for LALR1 which
       12       12                           did not contain comments. I have continued this
       13       13                           this tradition in those procedures.
       14       14               */
       15       15         %EJECT;
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:10   
       16       16         STDSCANNER : PROC MAIN;

     16 37 000000   000000 700200 xent  STDSCANNER   TSX0  ! X66_MAUTO
        37 000001   000004 000000                    ZERO    4,0

       17       17
       18       18         /*D*
       19       19              NAME: STDSCANNER
       20       20              CALL:
       21       21                    Main routine for the PSEUDO-CODE ASSEMBLER
       22       22              ENVIRONMENT:
       23       23                   LALR1 Parser
       24       24              INPUT:
       25       25                   Pseudo code program
       26       26              OUTPUT:
       27       27                   Pseudo code tables
       28       28         */
       29       29         %INCLUDE Z8A_SYS_FILE;
       30     6304         %INCLUDE SCDPDA_SUBS;
       31     6698         %INCLUDE Z8P_SCAN_EXT;
       32     6887
       33     6888         %DCBPTR (STCLASS=STATIC SYMDEF);
       34     6898         %IF GCOS;
       35     6899 C       %FPT_CLOSE(FPTN=CLOSE_LO,DCB=%M$LO);
       36     6900 C       %FPT_CLOSE(FPTN=CLOSE_DO,DCB=%M$DO);
       37     6901         %ENDIF;
       38     6902
       39     6903    1    DCL PARSER ENTRY;
       40     6904    1    DCL INIT_SCANNER ENTRY;
       41     6905    1    DCL OPEN_INPUT ENTRY;
       42     6906    1    DCL COMMAND_LINE_OPTIONS ENTRY;
       43     6907    1    DCL START ENTRY;
       44     6908    1    DCL Z9P1$INIT ENTRY;
       45     6909
       46     6910    1    DCL TERM_INTEGER SBIN WORD EXT;
       47     6911    1    DCL TERM_STRING_SYM SBIN WORD EXT;
       48     6912    1    DCL TERM_IDENTIFIER SBIN WORD EXT;
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:11   
       49     6913    1    DCL TERM_EOF SBIN WORD EXT;
       50     6914    1    DCL TERM_EOL SBIN WORD EXT;
       51     6915    1    DCL TERM_LOCAL_LABEL SBIN WORD EXT;
       52     6916
       53     6917    1    DCL I SBIN;
       54     6918
       55     6919    1    CALL Z9P1$INIT; /* CP6- or GCOS-specific initialization */

   6919 37 000002   000000 631400 38                 EPPR1   0
        37 000003   000000 701000 xent               TSX1    Z9P1$INIT
        37 000004   000000 011000                    NOP     0

       56     6920
       57     6921    1    CALL START;

   6921 37 000005   000000 631400 38                 EPPR1   0
        37 000006   000000 701000 xent               TSX1    START
        37 000007   000000 011000                    NOP     0

       58     6922
       59     6923    1    KEY_REC = '          ';

   6923 37 000010   040000 100400                    MLR     fill='040'O
        37 000011   000000 000012 36                 ADSC9   0                        cn=0,n=10
        37 000012   000000 000024 19                 ADSC9   KEY_REC                  cn=0,n=20

       60     6924    1    INSTR_LISTED = TRUE;

   6924 37 000013   400000 236003                    LDQ     -131072,DU
        37 000014   000000 756000 15                 STQ     INSTR_LISTED

       61     6925         %SELECT_LO;

   6926 37 000015   000005 235000 29                 LDA     Z8PS$M$LO#
        37 000016   000000 755000 1                  STA     OUT_DCBN

       62     6928    1    LINELEN = 0;
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:12   

   6928 37 000017   000000 450000 26                 STZ     LINELEN

       63     6929
       64     6930    2    DO I = 0 TO 25;

   6930 37 000020   200003 450100                    STZ     I,,AUTO

       65     6931    2      OPTIONS(I) = FALSE;

   6931 37 000021   200003 235100                    LDA     I,,AUTO
        37 000022   000024 605000 37                 TPL     s:6931+3
        37 000023   000044 035003                    ADLA    36,DU
        37 000024   003005 060400                    CSL     bolr='003'O
        37 000025   000000 000001 38                 BDSC    0                        by=0,bit=0,n=1
        37 000026   000000 000001 11                 BDSC    OPTIONS,A                by=0,bit=0,n=1

       66     6932    2    END;

   6932 37 000027   200003 054100                    AOS     I,,AUTO
        37 000030   200003 235100                    LDA     I,,AUTO
        37 000031   000031 115007                    CMPA    25,DL
        37 000032   000021 604400 37                 TMOZ    s:6931

       67     6933    1    OPTIONS(OU_OPT) = TRUE;

   6933 37 000033   100000 236003                    LDQ     32768,DU
        37 000034   000000 256000 11                 ORSQ    OPTIONS

       68     6934    1    OPTIONS(LS_OPT) = TRUE;

   6934 37 000035   400000 236003                    LDQ     -131072,DU
        37 000036   000000 256000 11                 ORSQ    OPTIONS

       69     6935    1    OPTIONS(XREF_OPT) = TRUE;

   6935 37 000037   000200 236003                    LDQ     128,DU
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:13   
        37 000040   000000 256000 11                 ORSQ    OPTIONS

       70     6936
       71     6937    1    EOF_FLAG = FALSE;

   6937 37 000041   000000 450000 18                 STZ     EOF_FLAG

       72     6938    1    ERR_SEV = 0;

   6938 37 000042   000000 450000 10                 STZ     ERR_SEV

       73     6939    1    INSTR_LEN  = 0;

   6939 37 000043   000000 450000 16                 STZ     INSTR_LEN

       74     6940    1    INSTR_INDX = 1;

   6940 37 000044   000001 235007                    LDA     1,DL
        37 000045   000000 755000 17                 STA     INSTR_INDX

       75     6941    1    TERM_INTEGER = 0;

   6941 37 000046   000000 450000 30                 STZ     TERM_INTEGER

       76     6942    1    TERM_STRING_SYM= 0;

   6942 37 000047   000000 450000 31                 STZ     TERM_STRING_SYM

       77     6943    1    TERM_IDENTIFIER = 0;

   6943 37 000050   000000 450000 32                 STZ     TERM_IDENTIFIER

       78     6944    1    TERM_EOF = 0;

   6944 37 000051   000000 450000 33                 STZ     TERM_EOF

       79     6945    1    TERM_EOL = 0;
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:14   

   6945 37 000052   000000 450000 34                 STZ     TERM_EOL

       80     6946    1    TERM_LOCAL_LABEL = 0;

   6946 37 000053   000000 450000 35                 STZ     TERM_LOCAL_LABEL

       81     6947    1    CALL OPEN_INPUT;

   6947 37 000054   000000 631400 38                 EPPR1   0
        37 000055   000000 701000 xent               TSX1    OPEN_INPUT
        37 000056   000000 011000                    NOP     0

       82     6948    1    CALL COMMAND_LINE_OPTIONS;

   6948 37 000057   000000 631400 38                 EPPR1   0
        37 000060   000000 701000 xent               TSX1    COMMAND_LINE_OPTIONS
        37 000061   000000 011000                    NOP     0

       83     6949         %SELECT_LO;

   6950 37 000062   000005 235000 29                 LDA     Z8PS$M$LO#
        37 000063   000000 755000 1                  STA     OUT_DCBN

       84     6952    1    IF OPTIONS(LS_OPT) THEN

   6952 37 000064   000000 234000 11                 SZN     OPTIONS
        37 000065   000071 605000 37                 TPL     s:6954

       85     6953    1      CALL OUTPUT_HEADER;

   6953 37 000066   000000 631400 38                 EPPR1   0
        37 000067   000000 701000 xent               TSX1    OUTPUT_HEADER
        37 000070   000000 011000                    NOP     0

       86     6954    1    CALL INIT_SCANNER;

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:15   
   6954 37 000071   000000 631400 38                 EPPR1   0
        37 000072   000000 701000 xent               TSX1    INIT_SCANNER
        37 000073   000000 011000                    NOP     0

       87     6955    1    PHASE = %PARSING;

   6955 37 000074   000001 235007                    LDA     1,DL
        37 000075   000000 755000 27                 STA     PHASE

       88     6956    1    CALL PARSER;

   6956 37 000076   000000 631400 38                 EPPR1   0
        37 000077   000000 701000 xent               TSX1    PARSER
        37 000100   000000 011000                    NOP     0

       89     6957         %IF GCOS;
       90     6958 C       CALL M$CLOSE(CLOSE_LO);
       91     6959 C       CALL M$CLOSE(CLOSE_DO);
       92     6960         %ENDIF;
       93     6961    1    END STDSCANNER;

   6961 37 000101   000000 702200 xent               TSX2  ! X66_MARET
       94     6962         %EOD;

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:16   
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure STDSCANNER.
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:17   

 **** Variables and constants ****

  ****  Section 001 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 002 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 003 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 010 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 ERR_SEV

  ****  Section 011 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:18   
  ****  Section 012 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 013 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 014 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 INSTR(0:511)               0-0-0/c CHAR(512)         1 INSTRCHR

  ****  Section 015 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 INSTR_LISTED

  ****  Section 016 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_LEN

  ****  Section 017 LblCom INSTR_INDX

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:19   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_INDX

  ****  Section 018 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 EOF_FLAG

  ****  Section 019 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)    r     1 KEY_REC

  ****  Section 020 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 021 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 022 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:20   

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 023 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 024 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 025 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 026 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LINELEN

  ****  Section 027 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 PHASE
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:21   

  ****  Section 028 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Section 029  Data  STDSCANNER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w UBIN              1 Z8PS$M$DO#                 2-0-0/w PTR               1 Z8PS$M$DO$
     5-0-0/w UBIN        r     1 Z8PS$M$LO#                 1-0-0/w PTR               1 Z8PS$M$LO$
     4-0-0/w UBIN              1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
     7-0-0/w UBIN              1 Z8PS$M$SO#                 3-0-0/w PTR               1 Z8PS$M$SO$

  ****  Section 030 LblCom TERM_INTEGER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_INTEGER

  ****  Section 031 LblCom TERM_STRING_SYM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_STRING_SYM

  ****  Section 032 LblCom TERM_IDENTIFIER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:22   
     0-0-0/w SBIN        r     1 TERM_IDENTIFIER

  ****  Section 033 LblCom TERM_EOF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_EOF

  ****  Section 034 LblCom TERM_EOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_EOL

  ****  Section 035 LblCom TERM_LOCAL_LABEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_LOCAL_LABEL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w SBIN        r     1 I

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$OU                       0-0-0N  NULL        r     1 M$SI
PL6.E3A0      #001=STDSCANNER File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:42 Page:23   
     0-0-0N  NULL        r     1 M$SO                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$UI


   Procedure STDSCANNER requires 66 words for executable code.
   Procedure STDSCANNER requires 4 words of local(AUTO) storage.

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:24   
       95        1        /*T***********************************************************/
       96        2        /*T*                                                         */
       97        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       98        4        /*T*                                                         */
       99        5        /*T***********************************************************/
      100        6         INIT_SCANNER: PROC;
      101        7         /*D*
      102        8               NAME: INIT_SCANNER
      103        9               DESCRIPTION: Initialize the token list and the identifiers
      104       10                  for special tokens.  The token list is used by the scanner
      105       11                  to identify the tokens with numbers that can be used by the
      106       12                  parser.
      107       13               PURPOSE: The TOK arrary is used to give order to the
      108       14                  TERM_STRING array created by LALR1. The TOK array contains
      109       15                  one entry for each element in TERM_STRING.  TERM_STRING is
      110       16                  an array of structures that describe the position of
      111       17                  a terminal in TSTRING_SPACE. TSTRING_SPACE is a textual
      112       18                  representation of all terminals concatenated together.
      113       19                  In this implementation TOK is used to order the terminals
      114       20                  in alphabetical order.  The scanner can then use a binary
      115       21                  search to identify tokens from the input file.
      116       22         */
      117       23         %INCLUDE SCDPDA_SUBS;
      118      417         %INCLUDE Z8P_SCAN_EXT;
      119      606         %PARSE_SYMREFS;
      120      624         %TSTRING_SYMREFS;
      121      630
      122      631    1    DCL I SBIN WORD;
      123      632    1    DCL TOK(0:%TERM_STRING_LEN) SBIN WORD EXT;
      124      633    1    DCL LAST_TOK SBIN WORD EXT;
      125      634
      126      635    1    DCL TERM_INTEGER SBIN WORD EXT;
      127      636    1    DCL TERM_STRING_SYM SBIN WORD EXT;
      128      637    1    DCL TERM_IDENTIFIER SBIN WORD EXT;
      129      638    1    DCL TERM_EOL SBIN WORD EXT;
      130      639    1    DCL TERM_EOF SBIN WORD EXT;
      131      640    1    DCL TERM_LOCAL_LABEL SBIN WORD EXT;
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:25   
      132      641
      133      642
      134      643    1    ADD_TOK: PROC (ITEM);
      135      644    2    DCL ITEM SBIN WORD;
      136      645
      137      646    2    DCL I SBIN WORD;
      138      647    2    DCL J SBIN WORD;
      139      648    2    DCL TEXT CHAR(140);
      140      649
      141      650    2    TEXT = SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(ITEM),TERM_STRING.LEN(ITEM));
      142      651    2    I = TERM_STRING.LEN(ITEM);
      143      652    2    IF (I = 10) AND (SUBSTR(TEXT,0,I) = 'IDENTIFIER')
      144      653    3    THEN DO;
      145      654    3         TERM_IDENTIFIER = ITEM;
      146      655    3         RETURN;
      147      656    3         END;
      148      657    2    ELSE IF (I=6) AND (SUBSTR(TEXT,0,I) = 'STRING')
      149      658    3         THEN DO;
      150      659    3              TERM_STRING_SYM= ITEM;
      151      660    3              RETURN;
      152      661    3              END;
      153      662    2         ELSE IF (I=7) AND (SUBSTR(TEXT,0,I) = 'INTEGER')
      154      663    3              THEN DO;
      155      664    3                   TERM_INTEGER = ITEM;
      156      665    3                   RETURN;
      157      666    3              END;
      158      667    2              ELSE IF (I=13) AND (SUBSTR(TEXT,0,I) = '=END_OF_FILE=') THEN
      159      668    3                     DO;
      160      669    3                       TERM_EOF = ITEM;
      161      670    3                       RETURN;
      162      671    3                     END;
      163      672    2                   ELSE IF (I=13) AND (SUBSTR(TEXT,0,I) = '=END_OF_LINE=') THEN
      164      673    3                          DO;
      165      674    3                            TERM_EOL = ITEM;
      166      675    3                            RETURN;
      167      676    3                          END;
      168      677    2                        ELSE IF (I=19) AND (SUBSTR(TEXT,0,I) = '=BEGINNING_OF_FILE=')
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:26   
               677                                 THEN
      169      678    2                                RETURN;
      170      679    2                             ELSE IF (I=7) AND (SUBSTR(TEXT,0,I) = '=ERROR=') THEN
      171      680    2                                    RETURN;
      172      681    2                                  ELSE IF (I=11) AND
      173      682    2                                          (SUBSTR(TEXT,0,I) = 'LOCAL_LABEL') THEN
      174      683    3                                        DO;
      175      684    3                                           TERM_LOCAL_LABEL = ITEM;
      176      685    3                                          RETURN;
      177      686    3                                         END;
      178      687    2    I = 1;
      179      688    3    DO WHILE (I <= LAST_TOK) AND
      180      689    3             (SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(TOK(I)),
      181      690    3                            TERM_STRING.LEN(TOK(I))) <
      182      691    3             SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(ITEM),
      183      692    3                            TERM_STRING.LEN(ITEM)));
      184      693    3         I = I + 1;
      185      694    3    END;
      186      695    3    DO J= LAST_TOK DOWNTO I;
      187      696    3       TOK(J+1) = TOK(J);
      188      697    3    END;
      189      698    2    LAST_TOK = LAST_TOK + 1;
      190      699    2    TOK(I) = ITEM;
      191      700    2    END ADD_TOK;
      192      701
      193      702
      194      703    1    LAST_TOK = 0;
      195      704
      196      705    2    DO I = 1 TO %TERM_STRING_LEN;
      197      706
      198      707    2      CALL ADD_TOK(I);
      199      708
      200      709    2    END;
      201      710
      202      711    1    INSTR_LEN = 0;
      203      712    1    INSTR_INDX = 1;
      204      713
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:27   
      205      714    1    END INIT_SCANNER;
      206      715         %EOD;

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:28   
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure INIT_SCANNER.

   Procedure INIT_SCANNER requires 202 words for executable code.
   Procedure INIT_SCANNER requires 52 words of local(AUTO) storage.

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:29   

 Object Unit name= INIT_SCANNER                               File name= Z8PS.:Z8A6TOU
 UTS= AUG 09 '97 09:43:15.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  OUT_DCBN
    1  LblCom even  none     1      1  SAVE_OUT_DCBN
    2  LblCom even  none     1      1  SAVE_DCBN2
    3   DCB   even  none     0      0  M$OU
    4   DCB   even  none     0      0  M$SO
    5   DCB   even  none     0      0  M$LO
    6   DCB   even  none     0      0  M$SI
    7   DCB   even  none     0      0  M$UI
    8   DCB   even  none     0      0  M$DO
    9  LblCom even  none     1      1  ERR_SEV
   10  LblCom even  none     1      1  OPTIONS
   11  LblCom even  none     1      1  DO_REQ
   12  LblCom even  none    26     32  OPTIONS_TEXT
   13  LblCom even  none   128    200  INSTR
   14  LblCom even  none     1      1  INSTR_LISTED
   15  LblCom even  none     1      1  INSTR_LEN
   16  LblCom even  none     1      1  INSTR_INDX
   17  LblCom even  none     1      1  EOF_FLAG
   18  LblCom even  none     5      5  KEY_REC
   19  LblCom even  none     1      1  LINES_OUT
   20  LblCom even  none    25     31  HEADER_LINE1
   21  LblCom even  none    25     31  HEADER_LINE3
   22  LblCom even  none    25     31  HEADER_LINE2
   23  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   24  LblCom even  none    28     34  LINE
   25  LblCom even  none     1      1  LINELEN
   26  LblCom even  none     1      1  PHASE
   27  LblCom even  none     1      1  ERROR_COUNT
   28  LblCom even  none   210    322  TOK
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:30   
   29  LblCom even  none     1      1  LAST_TOK
   30  LblCom even  none     1      1  TERM_INTEGER
   31  LblCom even  none     1      1  TERM_STRING_SYM
   32  LblCom even  none     1      1  TERM_IDENTIFIER
   33  LblCom even  none     1      1  TERM_EOL
   34  LblCom even  none     1      1  TERM_EOF
   35  LblCom even  none     1      1  TERM_LOCAL_LABEL
   36  RoData even  UTS     25     31  INIT_SCANNER
   37   Proc  even  none   202    312  INIT_SCANNER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    37      0   yes            yes      Std        0  INIT_SCANNER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OU                                  M$SO                                  M$LO
     M$SI                                  M$UI                                  M$DO
r    PRODR                            r    ACTION_COL                       r    ACTION_ROW
r    GOTO_COL                         r    GOTO_ROW                         r    TERM_STRING
r    TSTRING_SPACE
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:31   


       95        1        /*T***********************************************************/
       96        2        /*T*                                                         */
       97        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       98        4        /*T*                                                         */
       99        5        /*T***********************************************************/
      100        6         INIT_SCANNER: PROC;

      6 37 000000   000000 700200 xent  INIT_SCANNER TSX0  ! X66_AUTO_0
        37 000001   000064 000000                    ZERO    52,0
        37 000002   000273 710000 37                 TRA     s:703

      101        7         /*D*
      102        8               NAME: INIT_SCANNER
      103        9               DESCRIPTION: Initialize the token list and the identifiers
      104       10                  for special tokens.  The token list is used by the scanner
      105       11                  to identify the tokens with numbers that can be used by the
      106       12                  parser.
      107       13               PURPOSE: The TOK arrary is used to give order to the
      108       14                  TERM_STRING array created by LALR1. The TOK array contains
      109       15                  one entry for each element in TERM_STRING.  TERM_STRING is
      110       16                  an array of structures that describe the position of
      111       17                  a terminal in TSTRING_SPACE. TSTRING_SPACE is a textual
      112       18                  representation of all terminals concatenated together.
      113       19                  In this implementation TOK is used to order the terminals
      114       20                  in alphabetical order.  The scanner can then use a binary
      115       21                  search to identify tokens from the input file.
      116       22         */
      117       23         %INCLUDE SCDPDA_SUBS;
      118      417         %INCLUDE Z8P_SCAN_EXT;
      119      606         %PARSE_SYMREFS;
      120      624         %TSTRING_SYMREFS;
      121      630
      122      631    1    DCL I SBIN WORD;
      123      632    1    DCL TOK(0:%TERM_STRING_LEN) SBIN WORD EXT;
      124      633    1    DCL LAST_TOK SBIN WORD EXT;
      125      634
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:32   
      126      635    1    DCL TERM_INTEGER SBIN WORD EXT;
      127      636    1    DCL TERM_STRING_SYM SBIN WORD EXT;
      128      637    1    DCL TERM_IDENTIFIER SBIN WORD EXT;
      129      638    1    DCL TERM_EOL SBIN WORD EXT;
      130      639    1    DCL TERM_EOF SBIN WORD EXT;
      131      640    1    DCL TERM_LOCAL_LABEL SBIN WORD EXT;
      132      641
      133      642
      134      643    1    ADD_TOK: PROC (ITEM);

    643 37 000003   200004 741300       ADD_TOK      STX1  ! I+1,,AUTO

      135      644    2    DCL ITEM SBIN WORD;
      136      645
      137      646    2    DCL I SBIN WORD;
      138      647    2    DCL J SBIN WORD;
      139      648    2    DCL TEXT CHAR(140);
      140      649
      141      650    2    TEXT = SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(ITEM),TERM_STRING.LEN(ITEM));

    650 37 000004   200005 470500                    LDP0    @ITEM,,AUTO
        37 000005   000000 236100                    LDQ     0,,PR0
        37 000006   000017 402007                    MPY     15,DL
        37 000007   200055 756100                    STQ     TEXT+37,,AUTO
        37 000010   000000 116003                    CMPQ    0,DU
        37 000011   000013 605000 37                 TPL     s:650+7
        37 000012   000044 036003                    ADLQ    36,DU
        37 000013   003100 061406                    CSR     bolr='003'O
        37 000014   000000 000012 xsym               BDSC    TERM_STRING,Q            by=0,bit=0,n=10
        37 000015   200054 000044                    BDSC    TEXT+36,,AUTO            by=0,bit=0,n=36
        37 000016   200054 236100                    LDQ     TEXT+36,,AUTO
        37 000017   200055 235100                    LDA     TEXT+37,,AUTO
        37 000020   000022 605000 37                 TPL     s:650+14
        37 000021   000044 035003                    ADLA    36,DU
        37 000022   003100 061405                    CSR     bolr='003'O
        37 000023   000000 210005 xsym               BDSC    TERM_STRING,A            by=1,bit=1,n=5
        37 000024   200056 000022                    BDSC    TEXT+38,,AUTO            by=0,bit=0,n=18
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:33   
        37 000025   200056 220100                    LDX0    TEXT+38,,AUTO
        37 000026   040100 100446                    MLR     fill='040'O
        37 000027   000000 000010 xsym               ADSC9   TSTRING_SPACE,Q          cn=0,n=*X0
        37 000030   200010 000214                    ADSC9   TEXT,,AUTO               cn=0,n=140

      142      651    2    I = TERM_STRING.LEN(ITEM);

    651 37 000031   000000 236100                    LDQ     0,,PR0
        37 000032   000017 402007                    MPY     15,DL
        37 000033   000000 116003                    CMPQ    0,DU
        37 000034   000036 605000 37                 TPL     s:651+5
        37 000035   000044 036003                    ADLQ    36,DU
        37 000036   003100 061406                    CSR     bolr='003'O
        37 000037   000000 210005 xsym               BDSC    TERM_STRING,Q            by=1,bit=1,n=5
        37 000040   200006 000044                    BDSC    I,,AUTO                  by=0,bit=0,n=36

      143      652    2    IF (I = 10) AND (SUBSTR(TEXT,0,I) = 'IDENTIFIER')

    652 37 000041   200006 235100                    LDA     I,,AUTO
        37 000042   000012 115007                    CMPA    10,DL
        37 000043   000054 601000 37                 TNZ     s:657
        37 000044   000000 620005                    EAX0    0,AL
        37 000045   040000 106540                    CMPC    fill='040'O
        37 000046   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000047   000000 000012 36                 ADSC9   0                        cn=0,n=10
        37 000050   000054 601000 37                 TNZ     s:657

      144      653    3    THEN DO;

      145      654    3         TERM_IDENTIFIER = ITEM;

    654 37 000051   000000 235100                    LDA     0,,PR0
        37 000052   000000 755000 32                 STA     TERM_IDENTIFIER

      146      655    3         RETURN;

    655 37 000053   000001 702211                    TSX2  ! 1,X1
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:34   

      147      656    3         END;
      148      657    2    ELSE IF (I=6) AND (SUBSTR(TEXT,0,I) = 'STRING')

    657 37 000054   200006 235100                    LDA     I,,AUTO
        37 000055   000006 115007                    CMPA    6,DL
        37 000056   000067 601000 37                 TNZ     s:662
        37 000057   000000 620005                    EAX0    0,AL
        37 000060   040000 106540                    CMPC    fill='040'O
        37 000061   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000062   000003 000006 36                 ADSC9   3                        cn=0,n=6
        37 000063   000067 601000 37                 TNZ     s:662

      149      658    3         THEN DO;

      150      659    3              TERM_STRING_SYM= ITEM;

    659 37 000064   000000 235100                    LDA     0,,PR0
        37 000065   000000 755000 31                 STA     TERM_STRING_SYM

      151      660    3              RETURN;

    660 37 000066   000001 702211                    TSX2  ! 1,X1

      152      661    3              END;
      153      662    2         ELSE IF (I=7) AND (SUBSTR(TEXT,0,I) = 'INTEGER')

    662 37 000067   200006 235100                    LDA     I,,AUTO
        37 000070   000007 115007                    CMPA    7,DL
        37 000071   000102 601000 37                 TNZ     s:667
        37 000072   000000 620005                    EAX0    0,AL
        37 000073   040000 106540                    CMPC    fill='040'O
        37 000074   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000075   000005 000007 36                 ADSC9   5                        cn=0,n=7
        37 000076   000102 601000 37                 TNZ     s:667

      154      663    3              THEN DO;
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:35   

      155      664    3                   TERM_INTEGER = ITEM;

    664 37 000077   000000 235100                    LDA     0,,PR0
        37 000100   000000 755000 30                 STA     TERM_INTEGER

      156      665    3                   RETURN;

    665 37 000101   000001 702211                    TSX2  ! 1,X1

      157      666    3              END;
      158      667    2              ELSE IF (I=13) AND (SUBSTR(TEXT,0,I) = '=END_OF_FILE=') THEN

    667 37 000102   200006 235100                    LDA     I,,AUTO
        37 000103   000015 115007                    CMPA    13,DL
        37 000104   000115 601000 37                 TNZ     s:672
        37 000105   000000 620005                    EAX0    0,AL
        37 000106   040000 106540                    CMPC    fill='040'O
        37 000107   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000110   000007 000015 36                 ADSC9   7                        cn=0,n=13
        37 000111   000115 601000 37                 TNZ     s:672

      159      668    3                     DO;

      160      669    3                       TERM_EOF = ITEM;

    669 37 000112   000000 235100                    LDA     0,,PR0
        37 000113   000000 755000 34                 STA     TERM_EOF

      161      670    3                       RETURN;

    670 37 000114   000001 702211                    TSX2  ! 1,X1

      162      671    3                     END;
      163      672    2                   ELSE IF (I=13) AND (SUBSTR(TEXT,0,I) = '=END_OF_LINE=') THEN

    672 37 000115   200006 235100                    LDA     I,,AUTO
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:36   
        37 000116   000015 115007                    CMPA    13,DL
        37 000117   000130 601000 37                 TNZ     s:677
        37 000120   000000 620005                    EAX0    0,AL
        37 000121   040000 106540                    CMPC    fill='040'O
        37 000122   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000123   000013 000015 36                 ADSC9   11                       cn=0,n=13
        37 000124   000130 601000 37                 TNZ     s:677

      164      673    3                          DO;

      165      674    3                            TERM_EOL = ITEM;

    674 37 000125   000000 235100                    LDA     0,,PR0
        37 000126   000000 755000 33                 STA     TERM_EOL

      166      675    3                            RETURN;

    675 37 000127   000001 702211                    TSX2  ! 1,X1

      167      676    3                          END;
      168      677    2                        ELSE IF (I=19) AND (SUBSTR(TEXT,0,I) = '=BEGINNING_OF_FILE=')
               677                                 THEN

    677 37 000130   200006 235100                    LDA     I,,AUTO
        37 000131   000023 115007                    CMPA    19,DL
        37 000132   000141 601000 37                 TNZ     s:679
        37 000133   000000 620005                    EAX0    0,AL
        37 000134   040000 106540                    CMPC    fill='040'O
        37 000135   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000136   000017 000023 36                 ADSC9   15                       cn=0,n=19
        37 000137   000141 601000 37                 TNZ     s:679

      169      678    2                                RETURN;

    678 37 000140   000001 702211                    TSX2  ! 1,X1

      170      679    2                             ELSE IF (I=7) AND (SUBSTR(TEXT,0,I) = '=ERROR=') THEN
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:37   

    679 37 000141   200006 235100                    LDA     I,,AUTO
        37 000142   000007 115007                    CMPA    7,DL
        37 000143   000152 601000 37                 TNZ     s:681
        37 000144   000000 620005                    EAX0    0,AL
        37 000145   040000 106540                    CMPC    fill='040'O
        37 000146   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000147   000024 000007 36                 ADSC9   20                       cn=0,n=7
        37 000150   000152 601000 37                 TNZ     s:681

      171      680    2                                    RETURN;

    680 37 000151   000001 702211                    TSX2  ! 1,X1

      172      681    2                                  ELSE IF (I=11) AND

    681 37 000152   200006 235100                    LDA     I,,AUTO
        37 000153   000013 115007                    CMPA    11,DL
        37 000154   000165 601000 37                 TNZ     s:687
        37 000155   000000 620005                    EAX0    0,AL
        37 000156   040000 106540                    CMPC    fill='040'O
        37 000157   200010 000010                    ADSC9   TEXT,,AUTO               cn=0,n=*X0
        37 000160   000026 000013 36                 ADSC9   22                       cn=0,n=11
        37 000161   000165 601000 37                 TNZ     s:687

      173      682    2                                          (SUBSTR(TEXT,0,I) = 'LOCAL_LABEL') THEN
      174      683    3                                        DO;

      175      684    3                                           TERM_LOCAL_LABEL = ITEM;

    684 37 000162   000000 235100                    LDA     0,,PR0
        37 000163   000000 755000 35                 STA     TERM_LOCAL_LABEL

      176      685    3                                          RETURN;

    685 37 000164   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:38   
      177      686    3                                         END;
      178      687    2    I = 1;

    687 37 000165   000001 235007                    LDA     1,DL
        37 000166   200006 755100                    STA     I,,AUTO

      179      688    3    DO WHILE (I <= LAST_TOK) AND

    688 37 000167   000171 710000 37                 TRA     s:694

      180      689    3             (SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(TOK(I)),
      181      690    3                            TERM_STRING.LEN(TOK(I))) <
      182      691    3             SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(ITEM),
      183      692    3                            TERM_STRING.LEN(ITEM)));
      184      693    3         I = I + 1;

    693 37 000170   200006 054100                    AOS     I,,AUTO

      185      694    3    END;

    694 37 000171   200006 236100                    LDQ     I,,AUTO
        37 000172   000000 116000 29                 CMPQ    LAST_TOK
        37 000173   000251 605400 37                 TPNZ    s:695
        37 000174   000000 236006 28                 LDQ     TOK,QL
        37 000175   000017 402007                    MPY     15,DL
        37 000176   200006 720100                    LXL0    I,,AUTO
        37 000177   200054 756100                    STQ     TEXT+36,,AUTO
        37 000200   000000 236010 28                 LDQ     TOK,X0
        37 000201   000017 402007                    MPY     15,DL
        37 000202   200054 235100                    LDA     TEXT+36,,AUTO
        37 000203   000205 605000 37                 TPL     s:694+12
        37 000204   000044 035003                    ADLA    36,DU
        37 000205   003100 061405                    CSR     bolr='003'O
        37 000206   000000 000012 xsym               BDSC    TERM_STRING,A            by=0,bit=0,n=10
        37 000207   200055 000044                    BDSC    TEXT+37,,AUTO            by=0,bit=0,n=36
        37 000210   200056 756100                    STQ     TEXT+38,,AUTO
        37 000211   200055 236100                    LDQ     TEXT+37,,AUTO
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:39   
        37 000212   200056 235100                    LDA     TEXT+38,,AUTO
        37 000213   000215 605000 37                 TPL     s:694+20
        37 000214   000044 035003                    ADLA    36,DU
        37 000215   003100 061405                    CSR     bolr='003'O
        37 000216   000000 210005 xsym               BDSC    TERM_STRING,A            by=1,bit=1,n=5
        37 000217   200057 000022                    BDSC    TEXT+39,,AUTO            by=0,bit=0,n=18
        37 000220   200057 221100                    LDX1    TEXT+39,,AUTO
        37 000221   200005 470500                    LDP0    @ITEM,,AUTO
        37 000222   200060 756100                    STQ     TEXT+40,,AUTO
        37 000223   000000 236100                    LDQ     0,,PR0
        37 000224   000017 402007                    MPY     15,DL
        37 000225   200062 756100                    STQ     TEXT+42,,AUTO
        37 000226   000000 116003                    CMPQ    0,DU
        37 000227   000231 605000 37                 TPL     s:694+32
        37 000230   000044 036003                    ADLQ    36,DU
        37 000231   003100 061406                    CSR     bolr='003'O
        37 000232   000000 000012 xsym               BDSC    TERM_STRING,Q            by=0,bit=0,n=10
        37 000233   200061 000044                    BDSC    TEXT+41,,AUTO            by=0,bit=0,n=36
        37 000234   200061 236100                    LDQ     TEXT+41,,AUTO
        37 000235   200062 235100                    LDA     TEXT+42,,AUTO
        37 000236   000240 605000 37                 TPL     s:694+39
        37 000237   000044 035003                    ADLA    36,DU
        37 000240   003100 061405                    CSR     bolr='003'O
        37 000241   000000 210005 xsym               BDSC    TERM_STRING,A            by=1,bit=1,n=5
        37 000242   200063 000022                    BDSC    TEXT+43,,AUTO            by=0,bit=0,n=18
        37 000243   200063 222100                    LDX2    TEXT+43,,AUTO
        37 000244   200060 235100                    LDA     TEXT+40,,AUTO
        37 000245   040046 106445                    CMPC    fill='040'O
        37 000246   000000 000011 xsym               ADSC9   TSTRING_SPACE,A          cn=0,n=*X1
        37 000247   000000 000012 xsym               ADSC9   TSTRING_SPACE,Q          cn=0,n=*X2
        37 000250   000170 602000 37                 TNC     s:693

      186      695    3    DO J= LAST_TOK DOWNTO I;

    695 37 000251   000000 235000 29                 LDA     LAST_TOK
        37 000252   200007 755100                    STA     J,,AUTO
        37 000253   000261 710000 37                 TRA     s:697+2
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:40   

      187      696    3       TOK(J+1) = TOK(J);

    696 37 000254   200007 720100                    LXL0    J,,AUTO
        37 000255   000000 235010 28                 LDA     TOK,X0
        37 000256   000001 755010 28                 STA     TOK+1,X0

      188      697    3    END;

    697 37 000257   000001 336007                    LCQ     1,DL
        37 000260   200007 056100                    ASQ     J,,AUTO
        37 000261   200007 236100                    LDQ     J,,AUTO
        37 000262   200006 116100                    CMPQ    I,,AUTO
        37 000263   000254 605000 37                 TPL     s:696

      189      698    2    LAST_TOK = LAST_TOK + 1;

    698 37 000264   000000 054000 29                 AOS     LAST_TOK

      190      699    2    TOK(I) = ITEM;

    699 37 000265   200005 470500                    LDP0    @ITEM,,AUTO
        37 000266   200006 720100                    LXL0    I,,AUTO
        37 000267   000000 235100                    LDA     0,,PR0
        37 000270   000000 755010 28                 STA     TOK,X0

      191      700    2    END ADD_TOK;

    700 37 000271   200004 221300                    LDX1  ! I+1,,AUTO
        37 000272   000001 702211                    TSX2  ! 1,X1

      192      701
      193      702
      194      703    1    LAST_TOK = 0;

    703 37 000273   000000 450000 29                 STZ     LAST_TOK

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:41   
      195      704
      196      705    2    DO I = 1 TO %TERM_STRING_LEN;

    705 37 000274   000001 235007                    LDA     1,DL
        37 000275   200003 755100                    STA     I,,AUTO

      197      706
      198      707    2      CALL ADD_TOK(I);

    707 37 000276   200003 630500                    EPPR0   I,,AUTO
        37 000277   200005 450500                    STP0    I+2,,AUTO
        37 000300   000003 701000 37                 TSX1    ADD_TOK
        37 000301   000000 011000                    NOP     0

      199      708
      200      709    2    END;

    709 37 000302   200003 054100                    AOS     I,,AUTO
        37 000303   200003 235100                    LDA     I,,AUTO
        37 000304   000321 115007                    CMPA    209,DL
        37 000305   000276 604400 37                 TMOZ    s:707

      201      710
      202      711    1    INSTR_LEN = 0;

    711 37 000306   000000 450000 15                 STZ     INSTR_LEN

      203      712    1    INSTR_INDX = 1;

    712 37 000307   000001 236007                    LDQ     1,DL
        37 000310   000000 756000 16                 STQ     INSTR_INDX

      204      713
      205      714    1    END INIT_SCANNER;

    714 37 000311   000000 702200 xent               TSX2  ! X66_ARET
      206      715         %EOD;
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:42   

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:43   
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure INIT_SCANNER.
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:44   

 **** Variables and constants ****

  ****  Section 000 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 OUT_DCBN

  ****  Section 001 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 002 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 009 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 010 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 OPTIONS(0:25)

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:45   
  ****  Section 011 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 012 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 013 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR              1 INSTR(0:511)               0-0-0/c CHAR(512)         1 INSTRCHR

  ****  Section 014 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 INSTR_LISTED

  ****  Section 015 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_LEN

  ****  Section 016 LblCom INSTR_INDX

PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:46   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_INDX

  ****  Section 017 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 EOF_FLAG

  ****  Section 018 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)          1 KEY_REC

  ****  Section 019 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 020 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 021 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:47   

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 022 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 023 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 024 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 025 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 026 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PHASE
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:48   

  ****  Section 027 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Section 028 LblCom TOK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TOK(0:209)

  ****  Section 029 LblCom LAST_TOK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LAST_TOK

  ****  Section 030 LblCom TERM_INTEGER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_INTEGER

  ****  Section 031 LblCom TERM_STRING_SYM

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_STRING_SYM

  ****  Section 032 LblCom TERM_IDENTIFIER
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:49   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_IDENTIFIER

  ****  Section 033 LblCom TERM_EOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_EOL

  ****  Section 034 LblCom TERM_EOF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_EOF

  ****  Section 035 LblCom TERM_LOCAL_LABEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_LOCAL_LABEL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ITEM                      3-0-0/w SBIN        r     1 I
     6-0-0/w SBIN        r     1 I                         *0-0-0/w SBIN        r     1 ITEM
     7-0-0/w SBIN        r     1 J                         10-0-0/c CHAR(140)   r     1 TEXT

  ****  SYMREF variables  ****
PL6.E3A0      #002=INIT_SCANNER File=Z8PS.:Z8A6TSI                               SAT 08/09/97 09:43 Page:50   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC              1 ACTION_COL(0:548)
     0-0-0/b STRC              1 ACTION_ROW(0:1904)
     0-0-0/b STRC              1 GOTO_COL(0:183)            0-0-0/b STRC              1 GOTO_ROW(0:194)
     0-0-0/b STRC(54)          1 PRODR(0:399)
     0-0-0/b STRC(15)    r     1 TERM_STRING(0:209)
     0-0-0/c CHAR(880)   r     1 TSTRING_SPACE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$OU                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$SO                       0-0-0N  NULL        r     1 M$UI


   Procedure INIT_SCANNER requires 202 words for executable code.
   Procedure INIT_SCANNER requires 52 words of local(AUTO) storage.

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:51   
      207        1        /*T***********************************************************/
      208        2        /*T*                                                         */
      209        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      210        4        /*T*                                                         */
      211        5        /*T***********************************************************/
      212        6         /*D*
      213        7               NAME: SCANNER
      214        8               DECSCRIPTION: This procedure gets the next token from the
      215        9                 input file and identifies the token.
      216       10         */
      217       11         SCANNER: PROC(P_TOKEN);
      218       12    1        DCL P_TOKEN PTR;
      219       13
      220       14         %INCLUDE Z8A_SYS_FILE;
      221     6289             %INCLUDE Z8P_SCAN_EXT;
      222     6478             %INCLUDE Z8P_PARS_STK;
      223     6521             %INCLUDE Z8P_PARS_DNT;
      224     6542             %INCLUDE SCDPDA_SUBS;
      225     6936             %PARSE_SYMREFS;
      226     6954             %TSTRING_SYMREFS;
      227     6960             %INCLUDE Z8P_XLIT;
      228     7149             %INCLUDE Z8P_SCAN_TBL;
      229     7222
      230     7223             %VLP_TEXTC(FPTN=BAD_CHAR,TEXT=
              7223                 '  Error => Syntax error: Identifier contains illegal character.');
      231     7238             %VLP_TEXTC(FPTN=BAD_IDENT_1,TEXT=' Error => Syntax error: Identifier begins ');
      232     7253             %VLP_TEXTC(FPTN=BAD_IDENT_2,TEXT='with an illegal character.');
      233     7268
      234     7269    1        DCL DIAG ENTRY (6);
      235     7270    1        DCL INPUT ENTRY(3);
      236     7271    1        DCL FORCE_LIST ENTRY;
      237     7272    1        DCL FLUSH ENTRY;
      238     7273    1        DCL OUT_STR ENTRY(2);
      239     7274
      240     7275    1        DCL LINE# SBIN WORD STATIC INIT(0);
      241     7276    1        DCL MAXLEN SBIN WORD;
      242     7277    1        DCL I SBIN WORD;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:52   
      243     7278
      244     7279    1        DCL LAST_TOK SBIN WORD EXT;
      245     7280    1        DCL TOK(0:%TERM_STRING_LEN) SBIN WORD EXT;
      246     7281    1        DCL NEW$ PTR;
      247     7282    1        DCL SYMLEN SBIN WORD;
      248     7283    1        DCL NEWLEN SBIN WORD;
      249     7284
      250     7285    1        DCL TERM_IDENTIFIER SBIN WORD EXT;
      251     7286    1        DCL TERM_STRING_SYM SBIN WORD EXT;
      252     7287    1        DCL TERM_INTEGER SBIN WORD EXT;
      253     7288    1        DCL TERM_EOF SBIN WORD EXT;
      254     7289    1        DCL TERM_EOL SBIN WORD EXT;
      255     7290    1        DCL TERM_LOCAL_LABEL SBIN WORD EXT;
      256     7291
      257     7292    1        DCL FOUND_POS UBIN WORD;
      258     7293    1        DCL TABVAL UBIN WORD;
      259     7294    1        DCL TOKEN_NAME CHAR(120);
      260     7295    1        DCL TOKEN_LEN UBIN WORD;
      261     7296    1        DCL SYMBOL_NUM SBIN WORD;
      262     7297    1        DCL BUFFER CHAR(140);
      263     7298    1        DCL LEN SBIN WORD;
      264     7299
      265     7300    1        DCL MID SBIN WORD;
      266     7301    1        DCL HIGH SBIN WORD;
      267     7302    1        DCL LOW SBIN WORD;
      268     7303    1        DCL MATCH BIT(1) ALIGNED;
      269     7304
      270     7305
      271     7306    1        DCL INT_INSTR (0:511) CHAR(1) UNAL STATIC;
      272     7307    1        DCL INT_INSTRCHR REDEF INT_INSTR CHAR(512);
      273     7308
      274     7309             %SET LABNUM = 0;
      275     7310             %EQU FIRST_LOCAL_LETTER = '$';
      276     7311
      277     7312
      278     7313             %MACRO  BUILD_TOKEN;
      279     7314               DO;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:53   
      280     7315                 P_TOKEN->LX_ITEM.SYMBOL = SYMBOL_NUM;
      281     7316                 P_TOKEN->LX_ITEM.SYMPTR = ADDR(NIL);
      282     7317                 P_TOKEN->LX_ITEM.LINE = LINE#;
      283     7318                 P_TOKEN->LX_ITEM.COLUMN = INSTR_INDX + 1;
      284     7319                 IF TOKEN_LEN = 0 THEN
      285     7320                   P_TOKEN->LX_ITEM.DNTPTR = ADDR(NIL);
      286     7321                 ELSE
      287     7322                   DO;
      288     7323                     SYMLEN = TOKEN_LEN;
      289     7324                     NEWLEN = (LENGTHC(DNT.TEXT.LENGTH) + SYMLEN + 7)/ 4;
      290     7325                     CALL GETNEW(NEW$,NEWLEN);
      291     7326                     NEW$->DNT.TEXT.LENGTH = SYMLEN;
      292     7327                     CALL INSERT(NEW$->DNT.TEXT.NAME,,,
      293     7328                          SUBSTR(TOKEN_NAME,0,SYMLEN),
      294     7329                          '%%    ');
      295     7330                     P_TOKEN->LX_ITEM.DNTPTR = NEW$;
      296     7331                   END;
      297     7332               END;
      298     7333             %MEND;
      299     7334
      300     7335
      301     7336             %MACRO GETLINE;
      302     7337               DO;
      303     7338                INSTR_LEN = 0;
      304     7339                INSTR_INDX = 0;
      305     7340                IF NOT EOF_FLAG THEN
      306     7341                  CALL INPUT(INSTR,INSTR_LEN,KEY_REC);
      307     7342                IF INSTR_LEN < 1 THEN
      308     7343                  DO;
      309     7344                    EOF_FLAG = %TRUE;
      310     7345                    TOKEN_LEN = 0;
      311     7346                    SYMBOL_NUM = TERM_EOF;
      312     7347                    %BUILD_TOKEN;
      313     7348                    RETURN;
      314     7349                  END;
      315     7350                LINE# = LINE# + 1;
      316     7351                INSTR_LISTED = FALSE;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:54   
      317     7352                CALL XLATE(INT_INSTRCHR,LOWER_TO_UPPER_CASE,INSTRCHR);
      318     7353                IF OPTIONS(LS_OPT) THEN
      319     7354                  CALL FORCE_LIST;
      320     7355               END;
      321     7356             %MEND;
      322     7357
      323     7358             %MACRO SCAN_BLANKS;
      324     7359               DO;
      325     7360                 CALL SEARCH(FOUND_POS,TABVAL,BLANKS_TABLE,
      326     7361                         SUBSTR(INT_INSTRCHR,0,INSTR_LEN),INSTR_INDX) ALTRET(
      327     7362                      %SET LABNUM = LABNUM + 1;
      328     7363                      %CHARTEXT(CONCAT('LAB',BINCHAR(LABNUM))));
      329     7364                 INSTR_INDX = FOUND_POS;
      330     7365                 IF NOT %SUCCESSFUL_CALL THEN
      331     7366                   DO;
      332     7367                 %(CHARTEXT(CONCAT('LAB',BINCHAR(LABNUM)))) : ;
      333     7368                     DO WHILE (FOUND_POS = INSTR_LEN);
      334     7369                       %GETLINE;
      335     7370                       CALL SEARCH(FOUND_POS,TABVAL,BLANKS_TABLE,
      336     7371                                SUBSTR(INT_INSTRCHR,0,INSTR_LEN),INSTR_INDX);
      337     7372                       INSTR_INDX = FOUND_POS;
      338     7373                     END;
      339     7374                   END;
      340     7375               END;
      341     7376             %MEND;
      342     7377
      343     7378             %MACRO HANDLE_IDENTIFIER;
      344     7379               DO;
      345     7380                 CALL SEARCH(FOUND_POS,TABVAL,VALIDATE_IDENTIFIER_TABLE,
      346     7381                             SUBSTR(TOKEN_NAME,0,TOKEN_LEN))
      347     7382                         ALTRET(GOOD_IDENT);
      348     7383                 SYMBOL_NUM = TERM_IDENTIFIER;
      349     7384                 BUFFER = ' ';
      350     7385                 LEN = 140;
      351     7386                 CALL INSERT(BUFFER,INSTR_INDX + 20 - TOKEN_LEN + FOUND_POS,,'1');
      352     7387                 CALL FORCE_LIST;
      353     7388                 CALL OUTPUT(BUFFER,LEN);
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:55   
      354     7389                 CALL DIAG(2,BAD_CHAR);
      355     7390                 IF NOT %SUCCESSFUL_CALL THEN
      356     7391                   GOOD_IDENT : DO;
      357     7392                     IF (SUBSTR(TOKEN_NAME,0,1) >= 'A') AND
      358     7393                        (SUBSTR(TOKEN_NAME,0,1) <= 'Z') THEN
      359     7394                       SYMBOL_NUM = TERM_IDENTIFIER;
      360     7395                     ELSE
      361     7396                       IF (SUBSTR(TOKEN_NAME,0,1) = %FIRST_LOCAL_LETTER) THEN
      362     7397                         SYMBOL_NUM = TERM_LOCAL_LABEL;
      363     7398                       ELSE
      364     7399                         DO;
      365     7400                           BUFFER = ' ';
      366     7401                           LEN = 140;
      367     7402                           CALL INSERT(BUFFER,INSTR_INDX + 20 - TOKEN_LEN,,'1');
      368     7403                           CALL FORCE_LIST;
      369     7404                           CALL OUTPUT(BUFFER,LEN);
      370     7405                           CALL DIAG(4,BAD_IDENT_1,BAD_IDENT_2);
      371     7406                           SYMBOL_NUM = TERM_IDENTIFIER;
      372     7407                         END;
      373     7408                   END;
      374     7409               END;
      375     7410             %MEND;
      376     7411
      377     7412
      378     7413
      379     7414
      380     7415         /* MAIN BODY OF SCANNER */
      381     7416
      382     7417    1        IF (INSTR_INDX > INSTR_LEN) THEN
      383     7418               %GETLINE;
      384     7459
      385     7460             %SCAN_BLANKS;
      386     7519
      387     7520             /* CHECK FOR COMMENT */
      388     7521    2        DO WHILE %TRUE;
      389     7522    2          IF INT_INSTR(INSTR_INDX) = '{' THEN
      390     7523    3            DO WHILE %TRUE;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:56   
      391     7524    3              CALL SEARCH(FOUND_POS,TABVAL,COMMENT_TERMINATOR,
      392     7525    3                        SUBSTR(INT_INSTRCHR,0,INSTR_LEN),INSTR_INDX)
      393     7526    3                 ALTRET(KEEP_GOING);
      394     7527    3              INSTR_INDX = FOUND_POS + 1;
      395     7528                   %SCAN_BLANKS;
      396     7587    3              EXIT;
      397     7588    3             KEEP_GOING :
      398     7589    4              DO;
      399     7590                     %GETLINE;
      400     7631                     %SCAN_BLANKS;
      401     7690    4              END;
      402     7691    3            END;
      403     7692    2            ELSE
      404     7693    2              EXIT;
      405     7694    2          END;
      406     7695
      407     7696
      408     7697             /*SCAN FOR TOKEN*/
      409     7698    1        CALL SEARCH(FOUND_POS,TABVAL,DELIMITER_TABLE,SUBSTR(INT_INSTRCHR,0,INSTR_LEN),
              7698                 INSTR_INDX)
      410     7699    1                  ALTRET(WENT_TO_EOL);
      411     7700    1        IF FOUND_POS = INSTR_INDX THEN /* DELIM WAS FIRST CHAR FOUND */
      412     7701    2          DO;
      413     7702    2            TOKEN_LEN = 1;
      414     7703    2            TOKEN_NAME = INT_INSTR(INSTR_INDX);
      415     7704    2            INSTR_INDX = FOUND_POS + 1;
      416     7705    2          END;
      417     7706    1        ELSE
      418     7707    2          DO;
      419     7708    2            TOKEN_LEN = FOUND_POS - INSTR_INDX;
      420     7709    2            TOKEN_NAME = SUBSTR(INT_INSTRCHR,INSTR_INDX,TOKEN_LEN);
      421     7710    2            INSTR_INDX = FOUND_POS;
      422     7711    2          END;
      423     7712    1        IF NOT %SUCCESSFUL_CALL THEN
      424     7713    1         WENT_TO_EOL :
      425     7714    2          DO;
      426     7715    2            TOKEN_NAME = SUBSTR(INT_INSTRCHR,INSTR_INDX,INSTR_LEN - INSTR_INDX);
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:57   
      427     7716    2            TOKEN_LEN = INSTR_LEN - INSTR_INDX;
      428     7717    2            INSTR_INDX = INSTR_LEN + 1;
      429     7718    2          END;
      430     7719
      431     7720
      432     7721             /* CLASSIFY THE TOKEN */
      433     7722    1        MATCH = '0'B;
      434     7723    1        LOW = 1;
      435     7724    1        HIGH = LAST_TOK;
      436     7725    2        DO WHILE (HIGH >= LOW) AND NOT MATCH;
      437     7726    2          MID = (LOW + HIGH) / 2;
      438     7727    2          IF SUBSTR(TOKEN_NAME,0,TOKEN_LEN) =
      439     7728    2             SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(TOK(MID)),
      440     7729    2                    TERM_STRING.LEN(TOK(MID))) THEN
      441     7730    3            DO;
      442     7731    3              MATCH = '1'B;
      443     7732    3              EXIT;
      444     7733    3            END;
      445     7734    2          ELSE
      446     7735    3            DO;
      447     7736    3              IF SUBSTR(TOKEN_NAME,0,TOKEN_LEN) > SUBSTR(TSTRING_SPACE,
      448     7737    3                 TERM_STRING.INDX(TOK(MID)),TERM_STRING.LEN(TOK(MID))) THEN
      449     7738    3                LOW = MID + 1;
      450     7739    3              ELSE
      451     7740    3                HIGH = MID - 1;
      452     7741    3            END;
      453     7742    2          END;  /* WHILE */
      454     7743
      455     7744
      456     7745    1        IF MATCH THEN
      457     7746    1          SYMBOL_NUM = TOK(MID);
      458     7747    1        ELSE
      459     7748    2          DO;
      460     7749    2            CALL SEARCH(FOUND_POS,TABVAL,NON_INTEGER_TABLE,SUBSTR(TOKEN_NAME,0,
              7749                     TOKEN_LEN))
      461     7750    2                  ALTRET(WE_HAVE_INTEGER);
      462     7751                 %HANDLE_IDENTIFIER;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:58   
      463     7784    2            IF NOT %SUCCESSFUL_CALL THEN
      464     7785    2             WE_HAVE_INTEGER :
      465     7786    2            SYMBOL_NUM = TERM_INTEGER;
      466     7787    2          END;
      467     7788
      468     7789             %BUILD_TOKEN;
      469     7810
      470     7811    1    END SCANNER;
      471     7812         %EOD;

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:59   
--  Include file information  --

   Z8P_SCAN_TBL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_XLIT.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
   Z8P_PARS_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_PARS_STK.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure SCANNER.

   Procedure SCANNER requires 856 words for executable code.
   Procedure SCANNER requires 88 words of local(AUTO) storage.

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:60   

 Object Unit name= SCANNER                                    File name= Z8PS.:Z8A6TOU
 UTS= AUG 09 '97 09:43:32.24 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  LblCom even  none     1      1  OUT_DCBN
    2  LblCom even  none     1      1  SAVE_OUT_DCBN
    3  LblCom even  none     1      1  SAVE_DCBN2
    4   DCB   even  none     0      0  M$OU
    5   DCB   even  none     0      0  M$SO
    6   DCB   even  none     0      0  M$LO
    7   DCB   even  none     0      0  M$SI
    8   DCB   even  none     0      0  M$UI
    9   DCB   even  none     0      0  M$DO
   10  LblCom even  none     1      1  ERR_SEV
   11  LblCom even  none     1      1  OPTIONS
   12  LblCom even  none     1      1  DO_REQ
   13  LblCom even  none    26     32  OPTIONS_TEXT
   14  LblCom even  none   128    200  INSTR
   15  LblCom even  none     1      1  INSTR_LISTED
   16  LblCom even  none     1      1  INSTR_LEN
   17  LblCom even  none     1      1  INSTR_INDX
   18  LblCom even  none     1      1  EOF_FLAG
   19  LblCom even  none     5      5  KEY_REC
   20  LblCom even  none     1      1  LINES_OUT
   21  LblCom even  none    25     31  HEADER_LINE1
   22  LblCom even  none    25     31  HEADER_LINE3
   23  LblCom even  none    25     31  HEADER_LINE2
   24  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   25  LblCom even  none    28     34  LINE
   26  LblCom even  none     1      1  LINELEN
   27  LblCom even  none     1      1  PHASE
   28  LblCom even  none     1      1  ERROR_COUNT
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:61   
   29  LblCom even  none   306    462  LA_STK
   30  LblCom even  none     1      1  LX_TOP
   31  LblCom even  none   306    462  LX_STK
   32  RoData even  UTS    804   1444  SCANNER
   33   Data  even  none   129    201  SCANNER
   34  LblCom even  none     1      1  LAST_TOK
   35  LblCom even  none   210    322  TOK
   36  LblCom even  none     1      1  TERM_IDENTIFIER
   37  LblCom even  none     1      1  TERM_STRING_SYM
   38  LblCom even  none     1      1  TERM_INTEGER
   39  LblCom even  none     1      1  TERM_EOF
   40  LblCom even  none     1      1  TERM_EOL
   41  LblCom even  none     1      1  TERM_LOCAL_LABEL
   42   Proc  even  none   856   1530  SCANNER
   43  RoData even  none    17     21  SCANNER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    42      0   yes            yes      Std        1  SCANNER

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
   32      0  LOWER_TO_UPPER_CASE               32    200  BLANKS_TABLE
   32    400  COMMENT_TERMINATOR                32    600  DELIMITER_TABLE
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:62   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 INPUT
         yes           Std       2 GETNEW
         yes           Std       6 DIAG
         yes           Std       0 FORCE_LIST
         yes           Std       2 OUTPUT
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$OU                                  M$SO
     M$LO                                  M$SI                                  M$UI
     M$DO                             r    PRODR                            r    ACTION_COL
r    ACTION_ROW                       r    GOTO_COL                         r    GOTO_ROW
r    TERM_STRING                      r    TSTRING_SPACE

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:63   


      207        1        /*T***********************************************************/
      208        2        /*T*                                                         */
      209        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      210        4        /*T*                                                         */
      211        5        /*T***********************************************************/
      212        6         /*D*
      213        7               NAME: SCANNER
      214        8               DECSCRIPTION: This procedure gets the next token from the
      215        9                 input file and identifies the token.
      216       10         */
      217       11         SCANNER: PROC(P_TOKEN);

     11 42 000000   000000 700200 xent  SCANNER      TSX0  ! X66_AUTO_1
        42 000001   000130 000001                    ZERO    88,1

      218       12    1        DCL P_TOKEN PTR;
      219       13
      220       14         %INCLUDE Z8A_SYS_FILE;
      221     6289             %INCLUDE Z8P_SCAN_EXT;
      222     6478             %INCLUDE Z8P_PARS_STK;
      223     6521             %INCLUDE Z8P_PARS_DNT;
      224     6542             %INCLUDE SCDPDA_SUBS;
      225     6936             %PARSE_SYMREFS;
      226     6954             %TSTRING_SYMREFS;
      227     6960             %INCLUDE Z8P_XLIT;
      228     7149             %INCLUDE Z8P_SCAN_TBL;
      229     7222
      230     7223             %VLP_TEXTC(FPTN=BAD_CHAR,TEXT=
              7223                 '  Error => Syntax error: Identifier contains illegal character.');
      231     7238            %VLP_TEXTC(FPTN=BAD_IDENT_1,TEXT=' Error => Syntax error: Identifier begins ');
      232     7253             %VLP_TEXTC(FPTN=BAD_IDENT_2,TEXT='with an illegal character.');
      233     7268
      234     7269    1        DCL DIAG ENTRY (6);
      235     7270    1        DCL INPUT ENTRY(3);
      236     7271    1        DCL FORCE_LIST ENTRY;
      237     7272    1        DCL FLUSH ENTRY;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:64   
      238     7273    1        DCL OUT_STR ENTRY(2);
      239     7274
      240     7275    1        DCL LINE# SBIN WORD STATIC INIT(0);
      241     7276    1        DCL MAXLEN SBIN WORD;
      242     7277    1        DCL I SBIN WORD;
      243     7278
      244     7279    1        DCL LAST_TOK SBIN WORD EXT;
      245     7280    1        DCL TOK(0:%TERM_STRING_LEN) SBIN WORD EXT;
      246     7281    1        DCL NEW$ PTR;
      247     7282    1        DCL SYMLEN SBIN WORD;
      248     7283    1        DCL NEWLEN SBIN WORD;
      249     7284
      250     7285    1        DCL TERM_IDENTIFIER SBIN WORD EXT;
      251     7286    1        DCL TERM_STRING_SYM SBIN WORD EXT;
      252     7287    1        DCL TERM_INTEGER SBIN WORD EXT;
      253     7288    1        DCL TERM_EOF SBIN WORD EXT;
      254     7289    1        DCL TERM_EOL SBIN WORD EXT;
      255     7290    1        DCL TERM_LOCAL_LABEL SBIN WORD EXT;
      256     7291
      257     7292    1        DCL FOUND_POS UBIN WORD;
      258     7293    1        DCL TABVAL UBIN WORD;
      259     7294    1        DCL TOKEN_NAME CHAR(120);
      260     7295    1        DCL TOKEN_LEN UBIN WORD;
      261     7296    1        DCL SYMBOL_NUM SBIN WORD;
      262     7297    1        DCL BUFFER CHAR(140);
      263     7298    1        DCL LEN SBIN WORD;
      264     7299
      265     7300    1        DCL MID SBIN WORD;
      266     7301    1        DCL HIGH SBIN WORD;
      267     7302    1        DCL LOW SBIN WORD;
      268     7303    1        DCL MATCH BIT(1) ALIGNED;
      269     7304
      270     7305
      271     7306    1        DCL INT_INSTR (0:511) CHAR(1) UNAL STATIC;
      272     7307    1        DCL INT_INSTRCHR REDEF INT_INSTR CHAR(512);
      273     7308
      274     7309             %SET LABNUM = 0;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:65   
      275     7310             %EQU FIRST_LOCAL_LETTER = '$';
      276     7311
      277     7312
      278     7313             %MACRO  BUILD_TOKEN;
      279     7314               DO;
      280     7315                 P_TOKEN->LX_ITEM.SYMBOL = SYMBOL_NUM;
      281     7316                 P_TOKEN->LX_ITEM.SYMPTR = ADDR(NIL);
      282     7317                 P_TOKEN->LX_ITEM.LINE = LINE#;
      283     7318                 P_TOKEN->LX_ITEM.COLUMN = INSTR_INDX + 1;
      284     7319                 IF TOKEN_LEN = 0 THEN
      285     7320                   P_TOKEN->LX_ITEM.DNTPTR = ADDR(NIL);
      286     7321                 ELSE
      287     7322                   DO;
      288     7323                     SYMLEN = TOKEN_LEN;
      289     7324                     NEWLEN = (LENGTHC(DNT.TEXT.LENGTH) + SYMLEN + 7)/ 4;
      290     7325                     CALL GETNEW(NEW$,NEWLEN);
      291     7326                     NEW$->DNT.TEXT.LENGTH = SYMLEN;
      292     7327                     CALL INSERT(NEW$->DNT.TEXT.NAME,,,
      293     7328                          SUBSTR(TOKEN_NAME,0,SYMLEN),
      294     7329                          '%%    ');
      295     7330                     P_TOKEN->LX_ITEM.DNTPTR = NEW$;
      296     7331                   END;
      297     7332               END;
      298     7333             %MEND;
      299     7334
      300     7335
      301     7336             %MACRO GETLINE;
      302     7337               DO;
      303     7338                INSTR_LEN = 0;
      304     7339                INSTR_INDX = 0;
      305     7340                IF NOT EOF_FLAG THEN
      306     7341                  CALL INPUT(INSTR,INSTR_LEN,KEY_REC);
      307     7342                IF INSTR_LEN < 1 THEN
      308     7343                  DO;
      309     7344                    EOF_FLAG = %TRUE;
      310     7345                    TOKEN_LEN = 0;
      311     7346                    SYMBOL_NUM = TERM_EOF;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:66   
      312     7347                    %BUILD_TOKEN;
      313     7348                    RETURN;
      314     7349                  END;
      315     7350                LINE# = LINE# + 1;
      316     7351                INSTR_LISTED = FALSE;
      317     7352                CALL XLATE(INT_INSTRCHR,LOWER_TO_UPPER_CASE,INSTRCHR);
      318     7353                IF OPTIONS(LS_OPT) THEN
      319     7354                  CALL FORCE_LIST;
      320     7355               END;
      321     7356             %MEND;
      322     7357
      323     7358             %MACRO SCAN_BLANKS;
      324     7359               DO;
      325     7360                 CALL SEARCH(FOUND_POS,TABVAL,BLANKS_TABLE,
      326     7361                         SUBSTR(INT_INSTRCHR,0,INSTR_LEN),INSTR_INDX) ALTRET(
      327     7362                      %SET LABNUM = LABNUM + 1;
      328     7363                      %CHARTEXT(CONCAT('LAB',BINCHAR(LABNUM))));
      329     7364                 INSTR_INDX = FOUND_POS;
      330     7365                 IF NOT %SUCCESSFUL_CALL THEN
      331     7366                   DO;
      332     7367                 %(CHARTEXT(CONCAT('LAB',BINCHAR(LABNUM)))) : ;
      333     7368                     DO WHILE (FOUND_POS = INSTR_LEN);
      334     7369                       %GETLINE;
      335     7370                       CALL SEARCH(FOUND_POS,TABVAL,BLANKS_TABLE,
      336     7371                                SUBSTR(INT_INSTRCHR,0,INSTR_LEN),INSTR_INDX);
      337     7372                       INSTR_INDX = FOUND_POS;
      338     7373                     END;
      339     7374                   END;
      340     7375               END;
      341     7376             %MEND;
      342     7377
      343     7378             %MACRO HANDLE_IDENTIFIER;
      344     7379               DO;
      345     7380                 CALL SEARCH(FOUND_POS,TABVAL,VALIDATE_IDENTIFIER_TABLE,
      346     7381                             SUBSTR(TOKEN_NAME,0,TOKEN_LEN))
      347     7382                         ALTRET(GOOD_IDENT);
      348     7383                 SYMBOL_NUM = TERM_IDENTIFIER;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:67   
      349     7384                 BUFFER = ' ';
      350     7385                 LEN = 140;
      351     7386                 CALL INSERT(BUFFER,INSTR_INDX + 20 - TOKEN_LEN + FOUND_POS,,'1');
      352     7387                 CALL FORCE_LIST;
      353     7388                 CALL OUTPUT(BUFFER,LEN);
      354     7389                 CALL DIAG(2,BAD_CHAR);
      355     7390                 IF NOT %SUCCESSFUL_CALL THEN
      356     7391                   GOOD_IDENT : DO;
      357     7392                     IF (SUBSTR(TOKEN_NAME,0,1) >= 'A') AND
      358     7393                        (SUBSTR(TOKEN_NAME,0,1) <= 'Z') THEN
      359     7394                       SYMBOL_NUM = TERM_IDENTIFIER;
      360     7395                     ELSE
      361     7396                       IF (SUBSTR(TOKEN_NAME,0,1) = %FIRST_LOCAL_LETTER) THEN
      362     7397                         SYMBOL_NUM = TERM_LOCAL_LABEL;
      363     7398                       ELSE
      364     7399                         DO;
      365     7400                           BUFFER = ' ';
      366     7401                           LEN = 140;
      367     7402                           CALL INSERT(BUFFER,INSTR_INDX + 20 - TOKEN_LEN,,'1');
      368     7403                           CALL FORCE_LIST;
      369     7404                           CALL OUTPUT(BUFFER,LEN);
      370     7405                           CALL DIAG(4,BAD_IDENT_1,BAD_IDENT_2);
      371     7406                           SYMBOL_NUM = TERM_IDENTIFIER;
      372     7407                         END;
      373     7408                   END;
      374     7409               END;
      375     7410             %MEND;
      376     7411
      377     7412
      378     7413
      379     7414
      380     7415         /* MAIN BODY OF SCANNER */
      381     7416
      382     7417    1        IF (INSTR_INDX > INSTR_LEN) THEN

   7417 42 000002   000000 236000 17                 LDQ     INSTR_INDX
        42 000003   000000 116000 16                 CMPQ    INSTR_LEN
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:68   
        42 000004   000127 604400 42                 TMOZ    s:7462

      383     7418               %GETLINE;

   7420 42 000005   000000 450000 16                 STZ     INSTR_LEN

   7421 42 000006   000000 450000 17                 STZ     INSTR_INDX

   7422 42 000007   000000 234000 18                 SZN     EOF_FLAG
        42 000010   000015 604000 42                 TMI     s:7424

   7423 42 000011   000001 630400 43                 EPPR0   1
        42 000012   000000 631400 43                 EPPR1   0
        42 000013   000000 701000 xent               TSX1    INPUT
        42 000014   000000 011000                    NOP     0

   7424 42 000015   000000 235000 16                 LDA     INSTR_LEN
        42 000016   000114 605400 42                 TPNZ    s:7452

   7426 42 000017   400000 236003                    LDQ     -131072,DU
        42 000020   000000 756000 18                 STQ     EOF_FLAG

   7427 42 000021   200051 450100                    STZ     TOKEN_LEN,,AUTO

   7428 42 000022   000000 235000 39                 LDA     TERM_EOF
        42 000023   200052 755100                    STA     SYMBOL_NUM,,AUTO

   7431 42 000024   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000025   000000 471500                    LDP1    0,,PR0
        42 000026   100002 755100                    STA     2,,PR1

   7432 42 000027   000000 471500                    LDP1    0,,PR0
        42 000030   000004 236000 43                 LDQ     4
        42 000031   100000 756100                    STQ     0,,PR1

   7433 42 000032   000000 471500                    LDP1    0,,PR0
        42 000033   000000 236000 33                 LDQ     LINE#
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:69   
        42 000034   100003 756100                    STQ     3,,PR1

   7434 42 000035   000000 471500                    LDP1    0,,PR0
        42 000036   000000 235000 17                 LDA     INSTR_INDX
        42 000037   000001 035007                    ADLA    1,DL
        42 000040   100004 755100                    STA     4,,PR1

   7435 42 000041   200051 235100                    LDA     TOKEN_LEN,,AUTO
        42 000042   000047 601000 42                 TNZ     s:7439

   7436 42 000043   000000 471500                    LDP1    0,,PR0
        42 000044   000004 236000 43                 LDQ     4
        42 000045   100001 756100                    STQ     1,,PR1
        42 000046   000113 710000 42                 TRA     s:7450

   7439 42 000047   200007 755100                    STA     SYMLEN,,AUTO

   7440 42 000050   200007 236100                    LDQ     SYMLEN,,AUTO
        42 000051   000013 036007                    ADLQ    11,DL
        42 000052   000004 506007                    DIV     4,DL
        42 000053   200010 756100                    STQ     NEWLEN,,AUTO

   7441 42 000054   200010 631500                    EPPR1   NEWLEN,,AUTO
        42 000055   200125 451500                    STP1    MATCH+3,,AUTO
        42 000056   200006 633500                    EPPR3   NEW$,,AUTO
        42 000057   200124 453500                    STP3    MATCH+2,,AUTO
        42 000060   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 000061   000005 631400 43                 EPPR1   5
        42 000062   000000 701000 xent               TSX1    GETNEW
        42 000063   000000 011000                    NOP     0

   7442 42 000064   200006 470500                    LDP0    NEW$,,AUTO
        42 000065   200007 235100                    LDA     SYMLEN,,AUTO
        42 000066   000000 755100                    STA     0,,PR0

   7443 42 000067   200006 470500                    LDP0    NEW$,,AUTO
        42 000070   000000 720100                    LXL0    0,,PR0
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:70   
        42 000071   000000 621005                    EAX1    0,AL
        42 000072   040140 100540                    MLR     fill='040'O
        42 000073   200013 000011                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X1
        42 000074   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        42 000075   000000 636010                    EAQ     0,X0
        42 000076   000022 732000                    QRS     18
        42 000077   200007 136100                    SBLQ    SYMLEN,,AUTO
        42 000100   000107 604400 42                 TMOZ    s:7446
        42 000101   200006 470500                    LDP0    NEW$,,AUTO
        42 000102   000000 620006                    EAX0    0,QL
        42 000103   200007 235100                    LDA     SYMLEN,,AUTO
        42 000104   040145 100400                    MLR     fill='040'O
        42 000105   001442 000006 32                 ADSC9   BAD_IDENT_2+7            cn=0,n=6
        42 000106   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0

   7446 42 000107   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000110   000000 471500                    LDP1    0,,PR0
        42 000111   200006 236100                    LDQ     NEW$,,AUTO
        42 000112   100001 756100                    STQ     1,,PR1

   7450 42 000113   000000 702200 xent               TSX2  ! X66_ARET

   7452 42 000114   000000 054000 33                 AOS     LINE#

   7453 42 000115   000000 450000 15                 STZ     INSTR_LISTED

   7454 42 000116   040000 160400                    MVT     fill='040'O
        42 000117   000000 001000 14                 ADSC9   INSTR                    cn=0,n=512
        42 000120   000001 001000 33                 ADSC9   INT_INSTR                cn=0,n=512
        42 000121   000000 000000 32                 ARG     LOWER_TO_UPPER_CASE

   7455 42 000122   000000 234000 11                 SZN     OPTIONS
        42 000123   000127 605000 42                 TPL     s:7462

   7456 42 000124   000006 631400 43                 EPPR1   6
        42 000125   000000 701000 xent               TSX1    FORCE_LIST
        42 000126   000000 011000                    NOP     0
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:71   

      384     7459
      385     7460             %SCAN_BLANKS;

   7462 42 000127   000000 236000 16                 LDQ     INSTR_LEN
        42 000130   000000 136000 17                 SBLQ    INSTR_INDX
        42 000131   200124 756100                    STQ     MATCH+2,,AUTO
        42 000132   000000 236000 17                 LDQ     INSTR_INDX
        42 000133   200124 720100                    LXL0    MATCH+2,,AUTO
        42 000134   000000 164446                    TCT
        42 000135   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 000136   000200 000000 32                 ARG     BLANKS_TABLE
        42 000137   200011 000100                    ARG     FOUND_POS,,AUTO
        42 000140   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000141   000033 771000                    ARL     27
        42 000142   200012 755100                    STA     TABVAL,,AUTO
        42 000143   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 000144   200011 056100                    ASQ     FOUND_POS,,AUTO
        42 000145   000151 606400 42                 TTN     LAB1

   7466 42 000146   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000147   000000 755000 17                 STA     INSTR_INDX

   7467 42 000150   000323 710000 42                 TRA     s:7522

   7463 42 000151                       LAB1         null
   7470 42 000151   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 000152   000323 604000 42                 TMI     s:7522
        42 000153   000000 116000 16                 CMPQ    INSTR_LEN
        42 000154   000323 601000 42                 TNZ     s:7522

   7473 42 000155   000000 450000 16                 STZ     INSTR_LEN

   7474 42 000156   000000 450000 17                 STZ     INSTR_INDX

   7475 42 000157   000000 234000 18                 SZN     EOF_FLAG
        42 000160   000165 604000 42                 TMI     s:7477
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:72   

   7476 42 000161   000001 630400 43                 EPPR0   1
        42 000162   000000 631400 43                 EPPR1   0
        42 000163   000000 701000 xent               TSX1    INPUT
        42 000164   000000 011000                    NOP     0

   7477 42 000165   000000 235000 16                 LDA     INSTR_LEN
        42 000166   000264 605400 42                 TPNZ    s:7505

   7479 42 000167   400000 236003                    LDQ     -131072,DU
        42 000170   000000 756000 18                 STQ     EOF_FLAG

   7480 42 000171   200051 450100                    STZ     TOKEN_LEN,,AUTO

   7481 42 000172   000000 235000 39                 LDA     TERM_EOF
        42 000173   200052 755100                    STA     SYMBOL_NUM,,AUTO

   7484 42 000174   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000175   000000 471500                    LDP1    0,,PR0
        42 000176   100002 755100                    STA     2,,PR1

   7485 42 000177   000000 471500                    LDP1    0,,PR0
        42 000200   000004 236000 43                 LDQ     4
        42 000201   100000 756100                    STQ     0,,PR1

   7486 42 000202   000000 471500                    LDP1    0,,PR0
        42 000203   000000 236000 33                 LDQ     LINE#
        42 000204   100003 756100                    STQ     3,,PR1

   7487 42 000205   000000 471500                    LDP1    0,,PR0
        42 000206   000000 235000 17                 LDA     INSTR_INDX
        42 000207   000001 035007                    ADLA    1,DL
        42 000210   100004 755100                    STA     4,,PR1

   7488 42 000211   200051 235100                    LDA     TOKEN_LEN,,AUTO
        42 000212   000217 601000 42                 TNZ     s:7492

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:73   
   7489 42 000213   000000 471500                    LDP1    0,,PR0
        42 000214   000004 236000 43                 LDQ     4
        42 000215   100001 756100                    STQ     1,,PR1
        42 000216   000263 710000 42                 TRA     s:7503

   7492 42 000217   200007 755100                    STA     SYMLEN,,AUTO

   7493 42 000220   200007 236100                    LDQ     SYMLEN,,AUTO
        42 000221   000013 036007                    ADLQ    11,DL
        42 000222   000004 506007                    DIV     4,DL
        42 000223   200010 756100                    STQ     NEWLEN,,AUTO

   7494 42 000224   200010 631500                    EPPR1   NEWLEN,,AUTO
        42 000225   200125 451500                    STP1    MATCH+3,,AUTO
        42 000226   200006 633500                    EPPR3   NEW$,,AUTO
        42 000227   200124 453500                    STP3    MATCH+2,,AUTO
        42 000230   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 000231   000005 631400 43                 EPPR1   5
        42 000232   000000 701000 xent               TSX1    GETNEW
        42 000233   000000 011000                    NOP     0

   7495 42 000234   200006 470500                    LDP0    NEW$,,AUTO
        42 000235   200007 235100                    LDA     SYMLEN,,AUTO
        42 000236   000000 755100                    STA     0,,PR0

   7496 42 000237   200006 470500                    LDP0    NEW$,,AUTO
        42 000240   000000 720100                    LXL0    0,,PR0
        42 000241   000000 621005                    EAX1    0,AL
        42 000242   040140 100540                    MLR     fill='040'O
        42 000243   200013 000011                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X1
        42 000244   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        42 000245   000000 636010                    EAQ     0,X0
        42 000246   000022 732000                    QRS     18
        42 000247   200007 136100                    SBLQ    SYMLEN,,AUTO
        42 000250   000257 604400 42                 TMOZ    s:7499
        42 000251   200006 470500                    LDP0    NEW$,,AUTO
        42 000252   000000 620006                    EAX0    0,QL
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:74   
        42 000253   200007 235100                    LDA     SYMLEN,,AUTO
        42 000254   040145 100400                    MLR     fill='040'O
        42 000255   001442 000006 32                 ADSC9   BAD_IDENT_2+7            cn=0,n=6
        42 000256   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0

   7499 42 000257   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000260   000000 471500                    LDP1    0,,PR0
        42 000261   200006 236100                    LDQ     NEW$,,AUTO
        42 000262   100001 756100                    STQ     1,,PR1

   7503 42 000263   000000 702200 xent               TSX2  ! X66_ARET

   7505 42 000264   000000 054000 33                 AOS     LINE#

   7506 42 000265   000000 450000 15                 STZ     INSTR_LISTED

   7507 42 000266   040000 160400                    MVT     fill='040'O
        42 000267   000000 001000 14                 ADSC9   INSTR                    cn=0,n=512
        42 000270   000001 001000 33                 ADSC9   INT_INSTR                cn=0,n=512
        42 000271   000000 000000 32                 ARG     LOWER_TO_UPPER_CASE

   7508 42 000272   000000 234000 11                 SZN     OPTIONS
        42 000273   000277 605000 42                 TPL     s:7512

   7509 42 000274   000006 631400 43                 EPPR1   6
        42 000275   000000 701000 xent               TSX1    FORCE_LIST
        42 000276   000000 011000                    NOP     0

   7512 42 000277   000000 236000 16                 LDQ     INSTR_LEN
        42 000300   000000 136000 17                 SBLQ    INSTR_INDX
        42 000301   200124 756100                    STQ     MATCH+2,,AUTO
        42 000302   000000 236000 17                 LDQ     INSTR_INDX
        42 000303   200124 720100                    LXL0    MATCH+2,,AUTO
        42 000304   000000 164446                    TCT
        42 000305   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 000306   000200 000000 32                 ARG     BLANKS_TABLE
        42 000307   200011 000100                    ARG     FOUND_POS,,AUTO
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:75   
        42 000310   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000311   000033 771000                    ARL     27
        42 000312   200012 755100                    STA     TABVAL,,AUTO
        42 000313   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 000314   200011 056100                    ASQ     FOUND_POS,,AUTO

   7514 42 000315   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000316   000000 755000 17                 STA     INSTR_INDX

   7515 42 000317   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 000320   000323 604000 42                 TMI     s:7522
        42 000321   000000 116000 16                 CMPQ    INSTR_LEN
        42 000322   000155 600000 42                 TZE     s:7473

      386     7519
      387     7520             /* CHECK FOR COMMENT */
      388     7521    2        DO WHILE %TRUE;

      389     7522    2          IF INT_INSTR(INSTR_INDX) = '{' THEN

   7522 42 000323   000000 235000 17                 LDA     INSTR_INDX
        42 000324   040000 106405                    CMPC    fill='040'O
        42 000325   000001 000001 33                 ADSC9   INT_INSTR,A              cn=0,n=1
        42 000326   000007 000001 43                 ADSC9   7                        cn=0,n=1
        42 000327   001067 601000 42                 TNZ     s:7698

      390     7523    3            DO WHILE %TRUE;

      391     7524    3              CALL SEARCH(FOUND_POS,TABVAL,COMMENT_TERMINATOR,

   7524 42 000330   000000 236000 16                 LDQ     INSTR_LEN
        42 000331   000000 136000 17                 SBLQ    INSTR_INDX
        42 000332   200124 756100                    STQ     MATCH+2,,AUTO
        42 000333   000000 236000 17                 LDQ     INSTR_INDX
        42 000334   200124 720100                    LXL0    MATCH+2,,AUTO
        42 000335   000000 164446                    TCT
        42 000336   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:76   
        42 000337   000400 000000 32                 ARG     COMMENT_TERMINATOR
        42 000340   200011 000100                    ARG     FOUND_POS,,AUTO
        42 000341   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000342   000033 771000                    ARL     27
        42 000343   200012 755100                    STA     TABVAL,,AUTO
        42 000344   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 000345   200011 056100                    ASQ     FOUND_POS,,AUTO
        42 000346   000547 606400 42                 TTN     KEEP_GOING

      392     7525    3                        SUBSTR(INT_INSTRCHR,0,INSTR_LEN),INSTR_INDX)
      393     7526    3                 ALTRET(KEEP_GOING);
      394     7527    3              INSTR_INDX = FOUND_POS + 1;

   7527 42 000347   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000350   000001 035007                    ADLA    1,DL
        42 000351   000000 755000 17                 STA     INSTR_INDX

      395     7528                   %SCAN_BLANKS;

   7530 42 000352   000000 236000 16                 LDQ     INSTR_LEN
        42 000353   000000 136000 17                 SBLQ    INSTR_INDX
        42 000354   200124 756100                    STQ     MATCH+2,,AUTO
        42 000355   000000 236000 17                 LDQ     INSTR_INDX
        42 000356   200124 720100                    LXL0    MATCH+2,,AUTO
        42 000357   000000 164446                    TCT
        42 000360   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 000361   000200 000000 32                 ARG     BLANKS_TABLE
        42 000362   200011 000100                    ARG     FOUND_POS,,AUTO
        42 000363   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000364   000033 771000                    ARL     27
        42 000365   200012 755100                    STA     TABVAL,,AUTO
        42 000366   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 000367   200011 056100                    ASQ     FOUND_POS,,AUTO
        42 000370   000374 606400 42                 TTN     LAB2

   7534 42 000371   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000372   000000 755000 17                 STA     INSTR_INDX
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:77   

   7535 42 000373   000546 710000 42                 TRA     s:7587

   7531 42 000374                       LAB2         null
   7538 42 000374   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 000375   000546 604000 42                 TMI     s:7587
        42 000376   000000 116000 16                 CMPQ    INSTR_LEN
        42 000377   000546 601000 42                 TNZ     s:7587

   7541 42 000400   000000 450000 16                 STZ     INSTR_LEN

   7542 42 000401   000000 450000 17                 STZ     INSTR_INDX

   7543 42 000402   000000 234000 18                 SZN     EOF_FLAG
        42 000403   000410 604000 42                 TMI     s:7545

   7544 42 000404   000001 630400 43                 EPPR0   1
        42 000405   000000 631400 43                 EPPR1   0
        42 000406   000000 701000 xent               TSX1    INPUT
        42 000407   000000 011000                    NOP     0

   7545 42 000410   000000 235000 16                 LDA     INSTR_LEN
        42 000411   000507 605400 42                 TPNZ    s:7573

   7547 42 000412   400000 236003                    LDQ     -131072,DU
        42 000413   000000 756000 18                 STQ     EOF_FLAG

   7548 42 000414   200051 450100                    STZ     TOKEN_LEN,,AUTO

   7549 42 000415   000000 235000 39                 LDA     TERM_EOF
        42 000416   200052 755100                    STA     SYMBOL_NUM,,AUTO

   7552 42 000417   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000420   000000 471500                    LDP1    0,,PR0
        42 000421   100002 755100                    STA     2,,PR1

   7553 42 000422   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:78   
        42 000423   000004 236000 43                 LDQ     4
        42 000424   100000 756100                    STQ     0,,PR1

   7554 42 000425   000000 471500                    LDP1    0,,PR0
        42 000426   000000 236000 33                 LDQ     LINE#
        42 000427   100003 756100                    STQ     3,,PR1

   7555 42 000430   000000 471500                    LDP1    0,,PR0
        42 000431   000000 235000 17                 LDA     INSTR_INDX
        42 000432   000001 035007                    ADLA    1,DL
        42 000433   100004 755100                    STA     4,,PR1

   7556 42 000434   200051 235100                    LDA     TOKEN_LEN,,AUTO
        42 000435   000442 601000 42                 TNZ     s:7560

   7557 42 000436   000000 471500                    LDP1    0,,PR0
        42 000437   000004 236000 43                 LDQ     4
        42 000440   100001 756100                    STQ     1,,PR1
        42 000441   000506 710000 42                 TRA     s:7571

   7560 42 000442   200007 755100                    STA     SYMLEN,,AUTO

   7561 42 000443   200007 236100                    LDQ     SYMLEN,,AUTO
        42 000444   000013 036007                    ADLQ    11,DL
        42 000445   000004 506007                    DIV     4,DL
        42 000446   200010 756100                    STQ     NEWLEN,,AUTO

   7562 42 000447   200010 631500                    EPPR1   NEWLEN,,AUTO
        42 000450   200125 451500                    STP1    MATCH+3,,AUTO
        42 000451   200006 633500                    EPPR3   NEW$,,AUTO
        42 000452   200124 453500                    STP3    MATCH+2,,AUTO
        42 000453   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 000454   000005 631400 43                 EPPR1   5
        42 000455   000000 701000 xent               TSX1    GETNEW
        42 000456   000000 011000                    NOP     0

   7563 42 000457   200006 470500                    LDP0    NEW$,,AUTO
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:79   
        42 000460   200007 235100                    LDA     SYMLEN,,AUTO
        42 000461   000000 755100                    STA     0,,PR0

   7564 42 000462   200006 470500                    LDP0    NEW$,,AUTO
        42 000463   000000 720100                    LXL0    0,,PR0
        42 000464   000000 621005                    EAX1    0,AL
        42 000465   040140 100540                    MLR     fill='040'O
        42 000466   200013 000011                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X1
        42 000467   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        42 000470   000000 636010                    EAQ     0,X0
        42 000471   000022 732000                    QRS     18
        42 000472   200007 136100                    SBLQ    SYMLEN,,AUTO
        42 000473   000502 604400 42                 TMOZ    s:7567
        42 000474   200006 470500                    LDP0    NEW$,,AUTO
        42 000475   000000 620006                    EAX0    0,QL
        42 000476   200007 235100                    LDA     SYMLEN,,AUTO
        42 000477   040145 100400                    MLR     fill='040'O
        42 000500   001442 000006 32                 ADSC9   BAD_IDENT_2+7            cn=0,n=6
        42 000501   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0

   7567 42 000502   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000503   000000 471500                    LDP1    0,,PR0
        42 000504   200006 236100                    LDQ     NEW$,,AUTO
        42 000505   100001 756100                    STQ     1,,PR1

   7571 42 000506   000000 702200 xent               TSX2  ! X66_ARET

   7573 42 000507   000000 054000 33                 AOS     LINE#

   7574 42 000510   000000 450000 15                 STZ     INSTR_LISTED

   7575 42 000511   040000 160400                    MVT     fill='040'O
        42 000512   000000 001000 14                 ADSC9   INSTR                    cn=0,n=512
        42 000513   000001 001000 33                 ADSC9   INT_INSTR                cn=0,n=512
        42 000514   000000 000000 32                 ARG     LOWER_TO_UPPER_CASE

   7576 42 000515   000000 234000 11                 SZN     OPTIONS
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:80   
        42 000516   000522 605000 42                 TPL     s:7580

   7577 42 000517   000006 631400 43                 EPPR1   6
        42 000520   000000 701000 xent               TSX1    FORCE_LIST
        42 000521   000000 011000                    NOP     0

   7580 42 000522   000000 236000 16                 LDQ     INSTR_LEN
        42 000523   000000 136000 17                 SBLQ    INSTR_INDX
        42 000524   200124 756100                    STQ     MATCH+2,,AUTO
        42 000525   000000 236000 17                 LDQ     INSTR_INDX
        42 000526   200124 720100                    LXL0    MATCH+2,,AUTO
        42 000527   000000 164446                    TCT
        42 000530   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 000531   000200 000000 32                 ARG     BLANKS_TABLE
        42 000532   200011 000100                    ARG     FOUND_POS,,AUTO
        42 000533   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000534   000033 771000                    ARL     27
        42 000535   200012 755100                    STA     TABVAL,,AUTO
        42 000536   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 000537   200011 056100                    ASQ     FOUND_POS,,AUTO

   7582 42 000540   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000541   000000 755000 17                 STA     INSTR_INDX

   7583 42 000542   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 000543   000546 604000 42                 TMI     s:7587
        42 000544   000000 116000 16                 CMPQ    INSTR_LEN
        42 000545   000400 600000 42                 TZE     s:7541

      396     7587    3              EXIT;

   7587 42 000546   001066 710000 42                 TRA     s:7691+1

      397     7588    3             KEEP_GOING :
      398     7589    4              DO;

   7589 42 000547                       KEEP_GOING   null
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:81   
      399     7590                     %GETLINE;

   7592 42 000547   000000 450000 16                 STZ     INSTR_LEN

   7593 42 000550   000000 450000 17                 STZ     INSTR_INDX

   7594 42 000551   000000 234000 18                 SZN     EOF_FLAG
        42 000552   000557 604000 42                 TMI     s:7596

   7595 42 000553   000001 630400 43                 EPPR0   1
        42 000554   000000 631400 43                 EPPR1   0
        42 000555   000000 701000 xent               TSX1    INPUT
        42 000556   000000 011000                    NOP     0

   7596 42 000557   000000 235000 16                 LDA     INSTR_LEN
        42 000560   000656 605400 42                 TPNZ    s:7624

   7598 42 000561   400000 236003                    LDQ     -131072,DU
        42 000562   000000 756000 18                 STQ     EOF_FLAG

   7599 42 000563   200051 450100                    STZ     TOKEN_LEN,,AUTO

   7600 42 000564   000000 235000 39                 LDA     TERM_EOF
        42 000565   200052 755100                    STA     SYMBOL_NUM,,AUTO

   7603 42 000566   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000567   000000 471500                    LDP1    0,,PR0
        42 000570   100002 755100                    STA     2,,PR1

   7604 42 000571   000000 471500                    LDP1    0,,PR0
        42 000572   000004 236000 43                 LDQ     4
        42 000573   100000 756100                    STQ     0,,PR1

   7605 42 000574   000000 471500                    LDP1    0,,PR0
        42 000575   000000 236000 33                 LDQ     LINE#
        42 000576   100003 756100                    STQ     3,,PR1

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:82   
   7606 42 000577   000000 471500                    LDP1    0,,PR0
        42 000600   000000 235000 17                 LDA     INSTR_INDX
        42 000601   000001 035007                    ADLA    1,DL
        42 000602   100004 755100                    STA     4,,PR1

   7607 42 000603   200051 235100                    LDA     TOKEN_LEN,,AUTO
        42 000604   000611 601000 42                 TNZ     s:7611

   7608 42 000605   000000 471500                    LDP1    0,,PR0
        42 000606   000004 236000 43                 LDQ     4
        42 000607   100001 756100                    STQ     1,,PR1
        42 000610   000655 710000 42                 TRA     s:7622

   7611 42 000611   200007 755100                    STA     SYMLEN,,AUTO

   7612 42 000612   200007 236100                    LDQ     SYMLEN,,AUTO
        42 000613   000013 036007                    ADLQ    11,DL
        42 000614   000004 506007                    DIV     4,DL
        42 000615   200010 756100                    STQ     NEWLEN,,AUTO

   7613 42 000616   200010 631500                    EPPR1   NEWLEN,,AUTO
        42 000617   200125 451500                    STP1    MATCH+3,,AUTO
        42 000620   200006 633500                    EPPR3   NEW$,,AUTO
        42 000621   200124 453500                    STP3    MATCH+2,,AUTO
        42 000622   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 000623   000005 631400 43                 EPPR1   5
        42 000624   000000 701000 xent               TSX1    GETNEW
        42 000625   000000 011000                    NOP     0

   7614 42 000626   200006 470500                    LDP0    NEW$,,AUTO
        42 000627   200007 235100                    LDA     SYMLEN,,AUTO
        42 000630   000000 755100                    STA     0,,PR0

   7615 42 000631   200006 470500                    LDP0    NEW$,,AUTO
        42 000632   000000 720100                    LXL0    0,,PR0
        42 000633   000000 621005                    EAX1    0,AL
        42 000634   040140 100540                    MLR     fill='040'O
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:83   
        42 000635   200013 000011                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X1
        42 000636   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        42 000637   000000 636010                    EAQ     0,X0
        42 000640   000022 732000                    QRS     18
        42 000641   200007 136100                    SBLQ    SYMLEN,,AUTO
        42 000642   000651 604400 42                 TMOZ    s:7618
        42 000643   200006 470500                    LDP0    NEW$,,AUTO
        42 000644   000000 620006                    EAX0    0,QL
        42 000645   200007 235100                    LDA     SYMLEN,,AUTO
        42 000646   040145 100400                    MLR     fill='040'O
        42 000647   001442 000006 32                 ADSC9   BAD_IDENT_2+7            cn=0,n=6
        42 000650   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0

   7618 42 000651   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000652   000000 471500                    LDP1    0,,PR0
        42 000653   200006 236100                    LDQ     NEW$,,AUTO
        42 000654   100001 756100                    STQ     1,,PR1

   7622 42 000655   000000 702200 xent               TSX2  ! X66_ARET

   7624 42 000656   000000 054000 33                 AOS     LINE#

   7625 42 000657   000000 450000 15                 STZ     INSTR_LISTED

   7626 42 000660   040000 160400                    MVT     fill='040'O
        42 000661   000000 001000 14                 ADSC9   INSTR                    cn=0,n=512
        42 000662   000001 001000 33                 ADSC9   INT_INSTR                cn=0,n=512
        42 000663   000000 000000 32                 ARG     LOWER_TO_UPPER_CASE

   7627 42 000664   000000 234000 11                 SZN     OPTIONS
        42 000665   000671 605000 42                 TPL     s:7633

   7628 42 000666   000006 631400 43                 EPPR1   6
        42 000667   000000 701000 xent               TSX1    FORCE_LIST
        42 000670   000000 011000                    NOP     0

      400     7631                     %SCAN_BLANKS;
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:84   

   7633 42 000671   000000 236000 16                 LDQ     INSTR_LEN
        42 000672   000000 136000 17                 SBLQ    INSTR_INDX
        42 000673   200124 756100                    STQ     MATCH+2,,AUTO
        42 000674   000000 236000 17                 LDQ     INSTR_INDX
        42 000675   200124 720100                    LXL0    MATCH+2,,AUTO
        42 000676   000000 164446                    TCT
        42 000677   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 000700   000200 000000 32                 ARG     BLANKS_TABLE
        42 000701   200011 000100                    ARG     FOUND_POS,,AUTO
        42 000702   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000703   000033 771000                    ARL     27
        42 000704   200012 755100                    STA     TABVAL,,AUTO
        42 000705   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 000706   200011 056100                    ASQ     FOUND_POS,,AUTO
        42 000707   000713 606400 42                 TTN     LAB3

   7637 42 000710   200011 235100                    LDA     FOUND_POS,,AUTO
        42 000711   000000 755000 17                 STA     INSTR_INDX

   7638 42 000712   000330 710000 42                 TRA     s:7524

   7634 42 000713                       LAB3         null
   7641 42 000713   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 000714   000330 604000 42                 TMI     s:7524
        42 000715   000000 116000 16                 CMPQ    INSTR_LEN
        42 000716   000330 601000 42                 TNZ     s:7524

   7644 42 000717   000000 450000 16                 STZ     INSTR_LEN

   7645 42 000720   000000 450000 17                 STZ     INSTR_INDX

   7646 42 000721   000000 234000 18                 SZN     EOF_FLAG
        42 000722   000727 604000 42                 TMI     s:7648

   7647 42 000723   000001 630400 43                 EPPR0   1
        42 000724   000000 631400 43                 EPPR1   0
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:85   
        42 000725   000000 701000 xent               TSX1    INPUT
        42 000726   000000 011000                    NOP     0

   7648 42 000727   000000 235000 16                 LDA     INSTR_LEN
        42 000730   001026 605400 42                 TPNZ    s:7676

   7650 42 000731   400000 236003                    LDQ     -131072,DU
        42 000732   000000 756000 18                 STQ     EOF_FLAG

   7651 42 000733   200051 450100                    STZ     TOKEN_LEN,,AUTO

   7652 42 000734   000000 235000 39                 LDA     TERM_EOF
        42 000735   200052 755100                    STA     SYMBOL_NUM,,AUTO

   7655 42 000736   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 000737   000000 471500                    LDP1    0,,PR0
        42 000740   100002 755100                    STA     2,,PR1

   7656 42 000741   000000 471500                    LDP1    0,,PR0
        42 000742   000004 236000 43                 LDQ     4
        42 000743   100000 756100                    STQ     0,,PR1

   7657 42 000744   000000 471500                    LDP1    0,,PR0
        42 000745   000000 236000 33                 LDQ     LINE#
        42 000746   100003 756100                    STQ     3,,PR1

   7658 42 000747   000000 471500                    LDP1    0,,PR0
        42 000750   000000 235000 17                 LDA     INSTR_INDX
        42 000751   000001 035007                    ADLA    1,DL
        42 000752   100004 755100                    STA     4,,PR1

   7659 42 000753   200051 235100                    LDA     TOKEN_LEN,,AUTO
        42 000754   000761 601000 42                 TNZ     s:7663

   7660 42 000755   000000 471500                    LDP1    0,,PR0
        42 000756   000004 236000 43                 LDQ     4
        42 000757   100001 756100                    STQ     1,,PR1
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:86   
        42 000760   001025 710000 42                 TRA     s:7674

   7663 42 000761   200007 755100                    STA     SYMLEN,,AUTO

   7664 42 000762   200007 236100                    LDQ     SYMLEN,,AUTO
        42 000763   000013 036007                    ADLQ    11,DL
        42 000764   000004 506007                    DIV     4,DL
        42 000765   200010 756100                    STQ     NEWLEN,,AUTO

   7665 42 000766   200010 631500                    EPPR1   NEWLEN,,AUTO
        42 000767   200125 451500                    STP1    MATCH+3,,AUTO
        42 000770   200006 633500                    EPPR3   NEW$,,AUTO
        42 000771   200124 453500                    STP3    MATCH+2,,AUTO
        42 000772   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 000773   000005 631400 43                 EPPR1   5
        42 000774   000000 701000 xent               TSX1    GETNEW
        42 000775   000000 011000                    NOP     0

   7666 42 000776   200006 470500                    LDP0    NEW$,,AUTO
        42 000777   200007 235100                    LDA     SYMLEN,,AUTO
        42 001000   000000 755100                    STA     0,,PR0

   7667 42 001001   200006 470500                    LDP0    NEW$,,AUTO
        42 001002   000000 720100                    LXL0    0,,PR0
        42 001003   000000 621005                    EAX1    0,AL
        42 001004   040140 100540                    MLR     fill='040'O
        42 001005   200013 000011                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X1
        42 001006   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        42 001007   000000 636010                    EAQ     0,X0
        42 001010   000022 732000                    QRS     18
        42 001011   200007 136100                    SBLQ    SYMLEN,,AUTO
        42 001012   001021 604400 42                 TMOZ    s:7670
        42 001013   200006 470500                    LDP0    NEW$,,AUTO
        42 001014   000000 620006                    EAX0    0,QL
        42 001015   200007 235100                    LDA     SYMLEN,,AUTO
        42 001016   040145 100400                    MLR     fill='040'O
        42 001017   001442 000006 32                 ADSC9   BAD_IDENT_2+7            cn=0,n=6
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:87   
        42 001020   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0

   7670 42 001021   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 001022   000000 471500                    LDP1    0,,PR0
        42 001023   200006 236100                    LDQ     NEW$,,AUTO
        42 001024   100001 756100                    STQ     1,,PR1

   7674 42 001025   000000 702200 xent               TSX2  ! X66_ARET

   7676 42 001026   000000 054000 33                 AOS     LINE#

   7677 42 001027   000000 450000 15                 STZ     INSTR_LISTED

   7678 42 001030   040000 160400                    MVT     fill='040'O
        42 001031   000000 001000 14                 ADSC9   INSTR                    cn=0,n=512
        42 001032   000001 001000 33                 ADSC9   INT_INSTR                cn=0,n=512
        42 001033   000000 000000 32                 ARG     LOWER_TO_UPPER_CASE

   7679 42 001034   000000 234000 11                 SZN     OPTIONS
        42 001035   001041 605000 42                 TPL     s:7683

   7680 42 001036   000006 631400 43                 EPPR1   6
        42 001037   000000 701000 xent               TSX1    FORCE_LIST
        42 001040   000000 011000                    NOP     0

   7683 42 001041   000000 236000 16                 LDQ     INSTR_LEN
        42 001042   000000 136000 17                 SBLQ    INSTR_INDX
        42 001043   200124 756100                    STQ     MATCH+2,,AUTO
        42 001044   000000 236000 17                 LDQ     INSTR_INDX
        42 001045   200124 720100                    LXL0    MATCH+2,,AUTO
        42 001046   000000 164446                    TCT
        42 001047   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 001050   000200 000000 32                 ARG     BLANKS_TABLE
        42 001051   200011 000100                    ARG     FOUND_POS,,AUTO
        42 001052   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001053   000033 771000                    ARL     27
        42 001054   200012 755100                    STA     TABVAL,,AUTO
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:88   
        42 001055   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 001056   200011 056100                    ASQ     FOUND_POS,,AUTO

   7685 42 001057   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001060   000000 755000 17                 STA     INSTR_INDX

   7686 42 001061   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 001062   001065 604000 42                 TMI     s:7691
        42 001063   000000 116000 16                 CMPQ    INSTR_LEN
        42 001064   000717 600000 42                 TZE     s:7644

      401     7690    4              END;

      402     7691    3            END;

   7691 42 001065   000330 710000 42                 TRA     s:7524
        42 001066   000323 710000 42                 TRA     s:7522

      403     7692    2            ELSE
      404     7693    2              EXIT;
      405     7694    2          END;

      406     7695
      407     7696
      408     7697             /*SCAN FOR TOKEN*/
      409     7698    1        CALL SEARCH(FOUND_POS,TABVAL,DELIMITER_TABLE,SUBSTR(INT_INSTRCHR,0,INSTR_LEN),
              7698                 INSTR_INDX)

   7698 42 001067   000000 236000 16                 LDQ     INSTR_LEN
        42 001070   000000 136000 17                 SBLQ    INSTR_INDX
        42 001071   200124 756100                    STQ     MATCH+2,,AUTO
        42 001072   000000 236000 17                 LDQ     INSTR_INDX
        42 001073   200124 720100                    LXL0    MATCH+2,,AUTO
        42 001074   000000 164446                    TCT
        42 001075   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 001076   000600 000000 32                 ARG     DELIMITER_TABLE
        42 001077   200011 000100                    ARG     FOUND_POS,,AUTO
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:89   
        42 001100   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001101   000033 771000                    ARL     27
        42 001102   200012 755100                    STA     TABVAL,,AUTO
        42 001103   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 001104   200011 056100                    ASQ     FOUND_POS,,AUTO
        42 001105   001136 606400 42                 TTN     WENT_TO_EOL

      410     7699    1                  ALTRET(WENT_TO_EOL);
      411     7700    1        IF FOUND_POS = INSTR_INDX THEN /* DELIM WAS FIRST CHAR FOUND */

   7700 42 001106   000000 116003                    CMPQ    0,DU
        42 001107   001123 604000 42                 TMI     s:7708
        42 001110   200011 116100                    CMPQ    FOUND_POS,,AUTO
        42 001111   001123 601000 42                 TNZ     s:7708

      412     7701    2          DO;

      413     7702    2            TOKEN_LEN = 1;

   7702 42 001112   000001 235007                    LDA     1,DL
        42 001113   200051 755100                    STA     TOKEN_LEN,,AUTO

      414     7703    2            TOKEN_NAME = INT_INSTR(INSTR_INDX);

   7703 42 001114   040100 100406                    MLR     fill='040'O
        42 001115   000001 000001 33                 ADSC9   INT_INSTR,Q              cn=0,n=1
        42 001116   200013 000170                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=120

      415     7704    2            INSTR_INDX = FOUND_POS + 1;

   7704 42 001117   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001120   000001 035007                    ADLA    1,DL
        42 001121   000000 755000 17                 STA     INSTR_INDX

      416     7705    2          END;

   7705 42 001122   001135 710000 42                 TRA     s:7712
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:90   

      417     7706    1        ELSE
      418     7707    2          DO;

      419     7708    2            TOKEN_LEN = FOUND_POS - INSTR_INDX;

   7708 42 001123   200011 236100                    LDQ     FOUND_POS,,AUTO
        42 001124   000000 136000 17                 SBLQ    INSTR_INDX
        42 001125   200051 756100                    STQ     TOKEN_LEN,,AUTO

      420     7709    2            TOKEN_NAME = SUBSTR(INT_INSTRCHR,INSTR_INDX,TOKEN_LEN);

   7709 42 001126   000000 620006                    EAX0    0,QL
        42 001127   000000 236000 17                 LDQ     INSTR_INDX
        42 001130   040100 100446                    MLR     fill='040'O
        42 001131   000001 000010 33                 ADSC9   INT_INSTR,Q              cn=0,n=*X0
        42 001132   200013 000170                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=120

      421     7710    2            INSTR_INDX = FOUND_POS;

   7710 42 001133   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001134   000000 755000 17                 STA     INSTR_INDX

      422     7711    2          END;

      423     7712    1        IF NOT %SUCCESSFUL_CALL THEN

   7712 42 001135   001153 710000 42                 TRA     s:7722

      424     7713    1         WENT_TO_EOL :
      425     7714    2          DO;

   7714 42 001136                       WENT_TO_EOL  null
      426     7715    2            TOKEN_NAME = SUBSTR(INT_INSTRCHR,INSTR_INDX,INSTR_LEN - INSTR_INDX);

   7715 42 001136   000000 236000 16                 LDQ     INSTR_LEN
        42 001137   000000 136000 17                 SBLQ    INSTR_INDX
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:91   
        42 001140   000000 620006                    EAX0    0,QL
        42 001141   000000 235000 17                 LDA     INSTR_INDX
        42 001142   040100 100445                    MLR     fill='040'O
        42 001143   000001 000010 33                 ADSC9   INT_INSTR,A              cn=0,n=*X0
        42 001144   200013 000170                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=120

      427     7716    2            TOKEN_LEN = INSTR_LEN - INSTR_INDX;

   7716 42 001145   000000 236000 16                 LDQ     INSTR_LEN
        42 001146   000000 136000 17                 SBLQ    INSTR_INDX
        42 001147   200051 756100                    STQ     TOKEN_LEN,,AUTO

      428     7717    2            INSTR_INDX = INSTR_LEN + 1;

   7717 42 001150   000000 235000 16                 LDA     INSTR_LEN
        42 001151   000001 035007                    ADLA    1,DL
        42 001152   000000 755000 17                 STA     INSTR_INDX

      429     7718    2          END;

      430     7719
      431     7720
      432     7721             /* CLASSIFY THE TOKEN */
      433     7722    1        MATCH = '0'B;

   7722 42 001153   200122 450100                    STZ     MATCH,,AUTO

      434     7723    1        LOW = 1;

   7723 42 001154   000001 236007                    LDQ     1,DL
        42 001155   200121 756100                    STQ     LOW,,AUTO

      435     7724    1        HIGH = LAST_TOK;

   7724 42 001156   000000 235000 34                 LDA     LAST_TOK
        42 001157   200120 755100                    STA     HIGH,,AUTO

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:92   
      436     7725    2        DO WHILE (HIGH >= LOW) AND NOT MATCH;

   7725 42 001160   001257 710000 42                 TRA     s:7742

      437     7726    2          MID = (LOW + HIGH) / 2;

   7726 42 001161   200121 236100                    LDQ     LOW,,AUTO
        42 001162   200120 036100                    ADLQ    HIGH,,AUTO
        42 001163   000002 506007                    DIV     2,DL
        42 001164   200117 756100                    STQ     MID,,AUTO

      438     7727    2          IF SUBSTR(TOKEN_NAME,0,TOKEN_LEN) =

   7727 42 001165   000000 236006 35                 LDQ     TOK,QL
        42 001166   000017 402007                    MPY     15,DL
        42 001167   200117 720100                    LXL0    MID,,AUTO
        42 001170   200124 756100                    STQ     MATCH+2,,AUTO
        42 001171   000000 236010 35                 LDQ     TOK,X0
        42 001172   000017 402007                    MPY     15,DL
        42 001173   200124 235100                    LDA     MATCH+2,,AUTO
        42 001174   001176 605000 42                 TPL     s:7727+9
        42 001175   000044 035003                    ADLA    36,DU
        42 001176   003100 061405                    CSR     bolr='003'O
        42 001177   000000 000012 xsym               BDSC    TERM_STRING,A            by=0,bit=0,n=10
        42 001200   200125 000044                    BDSC    MATCH+3,,AUTO            by=0,bit=0,n=36
        42 001201   200126 756100                    STQ     MATCH+4,,AUTO
        42 001202   200125 236100                    LDQ     MATCH+3,,AUTO
        42 001203   200126 235100                    LDA     MATCH+4,,AUTO
        42 001204   001206 605000 42                 TPL     s:7727+17
        42 001205   000044 035003                    ADLA    36,DU
        42 001206   003100 061405                    CSR     bolr='003'O
        42 001207   000000 210005 xsym               BDSC    TERM_STRING,A            by=1,bit=1,n=5
        42 001210   200127 000022                    BDSC    MATCH+5,,AUTO            by=0,bit=0,n=18
        42 001211   200127 221100                    LDX1    MATCH+5,,AUTO
        42 001212   200051 722100                    LXL2    TOKEN_LEN,,AUTO
        42 001213   040046 106540                    CMPC    fill='040'O
        42 001214   200013 000012                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X2
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:93   
        42 001215   000000 000011 xsym               ADSC9   TSTRING_SPACE,Q          cn=0,n=*X1
        42 001216   001223 601000 42                 TNZ     s:7736

      439     7728    2             SUBSTR(TSTRING_SPACE,TERM_STRING.INDX(TOK(MID)),
      440     7729    2                    TERM_STRING.LEN(TOK(MID))) THEN
      441     7730    3            DO;

      442     7731    3              MATCH = '1'B;

   7731 42 001217   400000 236003                    LDQ     -131072,DU
        42 001220   200122 756100                    STQ     MATCH,,AUTO

      443     7732    3              EXIT;

   7732 42 001221   001222 710000 42                 TRA     s:7732+1
        42 001222   001257 710000 42                 TRA     s:7742

      444     7733    3            END;
      445     7734    2          ELSE
      446     7735    3            DO;

      447     7736    3              IF SUBSTR(TOKEN_NAME,0,TOKEN_LEN) > SUBSTR(TSTRING_SPACE,

   7736 42 001223   000000 236010 35                 LDQ     TOK,X0
        42 001224   000017 402007                    MPY     15,DL
        42 001225   200125 756100                    STQ     MATCH+3,,AUTO
        42 001226   000000 116003                    CMPQ    0,DU
        42 001227   001231 605000 42                 TPL     s:7736+6
        42 001230   000044 036003                    ADLQ    36,DU
        42 001231   003100 061406                    CSR     bolr='003'O
        42 001232   000000 000012 xsym               BDSC    TERM_STRING,Q            by=0,bit=0,n=10
        42 001233   200124 000044                    BDSC    MATCH+2,,AUTO            by=0,bit=0,n=36
        42 001234   200124 236100                    LDQ     MATCH+2,,AUTO
        42 001235   200125 235100                    LDA     MATCH+3,,AUTO
        42 001236   001240 605000 42                 TPL     s:7736+13
        42 001237   000044 035003                    ADLA    36,DU
        42 001240   003100 061405                    CSR     bolr='003'O
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:94   
        42 001241   000000 210005 xsym               BDSC    TERM_STRING,A            by=1,bit=1,n=5
        42 001242   200126 000022                    BDSC    MATCH+4,,AUTO            by=0,bit=0,n=18
        42 001243   200126 221100                    LDX1    MATCH+4,,AUTO
        42 001244   040140 106446                    CMPC    fill='040'O
        42 001245   000000 000011 xsym               ADSC9   TSTRING_SPACE,Q          cn=0,n=*X1
        42 001246   200013 000012                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X2
        42 001247   001254 603000 42                 TRC     s:7740

      448     7737    3                 TERM_STRING.INDX(TOK(MID)),TERM_STRING.LEN(TOK(MID))) THEN
      449     7738    3                LOW = MID + 1;

   7738 42 001250   200117 235100                    LDA     MID,,AUTO
        42 001251   000001 035007                    ADLA    1,DL
        42 001252   200121 755100                    STA     LOW,,AUTO
        42 001253   001257 710000 42                 TRA     s:7742

      450     7739    3              ELSE
      451     7740    3                HIGH = MID - 1;

   7740 42 001254   200117 235100                    LDA     MID,,AUTO
        42 001255   000001 135007                    SBLA    1,DL
        42 001256   200120 755100                    STA     HIGH,,AUTO

      452     7741    3            END;

      453     7742    2          END;  /* WHILE */

   7742 42 001257   200120 236100                    LDQ     HIGH,,AUTO
        42 001260   200121 116100                    CMPQ    LOW,,AUTO
        42 001261   001264 604000 42                 TMI     s:7745
        42 001262   200122 234100                    SZN     MATCH,,AUTO
        42 001263   001161 605000 42                 TPL     s:7726

      454     7743
      455     7744
      456     7745    1        IF MATCH THEN

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:95   
   7745 42 001264   200122 234100                    SZN     MATCH,,AUTO
        42 001265   001272 605000 42                 TPL     s:7749

      457     7746    1          SYMBOL_NUM = TOK(MID);

   7746 42 001266   200117 720100                    LXL0    MID,,AUTO
        42 001267   000000 235010 35                 LDA     TOK,X0
        42 001270   200052 755100                    STA     SYMBOL_NUM,,AUTO
        42 001271   001437 710000 42                 TRA     s:7791

      458     7747    1        ELSE
      459     7748    2          DO;

      460     7749    2            CALL SEARCH(FOUND_POS,TABVAL,NON_INTEGER_TABLE,SUBSTR(TOKEN_NAME,0,
              7749                     TOKEN_LEN))

   7749 42 001272   200051 720100                    LXL0    TOKEN_LEN,,AUTO
        42 001273   000000 164540                    TCT
        42 001274   200013 000010                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X0
        42 001275   001000 000000 32                 ARG     NON_INTEGER_TABLE
        42 001276   200011 000100                    ARG     FOUND_POS,,AUTO
        42 001277   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001300   000033 771000                    ARL     27
        42 001301   200012 755100                    STA     TABVAL,,AUTO
        42 001302   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 001303   001435 606400 42                 TTN     WE_HAVE_INTEGER

      461     7750    2                  ALTRET(WE_HAVE_INTEGER);
      462     7751                 %HANDLE_IDENTIFIER;

   7753 42 001304   000000 164540                    TCT
        42 001305   200013 000010                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X0
        42 001306   001200 000000 32                 ARG     VALIDATE_IDENTIFIER_TABLE
        42 001307   200011 000100                    ARG     FOUND_POS,,AUTO
        42 001310   200011 235100                    LDA     FOUND_POS,,AUTO
        42 001311   000033 771000                    ARL     27
        42 001312   200012 755100                    STA     TABVAL,,AUTO
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:96   
        42 001313   200011 551140                    STBA    FOUND_POS,'40'O,AUTO
        42 001314   001354 606400 42                 TTN     GOOD_IDENT

   7756 42 001315   000000 235000 36                 LDA     TERM_IDENTIFIER
        42 001316   200052 755100                    STA     SYMBOL_NUM,,AUTO

   7757 42 001317   040100 100400                    MLR     fill='040'O
        42 001320   000010 000001 43                 ADSC9   8                        cn=0,n=1
        42 001321   200053 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

   7758 42 001322   000214 235007                    LDA     140,DL
        42 001323   200116 755100                    STA     LEN,,AUTO

   7759 42 001324   000000 236000 17                 LDQ     INSTR_INDX
        42 001325   200051 136100                    SBLQ    TOKEN_LEN,,AUTO
        42 001326   200011 036100                    ADLQ    FOUND_POS,,AUTO
        42 001327   777607 621006                    EAX1    -121,QL
        42 001330   777777 661003                    ERX1    -1,DU
        42 001331   040146 100400                    MLR     fill='040'O
        42 001332   000011 000001 43                 ADSC9   9                        cn=0,n=1
        42 001333   200060 000011                    ADSC9   BUFFER+5,Q,AUTO          cn=0,n=*X1

   7760 42 001334   000006 631400 43                 EPPR1   6
        42 001335   000000 701000 xent               TSX1    FORCE_LIST
        42 001336   000000 011000                    NOP     0

   7761 42 001337   200116 630500                    EPPR0   LEN,,AUTO
        42 001340   200125 450500                    STP0    MATCH+3,,AUTO
        42 001341   200053 631500                    EPPR1   BUFFER,,AUTO
        42 001342   200124 451500                    STP1    MATCH+2,,AUTO
        42 001343   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 001344   000005 631400 43                 EPPR1   5
        42 001345   000000 701000 xent               TSX1    OUTPUT
        42 001346   000000 011000                    NOP     0

   7762 42 001347   000013 630400 43                 EPPR0   11
        42 001350   000005 631400 43                 EPPR1   5
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:97   
        42 001351   000000 701000 xent               TSX1    DIAG
        42 001352   000000 011000                    NOP     0

   7763 42 001353   001434 710000 42                 TRA     s:7784

   7764 42 001354                       GOOD_IDENT   null
   7765 42 001354   200013 236100                    LDQ     TOKEN_NAME,,AUTO
        42 001355   777000 376003                    ANQ     -512,DU
        42 001356   101000 116003                    CMPQ    33280,DU
        42 001357   001370 602000 42                 TNC     s:7769
        42 001360   200013 236100                    LDQ     TOKEN_NAME,,AUTO
        42 001361   777000 376003                    ANQ     -512,DU
        42 001362   132000 116003                    CMPQ    46080,DU
        42 001363   001365 600000 42                 TZE     s:7767
        42 001364   001370 603000 42                 TRC     s:7769

   7767 42 001365   000000 235000 36                 LDA     TERM_IDENTIFIER
        42 001366   200052 755100                    STA     SYMBOL_NUM,,AUTO
        42 001367   001434 710000 42                 TRA     s:7784

   7769 42 001370   200013 236100                    LDQ     TOKEN_NAME,,AUTO
        42 001371   777000 376003                    ANQ     -512,DU
        42 001372   044000 116003                    CMPQ    18432,DU
        42 001373   001377 601000 42                 TNZ     s:7773

   7770 42 001374   000000 235000 41                 LDA     TERM_LOCAL_LABEL
        42 001375   200052 755100                    STA     SYMBOL_NUM,,AUTO
        42 001376   001434 710000 42                 TRA     s:7784

   7773 42 001377   040100 100400                    MLR     fill='040'O
        42 001400   000010 000001 43                 ADSC9   8                        cn=0,n=1
        42 001401   200053 000214                    ADSC9   BUFFER,,AUTO             cn=0,n=140

   7774 42 001402   000214 235007                    LDA     140,DL
        42 001403   200116 755100                    STA     LEN,,AUTO

   7775 42 001404   000000 236000 17                 LDQ     INSTR_INDX
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:98   
        42 001405   200051 136100                    SBLQ    TOKEN_LEN,,AUTO
        42 001406   777607 620006                    EAX0    -121,QL
        42 001407   777777 660003                    ERX0    -1,DU
        42 001410   040146 100400                    MLR     fill='040'O
        42 001411   000011 000001 43                 ADSC9   9                        cn=0,n=1
        42 001412   200060 000010                    ADSC9   BUFFER+5,Q,AUTO          cn=0,n=*X0

   7776 42 001413   000006 631400 43                 EPPR1   6
        42 001414   000000 701000 xent               TSX1    FORCE_LIST
        42 001415   000000 011000                    NOP     0

   7777 42 001416   200116 630500                    EPPR0   LEN,,AUTO
        42 001417   200125 450500                    STP0    MATCH+3,,AUTO
        42 001420   200053 631500                    EPPR1   BUFFER,,AUTO
        42 001421   200124 451500                    STP1    MATCH+2,,AUTO
        42 001422   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 001423   000005 631400 43                 EPPR1   5
        42 001424   000000 701000 xent               TSX1    OUTPUT
        42 001425   000000 011000                    NOP     0

   7778 42 001426   000016 630400 43                 EPPR0   14
        42 001427   000000 631400 43                 EPPR1   0
        42 001430   000000 701000 xent               TSX1    DIAG
        42 001431   000000 011000                    NOP     0

   7779 42 001432   000000 235000 36                 LDA     TERM_IDENTIFIER
        42 001433   200052 755100                    STA     SYMBOL_NUM,,AUTO

      463     7784    2            IF NOT %SUCCESSFUL_CALL THEN

   7784 42 001434   001437 710000 42                 TRA     s:7791

      464     7785    2             WE_HAVE_INTEGER :
      465     7786    2            SYMBOL_NUM = TERM_INTEGER;

   7786 42 001435   000000 235000 38    WE_HAVE_INT* LDA     TERM_INTEGER
        42 001436   200052 755100                    STA     SYMBOL_NUM,,AUTO
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:99   

      466     7787    2          END;

      467     7788
      468     7789             %BUILD_TOKEN;

   7791 42 001437   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 001440   000000 471500                    LDP1    0,,PR0
        42 001441   200052 235100                    LDA     SYMBOL_NUM,,AUTO
        42 001442   100002 755100                    STA     2,,PR1

   7792 42 001443   000000 471500                    LDP1    0,,PR0
        42 001444   000004 236000 43                 LDQ     4
        42 001445   100000 756100                    STQ     0,,PR1

   7793 42 001446   000000 471500                    LDP1    0,,PR0
        42 001447   000000 236000 33                 LDQ     LINE#
        42 001450   100003 756100                    STQ     3,,PR1

   7794 42 001451   000000 471500                    LDP1    0,,PR0
        42 001452   000000 235000 17                 LDA     INSTR_INDX
        42 001453   000001 035007                    ADLA    1,DL
        42 001454   100004 755100                    STA     4,,PR1

   7795 42 001455   200051 235100                    LDA     TOKEN_LEN,,AUTO
        42 001456   001463 601000 42                 TNZ     s:7799

   7796 42 001457   000000 471500                    LDP1    0,,PR0
        42 001460   000004 236000 43                 LDQ     4
        42 001461   100001 756100                    STQ     1,,PR1
        42 001462   001527 710000 42                 TRA     s:7811

   7799 42 001463   200007 755100                    STA     SYMLEN,,AUTO

   7800 42 001464   200007 236100                    LDQ     SYMLEN,,AUTO
        42 001465   000013 036007                    ADLQ    11,DL
        42 001466   000004 506007                    DIV     4,DL
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:100  
        42 001467   200010 756100                    STQ     NEWLEN,,AUTO

   7801 42 001470   200010 631500                    EPPR1   NEWLEN,,AUTO
        42 001471   200125 451500                    STP1    MATCH+3,,AUTO
        42 001472   200006 633500                    EPPR3   NEW$,,AUTO
        42 001473   200124 453500                    STP3    MATCH+2,,AUTO
        42 001474   200124 630500                    EPPR0   MATCH+2,,AUTO
        42 001475   000005 631400 43                 EPPR1   5
        42 001476   000000 701000 xent               TSX1    GETNEW
        42 001477   000000 011000                    NOP     0

   7802 42 001500   200006 470500                    LDP0    NEW$,,AUTO
        42 001501   200007 235100                    LDA     SYMLEN,,AUTO
        42 001502   000000 755100                    STA     0,,PR0

   7803 42 001503   200006 470500                    LDP0    NEW$,,AUTO
        42 001504   000000 720100                    LXL0    0,,PR0
        42 001505   000000 621005                    EAX1    0,AL
        42 001506   040140 100540                    MLR     fill='040'O
        42 001507   200013 000011                    ADSC9   TOKEN_NAME,,AUTO         cn=0,n=*X1
        42 001510   000001 000010                    ADSC9   1,,PR0                   cn=0,n=*X0
        42 001511   000000 636010                    EAQ     0,X0
        42 001512   000022 732000                    QRS     18
        42 001513   200007 136100                    SBLQ    SYMLEN,,AUTO
        42 001514   001523 604400 42                 TMOZ    s:7806
        42 001515   200006 470500                    LDP0    NEW$,,AUTO
        42 001516   000000 620006                    EAX0    0,QL
        42 001517   200007 235100                    LDA     SYMLEN,,AUTO
        42 001520   040145 100400                    MLR     fill='040'O
        42 001521   001442 000006 32                 ADSC9   BAD_IDENT_2+7            cn=0,n=6
        42 001522   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=*X0

   7806 42 001523   200003 470500                    LDP0    @P_TOKEN,,AUTO
        42 001524   000000 471500                    LDP1    0,,PR0
        42 001525   200006 236100                    LDQ     NEW$,,AUTO
        42 001526   100001 756100                    STQ     1,,PR1

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:101  
      469     7810
      470     7811    1    END SCANNER;

   7811 42 001527   000000 702200 xent               TSX2  ! X66_ARET
      471     7812         %EOD;

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:102  
--  Include file information  --

   Z8P_SCAN_TBL.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_XLIT.:Z8A6TOU  cannot be made into a system file and is referenced.
   SCDPDA_SUBS.:Z8A6TOU  is referenced.
   Z8P_PARS_DNT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_PARS_STK.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:LIB_E04  is referenced.
   CP_6_C.:LIB_E04  is referenced.
   CP_6.:LIB_E04  cannot be made into a system file and is referenced.
   Z9A_FLAGS.:Z8A6TOU  is referenced.
   Z8A_SYS_FILE.:Z8A6TOU  is referenced.
      No diagnostics issued in procedure SCANNER.
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:103  

 **** Variables and constants ****

  ****  Section 001 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 OUT_DCBN

  ****  Section 002 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 003 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 010 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 011 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:104  
  ****  Section 012 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 013 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 014 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 INSTR(0:511)               0-0-0/c CHAR(512)   r     1 INSTRCHR

  ****  Section 015 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 INSTR_LISTED

  ****  Section 016 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_LEN

  ****  Section 017 LblCom INSTR_INDX

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:105  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_INDX

  ****  Section 018 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 EOF_FLAG

  ****  Section 019 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)    r     1 KEY_REC

  ****  Section 020 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 021 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 022 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:106  

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 023 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 024 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 025 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 026 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 027 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PHASE
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:107  

  ****  Section 028 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Section 029 LblCom LA_STK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(216)         1 LA_STK(0:50)

  ****  Section 030 LblCom LX_TOP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LX_TOP

  ****  Section 031 LblCom LX_STK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(216)         1 LX_STK(0:50)

  ****  Section 032 RoData SCANNER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1400-0-0/c STRC(576)   r     1 BAD_CHAR                1420-0-0/c STRC(387)   r     1 BAD_IDENT_1
  1433-0-0/c STRC(243)   r     1 BAD_IDENT_2
   200-0-0/b UBIN(9)     r     1 BLANKS_TABLE(0:511)
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:108  
   400-0-0/b UBIN(9)     r     1 COMMENT_TERMINATOR(0:511)
   600-0-0/b UBIN(9)     r     1 DELIMITER_TABLE(0:511)
     0-0-0/b UBIN(9)     r     1 LOWER_TO_UPPER_CASE(0:511)
  1000-0-0/b UBIN(9)     r     1 NON_INTEGER_TABLE(0:511)
  1200-0-0/b UBIN(9)     r     1 VALIDATE_IDENTIFIER_TABLE(0:511)

  ****  Section 033  Data  SCANNER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     1-0-0/c CHAR        r     1 INT_INSTR(0:511)
     1-0-0/c CHAR(512)   r     1 INT_INSTRCHR               0-0-0/w SBIN        r     1 LINE#

  ****  Section 034 LblCom LAST_TOK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 LAST_TOK

  ****  Section 035 LblCom TOK

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TOK(0:209)

  ****  Section 036 LblCom TERM_IDENTIFIER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_IDENTIFIER

  ****  Section 037 LblCom TERM_STRING_SYM

PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:109  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 TERM_STRING_SYM

  ****  Section 038 LblCom TERM_INTEGER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_INTEGER

  ****  Section 039 LblCom TERM_EOF

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_EOF

  ****  Section 040 LblCom TERM_EOL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 TERM_EOL

  ****  Section 041 LblCom TERM_LOCAL_LABEL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 TERM_LOCAL_LABEL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:110  

     3-0-0/w PTR         r     1 @P_TOKEN                  53-0-0/c CHAR(140)   r     1 BUFFER
    11-0-0/w UBIN        r     1 FOUND_POS                120-0-0/w SBIN        r     1 HIGH
     5-0-0/w SBIN              1 I                        116-0-0/w SBIN        r     1 LEN
   121-0-0/w SBIN        r     1 LOW                      122-0-0/w BIT         r     1 MATCH
     4-0-0/w SBIN              1 MAXLEN                   117-0-0/w SBIN        r     1 MID
     6-0-0/w PTR         r     1 NEW$                      10-0-0/w SBIN        r     1 NEWLEN
    *0-0-0/w PTR         r     1 P_TOKEN                   52-0-0/w SBIN        r     1 SYMBOL_NUM
     7-0-0/w SBIN        r     1 SYMLEN                    12-0-0/w UBIN        r     1 TABVAL
    51-0-0/w UBIN        r     1 TOKEN_LEN                 13-0-0/c CHAR(120)   r     1 TOKEN_NAME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC              1 ACTION_COL(0:548)
     0-0-0/b STRC              1 ACTION_ROW(0:1904)
     0-0-0/b STRC              1 GOTO_COL(0:183)            0-0-0/b STRC              1 GOTO_ROW(0:194)
     0-0-0/b STRC(54)          1 PRODR(0:399)
     0-0-0/b STRC(15)    r     1 TERM_STRING(0:209)
     0-0-0/c CHAR(880)   r     1 TSTRING_SPACE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w ASTR        r     1 DNT                        0-0-0/w STRC(216)   r     1 LX_ITEM
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$OU                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$SO                       0-0-0N  NULL        r     1 M$UC
     0-0-0N  NULL        r     1 M$UI


   Procedure SCANNER requires 856 words for executable code.
PL6.E3A0      #003=SCANNER File=Z8PS.:Z8A6TSI                                    SAT 08/09/97 09:43 Page:111  
   Procedure SCANNER requires 88 words of local(AUTO) storage.

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:112  
      472        1        /*T***********************************************************/
      473        2        /*T*                                                         */
      474        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      475        4        /*T*                                                         */
      476        5        /*T***********************************************************/
      477        6
      478        7         FORCE_LIST:PROC;
      479        8
      480        9         /*D*
      481       10                NAME: FORCE_LIST
      482       11             PURPOSE:
      483       12            REPRODUCE THE SOURCE LINE, EITHER BECAUSE
      484       13            THE LS OPTION IS SET, OR A DIAGNOSTIC IS TO BE
      485       14            PRINTED */
      486       15
      487       16         %INCLUDE Z8P_SCAN_EXT;
      488      205         %DCBPTR;
      489      215
      490      216    1    DCL OLINE CHAR(523);
      491      217    1    DCL OCT_NUM CHAR(6);
      492      218    1    DCL AHEAD_OT_POS UBIN WORD ALIGNED EXT;
      493      219
      494      220
      495      221    1            IF INSTR_LISTED THEN
      496      222    1               RETURN;
      497      223                  %SELECT_LO;
      498      226    1            INSTR_LISTED=TRUE;
      499      227    1            IF OPTIONS(LS_OPT) THEN
      500      228    2               DO;
      501      229    2                  CALL DEC_TO_OCT(OCT_NUM,AHEAD_OT_POS);
      502      230    2                  CALL INSERT(KEY_REC,11,,'  ',OCT_NUM,'  ');
      503      231    2               END;
      504      232    1            CALL INSERT(OLINE,,,KEY_REC,SUBSTR(INSTRCHR,0,INSTR_LEN));
      505      233    1            CALL OUTPUT(OLINE,LENGTHC(KEY_REC)+INSTR_LEN);
      506      234    1            RETURN;
      507      235
      508      236    1    END FORCE_LIST;
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:113  
      509      237         %EOD;

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:114  
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FORCE_LIST.

   Procedure FORCE_LIST requires 47 words for executable code.
   Procedure FORCE_LIST requires 140 words of local(AUTO) storage.

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:115  

 Object Unit name= FORCE_LIST                                 File name= Z8PS.:Z8A6TOU
 UTS= AUG 09 '97 09:45:06.28 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  LblCom even  none     1      1  OUT_DCBN
    1  LblCom even  none     1      1  SAVE_OUT_DCBN
    2  LblCom even  none     1      1  SAVE_DCBN2
    3   DCB   even  none     0      0  M$OU
    4   DCB   even  none     0      0  M$SO
    5   DCB   even  none     0      0  M$LO
    6   DCB   even  none     0      0  M$SI
    7   DCB   even  none     0      0  M$UI
    8   DCB   even  none     0      0  M$DO
    9  LblCom even  none     1      1  ERR_SEV
   10  LblCom even  none     1      1  OPTIONS
   11  LblCom even  none     1      1  DO_REQ
   12  LblCom even  none    26     32  OPTIONS_TEXT
   13  LblCom even  none   128    200  INSTR
   14  LblCom even  none     1      1  INSTR_LISTED
   15  LblCom even  none     1      1  INSTR_LEN
   16  LblCom even  none     1      1  INSTR_INDX
   17  LblCom even  none     1      1  EOF_FLAG
   18  LblCom even  none     5      5  KEY_REC
   19  LblCom even  none     1      1  LINES_OUT
   20  LblCom even  none    25     31  HEADER_LINE1
   21  LblCom even  none    25     31  HEADER_LINE3
   22  LblCom even  none    25     31  HEADER_LINE2
   23  LblCom even  none     1      1  MAX_LINES_PER_PAGE
   24  LblCom even  none    28     34  LINE
   25  LblCom even  none     1      1  LINELEN
   26  LblCom even  none     1      1  PHASE
   27  LblCom even  none     1      1  ERROR_COUNT
   28  LblCom even  none     1      1  AHEAD_OT_POS
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:116  
   29  RoData even  UTS      1      1  FORCE_LIST
   30   Proc  even  none    47     57  FORCE_LIST
   31  RoData even  none     2      2  FORCE_LIST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    30      0   yes            yes      Std        0  FORCE_LIST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 DEC_TO_OCT
         yes           Std       2 OUTPUT
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$OU                                  M$SO                                  M$LO
     M$SI                                  M$UI                                  M$DO
     Z8PS$M$OU$                            Z8PS$M$LO$                            Z8PS$M$DO$
     Z8PS$M$SO$                            Z8PS$M$OU#                            Z8PS$M$LO#
     Z8PS$M$DO#                            Z8PS$M$SO#

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:117  


      472        1        /*T***********************************************************/
      473        2        /*T*                                                         */
      474        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      475        4        /*T*                                                         */
      476        5        /*T***********************************************************/
      477        6
      478        7         FORCE_LIST:PROC;

      7 30 000000   000000 700200 xent  FORCE_LIST   TSX0  ! X66_AUTO_0
        30 000001   000214 000000                    ZERO    140,0

      479        8
      480        9         /*D*
      481       10                NAME: FORCE_LIST
      482       11             PURPOSE:
      483       12            REPRODUCE THE SOURCE LINE, EITHER BECAUSE
      484       13            THE LS OPTION IS SET, OR A DIAGNOSTIC IS TO BE
      485       14            PRINTED */
      486       15
      487       16         %INCLUDE Z8P_SCAN_EXT;
      488      205         %DCBPTR;
      489      215
      490      216    1    DCL OLINE CHAR(523);
      491      217    1    DCL OCT_NUM CHAR(6);
      492      218    1    DCL AHEAD_OT_POS UBIN WORD ALIGNED EXT;
      493      219
      494      220
      495      221    1            IF INSTR_LISTED THEN

    221 30 000002   000000 234000 14                 SZN     INSTR_LISTED
        30 000003   000005 605000 30                 TPL     s:224

      496      222    1               RETURN;

    222 30 000004   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:118  
      497      223                  %SELECT_LO;

    224 30 000005   000000 235000 xsym               LDA     Z8PS$M$LO#
        30 000006   000000 755000 0                  STA     OUT_DCBN

      498      226    1            INSTR_LISTED=TRUE;

    226 30 000007   400000 236003                    LDQ     -131072,DU
        30 000010   000000 756000 14                 STQ     INSTR_LISTED

      499      227    1            IF OPTIONS(LS_OPT) THEN

    227 30 000011   000000 234000 10                 SZN     OPTIONS
        30 000012   000034 605000 30                 TPL     s:232

      500      228    2               DO;

      501      229    2                  CALL DEC_TO_OCT(OCT_NUM,AHEAD_OT_POS);

    229 30 000013   000001 236000 31                 LDQ     1
        30 000014   200211 756100                    STQ     OCT_NUM+3,,AUTO
        30 000015   200206 630500                    EPPR0   OCT_NUM,,AUTO
        30 000016   200210 450500                    STP0    OCT_NUM+2,,AUTO
        30 000017   200210 630500                    EPPR0   OCT_NUM+2,,AUTO
        30 000020   000000 631400 31                 EPPR1   0
        30 000021   000000 701000 xent               TSX1    DEC_TO_OCT
        30 000022   000000 011000                    NOP     0

      502      230    2                  CALL INSERT(KEY_REC,11,,'  ',OCT_NUM,'  ');

    230 30 000023   040000 100400                    MLR     fill='040'O
        30 000024   000000 000002 29                 ADSC9   0                        cn=0,n=2
        30 000025   000002 600002 18                 ADSC9   KEY_REC+2                cn=3,n=2
        30 000026   040000 100500                    MLR     fill='040'O
        30 000027   200206 000006                    ADSC9   OCT_NUM,,AUTO            cn=0,n=6
        30 000030   000003 200006 18                 ADSC9   KEY_REC+3                cn=1,n=6
        30 000031   000000 236000 29                 LDQ     0
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:119  
        30 000032   000033 772000                    QRL     27
        30 000033   000004 552004 18                 STBQ    KEY_REC+4,'04'O

      503      231    2               END;

      504      232    1            CALL INSERT(OLINE,,,KEY_REC,SUBSTR(INSTRCHR,0,INSTR_LEN));

    232 30 000034   040100 100400                    MLR     fill='040'O
        30 000035   000000 000024 18                 ADSC9   KEY_REC                  cn=0,n=20
        30 000036   200003 000024                    ADSC9   OLINE,,AUTO              cn=0,n=20
        30 000037   000000 720000 15                 LXL0    INSTR_LEN
        30 000040   040100 100440                    MLR     fill='040'O
        30 000041   000000 000010 13                 ADSC9   INSTR                    cn=0,n=*X0
        30 000042   200010 000767                    ADSC9   OLINE+5,,AUTO            cn=0,n=503

      505      233    1            CALL OUTPUT(OLINE,LENGTHC(KEY_REC)+INSTR_LEN);

    233 30 000043   000000 235000 15                 LDA     INSTR_LEN
        30 000044   000024 035007                    ADLA    20,DL
        30 000045   200210 755100                    STA     OCT_NUM+2,,AUTO
        30 000046   200210 630500                    EPPR0   OCT_NUM+2,,AUTO
        30 000047   200213 450500                    STP0    OCT_NUM+5,,AUTO
        30 000050   200003 631500                    EPPR1   OLINE,,AUTO
        30 000051   200212 451500                    STP1    OCT_NUM+4,,AUTO
        30 000052   200212 630500                    EPPR0   OCT_NUM+4,,AUTO
        30 000053   000000 631400 31                 EPPR1   0
        30 000054   000000 701000 xent               TSX1    OUTPUT
        30 000055   000000 011000                    NOP     0

      506      234    1            RETURN;

    234 30 000056   000000 702200 xent               TSX2  ! X66_ARET
      507      235
      508      236    1    END FORCE_LIST;
      509      237         %EOD;

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:120  
--  Include file information  --

   Z9P_IO_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
   Z8P_SCAN_EXT.:Z8A6TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FORCE_LIST.
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:121  

 **** Variables and constants ****

  ****  Section 000 LblCom OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 OUT_DCBN

  ****  Section 001 LblCom SAVE_OUT_DCBN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_OUT_DCBN

  ****  Section 002 LblCom SAVE_DCBN2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 SAVE_DCBN2

  ****  Section 009 LblCom ERR_SEV

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERR_SEV

  ****  Section 010 LblCom OPTIONS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 OPTIONS(0:25)

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:122  
  ****  Section 011 LblCom DO_REQ

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 DO_REQ

  ****  Section 012 LblCom OPTIONS_TEXT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(4)           1 OPTIONS_TEXT(0:25)

  ****  Section 013 LblCom INSTR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 INSTR(0:511)               0-0-0/c CHAR(512)   r     1 INSTRCHR

  ****  Section 014 LblCom INSTR_LISTED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT         r     1 INSTR_LISTED

  ****  Section 015 LblCom INSTR_LEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN        r     1 INSTR_LEN

  ****  Section 016 LblCom INSTR_INDX

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:123  
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 INSTR_INDX

  ****  Section 017 LblCom EOF_FLAG

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT               1 EOF_FLAG

  ****  Section 018 LblCom KEY_REC

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(20)    r     1 KEY_REC

  ****  Section 019 LblCom LINES_OUT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINES_OUT

  ****  Section 020 LblCom HEADER_LINE1

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE1

  ****  Section 021 LblCom HEADER_LINE3

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:124  

     0-0-0/c CHAR(100)         1 HEADER_LINE3

  ****  Section 022 LblCom HEADER_LINE2

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)         1 HEADER_LINE2

  ****  Section 023 LblCom MAX_LINES_PER_PAGE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 MAX_LINES_PER_PAGE

  ****  Section 024 LblCom LINE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(109)         1 LINE

  ****  Section 025 LblCom LINELEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 LINELEN

  ****  Section 026 LblCom PHASE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 PHASE
PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:125  

  ****  Section 027 LblCom ERROR_COUNT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w SBIN              1 ERROR_COUNT

  ****  Section 028 LblCom AHEAD_OT_POS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AHEAD_OT_POS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   206-0-0/c CHAR(6)     r     1 OCT_NUM                    3-0-0/c CHAR(523)   r     1 OLINE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN              1 Z8PS$M$DO#                 0-0-0/w PTR               1 Z8PS$M$DO$
     0-0-0/w UBIN        r     1 Z8PS$M$LO#                 0-0-0/w PTR               1 Z8PS$M$LO$
     0-0-0/w UBIN              1 Z8PS$M$OU#                 0-0-0/w PTR               1 Z8PS$M$OU$
     0-0-0/w UBIN              1 Z8PS$M$SO#                 0-0-0/w PTR               1 Z8PS$M$SO$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #004=FORCE_LIST File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:126  
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$LO
     0-0-0N  NULL        r     1 M$OU                       0-0-0N  NULL        r     1 M$SI
     0-0-0N  NULL        r     1 M$SO                       0-0-0N  NULL        r     1 M$UI


   Procedure FORCE_LIST requires 47 words for executable code.
   Procedure FORCE_LIST requires 140 words of local(AUTO) storage.

PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:127  
      510        1        /*T***********************************************************/
      511        2        /*T*                                                         */
      512        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      513        4        /*T*                                                         */
      514        5        /*T***********************************************************/
      515        6
      516        7
      517        8         /*D*
      518        9
      519       10                   NAME: BLANK_ZERO
      520       11            DESCRIPTION: Accept a pointer to a character, then change all
      521       12                            successive zeroes to blanks until a non-zero
      522       13                            character is encountered.
      523       14
      524       15         */
      525       16
      526       17         BLANK_ZERO: PROC (C$,LEN);
      527       18
      528       19    1           DCL C$ PTR;
      529       20    1           DCL LEN UBIN;
      530       21    1           DCL CNT UBIN;
      531       22    1           DCL C CHAR(1) BASED (C$);
      532       23    1    CNT = 1;
      533       24    2    DO WHILE ((C = '0') AND (CNT < LEN));
      534       25    2           CNT = CNT + 1;
      535       26    2           C = ' ';
      536       27    2           C$ = PINCRC (C$,1);
      537       28
      538       29    2    END; /* DO */
      539       30
      540       31    1    END BLANK_ZERO;
      541       32         %EOD;

PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:128  
      No diagnostics issued in procedure BLANK_ZERO.

   Procedure BLANK_ZERO requires 27 words for executable code.
   Procedure BLANK_ZERO requires 6 words of local(AUTO) storage.

PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:129  

 Object Unit name= BLANK_ZERO                                 File name= Z8PS.:Z8A6TOU
 UTS= AUG 09 '97 09:45:17.12 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    27     33  BLANK_ZERO
    1  RoData even  none     2      2  BLANK_ZERO

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        2  BLANK_ZERO

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:130  


      510        1        /*T***********************************************************/
      511        2        /*T*                                                         */
      512        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      513        4        /*T*                                                         */
      514        5        /*T***********************************************************/
      515        6
      516        7
      517        8         /*D*
      518        9
      519       10                   NAME: BLANK_ZERO
      520       11            DESCRIPTION: Accept a pointer to a character, then change all
      521       12                            successive zeroes to blanks until a non-zero
      522       13                            character is encountered.
      523       14
      524       15         */
      525       16
      526       17         BLANK_ZERO: PROC (C$,LEN);

     17  0 000000   000000 700200 xent  BLANK_ZERO   TSX0  ! X66_AUTO_2
         0 000001   000006 000002                    ZERO    6,2

      527       18
      528       19    1           DCL C$ PTR;
      529       20    1           DCL LEN UBIN;
      530       21    1           DCL CNT UBIN;
      531       22    1           DCL C CHAR(1) BASED (C$);
      532       23    1    CNT = 1;

     23  0 000002   000001 235007                    LDA     1,DL
         0 000003   200005 755100                    STA     CNT,,AUTO

      533       24    2    DO WHILE ((C = '0') AND (CNT < LEN));

     24  0 000004   000020 710000 0                  TRA     s:29

      534       25    2           CNT = CNT + 1;
PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:131  

     25  0 000005   200005 235100                    LDA     CNT,,AUTO
         0 000006   000001 035007                    ADLA    1,DL
         0 000007   200005 755100                    STA     CNT,,AUTO

      535       26    2           C = ' ';

     26  0 000010   200003 470500                    LDP0    @C$,,AUTO
         0 000011   000000 471500                    LDP1    0,,PR0
         0 000012   040100 100400                    MLR     fill='040'O
         0 000013   000000 000001 1                  ADSC9   0                        cn=0,n=1
         0 000014   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      536       27    2           C$ = PINCRC (C$,1);

     27  0 000015   000000 236100                    LDQ     0,,PR0
         0 000016   200000 036007                    ADLQ    65536,DL
         0 000017   000000 756100                    STQ     0,,PR0

      537       28
      538       29    2    END; /* DO */

     29  0 000020   200003 470500                    LDP0    @C$,,AUTO
         0 000021   000000 471500                    LDP1    0,,PR0
         0 000022   040000 106500                    CMPC    fill='040'O
         0 000023   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         0 000024   000001 000001 1                  ADSC9   1                        cn=0,n=1
         0 000025   000032 601000 0                  TNZ     s:31
         0 000026   200004 473500                    LDP3    @LEN,,AUTO
         0 000027   200005 236100                    LDQ     CNT,,AUTO
         0 000030   300000 116100                    CMPQ    0,,PR3
         0 000031   000005 602000 0                  TNC     s:25

      539       30
      540       31    1    END BLANK_ZERO;

     31  0 000032   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:132  
      541       32         %EOD;

PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:133  
      No diagnostics issued in procedure BLANK_ZERO.
PL6.E3A0      #005=BLANK_ZERO File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:134  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @C$                        4-0-0/w PTR         r     1 @LEN
    *0-0-0/w PTR         r     1 C$                         5-0-0/w UBIN        r     1 CNT
    *0-0-0/w UBIN        r     1 LEN

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 C


   Procedure BLANK_ZERO requires 27 words for executable code.
   Procedure BLANK_ZERO requires 6 words of local(AUTO) storage.

PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:135  
      542        1        /*T***********************************************************/
      543        2        /*T*                                                         */
      544        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      545        4        /*T*                                                         */
      546        5        /*T***********************************************************/
      547        6         DEC_TO_OCT: PROC(P_TEXT,P_BINARY);
      548        7
      549        8         /*D*     NAME:     DEC_TO_OCT
      550        9                  PURPOSE:  THIS ROUTINE WILL CONVERT A BINARY NUMBER TO
      551       10                       6 CHARACTER PRINTABLE OCTAL.
      552       11                  ENTRY POINTS:
      553       12                       DEC_TO_OCT_SUP
      554       13                  INPUT:
      555       14                       P_BINARY
      556       15                  OUTPUT:
      557       16                       P_TEXT
      558       17                  INTERFACE:     NONE
      559       18                  DESCRIPTION:   THE DEC_TO_OCT ROUTINE WILL CONVERT A
      560       19                       BINARY NUMBER TO PRINTABLE OCTAL IN TWO FORMATS.
      561       20                       IF DEC_TO_OCT IS CALLED, SIX OCTAL DIGITS WILL
      562       21                       BE RETURNED.  IF DEC_TO_OCT_SUP IS CALLED, SIX
      563       22                       OCATL DIGITS WITH LEADING ZERO SUPPRESSION WILL
      564       23                       RETURNED.
      565       24         */
      566       25
      567       26    1    DCL P_TEXT CHAR(6);
      568       27
      569       28    1    DCL MOP6(0:1) BIT(9) CONSTANT INIT('105'O,'327'O /*Mvzbn,mvc7*/);
      570       29                                                 /*
      571       30                                                 */
      572       31    1    DCL TXT(0:5) CHAR(1);
      573       32    1    DCL TXTX REDEF TXT CHAR(6);
      574       33    1    DCL 1 P_BINARY ALIGNED,
      575       34    1          2 * BIT(18),
      576       35    1          2 D0(0:5) UBIN(3) UNAL;
      577       36    1    DCL ZEROSUPFLG BIT(1);
      578       37                                                 /*
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:136  
      579       38                                                 */
      580       39    1            ZEROSUPFLG='0'B;
      581       40    1            GOTO CVT1;
      582       41                                                 /*
      583       42                                                 The following entry is for
      584       43                                                 zero suppression
      585       44                                                 */
      586       45    1    DEC_TO_OCT_SUP: ENTRY(P_TEXT,P_BINARY);
      587       46    1            ZEROSUPFLG='1'B;
      588       47    1    CVT1:
      589       48    1            TXT(0)=BINASC(P_BINARY.D0(0)+ASCBIN('0'));
      590       49    1            TXT(1)=BINASC(P_BINARY.D0(1)+ASCBIN('0'));
      591       50    1            TXT(2)=BINASC(P_BINARY.D0(2)+ASCBIN('0'));
      592       51    1            TXT(3)=BINASC(P_BINARY.D0(3)+ASCBIN('0'));
      593       52    1            TXT(4)=BINASC(P_BINARY.D0(4)+ASCBIN('0'));
      594       53    1            TXT(5)=BINASC(P_BINARY.D0(5)+ASCBIN('0'));
      595       54    1            IF ZEROSUPFLG THEN
      596       55    1               CALL EDITCHAR(P_TEXT,0,6,MOP6,TXTX);
      597       56    1            ELSE
      598       57    1               P_TEXT=TXTX;
      599       58    1            RETURN;
      600       59    1    END DEC_TO_OCT;

PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:137  
      No diagnostics issued in procedure DEC_TO_OCT.

   Procedure DEC_TO_OCT requires 67 words for executable code.
   Procedure DEC_TO_OCT requires 8 words of local(AUTO) storage.

    No errors detected in file Z8PS.:Z8A6TSI    .

PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:138  

 Object Unit name= DEC_TO_OCT                                 File name= Z8PS.:Z8A6TOU
 UTS= AUG 09 '97 09:45:22.44 SAT                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      1      1  DEC_TO_OCT
    1   Proc  even  none    67    103  DEC_TO_OCT
    2  RoData even  none     1      1  DEC_TO_OCT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        2  DEC_TO_OCT
     1      4                  yes      Std        2  DEC_TO_OCT_SUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:139  


      542        1        /*T***********************************************************/
      543        2        /*T*                                                         */
      544        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      545        4        /*T*                                                         */
      546        5        /*T***********************************************************/
      547        6         DEC_TO_OCT: PROC(P_TEXT,P_BINARY);

      6  1 000000   000000 700200 xent  DEC_TO_OCT   TSX0  ! X66_AUTO_2
         1 000001   000010 000002                    ZERO    8,2

      548        7
      549        8         /*D*     NAME:     DEC_TO_OCT
      550        9                  PURPOSE:  THIS ROUTINE WILL CONVERT A BINARY NUMBER TO
      551       10                       6 CHARACTER PRINTABLE OCTAL.
      552       11                  ENTRY POINTS:
      553       12                       DEC_TO_OCT_SUP
      554       13                  INPUT:
      555       14                       P_BINARY
      556       15                  OUTPUT:
      557       16                       P_TEXT
      558       17                  INTERFACE:     NONE
      559       18                  DESCRIPTION:   THE DEC_TO_OCT ROUTINE WILL CONVERT A
      560       19                       BINARY NUMBER TO PRINTABLE OCTAL IN TWO FORMATS.
      561       20                       IF DEC_TO_OCT IS CALLED, SIX OCTAL DIGITS WILL
      562       21                       BE RETURNED.  IF DEC_TO_OCT_SUP IS CALLED, SIX
      563       22                       OCATL DIGITS WITH LEADING ZERO SUPPRESSION WILL
      564       23                       RETURNED.
      565       24         */
      566       25
      567       26    1    DCL P_TEXT CHAR(6);
      568       27
      569       28    1    DCL MOP6(0:1) BIT(9) CONSTANT INIT('105'O,'327'O /*Mvzbn,mvc7*/);
      570       29                                                 /*
      571       30                                                 */
      572       31    1    DCL TXT(0:5) CHAR(1);
      573       32    1    DCL TXTX REDEF TXT CHAR(6);
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:140  
      574       33    1    DCL 1 P_BINARY ALIGNED,
      575       34    1          2 * BIT(18),
      576       35    1          2 D0(0:5) UBIN(3) UNAL;
      577       36    1    DCL ZEROSUPFLG BIT(1);
      578       37                                                 /*
      579       38                                                 */
      580       39    1            ZEROSUPFLG='0'B;

     39  1 000002   200007 450100                    STZ     ZEROSUPFLG,,AUTO

      581       40    1            GOTO CVT1;

     40  1 000003   000010 710000 1                  TRA     CVT1

      582       41                                                 /*
      583       42                                                 The following entry is for
      584       43                                                 zero suppression
      585       44                                                 */
      586       45    1    DEC_TO_OCT_SUP: ENTRY(P_TEXT,P_BINARY);

     45  1 000004   000000 700200 xent  DEC_TO_OCT_* TSX0  ! X66_AUTO_2
         1 000005   000010 000002                    ZERO    8,2

      587       46    1            ZEROSUPFLG='1'B;

     46  1 000006   400000 236003                    LDQ     -131072,DU
         1 000007   200007 756100                    STQ     ZEROSUPFLG,,AUTO

      588       47    1    CVT1:
      589       48    1            TXT(0)=BINASC(P_BINARY.D0(0)+ASCBIN('0'));

     48  1 000010   200004 470500       CVT1         LDP0    @P_BINARY,,AUTO
         1 000011   000000 236100                    LDQ     0,,PR0
         1 000012   000017 772000                    QRL     15
         1 000013   000007 376007                    ANQ     7,DL
         1 000014   000060 036007                    ADLQ    48,DL
         1 000015   000033 736000                    QLS     27
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:141  
         1 000016   000000 276000 2                  ORQ     0
         1 000017   200005 552140                    STBQ    TXT,'40'O,AUTO

      590       49    1            TXT(1)=BINASC(P_BINARY.D0(1)+ASCBIN('0'));

     49  1 000020   000000 236100                    LDQ     0,,PR0
         1 000021   000014 772000                    QRL     12
         1 000022   000007 376007                    ANQ     7,DL
         1 000023   000060 036007                    ADLQ    48,DL
         1 000024   000033 736000                    QLS     27
         1 000025   000000 276000 2                  ORQ     0
         1 000026   000011 772000                    QRL     9
         1 000027   200005 552120                    STBQ    TXT,'20'O,AUTO

      591       50    1            TXT(2)=BINASC(P_BINARY.D0(2)+ASCBIN('0'));

     50  1 000030   000000 236100                    LDQ     0,,PR0
         1 000031   000011 772000                    QRL     9
         1 000032   000007 376007                    ANQ     7,DL
         1 000033   000060 036007                    ADLQ    48,DL
         1 000034   000033 736000                    QLS     27
         1 000035   000000 276000 2                  ORQ     0
         1 000036   000022 772000                    QRL     18
         1 000037   200005 552110                    STBQ    TXT,'10'O,AUTO

      592       51    1            TXT(3)=BINASC(P_BINARY.D0(3)+ASCBIN('0'));

     51  1 000040   000000 236100                    LDQ     0,,PR0
         1 000041   000006 772000                    QRL     6
         1 000042   000007 376007                    ANQ     7,DL
         1 000043   000060 036007                    ADLQ    48,DL
         1 000044   000033 736000                    QLS     27
         1 000045   000000 276000 2                  ORQ     0
         1 000046   000033 772000                    QRL     27
         1 000047   200005 552104                    STBQ    TXT,'04'O,AUTO

      593       52    1            TXT(4)=BINASC(P_BINARY.D0(4)+ASCBIN('0'));
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:142  

     52  1 000050   000000 236100                    LDQ     0,,PR0
         1 000051   000003 772000                    QRL     3
         1 000052   000007 376007                    ANQ     7,DL
         1 000053   000060 036007                    ADLQ    48,DL
         1 000054   000033 736000                    QLS     27
         1 000055   000000 276000 2                  ORQ     0
         1 000056   200006 552140                    STBQ    TXT+1,'40'O,AUTO

      594       53    1            TXT(5)=BINASC(P_BINARY.D0(5)+ASCBIN('0'));

     53  1 000057   000000 236100                    LDQ     0,,PR0
         1 000060   000007 376007                    ANQ     7,DL
         1 000061   000060 036007                    ADLQ    48,DL
         1 000062   000033 736000                    QLS     27
         1 000063   000000 276000 2                  ORQ     0
         1 000064   000011 772000                    QRL     9
         1 000065   200006 552120                    STBQ    TXT+1,'20'O,AUTO

      595       54    1            IF ZEROSUPFLG THEN

     54  1 000066   200007 234100                    SZN     ZEROSUPFLG,,AUTO
         1 000067   000076 605000 1                  TPL     s:57

      596       55    1               CALL EDITCHAR(P_TEXT,0,6,MOP6,TXTX);

     55  1 000070   200003 471500                    LDP1    @P_TEXT,,AUTO
         1 000071   100000 024500                    MVNE
         1 000072   200005 030006                    NDSC9   TXT,,AUTO                cn=0,s=nosgn,sf=0,n=6
         1 000073   000000 000002 0                  ADSC9   MOP6                     cn=0,n=2
         1 000074   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6
         1 000075   000102 710000 1                  TRA     s:58

      597       56    1            ELSE
      598       57    1               P_TEXT=TXTX;

     57  1 000076   200003 471500                    LDP1    @P_TEXT,,AUTO
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:143  
         1 000077   040100 100500                    MLR     fill='040'O
         1 000100   200005 000006                    ADSC9   TXT,,AUTO                cn=0,n=6
         1 000101   100000 000006                    ADSC9   0,,PR1                   cn=0,n=6

      599       58    1            RETURN;

     58  1 000102   000000 702200 xent               TSX2  ! X66_ARET
      600       59    1    END DEC_TO_OCT;

PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:144  
      No diagnostics issued in procedure DEC_TO_OCT.
PL6.E3A0      #006=DEC_TO_OCT File=Z8PS.:Z8A6TSI                                 SAT 08/09/97 09:45 Page:145  

 **** Variables and constants ****

  ****  Section 000 RoData DEC_TO_OCT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b BIT (9)     r     1 MOP6(0:1)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @P_BINARY                  3-0-0/w PTR         r     1 @P_TEXT
    *0-0-0/w STRC        r     1 P_BINARY                  *0-0-0/c CHAR(6)     r     1 P_TEXT
     5-0-0/c CHAR        r     1 TXT(0:5)                   5-0-0/c CHAR(6)     r     1 TXTX
     7-0-0/b BIT         r     1 ZEROSUPFLG


   Procedure DEC_TO_OCT requires 67 words for executable code.
   Procedure DEC_TO_OCT requires 8 words of local(AUTO) storage.

    No errors detected in file Z8PS.:Z8A6TSI    .
