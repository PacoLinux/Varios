VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:1    
        1        1        /*M* ASL$LIST_ALL_FORMSETS:  routine to handle LIST FORMSET cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_FORMSETS: PROC;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_FORMSETS
       13       13             CALL:     CALL ASL$LIST_ALL_FORMSETS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_FORMSETS is a subroutine to handle
       17       17                           the LIST FORMSET command for SUPER.
       18       18                           Form records are stored in the :FORM.:SYS
       19       19                           file and have keys that look like the following:
       20       20                                 'xxxxxx' where the x signifies
       21       21                                 a character from the alphanumeric character
       22       22                                 set plus the special characters ':$*' and
       23       23                                 is of length 6 or less.  If the form name
       24       24                                 is less than 6 characters, the key is
       25       25                                 blank padded on the right.
       26       26                           This routine will either read a single form
       27       27                           record or it will cycle through all of the form
       28       28                           records looking for matches
       29       29                           to the selection criteria as input in the
       30       30                           LIST/DISPLAY command.  If a match is found
       31       31                           this routine will call a validation routine
       32       32                           which will further determine whether or not
       33       33                           the current form should be dealt with further.
       34       34
       35       35                  MEMORY REQUIREMENTS:
       36       36                           For all of the routines that deal with listing/
       37       37                           displaying formsets:
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:2    
       38       38
       39       39                            ASL$LIST_ALL_FORMSETS
       40       40                            ASL$LIST_ONE_FORMSET
       41       41                            ASL$DISP_ONE_FORM
       42       42
       43       43                            The form record will be read into
       44       44                            data segment 1.  The record will be checked by
       45       45                            the ASL$LIST_ONE_FORMSET routine and
       46       46                            will be used by the ASL$DISP_ONE_FORM routine.
       47       47        */
       48       48        /********************************************************************/
       49       49        /*   Include files   include files   include files   include files  */
       50       50        /********************************************************************/
       51       51        %INCLUDE AS_PERR_C;
       52      653        %INCLUDE AS_SUPER_C;
       53     1088        %INCLUDE AS_SUBS_C;
       54     2502        %INCLUDE AS_MAC_C;
       55     2582        %INCLUDE AS_ENTRIES_M;
       56     3632        %INCLUDE AS_SSUBS_C;
       57     3724        %INCLUDE B_ERRORS_C;
       58     4851        %INCLUDE CP_6_SUBS;
       59     5391        %INCLUDE FS_SUPER_C;
       60     6154        %INCLUDE KL_SUPER_C;
       61     9056        %INCLUDE XU_MACRO_C;
       62    12162        %INCLUDE XU_FORMAT_C;
       63    12324        %INCLUDE OCI_SUBS_C ;
       64    12422        %INCLUDE AS_SUPER_R;
       65    15438        /********************************************************************/
       66    15439        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       67    15440        /********************************************************************/
       68    15441        %ASF$PREC_FORM ;
       69    15444        %ASF$READ_FORM ;
       70    15447        %ASF$READ_FORM_SEQ ;
       71    15450        %ASH$ERROR ;
       72    15453        %ASL$LIST_ONE_FORMSET ;
       73    15456        %ASL$FORM_LIST_OPTS ;
       74    15459        %ASB$WILD_MATCH ;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:3    
       75    15462    1   DCL X$FORMAT ENTRY(1) ;
       76    15463        /********************************************************************/
       77    15464        /*   Local based     local based     local based     local based    */
       78    15465        /********************************************************************/
       79    15466        %FS$FORMREC ( NAME = FS$FORMREC, STCLASS = "BASED(DSEG1$)");
       80    15537        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       81    15538                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       82    15583        %PARSE$SYM ( NAME = P$S,STCLASS = BASED);
       83    15621        /********************************************************************/
       84    15622        /*   Auto data       auto data       auto data       auto data      */
       85    15623        /********************************************************************/
       86    15624    1   DCL ALL                           BIT (1) ;
       87    15625    1   DCL CODE2                         UBIN;
       88    15626    1   DCL DISP                          BIT(1);
       89    15627    1   DCL DISP_FORMSETS                 SBIN;
       90    15628    1   DCL 1 FNAME ,
       91    15629    1          2 COUNT                    UBIN BYTE UNAL,
       92    15630    1          2 TEXT                     CHAR(6) CALIGNED;
       93    15631    1   DCL FORM_COUNT                    UBIN;
       94    15632    1   DCL FORM_FLAG (0:8)               BIT (1) UNAL;
       95    15633    1   DCL 1 FORMFLAG REDEF FORM_FLAG,
       96    15634    1          2 HEADER                   BIT (1) UNAL,
       97    15635    1          2 SETUP                    BIT (1) UNAL,
       98    15636    1          2 BANNER                   BIT (1) UNAL,
       99    15637    1          2 ACCESS                   BIT (1) UNAL,
      100    15638    1          2 VFU                      BIT (1) UNAL,
      101    15639    1          2 ALIGN                    BIT (1) UNAL,
      102    15640    1          2 JUSTNAM                  BIT (1) UNAL,
      103    15641    1          2 PSEUDO                   BIT (1) UNAL,
      104    15642    1          2 *                        BIT (1) UNAL;
      105    15643    1   DCL I                             UBIN;
      106    15644    1   DCL J                             UBIN;
      107    15645    1   DCL JCL                           BIT(1);
      108    15646    1   DCL K                             UBIN;
      109    15647    1   DCL OBJECT                        UBIN;
      110    15648    1   DCL OBJECT_STR                    CHAR(11);
      111    15649    1   DCL WILD_CARD                     BIT(1);
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:4    
      112    15650        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:5    
      113    15651        /********************************************************************/
      114    15652        /*   Constant data   constant data   constant data   constant data  */
      115    15653        /********************************************************************/
      116    15654    1   DCL FORMSET_STR              CHAR(0) CONSTANT INIT ('formset');
      117    15655    1   DCL FORMSETS_STR             CHAR(0) CONSTANT INIT ('formsets');
      118    15656    1   DCL FORM_STR                 CHAR(0) CONSTANT INIT ('form');
      119    15657    1   DCL FORMS_STR                CHAR(0) CONSTANT INIT ('forms');
      120    15658    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      121    15659    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      122    15660        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:6    
      123    15661        /********************************************************************/
      124    15662        /*   Procedure       procedure       procedure       procedure      */
      125    15663        /********************************************************************/
      126    15664    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      127    15665    1   JCL = %NO#;
      128    15666    1   WILD_CARD = %NO#;
      129    15667    1   FNAME.TEXT = '?';
      130    15668    1   FNAME.COUNT = 1;
      131    15669    1   DISP_FORMSETS = 0;
      132    15670    1   ALL = %NO#;
      133    15671    1   FORM_COUNT = 0;
      134    15672    1   OBJECT = %FORMSET_OBJ_VAL;
      135    15673    1   FORMFLAG = '000'O;
      136    15674
      137    15675    2   DO SELECT (CODE);
      138    15676
      139    15677    2      SELECT (%LIST_ALL_VAL);
      140    15678
      141    15679    2      DISP = %NO#;
      142    15680    2      JCL = %NO#;
      143    15681    2      ALL = %YES#;
      144    15682    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 1 THEN
      145    15683    2         OBJECT = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;
      146    15684
      147    15685    2      SELECT (%DISPLAY_ALL_VAL);
      148    15686
      149    15687    2      DISP = %YES#;
      150    15688    2      ALL = %YES#;
      151    15689    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;
      152    15690    3         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      153    15691    3         OBJECT = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;
      154    15692    3         END; /* Nsublks = 2  */
      155    15693    3      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;
      156    15694    3            IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN
      157    15695    3               JCL = %YES#;
      158    15696    4            ELSE DO;
      159    15697    4               OBJECT = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:7    
      160    15698    4               JCL = %NO#;
      161    15699    4               END; /* Object present  */
      162    15700    3            END; /* Nsublks = 1  */
      163    15701
      164    15702    2      SELECT (%LIST_FORMSET_VAL);
      165    15703
      166    15704    2      DISP = %NO#;
      167    15705    2      JCL = %NO#;
      168    15706    2      OBJECT = %FORMSET_OBJ_VAL;
      169    15707    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      170    15708    3         FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      171    15709    3         FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      172    15710    3         END; /*  Number of sublocks > 1  */
      173    15711
      174    15712    2      SELECT (%DISPLAY_FORMSET_VAL);
      175    15713
      176    15714    2      DISP = %YES#;
      177    15715    2      OBJECT = %FORMSET_OBJ_VAL;
      178    15716    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      179    15717    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      180    15718
      181    15719    4         DO SELECT (CODE2);
      182    15720
      183    15721    4            SELECT (%FORM_NAME_WILD_VAL);
      184    15722
      185    15723    4            FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      186    15724    4            FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      187    15725
      188    15726    4            SELECT (%JCL_VAL);
      189    15727
      190    15728    4            JCL = %YES#;
      191    15729
      192    15730    4            END;  /* Do case (CODE2) */
      193    15731
      194    15732    3         END;  /*  Do i  */
      195    15733
      196    15734    2      SELECT (%LIST_FORM_VAL);
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:8    
      197    15735    2      DISP = %NO#;
      198    15736    2      JCL = %NO#;
      199    15737    2      OBJECT = %FORM_OBJ_VAL;
      200    15738    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      201    15739    3         FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      202    15740    3         FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      203    15741    3         END; /*  Number of sublocks > 1  */
      204    15742
      205    15743    2      SELECT (%DISPLAY_FORM_VAL);
      206    15744
      207    15745    2      DISP = %YES#;
      208    15746    2      OBJECT = %FORM_OBJ_VAL;
      209    15747    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      210    15748    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      211    15749
      212    15750    4         DO SELECT (CODE2);
      213    15751
      214    15752    4            SELECT (%FORM_NAME_WILD_VAL);
      215    15753
      216    15754    4            FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      217    15755    4            FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      218    15756
      219    15757    4            SELECT (%JCL_VAL);
      220    15758
      221    15759    4            JCL = %YES#;
      222    15760
      223    15761    4            END;  /* Do case (CODE2) */
      224    15762
      225    15763    3         END;  /*  Do i  */
      226    15764
      227    15765    2      END;  /*  Do case (code)  */
      228    15766
      229    15767    1   IF OBJECT = %FORM_OBJ_VAL THEN
      230    15768    1      OBJECT_STR = FORMS_STR;
      231    15769    1   ELSE
      232    15770    1      OBJECT_STR = FORMSETS_STR;
      233    15771
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:9    
      234    15772    1   FDS.NVECS# = 0;
      235    15773    2   IF JCL THEN DO;
      236    15774    2      OBJECT_STR = FORMSETS_STR;
      237    15775    2      OBJECT = %FORMSET_OBJ_VAL;
      238    15776    2      CALL CONCAT (FMT_BUF, '%1/"', OBJECT_STR, '%1/');
      239    15777    2      FDS.FMT_.BOUND = LENGTHC (OBJECT_STR) + 6;
      240    15778    2      END;  /*  Jcl  */
      241    15779    2   ELSE DO;
      242    15780    2      CALL CONCAT (FMT_BUF, '%1/', OBJECT_STR, '%1/');
      243    15781    2      FDS.FMT_.BOUND = LENGTHC (OBJECT_STR) + 5;
      244    15782    2      END;  /*  Not jcl  */
      245    15783    1   FDS.TABDFLT# = 10;
      246    15784    1   CALL X$FORMAT (FDS);
      247    15785
      248    15786    1   IF NOT ALL
      249    15787    2   THEN DO;
      250    15788    2      USERS_KEY = FNAME;
      251    15789    2      CALL INDEX (I, '?', FNAME.TEXT)
      252    15790    3      WHENRETURN DO;
      253    15791    3         END;  /*  Whenreturn from index  */
      254    15792    3      WHENALTRETURN DO;
      255    15793    3         USERS_KEY.COUNT = 6;
      256    15794    3         I = DSEG1SIZE;
      257    15795    3         CALL ASF$READ_FORM(USERS_KEY, DSEG1$, I)
      258    15796    4         WHENALTRETURN DO;
      259    15797    4            IF MERR_CODE.CODE = %E$NOKEY
      260    15798    5            THEN DO;
      261    15799        /*E*  ERROR:  ASL-E$FNOEXIST-C
      262    15800              MESSAGE: %U1 does not exist.
      263    15801              MESSAGE1: The specified FORM does not exist.
      264    15802        */
      265    15803    5               AS_FIELD1 = FNAME;
      266    15804                    %SCREAM( ERR#=E$FNOEXIST, LEVEL=ERROR, MID='L' );
      267    15819    5               END;  /*  Error is nokey  */
      268    15820    5            ELSE DO;
      269    15821    5               CALL ASH$ERROR( MERR_CODE );
      270    15822    5               END;  /*  Error is not nokey  */
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:10   
      271    15823    4            RETURN;
      272    15824    4            END;  /*  Whenaltreturn from ASF$READ_FORM  */
      273    15825    4         IF DISP THEN DO;
      274    15826    4            IF JCL THEN
      275    15827    4               FORMFLAG = FORMFLAG | '777'O;
      276    15828    4            ELSE
      277    15829    4               CALL ASL$FORM_LIST_OPTS (FORM_FLAG);
      278    15830    4            END;  /*  If disp  */
      279    15831    3         ELSE
      280    15832    3            FORMFLAG = FORMFLAG | '000'O;
      281    15833    3         CALL ASL$LIST_ONE_FORMSET (OBJECT,FORM_COUNT,JCL,FORM_FLAG)
      282    15834    4         WHENALTRETURN DO;
      283    15835        /*E* ERROR: ASL-E$NOTMASTERFORM-C
      284    15836             MESSAGE:  The FORM %U1 is a pseudo form not a master form.
      285    15837        */
      286    15838    4            AS_FIELD1 = FNAME;
      287    15839                 %SCREAM (ERR# = %E$NOTMASTERFORM, LEVEL = ERROR, MID='L');
      288    15854    4            RETURN;
      289    15855    4            END;  /*  Whenaltreturn  */
      290    15856    3         IF OBJECT = %FORMSET_OBJ_VAL THEN DISP_FORMSETS = 1;
      291    15857    3         GOTO FINISH_UP;
      292    15858    3         END; /* Whenaltreturn on the index */
      293    15859    2      END; /* Of doing just one form */
      294    15860    2   IF DISP THEN DO;
      295    15861    2      IF JCL THEN
      296    15862    2         FORMFLAG = FORMFLAG | '777'O;
      297    15863    2      ELSE
      298    15864    2         CALL ASL$FORM_LIST_OPTS (FORM_FLAG);
      299    15865    2      END;  /*  If disp  */
      300    15866    1   ELSE
      301    15867    1      FORMFLAG = FORMFLAG | '000'O;
      302    15868    1   IF FORMFLAG = '0'B
      303    15869    2   THEN DO;  /* No options-suppress blank lines between names*/
      304    15870    2      FORMFLAG.JUSTNAM = %YES#;
      305    15871    2      END;  /*  Formflag is 0  */
      306    15872    1   USERS_KEY = '014000'O;           /* To precord to bof        */
      307    15873    1   CALL ASF$PREC_FORM(USERS_KEY);
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:11   
      308    15874    1   CALL INDEX (K, ' ', FNAME.TEXT)
      309    15875    2   WHENALTRETURN DO;
      310    15876    2      END;  /*  Whenaltreturn from index  */
      311    15877    1   IF K = 0 THEN K = 1;
      312    15878    2   DO FOREVER ;
      313    15879    3      DO UNTIL( USERS_KEY.COUNT <= 6 );
      314    15880    3         I = DSEG1SIZE;
      315    15881    3         CALL ASF$READ_FORM_SEQ(USERS_KEY,DSEG1$,I)
      316    15882    4         WHENALTRETURN DO;
      317    15883    4            IF MERR_CODE.CODE ~= %E$EOF
      318    15884    5            THEN DO;
      319    15885    5               CALL ASH$ERROR(MERR_CODE);
      320    15886    5               END;  /*  Error no eof  */
      321    15887    4            GOTO FINISH_UP;
      322    15888    4            END;  /*  Whenaltreturn from ASF$READ_FORM_SEQ  */
      323    15889    3         END;  /*  Do until not form  */
      324    15890    2      CALL INDEX (J, ' ', FS$FORMREC.FNAME)
      325    15891    3      WHENALTRETURN DO;
      326    15892    3         END;  /*  Whenaltreturn from index  */
      327    15893    2      IF J = 0 THEN J = 1;
      328    15894    2      CALL ASB$WILD_MATCH (J, FS$FORMREC.FNAME, K, FNAME.TEXT)
      329    15895    3      WHENRETURN DO;
      330    15896    3         CALL ASL$LIST_ONE_FORMSET (OBJECT,FORM_COUNT,JCL,FORM_FLAG)
      331    15897    4         WHENRETURN DO;
      332    15898    4            DISP_FORMSETS = DISP_FORMSETS + 1;
      333    15899    4            END;  /*  Whenreturn from ASL$LIST_ONE_FORMSET  */
      334    15900    4         WHENALTRETURN DO;
      335    15901    4            END;  /*  Whenaltreturn from ASL$LIST_ONE_FORMSET  */
      336    15902    3         END;  /*  Whenreturn from ASB$WILD_MATCH  */
      337    15903    3      WHENALTRETURN DO;
      338    15904    3         END;  /*  Whenaltreturn from ASB$WILD_MATCH  */
      339    15905    2      END;  /*  Do forever  */
      340    15906    1   FINISH_UP:
      341    15907    2   IF NOT DISP THEN DO;
      342    15908    2      FMT_BUF = '%\%/';
      343    15909    2      FDS.FMT_.BOUND = 3;
      344    15910    2      FDS.NVECS# = 0;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:12   
      345    15911    2      CALL X$FORMAT(FDS);
      346    15912    2      END; /*  If not disp  */
      347    15913    2   IF NOT JCL THEN DO;
      348    15914    3      IF OBJECT = %FORMSET_OBJ_VAL THEN DO;
      349    15915    3         FMT_VEC(0) = VECTOR (DISP_FORMSETS);
      350    15916    3         IF DISP_FORMSETS = 1 THEN
      351    15917    4         DO;
      352    15918    4            FMT_VEC(1) = VECTOR (FORMSET_STR);
      353    15919    4            END; /*  DISP_FORMSETS = 1  */
      354    15920    4         ELSE DO;
      355    15921    4            FMT_VEC(1) = VECTOR (FORMSETS_STR);
      356    15922    4            END; /*  DISP_FORMSETS ~= 1  */
      357    15923    3         END; /*  Formsets  */
      358    15924    3      IF OBJECT = %FORM_OBJ_VAL THEN DO;
      359    15925    3         FMT_VEC(0) = VECTOR (FORM_COUNT);
      360    15926    3         IF FORM_COUNT = 1 THEN
      361    15927    4         DO;
      362    15928    4            FMT_VEC(1) = VECTOR (FORM_STR);
      363    15929    4            END; /*  FORM_COUNT = 1  */
      364    15930    4         ELSE DO;
      365    15931    4            FMT_VEC(1) = VECTOR (FORMS_STR);
      366    15932    4            END; /*  FORM_COUNT ~= 1  */
      367    15933    3         END; /*  Forms  */
      368    15934    2      IF DISP THEN
      369    15935    3      DO;
      370    15936    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      371    15937    3         END; /*  If disp  */
      372    15938    3      ELSE DO;
      373    15939    3         FMT_VEC(2) = VECTOR (LIST_STR);
      374    15940    3         END; /*  If ~ disp  */
      375    15941    2      FDS.NVECS# = 3;
      376    15942    2      FMT_BUF = '   %5D %A %A.';
      377    15943    2      FDS.FMT_.BOUND = 12;
      378    15944    2      CALL X$FORMAT(FDS);
      379    15945    2      END; /* Not jcl */
      380    15946    1   RETURN;
      381    15947    1   END ASL$LIST_ALL_FORMSETS;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:13   

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:14   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_FORMSETS.

   Procedure ASL$LIST_ALL_FORMSETS requires 528 words for executable code.
   Procedure ASL$LIST_ALL_FORMSETS requires 26 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_FORMSETS.:E05TSI    .

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:15   

 Object Unit name= ASL$LIST_ALL_FORMSETS                      File name= ASL$LIST_FORMSETS.:E05TOU
 UTS= JUL 29 '97 10:09:24.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     20     24  ASL$LIST_ALL_FORMSETS
    2   Proc  even  none   528   1020  ASL$LIST_ALL_FORMSETS
    3  RoData even  none    24     30  ASL$LIST_ALL_FORMSETS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_FORMSETS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       3 ASF$READ_FORM
 yes     yes           Std       4 ASL$LIST_ONE_FORMSET
         yes           Std       1 X$FORMAT
         yes           Std       2 ASH$ERROR
         yes           Std       1 ASL$FORM_LIST_OPTS
 yes     yes           Std       3 ASF$READ_FORM_SEQ
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       1 ASF$PREC_FORM
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:16   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:17   


        1        1        /*M* ASL$LIST_ALL_FORMSETS:  routine to handle LIST FORMSET cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_FORMSETS: PROC;

      9  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000032 000000                    ZERO    26,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_FORMSETS
       13       13             CALL:     CALL ASL$LIST_ALL_FORMSETS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_FORMSETS is a subroutine to handle
       17       17                           the LIST FORMSET command for SUPER.
       18       18                           Form records are stored in the :FORM.:SYS
       19       19                           file and have keys that look like the following:
       20       20                                 'xxxxxx' where the x signifies
       21       21                                 a character from the alphanumeric character
       22       22                                 set plus the special characters ':$*' and
       23       23                                 is of length 6 or less.  If the form name
       24       24                                 is less than 6 characters, the key is
       25       25                                 blank padded on the right.
       26       26                           This routine will either read a single form
       27       27                           record or it will cycle through all of the form
       28       28                           records looking for matches
       29       29                           to the selection criteria as input in the
       30       30                           LIST/DISPLAY command.  If a match is found
       31       31                           this routine will call a validation routine
       32       32                           which will further determine whether or not
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:18   
       33       33                           the current form should be dealt with further.
       34       34
       35       35                  MEMORY REQUIREMENTS:
       36       36                           For all of the routines that deal with listing/
       37       37                           displaying formsets:
       38       38
       39       39                            ASL$LIST_ALL_FORMSETS
       40       40                            ASL$LIST_ONE_FORMSET
       41       41                            ASL$DISP_ONE_FORM
       42       42
       43       43                            The form record will be read into
       44       44                            data segment 1.  The record will be checked by
       45       45                            the ASL$LIST_ONE_FORMSET routine and
       46       46                            will be used by the ASL$DISP_ONE_FORM routine.
       47       47        */
       48       48        /********************************************************************/
       49       49        /*   Include files   include files   include files   include files  */
       50       50        /********************************************************************/
       51       51        %INCLUDE AS_PERR_C;
       52      653        %INCLUDE AS_SUPER_C;
       53     1088        %INCLUDE AS_SUBS_C;
       54     2502        %INCLUDE AS_MAC_C;
       55     2582        %INCLUDE AS_ENTRIES_M;
       56     3632        %INCLUDE AS_SSUBS_C;
       57     3724        %INCLUDE B_ERRORS_C;
       58     4851        %INCLUDE CP_6_SUBS;
       59     5391        %INCLUDE FS_SUPER_C;
       60     6154        %INCLUDE KL_SUPER_C;
       61     9056        %INCLUDE XU_MACRO_C;
       62    12162        %INCLUDE XU_FORMAT_C;
       63    12324        %INCLUDE OCI_SUBS_C ;
       64    12422        %INCLUDE AS_SUPER_R;
       65    15438        /********************************************************************/
       66    15439        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       67    15440        /********************************************************************/
       68    15441        %ASF$PREC_FORM ;
       69    15444        %ASF$READ_FORM ;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:19   
       70    15447        %ASF$READ_FORM_SEQ ;
       71    15450        %ASH$ERROR ;
       72    15453        %ASL$LIST_ONE_FORMSET ;
       73    15456        %ASL$FORM_LIST_OPTS ;
       74    15459        %ASB$WILD_MATCH ;
       75    15462    1   DCL X$FORMAT ENTRY(1) ;
       76    15463        /********************************************************************/
       77    15464        /*   Local based     local based     local based     local based    */
       78    15465        /********************************************************************/
       79    15466        %FS$FORMREC ( NAME = FS$FORMREC, STCLASS = "BASED(DSEG1$)");
       80    15537        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       81    15538                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       82    15583        %PARSE$SYM ( NAME = P$S,STCLASS = BASED);
       83    15621        /********************************************************************/
       84    15622        /*   Auto data       auto data       auto data       auto data      */
       85    15623        /********************************************************************/
       86    15624    1   DCL ALL                           BIT (1) ;
       87    15625    1   DCL CODE2                         UBIN;
       88    15626    1   DCL DISP                          BIT(1);
       89    15627    1   DCL DISP_FORMSETS                 SBIN;
       90    15628    1   DCL 1 FNAME ,
       91    15629    1          2 COUNT                    UBIN BYTE UNAL,
       92    15630    1          2 TEXT                     CHAR(6) CALIGNED;
       93    15631    1   DCL FORM_COUNT                    UBIN;
       94    15632    1   DCL FORM_FLAG (0:8)               BIT (1) UNAL;
       95    15633    1   DCL 1 FORMFLAG REDEF FORM_FLAG,
       96    15634    1          2 HEADER                   BIT (1) UNAL,
       97    15635    1          2 SETUP                    BIT (1) UNAL,
       98    15636    1          2 BANNER                   BIT (1) UNAL,
       99    15637    1          2 ACCESS                   BIT (1) UNAL,
      100    15638    1          2 VFU                      BIT (1) UNAL,
      101    15639    1          2 ALIGN                    BIT (1) UNAL,
      102    15640    1          2 JUSTNAM                  BIT (1) UNAL,
      103    15641    1          2 PSEUDO                   BIT (1) UNAL,
      104    15642    1          2 *                        BIT (1) UNAL;
      105    15643    1   DCL I                             UBIN;
      106    15644    1   DCL J                             UBIN;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:20   
      107    15645    1   DCL JCL                           BIT(1);
      108    15646    1   DCL K                             UBIN;
      109    15647    1   DCL OBJECT                        UBIN;
      110    15648    1   DCL OBJECT_STR                    CHAR(11);
      111    15649    1   DCL WILD_CARD                     BIT(1);
      112    15650        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:21   
      113    15651        /********************************************************************/
      114    15652        /*   Constant data   constant data   constant data   constant data  */
      115    15653        /********************************************************************/
      116    15654    1   DCL FORMSET_STR              CHAR(0) CONSTANT INIT ('formset');
      117    15655    1   DCL FORMSETS_STR             CHAR(0) CONSTANT INIT ('formsets');
      118    15656    1   DCL FORM_STR                 CHAR(0) CONSTANT INIT ('form');
      119    15657    1   DCL FORMS_STR                CHAR(0) CONSTANT INIT ('forms');
      120    15658    1   DCL LIST_STR                 CHAR(0) CONSTANT INIT ('listed');
      121    15659    1   DCL DISPLAY_STR              CHAR(0) CONSTANT INIT ('displayed');
      122    15660        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:22   
      123    15661        /********************************************************************/
      124    15662        /*   Procedure       procedure       procedure       procedure      */
      125    15663        /********************************************************************/
      126    15664    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15664  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      127    15665    1   JCL = %NO#;

  15665  2 000007   200015 450100                    STZ     JCL,,AUTO

      128    15666    1   WILD_CARD = %NO#;

  15666  2 000010   200023 450100                    STZ     WILD_CARD,,AUTO

      129    15667    1   FNAME.TEXT = '?';

  15667  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6

      130    15668    1   FNAME.COUNT = 1;

  15668  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200007 552140                    STBQ    FNAME,'40'O,AUTO

      131    15669    1   DISP_FORMSETS = 0;

  15669  2 000016   200006 450100                    STZ     DISP_FORMSETS,,AUTO

      132    15670    1   ALL = %NO#;

  15670  2 000017   200003 450100                    STZ     ALL,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:23   

      133    15671    1   FORM_COUNT = 0;

  15671  2 000020   200011 450100                    STZ     FORM_COUNT,,AUTO

      134    15672    1   OBJECT = %FORMSET_OBJ_VAL;

  15672  2 000021   000020 235007                    LDA     16,DL
         2 000022   200017 755100                    STA     OBJECT,,AUTO

      135    15673    1   FORMFLAG = '000'O;

  15673  2 000023   000000 236003                    LDQ     0,DU
         2 000024   200012 552140                    STBQ    FORM_FLAG,'40'O,AUTO

      136    15674
      137    15675    2   DO SELECT (CODE);

  15675  2 000025   000000 236000 xsym               LDQ     CODE
         2 000026   000024 116007                    CMPQ    20,DL
         2 000027   000042 602000 2                  TNC     s:15675+13
         2 000030   000130 600000 2                  TZE     s:15704
         2 000031   000144 116007                    CMPQ    100,DL
         2 000032   000037 602000 2                  TNC     s:15675+10
         2 000033   000066 600000 2                  TZE     s:15687
         2 000034   000145 116007                    CMPQ    101,DL
         2 000035   000315 601000 2                  TNZ     s:15767
         2 000036   000151 710000 2                  TRA     s:15714
         2 000037   000126 116007                    CMPQ    86,DL
         2 000040   000315 601000 2                  TNZ     s:15767
         2 000041   000244 710000 2                  TRA     s:15745
         2 000042   000022 116007                    CMPQ    18,DL
         2 000043   000046 602000 2                  TNC     s:15675+17
         2 000044   000051 600000 2                  TZE     s:15679
         2 000045   000315 710000 2                  TRA     s:15767
         2 000046   000004 116007                    CMPQ    4,DL
         2 000047   000315 601000 2                  TNZ     s:15767
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:24   
         2 000050   000222 710000 2                  TRA     s:15735

      138    15676
      139    15677    2      SELECT (%LIST_ALL_VAL);

      140    15678
      141    15679    2      DISP = %NO#;

  15679  2 000051   200005 450100                    STZ     DISP,,AUTO

      142    15680    2      JCL = %NO#;

  15680  2 000052   200015 450100                    STZ     JCL,,AUTO

      143    15681    2      ALL = %YES#;

  15681  2 000053   400000 236003                    LDQ     -131072,DU
         2 000054   200003 756100                    STQ     ALL,,AUTO

      144    15682    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 1 THEN

  15682  2 000055   000003 471500                    LDP1    3,,PR0
         2 000056   100001 220100                    LDX0    1,,PR1
         2 000057   000001 100003                    CMPX0   1,DU
         2 000060   000315 601000 2                  TNZ     s:15767

      145    15683    2         OBJECT = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;

  15683  2 000061   100003 473500                    LDP3    3,,PR1
         2 000062   300000 236100                    LDQ     0,,PR3
         2 000063   777777 376007                    ANQ     -1,DL
         2 000064   200017 756100                    STQ     OBJECT,,AUTO
         2 000065   000315 710000 2                  TRA     s:15767

      146    15684
      147    15685    2      SELECT (%DISPLAY_ALL_VAL);

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:25   
      148    15686
      149    15687    2      DISP = %YES#;

  15687  2 000066   400000 236003                    LDQ     -131072,DU
         2 000067   200005 756100                    STQ     DISP,,AUTO

      150    15688    2      ALL = %YES#;

  15688  2 000070   200003 756100                    STQ     ALL,,AUTO

      151    15689    3      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN DO;

  15689  2 000071   000003 471500                    LDP1    3,,PR0
         2 000072   100001 220100                    LDX0    1,,PR1
         2 000073   000002 100003                    CMPX0   2,DU
         2 000074   000113 601000 2                  TNZ     s:15693

      152    15690    3         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  15690  2 000075   100004 473500                    LDP3    4,,PR1
         2 000076   400000 221003                    LDX1    -131072,DU
         2 000077   300000 722100                    LXL2    0,,PR3
         2 000100   000001 102003                    CMPX2   1,DU
         2 000101   000103 600000 2                  TZE     s:15690+6
         2 000102   000000 221003                    LDX1    0,DU
         2 000103   000000 636011                    EAQ     0,X1
         2 000104   200015 756100                    STQ     JCL,,AUTO

      153    15691    3         OBJECT = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;

  15691  2 000105   000003 471500                    LDP1    3,,PR0
         2 000106   100003 473500                    LDP3    3,,PR1
         2 000107   300000 236100                    LDQ     0,,PR3
         2 000110   777777 376007                    ANQ     -1,DL
         2 000111   200017 756100                    STQ     OBJECT,,AUTO

      154    15692    3         END; /* Nsublks = 2  */
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:26   

  15692  2 000112   000315 710000 2                  TRA     s:15767

      155    15693    3      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN DO;

  15693  2 000113   000000 100003                    CMPX0   0,DU
         2 000114   000315 600000 2                  TZE     s:15767

      156    15694    3            IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL THEN

  15694  2 000115   100003 473500                    LDP3    3,,PR1
         2 000116   300000 721100                    LXL1    0,,PR3
         2 000117   000001 101003                    CMPX1   1,DU
         2 000120   000123 601000 2                  TNZ     s:15697

      157    15695    3               JCL = %YES#;

  15695  2 000121   200015 756100                    STQ     JCL,,AUTO
         2 000122   000315 710000 2                  TRA     s:15767

      158    15696    4            ELSE DO;

      159    15697    4               OBJECT = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE;

  15697  2 000123   300000 236100                    LDQ     0,,PR3
         2 000124   777777 376007                    ANQ     -1,DL
         2 000125   200017 756100                    STQ     OBJECT,,AUTO

      160    15698    4               JCL = %NO#;

  15698  2 000126   200015 450100                    STZ     JCL,,AUTO

      161    15699    4               END; /* Object present  */

      162    15700    3            END; /* Nsublks = 1  */

  15700  2 000127   000315 710000 2                  TRA     s:15767
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:27   

      163    15701
      164    15702    2      SELECT (%LIST_FORMSET_VAL);

      165    15703
      166    15704    2      DISP = %NO#;

  15704  2 000130   200005 450100                    STZ     DISP,,AUTO

      167    15705    2      JCL = %NO#;

  15705  2 000131   200015 450100                    STZ     JCL,,AUTO

      168    15706    2      OBJECT = %FORMSET_OBJ_VAL;

  15706  2 000132   200017 755100                    STA     OBJECT,,AUTO

      169    15707    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  15707  2 000133   000001 220100                    LDX0    1,,PR0
         2 000134   000002 100003                    CMPX0   2,DU
         2 000135   000315 602000 2                  TNC     s:15767

      170    15708    3         FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15708  2 000136   000004 471500                    LDP1    4,,PR0
         2 000137   100004 236100                    LDQ     4,,PR1
         2 000140   000033 772000                    QRL     27
         2 000141   000000 621006                    EAX1    0,QL
         2 000142   040100 100540                    MLR     fill='040'O
         2 000143   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000144   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6

      171    15709    3         FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15709  2 000145   000004 471500                    LDP1    4,,PR0
         2 000146   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:28   
         2 000147   200007 552140                    STBQ    FNAME,'40'O,AUTO

      172    15710    3         END; /*  Number of sublocks > 1  */

  15710  2 000150   000315 710000 2                  TRA     s:15767

      173    15711
      174    15712    2      SELECT (%DISPLAY_FORMSET_VAL);

      175    15713
      176    15714    2      DISP = %YES#;

  15714  2 000151   400000 236003                    LDQ     -131072,DU
         2 000152   200005 756100                    STQ     DISP,,AUTO

      177    15715    2      OBJECT = %FORMSET_OBJ_VAL;

  15715  2 000153   200017 755100                    STA     OBJECT,,AUTO

      178    15716    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15716  2 000154   000001 235007                    LDA     1,DL
         2 000155   200013 755100                    STA     I,,AUTO
         2 000156   000214 710000 2                  TRA     s:15732+3

      179    15717    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  15717  2 000157   000003 470400 xsym               LDP0    P_PCB+3
         2 000160   200013 720100                    LXL0    I,,AUTO
         2 000161   000003 471510                    LDP1    3,X0,PR0
         2 000162   100000 236100                    LDQ     0,,PR1
         2 000163   777777 376007                    ANQ     -1,DL
         2 000164   200004 756100                    STQ     CODE2,,AUTO

      180    15718
      181    15719    4         DO SELECT (CODE2);

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:29   
  15719  2 000165   000360 116007                    CMPQ    240,DL
         2 000166   000171 602000 2                  TNC     s:15719+4
         2 000167   000174 600000 2                  TZE     s:15723
         2 000170   000211 710000 2                  TRA     s:15732
         2 000171   000001 116007                    CMPQ    1,DL
         2 000172   000211 601000 2                  TNZ     s:15732
         2 000173   000207 710000 2                  TRA     s:15728

      182    15720
      183    15721    4            SELECT (%FORM_NAME_WILD_VAL);

      184    15722
      185    15723    4            FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15723  2 000174   000004 473500                    LDP3    4,,PR0
         2 000175   300004 236100                    LDQ     4,,PR3
         2 000176   000033 772000                    QRL     27
         2 000177   000000 621006                    EAX1    0,QL
         2 000200   040100 100540                    MLR     fill='040'O
         2 000201   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 000202   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6

      186    15724    4            FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15724  2 000203   000004 471500                    LDP1    4,,PR0
         2 000204   100004 236100                    LDQ     4,,PR1
         2 000205   200007 552140                    STBQ    FNAME,'40'O,AUTO
         2 000206   000211 710000 2                  TRA     s:15732

      187    15725
      188    15726    4            SELECT (%JCL_VAL);

      189    15727
      190    15728    4            JCL = %YES#;

  15728  2 000207   400000 236003                    LDQ     -131072,DU
         2 000210   200015 756100                    STQ     JCL,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:30   

      191    15729
      192    15730    4            END;  /* Do case (CODE2) */

      193    15731
      194    15732    3         END;  /*  Do i  */

  15732  2 000211   200013 235100                    LDA     I,,AUTO
         2 000212   000001 035007                    ADLA    1,DL
         2 000213   200013 755100                    STA     I,,AUTO
         2 000214   000001 236100                    LDQ     1,,PR0
         2 000215   000022 772000                    QRL     18
         2 000216   200013 116100                    CMPQ    I,,AUTO
         2 000217   000221 600000 2                  TZE     s:15732+8
         2 000220   000157 603000 2                  TRC     s:15717
         2 000221   000315 710000 2                  TRA     s:15767

      195    15733
      196    15734    2      SELECT (%LIST_FORM_VAL);

      197    15735    2      DISP = %NO#;

  15735  2 000222   200005 450100                    STZ     DISP,,AUTO

      198    15736    2      JCL = %NO#;

  15736  2 000223   200015 450100                    STZ     JCL,,AUTO

      199    15737    2      OBJECT = %FORM_OBJ_VAL;

  15737  2 000224   000016 235007                    LDA     14,DL
         2 000225   200017 755100                    STA     OBJECT,,AUTO

      200    15738    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  15738  2 000226   000001 220100                    LDX0    1,,PR0
         2 000227   000002 100003                    CMPX0   2,DU
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:31   
         2 000230   000315 602000 2                  TNC     s:15767

      201    15739    3         FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15739  2 000231   000004 471500                    LDP1    4,,PR0
         2 000232   100004 236100                    LDQ     4,,PR1
         2 000233   000033 772000                    QRL     27
         2 000234   000000 621006                    EAX1    0,QL
         2 000235   040100 100540                    MLR     fill='040'O
         2 000236   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000237   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6

      202    15740    3         FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15740  2 000240   000004 471500                    LDP1    4,,PR0
         2 000241   100004 236100                    LDQ     4,,PR1
         2 000242   200007 552140                    STBQ    FNAME,'40'O,AUTO

      203    15741    3         END; /*  Number of sublocks > 1  */

  15741  2 000243   000315 710000 2                  TRA     s:15767

      204    15742
      205    15743    2      SELECT (%DISPLAY_FORM_VAL);

      206    15744
      207    15745    2      DISP = %YES#;

  15745  2 000244   400000 236003                    LDQ     -131072,DU
         2 000245   200005 756100                    STQ     DISP,,AUTO

      208    15746    2      OBJECT = %FORM_OBJ_VAL;

  15746  2 000246   000016 235007                    LDA     14,DL
         2 000247   200017 755100                    STA     OBJECT,,AUTO

      209    15747    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:32   

  15747  2 000250   000001 235007                    LDA     1,DL
         2 000251   200013 755100                    STA     I,,AUTO
         2 000252   000310 710000 2                  TRA     s:15763+3

      210    15748    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  15748  2 000253   000003 470400 xsym               LDP0    P_PCB+3
         2 000254   200013 720100                    LXL0    I,,AUTO
         2 000255   000003 471510                    LDP1    3,X0,PR0
         2 000256   100000 236100                    LDQ     0,,PR1
         2 000257   777777 376007                    ANQ     -1,DL
         2 000260   200004 756100                    STQ     CODE2,,AUTO

      211    15749
      212    15750    4         DO SELECT (CODE2);

  15750  2 000261   000360 116007                    CMPQ    240,DL
         2 000262   000265 602000 2                  TNC     s:15750+4
         2 000263   000270 600000 2                  TZE     s:15754
         2 000264   000305 710000 2                  TRA     s:15763
         2 000265   000001 116007                    CMPQ    1,DL
         2 000266   000305 601000 2                  TNZ     s:15763
         2 000267   000303 710000 2                  TRA     s:15759

      213    15751
      214    15752    4            SELECT (%FORM_NAME_WILD_VAL);

      215    15753
      216    15754    4            FNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15754  2 000270   000004 473500                    LDP3    4,,PR0
         2 000271   300004 236100                    LDQ     4,,PR3
         2 000272   000033 772000                    QRL     27
         2 000273   000000 621006                    EAX1    0,QL
         2 000274   040100 100540                    MLR     fill='040'O
         2 000275   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:33   
         2 000276   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6

      217    15755    4            FNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15755  2 000277   000004 471500                    LDP1    4,,PR0
         2 000300   100004 236100                    LDQ     4,,PR1
         2 000301   200007 552140                    STBQ    FNAME,'40'O,AUTO
         2 000302   000305 710000 2                  TRA     s:15763

      218    15756
      219    15757    4            SELECT (%JCL_VAL);

      220    15758
      221    15759    4            JCL = %YES#;

  15759  2 000303   400000 236003                    LDQ     -131072,DU
         2 000304   200015 756100                    STQ     JCL,,AUTO

      222    15760
      223    15761    4            END;  /* Do case (CODE2) */

      224    15762
      225    15763    3         END;  /*  Do i  */

  15763  2 000305   200013 235100                    LDA     I,,AUTO
         2 000306   000001 035007                    ADLA    1,DL
         2 000307   200013 755100                    STA     I,,AUTO
         2 000310   000001 236100                    LDQ     1,,PR0
         2 000311   000022 772000                    QRL     18
         2 000312   200013 116100                    CMPQ    I,,AUTO
         2 000313   000315 600000 2                  TZE     s:15767
         2 000314   000253 603000 2                  TRC     s:15748

      226    15764
      227    15765    2      END;  /*  Do case (code)  */

      228    15766
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:34   
      229    15767    1   IF OBJECT = %FORM_OBJ_VAL THEN

  15767  2 000315   200017 235100                    LDA     OBJECT,,AUTO
         2 000316   000016 115007                    CMPA    14,DL
         2 000317   000324 601000 2                  TNZ     s:15770

      230    15768    1      OBJECT_STR = FORMS_STR;

  15768  2 000320   040100 100400                    MLR     fill='040'O
         2 000321   000005 000005 1                  ADSC9   FORMS_STR                cn=0,n=5
         2 000322   200020 000013                    ADSC9   OBJECT_STR,,AUTO         cn=0,n=11
         2 000323   000327 710000 2                  TRA     s:15772

      231    15769    1   ELSE
      232    15770    1      OBJECT_STR = FORMSETS_STR;

  15770  2 000324   040100 100400                    MLR     fill='040'O
         2 000325   000002 000010 1                  ADSC9   FORMSETS_STR             cn=0,n=8
         2 000326   200020 000013                    ADSC9   OBJECT_STR,,AUTO         cn=0,n=11

      233    15771
      234    15772    1   FDS.NVECS# = 0;

  15772  2 000327   000011 450000 xsym               STZ     FDS+9

      235    15773    2   IF JCL THEN DO;

  15773  2 000330   200015 234100                    SZN     JCL,,AUTO
         2 000331   000354 605000 2                  TPL     s:15780

      236    15774    2      OBJECT_STR = FORMSETS_STR;

  15774  2 000332   040100 100400                    MLR     fill='040'O
         2 000333   000002 000010 1                  ADSC9   FORMSETS_STR             cn=0,n=8
         2 000334   200020 000013                    ADSC9   OBJECT_STR,,AUTO         cn=0,n=11

      237    15775    2      OBJECT = %FORMSET_OBJ_VAL;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:35   

  15775  2 000335   000020 236007                    LDQ     16,DL
         2 000336   200017 756100                    STQ     OBJECT,,AUTO

      238    15776    2      CALL CONCAT (FMT_BUF, '%1/"', OBJECT_STR, '%1/');

  15776  2 000337   000014 236000 1                  LDQ     DISPLAY_STR+3
         2 000340   000000 756000 xsym               STQ     FMT_BUF
         2 000341   040000 100500                    MLR     fill='040'O
         2 000342   200020 000013                    ADSC9   OBJECT_STR,,AUTO         cn=0,n=11
         2 000343   000001 000013 xsym               ADSC9   FMT_BUF+1                cn=0,n=11
         2 000344   040000 100400                    MLR     fill='040'O
         2 000345   000014 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000346   000003 600360 xsym               ADSC9   FMT_BUF+3                cn=3,n=240

      239    15777    2      FDS.FMT_.BOUND = LENGTHC (OBJECT_STR) + 6;

  15777  2 000347   000000 236000 xsym               LDQ     FDS
         2 000350   177777 376007                    ANQ     65535,DL
         2 000351   000001 276000 3                  ORQ     1
         2 000352   000000 756000 xsym               STQ     FDS

      240    15778    2      END;  /*  Jcl  */

  15778  2 000353   000372 710000 2                  TRA     s:15783

      241    15779    2   ELSE DO;

      242    15780    2      CALL CONCAT (FMT_BUF, '%1/', OBJECT_STR, '%1/');

  15780  2 000354   000014 236000 1                  LDQ     DISPLAY_STR+3
         2 000355   000002 376000 3                  ANQ     2
         2 000356   000040 276007                    ORQ     32,DL
         2 000357   000000 756000 xsym               STQ     FMT_BUF
         2 000360   040000 100500                    MLR     fill='040'O
         2 000361   200020 000013                    ADSC9   OBJECT_STR,,AUTO         cn=0,n=11
         2 000362   000000 600013 xsym               ADSC9   FMT_BUF                  cn=3,n=11
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:36   
         2 000363   040000 100400                    MLR     fill='040'O
         2 000364   000014 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000365   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      243    15781    2      FDS.FMT_.BOUND = LENGTHC (OBJECT_STR) + 5;

  15781  2 000366   000000 236000 xsym               LDQ     FDS
         2 000367   177777 376007                    ANQ     65535,DL
         2 000370   000004 276003                    ORQ     4,DU
         2 000371   000000 756000 xsym               STQ     FDS

      244    15782    2      END;  /*  Not jcl  */

      245    15783    1   FDS.TABDFLT# = 10;

  15783  2 000372   000012 235007                    LDA     10,DL
         2 000373   000017 755000 xsym               STA     FDS+15

      246    15784    1   CALL X$FORMAT (FDS);

  15784  2 000374   000003 630400 3                  EPPR0   3
         2 000375   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000376   000000 701000 xent               TSX1    X$FORMAT
         2 000377   000000 011000                    NOP     0

      247    15785
      248    15786    1   IF NOT ALL

  15786  2 000400   200003 234100                    SZN     ALL,,AUTO
         2 000401   000530 604000 2                  TMI     s:15860

      249    15787    2   THEN DO;

      250    15788    2      USERS_KEY = FNAME;

  15788  2 000402   000000 100500                    MLR     fill='000'O
         2 000403   200007 000007                    ADSC9   FNAME,,AUTO              cn=0,n=7
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:37   
         2 000404   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      251    15789    2      CALL INDEX (I, '?', FNAME.TEXT)

  15789  2 000405   000000 124500                    SCM     mask='000'O
         2 000406   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6
         2 000407   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000410   200013 000100                    ARG     I,,AUTO
         2 000411   000413 606400 2                  TTN     s:15793

      252    15790    3      WHENRETURN DO;

      253    15791    3         END;  /*  Whenreturn from index  */

  15791  2 000412   000530 710000 2                  TRA     s:15860

      254    15792    3      WHENALTRETURN DO;

      255    15793    3         USERS_KEY.COUNT = 6;

  15793  2 000413   006000 236003                    LDQ     3072,DU
         2 000414   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      256    15794    3         I = DSEG1SIZE;

  15794  2 000415   000000 235000 xsym               LDA     DSEG1SIZE
         2 000416   200013 755100                    STA     I,,AUTO

      257    15795    3         CALL ASF$READ_FORM(USERS_KEY, DSEG1$, I)

  15795  2 000417   200013 630500                    EPPR0   I,,AUTO
         2 000420   200026 450500                    STP0    WILD_CARD+3,,AUTO
         2 000421   000004 237000 3                  LDAQ    4
         2 000422   200024 757100                    STAQ    WILD_CARD+1,,AUTO
         2 000423   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000424   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000425   000000 701000 xent               TSX1    ASF$READ_FORM
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:38   
         2 000426   000430 702000 2                  TSX2    s:15797
         2 000427   000451 710000 2                  TRA     s:15825

      258    15796    4         WHENALTRETURN DO;

      259    15797    4            IF MERR_CODE.CODE = %E$NOKEY

  15797  2 000430   000000 236000 xsym               LDQ     ERR_CODE
         2 000431   377770 376007                    ANQ     131064,DL
         2 000432   001020 116007                    CMPQ    528,DL
         2 000433   000444 601000 2                  TNZ     s:15821

      260    15798    5            THEN DO;

      261    15799        /*E*  ERROR:  ASL-E$FNOEXIST-C
      262    15800              MESSAGE: %U1 does not exist.
      263    15801              MESSAGE1: The specified FORM does not exist.
      264    15802        */
      265    15803    5               AS_FIELD1 = FNAME;

  15803  2 000434   000000 100500                    MLR     fill='000'O
         2 000435   200007 000007                    ADSC9   FNAME,,AUTO              cn=0,n=7
         2 000436   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      266    15804                    %SCREAM( ERR#=E$FNOEXIST, LEVEL=ERROR, MID='L' );

  15816  2 000437   000006 630400 3                  EPPR0   6
         2 000440   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000441   000000 701000 xent               TSX1    ASH$ERROR
         2 000442   000000 011000                    NOP     0

      267    15819    5               END;  /*  Error is nokey  */

  15819  2 000443   000450 710000 2                  TRA     s:15823

      268    15820    5            ELSE DO;

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:39   
      269    15821    5               CALL ASH$ERROR( MERR_CODE );

  15821  2 000444   000007 630400 3                  EPPR0   7
         2 000445   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000446   000000 701000 xent               TSX1    ASH$ERROR
         2 000447   000000 011000                    NOP     0

      270    15822    5               END;  /*  Error is not nokey  */

      271    15823    4            RETURN;

  15823  2 000450   000000 702200 xent               TSX2  ! X66_ARET

      272    15824    4            END;  /*  Whenaltreturn from ASF$READ_FORM  */
      273    15825    4         IF DISP THEN DO;

  15825  2 000451   200005 234100                    SZN     DISP,,AUTO
         2 000452   000471 605000 2                  TPL     s:15832

      274    15826    4            IF JCL THEN

  15826  2 000453   200015 234100                    SZN     JCL,,AUTO
         2 000454   000462 605000 2                  TPL     s:15829

      275    15827    4               FORMFLAG = FORMFLAG | '777'O;

  15827  2 000455   200012 236100                    LDQ     FORM_FLAG,,AUTO
         2 000456   777000 376003                    ANQ     -512,DU
         2 000457   777000 276003                    ORQ     -512,DU
         2 000460   200012 552140                    STBQ    FORM_FLAG,'40'O,AUTO
         2 000461   000475 710000 2                  TRA     s:15833

      276    15828    4            ELSE
      277    15829    4               CALL ASL$FORM_LIST_OPTS (FORM_FLAG);

  15829  2 000462   200012 630500                    EPPR0   FORM_FLAG,,AUTO
         2 000463   200024 450500                    STP0    WILD_CARD+1,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:40   
         2 000464   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000465   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000466   000000 701000 xent               TSX1    ASL$FORM_LIST_OPTS
         2 000467   000000 011000                    NOP     0

      278    15830    4            END;  /*  If disp  */

  15830  2 000470   000475 710000 2                  TRA     s:15833

      279    15831    3         ELSE
      280    15832    3            FORMFLAG = FORMFLAG | '000'O;

  15832  2 000471   200012 236100                    LDQ     FORM_FLAG,,AUTO
         2 000472   777000 376003                    ANQ     -512,DU
         2 000473   000000 276003                    ORQ     0,DU
         2 000474   200012 552140                    STBQ    FORM_FLAG,'40'O,AUTO

      281    15833    3         CALL ASL$LIST_ONE_FORMSET (OBJECT,FORM_COUNT,JCL,FORM_FLAG)

  15833  2 000475   200012 630500                    EPPR0   FORM_FLAG,,AUTO
         2 000476   200027 450500                    STP0    WILD_CARD+4,,AUTO
         2 000477   200015 631500                    EPPR1   JCL,,AUTO
         2 000500   200026 451500                    STP1    WILD_CARD+3,,AUTO
         2 000501   200011 633500                    EPPR3   FORM_COUNT,,AUTO
         2 000502   200025 453500                    STP3    WILD_CARD+2,,AUTO
         2 000503   200017 634500                    EPPR4   OBJECT,,AUTO
         2 000504   200024 454500                    STP4    WILD_CARD+1,,AUTO
         2 000505   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000506   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000507   000000 701000 xent               TSX1    ASL$LIST_ONE_FORMSET
         2 000510   000512 702000 2                  TSX2    s:15838
         2 000511   000522 710000 2                  TRA     s:15856

      282    15834    4         WHENALTRETURN DO;

      283    15835        /*E* ERROR: ASL-E$NOTMASTERFORM-C
      284    15836             MESSAGE:  The FORM %U1 is a pseudo form not a master form.
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:41   
      285    15837        */
      286    15838    4            AS_FIELD1 = FNAME;

  15838  2 000512   000000 100500                    MLR     fill='000'O
         2 000513   200007 000007                    ADSC9   FNAME,,AUTO              cn=0,n=7
         2 000514   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      287    15839                 %SCREAM (ERR# = %E$NOTMASTERFORM, LEVEL = ERROR, MID='L');

  15851  2 000515   000010 630400 3                  EPPR0   8
         2 000516   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000517   000000 701000 xent               TSX1    ASH$ERROR
         2 000520   000000 011000                    NOP     0

      288    15854    4            RETURN;

  15854  2 000521   000000 702200 xent               TSX2  ! X66_ARET

      289    15855    4            END;  /*  Whenaltreturn  */
      290    15856    3         IF OBJECT = %FORMSET_OBJ_VAL THEN DISP_FORMSETS = 1;

  15856  2 000522   200017 235100                    LDA     OBJECT,,AUTO
         2 000523   000020 115007                    CMPA    16,DL
         2 000524   000527 601000 2                  TNZ     s:15857

  15856  2 000525   000001 236007                    LDQ     1,DL
         2 000526   200006 756100                    STQ     DISP_FORMSETS,,AUTO

      291    15857    3         GOTO FINISH_UP;

  15857  2 000527   000703 710000 2                  TRA     FINISH_UP

      292    15858    3         END; /* Whenaltreturn on the index */
      293    15859    2      END; /* Of doing just one form */

      294    15860    2   IF DISP THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:42   
  15860  2 000530   200005 234100                    SZN     DISP,,AUTO
         2 000531   000550 605000 2                  TPL     s:15867

      295    15861    2      IF JCL THEN

  15861  2 000532   200015 234100                    SZN     JCL,,AUTO
         2 000533   000541 605000 2                  TPL     s:15864

      296    15862    2         FORMFLAG = FORMFLAG | '777'O;

  15862  2 000534   200012 236100                    LDQ     FORM_FLAG,,AUTO
         2 000535   777000 376003                    ANQ     -512,DU
         2 000536   777000 276003                    ORQ     -512,DU
         2 000537   200012 552140                    STBQ    FORM_FLAG,'40'O,AUTO
         2 000540   000554 710000 2                  TRA     s:15868

      297    15863    2      ELSE
      298    15864    2         CALL ASL$FORM_LIST_OPTS (FORM_FLAG);

  15864  2 000541   200012 630500                    EPPR0   FORM_FLAG,,AUTO
         2 000542   200024 450500                    STP0    WILD_CARD+1,,AUTO
         2 000543   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000544   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000545   000000 701000 xent               TSX1    ASL$FORM_LIST_OPTS
         2 000546   000000 011000                    NOP     0

      299    15865    2      END;  /*  If disp  */

  15865  2 000547   000554 710000 2                  TRA     s:15868

      300    15866    1   ELSE
      301    15867    1      FORMFLAG = FORMFLAG | '000'O;

  15867  2 000550   200012 236100                    LDQ     FORM_FLAG,,AUTO
         2 000551   777000 376003                    ANQ     -512,DU
         2 000552   000000 276003                    ORQ     0,DU
         2 000553   200012 552140                    STBQ    FORM_FLAG,'40'O,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:43   

      302    15868    1   IF FORMFLAG = '0'B

  15868  2 000554   200012 236100                    LDQ     FORM_FLAG,,AUTO
         2 000555   777000 316003                    CANQ    -512,DU
         2 000556   000561 601000 2                  TNZ     s:15872

      303    15869    2   THEN DO;  /* No options-suppress blank lines between names*/

      304    15870    2      FORMFLAG.JUSTNAM = %YES#;

  15870  2 000557   004000 236003                    LDQ     2048,DU
         2 000560   200012 256100                    ORSQ    FORM_FLAG,,AUTO

      305    15871    2      END;  /*  Formflag is 0  */

      306    15872    1   USERS_KEY = '014000'O;           /* To precord to bof        */

  15872  2 000561   000000 100400                    MLR     fill='000'O
         2 000562   000011 000002 3                  ADSC9   9                        cn=0,n=2
         2 000563   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      307    15873    1   CALL ASF$PREC_FORM(USERS_KEY);

  15873  2 000564   000004 630400 3                  EPPR0   4
         2 000565   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000566   000000 701000 xent               TSX1    ASF$PREC_FORM
         2 000567   000000 011000                    NOP     0

      308    15874    1   CALL INDEX (K, ' ', FNAME.TEXT)

  15874  2 000570   000000 124500                    SCM     mask='000'O
         2 000571   200007 200006                    ADSC9   FNAME,,AUTO              cn=1,n=6
         2 000572   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000573   200016 000100                    ARG     K,,AUTO
         2 000574   000576 606400 2                  TTN     s:15877
         2 000575   000576 710000 2                  TRA     s:15877
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:44   

      309    15875    2   WHENALTRETURN DO;

      310    15876    2      END;  /*  Whenaltreturn from index  */

      311    15877    1   IF K = 0 THEN K = 1;

  15877  2 000576   200016 235100                    LDA     K,,AUTO
         2 000577   000602 601000 2                  TNZ     s:15880

  15877  2 000600   000001 236007                    LDQ     1,DL
         2 000601   200016 756100                    STQ     K,,AUTO

      312    15878    2   DO FOREVER ;

      313    15879    3      DO UNTIL( USERS_KEY.COUNT <= 6 );

      314    15880    3         I = DSEG1SIZE;

  15880  2 000602   000000 235000 xsym               LDA     DSEG1SIZE
         2 000603   200013 755100                    STA     I,,AUTO

      315    15881    3         CALL ASF$READ_FORM_SEQ(USERS_KEY,DSEG1$,I)

  15881  2 000604   200013 630500                    EPPR0   I,,AUTO
         2 000605   200026 450500                    STP0    WILD_CARD+3,,AUTO
         2 000606   000004 237000 3                  LDAQ    4
         2 000607   200024 757100                    STAQ    WILD_CARD+1,,AUTO
         2 000610   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000611   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000612   000000 701000 xent               TSX1    ASF$READ_FORM_SEQ
         2 000613   000615 702000 2                  TSX2    s:15883
         2 000614   000626 710000 2                  TRA     s:15889

      316    15882    4         WHENALTRETURN DO;

      317    15883    4            IF MERR_CODE.CODE ~= %E$EOF
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:45   

  15883  2 000615   000000 236000 xsym               LDQ     ERR_CODE
         2 000616   377770 376007                    ANQ     131064,DL
         2 000617   000060 116007                    CMPQ    48,DL
         2 000620   000625 600000 2                  TZE     s:15887

      318    15884    5            THEN DO;

      319    15885    5               CALL ASH$ERROR(MERR_CODE);

  15885  2 000621   000007 630400 3                  EPPR0   7
         2 000622   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000623   000000 701000 xent               TSX1    ASH$ERROR
         2 000624   000000 011000                    NOP     0

      320    15886    5               END;  /*  Error no eof  */

      321    15887    4            GOTO FINISH_UP;

  15887  2 000625   000703 710000 2                  TRA     FINISH_UP

      322    15888    4            END;  /*  Whenaltreturn from ASF$READ_FORM_SEQ  */
      323    15889    3         END;  /*  Do until not form  */

  15889  2 000626   000000 236000 xsym               LDQ     USERS_KEY
         2 000627   777000 376003                    ANQ     -512,DU
         2 000630   007000 116003                    CMPQ    3584,DU
         2 000631   000602 603000 2                  TRC     s:15880

      324    15890    2      CALL INDEX (J, ' ', FS$FORMREC.FNAME)

  15890  2 000632   000000 470400 xsym               LDP0    DSEG1$
         2 000633   000000 124500                    SCM     mask='000'O
         2 000634   000000 000006                    ADSC9   0,,PR0                   cn=0,n=6
         2 000635   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000636   200014 000100                    ARG     J,,AUTO
         2 000637   000641 606400 2                  TTN     s:15893
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:46   
         2 000640   000641 710000 2                  TRA     s:15893

      325    15891    3      WHENALTRETURN DO;

      326    15892    3         END;  /*  Whenaltreturn from index  */

      327    15893    2      IF J = 0 THEN J = 1;

  15893  2 000641   200014 235100                    LDA     J,,AUTO
         2 000642   000645 601000 2                  TNZ     s:15894

  15893  2 000643   000001 236007                    LDQ     1,DL
         2 000644   200014 756100                    STQ     J,,AUTO

      328    15894    2      CALL ASB$WILD_MATCH (J, FS$FORMREC.FNAME, K, FNAME.TEXT)

  15894  2 000645   200030 452500                    STP2    WILD_CARD+5,,AUTO
         2 000646   200030 236100                    LDQ     WILD_CARD+5,,AUTO
         2 000647   000012 036000 3                  ADLQ    10
         2 000650   200027 756100                    STQ     WILD_CARD+4,,AUTO
         2 000651   200016 630500                    EPPR0   K,,AUTO
         2 000652   200026 450500                    STP0    WILD_CARD+3,,AUTO
         2 000653   000000 236000 xsym               LDQ     DSEG1$
         2 000654   200025 756100                    STQ     WILD_CARD+2,,AUTO
         2 000655   200014 631500                    EPPR1   J,,AUTO
         2 000656   200024 451500                    STP1    WILD_CARD+1,,AUTO
         2 000657   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000660   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000661   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000662   000702 702000 2                  TSX2    s:15905

      329    15895    3      WHENRETURN DO;

      330    15896    3         CALL ASL$LIST_ONE_FORMSET (OBJECT,FORM_COUNT,JCL,FORM_FLAG)

  15896  2 000663   200012 630500                    EPPR0   FORM_FLAG,,AUTO
         2 000664   200027 450500                    STP0    WILD_CARD+4,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:47   
         2 000665   200015 631500                    EPPR1   JCL,,AUTO
         2 000666   200026 451500                    STP1    WILD_CARD+3,,AUTO
         2 000667   200011 633500                    EPPR3   FORM_COUNT,,AUTO
         2 000670   200025 453500                    STP3    WILD_CARD+2,,AUTO
         2 000671   200017 634500                    EPPR4   OBJECT,,AUTO
         2 000672   200024 454500                    STP4    WILD_CARD+1,,AUTO
         2 000673   200024 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000674   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000675   000000 701000 xent               TSX1    ASL$LIST_ONE_FORMSET
         2 000676   000701 702000 2                  TSX2    s:15902

      331    15897    4         WHENRETURN DO;

      332    15898    4            DISP_FORMSETS = DISP_FORMSETS + 1;

  15898  2 000677   200006 054100                    AOS     DISP_FORMSETS,,AUTO

      333    15899    4            END;  /*  Whenreturn from ASL$LIST_ONE_FORMSET  */

  15899  2 000700   000701 710000 2                  TRA     s:15902

      334    15900    4         WHENALTRETURN DO;

      335    15901    4            END;  /*  Whenaltreturn from ASL$LIST_ONE_FORMSET  */

      336    15902    3         END;  /*  Whenreturn from ASB$WILD_MATCH  */

  15902  2 000701   000702 710000 2                  TRA     s:15905

      337    15903    3      WHENALTRETURN DO;

      338    15904    3         END;  /*  Whenaltreturn from ASB$WILD_MATCH  */

      339    15905    2      END;  /*  Do forever  */

  15905  2 000702   000602 710000 2                  TRA     s:15880

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:48   
      340    15906    1   FINISH_UP:
      341    15907    2   IF NOT DISP THEN DO;

  15907  2 000703   200005 234100       FINISH_UP    SZN     DISP,,AUTO
         2 000704   000721 604000 2                  TMI     s:15913

      342    15908    2      FMT_BUF = '%\%/';

  15908  2 000705   040000 100400                    MLR     fill='040'O
         2 000706   000017 000004 1                  ADSC9   DISPLAY_STR+6            cn=0,n=4
         2 000707   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      343    15909    2      FDS.FMT_.BOUND = 3;

  15909  2 000710   000000 236000 xsym               LDQ     FDS
         2 000711   177777 376007                    ANQ     65535,DL
         2 000712   600000 276007                    ORQ     -65536,DL
         2 000713   000000 756000 xsym               STQ     FDS

      344    15910    2      FDS.NVECS# = 0;

  15910  2 000714   000011 450000 xsym               STZ     FDS+9

      345    15911    2      CALL X$FORMAT(FDS);

  15911  2 000715   000003 630400 3                  EPPR0   3
         2 000716   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000717   000000 701000 xent               TSX1    X$FORMAT
         2 000720   000000 011000                    NOP     0

      346    15912    2      END; /*  If not disp  */

      347    15913    2   IF NOT JCL THEN DO;

  15913  2 000721   200015 234100                    SZN     JCL,,AUTO
         2 000722   001017 604000 2                  TMI     s:15946

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:49   
      348    15914    3      IF OBJECT = %FORMSET_OBJ_VAL THEN DO;

  15914  2 000723   200017 235100                    LDA     OBJECT,,AUTO
         2 000724   000020 115007                    CMPA    16,DL
         2 000725   000746 601000 2                  TNZ     s:15924

      349    15915    3         FMT_VEC(0) = VECTOR (DISP_FORMSETS);

  15915  2 000726   777640 235007                    LDA     -96,DL
         2 000727   200024 452500                    STP2    WILD_CARD+1,,AUTO
         2 000730   200024 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000731   000006 036003                    ADLQ    6,DU
         2 000732   000000 755000 xsym               STA     FMT_VEC
         2 000733   000001 756000 xsym               STQ     FMT_VEC+1

      350    15916    3         IF DISP_FORMSETS = 1 THEN

  15916  2 000734   200006 235100                    LDA     DISP_FORMSETS,,AUTO
         2 000735   000001 115007                    CMPA    1,DL
         2 000736   000743 601000 2                  TNZ     s:15921

      351    15917    4         DO;

      352    15918    4            FMT_VEC(1) = VECTOR (FORMSET_STR);

  15918  2 000737   000014 237000 3                  LDAQ    12
         2 000740   000002 755000 xsym               STA     FMT_VEC+2
         2 000741   000003 756000 xsym               STQ     FMT_VEC+3

      353    15919    4            END; /*  DISP_FORMSETS = 1  */

  15919  2 000742   000746 710000 2                  TRA     s:15924

      354    15920    4         ELSE DO;

      355    15921    4            FMT_VEC(1) = VECTOR (FORMSETS_STR);

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:50   
  15921  2 000743   000016 237000 3                  LDAQ    14
         2 000744   000002 755000 xsym               STA     FMT_VEC+2
         2 000745   000003 756000 xsym               STQ     FMT_VEC+3

      356    15922    4            END; /*  DISP_FORMSETS ~= 1  */

      357    15923    3         END; /*  Formsets  */

      358    15924    3      IF OBJECT = %FORM_OBJ_VAL THEN DO;

  15924  2 000746   200017 235100                    LDA     OBJECT,,AUTO
         2 000747   000016 115007                    CMPA    14,DL
         2 000750   000771 601000 2                  TNZ     s:15934

      359    15925    3         FMT_VEC(0) = VECTOR (FORM_COUNT);

  15925  2 000751   777640 235007                    LDA     -96,DL
         2 000752   200024 452500                    STP2    WILD_CARD+1,,AUTO
         2 000753   200024 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000754   000011 036003                    ADLQ    9,DU
         2 000755   000000 755000 xsym               STA     FMT_VEC
         2 000756   000001 756000 xsym               STQ     FMT_VEC+1

      360    15926    3         IF FORM_COUNT = 1 THEN

  15926  2 000757   200011 235100                    LDA     FORM_COUNT,,AUTO
         2 000760   000001 115007                    CMPA    1,DL
         2 000761   000766 601000 2                  TNZ     s:15931

      361    15927    4         DO;

      362    15928    4            FMT_VEC(1) = VECTOR (FORM_STR);

  15928  2 000762   000020 237000 3                  LDAQ    16
         2 000763   000002 755000 xsym               STA     FMT_VEC+2
         2 000764   000003 756000 xsym               STQ     FMT_VEC+3

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:51   
      363    15929    4            END; /*  FORM_COUNT = 1  */

  15929  2 000765   000771 710000 2                  TRA     s:15934

      364    15930    4         ELSE DO;

      365    15931    4            FMT_VEC(1) = VECTOR (FORMS_STR);

  15931  2 000766   000022 237000 3                  LDAQ    18
         2 000767   000002 755000 xsym               STA     FMT_VEC+2
         2 000770   000003 756000 xsym               STQ     FMT_VEC+3

      366    15932    4            END; /*  FORM_COUNT ~= 1  */

      367    15933    3         END; /*  Forms  */

      368    15934    2      IF DISP THEN

  15934  2 000771   200005 234100                    SZN     DISP,,AUTO
         2 000772   000777 605000 2                  TPL     s:15939

      369    15935    3      DO;

      370    15936    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15936  2 000773   000024 237000 3                  LDAQ    20
         2 000774   000004 755000 xsym               STA     FMT_VEC+4
         2 000775   000005 756000 xsym               STQ     FMT_VEC+5

      371    15937    3         END; /*  If disp  */

  15937  2 000776   001002 710000 2                  TRA     s:15941

      372    15938    3      ELSE DO;

      373    15939    3         FMT_VEC(2) = VECTOR (LIST_STR);

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:52   
  15939  2 000777   000026 237000 3                  LDAQ    22
         2 001000   000004 755000 xsym               STA     FMT_VEC+4
         2 001001   000005 756000 xsym               STQ     FMT_VEC+5

      374    15940    3         END; /*  If ~ disp  */

      375    15941    2      FDS.NVECS# = 3;

  15941  2 001002   000003 235007                    LDA     3,DL
         2 001003   000011 755000 xsym               STA     FDS+9

      376    15942    2      FMT_BUF = '   %5D %A %A.';

  15942  2 001004   040000 100400                    MLR     fill='040'O
         2 001005   000020 000015 1                  ADSC9   DISPLAY_STR+7            cn=0,n=13
         2 001006   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      377    15943    2      FDS.FMT_.BOUND = 12;

  15943  2 001007   000000 236000 xsym               LDQ     FDS
         2 001010   177777 376007                    ANQ     65535,DL
         2 001011   000003 276003                    ORQ     3,DU
         2 001012   000000 756000 xsym               STQ     FDS

      378    15944    2      CALL X$FORMAT(FDS);

  15944  2 001013   000003 630400 3                  EPPR0   3
         2 001014   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001015   000000 701000 xent               TSX1    X$FORMAT
         2 001016   000000 011000                    NOP     0

      379    15945    2      END; /* Not jcl */

      380    15946    1   RETURN;

  15946  2 001017   000000 702200 xent               TSX2  ! X66_ARET
      381    15947    1   END ASL$LIST_ALL_FORMSETS;
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:53   

PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:54   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_FORMSETS.
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:55   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_FORMSETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c CHAR(9)     r     1 DISPLAY_STR                2-0-0/c CHAR(8)     r     1 FORMSETS_STR
     0-0-0/c CHAR(7)     r     1 FORMSET_STR                5-0-0/c CHAR(5)     r     1 FORMS_STR
     4-0-0/c CHAR(4)     r     1 FORM_STR                   7-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL                        4-0-0/w UBIN        r     1 CODE2
     5-0-0/b BIT         r     1 DISP                       6-0-0/w SBIN        r     1 DISP_FORMSETS
     7-0-0/c STRC(63)    r     1 FNAME                     12-0-0/b STRC(9)     r     1 FORMFLAG
    11-0-0/w UBIN        r     1 FORM_COUNT
    12-0-0/b BIT         r     1 FORM_FLAG(0:8)
    13-0-0/w UBIN        r     1 I                         14-0-0/w UBIN        r     1 J
    15-0-0/b BIT         r     1 JCL                       16-0-0/w UBIN        r     1 K
    17-0-0/w UBIN        r     1 OBJECT                    20-0-0/c CHAR(11)    r     1 OBJECT_STR
    23-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:56   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3186)  r     1 FS$FORMREC                 0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_FORMSETS requires 528 words for executable code.
   Procedure ASL$LIST_ALL_FORMSETS requires 26 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_FORMSETS.:E05TSI    .
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:57   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:58   
          MINI XREF LISTING

ALL
     15624**DCL     15670<<ASSIGN  15681<<ASSIGN  15688<<ASSIGN  15786>>IF
ASA_BRKS_LOC
     12586**DCL     12586--REDEF
ASB$WILD_MATCH
     15460**DCL-ENT 15894--CALL
ASF$PREC_FORM
     15442**DCL-ENT 15873--CALL
ASF$READ_FORM
     15445**DCL-ENT 15795--CALL
ASF$READ_FORM_SEQ
     15448**DCL-ENT 15881--CALL
ASH$ERROR
     15451**DCL-ENT 15816--CALL    15821--CALL    15851--CALL    15885--CALL
ASL$FORM_LIST_OPTS
     15457**DCL-ENT 15829--CALL    15864--CALL
ASL$LIST_ONE_FORMSET
     15454**DCL-ENT 15833--CALL    15896--CALL
AS_DEFAULT.BANNER_PERM
     13279**DCL     13280--REDEF
AS_DEFAULT.BUDGET.MACCT
     13184**DCL     13188--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     13197**DCL     13200--REDEF
AS_DEFAULT.BUDGET.PACCUM
     13180**DCL     13182--REDEF
AS_DEFAULT.BUDGET.PMAXC
     13175**DCL     13177--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     13295**DCL     13296--REDEF   13297--REDEF
AS_DEFAULT_DREC.PASSWORD
     14549**DCL     14553--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:59   
AS_DEFAULT_DREC.RENAME
     14572**DCL     14573--REDEF
AS_DFLT.BANNER_PERM
     13101**DCL     13102--REDEF
AS_DFLT.BUDGET.MACCT
     13006**DCL     13010--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     13019**DCL     13022--REDEF
AS_DFLT.BUDGET.PACCUM
     13002**DCL     13004--REDEF
AS_DFLT.BUDGET.PMAXC
     12997**DCL     12999--REDEF
AS_DFLT.SETUP_CHRA.TXT
     13117**DCL     13118--REDEF   13119--REDEF
AS_FE_MODE
     12452**DCL     12453--REDEF
AS_FIELD1
     12582**DCL     15803<<ASSIGN  15838<<ASSIGN
AS_MODE
     12449**DCL     12451--REDEF
AS_MOD_USER.ACCESS
     15314**DCL     15315--REDEF
AS_MOD_USER.BANNER
     15301**DCL     15302--REDEF
AS_MOD_USER.BANNER_PERM
     15303**DCL     15304--REDEF
AS_MOD_USER.BILL
     15309**DCL     15310--REDEF
AS_MOD_USER.CPROC
     15305**DCL     15306--REDEF
AS_MOD_USER.FEBILL
     15385**DCL     15386--REDEF
AS_MOD_USER.FECXTMEM
     15402**DCL     15403--REDEF
AS_MOD_USER.FEMINTS
     15387**DCL     15388--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:60   
AS_MOD_USER.FEMMEM
     15398**DCL     15399--REDEF
AS_MOD_USER.FEMTIME
     15396**DCL     15397--REDEF
AS_MOD_USER.FEPPRIV
     15393**DCL     15395--REDEF
AS_MOD_USER.FEPRIV
     15390**DCL     15392--REDEF
AS_MOD_USER.FORCE_BIT
     15299**DCL     15300--REDEF
AS_MOD_USER.KEY
     15381**DCL     15383--REDEF
AS_MOD_USER.LASTCPROC
     15307**DCL     15308--REDEF
AS_MOD_USER.LIMITS.DO_
     15355**DCL     15356--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     15371**DCL     15372--REDEF
AS_MOD_USER.LIMITS.LO
     15351**DCL     15352--REDEF
AS_MOD_USER.LIMITS.MEM
     15347**DCL     15348--REDEF
AS_MOD_USER.LIMITS.MPRIO
     15375**DCL     15376--REDEF
AS_MOD_USER.LIMITS.PDIS
     15363**DCL     15364--REDEF
AS_MOD_USER.LIMITS.PO
     15359**DCL     15360--REDEF
AS_MOD_USER.LIMITS.TDIS
     15367**DCL     15368--REDEF
AS_MOD_USER.LIMITS.TIME
     15343**DCL     15344--REDEF
AS_MOD_USER.MAXENQ
     15324**DCL     15325--REDEF
AS_MOD_USER.PERM_BIT
     15297**DCL     15298--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:61   
AS_MOD_USER.PPRIV
     15319**DCL     15321--REDEF
AS_MOD_USER.PRIOB
     15326**DCL     15327--REDEF
AS_MOD_USER.PRIV
     15316**DCL     15318--REDEF
AS_MOD_USER.QUAN
     15322**DCL     15323--REDEF
AS_MOD_USER.SETUP
     15295**DCL     15296--REDEF
AS_PROJECT.BANNER_PERM
     13635**DCL     13636--REDEF
AS_PROJECT.BUDGET.MACCT
     13540**DCL     13544--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     13553**DCL     13556--REDEF
AS_PROJECT.BUDGET.PACCUM
     13536**DCL     13538--REDEF
AS_PROJECT.BUDGET.PMAXC
     13531**DCL     13533--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     13651**DCL     13652--REDEF   13653--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13813**DCL     13814--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     13718**DCL     13722--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     13731**DCL     13734--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     13714**DCL     13716--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     13709**DCL     13711--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13829**DCL     13830--REDEF   13831--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     15035**DCL     15039--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:62   
AS_PROJECT_DFLT_DREC.RENAME
     15058**DCL     15059--REDEF
AS_PROJECT_DREC.PASSWORD
     14873**DCL     14877--REDEF
AS_PROJECT_DREC.RENAME
     14896**DCL     14897--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     13457**DCL     13458--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     13362**DCL     13366--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     13375**DCL     13378--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     13358**DCL     13360--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     13353**DCL     13355--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     13473**DCL     13474--REDEF   13475--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     14711**DCL     14715--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     14734**DCL     14735--REDEF
AS_USERS.BANNER_PERM
     12923**DCL     12924--REDEF
AS_USERS.BUDGET.MACCT
     12828**DCL     12832--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12841**DCL     12844--REDEF
AS_USERS.BUDGET.PACCUM
     12824**DCL     12826--REDEF
AS_USERS.BUDGET.PMAXC
     12819**DCL     12821--REDEF
AS_USERS.SETUP_CHRA.TXT
     12939**DCL     12940--REDEF   12941--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13991**DCL     13992--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:63   
AS_USERS_CONSTANT.BUDGET.MACCT
     13896**DCL     13900--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13909**DCL     13912--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13892**DCL     13894--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13887**DCL     13889--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     14007**DCL     14008--REDEF   14009--REDEF
CODE
     12579**DCL     15664<<ASSIGN  15675>>DOSELCT
CODE2
     15625**DCL     15717<<ASSIGN  15719>>DOSELCT 15748<<ASSIGN  15750>>DOSELCT
DISP
     15626**DCL     15679<<ASSIGN  15687<<ASSIGN  15704<<ASSIGN  15714<<ASSIGN  15735<<ASSIGN  15745<<ASSIGN
     15825>>IF      15860>>IF      15907>>IF      15934>>IF
DISPLAY_STR
     15659**DCL     15936--ASSIGN
DISP_FORMSETS
     15627**DCL     15669<<ASSIGN  15856<<ASSIGN  15898<<ASSIGN  15898>>ASSIGN  15915--ASSIGN  15916>>IF
DSEG1$
     12587**DCL     15477--IMP-PTR 15795<>CALL    15881<>CALL    15890>>CALLBLT 15894>>CALL
DSEG1SIZE
     12588**DCL     15794>>ASSIGN  15880>>ASSIGN
ERR_CODE
     12581**DCL     12582--REDEF
FDS
     12478**DCL     15784<>CALL    15911<>CALL    15944<>CALL
FDS.FMT_.BOUND
     12483**DCL     15777<<ASSIGN  15781<<ASSIGN  15909<<ASSIGN  15943<<ASSIGN
FDS.NVECS#
     12506**DCL     15772<<ASSIGN  15910<<ASSIGN  15941<<ASSIGN
FDS.TABDFLT#
     12544**DCL     15783<<ASSIGN
FINISH_UP
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:64   
     15907**LABEL   15857--GOTO    15887--GOTO
FMT_BUF
     12577**DCL     15776<<CALLBLT 15780<<CALLBLT 15908<<ASSIGN  15942<<ASSIGN
FMT_VEC
     12577**DCL     15915<<ASSIGN  15918<<ASSIGN  15921<<ASSIGN  15925<<ASSIGN  15928<<ASSIGN  15931<<ASSIGN
     15936<<ASSIGN  15939<<ASSIGN
FNAME
     15628**DCL     15788>>ASSIGN  15803>>ASSIGN  15838>>ASSIGN
FNAME.COUNT
     15629**DCL     15668<<ASSIGN  15709<<ASSIGN  15724<<ASSIGN  15740<<ASSIGN  15755<<ASSIGN
FNAME.TEXT
     15630**DCL     15667<<ASSIGN  15708<<ASSIGN  15723<<ASSIGN  15739<<ASSIGN  15754<<ASSIGN  15789>>CALLBLT
     15874>>CALLBLT 15894<>CALL
FORMFLAG
     15633**DCL     15673<<ASSIGN  15827<<ASSIGN  15827>>ASSIGN  15832<<ASSIGN  15832>>ASSIGN  15862<<ASSIGN
     15862>>ASSIGN  15867<<ASSIGN  15867>>ASSIGN  15868>>IF
FORMFLAG.JUSTNAM
     15640**DCL     15870<<ASSIGN
FORMSETS_STR
     15655**DCL     15770>>ASSIGN  15774>>ASSIGN  15921--ASSIGN
FORMSET_STR
     15654**DCL     15918--ASSIGN
FORMS_STR
     15657**DCL     15768>>ASSIGN  15931--ASSIGN
FORM_COUNT
     15631**DCL     15671<<ASSIGN  15833<>CALL    15896<>CALL    15925--ASSIGN  15926>>IF
FORM_FLAG
     15632**DCL     15633--REDEF   15829<>CALL    15833<>CALL    15864<>CALL    15896<>CALL
FORM_STR
     15656**DCL     15928--ASSIGN
FS$FORMREC.CHAINS
     15525**DCL     15535--REDEF
FS$FORMREC.FNAME
     15478**DCL     15890>>CALLBLT 15894<>CALL
I
     15643**DCL     15716<<DOINDEX 15717>>ASSIGN  15747<<DOINDEX 15748>>ASSIGN  15789<<CALLBLT 15794<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:65   
     15795<>CALL    15880<<ASSIGN  15881<>CALL
J
     15644**DCL     15890<<CALLBLT 15893>>IF      15893<<ASSIGN  15894<>CALL
JCL
     15645**DCL     15665<<ASSIGN  15680<<ASSIGN  15690<<ASSIGN  15695<<ASSIGN  15698<<ASSIGN  15705<<ASSIGN
     15728<<ASSIGN  15736<<ASSIGN  15759<<ASSIGN  15773>>IF      15826>>IF      15833<>CALL    15861>>IF
     15896<>CALL    15913>>IF
K
     15646**DCL     15874<<CALLBLT 15877>>IF      15877<<ASSIGN  15894<>CALL
KL_DEFAULT.PASSWORD
     15197**DCL     15201--REDEF
KL_DEFAULT.RENAME
     15220**DCL     15221--REDEF
KL_DFLT.PASSWORD
     14387**DCL     14391--REDEF
KL_DFLT.RENAME
     14410**DCL     14411--REDEF
KL_DREC.PASSWORD
     14225**DCL     14229--REDEF
KL_DREC.RENAME
     14248**DCL     14249--REDEF
KL_DREC_CNT.PASSWORD
     14112**DCL     14116--REDEF
KL_DREC_CNT.RENAME
     14135**DCL     14136--REDEF
LIST_STR
     15658**DCL     15939--ASSIGN
MERR_CODE
     12582**DCL     15821<>CALL    15885<>CALL
MERR_CODE.CODE
     12582**DCL     15797>>IF      15883>>IF
NODE$
     12579**DCL     15544--IMP-PTR
OBJECT
     15647**DCL     15672<<ASSIGN  15683<<ASSIGN  15691<<ASSIGN  15697<<ASSIGN  15706<<ASSIGN  15715<<ASSIGN
     15737<<ASSIGN  15746<<ASSIGN  15767>>IF      15775<<ASSIGN  15833<>CALL    15856>>IF      15896<>CALL
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:66   
     15914>>IF      15924>>IF
OBJECT_STR
     15648**DCL     15768<<ASSIGN  15770<<ASSIGN  15774<<ASSIGN  15776>>CALLBLT 15777--ASSIGN  15780>>CALLBLT
     15781--ASSIGN
P$B.CODE
     15552**DCL     15664>>ASSIGN  15683>>ASSIGN  15690>>ASSIGN  15691>>ASSIGN  15694>>IF      15697>>ASSIGN
     15717>>ASSIGN  15748>>ASSIGN
P$B.NSUBLKS
     15556**DCL     15682>>IF      15689>>IF      15693>>IF      15707>>IF      15716>>DOINDEX 15738>>IF
     15747>>DOINDEX
P$B.SUBLK$
     15577**DCL     15664>>ASSIGN  15682>>IF      15683>>ASSIGN  15683>>ASSIGN  15689>>IF      15690>>ASSIGN
     15690>>ASSIGN  15691>>ASSIGN  15691>>ASSIGN  15693>>IF      15694>>IF      15694>>IF      15697>>ASSIGN
     15697>>ASSIGN  15708>>ASSIGN  15708>>ASSIGN  15709>>ASSIGN  15717>>ASSIGN  15723>>ASSIGN  15723>>ASSIGN
     15724>>ASSIGN  15739>>ASSIGN  15739>>ASSIGN  15740>>ASSIGN  15748>>ASSIGN  15754>>ASSIGN  15754>>ASSIGN
     15755>>ASSIGN
P$S.COUNT
     15613**DCL     15616--IMP-SIZ 15708>>ASSIGN  15709>>ASSIGN  15723>>ASSIGN  15724>>ASSIGN  15739>>ASSIGN
     15740>>ASSIGN  15754>>ASSIGN  15755>>ASSIGN
P$S.TEXT
     15616**DCL     15708>>ASSIGN  15723>>ASSIGN  15739>>ASSIGN  15754>>ASSIGN
PROJ_KEY.TEXT
     12459**DCL     12459--REDEF
PROJ_KEY.TXT.PROJECT
     12459**DCL     12459--REDEF
P_PCB.OUT$
     12627**DCL     15664>>ASSIGN  15682>>IF      15683>>ASSIGN  15689>>IF      15690>>ASSIGN  15691>>ASSIGN
     15693>>IF      15694>>IF      15697>>ASSIGN  15707>>IF      15708>>ASSIGN  15708>>ASSIGN  15709>>ASSIGN
     15716>>DOINDEX 15717>>ASSIGN  15723>>ASSIGN  15723>>ASSIGN  15724>>ASSIGN  15738>>IF      15739>>ASSIGN
     15739>>ASSIGN  15740>>ASSIGN  15747>>DOINDEX 15748>>ASSIGN  15754>>ASSIGN  15754>>ASSIGN  15755>>ASSIGN
REMEM_VAR
     12585**DCL     12585--REDEF
REM_FCMD
     12585**DCL     12586--REDEF
USERS_KEY
     12456**DCL     15788<<ASSIGN  15795<>CALL    15872<<ASSIGN  15873<>CALL    15881<>CALL
PL6.E3A0      #001=ASL$LIST_ALL_FORMSETS File=ASL$LIST_FORMSETS.:E05TSI          TUE 07/29/97 10:09 Page:67   
USERS_KEY.COUNT
     12456**DCL     15793<<ASSIGN  15879>>DOUNTIL
USERS_KEY.TEXT
     12456**DCL     12457--REDEF   12457--REDEF   12457--REDEF   12458--REDEF
WILD_CARD
     15649**DCL     15666<<ASSIGN
X$FORMAT
     15462**DCL-ENT 15784--CALL    15911--CALL    15944--CALL
