VERSION E05

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:2
                                     1  *M* X6A - PL6 run-time routine for L6 users
                                     2  *T***********************************************************
                                     3  *T*                                                         *
                                     4  *T* Copyright (c) Bull HN Information Systems Inc., 1997    *
                                     5  *T*                                                         *
                                     6  *T***********************************************************
                                     7  *
                                     8  *D* For a description of auto storage layout, see GH_LCP6_M.
                                     9  *
                                    10  *
                                    11  * Defs
                                    12  *
                                    13           ENTDEF    X6A_MAUTO,X6A_MSTATIC
                                    14           ENTDEF    X6A_AAUTO,X6A_ASTATIC
                                    15           ENTDEF    X6A_MARET,X6A_MSRET
                                    16           ENTDEF    X6A_AARET,X6A_ASRET
                                    17           ENTDEF    X6A_MAALT,X6A_MSALT
                                    18           ENTDEF    X6A_AAALT,X6A_ASALT
                                    19           ENTDEF    X6A_MAUNWIND,X6A_MSUNWIND
                                    20           ENTDEF    X6A_AAUNWIND,X6A_ASUNWIND
                                    21           ENTDEF    X6A_AUNWIND,X6A_SUNWIND
                                    22           ENTDEF    X6A_INTRET,X6A_TRTN,X6A_MERCS
                                    23           ENTDEF    X6A@
                                    24           ENTDEF    X6A_AUTO_0,X6A_STATIC_0
                                    25           ENTDEF    X6A_AUTO_1,X6A_STATIC_1
                                    26           ENTDEF    X6A_AUTO_2,X6A_STATIC_2
                                    27           ENTDEF    X6A_AUTO_3,X6A_STATIC_3
                                    28           ENTDEF    X6A_AUTO_N,X6A_STATIC_N
                                    29           ENTDEF    X6A_ARET,X6A_FARET
                                    30           ENTDEF    X6A_AALT
                                    31           ENTDEF    X6B_BCM
                                    32           ENTDEF    X6B_BLR
                                    33           ENTDEF    X6C_ACMZ
                                    34           ENTDEF    X6C_ACM
                                    35           ENTDEF    X6C_ALRZ
                                    36           ENTDEF    X6C_ALR
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:3
                                    37           ENTDEF    X6C_MAT
                                    38           ENTDEF    X6C_SRCH
                                    39           ENTDEF    X6D_MID
                                    40           SYMREF    G$JIT$
                                    41           SYMREF    G$AUTO_DS$
                                    42           SYMREF    G$AUTO_T$
                                    43  *
                                    44  *
                                    45  *        Offsets from G$AUTO_DS$ for the segment header data
         00000002                   46  BOT_FR$  EQU       2
         00000004                   47  AUTO_TYPE EQU      4
         00000005                   48  TEMP     EQU       5
         00000010                   49  BOT_FR   EQU       16
                                    50  *
         00000800                   51  GET_1ST  EQU       2048      # words to get first time
         00000100                   52  GET_1ST1 EQU       256       # words if 1 page
         00000002                   53  RETDISP  EQU       2         # words following calls to X6A_?_?
                                    54  *
         00000000                   55  FR_RET   EQU       0         displ to return address in frame
         00000002                   56  FR_TYPE  EQU       2         displ to TYPE field in frame
         00000004                   57  FR_PARM1 EQU       4         displ to first PARM in frame
         FFFFFFFF                   58  CUR_FR_SIZ EQU     -1        size of frame (not in frame)
         00000003                   59  PREV_FR_SIZ EQU    3         displ to size of previous frame
                                    60  *
         00000904                   61  MGAUTO   EQU       '904'X
         00000905                   62  MFAUTO   EQU       '905'X
         00000080                   63  MEXIT    EQU       '80'X
         00000081                   64  MERR     EQU       '81'X
         00000082                   65  MXXX     EQU       '82'X
         00000040                   66  MINTRET  EQU       '40'X
         00000440                   67  MINTRETF EQU       '440'X
         000000CC                   68  MTRTN    EQU       'CC'X
         000008CC                   69  MTRTNF   EQU       '8CC'X
         000000CE                   70  MMERCS   EQU       'CE'X
         000004CE                   71  MMERCSF  EQU       '4CE'X
         000000C9                   72  MMERC    EQU       'C9'X
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:4
         00001543                   73  MWRITE   EQU       '1543'X

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:5
                                    74           EJECT
         000000(0)                  75  X6A@    SECT       PROC
                                    76  *
                                    77  *
                                    78  *
         000000(0)                  79  X6A_ARET ALIGN
         000000(0)                  80  X6A_FARET ALIGN
 00000   EC87                       81           LDB,B6    ,B7                 return address
 00001   B847 0003                  82           LDR,R3    PREV_FR_SIZ,B7
 00003   0010 0037                  83           ACQ,R3    B7                  This ACQ releases a frame
 00005   83C6 0001                  84           JMP       1,B6                Skip altret word
                                    85  *
                                    86  *
                                    87  *
         000007(0)                  88  X6A_AALT ALIGN
 00007   EC87                       89           LDB,B6    ,B7
 00008   B847 0003                  90           LDR,R3    PREV_FR_SIZ,B7
 0000A   0010 0037                  91           ACQ,R3    B7
 0000C   B806                       92           LDR,R3    ,B6                 PREL offset to alt
 0000D   83B6                       93           JMP       ,B6,R3

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:6
                                    94           EJECT
                                    95  *
                                    96  *
         00000E(0)                  97  ALOC0    ALIGN
 0000E   93C0 00B9                  98           LNJ,B1    EXT_AUTO,PREL
 00010   0F8C                       99           B         ALOCED0,SPREL
                                   100  *
         000011(0)                 101  X6A_AUTO_0 ALIGN
                                   102  *
 00011   B847 FFFF                 103           LDR,R3    CUR_FR_SIZ,B7
 00013   9805                      104           LDR,R1    ,B5                 # words in frame
 00014   9F37                      105           STR,R1    ,B7,R3              so next get (RLQ) works
 00015   0010 0007                 106           RLQ       B7                  get a frame???
 00017   AB97                      107           LAB,B2    ,B7,R1
 00018   AD80 000000(2)s           108           CMB,B2    G$AUTO_T$           Enough space?
 0001B   02F3                      109           BGE       ALOC0,SPREL
         00001C(0)                 110  ALOCED0  ALIGN
 0001C   BF47 0003                 111           STR,R3    PREV_FR_SIZ,B7      so release (ACQ) works
 0001E   EF87                      112           STB,B6    ,B7                 RET_ADDR
 0001F   8747 0002                 113           CL        FR_TYPE,B7          callable
 00021   83C5 0002                 114           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:7
                                   115           EJECT
                                   116  *
                                   117  *
         000023(0)                 118  ALOC1    ALIGN
 00023   93C0 00A4                 119           LNJ,B1    EXT_AUTO,PREL
 00025   0F8C                      120           B         ALOCED1,SPREL
                                   121  *
         000026(0)                 122  X6A_AUTO_1 ALIGN
                                   123  *
 00026   B847 FFFF                 124           LDR,R3    CUR_FR_SIZ,B7
 00028   9805                      125           LDR,R1    ,B5                 # words in frame
 00029   9F37                      126           STR,R1    ,B7,R3              so next get (RLQ) works
 0002A   0010 0007                 127           RLQ       B7                  get a frame???
 0002C   AB97                      128           LAB,B2    ,B7,R1
 0002D   AD80 000000(2)s           129           CMB,B2    G$AUTO_T$           Enough space?
 00030   02F3                      130           BGE       ALOC1,SPREL
         000031(0)                 131  ALOCED1  ALIGN
 00031   BF47 0003                 132           STR,R3    PREV_FR_SIZ,B7      so release (ACQ) works
 00033   EF87                      133           STB,B6    ,B7                 RET_ADDR
 00034   8747 0002                 134           CL        FR_TYPE,B7          callable
 00036   C284                      135           LLH,R4    ,B4
 00037   4D01                      136           CMV,R4    1
 00038   0206                      137           BL        NA1,SPREL
 00039   8C83                      138           LDI       ,B3                 Move PTR
 0003A   8D47 0004                 139           SDI       FR_PARM1,B7
 0003C   83C5 0002                 140           JMP       RETDISP,B5
                                   141  *
         00003E(0)                 142  NA1      ALIGN
 0003E   9B80 000000               143           LAB,B1    0
 00041   9FC7 0004                 144           STB,B1    FR_PARM1,B7
 00043   83C5 0002                 145           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:8
                                   146           EJECT
                                   147  *
                                   148  *
         000045(0)                 149  ALOC2    ALIGN
 00045   93C0 0082                 150           LNJ,B1    EXT_AUTO,PREL
 00047   0F8C                      151           B         ALOCED2,SPREL
                                   152  *
         000048(0)                 153  X6A_AUTO_2 ALIGN
                                   154  *
 00048   B847 FFFF                 155           LDR,R3    CUR_FR_SIZ,B7
 0004A   9805                      156           LDR,R1    ,B5                 # words in frame
 0004B   9F37                      157           STR,R1    ,B7,R3              so next get (RLQ) works
 0004C   0010 0007                 158           RLQ       B7                  get a frame???
 0004E   AB97                      159           LAB,B2    ,B7,R1
 0004F   AD80 000000(2)s           160           CMB,B2    G$AUTO_T$           Enough space?
 00052   02F3                      161           BGE       ALOC2,SPREL
         000053(0)                 162  ALOCED2  ALIGN
 00053   BF47 0003                 163           STR,R3    PREV_FR_SIZ,B7      so release (ACQ) works
 00055   EF87                      164           STB,B6    ,B7                 RET_ADDR
 00056   8747 0002                 165           CL        FR_TYPE,B7          callable
 00058   C284                      166           LLH,R4    ,B4
 00059   4D01                      167           CMV,R4    1
 0005A   038A                      168           BLE       NA2,SPREL
 0005B   8CC3 0002                 169           LDI       2,B3
 0005D   8D47 0006                 170           SDI       FR_PARM1+2,B7
         00005F(0)                 171  A21      ALIGN
 0005F   8C83                      172           LDI       ,B3
 00060   8D47 0004                 173           SDI       FR_PARM1,B7
 00062   83C5 0002                 174           JMP       RETDISP,B5
         000064(0)                 175  NA2      ALIGN
 00064   9B80 000000               176           LAB,B1    0
 00067   9FC7 0006                 177           STB,B1    FR_PARM1+2,B7
 00069   0976                      178           BE        A21,SPREL
 0006A   9FC7 0004                 179           STB,B1    FR_PARM1,B7
 0006C   83C5 0002                 180           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:9
                                   181           EJECT
                                   182  *
                                   183  *
         00006E(0)                 184  ALOC3    ALIGN
 0006E   93C0 0059                 185           LNJ,B1    EXT_AUTO,PREL
 00070   0F8C                      186           B         ALOCED3,SPREL
                                   187  *
         000071(0)                 188  X6A_AUTO_3 ALIGN
                                   189  *
 00071   B847 FFFF                 190           LDR,R3    CUR_FR_SIZ,B7
 00073   9805                      191           LDR,R1    ,B5                 # words in frame
 00074   9F37                      192           STR,R1    ,B7,R3              so next get (RLQ) works
 00075   0010 0007                 193           RLQ       B7                  get a frame???
 00077   AB97                      194           LAB,B2    ,B7,R1
 00078   AD80 000000(2)s           195           CMB,B2    G$AUTO_T$           Enough space?
 0007B   02F3                      196           BGE       ALOC3,SPREL
         00007C(0)                 197  ALOCED3  ALIGN
 0007C   BF47 0003                 198           STR,R3    PREV_FR_SIZ,B7      so release (ACQ) works
 0007E   EF87                      199           STB,B6    ,B7                 RET_ADDR
 0007F   8747 0002                 200           CL        FR_TYPE,B7          callable
 00081   C284                      201           LLH,R4    ,B4
 00082   4D02                      202           CMV,R4    2
 00083   038E                      203           BLE       NA3,SPREL
 00084   8CC3 0004                 204           LDI       4,B3
 00086   8D47 0008                 205           SDI       FR_PARM1+4,B7
         000088(0)                 206  A32      ALIGN
 00088   8CC3 0002                 207           LDI       2,B3
 0008A   8D47 0006                 208           SDI       FR_PARM1+2,B7
         00008C(0)                 209  A31      ALIGN
 0008C   8C83                      210           LDI       ,B3
 0008D   8D47 0004                 211           SDI       FR_PARM1,B7
 0008F   83C5 0002                 212           JMP       RETDISP,B5
         000091(0)                 213  NA3      ALIGN
 00091   9B80 000000               214           LAB,B1    0
 00094   9FC7 0008                 215           STB,B1    FR_PARM1+4,B7
 00096   0972                      216           BE        A32,SPREL
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:10
 00097   9FC7 0006                 217           STB,B1    FR_PARM1+2,B7
 00099   49F3                      218           BNEZ,R4   A31,SPREL
 0009A   9FC7 0004                 219           STB,B1    FR_PARM1,B7
 0009C   83C5 0002                 220           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:11
                                   221           EJECT
                                   222  *
                                   223  *
         00009E(0)                 224  ALOCN    ALIGN
 0009E   93C0 0029                 225           LNJ,B1    EXT_AUTO,PREL
 000A0   0F8C                      226           B         ALOCEDN,SPREL
                                   227  *
         0000A1(0)                 228  X6A_AUTO_N ALIGN
                                   229  *
 000A1   B847 FFFF                 230           LDR,R3    CUR_FR_SIZ,B7
 000A3   9805                      231           LDR,R1    ,B5                 # words in frame
 000A4   9F37                      232           STR,R1    ,B7,R3              so next get (RLQ) works
 000A5   0010 0007                 233           RLQ       B7                  get a frame???
 000A7   AB97                      234           LAB,B2    ,B7,R1
 000A8   AD80 000000(2)s           235           CMB,B2    G$AUTO_T$           Enough space?
 000AB   02F3                      236           BGE       ALOCN,SPREL
         0000AC(0)                 237  ALOCEDN  ALIGN
 000AC   BF47 0003                 238           STR,R3    PREV_FR_SIZ,B7      so release (ACQ) works
 000AE   EF87                      239           STB,B6    ,B7                 RET_ADDR
 000AF   8747 0002                 240           CL        FR_TYPE,B7          callable
                                   241  *
 000B1   ABC7 0004                 242           LAB,B2    FR_PARM1,B7
 000B3   C284                      243           LLH,R4    ,B4                 # args passed
 000B4   B845 0001                 244           LDR,R3    1,B5                # args expected
 000B6   9853                      245           LDR,R1    R3
 000B7   88D1                      246           DEC       R1                  index to last
 000B8   B954                      247           CMR,R3    R4
 000B9   038A                      248           BLE       ARGSOK,SPREL        passed >= expected
                                   249  *
 000BA   A851                      250           LDR,R2    R1
 000BB   A254                      251           SUB,R2    R4                  # nils -1
 000BC   9B80 000000               252           LAB,B1    0
         0000BF(0)                 253  NULLN    ALIGN
 000BF   9F92                      254           STB,B1    ,B2,R1
 000C0   88D1                      255           DEC       R1
 000C1   277E                      256           BDEC,R2   NULLN,SPREL
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:12
                                   257  *
 000C2   1804                      258           BLZ,R1    RET,SPREL           ret if none passed
                                   259  *
         0000C3(0)                 260  ARGSOK   ALIGN                         /*move those passed*/
 000C3   8C93                      261           LDI       ,B3,R1
 000C4   8D12                      262           SDI       ,B2,R1
 000C5   177E                      263           BDEC,R1   ARGSOK,SPREL
                                   264  *
         0000C6(0)                 265  RET      ALIGN
 000C6   83C5 0002                 266           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:13
                                   267           EJECT
                                   268  *
                                   269  *
         0000C8(0)                 270  EXT_AUTO ALIGN
 000C8   AC80 000000(1)s           271           LDB,B2    G$AUTO_DS$
 000CB   8F42 0005 005E            272           SAVE,'005E'X TEMP,B2     B6,B5,B4,B3,B1
 000CE   AC82                      273           LDB,B2    ,B2            Save R3 in the old stack CWs
 000CF   BF42 0002                 274           STR,R3    2,B2
 000D1   BBC0 0165                 275           LAB,B3    GAUTO,PREL
 000D3   B870 0904                 276           LDR,R3    MGAUTO,IMO
 000D5   0001                      277           MCL
 000D6   001D                      278  HERE     DATA      NOMEM-HERE
 000D7   9C80 000000(1)s           279           LDB,B1    G$AUTO_DS$
 000DA   AC81                      280           LDB,B2    ,B1            Old stack CWs
 000DB   B842 0002                 281           LDR,R3    2,B2
 000DD   8C82                      282           LDI       ,B2
 000DE   ABC2 0100                 283           LAB,B2    256,B2
 000E0   AF81                      284           STB,B2    ,B1
 000E1   8470 01000100             285           AID       256+256*65536,IMO
 000E4   8D02                      286           SDI       ,B2
 000E5   A841 0006                 287           LDR,R2    TEMP+1,B1 Hidden here for ASYNC
 000E7   8FC1 0005 005E            288           RSTR,'005E'X TEMP,B1          B6,B5,B4,B3,B1
 000EA   0010 0020                 289           LDT       B2
 000EC   9805                      290           LDR,R1    ,B5
 000ED   AB97                      291           LAB,B2    ,B7,R1
 000EE   AD80 000000(2)s           292           CMB,B2    G$AUTO_T$
 000F1   02D7                      293           BGE       EXT_AUTO,SPREL
 000F2   8381                      294           JMP       ,B1

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:14
                                   295           EJECT
         0000F3(0)                 296  NOMEM    ALIGN
 000F3   9C80 000000(0)s           297           LDB,B1    G$JIT$
 000F6   92C1 0004                 298           LLH,R1    4,B1
 000F8   1D01                      299           CMV,R1    1
 000F9   0987                      300           BNE       JUSTMERC,SPREL
 000FA   B870 1543                 301           LDR,R3    MWRITE,IMO
 000FC   BBC0 0152                 302           LAB,B3    WRITE,PREL
 000FE   0001                      303           MCL
 000FF   0001                      304           DATA      1
 00100   B870 00C9                 305  JUSTMERC LDR,R3    MMERC,IMO
 00102   0001                      306           MCL

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:15
                                   307           EJECT
                                   308  *
         000103(0)                 309  X6A_STATIC_0 ALIGN
                                   310  *
 00103   AC85                      311           LDB,B2    ,B5
 00104   EF82                      312           STB,B6    ,B2
 00105   8742 0002                 313           CL        FR_TYPE,B2
 00107   83C5 0002                 314           JMP       RETDISP,B5
                                   315  *
                                   316  *
         000109(0)                 317  X6A_STATIC_1 ALIGN
                                   318  *
 00109   AC85                      319           LDB,B2    ,B5
 0010A   EF82                      320           STB,B6    ,B2
 0010B   8742 0002                 321           CL        FR_TYPE,B2
 0010D   C284                      322           LLH,R4    ,B4
 0010E   4906                      323           BEZ,R4    NS1,SPREL
 0010F   8C83                      324           LDI       ,B3
 00110   8D42 0004                 325           SDI      FR_PARM1,B2
 00112   83C5 0002                 326           JMP       RETDISP,B5
         000114(0)                 327  NS1      ALIGN
 00114   9B80 000000               328           LAB,B1    0
 00117   9FC2 0004                 329           STB,B1   FR_PARM1,B2
 00119   83C5 0002                 330           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:16
                                   331           EJECT
                                   332  *
                                   333  *
         00011B(0)                 334  X6A_STATIC_2 ALIGN
                                   335  *
 0011B   AC85                      336           LDB,B2    ,B5
 0011C   EF82                      337           STB,B6    ,B2
 0011D   8742 0002                 338           CL        FR_TYPE,B2
 0011F   C284                      339           LLH,R4    ,B4
 00120   4D01                      340           CMV,R4    1
 00121   038A                      341           BLE       NS2,SPREL
 00122   8CC3 0002                 342           LDI       2,B3
 00124   8D42 0006                 343           SDI      FR_PARM1+2,B2
         000126(0)                 344  S21      ALIGN
 00126   8C83                      345           LDI       ,B3
 00127   8D42 0004                 346           SDI      FR_PARM1,B2
 00129   83C5 0002                 347           JMP       RETDISP,B5
         00012B(0)                 348  NS2      ALIGN
 0012B   9B80 000000               349           LAB,B1    0
 0012E   9FC2 0006                 350           STB,B1   FR_PARM1+2,B2
 00130   0976                      351           BE        S21,SPREL
 00131   9FC2 0004                 352           STB,B1   FR_PARM1,B2
 00133   83C5 0002                 353           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:17
                                   354           EJECT
                                   355  *
                                   356  *
         000135(0)                 357  X6A_STATIC_3 ALIGN
                                   358  *
 00135   AC85                      359           LDB,B2    ,B5
 00136   EF82                      360           STB,B6    ,B2
 00137   8742 0002                 361           CL        FR_TYPE,B2
 00139   C284                      362           LLH,R4    ,B4
 0013A   4D02                      363           CMV,R4    2
 0013B   038E                      364           BLE       NS3,SPREL
 0013C   8CC3 0004                 365           LDI       4,B3
 0013E   8D42 0008                 366           SDI      FR_PARM1+4,B2
         000140(0)                 367  S32      ALIGN
 00140   8CC3 0002                 368           LDI       2,B3
 00142   8D42 0006                 369           SDI      FR_PARM1+2,B2
         000144(0)                 370  S31      ALIGN
 00144   8C83                      371           LDI       ,B3
 00145   8D42 0004                 372           SDI      FR_PARM1,B2
 00147   83C5 0002                 373           JMP       RETDISP,B5
         000149(0)                 374  NS3      ALIGN
 00149   9B80 000000               375           LAB,B1    0
 0014C   9FC2 0008                 376           STB,B1   FR_PARM1+4,B2
 0014E   0972                      377           BE        S32,SPREL
 0014F   9FC2 0006                 378           STB,B1   FR_PARM1+2,B2
 00151   49F3                      379           BNEZ,R4   S31,SPREL
 00152   9FC2 0004                 380           STB,B1   FR_PARM1,B2
 00154   83C5 0002                 381           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:18
                                   382           EJECT
                                   383  *
                                   384  *
         000156(0)                 385  X6A_STATIC_N ALIGN
                                   386  *
 00156   AC85                      387           LDB,B2    ,B5
 00157   EF82                      388           STB,B6    ,B2
 00158   8742 0002                 389           CL        FR_TYPE,B2
 0015A   ABC2 0004                 390           LAB,B2   FR_PARM1,B2
 0015C   C284                      391           LLH,R4    ,B4
 0015D   B845 0003                 392           LDR,R3    3,B5
 0015F   B954                      393           CMR,R3    R4
 00160   0389                      394           BLE       SN2,SPREL
 00161   9B80 000000               395           LAB,B1    0
 00164   C253                      396           SUB,R4    R3
 00165   8254                      397           NEG       R4
 00166   0F88                      398           B         NSN2,SPREL
         000167(0)                 399  SN1      ALIGN
 00167   8CB3                      400           LDI       ,B3,R3
 00168   8D32                      401           SDI       ,B2,R3
         000169(0)                 402  SN2      ALIGN
 00169   377E                      403           BDEC,R3   SN1,SPREL
 0016A   83C5 0002                 404           JMP       RETDISP,B5
         00016C(0)                 405  NSN1     ALIGN
 0016C   9FB2                      406           STB,B1    ,B2,R3
 0016D   477C                      407           BDEC,R4   SN2,SPREL
         00016E(0)                 408  NSN2     ALIGN
 0016E   377E                      409           BDEC,R3   NSN1,SPREL
 0016F   83C5 0002                 410           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:19
                                   411           EJECT
                                   412  *
                                   413  *
                                   414  *
         000171(0)                 415  X6A@     ALIGN
         000171(0)                 416  X6A_MAUTO ALIGN
 00171   FCD5                      417           LDB,B7    B5              Save return
 00172   BBC0 00CC                 418           LAB,B3    FAUTO,PREL          free it all
 00174   B870 0905                 419           LDR,R3    MFAUTO,IMO
 00176   0001                      420           MCL
 00177   0001                      421           DATA      1
 00178   BBC0 00CE                 422           LAB,B3    GAUTOM,PREL         get first chunk (handler)
 0017A   CC80 000000(0)s           423           LDB,B4    G$JIT$
 0017D   B2C4 0004                 424           LLH,R3    4,B4                JIT.MODE
 0017F   3D03                      425           CMV,R3    3                   HANDLER
 00180   0903                      426           BE        GETHND,SPREL        YES
         000181(0)                 427  NOTHND   ALIGN
 00181   BBC0 00B5                 428           LAB,B3    GAUTO,PREL          get first chunk (non handler)
         000183(0)                 429  GETHND   ALIGN
 00183   B870 0904                 430           LDR,R3    MGAUTO,IMO
 00185   0001                      431           MCL
 00186   FF6D                      432  HERE2    DATA      NOMEM-HERE2     ABORT IF ALTRETURN
 00187   B807                      433           LDR,R3    ,B7                 frame size
         000188(0)                 434  INITSTK  ALIGN
 00188   BC80 000000(2)s           435           LDB,B3    G$AUTO_T$           init stack head (non handler)
 0018B   AC80 000000(1)s           436           LDB,B2    G$AUTO_DS$
 0018E   F800 000001(2)s           437           LDR,R7    G$AUTO_T$+1         compute the size
 00191   F200 000001(1)s           438           SUB,R7    G$AUTO_DS$+1
 00194   7EF3                      439           ADV,R7    -13
 00195   E857                      440           LDR,R6    R7
 00196   6EFE                      441           ADV,R6    -2
 00197   8D03                      442           SDI       ,B3                 store the stack header
 00198   84D7                      443           SID       R7                  zap the next 4 words
 00199   8D43 0002                 444           SDI       2,B3
 0019B   8D43 0004                 445           SDI       4,B3
 0019D   DCD7                      446           LDB,B5    B7                  return address
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:20
 0019E   0010 0030                 447           LDT       B3                  init T Reg
 001A0   BF82                      448           STB,B3    ,B2                 init base of stack
 001A1   FBC2 0010                 449           LAB,B7    BOT_FR,B2
 001A3   FFC2 0002                 450           STB,B7    BOT_FR$,B2
 001A5   2C01                      451           LDV,R2    1
 001A6   AF42 0004                 452           STR,R2    AUTO_TYPE,B2
 001A8   DF87                      453           STB,B5    ,B7
 001A9   8947 0002 FFFF            454           LBT,'FFFF'X FR_TYPE,B7
 001AC   BF47 FFFF                 455           STR,R3    CUR_FR_SIZ,B7       init first frame
 001AE   8747 0003                 456           CL        PREV_FR_SIZ,B7
 001B0   B903                      457           CMR,R3    ,B3
 001B1   0283                      458           BGE       ALOCM,SPREL         not big enough
 001B2   83C5 0002                 459           JMP       RETDISP,B5
         0001B4(0)                 460  ALOCM    ALIGN
 001B4   DFD7                      461           STB,B5    B7
 001B5   0FCC                      462           B         NOTHND,SPREL

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:21
                                   463           EJECT
                                   464  *
                                   465  *
                                   466  *
         0001B6(0)                 467  X6A_MSTATIC ALIGN
 001B6   FCD5                      468           LDB,B7    B5              Save return
 001B7   BBC0 0087                 469           LAB,B3    FAUTO,PREL          free it all
 001B9   B870 0905                 470           LDR,R3    MFAUTO,IMO
 001BB   0001                      471           MCL
 001BC   0001                      472           DATA      1
 001BD   BBC0 0079                 473           LAB,B3    GAUTO,PREL          get first chunk
 001BF   B870 0904                 474           LDR,R3    MGAUTO,IMO
 001C1   0001                      475           MCL
 001C2   FF31                      476  HERE3    DATA      NOMEM-HERE3     ABORT IF ALTRETURN
 001C3   3C00                      477           LDV,R3    0               First frame size
 001C4   0FC4                      478           B         INITSTK,SPREL

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:22
                                   479           EJECT
                                   480  *
                                   481  *
         0001C5(0)                 482  ALOCA    ALIGN
 001C5   EBA0 000000               483           LAB,B6    0,R2
 001C8   93C0 FEFF                 484           LNJ,B1    EXT_AUTO,PREL
 001CA   0F97                      485           B         ALOCEDA,SPREL
                                   486  *
                                   487  *
         0001CB(0)                 488  X6A_AAUTO ALIGN
                                   489  *
 001CB   BC80 000000(2)s           490           LDB,B3    G$AUTO_T$
 001CE   0010 0030                 491           LDT       B3
 001D0   B803                      492           LDR,R3    ,B3
 001D1   3EFF                      493           ADV,R3    -1
 001D2   8253                      494           NEG       R3
 001D3   BBB3                      495           LAB,B3    ,B3,R3
 001D4   9805                      496           LDR,R1    ,B5                 # words in frame
 001D5   B843 FFFF                 497           LDR,R3    CUR_FR_SIZ,B3
 001D7   A833                      498           LDR,R2    ,B3,R3              Protect interruptee
 001D8   1E01                      499           ADV,R1    1                   Extra word in frame
 001D9   9F33                      500           STR,R1    ,B3,R3              so next get (RLQ) works
 001DA   0010 0007                 501           RLQ       B7                  get a frame???
 001DC   AB97                      502           LAB,B2    ,B7,R1
 001DD   AD80 000000(2)s           503           CMB,B2    G$AUTO_T$
 001E0   02E5                      504           BGE       ALOCA,SPREL
         0001E1(0)                 505  ALOCEDA  ALIGN
 001E1   1EFF                      506           ADV,R1    -1
 001E2   AF17                      507           STR,R2    ,B7,R1
 001E3   BF47 0003                 508           STR,R3    PREV_FR_SIZ,B7      so release (ACQ) works
 001E5   DF87                      509           STB,B5    ,B7                 proced activ address
 001E6   3CFE                      510           LDV,R3    -2
 001E7   BF47 0002                 511           STR,R3    FR_TYPE,B7          ASYNC type is -2
 001E9   83C5 0002                 512           JMP       RETDISP,B5
                                   513  *
         0001EB(0)                 514  X6A_ASTATIC ALIGN
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:23
                                   515  *
 001EB   AC85                      516           LDB,B2    ,B5
 001EC   DF82                      517           STB,B5    ,B2
 001ED   3CFE                      518           LDV,R3    -2
 001EE   BF42 0002                 519           STR,R3    FR_TYPE,B2
 001F0   83C5 0002                 520           JMP       RETDISP,B5

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:24
                                   521           EJECT
                                   522  *
         0001F2(0)                 523  X6A_MSRET ALIGN
         0001F2(0)                 524  X6A_MARET ALIGN
 001F2   B870 0080                 525           LDR,R3    MEXIT,IMO
 001F4   0001                      526           MCL
 001F5   0000                      527           DATA      0
                                   528  *
         0001F6(0)                 529  X6A_AARET ALIGN
 001F6   9847 FFFF                 530           LDR,R1    CUR_FR_SIZ,B7
 001F8   1EFF                      531           ADV,R1    -1
 001F9   A817                      532           LDR,R2    ,B7,R1
 001FA   B847 0003                 533           LDR,R3    PREV_FR_SIZ,B7
 001FC   0010 0037                 534           ACQ,R3    B7                  This ACQ releases a frame
 001FE   AF37                      535           STR,R2    ,B7,R3              Protect interruptee
         0001FF(0)                 536  X6A_ASRET ALIGN
 001FF   B870 00CC                 537           LDR,R3    MTRTN,IMO
 00201   0001                      538           MCL
 00202   0000                      539           DATA      0
                                   540  *
         000203(0)                 541  X6A_MSALT ALIGN
         000203(0)                 542  X6A_MAALT ALIGN
 00203   B870 0081                 543           LDR,R3    MERR,IMO
 00205   0001                      544           MCL
 00206   0000                      545           DATA      0
                                   546  *
         000207(0)                 547  X6A_AAALT ALIGN
 00207   9847 FFFF                 548           LDR,R1    CUR_FR_SIZ,B7
 00209   1EFF                      549           ADV,R1    -1
 0020A   A817                      550           LDR,R2    ,B7,R1
 0020B   B847 0003                 551           LDR,R3    PREV_FR_SIZ,B7
 0020D   0010 0037                 552           ACQ,R3    B7                  This ACQ releases a frame
 0020F   AF37                      553           STR,R2    ,B7,R3              Protect interruptee
         000210(0)                 554  X6A_ASALT ALIGN
 00210   B870 00CE                 555           LDR,R3    MMERCS,IMO
 00212   0001                      556           MCL
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:25
 00213   0000                      557           DATA      0

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:26
                                   558           EJECT
                                   559  *
         000214(0)                 560  X6A_MAUNWIND ALIGN
         000214(0)                 561  X6A_AAUNWIND ALIGN
         000214(0)                 562  X6A_AUNWIND ALIGN
         000214(0)                 563  X6A_MSUNWIND ALIGN
         000214(0)                 564  X6A_ASUNWIND ALIGN
         000214(0)                 565  X6A_SUNWIND ALIGN
 00214   FD83                      566  FNDB7    CMB,B7    ,B3
 00215   0906                      567           BE        FONB7,SPREL
 00216   B847 0003                 568           LDR,R3    PREV_FR_SIZ,B7
 00218   0010 0037                 569           ACQ,R3    B7                  This ACQ releases a frame
 0021A   0FFA                      570           B         FNDB7,SPREL
         00021B(0)                 571  FONB7   ALIGN
 0021B   CCC3 0002                 572           LDB,B4    2,B3
 0021D   E384                      573           LNJ,B6    ,B4

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:27
                                   574           EJECT
                                   575  *
         00021E(0)                 576  X6A_INTRET ALIGN
 0021E   B870 0440                 577           LDR,R3    MINTRETF,IMO
         000220(0)                 578  AINTRET  ALIGN
 00220   9847 FFFF                 579           LDR,R1    CUR_FR_SIZ,B7
 00222   1EFF                      580           ADV,R1    -1
 00223   A817                      581           LDR,R2    ,B7,R1
 00224   9847 0003                 582           LDR,R1    PREV_FR_SIZ,B7
 00226   0010 0017                 583           ACQ,R1    B7                  This ACQ releases a frame
 00228   AF17                      584           STR,R2    ,B7,R1              Protect interruptee
 00229   9284                      585           LLH,R1    ,B4
 0022A   1984                      586           BNEZ,R1   FINTRET,SPREL
 0022B   B570 03FF                 587           AND,R3    '3FF'X,IMO
 0022D   0F82                      588           B         ZINTRET,SPREL
 0022E   BC83                      589  FINTRET  LDB,B3    ,B3
 0022F   0001                      590  ZINTRET  MCL
 00230   0000                      591           DATA      0
                                   592  *
                                   593  *
         000231(0)                 594  X6A_TRTN ALIGN
 00231   B870 08CC                 595           LDR,R3    MTRTNF,IMO
 00233   0FED                      596           B         AINTRET,SPREL
                                   597  *
         000234(0)                 598  X6A_MERCS ALIGN
 00234   B870 04CE                 599           LDR,R3    MMERCSF,IMO
 00236   0FEA                      600           B         AINTRET,SPREL

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:28
                                   601           EJECT
                                   602  *
                                   603  *        data used by auto routines
                                   604  *
                                   605  *              GAUTO FPT
                                   606  *
 00237   0003                      607  GAUTO    DATA      3
 00238   0000023D(0)               608           DATA,4    GAUTOV
 0023A   0000                      609  GAUTOR   DATA      0
 0023B   00000000                  610           DATA,4    0
 0023D   0001                      611  GAUTOV   DATA      1
 0023E   0000                      612           DATA      0
                                   613  *
                                   614  *
 0023F   0003                      615  FAUTO    DATA      3
 00240   00000245(0)               616           DATA,4    FAUTOV
 00242   0000                      617           DATA      0
 00243   00000000                  618           DATA,4    0
 00245   0100                      619  FAUTOV   DATA      256
 00246   0000                      620           DATA      0
                                   621  *
                                   622  *
 00247   0003                      623  GAUTOM   DATA      3
 00248   0000024D(0)               624           DATA,4    GAUTOMV
 0024A   0000                      625           DATA      0
 0024B   00000000                  626           DATA,4    0
 0024D   0008                      627  GAUTOMV  DATA      GET_1ST/256
 0024E   0000                      628           DATA      0
                                   629  *
                                   630  *
 0024F   0005                      631  WRITE    DATA      5
 00250   0000025E(0)               632           DATA,4    WRITEV
 00252   0000                      633           DATA      0
 00253   00000000                  634           DATA,4    0
 00255   0037                      635           DATA      55
 00256   00000261(0)               636           DATA,4    WBUF
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:29
 00258   0000                      637           DATA      0
 00259   00000000                  638           DATA,4    0
 0025B   0000                      639           DATA      0
 0025C   00000000                  640           DATA,4    0
 0025E   03                        641  WRITEV   DATA,1    3
 0025E.8 00                        642           DATA,1    0
 0025F   00000000                  643           DATA,4    0
 00261   4155544F 20736567         644  WBUF     DATA,4    'AUTO',' seg','ment',' ful','l or',' use','r me'
 00265   6D656E74 2066756C
 00269   6C206F72 20757365
 0026D   72206D65
 0026F   6D6F7279 20617574         645           DATA,4    'mory',' aut','hori','zati','on r','each','ed. '
 00273   686F7269 7A617469
 00277   6F6E2072 65616368
 0027B   65642E20
                                   646  *
                                   647  *

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:30
                                   648           EJECT
                                   649  *
                                   650  *  X6C_ACM - Character compare
                                   651  *
                                   652  *    B2 - Operand 1 address
                                   653  *    R2 - Operand 1 index
                                   654  *    R6 - Operand 1 length
                                   655  *    B3 - Operand 2 address
                                   656  *    R3 - Operand 2 index
                                   657  *    R7 - Operand 2 length
                                   658  *
                                   659  *
         00027D(0)                 660  X6C_ACMZ     ALIGN                 WORD
                                   661  *
 0027D   5C00                      662           LDV,R5   0                /* Fill character 0 */
 0027E   0F83                      663           B        ACM1,SPREL
                                   664  *
         00027F(0)                 665  X6C_ACM      ALIGN                 WORD
                                   666  *
 0027F   D870 2000                 667           LDR,R5   ='2000'X         /* Fill character blank */
                                   668  *
         000281(0)                 669  ACM1         ALIGN                 WORD
                                   670  *
 00281   C870 00FF                 671           LDR,R4   =255             /* Load maximum length  */
 00283   E954                      672           CMR,R6   R4               /* Is oper 1 len < max len? */
 00284   0282                      673           BGE      ACM2,SPREL       /* If not, setup oper 2 */
 00285   C856                      674           LDR,R4   R6               /* If it is, assign oper 1 len */
                                   675  *
         000286(0)                 676  ACM2         ALIGN                 WORD
                                   677  *
 00286   9870 00FF                 678           LDR,R1   =255             /* load maximum length  */
 00288   F951                      679           CMR,R7   R1               /* Is oper 2 len < max len? */
 00289   0282                      680           BGE      DO_ACOM,SPREL    /* If not, do the ACM   */
 0028A   9857                      681           LDR,R1   R7               /* If it is, assign oper 2 len */
                                   682  *
         00028B(0)                 683  DO_ACOM      ALIGN                 WORD
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:31
                                   684  *
 0028B   DA51                      685           ADD,R5   R1               /* R5 = fill char, & oper 2 len */
 0028C   0022 40220000             686           ACM      ALPHANUM(0,B2,R2,FILL),;  /* Length in R4 */
 0028F   40330000                  687                    ALPHANUM(0,B3,R3,FILL)    /* Fill & len in R5 */
 00291   5301 0009                 688           CBNE     ACM_RET,PREL
 00293   AA54                      689           ADD,R2   R4               /* Incr oper 1 index */
 00294   E254                      690           SUB,R6   R4               /* Update oper 1 remaining len */
 00295   D570 FF00                 691           AND,R5   ='FF00'X         /* Save fill char in R5 */
 00297   BA51                      692           ADD,R3   R1               /* Incr oper 2 index */
 00298   F251                      693           SUB,R7   R1               /* Update oper 2 remaining len */
                                   694  *
 00299   69E8                      695           BNEZ,R6  ACM1,SPREL
 0029A   79E7                      696           BNEZ,R7  ACM1,SPREL
                                   697  *
         00029B(0)                 698  ACM_RET       ALIGN                 WORD
                                   699  *
 0029B   C385                      700           LNJ,B4   ,B5               /* RETURN */
                                   701  *
                                   702  *

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:32
                                   703           EJECT
                                   704  *
                                   705  *
         00029C(0)                 706  X6C_ALRZ ALIGN
                                   707  *
                                   708  *
 0029C   4C00                      709           LDV,R4    0               Fill Character
                                   710  *
         00029D(0)                 711  ALRZ0    ALIGN
                                   712  *
                                   713  *  B2 - Source addr
                                   714  *  B3 - Dest addr
                                   715  *  R2 - Source offset
                                   716  *  R3 - Dest offset
                                   717  *  R4 - Fill character in left byte, 0 in right byte
                                   718  *  R5 - Size to move from B2 for each CIP
                                   719  *  R6 - Source remaining length
                                   720  *  R7 - Dest remaining length
                                   721  *
         00029D(0)                 722  ALRZ1    ALIGN
 0029D   E957                      723           CMR,R6   R7       If source is longer than destination
 0029E   0204                      724           BL       ALRZ2,SPREL
 0029F   E857                      725           LDR,R6   R7       We only need to move as many bytes as in t
                                      ::he destination.
 002A0   0008                      726           MMM
 002A1   C385                      727           LNJ,B4   ,B5      RETURN
         0002A2(0)                 728  ALRZ2    ALIGN
 002A2   F256                      729           SUB,R7   R6       Find out how much filler we need.
 002A3   0008                      730           MMM
         0002A4(0)                 731  ALRZ3    ALIGN
 002A4   D857                      732           LDR,R5    R7              MOVE REMAINING DEST LENGTH
 002A5   D970 00FF                 733           CMR,R5    =255
 002A7   0383                      734           BLE       ALRZ4,SPREL
 002A8   D870 00FF                 735           LDR,R5    =255
         0002AA(0)                 736  ALRZ4    ALIGN
 002AA   D454                      737           OR,R5     R4              ADD FILL CHAR
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:33
 002AB   0021 40220000             738           ALR       ALPHANUM(0,B2,R2,FILL),;  len in R4
 002AE   40330000                  739                     ALPHANUM(0,B3,R3,FILL)    len in R5
 002B0   D2D5                      740           LLH,R5   R5          Get rid of fill character
 002B1   F255                      741           SUB,R7    R5
 002B2   BA55                      742           ADD,R3    R5
 002B3   79F1                      743           BNEZ,R7  ALRZ3,SPREL
                                   744  *
 002B4   437F                      745           CSYNC
 002B5   C385                      746           LNJ,B4    ,B5
                                   747  *
                                   748  *
         0002B6(0)                 749  X6C_ALR ALIGN
                                   750  *
 002B6   C870 2000                 751           LDR,R4    ='2000'X        Fill character - blank
 002B8   0FE5                      752           B         ALRZ0,SPREL

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:34
                                   753           EJECT
                                   754  *
                                   755  *  X6B_BLR - Bit move
                                   756  *     B2 - Source address
                                   757  *     B3 - Destination address
                                   758  *     R2 - Source displacement
                                   759  *     R3 - Destination displacement
                                   760  *     R6 - Source length
                                   761  *     R7 - Destination length
                                   762  *
                                   763  *
 002B9   6704                      764  BLR2     BDEC,R6   BLR_GET,SPREL   Source string is non-emtpy
                                   765  *
                                   766  *  Source string is empty - fill destination with zeroes
                                   767  *
 002BA   887F                      768  BLR_FILL LBF       ,B3,R3,PULL
 002BB   777F                      769           BDEC,R7   BLR_FILL,SPREL
 002BC   8385                      770           JMP       ,B5
                                   771  *
                                   772  *  Copy next bit from source to destination
                                   773  *
 002BD   82EE                      774  BLR_GET  LB        ,B2,R2,PULL
 002BE   8A7F                      775           LBS       ,B3,R3,PULL
                                   776  *
 002BF   777A                      777  X6B_BLR  BDEC,R7   BLR2,SPREL      Br if dest string non-empty
 002C0   8385                      778           JMP       ,B5             Done when dest exhausted

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:35
                                   779           EJECT
                                   780  *
                                   781  *  X6B_BCM - Bit compare
                                   782  *
                                   783  *    B2 - Source address
                                   784  *    B3 - Destination address
                                   785  *    R2 - Source offset
                                   786  *    R3 - Destination offset
                                   787  *    R6 - Source length
                                   788  *    R7 - Destination length
                                   789  *
                                   790  *
 002C1   6706                      791  X6B_BCM  BDEC,R6   BCM2,SPREL      Br if source non-empty
 002C2   770A                      792           BDEC,R7   BCM4,SPREL      Br if dest non-empty
 002C3   8FC0 001B 0080            793  BCM_EQ   RSTR,'0080'X  IREQ,PREL   Reset G and L indicators
 002C6   8385                      794           JMP       ,B5
                                   795  *
 002C7   7709                      796  BCM2     BDEC,R7   BCM6,SPREL      Br if both source and dest non-emp
                                      ::ty
                                   797  *
                                   798  *  Source is non-empty, dest is empty
                                   799  *
 002C8   82EE                      800  BCM3     LB        ,B2,R2,PULL     Load bit into b-bit if I register
 002C9   050E                      801           BBT       BCM_GT,SPREL    Bit set in source, source is great
                                      ::er
 002CA   677E                      802           BDEC,R6   BCM3,SPREL
 002CB   0FF8                      803           B         BCM_EQ,SPREL    Equal
                                   804  *
                                   805  *  Source is empty, dest is non-empty
                                   806  *
 002CC   82FF                      807  BCM4     LB        ,B3,R3,PULL
 002CD   050E                      808           BBT       BCM_LT,SPREL    Bit set in dest, source is less
 002CE   777E                      809           BDEC,R7   BCM4,SPREL
 002CF   0FF4                      810           B         BCM_EQ,SPREL    Equal
                                   811  *
                                   812  *  Both source and dest non-empty, compare next bits
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:36
                                   813  *
 002D0   82EE                      814  BCM6     LB        ,B2,R2,PULL
 002D1   0504                      815           BBT       BCM7,SPREL      True
 002D2   82FF                      816           LB        ,B3,R3,PULL
 002D3   0508                      817           BBT       BCM_LT,SPREL    Source not set, dest set
 002D4   0FED                      818           B         X6B_BCM,SPREL
                                   819  *
 002D5   82FF                      820  BCM7     LB        ,B3,R3,PULL
 002D6   056B                      821           BBT       X6B_BCM,SPREL   Both set
                                   822  *
 002D7   8FC0 0009 0080            823  BCM_GT   RSTR,'0080'X  IRGT,PREL
 002DA   8385                      824           JMP       ,B5
                                   825  *
 002DB   8FC0 0004 0080            826  BCM_LT   RSTR,'0080'X  IRLT,PREL
 002DE   8385                      827           JMP       ,B5
                                   828  *
 002DF   0000                      829  IREQ     DATA      0
 002E0   0002                      830  IRLT     DATA      '0002'X
 002E1   0004                      831  IRGT     DATA      '0004'X
                                   832  *
                                   833  *

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:37
                                   834           EJECT
         0002E2(0)                 835  X6C_MAT         ALIGN     WORD
                                   836  *
                                   837  *  R1 - Source index
                                   838  *  R2 - target index
                                   839  *  R4 - Source length (current loop)
                                   840  *  R5 - Fill char & target length (current loop)
                                   841  *  R6 - Source length (total)
                                   842  *  R7 - Target length (total)
                                   843  *  B1 - Addr of translation table
                                   844  *  B2 - Addr of source
                                   845  *  B3 - Addr of target
                                   846  *
         0002E2(0)                 847  LOOP            ALIGN     WORD
                                   848  *
 002E2   D870 00FF                 849            LDR,R5     =255
 002E4   F955                      850            CMR,R7     R5             /* Check remaining target */
 002E5   0282                      851            BGE        CHECK_OPR0,SPREL
 002E6   D857                      852            LDR,R5     R7
                                   853  *
         0002E7(0)                 854  CHECK_OPR0      ALIGN     WORD
                                   855  *
 002E7   C855                      856            LDR,R4     R5             /* Source len <= target len */
 002E8   E954                      857            CMR,R6     R4             /* Check remaining source */
 002E9   0282                      858            BGE        DO_MAT,SPREL
 002EA   C856                      859            LDR,R4     R6
                                   860  *
         0002EB(0)                 861  DO_MAT          ALIGN      WORD
                                   862  *
 002EB   D470 2000                 863            OR,R5      ='2000'X       /* Fill char - blank */
 002ED   0023 40220000             864            MAT        ALPHANUM(0,B2,R2,FILL),; /* Len in R4 */
 002F0   40330000 40110000         865                       ALPHANUM(0,B3,R3,FILL),; /* Fill & len in R5 */
                                   866                       ALPHANUM(0,B1,R1,FILL)   /* Len = 256 */
                                   867  *
 002F4   AA54                      868            ADD,R2     R4             /* Incr index for desc 0 */
 002F5   E254                      869            SUB,R6     R4             /* Adjust remaining source len */
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:38
 002F6   D2D5                      870            LLH,R5     R5             /* Clear fill char; save len */
 002F7   BA55                      871            ADD,R3     R5             /* Incr index for desc 1 */
 002F8   F255                      872            SUB,R7     R5             /* Adjust remaining target len */
                                   873  *
 002F9   79E9                      874            BNEZ,R7    LOOP,SPREL     /* Check remaining source */
 002FA   437F                      875            CSYNC
 002FB   6982                      876            BNEZ,R6    ALTRET_MAT,SPREL   /* Check remaining target */
                                   877  *
 002FC   C385                      878            LNJ,B4     ,B5
                                   879  *
         0002FD(0)                 880  ALTRET_MAT       ALIGN      WORD
                                   881  *
 002FD   C386                      882            LNJ,B4     ,B6
                                   883  *

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:39
                                   884           EJECT
                                   885  * This routine searches for a single character, then ACMs the rest
                                   886  * of the string.  The reason for this madness is that it's the
                                   887  * simplest method of insuring that we don't miss a comparison due
                                   888  * to the 255 character limits imposed upon us by the CIP.  In other
                                   889  * words, if the character string we are searching for begins at
                                   890  * character 250 for a length of 10, we would miss the comparison
                                   891  * searching from 0 to 255, and then from 256 to 511.
                                   892  *
         00000001                  893  DISPL     EQU  1
         00000002                  894  ARG_LEN   EQU  2
         00000003                  895  STR_LEN   EQU  3
         00000004                  896  ARG_INX   EQU  4
         00000005                  897  STR_INX   EQU  5
                                   898  *
         0002FE(0)                 899  X6C_SRCH        ALIGN      WORD
                                   900  *
                                   901  *
 002FE   C870 0101                 902            LDR,R4     ='0101'X       /* Set up arg register */
 00300   1061                      903            SAR,R1     1
 00301   CB91                      904            LAB,B4     ,B1,R1         /* Get addr of TEMP */
 00302   EF44 0002                 905            STR,R6     ARG_LEN,B4     /* Save search arg len */
 00304   FF44 0003                 906            STR,R7     STR_LEN,B4     /* Save search str len */
 00306   AF44 0004                 907            STR,R2     ARG_INX,B4     /* Save search arg inx */
                                   908  *
         000308(0)                 909  BEGIN           ALIGN      WORD
                                   910  *
 00308   E870 00FF                 911            LDR,R6     =255           /* Init R6 for srch */
 0030A   F956                      912            CMR,R7     R6
 0030B   0282                      913            BGE        DO_SRCH,SPREL
 0030C   E857                      914            LDR,R6     R7
                                   915  *
         00030D(0)                 916  DO_SRCH         ALIGN     WORD
                                   917  *
 0030D   E470 0100                 918            OR,R6      ='0100'X
                                   919  *
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:40
 0030F   0028 40220000             920            SRCH       ALPHANUM(0,B2,R2,FILL),; /* Lengths in R4 */
 00312   40040000 40330000         921                       ALPHANUM(0,B4,0,FILL),;  /* Length = 4 */
                                   922                       ALPHANUM(0,B3,R3,FILL)   /* Lengths in R6 */
                                   923  *
 00316   7328                      924            CBL        NO_MATCH,SPREL
 00317   F244 0001                 925            SUB,R7     DISPL,B4       /* Adjust remaining srch len */
 00319   BA44 0001                 926            ADD,R3     DISPL,B4       /* Adjust srch str inx */
 0031B   BF44 0005                 927            STR,R3     STR_INX,B4     /* Save srch str inx */
 0031D   E844 0002                 928            LDR,R6     ARG_LEN,B4     /* Get orig arg length */
 0031F   F956                      929            CMR,R7     R6             /* Compare S len to T len */
 00320   0224                      930            BL         ALTRET_SRCH,SPREL /* No way this can match */
                                   931  *
         000321(0)                 932  ACM_LOOP        ALIGN     WORD
                                   933  *
 00321   C870 00FF                 934            LDR,R4     =255
 00323   E954                      935            CMR,R6     R4
 00324   0282                      936            BGE        DO_ACM,SPREL
 00325   C856                      937            LDR,R4     R6
                                   938  *
         000326(0)                 939  DO_ACM          ALIGN    WORD
                                   940  *
 00326   D854                      941            LDR,R5     R4             /* Set target length */
                                   942  *
 00327   0022 40220000             943            ACM        ALPHANUM(0,B2,R2,FILL),; /* Len in R4 */
 0032A   40330000                  944                       ALPHANUM(0,B3,R3,FILL)   /* Len in R5 */
                                   945  *
 0032C   5309                      946            CBNE       ACM_UNEQUAL,SPREL
 0032D   AA54                      947            ADD,R2     R4             /* Incr source inx */
 0032E   BA55                      948            ADD,R3     R5             /* Incr target inx */
 0032F   E254                      949            SUB,R6     R4             /* Adjust remaining target len */
 00330   69F1                      950            BNEZ,R6    ACM_LOOP,SPREL
                                   951  *
 00331   E844 0003                 952            LDR,R6     STR_LEN,B4     /* Get total str len */
 00333   E257                      953            SUB,R6     R7             /* Get result */
 00334   C385                      954            LNJ,B4     ,B5            /* RETURN */
                                   955  *
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:41
         000335(0)                 956  ACM_UNEQUAL      ALIGN     WORD
                                   957  *
 00335   B844 0005                 958            LDR,R3     STR_INX,B4     /* Get inx into search str */
 00337   3E01                      959            ADV,R3     1              /* Incr past last match */
 00338   A844 0004                 960            LDR,R2     ARG_INX,B4     /* Restore arg inx */
                                   961  *                                   /* Adjust remaining len beyond
 0033A   7EFF                      962            ADV,R7     -1             /* the last match */
 0033B   C870 0101                 963            LDR,R4     ='0101'X       /* Re-init R4 */
 0033D   0FCB                      964            B          BEGIN,SPREL    /* Continue scanning */
                                   965  *
         00033E(0)                 966  NO_MATCH         ALIGN     WORD
                                   967  *
 0033E   E2D6                      968            LLH,R6     R6             /* Clear srch data */
 0033F   BA56                      969            ADD,R3     R6             /* Incr desc 2 inx */
 00340   F256                      970            SUB,R7     R6             /* Adjust remaining str len */
 00341   F944 0002                 971            CMR,R7     ARG_LEN,B4     /* Remaining len < srch arg ? */
 00343   02C5                      972            BGE        BEGIN,SPREL
                                   973  *
         000344(0)                 974  ALTRET_SRCH      ALIGN     WORD
                                   975  *
 00344   C386                      976            LNJ,B4     ,B6            /* Altreturn */
                                   977  *

CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:42
                                   978           EJECT
                                   979  *
                                   980  * This entry point is for double precision multiplication.  The high
                                   981  * order bytes are treated as signed quantities and the low order
                                   982  * bytes are treated as unsigned quantities.  If the highest bit in
                                   983  * a byte is set the machine "thinks" it's negative.  This is OK for
                                   984  * the high order bytes but not for the low order bytes, hence the
                                   985  * compensation in the code.
                                   986  *
         00000000                  987  BYTE0  EQU 0
         00000001                  988  BYTE1  EQU 1
                                   989  *
         000345(0)                 990  X6D_MID        ALIGN
                                   991
 00345   C856                      992         LDR,R4  R6
 00346   D857                      993         LDR,R5  R7
                                   994
 00347   FB41 0001                 995         MUL,R7  BYTE1,B1  /* Multiply low-order bytes */
                                   996
                                   997  *                         /* Compare low-order byte of operand 1 */
                                   998  *                         /*  to zero. */
 00349   5883                      999         BGEZ,R5    CHECK_OPR2,SPREL
 0034A   EA41 0001                1000         ADD,R6  BYTE1,B1  /* If < 0, compensate in the result */
                                  1001  *
         00034C(0)                1002  CHECK_OPR2     ALIGN     WORD
                                  1003  *
 0034C   89C1 0001                1004         CMZ     BYTE1,B1  /* Compare low-order byte of operand 2 */
                                  1005  *                         /* to zero. */
 0034E   0882                     1006         BAGE    SKIP_OPR2,SPREL
 0034F   EA55                     1007         ADD,R6  R5         /* If < 0, compensate in the result */
                                  1008  *
         000350(0)                1009  SKIP_OPR2      ALIGN     WORD
                                  1010  *
 00350   9856                     1011         LDR,R1  R6         /* Save current contents of R6 */
 00351   A857                     1012         LDR,R2  R7         /* Save current contents of R7 */
                                  1013  *
CALF.D00   OU Name=X6A_MAUTO               File=X6A$CSEQU.:E05TSI               WED JUL 30 '97 09:08 Page:43
                                  1014  *                         /* Restore original high order byte of */
                                  1015  *                         /* operand 1, then... */
                                  1016  *                         /* Cross multiply high-order byte of */
                                  1017  *                         /* operand 1 with low-order byte of  */
                                  1018  *                         /* operand 2 */
 00352   F854                     1019         LDR,R7  R4
 00353   FB41 0001                1020         MUL,R7  BYTE1,B1
 00355   9A57                     1021         ADD,R1  R7
                                  1022  *
                                  1023  *                         /* Restore original low-order byte of */
                                  1024  *                         /* operand 1, then... */
                                  1025  *                         /* Cross multiply low-order byte of */
                                  1026  *                         /* operand 2 with low-order byte of */
                                  1027  *                         /* operand 1 */
 00356   F855                     1028         LDR,R7  R5
 00357   FB01                     1029         MUL,R7  ,B1         /* BYTE0 */
 00358   9A57                     1030         ADD,R1  R7
                                  1031  *
 00359   E851                     1032         LDR,R6  R1         /* Store high-order byte of result */
 0035A   F852                     1033         LDR,R7  R2         /* Store low-order byte of result */
 0035B   C385                     1034         LNJ,B4  ,B5        /* Return */
                                  1035  *
                                  1036           END
      No Errors in this assembly.
