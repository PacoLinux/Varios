VERSION E05

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:1    
        1        1        /*M* QTB$CREMOD_F - Perform  CREATE / MODIFY FORM  commands */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTB$CREMOD_F:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QT_DATA_R;
       16      164        %INCLUDE CP_6_SUBS;
       17      704        %INCLUDE QT_PERR_C;
       18      755        %INCLUDE Q_ERRCODE_C;
       19      778        %INCLUDE QT_MACROS_C;
       20      936        %INCLUDE QT_SUBS_C;
       21     1020        %INCLUDE XU_MACRO_C;
       22     4126        %PAGE(ARG="Externally defined routines");

              4143    1   /***************************************************************************
              4144    1    *                                                                         *
              4145    1    *                        Externally defined routines                      *
              4146    1    *                                                                         *
              4147    1    ***************************************************************************/

       23     4151    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:2    
       24     4152    1   DCL QTC$READ_TRADER ENTRY(3) ALTRET;
       25     4153    1   DCL QTC$WRITE_TRADER ENTRY(2);
       26     4154    1   DCL XUR$ERRPTR ENTRY(2) ALTRET;
       27     4155        %PAGE(ARG="Based");

              4172    1   /***************************************************************************
              4173    1    *                                                                         *
              4174    1    *                                   Based                                 *
              4175    1    *                                                                         *
              4176    1    ***************************************************************************/

       28     4180        %QT$FORM;
       29     4219        %PARSE$SYM(STCLASS=BASED);
       30     4257        %PARSE$OUT(STCLASS=BASED);
       31     4302        %PAGE(ARG="Static");

              4319    1   /***************************************************************************
              4320    1    *                                                                         *
              4321    1    *                                   Static                                *
              4322    1    *                                                                         *
              4323    1    ***************************************************************************/

       32     4327    1   DCL FID CHAR(100) STATIC;
       33     4328        %PAGE(ARG="Constant");

              4345    1   /***************************************************************************
              4346    1    *                                                                         *
              4347    1    *                                  Constant                               *
              4348    1    *                                                                         *
              4349    1    ***************************************************************************/

       34     4353        %QT$FORM(FPTN=QT_FORM_C, STCLASS=CONSTANT);
       35     4392        %PAGE(ARG="Auto");

              4409    1   /***************************************************************************
              4410    1    *                                                                         *
              4411    1    *                                    Auto                                 *
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:3    
              4412    1    *                                                                         *
              4413    1    ***************************************************************************/

       36     4417    1   DCL MSGTYP CHAR(8);
       37     4418    1   DCL FOUND_MSGTYP CHAR(8);
       38     4419
       39     4420    1   DCL REC_OK_FLAG BIT(1) ALIGNED;
       40     4421
       41     4422    1   DCL SUBLK$ PTR;
       42     4423
       43     4424    1   DCL NSUBLKS UBIN WORD;
       44     4425    1   DCL I UBIN WORD;
       45     4426    1   DCL SUB_CODE UBIN WORD;
       46     4427    1   DCL POS UBIN WORD;
       47     4428    1   DCL TEMP UBIN WORD;
       48     4429    1   DCL CPOS UBIN WORD;
       49     4430
       50     4431    1   DCL OPTIONS_USED(0:35) BIT(1) UNAL;
       51     4432    1   DCL ALL_OPTIONS REDEF OPTIONS_USED BIT(36);
       52     4433        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:4    
              4450    1   /***************************************************************************
              4451    1    *                                                                         *
              4452    1    *                                Error codes                              *
              4453    1    *                                                                         *
              4454    1    ***************************************************************************/

       53     4458        %ERRCODE(NAME=CODE_NWH, CODE#=%E$NWH, FCG#=%FCG_QT, MID#=%MID_B);
       54     4465        %ERRCODE(NAME=CODE_AE, CODE#=%E$AE, FCG#=%FCG_QT, MID#=%MID_B);
       55     4472        %ERRCODE(NAME=CODE_CMNF, CODE#=%E$CMNF, FCG#=%FCG_QT, MID#=%MID_B);
       56     4479        %ERRCODE(NAME=CODE_AUSED, CODE#=%E$AUSED, FCG#=%FCG_QT, MID#=%MID_B);
       57     4486        %ERRCODE(NAME=CODE_FPMBOD, CODE#=%E$FPMBOD, FCG#=%FCG_QT, MID#=%MID_B);
       58     4493        %ERRCODE(NAME=CODE_BFFF, CODE#=%E$BFFF, FCG#=%FCG_QT, MID#=%MID_B);
       59     4500        %ERRCODE(NAME=CODE_NFP, CODE#=%E$NFP, FCG#=%FCG_QT, MID#=%MID_B);
       60     4507        /*E*       ERROR: QTB-E$FPMBOD-C
       61     4508
       62     4509                 MESSAGE: Forms Programs must be on disk.
       63     4510             DESCRIPTION: The FID for a FP must be a file that resides
       64     4511                          on disk.
       65     4512        */
       66     4513        /*E*       ERROR: QTB-E$BFFF-C
       67     4514
       68     4515                 MESSAGE: Invalid FID for the Forms Program
       69     4516             DESCRIPTION: The FID for the FP is not a valid FID
       70     4517        */
       71     4518        /*E*       ERROR: QTB-E$NFP-C
       72     4519
       73     4520                 MESSAGE: A Forms Program (FP) FID must be specified.
       74     4521             DESCRIPTION: You must specify a forms program for
       75     4522                          this type.  The definition for the type
       76     4523                          will not be complete without a forms program.
       77     4524        */
       78     4525        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:5    
              4542    1   /***************************************************************************
              4543    1    *                                                                         *
              4544    1    *                                    FPTs                                 *
              4545    1    *                                                                         *
              4546    1    ***************************************************************************/

       79     4550        %FPT_OPEN;
       80     4659
       81     4660        %FPT_FID(NAME=VLP_NAME, PASS=VLP_PASS, RESULTS=VLR_FID,
       82     4661        ACCT=VLP_ACCT, ASN="FPT_OPEN.V.ASN#", SN=VLP_SN,
       83     4662        RES="FPT_OPEN.V.RES#", WSN=VLP_WSN, TEXTFID=FID);
       84     4685        %PAGE(ARG="VLPs");

              4702    1   /***************************************************************************
              4703    1    *                                                                         *
              4704    1    *                                    VLPs                                 *
              4705    1    *                                                                         *
              4706    1    ***************************************************************************/

       85     4710        %VLP_NAME;
       86     4737        %VLP_PASS;
       87     4750        %VLP_ACCT;
       88     4763        %VLP_SN;
       89     4776        %VLP_WSN;
       90     4789        %PAGE(ARG="VLRs");

              4806    1   /***************************************************************************
              4807    1    *                                                                         *
              4808    1    *                                    VLRs                                 *
              4809    1    *                                                                         *
              4810    1    ***************************************************************************/

       91     4814        %VLR_FID;
       92     4833        %PAGE(ARG="QTB$CREMOD_E", PAGE=YFS);

              4850    1   /***************************************************************************
              4851    1    *                                                                         *
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:6    
              4852    1    *                                QTB$CREMOD_E                             *
              4853    1    *                                                                         *
              4854    1    ***************************************************************************/

       93     4858    1           REC_OK_FLAG = '1'B;
       94     4859    1           NSUBLKS = QT_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;
       95     4860    1           ALL_OPTIONS = '0'B;
       96     4861
       97     4862    1           MSGTYP = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
       98     4863
       99     4864    1           CALL INDEX(POS, '?', MSGTYP) ALTRET(NO_Q);
      100     4865    1           QT_CMDBLK.MINOR_ERR = CODE_NWH;
      101     4866    1           CALL XUR$ERRMSG(CODE_NWH);
      102     4867    1           REC_OK_FLAG = '0'B;
      103     4868
      104     4869    1   NO_Q:
      105     4870    1           CALL QTC$READ_TRADER(MSGTYP, 2 /* TYPE_F */, FOUND_MSGTYP)
      106     4871    1               ALTRET(NOT_FOUND);
      107     4872
      108     4873    1           IF QT_CMDBLK.CODE = 3 /* CREATE_FORM */ THEN
      109     4874    2             DO;
      110     4875    2               QT_CMDBLK.MINOR_ERR = CODE_AE;
      111     4876    2               CALL XUR$ERRMSG(CODE_AE);
      112     4877    2               REC_OK_FLAG = '0'B;
      113     4878
      114     4879    2               QT$FORM = QT_FORM_C;
      115     4880    2             END;
      116     4881
      117     4882    2           DO WHILE('0'B);
      118     4883
      119     4884    2   NOT_FOUND:
      120     4885    2             IF QT_CMDBLK.CODE = 13 /* MODIFY_FORM */ THEN
      121     4886    3               DO;
      122     4887    3                 QT_CMDBLK.MINOR_ERR = CODE_CMNF;
      123     4888    3                 CALL XUR$ERRMSG(CODE_CMNF);
      124     4889    3                 REC_OK_FLAG = '0'B;
      125     4890    3               END;
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:7    
      126     4891
      127     4892    2             QT$FORM = QT_FORM_C;
      128     4893    2           END /* NEVER */;
      129     4894
      130     4895    2           DO I = 1 TO NSUBLKS;
      131     4896    2             SUBLK$ = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      132     4897    2             SUB_CODE = SUBLK$ -> OUT$SYM.CODE;
      133     4898    2             IF OPTIONS_USED(SUB_CODE) THEN
      134     4899    3               DO;
      135     4900    3                 CPOS = SUBLK$ -> OUT$SYM.CPOS;
      136     4901    3                 CALL XUR$ERRPTR(CPOS, QT_GLOBAL.M$DO#);
      137     4902    3                 QT_CMDBLK.MINOR_ERR = CODE_AUSED;
      138     4903    3                 CALL XUR$ERRMSG(CODE_AUSED);
      139     4904    3               END;
      140     4905
      141     4906    2             OPTIONS_USED(SUB_CODE) = '1'B;
      142     4907
      143     4908    3             DO CASE(SUB_CODE);
      144     4909
      145     4910    3               CASE(1 /* OPT_FP */);
      146     4911    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      147     4912    3                 FID = SUBLK$ -> OUT$SYM.TEXT;
      148     4913    3                 CALL M$FID(FPT_FID) ALTRET(FP_ERR);
      149     4914
      150     4915    3                 IF FPT_OPEN.V.ASN# ~= 1 /* FILE# */THEN
      151     4916    4                   DO;
      152     4917    4                     QT_CMDBLK.MINOR_ERR = CODE_FPMBOD;
      153     4918    4                     CALL XUR$ERRMSG(CODE_FPMBOD);
      154     4919    4                     REC_OK_FLAG = '0'B;
      155     4920    4                   END;
      156     4921
      157     4922    4                 DO WHILE('0'B);
      158     4923
      159     4924    4   FP_ERR:
      160     4925    4                   QT_CMDBLK.MINOR_ERR = CODE_BFFF;
      161     4926    4                   CALL XUR$ERRMSG(CODE_BFFF);
      162     4927    4                   REC_OK_FLAG = '0'B;
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:8    
      163     4928    4                 END /* NEVER */;
      164     4929
      165     4930    3                 QT$FORM.FP.NAME = VLP_NAME;
      166     4931    3                 QT$FORM.FP.ACCT = VLP_ACCT.ACCT#;
      167     4932    3                 QT$FORM.FP.PASS = VLP_PASS.PASS#;
      168     4933    3                 QT$FORM.FP.SN = VLP_SN.SN#(0);
      169     4934
      170     4935    3               CASE(9 /* OPT_JOURNAL */);
      171     4936    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      172     4937    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN
      173     4938    4                   DO;
      174     4939    4                     QT$FORM.FLAGS.JOURNAL = '0'B;
      175     4940    4                   END;
      176     4941    3                 ELSE
      177     4942    4                   DO;
      178     4943    4                     QT$FORM.FLAGS.JOURNAL = '1'B;
      179     4944    4                   END;
      180     4945
      181     4946    3               CASE(10 /* OPT_ONEREPORT */);
      182     4947    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      183     4948    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN
      184     4949    4                   DO;
      185     4950    4                     QT$FORM.FLAGS.ONEREPORT = '0'B;
      186     4951    4                   END;
      187     4952    3                 ELSE
      188     4953    4                   DO;
      189     4954    4                     QT$FORM.FLAGS.ONEREPORT = '1'B;
      190     4955    4                   END;
      191     4956
      192     4957    3             END /* CASE */;
      193     4958
      194     4959    2   LOOP:
      195     4960    2           END /* Do for each sub option */;
      196     4961
      197     4962    1           IF QT$FORM.FP.NAME.COUNT = 0 THEN
      198     4963    2             DO;
      199     4964    2               QT_CMDBLK.MINOR_ERR = CODE_NFP;
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:9    
      200     4965    2               CALL XUR$ERRMSG(CODE_NFP);
      201     4966    2               REC_OK_FLAG = '0'B;
      202     4967    2             END;
      203     4968
      204     4969    1           IF REC_OK_FLAG THEN
      205     4970    2             DO;
      206     4971    2               CALL QTC$WRITE_TRADER(MSGTYP, 2 /* TYPE_F */);
      207     4972    2             END;
      208     4973
      209     4974    1           RETURN;
      210     4975
      211     4976    1   END QTB$CREMOD_F;

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:10   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTB$CREMOD_F.

   Procedure QTB$CREMOD_F requires 224 words for executable code.
   Procedure QTB$CREMOD_F requires 20 words of local(AUTO) storage.

    No errors detected in file QTB$CREMOD_F.:E05TSI    .

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:11   

 Object Unit name= QTB$CREMOD_F                               File name= QTB$CREMOD_F.:E05TOU
 UTS= JUL 30 '97 05:47:08.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   136    210  QTB$CREMOD_F
    2  RoData even  UTS     30     36  QTB$CREMOD_F
    3   Proc  even  none   224    340  QTB$CREMOD_F
    4  RoData even  none    11     13  QTB$CREMOD_F

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  QTB$CREMOD_F

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       7 XUR$ERRMSG
 yes     yes           Std       3 QTC$READ_TRADER
 yes     yes           Std       2 XUR$ERRPTR
         yes           Std       2 QTC$WRITE_TRADER
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:12   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QT_GLOBAL                             QT_CMDBLK
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:13   


        1        1        /*M* QTB$CREMOD_F - Perform  CREATE / MODIFY FORM  commands */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QTB$CREMOD_F:
        9        9                PROC;

      9  3 000000   000000 700200 xent  QTB$CREMOD_F TSX0  ! X66_AUTO_0
         3 000001   000024 000000                    ZERO    20,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE QT_DATA_R;
       16      164        %INCLUDE CP_6_SUBS;
       17      704        %INCLUDE QT_PERR_C;
       18      755        %INCLUDE Q_ERRCODE_C;
       19      778        %INCLUDE QT_MACROS_C;
       20      936        %INCLUDE QT_SUBS_C;
       21     1020        %INCLUDE XU_MACRO_C;
       22     4126        %PAGE(ARG="Externally defined routines");

              4143    1   /***************************************************************************
              4144    1    *                                                                         *
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:14   
              4145    1    *                        Externally defined routines                      *
              4146    1    *                                                                         *
              4147    1    ***************************************************************************/

       23     4151    1   DCL XUR$ERRMSG ENTRY(7) ALTRET;
       24     4152    1   DCL QTC$READ_TRADER ENTRY(3) ALTRET;
       25     4153    1   DCL QTC$WRITE_TRADER ENTRY(2);
       26     4154    1   DCL XUR$ERRPTR ENTRY(2) ALTRET;
       27     4155        %PAGE(ARG="Based");

              4172    1   /***************************************************************************
              4173    1    *                                                                         *
              4174    1    *                                   Based                                 *
              4175    1    *                                                                         *
              4176    1    ***************************************************************************/

       28     4180        %QT$FORM;
       29     4219        %PARSE$SYM(STCLASS=BASED);
       30     4257        %PARSE$OUT(STCLASS=BASED);
       31     4302        %PAGE(ARG="Static");

              4319    1   /***************************************************************************
              4320    1    *                                                                         *
              4321    1    *                                   Static                                *
              4322    1    *                                                                         *
              4323    1    ***************************************************************************/

       32     4327    1   DCL FID CHAR(100) STATIC;
       33     4328        %PAGE(ARG="Constant");

              4345    1   /***************************************************************************
              4346    1    *                                                                         *
              4347    1    *                                  Constant                               *
              4348    1    *                                                                         *
              4349    1    ***************************************************************************/

       34     4353        %QT$FORM(FPTN=QT_FORM_C, STCLASS=CONSTANT);
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:15   
       35     4392        %PAGE(ARG="Auto");

              4409    1   /***************************************************************************
              4410    1    *                                                                         *
              4411    1    *                                    Auto                                 *
              4412    1    *                                                                         *
              4413    1    ***************************************************************************/

       36     4417    1   DCL MSGTYP CHAR(8);
       37     4418    1   DCL FOUND_MSGTYP CHAR(8);
       38     4419
       39     4420    1   DCL REC_OK_FLAG BIT(1) ALIGNED;
       40     4421
       41     4422    1   DCL SUBLK$ PTR;
       42     4423
       43     4424    1   DCL NSUBLKS UBIN WORD;
       44     4425    1   DCL I UBIN WORD;
       45     4426    1   DCL SUB_CODE UBIN WORD;
       46     4427    1   DCL POS UBIN WORD;
       47     4428    1   DCL TEMP UBIN WORD;
       48     4429    1   DCL CPOS UBIN WORD;
       49     4430
       50     4431    1   DCL OPTIONS_USED(0:35) BIT(1) UNAL;
       51     4432    1   DCL ALL_OPTIONS REDEF OPTIONS_USED BIT(36);
       52     4433        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:16   
              4450    1   /***************************************************************************
              4451    1    *                                                                         *
              4452    1    *                                Error codes                              *
              4453    1    *                                                                         *
              4454    1    ***************************************************************************/

       53     4458        %ERRCODE(NAME=CODE_NWH, CODE#=%E$NWH, FCG#=%FCG_QT, MID#=%MID_B);
       54     4465        %ERRCODE(NAME=CODE_AE, CODE#=%E$AE, FCG#=%FCG_QT, MID#=%MID_B);
       55     4472        %ERRCODE(NAME=CODE_CMNF, CODE#=%E$CMNF, FCG#=%FCG_QT, MID#=%MID_B);
       56     4479        %ERRCODE(NAME=CODE_AUSED, CODE#=%E$AUSED, FCG#=%FCG_QT, MID#=%MID_B);
       57     4486        %ERRCODE(NAME=CODE_FPMBOD, CODE#=%E$FPMBOD, FCG#=%FCG_QT, MID#=%MID_B);
       58     4493        %ERRCODE(NAME=CODE_BFFF, CODE#=%E$BFFF, FCG#=%FCG_QT, MID#=%MID_B);
       59     4500        %ERRCODE(NAME=CODE_NFP, CODE#=%E$NFP, FCG#=%FCG_QT, MID#=%MID_B);
       60     4507        /*E*       ERROR: QTB-E$FPMBOD-C
       61     4508
       62     4509                 MESSAGE: Forms Programs must be on disk.
       63     4510             DESCRIPTION: The FID for a FP must be a file that resides
       64     4511                          on disk.
       65     4512        */
       66     4513        /*E*       ERROR: QTB-E$BFFF-C
       67     4514
       68     4515                 MESSAGE: Invalid FID for the Forms Program
       69     4516             DESCRIPTION: The FID for the FP is not a valid FID
       70     4517        */
       71     4518        /*E*       ERROR: QTB-E$NFP-C
       72     4519
       73     4520                 MESSAGE: A Forms Program (FP) FID must be specified.
       74     4521             DESCRIPTION: You must specify a forms program for
       75     4522                          this type.  The definition for the type
       76     4523                          will not be complete without a forms program.
       77     4524        */
       78     4525        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:17   
              4542    1   /***************************************************************************
              4543    1    *                                                                         *
              4544    1    *                                    FPTs                                 *
              4545    1    *                                                                         *
              4546    1    ***************************************************************************/

       79     4550        %FPT_OPEN;
       80     4659
       81     4660        %FPT_FID(NAME=VLP_NAME, PASS=VLP_PASS, RESULTS=VLR_FID,
       82     4661        ACCT=VLP_ACCT, ASN="FPT_OPEN.V.ASN#", SN=VLP_SN,
       83     4662        RES="FPT_OPEN.V.RES#", WSN=VLP_WSN, TEXTFID=FID);
       84     4685        %PAGE(ARG="VLPs");

              4702    1   /***************************************************************************
              4703    1    *                                                                         *
              4704    1    *                                    VLPs                                 *
              4705    1    *                                                                         *
              4706    1    ***************************************************************************/

       85     4710        %VLP_NAME;
       86     4737        %VLP_PASS;
       87     4750        %VLP_ACCT;
       88     4763        %VLP_SN;
       89     4776        %VLP_WSN;
       90     4789        %PAGE(ARG="VLRs");

              4806    1   /***************************************************************************
              4807    1    *                                                                         *
              4808    1    *                                    VLRs                                 *
              4809    1    *                                                                         *
              4810    1    ***************************************************************************/

       91     4814        %VLR_FID;
       92     4833        %PAGE(ARG="QTB$CREMOD_E", PAGE=YFS);

              4850    1   /***************************************************************************
              4851    1    *                                                                         *
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:18   
              4852    1    *                                QTB$CREMOD_E                             *
              4853    1    *                                                                         *
              4854    1    ***************************************************************************/

       93     4858    1           REC_OK_FLAG = '1'B;

   4858  3 000002   400000 236003                    LDQ     -131072,DU
         3 000003   200007 756100                    STQ     REC_OK_FLAG,,AUTO

       94     4859    1           NSUBLKS = QT_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;

   4859  3 000004   000004 470400 xsym               LDP0    QT_CMDBLK+4
         3 000005   000001 236100                    LDQ     1,,PR0
         3 000006   000022 772000                    QRL     18
         3 000007   000001 136007                    SBLQ    1,DL
         3 000010   200011 756100                    STQ     NSUBLKS,,AUTO

       95     4860    1           ALL_OPTIONS = '0'B;

   4860  3 000011   200017 450100                    STZ     OPTIONS_USED,,AUTO

       96     4861
       97     4862    1           MSGTYP = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

   4862  3 000012   000003 471500                    LDP1    3,,PR0
         3 000013   100004 236100                    LDQ     4,,PR1
         3 000014   000033 772000                    QRL     27
         3 000015   000000 620006                    EAX0    0,QL
         3 000016   040100 100540                    MLR     fill='040'O
         3 000017   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         3 000020   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8

       98     4863
       99     4864    1           CALL INDEX(POS, '?', MSGTYP) ALTRET(NO_Q);

   4864  3 000021   000000 124500                    SCM     mask='000'O
         3 000022   200003 000010                    ADSC9   MSGTYP,,AUTO             cn=0,n=8
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:19   
         3 000023   000000 000001 4                  ADSC9   0                        cn=0,n=1
         3 000024   200014 000100                    ARG     POS,,AUTO
         3 000025   000035 606400 3                  TTN     NO_Q

      100     4865    1           QT_CMDBLK.MINOR_ERR = CODE_NWH;

   4865  3 000026   000027 236000 2                  LDQ     CODE_NWH
         3 000027   000001 756000 xsym               STQ     QT_CMDBLK+1

      101     4866    1           CALL XUR$ERRMSG(CODE_NWH);

   4866  3 000030   000001 630400 4                  EPPR0   1
         3 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000032   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000033   000000 011000                    NOP     0

      102     4867    1           REC_OK_FLAG = '0'B;

   4867  3 000034   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      103     4868
      104     4869    1   NO_Q:
      105     4870    1           CALL QTC$READ_TRADER(MSGTYP, 2 /* TYPE_F */, FOUND_MSGTYP)

   4870  3 000035   200005 630500       NO_Q         EPPR0   FOUND_MSGTYP,,AUTO
         3 000036   200022 450500                    STP0    OPTIONS_USED+3,,AUTO
         3 000037   000002 236000 4                  LDQ     2
         3 000040   200021 756100                    STQ     OPTIONS_USED+2,,AUTO
         3 000041   200003 631500                    EPPR1   MSGTYP,,AUTO
         3 000042   200020 451500                    STP1    OPTIONS_USED+1,,AUTO
         3 000043   200020 630500                    EPPR0   OPTIONS_USED+1,,AUTO
         3 000044   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000045   000000 701000 xent               TSX1    QTC$READ_TRADER
         3 000046   000066 702000 3                  TSX2    NOT_FOUND

      106     4871    1               ALTRET(NOT_FOUND);
      107     4872
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:20   
      108     4873    1           IF QT_CMDBLK.CODE = 3 /* CREATE_FORM */ THEN

   4873  3 000047   000005 235000 xsym               LDA     QT_CMDBLK+5
         3 000050   000003 115007                    CMPA    3,DL
         3 000051   000065 601000 3                  TNZ     s:4882

      109     4874    2             DO;

      110     4875    2               QT_CMDBLK.MINOR_ERR = CODE_AE;

   4875  3 000052   000030 236000 2                  LDQ     CODE_AE
         3 000053   000001 756000 xsym               STQ     QT_CMDBLK+1

      111     4876    2               CALL XUR$ERRMSG(CODE_AE);

   4876  3 000054   000003 630400 4                  EPPR0   3
         3 000055   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000056   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000057   000000 011000                    NOP     0

      112     4877    2               REC_OK_FLAG = '0'B;

   4877  3 000060   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      113     4878
      114     4879    2               QT$FORM = QT_FORM_C;

   4879  3 000061   000033 470400 xsym               LDP0    QT_GLOBAL+27
         3 000062   000100 100400                    MLR     fill='000'O
         3 000063   000000 000134 2                  ADSC9   QT_FORM_C                cn=0,n=92
         3 000064   000000 000134                    ADSC9   0,,PR0                   cn=0,n=92

      115     4880    2             END;

      116     4881
      117     4882    2           DO WHILE('0'B);

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:21   
   4882  3 000065   000104 710000 3                  TRA     s:4895

      118     4883
      119     4884    2   NOT_FOUND:
      120     4885    2             IF QT_CMDBLK.CODE = 13 /* MODIFY_FORM */ THEN

   4885  3 000066   000005 235000 xsym  NOT_FOUND    LDA     QT_CMDBLK+5
         3 000067   000015 115007                    CMPA    13,DL
         3 000070   000100 601000 3                  TNZ     s:4892

      121     4886    3               DO;

      122     4887    3                 QT_CMDBLK.MINOR_ERR = CODE_CMNF;

   4887  3 000071   000031 236000 2                  LDQ     CODE_CMNF
         3 000072   000001 756000 xsym               STQ     QT_CMDBLK+1

      123     4888    3                 CALL XUR$ERRMSG(CODE_CMNF);

   4888  3 000073   000004 630400 4                  EPPR0   4
         3 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000075   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000076   000000 011000                    NOP     0

      124     4889    3                 REC_OK_FLAG = '0'B;

   4889  3 000077   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      125     4890    3               END;

      126     4891
      127     4892    2             QT$FORM = QT_FORM_C;

   4892  3 000100   000033 470400 xsym               LDP0    QT_GLOBAL+27
         3 000101   000100 100400                    MLR     fill='000'O
         3 000102   000000 000134 2                  ADSC9   QT_FORM_C                cn=0,n=92
         3 000103   000000 000134                    ADSC9   0,,PR0                   cn=0,n=92
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:22   

      128     4893    2           END /* NEVER */;

      129     4894
      130     4895    2           DO I = 1 TO NSUBLKS;

   4895  3 000104   000001 235007                    LDA     1,DL
         3 000105   200012 755100                    STA     I,,AUTO
         3 000106   000307 710000 3                  TRA     LOOP+3

      131     4896    2             SUBLK$ = QT_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   4896  3 000107   000004 470400 xsym               LDP0    QT_CMDBLK+4
         3 000110   200012 720100                    LXL0    I,,AUTO
         3 000111   000003 236110                    LDQ     3,X0,PR0
         3 000112   200010 756100                    STQ     SUBLK$,,AUTO

      132     4897    2             SUB_CODE = SUBLK$ -> OUT$SYM.CODE;

   4897  3 000113   200010 471500                    LDP1    SUBLK$,,AUTO
         3 000114   100000 236100                    LDQ     0,,PR1
         3 000115   777777 376007                    ANQ     -1,DL
         3 000116   200013 756100                    STQ     SUB_CODE,,AUTO

      133     4898    2             IF OPTIONS_USED(SUB_CODE) THEN

   4898  3 000117   000000 066506                    CMPB    filb='0'B
         3 000120   200017 000001                    BDSC    OPTIONS_USED,Q,AUTO      by=0,bit=0,n=1
         3 000121   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000122   000143 600000 3                  TZE     s:4906

      134     4899    3               DO;

      135     4900    3                 CPOS = SUBLK$ -> OUT$SYM.CPOS;

   4900  3 000123   100002 235100                    LDA     2,,PR1
         3 000124   200016 755100                    STA     CPOS,,AUTO
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:23   

      136     4901    3                 CALL XUR$ERRPTR(CPOS, QT_GLOBAL.M$DO#);

   4901  3 000125   000005 236000 4                  LDQ     5
         3 000126   200021 756100                    STQ     OPTIONS_USED+2,,AUTO
         3 000127   200016 633500                    EPPR3   CPOS,,AUTO
         3 000130   200020 453500                    STP3    OPTIONS_USED+1,,AUTO
         3 000131   200020 630500                    EPPR0   OPTIONS_USED+1,,AUTO
         3 000132   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000133   000000 701000 xent               TSX1    XUR$ERRPTR
         3 000134   000000 011000                    NOP     0

      137     4902    3                 QT_CMDBLK.MINOR_ERR = CODE_AUSED;

   4902  3 000135   000032 236000 2                  LDQ     CODE_AUSED
         3 000136   000001 756000 xsym               STQ     QT_CMDBLK+1

      138     4903    3                 CALL XUR$ERRMSG(CODE_AUSED);

   4903  3 000137   000006 630400 4                  EPPR0   6
         3 000140   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000141   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000142   000000 011000                    NOP     0

      139     4904    3               END;

      140     4905
      141     4906    2             OPTIONS_USED(SUB_CODE) = '1'B;

   4906  3 000143   200013 235100                    LDA     SUB_CODE,,AUTO
         3 000144   003105 060400                    CSL     bolr='003'O
         3 000145   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         3 000146   200017 000001                    BDSC    OPTIONS_USED,A,AUTO      by=0,bit=0,n=1

      142     4907
      143     4908    3             DO CASE(SUB_CODE);

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:24   
   4908  3 000147   000013 115007                    CMPA    11,DL
         3 000150   000152 602005 3                  TNC     s:4908+3,AL
         3 000151   000304 710000 3                  TRA     LOOP
         3 000152   000304 710000 3                  TRA     LOOP
         3 000153   000165 710000 3                  TRA     s:4911
         3 000154   000304 710000 3                  TRA     LOOP
         3 000155   000304 710000 3                  TRA     LOOP
         3 000156   000304 710000 3                  TRA     LOOP
         3 000157   000304 710000 3                  TRA     LOOP
         3 000160   000304 710000 3                  TRA     LOOP
         3 000161   000304 710000 3                  TRA     LOOP
         3 000162   000304 710000 3                  TRA     LOOP
         3 000163   000247 710000 3                  TRA     s:4936
         3 000164   000266 710000 3                  TRA     s:4947

      144     4909
      145     4910    3               CASE(1 /* OPT_FP */);

      146     4911    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   4911  3 000165   200010 470500                    LDP0    SUBLK$,,AUTO
         3 000166   000003 236100                    LDQ     3,,PR0
         3 000167   200010 756100                    STQ     SUBLK$,,AUTO

      147     4912    3                 FID = SUBLK$ -> OUT$SYM.TEXT;

   4912  3 000170   200010 470500                    LDP0    SUBLK$,,AUTO
         3 000171   000004 236100                    LDQ     4,,PR0
         3 000172   000033 772000                    QRL     27
         3 000173   000000 620006                    EAX0    0,QL
         3 000174   040000 100540                    MLR     fill='040'O
         3 000175   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         3 000176   000000 000144 1                  ADSC9   FID                      cn=0,n=100

      148     4913    3                 CALL M$FID(FPT_FID) ALTRET(FP_ERR);

   4913  3 000177   000124 630400 1                  EPPR0   FPT_FID
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:25   
         3 000200   420001 713400                    CLIMB   alt,+8193
         3 000201   404400 401760                    pmme    nvectors=10
         3 000202   000217 702000 3                  TSX2    FP_ERR

      149     4914
      150     4915    3                 IF FPT_OPEN.V.ASN# ~= 1 /* FILE# */THEN

   4915  3 000203   000077 236000 1                  LDQ     FPT_OPEN+37
         3 000204   000777 376007                    ANQ     511,DL
         3 000205   000001 116007                    CMPQ    1,DL
         3 000206   000216 600000 3                  TZE     s:4922

      151     4916    4                   DO;

      152     4917    4                     QT_CMDBLK.MINOR_ERR = CODE_FPMBOD;

   4917  3 000207   000033 236000 2                  LDQ     CODE_FPMBOD
         3 000210   000001 756000 xsym               STQ     QT_CMDBLK+1

      153     4918    4                     CALL XUR$ERRMSG(CODE_FPMBOD);

   4918  3 000211   000007 630400 4                  EPPR0   7
         3 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000213   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000214   000000 011000                    NOP     0

      154     4919    4                     REC_OK_FLAG = '0'B;

   4919  3 000215   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      155     4920    4                   END;

      156     4921
      157     4922    4                 DO WHILE('0'B);

   4922  3 000216   000226 710000 3                  TRA     s:4930

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:26   
      158     4923
      159     4924    4   FP_ERR:
      160     4925    4                   QT_CMDBLK.MINOR_ERR = CODE_BFFF;

   4925  3 000217   000034 236000 2     FP_ERR       LDQ     CODE_BFFF
         3 000220   000001 756000 xsym               STQ     QT_CMDBLK+1

      161     4926    4                   CALL XUR$ERRMSG(CODE_BFFF);

   4926  3 000221   000010 630400 4                  EPPR0   8
         3 000222   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000223   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000224   000000 011000                    NOP     0

      162     4927    4                   REC_OK_FLAG = '0'B;

   4927  3 000225   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      163     4928    4                 END /* NEVER */;

      164     4929
      165     4930    3                 QT$FORM.FP.NAME = VLP_NAME;

   4930  3 000226   000033 470400 xsym               LDP0    QT_GLOBAL+27
         3 000227   000100 100400                    MLR     fill='000'O
         3 000230   000154 000040 1                  ADSC9   VLP_NAME                 cn=0,n=32
         3 000231   000002 000040                    ADSC9   2,,PR0                   cn=0,n=32

      166     4931    3                 QT$FORM.FP.ACCT = VLP_ACCT.ACCT#;

   4931  3 000232   000033 470400 xsym               LDP0    QT_GLOBAL+27
         3 000233   000166 237000 1                  LDAQ    VLP_ACCT
         3 000234   000012 755100                    STA     10,,PR0
         3 000235   000013 756100                    STQ     11,,PR0

      167     4932    3                 QT$FORM.FP.PASS = VLP_PASS.PASS#;

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:27   
   4932  3 000236   000033 470400 xsym               LDP0    QT_GLOBAL+27
         3 000237   000164 237000 1                  LDAQ    VLP_PASS
         3 000240   000014 755100                    STA     12,,PR0
         3 000241   000015 756100                    STQ     13,,PR0

      168     4933    3                 QT$FORM.FP.SN = VLP_SN.SN#(0);

   4933  3 000242   000033 470400 xsym               LDP0    QT_GLOBAL+27
         3 000243   040100 100400                    MLR     fill='040'O
         3 000244   000171 000006 1                  ADSC9   VLP_SN+1                 cn=0,n=6
         3 000245   000016 000006                    ADSC9   14,,PR0                  cn=0,n=6
         3 000246   000304 710000 3                  TRA     LOOP

      169     4934
      170     4935    3               CASE(9 /* OPT_JOURNAL */);

      171     4936    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   4936  3 000247   200010 470500                    LDP0    SUBLK$,,AUTO
         3 000250   000003 236100                    LDQ     3,,PR0
         3 000251   200010 756100                    STQ     SUBLK$,,AUTO

      172     4937    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN

   4937  3 000252   200010 470500                    LDP0    SUBLK$,,AUTO
         3 000253   000000 720100                    LXL0    0,,PR0
         3 000254   000001 100003                    CMPX0   1,DU
         3 000255   000262 601000 3                  TNZ     s:4943

      173     4938    4                   DO;

      174     4939    4                     QT$FORM.FLAGS.JOURNAL = '0'B;

   4939  3 000256   000033 471400 xsym               LDP1    QT_GLOBAL+27
         3 000257   000031 236000 xsym               LDQ     B_VECTNIL+25
         3 000260   100000 356100                    ANSQ    0,,PR1

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:28   
      175     4940    4                   END;

   4940  3 000261   000304 710000 3                  TRA     LOOP

      176     4941    3                 ELSE
      177     4942    4                   DO;

      178     4943    4                     QT$FORM.FLAGS.JOURNAL = '1'B;

   4943  3 000262   000033 471400 xsym               LDP1    QT_GLOBAL+27
         3 000263   400000 236003                    LDQ     -131072,DU
         3 000264   100000 256100                    ORSQ    0,,PR1

      179     4944    4                   END;

   4944  3 000265   000304 710000 3                  TRA     LOOP

      180     4945
      181     4946    3               CASE(10 /* OPT_ONEREPORT */);

      182     4947    3                 SUBLK$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

   4947  3 000266   200010 470500                    LDP0    SUBLK$,,AUTO
         3 000267   000003 236100                    LDQ     3,,PR0
         3 000270   200010 756100                    STQ     SUBLK$,,AUTO

      183     4948    3                 IF SUBLK$ -> OUT$SYM.CODE = 1 /* NO */ THEN

   4948  3 000271   200010 470500                    LDP0    SUBLK$,,AUTO
         3 000272   000000 720100                    LXL0    0,,PR0
         3 000273   000001 100003                    CMPX0   1,DU
         3 000274   000301 601000 3                  TNZ     s:4954

      184     4949    4                   DO;

      185     4950    4                     QT$FORM.FLAGS.ONEREPORT = '0'B;

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:29   
   4950  3 000275   000033 471400 xsym               LDP1    QT_GLOBAL+27
         3 000276   000011 236000 4                  LDQ     9
         3 000277   100000 356100                    ANSQ    0,,PR1

      186     4951    4                   END;

   4951  3 000300   000304 710000 3                  TRA     LOOP

      187     4952    3                 ELSE
      188     4953    4                   DO;

      189     4954    4                     QT$FORM.FLAGS.ONEREPORT = '1'B;

   4954  3 000301   000033 471400 xsym               LDP1    QT_GLOBAL+27
         3 000302   200000 236003                    LDQ     65536,DU
         3 000303   100000 256100                    ORSQ    0,,PR1

      190     4955    4                   END;

      191     4956
      192     4957    3             END /* CASE */;

      193     4958
      194     4959    2   LOOP:
      195     4960    2           END /* Do for each sub option */;

   4960  3 000304   200012 235100       LOOP         LDA     I,,AUTO
         3 000305   000001 035007                    ADLA    1,DL
         3 000306   200012 755100                    STA     I,,AUTO
         3 000307   200011 236100                    LDQ     NSUBLKS,,AUTO
         3 000310   200012 116100                    CMPQ    I,,AUTO
         3 000311   000107 603000 3                  TRC     s:4896

      196     4961
      197     4962    1           IF QT$FORM.FP.NAME.COUNT = 0 THEN

   4962  3 000312   000033 470400 xsym               LDP0    QT_GLOBAL+27
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:30   
         3 000313   000002 236100                    LDQ     2,,PR0
         3 000314   777000 316003                    CANQ    -512,DU
         3 000315   000325 601000 3                  TNZ     s:4969

      198     4963    2             DO;

      199     4964    2               QT_CMDBLK.MINOR_ERR = CODE_NFP;

   4964  3 000316   000035 236000 2                  LDQ     CODE_NFP
         3 000317   000001 756000 xsym               STQ     QT_CMDBLK+1

      200     4965    2               CALL XUR$ERRMSG(CODE_NFP);

   4965  3 000320   000012 630400 4                  EPPR0   10
         3 000321   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000322   000000 701000 xent               TSX1    XUR$ERRMSG
         3 000323   000000 011000                    NOP     0

      201     4966    2               REC_OK_FLAG = '0'B;

   4966  3 000324   200007 450100                    STZ     REC_OK_FLAG,,AUTO

      202     4967    2             END;

      203     4968
      204     4969    1           IF REC_OK_FLAG THEN

   4969  3 000325   200007 234100                    SZN     REC_OK_FLAG,,AUTO
         3 000326   000337 605000 3                  TPL     s:4974

      205     4970    2             DO;

      206     4971    2               CALL QTC$WRITE_TRADER(MSGTYP, 2 /* TYPE_F */);

   4971  3 000327   000002 236000 4                  LDQ     2
         3 000330   200021 756100                    STQ     OPTIONS_USED+2,,AUTO
         3 000331   200003 630500                    EPPR0   MSGTYP,,AUTO
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:31   
         3 000332   200020 450500                    STP0    OPTIONS_USED+1,,AUTO
         3 000333   200020 630500                    EPPR0   OPTIONS_USED+1,,AUTO
         3 000334   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000335   000000 701000 xent               TSX1    QTC$WRITE_TRADER
         3 000336   000000 011000                    NOP     0

      207     4972    2             END;

      208     4973
      209     4974    1           RETURN;

   4974  3 000337   000000 702200 xent               TSX2  ! X66_ARET
      210     4975
      211     4976    1   END QTB$CREMOD_F;

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:32   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   QT_SUBS_C.:E05TOU  is referenced.
   QT_MACROS_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QT_PERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   QT_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QTB$CREMOD_F.
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:33   

 **** Variables and constants ****

  ****  Section 001  Data  QTB$CREMOD_F

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(100)   r     1 FID                      124-0-0/d STRC(864)   r     1 FPT_FID
    32-0-0/d STRC(2088)  r     1 FPT_OPEN                 166-0-0/c STRC(72)    r     1 VLP_ACCT
   154-0-0/c STRC(288)   r     1 VLP_NAME                 164-0-0/c STRC(72)    r     1 VLP_PASS
   170-0-0/d STRC(90)    r     1 VLP_SN                   174-0-0/c STRC(72)    r     1 VLP_WSN
   176-0-0/d STRC(324)   r     1 VLR_FID

  ****  Section 002 RoData QTB$CREMOD_F

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    30-0-0/b STRC        r     1 CODE_AE                   32-0-0/b STRC        r     1 CODE_AUSED
    34-0-0/b STRC        r     1 CODE_BFFF                 31-0-0/b STRC        r     1 CODE_CMNF
    33-0-0/b STRC        r     1 CODE_FPMBOD               35-0-0/b STRC        r     1 CODE_NFP
    27-0-0/b STRC        r     1 CODE_NWH                   0-0-0/w STRC(828)   r     1 QT_FORM_C

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/b BIT         r     1 ALL_OPTIONS               16-0-0/w UBIN        r     1 CPOS
     5-0-0/c CHAR(8)     r     1 FOUND_MSGTYP              12-0-0/w UBIN        r     1 I
     3-0-0/c CHAR(8)     r     1 MSGTYP                    11-0-0/w UBIN        r     1 NSUBLKS
    17-0-0/b BIT         r     1 OPTIONS_USED(0:35)
    14-0-0/w UBIN        r     1 POS                        7-0-0/w BIT         r     1 REC_OK_FLAG
    10-0-0/w PTR         r     1 SUBLK$                    13-0-0/w UBIN        r     1 SUB_CODE

  ****  SYMREF variables  ****

PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:34   
  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(261)   r     1 QT_CMDBLK                  0-0-0/w STRC(1872)  r     1 QT_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(828)   r     1 QT$FORM


   Procedure QTB$CREMOD_F requires 224 words for executable code.
   Procedure QTB$CREMOD_F requires 20 words of local(AUTO) storage.

    No errors detected in file QTB$CREMOD_F.:E05TSI    .
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:35   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:36   
          MINI XREF LISTING

ALL_OPTIONS
      4432**DCL      4860<<ASSIGN
CODE_AE
      4466**DCL      4875>>ASSIGN   4876<>CALL
CODE_AUSED
      4480**DCL      4902>>ASSIGN   4903<>CALL
CODE_BFFF
      4494**DCL      4925>>ASSIGN   4926<>CALL
CODE_CMNF
      4473**DCL      4887>>ASSIGN   4888<>CALL
CODE_FPMBOD
      4487**DCL      4917>>ASSIGN   4918<>CALL
CODE_NFP
      4501**DCL      4964>>ASSIGN   4965<>CALL
CODE_NWH
      4459**DCL      4865>>ASSIGN   4866<>CALL
CPOS
      4429**DCL      4900<<ASSIGN   4901<>CALL
FID
      4327**DCL      4673--DCLINIT  4912<<ASSIGN
FOUND_MSGTYP
      4418**DCL      4870<>CALL
FPT_FID
      4673**DCL      4913<>CALL
FPT_FID.V
      4677**DCL      4673--DCLINIT
FPT_OPEN.ACSVEH_
      4617**DCL      4618--REDEF
FPT_OPEN.ALTKEYS_
      4623**DCL      4624--REDEF    4624--REDEF
FPT_OPEN.HDR_
      4622**DCL      4623--REDEF
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:37   
FPT_OPEN.TAB_
      4621**DCL      4622--REDEF
FPT_OPEN.UHL_
      4615**DCL      4616--REDEF    4616--REDEF
FPT_OPEN.V
      4624**DCL      4615--DCLINIT
FPT_OPEN.V.ASN#
      4634**DCL      4676--DCLINIT  4915>>IF
FPT_OPEN.V.FSN#
      4655**DCL      4655--REDEF    4655--REDEF
FPT_OPEN.V.RES#
      4639**DCL      4676--DCLINIT
FPT_OPEN.WSN_
      4621**DCL      4621--REDEF
FP_ERR
      4925**LABEL    4913--CALLALT
I
      4425**DCL      4895<<DOINDEX  4896>>ASSIGN
M$FID
       141**DCL-ENT  4913--CALL
MSGTYP
      4417**DCL      4862<<ASSIGN   4864>>CALLBLT  4870<>CALL     4971<>CALL
NOT_FOUND
      4885**LABEL    4870--CALLALT
NO_Q
      4870**LABEL    4864--CALLALT
NSUBLKS
      4424**DCL      4859<<ASSIGN   4895>>DOINDEX
OPTIONS_USED
      4431**DCL      4432--REDEF    4898>>IF       4906<<ASSIGN
OUT$BLK.NSUBLKS
      4275**DCL      4859>>ASSIGN
OUT$BLK.SUBLK$
      4296**DCL      4862>>ASSIGN   4862>>ASSIGN   4896>>ASSIGN   4911>>ASSIGN   4936>>ASSIGN   4947>>ASSIGN
OUT$SYM.CODE
      4232**DCL      4897>>ASSIGN   4937>>IF       4948>>IF
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:38   
OUT$SYM.COUNT
      4249**DCL      4252--IMP-SIZ  4862>>ASSIGN   4912>>ASSIGN
OUT$SYM.CPOS
      4241**DCL      4900>>ASSIGN
OUT$SYM.TEXT
      4252**DCL      4862>>ASSIGN   4912>>ASSIGN
POS
      4427**DCL      4864<<CALLBLT
QT$FORM
      4191**DCL      4879<<ASSIGN   4892<<ASSIGN
QT$FORM.FLAGS.JOURNAL
      4194**DCL      4939<<ASSIGN   4943<<ASSIGN
QT$FORM.FLAGS.ONEREPORT
      4196**DCL      4950<<ASSIGN   4954<<ASSIGN
QT$FORM.FP.ACCT
      4208**DCL      4931<<ASSIGN
QT$FORM.FP.NAME
      4204**DCL      4930<<ASSIGN
QT$FORM.FP.NAME.COUNT
      4206**DCL      4962>>IF
QT$FORM.FP.PASS
      4210**DCL      4932<<ASSIGN
QT$FORM.FP.SN
      4212**DCL      4933<<ASSIGN
QTC$READ_TRADER
      4152**DCL-ENT  4870--CALL
QTC$WRITE_TRADER
      4153**DCL-ENT  4971--CALL
QT_CMDBLK.CODE
       162**DCL      4873>>IF       4885>>IF
QT_CMDBLK.MINOR_ERR
       161**DCL      4865<<ASSIGN   4875<<ASSIGN   4887<<ASSIGN   4902<<ASSIGN   4917<<ASSIGN   4925<<ASSIGN
      4964<<ASSIGN
QT_CMDBLK.OUT$
       161**DCL       162--REDEF    4859>>ASSIGN   4862>>ASSIGN   4862>>ASSIGN   4896>>ASSIGN
QT_FORM_C
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:39   
      4364**DCL      4879>>ASSIGN   4892>>ASSIGN
QT_GLOBAL.M$DO#
       160**DCL      4901<>CALL
QT_GLOBAL.QT$FORM$
       159**DCL      4191--IMP-PTR  4879>>ASSIGN   4892>>ASSIGN   4930>>ASSIGN   4931>>ASSIGN   4932>>ASSIGN
      4933>>ASSIGN   4939>>ASSIGN   4943>>ASSIGN   4950>>ASSIGN   4954>>ASSIGN   4962>>IF
REC_OK_FLAG
      4420**DCL      4858<<ASSIGN   4867<<ASSIGN   4877<<ASSIGN   4889<<ASSIGN   4919<<ASSIGN   4927<<ASSIGN
      4966<<ASSIGN   4969>>IF
SUBLK$
      4422**DCL      4896<<ASSIGN   4897>>ASSIGN   4900>>ASSIGN   4911<<ASSIGN   4911>>ASSIGN   4912>>ASSIGN
      4912>>ASSIGN   4936<<ASSIGN   4936>>ASSIGN   4937>>IF       4947<<ASSIGN   4947>>ASSIGN   4948>>IF
SUB_CODE
      4426**DCL      4897<<ASSIGN   4898>>IF       4906>>ASSIGN   4908>>DOCASE
VLP_ACCT
      4761**DCL      4674--DCLINIT
VLP_ACCT.ACCT#
      4761**DCL      4931>>ASSIGN
VLP_NAME
      4735**DCL      4674--DCLINIT  4930>>ASSIGN
VLP_PASS
      4748**DCL      4675--DCLINIT
VLP_PASS.PASS#
      4748**DCL      4932>>ASSIGN
VLP_SN
      4774**DCL      4675--DCLINIT
VLP_SN.SN#
      4774**DCL      4933>>ASSIGN
VLP_WSN
      4787**DCL      4675--DCLINIT
VLR_FID
      4825**DCL      4677--DCLINIT
XUR$ERRMSG
      4151**DCL-ENT  4866--CALL     4876--CALL     4888--CALL     4903--CALL     4918--CALL     4926--CALL
      4965--CALL
XUR$ERRPTR
PL6.E3A0      #001=QTB$CREMOD_F File=QTB$CREMOD_F.:E05TSI                        WED 07/30/97 05:47 Page:40   
      4154**DCL-ENT  4901--CALL
