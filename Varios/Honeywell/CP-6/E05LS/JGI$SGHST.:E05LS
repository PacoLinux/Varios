VERSION E05

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:1    
        1        1        /*M* JGI$SGHST Start system and initializing ghosts*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=2,DCI=4,THI=2,CSI=2,ECI=2,STI=2,IND=2,ENI=2 */
        8        8        JGI$SGHST: PROC;
        9        9        /*D* NAME:        JGI$SGHST
       10       10             PURPOSE:     To start the initial ghosts needed at system startup
       11       11             CALL:        CALL JGI$SGHST;
       12       12             INPUT:       JC_TBOOT
       13       13                          JC_SUPER
       14       14                          JC_PHASE
       15       15                          JG_SGT  - Table of MING ghosts
       16       16             OUTPUT:      All of the MING ghosts
       17       17                          RCVR2
       18       18                          SUPER if needed
       19       19                          CONTROL and ELAN if needed
       20       20             DESCRIPTION: JGI$SGHST starts the system's ghosts. The ghosts
       21       21                          to be started on any particular call to JGI$SGHST
       22       22                          are determined by JC_PHASE. The appropriate ghosts
       23       23                          are started up, JC_WAITING is updated if the started
       24       24                          ghost is to be waited on and the procedure returns.
       25       25
       26       26                          If the particular ghost's necessary file (XEQ or RU)
       27       27                          does not exist in .:SYS, a message will be written to
       28       28                          the operator's console informing the operator of this
       29       29                          fact.
       30       30
       31       31                          If any of these ghosts cannot be started due to lack
       32       32                          of memory, JGI$SGHST will SCREECH.
       33       33        */
       34       34 S      %INCLUDE B$JIT_C;
       35       35        %INCLUDE B$ROSEG;
       36       98        %INCLUDE CP_6;
       37      179        %INCLUDE JC_MACRO_C;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:2    
       38      293        %INCLUDE JC_DATA_R;
       39      331        %INCLUDE JC_SCODE_C;
       40      347        %INCLUDE JG_DATA_R;
       41      417        %INCLUDE JG_GHOSTS_C;
       42      507        %INCLUDE OC_MESSHD_C;
       43      560        %INCLUDE OC_SUBS_C;
       44     1291
       45     1292        %SUB F_JG='1207'O;
       46     1293        %SUB M_I='11'O;
       47     1294
       48     1295        %B$JIT0;
       49     1384        %U$JIT1;
       50     1458        %M$JIT2X;
       51     1461        %F$JIT3X;
       52     1464        %S$JIT4;
       53     1470        %A$JIT6X;
       54     1473        %B$TCB;
       55     1476        %B$ALT;
       56     1484    1   DCL I UBIN WORD;
       57     1485    1   DCL M$CSCG DCB;
       58     1486    1   DCL M$GHOST DCB;
       59     1487    1   DCL JIT$ PTR;
       60     1488    1   DCL VM_UC$ PTR;
       61     1489    1   DCL VROSEG$ PTR;
       62     1490    1   DCL PP (0:2) UBIN WORD;
       63     1491    1   DCL 1 GNAME ALIGNED,
       64     1492    1         2 C UBIN BYTE UNAL,
       65     1493    1         2 T CHAR(12);
       66     1494        %OC_MESSHD_W (NAME=NOFILE_MSG,STCLASS=STATIC,
       67     1495                       MSG=NOFILE_MSG#,NPARMS=2);
       68     1508    1           2 *(0:1) UBIN BYTE UNAL INIT(12,12),
       69     1509    1             2 UNAME CHAR(12),
       70     1510    1             2 FNAME CHAR(12);
       71     1511        %VLR_NXTUSR(FPTN=VLR_NXTUSR,STCLASS=STATIC);
       72     1524    1   DCL 1 CCBUF STATIC ALIGNED,
       73     1525    1         2 C UBIN BYTE UNAL INIT(19),
       74     1526    1         2 T CHAR(19) INIT(' ');
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:3    
       75     1527    1   DCL 1 ELAN CONSTANT ALIGNED,
       76     1528    1         2 C UBIN BYTE UNAL INIT(LENGTHC('ELAN')),
       77     1529    1         2 T CHAR(12) INIT('ELAN');
       78     1530    1   DCL 1 RCVR2 CONSTANT ALIGNED,
       79     1531    1         2 C UBIN BYTE UNAL INIT(LENGTHC('RCVR2')),
       80     1532    1         2 T CHAR(12) INIT('RCVR2');
       81     1533    1   DCL 1 CONTROL CONSTANT ALIGNED,
       82     1534    1         2 C UBIN BYTE UNAL INIT(LENGTHC('CONTROL')),
       83     1535    1         2 T CHAR(12) INIT('CONTROL');
       84     1536    1   DCL CNCCB CHAR(0) CONSTANT ALIGNED INIT('CONTROL CONTROL_S');
       85     1537    1   DCL B$TCB$ PTR SYMREF;
       86     1538    1   DCL B$ROSEG$ PTR SYMREF;
       87     1539    1   DCL B$JIT$ PTR SYMREF;
       88     1540    1   DCL FOI$CRASH ENTRY(3) ALTRET;
       89     1541    1   DCL JGG$GJOB ENTRY(5);
       90     1542    1   DCL JCM$SETU ENTRY(5) ALTRET;
       91     1543    1   DCL JCM$MAKEU ENTRY(1);
       92     1544    1   DCL JC_SUPER UBIN WORD SYMREF;
       93     1545    1   DCL JC_TBOOT UBIN WORD SYMREF;
       94     1546    1   DCL 1 JG_SGHST ALIGNED SYMREF,
       95     1547    1         2 G (0:JG_MING#) BIT(1);
       96     1548        %FPT_OPEN (FPTN=OPNGT,DCB=M$GHOST,ASN=FILE,TEST=YES);
       97     1657        %FPT_WRITE (FPTN=FPT_WRKEYIN,STCLASS=CONSTANT,DCB=M$CSCG,BUF=NOFILE_MSG);
       98     1688        %FPT_NXTUSR (FPTN=FPT_NXTUSR,STCLASS=CONSTANT,RESULTS=VLR_NXTUSR);
       99     1701        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:4    
      100     1702    1           VLR_NXTUSR = '0'B;
      101     1703    1           VLR_NXTUSR.MODE = %M_GHOST#;
      102     1704    2           DO CASE(JC_PHASE);
      103     1705    2             CASE(1);
      104     1706    2               CALL STSGT(JG_SUPER#) ALTRET(SC1);
      105     1707    2             CASE(2);
      106     1708    2               CALL STSGT(JG_KEYIN#) ALTRET(SC1);
      107     1709    2               CALL STSGT(JG_PIG#) ALTRET(SC1);
      108     1710    2               CALL STSGT(JG_DINGO#) ALTRET(SC1);
      109     1711    2             CASE(3);
      110     1712    2               CALL STSGT(JG_ELF#) ALTRET(SC1);
      111     1713    2               CALL STSGT(JG_OUTSYM#) ALTRET(SC1);
      112     1714    2               CALL STSGT(JG_INSYM#) ALTRET(SC1);
      113     1715    2               CALL STSGT(JG_PRESCAN#) ALTRET(SC1);
      114     1716    2               CALL STSGT(JG_FROG#) ALTRET(SC1);
      115     1717    2             CASE(4);
      116     1718    2               CALL STSGT(JG_DOG#) ALTRET(SC1);
      117     1719    2               CALL STSGT(JG_GOOSE#) ALTRET(SC1);
      118     1720    2               CALL STSGT(JG_MAILMAN#) ALTRET(SC1);
      119     1721    2               CALL STSGT(JG_SCOTTY#) ALTRET(SC1);
      120     1722    2               CALL STSGT(JG_JAYS#) ALTRET(SC1);
      121     1723    2               OPNGT.NAME_=VECTOR(GNAME);
      122     1724    2               GNAME=RCVR2;
      123     1725    2               CALL STOGH ALTRET (SC1);    /* Start RCVR2                        */
      124     1726    2               IF JC_TBOOT~=0
      125     1727    3                 THEN DO;             /* Start CONTROL and ELAN on a tape boot   */
      126     1728    3                   GNAME=CONTROL;
      127     1729    3                   CCBUF.T=CNCCB;
      128     1730    3                   CALL STOGHC ALTRET (SC1);
      129     1731    3                   GNAME=ELAN;
      130     1732    3                   CALL STOGH ALTRET (SC1);
      131     1733    3                   END;
      132     1734    2             END;
      133     1735    1           RETURN;
      134     1736    1   SC1:    CALL FOI$CRASH (%S$NGPP,F_JG,M_I);
      135     1737        /*S*  SCREECH_CODE: JGI-S$NGPP
      136     1738              TYPE:    Screech
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:5    
      137     1739              MESSAGE: SLUG cant get pages to start initial ghosts
      138     1740              REMARKS: After SLUG starts the system ghosts he starts other initial
      139     1741                       ghosts either from his tables or the file GHOSTS.:SYS.
      140     1742                       This screech occurs if sufficient physical pages are not
      141     1743                       available for this purpose.                                   */
      142     1744        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:6    
      143     1745    1   STSGT:  PROC(USR) ALTRET;
      144     1746        /*I* NAME:        STSGT
      145     1747             PURPOSE:     To start a MING ghost in SLEAZE mode
      146     1748             CALL:        CALL STSGT(USR) ALTRET(LBL);
      147     1749                             where USR is the MING's user number
      148     1750             DESCRIPTION: STSGT starts MING number USR in SLEAZE mode. If
      149     1751                          the ghost is started successfully, that fact is noted
      150     1752                          in JG_SGHST and JC_WAITING(USR) is set if SLUG is to
      151     1753                          wait the next startup phase on a response from this
      152     1754                          ghost. If no problems occur or if the ghost's Run Unit
      153     1755                          does not exist, this procedure RETURNs.
      154     1756                          If the ghost's required file does not exist, a message
      155     1757                          will be written to the operator's console saying so.
      156     1758                          If physical pages cannot be obtained to start this
      157     1759                          ghost, the procedure ALTRETURNs.                           */
      158     1760    2   DCL USR UBIN;
      159     1761    2   DCL INDX SBIN;
      160     1762    2   DCL BOOTFLAG SBIN;
      161     1763    2   DCL CHAR$2 CHAR(2) BASED;
      162     1764        %FPT_MONINFO (FPTN=FPT_MONINFO,STCLASS=CONSTANT,MONINFO=VLR_MONINFO);
      163     1779        %VLR_MONINFO (FPTN=VLR_MONINFO,STCLASS=STATIC);
      164     1797
      165     1798
      166     1799    2           OPNGT.NAME_=VECTOR(JG_SGT.FILE(USR));
      167     1800    2           CALL M$OPEN (OPNGT) ALTRET (NSGH);
      168     1801    2           VLR_NXTUSR.SYSID=USR;
      169     1802    2           VLR_NXTUSR.USR=USR;
      170     1803    2           CALL JCM$SETU (VLR_NXTUSR.MODE,JIT$,VM_UC$,VROSEG$,PP) ALTRET (JUSTALT);
      171     1804    2           CALL JGG$GJOB (JIT$,JG_SGT.UNAME(USR),JG_SYSACCT,JG_SGT.CCBUF(USR),
              1804                    VLR_NXTUSR);
      172     1805    2           IF USR=JG_DINGO#
      173     1806    3             THEN DO;                      /* Set the BOOTFLAG string sub value  */
      174     1807    3               CALL M$MONINFO (FPT_MONINFO) ALTRET(INFOALT);
      175     1808    3               BOOTFLAG = VLR_MONINFO.BOOTFLAG#;
      176     1809    4               DO WHILE('0'B);
      177     1810    4   INFOALT:      BOOTFLAG = 0;
      178     1811    4                 END;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:7    
      179     1812    3               CALL INDEX(INDX,'nn',JIT$->B$JIT.CCBUF);
      180     1813    3               CALL BINCHAR(PINCRC(ADDR(JIT$->B$JIT.CCBUF),INDX)->CHAR$2,BOOTFLAG);
      181     1814    3               END;
      182     1815    2           VROSEG$->B$ROSEG.STREAMFILENO=B$ROSEG$->B$ROSEG.STREAMFILENO;
      183     1816    2           JIT$->B$JIT.PRIINC=JG_SGT.PRIINC(USR);
      184     1817    2           JIT$->B$JIT.CPFLAGS1 = JIT$->B$JIT.CPFLAGS1 | %CP_SLEAZE#;
      185     1818                                                /* Don't go through LOGON             */
      186     1819    2           CALL JCM$MAKEU (PP);
      187     1820    2           JG_SGHST.G(USR) = '1'B;
      188     1821    3           DO CASE(JC_PHASE);
      189     1822    3             CASE(1);
      190     1823    3               JC_WAITING(USR) = '1'B;
      191     1824    3             CASE(2);
      192     1825    3               IF USR=JG_PIG# OR USR=JG_DINGO#
      193     1826    3                 THEN JC_WAITING(USR) = '1'B;
      194     1827    3             CASE(3);
      195     1828    3               JC_WAITING(USR) = '1'B;
      196     1829    3             CASE(4);
      197     1830    3               ;
      198     1831    3             CASE(ELSE);
      199     1832    3               ;
      200     1833    3             END;
      201     1834    3           DO WHILE('0'B);
      202     1835    3   NSGH:     IF USR~=JG_MAILMAN# AND USR~=JG_SCOTTY# THEN
      203     1836    3                 CALL NOFILEMSG(JG_SGT.UNAME(USR),JG_SGT.FILE(USR));
      204     1837    3             END;
      205     1838    2           RETURN;
      206     1839    2   JUSTALT: ALTRETURN;
      207     1840    2   END STSGT;
      208     1841        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:8    
      209     1842    1   STOGH:  PROC ALTRET;
      210     1843    2           CCBUF.T=GNAME.T;
      211     1844    2   STOGHC: ENTRY ALTRET;
      212     1845    2           CALL M$OPEN (OPNGT) ALTRET (NOGH);
      213     1846    2           CALL M$NXTUSR (FPT_NXTUSR);
      214     1847    2           IF VLR_NXTUSR.ERR~=0 THEN CALL FOI$CRASH (%S$NGUSR,F_JG,M_I);
      215     1848        /*S*  SCREECH_CODE: JGI-S$NGUSR
      216     1849              TYPE:    Screech
      217     1850              MESSAGE: SLUG can't get user slots to start ghosts
      218     1851              REMARKS: After starting the system ghosts, SLUG starts others
      219     1852                       based on the state of the system.  This screech occurs
      220     1853                       when he cannot get user numbers to accomplish this */
      221     1854    2           CALL JCM$SETU (VLR_NXTUSR.MODE,JIT$,VM_UC$,VROSEG$,PP) ALTRET (ALT);
      222     1855    2           CALL JGG$GJOB (JIT$,GNAME,JG_SYSACCT,CCBUF,VLR_NXTUSR);
      223     1856    2           JIT$->B$JIT.PRIINC=2;           /* PRIO INCREMENT                     */
      224     1857    2           JIT$->B$JIT.CPFLAGS1 = JIT$->B$JIT.CPFLAGS1 | %CP_SLEAZE#;
      225     1858                                                /* Don't go through LOGON             */
      226     1859    2           CALL JCM$MAKEU (PP);
      227     1860    3           DO WHILE('0'B);
      228     1861    3   NOGH:     CALL NOFILEMSG(GNAME,GNAME);
      229     1862    3             END;
      230     1863    2           RETURN;
      231     1864    2   ALT:    ALTRETURN;
      232     1865    2   END STOGH;
      233     1866        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:9    
      234     1867    1   NOFILEMSG: PROC(UNAME,FNAME);
      235     1868        /*I* NAME:        NOFILEMSG
      236     1869             PURPOSE:     To write a message about unstarted system ghosts
      237     1870             CALL:        CALL NOFILEMSG(UNAME,FNAME);
      238     1871                             where: UNAME is the UNAME of the unstarted ghost
      239     1872                                    FNAME is the name of the causative missing file
      240     1873             DESCRIPTION: A message is output stating that ghost UNAME was not
      241     1874                          started due to FNAME not existing in :SYS.
      242     1875        */
      243     1876
      244     1877
      245     1878    2   DCL 1 UNAME,
      246     1879    2         2 L UBIN BYTE UNAL,
      247     1880    2         2 C CHAR(UNAME.L);
      248     1881    2   DCL 1 FNAME,
      249     1882    2         2 L UBIN BYTE UNAL,
      250     1883    2         2 C CHAR(FNAME.L);
      251     1884
      252     1885
      253     1886    2           NOFILE_MSG.UNAME = UNAME.C;
      254     1887    2           NOFILE_MSG.FNAME = FNAME.C;
      255     1888    2           CALL M$WRITE(FPT_WRKEYIN) ALTRET(JUSTRET);
      256     1889    2   JUSTRET: RETURN;
      257     1890    2   END NOFILEMSG;
      258     1891    1   END JGI$SGHST;

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:10   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   JG_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   JC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JGI$SGHST.

   Procedure JGI$SGHST requires 343 words for executable code.
   Procedure JGI$SGHST requires 28 words of local(AUTO) storage.

    No errors detected in file JGI$SGHST.:E05TSI    .

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:11   

 Object Unit name= JGI$SGHST                                  File name= JGI$SGHST.:E05TOU
 UTS= JUL 29 '97 23:23:30.32 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CSCG
    2   DCB   even  none     0      0  M$GHOST
    3   Data  even  none    96    140  JGI$SGHST
    4  RoData even  UTS     45     55  JGI$SGHST
    5   Proc  even  none   343    527  JGI$SGHST
    6  RoData even  none    36     44  JGI$SGHST

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        0  JGI$SGHST

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       3 FOI$CRASH
 yes     yes           Std       5 JCM$SETU
         yes           Std       5 JGG$GJOB
         yes           Std       1 JCM$MAKEU
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:12   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  JC_PHASE                              JC_WAITING
     JG_SGT                                JG_SYSACCT                            M$CSCG
     M$GHOST                               B$ROSEG$                              B$JIT$
     JC_TBOOT                              JG_SGHST                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:13   


        1        1        /*M* JGI$SGHST Start system and initializing ghosts*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DTI=2,DCI=4,THI=2,CSI=2,ECI=2,STI=2,IND=2,ENI=2 */
        8        8        JGI$SGHST: PROC;

      8  5 000000   000000 700200 xent  JGI$SGHST    TSX0  ! X66_AUTO_0
         5 000001   000034 000000                    ZERO    28,0

        9        9        /*D* NAME:        JGI$SGHST
       10       10             PURPOSE:     To start the initial ghosts needed at system startup
       11       11             CALL:        CALL JGI$SGHST;
       12       12             INPUT:       JC_TBOOT
       13       13                          JC_SUPER
       14       14                          JC_PHASE
       15       15                          JG_SGT  - Table of MING ghosts
       16       16             OUTPUT:      All of the MING ghosts
       17       17                          RCVR2
       18       18                          SUPER if needed
       19       19                          CONTROL and ELAN if needed
       20       20             DESCRIPTION: JGI$SGHST starts the system's ghosts. The ghosts
       21       21                          to be started on any particular call to JGI$SGHST
       22       22                          are determined by JC_PHASE. The appropriate ghosts
       23       23                          are started up, JC_WAITING is updated if the started
       24       24                          ghost is to be waited on and the procedure returns.
       25       25
       26       26                          If the particular ghost's necessary file (XEQ or RU)
       27       27                          does not exist in .:SYS, a message will be written to
       28       28                          the operator's console informing the operator of this
       29       29                          fact.
       30       30
       31       31                          If any of these ghosts cannot be started due to lack
       32       32                          of memory, JGI$SGHST will SCREECH.
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:14   
       33       33        */
       34       34 S      %INCLUDE B$JIT_C;
       35       35        %INCLUDE B$ROSEG;
       36       98        %INCLUDE CP_6;
       37      179        %INCLUDE JC_MACRO_C;
       38      293        %INCLUDE JC_DATA_R;
       39      331        %INCLUDE JC_SCODE_C;
       40      347        %INCLUDE JG_DATA_R;
       41      417        %INCLUDE JG_GHOSTS_C;
       42      507        %INCLUDE OC_MESSHD_C;
       43      560        %INCLUDE OC_SUBS_C;
       44     1291
       45     1292        %SUB F_JG='1207'O;
       46     1293        %SUB M_I='11'O;
       47     1294
       48     1295        %B$JIT0;
       49     1384        %U$JIT1;
       50     1458        %M$JIT2X;
       51     1461        %F$JIT3X;
       52     1464        %S$JIT4;
       53     1470        %A$JIT6X;
       54     1473        %B$TCB;
       55     1476        %B$ALT;
       56     1484    1   DCL I UBIN WORD;
       57     1485    1   DCL M$CSCG DCB;
       58     1486    1   DCL M$GHOST DCB;
       59     1487    1   DCL JIT$ PTR;
       60     1488    1   DCL VM_UC$ PTR;
       61     1489    1   DCL VROSEG$ PTR;
       62     1490    1   DCL PP (0:2) UBIN WORD;
       63     1491    1   DCL 1 GNAME ALIGNED,
       64     1492    1         2 C UBIN BYTE UNAL,
       65     1493    1         2 T CHAR(12);
       66     1494        %OC_MESSHD_W (NAME=NOFILE_MSG,STCLASS=STATIC,
       67     1495                       MSG=NOFILE_MSG#,NPARMS=2);
       68     1508    1           2 *(0:1) UBIN BYTE UNAL INIT(12,12),
       69     1509    1             2 UNAME CHAR(12),
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:15   
       70     1510    1             2 FNAME CHAR(12);
       71     1511        %VLR_NXTUSR(FPTN=VLR_NXTUSR,STCLASS=STATIC);
       72     1524    1   DCL 1 CCBUF STATIC ALIGNED,
       73     1525    1         2 C UBIN BYTE UNAL INIT(19),
       74     1526    1         2 T CHAR(19) INIT(' ');
       75     1527    1   DCL 1 ELAN CONSTANT ALIGNED,
       76     1528    1         2 C UBIN BYTE UNAL INIT(LENGTHC('ELAN')),
       77     1529    1         2 T CHAR(12) INIT('ELAN');
       78     1530    1   DCL 1 RCVR2 CONSTANT ALIGNED,
       79     1531    1         2 C UBIN BYTE UNAL INIT(LENGTHC('RCVR2')),
       80     1532    1         2 T CHAR(12) INIT('RCVR2');
       81     1533    1   DCL 1 CONTROL CONSTANT ALIGNED,
       82     1534    1         2 C UBIN BYTE UNAL INIT(LENGTHC('CONTROL')),
       83     1535    1         2 T CHAR(12) INIT('CONTROL');
       84     1536    1   DCL CNCCB CHAR(0) CONSTANT ALIGNED INIT('CONTROL CONTROL_S');
       85     1537    1   DCL B$TCB$ PTR SYMREF;
       86     1538    1   DCL B$ROSEG$ PTR SYMREF;
       87     1539    1   DCL B$JIT$ PTR SYMREF;
       88     1540    1   DCL FOI$CRASH ENTRY(3) ALTRET;
       89     1541    1   DCL JGG$GJOB ENTRY(5);
       90     1542    1   DCL JCM$SETU ENTRY(5) ALTRET;
       91     1543    1   DCL JCM$MAKEU ENTRY(1);
       92     1544    1   DCL JC_SUPER UBIN WORD SYMREF;
       93     1545    1   DCL JC_TBOOT UBIN WORD SYMREF;
       94     1546    1   DCL 1 JG_SGHST ALIGNED SYMREF,
       95     1547    1         2 G (0:JG_MING#) BIT(1);
       96     1548        %FPT_OPEN (FPTN=OPNGT,DCB=M$GHOST,ASN=FILE,TEST=YES);
       97     1657        %FPT_WRITE (FPTN=FPT_WRKEYIN,STCLASS=CONSTANT,DCB=M$CSCG,BUF=NOFILE_MSG);
       98     1688        %FPT_NXTUSR (FPTN=FPT_NXTUSR,STCLASS=CONSTANT,RESULTS=VLR_NXTUSR);
       99     1701        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:16   
      100     1702    1           VLR_NXTUSR = '0'B;

   1702  5 000002   000000 100400                    MLR     fill='000'O
         5 000003   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         5 000004   000014 000020 3                  ADSC9   VLR_NXTUSR               cn=0,n=16

      101     1703    1           VLR_NXTUSR.MODE = %M_GHOST#;

   1703  5 000005   000002 235007                    LDA     2,DL
         5 000006   000014 755000 3                  STA     VLR_NXTUSR

      102     1704    2           DO CASE(JC_PHASE);

   1704  5 000007   000000 236000 xsym               LDQ     JC_PHASE
         5 000010   000005 116007                    CMPQ    5,DL
         5 000011   000013 602006 5                  TNC     s:1704+4,QL
         5 000012   000144 710000 5                  TRA     s:1735
         5 000013   000144 710000 5                  TRA     s:1735
         5 000014   000020 710000 5                  TRA     s:1706
         5 000015   000025 710000 5                  TRA     s:1708
         5 000016   000042 710000 5                  TRA     s:1712
         5 000017   000067 710000 5                  TRA     s:1718

      103     1705    2             CASE(1);

      104     1706    2               CALL STSGT(JG_SUPER#) ALTRET(SC1);

   1706  5 000020   000001 236000 6                  LDQ     1
         5 000021   200017 756100                    STQ     GNAME+5,,AUTO
         5 000022   000152 701000 5                  TSX1    STSGT
         5 000023   000145 702000 5                  TSX2    SC1
         5 000024   000144 710000 5                  TRA     s:1735

      105     1707    2             CASE(2);

      106     1708    2               CALL STSGT(JG_KEYIN#) ALTRET(SC1);

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:17   
   1708  5 000025   000002 236000 6                  LDQ     2
         5 000026   200017 756100                    STQ     GNAME+5,,AUTO
         5 000027   000152 701000 5                  TSX1    STSGT
         5 000030   000145 702000 5                  TSX2    SC1

      107     1709    2               CALL STSGT(JG_PIG#) ALTRET(SC1);

   1709  5 000031   000003 236000 6                  LDQ     3
         5 000032   200017 756100                    STQ     GNAME+5,,AUTO
         5 000033   000152 701000 5                  TSX1    STSGT
         5 000034   000145 702000 5                  TSX2    SC1

      108     1710    2               CALL STSGT(JG_DINGO#) ALTRET(SC1);

   1710  5 000035   000005 236000 6                  LDQ     5
         5 000036   200017 756100                    STQ     GNAME+5,,AUTO
         5 000037   000152 701000 5                  TSX1    STSGT
         5 000040   000145 702000 5                  TSX2    SC1
         5 000041   000144 710000 5                  TRA     s:1735

      109     1711    2             CASE(3);

      110     1712    2               CALL STSGT(JG_ELF#) ALTRET(SC1);

   1712  5 000042   000006 236000 6                  LDQ     6
         5 000043   200017 756100                    STQ     GNAME+5,,AUTO
         5 000044   000152 701000 5                  TSX1    STSGT
         5 000045   000145 702000 5                  TSX2    SC1

      111     1713    2               CALL STSGT(JG_OUTSYM#) ALTRET(SC1);

   1713  5 000046   000007 236000 6                  LDQ     7
         5 000047   200017 756100                    STQ     GNAME+5,,AUTO
         5 000050   000152 701000 5                  TSX1    STSGT
         5 000051   000145 702000 5                  TSX2    SC1

      112     1714    2               CALL STSGT(JG_INSYM#) ALTRET(SC1);
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:18   

   1714  5 000052   000010 236000 6                  LDQ     8
         5 000053   200017 756100                    STQ     GNAME+5,,AUTO
         5 000054   000152 701000 5                  TSX1    STSGT
         5 000055   000145 702000 5                  TSX2    SC1

      113     1715    2               CALL STSGT(JG_PRESCAN#) ALTRET(SC1);

   1715  5 000056   000011 236000 6                  LDQ     9
         5 000057   200017 756100                    STQ     GNAME+5,,AUTO
         5 000060   000152 701000 5                  TSX1    STSGT
         5 000061   000145 702000 5                  TSX2    SC1

      114     1716    2               CALL STSGT(JG_FROG#) ALTRET(SC1);

   1716  5 000062   000012 236000 6                  LDQ     10
         5 000063   200017 756100                    STQ     GNAME+5,,AUTO
         5 000064   000152 701000 5                  TSX1    STSGT
         5 000065   000145 702000 5                  TSX2    SC1
         5 000066   000144 710000 5                  TRA     s:1735

      115     1717    2             CASE(4);

      116     1718    2               CALL STSGT(JG_DOG#) ALTRET(SC1);

   1718  5 000067   000013 236000 6                  LDQ     11
         5 000070   200017 756100                    STQ     GNAME+5,,AUTO
         5 000071   000152 701000 5                  TSX1    STSGT
         5 000072   000145 702000 5                  TSX2    SC1

      117     1719    2               CALL STSGT(JG_GOOSE#) ALTRET(SC1);

   1719  5 000073   000014 236000 6                  LDQ     12
         5 000074   200017 756100                    STQ     GNAME+5,,AUTO
         5 000075   000152 701000 5                  TSX1    STSGT
         5 000076   000145 702000 5                  TSX2    SC1

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:19   
      118     1720    2               CALL STSGT(JG_MAILMAN#) ALTRET(SC1);

   1720  5 000077   000015 236000 6                  LDQ     13
         5 000100   200017 756100                    STQ     GNAME+5,,AUTO
         5 000101   000152 701000 5                  TSX1    STSGT
         5 000102   000145 702000 5                  TSX2    SC1

      119     1721    2               CALL STSGT(JG_SCOTTY#) ALTRET(SC1);

   1721  5 000103   000017 236000 6                  LDQ     15
         5 000104   200017 756100                    STQ     GNAME+5,,AUTO
         5 000105   000152 701000 5                  TSX1    STSGT
         5 000106   000145 702000 5                  TSX2    SC1

      120     1722    2               CALL STSGT(JG_JAYS#) ALTRET(SC1);

   1722  5 000107   000021 236000 6                  LDQ     17
         5 000110   200017 756100                    STQ     GNAME+5,,AUTO
         5 000111   000152 701000 5                  TSX1    STSGT
         5 000112   000145 702000 5                  TSX2    SC1

      121     1723    2               OPNGT.NAME_=VECTOR(GNAME);

   1723  5 000113   000022 235000 6                  LDA     18
         5 000114   200026 452500                    STP2    @FNAME+2,,AUTO
         5 000115   200026 236100                    LDQ     @FNAME+2,,AUTO
         5 000116   000012 036003                    ADLQ    10,DU
         5 000117   000034 757000 3                  STAQ    OPNGT+6

      122     1724    2               GNAME=RCVR2;

   1724  5 000120   000100 100400                    MLR     fill='000'O
         5 000121   000004 000015 4                  ADSC9   RCVR2                    cn=0,n=13
         5 000122   200012 000015                    ADSC9   GNAME,,AUTO              cn=0,n=13

      123     1725    2               CALL STOGH ALTRET (SC1);    /* Start RCVR2                        */

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:20   
   1725  5 000123   000373 701000 5                  TSX1    STOGH
         5 000124   000145 702000 5                  TSX2    SC1

      124     1726    2               IF JC_TBOOT~=0

   1726  5 000125   000000 235000 xsym               LDA     JC_TBOOT
         5 000126   000144 600000 5                  TZE     s:1735

      125     1727    3                 THEN DO;             /* Start CONTROL and ELAN on a tape boot   */

      126     1728    3                   GNAME=CONTROL;

   1728  5 000127   000100 100400                    MLR     fill='000'O
         5 000130   000010 000015 4                  ADSC9   CONTROL                  cn=0,n=13
         5 000131   200012 000015                    ADSC9   GNAME,,AUTO              cn=0,n=13

      127     1729    3                   CCBUF.T=CNCCB;

   1729  5 000132   040000 100400                    MLR     fill='040'O
         5 000133   000014 000021 4                  ADSC9   CNCCB                    cn=0,n=17
         5 000134   000020 200023 3                  ADSC9   CCBUF                    cn=1,n=19

      128     1730    3                   CALL STOGHC ALTRET (SC1);

   1730  5 000135   000400 701000 5                  TSX1    STOGHC
         5 000136   000145 702000 5                  TSX2    SC1

      129     1731    3                   GNAME=ELAN;

   1731  5 000137   000100 100400                    MLR     fill='000'O
         5 000140   000000 000015 4                  ADSC9   ELAN                     cn=0,n=13
         5 000141   200012 000015                    ADSC9   GNAME,,AUTO              cn=0,n=13

      130     1732    3                   CALL STOGH ALTRET (SC1);

   1732  5 000142   000373 701000 5                  TSX1    STOGH
         5 000143   000145 702000 5                  TSX2    SC1
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:21   

      131     1733    3                   END;

      132     1734    2             END;

      133     1735    1           RETURN;

   1735  5 000144   000000 702200 xent               TSX2  ! X66_ARET

      134     1736    1   SC1:    CALL FOI$CRASH (%S$NGPP,F_JG,M_I);

   1736  5 000145   000026 630400 6     SC1          EPPR0   22
         5 000146   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000147   000000 701000 xent               TSX1    FOI$CRASH
         5 000150   000000 011000                    NOP     0
         5 000151   000526 710000 5                  TRA     s:1891

      135     1737        /*S*  SCREECH_CODE: JGI-S$NGPP
      136     1738              TYPE:    Screech
      137     1739              MESSAGE: SLUG cant get pages to start initial ghosts
      138     1740              REMARKS: After SLUG starts the system ghosts he starts other initial
      139     1741                       ghosts either from his tables or the file GHOSTS.:SYS.
      140     1742                       This screech occurs if sufficient physical pages are not
      141     1743                       available for this purpose.                                   */
      142     1744        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:22   
      143     1745    1   STSGT:  PROC(USR) ALTRET;

   1745  5 000152   200016 741300       STSGT        STX1  ! GNAME+4,,AUTO

      144     1746        /*I* NAME:        STSGT
      145     1747             PURPOSE:     To start a MING ghost in SLEAZE mode
      146     1748             CALL:        CALL STSGT(USR) ALTRET(LBL);
      147     1749                             where USR is the MING's user number
      148     1750             DESCRIPTION: STSGT starts MING number USR in SLEAZE mode. If
      149     1751                          the ghost is started successfully, that fact is noted
      150     1752                          in JG_SGHST and JC_WAITING(USR) is set if SLUG is to
      151     1753                          wait the next startup phase on a response from this
      152     1754                          ghost. If no problems occur or if the ghost's Run Unit
      153     1755                          does not exist, this procedure RETURNs.
      154     1756                          If the ghost's required file does not exist, a message
      155     1757                          will be written to the operator's console saying so.
      156     1758                          If physical pages cannot be obtained to start this
      157     1759                          ghost, the procedure ALTRETURNs.                           */
      158     1760    2   DCL USR UBIN;
      159     1761    2   DCL INDX SBIN;
      160     1762    2   DCL BOOTFLAG SBIN;
      161     1763    2   DCL CHAR$2 CHAR(2) BASED;
      162     1764        %FPT_MONINFO (FPTN=FPT_MONINFO,STCLASS=CONSTANT,MONINFO=VLR_MONINFO);
      163     1779        %VLR_MONINFO (FPTN=VLR_MONINFO,STCLASS=STATIC);
      164     1797
      165     1798
      166     1799    2           OPNGT.NAME_=VECTOR(JG_SGT.FILE(USR));

   1799  5 000153   200017 470500                    LDP0    @USR,,AUTO
         5 000154   000000 236100                    LDQ     0,,PR0
         5 000155   000023 402007                    MPY     19,DL
         5 000156   000031 235000 6                  LDA     25
         5 000157   000022 736000                    QLS     18
         5 000160   000032 036000 6                  ADLQ    26
         5 000161   000034 757000 3                  STAQ    OPNGT+6

      167     1800    2           CALL M$OPEN (OPNGT) ALTRET (NSGH);
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:23   

   1800  5 000162   000026 630400 3                  EPPR0   OPNGT
         5 000163   450000 713400                    CLIMB   alt,open
         5 000164   410400 401760                    pmme    nvectors=18
         5 000165   000347 702000 5                  TSX2    NSGH

      168     1801    2           VLR_NXTUSR.SYSID=USR;

   1801  5 000166   200017 470500                    LDP0    @USR,,AUTO
         5 000167   000000 235100                    LDA     0,,PR0
         5 000170   000016 755000 3                  STA     VLR_NXTUSR+2

      169     1802    2           VLR_NXTUSR.USR=USR;

   1802  5 000171   000000 235100                    LDA     0,,PR0
         5 000172   000017 755000 3                  STA     VLR_NXTUSR+3

      170     1803    2           CALL JCM$SETU (VLR_NXTUSR.MODE,JIT$,VM_UC$,VROSEG$,PP) ALTRET (JUSTALT);

   1803  5 000173   200007 631500                    EPPR1   PP,,AUTO
         5 000174   200032 451500                    STP1    @FNAME+6,,AUTO
         5 000175   200006 633500                    EPPR3   VROSEG$,,AUTO
         5 000176   200031 453500                    STP3    @FNAME+5,,AUTO
         5 000177   200005 634500                    EPPR4   VM_UC$,,AUTO
         5 000200   200030 454500                    STP4    @FNAME+4,,AUTO
         5 000201   200004 635500                    EPPR5   JIT$,,AUTO
         5 000202   200027 455500                    STP5    @FNAME+3,,AUTO
         5 000203   000033 236000 6                  LDQ     27
         5 000204   200026 756100                    STQ     @FNAME+2,,AUTO
         5 000205   200026 630500                    EPPR0   @FNAME+2,,AUTO
         5 000206   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000207   000000 701000 xent               TSX1    JCM$SETU
         5 000210   000371 702000 5                  TSX2    JUSTALT

      171     1804    2           CALL JGG$GJOB (JIT$,JG_SGT.UNAME(USR),JG_SYSACCT,JG_SGT.CCBUF(USR),
              1804                    VLR_NXTUSR);

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:24   
   1804  5 000211   200017 470500                    LDP0    @USR,,AUTO
         5 000212   000000 236100                    LDQ     0,,PR0
         5 000213   000023 402007                    MPY     19,DL
         5 000214   000000 620006                    EAX0    0,QL
         5 000215   000033 236000 6                  LDQ     27
         5 000216   200032 756100                    STQ     @FNAME+6,,AUTO
         5 000217   000000 636010                    EAQ     0,X0
         5 000220   000034 036000 6                  ADLQ    28
         5 000221   000035 235000 6                  LDA     29
         5 000222   200030 757100                    STAQ    @FNAME+4,,AUTO
         5 000223   000000 631410 xsym               EPPR1   JG_SGT,X0
         5 000224   200027 451500                    STP1    @FNAME+3,,AUTO
         5 000225   200004 633500                    EPPR3   JIT$,,AUTO
         5 000226   200026 453500                    STP3    @FNAME+2,,AUTO
         5 000227   200026 630500                    EPPR0   @FNAME+2,,AUTO
         5 000230   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000231   000000 701000 xent               TSX1    JGG$GJOB
         5 000232   000000 011000                    NOP     0

      172     1805    2           IF USR=JG_DINGO#

   1805  5 000233   200017 470500                    LDP0    @USR,,AUTO
         5 000234   000000 235100                    LDA     0,,PR0
         5 000235   000014 115007                    CMPA    12,DL
         5 000236   000262 601000 5                  TNZ     s:1815

      173     1806    3             THEN DO;                      /* Set the BOOTFLAG string sub value  */

      174     1807    3               CALL M$MONINFO (FPT_MONINFO) ALTRET(INFOALT);

   1807  5 000237   000040 630400 4                  EPPR0   FPT_MONINFO
         5 000240   420023 713400                    CLIMB   alt,+8211
         5 000241   402400 401760                    pmme    nvectors=6
         5 000242   000246 702000 5                  TSX2    INFOALT

      175     1808    3               BOOTFLAG = VLR_MONINFO.BOOTFLAG#;

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:25   
   1808  5 000243   000126 235000 3                  LDA     VLR_MONINFO+6
         5 000244   200021 755100                    STA     BOOTFLAG,,AUTO

      176     1809    4               DO WHILE('0'B);

   1809  5 000245   000247 710000 5                  TRA     s:1812

      177     1810    4   INFOALT:      BOOTFLAG = 0;

   1810  5 000246   200021 450100       INFOALT      STZ     BOOTFLAG,,AUTO

      178     1811    4                 END;

      179     1812    3               CALL INDEX(INDX,'nn',JIT$->B$JIT.CCBUF);

   1812  5 000247   200004 470500                    LDP0    JIT$,,AUTO
         5 000250   000000 120500                    SCD
         5 000251   000033 000400                    ADSC9   27,,PR0                  cn=0,n=256
         5 000252   000054 000002 4                  ADSC9   FPT_MONINFO+12           cn=0,n=2
         5 000253   200020 000100                    ARG     INDX,,AUTO
         5 000254   000256 607000 5                  TTF     s:1813
         5 000255   200020 054100                    AOS     INDX,,AUTO

      180     1813    3               CALL BINCHAR(PINCRC(ADDR(JIT$->B$JIT.CCBUF),INDX)->CHAR$2,BOOTFLAG);

   1813  5 000256   200020 235100                    LDA     INDX,,AUTO
         5 000257   000105 301500                    BTD
         5 000260   200021 000004                    NDSC9   BOOTFLAG,,AUTO           cn=0,s=lsgnf,sf=0,n=4
         5 000261   000033 030002                    NDSC9   27,A,PR0                 cn=0,s=nosgn,sf=0,n=2

      181     1814    3               END;

      182     1815    2           VROSEG$->B$ROSEG.STREAMFILENO=B$ROSEG$->B$ROSEG.STREAMFILENO;

   1815  5 000262   000000 470400 xsym               LDP0    B$ROSEG$
         5 000263   000115 720100                    LXL0    77,,PR0
         5 000264   200006 471500                    LDP1    VROSEG$,,AUTO
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:26   
         5 000265   100115 440100                    SXL0    77,,PR1

      183     1816    2           JIT$->B$JIT.PRIINC=JG_SGT.PRIINC(USR);

   1816  5 000266   200017 473500                    LDP3    @USR,,AUTO
         5 000267   300000 236100                    LDQ     0,,PR3
         5 000270   000023 402007                    MPY     19,DL
         5 000271   200004 474500                    LDP4    JIT$,,AUTO
         5 000272   000022 236006 xsym               LDQ     JG_SGT+18,QL
         5 000273   000033 736000                    QLS     27
         5 000274   400302 552140                    STBQ    194,'40'O,PR4

      184     1817    2           JIT$->B$JIT.CPFLAGS1 = JIT$->B$JIT.CPFLAGS1 | %CP_SLEAZE#;

   1817  5 000275   400143 236100                    LDQ     99,,PR4
         5 000276   000003 276000 xsym               ORQ     B_VECTNIL+3
         5 000277   400143 756100                    STQ     99,,PR4

      185     1818                                                /* Don't go through LOGON             */
      186     1819    2           CALL JCM$MAKEU (PP);

   1819  5 000300   200007 635500                    EPPR5   PP,,AUTO
         5 000301   200026 455500                    STP5    @FNAME+2,,AUTO
         5 000302   200026 630500                    EPPR0   @FNAME+2,,AUTO
         5 000303   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000304   000000 701000 xent               TSX1    JCM$MAKEU
         5 000305   000000 011000                    NOP     0

      187     1820    2           JG_SGHST.G(USR) = '1'B;

   1820  5 000306   200017 470500                    LDP0    @USR,,AUTO
         5 000307   000000 235100                    LDA     0,,PR0
         5 000310   003005 060400                    CSL     bolr='003'O
         5 000311   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000312   000000 000001 xsym               BDSC    JG_SGHST,A               by=0,bit=0,n=1

      188     1821    3           DO CASE(JC_PHASE);
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:27   

   1821  5 000313   000000 235000 xsym               LDA     JC_PHASE
         5 000314   000004 115007                    CMPA    4,DL
         5 000315   000317 602005 5                  TNC     s:1821+4,AL
         5 000316   000346 710000 5                  TRA     s:1834
         5 000317   000346 710000 5                  TRA     s:1834
         5 000320   000323 710000 5                  TRA     s:1823
         5 000321   000330 710000 5                  TRA     s:1825
         5 000322   000341 710000 5                  TRA     s:1828

      189     1822    3             CASE(1);

      190     1823    3               JC_WAITING(USR) = '1'B;

   1823  5 000323   000000 235100                    LDA     0,,PR0
         5 000324   003005 060400                    CSL     bolr='003'O
         5 000325   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000326   000000 000001 xsym               BDSC    JC_WAITING,A             by=0,bit=0,n=1
         5 000327   000346 710000 5                  TRA     s:1834

      191     1824    3             CASE(2);

      192     1825    3               IF USR=JG_PIG# OR USR=JG_DINGO#

   1825  5 000330   000000 235100                    LDA     0,,PR0
         5 000331   000007 115007                    CMPA    7,DL
         5 000332   000335 600000 5                  TZE     s:1826
         5 000333   000014 115007                    CMPA    12,DL
         5 000334   000346 601000 5                  TNZ     s:1834

      193     1826    3                 THEN JC_WAITING(USR) = '1'B;

   1826  5 000335   003005 060400                    CSL     bolr='003'O
         5 000336   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000337   000000 000001 xsym               BDSC    JC_WAITING,A             by=0,bit=0,n=1
         5 000340   000346 710000 5                  TRA     s:1834

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:28   
      194     1827    3             CASE(3);

      195     1828    3               JC_WAITING(USR) = '1'B;

   1828  5 000341   000000 235100                    LDA     0,,PR0
         5 000342   003005 060400                    CSL     bolr='003'O
         5 000343   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         5 000344   000000 000001 xsym               BDSC    JC_WAITING,A             by=0,bit=0,n=1
         5 000345   000346 710000 5                  TRA     s:1834

      196     1829    3             CASE(4);

      197     1830    3               ;
      198     1831    3             CASE(ELSE);

      199     1832    3               ;
      200     1833    3             END;

      201     1834    3           DO WHILE('0'B);

   1834  5 000346   000367 710000 5                  TRA     s:1838

      202     1835    3   NSGH:     IF USR~=JG_MAILMAN# AND USR~=JG_SCOTTY# THEN

   1835  5 000347   200017 470500       NSGH         LDP0    @USR,,AUTO
         5 000350   000000 235100                    LDA     0,,PR0
         5 000351   000013 115007                    CMPA    11,DL
         5 000352   000367 600000 5                  TZE     s:1838
         5 000353   000017 115007                    CMPA    15,DL
         5 000354   000367 600000 5                  TZE     s:1838

      203     1836    3                 CALL NOFILEMSG(JG_SGT.UNAME(USR),JG_SGT.FILE(USR));

   1836  5 000355   000000 236100                    LDQ     0,,PR0
         5 000356   000023 402007                    MPY     19,DL
         5 000357   000000 620006                    EAX0    0,QL
         5 000360   000022 736000                    QLS     18
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:29   
         5 000361   000032 036000 6                  ADLQ    26
         5 000362   200024 756100                    STQ     @UNAME+1,,AUTO
         5 000363   000000 631410 xsym               EPPR1   JG_SGT,X0
         5 000364   200023 451500                    STP1    BOOTFLAG+2,,AUTO
         5 000365   000477 701000 5                  TSX1    NOFILEMSG
         5 000366   000000 011000                    NOP     0

      204     1837    3             END;

      205     1838    2           RETURN;

   1838  5 000367   200016 221300                    LDX1  ! GNAME+4,,AUTO
         5 000370   000001 702211                    TSX2  ! 1,X1

      206     1839    2   JUSTALT: ALTRETURN;

   1839  5 000371   200016 221300       JUSTALT      LDX1  ! GNAME+4,,AUTO
         5 000372   000000 702211                    TSX2  ! 0,X1

      207     1840    2   END STSGT;
      208     1841        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:30   
      209     1842    1   STOGH:  PROC ALTRET;

   1842  5 000373   200016 741300       STOGH        STX1  ! GNAME+4,,AUTO

      210     1843    2           CCBUF.T=GNAME.T;

   1843  5 000374   040000 100500                    MLR     fill='040'O
         5 000375   200012 200014                    ADSC9   GNAME,,AUTO              cn=1,n=12
         5 000376   000020 200023 3                  ADSC9   CCBUF                    cn=1,n=19
         5 000377   000401 710000 5                  TRA     s:1845

      211     1844    2   STOGHC: ENTRY ALTRET;

   1844  5 000400   200016 741300       STOGHC       STX1  ! GNAME+4,,AUTO

      212     1845    2           CALL M$OPEN (OPNGT) ALTRET (NOGH);

   1845  5 000401   000026 630400 3                  EPPR0   OPNGT
         5 000402   450000 713400                    CLIMB   alt,open
         5 000403   410400 401760                    pmme    nvectors=18
         5 000404   000465 702000 5                  TSX2    NOGH

      213     1846    2           CALL M$NXTUSR (FPT_NXTUSR);

   1846  5 000405   000036 630400 4                  EPPR0   FPT_NXTUSR
         5 000406   020005 713400                    CLIMB   8197
         5 000407   400000 401760                    pmme    nvectors=1

      214     1847    2           IF VLR_NXTUSR.ERR~=0 THEN CALL FOI$CRASH (%S$NGUSR,F_JG,M_I);

   1847  5 000410   000015 235000 3                  LDA     VLR_NXTUSR+1
         5 000411   000416 600000 5                  TZE     s:1854

   1847  5 000412   000037 630400 6                  EPPR0   31
         5 000413   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000414   000000 701000 xent               TSX1    FOI$CRASH
         5 000415   000000 011000                    NOP     0
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:31   

      215     1848        /*S*  SCREECH_CODE: JGI-S$NGUSR
      216     1849              TYPE:    Screech
      217     1850              MESSAGE: SLUG can't get user slots to start ghosts
      218     1851              REMARKS: After starting the system ghosts, SLUG starts others
      219     1852                       based on the state of the system.  This screech occurs
      220     1853                       when he cannot get user numbers to accomplish this */
      221     1854    2           CALL JCM$SETU (VLR_NXTUSR.MODE,JIT$,VM_UC$,VROSEG$,PP) ALTRET (ALT);

   1854  5 000416   200007 630500                    EPPR0   PP,,AUTO
         5 000417   200032 450500                    STP0    @FNAME+6,,AUTO
         5 000420   200006 631500                    EPPR1   VROSEG$,,AUTO
         5 000421   200031 451500                    STP1    @FNAME+5,,AUTO
         5 000422   200005 633500                    EPPR3   VM_UC$,,AUTO
         5 000423   200030 453500                    STP3    @FNAME+4,,AUTO
         5 000424   200004 634500                    EPPR4   JIT$,,AUTO
         5 000425   200027 454500                    STP4    @FNAME+3,,AUTO
         5 000426   000033 236000 6                  LDQ     27
         5 000427   200026 756100                    STQ     @FNAME+2,,AUTO
         5 000430   200026 630500                    EPPR0   @FNAME+2,,AUTO
         5 000431   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000432   000000 701000 xent               TSX1    JCM$SETU
         5 000433   000475 702000 5                  TSX2    ALT

      222     1855    2           CALL JGG$GJOB (JIT$,GNAME,JG_SYSACCT,CCBUF,VLR_NXTUSR);

   1855  5 000434   000033 236000 6                  LDQ     27
         5 000435   200032 756100                    STQ     @FNAME+6,,AUTO
         5 000436   000042 237000 6                  LDAQ    34
         5 000437   200030 757100                    STAQ    @FNAME+4,,AUTO
         5 000440   200012 630500                    EPPR0   GNAME,,AUTO
         5 000441   200027 450500                    STP0    @FNAME+3,,AUTO
         5 000442   200004 631500                    EPPR1   JIT$,,AUTO
         5 000443   200026 451500                    STP1    @FNAME+2,,AUTO
         5 000444   200026 630500                    EPPR0   @FNAME+2,,AUTO
         5 000445   000023 631400 xsym               EPPR1   B_VECTNIL+19
         5 000446   000000 701000 xent               TSX1    JGG$GJOB
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:32   
         5 000447   000000 011000                    NOP     0

      223     1856    2           JIT$->B$JIT.PRIINC=2;           /* PRIO INCREMENT                     */

   1856  5 000450   200004 470500                    LDP0    JIT$,,AUTO
         5 000451   002000 236003                    LDQ     1024,DU
         5 000452   000302 552140                    STBQ    194,'40'O,PR0

      224     1857    2           JIT$->B$JIT.CPFLAGS1 = JIT$->B$JIT.CPFLAGS1 | %CP_SLEAZE#;

   1857  5 000453   000143 236100                    LDQ     99,,PR0
         5 000454   000003 276000 xsym               ORQ     B_VECTNIL+3
         5 000455   000143 756100                    STQ     99,,PR0

      225     1858                                                /* Don't go through LOGON             */
      226     1859    2           CALL JCM$MAKEU (PP);

   1859  5 000456   200007 631500                    EPPR1   PP,,AUTO
         5 000457   200026 451500                    STP1    @FNAME+2,,AUTO
         5 000460   200026 630500                    EPPR0   @FNAME+2,,AUTO
         5 000461   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000462   000000 701000 xent               TSX1    JCM$MAKEU
         5 000463   000000 011000                    NOP     0

      227     1860    3           DO WHILE('0'B);

   1860  5 000464   000473 710000 5                  TRA     s:1863

      228     1861    3   NOGH:     CALL NOFILEMSG(GNAME,GNAME);

   1861  5 000465   200012 630500       NOGH         EPPR0   GNAME,,AUTO
         5 000466   200024 450500                    STP0    @UNAME+1,,AUTO
         5 000467   200012 631500                    EPPR1   GNAME,,AUTO
         5 000470   200023 451500                    STP1    BOOTFLAG+2,,AUTO
         5 000471   000477 701000 5                  TSX1    NOFILEMSG
         5 000472   000000 011000                    NOP     0

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:33   
      229     1862    3             END;

      230     1863    2           RETURN;

   1863  5 000473   200016 221300                    LDX1  ! GNAME+4,,AUTO
         5 000474   000001 702211                    TSX2  ! 1,X1

      231     1864    2   ALT:    ALTRETURN;

   1864  5 000475   200016 221300       ALT          LDX1  ! GNAME+4,,AUTO
         5 000476   000000 702211                    TSX2  ! 0,X1

      232     1865    2   END STOGH;
      233     1866        %EJECT;
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:34   
      234     1867    1   NOFILEMSG: PROC(UNAME,FNAME);

   1867  5 000477   200022 741300       NOFILEMSG    STX1  ! BOOTFLAG+1,,AUTO

      235     1868        /*I* NAME:        NOFILEMSG
      236     1869             PURPOSE:     To write a message about unstarted system ghosts
      237     1870             CALL:        CALL NOFILEMSG(UNAME,FNAME);
      238     1871                             where: UNAME is the UNAME of the unstarted ghost
      239     1872                                    FNAME is the name of the causative missing file
      240     1873             DESCRIPTION: A message is output stating that ghost UNAME was not
      241     1874                          started due to FNAME not existing in :SYS.
      242     1875        */
      243     1876
      244     1877
      245     1878    2   DCL 1 UNAME,
      246     1879    2         2 L UBIN BYTE UNAL,
      247     1880    2         2 C CHAR(UNAME.L);
      248     1881    2   DCL 1 FNAME,
      249     1882    2         2 L UBIN BYTE UNAL,
      250     1883    2         2 C CHAR(FNAME.L);
      251     1884
      252     1885
      253     1886    2           NOFILE_MSG.UNAME = UNAME.C;

   1886  5 000500   200023 470500                    LDP0    @UNAME,,AUTO
         5 000501   000100 101500                    MRL     fill='000'O
         5 000502   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         5 000503   200026 000002                    ADSC9   @FNAME+2,,AUTO           cn=0,n=2
         5 000504   200026 220100                    LDX0    @FNAME+2,,AUTO
         5 000505   040000 100540                    MLR     fill='040'O
         5 000506   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         5 000507   000005 400014 3                  ADSC9   NOFILE_MSG+5             cn=2,n=12

      254     1887    2           NOFILE_MSG.FNAME = FNAME.C;

   1887  5 000510   200024 471500                    LDP1    @FNAME,,AUTO
         5 000511   000100 101500                    MRL     fill='000'O
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:35   
         5 000512   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         5 000513   200026 000002                    ADSC9   @FNAME+2,,AUTO           cn=0,n=2
         5 000514   200026 220100                    LDX0    @FNAME+2,,AUTO
         5 000515   040000 100540                    MLR     fill='040'O
         5 000516   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         5 000517   000010 400014 3                  ADSC9   NOFILE_MSG+8             cn=2,n=12

      255     1888    2           CALL M$WRITE(FPT_WRKEYIN) ALTRET(JUSTRET);

   1888  5 000520   000022 630400 4                  EPPR0   FPT_WRKEYIN
         5 000521   440001 713400                    CLIMB   alt,write
         5 000522   401400 401760                    pmme    nvectors=4
         5 000523   000524 702000 5                  TSX2    JUSTRET

      256     1889    2   JUSTRET: RETURN;

   1889  5 000524   200022 221300       JUSTRET      LDX1  ! BOOTFLAG+1,,AUTO
         5 000525   000001 702211                    TSX2  ! 1,X1

      257     1890    2   END NOFILEMSG;
      258     1891    1   END JGI$SGHST;

   1891  5 000526   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:36   
--  Include file information  --

   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   OC$MESSHD_C.:E05TOU  is referenced.
   JG_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_SCODE_C.:E05TOU  is referenced.
   JC_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   JC_MACRO_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure JGI$SGHST.
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:37   

 **** Variables and constants ****

  ****  Section 003  Data  JGI$SGHST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    20-0-0/w STRC(180)   r     1 CCBUF                      0-0-0/c STRC(414)   r     1 NOFILE_MSG
    26-0-0/d STRC(2088)  r     1 OPNGT                    120-0-0/d STRC(540)   r     1 VLR_MONINFO
    14-0-0/d STRC(144)   r     1 VLR_NXTUSR

  ****  Section 004 RoData JGI$SGHST

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    14-0-0/w CHAR(17)    r     1 CNCCB                     10-0-0/w STRC(117)   r     1 CONTROL
     0-0-0/w STRC(117)   r     1 ELAN                      40-0-0/d STRC(432)   r     1 FPT_MONINFO
    36-0-0/d STRC(72)    r     1 FPT_NXTUSR                22-0-0/d STRC(432)   r     1 FPT_WRKEYIN
     4-0-0/w STRC(117)   r     1 RCVR2

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    24-0-0/w PTR         r     1 @FNAME                    23-0-0/w PTR         r     1 @UNAME
    17-0-0/w PTR         r     1 @USR                      21-0-0/w SBIN        r     1 BOOTFLAG
    *0-0-0/c ASTR(9)     r     1 FNAME                     12-0-0/w STRC(117)   r     1 GNAME
    20-0-0/w SBIN        r     1 INDX                       4-0-0/w PTR         r     1 JIT$
     7-0-0/w UBIN        r     1 PP(0:2)                   *0-0-0/c ASTR(9)     r     1 UNAME
    *0-0-0/w UBIN        r     1 USR                        5-0-0/w PTR         r     1 VM_UC$
     6-0-0/w PTR         r     1 VROSEG$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:38   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$ROSEG$
     0-0-0/w UBIN        r     1 JC_PHASE                   0-0-0/w UBIN        r     1 JC_TBOOT
     0-0-0/b BIT         r     1 JC_WAITING(0:35)
     0-0-0/w STRC(16)    r     1 JG_SGHST                   0-0-0/w STRC(684)   r     1 JG_SGT(0:0)
     0-0-0/c CHAR(8)     r     1 JG_SYSACCT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8568)  r     1 B$JIT                      0-0-0/d STRC(3024)  r     1 B$ROSEG
     0-0-0/c CHAR(2)     r     1 CHAR$2                     0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$GHOST


   Procedure JGI$SGHST requires 343 words for executable code.
   Procedure JGI$SGHST requires 28 words of local(AUTO) storage.

    No errors detected in file JGI$SGHST.:E05TSI    .
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:40   
          MINI XREF LISTING

ALT IN PROCEDURE STOGH
      1864**LABEL    1854--CALLALT
B$ALT.CODE
      1478**DCL      1478--REDEF    1479--REDEF    1479--REDEF
B$ALT.ERR.ERR#
      1480**DCL      1480--REDEF
B$ALT.EVID
      1479**DCL      1479--REDEF    1479--REDEF
B$JIT.CCBUF
      1389**DCL      1812>>CALLBLT  1813--CALLBLT
B$JIT.CPFLAGS1
      1390**DCL      1817<<ASSIGN   1817>>ASSIGN   1857<<ASSIGN   1857>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      1395**DCL      1395--REDEF
B$JIT.ERR.MID
      1302**DCL      1302--REDEF
B$JIT.PNR
      1467**DCL      1467--REDEF
B$JIT.PRIINC
      1467**DCL      1816<<ASSIGN   1856<<ASSIGN
B$JIT$
      1539**DCL      1296--IMP-PTR
B$ROSEG.STREAMFILENO
        76**DCL      1815<<ASSIGN   1815>>ASSIGN
B$ROSEG$
      1538**DCL      1815>>ASSIGN
BOOTFLAG IN PROCEDURE STSGT
      1762**DCL      1808<<ASSIGN   1810<<ASSIGN   1813>>CALLBLT
CCBUF
      1524**DCL      1855<>CALL
CCBUF.T
      1526**DCL      1729<<ASSIGN   1843<<ASSIGN
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:41   
CHAR$2 IN PROCEDURE STSGT
      1763**DCL      1813<<CALLBLT
CNCCB
      1536**DCL      1729>>ASSIGN
CONTROL
      1533**DCL      1728>>ASSIGN
ELAN
      1527**DCL      1731>>ASSIGN
FNAME IN PROCEDURE NOFILEMSG
      1881**DCL      1867--PROC
FNAME.C IN PROCEDURE NOFILEMSG
      1883**DCL      1887>>ASSIGN
FNAME.L IN PROCEDURE NOFILEMSG
      1882**DCL      1883--IMP-SIZ  1887>>ASSIGN
FOI$CRASH
      1540**DCL-ENT  1736--CALL     1847--CALL
FPT_MONINFO IN PROCEDURE STSGT
      1775**DCL      1807<>CALL
FPT_NXTUSR
      1699**DCL      1846<>CALL
FPT_WRKEYIN
      1674**DCL      1888<>CALL
FPT_WRKEYIN.STATION_
      1676**DCL      1676--REDEF
FPT_WRKEYIN.V
      1677**DCL      1674--DCLINIT
FPT_WRKEYIN.V.DVBYTE.VFC#
      1683**DCL      1683--REDEF
GNAME
      1491**DCL      1723--ASSIGN   1724<<ASSIGN   1728<<ASSIGN   1731<<ASSIGN   1855<>CALL     1861<>CALL
      1861<>CALL
GNAME.T
      1493**DCL      1843>>ASSIGN
INDX IN PROCEDURE STSGT
      1761**DCL      1812<<CALLBLT  1813>>CALLBLT
INFOALT IN PROCEDURE STSGT
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:42   
      1810**LABEL    1807--CALLALT
JCM$MAKEU
      1543**DCL-ENT  1819--CALL     1859--CALL
JCM$SETU
      1542**DCL-ENT  1803--CALL     1854--CALL
JC_PHASE
       301**DCL      1704>>DOCASE   1821>>DOCASE
JC_TBOOT
      1545**DCL      1726>>IF
JC_WAITING
       301**DCL      1823<<ASSIGN   1826<<ASSIGN   1828<<ASSIGN
JGG$GJOB
      1541**DCL-ENT  1804--CALL     1855--CALL
JG_KRSP.FLAGS
       401**DCL       402--REDEF
JG_KRSP.MSGID
       397**DCL       398--REDEF
JG_KRSP.WSN
       404**DCL       405--REDEF
JG_SGHST.G
      1547**DCL      1820<<ASSIGN
JG_SGT.CCBUF
       387**DCL      1804<>CALL
JG_SGT.FILE
       384**DCL      1799--ASSIGN   1836<>CALL
JG_SGT.PRIINC
       390**DCL      1816>>ASSIGN
JG_SGT.UNAME
       381**DCL      1804<>CALL     1836<>CALL
JG_SYSACCT
       392**DCL      1804<>CALL     1855<>CALL
JIT$
      1487**DCL      1803<>CALL     1804<>CALL     1812>>CALLBLT  1813>>CALLBLT  1816>>ASSIGN   1817>>ASSIGN
      1817>>ASSIGN   1854<>CALL     1855<>CALL     1856>>ASSIGN   1857>>ASSIGN   1857>>ASSIGN
JUSTALT IN PROCEDURE STSGT
      1839**LABEL    1803--CALLALT
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:43   
JUSTRET IN PROCEDURE NOFILEMSG
      1889**LABEL    1888--CALLALT
M$MONINFO
       175**DCL-ENT  1807--CALL
M$NXTUSR
       173**DCL-ENT  1846--CALL
M$OPEN
       107**DCL-ENT  1800--CALL     1845--CALL
M$WRITE
       108**DCL-ENT  1888--CALL
NOFILEMSG
      1867**PROC     1836--CALL     1861--CALL
NOFILE_MSG
      1496**DCL      1675--DCLINIT  1676--DCLINIT
NOFILE_MSG.FLAGS
      1503**DCL      1504--REDEF
NOFILE_MSG.FNAME
      1510**DCL      1887<<ASSIGN
NOFILE_MSG.MSGID
      1499**DCL      1500--REDEF
NOFILE_MSG.UNAME
      1509**DCL      1886<<ASSIGN
NOGH IN PROCEDURE STOGH
      1861**LABEL    1845--CALLALT
NSGH IN PROCEDURE STSGT
      1835**LABEL    1800--CALLALT
OPNGT
      1613**DCL      1800<>CALL     1845<>CALL
OPNGT.ACSVEH_
      1615**DCL      1616--REDEF
OPNGT.ALTKEYS_
      1621**DCL      1622--REDEF    1622--REDEF
OPNGT.HDR_
      1620**DCL      1621--REDEF
OPNGT.NAME_
      1614**DCL      1723<<ASSIGN   1799<<ASSIGN
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:44   
OPNGT.TAB_
      1619**DCL      1620--REDEF
OPNGT.UHL_
      1613**DCL      1614--REDEF    1614--REDEF
OPNGT.V
      1622**DCL      1613--DCLINIT
OPNGT.V.FSN#
      1653**DCL      1653--REDEF    1653--REDEF
OPNGT.WSN_
      1619**DCL      1619--REDEF
PP
      1490**DCL      1803<>CALL     1819<>CALL     1854<>CALL     1859<>CALL
RCVR2
      1530**DCL      1724>>ASSIGN
SC1
      1736**LABEL    1706--CALLALT  1708--CALLALT  1709--CALLALT  1710--CALLALT  1712--CALLALT  1713--CALLALT
      1714--CALLALT  1715--CALLALT  1716--CALLALT  1718--CALLALT  1719--CALLALT  1720--CALLALT  1721--CALLALT
      1722--CALLALT  1725--CALLALT  1730--CALLALT  1732--CALLALT
STOGH
      1842**PROC     1725--CALL     1732--CALL
STOGHC IN PROCEDURE STOGH
      1844**ENTRY    1730--CALL
STSGT
      1745**PROC     1706--CALL     1708--CALL     1709--CALL     1710--CALL     1712--CALL     1713--CALL
      1714--CALL     1715--CALL     1716--CALL     1718--CALL     1719--CALL     1720--CALL     1721--CALL
      1722--CALL
UNAME IN PROCEDURE NOFILEMSG
      1878**DCL      1867--PROC
UNAME.C IN PROCEDURE NOFILEMSG
      1880**DCL      1886>>ASSIGN
UNAME.L IN PROCEDURE NOFILEMSG
      1879**DCL      1880--IMP-SIZ  1886>>ASSIGN
USR IN PROCEDURE STSGT
      1760**DCL      1745--PROC     1799>>ASSIGN   1801>>ASSIGN   1802>>ASSIGN   1804>>CALL     1804>>CALL
      1805>>IF       1816>>ASSIGN   1820>>ASSIGN   1823>>ASSIGN   1825>>IF       1825>>IF       1826>>ASSIGN
      1828>>ASSIGN   1835>>IF       1835>>IF       1836>>CALL     1836>>CALL
PL6.E3A0      #001=JGI$SGHST File=JGI$SGHST.:E05TSI                              TUE 07/29/97 23:23 Page:45   
VLR_MONINFO IN PROCEDURE STSGT
      1790**DCL      1775--DCLINIT
VLR_MONINFO.BOOTFLAG# IN PROCEDURE STSGT
      1792**DCL      1808>>ASSIGN
VLR_NXTUSR
      1522**DCL      1699--DCLINIT  1702<<ASSIGN   1804<>CALL     1855<>CALL
VLR_NXTUSR.ERR
      1522**DCL      1847>>IF
VLR_NXTUSR.MODE
      1522**DCL      1703<<ASSIGN   1803<>CALL     1854<>CALL
VLR_NXTUSR.SYSID
      1522**DCL      1801<<ASSIGN
VLR_NXTUSR.USR
      1522**DCL      1802<<ASSIGN
VM_UC$
      1488**DCL      1803<>CALL     1854<>CALL
VROSEG$
      1489**DCL      1803<>CALL     1815>>ASSIGN   1854<>CALL
