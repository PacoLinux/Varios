VERSION E05

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:1    
        1        1        /*M*  DDD$SUBREF - BUILDS DATA DESC ITEMS FOR A SUBSCRIPT REF */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB = '1'B;
        9        9        /*P*  NAME: DDD$SUBREF
       10       10              PURPOSE: BUILDS THE DATA DESCRIPTOR ITEMS FOR A SUBSCRIPT
       11       11                  REFERENCE (LIST OF SUBSCRIPTS).
       12       12              DESCRIPTION: OPERATES ON M$PARSE OUTPUT TREE TO PRODUCE
       13       13                  DATA DESCRIPTOR ITEMS IN THE VARIABLE REFERENCE
       14       14                  DATA DESCRIPTOR FOR A SUBSCRIPT REFERENCE.  THESE ITEMS
       15       15                  DESCRIBE THE ONE OR MORE (IF MULTIPLY DIMENSIONED) INDEX
       16       16                  VALUES IN THE VARIABLE REFERENCE.  EACH INDEX CAN BE A
       17       17                  POSSIBLY POINTER QUALIFIED, POSSIBLY SUBSCRIPTED VARIABLE,
       18       18                  THEREFORE DDD$SUBREF MAKES RECURSIVE CALLS TO THE
       19       19                  ROUTINE DDD$PQLIST AND ITSELF TO CREATE THE ADDITIONAL
       20       20                  ITEMS NECCESSARY TO DESCRIBE EACH INDEX REFERENCE. */
       21       21        /*D*  NAME: DDD$SUBREF
       22       22              CALL: DDD$SUBREF(SUBREF$, RANGE_FLAG, DIM_CNT, MULT) ALTRET
       23       23              INTERFACE: CALLS DDD$PQLIST, DDD$SUBREF, DDD$BUMP_PTR, DDD$MULT,
       24       24                       DDS$V_SRCH, DDS$UD_SRCH.
       25       25              INPUT: SUBREF$ - PARM1 - PTR TO NODE IN M$PARSE OUTPUT TREE
       26       26                                      WHICH IS THE ROOT OF THE SUBSCRIPT
       27       27                                      REFERENCE SPECIFICATION (SUBREF_CODE).
       28       28                     S_D.D$ - GLOBAL STATIC - PTR TO NEXT ITEM SLOT IN
       29       29                                      CURRENT DATA DESCRIPTOR.
       30       30                     RANGE_FLAG - PARM2 - SET TO INDICATE THAT ONE OR TWO
       31       31                                      OF THE INDEX REFERENCES SPECIFIES A
       32       32                                      A RANGE OF VALUES. (MORE THAN TWO IS
       33       33                                      AN ERROR.)
       34       34                     DIM_CNT - PARM3 - SET TO THE NUMBER OF INDEX REFERENCES
       35       35                                      FOUND.
       36       36                     MULT(0:DIM_CNT) - PARM4 - ARRAY OF PTRs TO MULTIPLIER
       37       37                                      ITEMS IN THE DATA DESCRIPTOR BUILT
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:2    
       38       38                                      FOR THIS SET OF INDEX REFERENCES.
       39       39                     @ S_D.D$ - BUILDS DATA DESCRIPTOR ITEMS.
       40       40                     S_D.ERROR - SET TO INDICATE ERROR IF ALTRETURN.
       41       41                     S_D.ERROR_SYM$ - SET TO SYMBOL TEXTC FOR SOME ERRORS.
       42       42                                                          */
       43       43        DDD$SUBREF: PROC(SUBREF$,RANGE_FLAG,DIM_CNT,MULT) ALTRET;
       44       44          /* PARMS */
       45       45    1   DCL SUBREF$ PTR;
       46       46    1   DCL RANGE_FLAG BIT(1) ALIGNED;
       47       47    1   DCL DIM_CNT SBIN;
       48       48    1   DCL MULT(0:6) PTR;
       49       49          /* LOCALS */
       50       50    1   DCL DIM_CNTM1 SBIN;
       51       51    1   DCL MY_RANGE_FLAG BIT(1);
       52       52    1   DCL MY_DIM_CNT SBIN;
       53       53    1   DCL DIMS UBIN;
       54       54    1   DCL MY_MULT(0:6) PTR;
       55       55    1   DCL ARRAYTYP UBIN;
       56       56    1   DCL BASED_FLAG BIT(1) ALIGNED;
       57       57    1   DCL ARRAY_FLAG BIT(1);
       58       58    1   DCL XQUAL BIT(1);
       59       59    1   DCL I$ PTR;
       60       60    1   DCL TEMP$ PTR;
       61       61    1   DCL SYM$ PTR;
       62       62    1   DCL SYM2$ PTR;
       63       63    1   DCL SIZE SBIN;
       64       64    1   DCL IDX_LOOP SBIN;
       65       65    1   DCL IDX_ICODE SBIN;
       66       66    1   DCL TEMP1 SBIN;
       67       67    1   DCL CHAR$1 CHAR(1) BASED UNAL;
       68       68    1   DCL MINUS BIT(1);
       69       69    1   DCL TSIZ UBIN;
       70       70    1   DCL ACCUM UBIN;
       71       71    1   DCL IX UBIN;
       72       72    1   DCL RANGE_LOOP SBIN;
       73       73    1   DCL RFLAG BIT(1);
       74       74    1   DCL ENTRY$ PTR;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:3    
       75       75    1   DCL HIGH_ENTRY# UBIN;
       76       76    1   DCL 1 PUP,
       77       77    1         2 SIZE UBIN(22) UNAL,
       78       78    1         2 SCALE SBIN(8) UNAL,
       79       79    1         2 BITS BIT(6) UNAL;
       80       80    1   DCL MITEM$ PTR;
       81       81    1   DCL STRUCT UBIN;
       82       82    1   DCL TBITS BIT(6);
       83       83    1   DCL 1 TEXTC BASED,
       84       84    1         2 SZ UBIN(9) UNAL,
       85       85    1         2 TXT CHAR(TEXTC.SZ);
       86       86    1   DCL 1 TXTC BASED,
       87       87    1         2 * UBIN(9) UNAL,
       88       88    1         2 TXT CHAR(31);
       89       89    1   DCL ATYP SBIN;
       90       90    1   DCL DTYP SBIN;
       91       91    1   DCL I SBIN;
       92       92    1   DCL IENTRY# SBIN;
       93       93    1   DCL IENTRY$ PTR;
       94       94    1   DCL T$ PTR;
       95       95    1   DCL IPTR$ PTR;
       96       96    1   DCL TATYP UBIN;
       97       97    1   DCL UBIN36 UBIN(36) BASED ALIGNED;
       98       98          /* MISC */
       99       99             %INCLUDE DD$DITEM;
       12+     202             %LIST;
       13+     203    1        DCL SDD$ PTR;
       14+     204    1        DCL ZITEM$ PTR;
       15+     205    1        DCL SDD_L6$ PTR;
       16+     206    1        DCL ZITEM_L6$ PTR;
      100      780             %ZITEM;
      101      852             %DITEM;
      102      932             %MITEM;
      103      980             %INCLUDE XUH_MACRO_C;
      104     1064             %INCLUDE DD_SD_M;
      105     2400             %S_D;
      106     3718             %INCLUDE B$OBJECT_C;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:4    
      107     7148             %B$VREBL(STCLASS="BASED(ENTRY$)");
      108     7312             %VREBL_DATATYPES;
      109     7387             %VREBLSUBS;
      110     7395             %INCLUDE DD_ERR_C;
      111     7792             %INCLUDE DD_PSUBS_C;
      112     8267             %INCLUDE XU_MACRO_C;
      113    11373             %PARSE$OUT(NAME=O,SCRITCH=SCRATCH,STCLASS=BASED);
      114    11418             %INCLUDE DD$BASED;
      115    12721             %DD$VENTRY;
      116    12726             %TEXT$C;
      117    12731             %INCLUDE XU_SUBS_C;
      118    12823             %INCLUDE DD_DESC_R;
      119    12873    1   DCL 1 DUMINDEX CONSTANT,
      120    12874    1         2 * UBIN(18) UNAL INIT(0),
      121    12875    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      122    12876    1         2 * UBIN(9) UNAL INIT(0),
      123    12877    1         2 * UBIN(36) UNAL INIT(0);
      124    12878    1   DCL 1 DUMPTR CONSTANT,
      125    12879    1         2 * UBIN(18) UNAL INIT(0),
      126    12880    1         2 * UBIN(9) UNAL INIT(0),
      127    12881    1         2 * UBIN(9) UNAL INIT(%PTR_ICODE), /* PTR_ICODE */
      128    12882    1         2 * UBIN(36) UNAL INIT(0);
      129    12883    1   DCL TYPESIZE_MULT(0:0) UBIN SYMREF;
      130    12884    1   DCL TYPESIZE_MULT_FEP(0:0) UBIN SYMREF;
      131    12885          /* EXTERNAL ROUTINES */
      132    12886    1   DCL DDD$PQLIST ENTRY(2) ALTRET;
      133    12887    1   DCL DDD$MULT ENTRY(4) ALTRET;
      134    12888    1   DCL DDD$SIMEXP ENTRY(3) ALTRET;
      135    12889    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;
      136    12890    1   DCL DDS$V_SRCH ENTRY(3) ALTRET;
      137    12891    1   DCL DDS$SET_Q2T ENTRY ALTRET;
      138    12892    1   DCL DDS$SET_X2Q ENTRY ALTRET;
      139    12893    1   DCL DDS$SET_T2Q ENTRY ALTRET;
      140    12894    1   DCL DDF$VREBL_# ENTRY(2) ALTRET;
      141    12895                                                /**/
      142    12896    1        SDD$ = S_D.D$;
      143    12897    1        ZITEM$ = S_D.DESC$;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:5    
      144    12898    1        RANGE_FLAG = '0'B;
      145    12899    1        DIM_CNT = SUBREF$ -> O.NSUBLKS;
      146    12900    1        DIM_CNTM1 = DIM_CNT - 1;
      147    12901    2        DO IDX_LOOP = 0 TO DIM_CNTM1;
      148    12902    2             SIZE = 0;
      149    12903    2             RFLAG = '0'B;
      150    12904    2             TEMP$ = SUBREF$ -> O.SUBLK$(IDX_LOOP); /* PTR TO INDEX */
      151    12905    2             IF TEMP$ -> O.NSUBLKS > 1
      152    12906    3             THEN DO;                      /* FOUND RANGE SPECIFICATION */
      153    12907    3                  RFLAG = '1'B;
      154    12908    3                  RANGE_FLAG = '1'B;
      155    12909    3                  S_D.RANGE_CNT = S_D.RANGE_CNT + 1;
      156    12910    3                  IF S_D.RANGE_CNT > 2
      157    12911    4                  THEN DO;
      158    12912    4                       S_D.ERROR = 39; /* E@SUBRANGE */
      159    12913    4                       ALTRETURN;
      160    12914    4                     END;
      161    12915    3                END;
      162    12916    3             DO RANGE_LOOP = 0 TO TEMP$ -> O.NSUBLKS - 1;
      163    12917    3                  IF RFLAG
      164    12918    3                  THEN IF RANGE_LOOP = 0
      165    12919    3                       THEN IDX_ICODE = %LIDX_ICODE; /* LIDX_ICODE */
      166    12920    3                       ELSE IDX_ICODE = %UIDX_ICODE; /* UIDX_ICODE */
      167    12921    3                  ELSE IDX_ICODE = %SIDX_ICODE; /*SIDX_ICODE */
      168    12922    3                  I$ = TEMP$ -> O.SUBLK$(RANGE_LOOP);
      169    12923    3                  CALL DDD$PQLIST(I$, BASED_FLAG) ALTRET (SERR);
      170    12924    3                  SDD$ = S_D.D$;
      171    12925    3                  I$ = I$ -> O.SUBLK$(I$ -> O.NSUBLKS - 1);
      172    12926                                                /* I$ NOW POINTS TO ACTUAL INDEX ITEM */
      173    12927    3                  IF I$ -> O.CODE = 40 /* VAREXP_CODE */
      174    12928    4                  THEN DO;                 /* BUILD VARIABLE REFERENCE INDEX */
      175    12929    4                       ARRAY_FLAG = '0'B;
      176    12930    4                       MY_DIM_CNT = 0;
      177    12931    4                       IPTR$ = SDD$;       /* Remember in case implied PTR */
      178    12932    4                       IF I$ -> O.NSUBLKS > 1
      179    12933    5                       THEN DO;            /* PROCESS SUBREF (RECURSE) */
      180    12934    5                            IF I$ -> O.NSUBLKS >2
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:6    
      181    12935    5                              OR I$ -> O.SUBLK$(1) -> O.CODE ~= 44 /*SUBREF_CODE */
      182    12936    6                            THEN DO;
      183    12937    6                                 S_D.ERROR = 190; /* E@BAD_SUBREF_EXP */
      184    12938    6                                 ALTRETURN;
      185    12939    6                               END;
      186    12940    5                            ARRAY_FLAG = '1'B;
      187    12941    5                            CALL DDD$SUBREF(I$ -> O.SUBLK$(1), MY_RANGE_FLAG,
      188    12942    5                              MY_DIM_CNT, MY_MULT) ALTRET(SERR);
      189    12943    5                            SDD$ = S_D.D$;
      190    12944    5                            IF MY_RANGE_FLAG
      191    12945    6                            THEN DO;
      192    12946    6                                 S_D.ERROR = 192; /* E@BAD_SUBREF_RNGE */
      193    12947    6                                 ALTRETURN;
      194    12948    6                               END;
      195    12949    5                          END;             /* PROCESS SUBREF (RECURSE) */
      196    12950    4                       I$ = I$ -> O.SUBLK$(0); /* SYMLIST */
      197    12951    4                       XQUAL = '0'B;
      198    12952    4                       SYM$ = I$ -> O.SUBLK$(0) -> O.SUBLK$(0);
      199    12953    4                       CALL DDS$V_SRCH(I$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);
      200    12954    4                       HIGH_ENTRY# = ENTRY#.C;
      201    12955    4                       IF S_D.XSCH.OK
      202    12956    5                       THEN DO;
      203    12957    5                            CALL DDS$SET_Q2T;
      204    12958    5                            CALL DDS$SET_X2Q ALTRET( BADSCHEMA );
      205    12959    5                            XQUAL = '1'B;
      206    12960    5                            CALL DDS$V_SRCH(I$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);
      207    12961    5                            IF ENTRY#.C > HIGH_ENTRY#
      208    12962    5                            THEN HIGH_ENTRY# = ENTRY#.C;
      209    12963    5                            CALL DDS$SET_T2Q ALTRET( BADSCHEMA );
      210    12964    5                          END;
      211    12965                                                /* NOT FOUND, MUST BE ERROR */
      212    12966    4                       SYM$ = I$ -> O.SUBLK$( HIGH_ENTRY# ) -> O.SUBLK$(0);
      213    12967    4                       S_D.ERROR = 3; /* E@SYM_NOTFOUND */
      214    12968    4                       S_D.ERROR_SYM$ = SYM$;
      215    12969    4                       ALTRETURN;
      216    12970    4   GOT_VAR:
      217    12971                                                /* PERFORM VARIOUS CONSISTENCY CHECKS */
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:7    
      218    12972    4                       IF XQUAL
      219    12973    4                       THEN CALL DDS$SET_T2Q ALTRET( BADSCHEMA );
      220    12974    4                       ATYP = B$VREBL.ADDRTYP - 1;
      221    12975    4                       DTYP = B$VREBL.DATATYP;
      222    12976    4                       DIMS = 0;
      223    12977    5                       DO I = 1 TO ENTRY#.C;
      224    12978    5                            STRUCT = ENTRY#.C - I + 1;
      225    12979    5                            IF ENTRY#.C ~= 1
      226    12980    5                            THEN CALL DDF$VREBL_#(ENTRY#.E(STRUCT), ENTRY$) ALTRET(
             12980                                     BADSCHEMA);
      227    12981    5                            ARRAYTYP = B$VREBL.ARRAYTYP;
      228    12982    6                            DO CASE( ARRAYTYP );
      229    12983    6                              CASE( %SCALAR_ARRAY );
      230    12984                                                /* Do nothing */
      231    12985    6                              CASE( %VECTOR0_ARRAY, %VECTOR1_ARRAY );
      232    12986    6                                 DIMS = DIMS + 1;
      233    12987    6                              CASE( %REAL_ARRAY, %VIRTUAL_ARRAY, %ADJUSTABLE_ARRAY );
      234    12988    6                                 DIMS = DIMS + B$VREBL.DIMS ;
      235    12989    6                              CASE( ELSE );
      236    12990    6                                 S_D.ERROR_SYM$ = SYM$;
      237    12991    6                                 S_D.ERROR = 187; /* E@NOTIMPLARRAY */
      238    12992    6                                 ALTRETURN;
      239    12993    6                              END;         /* DO CASE( ARRAYTYP ) */
      240    12994    5                          END;             /* DO I = 0 TO ENTRY#.C */
      241    12995    4                       IF ENTRY#.C > 1
      242    12996    4                       THEN CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(
             12996                                BADSCHEMA);
      243    12997    4                       IF MY_DIM_CNT ~= DIMS
      244    12998    5                       THEN DO;
      245    12999    5                            S_D.ERROR_HICHAR = DIMS;
      246    13000    5                            S_D.ERROR = 188; /* E@WRONG#SUBS */
      247    13001    5                            S_D.ERROR_SYM$ = SYM$;
      248    13002    5                            ALTRETURN;
      249    13003    5                          END;
      250    13004    4                       IF BASED_FLAG AND NOT (ATYP = 2 OR ATYP = 3 OR ATYP = 4 OR ATYP
             13004                                = 6 OR ATYP = 7)
      251    13005    5                       THEN DO;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:8    
      252    13006    5                            S_D.ERROR = 9; /* E@VAR_REF */
      253    13007    5                            S_D.ERROR_SYM$ = SYM$;
      254    13008    5                            ALTRETURN;
      255    13009    5                          END;
      256    13010    4                       PUP = '0'B;
      257    13011    5                       DO CASE( DTYP );
      258    13012    5                         CASE( 1,2,24 );   /* SBIN, Double SBIN, UBIN */
      259    13013    5                            TBITS = '000000'B;
      260    13014    5                         CASE( 9 );        /* Packed, leading, ASCII */
      261    13015    5                            TBITS = '010100'B;
      262    13016    5                         CASE( 25 );       /* Packed, trailing, ASCII */
      263    13017    5                            TBITS = '011000'B;
      264    13018    5                         CASE( 31 );       /* Packed, trailing, EBCDIC */
      265    13019    5                            TBITS = '011010'B;
      266    13020    5                         CASE( 40 );       /* Packed, unsigned */
      267    13021    5                            TBITS = '010000'B;
      268    13022    5                         CASE( 41 );       /* Unpacked, unsigned */
      269    13023    5                            TBITS = '100000'B;
      270    13024    5                         CASE( 42 );       /* Unpacked, leading, separate */
      271    13025    5                            TBITS = '100100'B;
      272    13026    5                         CASE( 43 );       /* Unpacked, trailing, separate */
      273    13027    5                            TBITS = '101000'B;
      274    13028    5                         CASE( 44 );       /* Unpacked, leading, overpunched */
      275    13029    5                            TBITS = '100101'B;
      276    13030    5                         CASE( 45 );       /* Unpacked, trailing, overpunched */
      277    13031    5                            TBITS = '101001'B;
      278    13032    5                         CASE( ELSE );
      279    13033    5                            S_D.ERROR = 191; /* E@BAD_SUBREF_DST */
      280    13034    5                            S_D.ERROR_SYM$ = SYM$;
      281    13035    5                            ALTRETURN;
      282    13036    5                         END;              /* DO CASE( DTYP ) */
      283    13037    4                       PUP.BITS = TBITS;
      284    13038    4                       IF PUP AND B$VREBL.SCALE ~= 0
      285    13039    5                       THEN DO;
      286    13040    5                            S_D.ERROR = 195; /* E@BAD_SUBREF_SCAL */
      287    13041    5                            S_D.ERROR_SYM$ = SYM$;
      288    13042    5                            ALTRETURN;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:9    
      289    13043    5                          END;
      290    13044    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      291    13045    4                       THEN PUP.SIZE = B$VREBL.LOGSIZ * TYPESIZE_MULT( DTYP );
      292    13046    4                       ELSE PUP.SIZE = B$VREBL.LOGSIZ * TYPESIZE_MULT_FEP( DTYP );
      293    13047    4                       IF NOT BASED_FLAG AND (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE
             13047                                OR
      294    13048    4                         ATYP = %PARM_ACODE OR ATYP = %SPARM_ACODE OR ATYP = %
             13048                                  AREADEF_ACODE)
      295    13049         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      296    13050    5                       THEN DO;
      297    13051    5                            IENTRY# = B$VREBL.IMPTR;
      298    13052    5                            IF ATYP = 2 AND IENTRY# < 0
      299    13053    6                            THEN DO;
      300    13054    6                                 S_D.ERROR = 99; /* E@NOPTR */
      301    13055    6                                 S_D.ERROR_SYM$ = SYM$;
      302    13056    6                                 ALTRETURN;
      303    13057    6                               END;
      304    13058    5                            T$ = SDD$;
      305    13059    5                            CALL BUMPD$ ALTRET(SERR);
      306    13060    6                            DO WHILE( T$ >= IPTR$ );
      307    13061    6                                 PINCRW(T$,SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;
      308    13062    6                                 T$ = PINCRW(T$, -1);
      309    13063    6                               END;        /* DO WHILE (T$ >= IPTR$ ) */
      310    13064    6                            DO I = 0 TO MY_DIM_CNT - 1;
      311    13065    6                                 MY_MULT( I ) = PINCRW(MY_MULT( I ), SIZEW(DITEM));
      312    13066    6                               END;
      313    13067    5                            IF ATYP = %BASED_ACODE /* BASED_ACODE */
      314    13068    6                            THEN DO;       /* Based variable */
      315    13069    6                                 IPTR$ -> DITEM = DUMPTR;
      316    13070    6                                 CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);
      317    13071    7                                 DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      318    13072    7                                   CASE (%HOST);
      319    13073    7                                      IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR
             13073                                               .W;
      320    13074    7                                      IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR
             13074                                               .C;
      321    13075    7                                      IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:10   
             13075                                               .B;
      322    13076    7                                   CASE (%L6);
      323    13077    7                                      IPTR$ -> DITEM.ADDRESS.W = IENTRY$
      324    13078    7                                        -> B$VREBL.ADR6.W;
      325    13079    7                                      IPTR$ -> DITEM.ADDRESS.C = IENTRY$
      326    13080    7                                        -> B$VREBL.ADR6.C;
      327    13081    7                                      IPTR$ -> DITEM.ADDRESS.B = IENTRY$
      328    13082    7                                        -> B$VREBL.ADR6.B;
      329    13083    7                                   CASE (ELSE);
      330    13084    7                                      S_D.ERROR = 502; /* E@DELBUG */
      331    13085    7                                      ALTRETURN;
      332    13086    7                                   END;
      333    13087    6                                 TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;
      334    13088    6                                 IF TATYP = %PARM_ACODE OR TATYP = %SPARM_ACODE OR
             13088                                          TATYP = %AREADEF_ACODE
      335    13089                                      /* PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      336    13090    7                                 THEN DO;
             13090                                          /* Implicit pointer is a parameter or areadef */
      337    13091    7                                      IPTR$ -> DITEM.ADDR_TYPE = %PARM_ACODE;
             13091                                               /* PARM_ACODE */
      338    13092    7                                      T$ = SDD$;
      339    13093    7                                      CALL BUMPD$ ALTRET(SERR);
      340    13094    8                                      DO WHILE (T$ >= IPTR$ );
      341    13095    8                                           PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ ->
             13095                                                    UBIN36;
      342    13096    8                                           T$ = PINCRW(T$, -1);
      343    13097    8                                         END; /* DO WHILE (T$ >= IPTR$) */
      344    13098    8                                      DO I = 0 TO DIM_CNT - 1;
      345    13099    8                                           MULT(I) = PINCRW(MULT(I), SIZEW(DITEM));
      346    13100    8                                         END;
      347    13101    7                                      IF TATYP = %PARM_ACODE /* PARM_ACODE */
      348    13102    8                                      THEN DO; /* Auto parameter */
      349    13103    8                                           IPTR$ -> DITEM.VALUEB = DESC.ITEM( %
             13103                                                    PARM_DESC ); /* PARM_DESC */
      350    13104    8                                           IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13104                                                    /* DESC_ACODE */
      351    13105    8                                           IPTR$ -> DITEM.SP.VP.N = IENTRY$ -> B$VREBL.
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:11   
             13105                                                    IMPTR - 2;
      352    13106    8                                           ZITEM.FLAGS.MDSE.S = '1'B;
             13106                                                    /* Need SS frame */
      353    13107    8                                         END; /* Auto parameter */
      354    13108    7                                      ELSE IF TATYP = %SPARM_ACODE
             13108                                               /* Static parameter */
      355    13109    8                                           THEN DO;
      356    13110    8                                                IPTR$ -> DITEM.ADDRESS.W = IENTRY$ ->
             13110                                                         B$VREBL.IMPTR;
      357    13111    8                                                IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE
             13111                                                         ; /* SPARM_ACODE */
      358    13112    8                                              END; /* Static parameter */
      359    13113    8                                           ELSE DO; /* TATYP = AREADEF_ACODE */
      360    13114    8                                                IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE
             13114                                                         ; /* CONST_ACODE */
      361    13115    8                                                IPTR$ -> DITEM.VALUE = PINCRW(IENTRY$,
             13115                                                         POFFW(ADDR(B$VREBL.IMPTR), ADDR(
             13115                                                         B$VREBL))) -> UBIN36;
      362    13116    8                                              END; /* TATYP = AREADEF_ACODE */
      363    13117    7                                    END;
             13117                                            /* Implicit pointer is a parameter or areadef */
      364    13118    6                                 ELSE IPTR$ -> DITEM.ADDR_TYPE = TATYP;
      365    13119    6                                 CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(
             13119                                          BADSCHEMA);
      366    13120    6                               END;        /* Based variable */
      367    13121    5                            ELSE IF ATYP = %PARM_ACODE
             13121                                     /* PARM_ACODE - auto parameter */
      368    13122    6                                 THEN DO;
      369    13123    6                                      IPTR$ -> DITEM = DUMPTR;
      370    13124    6                                      IPTR$ -> DITEM.VALUEB = DESC.ITEM( %PARM_DESC );
             13124                                               /* PARM_DESC */
      371    13125    6                                      IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13125                                               /* DESC_ACODE */
      372    13126    6                                      IPTR$ -> DITEM.SP.VP.N = IENTRY# - 2;
      373    13127    6                                      ZITEM.FLAGS.MDSE.S = '1'B; /* Need SS frame */
      374    13128    6                                    END;   /* Parameter */
      375    13129    5                                 ELSE IF ATYP = %SPARM_ACODE
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:12   
             13129                                          /* SPARM_ACODE - Static parameter */
      376    13130    6                                      THEN DO;
      377    13131    6                                           IPTR$ -> DITEM = DUMPTR;
      378    13132    6                                           IPTR$ -> DITEM.ADDRESS.W = IENTRY#;
      379    13133    6                                           IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE;
             13133                                                    /* SPARM_ACODE */
      380    13134    6                                         END; /* Static parameter */
      381    13135    5                                      ELSE IF ATYP = %DCB_ACODE /* DCB_ACODE */
      382    13136    6                                           THEN DO;
      383    13137    6                                                IPTR$ -> DITEM = DUMPTR;
      384    13138    6                                                IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13138                                                         /* DESC_ACODE */
      385    13139    6                                                IPTR$ -> DITEM.VALUEB = DESC.ITEM( %
             13139                                                         DCB_DESC ); /* DCB_DESC */
      386    13140    6                                                IPTR$ -> DITEM.SP.VD.DISP = IENTRY#;
      387    13141    6                                              END; /* ATYP = 3 (DCB) */
      388    13142    6                                           ELSE DO; /* ATYP = AREADEF_ACODE */
      389    13143    6                                                IPTR$ -> DITEM = DUMPTR;
      390    13144    6                                                IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE
             13144                                                         ; /* CONST_ACODE */
      391    13145    6                                                IPTR$ -> DITEM.VALUE = PINCRW(ENTRY$,
             13145                                                         POFFW(ADDR(B$VREBL.IMPTR), ADDR(
             13145                                                         B$VREBL))) -> UBIN36;
      392    13146    6                                              END; /* ATYP = AREADEF_ACODE */
      393    13147    5                            ATYP = %BASED_ACODE; /* BASED_ACODE */
      394    13148    5                          END;
             13148         /* NOT BASED_FLAG AND (ATYP = 2 OR ATYP = 3 OR ATYP = 4 OR ATYP = 6 OR ATYP = 7) */
      395    13149                                                /* LOOKS OK, BUILD INDEX ITEM */
      396    13150    4                       IF BASED_FLAG
      397    13151    4                       THEN ATYP = %BASED_ACODE; /* BASED_ACODE */
      398    13152    4                       DITEM = DUMINDEX;
      399    13153    4                       IF DTYP = %INDEX1_DATATYPE OR /* %INDEX1_DATATYPE */
      400    13154    4                         DTYP = %INDEX2_DATATYPE /* %INDEX2_DATATYPE */
      401    13155    5                       THEN DO;
      402    13156    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      403    13157    6                              CASE (%HOST);
      404    13158    6                                 ZITEM.ADDRESS.W = B$VREBL.ADR.W + 1;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:13   
      405    13159    6                              CASE (%L6);
      406    13160    6                                 ZITEM.ADDRESS.W = B$VREBL.ADR6.W + 1;
      407    13161    6                              CASE (ELSE);
      408    13162    6                                 S_D.ERROR = 502; /* E@DELBUG */
      409    13163    6                                 ALTRETURN;
      410    13164    6                              END;
      411    13165    5                            IF DTYP = %INDEX1_DATATYPE /*%INDEX1_DATATYPE */
      412    13166    5                            THEN
      413    13167    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      414    13168    6                              CASE (%HOST);
      415    13169    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR.C + 2;
      416    13170    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR.B;
      417    13171    6                              CASE (%L6);
      418    13172    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR6.C + 2;
      419    13173    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR6.B;
      420    13174    6                              CASE (ELSE);
      421    13175    6                                 S_D.ERROR = 502; /* E@DELBUG */
      422    13176    6                                 ALTRETURN;
      423    13177    6                              END;
      424    13178    5                            ELSE
      425    13179    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      426    13180    6                              CASE (%HOST);
      427    13181    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR.C;
      428    13182    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR.B;
      429    13183    6                              CASE (%L6);
      430    13184    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR6.C;
      431    13185    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR6.B;
      432    13186    6                              CASE (ELSE);
      433    13187    6                                 S_D.ERROR = 502; /* E@DELBUG */
      434    13188    6                                 ALTRETURN;
      435    13189    6                              END;
      436    13190    5                          END;
      437    13191    5                       ELSE DO;
      438    13192    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);
      439    13193    6                              CASE (%HOST);
      440    13194    6                                 DITEM.ADDRESS.W = B$VREBL.ADR.W;
      441    13195    6                                 DITEM.ADDRESS.C = B$VREBL.ADR.C;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:14   
      442    13196    6                                 DITEM.ADDRESS.B = B$VREBL.ADR.B;
      443    13197    6                              CASE (%L6);
      444    13198    6                                 DITEM.ADDRESS.W = B$VREBL.ADR6.W;
      445    13199    6                                 DITEM.ADDRESS.C = B$VREBL.ADR6.C;
      446    13200    6                                 DITEM.ADDRESS.B = B$VREBL.ADR6.B;
      447    13201    6                              CASE (ELSE);
      448    13202    6                                 S_D.ERROR = 502; /* E@DELBUG */
      449    13203    6                                 ALTRETURN;
      450    13204    6                              END;
      451    13205    5                          END;
      452    13206    4                       DITEM.TYPE_CODE = IDX_ICODE;
      453    13207    4                       IF IDX_LOOP = DIM_CNTM1
      454    13208    4                         AND IDX_ICODE ~= %LIDX_ICODE /* LIDX_ICODE */
      455    13209    4                       THEN DITEM.FLAGS.LFLAG = '1'B;
      456    13210    4                       DITEM.ADDR_TYPE = ATYP;
      457    13211    4                       DITEM.PUP = PUP;
      458    13212    4                       IF ARRAY_FLAG
      459    13213    4                       THEN CALL DDD$MULT(MY_DIM_CNT, MY_MULT, ENTRY$, ENTRY#) ALTRET(
             13213                                SERR);
      460    13214    4                       CALL BUMPD$ ALTRET(SERR);
      461    13215    4                     END;                  /* BUILD VARIABLE REFERENCE INDEX */
      462    13216    4                  ELSE DO;                 /* BUILD SIMPLE EXPRESSION INDEX */
      463    13217    4                       DITEM = DUMINDEX;
      464    13218    4                       IF BASED_FLAG
      465    13219    4                       THEN DITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */
      466    13220    4                       I$ = I$ -> O.SUBLK$(0); /* Point to C@SDO */
      467    13221    4                       IF I$ -> O.SUBLK$(0) -> O.CODE = 591 /* MINUS_CODE */
      468    13222    5                       THEN DO;
      469    13223    5                            MINUS = '1'B;
      470    13224    5                            I$ = I$ -> O.SUBLK$(1); /* Point to DEC or OCTIL */
      471    13225    5                          END;
      472    13226    5                       ELSE DO;
      473    13227    5                            MINUS = '0'B;
      474    13228    5                            I$ = I$ -> O.SUBLK$(0); /* Point to DEC or OCTIL */
      475    13229    5                          END;
      476    13230    4                       IF I$ -> O.CODE = 27 /* OCT_CODE */
      477    13231    5                       THEN DO;            /* "OCTIL" */
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:15   
      478    13232    5                            DITEM.FLAGS.OFLAG = '1'B;
      479    13233    5                            S_D.SDOO = '1'B;
      480    13234    5                            IF I$ -> O.NDTYPE = %KONCAT#
      481    13235    5                            THEN I$ = I$ -> O.SUBLK$(0);
      482    13236    5                            I$ = I$ -> O.SUBLK$(0);
      483    13237    5                            TSIZ = I$ -> TEXT$C.SIZE;
      484    13238    5                            IF TSIZ > 12
      485    13239    6                            THEN DO;
      486    13240    6                                 S_D.ERROR = 46; /* E@TOOLARGE */
      487    13241    6                                 ALTRETURN;
      488    13242    6                               END;
      489    13243                       /* Pick up each digit left to right and accumulate into sum */
      490    13244    5                            ACCUM = 0;
      491    13245    6                            DO IX = 1 TO TSIZ;
      492    13246    6                                 I$ = PINCRC( I$, LENGTHC(CHAR$1) );
      493    13247    6                                 ACCUM = (ACCUM * 8) + ASCBIN(I$ -> CHAR$1) - ASCBIN(
             13247                                          '0' );
      494    13248    6                               END;
      495    13249    5                            TEMP1 = ACCUM;
      496    13250    5                          END;             /* "OCTIL" */
      497    13251    4                       ELSE IF I$ -> O.CODE = 8 /* DEC_CODE */
      498    13252    5                            THEN DO;       /* "DECIMAL" */
      499    13253    5                                 DITEM.FLAGS.OFLAG = '0'B;
      500    13254    5                                 S_D.SDOD = '1'B;
      501    13255    5                                 I$ = I$ -> O.SUBLK$(0);
      502    13256    5                                 TSIZ = I$ -> TEXT$C.SIZE;
      503    13257    5                                 IF TSIZ >= LENGTHC( '68719476735' )
      504    13258    6                                 THEN DO;
      505    13259    6                                      IF TSIZ > LENGTHC( '68719476735' )
      506    13260    7                                      THEN DO;
      507    13261    7                                           S_D.ERROR = 46; /* E@TOOLARGE */
      508    13262    7                                           ALTRETURN;
      509    13263    7                                         END;
      510    13264    6                                      IF I$ -> TEXT$C.TXT > '68719476735'
      511    13265    7                                      THEN DO;
      512    13266    7                                           S_D.ERROR = 46; /* E@TOOLARGE */
      513    13267    7                                           ALTRETURN;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:16   
      514    13268    7                                         END;
      515    13269    6                                    END;
      516    13270    5                                 CALL CHARBIN( TEMP1, I$ -> TEXT$C.TXT);
      517    13271    5                               END;        /* "DECIMAL" */
      518    13272    5                            ELSE DO;
      519    13273    5                                 S_D.ERROR = 501; /* E@DERR1 */
      520    13274    5                                 ALTRETURN;
      521    13275    5                               END;
      522    13276    4                       IF MINUS
      523    13277    4                       THEN TEMP1 = - TEMP1;
      524    13278    4                       DITEM.VALUE = TEMP1;
      525    13279    4                       IF IDX_LOOP = DIM_CNTM1
      526    13280    4                         AND IDX_ICODE ~= %LIDX_ICODE /* LIDX_ICODE */
      527    13281    4                       THEN DITEM.FLAGS.LFLAG = '1'B;
      528    13282    4                       DITEM.TYPE_CODE = IDX_ICODE;
      529    13283    4                       CALL BUMPD$ ALTRET(SERR);
      530    13284    4                     END;                  /* BUILD SIMPLE EXPRESSION INDEX */
      531    13285    3                  IF IDX_ICODE ~= %UIDX_ICODE /* UIDX_ICODE */
      532    13286    4                  THEN DO;
      533    13287    4                       MITEM$ = SDD$;
      534    13288    4                       CALL BUMPD$(SIZEW(MITEM)) ALTRET(SERR);
      535    13289    4                       MITEM$ -> MITEM = '0'B;
      536    13290    4                       MULT(IDX_LOOP) = MITEM$;
      537    13291    4                       IF IDX_LOOP ~= 0
      538    13292    4                       THEN MITEM$ -> MITEM.CONT = '1'B;
      539    13293    4                     END;
      540    13294    3                END;                       /* DO RANGE_LOOP */
      541    13295    2           END;                            /* DO IDX_LOOP */
      542    13296    1        RETURN;
      543    13297                                                /**/
      544    13298    1   BADSCHEMA:
      545    13299    1        S_D.ERROR = 22;              /* E@UERR11 */
      546    13300    1   SERR:
      547    13301    1        ALTRETURN;
      548    13302             %EJECT;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:17   
      549    13303             %BUMPD$;
             13304             %LIST;
             13305    1   BUMPD$: PROC(PCNT) ALTRET;
             13306    2   DCL PCNT UBIN;
             13307    2   DCL CNT UBIN;
             13308    2   DCL DD_VARCOM$ PTR SYMREF;
             13309    2   DCL DDM$GETMEM ENTRY(3) ALTRET;
             13310    2        IF ADDR(PCNT) = ADDR(NIL)
             13311    2        THEN CNT = SIZEW(DITEM);
             13312    2        ELSE CNT = PCNT;
             13313    2        SDD$ = PINCRW(SDD$,CNT);
             13314    2        IF SDD$ > S_D.DESCL$
             13315    3        THEN DO;
             13316    3             IF S_D.STORED ~= 0
             13317    4             THEN DO;
             13318    5                  DO WHILE (SDD$ > PINCRW(S_D.DESCL$, 1));
             13319    5                       CALL DDM$GETMEM(DD_VARCOM$, 1024);
             13320    5                       S_D.VARCOM_HIGH$ = PINCRW(S_D.VARCOM_HIGH$, 1024);
             13321    5                       S_D.DESCL$ = S_D.VARCOM_HIGH$;
             13322    5                     END;
             13323    4                END;
             13324    4             ELSE DO;
             13325    4                  S_D.ERROR = 8; /* E@NOROOM */
             13326    4                  ALTRETURN;
             13327    4                END;
             13328    3           END;
             13329    2        S_D.D$ = SDD$;
             13330    2        RETURN;
             13331    2        END BUMPD$;
      550    13334    1   END DDD$SUBREF;

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:18   
--  Include file information  --

   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDD$SUBREF.

   Procedure DDD$SUBREF requires 1094 words for executable code.
   Procedure DDD$SUBREF requires 114 words of local(AUTO) storage.

    No errors detected in file DDD$SUBREF.:E05TSI    .

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:19   

 Object Unit name= DDD$SUBREF                                 File name= DDD$SUBREF.:E05TOU
 UTS= JUL 29 '97 13:54:31.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      7      7  DDD$SUBREF
    1   Proc  even  none  1094   2106  DDD$SUBREF
    2  RoData even  none     7      7  DDD$SUBREF

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  DDD$SUBREF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 DDD$PQLIST
 yes     yes           Std       3 DDS$V_SRCH
 yes     yes           Std       4 DDD$MULT
 yes     yes           Std       0 DDS$SET_X2Q
 yes     yes           Std       0 DDS$SET_T2Q
 yes     yes           Std       0 DDS$SET_Q2T
 yes     yes           Std       2 DDF$VREBL_#
 yes     yes           Std       3 DDM$GETMEM
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:20   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    S_D$                                  DESC                                  TYPESIZE_MULT
     TYPESIZE_MULT_FEP                     DD_VARCOM$                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:21   


        1        1        /*M*  DDD$SUBREF - BUILDS DATA DESC ITEMS FOR A SUBSCRIPT REF */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB = '1'B;
        9        9        /*P*  NAME: DDD$SUBREF
       10       10              PURPOSE: BUILDS THE DATA DESCRIPTOR ITEMS FOR A SUBSCRIPT
       11       11                  REFERENCE (LIST OF SUBSCRIPTS).
       12       12              DESCRIPTION: OPERATES ON M$PARSE OUTPUT TREE TO PRODUCE
       13       13                  DATA DESCRIPTOR ITEMS IN THE VARIABLE REFERENCE
       14       14                  DATA DESCRIPTOR FOR A SUBSCRIPT REFERENCE.  THESE ITEMS
       15       15                  DESCRIBE THE ONE OR MORE (IF MULTIPLY DIMENSIONED) INDEX
       16       16                  VALUES IN THE VARIABLE REFERENCE.  EACH INDEX CAN BE A
       17       17                  POSSIBLY POINTER QUALIFIED, POSSIBLY SUBSCRIPTED VARIABLE,
       18       18                  THEREFORE DDD$SUBREF MAKES RECURSIVE CALLS TO THE
       19       19                  ROUTINE DDD$PQLIST AND ITSELF TO CREATE THE ADDITIONAL
       20       20                  ITEMS NECCESSARY TO DESCRIBE EACH INDEX REFERENCE. */
       21       21        /*D*  NAME: DDD$SUBREF
       22       22              CALL: DDD$SUBREF(SUBREF$, RANGE_FLAG, DIM_CNT, MULT) ALTRET
       23       23              INTERFACE: CALLS DDD$PQLIST, DDD$SUBREF, DDD$BUMP_PTR, DDD$MULT,
       24       24                       DDS$V_SRCH, DDS$UD_SRCH.
       25       25              INPUT: SUBREF$ - PARM1 - PTR TO NODE IN M$PARSE OUTPUT TREE
       26       26                                      WHICH IS THE ROOT OF THE SUBSCRIPT
       27       27                                      REFERENCE SPECIFICATION (SUBREF_CODE).
       28       28                     S_D.D$ - GLOBAL STATIC - PTR TO NEXT ITEM SLOT IN
       29       29                                      CURRENT DATA DESCRIPTOR.
       30       30                     RANGE_FLAG - PARM2 - SET TO INDICATE THAT ONE OR TWO
       31       31                                      OF THE INDEX REFERENCES SPECIFIES A
       32       32                                      A RANGE OF VALUES. (MORE THAN TWO IS
       33       33                                      AN ERROR.)
       34       34                     DIM_CNT - PARM3 - SET TO THE NUMBER OF INDEX REFERENCES
       35       35                                      FOUND.
       36       36                     MULT(0:DIM_CNT) - PARM4 - ARRAY OF PTRs TO MULTIPLIER
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:22   
       37       37                                      ITEMS IN THE DATA DESCRIPTOR BUILT
       38       38                                      FOR THIS SET OF INDEX REFERENCES.
       39       39                     @ S_D.D$ - BUILDS DATA DESCRIPTOR ITEMS.
       40       40                     S_D.ERROR - SET TO INDICATE ERROR IF ALTRETURN.
       41       41                     S_D.ERROR_SYM$ - SET TO SYMBOL TEXTC FOR SOME ERRORS.
       42       42                                                          */
       43       43        DDD$SUBREF: PROC(SUBREF$,RANGE_FLAG,DIM_CNT,MULT) ALTRET;

     43  1 000000   000000 700200 xent  DDD$SUBREF   TSX0  ! X66_AUTO_4
         1 000001   000162 000004                    ZERO    114,4

       44       44          /* PARMS */
       45       45    1   DCL SUBREF$ PTR;
       46       46    1   DCL RANGE_FLAG BIT(1) ALIGNED;
       47       47    1   DCL DIM_CNT SBIN;
       48       48    1   DCL MULT(0:6) PTR;
       49       49          /* LOCALS */
       50       50    1   DCL DIM_CNTM1 SBIN;
       51       51    1   DCL MY_RANGE_FLAG BIT(1);
       52       52    1   DCL MY_DIM_CNT SBIN;
       53       53    1   DCL DIMS UBIN;
       54       54    1   DCL MY_MULT(0:6) PTR;
       55       55    1   DCL ARRAYTYP UBIN;
       56       56    1   DCL BASED_FLAG BIT(1) ALIGNED;
       57       57    1   DCL ARRAY_FLAG BIT(1);
       58       58    1   DCL XQUAL BIT(1);
       59       59    1   DCL I$ PTR;
       60       60    1   DCL TEMP$ PTR;
       61       61    1   DCL SYM$ PTR;
       62       62    1   DCL SYM2$ PTR;
       63       63    1   DCL SIZE SBIN;
       64       64    1   DCL IDX_LOOP SBIN;
       65       65    1   DCL IDX_ICODE SBIN;
       66       66    1   DCL TEMP1 SBIN;
       67       67    1   DCL CHAR$1 CHAR(1) BASED UNAL;
       68       68    1   DCL MINUS BIT(1);
       69       69    1   DCL TSIZ UBIN;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:23   
       70       70    1   DCL ACCUM UBIN;
       71       71    1   DCL IX UBIN;
       72       72    1   DCL RANGE_LOOP SBIN;
       73       73    1   DCL RFLAG BIT(1);
       74       74    1   DCL ENTRY$ PTR;
       75       75    1   DCL HIGH_ENTRY# UBIN;
       76       76    1   DCL 1 PUP,
       77       77    1         2 SIZE UBIN(22) UNAL,
       78       78    1         2 SCALE SBIN(8) UNAL,
       79       79    1         2 BITS BIT(6) UNAL;
       80       80    1   DCL MITEM$ PTR;
       81       81    1   DCL STRUCT UBIN;
       82       82    1   DCL TBITS BIT(6);
       83       83    1   DCL 1 TEXTC BASED,
       84       84    1         2 SZ UBIN(9) UNAL,
       85       85    1         2 TXT CHAR(TEXTC.SZ);
       86       86    1   DCL 1 TXTC BASED,
       87       87    1         2 * UBIN(9) UNAL,
       88       88    1         2 TXT CHAR(31);
       89       89    1   DCL ATYP SBIN;
       90       90    1   DCL DTYP SBIN;
       91       91    1   DCL I SBIN;
       92       92    1   DCL IENTRY# SBIN;
       93       93    1   DCL IENTRY$ PTR;
       94       94    1   DCL T$ PTR;
       95       95    1   DCL IPTR$ PTR;
       96       96    1   DCL TATYP UBIN;
       97       97    1   DCL UBIN36 UBIN(36) BASED ALIGNED;
       98       98          /* MISC */
       99       99             %INCLUDE DD$DITEM;
       12+     202             %LIST;
       13+     203    1        DCL SDD$ PTR;
       14+     204    1        DCL ZITEM$ PTR;
       15+     205    1        DCL SDD_L6$ PTR;
       16+     206    1        DCL ZITEM_L6$ PTR;
      100      780             %ZITEM;
      101      852             %DITEM;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:24   
      102      932             %MITEM;
      103      980             %INCLUDE XUH_MACRO_C;
      104     1064             %INCLUDE DD_SD_M;
      105     2400             %S_D;
      106     3718             %INCLUDE B$OBJECT_C;
      107     7148             %B$VREBL(STCLASS="BASED(ENTRY$)");
      108     7312             %VREBL_DATATYPES;
      109     7387             %VREBLSUBS;
      110     7395             %INCLUDE DD_ERR_C;
      111     7792             %INCLUDE DD_PSUBS_C;
      112     8267             %INCLUDE XU_MACRO_C;
      113    11373             %PARSE$OUT(NAME=O,SCRITCH=SCRATCH,STCLASS=BASED);
      114    11418             %INCLUDE DD$BASED;
      115    12721             %DD$VENTRY;
      116    12726             %TEXT$C;
      117    12731             %INCLUDE XU_SUBS_C;
      118    12823             %INCLUDE DD_DESC_R;
      119    12873    1   DCL 1 DUMINDEX CONSTANT,
      120    12874    1         2 * UBIN(18) UNAL INIT(0),
      121    12875    1         2 * UBIN(9) UNAL INIT(%CONST_ACODE), /* CONST_ACODE */
      122    12876    1         2 * UBIN(9) UNAL INIT(0),
      123    12877    1         2 * UBIN(36) UNAL INIT(0);
      124    12878    1   DCL 1 DUMPTR CONSTANT,
      125    12879    1         2 * UBIN(18) UNAL INIT(0),
      126    12880    1         2 * UBIN(9) UNAL INIT(0),
      127    12881    1         2 * UBIN(9) UNAL INIT(%PTR_ICODE), /* PTR_ICODE */
      128    12882    1         2 * UBIN(36) UNAL INIT(0);
      129    12883    1   DCL TYPESIZE_MULT(0:0) UBIN SYMREF;
      130    12884    1   DCL TYPESIZE_MULT_FEP(0:0) UBIN SYMREF;
      131    12885          /* EXTERNAL ROUTINES */
      132    12886    1   DCL DDD$PQLIST ENTRY(2) ALTRET;
      133    12887    1   DCL DDD$MULT ENTRY(4) ALTRET;
      134    12888    1   DCL DDD$SIMEXP ENTRY(3) ALTRET;
      135    12889    1   DCL DDS$UD_SRCH ENTRY(2) ALTRET;
      136    12890    1   DCL DDS$V_SRCH ENTRY(3) ALTRET;
      137    12891    1   DCL DDS$SET_Q2T ENTRY ALTRET;
      138    12892    1   DCL DDS$SET_X2Q ENTRY ALTRET;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:25   
      139    12893    1   DCL DDS$SET_T2Q ENTRY ALTRET;
      140    12894    1   DCL DDF$VREBL_# ENTRY(2) ALTRET;
      141    12895                                                /**/
      142    12896    1        SDD$ = S_D.D$;

  12896  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   000044 236100                    LDQ     36,,PR0
         1 000004   200062 756100                    STQ     SDD$,,AUTO

      143    12897    1        ZITEM$ = S_D.DESC$;

  12897  1 000005   000041 236100                    LDQ     33,,PR0
         1 000006   200063 756100                    STQ     ZITEM$,,AUTO

      144    12898    1        RANGE_FLAG = '0'B;

  12898  1 000007   200004 471500                    LDP1    @RANGE_FLAG,,AUTO
         1 000010   100000 450100                    STZ     0,,PR1

      145    12899    1        DIM_CNT = SUBREF$ -> O.NSUBLKS;

  12899  1 000011   200003 473500                    LDP3    @SUBREF$,,AUTO
         1 000012   300000 474500                    LDP4    0,,PR3
         1 000013   400001 236100                    LDQ     1,,PR4
         1 000014   000022 772000                    QRL     18
         1 000015   200005 475500                    LDP5    @DIM_CNT,,AUTO
         1 000016   500000 756100                    STQ     0,,PR5

      146    12900    1        DIM_CNTM1 = DIM_CNT - 1;

  12900  1 000017   000001 136007                    SBLQ    1,DL
         1 000020   200007 756100                    STQ     DIM_CNTM1,,AUTO

      147    12901    2        DO IDX_LOOP = 0 TO DIM_CNTM1;

  12901  1 000021   200033 450100                    STZ     IDX_LOOP,,AUTO
         1 000022   002023 710000 1                  TRA     s:13295+1
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:26   

      148    12902    2             SIZE = 0;

  12902  1 000023   200032 450100                    STZ     SIZE,,AUTO

      149    12903    2             RFLAG = '0'B;

  12903  1 000024   200043 450100                    STZ     RFLAG,,AUTO

      150    12904    2             TEMP$ = SUBREF$ -> O.SUBLK$(IDX_LOOP); /* PTR TO INDEX */

  12904  1 000025   200003 470500                    LDP0    @SUBREF$,,AUTO
         1 000026   000000 471500                    LDP1    0,,PR0
         1 000027   200033 720100                    LXL0    IDX_LOOP,,AUTO
         1 000030   100003 236110                    LDQ     3,X0,PR1
         1 000031   200027 756100                    STQ     TEMP$,,AUTO

      151    12905    2             IF TEMP$ -> O.NSUBLKS > 1

  12905  1 000032   200027 473500                    LDP3    TEMP$,,AUTO
         1 000033   300001 221100                    LDX1    1,,PR3
         1 000034   000002 101003                    CMPX1   2,DU
         1 000035   000052 602000 1                  TNC     s:12916

      152    12906    3             THEN DO;                      /* FOUND RANGE SPECIFICATION */

      153    12907    3                  RFLAG = '1'B;

  12907  1 000036   400000 236003                    LDQ     -131072,DU
         1 000037   200043 756100                    STQ     RFLAG,,AUTO

      154    12908    3                  RANGE_FLAG = '1'B;

  12908  1 000040   200004 474500                    LDP4    @RANGE_FLAG,,AUTO
         1 000041   400000 756100                    STQ     0,,PR4

      155    12909    3                  S_D.RANGE_CNT = S_D.RANGE_CNT + 1;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:27   

  12909  1 000042   000000 471400 xsym               LDP1    S_D$
         1 000043   100062 054100                    AOS     50,,PR1

      156    12910    3                  IF S_D.RANGE_CNT > 2

  12910  1 000044   100062 235100                    LDA     50,,PR1
         1 000045   000002 115007                    CMPA    2,DL
         1 000046   000052 604400 1                  TMOZ    s:12916

      157    12911    4                  THEN DO;

      158    12912    4                       S_D.ERROR = 39; /* E@SUBRANGE */

  12912  1 000047   000047 235007                    LDA     39,DL
         1 000050   100013 755100                    STA     11,,PR1

      159    12913    4                       ALTRETURN;

  12913  1 000051   000000 702200 xent               TSX2  ! X66_AALT

      160    12914    4                     END;
      161    12915    3                END;
      162    12916    3             DO RANGE_LOOP = 0 TO TEMP$ -> O.NSUBLKS - 1;

  12916  1 000052   200042 450100                    STZ     RANGE_LOOP,,AUTO
         1 000053   002015 710000 1                  TRA     s:13294+1

      163    12917    3                  IF RFLAG

  12917  1 000054   200043 234100                    SZN     RFLAG,,AUTO
         1 000055   000066 605000 1                  TPL     s:12921

      164    12918    3                  THEN IF RANGE_LOOP = 0

  12918  1 000056   200042 235100                    LDA     RANGE_LOOP,,AUTO
         1 000057   000063 601000 1                  TNZ     s:12920
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:28   

      165    12919    3                       THEN IDX_ICODE = %LIDX_ICODE; /* LIDX_ICODE */

  12919  1 000060   000003 236007                    LDQ     3,DL
         1 000061   200034 756100                    STQ     IDX_ICODE,,AUTO
         1 000062   000070 710000 1                  TRA     s:12922

      166    12920    3                       ELSE IDX_ICODE = %UIDX_ICODE; /* UIDX_ICODE */

  12920  1 000063   000004 236007                    LDQ     4,DL
         1 000064   200034 756100                    STQ     IDX_ICODE,,AUTO
         1 000065   000070 710000 1                  TRA     s:12922

      167    12921    3                  ELSE IDX_ICODE = %SIDX_ICODE; /*SIDX_ICODE */

  12921  1 000066   000002 235007                    LDA     2,DL
         1 000067   200034 755100                    STA     IDX_ICODE,,AUTO

      168    12922    3                  I$ = TEMP$ -> O.SUBLK$(RANGE_LOOP);

  12922  1 000070   200027 470500                    LDP0    TEMP$,,AUTO
         1 000071   200042 720100                    LXL0    RANGE_LOOP,,AUTO
         1 000072   000003 236110                    LDQ     3,X0,PR0
         1 000073   200026 756100                    STQ     I$,,AUTO

      169    12923    3                  CALL DDD$PQLIST(I$, BASED_FLAG) ALTRET (SERR);

  12923  1 000074   200023 631500                    EPPR1   BASED_FLAG,,AUTO
         1 000075   200157 451500                    STP1    CNT+3,,AUTO
         1 000076   200026 633500                    EPPR3   I$,,AUTO
         1 000077   200156 453500                    STP3    CNT+2,,AUTO
         1 000100   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000101   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000102   000000 701000 xent               TSX1    DDD$PQLIST
         1 000103   002032 702000 1                  TSX2    SERR

      170    12924    3                  SDD$ = S_D.D$;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:29   

  12924  1 000104   000000 470400 xsym               LDP0    S_D$
         1 000105   000044 236100                    LDQ     36,,PR0
         1 000106   200062 756100                    STQ     SDD$,,AUTO

      171    12925    3                  I$ = I$ -> O.SUBLK$(I$ -> O.NSUBLKS - 1);

  12925  1 000107   200026 471500                    LDP1    I$,,AUTO
         1 000110   100001 220100                    LDX0    1,,PR1
         1 000111   100002 236110                    LDQ     2,X0,PR1
         1 000112   200026 756100                    STQ     I$,,AUTO

      172    12926                                                /* I$ NOW POINTS TO ACTUAL INDEX ITEM */
      173    12927    3                  IF I$ -> O.CODE = 40 /* VAREXP_CODE */

  12927  1 000113   200026 471500                    LDP1    I$,,AUTO
         1 000114   100000 720100                    LXL0    0,,PR1
         1 000115   000050 100003                    CMPX0   40,DU
         1 000116   001556 601000 1                  TNZ     s:13217

      174    12928    4                  THEN DO;                 /* BUILD VARIABLE REFERENCE INDEX */

      175    12929    4                       ARRAY_FLAG = '0'B;

  12929  1 000117   200024 450100                    STZ     ARRAY_FLAG,,AUTO

      176    12930    4                       MY_DIM_CNT = 0;

  12930  1 000120   200011 450100                    STZ     MY_DIM_CNT,,AUTO

      177    12931    4                       IPTR$ = SDD$;       /* Remember in case implied PTR */

  12931  1 000121   200062 236100                    LDQ     SDD$,,AUTO
         1 000122   200060 756100                    STQ     IPTR$,,AUTO

      178    12932    4                       IF I$ -> O.NSUBLKS > 1

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:30   
  12932  1 000123   100001 220100                    LDX0    1,,PR1
         1 000124   000002 100003                    CMPX0   2,DU
         1 000125   000166 602000 1                  TNC     s:12950

      179    12933    5                       THEN DO;            /* PROCESS SUBREF (RECURSE) */

      180    12934    5                            IF I$ -> O.NSUBLKS >2

  12934  1 000126   000003 100003                    CMPX0   3,DU
         1 000127   000134 603000 1                  TRC     s:12937
         1 000130   100004 473500                    LDP3    4,,PR1
         1 000131   300000 721100                    LXL1    0,,PR3
         1 000132   000054 101003                    CMPX1   44,DU
         1 000133   000137 600000 1                  TZE     s:12940

      181    12935    5                              OR I$ -> O.SUBLK$(1) -> O.CODE ~= 44 /*SUBREF_CODE */
      182    12936    6                            THEN DO;

      183    12937    6                                 S_D.ERROR = 190; /* E@BAD_SUBREF_EXP */

  12937  1 000134   000276 235007                    LDA     190,DL
         1 000135   000013 755100                    STA     11,,PR0

      184    12938    6                                 ALTRETURN;

  12938  1 000136   000000 702200 xent               TSX2  ! X66_AALT

      185    12939    6                               END;
      186    12940    5                            ARRAY_FLAG = '1'B;

  12940  1 000137   400000 236003                    LDQ     -131072,DU
         1 000140   200024 756100                    STQ     ARRAY_FLAG,,AUTO

      187    12941    5                            CALL DDD$SUBREF(I$ -> O.SUBLK$(1), MY_RANGE_FLAG,

  12941  1 000141   200013 634500                    EPPR4   MY_MULT,,AUTO
         1 000142   200161 454500                    STP4    CNT+5,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:31   
         1 000143   200011 633500                    EPPR3   MY_DIM_CNT,,AUTO
         1 000144   200160 453500                    STP3    CNT+4,,AUTO
         1 000145   200010 635500                    EPPR5   MY_RANGE_FLAG,,AUTO
         1 000146   200157 455500                    STP5    CNT+3,,AUTO
         1 000147   200026 236100                    LDQ     I$,,AUTO
         1 000150   000004 036003                    ADLQ    4,DU
         1 000151   200156 756100                    STQ     CNT+2,,AUTO
         1 000152   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000153   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000154   000000 701000 1                  TSX1    s:43
         1 000155   002032 702000 1                  TSX2    SERR

      188    12942    5                              MY_DIM_CNT, MY_MULT) ALTRET(SERR);
      189    12943    5                            SDD$ = S_D.D$;

  12943  1 000156   000000 470400 xsym               LDP0    S_D$
         1 000157   000044 236100                    LDQ     36,,PR0
         1 000160   200062 756100                    STQ     SDD$,,AUTO

      190    12944    5                            IF MY_RANGE_FLAG

  12944  1 000161   200010 234100                    SZN     MY_RANGE_FLAG,,AUTO
         1 000162   000166 605000 1                  TPL     s:12950

      191    12945    6                            THEN DO;

      192    12946    6                                 S_D.ERROR = 192; /* E@BAD_SUBREF_RNGE */

  12946  1 000163   000300 235007                    LDA     192,DL
         1 000164   000013 755100                    STA     11,,PR0

      193    12947    6                                 ALTRETURN;

  12947  1 000165   000000 702200 xent               TSX2  ! X66_AALT

      194    12948    6                               END;
      195    12949    5                          END;             /* PROCESS SUBREF (RECURSE) */
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:32   
      196    12950    4                       I$ = I$ -> O.SUBLK$(0); /* SYMLIST */

  12950  1 000166   200026 471500                    LDP1    I$,,AUTO
         1 000167   100003 236100                    LDQ     3,,PR1
         1 000170   200026 756100                    STQ     I$,,AUTO

      197    12951    4                       XQUAL = '0'B;

  12951  1 000171   200025 450100                    STZ     XQUAL,,AUTO

      198    12952    4                       SYM$ = I$ -> O.SUBLK$(0) -> O.SUBLK$(0);

  12952  1 000172   200026 471500                    LDP1    I$,,AUTO
         1 000173   100003 473500                    LDP3    3,,PR1
         1 000174   300003 236100                    LDQ     3,,PR3
         1 000175   200030 756100                    STQ     SYM$,,AUTO

      199    12953    4                       CALL DDS$V_SRCH(I$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);

  12953  1 000176   200066 634500                    EPPR4   ENTRY#,,AUTO
         1 000177   200160 454500                    STP4    CNT+4,,AUTO
         1 000200   200044 633500                    EPPR3   ENTRY$,,AUTO
         1 000201   200157 453500                    STP3    CNT+3,,AUTO
         1 000202   200026 635500                    EPPR5   I$,,AUTO
         1 000203   200156 455500                    STP5    CNT+2,,AUTO
         1 000204   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000205   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000206   000000 701000 xent               TSX1    DDS$V_SRCH
         1 000207   000261 702000 1                  TSX2    GOT_VAR

      200    12954    4                       HIGH_ENTRY# = ENTRY#.C;

  12954  1 000210   200066 235100                    LDA     ENTRY#,,AUTO
         1 000211   200045 755100                    STA     HIGH_ENTRY#,,AUTO

      201    12955    4                       IF S_D.XSCH.OK

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:33   
  12955  1 000212   000000 470400 xsym               LDP0    S_D$
         1 000213   000751 234100                    SZN     489,,PR0
         1 000214   000247 605000 1                  TPL     s:12966

      202    12956    5                       THEN DO;

      203    12957    5                            CALL DDS$SET_Q2T;

  12957  1 000215   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000216   000000 701000 xent               TSX1    DDS$SET_Q2T
         1 000217   000000 011000                    NOP     0

      204    12958    5                            CALL DDS$SET_X2Q ALTRET( BADSCHEMA );

  12958  1 000220   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000221   000000 701000 xent               TSX1    DDS$SET_X2Q
         1 000222   002027 702000 1                  TSX2    BADSCHEMA

      205    12959    5                            XQUAL = '1'B;

  12959  1 000223   400000 236003                    LDQ     -131072,DU
         1 000224   200025 756100                    STQ     XQUAL,,AUTO

      206    12960    5                            CALL DDS$V_SRCH(I$, ENTRY$, ENTRY#) ALTRET(GOT_VAR);

  12960  1 000225   200066 630500                    EPPR0   ENTRY#,,AUTO
         1 000226   200160 450500                    STP0    CNT+4,,AUTO
         1 000227   200044 631500                    EPPR1   ENTRY$,,AUTO
         1 000230   200157 451500                    STP1    CNT+3,,AUTO
         1 000231   200026 633500                    EPPR3   I$,,AUTO
         1 000232   200156 453500                    STP3    CNT+2,,AUTO
         1 000233   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000234   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000235   000000 701000 xent               TSX1    DDS$V_SRCH
         1 000236   000261 702000 1                  TSX2    GOT_VAR

      207    12961    5                            IF ENTRY#.C > HIGH_ENTRY#
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:34   

  12961  1 000237   200045 236100                    LDQ     HIGH_ENTRY#,,AUTO
         1 000240   200066 116100                    CMPQ    ENTRY#,,AUTO
         1 000241   000244 603000 1                  TRC     s:12963

      208    12962    5                            THEN HIGH_ENTRY# = ENTRY#.C;

  12962  1 000242   200066 235100                    LDA     ENTRY#,,AUTO
         1 000243   200045 755100                    STA     HIGH_ENTRY#,,AUTO

      209    12963    5                            CALL DDS$SET_T2Q ALTRET( BADSCHEMA );

  12963  1 000244   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000245   000000 701000 xent               TSX1    DDS$SET_T2Q
         1 000246   002027 702000 1                  TSX2    BADSCHEMA

      210    12964    5                          END;

      211    12965                                                /* NOT FOUND, MUST BE ERROR */
      212    12966    4                       SYM$ = I$ -> O.SUBLK$( HIGH_ENTRY# ) -> O.SUBLK$(0);

  12966  1 000247   200026 470500                    LDP0    I$,,AUTO
         1 000250   200045 720100                    LXL0    HIGH_ENTRY#,,AUTO
         1 000251   000003 471510                    LDP1    3,X0,PR0
         1 000252   100003 236100                    LDQ     3,,PR1
         1 000253   200030 756100                    STQ     SYM$,,AUTO

      213    12967    4                       S_D.ERROR = 3; /* E@SYM_NOTFOUND */

  12967  1 000254   000003 235007                    LDA     3,DL
         1 000255   000000 473400 xsym               LDP3    S_D$
         1 000256   300013 755100                    STA     11,,PR3

      214    12968    4                       S_D.ERROR_SYM$ = SYM$;

  12968  1 000257   300032 756100                    STQ     26,,PR3

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:35   
      215    12969    4                       ALTRETURN;

  12969  1 000260   000000 702200 xent               TSX2  ! X66_AALT

      216    12970    4   GOT_VAR:
      217    12971                                                /* PERFORM VARIOUS CONSISTENCY CHECKS */
      218    12972    4                       IF XQUAL

  12972  1 000261   200025 234100       GOT_VAR      SZN     XQUAL,,AUTO
         1 000262   000266 605000 1                  TPL     s:12974

      219    12973    4                       THEN CALL DDS$SET_T2Q ALTRET( BADSCHEMA );

  12973  1 000263   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000264   000000 701000 xent               TSX1    DDS$SET_T2Q
         1 000265   002027 702000 1                  TSX2    BADSCHEMA

      220    12974    4                       ATYP = B$VREBL.ADDRTYP - 1;

  12974  1 000266   200044 470500                    LDP0    ENTRY$,,AUTO
         1 000267   000000 236100                    LDQ     0,,PR0
         1 000270   000010 772000                    QRL     8
         1 000271   000017 376007                    ANQ     15,DL
         1 000272   000001 136007                    SBLQ    1,DL
         1 000273   200052 756100                    STQ     ATYP,,AUTO

      221    12975    4                       DTYP = B$VREBL.DATATYP;

  12975  1 000274   000000 236100                    LDQ     0,,PR0
         1 000275   000002 772000                    QRL     2
         1 000276   000077 376007                    ANQ     63,DL
         1 000277   200053 756100                    STQ     DTYP,,AUTO

      222    12976    4                       DIMS = 0;

  12976  1 000300   200012 450100                    STZ     DIMS,,AUTO

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:36   
      223    12977    5                       DO I = 1 TO ENTRY#.C;

  12977  1 000301   000001 235007                    LDA     1,DL
         1 000302   200054 755100                    STA     I,,AUTO
         1 000303   000361 710000 1                  TRA     s:12994+1

      224    12978    5                            STRUCT = ENTRY#.C - I + 1;

  12978  1 000304   200066 236100                    LDQ     ENTRY#,,AUTO
         1 000305   200054 136100                    SBLQ    I,,AUTO
         1 000306   000001 036007                    ADLQ    1,DL
         1 000307   200050 756100                    STQ     STRUCT,,AUTO

      225    12979    5                            IF ENTRY#.C ~= 1

  12979  1 000310   200066 235100                    LDA     ENTRY#,,AUTO
         1 000311   000001 115007                    CMPA    1,DL
         1 000312   000323 600000 1                  TZE     s:12981

      226    12980    5                            THEN CALL DDF$VREBL_#(ENTRY#.E(STRUCT), ENTRY$) ALTRET(
             12980                                     BADSCHEMA);

  12980  1 000313   200044 630500                    EPPR0   ENTRY$,,AUTO
         1 000314   200157 450500                    STP0    CNT+3,,AUTO
         1 000315   200067 631506                    EPPR1   ENTRY#+1,QL,AUTO
         1 000316   200156 451500                    STP1    CNT+2,,AUTO
         1 000317   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000320   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000321   000000 701000 xent               TSX1    DDF$VREBL_#
         1 000322   002027 702000 1                  TSX2    BADSCHEMA

      227    12981    5                            ARRAYTYP = B$VREBL.ARRAYTYP;

  12981  1 000323   200044 470500                    LDP0    ENTRY$,,AUTO
         1 000324   000001 236100                    LDQ     1,,PR0
         1 000325   000004 772000                    QRL     4
         1 000326   000017 376007                    ANQ     15,DL
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:37   
         1 000327   200022 756100                    STQ     ARRAYTYP,,AUTO

      228    12982    6                            DO CASE( ARRAYTYP );

  12982  1 000330   000006 116007                    CMPQ    6,DL
         1 000331   000333 602006 1                  TNC     s:12982+3,QL
         1 000332   000352 710000 1                  TRA     s:12990
         1 000333   000360 710000 1                  TRA     s:12994
         1 000334   000341 710000 1                  TRA     s:12986
         1 000335   000341 710000 1                  TRA     s:12986
         1 000336   000345 710000 1                  TRA     s:12988
         1 000337   000345 710000 1                  TRA     s:12988
         1 000340   000345 710000 1                  TRA     s:12988

      229    12983    6                              CASE( %SCALAR_ARRAY );

      230    12984                                                /* Do nothing */
      231    12985    6                              CASE( %VECTOR0_ARRAY, %VECTOR1_ARRAY );

      232    12986    6                                 DIMS = DIMS + 1;

  12986  1 000341   200012 235100                    LDA     DIMS,,AUTO
         1 000342   000001 035007                    ADLA    1,DL
         1 000343   200012 755100                    STA     DIMS,,AUTO
         1 000344   000360 710000 1                  TRA     s:12994

      233    12987    6                              CASE( %REAL_ARRAY, %VIRTUAL_ARRAY, %ADJUSTABLE_ARRAY );

      234    12988    6                                 DIMS = DIMS + B$VREBL.DIMS ;

  12988  1 000345   000004 236100                    LDQ     4,,PR0
         1 000346   000022 772000                    QRL     18
         1 000347   200012 036100                    ADLQ    DIMS,,AUTO
         1 000350   200012 756100                    STQ     DIMS,,AUTO
         1 000351   000360 710000 1                  TRA     s:12994

      235    12989    6                              CASE( ELSE );
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:38   

      236    12990    6                                 S_D.ERROR_SYM$ = SYM$;

  12990  1 000352   200030 236100                    LDQ     SYM$,,AUTO
         1 000353   000000 471400 xsym               LDP1    S_D$
         1 000354   100032 756100                    STQ     26,,PR1

      237    12991    6                                 S_D.ERROR = 187; /* E@NOTIMPLARRAY */

  12991  1 000355   000273 235007                    LDA     187,DL
         1 000356   100013 755100                    STA     11,,PR1

      238    12992    6                                 ALTRETURN;

  12992  1 000357   000000 702200 xent               TSX2  ! X66_AALT

      239    12993    6                              END;         /* DO CASE( ARRAYTYP ) */

      240    12994    5                          END;             /* DO I = 0 TO ENTRY#.C */

  12994  1 000360   200054 054100                    AOS     I,,AUTO
         1 000361   200066 236100                    LDQ     ENTRY#,,AUTO
         1 000362   000304 604000 1                  TMI     s:12978
         1 000363   200054 116100                    CMPQ    I,,AUTO
         1 000364   000304 605000 1                  TPL     s:12978

      241    12995    4                       IF ENTRY#.C > 1

  12995  1 000365   000002 116007                    CMPQ    2,DL
         1 000366   000377 602000 1                  TNC     s:12997

      242    12996    4                       THEN CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(
             12996                                BADSCHEMA);

  12996  1 000367   200044 631500                    EPPR1   ENTRY$,,AUTO
         1 000370   200157 451500                    STP1    CNT+3,,AUTO
         1 000371   200067 633506                    EPPR3   ENTRY#+1,QL,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:39   
         1 000372   200156 453500                    STP3    CNT+2,,AUTO
         1 000373   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000374   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000375   000000 701000 xent               TSX1    DDF$VREBL_#
         1 000376   002027 702000 1                  TSX2    BADSCHEMA

      243    12997    4                       IF MY_DIM_CNT ~= DIMS

  12997  1 000377   200011 236100                    LDQ     MY_DIM_CNT,,AUTO
         1 000400   000403 604000 1                  TMI     s:12999
         1 000401   200012 116100                    CMPQ    DIMS,,AUTO
         1 000402   000413 600000 1                  TZE     s:13004

      244    12998    5                       THEN DO;

      245    12999    5                            S_D.ERROR_HICHAR = DIMS;

  12999  1 000403   000000 470400 xsym               LDP0    S_D$
         1 000404   200012 235100                    LDA     DIMS,,AUTO
         1 000405   004753 755100                    STA     2539,,PR0

      246    13000    5                            S_D.ERROR = 188; /* E@WRONG#SUBS */

  13000  1 000406   000274 235007                    LDA     188,DL
         1 000407   000013 755100                    STA     11,,PR0

      247    13001    5                            S_D.ERROR_SYM$ = SYM$;

  13001  1 000410   200030 236100                    LDQ     SYM$,,AUTO
         1 000411   000032 756100                    STQ     26,,PR0

      248    13002    5                            ALTRETURN;

  13002  1 000412   000000 702200 xent               TSX2  ! X66_AALT

      249    13003    5                          END;
      250    13004    4                       IF BASED_FLAG AND NOT (ATYP = 2 OR ATYP = 3 OR ATYP = 4 OR ATYP
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:40   
             13004                                = 6 OR ATYP = 7)

  13004  1 000413   200023 234100                    SZN     BASED_FLAG,,AUTO
         1 000414   000436 605000 1                  TPL     s:13010
         1 000415   200052 235100                    LDA     ATYP,,AUTO
         1 000416   000002 115007                    CMPA    2,DL
         1 000417   000436 600000 1                  TZE     s:13010
         1 000420   000003 115007                    CMPA    3,DL
         1 000421   000436 600000 1                  TZE     s:13010
         1 000422   000004 115007                    CMPA    4,DL
         1 000423   000436 600000 1                  TZE     s:13010
         1 000424   000006 115007                    CMPA    6,DL
         1 000425   000436 600000 1                  TZE     s:13010
         1 000426   000007 115007                    CMPA    7,DL
         1 000427   000436 600000 1                  TZE     s:13010

      251    13005    5                       THEN DO;

      252    13006    5                            S_D.ERROR = 9; /* E@VAR_REF */

  13006  1 000430   000011 235007                    LDA     9,DL
         1 000431   000000 470400 xsym               LDP0    S_D$
         1 000432   000013 755100                    STA     11,,PR0

      253    13007    5                            S_D.ERROR_SYM$ = SYM$;

  13007  1 000433   200030 236100                    LDQ     SYM$,,AUTO
         1 000434   000032 756100                    STQ     26,,PR0

      254    13008    5                            ALTRETURN;

  13008  1 000435   000000 702200 xent               TSX2  ! X66_AALT

      255    13009    5                          END;
      256    13010    4                       PUP = '0'B;

  13010  1 000436   200046 450100                    STZ     PUP,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:41   

      257    13011    5                       DO CASE( DTYP );

  13011  1 000437   200053 235100                    LDA     DTYP,,AUTO
         1 000440   000056 115007                    CMPA    46,DL
         1 000441   000443 602005 1                  TNC     s:13011+4,AL
         1 000442   000556 710000 1                  TRA     s:13033
         1 000443   000556 710000 1                  TRA     s:13033
         1 000444   000521 710000 1                  TRA     s:13013
         1 000445   000521 710000 1                  TRA     s:13013
         1 000446   000556 710000 1                  TRA     s:13033
         1 000447   000556 710000 1                  TRA     s:13033
         1 000450   000556 710000 1                  TRA     s:13033
         1 000451   000556 710000 1                  TRA     s:13033
         1 000452   000556 710000 1                  TRA     s:13033
         1 000453   000556 710000 1                  TRA     s:13033
         1 000454   000523 710000 1                  TRA     s:13015
         1 000455   000556 710000 1                  TRA     s:13033
         1 000456   000556 710000 1                  TRA     s:13033
         1 000457   000556 710000 1                  TRA     s:13033
         1 000460   000556 710000 1                  TRA     s:13033
         1 000461   000556 710000 1                  TRA     s:13033
         1 000462   000556 710000 1                  TRA     s:13033
         1 000463   000556 710000 1                  TRA     s:13033
         1 000464   000556 710000 1                  TRA     s:13033
         1 000465   000556 710000 1                  TRA     s:13033
         1 000466   000556 710000 1                  TRA     s:13033
         1 000467   000556 710000 1                  TRA     s:13033
         1 000470   000556 710000 1                  TRA     s:13033
         1 000471   000556 710000 1                  TRA     s:13033
         1 000472   000556 710000 1                  TRA     s:13033
         1 000473   000521 710000 1                  TRA     s:13013
         1 000474   000526 710000 1                  TRA     s:13017
         1 000475   000556 710000 1                  TRA     s:13033
         1 000476   000556 710000 1                  TRA     s:13033
         1 000477   000556 710000 1                  TRA     s:13033
         1 000500   000556 710000 1                  TRA     s:13033
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:42   
         1 000501   000556 710000 1                  TRA     s:13033
         1 000502   000531 710000 1                  TRA     s:13019
         1 000503   000556 710000 1                  TRA     s:13033
         1 000504   000556 710000 1                  TRA     s:13033
         1 000505   000556 710000 1                  TRA     s:13033
         1 000506   000556 710000 1                  TRA     s:13033
         1 000507   000556 710000 1                  TRA     s:13033
         1 000510   000556 710000 1                  TRA     s:13033
         1 000511   000556 710000 1                  TRA     s:13033
         1 000512   000556 710000 1                  TRA     s:13033
         1 000513   000534 710000 1                  TRA     s:13021
         1 000514   000537 710000 1                  TRA     s:13023
         1 000515   000542 710000 1                  TRA     s:13025
         1 000516   000545 710000 1                  TRA     s:13027
         1 000517   000550 710000 1                  TRA     s:13029
         1 000520   000553 710000 1                  TRA     s:13031

      258    13012    5                         CASE( 1,2,24 );   /* SBIN, Double SBIN, UBIN */

      259    13013    5                            TBITS = '000000'B;

  13013  1 000521   200051 450100                    STZ     TBITS,,AUTO
         1 000522   000564 710000 1                  TRA     s:13037

      260    13014    5                         CASE( 9 );        /* Packed, leading, ASCII */

      261    13015    5                            TBITS = '010100'B;

  13015  1 000523   240000 236003                    LDQ     81920,DU
         1 000524   200051 756100                    STQ     TBITS,,AUTO
         1 000525   000564 710000 1                  TRA     s:13037

      262    13016    5                         CASE( 25 );       /* Packed, trailing, ASCII */

      263    13017    5                            TBITS = '011000'B;

  13017  1 000526   300000 236003                    LDQ     98304,DU
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:43   
         1 000527   200051 756100                    STQ     TBITS,,AUTO
         1 000530   000564 710000 1                  TRA     s:13037

      264    13018    5                         CASE( 31 );       /* Packed, trailing, EBCDIC */

      265    13019    5                            TBITS = '011010'B;

  13019  1 000531   320000 236003                    LDQ     106496,DU
         1 000532   200051 756100                    STQ     TBITS,,AUTO
         1 000533   000564 710000 1                  TRA     s:13037

      266    13020    5                         CASE( 40 );       /* Packed, unsigned */

      267    13021    5                            TBITS = '010000'B;

  13021  1 000534   200000 236003                    LDQ     65536,DU
         1 000535   200051 756100                    STQ     TBITS,,AUTO
         1 000536   000564 710000 1                  TRA     s:13037

      268    13022    5                         CASE( 41 );       /* Unpacked, unsigned */

      269    13023    5                            TBITS = '100000'B;

  13023  1 000537   400000 236003                    LDQ     -131072,DU
         1 000540   200051 756100                    STQ     TBITS,,AUTO
         1 000541   000564 710000 1                  TRA     s:13037

      270    13024    5                         CASE( 42 );       /* Unpacked, leading, separate */

      271    13025    5                            TBITS = '100100'B;

  13025  1 000542   440000 236003                    LDQ     -114688,DU
         1 000543   200051 756100                    STQ     TBITS,,AUTO
         1 000544   000564 710000 1                  TRA     s:13037

      272    13026    5                         CASE( 43 );       /* Unpacked, trailing, separate */

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:44   
      273    13027    5                            TBITS = '101000'B;

  13027  1 000545   500000 236003                    LDQ     -98304,DU
         1 000546   200051 756100                    STQ     TBITS,,AUTO
         1 000547   000564 710000 1                  TRA     s:13037

      274    13028    5                         CASE( 44 );       /* Unpacked, leading, overpunched */

      275    13029    5                            TBITS = '100101'B;

  13029  1 000550   450000 236003                    LDQ     -110592,DU
         1 000551   200051 756100                    STQ     TBITS,,AUTO
         1 000552   000564 710000 1                  TRA     s:13037

      276    13030    5                         CASE( 45 );       /* Unpacked, trailing, overpunched */

      277    13031    5                            TBITS = '101001'B;

  13031  1 000553   510000 236003                    LDQ     -94208,DU
         1 000554   200051 756100                    STQ     TBITS,,AUTO
         1 000555   000564 710000 1                  TRA     s:13037

      278    13032    5                         CASE( ELSE );

      279    13033    5                            S_D.ERROR = 191; /* E@BAD_SUBREF_DST */

  13033  1 000556   000277 235007                    LDA     191,DL
         1 000557   000000 470400 xsym               LDP0    S_D$
         1 000560   000013 755100                    STA     11,,PR0

      280    13034    5                            S_D.ERROR_SYM$ = SYM$;

  13034  1 000561   200030 236100                    LDQ     SYM$,,AUTO
         1 000562   000032 756100                    STQ     26,,PR0

      281    13035    5                            ALTRETURN;

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:45   
  13035  1 000563   000000 702200 xent               TSX2  ! X66_AALT

      282    13036    5                         END;              /* DO CASE( DTYP ) */

      283    13037    4                       PUP.BITS = TBITS;

  13037  1 000564   200051 236100                    LDQ     TBITS,,AUTO
         1 000565   000036 772000                    QRL     30
         1 000566   200046 752101                    STCQ    PUP,'01'O,AUTO

      284    13038    4                       IF PUP AND B$VREBL.SCALE ~= 0

  13038  1 000567   200046 236100                    LDQ     PUP,,AUTO
         1 000570   000603 600000 1                  TZE     s:13044
         1 000571   200044 470500                    LDP0    ENTRY$,,AUTO
         1 000572   000003 236100                    LDQ     3,,PR0
         1 000573   000377 316007                    CANQ    255,DL
         1 000574   000603 600000 1                  TZE     s:13044

      285    13039    5                       THEN DO;

      286    13040    5                            S_D.ERROR = 195; /* E@BAD_SUBREF_SCAL */

  13040  1 000575   000303 235007                    LDA     195,DL
         1 000576   000000 471400 xsym               LDP1    S_D$
         1 000577   100013 755100                    STA     11,,PR1

      287    13041    5                            S_D.ERROR_SYM$ = SYM$;

  13041  1 000600   200030 236100                    LDQ     SYM$,,AUTO
         1 000601   100032 756100                    STQ     26,,PR1

      288    13042    5                            ALTRETURN;

  13042  1 000602   000000 702200 xent               TSX2  ! X66_AALT

      289    13043    5                          END;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:46   
      290    13044    4                       IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  13044  1 000603   000000 470400 xsym               LDP0    S_D$
         1 000604   006714 235100                    LDA     3532,,PR0
         1 000605   000001 115007                    CMPA    1,DL
         1 000606   000621 601000 1                  TNZ     s:13046

      291    13045    4                       THEN PUP.SIZE = B$VREBL.LOGSIZ * TYPESIZE_MULT( DTYP );

  13045  1 000607   200053 720100                    LXL0    DTYP,,AUTO
         1 000610   200044 471500                    LDP1    ENTRY$,,AUTO
         1 000611   100001 236100                    LDQ     1,,PR1
         1 000612   000022 772000                    QRL     18
         1 000613   000000 402010 xsym               MPY     TYPESIZE_MULT,X0
         1 000614   000016 736000                    QLS     14
         1 000615   200046 676100                    ERQ     PUP,,AUTO
         1 000616   000000 376000 2                  ANQ     0
         1 000617   200046 656100                    ERSQ    PUP,,AUTO
         1 000620   000632 710000 1                  TRA     s:13047

      292    13046    4                       ELSE PUP.SIZE = B$VREBL.LOGSIZ * TYPESIZE_MULT_FEP( DTYP );

  13046  1 000621   200053 720100                    LXL0    DTYP,,AUTO
         1 000622   200044 471500                    LDP1    ENTRY$,,AUTO
         1 000623   100001 236100                    LDQ     1,,PR1
         1 000624   000022 772000                    QRL     18
         1 000625   000000 402010 xsym               MPY     TYPESIZE_MULT_FEP,X0
         1 000626   000016 736000                    QLS     14
         1 000627   200046 676100                    ERQ     PUP,,AUTO
         1 000630   000000 376000 2                  ANQ     0
         1 000631   200046 656100                    ERSQ    PUP,,AUTO

      293    13047    4                       IF NOT BASED_FLAG AND (ATYP = %BASED_ACODE OR ATYP = %DCB_ACODE
             13047                                OR

  13047  1 000632   200023 234100                    SZN     BASED_FLAG,,AUTO
         1 000633   001256 604000 1                  TMI     s:13150
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:47   
         1 000634   200052 235100                    LDA     ATYP,,AUTO
         1 000635   000002 115007                    CMPA    2,DL
         1 000636   000647 600000 1                  TZE     s:13051
         1 000637   000003 115007                    CMPA    3,DL
         1 000640   000647 600000 1                  TZE     s:13051
         1 000641   000004 115007                    CMPA    4,DL
         1 000642   000647 600000 1                  TZE     s:13051
         1 000643   000006 115007                    CMPA    6,DL
         1 000644   000647 600000 1                  TZE     s:13051
         1 000645   000007 115007                    CMPA    7,DL
         1 000646   001256 601000 1                  TNZ     s:13150

      294    13048    4                         ATYP = %PARM_ACODE OR ATYP = %SPARM_ACODE OR ATYP = %
             13048                                  AREADEF_ACODE)
      295    13049         /* BASED_ACODE OR DCB_ACODE OR PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      296    13050    5                       THEN DO;

      297    13051    5                            IENTRY# = B$VREBL.IMPTR;

  13051  1 000647   100002 236100                    LDQ     2,,PR1
         1 000650   000022 732000                    QRS     18
         1 000651   200055 756100                    STQ     IENTRY#,,AUTO

      298    13052    5                            IF ATYP = 2 AND IENTRY# < 0

  13052  1 000652   000002 115007                    CMPA    2,DL
         1 000653   000663 601000 1                  TNZ     s:13058
         1 000654   000000 116003                    CMPQ    0,DU
         1 000655   000663 605000 1                  TPL     s:13058

      299    13053    6                            THEN DO;

      300    13054    6                                 S_D.ERROR = 99; /* E@NOPTR */

  13054  1 000656   000143 235007                    LDA     99,DL
         1 000657   000013 755100                    STA     11,,PR0

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:48   
      301    13055    6                                 S_D.ERROR_SYM$ = SYM$;

  13055  1 000660   200030 236100                    LDQ     SYM$,,AUTO
         1 000661   000032 756100                    STQ     26,,PR0

      302    13056    6                                 ALTRETURN;

  13056  1 000662   000000 702200 xent               TSX2  ! X66_AALT

      303    13057    6                               END;
      304    13058    5                            T$ = SDD$;

  13058  1 000663   200062 236100                    LDQ     SDD$,,AUTO
         1 000664   200057 756100                    STQ     T$,,AUTO

      305    13059    5                            CALL BUMPD$ ALTRET(SERR);

  13059  1 000665   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000666   200153 756100                    STQ     ENTRY#+53,,AUTO
         1 000667   002033 701000 1                  TSX1    BUMPD$
         1 000670   002032 702000 1                  TSX2    SERR

      306    13060    6                            DO WHILE( T$ >= IPTR$ );

  13060  1 000671   200057 236100                    LDQ     T$,,AUTO
         1 000672   200060 116100                    CMPQ    IPTR$,,AUTO
         1 000673   000704 602000 1                  TNC     s:13064

      307    13061    6                                 PINCRW(T$,SIZEW(DITEM)) -> UBIN36 = T$ -> UBIN36;

  13061  1 000674   200057 470500                    LDP0    T$,,AUTO
         1 000675   000000 235100                    LDA     0,,PR0
         1 000676   000003 755100                    STA     3,,PR0

      308    13062    6                                 T$ = PINCRW(T$, -1);

  13062  1 000677   200057 236100                    LDQ     T$,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:49   
         1 000700   777777 036003                    ADLQ    -1,DU
         1 000701   200057 756100                    STQ     T$,,AUTO

      309    13063    6                               END;        /* DO WHILE (T$ >= IPTR$ ) */

  13063  1 000702   200060 116100                    CMPQ    IPTR$,,AUTO
         1 000703   000674 603000 1                  TRC     s:13061

      310    13064    6                            DO I = 0 TO MY_DIM_CNT - 1;

  13064  1 000704   200054 450100                    STZ     I,,AUTO
         1 000705   000713 710000 1                  TRA     s:13066+1

      311    13065    6                                 MY_MULT( I ) = PINCRW(MY_MULT( I ), SIZEW(DITEM));

  13065  1 000706   200054 720100                    LXL0    I,,AUTO
         1 000707   200013 236110                    LDQ     MY_MULT,X0,AUTO
         1 000710   000003 036003                    ADLQ    3,DU
         1 000711   200013 756110                    STQ     MY_MULT,X0,AUTO

      312    13066    6                               END;

  13066  1 000712   200054 054100                    AOS     I,,AUTO
         1 000713   200054 236100                    LDQ     I,,AUTO
         1 000714   200011 116100                    CMPQ    MY_DIM_CNT,,AUTO
         1 000715   000706 604000 1                  TMI     s:13065

      313    13067    5                            IF ATYP = %BASED_ACODE /* BASED_ACODE */

  13067  1 000716   200052 235100                    LDA     ATYP,,AUTO
         1 000717   000002 115007                    CMPA    2,DL
         1 000720   001156 601000 1                  TNZ     s:13121

      314    13068    6                            THEN DO;       /* Based variable */

      315    13069    6                                 IPTR$ -> DITEM = DUMPTR;

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:50   
  13069  1 000721   200060 470500                    LDP0    IPTR$,,AUTO
         1 000722   000100 100400                    MLR     fill='000'O
         1 000723   000002 000010 0                  ADSC9   DUMPTR                   cn=0,n=8
         1 000724   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      316    13070    6                                 CALL DDF$VREBL_#(IENTRY#, IENTRY$) ALTRET(BADSCHEMA);

  13070  1 000725   200056 631500                    EPPR1   IENTRY$,,AUTO
         1 000726   200157 451500                    STP1    CNT+3,,AUTO
         1 000727   200055 633500                    EPPR3   IENTRY#,,AUTO
         1 000730   200156 453500                    STP3    CNT+2,,AUTO
         1 000731   200156 630500                    EPPR0   CNT+2,,AUTO
         1 000732   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000733   000000 701000 xent               TSX1    DDF$VREBL_#
         1 000734   002027 702000 1                  TSX2    BADSCHEMA

      317    13071    7                                 DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13071  1 000735   000000 470400 xsym               LDP0    S_D$
         1 000736   006714 235100                    LDA     3532,,PR0
         1 000737   000003 115007                    CMPA    3,DL
         1 000740   000742 602005 1                  TNC     s:13071+5,AL
         1 000741   001007 710000 1                  TRA     s:13084
         1 000742   001007 710000 1                  TRA     s:13084
         1 000743   000745 710000 1                  TRA     s:13073
         1 000744   000766 710000 1                  TRA     s:13077

      318    13072    7                                   CASE (%HOST);

      319    13073    7                                     IPTR$ -> DITEM.ADDRESS.W = IENTRY$ -> B$VREBL.ADR
             13073                                               .W;

  13073  1 000745   200060 471500                    LDP1    IPTR$,,AUTO
         1 000746   200056 473500                    LDP3    IENTRY$,,AUTO
         1 000747   300000 236100                    LDQ     0,,PR3
         1 000750   777777 376003                    ANQ     -1,DU
         1 000751   000006 772000                    QRL     6
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:51   
         1 000752   100001 752174                    STCQ    1,'74'O,PR1

      320    13074    7                                     IPTR$ -> DITEM.ADDRESS.C = IENTRY$ -> B$VREBL.ADR
             13074                                               .C;

  13074  1 000753   200056 473500                    LDP3    IENTRY$,,AUTO
         1 000754   300000 236100                    LDQ     0,,PR3
         1 000755   600000 376007                    ANQ     -65536,DL
         1 000756   000012 772000                    QRL     10
         1 000757   100001 752102                    STCQ    1,'02'O,PR1

      321    13075    7                                     IPTR$ -> DITEM.ADDRESS.B = IENTRY$ -> B$VREBL.ADR
             13075                                               .B;

  13075  1 000760   200056 473500                    LDP3    IENTRY$,,AUTO
         1 000761   300000 236100                    LDQ     0,,PR3
         1 000762   170000 376007                    ANQ     61440,DL
         1 000763   000014 772000                    QRL     12
         1 000764   100001 752101                    STCQ    1,'01'O,PR1
         1 000765   001012 710000 1                  TRA     s:13087

      322    13076    7                                   CASE (%L6);

      323    13077    7                                      IPTR$ -> DITEM.ADDRESS.W = IENTRY$

  13077  1 000766   200056 471500                    LDP1    IENTRY$,,AUTO
         1 000767   200060 473500                    LDP3    IPTR$,,AUTO
         1 000770   100000 236100                    LDQ     0,,PR1
         1 000771   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000772   000004 772000                    QRL     4
         1 000773   300001 752174                    STCQ    1,'74'O,PR3

      324    13078    7                                        -> B$VREBL.ADR6.W;
      325    13079    7                                      IPTR$ -> DITEM.ADDRESS.C = IENTRY$

  13079  1 000774   200056 471500                    LDP1    IENTRY$,,AUTO
         1 000775   100000 236100                    LDQ     0,,PR1
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:52   
         1 000776   100000 376007                    ANQ     32768,DL
         1 000777   000011 772000                    QRL     9
         1 001000   300001 752102                    STCQ    1,'02'O,PR3

      326    13080    7                                        -> B$VREBL.ADR6.C;
      327    13081    7                                      IPTR$ -> DITEM.ADDRESS.B = IENTRY$

  13081  1 001001   200056 471500                    LDP1    IENTRY$,,AUTO
         1 001002   100000 236100                    LDQ     0,,PR1
         1 001003   070000 376007                    ANQ     28672,DL
         1 001004   000014 772000                    QRL     12
         1 001005   300001 752101                    STCQ    1,'01'O,PR3
         1 001006   001012 710000 1                  TRA     s:13087

      328    13082    7                                        -> B$VREBL.ADR6.B;
      329    13083    7                                   CASE (ELSE);

      330    13084    7                                      S_D.ERROR = 502; /* E@DELBUG */

  13084  1 001007   000766 236007                    LDQ     502,DL
         1 001010   000013 756100                    STQ     11,,PR0

      331    13085    7                                      ALTRETURN;

  13085  1 001011   000000 702200 xent               TSX2  ! X66_AALT

      332    13086    7                                   END;

      333    13087    6                                 TATYP = IENTRY$ -> B$VREBL.ADDRTYP - 1;

  13087  1 001012   200056 471500                    LDP1    IENTRY$,,AUTO
         1 001013   100000 236100                    LDQ     0,,PR1
         1 001014   000010 772000                    QRL     8
         1 001015   000017 376007                    ANQ     15,DL
         1 001016   000001 136007                    SBLQ    1,DL
         1 001017   200061 756100                    STQ     TATYP,,AUTO

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:53   
      334    13088    6                                 IF TATYP = %PARM_ACODE OR TATYP = %SPARM_ACODE OR
             13088                                          TATYP = %AREADEF_ACODE

  13088  1 001020   000004 116007                    CMPQ    4,DL
         1 001021   001026 600000 1                  TZE     s:13091
         1 001022   000006 116007                    CMPQ    6,DL
         1 001023   001026 600000 1                  TZE     s:13091
         1 001024   000007 116007                    CMPQ    7,DL
         1 001025   001141 601000 1                  TNZ     s:13118

      335    13089                                      /* PARM_ACODE OR SPARM_ACODE OR AREADEF_ACODE */
      336    13090    7                                 THEN DO;
             13090                                          /* Implicit pointer is a parameter or areadef */

      337    13091    7                                      IPTR$ -> DITEM.ADDR_TYPE = %PARM_ACODE;
             13091                                               /* PARM_ACODE */

  13091  1 001026   200060 473500                    LDP3    IPTR$,,AUTO
         1 001027   004000 236007                    LDQ     2048,DL
         1 001030   300000 552110                    STBQ    0,'10'O,PR3

      338    13092    7                                      T$ = SDD$;

  13092  1 001031   200062 236100                    LDQ     SDD$,,AUTO
         1 001032   200057 756100                    STQ     T$,,AUTO

      339    13093    7                                      CALL BUMPD$ ALTRET(SERR);

  13093  1 001033   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001034   200153 756100                    STQ     ENTRY#+53,,AUTO
         1 001035   002033 701000 1                  TSX1    BUMPD$
         1 001036   002032 702000 1                  TSX2    SERR

      340    13094    8                                      DO WHILE (T$ >= IPTR$ );

  13094  1 001037   200057 236100                    LDQ     T$,,AUTO
         1 001040   200060 116100                    CMPQ    IPTR$,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:54   
         1 001041   001052 602000 1                  TNC     s:13098

      341    13095    8                                           PINCRW(T$, SIZEW(DITEM)) -> UBIN36 = T$ ->
             13095                                                    UBIN36;

  13095  1 001042   200057 470500                    LDP0    T$,,AUTO
         1 001043   000000 235100                    LDA     0,,PR0
         1 001044   000003 755100                    STA     3,,PR0

      342    13096    8                                           T$ = PINCRW(T$, -1);

  13096  1 001045   200057 236100                    LDQ     T$,,AUTO
         1 001046   777777 036003                    ADLQ    -1,DU
         1 001047   200057 756100                    STQ     T$,,AUTO

      343    13097    8                                         END; /* DO WHILE (T$ >= IPTR$) */

  13097  1 001050   200060 116100                    CMPQ    IPTR$,,AUTO
         1 001051   001042 603000 1                  TRC     s:13095

      344    13098    8                                      DO I = 0 TO DIM_CNT - 1;

  13098  1 001052   200054 450100                    STZ     I,,AUTO
         1 001053   001062 710000 1                  TRA     s:13100+1

      345    13099    8                                           MULT(I) = PINCRW(MULT(I), SIZEW(DITEM));

  13099  1 001054   200006 470500                    LDP0    @MULT,,AUTO
         1 001055   200054 720100                    LXL0    I,,AUTO
         1 001056   000000 236110                    LDQ     0,X0,PR0
         1 001057   000003 036003                    ADLQ    3,DU
         1 001060   000000 756110                    STQ     0,X0,PR0

      346    13100    8                                         END;

  13100  1 001061   200054 054100                    AOS     I,,AUTO
         1 001062   200005 470500                    LDP0    @DIM_CNT,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:55   
         1 001063   200054 236100                    LDQ     I,,AUTO
         1 001064   000000 116100                    CMPQ    0,,PR0
         1 001065   001054 604000 1                  TMI     s:13099

      347    13101    7                                      IF TATYP = %PARM_ACODE /* PARM_ACODE */

  13101  1 001066   200061 235100                    LDA     TATYP,,AUTO
         1 001067   000004 115007                    CMPA    4,DL
         1 001070   001110 601000 1                  TNZ     s:13108

      348    13102    8                                      THEN DO; /* Auto parameter */

      349    13103    8                                           IPTR$ -> DITEM.VALUEB = DESC.ITEM( %
             13103                                                    PARM_DESC ); /* PARM_DESC */

  13103  1 001071   000067 236000 xsym               LDQ     DESC+55
         1 001072   200060 471500                    LDP1    IPTR$,,AUTO
         1 001073   100001 756100                    STQ     1,,PR1

      350    13104    8                                           IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13104                                                    /* DESC_ACODE */

  13104  1 001074   100000 236007                    LDQ     32768,DL
         1 001075   100000 552110                    STBQ    0,'10'O,PR1

      351    13105    8                                          IPTR$ -> DITEM.SP.VP.N = IENTRY$ -> B$VREBL.
             13105                                                    IMPTR - 2;

  13105  1 001076   200056 473500                    LDP3    IENTRY$,,AUTO
         1 001077   300002 236100                    LDQ     2,,PR3
         1 001100   000022 732000                    QRS     18
         1 001101   000002 136007                    SBLQ    2,DL
         1 001102   000014 736000                    QLS     12
         1 001103   100001 752134                    STCQ    1,'34'O,PR1

      352    13106    8                                           ZITEM.FLAGS.MDSE.S = '1'B;
             13106                                                    /* Need SS frame */
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:56   

  13106  1 001104   200063 473500                    LDP3    ZITEM$,,AUTO
         1 001105   100000 236003                    LDQ     32768,DU
         1 001106   300001 256100                    ORSQ    1,,PR3

      353    13107    8                                         END; /* Auto parameter */

  13107  1 001107   001144 710000 1                  TRA     s:13119

      354    13108    7                                      ELSE IF TATYP = %SPARM_ACODE
             13108                                               /* Static parameter */

  13108  1 001110   000006 115007                    CMPA    6,DL
         1 001111   001123 601000 1                  TNZ     s:13114

      355    13109    8                                           THEN DO;

      356    13110    8                                                IPTR$ -> DITEM.ADDRESS.W = IENTRY$ ->
             13110                                                         B$VREBL.IMPTR;

  13110  1 001112   200060 471500                    LDP1    IPTR$,,AUTO
         1 001113   200056 473500                    LDP3    IENTRY$,,AUTO
         1 001114   300002 236100                    LDQ     2,,PR3
         1 001115   000022 732000                    QRS     18
         1 001116   000014 736000                    QLS     12
         1 001117   100001 752174                    STCQ    1,'74'O,PR1

      357    13111    8                                               IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE
             13111                                                         ; /* SPARM_ACODE */

  13111  1 001120   006000 236007                    LDQ     3072,DL
         1 001121   100000 552110                    STBQ    0,'10'O,PR1

      358    13112    8                                              END; /* Static parameter */

  13112  1 001122   001144 710000 1                  TRA     s:13119

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:57   
      359    13113    8                                           ELSE DO; /* TATYP = AREADEF_ACODE */

      360    13114    8                                               IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE
             13114                                                         ; /* CONST_ACODE */

  13114  1 001123   200060 471500                    LDP1    IPTR$,,AUTO
         1 001124   102000 236007                    LDQ     33792,DL
         1 001125   100000 552110                    STBQ    0,'10'O,PR1

      361    13115    8                                                IPTR$ -> DITEM.VALUE = PINCRW(IENTRY$,
             13115                                                         POFFW(ADDR(B$VREBL.IMPTR), ADDR(
             13115                                                         B$VREBL))) -> UBIN36;

  13115  1 001126   200044 236100                    LDQ     ENTRY$,,AUTO
         1 001127   000022 772000                    QRL     18
         1 001130   200156 756100                    STQ     CNT+2,,AUTO
         1 001131   200044 236100                    LDQ     ENTRY$,,AUTO
         1 001132   000002 036003                    ADLQ    2,DU
         1 001133   000022 772000                    QRL     18
         1 001134   200156 136100                    SBLQ    CNT+2,,AUTO
         1 001135   200056 473500                    LDP3    IENTRY$,,AUTO
         1 001136   300000 235106                    LDA     0,QL,PR3
         1 001137   100001 755100                    STA     1,,PR1

      362    13116    8                                              END; /* TATYP = AREADEF_ACODE */

      363    13117    7                                    END;
             13117                                           /* Implicit pointer is a parameter or areadef */

  13117  1 001140   001144 710000 1                  TRA     s:13119

      364    13118    6                                 ELSE IPTR$ -> DITEM.ADDR_TYPE = TATYP;

  13118  1 001141   200060 473500                    LDP3    IPTR$,,AUTO
         1 001142   000011 736000                    QLS     9
         1 001143   300000 552110                    STBQ    0,'10'O,PR3

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:58   
      365    13119    6                                 CALL DDF$VREBL_#(ENTRY#.E(ENTRY#.C), ENTRY$) ALTRET(
             13119                                          BADSCHEMA);

  13119  1 001144   200044 630500                    EPPR0   ENTRY$,,AUTO
         1 001145   200157 450500                    STP0    CNT+3,,AUTO
         1 001146   200066 720100                    LXL0    ENTRY#,,AUTO
         1 001147   200067 631510                    EPPR1   ENTRY#+1,X0,AUTO
         1 001150   200156 451500                    STP1    CNT+2,,AUTO
         1 001151   200156 630500                    EPPR0   CNT+2,,AUTO
         1 001152   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001153   000000 701000 xent               TSX1    DDF$VREBL_#
         1 001154   002027 702000 1                  TSX2    BADSCHEMA

      366    13120    6                               END;        /* Based variable */

  13120  1 001155   001254 710000 1                  TRA     s:13147

      367    13121    5                            ELSE IF ATYP = %PARM_ACODE
             13121                                     /* PARM_ACODE - auto parameter */

  13121  1 001156   000004 115007                    CMPA    4,DL
         1 001157   001200 601000 1                  TNZ     s:13129

      368    13122    6                                 THEN DO;

      369    13123    6                                      IPTR$ -> DITEM = DUMPTR;

  13123  1 001160   200060 470500                    LDP0    IPTR$,,AUTO
         1 001161   000100 100400                    MLR     fill='000'O
         1 001162   000002 000010 0                  ADSC9   DUMPTR                   cn=0,n=8
         1 001163   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      370    13124    6                                      IPTR$ -> DITEM.VALUEB = DESC.ITEM( %PARM_DESC );
             13124                                               /* PARM_DESC */

  13124  1 001164   000067 236000 xsym               LDQ     DESC+55
         1 001165   000001 756100                    STQ     1,,PR0
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:59   

      371    13125    6                                      IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13125                                               /* DESC_ACODE */

  13125  1 001166   100000 236007                    LDQ     32768,DL
         1 001167   000000 552110                    STBQ    0,'10'O,PR0

      372    13126    6                                      IPTR$ -> DITEM.SP.VP.N = IENTRY# - 2;

  13126  1 001170   200055 236100                    LDQ     IENTRY#,,AUTO
         1 001171   000002 136007                    SBLQ    2,DL
         1 001172   000014 736000                    QLS     12
         1 001173   000001 752134                    STCQ    1,'34'O,PR0

      373    13127    6                                      ZITEM.FLAGS.MDSE.S = '1'B; /* Need SS frame */

  13127  1 001174   200063 471500                    LDP1    ZITEM$,,AUTO
         1 001175   100000 236003                    LDQ     32768,DU
         1 001176   100001 256100                    ORSQ    1,,PR1

      374    13128    6                                    END;   /* Parameter */

  13128  1 001177   001254 710000 1                  TRA     s:13147

      375    13129    5                                 ELSE IF ATYP = %SPARM_ACODE
             13129                                          /* SPARM_ACODE - Static parameter */

  13129  1 001200   000006 115007                    CMPA    6,DL
         1 001201   001214 601000 1                  TNZ     s:13135

      376    13130    6                                      THEN DO;

      377    13131    6                                           IPTR$ -> DITEM = DUMPTR;

  13131  1 001202   200060 470500                    LDP0    IPTR$,,AUTO
         1 001203   000100 100400                    MLR     fill='000'O
         1 001204   000002 000010 0                  ADSC9   DUMPTR                   cn=0,n=8
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:60   
         1 001205   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      378    13132    6                                           IPTR$ -> DITEM.ADDRESS.W = IENTRY#;

  13132  1 001206   200055 236100                    LDQ     IENTRY#,,AUTO
         1 001207   000014 736000                    QLS     12
         1 001210   000001 752174                    STCQ    1,'74'O,PR0

      379    13133    6                                           IPTR$ -> DITEM.ADDR_TYPE = %SPARM_ACODE;
             13133                                                    /* SPARM_ACODE */

  13133  1 001211   006000 236007                    LDQ     3072,DL
         1 001212   000000 552110                    STBQ    0,'10'O,PR0

      380    13134    6                                         END; /* Static parameter */

  13134  1 001213   001254 710000 1                  TRA     s:13147

      381    13135    5                                      ELSE IF ATYP = %DCB_ACODE /* DCB_ACODE */

  13135  1 001214   000003 115007                    CMPA    3,DL
         1 001215   001234 601000 1                  TNZ     s:13143

      382    13136    6                                           THEN DO;

      383    13137    6                                                IPTR$ -> DITEM = DUMPTR;

  13137  1 001216   200060 470500                    LDP0    IPTR$,,AUTO
         1 001217   000100 100400                    MLR     fill='000'O
         1 001220   000002 000010 0                  ADSC9   DUMPTR                   cn=0,n=8
         1 001221   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      384    13138    6                                               IPTR$ -> DITEM.ADDR_TYPE = %DESC_ACODE;
             13138                                                         /* DESC_ACODE */

  13138  1 001222   100000 236007                    LDQ     32768,DL
         1 001223   000000 552110                    STBQ    0,'10'O,PR0
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:61   

      385    13139    6                                                IPTR$ -> DITEM.VALUEB = DESC.ITEM( %
             13139                                                         DCB_DESC ); /* DCB_DESC */

  13139  1 001224   000071 236000 xsym               LDQ     DESC+57
         1 001225   000001 756100                    STQ     1,,PR0

      386    13140    6                                                IPTR$ -> DITEM.SP.VD.DISP = IENTRY#;

  13140  1 001226   200055 236100                    LDQ     IENTRY#,,AUTO
         1 001227   000014 736000                    QLS     12
         1 001230   000001 676100                    ERQ     1,,PR0
         1 001231   000001 376000 2                  ANQ     1
         1 001232   000001 656100                    ERSQ    1,,PR0

      387    13141    6                                              END; /* ATYP = 3 (DCB) */

  13141  1 001233   001254 710000 1                  TRA     s:13147

      388    13142    6                                           ELSE DO; /* ATYP = AREADEF_ACODE */

      389    13143    6                                                IPTR$ -> DITEM = DUMPTR;

  13143  1 001234   200060 470500                    LDP0    IPTR$,,AUTO
         1 001235   000100 100400                    MLR     fill='000'O
         1 001236   000002 000010 0                  ADSC9   DUMPTR                   cn=0,n=8
         1 001237   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      390    13144    6                                               IPTR$ -> DITEM.ADDR_TYPE = %CONST_ACODE
             13144                                                         ; /* CONST_ACODE */

  13144  1 001240   102000 236007                    LDQ     33792,DL
         1 001241   000000 552110                    STBQ    0,'10'O,PR0

      391    13145    6                                                IPTR$ -> DITEM.VALUE = PINCRW(ENTRY$,
             13145                                                         POFFW(ADDR(B$VREBL.IMPTR), ADDR(
             13145                                                         B$VREBL))) -> UBIN36;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:62   

  13145  1 001242   200044 236100                    LDQ     ENTRY$,,AUTO
         1 001243   000022 772000                    QRL     18
         1 001244   200156 756100                    STQ     CNT+2,,AUTO
         1 001245   200044 236100                    LDQ     ENTRY$,,AUTO
         1 001246   000002 036003                    ADLQ    2,DU
         1 001247   000022 772000                    QRL     18
         1 001250   200156 136100                    SBLQ    CNT+2,,AUTO
         1 001251   200044 471500                    LDP1    ENTRY$,,AUTO
         1 001252   100000 235106                    LDA     0,QL,PR1
         1 001253   000001 755100                    STA     1,,PR0

      392    13146    6                                              END; /* ATYP = AREADEF_ACODE */

      393    13147    5                            ATYP = %BASED_ACODE; /* BASED_ACODE */

  13147  1 001254   000002 235007                    LDA     2,DL
         1 001255   200052 755100                    STA     ATYP,,AUTO

      394    13148    5                          END;
             13148        /* NOT BASED_FLAG AND (ATYP = 2 OR ATYP = 3 OR ATYP = 4 OR ATYP = 6 OR ATYP = 7) */

      395    13149                                                /* LOOKS OK, BUILD INDEX ITEM */
      396    13150    4                       IF BASED_FLAG

  13150  1 001256   200023 234100                    SZN     BASED_FLAG,,AUTO
         1 001257   001262 605000 1                  TPL     s:13152

      397    13151    4                       THEN ATYP = %BASED_ACODE; /* BASED_ACODE */

  13151  1 001260   000002 235007                    LDA     2,DL
         1 001261   200052 755100                    STA     ATYP,,AUTO

      398    13152    4                       DITEM = DUMINDEX;

  13152  1 001262   200062 470500                    LDP0    SDD$,,AUTO
         1 001263   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:63   
         1 001264   000000 000010 0                  ADSC9   DUMINDEX                 cn=0,n=8
         1 001265   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12

      399    13153    4                       IF DTYP = %INDEX1_DATATYPE OR /* %INDEX1_DATATYPE */

  13153  1 001266   200053 235100                    LDA     DTYP,,AUTO
         1 001267   000040 115007                    CMPA    32,DL
         1 001270   001273 600000 1                  TZE     s:13156
         1 001271   000041 115007                    CMPA    33,DL
         1 001272   001441 601000 1                  TNZ     s:13192

      400    13154    4                         DTYP = %INDEX2_DATATYPE /* %INDEX2_DATATYPE */
      401    13155    5                       THEN DO;

      402    13156    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13156  1 001273   000000 471400 xsym               LDP1    S_D$
         1 001274   106714 235100                    LDA     3532,,PR1
         1 001275   000003 115007                    CMPA    3,DL
         1 001276   001300 602005 1                  TNC     s:13156+5,AL
         1 001277   001323 710000 1                  TRA     s:13162
         1 001300   001323 710000 1                  TRA     s:13162
         1 001301   001303 710000 1                  TRA     s:13158
         1 001302   001313 710000 1                  TRA     s:13160

      403    13157    6                              CASE (%HOST);

      404    13158    6                                 ZITEM.ADDRESS.W = B$VREBL.ADR.W + 1;

  13158  1 001303   200063 473500                    LDP3    ZITEM$,,AUTO
         1 001304   200044 474500                    LDP4    ENTRY$,,AUTO
         1 001305   400000 236100                    LDQ     0,,PR4
         1 001306   000022 772000                    QRL     18
         1 001307   000001 036007                    ADLQ    1,DL
         1 001310   000014 736000                    QLS     12
         1 001311   300007 752174                    STCQ    7,'74'O,PR3
         1 001312   001326 710000 1                  TRA     s:13165
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:64   

      405    13159    6                              CASE (%L6);

      406    13160    6                                 ZITEM.ADDRESS.W = B$VREBL.ADR6.W + 1;

  13160  1 001313   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001314   200063 474500                    LDP4    ZITEM$,,AUTO
         1 001315   300000 236100                    LDQ     0,,PR3
         1 001316   000020 772000                    QRL     16
         1 001317   000001 036007                    ADLQ    1,DL
         1 001320   000014 736000                    QLS     12
         1 001321   400007 752174                    STCQ    7,'74'O,PR4
         1 001322   001326 710000 1                  TRA     s:13165

      407    13161    6                              CASE (ELSE);

      408    13162    6                                 S_D.ERROR = 502; /* E@DELBUG */

  13162  1 001323   000766 236007                    LDQ     502,DL
         1 001324   100013 756100                    STQ     11,,PR1

      409    13163    6                                 ALTRETURN;

  13163  1 001325   000000 702200 xent               TSX2  ! X66_AALT

      410    13164    6                              END;

      411    13165    5                            IF DTYP = %INDEX1_DATATYPE /*%INDEX1_DATATYPE */

  13165  1 001326   200053 235100                    LDA     DTYP,,AUTO
         1 001327   000040 115007                    CMPA    32,DL
         1 001330   001377 601000 1                  TNZ     s:13179

      412    13166    5                            THEN
      413    13167    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13167  1 001331   106714 235100                    LDA     3532,,PR1
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:65   
         1 001332   000003 115007                    CMPA    3,DL
         1 001333   001335 602005 1                  TNC     s:13167+4,AL
         1 001334   001374 710000 1                  TRA     s:13175
         1 001335   001374 710000 1                  TRA     s:13175
         1 001336   001340 710000 1                  TRA     s:13169
         1 001337   001356 710000 1                  TRA     s:13172

      414    13168    6                              CASE (%HOST);

      415    13169    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR.C + 2;

  13169  1 001340   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001341   200063 474500                    LDP4    ZITEM$,,AUTO
         1 001342   300000 236100                    LDQ     0,,PR3
         1 001343   000020 772000                    QRL     16
         1 001344   000003 376007                    ANQ     3,DL
         1 001345   000002 036007                    ADLQ    2,DL
         1 001346   000006 736000                    QLS     6
         1 001347   400007 752102                    STCQ    7,'02'O,PR4

      416    13170    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR.B;

  13170  1 001350   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001351   300000 236100                    LDQ     0,,PR3
         1 001352   170000 376007                    ANQ     61440,DL
         1 001353   000014 772000                    QRL     12
         1 001354   400007 752101                    STCQ    7,'01'O,PR4
         1 001355   001514 710000 1                  TRA     s:13206

      417    13171    6                              CASE (%L6);

      418    13172    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR6.C + 2;

  13172  1 001356   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001357   200063 474500                    LDP4    ZITEM$,,AUTO
         1 001360   300000 236100                    LDQ     0,,PR3
         1 001361   000017 772000                    QRL     15
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:66   
         1 001362   000001 376007                    ANQ     1,DL
         1 001363   000002 036007                    ADLQ    2,DL
         1 001364   000006 736000                    QLS     6
         1 001365   400007 752102                    STCQ    7,'02'O,PR4

      419    13173    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR6.B;

  13173  1 001366   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001367   300000 236100                    LDQ     0,,PR3
         1 001370   070000 376007                    ANQ     28672,DL
         1 001371   000014 772000                    QRL     12
         1 001372   400007 752101                    STCQ    7,'01'O,PR4
         1 001373   001514 710000 1                  TRA     s:13206

      420    13174    6                              CASE (ELSE);

      421    13175    6                                 S_D.ERROR = 502; /* E@DELBUG */

  13175  1 001374   000766 236007                    LDQ     502,DL
         1 001375   100013 756100                    STQ     11,,PR1

      422    13176    6                                 ALTRETURN;

  13176  1 001376   000000 702200 xent               TSX2  ! X66_AALT

      423    13177    6                              END;

      424    13178    5                            ELSE
      425    13179    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13179  1 001377   106714 235100                    LDA     3532,,PR1
         1 001400   000003 115007                    CMPA    3,DL
         1 001401   001403 602005 1                  TNC     s:13179+4,AL
         1 001402   001436 710000 1                  TRA     s:13187
         1 001403   001436 710000 1                  TRA     s:13187
         1 001404   001406 710000 1                  TRA     s:13181
         1 001405   001422 710000 1                  TRA     s:13184
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:67   

      426    13180    6                              CASE (%HOST);

      427    13181    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR.C;

  13181  1 001406   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001407   200063 474500                    LDP4    ZITEM$,,AUTO
         1 001410   300000 236100                    LDQ     0,,PR3
         1 001411   600000 376007                    ANQ     -65536,DL
         1 001412   000012 772000                    QRL     10
         1 001413   400007 752102                    STCQ    7,'02'O,PR4

      428    13182    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR.B;

  13182  1 001414   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001415   300000 236100                    LDQ     0,,PR3
         1 001416   170000 376007                    ANQ     61440,DL
         1 001417   000014 772000                    QRL     12
         1 001420   400007 752101                    STCQ    7,'01'O,PR4
         1 001421   001514 710000 1                  TRA     s:13206

      429    13183    6                              CASE (%L6);

      430    13184    6                                 ZITEM.ADDRESS.C = B$VREBL.ADR6.C;

  13184  1 001422   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001423   200063 474500                    LDP4    ZITEM$,,AUTO
         1 001424   300000 236100                    LDQ     0,,PR3
         1 001425   100000 376007                    ANQ     32768,DL
         1 001426   000011 772000                    QRL     9
         1 001427   400007 752102                    STCQ    7,'02'O,PR4

      431    13185    6                                 ZITEM.ADDRESS.B = B$VREBL.ADR6.B;

  13185  1 001430   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001431   300000 236100                    LDQ     0,,PR3
         1 001432   070000 376007                    ANQ     28672,DL
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:68   
         1 001433   000014 772000                    QRL     12
         1 001434   400007 752101                    STCQ    7,'01'O,PR4
         1 001435   001514 710000 1                  TRA     s:13206

      432    13186    6                              CASE (ELSE);

      433    13187    6                                 S_D.ERROR = 502; /* E@DELBUG */

  13187  1 001436   000766 236007                    LDQ     502,DL
         1 001437   100013 756100                    STQ     11,,PR1

      434    13188    6                                 ALTRETURN;

  13188  1 001440   000000 702200 xent               TSX2  ! X66_AALT

      435    13189    6                              END;

      436    13190    5                          END;
      437    13191    5                       ELSE DO;

      438    13192    6                            DO CASE (S_D.ONE_TO_TWO.EXEC_DOMAIN);

  13192  1 001441   000000 471400 xsym               LDP1    S_D$
         1 001442   106714 235100                    LDA     3532,,PR1
         1 001443   000003 115007                    CMPA    3,DL
         1 001444   001446 602005 1                  TNC     s:13192+5,AL
         1 001445   001511 710000 1                  TRA     s:13202
         1 001446   001511 710000 1                  TRA     s:13202
         1 001447   001451 710000 1                  TRA     s:13194
         1 001450   001471 710000 1                  TRA     s:13198

      439    13193    6                              CASE (%HOST);

      440    13194    6                                 DITEM.ADDRESS.W = B$VREBL.ADR.W;

  13194  1 001451   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001452   300000 236100                    LDQ     0,,PR3
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:69   
         1 001453   777777 376003                    ANQ     -1,DU
         1 001454   000006 772000                    QRL     6
         1 001455   000001 752174                    STCQ    1,'74'O,PR0

      441    13195    6                                 DITEM.ADDRESS.C = B$VREBL.ADR.C;

  13195  1 001456   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001457   300000 236100                    LDQ     0,,PR3
         1 001460   600000 376007                    ANQ     -65536,DL
         1 001461   000012 772000                    QRL     10
         1 001462   000001 752102                    STCQ    1,'02'O,PR0

      442    13196    6                                 DITEM.ADDRESS.B = B$VREBL.ADR.B;

  13196  1 001463   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001464   300000 236100                    LDQ     0,,PR3
         1 001465   170000 376007                    ANQ     61440,DL
         1 001466   000014 772000                    QRL     12
         1 001467   000001 752101                    STCQ    1,'01'O,PR0
         1 001470   001514 710000 1                  TRA     s:13206

      443    13197    6                              CASE (%L6);

      444    13198    6                                 DITEM.ADDRESS.W = B$VREBL.ADR6.W;

  13198  1 001471   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001472   300000 236100                    LDQ     0,,PR3
         1 001473   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 001474   000004 772000                    QRL     4
         1 001475   000001 752174                    STCQ    1,'74'O,PR0

      445    13199    6                                 DITEM.ADDRESS.C = B$VREBL.ADR6.C;

  13199  1 001476   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001477   300000 236100                    LDQ     0,,PR3
         1 001500   100000 376007                    ANQ     32768,DL
         1 001501   000011 772000                    QRL     9
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:70   
         1 001502   000001 752102                    STCQ    1,'02'O,PR0

      446    13200    6                                 DITEM.ADDRESS.B = B$VREBL.ADR6.B;

  13200  1 001503   200044 473500                    LDP3    ENTRY$,,AUTO
         1 001504   300000 236100                    LDQ     0,,PR3
         1 001505   070000 376007                    ANQ     28672,DL
         1 001506   000014 772000                    QRL     12
         1 001507   000001 752101                    STCQ    1,'01'O,PR0
         1 001510   001514 710000 1                  TRA     s:13206

      447    13201    6                              CASE (ELSE);

      448    13202    6                                 S_D.ERROR = 502; /* E@DELBUG */

  13202  1 001511   000766 236007                    LDQ     502,DL
         1 001512   100013 756100                    STQ     11,,PR1

      449    13203    6                                 ALTRETURN;

  13203  1 001513   000000 702200 xent               TSX2  ! X66_AALT

      450    13204    6                              END;

      451    13205    5                          END;
      452    13206    4                       DITEM.TYPE_CODE = IDX_ICODE;

  13206  1 001514   200034 236100                    LDQ     IDX_ICODE,,AUTO
         1 001515   000000 552104                    STBQ    0,'04'O,PR0

      453    13207    4                       IF IDX_LOOP = DIM_CNTM1

  13207  1 001516   200033 236100                    LDQ     IDX_LOOP,,AUTO
         1 001517   200007 116100                    CMPQ    DIM_CNTM1,,AUTO
         1 001520   001526 601000 1                  TNZ     s:13210
         1 001521   200034 235100                    LDA     IDX_ICODE,,AUTO
         1 001522   000003 115007                    CMPA    3,DL
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:71   
         1 001523   001526 600000 1                  TZE     s:13210

      454    13208    4                         AND IDX_ICODE ~= %LIDX_ICODE /* LIDX_ICODE */
      455    13209    4                       THEN DITEM.FLAGS.LFLAG = '1'B;

  13209  1 001524   000100 236003                    LDQ     64,DU
         1 001525   000000 256100                    ORSQ    0,,PR0

      456    13210    4                       DITEM.ADDR_TYPE = ATYP;

  13210  1 001526   200052 236100                    LDQ     ATYP,,AUTO
         1 001527   000011 736000                    QLS     9
         1 001530   000000 552110                    STBQ    0,'10'O,PR0

      457    13211    4                       DITEM.PUP = PUP;

  13211  1 001531   200046 236100                    LDQ     PUP,,AUTO
         1 001532   000002 756100                    STQ     2,,PR0

      458    13212    4                       IF ARRAY_FLAG

  13212  1 001533   200024 234100                    SZN     ARRAY_FLAG,,AUTO
         1 001534   001551 605000 1                  TPL     s:13214

      459    13213    4                       THEN CALL DDD$MULT(MY_DIM_CNT, MY_MULT, ENTRY$, ENTRY#) ALTRET(
             13213                                SERR);

  13213  1 001535   200066 633500                    EPPR3   ENTRY#,,AUTO
         1 001536   200161 453500                    STP3    CNT+5,,AUTO
         1 001537   200044 634500                    EPPR4   ENTRY$,,AUTO
         1 001540   200160 454500                    STP4    CNT+4,,AUTO
         1 001541   200013 635500                    EPPR5   MY_MULT,,AUTO
         1 001542   200157 455500                    STP5    CNT+3,,AUTO
         1 001543   200011 636500                    EPPR6   MY_DIM_CNT,,AUTO
         1 001544   200156 456500                    STP6    CNT+2,,AUTO
         1 001545   200156 630500                    EPPR0   CNT+2,,AUTO
         1 001546   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:72   
         1 001547   000000 701000 xent               TSX1    DDD$MULT
         1 001550   002032 702000 1                  TSX2    SERR

      460    13214    4                       CALL BUMPD$ ALTRET(SERR);

  13214  1 001551   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001552   200153 756100                    STQ     ENTRY#+53,,AUTO
         1 001553   002033 701000 1                  TSX1    BUMPD$
         1 001554   002032 702000 1                  TSX2    SERR

      461    13215    4                     END;                  /* BUILD VARIABLE REFERENCE INDEX */

  13215  1 001555   001767 710000 1                  TRA     s:13285

      462    13216    4                  ELSE DO;                 /* BUILD SIMPLE EXPRESSION INDEX */

      463    13217    4                       DITEM = DUMINDEX;

  13217  1 001556   200062 473500                    LDP3    SDD$,,AUTO
         1 001557   000100 100400                    MLR     fill='000'O
         1 001560   000000 000010 0                  ADSC9   DUMINDEX                 cn=0,n=8
         1 001561   300000 000014                    ADSC9   0,,PR3                   cn=0,n=12

      464    13218    4                       IF BASED_FLAG

  13218  1 001562   200023 234100                    SZN     BASED_FLAG,,AUTO
         1 001563   001566 605000 1                  TPL     s:13220

      465    13219    4                       THEN DITEM.ADDR_TYPE = %BASED_ACODE; /* BASED_ACODE */

  13219  1 001564   002000 236007                    LDQ     1024,DL
         1 001565   300000 552110                    STBQ    0,'10'O,PR3

      466    13220    4                       I$ = I$ -> O.SUBLK$(0); /* Point to C@SDO */

  13220  1 001566   200026 471500                    LDP1    I$,,AUTO
         1 001567   100003 236100                    LDQ     3,,PR1
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:73   
         1 001570   200026 756100                    STQ     I$,,AUTO

      467    13221    4                       IF I$ -> O.SUBLK$(0) -> O.CODE = 591 /* MINUS_CODE */

  13221  1 001571   200026 471500                    LDP1    I$,,AUTO
         1 001572   100003 474500                    LDP4    3,,PR1
         1 001573   400000 720100                    LXL0    0,,PR4
         1 001574   001117 100003                    CMPX0   591,DU
         1 001575   001603 601000 1                  TNZ     s:13227

      468    13222    5                       THEN DO;

      469    13223    5                            MINUS = '1'B;

  13223  1 001576   400000 236003                    LDQ     -131072,DU
         1 001577   200036 756100                    STQ     MINUS,,AUTO

      470    13224    5                            I$ = I$ -> O.SUBLK$(1); /* Point to DEC or OCTIL */

  13224  1 001600   100004 236100                    LDQ     4,,PR1
         1 001601   200026 756100                    STQ     I$,,AUTO

      471    13225    5                          END;

  13225  1 001602   001606 710000 1                  TRA     s:13230

      472    13226    5                       ELSE DO;

      473    13227    5                            MINUS = '0'B;

  13227  1 001603   200036 450100                    STZ     MINUS,,AUTO

      474    13228    5                            I$ = I$ -> O.SUBLK$(0); /* Point to DEC or OCTIL */

  13228  1 001604   100003 236100                    LDQ     3,,PR1
         1 001605   200026 756100                    STQ     I$,,AUTO

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:74   
      475    13229    5                          END;

      476    13230    4                       IF I$ -> O.CODE = 27 /* OCT_CODE */

  13230  1 001606   200026 471500                    LDP1    I$,,AUTO
         1 001607   100000 720100                    LXL0    0,,PR1
         1 001610   000033 100003                    CMPX0   27,DU
         1 001611   001674 601000 1                  TNZ     s:13251

      477    13231    5                       THEN DO;            /* "OCTIL" */

      478    13232    5                            DITEM.FLAGS.OFLAG = '1'B;

  13232  1 001612   000400 236003                    LDQ     256,DU
         1 001613   300000 256100                    ORSQ    0,,PR3

      479    13233    5                            S_D.SDOO = '1'B;

  13233  1 001614   400000 236003                    LDQ     -131072,DU
         1 001615   000060 756100                    STQ     48,,PR0

      480    13234    5                            IF I$ -> O.NDTYPE = %KONCAT#

  13234  1 001616   200026 471500                    LDP1    I$,,AUTO
         1 001617   100000 236100                    LDQ     0,,PR1
         1 001620   000077 376003                    ANQ     63,DU
         1 001621   000002 116003                    CMPQ    2,DU
         1 001622   001625 601000 1                  TNZ     s:13236

      481    13235    5                            THEN I$ = I$ -> O.SUBLK$(0);

  13235  1 001623   100003 236100                    LDQ     3,,PR1
         1 001624   200026 756100                    STQ     I$,,AUTO

      482    13236    5                            I$ = I$ -> O.SUBLK$(0);

  13236  1 001625   200026 471500                    LDP1    I$,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:75   
         1 001626   100003 236100                    LDQ     3,,PR1
         1 001627   200026 756100                    STQ     I$,,AUTO

      483    13237    5                            TSIZ = I$ -> TEXT$C.SIZE;

  13237  1 001630   200026 471500                    LDP1    I$,,AUTO
         1 001631   100000 236100                    LDQ     0,,PR1
         1 001632   000033 772000                    QRL     27
         1 001633   200037 756100                    STQ     TSIZ,,AUTO

      484    13238    5                            IF TSIZ > 12

  13238  1 001634   000015 116007                    CMPQ    13,DL
         1 001635   001641 602000 1                  TNC     s:13244

      485    13239    6                            THEN DO;

      486    13240    6                                 S_D.ERROR = 46; /* E@TOOLARGE */

  13240  1 001636   000056 235007                    LDA     46,DL
         1 001637   000013 755100                    STA     11,,PR0

      487    13241    6                                 ALTRETURN;

  13241  1 001640   000000 702200 xent               TSX2  ! X66_AALT

      488    13242    6                               END;
      489    13243                       /* Pick up each digit left to right and accumulate into sum */
      490    13244    5                            ACCUM = 0;

  13244  1 001641   200040 450100                    STZ     ACCUM,,AUTO

      491    13245    6                            DO IX = 1 TO TSIZ;

  13245  1 001642   000001 235007                    LDA     1,DL
         1 001643   200041 755100                    STA     IX,,AUTO
         1 001644   001666 710000 1                  TRA     s:13248+3
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:76   

      492    13246    6                                 I$ = PINCRC( I$, LENGTHC(CHAR$1) );

  13246  1 001645   200026 236100                    LDQ     I$,,AUTO
         1 001646   200000 036007                    ADLQ    65536,DL
         1 001647   200026 756100                    STQ     I$,,AUTO

      493    13247    6                                 ACCUM = (ACCUM * 8) + ASCBIN(I$ -> CHAR$1) - ASCBIN(
             13247                                          '0' );

  13247  1 001650   200026 470500                    LDP0    I$,,AUTO
         1 001651   000100 101500                    MRL     fill='000'O
         1 001652   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 001653   200156 000004                    ADSC9   CNT+2,,AUTO              cn=0,n=4
         1 001654   200156 236100                    LDQ     CNT+2,,AUTO
         1 001655   200157 756100                    STQ     CNT+3,,AUTO
         1 001656   200040 236100                    LDQ     ACCUM,,AUTO
         1 001657   000003 736000                    QLS     3
         1 001660   200157 036100                    ADLQ    CNT+3,,AUTO
         1 001661   000060 136007                    SBLQ    48,DL
         1 001662   200040 756100                    STQ     ACCUM,,AUTO

      494    13248    6                               END;

  13248  1 001663   200041 235100                    LDA     IX,,AUTO
         1 001664   000001 035007                    ADLA    1,DL
         1 001665   200041 755100                    STA     IX,,AUTO
         1 001666   200037 236100                    LDQ     TSIZ,,AUTO
         1 001667   200041 116100                    CMPQ    IX,,AUTO
         1 001670   001645 603000 1                  TRC     s:13246

      495    13249    5                            TEMP1 = ACCUM;

  13249  1 001671   200040 235100                    LDA     ACCUM,,AUTO
         1 001672   200035 755100                    STA     TEMP1,,AUTO

      496    13250    5                          END;             /* "OCTIL" */
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:77   

  13250  1 001673   001742 710000 1                  TRA     s:13276

      497    13251    4                       ELSE IF I$ -> O.CODE = 8 /* DEC_CODE */

  13251  1 001674   000010 100003                    CMPX0   8,DU
         1 001675   001737 601000 1                  TNZ     s:13273

      498    13252    5                            THEN DO;       /* "DECIMAL" */

      499    13253    5                                 DITEM.FLAGS.OFLAG = '0'B;

  13253  1 001676   000002 236000 2                  LDQ     2
         1 001677   300000 356100                    ANSQ    0,,PR3

      500    13254    5                                 S_D.SDOD = '1'B;

  13254  1 001700   400000 236003                    LDQ     -131072,DU
         1 001701   000057 756100                    STQ     47,,PR0

      501    13255    5                                 I$ = I$ -> O.SUBLK$(0);

  13255  1 001702   200026 471500                    LDP1    I$,,AUTO
         1 001703   100003 236100                    LDQ     3,,PR1
         1 001704   200026 756100                    STQ     I$,,AUTO

      502    13256    5                                 TSIZ = I$ -> TEXT$C.SIZE;

  13256  1 001705   200026 471500                    LDP1    I$,,AUTO
         1 001706   100000 236100                    LDQ     0,,PR1
         1 001707   000033 772000                    QRL     27
         1 001710   200037 756100                    STQ     TSIZ,,AUTO

      503    13257    5                                 IF TSIZ >= LENGTHC( '68719476735' )

  13257  1 001711   000013 116007                    CMPQ    11,DL
         1 001712   001730 602000 1                  TNC     s:13270
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:78   

      504    13258    6                                 THEN DO;

      505    13259    6                                      IF TSIZ > LENGTHC( '68719476735' )

  13259  1 001713   000014 116007                    CMPQ    12,DL
         1 001714   001720 602000 1                  TNC     s:13264

      506    13260    7                                      THEN DO;

      507    13261    7                                           S_D.ERROR = 46; /* E@TOOLARGE */

  13261  1 001715   000056 235007                    LDA     46,DL
         1 001716   000013 755100                    STA     11,,PR0

      508    13262    7                                           ALTRETURN;

  13262  1 001717   000000 702200 xent               TSX2  ! X66_AALT

      509    13263    7                                         END;
      510    13264    6                                      IF I$ -> TEXT$C.TXT > '68719476735'

  13264  1 001720   000000 620006                    EAX0    0,QL
         1 001721   040140 106400                    CMPC    fill='040'O
         1 001722   000004 000013 0                  ADSC9   DUMPTR+2                 cn=0,n=11
         1 001723   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
         1 001724   001730 603000 1                  TRC     s:13270

      511    13265    7                                      THEN DO;

      512    13266    7                                           S_D.ERROR = 46; /* E@TOOLARGE */

  13266  1 001725   000056 235007                    LDA     46,DL
         1 001726   000013 755100                    STA     11,,PR0

      513    13267    7                                           ALTRETURN;

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:79   
  13267  1 001727   000000 702200 xent               TSX2  ! X66_AALT

      514    13268    7                                         END;
      515    13269    6                                    END;
      516    13270    5                                 CALL CHARBIN( TEMP1, I$ -> TEXT$C.TXT);

  13270  1 001730   100000 236100                    LDQ     0,,PR1
         1 001731   000033 772000                    QRL     27
         1 001732   000000 620006                    EAX0    0,QL
         1 001733   000100 305540                    DTB
         1 001734   100000 230010                    NDSC9   0,,PR1                   cn=1,s=nosgn,sf=0,n=*X0
         1 001735   200035 000004                    NDSC9   TEMP1,,AUTO              cn=0,s=lsgnf,sf=0,n=4

      517    13271    5                               END;        /* "DECIMAL" */

  13271  1 001736   001742 710000 1                  TRA     s:13276

      518    13272    5                            ELSE DO;

      519    13273    5                                 S_D.ERROR = 501; /* E@DERR1 */

  13273  1 001737   000765 235007                    LDA     501,DL
         1 001740   000013 755100                    STA     11,,PR0

      520    13274    5                                 ALTRETURN;

  13274  1 001741   000000 702200 xent               TSX2  ! X66_AALT

      521    13275    5                               END;
      522    13276    4                       IF MINUS

  13276  1 001742   200036 234100                    SZN     MINUS,,AUTO
         1 001743   001746 605000 1                  TPL     s:13278

      523    13277    4                       THEN TEMP1 = - TEMP1;

  13277  1 001744   200035 335100                    LCA     TEMP1,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:80   
         1 001745   200035 755100                    STA     TEMP1,,AUTO

      524    13278    4                       DITEM.VALUE = TEMP1;

  13278  1 001746   200035 235100                    LDA     TEMP1,,AUTO
         1 001747   200062 470500                    LDP0    SDD$,,AUTO
         1 001750   000001 755100                    STA     1,,PR0

      525    13279    4                       IF IDX_LOOP = DIM_CNTM1

  13279  1 001751   200033 236100                    LDQ     IDX_LOOP,,AUTO
         1 001752   200007 116100                    CMPQ    DIM_CNTM1,,AUTO
         1 001753   001761 601000 1                  TNZ     s:13282
         1 001754   200034 235100                    LDA     IDX_ICODE,,AUTO
         1 001755   000003 115007                    CMPA    3,DL
         1 001756   001761 600000 1                  TZE     s:13282

      526    13280    4                         AND IDX_ICODE ~= %LIDX_ICODE /* LIDX_ICODE */
      527    13281    4                       THEN DITEM.FLAGS.LFLAG = '1'B;

  13281  1 001757   000100 236003                    LDQ     64,DU
         1 001760   000000 256100                    ORSQ    0,,PR0

      528    13282    4                       DITEM.TYPE_CODE = IDX_ICODE;

  13282  1 001761   200034 236100                    LDQ     IDX_ICODE,,AUTO
         1 001762   000000 552104                    STBQ    0,'04'O,PR0

      529    13283    4                       CALL BUMPD$ ALTRET(SERR);

  13283  1 001763   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 001764   200153 756100                    STQ     ENTRY#+53,,AUTO
         1 001765   002033 701000 1                  TSX1    BUMPD$
         1 001766   002032 702000 1                  TSX2    SERR

      530    13284    4                     END;                  /* BUILD SIMPLE EXPRESSION INDEX */

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:81   
      531    13285    3                  IF IDX_ICODE ~= %UIDX_ICODE /* UIDX_ICODE */

  13285  1 001767   200034 235100                    LDA     IDX_ICODE,,AUTO
         1 001770   000004 115007                    CMPA    4,DL
         1 001771   002014 600000 1                  TZE     s:13294

      532    13286    4                  THEN DO;

      533    13287    4                       MITEM$ = SDD$;

  13287  1 001772   200062 236100                    LDQ     SDD$,,AUTO
         1 001773   200047 756100                    STQ     MITEM$,,AUTO

      534    13288    4                       CALL BUMPD$(SIZEW(MITEM)) ALTRET(SERR);

  13288  1 001774   000003 236000 2                  LDQ     3
         1 001775   200153 756100                    STQ     ENTRY#+53,,AUTO
         1 001776   002033 701000 1                  TSX1    BUMPD$
         1 001777   002032 702000 1                  TSX2    SERR

      535    13289    4                       MITEM$ -> MITEM = '0'B;

  13289  1 002000   200047 470500                    LDP0    MITEM$,,AUTO
         1 002001   000100 100400                    MLR     fill='000'O
         1 002002   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         1 002003   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

      536    13290    4                       MULT(IDX_LOOP) = MITEM$;

  13290  1 002004   200047 236100                    LDQ     MITEM$,,AUTO
         1 002005   200006 471500                    LDP1    @MULT,,AUTO
         1 002006   200033 720100                    LXL0    IDX_LOOP,,AUTO
         1 002007   100000 756110                    STQ     0,X0,PR1

      537    13291    4                       IF IDX_LOOP ~= 0

  13291  1 002010   200033 235100                    LDA     IDX_LOOP,,AUTO
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:82   
         1 002011   002014 600000 1                  TZE     s:13294

      538    13292    4                       THEN MITEM$ -> MITEM.CONT = '1'B;

  13292  1 002012   040000 236003                    LDQ     16384,DU
         1 002013   000000 256100                    ORSQ    0,,PR0

      539    13293    4                     END;

      540    13294    3                END;                       /* DO RANGE_LOOP */

  13294  1 002014   200042 054100                    AOS     RANGE_LOOP,,AUTO
         1 002015   200027 470500                    LDP0    TEMP$,,AUTO
         1 002016   000001 236100                    LDQ     1,,PR0
         1 002017   000022 772000                    QRL     18
         1 002020   200042 116100                    CMPQ    RANGE_LOOP,,AUTO
         1 002021   000054 605400 1                  TPNZ    s:12917

      541    13295    2           END;                            /* DO IDX_LOOP */

  13295  1 002022   200033 054100                    AOS     IDX_LOOP,,AUTO
         1 002023   200033 236100                    LDQ     IDX_LOOP,,AUTO
         1 002024   200007 116100                    CMPQ    DIM_CNTM1,,AUTO
         1 002025   000023 604400 1                  TMOZ    s:12902

      542    13296    1        RETURN;

  13296  1 002026   000000 702200 xent               TSX2  ! X66_ARET

      543    13297                                                /**/
      544    13298    1   BADSCHEMA:
      545    13299    1        S_D.ERROR = 22;              /* E@UERR11 */

  13299  1 002027   000026 235007       BADSCHEMA    LDA     22,DL
         1 002030   000000 470400 xsym               LDP0    S_D$
         1 002031   000013 755100                    STA     11,,PR0

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:83   
      546    13300    1   SERR:
      547    13301    1        ALTRETURN;

  13301  1 002032   000000 702200 xent  SERR         TSX2  ! X66_AALT

      548    13302             %EJECT;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:84   
      549    13303             %BUMPD$;
             13304             %LIST;
             13305    1   BUMPD$: PROC(PCNT) ALTRET;

  13305  1 002033   200152 741300       BUMPD$       STX1  ! ENTRY#+52,,AUTO

             13306    2   DCL PCNT UBIN;
             13307    2   DCL CNT UBIN;
             13308    2   DCL DD_VARCOM$ PTR SYMREF;
             13309    2   DCL DDM$GETMEM ENTRY(3) ALTRET;
             13310    2        IF ADDR(PCNT) = ADDR(NIL)

  13310  1 002034   200153 236100                    LDQ     @PCNT,,AUTO
         1 002035   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002036   002042 601000 1                  TNZ     s:13312

             13311    2        THEN CNT = SIZEW(DITEM);

  13311  1 002037   000003 235007                    LDA     3,DL
         1 002040   200154 755100                    STA     CNT,,AUTO
         1 002041   002045 710000 1                  TRA     s:13313

             13312    2        ELSE CNT = PCNT;

  13312  1 002042   200153 470500                    LDP0    @PCNT,,AUTO
         1 002043   000000 235100                    LDA     0,,PR0
         1 002044   200154 755100                    STA     CNT,,AUTO

             13313    2        SDD$ = PINCRW(SDD$,CNT);

  13313  1 002045   200154 236100                    LDQ     CNT,,AUTO
         1 002046   000022 736000                    QLS     18
         1 002047   200062 036100                    ADLQ    SDD$,,AUTO
         1 002050   200062 756100                    STQ     SDD$,,AUTO

             13314    2        IF SDD$ > S_D.DESCL$

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:85   
  13314  1 002051   000000 470400 xsym               LDP0    S_D$
         1 002052   000042 116100                    CMPQ    34,,PR0
         1 002053   002102 602000 1                  TNC     s:13329
         1 002054   002102 600000 1                  TZE     s:13329

             13315    3        THEN DO;

             13316    3             IF S_D.STORED ~= 0

  13316  1 002055   000135 235100                    LDA     93,,PR0
         1 002056   002076 600000 1                  TZE     s:13325

             13317    4             THEN DO;

             13318    5                  DO WHILE (SDD$ > PINCRW(S_D.DESCL$, 1));

  13318  1 002057   002071 710000 1                  TRA     s:13322

             13319    5                       CALL DDM$GETMEM(DD_VARCOM$, 1024);

  13319  1 002060   000005 630400 2                  EPPR0   5
         1 002061   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002062   000000 701000 xent               TSX1    DDM$GETMEM
         1 002063   000000 011000                    NOP     0

             13320    5                       S_D.VARCOM_HIGH$ = PINCRW(S_D.VARCOM_HIGH$, 1024);

  13320  1 002064   000000 470400 xsym               LDP0    S_D$
         1 002065   004623 236100                    LDQ     2451,,PR0
         1 002066   002000 036003                    ADLQ    1024,DU
         1 002067   004623 756100                    STQ     2451,,PR0

             13321    5                       S_D.DESCL$ = S_D.VARCOM_HIGH$;

  13321  1 002070   000042 756100                    STQ     34,,PR0

             13322    5                     END;
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:86   

  13322  1 002071   000042 236100                    LDQ     34,,PR0
         1 002072   000001 036003                    ADLQ    1,DU
         1 002073   200062 116100                    CMPQ    SDD$,,AUTO
         1 002074   002060 602000 1                  TNC     s:13319

             13323    4                END;

  13323  1 002075   002102 710000 1                  TRA     s:13329

             13324    4             ELSE DO;

             13325    4                  S_D.ERROR = 8; /* E@NOROOM */

  13325  1 002076   000010 235007                    LDA     8,DL
         1 002077   000013 755100                    STA     11,,PR0

             13326    4                  ALTRETURN;

  13326  1 002100   200152 221300                    LDX1  ! ENTRY#+52,,AUTO
         1 002101   000000 702211                    TSX2  ! 0,X1

             13327    4                END;
             13328    3           END;
             13329    2        S_D.D$ = SDD$;

  13329  1 002102   200062 236100                    LDQ     SDD$,,AUTO
         1 002103   000044 756100                    STQ     36,,PR0

             13330    2        RETURN;

  13330  1 002104   200152 221300                    LDX1  ! ENTRY#+52,,AUTO
         1 002105   000001 702211                    TSX2  ! 1,X1

DUMINDEX
 Sect OctLoc
   0     000   000000 102000   000000 000000                                    ..B.....
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:87   

DUMPTR
 Sect OctLoc
   0     002   000000 000001   000000 000000                                    ........

(unnamed)
 Sect OctLoc
   0     004   066070 067061   071064 067066   067063 065040                    68719476735

(unnamed)
 Sect OctLoc
   2     000   777777 740000   000007 770000   777377 777777   000006 006000    ................
   2     004   000000 002000   000000 006000   000004 006000                    ............
             13331    2        END BUMPD$;
      550    13334    1   END DDD$SUBREF;

PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:88   
--  Include file information  --

   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   DD$BASED.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDD$SUBREF.

   Procedure DDD$SUBREF requires 1094 words for executable code.
   Procedure DDD$SUBREF requires 114 words of local(AUTO) storage.

    No errors detected in file DDD$SUBREF.:E05TSI    .
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:89   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:90   
          MINI XREF LISTING

ACCUM
        70**DCL     13244<<ASSIGN  13247<<ASSIGN  13247>>ASSIGN  13249>>ASSIGN
ARRAYTYP
        55**DCL     12981<<ASSIGN  12982>>DOCASE
ARRAY_FLAG
        57**DCL     12929<<ASSIGN  12940<<ASSIGN  13212>>IF
ATYP
        89**DCL     12974<<ASSIGN  13004>>IF      13004>>IF      13004>>IF      13004>>IF      13004>>IF
     13047>>IF      13047>>IF      13047>>IF      13047>>IF      13047>>IF      13052>>IF      13067>>IF
     13121>>IF      13129>>IF      13135>>IF      13147<<ASSIGN  13151<<ASSIGN  13210>>ASSIGN
B$VREBL
      7149**DCL     13115--ASSIGN  13145--ASSIGN
B$VREBL.ADDRTYP
      7176**DCL     12974>>ASSIGN  13087>>ASSIGN
B$VREBL.ADR
      7150**DCL      7162--REDEF
B$VREBL.ADR.B
      7160**DCL     13075>>ASSIGN  13170>>ASSIGN  13182>>ASSIGN  13196>>ASSIGN
B$VREBL.ADR.C
      7158**DCL     13074>>ASSIGN  13169>>ASSIGN  13181>>ASSIGN  13195>>ASSIGN
B$VREBL.ADR.W
      7156**DCL     13073>>ASSIGN  13158>>ASSIGN  13194>>ASSIGN
B$VREBL.ADR6.B
      7174**DCL     13081>>ASSIGN  13173>>ASSIGN  13185>>ASSIGN  13200>>ASSIGN
B$VREBL.ADR6.C
      7172**DCL     13079>>ASSIGN  13172>>ASSIGN  13184>>ASSIGN  13199>>ASSIGN
B$VREBL.ADR6.W
      7170**DCL     13077>>ASSIGN  13160>>ASSIGN  13198>>ASSIGN
B$VREBL.ARRAYTYP
      7237**DCL     12981>>ASSIGN
B$VREBL.DATATYP
      7200**DCL     12975>>ASSIGN
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:91   
B$VREBL.DIMS
      7303**DCL     12988>>ASSIGN
B$VREBL.IMPTR
      7267**DCL     13051>>ASSIGN  13105>>ASSIGN  13110>>ASSIGN  13115--ASSIGN  13145--ASSIGN
B$VREBL.LOGSIZ
      7211**DCL     13045>>ASSIGN  13046>>ASSIGN
B$VREBL.SCALE
      7295**DCL     13038>>IF
BADSCHEMA
     13299**LABEL   12958--CALLALT 12963--CALLALT 12973--CALLALT 12980--CALLALT 12996--CALLALT 13070--CALLALT
     13119--CALLALT
BASED_FLAG
        56**DCL     12923<>CALL    13004>>IF      13047>>IF      13150>>IF      13218>>IF
BUMPD$
     13305**PROC    13059--CALL    13093--CALL    13214--CALL    13283--CALL    13288--CALL
CHAR$1
        67**DCL     13246--ASSIGN  13247>>ASSIGN
CNT IN PROCEDURE BUMPD$
     13307**DCL     13311<<ASSIGN  13312<<ASSIGN  13313>>ASSIGN
DDD$MULT
     12887**DCL-ENT 13213--CALL
DDD$PQLIST
     12886**DCL-ENT 12923--CALL
DDD$SUBREF
        43**PROC    12941--CALL
DDF$VREBL_#
     12894**DCL-ENT 12980--CALL    12996--CALL    13070--CALL    13119--CALL
DDM$GETMEM IN PROCEDURE BUMPD$
     13309**DCL-ENT 13319--CALL
DDS$SET_Q2T
     12891**DCL-ENT 12957--CALL
DDS$SET_T2Q
     12893**DCL-ENT 12963--CALL    12973--CALL
DDS$SET_X2Q
     12892**DCL-ENT 12958--CALL
DDS$V_SRCH
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:92   
     12890**DCL-ENT 12953--CALL    12960--CALL
DD_VARCOM$ IN PROCEDURE BUMPD$
     13308**DCL     13319<>CALL
DESC.ITEM
     12872**DCL     13103>>ASSIGN  13124>>ASSIGN  13139>>ASSIGN
DIMS
        53**DCL     12976<<ASSIGN  12986<<ASSIGN  12986>>ASSIGN  12988<<ASSIGN  12988>>ASSIGN  12997>>IF
     12999>>ASSIGN
DIM_CNT
        47**DCL        43--PROC    12899<<ASSIGN  12900>>ASSIGN  13098>>DOINDEX
DIM_CNTM1
        50**DCL     12900<<ASSIGN  12901>>DOINDEX 13207>>IF      13279>>IF
DITEM
       853**DCL     13061--ASSIGN  13065--ASSIGN  13069<<ASSIGN  13095--ASSIGN  13099--ASSIGN  13123<<ASSIGN
     13131<<ASSIGN  13137<<ASSIGN  13143<<ASSIGN  13152<<ASSIGN  13217<<ASSIGN  13311--ASSIGN
DITEM.ADDRESS
       874**DCL       879--REDEF     880--REDEF     881--REDEF
DITEM.ADDRESS.B
       878**DCL     13075<<ASSIGN  13081<<ASSIGN  13196<<ASSIGN  13200<<ASSIGN
DITEM.ADDRESS.C
       877**DCL     13074<<ASSIGN  13079<<ASSIGN  13195<<ASSIGN  13199<<ASSIGN
DITEM.ADDRESS.W
       876**DCL     13073<<ASSIGN  13077<<ASSIGN  13110<<ASSIGN  13132<<ASSIGN  13194<<ASSIGN  13198<<ASSIGN
DITEM.ADDR_TYPE
       869**DCL     13091<<ASSIGN  13104<<ASSIGN  13111<<ASSIGN  13114<<ASSIGN  13118<<ASSIGN  13125<<ASSIGN
     13133<<ASSIGN  13138<<ASSIGN  13144<<ASSIGN  13210<<ASSIGN  13219<<ASSIGN
DITEM.FLAGS.LFLAG
       864**DCL     13209<<ASSIGN  13281<<ASSIGN
DITEM.FLAGS.OFLAG
       857**DCL     13232<<ASSIGN  13253<<ASSIGN
DITEM.PUP
       906**DCL     13211<<ASSIGN
DITEM.SP.VD
       882**DCL       886--REDEF     889--REDEF
DITEM.SP.VD.DISP
       885**DCL     13140<<ASSIGN
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:93   
DITEM.SP.VP.N
       888**DCL     13105<<ASSIGN  13126<<ASSIGN
DITEM.TYPE_CODE
       872**DCL     13206<<ASSIGN  13282<<ASSIGN
DITEM.VALUE
       879**DCL     13115<<ASSIGN  13145<<ASSIGN  13278<<ASSIGN
DITEM.VALUEB
       880**DCL     13103<<ASSIGN  13124<<ASSIGN  13139<<ASSIGN
DTYP
        90**DCL     12975<<ASSIGN  13011>>DOCASE  13045>>ASSIGN  13046>>ASSIGN  13153>>IF      13153>>IF
     13165>>IF
DUMINDEX
     12873**DCL     13152>>ASSIGN  13217>>ASSIGN
DUMPTR
     12878**DCL     13069>>ASSIGN  13123>>ASSIGN  13131>>ASSIGN  13137>>ASSIGN  13143>>ASSIGN
ENTRY#
     12722**DCL     12953<>CALL    12960<>CALL    13213<>CALL
ENTRY#.C
     12723**DCL     12954>>ASSIGN  12961>>IF      12962>>ASSIGN  12977>>DOINDEX 12978>>ASSIGN  12979>>IF
     12995>>IF      12996>>CALL    13119>>CALL
ENTRY#.E
     12724**DCL     12980<>CALL    12996<>CALL    13119<>CALL
ENTRY$
        74**DCL      7149--IMP-PTR 12953<>CALL    12960<>CALL    12974>>ASSIGN  12975>>ASSIGN  12980<>CALL
     12981>>ASSIGN  12988>>ASSIGN  12996<>CALL    13038>>IF      13045>>ASSIGN  13046>>ASSIGN  13051>>ASSIGN
     13115>>ASSIGN  13115>>ASSIGN  13119<>CALL    13145>>ASSIGN  13145>>ASSIGN  13145>>ASSIGN  13158>>ASSIGN
     13160>>ASSIGN  13169>>ASSIGN  13170>>ASSIGN  13172>>ASSIGN  13173>>ASSIGN  13181>>ASSIGN  13182>>ASSIGN
     13184>>ASSIGN  13185>>ASSIGN  13194>>ASSIGN  13195>>ASSIGN  13196>>ASSIGN  13198>>ASSIGN  13199>>ASSIGN
     13200>>ASSIGN  13213<>CALL
GOT_VAR
     12972**LABEL   12953--CALLALT 12960--CALLALT
HIGH_ENTRY#
        75**DCL     12954<<ASSIGN  12961>>IF      12962<<ASSIGN  12966>>ASSIGN
I
        91**DCL     12977<<DOINDEX 12978>>ASSIGN  13064<<DOINDEX 13065>>ASSIGN  13065>>ASSIGN  13098<<DOINDEX
     13099>>ASSIGN  13099>>ASSIGN
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:94   
I$
        59**DCL     12922<<ASSIGN  12923<>CALL    12925<<ASSIGN  12925>>ASSIGN  12925>>ASSIGN  12927>>IF
     12932>>IF      12934>>IF      12934>>IF      12941>>CALL    12950<<ASSIGN  12950>>ASSIGN  12952>>ASSIGN
     12953<>CALL    12960<>CALL    12966>>ASSIGN  13220<<ASSIGN  13220>>ASSIGN  13221>>IF      13224<<ASSIGN
     13224>>ASSIGN  13228<<ASSIGN  13228>>ASSIGN  13230>>IF      13234>>IF      13235<<ASSIGN  13235>>ASSIGN
     13236<<ASSIGN  13236>>ASSIGN  13237>>ASSIGN  13246<<ASSIGN  13246>>ASSIGN  13247>>ASSIGN  13251>>IF
     13255<<ASSIGN  13255>>ASSIGN  13256>>ASSIGN  13264>>IF      13264>>IF      13270>>CALLBLT 13270>>CALLBLT
IDX_ICODE
        65**DCL     12919<<ASSIGN  12920<<ASSIGN  12921<<ASSIGN  13206>>ASSIGN  13207>>IF      13279>>IF
     13282>>ASSIGN  13285>>IF
IDX_LOOP
        64**DCL     12901<<DOINDEX 12904>>ASSIGN  13207>>IF      13279>>IF      13290>>ASSIGN  13291>>IF
IENTRY#
        92**DCL     13051<<ASSIGN  13052>>IF      13070<>CALL    13126>>ASSIGN  13132>>ASSIGN  13140>>ASSIGN
IENTRY$
        93**DCL     13070<>CALL    13073>>ASSIGN  13074>>ASSIGN  13075>>ASSIGN  13077>>ASSIGN  13079>>ASSIGN
     13081>>ASSIGN  13087>>ASSIGN  13105>>ASSIGN  13110>>ASSIGN  13115>>ASSIGN
IPTR$
        95**DCL     12931<<ASSIGN  13060>>DOWHILE 13069>>ASSIGN  13073>>ASSIGN  13074>>ASSIGN  13075>>ASSIGN
     13077>>ASSIGN  13079>>ASSIGN  13081>>ASSIGN  13091>>ASSIGN  13094>>DOWHILE 13103>>ASSIGN  13104>>ASSIGN
     13105>>ASSIGN  13110>>ASSIGN  13111>>ASSIGN  13114>>ASSIGN  13115>>ASSIGN  13118>>ASSIGN  13123>>ASSIGN
     13124>>ASSIGN  13125>>ASSIGN  13126>>ASSIGN  13131>>ASSIGN  13132>>ASSIGN  13133>>ASSIGN  13137>>ASSIGN
     13138>>ASSIGN  13139>>ASSIGN  13140>>ASSIGN  13143>>ASSIGN  13144>>ASSIGN  13145>>ASSIGN
IX
        71**DCL     13245<<DOINDEX
MINUS
        68**DCL     13223<<ASSIGN  13227<<ASSIGN  13276>>IF
MITEM
       933**DCL     13288--CALL    13289<<ASSIGN
MITEM.AMULT.ADR
       951**DCL       955--REDEF
MITEM.AOFS.ADR
       966**DCL       970--REDEF
MITEM.CONT
       943**DCL     13292<<ASSIGN
MITEM.MULT
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:95   
       947**DCL       949--REDEF
MITEM.OFS
       962**DCL       964--REDEF
MITEM$
        80**DCL     13287<<ASSIGN  13289>>ASSIGN  13290>>ASSIGN  13292>>ASSIGN
MULT
        48**DCL        43--PROC    13099<<ASSIGN  13099>>ASSIGN  13290<<ASSIGN
MY_DIM_CNT
        52**DCL     12930<<ASSIGN  12941<>CALL    12997>>IF      13064>>DOINDEX 13213<>CALL
MY_MULT
        54**DCL     12941<>CALL    13065<<ASSIGN  13065>>ASSIGN  13213<>CALL
MY_RANGE_FLAG
        51**DCL     12941<>CALL    12944>>IF
O.CODE
     11387**DCL     12927>>IF      12934>>IF      13221>>IF      13230>>IF      13251>>IF
O.NDTYPE
     11382**DCL     13234>>IF
O.NSUBLKS
     11391**DCL     12899>>ASSIGN  12905>>IF      12916>>DOINDEX 12925>>ASSIGN  12932>>IF      12934>>IF
O.SUBLK$
     11412**DCL     12904>>ASSIGN  12922>>ASSIGN  12925>>ASSIGN  12934>>IF      12941<>CALL    12950>>ASSIGN
     12952>>ASSIGN  12952>>ASSIGN  12966>>ASSIGN  12966>>ASSIGN  13220>>ASSIGN  13221>>IF      13224>>ASSIGN
     13228>>ASSIGN  13235>>ASSIGN  13236>>ASSIGN  13255>>ASSIGN
PCNT IN PROCEDURE BUMPD$
     13306**DCL     13305--PROC    13310--IF      13312>>ASSIGN
PUP
        76**DCL     13010<<ASSIGN  13038>>IF      13211>>ASSIGN
PUP.BITS
        79**DCL     13037<<ASSIGN
PUP.SIZE
        77**DCL     13045<<ASSIGN  13046<<ASSIGN
RANGE_FLAG
        46**DCL        43--PROC    12898<<ASSIGN  12908<<ASSIGN
RANGE_LOOP
        72**DCL     12916<<DOINDEX 12918>>IF      12922>>ASSIGN
RFLAG
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:96   
        73**DCL     12903<<ASSIGN  12907<<ASSIGN  12917>>IF
SDD$
       203**DCL       853--IMP-PTR 12896<<ASSIGN  12924<<ASSIGN  12931>>ASSIGN  12943<<ASSIGN  13058>>ASSIGN
     13092>>ASSIGN  13152>>ASSIGN  13194>>ASSIGN  13195>>ASSIGN  13196>>ASSIGN  13198>>ASSIGN  13199>>ASSIGN
     13200>>ASSIGN  13206>>ASSIGN  13209>>ASSIGN  13210>>ASSIGN  13211>>ASSIGN  13217>>ASSIGN  13219>>ASSIGN
     13232>>ASSIGN  13253>>ASSIGN  13278>>ASSIGN  13281>>ASSIGN  13282>>ASSIGN  13287>>ASSIGN  13313<<ASSIGN
     13313>>ASSIGN  13314>>IF      13318>>DOWHILE 13329>>ASSIGN
SERR
     13301**LABEL   12923--CALLALT 12941--CALLALT 13059--CALLALT 13093--CALLALT 13213--CALLALT 13214--CALLALT
     13283--CALLALT 13288--CALLALT
SIZE
        63**DCL     12902<<ASSIGN
STRUCT
        81**DCL     12978<<ASSIGN  12980>>CALL
SUBREF$
        45**DCL        43--PROC    12899>>ASSIGN  12904>>ASSIGN
SYM$
        61**DCL     12952<<ASSIGN  12966<<ASSIGN  12968>>ASSIGN  12990>>ASSIGN  13001>>ASSIGN  13007>>ASSIGN
     13034>>ASSIGN  13041>>ASSIGN  13055>>ASSIGN
S_D.CURRENT_CHANNEL
      3352**DCL      3354--REDEF
S_D.D$
      2490**DCL     12896>>ASSIGN  12924>>ASSIGN  12943>>ASSIGN  13329<<ASSIGN
S_D.DEBUGA
      2504**DCL      2506--REDEF
S_D.DESC$
      2484**DCL     12897>>ASSIGN
S_D.DESCL$
      2486**DCL     13314>>IF      13318>>DOWHILE 13321<<ASSIGN
S_D.EIS
      3462**DCL      3491--REDEF
S_D.ERROR
      2433**DCL     12912<<ASSIGN  12937<<ASSIGN  12946<<ASSIGN  12967<<ASSIGN  12991<<ASSIGN  13000<<ASSIGN
     13006<<ASSIGN  13033<<ASSIGN  13040<<ASSIGN  13054<<ASSIGN  13084<<ASSIGN  13162<<ASSIGN  13175<<ASSIGN
     13187<<ASSIGN  13202<<ASSIGN  13240<<ASSIGN  13261<<ASSIGN  13266<<ASSIGN  13273<<ASSIGN  13299<<ASSIGN
     13325<<ASSIGN
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:97   
S_D.ERROR_HICHAR
      3046**DCL     12999<<ASSIGN
S_D.ERROR_SYM$
      2457**DCL     12968<<ASSIGN  12990<<ASSIGN  13001<<ASSIGN  13007<<ASSIGN  13034<<ASSIGN  13041<<ASSIGN
     13055<<ASSIGN
S_D.HOST_MESSAGE_BUF_REMOTE
      3395**DCL      3396--REDEF    3410--REDEF
S_D.JDE
      3009**DCL      3010--REDEF
S_D.L$.VALUE
      2562**DCL      2568--REDEF    2576--REDEF    2579--REDEF    2582--REDEF    2585--REDEF
S_D.L$.VALUE.L
      2563**DCL      2564--REDEF    2565--REDEF
S_D.L6_MESSAGE_BUF
      3416**DCL      3418--REDEF
S_D.ONE_TO_TWO.EXEC_DOMAIN
      3427**DCL     13044>>IF      13071>>DOCASE  13156>>DOCASE  13167>>DOCASE  13179>>DOCASE  13192>>DOCASE
S_D.OUTPUT
      3382**DCL      3384--REDEF
S_D.RANGE_CNT
      2520**DCL     12909<<ASSIGN  12909>>ASSIGN  12910>>IF
S_D.REMOTE_MSG.FNCC
      3401**DCL      3402--REDEF
S_D.REMOTE_MSG.STXC
      3397**DCL      3398--REDEF
S_D.REMOTE_MSG.SUBFNCC
      3405**DCL      3406--REDEF
S_D.SDOD
      2514**DCL     13254<<ASSIGN
S_D.SDOO
      2516**DCL     13233<<ASSIGN
S_D.STORED
      2598**DCL     13316>>IF
S_D.SV
      2461**DCL      2482--REDEF
S_D.VARCOM_HIGH$
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:98   
      2875**DCL     13320<<ASSIGN  13320>>ASSIGN  13321>>ASSIGN
S_D.XSCH.OK
      2740**DCL     12955>>IF
S_D$
      3713**DCL      2409--IMP-PTR 12896>>ASSIGN  12897>>ASSIGN  12909>>ASSIGN  12909>>ASSIGN  12910>>IF
     12912>>ASSIGN  12924>>ASSIGN  12937>>ASSIGN  12943>>ASSIGN  12946>>ASSIGN  12955>>IF      12967>>ASSIGN
     12968>>ASSIGN  12990>>ASSIGN  12991>>ASSIGN  12999>>ASSIGN  13000>>ASSIGN  13001>>ASSIGN  13006>>ASSIGN
     13007>>ASSIGN  13033>>ASSIGN  13034>>ASSIGN  13040>>ASSIGN  13041>>ASSIGN  13044>>IF      13054>>ASSIGN
     13055>>ASSIGN  13071>>DOCASE  13084>>ASSIGN  13156>>DOCASE  13162>>ASSIGN  13167>>DOCASE  13175>>ASSIGN
     13179>>DOCASE  13187>>ASSIGN  13192>>DOCASE  13202>>ASSIGN  13233>>ASSIGN  13240>>ASSIGN  13254>>ASSIGN
     13261>>ASSIGN  13266>>ASSIGN  13273>>ASSIGN  13299>>ASSIGN  13314>>IF      13316>>IF      13318>>DOWHILE
     13320>>ASSIGN  13320>>ASSIGN  13321>>ASSIGN  13321>>ASSIGN  13325>>ASSIGN  13329>>ASSIGN
T$
        94**DCL     13058<<ASSIGN  13060>>DOWHILE 13061>>ASSIGN  13061>>ASSIGN  13062<<ASSIGN  13062>>ASSIGN
     13092<<ASSIGN  13094>>DOWHILE 13095>>ASSIGN  13095>>ASSIGN  13096<<ASSIGN  13096>>ASSIGN
TATYP
        96**DCL     13087<<ASSIGN  13088>>IF      13088>>IF      13088>>IF      13101>>IF      13108>>IF
     13118>>ASSIGN
TBITS
        82**DCL     13013<<ASSIGN  13015<<ASSIGN  13017<<ASSIGN  13019<<ASSIGN  13021<<ASSIGN  13023<<ASSIGN
     13025<<ASSIGN  13027<<ASSIGN  13029<<ASSIGN  13031<<ASSIGN  13037>>ASSIGN
TEMP$
        60**DCL     12904<<ASSIGN  12905>>IF      12916>>DOINDEX 12922>>ASSIGN
TEMP1
        66**DCL     13249<<ASSIGN  13270<<CALLBLT 13277<<ASSIGN  13277>>ASSIGN  13278>>ASSIGN
TEXT$C.SIZE
     12728**DCL     12729--IMP-SIZ 13237>>ASSIGN  13256>>ASSIGN  13264>>IF      13270>>CALLBLT
TEXT$C.TXT
     12729**DCL     13264>>IF      13270>>CALLBLT
TEXTC.SZ
        84**DCL        85--IMP-SIZ
TSIZ
        69**DCL     13237<<ASSIGN  13238>>IF      13245>>DOINDEX 13256<<ASSIGN  13257>>IF      13259>>IF
TYPESIZE_MULT
     12883**DCL     13045>>ASSIGN
TYPESIZE_MULT_FEP
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:99   
     12884**DCL     13046>>ASSIGN
UBIN36
        97**DCL     13061<<ASSIGN  13061>>ASSIGN  13095<<ASSIGN  13095>>ASSIGN  13115>>ASSIGN  13145>>ASSIGN
XQUAL
        58**DCL     12951<<ASSIGN  12959<<ASSIGN  12972>>IF
ZITEM.ADDRESS
       815**DCL       820--REDEF     821--REDEF     822--REDEF
ZITEM.ADDRESS.B
       819**DCL     13170<<ASSIGN  13173<<ASSIGN  13182<<ASSIGN  13185<<ASSIGN
ZITEM.ADDRESS.C
       818**DCL     13169<<ASSIGN  13172<<ASSIGN  13181<<ASSIGN  13184<<ASSIGN
ZITEM.ADDRESS.W
       817**DCL     13158<<ASSIGN  13160<<ASSIGN
ZITEM.FLAGS.MDSE.S
       790**DCL     13106<<ASSIGN  13127<<ASSIGN
ZITEM.SP.VD
       823**DCL       827--REDEF     830--REDEF
ZITEM$
       204**DCL       781--IMP-PTR 12897<<ASSIGN  13106>>ASSIGN  13127>>ASSIGN  13158>>ASSIGN  13160>>ASSIGN
     13169>>ASSIGN  13170>>ASSIGN  13172>>ASSIGN  13173>>ASSIGN  13181>>ASSIGN  13182>>ASSIGN  13184>>ASSIGN
     13185>>ASSIGN
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:100  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDD$SUBREF File=DDD$SUBREF.:E05TSI                            TUE 07/29/97 13:54 Page:101  
              MINI UREF LISTING

DDD$SIMEXP   12888**DCL-ENT
DDS$UD_SRCH   12889**DCL-ENT
SDD_L6$     205**DCL
SYM2$      62**DCL
TXTC      86**DCL
ZITEM_L6$     206**DCL
