VERSION E05

PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:1    
        1        1        /*M* ASR$D_USERS_REC - processes the DELETE USERS command.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        ASR$D_USERS_RECS: PROC ;
       11       11
       12       12        /*********************************************************************/
       13       13        /*   Include files   include files   include files   include files   */
       14       14        /*********************************************************************/
       15       15                                                              /**/
       16       16        %INCLUDE    CP_6 ;
       17     5575        %INCLUDE    AS_ENTRIES_M ;
       18     6625        %INCLUDE    AS_SUPER_C ;
       19     7060        %INCLUDE    AS_SUBS_C  ;
       20     8474        %INCLUDE    AS_MAC_C   ;
       21     8554        %INCLUDE    KL_SUPER_C ;
       22    11456        %INCLUDE    XU_MACRO_C ;
       23    14562        %INCLUDE    XU_FORMAT_C ;
       24    14724        %INCLUDE    AS_PERR_C ;
       25    15326        %INCLUDE    AS_SUPER_R ;
       26    18342
       27    18343        /********************************************************************/
       28    18344        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       29    18345        /*********************************************************************/
       30    18346                                                              /**/
       31    18347        %ASB$BOF_USERS ;
       32    18350        %ASB$ENQ_USERS ;
       33    18353        %ASB$DEQ_USERS ;
       34    18356        %ASB$READ_USERS_SEQ ;
       35    18359        %ASB$DELREC_USERS ;
       36    18362        %ASB$BOF_HLP ;
       37    18365        %ASB$ENQ_HLP ;
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:2    
       38    18368        %ASB$DEQ_HLP ;
       39    18371        %ASB$READ_HLP_SEQ ;
       40    18374        %ASB$DELREC_HLP ;
       41    18377        %ASB$GETSEG ;
       42    18380        %ASB$WRITE_LO ;
       43    18383        %ASH$ERROR ;
       44    18386        %ASA$B_USERS_HLP ;
       45    18389        %ASB$ENQ ;
       46    18392        %ASB$DEQ ;
       47    18395
       48    18396        /*********************************************************************/
       49    18397        /*   Auto data       auto data       auto data       auto data       */
       50    18398        /*********************************************************************/
       51    18399                                                              /**/
       52    18400    1   DCL DREC$ PTR ;
       53    18401    1   DCL ARS UBIN WORD ;
       54    18402    1   DCL TYPE UBIN WORD ;
       55    18403
       56    18404        /*********************************************************************/
       57    18405        /*   Local based     local based     local based     local based     */
       58    18406        /*********************************************************************/
       59    18407                                                              /**/
       60    18408        %LIST ;
       61    18409              %KL_DREC ( NAME = KL$DREC ,
       62    18410                         LAST = ";" ,
       63    18411                        STCLASS="BASED( DREC$ )") ;
             18412         %LSET LISTDIR='0'B;
             18424    1   DCL 1 KL$DREC BASED( DREC$ ) ALIGNED,
             18429    1         2 ATYP UBIN BYTE UNAL /*(1)/**/,
             18432    1         2 FLAGS,
             18435    1           3 RNME BIT(1) UNAL /*('0'B)/**/,
             18439    1           3 GHOSTOK BIT(1) UNAL /*('0'B)/**/,
             18442    1           3 OLOK BIT(1) /*('1'B)/**/,
             18446    1           3 BATOK BIT(1) /*('1'B)/**/,
             18450    1           3 GJOB BIT(1) /*('0'B)/**/,
             18453    1           3 USETP BIT(1) /*('0'B)/**/,
             18458    1           3 NOCGREJ BIT(1) /*('0'B)/**/,
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:3    
             18463    1           3 NOCGINF BIT(1) /*('0'B)/**/,
             18466    1           3 TPOK BIT(1) /*('0'B)/**/,
             18470    1           3 FEOK BIT(1) /*('0'B)/**/,
             18473    1         2 COS UBIN(8)  UNAL /*(0)/**/,
             18476    1         2 SUPER UBIN(9) UNAL /*(0)/**/,
             18479    1         2 TWSN# CHAR(4) /*('0000')/**/,
             18482    1         2 PASSWORD CHAR(8) /*(' ')/**/,
             18486    1         2 ENCODPW REDEF PASSWORD BIT(72),
             18488    1         2 PNAME,
             18496    1           3 CNT UBIN BYTE UNAL /*(0)/**/,
             18499    1           3 TXT CHAR(11) UNAL /*(' ')/**/,
             18502    1         2 WOO CHAR(8) /*('LOCAL')/**/,
             18505    1         2 RENAME CHAR(8) /*('SYS')/**/,
             18506    1         2 HPS REDEF RENAME,
             18510    1           3 N CHAR(6) UNAL,
             18511    1           3 * CHAR(2) UNAL,
             18515    1         2 TNAME CHAR(8) /*(' ')/**/,
             18519    1         2 SNAME CHAR(8) /*('LOCAL')/**/,
             18522    1         2 NWINFO UBIN WORD /*(0)/**/;
       64    18524        %PLIST ;
       65    18525
       66    18526    1   DCL M$HLP DCB;
       67    18527    1   DCL M$USERS DCB;
       68    18528        %F$DCB;
       69    18585
       70    18586
       71    18587        /********************************************************************/
       72    18588        /*   Procedure       procedure       procedure       procedure       */
       73    18589        /*********************************************************************/
       74    18590                                                              /**/
       75    18591        /*
       76    18592            ***            Begin procedure                    ***
       77    18593        */
       78    18594    1   IF NOT DSEG_FLG THEN
       79    18595    1      CALL ASB$GETSEG
       80    18596    2      WHENALTRETURN DO;
       81    18597              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='R' );
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:4    
       82    18612    2         RETURN;
       83    18613    2         END;   /* Whenaltreturn from ASB$GETSEG  */
       84    18614    1   DREC$ = DSEG1$ ;
       85    18615    1   IF DCBADDR(DCBNUM(M$USERS)) -> F$DCB.FCD#
       86    18616    1   THEN TYPE = 1;
       87    18617    1   ELSE TYPE = 0;
       88    18618    1   IF DCBADDR(DCBNUM(M$HLP)) -> F$DCB.FCD# THEN TYPE = TYPE + 2 ;
       89    18619    2   DO SELECT( TYPE );
       90    18620    2      SELECT( 0 );
       91    18621                                              /* :USERS and :HLP do not exist */
       92    18622    2      CALL ASA$B_USERS_HLP ;
       93    18623
       94    18624    2      SELECT( 1 );                    /* :USERS exists, but :HLP does not */
       95    18625                                               /* Delete users records in :USERS. */
       96    18626    2      CALL ASB$BOF_USERS ALTRET( USERS_DONE1 ) ;
       97    18627    3      DO WHILE( AS_TRUE ) ;
       98    18628    3         CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( USERS_DONE1 ) ;
       99    18629    3         CALL ASB$ENQ_USERS ALTRET( EXIT# ) ;
      100    18630    3         CALL ASB$DELREC_USERS ;
      101    18631    3         CALL ASB$DEQ_USERS ALTRET( EXIT# );
      102    18632    3         END;
      103    18633    2   USERS_DONE1:
      104    18634    2      CALL ASA$B_USERS_HLP ;
      105    18635
      106    18636    2      SELECT( 2 );                    /* :HLP exists, but :USERS does not */
      107    18637                                               /* Delete users records in :HLP. */
      108    18638    2      CALL ASB$BOF_HLP ALTRET( HLP_DONE1 ) ;
      109    18639    3      DO WHILE( AS_TRUE ) ;
      110    18640    3         ARS = DSEG1SIZE ;
      111    18641    3         CALL ASB$READ_HLP_SEQ( DREC$, ARS, 1 ) ALTRET( HLP_DONE1 ) ;
      112    18642    3         CALL ASB$ENQ_HLP ALTRET( EXIT# ) ;
      113    18643    3         IF USERS_KEY.COUNT > 8
      114    18644    3              AND  KL$DREC.ATYP ~= %KLAT_CG#
      115    18645    3              AND  KL$DREC.ATYP ~= %KLAT_RES#
      116    18646    3              AND  KL$DREC.ATYP ~= %KLAT_TRM#
      117    18647    3         THEN CALL ASB$DELREC_HLP ;
      118    18648    3         CALL ASB$DEQ_HLP ALTRET( EXIT# ) ;
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:5    
      119    18649    3         END ;
      120    18650    2   HLP_DONE1:
      121    18651    2      CALL ASA$B_USERS_HLP ;
      122    18652
      123    18653    2      SELECT( 3 ) ;                   /* Both :USERS and :HLP exist.  */
      124    18654                                              /* Delete users records that or in :USERS
      125    18655                                                 from both :USERS and :HLP  */
      126    18656    2      CALL ASB$BOF_USERS ALTRET( USERS_DONE2 );
      127    18657    3      DO WHILE( AS_TRUE );
      128    18658    3         CALL ASB$READ_USERS_SEQ ( AS_USERS )  ALTRET( USERS_DONE2 );
      129    18659    3         CALL ASB$ENQ ALTRET( EXIT# ) ;
      130    18660    3         IF USERS_KEY.COUNT > 8
      131    18661    3              AND  USERS_KEY.TXTC ~= 'DEFAULTP            S'
      132    18662    3              AND  USERS_KEY.TXTC ~= ':SYS    LJS'
      133    18663    3              AND  USERS_KEY.TXTC ~= ':FED    SUPPORT'
      134    18664    3              AND  USERS_KEY.TXTC ~= ':SYSTAC LADC'
      135    18665    4         THEN DO;
      136    18666    4            CALL ASB$DELREC_USERS ;
      137    18667    4            CALL ASB$DELREC_HLP ;
      138    18668    4            END;
      139    18669    3         CALL ASB$DEQ ALTRET( EXIT# );
      140    18670    3         END ; /* Do while */
      141    18671    2   USERS_DONE2:;
      142    18672                                               /* Delete users records in :HLP. */
      143    18673    2      CALL ASB$BOF_HLP ALTRET( HLP_DONE2 ) ;
      144    18674    3      DO WHILE( AS_TRUE ) ;
      145    18675    3         ARS = DSEG1SIZE ;
      146    18676    3         CALL ASB$READ_HLP_SEQ( DREC$, ARS, 1 ) ALTRET( HLP_DONE2 ) ;
      147    18677    3         CALL ASB$ENQ_HLP ALTRET( EXIT# ) ;
      148    18678    3         IF USERS_KEY.COUNT > 8
      149    18679    3              AND  USERS_KEY.TXTC ~= 'DEFAULTP            S'
      150    18680    3              AND  USERS_KEY.TXTC ~= ':SYS    LJS'
      151    18681    3              AND  USERS_KEY.TXTC ~= ':FED    SUPPORT'
      152    18682    3              AND  USERS_KEY.TXTC ~= ':SYSTAC LADC'
      153    18683    3         THEN
      154    18684    3            IF KL$DREC.ATYP ~= %KLAT_STA#
      155    18685    3                 AND  KL$DREC.ATYP ~= %KLAT_CG#
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:6    
      156    18686    3                 AND  KL$DREC.ATYP ~= %KLAT_RES#
      157    18687    3                 AND  KL$DREC.ATYP ~= %KLAT_TRM#
      158    18688    3            THEN
      159    18689    3               CALL ASB$DELREC_HLP ;
      160    18690    3         CALL ASB$DEQ_HLP ALTRET( EXIT# ) ;
      161    18691    3         END ; /* Do while */
      162    18692    2   HLP_DONE2: ;
      163    18693    2      END;    /* Do case( type ); */
      164    18694                                                              /**/
      165    18695    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      166    18696    1   CALL ASB$WRITE_LO( '---  Users records deleted  ---', 30 ) ;
      167    18697    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );
      168    18698                                                              /**/
      169    18699    1   RETURN ;
      170    18700                                                              /* Errors */
      171    18701                                                              /**/
      172    18702    1   EXIT#: RETURN;
      173    18703                                                              /**/
      174    18704    1   END   ASR$D_USERS_RECS ;

PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:7    
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ASR$D_USERS_RECS.

   Procedure ASR$D_USERS_RECS requires 237 words for executable code.
   Procedure ASR$D_USERS_RECS requires 10 words of local(AUTO) storage.

    No errors detected in file ASR$DELETE_USERS.:E05TSI    .

PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:8    

 Object Unit name= ASR$D_USERS_RECS                           File name= ASR$DELETE_USERS.:E05TOU
 UTS= JUL 29 '97 10:45:08.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$HLP
    3   DCB   even  none     0      0  M$USERS
    4  RoData even  UTS     25     31  ASR$D_USERS_RECS
    5   Proc  even  none   237    355  ASR$D_USERS_RECS
    6  RoData even  none     9     11  ASR$D_USERS_RECS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        0  ASR$D_USERS_RECS
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:9    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       0 ASB$ENQ_USERS
 yes     yes           Std       0 ASB$DELREC_HLP
 yes     yes           Std       0 ASB$DEQ_USERS
 yes     yes           Std       0 ASB$ENQ
 yes     yes           Std       0 ASB$DEQ
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       0 ASB$BOF_HLP
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
         yes           Std       0 ASA$B_USERS_HLP
 yes     yes           Std       1 ASB$READ_USERS_SEQ
 yes     yes           Std       0 ASB$DELREC_USERS
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP_SEQ
 yes     yes           Std       0 ASB$DEQ_HLP
 yes     yes           Std       0 ASB$BOF_USERS
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_TRUE
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG_FLG
     DSEG1$                                DSEG1SIZE                             AS_USERS
     M$HLP                                 M$USERS                               B_VECTNIL
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:10   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:11   


        1        1        /*M* ASR$D_USERS_REC - processes the DELETE USERS command.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9                                                              /**/
       10       10        ASR$D_USERS_RECS: PROC ;

     10  5 000000   000000 700200 xent  ASR$D_USERS* TSX0  ! X66_AUTO_0
         5 000001   000012 000000                    ZERO    10,0

       11       11
       12       12        /*********************************************************************/
       13       13        /*   Include files   include files   include files   include files   */
       14       14        /*********************************************************************/
       15       15                                                              /**/
       16       16        %INCLUDE    CP_6 ;
       17     5575        %INCLUDE    AS_ENTRIES_M ;
       18     6625        %INCLUDE    AS_SUPER_C ;
       19     7060        %INCLUDE    AS_SUBS_C  ;
       20     8474        %INCLUDE    AS_MAC_C   ;
       21     8554        %INCLUDE    KL_SUPER_C ;
       22    11456        %INCLUDE    XU_MACRO_C ;
       23    14562        %INCLUDE    XU_FORMAT_C ;
       24    14724        %INCLUDE    AS_PERR_C ;
       25    15326        %INCLUDE    AS_SUPER_R ;
       26    18342
       27    18343        /********************************************************************/
       28    18344        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       29    18345        /*********************************************************************/
       30    18346                                                              /**/
       31    18347        %ASB$BOF_USERS ;
       32    18350        %ASB$ENQ_USERS ;
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:12   
       33    18353        %ASB$DEQ_USERS ;
       34    18356        %ASB$READ_USERS_SEQ ;
       35    18359        %ASB$DELREC_USERS ;
       36    18362        %ASB$BOF_HLP ;
       37    18365        %ASB$ENQ_HLP ;
       38    18368        %ASB$DEQ_HLP ;
       39    18371        %ASB$READ_HLP_SEQ ;
       40    18374        %ASB$DELREC_HLP ;
       41    18377        %ASB$GETSEG ;
       42    18380        %ASB$WRITE_LO ;
       43    18383        %ASH$ERROR ;
       44    18386        %ASA$B_USERS_HLP ;
       45    18389        %ASB$ENQ ;
       46    18392        %ASB$DEQ ;
       47    18395
       48    18396        /*********************************************************************/
       49    18397        /*   Auto data       auto data       auto data       auto data       */
       50    18398        /*********************************************************************/
       51    18399                                                              /**/
       52    18400    1   DCL DREC$ PTR ;
       53    18401    1   DCL ARS UBIN WORD ;
       54    18402    1   DCL TYPE UBIN WORD ;
       55    18403
       56    18404        /*********************************************************************/
       57    18405        /*   Local based     local based     local based     local based     */
       58    18406        /*********************************************************************/
       59    18407                                                              /**/
       60    18408        %LIST ;
       61    18409              %KL_DREC ( NAME = KL$DREC ,
       62    18410                         LAST = ";" ,
       63    18411                        STCLASS="BASED( DREC$ )") ;
             18412         %LSET LISTDIR='0'B;
             18424    1   DCL 1 KL$DREC BASED( DREC$ ) ALIGNED,
             18429    1         2 ATYP UBIN BYTE UNAL /*(1)/**/,
             18432    1         2 FLAGS,
             18435    1           3 RNME BIT(1) UNAL /*('0'B)/**/,
             18439    1           3 GHOSTOK BIT(1) UNAL /*('0'B)/**/,
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:13   
             18442    1           3 OLOK BIT(1) /*('1'B)/**/,
             18446    1           3 BATOK BIT(1) /*('1'B)/**/,
             18450    1           3 GJOB BIT(1) /*('0'B)/**/,
             18453    1           3 USETP BIT(1) /*('0'B)/**/,
             18458    1           3 NOCGREJ BIT(1) /*('0'B)/**/,
             18463    1           3 NOCGINF BIT(1) /*('0'B)/**/,
             18466    1           3 TPOK BIT(1) /*('0'B)/**/,
             18470    1           3 FEOK BIT(1) /*('0'B)/**/,
             18473    1         2 COS UBIN(8)  UNAL /*(0)/**/,
             18476    1         2 SUPER UBIN(9) UNAL /*(0)/**/,
             18479    1         2 TWSN# CHAR(4) /*('0000')/**/,
             18482    1         2 PASSWORD CHAR(8) /*(' ')/**/,
             18486    1         2 ENCODPW REDEF PASSWORD BIT(72),
             18488    1         2 PNAME,
             18496    1           3 CNT UBIN BYTE UNAL /*(0)/**/,
             18499    1           3 TXT CHAR(11) UNAL /*(' ')/**/,
             18502    1         2 WOO CHAR(8) /*('LOCAL')/**/,
             18505    1         2 RENAME CHAR(8) /*('SYS')/**/,
             18506    1         2 HPS REDEF RENAME,
             18510    1           3 N CHAR(6) UNAL,
             18511    1           3 * CHAR(2) UNAL,
             18515    1         2 TNAME CHAR(8) /*(' ')/**/,
             18519    1         2 SNAME CHAR(8) /*('LOCAL')/**/,
             18522    1         2 NWINFO UBIN WORD /*(0)/**/;
       64    18524        %PLIST ;
       65    18525
       66    18526    1   DCL M$HLP DCB;
       67    18527    1   DCL M$USERS DCB;
       68    18528        %F$DCB;
       69    18585
       70    18586
       71    18587        /********************************************************************/
       72    18588        /*   Procedure       procedure       procedure       procedure       */
       73    18589        /*********************************************************************/
       74    18590                                                              /**/
       75    18591        /*
       76    18592            ***            Begin procedure                    ***
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:14   
       77    18593        */
       78    18594    1   IF NOT DSEG_FLG THEN

  18594  5 000002   000000 234000 xsym               SZN     DSEG_FLG
         5 000003   000015 604000 5                  TMI     s:18614

       79    18595    1      CALL ASB$GETSEG

  18595  5 000004   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000005   000000 701000 xent               TSX1    ASB$GETSEG
         5 000006   000010 702000 5                  TSX2    s:18609
         5 000007   000015 710000 5                  TRA     s:18614

       80    18596    2      WHENALTRETURN DO;

       81    18597              %SCREAM (ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='R' );

  18609  5 000010   000000 630400 6                  EPPR0   0
         5 000011   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000012   000000 701000 xent               TSX1    ASH$ERROR
         5 000013   000000 011000                    NOP     0

       82    18612    2         RETURN;

  18612  5 000014   000000 702200 xent               TSX2  ! X66_ARET

       83    18613    2         END;   /* Whenaltreturn from ASB$GETSEG  */
       84    18614    1   DREC$ = DSEG1$ ;

  18614  5 000015   000000 236000 xsym               LDQ     DSEG1$
         5 000016   200003 756100                    STQ     DREC$,,AUTO

       85    18615    1   IF DCBADDR(DCBNUM(M$USERS)) -> F$DCB.FCD#

  18615  5 000017   000000 236007 xsym               LDQ     M$USERS,DL
         5 000020   000001 470400 6                  LDP0    1
         5 000021   000000 471500                    LDP1    0,,PR0
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:15   
         5 000022   100000 473506                    LDP3    0,QL,PR1
         5 000023   300031 236100                    LDQ     25,,PR3
         5 000024   020000 316007                    CANQ    8192,DL
         5 000025   000031 600000 5                  TZE     s:18617

       86    18616    1   THEN TYPE = 1;

  18616  5 000026   000001 235007                    LDA     1,DL
         5 000027   200005 755100                    STA     TYPE,,AUTO
         5 000030   000032 710000 5                  TRA     s:18618

       87    18617    1   ELSE TYPE = 0;

  18617  5 000031   200005 450100                    STZ     TYPE,,AUTO

       88    18618    1   IF DCBADDR(DCBNUM(M$HLP)) -> F$DCB.FCD# THEN TYPE = TYPE + 2 ;

  18618  5 000032   000000 236007 xsym               LDQ     M$HLP,DL
         5 000033   100000 473506                    LDP3    0,QL,PR1
         5 000034   300031 236100                    LDQ     25,,PR3
         5 000035   020000 316007                    CANQ    8192,DL
         5 000036   000042 600000 5                  TZE     s:18619

  18618  5 000037   200005 235100                    LDA     TYPE,,AUTO
         5 000040   000002 035007                    ADLA    2,DL
         5 000041   200005 755100                    STA     TYPE,,AUTO

       89    18619    2   DO SELECT( TYPE );

  18619  5 000042   200005 236100                    LDQ     TYPE,,AUTO
         5 000043   000001 116007                    CMPQ    1,DL
         5 000044   000054 602000 5                  TNC     s:18619+10
         5 000045   000063 600000 5                  TZE     s:18626
         5 000046   000002 116007                    CMPQ    2,DL
         5 000047   000337 602000 5                  TNC     HLP_DONE2
         5 000050   000113 600000 5                  TZE     s:18638
         5 000051   000003 116007                    CMPQ    3,DL
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:16   
         5 000052   000337 601000 5                  TNZ     HLP_DONE2
         5 000053   000170 710000 5                  TRA     s:18656
         5 000054   000000 116003                    CMPQ    0,DU
         5 000055   000057 600000 5                  TZE     s:18622
         5 000056   000337 710000 5                  TRA     HLP_DONE2

       90    18620    2      SELECT( 0 );

       91    18621                                              /* :USERS and :HLP do not exist */
       92    18622    2      CALL ASA$B_USERS_HLP ;

  18622  5 000057   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000060   000000 701000 xent               TSX1    ASA$B_USERS_HLP
         5 000061   000000 011000                    NOP     0
         5 000062   000337 710000 5                  TRA     HLP_DONE2

       93    18623
       94    18624    2      SELECT( 1 );                    /* :USERS exists, but :HLP does not */

       95    18625                                               /* Delete users records in :USERS. */
       96    18626    2      CALL ASB$BOF_USERS ALTRET( USERS_DONE1 ) ;

  18626  5 000063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000064   000000 701000 xent               TSX1    ASB$BOF_USERS
         5 000065   000107 702000 5                  TSX2    USERS_DONE1

       97    18627    3      DO WHILE( AS_TRUE ) ;

  18627  5 000066   000000 234000 xsym               SZN     AS_TRUE
         5 000067   000107 605000 5                  TPL     USERS_DONE1

       98    18628    3         CALL ASB$READ_USERS_SEQ( AS_USERS ) ALTRET( USERS_DONE1 ) ;

  18628  5 000070   000002 630400 6                  EPPR0   2
         5 000071   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000072   000000 701000 xent               TSX1    ASB$READ_USERS_SEQ
         5 000073   000107 702000 5                  TSX2    USERS_DONE1
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:17   

       99    18629    3         CALL ASB$ENQ_USERS ALTRET( EXIT# ) ;

  18629  5 000074   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000075   000000 701000 xent               TSX1    ASB$ENQ_USERS
         5 000076   000354 702000 5                  TSX2    EXIT#

      100    18630    3         CALL ASB$DELREC_USERS ;

  18630  5 000077   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000100   000000 701000 xent               TSX1    ASB$DELREC_USERS
         5 000101   000000 011000                    NOP     0

      101    18631    3         CALL ASB$DEQ_USERS ALTRET( EXIT# );

  18631  5 000102   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000103   000000 701000 xent               TSX1    ASB$DEQ_USERS
         5 000104   000354 702000 5                  TSX2    EXIT#

      102    18632    3         END;

  18632  5 000105   000000 234000 xsym               SZN     AS_TRUE
         5 000106   000070 604000 5                  TMI     s:18628

      103    18633    2   USERS_DONE1:
      104    18634    2      CALL ASA$B_USERS_HLP ;

  18634  5 000107   000002 631400 xsym  USERS_DONE1  EPPR1   B_VECTNIL+2
         5 000110   000000 701000 xent               TSX1    ASA$B_USERS_HLP
         5 000111   000000 011000                    NOP     0
         5 000112   000337 710000 5                  TRA     HLP_DONE2

      105    18635
      106    18636    2      SELECT( 2 );                    /* :HLP exists, but :USERS does not */

      107    18637                                               /* Delete users records in :HLP. */
      108    18638    2      CALL ASB$BOF_HLP ALTRET( HLP_DONE1 ) ;
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:18   

  18638  5 000113   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000114   000000 701000 xent               TSX1    ASB$BOF_HLP
         5 000115   000164 702000 5                  TSX2    HLP_DONE1

      109    18639    3      DO WHILE( AS_TRUE ) ;

  18639  5 000116   000000 234000 xsym               SZN     AS_TRUE
         5 000117   000164 605000 5                  TPL     HLP_DONE1

      110    18640    3         ARS = DSEG1SIZE ;

  18640  5 000120   000000 235000 xsym               LDA     DSEG1SIZE
         5 000121   200004 755100                    STA     ARS,,AUTO

      111    18641    3         CALL ASB$READ_HLP_SEQ( DREC$, ARS, 1 ) ALTRET( HLP_DONE1 ) ;

  18641  5 000122   000003 236000 6                  LDQ     3
         5 000123   200010 756100                    STQ     TYPE+3,,AUTO
         5 000124   200004 630500                    EPPR0   ARS,,AUTO
         5 000125   200007 450500                    STP0    TYPE+2,,AUTO
         5 000126   200003 631500                    EPPR1   DREC$,,AUTO
         5 000127   200006 451500                    STP1    TYPE+1,,AUTO
         5 000130   200006 630500                    EPPR0   TYPE+1,,AUTO
         5 000131   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000132   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         5 000133   000164 702000 5                  TSX2    HLP_DONE1

      112    18642    3         CALL ASB$ENQ_HLP ALTRET( EXIT# ) ;

  18642  5 000134   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000135   000000 701000 xent               TSX1    ASB$ENQ_HLP
         5 000136   000354 702000 5                  TSX2    EXIT#

      113    18643    3         IF USERS_KEY.COUNT > 8

  18643  5 000137   000000 236000 xsym               LDQ     USERS_KEY
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:19   
         5 000140   777000 376003                    ANQ     -512,DU
         5 000141   011000 116003                    CMPQ    4608,DU
         5 000142   000157 602000 5                  TNC     s:18648
         5 000143   200003 470500                    LDP0    DREC$,,AUTO
         5 000144   000000 236100                    LDQ     0,,PR0
         5 000145   777000 376003                    ANQ     -512,DU
         5 000146   002000 116003                    CMPQ    1024,DU
         5 000147   000157 600000 5                  TZE     s:18648
         5 000150   003000 116003                    CMPQ    1536,DU
         5 000151   000157 600000 5                  TZE     s:18648
         5 000152   004000 116003                    CMPQ    2048,DU
         5 000153   000157 600000 5                  TZE     s:18648

      114    18644    3              AND  KL$DREC.ATYP ~= %KLAT_CG#
      115    18645    3              AND  KL$DREC.ATYP ~= %KLAT_RES#
      116    18646    3              AND  KL$DREC.ATYP ~= %KLAT_TRM#
      117    18647    3         THEN CALL ASB$DELREC_HLP ;

  18647  5 000154   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000155   000000 701000 xent               TSX1    ASB$DELREC_HLP
         5 000156   000000 011000                    NOP     0

      118    18648    3         CALL ASB$DEQ_HLP ALTRET( EXIT# ) ;

  18648  5 000157   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000160   000000 701000 xent               TSX1    ASB$DEQ_HLP
         5 000161   000354 702000 5                  TSX2    EXIT#

      119    18649    3         END ;

  18649  5 000162   000000 234000 xsym               SZN     AS_TRUE
         5 000163   000120 604000 5                  TMI     s:18640

      120    18650    2   HLP_DONE1:
      121    18651    2      CALL ASA$B_USERS_HLP ;

  18651  5 000164   000002 631400 xsym  HLP_DONE1    EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:20   
         5 000165   000000 701000 xent               TSX1    ASA$B_USERS_HLP
         5 000166   000000 011000                    NOP     0
         5 000167   000337 710000 5                  TRA     HLP_DONE2

      122    18652
      123    18653    2      SELECT( 3 ) ;                   /* Both :USERS and :HLP exist.  */

      124    18654                                              /* Delete users records that or in :USERS
      125    18655                                                 from both :USERS and :HLP  */
      126    18656    2      CALL ASB$BOF_USERS ALTRET( USERS_DONE2 );

  18656  5 000170   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000171   000000 701000 xent               TSX1    ASB$BOF_USERS
         5 000172   000243 702000 5                  TSX2    USERS_DONE2

      127    18657    3      DO WHILE( AS_TRUE );

  18657  5 000173   000000 234000 xsym               SZN     AS_TRUE
         5 000174   000243 605000 5                  TPL     USERS_DONE2

      128    18658    3         CALL ASB$READ_USERS_SEQ ( AS_USERS )  ALTRET( USERS_DONE2 );

  18658  5 000175   000002 630400 6                  EPPR0   2
         5 000176   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000177   000000 701000 xent               TSX1    ASB$READ_USERS_SEQ
         5 000200   000243 702000 5                  TSX2    USERS_DONE2

      129    18659    3         CALL ASB$ENQ ALTRET( EXIT# ) ;

  18659  5 000201   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000202   000000 701000 xent               TSX1    ASB$ENQ
         5 000203   000354 702000 5                  TSX2    EXIT#

      130    18660    3         IF USERS_KEY.COUNT > 8

  18660  5 000204   000000 236000 xsym               LDQ     USERS_KEY
         5 000205   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:21   
         5 000206   011000 116003                    CMPQ    4608,DU
         5 000207   000236 602000 5                  TNC     s:18669
         5 000210   040000 106400                    CMPC    fill='040'O
         5 000211   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000212   000001 000025 4                  ADSC9   1                        cn=0,n=21
         5 000213   000236 600000 5                  TZE     s:18669
         5 000214   040000 106400                    CMPC    fill='040'O
         5 000215   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000216   000007 000013 4                  ADSC9   7                        cn=0,n=11
         5 000217   000236 600000 5                  TZE     s:18669
         5 000220   040000 106400                    CMPC    fill='040'O
         5 000221   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000222   000012 000017 4                  ADSC9   10                       cn=0,n=15
         5 000223   000236 600000 5                  TZE     s:18669
         5 000224   040000 106400                    CMPC    fill='040'O
         5 000225   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000226   000016 000014 4                  ADSC9   14                       cn=0,n=12
         5 000227   000236 600000 5                  TZE     s:18669

      131    18661    3              AND  USERS_KEY.TXTC ~= 'DEFAULTP            S'
      132    18662    3              AND  USERS_KEY.TXTC ~= ':SYS    LJS'
      133    18663    3              AND  USERS_KEY.TXTC ~= ':FED    SUPPORT'
      134    18664    3              AND  USERS_KEY.TXTC ~= ':SYSTAC LADC'
      135    18665    4         THEN DO;

      136    18666    4            CALL ASB$DELREC_USERS ;

  18666  5 000230   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000231   000000 701000 xent               TSX1    ASB$DELREC_USERS
         5 000232   000000 011000                    NOP     0

      137    18667    4            CALL ASB$DELREC_HLP ;

  18667  5 000233   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000234   000000 701000 xent               TSX1    ASB$DELREC_HLP
         5 000235   000000 011000                    NOP     0

PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:22   
      138    18668    4            END;

      139    18669    3         CALL ASB$DEQ ALTRET( EXIT# );

  18669  5 000236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000237   000000 701000 xent               TSX1    ASB$DEQ
         5 000240   000354 702000 5                  TSX2    EXIT#

      140    18670    3         END ; /* Do while */

  18670  5 000241   000000 234000 xsym               SZN     AS_TRUE
         5 000242   000175 604000 5                  TMI     s:18658

  18666  5 000243                       USERS_DONE2  null
      141    18671    2   USERS_DONE2:;
      142    18672                                               /* Delete users records in :HLP. */
      143    18673    2      CALL ASB$BOF_HLP ALTRET( HLP_DONE2 ) ;

  18673  5 000243   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000244   000000 701000 xent               TSX1    ASB$BOF_HLP
         5 000245   000337 702000 5                  TSX2    HLP_DONE2

      144    18674    3      DO WHILE( AS_TRUE ) ;

  18674  5 000246   000000 234000 xsym               SZN     AS_TRUE
         5 000247   000337 605000 5                  TPL     HLP_DONE2

      145    18675    3         ARS = DSEG1SIZE ;

  18675  5 000250   000000 235000 xsym               LDA     DSEG1SIZE
         5 000251   200004 755100                    STA     ARS,,AUTO

      146    18676    3         CALL ASB$READ_HLP_SEQ( DREC$, ARS, 1 ) ALTRET( HLP_DONE2 ) ;

  18676  5 000252   000003 236000 6                  LDQ     3
         5 000253   200010 756100                    STQ     TYPE+3,,AUTO
         5 000254   200004 630500                    EPPR0   ARS,,AUTO
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:23   
         5 000255   200007 450500                    STP0    TYPE+2,,AUTO
         5 000256   200003 631500                    EPPR1   DREC$,,AUTO
         5 000257   200006 451500                    STP1    TYPE+1,,AUTO
         5 000260   200006 630500                    EPPR0   TYPE+1,,AUTO
         5 000261   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000262   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         5 000263   000337 702000 5                  TSX2    HLP_DONE2

      147    18677    3         CALL ASB$ENQ_HLP ALTRET( EXIT# ) ;

  18677  5 000264   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000265   000000 701000 xent               TSX1    ASB$ENQ_HLP
         5 000266   000354 702000 5                  TSX2    EXIT#

      148    18678    3         IF USERS_KEY.COUNT > 8

  18678  5 000267   000000 236000 xsym               LDQ     USERS_KEY
         5 000270   777000 376003                    ANQ     -512,DU
         5 000271   011000 116003                    CMPQ    4608,DU
         5 000272   000332 602000 5                  TNC     s:18690
         5 000273   040000 106400                    CMPC    fill='040'O
         5 000274   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000275   000001 000025 4                  ADSC9   1                        cn=0,n=21
         5 000276   000332 600000 5                  TZE     s:18690
         5 000277   040000 106400                    CMPC    fill='040'O
         5 000300   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000301   000007 000013 4                  ADSC9   7                        cn=0,n=11
         5 000302   000332 600000 5                  TZE     s:18690
         5 000303   040000 106400                    CMPC    fill='040'O
         5 000304   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000305   000012 000017 4                  ADSC9   10                       cn=0,n=15
         5 000306   000332 600000 5                  TZE     s:18690
         5 000307   040000 106400                    CMPC    fill='040'O
         5 000310   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         5 000311   000016 000014 4                  ADSC9   14                       cn=0,n=12
         5 000312   000332 600000 5                  TZE     s:18690

PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:24   
      149    18679    3              AND  USERS_KEY.TXTC ~= 'DEFAULTP            S'
      150    18680    3              AND  USERS_KEY.TXTC ~= ':SYS    LJS'
      151    18681    3              AND  USERS_KEY.TXTC ~= ':FED    SUPPORT'
      152    18682    3              AND  USERS_KEY.TXTC ~= ':SYSTAC LADC'
      153    18683    3         THEN
      154    18684    3            IF KL$DREC.ATYP ~= %KLAT_STA#

  18684  5 000313   200003 470500                    LDP0    DREC$,,AUTO
         5 000314   000000 236100                    LDQ     0,,PR0
         5 000315   777000 316003                    CANQ    -512,DU
         5 000316   000332 600000 5                  TZE     s:18690
         5 000317   000000 236100                    LDQ     0,,PR0
         5 000320   777000 376003                    ANQ     -512,DU
         5 000321   002000 116003                    CMPQ    1024,DU
         5 000322   000332 600000 5                  TZE     s:18690
         5 000323   003000 116003                    CMPQ    1536,DU
         5 000324   000332 600000 5                  TZE     s:18690
         5 000325   004000 116003                    CMPQ    2048,DU
         5 000326   000332 600000 5                  TZE     s:18690

      155    18685    3                 AND  KL$DREC.ATYP ~= %KLAT_CG#
      156    18686    3                 AND  KL$DREC.ATYP ~= %KLAT_RES#
      157    18687    3                 AND  KL$DREC.ATYP ~= %KLAT_TRM#
      158    18688    3            THEN
      159    18689    3               CALL ASB$DELREC_HLP ;

  18689  5 000327   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000330   000000 701000 xent               TSX1    ASB$DELREC_HLP
         5 000331   000000 011000                    NOP     0

      160    18690    3         CALL ASB$DEQ_HLP ALTRET( EXIT# ) ;

  18690  5 000332   000002 631400 xsym               EPPR1   B_VECTNIL+2
         5 000333   000000 701000 xent               TSX1    ASB$DEQ_HLP
         5 000334   000354 702000 5                  TSX2    EXIT#

      161    18691    3         END ; /* Do while */
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:25   

  18691  5 000335   000000 234000 xsym               SZN     AS_TRUE
         5 000336   000250 604000 5                  TMI     s:18675

  18682  5 000337                       HLP_DONE2    null
      162    18692    2   HLP_DONE2: ;
      163    18693    2      END;    /* Do case( type ); */

      164    18694                                                              /**/
      165    18695    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  18695  5 000337   000004 630400 6                  EPPR0   4
         5 000340   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000341   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000342   000000 011000                    NOP     0

      166    18696    1   CALL ASB$WRITE_LO( '---  Users records deleted  ---', 30 ) ;

  18696  5 000343   000007 630400 6                  EPPR0   7
         5 000344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000345   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000346   000000 011000                    NOP     0

      167    18697    1   CALL ASB$WRITE_LO( AS_BLANK, 1 );

  18697  5 000347   000004 630400 6                  EPPR0   4
         5 000350   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000351   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000352   000000 011000                    NOP     0

      168    18698                                                              /**/
      169    18699    1   RETURN ;

  18699  5 000353   000000 702200 xent               TSX2  ! X66_ARET

      170    18700                                                              /* Errors */
      171    18701                                                              /**/
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:26   
      172    18702    1   EXIT#: RETURN;

  18702  5 000354   000000 702200 xent  EXIT#        TSX2  ! X66_ARET
      173    18703                                                              /**/
      174    18704    1   END   ASR$D_USERS_RECS ;

PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:27   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure ASR$D_USERS_RECS.
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:28   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w UBIN        r     1 ARS                        3-0-0/w PTR         r     1 DREC$
     5-0-0/w UBIN        r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w UBIN        r     1 DSEG1SIZE                  0-0-0/b BIT         r     1 DSEG_FLG
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(576)   r     1 KL$DREC
     0-0-0N  NULL        r     1 M$HLP                      0-0-0N  NULL        r     1 M$USERS


   Procedure ASR$D_USERS_RECS requires 237 words for executable code.
   Procedure ASR$D_USERS_RECS requires 10 words of local(AUTO) storage.

    No errors detected in file ASR$DELETE_USERS.:E05TSI    .
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:29   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:30   
          MINI XREF LISTING

ARS
     18401**DCL     18640<<ASSIGN  18641<>CALL    18675<<ASSIGN  18676<>CALL
ASA$B_USERS_HLP
     18387**DCL-ENT 18622--CALL    18634--CALL    18651--CALL
ASA_BRKS_LOC
     15490**DCL     15490--REDEF
ASB$BOF_HLP
     18363**DCL-ENT 18638--CALL    18673--CALL
ASB$BOF_USERS
     18348**DCL-ENT 18626--CALL    18656--CALL
ASB$DELREC_HLP
     18375**DCL-ENT 18647--CALL    18667--CALL    18689--CALL
ASB$DELREC_USERS
     18360**DCL-ENT 18630--CALL    18666--CALL
ASB$DEQ
     18393**DCL-ENT 18669--CALL
ASB$DEQ_HLP
     18369**DCL-ENT 18648--CALL    18690--CALL
ASB$DEQ_USERS
     18354**DCL-ENT 18631--CALL
ASB$ENQ
     18390**DCL-ENT 18659--CALL
ASB$ENQ_HLP
     18366**DCL-ENT 18642--CALL    18677--CALL
ASB$ENQ_USERS
     18351**DCL-ENT 18629--CALL
ASB$GETSEG
     18378**DCL-ENT 18595--CALL
ASB$READ_HLP_SEQ
     18372**DCL-ENT 18641--CALL    18676--CALL
ASB$READ_USERS_SEQ
     18357**DCL-ENT 18628--CALL    18658--CALL
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:31   
ASB$WRITE_LO
     18381**DCL-ENT 18695--CALL    18696--CALL    18697--CALL
ASH$ERROR
     18384**DCL-ENT 18609--CALL
AS_BLANK
     15350**DCL     18695<>CALL    18697<>CALL
AS_DEFAULT.BANNER_PERM
     16183**DCL     16184--REDEF
AS_DEFAULT.BUDGET.MACCT
     16088**DCL     16092--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     16101**DCL     16104--REDEF
AS_DEFAULT.BUDGET.PACCUM
     16084**DCL     16086--REDEF
AS_DEFAULT.BUDGET.PMAXC
     16079**DCL     16081--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     16199**DCL     16200--REDEF   16201--REDEF
AS_DEFAULT_DREC.PASSWORD
     17453**DCL     17457--REDEF
AS_DEFAULT_DREC.RENAME
     17476**DCL     17477--REDEF
AS_DFLT.BANNER_PERM
     16005**DCL     16006--REDEF
AS_DFLT.BUDGET.MACCT
     15910**DCL     15914--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     15923**DCL     15926--REDEF
AS_DFLT.BUDGET.PACCUM
     15906**DCL     15908--REDEF
AS_DFLT.BUDGET.PMAXC
     15901**DCL     15903--REDEF
AS_DFLT.SETUP_CHRA.TXT
     16021**DCL     16022--REDEF   16023--REDEF
AS_FE_MODE
     15356**DCL     15357--REDEF
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:32   
AS_MODE
     15353**DCL     15355--REDEF
AS_MOD_USER.ACCESS
     18218**DCL     18219--REDEF
AS_MOD_USER.BANNER
     18205**DCL     18206--REDEF
AS_MOD_USER.BANNER_PERM
     18207**DCL     18208--REDEF
AS_MOD_USER.BILL
     18213**DCL     18214--REDEF
AS_MOD_USER.CPROC
     18209**DCL     18210--REDEF
AS_MOD_USER.FEBILL
     18289**DCL     18290--REDEF
AS_MOD_USER.FECXTMEM
     18306**DCL     18307--REDEF
AS_MOD_USER.FEMINTS
     18291**DCL     18292--REDEF
AS_MOD_USER.FEMMEM
     18302**DCL     18303--REDEF
AS_MOD_USER.FEMTIME
     18300**DCL     18301--REDEF
AS_MOD_USER.FEPPRIV
     18297**DCL     18299--REDEF
AS_MOD_USER.FEPRIV
     18294**DCL     18296--REDEF
AS_MOD_USER.FORCE_BIT
     18203**DCL     18204--REDEF
AS_MOD_USER.KEY
     18285**DCL     18287--REDEF
AS_MOD_USER.LASTCPROC
     18211**DCL     18212--REDEF
AS_MOD_USER.LIMITS.DO_
     18259**DCL     18260--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     18275**DCL     18276--REDEF
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:33   
AS_MOD_USER.LIMITS.LO
     18255**DCL     18256--REDEF
AS_MOD_USER.LIMITS.MEM
     18251**DCL     18252--REDEF
AS_MOD_USER.LIMITS.MPRIO
     18279**DCL     18280--REDEF
AS_MOD_USER.LIMITS.PDIS
     18267**DCL     18268--REDEF
AS_MOD_USER.LIMITS.PO
     18263**DCL     18264--REDEF
AS_MOD_USER.LIMITS.TDIS
     18271**DCL     18272--REDEF
AS_MOD_USER.LIMITS.TIME
     18247**DCL     18248--REDEF
AS_MOD_USER.MAXENQ
     18228**DCL     18229--REDEF
AS_MOD_USER.PERM_BIT
     18201**DCL     18202--REDEF
AS_MOD_USER.PPRIV
     18223**DCL     18225--REDEF
AS_MOD_USER.PRIOB
     18230**DCL     18231--REDEF
AS_MOD_USER.PRIV
     18220**DCL     18222--REDEF
AS_MOD_USER.QUAN
     18226**DCL     18227--REDEF
AS_MOD_USER.SETUP
     18199**DCL     18200--REDEF
AS_PROJECT.BANNER_PERM
     16539**DCL     16540--REDEF
AS_PROJECT.BUDGET.MACCT
     16444**DCL     16448--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     16457**DCL     16460--REDEF
AS_PROJECT.BUDGET.PACCUM
     16440**DCL     16442--REDEF
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:34   
AS_PROJECT.BUDGET.PMAXC
     16435**DCL     16437--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     16555**DCL     16556--REDEF   16557--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     16717**DCL     16718--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     16622**DCL     16626--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     16635**DCL     16638--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     16618**DCL     16620--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     16613**DCL     16615--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     16733**DCL     16734--REDEF   16735--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     17939**DCL     17943--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     17962**DCL     17963--REDEF
AS_PROJECT_DREC.PASSWORD
     17777**DCL     17781--REDEF
AS_PROJECT_DREC.RENAME
     17800**DCL     17801--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     16361**DCL     16362--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     16266**DCL     16270--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     16279**DCL     16282--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     16262**DCL     16264--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     16257**DCL     16259--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     16377**DCL     16378--REDEF   16379--REDEF
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:35   
AS_PROJ_ADMIN_DREC.PASSWORD
     17615**DCL     17619--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     17638**DCL     17639--REDEF
AS_TRUE
     15350**DCL     18627>>DOWHILE 18639>>DOWHILE 18657>>DOWHILE 18674>>DOWHILE
AS_USERS
     15712**DCL     18628<>CALL    18658<>CALL
AS_USERS.BANNER_PERM
     15827**DCL     15828--REDEF
AS_USERS.BUDGET.MACCT
     15732**DCL     15736--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     15745**DCL     15748--REDEF
AS_USERS.BUDGET.PACCUM
     15728**DCL     15730--REDEF
AS_USERS.BUDGET.PMAXC
     15723**DCL     15725--REDEF
AS_USERS.SETUP_CHRA.TXT
     15843**DCL     15844--REDEF   15845--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     16895**DCL     16896--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     16800**DCL     16804--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     16813**DCL     16816--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     16796**DCL     16798--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     16791**DCL     16793--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     16911**DCL     16912--REDEF   16913--REDEF
DREC$
     18400**DCL     18424--IMP-PTR 18614<<ASSIGN  18641<>CALL    18643>>IF      18643>>IF      18643>>IF
     18676<>CALL    18684>>IF      18684>>IF      18684>>IF      18684>>IF
DSEG1$
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:36   
     15491**DCL     18614>>ASSIGN
DSEG1SIZE
     15492**DCL     18640>>ASSIGN  18675>>ASSIGN
DSEG_FLG
     15491**DCL     18594>>IF
ERR_CODE
     15485**DCL     15486--REDEF
EXIT#
     18702**LABEL   18629--CALLALT 18631--CALLALT 18642--CALLALT 18648--CALLALT 18659--CALLALT 18669--CALLALT
     18677--CALLALT 18690--CALLALT
F$DCB.ACTPOS
     18561**DCL     18561--REDEF
F$DCB.ARS#
     18535**DCL     18535--REDEF
F$DCB.ATTR
     18554**DCL     18555--REDEF
F$DCB.BORROW
     18569**DCL     18569--REDEF   18569--REDEF   18569--REDEF
F$DCB.DCBNAME.L
     18583**DCL     18583--IMP-SIZ
F$DCB.EOMCHAR#
     18539**DCL     18539--REDEF
F$DCB.FCD#
     18548**DCL     18615>>IF      18618>>IF
F$DCB.FLDID
     18564**DCL     18564--REDEF
F$DCB.FORM$
     18558**DCL     18558--REDEF
F$DCB.FSECT
     18574**DCL     18574--REDEF
F$DCB.FSN#
     18551**DCL     18551--REDEF   18551--REDEF   18552--REDEF
F$DCB.HEADER$
     18557**DCL     18557--REDEF
F$DCB.IXTNSIZE#
     18555**DCL     18555--REDEF
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:37   
F$DCB.LASTSTA$
     18544**DCL     18544--REDEF
F$DCB.LVL
     18570**DCL     18570--REDEF
F$DCB.NAME#.C
     18545**DCL     18545--REDEF
F$DCB.NOEOF
     18567**DCL     18567--REDEF
F$DCB.NRECS#
     18556**DCL     18556--REDEF
F$DCB.NRECX
     18575**DCL     18575--REDEF
F$DCB.OHDR
     18567**DCL     18567--REDEF
F$DCB.ORG#
     18550**DCL     18550--REDEF
F$DCB.PRECNO
     18573**DCL     18573--REDEF
F$DCB.RCSZ
     18579**DCL     18579--REDEF
F$DCB.RES#
     18546**DCL     18546--REDEF
F$DCB.SETX
     18558**DCL     18558--REDEF
F$DCB.TAB$
     18558**DCL     18558--REDEF
F$DCB.TDA
     18572**DCL     18573--REDEF
F$DCB.WSN#
     18546**DCL     18546--REDEF
HLP_DONE1
     18651**LABEL   18638--CALLALT 18641--CALLALT
HLP_DONE2
     18682**LABEL   18673--CALLALT 18676--CALLALT
KL$DREC.ATYP
     18429**DCL     18643>>IF      18643>>IF      18643>>IF      18684>>IF      18684>>IF      18684>>IF
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:38   
     18684>>IF
KL$DREC.PASSWORD
     18482**DCL     18486--REDEF
KL$DREC.RENAME
     18505**DCL     18506--REDEF
KL_DEFAULT.PASSWORD
     18101**DCL     18105--REDEF
KL_DEFAULT.RENAME
     18124**DCL     18125--REDEF
KL_DFLT.PASSWORD
     17291**DCL     17295--REDEF
KL_DFLT.RENAME
     17314**DCL     17315--REDEF
KL_DREC.PASSWORD
     17129**DCL     17133--REDEF
KL_DREC.RENAME
     17152**DCL     17153--REDEF
KL_DREC_CNT.PASSWORD
     17016**DCL     17020--REDEF
KL_DREC_CNT.RENAME
     17039**DCL     17040--REDEF
M$HLP
     18526**DCL     18618--IF
M$USERS
     18527**DCL     18615--IF
PROJ_KEY.TEXT
     15363**DCL     15363--REDEF
PROJ_KEY.TXT.PROJECT
     15363**DCL     15363--REDEF
REMEM_VAR
     15489**DCL     15489--REDEF
REM_FCMD
     15489**DCL     15490--REDEF
TYPE
     18402**DCL     18616<<ASSIGN  18617<<ASSIGN  18618<<ASSIGN  18618>>ASSIGN  18619>>DOSELCT
USERS_DONE1
PL6.E3A0      #001=ASR$D_USERS_RECS File=ASR$DELETE_USERS.:E05TSI                TUE 07/29/97 10:45 Page:39   
     18634**LABEL   18626--CALLALT 18628--CALLALT
USERS_DONE2
     18666**LABEL   18656--CALLALT 18658--CALLALT
USERS_KEY.COUNT
     15360**DCL     18643>>IF      18660>>IF      18678>>IF
USERS_KEY.TEXT
     15360**DCL     15361--REDEF   15361--REDEF   15361--REDEF   15362--REDEF
USERS_KEY.TXTC
     15361**DCL     18660>>IF      18660>>IF      18660>>IF      18660>>IF      18678>>IF      18678>>IF
     18678>>IF      18678>>IF
