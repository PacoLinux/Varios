VERSION E05

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:1    
        1        1        /*M* FSM$DEVICE  Set Unit-Record formatting into open DCB. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CLM=8,ICP,MOC,DMR */
        8        8        /*P*    NAME: FSM$DEVICE
        9        9                PURPOSE: Perform Unit-Record PMME's M$DEVICE (Set formatting
       10       10                   into DCB) and M$LINES (Find out position of printer paper).
       11       11         */
       12       12        /*F*    NAME: FSM$DEVICE
       13       13                PURPOSE: Process the M$DEVICE PMME.
       14       14                   M$DEVICE defines Unit-Record formatting to an open DCB.
       15       15                   This includes page headers, tabulation, and sequencing.
       16       16                DESCRIPTION: FSM$DEVICE merges an M$DEVICE FPT into a DCB.
       17       17                   Tabs are put into TAB$. Headers are put into HEADER$.
       18       18                   Sequencing is put into SEQ, SEQID, SEQCOL.
       19       19                   LINES and DVFC are put where they belong.
       20       20                   PAGE=YES causes current line number to be made very large.
       21       21         */
       22       22        FSM$DEVICE: PROC;
       23       23    1   DCL FMM$DFLOPN ENTRY;
       24       24    1   DCL FMO$GETDOMAIN ENTRY(1);
       25       25    1   DCL FSA$GSP ENTRY(2)ALTRET; /* Get ROSEG space                    */
       26       26    1   DCL FSA$FSP ENTRY(2)ALTRET; /* Free ROSEG space                   */
       27       27    1   DCL HFF$NIL ENTRY(1)ALTRET; /* ALTRET if vector is NIL            */
       28       28    1   DCL HFF$ERASE ENTRY(1)ALTRET; /* ALTRET if vector is ERASE          */
       29       29    1   DCL FSE$UR ENTRY(2)ALTRET;
       30       30    1   DCL FSE$URFILE ENTRY(2)ALTRET;
       31       31    1   DCL FSE$URSTREAM ENTRY(2)ALTRET;
       32       32    1   DCL FSE$TTY ENTRY(2)ALTRET;
       33       33    1   DCL FSE$TTYSTREAM ENTRY(2)ALTRET;
       34       34    1   DCL KIA$UCIO ENTRY(5)ALTRET;
       35       35    1   DCL HFF$DSIZ ENTRY(2);
       36       36    1   DCL FSM$HDRSET ENTRY(1); /* Make user header look pretty */
       37       37        /*** * * * ***/
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:2    
       38       38    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
       39       39    1   DCL B$PS0$ PTR SYMREF;
       40       40    1   DCL B$PS1$ PTR SYMREF;
       41       41    1   DCL B$PS2$ PTR SYMREF;
       42       42        /*** * * * ***/
       43       43        %INCLUDE F$JIT_C;
       44      473        %INCLUDE CP_6;
       45     6032        %MACRO F$DCBI(BASED=BASED);
       46     6033        %INCLUDE F$DCB;
       47     6082        %MEND;
       48     6083        %F$DCBI(BASED="BASED(JDCB$)");
       49     6133        %INCLUDE F$CP6V_C;
       50     6359        %INCLUDE FM$MACROS;
       51     6734        %INCLUDE B_ERRORS_C;
       52     7861        %INCLUDE CP_6_SUBS;
       53     8401        %INCLUDE NK_VFC_C;
       54     8475        %INCLUDE KV_PRMID_E;
       55     8649        %INCLUDE F_FPTCODE_C;
       56     8685        %INCLUDE F_FMTCODE_C;
       57     8719        %KV_PRMID_E;
       58     8875        %INCLUDE KV$VDO;
       59     9890        %KV_VDO_E;
       60     9926        %VLP_TAB(FPTN=VLP$TAB,STCLASS=BASED);
       61     9940        %VLP_HDR(FPTN=VLP$HDR,STCLASS=BASED,LEN=160);
       62     9956        %CODE16;
       63     9964        %FPT$DEVICE_V(BASED="BASED(B$PS0$)");
       64     9968        %NK$VFC(STCLASS=BASED);
       65     9986        /*** CONSTANT DATA ***/
       66     9987        %FPT_WRITE(FPTN=WRNEWP,STCLASS=CONSTANT,VFC=YES);
       67    10018    1   DCL NEWPBUF(0:1) CHAR(1) CONSTANT INIT(%VFC_PGND,%VFC_CLRWND);
       68    10019        %SUB FCG#='0623'O;
       69    10020        %SUB MID#='15'O;
       70    10021        %ERRCODE (NAME=ERRDOMAIN,COD#=%E$DOMAIN);
       71    10025        /*E*    ERROR: FSM-E$DOMAIN-2
       72    10026                MESSAGE: Execute-only DCB %DC opened by another domain.
       73    10027        */
       74    10028        /*** * * * ***/
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:3    
       75    10029    1   DCL JDCB$ PTR;
       76    10030    1   DCL I SBIN;
       77    10031    1   DCL CHARI CHAR(I) BASED UNAL;
       78    10032    1   DCL SDCB$ PTR;
       79    10033        %VLP_HDR(FPTN=AUTOHDR,STCLASS=,LEN=168);
       80    10049    1   DCL CHARAH CHAR(PL6ISDUMB)BASED;
       81    10050    1   DCL PL6ISDUMB UBIN CONSTANT INIT(SIZEC(AUTOHDR));
       82    10051    1   DCL NULLHDR(0:1)UBIN BYTE UNAL CONSTANT INIT
       83    10052    1           (%KV_PRMID_SSNHDR,0);
       84    10053        %EJECT;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:4    
       85    10054    1           CALL TABHDR ALTRET(ALTR);
       86    10055    1   TABHDR: PROC ALTRET;
       87    10056    2           JDCB$= B$JIT.DCB$;
       88    10057    2           IF JDCB$=DCBADDR(1) THEN ALTRETURN;
       89    10058    2           IF JDCB$=DCBADDR(2) THEN ALTRETURN;
       90    10059    3           IF NOT F$DCB.FCD THEN DO;
       91    10060    3              CALL FMO$GETDOMAIN(I);
       92    10061    3              F$DCB.WSR=I;
       93    10062    3              IF F$DCB.FUN=0 THEN
       94    10063    3                 F$DCB.FUN=%CREATE#;
       95    10064    3              CALL FMM$DFLOPN;
       96    10065    3              IF NOT F$DCB.FCD THEN ALTRETURN;
       97    10066    3              END;
       98    10067    2           ELSE
       99    10068    3              IF F$DCB.FFLG&%FFLG_EXEC# THEN DO;
      100    10069    3                 CALL FMO$GETDOMAIN(I);
      101    10070    4                 IF F$DCB.WSR~=I THEN DO;
      102    10071    4                    B$JIT.ERR=ERRDOMAIN;
      103    10072    4                    ALTRETURN;
      104    10073    4                    END;
      105    10074    3                 END;
      106    10075    2           CALL HFF$NIL(B$PS1$) ALTRET(NOTAB);
      107    10076    2           CALL HFF$ERASE(B$PS1$) ALTRET(TABZERO);
      108    10077    2           IF F$DCB.TAB$=ADDR(NIL) THEN
      109    10078    2              CALL FSA$GSP(SIZEW(VLP$TAB),F$DCB.TAB$)ALTRET(ALTR);
      110    10079    2           F$DCB.TAB$->VLP$TAB='0'B;
      111    10080    2           CALL HFF$DSIZ(B$PS1$,I);
      112    10081    2           IF I>32 THEN I=32;
      113    10082    2           F$DCB.TAB$->CHARI=B$PS1$->CHARI;
      114    10083    2           GOTO TABNEW;
      115    10084    2   TABZERO:;
      116    10085    2           IF F$DCB.TAB$~=ADDR(NIL) THEN
      117    10086    2              IF JDCB$=DCBADDR(%M$UC#) THEN
      118    10087    2                 F$DCB.TAB$->VLP$TAB='0'B;
      119    10088    2              ELSE
      120    10089    2                 CALL FSA$FSP(SIZEW(VLP$TAB),F$DCB.TAB$);
      121    10090    2   TABNEW: F$DCB.IWL.TABIWL='0'B;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:5    
      122    10091    3           IF JDCB$->F$DCB.MEDIA=FMTUC# THEN DO;
      123    10092    3              JDCB$->F$DCB.UB$=JDCB$->F$DCB.TAB$;
      124    10093    3              JDCB$->F$DCB.UBYTES=SIZEC(VLP$TAB);
      125    10094    3              JDCB$->F$DCB.WAIT=1;
      126    10095    3              CALL KIA$UCIO(MFC_WRITE,%DVBYTE_VFC#|%DVBYTE_TRANS#|
      127    10096    3                %DVBYTE_BP#,%VFC_ITB,0);
      128    10097    3              END;
      129    10098    2   NOTAB:  ;
      130    10099    2           CALL HFF$NIL(B$PS2$)ALTRET(NOHDR);
      131    10100    2           CALL HFF$ERASE(B$PS2$)ALTRET(HDRZERO);
      132    10101    2           IF JDCB$=DCBADDR(%M$UC#) THEN
      133    10102    2              IF F$DCB.MEDIA~=FMTUC# THEN GOTO NOHDR;
      134    10103    3              ELSE DO;
      135    10104    3                 CALL HFF$DSIZ(B$PS2$,I);
      136    10105    3                 IF I>165 THEN I=165;
      137    10106    3                 CALL CONCAT(ADDR(AUTOHDR)->CHARAH,BINASC(%KV_PRMID_SSNHDR),
      138    10107    3                   BINASC(I),B$PS2$->CHARI);
      139    10108    3                 F$DCB.WAIT=1;
      140    10109    3                 F$DCB.UB$=ADDR(AUTOHDR);
      141    10110    3                 F$DCB.UBYTES=I+2;
      142    10111    3                 CALL KIA$UCIO(MFC_WRITE,%DVBYTE_VFC#|%DVBYTE_TRANS#|
      143    10112    3                   %DVBYTE_BP#,%VFC_SPM,0);
      144    10113    3                 GOTO HDRNEW;
      145    10114    3                 END;
      146    10115    3           IF F$DCB.HEADER$=ADDR(NIL) THEN DO;
      147    10116    3              CALL FSA$GSP(SIZEW(VLP$HDR),F$DCB.HEADER$)ALTRET(ALTR);
      148    10117    3              F$DCB.HEADER$->VLP$HDR='0'B;
      149    10118    3              F$DCB.HEADER$->VLP$HDR.CTL.HEADERHEIGHT#=1;
      150    10119    3              END;
      151    10120    2           I=LENGTHC(VLP$HDR.CTL)+1;
      152    10121    2           F$DCB.HEADER$->CHARI=B$PS2$->CHARI;
      153    10122    2           CALL HFF$DSIZ(B$PS2$,I);
      154    10123    2           I=I-(LENGTHC(VLP$HDR.CTL)+1);
      155    10124    2           IF I>F$DCB.HEADER$->VLP$HDR.TITL.L# THEN
      156    10125    2              I=F$DCB.HEADER$->VLP$HDR.TITL.L#;
      157    10126    2           F$DCB.HEADER$->VLP$HDR.TITL.TITLE#=
      158    10127    2             ADDR(B$PS2$->VLP$HDR.TITL.TITLE#)->CHARI;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:6    
      159    10128    2           CALL FSM$HDRSET(F$DCB);
      160    10129    2           GOTO HDRNEW;
      161    10130    2   HDRZERO:;
      162    10131    2           IF F$DCB.HEADER$~=ADDR(NIL) THEN
      163    10132    2              CALL FSA$FSP(SIZEW(VLP$HDR),F$DCB.HEADER$);
      164    10133    3           IF JDCB$=DCBADDR(%M$UC#) AND F$DCB.MEDIA=FMTUC# THEN DO;
      165    10134    3              F$DCB.WAIT=1;
      166    10135    3              F$DCB.UB$=ADDR(NULLHDR);
      167    10136    3              F$DCB.UBYTES=SIZEC(NULLHDR);
      168    10137    3              CALL KIA$UCIO(MFC_WRITE,%DVBYTE_VFC#|%DVBYTE_TRANS#|
      169    10138    3                %DVBYTE_BP#,%VFC_SPM,0);
      170    10139    3              END;
      171    10140    2   HDRNEW: F$DCB.IWL.HDRIWL='0'B;
      172    10141    2   NOHDR:  ;
      173    10142    2           RETURN;
      174    10143    2   ALTR:   ALTRETURN;
      175    10144    2   END TABHDR;
      176    10145        /**/
      177    10146        /******* BEWARE THIS CODE FOLLOWS THE ONE LINE BE4 TABHDR!!! ******/
      178    10147    1           IF FPT$DEVICE_V.SEQ&'01'B THEN GOTO NOSEQ;
      179    10148    1           F$DCB.SEQ=FPT$DEVICE_V.SEQ;
      180    10149    1           F$DCB.SEQID=FPT$DEVICE_V.SEQID;
      181    10150    1           F$DCB.SEQCOL=FPT$DEVICE_V.SEQCOL;
      182    10151    1           F$DCB.IWL.SEQIWL='0'B;
      183    10152    1   NOSEQ:  ;
      184    10153    1           IF FPT$DEVICE_V.LINES~=0 THEN
      185    10154    1              JDCB$->F$DCB.LINES= FPT$DEVICE_V.LINES;
      186    10155    2           DO CASE(ADDR(FPT$DEVICE_V.DVFC)->NK$VFC.FCN);
      187    10156    2            CASE(%VFCF_SPB,%VFCF_SPA,%VFCF_SKB,%VFCF_SKA,%VFCF_HDR);
      188    10157    2              F$DCB.DVFC=FPT$DEVICE_V.DVFC;
      189    10158    2            CASE(%VFCF_SPC);
      190    10159    3              DO CASE(ADDR(FPT$DEVICE_V.DVFC)->NK$VFC.COUNT);
      191    10160    3               CASE(%VFCS_TRS0,%VFCS_TRS1);
      192    10161    3                 F$DCB.DVFC=FPT$DEVICE_V.DVFC;
      193    10162    3               CASE(ELSE); /* ALL OTHERS NO GOOD; IGNORE */
      194    10163    3               END;
      195    10164    2            CASE(ELSE);
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:7    
      196    10165                /* All others illegal; ignore. */
      197    10166    2            END;
      198    10167    1           IF FPT$DEVICE_V.PAGE OR F$DCB.ORG=%SE# AND NOT F$DCB.IWL.HDRIWL
      199    10168    1           THEN
      200    10169    1              CALL PAGE_CLEAR (NEWPBUF(0));
      201    10170    1           ELSE
      202    10171    1              IF FPT$DEVICE_V.CLEAR
      203    10172    1              THEN
      204    10173    1                 CALL PAGE_CLEAR (NEWPBUF(1));
      205    10174    1              ELSE
      206    10175    1                 IF F$DCB.ORG=%FORM# OR F$DCB.ORG=%SE#
      207    10176    2                 THEN DO;
      208    10177    2                    CALL KIA$UCIO(MFC_TCTL,BINASC(%KV_VDO_FNC_UPDRELDVC),0,0);
      209    10178    2                    END;
      210    10179    1           B$JIT.ERR='0'B;
      211    10180    1   ALTR:   ;
      212    10181    1           RETURN;
      213    10182    1   PAGE_CLEAR: PROC (BUF);
      214    10183    2   DCL BUF CHAR(1);
      215    10184    3           IF F$DCB.FFLG.WNEW THEN DO;
      216    10185    3              F$DCB.UB$=ADDR(BUF);
      217    10186    3              F$DCB.UBYTES=1;
      218    10187    3              F$DCB.WAIT=1;
      219    10188    4              DO CASE(F$DCB.IFMT);
      220    10189    4               CASE(FMTURDEV#);
      221    10190    4                 IF F$DCB.DDEV.LP OR F$DCB.DDEV.IC THEN
      222    10191    4                    CALL FSE$UR(FPTWRITE,WRNEWP.V);
      223    10192    4               CASE(FMTURFILE#);
      224    10193    4                 IF F$DCB.DDEV.LP THEN
      225    10194    4                    CALL FSE$URFILE(FPTWRITE,WRNEWP.V);
      226    10195    4               CASE(FMTURSTRM#);
      227    10196    4                 IF F$DCB.DDEV.LP OR F$DCB.DDEV.IC THEN
      228    10197    4                    CALL FSE$URSTREAM(FPTWRITE,WRNEWP.V);
      229    10198    4               CASE(FMTTTY#);
      230    10199    4                 CALL FSE$TTY(FPTWRITE,WRNEWP.V);
      231    10200    4               CASE(FMTTTYSTRM#);
      232    10201    4                 CALL FSE$TTYSTREAM(FPTWRITE,WRNEWP.V);
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:8    
      233    10202    4               END;
      234    10203    3              END;
      235    10204    2   END PAGE_CLEAR;
      236    10205    1   FSM$UCLDEV: ENTRY;
      237    10206    1           CALL TABHDR;
      238    10207    1           RETURN;
      239    10208    1   END FSM$DEVICE;
      240    10209        %EOD;

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:9    
--  Include file information  --

   KV$VDO.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FSM$DEVICE.

   Procedure FSM$DEVICE requires 479 words for executable code.
   Procedure FSM$DEVICE requires 54 words of local(AUTO) storage.

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:10   

 Object Unit name= FSM$DEVICE                                 File name= FSM$DEVICE.:E05TOU
 UTS= JUL 29 '97 17:35:27.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     16     20  FSM$DEVICE
    2   Proc  even  none   479    737  FSM$DEVICE
    3  RoData even  none    34     42  FSM$DEVICE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  FSM$DEVICE
     2    732                  yes      Std        0  FSM$UCLDEV
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:11   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       5 KIA$UCIO
         yes           Std       1 FMO$GETDOMAIN
         yes           Std       0 FMM$DFLOPN
 yes     yes           Std       1 HFF$NIL
         yes           Std       1 FSM$HDRSET
 yes     yes           Std       1 HFF$ERASE
 yes     yes           Std       2 FSA$GSP
         yes           Std       2 HFF$DSIZ
 yes     yes           Std       2 FSA$FSP
 yes     yes           Std       2 FSE$UR
 yes     yes           Std       2 FSE$TTYSTREAM
 yes     yes           Std       2 FSE$URFILE
 yes     yes           Std       2 FSE$URSTREAM
 yes     yes           Std       2 FSE$TTY
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$PS0$                                B$PS1$
     B$PS2$                                M$UC                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:12   


        1        1        /*M* FSM$DEVICE  Set Unit-Record formatting into open DCB. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* CLM=8,ICP,MOC,DMR */
        8        8        /*P*    NAME: FSM$DEVICE
        9        9                PURPOSE: Perform Unit-Record PMME's M$DEVICE (Set formatting
       10       10                   into DCB) and M$LINES (Find out position of printer paper).
       11       11         */
       12       12        /*F*    NAME: FSM$DEVICE
       13       13                PURPOSE: Process the M$DEVICE PMME.
       14       14                   M$DEVICE defines Unit-Record formatting to an open DCB.
       15       15                   This includes page headers, tabulation, and sequencing.
       16       16                DESCRIPTION: FSM$DEVICE merges an M$DEVICE FPT into a DCB.
       17       17                   Tabs are put into TAB$. Headers are put into HEADER$.
       18       18                   Sequencing is put into SEQ, SEQID, SEQCOL.
       19       19                   LINES and DVFC are put where they belong.
       20       20                   PAGE=YES causes current line number to be made very large.
       21       21         */
       22       22        FSM$DEVICE: PROC;

     22  2 000000   000000 700200 xent  FSM$DEVICE   TSX0  ! X66_AUTO_0
         2 000001   000066 000000                    ZERO    54,0

       23       23    1   DCL FMM$DFLOPN ENTRY;
       24       24    1   DCL FMO$GETDOMAIN ENTRY(1);
       25       25    1   DCL FSA$GSP ENTRY(2)ALTRET; /* Get ROSEG space                    */
       26       26    1   DCL FSA$FSP ENTRY(2)ALTRET; /* Free ROSEG space                   */
       27       27    1   DCL HFF$NIL ENTRY(1)ALTRET; /* ALTRET if vector is NIL            */
       28       28    1   DCL HFF$ERASE ENTRY(1)ALTRET; /* ALTRET if vector is ERASE          */
       29       29    1   DCL FSE$UR ENTRY(2)ALTRET;
       30       30    1   DCL FSE$URFILE ENTRY(2)ALTRET;
       31       31    1   DCL FSE$URSTREAM ENTRY(2)ALTRET;
       32       32    1   DCL FSE$TTY ENTRY(2)ALTRET;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:13   
       33       33    1   DCL FSE$TTYSTREAM ENTRY(2)ALTRET;
       34       34    1   DCL KIA$UCIO ENTRY(5)ALTRET;
       35       35    1   DCL HFF$DSIZ ENTRY(2);
       36       36    1   DCL FSM$HDRSET ENTRY(1); /* Make user header look pretty */
       37       37        /*** * * * ***/
       38       38    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
       39       39    1   DCL B$PS0$ PTR SYMREF;
       40       40    1   DCL B$PS1$ PTR SYMREF;
       41       41    1   DCL B$PS2$ PTR SYMREF;
       42       42        /*** * * * ***/
       43       43        %INCLUDE F$JIT_C;
       44      473        %INCLUDE CP_6;
       45     6032        %MACRO F$DCBI(BASED=BASED);
       46     6033        %INCLUDE F$DCB;
       47     6082        %MEND;
       48     6083        %F$DCBI(BASED="BASED(JDCB$)");
       49     6133        %INCLUDE F$CP6V_C;
       50     6359        %INCLUDE FM$MACROS;
       51     6734        %INCLUDE B_ERRORS_C;
       52     7861        %INCLUDE CP_6_SUBS;
       53     8401        %INCLUDE NK_VFC_C;
       54     8475        %INCLUDE KV_PRMID_E;
       55     8649        %INCLUDE F_FPTCODE_C;
       56     8685        %INCLUDE F_FMTCODE_C;
       57     8719        %KV_PRMID_E;
       58     8875        %INCLUDE KV$VDO;
       59     9890        %KV_VDO_E;
       60     9926        %VLP_TAB(FPTN=VLP$TAB,STCLASS=BASED);
       61     9940        %VLP_HDR(FPTN=VLP$HDR,STCLASS=BASED,LEN=160);
       62     9956        %CODE16;
       63     9964        %FPT$DEVICE_V(BASED="BASED(B$PS0$)");
       64     9968        %NK$VFC(STCLASS=BASED);
       65     9986        /*** CONSTANT DATA ***/
       66     9987        %FPT_WRITE(FPTN=WRNEWP,STCLASS=CONSTANT,VFC=YES);
       67    10018    1   DCL NEWPBUF(0:1) CHAR(1) CONSTANT INIT(%VFC_PGND,%VFC_CLRWND);
       68    10019        %SUB FCG#='0623'O;
       69    10020        %SUB MID#='15'O;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:14   
       70    10021        %ERRCODE (NAME=ERRDOMAIN,COD#=%E$DOMAIN);
       71    10025        /*E*    ERROR: FSM-E$DOMAIN-2
       72    10026                MESSAGE: Execute-only DCB %DC opened by another domain.
       73    10027        */
       74    10028        /*** * * * ***/
       75    10029    1   DCL JDCB$ PTR;
       76    10030    1   DCL I SBIN;
       77    10031    1   DCL CHARI CHAR(I) BASED UNAL;
       78    10032    1   DCL SDCB$ PTR;
       79    10033        %VLP_HDR(FPTN=AUTOHDR,STCLASS=,LEN=168);
       80    10049    1   DCL CHARAH CHAR(PL6ISDUMB)BASED;
       81    10050    1   DCL PL6ISDUMB UBIN CONSTANT INIT(SIZEC(AUTOHDR));
       82    10051    1   DCL NULLHDR(0:1)UBIN BYTE UNAL CONSTANT INIT
       83    10052    1           (%KV_PRMID_SSNHDR,0);
       84    10053        %EJECT;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:15   
       85    10054    1           CALL TABHDR ALTRET(ALTR);

  10054  2 000002   000005 701000 2                  TSX1    TABHDR
         2 000003   000632 702000 2                  TSX2    ALTR
         2 000004   000475 710000 2                  TRA     s:10147

       86    10055    1   TABHDR: PROC ALTRET;

  10055  2 000005   200062 741300       TABHDR       STX1  ! AUTOHDR+44,,AUTO

       87    10056    2           JDCB$= B$JIT.DCB$;

  10056  2 000006   000000 470400 xsym               LDP0    B$JIT$
         2 000007   000232 236100                    LDQ     154,,PR0
         2 000010   200003 756100                    STQ     JDCB$,,AUTO

       88    10057    2           IF JDCB$=DCBADDR(1) THEN ALTRETURN;

  10057  2 000011   000000 471400 3                  LDP1    0
         2 000012   100000 473500                    LDP3    0,,PR1
         2 000013   300001 116100                    CMPQ    1,,PR3
         2 000014   000016 601000 2                  TNZ     s:10058

  10057  2 000015   000000 702211                    TSX2  ! 0,X1

       89    10058    2           IF JDCB$=DCBADDR(2) THEN ALTRETURN;

  10058  2 000016   300002 116100                    CMPQ    2,,PR3
         2 000017   000021 601000 2                  TNZ     s:10059

  10058  2 000020   000000 702211                    TSX2  ! 0,X1

       90    10059    3           IF NOT F$DCB.FCD THEN DO;

  10059  2 000021   200003 474500                    LDP4    JDCB$,,AUTO
         2 000022   400031 236100                    LDQ     25,,PR4
         2 000023   020000 316007                    CANQ    8192,DL
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:16   
         2 000024   000055 601000 2                  TNZ     s:10068

       91    10060    3              CALL FMO$GETDOMAIN(I);

  10060  2 000025   200004 635500                    EPPR5   I,,AUTO
         2 000026   200064 455500                    STP5    @BUF+1,,AUTO
         2 000027   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000031   000000 701000 xent               TSX1    FMO$GETDOMAIN
         2 000032   000000 011000                    NOP     0

       92    10061    3              F$DCB.WSR=I;

  10061  2 000033   200003 470500                    LDP0    JDCB$,,AUTO
         2 000034   200004 236100                    LDQ     I,,AUTO
         2 000035   000022 736000                    QLS     18
         2 000036   000040 552120                    STBQ    32,'20'O,PR0

       93    10062    3              IF F$DCB.FUN=0 THEN

  10062  2 000037   000032 236100                    LDQ     26,,PR0
         2 000040   000777 316003                    CANQ    511,DU
         2 000041   000044 601000 2                  TNZ     s:10064

       94    10063    3                 F$DCB.FUN=%CREATE#;

  10063  2 000042   000003 236003                    LDQ     3,DU
         2 000043   000032 552120                    STBQ    26,'20'O,PR0

       95    10064    3              CALL FMM$DFLOPN;

  10064  2 000044   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000045   000000 701000 xent               TSX1    FMM$DFLOPN
         2 000046   000000 011000                    NOP     0

       96    10065    3              IF NOT F$DCB.FCD THEN ALTRETURN;

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:17   
  10065  2 000047   200003 470500                    LDP0    JDCB$,,AUTO
         2 000050   000031 236100                    LDQ     25,,PR0
         2 000051   020000 316007                    CANQ    8192,DL
         2 000052   000101 601000 2                  TNZ     s:10075

  10065  2 000053   200062 221300                    LDX1  ! AUTOHDR+44,,AUTO
         2 000054   000000 702211                    TSX2  ! 0,X1

       97    10066    3              END;
       98    10067    2           ELSE
       99    10068    3              IF F$DCB.FFLG&%FFLG_EXEC# THEN DO;

  10068  2 000055   400004 220100                    LDX0    4,,PR4
         2 000056   002000 360003                    ANX0    1024,DU
         2 000057   000101 600000 2                  TZE     s:10075

      100    10069    3                 CALL FMO$GETDOMAIN(I);

  10069  2 000060   200004 635500                    EPPR5   I,,AUTO
         2 000061   200064 455500                    STP5    @BUF+1,,AUTO
         2 000062   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000063   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000064   000000 701000 xent               TSX1    FMO$GETDOMAIN
         2 000065   000000 011000                    NOP     0

      101    10070    4                 IF F$DCB.WSR~=I THEN DO;

  10070  2 000066   200003 470500                    LDP0    JDCB$,,AUTO
         2 000067   000040 236100                    LDQ     32,,PR0
         2 000070   000022 772000                    QRL     18
         2 000071   000777 376007                    ANQ     511,DL
         2 000072   200004 116100                    CMPQ    I,,AUTO
         2 000073   000101 600000 2                  TZE     s:10075

      102    10071    4                    B$JIT.ERR=ERRDOMAIN;

  10071  2 000074   000015 236000 1                  LDQ     ERRDOMAIN
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:18   
         2 000075   000000 471400 xsym               LDP1    B$JIT$
         2 000076   100012 756100                    STQ     10,,PR1

      103    10072    4                    ALTRETURN;

  10072  2 000077   200062 221300                    LDX1  ! AUTOHDR+44,,AUTO
         2 000100   000000 702211                    TSX2  ! 0,X1

      104    10073    4                    END;
      105    10074    3                 END;
      106    10075    2           CALL HFF$NIL(B$PS1$) ALTRET(NOTAB);

  10075  2 000101   000001 630400 3                  EPPR0   1
         2 000102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000103   000000 701000 xent               TSX1    HFF$NIL
         2 000104   000225 702000 2                  TSX2    NOTAB

      107    10076    2           CALL HFF$ERASE(B$PS1$) ALTRET(TABZERO);

  10076  2 000105   000001 630400 3                  EPPR0   1
         2 000106   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000107   000000 701000 xent               TSX1    HFF$ERASE
         2 000110   000157 702000 2                  TSX2    TABZERO

      108    10077    2           IF F$DCB.TAB$=ADDR(NIL) THEN

  10077  2 000111   200003 470500                    LDP0    JDCB$,,AUTO
         2 000112   000047 236100                    LDQ     39,,PR0
         2 000113   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000114   000125 601000 2                  TNZ     s:10079

      109    10078    2              CALL FSA$GSP(SIZEW(VLP$TAB),F$DCB.TAB$)ALTRET(ALTR);

  10078  2 000115   200003 236100                    LDQ     JDCB$,,AUTO
         2 000116   000047 036003                    ADLQ    39,DU
         2 000117   000002 235000 3                  LDA     2
         2 000120   200064 757100                    STAQ    @BUF+1,,AUTO
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:19   
         2 000121   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000122   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000123   000000 701000 xent               TSX1    FSA$GSP
         2 000124   000473 702000 2                  TSX2    ALTR

      110    10079    2           F$DCB.TAB$->VLP$TAB='0'B;

  10079  2 000125   200003 470500                    LDP0    JDCB$,,AUTO
         2 000126   000047 471500                    LDP1    39,,PR0
         2 000127   000100 100400                    MLR     fill='000'O
         2 000130   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000131   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32

      111    10080    2           CALL HFF$DSIZ(B$PS1$,I);

  10080  2 000132   200004 631500                    EPPR1   I,,AUTO
         2 000133   200065 451500                    STP1    @BUF+2,,AUTO
         2 000134   000001 236000 3                  LDQ     1
         2 000135   200064 756100                    STQ     @BUF+1,,AUTO
         2 000136   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000137   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000140   000000 701000 xent               TSX1    HFF$DSIZ
         2 000141   000000 011000                    NOP     0

      112    10081    2           IF I>32 THEN I=32;

  10081  2 000142   200004 235100                    LDA     I,,AUTO
         2 000143   000040 115007                    CMPA    32,DL
         2 000144   000147 604400 2                  TMOZ    s:10082

  10081  2 000145   000040 236007                    LDQ     32,DL
         2 000146   200004 756100                    STQ     I,,AUTO

      113    10082    2           F$DCB.TAB$->CHARI=B$PS1$->CHARI;

  10082  2 000147   200003 470500                    LDP0    JDCB$,,AUTO
         2 000150   000047 471500                    LDP1    39,,PR0
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:20   
         2 000151   000000 473400 xsym               LDP3    B$PS1$
         2 000152   200004 720100                    LXL0    I,,AUTO
         2 000153   040140 100540                    MLR     fill='040'O
         2 000154   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000155   100000 000010                    ADSC9   0,,PR1                   cn=0,n=*X0

      114    10083    2           GOTO TABNEW;

  10083  2 000156   000204 710000 2                  TRA     TABNEW

  10082  2 000157                       TABZERO      null
      115    10084    2   TABZERO:;
      116    10085    2           IF F$DCB.TAB$~=ADDR(NIL) THEN

  10085  2 000157   200003 470500                    LDP0    JDCB$,,AUTO
         2 000160   000047 236100                    LDQ     39,,PR0
         2 000161   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000162   000204 600000 2                  TZE     TABNEW

      117    10086    2              IF JDCB$=DCBADDR(%M$UC#) THEN

  10086  2 000163   000000 471400 3                  LDP1    0
         2 000164   100000 473500                    LDP3    0,,PR1
         2 000165   200003 236100                    LDQ     JDCB$,,AUTO
         2 000166   300003 116100                    CMPQ    3,,PR3
         2 000167   000175 601000 2                  TNZ     s:10089

      118    10087    2                 F$DCB.TAB$->VLP$TAB='0'B;

  10087  2 000170   000047 474500                    LDP4    39,,PR0
         2 000171   000100 100400                    MLR     fill='000'O
         2 000172   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000173   400000 000040                    ADSC9   0,,PR4                   cn=0,n=32
         2 000174   000204 710000 2                  TRA     TABNEW

      119    10088    2              ELSE
      120    10089    2                 CALL FSA$FSP(SIZEW(VLP$TAB),F$DCB.TAB$);
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:21   

  10089  2 000175   000047 036003                    ADLQ    39,DU
         2 000176   000002 235000 3                  LDA     2
         2 000177   200064 757100                    STAQ    @BUF+1,,AUTO
         2 000200   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000201   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000202   000000 701000 xent               TSX1    FSA$FSP
         2 000203   000000 011000                    NOP     0

      121    10090    2   TABNEW: F$DCB.IWL.TABIWL='0'B;

  10090  2 000204   200003 470500       TABNEW       LDP0    JDCB$,,AUTO
         2 000205   000003 236000 3                  LDQ     3
         2 000206   000103 356100                    ANSQ    67,,PR0

      122    10091    3           IF JDCB$->F$DCB.MEDIA=FMTUC# THEN DO;

  10091  2 000207   000103 236100                    LDQ     67,,PR0
         2 000210   000777 376003                    ANQ     511,DU
         2 000211   000014 116003                    CMPQ    12,DU
         2 000212   000225 601000 2                  TNZ     NOTAB

      123    10092    3              JDCB$->F$DCB.UB$=JDCB$->F$DCB.TAB$;

  10092  2 000213   000047 236100                    LDQ     39,,PR0
         2 000214   000075 756100                    STQ     61,,PR0

      124    10093    3              JDCB$->F$DCB.UBYTES=SIZEC(VLP$TAB);

  10093  2 000215   000040 235007                    LDA     32,DL
         2 000216   000076 755100                    STA     62,,PR0

      125    10094    3              JDCB$->F$DCB.WAIT=1;

  10094  2 000217   000020 236007                    LDQ     16,DL
         2 000220   000064 256100                    ORSQ    52,,PR0

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:22   
      126    10095    3              CALL KIA$UCIO(MFC_WRITE,%DVBYTE_VFC#|%DVBYTE_TRANS#|

  10095  2 000221   000006 630400 3                  EPPR0   6
         2 000222   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000223   000000 701000 xent               TSX1    KIA$UCIO
         2 000224   000000 011000                    NOP     0

      127    10096    3                %DVBYTE_BP#,%VFC_ITB,0);
      128    10097    3              END;

  10096  2 000225                       NOTAB        null
      129    10098    2   NOTAB:  ;
      130    10099    2           CALL HFF$NIL(B$PS2$)ALTRET(NOHDR);

  10099  2 000225   000012 630400 3                  EPPR0   10
         2 000226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000227   000000 701000 xent               TSX1    HFF$NIL
         2 000230   000471 702000 2                  TSX2    NOHDR

      131    10100    2           CALL HFF$ERASE(B$PS2$)ALTRET(HDRZERO);

  10100  2 000231   000012 630400 3                  EPPR0   10
         2 000232   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000233   000000 701000 xent               TSX1    HFF$ERASE
         2 000234   000426 702000 2                  TSX2    HDRZERO

      132    10101    2           IF JDCB$=DCBADDR(%M$UC#) THEN

  10101  2 000235   000000 470400 3                  LDP0    0
         2 000236   000000 471500                    LDP1    0,,PR0
         2 000237   200003 236100                    LDQ     JDCB$,,AUTO
         2 000240   100003 116100                    CMPQ    3,,PR1
         2 000241   000333 601000 2                  TNZ     s:10115

      133    10102    2              IF F$DCB.MEDIA~=FMTUC# THEN GOTO NOHDR;

  10102  2 000242   200003 473500                    LDP3    JDCB$,,AUTO
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:23   
         2 000243   300103 236100                    LDQ     67,,PR3
         2 000244   000777 376003                    ANQ     511,DU
         2 000245   000014 116003                    CMPQ    12,DU
         2 000246   000471 601000 2                  TNZ     NOHDR

      134    10103    3              ELSE DO;

      135    10104    3                 CALL HFF$DSIZ(B$PS2$,I);

  10104  2 000247   200004 634500                    EPPR4   I,,AUTO
         2 000250   200065 454500                    STP4    @BUF+2,,AUTO
         2 000251   000012 236000 3                  LDQ     10
         2 000252   200064 756100                    STQ     @BUF+1,,AUTO
         2 000253   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000254   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000255   000000 701000 xent               TSX1    HFF$DSIZ
         2 000256   000000 011000                    NOP     0

      136    10105    3                 IF I>165 THEN I=165;

  10105  2 000257   200004 235100                    LDA     I,,AUTO
         2 000260   000245 115007                    CMPA    165,DL
         2 000261   000264 604400 2                  TMOZ    s:10106

  10105  2 000262   000245 236007                    LDQ     165,DL
         2 000263   200004 756100                    STQ     I,,AUTO

      137    10106    3                 CALL CONCAT(ADDR(AUTOHDR)->CHARAH,BINASC(%KV_PRMID_SSNHDR),

  10106  2 000264   200004 236100                    LDQ     I,,AUTO
         2 000265   000033 736000                    QLS     27
         2 000266   000013 276000 3                  ORQ     11
         2 000267   000016 720000 1                  LXL0    PL6ISDUMB
         2 000270   040140 100400                    MLR     fill='040'O
         2 000271   000014 000001 3                  ADSC9   12                       cn=0,n=1
         2 000272   200006 000010                    ADSC9   AUTOHDR,,AUTO            cn=0,n=*X0
         2 000273   200064 756100                    STQ     @BUF+1,,AUTO
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:24   
         2 000274   000016 236000 1                  LDQ     PL6ISDUMB
         2 000275   000002 116007                    CMPQ    2,DL
         2 000276   000316 602000 2                  TNC     s:10108
         2 000277   200064 236100                    LDQ     @BUF+1,,AUTO
         2 000300   200065 756100                    STQ     @BUF+2,,AUTO
         2 000301   777777 621010                    EAX1    -1,X0
         2 000302   040140 100500                    MLR     fill='040'O
         2 000303   200065 000004                    ADSC9   @BUF+2,,AUTO             cn=0,n=4
         2 000304   200006 200011                    ADSC9   AUTOHDR,,AUTO            cn=1,n=*X1
         2 000305   000016 236000 1                  LDQ     PL6ISDUMB
         2 000306   000003 116007                    CMPQ    3,DL
         2 000307   000316 602000 2                  TNC     s:10108
         2 000310   777776 622006                    EAX2    -2,QL
         2 000311   000000 470400 xsym               LDP0    B$PS2$
         2 000312   200004 723100                    LXL3    I,,AUTO
         2 000313   040140 100540                    MLR     fill='040'O
         2 000314   000000 000013                    ADSC9   0,,PR0                   cn=0,n=*X3
         2 000315   200006 400012                    ADSC9   AUTOHDR,,AUTO            cn=2,n=*X2

      138    10107    3                   BINASC(I),B$PS2$->CHARI);
      139    10108    3                 F$DCB.WAIT=1;

  10108  2 000316   200003 470500                    LDP0    JDCB$,,AUTO
         2 000317   000020 236007                    LDQ     16,DL
         2 000320   000064 256100                    ORSQ    52,,PR0

      140    10109    3                 F$DCB.UB$=ADDR(AUTOHDR);

  10109  2 000321   200006 631500                    EPPR1   AUTOHDR,,AUTO
         2 000322   000075 451500                    STP1    61,,PR0

      141    10110    3                 F$DCB.UBYTES=I+2;

  10110  2 000323   200004 235100                    LDA     I,,AUTO
         2 000324   000002 035007                    ADLA    2,DL
         2 000325   000076 755100                    STA     62,,PR0

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:25   
      142    10111    3                 CALL KIA$UCIO(MFC_WRITE,%DVBYTE_VFC#|%DVBYTE_TRANS#|

  10111  2 000326   000016 630400 3                  EPPR0   14
         2 000327   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000330   000000 701000 xent               TSX1    KIA$UCIO
         2 000331   000000 011000                    NOP     0

      143    10112    3                   %DVBYTE_BP#,%VFC_SPM,0);
      144    10113    3                 GOTO HDRNEW;

  10113  2 000332   000466 710000 2                  TRA     HDRNEW

      145    10114    3                 END;
      146    10115    3           IF F$DCB.HEADER$=ADDR(NIL) THEN DO;

  10115  2 000333   200003 473500                    LDP3    JDCB$,,AUTO
         2 000334   300046 236100                    LDQ     38,,PR3
         2 000335   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000336   000361 601000 2                  TNZ     s:10120

      147    10116    3              CALL FSA$GSP(SIZEW(VLP$HDR),F$DCB.HEADER$)ALTRET(ALTR);

  10116  2 000337   200003 236100                    LDQ     JDCB$,,AUTO
         2 000340   000046 036003                    ADLQ    38,DU
         2 000341   000023 235000 3                  LDA     19
         2 000342   200064 757100                    STAQ    @BUF+1,,AUTO
         2 000343   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000344   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000345   000000 701000 xent               TSX1    FSA$GSP
         2 000346   000473 702000 2                  TSX2    ALTR

      148    10117    3              F$DCB.HEADER$->VLP$HDR='0'B;

  10117  2 000347   200003 470500                    LDP0    JDCB$,,AUTO
         2 000350   000046 471500                    LDP1    38,,PR0
         2 000351   000100 100400                    MLR     fill='000'O
         2 000352   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:26   
         2 000353   100000 000245                    ADSC9   0,,PR1                   cn=0,n=165

      149    10118    3              F$DCB.HEADER$->VLP$HDR.CTL.HEADERHEIGHT#=1;

  10118  2 000354   000046 471500                    LDP1    38,,PR0
         2 000355   100000 236100                    LDQ     0,,PR1
         2 000356   000024 376000 3                  ANQ     20
         2 000357   000001 276003                    ORQ     1,DU
         2 000360   100000 756100                    STQ     0,,PR1

      150    10119    3              END;

      151    10120    2           I=LENGTHC(VLP$HDR.CTL)+1;

  10120  2 000361   000005 235007                    LDA     5,DL
         2 000362   200004 755100                    STA     I,,AUTO

      152    10121    2           F$DCB.HEADER$->CHARI=B$PS2$->CHARI;

  10121  2 000363   200003 470500                    LDP0    JDCB$,,AUTO
         2 000364   000046 471500                    LDP1    38,,PR0
         2 000365   000000 473400 xsym               LDP3    B$PS2$
         2 000366   000000 620005                    EAX0    0,AL
         2 000367   200004 721100                    LXL1    I,,AUTO
         2 000370   040140 100540                    MLR     fill='040'O
         2 000371   300000 000010                    ADSC9   0,,PR3                   cn=0,n=*X0
         2 000372   100000 000011                    ADSC9   0,,PR1                   cn=0,n=*X1

      153    10122    2           CALL HFF$DSIZ(B$PS2$,I);

  10122  2 000373   200004 631500                    EPPR1   I,,AUTO
         2 000374   200065 451500                    STP1    @BUF+2,,AUTO
         2 000375   000012 236000 3                  LDQ     10
         2 000376   200064 756100                    STQ     @BUF+1,,AUTO
         2 000377   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000400   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000401   000000 701000 xent               TSX1    HFF$DSIZ
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:27   
         2 000402   000000 011000                    NOP     0

      154    10123    2           I=I-(LENGTHC(VLP$HDR.CTL)+1);

  10123  2 000403   000005 336007                    LCQ     5,DL
         2 000404   200004 056100                    ASQ     I,,AUTO

      155    10124    2           IF I>F$DCB.HEADER$->VLP$HDR.TITL.L# THEN

  10124  2 000405   200003 470500                    LDP0    JDCB$,,AUTO
         2 000406   000046 471500                    LDP1    38,,PR0
         2 000407   100001 236100                    LDQ     1,,PR1
         2 000410   000033 772000                    QRL     27
         2 000411   200004 116100                    CMPQ    I,,AUTO
         2 000412   000414 605000 2                  TPL     s:10126

      156    10125    2              I=F$DCB.HEADER$->VLP$HDR.TITL.L#;

  10125  2 000413   200004 756100                    STQ     I,,AUTO

      157    10126    2           F$DCB.HEADER$->VLP$HDR.TITL.TITLE#=

  10126  2 000414   000000 473400 xsym               LDP3    B$PS2$
         2 000415   200004 720100                    LXL0    I,,AUTO
         2 000416   040100 100540                    MLR     fill='040'O
         2 000417   300001 200010                    ADSC9   1,,PR3                   cn=1,n=*X0
         2 000420   100001 200240                    ADSC9   1,,PR1                   cn=1,n=160

      158    10127    2             ADDR(B$PS2$->VLP$HDR.TITL.TITLE#)->CHARI;
      159    10128    2           CALL FSM$HDRSET(F$DCB);

  10128  2 000421   200003 630500                    EPPR0   JDCB$,,AUTO
         2 000422   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000423   000000 701000 xent               TSX1    FSM$HDRSET
         2 000424   000000 011000                    NOP     0

      160    10129    2           GOTO HDRNEW;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:28   

  10129  2 000425   000466 710000 2                  TRA     HDRNEW

  10127  2 000426                       HDRZERO      null
      161    10130    2   HDRZERO:;
      162    10131    2           IF F$DCB.HEADER$~=ADDR(NIL) THEN

  10131  2 000426   200003 470500                    LDP0    JDCB$,,AUTO
         2 000427   000046 236100                    LDQ     38,,PR0
         2 000430   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000431   000442 600000 2                  TZE     s:10133

      163    10132    2              CALL FSA$FSP(SIZEW(VLP$HDR),F$DCB.HEADER$);

  10132  2 000432   200003 236100                    LDQ     JDCB$,,AUTO
         2 000433   000046 036003                    ADLQ    38,DU
         2 000434   000023 235000 3                  LDA     19
         2 000435   200064 757100                    STAQ    @BUF+1,,AUTO
         2 000436   200064 630500                    EPPR0   @BUF+1,,AUTO
         2 000437   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000440   000000 701000 xent               TSX1    FSA$FSP
         2 000441   000000 011000                    NOP     0

      164    10133    3           IF JDCB$=DCBADDR(%M$UC#) AND F$DCB.MEDIA=FMTUC# THEN DO;

  10133  2 000442   000000 470400 3                  LDP0    0
         2 000443   000000 471500                    LDP1    0,,PR0
         2 000444   200003 236100                    LDQ     JDCB$,,AUTO
         2 000445   100003 116100                    CMPQ    3,,PR1
         2 000446   000466 601000 2                  TNZ     HDRNEW
         2 000447   200003 473500                    LDP3    JDCB$,,AUTO
         2 000450   300103 236100                    LDQ     67,,PR3
         2 000451   000777 376003                    ANQ     511,DU
         2 000452   000014 116003                    CMPQ    12,DU
         2 000453   000466 601000 2                  TNZ     HDRNEW

      165    10134    3              F$DCB.WAIT=1;
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:29   

  10134  2 000454   000020 236007                    LDQ     16,DL
         2 000455   300064 256100                    ORSQ    52,,PR3

      166    10135    3              F$DCB.UB$=ADDR(NULLHDR);

  10135  2 000456   000025 236000 3                  LDQ     21
         2 000457   300075 756100                    STQ     61,,PR3

      167    10136    3              F$DCB.UBYTES=SIZEC(NULLHDR);

  10136  2 000460   000002 235007                    LDA     2,DL
         2 000461   300076 755100                    STA     62,,PR3

      168    10137    3              CALL KIA$UCIO(MFC_WRITE,%DVBYTE_VFC#|%DVBYTE_TRANS#|

  10137  2 000462   000016 630400 3                  EPPR0   14
         2 000463   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000464   000000 701000 xent               TSX1    KIA$UCIO
         2 000465   000000 011000                    NOP     0

      169    10138    3                %DVBYTE_BP#,%VFC_SPM,0);
      170    10139    3              END;

      171    10140    2   HDRNEW: F$DCB.IWL.HDRIWL='0'B;

  10140  2 000466   200003 470500       HDRNEW       LDP0    JDCB$,,AUTO
         2 000467   000026 236000 3                  LDQ     22
         2 000470   000103 356100                    ANSQ    67,,PR0

  10138  2 000471                       NOHDR        null
      172    10141    2   NOHDR:  ;
      173    10142    2           RETURN;

  10142  2 000471   200062 221300                    LDX1  ! AUTOHDR+44,,AUTO
         2 000472   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:30   
      174    10143    2   ALTR:   ALTRETURN;

  10143  2 000473   200062 221300       ALTR         LDX1  ! AUTOHDR+44,,AUTO
         2 000474   000000 702211                    TSX2  ! 0,X1

      175    10144    2   END TABHDR;
      176    10145        /**/
      177    10146        /******* BEWARE THIS CODE FOLLOWS THE ONE LINE BE4 TABHDR!!! ******/
      178    10147    1           IF FPT$DEVICE_V.SEQ&'01'B THEN GOTO NOSEQ;

  10147  2 000475   000000 470400 xsym               LDP0    B$PS0$
         2 000476   000000 236100                    LDQ     0,,PR0
         2 000477   000022 736000                    QLS     18
         2 000500   600000 376003                    ANQ     -65536,DU
         2 000501   200000 376003                    ANQ     65536,DU
         2 000502   000521 601000 2                  TNZ     NOSEQ

      179    10148    1           F$DCB.SEQ=FPT$DEVICE_V.SEQ;

  10148  2 000503   200003 471500                    LDP1    JDCB$,,AUTO
         2 000504   000000 236100                    LDQ     0,,PR0
         2 000505   000011 772000                    QRL     9
         2 000506   100044 676100                    ERQ     36,,PR1
         2 000507   000400 376007                    ANQ     256,DL
         2 000510   100044 656100                    ERSQ    36,,PR1

      180    10149    1           F$DCB.SEQID=FPT$DEVICE_V.SEQID;

  10149  2 000511   000001 236100                    LDQ     1,,PR0
         2 000512   100045 756100                    STQ     37,,PR1

      181    10150    1           F$DCB.SEQCOL=FPT$DEVICE_V.SEQCOL;

  10150  2 000513   000000 236100                    LDQ     0,,PR0
         2 000514   100044 676100                    ERQ     36,,PR1
         2 000515   000377 376007                    ANQ     255,DL
         2 000516   100044 656100                    ERSQ    36,,PR1
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:31   

      182    10151    1           F$DCB.IWL.SEQIWL='0'B;

  10151  2 000517   000027 236000 3                  LDQ     23
         2 000520   100103 356100                    ANSQ    67,,PR1

  10151  2 000521                       NOSEQ        null
      183    10152    1   NOSEQ:  ;
      184    10153    1           IF FPT$DEVICE_V.LINES~=0 THEN

  10153  2 000521   000002 720100                    LXL0    2,,PR0
         2 000522   000525 600000 2                  TZE     s:10155

      185    10154    1              JDCB$->F$DCB.LINES= FPT$DEVICE_V.LINES;

  10154  2 000523   200003 471500                    LDP1    JDCB$,,AUTO
         2 000524   100044 740100                    STX0    36,,PR1

      186    10155    2           DO CASE(ADDR(FPT$DEVICE_V.DVFC)->NK$VFC.FCN);

  10155  2 000525   000002 236100                    LDQ     2,,PR0
         2 000526   000037 772000                    QRL     31
         2 000527   000007 376007                    ANQ     7,DL
         2 000530   000010 116007                    CMPQ    8,DL
         2 000531   000533 602006 2                  TNC     s:10155+6,QL
         2 000532   000566 710000 2                  TRA     s:10167
         2 000533   000566 710000 2                  TRA     s:10167
         2 000534   000550 710000 2                  TRA     s:10159
         2 000535   000566 710000 2                  TRA     s:10167
         2 000536   000543 710000 2                  TRA     s:10157
         2 000537   000543 710000 2                  TRA     s:10157
         2 000540   000543 710000 2                  TRA     s:10157
         2 000541   000543 710000 2                  TRA     s:10157
         2 000542   000543 710000 2                  TRA     s:10157

      187    10156    2            CASE(%VFCF_SPB,%VFCF_SPA,%VFCF_SKB,%VFCF_SKA,%VFCF_HDR);

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:32   
      188    10157    2              F$DCB.DVFC=FPT$DEVICE_V.DVFC;

  10157  2 000543   200003 471500                    LDP1    JDCB$,,AUTO
         2 000544   000002 236100                    LDQ     2,,PR0
         2 000545   000022 772000                    QRL     18
         2 000546   100044 552110                    STBQ    36,'10'O,PR1
         2 000547   000566 710000 2                  TRA     s:10167

      189    10158    2            CASE(%VFCF_SPC);

      190    10159    3              DO CASE(ADDR(FPT$DEVICE_V.DVFC)->NK$VFC.COUNT);

  10159  2 000550   000002 236100                    LDQ     2,,PR0
         2 000551   000033 772000                    QRL     27
         2 000552   000017 376007                    ANQ     15,DL
         2 000553   000016 136007                    SBLQ    14,DL
         2 000554   000002 116007                    CMPQ    2,DL
         2 000555   000557 602006 2                  TNC     s:10159+7,QL
         2 000556   000566 710000 2                  TRA     s:10167
         2 000557   000561 710000 2                  TRA     s:10161
         2 000560   000561 710000 2                  TRA     s:10161

      191    10160    3               CASE(%VFCS_TRS0,%VFCS_TRS1);

      192    10161    3                 F$DCB.DVFC=FPT$DEVICE_V.DVFC;

  10161  2 000561   200003 471500                    LDP1    JDCB$,,AUTO
         2 000562   000002 236100                    LDQ     2,,PR0
         2 000563   000022 772000                    QRL     18
         2 000564   100044 552110                    STBQ    36,'10'O,PR1
         2 000565   000566 710000 2                  TRA     s:10167

      193    10162    3               CASE(ELSE); /* ALL OTHERS NO GOOD; IGNORE */

      194    10163    3               END;

      195    10164    2            CASE(ELSE);
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:33   

      196    10165                /* All others illegal; ignore. */
      197    10166    2            END;

      198    10167    1           IF FPT$DEVICE_V.PAGE OR F$DCB.ORG=%SE# AND NOT F$DCB.IWL.HDRIWL

  10167  2 000566   000000 236100                    LDQ     0,,PR0
         2 000567   100000 316007                    CANQ    32768,DL
         2 000570   000601 601000 2                  TNZ     s:10169
         2 000571   200003 471500                    LDP1    JDCB$,,AUTO
         2 000572   100032 236100                    LDQ     26,,PR1
         2 000573   777000 376003                    ANQ     -512,DU
         2 000574   027000 116003                    CMPQ    11776,DU
         2 000575   000606 601000 2                  TNZ     s:10171
         2 000576   100103 236100                    LDQ     67,,PR1
         2 000577   100000 316007                    CANQ    32768,DL
         2 000600   000606 601000 2                  TNZ     s:10171

      199    10168    1           THEN
      200    10169    1              CALL PAGE_CLEAR (NEWPBUF(0));

  10169  2 000601   000030 236000 3                  LDQ     24
         2 000602   200063 756100                    STQ     AUTOHDR+45,,AUTO
         2 000603   000633 701000 2                  TSX1    PAGE_CLEAR
         2 000604   000000 011000                    NOP     0
         2 000605   000630 710000 2                  TRA     s:10179

      201    10170    1           ELSE
      202    10171    1              IF FPT$DEVICE_V.CLEAR

  10171  2 000606   000000 236100                    LDQ     0,,PR0
         2 000607   040000 316007                    CANQ    16384,DL
         2 000610   000616 600000 2                  TZE     s:10175

      203    10172    1              THEN
      204    10173    1                 CALL PAGE_CLEAR (NEWPBUF(1));

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:34   
  10173  2 000611   000031 236000 3                  LDQ     25
         2 000612   200063 756100                    STQ     AUTOHDR+45,,AUTO
         2 000613   000633 701000 2                  TSX1    PAGE_CLEAR
         2 000614   000000 011000                    NOP     0
         2 000615   000630 710000 2                  TRA     s:10179

      205    10174    1              ELSE
      206    10175    1                 IF F$DCB.ORG=%FORM# OR F$DCB.ORG=%SE#

  10175  2 000616   100032 236100                    LDQ     26,,PR1
         2 000617   777000 376003                    ANQ     -512,DU
         2 000620   031000 116003                    CMPQ    12800,DU
         2 000621   000624 600000 2                  TZE     s:10177
         2 000622   027000 116003                    CMPQ    11776,DU
         2 000623   000630 601000 2                  TNZ     s:10179

      207    10176    2                 THEN DO;

      208    10177    2                    CALL KIA$UCIO(MFC_TCTL,BINASC(%KV_VDO_FNC_UPDRELDVC),0,0);

  10177  2 000624   000034 630400 3                  EPPR0   28
         2 000625   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000626   000000 701000 xent               TSX1    KIA$UCIO
         2 000627   000000 011000                    NOP     0

      209    10178    2                    END;

      210    10179    1           B$JIT.ERR='0'B;

  10179  2 000630   000000 470400 xsym               LDP0    B$JIT$
         2 000631   000012 450100                    STZ     10,,PR0

  10179  2 000632                       ALTR         null
      211    10180    1   ALTR:   ;
      212    10181    1           RETURN;

  10181  2 000632   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:35   

      213    10182    1   PAGE_CLEAR: PROC (BUF);

  10182  2 000633   200062 741300       PAGE_CLEAR   STX1  ! AUTOHDR+44,,AUTO

      214    10183    2   DCL BUF CHAR(1);
      215    10184    3           IF F$DCB.FFLG.WNEW THEN DO;

  10184  2 000634   200003 470500                    LDP0    JDCB$,,AUTO
         2 000635   000004 236100                    LDQ     4,,PR0
         2 000636   100000 316003                    CANQ    32768,DU
         2 000637   000730 600000 2                  TZE     s:10204

      216    10185    3              F$DCB.UB$=ADDR(BUF);

  10185  2 000640   200063 236100                    LDQ     @BUF,,AUTO
         2 000641   000075 756100                    STQ     61,,PR0

      217    10186    3              F$DCB.UBYTES=1;

  10186  2 000642   000001 235007                    LDA     1,DL
         2 000643   000076 755100                    STA     62,,PR0

      218    10187    3              F$DCB.WAIT=1;

  10187  2 000644   000020 236007                    LDQ     16,DL
         2 000645   000064 256100                    ORSQ    52,,PR0

      219    10188    4              DO CASE(F$DCB.IFMT);

  10188  2 000646   000103 236100                    LDQ     67,,PR0
         2 000647   000033 772000                    QRL     27
         2 000650   000013 136007                    SBLQ    11,DL
         2 000651   000007 116007                    CMPQ    7,DL
         2 000652   000654 602006 2                  TNC     s:10188+6,QL
         2 000653   000730 710000 2                  TRA     s:10204
         2 000654   000675 710000 2                  TRA     s:10193
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:36   
         2 000655   000730 710000 2                  TRA     s:10204
         2 000656   000730 710000 2                  TRA     s:10204
         2 000657   000717 710000 2                  TRA     s:10199
         2 000660   000663 710000 2                  TRA     s:10190
         2 000661   000705 710000 2                  TRA     s:10196
         2 000662   000724 710000 2                  TRA     s:10201

      220    10189    4               CASE(FMTURDEV#);

      221    10190    4                 IF F$DCB.DDEV.LP OR F$DCB.DDEV.IC THEN

  10190  2 000663   000004 236100                    LDQ     4,,PR0
         2 000664   400000 316007                    CANQ    -131072,DL
         2 000665   000670 601000 2                  TNZ     s:10191
         2 000666   100000 316007                    CANQ    32768,DL
         2 000667   000730 600000 2                  TZE     s:10204

      222    10191    4                    CALL FSE$UR(FPTWRITE,WRNEWP.V);

  10191  2 000670   000040 630400 3                  EPPR0   32
         2 000671   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000672   000000 701000 xent               TSX1    FSE$UR
         2 000673   000000 011000                    NOP     0
         2 000674   000730 710000 2                  TRA     s:10204

      223    10192    4               CASE(FMTURFILE#);

      224    10193    4                 IF F$DCB.DDEV.LP THEN

  10193  2 000675   000004 236100                    LDQ     4,,PR0
         2 000676   400000 316007                    CANQ    -131072,DL
         2 000677   000730 600000 2                  TZE     s:10204

      225    10194    4                    CALL FSE$URFILE(FPTWRITE,WRNEWP.V);

  10194  2 000700   000040 630400 3                  EPPR0   32
         2 000701   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:37   
         2 000702   000000 701000 xent               TSX1    FSE$URFILE
         2 000703   000000 011000                    NOP     0
         2 000704   000730 710000 2                  TRA     s:10204

      226    10195    4               CASE(FMTURSTRM#);

      227    10196    4                 IF F$DCB.DDEV.LP OR F$DCB.DDEV.IC THEN

  10196  2 000705   000004 236100                    LDQ     4,,PR0
         2 000706   400000 316007                    CANQ    -131072,DL
         2 000707   000712 601000 2                  TNZ     s:10197
         2 000710   100000 316007                    CANQ    32768,DL
         2 000711   000730 600000 2                  TZE     s:10204

      228    10197    4                    CALL FSE$URSTREAM(FPTWRITE,WRNEWP.V);

  10197  2 000712   000040 630400 3                  EPPR0   32
         2 000713   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000714   000000 701000 xent               TSX1    FSE$URSTREAM
         2 000715   000000 011000                    NOP     0
         2 000716   000730 710000 2                  TRA     s:10204

      229    10198    4               CASE(FMTTTY#);

      230    10199    4                 CALL FSE$TTY(FPTWRITE,WRNEWP.V);

  10199  2 000717   000040 630400 3                  EPPR0   32
         2 000720   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000721   000000 701000 xent               TSX1    FSE$TTY
         2 000722   000000 011000                    NOP     0
         2 000723   000730 710000 2                  TRA     s:10204

      231    10200    4               CASE(FMTTTYSTRM#);

      232    10201    4                 CALL FSE$TTYSTREAM(FPTWRITE,WRNEWP.V);

  10201  2 000724   000040 630400 3                  EPPR0   32
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:38   
         2 000725   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000726   000000 701000 xent               TSX1    FSE$TTYSTREAM
         2 000727   000000 011000                    NOP     0

      233    10202    4               END;

      234    10203    3              END;

      235    10204    2   END PAGE_CLEAR;

  10204  2 000730   200062 221300                    LDX1  ! AUTOHDR+44,,AUTO
         2 000731   000001 702211                    TSX2  ! 1,X1

      236    10205    1   FSM$UCLDEV: ENTRY;

  10205  2 000732   000000 700200 xent  FSM$UCLDEV   TSX0  ! X66_AUTO_0
         2 000733   000066 000000                    ZERO    54,0

      237    10206    1           CALL TABHDR;

  10206  2 000734   000005 701000 2                  TSX1    TABHDR
         2 000735   000000 011000                    NOP     0

      238    10207    1           RETURN;

  10207  2 000736   000000 702200 xent               TSX2  ! X66_ARET

WRNEWP
 Sect OctLoc
   1     000   000003 777640   000010 006000   000000 177640   000000 006014    ................
   1     004   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     010   000000 400400   000000 000000   000000 000000   100000 000000    ............@...

NEWPBUF
 Sect OctLoc
   1     014   032035 ******                                                    ....

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:39   
ERRDOMAIN
 Sect OctLoc
   1     015   062315 006262                                                    2...

PL6ISDUMB
 Sect OctLoc
   1     016   000000 000260                                                    ....

NULLHDR
 Sect OctLoc
   1     017   021000 ******                                                    ....

(unnamed)
 Sect OctLoc
   3     000   000000 006003   000000 006000   000012 006000   777777 377777    ................
   3     004   320000 000000   023040 040040   000003 006000   000004 006000    .....   ........
   3     010   000005 006000   000002 006000   000000 006000   000040 040040    .............
   3     014   021040 040040   024040 040040   000003 006000   000004 006000    .   .   ........
   3     020   000015 006000   000002 006000   000000 000052   000022 006000    ...........*....
   3     024   777760 777777   000017 006000   777777 677777   777777 577777    ................
   3     030   000014 006000   000014 206000   000000 000014   036040 040040    .............
   3     034   000032 006000   000033 006000   000002 006000   000002 006000    ................
   3     040   000003 006000   000010 006000                                    ........
      239    10208    1   END FSM$DEVICE;
      240    10209        %EOD;

PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:40   
--  Include file information  --

   KV$VDO.:E05TOU  is referenced.
   F_FMTCODE_C.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   NK_VFC_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure FSM$DEVICE.
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:41   

 **** Variables and constants ****

  ****  Section 001 RoData FSM$DEVICE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/b STRC        r     1 ERRDOMAIN
    14-0-0/c CHAR        r     1 NEWPBUF(0:1)
    17-0-0/b UBIN(9)     r     1 NULLHDR(0:1)
    16-0-0/w UBIN        r     1 PL6ISDUMB                  0-0-0/d STRC(432)   r     1 WRNEWP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    63-0-0/w PTR         r     1 @BUF                       6-0-0/w STRC(1557)  r     1 AUTOHDR
    *0-0-0/c CHAR        r     1 BUF                        4-0-0/w SBIN        r     1 I
     3-0-0/w PTR         r     1 JDCB$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/c ACHR        r     1 CHARAH
     0-0-0/c ACHR        r     1 CHARI                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/d STRC(144)   r     1 FPT$DEVICE_V               0-0-0/c STRC(9)     r     1 NK$VFC
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:42   
     0-0-0/w STRC(1485)  r     1 VLP$HDR                    0-0-0/w STRC(288)   r     1 VLP$TAB


   Procedure FSM$DEVICE requires 479 words for executable code.
   Procedure FSM$DEVICE requires 54 words of local(AUTO) storage.
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:43   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:44   
          MINI XREF LISTING

ALTR
     10179**LABEL   10054--CALLALT
ALTR IN PROCEDURE TABHDR
     10143**LABEL   10078--CALLALT 10116--CALLALT
AUTOHDR
     10044**DCL     10050--DCLINIT 10106--CALLBLT 10109--ASSIGN
B$JIT.DCB$
       460**DCL     10056>>ASSIGN
B$JIT.ERR
       370**DCL     10071<<ASSIGN  10179<<ASSIGN
B$JIT.ERR.MID
       371**DCL       371--REDEF
B$JIT$
        38**DCL       365--IMP-PTR 10056>>ASSIGN  10071>>ASSIGN  10179>>ASSIGN
B$PS0$
        39**DCL      9965--IMP-PTR 10147>>IF      10148>>ASSIGN  10149>>ASSIGN  10150>>ASSIGN  10153>>IF
     10154>>ASSIGN  10155>>DOCASE  10157>>ASSIGN  10159>>DOCASE  10161>>ASSIGN  10167>>IF      10171>>IF
B$PS1$
        40**DCL     10075<>CALL    10076<>CALL    10080<>CALL    10082>>ASSIGN
B$PS2$
        41**DCL     10099<>CALL    10100<>CALL    10104<>CALL    10106>>CALLBLT 10121>>ASSIGN  10122<>CALL
     10126>>ASSIGN
BUF IN PROCEDURE PAGE_CLEAR
     10183**DCL     10182--PROC    10185--ASSIGN
CHARAH
     10049**DCL     10106<<CALLBLT
CHARI
     10031**DCL     10082<<ASSIGN  10082>>ASSIGN  10106>>CALLBLT 10121<<ASSIGN  10121>>ASSIGN  10126>>ASSIGN
ERRDOMAIN
     10022**DCL     10071>>ASSIGN
F$DCB
      6084**DCL     10128<>CALL
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:45   
F$DCB.ACTPOS
      6109**DCL      6109--REDEF
F$DCB.ARS
      6084**DCL      6084--REDEF
F$DCB.ATTR
      6102**DCL      6103--REDEF
F$DCB.BORROW
      6117**DCL      6117--REDEF    6117--REDEF    6117--REDEF
F$DCB.DCBNAME.L
      6131**DCL      6131--IMP-SIZ 10128>>CALL
F$DCB.DDEV.IC
      6090**DCL     10190>>IF      10196>>IF
F$DCB.DDEV.LP
      6090**DCL     10190>>IF      10193>>IF      10196>>IF
F$DCB.DVFC
      6105**DCL     10157<<ASSIGN  10161<<ASSIGN
F$DCB.EOMCHAR
      6088**DCL      6088--REDEF
F$DCB.FCD
      6097**DCL     10059>>IF      10065>>IF
F$DCB.FFLG
      6088**DCL     10068>>IF
F$DCB.FFLG.WNEW
      6089**DCL     10184>>IF
F$DCB.FLDID
      6112**DCL      6112--REDEF
F$DCB.FORM$
      6106**DCL      6106--REDEF
F$DCB.FSECT
      6122**DCL      6122--REDEF
F$DCB.FSN
      6099**DCL      6099--REDEF    6099--REDEF    6100--REDEF
F$DCB.FUN
      6098**DCL     10062>>IF      10063<<ASSIGN
F$DCB.HEADER$
      6105**DCL      6105--REDEF   10115>>IF      10116<>CALL    10117>>ASSIGN  10118>>ASSIGN  10121>>ASSIGN
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:46   
     10124>>IF      10125>>ASSIGN  10126>>ASSIGN  10131>>IF      10132<>CALL
F$DCB.IFMT
      6124**DCL     10188>>DOCASE
F$DCB.IWL.HDRIWL
      6125**DCL     10140<<ASSIGN  10167>>IF
F$DCB.IWL.SEQIWL
      6125**DCL     10151<<ASSIGN
F$DCB.IWL.TABIWL
      6125**DCL     10090<<ASSIGN
F$DCB.IXTNSIZE
      6103**DCL      6103--REDEF
F$DCB.LASTSTA$
      6093**DCL      6093--REDEF
F$DCB.LINES
      6105**DCL     10154<<ASSIGN
F$DCB.LVL
      6118**DCL      6118--REDEF
F$DCB.MEDIA
      6124**DCL     10091>>IF      10102>>IF      10133>>IF
F$DCB.NAME.C
      6093**DCL      6093--REDEF
F$DCB.NOEOF
      6114**DCL      6114--REDEF
F$DCB.NRECS
      6104**DCL      6104--REDEF
F$DCB.NRECX
      6123**DCL      6123--REDEF
F$DCB.OHDR
      6115**DCL      6115--REDEF
F$DCB.ORG
      6098**DCL      6098--REDEF   10167>>IF      10175>>IF      10175>>IF
F$DCB.PRECNO
      6121**DCL      6121--REDEF
F$DCB.RCSZ
      6126**DCL      6126--REDEF
F$DCB.RES
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:47   
      6094**DCL      6094--REDEF
F$DCB.SEQ
      6105**DCL     10148<<ASSIGN
F$DCB.SEQCOL
      6105**DCL     10150<<ASSIGN
F$DCB.SEQID
      6105**DCL     10149<<ASSIGN
F$DCB.SETX
      6106**DCL      6106--REDEF
F$DCB.TAB$
      6105**DCL      6106--REDEF   10077>>IF      10078<>CALL    10079>>ASSIGN  10082>>ASSIGN  10085>>IF
     10087>>ASSIGN  10089<>CALL    10092>>ASSIGN
F$DCB.TDA
      6120**DCL      6120--REDEF
F$DCB.UB$
      6122**DCL     10092<<ASSIGN  10109<<ASSIGN  10135<<ASSIGN  10185<<ASSIGN
F$DCB.UBYTES
      6122**DCL     10093<<ASSIGN  10110<<ASSIGN  10136<<ASSIGN  10186<<ASSIGN
F$DCB.WAIT
      6116**DCL     10094<<ASSIGN  10108<<ASSIGN  10134<<ASSIGN  10187<<ASSIGN
F$DCB.WSN
      6095**DCL      6095--REDEF
F$DCB.WSR
      6101**DCL     10061<<ASSIGN  10070>>IF
FMM$DFLOPN
        23**DCL-ENT 10064--CALL
FMO$GETDOMAIN
        24**DCL-ENT 10060--CALL    10069--CALL
FPT$DEVICE_V.CLEAR
      9965**DCL     10171>>IF
FPT$DEVICE_V.DVFC
      9966**DCL     10155--DOCASE  10157>>ASSIGN  10159--DOCASE  10161>>ASSIGN
FPT$DEVICE_V.LINES
      9966**DCL     10153>>IF      10154>>ASSIGN
FPT$DEVICE_V.PAGE
      9965**DCL     10167>>IF
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:48   
FPT$DEVICE_V.SEQ
      9965**DCL     10147>>IF      10148>>ASSIGN
FPT$DEVICE_V.SEQCOL
      9965**DCL     10150>>ASSIGN
FPT$DEVICE_V.SEQID
      9965**DCL     10149>>ASSIGN
FSA$FSP
        26**DCL-ENT 10089--CALL    10132--CALL
FSA$GSP
        25**DCL-ENT 10078--CALL    10116--CALL
FSE$TTY
        32**DCL-ENT 10199--CALL
FSE$TTYSTREAM
        33**DCL-ENT 10201--CALL
FSE$UR
        29**DCL-ENT 10191--CALL
FSE$URFILE
        30**DCL-ENT 10194--CALL
FSE$URSTREAM
        31**DCL-ENT 10197--CALL
FSM$HDRSET
        36**DCL-ENT 10128--CALL
HDRNEW IN PROCEDURE TABHDR
     10140**LABEL   10113--GOTO    10129--GOTO
HDRZERO IN PROCEDURE TABHDR
     10127**LABEL   10100--CALLALT
HFF$DSIZ
        35**DCL-ENT 10080--CALL    10104--CALL    10122--CALL
HFF$ERASE
        28**DCL-ENT 10076--CALL    10100--CALL
HFF$NIL
        27**DCL-ENT 10075--CALL    10099--CALL
I
     10030**DCL     10031--IMP-SIZ 10060<>CALL    10061>>ASSIGN  10069<>CALL    10070>>IF      10080<>CALL
     10081>>IF      10081<<ASSIGN  10082>>ASSIGN  10082>>ASSIGN  10104<>CALL    10105>>IF      10105<<ASSIGN
     10106>>CALLBLT 10106>>CALLBLT 10110>>ASSIGN  10120<<ASSIGN  10121>>ASSIGN  10121>>ASSIGN  10122<>CALL
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:49   
     10123<<ASSIGN  10123>>ASSIGN  10124>>IF      10125<<ASSIGN  10126>>ASSIGN
JDCB$
     10029**DCL      6084--IMP-PTR 10056<<ASSIGN  10057>>IF      10058>>IF      10059>>IF      10061>>ASSIGN
     10062>>IF      10063>>ASSIGN  10065>>IF      10068>>IF      10070>>IF      10077>>IF      10078>>CALL
     10079>>ASSIGN  10082>>ASSIGN  10085>>IF      10086>>IF      10087>>ASSIGN  10089>>CALL    10090>>ASSIGN
     10091>>IF      10092>>ASSIGN  10092>>ASSIGN  10093>>ASSIGN  10094>>ASSIGN  10101>>IF      10102>>IF
     10108>>ASSIGN  10109>>ASSIGN  10110>>ASSIGN  10115>>IF      10116>>CALL    10117>>ASSIGN  10118>>ASSIGN
     10121>>ASSIGN  10124>>IF      10125>>ASSIGN  10126>>ASSIGN  10128>>CALL    10128>>CALL    10131>>IF
     10132>>CALL    10133>>IF      10133>>IF      10134>>ASSIGN  10135>>ASSIGN  10136>>ASSIGN  10140>>ASSIGN
     10148>>ASSIGN  10149>>ASSIGN  10150>>ASSIGN  10151>>ASSIGN  10154>>ASSIGN  10157>>ASSIGN  10161>>ASSIGN
     10167>>IF      10167>>IF      10175>>IF      10175>>IF      10184>>IF      10185>>ASSIGN  10186>>ASSIGN
     10187>>ASSIGN  10188>>DOCASE  10190>>IF      10190>>IF      10193>>IF      10196>>IF      10196>>IF
KIA$UCIO
        34**DCL-ENT 10095--CALL    10111--CALL    10137--CALL    10177--CALL
NEWPBUF
     10018**DCL     10169<>CALL    10173<>CALL
NK$VFC.COUNT
      9983**DCL     10159>>DOCASE
NK$VFC.FCN
      9983**DCL     10155>>DOCASE
NOHDR IN PROCEDURE TABHDR
     10138**LABEL   10099--CALLALT 10102--GOTO
NOSEQ
     10151**LABEL   10147--GOTO
NOTAB IN PROCEDURE TABHDR
     10096**LABEL   10075--CALLALT
NULLHDR
     10051**DCL     10135--ASSIGN  10136--ASSIGN
PAGE_CLEAR
     10182**PROC    10169--CALL    10173--CALL
PL6ISDUMB
     10050**DCL     10049--IMP-SIZ 10106>>CALLBLT
TABHDR
     10055**PROC    10054--CALL    10206--CALL
TABNEW IN PROCEDURE TABHDR
     10090**LABEL   10083--GOTO
PL6.E3A0      #001=FSM$DEVICE File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:35 Page:50   
TABZERO IN PROCEDURE TABHDR
     10082**LABEL   10076--CALLALT
VLP$HDR
      9951**DCL     10116--CALL    10117<<ASSIGN  10132--CALL
VLP$HDR.CTL
      9951**DCL     10120--ASSIGN  10123--ASSIGN
VLP$HDR.CTL.HEADERHEIGHT#
      9952**DCL     10118<<ASSIGN
VLP$HDR.TITL.L#
      9953**DCL     10124>>IF      10125>>ASSIGN
VLP$HDR.TITL.TITLE#
      9954**DCL     10126<<ASSIGN  10126--ASSIGN
VLP$TAB
      9937**DCL     10078--CALL    10079<<ASSIGN  10087<<ASSIGN  10089--CALL    10093--ASSIGN
WRNEWP.STATION_
     10006**DCL     10006--REDEF
WRNEWP.V
     10007**DCL     10004--DCLINIT 10191<>CALL    10194<>CALL    10197<>CALL    10199<>CALL    10201<>CALL
WRNEWP.V.DVBYTE.VFC#
     10013**DCL     10013--REDEF

PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:51   
      241        1        /*T***********************************************************/
      242        2        /*T*                                                         */
      243        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      244        4        /*T*                                                         */
      245        5        /*T***********************************************************/
      246        6        /*F*    NAME: FSM$LINES
      247        7                PURPOSE: Process the M$LINES PMME.
      248        8                   This returns the current page number and number of lines
      249        9                   remaining on the page if appropriate for DCB assignment.
      250       10                DESCRIPTION:   If DCB has a FORM$ or is streamed to one,
      251       11                   page number is in FORM$ area and lines remaining can be
      252       12                   computed.  Do so.
      253       13         */
      254       14        FSM$LINES: PROC;
      255       15    1   DCL HFF$NILERASE ENTRY(1)ALTRET; /* ALTRET if vector is NIL/ERASE      */
      256       16        /*** * * * ***/
      257       17    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
      258       18    1   DCL B$PS1$ PTR SYMREF;
      259       19        /*** * * * ***/
      260       20        %INCLUDE CP_6_SUBS;
      261      560        %INCLUDE FM$FIT;
      262      781        %INCLUDE F$DCB;
      263      830        %INCLUDE F$JIT_C;
      264     1260        %INCLUDE CP_6;
      265     6819        %INCLUDE F_FPTCODE_C;
      266     6855        %INCLUDE KV_PRMID_E;
      267     7029        %INCLUDE F_FMTCODE_C;
      268     7063        %KV_PRMID_E;
      269     7219        %VLR_LINES(FPTN=VLR$LINES,STCLASS="BASED(B$PS1$)");
      270     7233        %CODE16;
      271     7241        /*** * * * ***/
      272     7242    1   DCL JDCB$ PTR;
      273     7243    1   DCL FORM$ PTR;
      274     7244    1   DCL 1 FROMFEP  BASED (B$PS1$) ALIGNED,
      275     7245    1         2  *  BIT(19)  UNAL,
      276     7246    1         2  PGHI  UBIN(8)  UNAL,
      277     7247    1         2  *  BIT(1)  UNAL,
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:52   
      278     7248    1         2  PGLO  UBIN(8)  UNAL;
      279     7249    1   DCL  KIA$UCIOD  ENTRY(4) ALTRET;
      280     7250        %EJECT;
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:53   
      281     7251    1           JDCB$= B$JIT.DCB$;
      282     7252    1           CALL HFF$NILERASE(1) ALTRET(RETN);
      283     7253    1           IF NOT JDCB$->F$DCB.FCD THEN GOTO RETNNO;
      284     7254    1           IF JDCB$->F$DCB.IASN=%STREAM# THEN
      285     7255    1              FORM$ = JDCB$ -> F$DCB.CFU$;
      286     7256    1           ELSE FORM$ = JDCB$;
      287     7257    1           IF FORM$ -> F$DCB.FORM$ = ADDR(NIL)
      288     7258    1           THEN
      289     7259    2           DO;
      290     7260    2              IF FORM$ -> F$DCB.MEDIA = FMTUC#
      291     7261    2                AND  JDCB$ -> F$DCB.ORG = %UR#
      292     7262    2              THEN
      293     7263    3              DO;
      294     7264    3                 IF JDCB$->F$DCB.IASN = %STREAM#
      295     7265    3                 THEN
      296     7266    3                    B$JIT.DCB$ = JDCB$->F$DCB.CFU$;
      297     7267    3                 B$JIT.DCB$ -> F$DCB.UB$ = B$PS1$;
      298     7268    3                 B$JIT.DCB$ -> F$DCB.UBYTES = SIZEC(VLR$LINES);
      299     7269    3                 B$JIT.DCB$ -> F$DCB.WAIT = 1;
      300     7270    3                 CALL KIA$UCIOD(MFC_RSTAT,0,BINASC(%KV_PRMID_LINES),0)
      301     7271    3                   ALTRET(RETNNO);
      302     7272    3                 VLR$LINES.PAGE# = FROMFEP.PGHI * 256 + FROMFEP.PGLO;
      303     7273    3                 RETURN;
      304     7274    3                 END;
      305     7275    2              ELSE GOTO RETNNO;
      306     7276    2              END;
      307     7277    1           ELSE
      308     7278    2           DO;
      309     7279    2              FORM$ = FORM$ -> F$DCB.FORM$;
      310     7280    2              VLR$LINES.PAGE#=FORM$->CODE16.PAGENO-FORM$->CODE16.PAGEBASE;
      311     7281    2              VLR$LINES.RLINES#=JDCB$->F$DCB.LINES-FORM$->CODE16.LINENO;
      312     7282    2              IF VLR$LINES.RLINES#<0 THEN
      313     7283    2                 VLR$LINES.RLINES#=0;
      314     7284    2              RETURN;
      315     7285    2              END;
      316     7286    1   RETNNO: ;
      317     7287    1           VLR$LINES='0'B;
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:54   
      318     7288    1           VLR$LINES.RLINES#=-1;
      319     7289    1   RETN:   ;
      320     7290    1           RETURN;
      321     7291    1   END FSM$LINES;
      322     7292        %EOD;

PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:55   
--  Include file information  --

   F_FMTCODE_C.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   FM$FIT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FSM$LINES.

   Procedure FSM$LINES requires 100 words for executable code.
   Procedure FSM$LINES requires 8 words of local(AUTO) storage.

PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:56   

 Object Unit name= FSM$LINES                                  File name= FSM$DEVICE.:E05TOU
 UTS= JUL 29 '97 17:35:51.04 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   100    144  FSM$LINES
    2  RoData even  none     6      6  FSM$LINES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  FSM$LINES

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 HFF$NILERASE
 yes     yes           Std       4 KIA$UCIOD
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B$PS1$                                M$UC
     B_VECTNIL
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:57   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:58   


      241        1        /*T***********************************************************/
      242        2        /*T*                                                         */
      243        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      244        4        /*T*                                                         */
      245        5        /*T***********************************************************/
      246        6        /*F*    NAME: FSM$LINES
      247        7                PURPOSE: Process the M$LINES PMME.
      248        8                   This returns the current page number and number of lines
      249        9                   remaining on the page if appropriate for DCB assignment.
      250       10                DESCRIPTION:   If DCB has a FORM$ or is streamed to one,
      251       11                   page number is in FORM$ area and lines remaining can be
      252       12                   computed.  Do so.
      253       13         */
      254       14        FSM$LINES: PROC;

     14  1 000000   000000 700200 xent  FSM$LINES    TSX0  ! X66_AUTO_0
         1 000001   000010 000000                    ZERO    8,0

      255       15    1   DCL HFF$NILERASE ENTRY(1)ALTRET; /* ALTRET if vector is NIL/ERASE      */
      256       16        /*** * * * ***/
      257       17    1   DCL B$JIT$ PTR SYMREF; /* Note: B$JIT is BASED(B$JIT$).      */
      258       18    1   DCL B$PS1$ PTR SYMREF;
      259       19        /*** * * * ***/
      260       20        %INCLUDE CP_6_SUBS;
      261      560        %INCLUDE FM$FIT;
      262      781        %INCLUDE F$DCB;
      263      830        %INCLUDE F$JIT_C;
      264     1260        %INCLUDE CP_6;
      265     6819        %INCLUDE F_FPTCODE_C;
      266     6855        %INCLUDE KV_PRMID_E;
      267     7029        %INCLUDE F_FMTCODE_C;
      268     7063        %KV_PRMID_E;
      269     7219        %VLR_LINES(FPTN=VLR$LINES,STCLASS="BASED(B$PS1$)");
      270     7233        %CODE16;
      271     7241        /*** * * * ***/
      272     7242    1   DCL JDCB$ PTR;
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:59   
      273     7243    1   DCL FORM$ PTR;
      274     7244    1   DCL 1 FROMFEP  BASED (B$PS1$) ALIGNED,
      275     7245    1         2  *  BIT(19)  UNAL,
      276     7246    1         2  PGHI  UBIN(8)  UNAL,
      277     7247    1         2  *  BIT(1)  UNAL,
      278     7248    1         2  PGLO  UBIN(8)  UNAL;
      279     7249    1   DCL  KIA$UCIOD  ENTRY(4) ALTRET;
      280     7250        %EJECT;
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:60   
      281     7251    1           JDCB$= B$JIT.DCB$;

   7251  1 000002   000000 470400 xsym               LDP0    B$JIT$
         1 000003   000232 236100                    LDQ     154,,PR0
         1 000004   200003 756100                    STQ     JDCB$,,AUTO

      282     7252    1           CALL HFF$NILERASE(1) ALTRET(RETN);

   7252  1 000005   000000 630400 2                  EPPR0   0
         1 000006   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000007   000000 701000 xent               TSX1    HFF$NILERASE
         1 000010   000143 702000 1                  TSX2    RETN

      283     7253    1           IF NOT JDCB$->F$DCB.FCD THEN GOTO RETNNO;

   7253  1 000011   200003 470500                    LDP0    JDCB$,,AUTO
         1 000012   000031 236100                    LDQ     25,,PR0
         1 000013   020000 316007                    CANQ    8192,DL
         1 000014   000134 600000 1                  TZE     RETNNO

      284     7254    1           IF JDCB$->F$DCB.IASN=%STREAM# THEN

   7254  1 000015   000103 236100                    LDQ     67,,PR0
         1 000016   000777 376007                    ANQ     511,DL
         1 000017   000005 116007                    CMPQ    5,DL
         1 000020   000024 601000 1                  TNZ     s:7256

      285     7255    1              FORM$ = JDCB$ -> F$DCB.CFU$;

   7255  1 000021   000066 236100                    LDQ     54,,PR0
         1 000022   200004 756100                    STQ     FORM$,,AUTO
         1 000023   000026 710000 1                  TRA     s:7257

      286     7256    1           ELSE FORM$ = JDCB$;

   7256  1 000024   200003 236100                    LDQ     JDCB$,,AUTO
         1 000025   200004 756100                    STQ     FORM$,,AUTO
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:61   

      287     7257    1           IF FORM$ -> F$DCB.FORM$ = ADDR(NIL)

   7257  1 000026   200004 471500                    LDP1    FORM$,,AUTO
         1 000027   100050 236100                    LDQ     40,,PR1
         1 000030   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000031   000102 601000 1                  TNZ     s:7279

      288     7258    1           THEN
      289     7259    2           DO;

      290     7260    2              IF FORM$ -> F$DCB.MEDIA = FMTUC#

   7260  1 000032   100103 236100                    LDQ     67,,PR1
         1 000033   000777 376003                    ANQ     511,DU
         1 000034   000014 116003                    CMPQ    12,DU
         1 000035   000134 601000 1                  TNZ     RETNNO
         1 000036   000032 236100                    LDQ     26,,PR0
         1 000037   777000 376003                    ANQ     -512,DU
         1 000040   004000 116003                    CMPQ    2048,DU
         1 000041   000134 601000 1                  TNZ     RETNNO

      291     7261    2                AND  JDCB$ -> F$DCB.ORG = %UR#
      292     7262    2              THEN
      293     7263    3              DO;

      294     7264    3                 IF JDCB$->F$DCB.IASN = %STREAM#

   7264  1 000042   000103 236100                    LDQ     67,,PR0
         1 000043   000777 376007                    ANQ     511,DL
         1 000044   000005 116007                    CMPQ    5,DL
         1 000045   000051 601000 1                  TNZ     s:7267

      295     7265    3                 THEN
      296     7266    3                    B$JIT.DCB$ = JDCB$->F$DCB.CFU$;

   7266  1 000046   000066 236100                    LDQ     54,,PR0
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:62   
         1 000047   000000 473400 xsym               LDP3    B$JIT$
         1 000050   300232 756100                    STQ     154,,PR3

      297     7267    3                 B$JIT.DCB$ -> F$DCB.UB$ = B$PS1$;

   7267  1 000051   000000 473400 xsym               LDP3    B$JIT$
         1 000052   300232 474500                    LDP4    154,,PR3
         1 000053   000000 236000 xsym               LDQ     B$PS1$
         1 000054   400075 756100                    STQ     61,,PR4

      298     7268    3                 B$JIT.DCB$ -> F$DCB.UBYTES = SIZEC(VLR$LINES);

   7268  1 000055   300232 474500                    LDP4    154,,PR3
         1 000056   000010 235007                    LDA     8,DL
         1 000057   400076 755100                    STA     62,,PR4

      299     7269    3                 B$JIT.DCB$ -> F$DCB.WAIT = 1;

   7269  1 000060   300232 474500                    LDP4    154,,PR3
         1 000061   000020 236007                    LDQ     16,DL
         1 000062   400064 256100                    ORSQ    52,,PR4

      300     7270    3                 CALL KIA$UCIOD(MFC_RSTAT,0,BINASC(%KV_PRMID_LINES),0)

   7270  1 000063   000002 630400 2                  EPPR0   2
         1 000064   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000065   000000 701000 xent               TSX1    KIA$UCIOD
         1 000066   000134 702000 1                  TSX2    RETNNO

      301     7271    3                   ALTRET(RETNNO);
      302     7272    3                 VLR$LINES.PAGE# = FROMFEP.PGHI * 256 + FROMFEP.PGLO;

   7272  1 000067   000000 470400 xsym               LDP0    B$PS1$
         1 000070   000000 236100                    LDQ     0,,PR0
         1 000071   000377 376007                    ANQ     255,DL
         1 000072   200006 756100                    STQ     FORM$+2,,AUTO
         1 000073   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:63   
         1 000074   000001 772000                    QRL     1
         1 000075   177400 376007                    ANQ     65280,DL
         1 000076   200006 036100                    ADLQ    FORM$+2,,AUTO
         1 000077   000000 620006                    EAX0    0,QL
         1 000100   000000 440100                    SXL0    0,,PR0

      303     7273    3                 RETURN;

   7273  1 000101   000000 702200 xent               TSX2  ! X66_ARET

      304     7274    3                 END;
      305     7275    2              ELSE GOTO RETNNO;
      306     7276    2              END;
      307     7277    1           ELSE
      308     7278    2           DO;

      309     7279    2              FORM$ = FORM$ -> F$DCB.FORM$;

   7279  1 000102   200004 756100                    STQ     FORM$,,AUTO

      310     7280    2              VLR$LINES.PAGE#=FORM$->CODE16.PAGENO-FORM$->CODE16.PAGEBASE;

   7280  1 000103   200004 471500                    LDP1    FORM$,,AUTO
         1 000104   100006 236100                    LDQ     6,,PR1
         1 000105   000022 772000                    QRL     18
         1 000106   200006 756100                    STQ     FORM$+2,,AUTO
         1 000107   100005 236100                    LDQ     5,,PR1
         1 000110   000022 772000                    QRL     18
         1 000111   200006 136100                    SBLQ    FORM$+2,,AUTO
         1 000112   000000 620006                    EAX0    0,QL
         1 000113   000000 473400 xsym               LDP3    B$PS1$
         1 000114   300000 440100                    SXL0    0,,PR3

      311     7281    2              VLR$LINES.RLINES#=JDCB$->F$DCB.LINES-FORM$->CODE16.LINENO;

   7281  1 000115   100005 236100                    LDQ     5,,PR1
         1 000116   777777 376007                    ANQ     -1,DL
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:64   
         1 000117   200006 756100                    STQ     FORM$+2,,AUTO
         1 000120   000044 236100                    LDQ     36,,PR0
         1 000121   000022 772000                    QRL     18
         1 000122   200006 136100                    SBLQ    FORM$+2,,AUTO
         1 000123   000000 620006                    EAX0    0,QL
         1 000124   000000 473400 xsym               LDP3    B$PS1$
         1 000125   300000 740100                    STX0    0,,PR3

      312     7282    2              IF VLR$LINES.RLINES#<0 THEN

   7282  1 000126   000000 473400 xsym               LDP3    B$PS1$
         1 000127   300000 220100                    LDX0    0,,PR3
         1 000130   000133 605000 1                  TPL     s:7284

      313     7283    2                 VLR$LINES.RLINES#=0;

   7283  1 000131   000000 221003                    LDX1    0,DU
         1 000132   300000 741100                    STX1    0,,PR3

      314     7284    2              RETURN;

   7284  1 000133   000000 702200 xent               TSX2  ! X66_ARET

   7280  1 000134                       RETNNO       null
      315     7285    2              END;
      316     7286    1   RETNNO: ;
      317     7287    1           VLR$LINES='0'B;

   7287  1 000134   000000 235003                    LDA     0,DU
         1 000135   000000 236003                    LDQ     0,DU
         1 000136   000000 470400 xsym               LDP0    B$PS1$
         1 000137   000000 757100                    STAQ    0,,PR0

      318     7288    1           VLR$LINES.RLINES#=-1;

   7288  1 000140   777777 220003                    LDX0    -1,DU
         1 000141   000000 470400 xsym               LDP0    B$PS1$
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:65   
         1 000142   000000 740100                    STX0    0,,PR0

   7288  1 000143                       RETN         null
      319     7289    1   RETN:   ;
      320     7290    1           RETURN;

   7290  1 000143   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   2     000   000003 006000   023040 040040   000013 006000   000002 006000    .....   ........
   2     004   000001 006000   000002 006000                                    ........
      321     7291    1   END FSM$LINES;
      322     7292        %EOD;

PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:66   
--  Include file information  --

   F_FMTCODE_C.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   F_FPTCODE_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   F$JIT_C.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   FM$FIT.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
      No diagnostics issued in procedure FSM$LINES.
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:67   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 FORM$                      3-0-0/w PTR         r     1 JDCB$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS1$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/w STRC(1404)  r     1 CODE16
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC        r     1 FROMFEP
     0-0-0/d STRC(72)    r     1 VLR$LINES


   Procedure FSM$LINES requires 100 words for executable code.
   Procedure FSM$LINES requires 8 words of local(AUTO) storage.
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:68   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:69   
          MINI XREF LISTING

B$JIT.DCB$
      1247**DCL      7251>>ASSIGN   7266<<ASSIGN   7267>>ASSIGN   7268>>ASSIGN   7269>>ASSIGN
B$JIT.ERR.MID
      1158**DCL      1158--REDEF
B$JIT$
        17**DCL      1152--IMP-PTR  7251>>ASSIGN   7266>>ASSIGN   7267>>ASSIGN   7268>>ASSIGN   7269>>ASSIGN
B$PS1$
        18**DCL      7230--IMP-PTR  7244--IMP-PTR  7267>>ASSIGN   7272>>ASSIGN   7272>>ASSIGN   7272>>ASSIGN
      7280>>ASSIGN   7281>>ASSIGN   7282>>IF       7283>>ASSIGN   7287>>ASSIGN   7288>>ASSIGN
CODE16.LINENO
      7235**DCL      7281>>ASSIGN
CODE16.PAGEBASE
      7235**DCL      7280>>ASSIGN
CODE16.PAGENO
      7234**DCL      7280>>ASSIGN
F$DCB.ACTPOS
       807**DCL       807--REDEF
F$DCB.ARS
       782**DCL       782--REDEF
F$DCB.ATTR
       800**DCL       801--REDEF
F$DCB.BORROW
       815**DCL       815--REDEF     815--REDEF     815--REDEF
F$DCB.CFU$
       816**DCL      7255>>ASSIGN   7266>>ASSIGN
F$DCB.DCBNAME.L
       829**DCL       829--IMP-SIZ
F$DCB.EOMCHAR
       786**DCL       786--REDEF
F$DCB.FCD
       795**DCL      7253>>IF
F$DCB.FLDID
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:70   
       810**DCL       810--REDEF
F$DCB.FORM$
       804**DCL       804--REDEF    7257>>IF       7279>>ASSIGN
F$DCB.FSECT
       820**DCL       820--REDEF
F$DCB.FSN
       797**DCL       797--REDEF     797--REDEF     798--REDEF
F$DCB.HEADER$
       803**DCL       803--REDEF
F$DCB.IASN
       823**DCL      7254>>IF       7264>>IF
F$DCB.IXTNSIZE
       801**DCL       801--REDEF
F$DCB.LASTSTA$
       791**DCL       791--REDEF
F$DCB.LINES
       803**DCL      7281>>ASSIGN
F$DCB.LVL
       816**DCL       816--REDEF
F$DCB.MEDIA
       822**DCL      7260>>IF
F$DCB.NAME.C
       791**DCL       791--REDEF
F$DCB.NOEOF
       812**DCL       812--REDEF
F$DCB.NRECS
       802**DCL       802--REDEF
F$DCB.NRECX
       821**DCL       821--REDEF
F$DCB.OHDR
       813**DCL       813--REDEF
F$DCB.ORG
       796**DCL       796--REDEF    7260>>IF
F$DCB.PRECNO
       819**DCL       819--REDEF
F$DCB.RCSZ
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:71   
       824**DCL       824--REDEF
F$DCB.RES
       792**DCL       792--REDEF
F$DCB.SETX
       804**DCL       804--REDEF
F$DCB.TAB$
       803**DCL       804--REDEF
F$DCB.TDA
       818**DCL       818--REDEF
F$DCB.UB$
       820**DCL      7267<<ASSIGN
F$DCB.UBYTES
       820**DCL      7268<<ASSIGN
F$DCB.WAIT
       814**DCL      7269<<ASSIGN
F$DCB.WSN
       793**DCL       793--REDEF
FORM$
      7243**DCL      7255<<ASSIGN   7256<<ASSIGN   7257>>IF       7260>>IF       7279<<ASSIGN   7279>>ASSIGN
      7280>>ASSIGN   7280>>ASSIGN   7281>>ASSIGN
FROMFEP.PGHI
      7246**DCL      7272>>ASSIGN
FROMFEP.PGLO
      7248**DCL      7272>>ASSIGN
HFF$NILERASE
        15**DCL-ENT  7252--CALL
JDCB$
      7242**DCL      7251<<ASSIGN   7253>>IF       7254>>IF       7255>>ASSIGN   7256>>ASSIGN   7260>>IF
      7264>>IF       7266>>ASSIGN   7281>>ASSIGN
KIA$UCIOD
      7249**DCL-ENT  7270--CALL
RETN
      7288**LABEL    7252--CALLALT
RETNNO
      7280**LABEL    7253--GOTO     7270--CALLALT  7275--GOTO
VLR$LINES
PL6.E3A0      #002=FSM$LINES File=FSM$DEVICE.:E05TSI                             TUE 07/29/97 17:35 Page:72   
      7230**DCL      7268--ASSIGN   7287<<ASSIGN
VLR$LINES.PAGE#
      7230**DCL      7272<<ASSIGN   7280<<ASSIGN
VLR$LINES.RLINES#
      7230**DCL      7281<<ASSIGN   7282>>IF       7283<<ASSIGN   7288<<ASSIGN

PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:73   
      323        1        /*T***********************************************************/
      324        2        /*T*                                                         */
      325        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      326        4        /*T*                                                         */
      327        5        /*T***********************************************************/
      328        6        /*F*    NAME: FSM$HDRSET
      329        7                PURPOSE:  Set up a VLP_HDR block from the user to look good.
      330        8                DESCRIPTION:  The Title area is blank-filled.
      331        9                   If INDENT, title text is moved right.
      332       10        */
      333       11        FSM$HDRSET: PROC(F$DCB);
      334       12        %MACRO F$DCBI(F$DCB=F$DCB,BASED=BASED);
      335       13        %INCLUDE F$DCB;
      336       62        %MEND;
      337       63        %F$DCBI(BASED=);
      338      113        %F$DCBI(F$DCB=STREAM$DCB,BASED="BASED(F$DCB.CFU$)");
      339      163        /***   INCLUDES ETC.   ***/
      340      164        %INCLUDE CP_6_SUBS;
      341      704        %INCLUDE F_CP6;
      342     1729        %VLP_HDR(FPTN=VLPHDR,STCLASS="BASED(F$DCB.HEADER$)",
      343     1730                LEN="VLPHDR.TITL.L#");
      344     1746        %VLP_HDR(FPTN=VLPHDRF,STCLASS="BASED(F$DCB.HEADER$)",LEN=160);
      345     1762        %INCLUDE FM$MACROS;
      346     2137        %CODE16 (BASED="BASED(F$DCB.FORM$)");
      347     2145        /***   AUTOMATIC   ***/
      348     2146    1   DCL I SBIN;
      349     2147    1   DCL J SBIN;
      350     2148        /**/
      351     2149    1           IF F$DCB.HEADER$=ADDR(NIL) THEN RETURN;
      352     2150    2           IF VLPHDR.CTL.RESETPAGE# AND F$DCB.CFU$ ~= DCBADDR(%M$UC#) THEN DO;
      353     2151    2              VLPHDR.CTL.RESETPAGE#='0'B;
      354     2152    3              IF F$DCB.IASN=%STREAM# THEN DO;
      355     2153    3                 IF F$DCB.CFU$~=ADDR(NIL) THEN
      356     2154    3                    IF STREAM$DCB.FORM$~=ADDR(NIL) THEN
      357     2155    3                       STREAM$DCB.FORM$->CODE16.PAGEBASE=
      358     2156    3                         STREAM$DCB.FORM$->CODE16.PAGENO;
      359     2157    3                 END;
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:74   
      360     2158    2              ELSE
      361     2159    2                 IF F$DCB.FORM$~=ADDR(NIL) THEN
      362     2160    2                    CODE16.PAGEBASE=CODE16.PAGENO;
      363     2161    2              END;
      364     2162    1           IF VLPHDR.TITL.L#>160 THEN
      365     2163    1              VLPHDR.TITL.L#=160;
      366     2164    1           VLPHDRF.TITL.TITLE#=VLPHDR.TITL.TITLE#;
      367     2165    1           IF VLPHDR.CTL.COUNT#>160 THEN
      368     2166    1              VLPHDR.CTL.COUNT#=0;
      369     2167    2           IF VLPHDR.CTL.INDENT#>1 THEN DO;
      370     2168    2              I=VLPHDR.TITL.L#-1;
      371     2169    2              J=I+VLPHDR.CTL.INDENT#-1;
      372     2170    3              IF J>=160 THEN DO;
      373     2171    3                 I=I+(159-J);
      374     2172    3                 J=159;
      375     2173    3                 IF I<-1 THEN I=-1;
      376     2174    3                 END;
      377     2175    2              VLPHDR.TITL.L#=J+1;
      378     2176    3              DO WHILE(I>=0);
      379     2177    3                 CALL INSERT(VLPHDRF.TITL.TITLE#,J,1,
      380     2178    3                   SUBSTR(VLPHDRF.TITL.TITLE#,I,1));
      381     2179    3                 I=I-1;
      382     2180    3                 J=J-1;
      383     2181    3                 END;
      384     2182    2              CALL INSERT(VLPHDRF.TITL.TITLE#,0,J-I,' ');
      385     2183    2              END;
      386     2184    1           VLPHDR.CTL.INDENT#=1;
      387     2185    1           RETURN;
      388     2186    1   END FSM$HDRSET;

PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:75   
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FSM$HDRSET.

   Procedure FSM$HDRSET requires 115 words for executable code.
   Procedure FSM$HDRSET requires 6 words of local(AUTO) storage.

    No errors detected in file FSM$DEVICE.:E05TSI    .

PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:76   

 Object Unit name= FSM$HDRSET                                 File name= FSM$DEVICE.:E05TOU
 UTS= JUL 29 '97 17:36:04.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none   115    163  FSM$HDRSET
    1  RoData even  none     2      2  FSM$HDRSET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  FSM$HDRSET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B_VECTNIL
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:77   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:78   


      323        1        /*T***********************************************************/
      324        2        /*T*                                                         */
      325        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      326        4        /*T*                                                         */
      327        5        /*T***********************************************************/
      328        6        /*F*    NAME: FSM$HDRSET
      329        7                PURPOSE:  Set up a VLP_HDR block from the user to look good.
      330        8                DESCRIPTION:  The Title area is blank-filled.
      331        9                   If INDENT, title text is moved right.
      332       10        */
      333       11        FSM$HDRSET: PROC(F$DCB);

     11  0 000000   000000 700200 xent  FSM$HDRSET   TSX0  ! X66_AUTO_1
         0 000001   000006 000001                    ZERO    6,1

      334       12        %MACRO F$DCBI(F$DCB=F$DCB,BASED=BASED);
      335       13        %INCLUDE F$DCB;
      336       62        %MEND;
      337       63        %F$DCBI(BASED=);
      338      113        %F$DCBI(F$DCB=STREAM$DCB,BASED="BASED(F$DCB.CFU$)");
      339      163        /***   INCLUDES ETC.   ***/
      340      164        %INCLUDE CP_6_SUBS;
      341      704        %INCLUDE F_CP6;
      342     1729        %VLP_HDR(FPTN=VLPHDR,STCLASS="BASED(F$DCB.HEADER$)",
      343     1730                LEN="VLPHDR.TITL.L#");
      344     1746        %VLP_HDR(FPTN=VLPHDRF,STCLASS="BASED(F$DCB.HEADER$)",LEN=160);
      345     1762        %INCLUDE FM$MACROS;
      346     2137        %CODE16 (BASED="BASED(F$DCB.FORM$)");
      347     2145        /***   AUTOMATIC   ***/
      348     2146    1   DCL I SBIN;
      349     2147    1   DCL J SBIN;
      350     2148        /**/
      351     2149    1           IF F$DCB.HEADER$=ADDR(NIL) THEN RETURN;

   2149  0 000002   200003 470500                    LDP0    @F$DCB,,AUTO
         0 000003   000046 236100                    LDQ     38,,PR0
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:79   
         0 000004   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000005   000007 601000 0                  TNZ     s:2150

   2149  0 000006   000000 702200 xent               TSX2  ! X66_ARET

      352     2150    2           IF VLPHDR.CTL.RESETPAGE# AND F$DCB.CFU$ ~= DCBADDR(%M$UC#) THEN DO;

   2150  0 000007   000046 471500                    LDP1    38,,PR0
         0 000010   100000 430100                    FSZN    0,,PR1
         0 000011   000046 605000 0                  TPL     s:2162
         0 000012   000000 473400 1                  LDP3    0
         0 000013   300000 474500                    LDP4    0,,PR3
         0 000014   000066 236100                    LDQ     54,,PR0
         0 000015   400003 116100                    CMPQ    3,,PR4
         0 000016   000046 600000 0                  TZE     s:2162

      353     2151    2              VLPHDR.CTL.RESETPAGE#='0'B;

   2151  0 000017   000001 236000 1                  LDQ     1
         0 000020   100000 356100                    ANSQ    0,,PR1

      354     2152    3              IF F$DCB.IASN=%STREAM# THEN DO;

   2152  0 000021   000103 236100                    LDQ     67,,PR0
         0 000022   000777 376007                    ANQ     511,DL
         0 000023   000005 116007                    CMPQ    5,DL
         0 000024   000040 601000 0                  TNZ     s:2159

      355     2153    3                 IF F$DCB.CFU$~=ADDR(NIL) THEN

   2153  0 000025   000066 236100                    LDQ     54,,PR0
         0 000026   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000027   000046 600000 0                  TZE     s:2162

      356     2154    3                    IF STREAM$DCB.FORM$~=ADDR(NIL) THEN

   2154  0 000030   000066 471500                    LDP1    54,,PR0
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:80   
         0 000031   100050 236100                    LDQ     40,,PR1
         0 000032   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000033   000046 600000 0                  TZE     s:2162

      357     2155    3                       STREAM$DCB.FORM$->CODE16.PAGEBASE=

   2155  0 000034   100050 475500                    LDP5    40,,PR1
         0 000035   500005 220100                    LDX0    5,,PR5
         0 000036   500006 740100                    STX0    6,,PR5

      358     2156    3                         STREAM$DCB.FORM$->CODE16.PAGENO;
      359     2157    3                 END;

   2157  0 000037   000046 710000 0                  TRA     s:2162

      360     2158    2              ELSE
      361     2159    2                 IF F$DCB.FORM$~=ADDR(NIL) THEN

   2159  0 000040   000050 236100                    LDQ     40,,PR0
         0 000041   000001 116000 xsym               CMPQ    B_VECTNIL+1
         0 000042   000046 600000 0                  TZE     s:2162

      362     2160    2                    CODE16.PAGEBASE=CODE16.PAGENO;

   2160  0 000043   000050 471500                    LDP1    40,,PR0
         0 000044   100005 220100                    LDX0    5,,PR1
         0 000045   100006 740100                    STX0    6,,PR1

      363     2161    2              END;

      364     2162    1           IF VLPHDR.TITL.L#>160 THEN

   2162  0 000046   000046 471500                    LDP1    38,,PR0
         0 000047   100001 236100                    LDQ     1,,PR1
         0 000050   777000 376003                    ANQ     -512,DU
         0 000051   241000 116003                    CMPQ    82432,DU
         0 000052   000055 602000 0                  TNC     s:2164
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:81   

      365     2163    1              VLPHDR.TITL.L#=160;

   2163  0 000053   240000 236003                    LDQ     81920,DU
         0 000054   100001 552140                    STBQ    1,'40'O,PR1

      366     2164    1           VLPHDRF.TITL.TITLE#=VLPHDR.TITL.TITLE#;

   2164  0 000055   000046 471500                    LDP1    38,,PR0
         0 000056   100001 236100                    LDQ     1,,PR1
         0 000057   000033 772000                    QRL     27
         0 000060   000000 620006                    EAX0    0,QL
         0 000061   040100 100540                    MLR     fill='040'O
         0 000062   100001 200010                    ADSC9   1,,PR1                   cn=1,n=*X0
         0 000063   100001 200240                    ADSC9   1,,PR1                   cn=1,n=160

      367     2165    1           IF VLPHDR.CTL.COUNT#>160 THEN

   2165  0 000064   000046 471500                    LDP1    38,,PR0
         0 000065   100000 236100                    LDQ     0,,PR1
         0 000066   000777 376007                    ANQ     511,DL
         0 000067   000241 116007                    CMPQ    161,DL
         0 000070   000073 602000 0                  TNC     s:2167

      368     2166    1              VLPHDR.CTL.COUNT#=0;

   2166  0 000071   000000 236003                    LDQ     0,DU
         0 000072   100000 552104                    STBQ    0,'04'O,PR1

      369     2167    2           IF VLPHDR.CTL.INDENT#>1 THEN DO;

   2167  0 000073   000046 471500                    LDP1    38,,PR0
         0 000074   100000 236100                    LDQ     0,,PR1
         0 000075   777000 376007                    ANQ     -512,DL
         0 000076   002000 116007                    CMPQ    1024,DL
         0 000077   000157 602000 0                  TNC     s:2184

PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:82   
      370     2168    2              I=VLPHDR.TITL.L#-1;

   2168  0 000100   100001 236100                    LDQ     1,,PR1
         0 000101   000033 772000                    QRL     27
         0 000102   000001 136007                    SBLQ    1,DL
         0 000103   200004 756100                    STQ     I,,AUTO

      371     2169    2              J=I+VLPHDR.CTL.INDENT#-1;

   2169  0 000104   100000 236100                    LDQ     0,,PR1
         0 000105   000011 772000                    QRL     9
         0 000106   000777 376007                    ANQ     511,DL
         0 000107   200004 036100                    ADLQ    I,,AUTO
         0 000110   000001 136007                    SBLQ    1,DL
         0 000111   200005 756100                    STQ     J,,AUTO

      372     2170    3              IF J>=160 THEN DO;

   2170  0 000112   000240 116007                    CMPQ    160,DL
         0 000113   000126 604000 0                  TMI     s:2175

      373     2171    3                 I=I+(159-J);

   2171  0 000114   200004 236100                    LDQ     I,,AUTO
         0 000115   200005 136100                    SBLQ    J,,AUTO
         0 000116   000237 036007                    ADLQ    159,DL
         0 000117   200004 756100                    STQ     I,,AUTO

      374     2172    3                 J=159;

   2172  0 000120   000237 235007                    LDA     159,DL
         0 000121   200005 755100                    STA     J,,AUTO

      375     2173    3                 IF I<-1 THEN I=-1;

   2173  0 000122   000027 116000 xsym               CMPQ    B_VECTNIL+23
         0 000123   000126 605000 0                  TPL     s:2175
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:83   

   2173  0 000124   000001 335007                    LCA     1,DL
         0 000125   200004 755100                    STA     I,,AUTO

      376     2174    3                 END;

      377     2175    2              VLPHDR.TITL.L#=J+1;

   2175  0 000126   200005 236100                    LDQ     J,,AUTO
         0 000127   000001 036007                    ADLQ    1,DL
         0 000130   000033 736000                    QLS     27
         0 000131   100001 552140                    STBQ    1,'40'O,PR1

      378     2176    3              DO WHILE(I>=0);

   2176  0 000132   200004 235100                    LDA     I,,AUTO
         0 000133   000150 604000 0                  TMI     s:2182

      379     2177    3                 CALL INSERT(VLPHDRF.TITL.TITLE#,J,1,

   2177  0 000134   200003 470500                    LDP0    @F$DCB,,AUTO
         0 000135   000046 471500                    LDP1    38,,PR0
         0 000136   200004 235100                    LDA     I,,AUTO
         0 000137   200005 236100                    LDQ     J,,AUTO
         0 000140   040106 100505                    MLR     fill='040'O
         0 000141   100001 200001                    ADSC9   1,A,PR1                  cn=1,n=1
         0 000142   100001 200001                    ADSC9   1,Q,PR1                  cn=1,n=1

      380     2178    3                   SUBSTR(VLPHDRF.TITL.TITLE#,I,1));
      381     2179    3                 I=I-1;

   2179  0 000143   000001 336007                    LCQ     1,DL
         0 000144   200004 056100                    ASQ     I,,AUTO

      382     2180    3                 J=J-1;

   2180  0 000145   200005 056100                    ASQ     J,,AUTO
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:84   

      383     2181    3                 END;

   2181  0 000146   200004 235100                    LDA     I,,AUTO
         0 000147   000134 605000 0                  TPL     s:2177

      384     2182    2              CALL INSERT(VLPHDRF.TITL.TITLE#,0,J-I,' ');

   2182  0 000150   000046 471500                    LDP1    38,,PR0
         0 000151   200005 236100                    LDQ     J,,AUTO
         0 000152   200004 136100                    SBLQ    I,,AUTO
         0 000153   000000 620006                    EAX0    0,QL
         0 000154   040140 100400                    MLR     fill='040'O
         0 000155   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         0 000156   100001 200010                    ADSC9   1,,PR1                   cn=1,n=*X0

      385     2183    2              END;

      386     2184    1           VLPHDR.CTL.INDENT#=1;

   2184  0 000157   000046 471500                    LDP1    38,,PR0
         0 000160   001000 236007                    LDQ     512,DL
         0 000161   100000 552110                    STBQ    0,'10'O,PR1

      387     2185    1           RETURN;

   2185  0 000162   000000 702200 xent               TSX2  ! X66_ARET

(unnamed)
 Sect OctLoc
   1     000   000000 006003   776777 777777                                    ........
      388     2186    1   END FSM$HDRSET;

PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:85   
--  Include file information  --

   FM$MACROS.:E05TOU  is referenced.
   F_CP6.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   F$DCB.:E05TOU  is referenced.
      No diagnostics issued in procedure FSM$HDRSET.
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:86   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @F$DCB                    *0-0-0/d ASTR(3528)  r     1 F$DCB
     4-0-0/w SBIN        r     1 I                          5-0-0/w SBIN        r     1 J

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/d ASTR(3528)  r     1 STREAM$DCB
     0-0-0/w ASTR(45)    r     1 VLPHDR                     0-0-0/w STRC(1485)  r     1 VLPHDRF


   Procedure FSM$HDRSET requires 115 words for executable code.
   Procedure FSM$HDRSET requires 6 words of local(AUTO) storage.

    No errors detected in file FSM$DEVICE.:E05TSI    .
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:87   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:88   
          MINI XREF LISTING

CODE16.PAGEBASE
      2139**DCL      2155<<ASSIGN   2160<<ASSIGN
CODE16.PAGENO
      2138**DCL      2155>>ASSIGN   2160>>ASSIGN
F$DCB
        64**DCL        11--PROC
F$DCB.ACTPOS
        89**DCL        89--REDEF
F$DCB.ARS
        64**DCL        64--REDEF
F$DCB.ATTR
        82**DCL        83--REDEF
F$DCB.BORROW
        97**DCL        97--REDEF      97--REDEF      97--REDEF
F$DCB.CFU$
        98**DCL       114--IMP-PTR  2150>>IF       2153>>IF       2154>>IF       2155>>ASSIGN   2155>>ASSIGN
F$DCB.DCBNAME.L
       111**DCL       111--IMP-SIZ
F$DCB.EOMCHAR
        68**DCL        68--REDEF
F$DCB.FLDID
        92**DCL        92--REDEF
F$DCB.FORM$
        86**DCL        86--REDEF    2138--IMP-PTR  2159>>IF       2160>>ASSIGN   2160>>ASSIGN
F$DCB.FSECT
       102**DCL       102--REDEF
F$DCB.FSN
        79**DCL        79--REDEF      79--REDEF      80--REDEF
F$DCB.HEADER$
        85**DCL        85--REDEF    1741--IMP-PTR  1757--IMP-PTR  2149>>IF       2150>>IF       2151>>ASSIGN
      2162>>IF       2163>>ASSIGN   2164>>ASSIGN   2164>>ASSIGN   2164>>ASSIGN   2165>>IF       2166>>ASSIGN
      2167>>IF       2168>>ASSIGN   2169>>ASSIGN   2175>>ASSIGN   2177>>CALLBLT  2177>>CALLBLT  2182>>CALLBLT
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:89   
      2184>>ASSIGN
F$DCB.IASN
       105**DCL      2152>>IF
F$DCB.IXTNSIZE
        83**DCL        83--REDEF
F$DCB.LASTSTA$
        73**DCL        73--REDEF
F$DCB.LVL
        98**DCL        98--REDEF
F$DCB.NAME.C
        73**DCL        73--REDEF
F$DCB.NOEOF
        94**DCL        94--REDEF
F$DCB.NRECS
        84**DCL        84--REDEF
F$DCB.NRECX
       103**DCL       103--REDEF
F$DCB.OHDR
        95**DCL        95--REDEF
F$DCB.ORG
        78**DCL        78--REDEF
F$DCB.PRECNO
       101**DCL       101--REDEF
F$DCB.RCSZ
       106**DCL       106--REDEF
F$DCB.RES
        74**DCL        74--REDEF
F$DCB.SETX
        86**DCL        86--REDEF
F$DCB.TAB$
        85**DCL        86--REDEF
F$DCB.TDA
       100**DCL       100--REDEF
F$DCB.WSN
        75**DCL        75--REDEF
I
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:90   
      2146**DCL      2168<<ASSIGN   2169>>ASSIGN   2171<<ASSIGN   2171>>ASSIGN   2173>>IF       2173<<ASSIGN
      2176>>DOWHILE  2177>>CALLBLT  2179<<ASSIGN   2179>>ASSIGN   2182>>CALLBLT
J
      2147**DCL      2169<<ASSIGN   2170>>IF       2171>>ASSIGN   2172<<ASSIGN   2175>>ASSIGN   2177>>CALLBLT
      2180<<ASSIGN   2180>>ASSIGN   2182>>CALLBLT
STREAM$DCB.ACTPOS
       139**DCL       139--REDEF
STREAM$DCB.ARS
       114**DCL       114--REDEF
STREAM$DCB.ATTR
       132**DCL       133--REDEF
STREAM$DCB.BORROW
       147**DCL       147--REDEF     147--REDEF     147--REDEF
STREAM$DCB.DCBNAME.L
       161**DCL       161--IMP-SIZ
STREAM$DCB.EOMCHAR
       118**DCL       118--REDEF
STREAM$DCB.FLDID
       142**DCL       142--REDEF
STREAM$DCB.FORM$
       136**DCL       136--REDEF    2154>>IF       2155>>ASSIGN   2155>>ASSIGN
STREAM$DCB.FSECT
       152**DCL       152--REDEF
STREAM$DCB.FSN
       129**DCL       129--REDEF     129--REDEF     130--REDEF
STREAM$DCB.HEADER$
       135**DCL       135--REDEF
STREAM$DCB.IXTNSIZE
       133**DCL       133--REDEF
STREAM$DCB.LASTSTA$
       123**DCL       123--REDEF
STREAM$DCB.LVL
       148**DCL       148--REDEF
STREAM$DCB.NAME.C
       123**DCL       123--REDEF
STREAM$DCB.NOEOF
PL6.E3A0      #003=FSM$HDRSET File=FSM$DEVICE.:E05TSI                            TUE 07/29/97 17:36 Page:91   
       144**DCL       144--REDEF
STREAM$DCB.NRECS
       134**DCL       134--REDEF
STREAM$DCB.NRECX
       153**DCL       153--REDEF
STREAM$DCB.OHDR
       145**DCL       145--REDEF
STREAM$DCB.ORG
       128**DCL       128--REDEF
STREAM$DCB.PRECNO
       151**DCL       151--REDEF
STREAM$DCB.RCSZ
       156**DCL       156--REDEF
STREAM$DCB.RES
       124**DCL       124--REDEF
STREAM$DCB.SETX
       136**DCL       136--REDEF
STREAM$DCB.TAB$
       135**DCL       136--REDEF
STREAM$DCB.TDA
       150**DCL       150--REDEF
STREAM$DCB.WSN
       125**DCL       125--REDEF
VLPHDR.CTL.COUNT#
      1743**DCL      2165>>IF       2166<<ASSIGN
VLPHDR.CTL.INDENT#
      1742**DCL      2167>>IF       2169>>ASSIGN   2184<<ASSIGN
VLPHDR.CTL.RESETPAGE#
      1741**DCL      2150>>IF       2151<<ASSIGN
VLPHDR.TITL.L#
      1743**DCL      1744--IMP-SIZ  2162>>IF       2163<<ASSIGN   2164>>ASSIGN   2168>>ASSIGN   2175<<ASSIGN
VLPHDR.TITL.TITLE#
      1744**DCL      2164>>ASSIGN
VLPHDRF.TITL.TITLE#
      1760**DCL      2164<<ASSIGN   2177<<CALLBLT  2177>>CALLBLT  2182<<CALLBLT
