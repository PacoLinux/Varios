VERSION E05

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:1    
        1        1        /*M* ODF$FORMAT Output formatter for DOG ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         ODF$FORMAT
       10       10
       11       11             PURPOSE:      To provide output message formatting for the DOG ghost
       12       12
       13       13             DESCRIPTION:  This routine is called with OD_CXT$ pointing to
       14       14                           a keyin context frame.  Its purpose is to format
       15       15                           and write the display for the next item in
       16       16                           the buffer segment.  The parameter is a
       17       17                           code for the type of display to produce.
       18       18
       19       19                           If the display is to console, the formatted
       20       20                           buffer is written to KEYIN with a message
       21       21                           code whose template is simply /1,T/.
       22       22
       23       23                           If the display is to LP, the formatted buffer
       24       24                           is written to M$LO.
       25       25        */
       26       26        /**/
       27       27        ODF$FORMAT: PROC ( DISPLAY_TYPE );
       28       28        /**/
       29       29
       30       30
       31       31
       32       32        /**/
       33       33        /* PARAMETERS */
       34       34        /**/
       35       35    1   DCL DISPLAY_TYPE SBIN;
       36       36
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:2    
       37       37
       38       38
       39       39        /**/
       40       40        /* INCLUDES */
       41       41        /**/
       42       42        %INCLUDE CP_6;
       43      123        %INCLUDE CP_6_SUBS;
       44      663        %INCLUDE OC_MESSHD_C;
       45      716        %INCLUDE OC_SUBS_C;
       46     1447        %INCLUDE OD_SUBS_C;
       47     1508        %INCLUDE OD_MAC_C;
       48     1596        %INCLUDE FOO_MAC_C;
       49     2344        %INCLUDE OD_DATA_R;
       50     2570        %INCLUDE NK_SUBS;
       51     2595        %INCLUDE F_ERRORS_C;
       52     2835        %INCLUDE FO_ERRORS_C;
       53     2867        %INCLUDE KC_ERRORS_C;
       54     2914        %INCLUDE JG_GHOSTS_C;
       55     3004        %INCLUDE JM_SUBS_C;
       56     3110        %INCLUDE B_MICROPS_C;
       57     3282        %INCLUDE XSJ_SUBS_C;
       58     3309        %INCLUDE XSJ_MAC_C;
       59     3388 S      %INCLUDE B$JIT_C;
       60     3389
       61     3390
       62     3391
       63     3392        /**/
       64     3393        /* BASED STRUCTURES */
       65     3394        /**/
       66     3395        %B$JIT0;
       67     3484        %U$JIT1X;
       68     3487        %M$JIT2X;
       69     3490        %F$JIT3X;
       70     3493        %S$JIT4X;
       71     3496        %J$JIT5;
       72     3584        %A$JIT6X;
       73     3587        %B$ALT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:3    
       74     3595        %SET LISTMAC='1'B;
       75     3596        %VLR_JOBSTATS_OSRCH     (FPTN=R$OUTPUT,STCLASS=BASED,NFIL=0);
              3597        %LSET LISTDIR='0'B;
              3607    1   DCL 1 R$OUTPUT BASED DALIGNED,2 FOUND UBIN WORD UNAL /*(0)/**/,2 * UBIN WORD UNAL /*
              3607            (0)/**/,2 F
              3608    1   (0:0)CHAR(112);
       76     3610        %VLA_JOBSTATS_OSRCH     (FPTN=A$OUTPUT,STCLASS=BASED);
              3611        %LSET LISTDIR='0'B;
              3621    1   DCL 1 A$OUTPUT BASED ALIGNED,2 TNAME CHAR(8),2 DEVTYP CHAR(2),2 COPIES UBIN BYTE
              3621            UNAL,2 * UBIN BYTE UNAL,2 SAPCOPIES UBIN BYTE UNAL,2
              3622    1   PRIO UBIN BYTE UNAL,2 ATTR BIT(18),2 FLG,3 GLC BIT(1),3 SAP BIT(1),3 SPILL BIT(1),3
              3622            DEVAVAIL BIT(1),3 * BIT(1),2 MODE UBIN(4)UNAL,2
              3623    1   BOOTID CHAR(3),2 SYSID UBIN HALF UNAL,2 NUM UBIN HALF UNAL,2 HICNUM UBIN HALF UNAL,2
              3623            GRANS UBIN HALF UNAL,2 FORM CHAR(6),2 DEVNAME
              3624    1   CHAR(2),2 ACCT CHAR(8),2 JNAME CHAR(31),2 * UBIN BYTE CALIGNED,2 AHEAD UBIN HALF
              3624            UNAL,2 * UBIN HALF UNAL,2 CREATED UBIN WORD,2 WOD
              3625    1   CHAR(8)/*(' ')/**/,2 *(0:4)UBIN WORD;
       77     3627        %VLR_JOBSTATS_ISRCH     (FPTN=R$INPUT ,STCLASS=BASED,NJOB=0);
              3628        %LSET LISTDIR='0'B;
              3638    1   DCL 1 R$INPUT BASED DALIGNED,2 FOUND UBIN WORD UNAL /*(0)/**/,2 * UBIN WORD UNAL /*(
              3638            0)/**/,2 J
              3639    1   (0:0)CHAR(256);
       78     3641        %VLA_JOBSTATS_ISRCH     (FPTN=A$INPUT ,STCLASS=BASED);
              3642        %LSET LISTDIR='0'B;
              3652    1   DCL 1 A$INPUT BASED ALIGNED,2 NSN UBIN HALF UNAL /*(0)/**/,2 SNX UBIN HALF UNAL /*(0
              3652            )/**/,2 NRES UBIN
              3653    1   HALF UNAL /*(0)/**/,2 RESX UBIN HALF UNAL /*(0)/**/,2 U UBIN HALF UNAL /*(0)/**/,2 *
              3654    1   BIT(2)/*('0'B)/**/,2 PART BIT(16)/*('0'B)/**/,2 PNUM UBIN BYTE UNAL /*(0)/**/,2 PI
              3655    1   UBIN BYTE UNAL /*(0)/**/,2 IPRIO UBIN BYTE UNAL /*(0)/**/,2 PRIO UBIN BYTE UNAL /*(0
              3655            )
              3656    1   /**/,2 SUBMIT_TIME UBIN WORD UNAL /*(0)/**/,2 START_TIME UBIN WORD UNAL /*(0)/**/,2
              3656            FLG,3 O1 BIT
              3657    1   (1)/*('0'B)/**/,3 * BIT(1)/*('0'B)/**/,3 O3 BIT(1)/*('0'B)/**/,3 ACC BIT(1)/*
              3658    1   ('0'B)/**/,3 RR BIT(1)/*('0'B)/**/,3 RR2 BIT(1)/*('0'B)/**/,3 NPI BIT(1)/*('0'B
              3659    1   )/**/,3 RA BIT(1)/*('0'B)/**/,3 * BIT(1)/*('0'B)/**/,2 NFOLL UBIN BYTE UNAL /*(0
              3660    1   )/**/,2 SYSID UBIN HALF UNAL /*(0)/**/,2 AHEAD UBIN WORD UNAL /*(0)/**/,2 ACCT CHAR(
              3660            8
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:4    
              3661    1   )/*(' ')/**/,2 UNAME CHAR(12)/*(' ')/**/,2 WOO CHAR(8)/*(' ')/**/,2 WSN CHAR(8)/*
              3662    1   (' ')/**/,2 JNAME CHAR(31)/*(' ')/**/,2 * UBIN BYTE CALIGNED /*(0)/**/,2 RATIM UBIN
              3663    1   WORD UNAL /*(0)/**/,2 RRT(0:11)UBIN HALF UNAL /*(0*0)/**/,2 TIM UBIN WORD UNAL /*(0)
              3664    1   /**/,2 JDID(0:7),3 RELATION UBIN(3)UNAL /*(0*0)/**/,3 FOLLOW_TYPE UBIN(3)UNAL /*(0*0
              3664            )/**/,3 *
              3665    1   UBIN(11)UNAL /*(0*0)/**/,3 SATISFIED BIT(1)/*('0'B*0)/**/,3 SYSID UBIN(18)UNAL /*(0*
              3665            0)
              3666    1   /**/,2 JDSTEPCC(0:7)UBIN(9)UNAL /*(0*0)/**/,2 *(0:20)UBIN WORD UNAL /*(0*0)/**/;
       79     3668        %SET LISTMAC='0'B;
       80     3669        %VLR_JOBSTATS_ISRCH_SN  (FPTN=A$SN    ,STCLASS=BASED,NSN =0);
       81     3682        %VLR_JOBSTATS_ISRCH_RES (FPTN=A$RES   ,STCLASS=BASED,NRES=0);
       82     3695        %XSJ_JOBINFO (FPTN=XSJ$JOBINFO,STCLASS=BASED);
       83     3710    1   DCL B$CHARS CHAR(K) BASED DALIGNED;
       84     3711        %OD_CXT       (FPTN=OD$CXT,STCLASS=BASED);
       85     3779        %VLP_HDR                               (FPTN=VLP$HDR,
       86     3780                 LEN       = 132,
       87     3781                 STCLASS   = BASED);
       88     3797
       89     3798
       90     3799
       91     3800        /**/
       92     3801        /* MACROS */
       93     3802        /**/
       94     3803        %MACRO ADDSTR (S="");
       95     3804        %LSET LISTSUB='1'B;
       96     3805              CALL INSERT (OBUF,LEN,LENGTHC(S),S);
       97     3806              LEN=LEN+LENGTHC(S);
       98     3807        %MEND;
       99     3808            %MACRO ADDTXT (T="");
      100     3809            %LSET LISTSUB='1'B;
      101     3810              TXSTR=T;
      102     3811              CALL INS_TXT;
      103     3812        %MEND;
      104     3813            %MACRO ADDNUM (N="");
      105     3814            %LSET LISTSUB='1'B;
      106     3815              CALL BINCHAR(TXNUM,N);
      107     3816              CALL INS_NUM;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:5    
      108     3817        %MEND;
      109     3818            %MACRO ADDNUM2 (N="");
      110     3819            %LSET LISTSUB='1'B;
      111     3820              CALL BINCHAR (TXNUM,N);
      112     3821              CALL INS_NUM2;
      113     3822        %MEND;
      114     3823            %MACRO MVTXT (S="",D="");
      115     3824            %LSET LISTSUB='1'B;
      116     3825              D=' ';
      117     3826              CALL INDEX (BLNKINDEX,' ',S);
      118     3827              CALL INSERT (D,LENGTHC(D)-BLNKINDEX,BLNKINDEX,S);
      119     3828        %MEND;
      120     3829            %MACRO MVNUM (S="",D="");
      121     3830            %LSET LISTSUB='1'B;
      122     3831              CALL BINCHAR (D,S);
      123     3832              CALL EDITCHAR (D,,,EDITCTLS(LENGTHC(D)),D);
      124     3833        %MEND;
      125     3834            %MACRO MVNUMZF (S="",D="");
      126     3835            %LSET LISTSUB='1'B;
      127     3836              CALL BINCHAR (D,S);
      128     3837        %MEND;
      129     3838            %MACRO HEADER (T="",N="");
      130     3839            %LSET LISTSUB='1'B;
      131     3840              CALL INSERT (LOBUF,1,N,' ');
      132     3841              CALL INSERT (LOBUF,N+1,LENGTHC(T),T);
      133     3842              TLEN=LENGTHC(T)+N+1;
      134     3843              LPTAB=TLEN;
      135     3844        %MEND;
      136     3845            %MACRO BUFRESET;
      137     3846              TLEN=1;
      138     3847              LEN=0;
      139     3848              LPTAB=1;
      140     3849        %MEND;
      141     3850
      142     3851
      143     3852
      144     3853        /**/
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:6    
      145     3854        /* AUTO */
      146     3855        /**/
      147     3856    1   DCL J SBIN WORD;
      148     3857    1   DCL POSN SBIN WORD;/* SBIN to generate Much less code */
      149     3858    1   DCL I SBIN WORD;
      150     3859    1   DCL BUF$ PTR;
      151     3860    1   DCL SN$ PTR;
      152     3861    1   DCL RES$ PTR;
      153     3862    1   DCL TLEN SBIN WORD;
      154     3863    1   DCL LEN SBIN WORD;
      155     3864    1   DCL LIMITS_HIT SBIN WORD;
      156     3865    1   DCL NFOLL SBIN WORD;
      157     3866    1   DCL BLNKINDEX SBIN WORD;
      158     3867    1   DCL K SBIN WORD;
      159     3868    1   DCL NX SBIN WORD;
      160     3869    1   DCL SNX SBIN WORD;
      161     3870    1   DCL RESX SBIN WORD;
      162     3871    1   DCL PSNAME CHAR(8);
      163     3872    1   DCL ATTR BIT(18);
      164     3873    1   DCL NPS SBIN WORD;
      165     3874    1   DCL NRES SBIN WORD;
      166     3875    1   DCL NSN SBIN WORD;
      167     3876    1   DCL LPWRITES SBIN WORD;
      168     3877
      169     3878
      170     3879
      171     3880        /**/
      172     3881        /* STATIC */
      173     3882        /**/
      174     3883        %VLR_DISPLAY (FPTN=VLR_DISPLAY,STCLASS=STATIC);
      175     3897        %VLP_HDR                               (FPTN=STHDR,
      176     3898                 LEN       = 132,
      177     3899                 TITLE     = ' ',
      178     3900                 HEADERHEIGHT = 2,
      179     3901                 STCLASS   = STATIC);
      180     3917    1   DCL 1 HDRVLP STATIC DALIGNED,
      181     3918    1         2 * CHAR(256) UNAL;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:7    
      182     3919    1   DCL PARTM BIT(16) STATIC ALIGNED;
      183     3920    1   DCL 1 PARTMR REDEF PARTM ALIGNED,
      184     3921    1         2 P (0:15) BIT(1) UNAL;
      185     3922    1   DCL LPTAB SBIN WORD STATIC ALIGNED INIT(1);
      186     3923        %B$XCON (NAME=XCON,STCLASS=STATIC);
      187     3933    1   DCL WSNHDR CHAR(9) CONSTANT ALIGNED  INIT('TO-->   :');
      188     3934    1   DCL DEFRHDR CHAR(9) CONSTANT ALIGNED INIT('DEFERRED:');
      189     3935    1   DCL FOLLHDR CHAR(9) CONSTANT ALIGNED INIT('FOLLOWS :');
      190     3936    1   DCL PSETHDR CHAR(9) CONSTANT ALIGNED INIT('PACKSETS:');
      191     3937    1   DCL PSEUHDR CHAR(9) CONSTANT ALIGNED INIT('PSEUDOS :');
      192     3938    1   DCL OTHRHDR CHAR(9) CONSTANT ALIGNED INIT('OTHER   :');
      193     3939    1   DCL 1 ST_DEFER STATIC ALIGNED,
      194     3940    1         2 * CHAR(6) UNAL INIT('W:DEFR');
      195     3941    1   DCL 1 ST_WAIT STATIC ALIGNED,
      196     3942    1         2 POS CHAR(4) UNAL,
      197     3943    1         2 NUMEXT CHAR(2) UNAL;
      198     3944    1   DCL 1 ST_RUN STATIC ALIGNED,
      199     3945    1         2 * CHAR(6) UNAL INIT(' *RUN*');
      200     3946    1   DCL 1 ST_FOLL STATIC ALIGNED,
      201     3947    1         2 * CHAR(6) UNAL INIT('W:FOLW');
      202     3948    1   DCL 1 ST_WPS CONSTANT ALIGNED,
      203     3949    1         2 * CHAR(6) UNAL INIT('W:PACK');
      204     3950    1   DCL 1 ST_WPART CONSTANT ALIGNED,
      205     3951    1         2 * CHAR(6) UNAL INIT('W:PART');
      206     3952    1   DCL 1 OUTTIME STATIC DALIGNED,
      207     3953    1         2 HHMM CHAR(5) UNAL,
      208     3954    1         2 C CHAR(1) UNAL,
      209     3955    1         2 SSSS CHAR(5) UNAL;
      210     3956    1   DCL INUTS UBIN WORD STATIC DALIGNED;
      211     3957    1   DCL OUTDATE CHAR(8) STATIC DALIGNED;
      212     3958        /**/
      213     3959    1   DCL 1 OF_TITLE CONSTANT CALIGNED,
      214     3960    1         2 SYSID     CHAR(06) UNAL INIT(' SYSID'),
      215     3961    1         2 *         CHAR(01) UNAL INIT(' '),
      216     3962    1         2 NUM       CHAR(06) UNAL INIT('   NUM'),
      217     3963    1         2 *         CHAR(03) UNAL INIT(' MO'),
      218     3964    1         2 MODE      CHAR(02) UNAL INIT('DE'),
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:8    
      219     3965    1         2 *         CHAR(01) UNAL INIT(' '),
      220     3966    1         2 ACCT      CHAR(08) UNAL INIT(' ACCOUNT'),
      221     3967    1         2 *         CHAR(01) UNAL INIT(' '),
      222     3968    1         2 DEVTYP    CHAR(02) UNAL INIT('DE'),
      223     3969    1         2 *         CHAR(01) UNAL INIT('S'),
      224     3970    1         2 WOD       CHAR(08) UNAL INIT('TINATION'),
      225     3971    1         2 *         CHAR(01) UNAL INIT(' '),
      226     3972    1         2 GRANS     CHAR(05) UNAL INIT('GRANS'),
      227     3973    1         2 *         CHAR(01) UNAL INIT(' '),
      228     3974    1         2 COPIES    CHAR(06) UNAL INIT('COPIES'),
      229     3975    1         2 *         CHAR(01) UNAL INIT(' '),
      230     3976    1         2 PRIO      CHAR(04) UNAL INIT('PRIO'),
      231     3977    1         2 *         CHAR(01) UNAL INIT(' '),
      232     3978    1         2 SAP       CHAR(03) UNAL INIT('SAP'),
      233     3979    1         2 *         CHAR(01) UNAL INIT(' '),
      234     3980    1         2 COMF      CHAR(03) UNAL INIT('COM'),
      235     3981    1         2 *         CHAR(01) UNAL INIT(' '),
      236     3982    1         2 FORM      CHAR(06) UNAL INIT('*FORM*'),
      237     3983    1         2 *         CHAR(01) UNAL INIT(' '),
      238     3984    1         2 ATTRS     CHAR(04) UNAL INIT('ATTR'),
      239     3985    1         2 ATTRSR REDEF ATTRS UNAL,
      240     3986    1           3 APL       CHAR(01) UNAL,
      241     3987    1           3 OVR       CHAR(01) UNAL,
      242     3988    1           3 BIN       CHAR(01) UNAL,
      243     3989    1           3 LC        CHAR(01) UNAL,
      244     3990    1         2 *         CHAR(01) UNAL INIT(' '),
      245     3991    1         2 CREATIME  CHAR(05) UNAL INIT('*CREA'),
      246     3992    1         2 *         CHAR(01) UNAL INIT('T'),
      247     3993    1         2 CREADATE  CHAR(06) UNAL INIT('ED AT*'),
      248     3994    1         2 *         CHAR(01) UNAL INIT(' '),
      249     3995    1         2 NODEV     CHAR(07) UNAL INIT('*NODEV*'),
      250     3996    1         2 *         CHAR(01) UNAL INIT(' '),
      251     3997    1         2 JOBNAME   CHAR(31) UNAL INIT('*JOBNAME*');
      252     3998    1   DCL OF_TITLER REDEF OF_TITLE CHAR(130) CALIGNED;
      253     3999        /**/
      254     4000    1   DCL 1 OF_LINE STATIC CALIGNED,
      255     4001    1         2 *         CHAR(01) UNAL INIT('A'),
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:9    
      256     4002    1         2 SYSID     CHAR(06) UNAL,
      257     4003    1         2 *         CHAR(01) UNAL INIT(' '),
      258     4004    1         2 NUM       CHAR(06) UNAL,
      259     4005    1         2 *         CHAR(03) UNAL INIT(' '),
      260     4006    1         2 MODE      CHAR(02) UNAL,
      261     4007    1         2 *         CHAR(01) UNAL INIT(' '),
      262     4008    1         2 ACCT      CHAR(08) UNAL,
      263     4009    1         2 *         CHAR(01) UNAL INIT(' '),
      264     4010    1         2 DEVTYP    CHAR(02) UNAL,
      265     4011    1         2 *         CHAR(01) UNAL INIT('@'),
      266     4012    1         2 WOD       CHAR(08) UNAL,
      267     4013    1         2 *         CHAR(01) UNAL INIT(' '),
      268     4014    1         2 GRANS     CHAR(05) UNAL,
      269     4015    1         2 *         CHAR(01) UNAL INIT(' '),
      270     4016    1         2 COPIES    CHAR(06) UNAL,
      271     4017    1         2 *         CHAR(01) UNAL INIT(' '),
      272     4018    1         2 PRIO      CHAR(04) UNAL,
      273     4019    1         2 *         CHAR(01) UNAL INIT(' '),
      274     4020    1         2 SAP       CHAR(03) UNAL,
      275     4021    1         2 *         CHAR(01) UNAL INIT(' '),
      276     4022    1         2 COMF      CHAR(03) UNAL,
      277     4023    1         2 *         CHAR(01) UNAL INIT(' '),
      278     4024    1         2 FORM      CHAR(06) UNAL,
      279     4025    1         2 *         CHAR(01) UNAL INIT(' '),
      280     4026    1         2 ATTRS     CHAR(04) UNAL,
      281     4027    1         2 ATTRSR REDEF ATTRS UNAL,
      282     4028    1           3 APL       CHAR(01) UNAL,
      283     4029    1           3 OVR       CHAR(01) UNAL,
      284     4030    1           3 BIN       CHAR(01) UNAL,
      285     4031    1           3 LC        CHAR(01) UNAL,
      286     4032    1         2 *         CHAR(01) UNAL INIT(' '),
      287     4033    1         2 CREATIME  CHAR(05) UNAL,
      288     4034    1         2 *         CHAR(01) UNAL INIT(' '),
      289     4035    1         2 CREADATE  UNAL,
      290     4036    1           3 M         CHAR(02) UNAL,
      291     4037    1           3 D         CHAR(02) UNAL,
      292     4038    1           3 Y         CHAR(02) UNAL,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:10   
      293     4039    1         2 *         CHAR(01) UNAL INIT(' '),
      294     4040    1         2 NODEV     CHAR(07) UNAL,
      295     4041    1         2 *         CHAR(01) UNAL INIT(' '),
      296     4042    1         2 JOBNAME   CHAR(31) UNAL;
      297     4043        /**/
      298     4044    1   DCL 1 IF_TITLE CONSTANT CALIGNED,
      299     4045    1         2 SYSID     CHAR(06) UNAL INIT(' SYSID'),
      300     4046    1         2 *         CHAR(01) UNAL INIT(' '),
      301     4047    1         2 ACCT      CHAR(08) UNAL INIT(' ACCOUNT'),
      302     4048    1         2 *         CHAR(01) UNAL INIT(' '),
      303     4049    1         2 UNAME     CHAR(12) UNAL INIT('**USERNAME**'),
      304     4050    1         2 *         CHAR(01) UNAL INIT(' '),
      305     4051    1         2 SUBTIME   CHAR(05) UNAL INIT('*SUBM'),
      306     4052    1         2 *         CHAR(01) UNAL INIT('I'),
      307     4053    1         2 SUBDATE   CHAR(06) UNAL INIT('TD AT*'),
      308     4054    1         2 *         CHAR(01) UNAL INIT(' '),
      309     4055    1         2 CFLG      CHAR(05) UNAL INIT('FLAGS'),
      310     4056    1         2 FLG REDEF CFLG UNAL,
      311     4057    1           3 O CHAR(1) UNAL,
      312     4058    1           3 A CHAR(1) UNAL,
      313     4059    1           3 N CHAR(1) UNAL,
      314     4060    1           3 F CHAR(1) UNAL,
      315     4061    1           3 D CHAR(1) UNAL,
      316     4062    1         2 *         CHAR(01) UNAL INIT(' '),
      317     4063    1         2 WOO       CHAR(08) UNAL INIT('**FROM**'),
      318     4064    1         2 *         CHAR(01) UNAL INIT(' '),
      319     4065    1         2 MEM       CHAR(03) UNAL INIT('MEM'),
      320     4066    1         2 *         CHAR(01) UNAL INIT(' '),
      321     4067    1         2 CTIM      CHAR(10) UNAL INIT('  MAXTIME '),
      322     4068    1         2 TIM REDEF CTIM UNAL,
      323     4069    1           3 H CHAR(4) UNAL,
      324     4070    1           3 * CHAR(1) UNAL,
      325     4071    1           3 M CHAR(2) UNAL,
      326     4072    1           3 * CHAR(1) UNAL,
      327     4073    1           3 S CHAR(2) UNAL,
      328     4074    1         2 *         CHAR(01) UNAL INIT(' '),
      329     4075    1         2 CPART     CHAR(16) UNAL INIT('1**PARTITIONS**1'),
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:11   
      330     4076    1         2 PARTS (0:15) REDEF CPART CHAR(1) UNAL,
      331     4077    1         2 RUNNING_PART REDEF CPART UNAL,
      332     4078    1           3 * CHAR(1) UNAL,
      333     4079    1           3 PART CHAR(2) UNAL,
      334     4080    1           3 * CHAR(1) UNAL,
      335     4081    1           3 START_TIME UNAL,
      336     4082    1             4 HHMM CHAR(5) UNAL,
      337     4083    1             4 * CHAR(1) UNAL,
      338     4084    1             4 DATE UNAL,
      339     4085    1               5 M CHAR(2) UNAL,
      340     4086    1               5 D CHAR(2) UNAL,
      341     4087    1               5 Y CHAR(2) UNAL,
      342     4088    1         2 *         CHAR(02) UNAL INIT('6 '),
      343     4089    1         2 PRIO      CHAR(02) UNAL INIT('PR'),
      344     4090    1         2 *         CHAR(01) UNAL INIT(' '),
      345     4091    1         2 CSTATUS UNAL,
      346     4092    1           3 * CHAR(6) UNAL INIT('STATUS'),
      347     4093    1         2 *         CHAR(01) UNAL INIT(' '),
      348     4094    1         2 JNAME     CHAR(31) UNAL INIT('*JOBNAME*'),
      349     4095    1         2 *         CHAR(01) UNAL INIT(' ');
      350     4096    1   DCL IF_TITLER REDEF IF_TITLE CHAR(132) CALIGNED;
      351     4097        /**/
      352     4098    1   DCL 1 IF_LINE STATIC CALIGNED,
      353     4099    1         2 *         CHAR(01) UNAL INIT('A'),
      354     4100    1         2 SYSID     CHAR(06) UNAL,
      355     4101    1         2 *         CHAR(01) UNAL INIT(' '),
      356     4102    1         2 ACCT      CHAR(08) UNAL,
      357     4103    1         2 *         CHAR(01) UNAL INIT(' '),
      358     4104    1         2 UNAME     CHAR(12) UNAL,
      359     4105    1         2 *         CHAR(01) UNAL INIT(' '),
      360     4106    1         2 SUBTIME   CHAR(05) UNAL,
      361     4107    1         2 *         CHAR(01) UNAL INIT(' '),
      362     4108    1         2 SUBDATE   UNAL,
      363     4109    1           3 M CHAR(2) UNAL,
      364     4110    1           3 D CHAR(2) UNAL,
      365     4111    1           3 Y CHAR(2) UNAL,
      366     4112    1         2 *         CHAR(01) UNAL INIT(' '),
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:12   
      367     4113    1         2 CFLG      CHAR(05) UNAL,
      368     4114    1         2 FLG REDEF CFLG UNAL,
      369     4115    1           3 O CHAR(1) UNAL,
      370     4116    1           3 A CHAR(1) UNAL,
      371     4117    1           3 N CHAR(1) UNAL,
      372     4118    1           3 F CHAR(1) UNAL,
      373     4119    1           3 D CHAR(1) UNAL,
      374     4120    1         2 *         CHAR(01) UNAL INIT(' '),
      375     4121    1         2 WOO       CHAR(08) UNAL,
      376     4122    1         2 *         CHAR(01) UNAL INIT(' '),
      377     4123    1         2 MEM       CHAR(03) UNAL,
      378     4124    1         2 *         CHAR(01) UNAL INIT(' '),
      379     4125    1         2 CTIM      CHAR(10) UNAL,
      380     4126    1         2 TIM REDEF CTIM UNAL,
      381     4127    1           3 H CHAR(4) UNAL,
      382     4128    1           3 * CHAR(1) UNAL,
      383     4129    1           3 M CHAR(2) UNAL,
      384     4130    1           3 * CHAR(1) UNAL,
      385     4131    1           3 S CHAR(2) UNAL,
      386     4132    1         2 *         CHAR(01) UNAL INIT(' '),
      387     4133    1         2 CPART     CHAR(16) UNAL,
      388     4134    1         2 PARTS (0:15) REDEF CPART CHAR(1) UNAL,
      389     4135    1         2 RUNNING_PART REDEF CPART UNAL,
      390     4136    1           3 * CHAR(1) UNAL,
      391     4137    1           3 PART CHAR(2) UNAL,
      392     4138    1           3 * CHAR(1) UNAL,
      393     4139    1           3 START_TIME UNAL,
      394     4140    1             4 HHMM CHAR(5) UNAL,
      395     4141    1             4 * CHAR(1) UNAL,
      396     4142    1             4 DATE UNAL,
      397     4143    1               5 M CHAR(2) UNAL,
      398     4144    1               5 D CHAR(2) UNAL,
      399     4145    1               5 Y CHAR(2) UNAL,
      400     4146    1         2 *         CHAR(02) UNAL INIT(' '),
      401     4147    1         2 PRIO      CHAR(02) UNAL,
      402     4148    1         2 *         CHAR(01) UNAL INIT(' '),
      403     4149    1         2 CSTATUS UNAL,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:13   
      404     4150    1           3 * CHAR(6) UNAL INIT(' '),
      405     4151    1         2 *         CHAR(01) UNAL INIT(' '),
      406     4152    1         2 JNAME     CHAR(31) UNAL;
      407     4153    1   DCL LOBUF CHAR(ODMI_LPMX#) STATIC DALIGNED INIT('A');
      408     4154    1   DCL NUMEXTS (0:9) CHAR(2) STATIC ALIGNED INIT('th','st','nd','rd','th'*0);
      409     4155    1   DCL TEEN_NUMEXTS (0:9) CHAR(2) STATIC ALIGNED INIT('th'*0);
      410     4156    1   DCL 1 EDITCTL CONSTANT ALIGNED,
      411     4157    1         2 * BIT(9) UNAL INIT(%MVZB7),
      412     4158    1         2 * BIT(9) UNAL INIT(%MVC1);
      413     4159    1   DCL 1 EDITCTL2 CONSTANT ALIGNED,
      414     4160    1         2 * BIT(9) UNAL INIT(%MVZB6),
      415     4161    1         2 * BIT(9) UNAL INIT(%MVC2);
      416     4162    1   DCL 1 EDITCTLS (0:8) CONSTANT ALIGNED,
      417     4163    1         2 * BIT(9) UNAL INIT('0'B,%MVC1,%MVZB1,%MVZB2,%MVZB3,%MVZB4,
      418     4164    1           %MVZB5,%MVZB6,%MVZB7),
      419     4165    1         2 * BIT(9) UNAL INIT(%MVC1*0);
      420     4166    1   DCL TXRELATIONS (0:5) CHAR(2) STATIC ALIGNED INIT('<','<=','=','~=','>=','>');
      421     4167    1   DCL OBUF CHAR(256) STATIC DALIGNED;
      422     4168    1   DCL TXNUM CHAR(8) STATIC DALIGNED;
      423     4169    1   DCL TXSTR CHAR(32) STATIC DALIGNED;
      424     4170    1   DCL 1 TXSTRR REDEF TXSTR DALIGNED,
      425     4171    1         2 TOP CHAR(24) UNAL,
      426     4172    1         2 BOT CHAR(08) UNAL;
      427     4173    1   DCL TXSTR$ PTR STATIC ALIGNED INIT(ADDR(TXSTR));
      428     4174        %EQU   NUM_ATTRS = 14;
      429     4175    1   DCL 1 ATTRTAB (0:%NUM_ATTRS) CONSTANT ALIGNED,
      430     4176    1         2 ABIT BIT(18) UNAL INIT(%ATTR_D6250#,%ATTR_D1600#,%ATTR_D800#,
      431     4177    1                                  %ATTR_D38000#,
      432     4178    1                                  %ATTR_DD200#,%ATTR_DD500#,%ATTR_DD600#,
      433     4179    1                                  %ATTR_DD1000#,%ATTR_DD1500#,
      434     4180    1                                  %ATTR_DD400#,%ATTR_DD1100#,
      435     4181    1                                  %ATTR_TRUOVRPRT#,%ATTR_APL#,%ATTR_BIN#,
      436     4182    1                                  %ATTR_LOWERCASE#),
      437     4183    1         2 STR CHAR(5) UNAL INIT('6250','1600','800','38000',
      438     4184    1                                 '200M','500M','600M',
      439     4185    1                                 '1000','1500','400','1100',
      440     4186    1                                 'OVR','APL','BIN','LC');
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:14   
      441     4187
      442     4188        /* ** the following constants DEPEND on the size, and order of the */
      443     4189        /*    ATTRTAB array above.  They are the MIN and MAX index values   */
      444     4190        %EQU MT_MIN =  0;
      445     4191        %EQU MT_MAX =  3;
      446     4192        %EQU DP_MIN =  4;
      447     4193        %EQU DP_MAX = 10;
      448     4194        %EQU LP_MIN = 11;
      449     4195        %EQU LP_MAX = 14;    /* this should be NUM_ATTRS# !! */
      450     4196        %SUB TRUE = '1'B;
      451     4197        %SUB FALSE = '0'B;
      452     4198    1   DCL ADD_RES_ATTR BIT(1);   /* FLAG used to display res, if attr fits*/
      453     4199
      454     4200        %OC_MESSHD_D            (NAME=OPMSG_UFMT,
      455     4201            NPARMS    = 1,
      456     4202            ATR       = M_UR,
      457     4203            MSG       = OD_UFMT_MSG#,
      458     4204            STCLASS   = STATIC);
      459     4217    1         2 BUFL UBIN BYTE UNAL INIT(0),
      460     4218    1         2 BUF CHAR(ODMI_OBSZ#);
      461     4219
      462     4220
      463     4221
      464     4222        /**/
      465     4223        /* DCBS */
      466     4224        /**/
      467     4225    1   DCL M$CSCG DCB;
      468     4226    1   DCL M$LO DCB;
      469     4227    1   DCL M$ME DCB;
      470     4228
      471     4229
      472     4230
      473     4231        /**/
      474     4232        /* REFS */
      475     4233        /**/
      476     4234    1   DCL B$TCB$ PTR SYMREF;
      477     4235    1   DCL B$JIT$ PTR SYMREF;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:15   
      478     4236
      479     4237
      480     4238
      481     4239        /**/
      482     4240        /* PMME FPTS */
      483     4241        /**/
      484     4242        %FPT_WRITE                             (FPTN=OCMSG_UFMT,
      485     4243                 BUF       = OPMSG_UFMT,
      486     4244                 DCB       = M$CSCG,
      487     4245                 STCLASS   = STATIC);
      488     4276        %FPT_TIME                              (FPTN=GET_TIME,
      489     4277                 DEST      = LOCAL,
      490     4278                 SOURCE    = UTS,
      491     4279                 TSTAMP    = INUTS,
      492     4280                 DATE      = OUTDATE,
      493     4281                 TIME      = OUTTIME);
      494     4300        %FPT_WRITE                             (FPTN=WRITE_LO,
      495     4301                 DCB       = M$LO,
      496     4302                 BUF       = LOBUF,
      497     4303                 VFC       = YES,
      498     4304                 STCLASS   = STATIC);
      499     4335        %FPT_WRITE                             (FPTN=WRITE_OLINE,
      500     4336                 DCB       = M$LO,
      501     4337                 VFC       = YES,
      502     4338                 BUF       = OF_LINE,
      503     4339                 STCLASS   = CONSTANT);
      504     4370        %FPT_DEVICE                            (FPTN=SET_HDR,
      505     4371                 DCB       = M$LO,
      506     4372                 HDR       = HDRVLP,
      507     4373                 PAGE      = YES,
      508     4374                 STCLASS   = CONSTANT);
      509     4392        %FPT_WRITE                             (FPTN=WRITE_ILINE,
      510     4393                 DCB       = M$LO,
      511     4394                 VFC       = YES,
      512     4395                 BUF       = IF_LINE,
      513     4396                 STCLASS   = CONSTANT);
      514     4427        %FPT_WRITE                             (FPTN=WRITE_ME,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:16   
      515     4428                 STCLASS   = STATIC,
      516     4429                 DCB       = M$ME,
      517     4430                 VFC       = NO);
      518     4461        %FPT_DISPLAY                          (FPTN=FPT_DISPLAY,
      519     4462                 RESULTS   = VLR_DISPLAY,
      520     4463                 STCLASS   = CONSTANT);
      521     4476
      522     4477
      523     4478
      524     4479        /**/
      525     4480        /* SUBS */
      526     4481        /**/
      527     4482        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      528     4483        %EJECT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:17   
      529     4484
      530     4485        /**/
      531     4486        /* BEGIN HERE */
      532     4487        /**/
      533     4488
      534     4489
      535     4490    1         OPMSG_UFMT.CADDR=OD_CXT.CADDR;
      536     4491    1         LEN=0;
      537     4492    1         IF OD_CXT.ONLP = 0 THEN
      538     4493    2           DO;
      539     4494
      540     4495        /**
      541     4496
      542     4497            CCC    OOO   N   N   SSS    OOO   L      EEEEE
      543     4498           C   C  O O O  N   N  S   S  O O O  L      E
      544     4499           C      O O O  NN  N  S      O O O  L      E
      545     4500           C      O  OO  N N N   SSS   O  OO  L      EEEE
      546     4501           C      O   O  N  NN      S  O   O  L      E
      547     4502           C   C  O   O  N   N  S   S  O   O  L      E
      548     4503            CCC    OOO   N   N   SSS    OOO   LLLLL  EEEEE
      549     4504
      550     4505
      551     4506           DDDD    III    SSS   PPPP   L       AAA   Y   Y
      552     4507           D   D    I    S   S  P   P  L      A   A  Y   Y
      553     4508           D   D    I    S      P   P  L      A   A   Y Y
      554     4509           D   D    I     SSS   PPPP   L      AAAAA    Y
      555     4510           D   D    I        S  P      L      A   A    Y
      556     4511           D   D    I    S   S  P      L      A   A    Y
      557     4512           DDDD    III    SSS   P      LLLLL  A   A    Y
      558     4513
      559     4514         **/
      560     4515
      561     4516    2           TLEN=0;
      562     4517
      563     4518
      564     4519    3             DO CASE ( DISPLAY_TYPE );
      565     4520
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:18   
      566     4521
      567     4522                                /* FULL SYSID DISPLAY */
      568     4523    3               CASE (ODFT_SYSID#);
      569     4524
      570     4525    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      571     4526    3                 CALL FMT_SYSID;
      572     4527    3                 CALL FMT_JA;
      573     4528    3                 CALL FMT_OAN;
      574     4529    3                 CALL FMT_WW;
      575     4530    3                 CALL FMT_POS;
      576     4531    3                 CALL FMT_RQL;
      577     4532    3                 CALL FMT_FOL;
      578     4533
      579     4534
      580     4535                                /* SYSID DISPLAY FROM :JOBSTATS FILE */
      581     4536    3               CASE (ODFT_JSFID#);
      582     4537
      583     4538    3                 BUF$=OD_CXT.SEG$;
      584     4539                      %ADDSTR (S=' Sysid ');
      585     4544                      %ADDNUM (N="OD_CXT.SYSID");
      586     4549                      %ADDSTR (S="' ('");
      587     4554                      %ADDTXT (T="BUF$->XSJ$JOBINFO.ACCT#");
      588     4559                      %ADDSTR (S="') '");
      589     4564    4                   DO CASE (BUF$->XSJ$JOBINFO.STATUS#);
      590     4565
      591     4566    4                     CASE (%MBS_DELETED#);
      592     4567                            %ADDSTR (S='deleted by operator');
      593     4572
      594     4573    4                     CASE (%MBS_CANCELED#);
      595     4574                            %ADDSTR (S='cancelled');
      596     4579
      597     4580    4                     CASE (%MBS_SHAFTED#);
      598     4581                            %ADDSTR (S='deleted for FOLLOW condition');
      599     4586
      600     4587    4                     CASE (%PRE_PASSED#);
      601     4588                            %ADDSTR (S='passed PRESCAN successfully');
      602     4593
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:19   
      603     4594    4                     CASE (%REJ_JOB#);
      604     4595                            %ADDSTR (S='rejected - bad !JOB');
      605     4600
      606     4601    4                     CASE (%REJ_RES#);
      607     4602                            %ADDSTR (S='rejected - bad !RES');
      608     4607
      609     4608    4                     CASE (%REJ_SYNTAX#);
      610     4609                            %ADDSTR (S='rejected - bad syntax at record ');
      611     4614                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");
      612     4619
      613     4620    4                     CASE (%REJ_IO#);
      614     4621                            %ADDSTR (S='rejected - I/O error at record ');
      615     4626                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");
      616     4631
      617     4632    4                     CASE (%REJ_JOBIMBED#);
      618     4633                            %ADDSTR (S='rejected - imbedded !JOB at record ');
      619     4638                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");
      620     4643
      621     4644    4                     CASE (%REJ_RESIMBED#);                                    /*#B00*/
      622     4645                            %ADDSTR (S='rejected - imbedded !RES at record ');      /*#B00*/
      623     4650                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");                 /*#B00*/
      624     4655
      625     4656    4                     CASE (%REJ_BADID#);
      626     4657                            %ADDSTR (S='rejected - bad ID');
      627     4662
      628     4663    4                     CASE (%REJ_NORES#);
      629     4664                            %ADDSTR (S='rejected - lack of resources');
      630     4669
      631     4670    4                     CASE (%REJ_PRESCAN#);
      632     4671                            %ADDSTR (S='rejected - PRESCAN problem');
      633     4676
      634     4677    4                     CASE (%REJ_NOBATCH#);
      635     4678                            %ADDSTR (S='rejected - user not authorized for batch');
      636     4683
      637     4684    4                     CASE (%MBS_FILERR#);
      638     4685                            %ADDSTR (S='aborted by MBS - bad job file');
      639     4690
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:20   
      640     4691    4                     CASE (%FIN_RECOVER#);
      641     4692                            %ADDSTR (S='caught by system recovery');
      642     4697
      643     4698    4                     CASE (%FIN_ABNORMAL#);
      644     4699    4                       IF BUF$->XSJ$JOBINFO.XLIMFLG# THEN
      645     4700    5                         DO;
      646     4701                              %ADDSTR (S="'aborted - '");
      647     4706    5                         LIMITS_HIT=0;
      648     4707    5                         XCON.LIMIT=BUF$->XSJ$JOBINFO.XLIMFLG#;
      649     4708    5                         IF XCON.LIMIT.PO THEN
      650     4709    6                           DO;
      651     4710                                %ADDSTR (S='PO');
      652     4715    6                           LIMITS_HIT=LIMITS_HIT+1;
      653     4716    6                           END;
      654     4717    5                         IF XCON.LIMIT.TIME THEN
      655     4718    6                           DO;
      656     4719    6                           IF LIMITS_HIT > 0 THEN
      657     4720    7                             DO;
      658     4721                                  %ADDSTR (S="', '");
      659     4726    7                             END;
      660     4727                                %ADDSTR (S='TIME');
      661     4732    6                           LIMITS_HIT=LIMITS_HIT+1;
      662     4733    6                           END;
      663     4734    5                         IF XCON.LIMIT.PLO THEN
      664     4735    6                           DO;
      665     4736    6                           IF LIMITS_HIT > 0 THEN
      666     4737    7                             DO;
      667     4738                                  %ADDSTR (S="', '");
      668     4743    7                             END;
      669     4744                                %ADDSTR (S='PROC LO');
      670     4749    6                           LIMITS_HIT=LIMITS_HIT+1;
      671     4750    6                           END;
      672     4751    5                         IF XCON.LIMIT.LO THEN
      673     4752    6                           DO;
      674     4753    6                           IF LIMITS_HIT > 0 THEN
      675     4754    7                             DO;
      676     4755                                  %ADDSTR (S="', '");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:21   
      677     4760    7                             END;
      678     4761                                %ADDSTR (S='LO');
      679     4766    6                           LIMITS_HIT=LIMITS_HIT+1;
      680     4767    6                           END;
      681     4768    5                         IF XCON.LIMIT.DGO THEN
      682     4769    6                           DO;
      683     4770    6                           IF LIMITS_HIT > 0 THEN
      684     4771    7                             DO;
      685     4772                                  %ADDSTR (S="', '");
      686     4777    7                             END;
      687     4778                                %ADDSTR (S='DIAG LO');
      688     4783    6                           LIMITS_HIT=LIMITS_HIT+1;
      689     4784    6                           END;
      690     4785    5                         IF XCON.LIMIT.PDISK THEN
      691     4786    6                           DO;
      692     4787    6                           IF LIMITS_HIT > 0 THEN
      693     4788    7                             DO;
      694     4789                                  %ADDSTR (S="', '");
      695     4794    7                             END;
      696     4795                                %ADDSTR (S='PDISK');
      697     4800    6                           LIMITS_HIT=LIMITS_HIT+1;
      698     4801    6                           END;
      699     4802    5                         IF XCON.LIMIT.TDISK THEN
      700     4803    6                           DO;
      701     4804    6                           IF LIMITS_HIT > 0 THEN
      702     4805    7                             DO;
      703     4806                                  %ADDSTR (S="', '");
      704     4811    7                             END;
      705     4812                                %ADDSTR (S='TDISK');
      706     4817    6                           LIMITS_HIT=LIMITS_HIT+1;
      707     4818    6                           END;
      708     4819    5                         IF XCON.LIMIT.TAPE THEN
      709     4820    6                           DO;
      710     4821    6                           IF LIMITS_HIT > 0 THEN
      711     4822    7                             DO;
      712     4823                                  %ADDSTR (S="', '");
      713     4828    7                             END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:22   
      714     4829                                %ADDSTR (S='SCRATCH TAPE');
      715     4834    6                           LIMITS_HIT=LIMITS_HIT+1;
      716     4835    6                           END;
      717     4836    5                         IF XCON.LIMIT.STACK THEN
      718     4837    6                           DO;
      719     4838    6                           IF LIMITS_HIT > 0 THEN
      720     4839    7                             DO;
      721     4840                                  %ADDSTR (S="', '");
      722     4845    7                             END;
      723     4846                                %ADDSTR (S='SAFE STORE STACK');
      724     4851    6                           LIMITS_HIT=LIMITS_HIT+1;
      725     4852    6                           END;
      726     4853    5                         IF LIMITS_HIT > 1 THEN
      727     4854    6                           DO;
      728     4855                                %ADDSTR (S="' limits exceeded'");
      729     4860    6                           END;
      730     4861    5                         ELSE
      731     4862    6                           DO;
      732     4863                                %ADDSTR (S="' limit exceeded'");
      733     4868    6                           END;
      734     4869    5                         END;
      735     4870    4                       ELSE
      736     4871    5                         DO;
      737     4872    5                         IF BUF$->XSJ$JOBINFO.FRS# = %RS_CAN# THEN
      738     4873    6                           DO;
      739     4874                                %ADDSTR (S='cancelled by user');
      740     4879    6                           END;
      741     4880    5                         ELSE IF BUF$->XSJ$JOBINFO.FRS# = %RS_XKEY# THEN
      742     4881    6                            DO;
      743     4882                                 %ADDSTR (S='aborted by operator');
      744     4887    6                            END;
      745     4888    5                          ELSE
      746     4889    6                            DO CASE (BITBIN(BUF$->XSJ$JOBINFO.FRS#));
      747     4890    6                              CASE (1);
      748     4891                                     %ADDSTR (S='errored by user');
      749     4896    6                              CASE (2);
      750     4897                                     %ADDSTR (S='aborted by user');
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:23   
      751     4902    6                              CASE (4);
      752     4903                                     %ADDSTR (S='aborted by processor');
      753     4908    6                              CASE (8,32);
      754     4909                                     %ADDSTR (S='aborted by monitor');
      755     4914    6                              CASE (16);
      756     4915                                     %ADDSTR (S='errored by operator');
      757     4920    6                              CASE (ELSE);
      758     4921                                     %ADDSTR (S='terminated - STEPCC=');
      759     4926                                     %ADDNUM (N="BUF$->XSJ$JOBINFO.STEPCC#");
      760     4931    6                            END;
      761     4932    5                         END;
      762     4933
      763     4934    4                     CASE (%FIN_COMPLETED#);
      764     4935                            %ADDSTR (S='completed');
      765     4940
      766     4941    4                     CASE (ELSE);
      767     4942                            %ADDSTR (S="'Oops:  DOG''s busted; STARLOG time!'");
      768     4947
      769     4948    4                   END;
      770     4949
      771     4950                      %ADDSTR (S=': ');
      772     4955    3                 INUTS=BUF$->XSJ$JOBINFO.OFF_TIME#;
      773     4956    3                 CALL M$TIME (GET_TIME);
      774     4957                      %ADDSTR (S="OUTTIME.HHMM");
      775     4962                      %ADDSTR (S=' ');
      776     4967                      %ADDSTR (S="OUTDATE");
      777     4972
      778     4973
      779     4974                                /* NORUN DISPLAY */
      780     4975    3               CASE (ODFT_NORUN#);
      781     4976
      782     4977    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      783     4978    3                 CALL FMT_SYSID;
      784     4979    3                 CALL FMT_JA;
      785     4980    3                 CALL FMT_POS;
      786     4981    3                 CALL FMT_RQL;
      787     4982    3                 CALL FMT_FOL;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:24   
      788     4983
      789     4984
      790     4985                                /* OUTPUT FILE DISPLAY */
      791     4986    3               CASE (ODFT_OUTSF#,ODFT_OUTNS#);
      792     4987
      793     4988    3                 BUF$=ADDR(OD_CXT.SEG$->R$OUTPUT.F(OD_CXT.NDONE));
      794     4989    3                 CALL FMT_OUTP;
      795     4990                      %ADDSTR (S=' ');
      796     4995    3                 IF BUF$->A$OUTPUT.FLG.DEVAVAIL = '0'B THEN
      797     4996    4                   DO;
      798     4997                        %ADDSTR (S='NODEV ');
      799     5002    4                   END;
      800     5003                      %ADDNUM (N="BUF$->A$OUTPUT.GRANS");
      801     5008    3                 IF BUF$->A$OUTPUT.COPIES > 1 THEN
      802     5009    4                   DO;
      803     5010                        %ADDSTR (S="'(x'");
      804     5015                        %ADDNUM (N="BUF$->A$OUTPUT.COPIES");
      805     5020                        %ADDSTR (S="')'");
      806     5025    4                   END;
      807     5026                      %ADDSTR (S="' grans'");
      808     5031                      %ADDSTR (S="' prio '");
      809     5036    4                   DO CASE (BUF$->A$OUTPUT.PRIO);
      810     5037    4                     CASE (%FP_SPILLED#);
      811     5038                            %ADDSTR (S="'S'");
      812     5043    4                     CASE (%FP_MFW#);
      813     5044                            %ADDSTR (S="'W'");
      814     5049    4                     CASE (%FP_HOLD#);
      815     5050                            %ADDSTR (S="'H'");
      816     5055    4                       GOTO CHKCOM;
      817     5056    4                     CASE (ELSE);
      818     5057                            %ADDNUM (N="BUF$->A$OUTPUT.PRIO");
      819     5062    4   CHKCOM:             ;
      820     5063    4                       IF NOT BUF$->A$OUTPUT.FLG.GLC THEN
      821     5064    5                         DO;
      822     5065                              %ADDSTR (S="' (C)'");
      823     5070    5                         END;
      824     5071    4                   END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:25   
      825     5072    3                 IF BUF$->A$OUTPUT.DEVNAME ~= ' ' THEN
      826     5073    4                   DO;
      827     5074                        %ADDSTR (S="' on '");
      828     5079                        %ADDSTR (S="BUF$->A$OUTPUT.DEVTYP");
      829     5084                        %ADDSTR (S="BUF$->A$OUTPUT.DEVNAME");
      830     5089    4                   IF BUF$->A$OUTPUT.TNAME ~= BUF$->A$OUTPUT.WOD THEN
      831     5090    5                     DO;
      832     5091                          %ADDSTR (S="'@'");
      833     5096                          %ADDTXT (T="BUF$->A$OUTPUT.TNAME");
      834     5101    5                     END;
      835     5102    4                   END;
      836     5103    3                 ELSE IF BUF$->A$OUTPUT.FLG.SPILL THEN
      837     5104    4                    DO;
      838     5105                         %ADDSTR (S=' being spilled');
      839     5110    4                    END;
      840     5111    3                  ELSE
      841     5112    4                    DO;
      842     5113    4                    POSN=BUF$->A$OUTPUT.AHEAD+1;
      843     5114    4                    CALL FMT_POSN;
      844     5115    4                    END;
      845     5116
      846     5117
      847     5118                                /* INPUT FILE WAITING @ PRIO */
      848     5119                                /* INPUT FILE WAITING FOR DEFER TIME */
      849     5120    3               CASE (ODFT_INPRI#,ODFT_INDFR#);
      850     5121
      851     5122    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      852     5123    3                 CALL FMT_SYSID;
      853     5124    3                 CALL FMT_JA;
      854     5125    3                 CALL FMT_POS;
      855     5126
      856     5127
      857     5128                                /* INPUT FILE RUNNING */
      858     5129    3               CASE (ODFT_INRUN#);
      859     5130
      860     5131    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      861     5132    3                 CALL FMT_JOB;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:26   
      862     5133    3                 CALL FMT_JA;
      863     5134    3                 CALL FMT_POS;
      864     5135
      865     5136
      866     5137                                /* INPUT FILE - WAITING TO FOLLOW */
      867     5138    3               CASE (ODFT_INFOL#);
      868     5139
      869     5140    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
      870     5141    3                 CALL FMT_SYSID;
      871     5142    3                 CALL FMT_JA;
      872     5143    3                 CALL FMT_POS;
      873     5144                      %ADDSTR (S="', follows '");
      874     5149    3                 IF BUF$->A$INPUT.JDID.FOLLOW_TYPE(0) = %JM_FOLLOW_ACCOUNT THEN
      875     5150    4                   DO;
      876     5151                        %ADDSTR (S="'all jobs .'");
      877     5156                        %ADDTXT (T="BUF$->A$INPUT.ACCT");
      878     5161    4                   END;
      879     5162    3                 ELSE
      880     5163    4                   DO;
      881     5164                        %ADDNUM (N="BUF$->A$INPUT.NFOLL");
      882     5169                        %ADDSTR (S="' jobs'");
      883     5174    4                   END;
      884     5175    3             END;
      885     5176
      886     5177    2           CALL INS_OBUF;
      887     5178    2           CALL FLUSH;
      888     5179    2           RETURN;
      889     5180    2           END;
      890     5181
      891     5182        %EJECT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:27   
      892     5183    1         ELSE
      893     5184    2           DO;
      894     5185
      895     5186        /**
      896     5187
      897     5188           PPPP   RRRR    III   N   N  TTTTT  EEEEE  RRRR
      898     5189           P   P  R   R    I    N   N    T    E      R   R
      899     5190           P   P  R   R    I    NN  N    T    E      R   R
      900     5191           PPPP   RRRR     I    N N N    T    EEEE   RRRR
      901     5192           P      R R      I    N  NN    T    E      R R
      902     5193           P      R  R     I    N   N    T    E      R  R
      903     5194           P      R   R   III   N   N    T    EEEEE  R   R
      904     5195
      905     5196
      906     5197           DDDD    III    SSS   PPPP   L       AAA   Y   Y
      907     5198           D   D    I    S   S  P   P  L      A   A  Y   Y
      908     5199           D   D    I    S      P   P  L      A   A   Y Y
      909     5200           D   D    I     SSS   PPPP   L      AAAAA    Y
      910     5201           D   D    I        S  P      L      A   A    Y
      911     5202           D   D    I    S   S  P      L      A   A    Y
      912     5203           DDDD    III    SSS   P      LLLLL  A   A    Y
      913     5204
      914     5205         **/
      915     5206
      916     5207                %BUFRESET;
      917     5212
      918     5213    3             DO CASE ( DISPLAY_TYPE );
      919     5214
      920     5215    3               CASE (ODFT_OUTNS#,ODFT_OUTSF#);
      921     5216
      922     5217                                /* OUTPUT
      923     5218
      924     5219                                   FILE
      925     5220
      926     5221                                   DISPLAY */
      927     5222
      928     5223    3                 BUF$=ADDR(OD_CXT.SEG$->R$OUTPUT.F(OD_CXT.NDONE));
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:28   
      929     5224    3                 IF OD_CXT.HDRDUN = 0 THEN
      930     5225    4                   DO;
      931     5226    4                   OD_CXT.HDRDUN=1;
      932     5227    4                   HDRVLP=STHDR;
      933     5228    4                   ADDR(HDRVLP)->VLP$HDR.TITL.L#=LENGTHC(OF_TITLER);
      934     5229    4                   ADDR(HDRVLP)->VLP$HDR.TITL.TITLE#=OF_TITLER;
      935     5230    4                   CALL M$DEVICE (SET_HDR);
      936     5231    4                   END;
      937     5232
      938     5233                      %MVNUM (S="BUF$->A$OUTPUT.SYSID",D="OF_LINE.SYSID");
      939     5238                      %MVNUM (S="BUF$->A$OUTPUT.NUM",D="OF_LINE.NUM");
      940     5243    4                   DO CASE (BUF$->A$OUTPUT.MODE);
      941     5244
      942     5245    4                     CASE (%MODE_BATCH#);
      943     5246    4                       OF_LINE.MODE='BA';
      944     5247
      945     5248    4                     CASE (%MODE_GHOST#);
      946     5249    4                       OF_LINE.MODE='GH';
      947     5250
      948     5251    4                     CASE (%MODE_INT#);
      949     5252    4                       OF_LINE.MODE='TS';
      950     5253
      951     5254    4                     CASE (%MODE_TP#);
      952     5255    4                       OF_LINE.MODE='TP';
      953     5256
      954     5257    4                   END;
      955     5258                      %MVTXT (S="BUF$->A$OUTPUT.ACCT",D="OF_LINE.ACCT");
      956     5264    3                 OF_LINE.DEVTYP=BUF$->A$OUTPUT.DEVTYP;
      957     5265    3                 OF_LINE.WOD=BUF$->A$OUTPUT.WOD;
      958     5266                      %MVNUM (S="BUF$->A$OUTPUT.GRANS",D="OF_LINE.GRANS");
      959     5271                      %MVNUM (S="BUF$->A$OUTPUT.COPIES",D="OF_LINE.COPIES");
      960     5276    4                   DO CASE (BUF$->A$OUTPUT.PRIO);
      961     5277
      962     5278    4                     CASE (%FP_SPILLED#);
      963     5279    4                       OF_LINE.PRIO='SPLD';
      964     5280
      965     5281    4                     CASE (%FP_MFW#);
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:29   
      966     5282    4                       OF_LINE.PRIO='CMFW';
      967     5283
      968     5284    4                     CASE (%FP_HOLD#);
      969     5285    4                       OF_LINE.PRIO='HOLD';
      970     5286
      971     5287    4                     CASE (ELSE);
      972     5288                            %MVNUM (S="BUF$->A$OUTPUT.PRIO",D="OF_LINE.PRIO");
      973     5293
      974     5294    4                   END;
      975     5295
      976     5296    3                 IF BUF$->A$OUTPUT.FLG.SAP THEN
      977     5297    4                   DO;
      978     5298                        %MVNUM (S="BUF$->A$OUTPUT.SAPCOPIES",D="OF_LINE.SAP");
      979     5303    4                   END;
      980     5304    3                 ELSE OF_LINE.SAP=' N ';
      981     5305    3                 IF BUF$->A$OUTPUT.FLG.GLC THEN OF_LINE.COMF='  N ';
      982     5306    3                 ELSE
      983     5307    4                   DO;
      984     5308                        %MVNUM (S="BUF$->A$OUTPUT.HICNUM",D="OF_LINE.COMF");
      985     5313    4                   END;
      986     5314                      %MVTXT (S="BUF$->A$OUTPUT.FORM",D="OF_LINE.FORM");
      987     5320    3                 OF_LINE.ATTRS='....';
      988     5321    3                 ATTR=BUF$->A$OUTPUT.ATTR;
      989     5322    3                 IF ATTR THEN
      990     5323    4                   DO;
      991     5324    4                   IF (ATTR&%ATTR_TRUOVRPRT#) THEN OF_LINE.ATTRSR.OVR='O';
      992     5325    4                   IF (ATTR&%ATTR_LOWERCASE#) THEN OF_LINE.ATTRSR.LC='L';
      993     5326    4                   IF (ATTR&%ATTR_BIN#) THEN OF_LINE.ATTRSR.BIN='B';
      994     5327    4                   IF (ATTR&%ATTR_APL#) THEN OF_LINE.ATTRSR.APL='A';
      995     5328    4                   END;
      996     5329    3                 INUTS=BUF$->A$OUTPUT.CREATED;
      997     5330    3                 CALL M$TIME (GET_TIME);
      998     5331    3                 OF_LINE.CREATIME=OUTTIME.HHMM;
      999     5332    3                 OF_LINE.CREADATE.M=SUBSTR(OUTDATE,0,2);
     1000     5333    3                 OF_LINE.CREADATE.D=SUBSTR(OUTDATE,3,2);
     1001     5334    3                 OF_LINE.CREADATE.Y=SUBSTR(OUTDATE,6,2);
     1002     5335    3                 IF BUF$->A$OUTPUT.FLG.DEVAVAIL THEN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:30   
     1003     5336    3                  OF_LINE.NODEV=' ';
     1004     5337    3                 ELSE
     1005     5338    3                  OF_LINE.NODEV='*NODEV*';
     1006     5339    3                 OF_LINE.JOBNAME=BUF$->A$OUTPUT.JNAME;
     1007     5340
     1008     5341    3                 CALL M$WRITE (WRITE_OLINE);
     1009     5342    3                 RETURN;
     1010     5343
     1011     5344    3               CASE (ELSE);
     1012     5345
     1013     5346                                /* INPUT
     1014     5347
     1015     5348                                   JOB
     1016     5349
     1017     5350                                   DISPLAY */
     1018     5351
     1019     5352    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
     1020     5353    3                 IF OD_CXT.HDRDUN = 0 THEN
     1021     5354    4                   DO;
     1022     5355    4                   OD_CXT.HDRDUN=1;
     1023     5356    4                   HDRVLP=STHDR;
     1024     5357    4                   ADDR(HDRVLP)->VLP$HDR.TITL.L#=LENGTHC(IF_TITLER);
     1025     5358    4                   ADDR(HDRVLP)->VLP$HDR.TITL.TITLE#=IF_TITLER;
     1026     5359    4                   CALL M$DEVICE (SET_HDR);
     1027     5360    4                   END;
     1028     5361                      %MVNUM (S="BUF$->A$INPUT.SYSID",D="IF_LINE.SYSID");
     1029     5366                      %MVTXT (S="BUF$->A$INPUT.ACCT",D="IF_LINE.ACCT");
     1030     5372                      %MVTXT (S="BUF$->A$INPUT.UNAME",D="IF_LINE.UNAME");
     1031     5378    3                 INUTS=BUF$->A$INPUT.SUBMIT_TIME;
     1032     5379    3                 CALL M$TIME (GET_TIME);
     1033     5380    3                 IF_LINE.SUBTIME=OUTTIME.HHMM;
     1034     5381    3                 IF_LINE.SUBDATE.M=SUBSTR(OUTDATE,0,2);
     1035     5382    3                 IF_LINE.SUBDATE.D=SUBSTR(OUTDATE,3,2);
     1036     5383    3                 IF_LINE.SUBDATE.Y=SUBSTR(OUTDATE,6,2);
     1037     5384    3                 IF_LINE.CFLG='.....';
     1038     5385    3                 IF BUF$->A$INPUT.FLG.O1 THEN IF_LINE.FLG.O='O';
     1039     5386    3                 IF BUF$->A$INPUT.FLG.ACC THEN IF_LINE.FLG.A='A';
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:31   
     1040     5387    3                 IF BUF$->A$INPUT.FLG.O3 THEN IF_LINE.FLG.F='F';
     1041     5388    3                 IF BUF$->A$INPUT.FLG.RA THEN IF_LINE.FLG.D='D';
     1042     5389    3                 IF NOT BUF$->A$INPUT.FLG.RR THEN IF_LINE.FLG.N='N';
     1043     5390                      %MVTXT (S="BUF$->A$INPUT.WOO",D="IF_LINE.WOO");
     1044     5396                      %MVNUM (S="BUF$->A$INPUT.RRT(0)",D="IF_LINE.MEM");
     1045     5401    3                 IF_LINE.CTIM='       :  ';
     1046     5402    3                 IF BUF$->A$INPUT.TIM/360000 ~= 0 THEN
     1047     5403    4                   DO;
     1048     5404                        %MVNUM (S="BUF$->A$INPUT.TIM/360000",D="IF_LINE.TIM.H");
     1049     5409    4                   SUBSTR (IF_LINE.CTIM,4,1) = ':';
     1050     5410    4                   END;
     1051     5411                      %MVNUMZF (S="MOD(BUF$->A$INPUT.TIM/6000,60)",D="IF_LINE.TIM.M");
     1052     5415                      %MVNUMZF (S="MOD(BUF$->A$INPUT.TIM/100,60)",D="IF_LINE.TIM.S");
     1053     5419    3                 IF BUF$->A$INPUT.PRIO = %JP_RUN# THEN
     1054     5420    4                   DO;
     1055     5421    4                   IF_LINE.CPART='P  @            ';
     1056     5422                        %MVNUM (S="BUF$->A$INPUT.PNUM",D="IF_LINE.RUNNING_PART.PART");
     1057     5427    4                   INUTS=BUF$->A$INPUT.START_TIME;
     1058     5428    4                   CALL M$TIME (GET_TIME);
     1059     5429    4                   IF_LINE.RUNNING_PART.START_TIME.HHMM=OUTTIME.HHMM;
     1060     5430    4                   IF_LINE.RUNNING_PART.START_TIME.DATE.M=SUBSTR(OUTDATE,0,2);
     1061     5431    4                   IF_LINE.RUNNING_PART.START_TIME.DATE.D=SUBSTR(OUTDATE,3,2);
     1062     5432    4                   IF_LINE.RUNNING_PART.START_TIME.DATE.Y=SUBSTR(OUTDATE,6,2);
     1063     5433    4                   END;
     1064     5434    3                 ELSE
     1065     5435    4                   DO;
     1066     5436    4                   IF_LINE.CPART='................';
     1067     5437    4                   PARTM=BUF$->A$INPUT.PART;
     1068     5438    5                     DO I = 0 TO 15;
     1069     5439    5                     IF PARTMR.P(I) THEN IF_LINE.PARTS(I)='Y';
     1070     5440    5                     END;
     1071     5441    4                   END;
     1072     5442                      %MVNUM (S="BUF$->A$INPUT.IPRIO",D="IF_LINE.PRIO");
     1073     5447    4                   DO CASE (BUF$->A$INPUT.PRIO);
     1074     5448
     1075     5449    4                     CASE (%JP_WPART#);
     1076     5450    4                       IF_LINE.CSTATUS=ST_WPART;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:32   
     1077     5451
     1078     5452    4                     CASE (%JP_WPS#);
     1079     5453    4                       IF_LINE.CSTATUS=ST_WPS;
     1080     5454
     1081     5455    4                     CASE (%JP_RUNAFTER#);
     1082     5456    4                       IF_LINE.CSTATUS=ST_DEFER;
     1083     5457
     1084     5458    4                     CASE (%JP_RUN#);
     1085     5459    4                       IF_LINE.CSTATUS=ST_RUN;
     1086     5460
     1087     5461    4                     CASE (%JP_FOLL#);
     1088     5462    4                       IF_LINE.CSTATUS=ST_FOLL;
     1089     5463
     1090     5464    4                     CASE (ELSE);
     1091     5465    4                       POSN=BUF$->A$INPUT.AHEAD+1;
     1092     5466                            %MVNUM (S="POSN",D="ST_WAIT.POS");
     1093     5471    4                       IF MOD(POSN,100) < 10
     1094     5472    4                       OR MOD(POSN,100) > 20 THEN
     1095     5473    5                         DO;
     1096     5474    5                         ST_WAIT.NUMEXT=NUMEXTS(MOD(POSN,10));
     1097     5475    5                         END;
     1098     5476    4                       ELSE
     1099     5477    5                         DO;
     1100     5478    5                         ST_WAIT.NUMEXT=TEEN_NUMEXTS(MOD(POSN,10));
     1101     5479    5                         END;
     1102     5480    4                       IF_LINE.CSTATUS=ST_WAIT;
     1103     5481
     1104     5482    4                   END;
     1105     5483    3                 IF_LINE.JNAME=BUF$->A$INPUT.JNAME;
     1106     5484
     1107     5485                                /* WRITE THE ONE RECORD */
     1108     5486    3                 CALL M$WRITE (WRITE_ILINE);
     1109     5487
     1110     5488                                /* FORMAT PSEUDOS, PACKSETS, FOLLOW LIST,
     1111     5489                                   AND PHYSICALS SEPARATELY, WITH AT LEAST
     1112     5490                                   ONE LINE FOR EACH */
     1113     5491    3                 LPWRITES=0;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:33   
     1114     5492
     1115     5493                           /* WSN */
     1116     5494    3                 IF BUF$->A$INPUT.WOO ~= BUF$->A$INPUT.WSN THEN
     1117     5495    4                   DO;
     1118     5496                        %HEADER (T=WSNHDR,N=40);
     1119     5503                        %ADDSTR (S="' '");
     1120     5508                        %ADDTXT (T="BUF$->A$INPUT.WSN");
     1121     5513    4                   CALL INS_OBUF;
     1122     5514    4                   CALL FLUSH;
     1123     5515    4                   END;
     1124     5516                           /* DEFERREDness */
     1125     5517    3                 IF BUF$->A$INPUT.FLG.RA THEN
     1126     5518    4                   DO;
     1127     5519                        %HEADER (T=DEFRHDR,N=40);
     1128     5526    4                   CALL DO_DEFER;
     1129     5527    4                   CALL FLUSH;
     1130     5528    4                   END;
     1131     5529
     1132     5530                           /* FOLLOW LIST */
     1133     5531    3                 IF BUF$->A$INPUT.FLG.O3 THEN
     1134     5532    4                   DO;
     1135     5533                        %HEADER (T=FOLLHDR,N=40);
     1136     5540                        %ADDSTR (S="' ('");
     1137     5545    4                   CALL DO_FOLL;
     1138     5546                        %ADDSTR (S="')'");
     1139     5551    4                   CALL INS_OBUF;
     1140     5552    4                   CALL FLUSH;
     1141     5553    4                   END;
     1142     5554
     1143     5555                           /* PSEUDOS */
     1144     5556                      %HEADER (T=PSEUHDR,N=40);
     1145     5563    3                 CALL DO_PSEUDOS;
     1146     5564    3                 CALL FLUSH;
     1147     5565
     1148     5566                           /* PACKSETS */
     1149     5567                      %HEADER (T=PSETHDR,N=40);
     1150     5574    3                 CALL DO_PACKSETS;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:34   
     1151     5575    3                 CALL FLUSH;
     1152     5576
     1153     5577                           /* PHYSICALS */
     1154     5578                      %HEADER (T=OTHRHDR,N=40);
     1155     5585    3                 CALL DO_PHYS;
     1156     5586    3                 CALL FLUSH;
     1157     5587
     1158     5588                                /* PUT OUT A BLANK LINE IF WE DID ANY
     1159     5589                                   WRITES FOR THE ABOVE 4 THINGS */
     1160     5590    3                 IF LPWRITES ~= 0 THEN
     1161     5591    4                   DO;
     1162     5592                        %BUFRESET;
     1163     5597                        %ADDSTR (S='     ');
     1164     5602    4                   CALL INS_OBUF;
     1165     5603    4                   CALL FLUSH;
     1166     5604    4                   END;
     1167     5605    3                 RETURN;
     1168     5606
     1169     5607
     1170     5608    3             END;
     1171     5609
     1172     5610
     1173     5611    2           END;
     1174     5612        %EJECT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:35   
     1175     5613        /*
     1176     5614
     1177     5615              FFFFF  OOO  RRRR  M   M  AAA  TTTTT
     1178     5616              F     O O O R   R MM MM A   A   T
     1179     5617              F     O O O R   R M M M A   A   T
     1180     5618              FFFF  O  OO RRRR  M   M AAAAA   T
     1181     5619              F     O   O R R   M   M A   A   T
     1182     5620              F     O   O R  R  M   M A   A   T
     1183     5621              F      OOO  R   R M   M A   A   T
     1184     5622
     1185     5623
     1186     5624          RRRR   OOO  U   U TTTTT  III  N   N EEEEE  SSS
     1187     5625          R   R O O O U   U   T     I   N   N E     S   S
     1188     5626          R   R O O O U   U   T     I   NN  N E     S
     1189     5627          RRRR  O  OO U   U   T     I   N N N EEEE   SSS
     1190     5628          R R   O   O U   U   T     I   N  NN E         S
     1191     5629          R  R  O   O U   U   T     I   N   N E     S   S
     1192     5630          R   R  OOO   UUU    T    III  N   N EEEEE  SSS
     1193     5631
     1194     5632        */
     1195     5633
     1196     5634
     1197     5635                                /* ROUTINE TO FORMAT FIRST PART OF
     1198     5636                                   OUTSF AND OUTNS MESSAGES */
     1199     5637    1   FMT_OUTP: PROC;
     1200     5638
     1201     5639    2         CALL FMT_OSYSID;
     1202     5640              %ADDSTR (S="'-'");
     1203     5645              %ADDNUM (N="BUF$->A$OUTPUT.NUM");
     1204     5650    2         CALL FMT_OACCT;
     1205     5651              %ADDSTR (S="': '");
     1206     5656              %ADDTXT (T="BUF$->A$OUTPUT.DEVTYP");
     1207     5661    2         IF OD_CXT.SWSN ~= BUF$->A$OUTPUT.WOD THEN
     1208     5662    3           DO;
     1209     5663                %ADDSTR (S="'@'");
     1210     5668                %ADDTXT (T="BUF$->A$OUTPUT.WOD");
     1211     5673    3           END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:36   
     1212     5674    2         IF  BUF$->A$OUTPUT.FORM ~= 'STDLP'
     1213     5675    2         AND BUF$->A$OUTPUT.FORM ~= 'STD**' THEN
     1214     5676    3           DO;
     1215     5677                %ADDSTR (S="' ['");
     1216     5682                %ADDTXT (T="BUF$->A$OUTPUT.FORM");
     1217     5687                %ADDSTR (S="']'");
     1218     5692    3           END;
     1219     5693    2         RETURN;
     1220     5694    2   END FMT_OUTP;
     1221     5695
     1222     5696
     1223     5697                                /* FORMAT 'SYSID N' */
     1224     5698    1   FMT_SYSID: PROC;
     1225     5699
     1226     5700        %ADDSTR (S=' Sysid ');
     1227     5705    2         GOTO FMTS;
     1228     5706                                /* FORMAT 'OUTPUT SYSID N' */
     1229     5707    2   FMT_OSYSID: ENTRY;
     1230     5708              %ADDSTR (S="' Output sysid '");
     1231     5713              %ADDNUM (N="BUF$->A$OUTPUT.SYSID");
     1232     5718    2         CALL INS_OBUF;
     1233     5719    2         RETURN;
     1234     5720                                /* FORMAT 'JOB N' */
     1235     5721    2   FMT_JOB: ENTRY;
     1236     5722              %ADDSTR (S="' Job '");
     1237     5727    2   FMTS: ;
     1238     5728              %ADDNUM (N="BUF$->A$INPUT.SYSID");
     1239     5733    2         CALL INS_OBUF;
     1240     5734    2         RETURN;
     1241     5735    2   END FMT_SYSID;
     1242     5736
     1243     5737
     1244     5738
     1245     5739                                /* FORMAT JOBNAME,ACCOUNT */
     1246     5740    1   FMT_JA: PROC;
     1247     5741
     1248     5742        %ADDSTR (S="' ('");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:37   
     1249     5747    2         IF BUF$->A$INPUT.JNAME ~= ' ' THEN
     1250     5748    3           DO;
     1251     5749                %ADDTXT (T="BUF$->A$INPUT.JNAME");
     1252     5754                %ADDSTR (S="'.'");
     1253     5759    3           END;
     1254     5760    2         GOTO FMTA;
     1255     5761                                /* FORMAT OUTPUT JOBNAME & ACCOUNT */
     1256     5762    2   FMT_OACCT: ENTRY;
     1257     5763              %ADDSTR (S="' ('");
     1258     5768    2         IF BUF$->A$OUTPUT.JNAME ~= ' ' THEN
     1259     5769    3           DO;
     1260     5770                %ADDTXT (T="BUF$->A$OUTPUT.JNAME");
     1261     5775                %ADDSTR (S="'.'");
     1262     5780    3           END;
     1263     5781              %ADDTXT (T="BUF$->A$OUTPUT.ACCT");
     1264     5786    2         GOTO FMTA1;
     1265     5787                                /* FORMAT ACCOUNT ONLY */
     1266     5788    2   FMT_ACCT: ENTRY;
     1267     5789              %ADDSTR (S="' ('");
     1268     5794    2   FMTA: ;
     1269     5795              %ADDTXT (T="BUF$->A$INPUT.ACCT");
     1270     5800    2   FMTA1:;
     1271     5801              %ADDSTR (S="')'");
     1272     5806    2         CALL INS_OBUF;
     1273     5807    2         RETURN;
     1274     5808    2   END FMT_JA;
     1275     5809
     1276     5810
     1277     5811
     1278     5812                                /* FORMAT WSN,WOO */
     1279     5813    1   FMT_WW: PROC;
     1280     5814
     1281     5815    2         IF OD_CXT.LPWSN ~= BUF$->A$INPUT.WSN
     1282     5816    2         OR OD_CXT.LPWSN ~= BUF$->A$INPUT.WOO THEN
     1283     5817    3           DO;
     1284     5818                %ADDSTR (S="' ['");
     1285     5823                %ADDTXT (T="BUF$->A$INPUT.WOO");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:38   
     1286     5828    3           IF BUF$->A$INPUT.WSN ~= BUF$->A$INPUT.WOO THEN
     1287     5829    4             DO;
     1288     5830                  %ADDSTR (S="'->'");
     1289     5835                  %ADDTXT (T="BUF$->A$INPUT.WSN");
     1290     5840    4             END;
     1291     5841                %ADDSTR (S="']'");
     1292     5846    3           CALL INS_OBUF;
     1293     5847    3           END;
     1294     5848    2         RETURN;
     1295     5849    2   END FMT_WW;
     1296     5850
     1297     5851
     1298     5852
     1299     5853                                /* FORMAT ORDER,ACCOUNT,NORERUN */
     1300     5854    1   FMT_OAN: PROC;
     1301     5855
     1302     5856    2         IF BUF$->A$INPUT.FLG.O1
     1303     5857    2         OR BUF$->A$INPUT.FLG.ACC
     1304     5858    2         OR (NOT BUF$->A$INPUT.FLG.RR) THEN
     1305     5859    3           DO;
     1306     5860                %ADDSTR (S="' ('");
     1307     5865    3           IF BUF$->A$INPUT.FLG.O1 THEN
     1308     5866    4             DO;
     1309     5867                  %ADDSTR (S='O');
     1310     5872    4             END;
     1311     5873    3           IF BUF$->A$INPUT.FLG.ACC THEN
     1312     5874    4             DO;
     1313     5875                  %ADDSTR (S='A');
     1314     5880    4             END;
     1315     5881    3           IF NOT BUF$->A$INPUT.FLG.RR THEN
     1316     5882    4             DO;
     1317     5883                  %ADDSTR (S='N');
     1318     5888    4             END;
     1319     5889                %ADDSTR (S="')'");
     1320     5894    3           CALL INS_OBUF;
     1321     5895    3           END;
     1322     5896    2         RETURN;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:39   
     1323     5897    2   END FMT_OAN;
     1324     5898
     1325     5899
     1326     5900
     1327     5901                                /* FORMAT POSITION IN Q */
     1328     5902    1   FMT_POS: PROC;
     1329     5903
     1330     5904                %ADDSTR (S="' prio '");
     1331     5909                %ADDNUM (N="BUF$->A$INPUT.IPRIO");
     1332     5914    2         CALL INS_OBUF;
     1333     5915
     1334     5916    3           DO CASE (BUF$->A$INPUT.PRIO);
     1335     5917
     1336     5918
     1337     5919    3             CASE (%JP_FOLL#);
     1338     5920
     1339     5921
     1340     5922    3             CASE (%JP_RUNAFTER#);
     1341     5923
     1342     5924                    %ADDSTR (S="', deferred to'");
     1343     5929    3               CALL DO_DEFER;
     1344     5930
     1345     5931
     1346     5932    3             CASE (%JP_RUN#);
     1347     5933
     1348     5934    3               CALL M$DISPLAY (FPT_DISPLAY);
     1349     5935    4                 DO CASE (VLR_DISPLAY.ETMF);
     1350     5936    4                   CASE (0,1);
     1351     5937    4                     IF VLR_DISPLAY.USERS <= JG_MING#+4 THEN
     1352     5938    5                       DO;
     1353     5939                            %ADDSTR (S="', at WARP 8'");
     1354     5944    5                       END;
     1355     5945    4                     ELSE
     1356     5946    5                       DO;
     1357     5947                            %ADDSTR (S="', zipping along'");
     1358     5952    5                       END;
     1359     5953    4                   CASE (2);
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:40   
     1360     5954                          %ADDSTR (S="', running'");
     1361     5959    4                   CASE (3);
     1362     5960                          %ADDSTR (S="', trotting'");
     1363     5965    4                   CASE (4);
     1364     5966                          %ADDSTR (S="', walking'");
     1365     5971    4                   CASE (5,7,6);
     1366     5972                          %ADDSTR (S="', crawling'");
     1367     5977    4                   CASE (8,9,10);
     1368     5978                          %ADDSTR (S="', stagnating'");
     1369     5983    4                   CASE (ELSE);
     1370     5984                          %ADDSTR (S="', putrefying'");
     1371     5989    4                 END;
     1372     5990                    %ADDSTR (S="' since '");
     1373     5995    3               INUTS=BUF$->A$INPUT.START_TIME;
     1374     5996    3               CALL M$TIME (GET_TIME);
     1375     5997                    %ADDSTR (S="OUTTIME.HHMM");
     1376     6002                    %ADDSTR (S="' in part '");
     1377     6007                    %ADDNUM (N="BUF$->A$INPUT.PNUM");
     1378     6012
     1379     6013
     1380     6014    3             CASE (%JP_WPART#,%JP_WPS#);
     1381     6015
     1382     6016                    %ADDSTR (S="', NORUN'");
     1383     6021
     1384     6022
     1385     6023    3             CASE (ELSE);
     1386     6024
     1387     6025                    %ADDSTR (S="','");
     1388     6030    3               IF BUF$->A$INPUT.AHEAD = 0 THEN
     1389     6031    4                 DO;
     1390     6032                      %ADDSTR (S="' *ready to rock*'");
     1391     6037    4                 END;
     1392     6038    3               ELSE
     1393     6039    4                 DO;
     1394     6040    4                 POSN=BUF$->A$INPUT.AHEAD+1;
     1395     6041    4                 CALL FMT_POSN;
     1396     6042    4                 END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:41   
     1397     6043
     1398     6044
     1399     6045    3           END;
     1400     6046
     1401     6047    2         CALL INS_OBUF;
     1402     6048    2         RETURN;
     1403     6049    2   END FMT_POS;
     1404     6050    1   FMT_POSN: PROC;
     1405     6051        %ADDSTR (S=' ');
     1406     6056                  %ADDNUM    (N="POSN");
     1407     6061    2         IF MOD(POSN,100) < 10
     1408     6062    2         OR MOD(POSN,100) > 20 THEN
     1409     6063    3           DO;
     1410     6064                %ADDSTR (S="NUMEXTS(MOD(POSN,10))");
     1411     6069    3           END;
     1412     6070    2         ELSE
     1413     6071    3           DO;
     1414     6072                %ADDSTR (S="TEEN_NUMEXTS(MOD(POSN,10))");
     1415     6077    3           END;
     1416     6078    2         RETURN;
     1417     6079    2   END FMT_POSN;
     1418     6080
     1419     6081
     1420     6082
     1421     6083    1   DO_DEFER: PROC;
     1422     6084
     1423     6085              %ADDSTR (S="' '");
     1424     6090    2         INUTS=BUF$->A$INPUT.RATIM;
     1425     6091    2         CALL M$TIME (GET_TIME);
     1426     6092              %ADDSTR (S="OUTTIME.HHMM");
     1427     6097              %ADDSTR (S="' '");
     1428     6102              %ADDTXT (T=OUTDATE);
     1429     6107    2         CALL INS_OBUF;
     1430     6108    2         RETURN;
     1431     6109
     1432     6110    2   END DO_DEFER;
     1433     6111
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:42   
     1434     6112
     1435     6113
     1436     6114                                /* FORMAT FOLLOW LIST */
     1437     6115    1   FMT_FOL: PROC;
     1438     6116
     1439     6117    2         IF NOT BUF$->A$INPUT.FLG.O3 THEN RETURN;
     1440     6118              %ADDSTR (S="' (follows '");
     1441     6123    2         CALL DO_FOLL;
     1442     6124              %ADDSTR (S="')'");
     1443     6129    2         CALL INS_OBUF;
     1444     6130    2         RETURN;
     1445     6131    2   END FMT_FOL;
     1446     6132
     1447     6133    1   DO_FOLL: PROC ALTRET;
     1448     6134
     1449     6135    2         NFOLL=0;
     1450     6136    3           DO WHILE (NFOLL < BUF$->A$INPUT.NFOLL);
     1451     6137    3           IF NFOLL ~= 0 THEN
     1452     6138    4             DO;
     1453     6139                  %ADDSTR (S="','");
     1454     6144    4             CALL INS_OBUF;
     1455     6145    4             END;
     1456     6146    3           IF BUF$->A$INPUT.JDID.FOLLOW_TYPE(NFOLL) = %JM_FOLLOW_ACCOUNT THEN
     1457     6147    4             DO;
     1458     6148                  %ADDSTR (S="'All jobs .'");
     1459     6153                  %ADDTXT (T="BUF$->A$INPUT.ACCT");
     1460     6158    4             END;
     1461     6159    3           ELSE
     1462     6160    4             DO;
     1463     6161                  %ADDNUM (N="BUF$->A$INPUT.JDID.SYSID(NFOLL)");
     1464     6166    4             END;
     1465     6167    3           IF BUF$->A$INPUT.JDID.SATISFIED(NFOLL) THEN
     1466     6168    4             DO;
     1467     6169                  %ADDSTR (S="'(Satisfied'");
     1468     6174    4             END;
     1469     6175    3           ELSE
     1470     6176    4             DO;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:43   
     1471     6177                  %ADDSTR (S="'(Unsatisfied'");
     1472     6182    4             END;
     1473     6183    4             DO CASE (BUF$->A$INPUT.JDID.FOLLOW_TYPE(NFOLL));
     1474     6184    4               CASE (%JM_FOLLOW_STEPCC);
     1475     6185                      %ADDSTR (S="',STEPCC'");
     1476     6190                      %ADDTXT (T="TXRELATIONS(BUF$->A$INPUT.JDID.RELATION(NFOLL))");
     1477     6195                      %ADDNUM (N="BUF$->A$INPUT.JDSTEPCC(NFOLL)");
     1478     6200    4               CASE (%JM_FOLLOW_OK);
     1479     6201                      %ADDSTR (S="',OK'");
     1480     6206    4               CASE (%JM_FOLLOW_ERROR);
     1481     6207                      %ADDSTR (S="',ERROR'");
     1482     6212    4               CASE (%JM_FOLLOW_ABORT);
     1483     6213                      %ADDSTR (S="',ABORT'");
     1484     6218    4             END;
     1485     6219                %ADDSTR (S="')'");
     1486     6224    3           NFOLL=NFOLL+1;
     1487     6225    3           END;
     1488     6226
     1489     6227    2         IF NFOLL ~= 0 THEN RETURN;
     1490     6228    2         ALTRETURN;
     1491     6229    2   END DO_FOLL;
     1492     6230
     1493     6231
     1494     6232
     1495     6233
     1496     6234                                /* FORMAT RESOURCE REQUIREMENTS */
     1497     6235    1   FMT_RQL: PROC;
     1498     6236
     1499     6237              %ADDSTR (S="' requires TIME='");
     1500     6242    2         IF BUF$->A$INPUT.TIM/360000 ~= 0 THEN
     1501     6243    3           DO;
     1502     6244                %ADDNUM (N="BUF$->A$INPUT.TIM/360000");
     1503     6249                %ADDSTR (S="':'");
     1504     6254    3           END;
     1505     6255              %ADDNUM2 (N="MOD(BUF$->A$INPUT.TIM/6000,60)");
     1506     6260              %ADDSTR (S="':'");
     1507     6265              %ADDNUM2 (N="MOD(BUF$->A$INPUT.TIM/100,60)");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:44   
     1508     6270    2         CALL INS_OBUF;
     1509     6271              %ADDSTR (S="' MEM='");
     1510     6276              %ADDNUM (N="BUF$->A$INPUT.RRT(0)");
     1511     6281    2         CALL INS_OBUF;
     1512     6282
     1513     6283
     1514     6284                                /* PSEUDOS */
     1515     6285    2         CALL DO_PSEUDOS;
     1516     6286
     1517     6287                                /* PACKSETS */
     1518     6288    2         CALL DO_PACKSETS;
     1519     6289
     1520     6290                                /* PHYSICAL RESOURCES (E.G. MT'S) */
     1521     6291    2         CALL DO_PHYS;
     1522     6292
     1523     6293    2         RETURN;
     1524     6294    2   END FMT_RQL;
     1525     6295
     1526     6296    1   DO_PSEUDOS: PROC ALTRET;
     1527     6297
     1528     6298    2         NPS=0;
     1529     6299    3           DO I = 4 TO 11;
     1530     6300    3           IF BUF$->A$INPUT.RRT(I) ~= 0 THEN
     1531     6301    4             DO;
     1532     6302    4             NPS=NPS+1;
     1533     6303                  %ADDSTR (S=' ');
     1534     6308                  %ADDTXT (T="OD_PSEUDOS.PSLIST.PSEUDO#(I-4)");
     1535     6313                  %ADDSTR (S="'='");
     1536     6318                  %ADDNUM (N="BUF$->A$INPUT.RRT(I)");
     1537     6323    4             CALL INS_OBUF;
     1538     6324    4             END;
     1539     6325    3           END;
     1540     6326    2         IF NPS ~= 0 THEN RETURN;
     1541     6327    2         ALTRETURN;
     1542     6328    2   END DO_PSEUDOS;
     1543     6329
     1544     6330
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:45   
     1545     6331    1   DO_PACKSETS: PROC ALTRET;
     1546     6332
     1547     6333    2         NSN=0;
     1548     6334    2         SNX=BUF$->A$INPUT.SNX;
     1549     6335    3           DO I = 1 TO BUF$->A$INPUT.NSN;
     1550     6336    3           PSNAME=OD_CXT.SN$->A$SN.S.NAME(SNX);
     1551     6337    3           IF PSNAME ~= 'SYS' THEN
     1552     6338    4             DO;
     1553     6339    4             IF NSN ~= 0 THEN
     1554     6340    5               DO;
     1555     6341                    %ADDSTR (S="','");
     1556     6346    5               CALL INS_OBUF;
     1557     6347    5               END;
     1558     6348    4             ELSE
     1559     6349    5               DO;
     1560     6350                    %ADDSTR (S="' '");
     1561     6355    5               END;
     1562     6356    4             NSN=NSN+1;
     1563     6357                  %ADDSTR (S="'#'");
     1564     6362                  %ADDTXT (T="PSNAME");
     1565     6367    4             IF OD_CXT.SN$->A$SN.S.FLG(SNX) THEN
     1566     6368    5               DO;
     1567     6369                    %ADDSTR (S="'('");
     1568     6374    5               IF OD_CXT.SN$->A$SN.S.FLG.EXCL(SNX) THEN
     1569     6375    6                 DO;
     1570     6376                      %ADDSTR (S='EX');
     1571     6381    6                 END;
     1572     6382    5               IF OD_CXT.SN$->A$SN.S.FLG.PUB(SNX) THEN
     1573     6383    6                 DO;
     1574     6384                      %ADDSTR (S='PB');
     1575     6389    6                 END;
     1576     6390                    %ADDSTR (S="')'");
     1577     6395    5               END;
     1578     6396    4             END;
     1579     6397    3           SNX=SNX+1;
     1580     6398    3           END;
     1581     6399    2         CALL INS_OBUF;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:46   
     1582     6400    2         IF NSN ~= 0 THEN RETURN;
     1583     6401    2         ALTRETURN;
     1584     6402    2   END DO_PACKSETS;
     1585     6403
     1586     6404
     1587     6405    1   DO_PHYS: PROC ALTRET;
     1588     6406
     1589     6407    2         NRES=0;
     1590     6408    2         RESX=BUF$->A$INPUT.RESX;
     1591     6409    3           DO I = 1 TO BUF$->A$INPUT.NRES;
     1592     6410    3           IF NRES ~= 0 THEN
     1593     6411    4             DO;
     1594     6412                  %ADDSTR (S="','");
     1595     6417    4             CALL INS_OBUF;
     1596     6418    4             END;
     1597     6419    3           ELSE
     1598     6420    4             DO;
     1599     6421                  %ADDSTR (S="' '");
     1600     6426    4             END;
     1601     6427    3           NRES=NRES+1;
     1602     6428                %ADDSTR (S="OD_CXT.RES$->A$RES.R.TYP(RESX)");
     1603     6433                %ADDSTR (S="OD_CXT.RES$->A$RES.R.VNUM(RESX)");
     1604     6438    3           ATTR=OD_CXT.RES$->A$RES.R.ATTR(RESX);
     1605     6439    3           IF ATTR THEN
     1606     6440    4             DO;
     1607     6441                  %ADDSTR (S="'('");
     1608     6446    5               DO J = 0 TO %NUM_ATTRS;
     1609     6447    5               ADD_RES_ATTR = FALSE;
     1610     6448    6               IF (ATTR & ATTRTAB.ABIT(J)) THEN DO;
     1611     6449    7                   DO SELECT(OD_CXT.RES$->A$RES.R.TYP(RESX));
     1612     6450    7                   SELECT('MT');
     1613     6451    7                   IF (J >= %MT_MIN) AND (J <= %MT_MAX) THEN
     1614     6452    7                    ADD_RES_ATTR = TRUE;
     1615     6453    7                   SELECT('DP');
     1616     6454    7                   IF (J >= %DP_MIN) AND (J <= %DP_MAX) THEN
     1617     6455    7                    ADD_RES_ATTR = TRUE;
     1618     6456    7                   SELECT('LP');
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:47   
     1619     6457    7                   IF (J >= %LP_MIN) AND (J <= %LP_MAX) THEN
     1620     6458    7                    ADD_RES_ATTR = TRUE;
     1621     6459    7                   END;  /*SELECT*/
     1622     6460
     1623     6461    7                 IF ADD_RES_ATTR THEN DO;
     1624     6462                             /* Add an attribute, it is valid */
     1625     6463                        %ADDTXT (T="ATTRTAB.STR(J)");
     1626     6468                        %ADDSTR (S="','");
     1627     6473    7                   END;
     1628     6474    6                 END;  /* if ATTR matches */
     1629     6475    5               END;  /* do j */
     1630     6476    4             LEN=LEN-1;
     1631     6477                  %ADDSTR (S="')'");
     1632     6482    4             END;
     1633     6483    3           RESX=RESX+1;
     1634     6484    3           END;
     1635     6485    2         CALL INS_OBUF;
     1636     6486    2         IF NRES ~= 0 THEN RETURN;
     1637     6487    2         ALTRETURN;
     1638     6488    2   END DO_PHYS;
     1639     6489
     1640     6490
     1641     6491
     1642     6492                                /* ADD OBUF TO END OF REAL BUFFER */
     1643     6493    1   INS_OBUF: PROC;
     1644     6494
     1645     6495    2         IF LEN ~= 0 THEN
     1646     6496    3           DO;
     1647     6497    3           IF OD_CXT.ONLP = 0 THEN
     1648     6498    4             DO;
     1649     6499    4             IF TLEN+LEN > OD_OBMAX THEN CALL FLUSH;
     1650     6500    4             CALL INSERT (OPMSG_UFMT.BUF,TLEN,LEN,OBUF);
     1651     6501    4             END;
     1652     6502    3           ELSE
     1653     6503    4             DO;
     1654     6504    4             IF TLEN+LEN > ODMI_LPMX# THEN CALL FLUSH;
     1655     6505    4             CALL INSERT (LOBUF,TLEN,LEN,OBUF);
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:48   
     1656     6506    4             END;
     1657     6507    3           TLEN=TLEN+LEN;
     1658     6508    3           LEN=0;
     1659     6509    3           END;
     1660     6510    2         RETURN;
     1661     6511    2   END INS_OBUF;
     1662     6512
     1663     6513
     1664     6514
     1665     6515                                /* FLUSH BUFFER */
     1666     6516    1   FLUSH: PROC;
     1667     6517
     1668     6518    2         IF OD_CXT.ONLP = 0 THEN
     1669     6519    3           DO;
     1670     6520    3           IF TLEN ~= 0 THEN
     1671     6521    4             DO;
     1672     6522    4             IF OD_SGHST THEN
     1673     6523    5               DO;
     1674     6524    5               OPMSG_UFMT.BUFL=TLEN;
     1675     6525    5               OCMSG_UFMT.BUF_.BOUND=LENGTHC(OPMSG_UFMT)-LENGTHC(OPMSG_UFMT.BUF)+TLEN-1
              6525                        ;
     1676     6526    5               CALL M$WRITE (OCMSG_UFMT);
     1677     6527    5               END;
     1678     6528    4             ELSE
     1679     6529    5               DO;
     1680     6530    5               WRITE_ME.BUF_.BUF$=ADDR(OPMSG_UFMT.BUF);
     1681     6531    5               WRITE_ME.BUF_.BOUND=TLEN-1;
     1682     6532    5               CALL M$WRITE (WRITE_ME);
     1683     6533    5               END;
     1684     6534    4             TLEN=0;
     1685     6535    4             END;
     1686     6536    3           END;
     1687     6537    2         ELSE
     1688     6538    3           DO;
     1689     6539    3           IF TLEN > LPTAB THEN
     1690     6540    4             DO;
     1691     6541    4             WRITE_LO.BUF_.BOUND=TLEN-1;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:49   
     1692     6542    4             CALL M$WRITE (WRITE_LO);
     1693     6543    4             LPWRITES=LPWRITES+1;
     1694     6544    4             TLEN=LPTAB;
     1695     6545    4             CALL INSERT (LOBUF,1,LPTAB-1,' ');
     1696     6546    4             END;
     1697     6547    3           END;
     1698     6548    2         RETURN;
     1699     6549    2   END FLUSH;
     1700     6550
     1701     6551
     1702     6552
     1703     6553    1   INS_NUM: PROC;
     1704     6554                                /* INSERT NUMERIC STRING IN TXNUM INTO OBUF
     1705     6555                                   @ LEAST 1 DIGIT  */
     1706     6556
     1707     6557    2         TXSTRR.TOP=' ';
     1708     6558    2         CALL EDITCHAR (TXSTRR.BOT,,,EDITCTL,TXNUM);
     1709     6559    2         GOTO INSIT;
     1710     6560
     1711     6561                                /* INSERT NUMERIC STRING IN TXNUM INTO OBUF
     1712     6562                                   @ LEAST 2 DIGITS */
     1713     6563    2   INS_NUM2: ENTRY;
     1714     6564
     1715     6565    2         TXSTRR.TOP=' ';
     1716     6566    2         CALL EDITCHAR (TXSTRR.BOT,,,EDITCTL2,TXNUM);
     1717     6567    2   INSIT:;
     1718     6568    2         NX=0;
     1719     6569    2         CALL INDEX1R (BLNKINDEX,' ',TXSTR) ALTRET(NOB);
     1720     6570    2         NX=BLNKINDEX+1;
     1721     6571    2   NOB:  ;
     1722     6572    2         K=LENGTHC(TXSTR)-NX;
     1723     6573    2         CALL INSERT (OBUF,LEN,K,PINCRC(TXSTR$,NX)->B$CHARS);
     1724     6574    2         LEN=LEN+K;
     1725     6575    2         RETURN;
     1726     6576
     1727     6577                                /* INSERT THE TEXT STRING IN TXSTR INTO OBUF */
     1728     6578    2   INS_TXT: ENTRY;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:50   
     1729     6579
     1730     6580                           /* THE STRING IS ASSUMED LEFT-JUSTIFIED, BLANK
     1731     6581                              PADDED ON THE RIGHT, SO LOOK FOR THE FIRST
     1732     6582                              BLANK */
     1733     6583    2         CALL INDEX (BLNKINDEX,' ',TXSTR);
     1734     6584    2         CALL INSERT (OBUF,LEN,BLNKINDEX,TXSTR);
     1735     6585    2         LEN=LEN+BLNKINDEX;
     1736     6586    2         RETURN;
     1737     6587    2   END INS_NUM;
     1738     6588    1   END ODF$FORMAT;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:51   
--  Include file information  --

   XSJ_MAC_C.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   JM_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   OD_MAC_C.:E05TOU  is referenced.
   OD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ODF$FORMAT.

   Procedure ODF$FORMAT requires 2813 words for executable code.
   Procedure ODF$FORMAT requires 40 words of local(AUTO) storage.

    No errors detected in file ODF$FORMAT.:E05TSI    .

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:52   

 Object Unit name= ODF$FORMAT                                 File name= ODF$FORMAT.:E05TOU
 UTS= JUL 30 '97 04:11:47.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   482    742  ODF$FORMAT
    2  RoData even  UTS    495    757  ODF$FORMAT
    3   DCB   even  none     0      0  M$CSCG
    4   DCB   even  none     0      0  M$LO
    5   DCB   even  none     0      0  M$ME
    6   Proc  even  none  2813   5375  ODF$FORMAT
    7  RoData even  none    19     23  ODF$FORMAT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        1  ODF$FORMAT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:53   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  OD_SGHST                              OD_OBMAX
     OD_CXT                                OD_PSEUDOS                            M$CSCG
     M$LO                                  M$ME                                  B$JIT$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:54   


        1        1        /*M* ODF$FORMAT Output formatter for DOG ghost */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         ODF$FORMAT
       10       10
       11       11             PURPOSE:      To provide output message formatting for the DOG ghost
       12       12
       13       13             DESCRIPTION:  This routine is called with OD_CXT$ pointing to
       14       14                           a keyin context frame.  Its purpose is to format
       15       15                           and write the display for the next item in
       16       16                           the buffer segment.  The parameter is a
       17       17                           code for the type of display to produce.
       18       18
       19       19                           If the display is to console, the formatted
       20       20                           buffer is written to KEYIN with a message
       21       21                           code whose template is simply /1,T/.
       22       22
       23       23                           If the display is to LP, the formatted buffer
       24       24                           is written to M$LO.
       25       25        */
       26       26        /**/
       27       27        ODF$FORMAT: PROC ( DISPLAY_TYPE );

     27  6 000000   000000 700200 xent  ODF$FORMAT   TSX0  ! X66_AUTO_1
         6 000001   000050 000001                    ZERO    40,1

       28       28        /**/
       29       29
       30       30
       31       31
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:55   
       32       32        /**/
       33       33        /* PARAMETERS */
       34       34        /**/
       35       35    1   DCL DISPLAY_TYPE SBIN;
       36       36
       37       37
       38       38
       39       39        /**/
       40       40        /* INCLUDES */
       41       41        /**/
       42       42        %INCLUDE CP_6;
       43      123        %INCLUDE CP_6_SUBS;
       44      663        %INCLUDE OC_MESSHD_C;
       45      716        %INCLUDE OC_SUBS_C;
       46     1447        %INCLUDE OD_SUBS_C;
       47     1508        %INCLUDE OD_MAC_C;
       48     1596        %INCLUDE FOO_MAC_C;
       49     2344        %INCLUDE OD_DATA_R;
       50     2570        %INCLUDE NK_SUBS;
       51     2595        %INCLUDE F_ERRORS_C;
       52     2835        %INCLUDE FO_ERRORS_C;
       53     2867        %INCLUDE KC_ERRORS_C;
       54     2914        %INCLUDE JG_GHOSTS_C;
       55     3004        %INCLUDE JM_SUBS_C;
       56     3110        %INCLUDE B_MICROPS_C;
       57     3282        %INCLUDE XSJ_SUBS_C;
       58     3309        %INCLUDE XSJ_MAC_C;
       59     3388 S      %INCLUDE B$JIT_C;
       60     3389
       61     3390
       62     3391
       63     3392        /**/
       64     3393        /* BASED STRUCTURES */
       65     3394        /**/
       66     3395        %B$JIT0;
       67     3484        %U$JIT1X;
       68     3487        %M$JIT2X;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:56   
       69     3490        %F$JIT3X;
       70     3493        %S$JIT4X;
       71     3496        %J$JIT5;
       72     3584        %A$JIT6X;
       73     3587        %B$ALT;
       74     3595        %SET LISTMAC='1'B;
       75     3596        %VLR_JOBSTATS_OSRCH     (FPTN=R$OUTPUT,STCLASS=BASED,NFIL=0);
              3597        %LSET LISTDIR='0'B;
              3607    1  DCL 1 R$OUTPUT BASED DALIGNED,2 FOUND UBIN WORD UNAL /*(0)/**/,2 * UBIN WORD UNAL /*
              3607            (0)/**/,2 F
              3608    1   (0:0)CHAR(112);
       76     3610        %VLA_JOBSTATS_OSRCH     (FPTN=A$OUTPUT,STCLASS=BASED);
              3611        %LSET LISTDIR='0'B;
              3621    1   DCL 1 A$OUTPUT BASED ALIGNED,2 TNAME CHAR(8),2 DEVTYP CHAR(2),2 COPIES UBIN BYTE
              3621            UNAL,2 * UBIN BYTE UNAL,2 SAPCOPIES UBIN BYTE UNAL,2
              3622    1   PRIO UBIN BYTE UNAL,2 ATTR BIT(18),2 FLG,3 GLC BIT(1),3 SAP BIT(1),3 SPILL BIT(1),3
              3622            DEVAVAIL BIT(1),3 * BIT(1),2 MODE UBIN(4)UNAL,2
              3623    1  BOOTID CHAR(3),2 SYSID UBIN HALF UNAL,2 NUM UBIN HALF UNAL,2 HICNUM UBIN HALF UNAL,2
              3623            GRANS UBIN HALF UNAL,2 FORM CHAR(6),2 DEVNAME
              3624    1   CHAR(2),2 ACCT CHAR(8),2 JNAME CHAR(31),2 * UBIN BYTE CALIGNED,2 AHEAD UBIN HALF
              3624            UNAL,2 * UBIN HALF UNAL,2 CREATED UBIN WORD,2 WOD
              3625    1   CHAR(8)/*(' ')/**/,2 *(0:4)UBIN WORD;
       77     3627        %VLR_JOBSTATS_ISRCH     (FPTN=R$INPUT ,STCLASS=BASED,NJOB=0);
              3628        %LSET LISTDIR='0'B;
              3638    1  DCL 1 R$INPUT BASED DALIGNED,2 FOUND UBIN WORD UNAL /*(0)/**/,2 * UBIN WORD UNAL /*(
              3638            0)/**/,2 J
              3639    1   (0:0)CHAR(256);
       78     3641        %VLA_JOBSTATS_ISRCH     (FPTN=A$INPUT ,STCLASS=BASED);
              3642        %LSET LISTDIR='0'B;
              3652    1  DCL 1 A$INPUT BASED ALIGNED,2 NSN UBIN HALF UNAL /*(0)/**/,2 SNX UBIN HALF UNAL /*(0
              3652            )/**/,2 NRES UBIN
              3653    1  HALF UNAL /*(0)/**/,2 RESX UBIN HALF UNAL /*(0)/**/,2 U UBIN HALF UNAL /*(0)/**/,2 *
              3654    1   BIT(2)/*('0'B)/**/,2 PART BIT(16)/*('0'B)/**/,2 PNUM UBIN BYTE UNAL /*(0)/**/,2 PI
              3655    1  UBIN BYTE UNAL /*(0)/**/,2 IPRIO UBIN BYTE UNAL /*(0)/**/,2 PRIO UBIN BYTE UNAL /*(0
              3655            )
              3656    1   /**/,2 SUBMIT_TIME UBIN WORD UNAL /*(0)/**/,2 START_TIME UBIN WORD UNAL /*(0)/**/,2
              3656            FLG,3 O1 BIT
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:57   
              3657    1   (1)/*('0'B)/**/,3 * BIT(1)/*('0'B)/**/,3 O3 BIT(1)/*('0'B)/**/,3 ACC BIT(1)/*
              3658    1   ('0'B)/**/,3 RR BIT(1)/*('0'B)/**/,3 RR2 BIT(1)/*('0'B)/**/,3 NPI BIT(1)/*('0'B
              3659    1   )/**/,3 RA BIT(1)/*('0'B)/**/,3 * BIT(1)/*('0'B)/**/,2 NFOLL UBIN BYTE UNAL /*(0
              3660    1  )/**/,2 SYSID UBIN HALF UNAL /*(0)/**/,2 AHEAD UBIN WORD UNAL /*(0)/**/,2 ACCT CHAR(
              3660            8
              3661    1   )/*(' ')/**/,2 UNAME CHAR(12)/*(' ')/**/,2 WOO CHAR(8)/*(' ')/**/,2 WSN CHAR(8)/*
              3662    1   (' ')/**/,2 JNAME CHAR(31)/*(' ')/**/,2 * UBIN BYTE CALIGNED /*(0)/**/,2 RATIM UBIN
              3663    1  WORD UNAL /*(0)/**/,2 RRT(0:11)UBIN HALF UNAL /*(0*0)/**/,2 TIM UBIN WORD UNAL /*(0)
              3664    1  /**/,2 JDID(0:7),3 RELATION UBIN(3)UNAL /*(0*0)/**/,3 FOLLOW_TYPE UBIN(3)UNAL /*(0*0
              3664            )/**/,3 *
              3665    1  UBIN(11)UNAL /*(0*0)/**/,3 SATISFIED BIT(1)/*('0'B*0)/**/,3 SYSID UBIN(18)UNAL /*(0*
              3665            0)
              3666    1   /**/,2 JDSTEPCC(0:7)UBIN(9)UNAL /*(0*0)/**/,2 *(0:20)UBIN WORD UNAL /*(0*0)/**/;
       79     3668        %SET LISTMAC='0'B;
       80     3669        %VLR_JOBSTATS_ISRCH_SN  (FPTN=A$SN    ,STCLASS=BASED,NSN =0);
       81     3682        %VLR_JOBSTATS_ISRCH_RES (FPTN=A$RES   ,STCLASS=BASED,NRES=0);
       82     3695        %XSJ_JOBINFO (FPTN=XSJ$JOBINFO,STCLASS=BASED);
       83     3710    1   DCL B$CHARS CHAR(K) BASED DALIGNED;
       84     3711        %OD_CXT       (FPTN=OD$CXT,STCLASS=BASED);
       85     3779        %VLP_HDR                               (FPTN=VLP$HDR,
       86     3780                 LEN       = 132,
       87     3781                 STCLASS   = BASED);
       88     3797
       89     3798
       90     3799
       91     3800        /**/
       92     3801        /* MACROS */
       93     3802        /**/
       94     3803        %MACRO ADDSTR (S="");
       95     3804        %LSET LISTSUB='1'B;
       96     3805              CALL INSERT (OBUF,LEN,LENGTHC(S),S);
       97     3806              LEN=LEN+LENGTHC(S);
       98     3807        %MEND;
       99     3808            %MACRO ADDTXT (T="");
      100     3809            %LSET LISTSUB='1'B;
      101     3810              TXSTR=T;
      102     3811              CALL INS_TXT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:58   
      103     3812        %MEND;
      104     3813            %MACRO ADDNUM (N="");
      105     3814            %LSET LISTSUB='1'B;
      106     3815              CALL BINCHAR(TXNUM,N);
      107     3816              CALL INS_NUM;
      108     3817        %MEND;
      109     3818            %MACRO ADDNUM2 (N="");
      110     3819            %LSET LISTSUB='1'B;
      111     3820              CALL BINCHAR (TXNUM,N);
      112     3821              CALL INS_NUM2;
      113     3822        %MEND;
      114     3823            %MACRO MVTXT (S="",D="");
      115     3824            %LSET LISTSUB='1'B;
      116     3825              D=' ';
      117     3826              CALL INDEX (BLNKINDEX,' ',S);
      118     3827              CALL INSERT (D,LENGTHC(D)-BLNKINDEX,BLNKINDEX,S);
      119     3828        %MEND;
      120     3829            %MACRO MVNUM (S="",D="");
      121     3830            %LSET LISTSUB='1'B;
      122     3831              CALL BINCHAR (D,S);
      123     3832              CALL EDITCHAR (D,,,EDITCTLS(LENGTHC(D)),D);
      124     3833        %MEND;
      125     3834            %MACRO MVNUMZF (S="",D="");
      126     3835            %LSET LISTSUB='1'B;
      127     3836              CALL BINCHAR (D,S);
      128     3837        %MEND;
      129     3838            %MACRO HEADER (T="",N="");
      130     3839            %LSET LISTSUB='1'B;
      131     3840              CALL INSERT (LOBUF,1,N,' ');
      132     3841              CALL INSERT (LOBUF,N+1,LENGTHC(T),T);
      133     3842              TLEN=LENGTHC(T)+N+1;
      134     3843              LPTAB=TLEN;
      135     3844        %MEND;
      136     3845            %MACRO BUFRESET;
      137     3846              TLEN=1;
      138     3847              LEN=0;
      139     3848              LPTAB=1;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:59   
      140     3849        %MEND;
      141     3850
      142     3851
      143     3852
      144     3853        /**/
      145     3854        /* AUTO */
      146     3855        /**/
      147     3856    1   DCL J SBIN WORD;
      148     3857    1   DCL POSN SBIN WORD;/* SBIN to generate Much less code */
      149     3858    1   DCL I SBIN WORD;
      150     3859    1   DCL BUF$ PTR;
      151     3860    1   DCL SN$ PTR;
      152     3861    1   DCL RES$ PTR;
      153     3862    1   DCL TLEN SBIN WORD;
      154     3863    1   DCL LEN SBIN WORD;
      155     3864    1   DCL LIMITS_HIT SBIN WORD;
      156     3865    1   DCL NFOLL SBIN WORD;
      157     3866    1   DCL BLNKINDEX SBIN WORD;
      158     3867    1   DCL K SBIN WORD;
      159     3868    1   DCL NX SBIN WORD;
      160     3869    1   DCL SNX SBIN WORD;
      161     3870    1   DCL RESX SBIN WORD;
      162     3871    1   DCL PSNAME CHAR(8);
      163     3872    1   DCL ATTR BIT(18);
      164     3873    1   DCL NPS SBIN WORD;
      165     3874    1   DCL NRES SBIN WORD;
      166     3875    1   DCL NSN SBIN WORD;
      167     3876    1   DCL LPWRITES SBIN WORD;
      168     3877
      169     3878
      170     3879
      171     3880        /**/
      172     3881        /* STATIC */
      173     3882        /**/
      174     3883        %VLR_DISPLAY (FPTN=VLR_DISPLAY,STCLASS=STATIC);
      175     3897        %VLP_HDR                               (FPTN=STHDR,
      176     3898                 LEN       = 132,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:60   
      177     3899                 TITLE     = ' ',
      178     3900                 HEADERHEIGHT = 2,
      179     3901                 STCLASS   = STATIC);
      180     3917    1   DCL 1 HDRVLP STATIC DALIGNED,
      181     3918    1         2 * CHAR(256) UNAL;
      182     3919    1   DCL PARTM BIT(16) STATIC ALIGNED;
      183     3920    1   DCL 1 PARTMR REDEF PARTM ALIGNED,
      184     3921    1         2 P (0:15) BIT(1) UNAL;
      185     3922    1   DCL LPTAB SBIN WORD STATIC ALIGNED INIT(1);
      186     3923        %B$XCON (NAME=XCON,STCLASS=STATIC);
      187     3933    1   DCL WSNHDR CHAR(9) CONSTANT ALIGNED  INIT('TO-->   :');
      188     3934    1   DCL DEFRHDR CHAR(9) CONSTANT ALIGNED INIT('DEFERRED:');
      189     3935    1   DCL FOLLHDR CHAR(9) CONSTANT ALIGNED INIT('FOLLOWS :');
      190     3936    1   DCL PSETHDR CHAR(9) CONSTANT ALIGNED INIT('PACKSETS:');
      191     3937    1   DCL PSEUHDR CHAR(9) CONSTANT ALIGNED INIT('PSEUDOS :');
      192     3938    1   DCL OTHRHDR CHAR(9) CONSTANT ALIGNED INIT('OTHER   :');
      193     3939    1   DCL 1 ST_DEFER STATIC ALIGNED,
      194     3940    1         2 * CHAR(6) UNAL INIT('W:DEFR');
      195     3941    1   DCL 1 ST_WAIT STATIC ALIGNED,
      196     3942    1         2 POS CHAR(4) UNAL,
      197     3943    1         2 NUMEXT CHAR(2) UNAL;
      198     3944    1   DCL 1 ST_RUN STATIC ALIGNED,
      199     3945    1         2 * CHAR(6) UNAL INIT(' *RUN*');
      200     3946    1   DCL 1 ST_FOLL STATIC ALIGNED,
      201     3947    1         2 * CHAR(6) UNAL INIT('W:FOLW');
      202     3948    1   DCL 1 ST_WPS CONSTANT ALIGNED,
      203     3949    1         2 * CHAR(6) UNAL INIT('W:PACK');
      204     3950    1   DCL 1 ST_WPART CONSTANT ALIGNED,
      205     3951    1         2 * CHAR(6) UNAL INIT('W:PART');
      206     3952    1   DCL 1 OUTTIME STATIC DALIGNED,
      207     3953    1         2 HHMM CHAR(5) UNAL,
      208     3954    1         2 C CHAR(1) UNAL,
      209     3955    1         2 SSSS CHAR(5) UNAL;
      210     3956    1   DCL INUTS UBIN WORD STATIC DALIGNED;
      211     3957    1   DCL OUTDATE CHAR(8) STATIC DALIGNED;
      212     3958        /**/
      213     3959    1   DCL 1 OF_TITLE CONSTANT CALIGNED,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:61   
      214     3960    1         2 SYSID     CHAR(06) UNAL INIT(' SYSID'),
      215     3961    1         2 *         CHAR(01) UNAL INIT(' '),
      216     3962    1         2 NUM       CHAR(06) UNAL INIT('   NUM'),
      217     3963    1         2 *         CHAR(03) UNAL INIT(' MO'),
      218     3964    1         2 MODE      CHAR(02) UNAL INIT('DE'),
      219     3965    1         2 *         CHAR(01) UNAL INIT(' '),
      220     3966    1         2 ACCT      CHAR(08) UNAL INIT(' ACCOUNT'),
      221     3967    1         2 *         CHAR(01) UNAL INIT(' '),
      222     3968    1         2 DEVTYP    CHAR(02) UNAL INIT('DE'),
      223     3969    1         2 *         CHAR(01) UNAL INIT('S'),
      224     3970    1         2 WOD       CHAR(08) UNAL INIT('TINATION'),
      225     3971    1         2 *         CHAR(01) UNAL INIT(' '),
      226     3972    1         2 GRANS     CHAR(05) UNAL INIT('GRANS'),
      227     3973    1         2 *         CHAR(01) UNAL INIT(' '),
      228     3974    1         2 COPIES    CHAR(06) UNAL INIT('COPIES'),
      229     3975    1         2 *         CHAR(01) UNAL INIT(' '),
      230     3976    1         2 PRIO      CHAR(04) UNAL INIT('PRIO'),
      231     3977    1         2 *         CHAR(01) UNAL INIT(' '),
      232     3978    1         2 SAP       CHAR(03) UNAL INIT('SAP'),
      233     3979    1         2 *         CHAR(01) UNAL INIT(' '),
      234     3980    1         2 COMF      CHAR(03) UNAL INIT('COM'),
      235     3981    1         2 *         CHAR(01) UNAL INIT(' '),
      236     3982    1         2 FORM      CHAR(06) UNAL INIT('*FORM*'),
      237     3983    1         2 *         CHAR(01) UNAL INIT(' '),
      238     3984    1         2 ATTRS     CHAR(04) UNAL INIT('ATTR'),
      239     3985    1         2 ATTRSR REDEF ATTRS UNAL,
      240     3986    1           3 APL       CHAR(01) UNAL,
      241     3987    1           3 OVR       CHAR(01) UNAL,
      242     3988    1           3 BIN       CHAR(01) UNAL,
      243     3989    1           3 LC        CHAR(01) UNAL,
      244     3990    1         2 *         CHAR(01) UNAL INIT(' '),
      245     3991    1         2 CREATIME  CHAR(05) UNAL INIT('*CREA'),
      246     3992    1         2 *         CHAR(01) UNAL INIT('T'),
      247     3993    1         2 CREADATE  CHAR(06) UNAL INIT('ED AT*'),
      248     3994    1         2 *         CHAR(01) UNAL INIT(' '),
      249     3995    1         2 NODEV     CHAR(07) UNAL INIT('*NODEV*'),
      250     3996    1         2 *         CHAR(01) UNAL INIT(' '),
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:62   
      251     3997    1         2 JOBNAME   CHAR(31) UNAL INIT('*JOBNAME*');
      252     3998    1   DCL OF_TITLER REDEF OF_TITLE CHAR(130) CALIGNED;
      253     3999        /**/
      254     4000    1   DCL 1 OF_LINE STATIC CALIGNED,
      255     4001    1         2 *         CHAR(01) UNAL INIT('A'),
      256     4002    1         2 SYSID     CHAR(06) UNAL,
      257     4003    1         2 *         CHAR(01) UNAL INIT(' '),
      258     4004    1         2 NUM       CHAR(06) UNAL,
      259     4005    1         2 *         CHAR(03) UNAL INIT(' '),
      260     4006    1         2 MODE      CHAR(02) UNAL,
      261     4007    1         2 *         CHAR(01) UNAL INIT(' '),
      262     4008    1         2 ACCT      CHAR(08) UNAL,
      263     4009    1         2 *         CHAR(01) UNAL INIT(' '),
      264     4010    1         2 DEVTYP    CHAR(02) UNAL,
      265     4011    1         2 *         CHAR(01) UNAL INIT('@'),
      266     4012    1         2 WOD       CHAR(08) UNAL,
      267     4013    1         2 *         CHAR(01) UNAL INIT(' '),
      268     4014    1         2 GRANS     CHAR(05) UNAL,
      269     4015    1         2 *         CHAR(01) UNAL INIT(' '),
      270     4016    1         2 COPIES    CHAR(06) UNAL,
      271     4017    1         2 *         CHAR(01) UNAL INIT(' '),
      272     4018    1         2 PRIO      CHAR(04) UNAL,
      273     4019    1         2 *         CHAR(01) UNAL INIT(' '),
      274     4020    1         2 SAP       CHAR(03) UNAL,
      275     4021    1         2 *         CHAR(01) UNAL INIT(' '),
      276     4022    1         2 COMF      CHAR(03) UNAL,
      277     4023    1         2 *         CHAR(01) UNAL INIT(' '),
      278     4024    1         2 FORM      CHAR(06) UNAL,
      279     4025    1         2 *         CHAR(01) UNAL INIT(' '),
      280     4026    1         2 ATTRS     CHAR(04) UNAL,
      281     4027    1         2 ATTRSR REDEF ATTRS UNAL,
      282     4028    1           3 APL       CHAR(01) UNAL,
      283     4029    1           3 OVR       CHAR(01) UNAL,
      284     4030    1           3 BIN       CHAR(01) UNAL,
      285     4031    1           3 LC        CHAR(01) UNAL,
      286     4032    1         2 *         CHAR(01) UNAL INIT(' '),
      287     4033    1         2 CREATIME  CHAR(05) UNAL,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:63   
      288     4034    1         2 *         CHAR(01) UNAL INIT(' '),
      289     4035    1         2 CREADATE  UNAL,
      290     4036    1           3 M         CHAR(02) UNAL,
      291     4037    1           3 D         CHAR(02) UNAL,
      292     4038    1           3 Y         CHAR(02) UNAL,
      293     4039    1         2 *         CHAR(01) UNAL INIT(' '),
      294     4040    1         2 NODEV     CHAR(07) UNAL,
      295     4041    1         2 *         CHAR(01) UNAL INIT(' '),
      296     4042    1         2 JOBNAME   CHAR(31) UNAL;
      297     4043        /**/
      298     4044    1   DCL 1 IF_TITLE CONSTANT CALIGNED,
      299     4045    1         2 SYSID     CHAR(06) UNAL INIT(' SYSID'),
      300     4046    1         2 *         CHAR(01) UNAL INIT(' '),
      301     4047    1         2 ACCT      CHAR(08) UNAL INIT(' ACCOUNT'),
      302     4048    1         2 *         CHAR(01) UNAL INIT(' '),
      303     4049    1         2 UNAME     CHAR(12) UNAL INIT('**USERNAME**'),
      304     4050    1         2 *         CHAR(01) UNAL INIT(' '),
      305     4051    1         2 SUBTIME   CHAR(05) UNAL INIT('*SUBM'),
      306     4052    1         2 *         CHAR(01) UNAL INIT('I'),
      307     4053    1         2 SUBDATE   CHAR(06) UNAL INIT('TD AT*'),
      308     4054    1         2 *         CHAR(01) UNAL INIT(' '),
      309     4055    1         2 CFLG      CHAR(05) UNAL INIT('FLAGS'),
      310     4056    1         2 FLG REDEF CFLG UNAL,
      311     4057    1           3 O CHAR(1) UNAL,
      312     4058    1           3 A CHAR(1) UNAL,
      313     4059    1           3 N CHAR(1) UNAL,
      314     4060    1           3 F CHAR(1) UNAL,
      315     4061    1           3 D CHAR(1) UNAL,
      316     4062    1         2 *         CHAR(01) UNAL INIT(' '),
      317     4063    1         2 WOO       CHAR(08) UNAL INIT('**FROM**'),
      318     4064    1         2 *         CHAR(01) UNAL INIT(' '),
      319     4065    1         2 MEM       CHAR(03) UNAL INIT('MEM'),
      320     4066    1         2 *         CHAR(01) UNAL INIT(' '),
      321     4067    1         2 CTIM      CHAR(10) UNAL INIT('  MAXTIME '),
      322     4068    1         2 TIM REDEF CTIM UNAL,
      323     4069    1           3 H CHAR(4) UNAL,
      324     4070    1           3 * CHAR(1) UNAL,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:64   
      325     4071    1           3 M CHAR(2) UNAL,
      326     4072    1           3 * CHAR(1) UNAL,
      327     4073    1           3 S CHAR(2) UNAL,
      328     4074    1         2 *         CHAR(01) UNAL INIT(' '),
      329     4075    1         2 CPART     CHAR(16) UNAL INIT('1**PARTITIONS**1'),
      330     4076    1         2 PARTS (0:15) REDEF CPART CHAR(1) UNAL,
      331     4077    1         2 RUNNING_PART REDEF CPART UNAL,
      332     4078    1           3 * CHAR(1) UNAL,
      333     4079    1           3 PART CHAR(2) UNAL,
      334     4080    1           3 * CHAR(1) UNAL,
      335     4081    1           3 START_TIME UNAL,
      336     4082    1             4 HHMM CHAR(5) UNAL,
      337     4083    1             4 * CHAR(1) UNAL,
      338     4084    1             4 DATE UNAL,
      339     4085    1               5 M CHAR(2) UNAL,
      340     4086    1               5 D CHAR(2) UNAL,
      341     4087    1               5 Y CHAR(2) UNAL,
      342     4088    1         2 *         CHAR(02) UNAL INIT('6 '),
      343     4089    1         2 PRIO      CHAR(02) UNAL INIT('PR'),
      344     4090    1         2 *         CHAR(01) UNAL INIT(' '),
      345     4091    1         2 CSTATUS UNAL,
      346     4092    1           3 * CHAR(6) UNAL INIT('STATUS'),
      347     4093    1         2 *         CHAR(01) UNAL INIT(' '),
      348     4094    1         2 JNAME     CHAR(31) UNAL INIT('*JOBNAME*'),
      349     4095    1         2 *         CHAR(01) UNAL INIT(' ');
      350     4096    1   DCL IF_TITLER REDEF IF_TITLE CHAR(132) CALIGNED;
      351     4097        /**/
      352     4098    1   DCL 1 IF_LINE STATIC CALIGNED,
      353     4099    1         2 *         CHAR(01) UNAL INIT('A'),
      354     4100    1         2 SYSID     CHAR(06) UNAL,
      355     4101    1         2 *         CHAR(01) UNAL INIT(' '),
      356     4102    1         2 ACCT      CHAR(08) UNAL,
      357     4103    1         2 *         CHAR(01) UNAL INIT(' '),
      358     4104    1         2 UNAME     CHAR(12) UNAL,
      359     4105    1         2 *         CHAR(01) UNAL INIT(' '),
      360     4106    1         2 SUBTIME   CHAR(05) UNAL,
      361     4107    1         2 *         CHAR(01) UNAL INIT(' '),
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:65   
      362     4108    1         2 SUBDATE   UNAL,
      363     4109    1           3 M CHAR(2) UNAL,
      364     4110    1           3 D CHAR(2) UNAL,
      365     4111    1           3 Y CHAR(2) UNAL,
      366     4112    1         2 *         CHAR(01) UNAL INIT(' '),
      367     4113    1         2 CFLG      CHAR(05) UNAL,
      368     4114    1         2 FLG REDEF CFLG UNAL,
      369     4115    1           3 O CHAR(1) UNAL,
      370     4116    1           3 A CHAR(1) UNAL,
      371     4117    1           3 N CHAR(1) UNAL,
      372     4118    1           3 F CHAR(1) UNAL,
      373     4119    1           3 D CHAR(1) UNAL,
      374     4120    1         2 *         CHAR(01) UNAL INIT(' '),
      375     4121    1         2 WOO       CHAR(08) UNAL,
      376     4122    1         2 *         CHAR(01) UNAL INIT(' '),
      377     4123    1         2 MEM       CHAR(03) UNAL,
      378     4124    1         2 *         CHAR(01) UNAL INIT(' '),
      379     4125    1         2 CTIM      CHAR(10) UNAL,
      380     4126    1         2 TIM REDEF CTIM UNAL,
      381     4127    1           3 H CHAR(4) UNAL,
      382     4128    1           3 * CHAR(1) UNAL,
      383     4129    1           3 M CHAR(2) UNAL,
      384     4130    1           3 * CHAR(1) UNAL,
      385     4131    1           3 S CHAR(2) UNAL,
      386     4132    1         2 *         CHAR(01) UNAL INIT(' '),
      387     4133    1         2 CPART     CHAR(16) UNAL,
      388     4134    1         2 PARTS (0:15) REDEF CPART CHAR(1) UNAL,
      389     4135    1         2 RUNNING_PART REDEF CPART UNAL,
      390     4136    1           3 * CHAR(1) UNAL,
      391     4137    1           3 PART CHAR(2) UNAL,
      392     4138    1           3 * CHAR(1) UNAL,
      393     4139    1           3 START_TIME UNAL,
      394     4140    1             4 HHMM CHAR(5) UNAL,
      395     4141    1             4 * CHAR(1) UNAL,
      396     4142    1             4 DATE UNAL,
      397     4143    1               5 M CHAR(2) UNAL,
      398     4144    1               5 D CHAR(2) UNAL,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:66   
      399     4145    1               5 Y CHAR(2) UNAL,
      400     4146    1         2 *         CHAR(02) UNAL INIT(' '),
      401     4147    1         2 PRIO      CHAR(02) UNAL,
      402     4148    1         2 *         CHAR(01) UNAL INIT(' '),
      403     4149    1         2 CSTATUS UNAL,
      404     4150    1           3 * CHAR(6) UNAL INIT(' '),
      405     4151    1         2 *         CHAR(01) UNAL INIT(' '),
      406     4152    1         2 JNAME     CHAR(31) UNAL;
      407     4153    1   DCL LOBUF CHAR(ODMI_LPMX#) STATIC DALIGNED INIT('A');
      408     4154    1   DCL NUMEXTS (0:9) CHAR(2) STATIC ALIGNED INIT('th','st','nd','rd','th'*0);
      409     4155    1   DCL TEEN_NUMEXTS (0:9) CHAR(2) STATIC ALIGNED INIT('th'*0);
      410     4156    1   DCL 1 EDITCTL CONSTANT ALIGNED,
      411     4157    1         2 * BIT(9) UNAL INIT(%MVZB7),
      412     4158    1         2 * BIT(9) UNAL INIT(%MVC1);
      413     4159    1   DCL 1 EDITCTL2 CONSTANT ALIGNED,
      414     4160    1         2 * BIT(9) UNAL INIT(%MVZB6),
      415     4161    1         2 * BIT(9) UNAL INIT(%MVC2);
      416     4162    1   DCL 1 EDITCTLS (0:8) CONSTANT ALIGNED,
      417     4163    1         2 * BIT(9) UNAL INIT('0'B,%MVC1,%MVZB1,%MVZB2,%MVZB3,%MVZB4,
      418     4164    1           %MVZB5,%MVZB6,%MVZB7),
      419     4165    1         2 * BIT(9) UNAL INIT(%MVC1*0);
      420     4166    1   DCL TXRELATIONS (0:5) CHAR(2) STATIC ALIGNED INIT('<','<=','=','~=','>=','>');
      421     4167    1   DCL OBUF CHAR(256) STATIC DALIGNED;
      422     4168    1   DCL TXNUM CHAR(8) STATIC DALIGNED;
      423     4169    1   DCL TXSTR CHAR(32) STATIC DALIGNED;
      424     4170    1   DCL 1 TXSTRR REDEF TXSTR DALIGNED,
      425     4171    1         2 TOP CHAR(24) UNAL,
      426     4172    1         2 BOT CHAR(08) UNAL;
      427     4173    1   DCL TXSTR$ PTR STATIC ALIGNED INIT(ADDR(TXSTR));
      428     4174        %EQU   NUM_ATTRS = 14;
      429     4175    1   DCL 1 ATTRTAB (0:%NUM_ATTRS) CONSTANT ALIGNED,
      430     4176    1         2 ABIT BIT(18) UNAL INIT(%ATTR_D6250#,%ATTR_D1600#,%ATTR_D800#,
      431     4177    1                                  %ATTR_D38000#,
      432     4178    1                                  %ATTR_DD200#,%ATTR_DD500#,%ATTR_DD600#,
      433     4179    1                                  %ATTR_DD1000#,%ATTR_DD1500#,
      434     4180    1                                  %ATTR_DD400#,%ATTR_DD1100#,
      435     4181    1                                  %ATTR_TRUOVRPRT#,%ATTR_APL#,%ATTR_BIN#,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:67   
      436     4182    1                                  %ATTR_LOWERCASE#),
      437     4183    1         2 STR CHAR(5) UNAL INIT('6250','1600','800','38000',
      438     4184    1                                 '200M','500M','600M',
      439     4185    1                                 '1000','1500','400','1100',
      440     4186    1                                 'OVR','APL','BIN','LC');
      441     4187
      442     4188        /* ** the following constants DEPEND on the size, and order of the */
      443     4189        /*    ATTRTAB array above.  They are the MIN and MAX index values   */
      444     4190        %EQU MT_MIN =  0;
      445     4191        %EQU MT_MAX =  3;
      446     4192        %EQU DP_MIN =  4;
      447     4193        %EQU DP_MAX = 10;
      448     4194        %EQU LP_MIN = 11;
      449     4195        %EQU LP_MAX = 14;    /* this should be NUM_ATTRS# !! */
      450     4196        %SUB TRUE = '1'B;
      451     4197        %SUB FALSE = '0'B;
      452     4198    1   DCL ADD_RES_ATTR BIT(1);   /* FLAG used to display res, if attr fits*/
      453     4199
      454     4200        %OC_MESSHD_D            (NAME=OPMSG_UFMT,
      455     4201            NPARMS    = 1,
      456     4202            ATR       = M_UR,
      457     4203            MSG       = OD_UFMT_MSG#,
      458     4204            STCLASS   = STATIC);
      459     4217    1         2 BUFL UBIN BYTE UNAL INIT(0),
      460     4218    1         2 BUF CHAR(ODMI_OBSZ#);
      461     4219
      462     4220
      463     4221
      464     4222        /**/
      465     4223        /* DCBS */
      466     4224        /**/
      467     4225    1   DCL M$CSCG DCB;
      468     4226    1   DCL M$LO DCB;
      469     4227    1   DCL M$ME DCB;
      470     4228
      471     4229
      472     4230
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:68   
      473     4231        /**/
      474     4232        /* REFS */
      475     4233        /**/
      476     4234    1   DCL B$TCB$ PTR SYMREF;
      477     4235    1   DCL B$JIT$ PTR SYMREF;
      478     4236
      479     4237
      480     4238
      481     4239        /**/
      482     4240        /* PMME FPTS */
      483     4241        /**/
      484     4242        %FPT_WRITE                             (FPTN=OCMSG_UFMT,
      485     4243                 BUF       = OPMSG_UFMT,
      486     4244                 DCB       = M$CSCG,
      487     4245                 STCLASS   = STATIC);
      488     4276        %FPT_TIME                              (FPTN=GET_TIME,
      489     4277                 DEST      = LOCAL,
      490     4278                 SOURCE    = UTS,
      491     4279                 TSTAMP    = INUTS,
      492     4280                 DATE      = OUTDATE,
      493     4281                 TIME      = OUTTIME);
      494     4300        %FPT_WRITE                             (FPTN=WRITE_LO,
      495     4301                 DCB       = M$LO,
      496     4302                 BUF       = LOBUF,
      497     4303                 VFC       = YES,
      498     4304                 STCLASS   = STATIC);
      499     4335        %FPT_WRITE                             (FPTN=WRITE_OLINE,
      500     4336                 DCB       = M$LO,
      501     4337                 VFC       = YES,
      502     4338                 BUF       = OF_LINE,
      503     4339                 STCLASS   = CONSTANT);
      504     4370        %FPT_DEVICE                            (FPTN=SET_HDR,
      505     4371                 DCB       = M$LO,
      506     4372                 HDR       = HDRVLP,
      507     4373                 PAGE      = YES,
      508     4374                 STCLASS   = CONSTANT);
      509     4392        %FPT_WRITE                             (FPTN=WRITE_ILINE,
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:69   
      510     4393                 DCB       = M$LO,
      511     4394                 VFC       = YES,
      512     4395                 BUF       = IF_LINE,
      513     4396                 STCLASS   = CONSTANT);
      514     4427        %FPT_WRITE                             (FPTN=WRITE_ME,
      515     4428                 STCLASS   = STATIC,
      516     4429                 DCB       = M$ME,
      517     4430                 VFC       = NO);
      518     4461        %FPT_DISPLAY                          (FPTN=FPT_DISPLAY,
      519     4462                 RESULTS   = VLR_DISPLAY,
      520     4463                 STCLASS   = CONSTANT);
      521     4476
      522     4477
      523     4478
      524     4479        /**/
      525     4480        /* SUBS */
      526     4481        /**/
      527     4482        %SUB B$ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE;
      528     4483        %EJECT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:70   
      529     4484
      530     4485        /**/
      531     4486        /* BEGIN HERE */
      532     4487        /**/
      533     4488
      534     4489
      535     4490    1         OPMSG_UFMT.CADDR=OD_CXT.CADDR;

   4490  6 000002   000006 720000 xsym               LXL0    OD_CXT+6
         6 000003   000613 740000 1                  STX0    OPMSG_UFMT

      536     4491    1         LEN=0;

   4491  6 000004   200013 450100                    STZ     LEN,,AUTO

      537     4492    1         IF OD_CXT.ONLP = 0 THEN

   4492  6 000005   000007 221000 xsym               LDX1    OD_CXT+7
         6 000006   001534 601000 6                  TNZ     s:5208

      538     4493    2           DO;

      539     4494
      540     4495        /**
      541     4496
      542     4497            CCC    OOO   N   N   SSS    OOO   L      EEEEE
      543     4498           C   C  O O O  N   N  S   S  O O O  L      E
      544     4499           C      O O O  NN  N  S      O O O  L      E
      545     4500           C      O  OO  N N N   SSS   O  OO  L      EEEE
      546     4501           C      O   O  N  NN      S  O   O  L      E
      547     4502           C   C  O   O  N   N  S   S  O   O  L      E
      548     4503            CCC    OOO   N   N   SSS    OOO   LLLLL  EEEEE
      549     4504
      550     4505
      551     4506           DDDD    III    SSS   PPPP   L       AAA   Y   Y
      552     4507           D   D    I    S   S  P   P  L      A   A  Y   Y
      553     4508           D   D    I    S      P   P  L      A   A   Y Y
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:71   
      554     4509           D   D    I     SSS   PPPP   L      AAAAA    Y
      555     4510           D   D    I        S  P      L      A   A    Y
      556     4511           D   D    I    S   S  P      L      A   A    Y
      557     4512           DDDD    III    SSS   P      LLLLL  A   A    Y
      558     4513
      559     4514         **/
      560     4515
      561     4516    2           TLEN=0;

   4516  6 000007   200012 450100                    STZ     TLEN,,AUTO

      562     4517
      563     4518
      564     4519    3             DO CASE ( DISPLAY_TYPE );

   4519  6 000010   200003 470500                    LDP0    @DISPLAY_TYPE,,AUTO
         6 000011   000000 235100                    LDA     0,,PR0
         6 000012   000011 115007                    CMPA    9,DL
         6 000013   000015 602005 6                  TNC     s:4519+5,AL
         6 000014   001527 710000 6                  TRA     s:5177
         6 000015   001112 710000 6                  TRA     s:4977
         6 000016   000026 710000 6                  TRA     s:4525
         6 000017   001407 710000 6                  TRA     s:5122
         6 000020   001407 710000 6                  TRA     s:5122
         6 000021   001425 710000 6                  TRA     s:5131
         6 000022   001443 710000 6                  TRA     s:5140
         6 000023   001134 710000 6                  TRA     s:4988
         6 000024   001134 710000 6                  TRA     s:4988
         6 000025   000054 710000 6                  TRA     s:4538

      565     4520
      566     4521
      567     4522                                /* FULL SYSID DISPLAY */
      568     4523    3               CASE (ODFT_SYSID#);

      569     4524
      570     4525    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:72   

   4525  6 000026   000001 236000 xsym               LDQ     OD_CXT+1
         6 000027   000005 736000                    QLS     5
         6 000030   000000 376000 7                  ANQ     0
         6 000031   000023 736000                    QLS     19
         6 000032   000002 036003                    ADLQ    2,DU
         6 000033   000000 036000 xsym               ADLQ    OD_CXT
         6 000034   200007 756100                    STQ     BUF$,,AUTO

      571     4526    3                 CALL FMT_SYSID;

   4526  6 000035   003165 701000 6                  TSX1    FMT_SYSID
         6 000036   000000 011000                    NOP     0

      572     4527    3                 CALL FMT_JA;

   4527  6 000037   003247 701000 6                  TSX1    FMT_JA
         6 000040   000000 011000                    NOP     0

      573     4528    3                 CALL FMT_OAN;

   4528  6 000041   003437 701000 6                  TSX1    FMT_OAN
         6 000042   000000 011000                    NOP     0

      574     4529    3                 CALL FMT_WW;

   4529  6 000043   003361 701000 6                  TSX1    FMT_WW
         6 000044   000000 011000                    NOP     0

      575     4530    3                 CALL FMT_POS;

   4530  6 000045   003515 701000 6                  TSX1    FMT_POS
         6 000046   000000 011000                    NOP     0

      576     4531    3                 CALL FMT_RQL;

   4531  6 000047   004366 701000 6                  TSX1    FMT_RQL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:73   
         6 000050   000000 011000                    NOP     0

      577     4532    3                 CALL FMT_FOL;

   4532  6 000051   004125 701000 6                  TSX1    FMT_FOL
         6 000052   000000 011000                    NOP     0
         6 000053   001527 710000 6                  TRA     s:5177

      578     4533
      579     4534
      580     4535                                /* SYSID DISPLAY FROM :JOBSTATS FILE */
      581     4536    3               CASE (ODFT_JSFID#);

      582     4537
      583     4538    3                 BUF$=OD_CXT.SEG$;

   4538  6 000054   000000 236000 xsym               LDQ     OD_CXT
         6 000055   200007 756100                    STQ     BUF$,,AUTO

      584     4539                      %ADDSTR (S=' Sysid ');

   4541  6 000056   200013 235100                    LDA     LEN,,AUTO
         6 000057   040005 100400                    MLR     fill='040'O
         6 000060   000246 000007 2                  ADSC9   FPT_DISPLAY+2            cn=0,n=7
         6 000061   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   4542  6 000062   000007 236007                    LDQ     7,DL
         6 000063   200013 056100                    ASQ     LEN,,AUTO

      585     4544                      %ADDNUM (N="OD_CXT.SYSID");

   4546  6 000064   000010 236000 xsym               LDQ     OD_CXT+8
         6 000065   777777 376007                    ANQ     -1,DL
         6 000066   000000 235003                    LDA     0,DU
         6 000067   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 000070   000000 301500                    BTD
         6 000071   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:74   
         6 000072   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   4547  6 000073   005304 701000 6                  TSX1    INS_NUM
         6 000074   000000 011000                    NOP     0

      586     4549                      %ADDSTR (S="' ('");

   4551  6 000075   200013 235100                    LDA     LEN,,AUTO
         6 000076   040005 100400                    MLR     fill='040'O
         6 000077   000250 000002 2                  ADSC9   FPT_DISPLAY+4            cn=0,n=2
         6 000100   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4552  6 000101   000002 236007                    LDQ     2,DL
         6 000102   200013 056100                    ASQ     LEN,,AUTO

      587     4554                      %ADDTXT (T="BUF$->XSJ$JOBINFO.ACCT#");

   4556  6 000103   200007 470500                    LDP0    BUF$,,AUTO
         6 000104   040000 100500                    MLR     fill='040'O
         6 000105   000003 000010                    ADSC9   3,,PR0                   cn=0,n=8
         6 000106   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   4557  6 000107   005357 701000 6                  TSX1    INS_TXT
         6 000110   000000 011000                    NOP     0

      588     4559                      %ADDSTR (S="') '");

   4561  6 000111   200013 235100                    LDA     LEN,,AUTO
         6 000112   040005 100400                    MLR     fill='040'O
         6 000113   000251 000002 2                  ADSC9   FPT_DISPLAY+5            cn=0,n=2
         6 000114   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4562  6 000115   000002 236007                    LDQ     2,DL
         6 000116   200013 056100                    ASQ     LEN,,AUTO

      589     4564    4                   DO CASE (BUF$->XSJ$JOBINFO.STATUS#);

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:75   
   4564  6 000117   200007 470500                    LDP0    BUF$,,AUTO
         6 000120   000000 236100                    LDQ     0,,PR0
         6 000121   000777 376007                    ANQ     511,DL
         6 000122   000036 136007                    SBLQ    30,DL
         6 000123   000036 116007                    CMPQ    30,DL
         6 000124   000126 602006 6                  TNC     s:4564+7,QL
         6 000125   001046 710000 6                  TRA     s:4944
         6 000126   000164 710000 6                  TRA     s:4569
         6 000127   000173 710000 6                  TRA     s:4576
         6 000130   000202 710000 6                  TRA     s:4583
         6 000131   000211 710000 6                  TRA     s:4590
         6 000132   001046 710000 6                  TRA     s:4944
         6 000133   001046 710000 6                  TRA     s:4944
         6 000134   001046 710000 6                  TRA     s:4944
         6 000135   001046 710000 6                  TRA     s:4944
         6 000136   001046 710000 6                  TRA     s:4944
         6 000137   001046 710000 6                  TRA     s:4944
         6 000140   000220 710000 6                  TRA     s:4597
         6 000141   000227 710000 6                  TRA     s:4604
         6 000142   000236 710000 6                  TRA     s:4611
         6 000143   000252 710000 6                  TRA     s:4623
         6 000144   000266 710000 6                  TRA     s:4635
         6 000145   000302 710000 6                  TRA     s:4647
         6 000146   000316 710000 6                  TRA     s:4659
         6 000147   000325 710000 6                  TRA     s:4666
         6 000150   000334 710000 6                  TRA     s:4673
         6 000151   000343 710000 6                  TRA     s:4680
         6 000152   000352 710000 6                  TRA     s:4687
         6 000153   001046 710000 6                  TRA     s:4944
         6 000154   001046 710000 6                  TRA     s:4944
         6 000155   001046 710000 6                  TRA     s:4944
         6 000156   001046 710000 6                  TRA     s:4944
         6 000157   001046 710000 6                  TRA     s:4944
         6 000160   001046 710000 6                  TRA     s:4944
         6 000161   000361 710000 6                  TRA     s:4694
         6 000162   000370 710000 6                  TRA     s:4699
         6 000163   001037 710000 6                  TRA     s:4937
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:76   

      590     4565
      591     4566    4                     CASE (%MBS_DELETED#);

      592     4567                            %ADDSTR (S='deleted by operator');

   4569  6 000164   200013 235100                    LDA     LEN,,AUTO
         6 000165   040005 100400                    MLR     fill='040'O
         6 000166   000252 000023 2                  ADSC9   FPT_DISPLAY+6            cn=0,n=19
         6 000167   000500 000023 1                  ADSC9   OBUF,A                   cn=0,n=19

   4570  6 000170   000023 236007                    LDQ     19,DL
         6 000171   200013 056100                    ASQ     LEN,,AUTO
         6 000172   001054 710000 6                  TRA     s:4952

      593     4572
      594     4573    4                     CASE (%MBS_CANCELED#);

      595     4574                            %ADDSTR (S='cancelled');

   4576  6 000173   200013 235100                    LDA     LEN,,AUTO
         6 000174   040005 100400                    MLR     fill='040'O
         6 000175   000257 000011 2                  ADSC9   FPT_DISPLAY+11           cn=0,n=9
         6 000176   000500 000011 1                  ADSC9   OBUF,A                   cn=0,n=9

   4577  6 000177   000011 236007                    LDQ     9,DL
         6 000200   200013 056100                    ASQ     LEN,,AUTO
         6 000201   001054 710000 6                  TRA     s:4952

      596     4579
      597     4580    4                     CASE (%MBS_SHAFTED#);

      598     4581                            %ADDSTR (S='deleted for FOLLOW condition');

   4583  6 000202   200013 235100                    LDA     LEN,,AUTO
         6 000203   040005 100400                    MLR     fill='040'O
         6 000204   000262 000034 2                  ADSC9   FPT_DISPLAY+14           cn=0,n=28
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:77   
         6 000205   000500 000034 1                  ADSC9   OBUF,A                   cn=0,n=28

   4584  6 000206   000034 236007                    LDQ     28,DL
         6 000207   200013 056100                    ASQ     LEN,,AUTO
         6 000210   001054 710000 6                  TRA     s:4952

      599     4586
      600     4587    4                     CASE (%PRE_PASSED#);

      601     4588                            %ADDSTR (S='passed PRESCAN successfully');

   4590  6 000211   200013 235100                    LDA     LEN,,AUTO
         6 000212   040005 100400                    MLR     fill='040'O
         6 000213   000271 000033 2                  ADSC9   FPT_DISPLAY+21           cn=0,n=27
         6 000214   000500 000033 1                  ADSC9   OBUF,A                   cn=0,n=27

   4591  6 000215   000033 236007                    LDQ     27,DL
         6 000216   200013 056100                    ASQ     LEN,,AUTO
         6 000217   001054 710000 6                  TRA     s:4952

      602     4593
      603     4594    4                     CASE (%REJ_JOB#);

      604     4595                            %ADDSTR (S='rejected - bad !JOB');

   4597  6 000220   200013 235100                    LDA     LEN,,AUTO
         6 000221   040005 100400                    MLR     fill='040'O
         6 000222   000300 000023 2                  ADSC9   FPT_DISPLAY+28           cn=0,n=19
         6 000223   000500 000023 1                  ADSC9   OBUF,A                   cn=0,n=19

   4598  6 000224   000023 236007                    LDQ     19,DL
         6 000225   200013 056100                    ASQ     LEN,,AUTO
         6 000226   001054 710000 6                  TRA     s:4952

      605     4600
      606     4601    4                     CASE (%REJ_RES#);

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:78   
      607     4602                            %ADDSTR (S='rejected - bad !RES');

   4604  6 000227   200013 235100                    LDA     LEN,,AUTO
         6 000230   040005 100400                    MLR     fill='040'O
         6 000231   000305 000023 2                  ADSC9   FPT_DISPLAY+33           cn=0,n=19
         6 000232   000500 000023 1                  ADSC9   OBUF,A                   cn=0,n=19

   4605  6 000233   000023 236007                    LDQ     19,DL
         6 000234   200013 056100                    ASQ     LEN,,AUTO
         6 000235   001054 710000 6                  TRA     s:4952

      608     4607
      609     4608    4                     CASE (%REJ_SYNTAX#);

      610     4609                            %ADDSTR (S='rejected - bad syntax at record ');

   4611  6 000236   200013 235100                    LDA     LEN,,AUTO
         6 000237   040005 100400                    MLR     fill='040'O
         6 000240   000312 000040 2                  ADSC9   FPT_DISPLAY+38           cn=0,n=32
         6 000241   000500 000040 1                  ADSC9   OBUF,A                   cn=0,n=32

   4612  6 000242   000040 236007                    LDQ     32,DL
         6 000243   200013 056100                    ASQ     LEN,,AUTO

      611     4614                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");

   4616  6 000244   000000 301500                    BTD
         6 000245   000001 000004                    NDSC9   1,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         6 000246   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   4617  6 000247   005304 701000 6                  TSX1    INS_NUM
         6 000250   000000 011000                    NOP     0
         6 000251   001054 710000 6                  TRA     s:4952

      612     4619
      613     4620    4                     CASE (%REJ_IO#);

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:79   
      614     4621                            %ADDSTR (S='rejected - I/O error at record ');

   4623  6 000252   200013 235100                    LDA     LEN,,AUTO
         6 000253   040005 100400                    MLR     fill='040'O
         6 000254   000322 000037 2                  ADSC9   FPT_DISPLAY+46           cn=0,n=31
         6 000255   000500 000037 1                  ADSC9   OBUF,A                   cn=0,n=31

   4624  6 000256   000037 236007                    LDQ     31,DL
         6 000257   200013 056100                    ASQ     LEN,,AUTO

      615     4626                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");

   4628  6 000260   000000 301500                    BTD
         6 000261   000001 000004                    NDSC9   1,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         6 000262   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   4629  6 000263   005304 701000 6                  TSX1    INS_NUM
         6 000264   000000 011000                    NOP     0
         6 000265   001054 710000 6                  TRA     s:4952

      616     4631
      617     4632    4                     CASE (%REJ_JOBIMBED#);

      618     4633                            %ADDSTR (S='rejected - imbedded !JOB at record ');

   4635  6 000266   200013 235100                    LDA     LEN,,AUTO
         6 000267   040005 100400                    MLR     fill='040'O
         6 000270   000332 000043 2                  ADSC9   FPT_DISPLAY+54           cn=0,n=35
         6 000271   000500 000043 1                  ADSC9   OBUF,A                   cn=0,n=35

   4636  6 000272   000043 236007                    LDQ     35,DL
         6 000273   200013 056100                    ASQ     LEN,,AUTO

      619     4638                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");

   4640  6 000274   000000 301500                    BTD
         6 000275   000001 000004                    NDSC9   1,,PR0                   cn=0,s=lsgnf,sf=0,n=4
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:80   
         6 000276   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   4641  6 000277   005304 701000 6                  TSX1    INS_NUM
         6 000300   000000 011000                    NOP     0
         6 000301   001054 710000 6                  TRA     s:4952

      620     4643
      621     4644    4                     CASE (%REJ_RESIMBED#);                                   /*#B00*/

      622     4645                            %ADDSTR (S='rejected - imbedded !RES at record ');     /*#B00*/

   4647  6 000302   200013 235100                    LDA     LEN,,AUTO
         6 000303   040005 100400                    MLR     fill='040'O
         6 000304   000343 000043 2                  ADSC9   FPT_DISPLAY+63           cn=0,n=35
         6 000305   000500 000043 1                  ADSC9   OBUF,A                   cn=0,n=35

   4648  6 000306   000043 236007                    LDQ     35,DL
         6 000307   200013 056100                    ASQ     LEN,,AUTO

      623     4650                            %ADDNUM (N="BUF$->XSJ$JOBINFO.RECNO#");                /*#B00*/

   4652  6 000310   000000 301500                    BTD
         6 000311   000001 000004                    NDSC9   1,,PR0                   cn=0,s=lsgnf,sf=0,n=4
         6 000312   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   4653  6 000313   005304 701000 6                  TSX1    INS_NUM
         6 000314   000000 011000                    NOP     0
         6 000315   001054 710000 6                  TRA     s:4952

      624     4655
      625     4656    4                     CASE (%REJ_BADID#);

      626     4657                            %ADDSTR (S='rejected - bad ID');

   4659  6 000316   200013 235100                    LDA     LEN,,AUTO
         6 000317   040005 100400                    MLR     fill='040'O
         6 000320   000354 000021 2                  ADSC9   FPT_DISPLAY+72           cn=0,n=17
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:81   
         6 000321   000500 000021 1                  ADSC9   OBUF,A                   cn=0,n=17

   4660  6 000322   000021 236007                    LDQ     17,DL
         6 000323   200013 056100                    ASQ     LEN,,AUTO
         6 000324   001054 710000 6                  TRA     s:4952

      627     4662
      628     4663    4                     CASE (%REJ_NORES#);

      629     4664                            %ADDSTR (S='rejected - lack of resources');

   4666  6 000325   200013 235100                    LDA     LEN,,AUTO
         6 000326   040005 100400                    MLR     fill='040'O
         6 000327   000361 000034 2                  ADSC9   FPT_DISPLAY+77           cn=0,n=28
         6 000330   000500 000034 1                  ADSC9   OBUF,A                   cn=0,n=28

   4667  6 000331   000034 236007                    LDQ     28,DL
         6 000332   200013 056100                    ASQ     LEN,,AUTO
         6 000333   001054 710000 6                  TRA     s:4952

      630     4669
      631     4670    4                     CASE (%REJ_PRESCAN#);

      632     4671                            %ADDSTR (S='rejected - PRESCAN problem');

   4673  6 000334   200013 235100                    LDA     LEN,,AUTO
         6 000335   040005 100400                    MLR     fill='040'O
         6 000336   000370 000032 2                  ADSC9   FPT_DISPLAY+84           cn=0,n=26
         6 000337   000500 000032 1                  ADSC9   OBUF,A                   cn=0,n=26

   4674  6 000340   000032 236007                    LDQ     26,DL
         6 000341   200013 056100                    ASQ     LEN,,AUTO
         6 000342   001054 710000 6                  TRA     s:4952

      633     4676
      634     4677    4                     CASE (%REJ_NOBATCH#);

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:82   
      635     4678                            %ADDSTR (S='rejected - user not authorized for batch');

   4680  6 000343   200013 235100                    LDA     LEN,,AUTO
         6 000344   040005 100400                    MLR     fill='040'O
         6 000345   000377 000050 2                  ADSC9   FPT_DISPLAY+91           cn=0,n=40
         6 000346   000500 000050 1                  ADSC9   OBUF,A                   cn=0,n=40

   4681  6 000347   000050 236007                    LDQ     40,DL
         6 000350   200013 056100                    ASQ     LEN,,AUTO
         6 000351   001054 710000 6                  TRA     s:4952

      636     4683
      637     4684    4                     CASE (%MBS_FILERR#);

      638     4685                            %ADDSTR (S='aborted by MBS - bad job file');

   4687  6 000352   200013 235100                    LDA     LEN,,AUTO
         6 000353   040005 100400                    MLR     fill='040'O
         6 000354   000411 000035 2                  ADSC9   FPT_DISPLAY+101          cn=0,n=29
         6 000355   000500 000035 1                  ADSC9   OBUF,A                   cn=0,n=29

   4688  6 000356   000035 236007                    LDQ     29,DL
         6 000357   200013 056100                    ASQ     LEN,,AUTO
         6 000360   001054 710000 6                  TRA     s:4952

      639     4690
      640     4691    4                     CASE (%FIN_RECOVER#);

      641     4692                            %ADDSTR (S='caught by system recovery');

   4694  6 000361   200013 235100                    LDA     LEN,,AUTO
         6 000362   040005 100400                    MLR     fill='040'O
         6 000363   000421 000031 2                  ADSC9   FPT_DISPLAY+109          cn=0,n=25
         6 000364   000500 000031 1                  ADSC9   OBUF,A                   cn=0,n=25

   4695  6 000365   000031 236007                    LDQ     25,DL
         6 000366   200013 056100                    ASQ     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:83   
         6 000367   001054 710000 6                  TRA     s:4952

      642     4697
      643     4698    4                     CASE (%FIN_ABNORMAL#);

      644     4699    4                       IF BUF$->XSJ$JOBINFO.XLIMFLG# THEN

   4699  6 000370   000000 236100                    LDQ     0,,PR0
         6 000371   000777 316003                    CANQ    511,DU
         6 000372   000660 600000 6                  TZE     s:4872

      645     4700    5                         DO;

      646     4701                              %ADDSTR (S="'aborted - '");

   4703  6 000373   200013 235100                    LDA     LEN,,AUTO
         6 000374   040005 100400                    MLR     fill='040'O
         6 000375   000430 000012 2                  ADSC9   FPT_DISPLAY+116          cn=0,n=10
         6 000376   000500 000012 1                  ADSC9   OBUF,A                   cn=0,n=10

   4704  6 000377   000012 236007                    LDQ     10,DL
         6 000400   200013 056100                    ASQ     LEN,,AUTO

      647     4706    5                         LIMITS_HIT=0;

   4706  6 000401   200014 450100                    STZ     LIMITS_HIT,,AUTO

      648     4707    5                         XCON.LIMIT=BUF$->XSJ$JOBINFO.XLIMFLG#;

   4707  6 000402   000000 236100                    LDQ     0,,PR0
         6 000403   000011 772000                    QRL     9
         6 000404   000257 552010 1                  STBQ    XCON+65,'10'O

      649     4708    5                         IF XCON.LIMIT.PO THEN

   4708  6 000405   000257 236000 1                  LDQ     XCON+65
         6 000406   400000 316007                    CANQ    -131072,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:84   
         6 000407   000417 600000 6                  TZE     s:4717

      650     4709    6                           DO;

      651     4710                                %ADDSTR (S='PO');

   4712  6 000410   200013 235100                    LDA     LEN,,AUTO
         6 000411   040005 100400                    MLR     fill='040'O
         6 000412   000433 000002 2                  ADSC9   FPT_DISPLAY+119          cn=0,n=2
         6 000413   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4713  6 000414   000002 236007                    LDQ     2,DL
         6 000415   200013 056100                    ASQ     LEN,,AUTO

      652     4715    6                           LIMITS_HIT=LIMITS_HIT+1;

   4715  6 000416   200014 054100                    AOS     LIMITS_HIT,,AUTO

      653     4716    6                           END;

      654     4717    5                         IF XCON.LIMIT.TIME THEN

   4717  6 000417   000257 236000 1                  LDQ     XCON+65
         6 000420   001000 316007                    CANQ    512,DL
         6 000421   000441 600000 6                  TZE     s:4734

      655     4718    6                           DO;

      656     4719    6                           IF LIMITS_HIT > 0 THEN

   4719  6 000422   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000423   000432 604400 6                  TMOZ    s:4729

      657     4720    7                             DO;

      658     4721                                  %ADDSTR (S="', '");

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:85   
   4723  6 000424   200013 235100                    LDA     LEN,,AUTO
         6 000425   040005 100400                    MLR     fill='040'O
         6 000426   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000427   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4724  6 000430   000002 236007                    LDQ     2,DL
         6 000431   200013 056100                    ASQ     LEN,,AUTO

      659     4726    7                             END;

      660     4727                                %ADDSTR (S='TIME');

   4729  6 000432   200013 235100                    LDA     LEN,,AUTO
         6 000433   040005 100400                    MLR     fill='040'O
         6 000434   000435 000004 2                  ADSC9   FPT_DISPLAY+121          cn=0,n=4
         6 000435   000500 000004 1                  ADSC9   OBUF,A                   cn=0,n=4

   4730  6 000436   000004 236007                    LDQ     4,DL
         6 000437   200013 056100                    ASQ     LEN,,AUTO

      661     4732    6                           LIMITS_HIT=LIMITS_HIT+1;

   4732  6 000440   200014 054100                    AOS     LIMITS_HIT,,AUTO

      662     4733    6                           END;

      663     4734    5                         IF XCON.LIMIT.PLO THEN

   4734  6 000441   000257 236000 1                  LDQ     XCON+65
         6 000442   200000 316007                    CANQ    65536,DL
         6 000443   000463 600000 6                  TZE     s:4751

      664     4735    6                           DO;

      665     4736    6                           IF LIMITS_HIT > 0 THEN

   4736  6 000444   200014 235100                    LDA     LIMITS_HIT,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:86   
         6 000445   000454 604400 6                  TMOZ    s:4746

      666     4737    7                             DO;

      667     4738                                  %ADDSTR (S="', '");

   4740  6 000446   200013 235100                    LDA     LEN,,AUTO
         6 000447   040005 100400                    MLR     fill='040'O
         6 000450   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000451   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4741  6 000452   000002 236007                    LDQ     2,DL
         6 000453   200013 056100                    ASQ     LEN,,AUTO

      668     4743    7                             END;

      669     4744                                %ADDSTR (S='PROC LO');

   4746  6 000454   200013 235100                    LDA     LEN,,AUTO
         6 000455   040005 100400                    MLR     fill='040'O
         6 000456   000436 000007 2                  ADSC9   FPT_DISPLAY+122          cn=0,n=7
         6 000457   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   4747  6 000460   000007 236007                    LDQ     7,DL
         6 000461   200013 056100                    ASQ     LEN,,AUTO

      670     4749    6                           LIMITS_HIT=LIMITS_HIT+1;

   4749  6 000462   200014 054100                    AOS     LIMITS_HIT,,AUTO

      671     4750    6                           END;

      672     4751    5                         IF XCON.LIMIT.LO THEN

   4751  6 000463   000257 236000 1                  LDQ     XCON+65
         6 000464   100000 316007                    CANQ    32768,DL
         6 000465   000505 600000 6                  TZE     s:4768
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:87   

      673     4752    6                           DO;

      674     4753    6                           IF LIMITS_HIT > 0 THEN

   4753  6 000466   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000467   000476 604400 6                  TMOZ    s:4763

      675     4754    7                             DO;

      676     4755                                  %ADDSTR (S="', '");

   4757  6 000470   200013 235100                    LDA     LEN,,AUTO
         6 000471   040005 100400                    MLR     fill='040'O
         6 000472   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000473   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4758  6 000474   000002 236007                    LDQ     2,DL
         6 000475   200013 056100                    ASQ     LEN,,AUTO

      677     4760    7                             END;

      678     4761                                %ADDSTR (S='LO');

   4763  6 000476   200013 235100                    LDA     LEN,,AUTO
         6 000477   040005 100400                    MLR     fill='040'O
         6 000500   000440 000002 2                  ADSC9   FPT_DISPLAY+124          cn=0,n=2
         6 000501   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4764  6 000502   000002 236007                    LDQ     2,DL
         6 000503   200013 056100                    ASQ     LEN,,AUTO

      679     4766    6                           LIMITS_HIT=LIMITS_HIT+1;

   4766  6 000504   200014 054100                    AOS     LIMITS_HIT,,AUTO

      680     4767    6                           END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:88   

      681     4768    5                         IF XCON.LIMIT.DGO THEN

   4768  6 000505   000257 236000 1                  LDQ     XCON+65
         6 000506   040000 316007                    CANQ    16384,DL
         6 000507   000527 600000 6                  TZE     s:4785

      682     4769    6                           DO;

      683     4770    6                           IF LIMITS_HIT > 0 THEN

   4770  6 000510   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000511   000520 604400 6                  TMOZ    s:4780

      684     4771    7                             DO;

      685     4772                                  %ADDSTR (S="', '");

   4774  6 000512   200013 235100                    LDA     LEN,,AUTO
         6 000513   040005 100400                    MLR     fill='040'O
         6 000514   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000515   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4775  6 000516   000002 236007                    LDQ     2,DL
         6 000517   200013 056100                    ASQ     LEN,,AUTO

      686     4777    7                             END;

      687     4778                                %ADDSTR (S='DIAG LO');

   4780  6 000520   200013 235100                    LDA     LEN,,AUTO
         6 000521   040005 100400                    MLR     fill='040'O
         6 000522   000441 000007 2                  ADSC9   FPT_DISPLAY+125          cn=0,n=7
         6 000523   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   4781  6 000524   000007 236007                    LDQ     7,DL
         6 000525   200013 056100                    ASQ     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:89   

      688     4783    6                           LIMITS_HIT=LIMITS_HIT+1;

   4783  6 000526   200014 054100                    AOS     LIMITS_HIT,,AUTO

      689     4784    6                           END;

      690     4785    5                         IF XCON.LIMIT.PDISK THEN

   4785  6 000527   000257 236000 1                  LDQ     XCON+65
         6 000530   020000 316007                    CANQ    8192,DL
         6 000531   000551 600000 6                  TZE     s:4802

      691     4786    6                           DO;

      692     4787    6                           IF LIMITS_HIT > 0 THEN

   4787  6 000532   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000533   000542 604400 6                  TMOZ    s:4797

      693     4788    7                             DO;

      694     4789                                  %ADDSTR (S="', '");

   4791  6 000534   200013 235100                    LDA     LEN,,AUTO
         6 000535   040005 100400                    MLR     fill='040'O
         6 000536   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000537   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4792  6 000540   000002 236007                    LDQ     2,DL
         6 000541   200013 056100                    ASQ     LEN,,AUTO

      695     4794    7                             END;

      696     4795                                %ADDSTR (S='PDISK');

   4797  6 000542   200013 235100                    LDA     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:90   
         6 000543   040005 100400                    MLR     fill='040'O
         6 000544   000443 000005 2                  ADSC9   FPT_DISPLAY+127          cn=0,n=5
         6 000545   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   4798  6 000546   000005 236007                    LDQ     5,DL
         6 000547   200013 056100                    ASQ     LEN,,AUTO

      697     4800    6                           LIMITS_HIT=LIMITS_HIT+1;

   4800  6 000550   200014 054100                    AOS     LIMITS_HIT,,AUTO

      698     4801    6                           END;

      699     4802    5                         IF XCON.LIMIT.TDISK THEN

   4802  6 000551   000257 236000 1                  LDQ     XCON+65
         6 000552   010000 316007                    CANQ    4096,DL
         6 000553   000573 600000 6                  TZE     s:4819

      700     4803    6                           DO;

      701     4804    6                           IF LIMITS_HIT > 0 THEN

   4804  6 000554   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000555   000564 604400 6                  TMOZ    s:4814

      702     4805    7                             DO;

      703     4806                                  %ADDSTR (S="', '");

   4808  6 000556   200013 235100                    LDA     LEN,,AUTO
         6 000557   040005 100400                    MLR     fill='040'O
         6 000560   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000561   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4809  6 000562   000002 236007                    LDQ     2,DL
         6 000563   200013 056100                    ASQ     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:91   

      704     4811    7                             END;

      705     4812                                %ADDSTR (S='TDISK');

   4814  6 000564   200013 235100                    LDA     LEN,,AUTO
         6 000565   040005 100400                    MLR     fill='040'O
         6 000566   000445 000005 2                  ADSC9   FPT_DISPLAY+129          cn=0,n=5
         6 000567   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   4815  6 000570   000005 236007                    LDQ     5,DL
         6 000571   200013 056100                    ASQ     LEN,,AUTO

      706     4817    6                           LIMITS_HIT=LIMITS_HIT+1;

   4817  6 000572   200014 054100                    AOS     LIMITS_HIT,,AUTO

      707     4818    6                           END;

      708     4819    5                         IF XCON.LIMIT.TAPE THEN

   4819  6 000573   000257 236000 1                  LDQ     XCON+65
         6 000574   004000 316007                    CANQ    2048,DL
         6 000575   000615 600000 6                  TZE     s:4836

      709     4820    6                           DO;

      710     4821    6                           IF LIMITS_HIT > 0 THEN

   4821  6 000576   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000577   000606 604400 6                  TMOZ    s:4831

      711     4822    7                             DO;

      712     4823                                  %ADDSTR (S="', '");

   4825  6 000600   200013 235100                    LDA     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:92   
         6 000601   040005 100400                    MLR     fill='040'O
         6 000602   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000603   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4826  6 000604   000002 236007                    LDQ     2,DL
         6 000605   200013 056100                    ASQ     LEN,,AUTO

      713     4828    7                             END;

      714     4829                                %ADDSTR (S='SCRATCH TAPE');

   4831  6 000606   200013 235100                    LDA     LEN,,AUTO
         6 000607   040005 100400                    MLR     fill='040'O
         6 000610   000447 000014 2                  ADSC9   FPT_DISPLAY+131          cn=0,n=12
         6 000611   000500 000014 1                  ADSC9   OBUF,A                   cn=0,n=12

   4832  6 000612   000014 236007                    LDQ     12,DL
         6 000613   200013 056100                    ASQ     LEN,,AUTO

      715     4834    6                           LIMITS_HIT=LIMITS_HIT+1;

   4834  6 000614   200014 054100                    AOS     LIMITS_HIT,,AUTO

      716     4835    6                           END;

      717     4836    5                         IF XCON.LIMIT.STACK THEN

   4836  6 000615   000257 236000 1                  LDQ     XCON+65
         6 000616   002000 316007                    CANQ    1024,DL
         6 000617   000637 600000 6                  TZE     s:4853

      718     4837    6                           DO;

      719     4838    6                           IF LIMITS_HIT > 0 THEN

   4838  6 000620   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000621   000630 604400 6                  TMOZ    s:4848
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:93   

      720     4839    7                             DO;

      721     4840                                  %ADDSTR (S="', '");

   4842  6 000622   200013 235100                    LDA     LEN,,AUTO
         6 000623   040005 100400                    MLR     fill='040'O
         6 000624   000434 000002 2                  ADSC9   FPT_DISPLAY+120          cn=0,n=2
         6 000625   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   4843  6 000626   000002 236007                    LDQ     2,DL
         6 000627   200013 056100                    ASQ     LEN,,AUTO

      722     4845    7                             END;

      723     4846                                %ADDSTR (S='SAFE STORE STACK');

   4848  6 000630   200013 235100                    LDA     LEN,,AUTO
         6 000631   040005 100400                    MLR     fill='040'O
         6 000632   000452 000020 2                  ADSC9   FPT_DISPLAY+134          cn=0,n=16
         6 000633   000500 000020 1                  ADSC9   OBUF,A                   cn=0,n=16

   4849  6 000634   000020 236007                    LDQ     16,DL
         6 000635   200013 056100                    ASQ     LEN,,AUTO

      724     4851    6                           LIMITS_HIT=LIMITS_HIT+1;

   4851  6 000636   200014 054100                    AOS     LIMITS_HIT,,AUTO

      725     4852    6                           END;

      726     4853    5                         IF LIMITS_HIT > 1 THEN

   4853  6 000637   200014 235100                    LDA     LIMITS_HIT,,AUTO
         6 000640   000001 115007                    CMPA    1,DL
         6 000641   000651 604400 6                  TMOZ    s:4865

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:94   
      727     4854    6                           DO;

      728     4855                                %ADDSTR (S="' limits exceeded'");

   4857  6 000642   200013 236100                    LDQ     LEN,,AUTO
         6 000643   040006 100400                    MLR     fill='040'O
         6 000644   000456 000020 2                  ADSC9   FPT_DISPLAY+138          cn=0,n=16
         6 000645   000500 000020 1                  ADSC9   OBUF,Q                   cn=0,n=16

   4858  6 000646   000020 236007                    LDQ     16,DL
         6 000647   200013 056100                    ASQ     LEN,,AUTO

      729     4860    6                           END;

   4860  6 000650   001054 710000 6                  TRA     s:4952

      730     4861    5                         ELSE
      731     4862    6                           DO;

      732     4863                                %ADDSTR (S="' limit exceeded'");

   4865  6 000651   200013 236100                    LDQ     LEN,,AUTO
         6 000652   040006 100400                    MLR     fill='040'O
         6 000653   000462 000017 2                  ADSC9   FPT_DISPLAY+142          cn=0,n=15
         6 000654   000500 000017 1                  ADSC9   OBUF,Q                   cn=0,n=15

   4866  6 000655   000017 236007                    LDQ     15,DL
         6 000656   200013 056100                    ASQ     LEN,,AUTO

      733     4868    6                           END;

      734     4869    5                         END;

   4869  6 000657   001054 710000 6                  TRA     s:4952

      735     4870    4                       ELSE
      736     4871    5                         DO;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:95   

      737     4872    5                         IF BUF$->XSJ$JOBINFO.FRS# = %RS_CAN# THEN

   4872  6 000660   777000 376003                    ANQ     -512,DU
         6 000661   021000 116003                    CMPQ    8704,DU
         6 000662   000672 601000 6                  TNZ     s:4880

      738     4873    6                           DO;

      739     4874                                %ADDSTR (S='cancelled by user');

   4876  6 000663   200013 235100                    LDA     LEN,,AUTO
         6 000664   040005 100400                    MLR     fill='040'O
         6 000665   000466 000021 2                  ADSC9   FPT_DISPLAY+146          cn=0,n=17
         6 000666   000500 000021 1                  ADSC9   OBUF,A                   cn=0,n=17

   4877  6 000667   000021 236007                    LDQ     17,DL
         6 000670   200013 056100                    ASQ     LEN,,AUTO

      740     4879    6                           END;

   4879  6 000671   001054 710000 6                  TRA     s:4952

      741     4880    5                         ELSE IF BUF$->XSJ$JOBINFO.FRS# = %RS_XKEY# THEN

   4880  6 000672   000000 236100                    LDQ     0,,PR0
         6 000673   777000 376003                    ANQ     -512,DU
         6 000674   400000 116003                    CMPQ    -131072,DU
         6 000675   000705 601000 6                  TNZ     s:4889

      742     4881    6                            DO;

      743     4882                                 %ADDSTR (S='aborted by operator');

   4884  6 000676   200013 235100                    LDA     LEN,,AUTO
         6 000677   040005 100400                    MLR     fill='040'O
         6 000700   000473 000023 2                  ADSC9   FPT_DISPLAY+151          cn=0,n=19
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:96   
         6 000701   000500 000023 1                  ADSC9   OBUF,A                   cn=0,n=19

   4885  6 000702   000023 236007                    LDQ     19,DL
         6 000703   200013 056100                    ASQ     LEN,,AUTO

      744     4887    6                            END;

   4887  6 000704   001054 710000 6                  TRA     s:4952

      745     4888    5                          ELSE
      746     4889    6                            DO CASE (BITBIN(BUF$->XSJ$JOBINFO.FRS#));

   4889  6 000705   000000 236100                    LDQ     0,,PR0
         6 000706   000033 772000                    QRL     27
         6 000707   000041 116007                    CMPQ    33,DL
         6 000710   000712 602006 6                  TNC     s:4889+5,QL
         6 000711   001016 710000 6                  TRA     s:4923
         6 000712   001016 710000 6                  TRA     s:4923
         6 000713   000753 710000 6                  TRA     s:4893
         6 000714   000762 710000 6                  TRA     s:4899
         6 000715   001016 710000 6                  TRA     s:4923
         6 000716   000771 710000 6                  TRA     s:4905
         6 000717   001016 710000 6                  TRA     s:4923
         6 000720   001016 710000 6                  TRA     s:4923
         6 000721   001016 710000 6                  TRA     s:4923
         6 000722   001000 710000 6                  TRA     s:4911
         6 000723   001016 710000 6                  TRA     s:4923
         6 000724   001016 710000 6                  TRA     s:4923
         6 000725   001016 710000 6                  TRA     s:4923
         6 000726   001016 710000 6                  TRA     s:4923
         6 000727   001016 710000 6                  TRA     s:4923
         6 000730   001016 710000 6                  TRA     s:4923
         6 000731   001016 710000 6                  TRA     s:4923
         6 000732   001007 710000 6                  TRA     s:4917
         6 000733   001016 710000 6                  TRA     s:4923
         6 000734   001016 710000 6                  TRA     s:4923
         6 000735   001016 710000 6                  TRA     s:4923
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:97   
         6 000736   001016 710000 6                  TRA     s:4923
         6 000737   001016 710000 6                  TRA     s:4923
         6 000740   001016 710000 6                  TRA     s:4923
         6 000741   001016 710000 6                  TRA     s:4923
         6 000742   001016 710000 6                  TRA     s:4923
         6 000743   001016 710000 6                  TRA     s:4923
         6 000744   001016 710000 6                  TRA     s:4923
         6 000745   001016 710000 6                  TRA     s:4923
         6 000746   001016 710000 6                  TRA     s:4923
         6 000747   001016 710000 6                  TRA     s:4923
         6 000750   001016 710000 6                  TRA     s:4923
         6 000751   001016 710000 6                  TRA     s:4923
         6 000752   001000 710000 6                  TRA     s:4911

      747     4890    6                              CASE (1);

      748     4891                                     %ADDSTR (S='errored by user');

   4893  6 000753   200013 235100                    LDA     LEN,,AUTO
         6 000754   040005 100400                    MLR     fill='040'O
         6 000755   000500 000017 2                  ADSC9   FPT_DISPLAY+156          cn=0,n=15
         6 000756   000500 000017 1                  ADSC9   OBUF,A                   cn=0,n=15

   4894  6 000757   000017 236007                    LDQ     15,DL
         6 000760   200013 056100                    ASQ     LEN,,AUTO
         6 000761   001054 710000 6                  TRA     s:4952

      749     4896    6                              CASE (2);

      750     4897                                     %ADDSTR (S='aborted by user');

   4899  6 000762   200013 235100                    LDA     LEN,,AUTO
         6 000763   040005 100400                    MLR     fill='040'O
         6 000764   000504 000017 2                  ADSC9   FPT_DISPLAY+160          cn=0,n=15
         6 000765   000500 000017 1                  ADSC9   OBUF,A                   cn=0,n=15

   4900  6 000766   000017 236007                    LDQ     15,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:98   
         6 000767   200013 056100                    ASQ     LEN,,AUTO
         6 000770   001054 710000 6                  TRA     s:4952

      751     4902    6                              CASE (4);

      752     4903                                     %ADDSTR (S='aborted by processor');

   4905  6 000771   200013 235100                    LDA     LEN,,AUTO
         6 000772   040005 100400                    MLR     fill='040'O
         6 000773   000510 000024 2                  ADSC9   FPT_DISPLAY+164          cn=0,n=20
         6 000774   000500 000024 1                  ADSC9   OBUF,A                   cn=0,n=20

   4906  6 000775   000024 236007                    LDQ     20,DL
         6 000776   200013 056100                    ASQ     LEN,,AUTO
         6 000777   001054 710000 6                  TRA     s:4952

      753     4908    6                              CASE (8,32);

      754     4909                                     %ADDSTR (S='aborted by monitor');

   4911  6 001000   200013 235100                    LDA     LEN,,AUTO
         6 001001   040005 100400                    MLR     fill='040'O
         6 001002   000515 000022 2                  ADSC9   FPT_DISPLAY+169          cn=0,n=18
         6 001003   000500 000022 1                  ADSC9   OBUF,A                   cn=0,n=18

   4912  6 001004   000022 236007                    LDQ     18,DL
         6 001005   200013 056100                    ASQ     LEN,,AUTO
         6 001006   001054 710000 6                  TRA     s:4952

      755     4914    6                              CASE (16);

      756     4915                                     %ADDSTR (S='errored by operator');

   4917  6 001007   200013 235100                    LDA     LEN,,AUTO
         6 001010   040005 100400                    MLR     fill='040'O
         6 001011   000522 000023 2                  ADSC9   FPT_DISPLAY+174          cn=0,n=19
         6 001012   000500 000023 1                  ADSC9   OBUF,A                   cn=0,n=19
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:99   

   4918  6 001013   000023 236007                    LDQ     19,DL
         6 001014   200013 056100                    ASQ     LEN,,AUTO
         6 001015   001054 710000 6                  TRA     s:4952

      757     4920    6                              CASE (ELSE);

      758     4921                                     %ADDSTR (S='terminated - STEPCC=');

   4923  6 001016   200013 235100                    LDA     LEN,,AUTO
         6 001017   040005 100400                    MLR     fill='040'O
         6 001020   000527 000024 2                  ADSC9   FPT_DISPLAY+179          cn=0,n=20
         6 001021   000500 000024 1                  ADSC9   OBUF,A                   cn=0,n=20

   4924  6 001022   000024 236007                    LDQ     20,DL
         6 001023   200013 056100                    ASQ     LEN,,AUTO

      759     4926                                     %ADDNUM (N="BUF$->XSJ$JOBINFO.STEPCC#");

   4928  6 001024   000000 236100                    LDQ     0,,PR0
         6 001025   000011 772000                    QRL     9
         6 001026   000777 376007                    ANQ     511,DL
         6 001027   000000 235003                    LDA     0,DU
         6 001030   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001031   000000 301500                    BTD
         6 001032   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001033   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   4929  6 001034   005304 701000 6                  TSX1    INS_NUM
         6 001035   000000 011000                    NOP     0

      760     4931    6                            END;

      761     4932    5                         END;

   4932  6 001036   001054 710000 6                  TRA     s:4952

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:100  
      762     4933
      763     4934    4                     CASE (%FIN_COMPLETED#);

      764     4935                            %ADDSTR (S='completed');

   4937  6 001037   200013 235100                    LDA     LEN,,AUTO
         6 001040   040005 100400                    MLR     fill='040'O
         6 001041   000534 000011 2                  ADSC9   FPT_DISPLAY+184          cn=0,n=9
         6 001042   000500 000011 1                  ADSC9   OBUF,A                   cn=0,n=9

   4938  6 001043   000011 236007                    LDQ     9,DL
         6 001044   200013 056100                    ASQ     LEN,,AUTO
         6 001045   001054 710000 6                  TRA     s:4952

      765     4940
      766     4941    4                     CASE (ELSE);

      767     4942                            %ADDSTR (S="'Oops:  DOG''s busted; STARLOG time!'");

   4944  6 001046   200013 235100                    LDA     LEN,,AUTO
         6 001047   040005 100400                    MLR     fill='040'O
         6 001050   000537 000042 2                  ADSC9   FPT_DISPLAY+187          cn=0,n=34
         6 001051   000500 000042 1                  ADSC9   OBUF,A                   cn=0,n=34

   4945  6 001052   000042 236007                    LDQ     34,DL
         6 001053   200013 056100                    ASQ     LEN,,AUTO

      768     4947
      769     4948    4                   END;

      770     4949
      771     4950                      %ADDSTR (S=': ');

   4952  6 001054   200013 235100                    LDA     LEN,,AUTO
         6 001055   040005 100400                    MLR     fill='040'O
         6 001056   000540 000002 2                  ADSC9   FPT_DISPLAY+188          cn=0,n=2
         6 001057   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:101  

   4953  6 001060   000002 236007                    LDQ     2,DL
         6 001061   200013 056100                    ASQ     LEN,,AUTO

      772     4955    3                 INUTS=BUF$->XSJ$JOBINFO.OFF_TIME#;

   4955  6 001062   200007 470500                    LDP0    BUF$,,AUTO
         6 001063   000002 235100                    LDA     2,,PR0
         6 001064   000276 755000 1                  STA     INUTS

      773     4956    3                 CALL M$TIME (GET_TIME);

   4956  6 001065   000676 630400 1                  EPPR0   GET_TIME
         6 001066   020004 713400                    CLIMB   8196
         6 001067   402000 401760                    pmme    nvectors=5

      774     4957                      %ADDSTR (S="OUTTIME.HHMM");

   4959  6 001070   200013 235100                    LDA     LEN,,AUTO
         6 001071   040005 100400                    MLR     fill='040'O
         6 001072   000272 000005 1                  ADSC9   OUTTIME                  cn=0,n=5
         6 001073   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   4960  6 001074   000005 236007                    LDQ     5,DL
         6 001075   200013 056100                    ASQ     LEN,,AUTO

      775     4962                      %ADDSTR (S=' ');

   4964  6 001076   200013 235100                    LDA     LEN,,AUTO
         6 001077   040005 100400                    MLR     fill='040'O
         6 001100   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001101   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   4965  6 001102   200013 054100                    AOS     LEN,,AUTO

      776     4967                      %ADDSTR (S="OUTDATE");

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:102  
   4969  6 001103   200013 235100                    LDA     LEN,,AUTO
         6 001104   040005 100400                    MLR     fill='040'O
         6 001105   000300 000010 1                  ADSC9   OUTDATE                  cn=0,n=8
         6 001106   000500 000010 1                  ADSC9   OBUF,A                   cn=0,n=8

   4970  6 001107   000010 236007                    LDQ     8,DL
         6 001110   200013 056100                    ASQ     LEN,,AUTO
         6 001111   001527 710000 6                  TRA     s:5177

      777     4972
      778     4973
      779     4974                                /* NORUN DISPLAY */
      780     4975    3               CASE (ODFT_NORUN#);

      781     4976
      782     4977    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   4977  6 001112   000001 236000 xsym               LDQ     OD_CXT+1
         6 001113   000005 736000                    QLS     5
         6 001114   000000 376000 7                  ANQ     0
         6 001115   000023 736000                    QLS     19
         6 001116   000002 036003                    ADLQ    2,DU
         6 001117   000000 036000 xsym               ADLQ    OD_CXT
         6 001120   200007 756100                    STQ     BUF$,,AUTO

      783     4978    3                 CALL FMT_SYSID;

   4978  6 001121   003165 701000 6                  TSX1    FMT_SYSID
         6 001122   000000 011000                    NOP     0

      784     4979    3                 CALL FMT_JA;

   4979  6 001123   003247 701000 6                  TSX1    FMT_JA
         6 001124   000000 011000                    NOP     0

      785     4980    3                 CALL FMT_POS;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:103  
   4980  6 001125   003515 701000 6                  TSX1    FMT_POS
         6 001126   000000 011000                    NOP     0

      786     4981    3                 CALL FMT_RQL;

   4981  6 001127   004366 701000 6                  TSX1    FMT_RQL
         6 001130   000000 011000                    NOP     0

      787     4982    3                 CALL FMT_FOL;

   4982  6 001131   004125 701000 6                  TSX1    FMT_FOL
         6 001132   000000 011000                    NOP     0
         6 001133   001527 710000 6                  TRA     s:5177

      788     4983
      789     4984
      790     4985                                /* OUTPUT FILE DISPLAY */
      791     4986    3               CASE (ODFT_OUTSF#,ODFT_OUTNS#);

      792     4987
      793     4988    3                 BUF$=ADDR(OD_CXT.SEG$->R$OUTPUT.F(OD_CXT.NDONE));

   4988  6 001134   000001 236000 xsym               LDQ     OD_CXT+1
         6 001135   777777 376007                    ANQ     -1,DL
         6 001136   000016 402007                    MPY     14,DL
         6 001137   000023 736000                    QLS     19
         6 001140   000002 036003                    ADLQ    2,DU
         6 001141   000000 036000 xsym               ADLQ    OD_CXT
         6 001142   200007 756100                    STQ     BUF$,,AUTO

      794     4989    3                 CALL FMT_OUTP;

   4989  6 001143   003053 701000 6                  TSX1    FMT_OUTP
         6 001144   000000 011000                    NOP     0

      795     4990                      %ADDSTR (S=' ');

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:104  
   4992  6 001145   200013 235100                    LDA     LEN,,AUTO
         6 001146   040005 100400                    MLR     fill='040'O
         6 001147   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001150   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   4993  6 001151   200013 054100                    AOS     LEN,,AUTO

      796     4995    3                 IF BUF$->A$OUTPUT.FLG.DEVAVAIL = '0'B THEN

   4995  6 001152   200007 470500                    LDP0    BUF$,,AUTO
         6 001153   000004 236100                    LDQ     4,,PR0
         6 001154   040000 316003                    CANQ    16384,DU
         6 001155   001164 601000 6                  TNZ     s:5005

      797     4996    4                   DO;

      798     4997                        %ADDSTR (S='NODEV ');

   4999  6 001156   200013 235100                    LDA     LEN,,AUTO
         6 001157   040005 100400                    MLR     fill='040'O
         6 001160   000550 000006 2                  ADSC9   FPT_DISPLAY+196          cn=0,n=6
         6 001161   000500 000006 1                  ADSC9   OBUF,A                   cn=0,n=6

   5000  6 001162   000006 236007                    LDQ     6,DL
         6 001163   200013 056100                    ASQ     LEN,,AUTO

      799     5002    4                   END;

      800     5003                      %ADDNUM (N="BUF$->A$OUTPUT.GRANS");

   5005  6 001164   000006 236100                    LDQ     6,,PR0
         6 001165   777777 376007                    ANQ     -1,DL
         6 001166   000000 235003                    LDA     0,DU
         6 001167   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001170   000000 301500                    BTD
         6 001171   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001172   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:105  

   5006  6 001173   005304 701000 6                  TSX1    INS_NUM
         6 001174   000000 011000                    NOP     0

      801     5008    3                 IF BUF$->A$OUTPUT.COPIES > 1 THEN

   5008  6 001175   200007 470500                    LDP0    BUF$,,AUTO
         6 001176   000002 236100                    LDQ     2,,PR0
         6 001177   777000 376007                    ANQ     -512,DL
         6 001200   002000 116007                    CMPQ    1024,DL
         6 001201   001227 602000 6                  TNC     s:5028

      802     5009    4                   DO;

      803     5010                        %ADDSTR (S="'(x'");

   5012  6 001202   200013 235100                    LDA     LEN,,AUTO
         6 001203   040005 100400                    MLR     fill='040'O
         6 001204   000552 000002 2                  ADSC9   FPT_DISPLAY+198          cn=0,n=2
         6 001205   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5013  6 001206   000002 236007                    LDQ     2,DL
         6 001207   200013 056100                    ASQ     LEN,,AUTO

      804     5015                        %ADDNUM (N="BUF$->A$OUTPUT.COPIES");

   5017  6 001210   000002 236100                    LDQ     2,,PR0
         6 001211   000011 772000                    QRL     9
         6 001212   000777 376007                    ANQ     511,DL
         6 001213   000000 235003                    LDA     0,DU
         6 001214   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001215   000000 301500                    BTD
         6 001216   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001217   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5018  6 001220   005304 701000 6                  TSX1    INS_NUM
         6 001221   000000 011000                    NOP     0
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:106  

      805     5020                        %ADDSTR (S="')'");

   5022  6 001222   200013 235100                    LDA     LEN,,AUTO
         6 001223   040005 100400                    MLR     fill='040'O
         6 001224   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 001225   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5023  6 001226   200013 054100                    AOS     LEN,,AUTO

      806     5025    4                   END;

      807     5026                      %ADDSTR (S="' grans'");

   5028  6 001227   200013 235100                    LDA     LEN,,AUTO
         6 001230   040005 100400                    MLR     fill='040'O
         6 001231   000553 000006 2                  ADSC9   FPT_DISPLAY+199          cn=0,n=6
         6 001232   000500 000006 1                  ADSC9   OBUF,A                   cn=0,n=6

   5029  6 001233   000006 236007                    LDQ     6,DL
         6 001234   200013 056100                    ASQ     LEN,,AUTO

      808     5031                      %ADDSTR (S="' prio '");

   5033  6 001235   200013 235100                    LDA     LEN,,AUTO
         6 001236   040005 100400                    MLR     fill='040'O
         6 001237   000555 000006 2                  ADSC9   FPT_DISPLAY+201          cn=0,n=6
         6 001240   000500 000006 1                  ADSC9   OBUF,A                   cn=0,n=6

   5034  6 001241   200013 056100                    ASQ     LEN,,AUTO

      809     5036    4                   DO CASE (BUF$->A$OUTPUT.PRIO);

   5036  6 001242   200007 470500                    LDP0    BUF$,,AUTO
         6 001243   000003 236100                    LDQ     3,,PR0
         6 001244   000022 772000                    QRL     18
         6 001245   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:107  
         6 001246   000020 136007                    SBLQ    16,DL
         6 001247   000004 116007                    CMPQ    4,DL
         6 001250   001252 602006 6                  TNC     s:5036+8,QL
         6 001251   001300 710000 6                  TRA     s:5059
         6 001252   001264 710000 6                  TRA     s:5046
         6 001253   001272 710000 6                  TRA     s:5052
         6 001254   001300 710000 6                  TRA     s:5059
         6 001255   001256 710000 6                  TRA     s:5040

      810     5037    4                     CASE (%FP_SPILLED#);

      811     5038                            %ADDSTR (S="'S'");

   5040  6 001256   200013 235100                    LDA     LEN,,AUTO
         6 001257   040005 100400                    MLR     fill='040'O
         6 001260   000002 000001 7                  ADSC9   2                        cn=0,n=1
         6 001261   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5041  6 001262   200013 054100                    AOS     LEN,,AUTO
         6 001263   001323 710000 6                  TRA     s:5072

      812     5043    4                     CASE (%FP_MFW#);

      813     5044                            %ADDSTR (S="'W'");

   5046  6 001264   200013 235100                    LDA     LEN,,AUTO
         6 001265   040005 100400                    MLR     fill='040'O
         6 001266   000003 000001 7                  ADSC9   3                        cn=0,n=1
         6 001267   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5047  6 001270   200013 054100                    AOS     LEN,,AUTO
         6 001271   001323 710000 6                  TRA     s:5072

      814     5049    4                     CASE (%FP_HOLD#);

      815     5050                            %ADDSTR (S="'H'");

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:108  
   5052  6 001272   200013 235100                    LDA     LEN,,AUTO
         6 001273   040005 100400                    MLR     fill='040'O
         6 001274   000004 000001 7                  ADSC9   4                        cn=0,n=1
         6 001275   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5053  6 001276   200013 054100                    AOS     LEN,,AUTO

      816     5055    4                       GOTO CHKCOM;

   5055  6 001277   001312 710000 6                  TRA     CHKCOM

      817     5056    4                     CASE (ELSE);

      818     5057                            %ADDNUM (N="BUF$->A$OUTPUT.PRIO");

   5059  6 001300   000003 236100                    LDQ     3,,PR0
         6 001301   000022 772000                    QRL     18
         6 001302   000777 376007                    ANQ     511,DL
         6 001303   000000 235003                    LDA     0,DU
         6 001304   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001305   000000 301500                    BTD
         6 001306   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001307   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5060  6 001310   005304 701000 6                  TSX1    INS_NUM
         6 001311   000000 011000                    NOP     0

   5059  6 001312                       CHKCOM       null
      819     5062    4   CHKCOM:             ;
      820     5063    4                       IF NOT BUF$->A$OUTPUT.FLG.GLC THEN

   5063  6 001312   200007 470500                    LDP0    BUF$,,AUTO
         6 001313   000004 234100                    SZN     4,,PR0
         6 001314   001323 604000 6                  TMI     s:5072

      821     5064    5                         DO;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:109  
      822     5065                              %ADDSTR (S="' (C)'");

   5067  6 001315   200013 235100                    LDA     LEN,,AUTO
         6 001316   040005 100400                    MLR     fill='040'O
         6 001317   000557 000004 2                  ADSC9   FPT_DISPLAY+203          cn=0,n=4
         6 001320   000500 000004 1                  ADSC9   OBUF,A                   cn=0,n=4

   5068  6 001321   000004 236007                    LDQ     4,DL
         6 001322   200013 056100                    ASQ     LEN,,AUTO

      823     5070    5                         END;

      824     5071    4                   END;

      825     5072    3                 IF BUF$->A$OUTPUT.DEVNAME ~= ' ' THEN

   5072  6 001323   000010 720100                    LXL0    8,,PR0
         6 001324   040040 100003                    CMPX0   16416,DU
         6 001325   001366 600000 6                  TZE     s:5103

      826     5073    4                   DO;

      827     5074                        %ADDSTR (S="' on '");

   5076  6 001326   200013 235100                    LDA     LEN,,AUTO
         6 001327   040005 100400                    MLR     fill='040'O
         6 001330   000560 000004 2                  ADSC9   FPT_DISPLAY+204          cn=0,n=4
         6 001331   000500 000004 1                  ADSC9   OBUF,A                   cn=0,n=4

   5077  6 001332   000004 236007                    LDQ     4,DL
         6 001333   200013 056100                    ASQ     LEN,,AUTO

      828     5079                        %ADDSTR (S="BUF$->A$OUTPUT.DEVTYP");

   5081  6 001334   200013 235100                    LDA     LEN,,AUTO
         6 001335   040005 100500                    MLR     fill='040'O
         6 001336   000002 000002                    ADSC9   2,,PR0                   cn=0,n=2
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:110  
         6 001337   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5082  6 001340   000002 236007                    LDQ     2,DL
         6 001341   200013 056100                    ASQ     LEN,,AUTO

      829     5084                        %ADDSTR (S="BUF$->A$OUTPUT.DEVNAME");

   5086  6 001342   200013 235100                    LDA     LEN,,AUTO
         6 001343   040005 100500                    MLR     fill='040'O
         6 001344   000010 400002                    ADSC9   8,,PR0                   cn=2,n=2
         6 001345   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5087  6 001346   200013 056100                    ASQ     LEN,,AUTO

      830     5089    4                   IF BUF$->A$OUTPUT.TNAME ~= BUF$->A$OUTPUT.WOD THEN

   5089  6 001347   040100 106500                    CMPC    fill='040'O
         6 001350   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001351   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         6 001352   001527 600000 6                  TZE     s:5177

      831     5090    5                     DO;

      832     5091                          %ADDSTR (S="'@'");

   5093  6 001353   200013 235100                    LDA     LEN,,AUTO
         6 001354   040005 100400                    MLR     fill='040'O
         6 001355   000005 000001 7                  ADSC9   5                        cn=0,n=1
         6 001356   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5094  6 001357   200013 054100                    AOS     LEN,,AUTO

      833     5096                          %ADDTXT (T="BUF$->A$OUTPUT.TNAME");

   5098  6 001360   040000 100500                    MLR     fill='040'O
         6 001361   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         6 001362   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:111  

   5099  6 001363   005357 701000 6                  TSX1    INS_TXT
         6 001364   000000 011000                    NOP     0

      834     5101    5                     END;

      835     5102    4                   END;

   5102  6 001365   001527 710000 6                  TRA     s:5177

      836     5103    3                 ELSE IF BUF$->A$OUTPUT.FLG.SPILL THEN

   5103  6 001366   000004 236100                    LDQ     4,,PR0
         6 001367   100000 316003                    CANQ    32768,DU
         6 001370   001400 600000 6                  TZE     s:5113

      837     5104    4                    DO;

      838     5105                         %ADDSTR (S=' being spilled');

   5107  6 001371   200013 235100                    LDA     LEN,,AUTO
         6 001372   040005 100400                    MLR     fill='040'O
         6 001373   000561 000016 2                  ADSC9   FPT_DISPLAY+205          cn=0,n=14
         6 001374   000500 000016 1                  ADSC9   OBUF,A                   cn=0,n=14

   5108  6 001375   000016 236007                    LDQ     14,DL
         6 001376   200013 056100                    ASQ     LEN,,AUTO

      839     5110    4                    END;

   5110  6 001377   001527 710000 6                  TRA     s:5177

      840     5111    3                  ELSE
      841     5112    4                    DO;

      842     5113    4                    POSN=BUF$->A$OUTPUT.AHEAD+1;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:112  
   5113  6 001400   000023 236100                    LDQ     19,,PR0
         6 001401   000022 772000                    QRL     18
         6 001402   000001 036007                    ADLQ    1,DL
         6 001403   200005 756100                    STQ     POSN,,AUTO

      843     5114    4                    CALL FMT_POSN;

   5114  6 001404   004003 701000 6                  TSX1    FMT_POSN
         6 001405   000000 011000                    NOP     0

      844     5115    4                    END;

   5115  6 001406   001527 710000 6                  TRA     s:5177

      845     5116
      846     5117
      847     5118                                /* INPUT FILE WAITING @ PRIO */
      848     5119                                /* INPUT FILE WAITING FOR DEFER TIME */
      849     5120    3               CASE (ODFT_INPRI#,ODFT_INDFR#);

      850     5121
      851     5122    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   5122  6 001407   000001 236000 xsym               LDQ     OD_CXT+1
         6 001410   000005 736000                    QLS     5
         6 001411   000000 376000 7                  ANQ     0
         6 001412   000023 736000                    QLS     19
         6 001413   000002 036003                    ADLQ    2,DU
         6 001414   000000 036000 xsym               ADLQ    OD_CXT
         6 001415   200007 756100                    STQ     BUF$,,AUTO

      852     5123    3                 CALL FMT_SYSID;

   5123  6 001416   003165 701000 6                  TSX1    FMT_SYSID
         6 001417   000000 011000                    NOP     0

      853     5124    3                 CALL FMT_JA;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:113  

   5124  6 001420   003247 701000 6                  TSX1    FMT_JA
         6 001421   000000 011000                    NOP     0

      854     5125    3                 CALL FMT_POS;

   5125  6 001422   003515 701000 6                  TSX1    FMT_POS
         6 001423   000000 011000                    NOP     0
         6 001424   001527 710000 6                  TRA     s:5177

      855     5126
      856     5127
      857     5128                                /* INPUT FILE RUNNING */
      858     5129    3               CASE (ODFT_INRUN#);

      859     5130
      860     5131    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   5131  6 001425   000001 236000 xsym               LDQ     OD_CXT+1
         6 001426   000005 736000                    QLS     5
         6 001427   000000 376000 7                  ANQ     0
         6 001430   000023 736000                    QLS     19
         6 001431   000002 036003                    ADLQ    2,DU
         6 001432   000000 036000 xsym               ADLQ    OD_CXT
         6 001433   200007 756100                    STQ     BUF$,,AUTO

      861     5132    3                 CALL FMT_JOB;

   5132  6 001434   003222 701000 6                  TSX1    FMT_JOB
         6 001435   000000 011000                    NOP     0

      862     5133    3                 CALL FMT_JA;

   5133  6 001436   003247 701000 6                  TSX1    FMT_JA
         6 001437   000000 011000                    NOP     0

      863     5134    3                 CALL FMT_POS;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:114  

   5134  6 001440   003515 701000 6                  TSX1    FMT_POS
         6 001441   000000 011000                    NOP     0
         6 001442   001527 710000 6                  TRA     s:5177

      864     5135
      865     5136
      866     5137                                /* INPUT FILE - WAITING TO FOLLOW */
      867     5138    3               CASE (ODFT_INFOL#);

      868     5139
      869     5140    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   5140  6 001443   000001 236000 xsym               LDQ     OD_CXT+1
         6 001444   000005 736000                    QLS     5
         6 001445   000000 376000 7                  ANQ     0
         6 001446   000023 736000                    QLS     19
         6 001447   000002 036003                    ADLQ    2,DU
         6 001450   000000 036000 xsym               ADLQ    OD_CXT
         6 001451   200007 756100                    STQ     BUF$,,AUTO

      870     5141    3                 CALL FMT_SYSID;

   5141  6 001452   003165 701000 6                  TSX1    FMT_SYSID
         6 001453   000000 011000                    NOP     0

      871     5142    3                 CALL FMT_JA;

   5142  6 001454   003247 701000 6                  TSX1    FMT_JA
         6 001455   000000 011000                    NOP     0

      872     5143    3                 CALL FMT_POS;

   5143  6 001456   003515 701000 6                  TSX1    FMT_POS
         6 001457   000000 011000                    NOP     0

      873     5144                      %ADDSTR (S="', follows '");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:115  

   5146  6 001460   200013 235100                    LDA     LEN,,AUTO
         6 001461   040005 100400                    MLR     fill='040'O
         6 001462   000565 000012 2                  ADSC9   FPT_DISPLAY+209          cn=0,n=10
         6 001463   000500 000012 1                  ADSC9   OBUF,A                   cn=0,n=10

   5147  6 001464   000012 236007                    LDQ     10,DL
         6 001465   200013 056100                    ASQ     LEN,,AUTO

      874     5149    3                 IF BUF$->A$INPUT.JDID.FOLLOW_TYPE(0) = %JM_FOLLOW_ACCOUNT THEN

   5149  6 001466   200007 470500                    LDP0    BUF$,,AUTO
         6 001467   000041 236100                    LDQ     33,,PR0
         6 001470   070000 376003                    ANQ     28672,DU
         6 001471   040000 116003                    CMPQ    16384,DU
         6 001472   001507 601000 6                  TNZ     s:5166

      875     5150    4                   DO;

      876     5151                        %ADDSTR (S="'all jobs .'");

   5153  6 001473   200013 235100                    LDA     LEN,,AUTO
         6 001474   040005 100400                    MLR     fill='040'O
         6 001475   000570 000012 2                  ADSC9   FPT_DISPLAY+212          cn=0,n=10
         6 001476   000500 000012 1                  ADSC9   OBUF,A                   cn=0,n=10

   5154  6 001477   000012 236007                    LDQ     10,DL
         6 001500   200013 056100                    ASQ     LEN,,AUTO

      877     5156                        %ADDTXT (T="BUF$->A$INPUT.ACCT");

   5158  6 001501   040000 100500                    MLR     fill='040'O
         6 001502   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         6 001503   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5159  6 001504   005357 701000 6                  TSX1    INS_TXT
         6 001505   000000 011000                    NOP     0
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:116  

      878     5161    4                   END;

   5161  6 001506   001527 710000 6                  TRA     s:5177

      879     5162    3                 ELSE
      880     5163    4                   DO;

      881     5164                        %ADDNUM (N="BUF$->A$INPUT.NFOLL");

   5166  6 001507   000006 236100                    LDQ     6,,PR0
         6 001510   000022 772000                    QRL     18
         6 001511   000777 376007                    ANQ     511,DL
         6 001512   000000 235003                    LDA     0,DU
         6 001513   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001514   000000 301500                    BTD
         6 001515   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001516   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5167  6 001517   005304 701000 6                  TSX1    INS_NUM
         6 001520   000000 011000                    NOP     0

      882     5169                        %ADDSTR (S="' jobs'");

   5171  6 001521   200013 235100                    LDA     LEN,,AUTO
         6 001522   040005 100400                    MLR     fill='040'O
         6 001523   000573 000005 2                  ADSC9   FPT_DISPLAY+215          cn=0,n=5
         6 001524   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   5172  6 001525   000005 236007                    LDQ     5,DL
         6 001526   200013 056100                    ASQ     LEN,,AUTO

      883     5174    4                   END;

      884     5175    3             END;

      885     5176
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:117  
      886     5177    2           CALL INS_OBUF;

   5177  6 001527   005153 701000 6                  TSX1    INS_OBUF
         6 001530   000000 011000                    NOP     0

      887     5178    2           CALL FLUSH;

   5178  6 001531   005217 701000 6                  TSX1    FLUSH
         6 001532   000000 011000                    NOP     0

      888     5179    2           RETURN;

   5179  6 001533   000000 702200 xent               TSX2  ! X66_ARET

      889     5180    2           END;
      890     5181
      891     5182        %EJECT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:118  
      892     5183    1         ELSE
      893     5184    2           DO;

      894     5185
      895     5186        /**
      896     5187
      897     5188           PPPP   RRRR    III   N   N  TTTTT  EEEEE  RRRR
      898     5189           P   P  R   R    I    N   N    T    E      R   R
      899     5190           P   P  R   R    I    NN  N    T    E      R   R
      900     5191           PPPP   RRRR     I    N N N    T    EEEE   RRRR
      901     5192           P      R R      I    N  NN    T    E      R R
      902     5193           P      R  R     I    N   N    T    E      R  R
      903     5194           P      R   R   III   N   N    T    EEEEE  R   R
      904     5195
      905     5196
      906     5197           DDDD    III    SSS   PPPP   L       AAA   Y   Y
      907     5198           D   D    I    S   S  P   P  L      A   A  Y   Y
      908     5199           D   D    I    S      P   P  L      A   A   Y Y
      909     5200           D   D    I     SSS   PPPP   L      AAAAA    Y
      910     5201           D   D    I        S  P      L      A   A    Y
      911     5202           D   D    I    S   S  P      L      A   A    Y
      912     5203           DDDD    III    SSS   P      LLLLL  A   A    Y
      913     5204
      914     5205         **/
      915     5206
      916     5207                %BUFRESET;

   5208  6 001534   000001 235007                    LDA     1,DL
         6 001535   200012 755100                    STA     TLEN,,AUTO

   5209  6 001536   200013 450100                    STZ     LEN,,AUTO

   5210  6 001537   000155 755000 1                  STA     LPTAB

      917     5212
      918     5213    3             DO CASE ( DISPLAY_TYPE );

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:119  
   5213  6 001540   200003 470500                    LDP0    @DISPLAY_TYPE,,AUTO
         6 001541   000000 235100                    LDA     0,,PR0
         6 001542   000006 135007                    SBLA    6,DL
         6 001543   000002 115007                    CMPA    2,DL
         6 001544   001546 602005 6                  TNC     s:5213+6,AL
         6 001545   002150 710000 6                  TRA     s:5352
         6 001546   001550 710000 6                  TRA     s:5223
         6 001547   001550 710000 6                  TRA     s:5223

      919     5214
      920     5215    3               CASE (ODFT_OUTNS#,ODFT_OUTSF#);

      921     5216
      922     5217                                /* OUTPUT
      923     5218
      924     5219                                   FILE
      925     5220
      926     5221                                   DISPLAY */
      927     5222
      928     5223    3                 BUF$=ADDR(OD_CXT.SEG$->R$OUTPUT.F(OD_CXT.NDONE));

   5223  6 001550   000001 236000 xsym               LDQ     OD_CXT+1
         6 001551   777777 376007                    ANQ     -1,DL
         6 001552   000016 402007                    MPY     14,DL
         6 001553   000023 736000                    QLS     19
         6 001554   000002 036003                    ADLQ    2,DU
         6 001555   000000 036000 xsym               ADLQ    OD_CXT
         6 001556   200007 756100                    STQ     BUF$,,AUTO

      929     5224    3                 IF OD_CXT.HDRDUN = 0 THEN

   5224  6 001557   000005 236000 xsym               LDQ     OD_CXT+5
         6 001560   000777 316003                    CANQ    511,DU
         6 001561   001577 601000 6                  TNZ     s:5235

      930     5225    4                   DO;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:120  
      931     5226    4                   OD_CXT.HDRDUN=1;

   5226  6 001562   000001 236003                    LDQ     1,DU
         6 001563   000005 552020 xsym               STBQ    OD_CXT+5,'20'O

      932     5227    4                   HDRVLP=STHDR;

   5227  6 001564   000000 100400                    MLR     fill='000'O
         6 001565   000010 000211 1                  ADSC9   STHDR                    cn=0,n=137
         6 001566   000054 000400 1                  ADSC9   HDRVLP                   cn=0,n=256

      933     5228    4                   ADDR(HDRVLP)->VLP$HDR.TITL.L#=LENGTHC(OF_TITLER);

   5228  6 001567   202000 236003                    LDQ     66560,DU
         6 001570   000055 552040 1                  STBQ    HDRVLP+1,'40'O

      934     5229    4                   ADDR(HDRVLP)->VLP$HDR.TITL.TITLE#=OF_TITLER;

   5229  6 001571   040000 100400                    MLR     fill='040'O
         6 001572   000026 000202 2                  ADSC9   OF_TITLE                 cn=0,n=130
         6 001573   000055 200204 1                  ADSC9   HDRVLP+1                 cn=1,n=132

      935     5230    4                   CALL M$DEVICE (SET_HDR);

   5230  6 001574   000216 630400 2                  EPPR0   SET_HDR
         6 001575   050006 713400                    CLIMB   20486
         6 001576   401000 401760                    pmme    nvectors=3

      936     5231    4                   END;

      937     5232
      938     5233                      %MVNUM (S="BUF$->A$OUTPUT.SYSID",D="OF_LINE.SYSID");

   5235  6 001577   200007 470500                    LDP0    BUF$,,AUTO
         6 001600   000005 236100                    LDQ     5,,PR0
         6 001601   000022 772000                    QRL     18
         6 001602   000000 235003                    LDA     0,DU
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:121  
         6 001603   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001604   000000 301500                    BTD
         6 001605   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001606   000302 230006 1                  NDSC9   OF_LINE                  cn=1,s=nosgn,sf=0,n=6

   5236  6 001607   000000 024400                    MVNE
         6 001610   000302 230006 1                  NDSC9   OF_LINE                  cn=1,s=nosgn,sf=0,n=6
         6 001611   000140 000002 2                  ADSC9   EDITCTLS+6               cn=0,n=2
         6 001612   000302 200006 1                  ADSC9   OF_LINE                  cn=1,n=6

      939     5238                      %MVNUM (S="BUF$->A$OUTPUT.NUM",D="OF_LINE.NUM");

   5240  6 001613   000005 236100                    LDQ     5,,PR0
         6 001614   777777 376007                    ANQ     -1,DL
         6 001615   000000 235003                    LDA     0,DU
         6 001616   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001617   000000 301500                    BTD
         6 001620   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001621   000304 030006 1                  NDSC9   OF_LINE+2                cn=0,s=nosgn,sf=0,n=6

   5241  6 001622   000000 024400                    MVNE
         6 001623   000304 030006 1                  NDSC9   OF_LINE+2                cn=0,s=nosgn,sf=0,n=6
         6 001624   000140 000002 2                  ADSC9   EDITCTLS+6               cn=0,n=2
         6 001625   000304 000006 1                  ADSC9   OF_LINE+2                cn=0,n=6

      940     5243    4                   DO CASE (BUF$->A$OUTPUT.MODE);

   5243  6 001626   000004 236100                    LDQ     4,,PR0
         6 001627   000033 772000                    QRL     27
         6 001630   000017 376007                    ANQ     15,DL
         6 001631   000005 116007                    CMPQ    5,DL
         6 001632   001634 602006 6                  TNC     s:5243+6,QL
         6 001633   001660 710000 6                  TRA     s:5260
         6 001634   001660 710000 6                  TRA     s:5260
         6 001635   001641 710000 6                  TRA     s:5246
         6 001636   001645 710000 6                  TRA     s:5249
         6 001637   001651 710000 6                  TRA     s:5252
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:122  
         6 001640   001655 710000 6                  TRA     s:5255

      941     5244
      942     5245    4                     CASE (%MODE_BATCH#);

      943     5246    4                       OF_LINE.MODE='BA';

   5246  6 001641   000575 236000 2                  LDQ     FPT_DISPLAY+217
         6 001642   000011 772000                    QRL     9
         6 001643   000306 552030 1                  STBQ    OF_LINE+4,'30'O
         6 001644   001660 710000 6                  TRA     s:5260

      944     5247
      945     5248    4                     CASE (%MODE_GHOST#);

      946     5249    4                       OF_LINE.MODE='GH';

   5249  6 001645   000576 236000 2                  LDQ     FPT_DISPLAY+218
         6 001646   000011 772000                    QRL     9
         6 001647   000306 552030 1                  STBQ    OF_LINE+4,'30'O
         6 001650   001660 710000 6                  TRA     s:5260

      947     5250
      948     5251    4                     CASE (%MODE_INT#);

      949     5252    4                       OF_LINE.MODE='TS';

   5252  6 001651   000577 236000 2                  LDQ     FPT_DISPLAY+219
         6 001652   000011 772000                    QRL     9
         6 001653   000306 552030 1                  STBQ    OF_LINE+4,'30'O
         6 001654   001660 710000 6                  TRA     s:5260

      950     5253
      951     5254    4                     CASE (%MODE_TP#);

      952     5255    4                       OF_LINE.MODE='TP';

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:123  
   5255  6 001655   000600 236000 2                  LDQ     FPT_DISPLAY+220
         6 001656   000011 772000                    QRL     9
         6 001657   000306 552030 1                  STBQ    OF_LINE+4,'30'O

      953     5256
      954     5257    4                   END;

      955     5258                      %MVTXT (S="BUF$->A$OUTPUT.ACCT",D="OF_LINE.ACCT");

   5260  6 001660   000035 235000 xsym               LDA     B_VECTNIL+29
         6 001661   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 001662   000307 755000 1                  STA     OF_LINE+5
         6 001663   000310 756000 1                  STQ     OF_LINE+6

   5261  6 001664   000000 124500                    SCM     mask='000'O
         6 001665   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         6 001666   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 001667   200016 000100                    ARG     BLNKINDEX,,AUTO

   5262  6 001670   200016 335100                    LCA     BLNKINDEX,,AUTO
         6 001671   200016 720100                    LXL0    BLNKINDEX,,AUTO
         6 001672   040045 100500                    MLR     fill='040'O
         6 001673   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         6 001674   000311 000010 1                  ADSC9   OF_LINE+7,A              cn=0,n=*X0

      956     5264    3                 OF_LINE.DEVTYP=BUF$->A$OUTPUT.DEVTYP;

   5264  6 001675   000002 236100                    LDQ     2,,PR0
         6 001676   000011 772000                    QRL     9
         6 001677   000311 552030 1                  STBQ    OF_LINE+7,'30'O

      957     5265    3                 OF_LINE.WOD=BUF$->A$OUTPUT.WOD;

   5265  6 001700   040000 100500                    MLR     fill='040'O
         6 001701   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         6 001702   000312 000010 1                  ADSC9   OF_LINE+8                cn=0,n=8

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:124  
      958     5266                      %MVNUM (S="BUF$->A$OUTPUT.GRANS",D="OF_LINE.GRANS");

   5268  6 001703   000006 236100                    LDQ     6,,PR0
         6 001704   777777 376007                    ANQ     -1,DL
         6 001705   000000 235003                    LDA     0,DU
         6 001706   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001707   000000 301500                    BTD
         6 001710   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001711   000314 230005 1                  NDSC9   OF_LINE+10               cn=1,s=nosgn,sf=0,n=5

   5269  6 001712   000000 024400                    MVNE
         6 001713   000314 230005 1                  NDSC9   OF_LINE+10               cn=1,s=nosgn,sf=0,n=5
         6 001714   000137 000002 2                  ADSC9   EDITCTLS+5               cn=0,n=2
         6 001715   000314 200005 1                  ADSC9   OF_LINE+10               cn=1,n=5

      959     5271                      %MVNUM (S="BUF$->A$OUTPUT.COPIES",D="OF_LINE.COPIES");

   5273  6 001716   000002 236100                    LDQ     2,,PR0
         6 001717   000011 772000                    QRL     9
         6 001720   000777 376007                    ANQ     511,DL
         6 001721   000000 235003                    LDA     0,DU
         6 001722   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001723   000000 301500                    BTD
         6 001724   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001725   000315 630006 1                  NDSC9   OF_LINE+11               cn=3,s=nosgn,sf=0,n=6

   5274  6 001726   000000 024400                    MVNE
         6 001727   000315 630006 1                  NDSC9   OF_LINE+11               cn=3,s=nosgn,sf=0,n=6
         6 001730   000140 000002 2                  ADSC9   EDITCTLS+6               cn=0,n=2
         6 001731   000315 600006 1                  ADSC9   OF_LINE+11               cn=3,n=6

      960     5276    4                   DO CASE (BUF$->A$OUTPUT.PRIO);

   5276  6 001732   000003 236100                    LDQ     3,,PR0
         6 001733   000022 772000                    QRL     18
         6 001734   000777 376007                    ANQ     511,DL
         6 001735   000020 136007                    SBLQ    16,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:125  
         6 001736   000004 116007                    CMPQ    4,DL
         6 001737   001741 602006 6                  TNC     s:5276+7,QL
         6 001740   001761 710000 6                  TRA     s:5290
         6 001741   001751 710000 6                  TRA     s:5282
         6 001742   001755 710000 6                  TRA     s:5285
         6 001743   001761 710000 6                  TRA     s:5290
         6 001744   001745 710000 6                  TRA     s:5279

      961     5277
      962     5278    4                     CASE (%FP_SPILLED#);

      963     5279    4                       OF_LINE.PRIO='SPLD';

   5279  6 001745   040000 100400                    MLR     fill='040'O
         6 001746   000601 000004 2                  ADSC9   FPT_DISPLAY+221          cn=0,n=4
         6 001747   000317 400004 1                  ADSC9   OF_LINE+13               cn=2,n=4
         6 001750   001775 710000 6                  TRA     s:5296

      964     5280
      965     5281    4                     CASE (%FP_MFW#);

      966     5282    4                       OF_LINE.PRIO='CMFW';

   5282  6 001751   040000 100400                    MLR     fill='040'O
         6 001752   000602 000004 2                  ADSC9   FPT_DISPLAY+222          cn=0,n=4
         6 001753   000317 400004 1                  ADSC9   OF_LINE+13               cn=2,n=4
         6 001754   001775 710000 6                  TRA     s:5296

      967     5283
      968     5284    4                     CASE (%FP_HOLD#);

      969     5285    4                       OF_LINE.PRIO='HOLD';

   5285  6 001755   040000 100400                    MLR     fill='040'O
         6 001756   000603 000004 2                  ADSC9   FPT_DISPLAY+223          cn=0,n=4
         6 001757   000317 400004 1                  ADSC9   OF_LINE+13               cn=2,n=4
         6 001760   001775 710000 6                  TRA     s:5296
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:126  

      970     5286
      971     5287    4                     CASE (ELSE);

      972     5288                            %MVNUM (S="BUF$->A$OUTPUT.PRIO",D="OF_LINE.PRIO");

   5290  6 001761   000003 236100                    LDQ     3,,PR0
         6 001762   000022 772000                    QRL     18
         6 001763   000777 376007                    ANQ     511,DL
         6 001764   000000 235003                    LDA     0,DU
         6 001765   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 001766   000000 301500                    BTD
         6 001767   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 001770   000317 430004 1                  NDSC9   OF_LINE+13               cn=2,s=nosgn,sf=0,n=4

   5291  6 001771   000000 024400                    MVNE
         6 001772   000317 430004 1                  NDSC9   OF_LINE+13               cn=2,s=nosgn,sf=0,n=4
         6 001773   000136 000002 2                  ADSC9   EDITCTLS+4               cn=0,n=2
         6 001774   000317 400004 1                  ADSC9   OF_LINE+13               cn=2,n=4

      973     5293
      974     5294    4                   END;

      975     5295
      976     5296    3                 IF BUF$->A$OUTPUT.FLG.SAP THEN

   5296  6 001775   000004 236100                    LDQ     4,,PR0
         6 001776   200000 316003                    CANQ    65536,DU
         6 001777   002014 600000 6                  TZE     s:5304

      977     5297    4                   DO;

      978     5298                        %MVNUM (S="BUF$->A$OUTPUT.SAPCOPIES",D="OF_LINE.SAP");

   5300  6 002000   000003 236100                    LDQ     3,,PR0
         6 002001   000033 772000                    QRL     27
         6 002002   000000 235003                    LDA     0,DU
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:127  
         6 002003   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002004   000000 301500                    BTD
         6 002005   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002006   000320 630003 1                  NDSC9   OF_LINE+14               cn=3,s=nosgn,sf=0,n=3

   5301  6 002007   000000 024400                    MVNE
         6 002010   000320 630003 1                  NDSC9   OF_LINE+14               cn=3,s=nosgn,sf=0,n=3
         6 002011   000135 000002 2                  ADSC9   EDITCTLS+3               cn=0,n=2
         6 002012   000320 600003 1                  ADSC9   OF_LINE+14               cn=3,n=3

      979     5303    4                   END;

   5303  6 002013   002017 710000 6                  TRA     s:5305

      980     5304    3                 ELSE OF_LINE.SAP=' N ';

   5304  6 002014   040000 100400                    MLR     fill='040'O
         6 002015   000604 000003 2                  ADSC9   FPT_DISPLAY+224          cn=0,n=3
         6 002016   000320 600003 1                  ADSC9   OF_LINE+14               cn=3,n=3

      981     5305    3                 IF BUF$->A$OUTPUT.FLG.GLC THEN OF_LINE.COMF='  N ';

   5305  6 002017   000004 234100                    SZN     4,,PR0
         6 002020   002025 605000 6                  TPL     s:5310

   5305  6 002021   040000 100400                    MLR     fill='040'O
         6 002022   000605 000003 2                  ADSC9   FPT_DISPLAY+225          cn=0,n=3
         6 002023   000321 600003 1                  ADSC9   OF_LINE+15               cn=3,n=3
         6 002024   002040 710000 6                  TRA     s:5316

      982     5306    3                 ELSE
      983     5307    4                   DO;

      984     5308                        %MVNUM (S="BUF$->A$OUTPUT.HICNUM",D="OF_LINE.COMF");

   5310  6 002025   000006 236100                    LDQ     6,,PR0
         6 002026   000022 772000                    QRL     18
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:128  
         6 002027   000000 235003                    LDA     0,DU
         6 002030   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002031   000000 301500                    BTD
         6 002032   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002033   000321 630003 1                  NDSC9   OF_LINE+15               cn=3,s=nosgn,sf=0,n=3

   5311  6 002034   000000 024400                    MVNE
         6 002035   000321 630003 1                  NDSC9   OF_LINE+15               cn=3,s=nosgn,sf=0,n=3
         6 002036   000135 000002 2                  ADSC9   EDITCTLS+3               cn=0,n=2
         6 002037   000321 600003 1                  ADSC9   OF_LINE+15               cn=3,n=3

      985     5313    4                   END;

      986     5314                      %MVTXT (S="BUF$->A$OUTPUT.FORM",D="OF_LINE.FORM");

   5316  6 002040   040000 100400                    MLR     fill='040'O
         6 002041   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002042   000322 600006 1                  ADSC9   OF_LINE+16               cn=3,n=6

   5317  6 002043   000000 124500                    SCM     mask='000'O
         6 002044   000007 000006                    ADSC9   7,,PR0                   cn=0,n=6
         6 002045   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002046   200016 000100                    ARG     BLNKINDEX,,AUTO

   5318  6 002047   200016 336100                    LCQ     BLNKINDEX,,AUTO
         6 002050   200016 720100                    LXL0    BLNKINDEX,,AUTO
         6 002051   040046 100500                    MLR     fill='040'O
         6 002052   000007 000006                    ADSC9   7,,PR0                   cn=0,n=6
         6 002053   000324 200010 1                  ADSC9   OF_LINE+18,Q             cn=1,n=*X0

      987     5320    3                 OF_LINE.ATTRS='....';

   5320  6 002054   040000 100400                    MLR     fill='040'O
         6 002055   000606 000004 2                  ADSC9   FPT_DISPLAY+226          cn=0,n=4
         6 002056   000324 400004 1                  ADSC9   OF_LINE+18               cn=2,n=4

      988     5321    3                 ATTR=BUF$->A$OUTPUT.ATTR;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:129  

   5321  6 002057   000003 721100                    LXL1    3,,PR0
         6 002060   200025 741100                    STX1    ATTR,,AUTO

      989     5322    3                 IF ATTR THEN

   5322  6 002061   002105 600000 6                  TZE     s:5329

      990     5323    4                   DO;

      991     5324    4                   IF (ATTR&%ATTR_TRUOVRPRT#) THEN OF_LINE.ATTRSR.OVR='O';

   5324  6 002062   000010 361003                    ANX1    8,DU
         6 002063   002066 600000 6                  TZE     s:5325

   5324  6 002064   000117 236007                    LDQ     79,DL
         6 002065   000324 552004 1                  STBQ    OF_LINE+18,'04'O

      992     5325    4                   IF (ATTR&%ATTR_LOWERCASE#) THEN OF_LINE.ATTRSR.LC='L';

   5325  6 002066   200025 221100                    LDX1    ATTR,,AUTO
         6 002067   000001 361003                    ANX1    1,DU
         6 002070   002073 600000 6                  TZE     s:5326

   5325  6 002071   000114 236003                    LDQ     76,DU
         6 002072   000325 552020 1                  STBQ    OF_LINE+19,'20'O

      993     5326    4                   IF (ATTR&%ATTR_BIN#) THEN OF_LINE.ATTRSR.BIN='B';

   5326  6 002073   200025 221100                    LDX1    ATTR,,AUTO
         6 002074   000002 361003                    ANX1    2,DU
         6 002075   002100 600000 6                  TZE     s:5327

   5326  6 002076   102000 236003                    LDQ     33792,DU
         6 002077   000325 552040 1                  STBQ    OF_LINE+19,'40'O

      994     5327    4                   IF (ATTR&%ATTR_APL#) THEN OF_LINE.ATTRSR.APL='A';
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:130  

   5327  6 002100   200025 221100                    LDX1    ATTR,,AUTO
         6 002101   000004 361003                    ANX1    4,DU
         6 002102   002105 600000 6                  TZE     s:5329

   5327  6 002103   101000 236007                    LDQ     33280,DL
         6 002104   000324 552010 1                  STBQ    OF_LINE+18,'10'O

      995     5328    4                   END;

      996     5329    3                 INUTS=BUF$->A$OUTPUT.CREATED;

   5329  6 002105   000024 235100                    LDA     20,,PR0
         6 002106   000276 755000 1                  STA     INUTS

      997     5330    3                 CALL M$TIME (GET_TIME);

   5330  6 002107   000676 630400 1                  EPPR0   GET_TIME
         6 002110   020004 713400                    CLIMB   8196
         6 002111   402000 401760                    pmme    nvectors=5

      998     5331    3                 OF_LINE.CREATIME=OUTTIME.HHMM;

   5331  6 002112   040000 100400                    MLR     fill='040'O
         6 002113   000272 000005 1                  ADSC9   OUTTIME                  cn=0,n=5
         6 002114   000325 600005 1                  ADSC9   OF_LINE+19               cn=3,n=5

      999     5332    3                 OF_LINE.CREADATE.M=SUBSTR(OUTDATE,0,2);

   5332  6 002115   000300 236000 1                  LDQ     OUTDATE
         6 002116   000011 772000                    QRL     9
         6 002117   000327 552030 1                  STBQ    OF_LINE+21,'30'O

     1000     5333    3                 OF_LINE.CREADATE.D=SUBSTR(OUTDATE,3,2);

   5333  6 002120   040000 100400                    MLR     fill='040'O
         6 002121   000300 600002 1                  ADSC9   OUTDATE                  cn=3,n=2
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:131  
         6 002122   000327 600002 1                  ADSC9   OF_LINE+21               cn=3,n=2

     1001     5334    3                 OF_LINE.CREADATE.Y=SUBSTR(OUTDATE,6,2);

   5334  6 002123   000301 236000 1                  LDQ     OUTDATE+1
         6 002124   000011 736000                    QLS     9
         6 002125   000330 552030 1                  STBQ    OF_LINE+22,'30'O

     1002     5335    3                 IF BUF$->A$OUTPUT.FLG.DEVAVAIL THEN

   5335  6 002126   200007 470500                    LDP0    BUF$,,AUTO
         6 002127   000004 236100                    LDQ     4,,PR0
         6 002130   040000 316003                    CANQ    16384,DU
         6 002131   002136 600000 6                  TZE     s:5338

     1003     5336    3                  OF_LINE.NODEV=' ';

   5336  6 002132   040000 100400                    MLR     fill='040'O
         6 002133   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002134   000331 000007 1                  ADSC9   OF_LINE+23               cn=0,n=7
         6 002135   002141 710000 6                  TRA     s:5339

     1004     5337    3                 ELSE
     1005     5338    3                  OF_LINE.NODEV='*NODEV*';

   5338  6 002136   040000 100400                    MLR     fill='040'O
         6 002137   000607 000007 2                  ADSC9   FPT_DISPLAY+227          cn=0,n=7
         6 002140   000331 000007 1                  ADSC9   OF_LINE+23               cn=0,n=7

     1006     5339    3                 OF_LINE.JOBNAME=BUF$->A$OUTPUT.JNAME;

   5339  6 002141   040000 100500                    MLR     fill='040'O
         6 002142   000013 000037                    ADSC9   11,,PR0                  cn=0,n=31
         6 002143   000333 000037 1                  ADSC9   OF_LINE+25               cn=0,n=31

     1007     5340
     1008     5341    3                 CALL M$WRITE (WRITE_OLINE);
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:132  

   5341  6 002144   000202 630400 2                  EPPR0   WRITE_OLINE
         6 002145   040001 713400                    CLIMB   write
         6 002146   401400 401760                    pmme    nvectors=4

     1009     5342    3                 RETURN;

   5342  6 002147   000000 702200 xent               TSX2  ! X66_ARET

     1010     5343
     1011     5344    3               CASE (ELSE);

     1012     5345
     1013     5346                                /* INPUT
     1014     5347
     1015     5348                                   JOB
     1016     5349
     1017     5350                                   DISPLAY */
     1018     5351
     1019     5352    3                 BUF$=ADDR(OD_CXT.SEG$->R$INPUT.J(OD_CXT.NDONE));

   5352  6 002150   000001 236000 xsym               LDQ     OD_CXT+1
         6 002151   000005 736000                    QLS     5
         6 002152   000000 376000 7                  ANQ     0
         6 002153   000023 736000                    QLS     19
         6 002154   000002 036003                    ADLQ    2,DU
         6 002155   000000 036000 xsym               ADLQ    OD_CXT
         6 002156   200007 756100                    STQ     BUF$,,AUTO

     1020     5353    3                 IF OD_CXT.HDRDUN = 0 THEN

   5353  6 002157   000005 236000 xsym               LDQ     OD_CXT+5
         6 002160   000777 316003                    CANQ    511,DU
         6 002161   002177 601000 6                  TNZ     s:5363

     1021     5354    4                   DO;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:133  
     1022     5355    4                   OD_CXT.HDRDUN=1;

   5355  6 002162   000001 236003                    LDQ     1,DU
         6 002163   000005 552020 xsym               STBQ    OD_CXT+5,'20'O

     1023     5356    4                   HDRVLP=STHDR;

   5356  6 002164   000000 100400                    MLR     fill='000'O
         6 002165   000010 000211 1                  ADSC9   STHDR                    cn=0,n=137
         6 002166   000054 000400 1                  ADSC9   HDRVLP                   cn=0,n=256

     1024     5357    4                   ADDR(HDRVLP)->VLP$HDR.TITL.L#=LENGTHC(IF_TITLER);

   5357  6 002167   204000 236003                    LDQ     67584,DU
         6 002170   000055 552040 1                  STBQ    HDRVLP+1,'40'O

     1025     5358    4                   ADDR(HDRVLP)->VLP$HDR.TITL.TITLE#=IF_TITLER;

   5358  6 002171   040000 100400                    MLR     fill='040'O
         6 002172   000067 000204 2                  ADSC9   IF_TITLE                 cn=0,n=132
         6 002173   000055 200204 1                  ADSC9   HDRVLP+1                 cn=1,n=132

     1026     5359    4                   CALL M$DEVICE (SET_HDR);

   5359  6 002174   000216 630400 2                  EPPR0   SET_HDR
         6 002175   050006 713400                    CLIMB   20486
         6 002176   401000 401760                    pmme    nvectors=3

     1027     5360    4                   END;

     1028     5361                      %MVNUM (S="BUF$->A$INPUT.SYSID",D="IF_LINE.SYSID");

   5363  6 002177   200007 470500                    LDP0    BUF$,,AUTO
         6 002200   000006 236100                    LDQ     6,,PR0
         6 002201   777777 376007                    ANQ     -1,DL
         6 002202   000000 235003                    LDA     0,DU
         6 002203   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:134  
         6 002204   000000 301500                    BTD
         6 002205   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002206   000343 230006 1                  NDSC9   IF_LINE                  cn=1,s=nosgn,sf=0,n=6

   5364  6 002207   000000 024400                    MVNE
         6 002210   000343 230006 1                  NDSC9   IF_LINE                  cn=1,s=nosgn,sf=0,n=6
         6 002211   000140 000002 2                  ADSC9   EDITCTLS+6               cn=0,n=2
         6 002212   000343 200006 1                  ADSC9   IF_LINE                  cn=1,n=6

     1029     5366                      %MVTXT (S="BUF$->A$INPUT.ACCT",D="IF_LINE.ACCT");

   5368  6 002213   000035 235000 xsym               LDA     B_VECTNIL+29
         6 002214   000035 236000 xsym               LDQ     B_VECTNIL+29
         6 002215   000345 755000 1                  STA     IF_LINE+2
         6 002216   000346 756000 1                  STQ     IF_LINE+3

   5369  6 002217   000000 124500                    SCM     mask='000'O
         6 002220   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         6 002221   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002222   200016 000100                    ARG     BLNKINDEX,,AUTO

   5370  6 002223   200016 335100                    LCA     BLNKINDEX,,AUTO
         6 002224   200016 720100                    LXL0    BLNKINDEX,,AUTO
         6 002225   040045 100500                    MLR     fill='040'O
         6 002226   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         6 002227   000347 000010 1                  ADSC9   IF_LINE+4,A              cn=0,n=*X0

     1030     5372                      %MVTXT (S="BUF$->A$INPUT.UNAME",D="IF_LINE.UNAME");

   5374  6 002230   040000 100400                    MLR     fill='040'O
         6 002231   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002232   000347 200014 1                  ADSC9   IF_LINE+4                cn=1,n=12

   5375  6 002233   000000 124500                    SCM     mask='000'O
         6 002234   000012 000014                    ADSC9   10,,PR0                  cn=0,n=12
         6 002235   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002236   200016 000100                    ARG     BLNKINDEX,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:135  

   5376  6 002237   200016 335100                    LCA     BLNKINDEX,,AUTO
         6 002240   200016 720100                    LXL0    BLNKINDEX,,AUTO
         6 002241   040045 100500                    MLR     fill='040'O
         6 002242   000012 000014                    ADSC9   10,,PR0                  cn=0,n=12
         6 002243   000352 200010 1                  ADSC9   IF_LINE+7,A              cn=1,n=*X0

     1031     5378    3                 INUTS=BUF$->A$INPUT.SUBMIT_TIME;

   5378  6 002244   000004 235100                    LDA     4,,PR0
         6 002245   000276 755000 1                  STA     INUTS

     1032     5379    3                 CALL M$TIME (GET_TIME);

   5379  6 002246   000676 630400 1                  EPPR0   GET_TIME
         6 002247   020004 713400                    CLIMB   8196
         6 002250   402000 401760                    pmme    nvectors=5

     1033     5380    3                 IF_LINE.SUBTIME=OUTTIME.HHMM;

   5380  6 002251   040000 100400                    MLR     fill='040'O
         6 002252   000272 000005 1                  ADSC9   OUTTIME                  cn=0,n=5
         6 002253   000352 400005 1                  ADSC9   IF_LINE+7                cn=2,n=5

     1034     5381    3                 IF_LINE.SUBDATE.M=SUBSTR(OUTDATE,0,2);

   5381  6 002254   000300 220000 1                  LDX0    OUTDATE
         6 002255   000354 740000 1                  STX0    IF_LINE+9

     1035     5382    3                 IF_LINE.SUBDATE.D=SUBSTR(OUTDATE,3,2);

   5382  6 002256   040100 100400                    MLR     fill='040'O
         6 002257   000300 600002 1                  ADSC9   OUTDATE                  cn=3,n=2
         6 002260   200044 000004                    ADSC9   ADD_RES_ATTR+10,,AUTO    cn=0,n=4
         6 002261   200044 221100                    LDX1    ADD_RES_ATTR+10,,AUTO
         6 002262   000354 441000 1                  SXL1    IF_LINE+9

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:136  
     1036     5383    3                 IF_LINE.SUBDATE.Y=SUBSTR(OUTDATE,6,2);

   5383  6 002263   000301 722000 1                  LXL2    OUTDATE+1
         6 002264   000355 742000 1                  STX2    IF_LINE+10

     1037     5384    3                 IF_LINE.CFLG='.....';

   5384  6 002265   040000 100400                    MLR     fill='040'O
         6 002266   000611 000005 2                  ADSC9   FPT_DISPLAY+229          cn=0,n=5
         6 002267   000355 600005 1                  ADSC9   IF_LINE+10               cn=3,n=5

     1038     5385    3                 IF BUF$->A$INPUT.FLG.O1 THEN IF_LINE.FLG.O='O';

   5385  6 002270   200007 470500                    LDP0    BUF$,,AUTO
         6 002271   000006 234100                    SZN     6,,PR0
         6 002272   002275 605000 6                  TPL     s:5386

   5385  6 002273   000117 236007                    LDQ     79,DL
         6 002274   000355 552004 1                  STBQ    IF_LINE+10,'04'O

     1039     5386    3                 IF BUF$->A$INPUT.FLG.ACC THEN IF_LINE.FLG.A='A';

   5386  6 002275   000006 236100                    LDQ     6,,PR0
         6 002276   040000 316003                    CANQ    16384,DU
         6 002277   002302 600000 6                  TZE     s:5387

   5386  6 002300   101000 236003                    LDQ     33280,DU
         6 002301   000356 552040 1                  STBQ    IF_LINE+11,'40'O

     1040     5387    3                 IF BUF$->A$INPUT.FLG.O3 THEN IF_LINE.FLG.F='F';

   5387  6 002302   000006 236100                    LDQ     6,,PR0
         6 002303   100000 316003                    CANQ    32768,DU
         6 002304   002307 600000 6                  TZE     s:5388

   5387  6 002305   106000 236007                    LDQ     35840,DL
         6 002306   000356 552010 1                  STBQ    IF_LINE+11,'10'O
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:137  

     1041     5388    3                 IF BUF$->A$INPUT.FLG.RA THEN IF_LINE.FLG.D='D';

   5388  6 002307   000006 236100                    LDQ     6,,PR0
         6 002310   002000 316003                    CANQ    1024,DU
         6 002311   002314 600000 6                  TZE     s:5389

   5388  6 002312   000104 236007                    LDQ     68,DL
         6 002313   000356 552004 1                  STBQ    IF_LINE+11,'04'O

     1042     5389    3                 IF NOT BUF$->A$INPUT.FLG.RR THEN IF_LINE.FLG.N='N';

   5389  6 002314   000006 236100                    LDQ     6,,PR0
         6 002315   020000 316003                    CANQ    8192,DU
         6 002316   002321 601000 6                  TNZ     s:5392

   5389  6 002317   000116 236003                    LDQ     78,DU
         6 002320   000356 552020 1                  STBQ    IF_LINE+11,'20'O

     1043     5390                      %MVTXT (S="BUF$->A$INPUT.WOO",D="IF_LINE.WOO");

   5392  6 002321   040000 100400                    MLR     fill='040'O
         6 002322   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002323   000357 200010 1                  ADSC9   IF_LINE+12               cn=1,n=8

   5393  6 002324   000000 124500                    SCM     mask='000'O
         6 002325   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         6 002326   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002327   200016 000100                    ARG     BLNKINDEX,,AUTO

   5394  6 002330   200016 335100                    LCA     BLNKINDEX,,AUTO
         6 002331   200016 723100                    LXL3    BLNKINDEX,,AUTO
         6 002332   040045 100500                    MLR     fill='040'O
         6 002333   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         6 002334   000361 200013 1                  ADSC9   IF_LINE+14,A             cn=1,n=*X3

     1044     5396                      %MVNUM (S="BUF$->A$INPUT.RRT(0)",D="IF_LINE.MEM");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:138  

   5398  6 002335   000032 236100                    LDQ     26,,PR0
         6 002336   000022 772000                    QRL     18
         6 002337   000000 235003                    LDA     0,DU
         6 002340   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002341   000000 301500                    BTD
         6 002342   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002343   000361 430003 1                  NDSC9   IF_LINE+14               cn=2,s=nosgn,sf=0,n=3

   5399  6 002344   000000 024400                    MVNE
         6 002345   000361 430003 1                  NDSC9   IF_LINE+14               cn=2,s=nosgn,sf=0,n=3
         6 002346   000135 000002 2                  ADSC9   EDITCTLS+3               cn=0,n=2
         6 002347   000361 400003 1                  ADSC9   IF_LINE+14               cn=2,n=3

     1045     5401    3                 IF_LINE.CTIM='       :  ';

   5401  6 002350   040000 100400                    MLR     fill='040'O
         6 002351   000613 000012 2                  ADSC9   FPT_DISPLAY+231          cn=0,n=10
         6 002352   000362 400012 1                  ADSC9   IF_LINE+15               cn=2,n=10

     1046     5402    3                 IF BUF$->A$INPUT.TIM/360000 ~= 0 THEN

   5402  6 002353   000040 236100                    LDQ     32,,PR0
         6 002354   000001 772000                    QRL     1
         6 002355   537440 506007                    DIV     -82144,DL
         6 002356   000000 116003                    CMPQ    0,DU
         6 002357   002376 600000 6                  TZE     s:5413

     1047     5403    4                   DO;

     1048     5404                        %MVNUM (S="BUF$->A$INPUT.TIM/360000",D="IF_LINE.TIM.H");

   5406  6 002360   000040 236100                    LDQ     32,,PR0
         6 002361   000001 772000                    QRL     1
         6 002362   537440 506007                    DIV     -82144,DL
         6 002363   000000 235003                    LDA     0,DU
         6 002364   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:139  
         6 002365   000000 301500                    BTD
         6 002366   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002367   000362 430004 1                  NDSC9   IF_LINE+15               cn=2,s=nosgn,sf=0,n=4

   5407  6 002370   000000 024400                    MVNE
         6 002371   000362 430004 1                  NDSC9   IF_LINE+15               cn=2,s=nosgn,sf=0,n=4
         6 002372   000136 000002 2                  ADSC9   EDITCTLS+4               cn=0,n=2
         6 002373   000362 400004 1                  ADSC9   IF_LINE+15               cn=2,n=4

     1049     5409    4                   SUBSTR (IF_LINE.CTIM,4,1) = ':';

   5409  6 002374   072000 236007                    LDQ     29696,DL
         6 002375   000363 552010 1                  STBQ    IF_LINE+16,'10'O

     1050     5410    4                   END;

     1051     5411                      %MVNUMZF (S="MOD(BUF$->A$INPUT.TIM/6000,60)",D="IF_LINE.TIM.M");

   5413  6 002376   000040 236100                    LDQ     32,,PR0
         6 002377   000001 772000                    QRL     1
         6 002400   005670 506007                    DIV     3000,DL
         6 002401   000044 737000                    LLS     36
         6 002402   000043 773000                    LRL     35
         6 002403   000074 507007                    DVF     60,DL
         6 002404   000000 235003                    LDA     0,DU
         6 002405   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002406   000000 301500                    BTD
         6 002407   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002410   000363 630002 1                  NDSC9   IF_LINE+16               cn=3,s=nosgn,sf=0,n=2

     1052     5415                      %MVNUMZF (S="MOD(BUF$->A$INPUT.TIM/100,60)",D="IF_LINE.TIM.S");

   5417  6 002411   000040 236100                    LDQ     32,,PR0
         6 002412   000001 772000                    QRL     1
         6 002413   000062 506007                    DIV     50,DL
         6 002414   000044 737000                    LLS     36
         6 002415   000043 773000                    LRL     35
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:140  
         6 002416   000074 507007                    DVF     60,DL
         6 002417   000000 235003                    LDA     0,DU
         6 002420   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002421   000000 301500                    BTD
         6 002422   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002423   000364 430002 1                  NDSC9   IF_LINE+17               cn=2,s=nosgn,sf=0,n=2

     1053     5419    3                 IF BUF$->A$INPUT.PRIO = %JP_RUN# THEN

   5419  6 002424   000003 236100                    LDQ     3,,PR0
         6 002425   000777 376007                    ANQ     511,DL
         6 002426   000020 116007                    CMPQ    16,DL
         6 002427   002474 601000 6                  TNZ     s:5436

     1054     5420    4                   DO;

     1055     5421    4                   IF_LINE.CPART='P  @            ';

   5421  6 002430   040000 100400                    MLR     fill='040'O
         6 002431   000616 000020 2                  ADSC9   FPT_DISPLAY+234          cn=0,n=16
         6 002432   000365 200020 1                  ADSC9   IF_LINE+18               cn=1,n=16

     1056     5422                        %MVNUM (S="BUF$->A$INPUT.PNUM",D="IF_LINE.RUNNING_PART.PART");

   5424  6 002433   000003 236100                    LDQ     3,,PR0
         6 002434   000033 772000                    QRL     27
         6 002435   000000 235003                    LDA     0,DU
         6 002436   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002437   000000 301500                    BTD
         6 002440   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002441   000365 430002 1                  NDSC9   IF_LINE+18               cn=2,s=nosgn,sf=0,n=2

   5425  6 002442   000000 024400                    MVNE
         6 002443   000365 430002 1                  NDSC9   IF_LINE+18               cn=2,s=nosgn,sf=0,n=2
         6 002444   000134 000002 2                  ADSC9   EDITCTLS+2               cn=0,n=2
         6 002445   000365 400002 1                  ADSC9   IF_LINE+18               cn=2,n=2

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:141  
     1057     5427    4                   INUTS=BUF$->A$INPUT.START_TIME;

   5427  6 002446   000005 235100                    LDA     5,,PR0
         6 002447   000276 755000 1                  STA     INUTS

     1058     5428    4                   CALL M$TIME (GET_TIME);

   5428  6 002450   000676 630400 1                  EPPR0   GET_TIME
         6 002451   020004 713400                    CLIMB   8196
         6 002452   402000 401760                    pmme    nvectors=5

     1059     5429    4                   IF_LINE.RUNNING_PART.START_TIME.HHMM=OUTTIME.HHMM;

   5429  6 002453   040000 100400                    MLR     fill='040'O
         6 002454   000272 000005 1                  ADSC9   OUTTIME                  cn=0,n=5
         6 002455   000366 200005 1                  ADSC9   IF_LINE+19               cn=1,n=5

     1060     5430    4                   IF_LINE.RUNNING_PART.START_TIME.DATE.M=SUBSTR(OUTDATE,0,2);

   5430  6 002456   040000 100400                    MLR     fill='040'O
         6 002457   000300 000002 1                  ADSC9   OUTDATE                  cn=0,n=2
         6 002460   000367 600002 1                  ADSC9   IF_LINE+20               cn=3,n=2

     1061     5431    4                   IF_LINE.RUNNING_PART.START_TIME.DATE.D=SUBSTR(OUTDATE,3,2);

   5431  6 002461   000300 235000 1                  LDA     OUTDATE
         6 002462   000301 236000 1                  LDQ     OUTDATE+1
         6 002463   000011 773000                    LRL     9
         6 002464   777777 376003                    ANQ     -1,DU
         6 002465   040040 276007                    ORQ     16416,DL
         6 002466   000011 772000                    QRL     9
         6 002467   000370 552030 1                  STBQ    IF_LINE+21,'30'O

     1062     5432    4                   IF_LINE.RUNNING_PART.START_TIME.DATE.Y=SUBSTR(OUTDATE,6,2);

   5432  6 002470   040000 100400                    MLR     fill='040'O
         6 002471   000301 400002 1                  ADSC9   OUTDATE+1                cn=2,n=2
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:142  
         6 002472   000370 600002 1                  ADSC9   IF_LINE+21               cn=3,n=2

     1063     5433    4                   END;

   5433  6 002473   002524 710000 6                  TRA     s:5444

     1064     5434    3                 ELSE
     1065     5435    4                   DO;

     1066     5436    4                   IF_LINE.CPART='................';

   5436  6 002474   040000 100400                    MLR     fill='040'O
         6 002475   000622 000020 2                  ADSC9   FPT_DISPLAY+238          cn=0,n=16
         6 002476   000365 200020 1                  ADSC9   IF_LINE+18               cn=1,n=16

     1067     5437    4                   PARTM=BUF$->A$INPUT.PART;

   5437  6 002477   000002 236100                    LDQ     2,,PR0
         6 002500   000024 736000                    QLS     20
         6 002501   000154 676000 1                  ERQ     PARTM
         6 002502   777774 376003                    ANQ     -4,DU
         6 002503   000154 656000 1                  ERSQ    PARTM

     1068     5438    5                     DO I = 0 TO 15;

   5438  6 002504   200006 450100                    STZ     I,,AUTO

     1069     5439    5                     IF PARTMR.P(I) THEN IF_LINE.PARTS(I)='Y';

   5439  6 002505   200006 235100                    LDA     I,,AUTO
         6 002506   002510 605000 6                  TPL     s:5439+3
         6 002507   000044 035003                    ADLA    36,DU
         6 002510   000000 066405                    CMPB    filb='0'B
         6 002511   000154 000001 1                  BDSC    PARTM,A                  by=0,bit=0,n=1
         6 002512   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         6 002513   002520 600000 6                  TZE     s:5440

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:143  
   5439  6 002514   200006 235100                    LDA     I,,AUTO
         6 002515   040005 100400                    MLR     fill='040'O
         6 002516   000006 000001 7                  ADSC9   6                        cn=0,n=1
         6 002517   000365 200001 1                  ADSC9   IF_LINE+18,A             cn=1,n=1

     1070     5440    5                     END;

   5440  6 002520   200006 054100                    AOS     I,,AUTO
         6 002521   200006 235100                    LDA     I,,AUTO
         6 002522   000017 115007                    CMPA    15,DL
         6 002523   002505 604400 6                  TMOZ    s:5439

     1071     5441    4                   END;

     1072     5442                      %MVNUM (S="BUF$->A$INPUT.IPRIO",D="IF_LINE.PRIO");

   5444  6 002524   200007 470500                    LDP0    BUF$,,AUTO
         6 002525   000003 236100                    LDQ     3,,PR0
         6 002526   000011 772000                    QRL     9
         6 002527   000777 376007                    ANQ     511,DL
         6 002530   000000 235003                    LDA     0,DU
         6 002531   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 002532   000000 301500                    BTD
         6 002533   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 002534   000371 630002 1                  NDSC9   IF_LINE+22               cn=3,s=nosgn,sf=0,n=2

   5445  6 002535   000000 024400                    MVNE
         6 002536   000371 630002 1                  NDSC9   IF_LINE+22               cn=3,s=nosgn,sf=0,n=2
         6 002537   000134 000002 2                  ADSC9   EDITCTLS+2               cn=0,n=2
         6 002540   000371 600002 1                  ADSC9   IF_LINE+22               cn=3,n=2

     1073     5447    4                   DO CASE (BUF$->A$INPUT.PRIO);

   5447  6 002541   000003 236100                    LDQ     3,,PR0
         6 002542   000777 376007                    ANQ     511,DL
         6 002543   000020 136007                    SBLQ    16,DL
         6 002544   000006 116007                    CMPQ    6,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:144  
         6 002545   002547 602006 6                  TNC     s:5447+6,QL
         6 002546   002601 710000 6                  TRA     s:5465
         6 002547   002571 710000 6                  TRA     s:5459
         6 002550   002575 710000 6                  TRA     s:5462
         6 002551   002565 710000 6                  TRA     s:5456
         6 002552   002555 710000 6                  TRA     s:5450
         6 002553   002601 710000 6                  TRA     s:5465
         6 002554   002561 710000 6                  TRA     s:5453

     1074     5448
     1075     5449    4                     CASE (%JP_WPART#);

     1076     5450    4                       IF_LINE.CSTATUS=ST_WPART;

   5450  6 002555   000000 100400                    MLR     fill='000'O
         6 002556   000024 000006 2                  ADSC9   ST_WPART                 cn=0,n=6
         6 002557   000372 400006 1                  ADSC9   IF_LINE+23               cn=2,n=6
         6 002560   002641 710000 6                  TRA     s:5483

     1077     5451
     1078     5452    4                     CASE (%JP_WPS#);

     1079     5453    4                       IF_LINE.CSTATUS=ST_WPS;

   5453  6 002561   000000 100400                    MLR     fill='000'O
         6 002562   000022 000006 2                  ADSC9   ST_WPS                   cn=0,n=6
         6 002563   000372 400006 1                  ADSC9   IF_LINE+23               cn=2,n=6
         6 002564   002641 710000 6                  TRA     s:5483

     1080     5454
     1081     5455    4                     CASE (%JP_RUNAFTER#);

     1082     5456    4                       IF_LINE.CSTATUS=ST_DEFER;

   5456  6 002565   000000 100400                    MLR     fill='000'O
         6 002566   000262 000006 1                  ADSC9   ST_DEFER                 cn=0,n=6
         6 002567   000372 400006 1                  ADSC9   IF_LINE+23               cn=2,n=6
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:145  
         6 002570   002641 710000 6                  TRA     s:5483

     1083     5457
     1084     5458    4                     CASE (%JP_RUN#);

     1085     5459    4                       IF_LINE.CSTATUS=ST_RUN;

   5459  6 002571   000000 100400                    MLR     fill='000'O
         6 002572   000266 000006 1                  ADSC9   ST_RUN                   cn=0,n=6
         6 002573   000372 400006 1                  ADSC9   IF_LINE+23               cn=2,n=6
         6 002574   002641 710000 6                  TRA     s:5483

     1086     5460
     1087     5461    4                     CASE (%JP_FOLL#);

     1088     5462    4                       IF_LINE.CSTATUS=ST_FOLL;

   5462  6 002575   000000 100400                    MLR     fill='000'O
         6 002576   000270 000006 1                  ADSC9   ST_FOLL                  cn=0,n=6
         6 002577   000372 400006 1                  ADSC9   IF_LINE+23               cn=2,n=6
         6 002600   002641 710000 6                  TRA     s:5483

     1089     5463
     1090     5464    4                     CASE (ELSE);

     1091     5465    4                       POSN=BUF$->A$INPUT.AHEAD+1;

   5465  6 002601   000007 235100                    LDA     7,,PR0
         6 002602   000001 035007                    ADLA    1,DL
         6 002603   200005 755100                    STA     POSN,,AUTO

     1092     5466                            %MVNUM (S="POSN",D="ST_WAIT.POS");

   5468  6 002604   000000 301500                    BTD
         6 002605   200005 000004                    NDSC9   POSN,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         6 002606   000264 030004 1                  NDSC9   ST_WAIT                  cn=0,s=nosgn,sf=0,n=4

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:146  
   5469  6 002607   000000 024400                    MVNE
         6 002610   000264 030004 1                  NDSC9   ST_WAIT                  cn=0,s=nosgn,sf=0,n=4
         6 002611   000136 000002 2                  ADSC9   EDITCTLS+4               cn=0,n=2
         6 002612   000264 000004 1                  ADSC9   ST_WAIT                  cn=0,n=4

     1093     5471    4                       IF MOD(POSN,100) < 10

   5471  6 002613   200005 236100                    LDQ     POSN,,AUTO
         6 002614   000144 506007                    DIV     100,DL
         6 002615   000044 733000                    LRS     36
         6 002616   000012 116007                    CMPQ    10,DL
         6 002617   002625 604000 6                  TMI     s:5474
         6 002620   200005 236100                    LDQ     POSN,,AUTO
         6 002621   000144 506007                    DIV     100,DL
         6 002622   000044 733000                    LRS     36
         6 002623   000024 116007                    CMPQ    20,DL
         6 002624   002632 604400 6                  TMOZ    s:5478

     1094     5472    4                       OR MOD(POSN,100) > 20 THEN
     1095     5473    5                         DO;

     1096     5474    5                         ST_WAIT.NUMEXT=NUMEXTS(MOD(POSN,10));

   5474  6 002625   200005 236100                    LDQ     POSN,,AUTO
         6 002626   000012 506007                    DIV     10,DL
         6 002627   000446 220005 1                  LDX0    NUMEXTS,AL
         6 002630   000265 740000 1                  STX0    ST_WAIT+1

     1097     5475    5                         END;

   5475  6 002631   002636 710000 6                  TRA     s:5480

     1098     5476    4                       ELSE
     1099     5477    5                         DO;

     1100     5478    5                         ST_WAIT.NUMEXT=TEEN_NUMEXTS(MOD(POSN,10));

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:147  
   5478  6 002632   200005 236100                    LDQ     POSN,,AUTO
         6 002633   000012 506007                    DIV     10,DL
         6 002634   000460 220005 1                  LDX0    TEEN_NUMEXTS,AL
         6 002635   000265 740000 1                  STX0    ST_WAIT+1

     1101     5479    5                         END;

     1102     5480    4                       IF_LINE.CSTATUS=ST_WAIT;

   5480  6 002636   000000 100400                    MLR     fill='000'O
         6 002637   000264 000006 1                  ADSC9   ST_WAIT                  cn=0,n=6
         6 002640   000372 400006 1                  ADSC9   IF_LINE+23               cn=2,n=6

     1103     5481
     1104     5482    4                   END;

     1105     5483    3                 IF_LINE.JNAME=BUF$->A$INPUT.JNAME;

   5483  6 002641   040000 100500                    MLR     fill='040'O
         6 002642   000021 000037                    ADSC9   17,,PR0                  cn=0,n=31
         6 002643   000374 200037 1                  ADSC9   IF_LINE+25               cn=1,n=31

     1106     5484
     1107     5485                                /* WRITE THE ONE RECORD */
     1108     5486    3                 CALL M$WRITE (WRITE_ILINE);

   5486  6 002644   000230 630400 2                  EPPR0   WRITE_ILINE
         6 002645   040001 713400                    CLIMB   write
         6 002646   401400 401760                    pmme    nvectors=4

     1109     5487
     1110     5488                                /* FORMAT PSEUDOS, PACKSETS, FOLLOW LIST,
     1111     5489                                   AND PHYSICALS SEPARATELY, WITH AT LEAST
     1112     5490                                   ONE LINE FOR EACH */
     1113     5491    3                 LPWRITES=0;

   5491  6 002647   200031 450100                    STZ     LPWRITES,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:148  

     1114     5492
     1115     5493                           /* WSN */
     1116     5494    3                 IF BUF$->A$INPUT.WOO ~= BUF$->A$INPUT.WSN THEN

   5494  6 002650   200007 470500                    LDP0    BUF$,,AUTO
         6 002651   040100 106500                    CMPC    fill='040'O
         6 002652   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         6 002653   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         6 002654   002704 600000 6                  TZE     s:5517

     1117     5495    4                   DO;

     1118     5496                        %HEADER (T=WSNHDR,N=40);

   5498  6 002655   040000 100400                    MLR     fill='040'O
         6 002656   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002657   000404 200050 1                  ADSC9   LOBUF                    cn=1,n=40

   5499  6 002660   040000 100400                    MLR     fill='040'O
         6 002661   000000 000011 2                  ADSC9   WSNHDR                   cn=0,n=9
         6 002662   000416 200011 1                  ADSC9   LOBUF+10                 cn=1,n=9

   5500  6 002663   000062 235007                    LDA     50,DL
         6 002664   200012 755100                    STA     TLEN,,AUTO

   5501  6 002665   000155 755000 1                  STA     LPTAB

     1119     5503                        %ADDSTR (S="' '");

   5505  6 002666   200013 236100                    LDQ     LEN,,AUTO
         6 002667   040006 100400                    MLR     fill='040'O
         6 002670   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002671   000500 000001 1                  ADSC9   OBUF,Q                   cn=0,n=1

   5506  6 002672   200013 054100                    AOS     LEN,,AUTO

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:149  
     1120     5508                        %ADDTXT (T="BUF$->A$INPUT.WSN");

   5510  6 002673   040000 100500                    MLR     fill='040'O
         6 002674   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         6 002675   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5511  6 002676   005357 701000 6                  TSX1    INS_TXT
         6 002677   000000 011000                    NOP     0

     1121     5513    4                   CALL INS_OBUF;

   5513  6 002700   005153 701000 6                  TSX1    INS_OBUF
         6 002701   000000 011000                    NOP     0

     1122     5514    4                   CALL FLUSH;

   5514  6 002702   005217 701000 6                  TSX1    FLUSH
         6 002703   000000 011000                    NOP     0

     1123     5515    4                   END;

     1124     5516                           /* DEFERREDness */
     1125     5517    3                 IF BUF$->A$INPUT.FLG.RA THEN

   5517  6 002704   200007 470500                    LDP0    BUF$,,AUTO
         6 002705   000006 236100                    LDQ     6,,PR0
         6 002706   002000 316003                    CANQ    1024,DU
         6 002707   002725 600000 6                  TZE     s:5531

     1126     5518    4                   DO;

     1127     5519                        %HEADER (T=DEFRHDR,N=40);

   5521  6 002710   040000 100400                    MLR     fill='040'O
         6 002711   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002712   000404 200050 1                  ADSC9   LOBUF                    cn=1,n=40

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:150  
   5522  6 002713   040000 100400                    MLR     fill='040'O
         6 002714   000003 000011 2                  ADSC9   DEFRHDR                  cn=0,n=9
         6 002715   000416 200011 1                  ADSC9   LOBUF+10                 cn=1,n=9

   5523  6 002716   000062 235007                    LDA     50,DL
         6 002717   200012 755100                    STA     TLEN,,AUTO

   5524  6 002720   000155 755000 1                  STA     LPTAB

     1128     5526    4                   CALL DO_DEFER;

   5526  6 002721   004065 701000 6                  TSX1    DO_DEFER
         6 002722   000000 011000                    NOP     0

     1129     5527    4                   CALL FLUSH;

   5527  6 002723   005217 701000 6                  TSX1    FLUSH
         6 002724   000000 011000                    NOP     0

     1130     5528    4                   END;

     1131     5529
     1132     5530                           /* FOLLOW LIST */
     1133     5531    3                 IF BUF$->A$INPUT.FLG.O3 THEN

   5531  6 002725   200007 470500                    LDP0    BUF$,,AUTO
         6 002726   000006 236100                    LDQ     6,,PR0
         6 002727   100000 316003                    CANQ    32768,DU
         6 002730   002763 600000 6                  TZE     s:5558

     1134     5532    4                   DO;

     1135     5533                        %HEADER (T=FOLLHDR,N=40);

   5535  6 002731   040000 100400                    MLR     fill='040'O
         6 002732   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002733   000404 200050 1                  ADSC9   LOBUF                    cn=1,n=40
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:151  

   5536  6 002734   040000 100400                    MLR     fill='040'O
         6 002735   000006 000011 2                  ADSC9   FOLLHDR                  cn=0,n=9
         6 002736   000416 200011 1                  ADSC9   LOBUF+10                 cn=1,n=9

   5537  6 002737   000062 235007                    LDA     50,DL
         6 002740   200012 755100                    STA     TLEN,,AUTO

   5538  6 002741   000155 755000 1                  STA     LPTAB

     1136     5540                        %ADDSTR (S="' ('");

   5542  6 002742   200013 236100                    LDQ     LEN,,AUTO
         6 002743   040006 100400                    MLR     fill='040'O
         6 002744   000626 000002 2                  ADSC9   FPT_DISPLAY+242          cn=0,n=2
         6 002745   000500 000002 1                  ADSC9   OBUF,Q                   cn=0,n=2

   5543  6 002746   000002 236007                    LDQ     2,DL
         6 002747   200013 056100                    ASQ     LEN,,AUTO

     1137     5545    4                   CALL DO_FOLL;

   5545  6 002750   004154 701000 6                  TSX1    DO_FOLL
         6 002751   000000 011000                    NOP     0

     1138     5546                        %ADDSTR (S="')'");

   5548  6 002752   200013 235100                    LDA     LEN,,AUTO
         6 002753   040005 100400                    MLR     fill='040'O
         6 002754   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 002755   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5549  6 002756   200013 054100                    AOS     LEN,,AUTO

     1139     5551    4                   CALL INS_OBUF;

   5551  6 002757   005153 701000 6                  TSX1    INS_OBUF
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:152  
         6 002760   000000 011000                    NOP     0

     1140     5552    4                   CALL FLUSH;

   5552  6 002761   005217 701000 6                  TSX1    FLUSH
         6 002762   000000 011000                    NOP     0

     1141     5553    4                   END;

     1142     5554
     1143     5555                           /* PSEUDOS */
     1144     5556                      %HEADER (T=PSEUHDR,N=40);

   5558  6 002763   040000 100400                    MLR     fill='040'O
         6 002764   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 002765   000404 200050 1                  ADSC9   LOBUF                    cn=1,n=40

   5559  6 002766   040000 100400                    MLR     fill='040'O
         6 002767   000014 000011 2                  ADSC9   PSEUHDR                  cn=0,n=9
         6 002770   000416 200011 1                  ADSC9   LOBUF+10                 cn=1,n=9

   5560  6 002771   000062 235007                    LDA     50,DL
         6 002772   200012 755100                    STA     TLEN,,AUTO

   5561  6 002773   000155 755000 1                  STA     LPTAB

     1145     5563    3                 CALL DO_PSEUDOS;

   5563  6 002774   004517 701000 6                  TSX1    DO_PSEUDOS
         6 002775   000000 011000                    NOP     0

     1146     5564    3                 CALL FLUSH;

   5564  6 002776   005217 701000 6                  TSX1    FLUSH
         6 002777   000000 011000                    NOP     0

     1147     5565
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:153  
     1148     5566                           /* PACKSETS */
     1149     5567                      %HEADER (T=PSETHDR,N=40);

   5569  6 003000   040000 100400                    MLR     fill='040'O
         6 003001   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003002   000404 200050 1                  ADSC9   LOBUF                    cn=1,n=40

   5570  6 003003   040000 100400                    MLR     fill='040'O
         6 003004   000011 000011 2                  ADSC9   PSETHDR                  cn=0,n=9
         6 003005   000416 200011 1                  ADSC9   LOBUF+10                 cn=1,n=9

   5571  6 003006   000062 235007                    LDA     50,DL
         6 003007   200012 755100                    STA     TLEN,,AUTO

   5572  6 003010   000155 755000 1                  STA     LPTAB

     1150     5574    3                 CALL DO_PACKSETS;

   5574  6 003011   004610 701000 6                  TSX1    DO_PACKSETS
         6 003012   000000 011000                    NOP     0

     1151     5575    3                 CALL FLUSH;

   5575  6 003013   005217 701000 6                  TSX1    FLUSH
         6 003014   000000 011000                    NOP     0

     1152     5576
     1153     5577                           /* PHYSICALS */
     1154     5578                      %HEADER (T=OTHRHDR,N=40);

   5580  6 003015   040000 100400                    MLR     fill='040'O
         6 003016   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003017   000404 200050 1                  ADSC9   LOBUF                    cn=1,n=40

   5581  6 003020   040000 100400                    MLR     fill='040'O
         6 003021   000017 000011 2                  ADSC9   OTHRHDR                  cn=0,n=9
         6 003022   000416 200011 1                  ADSC9   LOBUF+10                 cn=1,n=9
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:154  

   5582  6 003023   000062 235007                    LDA     50,DL
         6 003024   200012 755100                    STA     TLEN,,AUTO

   5583  6 003025   000155 755000 1                  STA     LPTAB

     1155     5585    3                 CALL DO_PHYS;

   5585  6 003026   004747 701000 6                  TSX1    DO_PHYS
         6 003027   000000 011000                    NOP     0

     1156     5586    3                 CALL FLUSH;

   5586  6 003030   005217 701000 6                  TSX1    FLUSH
         6 003031   000000 011000                    NOP     0

     1157     5587
     1158     5588                                /* PUT OUT A BLANK LINE IF WE DID ANY
     1159     5589                                   WRITES FOR THE ABOVE 4 THINGS */
     1160     5590    3                 IF LPWRITES ~= 0 THEN

   5590  6 003032   200031 235100                    LDA     LPWRITES,,AUTO
         6 003033   003052 600000 6                  TZE     s:5605

     1161     5591    4                   DO;

     1162     5592                        %BUFRESET;

   5593  6 003034   000001 236007                    LDQ     1,DL
         6 003035   200012 756100                    STQ     TLEN,,AUTO

   5594  6 003036   200013 450100                    STZ     LEN,,AUTO

   5595  6 003037   000155 756000 1                  STQ     LPTAB

     1163     5597                        %ADDSTR (S='     ');

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:155  
   5599  6 003040   200013 235100                    LDA     LEN,,AUTO
         6 003041   040005 100400                    MLR     fill='040'O
         6 003042   000613 000005 2                  ADSC9   FPT_DISPLAY+231          cn=0,n=5
         6 003043   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   5600  6 003044   000005 236007                    LDQ     5,DL
         6 003045   200013 056100                    ASQ     LEN,,AUTO

     1164     5602    4                   CALL INS_OBUF;

   5602  6 003046   005153 701000 6                  TSX1    INS_OBUF
         6 003047   000000 011000                    NOP     0

     1165     5603    4                   CALL FLUSH;

   5603  6 003050   005217 701000 6                  TSX1    FLUSH
         6 003051   000000 011000                    NOP     0

     1166     5604    4                   END;

     1167     5605    3                 RETURN;

   5605  6 003052   000000 702200 xent               TSX2  ! X66_ARET

     1168     5606
     1169     5607
     1170     5608    3             END;

     1171     5609
     1172     5610
     1173     5611    2           END;
     1174     5612        %EJECT;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:156  
     1175     5613        /*
     1176     5614
     1177     5615              FFFFF  OOO  RRRR  M   M  AAA  TTTTT
     1178     5616              F     O O O R   R MM MM A   A   T
     1179     5617              F     O O O R   R M M M A   A   T
     1180     5618              FFFF  O  OO RRRR  M   M AAAAA   T
     1181     5619              F     O   O R R   M   M A   A   T
     1182     5620              F     O   O R  R  M   M A   A   T
     1183     5621              F      OOO  R   R M   M A   A   T
     1184     5622
     1185     5623
     1186     5624          RRRR   OOO  U   U TTTTT  III  N   N EEEEE  SSS
     1187     5625          R   R O O O U   U   T     I   N   N E     S   S
     1188     5626          R   R O O O U   U   T     I   NN  N E     S
     1189     5627          RRRR  O  OO U   U   T     I   N N N EEEE   SSS
     1190     5628          R R   O   O U   U   T     I   N  NN E         S
     1191     5629          R  R  O   O U   U   T     I   N   N E     S   S
     1192     5630          R   R  OOO   UUU    T    III  N   N EEEEE  SSS
     1193     5631
     1194     5632        */
     1195     5633
     1196     5634
     1197     5635                                /* ROUTINE TO FORMAT FIRST PART OF
     1198     5636                                   OUTSF AND OUTNS MESSAGES */
     1199     5637    1   FMT_OUTP: PROC;

   5637  6 003053   200034 741300       FMT_OUTP     STX1  ! ADD_RES_ATTR+2,,AUTO

     1200     5638
     1201     5639    2         CALL FMT_OSYSID;

   5639  6 003054   003175 701000 6                  TSX1    FMT_OSYSID
         6 003055   000000 011000                    NOP     0

     1202     5640              %ADDSTR (S="'-'");

   5642  6 003056   200013 235100                    LDA     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:157  
         6 003057   040005 100400                    MLR     fill='040'O
         6 003060   000007 000001 7                  ADSC9   7                        cn=0,n=1
         6 003061   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5643  6 003062   200013 054100                    AOS     LEN,,AUTO

     1203     5645              %ADDNUM (N="BUF$->A$OUTPUT.NUM");

   5647  6 003063   200007 470500                    LDP0    BUF$,,AUTO
         6 003064   000005 236100                    LDQ     5,,PR0
         6 003065   777777 376007                    ANQ     -1,DL
         6 003066   000000 235003                    LDA     0,DU
         6 003067   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 003070   000000 301500                    BTD
         6 003071   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 003072   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5648  6 003073   005304 701000 6                  TSX1    INS_NUM
         6 003074   000000 011000                    NOP     0

     1204     5650    2         CALL FMT_OACCT;

   5650  6 003075   003276 701000 6                  TSX1    FMT_OACCT
         6 003076   000000 011000                    NOP     0

     1205     5651              %ADDSTR (S="': '");

   5653  6 003077   200013 235100                    LDA     LEN,,AUTO
         6 003100   040005 100400                    MLR     fill='040'O
         6 003101   000627 000002 2                  ADSC9   FPT_DISPLAY+243          cn=0,n=2
         6 003102   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5654  6 003103   000002 236007                    LDQ     2,DL
         6 003104   200013 056100                    ASQ     LEN,,AUTO

     1206     5656              %ADDTXT (T="BUF$->A$OUTPUT.DEVTYP");

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:158  
   5658  6 003105   200007 470500                    LDP0    BUF$,,AUTO
         6 003106   040000 100500                    MLR     fill='040'O
         6 003107   000002 000002                    ADSC9   2,,PR0                   cn=0,n=2
         6 003110   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5659  6 003111   005357 701000 6                  TSX1    INS_TXT
         6 003112   000000 011000                    NOP     0

     1207     5661    2         IF OD_CXT.SWSN ~= BUF$->A$OUTPUT.WOD THEN

   5661  6 003113   200007 470500                    LDP0    BUF$,,AUTO
         6 003114   040100 106400                    CMPC    fill='040'O
         6 003115   000015 000010 xsym               ADSC9   OD_CXT+13                cn=0,n=8
         6 003116   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         6 003117   003132 600000 6                  TZE     s:5674

     1208     5662    3           DO;

     1209     5663                %ADDSTR (S="'@'");

   5665  6 003120   200013 235100                    LDA     LEN,,AUTO
         6 003121   040005 100400                    MLR     fill='040'O
         6 003122   000005 000001 7                  ADSC9   5                        cn=0,n=1
         6 003123   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5666  6 003124   200013 054100                    AOS     LEN,,AUTO

     1210     5668                %ADDTXT (T="BUF$->A$OUTPUT.WOD");

   5670  6 003125   040000 100500                    MLR     fill='040'O
         6 003126   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         6 003127   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5671  6 003130   005357 701000 6                  TSX1    INS_TXT
         6 003131   000000 011000                    NOP     0

     1211     5673    3           END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:159  

     1212     5674    2         IF  BUF$->A$OUTPUT.FORM ~= 'STDLP'

   5674  6 003132   200007 470500                    LDP0    BUF$,,AUTO
         6 003133   040000 106500                    CMPC    fill='040'O
         6 003134   000007 000006                    ADSC9   7,,PR0                   cn=0,n=6
         6 003135   000630 000005 2                  ADSC9   FPT_DISPLAY+244          cn=0,n=5
         6 003136   003163 600000 6                  TZE     s:5693
         6 003137   040000 106500                    CMPC    fill='040'O
         6 003140   000007 000006                    ADSC9   7,,PR0                   cn=0,n=6
         6 003141   000632 000005 2                  ADSC9   FPT_DISPLAY+246          cn=0,n=5
         6 003142   003163 600000 6                  TZE     s:5693

     1213     5675    2         AND BUF$->A$OUTPUT.FORM ~= 'STD**' THEN
     1214     5676    3           DO;

     1215     5677                %ADDSTR (S="' ['");

   5679  6 003143   200013 235100                    LDA     LEN,,AUTO
         6 003144   040005 100400                    MLR     fill='040'O
         6 003145   000634 000002 2                  ADSC9   FPT_DISPLAY+248          cn=0,n=2
         6 003146   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5680  6 003147   000002 236007                    LDQ     2,DL
         6 003150   200013 056100                    ASQ     LEN,,AUTO

     1216     5682                %ADDTXT (T="BUF$->A$OUTPUT.FORM");

   5684  6 003151   040000 100500                    MLR     fill='040'O
         6 003152   000007 000006                    ADSC9   7,,PR0                   cn=0,n=6
         6 003153   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5685  6 003154   005357 701000 6                  TSX1    INS_TXT
         6 003155   000000 011000                    NOP     0

     1217     5687                %ADDSTR (S="']'");

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:160  
   5689  6 003156   200013 235100                    LDA     LEN,,AUTO
         6 003157   040005 100400                    MLR     fill='040'O
         6 003160   000010 000001 7                  ADSC9   8                        cn=0,n=1
         6 003161   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5690  6 003162   200013 054100                    AOS     LEN,,AUTO

     1218     5692    3           END;

     1219     5693    2         RETURN;

   5693  6 003163   200034 221300                    LDX1  ! ADD_RES_ATTR+2,,AUTO
         6 003164   000001 702211                    TSX2  ! 1,X1

     1220     5694    2   END FMT_OUTP;
     1221     5695
     1222     5696
     1223     5697                                /* FORMAT 'SYSID N' */
     1224     5698    1   FMT_SYSID: PROC;

   5698  6 003165   200036 741300       FMT_SYSID    STX1  ! ADD_RES_ATTR+4,,AUTO

     1225     5699
     1226     5700        %ADDSTR (S=' Sysid ');

   5702  6 003166   200013 235100                    LDA     LEN,,AUTO
         6 003167   040005 100400                    MLR     fill='040'O
         6 003170   000635 000007 2                  ADSC9   FPT_DISPLAY+249          cn=0,n=7
         6 003171   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   5703  6 003172   000007 236007                    LDQ     7,DL
         6 003173   200013 056100                    ASQ     LEN,,AUTO

     1227     5705    2         GOTO FMTS;

   5705  6 003174   003231 710000 6                  TRA     FMTS

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:161  
     1228     5706                                /* FORMAT 'OUTPUT SYSID N' */
     1229     5707    2   FMT_OSYSID: ENTRY;

   5707  6 003175   200036 741300       FMT_OSYSID   STX1  ! ADD_RES_ATTR+4,,AUTO

     1230     5708              %ADDSTR (S="' Output sysid '");

   5710  6 003176   200013 235100                    LDA     LEN,,AUTO
         6 003177   040005 100400                    MLR     fill='040'O
         6 003200   000637 000016 2                  ADSC9   FPT_DISPLAY+251          cn=0,n=14
         6 003201   000500 000016 1                  ADSC9   OBUF,A                   cn=0,n=14

   5711  6 003202   000016 236007                    LDQ     14,DL
         6 003203   200013 056100                    ASQ     LEN,,AUTO

     1231     5713              %ADDNUM (N="BUF$->A$OUTPUT.SYSID");

   5715  6 003204   200007 470500                    LDP0    BUF$,,AUTO
         6 003205   000005 236100                    LDQ     5,,PR0
         6 003206   000022 772000                    QRL     18
         6 003207   000000 235003                    LDA     0,DU
         6 003210   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 003211   000000 301500                    BTD
         6 003212   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 003213   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5716  6 003214   005304 701000 6                  TSX1    INS_NUM
         6 003215   000000 011000                    NOP     0

     1232     5718    2         CALL INS_OBUF;

   5718  6 003216   005153 701000 6                  TSX1    INS_OBUF
         6 003217   000000 011000                    NOP     0

     1233     5719    2         RETURN;

   5719  6 003220   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:162  
         6 003221   000001 702211                    TSX2  ! 1,X1

     1234     5720                                /* FORMAT 'JOB N' */
     1235     5721    2   FMT_JOB: ENTRY;

   5721  6 003222   200036 741300       FMT_JOB      STX1  ! ADD_RES_ATTR+4,,AUTO

     1236     5722              %ADDSTR (S="' Job '");

   5724  6 003223   200013 235100                    LDA     LEN,,AUTO
         6 003224   040005 100400                    MLR     fill='040'O
         6 003225   000643 000005 2                  ADSC9   FPT_DISPLAY+255          cn=0,n=5
         6 003226   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   5725  6 003227   000005 236007                    LDQ     5,DL
         6 003230   200013 056100                    ASQ     LEN,,AUTO

   5725  6 003231                       FMTS         null
     1237     5727    2   FMTS: ;
     1238     5728              %ADDNUM (N="BUF$->A$INPUT.SYSID");

   5730  6 003231   200007 470500                    LDP0    BUF$,,AUTO
         6 003232   000006 236100                    LDQ     6,,PR0
         6 003233   777777 376007                    ANQ     -1,DL
         6 003234   000000 235003                    LDA     0,DU
         6 003235   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 003236   000000 301500                    BTD
         6 003237   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 003240   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5731  6 003241   005304 701000 6                  TSX1    INS_NUM
         6 003242   000000 011000                    NOP     0

     1239     5733    2         CALL INS_OBUF;

   5733  6 003243   005153 701000 6                  TSX1    INS_OBUF
         6 003244   000000 011000                    NOP     0
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:163  

     1240     5734    2         RETURN;

   5734  6 003245   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 003246   000001 702211                    TSX2  ! 1,X1

     1241     5735    2   END FMT_SYSID;
     1242     5736
     1243     5737
     1244     5738
     1245     5739                                /* FORMAT JOBNAME,ACCOUNT */
     1246     5740    1   FMT_JA: PROC;

   5740  6 003247   200036 741300       FMT_JA       STX1  ! ADD_RES_ATTR+4,,AUTO

     1247     5741
     1248     5742        %ADDSTR (S="' ('");

   5744  6 003250   200013 235100                    LDA     LEN,,AUTO
         6 003251   040005 100400                    MLR     fill='040'O
         6 003252   000626 000002 2                  ADSC9   FPT_DISPLAY+242          cn=0,n=2
         6 003253   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5745  6 003254   000002 236007                    LDQ     2,DL
         6 003255   200013 056100                    ASQ     LEN,,AUTO

     1249     5747    2         IF BUF$->A$INPUT.JNAME ~= ' ' THEN

   5747  6 003256   200007 470500                    LDP0    BUF$,,AUTO
         6 003257   040000 106500                    CMPC    fill='040'O
         6 003260   000021 000037                    ADSC9   17,,PR0                  cn=0,n=31
         6 003261   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003262   003275 600000 6                  TZE     s:5760

     1250     5748    3           DO;

     1251     5749                %ADDTXT (T="BUF$->A$INPUT.JNAME");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:164  

   5751  6 003263   040000 100500                    MLR     fill='040'O
         6 003264   000021 000037                    ADSC9   17,,PR0                  cn=0,n=31
         6 003265   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5752  6 003266   005357 701000 6                  TSX1    INS_TXT
         6 003267   000000 011000                    NOP     0

     1252     5754                %ADDSTR (S="'.'");

   5756  6 003270   200013 235100                    LDA     LEN,,AUTO
         6 003271   040005 100400                    MLR     fill='040'O
         6 003272   000011 000001 7                  ADSC9   9                        cn=0,n=1
         6 003273   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5757  6 003274   200013 054100                    AOS     LEN,,AUTO

     1253     5759    3           END;

     1254     5760    2         GOTO FMTA;

   5760  6 003275   003342 710000 6                  TRA     FMTA

     1255     5761                                /* FORMAT OUTPUT JOBNAME & ACCOUNT */
     1256     5762    2   FMT_OACCT: ENTRY;

   5762  6 003276   200036 741300       FMT_OACCT    STX1  ! ADD_RES_ATTR+4,,AUTO

     1257     5763              %ADDSTR (S="' ('");

   5765  6 003277   200013 235100                    LDA     LEN,,AUTO
         6 003300   040005 100400                    MLR     fill='040'O
         6 003301   000626 000002 2                  ADSC9   FPT_DISPLAY+242          cn=0,n=2
         6 003302   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5766  6 003303   000002 236007                    LDQ     2,DL
         6 003304   200013 056100                    ASQ     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:165  

     1258     5768    2         IF BUF$->A$OUTPUT.JNAME ~= ' ' THEN

   5768  6 003305   200007 470500                    LDP0    BUF$,,AUTO
         6 003306   040000 106500                    CMPC    fill='040'O
         6 003307   000013 000037                    ADSC9   11,,PR0                  cn=0,n=31
         6 003310   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 003311   003324 600000 6                  TZE     s:5783

     1259     5769    3           DO;

     1260     5770                %ADDTXT (T="BUF$->A$OUTPUT.JNAME");

   5772  6 003312   040000 100500                    MLR     fill='040'O
         6 003313   000013 000037                    ADSC9   11,,PR0                  cn=0,n=31
         6 003314   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5773  6 003315   005357 701000 6                  TSX1    INS_TXT
         6 003316   000000 011000                    NOP     0

     1261     5775                %ADDSTR (S="'.'");

   5777  6 003317   200013 235100                    LDA     LEN,,AUTO
         6 003320   040005 100400                    MLR     fill='040'O
         6 003321   000011 000001 7                  ADSC9   9                        cn=0,n=1
         6 003322   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5778  6 003323   200013 054100                    AOS     LEN,,AUTO

     1262     5780    3           END;

     1263     5781              %ADDTXT (T="BUF$->A$OUTPUT.ACCT");

   5783  6 003324   200007 470500                    LDP0    BUF$,,AUTO
         6 003325   040000 100500                    MLR     fill='040'O
         6 003326   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         6 003327   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:166  

   5784  6 003330   005357 701000 6                  TSX1    INS_TXT
         6 003331   000000 011000                    NOP     0

     1264     5786    2         GOTO FMTA1;

   5786  6 003332   003350 710000 6                  TRA     FMTA1

     1265     5787                                /* FORMAT ACCOUNT ONLY */
     1266     5788    2   FMT_ACCT: ENTRY;

   5788  6 003333   200036 741300       FMT_ACCT     STX1  ! ADD_RES_ATTR+4,,AUTO

     1267     5789              %ADDSTR (S="' ('");

   5791  6 003334   200013 235100                    LDA     LEN,,AUTO
         6 003335   040005 100400                    MLR     fill='040'O
         6 003336   000626 000002 2                  ADSC9   FPT_DISPLAY+242          cn=0,n=2
         6 003337   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5792  6 003340   000002 236007                    LDQ     2,DL
         6 003341   200013 056100                    ASQ     LEN,,AUTO

   5792  6 003342                       FMTA         null
     1268     5794    2   FMTA: ;
     1269     5795              %ADDTXT (T="BUF$->A$INPUT.ACCT");

   5797  6 003342   200007 470500                    LDP0    BUF$,,AUTO
         6 003343   040000 100500                    MLR     fill='040'O
         6 003344   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         6 003345   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5798  6 003346   005357 701000 6                  TSX1    INS_TXT
         6 003347   000000 011000                    NOP     0

   5797  6 003350                       FMTA1        null
     1270     5800    2   FMTA1:;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:167  
     1271     5801              %ADDSTR (S="')'");

   5803  6 003350   200013 235100                    LDA     LEN,,AUTO
         6 003351   040005 100400                    MLR     fill='040'O
         6 003352   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 003353   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5804  6 003354   200013 054100                    AOS     LEN,,AUTO

     1272     5806    2         CALL INS_OBUF;

   5806  6 003355   005153 701000 6                  TSX1    INS_OBUF
         6 003356   000000 011000                    NOP     0

     1273     5807    2         RETURN;

   5807  6 003357   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 003360   000001 702211                    TSX2  ! 1,X1

     1274     5808    2   END FMT_JA;
     1275     5809
     1276     5810
     1277     5811
     1278     5812                                /* FORMAT WSN,WOO */
     1279     5813    1   FMT_WW: PROC;

   5813  6 003361   200034 741300       FMT_WW       STX1  ! ADD_RES_ATTR+2,,AUTO

     1280     5814
     1281     5815    2         IF OD_CXT.LPWSN ~= BUF$->A$INPUT.WSN

   5815  6 003362   200007 470500                    LDP0    BUF$,,AUTO
         6 003363   040100 106400                    CMPC    fill='040'O
         6 003364   000011 000010 xsym               ADSC9   OD_CXT+9                 cn=0,n=8
         6 003365   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         6 003366   003373 601000 6                  TNZ     s:5820
         6 003367   040100 106400                    CMPC    fill='040'O
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:168  
         6 003370   000011 000010 xsym               ADSC9   OD_CXT+9                 cn=0,n=8
         6 003371   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         6 003372   003435 600000 6                  TZE     s:5848

     1282     5816    2         OR OD_CXT.LPWSN ~= BUF$->A$INPUT.WOO THEN
     1283     5817    3           DO;

     1284     5818                %ADDSTR (S="' ['");

   5820  6 003373   200013 235100                    LDA     LEN,,AUTO
         6 003374   040005 100400                    MLR     fill='040'O
         6 003375   000634 000002 2                  ADSC9   FPT_DISPLAY+248          cn=0,n=2
         6 003376   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5821  6 003377   000002 236007                    LDQ     2,DL
         6 003400   200013 056100                    ASQ     LEN,,AUTO

     1285     5823                %ADDTXT (T="BUF$->A$INPUT.WOO");

   5825  6 003401   040000 100500                    MLR     fill='040'O
         6 003402   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         6 003403   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5826  6 003404   005357 701000 6                  TSX1    INS_TXT
         6 003405   000000 011000                    NOP     0

     1286     5828    3           IF BUF$->A$INPUT.WSN ~= BUF$->A$INPUT.WOO THEN

   5828  6 003406   200007 470500                    LDP0    BUF$,,AUTO
         6 003407   040100 106500                    CMPC    fill='040'O
         6 003410   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         6 003411   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         6 003412   003426 600000 6                  TZE     s:5843

     1287     5829    4             DO;

     1288     5830                  %ADDSTR (S="'->'");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:169  

   5832  6 003413   200013 235100                    LDA     LEN,,AUTO
         6 003414   040005 100400                    MLR     fill='040'O
         6 003415   000645 000002 2                  ADSC9   FPT_DISPLAY+257          cn=0,n=2
         6 003416   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5833  6 003417   000002 236007                    LDQ     2,DL
         6 003420   200013 056100                    ASQ     LEN,,AUTO

     1289     5835                  %ADDTXT (T="BUF$->A$INPUT.WSN");

   5837  6 003421   040000 100500                    MLR     fill='040'O
         6 003422   000017 000010                    ADSC9   15,,PR0                  cn=0,n=8
         6 003423   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   5838  6 003424   005357 701000 6                  TSX1    INS_TXT
         6 003425   000000 011000                    NOP     0

     1290     5840    4             END;

     1291     5841                %ADDSTR (S="']'");

   5843  6 003426   200013 235100                    LDA     LEN,,AUTO
         6 003427   040005 100400                    MLR     fill='040'O
         6 003430   000010 000001 7                  ADSC9   8                        cn=0,n=1
         6 003431   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5844  6 003432   200013 054100                    AOS     LEN,,AUTO

     1292     5846    3           CALL INS_OBUF;

   5846  6 003433   005153 701000 6                  TSX1    INS_OBUF
         6 003434   000000 011000                    NOP     0

     1293     5847    3           END;

     1294     5848    2         RETURN;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:170  

   5848  6 003435   200034 221300                    LDX1  ! ADD_RES_ATTR+2,,AUTO
         6 003436   000001 702211                    TSX2  ! 1,X1

     1295     5849    2   END FMT_WW;
     1296     5850
     1297     5851
     1298     5852
     1299     5853                                /* FORMAT ORDER,ACCOUNT,NORERUN */
     1300     5854    1   FMT_OAN: PROC;

   5854  6 003437   200034 741300       FMT_OAN      STX1  ! ADD_RES_ATTR+2,,AUTO

     1301     5855
     1302     5856    2         IF BUF$->A$INPUT.FLG.O1

   5856  6 003440   200007 470500                    LDP0    BUF$,,AUTO
         6 003441   000006 234100                    SZN     6,,PR0
         6 003442   003450 604000 6                  TMI     s:5862
         6 003443   000006 236100                    LDQ     6,,PR0
         6 003444   040000 316003                    CANQ    16384,DU
         6 003445   003450 601000 6                  TNZ     s:5862
         6 003446   020000 316003                    CANQ    8192,DU
         6 003447   003513 601000 6                  TNZ     s:5896

     1303     5857    2         OR BUF$->A$INPUT.FLG.ACC
     1304     5858    2         OR (NOT BUF$->A$INPUT.FLG.RR) THEN
     1305     5859    3           DO;

     1306     5860                %ADDSTR (S="' ('");

   5862  6 003450   200013 235100                    LDA     LEN,,AUTO
         6 003451   040005 100400                    MLR     fill='040'O
         6 003452   000626 000002 2                  ADSC9   FPT_DISPLAY+242          cn=0,n=2
         6 003453   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   5863  6 003454   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:171  
         6 003455   200013 056100                    ASQ     LEN,,AUTO

     1307     5865    3           IF BUF$->A$INPUT.FLG.O1 THEN

   5865  6 003456   000006 234100                    SZN     6,,PR0
         6 003457   003465 605000 6                  TPL     s:5873

     1308     5866    4             DO;

     1309     5867                  %ADDSTR (S='O');

   5869  6 003460   200013 235100                    LDA     LEN,,AUTO
         6 003461   040005 100400                    MLR     fill='040'O
         6 003462   000012 000001 7                  ADSC9   10                       cn=0,n=1
         6 003463   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5870  6 003464   200013 054100                    AOS     LEN,,AUTO

     1310     5872    4             END;

     1311     5873    3           IF BUF$->A$INPUT.FLG.ACC THEN

   5873  6 003465   000006 236100                    LDQ     6,,PR0
         6 003466   040000 316003                    CANQ    16384,DU
         6 003467   003475 600000 6                  TZE     s:5881

     1312     5874    4             DO;

     1313     5875                  %ADDSTR (S='A');

   5877  6 003470   200013 235100                    LDA     LEN,,AUTO
         6 003471   040005 100400                    MLR     fill='040'O
         6 003472   000013 000001 7                  ADSC9   11                       cn=0,n=1
         6 003473   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5878  6 003474   200013 054100                    AOS     LEN,,AUTO

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:172  
     1314     5880    4             END;

     1315     5881    3           IF NOT BUF$->A$INPUT.FLG.RR THEN

   5881  6 003475   020000 316003                    CANQ    8192,DU
         6 003476   003504 601000 6                  TNZ     s:5891

     1316     5882    4             DO;

     1317     5883                  %ADDSTR (S='N');

   5885  6 003477   200013 235100                    LDA     LEN,,AUTO
         6 003500   040005 100400                    MLR     fill='040'O
         6 003501   000014 000001 7                  ADSC9   12                       cn=0,n=1
         6 003502   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5886  6 003503   200013 054100                    AOS     LEN,,AUTO

     1318     5888    4             END;

     1319     5889                %ADDSTR (S="')'");

   5891  6 003504   200013 235100                    LDA     LEN,,AUTO
         6 003505   040005 100400                    MLR     fill='040'O
         6 003506   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 003507   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   5892  6 003510   200013 054100                    AOS     LEN,,AUTO

     1320     5894    3           CALL INS_OBUF;

   5894  6 003511   005153 701000 6                  TSX1    INS_OBUF
         6 003512   000000 011000                    NOP     0

     1321     5895    3           END;

     1322     5896    2         RETURN;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:173  

   5896  6 003513   200034 221300                    LDX1  ! ADD_RES_ATTR+2,,AUTO
         6 003514   000001 702211                    TSX2  ! 1,X1

     1323     5897    2   END FMT_OAN;
     1324     5898
     1325     5899
     1326     5900
     1327     5901                                /* FORMAT POSITION IN Q */
     1328     5902    1   FMT_POS: PROC;

   5902  6 003515   200034 741300       FMT_POS      STX1  ! ADD_RES_ATTR+2,,AUTO

     1329     5903
     1330     5904                %ADDSTR (S="' prio '");

   5906  6 003516   200013 235100                    LDA     LEN,,AUTO
         6 003517   040005 100400                    MLR     fill='040'O
         6 003520   000646 000006 2                  ADSC9   FPT_DISPLAY+258          cn=0,n=6
         6 003521   000500 000006 1                  ADSC9   OBUF,A                   cn=0,n=6

   5907  6 003522   000006 236007                    LDQ     6,DL
         6 003523   200013 056100                    ASQ     LEN,,AUTO

     1331     5909                %ADDNUM (N="BUF$->A$INPUT.IPRIO");

   5911  6 003524   200007 470500                    LDP0    BUF$,,AUTO
         6 003525   000003 236100                    LDQ     3,,PR0
         6 003526   000011 772000                    QRL     9
         6 003527   000777 376007                    ANQ     511,DL
         6 003530   000000 235003                    LDA     0,DU
         6 003531   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 003532   000000 301500                    BTD
         6 003533   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 003534   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   5912  6 003535   005304 701000 6                  TSX1    INS_NUM
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:174  
         6 003536   000000 011000                    NOP     0

     1332     5914    2         CALL INS_OBUF;

   5914  6 003537   005153 701000 6                  TSX1    INS_OBUF
         6 003540   000000 011000                    NOP     0

     1333     5915
     1334     5916    3           DO CASE (BUF$->A$INPUT.PRIO);

   5916  6 003541   200007 470500                    LDP0    BUF$,,AUTO
         6 003542   000003 236100                    LDQ     3,,PR0
         6 003543   000777 376007                    ANQ     511,DL
         6 003544   000020 136007                    SBLQ    16,DL
         6 003545   000006 116007                    CMPQ    6,DL
         6 003546   003550 602006 6                  TNC     s:5916+7,QL
         6 003547   003755 710000 6                  TRA     s:6027
         6 003550   003567 710000 6                  TRA     s:5934
         6 003551   003777 710000 6                  TRA     s:6047
         6 003552   003556 710000 6                  TRA     s:5926
         6 003553   003746 710000 6                  TRA     s:6018
         6 003554   003755 710000 6                  TRA     s:6027
         6 003555   003746 710000 6                  TRA     s:6018

     1335     5917
     1336     5918
     1337     5919    3             CASE (%JP_FOLL#);

     1338     5920
     1339     5921
     1340     5922    3             CASE (%JP_RUNAFTER#);

     1341     5923
     1342     5924                    %ADDSTR (S="', deferred to'");

   5926  6 003556   200013 235100                    LDA     LEN,,AUTO
         6 003557   040005 100400                    MLR     fill='040'O
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:175  
         6 003560   000650 000015 2                  ADSC9   FPT_DISPLAY+260          cn=0,n=13
         6 003561   000500 000015 1                  ADSC9   OBUF,A                   cn=0,n=13

   5927  6 003562   000015 236007                    LDQ     13,DL
         6 003563   200013 056100                    ASQ     LEN,,AUTO

     1343     5929    3               CALL DO_DEFER;

   5929  6 003564   004065 701000 6                  TSX1    DO_DEFER
         6 003565   000000 011000                    NOP     0
         6 003566   003777 710000 6                  TRA     s:6047

     1344     5930
     1345     5931
     1346     5932    3             CASE (%JP_RUN#);

     1347     5933
     1348     5934    3               CALL M$DISPLAY (FPT_DISPLAY);

   5934  6 003567   000244 630400 2                  EPPR0   FPT_DISPLAY
         6 003570   020007 713400                    CLIMB   8199
         6 003571   400000 401760                    pmme    nvectors=1

     1349     5935    4                 DO CASE (VLR_DISPLAY.ETMF);

   5935  6 003572   000001 235000 1                  LDA     VLR_DISPLAY+1
         6 003573   000013 115007                    CMPA    11,DL
         6 003574   003576 602005 6                  TNC     s:5935+4,AL
         6 003575   003675 710000 6                  TRA     s:5986
         6 003576   003611 710000 6                  TRA     s:5937
         6 003577   003611 710000 6                  TRA     s:5937
         6 003600   003632 710000 6                  TRA     s:5956
         6 003601   003641 710000 6                  TRA     s:5962
         6 003602   003650 710000 6                  TRA     s:5968
         6 003603   003657 710000 6                  TRA     s:5974
         6 003604   003657 710000 6                  TRA     s:5974
         6 003605   003657 710000 6                  TRA     s:5974
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:176  
         6 003606   003666 710000 6                  TRA     s:5980
         6 003607   003666 710000 6                  TRA     s:5980
         6 003610   003666 710000 6                  TRA     s:5980

     1350     5936    4                   CASE (0,1);

     1351     5937    4                     IF VLR_DISPLAY.USERS <= JG_MING#+4 THEN

   5937  6 003611   000000 236000 1                  LDQ     VLR_DISPLAY
         6 003612   000024 116007                    CMPQ    20,DL
         6 003613   003623 603000 6                  TRC     s:5949

     1352     5938    5                       DO;

     1353     5939                            %ADDSTR (S="', at WARP 8'");

   5941  6 003614   200013 235100                    LDA     LEN,,AUTO
         6 003615   040005 100400                    MLR     fill='040'O
         6 003616   000654 000013 2                  ADSC9   FPT_DISPLAY+264          cn=0,n=11
         6 003617   000500 000013 1                  ADSC9   OBUF,A                   cn=0,n=11

   5942  6 003620   000013 236007                    LDQ     11,DL
         6 003621   200013 056100                    ASQ     LEN,,AUTO

     1354     5944    5                       END;

   5944  6 003622   003703 710000 6                  TRA     s:5992

     1355     5945    4                     ELSE
     1356     5946    5                       DO;

     1357     5947                            %ADDSTR (S="', zipping along'");

   5949  6 003623   200013 235100                    LDA     LEN,,AUTO
         6 003624   040005 100400                    MLR     fill='040'O
         6 003625   000657 000017 2                  ADSC9   FPT_DISPLAY+267          cn=0,n=15
         6 003626   000500 000017 1                  ADSC9   OBUF,A                   cn=0,n=15
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:177  

   5950  6 003627   000017 236007                    LDQ     15,DL
         6 003630   200013 056100                    ASQ     LEN,,AUTO

     1358     5952    5                       END;

   5952  6 003631   003703 710000 6                  TRA     s:5992

     1359     5953    4                   CASE (2);

     1360     5954                          %ADDSTR (S="', running'");

   5956  6 003632   200013 236100                    LDQ     LEN,,AUTO
         6 003633   040006 100400                    MLR     fill='040'O
         6 003634   000663 000011 2                  ADSC9   FPT_DISPLAY+271          cn=0,n=9
         6 003635   000500 000011 1                  ADSC9   OBUF,Q                   cn=0,n=9

   5957  6 003636   000011 236007                    LDQ     9,DL
         6 003637   200013 056100                    ASQ     LEN,,AUTO
         6 003640   003703 710000 6                  TRA     s:5992

     1361     5959    4                   CASE (3);

     1362     5960                          %ADDSTR (S="', trotting'");

   5962  6 003641   200013 236100                    LDQ     LEN,,AUTO
         6 003642   040006 100400                    MLR     fill='040'O
         6 003643   000666 000012 2                  ADSC9   FPT_DISPLAY+274          cn=0,n=10
         6 003644   000500 000012 1                  ADSC9   OBUF,Q                   cn=0,n=10

   5963  6 003645   000012 236007                    LDQ     10,DL
         6 003646   200013 056100                    ASQ     LEN,,AUTO
         6 003647   003703 710000 6                  TRA     s:5992

     1363     5965    4                   CASE (4);

     1364     5966                          %ADDSTR (S="', walking'");
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:178  

   5968  6 003650   200013 236100                    LDQ     LEN,,AUTO
         6 003651   040006 100400                    MLR     fill='040'O
         6 003652   000671 000011 2                  ADSC9   FPT_DISPLAY+277          cn=0,n=9
         6 003653   000500 000011 1                  ADSC9   OBUF,Q                   cn=0,n=9

   5969  6 003654   000011 236007                    LDQ     9,DL
         6 003655   200013 056100                    ASQ     LEN,,AUTO
         6 003656   003703 710000 6                  TRA     s:5992

     1365     5971    4                   CASE (5,7,6);

     1366     5972                          %ADDSTR (S="', crawling'");

   5974  6 003657   200013 236100                    LDQ     LEN,,AUTO
         6 003660   040006 100400                    MLR     fill='040'O
         6 003661   000674 000012 2                  ADSC9   FPT_DISPLAY+280          cn=0,n=10
         6 003662   000500 000012 1                  ADSC9   OBUF,Q                   cn=0,n=10

   5975  6 003663   000012 236007                    LDQ     10,DL
         6 003664   200013 056100                    ASQ     LEN,,AUTO
         6 003665   003703 710000 6                  TRA     s:5992

     1367     5977    4                   CASE (8,9,10);

     1368     5978                          %ADDSTR (S="', stagnating'");

   5980  6 003666   200013 236100                    LDQ     LEN,,AUTO
         6 003667   040006 100400                    MLR     fill='040'O
         6 003670   000677 000014 2                  ADSC9   FPT_DISPLAY+283          cn=0,n=12
         6 003671   000500 000014 1                  ADSC9   OBUF,Q                   cn=0,n=12

   5981  6 003672   000014 236007                    LDQ     12,DL
         6 003673   200013 056100                    ASQ     LEN,,AUTO
         6 003674   003703 710000 6                  TRA     s:5992

     1369     5983    4                   CASE (ELSE);
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:179  

     1370     5984                          %ADDSTR (S="', putrefying'");

   5986  6 003675   200013 236100                    LDQ     LEN,,AUTO
         6 003676   040006 100400                    MLR     fill='040'O
         6 003677   000702 000014 2                  ADSC9   FPT_DISPLAY+286          cn=0,n=12
         6 003700   000500 000014 1                  ADSC9   OBUF,Q                   cn=0,n=12

   5987  6 003701   000014 236007                    LDQ     12,DL
         6 003702   200013 056100                    ASQ     LEN,,AUTO

     1371     5989    4                 END;

     1372     5990                    %ADDSTR (S="' since '");

   5992  6 003703   200013 235100                    LDA     LEN,,AUTO
         6 003704   040005 100400                    MLR     fill='040'O
         6 003705   000705 000007 2                  ADSC9   FPT_DISPLAY+289          cn=0,n=7
         6 003706   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   5993  6 003707   000007 236007                    LDQ     7,DL
         6 003710   200013 056100                    ASQ     LEN,,AUTO

     1373     5995    3               INUTS=BUF$->A$INPUT.START_TIME;

   5995  6 003711   200007 470500                    LDP0    BUF$,,AUTO
         6 003712   000005 235100                    LDA     5,,PR0
         6 003713   000276 755000 1                  STA     INUTS

     1374     5996    3               CALL M$TIME (GET_TIME);

   5996  6 003714   000676 630400 1                  EPPR0   GET_TIME
         6 003715   020004 713400                    CLIMB   8196
         6 003716   402000 401760                    pmme    nvectors=5

     1375     5997                    %ADDSTR (S="OUTTIME.HHMM");

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:180  
   5999  6 003717   200013 235100                    LDA     LEN,,AUTO
         6 003720   040005 100400                    MLR     fill='040'O
         6 003721   000272 000005 1                  ADSC9   OUTTIME                  cn=0,n=5
         6 003722   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   6000  6 003723   000005 236007                    LDQ     5,DL
         6 003724   200013 056100                    ASQ     LEN,,AUTO

     1376     6002                    %ADDSTR (S="' in part '");

   6004  6 003725   200013 235100                    LDA     LEN,,AUTO
         6 003726   040005 100400                    MLR     fill='040'O
         6 003727   000707 000011 2                  ADSC9   FPT_DISPLAY+291          cn=0,n=9
         6 003730   000500 000011 1                  ADSC9   OBUF,A                   cn=0,n=9

   6005  6 003731   000011 236007                    LDQ     9,DL
         6 003732   200013 056100                    ASQ     LEN,,AUTO

     1377     6007                    %ADDNUM (N="BUF$->A$INPUT.PNUM");

   6009  6 003733   200007 470500                    LDP0    BUF$,,AUTO
         6 003734   000003 236100                    LDQ     3,,PR0
         6 003735   000033 772000                    QRL     27
         6 003736   000000 235003                    LDA     0,DU
         6 003737   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 003740   000000 301500                    BTD
         6 003741   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 003742   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6010  6 003743   005304 701000 6                  TSX1    INS_NUM
         6 003744   000000 011000                    NOP     0
         6 003745   003777 710000 6                  TRA     s:6047

     1378     6012
     1379     6013
     1380     6014    3             CASE (%JP_WPART#,%JP_WPS#);

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:181  
     1381     6015
     1382     6016                    %ADDSTR (S="', NORUN'");

   6018  6 003746   200013 235100                    LDA     LEN,,AUTO
         6 003747   040005 100400                    MLR     fill='040'O
         6 003750   000712 000007 2                  ADSC9   FPT_DISPLAY+294          cn=0,n=7
         6 003751   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   6019  6 003752   000007 236007                    LDQ     7,DL
         6 003753   200013 056100                    ASQ     LEN,,AUTO
         6 003754   003777 710000 6                  TRA     s:6047

     1383     6021
     1384     6022
     1385     6023    3             CASE (ELSE);

     1386     6024
     1387     6025                    %ADDSTR (S="','");

   6027  6 003755   200013 235100                    LDA     LEN,,AUTO
         6 003756   040005 100400                    MLR     fill='040'O
         6 003757   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 003760   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6028  6 003761   200013 054100                    AOS     LEN,,AUTO

     1388     6030    3               IF BUF$->A$INPUT.AHEAD = 0 THEN

   6030  6 003762   000007 235100                    LDA     7,,PR0
         6 003763   003773 601000 6                  TNZ     s:6040

     1389     6031    4                 DO;

     1390     6032                      %ADDSTR (S="' *ready to rock*'");

   6034  6 003764   200013 235100                    LDA     LEN,,AUTO
         6 003765   040005 100400                    MLR     fill='040'O
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:182  
         6 003766   000714 000020 2                  ADSC9   FPT_DISPLAY+296          cn=0,n=16
         6 003767   000500 000020 1                  ADSC9   OBUF,A                   cn=0,n=16

   6035  6 003770   000020 236007                    LDQ     16,DL
         6 003771   200013 056100                    ASQ     LEN,,AUTO

     1391     6037    4                 END;

   6037  6 003772   003777 710000 6                  TRA     s:6047

     1392     6038    3               ELSE
     1393     6039    4                 DO;

     1394     6040    4                 POSN=BUF$->A$INPUT.AHEAD+1;

   6040  6 003773   000001 035007                    ADLA    1,DL
         6 003774   200005 755100                    STA     POSN,,AUTO

     1395     6041    4                 CALL FMT_POSN;

   6041  6 003775   004003 701000 6                  TSX1    FMT_POSN
         6 003776   000000 011000                    NOP     0

     1396     6042    4                 END;

     1397     6043
     1398     6044
     1399     6045    3           END;

     1400     6046
     1401     6047    2         CALL INS_OBUF;

   6047  6 003777   005153 701000 6                  TSX1    INS_OBUF
         6 004000   000000 011000                    NOP     0

     1402     6048    2         RETURN;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:183  
   6048  6 004001   200034 221300                    LDX1  ! ADD_RES_ATTR+2,,AUTO
         6 004002   000001 702211                    TSX2  ! 1,X1

     1403     6049    2   END FMT_POS;
     1404     6050    1   FMT_POSN: PROC;

   6050  6 004003   200036 741300       FMT_POSN     STX1  ! ADD_RES_ATTR+4,,AUTO

     1405     6051        %ADDSTR (S=' ');

   6053  6 004004   200013 235100                    LDA     LEN,,AUTO
         6 004005   040005 100400                    MLR     fill='040'O
         6 004006   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004007   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6054  6 004010   200013 054100                    AOS     LEN,,AUTO

     1406     6056                  %ADDNUM    (N="POSN");

   6058  6 004011   000000 301500                    BTD
         6 004012   200005 000004                    NDSC9   POSN,,AUTO               cn=0,s=lsgnf,sf=0,n=4
         6 004013   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6059  6 004014   005304 701000 6                  TSX1    INS_NUM
         6 004015   000000 011000                    NOP     0

     1407     6061    2         IF MOD(POSN,100) < 10

   6061  6 004016   200005 236100                    LDQ     POSN,,AUTO
         6 004017   000144 506007                    DIV     100,DL
         6 004020   000044 733000                    LRS     36
         6 004021   000012 116007                    CMPQ    10,DL
         6 004022   004030 604000 6                  TMI     s:6066
         6 004023   200005 236100                    LDQ     POSN,,AUTO
         6 004024   000144 506007                    DIV     100,DL
         6 004025   000044 733000                    LRS     36
         6 004026   000024 116007                    CMPQ    20,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:184  
         6 004027   004046 604400 6                  TMOZ    s:6074

     1408     6062    2         OR MOD(POSN,100) > 20 THEN
     1409     6063    3           DO;

     1410     6064                %ADDSTR (S="NUMEXTS(MOD(POSN,10))");

   6066  6 004030   200005 236100                    LDQ     POSN,,AUTO
         6 004031   000012 506007                    DIV     10,DL
         6 004032   200005 236100                    LDQ     POSN,,AUTO
         6 004033   000012 506007                    DIV     10,DL
         6 004034   000002 735000                    ALS     2
         6 004035   200013 236100                    LDQ     LEN,,AUTO
         6 004036   040006 100405                    MLR     fill='040'O
         6 004037   000446 000002 1                  ADSC9   NUMEXTS,A                cn=0,n=2
         6 004040   000500 000002 1                  ADSC9   OBUF,Q                   cn=0,n=2

   6067  6 004041   200005 236100                    LDQ     POSN,,AUTO
         6 004042   000012 506007                    DIV     10,DL
         6 004043   000002 236007                    LDQ     2,DL
         6 004044   200013 056100                    ASQ     LEN,,AUTO

     1411     6069    3           END;

   6069  6 004045   004063 710000 6                  TRA     s:6078

     1412     6070    2         ELSE
     1413     6071    3           DO;

     1414     6072                %ADDSTR (S="TEEN_NUMEXTS(MOD(POSN,10))");

   6074  6 004046   200005 236100                    LDQ     POSN,,AUTO
         6 004047   000012 506007                    DIV     10,DL
         6 004050   200005 236100                    LDQ     POSN,,AUTO
         6 004051   000012 506007                    DIV     10,DL
         6 004052   000002 735000                    ALS     2
         6 004053   200013 236100                    LDQ     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:185  
         6 004054   040006 100405                    MLR     fill='040'O
         6 004055   000460 000002 1                  ADSC9   TEEN_NUMEXTS,A           cn=0,n=2
         6 004056   000500 000002 1                  ADSC9   OBUF,Q                   cn=0,n=2

   6075  6 004057   200005 236100                    LDQ     POSN,,AUTO
         6 004060   000012 506007                    DIV     10,DL
         6 004061   000002 236007                    LDQ     2,DL
         6 004062   200013 056100                    ASQ     LEN,,AUTO

     1415     6077    3           END;

     1416     6078    2         RETURN;

   6078  6 004063   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004064   000001 702211                    TSX2  ! 1,X1

     1417     6079    2   END FMT_POSN;
     1418     6080
     1419     6081
     1420     6082
     1421     6083    1   DO_DEFER: PROC;

   6083  6 004065   200036 741300       DO_DEFER     STX1  ! ADD_RES_ATTR+4,,AUTO

     1422     6084
     1423     6085              %ADDSTR (S="' '");

   6087  6 004066   200013 235100                    LDA     LEN,,AUTO
         6 004067   040005 100400                    MLR     fill='040'O
         6 004070   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004071   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6088  6 004072   200013 054100                    AOS     LEN,,AUTO

     1424     6090    2         INUTS=BUF$->A$INPUT.RATIM;

   6090  6 004073   200007 470500                    LDP0    BUF$,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:186  
         6 004074   000031 235100                    LDA     25,,PR0
         6 004075   000276 755000 1                  STA     INUTS

     1425     6091    2         CALL M$TIME (GET_TIME);

   6091  6 004076   000676 630400 1                  EPPR0   GET_TIME
         6 004077   020004 713400                    CLIMB   8196
         6 004100   402000 401760                    pmme    nvectors=5

     1426     6092              %ADDSTR (S="OUTTIME.HHMM");

   6094  6 004101   200013 235100                    LDA     LEN,,AUTO
         6 004102   040005 100400                    MLR     fill='040'O
         6 004103   000272 000005 1                  ADSC9   OUTTIME                  cn=0,n=5
         6 004104   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   6095  6 004105   000005 236007                    LDQ     5,DL
         6 004106   200013 056100                    ASQ     LEN,,AUTO

     1427     6097              %ADDSTR (S="' '");

   6099  6 004107   200013 235100                    LDA     LEN,,AUTO
         6 004110   040005 100400                    MLR     fill='040'O
         6 004111   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004112   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6100  6 004113   200013 054100                    AOS     LEN,,AUTO

     1428     6102              %ADDTXT (T=OUTDATE);

   6104  6 004114   040000 100400                    MLR     fill='040'O
         6 004115   000300 000010 1                  ADSC9   OUTDATE                  cn=0,n=8
         6 004116   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   6105  6 004117   005357 701000 6                  TSX1    INS_TXT
         6 004120   000000 011000                    NOP     0

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:187  
     1429     6107    2         CALL INS_OBUF;

   6107  6 004121   005153 701000 6                  TSX1    INS_OBUF
         6 004122   000000 011000                    NOP     0

     1430     6108    2         RETURN;

   6108  6 004123   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004124   000001 702211                    TSX2  ! 1,X1

     1431     6109
     1432     6110    2   END DO_DEFER;
     1433     6111
     1434     6112
     1435     6113
     1436     6114                                /* FORMAT FOLLOW LIST */
     1437     6115    1   FMT_FOL: PROC;

   6115  6 004125   200034 741300       FMT_FOL      STX1  ! ADD_RES_ATTR+2,,AUTO

     1438     6116
     1439     6117    2         IF NOT BUF$->A$INPUT.FLG.O3 THEN RETURN;

   6117  6 004126   200007 470500                    LDP0    BUF$,,AUTO
         6 004127   000006 236100                    LDQ     6,,PR0
         6 004130   100000 316003                    CANQ    32768,DU
         6 004131   004133 601000 6                  TNZ     s:6120

   6117  6 004132   000001 702211                    TSX2  ! 1,X1

     1440     6118              %ADDSTR (S="' (follows '");

   6120  6 004133   200013 235100                    LDA     LEN,,AUTO
         6 004134   040005 100400                    MLR     fill='040'O
         6 004135   000720 000012 2                  ADSC9   FPT_DISPLAY+300          cn=0,n=10
         6 004136   000500 000012 1                  ADSC9   OBUF,A                   cn=0,n=10

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:188  
   6121  6 004137   000012 236007                    LDQ     10,DL
         6 004140   200013 056100                    ASQ     LEN,,AUTO

     1441     6123    2         CALL DO_FOLL;

   6123  6 004141   004154 701000 6                  TSX1    DO_FOLL
         6 004142   000000 011000                    NOP     0

     1442     6124              %ADDSTR (S="')'");

   6126  6 004143   200013 235100                    LDA     LEN,,AUTO
         6 004144   040005 100400                    MLR     fill='040'O
         6 004145   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 004146   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6127  6 004147   200013 054100                    AOS     LEN,,AUTO

     1443     6129    2         CALL INS_OBUF;

   6129  6 004150   005153 701000 6                  TSX1    INS_OBUF
         6 004151   000000 011000                    NOP     0

     1444     6130    2         RETURN;

   6130  6 004152   200034 221300                    LDX1  ! ADD_RES_ATTR+2,,AUTO
         6 004153   000001 702211                    TSX2  ! 1,X1

     1445     6131    2   END FMT_FOL;
     1446     6132
     1447     6133    1   DO_FOLL: PROC ALTRET;

   6133  6 004154   200036 741300       DO_FOLL      STX1  ! ADD_RES_ATTR+4,,AUTO

     1448     6134
     1449     6135    2         NFOLL=0;

   6135  6 004155   200015 450100                    STZ     NFOLL,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:189  

     1450     6136    3           DO WHILE (NFOLL < BUF$->A$INPUT.NFOLL);

   6136  6 004156   200007 470500                    LDP0    BUF$,,AUTO
         6 004157   000006 236100                    LDQ     6,,PR0
         6 004160   000022 772000                    QRL     18
         6 004161   000777 376007                    ANQ     511,DL
         6 004162   200015 116100                    CMPQ    NFOLL,,AUTO
         6 004163   004360 604400 6                  TMOZ    s:6227

     1451     6137    3           IF NFOLL ~= 0 THEN

   6137  6 004164   200015 235100                    LDA     NFOLL,,AUTO
         6 004165   004175 600000 6                  TZE     s:6146

     1452     6138    4             DO;

     1453     6139                  %ADDSTR (S="','");

   6141  6 004166   200013 236100                    LDQ     LEN,,AUTO
         6 004167   040006 100400                    MLR     fill='040'O
         6 004170   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 004171   000500 000001 1                  ADSC9   OBUF,Q                   cn=0,n=1

   6142  6 004172   200013 054100                    AOS     LEN,,AUTO

     1454     6144    4             CALL INS_OBUF;

   6144  6 004173   005153 701000 6                  TSX1    INS_OBUF
         6 004174   000000 011000                    NOP     0

     1455     6145    4             END;

     1456     6146    3           IF BUF$->A$INPUT.JDID.FOLLOW_TYPE(NFOLL) = %JM_FOLLOW_ACCOUNT THEN

   6146  6 004175   200007 470500                    LDP0    BUF$,,AUTO
         6 004176   200015 720100                    LXL0    NFOLL,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:190  
         6 004177   000041 236110                    LDQ     33,X0,PR0
         6 004200   070000 376003                    ANQ     28672,DU
         6 004201   040000 116003                    CMPQ    16384,DU
         6 004202   004217 601000 6                  TNZ     s:6163

     1457     6147    4             DO;

     1458     6148                  %ADDSTR (S="'All jobs .'");

   6150  6 004203   200013 235100                    LDA     LEN,,AUTO
         6 004204   040005 100400                    MLR     fill='040'O
         6 004205   000723 000012 2                  ADSC9   FPT_DISPLAY+303          cn=0,n=10
         6 004206   000500 000012 1                  ADSC9   OBUF,A                   cn=0,n=10

   6151  6 004207   000012 236007                    LDQ     10,DL
         6 004210   200013 056100                    ASQ     LEN,,AUTO

     1459     6153                  %ADDTXT (T="BUF$->A$INPUT.ACCT");

   6155  6 004211   040000 100500                    MLR     fill='040'O
         6 004212   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8
         6 004213   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   6156  6 004214   005357 701000 6                  TSX1    INS_TXT
         6 004215   000000 011000                    NOP     0

     1460     6158    4             END;

   6158  6 004216   004230 710000 6                  TRA     s:6167

     1461     6159    3           ELSE
     1462     6160    4             DO;

     1463     6161                  %ADDNUM (N="BUF$->A$INPUT.JDID.SYSID(NFOLL)");

   6163  6 004217   000041 236110                    LDQ     33,X0,PR0
         6 004220   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:191  
         6 004221   000000 235003                    LDA     0,DU
         6 004222   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 004223   000000 301500                    BTD
         6 004224   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 004225   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6164  6 004226   005304 701000 6                  TSX1    INS_NUM
         6 004227   000000 011000                    NOP     0

     1464     6166    4             END;

     1465     6167    3           IF BUF$->A$INPUT.JDID.SATISFIED(NFOLL) THEN

   6167  6 004230   200007 470500                    LDP0    BUF$,,AUTO
         6 004231   200015 720100                    LXL0    NFOLL,,AUTO
         6 004232   000041 236110                    LDQ     33,X0,PR0
         6 004233   000001 316003                    CANQ    1,DU
         6 004234   004244 600000 6                  TZE     s:6179

     1466     6168    4             DO;

     1467     6169                  %ADDSTR (S="'(Satisfied'");

   6171  6 004235   200013 235100                    LDA     LEN,,AUTO
         6 004236   040005 100400                    MLR     fill='040'O
         6 004237   000726 000012 2                  ADSC9   FPT_DISPLAY+306          cn=0,n=10
         6 004240   000500 000012 1                  ADSC9   OBUF,A                   cn=0,n=10

   6172  6 004241   000012 236007                    LDQ     10,DL
         6 004242   200013 056100                    ASQ     LEN,,AUTO

     1468     6174    4             END;

   6174  6 004243   004252 710000 6                  TRA     s:6183

     1469     6175    3           ELSE
     1470     6176    4             DO;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:192  

     1471     6177                  %ADDSTR (S="'(Unsatisfied'");

   6179  6 004244   200013 235100                    LDA     LEN,,AUTO
         6 004245   040005 100400                    MLR     fill='040'O
         6 004246   000731 000014 2                  ADSC9   FPT_DISPLAY+309          cn=0,n=12
         6 004247   000500 000014 1                  ADSC9   OBUF,A                   cn=0,n=12

   6180  6 004250   000014 236007                    LDQ     12,DL
         6 004251   200013 056100                    ASQ     LEN,,AUTO

     1472     6182    4             END;

     1473     6183    4             DO CASE (BUF$->A$INPUT.JDID.FOLLOW_TYPE(NFOLL));

   6183  6 004252   000041 236110                    LDQ     33,X0,PR0
         6 004253   000036 772000                    QRL     30
         6 004254   000007 376007                    ANQ     7,DL
         6 004255   000004 116007                    CMPQ    4,DL
         6 004256   004260 602006 6                  TNC     s:6183+6,QL
         6 004257   004344 710000 6                  TRA     s:6221
         6 004260   004264 710000 6                  TRA     s:6187
         6 004261   004320 710000 6                  TRA     s:6203
         6 004262   004327 710000 6                  TRA     s:6209
         6 004263   004336 710000 6                  TRA     s:6215

     1474     6184    4               CASE (%JM_FOLLOW_STEPCC);

     1475     6185                      %ADDSTR (S="',STEPCC'");

   6187  6 004264   200013 235100                    LDA     LEN,,AUTO
         6 004265   040005 100400                    MLR     fill='040'O
         6 004266   000734 000007 2                  ADSC9   FPT_DISPLAY+312          cn=0,n=7
         6 004267   000500 000007 1                  ADSC9   OBUF,A                   cn=0,n=7

   6188  6 004270   000007 236007                    LDQ     7,DL
         6 004271   200013 056100                    ASQ     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:193  

     1476     6190                      %ADDTXT (T="TXRELATIONS(BUF$->A$INPUT.JDID.RELATION(NFOLL))");

   6192  6 004272   000041 236110                    LDQ     33,X0,PR0
         6 004273   000041 772000                    QRL     33
         6 004274   000002 736000                    QLS     2
         6 004275   040000 100406                    MLR     fill='040'O
         6 004276   000472 000002 1                  ADSC9   TXRELATIONS,Q            cn=0,n=2
         6 004277   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   6193  6 004300   005357 701000 6                  TSX1    INS_TXT
         6 004301   000000 011000                    NOP     0

     1477     6195                      %ADDNUM (N="BUF$->A$INPUT.JDSTEPCC(NFOLL)");

   6197  6 004302   200007 470500                    LDP0    BUF$,,AUTO
         6 004303   200015 235100                    LDA     NFOLL,,AUTO
         6 004304   000100 101505                    MRL     fill='000'O
         6 004305   000051 000001                    ADSC9   41,A,PR0                 cn=0,n=1
         6 004306   200044 000004                    ADSC9   ADD_RES_ATTR+10,,AUTO    cn=0,n=4
         6 004307   200044 236100                    LDQ     ADD_RES_ATTR+10,,AUTO
         6 004310   000000 235003                    LDA     0,DU
         6 004311   200046 757100                    STAQ    ADD_RES_ATTR+12,,AUTO
         6 004312   000000 301500                    BTD
         6 004313   200046 000010                    NDSC9   ADD_RES_ATTR+12,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 004314   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6198  6 004315   005304 701000 6                  TSX1    INS_NUM
         6 004316   000000 011000                    NOP     0
         6 004317   004344 710000 6                  TRA     s:6221

     1478     6200    4               CASE (%JM_FOLLOW_OK);

     1479     6201                      %ADDSTR (S="',OK'");

   6203  6 004320   200013 235100                    LDA     LEN,,AUTO
         6 004321   040005 100400                    MLR     fill='040'O
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:194  
         6 004322   000736 000003 2                  ADSC9   FPT_DISPLAY+314          cn=0,n=3
         6 004323   000500 000003 1                  ADSC9   OBUF,A                   cn=0,n=3

   6204  6 004324   000003 236007                    LDQ     3,DL
         6 004325   200013 056100                    ASQ     LEN,,AUTO
         6 004326   004344 710000 6                  TRA     s:6221

     1480     6206    4               CASE (%JM_FOLLOW_ERROR);

     1481     6207                      %ADDSTR (S="',ERROR'");

   6209  6 004327   200013 235100                    LDA     LEN,,AUTO
         6 004330   040005 100400                    MLR     fill='040'O
         6 004331   000737 000006 2                  ADSC9   FPT_DISPLAY+315          cn=0,n=6
         6 004332   000500 000006 1                  ADSC9   OBUF,A                   cn=0,n=6

   6210  6 004333   000006 236007                    LDQ     6,DL
         6 004334   200013 056100                    ASQ     LEN,,AUTO
         6 004335   004344 710000 6                  TRA     s:6221

     1482     6212    4               CASE (%JM_FOLLOW_ABORT);

     1483     6213                      %ADDSTR (S="',ABORT'");

   6215  6 004336   200013 235100                    LDA     LEN,,AUTO
         6 004337   040005 100400                    MLR     fill='040'O
         6 004340   000741 000006 2                  ADSC9   FPT_DISPLAY+317          cn=0,n=6
         6 004341   000500 000006 1                  ADSC9   OBUF,A                   cn=0,n=6

   6216  6 004342   000006 236007                    LDQ     6,DL
         6 004343   200013 056100                    ASQ     LEN,,AUTO

     1484     6218    4             END;

     1485     6219                %ADDSTR (S="')'");

   6221  6 004344   200013 235100                    LDA     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:195  
         6 004345   040005 100400                    MLR     fill='040'O
         6 004346   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 004347   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6222  6 004350   200013 054100                    AOS     LEN,,AUTO

     1486     6224    3           NFOLL=NFOLL+1;

   6224  6 004351   200015 054100                    AOS     NFOLL,,AUTO

     1487     6225    3           END;

   6225  6 004352   200007 470500                    LDP0    BUF$,,AUTO
         6 004353   000006 236100                    LDQ     6,,PR0
         6 004354   000022 772000                    QRL     18
         6 004355   000777 376007                    ANQ     511,DL
         6 004356   200015 116100                    CMPQ    NFOLL,,AUTO
         6 004357   004164 605400 6                  TPNZ    s:6137

     1488     6226
     1489     6227    2         IF NFOLL ~= 0 THEN RETURN;

   6227  6 004360   200015 235100                    LDA     NFOLL,,AUTO
         6 004361   004364 600000 6                  TZE     s:6228

   6227  6 004362   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004363   000001 702211                    TSX2  ! 1,X1

     1490     6228    2         ALTRETURN;

   6228  6 004364   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004365   000000 702211                    TSX2  ! 0,X1

     1491     6229    2   END DO_FOLL;
     1492     6230
     1493     6231
     1494     6232
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:196  
     1495     6233
     1496     6234                                /* FORMAT RESOURCE REQUIREMENTS */
     1497     6235    1   FMT_RQL: PROC;

   6235  6 004366   200034 741300       FMT_RQL      STX1  ! ADD_RES_ATTR+2,,AUTO

     1498     6236
     1499     6237              %ADDSTR (S="' requires TIME='");

   6239  6 004367   200013 235100                    LDA     LEN,,AUTO
         6 004370   040005 100400                    MLR     fill='040'O
         6 004371   000743 000017 2                  ADSC9   FPT_DISPLAY+319          cn=0,n=15
         6 004372   000500 000017 1                  ADSC9   OBUF,A                   cn=0,n=15

   6240  6 004373   000017 236007                    LDQ     15,DL
         6 004374   200013 056100                    ASQ     LEN,,AUTO

     1500     6242    2         IF BUF$->A$INPUT.TIM/360000 ~= 0 THEN

   6242  6 004375   200007 470500                    LDP0    BUF$,,AUTO
         6 004376   000040 236100                    LDQ     32,,PR0
         6 004377   000001 772000                    QRL     1
         6 004400   537440 506007                    DIV     -82144,DL
         6 004401   000000 116003                    CMPQ    0,DU
         6 004402   004422 600000 6                  TZE     s:6257

     1501     6243    3           DO;

     1502     6244                %ADDNUM (N="BUF$->A$INPUT.TIM/360000");

   6246  6 004403   000040 236100                    LDQ     32,,PR0
         6 004404   000001 772000                    QRL     1
         6 004405   537440 506007                    DIV     -82144,DL
         6 004406   000000 235003                    LDA     0,DU
         6 004407   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 004410   000000 301500                    BTD
         6 004411   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:197  
         6 004412   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6247  6 004413   005304 701000 6                  TSX1    INS_NUM
         6 004414   000000 011000                    NOP     0

     1503     6249                %ADDSTR (S="':'");

   6251  6 004415   200013 235100                    LDA     LEN,,AUTO
         6 004416   040005 100400                    MLR     fill='040'O
         6 004417   000016 000001 7                  ADSC9   14                       cn=0,n=1
         6 004420   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6252  6 004421   200013 054100                    AOS     LEN,,AUTO

     1504     6254    3           END;

     1505     6255              %ADDNUM2 (N="MOD(BUF$->A$INPUT.TIM/6000,60)");

   6257  6 004422   200007 470500                    LDP0    BUF$,,AUTO
         6 004423   000040 236100                    LDQ     32,,PR0
         6 004424   000001 772000                    QRL     1
         6 004425   005670 506007                    DIV     3000,DL
         6 004426   000044 737000                    LLS     36
         6 004427   000043 773000                    LRL     35
         6 004430   000074 507007                    DVF     60,DL
         6 004431   000000 235003                    LDA     0,DU
         6 004432   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 004433   000000 301500                    BTD
         6 004434   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 004435   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6258  6 004436   005315 701000 6                  TSX1    INS_NUM2
         6 004437   000000 011000                    NOP     0

     1506     6260              %ADDSTR (S="':'");

   6262  6 004440   200013 235100                    LDA     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:198  
         6 004441   040005 100400                    MLR     fill='040'O
         6 004442   000016 000001 7                  ADSC9   14                       cn=0,n=1
         6 004443   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6263  6 004444   200013 054100                    AOS     LEN,,AUTO

     1507     6265              %ADDNUM2 (N="MOD(BUF$->A$INPUT.TIM/100,60)");

   6267  6 004445   200007 470500                    LDP0    BUF$,,AUTO
         6 004446   000040 236100                    LDQ     32,,PR0
         6 004447   000001 772000                    QRL     1
         6 004450   000062 506007                    DIV     50,DL
         6 004451   000044 737000                    LLS     36
         6 004452   000043 773000                    LRL     35
         6 004453   000074 507007                    DVF     60,DL
         6 004454   000000 235003                    LDA     0,DU
         6 004455   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 004456   000000 301500                    BTD
         6 004457   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 004460   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6268  6 004461   005315 701000 6                  TSX1    INS_NUM2
         6 004462   000000 011000                    NOP     0

     1508     6270    2         CALL INS_OBUF;

   6270  6 004463   005153 701000 6                  TSX1    INS_OBUF
         6 004464   000000 011000                    NOP     0

     1509     6271              %ADDSTR (S="' MEM='");

   6273  6 004465   200013 235100                    LDA     LEN,,AUTO
         6 004466   040005 100400                    MLR     fill='040'O
         6 004467   000747 000005 2                  ADSC9   FPT_DISPLAY+323          cn=0,n=5
         6 004470   000500 000005 1                  ADSC9   OBUF,A                   cn=0,n=5

   6274  6 004471   000005 236007                    LDQ     5,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:199  
         6 004472   200013 056100                    ASQ     LEN,,AUTO

     1510     6276              %ADDNUM (N="BUF$->A$INPUT.RRT(0)");

   6278  6 004473   200007 470500                    LDP0    BUF$,,AUTO
         6 004474   000032 236100                    LDQ     26,,PR0
         6 004475   000022 772000                    QRL     18
         6 004476   000000 235003                    LDA     0,DU
         6 004477   200044 757100                    STAQ    ADD_RES_ATTR+10,,AUTO
         6 004500   000000 301500                    BTD
         6 004501   200044 000010                    NDSC9   ADD_RES_ATTR+10,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 004502   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6279  6 004503   005304 701000 6                  TSX1    INS_NUM
         6 004504   000000 011000                    NOP     0

     1511     6281    2         CALL INS_OBUF;

   6281  6 004505   005153 701000 6                  TSX1    INS_OBUF
         6 004506   000000 011000                    NOP     0

     1512     6282
     1513     6283
     1514     6284                                /* PSEUDOS */
     1515     6285    2         CALL DO_PSEUDOS;

   6285  6 004507   004517 701000 6                  TSX1    DO_PSEUDOS
         6 004510   000000 011000                    NOP     0

     1516     6286
     1517     6287                                /* PACKSETS */
     1518     6288    2         CALL DO_PACKSETS;

   6288  6 004511   004610 701000 6                  TSX1    DO_PACKSETS
         6 004512   000000 011000                    NOP     0

     1519     6289
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:200  
     1520     6290                                /* PHYSICAL RESOURCES (E.G. MT'S) */
     1521     6291    2         CALL DO_PHYS;

   6291  6 004513   004747 701000 6                  TSX1    DO_PHYS
         6 004514   000000 011000                    NOP     0

     1522     6292
     1523     6293    2         RETURN;

   6293  6 004515   200034 221300                    LDX1  ! ADD_RES_ATTR+2,,AUTO
         6 004516   000001 702211                    TSX2  ! 1,X1

     1524     6294    2   END FMT_RQL;
     1525     6295
     1526     6296    1   DO_PSEUDOS: PROC ALTRET;

   6296  6 004517   200036 741300       DO_PSEUDOS   STX1  ! ADD_RES_ATTR+4,,AUTO

     1527     6297
     1528     6298    2         NPS=0;

   6298  6 004520   200026 450100                    STZ     NPS,,AUTO

     1529     6299    3           DO I = 4 TO 11;

   6299  6 004521   000004 235007                    LDA     4,DL
         6 004522   200006 755100                    STA     I,,AUTO

     1530     6300    3           IF BUF$->A$INPUT.RRT(I) ~= 0 THEN

   6300  6 004523   200006 235100                    LDA     I,,AUTO
         6 004524   000001 735000                    ALS     1
         6 004525   200007 470500                    LDP0    BUF$,,AUTO
         6 004526   000100 101505                    MRL     fill='000'O
         6 004527   000032 000002                    ADSC9   26,A,PR0                 cn=0,n=2
         6 004530   200044 000004                    ADSC9   ADD_RES_ATTR+10,,AUTO    cn=0,n=4
         6 004531   200044 236100                    LDQ     ADD_RES_ATTR+10,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:201  
         6 004532   000000 116003                    CMPQ    0,DU
         6 004533   004576 600000 6                  TZE     s:6325

     1531     6301    4             DO;

     1532     6302    4             NPS=NPS+1;

   6302  6 004534   200026 054100                    AOS     NPS,,AUTO

     1533     6303                  %ADDSTR (S=' ');

   6305  6 004535   200013 236100                    LDQ     LEN,,AUTO
         6 004536   040006 100400                    MLR     fill='040'O
         6 004537   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004540   000500 000001 1                  ADSC9   OBUF,Q                   cn=0,n=1

   6306  6 004541   200013 054100                    AOS     LEN,,AUTO

     1534     6308                  %ADDTXT (T="OD_PSEUDOS.PSLIST.PSEUDO#(I-4)");

   6310  6 004542   200006 236100                    LDQ     I,,AUTO
         6 004543   000014 402007                    MPY     12,DL
         6 004544   040000 100406                    MLR     fill='040'O
         6 004545   777770 000010 xsym               ADSC9   OD_PSEUDOS-8,Q           cn=0,n=8
         6 004546   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   6311  6 004547   005357 701000 6                  TSX1    INS_TXT
         6 004550   000000 011000                    NOP     0

     1535     6313                  %ADDSTR (S="'='");

   6315  6 004551   200013 235100                    LDA     LEN,,AUTO
         6 004552   040005 100400                    MLR     fill='040'O
         6 004553   000017 000001 7                  ADSC9   15                       cn=0,n=1
         6 004554   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6316  6 004555   200013 054100                    AOS     LEN,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:202  

     1536     6318                  %ADDNUM (N="BUF$->A$INPUT.RRT(I)");

   6320  6 004556   200006 235100                    LDA     I,,AUTO
         6 004557   000001 735000                    ALS     1
         6 004560   200007 470500                    LDP0    BUF$,,AUTO
         6 004561   000100 101505                    MRL     fill='000'O
         6 004562   000032 000002                    ADSC9   26,A,PR0                 cn=0,n=2
         6 004563   200044 000004                    ADSC9   ADD_RES_ATTR+10,,AUTO    cn=0,n=4
         6 004564   200044 236100                    LDQ     ADD_RES_ATTR+10,,AUTO
         6 004565   000000 235003                    LDA     0,DU
         6 004566   200046 757100                    STAQ    ADD_RES_ATTR+12,,AUTO
         6 004567   000000 301500                    BTD
         6 004570   200046 000010                    NDSC9   ADD_RES_ATTR+12,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         6 004571   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8

   6321  6 004572   005304 701000 6                  TSX1    INS_NUM
         6 004573   000000 011000                    NOP     0

     1537     6323    4             CALL INS_OBUF;

   6323  6 004574   005153 701000 6                  TSX1    INS_OBUF
         6 004575   000000 011000                    NOP     0

     1538     6324    4             END;

     1539     6325    3           END;

   6325  6 004576   200006 054100                    AOS     I,,AUTO
         6 004577   200006 235100                    LDA     I,,AUTO
         6 004600   000013 115007                    CMPA    11,DL
         6 004601   004523 604400 6                  TMOZ    s:6300

     1540     6326    2         IF NPS ~= 0 THEN RETURN;

   6326  6 004602   200026 236100                    LDQ     NPS,,AUTO
         6 004603   004606 600000 6                  TZE     s:6327
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:203  

   6326  6 004604   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004605   000001 702211                    TSX2  ! 1,X1

     1541     6327    2         ALTRETURN;

   6327  6 004606   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004607   000000 702211                    TSX2  ! 0,X1

     1542     6328    2   END DO_PSEUDOS;
     1543     6329
     1544     6330
     1545     6331    1   DO_PACKSETS: PROC ALTRET;

   6331  6 004610   200036 741300       DO_PACKSETS  STX1  ! ADD_RES_ATTR+4,,AUTO

     1546     6332
     1547     6333    2         NSN=0;

   6333  6 004611   200030 450100                    STZ     NSN,,AUTO

     1548     6334    2         SNX=BUF$->A$INPUT.SNX;

   6334  6 004612   200007 470500                    LDP0    BUF$,,AUTO
         6 004613   000000 236100                    LDQ     0,,PR0
         6 004614   777777 376007                    ANQ     -1,DL
         6 004615   200021 756100                    STQ     SNX,,AUTO

     1549     6335    3           DO I = 1 TO BUF$->A$INPUT.NSN;

   6335  6 004616   000001 235007                    LDA     1,DL
         6 004617   200006 755100                    STA     I,,AUTO
         6 004620   004732 710000 6                  TRA     s:6398+1

     1550     6336    3           PSNAME=OD_CXT.SN$->A$SN.S.NAME(SNX);

   6336  6 004621   200021 235100                    LDA     SNX,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:204  
         6 004622   000003 735000                    ALS     3
         6 004623   000003 470400 xsym               LDP0    OD_CXT+3
         6 004624   040100 100505                    MLR     fill='040'O
         6 004625   000000 000006                    ADSC9   0,A,PR0                  cn=0,n=6
         6 004626   200023 000010                    ADSC9   PSNAME,,AUTO             cn=0,n=8

     1551     6337    3           IF PSNAME ~= 'SYS' THEN

   6337  6 004627   040000 106500                    CMPC    fill='040'O
         6 004630   200023 000010                    ADSC9   PSNAME,,AUTO             cn=0,n=8
         6 004631   000751 000003 2                  ADSC9   FPT_DISPLAY+325          cn=0,n=3
         6 004632   004730 600000 6                  TZE     s:6397

     1552     6338    4             DO;

     1553     6339    4             IF NSN ~= 0 THEN

   6339  6 004633   200030 236100                    LDQ     NSN,,AUTO
         6 004634   004645 600000 6                  TZE     s:6352

     1554     6340    5               DO;

     1555     6341                    %ADDSTR (S="','");

   6343  6 004635   200013 235100                    LDA     LEN,,AUTO
         6 004636   040005 100400                    MLR     fill='040'O
         6 004637   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 004640   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6344  6 004641   200013 054100                    AOS     LEN,,AUTO

     1556     6346    5               CALL INS_OBUF;

   6346  6 004642   005153 701000 6                  TSX1    INS_OBUF
         6 004643   000000 011000                    NOP     0

     1557     6347    5               END;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:205  

   6347  6 004644   004652 710000 6                  TRA     s:6356

     1558     6348    4             ELSE
     1559     6349    5               DO;

     1560     6350                    %ADDSTR (S="' '");

   6352  6 004645   200013 235100                    LDA     LEN,,AUTO
         6 004646   040005 100400                    MLR     fill='040'O
         6 004647   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004650   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6353  6 004651   200013 054100                    AOS     LEN,,AUTO

     1561     6355    5               END;

     1562     6356    4             NSN=NSN+1;

   6356  6 004652   200030 054100                    AOS     NSN,,AUTO

     1563     6357                  %ADDSTR (S="'#'");

   6359  6 004653   200013 235100                    LDA     LEN,,AUTO
         6 004654   040005 100400                    MLR     fill='040'O
         6 004655   000020 000001 7                  ADSC9   16                       cn=0,n=1
         6 004656   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6360  6 004657   200013 054100                    AOS     LEN,,AUTO

     1564     6362                  %ADDTXT (T="PSNAME");

   6364  6 004660   040000 100500                    MLR     fill='040'O
         6 004661   200023 000010                    ADSC9   PSNAME,,AUTO             cn=0,n=8
         6 004662   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   6365  6 004663   005357 701000 6                  TSX1    INS_TXT
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:206  
         6 004664   000000 011000                    NOP     0

     1565     6367    4             IF OD_CXT.SN$->A$SN.S.FLG(SNX) THEN

   6367  6 004665   200021 235100                    LDA     SNX,,AUTO
         6 004666   000001 735000                    ALS     1
         6 004667   000003 470400 xsym               LDP0    OD_CXT+3
         6 004670   000001 720105                    LXL0    1,AL,PR0
         6 004671   004730 600000 6                  TZE     s:6397

     1566     6368    5               DO;

     1567     6369                    %ADDSTR (S="'('");

   6371  6 004672   200013 236100                    LDQ     LEN,,AUTO
         6 004673   040006 100400                    MLR     fill='040'O
         6 004674   000021 000001 7                  ADSC9   17                       cn=0,n=1
         6 004675   000500 000001 1                  ADSC9   OBUF,Q                   cn=0,n=1

   6372  6 004676   200013 054100                    AOS     LEN,,AUTO

     1568     6374    5               IF OD_CXT.SN$->A$SN.S.FLG.EXCL(SNX) THEN

   6374  6 004677   000001 236105                    LDQ     1,AL,PR0
         6 004700   200000 316007                    CANQ    65536,DL
         6 004701   004710 600000 6                  TZE     s:6382

     1569     6375    6                 DO;

     1570     6376                      %ADDSTR (S='EX');

   6378  6 004702   200013 235100                    LDA     LEN,,AUTO
         6 004703   040005 100400                    MLR     fill='040'O
         6 004704   000752 000002 2                  ADSC9   FPT_DISPLAY+326          cn=0,n=2
         6 004705   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   6379  6 004706   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:207  
         6 004707   200013 056100                    ASQ     LEN,,AUTO

     1571     6381    6                 END;

     1572     6382    5               IF OD_CXT.SN$->A$SN.S.FLG.PUB(SNX) THEN

   6382  6 004710   200021 235100                    LDA     SNX,,AUTO
         6 004711   000001 735000                    ALS     1
         6 004712   000001 236105                    LDQ     1,AL,PR0
         6 004713   400000 316007                    CANQ    -131072,DL
         6 004714   004723 600000 6                  TZE     s:6392

     1573     6383    6                 DO;

     1574     6384                      %ADDSTR (S='PB');

   6386  6 004715   200013 235100                    LDA     LEN,,AUTO
         6 004716   040005 100400                    MLR     fill='040'O
         6 004717   000753 000002 2                  ADSC9   FPT_DISPLAY+327          cn=0,n=2
         6 004720   000500 000002 1                  ADSC9   OBUF,A                   cn=0,n=2

   6387  6 004721   000002 236007                    LDQ     2,DL
         6 004722   200013 056100                    ASQ     LEN,,AUTO

     1575     6389    6                 END;

     1576     6390                    %ADDSTR (S="')'");

   6392  6 004723   200013 235100                    LDA     LEN,,AUTO
         6 004724   040005 100400                    MLR     fill='040'O
         6 004725   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 004726   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6393  6 004727   200013 054100                    AOS     LEN,,AUTO

     1577     6395    5               END;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:208  
     1578     6396    4             END;

     1579     6397    3           SNX=SNX+1;

   6397  6 004730   200021 054100                    AOS     SNX,,AUTO

     1580     6398    3           END;

   6398  6 004731   200006 054100                    AOS     I,,AUTO
         6 004732   200007 470500                    LDP0    BUF$,,AUTO
         6 004733   000000 236100                    LDQ     0,,PR0
         6 004734   000022 772000                    QRL     18
         6 004735   200006 116100                    CMPQ    I,,AUTO
         6 004736   004621 605000 6                  TPL     s:6336

     1581     6399    2         CALL INS_OBUF;

   6399  6 004737   005153 701000 6                  TSX1    INS_OBUF
         6 004740   000000 011000                    NOP     0

     1582     6400    2         IF NSN ~= 0 THEN RETURN;

   6400  6 004741   200030 235100                    LDA     NSN,,AUTO
         6 004742   004745 600000 6                  TZE     s:6401

   6400  6 004743   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004744   000001 702211                    TSX2  ! 1,X1

     1583     6401    2         ALTRETURN;

   6401  6 004745   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 004746   000000 702211                    TSX2  ! 0,X1

     1584     6402    2   END DO_PACKSETS;
     1585     6403
     1586     6404
     1587     6405    1   DO_PHYS: PROC ALTRET;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:209  

   6405  6 004747   200036 741300       DO_PHYS      STX1  ! ADD_RES_ATTR+4,,AUTO

     1588     6406
     1589     6407    2         NRES=0;

   6407  6 004750   200027 450100                    STZ     NRES,,AUTO

     1590     6408    2         RESX=BUF$->A$INPUT.RESX;

   6408  6 004751   200007 470500                    LDP0    BUF$,,AUTO
         6 004752   000001 236100                    LDQ     1,,PR0
         6 004753   777777 376007                    ANQ     -1,DL
         6 004754   200022 756100                    STQ     RESX,,AUTO

     1591     6409    3           DO I = 1 TO BUF$->A$INPUT.NRES;

   6409  6 004755   000001 235007                    LDA     1,DL
         6 004756   200006 755100                    STA     I,,AUTO
         6 004757   005136 710000 6                  TRA     s:6484+1

     1592     6410    3           IF NRES ~= 0 THEN

   6410  6 004760   200027 235100                    LDA     NRES,,AUTO
         6 004761   004772 600000 6                  TZE     s:6423

     1593     6411    4             DO;

     1594     6412                  %ADDSTR (S="','");

   6414  6 004762   200013 236100                    LDQ     LEN,,AUTO
         6 004763   040006 100400                    MLR     fill='040'O
         6 004764   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 004765   000500 000001 1                  ADSC9   OBUF,Q                   cn=0,n=1

   6415  6 004766   200013 054100                    AOS     LEN,,AUTO

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:210  
     1595     6417    4             CALL INS_OBUF;

   6417  6 004767   005153 701000 6                  TSX1    INS_OBUF
         6 004770   000000 011000                    NOP     0

     1596     6418    4             END;

   6418  6 004771   004777 710000 6                  TRA     s:6427

     1597     6419    3           ELSE
     1598     6420    4             DO;

     1599     6421                  %ADDSTR (S="' '");

   6423  6 004772   200013 236100                    LDQ     LEN,,AUTO
         6 004773   040006 100400                    MLR     fill='040'O
         6 004774   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 004775   000500 000001 1                  ADSC9   OBUF,Q                   cn=0,n=1

   6424  6 004776   200013 054100                    AOS     LEN,,AUTO

     1600     6426    4             END;

     1601     6427    3           NRES=NRES+1;

   6427  6 004777   200027 054100                    AOS     NRES,,AUTO

     1602     6428                %ADDSTR (S="OD_CXT.RES$->A$RES.R.TYP(RESX)");

   6430  6 005000   200022 235100                    LDA     RESX,,AUTO
         6 005001   000003 735000                    ALS     3
         6 005002   000004 470400 xsym               LDP0    OD_CXT+4
         6 005003   200013 236100                    LDQ     LEN,,AUTO
         6 005004   040006 100505                    MLR     fill='040'O
         6 005005   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         6 005006   000500 000002 1                  ADSC9   OBUF,Q                   cn=0,n=2

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:211  
   6431  6 005007   000002 236007                    LDQ     2,DL
         6 005010   200013 056100                    ASQ     LEN,,AUTO

     1603     6433                %ADDSTR (S="OD_CXT.RES$->A$RES.R.VNUM(RESX)");

   6435  6 005011   200013 236100                    LDQ     LEN,,AUTO
         6 005012   040006 100505                    MLR     fill='040'O
         6 005013   000000 400002                    ADSC9   0,A,PR0                  cn=2,n=2
         6 005014   000500 000002 1                  ADSC9   OBUF,Q                   cn=0,n=2

   6436  6 005015   000002 236007                    LDQ     2,DL
         6 005016   200013 056100                    ASQ     LEN,,AUTO

     1604     6438    3           ATTR=OD_CXT.RES$->A$RES.R.ATTR(RESX);

   6438  6 005017   200022 235100                    LDA     RESX,,AUTO
         6 005020   000001 735000                    ALS     1
         6 005021   000001 220105                    LDX0    1,AL,PR0
         6 005022   200025 740100                    STX0    ATTR,,AUTO

     1605     6439    3           IF ATTR THEN

   6439  6 005023   005134 600000 6                  TZE     s:6483

     1606     6440    4             DO;

     1607     6441                  %ADDSTR (S="'('");

   6443  6 005024   200013 235100                    LDA     LEN,,AUTO
         6 005025   040005 100400                    MLR     fill='040'O
         6 005026   000021 000001 7                  ADSC9   17                       cn=0,n=1
         6 005027   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6444  6 005030   200013 054100                    AOS     LEN,,AUTO

     1608     6446    5               DO J = 0 TO %NUM_ATTRS;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:212  
   6446  6 005031   200004 450100                    STZ     J,,AUTO

     1609     6447    5               ADD_RES_ATTR = FALSE;

   6447  6 005032   200032 450100                    STZ     ADD_RES_ATTR,,AUTO

     1610     6448    6               IF (ATTR & ATTRTAB.ABIT(J)) THEN DO;

   6448  6 005033   200025 220100                    LDX0    ATTR,,AUTO
         6 005034   200004 235100                    LDA     J,,AUTO
         6 005035   000001 735000                    ALS     1
         6 005036   000143 360005 2                  ANX0    ATTRTAB,AL
         6 005037   005121 600000 6                  TZE     s:6475

     1611     6449    7                   DO SELECT(OD_CXT.RES$->A$RES.R.TYP(RESX));

   6449  6 005040   200022 236100                    LDQ     RESX,,AUTO
         6 005041   000001 736000                    QLS     1
         6 005042   000004 470400 xsym               LDP0    OD_CXT+4
         6 005043   000000 220106                    LDX0    0,QL,PR0
         6 005044   000754 100000 2                  CMPX0   FPT_DISPLAY+328
         6 005045   005052 602000 6                  TNC     s:6449+10
         6 005046   005074 600000 6                  TZE     s:6457
         6 005047   000755 100000 2                  CMPX0   FPT_DISPLAY+329
         6 005050   005103 601000 6                  TNZ     s:6461
         6 005051   005055 710000 6                  TRA     s:6451
         6 005052   000756 100000 2                  CMPX0   FPT_DISPLAY+330
         6 005053   005103 601000 6                  TNZ     s:6461
         6 005054   005064 710000 6                  TRA     s:6454

     1612     6450    7                   SELECT('MT');

     1613     6451    7                   IF (J >= %MT_MIN) AND (J <= %MT_MAX) THEN

   6451  6 005055   200004 235100                    LDA     J,,AUTO
         6 005056   005103 604000 6                  TMI     s:6461
         6 005057   000003 115007                    CMPA    3,DL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:213  
         6 005060   005103 605400 6                  TPNZ    s:6461

     1614     6452    7                    ADD_RES_ATTR = TRUE;

   6452  6 005061   400000 236003                    LDQ     -131072,DU
         6 005062   200032 756100                    STQ     ADD_RES_ATTR,,AUTO
         6 005063   005103 710000 6                  TRA     s:6461

     1615     6453    7                   SELECT('DP');

     1616     6454    7                   IF (J >= %DP_MIN) AND (J <= %DP_MAX) THEN

   6454  6 005064   200004 235100                    LDA     J,,AUTO
         6 005065   000004 115007                    CMPA    4,DL
         6 005066   005103 604000 6                  TMI     s:6461
         6 005067   000012 115007                    CMPA    10,DL
         6 005070   005103 605400 6                  TPNZ    s:6461

     1617     6455    7                    ADD_RES_ATTR = TRUE;

   6455  6 005071   400000 236003                    LDQ     -131072,DU
         6 005072   200032 756100                    STQ     ADD_RES_ATTR,,AUTO
         6 005073   005103 710000 6                  TRA     s:6461

     1618     6456    7                   SELECT('LP');

     1619     6457    7                   IF (J >= %LP_MIN) AND (J <= %LP_MAX) THEN

   6457  6 005074   200004 235100                    LDA     J,,AUTO
         6 005075   000013 115007                    CMPA    11,DL
         6 005076   005103 604000 6                  TMI     s:6461
         6 005077   000016 115007                    CMPA    14,DL
         6 005100   005103 605400 6                  TPNZ    s:6461

     1620     6458    7                    ADD_RES_ATTR = TRUE;

   6458  6 005101   400000 236003                    LDQ     -131072,DU
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:214  
         6 005102   200032 756100                    STQ     ADD_RES_ATTR,,AUTO

     1621     6459    7                   END;  /*SELECT*/

     1622     6460
     1623     6461    7                 IF ADD_RES_ATTR THEN DO;

   6461  6 005103   200032 234100                    SZN     ADD_RES_ATTR,,AUTO
         6 005104   005121 605000 6                  TPL     s:6475

     1624     6462                             /* Add an attribute, it is valid */
     1625     6463                        %ADDTXT (T="ATTRTAB.STR(J)");

   6465  6 005105   200004 235100                    LDA     J,,AUTO
         6 005106   000003 735000                    ALS     3
         6 005107   040000 100405                    MLR     fill='040'O
         6 005110   000143 400005 2                  ADSC9   ATTRTAB,A                cn=2,n=5
         6 005111   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32

   6466  6 005112   005357 701000 6                  TSX1    INS_TXT
         6 005113   000000 011000                    NOP     0

     1626     6468                        %ADDSTR (S="','");

   6470  6 005114   200013 235100                    LDA     LEN,,AUTO
         6 005115   040005 100400                    MLR     fill='040'O
         6 005116   000015 000001 7                  ADSC9   13                       cn=0,n=1
         6 005117   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6471  6 005120   200013 054100                    AOS     LEN,,AUTO

     1627     6473    7                   END;

     1628     6474    6                 END;  /* if ATTR matches */

     1629     6475    5               END;  /* do j */

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:215  
   6475  6 005121   200004 054100                    AOS     J,,AUTO
         6 005122   200004 235100                    LDA     J,,AUTO
         6 005123   000016 115007                    CMPA    14,DL
         6 005124   005032 604400 6                  TMOZ    s:6447

     1630     6476    4             LEN=LEN-1;

   6476  6 005125   000001 336007                    LCQ     1,DL
         6 005126   200013 056100                    ASQ     LEN,,AUTO

     1631     6477                  %ADDSTR (S="')'");

   6479  6 005127   200013 235100                    LDA     LEN,,AUTO
         6 005130   040005 100400                    MLR     fill='040'O
         6 005131   000001 000001 7                  ADSC9   1                        cn=0,n=1
         6 005132   000500 000001 1                  ADSC9   OBUF,A                   cn=0,n=1

   6480  6 005133   200013 054100                    AOS     LEN,,AUTO

     1632     6482    4             END;

     1633     6483    3           RESX=RESX+1;

   6483  6 005134   200022 054100                    AOS     RESX,,AUTO

     1634     6484    3           END;

   6484  6 005135   200006 054100                    AOS     I,,AUTO
         6 005136   200007 470500                    LDP0    BUF$,,AUTO
         6 005137   000001 236100                    LDQ     1,,PR0
         6 005140   000022 772000                    QRL     18
         6 005141   200006 116100                    CMPQ    I,,AUTO
         6 005142   004760 605000 6                  TPL     s:6410

     1635     6485    2         CALL INS_OBUF;

   6485  6 005143   005153 701000 6                  TSX1    INS_OBUF
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:216  
         6 005144   000000 011000                    NOP     0

     1636     6486    2         IF NRES ~= 0 THEN RETURN;

   6486  6 005145   200027 235100                    LDA     NRES,,AUTO
         6 005146   005151 600000 6                  TZE     s:6487

   6486  6 005147   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 005150   000001 702211                    TSX2  ! 1,X1

     1637     6487    2         ALTRETURN;

   6487  6 005151   200036 221300                    LDX1  ! ADD_RES_ATTR+4,,AUTO
         6 005152   000000 702211                    TSX2  ! 0,X1

     1638     6488    2   END DO_PHYS;
     1639     6489
     1640     6490
     1641     6491
     1642     6492                                /* ADD OBUF TO END OF REAL BUFFER */
     1643     6493    1   INS_OBUF: PROC;

   6493  6 005153   200040 741300       INS_OBUF     STX1  ! ADD_RES_ATTR+6,,AUTO

     1644     6494
     1645     6495    2         IF LEN ~= 0 THEN

   6495  6 005154   200013 235100                    LDA     LEN,,AUTO
         6 005155   005215 600000 6                  TZE     s:6510

     1646     6496    3           DO;

     1647     6497    3           IF OD_CXT.ONLP = 0 THEN

   6497  6 005156   000007 220000 xsym               LDX0    OD_CXT+7
         6 005157   005176 601000 6                  TNZ     s:6504

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:217  
     1648     6498    4             DO;

     1649     6499    4             IF TLEN+LEN > OD_OBMAX THEN CALL FLUSH;

   6499  6 005160   200012 236100                    LDQ     TLEN,,AUTO
         6 005161   200013 036100                    ADLQ    LEN,,AUTO
         6 005162   005170 604000 6                  TMI     s:6500
         6 005163   000000 116000 xsym               CMPQ    OD_OBMAX
         6 005164   005170 602000 6                  TNC     s:6500
         6 005165   005170 600000 6                  TZE     s:6500

   6499  6 005166   005217 701000 6                  TSX1    FLUSH
         6 005167   000000 011000                    NOP     0

     1650     6500    4             CALL INSERT (OPMSG_UFMT.BUF,TLEN,LEN,OBUF);

   6500  6 005170   200013 720100                    LXL0    LEN,,AUTO
         6 005171   200012 235100                    LDA     TLEN,,AUTO
         6 005172   040045 100400                    MLR     fill='040'O
         6 005173   000500 000400 1                  ADSC9   OBUF                     cn=0,n=256
         6 005174   000620 200010 1                  ADSC9   OPMSG_UFMT+5,A           cn=1,n=*X0

     1651     6501    4             END;

   6501  6 005175   005211 710000 6                  TRA     s:6507

     1652     6502    3           ELSE
     1653     6503    4             DO;

     1654     6504    4             IF TLEN+LEN > ODMI_LPMX# THEN CALL FLUSH;

   6504  6 005176   200012 236100                    LDQ     TLEN,,AUTO
         6 005177   200013 036100                    ADLQ    LEN,,AUTO
         6 005200   000204 116007                    CMPQ    132,DL
         6 005201   005204 604400 6                  TMOZ    s:6505

   6504  6 005202   005217 701000 6                  TSX1    FLUSH
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:218  
         6 005203   000000 011000                    NOP     0

     1655     6505    4             CALL INSERT (LOBUF,TLEN,LEN,OBUF);

   6505  6 005204   200013 720100                    LXL0    LEN,,AUTO
         6 005205   200012 235100                    LDA     TLEN,,AUTO
         6 005206   040045 100400                    MLR     fill='040'O
         6 005207   000500 000400 1                  ADSC9   OBUF                     cn=0,n=256
         6 005210   000404 000010 1                  ADSC9   LOBUF,A                  cn=0,n=*X0

     1656     6506    4             END;

     1657     6507    3           TLEN=TLEN+LEN;

   6507  6 005211   200012 236100                    LDQ     TLEN,,AUTO
         6 005212   200013 036100                    ADLQ    LEN,,AUTO
         6 005213   200012 756100                    STQ     TLEN,,AUTO

     1658     6508    3           LEN=0;

   6508  6 005214   200013 450100                    STZ     LEN,,AUTO

     1659     6509    3           END;

     1660     6510    2         RETURN;

   6510  6 005215   200040 221300                    LDX1  ! ADD_RES_ATTR+6,,AUTO
         6 005216   000001 702211                    TSX2  ! 1,X1

     1661     6511    2   END INS_OBUF;
     1662     6512
     1663     6513
     1664     6514
     1665     6515                                /* FLUSH BUFFER */
     1666     6516    1   FLUSH: PROC;

   6516  6 005217   200042 741300       FLUSH        STX1  ! ADD_RES_ATTR+8,,AUTO
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:219  

     1667     6517
     1668     6518    2         IF OD_CXT.ONLP = 0 THEN

   6518  6 005220   000007 220000 xsym               LDX0    OD_CXT+7
         6 005221   005260 601000 6                  TNZ     s:6539

     1669     6519    3           DO;

     1670     6520    3           IF TLEN ~= 0 THEN

   6520  6 005222   200012 235100                    LDA     TLEN,,AUTO
         6 005223   005302 600000 6                  TZE     s:6548

     1671     6521    4             DO;

     1672     6522    4             IF OD_SGHST THEN

   6522  6 005224   000000 236000 xsym               LDQ     OD_SGHST
         6 005225   005243 600000 6                  TZE     s:6530

     1673     6523    5               DO;

     1674     6524    5               OPMSG_UFMT.BUFL=TLEN;

   6524  6 005226   200012 236100                    LDQ     TLEN,,AUTO
         6 005227   000033 736000                    QLS     27
         6 005230   000620 552040 1                  STBQ    OPMSG_UFMT+5,'40'O

     1675     6525    5              OCMSG_UFMT.BUF_.BOUND=LENGTHC(OPMSG_UFMT)-LENGTHC(OPMSG_UFMT.BUF)+TLEN-1
              6525                        ;

   6525  6 005231   200012 236100                    LDQ     TLEN,,AUTO
         6 005232   000024 036007                    ADLQ    20,DL
         6 005233   000020 736000                    QLS     16
         6 005234   000666 676000 1                  ERQ     OCMSG_UFMT+4
         6 005235   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:220  
         6 005236   000666 656000 1                  ERSQ    OCMSG_UFMT+4

     1676     6526    5               CALL M$WRITE (OCMSG_UFMT);

   6526  6 005237   000662 630400 1                  EPPR0   OCMSG_UFMT
         6 005240   040001 713400                    CLIMB   write
         6 005241   401400 401760                    pmme    nvectors=4

     1677     6527    5               END;

   6527  6 005242   005256 710000 6                  TRA     s:6534

     1678     6528    4             ELSE
     1679     6529    5               DO;

     1680     6530    5               WRITE_ME.BUF_.BUF$=ADDR(OPMSG_UFMT.BUF);

   6530  6 005243   000022 236000 7                  LDQ     18
         6 005244   000733 756000 1                  STQ     WRITE_ME+5

     1681     6531    5               WRITE_ME.BUF_.BOUND=TLEN-1;

   6531  6 005245   200012 236100                    LDQ     TLEN,,AUTO
         6 005246   000001 136007                    SBLQ    1,DL
         6 005247   000020 736000                    QLS     16
         6 005250   000732 676000 1                  ERQ     WRITE_ME+4
         6 005251   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 005252   000732 656000 1                  ERSQ    WRITE_ME+4

     1682     6532    5               CALL M$WRITE (WRITE_ME);

   6532  6 005253   000726 630400 1                  EPPR0   WRITE_ME
         6 005254   040001 713400                    CLIMB   write
         6 005255   401400 401760                    pmme    nvectors=4

     1683     6533    5               END;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:221  
     1684     6534    4             TLEN=0;

   6534  6 005256   200012 450100                    STZ     TLEN,,AUTO

     1685     6535    4             END;

     1686     6536    3           END;

   6536  6 005257   005302 710000 6                  TRA     s:6548

     1687     6537    2         ELSE
     1688     6538    3           DO;

     1689     6539    3           IF TLEN > LPTAB THEN

   6539  6 005260   200012 236100                    LDQ     TLEN,,AUTO
         6 005261   000155 116000 1                  CMPQ    LPTAB
         6 005262   005302 604400 6                  TMOZ    s:6548

     1690     6540    4             DO;

     1691     6541    4             WRITE_LO.BUF_.BOUND=TLEN-1;

   6541  6 005263   000001 136007                    SBLQ    1,DL
         6 005264   000020 736000                    QLS     16
         6 005265   000716 676000 1                  ERQ     WRITE_LO+4
         6 005266   000034 376000 xsym               ANQ     B_VECTNIL+28
         6 005267   000716 656000 1                  ERSQ    WRITE_LO+4

     1692     6542    4             CALL M$WRITE (WRITE_LO);

   6542  6 005270   000712 630400 1                  EPPR0   WRITE_LO
         6 005271   040001 713400                    CLIMB   write
         6 005272   401400 401760                    pmme    nvectors=4

     1693     6543    4             LPWRITES=LPWRITES+1;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:222  
   6543  6 005273   200031 054100                    AOS     LPWRITES,,AUTO

     1694     6544    4             TLEN=LPTAB;

   6544  6 005274   000155 235000 1                  LDA     LPTAB
         6 005275   200012 755100                    STA     TLEN,,AUTO

     1695     6545    4             CALL INSERT (LOBUF,1,LPTAB-1,' ');

   6545  6 005276   777777 620005                    EAX0    -1,AL
         6 005277   040040 100400                    MLR     fill='040'O
         6 005300   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005301   000404 200010 1                  ADSC9   LOBUF                    cn=1,n=*X0

     1696     6546    4             END;

     1697     6547    3           END;

     1698     6548    2         RETURN;

   6548  6 005302   200042 221300                    LDX1  ! ADD_RES_ATTR+8,,AUTO
         6 005303   000001 702211                    TSX2  ! 1,X1

     1699     6549    2   END FLUSH;
     1700     6550
     1701     6551
     1702     6552
     1703     6553    1   INS_NUM: PROC;

   6553  6 005304   200040 741300       INS_NUM      STX1  ! ADD_RES_ATTR+6,,AUTO

     1704     6554                                /* INSERT NUMERIC STRING IN TXNUM INTO OBUF
     1705     6555                                   @ LEAST 1 DIGIT  */
     1706     6556
     1707     6557    2         TXSTRR.TOP=' ';

   6557  6 005305   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:223  
         6 005306   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005307   000602 000030 1                  ADSC9   TXSTR                    cn=0,n=24

     1708     6558    2         CALL EDITCHAR (TXSTRR.BOT,,,EDITCTL,TXNUM);

   6558  6 005310   000000 024400                    MVNE
         6 005311   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8
         6 005312   000130 000002 2                  ADSC9   EDITCTL                  cn=0,n=2
         6 005313   000610 000010 1                  ADSC9   TXSTR+6                  cn=0,n=8

     1709     6559    2         GOTO INSIT;

   6559  6 005314   005325 710000 6                  TRA     INSIT

     1710     6560
     1711     6561                                /* INSERT NUMERIC STRING IN TXNUM INTO OBUF
     1712     6562                                   @ LEAST 2 DIGITS */
     1713     6563    2   INS_NUM2: ENTRY;

   6563  6 005315   200040 741300       INS_NUM2     STX1  ! ADD_RES_ATTR+6,,AUTO

     1714     6564
     1715     6565    2         TXSTRR.TOP=' ';

   6565  6 005316   040000 100400                    MLR     fill='040'O
         6 005317   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005320   000602 000030 1                  ADSC9   TXSTR                    cn=0,n=24

     1716     6566    2         CALL EDITCHAR (TXSTRR.BOT,,,EDITCTL2,TXNUM);

   6566  6 005321   000000 024400                    MVNE
         6 005322   000600 030010 1                  NDSC9   TXNUM                    cn=0,s=nosgn,sf=0,n=8
         6 005323   000131 000002 2                  ADSC9   EDITCTL2                 cn=0,n=2
         6 005324   000610 000010 1                  ADSC9   TXSTR+6                  cn=0,n=8

   6566  6 005325                       INSIT        null
     1717     6567    2   INSIT:;
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:224  
     1718     6568    2         NX=0;

   6568  6 005325   200020 450100                    STZ     NX,,AUTO

     1719     6569    2         CALL INDEX1R (BLNKINDEX,' ',TXSTR) ALTRET(NOB);

   6569  6 005326   000000 125400                    SCMR    mask='000'O
         6 005327   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32
         6 005330   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005331   200016 000100                    ARG     BLNKINDEX,,AUTO
         6 005332   005340 606400 6                  TTN     NOB
         6 005333   000037 236007                    LDQ     31,DL
         6 005334   200016 156100                    SSQ     BLNKINDEX,,AUTO

     1720     6570    2         NX=BLNKINDEX+1;

   6570  6 005335   200016 235100                    LDA     BLNKINDEX,,AUTO
         6 005336   000001 035007                    ADLA    1,DL
         6 005337   200020 755100                    STA     NX,,AUTO

   6570  6 005340                       NOB          null
     1721     6571    2   NOB:  ;
     1722     6572    2         K=LENGTHC(TXSTR)-NX;

   6572  6 005340   000040 235007                    LDA     32,DL
         6 005341   200020 135100                    SBLA    NX,,AUTO
         6 005342   200017 755100                    STA     K,,AUTO

     1723     6573    2         CALL INSERT (OBUF,LEN,K,PINCRC(TXSTR$,NX)->B$CHARS);

   6573  6 005343   000612 470400 1                  LDP0    TXSTR$
         6 005344   000000 620005                    EAX0    0,AL
         6 005345   200020 235100                    LDA     NX,,AUTO
         6 005346   200017 721100                    LXL1    K,,AUTO
         6 005347   200013 236100                    LDQ     LEN,,AUTO
         6 005350   040046 100545                    MLR     fill='040'O
         6 005351   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:225  
         6 005352   000500 000011 1                  ADSC9   OBUF,Q                   cn=0,n=*X1

     1724     6574    2         LEN=LEN+K;

   6574  6 005353   200017 036100                    ADLQ    K,,AUTO
         6 005354   200013 756100                    STQ     LEN,,AUTO

     1725     6575    2         RETURN;

   6575  6 005355   200040 221300                    LDX1  ! ADD_RES_ATTR+6,,AUTO
         6 005356   000001 702211                    TSX2  ! 1,X1

     1726     6576
     1727     6577                                /* INSERT THE TEXT STRING IN TXSTR INTO OBUF */
     1728     6578    2   INS_TXT: ENTRY;

   6578  6 005357   200040 741300       INS_TXT      STX1  ! ADD_RES_ATTR+6,,AUTO

     1729     6579
     1730     6580                           /* THE STRING IS ASSUMED LEFT-JUSTIFIED, BLANK
     1731     6581                              PADDED ON THE RIGHT, SO LOOK FOR THE FIRST
     1732     6582                              BLANK */
     1733     6583    2         CALL INDEX (BLNKINDEX,' ',TXSTR);

   6583  6 005360   000000 124400                    SCM     mask='000'O
         6 005361   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32
         6 005362   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         6 005363   200016 000100                    ARG     BLNKINDEX,,AUTO

     1734     6584    2         CALL INSERT (OBUF,LEN,BLNKINDEX,TXSTR);

   6584  6 005364   200016 720100                    LXL0    BLNKINDEX,,AUTO
         6 005365   200013 235100                    LDA     LEN,,AUTO
         6 005366   040045 100400                    MLR     fill='040'O
         6 005367   000602 000040 1                  ADSC9   TXSTR                    cn=0,n=32
         6 005370   000500 000010 1                  ADSC9   OBUF,A                   cn=0,n=*X0

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:226  
     1735     6585    2         LEN=LEN+BLNKINDEX;

   6585  6 005371   200013 236100                    LDQ     LEN,,AUTO
         6 005372   200016 036100                    ADLQ    BLNKINDEX,,AUTO
         6 005373   200013 756100                    STQ     LEN,,AUTO

     1736     6586    2         RETURN;

   6586  6 005374   000001 702211                    TSX2  ! 1,X1
     1737     6587    2   END INS_NUM;
     1738     6588    1   END ODF$FORMAT;

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:227  
--  Include file information  --

   XSJ_MAC_C.:E05TOU  is referenced.
   XSJ_SUBS_C.:E05TOU  is referenced.
   B_MICROPS_C.:E05TOU  is referenced.
   JM_SUBS_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   FO_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   NK_SUBS.:E05TOU  is referenced.
   OD_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   OD_MAC_C.:E05TOU  is referenced.
   OD_SUBS_C.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   OC_MESSHD_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ODF$FORMAT.
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:228  

 **** Variables and constants ****

  ****  Section 001  Data  ODF$FORMAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   676-0-0/d STRC(432)   r     1 GET_TIME                  54-0-0/d STRC(2304)  r     1 HDRVLP
   343-0-0/c STRC(1188)  r     1 IF_LINE                  276-0-0/d UBIN        r     1 INUTS
   404-0-0/d CHAR(132)   r     1 LOBUF                    155-0-0/w SBIN        r     1 LPTAB
   446-0-0/w CHAR(2)     r     1 NUMEXTS(0:9)
   500-0-0/d CHAR(256)   r     1 OBUF                     662-0-0/d STRC(432)   r     1 OCMSG_UFMT
   302-0-0/c STRC(1179)  r     1 OF_LINE                  613-0-0/c STRC(1377)  r     1 OPMSG_UFMT
   300-0-0/d CHAR(8)     r     1 OUTDATE                  272-0-0/d STRC(99)    r     1 OUTTIME
   154-0-0/w BIT (16)    r     1 PARTM                    154-0-0/w STRC(16)    r     1 PARTMR
    10-0-0/w STRC(1233)  r     1 STHDR                    262-0-0/w STRC(54)    r     1 ST_DEFER
   270-0-0/w STRC(54)    r     1 ST_FOLL                  266-0-0/w STRC(54)    r     1 ST_RUN
   264-0-0/w STRC(54)    r     1 ST_WAIT
   460-0-0/w CHAR(2)     r     1 TEEN_NUMEXTS(0:9)
   600-0-0/d CHAR(8)     r     1 TXNUM
   472-0-0/w CHAR(2)     r     1 TXRELATIONS(0:5)
   602-0-0/d CHAR(32)    r     1 TXSTR                    612-0-0/w PTR         r     1 TXSTR$
   602-0-0/d STRC(288)   r     1 TXSTRR                     0-0-0/d STRC(252)   r     1 VLR_DISPLAY
   712-0-0/d STRC(432)   r     1 WRITE_LO                 726-0-0/d STRC(432)   r     1 WRITE_ME
   156-0-0/w STRC(2448)  r     1 XCON

  ****  Section 002 RoData ODF$FORMAT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   143-0-0/w STRC(63)    r     1 ATTRTAB(0:14)              3-0-0/w CHAR(9)     r     1 DEFRHDR
   130-0-0/w STRC(18)    r     1 EDITCTL                  131-0-0/w STRC(18)    r     1 EDITCTL2
   132-0-0/w STRC(18)    r     1 EDITCTLS(0:8)
     6-0-0/w CHAR(9)     r     1 FOLLHDR                  244-0-0/d STRC(72)    r     1 FPT_DISPLAY
    67-0-0/c STRC(1188)  r     1 IF_TITLE                  67-0-0/c CHAR(132)   r     1 IF_TITLER
    26-0-0/c STRC(1170)  r     1 OF_TITLE                  26-0-0/c CHAR(130)   r     1 OF_TITLER
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:229  
    17-0-0/w CHAR(9)     r     1 OTHRHDR                   11-0-0/w CHAR(9)     r     1 PSETHDR
    14-0-0/w CHAR(9)     r     1 PSEUHDR                  216-0-0/d STRC(360)   r     1 SET_HDR
    24-0-0/w STRC(54)    r     1 ST_WPART                  22-0-0/w STRC(54)    r     1 ST_WPS
   230-0-0/d STRC(432)   r     1 WRITE_ILINE              202-0-0/d STRC(432)   r     1 WRITE_OLINE
     0-0-0/w CHAR(9)     r     1 WSNHDR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @DISPLAY_TYPE             32-0-0/b BIT         r     1 ADD_RES_ATTR
    25-0-0/b BIT (18)    r     1 ATTR                      16-0-0/w SBIN        r     1 BLNKINDEX
     7-0-0/w PTR         r     1 BUF$                      *0-0-0/w SBIN        r     1 DISPLAY_TYPE
     6-0-0/w SBIN        r     1 I                          4-0-0/w SBIN        r     1 J
    17-0-0/w SBIN        r     1 K                         13-0-0/w SBIN        r     1 LEN
    14-0-0/w SBIN        r     1 LIMITS_HIT                31-0-0/w SBIN        r     1 LPWRITES
    15-0-0/w SBIN        r     1 NFOLL                     26-0-0/w SBIN        r     1 NPS
    27-0-0/w SBIN        r     1 NRES                      30-0-0/w SBIN        r     1 NSN
    20-0-0/w SBIN        r     1 NX                         5-0-0/w SBIN        r     1 POSN
    23-0-0/c CHAR(8)     r     1 PSNAME                    22-0-0/w SBIN        r     1 RESX
    21-0-0/w SBIN        r     1 SNX                       12-0-0/w SBIN        r     1 TLEN

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w STRC(792)   r     1 OD_CXT
     0-0-0/w UBIN        r     1 OD_OBMAX                   0-0-0/d STRC(1116)  r     1 OD_PSEUDOS
     0-0-0/w BIT         r     1 OD_SGHST

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:230  
     0-0-0/w STRC(2304)  r     1 A$INPUT                    0-0-0/w STRC(1008)  r     1 A$OUTPUT
     0-0-0/d STRC(72)    r     1 A$RES                      0-0-0/d STRC(72)    r     1 A$SN
     0-0-0/d ACHR        r     1 B$CHARS                    0-0-0N  NULL        r     1 M$CSCG
     0-0-0N  NULL        r     1 M$LO                       0-0-0N  NULL        r     1 M$ME
     0-0-0/d STRC(2376)  r     1 R$INPUT                    0-0-0/d STRC(1080)  r     1 R$OUTPUT
     0-0-0/w STRC(1233)  r     1 VLP$HDR                    0-0-0/w STRC(180)   r     1 XSJ$JOBINFO


   Procedure ODF$FORMAT requires 2813 words for executable code.
   Procedure ODF$FORMAT requires 40 words of local(AUTO) storage.

    No errors detected in file ODF$FORMAT.:E05TSI    .
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:231  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:232  
          MINI XREF LISTING

A$INPUT.ACCT
      3660**DCL      5158>>ASSIGN   5369>>CALLBLT  5370>>CALLBLT  5797>>ASSIGN   6155>>ASSIGN
A$INPUT.AHEAD
      3660**DCL      5465>>ASSIGN   6030>>IF       6040>>ASSIGN
A$INPUT.FLG.ACC
      3657**DCL      5386>>IF       5856>>IF       5873>>IF
A$INPUT.FLG.O1
      3656**DCL      5385>>IF       5856>>IF       5865>>IF
A$INPUT.FLG.O3
      3657**DCL      5387>>IF       5531>>IF       6117>>IF
A$INPUT.FLG.RA
      3659**DCL      5388>>IF       5517>>IF
A$INPUT.FLG.RR
      3658**DCL      5389>>IF       5856>>IF       5881>>IF
A$INPUT.IPRIO
      3655**DCL      5444>>CALLBLT  5911>>CALLBLT
A$INPUT.JDID.FOLLOW_TYPE
      3664**DCL      5149>>IF       6146>>IF       6183>>DOCASE
A$INPUT.JDID.RELATION
      3664**DCL      6192>>ASSIGN
A$INPUT.JDID.SATISFIED
      3665**DCL      6167>>IF
A$INPUT.JDID.SYSID
      3665**DCL      6163>>CALLBLT
A$INPUT.JDSTEPCC
      3666**DCL      6197>>CALLBLT
A$INPUT.JNAME
      3662**DCL      5483>>ASSIGN   5747>>IF       5751>>ASSIGN
A$INPUT.NFOLL
      3659**DCL      5166>>CALLBLT  6136>>DOWHILE
A$INPUT.NRES
      3652**DCL      6409>>DOINDEX
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:233  
A$INPUT.NSN
      3652**DCL      6335>>DOINDEX
A$INPUT.PART
      3654**DCL      5437>>ASSIGN
A$INPUT.PNUM
      3654**DCL      5424>>CALLBLT  6009>>CALLBLT
A$INPUT.PRIO
      3655**DCL      5419>>IF       5447>>DOCASE   5916>>DOCASE
A$INPUT.RATIM
      3662**DCL      6090>>ASSIGN
A$INPUT.RESX
      3653**DCL      6408>>ASSIGN
A$INPUT.RRT
      3663**DCL      5398>>CALLBLT  6278>>CALLBLT  6300>>IF       6320>>CALLBLT
A$INPUT.SNX
      3652**DCL      6334>>ASSIGN
A$INPUT.START_TIME
      3656**DCL      5427>>ASSIGN   5995>>ASSIGN
A$INPUT.SUBMIT_TIME
      3656**DCL      5378>>ASSIGN
A$INPUT.SYSID
      3660**DCL      5363>>CALLBLT  5730>>CALLBLT
A$INPUT.TIM
      3663**DCL      5402>>IF       5406>>CALLBLT  5413>>CALLBLT  5417>>CALLBLT  6242>>IF       6246>>CALLBLT
      6257>>CALLBLT  6267>>CALLBLT
A$INPUT.UNAME
      3661**DCL      5375>>CALLBLT  5376>>CALLBLT
A$INPUT.WOO
      3661**DCL      5393>>CALLBLT  5394>>CALLBLT  5494>>IF       5815>>IF       5825>>ASSIGN   5828>>IF
A$INPUT.WSN
      3661**DCL      5494>>IF       5510>>ASSIGN   5815>>IF       5828>>IF       5837>>ASSIGN
A$OUTPUT.ACCT
      3624**DCL      5261>>CALLBLT  5262>>CALLBLT  5783>>ASSIGN
A$OUTPUT.AHEAD
      3624**DCL      5113>>ASSIGN
A$OUTPUT.ATTR
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:234  
      3622**DCL      5321>>ASSIGN
A$OUTPUT.COPIES
      3621**DCL      5008>>IF       5017>>CALLBLT  5273>>CALLBLT
A$OUTPUT.CREATED
      3624**DCL      5329>>ASSIGN
A$OUTPUT.DEVNAME
      3623**DCL      5072>>IF       5086--CALLBLT  5086>>CALLBLT  5087--ASSIGN
A$OUTPUT.DEVTYP
      3621**DCL      5081--CALLBLT  5081>>CALLBLT  5082--ASSIGN   5264>>ASSIGN   5658>>ASSIGN
A$OUTPUT.FLG.DEVAVAIL
      3622**DCL      4995>>IF       5335>>IF
A$OUTPUT.FLG.GLC
      3622**DCL      5063>>IF       5305>>IF
A$OUTPUT.FLG.SAP
      3622**DCL      5296>>IF
A$OUTPUT.FLG.SPILL
      3622**DCL      5103>>IF
A$OUTPUT.FORM
      3623**DCL      5317>>CALLBLT  5318>>CALLBLT  5674>>IF       5674>>IF       5684>>ASSIGN
A$OUTPUT.GRANS
      3623**DCL      5005>>CALLBLT  5268>>CALLBLT
A$OUTPUT.HICNUM
      3623**DCL      5310>>CALLBLT
A$OUTPUT.JNAME
      3624**DCL      5339>>ASSIGN   5768>>IF       5772>>ASSIGN
A$OUTPUT.MODE
      3622**DCL      5243>>DOCASE
A$OUTPUT.NUM
      3623**DCL      5240>>CALLBLT  5647>>CALLBLT
A$OUTPUT.PRIO
      3621**DCL      5036>>DOCASE   5059>>CALLBLT  5276>>DOCASE   5290>>CALLBLT
A$OUTPUT.SAPCOPIES
      3621**DCL      5300>>CALLBLT
A$OUTPUT.SYSID
      3623**DCL      5235>>CALLBLT  5715>>CALLBLT
A$OUTPUT.TNAME
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:235  
      3621**DCL      5089>>IF       5098>>ASSIGN
A$OUTPUT.WOD
      3624**DCL      5089>>IF       5265>>ASSIGN   5661>>IF       5670>>ASSIGN
A$RES.R.ATTR
      3693**DCL      6438>>ASSIGN
A$RES.R.TYP
      3693**DCL      6430--CALLBLT  6430>>CALLBLT  6431--ASSIGN   6449>>DOSELCT
A$RES.R.VNUM
      3693**DCL      6435--CALLBLT  6435>>CALLBLT  6436--ASSIGN
A$SN.S.FLG
      3680**DCL      6367>>IF
A$SN.S.FLG.EXCL
      3680**DCL      6374>>IF
A$SN.S.FLG.PUB
      3680**DCL      6382>>IF
A$SN.S.NAME
      3680**DCL      6336>>ASSIGN
ADD_RES_ATTR
      4198**DCL      6447<<ASSIGN   6452<<ASSIGN   6455<<ASSIGN   6458<<ASSIGN   6461>>IF
ATTR
      3872**DCL      5321<<ASSIGN   5322>>IF       5324>>IF       5325>>IF       5326>>IF       5327>>IF
      6438<<ASSIGN   6439>>IF       6448>>IF
ATTRTAB.ABIT
      4176**DCL      6448>>IF
ATTRTAB.STR
      4183**DCL      6465>>ASSIGN
B$ALT.CODE
      3589**DCL      3589--REDEF    3590--REDEF    3590--REDEF
B$ALT.ERR.ERR#
      3591**DCL      3591--REDEF
B$ALT.EVID
      3590**DCL      3590--REDEF    3590--REDEF
B$CHARS
      3710**DCL      6573>>CALLBLT
B$JIT.ERR.MID
      3402**DCL      3402--REDEF
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:236  
B$JIT$
      4235**DCL      3396--IMP-PTR
BLNKINDEX
      3866**DCL      5261<<CALLBLT  5262>>CALLBLT  5262>>CALLBLT  5317<<CALLBLT  5318>>CALLBLT  5318>>CALLBLT
      5369<<CALLBLT  5370>>CALLBLT  5370>>CALLBLT  5375<<CALLBLT  5376>>CALLBLT  5376>>CALLBLT  5393<<CALLBLT
      5394>>CALLBLT  5394>>CALLBLT  6569<<CALLBLT  6570>>ASSIGN   6583<<CALLBLT  6584>>CALLBLT  6585>>ASSIGN
BUF$
      3859**DCL      4525<<ASSIGN   4538<<ASSIGN   4556>>ASSIGN   4564>>DOCASE   4616>>CALLBLT  4628>>CALLBLT
      4640>>CALLBLT  4652>>CALLBLT  4699>>IF       4707>>ASSIGN   4872>>IF       4880>>IF       4889>>DOCASE
      4928>>CALLBLT  4955>>ASSIGN   4977<<ASSIGN   4988<<ASSIGN   4995>>IF       5005>>CALLBLT  5008>>IF
      5017>>CALLBLT  5036>>DOCASE   5059>>CALLBLT  5063>>IF       5072>>IF       5081>>CALLBLT  5081>>CALLBLT
      5082>>ASSIGN   5086>>CALLBLT  5086>>CALLBLT  5087>>ASSIGN   5089>>IF       5089>>IF       5098>>ASSIGN
      5103>>IF       5113>>ASSIGN   5122<<ASSIGN   5131<<ASSIGN   5140<<ASSIGN   5149>>IF       5158>>ASSIGN
      5166>>CALLBLT  5223<<ASSIGN   5235>>CALLBLT  5240>>CALLBLT  5243>>DOCASE   5261>>CALLBLT  5262>>CALLBLT
      5264>>ASSIGN   5265>>ASSIGN   5268>>CALLBLT  5273>>CALLBLT  5276>>DOCASE   5290>>CALLBLT  5296>>IF
      5300>>CALLBLT  5305>>IF       5310>>CALLBLT  5317>>CALLBLT  5318>>CALLBLT  5321>>ASSIGN   5329>>ASSIGN
      5335>>IF       5339>>ASSIGN   5352<<ASSIGN   5363>>CALLBLT  5369>>CALLBLT  5370>>CALLBLT  5375>>CALLBLT
      5376>>CALLBLT  5378>>ASSIGN   5385>>IF       5386>>IF       5387>>IF       5388>>IF       5389>>IF
      5393>>CALLBLT  5394>>CALLBLT  5398>>CALLBLT  5402>>IF       5406>>CALLBLT  5413>>CALLBLT  5417>>CALLBLT
      5419>>IF       5424>>CALLBLT  5427>>ASSIGN   5437>>ASSIGN   5444>>CALLBLT  5447>>DOCASE   5465>>ASSIGN
      5483>>ASSIGN   5494>>IF       5494>>IF       5510>>ASSIGN   5517>>IF       5531>>IF       5647>>CALLBLT
      5658>>ASSIGN   5661>>IF       5670>>ASSIGN   5674>>IF       5674>>IF       5684>>ASSIGN   5715>>CALLBLT
      5730>>CALLBLT  5747>>IF       5751>>ASSIGN   5768>>IF       5772>>ASSIGN   5783>>ASSIGN   5797>>ASSIGN
      5815>>IF       5815>>IF       5825>>ASSIGN   5828>>IF       5828>>IF       5837>>ASSIGN   5856>>IF
      5856>>IF       5856>>IF       5865>>IF       5873>>IF       5881>>IF       5911>>CALLBLT  5916>>DOCASE
      5995>>ASSIGN   6009>>CALLBLT  6030>>IF       6040>>ASSIGN   6090>>ASSIGN   6117>>IF       6136>>DOWHILE
      6146>>IF       6155>>ASSIGN   6163>>CALLBLT  6167>>IF       6183>>DOCASE   6192>>ASSIGN   6197>>CALLBLT
      6242>>IF       6246>>CALLBLT  6257>>CALLBLT  6267>>CALLBLT  6278>>CALLBLT  6300>>IF       6320>>CALLBLT
      6334>>ASSIGN   6335>>DOINDEX  6408>>ASSIGN   6409>>DOINDEX
CHKCOM
      5059**LABEL    5055--GOTO
DEFRHDR
      3934**DCL      5522--CALLBLT  5522>>CALLBLT  5523--ASSIGN
DISPLAY_TYPE
        35**DCL        27--PROC     4519>>DOCASE   5213>>DOCASE
DO_DEFER
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:237  
      6083**PROC     5526--CALL     5929--CALL
DO_FOLL
      6133**PROC     5545--CALL     6123--CALL
DO_PACKSETS
      6331**PROC     5574--CALL     6288--CALL
DO_PHYS
      6405**PROC     5585--CALL     6291--CALL
DO_PSEUDOS
      6296**PROC     5563--CALL     6285--CALL
EDITCTL
      4156**DCL      6558>>CALLBLT
EDITCTL2
      4159**DCL      6566>>CALLBLT
EDITCTLS
      4162**DCL      5236>>CALLBLT  5241>>CALLBLT  5269>>CALLBLT  5274>>CALLBLT  5291>>CALLBLT  5301>>CALLBLT
      5311>>CALLBLT  5364>>CALLBLT  5399>>CALLBLT  5407>>CALLBLT  5425>>CALLBLT  5445>>CALLBLT  5469>>CALLBLT
FLUSH
      6516**PROC     5178--CALL     5514--CALL     5527--CALL     5552--CALL     5564--CALL     5575--CALL
      5586--CALL     5603--CALL     6499--CALL     6504--CALL
FMTA IN PROCEDURE FMT_JA
      5792**LABEL    5760--GOTO
FMTA1 IN PROCEDURE FMT_JA
      5797**LABEL    5786--GOTO
FMTS IN PROCEDURE FMT_SYSID
      5725**LABEL    5705--GOTO
FMT_FOL
      6115**PROC     4532--CALL     4982--CALL
FMT_JA
      5740**PROC     4527--CALL     4979--CALL     5124--CALL     5133--CALL     5142--CALL
FMT_JOB IN PROCEDURE FMT_SYSID
      5721**ENTRY    5132--CALL
FMT_OACCT IN PROCEDURE FMT_JA
      5762**ENTRY    5650--CALL
FMT_OAN
      5854**PROC     4528--CALL
FMT_OSYSID IN PROCEDURE FMT_SYSID
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:238  
      5707**ENTRY    5639--CALL
FMT_OUTP
      5637**PROC     4989--CALL
FMT_POS
      5902**PROC     4530--CALL     4980--CALL     5125--CALL     5134--CALL     5143--CALL
FMT_POSN
      6050**PROC     5114--CALL     6041--CALL
FMT_RQL
      6235**PROC     4531--CALL     4981--CALL
FMT_SYSID
      5698**PROC     4526--CALL     4978--CALL     5123--CALL     5141--CALL
FMT_WW
      5813**PROC     4529--CALL
FOLLHDR
      3935**DCL      5536--CALLBLT  5536>>CALLBLT  5537--ASSIGN
FPT_DISPLAY
      4474**DCL      5934<>CALL
GET_TIME
      4292**DCL      4956<>CALL     5330<>CALL     5379<>CALL     5428<>CALL     5996<>CALL     6091<>CALL
GET_TIME.V
      4296**DCL      4292--DCLINIT
HDRVLP
      3917**DCL      4386--DCLINIT  5227<<ASSIGN   5228--ASSIGN   5229--ASSIGN   5356<<ASSIGN   5357--ASSIGN
      5358--ASSIGN
I
      3858**DCL      5438<<DOINDEX  5439>>IF       5439>>ASSIGN   6299<<DOINDEX  6300>>IF       6310>>ASSIGN
      6320>>CALLBLT  6335<<DOINDEX  6409<<DOINDEX
IF_LINE
      4098**DCL      4414--DCLINIT  4415--DCLINIT
IF_LINE.ACCT
      4102**DCL      5368<<ASSIGN   5370<<CALLBLT  5370--CALLBLT
IF_LINE.CFLG
      4113**DCL      4114--REDEF    5384<<ASSIGN
IF_LINE.CPART
      4133**DCL      4134--REDEF    4135--REDEF    5421<<ASSIGN   5436<<ASSIGN
IF_LINE.CSTATUS
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:239  
      4149**DCL      5450<<ASSIGN   5453<<ASSIGN   5456<<ASSIGN   5459<<ASSIGN   5462<<ASSIGN   5480<<ASSIGN
IF_LINE.CTIM
      4125**DCL      4126--REDEF    5401<<ASSIGN   5409<<ASSIGN
IF_LINE.FLG.A
      4116**DCL      5386<<ASSIGN
IF_LINE.FLG.D
      4119**DCL      5388<<ASSIGN
IF_LINE.FLG.F
      4118**DCL      5387<<ASSIGN
IF_LINE.FLG.N
      4117**DCL      5389<<ASSIGN
IF_LINE.FLG.O
      4115**DCL      5385<<ASSIGN
IF_LINE.JNAME
      4152**DCL      5483<<ASSIGN
IF_LINE.MEM
      4123**DCL      5398<<CALLBLT  5399<<CALLBLT  5399--CALLBLT  5399>>CALLBLT
IF_LINE.PARTS
      4134**DCL      5439<<ASSIGN
IF_LINE.PRIO
      4147**DCL      5444<<CALLBLT  5445<<CALLBLT  5445--CALLBLT  5445>>CALLBLT
IF_LINE.RUNNING_PART.PART
      4137**DCL      5424<<CALLBLT  5425<<CALLBLT  5425--CALLBLT  5425>>CALLBLT
IF_LINE.RUNNING_PART.START_TIME.DATE.D
      4144**DCL      5431<<ASSIGN
IF_LINE.RUNNING_PART.START_TIME.DATE.M
      4143**DCL      5430<<ASSIGN
IF_LINE.RUNNING_PART.START_TIME.DATE.Y
      4145**DCL      5432<<ASSIGN
IF_LINE.RUNNING_PART.START_TIME.HHMM
      4140**DCL      5429<<ASSIGN
IF_LINE.SUBDATE.D
      4110**DCL      5382<<ASSIGN
IF_LINE.SUBDATE.M
      4109**DCL      5381<<ASSIGN
IF_LINE.SUBDATE.Y
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:240  
      4111**DCL      5383<<ASSIGN
IF_LINE.SUBTIME
      4106**DCL      5380<<ASSIGN
IF_LINE.SYSID
      4100**DCL      5363<<CALLBLT  5364<<CALLBLT  5364--CALLBLT  5364>>CALLBLT
IF_LINE.TIM.H
      4127**DCL      5406<<CALLBLT  5407<<CALLBLT  5407--CALLBLT  5407>>CALLBLT
IF_LINE.TIM.M
      4129**DCL      5413<<CALLBLT
IF_LINE.TIM.S
      4131**DCL      5417<<CALLBLT
IF_LINE.UNAME
      4104**DCL      5374<<ASSIGN   5376<<CALLBLT  5376--CALLBLT
IF_LINE.WOO
      4121**DCL      5392<<ASSIGN   5394<<CALLBLT  5394--CALLBLT
IF_TITLE
      4044**DCL      4096--REDEF
IF_TITLE.CFLG
      4055**DCL      4056--REDEF
IF_TITLE.CPART
      4075**DCL      4076--REDEF    4077--REDEF
IF_TITLE.CTIM
      4067**DCL      4068--REDEF
IF_TITLER
      4096**DCL      5357--ASSIGN   5358>>ASSIGN
INSIT IN PROCEDURE INS_NUM
      6566**LABEL    6559--GOTO
INS_NUM
      6553**PROC     4547--CALL     4617--CALL     4629--CALL     4641--CALL     4653--CALL     4929--CALL
      5006--CALL     5018--CALL     5060--CALL     5167--CALL     5648--CALL     5716--CALL     5731--CALL
      5912--CALL     6010--CALL     6059--CALL     6164--CALL     6198--CALL     6247--CALL     6279--CALL
      6321--CALL
INS_NUM2 IN PROCEDURE INS_NUM
      6563**ENTRY    6258--CALL     6268--CALL
INS_OBUF
      6493**PROC     5177--CALL     5513--CALL     5551--CALL     5602--CALL     5718--CALL     5733--CALL
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:241  
      5806--CALL     5846--CALL     5894--CALL     5914--CALL     6047--CALL     6107--CALL     6129--CALL
      6144--CALL     6270--CALL     6281--CALL     6323--CALL     6346--CALL     6399--CALL     6417--CALL
      6485--CALL
INS_TXT IN PROCEDURE INS_NUM
      6578**ENTRY    4557--CALL     5099--CALL     5159--CALL     5511--CALL     5659--CALL     5671--CALL
      5685--CALL     5752--CALL     5773--CALL     5784--CALL     5798--CALL     5826--CALL     5838--CALL
      6105--CALL     6156--CALL     6193--CALL     6311--CALL     6365--CALL     6466--CALL
INUTS
      3956**DCL      4296--DCLINIT  4955<<ASSIGN   5329<<ASSIGN   5378<<ASSIGN   5427<<ASSIGN   5995<<ASSIGN
      6090<<ASSIGN
J
      3856**DCL      6446<<DOINDEX  6448>>IF       6451>>IF       6451>>IF       6454>>IF       6454>>IF
      6457>>IF       6457>>IF       6465>>ASSIGN
K
      3867**DCL      3710--IMP-SIZ  6572<<ASSIGN   6573>>CALLBLT  6573>>CALLBLT  6574>>ASSIGN
LEN
      3863**DCL      4491<<ASSIGN   4541>>CALLBLT  4542<<ASSIGN   4542>>ASSIGN   4551>>CALLBLT  4552<<ASSIGN
      4552>>ASSIGN   4561>>CALLBLT  4562<<ASSIGN   4562>>ASSIGN   4569>>CALLBLT  4570<<ASSIGN   4570>>ASSIGN
      4576>>CALLBLT  4577<<ASSIGN   4577>>ASSIGN   4583>>CALLBLT  4584<<ASSIGN   4584>>ASSIGN   4590>>CALLBLT
      4591<<ASSIGN   4591>>ASSIGN   4597>>CALLBLT  4598<<ASSIGN   4598>>ASSIGN   4604>>CALLBLT  4605<<ASSIGN
      4605>>ASSIGN   4611>>CALLBLT  4612<<ASSIGN   4612>>ASSIGN   4623>>CALLBLT  4624<<ASSIGN   4624>>ASSIGN
      4635>>CALLBLT  4636<<ASSIGN   4636>>ASSIGN   4647>>CALLBLT  4648<<ASSIGN   4648>>ASSIGN   4659>>CALLBLT
      4660<<ASSIGN   4660>>ASSIGN   4666>>CALLBLT  4667<<ASSIGN   4667>>ASSIGN   4673>>CALLBLT  4674<<ASSIGN
      4674>>ASSIGN   4680>>CALLBLT  4681<<ASSIGN   4681>>ASSIGN   4687>>CALLBLT  4688<<ASSIGN   4688>>ASSIGN
      4694>>CALLBLT  4695<<ASSIGN   4695>>ASSIGN   4703>>CALLBLT  4704<<ASSIGN   4704>>ASSIGN   4712>>CALLBLT
      4713<<ASSIGN   4713>>ASSIGN   4723>>CALLBLT  4724<<ASSIGN   4724>>ASSIGN   4729>>CALLBLT  4730<<ASSIGN
      4730>>ASSIGN   4740>>CALLBLT  4741<<ASSIGN   4741>>ASSIGN   4746>>CALLBLT  4747<<ASSIGN   4747>>ASSIGN
      4757>>CALLBLT  4758<<ASSIGN   4758>>ASSIGN   4763>>CALLBLT  4764<<ASSIGN   4764>>ASSIGN   4774>>CALLBLT
      4775<<ASSIGN   4775>>ASSIGN   4780>>CALLBLT  4781<<ASSIGN   4781>>ASSIGN   4791>>CALLBLT  4792<<ASSIGN
      4792>>ASSIGN   4797>>CALLBLT  4798<<ASSIGN   4798>>ASSIGN   4808>>CALLBLT  4809<<ASSIGN   4809>>ASSIGN
      4814>>CALLBLT  4815<<ASSIGN   4815>>ASSIGN   4825>>CALLBLT  4826<<ASSIGN   4826>>ASSIGN   4831>>CALLBLT
      4832<<ASSIGN   4832>>ASSIGN   4842>>CALLBLT  4843<<ASSIGN   4843>>ASSIGN   4848>>CALLBLT  4849<<ASSIGN
      4849>>ASSIGN   4857>>CALLBLT  4858<<ASSIGN   4858>>ASSIGN   4865>>CALLBLT  4866<<ASSIGN   4866>>ASSIGN
      4876>>CALLBLT  4877<<ASSIGN   4877>>ASSIGN   4884>>CALLBLT  4885<<ASSIGN   4885>>ASSIGN   4893>>CALLBLT
      4894<<ASSIGN   4894>>ASSIGN   4899>>CALLBLT  4900<<ASSIGN   4900>>ASSIGN   4905>>CALLBLT  4906<<ASSIGN
      4906>>ASSIGN   4911>>CALLBLT  4912<<ASSIGN   4912>>ASSIGN   4917>>CALLBLT  4918<<ASSIGN   4918>>ASSIGN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:242  
      4923>>CALLBLT  4924<<ASSIGN   4924>>ASSIGN   4937>>CALLBLT  4938<<ASSIGN   4938>>ASSIGN   4944>>CALLBLT
      4945<<ASSIGN   4945>>ASSIGN   4952>>CALLBLT  4953<<ASSIGN   4953>>ASSIGN   4959>>CALLBLT  4960<<ASSIGN
      4960>>ASSIGN   4964>>CALLBLT  4965<<ASSIGN   4965>>ASSIGN   4969>>CALLBLT  4970<<ASSIGN   4970>>ASSIGN
      4992>>CALLBLT  4993<<ASSIGN   4993>>ASSIGN   4999>>CALLBLT  5000<<ASSIGN   5000>>ASSIGN   5012>>CALLBLT
      5013<<ASSIGN   5013>>ASSIGN   5022>>CALLBLT  5023<<ASSIGN   5023>>ASSIGN   5028>>CALLBLT  5029<<ASSIGN
      5029>>ASSIGN   5033>>CALLBLT  5034<<ASSIGN   5034>>ASSIGN   5040>>CALLBLT  5041<<ASSIGN   5041>>ASSIGN
      5046>>CALLBLT  5047<<ASSIGN   5047>>ASSIGN   5052>>CALLBLT  5053<<ASSIGN   5053>>ASSIGN   5067>>CALLBLT
      5068<<ASSIGN   5068>>ASSIGN   5076>>CALLBLT  5077<<ASSIGN   5077>>ASSIGN   5081>>CALLBLT  5082<<ASSIGN
      5082>>ASSIGN   5086>>CALLBLT  5087<<ASSIGN   5087>>ASSIGN   5093>>CALLBLT  5094<<ASSIGN   5094>>ASSIGN
      5107>>CALLBLT  5108<<ASSIGN   5108>>ASSIGN   5146>>CALLBLT  5147<<ASSIGN   5147>>ASSIGN   5153>>CALLBLT
      5154<<ASSIGN   5154>>ASSIGN   5171>>CALLBLT  5172<<ASSIGN   5172>>ASSIGN   5209<<ASSIGN   5505>>CALLBLT
      5506<<ASSIGN   5506>>ASSIGN   5542>>CALLBLT  5543<<ASSIGN   5543>>ASSIGN   5548>>CALLBLT  5549<<ASSIGN
      5549>>ASSIGN   5594<<ASSIGN   5599>>CALLBLT  5600<<ASSIGN   5600>>ASSIGN   5642>>CALLBLT  5643<<ASSIGN
      5643>>ASSIGN   5653>>CALLBLT  5654<<ASSIGN   5654>>ASSIGN   5665>>CALLBLT  5666<<ASSIGN   5666>>ASSIGN
      5679>>CALLBLT  5680<<ASSIGN   5680>>ASSIGN   5689>>CALLBLT  5690<<ASSIGN   5690>>ASSIGN   5702>>CALLBLT
      5703<<ASSIGN   5703>>ASSIGN   5710>>CALLBLT  5711<<ASSIGN   5711>>ASSIGN   5724>>CALLBLT  5725<<ASSIGN
      5725>>ASSIGN   5744>>CALLBLT  5745<<ASSIGN   5745>>ASSIGN   5756>>CALLBLT  5757<<ASSIGN   5757>>ASSIGN
      5765>>CALLBLT  5766<<ASSIGN   5766>>ASSIGN   5777>>CALLBLT  5778<<ASSIGN   5778>>ASSIGN   5791>>CALLBLT
      5792<<ASSIGN   5792>>ASSIGN   5803>>CALLBLT  5804<<ASSIGN   5804>>ASSIGN   5820>>CALLBLT  5821<<ASSIGN
      5821>>ASSIGN   5832>>CALLBLT  5833<<ASSIGN   5833>>ASSIGN   5843>>CALLBLT  5844<<ASSIGN   5844>>ASSIGN
      5862>>CALLBLT  5863<<ASSIGN   5863>>ASSIGN   5869>>CALLBLT  5870<<ASSIGN   5870>>ASSIGN   5877>>CALLBLT
      5878<<ASSIGN   5878>>ASSIGN   5885>>CALLBLT  5886<<ASSIGN   5886>>ASSIGN   5891>>CALLBLT  5892<<ASSIGN
      5892>>ASSIGN   5906>>CALLBLT  5907<<ASSIGN   5907>>ASSIGN   5926>>CALLBLT  5927<<ASSIGN   5927>>ASSIGN
      5941>>CALLBLT  5942<<ASSIGN   5942>>ASSIGN   5949>>CALLBLT  5950<<ASSIGN   5950>>ASSIGN   5956>>CALLBLT
      5957<<ASSIGN   5957>>ASSIGN   5962>>CALLBLT  5963<<ASSIGN   5963>>ASSIGN   5968>>CALLBLT  5969<<ASSIGN
      5969>>ASSIGN   5974>>CALLBLT  5975<<ASSIGN   5975>>ASSIGN   5980>>CALLBLT  5981<<ASSIGN   5981>>ASSIGN
      5986>>CALLBLT  5987<<ASSIGN   5987>>ASSIGN   5992>>CALLBLT  5993<<ASSIGN   5993>>ASSIGN   5999>>CALLBLT
      6000<<ASSIGN   6000>>ASSIGN   6004>>CALLBLT  6005<<ASSIGN   6005>>ASSIGN   6018>>CALLBLT  6019<<ASSIGN
      6019>>ASSIGN   6027>>CALLBLT  6028<<ASSIGN   6028>>ASSIGN   6034>>CALLBLT  6035<<ASSIGN   6035>>ASSIGN
      6053>>CALLBLT  6054<<ASSIGN   6054>>ASSIGN   6066>>CALLBLT  6067<<ASSIGN   6067>>ASSIGN   6074>>CALLBLT
      6075<<ASSIGN   6075>>ASSIGN   6087>>CALLBLT  6088<<ASSIGN   6088>>ASSIGN   6094>>CALLBLT  6095<<ASSIGN
      6095>>ASSIGN   6099>>CALLBLT  6100<<ASSIGN   6100>>ASSIGN   6120>>CALLBLT  6121<<ASSIGN   6121>>ASSIGN
      6126>>CALLBLT  6127<<ASSIGN   6127>>ASSIGN   6141>>CALLBLT  6142<<ASSIGN   6142>>ASSIGN   6150>>CALLBLT
      6151<<ASSIGN   6151>>ASSIGN   6171>>CALLBLT  6172<<ASSIGN   6172>>ASSIGN   6179>>CALLBLT  6180<<ASSIGN
      6180>>ASSIGN   6187>>CALLBLT  6188<<ASSIGN   6188>>ASSIGN   6203>>CALLBLT  6204<<ASSIGN   6204>>ASSIGN
      6209>>CALLBLT  6210<<ASSIGN   6210>>ASSIGN   6215>>CALLBLT  6216<<ASSIGN   6216>>ASSIGN   6221>>CALLBLT
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:243  
      6222<<ASSIGN   6222>>ASSIGN   6239>>CALLBLT  6240<<ASSIGN   6240>>ASSIGN   6251>>CALLBLT  6252<<ASSIGN
      6252>>ASSIGN   6262>>CALLBLT  6263<<ASSIGN   6263>>ASSIGN   6273>>CALLBLT  6274<<ASSIGN   6274>>ASSIGN
      6305>>CALLBLT  6306<<ASSIGN   6306>>ASSIGN   6315>>CALLBLT  6316<<ASSIGN   6316>>ASSIGN   6343>>CALLBLT
      6344<<ASSIGN   6344>>ASSIGN   6352>>CALLBLT  6353<<ASSIGN   6353>>ASSIGN   6359>>CALLBLT  6360<<ASSIGN
      6360>>ASSIGN   6371>>CALLBLT  6372<<ASSIGN   6372>>ASSIGN   6378>>CALLBLT  6379<<ASSIGN   6379>>ASSIGN
      6386>>CALLBLT  6387<<ASSIGN   6387>>ASSIGN   6392>>CALLBLT  6393<<ASSIGN   6393>>ASSIGN   6414>>CALLBLT
      6415<<ASSIGN   6415>>ASSIGN   6423>>CALLBLT  6424<<ASSIGN   6424>>ASSIGN   6430>>CALLBLT  6431<<ASSIGN
      6431>>ASSIGN   6435>>CALLBLT  6436<<ASSIGN   6436>>ASSIGN   6443>>CALLBLT  6444<<ASSIGN   6444>>ASSIGN
      6470>>CALLBLT  6471<<ASSIGN   6471>>ASSIGN   6476<<ASSIGN   6476>>ASSIGN   6479>>CALLBLT  6480<<ASSIGN
      6480>>ASSIGN   6495>>IF       6499>>IF       6500>>CALLBLT  6504>>IF       6505>>CALLBLT  6507>>ASSIGN
      6508<<ASSIGN   6573>>CALLBLT  6574<<ASSIGN   6574>>ASSIGN   6584>>CALLBLT  6585<<ASSIGN   6585>>ASSIGN
LIMITS_HIT
      3864**DCL      4706<<ASSIGN   4715<<ASSIGN   4715>>ASSIGN   4719>>IF       4732<<ASSIGN   4732>>ASSIGN
      4736>>IF       4749<<ASSIGN   4749>>ASSIGN   4753>>IF       4766<<ASSIGN   4766>>ASSIGN   4770>>IF
      4783<<ASSIGN   4783>>ASSIGN   4787>>IF       4800<<ASSIGN   4800>>ASSIGN   4804>>IF       4817<<ASSIGN
      4817>>ASSIGN   4821>>IF       4834<<ASSIGN   4834>>ASSIGN   4838>>IF       4851<<ASSIGN   4851>>ASSIGN
      4853>>IF
LOBUF
      4153**DCL      4322--DCLINIT  4323--DCLINIT  5498<<CALLBLT  5499<<CALLBLT  5521<<CALLBLT  5522<<CALLBLT
      5535<<CALLBLT  5536<<CALLBLT  5558<<CALLBLT  5559<<CALLBLT  5569<<CALLBLT  5570<<CALLBLT  5580<<CALLBLT
      5581<<CALLBLT  6505<<CALLBLT  6545<<CALLBLT
LPTAB
      3922**DCL      5210<<ASSIGN   5501<<ASSIGN   5524<<ASSIGN   5538<<ASSIGN   5561<<ASSIGN   5572<<ASSIGN
      5583<<ASSIGN   5595<<ASSIGN   6539>>IF       6544>>ASSIGN   6545>>CALLBLT
LPWRITES
      3876**DCL      5491<<ASSIGN   5590>>IF       6543<<ASSIGN   6543>>ASSIGN
M$DEVICE
        55**DCL-ENT  5230--CALL     5359--CALL
M$DISPLAY
       118**DCL-ENT  5934--CALL
M$TIME
       118**DCL-ENT  4956--CALL     5330--CALL     5379--CALL     5428--CALL     5996--CALL     6091--CALL
M$WRITE
        52**DCL-ENT  5341--CALL     5486--CALL     6526--CALL     6532--CALL     6542--CALL
NFOLL
      3865**DCL      6135<<ASSIGN   6136>>DOWHILE  6137>>IF       6146>>IF       6163>>CALLBLT  6167>>IF
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:244  
      6183>>DOCASE   6192>>ASSIGN   6197>>CALLBLT  6224<<ASSIGN   6224>>ASSIGN   6227>>IF
NOB IN PROCEDURE INS_NUM
      6570**LABEL    6569--CALLALT
NPS
      3873**DCL      6298<<ASSIGN   6302<<ASSIGN   6302>>ASSIGN   6326>>IF
NRES
      3874**DCL      6407<<ASSIGN   6410>>IF       6427<<ASSIGN   6427>>ASSIGN   6486>>IF
NSN
      3875**DCL      6333<<ASSIGN   6339>>IF       6356<<ASSIGN   6356>>ASSIGN   6400>>IF
NUMEXTS
      4154**DCL      5474>>ASSIGN   6066--CALLBLT  6066>>CALLBLT  6067--ASSIGN
NX
      3868**DCL      6568<<ASSIGN   6570<<ASSIGN   6572>>ASSIGN   6573>>CALLBLT
OBUF
      4167**DCL      4541<<CALLBLT  4551<<CALLBLT  4561<<CALLBLT  4569<<CALLBLT  4576<<CALLBLT  4583<<CALLBLT
      4590<<CALLBLT  4597<<CALLBLT  4604<<CALLBLT  4611<<CALLBLT  4623<<CALLBLT  4635<<CALLBLT  4647<<CALLBLT
      4659<<CALLBLT  4666<<CALLBLT  4673<<CALLBLT  4680<<CALLBLT  4687<<CALLBLT  4694<<CALLBLT  4703<<CALLBLT
      4712<<CALLBLT  4723<<CALLBLT  4729<<CALLBLT  4740<<CALLBLT  4746<<CALLBLT  4757<<CALLBLT  4763<<CALLBLT
      4774<<CALLBLT  4780<<CALLBLT  4791<<CALLBLT  4797<<CALLBLT  4808<<CALLBLT  4814<<CALLBLT  4825<<CALLBLT
      4831<<CALLBLT  4842<<CALLBLT  4848<<CALLBLT  4857<<CALLBLT  4865<<CALLBLT  4876<<CALLBLT  4884<<CALLBLT
      4893<<CALLBLT  4899<<CALLBLT  4905<<CALLBLT  4911<<CALLBLT  4917<<CALLBLT  4923<<CALLBLT  4937<<CALLBLT
      4944<<CALLBLT  4952<<CALLBLT  4959<<CALLBLT  4964<<CALLBLT  4969<<CALLBLT  4992<<CALLBLT  4999<<CALLBLT
      5012<<CALLBLT  5022<<CALLBLT  5028<<CALLBLT  5033<<CALLBLT  5040<<CALLBLT  5046<<CALLBLT  5052<<CALLBLT
      5067<<CALLBLT  5076<<CALLBLT  5081<<CALLBLT  5086<<CALLBLT  5093<<CALLBLT  5107<<CALLBLT  5146<<CALLBLT
      5153<<CALLBLT  5171<<CALLBLT  5505<<CALLBLT  5542<<CALLBLT  5548<<CALLBLT  5599<<CALLBLT  5642<<CALLBLT
      5653<<CALLBLT  5665<<CALLBLT  5679<<CALLBLT  5689<<CALLBLT  5702<<CALLBLT  5710<<CALLBLT  5724<<CALLBLT
      5744<<CALLBLT  5756<<CALLBLT  5765<<CALLBLT  5777<<CALLBLT  5791<<CALLBLT  5803<<CALLBLT  5820<<CALLBLT
      5832<<CALLBLT  5843<<CALLBLT  5862<<CALLBLT  5869<<CALLBLT  5877<<CALLBLT  5885<<CALLBLT  5891<<CALLBLT
      5906<<CALLBLT  5926<<CALLBLT  5941<<CALLBLT  5949<<CALLBLT  5956<<CALLBLT  5962<<CALLBLT  5968<<CALLBLT
      5974<<CALLBLT  5980<<CALLBLT  5986<<CALLBLT  5992<<CALLBLT  5999<<CALLBLT  6004<<CALLBLT  6018<<CALLBLT
      6027<<CALLBLT  6034<<CALLBLT  6053<<CALLBLT  6066<<CALLBLT  6074<<CALLBLT  6087<<CALLBLT  6094<<CALLBLT
      6099<<CALLBLT  6120<<CALLBLT  6126<<CALLBLT  6141<<CALLBLT  6150<<CALLBLT  6171<<CALLBLT  6179<<CALLBLT
      6187<<CALLBLT  6203<<CALLBLT  6209<<CALLBLT  6215<<CALLBLT  6221<<CALLBLT  6239<<CALLBLT  6251<<CALLBLT
      6262<<CALLBLT  6273<<CALLBLT  6305<<CALLBLT  6315<<CALLBLT  6343<<CALLBLT  6352<<CALLBLT  6359<<CALLBLT
      6371<<CALLBLT  6378<<CALLBLT  6386<<CALLBLT  6392<<CALLBLT  6414<<CALLBLT  6423<<CALLBLT  6430<<CALLBLT
      6435<<CALLBLT  6443<<CALLBLT  6470<<CALLBLT  6479<<CALLBLT  6500>>CALLBLT  6505>>CALLBLT  6573<<CALLBLT
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:245  
      6584<<CALLBLT
OCMSG_UFMT
      4262**DCL      6526<>CALL
OCMSG_UFMT.BUF_.BOUND
      4262**DCL      6525<<ASSIGN
OCMSG_UFMT.STATION_
      4264**DCL      4264--REDEF
OCMSG_UFMT.V
      4265**DCL      4262--DCLINIT
OCMSG_UFMT.V.DVBYTE.VFC#
      4271**DCL      4271--REDEF
OD$CXT.HIPRIO
      3766**DCL      3767--REDEF
OD$CXT.NOTWSN
      3763**DCL      3764--REDEF
OD_CXT.CADDR
      2476**DCL      4490>>ASSIGN
OD_CXT.HDRDUN
      2453**DCL      5224>>IF       5226<<ASSIGN   5353>>IF       5355<<ASSIGN
OD_CXT.HIPRIO
      2487**DCL      2488--REDEF
OD_CXT.LPWSN
      2481**DCL      5815>>IF       5815>>IF
OD_CXT.NDONE
      2448**DCL      4525>>ASSIGN   4977>>ASSIGN   4988>>ASSIGN   5122>>ASSIGN   5131>>ASSIGN   5140>>ASSIGN
      5223>>ASSIGN   5352>>ASSIGN
OD_CXT.NOTWSN
      2484**DCL      2485--REDEF
OD_CXT.ONLP
      2477**DCL      4492>>IF       6497>>IF       6518>>IF
OD_CXT.RES$
      2451**DCL      6430>>CALLBLT  6430>>CALLBLT  6431>>ASSIGN   6435>>CALLBLT  6435>>CALLBLT  6436>>ASSIGN
      6438>>ASSIGN   6449>>DOSELCT
OD_CXT.SEG$
      2446**DCL      4525>>ASSIGN   4538>>ASSIGN   4977>>ASSIGN   4988>>ASSIGN   5122>>ASSIGN   5131>>ASSIGN
      5140>>ASSIGN   5223>>ASSIGN   5352>>ASSIGN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:246  
OD_CXT.SN$
      2450**DCL      6336>>ASSIGN   6367>>IF       6374>>IF       6382>>IF
OD_CXT.SWSN
      2489**DCL      5661>>IF
OD_CXT.SYSID
      2480**DCL      4546>>CALLBLT
OD_CXT_INIT.HIPRIO
      2418**DCL      2419--REDEF
OD_CXT_INIT.NOTWSN
      2415**DCL      2416--REDEF
OD_OBMAX
      2356**DCL      6499>>IF
OD_PSEUDOS.PSLIST.PSEUDO#
      2566**DCL      6310>>ASSIGN
OD_READCSCG.STATION_
      2534**DCL      2535--REDEF
OD_READCSCG.V.DVBYTE.REREAD#
      2546**DCL      2546--REDEF
OD_READCSCG.V.INDX#
      2544**DCL      2544--REDEF
OD_SGHST
      2354**DCL      6522>>IF
OF_LINE
      4000**DCL      4357--DCLINIT  4358--DCLINIT
OF_LINE.ACCT
      4008**DCL      5260<<ASSIGN   5262<<CALLBLT  5262--CALLBLT
OF_LINE.ATTRS
      4026**DCL      4027--REDEF    5320<<ASSIGN
OF_LINE.ATTRSR.APL
      4028**DCL      5327<<ASSIGN
OF_LINE.ATTRSR.BIN
      4030**DCL      5326<<ASSIGN
OF_LINE.ATTRSR.LC
      4031**DCL      5325<<ASSIGN
OF_LINE.ATTRSR.OVR
      4029**DCL      5324<<ASSIGN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:247  
OF_LINE.COMF
      4022**DCL      5305<<ASSIGN   5310<<CALLBLT  5311<<CALLBLT  5311--CALLBLT  5311>>CALLBLT
OF_LINE.COPIES
      4016**DCL      5273<<CALLBLT  5274<<CALLBLT  5274--CALLBLT  5274>>CALLBLT
OF_LINE.CREADATE.D
      4037**DCL      5333<<ASSIGN
OF_LINE.CREADATE.M
      4036**DCL      5332<<ASSIGN
OF_LINE.CREADATE.Y
      4038**DCL      5334<<ASSIGN
OF_LINE.CREATIME
      4033**DCL      5331<<ASSIGN
OF_LINE.DEVTYP
      4010**DCL      5264<<ASSIGN
OF_LINE.FORM
      4024**DCL      5316<<ASSIGN   5318<<CALLBLT  5318--CALLBLT
OF_LINE.GRANS
      4014**DCL      5268<<CALLBLT  5269<<CALLBLT  5269--CALLBLT  5269>>CALLBLT
OF_LINE.JOBNAME
      4042**DCL      5339<<ASSIGN
OF_LINE.MODE
      4006**DCL      5246<<ASSIGN   5249<<ASSIGN   5252<<ASSIGN   5255<<ASSIGN
OF_LINE.NODEV
      4040**DCL      5336<<ASSIGN   5338<<ASSIGN
OF_LINE.NUM
      4004**DCL      5240<<CALLBLT  5241<<CALLBLT  5241--CALLBLT  5241>>CALLBLT
OF_LINE.PRIO
      4018**DCL      5279<<ASSIGN   5282<<ASSIGN   5285<<ASSIGN   5290<<CALLBLT  5291<<CALLBLT  5291--CALLBLT
      5291>>CALLBLT
OF_LINE.SAP
      4020**DCL      5300<<CALLBLT  5301<<CALLBLT  5301--CALLBLT  5301>>CALLBLT  5304<<ASSIGN
OF_LINE.SYSID
      4002**DCL      5235<<CALLBLT  5236<<CALLBLT  5236--CALLBLT  5236>>CALLBLT
OF_LINE.WOD
      4012**DCL      5265<<ASSIGN
OF_TITLE
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:248  
      3959**DCL      3998--REDEF
OF_TITLE.ATTRS
      3984**DCL      3985--REDEF
OF_TITLER
      3998**DCL      5228--ASSIGN   5229>>ASSIGN
OPMSG_UFMT
      4205**DCL      4263--DCLINIT  4264--DCLINIT  6525--ASSIGN
OPMSG_UFMT.BUF
      4218**DCL      6500<<CALLBLT  6525--ASSIGN   6530--ASSIGN
OPMSG_UFMT.BUFL
      4217**DCL      6524<<ASSIGN
OPMSG_UFMT.CADDR
      4206**DCL      4490<<ASSIGN
OPMSG_UFMT.FLAGS
      4212**DCL      4213--REDEF
OPMSG_UFMT.MSGID
      4208**DCL      4209--REDEF
OTHRHDR
      3938**DCL      5581--CALLBLT  5581>>CALLBLT  5582--ASSIGN
OUTDATE
      3957**DCL      4292--DCLINIT  4293--DCLINIT  4969--CALLBLT  4969>>CALLBLT  4970--ASSIGN   5332>>ASSIGN
      5333>>ASSIGN   5334>>ASSIGN   5381>>ASSIGN   5382>>ASSIGN   5383>>ASSIGN   5430>>ASSIGN   5431>>ASSIGN
      5432>>ASSIGN   6104>>ASSIGN
OUTTIME
      3952**DCL      4294--DCLINIT  4295--DCLINIT
OUTTIME.HHMM
      3953**DCL      4959--CALLBLT  4959>>CALLBLT  4960--ASSIGN   5331>>ASSIGN   5380>>ASSIGN   5429>>ASSIGN
      5999--CALLBLT  5999>>CALLBLT  6000--ASSIGN   6094--CALLBLT  6094>>CALLBLT  6095--ASSIGN
PARTM
      3919**DCL      3920--REDEF    5437<<ASSIGN
PARTMR.P
      3921**DCL      5439>>IF
POSN
      3857**DCL      5113<<ASSIGN   5465<<ASSIGN   5468>>CALLBLT  5471>>IF       5471>>IF       5474>>ASSIGN
      5478>>ASSIGN   6040<<ASSIGN   6058>>CALLBLT  6061>>IF       6061>>IF       6066>>CALLBLT  6066>>CALLBLT
      6067>>ASSIGN   6074>>CALLBLT  6074>>CALLBLT  6075>>ASSIGN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:249  
PSETHDR
      3936**DCL      5570--CALLBLT  5570>>CALLBLT  5571--ASSIGN
PSEUHDR
      3937**DCL      5559--CALLBLT  5559>>CALLBLT  5560--ASSIGN
PSNAME
      3871**DCL      6336<<ASSIGN   6337>>IF       6364>>ASSIGN
R$INPUT.J
      3638**DCL      4525--ASSIGN   4977--ASSIGN   5122--ASSIGN   5131--ASSIGN   5140--ASSIGN   5352--ASSIGN
R$OUTPUT.F
      3607**DCL      4988--ASSIGN   5223--ASSIGN
RESX
      3870**DCL      6408<<ASSIGN   6430>>CALLBLT  6430>>CALLBLT  6431>>ASSIGN   6435>>CALLBLT  6435>>CALLBLT
      6436>>ASSIGN   6438>>ASSIGN   6449>>DOSELCT  6483<<ASSIGN   6483>>ASSIGN
SET_HDR
      4385**DCL      5230<>CALL     5359<>CALL
SET_HDR.V
      4386**DCL      4385--DCLINIT
SNX
      3869**DCL      6334<<ASSIGN   6336>>ASSIGN   6367>>IF       6374>>IF       6382>>IF       6397<<ASSIGN
      6397>>ASSIGN
STHDR
      3912**DCL      5227>>ASSIGN   5356>>ASSIGN
ST_DEFER
      3939**DCL      5456>>ASSIGN
ST_FOLL
      3946**DCL      5462>>ASSIGN
ST_RUN
      3944**DCL      5459>>ASSIGN
ST_WAIT
      3941**DCL      5480>>ASSIGN
ST_WAIT.NUMEXT
      3943**DCL      5474<<ASSIGN   5478<<ASSIGN
ST_WAIT.POS
      3942**DCL      5468<<CALLBLT  5469<<CALLBLT  5469--CALLBLT  5469>>CALLBLT
ST_WPART
      3950**DCL      5450>>ASSIGN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:250  
ST_WPS
      3948**DCL      5453>>ASSIGN
TEEN_NUMEXTS
      4155**DCL      5478>>ASSIGN   6074--CALLBLT  6074>>CALLBLT  6075--ASSIGN
TLEN
      3862**DCL      4516<<ASSIGN   5208<<ASSIGN   5500<<ASSIGN   5501>>ASSIGN   5523<<ASSIGN   5524>>ASSIGN
      5537<<ASSIGN   5538>>ASSIGN   5560<<ASSIGN   5561>>ASSIGN   5571<<ASSIGN   5572>>ASSIGN   5582<<ASSIGN
      5583>>ASSIGN   5593<<ASSIGN   6499>>IF       6500>>CALLBLT  6504>>IF       6505>>CALLBLT  6507<<ASSIGN
      6507>>ASSIGN   6520>>IF       6524>>ASSIGN   6525>>ASSIGN   6531>>ASSIGN   6534<<ASSIGN   6539>>IF
      6541>>ASSIGN   6544<<ASSIGN
TXNUM
      4168**DCL      4546<<CALLBLT  4616<<CALLBLT  4628<<CALLBLT  4640<<CALLBLT  4652<<CALLBLT  4928<<CALLBLT
      5005<<CALLBLT  5017<<CALLBLT  5059<<CALLBLT  5166<<CALLBLT  5647<<CALLBLT  5715<<CALLBLT  5730<<CALLBLT
      5911<<CALLBLT  6009<<CALLBLT  6058<<CALLBLT  6163<<CALLBLT  6197<<CALLBLT  6246<<CALLBLT  6257<<CALLBLT
      6267<<CALLBLT  6278<<CALLBLT  6320<<CALLBLT  6558>>CALLBLT  6566>>CALLBLT
TXRELATIONS
      4166**DCL      6192>>ASSIGN
TXSTR
      4169**DCL      4170--REDEF    4173--DCLINIT  4556<<ASSIGN   5098<<ASSIGN   5158<<ASSIGN   5510<<ASSIGN
      5658<<ASSIGN   5670<<ASSIGN   5684<<ASSIGN   5751<<ASSIGN   5772<<ASSIGN   5783<<ASSIGN   5797<<ASSIGN
      5825<<ASSIGN   5837<<ASSIGN   6104<<ASSIGN   6155<<ASSIGN   6192<<ASSIGN   6310<<ASSIGN   6364<<ASSIGN
      6465<<ASSIGN   6569>>CALLBLT  6572--ASSIGN   6583>>CALLBLT  6584>>CALLBLT
TXSTR$
      4173**DCL      6573>>CALLBLT
TXSTRR.BOT
      4172**DCL      6558<<CALLBLT  6566<<CALLBLT
TXSTRR.TOP
      4171**DCL      6557<<ASSIGN   6565<<ASSIGN
VLP$HDR.TITL.L#
      3794**DCL      5228<<ASSIGN   5357<<ASSIGN
VLP$HDR.TITL.TITLE#
      3795**DCL      5229<<ASSIGN   5358<<ASSIGN
VLR_DISPLAY
      3894**DCL      4474--DCLINIT
VLR_DISPLAY.ETMF
      3894**DCL      5935>>DOCASE
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:251  
VLR_DISPLAY.USERS
      3894**DCL      5937>>IF
WRITE_ILINE
      4413**DCL      5486<>CALL
WRITE_ILINE.STATION_
      4415**DCL      4415--REDEF
WRITE_ILINE.V
      4416**DCL      4413--DCLINIT
WRITE_ILINE.V.DVBYTE.VFC#
      4422**DCL      4422--REDEF
WRITE_LO
      4321**DCL      6542<>CALL
WRITE_LO.BUF_.BOUND
      4321**DCL      6541<<ASSIGN
WRITE_LO.STATION_
      4323**DCL      4323--REDEF
WRITE_LO.V
      4324**DCL      4321--DCLINIT
WRITE_LO.V.DVBYTE.VFC#
      4330**DCL      4330--REDEF
WRITE_ME
      4447**DCL      6532<>CALL
WRITE_ME.BUF_.BOUND
      4447**DCL      6531<<ASSIGN
WRITE_ME.BUF_.BUF$
      4449**DCL      6530<<ASSIGN
WRITE_ME.STATION_
      4449**DCL      4449--REDEF
WRITE_ME.V
      4450**DCL      4447--DCLINIT
WRITE_ME.V.DVBYTE.VFC#
      4456**DCL      4456--REDEF
WRITE_OLINE
      4356**DCL      5341<>CALL
WRITE_OLINE.STATION_
      4358**DCL      4358--REDEF
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:252  
WRITE_OLINE.V
      4359**DCL      4356--DCLINIT
WRITE_OLINE.V.DVBYTE.VFC#
      4365**DCL      4365--REDEF
WSNHDR
      3933**DCL      5499--CALLBLT  5499>>CALLBLT  5500--ASSIGN
XCON.ERR.ERR#
      3930**DCL      3930--REDEF
XCON.LIMIT
      3927**DCL      4707<<ASSIGN
XCON.LIMIT.DGO
      3928**DCL      4768>>IF
XCON.LIMIT.LO
      3928**DCL      4751>>IF
XCON.LIMIT.MEM
      3928**DCL      3928--REDEF
XCON.LIMIT.PDISK
      3928**DCL      4785>>IF
XCON.LIMIT.PLO
      3928**DCL      4734>>IF
XCON.LIMIT.PO
      3927**DCL      4708>>IF
XCON.LIMIT.STACK
      3928**DCL      4836>>IF
XCON.LIMIT.TAPE
      3928**DCL      4819>>IF
XCON.LIMIT.TDISK
      3928**DCL      4802>>IF
XCON.LIMIT.TIME
      3928**DCL      4717>>IF
XSJ$JOBINFO.ACCT#
      3708**DCL      4556>>ASSIGN
XSJ$JOBINFO.FRS#
      3706**DCL      4872>>IF       4880>>IF       4889>>DOCASE
XSJ$JOBINFO.OFF_TIME#
      3707**DCL      4955>>ASSIGN
PL6.E3A0      #001=ODF$FORMAT File=ODF$FORMAT.:E05TSI                            WED 07/30/97 04:11 Page:253  
XSJ$JOBINFO.RECNO#
      3707**DCL      4616>>CALLBLT  4628>>CALLBLT  4640>>CALLBLT  4652>>CALLBLT
XSJ$JOBINFO.STATUS#
      3707**DCL      4564>>DOCASE
XSJ$JOBINFO.STEPCC#
      3706**DCL      4928>>CALLBLT
XSJ$JOBINFO.XLIMFLG#
      3706**DCL      4699>>IF       4707>>ASSIGN
