VERSION E05

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:1    
        1        1         /*M* DAD$CFUS - Display the CFU data segment for ANLZ */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DAD$CFUS: PROC(CFUBLK);
        8        8        %INCLUDE CP_6;
        9       89        %INCLUDE DA_FORMAT_C;
       10      331        %INCLUDE FM$MACROS;
       11      706        %INCLUDE DA_CMD_C;
       12     1055        %INCLUDE XU_MACRO_C;
       13     4161        %PARSE$OUT(STCLASS=,NAME=CFUBLK);
       14     4206        %PARSE$OUT(STCLASS=BASED,NAME=OBLK);
       15     4251        %PARSE$SYM(STCLASS=BASED,NAME=OSYM);
       16     4289    1   DCL DAA$WILDCOMP ENTRY(3) ALTRET;
       17     4290    1   DCL DAM$MAP ENTRY(5) ALTRET;
       18     4291    1   DCL DAF$INIT ENTRY(1) ALTRET;
       19     4292    1   DCL DAF$WRITE EPTR SYMREF;
       20     4293        %REPORT(NAME=CFU_REP,TITLEADR=DEV_TTL,HEADER=YES,WRAPTAB=18);
       21     4359        %HEADER(TEXTADR=DEV_HDR,LAST=NO);
       22     4401        %HEADER(TEXTADR=VOL_HDR,LAST=NO);
       23     4443        %HEADER(TEXT=
       24     4444        '--------------------------------------------------------------------------------');
       25     4486        %VLP_NAME(STCLASS=CONSTANT,FPTN=DEV_TTL,NAME=
       26     4487        'CFU AREA DISPLAYS');
       27     4514        %VLP_NAME(STCLASS=CONSTANT,FPTN=DEV_HDR,NAME=
       28     4515        'DEV:    NAME         VSN FLG  SYSID       NXTSDA');
       29     4542        %VLP_NAME(STCLASS=CONSTANT,FPTN=VOL_HDR,NAME=
       30     4543        'VOL:    SETX S#      VSN FLG  SYSID V#    NXTSDA DRZERO    RGRANS     GPSDA');
       31     4570        %VLP_NAME(STCLASS=CONSTANT,FPTN=SET_HDR,NAME=
       32     4571        'SET:    VOLX  PSN    FLAGS         CHD    NXTSDA    GACTIME     REALSN   CHKSUM');
       33     4598        %VLP_NAME(STCLASS=CONSTANT,FPTN=ACT_HDR,NAME=
       34     4599        'CFUA:   SETX ACCOUNT     FDCSDA  FDFITSDA FLG CH ACCESS    AGE DFFLGS    RGRANS');
       35     4626        %VLP_NAME(STCLASS=CONSTANT,FPTN=FIL_HDR,NAME=
       36     4627        '  ADDR F S AMSAfit FITSDA     NRECS #US RSZ    UGRANS MCNT B      LDA    NGAVAL');
       37     4654        %VLP_NAME(STCLASS=CONSTANT,FPTN=SN_HDR,NAME=
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:2    
       38     4655        '  SNS: LINKX SN0    SN1    SN2    SN3     SYSID   DCBX');
       39     4682        %VLP_NAME(STCLASS=CONSTANT,FPTN=UNU_HDR,NAME=
       40     4683        '  LOC:           CONTENTS');
       41     4710        %VLP_NAME(STCLASS=CONSTANT,FPTN=SUM_HDR,NAME=
       42     4711        '  DEVS  VOLS  SETS SYSID ACCTS FILES  XTNS  FDAS  FREE   SNS  LOST TOTAL NAMESZ');
       43     4738    1   DCL DEV_MSG CONSTANT CHAR(0) INIT(
       44     4739    1   ' %5O%2S  DP%2.18ZD   %9D %3.18MO%7.18D    %9ZO%S%S!');
       45     4740    1   DCL VOL_MSG CONSTANT CHAR(0) INIT(
       46     4741    1   ' %5O%2S%6.18O%3.9D%9.27D %3.18MO%7.18D%3.9D %9.27ZO%7D%4S %9+D %9ZO%S!');
       47     4742    1   DCL SET_MSG CONSTANT CHAR(0) INIT(
       48     4743    1   ' %5O%6.18O  %6A %6.18ZO%7.18D%4.9O %9.27ZO %14.0.2U%2S %6A%9D%S!');
       49     4744    1   DCL SID_MSG CONSTANT CHAR(0) INIT(
       50     4745    1   'Sysids (at%5O0)%18N.18N(%7.18&D%)%S%S!');
       51     4746    1   DCL AC_MSG CONSTANT CHAR(0) INIT(
       52     4747    1   '%5O0%6.18O%2S %8A %9ZO %9ZO %3.9ZO%3.9D %6.18ZO%7.18D %6.18ZO %9+*D%S!');
       53     4748    1   DCL FIA_MSG CONSTANT CHAR(0) INIT(
       54     4749        '%5O0%2.3D%2.2D%2.1D%1.1D%1.1D%1.1D %9.27O %9D%6S%4.18D%4.9D %9.27D%4S
       55     4750    1   %5.15D%2.1.1ND%9.27.1NO %9.27D%S!');
       56     4751    1   DCL FIL_MSG CONSTANT CHAR(0) INIT(
       57     4752    1   '%5O0%2.3D%2.2D%2.1D%1.1D%1.1D%1.1D %9.27O %9D%6S%4.18D%S %>A!');
       58     4753    1   DCL FDA_MSG CONSTANT CHAR(0) INIT(
       59     4754    1   '%5O0%17-%9ZO%S%30-%>A!');
       60     4755    1   DCL FID STATIC CHAR(52);
       61     4756    1   DCL JTAP_MSG CONSTANT CHAR(0) INIT(
       62     4757        /* The following curious-looking comment assists any would-be maintainer to
       63     4758           insure that JTAP_MSG occupies its last word completely, which it must. */
       64     4759        /***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-**/
       65     4760    1   '%2.4PDcb#=%0.9D%, Dctx=.%0.9O, Vol=%0.9D, Max=%0.9D, %2.6PBlkl=%0.18D, Sns@.%0.18O,
              4760         Prec#=%00D%/');
       66     4761    1   DCL JFIL_MSG CONSTANT CHAR(0) INIT(
       67     4762    1   '%2.5P%1N(Up,%)%1N.1N(Er,%)DmUs=%0.6D.%0.9O,Pg=.%0.18O%3P%30-%>A!');
       68     4763    1   DCL KEY_MSG CONSTANT CHAR(0) INIT(
       69     4764    1   '%2.5PSlide=%.9D,GDA=%.27O%.15S%1N.1N(,Abld%)%1N(,Ubld%)%3P%30-%>A!');
       70     4765    1   DCL XTN_MSG CONSTANT CHAR(0) INIT(
       71     4766    1   'Extents @%5O0: %6N.30N(%12&ZO %)%S%S!');
       72     4767    1   DCL LNK_MSG CONSTANT CHAR(0) INIT(
       73     4768    1   '**** Bad blink in free chain %6O -> %6O');
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:3    
       74     4769    1   DCL SN_MSG CONSTANT CHAR(0) INIT(
       75     4770    1   '%5O0%2S%6.18O%2P%18N.18N( %6A%)%41-%2.7P%7.18D%7.18O%S%S!');
       76     4771    1   DCL UNU_MSG CONSTANT CHAR(0) INIT(
       77     4772    1   '%5O0           %8(%12&ZO %)%S%S!');
       78     4773    1   DCL SUM_MSG CONSTANT CHAR(0) INIT('%13(%6D%)');
       79     4774    1   DCL B$DS1$ PTR SYMREF;
       80     4775    1   DCL F$ PTR;
       81     4776    1   DCL A$ PTR;
       82     4777    1   DCL A$SBIN REDEF A$ SBIN;
       83     4778    1   DCL D@ UBIN;
       84     4779    1   DCL S@ UBIN;
       85     4780    1   DCL X@ UBIN;
       86     4781    1   DCL 1 FLG,
       87     4782    1         2 DEV BIT(1),
       88     4783    1         2 SET BIT(1),
       89     4784    1         2 ACT BIT(1),
       90     4785    1         2 FIL BIT(1),
       91     4786    1         2 FIA BIT(1),
       92     4787    1         2 SNS BIT(1),
       93     4788    1         2 UNU BIT(1),
       94     4789    1         2 * BIT(29);
       95     4790    1   DCL TYPE UBIN;
       96     4791    1   DCL F$CFU$ PTR;
       97     4792    1   DCL 1 COUNTS,
       98     4793    1         2 DEV UBIN,
       99     4794    1         2 VOL UBIN,
      100     4795    1         2 SET UBIN,
      101     4796    1         2 SYSID UBIN,
      102     4797    1         2 ACCT UBIN,
      103     4798    1         2 FILE UBIN,
      104     4799    1         2 XTN UBIN,
      105     4800    1         2 FDA UBIN,
      106     4801    1         2 FREE UBIN,
      107     4802    1         2 SN UBIN,
      108     4803    1         2 LOST UBIN,
      109     4804    1         2 TOTAL UBIN,
      110     4805    1         2 NAME UBIN;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:4    
      111     4806    1   DCL BITS(0:255) BIT(36);
      112     4807    1   DCL MASKS(0:31)BIT(36) CONSTANT INIT(
      113     4808    1   '4'O,'2'O,'1'O,'04'O,'02'O,'01'O,'004'O,'002'O,'001'O,
      114     4809    1   '0004'O,'0002'O,'0001'O,'00004'O,'00002'O,'00001'O,'000004'O,'000002'O,'000001'O,
      115     4810    1   '0000004'O,'0000002'O,'0000001'O,'00000004'O,'00000002'O,'00000001'O,
      116     4811    1   '000000004'O,'000000002'O,'000000001'O,
      117     4812    1   '0000000004'O,'0000000002'O,'0000000001'O,
      118     4813    1   '00000000004'O,'00000000002'O);
      119     4814        %FM$CFUX;
      120     4819        %FM$SET(BASED="BASED(F$CFU$)");
      121     4824        %FM$DEV(BASED="BASED(F$CFU$)");
      122     4830        %FM$VOL(BASED="BASED(F$CFU$)");
      123     4836        %FM$SETU;
      124     4839        %FM$CFUA(BASED="BASED(A$)");
      125     4845        %FM$CFUN;
      126     4848        %FM$CFU(BASED="BASED(F$)");
      127     4854        %FT$CFUSN(BASED="BASED(F$)");
      128     4857        %FM$CFUJ(BASED="BASED(F$)");
      129     4862    1   DCL CHAR80 BASED CHAR(80);
      130     4863        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:5    
      131     4864    1      BITS='0'B;
      132     4865    1      COUNTS='0'B;
      133     4866        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:6    
      134     4867    1      CFU_REPHD00.TXT$=ADDR(DEV_HDR);
      135     4868    1      CFU_REPHD01.TXT$=ADDR(VOL_HDR);
      136     4869    1      CFU_REPHD00.NXT$=ADDR(CFU_REPHD01);
      137     4870    1      CALL DAF$INIT(CFU_REP);
      138     4871    1      CALL DAM$MAP(B$DS1$,F$CFU$) ALTRET(RETRET);
      139     4872    1      TYPE=%DA_CFUS_DEVICE;
      140     4873    1      D@=FM$CFUX.DSETH;
      141     4874    2      DO WHILE(D@~=0);
      142     4875    2         CALL USED(D@)ALTRET(ENDDEV);
      143     4876    2         CALL CHECK;
      144     4877    2         COUNTS.DEV=COUNTS.DEV+1;
      145     4878    2         IF FLG.DEV THEN CALL FORMAT(DEV_MSG,D@);
      146     4879    2         S@=FM$DEV.SECTL(D@);
      147     4880    3         DO WHILE(S@~=0);
      148     4881    3            CALL USED(S@)ALTRET(NXTDEV);
      149     4882    3            COUNTS.VOL=COUNTS.VOL+1;
      150     4883    3            IF FLG.DEV THEN CALL FORMAT(VOL_MSG,S@);
      151     4884    3            S@=FM$VOL.SECTL(S@);
      152     4885    3            END;
      153     4886    2   NXTDEV: D@=FM$DEV.DEVL(D@);
      154     4887    2         END;
      155     4888    1   ENDDEV:;
      156     4889    1      CFU_REPHD00.TXT$=ADDR(SET_HDR);
      157     4890    1      CALL DAF$INIT(CFU_REP);
      158     4891    1      TYPE=%DA_CFUS_SET;
      159     4892    1      S@=FM$CFUX.SETH;
      160     4893    2      DO WHILE(S@~=0);
      161     4894    2         CALL USED(S@)ALTRET(ENDSET);
      162     4895    2         CALL CHECK;
      163     4896    2         COUNTS.SET=COUNTS.SET+1;
      164     4897    2         IF FLG.SET THEN CALL FORMAT(SET_MSG,S@);
      165     4898    2         D@=FM$SET.DCTX(S@);
      166     4899    3         DO WHILE(D@~=0);
      167     4900    3            CALL UNUSED(D@)ALTRET(NXTSET1);
      168     4901    3            IF FLG.SET THEN CALL FORMAT(VOL_MSG,D@);
      169     4902    3            D@=FM$VOL.VOLL(D@);
      170     4903    3            END;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:7    
      171     4904    2   NXTSET1:;
      172     4905    2         X@=D@;
      173     4906    2         D@=FM$SET.SYSID(S@);
      174     4907    3         IF NOT FM$SET.ONEU(S@) THEN DO WHILE(D@~=0);
      175     4908    3            CALL USEDX(D@)ALTRET(NXTSET2);
      176     4909    3            COUNTS.SYSID=COUNTS.SYSID+1;
      177     4910    3            IF FLG.SET THEN CALL FORMAT(SID_MSG,D@/8);
      178     4911    3            D@=PINCRW(F$CFU$,D@)->FM$SETU.LINKX;
      179     4912    3            END;
      180     4913    2   NXTSET2:;
      181     4914    2         D@=FM$SET.DCTX(S@);
      182     4915    3         DO WHILE(D@~=X@);
      183     4916    3            CALL USED(D@);
      184     4917    3            D@=FM$VOL.VOLL(D@);
      185     4918    3            END;
      186     4919    2         S@=FM$SET.SETL(S@);
      187     4920    2         END;
      188     4921    1   ENDSET:;
      189     4922        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:8    
      190     4923    1      CFU_REPHD00.TXT$=ADDR(ACT_HDR);
      191     4924    1      CFU_REPHD00.NXT$=ADDR(CFU_REPHD02);
      192     4925    1      CALL DAF$INIT(CFU_REP);
      193     4926    1      TYPE=%DA_CFUS_ACCT;
      194     4927    1      D@=FM$CFUX.ACCTS;
      195     4928    2      DO WHILE(D@~=0);
      196     4929    2         CALL USEDX(D@) ALTRET(ENDACT);
      197     4930    2         A$=PINCRW(F$CFU$,D@);
      198     4931    2         S@=FM$CFUA.SETX;
      199     4932    2         CALL CHECK;
      200     4933    2         COUNTS.ACCT=COUNTS.ACCT+1;
      201     4934    2         IF FLG.ACT THEN CALL FORMAT(AC_MSG,D@/8);
      202     4935    2         D@=FM$CFUA.LINKX;
      203     4936    2         END;
      204     4937    1   ENDACT:;
      205     4938        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:9    
      206     4939    1      CFU_REPHD00.TXT$=ADDR(FIL_HDR);
      207     4940    1      CALL DAF$INIT(CFU_REP);
      208     4941    1      TYPE=%DA_CFUS_FILES;
      209     4942    1      D@=FM$CFUX.NAMES;
      210     4943    2      DO WHILE(D@<FM$CFUX.NAMEX);
      211     4944    2         X@=PINCRC(F$CFU$,D@)->FM$CFUN.LNKX;
      212     4945    3         DO WHILE(X@<FM$CFUX.CFUT);
      213     4946    3            CALL USEDX(X@) ALTRET(NXTNAM);
      214     4947    3            F$=PINCRW(F$CFU$,X@);
      215     4948    3            A$=PINCRW(F$CFU$,FM$CFU.ACCTX);
      216     4949    4   FILEOUT: IF A$SBIN<0 THEN DO;
      217     4950    4               FID='Sysid=';
      218     4951    4               S@=FM$CFU.STARX.SYSID;
      219     4952    4               CALL BINCHAR(SUBSTR(FID,6,6),S@);
      220     4953    4               A$=F$CFU$;
      221     4954    4               END;
      222     4955    3            ELSE IF A$=F$CFU$ THEN FID='Scratch';
      223     4956    4            ELSE DO;
      224     4957    4               CALL CONCAT(FID,'DP#',FM$SET.PSN(FM$CFUA.SETX));
      225     4958    4               CALL INDEX(S@,' ',FID);
      226     4959    4               CALL INSERT(FID,S@,,'.',FM$CFUA.ACCT);
      227     4960    4               END;
      228     4961    3            CALL INDEX(S@,' ',FID);
      229     4962    3            CALL INSERT(FID,S@,32,'/',PINCRC(F$CFU$,D@)->FM$CFUN.C);
      230     4963    3            CALL CHECK;
      231     4964    4            IF FM$CFU.FUN=0 THEN DO;
      232     4965    4               IF FLG THEN CALL FORMAT(FDA_MSG,X@/8);
      233     4966    4               COUNTS.FDA=COUNTS.FDA+1;
      234     4967    4               END;
      235     4968    4            ELSE DO;
      236     4969    5               IF FLG.FIA THEN DO;
      237     4970    5                  CALL FORMAT(FIA_MSG,X@/8);
      238     4971    5                  IF FM$CFU.FUN~=4 THEN A$=ADDR(KEY_MSG);
      239     4972    5                  ELSE IF FM$CFUJ.TAPE THEN A$=ADDR(JTAP_MSG);
      240     4973    5                  ELSE A$=ADDR(JFIL_MSG);
      241     4974    5                  CALL FORMAT(A$->CHAR80,X@/8);
      242     4975    5                  END;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:10   
      243     4976    4               ELSE IF FLG THEN CALL FORMAT(FIL_MSG,X@/8);
      244     4977    4               COUNTS.FILE=COUNTS.FILE+1;
      245     4978    4               END;
      246     4979    3            S@=FM$CFU.XTX;
      247     4980    4            DO WHILE(S@>1);
      248     4981    4               CALL USEDX(S@) ALTRET(NXTFIL);
      249     4982    4               COUNTS.XTN=COUNTS.XTN+1;
      250     4983    4               IF FLG.FIA THEN CALL FORMAT(XTN_MSG,S@/8);
      251     4984    4               S@=PINCRW(F$CFU$,S@)->FM$CFUA.LINKX;
      252     4985    4               END;
      253     4986    3   NXTFIL:;
      254     4987    3            IF COUNTS.TOTAL~=0 THEN GOTO NXTFREE;
      255     4988    3            X@=FM$CFU.NAMEX;
      256     4989    3            END;
      257     4990    2   NXTNAM:;
      258     4991    2         D@=D@+SIZEC(PINCRC(F$CFU$,D@)->FM$CFUN);
      259     4992    2         END;
      260     4993        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:11   
      261     4994    1      COUNTS.TOTAL=FM$CFUX.CFUT/8;
      262     4995    1      S@=0;
      263     4996    1      D@=FM$CFUX.HEAD;
      264     4997    2      DO WHILE(D@~=0);
      265     4998    2         IF D@>=FM$CFUX.CFUT THEN F$=F$CFU$;
      266     4999    2         ELSE F$=PINCRW(F$CFU$,D@);
      267     5000    2         IF F$=F$CFU$ OR FM$CFU.NAMEX=0 THEN CALL USEDX(D@) ALTRET(SNS);
      268     5001    3         ELSE DO;
      269     5002    3            CALL UNUSED(D@/8) ALTRET(SNS);
      270     5003    3            CALL USEDX(D@) ALTRET(SNS);
      271     5004    3            END;
      272     5005    2         COUNTS.FREE=COUNTS.FREE+1;
      273     5006    3         IF F$->FM$CFUX.TAIL~=S@ THEN DO;
      274     5007    3            CALL DAF$WRITE(VECTOR(LNK_MSG),VECTOR(S@),VECTOR(D@));
      275     5008    3            GOTO SNS;
      276     5009    3            END;
      277     5010    2         S@=D@;
      278     5011    2         D@=F$->FM$CFUX.HEAD;
      279     5012    2         END;
      280     5013    1      X@=0;
      281     5014    2      DO WHILE(X@<FM$CFUX.CFUT/8);
      282     5015    2         IF BITS(X@/32)='777777777760'O THEN  X@=X@/32*32+31;
      283     5016    3         ELSE IF NOT BITS(X@/32)&MASKS(MOD(X@,32)) THEN DO;
      284     5017    3            X@=X@*8;
      285     5018    3            F$=PINCRW(F$CFU$,X@);
      286     5019    4            IF FM$CFU.FUN~=0 AND FM$CFU.ACCTX=0 THEN DO;
      287     5020    4               D@=FM$CFU.NAMEX;
      288     5021    4               A$=PINCRW(F$CFU$,PINCRW(F$CFU$,D@)->FM$CFU.ACCTX);
      289     5022    5               IF D@=0 THEN DO;
      290     5023    5                  D@=X@*4+8;
      291     5024    5                  A$=F$CFU$;
      292     5025    5                  END;
      293     5026    5               ELSE DO WHILE(D@<FM$CFUX.CFUT);
      294     5027    5                  D@=PINCRW(F$CFU$,D@)->FM$CFU.NAMEX;
      295     5028    5                  END;
      296     5029    4               CALL USEDX(X@);
      297     5030    4               GOTO FILEOUT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:12   
      298     5031    4   NXTFREE:    END;
      299     5032    3            X@=X@/8;
      300     5033    3            END;
      301     5034    2         X@=X@+1;
      302     5035    2         END;
      303     5036        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:13   
      304     5037    1   SNS:;
      305     5038    1      CFU_REPHD00.TXT$=ADDR(SN_HDR);
      306     5039    1      CALL DAF$INIT(CFU_REP);
      307     5040    1      TYPE=%DA_CFUS_SERIAL;
      308     5041    1      X@=0;
      309     5042    2      DO WHILE(X@<FM$CFUX.CFUT/8);
      310     5043    2         IF BITS(X@/32)='777777777760'O THEN  X@=X@/32*32+31;
      311     5044    3         ELSE IF NOT BITS(X@/32)&MASKS(MOD(X@,32)) THEN DO;
      312     5045    3            F$=ADDR(FM$SET(X@));
      313     5046    3            IF FT$CFUSN.NUM~=0 AND FT$CFUSN.NUM<5
      314     5047    4            THEN DO S@=0 TO FT$CFUSN.NUM-1;
      315     5048    4               IF FT$CFUSN.SN(S@)<=' ' THEN GOTO NOTSN;
      316     5049    4               END;
      317     5050    3            ELSE GOTO NOTSN;
      318     5051    3            COUNTS.SN=COUNTS.SN+1;
      319     5052    3            CALL USED(X@);
      320     5053    3            CALL CHECK;
      321     5054    3            IF FLG.SNS THEN CALL FORMAT(SN_MSG,X@);
      322     5055    3   NOTSN:   END;
      323     5056    2         X@=X@+1;
      324     5057    2         END;
      325     5058        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:14   
      326     5059    1      CFU_REPHD00.TXT$=ADDR(UNU_HDR);
      327     5060    1      CALL DAF$INIT(CFU_REP);
      328     5061    1      TYPE=%DA_CFUS_UNALLOCATED;
      329     5062    1      X@=0;
      330     5063    2      DO WHILE(X@<FM$CFUX.CFUT/8);
      331     5064    2         IF BITS(X@/32)='777777777760'O THEN  X@=X@/32*32+31;
      332     5065    3         ELSE IF NOT BITS(X@/32)&MASKS(MOD(X@,32)) THEN DO;
      333     5066    3            CALL CHECK;
      334     5067    3            IF X@~=0 THEN COUNTS.LOST=COUNTS.LOST+1;
      335     5068    3            IF FLG.UNU THEN CALL FORMAT(UNU_MSG,X@);
      336     5069    3            END;
      337     5070    2         X@=X@+1;
      338     5071    2         END;
      339     5072        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:15   
      340     5073    1      CFU_REPHD00.TXT$=ADDR(SUM_HDR);
      341     5074    1      CALL DAF$INIT(CFU_REP);
      342     5075    1      COUNTS.NAME=(FM$CFUX.NAMET-FM$CFUX.NAMES)/4;
      343     5076    1      CALL DAF$WRITE(VECTOR(SUM_MSG),VECTOR(COUNTS));
      344     5077    1      RETURN;
      345     5078        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:16   
      346     5079    1   USEDX: PROC(I@) ALTRET;
      347     5080    2   DCL BADX_MSG CONSTANT CHAR(0) INIT(
      348     5081    2   ' *** Block at %O not in the CFUS%10P!');
      349     5082    2   DCL MPLX_MSG CONSTANT CHAR(0) INIT(
      350     5083    2   ' *** Block at %O in multiple use%10P!');
      351     5084    2   DCL I@ UBIN;
      352     5085    2   DCL WX UBIN;
      353     5086    2   DCL BX UBIN;
      354     5087    2      IF MOD(I@,8)~=0 OR I@>FM$CFUX.CFUT THEN GOTO BADX;
      355     5088    2      WX=I@/32/8;
      356     5089    2      BX=MOD(I@,8*32)/8;
      357     5090    2   TSTON: IF BITS(WX)&MASKS(BX) THEN GOTO MPLX;
      358     5091    2      BITS(WX)=BITS(WX)|MASKS(BX);
      359     5092    2      RETURN;
      360     5093    2   USED: ENTRY(I@) ALTRET;
      361     5094    2      CALL TEST ALTRET(BADX);
      362     5095    2      GOTO TSTON;
      363     5096    2   UNUSED: ENTRY(I@) ALTRET;
      364     5097    2      CALL TEST ALTRET(BADX);
      365     5098    2      IF NOT BITS(WX)&MASKS(BX) THEN GOTO MPLX;
      366     5099    2      BITS(WX)=BITS(WX)&~MASKS(BX);
      367     5100    2      RETURN;
      368     5101        /**/
      369     5102    2   TEST: PROC ALTRET;
      370     5103    3      IF I@>FM$CFUX.CFUT THEN ALTRETURN;
      371     5104    3      WX=I@/32;
      372     5105    3      BX=MOD(I@,32);
      373     5106    3      RETURN;
      374     5107    3   END;
      375     5108        /**/
      376     5109    2   BADX: CALL FORMAT(BADX_MSG,I@);
      377     5110    2      ALTRETURN;
      378     5111    2   MPLX: CALL FORMAT(MPLX_MSG,I@);
      379     5112    2      ALTRETURN;
      380     5113    2   END USEDX;
      381     5114        /**/
      382     5115        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:17   
      383     5116    1   FORMAT: PROC(CTL,CFUX);
      384     5117    2   DCL CTL CHAR(200);
      385     5118    2   DCL CFUX UBIN ALIGNED;
      386     5119    2   DCL I UBIN;
      387     5120    2      CALL INDEX(I,'!',CTL);
      388     5121    2      CALL DAF$WRITE(VECTOR(SUBSTR(CTL,0,I)),VECTOR(CFUX),VECTOR(FM$SET(CFUX)),
      389     5122    2        VECTOR(FID));
      390     5123    2      RETURN;
      391     5124    2   END FORMAT;
      392     5125        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:18   
      393     5126    1   CHECK: PROC;
      394     5127    2   DCL J UBIN;
      395     5128    2   DCL I UBIN;
      396     5129    2   DCL L UBIN;
      397     5130    2   DCL P$ PTR;
      398     5131    2   DCL Q$ PTR;
      399     5132    2      I=0;
      400     5133    2      FLG='0'B;
      401     5134    3      IF CFUBLK.NSUBLKS=0 THEN DO;
      402     5135    3         IF CFUBLK.CODE~=%DA_ONCE_CFUS THEN FLG='777777'O;
      403     5136    3         ELSE IF TYPE=%DA_CFUS_FILES THEN IF FM$CFU.FUN=0 THEN RETURN;
      404     5137    3         ELSE FLG='04'O;
      405     5138    3         RETURN;
      406     5139    3         END;
      407     5140    3      DO WHILE(I<CFUBLK.NSUBLKS);
      408     5141    3         P$=CFUBLK.SUBLK$(I);
      409     5142    4         DO CASE(P$->OBLK.CODE);
      410     5143    4         CASE(%DA_CFUS_FILES,%DA_CFUS_FILEL,%DA_CFUS_FDA);
      411     5144    4            IF TYPE~=%DA_CFUS_FILES THEN GOTO NO;
      412     5145    4            IF P$->OBLK.CODE=%DA_CFUS_FILES AND FM$CFU.FUN=0 THEN GOTO NO;
      413     5146    4            IF F$CFU$=A$ THEN S@=0;
      414     5147    4            ELSE S@=FM$CFUA.SETX;
      415     5148    4         CASE(ELSE);
      416     5149    4            IF TYPE~=P$->OBLK.CODE THEN GOTO NO;
      417     5150    4         END;
      418     5151    3         J=0;
      419     5152    4         DO WHILE(J<P$->OBLK.NSUBLKS);
      420     5153    4            Q$=P$->OBLK.SUBLK$(J);
      421     5154    5            DO CASE(Q$->OBLK.CODE);
      422     5155    5            CASE(0);
      423     5156    5               CALL CHARBIN(J,Q$->OSYM.TEXT);
      424     5157    5               IF J=FM$DEV.NN(D@) THEN GOTO OK;
      425     5158    5               ELSE GOTO NO;
      426     5159    5            CASE(%DA_FID_SET);
      427     5160    5               CALL DAA$WILDCOMP(Q$->OBLK.SUBLK$(0)->OSYM.COUNT,
      428     5161    5                 FM$SET.PSN(S@),6) ALTRET(NO);
      429     5162    5            CASE(%DA_FID_ACCT);
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:19   
      430     5163    5               CALL DAA$WILDCOMP(Q$->OBLK.SUBLK$(0)->OSYM.COUNT,
      431     5164    5                 FM$CFUA.ACCT,8) ALTRET(NO);
      432     5165    5            CASE(%DA_FID_NAME);
      433     5166    5               L=PINCRC(F$CFU$,D@)->FM$CFUN.L;
      434     5167    5               CALL DAA$WILDCOMP(Q$->OBLK.SUBLK$(0)->OSYM.COUNT,
      435     5168    5                 PINCRC(F$CFU$,D@)->FM$CFUN.C,L) ALTRET(NO);
      436     5169    5            END;
      437     5170    4            J=J+1;
      438     5171    4            END;
      439     5172    3   OK:;  FLG=FLG|'757777'O;
      440     5173    3         IF P$->OBLK.CODE=%DA_CFUS_FILEL THEN FLG.FIA='1'B;
      441     5174    3   NO:   I=I+1;
      442     5175    3         END;
      443     5176    2      RETURN;
      444     5177    2      END CHECK;
      445     5178    1   RETRET:;
      446     5179    1   END DAD$CFUS;

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:20   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DAD$CFUS.

   Procedure DAD$CFUS requires 1161 words for executable code.
   Procedure DAD$CFUS requires 314 words of local(AUTO) storage.

    No errors detected in file DAD$CFUS.:E05TSI    .

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:21   

 Object Unit name= DAD$CFUS                                   File name= DAD$CFUS.:E05TOU
 UTS= JUL 29 '97 12:39:48.40 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    54     66  DAD$CFUS
    2  RoData even  UTS    422    646  DAD$CFUS
    3   Proc  even  none  1161   2211  DAD$CFUS
    4  RoData even  none    47     57  DAD$CFUS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        1  DAD$CFUS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       5 DAM$MAP
 yes     yes           Std       3 DAA$WILDCOMP
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:22   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  DAF$WRITE                             B$DS1$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:23   


        1        1         /*M* DAD$CFUS - Display the CFU data segment for ANLZ */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        DAD$CFUS: PROC(CFUBLK);

      7  3 000000   000000 700200 xent  DAD$CFUS     TSX0  ! X66_AUTO_1
         3 000001   000472 000001                    ZERO    314,1

        8        8        %INCLUDE CP_6;
        9       89        %INCLUDE DA_FORMAT_C;
       10      331        %INCLUDE FM$MACROS;
       11      706        %INCLUDE DA_CMD_C;
       12     1055        %INCLUDE XU_MACRO_C;
       13     4161        %PARSE$OUT(STCLASS=,NAME=CFUBLK);
       14     4206        %PARSE$OUT(STCLASS=BASED,NAME=OBLK);
       15     4251        %PARSE$SYM(STCLASS=BASED,NAME=OSYM);
       16     4289    1   DCL DAA$WILDCOMP ENTRY(3) ALTRET;
       17     4290    1   DCL DAM$MAP ENTRY(5) ALTRET;
       18     4291    1   DCL DAF$INIT ENTRY(1) ALTRET;
       19     4292    1   DCL DAF$WRITE EPTR SYMREF;
       20     4293        %REPORT(NAME=CFU_REP,TITLEADR=DEV_TTL,HEADER=YES,WRAPTAB=18);
       21     4359        %HEADER(TEXTADR=DEV_HDR,LAST=NO);
       22     4401        %HEADER(TEXTADR=VOL_HDR,LAST=NO);
       23     4443        %HEADER(TEXT=
       24     4444       '--------------------------------------------------------------------------------');
       25     4486        %VLP_NAME(STCLASS=CONSTANT,FPTN=DEV_TTL,NAME=
       26     4487        'CFU AREA DISPLAYS');
       27     4514        %VLP_NAME(STCLASS=CONSTANT,FPTN=DEV_HDR,NAME=
       28     4515        'DEV:    NAME         VSN FLG  SYSID       NXTSDA');
       29     4542        %VLP_NAME(STCLASS=CONSTANT,FPTN=VOL_HDR,NAME=
       30     4543        'VOL:    SETX S#      VSN FLG  SYSID V#    NXTSDA DRZERO    RGRANS     GPSDA');
       31     4570        %VLP_NAME(STCLASS=CONSTANT,FPTN=SET_HDR,NAME=
       32     4571        'SET:    VOLX  PSN    FLAGS         CHD    NXTSDA    GACTIME     REALSN   CHKSUM');
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:24   
       33     4598        %VLP_NAME(STCLASS=CONSTANT,FPTN=ACT_HDR,NAME=
       34     4599        'CFUA:   SETX ACCOUNT     FDCSDA  FDFITSDA FLG CH ACCESS    AGE DFFLGS    RGRANS');
       35     4626        %VLP_NAME(STCLASS=CONSTANT,FPTN=FIL_HDR,NAME=
       36     4627        '  ADDR F S AMSAfit FITSDA     NRECS #US RSZ    UGRANS MCNT B      LDA    NGAVAL');
       37     4654        %VLP_NAME(STCLASS=CONSTANT,FPTN=SN_HDR,NAME=
       38     4655        '  SNS: LINKX SN0    SN1    SN2    SN3     SYSID   DCBX');
       39     4682        %VLP_NAME(STCLASS=CONSTANT,FPTN=UNU_HDR,NAME=
       40     4683        '  LOC:           CONTENTS');
       41     4710        %VLP_NAME(STCLASS=CONSTANT,FPTN=SUM_HDR,NAME=
       42     4711        '  DEVS  VOLS  SETS SYSID ACCTS FILES  XTNS  FDAS  FREE   SNS  LOST TOTAL NAMESZ');
       43     4738    1   DCL DEV_MSG CONSTANT CHAR(0) INIT(
       44     4739    1   ' %5O%2S  DP%2.18ZD   %9D %3.18MO%7.18D    %9ZO%S%S!');
       45     4740    1   DCL VOL_MSG CONSTANT CHAR(0) INIT(
       46     4741    1   ' %5O%2S%6.18O%3.9D%9.27D %3.18MO%7.18D%3.9D %9.27ZO%7D%4S %9+D %9ZO%S!');
       47     4742    1   DCL SET_MSG CONSTANT CHAR(0) INIT(
       48     4743    1   ' %5O%6.18O  %6A %6.18ZO%7.18D%4.9O %9.27ZO %14.0.2U%2S %6A%9D%S!');
       49     4744    1   DCL SID_MSG CONSTANT CHAR(0) INIT(
       50     4745    1   'Sysids (at%5O0)%18N.18N(%7.18&D%)%S%S!');
       51     4746    1   DCL AC_MSG CONSTANT CHAR(0) INIT(
       52     4747    1   '%5O0%6.18O%2S %8A %9ZO %9ZO %3.9ZO%3.9D %6.18ZO%7.18D %6.18ZO %9+*D%S!');
       53     4748    1   DCL FIA_MSG CONSTANT CHAR(0) INIT(
       54     4749        '%5O0%2.3D%2.2D%2.1D%1.1D%1.1D%1.1D %9.27O %9D%6S%4.18D%4.9D %9.27D%4S
       55     4750    1   %5.15D%2.1.1ND%9.27.1NO %9.27D%S!');
       56     4751    1   DCL FIL_MSG CONSTANT CHAR(0) INIT(
       57     4752    1   '%5O0%2.3D%2.2D%2.1D%1.1D%1.1D%1.1D %9.27O %9D%6S%4.18D%S %>A!');
       58     4753    1   DCL FDA_MSG CONSTANT CHAR(0) INIT(
       59     4754    1   '%5O0%17-%9ZO%S%30-%>A!');
       60     4755    1   DCL FID STATIC CHAR(52);
       61     4756    1   DCL JTAP_MSG CONSTANT CHAR(0) INIT(
       62     4757        /* The following curious-looking comment assists any would-be maintainer to
       63     4758           insure that JTAP_MSG occupies its last word completely, which it must. */
       64     4759        /***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-***-**/
       65     4760    1  '%2.4PDcb#=%0.9D%, Dctx=.%0.9O, Vol=%0.9D, Max=%0.9D, %2.6PBlkl=%0.18D, Sns@.%0.18O,
              4760         Prec#=%00D%/');
       66     4761    1   DCL JFIL_MSG CONSTANT CHAR(0) INIT(
       67     4762    1   '%2.5P%1N(Up,%)%1N.1N(Er,%)DmUs=%0.6D.%0.9O,Pg=.%0.18O%3P%30-%>A!');
       68     4763    1   DCL KEY_MSG CONSTANT CHAR(0) INIT(
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:25   
       69     4764    1   '%2.5PSlide=%.9D,GDA=%.27O%.15S%1N.1N(,Abld%)%1N(,Ubld%)%3P%30-%>A!');
       70     4765    1   DCL XTN_MSG CONSTANT CHAR(0) INIT(
       71     4766    1   'Extents @%5O0: %6N.30N(%12&ZO %)%S%S!');
       72     4767    1   DCL LNK_MSG CONSTANT CHAR(0) INIT(
       73     4768    1   '**** Bad blink in free chain %6O -> %6O');
       74     4769    1   DCL SN_MSG CONSTANT CHAR(0) INIT(
       75     4770    1   '%5O0%2S%6.18O%2P%18N.18N( %6A%)%41-%2.7P%7.18D%7.18O%S%S!');
       76     4771    1   DCL UNU_MSG CONSTANT CHAR(0) INIT(
       77     4772    1   '%5O0           %8(%12&ZO %)%S%S!');
       78     4773    1   DCL SUM_MSG CONSTANT CHAR(0) INIT('%13(%6D%)');
       79     4774    1   DCL B$DS1$ PTR SYMREF;
       80     4775    1   DCL F$ PTR;
       81     4776    1   DCL A$ PTR;
       82     4777    1   DCL A$SBIN REDEF A$ SBIN;
       83     4778    1   DCL D@ UBIN;
       84     4779    1   DCL S@ UBIN;
       85     4780    1   DCL X@ UBIN;
       86     4781    1   DCL 1 FLG,
       87     4782    1         2 DEV BIT(1),
       88     4783    1         2 SET BIT(1),
       89     4784    1         2 ACT BIT(1),
       90     4785    1         2 FIL BIT(1),
       91     4786    1         2 FIA BIT(1),
       92     4787    1         2 SNS BIT(1),
       93     4788    1         2 UNU BIT(1),
       94     4789    1         2 * BIT(29);
       95     4790    1   DCL TYPE UBIN;
       96     4791    1   DCL F$CFU$ PTR;
       97     4792    1   DCL 1 COUNTS,
       98     4793    1         2 DEV UBIN,
       99     4794    1         2 VOL UBIN,
      100     4795    1         2 SET UBIN,
      101     4796    1         2 SYSID UBIN,
      102     4797    1         2 ACCT UBIN,
      103     4798    1         2 FILE UBIN,
      104     4799    1         2 XTN UBIN,
      105     4800    1         2 FDA UBIN,
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:26   
      106     4801    1         2 FREE UBIN,
      107     4802    1         2 SN UBIN,
      108     4803    1         2 LOST UBIN,
      109     4804    1         2 TOTAL UBIN,
      110     4805    1         2 NAME UBIN;
      111     4806    1   DCL BITS(0:255) BIT(36);
      112     4807    1   DCL MASKS(0:31)BIT(36) CONSTANT INIT(
      113     4808    1   '4'O,'2'O,'1'O,'04'O,'02'O,'01'O,'004'O,'002'O,'001'O,
      114     4809    1   '0004'O,'0002'O,'0001'O,'00004'O,'00002'O,'00001'O,'000004'O,'000002'O,'000001'O,
      115     4810    1   '0000004'O,'0000002'O,'0000001'O,'00000004'O,'00000002'O,'00000001'O,
      116     4811    1   '000000004'O,'000000002'O,'000000001'O,
      117     4812    1   '0000000004'O,'0000000002'O,'0000000001'O,
      118     4813    1   '00000000004'O,'00000000002'O);
      119     4814        %FM$CFUX;
      120     4819        %FM$SET(BASED="BASED(F$CFU$)");
      121     4824        %FM$DEV(BASED="BASED(F$CFU$)");
      122     4830        %FM$VOL(BASED="BASED(F$CFU$)");
      123     4836        %FM$SETU;
      124     4839        %FM$CFUA(BASED="BASED(A$)");
      125     4845        %FM$CFUN;
      126     4848        %FM$CFU(BASED="BASED(F$)");
      127     4854        %FT$CFUSN(BASED="BASED(F$)");
      128     4857        %FM$CFUJ(BASED="BASED(F$)");
      129     4862    1   DCL CHAR80 BASED CHAR(80);
      130     4863        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:27   
      131     4864    1      BITS='0'B;

   4864  3 000002   000100 100400                    MLR     fill='000'O
         3 000003   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000004   200031 002000                    ADSC9   BITS,,AUTO               cn=0,n=1024

      132     4865    1      COUNTS='0'B;

   4865  3 000005   000100 100400                    MLR     fill='000'O
         3 000006   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         3 000007   200014 000064                    ADSC9   COUNTS,,AUTO             cn=0,n=52

      133     4866        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:28   
      134     4867    1      CFU_REPHD00.TXT$=ADDR(DEV_HDR);

   4867  3 000010   000000 236000 4                  LDQ     0
         3 000011   000010 756000 1                  STQ     CFU_REPHD00

      135     4868    1      CFU_REPHD01.TXT$=ADDR(VOL_HDR);

   4868  3 000012   000001 236000 4                  LDQ     1
         3 000013   000014 756000 1                  STQ     CFU_REPHD01

      136     4869    1      CFU_REPHD00.NXT$=ADDR(CFU_REPHD01);

   4869  3 000014   000002 236000 4                  LDQ     2
         3 000015   000013 756000 1                  STQ     CFU_REPHD00+3

      137     4870    1      CALL DAF$INIT(CFU_REP);

   4870  3 000016   000003 630400 4                  EPPR0   3
         3 000017   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000020   000000 701000 xent               TSX1    DAF$INIT
         3 000021   000000 011000                    NOP     0

      138     4871    1      CALL DAM$MAP(B$DS1$,F$CFU$) ALTRET(RETRET);

   4871  3 000022   200013 630500                    EPPR0   F$CFU$,,AUTO
         3 000023   200443 450500                    STP0    I+2,,AUTO
         3 000024   000004 236000 4                  LDQ     4
         3 000025   200442 756100                    STQ     I+1,,AUTO
         3 000026   200442 630500                    EPPR0   I+1,,AUTO
         3 000027   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000030   000000 701000 xent               TSX1    DAM$MAP
         3 000031   002210 702000 3                  TSX2    RETRET

      139     4872    1      TYPE=%DA_CFUS_DEVICE;

   4872  3 000032   000001 235007                    LDA     1,DL
         3 000033   200012 755100                    STA     TYPE,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:29   

      140     4873    1      D@=FM$CFUX.DSETH;

   4873  3 000034   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000035   000005 236100                    LDQ     5,,PR0
         3 000036   777777 376007                    ANQ     -1,DL
         3 000037   200006 756100                    STQ     D@,,AUTO

      141     4874    2      DO WHILE(D@~=0);

   4874  3 000040   000126 600000 3                  TZE     ENDDEV

      142     4875    2         CALL USED(D@)ALTRET(ENDDEV);

   4875  3 000041   200006 630500                    EPPR0   D@,,AUTO
         3 000042   200433 450500                    STP0    BITS+258,,AUTO
         3 000043   001571 701000 3                  TSX1    USED
         3 000044   000126 702000 3                  TSX2    ENDDEV

      143     4876    2         CALL CHECK;

   4876  3 000045   001725 701000 3                  TSX1    CHECK
         3 000046   000000 011000                    NOP     0

      144     4877    2         COUNTS.DEV=COUNTS.DEV+1;

   4877  3 000047   200014 235100                    LDA     COUNTS,,AUTO
         3 000050   000001 035007                    ADLA    1,DL
         3 000051   200014 755100                    STA     COUNTS,,AUTO

      145     4878    2         IF FLG.DEV THEN CALL FORMAT(DEV_MSG,D@);

   4878  3 000052   200011 234100                    SZN     FLG,,AUTO
         3 000053   000062 605000 3                  TPL     s:4879

   4878  3 000054   200006 630500                    EPPR0   D@,,AUTO
         3 000055   200440 450500                    STP0    Q$+1,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:30   
         3 000056   000005 236000 4                  LDQ     5
         3 000057   200437 756100                    STQ     P$+1,,AUTO
         3 000060   001652 701000 3                  TSX1    FORMAT
         3 000061   000000 011000                    NOP     0

      146     4879    2         S@=FM$DEV.SECTL(D@);

   4879  3 000062   200006 235100                    LDA     D@,,AUTO
         3 000063   000003 735000                    ALS     3
         3 000064   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000065   000005 236105                    LDQ     5,AL,PR0
         3 000066   777777 376007                    ANQ     -1,DL
         3 000067   200007 756100                    STQ     S@,,AUTO

      147     4880    3         DO WHILE(S@~=0);

   4880  3 000070   000117 600000 3                  TZE     NXTDEV

      148     4881    3            CALL USED(S@)ALTRET(NXTDEV);

   4881  3 000071   200007 630500                    EPPR0   S@,,AUTO
         3 000072   200433 450500                    STP0    BITS+258,,AUTO
         3 000073   001571 701000 3                  TSX1    USED
         3 000074   000117 702000 3                  TSX2    NXTDEV

      149     4882    3            COUNTS.VOL=COUNTS.VOL+1;

   4882  3 000075   200015 235100                    LDA     COUNTS+1,,AUTO
         3 000076   000001 035007                    ADLA    1,DL
         3 000077   200015 755100                    STA     COUNTS+1,,AUTO

      150     4883    3            IF FLG.DEV THEN CALL FORMAT(VOL_MSG,S@);

   4883  3 000100   200011 234100                    SZN     FLG,,AUTO
         3 000101   000110 605000 3                  TPL     s:4884

   4883  3 000102   200007 630500                    EPPR0   S@,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:31   
         3 000103   200440 450500                    STP0    Q$+1,,AUTO
         3 000104   000006 236000 4                  LDQ     6
         3 000105   200437 756100                    STQ     P$+1,,AUTO
         3 000106   001652 701000 3                  TSX1    FORMAT
         3 000107   000000 011000                    NOP     0

      151     4884    3            S@=FM$VOL.SECTL(S@);

   4884  3 000110   200007 235100                    LDA     S@,,AUTO
         3 000111   000003 735000                    ALS     3
         3 000112   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000113   000005 236105                    LDQ     5,AL,PR0
         3 000114   777777 376007                    ANQ     -1,DL
         3 000115   200007 756100                    STQ     S@,,AUTO

      152     4885    3            END;

   4885  3 000116   000071 601000 3                  TNZ     s:4881

      153     4886    2   NXTDEV: D@=FM$DEV.DEVL(D@);

   4886  3 000117   200006 235100       NXTDEV       LDA     D@,,AUTO
         3 000120   000003 735000                    ALS     3
         3 000121   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000122   000005 236105                    LDQ     5,AL,PR0
         3 000123   000022 772000                    QRL     18
         3 000124   200006 756100                    STQ     D@,,AUTO

      154     4887    2         END;

   4887  3 000125   000041 601000 3                  TNZ     s:4875

   4886  3 000126                       ENDDEV       null
      155     4888    1   ENDDEV:;
      156     4889    1      CFU_REPHD00.TXT$=ADDR(SET_HDR);

   4889  3 000126   000007 236000 4                  LDQ     7
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:32   
         3 000127   000010 756000 1                  STQ     CFU_REPHD00

      157     4890    1      CALL DAF$INIT(CFU_REP);

   4890  3 000130   000003 630400 4                  EPPR0   3
         3 000131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000132   000000 701000 xent               TSX1    DAF$INIT
         3 000133   000000 011000                    NOP     0

      158     4891    1      TYPE=%DA_CFUS_SET;

   4891  3 000134   000002 235007                    LDA     2,DL
         3 000135   200012 755100                    STA     TYPE,,AUTO

      159     4892    1      S@=FM$CFUX.SETH;

   4892  3 000136   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000137   000005 236100                    LDQ     5,,PR0
         3 000140   000022 772000                    QRL     18
         3 000141   200007 756100                    STQ     S@,,AUTO

      160     4893    2      DO WHILE(S@~=0);

   4893  3 000142   000322 600000 3                  TZE     ENDSET

      161     4894    2         CALL USED(S@)ALTRET(ENDSET);

   4894  3 000143   200007 630500                    EPPR0   S@,,AUTO
         3 000144   200433 450500                    STP0    BITS+258,,AUTO
         3 000145   001571 701000 3                  TSX1    USED
         3 000146   000322 702000 3                  TSX2    ENDSET

      162     4895    2         CALL CHECK;

   4895  3 000147   001725 701000 3                  TSX1    CHECK
         3 000150   000000 011000                    NOP     0

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:33   
      163     4896    2         COUNTS.SET=COUNTS.SET+1;

   4896  3 000151   200016 235100                    LDA     COUNTS+2,,AUTO
         3 000152   000001 035007                    ADLA    1,DL
         3 000153   200016 755100                    STA     COUNTS+2,,AUTO

      164     4897    2         IF FLG.SET THEN CALL FORMAT(SET_MSG,S@);

   4897  3 000154   200011 236100                    LDQ     FLG,,AUTO
         3 000155   200000 316003                    CANQ    65536,DU
         3 000156   000165 600000 3                  TZE     s:4898

   4897  3 000157   200007 630500                    EPPR0   S@,,AUTO
         3 000160   200440 450500                    STP0    Q$+1,,AUTO
         3 000161   000010 236000 4                  LDQ     8
         3 000162   200437 756100                    STQ     P$+1,,AUTO
         3 000163   001652 701000 3                  TSX1    FORMAT
         3 000164   000000 011000                    NOP     0

      165     4898    2         D@=FM$SET.DCTX(S@);

   4898  3 000165   200007 235100                    LDA     S@,,AUTO
         3 000166   000003 735000                    ALS     3
         3 000167   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000170   000000 236105                    LDQ     0,AL,PR0
         3 000171   000022 772000                    QRL     18
         3 000172   200006 756100                    STQ     D@,,AUTO

      166     4899    3         DO WHILE(D@~=0);

   4899  3 000173   000220 600000 3                  TZE     NXTSET1

      167     4900    3            CALL UNUSED(D@)ALTRET(NXTSET1);

   4900  3 000174   200006 630500                    EPPR0   D@,,AUTO
         3 000175   200433 450500                    STP0    BITS+258,,AUTO
         3 000176   001575 701000 3                  TSX1    UNUSED
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:34   
         3 000177   000220 702000 3                  TSX2    NXTSET1

      168     4901    3            IF FLG.SET THEN CALL FORMAT(VOL_MSG,D@);

   4901  3 000200   200011 236100                    LDQ     FLG,,AUTO
         3 000201   200000 316003                    CANQ    65536,DU
         3 000202   000211 600000 3                  TZE     s:4902

   4901  3 000203   200006 630500                    EPPR0   D@,,AUTO
         3 000204   200440 450500                    STP0    Q$+1,,AUTO
         3 000205   000006 236000 4                  LDQ     6
         3 000206   200437 756100                    STQ     P$+1,,AUTO
         3 000207   001652 701000 3                  TSX1    FORMAT
         3 000210   000000 011000                    NOP     0

      169     4902    3            D@=FM$VOL.VOLL(D@);

   4902  3 000211   200006 235100                    LDA     D@,,AUTO
         3 000212   000003 735000                    ALS     3
         3 000213   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000214   000005 236105                    LDQ     5,AL,PR0
         3 000215   000022 772000                    QRL     18
         3 000216   200006 756100                    STQ     D@,,AUTO

      170     4903    3            END;

   4903  3 000217   000174 601000 3                  TNZ     s:4900

   4900  3 000220                       NXTSET1      null
      171     4904    2   NXTSET1:;
      172     4905    2         X@=D@;

   4905  3 000220   200006 235100                    LDA     D@,,AUTO
         3 000221   200010 755100                    STA     X@,,AUTO

      173     4906    2         D@=FM$SET.SYSID(S@);

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:35   
   4906  3 000222   200007 236100                    LDQ     S@,,AUTO
         3 000223   000003 736000                    QLS     3
         3 000224   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000225   000002 236106                    LDQ     2,QL,PR0
         3 000226   777777 376007                    ANQ     -1,DL
         3 000227   200006 756100                    STQ     D@,,AUTO

      174     4907    3         IF NOT FM$SET.ONEU(S@) THEN DO WHILE(D@~=0);

   4907  3 000230   200007 235100                    LDA     S@,,AUTO
         3 000231   000003 735000                    ALS     3
         3 000232   000002 236105                    LDQ     2,AL,PR0
         3 000233   000001 316003                    CANQ    1,DU
         3 000234   000270 601000 3                  TNZ     NXTSET2

   4907  3 000235   200006 235100                    LDA     D@,,AUTO
         3 000236   000270 600000 3                  TZE     NXTSET2

      175     4908    3            CALL USEDX(D@)ALTRET(NXTSET2);

   4908  3 000237   200006 630500                    EPPR0   D@,,AUTO
         3 000240   200433 450500                    STP0    BITS+258,,AUTO
         3 000241   001535 701000 3                  TSX1    USEDX
         3 000242   000270 702000 3                  TSX2    NXTSET2

      176     4909    3            COUNTS.SYSID=COUNTS.SYSID+1;

   4909  3 000243   200017 235100                    LDA     COUNTS+3,,AUTO
         3 000244   000001 035007                    ADLA    1,DL
         3 000245   200017 755100                    STA     COUNTS+3,,AUTO

      177     4910    3            IF FLG.SET THEN CALL FORMAT(SID_MSG,D@/8);

   4910  3 000246   200011 236100                    LDQ     FLG,,AUTO
         3 000247   200000 316003                    CANQ    65536,DU
         3 000250   000262 600000 3                  TZE     s:4911

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:36   
   4910  3 000251   200006 236100                    LDQ     D@,,AUTO
         3 000252   000003 772000                    QRL     3
         3 000253   200462 756100                    STQ     I+17,,AUTO
         3 000254   200462 630500                    EPPR0   I+17,,AUTO
         3 000255   200440 450500                    STP0    Q$+1,,AUTO
         3 000256   000011 236000 4                  LDQ     9
         3 000257   200437 756100                    STQ     P$+1,,AUTO
         3 000260   001652 701000 3                  TSX1    FORMAT
         3 000261   000000 011000                    NOP     0

      178     4911    3            D@=PINCRW(F$CFU$,D@)->FM$SETU.LINKX;

   4911  3 000262   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000263   200006 720100                    LXL0    D@,,AUTO
         3 000264   000000 236110                    LDQ     0,X0,PR0
         3 000265   777777 376007                    ANQ     -1,DL
         3 000266   200006 756100                    STQ     D@,,AUTO

      179     4912    3            END;

   4912  3 000267   000237 601000 3                  TNZ     s:4908

   4911  3 000270                       NXTSET2      null
      180     4913    2   NXTSET2:;
      181     4914    2         D@=FM$SET.DCTX(S@);

   4914  3 000270   200007 235100                    LDA     S@,,AUTO
         3 000271   000003 735000                    ALS     3
         3 000272   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000273   000000 236105                    LDQ     0,AL,PR0
         3 000274   000022 772000                    QRL     18
         3 000275   200006 756100                    STQ     D@,,AUTO

      182     4915    3         DO WHILE(D@~=X@);

   4915  3 000276   200010 116100                    CMPQ    X@,,AUTO
         3 000277   000314 600000 3                  TZE     s:4919
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:37   

      183     4916    3            CALL USED(D@);

   4916  3 000300   200006 630500                    EPPR0   D@,,AUTO
         3 000301   200433 450500                    STP0    BITS+258,,AUTO
         3 000302   001571 701000 3                  TSX1    USED
         3 000303   000000 011000                    NOP     0

      184     4917    3            D@=FM$VOL.VOLL(D@);

   4917  3 000304   200006 235100                    LDA     D@,,AUTO
         3 000305   000003 735000                    ALS     3
         3 000306   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000307   000005 236105                    LDQ     5,AL,PR0
         3 000310   000022 772000                    QRL     18
         3 000311   200006 756100                    STQ     D@,,AUTO

      185     4918    3            END;

   4918  3 000312   200010 116100                    CMPQ    X@,,AUTO
         3 000313   000300 601000 3                  TNZ     s:4916

      186     4919    2         S@=FM$SET.SETL(S@);

   4919  3 000314   200007 235100                    LDA     S@,,AUTO
         3 000315   000003 735000                    ALS     3
         3 000316   000005 236105                    LDQ     5,AL,PR0
         3 000317   000022 772000                    QRL     18
         3 000320   200007 756100                    STQ     S@,,AUTO

      187     4920    2         END;

   4920  3 000321   000143 601000 3                  TNZ     s:4894

   4917  3 000322                       ENDSET       null
      188     4921    1   ENDSET:;
      189     4922        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:38   
      190     4923    1      CFU_REPHD00.TXT$=ADDR(ACT_HDR);

   4923  3 000322   000012 236000 4                  LDQ     10
         3 000323   000010 756000 1                  STQ     CFU_REPHD00

      191     4924    1      CFU_REPHD00.NXT$=ADDR(CFU_REPHD02);

   4924  3 000324   000013 236000 4                  LDQ     11
         3 000325   000013 756000 1                  STQ     CFU_REPHD00+3

      192     4925    1      CALL DAF$INIT(CFU_REP);

   4925  3 000326   000003 630400 4                  EPPR0   3
         3 000327   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000330   000000 701000 xent               TSX1    DAF$INIT
         3 000331   000000 011000                    NOP     0

      193     4926    1      TYPE=%DA_CFUS_ACCT;

   4926  3 000332   000003 235007                    LDA     3,DL
         3 000333   200012 755100                    STA     TYPE,,AUTO

      194     4927    1      D@=FM$CFUX.ACCTS;

   4927  3 000334   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000335   000000 236100                    LDQ     0,,PR0
         3 000336   777777 376007                    ANQ     -1,DL
         3 000337   200006 756100                    STQ     D@,,AUTO

      195     4928    2      DO WHILE(D@~=0);

   4928  3 000340   000403 600000 3                  TZE     ENDACT

      196     4929    2         CALL USEDX(D@) ALTRET(ENDACT);

   4929  3 000341   200006 630500                    EPPR0   D@,,AUTO
         3 000342   200433 450500                    STP0    BITS+258,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:39   
         3 000343   001535 701000 3                  TSX1    USEDX
         3 000344   000403 702000 3                  TSX2    ENDACT

      197     4930    2         A$=PINCRW(F$CFU$,D@);

   4930  3 000345   200006 236100                    LDQ     D@,,AUTO
         3 000346   000022 736000                    QLS     18
         3 000347   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 000350   200005 756100                    STQ     A$,,AUTO

      198     4931    2         S@=FM$CFUA.SETX;

   4931  3 000351   200005 470500                    LDP0    A$,,AUTO
         3 000352   000000 236100                    LDQ     0,,PR0
         3 000353   000022 772000                    QRL     18
         3 000354   200007 756100                    STQ     S@,,AUTO

      199     4932    2         CALL CHECK;

   4932  3 000355   001725 701000 3                  TSX1    CHECK
         3 000356   000000 011000                    NOP     0

      200     4933    2         COUNTS.ACCT=COUNTS.ACCT+1;

   4933  3 000357   200020 235100                    LDA     COUNTS+4,,AUTO
         3 000360   000001 035007                    ADLA    1,DL
         3 000361   200020 755100                    STA     COUNTS+4,,AUTO

      201     4934    2         IF FLG.ACT THEN CALL FORMAT(AC_MSG,D@/8);

   4934  3 000362   200011 236100                    LDQ     FLG,,AUTO
         3 000363   100000 316003                    CANQ    32768,DU
         3 000364   000376 600000 3                  TZE     s:4935

   4934  3 000365   200006 236100                    LDQ     D@,,AUTO
         3 000366   000003 772000                    QRL     3
         3 000367   200463 756100                    STQ     I+18,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:40   
         3 000370   200463 630500                    EPPR0   I+18,,AUTO
         3 000371   200440 450500                    STP0    Q$+1,,AUTO
         3 000372   000014 236000 4                  LDQ     12
         3 000373   200437 756100                    STQ     P$+1,,AUTO
         3 000374   001652 701000 3                  TSX1    FORMAT
         3 000375   000000 011000                    NOP     0

      202     4935    2         D@=FM$CFUA.LINKX;

   4935  3 000376   200005 470500                    LDP0    A$,,AUTO
         3 000377   000000 236100                    LDQ     0,,PR0
         3 000400   777777 376007                    ANQ     -1,DL
         3 000401   200006 756100                    STQ     D@,,AUTO

      203     4936    2         END;

   4936  3 000402   000341 601000 3                  TNZ     s:4929

   4934  3 000403                       ENDACT       null
      204     4937    1   ENDACT:;
      205     4938        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:41   
      206     4939    1      CFU_REPHD00.TXT$=ADDR(FIL_HDR);

   4939  3 000403   000015 236000 4                  LDQ     13
         3 000404   000010 756000 1                  STQ     CFU_REPHD00

      207     4940    1      CALL DAF$INIT(CFU_REP);

   4940  3 000405   000003 630400 4                  EPPR0   3
         3 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000407   000000 701000 xent               TSX1    DAF$INIT
         3 000410   000000 011000                    NOP     0

      208     4941    1      TYPE=%DA_CFUS_FILES;

   4941  3 000411   000004 235007                    LDA     4,DL
         3 000412   200012 755100                    STA     TYPE,,AUTO

      209     4942    1      D@=FM$CFUX.NAMES;

   4942  3 000413   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000414   000001 236100                    LDQ     1,,PR0
         3 000415   777777 376007                    ANQ     -1,DL
         3 000416   200006 756100                    STQ     D@,,AUTO

      210     4943    2      DO WHILE(D@<FM$CFUX.NAMEX);

   4943  3 000417   000002 236100                    LDQ     2,,PR0
         3 000420   777777 376007                    ANQ     -1,DL
         3 000421   200006 116100                    CMPQ    D@,,AUTO
         3 000422   000775 602000 3                  TNC     s:4994
         3 000423   000775 600000 3                  TZE     s:4994

      211     4944    2         X@=PINCRC(F$CFU$,D@)->FM$CFUN.LNKX;

   4944  3 000424   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000425   200006 235100                    LDA     D@,,AUTO
         3 000426   000100 101505                    MRL     fill='000'O
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:42   
         3 000427   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         3 000430   200010 000004                    ADSC9   X@,,AUTO                 cn=0,n=4

      212     4945    3         DO WHILE(X@<FM$CFUX.CFUT);

   4945  3 000431   000002 236100                    LDQ     2,,PR0
         3 000432   000022 772000                    QRL     18
         3 000433   200010 116100                    CMPQ    X@,,AUTO
         3 000434   000755 602000 3                  TNC     NXTNAM
         3 000435   000755 600000 3                  TZE     NXTNAM

      213     4946    3            CALL USEDX(X@) ALTRET(NXTNAM);

   4946  3 000436   200010 630500                    EPPR0   X@,,AUTO
         3 000437   200433 450500                    STP0    BITS+258,,AUTO
         3 000440   001535 701000 3                  TSX1    USEDX
         3 000441   000755 702000 3                  TSX2    NXTNAM

      214     4947    3            F$=PINCRW(F$CFU$,X@);

   4947  3 000442   200010 236100                    LDQ     X@,,AUTO
         3 000443   000022 736000                    QLS     18
         3 000444   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 000445   200004 756100                    STQ     F$,,AUTO

      215     4948    3            A$=PINCRW(F$CFU$,FM$CFU.ACCTX);

   4948  3 000446   200004 470500                    LDP0    F$,,AUTO
         3 000447   000002 220100                    LDX0    2,,PR0
         3 000450   000000 636010                    EAQ     0,X0
         3 000451   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 000452   200005 756100                    STQ     A$,,AUTO

      216     4949    4   FILEOUT: IF A$SBIN<0 THEN DO;

   4949  3 000453   200005 235100       FILEOUT      LDA     A$,,AUTO
         3 000454   000475 605000 3                  TPL     s:4955
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:43   

      217     4950    4               FID='Sysid=';

   4950  3 000455   040000 100400                    MLR     fill='040'O
         3 000456   000640 000006 2                  ADSC9   MPLX_MSG+10              cn=0,n=6
         3 000457   000051 000064 1                  ADSC9   FID                      cn=0,n=52

      218     4951    4               S@=FM$CFU.STARX.SYSID;

   4951  3 000460   200004 470500                    LDP0    F$,,AUTO
         3 000461   000002 236100                    LDQ     2,,PR0
         3 000462   000022 772000                    QRL     18
         3 000463   377777 376007                    ANQ     131071,DL
         3 000464   200007 756100                    STQ     S@,,AUTO

      219     4952    4               CALL BINCHAR(SUBSTR(FID,6,6),S@);

   4952  3 000465   000000 235003                    LDA     0,DU
         3 000466   200442 757100                    STAQ    I+1,,AUTO
         3 000467   000000 301500                    BTD
         3 000470   200442 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         3 000471   000052 430006 1                  NDSC9   FID+1                    cn=2,s=nosgn,sf=0,n=6

      220     4953    4               A$=F$CFU$;

   4953  3 000472   200013 236100                    LDQ     F$CFU$,,AUTO
         3 000473   200005 756100                    STQ     A$,,AUTO

      221     4954    4               END;

   4954  3 000474   000547 710000 3                  TRA     s:4961

      222     4955    3            ELSE IF A$=F$CFU$ THEN FID='Scratch';

   4955  3 000475   200005 236100                    LDQ     A$,,AUTO
         3 000476   200013 116100                    CMPQ    F$CFU$,,AUTO
         3 000477   000504 601000 3                  TNZ     s:4957
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:44   

   4955  3 000500   040000 100400                    MLR     fill='040'O
         3 000501   000642 000007 2                  ADSC9   MPLX_MSG+12              cn=0,n=7
         3 000502   000051 000064 1                  ADSC9   FID                      cn=0,n=52
         3 000503   000547 710000 3                  TRA     s:4961

      223     4956    4            ELSE DO;

      224     4957    4               CALL CONCAT(FID,'DP#',FM$SET.PSN(FM$CFUA.SETX));

   4957  3 000504   200005 470500                    LDP0    A$,,AUTO
         3 000505   000000 236100                    LDQ     0,,PR0
         3 000506   000017 772000                    QRL     15
         3 000507   000016 376000 4                  ANQ     14
         3 000510   000000 620006                    EAX0    0,QL
         3 000511   000644 236000 2                  LDQ     MPLX_MSG+14
         3 000512   000017 376000 4                  ANQ     15
         3 000513   000040 276007                    ORQ     32,DL
         3 000514   000051 756000 1                  STQ     FID
         3 000515   000000 635010                    EAA     0,X0
         3 000516   000020 771000                    ARL     16
         3 000517   200013 471500                    LDP1    F$CFU$,,AUTO
         3 000520   040000 100505                    MLR     fill='040'O
         3 000521   100000 400006                    ADSC9   0,A,PR1                  cn=2,n=6
         3 000522   000051 600061 1                  ADSC9   FID                      cn=3,n=49

      225     4958    4               CALL INDEX(S@,' ',FID);

   4958  3 000523   000000 124400                    SCM     mask='000'O
         3 000524   000051 000064 1                  ADSC9   FID                      cn=0,n=52
         3 000525   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000526   200007 000100                    ARG     S@,,AUTO

      226     4959    4               CALL INSERT(FID,S@,,'.',FM$CFUA.ACCT);

   4959  3 000527   200007 720100                    LXL0    S@,,AUTO
         3 000530   777713 620010                    EAX0    -53,X0
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:45   
         3 000531   777777 660003                    ERX0    -1,DU
         3 000532   200007 235100                    LDA     S@,,AUTO
         3 000533   040045 100400                    MLR     fill='040'O
         3 000534   000020 000001 4                  ADSC9   16                       cn=0,n=1
         3 000535   000051 000010 1                  ADSC9   FID,A                    cn=0,n=*X0
         3 000536   200007 236100                    LDQ     S@,,AUTO
         3 000537   000063 116007                    CMPQ    51,DL
         3 000540   000547 603000 3                  TRC     s:4961
         3 000541   777714 621006                    EAX1    -52,QL
         3 000542   777777 661003                    ERX1    -1,DU
         3 000543   200005 470500                    LDP0    A$,,AUTO
         3 000544   040046 100500                    MLR     fill='040'O
         3 000545   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         3 000546   000051 200011 1                  ADSC9   FID,Q                    cn=1,n=*X1

      227     4960    4               END;

      228     4961    3            CALL INDEX(S@,' ',FID);

   4961  3 000547   000000 124400                    SCM     mask='000'O
         3 000550   000051 000064 1                  ADSC9   FID                      cn=0,n=52
         3 000551   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000552   200007 000100                    ARG     S@,,AUTO

      229     4962    3            CALL INSERT(FID,S@,32,'/',PINCRC(F$CFU$,D@)->FM$CFUN.C);

   4962  3 000553   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000554   200006 235100                    LDA     D@,,AUTO
         3 000555   000100 101505                    MRL     fill='000'O
         3 000556   000000 400001                    ADSC9   0,A,PR0                  cn=2,n=1
         3 000557   200442 000002                    ADSC9   I+1,,AUTO                cn=0,n=2
         3 000560   200442 220100                    LDX0    I+1,,AUTO
         3 000561   200007 236100                    LDQ     S@,,AUTO
         3 000562   040006 100400                    MLR     fill='040'O
         3 000563   000021 000001 4                  ADSC9   17                       cn=0,n=1
         3 000564   000051 000001 1                  ADSC9   FID,Q                    cn=0,n=1
         3 000565   040006 100545                    MLR     fill='040'O
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:46   
         3 000566   000000 600010                    ADSC9   0,A,PR0                  cn=3,n=*X0
         3 000567   000051 200037 1                  ADSC9   FID,Q                    cn=1,n=31

      230     4963    3            CALL CHECK;

   4963  3 000570   001725 701000 3                  TSX1    CHECK
         3 000571   000000 011000                    NOP     0

      231     4964    4            IF FM$CFU.FUN=0 THEN DO;

   4964  3 000572   200004 470500                    LDP0    F$,,AUTO
         3 000573   000000 236100                    LDQ     0,,PR0
         3 000574   700000 316003                    CANQ    -32768,DU
         3 000575   000615 601000 3                  TNZ     s:4969

      232     4965    4               IF FLG THEN CALL FORMAT(FDA_MSG,X@/8);

   4965  3 000576   200011 235100                    LDA     FLG,,AUTO
         3 000577   000611 600000 3                  TZE     s:4966

   4965  3 000600   200010 236100                    LDQ     X@,,AUTO
         3 000601   000003 772000                    QRL     3
         3 000602   200464 756100                    STQ     I+19,,AUTO
         3 000603   200464 631500                    EPPR1   I+19,,AUTO
         3 000604   200440 451500                    STP1    Q$+1,,AUTO
         3 000605   000022 236000 4                  LDQ     18
         3 000606   200437 756100                    STQ     P$+1,,AUTO
         3 000607   001652 701000 3                  TSX1    FORMAT
         3 000610   000000 011000                    NOP     0

      233     4966    4               COUNTS.FDA=COUNTS.FDA+1;

   4966  3 000611   200023 235100                    LDA     COUNTS+7,,AUTO
         3 000612   000001 035007                    ADLA    1,DL
         3 000613   200023 755100                    STA     COUNTS+7,,AUTO

      234     4967    4               END;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:47   

   4967  3 000614   000701 710000 3                  TRA     s:4979

      235     4968    4            ELSE DO;

      236     4969    5               IF FLG.FIA THEN DO;

   4969  3 000615   200011 236100                    LDQ     FLG,,AUTO
         3 000616   020000 316003                    CANQ    8192,DU
         3 000617   000663 600000 3                  TZE     s:4976

      237     4970    5                  CALL FORMAT(FIA_MSG,X@/8);

   4970  3 000620   200010 236100                    LDQ     X@,,AUTO
         3 000621   000003 772000                    QRL     3
         3 000622   200465 756100                    STQ     I+20,,AUTO
         3 000623   200465 631500                    EPPR1   I+20,,AUTO
         3 000624   200440 451500                    STP1    Q$+1,,AUTO
         3 000625   000023 236000 4                  LDQ     19
         3 000626   200437 756100                    STQ     P$+1,,AUTO
         3 000627   001652 701000 3                  TSX1    FORMAT
         3 000630   000000 011000                    NOP     0

      238     4971    5                  IF FM$CFU.FUN~=4 THEN A$=ADDR(KEY_MSG);

   4971  3 000631   200004 470500                    LDP0    F$,,AUTO
         3 000632   000000 236100                    LDQ     0,,PR0
         3 000633   700000 376003                    ANQ     -32768,DU
         3 000634   400000 116003                    CMPQ    -131072,DU
         3 000635   000641 600000 3                  TZE     s:4972

   4971  3 000636   000024 236000 4                  LDQ     20
         3 000637   200005 756100                    STQ     A$,,AUTO
         3 000640   000651 710000 3                  TRA     s:4974

      239     4972    5                  ELSE IF FM$CFUJ.TAPE THEN A$=ADDR(JTAP_MSG);

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:48   
   4972  3 000641   000005 236100                    LDQ     5,,PR0
         3 000642   100000 316003                    CANQ    32768,DU
         3 000643   000647 600000 3                  TZE     s:4973

   4972  3 000644   000025 236000 4                  LDQ     21
         3 000645   200005 756100                    STQ     A$,,AUTO
         3 000646   000651 710000 3                  TRA     s:4974

      240     4973    5                  ELSE A$=ADDR(JFIL_MSG);

   4973  3 000647   000026 236000 4                  LDQ     22
         3 000650   200005 756100                    STQ     A$,,AUTO

      241     4974    5                  CALL FORMAT(A$->CHAR80,X@/8);

   4974  3 000651   200010 236100                    LDQ     X@,,AUTO
         3 000652   000003 772000                    QRL     3
         3 000653   200466 756100                    STQ     I+21,,AUTO
         3 000654   200466 631500                    EPPR1   I+21,,AUTO
         3 000655   200440 451500                    STP1    Q$+1,,AUTO
         3 000656   200005 236100                    LDQ     A$,,AUTO
         3 000657   200437 756100                    STQ     P$+1,,AUTO
         3 000660   001652 701000 3                  TSX1    FORMAT
         3 000661   000000 011000                    NOP     0

      242     4975    5                  END;

   4975  3 000662   000676 710000 3                  TRA     s:4977

      243     4976    4               ELSE IF FLG THEN CALL FORMAT(FIL_MSG,X@/8);

   4976  3 000663   000000 116003                    CMPQ    0,DU
         3 000664   000676 600000 3                  TZE     s:4977

   4976  3 000665   200010 236100                    LDQ     X@,,AUTO
         3 000666   000003 772000                    QRL     3
         3 000667   200467 756100                    STQ     I+22,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:49   
         3 000670   200467 631500                    EPPR1   I+22,,AUTO
         3 000671   200440 451500                    STP1    Q$+1,,AUTO
         3 000672   000027 236000 4                  LDQ     23
         3 000673   200437 756100                    STQ     P$+1,,AUTO
         3 000674   001652 701000 3                  TSX1    FORMAT
         3 000675   000000 011000                    NOP     0

      244     4977    4               COUNTS.FILE=COUNTS.FILE+1;

   4977  3 000676   200021 235100                    LDA     COUNTS+5,,AUTO
         3 000677   000001 035007                    ADLA    1,DL
         3 000700   200021 755100                    STA     COUNTS+5,,AUTO

      245     4978    4               END;

      246     4979    3            S@=FM$CFU.XTX;

   4979  3 000701   200004 470500                    LDP0    F$,,AUTO
         3 000702   000003 236100                    LDQ     3,,PR0
         3 000703   000022 772000                    QRL     18
         3 000704   200007 756100                    STQ     S@,,AUTO

      247     4980    4            DO WHILE(S@>1);

   4980  3 000705   000002 116007                    CMPQ    2,DL
         3 000706   000741 602000 3                  TNC     NXTFIL

      248     4981    4               CALL USEDX(S@) ALTRET(NXTFIL);

   4981  3 000707   200007 630500                    EPPR0   S@,,AUTO
         3 000710   200433 450500                    STP0    BITS+258,,AUTO
         3 000711   001535 701000 3                  TSX1    USEDX
         3 000712   000741 702000 3                  TSX2    NXTFIL

      249     4982    4               COUNTS.XTN=COUNTS.XTN+1;

   4982  3 000713   200022 235100                    LDA     COUNTS+6,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:50   
         3 000714   000001 035007                    ADLA    1,DL
         3 000715   200022 755100                    STA     COUNTS+6,,AUTO

      250     4983    4               IF FLG.FIA THEN CALL FORMAT(XTN_MSG,S@/8);

   4983  3 000716   200011 236100                    LDQ     FLG,,AUTO
         3 000717   020000 316003                    CANQ    8192,DU
         3 000720   000732 600000 3                  TZE     s:4984

   4983  3 000721   200007 236100                    LDQ     S@,,AUTO
         3 000722   000003 772000                    QRL     3
         3 000723   200470 756100                    STQ     I+23,,AUTO
         3 000724   200470 630500                    EPPR0   I+23,,AUTO
         3 000725   200440 450500                    STP0    Q$+1,,AUTO
         3 000726   000030 236000 4                  LDQ     24
         3 000727   200437 756100                    STQ     P$+1,,AUTO
         3 000730   001652 701000 3                  TSX1    FORMAT
         3 000731   000000 011000                    NOP     0

      251     4984    4               S@=PINCRW(F$CFU$,S@)->FM$CFUA.LINKX;

   4984  3 000732   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000733   200007 720100                    LXL0    S@,,AUTO
         3 000734   000000 236110                    LDQ     0,X0,PR0
         3 000735   777777 376007                    ANQ     -1,DL
         3 000736   200007 756100                    STQ     S@,,AUTO

      252     4985    4               END;

   4985  3 000737   000002 116007                    CMPQ    2,DL
         3 000740   000707 603000 3                  TRC     s:4981

      253     4986    3   NXTFIL:;

   4986  3 000741                       NXTFIL       null
      254     4987    3            IF COUNTS.TOTAL~=0 THEN GOTO NXTFREE;

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:51   
   4987  3 000741   200027 235100                    LDA     COUNTS+11,,AUTO
         3 000742   001231 601000 3                  TNZ     s:5032

      255     4988    3            X@=FM$CFU.NAMEX;

   4988  3 000743   200004 470500                    LDP0    F$,,AUTO
         3 000744   000002 236100                    LDQ     2,,PR0
         3 000745   777777 376007                    ANQ     -1,DL
         3 000746   200010 756100                    STQ     X@,,AUTO

      256     4989    3            END;

   4989  3 000747   200013 471500                    LDP1    F$CFU$,,AUTO
         3 000750   100002 236100                    LDQ     2,,PR1
         3 000751   000022 772000                    QRL     18
         3 000752   200010 116100                    CMPQ    X@,,AUTO
         3 000753   000755 600000 3                  TZE     NXTNAM
         3 000754   000436 603000 3                  TRC     s:4946

   4985  3 000755                       NXTNAM       null
      257     4990    2   NXTNAM:;
      258     4991    2         D@=D@+SIZEC(PINCRC(F$CFU$,D@)->FM$CFUN);

   4991  3 000755   200013 470500                    LDP0    F$CFU$,,AUTO
         3 000756   200006 235100                    LDA     D@,,AUTO
         3 000757   000100 101505                    MRL     fill='000'O
         3 000760   000000 400001                    ADSC9   0,A,PR0                  cn=2,n=1
         3 000761   200442 000002                    ADSC9   I+1,,AUTO                cn=0,n=2
         3 000762   200442 220100                    LDX0    I+1,,AUTO
         3 000763   000003 621010                    EAX1    3,X0
         3 000764   000000 636011                    EAQ     0,X1
         3 000765   000022 772000                    QRL     18
         3 000766   200006 036100                    ADLQ    D@,,AUTO
         3 000767   200006 756100                    STQ     D@,,AUTO

      259     4992    2         END;

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:52   
   4992  3 000770   000002 236100                    LDQ     2,,PR0
         3 000771   777777 376007                    ANQ     -1,DL
         3 000772   200006 116100                    CMPQ    D@,,AUTO
         3 000773   000775 600000 3                  TZE     s:4994
         3 000774   000424 603000 3                  TRC     s:4944

      260     4993        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:53   
      261     4994    1      COUNTS.TOTAL=FM$CFUX.CFUT/8;

   4994  3 000775   000002 236100                    LDQ     2,,PR0
         3 000776   000022 772000                    QRL     18
         3 000777   000003 772000                    QRL     3
         3 001000   200027 756100                    STQ     COUNTS+11,,AUTO

      262     4995    1      S@=0;

   4995  3 001001   200007 450100                    STZ     S@,,AUTO

      263     4996    1      D@=FM$CFUX.HEAD;

   4996  3 001002   000007 236100                    LDQ     7,,PR0
         3 001003   777777 376007                    ANQ     -1,DL
         3 001004   200006 756100                    STQ     D@,,AUTO

      264     4997    2      DO WHILE(D@~=0);

   4997  3 001005   001120 600000 3                  TZE     s:5013

      265     4998    2         IF D@>=FM$CFUX.CFUT THEN F$=F$CFU$;

   4998  3 001006   200013 470500                    LDP0    F$CFU$,,AUTO
         3 001007   000002 236100                    LDQ     2,,PR0
         3 001010   000022 772000                    QRL     18
         3 001011   200006 116100                    CMPQ    D@,,AUTO
         3 001012   001014 600000 3                  TZE     s:4998+6
         3 001013   001017 603000 3                  TRC     s:4999

   4998  3 001014   200013 236100                    LDQ     F$CFU$,,AUTO
         3 001015   200004 756100                    STQ     F$,,AUTO
         3 001016   001023 710000 3                  TRA     s:5000

      266     4999    2         ELSE F$=PINCRW(F$CFU$,D@);

   4999  3 001017   200006 236100                    LDQ     D@,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:54   
         3 001020   000022 736000                    QLS     18
         3 001021   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 001022   200004 756100                    STQ     F$,,AUTO

      267     5000    2         IF F$=F$CFU$ OR FM$CFU.NAMEX=0 THEN CALL USEDX(D@) ALTRET(SNS);

   5000  3 001023   200013 116100                    CMPQ    F$CFU$,,AUTO
         3 001024   001030 600000 3                  TZE     s:5000+5
         3 001025   200004 471500                    LDP1    F$,,AUTO
         3 001026   100002 720100                    LXL0    2,,PR1
         3 001027   001035 601000 3                  TNZ     s:5002

   5000  3 001030   200006 631500                    EPPR1   D@,,AUTO
         3 001031   200433 451500                    STP1    BITS+258,,AUTO
         3 001032   001535 701000 3                  TSX1    USEDX
         3 001033   001246 702000 3                  TSX2    SNS
         3 001034   001050 710000 3                  TRA     s:5005

      268     5001    3         ELSE DO;

      269     5002    3            CALL UNUSED(D@/8) ALTRET(SNS);

   5002  3 001035   200006 236100                    LDQ     D@,,AUTO
         3 001036   000003 772000                    QRL     3
         3 001037   200471 756100                    STQ     I+24,,AUTO
         3 001040   200471 633500                    EPPR3   I+24,,AUTO
         3 001041   200433 453500                    STP3    BITS+258,,AUTO
         3 001042   001575 701000 3                  TSX1    UNUSED
         3 001043   001246 702000 3                  TSX2    SNS

      270     5003    3            CALL USEDX(D@) ALTRET(SNS);

   5003  3 001044   200006 630500                    EPPR0   D@,,AUTO
         3 001045   200433 450500                    STP0    BITS+258,,AUTO
         3 001046   001535 701000 3                  TSX1    USEDX
         3 001047   001246 702000 3                  TSX2    SNS

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:55   
      271     5004    3            END;

      272     5005    2         COUNTS.FREE=COUNTS.FREE+1;

   5005  3 001050   200024 235100                    LDA     COUNTS+8,,AUTO
         3 001051   000001 035007                    ADLA    1,DL
         3 001052   200024 755100                    STA     COUNTS+8,,AUTO

      273     5006    3         IF F$->FM$CFUX.TAIL~=S@ THEN DO;

   5006  3 001053   200004 470500                    LDP0    F$,,AUTO
         3 001054   000007 236100                    LDQ     7,,PR0
         3 001055   000022 772000                    QRL     18
         3 001056   200007 116100                    CMPQ    S@,,AUTO
         3 001057   001112 600000 3                  TZE     s:5010

      274     5007    3            CALL DAF$WRITE(VECTOR(LNK_MSG),VECTOR(S@),VECTOR(D@));

   5007  3 001060   777640 235007                    LDA     -96,DL
         3 001061   200442 452500                    STP2    I+1,,AUTO
         3 001062   200442 236100                    LDQ     I+1,,AUTO
         3 001063   000007 036003                    ADLQ    7,DU
         3 001064   200444 757100                    STAQ    I+3,,AUTO
         3 001065   777640 235007                    LDA     -96,DL
         3 001066   200446 452500                    STP2    I+5,,AUTO
         3 001067   200446 236100                    LDQ     I+5,,AUTO
         3 001070   000006 036003                    ADLQ    6,DU
         3 001071   200452 757100                    STAQ    I+9,,AUTO
         3 001072   200444 237100                    LDAQ    I+3,,AUTO
         3 001073   200450 757100                    STAQ    I+7,,AUTO
         3 001074   200452 237100                    LDAQ    I+9,,AUTO
         3 001075   200454 757100                    STAQ    I+11,,AUTO
         3 001076   200454 631500                    EPPR1   I+11,,AUTO
         3 001077   200460 451500                    STP1    I+15,,AUTO
         3 001100   200450 633500                    EPPR3   I+7,,AUTO
         3 001101   200457 453500                    STP3    I+14,,AUTO
         3 001102   000034 236000 4                  LDQ     28
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:56   
         3 001103   200456 756100                    STQ     I+13,,AUTO
         3 001104   200456 630500                    EPPR0   I+13,,AUTO
         3 001105   000000 220000 xsym               LDX0    DAF$WRITE
         3 001106   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 001107   000000 701010                    TSX1    0,X0
         3 001110   000000 011000                    NOP     0

      275     5008    3            GOTO SNS;

   5008  3 001111   001246 710000 3                  TRA     SNS

      276     5009    3            END;
      277     5010    2         S@=D@;

   5010  3 001112   200006 235100                    LDA     D@,,AUTO
         3 001113   200007 755100                    STA     S@,,AUTO

      278     5011    2         D@=F$->FM$CFUX.HEAD;

   5011  3 001114   000007 236100                    LDQ     7,,PR0
         3 001115   777777 376007                    ANQ     -1,DL
         3 001116   200006 756100                    STQ     D@,,AUTO

      279     5012    2         END;

   5012  3 001117   001006 601000 3                  TNZ     s:4998

      280     5013    1      X@=0;

   5013  3 001120   200010 450100                    STZ     X@,,AUTO

      281     5014    2      DO WHILE(X@<FM$CFUX.CFUT/8);

   5014  3 001121   001237 710000 3                  TRA     s:5035

      282     5015    2         IF BITS(X@/32)='777777777760'O THEN  X@=X@/32*32+31;

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:57   
   5015  3 001122   200010 236100                    LDQ     X@,,AUTO
         3 001123   000005 772000                    QRL     5
         3 001124   200031 236106                    LDQ     BITS,QL,AUTO
         3 001125   000645 116000 2                  CMPQ    MPLX_MSG+15
         3 001126   001135 601000 3                  TNZ     s:5016

   5015  3 001127   200010 236100                    LDQ     X@,,AUTO
         3 001130   000005 772000                    QRL     5
         3 001131   000005 736000                    QLS     5
         3 001132   000037 036007                    ADLQ    31,DL
         3 001133   200010 756100                    STQ     X@,,AUTO
         3 001134   001234 710000 3                  TRA     s:5034

      283     5016    3         ELSE IF NOT BITS(X@/32)&MASKS(MOD(X@,32)) THEN DO;

   5016  3 001135   200010 236100                    LDQ     X@,,AUTO
         3 001136   000005 772000                    QRL     5
         3 001137   200442 756100                    STQ     I+1,,AUTO
         3 001140   200010 236100                    LDQ     X@,,AUTO
         3 001141   000037 376007                    ANQ     31,DL
         3 001142   000000 620006                    EAX0    0,QL
         3 001143   200442 721100                    LXL1    I+1,,AUTO
         3 001144   200031 236111                    LDQ     BITS,X1,AUTO
         3 001145   000554 376010 2                  ANQ     MASKS,X0
         3 001146   001234 601000 3                  TNZ     s:5034

      284     5017    3            X@=X@*8;

   5017  3 001147   200010 235100                    LDA     X@,,AUTO
         3 001150   000003 735000                    ALS     3
         3 001151   200010 755100                    STA     X@,,AUTO

      285     5018    3            F$=PINCRW(F$CFU$,X@);

   5018  3 001152   200010 236100                    LDQ     X@,,AUTO
         3 001153   000022 736000                    QLS     18
         3 001154   200013 036100                    ADLQ    F$CFU$,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:58   
         3 001155   200004 756100                    STQ     F$,,AUTO

      286     5019    4            IF FM$CFU.FUN~=0 AND FM$CFU.ACCTX=0 THEN DO;

   5019  3 001156   200004 470500                    LDP0    F$,,AUTO
         3 001157   000000 236100                    LDQ     0,,PR0
         3 001160   700000 316003                    CANQ    -32768,DU
         3 001161   001231 600000 3                  TZE     s:5032
         3 001162   000002 220100                    LDX0    2,,PR0
         3 001163   001231 601000 3                  TNZ     s:5032

      287     5020    4               D@=FM$CFU.NAMEX;

   5020  3 001164   000002 236100                    LDQ     2,,PR0
         3 001165   777777 376007                    ANQ     -1,DL
         3 001166   200006 756100                    STQ     D@,,AUTO

      288     5021    4               A$=PINCRW(F$CFU$,PINCRW(F$CFU$,D@)->FM$CFU.ACCTX);

   5021  3 001167   200013 471500                    LDP1    F$CFU$,,AUTO
         3 001170   100002 220106                    LDX0    2,QL,PR1
         3 001171   000000 636010                    EAQ     0,X0
         3 001172   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 001173   200005 756100                    STQ     A$,,AUTO

      289     5022    5               IF D@=0 THEN DO;

   5022  3 001174   200006 235100                    LDA     D@,,AUTO
         3 001175   001205 601000 3                  TNZ     s:5026

      290     5023    5                  D@=X@*4+8;

   5023  3 001176   200010 235100                    LDA     X@,,AUTO
         3 001177   000002 735000                    ALS     2
         3 001200   000010 035007                    ADLA    8,DL
         3 001201   200006 755100                    STA     D@,,AUTO

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:59   
      291     5024    5                  A$=F$CFU$;

   5024  3 001202   200013 236100                    LDQ     F$CFU$,,AUTO
         3 001203   200005 756100                    STQ     A$,,AUTO

      292     5025    5                  END;

   5025  3 001204   001224 710000 3                  TRA     s:5029

      293     5026    5               ELSE DO WHILE(D@<FM$CFUX.CFUT);

   5026  3 001205   100002 236100                    LDQ     2,,PR1
         3 001206   000022 772000                    QRL     18
         3 001207   200006 116100                    CMPQ    D@,,AUTO
         3 001210   001224 602000 3                  TNC     s:5029
         3 001211   001224 600000 3                  TZE     s:5029

      294     5027    5                  D@=PINCRW(F$CFU$,D@)->FM$CFU.NAMEX;

   5027  3 001212   200013 470500                    LDP0    F$CFU$,,AUTO
         3 001213   200006 720100                    LXL0    D@,,AUTO
         3 001214   000002 236110                    LDQ     2,X0,PR0
         3 001215   777777 376007                    ANQ     -1,DL
         3 001216   200006 756100                    STQ     D@,,AUTO

      295     5028    5                  END;

   5028  3 001217   000002 236100                    LDQ     2,,PR0
         3 001220   000022 772000                    QRL     18
         3 001221   200006 116100                    CMPQ    D@,,AUTO
         3 001222   001224 600000 3                  TZE     s:5029
         3 001223   001212 603000 3                  TRC     s:5027

      296     5029    4               CALL USEDX(X@);

   5029  3 001224   200010 630500                    EPPR0   X@,,AUTO
         3 001225   200433 450500                    STP0    BITS+258,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:60   
         3 001226   001535 701000 3                  TSX1    USEDX
         3 001227   000000 011000                    NOP     0

      297     5030    4               GOTO FILEOUT;

   5030  3 001230   000453 710000 3                  TRA     FILEOUT

      298     5031    4   NXTFREE:    END;
      299     5032    3            X@=X@/8;

   5032  3 001231   200010 236100                    LDQ     X@,,AUTO
         3 001232   000003 772000                    QRL     3
         3 001233   200010 756100                    STQ     X@,,AUTO

      300     5033    3            END;

      301     5034    2         X@=X@+1;

   5034  3 001234   200010 235100                    LDA     X@,,AUTO
         3 001235   000001 035007                    ADLA    1,DL
         3 001236   200010 755100                    STA     X@,,AUTO

      302     5035    2         END;

   5035  3 001237   200013 470500                    LDP0    F$CFU$,,AUTO
         3 001240   000002 236100                    LDQ     2,,PR0
         3 001241   000022 772000                    QRL     18
         3 001242   000003 772000                    QRL     3
         3 001243   200010 116100                    CMPQ    X@,,AUTO
         3 001244   001246 600000 3                  TZE     SNS
         3 001245   001122 603000 3                  TRC     s:5015

   5029  3 001246                       SNS          null
      303     5036        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:61   
      304     5037    1   SNS:;
      305     5038    1      CFU_REPHD00.TXT$=ADDR(SN_HDR);

   5038  3 001246   000035 236000 4                  LDQ     29
         3 001247   000010 756000 1                  STQ     CFU_REPHD00

      306     5039    1      CALL DAF$INIT(CFU_REP);

   5039  3 001250   000003 630400 4                  EPPR0   3
         3 001251   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001252   000000 701000 xent               TSX1    DAF$INIT
         3 001253   000000 011000                    NOP     0

      307     5040    1      TYPE=%DA_CFUS_SERIAL;

   5040  3 001254   000006 235007                    LDA     6,DL
         3 001255   200012 755100                    STA     TYPE,,AUTO

      308     5041    1      X@=0;

   5041  3 001256   200010 450100                    STZ     X@,,AUTO

      309     5042    2      DO WHILE(X@<FM$CFUX.CFUT/8);

   5042  3 001257   001377 710000 3                  TRA     s:5057

      310     5043    2         IF BITS(X@/32)='777777777760'O THEN  X@=X@/32*32+31;

   5043  3 001260   200010 236100                    LDQ     X@,,AUTO
         3 001261   000005 772000                    QRL     5
         3 001262   200031 236106                    LDQ     BITS,QL,AUTO
         3 001263   000645 116000 2                  CMPQ    MPLX_MSG+15
         3 001264   001273 601000 3                  TNZ     s:5044

   5043  3 001265   200010 236100                    LDQ     X@,,AUTO
         3 001266   000005 772000                    QRL     5
         3 001267   000005 736000                    QLS     5
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:62   
         3 001270   000037 036007                    ADLQ    31,DL
         3 001271   200010 756100                    STQ     X@,,AUTO
         3 001272   001374 710000 3                  TRA     NOTSN

      311     5044    3         ELSE IF NOT BITS(X@/32)&MASKS(MOD(X@,32)) THEN DO;

   5044  3 001273   200010 236100                    LDQ     X@,,AUTO
         3 001274   000005 772000                    QRL     5
         3 001275   200442 756100                    STQ     I+1,,AUTO
         3 001276   200010 236100                    LDQ     X@,,AUTO
         3 001277   000037 376007                    ANQ     31,DL
         3 001300   000000 620006                    EAX0    0,QL
         3 001301   200442 721100                    LXL1    I+1,,AUTO
         3 001302   200031 236111                    LDQ     BITS,X1,AUTO
         3 001303   000554 376010 2                  ANQ     MASKS,X0
         3 001304   001374 601000 3                  TNZ     NOTSN

      312     5045    3            F$=ADDR(FM$SET(X@));

   5045  3 001305   200010 236100                    LDQ     X@,,AUTO
         3 001306   000025 736000                    QLS     21
         3 001307   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 001310   200004 756100                    STQ     F$,,AUTO

      313     5046    3            IF FT$CFUSN.NUM~=0 AND FT$CFUSN.NUM<5

   5046  3 001311   200004 470500                    LDP0    F$,,AUTO
         3 001312   000100 101500                    MRL     fill='000'O
         3 001313   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 001314   200442 000004                    ADSC9   I+1,,AUTO                cn=0,n=4
         3 001315   200442 236100                    LDQ     I+1,,AUTO
         3 001316   000000 116003                    CMPQ    0,DU
         3 001317   001374 600000 3                  TZE     NOTSN
         3 001320   000100 101500                    MRL     fill='000'O
         3 001321   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 001322   200443 000004                    ADSC9   I+2,,AUTO                cn=0,n=4
         3 001323   200443 236100                    LDQ     I+2,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:63   
         3 001324   000005 116007                    CMPQ    5,DL
         3 001325   001374 605000 3                  TPL     NOTSN

      314     5047    4            THEN DO S@=0 TO FT$CFUSN.NUM-1;

   5047  3 001326   200007 450100                    STZ     S@,,AUTO
         3 001327   001342 710000 3                  TRA     s:5049+3

      315     5048    4               IF FT$CFUSN.SN(S@)<=' ' THEN GOTO NOTSN;

   5048  3 001330   200007 236100                    LDQ     S@,,AUTO
         3 001331   000006 402007                    MPY     6,DL
         3 001332   200004 470500                    LDP0    F$,,AUTO
         3 001333   040106 106400                    CMPC    fill='040'O
         3 001334   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001335   000001 000006                    ADSC9   1,Q,PR0                  cn=0,n=6
         3 001336   001374 603000 3                  TRC     NOTSN

      316     5049    4               END;

   5049  3 001337   200007 235100                    LDA     S@,,AUTO
         3 001340   000001 035007                    ADLA    1,DL
         3 001341   200007 755100                    STA     S@,,AUTO
         3 001342   000100 101500                    MRL     fill='000'O
         3 001343   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 001344   200442 000004                    ADSC9   I+1,,AUTO                cn=0,n=4
         3 001345   200442 236100                    LDQ     I+1,,AUTO
         3 001346   200007 116100                    CMPQ    S@,,AUTO
         3 001347   001351 600000 3                  TZE     s:5049+10
         3 001350   001330 603000 3                  TRC     s:5048
         3 001351   001352 710000 3                  TRA     s:5051

      317     5050    3            ELSE GOTO NOTSN;
      318     5051    3            COUNTS.SN=COUNTS.SN+1;

   5051  3 001352   200025 235100                    LDA     COUNTS+9,,AUTO
         3 001353   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:64   
         3 001354   200025 755100                    STA     COUNTS+9,,AUTO

      319     5052    3            CALL USED(X@);

   5052  3 001355   200010 631500                    EPPR1   X@,,AUTO
         3 001356   200433 451500                    STP1    BITS+258,,AUTO
         3 001357   001571 701000 3                  TSX1    USED
         3 001360   000000 011000                    NOP     0

      320     5053    3            CALL CHECK;

   5053  3 001361   001725 701000 3                  TSX1    CHECK
         3 001362   000000 011000                    NOP     0

      321     5054    3            IF FLG.SNS THEN CALL FORMAT(SN_MSG,X@);

   5054  3 001363   200011 236100                    LDQ     FLG,,AUTO
         3 001364   010000 316003                    CANQ    4096,DU
         3 001365   001374 600000 3                  TZE     NOTSN

   5054  3 001366   200010 630500                    EPPR0   X@,,AUTO
         3 001367   200440 450500                    STP0    Q$+1,,AUTO
         3 001370   000036 236000 4                  LDQ     30
         3 001371   200437 756100                    STQ     P$+1,,AUTO
         3 001372   001652 701000 3                  TSX1    FORMAT
         3 001373   000000 011000                    NOP     0

      322     5055    3   NOTSN:   END;

   5055  3 001374                       NOTSN        null
      323     5056    2         X@=X@+1;

   5056  3 001374   200010 235100                    LDA     X@,,AUTO
         3 001375   000001 035007                    ADLA    1,DL
         3 001376   200010 755100                    STA     X@,,AUTO

      324     5057    2         END;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:65   

   5057  3 001377   200013 470500                    LDP0    F$CFU$,,AUTO
         3 001400   000002 236100                    LDQ     2,,PR0
         3 001401   000022 772000                    QRL     18
         3 001402   000003 772000                    QRL     3
         3 001403   200010 116100                    CMPQ    X@,,AUTO
         3 001404   001406 600000 3                  TZE     s:5059
         3 001405   001260 603000 3                  TRC     s:5043

      325     5058        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:66   
      326     5059    1      CFU_REPHD00.TXT$=ADDR(UNU_HDR);

   5059  3 001406   000037 236000 4                  LDQ     31
         3 001407   000010 756000 1                  STQ     CFU_REPHD00

      327     5060    1      CALL DAF$INIT(CFU_REP);

   5060  3 001410   000003 630400 4                  EPPR0   3
         3 001411   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001412   000000 701000 xent               TSX1    DAF$INIT
         3 001413   000000 011000                    NOP     0

      328     5061    1      TYPE=%DA_CFUS_UNALLOCATED;

   5061  3 001414   000007 235007                    LDA     7,DL
         3 001415   200012 755100                    STA     TYPE,,AUTO

      329     5062    1      X@=0;

   5062  3 001416   200010 450100                    STZ     X@,,AUTO

      330     5063    2      DO WHILE(X@<FM$CFUX.CFUT/8);

   5063  3 001417   001470 710000 3                  TRA     s:5071

      331     5064    2         IF BITS(X@/32)='777777777760'O THEN  X@=X@/32*32+31;

   5064  3 001420   200010 236100                    LDQ     X@,,AUTO
         3 001421   000005 772000                    QRL     5
         3 001422   200031 236106                    LDQ     BITS,QL,AUTO
         3 001423   000645 116000 2                  CMPQ    MPLX_MSG+15
         3 001424   001433 601000 3                  TNZ     s:5065

   5064  3 001425   200010 236100                    LDQ     X@,,AUTO
         3 001426   000005 772000                    QRL     5
         3 001427   000005 736000                    QLS     5
         3 001430   000037 036007                    ADLQ    31,DL
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:67   
         3 001431   200010 756100                    STQ     X@,,AUTO
         3 001432   001465 710000 3                  TRA     s:5070

      332     5065    3         ELSE IF NOT BITS(X@/32)&MASKS(MOD(X@,32)) THEN DO;

   5065  3 001433   200010 236100                    LDQ     X@,,AUTO
         3 001434   000005 772000                    QRL     5
         3 001435   200442 756100                    STQ     I+1,,AUTO
         3 001436   200010 236100                    LDQ     X@,,AUTO
         3 001437   000037 376007                    ANQ     31,DL
         3 001440   000000 620006                    EAX0    0,QL
         3 001441   200442 721100                    LXL1    I+1,,AUTO
         3 001442   200031 236111                    LDQ     BITS,X1,AUTO
         3 001443   000554 376010 2                  ANQ     MASKS,X0
         3 001444   001465 601000 3                  TNZ     s:5070

      333     5066    3            CALL CHECK;

   5066  3 001445   001725 701000 3                  TSX1    CHECK
         3 001446   000000 011000                    NOP     0

      334     5067    3            IF X@~=0 THEN COUNTS.LOST=COUNTS.LOST+1;

   5067  3 001447   200010 235100                    LDA     X@,,AUTO
         3 001450   001454 600000 3                  TZE     s:5068

   5067  3 001451   200026 236100                    LDQ     COUNTS+10,,AUTO
         3 001452   000001 036007                    ADLQ    1,DL
         3 001453   200026 756100                    STQ     COUNTS+10,,AUTO

      335     5068    3            IF FLG.UNU THEN CALL FORMAT(UNU_MSG,X@);

   5068  3 001454   200011 236100                    LDQ     FLG,,AUTO
         3 001455   004000 316003                    CANQ    2048,DU
         3 001456   001465 600000 3                  TZE     s:5070

   5068  3 001457   200010 630500                    EPPR0   X@,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:68   
         3 001460   200440 450500                    STP0    Q$+1,,AUTO
         3 001461   000040 236000 4                  LDQ     32
         3 001462   200437 756100                    STQ     P$+1,,AUTO
         3 001463   001652 701000 3                  TSX1    FORMAT
         3 001464   000000 011000                    NOP     0

      336     5069    3            END;

      337     5070    2         X@=X@+1;

   5070  3 001465   200010 235100                    LDA     X@,,AUTO
         3 001466   000001 035007                    ADLA    1,DL
         3 001467   200010 755100                    STA     X@,,AUTO

      338     5071    2         END;

   5071  3 001470   200013 470500                    LDP0    F$CFU$,,AUTO
         3 001471   000002 236100                    LDQ     2,,PR0
         3 001472   000022 772000                    QRL     18
         3 001473   000003 772000                    QRL     3
         3 001474   200010 116100                    CMPQ    X@,,AUTO
         3 001475   001477 600000 3                  TZE     s:5073
         3 001476   001420 603000 3                  TRC     s:5064

      339     5072        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:69   
      340     5073    1      CFU_REPHD00.TXT$=ADDR(SUM_HDR);

   5073  3 001477   000041 236000 4                  LDQ     33
         3 001500   000010 756000 1                  STQ     CFU_REPHD00

      341     5074    1      CALL DAF$INIT(CFU_REP);

   5074  3 001501   000003 630400 4                  EPPR0   3
         3 001502   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001503   000000 701000 xent               TSX1    DAF$INIT
         3 001504   000000 011000                    NOP     0

      342     5075    1      COUNTS.NAME=(FM$CFUX.NAMET-FM$CFUX.NAMES)/4;

   5075  3 001505   200013 470500                    LDP0    F$CFU$,,AUTO
         3 001506   000001 236100                    LDQ     1,,PR0
         3 001507   777777 376007                    ANQ     -1,DL
         3 001510   200442 756100                    STQ     I+1,,AUTO
         3 001511   000003 236100                    LDQ     3,,PR0
         3 001512   000022 772000                    QRL     18
         3 001513   200442 136100                    SBLQ    I+1,,AUTO
         3 001514   000004 506007                    DIV     4,DL
         3 001515   200030 756100                    STQ     COUNTS+12,,AUTO

      343     5076    1      CALL DAF$WRITE(VECTOR(SUM_MSG),VECTOR(COUNTS));

   5076  3 001516   000044 235000 4                  LDA     36
         3 001517   200442 452500                    STP2    I+1,,AUTO
         3 001520   200442 236100                    LDQ     I+1,,AUTO
         3 001521   000014 036003                    ADLQ    12,DU
         3 001522   200444 757100                    STAQ    I+3,,AUTO
         3 001523   200444 631500                    EPPR1   I+3,,AUTO
         3 001524   200447 451500                    STP1    I+6,,AUTO
         3 001525   000045 236000 4                  LDQ     37
         3 001526   200446 756100                    STQ     I+5,,AUTO
         3 001527   200446 630500                    EPPR0   I+5,,AUTO
         3 001530   000000 220000 xsym               LDX0    DAF$WRITE
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:70   
         3 001531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001532   000000 701010                    TSX1    0,X0
         3 001533   000000 011000                    NOP     0

      344     5077    1      RETURN;

   5077  3 001534   000000 702200 xent               TSX2  ! X66_ARET

      345     5078        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:71   
      346     5079    1   USEDX: PROC(I@) ALTRET;

   5079  3 001535   200432 741300       USEDX        STX1  ! BITS+257,,AUTO

      347     5080    2   DCL BADX_MSG CONSTANT CHAR(0) INIT(
      348     5081    2   ' *** Block at %O not in the CFUS%10P!');
      349     5082    2   DCL MPLX_MSG CONSTANT CHAR(0) INIT(
      350     5083    2   ' *** Block at %O in multiple use%10P!');
      351     5084    2   DCL I@ UBIN;
      352     5085    2   DCL WX UBIN;
      353     5086    2   DCL BX UBIN;
      354     5087    2      IF MOD(I@,8)~=0 OR I@>FM$CFUX.CFUT THEN GOTO BADX;

   5087  3 001536   200433 470500                    LDP0    @I@,,AUTO
         3 001537   000000 236100                    LDQ     0,,PR0
         3 001540   000007 376007                    ANQ     7,DL
         3 001541   001632 601000 3                  TNZ     BADX
         3 001542   200013 471500                    LDP1    F$CFU$,,AUTO
         3 001543   100002 236100                    LDQ     2,,PR1
         3 001544   000022 772000                    QRL     18
         3 001545   000000 116100                    CMPQ    0,,PR0
         3 001546   001632 602000 3                  TNC     BADX

      355     5088    2      WX=I@/32/8;

   5088  3 001547   000000 236100                    LDQ     0,,PR0
         3 001550   000005 772000                    QRL     5
         3 001551   000003 772000                    QRL     3
         3 001552   200434 756100                    STQ     WX,,AUTO

      356     5089    2      BX=MOD(I@,8*32)/8;

   5089  3 001553   000000 236100                    LDQ     0,,PR0
         3 001554   000377 376007                    ANQ     255,DL
         3 001555   000003 772000                    QRL     3
         3 001556   200435 756100                    STQ     BX,,AUTO

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:72   
      357     5090    2   TSTON: IF BITS(WX)&MASKS(BX) THEN GOTO MPLX;

   5090  3 001557   200435 720100       TSTON        LXL0    BX,,AUTO
         3 001560   200434 721100                    LXL1    WX,,AUTO
         3 001561   200031 236111                    LDQ     BITS,X1,AUTO
         3 001562   000554 376010 2                  ANQ     MASKS,X0
         3 001563   001642 601000 3                  TNZ     MPLX

      358     5091    2      BITS(WX)=BITS(WX)|MASKS(BX);

   5091  3 001564   200031 236111                    LDQ     BITS,X1,AUTO
         3 001565   000554 276010 2                  ORQ     MASKS,X0
         3 001566   200031 756111                    STQ     BITS,X1,AUTO

      359     5092    2      RETURN;

   5092  3 001567   200432 221300                    LDX1  ! BITS+257,,AUTO
         3 001570   000001 702211                    TSX2  ! 1,X1

      360     5093    2   USED: ENTRY(I@) ALTRET;

   5093  3 001571   200432 741300       USED         STX1  ! BITS+257,,AUTO

      361     5094    2      CALL TEST ALTRET(BADX);

   5094  3 001572   001613 701000 3                  TSX1    TEST
         3 001573   001632 702000 3                  TSX2    BADX

      362     5095    2      GOTO TSTON;

   5095  3 001574   001557 710000 3                  TRA     TSTON

      363     5096    2   UNUSED: ENTRY(I@) ALTRET;

   5096  3 001575   200432 741300       UNUSED       STX1  ! BITS+257,,AUTO

      364     5097    2      CALL TEST ALTRET(BADX);
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:73   

   5097  3 001576   001613 701000 3                  TSX1    TEST
         3 001577   001632 702000 3                  TSX2    BADX

      365     5098    2      IF NOT BITS(WX)&MASKS(BX) THEN GOTO MPLX;

   5098  3 001600   200435 720100                    LXL0    BX,,AUTO
         3 001601   200434 721100                    LXL1    WX,,AUTO
         3 001602   200031 236111                    LDQ     BITS,X1,AUTO
         3 001603   000554 376010 2                  ANQ     MASKS,X0
         3 001604   001642 600000 3                  TZE     MPLX

      366     5099    2      BITS(WX)=BITS(WX)&~MASKS(BX);

   5099  3 001605   000554 236010 2                  LDQ     MASKS,X0
         3 001606   000027 676000 xsym               ERQ     B_VECTNIL+23
         3 001607   200031 376111                    ANQ     BITS,X1,AUTO
         3 001610   200031 756111                    STQ     BITS,X1,AUTO

      367     5100    2      RETURN;

   5100  3 001611   200432 221300                    LDX1  ! BITS+257,,AUTO
         3 001612   000001 702211                    TSX2  ! 1,X1

      368     5101        /**/
      369     5102    2   TEST: PROC ALTRET;

   5102  3 001613   200436 741300       TEST         STX1  ! L+1,,AUTO

      370     5103    3      IF I@>FM$CFUX.CFUT THEN ALTRETURN;

   5103  3 001614   200433 470500                    LDP0    @I@,,AUTO
         3 001615   200013 471500                    LDP1    F$CFU$,,AUTO
         3 001616   100002 236100                    LDQ     2,,PR1
         3 001617   000022 772000                    QRL     18
         3 001620   000000 116100                    CMPQ    0,,PR0
         3 001621   001623 603000 3                  TRC     s:5104
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:74   

   5103  3 001622   000000 702211                    TSX2  ! 0,X1

      371     5104    3      WX=I@/32;

   5104  3 001623   000000 236100                    LDQ     0,,PR0
         3 001624   000005 772000                    QRL     5
         3 001625   200434 756100                    STQ     WX,,AUTO

      372     5105    3      BX=MOD(I@,32);

   5105  3 001626   000000 236100                    LDQ     0,,PR0
         3 001627   000037 376007                    ANQ     31,DL
         3 001630   200435 756100                    STQ     BX,,AUTO

      373     5106    3      RETURN;

   5106  3 001631   000001 702211                    TSX2  ! 1,X1

      374     5107    3   END;
      375     5108        /**/
      376     5109    2   BADX: CALL FORMAT(BADX_MSG,I@);

   5109  3 001632   200433 236100       BADX         LDQ     @I@,,AUTO
         3 001633   200440 756100                    STQ     Q$+1,,AUTO
         3 001634   000046 236000 4                  LDQ     38
         3 001635   200437 756100                    STQ     P$+1,,AUTO
         3 001636   001652 701000 3                  TSX1    FORMAT
         3 001637   000000 011000                    NOP     0

      377     5110    2      ALTRETURN;

   5110  3 001640   200432 221300                    LDX1  ! BITS+257,,AUTO
         3 001641   000000 702211                    TSX2  ! 0,X1

      378     5111    2   MPLX: CALL FORMAT(MPLX_MSG,I@);

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:75   
   5111  3 001642   200433 236100       MPLX         LDQ     @I@,,AUTO
         3 001643   200440 756100                    STQ     Q$+1,,AUTO
         3 001644   000047 236000 4                  LDQ     39
         3 001645   200437 756100                    STQ     P$+1,,AUTO
         3 001646   001652 701000 3                  TSX1    FORMAT
         3 001647   000000 011000                    NOP     0

      379     5112    2      ALTRETURN;

   5112  3 001650   200432 221300                    LDX1  ! BITS+257,,AUTO
         3 001651   000000 702211                    TSX2  ! 0,X1

      380     5113    2   END USEDX;
      381     5114        /**/
      382     5115        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:76   
      383     5116    1   FORMAT: PROC(CTL,CFUX);

   5116  3 001652   200436 741300       FORMAT       STX1  ! L+1,,AUTO

      384     5117    2   DCL CTL CHAR(200);
      385     5118    2   DCL CFUX UBIN ALIGNED;
      386     5119    2   DCL I UBIN;
      387     5120    2      CALL INDEX(I,'!',CTL);

   5120  3 001653   200437 470500                    LDP0    @CTL,,AUTO
         3 001654   000000 124500                    SCM     mask='000'O
         3 001655   000000 000310                    ADSC9   0,,PR0                   cn=0,n=200
         3 001656   000050 000001 4                  ADSC9   40                       cn=0,n=1
         3 001657   200441 000100                    ARG     I,,AUTO

      388     5121    2      CALL DAF$WRITE(VECTOR(SUBSTR(CTL,0,I)),VECTOR(CFUX),VECTOR(FM$SET(CFUX)),

   5121  3 001660   200441 235100                    LDA     I,,AUTO
         3 001661   000020 735000                    ALS     16
         3 001662   000140 135007                    SBLA    96,DL
         3 001663   200437 236100                    LDQ     @CTL,,AUTO
         3 001664   200442 757100                    STAQ    I+1,,AUTO
         3 001665   777640 235007                    LDA     -96,DL
         3 001666   200440 236100                    LDQ     @CFUX,,AUTO
         3 001667   200440 471500                    LDP1    @CFUX,,AUTO
         3 001670   200444 757100                    STAQ    I+3,,AUTO
         3 001671   100000 235100                    LDA     0,,PR1
         3 001672   000003 735000                    ALS     3
         3 001673   000000 620005                    EAX0    0,AL
         3 001674   000051 235000 4                  LDA     41
         3 001675   000000 636010                    EAQ     0,X0
         3 001676   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 001677   200450 757100                    STAQ    I+7,,AUTO
         3 001700   200442 237100                    LDAQ    I+1,,AUTO
         3 001701   200446 757100                    STAQ    I+5,,AUTO
         3 001702   200444 237100                    LDAQ    I+3,,AUTO
         3 001703   200452 757100                    STAQ    I+9,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:77   
         3 001704   200450 237100                    LDAQ    I+7,,AUTO
         3 001705   200454 757100                    STAQ    I+11,,AUTO
         3 001706   000054 236000 4                  LDQ     44
         3 001707   200461 756100                    STQ     I+16,,AUTO
         3 001710   200454 633500                    EPPR3   I+11,,AUTO
         3 001711   200460 453500                    STP3    I+15,,AUTO
         3 001712   200452 634500                    EPPR4   I+9,,AUTO
         3 001713   200457 454500                    STP4    I+14,,AUTO
         3 001714   200446 635500                    EPPR5   I+5,,AUTO
         3 001715   200456 455500                    STP5    I+13,,AUTO
         3 001716   200456 630500                    EPPR0   I+13,,AUTO
         3 001717   000000 220000 xsym               LDX0    DAF$WRITE
         3 001720   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 001721   000000 701010                    TSX1    0,X0
         3 001722   000000 011000                    NOP     0

      389     5122    2        VECTOR(FID));
      390     5123    2      RETURN;

   5123  3 001723   200436 221300                    LDX1  ! L+1,,AUTO
         3 001724   000001 702211                    TSX2  ! 1,X1

      391     5124    2   END FORMAT;
      392     5125        %EJECT;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:78   
      393     5126    1   CHECK: PROC;

   5126  3 001725   200432 741300       CHECK        STX1  ! BITS+257,,AUTO

      394     5127    2   DCL J UBIN;
      395     5128    2   DCL I UBIN;
      396     5129    2   DCL L UBIN;
      397     5130    2   DCL P$ PTR;
      398     5131    2   DCL Q$ PTR;
      399     5132    2      I=0;

   5132  3 001726   200434 450100                    STZ     I,,AUTO

      400     5133    2      FLG='0'B;

   5133  3 001727   200011 450100                    STZ     FLG,,AUTO

      401     5134    3      IF CFUBLK.NSUBLKS=0 THEN DO;

   5134  3 001730   200003 470500                    LDP0    @CFUBLK,,AUTO
         3 001731   000001 220100                    LDX0    1,,PR0
         3 001732   001754 601000 3                  TNZ     s:5140

      402     5135    3         IF CFUBLK.CODE~=%DA_ONCE_CFUS THEN FLG='777777'O;

   5135  3 001733   000000 722100                    LXL2    0,,PR0
         3 001734   000014 102003                    CMPX2   12,DU
         3 001735   001741 600000 3                  TZE     s:5136

   5135  3 001736   777777 236003                    LDQ     -1,DU
         3 001737   200011 756100                    STQ     FLG,,AUTO
         3 001740   001753 710000 3                  TRA     s:5138

      403     5136    3         ELSE IF TYPE=%DA_CFUS_FILES THEN IF FM$CFU.FUN=0 THEN RETURN;

   5136  3 001741   200012 235100                    LDA     TYPE,,AUTO
         3 001742   000004 115007                    CMPA    4,DL
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:79   
         3 001743   001753 601000 3                  TNZ     s:5138

   5136  3 001744   200004 471500                    LDP1    F$,,AUTO
         3 001745   100000 236100                    LDQ     0,,PR1
         3 001746   700000 316003                    CANQ    -32768,DU
         3 001747   001751 601000 3                  TNZ     s:5137

   5136  3 001750   000001 702211                    TSX2  ! 1,X1

      404     5137    3         ELSE FLG='04'O;

   5137  3 001751   040000 236003                    LDQ     16384,DU
         3 001752   200011 756100                    STQ     FLG,,AUTO

      405     5138    3         RETURN;

   5138  3 001753   000001 702211                    TSX2  ! 1,X1

      406     5139    3         END;
      407     5140    3      DO WHILE(I<CFUBLK.NSUBLKS);

   5140  3 001754   000001 236100                    LDQ     1,,PR0
         3 001755   000022 772000                    QRL     18
         3 001756   200434 116100                    CMPQ    I,,AUTO
         3 001757   002206 602000 3                  TNC     s:5176
         3 001760   002206 600000 3                  TZE     s:5176

      408     5141    3         P$=CFUBLK.SUBLK$(I);

   5141  3 001761   200003 470500                    LDP0    @CFUBLK,,AUTO
         3 001762   200434 720100                    LXL0    I,,AUTO
         3 001763   000003 236110                    LDQ     3,X0,PR0
         3 001764   200436 756100                    STQ     P$,,AUTO

      409     5142    4         DO CASE(P$->OBLK.CODE);

   5142  3 001765   200436 471500                    LDP1    P$,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:80   
         3 001766   100000 236100                    LDQ     0,,PR1
         3 001767   777777 376007                    ANQ     -1,DL
         3 001770   000004 136007                    SBLQ    4,DL
         3 001771   000005 116007                    CMPQ    5,DL
         3 001772   001774 602006 3                  TNC     s:5142+7,QL
         3 001773   002025 710000 3                  TRA     s:5149
         3 001774   002001 710000 3                  TRA     s:5144
         3 001775   002001 710000 3                  TRA     s:5144
         3 001776   002025 710000 3                  TRA     s:5149
         3 001777   002025 710000 3                  TRA     s:5149
         3 002000   002001 710000 3                  TRA     s:5144

      410     5143    4         CASE(%DA_CFUS_FILES,%DA_CFUS_FILEL,%DA_CFUS_FDA);

      411     5144    4            IF TYPE~=%DA_CFUS_FILES THEN GOTO NO;

   5144  3 002001   200012 235100                    LDA     TYPE,,AUTO
         3 002002   000004 115007                    CMPA    4,DL
         3 002003   002175 601000 3                  TNZ     NO

      412     5145    4            IF P$->OBLK.CODE=%DA_CFUS_FILES AND FM$CFU.FUN=0 THEN GOTO NO;

   5145  3 002004   100000 721100                    LXL1    0,,PR1
         3 002005   000004 101003                    CMPX1   4,DU
         3 002006   002013 601000 3                  TNZ     s:5146
         3 002007   200004 473500                    LDP3    F$,,AUTO
         3 002010   300000 236100                    LDQ     0,,PR3
         3 002011   700000 316003                    CANQ    -32768,DU
         3 002012   002175 600000 3                  TZE     NO

      413     5146    4            IF F$CFU$=A$ THEN S@=0;

   5146  3 002013   200013 236100                    LDQ     F$CFU$,,AUTO
         3 002014   200005 116100                    CMPQ    A$,,AUTO
         3 002015   002020 601000 3                  TNZ     s:5147

   5146  3 002016   200007 450100                    STZ     S@,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:81   
         3 002017   002031 710000 3                  TRA     s:5151

      414     5147    4            ELSE S@=FM$CFUA.SETX;

   5147  3 002020   200005 473500                    LDP3    A$,,AUTO
         3 002021   300000 236100                    LDQ     0,,PR3
         3 002022   000022 772000                    QRL     18
         3 002023   200007 756100                    STQ     S@,,AUTO
         3 002024   002031 710000 3                  TRA     s:5151

      415     5148    4         CASE(ELSE);

      416     5149    4            IF TYPE~=P$->OBLK.CODE THEN GOTO NO;

   5149  3 002025   100000 236100                    LDQ     0,,PR1
         3 002026   777777 376007                    ANQ     -1,DL
         3 002027   200012 116100                    CMPQ    TYPE,,AUTO
         3 002030   002175 601000 3                  TNZ     NO

      417     5150    4         END;

      418     5151    3         J=0;

   5151  3 002031   200433 450100                    STZ     J,,AUTO

      419     5152    4         DO WHILE(J<P$->OBLK.NSUBLKS);

   5152  3 002032   100001 236100                    LDQ     1,,PR1
         3 002033   000022 772000                    QRL     18
         3 002034   200433 116100                    CMPQ    J,,AUTO
         3 002035   002164 602000 3                  TNC     OK
         3 002036   002164 600000 3                  TZE     OK

      420     5153    4            Q$=P$->OBLK.SUBLK$(J);

   5153  3 002037   200436 470500                    LDP0    P$,,AUTO
         3 002040   200433 720100                    LXL0    J,,AUTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:82   
         3 002041   000003 236110                    LDQ     3,X0,PR0
         3 002042   200437 756100                    STQ     Q$,,AUTO

      421     5154    5            DO CASE(Q$->OBLK.CODE);

   5154  3 002043   200437 471500                    LDP1    Q$,,AUTO
         3 002044   100000 721100                    LXL1    0,,PR1
         3 002045   000004 101003                    CMPX1   4,DU
         3 002046   002050 602011 3                  TNC     s:5154+5,X1
         3 002047   002153 710000 3                  TRA     s:5170
         3 002050   002054 710000 3                  TRA     s:5156
         3 002051   002074 710000 3                  TRA     s:5160
         3 002052   002130 710000 3                  TRA     s:5166
         3 002053   002113 710000 3                  TRA     s:5163

      422     5155    5            CASE(0);

      423     5156    5               CALL CHARBIN(J,Q$->OSYM.TEXT);

   5156  3 002054   100004 236100                    LDQ     4,,PR1
         3 002055   000033 772000                    QRL     27
         3 002056   000000 622006                    EAX2    0,QL
         3 002057   000100 305540                    DTB
         3 002060   100004 230012                    NDSC9   4,,PR1                   cn=1,s=nosgn,sf=0,n=*X2
         3 002061   200442 000010                    NDSC9   I+1,,AUTO                cn=0,s=lsgnf,sf=0,n=8
         3 002062   200443 235100                    LDA     I+2,,AUTO
         3 002063   200433 755100                    STA     J,,AUTO

      424     5157    5               IF J=FM$DEV.NN(D@) THEN GOTO OK;

   5157  3 002064   200006 236100                    LDQ     D@,,AUTO
         3 002065   000003 736000                    QLS     3
         3 002066   200013 473500                    LDP3    F$CFU$,,AUTO
         3 002067   300000 236106                    LDQ     0,QL,PR3
         3 002070   777777 376007                    ANQ     -1,DL
         3 002071   200433 116100                    CMPQ    J,,AUTO
         3 002072   002164 600000 3                  TZE     OK
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:83   

      425     5158    5               ELSE GOTO NO;

   5158  3 002073   002175 710000 3                  TRA     NO

      426     5159    5            CASE(%DA_FID_SET);

      427     5160    5               CALL DAA$WILDCOMP(Q$->OBLK.SUBLK$(0)->OSYM.COUNT,

   5160  3 002074   100003 473500                    LDP3    3,,PR1
         3 002075   000055 236000 4                  LDQ     45
         3 002076   200444 756100                    STQ     I+3,,AUTO
         3 002077   200007 236100                    LDQ     S@,,AUTO
         3 002100   000025 736000                    QLS     21
         3 002101   400000 036007                    ADLQ    -131072,DL
         3 002102   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 002103   200443 756100                    STQ     I+2,,AUTO
         3 002104   300004 634500                    EPPR4   4,,PR3
         3 002105   200442 454500                    STP4    I+1,,AUTO
         3 002106   200442 630500                    EPPR0   I+1,,AUTO
         3 002107   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 002110   000000 701000 xent               TSX1    DAA$WILDCOMP
         3 002111   002175 702000 3                  TSX2    NO
         3 002112   002153 710000 3                  TRA     s:5170

      428     5161    5                 FM$SET.PSN(S@),6) ALTRET(NO);
      429     5162    5            CASE(%DA_FID_ACCT);

      430     5163    5               CALL DAA$WILDCOMP(Q$->OBLK.SUBLK$(0)->OSYM.COUNT,

   5163  3 002113   100003 473500                    LDP3    3,,PR1
         3 002114   000056 236000 4                  LDQ     46
         3 002115   200444 756100                    STQ     I+3,,AUTO
         3 002116   200005 236100                    LDQ     A$,,AUTO
         3 002117   000001 036003                    ADLQ    1,DU
         3 002120   200443 756100                    STQ     I+2,,AUTO
         3 002121   300004 634500                    EPPR4   4,,PR3
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:84   
         3 002122   200442 454500                    STP4    I+1,,AUTO
         3 002123   200442 630500                    EPPR0   I+1,,AUTO
         3 002124   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 002125   000000 701000 xent               TSX1    DAA$WILDCOMP
         3 002126   002175 702000 3                  TSX2    NO
         3 002127   002153 710000 3                  TRA     s:5170

      431     5164    5                 FM$CFUA.ACCT,8) ALTRET(NO);
      432     5165    5            CASE(%DA_FID_NAME);

      433     5166    5               L=PINCRC(F$CFU$,D@)->FM$CFUN.L;

   5166  3 002130   200013 473500                    LDP3    F$CFU$,,AUTO
         3 002131   200006 235100                    LDA     D@,,AUTO
         3 002132   000100 101505                    MRL     fill='000'O
         3 002133   300000 400001                    ADSC9   0,A,PR3                  cn=2,n=1
         3 002134   200435 000004                    ADSC9   L,,AUTO                  cn=0,n=4

      434     5167    5               CALL DAA$WILDCOMP(Q$->OBLK.SUBLK$(0)->OSYM.COUNT,

   5167  3 002135   100003 474500                    LDP4    3,,PR1
         3 002136   200435 635500                    EPPR5   L,,AUTO
         3 002137   200444 455500                    STP5    I+3,,AUTO
         3 002140   200006 236100                    LDQ     D@,,AUTO
         3 002141   000020 736000                    QLS     16
         3 002142   600000 036007                    ADLQ    -65536,DL
         3 002143   200013 036100                    ADLQ    F$CFU$,,AUTO
         3 002144   200443 756100                    STQ     I+2,,AUTO
         3 002145   400004 636500                    EPPR6   4,,PR4
         3 002146   200442 456500                    STP6    I+1,,AUTO
         3 002147   200442 630500                    EPPR0   I+1,,AUTO
         3 002150   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 002151   000000 701000 xent               TSX1    DAA$WILDCOMP
         3 002152   002175 702000 3                  TSX2    NO

      435     5168    5                 PINCRC(F$CFU$,D@)->FM$CFUN.C,L) ALTRET(NO);
      436     5169    5            END;
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:85   

      437     5170    4            J=J+1;

   5170  3 002153   200433 235100                    LDA     J,,AUTO
         3 002154   000001 035007                    ADLA    1,DL
         3 002155   200433 755100                    STA     J,,AUTO

      438     5171    4            END;

   5171  3 002156   200436 470500                    LDP0    P$,,AUTO
         3 002157   000001 236100                    LDQ     1,,PR0
         3 002160   000022 772000                    QRL     18
         3 002161   200433 116100                    CMPQ    J,,AUTO
         3 002162   002164 600000 3                  TZE     OK
         3 002163   002037 603000 3                  TRC     s:5153

   5167  3 002164                       OK           null
      439     5172    3   OK:;  FLG=FLG|'757777'O;

   5172  3 002164   200011 236100                    LDQ     FLG,,AUTO
         3 002165   757777 276003                    ORQ     -8193,DU
         3 002166   200011 756100                    STQ     FLG,,AUTO

      440     5173    3         IF P$->OBLK.CODE=%DA_CFUS_FILEL THEN FLG.FIA='1'B;

   5173  3 002167   200436 470500                    LDP0    P$,,AUTO
         3 002170   000000 720100                    LXL0    0,,PR0
         3 002171   000005 100003                    CMPX0   5,DU
         3 002172   002175 601000 3                  TNZ     NO

   5173  3 002173   020000 236003                    LDQ     8192,DU
         3 002174   200011 256100                    ORSQ    FLG,,AUTO

      441     5174    3   NO:   I=I+1;

   5174  3 002175   200434 235100       NO           LDA     I,,AUTO
         3 002176   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:86   
         3 002177   200434 755100                    STA     I,,AUTO

      442     5175    3         END;

   5175  3 002200   200003 470500                    LDP0    @CFUBLK,,AUTO
         3 002201   000001 236100                    LDQ     1,,PR0
         3 002202   000022 772000                    QRL     18
         3 002203   200434 116100                    CMPQ    I,,AUTO
         3 002204   002206 600000 3                  TZE     s:5176
         3 002205   001761 603000 3                  TRC     s:5141

      443     5176    2      RETURN;

   5176  3 002206   200432 221300                    LDX1  ! BITS+257,,AUTO
         3 002207   000001 702211                    TSX2  ! 1,X1

   5176  3 002210                       RETRET       null
      444     5177    2      END CHECK;
      445     5178    1   RETRET:;
      446     5179    1   END DAD$CFUS;

   5179  3 002210   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:87   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   DA_CMD_C.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DAD$CFUS.
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:88   

 **** Variables and constants ****

  ****  Section 001  Data  DAD$CFUS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(288)   r     1 CFU_REP                   10-0-0/w STRC(144)   r     1 CFU_REPHD00
    14-0-0/w STRC(144)   r     1 CFU_REPHD01               20-0-0/w STRC(144)   r     1 CFU_REPHD02
    24-0-0/c STRC(729)   r     1 CFU_REPTX00               51-0-0/c CHAR(52)    r     1 FID

  ****  Section 002 RoData DAD$CFUS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    71-0-0/c STRC(720)   r     1 ACT_HDR                  303-0-0/c CHAR(70)    r     1 AC_MSG
   614-0-0/c CHAR(37)    r     1 BADX_MSG                   5-0-0/c STRC(441)   r     1 DEV_HDR
   212-0-0/c CHAR(51)    r     1 DEV_MSG                    0-0-0/c STRC(162)   r     1 DEV_TTL
   377-0-0/c CHAR(22)    r     1 FDA_MSG                  325-0-0/c CHAR(102)   r     1 FIA_MSG
   115-0-0/c STRC(720)   r     1 FIL_HDR                  357-0-0/c CHAR(61)    r     1 FIL_MSG
   435-0-0/c CHAR(64)    r     1 JFIL_MSG                 405-0-0/c CHAR(96)    r     1 JTAP_MSG
   455-0-0/c CHAR(66)    r     1 KEY_MSG                  510-0-0/c CHAR(39)    r     1 LNK_MSG
   554-0-0/b BIT         r     1 MASKS(0:31)              626-0-0/c CHAR(37)    r     1 MPLX_MSG
    45-0-0/c STRC(720)   r     1 SET_HDR                  251-0-0/c CHAR(64)    r     1 SET_MSG
   271-0-0/c CHAR(38)    r     1 SID_MSG                  141-0-0/c STRC(495)   r     1 SN_HDR
   522-0-0/c CHAR(57)    r     1 SN_MSG                   166-0-0/c STRC(720)   r     1 SUM_HDR
   551-0-0/c CHAR(9)     r     1 SUM_MSG                  157-0-0/c STRC(234)   r     1 UNU_HDR
   541-0-0/c CHAR(32)    r     1 UNU_MSG                   22-0-0/c STRC(684)   r     1 VOL_HDR
   227-0-0/c CHAR(70)    r     1 VOL_MSG                  476-0-0/c CHAR(37)    r     1 XTN_MSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CFUBLK                  440-0-0/w PTR         r     1 @CFUX
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:89   
   437-0-0/w PTR         r     1 @CTL                     433-0-0/w PTR         r     1 @I@
     5-0-0/w PTR         r     1 A$                         5-0-0/w SBIN        r     1 A$SBIN
    31-0-0/b BIT         r     1 BITS(0:255)              435-0-0/w UBIN        r     1 BX
    *0-0-0/w STRC(144)   r     1 CFUBLK                    *0-0-0/w UBIN        r     1 CFUX
    14-0-0/w STRC(468)   r     1 COUNTS                    *0-0-0/c CHAR(200)   r     1 CTL
     6-0-0/w UBIN        r     1 D@                         4-0-0/w PTR         r     1 F$
    13-0-0/w PTR         r     1 F$CFU$                    11-0-0/b STRC        r     1 FLG
   441-0-0/w UBIN        r     1 I                        434-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 I@                       433-0-0/w UBIN        r     1 J
   435-0-0/w UBIN        r     1 L                        436-0-0/w PTR         r     1 P$
   437-0-0/w PTR         r     1 Q$                         7-0-0/w UBIN        r     1 S@
    12-0-0/w UBIN        r     1 TYPE                     434-0-0/w UBIN        r     1 WX
    10-0-0/w UBIN        r     1 X@

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$DS1$                     0-0-0/w EPTR        r     1 DAF$WRITE

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(80)    r     1 CHAR80                     0-0-0/w STRC(288)   r     1 FM$CFU
     0-0-0/w STRC(288)   r     1 FM$CFUA                    0-0-0/w STRC(288)   r     1 FM$CFUJ
     0-0-0/c ASTR(27)    r     1 FM$CFUN                    0-0-0/w STRC(288)   r     1 FM$CFUX
     0-0-0/w STRC(288)   r     1 FM$DEV(0:0)                0-0-0/w STRC(288)   r     1 FM$SET(0:0)
     0-0-0/w STRC(288)   r     1 FM$SETU                    0-0-0/w STRC(288)   r     1 FM$VOL(0:0)
     0-0-0/c STRC(288)   r     1 FT$CFUSN                   0-0-0/w STRC(144)   r     1 OBLK
     0-0-0/w ASTR(153)   r     1 OSYM


   Procedure DAD$CFUS requires 1161 words for executable code.
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:90   
   Procedure DAD$CFUS requires 314 words of local(AUTO) storage.

    No errors detected in file DAD$CFUS.:E05TSI    .
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:91   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:92   
          MINI XREF LISTING

A$
      4776**DCL      4777--REDEF    4840--IMP-PTR  4930<<ASSIGN   4931>>ASSIGN   4935>>ASSIGN   4948<<ASSIGN
      4953<<ASSIGN   4955>>IF       4957>>CALLBLT  4959>>CALLBLT  4971<<ASSIGN   4972<<ASSIGN   4973<<ASSIGN
      4974>>CALL     5021<<ASSIGN   5024<<ASSIGN   5146>>IF       5147>>ASSIGN   5163>>CALL
A$SBIN
      4777**DCL      4949>>IF
ACT_HDR
      4624**DCL      4923--ASSIGN
AC_MSG
      4746**DCL      4934<>CALL
B$DS1$
      4774**DCL      4871<>CALL
BADX IN PROCEDURE USEDX
      5109**LABEL    5087--GOTO     5094--CALLALT  5097--CALLALT
BADX_MSG IN PROCEDURE USEDX
      5080**DCL      5109<>CALL
BITS
      4806**DCL      4864<<ASSIGN   5015>>IF       5016>>IF       5043>>IF       5044>>IF       5064>>IF
      5065>>IF       5090>>IF       5091<<ASSIGN   5091>>ASSIGN   5098>>IF       5099<<ASSIGN   5099>>ASSIGN
BX IN PROCEDURE USEDX
      5086**DCL      5089<<ASSIGN   5090>>IF       5091>>ASSIGN   5098>>IF       5099>>ASSIGN   5105<<ASSIGN
CFUBLK
      4167**DCL         7--PROC
CFUBLK.CODE
      4175**DCL      5135>>IF
CFUBLK.NSUBLKS
      4179**DCL      5134>>IF       5140>>DOWHILE
CFUBLK.SUBLK$
      4200**DCL      5141>>ASSIGN
CFUX IN PROCEDURE FORMAT
      5118**DCL      5116--PROC     5121--CALL     5121>>CALL
CFU_REP
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:93   
      4310**DCL      4870<>CALL     4890<>CALL     4925<>CALL     4940<>CALL     5039<>CALL     5060<>CALL
      5074<>CALL
CFU_REPHD00
      4376**DCL      4345--DCLINIT
CFU_REPHD00.NXT$
      4391**DCL      4869<<ASSIGN   4924<<ASSIGN
CFU_REPHD00.TXT$
      4382**DCL      4867<<ASSIGN   4889<<ASSIGN   4923<<ASSIGN   4939<<ASSIGN   5038<<ASSIGN   5059<<ASSIGN
      5073<<ASSIGN
CFU_REPHD01
      4418**DCL      4391--DCLINIT  4869--ASSIGN
CFU_REPHD01.TXT$
      4424**DCL      4868<<ASSIGN
CFU_REPHD02
      4461**DCL      4433--DCLINIT  4924--ASSIGN
CFU_REPTX00
      4479**DCL      4469--DCLINIT
CHAR80
      4862**DCL      4974<>CALL
CHECK
      5126**PROC     4876--CALL     4895--CALL     4932--CALL     4963--CALL     5053--CALL     5066--CALL
COUNTS
      4792**DCL      4865<<ASSIGN   5076--CALL
COUNTS.ACCT
      4797**DCL      4933<<ASSIGN   4933>>ASSIGN
COUNTS.DEV
      4793**DCL      4877<<ASSIGN   4877>>ASSIGN
COUNTS.FDA
      4800**DCL      4966<<ASSIGN   4966>>ASSIGN
COUNTS.FILE
      4798**DCL      4977<<ASSIGN   4977>>ASSIGN
COUNTS.FREE
      4801**DCL      5005<<ASSIGN   5005>>ASSIGN
COUNTS.LOST
      4803**DCL      5067<<ASSIGN   5067>>ASSIGN
COUNTS.NAME
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:94   
      4805**DCL      5075<<ASSIGN
COUNTS.SET
      4795**DCL      4896<<ASSIGN   4896>>ASSIGN
COUNTS.SN
      4802**DCL      5051<<ASSIGN   5051>>ASSIGN
COUNTS.SYSID
      4796**DCL      4909<<ASSIGN   4909>>ASSIGN
COUNTS.TOTAL
      4804**DCL      4987>>IF       4994<<ASSIGN
COUNTS.VOL
      4794**DCL      4882<<ASSIGN   4882>>ASSIGN
COUNTS.XTN
      4799**DCL      4982<<ASSIGN   4982>>ASSIGN
CTL IN PROCEDURE FORMAT
      5117**DCL      5116--PROC     5120>>CALLBLT  5121--CALL
D@
      4778**DCL      4873<<ASSIGN   4874>>DOWHILE  4875<>CALL     4878<>CALL     4879>>ASSIGN   4886<<ASSIGN
      4886>>ASSIGN   4898<<ASSIGN   4899>>DOWHILE  4900<>CALL     4901<>CALL     4902<<ASSIGN   4902>>ASSIGN
      4905>>ASSIGN   4906<<ASSIGN   4907>>DOWHILE  4908<>CALL     4910>>CALL     4911<<ASSIGN   4911>>ASSIGN
      4914<<ASSIGN   4915>>DOWHILE  4916<>CALL     4917<<ASSIGN   4917>>ASSIGN   4927<<ASSIGN   4928>>DOWHILE
      4929<>CALL     4930>>ASSIGN   4934>>CALL     4935<<ASSIGN   4942<<ASSIGN   4943>>DOWHILE  4944>>ASSIGN
      4962>>CALLBLT  4962>>CALLBLT  4991<<ASSIGN   4991>>ASSIGN   4991>>ASSIGN   4991>>ASSIGN   4996<<ASSIGN
      4997>>DOWHILE  4998>>IF       4999>>ASSIGN   5000<>CALL     5002>>CALL     5003<>CALL     5007--CALL
      5010>>ASSIGN   5011<<ASSIGN   5020<<ASSIGN   5021>>ASSIGN   5022>>IF       5023<<ASSIGN   5026>>DOWHILE
      5027<<ASSIGN   5027>>ASSIGN   5157>>IF       5166>>ASSIGN   5167>>CALL     5167>>CALL
DAA$WILDCOMP
      4289**DCL-ENT  5160--CALL     5163--CALL     5167--CALL
DAF$INIT
      4291**DCL-ENT  4870--CALL     4890--CALL     4925--CALL     4940--CALL     5039--CALL     5060--CALL
      5074--CALL
DAF$WRITE
      4292**DCL      5007>>CALL     5076>>CALL     5121>>CALL
DAM$MAP
      4290**DCL-ENT  4871--CALL
DEV_HDR
      4540**DCL      4382--DCLINIT  4867--ASSIGN
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:95   
DEV_MSG
      4738**DCL      4878<>CALL
DEV_TTL
      4512**DCL      4338--DCLINIT
ENDACT
      4934**LABEL    4929--CALLALT
ENDDEV
      4886**LABEL    4875--CALLALT
ENDSET
      4917**LABEL    4894--CALLALT
F$
      4775**DCL      4849--IMP-PTR  4855--IMP-PTR  4858--IMP-PTR  4947<<ASSIGN   4948>>ASSIGN   4951>>ASSIGN
      4964>>IF       4971>>IF       4972>>IF       4979>>ASSIGN   4988>>ASSIGN   4998<<ASSIGN   4999<<ASSIGN
      5000>>IF       5000>>IF       5006>>IF       5011>>ASSIGN   5018<<ASSIGN   5019>>IF       5019>>IF
      5020>>ASSIGN   5045<<ASSIGN   5046>>IF       5046>>IF       5047>>DOINDEX  5048>>IF       5136>>IF
      5145>>IF
F$CFU$
      4791**DCL      4815--IMP-PTR  4820--IMP-PTR  4825--IMP-PTR  4831--IMP-PTR  4871<>CALL     4873>>ASSIGN
      4879>>ASSIGN   4884>>ASSIGN   4886>>ASSIGN   4892>>ASSIGN   4898>>ASSIGN   4902>>ASSIGN   4906>>ASSIGN
      4907>>IF       4911>>ASSIGN   4914>>ASSIGN   4917>>ASSIGN   4919>>ASSIGN   4927>>ASSIGN   4930>>ASSIGN
      4942>>ASSIGN   4943>>DOWHILE  4944>>ASSIGN   4945>>DOWHILE  4947>>ASSIGN   4948>>ASSIGN   4953>>ASSIGN
      4955>>IF       4957>>CALLBLT  4962>>CALLBLT  4962>>CALLBLT  4984>>ASSIGN   4991>>ASSIGN   4991>>ASSIGN
      4994>>ASSIGN   4996>>ASSIGN   4998>>IF       4998>>ASSIGN   4999>>ASSIGN   5000>>IF       5014>>DOWHILE
      5018>>ASSIGN   5021>>ASSIGN   5021>>ASSIGN   5024>>ASSIGN   5026>>DOWHILE  5027>>ASSIGN   5042>>DOWHILE
      5045>>ASSIGN   5063>>DOWHILE  5075>>ASSIGN   5075>>ASSIGN   5087>>IF       5103>>IF       5121>>CALL
      5146>>IF       5157>>IF       5160>>CALL     5166>>ASSIGN   5167>>CALL     5167>>CALL
FDA_MSG
      4753**DCL      4965<>CALL
FIA_MSG
      4748**DCL      4970<>CALL
FID
      4755**DCL      4950<<ASSIGN   4952<<CALLBLT  4955<<ASSIGN   4957<<CALLBLT  4958>>CALLBLT  4959<<CALLBLT
      4961>>CALLBLT  4962<<CALLBLT  5121--CALL
FILEOUT
      4949**LABEL    5030--GOTO
FIL_HDR
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:96   
      4652**DCL      4939--ASSIGN
FIL_MSG
      4751**DCL      4976<>CALL
FLG
      4781**DCL      4965>>IF       4976>>IF       5133<<ASSIGN   5135<<ASSIGN   5137<<ASSIGN   5172<<ASSIGN
      5172>>ASSIGN
FLG.ACT
      4784**DCL      4934>>IF
FLG.DEV
      4782**DCL      4878>>IF       4883>>IF
FLG.FIA
      4786**DCL      4969>>IF       4983>>IF       5173<<ASSIGN
FLG.SET
      4783**DCL      4897>>IF       4901>>IF       4910>>IF
FLG.SNS
      4787**DCL      5054>>IF
FLG.UNU
      4788**DCL      5068>>IF
FM$CFU.ACCTX
      4850**DCL      4850--REDEF    4948>>ASSIGN   5019>>IF       5021>>ASSIGN
FM$CFU.FUN
      4849**DCL      4964>>IF       4971>>IF       5019>>IF       5136>>IF       5145>>IF
FM$CFU.NAMEX
      4850**DCL      4988>>ASSIGN   5000>>IF       5020>>ASSIGN   5027>>ASSIGN
FM$CFU.STARX.SYSID
      4850**DCL      4951>>ASSIGN
FM$CFU.XTX
      4851**DCL      4979>>ASSIGN
FM$CFUA.ACCT
      4840**DCL      4959>>CALLBLT  5163<>CALL
FM$CFUA.LINKX
      4840**DCL      4935>>ASSIGN   4984>>ASSIGN
FM$CFUA.SETX
      4840**DCL      4931>>ASSIGN   4957>>CALLBLT  5147>>ASSIGN
FM$CFUJ.TAPE
      4859**DCL      4972>>IF
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:97   
FM$CFUN
      4846**DCL      4991--ASSIGN
FM$CFUN.C
      4846**DCL      4962>>CALLBLT  5167<>CALL
FM$CFUN.L
      4846**DCL      4846--IMP-SIZ  4962>>CALLBLT  4991>>ASSIGN   5166>>ASSIGN   5167>>CALL
FM$CFUN.LNKX
      4846**DCL      4944>>ASSIGN
FM$CFUX.ACCTS
      4815**DCL      4927>>ASSIGN
FM$CFUX.CFUT
      4815**DCL      4945>>DOWHILE  4994>>ASSIGN   4998>>IF       5014>>DOWHILE  5026>>DOWHILE  5042>>DOWHILE
      5063>>DOWHILE  5087>>IF       5103>>IF
FM$CFUX.DSETH
      4816**DCL      4873>>ASSIGN
FM$CFUX.HEAD
      4817**DCL      4996>>ASSIGN   5011>>ASSIGN
FM$CFUX.NAMES
      4815**DCL      4942>>ASSIGN   5075>>ASSIGN
FM$CFUX.NAMET
      4816**DCL      5075>>ASSIGN
FM$CFUX.NAMEX
      4816**DCL      4943>>DOWHILE
FM$CFUX.SETH
      4816**DCL      4892>>ASSIGN
FM$CFUX.TAIL
      4817**DCL      5006>>IF
FM$DEV.DEVL
      4827**DCL      4886>>ASSIGN
FM$DEV.NN
      4825**DCL      5157>>IF
FM$DEV.SECTL
      4827**DCL      4879>>ASSIGN
FM$DEV.USERLIST
      4826**DCL      4827--REDEF
FM$SET
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:98   
      4820**DCL      5045--ASSIGN   5121--CALL
FM$SET.DCTX
      4820**DCL      4898>>ASSIGN   4914>>ASSIGN
FM$SET.ONEU
      4821**DCL      4907>>IF
FM$SET.PSN
      4820**DCL      4957>>CALLBLT  5160<>CALL
FM$SET.SETL
      4822**DCL      4919>>ASSIGN
FM$SET.SYSID
      4821**DCL      4906>>ASSIGN
FM$SET.USERLIST
      4821**DCL      4821--REDEF
FM$SETU.LINKX
      4837**DCL      4911>>ASSIGN
FM$VOL.SECTL
      4833**DCL      4884>>ASSIGN
FM$VOL.USERLIST
      4832**DCL      4833--REDEF
FM$VOL.VOLL
      4833**DCL      4902>>ASSIGN   4917>>ASSIGN
FORMAT
      5116**PROC     4878--CALL     4883--CALL     4897--CALL     4901--CALL     4910--CALL     4934--CALL
      4965--CALL     4970--CALL     4974--CALL     4976--CALL     4983--CALL     5054--CALL     5068--CALL
      5109--CALL     5111--CALL
FT$CFUSN.NUM
      4855**DCL      5046>>IF       5046>>IF       5047>>DOINDEX
FT$CFUSN.SN
      4855**DCL      5048>>IF
I IN PROCEDURE CHECK
      5128**DCL      5132<<ASSIGN   5140>>DOWHILE  5141>>ASSIGN   5174<<ASSIGN   5174>>ASSIGN
I IN PROCEDURE FORMAT
      5119**DCL      5120<<CALLBLT  5121>>CALL
I@ IN PROCEDURE USEDX
      5084**DCL      5079--PROC     5087>>IF       5087>>IF       5088>>ASSIGN   5089>>ASSIGN   5093--ENTRY
      5096--ENTRY    5103>>IF       5104>>ASSIGN   5105>>ASSIGN   5109<>CALL     5111<>CALL
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:99   
J IN PROCEDURE CHECK
      5127**DCL      5151<<ASSIGN   5152>>DOWHILE  5153>>ASSIGN   5156<<CALLBLT  5157>>IF       5170<<ASSIGN
      5170>>ASSIGN
JFIL_MSG
      4761**DCL      4973--ASSIGN
JTAP_MSG
      4756**DCL      4972--ASSIGN
KEY_MSG
      4763**DCL      4971--ASSIGN
L IN PROCEDURE CHECK
      5129**DCL      5166<<ASSIGN   5167<>CALL
LNK_MSG
      4767**DCL      5007--CALL
MASKS
      4807**DCL      5016>>IF       5044>>IF       5065>>IF       5090>>IF       5091>>ASSIGN   5098>>IF
      5099>>ASSIGN
MPLX IN PROCEDURE USEDX
      5111**LABEL    5090--GOTO     5098--GOTO
MPLX_MSG IN PROCEDURE USEDX
      5082**DCL      5111<>CALL
NO IN PROCEDURE CHECK
      5174**LABEL    5144--GOTO     5145--GOTO     5149--GOTO     5158--GOTO     5160--CALLALT  5163--CALLALT
      5167--CALLALT
NOTSN
      5055**LABEL    5048--GOTO     5050--GOTO
NXTDEV
      4886**LABEL    4881--CALLALT
NXTFIL
      4986**LABEL    4981--CALLALT
NXTFREE
      5031**LABEL    4987--GOTO
NXTNAM
      4985**LABEL    4946--CALLALT
NXTSET1
      4900**LABEL    4900--CALLALT
NXTSET2
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:100  
      4911**LABEL    4908--CALLALT
OBLK.CODE
      4220**DCL      5142>>DOCASE   5145>>IF       5149>>IF       5154>>DOCASE   5173>>IF
OBLK.NSUBLKS
      4224**DCL      5152>>DOWHILE
OBLK.SUBLK$
      4245**DCL      5153>>ASSIGN   5160>>CALL     5163>>CALL     5167>>CALL
OK IN PROCEDURE CHECK
      5167**LABEL    5157--GOTO
OSYM.COUNT
      4281**DCL      4284--IMP-SIZ  5156>>CALLBLT  5160<>CALL     5163<>CALL     5167<>CALL
OSYM.TEXT
      4284**DCL      5156>>CALLBLT
P$ IN PROCEDURE CHECK
      5130**DCL      5141<<ASSIGN   5142>>DOCASE   5145>>IF       5149>>IF       5152>>DOWHILE  5153>>ASSIGN
      5173>>IF
Q$ IN PROCEDURE CHECK
      5131**DCL      5153<<ASSIGN   5154>>DOCASE   5156>>CALLBLT  5156>>CALLBLT  5160>>CALL     5163>>CALL
      5167>>CALL
RETRET
      5176**LABEL    4871--CALLALT
S@
      4779**DCL      4879<<ASSIGN   4880>>DOWHILE  4881<>CALL     4883<>CALL     4884<<ASSIGN   4884>>ASSIGN
      4892<<ASSIGN   4893>>DOWHILE  4894<>CALL     4897<>CALL     4898>>ASSIGN   4906>>ASSIGN   4907>>IF
      4914>>ASSIGN   4919<<ASSIGN   4919>>ASSIGN   4931<<ASSIGN   4951<<ASSIGN   4952>>CALLBLT  4958<<CALLBLT
      4959>>CALLBLT  4961<<CALLBLT  4962>>CALLBLT  4979<<ASSIGN   4980>>DOWHILE  4981<>CALL     4983>>CALL
      4984<<ASSIGN   4984>>ASSIGN   4995<<ASSIGN   5006>>IF       5007--CALL     5010<<ASSIGN   5047<<DOINDEX
      5048>>IF       5146<<ASSIGN   5147<<ASSIGN   5160>>CALL
SET_HDR
      4596**DCL      4889--ASSIGN
SET_MSG
      4742**DCL      4897<>CALL
SID_MSG
      4744**DCL      4910<>CALL
SNS
      5029**LABEL    5000--CALLALT  5002--CALLALT  5003--CALLALT  5008--GOTO
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:101  
SN_HDR
      4680**DCL      5038--ASSIGN
SN_MSG
      4769**DCL      5054<>CALL
SUM_HDR
      4736**DCL      5073--ASSIGN
SUM_MSG
      4773**DCL      5076--CALL
TEST IN PROCEDURE USEDX
      5102**PROC     5094--CALL     5097--CALL
TSTON IN PROCEDURE USEDX
      5090**LABEL    5095--GOTO
TYPE
      4790**DCL      4872<<ASSIGN   4891<<ASSIGN   4926<<ASSIGN   4941<<ASSIGN   5040<<ASSIGN   5061<<ASSIGN
      5136>>IF       5144>>IF       5149>>IF
UNUSED IN PROCEDURE USEDX
      5096**ENTRY    4900--CALL     5002--CALL
UNU_HDR
      4708**DCL      5059--ASSIGN
UNU_MSG
      4771**DCL      5068<>CALL
USED IN PROCEDURE USEDX
      5093**ENTRY    4875--CALL     4881--CALL     4894--CALL     4916--CALL     5052--CALL
USEDX
      5079**PROC     4908--CALL     4929--CALL     4946--CALL     4981--CALL     5000--CALL     5003--CALL
      5029--CALL
VOL_HDR
      4568**DCL      4424--DCLINIT  4868--ASSIGN
VOL_MSG
      4740**DCL      4883<>CALL     4901<>CALL
WX IN PROCEDURE USEDX
      5085**DCL      5088<<ASSIGN   5090>>IF       5091>>ASSIGN   5091>>ASSIGN   5098>>IF       5099>>ASSIGN
      5099>>ASSIGN   5104<<ASSIGN
X@
      4780**DCL      4905<<ASSIGN   4915>>DOWHILE  4944<<ASSIGN   4945>>DOWHILE  4946<>CALL     4947>>ASSIGN
      4965>>CALL     4970>>CALL     4974>>CALL     4976>>CALL     4988<<ASSIGN   5013<<ASSIGN   5014>>DOWHILE
PL6.E3A0      #001=DAD$CFUS File=DAD$CFUS.:E05TSI                                TUE 07/29/97 12:39 Page:102  
      5015>>IF       5015<<ASSIGN   5015>>ASSIGN   5016>>IF       5016>>IF       5017<<ASSIGN   5017>>ASSIGN
      5018>>ASSIGN   5023>>ASSIGN   5029<>CALL     5032<<ASSIGN   5032>>ASSIGN   5034<<ASSIGN   5034>>ASSIGN
      5041<<ASSIGN   5042>>DOWHILE  5043>>IF       5043<<ASSIGN   5043>>ASSIGN   5044>>IF       5044>>IF
      5045>>ASSIGN   5052<>CALL     5054<>CALL     5056<<ASSIGN   5056>>ASSIGN   5062<<ASSIGN   5063>>DOWHILE
      5064>>IF       5064<<ASSIGN   5064>>ASSIGN   5065>>IF       5065>>IF       5067>>IF       5068<>CALL
      5070<<ASSIGN   5070>>ASSIGN
XTN_MSG
      4765**DCL      4983<>CALL
