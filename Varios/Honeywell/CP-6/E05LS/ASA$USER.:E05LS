VERSION E05

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:1    
        1        1        /*M* ASA$USER - ROUTINE TO HANDLE USER COMMAND. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        /*   ASA$USER : This module consists of procedures:
       11       11                             ASA$UNTIE_USER
       12       12                             ASA$TIE_USER
       13       13                                                               */
       14       14        ASA$UNTIE_USER: PROC( UNTIE_USER, ACCT_COUNT, REPORT ) ALTRET ;
       15       15
       16       16    1   DCL 1 UNTIE_USER,
       17       17    1          2 COUNT UBIN BYTE UNAL,
       18       18    1          2 TEXT CHAR(20);
       19       19    1   DCL ACCT_COUNT SBIN;
       20       20
       21       21    1   DCL REPORT BIT(1) ALIGNED;
       22       22    1   DCL 1 PROJECT,
       23       23    1          2 COUNT UBIN BYTE UNAL,
       24       24    1          2 TEXT CHAR(20);
       25       25    1   DCL I SBIN;
       26       26    1   DCL J SBIN;
       27       27    1   DCL K SBIN;
       28       28    1   DCL ARS SBIN;
       29       29    1   DCL READ_PROJ BIT(1);
       30       30    1   DCL PROJ_ACCT_LIST$ PTR;
       31       31
       32       32        %INCLUDE AS_ENTRIES_M  ;
       33     1082        %INCLUDE AS_SUPER_C    ;
       34     1517        %INCLUDE AS_MAC_C      ;
       35     1597        %INCLUDE KL_SUPER_C    ;
       36     4499        %INCLUDE XU_FORMAT_C   ;
       37     4661        %INCLUDE XU_MACRO_C    ;
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:2    
       38     7767        %INCLUDE AS_PERR_C     ;
       39     8369        %INCLUDE AS_SUBS_C     ;
       40     9783        %INCLUDE AS_SUPER_R    ;
       41    12799
       42    12800    1   DCL 1 ACCT$LIST(0:0) ALIGNED BASED(DSEG1$),
       43    12801    1          2 PSN CHAR(6),
       44    12802    1          2 ACCT CHAR(8),
       45    12803    1          2 GRANS UBIN;
       46    12804        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
       47    12838        %AS$PROJ_ACCT_LIST( NAME=PROJ$LIST, STCLASS="BASED(PROJ_ACCT_LIST$)" );
       48    12843
       49    12844        %ASB$READ_USERS ;
       50    12847        %ASB$WRITE_USERS ;
       51    12850        %ASB$DELREC_USERS ;
       52    12853        %ASB$GET ;
       53    12856        %ASB$READ_PROJ ;
       54    12859        %ASB$WRITE_PROJ ;
       55    12862        %ASH$ERROR ;
       56    12865        %ASH$WARN ;
       57    12868        %ASH$INFO ;
       58    12871        %ASA$KEYCONV ;
       59    12874
       60    12875
       61    12876        /*
       62    12877           Append an s to USERS_KEY.
       63    12878           Read :USERS keyed.
       64    12879           If the read returns then the object is a project and not a user.
       65    12880           We wish to disallow that.  So, issue a warning message that the
       66    12881           object is a project and will not be untied.  And then return.
       67    12882           If the read altreturns, then the object is possibly a user.
       68    12883           In which case, remove the s we added earlier, reset the count
       69    12884           on the USERS_KEY, and continue processing.
       70    12885        */
       71    12886    1   I = USERS_KEY.COUNT;
       72    12887    1   USERS_KEY = UNTIE_USER;
       73    12888    1   USERS_KEY.UKEY.S = 'S';
       74    12889    1   USERS_KEY.COUNT = 21;
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:3    
       75    12890    2   CALL ASB$READ_USERS (AS_USERS) WHENRETURN DO;
       76    12891        /*E*  ERROR:  ASA-E$PROJ_NOT_USER_UNTIE-0
       77    12892              MESSAGE:  %U1 is a project not a user.
       78    12893                        %U1 cannot be untied with an UNTIE user command.
       79    12894        */
       80    12895    2      CALL ASA$KEYCONV( UNTIE_USER, AS_FIELD1 );
       81    12896           %SCREAM (ERR#=%E$PROJ_NOT_USER_UNTIE, LEVEL=WARN, MID='A');
       82    12911    2      ALTRETURN;
       83    12912    2      END; /*  Whenreturn  */
       84    12913    1   USERS_KEY.COUNT = I;
       85    12914    1   PROJECT = AS_USERS.BUDGET.MACCT;
       86    12915    1   AS_USERS.BUDGET.MACCT = AS_PROJECT_ADMIN;
       87    12916    1   AS_DEFAULT.BUDGET.PROJ_CREATED = AS_DEFAULT.BUDGET.PROJ_CREATED - 1;
       88    12917    1   USERS_KEY = PROJECT;
       89    12918    2   IF AS_USERS.BUDGET.ICHARGES AND AS_USERS.BUDGET.PCHARGES THEN DO;
       90    12919    2      AS_PROJ_ADMIN.BUDGET.PACCUM = AS_PROJ_ADMIN.BUDGET.PACCUM
       91    12920    2           - AS_USERS.BUDGET.ACCUM;
       92    12921    2      CALL ASB$WRITE_USERS( AS_PROJ_ADMIN );
       93    12922    2      END;
       94    12923    1   USERS_KEY.UKEY.S = 'S';
       95    12924    1   USERS_KEY.COUNT = 21;
       96    12925    1   CALL ASB$WRITE_USERS( AS_DEFAULT );
       97    12926    1   CALL CONCAT( USERS_KEY.TXTC, BINASC(0), PROJECT.TEXT, AS_USERS.ACCT, AS_USERS.NAME )
             12926            ;
       98    12927    1   CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC, 29 );
       99    12928    1   USERS_KEY.COUNT = I;
      100    12929    1   CALL ASB$DELREC_USERS;
      101    12930    2   IF REPORT THEN DO;
      102    12931        /*E*  ERROR:      ASA-E$USER_UNTIED-C
      103    12932              MESSAGE:.. User "%U1" untied from project "%U2".
      104    12933        */
      105    12934    2      CALL ASA$KEYCONV( UNTIE_USER, AS_FIELD1 );
      106    12935    2      CALL ASA$KEYCONV( PROJECT,    AS_FIELD2 );
      107    12936           %SCREAM( ERR#=E$USER_UNTIED, LEVEL=INFO, MID='A' );
      108    12951    2      END;
      109    12952
      110    12953    1   I = 0;
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:4    
      111    12954    1   PROJ_KEY = PROJECT;
      112    12955    2   DO WHILE( I < ACCT_COUNT );
      113    12956    2      PROJ_KEY.TXT.PACKSET = ACCT$LIST.PSN(I);
      114    12957    2      CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );
      115    12958    2      PROJ_KEY.COUNT = J;
      116    12959    2      ARS = DSEG2SIZE;
      117    12960    2      CALL ASB$READ_PROJ( DSEG2$, ARS, 2 ) ALTRET(READ_ERR);
      118    12961    2      PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),
      119    12962    2           (AS$PROJ.ATTRIBUTES.COUNT + 5) / 4 );
      120    12963    2      READ_PROJ = '1'B;
      121    12964    3      DO WHILE( '0'B );
      122    12965    3   READ_ERR: CALL ASH$ERROR( ERR_CODE );
      123    12966    3         READ_PROJ = '0'B;
      124    12967    3         END;
      125    12968    3      DO WHILE( I < ACCT_COUNT AND ACCT$LIST.PSN(I) = PROJ_KEY.TXT.PACKSET);
      126    12969    4         IF READ_PROJ THEN DO;
      127    12970    4            J = 0;
      128    12971    5            DO WHILE( J < AS$PROJ.NUM_ACCTS  AND
      129    12972    5                 PROJ$LIST.ACCT(J) < ACCT$LIST.ACCT(I) );
      130    12973    5               J = J + 1;
      131    12974    5               END;
      132    12975    4            IF J < AS$PROJ.NUM_ACCTS  AND
      133    12976    4                 PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I)
      134    12977    5            THEN DO;
      135    12978    5               AS$PROJ.GRANS_ACCUM = AS$PROJ.GRANS_ACCUM - PROJ$LIST.GRANS(J);
      136    12979    6               DO K = J TO AS$PROJ.NUM_ACCTS-2;
      137    12980    6                  PROJ$LIST(K) = PROJ$LIST(K+1);
      138    12981    6                  END;
      139    12982    5               AS$PROJ.NUM_ACCTS = AS$PROJ.NUM_ACCTS - 1;
      140    12983    5               END;
      141    12984    4            END;
      142    12985    3         I = I + 1;
      143    12986    3         END;
      144    12987    2      CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(WRITE_ERR);
      145    12988    3      DO WHILE( '0'B );
      146    12989    3   WRITE_ERR: CALL ASH$ERROR( ERR_CODE );
      147    12990    3         END;
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:5    
      148    12991    2      END;
      149    12992
      150    12993    1   EXIT#: RETURN;
      151    12994
      152    12995    1   END ASA$UNTIE_USER;
      153    12996        %EOD;

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:6    
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$UNTIE_USER.

   Procedure ASA$UNTIE_USER requires 247 words for executable code.
   Procedure ASA$UNTIE_USER requires 22 words of local(AUTO) storage.

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:7    

 Object Unit name= ASA$UNTIE_USER                             File name= ASA$USER.:E05TOU
 UTS= JUL 29 '97 08:54:06.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      2      2  ASA$UNTIE_USER
    2   Proc  even  none   247    367  ASA$UNTIE_USER
    3  RoData even  none    10     12  ASA$UNTIE_USER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        3  ASA$UNTIE_USER
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:8    

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       1 ASB$READ_USERS
 yes     yes           Std       1 ASB$WRITE_USERS
         yes           Std       2 ASA$KEYCONV
 yes     yes           Std       0 ASB$DELREC_USERS
         yes           Std       2 ASH$INFO
 yes     yes           Std       3 ASB$READ_PROJ
 yes     yes           Std       2 ASB$WRITE_PROJ
         yes           Std       2 ASH$WARN
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             PROJ_KEY
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                DSEG2$                                DSEG2SIZE
     AS_PROJECT_ADMIN                      AS_USERS                              AS_DEFAULT
     AS_PROJ_ADMIN                         B_VECTNIL
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:9    

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:10   


        1        1        /*M* ASA$USER - ROUTINE TO HANDLE USER COMMAND. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        /*   ASA$USER : This module consists of procedures:
       11       11                             ASA$UNTIE_USER
       12       12                             ASA$TIE_USER
       13       13                                                               */
       14       14        ASA$UNTIE_USER: PROC( UNTIE_USER, ACCT_COUNT, REPORT ) ALTRET ;

     14  2 000000   000000 700200 xent  ASA$UNTIE_U* TSX0  ! X66_AUTO_3
         2 000001   000026 000003                    ZERO    22,3

       15       15
       16       16    1   DCL 1 UNTIE_USER,
       17       17    1          2 COUNT UBIN BYTE UNAL,
       18       18    1          2 TEXT CHAR(20);
       19       19    1   DCL ACCT_COUNT SBIN;
       20       20
       21       21    1   DCL REPORT BIT(1) ALIGNED;
       22       22    1   DCL 1 PROJECT,
       23       23    1          2 COUNT UBIN BYTE UNAL,
       24       24    1          2 TEXT CHAR(20);
       25       25    1   DCL I SBIN;
       26       26    1   DCL J SBIN;
       27       27    1   DCL K SBIN;
       28       28    1   DCL ARS SBIN;
       29       29    1   DCL READ_PROJ BIT(1);
       30       30    1   DCL PROJ_ACCT_LIST$ PTR;
       31       31
       32       32        %INCLUDE AS_ENTRIES_M  ;
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:11   
       33     1082        %INCLUDE AS_SUPER_C    ;
       34     1517        %INCLUDE AS_MAC_C      ;
       35     1597        %INCLUDE KL_SUPER_C    ;
       36     4499        %INCLUDE XU_FORMAT_C   ;
       37     4661        %INCLUDE XU_MACRO_C    ;
       38     7767        %INCLUDE AS_PERR_C     ;
       39     8369        %INCLUDE AS_SUBS_C     ;
       40     9783        %INCLUDE AS_SUPER_R    ;
       41    12799
       42    12800    1   DCL 1 ACCT$LIST(0:0) ALIGNED BASED(DSEG1$),
       43    12801    1          2 PSN CHAR(6),
       44    12802    1          2 ACCT CHAR(8),
       45    12803    1          2 GRANS UBIN;
       46    12804        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
       47    12838        %AS$PROJ_ACCT_LIST( NAME=PROJ$LIST, STCLASS="BASED(PROJ_ACCT_LIST$)" );
       48    12843
       49    12844        %ASB$READ_USERS ;
       50    12847        %ASB$WRITE_USERS ;
       51    12850        %ASB$DELREC_USERS ;
       52    12853        %ASB$GET ;
       53    12856        %ASB$READ_PROJ ;
       54    12859        %ASB$WRITE_PROJ ;
       55    12862        %ASH$ERROR ;
       56    12865        %ASH$WARN ;
       57    12868        %ASH$INFO ;
       58    12871        %ASA$KEYCONV ;
       59    12874
       60    12875
       61    12876        /*
       62    12877           Append an s to USERS_KEY.
       63    12878           Read :USERS keyed.
       64    12879           If the read returns then the object is a project and not a user.
       65    12880           We wish to disallow that.  So, issue a warning message that the
       66    12881           object is a project and will not be untied.  And then return.
       67    12882           If the read altreturns, then the object is possibly a user.
       68    12883           In which case, remove the s we added earlier, reset the count
       69    12884           on the USERS_KEY, and continue processing.
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:12   
       70    12885        */
       71    12886    1   I = USERS_KEY.COUNT;

  12886  2 000002   000000 236000 xsym               LDQ     USERS_KEY
         2 000003   000033 772000                    QRL     27
         2 000004   200014 756100                    STQ     I,,AUTO

       72    12887    1   USERS_KEY = UNTIE_USER;

  12887  2 000005   200003 470500                    LDP0    @UNTIE_USER,,AUTO
         2 000006   000000 100500                    MLR     fill='000'O
         2 000007   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         2 000010   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

       73    12888    1   USERS_KEY.UKEY.S = 'S';

  12888  2 000011   000123 236003                    LDQ     83,DU
         2 000012   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

       74    12889    1   USERS_KEY.COUNT = 21;

  12889  2 000013   025000 236003                    LDQ     10752,DU
         2 000014   000000 552040 xsym               STBQ    USERS_KEY,'40'O

       75    12890    2   CALL ASB$READ_USERS (AS_USERS) WHENRETURN DO;

  12890  2 000015   000000 630400 3                  EPPR0   0
         2 000016   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000017   000000 701000 xent               TSX1    ASB$READ_USERS
         2 000020   000035 702000 2                  TSX2    s:12913

       76    12891        /*E*  ERROR:  ASA-E$PROJ_NOT_USER_UNTIE-0
       77    12892              MESSAGE:  %U1 is a project not a user.
       78    12893                        %U1 cannot be untied with an UNTIE user command.
       79    12894        */
       80    12895    2      CALL ASA$KEYCONV( UNTIE_USER, AS_FIELD1 );

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:13   
  12895  2 000021   000001 236000 3                  LDQ     1
         2 000022   200003 235100                    LDA     @UNTIE_USER,,AUTO
         2 000023   200022 757100                    STAQ    PROJ_ACCT_LIST$+1,,AUTO
         2 000024   200022 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000025   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000026   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000027   000000 011000                    NOP     0

       81    12896           %SCREAM (ERR#=%E$PROJ_NOT_USER_UNTIE, LEVEL=WARN, MID='A');

  12906  2 000030   000002 630400 3                  EPPR0   2
         2 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000032   000000 701000 xent               TSX1    ASH$WARN
         2 000033   000000 011000                    NOP     0

       82    12911    2      ALTRETURN;

  12911  2 000034   000000 702200 xent               TSX2  ! X66_AALT

       83    12912    2      END; /*  Whenreturn  */
       84    12913    1   USERS_KEY.COUNT = I;

  12913  2 000035   200014 236100                    LDQ     I,,AUTO
         2 000036   000033 736000                    QLS     27
         2 000037   000000 552040 xsym               STBQ    USERS_KEY,'40'O

       85    12914    1   PROJECT = AS_USERS.BUDGET.MACCT;

  12914  2 000040   000100 100400                    MLR     fill='000'O
         2 000041   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
         2 000042   200006 000025                    ADSC9   PROJECT,,AUTO            cn=0,n=21

       86    12915    1   AS_USERS.BUDGET.MACCT = AS_PROJECT_ADMIN;

  12915  2 000043   000000 100400                    MLR     fill='000'O
         2 000044   000000 000025 xsym               ADSC9   AS_PROJECT_ADMIN         cn=0,n=21
         2 000045   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:14   

       87    12916    1   AS_DEFAULT.BUDGET.PROJ_CREATED = AS_DEFAULT.BUDGET.PROJ_CREATED - 1;

  12916  2 000046   000001 336007                    LCQ     1,DL
         2 000047   000011 056000 xsym               ASQ     AS_DEFAULT+9

       88    12917    1   USERS_KEY = PROJECT;

  12917  2 000050   000000 100500                    MLR     fill='000'O
         2 000051   200006 000025                    ADSC9   PROJECT,,AUTO            cn=0,n=21
         2 000052   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

       89    12918    2   IF AS_USERS.BUDGET.ICHARGES AND AS_USERS.BUDGET.PCHARGES THEN DO;

  12918  2 000053   000017 236000 xsym               LDQ     AS_USERS+15
         2 000054   000040 316003                    CANQ    32,DU
         2 000055   000067 600000 2                  TZE     s:12923
         2 000056   000100 316003                    CANQ    64,DU
         2 000057   000067 600000 2                  TZE     s:12923

       90    12919    2      AS_PROJ_ADMIN.BUDGET.PACCUM = AS_PROJ_ADMIN.BUDGET.PACCUM

  12919  2 000060   000011 236000 xsym               LDQ     AS_PROJ_ADMIN+9
         2 000061   000007 136000 xsym               SBLQ    AS_USERS+7
         2 000062   000011 756000 xsym               STQ     AS_PROJ_ADMIN+9

       91    12920    2           - AS_USERS.BUDGET.ACCUM;
       92    12921    2      CALL ASB$WRITE_USERS( AS_PROJ_ADMIN );

  12921  2 000063   000003 630400 3                  EPPR0   3
         2 000064   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000065   000000 701000 xent               TSX1    ASB$WRITE_USERS
         2 000066   000000 011000                    NOP     0

       93    12922    2      END;

       94    12923    1   USERS_KEY.UKEY.S = 'S';
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:15   

  12923  2 000067   000123 236003                    LDQ     83,DU
         2 000070   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

       95    12924    1   USERS_KEY.COUNT = 21;

  12924  2 000071   025000 236003                    LDQ     10752,DU
         2 000072   000000 552040 xsym               STBQ    USERS_KEY,'40'O

       96    12925    1   CALL ASB$WRITE_USERS( AS_DEFAULT );

  12925  2 000073   000004 630400 3                  EPPR0   4
         2 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000075   000000 701000 xent               TSX1    ASB$WRITE_USERS
         2 000076   000000 011000                    NOP     0

       97    12926    1  CALL CONCAT( USERS_KEY.TXTC, BINASC(0), PROJECT.TEXT, AS_USERS.ACCT, AS_USERS.NAME )
             12926            ;

  12926  2 000077   000000 236003                    LDQ     0,DU
         2 000100   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         2 000101   040000 100500                    MLR     fill='040'O
         2 000102   200006 200024                    ADSC9   PROJECT,,AUTO            cn=1,n=20
         2 000103   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         2 000104   040000 100400                    MLR     fill='040'O
         2 000105   000000 000010 xsym               ADSC9   AS_USERS                 cn=0,n=8
         2 000106   000005 400010 xsym               ADSC9   USERS_KEY+5              cn=2,n=8
         2 000107   040000 100400                    MLR     fill='040'O
         2 000110   000002 000014 xsym               ADSC9   AS_USERS+2               cn=0,n=12
         2 000111   000007 400014 xsym               ADSC9   USERS_KEY+7              cn=2,n=12

       98    12927    1   CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC, 29 );

  12927  2 000112   000000 124400                    SCM     mask='000'O
         2 000113   000007 400014 xsym               ADSC9   USERS_KEY+7              cn=2,n=12
         2 000114   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000115   200014 000100                    ARG     I,,AUTO
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:16   
         2 000116   000035 236007                    LDQ     29,DL
         2 000117   200014 056100                    ASQ     I,,AUTO

       99    12928    1   USERS_KEY.COUNT = I;

  12928  2 000120   200014 236100                    LDQ     I,,AUTO
         2 000121   000033 736000                    QLS     27
         2 000122   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      100    12929    1   CALL ASB$DELREC_USERS;

  12929  2 000123   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000124   000000 701000 xent               TSX1    ASB$DELREC_USERS
         2 000125   000000 011000                    NOP     0

      101    12930    2   IF REPORT THEN DO;

  12930  2 000126   200005 470500                    LDP0    @REPORT,,AUTO
         2 000127   000000 234100                    SZN     0,,PR0
         2 000130   000154 605000 2                  TPL     s:12953

      102    12931        /*E*  ERROR:      ASA-E$USER_UNTIED-C
      103    12932              MESSAGE:.. User "%U1" untied from project "%U2".
      104    12933        */
      105    12934    2      CALL ASA$KEYCONV( UNTIE_USER, AS_FIELD1 );

  12934  2 000131   000001 236000 3                  LDQ     1
         2 000132   200003 235100                    LDA     @UNTIE_USER,,AUTO
         2 000133   200022 757100                    STAQ    PROJ_ACCT_LIST$+1,,AUTO
         2 000134   200022 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000135   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000136   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000137   000000 011000                    NOP     0

      106    12935    2      CALL ASA$KEYCONV( PROJECT,    AS_FIELD2 );

  12935  2 000140   000005 236000 3                  LDQ     5
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:17   
         2 000141   200023 756100                    STQ     PROJ_ACCT_LIST$+2,,AUTO
         2 000142   200006 630500                    EPPR0   PROJECT,,AUTO
         2 000143   200022 450500                    STP0    PROJ_ACCT_LIST$+1,,AUTO
         2 000144   200022 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000145   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000146   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000147   000000 011000                    NOP     0

      107    12936           %SCREAM( ERR#=E$USER_UNTIED, LEVEL=INFO, MID='A' );

  12944  2 000150   000006 630400 3                  EPPR0   6
         2 000151   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000152   000000 701000 xent               TSX1    ASH$INFO
         2 000153   000000 011000                    NOP     0

      108    12951    2      END;

      109    12952
      110    12953    1   I = 0;

  12953  2 000154   200014 450100                    STZ     I,,AUTO

      111    12954    1   PROJ_KEY = PROJECT;

  12954  2 000155   000000 100500                    MLR     fill='000'O
         2 000156   200006 000025                    ADSC9   PROJECT,,AUTO            cn=0,n=21
         2 000157   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

      112    12955    2   DO WHILE( I < ACCT_COUNT );

  12955  2 000160   200004 470500                    LDP0    @ACCT_COUNT,,AUTO
         2 000161   200014 236100                    LDQ     I,,AUTO
         2 000162   000000 116100                    CMPQ    0,,PR0
         2 000163   000366 605000 2                  TPL     EXIT#

      113    12956    2      PROJ_KEY.TXT.PACKSET = ACCT$LIST.PSN(I);

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:18   
  12956  2 000164   200014 236100                    LDQ     I,,AUTO
         2 000165   000024 402007                    MPY     20,DL
         2 000166   000000 470400 xsym               LDP0    DSEG1$
         2 000167   040000 100506                    MLR     fill='040'O
         2 000170   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         2 000171   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      114    12957    2      CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );

  12957  2 000172   000000 124400                    SCM     mask='000'O
         2 000173   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000174   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000175   200015 000100                    ARG     J,,AUTO
         2 000176   000024 236007                    LDQ     20,DL
         2 000177   200015 056100                    ASQ     J,,AUTO

      115    12958    2      PROJ_KEY.COUNT = J;

  12958  2 000200   200015 236100                    LDQ     J,,AUTO
         2 000201   000033 736000                    QLS     27
         2 000202   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      116    12959    2      ARS = DSEG2SIZE;

  12959  2 000203   000000 235000 xsym               LDA     DSEG2SIZE
         2 000204   200017 755100                    STA     ARS,,AUTO

      117    12960    2      CALL ASB$READ_PROJ( DSEG2$, ARS, 2 ) ALTRET(READ_ERR);

  12960  2 000205   000007 236000 3                  LDQ     7
         2 000206   200024 756100                    STQ     PROJ_ACCT_LIST$+3,,AUTO
         2 000207   200017 631500                    EPPR1   ARS,,AUTO
         2 000210   200023 451500                    STP1    PROJ_ACCT_LIST$+2,,AUTO
         2 000211   000010 236000 3                  LDQ     8
         2 000212   200022 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000213   200022 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000214   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:19   
         2 000215   000000 701000 xent               TSX1    ASB$READ_PROJ
         2 000216   000233 702000 2                  TSX2    READ_ERR

      118    12961    2      PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),

  12961  2 000217   000000 470400 xsym               LDP0    DSEG2$
         2 000220   000014 236100                    LDQ     12,,PR0
         2 000221   000022 772000                    QRL     18
         2 000222   000005 036007                    ADLQ    5,DL
         2 000223   000002 772000                    QRL     2
         2 000224   000022 736000                    QLS     18
         2 000225   000014 036003                    ADLQ    12,DU
         2 000226   000000 036000 xsym               ADLQ    DSEG2$
         2 000227   200021 756100                    STQ     PROJ_ACCT_LIST$,,AUTO

      119    12962    2           (AS$PROJ.ATTRIBUTES.COUNT + 5) / 4 );
      120    12963    2      READ_PROJ = '1'B;

  12963  2 000230   400000 236003                    LDQ     -131072,DU
         2 000231   200020 756100                    STQ     READ_PROJ,,AUTO

      121    12964    3      DO WHILE( '0'B );

  12964  2 000232   000240 710000 2                  TRA     s:12968

      122    12965    3   READ_ERR: CALL ASH$ERROR( ERR_CODE );

  12965  2 000233   000011 630400 3     READ_ERR     EPPR0   9
         2 000234   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000235   000000 701000 xent               TSX1    ASH$ERROR
         2 000236   000000 011000                    NOP     0

      123    12966    3         READ_PROJ = '0'B;

  12966  2 000237   200020 450100                    STZ     READ_PROJ,,AUTO

      124    12967    3         END;
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:20   

      125    12968    3      DO WHILE( I < ACCT_COUNT AND ACCT$LIST.PSN(I) = PROJ_KEY.TXT.PACKSET);

  12968  2 000240   000333 710000 2                  TRA     s:12986

      126    12969    4         IF READ_PROJ THEN DO;

  12969  2 000241   200020 234100                    SZN     READ_PROJ,,AUTO
         2 000242   000332 605000 2                  TPL     s:12985

      127    12970    4            J = 0;

  12970  2 000243   200015 450100                    STZ     J,,AUTO

      128    12971    5            DO WHILE( J < AS$PROJ.NUM_ACCTS  AND

  12971  2 000244   000246 710000 2                  TRA     s:12974

      129    12972    5                 PROJ$LIST.ACCT(J) < ACCT$LIST.ACCT(I) );
      130    12973    5               J = J + 1;

  12973  2 000245   200015 054100                    AOS     J,,AUTO

      131    12974    5               END;

  12974  2 000246   000000 470400 xsym               LDP0    DSEG2$
         2 000247   200015 236100                    LDQ     J,,AUTO
         2 000250   000013 116100                    CMPQ    11,,PR0
         2 000251   000265 605000 2                  TPL     s:12975
         2 000252   000014 402007                    MPY     12,DL
         2 000253   200022 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000254   200014 236100                    LDQ     I,,AUTO
         2 000255   000024 402007                    MPY     20,DL
         2 000256   200021 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         2 000257   200022 235100                    LDA     PROJ_ACCT_LIST$+1,,AUTO
         2 000260   000000 473400 xsym               LDP3    DSEG1$
         2 000261   040106 106505                    CMPC    fill='040'O
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:21   
         2 000262   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         2 000263   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         2 000264   000245 602000 2                  TNC     s:12973

      132    12975    4            IF J < AS$PROJ.NUM_ACCTS  AND

  12975  2 000265   200015 236100                    LDQ     J,,AUTO
         2 000266   000013 116100                    CMPQ    11,,PR0
         2 000267   000332 605000 2                  TPL     s:12985
         2 000270   000014 402007                    MPY     12,DL
         2 000271   200022 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000272   200014 236100                    LDQ     I,,AUTO
         2 000273   000024 402007                    MPY     20,DL
         2 000274   200021 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         2 000275   200022 235100                    LDA     PROJ_ACCT_LIST$+1,,AUTO
         2 000276   000000 473400 xsym               LDP3    DSEG1$
         2 000277   040106 106505                    CMPC    fill='040'O
         2 000300   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         2 000301   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         2 000302   000332 601000 2                  TNZ     s:12985

      133    12976    4                 PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I)
      134    12977    5            THEN DO;

      135    12978    5               AS$PROJ.GRANS_ACCUM = AS$PROJ.GRANS_ACCUM - PROJ$LIST.GRANS(J);

  12978  2 000303   200015 236100                    LDQ     J,,AUTO
         2 000304   000003 402007                    MPY     3,DL
         2 000305   000000 620006                    EAX0    0,QL
         2 000306   000007 236100                    LDQ     7,,PR0
         2 000307   100002 136110                    SBLQ    2,X0,PR1
         2 000310   000007 756100                    STQ     7,,PR0

      136    12979    6               DO K = J TO AS$PROJ.NUM_ACCTS-2;

  12979  2 000311   200015 235100                    LDA     J,,AUTO
         2 000312   200016 755100                    STA     K,,AUTO
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:22   
         2 000313   000323 710000 2                  TRA     s:12981+1

      137    12980    6                  PROJ$LIST(K) = PROJ$LIST(K+1);

  12980  2 000314   200016 236100                    LDQ     K,,AUTO
         2 000315   000014 402007                    MPY     12,DL
         2 000316   200021 470500                    LDP0    PROJ_ACCT_LIST$,,AUTO
         2 000317   000106 100506                    MLR     fill='000'O
         2 000320   000003 000014                    ADSC9   3,Q,PR0                  cn=0,n=12
         2 000321   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12

      138    12981    6                  END;

  12981  2 000322   200016 054100                    AOS     K,,AUTO
         2 000323   000000 470400 xsym               LDP0    DSEG2$
         2 000324   000013 236100                    LDQ     11,,PR0
         2 000325   000002 136007                    SBLQ    2,DL
         2 000326   200016 116100                    CMPQ    K,,AUTO
         2 000327   000314 605000 2                  TPL     s:12980

      139    12982    5               AS$PROJ.NUM_ACCTS = AS$PROJ.NUM_ACCTS - 1;

  12982  2 000330   000001 336007                    LCQ     1,DL
         2 000331   000013 056100                    ASQ     11,,PR0

      140    12983    5               END;

      141    12984    4            END;

      142    12985    3         I = I + 1;

  12985  2 000332   200014 054100                    AOS     I,,AUTO

      143    12986    3         END;

  12986  2 000333   200004 470500                    LDP0    @ACCT_COUNT,,AUTO
         2 000334   200014 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:23   
         2 000335   000000 116100                    CMPQ    0,,PR0
         2 000336   000345 605000 2                  TPL     s:12987
         2 000337   000024 402007                    MPY     20,DL
         2 000340   000000 471400 xsym               LDP1    DSEG1$
         2 000341   040000 106506                    CMPC    fill='040'O
         2 000342   100000 000006                    ADSC9   0,Q,PR1                  cn=0,n=6
         2 000343   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000344   000241 600000 2                  TZE     s:12969

      144    12987    2      CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(WRITE_ERR);

  12987  2 000345   200017 631500                    EPPR1   ARS,,AUTO
         2 000346   200023 451500                    STP1    PROJ_ACCT_LIST$+2,,AUTO
         2 000347   000010 236000 3                  LDQ     8
         2 000350   200022 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000351   200022 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000352   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000353   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         2 000354   000356 702000 2                  TSX2    WRITE_ERR

      145    12988    3      DO WHILE( '0'B );

  12988  2 000355   000362 710000 2                  TRA     s:12991

      146    12989    3   WRITE_ERR: CALL ASH$ERROR( ERR_CODE );

  12989  2 000356   000011 630400 3     WRITE_ERR    EPPR0   9
         2 000357   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000360   000000 701000 xent               TSX1    ASH$ERROR
         2 000361   000000 011000                    NOP     0

      147    12990    3         END;

      148    12991    2      END;

  12991  2 000362   200004 470500                    LDP0    @ACCT_COUNT,,AUTO
         2 000363   200014 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:24   
         2 000364   000000 116100                    CMPQ    0,,PR0
         2 000365   000164 604000 2                  TMI     s:12956

      149    12992
      150    12993    1   EXIT#: RETURN;

  12993  2 000366   000000 702200 xent  EXIT#        TSX2  ! X66_ARET
      151    12994
      152    12995    1   END ASA$UNTIE_USER;
      153    12996        %EOD;

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:25   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$UNTIE_USER.
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:26   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ACCT_COUNT                5-0-0/w PTR         r     1 @REPORT
     3-0-0/w PTR         r     1 @UNTIE_USER               *0-0-0/w SBIN        r     1 ACCT_COUNT
    17-0-0/w SBIN        r     1 ARS                       14-0-0/w SBIN        r     1 I
    15-0-0/w SBIN        r     1 J                         16-0-0/w SBIN        r     1 K
     6-0-0/c STRC(189)   r     1 PROJECT                   21-0-0/w PTR         r     1 PROJ_ACCT_LIST$
    20-0-0/b BIT         r     1 READ_PROJ                 *0-0-0/w BIT         r     1 REPORT
    *0-0-0/c STRC(189)   r     1 UNTIE_USER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w STRC(18576) r     1 AS_DEFAULT
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/c STRC(189)   r     1 AS_PROJECT_ADMIN           0-0-0/w STRC(18576) r     1 AS_PROJ_ADMIN
     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w UBIN        r     1 DSEG2SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/c STRC(243)   r     1 PROJ_KEY
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ACCT$LIST(0:0)
     0-0-0/w ASTR(468)   r     1 AS$PROJ
     0-0-0/w STRC(108)   r     1 PROJ$LIST(0:0)

PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:27   

   Procedure ASA$UNTIE_USER requires 247 words for executable code.
   Procedure ASA$UNTIE_USER requires 22 words of local(AUTO) storage.
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:28   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:29   
          MINI XREF LISTING

ACCT$LIST.ACCT
     12802**DCL     12971>>DOWHILE 12975>>IF
ACCT$LIST.PSN
     12801**DCL     12956>>ASSIGN  12968>>DOWHILE
ACCT_COUNT
        19**DCL        14--PROC    12955>>DOWHILE 12968>>DOWHILE
ARS
        28**DCL     12959<<ASSIGN  12960<>CALL    12987<>CALL
AS$PROJ.ATTRIBUTES
     12834**DCL     12961--ASSIGN
AS$PROJ.ATTRIBUTES.COUNT
     12835**DCL     12836--IMP-SIZ 12961>>ASSIGN
AS$PROJ.GRANS_ACCUM
     12826**DCL     12978<<ASSIGN  12978>>ASSIGN
AS$PROJ.NUM_ACCTS
     12832**DCL     12971>>DOWHILE 12975>>IF      12979>>DOINDEX 12982<<ASSIGN  12982>>ASSIGN
ASA$KEYCONV
     12872**DCL-ENT 12895--CALL    12934--CALL    12935--CALL
ASA_BRKS_LOC
      9947**DCL      9947--REDEF
ASB$DELREC_USERS
     12851**DCL-ENT 12929--CALL
ASB$READ_PROJ
     12857**DCL-ENT 12960--CALL
ASB$READ_USERS
     12845**DCL-ENT 12890--CALL
ASB$WRITE_PROJ
     12860**DCL-ENT 12987--CALL
ASB$WRITE_USERS
     12848**DCL-ENT 12921--CALL    12925--CALL
ASH$ERROR
     12863**DCL-ENT 12965--CALL    12989--CALL
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:30   
ASH$INFO
     12869**DCL-ENT 12944--CALL
ASH$WARN
     12866**DCL-ENT 12906--CALL
AS_BLANK
      9807**DCL     12927>>CALLBLT 12957>>CALLBLT
AS_DEFAULT
     10525**DCL     12925<>CALL
AS_DEFAULT.BANNER_PERM
     10640**DCL     10641--REDEF
AS_DEFAULT.BUDGET.MACCT
     10545**DCL     10549--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10558**DCL     10561--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10541**DCL     10543--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10536**DCL     10538--REDEF
AS_DEFAULT.BUDGET.PROJ_CREATED
     10543**DCL     12916<<ASSIGN  12916>>ASSIGN
AS_DEFAULT.SETUP_CHRA.TXT
     10656**DCL     10657--REDEF   10658--REDEF
AS_DEFAULT_DREC.PASSWORD
     11910**DCL     11914--REDEF
AS_DEFAULT_DREC.RENAME
     11933**DCL     11934--REDEF
AS_DFLT.BANNER_PERM
     10462**DCL     10463--REDEF
AS_DFLT.BUDGET.MACCT
     10367**DCL     10371--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10380**DCL     10383--REDEF
AS_DFLT.BUDGET.PACCUM
     10363**DCL     10365--REDEF
AS_DFLT.BUDGET.PMAXC
     10358**DCL     10360--REDEF
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:31   
AS_DFLT.SETUP_CHRA.TXT
     10478**DCL     10479--REDEF   10480--REDEF
AS_FE_MODE
      9813**DCL      9814--REDEF
AS_FIELD1
      9943**DCL     12895<>CALL    12934<>CALL
AS_FIELD2
      9944**DCL     12935<>CALL
AS_MODE
      9810**DCL      9812--REDEF
AS_MOD_USER.ACCESS
     12675**DCL     12676--REDEF
AS_MOD_USER.BANNER
     12662**DCL     12663--REDEF
AS_MOD_USER.BANNER_PERM
     12664**DCL     12665--REDEF
AS_MOD_USER.BILL
     12670**DCL     12671--REDEF
AS_MOD_USER.CPROC
     12666**DCL     12667--REDEF
AS_MOD_USER.FEBILL
     12746**DCL     12747--REDEF
AS_MOD_USER.FECXTMEM
     12763**DCL     12764--REDEF
AS_MOD_USER.FEMINTS
     12748**DCL     12749--REDEF
AS_MOD_USER.FEMMEM
     12759**DCL     12760--REDEF
AS_MOD_USER.FEMTIME
     12757**DCL     12758--REDEF
AS_MOD_USER.FEPPRIV
     12754**DCL     12756--REDEF
AS_MOD_USER.FEPRIV
     12751**DCL     12753--REDEF
AS_MOD_USER.FORCE_BIT
     12660**DCL     12661--REDEF
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:32   
AS_MOD_USER.KEY
     12742**DCL     12744--REDEF
AS_MOD_USER.LASTCPROC
     12668**DCL     12669--REDEF
AS_MOD_USER.LIMITS.DO_
     12716**DCL     12717--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12732**DCL     12733--REDEF
AS_MOD_USER.LIMITS.LO
     12712**DCL     12713--REDEF
AS_MOD_USER.LIMITS.MEM
     12708**DCL     12709--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12736**DCL     12737--REDEF
AS_MOD_USER.LIMITS.PDIS
     12724**DCL     12725--REDEF
AS_MOD_USER.LIMITS.PO
     12720**DCL     12721--REDEF
AS_MOD_USER.LIMITS.TDIS
     12728**DCL     12729--REDEF
AS_MOD_USER.LIMITS.TIME
     12704**DCL     12705--REDEF
AS_MOD_USER.MAXENQ
     12685**DCL     12686--REDEF
AS_MOD_USER.PERM_BIT
     12658**DCL     12659--REDEF
AS_MOD_USER.PPRIV
     12680**DCL     12682--REDEF
AS_MOD_USER.PRIOB
     12687**DCL     12688--REDEF
AS_MOD_USER.PRIV
     12677**DCL     12679--REDEF
AS_MOD_USER.QUAN
     12683**DCL     12684--REDEF
AS_MOD_USER.SETUP
     12656**DCL     12657--REDEF
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:33   
AS_PROJECT.BANNER_PERM
     10996**DCL     10997--REDEF
AS_PROJECT.BUDGET.MACCT
     10901**DCL     10905--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10914**DCL     10917--REDEF
AS_PROJECT.BUDGET.PACCUM
     10897**DCL     10899--REDEF
AS_PROJECT.BUDGET.PMAXC
     10892**DCL     10894--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11012**DCL     11013--REDEF   11014--REDEF
AS_PROJECT_ADMIN
      9951**DCL     12915>>ASSIGN
AS_PROJECT_DFLT.BANNER_PERM
     11174**DCL     11175--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11079**DCL     11083--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11092**DCL     11095--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11075**DCL     11077--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11070**DCL     11072--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11190**DCL     11191--REDEF   11192--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12396**DCL     12400--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12419**DCL     12420--REDEF
AS_PROJECT_DREC.PASSWORD
     12234**DCL     12238--REDEF
AS_PROJECT_DREC.RENAME
     12257**DCL     12258--REDEF
AS_PROJ_ADMIN
     10703**DCL     12921<>CALL
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:34   
AS_PROJ_ADMIN.BANNER_PERM
     10818**DCL     10819--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10723**DCL     10727--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10736**DCL     10739--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10719**DCL     10721--REDEF   12919<<ASSIGN  12919>>ASSIGN
AS_PROJ_ADMIN.BUDGET.PMAXC
     10714**DCL     10716--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10834**DCL     10835--REDEF   10836--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12072**DCL     12076--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12095**DCL     12096--REDEF
AS_USERS
     10169**DCL     12890<>CALL
AS_USERS.ACCT
     10170**DCL     12926>>CALLBLT
AS_USERS.BANNER_PERM
     10284**DCL     10285--REDEF
AS_USERS.BUDGET.ACCUM
     10179**DCL     12919>>ASSIGN
AS_USERS.BUDGET.ICHARGES
     10199**DCL     12918>>IF
AS_USERS.BUDGET.MACCT
     10189**DCL     10193--REDEF   12914>>ASSIGN  12915<<ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
     10202**DCL     10205--REDEF
AS_USERS.BUDGET.PACCUM
     10185**DCL     10187--REDEF
AS_USERS.BUDGET.PCHARGES
     10198**DCL     12918>>IF
AS_USERS.BUDGET.PMAXC
     10180**DCL     10182--REDEF
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:35   
AS_USERS.NAME
     10171**DCL     12926>>CALLBLT
AS_USERS.SETUP_CHRA.TXT
     10300**DCL     10301--REDEF   10302--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11352**DCL     11353--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11257**DCL     11261--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11270**DCL     11273--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11253**DCL     11255--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11248**DCL     11250--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11368**DCL     11369--REDEF   11370--REDEF
DSEG1$
      9948**DCL     12800--IMP-PTR 12956>>ASSIGN  12968>>DOWHILE 12971>>DOWHILE 12975>>IF
DSEG2$
      9949**DCL     12815--IMP-PTR 12960<>CALL    12961>>ASSIGN  12961>>ASSIGN  12971>>DOWHILE 12975>>IF
     12978>>ASSIGN  12978>>ASSIGN  12979>>DOINDEX 12982>>ASSIGN  12982>>ASSIGN  12987<>CALL
DSEG2SIZE
      9949**DCL     12959>>ASSIGN
ERR_CODE
      9942**DCL      9943--REDEF   12965<>CALL    12989<>CALL
I
        25**DCL     12886<<ASSIGN  12913>>ASSIGN  12927<<CALLBLT 12928>>ASSIGN  12953<<ASSIGN  12955>>DOWHILE
     12956>>ASSIGN  12968>>DOWHILE 12968>>DOWHILE 12971>>DOWHILE 12975>>IF      12985<<ASSIGN  12985>>ASSIGN
J
        26**DCL     12957<<CALLBLT 12958>>ASSIGN  12970<<ASSIGN  12971>>DOWHILE 12971>>DOWHILE 12973<<ASSIGN
     12973>>ASSIGN  12975>>IF      12975>>IF      12978>>ASSIGN  12979>>DOINDEX
K
        27**DCL     12979<<DOINDEX 12980>>ASSIGN  12980>>ASSIGN
KL_DEFAULT.PASSWORD
     12558**DCL     12562--REDEF
KL_DEFAULT.RENAME
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:36   
     12581**DCL     12582--REDEF
KL_DFLT.PASSWORD
     11748**DCL     11752--REDEF
KL_DFLT.RENAME
     11771**DCL     11772--REDEF
KL_DREC.PASSWORD
     11586**DCL     11590--REDEF
KL_DREC.RENAME
     11609**DCL     11610--REDEF
KL_DREC_CNT.PASSWORD
     11473**DCL     11477--REDEF
KL_DREC_CNT.RENAME
     11496**DCL     11497--REDEF
PROJ$LIST
     12839**DCL     12980<<ASSIGN  12980>>ASSIGN
PROJ$LIST.ACCT
     12840**DCL     12971>>DOWHILE 12975>>IF
PROJ$LIST.GRANS
     12841**DCL     12978>>ASSIGN
PROJECT
        22**DCL     12914<<ASSIGN  12917>>ASSIGN  12935<>CALL    12954>>ASSIGN
PROJECT.TEXT
        24**DCL     12926>>CALLBLT
PROJ_ACCT_LIST$
        30**DCL     12839--IMP-PTR 12961<<ASSIGN  12971>>DOWHILE 12975>>IF      12978>>ASSIGN  12980>>ASSIGN
     12980>>ASSIGN
PROJ_KEY
      9819**DCL     12954<<ASSIGN
PROJ_KEY.COUNT
      9820**DCL     12958<<ASSIGN
PROJ_KEY.TEXT
      9820**DCL      9820--REDEF   12957>>CALLBLT
PROJ_KEY.TXT.PACKSET
      9821**DCL     12956<<ASSIGN  12968>>DOWHILE
PROJ_KEY.TXT.PROJECT
      9820**DCL      9820--REDEF
PL6.E3A0      #001=ASA$UNTIE_USER File=ASA$USER.:E05TSI                          TUE 07/29/97 08:54 Page:37   
READ_ERR
     12965**LABEL   12960--CALLALT
READ_PROJ
        29**DCL     12963<<ASSIGN  12966<<ASSIGN  12969>>IF
REMEM_VAR
      9946**DCL      9946--REDEF
REM_FCMD
      9946**DCL      9947--REDEF
REPORT
        21**DCL        14--PROC    12930>>IF
UNTIE_USER
        16**DCL        14--PROC    12887>>ASSIGN  12895<>CALL    12934<>CALL
USERS_KEY
      9817**DCL     12887<<ASSIGN  12917<<ASSIGN
USERS_KEY.COUNT
      9817**DCL     12886>>ASSIGN  12889<<ASSIGN  12913<<ASSIGN  12924<<ASSIGN  12928<<ASSIGN
USERS_KEY.TEXT
      9817**DCL      9818--REDEF    9818--REDEF    9818--REDEF    9819--REDEF
USERS_KEY.TXTC
      9818**DCL     12926<<CALLBLT 12927>>CALLBLT
USERS_KEY.UKEY.S
      9819**DCL     12888<<ASSIGN  12923<<ASSIGN
WRITE_ERR
     12989**LABEL   12987--CALLALT

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:38   
      154        1        /*M* ASA$TIE_USER - makes a user a member of a project.  */
      155        2        /*T***********************************************************/
      156        3        /*T*                                                         */
      157        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      158        5        /*T*                                                         */
      159        6        /*T***********************************************************/
      160        7        ASA$TIE_USER: PROC( TIE_USER, PROJECT, ACCT_COUNT, REPORT ) ALTRET;
      161        8
      162        9    1   DCL 1 TIE_USER,
      163       10    1          2 COUNT UBIN BYTE UNAL,
      164       11    1          2 TEXT CHAR(20);
      165       12    1   DCL 1 PROJECT,
      166       13    1          2 COUNT UBIN BYTE UNAL,
      167       14    1          2 TEXT CHAR(20);
      168       15    1   DCL ACCT_COUNT SBIN;
      169       16    1   DCL REPORT BIT(1) ALIGNED;
      170       17
      171       18    1   DCL I SBIN;
      172       19    1   DCL J SBIN;
      173       20    1   DCL K SBIN;
      174       21    1   DCL ARS SBIN;
      175       22    1   DCL PROJ_ACCT_LIST$ PTR;
      176       23
      177       24        %INCLUDE AS_ENTRIES_M  ;
      178     1074        %INCLUDE AS_SUPER_C    ;
      179     1509        %INCLUDE AS_MAC_C      ;
      180     1589        %INCLUDE KL_SUPER_C    ;
      181     4491        %INCLUDE XU_FORMAT_C   ;
      182     4653        %INCLUDE XU_MACRO_C    ;
      183     7759        %INCLUDE AS_PERR_C     ;
      184     8361        %INCLUDE AS_SUBS_C     ;
      185     9775        %INCLUDE AS_SUPER_R    ;
      186    12791
      187    12792    1   DCL 1 ACCT$LIST(0:0) ALIGNED BASED(DSEG1$),
      188    12793    1          2 PSN CHAR(6),
      189    12794    1          2 ACCT CHAR(8),
      190    12795    1          2 GRANS UBIN;
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:39   
      191    12796        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
      192    12830        %AS$PROJ_ACCT_LIST( NAME=PROJ$LIST, STCLASS="BASED(PROJ_ACCT_LIST$)" );
      193    12835
      194    12836        %ASB$READ_USERS ;
      195    12839        %ASB$WRITE_USERS ;
      196    12842        %ASB$WRITE_USERS_KEY ;
      197    12845        %ASB$READ_PROJ ;
      198    12848        %ASB$WRITE_PROJ ;
      199    12851        %ASH$ERROR ;
      200    12854        %ASH$WARN ;
      201    12857        %ASH$INFO ;
      202    12860        %ASA$KEYCONV ;
      203    12863
      204    12864        /*
      205    12865           Append an s to USERS_KEY.
      206    12866           Read :USERS keyed.
      207    12867           If the read returns then the object is a project and not a user.
      208    12868           We wish to disallow that.  So, issue a warning message that the
      209    12869           object is a project and will not be tied.  And then return.
      210    12870           If the read altreturns, then the object is possibly a user.
      211    12871           In which case, remove the s we added earlier, reset the count
      212    12872           on the USERS_KEY, and continue processing.
      213    12873        */
      214    12874    1   USERS_KEY = TIE_USER ;
      215    12875    1   I = USERS_KEY.COUNT;
      216    12876    1   USERS_KEY.UKEY.S = 'S';
      217    12877    1   USERS_KEY.COUNT = 21;
      218    12878    2   CALL ASB$READ_USERS (AS_PROJECT) WHENRETURN DO;
      219    12879        /*E*  ERROR:  ASA-E$PROJ_NOT_USER_TIE-0
      220    12880              MESSAGE:  %U1 is a project not a user.
      221    12881                        %U1 cannot be tied with a TIE user command.
      222    12882        */
      223    12883           %SCREAM (ERR#=%E$PROJ_NOT_USER_TIE, LEVEL=WARN, MID='A');
      224    12898    2      ALTRETURN;
      225    12899    2      END; /*  Whenreturn  */
      226    12900    1   USERS_KEY.COUNT = I;
      227    12901
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:40   
      228    12902    1   AS_USERS.BUDGET.MACCT = PROJECT;
      229    12903    1   USERS_KEY = TIE_USER;
      230    12904    1   CALL ASB$WRITE_USERS( AS_USERS );
      231    12905    1   CALL CONCAT( USERS_KEY.TXTC, BINASC(0), PROJECT.TEXT, TIE_USER.TEXT );
      232    12906    1   CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC, 29 );
      233    12907    1   USERS_KEY.COUNT = I;
      234    12908    1   CALL ASB$WRITE_USERS_KEY;
      235    12909    2   IF REPORT THEN DO;
      236    12910        /*E*  ERROR:      ASA-E$USER_TIED-C
      237    12911              MESSAGE:.. User "%U1" tied to project "%U2".
      238    12912        */
      239    12913    2      CALL ASA$KEYCONV( TIE_USER, AS_FIELD1 );
      240    12914    2      CALL ASA$KEYCONV( PROJECT,  AS_FIELD2 );
      241    12915           %SCREAM( ERR#=E$USER_TIED, LEVEL=INFO, MID='A' );
      242    12930    2      END;
      243    12931
      244    12932    1   AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_CREATED + 1;
      245    12933    2   IF AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_ALLOWED THEN DO;
      246    12934        /*   ERROR:   ASA-E$MAX_PROJ_USERS-C
      247    12935        MESSAGE: The maximum number of users allowed for project "%U1" have
      248    12936                 now been created.
      249    12937        */
      250    12938    2      CALL ASA$KEYCONV( PROJECT, AS_FIELD1 );
      251    12939           %SCREAM( ERR#=E$MAX_PROJ_USERS, LEVEL= WARN, MID='A' );
      252    12954    2      END;
      253    12955    1   CALL CONCAT( USERS_KEY.TXTC, PROJECT.TEXT, 'S' );
      254    12956    1   USERS_KEY.COUNT = 21;
      255    12957    1   CALL ASB$WRITE_USERS( AS_DFLT );
      256    12958
      257    12959    1   I = 0;
      258    12960    1   PROJ_KEY = PROJECT;
      259    12961    2   DO WHILE( I < ACCT_COUNT );
      260    12962    2      PROJ_KEY.TXT.PACKSET = ACCT$LIST.PSN(I);
      261    12963    2      CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );
      262    12964    2      PROJ_KEY.COUNT = J;
      263    12965    2      ARS = DSEG2SIZE;
      264    12966    2      CALL ASB$READ_PROJ( DSEG2$, ARS, 2 ) ALTRET(READ_ERR);
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:41   
      265    12967    2      PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),
      266    12968    2           (AS$PROJ.ATTRIBUTES.COUNT + 5) / 4 );
      267    12969    3      DO WHILE( I < ACCT_COUNT AND ACCT$LIST.PSN(I) = PROJ_KEY.TXT.PACKSET);
      268    12970    3         J = 0;
      269    12971    4         DO WHILE( J < AS$PROJ.NUM_ACCTS  AND
      270    12972    4              PROJ$LIST.ACCT(J) < ACCT$LIST.ACCT(I) );
      271    12973    4            J = J + 1;
      272    12974    4            END;
      273    12975    3         IF J = AS$PROJ.NUM_ACCTS
      274    12976    3              OR  PROJ$LIST.ACCT(J) ~= ACCT$LIST.ACCT(I)
      275    12977    4         THEN DO;
      276    12978    5            DO K = AS$PROJ.NUM_ACCTS DOWNTO J+1;
      277    12979    5               PROJ$LIST(K) = PROJ$LIST(K-1);
      278    12980    5               END;
      279    12981    4            PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I);
      280    12982    4            PROJ$LIST.GRANS(J) = ACCT$LIST.GRANS(I);
      281    12983    4            AS$PROJ.NUM_ACCTS = AS$PROJ.NUM_ACCTS + 1;
      282    12984    4            AS$PROJ.GRANS_ACCUM = AS$PROJ.GRANS_ACCUM + ACCT$LIST.GRANS(I);
      283    12985    4            END;
      284    12986    3         I = I + 1;
      285    12987    3         END;
      286    12988    2      ARS = POFFC(PROJ_ACCT_LIST$,DSEG2$) + SIZEC(PROJ$LIST(0))*AS$PROJ.NUM_ACCTS;
      287    12989    2      CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(WRITE_ERR);
      288    12990    3      DO WHILE( '0'B );
      289    12991    4   READ_ERR: DO WHILE( I<ACCT_COUNT AND ACCT$LIST.PSN(I)=PROJ_KEY.TXT.PACKSET);
      290    12992    4            I = I + 1;
      291    12993    4            END;
      292    12994    3   WRITE_ERR: CALL ASH$ERROR( ERR_CODE );
      293    12995    3         END;
      294    12996    2      END;
      295    12997
      296    12998    1   EXIT#: RETURN;
      297    12999
      298    13000    1   END ASA$TIE_USER;

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:42   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$TIE_USER.

   Procedure ASA$TIE_USER requires 275 words for executable code.
   Procedure ASA$TIE_USER requires 16 words of local(AUTO) storage.

    No errors detected in file ASA$USER.:E05TSI    .

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:43   

 Object Unit name= ASA$TIE_USER                               File name= ASA$USER.:E05TOU
 UTS= JUL 29 '97 08:55:42.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      3      3  ASA$TIE_USER
    2   Proc  even  none   275    423  ASA$TIE_USER
    3  RoData even  none    12     14  ASA$TIE_USER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        4  ASA$TIE_USER
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:44   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       1 ASB$READ_USERS
 yes     yes           Std       1 ASB$WRITE_USERS
 yes     yes           Std       0 ASB$WRITE_USERS_KEY
         yes           Std       2 ASH$WARN
         yes           Std       2 ASA$KEYCONV
         yes           Std       2 ASH$INFO
 yes     yes           Std       3 ASB$READ_PROJ
 yes     yes           Std       2 ASB$WRITE_PROJ
         yes           Std       2 ASH$ERROR
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_BLANK                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             PROJ_KEY
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                DSEG2$                                DSEG2SIZE
     AS_USERS                              AS_DFLT                               AS_PROJECT
     B_VECTNIL
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:45   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:46   


      154        1        /*M* ASA$TIE_USER - makes a user a member of a project.  */
      155        2        /*T***********************************************************/
      156        3        /*T*                                                         */
      157        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      158        5        /*T*                                                         */
      159        6        /*T***********************************************************/
      160        7        ASA$TIE_USER: PROC( TIE_USER, PROJECT, ACCT_COUNT, REPORT ) ALTRET;

      7  2 000000   000000 700200 xent  ASA$TIE_USER TSX0  ! X66_AUTO_4
         2 000001   000020 000004                    ZERO    16,4

      161        8
      162        9    1   DCL 1 TIE_USER,
      163       10    1          2 COUNT UBIN BYTE UNAL,
      164       11    1          2 TEXT CHAR(20);
      165       12    1   DCL 1 PROJECT,
      166       13    1          2 COUNT UBIN BYTE UNAL,
      167       14    1          2 TEXT CHAR(20);
      168       15    1   DCL ACCT_COUNT SBIN;
      169       16    1   DCL REPORT BIT(1) ALIGNED;
      170       17
      171       18    1   DCL I SBIN;
      172       19    1   DCL J SBIN;
      173       20    1   DCL K SBIN;
      174       21    1   DCL ARS SBIN;
      175       22    1   DCL PROJ_ACCT_LIST$ PTR;
      176       23
      177       24        %INCLUDE AS_ENTRIES_M  ;
      178     1074        %INCLUDE AS_SUPER_C    ;
      179     1509        %INCLUDE AS_MAC_C      ;
      180     1589        %INCLUDE KL_SUPER_C    ;
      181     4491        %INCLUDE XU_FORMAT_C   ;
      182     4653        %INCLUDE XU_MACRO_C    ;
      183     7759        %INCLUDE AS_PERR_C     ;
      184     8361        %INCLUDE AS_SUBS_C     ;
      185     9775        %INCLUDE AS_SUPER_R    ;
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:47   
      186    12791
      187    12792    1   DCL 1 ACCT$LIST(0:0) ALIGNED BASED(DSEG1$),
      188    12793    1          2 PSN CHAR(6),
      189    12794    1          2 ACCT CHAR(8),
      190    12795    1          2 GRANS UBIN;
      191    12796        %AS$PROJ( STCLASS="BASED(DSEG2$)" );
      192    12830        %AS$PROJ_ACCT_LIST( NAME=PROJ$LIST, STCLASS="BASED(PROJ_ACCT_LIST$)" );
      193    12835
      194    12836        %ASB$READ_USERS ;
      195    12839        %ASB$WRITE_USERS ;
      196    12842        %ASB$WRITE_USERS_KEY ;
      197    12845        %ASB$READ_PROJ ;
      198    12848        %ASB$WRITE_PROJ ;
      199    12851        %ASH$ERROR ;
      200    12854        %ASH$WARN ;
      201    12857        %ASH$INFO ;
      202    12860        %ASA$KEYCONV ;
      203    12863
      204    12864        /*
      205    12865           Append an s to USERS_KEY.
      206    12866           Read :USERS keyed.
      207    12867           If the read returns then the object is a project and not a user.
      208    12868           We wish to disallow that.  So, issue a warning message that the
      209    12869           object is a project and will not be tied.  And then return.
      210    12870           If the read altreturns, then the object is possibly a user.
      211    12871           In which case, remove the s we added earlier, reset the count
      212    12872           on the USERS_KEY, and continue processing.
      213    12873        */
      214    12874    1   USERS_KEY = TIE_USER ;

  12874  2 000002   200003 470500                    LDP0    @TIE_USER,,AUTO
         2 000003   000000 100500                    MLR     fill='000'O
         2 000004   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         2 000005   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      215    12875    1   I = USERS_KEY.COUNT;

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:48   
  12875  2 000006   000000 236000 xsym               LDQ     USERS_KEY
         2 000007   000033 772000                    QRL     27
         2 000010   200007 756100                    STQ     I,,AUTO

      216    12876    1   USERS_KEY.UKEY.S = 'S';

  12876  2 000011   000123 236003                    LDQ     83,DU
         2 000012   000005 552020 xsym               STBQ    USERS_KEY+5,'20'O

      217    12877    1   USERS_KEY.COUNT = 21;

  12877  2 000013   025000 236003                    LDQ     10752,DU
         2 000014   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      218    12878    2   CALL ASB$READ_USERS (AS_PROJECT) WHENRETURN DO;

  12878  2 000015   000000 630400 3                  EPPR0   0
         2 000016   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000017   000000 701000 xent               TSX1    ASB$READ_USERS
         2 000020   000026 702000 2                  TSX2    s:12900

      219    12879        /*E*  ERROR:  ASA-E$PROJ_NOT_USER_TIE-0
      220    12880              MESSAGE:  %U1 is a project not a user.
      221    12881                        %U1 cannot be tied with a TIE user command.
      222    12882        */
      223    12883           %SCREAM (ERR#=%E$PROJ_NOT_USER_TIE, LEVEL=WARN, MID='A');

  12893  2 000021   000001 630400 3                  EPPR0   1
         2 000022   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000023   000000 701000 xent               TSX1    ASH$WARN
         2 000024   000000 011000                    NOP     0

      224    12898    2      ALTRETURN;

  12898  2 000025   000000 702200 xent               TSX2  ! X66_AALT

      225    12899    2      END; /*  Whenreturn  */
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:49   
      226    12900    1   USERS_KEY.COUNT = I;

  12900  2 000026   200007 236100                    LDQ     I,,AUTO
         2 000027   000033 736000                    QLS     27
         2 000030   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      227    12901
      228    12902    1   AS_USERS.BUDGET.MACCT = PROJECT;

  12902  2 000031   200004 470500                    LDP0    @PROJECT,,AUTO
         2 000032   000000 100500                    MLR     fill='000'O
         2 000033   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         2 000034   000012 000025 xsym               ADSC9   AS_USERS+10              cn=0,n=21

      229    12903    1   USERS_KEY = TIE_USER;

  12903  2 000035   200003 471500                    LDP1    @TIE_USER,,AUTO
         2 000036   000000 100500                    MLR     fill='000'O
         2 000037   100000 000025                    ADSC9   0,,PR1                   cn=0,n=21
         2 000040   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      230    12904    1   CALL ASB$WRITE_USERS( AS_USERS );

  12904  2 000041   000002 630400 3                  EPPR0   2
         2 000042   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000043   000000 701000 xent               TSX1    ASB$WRITE_USERS
         2 000044   000000 011000                    NOP     0

      231    12905    1   CALL CONCAT( USERS_KEY.TXTC, BINASC(0), PROJECT.TEXT, TIE_USER.TEXT );

  12905  2 000045   000000 236003                    LDQ     0,DU
         2 000046   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         2 000047   200004 470500                    LDP0    @PROJECT,,AUTO
         2 000050   040000 100500                    MLR     fill='040'O
         2 000051   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
         2 000052   000000 400024 xsym               ADSC9   USERS_KEY                cn=2,n=20
         2 000053   200003 471500                    LDP1    @TIE_USER,,AUTO
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:50   
         2 000054   040000 100500                    MLR     fill='040'O
         2 000055   100000 200024                    ADSC9   0,,PR1                   cn=1,n=20
         2 000056   000005 400024 xsym               ADSC9   USERS_KEY+5              cn=2,n=20

      232    12906    1   CALL INDEX( I, AS_BLANK, USERS_KEY.TXTC, 29 );

  12906  2 000057   000000 124400                    SCM     mask='000'O
         2 000060   000007 400014 xsym               ADSC9   USERS_KEY+7              cn=2,n=12
         2 000061   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000062   200007 000100                    ARG     I,,AUTO
         2 000063   000035 236007                    LDQ     29,DL
         2 000064   200007 056100                    ASQ     I,,AUTO

      233    12907    1   USERS_KEY.COUNT = I;

  12907  2 000065   200007 236100                    LDQ     I,,AUTO
         2 000066   000033 736000                    QLS     27
         2 000067   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      234    12908    1   CALL ASB$WRITE_USERS_KEY;

  12908  2 000070   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000071   000000 701000 xent               TSX1    ASB$WRITE_USERS_KEY
         2 000072   000000 011000                    NOP     0

      235    12909    2   IF REPORT THEN DO;

  12909  2 000073   200006 470500                    LDP0    @REPORT,,AUTO
         2 000074   000000 234100                    SZN     0,,PR0
         2 000075   000120 605000 2                  TPL     s:12932

      236    12910        /*E*  ERROR:      ASA-E$USER_TIED-C
      237    12911              MESSAGE:.. User "%U1" tied to project "%U2".
      238    12912        */
      239    12913    2      CALL ASA$KEYCONV( TIE_USER, AS_FIELD1 );

  12913  2 000076   000003 236000 3                  LDQ     3
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:51   
         2 000077   200003 235100                    LDA     @TIE_USER,,AUTO
         2 000100   200014 757100                    STAQ    PROJ_ACCT_LIST$+1,,AUTO
         2 000101   200014 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000102   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000103   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000104   000000 011000                    NOP     0

      240    12914    2      CALL ASA$KEYCONV( PROJECT,  AS_FIELD2 );

  12914  2 000105   000004 236000 3                  LDQ     4
         2 000106   200004 235100                    LDA     @PROJECT,,AUTO
         2 000107   200014 757100                    STAQ    PROJ_ACCT_LIST$+1,,AUTO
         2 000110   200014 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000111   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000112   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000113   000000 011000                    NOP     0

      241    12915           %SCREAM( ERR#=E$USER_TIED, LEVEL=INFO, MID='A' );

  12923  2 000114   000005 630400 3                  EPPR0   5
         2 000115   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000116   000000 701000 xent               TSX1    ASH$INFO
         2 000117   000000 011000                    NOP     0

      242    12930    2      END;

      243    12931
      244    12932    1   AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_CREATED + 1;

  12932  2 000120   000011 054000 xsym               AOS     AS_DFLT+9

      245    12933    2   IF AS_DFLT.BUDGET.PROJ_CREATED = AS_DFLT.BUDGET.PROJ_ALLOWED THEN DO;

  12933  2 000121   000011 236000 xsym               LDQ     AS_DFLT+9
         2 000122   000010 116000 xsym               CMPQ    AS_DFLT+8
         2 000123   000137 601000 2                  TNZ     s:12955

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:52   
      246    12934        /*   ERROR:   ASA-E$MAX_PROJ_USERS-C
      247    12935        MESSAGE: The maximum number of users allowed for project "%U1" have
      248    12936                 now been created.
      249    12937        */
      250    12938    2      CALL ASA$KEYCONV( PROJECT, AS_FIELD1 );

  12938  2 000124   000003 236000 3                  LDQ     3
         2 000125   200004 235100                    LDA     @PROJECT,,AUTO
         2 000126   200014 757100                    STAQ    PROJ_ACCT_LIST$+1,,AUTO
         2 000127   200014 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000130   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000131   000000 701000 xent               TSX1    ASA$KEYCONV
         2 000132   000000 011000                    NOP     0

      251    12939           %SCREAM( ERR#=E$MAX_PROJ_USERS, LEVEL= WARN, MID='A' );

  12949  2 000133   000006 630400 3                  EPPR0   6
         2 000134   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000135   000000 701000 xent               TSX1    ASH$WARN
         2 000136   000000 011000                    NOP     0

      252    12954    2      END;

      253    12955    1   CALL CONCAT( USERS_KEY.TXTC, PROJECT.TEXT, 'S' );

  12955  2 000137   200004 470500                    LDP0    @PROJECT,,AUTO
         2 000140   040000 100500                    MLR     fill='040'O
         2 000141   000000 200024                    ADSC9   0,,PR0                   cn=1,n=20
         2 000142   000000 200024 xsym               ADSC9   USERS_KEY                cn=1,n=20
         2 000143   040000 100400                    MLR     fill='040'O
         2 000144   000007 000001 3                  ADSC9   7                        cn=0,n=1
         2 000145   000005 200025 xsym               ADSC9   USERS_KEY+5              cn=1,n=21

      254    12956    1   USERS_KEY.COUNT = 21;

  12956  2 000146   025000 236003                    LDQ     10752,DU
         2 000147   000000 552040 xsym               STBQ    USERS_KEY,'40'O
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:53   

      255    12957    1   CALL ASB$WRITE_USERS( AS_DFLT );

  12957  2 000150   000010 630400 3                  EPPR0   8
         2 000151   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000152   000000 701000 xent               TSX1    ASB$WRITE_USERS
         2 000153   000000 011000                    NOP     0

      256    12958
      257    12959    1   I = 0;

  12959  2 000154   200007 450100                    STZ     I,,AUTO

      258    12960    1   PROJ_KEY = PROJECT;

  12960  2 000155   200004 470500                    LDP0    @PROJECT,,AUTO
         2 000156   000000 100500                    MLR     fill='000'O
         2 000157   000000 000025                    ADSC9   0,,PR0                   cn=0,n=21
         2 000160   000000 000033 xsym               ADSC9   PROJ_KEY                 cn=0,n=27

      259    12961    2   DO WHILE( I < ACCT_COUNT );

  12961  2 000161   200005 471500                    LDP1    @ACCT_COUNT,,AUTO
         2 000162   200007 236100                    LDQ     I,,AUTO
         2 000163   100000 116100                    CMPQ    0,,PR1
         2 000164   000422 605000 2                  TPL     EXIT#

      260    12962    2      PROJ_KEY.TXT.PACKSET = ACCT$LIST.PSN(I);

  12962  2 000165   200007 236100                    LDQ     I,,AUTO
         2 000166   000024 402007                    MPY     20,DL
         2 000167   000000 470400 xsym               LDP0    DSEG1$
         2 000170   040000 100506                    MLR     fill='040'O
         2 000171   000000 000006                    ADSC9   0,Q,PR0                  cn=0,n=6
         2 000172   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6

      261    12963    2      CALL INDEX( J, AS_BLANK, PROJ_KEY.TEXT, 20 );
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:54   

  12963  2 000173   000000 124400                    SCM     mask='000'O
         2 000174   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000175   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         2 000176   200010 000100                    ARG     J,,AUTO
         2 000177   000024 236007                    LDQ     20,DL
         2 000200   200010 056100                    ASQ     J,,AUTO

      262    12964    2      PROJ_KEY.COUNT = J;

  12964  2 000201   200010 236100                    LDQ     J,,AUTO
         2 000202   000033 736000                    QLS     27
         2 000203   000000 552040 xsym               STBQ    PROJ_KEY,'40'O

      263    12965    2      ARS = DSEG2SIZE;

  12965  2 000204   000000 235000 xsym               LDA     DSEG2SIZE
         2 000205   200012 755100                    STA     ARS,,AUTO

      264    12966    2      CALL ASB$READ_PROJ( DSEG2$, ARS, 2 ) ALTRET(READ_ERR);

  12966  2 000206   000011 236000 3                  LDQ     9
         2 000207   200016 756100                    STQ     PROJ_ACCT_LIST$+3,,AUTO
         2 000210   200012 631500                    EPPR1   ARS,,AUTO
         2 000211   200015 451500                    STP1    PROJ_ACCT_LIST$+2,,AUTO
         2 000212   000012 236000 3                  LDQ     10
         2 000213   200014 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000214   200014 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000215   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000216   000000 701000 xent               TSX1    ASB$READ_PROJ
         2 000217   000376 702000 2                  TSX2    READ_ERR

      265    12967    2      PROJ_ACCT_LIST$ = PINCRW( ADDR(AS$PROJ.ATTRIBUTES),

  12967  2 000220   000000 470400 xsym               LDP0    DSEG2$
         2 000221   000014 236100                    LDQ     12,,PR0
         2 000222   000022 772000                    QRL     18
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:55   
         2 000223   000005 036007                    ADLQ    5,DL
         2 000224   000002 772000                    QRL     2
         2 000225   000022 736000                    QLS     18
         2 000226   000014 036003                    ADLQ    12,DU
         2 000227   000000 036000 xsym               ADLQ    DSEG2$
         2 000230   200013 756100                    STQ     PROJ_ACCT_LIST$,,AUTO

      266    12968    2           (AS$PROJ.ATTRIBUTES.COUNT + 5) / 4 );
      267    12969    3      DO WHILE( I < ACCT_COUNT AND ACCT$LIST.PSN(I) = PROJ_KEY.TXT.PACKSET);

  12969  2 000231   000340 710000 2                  TRA     s:12987

      268    12970    3         J = 0;

  12970  2 000232   200010 450100                    STZ     J,,AUTO

      269    12971    4         DO WHILE( J < AS$PROJ.NUM_ACCTS  AND

  12971  2 000233   000235 710000 2                  TRA     s:12974

      270    12972    4              PROJ$LIST.ACCT(J) < ACCT$LIST.ACCT(I) );
      271    12973    4            J = J + 1;

  12973  2 000234   200010 054100                    AOS     J,,AUTO

      272    12974    4            END;

  12974  2 000235   000000 470400 xsym               LDP0    DSEG2$
         2 000236   200010 236100                    LDQ     J,,AUTO
         2 000237   000013 116100                    CMPQ    11,,PR0
         2 000240   000254 605000 2                  TPL     s:12975
         2 000241   000014 402007                    MPY     12,DL
         2 000242   200014 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000243   200007 236100                    LDQ     I,,AUTO
         2 000244   000024 402007                    MPY     20,DL
         2 000245   200013 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         2 000246   200014 235100                    LDA     PROJ_ACCT_LIST$+1,,AUTO
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:56   
         2 000247   000000 473400 xsym               LDP3    DSEG1$
         2 000250   040106 106505                    CMPC    fill='040'O
         2 000251   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         2 000252   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         2 000253   000234 602000 2                  TNC     s:12973

      273    12975    3         IF J = AS$PROJ.NUM_ACCTS

  12975  2 000254   200010 236100                    LDQ     J,,AUTO
         2 000255   000013 116100                    CMPQ    11,,PR0
         2 000256   000272 600000 2                  TZE     s:12978
         2 000257   000014 402007                    MPY     12,DL
         2 000260   200014 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000261   200007 236100                    LDQ     I,,AUTO
         2 000262   000024 402007                    MPY     20,DL
         2 000263   200013 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         2 000264   200014 235100                    LDA     PROJ_ACCT_LIST$+1,,AUTO
         2 000265   000000 473400 xsym               LDP3    DSEG1$
         2 000266   040106 106505                    CMPC    fill='040'O
         2 000267   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8
         2 000270   300001 400010                    ADSC9   1,Q,PR3                  cn=2,n=8
         2 000271   000337 600000 2                  TZE     s:12986

      274    12976    3              OR  PROJ$LIST.ACCT(J) ~= ACCT$LIST.ACCT(I)
      275    12977    4         THEN DO;

      276    12978    5            DO K = AS$PROJ.NUM_ACCTS DOWNTO J+1;

  12978  2 000272   000013 235100                    LDA     11,,PR0
         2 000273   200011 755100                    STA     K,,AUTO
         2 000274   000305 710000 2                  TRA     s:12980+2

      277    12979    5               PROJ$LIST(K) = PROJ$LIST(K-1);

  12979  2 000275   200011 236100                    LDQ     K,,AUTO
         2 000276   000014 402007                    MPY     12,DL
         2 000277   200013 470500                    LDP0    PROJ_ACCT_LIST$,,AUTO
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:57   
         2 000300   000106 100506                    MLR     fill='000'O
         2 000301   077775 000014                    ADSC9   -3,Q,PR0                 cn=0,n=12
         2 000302   000000 000014                    ADSC9   0,Q,PR0                  cn=0,n=12

      278    12980    5               END;

  12980  2 000303   000001 336007                    LCQ     1,DL
         2 000304   200011 056100                    ASQ     K,,AUTO
         2 000305   200011 236100                    LDQ     K,,AUTO
         2 000306   200010 116100                    CMPQ    J,,AUTO
         2 000307   000275 605400 2                  TPNZ    s:12979

      279    12981    4            PROJ$LIST.ACCT(J) = ACCT$LIST.ACCT(I);

  12981  2 000310   200010 236100                    LDQ     J,,AUTO
         2 000311   000003 402007                    MPY     3,DL
         2 000312   000000 620006                    EAX0    0,QL
         2 000313   200007 236100                    LDQ     I,,AUTO
         2 000314   000024 402007                    MPY     20,DL
         2 000315   000000 635010                    EAA     0,X0
         2 000316   000020 731000                    ARS     16
         2 000317   000000 470400 xsym               LDP0    DSEG1$
         2 000320   200013 471500                    LDP1    PROJ_ACCT_LIST$,,AUTO
         2 000321   040105 100506                    MLR     fill='040'O
         2 000322   000001 400010                    ADSC9   1,Q,PR0                  cn=2,n=8
         2 000323   100000 000010                    ADSC9   0,A,PR1                  cn=0,n=8

      280    12982    4            PROJ$LIST.GRANS(J) = ACCT$LIST.GRANS(I);

  12982  2 000324   200007 236100                    LDQ     I,,AUTO
         2 000325   000005 402007                    MPY     5,DL
         2 000326   000000 470400 xsym               LDP0    DSEG1$
         2 000327   000004 235106                    LDA     4,QL,PR0
         2 000330   100002 755110                    STA     2,X0,PR1

      281    12983    4            AS$PROJ.NUM_ACCTS = AS$PROJ.NUM_ACCTS + 1;

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:58   
  12983  2 000331   000000 470400 xsym               LDP0    DSEG2$
         2 000332   000013 054100                    AOS     11,,PR0

      282    12984    4            AS$PROJ.GRANS_ACCUM = AS$PROJ.GRANS_ACCUM + ACCT$LIST.GRANS(I);

  12984  2 000333   000000 473400 xsym               LDP3    DSEG1$
         2 000334   300004 236106                    LDQ     4,QL,PR3
         2 000335   000007 036100                    ADLQ    7,,PR0
         2 000336   000007 756100                    STQ     7,,PR0

      283    12985    4            END;

      284    12986    3         I = I + 1;

  12986  2 000337   200007 054100                    AOS     I,,AUTO

      285    12987    3         END;

  12987  2 000340   200005 471500                    LDP1    @ACCT_COUNT,,AUTO
         2 000341   200007 236100                    LDQ     I,,AUTO
         2 000342   100000 116100                    CMPQ    0,,PR1
         2 000343   000352 605000 2                  TPL     s:12988
         2 000344   000024 402007                    MPY     20,DL
         2 000345   000000 473400 xsym               LDP3    DSEG1$
         2 000346   040000 106506                    CMPC    fill='040'O
         2 000347   300000 000006                    ADSC9   0,Q,PR3                  cn=0,n=6
         2 000350   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000351   000232 600000 2                  TZE     s:12970

      286    12988    2      ARS = POFFC(PROJ_ACCT_LIST$,DSEG2$) + SIZEC(PROJ$LIST(0))*AS$PROJ.NUM_ACCTS;

  12988  2 000352   000000 236000 xsym               LDQ     DSEG2$
         2 000353   000020 772000                    QRL     16
         2 000354   200014 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000355   200013 236100                    LDQ     PROJ_ACCT_LIST$,,AUTO
         2 000356   000020 772000                    QRL     16
         2 000357   200014 136100                    SBLQ    PROJ_ACCT_LIST$+1,,AUTO
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:59   
         2 000360   200015 756100                    STQ     PROJ_ACCT_LIST$+2,,AUTO
         2 000361   000013 236100                    LDQ     11,,PR0
         2 000362   000014 402007                    MPY     12,DL
         2 000363   200015 036100                    ADLQ    PROJ_ACCT_LIST$+2,,AUTO
         2 000364   200012 756100                    STQ     ARS,,AUTO

      287    12989    2      CALL ASB$WRITE_PROJ( DSEG2$, ARS ) ALTRET(WRITE_ERR);

  12989  2 000365   200012 633500                    EPPR3   ARS,,AUTO
         2 000366   200015 453500                    STP3    PROJ_ACCT_LIST$+2,,AUTO
         2 000367   000012 236000 3                  LDQ     10
         2 000370   200014 756100                    STQ     PROJ_ACCT_LIST$+1,,AUTO
         2 000371   200014 630500                    EPPR0   PROJ_ACCT_LIST$+1,,AUTO
         2 000372   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000373   000000 701000 xent               TSX1    ASB$WRITE_PROJ
         2 000374   000412 702000 2                  TSX2    WRITE_ERR

      288    12990    3      DO WHILE( '0'B );

  12990  2 000375   000416 710000 2                  TRA     s:12996

      289    12991    4   READ_ERR: DO WHILE( I<ACCT_COUNT AND ACCT$LIST.PSN(I)=PROJ_KEY.TXT.PACKSET);

  12991  2 000376   000400 710000 2     READ_ERR     TRA     s:12993

      290    12992    4            I = I + 1;

  12992  2 000377   200007 054100                    AOS     I,,AUTO

      291    12993    4            END;

  12993  2 000400   200005 470500                    LDP0    @ACCT_COUNT,,AUTO
         2 000401   200007 236100                    LDQ     I,,AUTO
         2 000402   000000 116100                    CMPQ    0,,PR0
         2 000403   000412 605000 2                  TPL     WRITE_ERR
         2 000404   000024 402007                    MPY     20,DL
         2 000405   000000 471400 xsym               LDP1    DSEG1$
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:60   
         2 000406   040000 106506                    CMPC    fill='040'O
         2 000407   100000 000006                    ADSC9   0,Q,PR1                  cn=0,n=6
         2 000410   000005 200006 xsym               ADSC9   PROJ_KEY+5               cn=1,n=6
         2 000411   000377 600000 2                  TZE     s:12992

      292    12994    3   WRITE_ERR: CALL ASH$ERROR( ERR_CODE );

  12994  2 000412   000013 630400 3     WRITE_ERR    EPPR0   11
         2 000413   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000414   000000 701000 xent               TSX1    ASH$ERROR
         2 000415   000000 011000                    NOP     0

      293    12995    3         END;

      294    12996    2      END;

  12996  2 000416   200005 470500                    LDP0    @ACCT_COUNT,,AUTO
         2 000417   200007 236100                    LDQ     I,,AUTO
         2 000420   000000 116100                    CMPQ    0,,PR0
         2 000421   000165 604000 2                  TMI     s:12962

      295    12997
      296    12998    1   EXIT#: RETURN;

  12998  2 000422   000000 702200 xent  EXIT#        TSX2  ! X66_ARET
      297    12999
      298    13000    1   END ASA$TIE_USER;

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:61   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASA$TIE_USER.
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:62   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @ACCT_COUNT                4-0-0/w PTR         r     1 @PROJECT
     6-0-0/w PTR         r     1 @REPORT                    3-0-0/w PTR         r     1 @TIE_USER
    *0-0-0/w SBIN        r     1 ACCT_COUNT                12-0-0/w SBIN        r     1 ARS
     7-0-0/w SBIN        r     1 I                         10-0-0/w SBIN        r     1 J
    11-0-0/w SBIN        r     1 K                         *0-0-0/c STRC(189)   r     1 PROJECT
    13-0-0/w PTR         r     1 PROJ_ACCT_LIST$           *0-0-0/w BIT         r     1 REPORT
    *0-0-0/c STRC(189)   r     1 TIE_USER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w STRC(18576) r     1 AS_DFLT
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w STRC(18576) r     1 AS_PROJECT                 0-0-0/w STRC(18576) r     1 AS_USERS
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w PTR         r     1 DSEG2$
     0-0-0/w UBIN        r     1 DSEG2SIZE                  0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/c STRC(243)   r     1 PROJ_KEY                   0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(180)   r     1 ACCT$LIST(0:0)
     0-0-0/w ASTR(468)   r     1 AS$PROJ
     0-0-0/w STRC(108)   r     1 PROJ$LIST(0:0)

PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:63   

   Procedure ASA$TIE_USER requires 275 words for executable code.
   Procedure ASA$TIE_USER requires 16 words of local(AUTO) storage.

    No errors detected in file ASA$USER.:E05TSI    .
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:64   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:65   
          MINI XREF LISTING

ACCT$LIST.ACCT
     12794**DCL     12971>>DOWHILE 12975>>IF      12981>>ASSIGN
ACCT$LIST.GRANS
     12795**DCL     12982>>ASSIGN  12984>>ASSIGN
ACCT$LIST.PSN
     12793**DCL     12962>>ASSIGN  12969>>DOWHILE 12991>>DOWHILE
ACCT_COUNT
        15**DCL         7--PROC    12961>>DOWHILE 12969>>DOWHILE 12991>>DOWHILE
ARS
        21**DCL     12965<<ASSIGN  12966<>CALL    12988<<ASSIGN  12989<>CALL
AS$PROJ.ATTRIBUTES
     12826**DCL     12967--ASSIGN
AS$PROJ.ATTRIBUTES.COUNT
     12827**DCL     12828--IMP-SIZ 12967>>ASSIGN
AS$PROJ.GRANS_ACCUM
     12818**DCL     12984<<ASSIGN  12984>>ASSIGN
AS$PROJ.NUM_ACCTS
     12824**DCL     12971>>DOWHILE 12975>>IF      12978>>DOINDEX 12983<<ASSIGN  12983>>ASSIGN  12988>>ASSIGN
ASA$KEYCONV
     12861**DCL-ENT 12913--CALL    12914--CALL    12938--CALL
ASA_BRKS_LOC
      9939**DCL      9939--REDEF
ASB$READ_PROJ
     12846**DCL-ENT 12966--CALL
ASB$READ_USERS
     12837**DCL-ENT 12878--CALL
ASB$WRITE_PROJ
     12849**DCL-ENT 12989--CALL
ASB$WRITE_USERS
     12840**DCL-ENT 12904--CALL    12957--CALL
ASB$WRITE_USERS_KEY
     12843**DCL-ENT 12908--CALL
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:66   
ASH$ERROR
     12852**DCL-ENT 12994--CALL
ASH$INFO
     12858**DCL-ENT 12923--CALL
ASH$WARN
     12855**DCL-ENT 12893--CALL    12949--CALL
AS_BLANK
      9799**DCL     12906>>CALLBLT 12963>>CALLBLT
AS_DEFAULT.BANNER_PERM
     10632**DCL     10633--REDEF
AS_DEFAULT.BUDGET.MACCT
     10537**DCL     10541--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     10550**DCL     10553--REDEF
AS_DEFAULT.BUDGET.PACCUM
     10533**DCL     10535--REDEF
AS_DEFAULT.BUDGET.PMAXC
     10528**DCL     10530--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     10648**DCL     10649--REDEF   10650--REDEF
AS_DEFAULT_DREC.PASSWORD
     11902**DCL     11906--REDEF
AS_DEFAULT_DREC.RENAME
     11925**DCL     11926--REDEF
AS_DFLT
     10339**DCL     12957<>CALL
AS_DFLT.BANNER_PERM
     10454**DCL     10455--REDEF
AS_DFLT.BUDGET.MACCT
     10359**DCL     10363--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     10372**DCL     10375--REDEF
AS_DFLT.BUDGET.PACCUM
     10355**DCL     10357--REDEF
AS_DFLT.BUDGET.PMAXC
     10350**DCL     10352--REDEF
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:67   
AS_DFLT.BUDGET.PROJ_ALLOWED
     10352**DCL     12933>>IF
AS_DFLT.BUDGET.PROJ_CREATED
     10357**DCL     12932<<ASSIGN  12932>>ASSIGN  12933>>IF
AS_DFLT.SETUP_CHRA.TXT
     10470**DCL     10471--REDEF   10472--REDEF
AS_FE_MODE
      9805**DCL      9806--REDEF
AS_FIELD1
      9935**DCL     12913<>CALL    12938<>CALL
AS_FIELD2
      9936**DCL     12914<>CALL
AS_MODE
      9802**DCL      9804--REDEF
AS_MOD_USER.ACCESS
     12667**DCL     12668--REDEF
AS_MOD_USER.BANNER
     12654**DCL     12655--REDEF
AS_MOD_USER.BANNER_PERM
     12656**DCL     12657--REDEF
AS_MOD_USER.BILL
     12662**DCL     12663--REDEF
AS_MOD_USER.CPROC
     12658**DCL     12659--REDEF
AS_MOD_USER.FEBILL
     12738**DCL     12739--REDEF
AS_MOD_USER.FECXTMEM
     12755**DCL     12756--REDEF
AS_MOD_USER.FEMINTS
     12740**DCL     12741--REDEF
AS_MOD_USER.FEMMEM
     12751**DCL     12752--REDEF
AS_MOD_USER.FEMTIME
     12749**DCL     12750--REDEF
AS_MOD_USER.FEPPRIV
     12746**DCL     12748--REDEF
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:68   
AS_MOD_USER.FEPRIV
     12743**DCL     12745--REDEF
AS_MOD_USER.FORCE_BIT
     12652**DCL     12653--REDEF
AS_MOD_USER.KEY
     12734**DCL     12736--REDEF
AS_MOD_USER.LASTCPROC
     12660**DCL     12661--REDEF
AS_MOD_USER.LIMITS.DO_
     12708**DCL     12709--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     12724**DCL     12725--REDEF
AS_MOD_USER.LIMITS.LO
     12704**DCL     12705--REDEF
AS_MOD_USER.LIMITS.MEM
     12700**DCL     12701--REDEF
AS_MOD_USER.LIMITS.MPRIO
     12728**DCL     12729--REDEF
AS_MOD_USER.LIMITS.PDIS
     12716**DCL     12717--REDEF
AS_MOD_USER.LIMITS.PO
     12712**DCL     12713--REDEF
AS_MOD_USER.LIMITS.TDIS
     12720**DCL     12721--REDEF
AS_MOD_USER.LIMITS.TIME
     12696**DCL     12697--REDEF
AS_MOD_USER.MAXENQ
     12677**DCL     12678--REDEF
AS_MOD_USER.PERM_BIT
     12650**DCL     12651--REDEF
AS_MOD_USER.PPRIV
     12672**DCL     12674--REDEF
AS_MOD_USER.PRIOB
     12679**DCL     12680--REDEF
AS_MOD_USER.PRIV
     12669**DCL     12671--REDEF
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:69   
AS_MOD_USER.QUAN
     12675**DCL     12676--REDEF
AS_MOD_USER.SETUP
     12648**DCL     12649--REDEF
AS_PROJECT
     10873**DCL     12878<>CALL
AS_PROJECT.BANNER_PERM
     10988**DCL     10989--REDEF
AS_PROJECT.BUDGET.MACCT
     10893**DCL     10897--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     10906**DCL     10909--REDEF
AS_PROJECT.BUDGET.PACCUM
     10889**DCL     10891--REDEF
AS_PROJECT.BUDGET.PMAXC
     10884**DCL     10886--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     11004**DCL     11005--REDEF   11006--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     11166**DCL     11167--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     11071**DCL     11075--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     11084**DCL     11087--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     11067**DCL     11069--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     11062**DCL     11064--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     11182**DCL     11183--REDEF   11184--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     12388**DCL     12392--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     12411**DCL     12412--REDEF
AS_PROJECT_DREC.PASSWORD
     12226**DCL     12230--REDEF
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:70   
AS_PROJECT_DREC.RENAME
     12249**DCL     12250--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     10810**DCL     10811--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     10715**DCL     10719--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     10728**DCL     10731--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     10711**DCL     10713--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     10706**DCL     10708--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     10826**DCL     10827--REDEF   10828--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     12064**DCL     12068--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     12087**DCL     12088--REDEF
AS_USERS
     10161**DCL     12904<>CALL
AS_USERS.BANNER_PERM
     10276**DCL     10277--REDEF
AS_USERS.BUDGET.MACCT
     10181**DCL     10185--REDEF   12902<<ASSIGN
AS_USERS.BUDGET.MAX_PROJECTS
     10194**DCL     10197--REDEF
AS_USERS.BUDGET.PACCUM
     10177**DCL     10179--REDEF
AS_USERS.BUDGET.PMAXC
     10172**DCL     10174--REDEF
AS_USERS.SETUP_CHRA.TXT
     10292**DCL     10293--REDEF   10294--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     11344**DCL     11345--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     11249**DCL     11253--REDEF
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:71   
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     11262**DCL     11265--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     11245**DCL     11247--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     11240**DCL     11242--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     11360**DCL     11361--REDEF   11362--REDEF
DSEG1$
      9940**DCL     12792--IMP-PTR 12962>>ASSIGN  12969>>DOWHILE 12971>>DOWHILE 12975>>IF      12981>>ASSIGN
     12982>>ASSIGN  12984>>ASSIGN  12991>>DOWHILE
DSEG2$
      9941**DCL     12807--IMP-PTR 12966<>CALL    12967>>ASSIGN  12967>>ASSIGN  12971>>DOWHILE 12975>>IF
     12978>>DOINDEX 12983>>ASSIGN  12983>>ASSIGN  12984>>ASSIGN  12984>>ASSIGN  12988>>ASSIGN  12988>>ASSIGN
     12989<>CALL
DSEG2SIZE
      9941**DCL     12965>>ASSIGN
ERR_CODE
      9934**DCL      9935--REDEF   12994<>CALL
I
        18**DCL     12875<<ASSIGN  12900>>ASSIGN  12906<<CALLBLT 12907>>ASSIGN  12959<<ASSIGN  12961>>DOWHILE
     12962>>ASSIGN  12969>>DOWHILE 12969>>DOWHILE 12971>>DOWHILE 12975>>IF      12981>>ASSIGN  12982>>ASSIGN
     12984>>ASSIGN  12986<<ASSIGN  12986>>ASSIGN  12991>>DOWHILE 12991>>DOWHILE 12992<<ASSIGN  12992>>ASSIGN
J
        19**DCL     12963<<CALLBLT 12964>>ASSIGN  12970<<ASSIGN  12971>>DOWHILE 12971>>DOWHILE 12973<<ASSIGN
     12973>>ASSIGN  12975>>IF      12975>>IF      12978>>DOINDEX 12981>>ASSIGN  12982>>ASSIGN
K
        20**DCL     12978<<DOINDEX 12979>>ASSIGN  12979>>ASSIGN
KL_DEFAULT.PASSWORD
     12550**DCL     12554--REDEF
KL_DEFAULT.RENAME
     12573**DCL     12574--REDEF
KL_DFLT.PASSWORD
     11740**DCL     11744--REDEF
KL_DFLT.RENAME
     11763**DCL     11764--REDEF
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:72   
KL_DREC.PASSWORD
     11578**DCL     11582--REDEF
KL_DREC.RENAME
     11601**DCL     11602--REDEF
KL_DREC_CNT.PASSWORD
     11465**DCL     11469--REDEF
KL_DREC_CNT.RENAME
     11488**DCL     11489--REDEF
PROJ$LIST
     12831**DCL     12979<<ASSIGN  12979>>ASSIGN  12988--ASSIGN
PROJ$LIST.ACCT
     12832**DCL     12971>>DOWHILE 12975>>IF      12981<<ASSIGN
PROJ$LIST.GRANS
     12833**DCL     12982<<ASSIGN
PROJECT
        12**DCL         7--PROC    12902>>ASSIGN  12914<>CALL    12938<>CALL    12960>>ASSIGN
PROJECT.TEXT
        14**DCL     12905>>CALLBLT 12955>>CALLBLT
PROJ_ACCT_LIST$
        22**DCL     12831--IMP-PTR 12967<<ASSIGN  12971>>DOWHILE 12975>>IF      12979>>ASSIGN  12979>>ASSIGN
     12981>>ASSIGN  12982>>ASSIGN  12988>>ASSIGN
PROJ_KEY
      9811**DCL     12960<<ASSIGN
PROJ_KEY.COUNT
      9812**DCL     12964<<ASSIGN
PROJ_KEY.TEXT
      9812**DCL      9812--REDEF   12963>>CALLBLT
PROJ_KEY.TXT.PACKSET
      9813**DCL     12962<<ASSIGN  12969>>DOWHILE 12991>>DOWHILE
PROJ_KEY.TXT.PROJECT
      9812**DCL      9812--REDEF
READ_ERR
     12991**LABEL   12966--CALLALT
REMEM_VAR
      9938**DCL      9938--REDEF
REM_FCMD
PL6.E3A0      #002=ASA$TIE_USER File=ASA$USER.:E05TSI                            TUE 07/29/97 08:55 Page:73   
      9938**DCL      9939--REDEF
REPORT
        16**DCL         7--PROC    12909>>IF
TIE_USER
         9**DCL         7--PROC    12874>>ASSIGN  12903>>ASSIGN  12913<>CALL
TIE_USER.TEXT
        11**DCL     12905>>CALLBLT
USERS_KEY
      9809**DCL     12874<<ASSIGN  12903<<ASSIGN
USERS_KEY.COUNT
      9809**DCL     12875>>ASSIGN  12877<<ASSIGN  12900<<ASSIGN  12907<<ASSIGN  12956<<ASSIGN
USERS_KEY.TEXT
      9809**DCL      9810--REDEF    9810--REDEF    9810--REDEF    9811--REDEF
USERS_KEY.TXTC
      9810**DCL     12905<<CALLBLT 12906>>CALLBLT 12955<<CALLBLT
USERS_KEY.UKEY.S
      9811**DCL     12876<<ASSIGN
WRITE_ERR
     12994**LABEL   12989--CALLALT
