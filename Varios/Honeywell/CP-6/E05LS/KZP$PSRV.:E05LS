VERSION E05

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:1    
        1        1        /*M*     KZP$PSRV - Path services entry points                     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC */
        8        8        /*P*     NAME:     KZP$PSRV
        9        9                 PURPOSE:  KZP$PSRV contains the path services entry points.
       10       10                           It's function is to process connect/disconnect
       11       11                           events as well as to drive the sync channel.  The
       12       12                           code in this module must run inhibited.         */
       13       13        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:2    
       14       14
       15       15        /*P*     NAME:     KZP$CNCDSC
       16       16                 PURPOSE:  KZP$CNCDSC provides the line to host interface
       17       17                           functionality which allows terminal/line connects
       18       18                           and disconnects.  The routine should be called
       19       19                           inhibited.  It is passed two arguments, the first
       20       20                           is the event code, and the second is the line
       21       21                           context.  From this information, the code decides
       22       22                           what to do based on a decision table.  Most of
       23       23                           the events are reported directly from the path
       24       24                           to the host.  Others are reported from the line
       25       25                           driver (%KZ#PTH_EVENT_LINBID, ..._LINACK, AND
       26       26                           ..._LINBLK).  The two remaining events are
       27       27                           reported by the device managers (..._LGNCMP,
       28       28                           and ..._DEVDSC).                                */
       29       29
       30       30        KZP$CNCDSC: PROC ( KZ$PARAM ) ALTRET;
       31       31
       32       32        %INCLUDE KZ$LINCTX;
       33      652        %INCLUDE KL_SUPER_C;               /* To get protocol type EQUs  */
       34     3554        %INCLUDE KZ$PROWRT;
       35     3679        %INCLUDE KH$CHN;
       36     3801        %INCLUDE KZ_CLM_E;
       37     3973        %INCLUDE KZ_LIN_C;
       38     4029        %INCLUDE KZ_SCODE_C;
       39     4044        %INCLUDE KZ_MLCP_C;
       40     4119        %INCLUDE KH$IO;
       41     4366        %INCLUDE GH_IOFNC_E;
       42     4435        %INCLUDE KHA_FNC_E;
       43     4535        %INCLUDE KH_MACRO_C;
       44     5278        %INCLUDE KZ_CLMEVT_C;
       45     5320        %INCLUDE KZ$BSCSTT;
       46     5426        %INCLUDE KZ_INIT_C;
       47     5762        %INCLUDE KH$CLK;
       48     6132        %INCLUDE KH_CLKFNC_E;
       49     6177        %INCLUDE KZ_PERR_C;
       50     6259        %INCLUDE LCP_6;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:3    
       51    10538        %INCLUDE CP_6_SUBS;
       52    11078        %INCLUDE KV$GLB;
       53    11497        %INCLUDE KV_GLBCNS_E;
       54    11838        %INCLUDE KZ$OTPBFR;
       55    11939        %KV_INPOPRX_E;
       56    11951        %INCLUDE KZ_3270_C;
       57    12109        %KZ_3270_E;
       58    12237        %INCLUDE KW_ALCT_E;               /* For linespeed EQUs      */
       59    12427        %INCLUDE KL_MACRO_C;
       60    15779        %INCLUDE KL_AFCN_C;
       61    15880        %INCLUDE K_ID_E;
       62    15930        %K#ENTID_E;
       63    15949        %K#LYRID_E;
       64    15956
       65    15957           %KZ$EVENT           ( FPTN = KZ$PARAM,
       66    15958                                 STCLASS = PARAM );
       67    16040
       68    16041           %KZ$EVENT           ( FPTN = KZ$EVENT,
       69    16042                                 STCLASS = AUTO );
       70    16124
       71    16125           %KZ$LINCTX          ( STCLASS = BASED );
       72    16556
       73    16557           %KZ$OTPBFR          ( STCLASS = BASED );
       74    16622
       75    16623           %KZ$PROWRT          ( STCLASS = BASED );
       76    16660
       77    16661           %KZ_INIT_HDR        ( NAME = KZ$HDR,
       78    16662                                 STCLASS = BASED );
       79    16686
       80    16687           %KH$CHN             ( STCLASS = BASED );
       81    16811
       82    16812           %KH$CLK             ( FPTN = KH_SETCLK_C,
       83    16813                                 FNC = %KH#CLK_SETCLK,
       84    16814                                 PRDUNT = %KH#C_SEC,
       85    16815                                 PRD = 5,
       86    16816                                 ACCURACY = 0,
       87    16817                                 STCLASS = CONSTANT );
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:4    
       88    16966
       89    16967           %KH$CLK             ( FPTN = KH_SETCLK,
       90    16968                                 FNC = %KH#CLK_SETCLK,
       91    16969                                 STCLASS = AUTO );
       92    17118
       93    17119           %KH$CLK             ( FPTN = KH_CANCELCLK_C,
       94    17120                                 FNC = %KH#CLK_CANCEL,
       95    17121                                 STCLASS = CONSTANT );
       96    17270
       97    17271           %KH$CLK             ( FPTN = KH_CANCELCLK,
       98    17272                                 FNC = %KH#CLK_CANCEL,
       99    17273                                 STCLASS = AUTO );
      100    17422
      101    17423           %KH$CCPLCT          ( NAME = KZM$MLCP,
      102    17424                                 STCLASS = SYMREF );
      103    17450
      104    17451           %KH$DWNLODCCP       ( NAME = KH_DWNLODCCP_C,
      105    17452                                 CCPLODBIS = 0,
      106    17453                                 STCLASS = CONSTANT );
      107    17476
      108    17477           %KH$DWNLODCCP       ( NAME = KH_DWNLODCCP,
      109    17478                                 STCLASS = AUTO );
      110    17501
      111    17502           %KH$DWNLODLCT       ( NAME = KH_DWNLODLCT_C,
      112    17503                                 STCLASS = CONSTANT );
      113    17527
      114    17528           %KH$DWNLODLCT       ( NAME = KH_DWNLODLCT,
      115    17529                                 STCLASS = AUTO );
      116    17553
      117    17554           %KH$IO              ( FPTN = KH_OTPINT_C,
      118    17555                                 FNC = %GH#IO_OTPINTCTR,
      119    17556                                 STCLASS = CONSTANT );
      120    17670
      121    17671           %KH$IO              ( FPTN = KH_OTPINT,
      122    17672                                 FNC = %GH#IO_OTPINTCTR,
      123    17673                                 STCLASS = AUTO );
      124    17787
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:5    
      125    17788           %KH$IO              ( FPTN = KH_OTPLCT_C,
      126    17789                                 FNC = %GH#IO_OTPLCTBYT,
      127    17790                                 STCLASS = CONSTANT );
      128    17904
      129    17905           %KH$IO              ( FPTN = KH_OTPLCT,
      130    17906                                 FNC = %GH#IO_OTPLCTBYT,
      131    17907                                 STCLASS = AUTO );
      132    18021
      133    18022           %KH$IO              ( FPTN = KH_OTPCHN_C,
      134    18023                                 FNC = %GH#IO_OTPCHNCTR,
      135    18024                                 STCLASS = CONSTANT );
      136    18138
      137    18139           %KH$IO              ( FPTN = KH_OTPCHN,
      138    18140                                 FNC = %GH#IO_OTPCHNCTR,
      139    18141                                 STCLASS = AUTO );
      140    18255
      141    18256           %KL_TRMD            ( NAME = KL_TRMD,
      142    18257                                 STCLASS = "BASED CALIGNED" );
      143    18419
      144    18420           %KL_HASP            ( STCLASS = BASED );
      145    18570
      146    18571           %VLP_NAME           ( FPTN = VLP_PNAME,
      147    18572                                 LEN = VLP_PNAME.L,
      148    18573                                 STCLASS = "BASED UNAL" );
      149    18588
      150    18589           %B$TERMINAL_ID      ( FPTN = B$TERMINAL_ID,
      151    18590                                 STCLASS = BASED );
      152    18619
      153    18620           %B$TERMINAL_ID      ( FPTN = TERM_ID_C,
      154    18621                                 STCLASS = CONSTANT );
      155    18650
      156    18651           %B$TERMINAL_ID      ( FPTN = TERM_ID,
      157    18652                                 STCLASS = AUTO );
      158    18681
      159    18682           %FPT_WRSYSLOG       ( FPTN = MEMORY_LOG,
      160    18683                                 FCG = 'KZ',
      161    18684                                 MID = 'P',
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:6    
      162    18685                                 ERR = %E$NO_MEMORY,
      163    18686                                 SEV = %G_WRSYSLOG_SEV_LINE_ABORT#,
      164    18687                                 STCLASS = "STATIC SYMDEF" );
      165    18782
      166    18783           %FPT_WRSYSLOG       ( FPTN = PROTOCOL_LOG,
      167    18784                                 FCG = 'KZ',
      168    18785                                 MID = 'P',
      169    18786                                 ERR = %E$NOPROT,
      170    18787                                 SEV = %G_WRSYSLOG_SEV_LINE_ABORT#,
      171    18788                                 STCLASS = STATIC );
      172    18883
      173    18884           %FPT_WRSYSLOG       ( FPTN = VAMOOSE_LOG,
      174    18885                                 FCG = 'KZ',
      175    18886                                 MID = 'P',
      176    18887                                 ERR = %E$LINCNC,
      177    18888                                 SEV = %G_WRSYSLOG_SEV_INFO#,
      178    18889                                 STCLASS = STATIC );
      179    18984
      180    18985    1   DCL KZ_NHDR UBIN WORD SYMREF;
      181    18986    1   DCL KZ_HDR$(0:0) PTR SYMREF;
      182    18987    1   DCL KZ_INT_LEV UBIN SYMREF;
      183    18988    1   DCL KZ_CCPLODBIS_MLC8 UBIN WORD SYMREF;
      184    18989    1   DCL KZ_CCPLODBIS_MLC16 UBIN WORD SYMREF;
      185    18990    1   DCL KZR_THRTL_BLK UBIN SYMREF;
      186    18991    1   DCL KZR_THRTL_UNBLK UBIN SYMREF;
      187    18992    1   DCL KHC$CLOCK ENTRY(1) ALTRET;
      188    18993    1   DCL KZC$INTBID ENTRY (1);
      189    18994    1   DCL KHI$IO_OTP ENTRY (2) ALTRET;
      190    18995    1   DCL KHI$IO_OTPLCTBYT ENTRY (2) ALTRET;
      191    18996    1   DCL KZC$SEARCH_FOR_ACTIVITY ENTRY (1);
      192    18997        /*N* DCL KZC$SCREECH ENTRY (1) ALTRET; */
      193    18998    1   DCL KVB$GETSYS ENTRY (2) ALTRET;
      194    18999    1   DCL KVB$RLSSYS ENTRY (2) ALTRET;
      195    19000    1   DCL KZP$DRIVER ENTRY(3);
      196    19001    1   DCL KZO$ORDERS ENTRY(2);
      197    19002    1   DCL KHA$DVCADM ENTRY (6) ALTRET;
      198    19003    1   DCL KHA$TSTCNC ENTRY(1) ALTRET;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:7    
      199    19004    1   DCL KHI$DWNLODLCT ENTRY (1) ALTRET;
      200    19005    1   DCL KHA$LINE_ACTIVE ENTRY (1);
      201    19006    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
      202    19007    1   DCL LCT$ PTR;
      203    19008    1   DCL BFR$ PTR;
      204    19009    1   DCL BUF$ PTR;
      205    19010    1   DCL SZ UBIN;
      206    19011    1   DCL 1 TL BASED CALIGNED,
      207    19012    1         2 T UBIN BYTE UNAL,
      208    19013    1         2 L UBIN BYTE UNAL;
      209    19014    1   DCL 1 LCT_HEADER BASED ALIGNED,
      210    19015    1         2 BFR$ PTR,
      211    19016    1         2 SIZE UBIN WORD;
      212    19017    1   DCL RLS$STG CHAR(80) BASED;
      213    19018        %EQU YES='1'B;
      214    19019        %EQU NO='0'B;
      215    19020
      216    19021    1   DCL KZ_CNCDSC_TABLE(0:%(20*16-1)) UBIN BYTE UNAL CONSTANT INIT (
      217    19022        /*                 L  R  B  C  L  L     K   D  D  L  D  S  C
      218    19023                           I  Q  L  T  G  I     I   S  S  I  E  U  N
      219    19024                           S  S  D  X  N  N     L   A  C  N  V  B  C
      220    19025                           T  L  C  C  C  A     L   B  T  D  D  C  R
      221    19026                           E  P  T  M  M  C     E   L  R  S  S  N  Q
      222    19027                           N  R  X  P  P  K     D   D  M  C  C  C  S        */
      223    19028    1   /* 00 INTNUL  */  01,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      224    19029    1   /* 01 LISTEN  */  25,02,25,25,25,25,25,12, 12,12,25,15,25,25,25,25,
      225    19030    1   /* 02 RQSLPR  */  25,25,03,25,25,25,25,13, 13,13,25,15,25,25,25,25,
      226    19031    1   /* 03 BLDCTX  */  25,25,03,04,25,25,25,13, 13,13,25,15,16,17,25,25,
      227    19032    1   /* 04 CTXCMP  */  25,25,25,25,10,25,25,11, 11,11,25,15,16,17,25,25,
      228    19033    1   /* 05 INTPRO  */  06,25,25,25,25,25,25,25, 12,25,25,25,25,25,25,25,
      229    19034    1   /* 06 AUTORQS */  25,25,07,25,25,25,25,13, 13,13,25,25,25,25,25,25,
      230    19035    1   /* 07 AUTOBLD */  25,25,07,08,25,25,25,13, 13,13,25,15,16,17,25,25,
      231    19036    1   /* 08 AUTOCTX */  25,25,25,25,09,25,25,11, 11,11,25,15,16,17,25,25,
      232    19037    1   /* 09 AUTOCMP */  25,25,25,25,25,10,25,11, 11,11,25,15,16,17,25,25,
      233    19038    1   /* 10 VAMOOSE */  25,25,25,25,25,25,25,11, 24,11,12,15,16,17,25,25,
      234    19039    1   /* 11 DSCDEV  */  25,24,25,25,24,24,25,24, 24,24,12,15,25,17,25,25,
      235    19040    1   /* 12 LINDONE */  25,25,25,25,25,25,25,24, 24,24,25,25,25,25,25,25,
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:8    
      236    19041    1   /* 13 DSCPND1 */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      237    19042    1   /* 14 DSCPND2 */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      238    19043        /*---------Non Line Manager Events---------------------------------*/
      239    19044    1   /* 15 DEVDONE */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      240    19045    1   /* 16 DEVCNC  */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      241    19046    1   /* 17 CNCRQS  */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      242    19047    1                     25*0 );
      243    19048
      244    19049
      245    19050
      246    19051        /*       Convert KZ#CLM_EVENT_nn to KZ#LINFCN_mm                   */
      247    19052
      248    19053    1   DCL KZ_DEVFNC_MAP ( 0:15 ) UBIN WORD CONSTANT
      249    19054    1          UNAL INIT ( %KZ#LINFCN_NOP,
      250    19055    1                      %KZ#LINFCN_NOP,
      251    19056    1                      %KZ#LINFCN_NOP,
      252    19057    1                      %KZ#LINFCN_NOP,
      253    19058    1                      %KZ#LINFCN_NOP,
      254    19059    1                      %KZ#LINFCN_NOP,
      255    19060    1                      %KZ#LINFCN_NOP,
      256    19061    1                      %KZ#LINFCN_KILL,
      257    19062    1                      %KZ#LINFCN_DISABL,
      258    19063    1                      %KZ#LINFCN_DSCTRM,
      259    19064    1                      %KZ#LINFCN_NOP,
      260    19065    1                      %KZ#LINFCN_NOP,
      261    19066    1                      %KZ#LINFCN_NOP,
      262    19067    1                      %KZ#LINFCN_NOP,
      263    19068    1                      %KZ#LINFCN_NOP,
      264    19069    1                      %KZ#LINFCN_NOP);
      265    19070    1   DCL EVENT UBIN WORD;
      266    19071    1   DCL TXT$ PTR;
      267    19072    1   DCL TXTX UBIN WORD;
      268    19073    1   DCL OK_TO_MUCK_CONTEXT BIT(1);
      269    19074    1   DCL NEW_STATE UBIN WORD;
      270    19075    1   DCL OLD_STATE UBIN WORD;
      271    19076    1   DCL 1 R4_IOINFO ALIGNED,
      272    19077    1         2 CHN BIT(10) UNAL,
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:9    
      273    19078    1         2 FNC UBIN(6) UNAL;
      274    19079    1   DCL 1 R5_IOINFO ALIGNED,
      275    19080    1         2 LCTVAL UBIN BYTE CALIGNED,
      276    19081    1         2 LCTADR UBIN BYTE CALIGNED;
      277    19082    1   DCL I UBIN WORD;
      278    19083    1   DCL X UBIN WORD;
      279    19084    1   DCL ERRORWORD UBIN WORD;
      280    19085    1   DCL S$ PTR;
      281    19086    1   DCL P$ PTR;
      282    19087    1   DCL 1 TEXTC BASED ALIGNED,
      283    19088    1         2 SIZE UBIN BYTE CALIGNED,
      284    19089    1         2 TEXT CHAR(TEXTC.SIZE) CALIGNED;
      285    19090        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:10   
      286    19091    1         KZ$EVENT = KZ$PARAM;
      287    19092    1         KZ$EVENT.RESULT = '0'B;
      288    19093
      289    19094    1         CALL CNCDSC;
      290    19095
      291    19096    1         IF OK_TO_MUCK_CONTEXT
      292    19097    2         THEN DO;
      293    19098    2            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE
      294    19099    2            THEN
      295    19100    2               KZ$EVENT.LINCTX$ -> KZ$LINCTX.PTHSTT = NEW_STATE;
      296    19101    2            ELSE
      297    19102    2               KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %YES;
      298    19103    2            END;
      299    19104    1         IF KZ$EVENT.RESULT = '0'B
      300    19105    1         THEN
      301    19106    1            RETURN;
      302    19107    1         ELSE
      303    19108    1            ALTRETURN;
      304    19109        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:11   
      305    19110    1   CNCDSC: PROC ALTRET;
      306    19111    2         NEW_STATE = KZ_CNCDSC_TABLE ( KZ$EVENT.LINCTX$
      307    19112    2            -> KZ$LINCTX.PTHSTT * 16 + KZ$EVENT.EVENT );
      308    19113    2         OK_TO_MUCK_CONTEXT = '1'B;
      309    19114
      310    19115    2         I = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP * 2
      311    19116    2            + BITBIN (KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE);
      312    19117    2         S$ = KZ_HDR$(I) -> KZ$HDR.STTBFR$;
      313    19118    3         DO CASE ( NEW_STATE );
      314    19119
      315    19120        /**/
      316    19121        /*
      317    19122            Null states
      318    19123        */
      319    19124        /**/
      320    19125    3          CASE ( %KZ#CLM_STATE_INTNUL,
      321    19126    3            %KZ#CLM_STATE_INTPRO );
      322    19127        /**/
      323    19128        /*
      324    19129            Post read on line for initial bid
      325    19130        */
      326    19131        /**/
      327    19132    3          CASE ( %KZ#CLM_STATE_LISTEN );
      328    19133
      329    19134    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.STBL$
      330    19135    3               = KZ_HDR$ (0) -> KZ$HDR.STBL$;
      331    19136    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.MAP$
      332    19137    3               = KZ_HDR$ (0) -> KZ$HDR.EMAP$;
      333    19138    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINMGR@
      334    19139    3               = KZ_HDR$ (0) -> KZ$HDR.LINHND@;
      335    19140    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@
      336    19141    3               = KZ_HDR$ (0) -> KZ$HDR.DVCHND@;
      337    19142    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.IOMGR@ = ENTADDR(KZO$ORDERS);
      338    19143    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.INHLVL = KZ_INT_LEV;
      339    19144    3            CALL SETCMPLVL;
      340    19145    3            CALL KZP$DRIVER ( KZ$EVENT.LINCTX$ -> KZ$LINCTX,
      341    19146    3               %KZ#LIN_EVENT_GO, );
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:12   
      342    19147        /**/
      343    19148        /*
      344    19149            Bid received - request profile info from Handler Common
      345    19150        */
      346    19151        /**/
      347    19152    3          CASE ( %KZ#CLM_STATE_RQSLPR );
      348    19153
      349    19154        /*N*   CALL KHA$GETTERMID */
      350    19155    3            TERM_ID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.TERMID;
      351    19156    3            TERM_ID.TTYP = %KLTY_STRM#;              /* SYNC term */
      352    19157    3            CALL KHA$DVCADM ( %KHA_FNC_RQSLINPRO,
      353    19158    3               ERRORWORD,
      354    19159    3               TERM_ID,,
      355    19160    3               KZ$EVENT.LGNVEC );
      356    19161
      357    19162        /**/
      358    19163        /*
      359    19164            Profile context received from host (via Handler Common)
      360    19165        */
      361    19166        /**/
      362    19167    3          CASE ( %KZ#CLM_STATE_BLDCTX, %KZ#CLM_STATE_AUTOBLD );
      363    19168
      364    19169    4            DO CASE ( KZ$EVENT.TERMID$ -> B$TERMINAL_ID.LEV );
      365    19170
      366    19171    4             CASE ( %TERMINAL_ID_LEV_CHAN# );
      367    19172
      368    19173    4               CALL SETPRM;
      369    19174
      370    19175    4             CASE ( %TERMINAL_ID_LEV_SUBCHAN#,
      371    19176    4                  %TERMINAL_ID_LEV_SUBSUBCHAN# );
      372    19177
      373    19178    4               KZ$EVENT.EVENT = %KZ#LINFCN_BLDCTX;
      374    19179    4               CALL KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@
      375    19180    4                  ( KZ$EVENT );
      376    19181
      377    19182    4             CASE ( ELSE );
      378    19183
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:13   
      379    19184    4             END;
      380    19185        /**/
      381    19186        /*
      382    19187            End of profile context for the specified channel
      383    19188        */
      384    19189        /**/
      385    19190    3          CASE ( %KZ#CLM_STATE_CTXCMP );
      386    19191
      387    19192    3            KZ$EVENT.EVENT = %KZ#LINFCN_CTXCMP;
      388    19193    3            CALL KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@
      389    19194    3               ( KZ$EVENT );
      390    19195        /**/
      391    19196        /*
      392    19197             End of profile context for autologged channel
      393    19198        */
      394    19199        /**/
      395    19200    3          CASE ( %KZ#CLM_STATE_AUTOCTX);
      396    19201
      397    19202    3            KZ$EVENT.EVENT = %KZ#LINFCN_CTXCMP;
      398    19203    3            CALL KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@
      399    19204    3               ( KZ$EVENT );
      400    19205    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.SIGNON = '1'B;
      401    19206
      402    19207    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_POLL#
      403    19208    3               OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_3275#
      404    19209    3               OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_HIP#
      405    19210    4            THEN DO;                 /* Not RBT. Don't expect LGNCMP. */
      406    19211    4               NEW_STATE = %KZ#CLM_STATE_VAMOOSE;
      407    19212    4               GOTO VAMOOSE_3270;
      408    19213    4               END;
      409    19214
      410    19215        /**/
      411    19216        /*
      412    19217            Request profile info for autolog device
      413    19218        */
      414    19219        /**/
      415    19220    3          CASE ( %KZ#CLM_STATE_AUTORQS );
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:14   
      416    19221
      417    19222        /*N*   CALL KHA$GETTERMID */
      418    19223    3            TERM_ID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.TERMID;
      419    19224    3            TERM_ID.TTYP = %KLTY_STRM#;              /* SYNC term */
      420    19225    3            CALL KHA$DVCADM ( %KHA_FNC_RQSLINPRO,
      421    19226    3               ERRORWORD,
      422    19227    3               TERM_ID,, );
      423    19228
      424    19229        /**/
      425    19230        /*
      426    19231            Logon complete event from protocol hander.  When we are thru
      427    19232            passing profile context to the handler(s), they logon all devices
      428    19233            on the channel via VDH.  Upon completion of the device logons
      429    19234            they event CLM with Logon complete.  Remember CLM does line logons,
      430    19235            the handlers do device logons.
      431    19236        */
      432    19237        /**/
      433    19238    3          CASE ( %KZ#CLM_STATE_AUTOCMP );
      434    19239
      435    19240    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_HASP#
      436    19241    3               OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_NJE#
      437    19242    4            THEN DO;               /* HASP      */
      438    19243    4               KZ$EVENT.LINCTX$->KZ$LINCTX.BCB.RCV=15; /*Init block sequence */
      439    19244    4               IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE
      440    19245    4                  OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_NJE#
      441    19246    5               THEN DO;
      442    19247    5                  CALL SETCMPLVL;
      443    19248    5                  CALL KZC$INTBID ( KZ$EVENT.LINCTX$ -> KZ$LINCTX );
      444    19249    5                  END;
      445    19250    5               ELSE DO;
      446    19251        /*N*          HASP MASTER with autologon is an error of some kind */
      447    19252    5                  END;
      448    19253    4               END;
      449    19254    4            ELSE DO;                 /* 2780/3780 */
      450    19255    4               NEW_STATE = %KZ#CLM_STATE_VAMOOSE;
      451    19256    4               GOTO VAMOOSE_3270;
      452    19257    4               END;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:15   
      453    19258
      454    19259        /**/
      455    19260        /*
      456    19261            Initiate disconnect
      457    19262        */
      458    19263        /**/
      459    19264    3          CASE ( %KZ#CLM_STATE_DSCDEV );
      460    19265    3   INITIATE_DISCONNECT:;
      461    19266
      462    19267    4            IF KZ$EVENT.LINCTX$->KZ$LINCTX.DEVMGR@ = ENTADDR(NIL) THEN DO;
      463    19268    4               NEW_STATE = %KZ#CLM_STATE_LINDONE;
      464    19269    4               CALL FREE_LINE;
      465    19270    4               END;
      466    19271    4            ELSE DO;
      467    19272
      468    19273                 /* NEWSTATE is assigned in advance on line level disconnects
      469    19274                    because protocol handlers with no VDH context will call
      470    19275                    with function LINDSC prior to returning from the DEVMGR@
      471    19276                    call (below). */
      472    19277
      473    19278    4               KZ$EVENT.LINCTX$->KZ$LINCTX.FLAGS.NEWSTATE = %NO;
      474    19279    5               IF KZ$EVENT.TERMID$->B$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN# THEN DO;
      475    19280    5                  KZ$EVENT.LINCTX$->KZ$LINCTX.PTHSTT = NEW_STATE;
      476    19281    5                  CALL KZP$DRIVER (KZ$EVENT.LINCTX$->KZ$LINCTX,%KZ#LIN_EVENT_STOP);
      477    19282    5                  END;
      478    19283
      479    19284    4               KZ$EVENT.EVENT=KZ_DEVFNC_MAP(KZ$EVENT.EVENT );
      480    19285    4               CALL KZ$EVENT.LINCTX$->KZ$LINCTX.DEVMGR@ (KZ$EVENT)
      481    19286    5               WHENALTRETURN DO;
      482    19287    5                  KZ$PARAM.RESULT=KZ$EVENT.RESULT;
      483    19288    5                  ALTRETURN;
      484    19289    5                  END;
      485    19290    4               END;
      486    19291    4            IF KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ENQ$ ~= ADDR(NIL) THEN DO;
      487    19292    4               KH_CANCELCLK = KH_CANCELCLK_C;
      488    19293    4               CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ENQ$);
      489    19294    4               END;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:16   
      490    19295        /**/
      491    19296        /*
      492    19297            Complete the disconnect on the line
      493    19298        */
      494    19299        /**/
      495    19300    3          CASE ( %KZ#CLM_STATE_LINDONE );
      496    19301
      497    19302    3            CALL FREE_LINE;
      498    19303        /**/
      499    19304        /*
      500    19305            Disconnect while waiting for context building events
      501    19306        */
      502    19307        /**/
      503    19308    3          CASE ( %KZ#CLM_STATE_DSCPND1 );
      504    19309
      505    19310    3            TERM_ID=KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.TERMID;
      506    19311    3            TERM_ID.TTYP=%KLTY_STRM#;                /* SYNC term */
      507    19312    3            CALL KHA$DVCADM ( %KHA_FNC_CNCRQSLINPRO,
      508    19313    3               ERRORWORD,
      509    19314    3               TERM_ID,, );
      510    19315    3            NEW_STATE=%KZ#CLM_STATE_DSCDEV;
      511    19316    3            GOTO INITIATE_DISCONNECT;
      512    19317
      513    19318        /**/
      514    19319        /*
      515    19320            Complete the disconnect on the sub-device
      516    19321        */
      517    19322        /**/
      518    19323    3          CASE ( %KZ#CLM_STATE_DEVDONE );
      519    19324
      520    19325    3            CALL KHA$DVCADM ( %KHA_FNC_DISCONNECT_EVT,
      521    19326    3               ERRORWORD,
      522    19327    3               KZ$EVENT.TERMID$ -> B$TERMINAL_ID,, );
      523    19328    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %NO;
      524    19329        /**/
      525    19330        /*
      526    19331            Report device connects to handler Common
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:17   
      527    19332        */
      528    19333        /**/
      529    19334    3          CASE ( %KZ#CLM_STATE_DEVCNC );
      530    19335
      531    19336
      532    19337    3            CALL KHA$DVCADM ( %KHA_FNC_CONNECT,
      533    19338    3               ERRORWORD,
      534    19339    3               KZ$EVENT.TERMID$ -> B$TERMINAL_ID,, );
      535    19340    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %NO;
      536    19341        /**/
      537    19342        /*
      538    19343            Do a enable test on the specified device.
      539    19344        */
      540    19345        /**/
      541    19346    3          CASE ( %KZ#CLM_STATE_CNCRQS );
      542    19347
      543    19348    3            CALL KHA$TSTCNC ( KZ$EVENT.CHN$ )
      544    19349    4            WHENRETURN DO;
      545    19350    4               KZ$EVENT.RESULT = '0'B;
      546    19351    4               END;
      547    19352    4            WHENALTRETURN DO;
      548    19353    4               KZ$EVENT.RESULT.ERR# = 1;
      549    19354    4               END;
      550    19355    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %NO;
      551    19356        /**/
      552    19357        /*
      553    19358            All done with connect - get out of here
      554    19359        */
      555    19360        /**/
      556    19361    3          CASE ( %KZ#CLM_STATE_VAMOOSE );
      557    19362
      558    19363    3   VAMOOSE_3270:;
      559    19364    4            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.STBL$ ~= ADDR(NIL) THEN DO;
      560    19365    4               IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.AUTLGN THEN
      561    19366    4                  CALL SETCMPLVL;
      562    19367    4               IF ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP > %KLPT_3780#) OR
      563    19368    4                  ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP <= %KLPT_3780# AND
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:18   
      564    19369    4                  KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.AUTLGN ) THEN
      565    19370    4                  KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.SETCLK = '1'B;
      566    19371    4               CALL KZP$DRIVER ( KZ$EVENT.LINCTX$->KZ$LINCTX,
      567    19372    4                  %KZ#LIN_EVENT_GO );
      568    19373    4               END;
      569    19374    3            CALL KHA$LINE_ACTIVE ( KZ$EVENT.TERMID$ -> B$TERMINAL_ID );
      570    19375
      571    19376        /*E*     ERROR: KZP-E$LINCNC
      572    19377               MESSAGE: ( KZP$CNCDSC ) Successful line connect.
      573    19378           DESCRIPTION: Line has logged onto the host successfully.  This is
      574    19379                        a 0 severity error intended primarily for debug
      575    19380                        purposes.
      576    19381        */
      577    19382
      578    19383    3            VAMOOSE_LOG.BUF_
      579    19384    3               = VECTOR ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN );
      580    19385    3            VAMOOSE_LOG.V.TERMID=KZ$EVENT.LINCTX$->KZ$LINCTX.LINID;
      581    19386    3            CALL KHA$ERRLOG ( VAMOOSE_LOG )
      582    19387    4            WHENALTRETURN DO;
      583    19388    4               END;
      584    19389
      585    19390        /**/
      586    19391        /*
      587    19392            No operation ... case 24.
      588    19393        */
      589    19394        /**/
      590    19395
      591    19396    3          CASE ( 24 );
      592    19397
      593    19398    3            NEW_STATE = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PTHSTT;
      594    19399
      595    19400        /**/
      596    19401        /*
      597    19402            Screech state.
      598    19403        */
      599    19404        /**/
      600    19405
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:19   
      601    19406    3          CASE ( 25 );
      602    19407
      603    19408        /*S* SCREECH_CODE: KZP-S$BADLINSTT
      604    19409                  MESSAGE: (KZP$PSRV) Bad host connect path state.
      605    19410              DESCRIPTION: An event occured while the line was in a poor
      606    19411                       state to accept it.  EVENT, KZ$LINCTX.PTHSTT
      607    19412                           are intact and interesting.                     */
      608    19413
      609    19414        /*N*       CALL KZC$SCREECH (%S$BADLINSTT); */
      610    19415    3            CALL M$XXX;
      611    19416
      612    19417    3          END;
      613    19418
      614    19419    2         RETURN;
      615    19420
      616    19421    2   END CNCDSC;
      617    19422        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:20   
      618    19423    1   SETCMPLVL: PROC;
      619    19424
      620    19425    2         KH_OTPINT = KH_OTPINT_C;
      621    19426    2         KH_OTPINT.OTPCHN = '0'B;
      622    19427    2         KH_OTPINT.INTCTR.INTLVL = KZ_INT_LEV + %KZ#INPLVL;
      623    19428    2         CALL KHI$IO_OTP (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,
      624    19429    2            KH_OTPINT);
      625    19430    2         KH_OTPINT.OTPCHN = '1'B;
      626    19431    2         KH_OTPINT.INTCTR.INTLVL = KZ_INT_LEV + %KZ#OTPLVL;
      627    19432    2         CALL KHI$IO_OTP (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,
      628    19433    2            KH_OTPINT);
      629    19434    2         IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_POLL#
      630    19435    2            AND KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE
      631    19436    3         THEN DO;
      632    19437    3            KH_OTPLCT = KH_OTPLCT_C;
      633    19438    3            KH_OTPLCT.LCTBYT.ADR=29;         /* LCT29 - Receive order code         */
      634    19439    3            KH_OTPLCT.LCTBYT.DAT=%KZ#RCV_SLV3270;
      635    19440    3            CALL KHI$IO_OTPLCTBYT (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,
      636    19441    3               KH_OTPLCT);
      637    19442    3            END;
      638    19443
      639    19444    2   END SETCMPLVL;
      640    19445
      641    19446    1   FREE_LINE: PROC;
      642    19447
      643    19448    3         IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.CTX$ ~= ADDR(NIL) THEN DO;
      644    19449    3            KH_CANCELCLK = KH_CANCELCLK_C;
      645    19450    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.PRM$);
      646    19451    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ACK$);
      647    19452    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ENQ$);
      648    19453    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.NAK$);
      649    19454    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.TMRCTB$);
      650    19455
      651    19456                                              /*
      652    19457                                           Reset the MLCP
      653    19458                                                          */
      654    19459    3            KH_OTPCHN = KH_OTPCHN_C;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:21   
      655    19460    3            KH_OTPCHN.OTPCHN = '0'B;
      656    19461    3            KH_OTPCHN.CHNCTR = '0'B;
      657    19462    3            KH_OTPCHN.CHNCTR.CHNINT = '1'B;
      658    19463    3            CALL KHI$IO_OTP ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,
      659    19464    3               KH_OTPCHN );
      660    19465    3            KH_OTPCHN.OTPCHN = '1'B;
      661    19466    3            CALL KHI$IO_OTP ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,
      662    19467    3               KH_OTPCHN );
      663    19468
      664    19469    3            KH_DWNLODLCT = KH_DWNLODLCT_C;
      665    19470    3            KH_DWNLODLCT.CHN$ = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$;
      666    19471    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.DVCID = '2978'X THEN
      667    19472    3               KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC16; /* MLC-16 (NMLC) */
      668    19473    3            ELSE
      669    19474    3               KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC8; /* MLC-8 (MLCP) */
      670    19475    3            KH_DWNLODLCT.CCPLCT$ = ADDR ( KZM$MLCP );
      671    19476    3            KH_DWNLODLCT.RCVINTLVL = %KZ#ACTLVL;
      672    19477    3            KH_DWNLODLCT.TRNINTLVL = 0;
      673    19478    3            CALL KHI$DWNLODLCT ( KH_DWNLODLCT )
      674    19479    4            WHENALTRETURN DO;
      675    19480        /*N* SNAP */
      676    19481    4               END;
      677    19482
      678    19483
      679    19484    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.CLK
      680    19485    4            THEN DO;
      681    19486    4               KH_OTPLCT = KH_OTPLCT_C;
      682    19487    4               KH_OTPLCT.LCTBYT.ADR = 20;
      683    19488    4               KH_OTPLCT.LCTBYT.DAT = KZM$MLCP.LCTBYT(20)+8;
      684    19489    4               CALL KHI$IO_OTPLCTBYT ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,
      685    19490    4                  KH_OTPLCT );
      686    19491    4               END;
      687    19492    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.CTX$ = ADDR(NIL);
      688    19493    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.LCT55 = 0;
      689    19494    3            CALL KHA$DVCADM ( %KHA_FNC_DISCONNECT_EVT,ERRORWORD,
      690    19495    3               KZ$EVENT.TERMID$->B$TERMINAL_ID,,);
      691    19496    3            CALL KHA$TSTCNC ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ )
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:22   
      692    19497    4            WHENRETURN DO;
      693    19498    4               KH_SETCLK = KH_SETCLK_C;
      694    19499    4               KH_SETCLK.CTBCTX$ = ADDR(NIL);
      695    19500    4               KH_SETCLK.UID$ = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$;
      696    19501    4               KH_SETCLK.SBR$ = ENTADDR( KZC$SEARCH_FOR_ACTIVITY );
      697    19502    4               CALL KHC$CLOCK ( KH_SETCLK );
      698    19503    4               END;
      699    19504    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ = ADDR(NIL);
      700    19505
      701    19506    3            END;
      702    19507    2         CALL RELBFR (SIZEW(RLS$STG),KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.RMTSS$);
      703    19508    2         CALL RELBFR (KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFRSIZ,
      704    19509    2            KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFR$);
      705    19510    2         CALL RELBFR ((KZ$EVENT.LINCTX$->KZ$LINCTX.INPRECSIZ+1)/2,
      706    19511    2            KZ$EVENT.LINCTX$->KZ$LINCTX.INPREC$);
      707    19512    2         BFR$=KZ$EVENT.LINCTX$->KZ$LINCTX.OTPHD$;
      708    19513    3         DO WHILE BFR$ ~= ADDR(NIL);
      709    19514    3            P$=BFR$->KZ$OTPBFR.LNK$;
      710    19515    3            CALL RELBFR (BFR$->KZ$OTPBFR.BFRSIZ,BFR$);
      711    19516    3            BFR$=P$;
      712    19517    3            END;
      713    19518    2         CALL RELBFR (SIZEW(KZ$LINCTX),KZ$EVENT.LINCTX$);
      714    19519    2         OK_TO_MUCK_CONTEXT='0'B;
      715    19520    2         RETURN;
      716    19521
      717    19522    2   END FREE_LINE;
      718    19523        /*    Cancel an outstanding clock                                  */
      719    19524    1   CNCLCLK: PROC (C$);
      720    19525
      721    19526    2   DCL C$ PTR;                        /* Clock context pointer        */
      722    19527
      723    19528    3         IF C$ ~= ADDR(NIL) THEN DO;
      724    19529    3            KH_CANCELCLK.CTBCTX$ = C$;
      725    19530    3            C$ = ADDR(NIL);
      726    19531    3            CALL KHC$CLOCK (KH_CANCELCLK);
      727    19532    3            END;
      728    19533    2         RETURN;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:23   
      729    19534
      730    19535    2   END CNCLCLK;
      731    19536
      732    19537    1   SETPRM: PROC ALTRET;
      733    19538
      734    19539    2   DCL TXT$ CPTR;
      735    19540
      736    19541    2         TXT$ = KZ$EVENT.CHNCTX$;
      737    19542    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO = '0'B;
      738    19543    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE = ( TXT$ -> KL_HASP.SLAVE# ~= '0'B );
      739    19544    2         TXT$ = PINCRC ( TXT$, TXT$ -> KL_HASP.BLKHDR.PROOFFSET );
      740    19545    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PRONAME.SIZE
      741    19546    2            = PINCRC (TXT$, 2) -> VLP_PNAME.L;
      742    19547    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PRONAME.TEXT
      743    19548    2            = PINCRC (TXT$, 2) -> VLP_PNAME.NAME;
      744    19549    2         TXT$ = PINCRW ( TXT$, ((TXT$ -> TL.L + 1)/2) );
      745    19550    2         TXT$ = PINCRC ( TXT$, 4 );
      746    19551    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = TXT$ -> KL_TRMD.PROTYP#;
      747    19552    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKRECS = TXT$ -> KL_TRMD.BLKRECS#;
      748    19553    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKBYTES = TXT$ -> KL_TRMD.BLKBYTES#;
      749    19554    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RETRYS = TXT$ -> KL_TRMD.RETRYS#;
      750    19555    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.DELAYS = TXT$ -> KL_TRMD.DELAYS#;
      751    19556    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.INTERVAL = TXT$ -> KL_TRMD.INTERVAL# * 12;
      752    19557    2         IF TXT$->KL_TRMD.COMPRESS# = %KLCO_LINE# THEN
      753    19558    2            IF KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.LINSPD = BITBIN(%KW#LINSPD19200
             19558                     ) THEN
      754    19559    2               KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.COMPRESS=%KLCO_NO#;
      755    19560    2            ELSE
      756    19561    2               KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.COMPRESS=%KLCO_YES#;
      757    19562    2         ELSE
      758    19563    2            KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.COMPRESS=TXT$->KL_TRMD.COMPRESS#;
      759    19564    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKRFPS = 0;
      760    19565    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKGFPS = 0;
      761    19566    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.EMCHR = BINBIT ( TXT$ -> KL_TRMD.EMCHR#, 8 )
             19566                  ;
      762    19567    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.IRSCHR = BINBIT ( TXT$ -> KL_TRMD.IRSCHR#, 8
             19567                  );
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:24   
      763    19568    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.MULSTRM = (TXT$->KL_TRMD.MULSTRM#~='0'B);
      764    19569    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.ACK0_UNSUSP = '0'B;
      765    19570    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.ACK0_UNWABS = '1'B;
      766    19571    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.FIRST = '1'B;
      767    19572    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RFP_ON_SUSP_OK = '1'B;
      768    19573    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SUSP_WAB_IGN = '1'B;
      769    19574    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.TRSPCY = '0'B;
      770    19575    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.LSTRECCTN = TXT$ -> KL_TRMD.LSTRECCTN#;
      771    19576    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.ERRDUPBLK = TXT$ -> KL_TRMD.ERRDUPBLK#;
      772    19577    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RRR = TXT$ -> KL_TRMD.RRR#;
      773    19578    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLC = TXT$ -> KL_TRMD.SLC#;
      774    19579    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLCALLBLK = TXT$ -> KL_TRMD.SLCALLBLK#;
      775    19580    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PADSIGNON = TXT$ -> KL_TRMD.PADSIGNON#;
      776    19581    2         X = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP * 2
      777    19582    2            + BITBIN ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE );
      778    19583    2         IF X > 0 AND X < KZ_NHDR
      779    19584    2            AND KZ_HDR$(X) ~= ADDR(NIL)
      780    19585    3         THEN DO;
      781    19586    3            P$ = KZ_HDR$ ( X );
      782    19587    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.STBL$ = P$ -> KZ$HDR.STBL$;
      783    19588    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.MAP$ = P$ -> KZ$HDR.EMAP$;
      784    19589    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINMGR@ = P$ -> KZ$HDR.LINHND@;
      785    19590    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@ = P$ -> KZ$HDR.DVCHND@;
      786    19591    3            KZ$EVENT.LINCTX$->KZ$LINCTX.IOMGR@ = ENTADDR(KZO$ORDERS);
      787    19592    3            KZ$EVENT.LINCTX$->KZ$LINCTX.INHLVL = KZ_INT_LEV;
      788    19593    4            IF KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.BLOCK = 0 THEN DO;
      789    19594    4               KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.BLOCK = KZR_THRTL_BLK;
      790    19595    4               KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.UNBLOCK = KZR_THRTL_UNBLK;
      791    19596    4               END;
      792    19597    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.INT = P$ -> KZ$HDR.INTRCT;
      793    19598    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.TIMOUT.PRIMARY = 20;
      794    19599    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.TIMOUT.SECONDARY = 20;
      795    19600    3            S$ = P$ -> KZ$HDR.STTBFR$;
      796    19601    3            IF S$ ~= ADDR(NIL)
      797    19602    4            THEN DO;
      798    19603        /*N*     Accrue statistics from initial connect here */
      799    19604
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:25   
      800    19605    4               END;
      801    19606    3            END;
      802    19607    3         ELSE DO;
      803    19608        /*E* ERROR:        KZP-E$NOPROT-6
      804    19609             MESSAGE:      That protocol is not in this BISYNC/:SHARED_LCP6_SYSTEM.
      805    19610             DESCRIPTION:  The handler for the protocol requested in the line
      806    19611                           profile for the associated logon is not present in
      807    19612                           this run unit (e.g., a 3270 connect was requested but
      808    19613                           the 3270 feature is not present).
      809    19614                           V0 = Protocol type:
      810    19615                                X'0002' = 2780, slave=no
      811    19616                                X'0004' = 3780, slave=no
      812    19617                                X'0006' = HASP, slave=no
      813    19618                                X'0007' = HASP, slave=yes
      814    19619                                X'0008' = POLLED, slave=no (multidrop 3270)
      815    19620                                X'0009' = Reserved for future use - Slave 3270
      816    19621                                X'000C' = Reserved for future use - HIP
      817    19622                                All others are not supported.
      818    19623                           DATA = Offending LOGON string in ASCII TEXTC.
      819    19624        */
      820    19625    3            PROTOCOL_LOG.BUF_ = VECTOR ( TXT$ -> KL_TRMD );
      821    19626    3            PROTOCOL_LOG.V.TERMID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINID;
      822    19627    3            PROTOCOL_LOG.V.VALUES (0) = X;
      823    19628    3            CALL KHA$ERRLOG ( PROTOCOL_LOG ) ALTRET ( IGNORE_PROTOCOL_LOG_ALTRET );
      824    19629    3   IGNORE_PROTOCOL_LOG_ALTRET:;
      825    19630        /*
      826    19631            Use PROTYP = 0 for our next trip through KZP$CNCDSC.
      827    19632        */
      828    19633    3   SETPRM_ALTRET:
      829    19634    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = 0;
      830    19635    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE = '0'B;
      831    19636    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PTHSTT = NEW_STATE;
      832    19637    3            OK_TO_MUCK_CONTEXT = '0'B;
      833    19638    3            KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;
      834    19639    3            KZ$EVENT.RESULT = '0'B;
      835    19640    3            CALL KZP$CNCDSC ( KZ$EVENT );
      836    19641    3            ALTRETURN;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:26   
      837    19642    3            END;
      838    19643        /**/
      839    19644        /*
      840    19645            Get space for the remote signon string if there is one..
      841    19646        */
      842    19647        /**/
      843    19648    2         TXT$ = ADDR ( KZ$EVENT.CHNCTX$ -> KL_HASP.RLS# );
      844    19649    2         IF TXT$ -> RLS$STG ~= ' '
      845    19650    3         THEN DO;
      846    19651    3            SZ = SIZEW(RLS$STG);
      847    19652
      848    19653    3            CALL KVB$GETSYS ( SZ, BUF$ )
      849    19654    4            WHENALTRETURN DO;
      850    19655        /*E* ERROR:        KZP-E$NO_MEMORY-6
      851    19656             MESSAGE:      Insufficient BISYNC MEMory (a NETCON parameter).
      852    19657             DESCRIPTION:  A KVB call ALTRETed to indicate that BISYNC is out of
      853    19658                           MEMory.  Since a necessary communications buffer
      854    19659                           could not be allocated, the BISYNC TERM/LINE associated
      855    19660                           with this request could not be connected.
      856    19661                           V0 = Size of buffer, in words, which could not be allocated.
      857    19662        */
      858    19663    4   MEMORY_ALTRET:
      859    19664    4               MEMORY_LOG.V.TERMID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINID;
      860    19665    4               MEMORY_LOG.V.VALUES (0) = SZ;
      861    19666    4               CALL KHA$ERRLOG ( MEMORY_LOG ) ALTRET ( IGNORE_MEMORY_LOG_ALTRET );
      862    19667    4   IGNORE_MEMORY_LOG_ALTRET:
      863    19668    4               GOTO SETPRM_ALTRET;
      864    19669    4               END;
      865    19670
      866    19671    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RMTSS$ = BUF$;
      867    19672    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RMTSS$ -> RLS$STG
      868    19673    3               = TXT$ -> RLS$STG;
      869    19674    3            END;
      870    19675
      871    19676        /*EH? IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP ~= %KLPT_POLL# THEN EH?*/
      872    19677    2         TXT$ =  KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFR$;
      873    19678    2         X = KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFRSIZ;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:27   
      874    19679    2         IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_POLL#
      875    19680    2            AND NOT KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE
      876    19681    2         THEN SZ = 128;
      877    19682    2         ELSE SZ = ( KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.BLKBYTES + 1 ) / 2;
      878    19683    2         CALL KVB$GETSYS ( SZ, BUF$ ) ALTRET ( MEMORY_ALTRET );
      879    19684    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.INPBFR$ = BUF$;
      880    19685    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.INPBFRSIZ = SZ;
      881    19686              /* Reset the MLCP address to the new input buffer before   */
      882    19687              /* releasing the old buffer that init had used             */
      883    19688    2         CALL KZO$ORDERS (%KZ#SEND_NOTHING,KZ$EVENT.LINCTX$->KZ$LINCTX);
      884    19689    2         CALL RELBFR (X,TXT$);
      885    19690
      886    19691    2         KH_OTPLCT = KH_OTPLCT_C;
      887    19692    2         KH_OTPLCT.LCTBYT.DAT = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.DELAYS;
      888    19693    2         KH_OTPLCT.LCTBYT.ADR = 59;
      889    19694    2         CALL KHI$IO_OTPLCTBYT (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN, KH_OTPLCT
             19694                  );
      890    19695
      891    19696    2   END SETPRM;
      892    19697
      893    19698        /*    Release a buffer                                             */
      894    19699    1   RELBFR: PROC (I,C$);
      895    19700
      896    19701    2   DCL C$ PTR;                        /* Buffer pointer               */
      897    19702    2   DCL I UBIN;                        /* Buffer size                  */
      898    19703
      899    19704    3         IF C$ ~= ADDR(NIL) THEN DO;
      900    19705    3            CALL KVB$RLSSYS (I,C$);
      901    19706    3            C$=ADDR(NIL);
      902    19707    3            END;
      903    19708    2         RETURN;
      904    19709    2   END RELBFR;
      905    19710
      906    19711    1   END KZP$CNCDSC;
      907    19712        %EOD;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:28   
--  Include file information  --

   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KW_ALCT_E.:E05TOU  is referenced.
   KZ_3270_C.:E05TOU  is referenced.
   KZ$OTPBFR.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KZ_CLMEVT_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   GH_IOFNC_E.:E05TOU  is referenced.
   KH$IO.:E05TOU  is referenced.
   KZ_MLCP_C.:E05TOU  is referenced.
   KZ_SCODE_C.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KZ$PROWRT.:E05TOU  is referenced.
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:29   
   KL_SUPER_C.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
      No diagnostics issued in procedure KZP$CNCDSC.

   Procedure KZP$CNCDSC requires 2289 words for executable code.
   Procedure KZP$CNCDSC requires 111 words of local(AUTO) storage.

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:30   

 Object Unit name= KZP$CNCDSC                                 File name= KZP$PSRV.:E05TOU
 UTS= JUL 30 '97 02:58:06.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS    221     DD  KZP$CNCDSC
    1   Data  even  none    63     3F  KZP$CNCDSC
    2   Proc  even  none  2289    8F1  KZP$CNCDSC
    3  RoData even  none    10      A  KZP$CNCDSC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  KZP$CNCDSC

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    1      0  MEMORY_LOG
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:31   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       2 KZO$ORDERS
         yes           Std       3 KZP$DRIVER
 yes     yes           Std       1 KHA$TSTCNC
         yes           Std       1 KHA$LINE_ACTIVE
 yes     yes           Std       6 KHA$DVCADM
         yes           Std       1 KZC$INTBID
 yes     yes           Std       2 KHA$ERRLOG
 yes     yes           Std       2 KHI$IO_OTP
 yes     yes           Std       2 KHI$IO_OTPLCTBYT
         yes           Std       1 KZC$SEARCH_FOR_ACTIVITY
 yes     yes           Std       1 KHC$CLOCK
 yes     yes           Std       1 KHI$DWNLODLCT
 yes     yes           Std       2 KVB$GETSYS
 yes     yes           Std       2 KVB$RLSSYS
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
                       nStd      0 X6A_AALT
                       nStd      0 X6B_BLR

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KZM$MLCP                              KZ_NHDR                               KZ_HDR$
     KZ_INT_LEV                            KZ_CCPLODBIS_MLC8                     KZ_CCPLODBIS_MLC16
     KZR_THRTL_BLK                         KZR_THRTL_UNBLK                  r    G$ROS$
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:32   


        1        1        /*M*     KZP$PSRV - Path services entry points                     */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC */
        8        8        /*P*     NAME:     KZP$PSRV
        9        9                 PURPOSE:  KZP$PSRV contains the path services entry points.
       10       10                           It's function is to process connect/disconnect
       11       11                           events as well as to drive the sync channel.  The
       12       12                           code in this module must run inhibited.         */
       13       13        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:33   
       14       14
       15       15        /*P*     NAME:     KZP$CNCDSC
       16       16                 PURPOSE:  KZP$CNCDSC provides the line to host interface
       17       17                           functionality which allows terminal/line connects
       18       18                           and disconnects.  The routine should be called
       19       19                           inhibited.  It is passed two arguments, the first
       20       20                           is the event code, and the second is the line
       21       21                           context.  From this information, the code decides
       22       22                           what to do based on a decision table.  Most of
       23       23                           the events are reported directly from the path
       24       24                           to the host.  Others are reported from the line
       25       25                           driver (%KZ#PTH_EVENT_LINBID, ..._LINACK, AND
       26       26                           ..._LINBLK).  The two remaining events are
       27       27                           reported by the device managers (..._LGNCMP,
       28       28                           and ..._DEVDSC).                                */
       29       29
       30       30        KZP$CNCDSC: PROC ( KZ$PARAM ) ALTRET;

     30   2 000000  D380 0000 0000  xent KZP$CNCDSC      LNJ,B5   X6A_AUTO_1
          2 000003       006F 0001                       DC       111,1

       31       31
       32       32        %INCLUDE KZ$LINCTX;
       33      652        %INCLUDE KL_SUPER_C;               /* To get protocol type EQUs  */
       34     3554        %INCLUDE KZ$PROWRT;
       35     3679        %INCLUDE KH$CHN;
       36     3801        %INCLUDE KZ_CLM_E;
       37     3973        %INCLUDE KZ_LIN_C;
       38     4029        %INCLUDE KZ_SCODE_C;
       39     4044        %INCLUDE KZ_MLCP_C;
       40     4119        %INCLUDE KH$IO;
       41     4366        %INCLUDE GH_IOFNC_E;
       42     4435        %INCLUDE KHA_FNC_E;
       43     4535        %INCLUDE KH_MACRO_C;
       44     5278        %INCLUDE KZ_CLMEVT_C;
       45     5320        %INCLUDE KZ$BSCSTT;
       46     5426        %INCLUDE KZ_INIT_C;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:34   
       47     5762        %INCLUDE KH$CLK;
       48     6132        %INCLUDE KH_CLKFNC_E;
       49     6177        %INCLUDE KZ_PERR_C;
       50     6259        %INCLUDE LCP_6;
       51    10538        %INCLUDE CP_6_SUBS;
       52    11078        %INCLUDE KV$GLB;
       53    11497        %INCLUDE KV_GLBCNS_E;
       54    11838        %INCLUDE KZ$OTPBFR;
       55    11939        %KV_INPOPRX_E;
       56    11951        %INCLUDE KZ_3270_C;
       57    12109        %KZ_3270_E;
       58    12237        %INCLUDE KW_ALCT_E;               /* For linespeed EQUs      */
       59    12427        %INCLUDE KL_MACRO_C;
       60    15779        %INCLUDE KL_AFCN_C;
       61    15880        %INCLUDE K_ID_E;
       62    15930        %K#ENTID_E;
       63    15949        %K#LYRID_E;
       64    15956
       65    15957           %KZ$EVENT           ( FPTN = KZ$PARAM,
       66    15958                                 STCLASS = PARAM );
       67    16040
       68    16041           %KZ$EVENT           ( FPTN = KZ$EVENT,
       69    16042                                 STCLASS = AUTO );
       70    16124
       71    16125           %KZ$LINCTX          ( STCLASS = BASED );
       72    16556
       73    16557           %KZ$OTPBFR          ( STCLASS = BASED );
       74    16622
       75    16623           %KZ$PROWRT          ( STCLASS = BASED );
       76    16660
       77    16661           %KZ_INIT_HDR        ( NAME = KZ$HDR,
       78    16662                                 STCLASS = BASED );
       79    16686
       80    16687           %KH$CHN             ( STCLASS = BASED );
       81    16811
       82    16812           %KH$CLK             ( FPTN = KH_SETCLK_C,
       83    16813                                 FNC = %KH#CLK_SETCLK,
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:35   
       84    16814                                 PRDUNT = %KH#C_SEC,
       85    16815                                 PRD = 5,
       86    16816                                 ACCURACY = 0,
       87    16817                                 STCLASS = CONSTANT );
       88    16966
       89    16967           %KH$CLK             ( FPTN = KH_SETCLK,
       90    16968                                 FNC = %KH#CLK_SETCLK,
       91    16969                                 STCLASS = AUTO );
       92    17118
       93    17119           %KH$CLK             ( FPTN = KH_CANCELCLK_C,
       94    17120                                 FNC = %KH#CLK_CANCEL,
       95    17121                                 STCLASS = CONSTANT );
       96    17270
       97    17271           %KH$CLK             ( FPTN = KH_CANCELCLK,
       98    17272                                 FNC = %KH#CLK_CANCEL,
       99    17273                                 STCLASS = AUTO );
      100    17422
      101    17423           %KH$CCPLCT          ( NAME = KZM$MLCP,
      102    17424                                 STCLASS = SYMREF );
      103    17450
      104    17451           %KH$DWNLODCCP       ( NAME = KH_DWNLODCCP_C,
      105    17452                                 CCPLODBIS = 0,
      106    17453                                 STCLASS = CONSTANT );
      107    17476
      108    17477           %KH$DWNLODCCP       ( NAME = KH_DWNLODCCP,
      109    17478                                 STCLASS = AUTO );
      110    17501
      111    17502           %KH$DWNLODLCT       ( NAME = KH_DWNLODLCT_C,
      112    17503                                 STCLASS = CONSTANT );
      113    17527
      114    17528           %KH$DWNLODLCT       ( NAME = KH_DWNLODLCT,
      115    17529                                 STCLASS = AUTO );
      116    17553
      117    17554           %KH$IO              ( FPTN = KH_OTPINT_C,
      118    17555                                 FNC = %GH#IO_OTPINTCTR,
      119    17556                                 STCLASS = CONSTANT );
      120    17670
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:36   
      121    17671           %KH$IO              ( FPTN = KH_OTPINT,
      122    17672                                 FNC = %GH#IO_OTPINTCTR,
      123    17673                                 STCLASS = AUTO );
      124    17787
      125    17788           %KH$IO              ( FPTN = KH_OTPLCT_C,
      126    17789                                 FNC = %GH#IO_OTPLCTBYT,
      127    17790                                 STCLASS = CONSTANT );
      128    17904
      129    17905           %KH$IO              ( FPTN = KH_OTPLCT,
      130    17906                                 FNC = %GH#IO_OTPLCTBYT,
      131    17907                                 STCLASS = AUTO );
      132    18021
      133    18022           %KH$IO              ( FPTN = KH_OTPCHN_C,
      134    18023                                 FNC = %GH#IO_OTPCHNCTR,
      135    18024                                 STCLASS = CONSTANT );
      136    18138
      137    18139           %KH$IO              ( FPTN = KH_OTPCHN,
      138    18140                                 FNC = %GH#IO_OTPCHNCTR,
      139    18141                                 STCLASS = AUTO );
      140    18255
      141    18256           %KL_TRMD            ( NAME = KL_TRMD,
      142    18257                                 STCLASS = "BASED CALIGNED" );
      143    18419
      144    18420           %KL_HASP            ( STCLASS = BASED );
      145    18570
      146    18571           %VLP_NAME           ( FPTN = VLP_PNAME,
      147    18572                                 LEN = VLP_PNAME.L,
      148    18573                                 STCLASS = "BASED UNAL" );
      149    18588
      150    18589           %B$TERMINAL_ID      ( FPTN = B$TERMINAL_ID,
      151    18590                                 STCLASS = BASED );
      152    18619
      153    18620           %B$TERMINAL_ID      ( FPTN = TERM_ID_C,
      154    18621                                 STCLASS = CONSTANT );
      155    18650
      156    18651           %B$TERMINAL_ID      ( FPTN = TERM_ID,
      157    18652                                 STCLASS = AUTO );
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:37   
      158    18681
      159    18682           %FPT_WRSYSLOG       ( FPTN = MEMORY_LOG,
      160    18683                                 FCG = 'KZ',
      161    18684                                 MID = 'P',
      162    18685                                 ERR = %E$NO_MEMORY,
      163    18686                                 SEV = %G_WRSYSLOG_SEV_LINE_ABORT#,
      164    18687                                 STCLASS = "STATIC SYMDEF" );
      165    18782
      166    18783           %FPT_WRSYSLOG       ( FPTN = PROTOCOL_LOG,
      167    18784                                 FCG = 'KZ',
      168    18785                                 MID = 'P',
      169    18786                                 ERR = %E$NOPROT,
      170    18787                                 SEV = %G_WRSYSLOG_SEV_LINE_ABORT#,
      171    18788                                 STCLASS = STATIC );
      172    18883
      173    18884           %FPT_WRSYSLOG       ( FPTN = VAMOOSE_LOG,
      174    18885                                 FCG = 'KZ',
      175    18886                                 MID = 'P',
      176    18887                                 ERR = %E$LINCNC,
      177    18888                                 SEV = %G_WRSYSLOG_SEV_INFO#,
      178    18889                                 STCLASS = STATIC );
      179    18984
      180    18985    1   DCL KZ_NHDR UBIN WORD SYMREF;
      181    18986    1   DCL KZ_HDR$(0:0) PTR SYMREF;
      182    18987    1   DCL KZ_INT_LEV UBIN SYMREF;
      183    18988    1   DCL KZ_CCPLODBIS_MLC8 UBIN WORD SYMREF;
      184    18989    1   DCL KZ_CCPLODBIS_MLC16 UBIN WORD SYMREF;
      185    18990    1   DCL KZR_THRTL_BLK UBIN SYMREF;
      186    18991    1   DCL KZR_THRTL_UNBLK UBIN SYMREF;
      187    18992    1   DCL KHC$CLOCK ENTRY(1) ALTRET;
      188    18993    1   DCL KZC$INTBID ENTRY (1);
      189    18994    1   DCL KHI$IO_OTP ENTRY (2) ALTRET;
      190    18995    1   DCL KHI$IO_OTPLCTBYT ENTRY (2) ALTRET;
      191    18996    1   DCL KZC$SEARCH_FOR_ACTIVITY ENTRY (1);
      192    18997        /*N* DCL KZC$SCREECH ENTRY (1) ALTRET; */
      193    18998    1   DCL KVB$GETSYS ENTRY (2) ALTRET;
      194    18999    1   DCL KVB$RLSSYS ENTRY (2) ALTRET;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:38   
      195    19000    1   DCL KZP$DRIVER ENTRY(3);
      196    19001    1   DCL KZO$ORDERS ENTRY(2);
      197    19002    1   DCL KHA$DVCADM ENTRY (6) ALTRET;
      198    19003    1   DCL KHA$TSTCNC ENTRY(1) ALTRET;
      199    19004    1   DCL KHI$DWNLODLCT ENTRY (1) ALTRET;
      200    19005    1   DCL KHA$LINE_ACTIVE ENTRY (1);
      201    19006    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
      202    19007    1   DCL LCT$ PTR;
      203    19008    1   DCL BFR$ PTR;
      204    19009    1   DCL BUF$ PTR;
      205    19010    1   DCL SZ UBIN;
      206    19011    1   DCL 1 TL BASED CALIGNED,
      207    19012    1         2 T UBIN BYTE UNAL,
      208    19013    1         2 L UBIN BYTE UNAL;
      209    19014    1   DCL 1 LCT_HEADER BASED ALIGNED,
      210    19015    1         2 BFR$ PTR,
      211    19016    1         2 SIZE UBIN WORD;
      212    19017    1   DCL RLS$STG CHAR(80) BASED;
      213    19018        %EQU YES='1'B;
      214    19019        %EQU NO='0'B;
      215    19020
      216    19021    1   DCL KZ_CNCDSC_TABLE(0:%(20*16-1)) UBIN BYTE UNAL CONSTANT INIT (
      217    19022        /*                 L  R  B  C  L  L     K   D  D  L  D  S  C
      218    19023                           I  Q  L  T  G  I     I   S  S  I  E  U  N
      219    19024                           S  S  D  X  N  N     L   A  C  N  V  B  C
      220    19025                           T  L  C  C  C  A     L   B  T  D  D  C  R
      221    19026                           E  P  T  M  M  C     E   L  R  S  S  N  Q
      222    19027                           N  R  X  P  P  K     D   D  M  C  C  C  S        */
      223    19028    1   /* 00 INTNUL  */  01,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      224    19029    1   /* 01 LISTEN  */  25,02,25,25,25,25,25,12, 12,12,25,15,25,25,25,25,
      225    19030    1   /* 02 RQSLPR  */  25,25,03,25,25,25,25,13, 13,13,25,15,25,25,25,25,
      226    19031    1   /* 03 BLDCTX  */  25,25,03,04,25,25,25,13, 13,13,25,15,16,17,25,25,
      227    19032    1   /* 04 CTXCMP  */  25,25,25,25,10,25,25,11, 11,11,25,15,16,17,25,25,
      228    19033    1   /* 05 INTPRO  */  06,25,25,25,25,25,25,25, 12,25,25,25,25,25,25,25,
      229    19034    1   /* 06 AUTORQS */  25,25,07,25,25,25,25,13, 13,13,25,25,25,25,25,25,
      230    19035    1   /* 07 AUTOBLD */  25,25,07,08,25,25,25,13, 13,13,25,15,16,17,25,25,
      231    19036    1   /* 08 AUTOCTX */  25,25,25,25,09,25,25,11, 11,11,25,15,16,17,25,25,
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:39   
      232    19037    1   /* 09 AUTOCMP */  25,25,25,25,25,10,25,11, 11,11,25,15,16,17,25,25,
      233    19038    1   /* 10 VAMOOSE */  25,25,25,25,25,25,25,11, 24,11,12,15,16,17,25,25,
      234    19039    1   /* 11 DSCDEV  */  25,24,25,25,24,24,25,24, 24,24,12,15,25,17,25,25,
      235    19040    1   /* 12 LINDONE */  25,25,25,25,25,25,25,24, 24,24,25,25,25,25,25,25,
      236    19041    1   /* 13 DSCPND1 */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      237    19042    1   /* 14 DSCPND2 */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      238    19043        /*---------Non Line Manager Events---------------------------------*/
      239    19044    1   /* 15 DEVDONE */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      240    19045    1   /* 16 DEVCNC  */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      241    19046    1   /* 17 CNCRQS  */  25,25,25,25,25,25,25,25, 25,25,25,25,25,25,25,25,
      242    19047    1                     25*0 );
      243    19048
      244    19049
      245    19050
      246    19051        /*       Convert KZ#CLM_EVENT_nn to KZ#LINFCN_mm                   */
      247    19052
      248    19053    1   DCL KZ_DEVFNC_MAP ( 0:15 ) UBIN WORD CONSTANT
      249    19054    1          UNAL INIT ( %KZ#LINFCN_NOP,
      250    19055    1                      %KZ#LINFCN_NOP,
      251    19056    1                      %KZ#LINFCN_NOP,
      252    19057    1                      %KZ#LINFCN_NOP,
      253    19058    1                      %KZ#LINFCN_NOP,
      254    19059    1                      %KZ#LINFCN_NOP,
      255    19060    1                      %KZ#LINFCN_NOP,
      256    19061    1                      %KZ#LINFCN_KILL,
      257    19062    1                      %KZ#LINFCN_DISABL,
      258    19063    1                      %KZ#LINFCN_DSCTRM,
      259    19064    1                      %KZ#LINFCN_NOP,
      260    19065    1                      %KZ#LINFCN_NOP,
      261    19066    1                      %KZ#LINFCN_NOP,
      262    19067    1                      %KZ#LINFCN_NOP,
      263    19068    1                      %KZ#LINFCN_NOP,
      264    19069    1                      %KZ#LINFCN_NOP);
      265    19070    1   DCL EVENT UBIN WORD;
      266    19071    1   DCL TXT$ PTR;
      267    19072    1   DCL TXTX UBIN WORD;
      268    19073    1   DCL OK_TO_MUCK_CONTEXT BIT(1);
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:40   
      269    19074    1   DCL NEW_STATE UBIN WORD;
      270    19075    1   DCL OLD_STATE UBIN WORD;
      271    19076    1   DCL 1 R4_IOINFO ALIGNED,
      272    19077    1         2 CHN BIT(10) UNAL,
      273    19078    1         2 FNC UBIN(6) UNAL;
      274    19079    1   DCL 1 R5_IOINFO ALIGNED,
      275    19080    1         2 LCTVAL UBIN BYTE CALIGNED,
      276    19081    1         2 LCTADR UBIN BYTE CALIGNED;
      277    19082    1   DCL I UBIN WORD;
      278    19083    1   DCL X UBIN WORD;
      279    19084    1   DCL ERRORWORD UBIN WORD;
      280    19085    1   DCL S$ PTR;
      281    19086    1   DCL P$ PTR;
      282    19087    1   DCL 1 TEXTC BASED ALIGNED,
      283    19088    1         2 SIZE UBIN BYTE CALIGNED,
      284    19089    1         2 TEXT CHAR(TEXTC.SIZE) CALIGNED;
      285    19090        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:41   
      286    19091    1         KZ$EVENT = KZ$PARAM;

  19091   2 000005  ACC7 0004                            LDB,B2   @KZ$PARAM,AUTO
          2 000007  2C00                                 LDV,R2   0
          2 000008  6C1C                                 LDV,R6   28
          2 000009  BB87                                 LAB,B3   ,AUTO
          2 00000A  3C0C                                 LDV,R3   12
          2 00000B  0008                                 MMM

      287    19092    1         KZ$EVENT.RESULT = '0'B;

  19092   2 00000C  8747 0012                            CL       KZ$EVENT+12,AUTO
          2 00000E  8747 0013                            CL       KZ$EVENT+13,AUTO

      288    19093
      289    19094    1         CALL CNCDSC;

  19094   2 000010  E3C0 0026                            LNJ,B6   s:0,PREL
          2 000012       0001                            DC       s:19096,PREL

      290    19095
      291    19096    1         IF OK_TO_MUCK_CONTEXT

  19096   2 000013  89C7 004C                            CMZ      OK_TO_MUCK_CONTEXT,AUTO
          2 000015  0881 0010                            BAGE     s:19104,PREL

      292    19097    2         THEN DO;

      293    19098    2            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE

  19098   2 000017  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000019  89C6 0034                            CMZ      52,B6
          2 00001B  0881 0007                            BAGE     s:19102,PREL

      294    19099    2            THEN
      295    19100    2               KZ$EVENT.LINCTX$ -> KZ$LINCTX.PTHSTT = NEW_STATE;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:42   
  19100   2 00001D  E847 004D                            LDR,R6   NEW_STATE,AUTO
          2 00001F  EF46 000D                            STR,R6   13,B6
          2 000021  0F81 0004                            B        s:19104,PREL

      296    19101    2            ELSE
      297    19102    2               KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %YES;

  19102   2 000023  8946 0034                            LBT,'8000'X       52,B6
  19102   2 000025       8000

      298    19103    2            END;

      299    19104    1         IF KZ$EVENT.RESULT = '0'B

  19104   2 000026  EB80 0000 0000  03                   LAB,B6   0
          2 000029  5C01                                 LDV,R5   1
          2 00002A  0022                                 ACM      ;
          2 00002B       4407 0012                                ALPHANUM(KZ$EVENT+12,AUTO,,4,FILL),;
          2 00002D       4006 0000                                ALPHANUM(0,B6,,R5,FILL)
          2 00002F  5301 0004                            CBNE     s:19108,PREL

      300    19105    1         THEN
      301    19106    1            RETURN;

  19106   2 000031  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      302    19107    1         ELSE
      303    19108    1            ALTRETURN;

  19108   2 000034  C380 0000 0000  xent                 LNJ,B4   X6A_AALT

      304    19109        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:43   
      305    19110    1   CNCDSC: PROC ALTRET;

  19110   2 000037  EFC7 0058            CNCDSC          STB,B6   P$+2,AUTO

      306    19111    2         NEW_STATE = KZ_CNCDSC_TABLE ( KZ$EVENT.LINCTX$

  19111   2 000039  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 00003B  E845 000D                            LDR,R6   13,B5
          2 00003D  6004                                 SOL,R6   4
          2 00003E  EA47 0006                            ADD,R6   KZ$EVENT,AUTO
          2 000040  B856                                 LDR,R3   R6
          2 000041  E2B0 0000 002D  00                   LLH,R6   KZ_CNCDSC_TABLE,R3
          2 000044  EF47 004D                            STR,R6   NEW_STATE,AUTO

      307    19112    2            -> KZ$LINCTX.PTHSTT * 16 + KZ$EVENT.EVENT );
      308    19113    2         OK_TO_MUCK_CONTEXT = '1'B;

  19113   2 000046  8947 004C                            LBT,'8000'X       OK_TO_MUCK_CONTEXT,AUTO
  19113   2 000048       8000

      309    19114
      310    19115    2         I = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP * 2

  19115   2 000049  D845 004B                            LDR,R5   75,B5
          2 00004B  504F                                 SOR,R5   15
          2 00004C  C845 003A                            LDR,R4   58,B5
          2 00004E  4001                                 SOL,R4   1
          2 00004F  CA55                                 ADD,R4   R5
          2 000050  CF47 0051                            STR,R4   I,AUTO

      311    19116    2            + BITBIN (KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE);
      312    19117    2         S$ = KZ_HDR$(I) -> KZ$HDR.STTBFR$;

  19117   2 000052  B854                                 LDR,R3   R4
          2 000053  CCB0 0000 0000  xsym                 LDB,B4   KZ_HDR$,R3
          2 000056  BCC4 0006                            LDB,B3   6,B4
          2 000058  BFC7 0054                            STB,B3   S$,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:44   

      313    19118    3         DO CASE ( NEW_STATE );

  19118   2 00005A  A856                                 LDR,R2   R6
          2 00005B  2D1A                                 CMV,R2   26
          2 00005C  0281 029B                            BGE      s:19419,PREL
          2 00005E  9820 0000 0064  02                   LDR,R1   s:19118+10,R2
          2 000061  8390 0000 007E  02                   JMP      s:19134,R1
          2 000064       027A                            DC       s:19419,PREL
          2 000065       0000                            DC       s:19134,PREL
          2 000066       0036                            DC       s:19155,PREL
          2 000067       005F                            DC       s:19169,PREL
          2 000068       0089                            DC       s:19192,PREL
          2 000069       027A                            DC       s:19419,PREL
          2 00006A       00BE                            DC       s:19223,PREL
          2 00006B       005F                            DC       s:19169,PREL
          2 00006C       009A                            DC       s:19202,PREL
          2 00006D       00E8                            DC       s:19240,PREL
          2 00006E       0211                            DC       s:19361,PREL
          2 00006F       0110                            DC       s:19264,PREL
          2 000070       0178                            DC       s:19302,PREL
          2 000071       017D                            DC       s:19310,PREL
          2 000072       027A                            DC       s:19419,PREL
          2 000073       01AA                            DC       s:19325,PREL
          2 000074       01CF                            DC       s:19337,PREL
          2 000075       01F4                            DC       s:19348,PREL
          2 000076       027A                            DC       s:19419,PREL
          2 000077       027A                            DC       s:19419,PREL
          2 000078       027A                            DC       s:19419,PREL
          2 000079       027A                            DC       s:19419,PREL
          2 00007A       027A                            DC       s:19419,PREL
          2 00007B       027A                            DC       s:19419,PREL
          2 00007C       0270                            DC       s:19398,PREL
          2 00007D       0276                            DC       s:19415,PREL

      314    19119
      315    19120        /**/
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:45   
      316    19121        /*
      317    19122            Null states
      318    19123        */
      319    19124        /**/
      320    19125    3          CASE ( %KZ#CLM_STATE_INTNUL,

      321    19126    3            %KZ#CLM_STATE_INTPRO );
      322    19127        /**/
      323    19128        /*
      324    19129            Post read on line for initial bid
      325    19130        */
      326    19131        /**/
      327    19132    3          CASE ( %KZ#CLM_STATE_LISTEN );

      328    19133
      329    19134    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.STBL$

  19134   2 00007E  AC80 0000 0000  xsym                 LDB,B2   KZ_HDR$
          2 000081  9CC2 000D                            LDB,B1   13,B2
          2 000083  9FC5 000F                            STB,B1   15,B5

      330    19135    3               = KZ_HDR$ (0) -> KZ$HDR.STBL$;
      331    19136    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.MAP$

  19136   2 000085  ECC2 000B                            LDB,B6   11,B2
          2 000087  EFC5 0011                            STB,B6   17,B5

      332    19137    3               = KZ_HDR$ (0) -> KZ$HDR.EMAP$;
      333    19138    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINMGR@

  19138   2 000089  CC82                                 LDB,B4   ,B2
          2 00008A  CFC5 0070                            STB,B4   112,B5

      334    19139    3               = KZ_HDR$ (0) -> KZ$HDR.LINHND@;
      335    19140    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@

  19140   2 00008C  ECC2 0002                            LDB,B6   2,B2
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:46   
          2 00008E  EFC5 006E                            STB,B6   110,B5

      336    19141    3               = KZ_HDR$ (0) -> KZ$HDR.DVCHND@;
      337    19142    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.IOMGR@ = ENTADDR(KZO$ORDERS);

  19142   2 000090  EB80 0000 0000  xent                 LAB,B6   KZO$ORDERS
          2 000093  EFC5 0072                            STB,B6   114,B5

      338    19143    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.INHLVL = KZ_INT_LEV;

  19143   2 000095  9800 0000 0000  xsym                 LDR,R1   KZ_INT_LEV
          2 000098  9F45 0035                            STR,R1   53,B5

      339    19144    3            CALL SETCMPLVL;

  19144   2 00009A  E3C0 0261                            LNJ,B6   s:0,PREL
          2 00009C       0001                            DC       s:19145,PREL

      340    19145    3            CALL KZP$DRIVER ( KZ$EVENT.LINCTX$ -> KZ$LINCTX,

  19145   2 00009D  EBF0 0001                            LAB,B6   1,IMO
          2 00009F  DB80 0000 0000                       LAB,B5   0
          2 0000A2  DFC7 0068                            STB,B5   @C$+6,AUTO
          2 0000A4  EFC7 0066                            STB,B6   @C$+4,AUTO
          2 0000A6  CCC7 0009                            LDB,B4   KZ$EVENT+3,AUTO
          2 0000A8  CFC7 0064                            STB,B4   @C$+2,AUTO
          2 0000AA  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0000AC  CBF0 0300                            LAB,B4   768,IMO
          2 0000AE  E380 0000 0000  xent                 LNJ,B6   KZP$DRIVER
          2 0000B1       0001                            DC       s:19145+21,PREL
          2 0000B2  0F81 0245                            B        s:19419,PREL

      341    19146    3               %KZ#LIN_EVENT_GO, );
      342    19147        /**/
      343    19148        /*
      344    19149            Bid received - request profile info from Handler Common
      345    19150        */
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:47   
      346    19151        /**/
      347    19152    3          CASE ( %KZ#CLM_STATE_RQSLPR );

      348    19153
      349    19154        /*N*   CALL KHA$GETTERMID */
      350    19155    3            TERM_ID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.TERMID;

  19155   2 0000B4  ACC5 0002                            LDB,B2   2,B5
          2 0000B6  2C24                                 LDV,R2   36
          2 0000B7  6C10                                 LDV,R6   16
          2 0000B8  BB87                                 LAB,B3   ,AUTO
          2 0000B9  3C72                                 LDV,R3   114
          2 0000BA  0008                                 MMM

      351    19156    3            TERM_ID.TTYP = %KLTY_STRM#;              /* SYNC term */

  19156   2 0000BB  6C03                                 LDV,R6   3
          2 0000BC  E7C7 0039                            STH,R6   TERM_ID,AUTO

      352    19157    3            CALL KHA$DVCADM ( %KHA_FNC_RQSLINPRO,

  19157   2 0000BE  EBF0 0012                            LAB,B6   18,IMO
          2 0000C0  DBC7 000F                            LAB,B5   KZ$EVENT+9,AUTO
          2 0000C2  DFC7 006C                            STB,B5   @C$+10,AUTO
          2 0000C4  CB80 0000 0000                       LAB,B4   0
          2 0000C7  CFC7 006A                            STB,B4   @C$+8,AUTO
          2 0000C9  ABC7 0039                            LAB,B2   TERM_ID,AUTO
          2 0000CB  AFC7 0068                            STB,B2   @C$+6,AUTO
          2 0000CD  9BC7 0053                            LAB,B1   ERRORWORD,AUTO
          2 0000CF  9FC7 0066                            STB,B1   @C$+4,AUTO
          2 0000D1  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 0000D3  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0000D5  CBF0 0500                            LAB,B4   1280,IMO
          2 0000D7  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          2 0000DA       0001                            DC       s:19157+29,PREL
          2 0000DB  0F81 021C                            B        s:19419,PREL

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:48   
      353    19158    3               ERRORWORD,
      354    19159    3               TERM_ID,,
      355    19160    3               KZ$EVENT.LGNVEC );
      356    19161
      357    19162        /**/
      358    19163        /*
      359    19164            Profile context received from host (via Handler Common)
      360    19165        */
      361    19166        /**/
      362    19167    3          CASE ( %KZ#CLM_STATE_BLDCTX, %KZ#CLM_STATE_AUTOBLD );

      363    19168
      364    19169    4            DO CASE ( KZ$EVENT.TERMID$ -> B$TERMINAL_ID.LEV );

  19169   2 0000DD  ACC7 000B                            LDB,B2   KZ$EVENT+5,AUTO
          2 0000DF  B802                                 LDR,R3   ,B2
          2 0000E0  B570 00FF                            AND,R3   255,IMO
          2 0000E2  3D04                                 CMV,R3   4
          2 0000E3  0281 0214                            BGE      s:19419,PREL
          2 0000E5  A830 0000 00EB  02                   LDR,R2   s:19169+14,R3
          2 0000E8  83A0 0000 00EF  02                   JMP      s:19173,R2
          2 0000EB       0016                            DC       s:19184,PREL
          2 0000EC       0000                            DC       s:19173,PREL
          2 0000ED       0005                            DC       s:19178,PREL
          2 0000EE       0005                            DC       s:19178,PREL

      365    19170
      366    19171    4             CASE ( %TERMINAL_ID_LEV_CHAN# );

      367    19172
      368    19173    4               CALL SETPRM;

  19173   2 0000EF  E3C0 0429                            LNJ,B6   s:0,PREL
          2 0000F1       0001                            DC       s:19173+3,PREL
          2 0000F2  0F81 0205                            B        s:19419,PREL

      369    19174
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:49   
      370    19175    4             CASE ( %TERMINAL_ID_LEV_SUBCHAN#,

      371    19176    4                  %TERMINAL_ID_LEV_SUBSUBCHAN# );
      372    19177
      373    19178    4               KZ$EVENT.EVENT = %KZ#LINFCN_BLDCTX;

  19178   2 0000F4  1C08                                 LDV,R1   8
          2 0000F5  9F47 0006                            STR,R1   KZ$EVENT,AUTO

      374    19179    4               CALL KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@

  19179   2 0000F7  CBC7 0006                            LAB,B4   KZ$EVENT,AUTO
          2 0000F9  CFC7 0064                            STB,B4   @C$+2,AUTO
          2 0000FB  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0000FD  9CC5 006E                            LDB,B1   110,B5
          2 0000FF  CBF0 0100                            LAB,B4   256,IMO
          2 000101  E381                                 LNJ,B6   ,B1
          2 000102       0001                            DC       s:19179+12,PREL
          2 000103  0F81 01F4                            B        s:19419,PREL

      375    19180    4                  ( KZ$EVENT );
      376    19181
      377    19182    4             CASE ( ELSE );

      378    19183
      379    19184    4             END;

  19184   2 000105  0F81 01F2                            B        s:19419,PREL

      380    19185        /**/
      381    19186        /*
      382    19187            End of profile context for the specified channel
      383    19188        */
      384    19189        /**/
      385    19190    3          CASE ( %KZ#CLM_STATE_CTXCMP );

      386    19191
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:50   
      387    19192    3            KZ$EVENT.EVENT = %KZ#LINFCN_CTXCMP;

  19192   2 000107  6C14                                 LDV,R6   20
          2 000108  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      388    19193    3            CALL KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@

  19193   2 00010A  ABC7 0006                            LAB,B2   KZ$EVENT,AUTO
          2 00010C  AFC7 0064                            STB,B2   @C$+2,AUTO
          2 00010E  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000110  9CC5 006E                            LDB,B1   110,B5
          2 000112  CBF0 0100                            LAB,B4   256,IMO
          2 000114  E381                                 LNJ,B6   ,B1
          2 000115       0001                            DC       s:19193+12,PREL
          2 000116  0F81 01E1                            B        s:19419,PREL

      389    19194    3               ( KZ$EVENT );
      390    19195        /**/
      391    19196        /*
      392    19197             End of profile context for autologged channel
      393    19198        */
      394    19199        /**/
      395    19200    3          CASE ( %KZ#CLM_STATE_AUTOCTX);

      396    19201
      397    19202    3            KZ$EVENT.EVENT = %KZ#LINFCN_CTXCMP;

  19202   2 000118  6C14                                 LDV,R6   20
          2 000119  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      398    19203    3            CALL KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@

  19203   2 00011B  ABC7 0006                            LAB,B2   KZ$EVENT,AUTO
          2 00011D  AFC7 0064                            STB,B2   @C$+2,AUTO
          2 00011F  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000121  9CC5 006E                            LDB,B1   110,B5
          2 000123  CBF0 0100                            LAB,B4   256,IMO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:51   
          2 000125  E381                                 LNJ,B6   ,B1
          2 000126       0001                            DC       s:19205,PREL

      399    19204    3               ( KZ$EVENT );
      400    19205    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.SIGNON = '1'B;

  19205   2 000127  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000129  8946 0034                            LBT,'0040'X       52,B6
          2 00012B       0040

      401    19206
      402    19207    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_POLL#

  19207   2 00012C  E846 003A                            LDR,R6   58,B6
          2 00012E  6D04                                 CMV,R6   4
          2 00012F  0901 0007                            BE       s:19211,PREL
          2 000131  6D05                                 CMV,R6   5
          2 000132  0901 0004                            BE       s:19211,PREL
          2 000134  6D06                                 CMV,R6   6
          2 000135  0981 01C2                            BNE      s:19419,PREL

      403    19208    3               OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_3275#
      404    19209    3               OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_HIP#
      405    19210    4            THEN DO;                 /* Not RBT. Don't expect LGNCMP. */

      406    19211    4               NEW_STATE = %KZ#CLM_STATE_VAMOOSE;

  19211   2 000137  5C0A                                 LDV,R5   10
          2 000138  DF47 004D                            STR,R5   NEW_STATE,AUTO

      407    19212    4               GOTO VAMOOSE_3270;

  19212   2 00013A  0F81 0154                            B        s:19361,PREL

      408    19213    4               END;
      409    19214
      410    19215        /**/
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:52   
      411    19216        /*
      412    19217            Request profile info for autolog device
      413    19218        */
      414    19219        /**/
      415    19220    3          CASE ( %KZ#CLM_STATE_AUTORQS );

      416    19221
      417    19222        /*N*   CALL KHA$GETTERMID */
      418    19223    3            TERM_ID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.TERMID;

  19223   2 00013C  ACC5 0002                            LDB,B2   2,B5
          2 00013E  2C24                                 LDV,R2   36
          2 00013F  6C10                                 LDV,R6   16
          2 000140  BB87                                 LAB,B3   ,AUTO
          2 000141  3C72                                 LDV,R3   114
          2 000142  0008                                 MMM

      419    19224    3            TERM_ID.TTYP = %KLTY_STRM#;              /* SYNC term */

  19224   2 000143  6C03                                 LDV,R6   3
          2 000144  E7C7 0039                            STH,R6   TERM_ID,AUTO

      420    19225    3            CALL KHA$DVCADM ( %KHA_FNC_RQSLINPRO,

  19225   2 000146  EBF0 0012                            LAB,B6   18,IMO
          2 000148  DB80 0000 0000                       LAB,B5   0
          2 00014B  DFC7 006C                            STB,B5   @C$+10,AUTO
          2 00014D  CB80 0000 0000                       LAB,B4   0
          2 000150  CFC7 006A                            STB,B4   @C$+8,AUTO
          2 000152  ABC7 0039                            LAB,B2   TERM_ID,AUTO
          2 000154  AFC7 0068                            STB,B2   @C$+6,AUTO
          2 000156  9BC7 0053                            LAB,B1   ERRORWORD,AUTO
          2 000158  9FC7 0066                            STB,B1   @C$+4,AUTO
          2 00015A  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 00015C  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00015E  CBF0 0500                            LAB,B4   1280,IMO
          2 000160  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:53   
          2 000163       0001                            DC       s:19225+30,PREL
          2 000164  0F81 0193                            B        s:19419,PREL

      421    19226    3               ERRORWORD,
      422    19227    3               TERM_ID,, );
      423    19228
      424    19229        /**/
      425    19230        /*
      426    19231            Logon complete event from protocol hander.  When we are thru
      427    19232            passing profile context to the handler(s), they logon all devices
      428    19233            on the channel via VDH.  Upon completion of the device logons
      429    19234            they event CLM with Logon complete.  Remember CLM does line logons,
      430    19235            the handlers do device logons.
      431    19236        */
      432    19237        /**/
      433    19238    3          CASE ( %KZ#CLM_STATE_AUTOCMP );

      434    19239
      435    19240    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_HASP#

  19240   2 000166  E845 003A                            LDR,R6   58,B5
          2 000168  6D03                                 CMV,R6   3
          2 000169  0901 0004                            BE       s:19243,PREL
          2 00016B  6D07                                 CMV,R6   7
          2 00016C  0981 001C                            BNE      s:19255,PREL

      436    19241    3               OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_NJE#
      437    19242    4            THEN DO;               /* HASP      */

      438    19243    4               KZ$EVENT.LINCTX$->KZ$LINCTX.BCB.RCV=15; /*Init block sequence */

  19243   2 00016E  6C0F                                 LDV,R6   15
          2 00016F  E7C5 004D                            STH,R6   77,B5

      439    19244    4               IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE

  19244   2 000171  89C5 004B                            CMZ      75,B5
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:54   
          2 000173  0801 0006                            BAL      s:19247,PREL
          2 000175  9845 003A                            LDR,R1   58,B5
          2 000177  1D07                                 CMV,R1   7
          2 000178  0981 000E                            BNE      s:19253,PREL

      440    19245    4                  OR KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_NJE#
      441    19246    5               THEN DO;

      442    19247    5                  CALL SETCMPLVL;

  19247   2 00017A  E3C0 0181                            LNJ,B6   s:0,PREL
          2 00017C       0001                            DC       s:19248,PREL

      443    19248    5                  CALL KZC$INTBID ( KZ$EVENT.LINCTX$ -> KZ$LINCTX );

  19248   2 00017D  BBC7 0009                            LAB,B3   KZ$EVENT+3,AUTO
          2 00017F  CBF0 0100                            LAB,B4   256,IMO
          2 000181  E380 0000 0000  xent                 LNJ,B6   KZC$INTBID
          2 000184       0001                            DC       s:19249,PREL

      444    19249    5                  END;

  19249   2 000185  0F81 0172                            B        s:19419,PREL

      445    19250    5               ELSE DO;

      446    19251        /*N*          HASP MASTER with autologon is an error of some kind */
      447    19252    5                  END;

      448    19253    4               END;

  19253   2 000187  0F81 0170                            B        s:19419,PREL

      449    19254    4            ELSE DO;                 /* 2780/3780 */

      450    19255    4               NEW_STATE = %KZ#CLM_STATE_VAMOOSE;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:55   
  19255   2 000189  2C0A                                 LDV,R2   10
          2 00018A  AF47 004D                            STR,R2   NEW_STATE,AUTO

      451    19256    4               GOTO VAMOOSE_3270;

  19256   2 00018C  0F81 0102                            B        s:19361,PREL

      452    19257    4               END;
      453    19258
      454    19259        /**/
      455    19260        /*
      456    19261            Initiate disconnect
      457    19262        */
      458    19263        /**/
      459    19264    3          CASE ( %KZ#CLM_STATE_DSCDEV );

      460    19265    3   INITIATE_DISCONNECT:;

  19265   2                              INITIATE_DISCON*null
      461    19266
      462    19267    4            IF KZ$EVENT.LINCTX$->KZ$LINCTX.DEVMGR@ = ENTADDR(NIL) THEN DO;

  19267   2 00018E  ECC7 0009            INITIATE_DISCON*LDB,B6   KZ$EVENT+3,AUTO
          2 000190  DCC6 006E                            LDB,B5   110,B6
          2 000192  DD80 0000 0001  03                   CMB,B5   +1
          2 000195  0981 0009                            BNE      s:19278,PREL

      463    19268    4               NEW_STATE = %KZ#CLM_STATE_LINDONE;

  19268   2 000197  6C0C                                 LDV,R6   12
          2 000198  EF47 004D                            STR,R6   NEW_STATE,AUTO

      464    19269    4               CALL FREE_LINE;

  19269   2 00019A  E3C0 01CB                            LNJ,B6   s:0,PREL
          2 00019C       0001                            DC       s:19270,PREL

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:56   
      465    19270    4               END;

  19270   2 00019D  0F81 003F                            B        s:19291,PREL

      466    19271    4            ELSE DO;

      467    19272
      468    19273                 /* NEWSTATE is assigned in advance on line level disconnects
      469    19274                    because protocol handlers with no VDH context will call
      470    19275                    with function LINDSC prior to returning from the DEVMGR@
      471    19276                    call (below). */
      472    19277
      473    19278    4               KZ$EVENT.LINCTX$->KZ$LINCTX.FLAGS.NEWSTATE = %NO;

  19278   2 00019F  8846 0034                            LBF,'8000'X       52,B6
  19278   2 0001A1       8000

      474    19279    5              IF KZ$EVENT.TERMID$->B$TERMINAL_ID.LEV = %TERMINAL_ID_LEV_CHAN# THEN DO;

  19279   2 0001A2  CCC7 000B                            LDB,B4   KZ$EVENT+5,AUTO
          2 0001A4  E804                                 LDR,R6   ,B4
          2 0001A5  E570 00FF                            AND,R6   255,IMO
          2 0001A7  6D01                                 CMV,R6   1
          2 0001A8  0981 0013                            BNE      s:19284,PREL

      475    19280    5                  KZ$EVENT.LINCTX$->KZ$LINCTX.PTHSTT = NEW_STATE;

  19280   2 0001AA  D847 004D                            LDR,R5   NEW_STATE,AUTO
          2 0001AC  DF46 000D                            STR,R5   13,B6

      476    19281    5                  CALL KZP$DRIVER (KZ$EVENT.LINCTX$->KZ$LINCTX,%KZ#LIN_EVENT_STOP);

  19281   2 0001AE  BBF0 0000                            LAB,B3   0,IMO
          2 0001B0  BFC7 0066                            STB,B3   @C$+4,AUTO
          2 0001B2  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 0001B4  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0001B6  CBF0 0200                            LAB,B4   512,IMO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:57   
          2 0001B8  E380 0000 0000  xent                 LNJ,B6   KZP$DRIVER
          2 0001BB       0001                            DC       s:19284,PREL

      477    19282    5                  END;

      478    19283
      479    19284    4               KZ$EVENT.EVENT=KZ_DEVFNC_MAP(KZ$EVENT.EVENT );

  19284   2 0001BC  B847 0006                            LDR,R3   KZ$EVENT,AUTO
          2 0001BE  E830 0000 00CD  00                   LDR,R6   KZ_DEVFNC_MAP,R3
          2 0001C1  EF47 0006                            STR,R6   KZ$EVENT,AUTO

      480    19285    4               CALL KZ$EVENT.LINCTX$->KZ$LINCTX.DEVMGR@ (KZ$EVENT)

  19285   2 0001C3  EBC7 0006                            LAB,B6   KZ$EVENT,AUTO
          2 0001C5  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 0001C7  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0001C9  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 0001CB  9CC5 006E                            LDB,B1   110,B5
          2 0001CD  CBF0 0100                            LAB,B4   256,IMO
          2 0001CF  E381                                 LNJ,B6   ,B1
          2 0001D0       0003                            DC       s:19287,PREL
          2 0001D1  0F81 000B                            B        s:19291,PREL

      481    19286    5               WHENALTRETURN DO;

      482    19287    5                  KZ$PARAM.RESULT=KZ$EVENT.RESULT;

  19287   2 0001D3  8CC7 0012                            LDI      KZ$EVENT+12,AUTO
          2 0001D5  ECC7 0004                            LDB,B6   @KZ$PARAM,AUTO
          2 0001D7  8D46 000C                            SDI      12,B6

      483    19288    5                  ALTRETURN;

  19288   2 0001D9  ECC7 0058                            LDB,B6   P$+2,AUTO
          2 0001DB  B806                                 LDR,R3   ,B6
          2 0001DC  C3B6                                 LNJ,B4   ,B6,R3
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:58   

      484    19289    5                  END;
      485    19290    4               END;

      486    19291    4            IF KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ENQ$ ~= ADDR(NIL) THEN DO;

  19291   2 0001DD  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0001DF  8DC6 002D                            CMN      45,B6
          2 0001E1  0901 0116                            BE       s:19419,PREL

      487    19292    4               KH_CANCELCLK = KH_CANCELCLK_C;

  19292   2 0001E3  AB80 0000 0000  00                   LAB,B2   KH_SETCLK_C
          2 0001E6  2C16                                 LDV,R2   22
          2 0001E7  6C10                                 LDV,R6   16
          2 0001E8  BB87                                 LAB,B3   ,AUTO
          2 0001E9  3C3E                                 LDV,R3   62
          2 0001EA  0008                                 MMM

      488    19293    4               CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ENQ$);

  19293   2 0001EB  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0001ED  DBC6 002D                            LAB,B5   45,B6
          2 0001EF  DFC7 005E                            STB,B5   TXT$+2,AUTO
          2 0001F1  E3C0 0309                            LNJ,B6   s:0,PREL
          2 0001F3       0001                            DC       s:19294,PREL

      489    19294    4               END;

  19294   2 0001F4  0F81 0103                            B        s:19419,PREL

      490    19295        /**/
      491    19296        /*
      492    19297            Complete the disconnect on the line
      493    19298        */
      494    19299        /**/
      495    19300    3          CASE ( %KZ#CLM_STATE_LINDONE );
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:59   

      496    19301
      497    19302    3            CALL FREE_LINE;

  19302   2 0001F6  E3C0 016F                            LNJ,B6   s:0,PREL
          2 0001F8       0001                            DC       s:19302+3,PREL
          2 0001F9  0F81 00FE                            B        s:19419,PREL

      498    19303        /**/
      499    19304        /*
      500    19305            Disconnect while waiting for context building events
      501    19306        */
      502    19307        /**/
      503    19308    3          CASE ( %KZ#CLM_STATE_DSCPND1 );

      504    19309
      505    19310    3            TERM_ID=KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.TERMID;

  19310   2 0001FB  ACC5 0002                            LDB,B2   2,B5
          2 0001FD  2C24                                 LDV,R2   36
          2 0001FE  6C10                                 LDV,R6   16
          2 0001FF  BB87                                 LAB,B3   ,AUTO
          2 000200  3C72                                 LDV,R3   114
          2 000201  0008                                 MMM

      506    19311    3            TERM_ID.TTYP=%KLTY_STRM#;                /* SYNC term */

  19311   2 000202  6C03                                 LDV,R6   3
          2 000203  E7C7 0039                            STH,R6   TERM_ID,AUTO

      507    19312    3            CALL KHA$DVCADM ( %KHA_FNC_CNCRQSLINPRO,

  19312   2 000205  EBF0 0016                            LAB,B6   22,IMO
          2 000207  DB80 0000 0000                       LAB,B5   0
          2 00020A  DFC7 006C                            STB,B5   @C$+10,AUTO
          2 00020C  CB80 0000 0000                       LAB,B4   0
          2 00020F  CFC7 006A                            STB,B4   @C$+8,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:60   
          2 000211  ABC7 0039                            LAB,B2   TERM_ID,AUTO
          2 000213  AFC7 0068                            STB,B2   @C$+6,AUTO
          2 000215  9BC7 0053                            LAB,B1   ERRORWORD,AUTO
          2 000217  9FC7 0066                            STB,B1   @C$+4,AUTO
          2 000219  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 00021B  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00021D  CBF0 0500                            LAB,B4   1280,IMO
          2 00021F  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          2 000222       0001                            DC       s:19315,PREL

      508    19313    3               ERRORWORD,
      509    19314    3               TERM_ID,, );
      510    19315    3            NEW_STATE=%KZ#CLM_STATE_DSCDEV;

  19315   2 000223  6C0B                                 LDV,R6   11
          2 000224  EF47 004D                            STR,R6   NEW_STATE,AUTO

      511    19316    3            GOTO INITIATE_DISCONNECT;

  19316   2 000226  0F81 FF67                            B        s:19264,PREL

      512    19317
      513    19318        /**/
      514    19319        /*
      515    19320            Complete the disconnect on the sub-device
      516    19321        */
      517    19322        /**/
      518    19323    3          CASE ( %KZ#CLM_STATE_DEVDONE );

      519    19324
      520    19325    3            CALL KHA$DVCADM ( %KHA_FNC_DISCONNECT_EVT,

  19325   2 000228  ABF0 000C                            LAB,B2   12,IMO
          2 00022A  9B80 0000 0000                       LAB,B1   0
          2 00022D  9FC7 006C                            STB,B1   @C$+10,AUTO
          2 00022F  EB80 0000 0000                       LAB,B6   0
          2 000232  EFC7 006A                            STB,B6   @C$+8,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:61   
          2 000234  ECC7 000B                            LDB,B6   KZ$EVENT+5,AUTO
          2 000236  EFC7 0068                            STB,B6   @C$+6,AUTO
          2 000238  EBC7 0053                            LAB,B6   ERRORWORD,AUTO
          2 00023A  EFC7 0066                            STB,B6   @C$+4,AUTO
          2 00023C  AFC7 0064                            STB,B2   @C$+2,AUTO
          2 00023E  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000240  CBF0 0500                            LAB,B4   1280,IMO
          2 000242  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          2 000245       0001                            DC       s:19328,PREL

      521    19326    3               ERRORWORD,
      522    19327    3               KZ$EVENT.TERMID$ -> B$TERMINAL_ID,, );
      523    19328    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %NO;

  19328   2 000246  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000248  8846 0034                            LBF,'8000'X       52,B6
          2 00024A       8000
          2 00024B  0F81 00AC                            B        s:19419,PREL

      524    19329        /**/
      525    19330        /*
      526    19331            Report device connects to handler Common
      527    19332        */
      528    19333        /**/
      529    19334    3          CASE ( %KZ#CLM_STATE_DEVCNC );

      530    19335
      531    19336
      532    19337    3            CALL KHA$DVCADM ( %KHA_FNC_CONNECT,

  19337   2 00024D  ABF0 000E                            LAB,B2   14,IMO
          2 00024F  9B80 0000 0000                       LAB,B1   0
          2 000252  9FC7 006C                            STB,B1   @C$+10,AUTO
          2 000254  EB80 0000 0000                       LAB,B6   0
          2 000257  EFC7 006A                            STB,B6   @C$+8,AUTO
          2 000259  ECC7 000B                            LDB,B6   KZ$EVENT+5,AUTO
          2 00025B  EFC7 0068                            STB,B6   @C$+6,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:62   
          2 00025D  EBC7 0053                            LAB,B6   ERRORWORD,AUTO
          2 00025F  EFC7 0066                            STB,B6   @C$+4,AUTO
          2 000261  AFC7 0064                            STB,B2   @C$+2,AUTO
          2 000263  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000265  CBF0 0500                            LAB,B4   1280,IMO
          2 000267  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          2 00026A       0001                            DC       s:19340,PREL

      533    19338    3               ERRORWORD,
      534    19339    3               KZ$EVENT.TERMID$ -> B$TERMINAL_ID,, );
      535    19340    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %NO;

  19340   2 00026B  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00026D  8846 0034                            LBF,'8000'X       52,B6
          2 00026F       8000
          2 000270  0F81 0087                            B        s:19419,PREL

      536    19341        /**/
      537    19342        /*
      538    19343            Do a enable test on the specified device.
      539    19344        */
      540    19345        /**/
      541    19346    3          CASE ( %KZ#CLM_STATE_CNCRQS );

      542    19347
      543    19348    3            CALL KHA$TSTCNC ( KZ$EVENT.CHN$ )

  19348   2 000272  ABC7 000D                            LAB,B2   KZ$EVENT+7,AUTO
          2 000274  AFC7 0064                            STB,B2   @C$+2,AUTO
          2 000276  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000278  CBF0 0100                            LAB,B4   256,IMO
          2 00027A  E380 0000 0000  xent                 LNJ,B6   KHA$TSTCNC
          2 00027D       0007                            DC       s:19353,PREL

      544    19349    4            WHENRETURN DO;

      545    19350    4               KZ$EVENT.RESULT = '0'B;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:63   

  19350   2 00027E  8747 0012                            CL       KZ$EVENT+12,AUTO
          2 000280  8747 0013                            CL       KZ$EVENT+13,AUTO

      546    19351    4               END;

  19351   2 000282  0F81 0005                            B        s:19355,PREL

      547    19352    4            WHENALTRETURN DO;

      548    19353    4               KZ$EVENT.RESULT.ERR# = 1;

  19353   2 000284  6C08                                 LDV,R6   8
          2 000285  EAC7 0013                            SRM,R6,'FFF8'X    KZ$EVENT+13,AUTO
          2 000287       FFF8

      549    19354    4               END;

      550    19355    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.NEWSTATE = %NO;

  19355   2 000288  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00028A  8846 0034                            LBF,'8000'X       52,B6
          2 00028C       8000
          2 00028D  0F81 006A                            B        s:19419,PREL

      551    19356        /**/
      552    19357        /*
      553    19358            All done with connect - get out of here
      554    19359        */
      555    19360        /**/
      556    19361    3          CASE ( %KZ#CLM_STATE_VAMOOSE );

  19355   2                              VAMOOSE_3270    null
      557    19362
      558    19363    3   VAMOOSE_3270:;
      559    19364    4            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.STBL$ ~= ADDR(NIL) THEN DO;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:64   
  19364   2 00028F  ECC7 0009            VAMOOSE_3270    LDB,B6   KZ$EVENT+3,AUTO
          2 000291  8DC6 000F                            CMN      15,B6
          2 000293  0901 002A                            BE       s:19374,PREL

      560    19365    4               IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.AUTLGN THEN

  19365   2 000295  DCC6 0002                            LDB,B5   2,B6
          2 000297  8285                                 LB,'0004'X        ,B5
          2 000298       0004
          2 000299  0581 0004                            BBF      s:19367,PREL

      561    19366    4                  CALL SETCMPLVL;

  19366   2 00029B  E3C0 0060                            LNJ,B6   s:0,PREL
          2 00029D       0001                            DC       s:19367,PREL

      562    19367    4               IF ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP > %KLPT_3780#) OR

  19367   2 00029E  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0002A0  E846 003A                            LDR,R6   58,B6
          2 0002A2  6D02                                 CMV,R6   2
          2 0002A3  0301 0009                            BG       s:19370,PREL
          2 0002A5  0301 000A                            BG       s:19371,PREL
          2 0002A7  DCC6 0002                            LDB,B5   2,B6
          2 0002A9  8285                                 LB,'0004'X        ,B5
          2 0002AA       0004
          2 0002AB  0581 0004                            BBF      s:19371,PREL

      563    19368    4                  ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP <= %KLPT_3780# AND
      564    19369    4                  KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.AUTLGN ) THEN
      565    19370    4                  KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.SETCLK = '1'B;

  19370   2 0002AD  8946 0034                            LBT,'0020'X       52,B6
  19370   2 0002AF       0020

      566    19371    4               CALL KZP$DRIVER ( KZ$EVENT.LINCTX$->KZ$LINCTX,

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:65   
  19371   2 0002B0  DBF0 0001                            LAB,B5   1,IMO
          2 0002B2  DFC7 0066                            STB,B5   @C$+4,AUTO
          2 0002B4  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 0002B6  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0002B8  CBF0 0200                            LAB,B4   512,IMO
          2 0002BA  E380 0000 0000  xent                 LNJ,B6   KZP$DRIVER
          2 0002BD       0001                            DC       s:19374,PREL

      567    19372    4                  %KZ#LIN_EVENT_GO );
      568    19373    4               END;

      569    19374    3            CALL KHA$LINE_ACTIVE ( KZ$EVENT.TERMID$ -> B$TERMINAL_ID );

  19374   2 0002BE  BBC7 000B                            LAB,B3   KZ$EVENT+5,AUTO
          2 0002C0  CBF0 0100                            LAB,B4   256,IMO
          2 0002C2  E380 0000 0000  xent                 LNJ,B6   KHA$LINE_ACTIVE
          2 0002C5       0001                            DC       s:19383,PREL

      570    19375
      571    19376        /*E*     ERROR: KZP-E$LINCNC
      572    19377               MESSAGE: ( KZP$CNCDSC ) Successful line connect.
      573    19378           DESCRIPTION: Line has logged onto the host successfully.  This is
      574    19379                        a 0 severity error intended primarily for debug
      575    19380                        purposes.
      576    19381        */
      577    19382
      578    19383    3            VAMOOSE_LOG.BUF_

  19383   2 0002C6  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0002C8  DCC6 0002                            LDB,B5   2,B6
          2 0002CA  DFC7 0065                            STB,B5   @C$+3,AUTO
          2 0002CC  6C3F                                 LDV,R6   63
          2 0002CD  EF47 0064                            STR,R6   @C$+2,AUTO
          2 0002CF  ABC7 0064                            LAB,B2   @C$+2,AUTO
          2 0002D1  2C00                                 LDV,R2   0
          2 0002D2  6C06                                 LDV,R6   6
          2 0002D3  BB80 0000 0000  01                   LAB,B3   MEMORY_LOG
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:66   
          2 0002D6  3C5A                                 LDV,R3   90
          2 0002D7  0008                                 MMM

      579    19384    3               = VECTOR ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN );
      580    19385    3            VAMOOSE_LOG.V.TERMID=KZ$EVENT.LINCTX$->KZ$LINCTX.LINID;

  19385   2 0002D8  ACC7 0009                            LDB,B2   KZ$EVENT+3,AUTO
          2 0002DA  2C08                                 LDV,R2   8
          2 0002DB  6C10                                 LDV,R6   16
          2 0002DC  BB80 0000 0000  01                   LAB,B3   MEMORY_LOG
          2 0002DF  3C64                                 LDV,R3   100
          2 0002E0  0008                                 MMM

      581    19386    3            CALL KHA$ERRLOG ( VAMOOSE_LOG )

  19386   2 0002E1  BB80 0000 0003  03                   LAB,B3   +3
          2 0002E4  CBF0 0100                            LAB,B4   256,IMO
          2 0002E6  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          2 0002E9       0003                            DC       s:19388,PREL
          2 0002EA  0F81 0001                            B        s:19388,PREL

      582    19387    4            WHENALTRETURN DO;

      583    19388    4               END;

  19388   2 0002EC  0F81 000B                            B        s:19419,PREL

      584    19389
      585    19390        /**/
      586    19391        /*
      587    19392            No operation ... case 24.
      588    19393        */
      589    19394        /**/
      590    19395
      591    19396    3          CASE ( 24 );

      592    19397
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:67   
      593    19398    3            NEW_STATE = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PTHSTT;

  19398   2 0002EE  A845 000D                            LDR,R2   13,B5
          2 0002F0  AF47 004D                            STR,R2   NEW_STATE,AUTO
          2 0002F2  0F81 0005                            B        s:19419,PREL

      594    19399
      595    19400        /**/
      596    19401        /*
      597    19402            Screech state.
      598    19403        */
      599    19404        /**/
      600    19405
      601    19406    3          CASE ( 25 );

      602    19407
      603    19408        /*S* SCREECH_CODE: KZP-S$BADLINSTT
      604    19409                  MESSAGE: (KZP$PSRV) Bad host connect path state.
      605    19410              DESCRIPTION: An event occured while the line was in a poor
      606    19411                       state to accept it.  EVENT, KZ$LINCTX.PTHSTT
      607    19412                           are intact and interesting.                     */
      608    19413
      609    19414        /*N*       CALL KZC$SCREECH (%S$BADLINSTT); */
      610    19415    3            CALL M$XXX;

  19415   2 0002F4  B870 0082                            LDR,R3   130,IMO
          2 0002F6  0001                                 MCL
          2 0002F7       0000                            DC       s:19415+3,PREL

      611    19416
      612    19417    3          END;

      613    19418
      614    19419    2         RETURN;

  19419   2 0002F8  ECC7 0058                            LDB,B6   P$+2,AUTO
          2 0002FA  C3C6 0001                            LNJ,B4   1,B6
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:68   

      615    19420
      616    19421    2   END CNCDSC;
      617    19422        %EJECT;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:69   
      618    19423    1   SETCMPLVL: PROC;

  19423   2 0002FC  EFC7 005A            SETCMPLVL       STB,B6   P$+4,AUTO

      619    19424
      620    19425    2         KH_OTPINT = KH_OTPINT_C;

  19425   2 0002FE  8C80 0000 001F  00                   LDI      KH_OTPINT_C
          2 000301  8D47 0033                            SDI      KH_OTPINT,AUTO

      621    19426    2         KH_OTPINT.OTPCHN = '0'B;

  19426   2 000303  8847 0033                            LBF,'0040'X       KH_OTPINT,AUTO
  19426   2 000305       0040

      622    19427    2         KH_OTPINT.INTCTR.INTLVL = KZ_INT_LEV + %KZ#INPLVL;

  19427   2 000306  D800 0000 0000  xsym                 LDR,R5   KZ_INT_LEV
          2 000309  5E03                                 ADV,R5   3
          2 00030A  DAC7 0034                            SRM,R5,'003F'X    KH_OTPINT+1,AUTO
          2 00030C       003F

      623    19428    2         CALL KHI$IO_OTP (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,

  19428   2 00030D  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 00030F  CCC5 0002                            LDB,B4   2,B5
          2 000311  BBC7 0033                            LAB,B3   KH_OTPINT,AUTO
          2 000313  BFC7 0066                            STB,B3   @C$+4,AUTO
          2 000315  CFC7 0064                            STB,B4   @C$+2,AUTO
          2 000317  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000319  CBF0 0200                            LAB,B4   512,IMO
          2 00031B  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 00031E       0001                            DC       s:19430,PREL

      624    19429    2            KH_OTPINT);
      625    19430    2         KH_OTPINT.OTPCHN = '1'B;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:70   
  19430   2 00031F  8947 0033                            LBT,'0040'X       KH_OTPINT,AUTO
  19430   2 000321       0040

      626    19431    2         KH_OTPINT.INTCTR.INTLVL = KZ_INT_LEV + %KZ#OTPLVL;

  19431   2 000322  E800 0000 0000  xsym                 LDR,R6   KZ_INT_LEV
          2 000325  6E02                                 ADV,R6   2
          2 000326  EAC7 0034                            SRM,R6,'003F'X    KH_OTPINT+1,AUTO
          2 000328       003F

      627    19432    2         CALL KHI$IO_OTP (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,

  19432   2 000329  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00032B  DCC6 0002                            LDB,B5   2,B6
          2 00032D  CBC7 0033                            LAB,B4   KH_OTPINT,AUTO
          2 00032F  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 000331  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 000333  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000335  CBF0 0200                            LAB,B4   512,IMO
          2 000337  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 00033A       0001                            DC       s:19434,PREL

      628    19433    2            KH_OTPINT);
      629    19434    2         IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_POLL#

  19434   2 00033B  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00033D  E846 003A                            LDR,R6   58,B6
          2 00033F  6D04                                 CMV,R6   4
          2 000340  0981 0021                            BNE      s:19444,PREL
          2 000342  89C6 004B                            CMZ      75,B6
          2 000344  0881 001D                            BAGE     s:19444,PREL

      630    19435    2            AND KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE
      631    19436    3         THEN DO;

      632    19437    3            KH_OTPLCT = KH_OTPLCT_C;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:71   
  19437   2 000346  8C80 0000 0021  00                   LDI      KH_OTPLCT_C
          2 000349  8D47 0035                            SDI      KH_OTPLCT,AUTO

      633    19438    3            KH_OTPLCT.LCTBYT.ADR=29;         /* LCT29 - Receive order code         */

  19438   2 00034B  5C1D                                 LDV,R5   29
          2 00034C  DAC7 0036                            SRM,R5,'00FF'X    KH_OTPLCT+1,AUTO
          2 00034E       00FF

      634    19439    3            KH_OTPLCT.LCTBYT.DAT=%KZ#RCV_SLV3270;

  19439   2 00034F  4C01                                 LDV,R4   1
          2 000350  C7C7 0036                            STH,R4   KH_OTPLCT+1,AUTO

      635    19440    3            CALL KHI$IO_OTPLCTBYT (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,

  19440   2 000352  DCC6 0002                            LDB,B5   2,B6
          2 000354  CBC7 0035                            LAB,B4   KH_OTPLCT,AUTO
          2 000356  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 000358  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 00035A  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00035C  CBF0 0200                            LAB,B4   512,IMO
          2 00035E  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTPLCTBYT
          2 000361       0001                            DC       s:19444,PREL

      636    19441    3               KH_OTPLCT);
      637    19442    3            END;

      638    19443
      639    19444    2   END SETCMPLVL;

  19444   2 000362  ECC7 005A                            LDB,B6   P$+4,AUTO
          2 000364  C3C6 0001                            LNJ,B4   1,B6

      640    19445
      641    19446    1   FREE_LINE: PROC;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:72   
  19446   2 000366  EFC7 005A            FREE_LINE       STB,B6   P$+4,AUTO

      642    19447
      643    19448    3         IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.CTX$ ~= ADDR(NIL) THEN DO;

  19448   2 000368  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 00036A  CCC5 0002                            LDB,B4   2,B5
          2 00036C  8DC4 000C                            CMN      12,B4
          2 00036E  0901 012F                            BE       s:19507,PREL

      644    19449    3            KH_CANCELCLK = KH_CANCELCLK_C;

  19449   2 000370  AB80 0000 0000  00                   LAB,B2   KH_SETCLK_C
          2 000373  2C16                                 LDV,R2   22
          2 000374  6C10                                 LDV,R6   16
          2 000375  BB87                                 LAB,B3   ,AUTO
          2 000376  3C3E                                 LDV,R3   62
          2 000377  0008                                 MMM

      645    19450    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.PRM$);

  19450   2 000378  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00037A  DBC6 0031                            LAB,B5   49,B6
          2 00037C  DFC7 005E                            STB,B5   TXT$+2,AUTO
          2 00037E  E3C0 017C                            LNJ,B6   s:0,PREL
          2 000380       0001                            DC       s:19451,PREL

      646    19451    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ACK$);

  19451   2 000381  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000383  DBC6 002B                            LAB,B5   43,B6
          2 000385  DFC7 005E                            STB,B5   TXT$+2,AUTO
          2 000387  E3C0 0173                            LNJ,B6   s:0,PREL
          2 000389       0001                            DC       s:19452,PREL

      647    19452    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.ENQ$);

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:73   
  19452   2 00038A  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00038C  DBC6 002D                            LAB,B5   45,B6
          2 00038E  DFC7 005E                            STB,B5   TXT$+2,AUTO
          2 000390  E3C0 016A                            LNJ,B6   s:0,PREL
          2 000392       0001                            DC       s:19453,PREL

      648    19453    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.CTB.NAK$);

  19453   2 000393  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000395  DBC6 002F                            LAB,B5   47,B6
          2 000397  DFC7 005E                            STB,B5   TXT$+2,AUTO
          2 000399  E3C0 0161                            LNJ,B6   s:0,PREL
          2 00039B       0001                            DC       s:19454,PREL

      649    19454    3            CALL CNCLCLK (KZ$EVENT.LINCTX$->KZ$LINCTX.TMRCTB$);

  19454   2 00039C  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00039E  DBC6 006A                            LAB,B5   106,B6
          2 0003A0  DFC7 005E                            STB,B5   TXT$+2,AUTO
          2 0003A2  E3C0 0158                            LNJ,B6   s:0,PREL
          2 0003A4       0001                            DC       s:19459,PREL

      650    19455
      651    19456                                              /*
      652    19457                                           Reset the MLCP
      653    19458                                                          */
      654    19459    3            KH_OTPCHN = KH_OTPCHN_C;

  19459   2 0003A5  8C80 0000 0023  00                   LDI      KH_OTPCHN_C
          2 0003A8  8D47 0037                            SDI      KH_OTPCHN,AUTO

      655    19460    3            KH_OTPCHN.OTPCHN = '0'B;

  19460   2 0003AA  8847 0037                            LBF,'0040'X       KH_OTPCHN,AUTO
  19460   2 0003AC       0040

      656    19461    3            KH_OTPCHN.CHNCTR = '0'B;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:74   

  19461   2 0003AD  8747 0038                            CL       KH_OTPCHN+1,AUTO

      657    19462    3            KH_OTPCHN.CHNCTR.CHNINT = '1'B;

  19462   2 0003AF  8947 0038                            LBT,'8000'X       KH_OTPCHN+1,AUTO
  19462   2 0003B1       8000

      658    19463    3            CALL KHI$IO_OTP ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,

  19463   2 0003B2  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0003B4  DCC6 0002                            LDB,B5   2,B6
          2 0003B6  CBC7 0037                            LAB,B4   KH_OTPCHN,AUTO
          2 0003B8  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 0003BA  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 0003BC  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0003BE  CBF0 0200                            LAB,B4   512,IMO
          2 0003C0  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 0003C3       0001                            DC       s:19465,PREL

      659    19464    3               KH_OTPCHN );
      660    19465    3            KH_OTPCHN.OTPCHN = '1'B;

  19465   2 0003C4  8947 0037                            LBT,'0040'X       KH_OTPCHN,AUTO
  19465   2 0003C6       0040

      661    19466    3            CALL KHI$IO_OTP ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,

  19466   2 0003C7  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0003C9  DCC6 0002                            LDB,B5   2,B6
          2 0003CB  CBC7 0037                            LAB,B4   KH_OTPCHN,AUTO
          2 0003CD  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 0003CF  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 0003D1  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0003D3  CBF0 0200                            LAB,B4   512,IMO
          2 0003D5  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTP
          2 0003D8       0001                            DC       s:19469,PREL
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:75   

      662    19467    3               KH_OTPCHN );
      663    19468
      664    19469    3            KH_DWNLODLCT = KH_DWNLODLCT_C;

  19469   2 0003D9  AB80 0000 0000  00                   LAB,B2   KH_SETCLK_C
          2 0003DC  2C30                                 LDV,R2   48
          2 0003DD  6C0E                                 LDV,R6   14
          2 0003DE  BB87                                 LAB,B3   ,AUTO
          2 0003DF  3C58                                 LDV,R3   88
          2 0003E0  0008                                 MMM

      665    19470    3            KH_DWNLODLCT.CHN$ = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$;

  19470   2 0003E1  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0003E3  DCC6 0002                            LDB,B5   2,B6
          2 0003E5  DFC7 002C                            STB,B5   KH_DWNLODLCT,AUTO

      666    19471    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.DVCID = '2978'X THEN

  19471   2 0003E7  CCC6 0002                            LDB,B4   2,B6
          2 0003E9  E844 0002                            LDR,R6   2,B4
          2 0003EB  E970 2978                            CMR,R6   10616,IMO
          2 0003ED  0981 0008                            BNE      s:19474,PREL

      667    19472    3               KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC16; /* MLC-16 (NMLC) */

  19472   2 0003EF  D800 0000 0000  xsym                 LDR,R5   KZ_CCPLODBIS_MLC16
          2 0003F2  DF47 0030                            STR,R5   KH_DWNLODLCT+4,AUTO
          2 0003F4  0F81 0006                            B        s:19475,PREL

      668    19473    3            ELSE
      669    19474    3               KH_DWNLODLCT.CCPLODBIS = KZ_CCPLODBIS_MLC8; /* MLC-8 (MLCP) */

  19474   2 0003F6  D800 0000 0000  xsym                 LDR,R5   KZ_CCPLODBIS_MLC8
          2 0003F9  DF47 0030                            STR,R5   KH_DWNLODLCT+4,AUTO

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:76   
      670    19475    3            KH_DWNLODLCT.CCPLCT$ = ADDR ( KZM$MLCP );

  19475   2 0003FB  CB80 0000 0000  xsym                 LAB,B4   KZM$MLCP
          2 0003FE  CFC7 002E                            STB,B4   KH_DWNLODLCT+2,AUTO

      671    19476    3            KH_DWNLODLCT.RCVINTLVL = %KZ#ACTLVL;

  19476   2 000400  6C01                                 LDV,R6   1
          2 000401  EF47 0031                            STR,R6   KH_DWNLODLCT+5,AUTO

      672    19477    3            KH_DWNLODLCT.TRNINTLVL = 0;

  19477   2 000403  8747 0032                            CL       KH_DWNLODLCT+6,AUTO

      673    19478    3            CALL KHI$DWNLODLCT ( KH_DWNLODLCT )

  19478   2 000405  ABC7 002C                            LAB,B2   KH_DWNLODLCT,AUTO
          2 000407  AFC7 0064                            STB,B2   @C$+2,AUTO
          2 000409  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00040B  CBF0 0100                            LAB,B4   256,IMO
          2 00040D  E380 0000 0000  xent                 LNJ,B6   KHI$DWNLODLCT
          2 000410       0003                            DC       s:19484,PREL
          2 000411  0F81 0001                            B        s:19484,PREL

      674    19479    4            WHENALTRETURN DO;

      675    19480        /*N* SNAP */
      676    19481    4               END;

      677    19482
      678    19483
      679    19484    3            IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.CLK

  19484   2 000413  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000415  DCC6 0002                            LDB,B5   2,B6
          2 000417  8285                                 LB,'0020'X        ,B5
          2 000418       0020
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:77   
          2 000419  0581 0020                            BBF      s:19492,PREL

      680    19485    4            THEN DO;

      681    19486    4               KH_OTPLCT = KH_OTPLCT_C;

  19486   2 00041B  8C80 0000 0021  00                   LDI      KH_OTPLCT_C
          2 00041E  8D47 0035                            SDI      KH_OTPLCT,AUTO

      682    19487    4               KH_OTPLCT.LCTBYT.ADR = 20;

  19487   2 000420  5C14                                 LDV,R5   20
          2 000421  DAC7 0036                            SRM,R5,'00FF'X    KH_OTPLCT+1,AUTO
          2 000423       00FF

      683    19488    4               KH_OTPLCT.LCTBYT.DAT = KZM$MLCP.LCTBYT(20)+8;

  19488   2 000424  C280 0000 000D  xsym                 LLH,R4   KZM$MLCP+13
          2 000427  4E08                                 ADV,R4   8
          2 000428  C7C7 0036                            STH,R4   KH_OTPLCT+1,AUTO

      684    19489    4               CALL KHI$IO_OTPLCTBYT ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN,

  19489   2 00042A  DCC6 0002                            LDB,B5   2,B6
          2 00042C  CBC7 0035                            LAB,B4   KH_OTPLCT,AUTO
          2 00042E  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 000430  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 000432  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000434  CBF0 0200                            LAB,B4   512,IMO
          2 000436  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTPLCTBYT
          2 000439       0001                            DC       s:19492,PREL

      685    19490    4                  KH_OTPLCT );
      686    19491    4               END;

      687    19492    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.CTX$ = ADDR(NIL);

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:78   
  19492   2 00043A  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00043C  DCC6 0002                            LDB,B5   2,B6
          2 00043E  CB80 0000 0000                       LAB,B4   0
          2 000441  CFC5 000C                            STB,B4   12,B5

      688    19493    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN.LCT55 = 0;

  19493   2 000443  DCC6 0002                            LDB,B5   2,B6
          2 000445  87C5 0008                            CLH      8,B5

      689    19494    3            CALL KHA$DVCADM ( %KHA_FNC_DISCONNECT_EVT,ERRORWORD,

  19494   2 000447  EBF0 000C                            LAB,B6   12,IMO
          2 000449  DB80 0000 0000                       LAB,B5   0
          2 00044C  DFC7 006C                            STB,B5   @C$+10,AUTO
          2 00044E  CB80 0000 0000                       LAB,B4   0
          2 000451  CFC7 006A                            STB,B4   @C$+8,AUTO
          2 000453  BCC7 000B                            LDB,B3   KZ$EVENT+5,AUTO
          2 000455  BFC7 0068                            STB,B3   @C$+6,AUTO
          2 000457  ABC7 0053                            LAB,B2   ERRORWORD,AUTO
          2 000459  AFC7 0066                            STB,B2   @C$+4,AUTO
          2 00045B  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 00045D  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00045F  CBF0 0500                            LAB,B4   1280,IMO
          2 000461  E380 0000 0000  xent                 LNJ,B6   KHA$DVCADM
          2 000464       0001                            DC       s:19496,PREL

      690    19495    3               KZ$EVENT.TERMID$->B$TERMINAL_ID,,);
      691    19496    3            CALL KHA$TSTCNC ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ )

  19496   2 000465  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000467  DBC6 0002                            LAB,B5   2,B6
          2 000469  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 00046B  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00046D  CBF0 0100                            LAB,B4   256,IMO
          2 00046F  E380 0000 0000  xent                 LNJ,B6   KHA$TSTCNC
          2 000472       0025                            DC       s:19504,PREL
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:79   

      692    19497    4            WHENRETURN DO;

      693    19498    4               KH_SETCLK = KH_SETCLK_C;

  19498   2 000473  AB80 0000 0000  00                   LAB,B2   KH_SETCLK_C
          2 000476  2C00                                 LDV,R2   0
          2 000477  6C16                                 LDV,R6   22
          2 000478  BB87                                 LAB,B3   ,AUTO
          2 000479  3C28                                 LDV,R3   40
          2 00047A  0008                                 MMM

      694    19499    4               KH_SETCLK.CTBCTX$ = ADDR(NIL);

  19499   2 00047B  EB80 0000 0000                       LAB,B6   0
          2 00047E  EFC7 0014                            STB,B6   KH_SETCLK,AUTO

      695    19500    4               KH_SETCLK.UID$ = KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$;

  19500   2 000480  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 000482  CCC5 0002                            LDB,B4   2,B5
          2 000484  CFC7 0016                            STB,B4   KH_SETCLK+2,AUTO

      696    19501    4               KH_SETCLK.SBR$ = ENTADDR( KZC$SEARCH_FOR_ACTIVITY );

  19501   2 000486  AB80 0000 0000  xent                 LAB,B2   KZC$SEARCH_FOR_ACTIVITY
          2 000489  AFC7 001C                            STB,B2   KH_SETCLK+8,AUTO

      697    19502    4               CALL KHC$CLOCK ( KH_SETCLK );

  19502   2 00048B  9BC7 0014                            LAB,B1   KH_SETCLK,AUTO
          2 00048D  9FC7 0064                            STB,B1   @C$+2,AUTO
          2 00048F  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000491  CBF0 0100                            LAB,B4   256,IMO
          2 000493  E380 0000 0000  xent                 LNJ,B6   KHC$CLOCK
          2 000496       0001                            DC       s:19504,PREL

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:80   
      698    19503    4               END;

      699    19504    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ = ADDR(NIL);

  19504   2 000497  EB80 0000 0000                       LAB,B6   0
          2 00049A  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 00049C  EFC5 0002                            STB,B6   2,B5

      700    19505
      701    19506    3            END;

      702    19507    2         CALL RELBFR (SIZEW(RLS$STG),KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.RMTSS$);

  19507   2 00049E  EBF0 0028                            LAB,B6   40,IMO
          2 0004A0  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 0004A2  CBC5 0043                            LAB,B4   67,B5
          2 0004A4  CFC7 0062                            STB,B4   @I+2,AUTO
          2 0004A6  EFC7 0060                            STB,B6   @C$+2,AUTO
          2 0004A8  E3C0 042F                            LNJ,B6   s:0,PREL
          2 0004AA       0001                            DC       s:19508,PREL

      703    19508    2         CALL RELBFR (KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFRSIZ,

  19508   2 0004AB  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0004AD  DBC6 0056                            LAB,B5   86,B6
          2 0004AF  DFC7 0062                            STB,B5   @I+2,AUTO
          2 0004B1  CBC6 0058                            LAB,B4   88,B6
          2 0004B3  CFC7 0060                            STB,B4   @C$+2,AUTO
          2 0004B5  E3C0 0422                            LNJ,B6   s:0,PREL
          2 0004B7       0001                            DC       s:19510,PREL

      704    19509    2            KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFR$);
      705    19510    2         CALL RELBFR ((KZ$EVENT.LINCTX$->KZ$LINCTX.INPRECSIZ+1)/2,

  19510   2 0004B8  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0004BA  E846 0065                            LDR,R6   101,B6
          2 0004BC  6E01                                 ADV,R6   1
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:81   
          2 0004BD  6041                                 SOR,R6   1
          2 0004BE  EF47 006E                            STR,R6   @C$+12,AUTO
          2 0004C0  DBC6 0060                            LAB,B5   96,B6
          2 0004C2  DFC7 0062                            STB,B5   @I+2,AUTO
          2 0004C4  CBC7 006E                            LAB,B4   @C$+12,AUTO
          2 0004C6  CFC7 0060                            STB,B4   @C$+2,AUTO
          2 0004C8  E3C0 040F                            LNJ,B6   s:0,PREL
          2 0004CA       0001                            DC       s:19512,PREL

      706    19511    2            KZ$EVENT.LINCTX$->KZ$LINCTX.INPREC$);
      707    19512    2         BFR$=KZ$EVENT.LINCTX$->KZ$LINCTX.OTPHD$;

  19512   2 0004CB  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0004CD  DCC6 0052                            LDB,B5   82,B6
          2 0004CF  DFC7 0043                            STB,B5   BFR$,AUTO

      708    19513    3         DO WHILE BFR$ ~= ADDR(NIL);

  19513   2 0004D1  0F81 0015                            B        s:19517,PREL

      709    19514    3            P$=BFR$->KZ$OTPBFR.LNK$;

  19514   2 0004D3  ECC7 0043                            LDB,B6   BFR$,AUTO
          2 0004D5  DC86                                 LDB,B5   ,B6
          2 0004D6  DFC7 0056                            STB,B5   P$,AUTO

      710    19515    3            CALL RELBFR (BFR$->KZ$OTPBFR.BFRSIZ,BFR$);

  19515   2 0004D8  CBC7 0043                            LAB,B4   BFR$,AUTO
          2 0004DA  CFC7 0062                            STB,B4   @I+2,AUTO
          2 0004DC  BBC6 0004                            LAB,B3   4,B6
          2 0004DE  BFC7 0060                            STB,B3   @C$+2,AUTO
          2 0004E0  E3C0 03F7                            LNJ,B6   s:0,PREL
          2 0004E2       0001                            DC       s:19516,PREL

      711    19516    3            BFR$=P$;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:82   
  19516   2 0004E3  ECC7 0056                            LDB,B6   P$,AUTO
          2 0004E5  EFC7 0043                            STB,B6   BFR$,AUTO

      712    19517    3            END;

  19517   2 0004E7  8DC7 0043                            CMN      BFR$,AUTO
          2 0004E9  09EA                                 BNE      s:19514,SPREL

      713    19518    2         CALL RELBFR (SIZEW(KZ$LINCTX),KZ$EVENT.LINCTX$);

  19518   2 0004EA  EBF0 0089                            LAB,B6   137,IMO
          2 0004EC  DBC7 0009                            LAB,B5   KZ$EVENT+3,AUTO
          2 0004EE  DFC7 0062                            STB,B5   @I+2,AUTO
          2 0004F0  EFC7 0060                            STB,B6   @C$+2,AUTO
          2 0004F2  E3C0 03E5                            LNJ,B6   s:0,PREL
          2 0004F4       0001                            DC       s:19519,PREL

      714    19519    2         OK_TO_MUCK_CONTEXT='0'B;

  19519   2 0004F5  8747 004C                            CL       OK_TO_MUCK_CONTEXT,AUTO

      715    19520    2         RETURN;

  19520   2 0004F7  ECC7 005A                            LDB,B6   P$+4,AUTO
          2 0004F9  C3C6 0001                            LNJ,B4   1,B6

      716    19521
      717    19522    2   END FREE_LINE;
      718    19523        /*    Cancel an outstanding clock                                  */
      719    19524    1   CNCLCLK: PROC (C$);

  19524   2 0004FB  EFC7 005C            CNCLCLK         STB,B6   P$+6,AUTO

      720    19525
      721    19526    2   DCL C$ PTR;                        /* Clock context pointer        */
      722    19527
      723    19528    3         IF C$ ~= ADDR(NIL) THEN DO;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:83   

  19528   2 0004FD  DCC7 005E                            LDB,B5   @C$,AUTO
          2 0004FF  8D85                                 CMN      ,B5
          2 000500  0901 0014                            BE       s:19533,PREL

      724    19529    3            KH_CANCELCLK.CTBCTX$ = C$;

  19529   2 000502  CC85                                 LDB,B4   ,B5
          2 000503  CFC7 001F                            STB,B4   KH_CANCELCLK,AUTO

      725    19530    3            C$ = ADDR(NIL);

  19530   2 000505  BB80 0000 0000                       LAB,B3   0
          2 000508  BF85                                 STB,B3   ,B5

      726    19531    3            CALL KHC$CLOCK (KH_CANCELCLK);

  19531   2 000509  EBC7 001F                            LAB,B6   KH_CANCELCLK,AUTO
          2 00050B  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 00050D  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00050F  CBF0 0100                            LAB,B4   256,IMO
          2 000511  E380 0000 0000  xent                 LNJ,B6   KHC$CLOCK
          2 000514       0001                            DC       s:19533,PREL

      727    19532    3            END;

      728    19533    2         RETURN;

  19533   2 000515  ECC7 005C                            LDB,B6   P$+6,AUTO
          2 000517  C3C6 0001                            LNJ,B4   1,B6

      729    19534
      730    19535    2   END CNCLCLK;
      731    19536
      732    19537    1   SETPRM: PROC ALTRET;

  19537   2 000519  EFC7 005A            SETPRM          STB,B6   P$+4,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:84   

      733    19538
      734    19539    2   DCL TXT$ CPTR;
      735    19540
      736    19541    2         TXT$ = KZ$EVENT.CHNCTX$;

  19541   2 00051B  8CC7 0007                            LDI      KZ$EVENT+1,AUTO
          2 00051D  8D47 005C                            SDI      TXT$,AUTO

      737    19542    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO = '0'B;

  19542   2 00051F  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 000521  5C26                                 LDV,R5   38
          2 000522  0021                                 ALR      ;
          2 000523       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 000525       4005 003A                                ALPHANUM(58,B5,,R5,FILL)

      738    19543    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE = ( TXT$ -> KL_HASP.SLAVE# ~= '0'B );

  19543   2 000527  C870 8000                            LDR,R4   -32768,IMO
          2 000529  437F                                 CSYNC    s:19543+1,SPREL
          2 00052A  ECC7 005C                            LDB,B6   TXT$,AUTO
          2 00052C  82C6 0004                            LB,'C000'X        4,B6
          2 00052E       C000
          2 00052F  0501 0002                            BBT      s:19543+11,PREL
          2 000531  4C00                                 LDV,R4   0
          2 000532  CAC5 004B                            SRM,R4,'8000'X    75,B5
          2 000534       8000

      739    19544    2         TXT$ = PINCRC ( TXT$, TXT$ -> KL_HASP.BLKHDR.PROOFFSET );

  19544   2 000535  ECC7 005C                            LDB,B6   TXT$,AUTO
          2 000537  B846 0002                            LDR,R3   2,B6
          2 000539  B570 00FF                            AND,R3   255,IMO
          2 00053B  8CC7 005C                            LDI      TXT$,AUTO
          2 00053D  7031                                 DCL,R7   1
          2 00053E  8D47 0064                            SDI      @C$+2,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:85   
          2 000540  F853                                 LDR,R7   R3
          2 000541  6C00                                 LDV,R6   0
          2 000542  8447 0064                            AID      @C$+2,AUTO
          2 000544  7071                                 DCR,R7   1
          2 000545  8D47 005C                            SDI      TXT$,AUTO

      740    19545    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PRONAME.SIZE

  19545   2 000547  B856                                 LDR,R3   R6
          2 000548  E570 7FFF                            AND,R6   32767,IMO
          2 00054A  8D47 0064                            SDI      @C$+2,AUTO
          2 00054C  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 00054E  304F                                 SOR,R3   15
          2 00054F  3E02                                 ADV,R3   2
          2 000550  C2B6                                 LLH,R4   ,B6,R3
          2 000551  C7C5 0045                            STH,R4   69,B5

      741    19546    2            = PINCRC (TXT$, 2) -> VLP_PNAME.L;
      742    19547    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PRONAME.TEXT

  19547   2 000553  8CC7 005C                            LDI      TXT$,AUTO
          2 000555  B856                                 LDR,R3   R6
          2 000556  E570 7FFF                            AND,R6   32767,IMO
          2 000558  8D47 0064                            SDI      @C$+2,AUTO
          2 00055A  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 00055C  304F                                 SOR,R3   15
          2 00055D  8CC7 005C                            LDI      TXT$,AUTO
          2 00055F  A856                                 LDR,R2   R6
          2 000560  E570 7FFF                            AND,R6   32767,IMO
          2 000562  8D47 0066                            SDI      @C$+4,AUTO
          2 000564  CCC7 0066                            LDB,B4   @C$+4,AUTO
          2 000566  204F                                 SOR,R2   15
          2 000567  3E02                                 ADV,R3   2
          2 000568  C2B6                                 LLH,R4   ,B6,R3
          2 000569  0021                                 ALR      ;
          2 00056A       C024 0001                                ALPHANUM(1,B4,R2,1,R4),;
          2 00056C       CB05 0045                                ALPHANUM(69,B5,1,11,FILL)
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:86   

      743    19548    2            = PINCRC (TXT$, 2) -> VLP_PNAME.NAME;
      744    19549    2         TXT$ = PINCRW ( TXT$, ((TXT$ -> TL.L + 1)/2) );

  19549   2 00056E  437F                                 CSYNC    s:19547+26,SPREL
          2 00056F  8CC7 005C                            LDI      TXT$,AUTO
          2 000571  B856                                 LDR,R3   R6
          2 000572  E570 7FFF                            AND,R6   32767,IMO
          2 000574  8D47 0064                            SDI      @C$+2,AUTO
          2 000576  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 000578  304F                                 SOR,R3   15
          2 000579  3E01                                 ADV,R3   1
          2 00057A  C2B6                                 LLH,R4   ,B6,R3
          2 00057B  4E01                                 ADV,R4   1
          2 00057C  4041                                 SOR,R4   1
          2 00057D  F854                                 LDR,R7   R4
          2 00057E  6C00                                 LDV,R6   0
          2 00057F  8447 005C                            AID      TXT$,AUTO
          2 000581  8D47 005C                            SDI      TXT$,AUTO

      745    19550    2         TXT$ = PINCRC ( TXT$, 4 );

  19550   2 000583  8470 0000 0002                       AID      2,IMO
          2 000586  8D47 005C                            SDI      TXT$,AUTO

      746    19551    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = TXT$ -> KL_TRMD.PROTYP#;

  19551   2 000588  B856                                 LDR,R3   R6
          2 000589  E570 7FFF                            AND,R6   32767,IMO
          2 00058B  8D47 0064                            SDI      @C$+2,AUTO
          2 00058D  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 00058F  304F                                 SOR,R3   15
          2 000590  C2B6                                 LLH,R4   ,B6,R3
          2 000591  CF45 003A                            STR,R4   58,B5

      747    19552    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKRECS = TXT$ -> KL_TRMD.BLKRECS#;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:87   
  19552   2 000593  8CC7 005C                            LDI      TXT$,AUTO
          2 000595  B856                                 LDR,R3   R6
          2 000596  E570 7FFF                            AND,R6   32767,IMO
          2 000598  8D47 0064                            SDI      @C$+2,AUTO
          2 00059A  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 00059C  304F                                 SOR,R3   15
          2 00059D  3E01                                 ADV,R3   1
          2 00059E  C2B6                                 LLH,R4   ,B6,R3
          2 00059F  CF45 003B                            STR,R4   59,B5

      748    19553    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKBYTES = TXT$ -> KL_TRMD.BLKBYTES#;

  19553   2 0005A1  8CC7 005C                            LDI      TXT$,AUTO
          2 0005A3  B856                                 LDR,R3   R6
          2 0005A4  E570 7FFF                            AND,R6   32767,IMO
          2 0005A6  8D47 0064                            SDI      @C$+2,AUTO
          2 0005A8  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 0005AA  304F                                 SOR,R3   15
          2 0005AB  AB86                                 LAB,B2   ,B6
          2 0005AC  A853                                 LDR,R2   R3
          2 0005AD  2E02                                 ADV,R2   2
          2 0005AE  6C02                                 LDV,R6   2
          2 0005AF  BB85                                 LAB,B3   ,B5
          2 0005B0  3C78                                 LDV,R3   120
          2 0005B1  0008                                 MMM

      749    19554    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RETRYS = TXT$ -> KL_TRMD.RETRYS#;

  19554   2 0005B2  8CC7 005C                            LDI      TXT$,AUTO
          2 0005B4  B856                                 LDR,R3   R6
          2 0005B5  E570 7FFF                            AND,R6   32767,IMO
          2 0005B7  8D47 0064                            SDI      @C$+2,AUTO
          2 0005B9  9CC7 0064                            LDB,B1   @C$+2,AUTO
          2 0005BB  304F                                 SOR,R3   15
          2 0005BC  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0005BE  3E04                                 ADV,R3   4
          2 0005BF  C2B1                                 LLH,R4   ,B1,R3
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:88   
          2 0005C0  CF46 003D                            STR,R4   61,B6

      750    19555    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.DELAYS = TXT$ -> KL_TRMD.DELAYS#;

  19555   2 0005C2  8CC7 005C                            LDI      TXT$,AUTO
          2 0005C4  B856                                 LDR,R3   R6
          2 0005C5  E570 7FFF                            AND,R6   32767,IMO
          2 0005C7  8D47 0064                            SDI      @C$+2,AUTO
          2 0005C9  ACC7 0064                            LDB,B2   @C$+2,AUTO
          2 0005CB  304F                                 SOR,R3   15
          2 0005CC  3E05                                 ADV,R3   5
          2 0005CD  C2B2                                 LLH,R4   ,B2,R3
          2 0005CE  CF46 003E                            STR,R4   62,B6

      751    19556    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.INTERVAL = TXT$ -> KL_TRMD.INTERVAL# * 12;

  19556   2 0005D0  8CC7 005C                            LDI      TXT$,AUTO
          2 0005D2  B856                                 LDR,R3   R6
          2 0005D3  E570 7FFF                            AND,R6   32767,IMO
          2 0005D5  8D47 0064                            SDI      @C$+2,AUTO
          2 0005D7  ACC7 0064                            LDB,B2   @C$+2,AUTO
          2 0005D9  304F                                 SOR,R3   15
          2 0005DA  3E08                                 ADV,R3   8
          2 0005DB  C2B2                                 LLH,R4   ,B2,R3
          2 0005DC  4F0C                                 MLV,R4   12
          2 0005DD  CF46 003F                            STR,R4   63,B6

      752    19557    2         IF TXT$->KL_TRMD.COMPRESS# = %KLCO_LINE# THEN

  19557   2 0005DF  8CC7 005C                            LDI      TXT$,AUTO
          2 0005E1  B856                                 LDR,R3   R6
          2 0005E2  E570 7FFF                            AND,R6   32767,IMO
          2 0005E4  8D47 0064                            SDI      @C$+2,AUTO
          2 0005E6  ACC7 0064                            LDB,B2   @C$+2,AUTO
          2 0005E8  304F                                 SOR,R3   15
          2 0005E9  BF47 0067                            STR,R3   @C$+5,AUTO
          2 0005EB  AFC7 0068                            STB,B2   @C$+6,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:89   
          2 0005ED  A853                                 LDR,R2   R3
          2 0005EE  2003                                 SOL,R2   3
          2 0005EF  2E4A                                 ADV,R2   74
          2 0005F0  6C06                                 LDV,R6   6
          2 0005F1  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0005F3  3C20                                 LDV,R3   32
          2 0005F4  7C10                                 LDV,R7   16
          2 0005F5  D380 0000 0000  xent                 LNJ,B5   X6B_BLR
          2 0005F8  E847 0066                            LDR,R6   @C$+4,AUTO
          2 0005FA  604A                                 SOR,R6   10
          2 0005FB  6D02                                 CMV,R6   2
          2 0005FC  0981 0015                            BNE      s:19563,PREL

      753    19558    2           IF KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.LINSPD = BITBIN(%KW#LINSPD19200
             19558                     ) THEN

  19558   2 0005FE  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000600  DCC6 0002                            LDB,B5   2,B6
          2 000602  E845 0008                            LDR,R6   8,B5
          2 000604  E570 000F                            AND,R6   15,IMO
          2 000606  6D0F                                 CMV,R6   15
          2 000607  0981 0005                            BNE      s:19561,PREL

      754    19559    2               KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.COMPRESS=%KLCO_NO#;

  19559   2 000609  8746 0040                            CL       64,B6
          2 00060B  0F81 0034                            B        s:19564,PREL

      755    19560    2            ELSE
      756    19561    2               KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.COMPRESS=%KLCO_YES#;

  19561   2 00060D  5C01                                 LDV,R5   1
          2 00060E  DF46 0040                            STR,R5   64,B6
          2 000610  0F81 002F                            B        s:19564,PREL

      757    19562    2         ELSE
      758    19563    2            KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.COMPRESS=TXT$->KL_TRMD.COMPRESS#;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:90   

  19563   2 000612  8CC7 005C                            LDI      TXT$,AUTO
          2 000614  B856                                 LDR,R3   R6
          2 000615  E570 7FFF                            AND,R6   32767,IMO
          2 000617  8D47 0064                            SDI      @C$+2,AUTO
          2 000619  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 00061B  304F                                 SOR,R3   15
          2 00061C  BF47 0069                            STR,R3   @C$+7,AUTO
          2 00061E  EFC7 006A                            STB,B6   @C$+8,AUTO
          2 000620  AB86                                 LAB,B2   ,B6
          2 000621  A853                                 LDR,R2   R3
          2 000622  2003                                 SOL,R2   3
          2 000623  2E4A                                 ADV,R2   74
          2 000624  6C06                                 LDV,R6   6
          2 000625  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 000627  3C40                                 LDV,R3   64
          2 000628  7C10                                 LDV,R7   16
          2 000629  D380 0000 0000  xent                 LNJ,B5   X6B_BLR
          2 00062C  F847 0068                            LDR,R7   @C$+6,AUTO
          2 00062E  704A                                 SOR,R7   10
          2 00062F  6C00                                 LDV,R6   0
          2 000630  7090                                 DOL,R7   16
          2 000631  8D47 0066                            SDI      @C$+4,AUTO
          2 000633  ABC7 0064                            LAB,B2   @C$+2,AUTO
          2 000635  2C20                                 LDV,R2   32
          2 000636  6C20                                 LDV,R6   32
          2 000637  BCC7 0009                            LDB,B3   KZ$EVENT+3,AUTO
          2 000639  BBC3 0040                            LAB,B3   64,B3
          2 00063B  3C00                                 LDV,R3   0
          2 00063C  7C10                                 LDV,R7   16
          2 00063D  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      759    19564    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKRFPS = 0;

  19564   2 000640  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000642  87C6 0041                            CLH      65,B6

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:91   
      760    19565    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.BLKGFPS = 0;

  19565   2 000644  8846 0041                            LBF,'00FF'X       65,B6
  19565   2 000646       00FF

      761    19566    2        KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.EMCHR = BINBIT ( TXT$ -> KL_TRMD.EMCHR#, 8 )
             19566                  ;

  19566   2 000647  8CC7 005C                            LDI      TXT$,AUTO
          2 000649  B856                                 LDR,R3   R6
          2 00064A  E570 7FFF                            AND,R6   32767,IMO
          2 00064C  8D47 0064                            SDI      @C$+2,AUTO
          2 00064E  DCC7 0064                            LDB,B5   @C$+2,AUTO
          2 000650  304F                                 SOR,R3   15
          2 000651  3E0A                                 ADV,R3   10
          2 000652  D2B5                                 LLH,R5   ,B5,R3
          2 000653  5008                                 SOL,R5   8
          2 000654  5048                                 SOR,R5   8
          2 000655  D7C6 0042                            STH,R5   66,B6

      762    19567    2        KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.IRSCHR = BINBIT ( TXT$ -> KL_TRMD.IRSCHR#, 8
             19567                  );

  19567   2 000657  8CC7 005C                            LDI      TXT$,AUTO
          2 000659  B856                                 LDR,R3   R6
          2 00065A  E570 7FFF                            AND,R6   32767,IMO
          2 00065C  8D47 0064                            SDI      @C$+2,AUTO
          2 00065E  DCC7 0064                            LDB,B5   @C$+2,AUTO
          2 000660  304F                                 SOR,R3   15
          2 000661  3E0B                                 ADV,R3   11
          2 000662  D2B5                                 LLH,R5   ,B5,R3
          2 000663  5008                                 SOL,R5   8
          2 000664  5048                                 SOR,R5   8
          2 000665  DAC6 0042                            SRM,R5,'00FF'X    66,B6
          2 000667       00FF

      763    19568    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.MULSTRM = (TXT$->KL_TRMD.MULSTRM#~='0'B);
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:92   

  19568   2 000668  8CC7 005C                            LDI      TXT$,AUTO
          2 00066A  B856                                 LDR,R3   R6
          2 00066B  E570 7FFF                            AND,R6   32767,IMO
          2 00066D  8D47 0064                            SDI      @C$+2,AUTO
          2 00066F  DCC7 0064                            LDB,B5   @C$+2,AUTO
          2 000671  304F                                 SOR,R3   15
          2 000672  D870 8000                            LDR,R5   -32768,IMO
          2 000674  BF47 0067                            STR,R3   @C$+5,AUTO
          2 000676  DFC7 0068                            STB,B5   @C$+6,AUTO
          2 000678  AB85                                 LAB,B2   ,B5
          2 000679  A853                                 LDR,R2   R3
          2 00067A  2003                                 SOL,R2   3
          2 00067B  2E30                                 ADV,R2   48
          2 00067C  6C02                                 LDV,R6   2
          2 00067D  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00067F  3C20                                 LDV,R3   32
          2 000680  7C10                                 LDV,R7   16
          2 000681  D380 0000 0000  xent                 LNJ,B5   X6B_BLR
          2 000684  E847 0066                            LDR,R6   @C$+4,AUTO
          2 000686  6981 0002                            BNEZ,R6  s:19568+33,PREL
          2 000688  5C00                                 LDV,R5   0
          2 000689  5041                                 SOR,R5   1
          2 00068A  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 00068C  DAC6 004B                            SRM,R5,'4000'X    75,B6
          2 00068E       4000

      764    19569    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.ACK0_UNSUSP = '0'B;

  19569   2 00068F  8846 004B                            LBF,'2000'X       75,B6
  19569   2 000691       2000

      765    19570    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.ACK0_UNWABS = '1'B;

  19570   2 000692  8946 004B                            LBT,'1000'X       75,B6
  19570   2 000694       1000

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:93   
      766    19571    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.FIRST = '1'B;

  19571   2 000695  8946 0034                            LBT,'0080'X       52,B6
  19571   2 000697       0080

      767    19572    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RFP_ON_SUSP_OK = '1'B;

  19572   2 000698  8946 004B                            LBT,'0800'X       75,B6
  19572   2 00069A       0800

      768    19573    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SUSP_WAB_IGN = '1'B;

  19573   2 00069B  8946 004B                            LBT,'0400'X       75,B6
  19573   2 00069D       0400

      769    19574    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.TRSPCY = '0'B;

  19574   2 00069E  8846 004B                            LBF,'0200'X       75,B6
  19574   2 0006A0       0200

      770    19575    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.LSTRECCTN = TXT$ -> KL_TRMD.LSTRECCTN#;

  19575   2 0006A1  8CC7 005C                            LDI      TXT$,AUTO
          2 0006A3  B856                                 LDR,R3   R6
          2 0006A4  E570 7FFF                            AND,R6   32767,IMO
          2 0006A6  8D47 0064                            SDI      @C$+2,AUTO
          2 0006A8  DCC7 0064                            LDB,B5   @C$+2,AUTO
          2 0006AA  304F                                 SOR,R3   15
          2 0006AB  BF47 0066                            STR,R3   @C$+4,AUTO
          2 0006AD  DFC7 0067                            STB,B5   @C$+5,AUTO
          2 0006AF  AB85                                 LAB,B2   ,B5
          2 0006B0  A853                                 LDR,R2   R3
          2 0006B1  2003                                 SOL,R2   3
          2 0006B2  2E60                                 ADV,R2   96
          2 0006B3  6C01                                 LDV,R6   1
          2 0006B4  BBC6 004B                            LAB,B3   75,B6
          2 0006B6  3C07                                 LDV,R3   7
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:94   
          2 0006B7  7C01                                 LDV,R7   1
          2 0006B8  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      771    19576    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.ERRDUPBLK = TXT$ -> KL_TRMD.ERRDUPBLK#;

  19576   2 0006BB  8CC7 005C                            LDI      TXT$,AUTO
          2 0006BD  B856                                 LDR,R3   R6
          2 0006BE  E570 7FFF                            AND,R6   32767,IMO
          2 0006C0  8D47 0064                            SDI      @C$+2,AUTO
          2 0006C2  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 0006C4  304F                                 SOR,R3   15
          2 0006C5  BF47 0066                            STR,R3   @C$+4,AUTO
          2 0006C7  EFC7 0067                            STB,B6   @C$+5,AUTO
          2 0006C9  AB86                                 LAB,B2   ,B6
          2 0006CA  A853                                 LDR,R2   R3
          2 0006CB  2003                                 SOL,R2   3
          2 0006CC  2E61                                 ADV,R2   97
          2 0006CD  6C01                                 LDV,R6   1
          2 0006CE  BCC7 0009                            LDB,B3   KZ$EVENT+3,AUTO
          2 0006D0  BBC3 004B                            LAB,B3   75,B3
          2 0006D2  3C08                                 LDV,R3   8
          2 0006D3  7C01                                 LDV,R7   1
          2 0006D4  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      772    19577    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RRR = TXT$ -> KL_TRMD.RRR#;

  19577   2 0006D7  8CC7 005C                            LDI      TXT$,AUTO
          2 0006D9  B856                                 LDR,R3   R6
          2 0006DA  E570 7FFF                            AND,R6   32767,IMO
          2 0006DC  8D47 0064                            SDI      @C$+2,AUTO
          2 0006DE  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 0006E0  304F                                 SOR,R3   15
          2 0006E1  BF47 0066                            STR,R3   @C$+4,AUTO
          2 0006E3  EFC7 0067                            STB,B6   @C$+5,AUTO
          2 0006E5  AB86                                 LAB,B2   ,B6
          2 0006E6  A853                                 LDR,R2   R3
          2 0006E7  2003                                 SOL,R2   3
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:95   
          2 0006E8  2E62                                 ADV,R2   98
          2 0006E9  6C01                                 LDV,R6   1
          2 0006EA  BCC7 0009                            LDB,B3   KZ$EVENT+3,AUTO
          2 0006EC  BBC3 004B                            LAB,B3   75,B3
          2 0006EE  3C09                                 LDV,R3   9
          2 0006EF  7C01                                 LDV,R7   1
          2 0006F0  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      773    19578    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLC = TXT$ -> KL_TRMD.SLC#;

  19578   2 0006F3  8CC7 005C                            LDI      TXT$,AUTO
          2 0006F5  B856                                 LDR,R3   R6
          2 0006F6  E570 7FFF                            AND,R6   32767,IMO
          2 0006F8  8D47 0064                            SDI      @C$+2,AUTO
          2 0006FA  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 0006FC  304F                                 SOR,R3   15
          2 0006FD  BF47 0066                            STR,R3   @C$+4,AUTO
          2 0006FF  EFC7 0067                            STB,B6   @C$+5,AUTO
          2 000701  AB86                                 LAB,B2   ,B6
          2 000702  A853                                 LDR,R2   R3
          2 000703  2003                                 SOL,R2   3
          2 000704  2E63                                 ADV,R2   99
          2 000705  6C01                                 LDV,R6   1
          2 000706  BCC7 0009                            LDB,B3   KZ$EVENT+3,AUTO
          2 000708  BBC3 004B                            LAB,B3   75,B3
          2 00070A  3C0A                                 LDV,R3   10
          2 00070B  7C01                                 LDV,R7   1
          2 00070C  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      774    19579    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLCALLBLK = TXT$ -> KL_TRMD.SLCALLBLK#;

  19579   2 00070F  8CC7 005C                            LDI      TXT$,AUTO
          2 000711  B856                                 LDR,R3   R6
          2 000712  E570 7FFF                            AND,R6   32767,IMO
          2 000714  8D47 0064                            SDI      @C$+2,AUTO
          2 000716  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 000718  304F                                 SOR,R3   15
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:96   
          2 000719  BF47 0066                            STR,R3   @C$+4,AUTO
          2 00071B  EFC7 0067                            STB,B6   @C$+5,AUTO
          2 00071D  AB86                                 LAB,B2   ,B6
          2 00071E  A853                                 LDR,R2   R3
          2 00071F  2003                                 SOL,R2   3
          2 000720  2E64                                 ADV,R2   100
          2 000721  6C01                                 LDV,R6   1
          2 000722  BCC7 0009                            LDB,B3   KZ$EVENT+3,AUTO
          2 000724  BBC3 004B                            LAB,B3   75,B3
          2 000726  3C0B                                 LDV,R3   11
          2 000727  7C01                                 LDV,R7   1
          2 000728  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      775    19580    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PADSIGNON = TXT$ -> KL_TRMD.PADSIGNON#;

  19580   2 00072B  8CC7 005C                            LDI      TXT$,AUTO
          2 00072D  B856                                 LDR,R3   R6
          2 00072E  E570 7FFF                            AND,R6   32767,IMO
          2 000730  8D47 0064                            SDI      @C$+2,AUTO
          2 000732  ECC7 0064                            LDB,B6   @C$+2,AUTO
          2 000734  304F                                 SOR,R3   15
          2 000735  BF47 0066                            STR,R3   @C$+4,AUTO
          2 000737  EFC7 0067                            STB,B6   @C$+5,AUTO
          2 000739  AB86                                 LAB,B2   ,B6
          2 00073A  A853                                 LDR,R2   R3
          2 00073B  2003                                 SOL,R2   3
          2 00073C  2E65                                 ADV,R2   101
          2 00073D  6C01                                 LDV,R6   1
          2 00073E  BCC7 0009                            LDB,B3   KZ$EVENT+3,AUTO
          2 000740  BBC3 004B                            LAB,B3   75,B3
          2 000742  3C0C                                 LDV,R3   12
          2 000743  7C01                                 LDV,R7   1
          2 000744  D380 0000 0000  xent                 LNJ,B5   X6B_BLR

      776    19581    2         X = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP * 2

  19581   2 000747  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:97   
          2 000749  E846 004B                            LDR,R6   75,B6
          2 00074B  604F                                 SOR,R6   15
          2 00074C  D846 003A                            LDR,R5   58,B6
          2 00074E  5001                                 SOL,R5   1
          2 00074F  DA56                                 ADD,R5   R6
          2 000750  DF47 0052                            STR,R5   X,AUTO

      777    19582    2            + BITBIN ( KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE );
      778    19583    2         IF X > 0 AND X < KZ_NHDR

  19583   2 000752  5901 0053                            BEZ,R5   s:19625,PREL
          2 000754  D900 0000 0000  xsym                 CMR,R5   KZ_NHDR
          2 000757  0281 004E                            BGE      s:19625,PREL
          2 000759  B855                                 LDR,R3   R5
          2 00075A  8DB0 0000 0000  xsym                 CMN      KZ_HDR$,R3
          2 00075D  0901 0048                            BE       s:19625,PREL

      779    19584    2            AND KZ_HDR$(X) ~= ADDR(NIL)
      780    19585    3         THEN DO;

      781    19586    3            P$ = KZ_HDR$ ( X );

  19586   2 00075F  DCB0 0000 0000  xsym                 LDB,B5   KZ_HDR$,R3
          2 000762  DFC7 0056                            STB,B5   P$,AUTO

      782    19587    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.STBL$ = P$ -> KZ$HDR.STBL$;

  19587   2 000764  CCC5 000D                            LDB,B4   13,B5
          2 000766  CFC6 000F                            STB,B4   15,B6

      783    19588    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.MAP$ = P$ -> KZ$HDR.EMAP$;

  19588   2 000768  BCC5 000B                            LDB,B3   11,B5
          2 00076A  BFC6 0011                            STB,B3   17,B6

      784    19589    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINMGR@ = P$ -> KZ$HDR.LINHND@;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:98   
  19589   2 00076C  AC85                                 LDB,B2   ,B5
          2 00076D  AFC6 0070                            STB,B2   112,B6

      785    19590    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.DEVMGR@ = P$ -> KZ$HDR.DVCHND@;

  19590   2 00076F  9CC5 0002                            LDB,B1   2,B5
          2 000771  9FC6 006E                            STB,B1   110,B6

      786    19591    3            KZ$EVENT.LINCTX$->KZ$LINCTX.IOMGR@ = ENTADDR(KZO$ORDERS);

  19591   2 000773  EB80 0000 0000  xent                 LAB,B6   KZO$ORDERS
          2 000776  CCC7 0009                            LDB,B4   KZ$EVENT+3,AUTO
          2 000778  EFC4 0072                            STB,B6   114,B4

      787    19592    3            KZ$EVENT.LINCTX$->KZ$LINCTX.INHLVL = KZ_INT_LEV;

  19592   2 00077A  E800 0000 0000  xsym                 LDR,R6   KZ_INT_LEV
          2 00077D  EF44 0035                            STR,R6   53,B4

      788    19593    4            IF KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.BLOCK = 0 THEN DO;

  19593   2 00077F  BCC4 0002                            LDB,B3   2,B4
          2 000781  C843 0010                            LDR,R4   16,B3
          2 000783  4981 000D                            BNEZ,R4  s:19597,PREL

      789    19594    4               KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.BLOCK = KZR_THRTL_BLK;

  19594   2 000785  C800 0000 0000  xsym                 LDR,R4   KZR_THRTL_BLK
          2 000788  CF43 0010                            STR,R4   16,B3

      790    19595    4               KZ$EVENT.LINCTX$->KZ$LINCTX.CHN$->KH$CHN.UNBLOCK = KZR_THRTL_UNBLK;

  19595   2 00078A  ECC4 0002                            LDB,B6   2,B4
          2 00078C  A800 0000 0000  xsym                 LDR,R2   KZR_THRTL_UNBLK
          2 00078F  AF46 0011                            STR,R2   17,B6

      791    19596    4               END;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:99   

      792    19597    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.FLAGS.INT = P$ -> KZ$HDR.INTRCT;

  19597   2 000791  C845 000A                            LDR,R4   10,B5
          2 000793  404E                                 SOR,R4   14
          2 000794  CAC4 0034                            SRM,R4,'0002'X    52,B4
          2 000796       0002

      793    19598    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.TIMOUT.PRIMARY = 20;

  19598   2 000797  4C14                                 LDV,R4   20
          2 000798  CF44 0086                            STR,R4   134,B4

      794    19599    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.TIMOUT.SECONDARY = 20;

  19599   2 00079A  CF44 0087                            STR,R4   135,B4

      795    19600    3            S$ = P$ -> KZ$HDR.STTBFR$;

  19600   2 00079C  ECC5 0006                            LDB,B6   6,B5
          2 00079E  EFC7 0054                            STB,B6   S$,AUTO

      796    19601    3            IF S$ ~= ADDR(NIL)

  19601   2 0007A0  8DC7 0054                            CMN      S$,AUTO
          2 0007A2  0901 0061                            BE       s:19648,PREL

      797    19602    4            THEN DO;

      798    19603        /*N*     Accrue statistics from initial connect here */
      799    19604
      800    19605    4               END;

      801    19606    3            END;

  19606   2 0007A4  0F81 005F                            B        s:19648,PREL

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:100  
      802    19607    3         ELSE DO;

      803    19608        /*E* ERROR:        KZP-E$NOPROT-6
      804    19609             MESSAGE:      That protocol is not in this BISYNC/:SHARED_LCP6_SYSTEM.
      805    19610             DESCRIPTION:  The handler for the protocol requested in the line
      806    19611                           profile for the associated logon is not present in
      807    19612                           this run unit (e.g., a 3270 connect was requested but
      808    19613                           the 3270 feature is not present).
      809    19614                           V0 = Protocol type:
      810    19615                                X'0002' = 2780, slave=no
      811    19616                                X'0004' = 3780, slave=no
      812    19617                                X'0006' = HASP, slave=no
      813    19618                                X'0007' = HASP, slave=yes
      814    19619                                X'0008' = POLLED, slave=no (multidrop 3270)
      815    19620                                X'0009' = Reserved for future use - Slave 3270
      816    19621                                X'000C' = Reserved for future use - HIP
      817    19622                                All others are not supported.
      818    19623                           DATA = Offending LOGON string in ASCII TEXTC.
      819    19624        */
      820    19625    3            PROTOCOL_LOG.BUF_ = VECTOR ( TXT$ -> KL_TRMD );

  19625   2 0007A6  8CC7 005C                            LDI      TXT$,AUTO
          2 0007A8  B856                                 LDR,R3   R6
          2 0007A9  E570 7FFF                            AND,R6   32767,IMO
          2 0007AB  8D47 0064                            SDI      @C$+2,AUTO
          2 0007AD  DCC7 0064                            LDB,B5   @C$+2,AUTO
          2 0007AF  304F                                 SOR,R3   15
          2 0007B0  DFC7 0069                            STB,B5   @C$+7,AUTO
          2 0007B2  8CC7 0069                            LDI      @C$+7,AUTO
          2 0007B4  7031                                 DCL,R7   1
          2 0007B5  8D47 006B                            SDI      @C$+9,AUTO
          2 0007B7  F853                                 LDR,R7   R3
          2 0007B8  6C00                                 LDV,R6   0
          2 0007B9  8447 006B                            AID      @C$+9,AUTO
          2 0007BB  7071                                 DCR,R7   1
          2 0007BC  8D47 0067                            SDI      @C$+5,AUTO
          2 0007BE  4C0D                                 LDV,R4   13
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:101  
          2 0007BF  CF47 0066                            STR,R4   @C$+4,AUTO
          2 0007C1  ABC7 0064                            LAB,B2   @C$+2,AUTO
          2 0007C3  2C04                                 LDV,R2   4
          2 0007C4  6C06                                 LDV,R6   6
          2 0007C5  BB80 0000 0000  01                   LAB,B3   MEMORY_LOG
          2 0007C8  3C30                                 LDV,R3   48
          2 0007C9  0008                                 MMM

      821    19626    3            PROTOCOL_LOG.V.TERMID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINID;

  19626   2 0007CA  ACC7 0009                            LDB,B2   KZ$EVENT+3,AUTO
          2 0007CC  2C08                                 LDV,R2   8
          2 0007CD  6C10                                 LDV,R6   16
          2 0007CE  BB80 0000 0000  01                   LAB,B3   MEMORY_LOG
          2 0007D1  3C3A                                 LDV,R3   58
          2 0007D2  0008                                 MMM

      822    19627    3            PROTOCOL_LOG.V.VALUES (0) = X;

  19627   2 0007D3  E847 0052                            LDR,R6   X,AUTO
          2 0007D5  EF00 0000 0025  01                   STR,R6   PROTOCOL_LOG+16

      823    19628    3            CALL KHA$ERRLOG ( PROTOCOL_LOG ) ALTRET ( IGNORE_PROTOCOL_LOG_ALTRET );

  19628   2 0007D8  BB80 0000 0005  03                   LAB,B3   +5
          2 0007DB  CBF0 0100                            LAB,B4   256,IMO
          2 0007DD  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          2 0007E0       0001                            DC       s:19627,PREL

  19627   2                              IGNORE_PROTOCOL*null
      824    19629    3   IGNORE_PROTOCOL_LOG_ALTRET:;
      825    19630        /*
      826    19631            Use PROTYP = 0 for our next trip through KZP$CNCDSC.
      827    19632        */
      828    19633    3   SETPRM_ALTRET:
      829    19634    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = 0;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:102  
  19634   2 0007E1  ECC7 0009            SETPRM_ALTRET   LDB,B6   KZ$EVENT+3,AUTO
          2 0007E3  8746 003A                            CL       58,B6

      830    19635    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE = '0'B;

  19635   2 0007E5  8846 004B                            LBF,'8000'X       75,B6
  19635   2 0007E7       8000

      831    19636    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PTHSTT = NEW_STATE;

  19636   2 0007E8  E847 004D                            LDR,R6   NEW_STATE,AUTO
          2 0007EA  EF46 000D                            STR,R6   13,B6

      832    19637    3            OK_TO_MUCK_CONTEXT = '0'B;

  19637   2 0007EC  8747 004C                            CL       OK_TO_MUCK_CONTEXT,AUTO

      833    19638    3            KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;

  19638   2 0007EE  5C07                                 LDV,R5   7
          2 0007EF  DF47 0006                            STR,R5   KZ$EVENT,AUTO

      834    19639    3            KZ$EVENT.RESULT = '0'B;

  19639   2 0007F1  8747 0012                            CL       KZ$EVENT+12,AUTO
          2 0007F3  8747 0013                            CL       KZ$EVENT+13,AUTO

      835    19640    3            CALL KZP$CNCDSC ( KZ$EVENT );

  19640   2 0007F5  DBC7 0006                            LAB,B5   KZ$EVENT,AUTO
          2 0007F7  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 0007F9  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0007FB  CBF0 0100                            LAB,B4   256,IMO
          2 0007FD  E3C0 F802                            LNJ,B6   s:30,PREL
          2 0007FF       0001                            DC       s:19641,PREL

      836    19641    3            ALTRETURN;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:103  

  19641   2 000800  ECC7 005A                            LDB,B6   P$+4,AUTO
          2 000802  B806                                 LDR,R3   ,B6
          2 000803  C3B6                                 LNJ,B4   ,B6,R3

      837    19642    3            END;
      838    19643        /**/
      839    19644        /*
      840    19645            Get space for the remote signon string if there is one..
      841    19646        */
      842    19647        /**/
      843    19648    2         TXT$ = ADDR ( KZ$EVENT.CHNCTX$ -> KL_HASP.RLS# );

  19648   2 000804  BCC7 0007                            LDB,B3   KZ$EVENT+1,AUTO
          2 000806  ABC3 0005                            LAB,B2   5,B3
          2 000808  AFC7 005C                            STB,B2   TXT$,AUTO

      844    19649    2         IF TXT$ -> RLS$STG ~= ' '

  19649   2 00080A  8CC7 005C                            LDI      TXT$,AUTO
          2 00080C  A856                                 LDR,R2   R6
          2 00080D  E570 7FFF                            AND,R6   32767,IMO
          2 00080F  8D47 0064                            SDI      @C$+2,AUTO
          2 000811  9CC7 0064                            LDB,B1   @C$+2,AUTO
          2 000813  204F                                 SOR,R2   15
          2 000814  4C50                                 LDV,R4   80
          2 000815  EB80 0000 0000  03                   LAB,B6   0
          2 000818  0022                                 ACM      ;
          2 000819       4021 0000                                ALPHANUM(0,B1,R2,,R4,FILL),;
          2 00081B       4106 0007                                ALPHANUM(7,B6,,1,FILL)
          2 00081D  5381 0045                            CBE      s:19677,PREL

      845    19650    3         THEN DO;

      846    19651    3            SZ = SIZEW(RLS$STG);

  19651   2 00081F  2C28                                 LDV,R2   40
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:104  
          2 000820  AF47 0047                            STR,R2   SZ,AUTO

      847    19652
      848    19653    3            CALL KVB$GETSYS ( SZ, BUF$ )

  19653   2 000822  EBC7 0045                            LAB,B6   BUF$,AUTO
          2 000824  EFC7 0066                            STB,B6   @C$+4,AUTO
          2 000826  EBC7 0047                            LAB,B6   SZ,AUTO
          2 000828  EFC7 0064                            STB,B6   @C$+2,AUTO
          2 00082A  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00082C  CBF0 0200                            LAB,B4   512,IMO
          2 00082E  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000831       0003                            DC       s:19654,PREL
          2 000832  0F81 001A                            B        s:19671,PREL

      849    19654    4            WHENALTRETURN DO;

      850    19655        /*E* ERROR:        KZP-E$NO_MEMORY-6
      851    19656             MESSAGE:      Insufficient BISYNC MEMory (a NETCON parameter).
      852    19657             DESCRIPTION:  A KVB call ALTRETed to indicate that BISYNC is out of
      853    19658                           MEMory.  Since a necessary communications buffer
      854    19659                           could not be allocated, the BISYNC TERM/LINE associated
      855    19660                           with this request could not be connected.
      856    19661                           V0 = Size of buffer, in words, which could not be allocated.
      857    19662        */
      858    19663    4   MEMORY_ALTRET:
      859    19664    4               MEMORY_LOG.V.TERMID = KZ$EVENT.LINCTX$ -> KZ$LINCTX.LINID;

  19664   2 000834  ACC7 0009            MEMORY_ALTRET   LDB,B2   KZ$EVENT+3,AUTO
          2 000836  2C08                                 LDV,R2   8
          2 000837  6C10                                 LDV,R6   16
          2 000838  BB80 0000 0000  01                   LAB,B3   MEMORY_LOG
          2 00083B  3C10                                 LDV,R3   16
          2 00083C  0008                                 MMM

      860    19665    4               MEMORY_LOG.V.VALUES (0) = SZ;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:105  
  19665   2 00083D  E847 0047                            LDR,R6   SZ,AUTO
          2 00083F  EF00 0000 0010  01                   STR,R6   MEMORY_LOG+16

      861    19666    4               CALL KHA$ERRLOG ( MEMORY_LOG ) ALTRET ( IGNORE_MEMORY_LOG_ALTRET );

  19666   2 000842  BB80 0000 0008  03                   LAB,B3   +8
          2 000845  CBF0 0100                            LAB,B4   256,IMO
          2 000847  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          2 00084A       0001                            DC       s:19668,PREL

      862    19667    4   IGNORE_MEMORY_LOG_ALTRET:
      863    19668    4               GOTO SETPRM_ALTRET;

  19668   2 00084B  0F81 FF95            IGNORE_MEMORY_L*B        s:19627,PREL

      864    19669    4               END;
      865    19670
      866    19671    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RMTSS$ = BUF$;

  19671   2 00084D  ECC7 0045                            LDB,B6   BUF$,AUTO
          2 00084F  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 000851  EFC5 0043                            STB,B6   67,B5

      867    19672    3            KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.RMTSS$ -> RLS$STG

  19672   2 000853  8CC7 005C                            LDI      TXT$,AUTO
          2 000855  B856                                 LDR,R3   R6
          2 000856  E570 7FFF                            AND,R6   32767,IMO
          2 000858  8D47 0064                            SDI      @C$+2,AUTO
          2 00085A  CCC7 0064                            LDB,B4   @C$+2,AUTO
          2 00085C  304F                                 SOR,R3   15
          2 00085D  AB84                                 LAB,B2   ,B4
          2 00085E  A853                                 LDR,R2   R3
          2 00085F  6C50                                 LDV,R6   80
          2 000860  BB86                                 LAB,B3   ,B6
          2 000861  3C00                                 LDV,R3   0
          2 000862  0008                                 MMM
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:106  

      868    19673    3               = TXT$ -> RLS$STG;
      869    19674    3            END;

      870    19675
      871    19676        /*EH? IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP ~= %KLPT_POLL# THEN EH?*/
      872    19677    2         TXT$ =  KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFR$;

  19677   2 000863  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 000865  DCC6 0056                            LDB,B5   86,B6
          2 000867  DFC7 005C                            STB,B5   TXT$,AUTO

      873    19678    2         X = KZ$EVENT.LINCTX$->KZ$LINCTX.INPBFRSIZ;

  19678   2 000869  E846 0058                            LDR,R6   88,B6
          2 00086B  EF47 0052                            STR,R6   X,AUTO

      874    19679    2         IF KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.PROTYP = %KLPT_POLL#

  19679   2 00086D  D846 003A                            LDR,R5   58,B6
          2 00086F  5D04                                 CMV,R5   4
          2 000870  0981 000B                            BNE      s:19682,PREL
          2 000872  89C6 004B                            CMZ      75,B6
          2 000874  0801 0007                            BAL      s:19682,PREL

      875    19680    2            AND NOT KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.SLAVE
      876    19681    2         THEN SZ = 128;

  19681   2 000876  C870 0080                            LDR,R4   128,IMO
          2 000878  CF47 0047                            STR,R4   SZ,AUTO
          2 00087A  0F81 0007                            B        s:19683,PREL

      877    19682    2         ELSE SZ = ( KZ$EVENT.LINCTX$->KZ$LINCTX.PRO.BLKBYTES + 1 ) / 2;

  19682   2 00087C  C846 003C                            LDR,R4   60,B6
          2 00087E  4E01                                 ADV,R4   1
          2 00087F  4041                                 SOR,R4   1
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:107  
          2 000880  CF47 0047                            STR,R4   SZ,AUTO

      878    19683    2         CALL KVB$GETSYS ( SZ, BUF$ ) ALTRET ( MEMORY_ALTRET );

  19683   2 000882  CBC7 0045                            LAB,B4   BUF$,AUTO
          2 000884  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 000886  BBC7 0047                            LAB,B3   SZ,AUTO
          2 000888  BFC7 0064                            STB,B3   @C$+2,AUTO
          2 00088A  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 00088C  CBF0 0200                            LAB,B4   512,IMO
          2 00088E  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000891       FFA3                            DC       s:19654,PREL

      879    19684    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.INPBFR$ = BUF$;

  19684   2 000892  ECC7 0045                            LDB,B6   BUF$,AUTO
          2 000894  DCC7 0009                            LDB,B5   KZ$EVENT+3,AUTO
          2 000896  EFC5 0056                            STB,B6   86,B5

      880    19685    2         KZ$EVENT.LINCTX$ -> KZ$LINCTX.INPBFRSIZ = SZ;

  19685   2 000898  E847 0047                            LDR,R6   SZ,AUTO
          2 00089A  EF45 0058                            STR,R6   88,B5

      881    19686              /* Reset the MLCP address to the new input buffer before   */
      882    19687              /* releasing the old buffer that init had used             */
      883    19688    2         CALL KZO$ORDERS (%KZ#SEND_NOTHING,KZ$EVENT.LINCTX$->KZ$LINCTX);

  19688   2 00089C  CBF0 000C                            LAB,B4   12,IMO
          2 00089E  DFC7 0066                            STB,B5   @C$+4,AUTO
          2 0008A0  CFC7 0064                            STB,B4   @C$+2,AUTO
          2 0008A2  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0008A4  CBF0 0200                            LAB,B4   512,IMO
          2 0008A6  E380 0000 0000  xent                 LNJ,B6   KZO$ORDERS
          2 0008A9       0001                            DC       s:19689,PREL

      884    19689    2         CALL RELBFR (X,TXT$);
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:108  

  19689   2 0008AA  EBC7 005C                            LAB,B6   TXT$,AUTO
          2 0008AC  EFC7 0062                            STB,B6   @I+2,AUTO
          2 0008AE  DBC7 0052                            LAB,B5   X,AUTO
          2 0008B0  DFC7 0060                            STB,B5   @C$+2,AUTO
          2 0008B2  E3C0 0025                            LNJ,B6   s:0,PREL
          2 0008B4       0001                            DC       s:19691,PREL

      885    19690
      886    19691    2         KH_OTPLCT = KH_OTPLCT_C;

  19691   2 0008B5  8C80 0000 0021  00                   LDI      KH_OTPLCT_C
          2 0008B8  8D47 0035                            SDI      KH_OTPLCT,AUTO

      887    19692    2         KH_OTPLCT.LCTBYT.DAT = KZ$EVENT.LINCTX$ -> KZ$LINCTX.PRO.DELAYS;

  19692   2 0008BA  ECC7 0009                            LDB,B6   KZ$EVENT+3,AUTO
          2 0008BC  D846 003E                            LDR,R5   62,B6
          2 0008BE  D7C7 0036                            STH,R5   KH_OTPLCT+1,AUTO

      888    19693    2         KH_OTPLCT.LCTBYT.ADR = 59;

  19693   2 0008C0  4C3B                                 LDV,R4   59
          2 0008C1  CAC7 0036                            SRM,R4,'00FF'X    KH_OTPLCT+1,AUTO
          2 0008C3       00FF

      889    19694    2        CALL KHI$IO_OTPLCTBYT (KZ$EVENT.LINCTX$ -> KZ$LINCTX.CHN$ -> KH$CHN, KH_OTPLCT
             19694                  );

  19694   2 0008C4  DCC6 0002                            LDB,B5   2,B6
          2 0008C6  CBC7 0035                            LAB,B4   KH_OTPLCT,AUTO
          2 0008C8  CFC7 0066                            STB,B4   @C$+4,AUTO
          2 0008CA  DFC7 0064                            STB,B5   @C$+2,AUTO
          2 0008CC  BBC7 0064                            LAB,B3   @C$+2,AUTO
          2 0008CE  CBF0 0200                            LAB,B4   512,IMO
          2 0008D0  E380 0000 0000  xent                 LNJ,B6   KHI$IO_OTPLCTBYT
          2 0008D3       0001                            DC       s:19696,PREL
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:109  

      890    19695
      891    19696    2   END SETPRM;

  19696   2 0008D4  ECC7 005A                            LDB,B6   P$+4,AUTO
          2 0008D6  C3C6 0001                            LNJ,B4   1,B6

      892    19697
      893    19698        /*    Release a buffer                                             */
      894    19699    1   RELBFR: PROC (I,C$);

  19699   2 0008D8  EFC7 005E            RELBFR          STB,B6   @C$,AUTO

      895    19700
      896    19701    2   DCL C$ PTR;                        /* Buffer pointer               */
      897    19702    2   DCL I UBIN;                        /* Buffer size                  */
      898    19703
      899    19704    3         IF C$ ~= ADDR(NIL) THEN DO;

  19704   2 0008DA  DCC7 0062                            LDB,B5   @C$,AUTO
          2 0008DC  8D85                                 CMN      ,B5
          2 0008DD  0901 000F                            BE       s:19708,PREL

      900    19705    3            CALL KVB$RLSSYS (I,C$);

  19705   2 0008DF  BBC7 0060                            LAB,B3   @I,AUTO
          2 0008E1  CBF0 0200                            LAB,B4   512,IMO
          2 0008E3  E380 0000 0000  xent                 LNJ,B6   KVB$RLSSYS
          2 0008E6       0001                            DC       s:19706,PREL

      901    19706    3            C$=ADDR(NIL);

  19706   2 0008E7  EB80 0000 0000                       LAB,B6   0
          2 0008EA  DCC7 0062                            LDB,B5   @C$,AUTO
          2 0008EC  EF85                                 STB,B6   ,B5

      902    19707    3            END;
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:110  

      903    19708    2         RETURN;

  19708   2 0008ED  ECC7 005E                            LDB,B6   @C$,AUTO
          2 0008EF  C3C6 0001                            LNJ,B4   1,B6
      904    19709    2   END RELBFR;
      905    19710
      906    19711    1   END KZP$CNCDSC;
      907    19712        %EOD;

PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:111  
--  Include file information  --

   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KW_ALCT_E.:E05TOU  is referenced.
   KZ_3270_C.:E05TOU  is referenced.
   KZ$OTPBFR.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KV$BPC.:E05TOU  is referenced.
   KZ$BSCSTT.:E05TOU  is referenced.
   KZ_CLMEVT_C.:E05TOU  is referenced.
   KH_MACRO_C.:E05TOU  is referenced.
   KHA_FNC_E.:E05TOU  is referenced.
   GH_IOFNC_E.:E05TOU  is referenced.
   KH$IO.:E05TOU  is referenced.
   KZ_MLCP_C.:E05TOU  is referenced.
   KZ_SCODE_C.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KZ$PROWRT.:E05TOU  is referenced.
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:112  
   KL_SUPER_C.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
      No diagnostics issued in procedure KZP$CNCDSC.
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:113  

 **** Variables and constants ****

  ****  Section 000 RoData KZP$CNCDSC

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     B-0-0/w STRC(128)   r     1 KH_CANCELCLK_C            18-0-0/w STRC(112)   r     1 KH_DWNLODLCT_C
    23-0-0/w STRC(32)    r     1 KH_OTPCHN_C               1F-0-0/w STRC(32)    r     1 KH_OTPINT_C
    21-0-0/w STRC(32)    r     1 KH_OTPLCT_C                0-0-0/w STRC(176)   r     1 KH_SETCLK_C
    2D-0-0/b UBIN(8)     r     1 KZ_CNCDSC_TABLE(0:319)
    CD-0-0/b UBIN(16)    r     1 KZ_DEVFNC_MAP(0:15)

  ****  Section 001  Data  KZP$CNCDSC

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(336)   r     1 MEMORY_LOG                15-0-0/w STRC(336)   r     1 PROTOCOL_LOG
    2A-0-0/w STRC(336)   r     1 VAMOOSE_LOG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    5E-0-0/w PTR         r     1 @C$                       62-0-0/w PTR         r     1 @C$
    60-0-0/w PTR         r     1 @I                         4-0-0/w PTR         r     1 @KZ$PARAM
    43-0-0/w PTR         r     1 BFR$                      45-0-0/w PTR         r     1 BUF$
    *0-0-0/w PTR         r     1 C$                        *0-0-0/w PTR         r     1 C$
    53-0-0/w UBIN(16)    r     1 ERRORWORD                 51-0-0/w UBIN(16)    r     1 I
    *0-0-0/w UBIN(16)    r     1 I                         1F-0-0/w STRC(128)   r     1 KH_CANCELCLK
    2C-0-0/w STRC(112)   r     1 KH_DWNLODLCT              37-0-0/w STRC(32)    r     1 KH_OTPCHN
    33-0-0/w STRC(32)    r     1 KH_OTPINT                 35-0-0/w STRC(32)    r     1 KH_OTPLCT
    14-0-0/w STRC(176)   r     1 KH_SETCLK                  6-0-0/w STRC(224)   r     1 KZ$EVENT
    *0-0-0/w STRC(224)   r     1 KZ$PARAM                  4D-0-0/w UBIN(16)    r     1 NEW_STATE
    4C-0-0/b BIT         r     1 OK_TO_MUCK_CONTEXT        56-0-0/w PTR         r     1 P$
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:114  
    54-0-0/w PTR         r     1 S$                        47-0-0/w UBIN(16)    r     1 SZ
    39-0-0/c STRC(128)   r     1 TERM_ID                   5C-0-0/w PTR         r     1 TXT$
    52-0-0/w UBIN(16)    r     1 X

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2360)  r     1 KZM$MLCP                   0-0-0/w UBIN(16)    r     1 KZR_THRTL_BLK
     0-0-0/w UBIN(16)    r     1 KZR_THRTL_UNBLK            0-0-0/w UBIN(16)    r     1 KZ_CCPLODBIS_MLC16
     0-0-0/w UBIN(16)    r     1 KZ_CCPLODBIS_MLC8
     0-0-0/w PTR         r     1 KZ_HDR$(0:0)
     0-0-0/w UBIN(16)    r     1 KZ_INT_LEV                 0-0-0/w UBIN(16)    r     1 KZ_NHDR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(128)   r     1 B$TERMINAL_ID              0-0-0/w STRC(512)   r     1 KH$CHN
     0-0-0/w STRC(736)   r     1 KL_HASP                    0-0-0/c STRC(112)   r     1 KL_TRMD
     0-0-0/w STRC(272)   r     1 KZ$HDR                     0-0-0/w STRC(2192)  r     1 KZ$LINCTX
     0-0-0/w STRC(128)   r     1 KZ$OTPBFR                  0-0-0/c CHAR(80)    r     1 RLS$STG
     0-0-0/w ASTR(8)     r     1 TEXTC                      0-0-0/c STRC(16)    r     1 TL
     0-0-0/c ASTR(8)     r     1 VLP_PNAME


   Procedure KZP$CNCDSC requires 2289 words for executable code.
   Procedure KZP$CNCDSC requires 111 words of local(AUTO) storage.
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:115  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:116  
          MINI XREF LISTING

B$TERMINAL_ID
     18604**DCL     19325<>CALL    19337<>CALL    19374<>CALL    19494<>CALL
B$TERMINAL_ID.LEV
     18608**DCL     19169>>DOCASE  19279>>IF
B$TERMINAL_ID.TERM
     18608**DCL     18617--REDEF
BFR$
     19008**DCL     19512<<ASSIGN  19513>>DOWHILE 19514>>ASSIGN  19515>>CALL    19515<>CALL    19516<<ASSIGN
BUF$
     19009**DCL     19653<>CALL    19671>>ASSIGN  19683<>CALL    19684>>ASSIGN
C$ IN PROCEDURE CNCLCLK
     19526**DCL     19524--PROC    19528>>IF      19529>>ASSIGN  19530<<ASSIGN
C$ IN PROCEDURE RELBFR
     19701**DCL     19699--PROC    19704>>IF      19705<>CALL    19706<<ASSIGN
CNCDSC
     19110**PROC    19094--CALL
CNCLCLK
     19524**PROC    19293--CALL    19450--CALL    19451--CALL    19452--CALL    19453--CALL    19454--CALL
ERRORWORD
     19084**DCL     19157<>CALL    19225<>CALL    19312<>CALL    19325<>CALL    19337<>CALL    19494<>CALL
FREE_LINE
     19446**PROC    19269--CALL    19302--CALL
I
     19082**DCL     19115<<ASSIGN  19117>>ASSIGN
I IN PROCEDURE RELBFR
     19702**DCL     19699--PROC    19705<>CALL
IGNORE_MEMORY_LOG_ALTRET IN PROCEDURE SETPRM
     19668**LABEL   19666--CALLALT
IGNORE_PROTOCOL_LOG_ALTRET IN PROCEDURE SETPRM
     19627**LABEL   19628--CALLALT
INITIATE_DISCONNECT IN PROCEDURE CNCDSC
     19265**LABEL   19316--GOTO
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:117  
KH$CHN
     16702**DCL     19383--ASSIGN  19428<>CALL    19432<>CALL    19440<>CALL    19463<>CALL    19466<>CALL
     19489<>CALL    19694<>CALL
KH$CHN.AUTLGN
     16713**DCL     19365>>IF      19367>>IF
KH$CHN.BLOCK
     16778**DCL     19593>>IF      19594<<ASSIGN
KH$CHN.CLK
     16713**DCL     19484>>IF
KH$CHN.CTX$
     16772**DCL     19448>>IF      19492<<ASSIGN
KH$CHN.DVCID
     16728**DCL     19471>>IF
KH$CHN.LCT55
     16750**DCL     19493<<ASSIGN
KH$CHN.LINSPD
     16756**DCL     19558>>IF
KH$CHN.TERMID
     16796**DCL     19155>>ASSIGN  19223>>ASSIGN  19310>>ASSIGN
KH$CHN.TERMID.TERM
     16798**DCL     16807--REDEF
KH$CHN.UNBLOCK
     16778**DCL     19595<<ASSIGN
KHA$DVCADM
     19002**DCL-ENT 19157--CALL    19225--CALL    19312--CALL    19325--CALL    19337--CALL    19494--CALL
KHA$ERRLOG
     19006**DCL-ENT 19386--CALL    19628--CALL    19666--CALL
KHA$LINE_ACTIVE
     19005**DCL-ENT 19374--CALL
KHA$TSTCNC
     19003**DCL-ENT 19348--CALL    19496--CALL
KHC$CLOCK
     18992**DCL-ENT 19502--CALL    19531--CALL
KHI$DWNLODLCT
     19004**DCL-ENT 19478--CALL
KHI$IO_OTP
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:118  
     18994**DCL-ENT 19428--CALL    19432--CALL    19463--CALL    19466--CALL
KHI$IO_OTPLCTBYT
     18995**DCL-ENT 19440--CALL    19489--CALL    19694--CALL
KH_CANCELCLK
     17287**DCL     19292<<ASSIGN  19449<<ASSIGN  19531<>CALL
KH_CANCELCLK.CTBCTX$
     17293**DCL     19529<<ASSIGN
KH_CANCELCLK.UID
     17303**DCL     17304--REDEF   17305--REDEF
KH_CANCELCLK_C
     17135**DCL     19292>>ASSIGN  19449>>ASSIGN
KH_CANCELCLK_C.UID
     17151**DCL     17152--REDEF   17153--REDEF
KH_DWNLODLCT
     17543**DCL     19469<<ASSIGN  19478<>CALL
KH_DWNLODLCT.CCPLCT$
     17549**DCL     19475<<ASSIGN
KH_DWNLODLCT.CCPLODBIS
     17549**DCL     19472<<ASSIGN  19474<<ASSIGN
KH_DWNLODLCT.CHN$
     17549**DCL     19470<<ASSIGN
KH_DWNLODLCT.RCVINTLVL
     17550**DCL     19476<<ASSIGN
KH_DWNLODLCT.TRNINTLVL
     17550**DCL     19477<<ASSIGN
KH_DWNLODLCT_C
     17517**DCL     19469>>ASSIGN
KH_OTPCHN
     18153**DCL     19459<<ASSIGN  19463<>CALL    19466<>CALL
KH_OTPCHN.ASNSTT
     18162**DCL     18163--REDEF   18169--REDEF   18174--REDEF   18178--REDEF   18182--REDEF   18186--REDEF
     18193--REDEF   18199--REDEF   18205--REDEF   18210--REDEF   18217--REDEF   18220--REDEF   18224--REDEF
     18231--REDEF   18235--REDEF   18239--REDEF   18243--REDEF   18248--REDEF   18252--REDEF
KH_OTPCHN.CHNCTR
     18186**DCL     19461<<ASSIGN
KH_OTPCHN.CHNCTR.CHNINT
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:119  
     18186**DCL     19462<<ASSIGN
KH_OTPCHN.OTPCHN
     18159**DCL     19460<<ASSIGN  19465<<ASSIGN
KH_OTPCHN_C
     18036**DCL     19459>>ASSIGN
KH_OTPINT
     17685**DCL     19425<<ASSIGN  19428<>CALL    19432<>CALL
KH_OTPINT.ASNSTT
     17694**DCL     17695--REDEF   17701--REDEF   17706--REDEF   17710--REDEF   17714--REDEF   17718--REDEF
     17725--REDEF   17731--REDEF   17737--REDEF   17742--REDEF   17749--REDEF   17752--REDEF   17756--REDEF
     17763--REDEF   17767--REDEF   17771--REDEF   17775--REDEF   17780--REDEF   17784--REDEF
KH_OTPINT.INTCTR.INTLVL
     17737**DCL     19427<<ASSIGN  19431<<ASSIGN
KH_OTPINT.OTPCHN
     17691**DCL     19426<<ASSIGN  19430<<ASSIGN
KH_OTPINT_C
     17568**DCL     19425>>ASSIGN
KH_OTPLCT
     17919**DCL     19437<<ASSIGN  19440<>CALL    19486<<ASSIGN  19489<>CALL    19691<<ASSIGN  19694<>CALL
KH_OTPLCT.ASNSTT
     17928**DCL     17929--REDEF   17935--REDEF   17940--REDEF   17944--REDEF   17948--REDEF   17952--REDEF
     17959--REDEF   17965--REDEF   17971--REDEF   17976--REDEF   17983--REDEF   17986--REDEF   17990--REDEF
     17997--REDEF   18001--REDEF   18005--REDEF   18009--REDEF   18014--REDEF   18018--REDEF
KH_OTPLCT.LCTBYT.ADR
     17935**DCL     19438<<ASSIGN  19487<<ASSIGN  19693<<ASSIGN
KH_OTPLCT.LCTBYT.DAT
     17935**DCL     19439<<ASSIGN  19488<<ASSIGN  19692<<ASSIGN
KH_OTPLCT_C
     17802**DCL     19437>>ASSIGN  19486>>ASSIGN  19691>>ASSIGN
KH_SETCLK
     16983**DCL     19498<<ASSIGN  19502<>CALL
KH_SETCLK.CTBCTX$
     16989**DCL     19499<<ASSIGN
KH_SETCLK.SBR$
     17100**DCL     19501<<ASSIGN
KH_SETCLK.UID
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:120  
     16999**DCL     17000--REDEF   17001--REDEF
KH_SETCLK.UID$
     17000**DCL     19500<<ASSIGN
KH_SETCLK_C
     16831**DCL     19498>>ASSIGN
KH_SETCLK_C.UID
     16847**DCL     16848--REDEF   16849--REDEF
KL_HASP.BLKHDR.PROOFFSET
     18504**DCL     19544>>ASSIGN
KL_HASP.RLS#
     18562**DCL     19648--ASSIGN
KL_HASP.SLAVE#
     18555**DCL     19543>>ASSIGN
KL_TRMD
     18271**DCL     19625--ASSIGN
KL_TRMD.BLKBYTES#
     18293**DCL     19553>>ASSIGN
KL_TRMD.BLKRECS#
     18288**DCL     19552>>ASSIGN
KL_TRMD.COMPRESS#
     18328**DCL     19557>>IF      19563>>ASSIGN
KL_TRMD.DELAYS#
     18302**DCL     19555>>ASSIGN
KL_TRMD.EMCHR#
     18339**DCL     19566>>ASSIGN
KL_TRMD.ERRDUPBLK#
     18366**DCL     19576>>ASSIGN
KL_TRMD.INTERVAL#
     18323**DCL     19556>>ASSIGN
KL_TRMD.IRSCHR#
     18346**DCL     19567>>ASSIGN
KL_TRMD.LSTRECCTN#
     18356**DCL     19575>>ASSIGN
KL_TRMD.MULSTRM#
     18310**DCL     19568>>ASSIGN
KL_TRMD.PADSIGNON#
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:121  
     18409**DCL     19580>>ASSIGN
KL_TRMD.PROTYP#
     18275**DCL     19551>>ASSIGN
KL_TRMD.RETRYS#
     18298**DCL     19554>>ASSIGN
KL_TRMD.RRR#
     18375**DCL     19577>>ASSIGN
KL_TRMD.SLC#
     18394**DCL     19578>>ASSIGN
KL_TRMD.SLCALLBLK#
     18402**DCL     19579>>ASSIGN
KVB$GETSYS
     18998**DCL-ENT 19653--CALL    19683--CALL
KVB$RLSSYS
     18999**DCL-ENT 19705--CALL
KZ$EVENT
     16056**DCL     19091<<ASSIGN  19179<>CALL    19193<>CALL    19203<>CALL    19285<>CALL    19640<>CALL
KZ$EVENT.CHN$
     16069**DCL     19348<>CALL
KZ$EVENT.CHNCTX$
     16060**DCL     19541>>ASSIGN  19648>>ASSIGN
KZ$EVENT.EVENT
     16057**DCL     19111>>ASSIGN  19178<<ASSIGN  19192<<ASSIGN  19202<<ASSIGN  19284<<ASSIGN  19284>>ASSIGN
     19638<<ASSIGN
KZ$EVENT.LGNVEC
     16072**DCL     19157<>CALL
KZ$EVENT.LINCTX$
     16063**DCL     19098>>IF      19100>>ASSIGN  19102>>ASSIGN  19111>>ASSIGN  19115>>ASSIGN  19115>>ASSIGN
     19134>>ASSIGN  19136>>ASSIGN  19138>>ASSIGN  19140>>ASSIGN  19142>>ASSIGN  19143>>ASSIGN  19145>>CALL
     19155>>ASSIGN  19179>>CALL    19193>>CALL    19203>>CALL    19205>>ASSIGN  19207>>IF      19207>>IF
     19207>>IF      19223>>ASSIGN  19240>>IF      19240>>IF      19243>>ASSIGN  19244>>IF      19244>>IF
     19248>>CALL    19267>>IF      19278>>ASSIGN  19280>>ASSIGN  19281>>CALL    19285>>CALL    19291>>IF
     19293>>CALL    19310>>ASSIGN  19328>>ASSIGN  19340>>ASSIGN  19355>>ASSIGN  19364>>IF      19365>>IF
     19367>>IF      19367>>IF      19367>>IF      19370>>ASSIGN  19371>>CALL    19383>>ASSIGN  19385>>ASSIGN
     19398>>ASSIGN  19428>>CALL    19432>>CALL    19434>>IF      19434>>IF      19440>>CALL    19448>>IF
     19450>>CALL    19451>>CALL    19452>>CALL    19453>>CALL    19454>>CALL    19463>>CALL    19466>>CALL
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:122  
     19470>>ASSIGN  19471>>IF      19484>>IF      19489>>CALL    19492>>ASSIGN  19493>>ASSIGN  19496>>CALL
     19500>>ASSIGN  19504>>ASSIGN  19507>>CALL    19508>>CALL    19508>>CALL    19510>>CALL    19510>>CALL
     19512>>ASSIGN  19518<>CALL    19542>>ASSIGN  19543>>ASSIGN  19545>>ASSIGN  19547>>ASSIGN  19551>>ASSIGN
     19552>>ASSIGN  19553>>ASSIGN  19554>>ASSIGN  19555>>ASSIGN  19556>>ASSIGN  19558>>IF      19559>>ASSIGN
     19561>>ASSIGN  19563>>ASSIGN  19564>>ASSIGN  19565>>ASSIGN  19566>>ASSIGN  19567>>ASSIGN  19568>>ASSIGN
     19569>>ASSIGN  19570>>ASSIGN  19571>>ASSIGN  19572>>ASSIGN  19573>>ASSIGN  19574>>ASSIGN  19575>>ASSIGN
     19576>>ASSIGN  19577>>ASSIGN  19578>>ASSIGN  19579>>ASSIGN  19580>>ASSIGN  19581>>ASSIGN  19581>>ASSIGN
     19587>>ASSIGN  19588>>ASSIGN  19589>>ASSIGN  19590>>ASSIGN  19591>>ASSIGN  19592>>ASSIGN  19593>>IF
     19594>>ASSIGN  19595>>ASSIGN  19597>>ASSIGN  19598>>ASSIGN  19599>>ASSIGN  19626>>ASSIGN  19634>>ASSIGN
     19635>>ASSIGN  19636>>ASSIGN  19664>>ASSIGN  19671>>ASSIGN  19672>>ASSIGN  19677>>ASSIGN  19678>>ASSIGN
     19679>>IF      19679>>IF      19682>>ASSIGN  19684>>ASSIGN  19685>>ASSIGN  19688>>CALL    19692>>ASSIGN
     19694>>CALL
KZ$EVENT.RESULT
     16091**DCL     19092<<ASSIGN  19104>>IF      19287>>ASSIGN  19350<<ASSIGN  19639<<ASSIGN
KZ$EVENT.RESULT.ERR#
     16118**DCL     19353<<ASSIGN
KZ$EVENT.TERMID$
     16066**DCL     19169>>DOCASE  19279>>IF      19325>>CALL    19337>>CALL    19374>>CALL    19494>>CALL
KZ$HDR.DVCHND@
     16676**DCL     19140>>ASSIGN  19590>>ASSIGN
KZ$HDR.EMAP$
     16681**DCL     19136>>ASSIGN  19588>>ASSIGN
KZ$HDR.INTRCT
     16680**DCL     19597>>ASSIGN
KZ$HDR.LINHND@
     16675**DCL     19138>>ASSIGN  19589>>ASSIGN
KZ$HDR.STBL$
     16682**DCL     19134>>ASSIGN  19587>>ASSIGN
KZ$HDR.STTBFR$
     16678**DCL     19117>>ASSIGN  19600>>ASSIGN
KZ$LINCTX
     16136**DCL     19145<>CALL    19248<>CALL    19281<>CALL    19371<>CALL    19518--CALL    19688<>CALL
KZ$LINCTX.BCB.RCV
     16428**DCL     19243<<ASSIGN
KZ$LINCTX.CHN$
     16139**DCL     19155>>ASSIGN  19223>>ASSIGN  19310>>ASSIGN  19365>>IF      19367>>IF      19383>>ASSIGN
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:123  
     19428>>CALL    19432>>CALL    19440>>CALL    19448>>IF      19463>>CALL    19466>>CALL    19470>>ASSIGN
     19471>>IF      19484>>IF      19489>>CALL    19492>>ASSIGN  19493>>ASSIGN  19496<>CALL    19500>>ASSIGN
     19504<<ASSIGN  19558>>IF      19593>>IF      19594>>ASSIGN  19595>>ASSIGN  19694>>CALL
KZ$LINCTX.CTB.ACK$
     16219**DCL     19451<>CALL
KZ$LINCTX.CTB.ENQ$
     16221**DCL     19291>>IF      19293<>CALL    19452<>CALL
KZ$LINCTX.CTB.NAK$
     16223**DCL     19453<>CALL
KZ$LINCTX.CTB.PRM$
     16225**DCL     19450<>CALL
KZ$LINCTX.DEVMGR@
     16499**DCL     19140<<ASSIGN  19179>>CALL    19193>>CALL    19203>>CALL    19267>>IF      19285>>CALL
     19590<<ASSIGN
KZ$LINCTX.FLAGS.FIRST
     16269**DCL     19571<<ASSIGN
KZ$LINCTX.FLAGS.INT
     16293**DCL     19597<<ASSIGN
KZ$LINCTX.FLAGS.NEWSTATE
     16233**DCL     19098>>IF      19102<<ASSIGN  19278<<ASSIGN  19328<<ASSIGN  19340<<ASSIGN  19355<<ASSIGN
KZ$LINCTX.FLAGS.SETCLK
     16278**DCL     19370<<ASSIGN
KZ$LINCTX.FLAGS.SIGNON
     16275**DCL     19205<<ASSIGN
KZ$LINCTX.INHLVL
     16297**DCL     19143<<ASSIGN  19592<<ASSIGN
KZ$LINCTX.INPBFR$
     16442**DCL     19508<>CALL    19677>>ASSIGN  19684<<ASSIGN
KZ$LINCTX.INPBFRSIZ
     16444**DCL     19508<>CALL    19678>>ASSIGN  19685<<ASSIGN
KZ$LINCTX.INPREC$
     16457**DCL     19510<>CALL
KZ$LINCTX.INPRECSIZ
     16472**DCL     19510>>CALL
KZ$LINCTX.IOMGR@
     16503**DCL     19142<<ASSIGN  19591<<ASSIGN
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:124  
KZ$LINCTX.LINID
     16157**DCL     19385>>ASSIGN  19626>>ASSIGN  19664>>ASSIGN
KZ$LINCTX.LINID.TERM
     16159**DCL     16168--REDEF
KZ$LINCTX.LINMGR@
     16501**DCL     19138<<ASSIGN  19589<<ASSIGN
KZ$LINCTX.MAP$
     16180**DCL     19136<<ASSIGN  19588<<ASSIGN
KZ$LINCTX.OTPCNT
     16424**DCL     16427--REDEF
KZ$LINCTX.OTPHD$
     16437**DCL     19512>>ASSIGN
KZ$LINCTX.POLSIZ
     16470**DCL     16472--REDEF
KZ$LINCTX.PRO
     16319**DCL     19542<<ASSIGN
KZ$LINCTX.PRO.ACK0_UNSUSP
     16381**DCL     19569<<ASSIGN
KZ$LINCTX.PRO.ACK0_UNWABS
     16384**DCL     19570<<ASSIGN
KZ$LINCTX.PRO.BLKBYTES
     16327**DCL     19553<<ASSIGN  19682>>ASSIGN
KZ$LINCTX.PRO.BLKGFPS
     16352**DCL     19565<<ASSIGN
KZ$LINCTX.PRO.BLKRECS
     16323**DCL     19552<<ASSIGN
KZ$LINCTX.PRO.BLKRFPS
     16346**DCL     19564<<ASSIGN
KZ$LINCTX.PRO.COMPRESS
     16340**DCL     19559<<ASSIGN  19561<<ASSIGN  19563<<ASSIGN
KZ$LINCTX.PRO.DELAYS
     16335**DCL     19555<<ASSIGN  19692>>ASSIGN
KZ$LINCTX.PRO.EMCHR
     16358**DCL     19566<<ASSIGN
KZ$LINCTX.PRO.ERRDUPBLK
     16406**DCL     19576<<ASSIGN
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:125  
KZ$LINCTX.PRO.INTERVAL
     16338**DCL     19556<<ASSIGN
KZ$LINCTX.PRO.IRSCHR
     16361**DCL     19567<<ASSIGN
KZ$LINCTX.PRO.LSTRECCTN
     16398**DCL     19575<<ASSIGN
KZ$LINCTX.PRO.MULSTRM
     16378**DCL     19568<<ASSIGN
KZ$LINCTX.PRO.PADSIGNON
     16418**DCL     19580<<ASSIGN
KZ$LINCTX.PRO.PRONAME.SIZE
     16368**DCL     19545<<ASSIGN
KZ$LINCTX.PRO.PRONAME.TEXT
     16370**DCL     19547<<ASSIGN
KZ$LINCTX.PRO.PROTYP
     16320**DCL     19115>>ASSIGN  19207>>IF      19207>>IF      19207>>IF      19240>>IF      19240>>IF
     19244>>IF      19367>>IF      19367>>IF      19434>>IF      19551<<ASSIGN  19581>>ASSIGN  19634<<ASSIGN
     19679>>IF
KZ$LINCTX.PRO.RETRYS
     16331**DCL     19554<<ASSIGN
KZ$LINCTX.PRO.RFP_ON_SUSP_OK
     16387**DCL     19572<<ASSIGN
KZ$LINCTX.PRO.RMTSS$
     16364**DCL     19507<>CALL    19671<<ASSIGN  19672>>ASSIGN
KZ$LINCTX.PRO.RRR
     16409**DCL     19577<<ASSIGN
KZ$LINCTX.PRO.SLAVE
     16375**DCL     19115>>ASSIGN  19244>>IF      19434>>IF      19543<<ASSIGN  19581>>ASSIGN  19635<<ASSIGN
     19679>>IF
KZ$LINCTX.PRO.SLC
     16412**DCL     19578<<ASSIGN
KZ$LINCTX.PRO.SLCALLBLK
     16415**DCL     19579<<ASSIGN
KZ$LINCTX.PRO.SUSP_WAB_IGN
     16392**DCL     19573<<ASSIGN
KZ$LINCTX.PRO.TRSPCY
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:126  
     16395**DCL     19574<<ASSIGN
KZ$LINCTX.PTHSTT
     16174**DCL     19100<<ASSIGN  19111>>ASSIGN  19280<<ASSIGN  19398>>ASSIGN  19636<<ASSIGN
KZ$LINCTX.STBL$
     16178**DCL     19134<<ASSIGN  19364>>IF      19587<<ASSIGN
KZ$LINCTX.TIMOUT.PRIMARY
     16536**DCL     19598<<ASSIGN
KZ$LINCTX.TIMOUT.SECONDARY
     16540**DCL     19599<<ASSIGN
KZ$LINCTX.TMRCTB$
     16481**DCL     19454<>CALL
KZ$OTPBFR.BFRSIZ
     16611**DCL     19515<>CALL
KZ$OTPBFR.LNK$
     16569**DCL     19514>>ASSIGN
KZ$PARAM
     15972**DCL        30--PROC    19091>>ASSIGN
KZ$PARAM.RESULT
     16007**DCL     19287<<ASSIGN
KZC$INTBID
     18993**DCL-ENT 19248--CALL
KZC$SEARCH_FOR_ACTIVITY
     18996**DCL-ENT 19501--ASSIGN
KZM$MLCP
     17438**DCL     19475--ASSIGN
KZM$MLCP.CCPRLCTBLWRDX
     17444**DCL     17444--REDEF
KZM$MLCP.LCTBYT
     17445**DCL     17445--REDEF   17445--REDEF   19488>>ASSIGN
KZM$MLCP.LCTRLCTBL_BYT
     17447**DCL     17448--REDEF
KZO$ORDERS
     19001**DCL-ENT 19142--ASSIGN  19591--ASSIGN  19688--CALL
KZP$CNCDSC
        30**PROC    19640--CALL
KZP$DRIVER
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:127  
     19000**DCL-ENT 19145--CALL    19281--CALL    19371--CALL
KZR_THRTL_BLK
     18990**DCL     19594>>ASSIGN
KZR_THRTL_UNBLK
     18991**DCL     19595>>ASSIGN
KZ_CCPLODBIS_MLC16
     18989**DCL     19472>>ASSIGN
KZ_CCPLODBIS_MLC8
     18988**DCL     19474>>ASSIGN
KZ_CNCDSC_TABLE
     19021**DCL     19111>>ASSIGN
KZ_DEVFNC_MAP
     19053**DCL     19284>>ASSIGN
KZ_HDR$
     18986**DCL     19117>>ASSIGN  19134>>ASSIGN  19136>>ASSIGN  19138>>ASSIGN  19140>>ASSIGN  19583>>IF
     19586>>ASSIGN
KZ_INT_LEV
     18987**DCL     19143>>ASSIGN  19427>>ASSIGN  19431>>ASSIGN  19592>>ASSIGN
KZ_NHDR
     18985**DCL     19583>>IF
M$XXX
     10497**DCL-ENT 19415--CALL
MEMORY_ALTRET IN PROCEDURE SETPRM
     19664**LABEL   19683--CALLALT
MEMORY_LOG
     18700**DCL     19666<>CALL
MEMORY_LOG.V
     18704**DCL     18702--DCLINIT
MEMORY_LOG.V.TERMID
     18767**DCL     19664<<ASSIGN
MEMORY_LOG.V.TERMID.TERM
     18769**DCL     18778--REDEF
MEMORY_LOG.V.VALUES
     18780**DCL     19665<<ASSIGN
NEW_STATE
     19074**DCL     19100>>ASSIGN  19111<<ASSIGN  19118>>DOCASE  19211<<ASSIGN  19255<<ASSIGN  19268<<ASSIGN
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:128  
     19280>>ASSIGN  19315<<ASSIGN  19398<<ASSIGN  19636>>ASSIGN
OK_TO_MUCK_CONTEXT
     19073**DCL     19096>>IF      19113<<ASSIGN  19519<<ASSIGN  19637<<ASSIGN
P$
     19086**DCL     19514<<ASSIGN  19516>>ASSIGN  19586<<ASSIGN  19587>>ASSIGN  19588>>ASSIGN  19589>>ASSIGN
     19590>>ASSIGN  19597>>ASSIGN  19600>>ASSIGN
PROTOCOL_LOG
     18801**DCL     19628<>CALL
PROTOCOL_LOG.BUF_
     18803**DCL     19625<<ASSIGN
PROTOCOL_LOG.V
     18805**DCL     18803--DCLINIT
PROTOCOL_LOG.V.TERMID
     18868**DCL     19626<<ASSIGN
PROTOCOL_LOG.V.TERMID.TERM
     18870**DCL     18879--REDEF
PROTOCOL_LOG.V.VALUES
     18881**DCL     19627<<ASSIGN
RELBFR
     19699**PROC    19507--CALL    19508--CALL    19510--CALL    19515--CALL    19518--CALL    19689--CALL
RLS$STG
     19017**DCL     19507--CALL    19649>>IF      19651--ASSIGN  19672<<ASSIGN  19672>>ASSIGN
S$
     19085**DCL     19117<<ASSIGN  19600<<ASSIGN  19601>>IF
SETCMPLVL
     19423**PROC    19144--CALL    19247--CALL    19366--CALL
SETPRM
     19537**PROC    19173--CALL
SETPRM_ALTRET IN PROCEDURE SETPRM
     19634**LABEL   19668--GOTO
SZ
     19010**DCL     19651<<ASSIGN  19653<>CALL    19665>>ASSIGN  19681<<ASSIGN  19682<<ASSIGN  19683<>CALL
     19685>>ASSIGN
TERM_ID
     18666**DCL     19155<<ASSIGN  19157<>CALL    19223<<ASSIGN  19225<>CALL    19310<<ASSIGN  19312<>CALL
TERM_ID.TERM
PL6.E3A0      #001=KZP$CNCDSC File=KZP$PSRV.:E05TSI                              WED 07/30/97 02:58 Page:129  
     18670**DCL     18679--REDEF
TERM_ID.TTYP
     18670**DCL     19156<<ASSIGN  19224<<ASSIGN  19311<<ASSIGN
TERM_ID_C.TERM
     18639**DCL     18648--REDEF
TEXTC.SIZE
     19088**DCL     19089--IMP-SIZ
TL.L
     19013**DCL     19549>>ASSIGN
TXT$ IN PROCEDURE SETPRM
     19539**DCL     19541<<ASSIGN  19543>>ASSIGN  19544<<ASSIGN  19544>>ASSIGN  19544>>ASSIGN  19545>>ASSIGN
     19547>>ASSIGN  19547>>ASSIGN  19549<<ASSIGN  19549>>ASSIGN  19549>>ASSIGN  19550<<ASSIGN  19550>>ASSIGN
     19551>>ASSIGN  19552>>ASSIGN  19553>>ASSIGN  19554>>ASSIGN  19555>>ASSIGN  19556>>ASSIGN  19557>>IF
     19563>>ASSIGN  19566>>ASSIGN  19567>>ASSIGN  19568>>ASSIGN  19575>>ASSIGN  19576>>ASSIGN  19577>>ASSIGN
     19578>>ASSIGN  19579>>ASSIGN  19580>>ASSIGN  19625>>ASSIGN  19648<<ASSIGN  19649>>IF      19672>>ASSIGN
     19677<<ASSIGN  19689<>CALL
VAMOOSE_3270 IN PROCEDURE CNCDSC
     19355**LABEL   19212--GOTO    19256--GOTO
VAMOOSE_LOG
     18902**DCL     19386<>CALL
VAMOOSE_LOG.BUF_
     18904**DCL     19383<<ASSIGN
VAMOOSE_LOG.V
     18906**DCL     18904--DCLINIT
VAMOOSE_LOG.V.TERMID
     18969**DCL     19385<<ASSIGN
VAMOOSE_LOG.V.TERMID.TERM
     18971**DCL     18980--REDEF
VLP_PNAME.L
     18586**DCL     18586--IMP-SIZ 19545>>ASSIGN  19547>>ASSIGN
VLP_PNAME.NAME
     18586**DCL     19547>>ASSIGN
X
     19083**DCL     19581<<ASSIGN  19583>>IF      19583>>IF      19583>>IF      19586>>ASSIGN  19627>>ASSIGN
     19678<<ASSIGN  19689<>CALL

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:130  
      908        1        /*T***********************************************************/
      909        2        /*T*                                                         */
      910        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      911        4        /*T*                                                         */
      912        5        /*T***********************************************************/
      913        6        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC */
      914        7        /*P*     NAME:     KZP$DRIVER
      915        8                 PURPOSE:  KZP$DRIVER provides the interface which drives
      916        9                           the physical sync line.  It is called either from
      917       10                           the interrupt level or from the path services
      918       11                           level.  The interrupt level reports events which
      919       12                           occur at the line level.  The path services level
      920       13                           reports GS#LIN_EVENT_GO and GS#LIN_EVENT_STOP.
      921       14                           These two events cause the line manager to "do
      922       15                           his thing" and "stop doing his thing".  If the
      923       16                           routine is called from the path services level
      924       17                           the caller must run inhibited.                  */
      925       18
      926       19        KZP$DRIVER: PROC      ( KZ@LINCTX, PEVENT, SIZE );
      927       20
      928       21        %INCLUDE KZ$LINCTX;
      929      641        %INCLUDE KH$CHN;
      930      763        %INCLUDE KZ_BSCFPT;
      931      793        %INCLUDE KZ_CLM_E;
      932      965        %INCLUDE KZ_CLMEVT_C;
      933     1007        %INCLUDE KZ_INIT_C;
      934     1343        %INCLUDE KZ_LIN_C;
      935     1399        %INCLUDE KZ_SCODE_C;
      936     1414        %INCLUDE KZ_PERR_C;
      937     1496        %INCLUDE KV_GLBCNS_E;
      938     1837        %INCLUDE LCP_6;
      939     6116        %INCLUDE CP_6_SUBS;
      940     6656
      941     6657           %KZ$EVENT           ( FPTN = KZ$EVENT,
      942     6658                                 STCLASS = AUTO );
      943     6740    1   DCL PEVENT UBIN WORD PARAM;
      944     6741    1   DCL SIZE UBIN WORD PARAM;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:131  
      945     6742
      946     6743           %KZ$LINCTX          ( NAME = KZ@LINCTX,
      947     6744                                 STCLASS = PARAM );
      948     7175
      949     7176           %KZ_BSCFPT          ( NAME = KZ_BSCFPT,
      950     7177                                 STCLASS = AUTO );
      951     7186           %KZ_BSCFPTEQUS;
      952     7192
      953     7193           %KZ_INIT_MAP        ( NAME = KZ_MAP,
      954     7194                                 STCLASS = "BASED(MAP$)" );
      955     7242
      956     7243           %KZ_INIT_STBL       ( NAME = KZ_TBL,
      957     7244                                 STCLASS = "BASED(TBL$)" );
      958     7451
      959     7452           %KH$CHN             ( STCLASS = BASED );
      960     7576
      961     7577           %KV_DSCRSN_E;
      962     7586
      963     7587           %FPT_WRSYSLOG       ( FPTN = DISC_LOG,
      964     7588                                 FCG = 'KZ',
      965     7589                                 MID = 'P',
      966     7590                                 ERR = %E$LINDSC,
      967     7591                                 SEV = %G_WRSYSLOG_SEV_LINE_ABORT# );
      968     7686
      969     7687    1   DCL KZO$ORDERS ENTRY(2);
      970     7688    1   DCL KZO$ABORT ENTRY(1);
      971     7689    1   DCL KZP$CNCDSC ENTRY (1) ALTRET;
      972     7690    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
      973     7691
      974     7692
      975     7693    1   DCL EVENT UBIN;
      976     7694    1   DCL TBL$ PTR;
      977     7695    1   DCL MAP$ PTR;
      978     7696    1   DCL I UBIN;
      979     7697        %EJECT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:132  
      980     7698    1         TBL$ = KZ@LINCTX.STBL$;
      981     7699    1         MAP$ = KZ@LINCTX.MAP$;
      982     7700
      983     7701        /*
      984     7702            Clear KZ_BSCFPT and load it in preparation for call to the real
      985     7703            line handler.
      986     7704        */
      987     7705    1         EVENT = PEVENT;
      988     7706    1         IF EVENT < KZ_MAP.LDIM OR EVENT > KZ_MAP.HDIM THEN
      989     7707    1            CALL DISCONNECT;
      990     7708    2         ELSE DO;
      991     7709    2            KZ_BSCFPT = '0'B;
      992     7710    2            KZ_BSCFPT.EVT = KZ_MAP.MAP(EVENT - KZ_MAP.LDIM);
      993     7711    2   DRIVER:
      994     7712    2            IF KZ_BSCFPT.EVT = 255 THEN CALL DISCONNECT;
      995     7713    2            I = KZ@LINCTX.LINSTT * KZ_TBL.WID + KZ_BSCFPT.EVT;
      996     7714    2            IF I > KZ_TBL.MAX THEN CALL DISCONNECT;
      997     7715    3            ELSE DO;
      998     7716    3               KZ_BSCFPT.OLDSTT = KZ@LINCTX.LINSTT;
      999     7717    3               KZ@LINCTX.LINSTT = KZ_TBL.TBL.STT(I);
     1000     7718    3               KZ_BSCFPT.NEWSTT = KZ@LINCTX.LINSTT;
     1001     7719    3               KZ_BSCFPT.ACT = KZ_TBL.TBL.ACT(I);
     1002     7720    3               IF ADDR(SIZE) ~= ADDR(NIL)
     1003     7721    3               THEN
     1004     7722    3                  KZ_BSCFPT.SIZ = SIZE;
     1005     7723    3               IF KZ_BSCFPT.NEWSTT = 255 THEN CALL DISCONNECT;
     1006     7724    4               ELSE DO;
     1007     7725    4                  I = KZ@LINCTX.HIST.X;
     1008     7726    4                  KZ@LINCTX.HIST.STT(I) = KZ_BSCFPT.NEWSTT;
     1009     7727    4                  KZ@LINCTX.HIST.ACT(I) = KZ_BSCFPT.ACT;
     1010     7728    4                  KZ@LINCTX.HIST.EVT(I) = KZ_BSCFPT.EVT;
     1011     7729    4                  KZ@LINCTX.HIST.ORD(I) = 0;
     1012     7730    4                  IF KZ@LINCTX.LINMGR@ ~= ENTADDR(NIL) THEN
     1013     7731    4                     CALL KZ@LINCTX.LINMGR@ ( KZ@LINCTX, KZ_BSCFPT )
     1014     7732    4                        ALTRET ( LINFNC );
     1015     7733    4                  END;
     1016     7734    3               END;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:133  
     1017     7735    2            END;
     1018     7736    1         KZ@LINCTX.HIST.X = MOD(I + 1, 8);
     1019     7737        %EJECT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:134  
     1020     7738    2         DO WHILE ( '0'B );
     1021     7739    2   LINFNC:
     1022     7740    2            KZ@LINCTX.HIST.X = MOD(I + 1, 8);
     1023     7741    3            DO CASE ( KZ_BSCFPT.FNC );
     1024     7742
     1025     7743    3             CASE ( %KZ#FNC_NUL );
     1026     7744                                                /* Effective no operation             */
     1027     7745
     1028     7746    3             CASE ( %KZ#FNC_MOV );
     1029     7747
     1030     7748    3               GOTO DRIVER;
     1031     7749
     1032     7750    3             CASE ( %KZ#FNC_DSC );
     1033     7751
     1034     7752    3               CALL DISCONNECT;
     1035     7753
     1036     7754    3             CASE ( %KZ#FNC_SCR );
     1037     7755                                           /* No-op for now, screech later. (Maybe??) */
     1038     7756
     1039     7757    3             END;
     1040     7758    2            END;
     1041     7759    1         RETURN;
     1042     7760        %EJECT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:135  
     1043     7761    1   DISCONNECT: PROC;
     1044     7762
     1045     7763    3         IF NOT KZ@LINCTX.FLAGS.DSC THEN DO;
     1046     7764    3            DISC_LOG.BUF_ = VECTOR ( KZ@LINCTX.HIST );
     1047     7765    3            DISC_LOG.V.TERMID=KZ@LINCTX.LINID;
     1048     7766    3            CALL KHA$ERRLOG ( DISC_LOG )
     1049     7767    4            WHENALTRETURN DO;
     1050     7768    4               END;
     1051     7769
     1052     7770        /*E*     ERROR: KZP-E$LINDSC
     1053     7771               MESSAGE: (KZP$DRIVER) Sync line disconnect
     1054     7772           DESCRIPTION: A line disconnect can be requested because of:
     1055     7773              o A KILL or DISCONNECT keyin
     1056     7774              o An unrecoverable error on the line
     1057     7775              o An illegal event report (software error)
     1058     7776              o A disconnect event from VDH for an RBT device
     1059     7777        */
     1060     7778
     1061     7779    3            CALL KZO$ABORT ( KZ@LINCTX );
     1062     7780    3            KZ@LINCTX.FLAGS.DSC = '1'B;
     1063     7781    3            KZ@LINCTX.DSCRSN = %KV_DSCRSN_FRG;
     1064     7782    3            KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;
     1065     7783    3            KZ$EVENT.TERMID$ = ADDR(KZ@LINCTX.CHN$->KH$CHN.TERMID);
     1066     7784    3            KZ$EVENT.CHN$ = KZ@LINCTX.CHN$;
     1067     7785    3            KZ$EVENT.LINCTX$ = ADDR ( KZ@LINCTX );
     1068     7786    3            CALL KZP$CNCDSC ( KZ$EVENT )
     1069     7787    4            WHENALTRETURN DO;
     1070     7788        /*N* SNAP */
     1071     7789    4               END;
     1072     7790    3            END;
     1073     7791    2         RETURN;
     1074     7792
     1075     7793    2   END DISCONNECT;
     1076     7794
     1077     7795    1   END KZP$DRIVER;
     1078     7796        %EOD;

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:136  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KZ_SCODE_C.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KZ_CLMEVT_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KZ_BSCFPT.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
      No diagnostics issued in procedure KZP$DRIVER.

   Procedure KZP$DRIVER requires 296 words for executable code.
   Procedure KZP$DRIVER requires 42 words of local(AUTO) storage.

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:137  

 Object Unit name= KZP$DRIVER                                 File name= KZP$PSRV.:E05TOU
 UTS= JUL 30 '97 03:00:15.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none    21     15  KZP$DRIVER
    1   Proc  even  none   296    128  KZP$DRIVER
    2  RoData even  none     4      4  KZP$DRIVER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        3  KZP$DRIVER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 KHA$ERRLOG
 yes     yes           Std       1 KZP$CNCDSC
         yes           Std       1 KZO$ABORT
                       nStd      0 X6A_AUTO_3
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    G$ROS$
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:138  


      908        1        /*T***********************************************************/
      909        2        /*T*                                                         */
      910        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      911        4        /*T*                                                         */
      912        5        /*T***********************************************************/
      913        6        /*X* PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC */
      914        7        /*P*     NAME:     KZP$DRIVER
      915        8                 PURPOSE:  KZP$DRIVER provides the interface which drives
      916        9                           the physical sync line.  It is called either from
      917       10                           the interrupt level or from the path services
      918       11                           level.  The interrupt level reports events which
      919       12                           occur at the line level.  The path services level
      920       13                           reports GS#LIN_EVENT_GO and GS#LIN_EVENT_STOP.
      921       14                           These two events cause the line manager to "do
      922       15                           his thing" and "stop doing his thing".  If the
      923       16                           routine is called from the path services level
      924       17                           the caller must run inhibited.                  */
      925       18
      926       19        KZP$DRIVER: PROC      ( KZ@LINCTX, PEVENT, SIZE );

     19   1 000000  D380 0000 0000  xent KZP$DRIVER      LNJ,B5   X6A_AUTO_3
          1 000003       002A 0003                       DC       42,3

      927       20
      928       21        %INCLUDE KZ$LINCTX;
      929      641        %INCLUDE KH$CHN;
      930      763        %INCLUDE KZ_BSCFPT;
      931      793        %INCLUDE KZ_CLM_E;
      932      965        %INCLUDE KZ_CLMEVT_C;
      933     1007        %INCLUDE KZ_INIT_C;
      934     1343        %INCLUDE KZ_LIN_C;
      935     1399        %INCLUDE KZ_SCODE_C;
      936     1414        %INCLUDE KZ_PERR_C;
      937     1496        %INCLUDE KV_GLBCNS_E;
      938     1837        %INCLUDE LCP_6;
      939     6116        %INCLUDE CP_6_SUBS;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:139  
      940     6656
      941     6657           %KZ$EVENT           ( FPTN = KZ$EVENT,
      942     6658                                 STCLASS = AUTO );
      943     6740    1   DCL PEVENT UBIN WORD PARAM;
      944     6741    1   DCL SIZE UBIN WORD PARAM;
      945     6742
      946     6743           %KZ$LINCTX          ( NAME = KZ@LINCTX,
      947     6744                                 STCLASS = PARAM );
      948     7175
      949     7176           %KZ_BSCFPT          ( NAME = KZ_BSCFPT,
      950     7177                                 STCLASS = AUTO );
      951     7186           %KZ_BSCFPTEQUS;
      952     7192
      953     7193           %KZ_INIT_MAP        ( NAME = KZ_MAP,
      954     7194                                 STCLASS = "BASED(MAP$)" );
      955     7242
      956     7243           %KZ_INIT_STBL       ( NAME = KZ_TBL,
      957     7244                                 STCLASS = "BASED(TBL$)" );
      958     7451
      959     7452           %KH$CHN             ( STCLASS = BASED );
      960     7576
      961     7577           %KV_DSCRSN_E;
      962     7586
      963     7587           %FPT_WRSYSLOG       ( FPTN = DISC_LOG,
      964     7588                                 FCG = 'KZ',
      965     7589                                 MID = 'P',
      966     7590                                 ERR = %E$LINDSC,
      967     7591                                 SEV = %G_WRSYSLOG_SEV_LINE_ABORT# );
      968     7686
      969     7687    1   DCL KZO$ORDERS ENTRY(2);
      970     7688    1   DCL KZO$ABORT ENTRY(1);
      971     7689    1   DCL KZP$CNCDSC ENTRY (1) ALTRET;
      972     7690    1   DCL KHA$ERRLOG ENTRY(2) ALTRET;
      973     7691
      974     7692
      975     7693    1   DCL EVENT UBIN;
      976     7694    1   DCL TBL$ PTR;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:140  
      977     7695    1   DCL MAP$ PTR;
      978     7696    1   DCL I UBIN;
      979     7697        %EJECT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:141  
      980     7698    1         TBL$ = KZ@LINCTX.STBL$;

   7698   1 000005  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000007  DCC6 000F                            LDB,B5   15,B6
          1 000009  DFC7 001E                            STB,B5   TBL$,AUTO

      981     7699    1         MAP$ = KZ@LINCTX.MAP$;

   7699   1 00000B  CCC6 0011                            LDB,B4   17,B6
          1 00000D  CFC7 0020                            STB,B4   MAP$,AUTO

      982     7700
      983     7701        /*
      984     7702            Clear KZ_BSCFPT and load it in preparation for call to the real
      985     7703            line handler.
      986     7704        */
      987     7705    1         EVENT = PEVENT;

   7705   1 00000F  BCC7 0006                            LDB,B3   @PEVENT,AUTO
          1 000011  E803                                 LDR,R6   ,B3
          1 000012  EF47 001D                            STR,R6   EVENT,AUTO

      988     7706    1         IF EVENT < KZ_MAP.LDIM OR EVENT > KZ_MAP.HDIM THEN

   7706   1 000014  E904                                 CMR,R6   ,B4
          1 000015  0201 0005                            BL       s:7707,PREL
          1 000017  E944 0001                            CMR,R6   1,B4
          1 000019  0381 0006                            BLE      s:7709,PREL

      989     7707    1            CALL DISCONNECT;

   7707   1 00001B  E3C0 00AF                            LNJ,B6   s:0,PREL
          1 00001D       0001                            DC       s:7707+3,PREL
          1 00001E  0F81 007F                            B        s:7736,PREL

      990     7708    2         ELSE DO;

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:142  
      991     7709    2            KZ_BSCFPT = '0'B;

   7709   1 000020  5C0A                                 LDV,R5   10
          1 000021  0021                                 ALR      ;
          1 000022       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          1 000024       4007 0018                                ALPHANUM(KZ_BSCFPT,AUTO,,R5,FILL)

      992     7710    2            KZ_BSCFPT.EVT = KZ_MAP.MAP(EVENT - KZ_MAP.LDIM);

   7710   1 000026  437F                                 CSYNC    s:7709+5,SPREL
          1 000027  DCC7 0020                            LDB,B5   MAP$,AUTO
          1 000029  E847 001D                            LDR,R6   EVENT,AUTO
          1 00002B  E205                                 SUB,R6   ,B5
          1 00002C  B856                                 LDR,R3   R6
          1 00002D  3E04                                 ADV,R3   4
          1 00002E  E2B5                                 LLH,R6   ,B5,R3
          1 00002F  EF47 0019                            STR,R6   KZ_BSCFPT+1,AUTO

      993     7711    2   DRIVER:
      994     7712    2            IF KZ_BSCFPT.EVT = 255 THEN CALL DISCONNECT;

   7712   1 000031  E847 0019            DRIVER          LDR,R6   KZ_BSCFPT+1,AUTO
          1 000033  E970 00FF                            CMR,R6   255,IMO
          1 000035  0981 0004                            BNE      s:7713,PREL

   7712   1 000037  E3C0 0093                            LNJ,B6   s:0,PREL
          1 000039       0001                            DC       s:7713,PREL

      995     7713    2            I = KZ@LINCTX.LINSTT * KZ_TBL.WID + KZ_BSCFPT.EVT;

   7713   1 00003A  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 00003C  DCC7 001E                            LDB,B5   TBL$,AUTO
          1 00003E  F846 000E                            LDR,R7   14,B6
          1 000040  FB05                                 MUL,R7   ,B5
          1 000041  E857                                 LDR,R6   R7
          1 000042  EA47 0019                            ADD,R6   KZ_BSCFPT+1,AUTO
          1 000044  EF47 0022                            STR,R6   I,AUTO
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:143  

      996     7714    2            IF I > KZ_TBL.MAX THEN CALL DISCONNECT;

   7714   1 000046  E945 0002                            CMR,R6   2,B5
          1 000048  0381 0006                            BLE      s:7716,PREL

   7714   1 00004A  E3C0 0080                            LNJ,B6   s:0,PREL
          1 00004C       0001                            DC       s:7714+7,PREL
          1 00004D  0F81 0050                            B        s:7736,PREL

      997     7715    3            ELSE DO;

      998     7716    3               KZ_BSCFPT.OLDSTT = KZ@LINCTX.LINSTT;

   7716   1 00004F  D846 000E                            LDR,R5   14,B6
          1 000051  DAC7 001A                            SRM,R5,'00FF'X    KZ_BSCFPT+2,AUTO
          1 000053       00FF

      999     7717    3               KZ@LINCTX.LINSTT = KZ_TBL.TBL.STT(I);

   7717   1 000054  B856                                 LDR,R3   R6
          1 000055  3001                                 SOL,R3   1
          1 000056  3E07                                 ADV,R3   7
          1 000057  D2B5                                 LLH,R5   ,B5,R3
          1 000058  DF46 000E                            STR,R5   14,B6

     1000     7718    3               KZ_BSCFPT.NEWSTT = KZ@LINCTX.LINSTT;

   7718   1 00005A  D7C7 001A                            STH,R5   KZ_BSCFPT+2,AUTO

     1001     7719    3               KZ_BSCFPT.ACT = KZ_TBL.TBL.ACT(I);

   7719   1 00005C  A856                                 LDR,R2   R6
          1 00005D  2001                                 SOL,R2   1
          1 00005E  2E06                                 ADV,R2   6
          1 00005F  D2A5                                 LLH,R5   ,B5,R2
          1 000060  DF47 0018                            STR,R5   KZ_BSCFPT,AUTO
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:144  

     1002     7720    3               IF ADDR(SIZE) ~= ADDR(NIL)

   7720   1 000062  CCC7 0008                            LDB,B4   @SIZE,AUTO
          1 000064  8DD4                                 CMN      B4
          1 000065  0901 0004                            BE       s:7723,PREL

     1003     7721    3               THEN
     1004     7722    3                  KZ_BSCFPT.SIZ = SIZE;

   7722   1 000067  C804                                 LDR,R4   ,B4
          1 000068  CF47 001B                            STR,R4   KZ_BSCFPT+3,AUTO

     1005     7723    3               IF KZ_BSCFPT.NEWSTT = 255 THEN CALL DISCONNECT;

   7723   1 00006A  C2C7 001A                            LLH,R4   KZ_BSCFPT+2,AUTO
          1 00006C  C970 00FF                            CMR,R4   255,IMO
          1 00006E  0981 0006                            BNE      s:7725,PREL

   7723   1 000070  E3C0 005A                            LNJ,B6   s:0,PREL
          1 000072       0001                            DC       s:7723+9,PREL
          1 000073  0F81 002A                            B        s:7736,PREL

     1006     7724    4               ELSE DO;

     1007     7725    4                  I = KZ@LINCTX.HIST.X;

   7725   1 000075  E846 0013                            LDR,R6   19,B6
          1 000077  EF47 0022                            STR,R6   I,AUTO

     1008     7726    4                  KZ@LINCTX.HIST.STT(I) = KZ_BSCFPT.NEWSTT;

   7726   1 000079  B856                                 LDR,R3   R6
          1 00007A  3E30                                 ADV,R3   48
          1 00007B  C7B6                                 STH,R4   ,B6,R3

     1009     7727    4                  KZ@LINCTX.HIST.ACT(I) = KZ_BSCFPT.ACT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:145  

   7727   1 00007C  D847 0018                            LDR,R5   KZ_BSCFPT,AUTO
          1 00007E  A856                                 LDR,R2   R6
          1 00007F  2E38                                 ADV,R2   56
          1 000080  D7A6                                 STH,R5   ,B6,R2

     1010     7728    4                  KZ@LINCTX.HIST.EVT(I) = KZ_BSCFPT.EVT;

   7728   1 000081  D847 0019                            LDR,R5   KZ_BSCFPT+1,AUTO
          1 000083  9856                                 LDR,R1   R6
          1 000084  1E28                                 ADV,R1   40
          1 000085  D796                                 STH,R5   ,B6,R1

     1011     7729    4                  KZ@LINCTX.HIST.ORD(I) = 0;

   7729   1 000086  B856                                 LDR,R3   R6
          1 000087  3E40                                 ADV,R3   64
          1 000088  87B6                                 CLH      ,B6,R3

     1012     7730    4                  IF KZ@LINCTX.LINMGR@ ~= ENTADDR(NIL) THEN

   7730   1 000089  BCC6 0070                            LDB,B3   112,B6
          1 00008B  BD80 0000 0000  02                   CMB,B3   0
          1 00008E  0901 000F                            BE       s:7736,PREL

     1013     7731    4                     CALL KZ@LINCTX.LINMGR@ ( KZ@LINCTX, KZ_BSCFPT )

   7731   1 000090  ABC7 0018                            LAB,B2   KZ_BSCFPT,AUTO
          1 000092  AFC7 0028                            STB,B2   I+6,AUTO
          1 000094  EFC7 0026                            STB,B6   I+4,AUTO
          1 000096  BBC7 0026                            LAB,B3   I+4,AUTO
          1 000098  9CC6 0070                            LDB,B1   112,B6
          1 00009A  CBF0 0200                            LAB,B4   512,IMO
          1 00009C  E381                                 LNJ,B6   ,B1
          1 00009D       000C                            DC       s:7740,PREL

     1014     7732    4                        ALTRET ( LINFNC );
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:146  
     1015     7733    4                  END;

     1016     7734    3               END;

     1017     7735    2            END;

     1018     7736    1         KZ@LINCTX.HIST.X = MOD(I + 1, 8);

   7736   1 00009E  E847 0022                            LDR,R6   I,AUTO
          1 0000A0  6E01                                 ADV,R6   1
          1 0000A1  E570 0007                            AND,R6   7,IMO
          1 0000A3  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0000A5  EF46 0013                            STR,R6   19,B6

     1019     7737        %EJECT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:147  
     1020     7738    2         DO WHILE ( '0'B );

   7738   1 0000A7  0F81 0020                            B        s:7759,PREL

     1021     7739    2   LINFNC:
     1022     7740    2            KZ@LINCTX.HIST.X = MOD(I + 1, 8);

   7740   1 0000A9  E847 0022            LINFNC          LDR,R6   I,AUTO
          1 0000AB  6E01                                 ADV,R6   1
          1 0000AC  E570 0007                            AND,R6   7,IMO
          1 0000AE  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 0000B0  EF46 0013                            STR,R6   19,B6

     1023     7741    3            DO CASE ( KZ_BSCFPT.FNC );

   7741   1 0000B2  B847 001C                            LDR,R3   KZ_BSCFPT+4,AUTO
          1 0000B4  3D04                                 CMV,R3   4
          1 0000B5  0281 0012                            BGE      s:7759,PREL
          1 0000B7  A830 0000 00BD  01                   LDR,R2   s:7741+11,R3
          1 0000BA  83A0 0000 00C1  01                   JMP      s:7748,R2
          1 0000BD       0007                            DC       s:7759,PREL
          1 0000BE       0007                            DC       s:7759,PREL
          1 0000BF       0002                            DC       s:7752,PREL
          1 0000C0       0000                            DC       s:7748,PREL

     1024     7742
     1025     7743    3             CASE ( %KZ#FNC_NUL );

     1026     7744                                                /* Effective no operation             */
     1027     7745
     1028     7746    3             CASE ( %KZ#FNC_MOV );

     1029     7747
     1030     7748    3               GOTO DRIVER;

   7748   1 0000C1  0F81 FF6F                            B        s:7712,PREL

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:148  
     1031     7749
     1032     7750    3             CASE ( %KZ#FNC_DSC );

     1033     7751
     1034     7752    3               CALL DISCONNECT;

   7752   1 0000C3  E3C0 0007                            LNJ,B6   s:0,PREL
          1 0000C5       0001                            DC       s:7752+3,PREL
          1 0000C6  0F81 0001                            B        s:7759,PREL

     1035     7753
     1036     7754    3             CASE ( %KZ#FNC_SCR );

     1037     7755                                           /* No-op for now, screech later. (Maybe??) */
     1038     7756
     1039     7757    3             END;

     1040     7758    2            END;

     1041     7759    1         RETURN;

   7759   1 0000C8  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1042     7760        %EJECT;
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:149  
     1043     7761    1   DISCONNECT: PROC;

   7761   1 0000CB  EFC7 0024            DISCONNECT      STB,B6   I+2,AUTO

     1044     7762
     1045     7763    3         IF NOT KZ@LINCTX.FLAGS.DSC THEN DO;

   7763   1 0000CD  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          1 0000CF  82C5 0034                            LB,'1000'X        52,B5
          1 0000D1       1000
          1 0000D2  0501 0051                            BBT      s:7791,PREL

     1046     7764    3            DISC_LOG.BUF_ = VECTOR ( KZ@LINCTX.HIST );

   7764   1 0000D4  CBC5 0013                            LAB,B4   19,B5
          1 0000D6  CFC7 0027                            STB,B4   I+5,AUTO
          1 0000D8  6C21                                 LDV,R6   33
          1 0000D9  EF47 0026                            STR,R6   I+4,AUTO
          1 0000DB  ABC7 0026                            LAB,B2   I+4,AUTO
          1 0000DD  2C00                                 LDV,R2   0
          1 0000DE  6C06                                 LDV,R6   6
          1 0000DF  BB80 0000 0000  00                   LAB,B3   DISC_LOG
          1 0000E2  3C06                                 LDV,R3   6
          1 0000E3  0008                                 MMM

     1047     7765    3            DISC_LOG.V.TERMID=KZ@LINCTX.LINID;

   7765   1 0000E4  AB85                                 LAB,B2   ,B5
          1 0000E5  2C08                                 LDV,R2   8
          1 0000E6  6C10                                 LDV,R6   16
          1 0000E7  BB80 0000 0000  00                   LAB,B3   DISC_LOG
          1 0000EA  3C10                                 LDV,R3   16
          1 0000EB  0008                                 MMM

     1048     7766    3            CALL KHA$ERRLOG ( DISC_LOG )

   7766   1 0000EC  BB80 0000 0002  02                   LAB,B3   +2
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:150  
          1 0000EF  CBF0 0100                            LAB,B4   256,IMO
          1 0000F1  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          1 0000F4       0003                            DC       s:7779,PREL
          1 0000F5  0F81 0001                            B        s:7779,PREL

     1049     7767    4            WHENALTRETURN DO;

     1050     7768    4               END;

     1051     7769
     1052     7770        /*E*     ERROR: KZP-E$LINDSC
     1053     7771               MESSAGE: (KZP$DRIVER) Sync line disconnect
     1054     7772           DESCRIPTION: A line disconnect can be requested because of:
     1055     7773              o A KILL or DISCONNECT keyin
     1056     7774              o An unrecoverable error on the line
     1057     7775              o An illegal event report (software error)
     1058     7776              o A disconnect event from VDH for an RBT device
     1059     7777        */
     1060     7778
     1061     7779    3            CALL KZO$ABORT ( KZ@LINCTX );

   7779   1 0000F7  BBC7 0004                            LAB,B3   @KZ@LINCTX,AUTO
          1 0000F9  CBF0 0100                            LAB,B4   256,IMO
          1 0000FB  E380 0000 0000  xent                 LNJ,B6   KZO$ABORT
          1 0000FE       0001                            DC       s:7780,PREL

     1062     7780    3            KZ@LINCTX.FLAGS.DSC = '1'B;

   7780   1 0000FF  ECC7 0004                            LDB,B6   @KZ@LINCTX,AUTO
          1 000101  8946 0034                            LBT,'1000'X       52,B6
          1 000103       1000

     1063     7781    3            KZ@LINCTX.DSCRSN = %KV_DSCRSN_FRG;

   7781   1 000104  6C03                                 LDV,R6   3
          1 000105  EF46 0038                            STR,R6   56,B6

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:151  
     1064     7782    3            KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;

   7782   1 000107  5C07                                 LDV,R5   7
          1 000108  DF47 000A                            STR,R5   KZ$EVENT,AUTO

     1065     7783    3            KZ$EVENT.TERMID$ = ADDR(KZ@LINCTX.CHN$->KH$CHN.TERMID);

   7783   1 00010A  DCC6 0002                            LDB,B5   2,B6
          1 00010C  CBC5 0012                            LAB,B4   18,B5
          1 00010E  CFC7 000F                            STB,B4   KZ$EVENT+5,AUTO

     1066     7784    3            KZ$EVENT.CHN$ = KZ@LINCTX.CHN$;

   7784   1 000110  DCC6 0002                            LDB,B5   2,B6
          1 000112  DFC7 0011                            STB,B5   KZ$EVENT+7,AUTO

     1067     7785    3            KZ$EVENT.LINCTX$ = ADDR ( KZ@LINCTX );

   7785   1 000114  EFC7 000D                            STB,B6   KZ$EVENT+3,AUTO

     1068     7786    3            CALL KZP$CNCDSC ( KZ$EVENT )

   7786   1 000116  BBC7 000A                            LAB,B3   KZ$EVENT,AUTO
          1 000118  BFC7 0026                            STB,B3   I+4,AUTO
          1 00011A  BBC7 0026                            LAB,B3   I+4,AUTO
          1 00011C  CBF0 0100                            LAB,B4   256,IMO
          1 00011E  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          1 000121       0003                            DC       s:7791,PREL
          1 000122  0F81 0001                            B        s:7791,PREL

     1069     7787    4            WHENALTRETURN DO;

     1070     7788        /*N* SNAP */
     1071     7789    4               END;

     1072     7790    3            END;

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:152  
     1073     7791    2         RETURN;

   7791   1 000124  ECC7 0024                            LDB,B6   I+2,AUTO
          1 000126  C3C6 0001                            LNJ,B4   1,B6
     1074     7792
     1075     7793    2   END DISCONNECT;
     1076     7794
     1077     7795    1   END KZP$DRIVER;
     1078     7796        %EOD;

PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:153  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KZ_PERR_C.:E05TOU  is referenced.
   KZ_SCODE_C.:E05TOU  is referenced.
   KZ_LIN_C.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KZ_CLMEVT_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KZ_BSCFPT.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
      No diagnostics issued in procedure KZP$DRIVER.
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:154  

 **** Variables and constants ****

  ****  Section 000  Data  KZP$DRIVER

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(336)   r     1 DISC_LOG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KZ@LINCTX                 6-0-0/w PTR         r     1 @PEVENT
     8-0-0/w PTR         r     1 @SIZE                     1D-0-0/w UBIN(16)    r     1 EVENT
    22-0-0/w UBIN(16)    r     1 I                          A-0-0/w STRC(224)   r     1 KZ$EVENT
    *0-0-0/w STRC(2192)  r     1 KZ@LINCTX                 18-0-0/w STRC(80)    r     1 KZ_BSCFPT
    20-0-0/w PTR         r     1 MAP$                      *0-0-0/w UBIN(16)    r     1 PEVENT
    *0-0-0/w UBIN(16)    r     1 SIZE                      1E-0-0/w PTR         r     1 TBL$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(280)   r     1 KZ_MAP
     0-0-0/w STRC(3024)  r     1 KZ_TBL


   Procedure KZP$DRIVER requires 296 words for executable code.
   Procedure KZP$DRIVER requires 42 words of local(AUTO) storage.
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:155  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:156  
          MINI XREF LISTING

DISCONNECT
      7761**PROC     7707--CALL     7712--CALL     7714--CALL     7723--CALL     7752--CALL
DISC_LOG
      7604**DCL      7766<>CALL
DISC_LOG.BUF_
      7606**DCL      7764<<ASSIGN
DISC_LOG.V
      7608**DCL      7606--DCLINIT
DISC_LOG.V.TERMID
      7671**DCL      7765<<ASSIGN
DISC_LOG.V.TERMID.TERM
      7673**DCL      7682--REDEF
DRIVER
      7712**LABEL    7748--GOTO
EVENT
      7693**DCL      7705<<ASSIGN   7706>>IF       7706>>IF       7710>>ASSIGN
I
      7696**DCL      7713<<ASSIGN   7714>>IF       7717>>ASSIGN   7719>>ASSIGN   7725<<ASSIGN   7726>>ASSIGN
      7727>>ASSIGN   7728>>ASSIGN   7729>>ASSIGN   7736>>ASSIGN   7740>>ASSIGN
KH$CHN.TERMID
      7561**DCL      7783--ASSIGN
KH$CHN.TERMID.TERM
      7563**DCL      7572--REDEF
KHA$ERRLOG
      7690**DCL-ENT  7766--CALL
KZ$EVENT
      6672**DCL      7786<>CALL
KZ$EVENT.CHN$
      6685**DCL      7784<<ASSIGN
KZ$EVENT.EVENT
      6673**DCL      7782<<ASSIGN
KZ$EVENT.LINCTX$
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:157  
      6679**DCL      7785<<ASSIGN
KZ$EVENT.TERMID$
      6682**DCL      7783<<ASSIGN
KZ@LINCTX
      6755**DCL        19--PROC     7731<>CALL     7779<>CALL     7785--ASSIGN
KZ@LINCTX.CHN$
      6758**DCL      7783>>ASSIGN   7784>>ASSIGN
KZ@LINCTX.DSCRSN
      6926**DCL      7781<<ASSIGN
KZ@LINCTX.FLAGS.DSC
      6863**DCL      7763>>IF       7780<<ASSIGN
KZ@LINCTX.HIST
      6801**DCL      7764--ASSIGN
KZ@LINCTX.HIST.ACT
      6809**DCL      7727<<ASSIGN
KZ@LINCTX.HIST.EVT
      6805**DCL      7728<<ASSIGN
KZ@LINCTX.HIST.ORD
      6811**DCL      7729<<ASSIGN
KZ@LINCTX.HIST.STT
      6807**DCL      7726<<ASSIGN
KZ@LINCTX.HIST.X
      6803**DCL      7725>>ASSIGN   7736<<ASSIGN   7740<<ASSIGN
KZ@LINCTX.LINID
      6776**DCL      7765>>ASSIGN
KZ@LINCTX.LINID.TERM
      6778**DCL      6787--REDEF
KZ@LINCTX.LINMGR@
      7120**DCL      7730>>IF       7731>>CALL
KZ@LINCTX.LINSTT
      6795**DCL      7713>>ASSIGN   7716>>ASSIGN   7717<<ASSIGN   7718>>ASSIGN
KZ@LINCTX.MAP$
      6799**DCL      7699>>ASSIGN
KZ@LINCTX.OTPCNT
      7043**DCL      7046--REDEF
KZ@LINCTX.POLSIZ
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:158  
      7089**DCL      7091--REDEF
KZ@LINCTX.STBL$
      6797**DCL      7698>>ASSIGN
KZO$ABORT
      7688**DCL-ENT  7779--CALL
KZP$CNCDSC
      7689**DCL-ENT  7786--CALL
KZ_BSCFPT
      7178**DCL      7709<<ASSIGN   7731<>CALL
KZ_BSCFPT.ACT
      7179**DCL      7719<<ASSIGN   7727>>ASSIGN
KZ_BSCFPT.EVT
      7180**DCL      7710<<ASSIGN   7712>>IF       7713>>ASSIGN   7728>>ASSIGN
KZ_BSCFPT.FNC
      7184**DCL      7741>>DOCASE
KZ_BSCFPT.NEWSTT
      7181**DCL      7718<<ASSIGN   7723>>IF       7726>>ASSIGN
KZ_BSCFPT.OLDSTT
      7182**DCL      7716<<ASSIGN
KZ_BSCFPT.SIZ
      7183**DCL      7722<<ASSIGN
KZ_MAP.HDIM
      7208**DCL      7706>>IF
KZ_MAP.LDIM
      7207**DCL      7706>>IF       7710>>ASSIGN
KZ_MAP.MAP
      7209**DCL      7710>>ASSIGN
KZ_TBL.MAX
      7259**DCL      7714>>IF
KZ_TBL.PL6ISDUMB
      7260**DCL      7447--REDEF
KZ_TBL.TBL.ACT
      7448**DCL      7719>>ASSIGN
KZ_TBL.TBL.STT
      7449**DCL      7717>>ASSIGN
KZ_TBL.WID
PL6.E3A0      #002=KZP$DRIVER File=KZP$PSRV.:E05TSI                              WED 07/30/97 03:00 Page:159  
      7257**DCL      7713>>ASSIGN
LINFNC
      7740**LABEL    7731--CALLALT
MAP$
      7695**DCL      7206--IMP-PTR  7699<<ASSIGN   7706>>IF       7706>>IF       7710>>ASSIGN   7710>>ASSIGN
PEVENT
      6740**DCL        19--PROC     7705>>ASSIGN
SIZE
      6741**DCL        19--PROC     7720--IF       7722>>ASSIGN
TBL$
      7694**DCL      7256--IMP-PTR  7698<<ASSIGN   7713>>ASSIGN   7714>>IF       7717>>ASSIGN   7719>>ASSIGN

PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:160  
     1079        1        /*T***********************************************************/
     1080        2        /*T*                                                         */
     1081        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1082        4        /*T*                                                         */
     1083        5        /*T***********************************************************/
     1084        6        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:161  
     1085        7        /*F*     NAME:     KZP$INIT
     1086        8                 PURPOSE:  This is the initial device manager for non-auto
     1087        9                           logged lines.  It is called when the initial ENQ
     1088       10                           comes on the line.  If it were an SOH-ENQ the
     1089       11                           line context is initialized with minimum required
     1090       12                           data to support logging on a HASP line.  If it were
     1091       13                           an ENQ, the line context is initialized for 3780
     1092       14                           protocol.
     1093       15        */
     1094       16        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:162  
     1095       17        KZP$INIT: PROC ( KZ@LINCTX, KZ@BSCFPT ) ALTRET;
     1096       18
     1097       19           %INCLUDE KH$CHN;
     1098      141           %INCLUDE KZ$LINCTX;
     1099      761           %INCLUDE KZ_BSCFPT;
     1100      791           %INCLUDE KZ_CLM_E;
     1101      963           %INCLUDE KZ_INIT_C;
     1102     1299           %INCLUDE KZ_MLCP_C;
     1103     1374           %INCLUDE KL_SUPER_C;
     1104     4276           %INCLUDE LCP_6;
     1105     8555           %INCLUDE CP_6_SUBS;
     1106     9095
     1107     9096           %KZ$LINCTX         ( NAME = KZ@LINCTX,
     1108     9097                                STCLASS = PARAM );
     1109     9528           %KZ_BSCFPT         ( NAME = KZ@BSCFPT,
     1110     9529                                STCLASS = PARAM );
     1111     9538
     1112     9539           %KZ$EVENT          ( STCLASS = AUTO );
     1113     9621
     1114     9622           %KZ_INIT_HDR       ( NAME = KZ_INIT_HDR,
     1115     9623                                STTHND = NIL,
     1116     9624                                STTBFR = NIL,
     1117     9625                                STCLASS = "CONSTANT SYMDEF" );
     1118     9649
     1119     9650           %KZ_INIT_MAP       ( NAME = KZ_INIT_MAP,
     1120     9651                                STCLASS = "CONSTANT SYMDEF" );
     1121     9699
     1122     9700           %KZ_INIT_STBL      ( NAME = KZ_INIT_STBL,
     1123     9701                                STCLASS = "CONSTANT SYMDEF" );
     1124     9908
     1125     9909           %KZ_INIT_HDR       ( NAME = KZ$HDR,
     1126     9910                                STCLASS = BASED );
     1127     9934
     1128     9935           %KH$CHN;
     1129    10059
     1130    10060           %FPT_WRSYSLOG       ( FPTN = MEMORY_LOG,
     1131    10061                                 STCLASS = SYMREF );
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:163  
     1132    10156
     1133    10157
     1134    10158    1   DCL KHA$ERRLOG ENTRY (2) ALTRET;
     1135    10159    1   DCL KVB$GETSYS ENTRY (2) ALTRET;
     1136    10160    1   DCL KZO$ABORT ENTRY (1);
     1137    10161    1   DCL KZO$ORDERS ENTRY (2);
     1138    10162    1   DCL KZP$CNCDSC ENTRY (1) ALTRET;
     1139    10163
     1140    10164    1   DCL KZ_HDR$(0:13) PTR SYMREF;
     1141    10165    1   DCL KZR_THRTL_BLK UBIN SYMREF;
     1142    10166    1   DCL KZR_THRTL_UNBLK UBIN SYMREF;
     1143    10167    1   DCL SZ UBIN;
     1144    10168        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:164  
     1145    10169    2         DO CASE ( KZ@BSCFPT.ACT );
     1146    10170
     1147    10171    2          CASE ( %KZ#INTACT_REDBID );
     1148    10172
     1149    10173    2            CALL KZO$ABORT ( KZ@LINCTX );
     1150    10174
     1151    10175    2          CASE ( %KZ#INTACT_HSPMST );
     1152    10176
     1153    10177    2            KZ@LINCTX.BCB.RCV = 15;
     1154    10178    2            CALL SETPRM ( %KLPT_HASP# ) ALTRET ( BAD_SETPRM );
     1155    10179
     1156    10180    2          CASE ( %KZ#INTACT_BSCMST );
     1157    10181
     1158    10182    2            KZ@LINCTX.FLAGS.SETCLK = '1'B;
     1159    10183    2            CALL SETPRM ( %KLPT_3780# ) ALTRET ( BAD_SETPRM );
     1160    10184
     1161    10185    2          END;
     1162    10186
     1163    10187    1         CALL KZO$ORDERS ( %KZ#SEND_NOTHING, KZ@LINCTX );
     1164    10188
     1165    10189    1   BAD_SETPRM:
     1166    10190    1         ALTRETURN;
     1167    10191        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:165  
     1168    10192        /*    Initialize parameters needed to read signon string.          */
     1169    10193
     1170    10194    1   SETPRM: PROC (PROTYPE) ALTRET;
     1171    10195
     1172    10196    2   DCL PROTYPE UBIN;
     1173    10197
     1174    10198
     1175    10199    2   DCL I SBIN;
     1176    10200    2   DCL BUF$ PTR;
     1177    10201
     1178    10202    2   DCL 1 DFLT(0:1) STATIC,            /* defaults based on bid type */
     1179    10203    2         2 BLKRECS UBIN INIT(0,7),
     1180    10204    2         2 BLKBYTES UBIN INIT(400,256),
     1181    10205    2         2 RETRYS UBIN INIT(15,15),
     1182    10206    2         2 DELAYS UBIN INIT(25,3);
     1183    10207
     1184    10208
     1185    10209    2         IF PROTYPE = %KLPT_HASP# THEN
     1186    10210    2            I=0;
     1187    10211    2         ELSE
     1188    10212    2            I=1;
     1189    10213    2         KZ@LINCTX.PRO.PROTYP = PROTYPE;
     1190    10214    2         KZ@LINCTX.PRO.BLKRECS = DFLT.BLKRECS(I);
     1191    10215    2         KZ@LINCTX.PRO.BLKBYTES = DFLT.BLKBYTES(I);
     1192    10216    2         KZ@LINCTX.PRO.RETRYS = DFLT.RETRYS(I);
     1193    10217    2         KZ@LINCTX.PRO.DELAYS = DFLT.DELAYS(I);
     1194    10218              /*  Get an input buffer for the remote signon string.  */
     1195    10219    2         SZ = 64;
     1196    10220    2         CALL KVB$GETSYS ( SZ, BUF$ )
     1197    10221    3         WHENALTRETURN DO;
     1198    10222    3            MEMORY_LOG.V.TERMID = KZ@LINCTX.LINID;
     1199    10223    3            MEMORY_LOG.V.VALUES (0) = SZ;
     1200    10224    3            CALL KHA$ERRLOG ( MEMORY_LOG ) ALTRET ( IGNORE_MEMORY_LOG_ALTRET );
     1201    10225    3   IGNORE_MEMORY_LOG_ALTRET:
     1202    10226    3            KZ@LINCTX.PRO.PROTYP = 0;
     1203    10227    3            KZ$EVENT = '0'B;
     1204    10228    3            KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:166  
     1205    10229    3            CALL KZP$CNCDSC ( KZ$EVENT );
     1206    10230    3            ALTRETURN;
     1207    10231    3            END;
     1208    10232    2         KZ@LINCTX.INPBFR$ = BUF$;
     1209    10233    2         KZ@LINCTX.INPBFRSIZ = 64;
     1210    10234    2         I = PROTYPE*2;
     1211    10235    2         KZ@LINCTX.STBL$ = KZ_HDR$(I) -> KZ$HDR.STBL$;
     1212    10236    2         KZ@LINCTX.MAP$ = KZ_HDR$(I) -> KZ$HDR.EMAP$;
     1213    10237    2         KZ@LINCTX.LINMGR@ = KZ_HDR$(I) -> KZ$HDR.LINHND@;
     1214    10238    2         KZ@LINCTX.DEVMGR@ = KZ_HDR$(I) -> KZ$HDR.DVCHND@;
     1215    10239    2         KZ@LINCTX.TIMOUT.PRIMARY = 20;
     1216    10240    2         KZ@LINCTX.TIMOUT.SECONDARY = 20;
     1217    10241    3         IF KZ@LINCTX.CHN$->KH$CHN.BLOCK = 0 THEN DO;
     1218    10242    3            KZ@LINCTX.CHN$->KH$CHN.BLOCK = KZR_THRTL_BLK;
     1219    10243    3            KZ@LINCTX.CHN$->KH$CHN.UNBLOCK = KZR_THRTL_UNBLK;
     1220    10244    3            END;
     1221    10245
     1222    10246    2         RETURN;
     1223    10247
     1224    10248    2   END SETPRM;
     1225    10249
     1226    10250    1   END KZP$INIT;

PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:167  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KZ_MLCP_C.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KZ_BSCFPT.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
      No diagnostics issued in procedure KZP$INIT.

   Procedure KZP$INIT requires 262 words for executable code.
   Procedure KZP$INIT requires 36 words of local(AUTO) storage.

    No errors detected in file KZP$PSRV.:E05TSI    .

PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:168  

 Object Unit name= KZP$INIT                                   File name= KZP$PSRV.:E05TOU
 UTS= JUL 30 '97 03:01:09.76 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS    224     E0  KZP$INIT
    1   Data  even  none     8      8  KZP$INIT
    2   Proc  even  none   262    106  KZP$INIT
    3  RoData even  none     2      2  KZP$INIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  KZP$INIT

  ****  Data defs  ****

 Sect HexLoc  Name                           Sect HexLoc  Name
    0      0  KZ_INIT_HDR                        0     11  KZ_INIT_MAP
    0     23  KZ_INIT_STBL
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:169  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 KZO$ABORT
         yes           Std       2 KZO$ORDERS
 yes     yes           Std       2 KVB$GETSYS
 yes     yes           Std       2 KHA$ERRLOG
 yes     yes           Std       1 KZP$CNCDSC
 yes     yes           Std       2 KZP$INIT
                       nStd      0 X6A_AUTO_2
                       nStd      0 X6A_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     MEMORY_LOG                            KZ_HDR$                               KZR_THRTL_BLK
     KZR_THRTL_UNBLK                  r    G$ROS$
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:170  


     1079        1        /*T***********************************************************/
     1080        2        /*T*                                                         */
     1081        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1082        4        /*T*                                                         */
     1083        5        /*T***********************************************************/
     1084        6        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:171  
     1085        7        /*F*     NAME:     KZP$INIT
     1086        8                 PURPOSE:  This is the initial device manager for non-auto
     1087        9                           logged lines.  It is called when the initial ENQ
     1088       10                           comes on the line.  If it were an SOH-ENQ the
     1089       11                           line context is initialized with minimum required
     1090       12                           data to support logging on a HASP line.  If it were
     1091       13                           an ENQ, the line context is initialized for 3780
     1092       14                           protocol.
     1093       15        */
     1094       16        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:172  
     1095       17        KZP$INIT: PROC ( KZ@LINCTX, KZ@BSCFPT ) ALTRET;

     17   2 000000  D380 0000 0000  xent KZP$INIT        LNJ,B5   X6A_AUTO_2
          2 000003       0024 0002                       DC       36,2

     1096       18
     1097       19           %INCLUDE KH$CHN;
     1098      141           %INCLUDE KZ$LINCTX;
     1099      761           %INCLUDE KZ_BSCFPT;
     1100      791           %INCLUDE KZ_CLM_E;
     1101      963           %INCLUDE KZ_INIT_C;
     1102     1299           %INCLUDE KZ_MLCP_C;
     1103     1374           %INCLUDE KL_SUPER_C;
     1104     4276           %INCLUDE LCP_6;
     1105     8555           %INCLUDE CP_6_SUBS;
     1106     9095
     1107     9096           %KZ$LINCTX         ( NAME = KZ@LINCTX,
     1108     9097                                STCLASS = PARAM );
     1109     9528           %KZ_BSCFPT         ( NAME = KZ@BSCFPT,
     1110     9529                                STCLASS = PARAM );
     1111     9538
     1112     9539           %KZ$EVENT          ( STCLASS = AUTO );
     1113     9621
     1114     9622           %KZ_INIT_HDR       ( NAME = KZ_INIT_HDR,
     1115     9623                                STTHND = NIL,
     1116     9624                                STTBFR = NIL,
     1117     9625                                STCLASS = "CONSTANT SYMDEF" );
     1118     9649
     1119     9650           %KZ_INIT_MAP       ( NAME = KZ_INIT_MAP,
     1120     9651                                STCLASS = "CONSTANT SYMDEF" );
     1121     9699
     1122     9700           %KZ_INIT_STBL      ( NAME = KZ_INIT_STBL,
     1123     9701                                STCLASS = "CONSTANT SYMDEF" );
     1124     9908
     1125     9909           %KZ_INIT_HDR       ( NAME = KZ$HDR,
     1126     9910                                STCLASS = BASED );
     1127     9934
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:173  
     1128     9935           %KH$CHN;
     1129    10059
     1130    10060           %FPT_WRSYSLOG       ( FPTN = MEMORY_LOG,
     1131    10061                                 STCLASS = SYMREF );
     1132    10156
     1133    10157
     1134    10158    1   DCL KHA$ERRLOG ENTRY (2) ALTRET;
     1135    10159    1   DCL KVB$GETSYS ENTRY (2) ALTRET;
     1136    10160    1   DCL KZO$ABORT ENTRY (1);
     1137    10161    1   DCL KZO$ORDERS ENTRY (2);
     1138    10162    1   DCL KZP$CNCDSC ENTRY (1) ALTRET;
     1139    10163
     1140    10164    1   DCL KZ_HDR$(0:13) PTR SYMREF;
     1141    10165    1   DCL KZR_THRTL_BLK UBIN SYMREF;
     1142    10166    1   DCL KZR_THRTL_UNBLK UBIN SYMREF;
     1143    10167    1   DCL SZ UBIN;
     1144    10168        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:174  
     1145    10169    2         DO CASE ( KZ@BSCFPT.ACT );

  10169   2 000005  ECC7 0006                            LDB,B6   @KZ@BSCFPT,AUTO
          2 000007  B806                                 LDR,R3   ,B6
          2 000008  3D04                                 CMV,R3   4
          2 000009  0281 002F                            BGE      s:10187,PREL
          2 00000B  A830 0000 0011  02                   LDR,R2   s:10169+12,R3
          2 00000E  83A0 0000 0015  02                   JMP      s:10173,R2
          2 000011       0024                            DC       s:10187,PREL
          2 000012       0000                            DC       s:10173,PREL
          2 000013       000A                            DC       s:10177,PREL
          2 000014       0018                            DC       s:10182,PREL

     1146    10170
     1147    10171    2          CASE ( %KZ#INTACT_REDBID );

     1148    10172
     1149    10173    2            CALL KZO$ABORT ( KZ@LINCTX );

  10173   2 000015  BBC7 0004                            LAB,B3   @KZ@LINCTX,AUTO
          2 000017  CBF0 0100                            LAB,B4   256,IMO
          2 000019  E380 0000 0000  xent                 LNJ,B6   KZO$ABORT
          2 00001C       0001                            DC       s:10173+8,PREL
          2 00001D  0F81 001B                            B        s:10187,PREL

     1150    10174
     1151    10175    2          CASE ( %KZ#INTACT_HSPMST );

     1152    10176
     1153    10177    2            KZ@LINCTX.BCB.RCV = 15;

  10177   2 00001F  6C0F                                 LDV,R6   15
          2 000020  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          2 000022  E7C5 004D                            STH,R6   77,B5

     1154    10178    2            CALL SETPRM ( %KLPT_HASP# ) ALTRET ( BAD_SETPRM );

PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:175  
  10178   2 000024  CBF0 0003                            LAB,B4   3,IMO
          2 000026  CFC7 001A                            STB,B4   SZ+4,AUTO
          2 000028  E3C0 0023                            LNJ,B6   s:0,PREL
          2 00002A       001F                            DC       s:10190,PREL
          2 00002B  0F81 000D                            B        s:10187,PREL

     1155    10179
     1156    10180    2          CASE ( %KZ#INTACT_BSCMST );

     1157    10181
     1158    10182    2            KZ@LINCTX.FLAGS.SETCLK = '1'B;

  10182   2 00002D  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          2 00002F  8945 0034                            LBT,'0020'X       52,B5
          2 000031       0020

     1159    10183    2            CALL SETPRM ( %KLPT_3780# ) ALTRET ( BAD_SETPRM );

  10183   2 000032  CBF0 0002                            LAB,B4   2,IMO
          2 000034  CFC7 001A                            STB,B4   SZ+4,AUTO
          2 000036  E3C0 0015                            LNJ,B6   s:0,PREL
          2 000038       0011                            DC       s:10190,PREL

     1160    10184
     1161    10185    2          END;

     1162    10186
     1163    10187    1         CALL KZO$ORDERS ( %KZ#SEND_NOTHING, KZ@LINCTX );

  10187   2 000039  EBF0 000C                            LAB,B6   12,IMO
          2 00003B  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          2 00003D  DFC7 0022                            STB,B5   BUF$+5,AUTO
          2 00003F  EFC7 0020                            STB,B6   BUF$+3,AUTO
          2 000041  BBC7 0020                            LAB,B3   BUF$+3,AUTO
          2 000043  CBF0 0200                            LAB,B4   512,IMO
          2 000045  E380 0000 0000  xent                 LNJ,B6   KZO$ORDERS
          2 000048       0001                            DC       s:10190,PREL
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:176  

     1164    10188
     1165    10189    1   BAD_SETPRM:
     1166    10190    1         ALTRETURN;

  10190   2 000049  C380 0000 0000  xent BAD_SETPRM      LNJ,B4   X6A_AALT

     1167    10191        %EJECT;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:177  
     1168    10192        /*    Initialize parameters needed to read signon string.          */
     1169    10193
     1170    10194    1   SETPRM: PROC (PROTYPE) ALTRET;

  10194   2 00004C  EFC7 0018            SETPRM          STB,B6   SZ+2,AUTO

     1171    10195
     1172    10196    2   DCL PROTYPE UBIN;
     1173    10197
     1174    10198
     1175    10199    2   DCL I SBIN;
     1176    10200    2   DCL BUF$ PTR;
     1177    10201
     1178    10202    2   DCL 1 DFLT(0:1) STATIC,            /* defaults based on bid type */
     1179    10203    2         2 BLKRECS UBIN INIT(0,7),
     1180    10204    2         2 BLKBYTES UBIN INIT(400,256),
     1181    10205    2         2 RETRYS UBIN INIT(15,15),
     1182    10206    2         2 DELAYS UBIN INIT(25,3);
     1183    10207
     1184    10208
     1185    10209    2         IF PROTYPE = %KLPT_HASP# THEN

  10209   2 00004E  DCC7 001A                            LDB,B5   @PROTYPE,AUTO
          2 000050  E805                                 LDR,R6   ,B5
          2 000051  6D03                                 CMV,R6   3
          2 000052  0981 0005                            BNE      s:10212,PREL

     1186    10210    2            I=0;

  10210   2 000054  8747 001C                            CL       I,AUTO
          2 000056  0F81 0004                            B        s:10213,PREL

     1187    10211    2         ELSE
     1188    10212    2            I=1;

  10212   2 000058  5C01                                 LDV,R5   1
          2 000059  DF47 001C                            STR,R5   I,AUTO
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:178  

     1189    10213    2         KZ@LINCTX.PRO.PROTYP = PROTYPE;

  10213   2 00005B  CCC7 0004                            LDB,B4   @KZ@LINCTX,AUTO
          2 00005D  EF44 003A                            STR,R6   58,B4

     1190    10214    2         KZ@LINCTX.PRO.BLKRECS = DFLT.BLKRECS(I);

  10214   2 00005F  B847 001C                            LDR,R3   I,AUTO
          2 000061  3002                                 SOL,R3   2
          2 000062  D830 0000 0000  01                   LDR,R5   DFLT,R3
          2 000065  DF44 003B                            STR,R5   59,B4

     1191    10215    2         KZ@LINCTX.PRO.BLKBYTES = DFLT.BLKBYTES(I);

  10215   2 000067  C830 0000 0001  01                   LDR,R4   DFLT+1,R3
          2 00006A  CF44 003C                            STR,R4   60,B4

     1192    10216    2         KZ@LINCTX.PRO.RETRYS = DFLT.RETRYS(I);

  10216   2 00006C  A830 0000 0002  01                   LDR,R2   DFLT+2,R3
          2 00006F  AF44 003D                            STR,R2   61,B4

     1193    10217    2         KZ@LINCTX.PRO.DELAYS = DFLT.DELAYS(I);

  10217   2 000071  9830 0000 0003  01                   LDR,R1   DFLT+3,R3
          2 000074  9F44 003E                            STR,R1   62,B4

     1194    10218              /*  Get an input buffer for the remote signon string.  */
     1195    10219    2         SZ = 64;

  10219   2 000076  6C40                                 LDV,R6   64
          2 000077  EF47 0016                            STR,R6   SZ,AUTO

     1196    10220    2         CALL KVB$GETSYS ( SZ, BUF$ )

  10220   2 000079  BBC7 001D                            LAB,B3   BUF$,AUTO
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:179  
          2 00007B  BFC7 0022                            STB,B3   BUF$+5,AUTO
          2 00007D  ABC7 0016                            LAB,B2   SZ,AUTO
          2 00007F  AFC7 0020                            STB,B2   BUF$+3,AUTO
          2 000081  BBC7 0020                            LAB,B3   BUF$+3,AUTO
          2 000083  CBF0 0200                            LAB,B4   512,IMO
          2 000085  E380 0000 0000  xent                 LNJ,B6   KVB$GETSYS
          2 000088       0003                            DC       s:10222,PREL
          2 000089  0F81 0036                            B        s:10232,PREL

     1197    10221    3         WHENALTRETURN DO;

     1198    10222    3            MEMORY_LOG.V.TERMID = KZ@LINCTX.LINID;

  10222   2 00008B  ACC7 0004                            LDB,B2   @KZ@LINCTX,AUTO
          2 00008D  2C08                                 LDV,R2   8
          2 00008E  6C10                                 LDV,R6   16
          2 00008F  BB80 0000 0000  xsym                 LAB,B3   MEMORY_LOG
          2 000092  3C10                                 LDV,R3   16
          2 000093  0008                                 MMM

     1199    10223    3            MEMORY_LOG.V.VALUES (0) = SZ;

  10223   2 000094  E847 0016                            LDR,R6   SZ,AUTO
          2 000096  EF00 0000 0010  xsym                 STR,R6   MEMORY_LOG+16

     1200    10224    3            CALL KHA$ERRLOG ( MEMORY_LOG ) ALTRET ( IGNORE_MEMORY_LOG_ALTRET );

  10224   2 000099  BB80 0000 0000  03                   LAB,B3   0
          2 00009C  CBF0 0100                            LAB,B4   256,IMO
          2 00009E  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          2 0000A1       0001                            DC       s:10226,PREL

     1201    10225    3   IGNORE_MEMORY_LOG_ALTRET:
     1202    10226    3            KZ@LINCTX.PRO.PROTYP = 0;

  10226   2 0000A2  ECC7 0004            IGNORE_MEMORY_L*LDB,B6   @KZ@LINCTX,AUTO
          2 0000A4  8746 003A                            CL       58,B6
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:180  

     1203    10227    3            KZ$EVENT = '0'B;

  10227   2 0000A6  5C1C                                 LDV,R5   28
          2 0000A7  0021                                 ALR      ;
          2 0000A8       4178 0000                                ALPHANUM('0000'X,IMO,,1),;
          2 0000AA       4007 0008                                ALPHANUM(KZ$EVENT,AUTO,,R5,FILL)

     1204    10228    3            KZ$EVENT.EVENT = %KZ#CLM_EVENT_KILLED;

  10228   2 0000AC  6C07                                 LDV,R6   7
          2 0000AD  437F                                 CSYNC    s:10228,SPREL
          2 0000AE  EF47 0008                            STR,R6   KZ$EVENT,AUTO

     1205    10229    3            CALL KZP$CNCDSC ( KZ$EVENT );

  10229   2 0000B0  DBC7 0008                            LAB,B5   KZ$EVENT,AUTO
          2 0000B2  DFC7 0020                            STB,B5   BUF$+3,AUTO
          2 0000B4  BBC7 0020                            LAB,B3   BUF$+3,AUTO
          2 0000B6  CBF0 0100                            LAB,B4   256,IMO
          2 0000B8  E380 0000 0000  xent                 LNJ,B6   KZP$CNCDSC
          2 0000BB       0001                            DC       s:10230,PREL

     1206    10230    3            ALTRETURN;

  10230   2 0000BC  ECC7 0018                            LDB,B6   SZ+2,AUTO
          2 0000BE  B806                                 LDR,R3   ,B6
          2 0000BF  C3B6                                 LNJ,B4   ,B6,R3

     1207    10231    3            END;
     1208    10232    2         KZ@LINCTX.INPBFR$ = BUF$;

  10232   2 0000C0  ECC7 001D                            LDB,B6   BUF$,AUTO
          2 0000C2  DCC7 0004                            LDB,B5   @KZ@LINCTX,AUTO
          2 0000C4  EFC5 0056                            STB,B6   86,B5

     1209    10233    2         KZ@LINCTX.INPBFRSIZ = 64;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:181  

  10233   2 0000C6  6C40                                 LDV,R6   64
          2 0000C7  EF45 0058                            STR,R6   88,B5

     1210    10234    2         I = PROTYPE*2;

  10234   2 0000C9  CCC7 001A                            LDB,B4   @PROTYPE,AUTO
          2 0000CB  D804                                 LDR,R5   ,B4
          2 0000CC  5001                                 SOL,R5   1
          2 0000CD  DF47 001C                            STR,R5   I,AUTO

     1211    10235    2         KZ@LINCTX.STBL$ = KZ_HDR$(I) -> KZ$HDR.STBL$;

  10235   2 0000CF  B855                                 LDR,R3   R5
          2 0000D0  BCB0 0000 0000  xsym                 LDB,B3   KZ_HDR$,R3
          2 0000D3  ACC3 000D                            LDB,B2   13,B3
          2 0000D5  AFC5 000F                            STB,B2   15,B5

     1212    10236    2         KZ@LINCTX.MAP$ = KZ_HDR$(I) -> KZ$HDR.EMAP$;

  10236   2 0000D7  BCB0 0000 0000  xsym                 LDB,B3   KZ_HDR$,R3
          2 0000DA  9CC3 000B                            LDB,B1   11,B3
          2 0000DC  9FC5 0011                            STB,B1   17,B5

     1213    10237    2         KZ@LINCTX.LINMGR@ = KZ_HDR$(I) -> KZ$HDR.LINHND@;

  10237   2 0000DE  BCB0 0000 0000  xsym                 LDB,B3   KZ_HDR$,R3
          2 0000E1  EC83                                 LDB,B6   ,B3
          2 0000E2  EFC5 0070                            STB,B6   112,B5

     1214    10238    2         KZ@LINCTX.DEVMGR@ = KZ_HDR$(I) -> KZ$HDR.DVCHND@;

  10238   2 0000E4  BCB0 0000 0000  xsym                 LDB,B3   KZ_HDR$,R3
          2 0000E7  ECC3 0002                            LDB,B6   2,B3
          2 0000E9  EFC5 006E                            STB,B6   110,B5

     1215    10239    2         KZ@LINCTX.TIMOUT.PRIMARY = 20;
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:182  

  10239   2 0000EB  4C14                                 LDV,R4   20
          2 0000EC  CF45 0086                            STR,R4   134,B5

     1216    10240    2         KZ@LINCTX.TIMOUT.SECONDARY = 20;

  10240   2 0000EE  CF45 0087                            STR,R4   135,B5

     1217    10241    3         IF KZ@LINCTX.CHN$->KH$CHN.BLOCK = 0 THEN DO;

  10241   2 0000F0  BCC5 0002                            LDB,B3   2,B5
          2 0000F2  A843 0010                            LDR,R2   16,B3
          2 0000F4  2981 000D                            BNEZ,R2  s:10246,PREL

     1218    10242    3            KZ@LINCTX.CHN$->KH$CHN.BLOCK = KZR_THRTL_BLK;

  10242   2 0000F6  A800 0000 0000  xsym                 LDR,R2   KZR_THRTL_BLK
          2 0000F9  AF43 0010                            STR,R2   16,B3

     1219    10243    3            KZ@LINCTX.CHN$->KH$CHN.UNBLOCK = KZR_THRTL_UNBLK;

  10243   2 0000FB  ECC5 0002                            LDB,B6   2,B5
          2 0000FD  9800 0000 0000  xsym                 LDR,R1   KZR_THRTL_UNBLK
          2 000100  9F46 0011                            STR,R1   17,B6

     1220    10244    3            END;

     1221    10245
     1222    10246    2         RETURN;

  10246   2 000102  ECC7 0018                            LDB,B6   SZ+2,AUTO
          2 000104  C3C6 0001                            LNJ,B4   1,B6
     1223    10247
     1224    10248    2   END SETPRM;
     1225    10249
     1226    10250    1   END KZP$INIT;

PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:183  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KZ_MLCP_C.:E05TOU  is referenced.
   KZ_INIT_C.:E05TOU  is referenced.
   KZ_CLM_E.:E05TOU  is referenced.
   KZ_BSCFPT.:E05TOU  is referenced.
   KZ$LINCTX.:E05TOU  is referenced.
   KH$CHN.:E05TOU  is referenced.
      No diagnostics issued in procedure KZP$INIT.
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:184  

 **** Variables and constants ****

  ****  Section 000 RoData KZP$INIT

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w STRC(280)   r     1 KZ_INIT_MAP               23-0-0/w STRC(3024)  r     1 KZ_INIT_STBL

  ****  Section 001  Data  KZP$INIT

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(64)    r     1 DFLT(0:1)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @KZ@BSCFPT                 4-0-0/w PTR         r     1 @KZ@LINCTX
    1A-0-0/w PTR         r     1 @PROTYPE                  1D-0-0/w PTR         r     1 BUF$
    1C-0-0/w SBIN(16)    r     1 I                          8-0-0/w STRC(224)   r     1 KZ$EVENT
    *0-0-0/w STRC(80)    r     1 KZ@BSCFPT                 *0-0-0/w STRC(2192)  r     1 KZ@LINCTX
    *0-0-0/w UBIN(16)    r     1 PROTYPE                   16-0-0/w UBIN(16)    r     1 SZ

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(16)    r     1 KZR_THRTL_BLK              0-0-0/w UBIN(16)    r     1 KZR_THRTL_UNBLK
     0-0-0/w PTR         r     1 KZ_HDR$(0:13)              0-0-0/w STRC(336)   r     1 MEMORY_LOG

  ****  BASED and DCB variables  ****

PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:185  
  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(272)   r     1 KZ$HDR


   Procedure KZP$INIT requires 262 words for executable code.
   Procedure KZP$INIT requires 36 words of local(AUTO) storage.

    No errors detected in file KZP$PSRV.:E05TSI    .
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:186  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:187  
          MINI XREF LISTING

BAD_SETPRM
     10190**LABEL   10178--CALLALT 10183--CALLALT
BUF$ IN PROCEDURE SETPRM
     10200**DCL     10220<>CALL    10232>>ASSIGN
DFLT.BLKBYTES IN PROCEDURE SETPRM
     10204**DCL     10215>>ASSIGN
DFLT.BLKRECS IN PROCEDURE SETPRM
     10203**DCL     10214>>ASSIGN
DFLT.DELAYS IN PROCEDURE SETPRM
     10206**DCL     10217>>ASSIGN
DFLT.RETRYS IN PROCEDURE SETPRM
     10205**DCL     10216>>ASSIGN
I IN PROCEDURE SETPRM
     10199**DCL     10210<<ASSIGN  10212<<ASSIGN  10214>>ASSIGN  10215>>ASSIGN  10216>>ASSIGN  10217>>ASSIGN
     10234<<ASSIGN  10235>>ASSIGN  10236>>ASSIGN  10237>>ASSIGN  10238>>ASSIGN
IGNORE_MEMORY_LOG_ALTRET IN PROCEDURE SETPRM
     10226**LABEL   10224--CALLALT
KH$CHN.BLOCK
     10026**DCL     10241>>IF      10242<<ASSIGN
KH$CHN.TERMID.TERM
     10046**DCL     10055--REDEF
KH$CHN.UNBLOCK
     10026**DCL     10243<<ASSIGN
KHA$ERRLOG
     10158**DCL-ENT 10224--CALL
KVB$GETSYS
     10159**DCL-ENT 10220--CALL
KZ$EVENT
      9553**DCL     10227<<ASSIGN  10229<>CALL
KZ$EVENT.EVENT
      9554**DCL     10228<<ASSIGN
KZ$HDR.DVCHND@
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:188  
      9924**DCL     10238>>ASSIGN
KZ$HDR.EMAP$
      9929**DCL     10236>>ASSIGN
KZ$HDR.LINHND@
      9923**DCL     10237>>ASSIGN
KZ$HDR.STBL$
      9930**DCL     10235>>ASSIGN
KZ@BSCFPT
      9530**DCL        17--PROC
KZ@BSCFPT.ACT
      9531**DCL     10169>>DOCASE
KZ@LINCTX
      9108**DCL        17--PROC    10173<>CALL    10187<>CALL
KZ@LINCTX.BCB.RCV
      9400**DCL     10177<<ASSIGN
KZ@LINCTX.CHN$
      9111**DCL     10241>>IF      10242>>ASSIGN  10243>>ASSIGN
KZ@LINCTX.DEVMGR@
      9471**DCL     10238<<ASSIGN
KZ@LINCTX.FLAGS.SETCLK
      9250**DCL     10182<<ASSIGN
KZ@LINCTX.INPBFR$
      9414**DCL     10232<<ASSIGN
KZ@LINCTX.INPBFRSIZ
      9416**DCL     10233<<ASSIGN
KZ@LINCTX.LINID
      9129**DCL     10222>>ASSIGN
KZ@LINCTX.LINID.TERM
      9131**DCL      9140--REDEF
KZ@LINCTX.LINMGR@
      9473**DCL     10237<<ASSIGN
KZ@LINCTX.MAP$
      9152**DCL     10236<<ASSIGN
KZ@LINCTX.OTPCNT
      9396**DCL      9399--REDEF
KZ@LINCTX.POLSIZ
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:189  
      9442**DCL      9444--REDEF
KZ@LINCTX.PRO.BLKBYTES
      9299**DCL     10215<<ASSIGN
KZ@LINCTX.PRO.BLKRECS
      9295**DCL     10214<<ASSIGN
KZ@LINCTX.PRO.DELAYS
      9307**DCL     10217<<ASSIGN
KZ@LINCTX.PRO.PROTYP
      9292**DCL     10213<<ASSIGN  10226<<ASSIGN
KZ@LINCTX.PRO.RETRYS
      9303**DCL     10216<<ASSIGN
KZ@LINCTX.STBL$
      9150**DCL     10235<<ASSIGN
KZ@LINCTX.TIMOUT.PRIMARY
      9508**DCL     10239<<ASSIGN
KZ@LINCTX.TIMOUT.SECONDARY
      9512**DCL     10240<<ASSIGN
KZO$ABORT
     10160**DCL-ENT 10173--CALL
KZO$ORDERS
     10161**DCL-ENT 10187--CALL
KZP$CNCDSC
     10162**DCL-ENT 10229--CALL
KZP$INIT
        17**PROC     9638--DCLINIT
KZR_THRTL_BLK
     10165**DCL     10242>>ASSIGN
KZR_THRTL_UNBLK
     10166**DCL     10243>>ASSIGN
KZ_HDR$
     10164**DCL     10235>>ASSIGN  10236>>ASSIGN  10237>>ASSIGN  10238>>ASSIGN
KZ_INIT_MAP
      9663**DCL      9644--DCLINIT
KZ_INIT_STBL
      9713**DCL      9645--DCLINIT
KZ_INIT_STBL.PL6ISDUMB
PL6.E3A0      #003=KZP$INIT File=KZP$PSRV.:E05TSI                                WED 07/30/97 03:01 Page:190  
      9717**DCL      9904--REDEF
MEMORY_LOG
     10074**DCL     10224<>CALL
MEMORY_LOG.V.TERMID
     10141**DCL     10222<<ASSIGN
MEMORY_LOG.V.TERMID.TERM
     10143**DCL     10152--REDEF
MEMORY_LOG.V.VALUES
     10154**DCL     10223<<ASSIGN
PROTYPE IN PROCEDURE SETPRM
     10196**DCL     10194--PROC    10209>>IF      10213>>ASSIGN  10234>>ASSIGN
SETPRM
     10194**PROC    10178--CALL    10183--CALL
SZ
     10167**DCL     10219<<ASSIGN  10220<>CALL    10223>>ASSIGN
