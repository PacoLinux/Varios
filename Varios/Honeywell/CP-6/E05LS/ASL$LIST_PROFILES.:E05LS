VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:1    
        1        1        /*M* ASL$LIST_ALL_PROFILES:  ROUTINE TO HANDLE LIST/DISP PROFILES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_PROFILES: PROC ;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_PROFILES
       13       13             CALL:     CALL ASL$LIST_ALL_PROFILES
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_PROFILES is a subroutine to handle
       17       17                           the LIST PROFILE command for SUPER.
       18       18                           Profile records are stored in the :PRO.:SYS
       19       19                           file and have keys that look like the following:
       20       20                           'xxxxxxxxxxx' and 'xxxxxxxxxxx:graphics' where
       21       21                           where the x represents a character from the
       22       22                           alphanumeric character set plus the special
       23       23                           characters ':$_-' and is of length 11 or less.
       24       24                           If the actual profile name is less than 11
       25       25                           characters, the key will be blank padded to
       26       26                           11 characters.  The ':graphics' record associated
       27       27                           with certain profiles defines the graphics
       28       28                           characteristics of said profile.  There is a
       29       29                           ':graphics' record for each profile that has a
       30       30                           GR_FPRG other than blank in it.
       31       31                           The profiles key characters that are alphabetic
       32       32                           MUST be uppercase, even though the name input
       33       33                           can be lowercase, so all input names must be
       34       34                           converted from lowercase to uppercase.
       35       35                           This routine will either read a single profile
       36       36                           record or it will cycle through all of the profile
       37       37                           records looking for matches
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:2    
       38       38                           to the selection criteria as input in the
       39       39                           LIST/DISPLAY command.  If a match is found
       40       40                           this routine will do either
       41       41                           of two things.  It will call the display routine
       42       42                           if the command was a DISPLAY command, or it will
       43       43                           put the vector framing the profile name into the
       44       44                           formatter vector list.
       45       45
       46       46                  MEMORY REQUIREMENTS:
       47       47                           For all of the routines that deal with listing/
       48       48                           displaying profiles:
       49       49
       50       50                            ASL$LIST_ALL_PROFILES
       51       51                            ASL$DISP_ONE_PROFILE
       52       52
       53       53                            The profile record will be read into
       54       54                            data segment 1.  The converted name will be used
       55       55                            by the ASL$LIST_ALL_PROFILES, while the other info
       56       56                            will be used by the ASL$DISP_ONE_PROFILE routine.
       57       57        */
       58       58        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:3    
       59       59        /********************************************************************/
       60       60        /*   Include files   include files   include files   include files  */
       61       61        /********************************************************************/
       62       62        %INCLUDE AS_PERR_C;
       63      664        %INCLUDE AS_SUPER_C;
       64     1099        %INCLUDE AS_SUBS_C;
       65     2513        %INCLUDE AS_MAC_C;
       66     2593        %INCLUDE AS_ENTRIES_M;
       67     3643        %INCLUDE AS_SSUBS_C;
       68     3735        %INCLUDE B_ERRORS_C;
       69     4862        %INCLUDE CP_6_SUBS;
       70     5402        %INCLUDE B$TABLES_C;
       71     5510           %B$XL_UPPER_UR;
       72     5514        %INCLUDE KL_SUPER_C;
       73     8416        %INCLUDE XU_MACRO_C;
       74    11522        %INCLUDE XU_FORMAT_C;
       75    11684        %INCLUDE OCI_SUBS_C;
       76    11782        %INCLUDE AS_SUPER_R;
       77    14798        /********************************************************************/
       78    14799        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       79    14800        /********************************************************************/
       80    14801        %ASB$WRITE_LO ;
       81    14804        %ASD$READ_PRO_SEQ ;
       82    14807        %ASD$READ_PRO ;
       83    14810        %ASD$PREC_PRO ;
       84    14813        %ASH$ERROR ;
       85    14816        %ASH$WARN ;
       86    14819        %ASL$LIST_PRO_OPTS ;
       87    14822        %ASL$DISP_ONE_PROFILE ;
       88    14825        %ASB$WILD_MATCH ;
       89    14828    1   DCL X$FORMAT ENTRY(1);
       90    14829        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:4    
       91    14830        /********************************************************************/
       92    14831        /*   Local based     local based     local based     local based    */
       93    14832        /********************************************************************/
       94    14833        %KL_PHDR ( NAME = PRO$HDR  ,
       95    14834                          STCLASS = BASED ) ;
       96    14875        %PARSE$OUT( NAME=P$B, STCLASS="BASED(NODE$)",
       97    14876                    NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       98    14921        %PARSE$SYM(NAME = P$S,STCLASS = BASED);
       99    14959        /********************************************************************/
      100    14960        /*   Auto data       auto data       auto data       auto data      */
      101    14961        /********************************************************************/
      102    14962    1   DCL 1 XPNAME ALIGNED,
      103    14963    1          2 CNT UBIN (9) UNAL,
      104    14964    1          2 TXT CHAR (11) UNAL;
      105    14965    1   DCL I UBIN;
      106    14966    1   DCL J UBIN;
      107    14967    1   DCL TYPE_SPECIFIED BIT(1);
      108    14968    1   DCL LAST_TYPE     SBIN;
      109    14969    1   DCL GOT_OPTS BIT(1) ;
      110    14970    1   DCL ARS UBIN WORD ;
      111    14971    1   DCL WILD_CARD     BIT(1);
      112    14972    1   DCL ALL_PROFILES  BIT(1);
      113    14973    1   DCL DISP    BIT(1);
      114    14974    1   DCL JCL    BIT(1);
      115    14975    1   DCL DISP_PROFILES   SBIN;
      116    14976    1   DCL 1 BEGIN_KEY ,
      117    14977    1          2 COUNT UBIN BYTE,
      118    14978    1          2 TEXT CHAR(11);
      119    14979    1   DCL 1 END_KEY ,
      120    14980    1          2 COUNT UBIN BYTE,
      121    14981    1          2 TEXT CHAR(11);
      122    14982    1   DCL CURRENT_PROFILE CHAR(11);
      123    14983    1   DCL CODE2  UBIN;
      124    14984
      125    14985    1   DCL 1 PROFILE_NAME,
      126    14986    1          2 COUNT UBIN BYTE UNAL,
      127    14987    1          2 TEXT CHAR(11) UNAL;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:5    
      128    14988    1   DCL TYPE_CODE UBIN;
      129    14989        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:6    
      130    14990        /********************************************************************/
      131    14991        /*   Constant data   constant data   constant data   constant data  */
      132    14992        /********************************************************************/
      133    14993    1   DCL 1 TYPE_STR (0:12) CONSTANT,
      134    14994    1          2 COUNT UBIN BYTE INIT (0,4,5,3,4,0,3,0,6,0,4,0,7),
      135    14995    1          2 TEXT  CHAR(0)  INIT (
      136    14996    1                                  ' ',
      137    14997    1                                  'RBTD',
      138    14998    1                                  'ASYNC',
      139    14999    1                                  'RBT',
      140    15000    1                                  'LINK',
      141    15001    1                                  ' ',
      142    15002    1                                  'URP',
      143    15003    1                                  ' ',
      144    15004    1                                  'VIRCIR',
      145    15005    1                                  ' ',
      146    15006    1                                  '3270',
      147    15007    1                                  ' ',
      148    15008    1                                  'POLLVIP');
      149    15009    1   DCL PROFILE_STR CHAR(0) CONSTANT INIT ('profile');
      150    15010    1   DCL PROFILES_STR CHAR(0) CONSTANT INIT ('profiles');
      151    15011    1   DCL LIST_STR CHAR(0) CONSTANT INIT ('listed');
      152    15012    1   DCL DISPLAY_STR CHAR(0) CONSTANT INIT ('displayed');
      153    15013    1   DCL PRO_FLAGS(0:L_PRO_END) BIT(1) SYMREF;
      154    15014        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:7    
      155    15015        /********************************************************************/
      156    15016        /*   Procedure       procedure       procedure       procedure      */
      157    15017        /********************************************************************/
      158    15018    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      159    15019    1   JCL = %NO#;
      160    15020    1   WILD_CARD = %NO#;
      161    15021    1   PROFILE_NAME.TEXT = '?';
      162    15022    1   PROFILE_NAME.COUNT = 1;
      163    15023    1   DISP_PROFILES = 0;
      164    15024    1   TYPE_SPECIFIED = %NO#;
      165    15025    1   GOT_OPTS = %NO# ;
      166    15026    1   LIST_ACCT_FLG = %NO#;
      167    15027    1   LAST_TYPE = -1;
      168    15028
      169    15029    2   DO SELECT (CODE);
      170    15030
      171    15031    2      SELECT (%LIST_ALL_VAL);
      172    15032
      173    15033    2      DISP = %NO#;
      174    15034    2      JCL = %NO#;
      175    15035
      176    15036    2      SELECT (%DISPLAY_ALL_VAL);
      177    15037
      178    15038    2      DISP = %YES#;
      179    15039    2      GOT_OPTS = %NO# ;
      180    15040    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
      181    15041    2         JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      182    15042    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      183    15043    2            JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      184    15044
      185    15045    2      SELECT (%LIST_PROFILE_VAL,
      186    15046    2           %DISPLAY_PROFILE_VAL);
      187    15047
      188    15048    2      DISP = (CODE = %DISPLAY_PROFILE_VAL);
      189    15049
      190    15050    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      191    15051    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:8    
      192    15052
      193    15053    4         DO SELECT (CODE2);
      194    15054
      195    15055    4            SELECT (%PROFILE_NAME_WILD_VAL);
      196    15056
      197    15057    4            PROFILE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      198    15058    4            PROFILE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      199    15059
      200    15060    4            SELECT (%PROFILE_NAME_VAL);
      201    15061
      202    15062    4            PROFILE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      203    15063    4            PROFILE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      204    15064
      205    15065    4            SELECT (%PRO_TYPE_VAL);
      206    15066
      207    15067    4            TYPE_CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$B.CODE;
      208    15068    4            TYPE_SPECIFIED = %YES#;
      209    15069
      210    15070    4            SELECT (%JCL_VAL);
      211    15071
      212    15072    4            JCL = %YES#;
      213    15073
      214    15074    4            END;  /* Do case (CODE2) */
      215    15075
      216    15076    3         END;  /*  Do i  */
      217    15077
      218    15078    2      END;  /*  Do case (code)  */
      219    15079
      220    15080    1   XPNAME = PROFILE_NAME;
      221    15081    1   CALL XLATE (XPNAME.TXT, B$XL_UPPER_UR,
      222    15082    1        SUBSTR (PROFILE_NAME.TEXT, 0, PROFILE_NAME.COUNT) );
      223    15083    1   IF (SUBSTR (XPNAME.TXT, 0, XPNAME.CNT) =
      224    15084    1        SUBSTR (PROFILE_NAME.TEXT, 0, PROFILE_NAME.COUNT) )
      225    15085    2   THEN DO;
      226    15086    2      END; /* It's already been done.*/
      227    15087    2   ELSE DO; /* Redo it with uppercase only and warn of it...*/
      228    15088    2      PROFILE_NAME = XPNAME;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:9    
      229    15089           %SCREAM (ERR#=E$PNAMEXLATED, LEVEL=WARN, MID='D');
      230    15104    2      END;
      231    15105
      232    15106    1   IF PROFILE_NAME.TEXT = '?' THEN
      233    15107    1      ALL_PROFILES = %YES#;
      234    15108    2   ELSE DO;
      235    15109    2      ALL_PROFILES = %NO#;
      236    15110    2      BEGIN_KEY.TEXT = ' ';
      237    15111    2      END_KEY.TEXT = ' ';
      238    15112    3      CALL INDEX (I,'?',PROFILE_NAME.TEXT) WHENRETURN DO;
      239    15113    3         BEGIN_KEY.TEXT = SUBSTR(PROFILE_NAME.TEXT,0,I);
      240    15114    3         BEGIN_KEY.COUNT = 11;
      241    15115    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(PROFILE_NAME.TEXT,0,I),'~');
      242    15116    3         END_KEY.COUNT = I + 1;
      243    15117    3         WILD_CARD = %YES#;
      244    15118    3         END; /*  Whenreturn from index  */
      245    15119    3      WHENALTRETURN DO;
      246    15120    3         WILD_CARD = %NO#;
      247    15121    3         END; /* Whenaltreturn  */
      248    15122    2      END; /*  Else  */
      249    15123
      250    15124    1   FDS.NVECS# = 0;
      251    15125    2   IF JCL THEN DO;
      252    15126    2      CALL CONCAT (FMT_BUF, '%1/"', PROFILES_STR, '%1/');
      253    15127    2      FDS.FMT_.BOUND = LENGTHC (PROFILES_STR) + 6;
      254    15128    2      END;   /*  Jcl  */
      255    15129    2   ELSE DO;
      256    15130    2      CALL CONCAT (FMT_BUF, '%1/', PROFILES_STR, '%1/');
      257    15131    2      FDS.FMT_.BOUND = LENGTHC (PROFILES_STR) + 5;
      258    15132    2      END;   /*  Not jcl  */
      259    15133    1   FDS.TABDFLT# = 10;
      260    15134    1   CALL X$FORMAT (FDS);
      261    15135
      262    15136    2   IF ALL_PROFILES THEN DO;
      263    15137    2      USERS_KEY = '001000'O ;      /* Position to bof of :PRO            */
      264    15138    2      END;  /*  ALL_PROFILES  */
      265    15139    2   ELSE IF WILD_CARD THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:10   
      266    15140    2         USERS_KEY = BEGIN_KEY;
      267    15141    2         END; /*  WILD_CARD  */
      268    15142    2      ELSE DO;  /*  Single profile  */
      269    15143    2         USERS_KEY = PROFILE_NAME;
      270    15144    2         ARS = DSEG1SIZE ;
      271    15145    2         CALL ASD$READ_PRO ( USERS_KEY,DSEG1$->PRO$HDR,ARS )
      272    15146    3         WHENRETURN DO;
      273    15147    3            IF TYPE_SPECIFIED THEN
      274    15148    4               IF TYPE_CODE ~= DSEG1$->PRO$HDR.TTYP THEN DO;
      275    15149        /*E* ERROR:   ASL-E$NOTPROTYPE-C
      276    15150             MESSAGE: Type does not match.
      277    15151             MESSAGE1: You asked for %U1 and this profile has %U2.
      278    15152        */
      279    15153    4                  AS_FIELD2.TEXT = TYPE_STR.TEXT (DSEG1$->PRO$HDR.TTYP);
      280    15154    4                  AS_FIELD2.COUNT = TYPE_STR.COUNT (DSEG1$->PRO$HDR.TTYP);
      281    15155    4                  AS_FIELD1.TEXT = TYPE_STR.TEXT (TYPE_CODE);
      282    15156    4                  AS_FIELD1.COUNT = TYPE_STR.COUNT (TYPE_CODE);
      283    15157                       %SCREAM( ERR#=%E$NOTPROTYPE, MID='L', LEVEL=ERROR );
      284    15172    4                  RETURN;
      285    15173    4                  END; /*  TYPE_CODE ~=  */
      286    15174    3            IF DISP THEN
      287    15175    4            DO;
      288    15176    4               CALL ASL$LIST_PRO_OPTS (ARS,JCL);
      289    15177    4               CALL ASB$WRITE_LO (' ',1);
      290    15178    4               CALL ASL$DISP_ONE_PROFILE (ARS,JCL);
      291    15179    5               IF FDS.NVECS# > 0 THEN DO;
      292    15180    5                  CALL X$FORMAT (FDS);
      293    15181    5                  FDS.NVECS# = 0;
      294    15182    5                  CALL ASB$WRITE_LO (' ',1);
      295    15183    5                  END;   /*  Nvecs > 0  */
      296    15184    4               END; /*  If disp  */
      297    15185    4            ELSE DO;
      298    15186    4               CALL CONCAT (FMT_BUF, SUBSTR(PROFILE_NAME.TEXT,0,PROFILE_NAME.COUNT),
             15186                        '%1/');
      299    15187    4               FDS.FMT_.BOUND = PROFILE_NAME.COUNT + 2;
      300    15188    4               CALL X$FORMAT (FDS);
      301    15189    4               END; /*  Else  disp  */
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:11   
      302    15190    3            END;  /*  Whenreturn  */
      303    15191    3         WHENALTRETURN DO;
      304    15192    3            IF MERR_CODE.CODE = %E$NOKEY
      305    15193    4            THEN DO;
      306    15194        /*E* ERROR:   AS-E$PROFILE_NO_EXIST-C
      307    15195             MESSAGE: Profile %U1 does not exist.
      308    15196             MESSAGE1: The specified PROFILE does not exist.
      309    15197        */
      310    15198    4               AS_FIELD1 = PROFILE_NAME;
      311    15199                    %SCREAM( ERR#=%E$PROFILE_NO_EXIST, MID='L', LEVEL=ERROR );
      312    15214    4               END;  /*  Error = nokey  */
      313    15215    4            ELSE DO;
      314    15216    4               CALL ASH$ERROR(MERR_CODE) ;
      315    15217    4               END;  /* Error ~= nokey */
      316    15218    3            END;  /*  Whenaltreturn  */
      317    15219    2         RETURN;
      318    15220    2         END; /*  Else  */
      319    15221
      320    15222
      321    15223    1   CALL ASD$PREC_PRO(USERS_KEY) ;
      322    15224
      323    15225    2   DO FOREVER;
      324    15226
      325    15227    2   READ_PRO: ;
      326    15228    2      ARS = DSEG1SIZE ;
      327    15229    2      CALL ASD$READ_PRO_SEQ( USERS_KEY,DSEG1$->PRO$HDR,ARS )
      328    15230    3      WHENALTRETURN DO;
      329    15231    3         IF MERR_CODE.CODE = %E$EOF THEN
      330    15232    3            GOTO FINISH_UP;
      331    15233    3         MERR_CODE.SEV = 0 ;
      332    15234    3         CALL ASH$ERROR(MERR_CODE) ;
      333    15235    3         RETURN ;
      334    15236    3         END ;                     /*  Whenaltreturn  */
      335    15237                                                /* Got one.                           */
      336    15238    2      IF TYPE_SPECIFIED THEN
      337    15239    2         IF TYPE_CODE ~= DSEG1$ -> PRO$HDR.TTYP THEN
      338    15240    2            GOTO READ_PRO ;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:12   
      339    15241    2      I = USERS_KEY.COUNT ;
      340    15242    2      CURRENT_PROFILE = SUBSTR(USERS_KEY.TXTC,0,I);
      341    15243    3      IF WILD_CARD THEN DO;
      342    15244    3         J = PROFILE_NAME.COUNT;
      343    15245    3         CALL ASB$WILD_MATCH (I, CURRENT_PROFILE, J, PROFILE_NAME.TEXT)
      344    15246    4         WHENALTRETURN DO;
      345    15247    4            IF CURRENT_PROFILE > END_KEY.TEXT THEN
      346    15248    4               GOTO FINISH_UP;
      347    15249    4            ELSE
      348    15250    4               GOTO READ_PRO;
      349    15251    4            END;  /*  Whenaltreturn  */
      350    15252    3         END; /*  WILD_CARD  */
      351    15253    2      IF DISP THEN
      352    15254    3      DO;
      353    15255    3         IF ((NOT TYPE_SPECIFIED) AND (LAST_TYPE ~= DSEG1$->PRO$HDR.TTYP))
      354    15256    4         THEN DO ;               /*  Set all options  */
      355    15257    4            CALL ASL$LIST_PRO_OPTS (ARS,%YES#) ;
      356    15258    4            LAST_TYPE = DSEG1$->PRO$HDR.TTYP;
      357    15259    4            END ;                    /* Not TYPE_SPECIFIED */
      358    15260    3         ELSE IF (TYPE_SPECIFIED AND (NOT GOT_OPTS))
      359    15261    4            THEN DO ;            /*  Get options  */
      360    15262    4               CALL ASL$LIST_PRO_OPTS (ARS,JCL) ;
      361    15263    4               GOT_OPTS = '1'B ;
      362    15264    4               END ;                 /* TYPE_SPECIFIED and GOT_OPTS*/
      363    15265    3         IF PRO_FLAGS ~= '0'B THEN
      364    15266    3            CALL ASB$WRITE_LO (' ',1);
      365    15267    3         CALL ASL$DISP_ONE_PROFILE (ARS,JCL);
      366    15268    3         END; /*  If disp  */
      367    15269    3      ELSE DO;
      368    15270    4         IF DISP_PROFILES = 0 THEN DO;
      369    15271    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_PROFILE,0,I));
      370    15272    4            FDS.FMT_.BOUND = I+1 ;
      371    15273    4            END; /*  DISP_PROFILES = 0  */
      372    15274    4         ELSE DO;
      373    15275    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_PROFILE,0,I));
      374    15276    4            FDS.FMT_.BOUND = I + 7;
      375    15277    4            END; /*  Else  */
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:13   
      376    15278    3         CALL X$FORMAT (FDS);
      377    15279    3         END; /*  Else  disp  */
      378    15280    2      DISP_PROFILES = DISP_PROFILES + 1;
      379    15281    2      END;  /*  Do forever  */
      380    15282    1   FINISH_UP:
      381    15283    2   IF NOT DISP THEN DO;
      382    15284    2      FMT_BUF = '%\%/';
      383    15285    2      FDS.FMT_.BOUND = 3;
      384    15286    2      FDS.NVECS# = 0;
      385    15287    2      CALL X$FORMAT(FDS);
      386    15288    2      END; /*  If not disp  */
      387    15289    2   ELSE DO;
      388    15290    3      IF FDS.NVECS# > 0 THEN DO;
      389    15291    3         CALL X$FORMAT (FDS);
      390    15292    3         FDS.NVECS# = 0;
      391    15293    3         CALL ASB$WRITE_LO (' ',1);
      392    15294    3         END;   /*  Nvecs > 0  */
      393    15295    2      END;  /*  Else  */
      394    15296    2   IF NOT JCL THEN DO;
      395    15297    2      FMT_VEC(0) = VECTOR (DISP_PROFILES);
      396    15298    2      IF DISP_PROFILES = 1 THEN
      397    15299    3      DO;
      398    15300    3         FMT_VEC(1) = VECTOR (PROFILE_STR);
      399    15301    3         END; /*  DISP_PROFILES = 1  */
      400    15302    3      ELSE DO;
      401    15303    3         FMT_VEC(1) = VECTOR (PROFILES_STR);
      402    15304    3         END; /*  DISP_PROFILES ~= 1  */
      403    15305    2      IF DISP THEN
      404    15306    3      DO;
      405    15307    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      406    15308    3         END; /*  If disp  */
      407    15309    3      ELSE DO;
      408    15310    3         FMT_VEC(2) = VECTOR (LIST_STR);
      409    15311    3         END; /*  If ~ disp  */
      410    15312    2      FDS.NVECS# = 3;
      411    15313    2      FMT_BUF = '   %5D %A %A.';
      412    15314    2      FDS.FMT_.BOUND = 12;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:14   
      413    15315    2      CALL X$FORMAT(FDS);
      414    15316    2      END; /* Not jcl */
      415    15317    1   RETURN;
      416    15318    1   END ASL$LIST_ALL_PROFILES;

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:15   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_PROFILES.

   Procedure ASL$LIST_ALL_PROFILES requires 605 words for executable code.
   Procedure ASL$LIST_ALL_PROFILES requires 40 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_PROFILES.:E05TSI    .

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:16   

 Object Unit name= ASL$LIST_ALL_PROFILES                      File name= ASL$LIST_PROFILES.:E05TOU
 UTS= JUL 29 '97 10:17:50.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     60     74  ASL$LIST_ALL_PROFILES
    2   Proc  even  none   605   1135  ASL$LIST_ALL_PROFILES
    3  RoData even  none    24     30  ASL$LIST_ALL_PROFILES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_PROFILES
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:17   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
 yes     yes           Std       1 ASD$PREC_PRO
 yes     yes           Std       3 ASD$READ_PRO_SEQ
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
         yes           Std       2 ASH$WARN
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASD$READ_PRO
         yes           Std       2 ASH$ERROR
         yes           Std       2 ASL$DISP_ONE_PROFILE
 yes     yes           Std       4 ASB$WILD_MATCH
         yes           Std       2 ASL$LIST_PRO_OPTS
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    B$XL_UPPER_UR$                   r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             FDS
     FMT_BUF                               FMT_VEC                               NODE$
     CODE                                  LIST_ACCT_FLG                         ERR_CODE
     AS_FIELD1                             AS_FIELD2                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 PRO_FLAGS
     B_VECTNIL
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:18   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:19   


        1        1        /*M* ASL$LIST_ALL_PROFILES:  ROUTINE TO HANDLE LIST/DISP PROFILES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_PROFILES: PROC ;

      9  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000050 000000                    ZERO    40,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_PROFILES
       13       13             CALL:     CALL ASL$LIST_ALL_PROFILES
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_PROFILES is a subroutine to handle
       17       17                           the LIST PROFILE command for SUPER.
       18       18                           Profile records are stored in the :PRO.:SYS
       19       19                           file and have keys that look like the following:
       20       20                           'xxxxxxxxxxx' and 'xxxxxxxxxxx:graphics' where
       21       21                           where the x represents a character from the
       22       22                           alphanumeric character set plus the special
       23       23                           characters ':$_-' and is of length 11 or less.
       24       24                           If the actual profile name is less than 11
       25       25                           characters, the key will be blank padded to
       26       26                           11 characters.  The ':graphics' record associated
       27       27                           with certain profiles defines the graphics
       28       28                           characteristics of said profile.  There is a
       29       29                           ':graphics' record for each profile that has a
       30       30                           GR_FPRG other than blank in it.
       31       31                           The profiles key characters that are alphabetic
       32       32                           MUST be uppercase, even though the name input
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:20   
       33       33                           can be lowercase, so all input names must be
       34       34                           converted from lowercase to uppercase.
       35       35                           This routine will either read a single profile
       36       36                           record or it will cycle through all of the profile
       37       37                           records looking for matches
       38       38                           to the selection criteria as input in the
       39       39                           LIST/DISPLAY command.  If a match is found
       40       40                           this routine will do either
       41       41                           of two things.  It will call the display routine
       42       42                           if the command was a DISPLAY command, or it will
       43       43                           put the vector framing the profile name into the
       44       44                           formatter vector list.
       45       45
       46       46                  MEMORY REQUIREMENTS:
       47       47                           For all of the routines that deal with listing/
       48       48                           displaying profiles:
       49       49
       50       50                            ASL$LIST_ALL_PROFILES
       51       51                            ASL$DISP_ONE_PROFILE
       52       52
       53       53                            The profile record will be read into
       54       54                            data segment 1.  The converted name will be used
       55       55                            by the ASL$LIST_ALL_PROFILES, while the other info
       56       56                            will be used by the ASL$DISP_ONE_PROFILE routine.
       57       57        */
       58       58        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:21   
       59       59        /********************************************************************/
       60       60        /*   Include files   include files   include files   include files  */
       61       61        /********************************************************************/
       62       62        %INCLUDE AS_PERR_C;
       63      664        %INCLUDE AS_SUPER_C;
       64     1099        %INCLUDE AS_SUBS_C;
       65     2513        %INCLUDE AS_MAC_C;
       66     2593        %INCLUDE AS_ENTRIES_M;
       67     3643        %INCLUDE AS_SSUBS_C;
       68     3735        %INCLUDE B_ERRORS_C;
       69     4862        %INCLUDE CP_6_SUBS;
       70     5402        %INCLUDE B$TABLES_C;
       71     5510           %B$XL_UPPER_UR;
       72     5514        %INCLUDE KL_SUPER_C;
       73     8416        %INCLUDE XU_MACRO_C;
       74    11522        %INCLUDE XU_FORMAT_C;
       75    11684        %INCLUDE OCI_SUBS_C;
       76    11782        %INCLUDE AS_SUPER_R;
       77    14798        /********************************************************************/
       78    14799        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       79    14800        /********************************************************************/
       80    14801        %ASB$WRITE_LO ;
       81    14804        %ASD$READ_PRO_SEQ ;
       82    14807        %ASD$READ_PRO ;
       83    14810        %ASD$PREC_PRO ;
       84    14813        %ASH$ERROR ;
       85    14816        %ASH$WARN ;
       86    14819        %ASL$LIST_PRO_OPTS ;
       87    14822        %ASL$DISP_ONE_PROFILE ;
       88    14825        %ASB$WILD_MATCH ;
       89    14828    1   DCL X$FORMAT ENTRY(1);
       90    14829        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:22   
       91    14830        /********************************************************************/
       92    14831        /*   Local based     local based     local based     local based    */
       93    14832        /********************************************************************/
       94    14833        %KL_PHDR ( NAME = PRO$HDR  ,
       95    14834                          STCLASS = BASED ) ;
       96    14875        %PARSE$OUT( NAME=P$B, STCLASS="BASED(NODE$)",
       97    14876                    NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       98    14921        %PARSE$SYM(NAME = P$S,STCLASS = BASED);
       99    14959        /********************************************************************/
      100    14960        /*   Auto data       auto data       auto data       auto data      */
      101    14961        /********************************************************************/
      102    14962    1   DCL 1 XPNAME ALIGNED,
      103    14963    1          2 CNT UBIN (9) UNAL,
      104    14964    1          2 TXT CHAR (11) UNAL;
      105    14965    1   DCL I UBIN;
      106    14966    1   DCL J UBIN;
      107    14967    1   DCL TYPE_SPECIFIED BIT(1);
      108    14968    1   DCL LAST_TYPE     SBIN;
      109    14969    1   DCL GOT_OPTS BIT(1) ;
      110    14970    1   DCL ARS UBIN WORD ;
      111    14971    1   DCL WILD_CARD     BIT(1);
      112    14972    1   DCL ALL_PROFILES  BIT(1);
      113    14973    1   DCL DISP    BIT(1);
      114    14974    1   DCL JCL    BIT(1);
      115    14975    1   DCL DISP_PROFILES   SBIN;
      116    14976    1   DCL 1 BEGIN_KEY ,
      117    14977    1          2 COUNT UBIN BYTE,
      118    14978    1          2 TEXT CHAR(11);
      119    14979    1   DCL 1 END_KEY ,
      120    14980    1          2 COUNT UBIN BYTE,
      121    14981    1          2 TEXT CHAR(11);
      122    14982    1   DCL CURRENT_PROFILE CHAR(11);
      123    14983    1   DCL CODE2  UBIN;
      124    14984
      125    14985    1   DCL 1 PROFILE_NAME,
      126    14986    1          2 COUNT UBIN BYTE UNAL,
      127    14987    1          2 TEXT CHAR(11) UNAL;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:23   
      128    14988    1   DCL TYPE_CODE UBIN;
      129    14989        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:24   
      130    14990        /********************************************************************/
      131    14991        /*   Constant data   constant data   constant data   constant data  */
      132    14992        /********************************************************************/
      133    14993    1   DCL 1 TYPE_STR (0:12) CONSTANT,
      134    14994    1          2 COUNT UBIN BYTE INIT (0,4,5,3,4,0,3,0,6,0,4,0,7),
      135    14995    1          2 TEXT  CHAR(0)  INIT (
      136    14996    1                                  ' ',
      137    14997    1                                  'RBTD',
      138    14998    1                                  'ASYNC',
      139    14999    1                                  'RBT',
      140    15000    1                                  'LINK',
      141    15001    1                                  ' ',
      142    15002    1                                  'URP',
      143    15003    1                                  ' ',
      144    15004    1                                  'VIRCIR',
      145    15005    1                                  ' ',
      146    15006    1                                  '3270',
      147    15007    1                                  ' ',
      148    15008    1                                  'POLLVIP');
      149    15009    1   DCL PROFILE_STR CHAR(0) CONSTANT INIT ('profile');
      150    15010    1   DCL PROFILES_STR CHAR(0) CONSTANT INIT ('profiles');
      151    15011    1   DCL LIST_STR CHAR(0) CONSTANT INIT ('listed');
      152    15012    1   DCL DISPLAY_STR CHAR(0) CONSTANT INIT ('displayed');
      153    15013    1   DCL PRO_FLAGS(0:L_PRO_END) BIT(1) SYMREF;
      154    15014        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:25   
      155    15015        /********************************************************************/
      156    15016        /*   Procedure       procedure       procedure       procedure      */
      157    15017        /********************************************************************/
      158    15018    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15018  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      159    15019    1   JCL = %NO#;

  15019  2 000007   200017 450100                    STZ     JCL,,AUTO

      160    15020    1   WILD_CARD = %NO#;

  15020  2 000010   200014 450100                    STZ     WILD_CARD,,AUTO

      161    15021    1   PROFILE_NAME.TEXT = '?';

  15021  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200035 200013                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=11

      162    15022    1   PROFILE_NAME.COUNT = 1;

  15022  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200035 552140                    STBQ    PROFILE_NAME,'40'O,AUTO

      163    15023    1   DISP_PROFILES = 0;

  15023  2 000016   200020 450100                    STZ     DISP_PROFILES,,AUTO

      164    15024    1   TYPE_SPECIFIED = %NO#;

  15024  2 000017   200010 450100                    STZ     TYPE_SPECIFIED,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:26   

      165    15025    1   GOT_OPTS = %NO# ;

  15025  2 000020   200012 450100                    STZ     GOT_OPTS,,AUTO

      166    15026    1   LIST_ACCT_FLG = %NO#;

  15026  2 000021   000000 450000 xsym               STZ     LIST_ACCT_FLG

      167    15027    1   LAST_TYPE = -1;

  15027  2 000022   000001 335007                    LCA     1,DL
         2 000023   200011 755100                    STA     LAST_TYPE,,AUTO

      168    15028
      169    15029    2   DO SELECT (CODE);

  15029  2 000024   000000 236000 xsym               LDQ     CODE
         2 000025   000022 116007                    CMPQ    18,DL
         2 000026   000037 602000 2                  TNC     s:15029+11
         2 000027   000042 600000 2                  TZE     s:15033
         2 000030   000144 116007                    CMPQ    100,DL
         2 000031   000034 602000 2                  TNC     s:15029+8
         2 000032   000045 600000 2                  TZE     s:15038
         2 000033   000201 710000 2                  TRA     s:15080
         2 000034   000132 116007                    CMPQ    90,DL
         2 000035   000201 601000 2                  TNZ     s:15080
         2 000036   000100 710000 2                  TRA     s:15048
         2 000037   000006 116007                    CMPQ    6,DL
         2 000040   000201 601000 2                  TNZ     s:15080
         2 000041   000100 710000 2                  TRA     s:15048

      170    15030
      171    15031    2      SELECT (%LIST_ALL_VAL);

      172    15032
      173    15033    2      DISP = %NO#;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:27   

  15033  2 000042   200016 450100                    STZ     DISP,,AUTO

      174    15034    2      JCL = %NO#;

  15034  2 000043   200017 450100                    STZ     JCL,,AUTO
         2 000044   000201 710000 2                  TRA     s:15080

      175    15035
      176    15036    2      SELECT (%DISPLAY_ALL_VAL);

      177    15037
      178    15038    2      DISP = %YES#;

  15038  2 000045   400000 236003                    LDQ     -131072,DU
         2 000046   200016 756100                    STQ     DISP,,AUTO

      179    15039    2      GOT_OPTS = %NO# ;

  15039  2 000047   200012 450100                    STZ     GOT_OPTS,,AUTO

      180    15040    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  15040  2 000050   000003 471500                    LDP1    3,,PR0
         2 000051   100001 220100                    LDX0    1,,PR1
         2 000052   000002 100003                    CMPX0   2,DU
         2 000053   000065 601000 2                  TNZ     s:15042

      181    15041    2         JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  15041  2 000054   100004 473500                    LDP3    4,,PR1
         2 000055   400000 221003                    LDX1    -131072,DU
         2 000056   300000 722100                    LXL2    0,,PR3
         2 000057   000001 102003                    CMPX2   1,DU
         2 000060   000062 600000 2                  TZE     s:15041+6
         2 000061   000000 221003                    LDX1    0,DU
         2 000062   000000 636011                    EAQ     0,X1
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:28   
         2 000063   200017 756100                    STQ     JCL,,AUTO
         2 000064   000201 710000 2                  TRA     s:15080

      182    15042    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  15042  2 000065   000000 100003                    CMPX0   0,DU
         2 000066   000201 600000 2                  TZE     s:15080

      183    15043    2            JCL = (P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  15043  2 000067   100003 473500                    LDP3    3,,PR1
         2 000070   400000 221003                    LDX1    -131072,DU
         2 000071   300000 722100                    LXL2    0,,PR3
         2 000072   000001 102003                    CMPX2   1,DU
         2 000073   000075 600000 2                  TZE     s:15043+6
         2 000074   000000 221003                    LDX1    0,DU
         2 000075   000000 636011                    EAQ     0,X1
         2 000076   200017 756100                    STQ     JCL,,AUTO
         2 000077   000201 710000 2                  TRA     s:15080

      184    15044
      185    15045    2      SELECT (%LIST_PROFILE_VAL,

      186    15046    2           %DISPLAY_PROFILE_VAL);
      187    15047
      188    15048    2      DISP = (CODE = %DISPLAY_PROFILE_VAL);

  15048  2 000100   400000 220003                    LDX0    -131072,DU
         2 000101   000132 116007                    CMPQ    90,DL
         2 000102   000104 600000 2                  TZE     s:15048+4
         2 000103   000000 220003                    LDX0    0,DU
         2 000104   000000 636010                    EAQ     0,X0
         2 000105   200016 756100                    STQ     DISP,,AUTO

      189    15049
      190    15050    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:29   
  15050  2 000106   000001 235007                    LDA     1,DL
         2 000107   200006 755100                    STA     I,,AUTO
         2 000110   000174 710000 2                  TRA     s:15076+3

      191    15051    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  15051  2 000111   000003 470400 xsym               LDP0    P_PCB+3
         2 000112   200006 720100                    LXL0    I,,AUTO
         2 000113   000003 471510                    LDP1    3,X0,PR0
         2 000114   100000 236100                    LDQ     0,,PR1
         2 000115   777777 376007                    ANQ     -1,DL
         2 000116   200034 756100                    STQ     CODE2,,AUTO

      192    15052
      193    15053    4         DO SELECT (CODE2);

  15053  2 000117   000315 116007                    CMPQ    205,DL
         2 000120   000125 602000 2                  TNC     s:15053+6
         2 000121   000134 600000 2                  TZE     s:15057
         2 000122   000316 116007                    CMPQ    206,DL
         2 000123   000171 601000 2                  TNZ     s:15076
         2 000124   000160 710000 2                  TRA     s:15067
         2 000125   000314 116007                    CMPQ    204,DL
         2 000126   000131 602000 2                  TNC     s:15053+10
         2 000127   000146 600000 2                  TZE     s:15062
         2 000130   000171 710000 2                  TRA     s:15076
         2 000131   000001 116007                    CMPQ    1,DL
         2 000132   000171 601000 2                  TNZ     s:15076
         2 000133   000167 710000 2                  TRA     s:15072

      194    15054
      195    15055    4            SELECT (%PROFILE_NAME_WILD_VAL);

      196    15056
      197    15057    4            PROFILE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15057  2 000134   100004 236100                    LDQ     4,,PR1
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:30   
         2 000135   000033 772000                    QRL     27
         2 000136   000000 621006                    EAX1    0,QL
         2 000137   040100 100540                    MLR     fill='040'O
         2 000140   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000141   200035 200013                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=11

      198    15058    4            PROFILE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15058  2 000142   000003 471510                    LDP1    3,X0,PR0
         2 000143   100004 236100                    LDQ     4,,PR1
         2 000144   200035 552140                    STBQ    PROFILE_NAME,'40'O,AUTO
         2 000145   000171 710000 2                  TRA     s:15076

      199    15059
      200    15060    4            SELECT (%PROFILE_NAME_VAL);

      201    15061
      202    15062    4            PROFILE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15062  2 000146   100004 236100                    LDQ     4,,PR1
         2 000147   000033 772000                    QRL     27
         2 000150   000000 621006                    EAX1    0,QL
         2 000151   040100 100540                    MLR     fill='040'O
         2 000152   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000153   200035 200013                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=11

      203    15063    4            PROFILE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15063  2 000154   000003 471510                    LDP1    3,X0,PR0
         2 000155   100004 236100                    LDQ     4,,PR1
         2 000156   200035 552140                    STBQ    PROFILE_NAME,'40'O,AUTO
         2 000157   000171 710000 2                  TRA     s:15076

      204    15064
      205    15065    4            SELECT (%PRO_TYPE_VAL);

      206    15066
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:31   
      207    15067    4            TYPE_CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$B.CODE;

  15067  2 000160   100003 473500                    LDP3    3,,PR1
         2 000161   300000 236100                    LDQ     0,,PR3
         2 000162   777777 376007                    ANQ     -1,DL
         2 000163   200040 756100                    STQ     TYPE_CODE,,AUTO

      208    15068    4            TYPE_SPECIFIED = %YES#;

  15068  2 000164   400000 236003                    LDQ     -131072,DU
         2 000165   200010 756100                    STQ     TYPE_SPECIFIED,,AUTO
         2 000166   000171 710000 2                  TRA     s:15076

      209    15069
      210    15070    4            SELECT (%JCL_VAL);

      211    15071
      212    15072    4            JCL = %YES#;

  15072  2 000167   400000 236003                    LDQ     -131072,DU
         2 000170   200017 756100                    STQ     JCL,,AUTO

      213    15073
      214    15074    4            END;  /* Do case (CODE2) */

      215    15075
      216    15076    3         END;  /*  Do i  */

  15076  2 000171   200006 235100                    LDA     I,,AUTO
         2 000172   000001 035007                    ADLA    1,DL
         2 000173   200006 755100                    STA     I,,AUTO
         2 000174   000001 236100                    LDQ     1,,PR0
         2 000175   000022 772000                    QRL     18
         2 000176   200006 116100                    CMPQ    I,,AUTO
         2 000177   000201 600000 2                  TZE     s:15080
         2 000200   000111 603000 2                  TRC     s:15051

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:32   
      217    15077
      218    15078    2      END;  /*  Do case (code)  */

      219    15079
      220    15080    1   XPNAME = PROFILE_NAME;

  15080  2 000201   000100 100500                    MLR     fill='000'O
         2 000202   200035 000014                    ADSC9   PROFILE_NAME,,AUTO       cn=0,n=12
         2 000203   200003 000014                    ADSC9   XPNAME,,AUTO             cn=0,n=12

      221    15081    1   CALL XLATE (XPNAME.TXT, B$XL_UPPER_UR,

  15081  2 000204   200035 236100                    LDQ     PROFILE_NAME,,AUTO
         2 000205   000033 772000                    QRL     27
         2 000206   000000 620006                    EAX0    0,QL
         2 000207   000000 471400 xsym               LDP1    B$XL_UPPER_UR$
         2 000210   040100 160540                    MVT     fill='040'O
         2 000211   200035 200010                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=*X0
         2 000212   200003 200013                    ADSC9   XPNAME,,AUTO             cn=1,n=11
         2 000213   100000 000100                    ARG     0,,PR1

      222    15082    1        SUBSTR (PROFILE_NAME.TEXT, 0, PROFILE_NAME.COUNT) );
      223    15083    1   IF (SUBSTR (XPNAME.TXT, 0, XPNAME.CNT) =

  15083  2 000214   200003 236100                    LDQ     XPNAME,,AUTO
         2 000215   000033 772000                    QRL     27
         2 000216   000000 620006                    EAX0    0,QL
         2 000217   200035 236100                    LDQ     PROFILE_NAME,,AUTO
         2 000220   000033 772000                    QRL     27
         2 000221   000000 621006                    EAX1    0,QL
         2 000222   040140 106540                    CMPC    fill='040'O
         2 000223   200003 200010                    ADSC9   XPNAME,,AUTO             cn=1,n=*X0
         2 000224   200035 200011                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=*X1
         2 000225   000227 601000 2                  TNZ     s:15088

      224    15084    1        SUBSTR (PROFILE_NAME.TEXT, 0, PROFILE_NAME.COUNT) )
      225    15085    2   THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:33   

      226    15086    2      END; /* It's already been done.*/

  15086  2 000226   000236 710000 2                  TRA     s:15106

      227    15087    2   ELSE DO; /* Redo it with uppercase only and warn of it...*/

      228    15088    2      PROFILE_NAME = XPNAME;

  15088  2 000227   000100 100500                    MLR     fill='000'O
         2 000230   200003 000014                    ADSC9   XPNAME,,AUTO             cn=0,n=12
         2 000231   200035 000014                    ADSC9   PROFILE_NAME,,AUTO       cn=0,n=12

      229    15089           %SCREAM (ERR#=E$PNAMEXLATED, LEVEL=WARN, MID='D');

  15099  2 000232   000001 630400 3                  EPPR0   1
         2 000233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000234   000000 701000 xent               TSX1    ASH$WARN
         2 000235   000000 011000                    NOP     0

      230    15104    2      END;

      231    15105
      232    15106    1   IF PROFILE_NAME.TEXT = '?' THEN

  15106  2 000236   040000 106500                    CMPC    fill='040'O
         2 000237   200035 200013                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=11
         2 000240   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000241   000245 601000 2                  TNZ     s:15109

      233    15107    1      ALL_PROFILES = %YES#;

  15107  2 000242   400000 236003                    LDQ     -131072,DU
         2 000243   200015 756100                    STQ     ALL_PROFILES,,AUTO
         2 000244   000311 710000 2                  TRA     s:15124

      234    15108    2   ELSE DO;
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:34   

      235    15109    2      ALL_PROFILES = %NO#;

  15109  2 000245   200015 450100                    STZ     ALL_PROFILES,,AUTO

      236    15110    2      BEGIN_KEY.TEXT = ' ';

  15110  2 000246   040100 100400                    MLR     fill='040'O
         2 000247   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000250   200022 000013                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=11

      237    15111    2      END_KEY.TEXT = ' ';

  15111  2 000251   040100 100400                    MLR     fill='040'O
         2 000252   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000253   200026 000013                    ADSC9   END_KEY+1,,AUTO          cn=0,n=11

      238    15112    3      CALL INDEX (I,'?',PROFILE_NAME.TEXT) WHENRETURN DO;

  15112  2 000254   000000 124500                    SCM     mask='000'O
         2 000255   200035 200013                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=11
         2 000256   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000257   200006 000100                    ARG     I,,AUTO
         2 000260   000310 606400 2                  TTN     s:15120

      239    15113    3         BEGIN_KEY.TEXT = SUBSTR(PROFILE_NAME.TEXT,0,I);

  15113  2 000261   200006 720100                    LXL0    I,,AUTO
         2 000262   040100 100540                    MLR     fill='040'O
         2 000263   200035 200010                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=*X0
         2 000264   200022 000013                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=11

      240    15114    3         BEGIN_KEY.COUNT = 11;

  15114  2 000265   013000 236003                    LDQ     5632,DU
         2 000266   200021 756100                    STQ     BEGIN_KEY,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:35   
      241    15115    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(PROFILE_NAME.TEXT,0,I),'~');

  15115  2 000267   040100 100540                    MLR     fill='040'O
         2 000270   200035 200010                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=*X0
         2 000271   200026 000013                    ADSC9   END_KEY+1,,AUTO          cn=0,n=11
         2 000272   200006 236100                    LDQ     I,,AUTO
         2 000273   000013 116007                    CMPQ    11,DL
         2 000274   000302 603000 2                  TRC     s:15116
         2 000275   777764 621006                    EAX1    -12,QL
         2 000276   777777 661003                    ERX1    -1,DU
         2 000277   040146 100400                    MLR     fill='040'O
         2 000300   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000301   200026 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      242    15116    3         END_KEY.COUNT = I + 1;

  15116  2 000302   000001 036007                    ADLQ    1,DL
         2 000303   000033 736000                    QLS     27
         2 000304   200025 756100                    STQ     END_KEY,,AUTO

      243    15117    3         WILD_CARD = %YES#;

  15117  2 000305   400000 236003                    LDQ     -131072,DU
         2 000306   200014 756100                    STQ     WILD_CARD,,AUTO

      244    15118    3         END; /*  Whenreturn from index  */

  15118  2 000307   000311 710000 2                  TRA     s:15124

      245    15119    3      WHENALTRETURN DO;

      246    15120    3         WILD_CARD = %NO#;

  15120  2 000310   200014 450100                    STZ     WILD_CARD,,AUTO

      247    15121    3         END; /* Whenaltreturn  */

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:36   
      248    15122    2      END; /*  Else  */

      249    15123
      250    15124    1   FDS.NVECS# = 0;

  15124  2 000311   000011 450000 xsym               STZ     FDS+9

      251    15125    2   IF JCL THEN DO;

  15125  2 000312   200017 234100                    SZN     JCL,,AUTO
         2 000313   000331 605000 2                  TPL     s:15130

      252    15126    2      CALL CONCAT (FMT_BUF, '%1/"', PROFILES_STR, '%1/');

  15126  2 000314   000061 236000 1                  LDQ     DISPLAY_STR+4
         2 000315   000000 756000 xsym               STQ     FMT_BUF
         2 000316   040000 100400                    MLR     fill='040'O
         2 000317   000051 000010 1                  ADSC9   PROFILES_STR             cn=0,n=8
         2 000320   000001 000010 xsym               ADSC9   FMT_BUF+1                cn=0,n=8
         2 000321   040000 100400                    MLR     fill='040'O
         2 000322   000061 000003 1                  ADSC9   DISPLAY_STR+4            cn=0,n=3
         2 000323   000003 000363 xsym               ADSC9   FMT_BUF+3                cn=0,n=243

      253    15127    2      FDS.FMT_.BOUND = LENGTHC (PROFILES_STR) + 6;

  15127  2 000324   000000 236000 xsym               LDQ     FDS
         2 000325   177777 376007                    ANQ     65535,DL
         2 000326   000003 276000 3                  ORQ     3
         2 000327   000000 756000 xsym               STQ     FDS

      254    15128    2      END;   /*  Jcl  */

  15128  2 000330   000347 710000 2                  TRA     s:15133

      255    15129    2   ELSE DO;

      256    15130    2      CALL CONCAT (FMT_BUF, '%1/', PROFILES_STR, '%1/');
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:37   

  15130  2 000331   000061 236000 1                  LDQ     DISPLAY_STR+4
         2 000332   000004 376000 3                  ANQ     4
         2 000333   000040 276007                    ORQ     32,DL
         2 000334   000000 756000 xsym               STQ     FMT_BUF
         2 000335   040000 100400                    MLR     fill='040'O
         2 000336   000051 000010 1                  ADSC9   PROFILES_STR             cn=0,n=8
         2 000337   000000 600010 xsym               ADSC9   FMT_BUF                  cn=3,n=8
         2 000340   040000 100400                    MLR     fill='040'O
         2 000341   000061 000003 1                  ADSC9   DISPLAY_STR+4            cn=0,n=3
         2 000342   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

      257    15131    2      FDS.FMT_.BOUND = LENGTHC (PROFILES_STR) + 5;

  15131  2 000343   000000 236000 xsym               LDQ     FDS
         2 000344   177777 376007                    ANQ     65535,DL
         2 000345   000005 276000 3                  ORQ     5
         2 000346   000000 756000 xsym               STQ     FDS

      258    15132    2      END;   /*  Not jcl  */

      259    15133    1   FDS.TABDFLT# = 10;

  15133  2 000347   000012 235007                    LDA     10,DL
         2 000350   000017 755000 xsym               STA     FDS+15

      260    15134    1   CALL X$FORMAT (FDS);

  15134  2 000351   000006 630400 3                  EPPR0   6
         2 000352   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000353   000000 701000 xent               TSX1    X$FORMAT
         2 000354   000000 011000                    NOP     0

      261    15135
      262    15136    2   IF ALL_PROFILES THEN DO;

  15136  2 000355   200015 234100                    SZN     ALL_PROFILES,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:38   
         2 000356   000363 605000 2                  TPL     s:15139

      263    15137    2      USERS_KEY = '001000'O ;      /* Position to bof of :PRO            */

  15137  2 000357   000000 100400                    MLR     fill='000'O
         2 000360   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         2 000361   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      264    15138    2      END;  /*  ALL_PROFILES  */

  15138  2 000362   000575 710000 2                  TRA     s:15223

      265    15139    2   ELSE IF WILD_CARD THEN DO;

  15139  2 000363   200014 234100                    SZN     WILD_CARD,,AUTO
         2 000364   000371 605000 2                  TPL     s:15143

      266    15140    2         USERS_KEY = BEGIN_KEY;

  15140  2 000365   000000 100500                    MLR     fill='000'O
         2 000366   200021 000017                    ADSC9   BEGIN_KEY,,AUTO          cn=0,n=15
         2 000367   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      267    15141    2         END; /*  WILD_CARD  */

  15141  2 000370   000575 710000 2                  TRA     s:15223

      268    15142    2      ELSE DO;  /*  Single profile  */

      269    15143    2         USERS_KEY = PROFILE_NAME;

  15143  2 000371   000000 100500                    MLR     fill='000'O
         2 000372   200035 000014                    ADSC9   PROFILE_NAME,,AUTO       cn=0,n=12
         2 000373   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      270    15144    2         ARS = DSEG1SIZE ;

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:39   
  15144  2 000374   000000 235000 xsym               LDA     DSEG1SIZE
         2 000375   200013 755100                    STA     ARS,,AUTO

      271    15145    2         CALL ASD$READ_PRO ( USERS_KEY,DSEG1$->PRO$HDR,ARS )

  15145  2 000376   200013 630500                    EPPR0   ARS,,AUTO
         2 000377   200044 450500                    STP0    TYPE_CODE+4,,AUTO
         2 000400   000000 236000 xsym               LDQ     DSEG1$
         2 000401   000007 235000 3                  LDA     7
         2 000402   200042 757100                    STAQ    TYPE_CODE+2,,AUTO
         2 000403   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000404   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000405   000000 701000 xent               TSX1    ASD$READ_PRO
         2 000406   000554 702000 2                  TSX2    s:15192

      272    15146    3         WHENRETURN DO;

      273    15147    3            IF TYPE_SPECIFIED THEN

  15147  2 000407   200010 234100                    SZN     TYPE_SPECIFIED,,AUTO
         2 000410   000461 605000 2                  TPL     s:15174

      274    15148    4               IF TYPE_CODE ~= DSEG1$->PRO$HDR.TTYP THEN DO;

  15148  2 000411   000000 470400 xsym               LDP0    DSEG1$
         2 000412   000100 101500                    MRL     fill='000'O
         2 000413   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000414   200042 000004                    ADSC9   TYPE_CODE+2,,AUTO        cn=0,n=4
         2 000415   200042 236100                    LDQ     TYPE_CODE+2,,AUTO
         2 000416   200040 116100                    CMPQ    TYPE_CODE,,AUTO
         2 000417   000461 600000 2                  TZE     s:15174

      275    15149        /*E* ERROR:   ASL-E$NOTPROTYPE-C
      276    15150             MESSAGE: Type does not match.
      277    15151             MESSAGE1: You asked for %U1 and this profile has %U2.
      278    15152        */
      279    15153    4                  AS_FIELD2.TEXT = TYPE_STR.TEXT (DSEG1$->PRO$HDR.TTYP);
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:40   

  15153  2 000420   000100 101500                    MRL     fill='000'O
         2 000421   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000422   200042 000002                    ADSC9   TYPE_CODE+2,,AUTO        cn=0,n=2
         2 000423   200042 220100                    LDX0    TYPE_CODE+2,,AUTO
         2 000424   200042 020100                    ADLX0   TYPE_CODE+2,,AUTO
         2 000425   200042 020100                    ADLX0   TYPE_CODE+2,,AUTO
         2 000426   000000 635010                    EAA     0,X0
         2 000427   000020 771000                    ARL     16
         2 000430   040000 100405                    MLR     fill='040'O
         2 000431   000001 000007 1                  ADSC9   TYPE_STR+1,A             cn=0,n=7
         2 000432   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      280    15154    4                  AS_FIELD2.COUNT = TYPE_STR.COUNT (DSEG1$->PRO$HDR.TTYP);

  15154  2 000433   000100 101500                    MRL     fill='000'O
         2 000434   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000435   200042 000002                    ADSC9   TYPE_CODE+2,,AUTO        cn=0,n=2
         2 000436   200042 220100                    LDX0    TYPE_CODE+2,,AUTO
         2 000437   200042 020100                    ADLX0   TYPE_CODE+2,,AUTO
         2 000440   200042 020100                    ADLX0   TYPE_CODE+2,,AUTO
         2 000441   000000 236010 1                  LDQ     TYPE_STR,X0
         2 000442   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      281    15155    4                  AS_FIELD1.TEXT = TYPE_STR.TEXT (TYPE_CODE);

  15155  2 000443   200040 236100                    LDQ     TYPE_CODE,,AUTO
         2 000444   000014 402007                    MPY     12,DL
         2 000445   040000 100406                    MLR     fill='040'O
         2 000446   000001 000007 1                  ADSC9   TYPE_STR+1,Q             cn=0,n=7
         2 000447   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      282    15156    4                  AS_FIELD1.COUNT = TYPE_STR.COUNT (TYPE_CODE);

  15156  2 000450   200040 236100                    LDQ     TYPE_CODE,,AUTO
         2 000451   000003 402007                    MPY     3,DL
         2 000452   000000 236006 1                  LDQ     TYPE_STR,QL
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:41   
         2 000453   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      283    15157                       %SCREAM( ERR#=%E$NOTPROTYPE, MID='L', LEVEL=ERROR );

  15169  2 000454   000010 630400 3                  EPPR0   8
         2 000455   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000456   000000 701000 xent               TSX1    ASH$ERROR
         2 000457   000000 011000                    NOP     0

      284    15172    4                  RETURN;

  15172  2 000460   000000 702200 xent               TSX2  ! X66_ARET

      285    15173    4                  END; /*  TYPE_CODE ~=  */
      286    15174    3            IF DISP THEN

  15174  2 000461   200016 234100                    SZN     DISP,,AUTO
         2 000462   000523 605000 2                  TPL     s:15186

      287    15175    4            DO;

      288    15176    4               CALL ASL$LIST_PRO_OPTS (ARS,JCL);

  15176  2 000463   200017 630500                    EPPR0   JCL,,AUTO
         2 000464   200043 450500                    STP0    TYPE_CODE+3,,AUTO
         2 000465   200013 631500                    EPPR1   ARS,,AUTO
         2 000466   200042 451500                    STP1    TYPE_CODE+2,,AUTO
         2 000467   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000470   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000471   000000 701000 xent               TSX1    ASL$LIST_PRO_OPTS
         2 000472   000000 011000                    NOP     0

      289    15177    4               CALL ASB$WRITE_LO (' ',1);

  15177  2 000473   000011 630400 3                  EPPR0   9
         2 000474   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000475   000000 701000 xent               TSX1    ASB$WRITE_LO
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:42   
         2 000476   000000 011000                    NOP     0

      290    15178    4               CALL ASL$DISP_ONE_PROFILE (ARS,JCL);

  15178  2 000477   200017 630500                    EPPR0   JCL,,AUTO
         2 000500   200043 450500                    STP0    TYPE_CODE+3,,AUTO
         2 000501   200013 631500                    EPPR1   ARS,,AUTO
         2 000502   200042 451500                    STP1    TYPE_CODE+2,,AUTO
         2 000503   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000504   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000505   000000 701000 xent               TSX1    ASL$DISP_ONE_PROFILE
         2 000506   000000 011000                    NOP     0

      291    15179    5               IF FDS.NVECS# > 0 THEN DO;

  15179  2 000507   000011 235000 xsym               LDA     FDS+9
         2 000510   000553 604400 2                  TMOZ    s:15190

      292    15180    5                  CALL X$FORMAT (FDS);

  15180  2 000511   000006 630400 3                  EPPR0   6
         2 000512   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000513   000000 701000 xent               TSX1    X$FORMAT
         2 000514   000000 011000                    NOP     0

      293    15181    5                  FDS.NVECS# = 0;

  15181  2 000515   000011 450000 xsym               STZ     FDS+9

      294    15182    5                  CALL ASB$WRITE_LO (' ',1);

  15182  2 000516   000011 630400 3                  EPPR0   9
         2 000517   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000520   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000521   000000 011000                    NOP     0

      295    15183    5                  END;   /*  Nvecs > 0  */
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:43   

      296    15184    4               END; /*  If disp  */

  15184  2 000522   000553 710000 2                  TRA     s:15190

      297    15185    4            ELSE DO;

      298    15186    4               CALL CONCAT (FMT_BUF, SUBSTR(PROFILE_NAME.TEXT,0,PROFILE_NAME.COUNT),
             15186                        '%1/');

  15186  2 000523   200035 236100                    LDQ     PROFILE_NAME,,AUTO
         2 000524   000033 772000                    QRL     27
         2 000525   000000 620006                    EAX0    0,QL
         2 000526   040000 100540                    MLR     fill='040'O
         2 000527   200035 200010                    ADSC9   PROFILE_NAME,,AUTO       cn=1,n=*X0
         2 000530   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255
         2 000531   000377 116007                    CMPQ    255,DL
         2 000532   000540 603000 2                  TRC     s:15187
         2 000533   777400 620006                    EAX0    -256,QL
         2 000534   777777 660003                    ERX0    -1,DU
         2 000535   040046 100400                    MLR     fill='040'O
         2 000536   000061 000003 1                  ADSC9   DISPLAY_STR+4            cn=0,n=3
         2 000537   000000 000010 xsym               ADSC9   FMT_BUF,Q                cn=0,n=*X0

      299    15187    4               FDS.FMT_.BOUND = PROFILE_NAME.COUNT + 2;

  15187  2 000540   200035 236100                    LDQ     PROFILE_NAME,,AUTO
         2 000541   000033 772000                    QRL     27
         2 000542   000002 036007                    ADLQ    2,DL
         2 000543   000020 736000                    QLS     16
         2 000544   000000 676000 xsym               ERQ     FDS
         2 000545   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000546   000000 656000 xsym               ERSQ    FDS

      300    15188    4               CALL X$FORMAT (FDS);

  15188  2 000547   000006 630400 3                  EPPR0   6
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:44   
         2 000550   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000551   000000 701000 xent               TSX1    X$FORMAT
         2 000552   000000 011000                    NOP     0

      301    15189    4               END; /*  Else  disp  */

      302    15190    3            END;  /*  Whenreturn  */

  15190  2 000553   000574 710000 2                  TRA     s:15219

      303    15191    3         WHENALTRETURN DO;

      304    15192    3            IF MERR_CODE.CODE = %E$NOKEY

  15192  2 000554   000000 236000 xsym               LDQ     ERR_CODE
         2 000555   377770 376007                    ANQ     131064,DL
         2 000556   001020 116007                    CMPQ    528,DL
         2 000557   000570 601000 2                  TNZ     s:15216

      305    15193    4            THEN DO;

      306    15194        /*E* ERROR:   AS-E$PROFILE_NO_EXIST-C
      307    15195             MESSAGE: Profile %U1 does not exist.
      308    15196             MESSAGE1: The specified PROFILE does not exist.
      309    15197        */
      310    15198    4               AS_FIELD1 = PROFILE_NAME;

  15198  2 000560   000000 100500                    MLR     fill='000'O
         2 000561   200035 000014                    ADSC9   PROFILE_NAME,,AUTO       cn=0,n=12
         2 000562   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      311    15199                    %SCREAM( ERR#=%E$PROFILE_NO_EXIST, MID='L', LEVEL=ERROR );

  15211  2 000563   000013 630400 3                  EPPR0   11
         2 000564   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000565   000000 701000 xent               TSX1    ASH$ERROR
         2 000566   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:45   

      312    15214    4               END;  /*  Error = nokey  */

  15214  2 000567   000574 710000 2                  TRA     s:15219

      313    15215    4            ELSE DO;

      314    15216    4               CALL ASH$ERROR(MERR_CODE) ;

  15216  2 000570   000014 630400 3                  EPPR0   12
         2 000571   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000572   000000 701000 xent               TSX1    ASH$ERROR
         2 000573   000000 011000                    NOP     0

      315    15217    4               END;  /* Error ~= nokey */

      316    15218    3            END;  /*  Whenaltreturn  */

      317    15219    2         RETURN;

  15219  2 000574   000000 702200 xent               TSX2  ! X66_ARET

      318    15220    2         END; /*  Else  */
      319    15221
      320    15222
      321    15223    1   CALL ASD$PREC_PRO(USERS_KEY) ;

  15223  2 000575   000007 630400 3                  EPPR0   7
         2 000576   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000577   000000 701000 xent               TSX1    ASD$PREC_PRO
         2 000600   000000 011000                    NOP     0

      322    15224
      323    15225    2   DO FOREVER;

  15223  2 000601                       READ_PRO     null
      324    15226
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:46   
      325    15227    2   READ_PRO: ;
      326    15228    2      ARS = DSEG1SIZE ;

  15228  2 000601   000000 235000 xsym               LDA     DSEG1SIZE
         2 000602   200013 755100                    STA     ARS,,AUTO

      327    15229    2      CALL ASD$READ_PRO_SEQ( USERS_KEY,DSEG1$->PRO$HDR,ARS )

  15229  2 000603   200013 630500                    EPPR0   ARS,,AUTO
         2 000604   200044 450500                    STP0    TYPE_CODE+4,,AUTO
         2 000605   000000 236000 xsym               LDQ     DSEG1$
         2 000606   000007 235000 3                  LDA     7
         2 000607   200042 757100                    STAQ    TYPE_CODE+2,,AUTO
         2 000610   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000611   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000612   000000 701000 xent               TSX1    ASD$READ_PRO_SEQ
         2 000613   000615 702000 2                  TSX2    s:15231
         2 000614   000630 710000 2                  TRA     s:15238

      328    15230    3      WHENALTRETURN DO;

      329    15231    3         IF MERR_CODE.CODE = %E$EOF THEN

  15231  2 000615   000000 236000 xsym               LDQ     ERR_CODE
         2 000616   377770 376007                    ANQ     131064,DL
         2 000617   000060 116007                    CMPQ    48,DL
         2 000620   001032 600000 2                  TZE     FINISH_UP

      330    15232    3            GOTO FINISH_UP;
      331    15233    3         MERR_CODE.SEV = 0 ;

  15233  2 000621   000015 236000 3                  LDQ     13
         2 000622   000000 356000 xsym               ANSQ    ERR_CODE

      332    15234    3         CALL ASH$ERROR(MERR_CODE) ;

  15234  2 000623   000014 630400 3                  EPPR0   12
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:47   
         2 000624   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000625   000000 701000 xent               TSX1    ASH$ERROR
         2 000626   000000 011000                    NOP     0

      333    15235    3         RETURN ;

  15235  2 000627   000000 702200 xent               TSX2  ! X66_ARET

      334    15236    3         END ;                     /*  Whenaltreturn  */
      335    15237                                                /* Got one.                           */
      336    15238    2      IF TYPE_SPECIFIED THEN

  15238  2 000630   200010 234100                    SZN     TYPE_SPECIFIED,,AUTO
         2 000631   000641 605000 2                  TPL     s:15241

      337    15239    2         IF TYPE_CODE ~= DSEG1$ -> PRO$HDR.TTYP THEN

  15239  2 000632   000000 470400 xsym               LDP0    DSEG1$
         2 000633   000100 101500                    MRL     fill='000'O
         2 000634   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000635   200042 000004                    ADSC9   TYPE_CODE+2,,AUTO        cn=0,n=4
         2 000636   200042 236100                    LDQ     TYPE_CODE+2,,AUTO
         2 000637   200040 116100                    CMPQ    TYPE_CODE,,AUTO
         2 000640   000601 601000 2                  TNZ     READ_PRO

      338    15240    2            GOTO READ_PRO ;
      339    15241    2      I = USERS_KEY.COUNT ;

  15241  2 000641   000000 236000 xsym               LDQ     USERS_KEY
         2 000642   000033 772000                    QRL     27
         2 000643   200006 756100                    STQ     I,,AUTO

      340    15242    2      CURRENT_PROFILE = SUBSTR(USERS_KEY.TXTC,0,I);

  15242  2 000644   000000 620006                    EAX0    0,QL
         2 000645   040100 100440                    MLR     fill='040'O
         2 000646   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:48   
         2 000647   200031 000013                    ADSC9   CURRENT_PROFILE,,AUTO    cn=0,n=11

      341    15243    3      IF WILD_CARD THEN DO;

  15243  2 000650   200014 234100                    SZN     WILD_CARD,,AUTO
         2 000651   000701 605000 2                  TPL     s:15253

      342    15244    3         J = PROFILE_NAME.COUNT;

  15244  2 000652   200035 236100                    LDQ     PROFILE_NAME,,AUTO
         2 000653   000033 772000                    QRL     27
         2 000654   200007 756100                    STQ     J,,AUTO

      343    15245    3         CALL ASB$WILD_MATCH (I, CURRENT_PROFILE, J, PROFILE_NAME.TEXT)

  15245  2 000655   200046 452500                    STP2    TYPE_CODE+6,,AUTO
         2 000656   200046 236100                    LDQ     TYPE_CODE+6,,AUTO
         2 000657   000016 036000 3                  ADLQ    14
         2 000660   200045 756100                    STQ     TYPE_CODE+5,,AUTO
         2 000661   200007 630500                    EPPR0   J,,AUTO
         2 000662   200044 450500                    STP0    TYPE_CODE+4,,AUTO
         2 000663   200031 631500                    EPPR1   CURRENT_PROFILE,,AUTO
         2 000664   200043 451500                    STP1    TYPE_CODE+3,,AUTO
         2 000665   200006 633500                    EPPR3   I,,AUTO
         2 000666   200042 453500                    STP3    TYPE_CODE+2,,AUTO
         2 000667   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000670   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000671   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000672   000674 702000 2                  TSX2    s:15247
         2 000673   000701 710000 2                  TRA     s:15253

      344    15246    4         WHENALTRETURN DO;

      345    15247    4            IF CURRENT_PROFILE > END_KEY.TEXT THEN

  15247  2 000674   040100 106500                    CMPC    fill='040'O
         2 000675   200026 000013                    ADSC9   END_KEY+1,,AUTO          cn=0,n=11
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:49   
         2 000676   200031 000013                    ADSC9   CURRENT_PROFILE,,AUTO    cn=0,n=11
         2 000677   001032 602000 2                  TNC     FINISH_UP

      346    15248    4               GOTO FINISH_UP;
      347    15249    4            ELSE
      348    15250    4               GOTO READ_PRO;

  15250  2 000700   000601 710000 2                  TRA     READ_PRO

      349    15251    4            END;  /*  Whenaltreturn  */
      350    15252    3         END; /*  WILD_CARD  */

      351    15253    2      IF DISP THEN

  15253  2 000701   200016 234100                    SZN     DISP,,AUTO
         2 000702   000770 605000 2                  TPL     s:15270

      352    15254    3      DO;

      353    15255    3         IF ((NOT TYPE_SPECIFIED) AND (LAST_TYPE ~= DSEG1$->PRO$HDR.TTYP))

  15255  2 000703   200010 234100                    SZN     TYPE_SPECIFIED,,AUTO
         2 000704   000731 604000 2                  TMI     s:15260
         2 000705   000000 470400 xsym               LDP0    DSEG1$
         2 000706   000100 101500                    MRL     fill='000'O
         2 000707   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000710   200042 000004                    ADSC9   TYPE_CODE+2,,AUTO        cn=0,n=4
         2 000711   200042 236100                    LDQ     TYPE_CODE+2,,AUTO
         2 000712   200011 116100                    CMPQ    LAST_TYPE,,AUTO
         2 000713   000731 600000 2                  TZE     s:15260

      354    15256    4         THEN DO ;               /*  Set all options  */

      355    15257    4            CALL ASL$LIST_PRO_OPTS (ARS,%YES#) ;

  15257  2 000714   000017 236000 3                  LDQ     15
         2 000715   200043 756100                    STQ     TYPE_CODE+3,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:50   
         2 000716   200013 631500                    EPPR1   ARS,,AUTO
         2 000717   200042 451500                    STP1    TYPE_CODE+2,,AUTO
         2 000720   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000721   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000722   000000 701000 xent               TSX1    ASL$LIST_PRO_OPTS
         2 000723   000000 011000                    NOP     0

      356    15258    4            LAST_TYPE = DSEG1$->PRO$HDR.TTYP;

  15258  2 000724   000000 470400 xsym               LDP0    DSEG1$
         2 000725   000100 101500                    MRL     fill='000'O
         2 000726   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000727   200011 000004                    ADSC9   LAST_TYPE,,AUTO          cn=0,n=4

      357    15259    4            END ;                    /* Not TYPE_SPECIFIED */

  15259  2 000730   000747 710000 2                  TRA     s:15265

      358    15260    3         ELSE IF (TYPE_SPECIFIED AND (NOT GOT_OPTS))

  15260  2 000731   200010 234100                    SZN     TYPE_SPECIFIED,,AUTO
         2 000732   000747 605000 2                  TPL     s:15265
         2 000733   200012 234100                    SZN     GOT_OPTS,,AUTO
         2 000734   000747 604000 2                  TMI     s:15265

      359    15261    4            THEN DO ;            /*  Get options  */

      360    15262    4               CALL ASL$LIST_PRO_OPTS (ARS,JCL) ;

  15262  2 000735   200017 630500                    EPPR0   JCL,,AUTO
         2 000736   200043 450500                    STP0    TYPE_CODE+3,,AUTO
         2 000737   200013 631500                    EPPR1   ARS,,AUTO
         2 000740   200042 451500                    STP1    TYPE_CODE+2,,AUTO
         2 000741   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000742   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000743   000000 701000 xent               TSX1    ASL$LIST_PRO_OPTS
         2 000744   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:51   

      361    15263    4               GOT_OPTS = '1'B ;

  15263  2 000745   400000 236003                    LDQ     -131072,DU
         2 000746   200012 756100                    STQ     GOT_OPTS,,AUTO

      362    15264    4               END ;                 /* TYPE_SPECIFIED and GOT_OPTS*/

      363    15265    3         IF PRO_FLAGS ~= '0'B THEN

  15265  2 000747   000000 066400                    CMPB    filb='0'B
         2 000750   000000 000431 xsym               BDSC    PRO_FLAGS                by=0,bit=0,n=281
         2 000751   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000752   000757 600000 2                  TZE     s:15267

      364    15266    3            CALL ASB$WRITE_LO (' ',1);

  15266  2 000753   000011 630400 3                  EPPR0   9
         2 000754   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000755   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 000756   000000 011000                    NOP     0

      365    15267    3         CALL ASL$DISP_ONE_PROFILE (ARS,JCL);

  15267  2 000757   200017 630500                    EPPR0   JCL,,AUTO
         2 000760   200043 450500                    STP0    TYPE_CODE+3,,AUTO
         2 000761   200013 631500                    EPPR1   ARS,,AUTO
         2 000762   200042 451500                    STP1    TYPE_CODE+2,,AUTO
         2 000763   200042 630500                    EPPR0   TYPE_CODE+2,,AUTO
         2 000764   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000765   000000 701000 xent               TSX1    ASL$DISP_ONE_PROFILE
         2 000766   000000 011000                    NOP     0

      366    15268    3         END; /*  If disp  */

  15268  2 000767   001030 710000 2                  TRA     s:15280

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:52   
      367    15269    3      ELSE DO;

      368    15270    4         IF DISP_PROFILES = 0 THEN DO;

  15270  2 000770   200020 235100                    LDA     DISP_PROFILES,,AUTO
         2 000771   001007 601000 2                  TNZ     s:15275

      369    15271    4            CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_PROFILE,0,I));

  15271  2 000772   000064 220000 1                  LDX0    DISPLAY_STR+7
         2 000773   000000 740000 xsym               STX0    FMT_BUF
         2 000774   200006 721100                    LXL1    I,,AUTO
         2 000775   040000 100540                    MLR     fill='040'O
         2 000776   200031 000011                    ADSC9   CURRENT_PROFILE,,AUTO    cn=0,n=*X1
         2 000777   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      370    15272    4            FDS.FMT_.BOUND = I+1 ;

  15272  2 001000   200006 236100                    LDQ     I,,AUTO
         2 001001   000001 036007                    ADLQ    1,DL
         2 001002   000020 736000                    QLS     16
         2 001003   000000 676000 xsym               ERQ     FDS
         2 001004   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001005   000000 656000 xsym               ERSQ    FDS

      371    15273    4            END; /*  DISP_PROFILES = 0  */

  15273  2 001006   001024 710000 2                  TRA     s:15278

      372    15274    4         ELSE DO;

      373    15275    4            CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_PROFILE,0,I));

  15275  2 001007   040000 100400                    MLR     fill='040'O
         2 001010   000065 000010 1                  ADSC9   DISPLAY_STR+8            cn=0,n=8
         2 001011   000000 000010 xsym               ADSC9   FMT_BUF                  cn=0,n=8
         2 001012   200006 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:53   
         2 001013   040000 100540                    MLR     fill='040'O
         2 001014   200031 000010                    ADSC9   CURRENT_PROFILE,,AUTO    cn=0,n=*X0
         2 001015   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      374    15276    4            FDS.FMT_.BOUND = I + 7;

  15276  2 001016   200006 236100                    LDQ     I,,AUTO
         2 001017   000007 036007                    ADLQ    7,DL
         2 001020   000020 736000                    QLS     16
         2 001021   000000 676000 xsym               ERQ     FDS
         2 001022   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 001023   000000 656000 xsym               ERSQ    FDS

      375    15277    4            END; /*  Else  */

      376    15278    3         CALL X$FORMAT (FDS);

  15278  2 001024   000006 630400 3                  EPPR0   6
         2 001025   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001026   000000 701000 xent               TSX1    X$FORMAT
         2 001027   000000 011000                    NOP     0

      377    15279    3         END; /*  Else  disp  */

      378    15280    2      DISP_PROFILES = DISP_PROFILES + 1;

  15280  2 001030   200020 054100                    AOS     DISP_PROFILES,,AUTO

      379    15281    2      END;  /*  Do forever  */

  15281  2 001031   000601 710000 2                  TRA     READ_PRO

      380    15282    1   FINISH_UP:
      381    15283    2   IF NOT DISP THEN DO;

  15283  2 001032   200016 234100       FINISH_UP    SZN     DISP,,AUTO
         2 001033   001051 604000 2                  TMI     s:15290
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:54   

      382    15284    2      FMT_BUF = '%\%/';

  15284  2 001034   040000 100400                    MLR     fill='040'O
         2 001035   000067 000004 1                  ADSC9   DISPLAY_STR+10           cn=0,n=4
         2 001036   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      383    15285    2      FDS.FMT_.BOUND = 3;

  15285  2 001037   000000 236000 xsym               LDQ     FDS
         2 001040   177777 376007                    ANQ     65535,DL
         2 001041   600000 276007                    ORQ     -65536,DL
         2 001042   000000 756000 xsym               STQ     FDS

      384    15286    2      FDS.NVECS# = 0;

  15286  2 001043   000011 450000 xsym               STZ     FDS+9

      385    15287    2      CALL X$FORMAT(FDS);

  15287  2 001044   000006 630400 3                  EPPR0   6
         2 001045   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001046   000000 701000 xent               TSX1    X$FORMAT
         2 001047   000000 011000                    NOP     0

      386    15288    2      END; /*  If not disp  */

  15288  2 001050   001064 710000 2                  TRA     s:15296

      387    15289    2   ELSE DO;

      388    15290    3      IF FDS.NVECS# > 0 THEN DO;

  15290  2 001051   000011 235000 xsym               LDA     FDS+9
         2 001052   001064 604400 2                  TMOZ    s:15296

      389    15291    3         CALL X$FORMAT (FDS);
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:55   

  15291  2 001053   000006 630400 3                  EPPR0   6
         2 001054   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001055   000000 701000 xent               TSX1    X$FORMAT
         2 001056   000000 011000                    NOP     0

      390    15292    3         FDS.NVECS# = 0;

  15292  2 001057   000011 450000 xsym               STZ     FDS+9

      391    15293    3         CALL ASB$WRITE_LO (' ',1);

  15293  2 001060   000011 630400 3                  EPPR0   9
         2 001061   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001062   000000 701000 xent               TSX1    ASB$WRITE_LO
         2 001063   000000 011000                    NOP     0

      392    15294    3         END;   /*  Nvecs > 0  */

      393    15295    2      END;  /*  Else  */

      394    15296    2   IF NOT JCL THEN DO;

  15296  2 001064   200017 234100                    SZN     JCL,,AUTO
         2 001065   001134 604000 2                  TMI     s:15317

      395    15297    2      FMT_VEC(0) = VECTOR (DISP_PROFILES);

  15297  2 001066   777640 235007                    LDA     -96,DL
         2 001067   200042 452500                    STP2    TYPE_CODE+2,,AUTO
         2 001070   200042 236100                    LDQ     TYPE_CODE+2,,AUTO
         2 001071   000020 036003                    ADLQ    16,DU
         2 001072   000000 755000 xsym               STA     FMT_VEC
         2 001073   000001 756000 xsym               STQ     FMT_VEC+1

      396    15298    2      IF DISP_PROFILES = 1 THEN

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:56   
  15298  2 001074   200020 235100                    LDA     DISP_PROFILES,,AUTO
         2 001075   000001 115007                    CMPA    1,DL
         2 001076   001103 601000 2                  TNZ     s:15303

      397    15299    3      DO;

      398    15300    3         FMT_VEC(1) = VECTOR (PROFILE_STR);

  15300  2 001077   000020 237000 3                  LDAQ    16
         2 001100   000002 755000 xsym               STA     FMT_VEC+2
         2 001101   000003 756000 xsym               STQ     FMT_VEC+3

      399    15301    3         END; /*  DISP_PROFILES = 1  */

  15301  2 001102   001106 710000 2                  TRA     s:15305

      400    15302    3      ELSE DO;

      401    15303    3         FMT_VEC(1) = VECTOR (PROFILES_STR);

  15303  2 001103   000022 237000 3                  LDAQ    18
         2 001104   000002 755000 xsym               STA     FMT_VEC+2
         2 001105   000003 756000 xsym               STQ     FMT_VEC+3

      402    15304    3         END; /*  DISP_PROFILES ~= 1  */

      403    15305    2      IF DISP THEN

  15305  2 001106   200016 234100                    SZN     DISP,,AUTO
         2 001107   001114 605000 2                  TPL     s:15310

      404    15306    3      DO;

      405    15307    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15307  2 001110   000024 237000 3                  LDAQ    20
         2 001111   000004 755000 xsym               STA     FMT_VEC+4
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:57   
         2 001112   000005 756000 xsym               STQ     FMT_VEC+5

      406    15308    3         END; /*  If disp  */

  15308  2 001113   001117 710000 2                  TRA     s:15312

      407    15309    3      ELSE DO;

      408    15310    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15310  2 001114   000026 237000 3                  LDAQ    22
         2 001115   000004 755000 xsym               STA     FMT_VEC+4
         2 001116   000005 756000 xsym               STQ     FMT_VEC+5

      409    15311    3         END; /*  If ~ disp  */

      410    15312    2      FDS.NVECS# = 3;

  15312  2 001117   000003 235007                    LDA     3,DL
         2 001120   000011 755000 xsym               STA     FDS+9

      411    15313    2      FMT_BUF = '   %5D %A %A.';

  15313  2 001121   040000 100400                    MLR     fill='040'O
         2 001122   000070 000015 1                  ADSC9   DISPLAY_STR+11           cn=0,n=13
         2 001123   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      412    15314    2      FDS.FMT_.BOUND = 12;

  15314  2 001124   000000 236000 xsym               LDQ     FDS
         2 001125   177777 376007                    ANQ     65535,DL
         2 001126   000003 276003                    ORQ     3,DU
         2 001127   000000 756000 xsym               STQ     FDS

      413    15315    2      CALL X$FORMAT(FDS);

  15315  2 001130   000006 630400 3                  EPPR0   6
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:58   
         2 001131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001132   000000 701000 xent               TSX1    X$FORMAT
         2 001133   000000 011000                    NOP     0

      414    15316    2      END; /* Not jcl */

      415    15317    1   RETURN;

  15317  2 001134   000000 702200 xent               TSX2  ! X66_ARET
      416    15318    1   END ASL$LIST_ALL_PROFILES;

PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:59   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_PROFILES.
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:60   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_PROFILES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    55-0-0/c CHAR(9)     r     1 DISPLAY_STR               53-0-0/c CHAR(6)     r     1 LIST_STR
    51-0-0/c CHAR(8)     r     1 PROFILES_STR              47-0-0/c CHAR(7)     r     1 PROFILE_STR
     0-0-0/w STRC(99)    r     1 TYPE_STR(0:12)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/b BIT         r     1 ALL_PROFILES              13-0-0/w UBIN        r     1 ARS
    21-0-0/w STRC(135)   r     1 BEGIN_KEY                 34-0-0/w UBIN        r     1 CODE2
    31-0-0/c CHAR(11)    r     1 CURRENT_PROFILE           16-0-0/b BIT         r     1 DISP
    20-0-0/w SBIN        r     1 DISP_PROFILES             25-0-0/w STRC(135)   r     1 END_KEY
    12-0-0/b BIT         r     1 GOT_OPTS                   6-0-0/w UBIN        r     1 I
     7-0-0/w UBIN        r     1 J                         17-0-0/b BIT         r     1 JCL
    11-0-0/w SBIN        r     1 LAST_TYPE                 35-0-0/c STRC(108)   r     1 PROFILE_NAME
    40-0-0/w UBIN        r     1 TYPE_CODE                 10-0-0/b BIT         r     1 TYPE_SPECIFIED
    14-0-0/b BIT         r     1 WILD_CARD                  3-0-0/w STRC(108)   r     1 XPNAME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w PTR         r     1 B$XL_UPPER_UR$             0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b BIT         r     1 LIST_ACCT_FLG              0-0-0/b STRC        r     1 MERR_CODE
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:61   
     0-0-0/w PTR         r     1 NODE$
     0-0-0/b BIT         r     1 PRO_FLAGS(0:280)
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(4608)  r     1 B$XL_UPPER_UR              0-0-0/w STRC(144)   r     1 P$B
     0-0-0/w ASTR(153)   r     1 P$S                        0-0-0/c STRC(720)   r     1 PRO$HDR


   Procedure ASL$LIST_ALL_PROFILES requires 605 words for executable code.
   Procedure ASL$LIST_ALL_PROFILES requires 40 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_PROFILES.:E05TSI    .
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:62   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:63   
          MINI XREF LISTING

ALL_PROFILES
     14972**DCL     15107<<ASSIGN  15109<<ASSIGN  15136>>IF
ARS
     14970**DCL     15144<<ASSIGN  15145<>CALL    15176<>CALL    15178<>CALL    15228<<ASSIGN  15229<>CALL
     15257<>CALL    15262<>CALL    15267<>CALL
ASA_BRKS_LOC
     11946**DCL     11946--REDEF
ASB$WILD_MATCH
     14826**DCL-ENT 15245--CALL
ASB$WRITE_LO
     14802**DCL-ENT 15177--CALL    15182--CALL    15266--CALL    15293--CALL
ASD$PREC_PRO
     14811**DCL-ENT 15223--CALL
ASD$READ_PRO
     14808**DCL-ENT 15145--CALL
ASD$READ_PRO_SEQ
     14805**DCL-ENT 15229--CALL
ASH$ERROR
     14814**DCL-ENT 15169--CALL    15211--CALL    15216--CALL    15234--CALL
ASH$WARN
     14817**DCL-ENT 15099--CALL
ASL$DISP_ONE_PROFILE
     14823**DCL-ENT 15178--CALL    15267--CALL
ASL$LIST_PRO_OPTS
     14820**DCL-ENT 15176--CALL    15257--CALL    15262--CALL
AS_DEFAULT.BANNER_PERM
     12639**DCL     12640--REDEF
AS_DEFAULT.BUDGET.MACCT
     12544**DCL     12548--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12557**DCL     12560--REDEF
AS_DEFAULT.BUDGET.PACCUM
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:64   
     12540**DCL     12542--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12535**DCL     12537--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12655**DCL     12656--REDEF   12657--REDEF
AS_DEFAULT_DREC.PASSWORD
     13909**DCL     13913--REDEF
AS_DEFAULT_DREC.RENAME
     13932**DCL     13933--REDEF
AS_DFLT.BANNER_PERM
     12461**DCL     12462--REDEF
AS_DFLT.BUDGET.MACCT
     12366**DCL     12370--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12379**DCL     12382--REDEF
AS_DFLT.BUDGET.PACCUM
     12362**DCL     12364--REDEF
AS_DFLT.BUDGET.PMAXC
     12357**DCL     12359--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12477**DCL     12478--REDEF   12479--REDEF
AS_FE_MODE
     11812**DCL     11813--REDEF
AS_FIELD1
     11942**DCL     15198<<ASSIGN
AS_FIELD1.COUNT
     11943**DCL     15156<<ASSIGN
AS_FIELD1.TEXT
     11943**DCL     15155<<ASSIGN
AS_FIELD2.COUNT
     11943**DCL     15154<<ASSIGN
AS_FIELD2.TEXT
     11943**DCL     15153<<ASSIGN
AS_MODE
     11809**DCL     11811--REDEF
AS_MOD_USER.ACCESS
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:65   
     14674**DCL     14675--REDEF
AS_MOD_USER.BANNER
     14661**DCL     14662--REDEF
AS_MOD_USER.BANNER_PERM
     14663**DCL     14664--REDEF
AS_MOD_USER.BILL
     14669**DCL     14670--REDEF
AS_MOD_USER.CPROC
     14665**DCL     14666--REDEF
AS_MOD_USER.FEBILL
     14745**DCL     14746--REDEF
AS_MOD_USER.FECXTMEM
     14762**DCL     14763--REDEF
AS_MOD_USER.FEMINTS
     14747**DCL     14748--REDEF
AS_MOD_USER.FEMMEM
     14758**DCL     14759--REDEF
AS_MOD_USER.FEMTIME
     14756**DCL     14757--REDEF
AS_MOD_USER.FEPPRIV
     14753**DCL     14755--REDEF
AS_MOD_USER.FEPRIV
     14750**DCL     14752--REDEF
AS_MOD_USER.FORCE_BIT
     14659**DCL     14660--REDEF
AS_MOD_USER.KEY
     14741**DCL     14743--REDEF
AS_MOD_USER.LASTCPROC
     14667**DCL     14668--REDEF
AS_MOD_USER.LIMITS.DO_
     14715**DCL     14716--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14731**DCL     14732--REDEF
AS_MOD_USER.LIMITS.LO
     14711**DCL     14712--REDEF
AS_MOD_USER.LIMITS.MEM
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:66   
     14707**DCL     14708--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14735**DCL     14736--REDEF
AS_MOD_USER.LIMITS.PDIS
     14723**DCL     14724--REDEF
AS_MOD_USER.LIMITS.PO
     14719**DCL     14720--REDEF
AS_MOD_USER.LIMITS.TDIS
     14727**DCL     14728--REDEF
AS_MOD_USER.LIMITS.TIME
     14703**DCL     14704--REDEF
AS_MOD_USER.MAXENQ
     14684**DCL     14685--REDEF
AS_MOD_USER.PERM_BIT
     14657**DCL     14658--REDEF
AS_MOD_USER.PPRIV
     14679**DCL     14681--REDEF
AS_MOD_USER.PRIOB
     14686**DCL     14687--REDEF
AS_MOD_USER.PRIV
     14676**DCL     14678--REDEF
AS_MOD_USER.QUAN
     14682**DCL     14683--REDEF
AS_MOD_USER.SETUP
     14655**DCL     14656--REDEF
AS_PROJECT.BANNER_PERM
     12995**DCL     12996--REDEF
AS_PROJECT.BUDGET.MACCT
     12900**DCL     12904--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12913**DCL     12916--REDEF
AS_PROJECT.BUDGET.PACCUM
     12896**DCL     12898--REDEF
AS_PROJECT.BUDGET.PMAXC
     12891**DCL     12893--REDEF
AS_PROJECT.SETUP_CHRA.TXT
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:67   
     13011**DCL     13012--REDEF   13013--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13173**DCL     13174--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     13078**DCL     13082--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     13091**DCL     13094--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     13074**DCL     13076--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     13069**DCL     13071--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13189**DCL     13190--REDEF   13191--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14395**DCL     14399--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14418**DCL     14419--REDEF
AS_PROJECT_DREC.PASSWORD
     14233**DCL     14237--REDEF
AS_PROJECT_DREC.RENAME
     14256**DCL     14257--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12817**DCL     12818--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12722**DCL     12726--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12735**DCL     12738--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12718**DCL     12720--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12713**DCL     12715--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12833**DCL     12834--REDEF   12835--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     14071**DCL     14075--REDEF
AS_PROJ_ADMIN_DREC.RENAME
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:68   
     14094**DCL     14095--REDEF
AS_USERS.BANNER_PERM
     12283**DCL     12284--REDEF
AS_USERS.BUDGET.MACCT
     12188**DCL     12192--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12201**DCL     12204--REDEF
AS_USERS.BUDGET.PACCUM
     12184**DCL     12186--REDEF
AS_USERS.BUDGET.PMAXC
     12179**DCL     12181--REDEF
AS_USERS.SETUP_CHRA.TXT
     12299**DCL     12300--REDEF   12301--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13351**DCL     13352--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13256**DCL     13260--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13269**DCL     13272--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13252**DCL     13254--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13247**DCL     13249--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13367**DCL     13368--REDEF   13369--REDEF
B$XL_UPPER_UR
      5512**DCL     15081>>CALLBLT
B$XL_UPPER_UR$
      5511**DCL      5512--IMP-PTR 15081>>CALLBLT
BEGIN_KEY
     14976**DCL     15140>>ASSIGN
BEGIN_KEY.COUNT
     14977**DCL     15114<<ASSIGN
BEGIN_KEY.TEXT
     14978**DCL     15110<<ASSIGN  15113<<ASSIGN
CODE
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:69   
     11939**DCL     15018<<ASSIGN  15029>>DOSELCT 15048>>ASSIGN
CODE2
     14983**DCL     15051<<ASSIGN  15053>>DOSELCT
CURRENT_PROFILE
     14982**DCL     15242<<ASSIGN  15245<>CALL    15247>>IF      15271>>CALLBLT 15275>>CALLBLT
DISP
     14973**DCL     15033<<ASSIGN  15038<<ASSIGN  15048<<ASSIGN  15174>>IF      15253>>IF      15283>>IF
     15305>>IF
DISPLAY_STR
     15012**DCL     15307--ASSIGN
DISP_PROFILES
     14975**DCL     15023<<ASSIGN  15270>>IF      15280<<ASSIGN  15280>>ASSIGN  15297--ASSIGN  15298>>IF
DSEG1$
     11947**DCL     15145>>CALL    15148>>IF      15153>>ASSIGN  15154>>ASSIGN  15229>>CALL    15239>>IF
     15255>>IF      15258>>ASSIGN
DSEG1SIZE
     11948**DCL     15144>>ASSIGN  15228>>ASSIGN
END_KEY.COUNT
     14980**DCL     15116<<ASSIGN
END_KEY.TEXT
     14981**DCL     15111<<ASSIGN  15115<<CALLBLT 15247>>IF
ERR_CODE
     11941**DCL     11942--REDEF
FDS
     11838**DCL     15134<>CALL    15180<>CALL    15188<>CALL    15278<>CALL    15287<>CALL    15291<>CALL
     15315<>CALL
FDS.FMT_.BOUND
     11843**DCL     15127<<ASSIGN  15131<<ASSIGN  15187<<ASSIGN  15272<<ASSIGN  15276<<ASSIGN  15285<<ASSIGN
     15314<<ASSIGN
FDS.NVECS#
     11866**DCL     15124<<ASSIGN  15179>>IF      15181<<ASSIGN  15286<<ASSIGN  15290>>IF      15292<<ASSIGN
     15312<<ASSIGN
FDS.TABDFLT#
     11904**DCL     15133<<ASSIGN
FINISH_UP
     15283**LABEL   15232--GOTO    15248--GOTO
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:70   
FMT_BUF
     11937**DCL     15126<<CALLBLT 15130<<CALLBLT 15186<<CALLBLT 15271<<CALLBLT 15275<<CALLBLT 15284<<ASSIGN
     15313<<ASSIGN
FMT_VEC
     11937**DCL     15297<<ASSIGN  15300<<ASSIGN  15303<<ASSIGN  15307<<ASSIGN  15310<<ASSIGN
GOT_OPTS
     14969**DCL     15025<<ASSIGN  15039<<ASSIGN  15260>>IF      15263<<ASSIGN
I
     14965**DCL     15050<<DOINDEX 15051>>ASSIGN  15057>>ASSIGN  15057>>ASSIGN  15058>>ASSIGN  15062>>ASSIGN
     15062>>ASSIGN  15063>>ASSIGN  15067>>ASSIGN  15112<<CALLBLT 15113>>ASSIGN  15115>>CALLBLT 15116>>ASSIGN
     15241<<ASSIGN  15242>>ASSIGN  15245<>CALL    15271>>CALLBLT 15272>>ASSIGN  15275>>CALLBLT 15276>>ASSIGN
J
     14966**DCL     15244<<ASSIGN  15245<>CALL
JCL
     14974**DCL     15019<<ASSIGN  15034<<ASSIGN  15041<<ASSIGN  15043<<ASSIGN  15072<<ASSIGN  15125>>IF
     15176<>CALL    15178<>CALL    15262<>CALL    15267<>CALL    15296>>IF
KL_DEFAULT.PASSWORD
     14557**DCL     14561--REDEF
KL_DEFAULT.RENAME
     14580**DCL     14581--REDEF
KL_DFLT.PASSWORD
     13747**DCL     13751--REDEF
KL_DFLT.RENAME
     13770**DCL     13771--REDEF
KL_DREC.PASSWORD
     13585**DCL     13589--REDEF
KL_DREC.RENAME
     13608**DCL     13609--REDEF
KL_DREC_CNT.PASSWORD
     13472**DCL     13476--REDEF
KL_DREC_CNT.RENAME
     13495**DCL     13496--REDEF
LAST_TYPE
     14968**DCL     15027<<ASSIGN  15255>>IF      15258<<ASSIGN
LIST_ACCT_FLG
     11939**DCL     15026<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:71   
LIST_STR
     15011**DCL     15310--ASSIGN
MERR_CODE
     11942**DCL     15216<>CALL    15234<>CALL
MERR_CODE.CODE
     11942**DCL     15192>>IF      15231>>IF
MERR_CODE.SEV
     11942**DCL     15233<<ASSIGN
NODE$
     11939**DCL     14882--IMP-PTR
P$B.CODE
     14890**DCL     15018>>ASSIGN  15041>>ASSIGN  15043>>ASSIGN  15051>>ASSIGN  15067>>ASSIGN
P$B.NSUBLKS
     14894**DCL     15040>>IF      15042>>IF      15050>>DOINDEX
P$B.SUBLK$
     14915**DCL     15018>>ASSIGN  15040>>IF      15041>>ASSIGN  15041>>ASSIGN  15042>>IF      15043>>ASSIGN
     15043>>ASSIGN  15051>>ASSIGN  15057>>ASSIGN  15057>>ASSIGN  15058>>ASSIGN  15062>>ASSIGN  15062>>ASSIGN
     15063>>ASSIGN  15067>>ASSIGN  15067>>ASSIGN
P$S.COUNT
     14951**DCL     14954--IMP-SIZ 15057>>ASSIGN  15058>>ASSIGN  15062>>ASSIGN  15063>>ASSIGN
P$S.TEXT
     14954**DCL     15057>>ASSIGN  15062>>ASSIGN
PRO$HDR
     14847**DCL     15145<>CALL    15229<>CALL
PRO$HDR.TTYP
     14848**DCL     15148>>IF      15153>>ASSIGN  15154>>ASSIGN  15239>>IF      15255>>IF      15258>>ASSIGN
PROFILES_STR
     15010**DCL     15126>>CALLBLT 15127--ASSIGN  15130>>CALLBLT 15131--ASSIGN  15303--ASSIGN
PROFILE_NAME
     14985**DCL     15080>>ASSIGN  15088<<ASSIGN  15143>>ASSIGN  15198>>ASSIGN
PROFILE_NAME.COUNT
     14986**DCL     15022<<ASSIGN  15058<<ASSIGN  15063<<ASSIGN  15081>>CALLBLT 15083>>IF      15186>>CALLBLT
     15187>>ASSIGN  15244>>ASSIGN
PROFILE_NAME.TEXT
     14987**DCL     15021<<ASSIGN  15057<<ASSIGN  15062<<ASSIGN  15081>>CALLBLT 15083>>IF      15106>>IF
     15112>>CALLBLT 15113>>ASSIGN  15115>>CALLBLT 15186>>CALLBLT 15245<>CALL
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:72   
PROFILE_STR
     15009**DCL     15300--ASSIGN
PROJ_KEY.TEXT
     11819**DCL     11819--REDEF
PROJ_KEY.TXT.PROJECT
     11819**DCL     11819--REDEF
PRO_FLAGS
     15013**DCL     15265>>IF
P_PCB.OUT$
     11987**DCL     15018>>ASSIGN  15040>>IF      15041>>ASSIGN  15042>>IF      15043>>ASSIGN  15050>>DOINDEX
     15051>>ASSIGN  15057>>ASSIGN  15057>>ASSIGN  15058>>ASSIGN  15062>>ASSIGN  15062>>ASSIGN  15063>>ASSIGN
     15067>>ASSIGN
READ_PRO
     15223**LABEL   15240--GOTO    15250--GOTO
REMEM_VAR
     11945**DCL     11945--REDEF
REM_FCMD
     11945**DCL     11946--REDEF
TYPE_CODE
     14988**DCL     15067<<ASSIGN  15148>>IF      15155>>ASSIGN  15156>>ASSIGN  15239>>IF
TYPE_SPECIFIED
     14967**DCL     15024<<ASSIGN  15068<<ASSIGN  15147>>IF      15238>>IF      15255>>IF      15260>>IF
TYPE_STR.COUNT
     14994**DCL     15154>>ASSIGN  15156>>ASSIGN
TYPE_STR.TEXT
     14995**DCL     15153>>ASSIGN  15155>>ASSIGN
USERS_KEY
     11816**DCL     15137<<ASSIGN  15140<<ASSIGN  15143<<ASSIGN  15145<>CALL    15223<>CALL    15229<>CALL
USERS_KEY.COUNT
     11816**DCL     15241>>ASSIGN
USERS_KEY.TEXT
     11816**DCL     11817--REDEF   11817--REDEF   11817--REDEF   11818--REDEF
USERS_KEY.TXTC
     11817**DCL     15242>>ASSIGN
WILD_CARD
     14971**DCL     15020<<ASSIGN  15117<<ASSIGN  15120<<ASSIGN  15139>>IF      15243>>IF
PL6.E3A0      #001=ASL$LIST_ALL_PROFILES File=ASL$LIST_PROFILES.:E05TSI          TUE 07/29/97 10:17 Page:73   
X$FORMAT
     14828**DCL-ENT 15134--CALL    15180--CALL    15188--CALL    15278--CALL    15287--CALL    15291--CALL
     15315--CALL
XPNAME
     14962**DCL     15080<<ASSIGN  15088>>ASSIGN
XPNAME.CNT
     14963**DCL     15083>>IF
XPNAME.TXT
     14964**DCL     15081<<CALLBLT 15083>>IF
