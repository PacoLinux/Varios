VERSION E05

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:1    
        1        1        /*M* SSQ$QEND     QUANTUM END AND ASYNCHRONOUS EVENT PROCESSING       */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC    */
        8        8        /*                                                                    */
        9        9        SSQ$QEND: PROC ALTRET;
       10       10        /*                                                                    */
       11       11    1   DCL   SSS$BLOCK ENTRY;
       12       12    1   DCL   SSC$MON ENTRY;
       13       13    1   DCL   SSS$LDT ENTRY(1);
       14       14    1   DCL SSC$SERV ENTRY;
       15       15    1   DCL UDN$MAGIC ENTRY;
       16       16    1   DCL UDN$MAGICSS ENTRY;
       17       17    1   DCL UDN$MAGICLS ENTRY;
       18       18    1   DCL UDN$BLDASR ENTRY;
       19       19    1   DCL   HFC$ASSOCCLR ENTRY;
       20       20    1   DCL   HFC$CACHECLR ENTRY;
       21       21    1   DCL   SC_UTIMER ENTRY CONV(2,0);
       22       22    1   DCL   SSS$PUF ENTRY;                    /* DELETE MAGIK SEG FROM AS           */
       23       23    1   DCL   SSS$LTRD ENTRY(1);                /* PERFORM LTRAD                      */
       24       24    1   DCL   SSS$CACHEBP ENTRY;                /* Bypass cache                       */
       25       25    1   DCL   SSS$CACHE ENTRY;                  /* Re-enable cache                    */
       26       26    1   DCL   SST$SSFTCB ENTRY(6) ALTRET;       /* MOVE SS FRAME TO TCB               */
       27       27    1   DCL SSU$DELTAGO ENTRY(3);               /* MOVE SS FRAME TO DELTA TCB & GO    */
       28       28    1   DCL   SSV$XXDO ENTRY(3) ALTRET;         /* DELETE DO LIST ENTRY               */
       29       29    1   DCL   FMF$TYC ENTRY(2);                 /* CONVERT TYC TO ERROR CODE          */
       30       30    1   DCL   JSE$ACP ENTRY;                    /* ASSOC COMMAND PROCESSOR            */
       31       31    1   DCL   JSE$ABORTM ENTRY;                 /* TERMINATE JOB STEP                 */
       32       32    1   DCL   JSE$ABORTX ENTRY;                 /* TERMINATE USER                     */
       33       33    1   DCL JST$CPEXIT ENTRY(5);                /* Initial user entry                 */
       34       34    1   DCL     SC_ASLEVNT ENTRY CONV(2,0);
       35       35    1   DCL KIF$LDTRC ENTRY(1) ALTRET;
       36       36        /*                                                                    */
       37       37    1   DCL   J_LOGON CHAR(8) SYMREF READONLY;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:2    
       38       38    1   DCL   J_SYSTXT CHAR(8) SYMREF READONLY;
       39       39    1   DCL   S_PNO SBIN SYMREF;
       40       40    1   DCL   S_CUN SBIN SYMREF;
       41       41    1   DCL   S_DL$ PTR  SYMREF;
       42       42    1   DCL   S_UXTSCHD UBIN SYMREF;
       43       43    1   DCL   S_USTSCHD UBIN SYMREF;
       44       44    1   DCL   B$JIT$ PTR SYMREF READONLY;
       45       45    1   DCL   B$LS$ PTR SYMREF READONLY;
       46       46    1   DCL   B$MLS1$ PTR SYMREF READONLY;
       47       47    1   DCL   B$MISC2$ PTR SYMREF READONLY;
       48       48    1   DCL   B$SDS0$ PTR SYMREF READONLY;
       49       49    1   DCL   B$USERLS$ PTR SYMREF READONLY;
       50       50        /*                                                                    */
       51       51    1   DCL   I UBIN(36);                       /* TEMP                               */
       52       52    1   DCL   J UBIN(36);                       /* TEMP                               */
       53       53        /*                                                                    */
       54       54    1   DCL   RTIME SBIN;                       /* TEMP TIME                          */
       55       55    1   DCL   EXC UBIN(36);                     /* TEMP                               */
       56       56    1   DCL   D$ PTR;                           /* TEMP DO LIST PTR                   */
       57       57    1   DCL   DD$ PTR;                          /*    "                               */
       58       58    1   DCL   ECINFO(0:3) UBIN;                 /* TEMP ECC INFO FOR BREAK AND UTIMER */
       59       59    1   DCL   ASFLAGS BIT(36);                  /* TEMP ASYNCH FLAGS                  */
       60       60    1   DCL  PRIODEC UBIN(36) CONSTANT INIT(1); /*                                    */
       61       61        /*                                                                    */
       62       62        /*                                                                    */
       63       63    1   DCL B$$WORD UBIN WORD BASED ALIGNED;
       64       64        /**/
       65       65        %INCLUDE JM$STRUCT;
       66      810        %INCLUDE B$JIT;
       67     1413        %INCLUDE B$USER;
       68     1629        %B$USERREFS;
       69     1633        %INCLUDE SS_SCHED_C;
       70     1866        %INCLUDE SS_SCHED_R;
       71     1909        %INCLUDE B_UHJMAC_C;
       72     2238        %INCLUDE B_ULSMAC_C;
       73     3347        %INCLUDE B_MLSMAC_C;
       74     4289        %B_USRULS (FPTN=B$ULNK,STCLASS=BASED);
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:3    
       75     4488        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
       76     5303        %B_USDS (FPTN=B$SDS,STCLASS=BASED);
       77     5355        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
       78     5410        %INCLUDE UE_CP6;
       79     6101        %INCLUDE B$SS;
       80     6280        %INCLUDE B$P;
       81     6364        %INCLUDE UE_ERRORS_C;
       82     6382        %INCLUDE J_ERRORS_C;
       83     6469        %INCLUDE F_CODE_R;
       84     6479        %INCLUDE JMA_DATA_R;
       85     6488        %INCLUDE JM_CNTRL_R;
       86     7377        %INCLUDE HF_LOCK_C;
       87     7391        %INCLUDE HF_DATA_R;
       88     7434        %INCLUDE P_PMDAT_R;
       89     7742        %INCLUDE B_MACROS_C;
       90     7853        %T01DESCR (NAME=B$$DESCR);
       91     7861        %ENTDESCR;
       92     7871        %INCLUDE B_MAGIC_C;
       93     7989        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
       94     8082        /**/
       95     8083        %B$ECCB;
       96     8091        %B$EVNT;
       97     8104        %B$ECCBI;
       98     8107        %B$BRK;
       99     8115        %SUB_ECCDELTA;
      100     8152        /**/
      101     8153        %SUB TIMER=0/*UTIMER*/;
      102     8154        %SUB EVENT=1/*EVENT*/;
      103     8155        %SUB BREAK=2/*BREAK*/;
      104     8156        %SUB DTABRK=3;
      105     8157        /**/
      106     8158        %SUB SS$=B_MPT.SS$;
      107     8159        %SUB TCB$=B_MPT.TCB$;
      108     8160        %SUB ECCB$=B_MPT.ECCB$;
      109     8161        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:4    
      110     8162        /*                RETURNING TO THE USER.                              */
      111     8163    1         IF (S$CU$->B$U.FLG & %(%U_MSTR | %U_DBRK))
      112     8164    1            OR (B$JIT.RNST|S$CU$->B$U.ASYNCH)
      113     8165    1            OR (S$CU$->B$U.DL$~=ADDR(NIL))
      114     8166    1            OR (B$JIT.UTIMER~=0)
      115     8167    2         THEN DO;
      116     8168
      117     8169                      /* If Master Only is set, reset it and park user if a
      118     8170                         specific CPU is required.  Let SSX figure out which
      119     8171                         CPU to run him on.                                */
      120     8172
      121     8173    2            IF S$CU$->B$U.FLG.MSTR
      122     8174    3            THEN DO;
      123     8175    3               S$CU$->B$U.FLG.MSTR = '0'B;
      124     8176    3               IF S$CU$->B$U.CPU ~= 0
      125     8177    4               THEN DO;
      126     8178    4                  CALL SSC$MON;
      127     8179    4                  ALTRETURN;
      128     8180    4                  END;
      129     8181    3               END;
      130     8182                      /* Check for asynchronous events, Quantum End or QMIN
      131     8183                         expiration.                                       */
      132     8184
      133     8185    2   SE4:     IF B$JIT.RNST|(S$CU$->B$U.ASYNCH & ~%U_CACHE) THEN
      134     8186    2               GOTO SE7;
      135     8187    2            IF S$CU$->B$U.DL$~=ADDR(NIL) THEN
      136     8188    3            DO;
      137     8189    3   SE5:        ;
      138     8190                            %LOCK (G#=S_UDLGATE);
      139     8193    3               IF S$CU$->B$U.DL$ ~= ADDR(NIL) AND
      140     8194    3                  B$JIT.STIME+B$JIT.XTIME+B$JIT.CTIME < B$JIT.IDELTAT AND
      141     8195    3                  NOT (B$JIT.JUNK & %JJ_EVENT#) THEN
      142     8196    3                  GOTO SE6;
      143     8197    3   SE51:       ;
      144     8198                            %UNLOCK (G#=S_UDLGATE);
      145     8201    3               END;
      146     8202        /*                CHECK FOR USER UTIMER RUNOUT                        */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:5    
      147     8203    2            IF B$JIT.UTIMER~=0 THEN
      148     8204    3            DO;
      149     8205    3               B$LS$->B$MLNK.MISC2=B$USERLS$->B$ULNK.ECCB;
      150     8206    3               IF B$MISC2$->B$ECCB.FLAGS.TMRSET AND (B$JIT.UTIMER<=(B$JIT.XTIME
      151     8207    3                  +B$JIT.STIME)) THEN
      152     8208    4               DO;
      153     8209    4                  I=7;
      154     8210    4                  EXC=0;
      155     8211    4                  GOTO SE72;
      156     8212    4                  END;
      157     8213    3               END;
      158     8214        /*                CHECK FOR DATA BREAKPOINT                           */
      159     8215    2            IF S$CU$->B$U.FLG.DBRK THEN
      160     8216    3            DO;
      161     8217    3               EXC=DTABRK;
      162     8218    3               S$CU$->B$U.FLG.DBRK = '0'B;
      163     8219    3               GOTO SE72;
      164     8220    3               END;
      165     8221    2            END;
      166     8222        /*                COMPUTE TIME REMAINING IN QUANTUM                   */
      167     8223    1   SE1A: RTIME=B$JIT.IDELTAT-B$JIT.STIME-B$JIT.XTIME-B$JIT.CTIME;
      168     8224    1         B$JIT.JUNK = B$JIT.JUNK & ~%JJ_EVENT#;
      169     8225    1         IF RTIME <= 0 THEN              /* CHECK FOR QUANTUM END              */
      170     8226    2         DO INHIBIT;                  /* INHIBIT UNTIL PARKED               */
      171     8227    2            CALL SSC$MON;             /* MONITOR RUNNING                    */
      172     8228    2            CALL ACCTEX;              /* GIVE HIM A NEW QUANTUM             */
      173     8229    2            S$CU$->B$U.PRIO=S$CU$->B$U.PRIOB;
      174     8230    2            ALTRETURN;                /* RETURN TO BLOCK HIM AND RESCHED    */
      175     8231    2            END;
      176     8232        /*                COMPUTE TIME SINCE LAST SCHEDULED. IF ITS GREATER   */
      177     8233        /*                THAN QMIN AND A HIGHER PRIORITY USER IS WAITING     */
      178     8234        /*                PARK THIS GUY IN HIS FAVOR.                         */
      179     8235    1         IF S_HIR > 0 THEN
      180     8236    2         DO;
      181     8237        /*                 COMPUTE TIME SINCE QMIN.                                  */
      182     8238    2            RTIME=SL_QMIN(B$JIT.MODE)-(B$JIT.IDELTAT-B$JIT.SCHTIME-RTIME);
      183     8239    2            IF RTIME <= 0 THEN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:6    
      184     8240    3            DO INHIBIT;
      185     8241    3               S_HIR=0;
      186     8242    3               CALL SSC$MON;
      187     8243    3               ALTRETURN;
      188     8244    3               END;
      189     8245        /*                  IF QMIN HASN'T EXPIRED SET TRO TO GO OFF AT QMIN         */
      190     8246    2            END;
      191     8247        /*                  IF NO HIGH PRIO GUY IS WAITING SET TRO TO GO OFF AT QUAN */
      192     8248    1         CALL SSS$LDT(RTIME);
      193     8249    1         RETURN;                         /* NORMAL RETURN TO CONTINUE USER     */
      194     8250        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:7    
      195     8251        /*         PROCESS EVENT STUFF ON DO LIST                             */
      196     8252        /*                                                                    */
      197     8253    1   SE6:  D$=S$CU$->B$U.DL$;
      198     8254    1   SE61: IF D$ = ADDR(NIL) THEN GOTO SE51;
      199     8255    1         IF D$->B$DO.BUSY = '1'B THEN
      200     8256    2         DO;
      201     8257    2            D$=D$->B$DO.LNK$;
      202     8258    2            GOTO SE61;
      203     8259    2            END;
      204     8260                %UNLOCK (G#=S_UDLGATE);
      205     8263    1         S_HIR=0;                        /* DON'T INTERRUPT THIS GUY           */
      206     8264                %LOCK (G#=S_ASFGATE);
      207     8267    1         IF S$CU$->B$U.ASYNCH & %U_CACHE THEN
      208     8268    2         DO;
      209     8269    2            S$CU$->B$U.ASYNCH=S$CU$->B$U.ASYNCH & ~%U_RESET;
      210     8270    2            IF D$->B$DO.SCHDDO THEN
      211     8271    3            DO;
      212     8272    3               D$->B$DO.SCHDDO='0'B;
      213     8273    3               CALL HFC$ASSOCCLR;
      214     8274    3               END;
      215     8275    2            CALL HFC$CACHECLR;
      216     8276    2            END;
      217     8277                %UNLOCK (G#=S_ASFGATE);
      218     8280    1         I=D$->B$DO.WSR;                 /* DOMAIN IDENTIFIER                  */
      219     8281    1         EXC=1;                          /* EVENT CODE                         */
      220     8282    1         DD$=D$;                         /* SAVE ENTRY POINTER FOR DELETE      */
      221     8283    1         IF D$->B$DO.ENTER ~= ENTADDR(NIL) THEN
      222     8284    2         DO;
      223     8285    2            CALL D$->B$DO.ENTER(D$) ALTRET(SE91); /* CALL SYSTEM EVENT PROC */
      224     8286    2            D$->B$DO.ENTER=ENTADDR(NIL); /* ONLY ONCE                       */
      225     8287    2            END;
      226     8288    1         IF D$->B$DO.ECCSC = %EVSC_IO# THEN
      227     8289    2         DO;                          /* convert TYC to error code          */
      228     8290    2            CALL FMF$TYC(D$->B$DO.IOCOMP,D$->B$DO.ERRC);
      229     8291    2            IF D$->B$DO.ERRC THEN
      230     8292    2               D$->B$DO.ERRC = D$->B$DO.ERRC | '000000400000'O;
      231     8293    2            END;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:8    
      232     8294    1         D$=ADDR(D$->B$DO.BUSY);         /* PTR TO ECC INFO FOR SSFTCB         */
      233     8295    1         GOTO SE8;
      234     8296        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:9    
      235     8297        /*         PROCESS ASYNCH FLAGS AND RUN STATUS                        */
      236     8298        /*                                                                    */
      237     8299    1   SE7:  ;
      238     8300    1         CALL SSC$SERV;
      239     8301              %LOCK (G#=S_ASFGATE);
      240     8304    1         ASFLAGS=S$CU$->B$U.ASYNCH;
      241     8305    2         IF ASFLAGS & %U_FPLDTRC THEN DO;
      242     8306    2            S$CU$->B$U.ASYNCH = S$CU$->B$U.ASYNCH & ~%U_FPLDTRC;
      243     8307                   %UNLOCK (G#=S_ASFGATE);
      244     8310
      245     8311                   /* If the LDTRC flag was set, look through the DOLIST events
      246     8312                      for those types of events.                            */
      247     8313
      248     8314    2   SE70:    ;
      249     8315                   %LOCK (G#=S_UDLGATE);
      250     8318    2            D$=S$CU$->B$U.DL$;
      251     8319    3            DO WHILE (D$ ~= ADDR(NIL));
      252     8320    4               IF D$->B$DO.ENTER = ENTADDR(KIF$LDTRC) THEN DO;
      253     8321                         %UNLOCK (G#=S_UDLGATE);
      254     8324    4                  CALL KIF$LDTRC (D$);
      255     8325    4                  D$->B$DO.ENTER = ENTADDR(NIL);
      256     8326    4                  CALL SSV$XXDO (0,D$);
      257     8327    4                  GOTO SE70;
      258     8328    4                  END;
      259     8329    4               ELSE DO;
      260     8330    5                  IF D$->B$DO.CONT THEN DO;
      261     8331    5                     D$=D$->B$DO.LNK$;
      262     8332    5                     END;
      263     8333    4                  D$=D$->B$DO.LNK$;
      264     8334    4                  END;
      265     8335    3               END;
      266     8336                   %UNLOCK (G#=S_UDLGATE);
      267     8339
      268     8340                   /* After all the LDTRC events are processed, go back and
      269     8341                      begin asynch checks again.                           */
      270     8342
      271     8343    2            GOTO SE4;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:10   
      272     8344    2            END;
      273     8345
      274     8346    1         S$CU$->B$U.ASYNCH=S$CU$->B$U.ASYNCH & %U_RESET; /* CLEAR FLAGS        */
      275     8347                %UNLOCK (G#=S_ASFGATE);
      276     8350        /*         CHECK FOR LINE DISCONNECT                                  */
      277     8351    1         IF ASFLAGS & %U_DISC
      278     8352    2         THEN DO;
      279     8353    2            CALL ABORTEX(3);
      280     8354    2            END;
      281     8355        /*         CHECK FOR ABORT KEYIN                                      */
      282     8356    1         IF ASFLAGS & %U_ABRT THEN
      283     8357    1            CALL ABORTEX(0);
      284     8358        /*         CHECK IF CANCELED BY USER                                  */
      285     8359    1         IF ASFLAGS & %U_CNCLD THEN
      286     8360    2         DO;
      287     8361    2            S$CU$->B$U.FLG.CAN = '1'B;
      288     8362    2            CALL ABORTEX(1);
      289     8363    2            END;
      290     8364        /*         CHECK FOR ERR KEYIN                                        */
      291     8365    1         IF ASFLAGS & %U_ERR THEN
      292     8366    1            CALL ABORTEX(1);
      293     8367        /*          CHECK FOR MONITOR LOGOFF             */
      294     8368    1         IF B$JIT.RNST & %RS_OFF# THEN
      295     8369    1            CALL ABORTEX(4);
      296     8370        /*         CHECK FOR LIMIT EXCEEDED AND NOT IN COMMAND PROCCESSOR     */
      297     8371    1         IF B$JIT.RNST & %RS_LIMX# THEN
      298     8372    1            IF NOT S$CU$->B$U.FLG.CPIC THEN
      299     8373    1               CALL ABORTEX(2);
      300     8374        /*         CHECK FOR YC.   CALL CPEXIT FOR INITIAL ENTRY IF YC AND CPIC  */
      301     8375        /*         ARE SET BUT ACP IS ZERO.  IGNORE YC IF CPIC WITH ACP NON ZERO */
      302     8376        /*         OR BATCH.                                                  */
      303     8377    1         IF ASFLAGS & %U_YC THEN
      304     8378    2         DO;
      305     8379    2            IF S$CU$->B$U.FLG.CPIC THEN
      306     8380    2               IF S$CU$->B$U.ACP = 0 THEN
      307     8381    3               DO;
      308     8382    3                  CALL SSS$BLOCK;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:11   
      309     8383    3                  CALL SSC$SERV;
      310     8384    3                  CALL JST$CPEXIT(ADDR(J_LOGON),
      311     8385    3                     ADDR(J_SYSTXT),ADDR(NIL),ADDR(NIL),ADDR(NIL));
      312     8386    3                  END;
      313     8387    2               ELSE
      314     8388    2                  IF B$JIT.STEPS = 0 AND NOT(S$CU$->B$U.FLG.CPIC)
      315     8389    2                  THEN
      316     8390    2                     GOTO SE1A;           /* Don't let user out of first CP */
      317     8391    2                  ELSE
      318     8392    2                     GOTO SE71;
      319     8393    2            IF S$CU$->B$U.MODE = %M_BATCH# THEN
      320     8394    2               GOTO SE1A;
      321     8395    2   SET_YC:  B$JIT.CPFLAGS1=B$JIT.CPFLAGS1 | %CP_YC#;
      322     8396    2            CALL SSS$BLOCK;
      323     8397    2            CALL SSC$SERV;
      324     8398    2            CALL UDN$MAGIC;
      325     8399    2            CALL JSE$ACP;             /* GET THE COMMAND PROCESSOR          */
      326     8400    2            END;
      327     8401        /*         CHECK FOR BREAK.  CONTINUE USER IF NOT SET.                */
      328     8402    1         IF (ASFLAGS & %U_BRK) = '0'B THEN GOTO SE1A;
      329     8403    1   SE71: EXC=2;
      330     8404    1   SE72: D$=ADDR(ECINFO(0));             /* ECC INFO FOR BREAKS                */
      331     8405    1         IF ASFLAGS & %U_YC THEN
      332     8406    1            ECINFO(0)=%SC_BYC#;     /* Set YC code if going to CP break proc   */
      333     8407    1         ELSE
      334     8408    1            ECINFO(0)=%SC_BRK#;          /* Set Break code                     */
      335     8409    1         ECINFO(2)=BITBIN(B$JIT.ERR);
      336     8410    1         ECINFO(3)=0;
      337     8411    1         ECINFO(1)=S$CU$->B$U.BRKCNT;
      338     8412        /*                                                                    */
      339     8413    1   SE8:  CALL UDN$MAGIC;
      340     8414    1   SE80: ;
      341     8415    2         DO CASE (EXC);
      342     8416    2          CASE(TIMER,EVENT);
      343     8417    2            IF SS$->B$SS.ISR.WSR ~= I THEN GOTO SE82;
      344     8418    2            IF ECCB$->B$ECCBI.FLAGS(EXC) THEN
      345     8419    3            DO;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:12   
      346     8420    3               IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN
      347     8421    3                  IF S$CU$->B$U.FLG.DELA AND (I=7) AND (B$JIT.JUNK&%JJ_UDELTA#) THEN
      348     8422    3                     GOTO SE83;
      349     8423    3                  ELSE ;
      350     8424    3               ELSE
      351     8425    3                  IF I > 5 THEN GOTO SE1A;
      352     8426    3               IF SS$->B$SS.TCBFLG = 0 THEN
      353     8427    4   SE84:       DO;
      354     8428    4                  J=ECCB$->B$ECCBI.ECIC(EXC);
      355     8429    4                  CALL SST$SSFTCB(J,EXC,D$->B$$WORD,SS$,TCB$) ALTRET(SE9);
      356     8430    4                  SS$->B$SS.TCBFLG = EXC;
      357     8431    5                  DO CASE(EXC);
      358     8432    5                   CASE(TIMER);
      359     8433    5                     ECCB$->B$ECCBI.FLAGS(0)='0'B;
      360     8434    5                     B$JIT.UTIMER=0;
      361     8435    5                   CASE(EVENT);
      362     8436    5                     CALL SSV$XXDO(0,DD$);
      363     8437    5                   END;
      364     8438    4                  END;
      365     8439    3               END;
      366     8440    2            ELSE
      367     8441    2               IF EXC = EVENT THEN
      368     8442    3               DO;
      369     8443    3                  IF DD$->B$DO.SAVE THEN
      370     8444    3                     GOTO SE1A;       /* RETAIN IT UNTIL HE'S READY*/
      371     8445    3                  I=B_MPT.SSDESC$->B$$DESCR.BASE; /* IF RETURNING TO        */
      372     8446    3                  CALL UDN$MAGIC;     /* DOMAIN THAT THE EVENT IS           */
      373     8447    3                  IF I ~= B_MPT.SSDESC$->B$$DESCR.BASE THEN /* FOR, GO. ELSE WAIT*/
      374     8448    3                     GOTO SE1A;       /* UNTIL GOING TO HIM.                */
      375     8449    3                  CALL SSV$XXDO(0,DD$); /* DISCARD IT                       */
      376     8450    3                  B$JIT.ERR='232321400006'O;
      377     8451        /*E*    ERROR: SSQ-E$NOEVENT-6
      378     8452                MESSAGE: No event procedure for this event                      */
      379     8453    3                  B$JIT.ERR.CODE=%E$NOEVENT;
      380     8454    3                  CALL SSS$BLOCK;
      381     8455    3                  CALL SSC$SERV;
      382     8456    3                  CALL JSE$ABORTM;    /* NO EVENT HANDLER--                 */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:13   
      383     8457    3                  END;
      384     8458    2               ELSE
      385     8459    2                  GOTO SE85;
      386     8460    2          CASE(BREAK);
      387     8461        /*         Defer breaks to user level if in M$YC pmme                 */
      388     8462    2            IF S$CU$->B$U.FLG.CPIC AND (B$JIT.CPFLAGS1 & %CP_YCPMME#)
      389     8463    2               AND ECINFO(0) = %SC_BRK# THEN
      390     8464    3            DO;
      391     8465    3               B$JIT.JUNK2 = B$JIT.JUNK2 | %JJ2_DFRBRK#;
      392     8466    3               GOTO SE1A;
      393     8467    3               END;
      394     8468    2            IF SS$->B$SS.ISR.WSR = 6 THEN
      395     8469    2               GOTO SE87;
      396     8470    2            IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) AND S$CU$->B$U.FLG.DELA
      397     8471    2               AND (B$JIT.JUNK & %JJ_UDELTA#) THEN
      398     8472    2   SE83:       CALL SSU$DELTAGO(EXC,D$->B$$WORD);
      399     8473    2   SE87:    IF ECCB$->B$ECCBI.FLAGS(BREAK) THEN
      400     8474    2               IF SS$->B$SS.TCBFLG ~= BREAK THEN
      401     8475    2                  GOTO SE84;
      402     8476    2               ELSE ;
      403     8477    2            ELSE
      404     8478    2               IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN
      405     8479    2                  GOTO SE82;
      406     8480    2          CASE(DTABRK);
      407     8481    2            EXC=%ECC_DBRK#;
      408     8482    2            IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) AND S$CU$->B$U.FLG.DELA
      409     8483    2               AND (B$JIT.JUNK & %JJ_UDELTA#) THEN
      410     8484    2               CALL SSU$DELTAGO(EXC,D$->B$$WORD);
      411     8485    2          END;
      412     8486    1         GOTO SE1A;
      413     8487        /*                                                                    */
      414     8488    1   SE9:  B$JIT.ERR='232321400006'O;
      415     8489    1         B$JIT.ERR.CODE=%E$TCBFULL;
      416     8490    1         CALL SSS$BLOCK;
      417     8491    1         CALL SSC$SERV;
      418     8492    1         CALL JSE$ABORTM;
      419     8493    1   SE91: CALL SSV$XXDO(0,DD$);           /* DON'T GO TO USER                   */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:14   
      420     8494    1         GOTO SE5;
      421     8495        /*                                                                    */
      422     8496        /*                                                                    */
      423     8497        /*         GET THE NEXT FRAME FROM SS                                 */
      424     8498    1   SE82: IF SS$->B$SS.SCR = '0'B THEN J=64; ELSE J=256;
      425     8499    1         B_MPT.SSDESC$->B$$DESCR.BASE=B_MPT.SSDESC$->B$$DESCR.BASE-J;
      426     8500    1         IF NOT (SS$->B$SS.ISR.FLAGS & '010'O) AND
      427     8501    1            SS$->B$SS.ISR.WSR = 7 THEN
      428     8502    1            GOTO SE85;
      429     8503    1         ELSE
      430     8504    2         DO;
      431     8505    2            CALL UDN$MAGICSS;
      432     8506    2            GOTO SE80;
      433     8507    2            END;
      434     8508        /*         END OF STACK AT NO EXECUTE FLAG                            */
      435     8509        /*                                                                    */
      436     8510    2   SE85: DO CASE(EXC);
      437     8511    2          CASE(TIMER);
      438     8512    2            CALL SC_UTIMER;              /* UNWANTED UTIMER                    */
      439     8513        /*S*    SCREECH_CODE: SSQ-S$UTIMER
      440     8514                TYPE: SCREECH
      441     8515                MESSAGE: UTIMER runout without user timer service request     */
      442     8516    2          CASE(BREAK);
      443     8517    2            GOTO SET_YC;
      444     8518    2          CASE(EVENT);
      445     8519        /*         EVENT FOR AN INACTIVE DOMAIN                               */
      446     8520    2            CALL UDN$MAGIC;
      447     8521    3            DO CASE(I);
      448     8522    3             CASE (0);
      449     8523    3               GOTO SE91;
      450     8524    3             CASE (4);
      451     8525    3               B_MPT.LSDESC$->B$$DESCR=B$LS$->B$MLNK.CPLS; /* GET A LSEG DESC  */
      452     8526    3             CASE(5);
      453     8527    3               IF S$CU$->B$U.FLG.DELA/*if Delta associated with this process*/
      454     8528    3                  AND (B$JIT.JUNK & %JJ_UDELTA#)/*not from ALIB*/
      455     8529    3               THEN IF S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN GOTO SE1A;
      456     8530    3                  ELSE GOTO SE83;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:15   
      457     8531    3               ELSE GOTO SE91;
      458     8532    3             CASE(6);
      459     8533    3               IF S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN
      460     8534    3                  GOTO SE1A;
      461     8535    3               B_MPT.LSDESC$->B$$DESCR=B$LS$->B$MLNK.ASLLS;
      462     8536    3             CASE(7);
      463     8537    3               IF B$JIT.XCONF & %XC_URND# THEN
      464     8538    3                  GOTO SE91;        /* USER IN EXIT CONTROL WHEN EVENT HIT     */
      465     8539    3               ELSE
      466     8540    3                  CALL SC_ASLEVNT;
      467     8541    3             END;
      468     8542    2            CALL UDN$MAGICLS;
      469     8543                                                /*                                    */
      470     8544    2            IF ECCB$->B$ECCBI.FLAGS(EVENT) THEN
      471     8545    3            DO;
      472     8546    3               CALL SST$SSFTCB(-1,EXC,D$->B$$WORD,SS$,TCB$);
      473     8547    4               DO INHIBIT;
      474     8548    4                  CALL SSV$XXDO (0,DD$);
      475     8549    5                  DO CASE (I);        /* GET AN ENTRY DSCR FROM USER LSEG   */
      476     8550    5                   CASE (4);
      477     8551    5                     B$LS$->B$MLNK.MISC2=B$SDS0$->B$SDS.ACPENT;
      478     8552    5                   CASE (5);
      479     8553    5                     B$LS$->B$MLNK.MISC2=B$SDS0$->B$SDS.DBENT;
      480     8554    5                   CASE(6);
      481     8555    5                     B$LS$->B$MLNK.MISC2=B$USERLS$->B$ULNK.ASLENT;
      482     8556    5                   END;
      483     8557        /*                 INSERT THE EVENT ENTRY ADDR                                */
      484     8558    4                  ADDR(B$LS$->B$MLNK.MISC2)->ENTDESCR.ENTLOC=ECCB$->B$ECCBI.ECIC(1);
      485     8559    4                  CALL SSS$LTRD(ADDR(B$MLS1$->B$MLNK.MISC2)->ENTDESCR);
              8559                           /* GO TO EVENT DOMAIN */
      486     8560    4                  END;                   /* INHIBIT                            */
      487     8561    3               END;
      488     8562    2            ELSE
      489     8563    2               CALL SC_ASLEVNT;
      490     8564        /*S*    SCREECH_CODE: SSQ-S$NOASLEVNT
      491     8565                TYPE: SUA
      492     8566                MESSAGE: No event procedure in ASL, CP or DB for this event.  */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:16   
      493     8567    2          END;
      494     8568        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:17   
      495     8569    1   SSQ$NUQUAN: ENTRY ALTRET;               /* GIVE USER NEW QUANTUM              */
      496     8570    1         CALL ACCTEX;
      497     8571    1         S_UXTSCHD = 0;
      498     8572    1         S_USTSCHD = 0;
      499     8573    1         RETURN;
      500     8574        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:18   
      501     8575        /*                                                                    */
      502     8576        /*    SET JIT.RNST ACCORDING TO STATUS                                */
      503     8577        /*                                                                    */
      504     8578    1   ABORTEX: PROC(STATUS);
      505     8579    2   DCL   STATUS UBIN(36);
      506     8580    2   DCL    RNSTAT(0:4) CONSTANT BIT(9) INIT(%RS_XKEY#,%RS_EKEY#,%RS_LIMX#,%RS_DROP#,%
              8580            RS_OFF#);
      507     8581    2   DCL    JERR(0:4) CONSTANT UBIN(14) INIT(%E$XKEY,%E$EKEY,%E$LIMX,%E$DROP,%E$OFF);
      508     8582    2   DCL    SEV(0:4) CONSTANT UBIN(3) INIT(6,4,4,6,6);
      509     8583        /*                                                                    */
      510     8584    2         B$JIT.RNST = (B$JIT.RNST | RNSTAT(STATUS) );
      511     8585    2         IF B$JIT.ERR.SEV = 0
      512     8586    3         THEN DO;
      513     8587    3            B$JIT.ERR='232321400006'O;
      514     8588    3            B$JIT.ERR.CODE=JERR(STATUS);
      515     8589    3            B$JIT.ERR.SEV=SEV(STATUS);
      516     8590    3            END;
      517     8591    2         CALL SSS$BLOCK;
      518     8592    2         CALL SSC$SERV;
      519     8593    2         CALL UDN$BLDASR;
      520     8594    2         CALL JSE$ABORTX;
      521     8595        /*E*   ERROR:  SSQ-E$XKEY-6
      522     8596               MESSAGE:  Job aborted by the operator
      523     8597        */
      524     8598        /*E*   ERROR:  SSQ-E$EKEY-4
      525     8599               MESSAGE:  Job errored by the operator
      526     8600        */
      527     8601        /*E*   ERROR:   SSQ-E$LIMX-4
      528     8602               MESSAGE: Limit exceeded; consult M$XCON (B$XCON.LIMIT) to
      529     8603                        determine which limit.
      530     8604        */
      531     8605        /*E*   ERROR:   SSQ-E$DROP-6
      532     8606               MESSAGE:  Line disconnect
      533     8607        */
      534     8608        /*E*   ERROR:   SSQ-E$OFF-6
      535     8609               MESSAGE:   Monitor has canceled the job
      536     8610        */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:19   
      537     8611    2   END;
      538     8612        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:20   
      539     8613        /*                QUANTUM END ACCOUNTING PROCEDURE                    */
      540     8614        /*                                                                    */
      541     8615    1   ACCTEX: PROC;
      542     8616    2   DCL   CT UBIN(36);
      543     8617    2   DCL   XT SBIN(36);
      544     8618    2   DCL   ST SBIN(36);
      545     8619    2   DCL   PN UBIN(36);
      546     8620    2   DCL   SL_QUAN UBIN(36) SYMREF;
      547     8621        /*                                                                    */
      548     8622    3         DO INHIBIT;                     /* INHIBIT UNTIL PARKED               */
      549     8623        /*         SET QUANTUM TIME                                           */
      550     8624    3            IF B$JIT.MODE = %M_BATCH# THEN
      551     8625    3               B$JIT.IDELTAT =
      552     8626    3                  MAXIMUM(JM_PPTR$(B$JIT.PNR)->JM$PT.QUAN + B$JIT.QUAN, 1000);
      553     8627    3            ELSE
      554     8628    3               B$JIT.IDELTAT=MAXIMUM(SL_QUAN + B$JIT.QUAN,1000);
              8628                        /* JIT value is an offset */
      555     8629    3            XT=B$JIT.XTIME+B$JIT.EXTUS;  /* EX TIME IN USECS                   */
      556     8630    3            ST=B$JIT.STIME+B$JIT.SVTUS;  /* SRV TIME IN USECS*/
      557     8631    3            B$JIT.EXTUS=MOD(XT,10000);   /* QUANTUM TIME REMAINDER             */
      558     8632    3            B$JIT.SVTUS=MOD(ST,10000);   /* FOR EXECUTION AND SERVICE          */
      559     8633                                                /* IF CP OR DELTA RUNNING, DON'T      */
      560     8634    3            B$LS$->B$MLNK.MISC2=B$USERLS$->B$ULNK.ECCB;
      561     8635    3            IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) AND
      562     8636    3               B$JIT.UTIMER > 0 AND B$MISC2$->B$ECCB.FLAGS.TMRSET THEN
      563     8637    4            DO;
      564     8638    4               IF (XT + ST) >= B$JIT.UTIMER THEN
      565     8639    4                  B$JIT.UTIMER = 7;   /* Just some small constant*/
      566     8640    4               ELSE
      567     8641    4                  B$JIT.UTIMER=B$JIT.UTIMER-(XT+ST); /* Decrement timer     */
      568     8642    4               IF B$JIT.UTIMER < B$JIT.IDELTAT THEN
      569     8643    4                  B$JIT.IDELTAT=B$JIT.UTIMER;
      570     8644    4               END;
      571     8645    3            XT=XT/10000;
      572     8646    3            ST=ST/10000;
      573     8647    3            CT=(XT+ST)*B$JIT.CURRCORE;   /* CORE TIME PRODUCT IN UTS*/
      574     8648                   %LOCK (G#=P_GATE);
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:21   
      575     8651    3            IF B$JIT.RUNFLAGS & %RUN_USER# THEN
      576     8652    4            DO;
      577     8653    4               B$JIT.TUEXT=B$JIT.TUEXT+XT;
      578     8654    4               B$JIT.TUSVT=B$JIT.TUSVT+ST;
      579     8655    4               B$JIT.UMEMTIM=B$JIT.UMEMTIM+CT;
      580     8656    4               END;
      581     8657    3            ELSE
      582     8658    4            DO;
      583     8659    4               B$JIT.TPEXT=B$JIT.TPEXT+XT;
      584     8660    4               B$JIT.TPSVT=B$JIT.TPSVT+ST;
      585     8661    4               B$JIT.PMEMTIM=B$JIT.PMEMTIM+CT;
      586     8662    4               END;
      587     8663    3            PN = S$CU$->B$U.APR;
      588     8664    3            IF S$CU$->B$U.FLG.CPIC
      589     8665    3            THEN PN=S$CU$->B$U.ACP;
      590     8666    3            ELSE
      591     8667    3               IF S$CU$->B$U.FLG.DIC
      592     8668    3               THEN PN=S$CU$->B$U.DB;
      593     8669    3            IF PN ~= 0
      594     8670    4            THEN DO;
      595     8671    4               B$P$->B$P.XEQTIME(PN) = B$P$->B$P.XEQTIME(PN) + XT;
      596     8672    4               B$P$->B$P.SRVTIME(PN) = B$P$->B$P.SRVTIME(PN) + ST;
      597     8673    4               END;
      598     8674    3            CALL SSS$CACHEBP;
      599     8675    3            PN = B$JIT.MODE;
      600     8676    3            P_UXEQTIME(PN)=P_UXEQTIME(PN)+XT;
      601     8677    3            P_USRVTIME(PN)=P_USRVTIME(PN)+ST;
      602     8678    3            CALL SSS$CACHE;
      603     8679                   %UNLOCK (G#=P_GATE);
      604     8682    3            B$JIT.CTIME=0;
      605     8683    3            B$JIT.STIME=0;
      606     8684    3            B$JIT.XTIME=0;
      607     8685    3            IF B$JIT.MRT > 0
      608     8686    4            THEN DO;
      609     8687    4               IF H_MIXED_MP = 0
      610     8688    4               THEN B$JIT.MRT = B$JIT.MRT - (XT+ST);
      611     8689    4               ELSE B$JIT.MRT = B$JIT.MRT - (XT+ST)/2;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:22   
      612     8690    4               END;
      613     8691    4            IF B$JIT.PRIOB ~= 0 THEN DO;
      614     8692    4               S$CU$->B$U.PRIOB = S$CU$->B$U.PRIOB + B$JIT.PRIOB;
      615     8693    4               B$JIT.PRIOB = 0;
      616     8694    4               END;
      617     8695    3            S$CU$->B$U.UTSUSED=S$CU$->B$U.UTSUSED+XT+ST;
      618     8696    3            S$CU$ -> B$U.MRT = B$JIT.MRT;
      619     8697    3            IF B$JIT.MRT > 0 THEN RETURN;
      620     8698    3            B$JIT.MRT=0;
      621     8699    3            B$JIT.RNST=(B$JIT.RNST | %RS_LIMX#);
      622     8700    3            B$JIT.XLIMFLG=(B$JIT.XLIMFLG | %XL_TIME#);
      623     8701    3            B$JIT.ERR='232321400006'O;
      624     8702    3            B$JIT.ERR.CODE=%E$MAXTIME;
      625     8703    3            RETURN;
      626     8704        /*E*   ERROR:   SSQ-E$MAXTIME-6
      627     8705               MESSAGE:   Time limit exceeded
      628     8706        */
      629     8707    3            END;                           /* END INHIBIT                        */
      630     8708    2   END;
      631     8709    1   END;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:23   
--  Include file information  --

   B_MAGIC_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   JM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JMA_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   F_CODE_R.:E05TOU  cannot be made into a system file and is referenced.
   J_ERRORS_C.:E05TOU  is referenced.
   UE_ERRORS_C.:E05TOU  is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   UE_CP6.:E05TOU  is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   B_ULSMAC_C.:E05TOU  is referenced.
   B_UHJMAC_C.:E05TOU  is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   JM$STRUCT.:E05TOU  is referenced.
      No diagnostics issued in procedure SSQ$QEND.

   Procedure SSQ$QEND requires 1102 words for executable code.
   Procedure SSQ$QEND requires 30 words of local(AUTO) storage.

    No errors detected in file SSQ$QEND.:E05TSI    .

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:24   

 Object Unit name= SSQ$QEND                                   File name= SSQ$QEND.:E05TOU
 UTS= JUL 30 '97 05:57:18.24 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     23     27  SSQ$QEND
    1   Proc  even  none  1102   2116  SSQ$QEND
    2  RoData even  none    17     21  SSQ$QEND

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        0  SSQ$QEND
     1   1467          yes     yes      Std        0  SSQ$NUQUAN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:25   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 SSC$MON
         yes           Std       1 HFC$UNLOCK
         yes           Std       1 SSS$LTRD
         yes           Std       0 HFC$ASSOCCLR
 yes     yes           Std       1 KIF$LDTRC
         yes           Std       0 UDN$MAGICLS
         yes           Std       0 SSC$SERV
         yes           Std       5 JST$CPEXIT
         yes           Std       1 HFC$LOCK
         yes           Std       2 FMF$TYC
 yes     yes           Std       3 SSV$XXDO
         yes           Std       3 SSU$DELTAGO
         yes           Std       0 JSE$ABORTM
         yes           Std       0 UDN$MAGICSS
         yes           Std       1 SSS$LDT
 yes     yes           Std       6 SST$SSFTCB
         yes           Std       0 HFC$CACHECLR
         yes           Std       0 SSS$BLOCK
         yes           Std       0 UDN$MAGIC
         yes           Std       0 JSE$ACP
         yes           Std       0 UDN$BLDASR
         yes           Std       0 JSE$ABORTX
         yes           Std       0 SSS$CACHEBP
         yes           Std       0 SSS$CACHE
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:26   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_ASLEVNT                            SC_UTIMER                        r    J_LOGON
r    J_SYSTXT                              S_UXTSCHD                             S_USTSCHD
r    B$JIT$                           r    B$LS$                            r    B$MLS1$
r    B$MISC2$                         r    B$SDS0$                          r    B$USERLS$
     S$CU$                                 SL_QMIN                               S_HIR
     S_UDLGATE                             S_ASFGATE                             B$P$
     JM_PPTR$                         r    H_MIXED_MP                            P_RESOURCE$
     P_UXEQTIME                            P_USRVTIME                            P_UPTIME
     P_GATE                                P_NSCPU                               B_MPT
     SL_QUAN                               B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:27   


        1        1        /*M* SSQ$QEND     QUANTUM END AND ASYNCHRONOUS EVENT PROCESSING       */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  PLM=6,IND=3,CTI=3,DCI=3,DTI=0,MCI,MOC,DMC    */
        8        8        /*                                                                    */
        9        9        SSQ$QEND: PROC ALTRET;

      9  1 000000   000000 700200 xent  SSQ$QEND     TSX0  ! X66_AUTO_0
         1 000001   000036 000000                    ZERO    30,0

       10       10        /*                                                                    */
       11       11    1   DCL   SSS$BLOCK ENTRY;
       12       12    1   DCL   SSC$MON ENTRY;
       13       13    1   DCL   SSS$LDT ENTRY(1);
       14       14    1   DCL SSC$SERV ENTRY;
       15       15    1   DCL UDN$MAGIC ENTRY;
       16       16    1   DCL UDN$MAGICSS ENTRY;
       17       17    1   DCL UDN$MAGICLS ENTRY;
       18       18    1   DCL UDN$BLDASR ENTRY;
       19       19    1   DCL   HFC$ASSOCCLR ENTRY;
       20       20    1   DCL   HFC$CACHECLR ENTRY;
       21       21    1   DCL   SC_UTIMER ENTRY CONV(2,0);
       22       22    1   DCL   SSS$PUF ENTRY;                    /* DELETE MAGIK SEG FROM AS           */
       23       23    1   DCL   SSS$LTRD ENTRY(1);                /* PERFORM LTRAD                      */
       24       24    1   DCL   SSS$CACHEBP ENTRY;                /* Bypass cache                       */
       25       25    1   DCL   SSS$CACHE ENTRY;                  /* Re-enable cache                    */
       26       26    1   DCL   SST$SSFTCB ENTRY(6) ALTRET;       /* MOVE SS FRAME TO TCB               */
       27       27    1   DCL SSU$DELTAGO ENTRY(3);               /* MOVE SS FRAME TO DELTA TCB & GO    */
       28       28    1   DCL   SSV$XXDO ENTRY(3) ALTRET;         /* DELETE DO LIST ENTRY               */
       29       29    1   DCL   FMF$TYC ENTRY(2);                 /* CONVERT TYC TO ERROR CODE          */
       30       30    1   DCL   JSE$ACP ENTRY;                    /* ASSOC COMMAND PROCESSOR            */
       31       31    1   DCL   JSE$ABORTM ENTRY;                 /* TERMINATE JOB STEP                 */
       32       32    1   DCL   JSE$ABORTX ENTRY;                 /* TERMINATE USER                     */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:28   
       33       33    1   DCL JST$CPEXIT ENTRY(5);                /* Initial user entry                 */
       34       34    1   DCL     SC_ASLEVNT ENTRY CONV(2,0);
       35       35    1   DCL KIF$LDTRC ENTRY(1) ALTRET;
       36       36        /*                                                                    */
       37       37    1   DCL   J_LOGON CHAR(8) SYMREF READONLY;
       38       38    1   DCL   J_SYSTXT CHAR(8) SYMREF READONLY;
       39       39    1   DCL   S_PNO SBIN SYMREF;
       40       40    1   DCL   S_CUN SBIN SYMREF;
       41       41    1   DCL   S_DL$ PTR  SYMREF;
       42       42    1   DCL   S_UXTSCHD UBIN SYMREF;
       43       43    1   DCL   S_USTSCHD UBIN SYMREF;
       44       44    1   DCL   B$JIT$ PTR SYMREF READONLY;
       45       45    1   DCL   B$LS$ PTR SYMREF READONLY;
       46       46    1   DCL   B$MLS1$ PTR SYMREF READONLY;
       47       47    1   DCL   B$MISC2$ PTR SYMREF READONLY;
       48       48    1   DCL   B$SDS0$ PTR SYMREF READONLY;
       49       49    1   DCL   B$USERLS$ PTR SYMREF READONLY;
       50       50        /*                                                                    */
       51       51    1   DCL   I UBIN(36);                       /* TEMP                               */
       52       52    1   DCL   J UBIN(36);                       /* TEMP                               */
       53       53        /*                                                                    */
       54       54    1   DCL   RTIME SBIN;                       /* TEMP TIME                          */
       55       55    1   DCL   EXC UBIN(36);                     /* TEMP                               */
       56       56    1   DCL   D$ PTR;                           /* TEMP DO LIST PTR                   */
       57       57    1   DCL   DD$ PTR;                          /*    "                               */
       58       58    1   DCL   ECINFO(0:3) UBIN;                 /* TEMP ECC INFO FOR BREAK AND UTIMER */
       59       59    1   DCL   ASFLAGS BIT(36);                  /* TEMP ASYNCH FLAGS                  */
       60       60    1   DCL  PRIODEC UBIN(36) CONSTANT INIT(1); /*                                    */
       61       61        /*                                                                    */
       62       62        /*                                                                    */
       63       63    1   DCL B$$WORD UBIN WORD BASED ALIGNED;
       64       64        /**/
       65       65        %INCLUDE JM$STRUCT;
       66      810        %INCLUDE B$JIT;
       67     1413        %INCLUDE B$USER;
       68     1629        %B$USERREFS;
       69     1633        %INCLUDE SS_SCHED_C;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:29   
       70     1866        %INCLUDE SS_SCHED_R;
       71     1909        %INCLUDE B_UHJMAC_C;
       72     2238        %INCLUDE B_ULSMAC_C;
       73     3347        %INCLUDE B_MLSMAC_C;
       74     4289        %B_USRULS (FPTN=B$ULNK,STCLASS=BASED);
       75     4488        %B_MLS (FPTN=B$MLNK,STCLASS=BASED);
       76     5303        %B_USDS (FPTN=B$SDS,STCLASS=BASED);
       77     5355        %JM_PART (FPTN=JM$PT,STCLASS=BASED);
       78     5410        %INCLUDE UE_CP6;
       79     6101        %INCLUDE B$SS;
       80     6280        %INCLUDE B$P;
       81     6364        %INCLUDE UE_ERRORS_C;
       82     6382        %INCLUDE J_ERRORS_C;
       83     6469        %INCLUDE F_CODE_R;
       84     6479        %INCLUDE JMA_DATA_R;
       85     6488        %INCLUDE JM_CNTRL_R;
       86     7377        %INCLUDE HF_LOCK_C;
       87     7391        %INCLUDE HF_DATA_R;
       88     7434        %INCLUDE P_PMDAT_R;
       89     7742        %INCLUDE B_MACROS_C;
       90     7853        %T01DESCR (NAME=B$$DESCR);
       91     7861        %ENTDESCR;
       92     7871        %INCLUDE B_MAGIC_C;
       93     7989        %B_MPT (FPTN=B_MPT,STCLASS=SYMREF);
       94     8082        /**/
       95     8083        %B$ECCB;
       96     8091        %B$EVNT;
       97     8104        %B$ECCBI;
       98     8107        %B$BRK;
       99     8115        %SUB_ECCDELTA;
      100     8152        /**/
      101     8153        %SUB TIMER=0/*UTIMER*/;
      102     8154        %SUB EVENT=1/*EVENT*/;
      103     8155        %SUB BREAK=2/*BREAK*/;
      104     8156        %SUB DTABRK=3;
      105     8157        /**/
      106     8158        %SUB SS$=B_MPT.SS$;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:30   
      107     8159        %SUB TCB$=B_MPT.TCB$;
      108     8160        %SUB ECCB$=B_MPT.ECCB$;
      109     8161        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:31   
      110     8162        /*                RETURNING TO THE USER.                              */
      111     8163    1         IF (S$CU$->B$U.FLG & %(%U_MSTR | %U_DBRK))

   8163  1 000002   000000 470400 xsym               LDP0    S$CU$
         1 000003   000000 236100                    LDQ     0,,PR0
         1 000004   000015 376000 0                  ANQ     SEV+5
         1 000005   000020 601000 1                  TNZ     s:8173
         1 000006   000000 471400 xsym               LDP1    B$JIT$
         1 000007   100314 236100                    LDQ     204,,PR1
         1 000010   777000 376003                    ANQ     -512,DU
         1 000011   000001 276100                    ORQ     1,,PR0
         1 000012   000020 601000 1                  TNZ     s:8173
         1 000013   000015 236100                    LDQ     13,,PR0
         1 000014   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000015   000020 601000 1                  TNZ     s:8173
         1 000016   100301 235100                    LDA     193,,PR1
         1 000017   000133 600000 1                  TZE     SE1A

      112     8164    1            OR (B$JIT.RNST|S$CU$->B$U.ASYNCH)
      113     8165    1            OR (S$CU$->B$U.DL$~=ADDR(NIL))
      114     8166    1            OR (B$JIT.UTIMER~=0)
      115     8167    2         THEN DO;

      116     8168
      117     8169                      /* If Master Only is set, reset it and park user if a
      118     8170                         specific CPU is required.  Let SSX figure out which
      119     8171                         CPU to run him on.                                */
      120     8172
      121     8173    2            IF S$CU$->B$U.FLG.MSTR

   8173  1 000020   000000 236100                    LDQ     0,,PR0
         1 000021   000004 316003                    CANQ    4,DU
         1 000022   000035 600000 1                  TZE     SE4

      122     8174    3            THEN DO;

      123     8175    3               S$CU$->B$U.FLG.MSTR = '0'B;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:32   

   8175  1 000023   000000 236000 2                  LDQ     0
         1 000024   000000 356100                    ANSQ    0,,PR0

      124     8176    3               IF S$CU$->B$U.CPU ~= 0

   8176  1 000025   000000 470400 xsym               LDP0    S$CU$
         1 000026   000010 236100                    LDQ     8,,PR0
         1 000027   000777 316007                    CANQ    511,DL
         1 000030   000035 600000 1                  TZE     SE4

      125     8177    4               THEN DO;

      126     8178    4                  CALL SSC$MON;

   8178  1 000031   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000032   000000 701000 xent               TSX1    SSC$MON
         1 000033   000000 011000                    NOP     0

      127     8179    4                  ALTRETURN;

   8179  1 000034   000000 702200 xent               TSX2  ! X66_AALT

      128     8180    4                  END;
      129     8181    3               END;
      130     8182                      /* Check for asynchronous events, Quantum End or QMIN
      131     8183                         expiration.                                       */
      132     8184
      133     8185    2   SE4:     IF B$JIT.RNST|(S$CU$->B$U.ASYNCH & ~%U_CACHE) THEN

   8185  1 000035   000003 236000 xsym  SE4          LDQ     B_VECTNIL+3
         1 000036   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000037   000000 470400 xsym               LDP0    S$CU$
         1 000040   000001 376100                    ANQ     1,,PR0
         1 000041   200024 756100                    STQ     PN+2,,AUTO
         1 000042   000000 471400 xsym               LDP1    B$JIT$
         1 000043   100314 236100                    LDQ     204,,PR1
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:33   
         1 000044   777000 376003                    ANQ     -512,DU
         1 000045   200024 276100                    ORQ     PN+2,,AUTO
         1 000046   000345 601000 1                  TNZ     SE7

      134     8186    2               GOTO SE7;
      135     8187    2            IF S$CU$->B$U.DL$~=ADDR(NIL) THEN

   8187  1 000047   000015 236100                    LDQ     13,,PR0
         1 000050   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000051   000077 600000 1                  TZE     s:8203

      136     8188    3            DO;

   8187  1 000052                       SE5          null
      137     8189    3   SE5:        ;
      138     8190                            %LOCK (G#=S_UDLGATE);

   8191  1 000052   000001 630400 2                  EPPR0   1
         1 000053   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000054   000000 701000 xent               TSX1    HFC$LOCK
         1 000055   000000 011000                    NOP     0

      139     8193    3               IF S$CU$->B$U.DL$ ~= ADDR(NIL) AND

   8193  1 000056   000000 470400 xsym               LDP0    S$CU$
         1 000057   000015 236100                    LDQ     13,,PR0
         1 000060   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000061   000073 600000 1                  TZE     SE51
         1 000062   000000 471400 xsym               LDP1    B$JIT$
         1 000063   100261 236100                    LDQ     177,,PR1
         1 000064   100262 036100                    ADLQ    178,,PR1
         1 000065   100263 036100                    ADLQ    179,,PR1
         1 000066   100266 116100                    CMPQ    182,,PR1
         1 000067   000073 605000 1                  TPL     SE51
         1 000070   100315 220100                    LDX0    205,,PR1
         1 000071   400000 360003                    ANX0    -131072,DU
         1 000072   000212 600000 1                  TZE     SE6
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:34   

   8193  1 000073                       SE51         null
      140     8194    3                  B$JIT.STIME+B$JIT.XTIME+B$JIT.CTIME < B$JIT.IDELTAT AND
      141     8195    3                  NOT (B$JIT.JUNK & %JJ_EVENT#) THEN
      142     8196    3                  GOTO SE6;
      143     8197    3   SE51:       ;
      144     8198                            %UNLOCK (G#=S_UDLGATE);

   8199  1 000073   000001 630400 2                  EPPR0   1
         1 000074   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000075   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000076   000000 011000                    NOP     0

      145     8201    3               END;

      146     8202        /*                CHECK FOR USER UTIMER RUNOUT                        */
      147     8203    2            IF B$JIT.UTIMER~=0 THEN

   8203  1 000077   000000 470400 xsym               LDP0    B$JIT$
         1 000100   000301 235100                    LDA     193,,PR0
         1 000101   000122 600000 1                  TZE     s:8215

      148     8204    3            DO;

      149     8205    3               B$LS$->B$MLNK.MISC2=B$USERLS$->B$ULNK.ECCB;

   8205  1 000102   000000 471400 xsym               LDP1    B$USERLS$
         1 000103   100034 237100                    LDAQ    28,,PR1
         1 000104   000000 473400 xsym               LDP3    B$LS$
         1 000105   300260 757100                    STAQ    176,,PR3

      150     8206    3               IF B$MISC2$->B$ECCB.FLAGS.TMRSET AND (B$JIT.UTIMER<=(B$JIT.XTIME

   8206  1 000106   000000 474400 xsym               LDP4    B$MISC2$
         1 000107   400004 234100                    SZN     4,,PR4
         1 000110   000122 605000 1                  TPL     s:8215
         1 000111   000262 236100                    LDQ     178,,PR0
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:35   
         1 000112   000261 036100                    ADLQ    177,,PR0
         1 000113   000122 604000 1                  TMI     s:8215
         1 000114   000301 116100                    CMPQ    193,,PR0
         1 000115   000122 602000 1                  TNC     s:8215

      151     8207    3                  +B$JIT.STIME)) THEN
      152     8208    4               DO;

      153     8209    4                  I=7;

   8209  1 000116   000007 236007                    LDQ     7,DL
         1 000117   200003 756100                    STQ     I,,AUTO

      154     8210    4                  EXC=0;

   8210  1 000120   200006 450100                    STZ     EXC,,AUTO

      155     8211    4                  GOTO SE72;

   8211  1 000121   000656 710000 1                  TRA     SE72

      156     8212    4                  END;
      157     8213    3               END;
      158     8214        /*                CHECK FOR DATA BREAKPOINT                           */
      159     8215    2            IF S$CU$->B$U.FLG.DBRK THEN

   8215  1 000122   000000 471400 xsym               LDP1    S$CU$
         1 000123   100000 236100                    LDQ     0,,PR1
         1 000124   010000 316007                    CANQ    4096,DL
         1 000125   000133 600000 1                  TZE     SE1A

      160     8216    3            DO;

      161     8217    3               EXC=DTABRK;

   8217  1 000126   000003 235007                    LDA     3,DL
         1 000127   200006 755100                    STA     EXC,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:36   

      162     8218    3               S$CU$->B$U.FLG.DBRK = '0'B;

   8218  1 000130   000002 236000 2                  LDQ     2
         1 000131   100000 356100                    ANSQ    0,,PR1

      163     8219    3               GOTO SE72;

   8219  1 000132   000656 710000 1                  TRA     SE72

      164     8220    3               END;
      165     8221    2            END;
      166     8222        /*                COMPUTE TIME REMAINING IN QUANTUM                   */
      167     8223    1   SE1A: RTIME=B$JIT.IDELTAT-B$JIT.STIME-B$JIT.XTIME-B$JIT.CTIME;

   8223  1 000133   000000 470400 xsym  SE1A         LDP0    B$JIT$
         1 000134   000266 236100                    LDQ     182,,PR0
         1 000135   000261 136100                    SBLQ    177,,PR0
         1 000136   000262 136100                    SBLQ    178,,PR0
         1 000137   000263 136100                    SBLQ    179,,PR0
         1 000140   200005 756100                    STQ     RTIME,,AUTO

      168     8224    1         B$JIT.JUNK = B$JIT.JUNK & ~%JJ_EVENT#;

   8224  1 000141   000315 220100                    LDX0    205,,PR0
         1 000142   377777 360003                    ANX0    131071,DU
         1 000143   000315 740100                    STX0    205,,PR0

      169     8225    1         IF RTIME <= 0 THEN              /* CHECK FOR QUANTUM END              */

   8225  1 000144   000000 116003                    CMPQ    0,DU
         1 000145   000160 605400 1                  TPNZ    s:8235

      170     8226    2         DO INHIBIT;                  /* INHIBIT UNTIL PARKED               */

      171     8227    2            CALL SSC$MON;             /* MONITOR RUNNING                    */

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:37   
   8227  1 000146   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000147   000000 701200 xent               TSX1  ! SSC$MON
         1 000150   000000 011200                    NOP   ! 0

      172     8228    2            CALL ACCTEX;              /* GIVE HIM A NEW QUANTUM             */

   8228  1 000151   001550 701200 1                  TSX1  ! ACCTEX
         1 000152   000000 011200                    NOP   ! 0

      173     8229    2            S$CU$->B$U.PRIO=S$CU$->B$U.PRIOB;

   8229  1 000153   000000 470600 xsym               LDP0  ! S$CU$
         1 000154   000011 236300                    LDQ   ! 9,,PR0
         1 000155   000006 736200                    QLS   ! 6
         1 000156   000011 752310                    STCQ  ! 9,'10'O,PR0

      174     8230    2            ALTRETURN;                /* RETURN TO BLOCK HIM AND RESCHED    */

   8230  1 000157   000000 702200 xent               TSX2  ! X66_AALT

      175     8231    2            END;

      176     8232        /*                COMPUTE TIME SINCE LAST SCHEDULED. IF ITS GREATER   */
      177     8233        /*                THAN QMIN AND A HIGHER PRIORITY USER IS WAITING     */
      178     8234        /*                PARK THIS GUY IN HIS FAVOR.                         */
      179     8235    1         IF S_HIR > 0 THEN

   8235  1 000160   000000 235000 xsym               LDA     S_HIR
         1 000161   000203 604400 1                  TMOZ    s:8248

      180     8236    2         DO;

      181     8237        /*                 COMPUTE TIME SINCE QMIN.                                  */
      182     8238    2            RTIME=SL_QMIN(B$JIT.MODE)-(B$JIT.IDELTAT-B$JIT.SCHTIME-RTIME);

   8238  1 000162   000000 470400 xsym               LDP0    B$JIT$
         1 000163   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:38   
         1 000164   000040 772000                    QRL     32
         1 000165   000000 620006                    EAX0    0,QL
         1 000166   000266 236100                    LDQ     182,,PR0
         1 000167   000265 136100                    SBLQ    181,,PR0
         1 000170   200005 136100                    SBLQ    RTIME,,AUTO
         1 000171   200024 756100                    STQ     PN+2,,AUTO
         1 000172   000000 236010 xsym               LDQ     SL_QMIN,X0
         1 000173   200024 136100                    SBLQ    PN+2,,AUTO
         1 000174   200005 756100                    STQ     RTIME,,AUTO

      183     8239    2            IF RTIME <= 0 THEN

   8239  1 000175   000203 605400 1                  TPNZ    s:8248

      184     8240    3            DO INHIBIT;

      185     8241    3               S_HIR=0;

   8241  1 000176   000000 450200 xsym               STZ   ! S_HIR

      186     8242    3               CALL SSC$MON;

   8242  1 000177   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 000200   000000 701200 xent               TSX1  ! SSC$MON
         1 000201   000000 011200                    NOP   ! 0

      187     8243    3               ALTRETURN;

   8243  1 000202   000000 702200 xent               TSX2  ! X66_AALT

      188     8244    3               END;

      189     8245        /*                  IF QMIN HASN'T EXPIRED SET TRO TO GO OFF AT QMIN         */
      190     8246    2            END;

      191     8247        /*                  IF NO HIGH PRIO GUY IS WAITING SET TRO TO GO OFF AT QUAN */
      192     8248    1         CALL SSS$LDT(RTIME);
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:39   

   8248  1 000203   200005 630500                    EPPR0   RTIME,,AUTO
         1 000204   200024 450500                    STP0    PN+2,,AUTO
         1 000205   200024 630500                    EPPR0   PN+2,,AUTO
         1 000206   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000207   000000 701000 xent               TSX1    SSS$LDT
         1 000210   000000 011000                    NOP     0

      193     8249    1         RETURN;                         /* NORMAL RETURN TO CONTINUE USER     */

   8249  1 000211   000000 702200 xent               TSX2  ! X66_ARET

      194     8250        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:40   
      195     8251        /*         PROCESS EVENT STUFF ON DO LIST                             */
      196     8252        /*                                                                    */
      197     8253    1   SE6:  D$=S$CU$->B$U.DL$;

   8253  1 000212   000015 236100       SE6          LDQ     13,,PR0
         1 000213   200007 756100                    STQ     D$,,AUTO

      198     8254    1   SE61: IF D$ = ADDR(NIL) THEN GOTO SE51;

   8254  1 000214   200007 236100       SE61         LDQ     D$,,AUTO
         1 000215   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000216   000073 600000 1                  TZE     SE51

      199     8255    1         IF D$->B$DO.BUSY = '1'B THEN

   8255  1 000217   200007 470500                    LDP0    D$,,AUTO
         1 000220   000002 234100                    SZN     2,,PR0
         1 000221   000225 605000 1                  TPL     s:8261

      200     8256    2         DO;

      201     8257    2            D$=D$->B$DO.LNK$;

   8257  1 000222   000000 236100                    LDQ     0,,PR0
         1 000223   200007 756100                    STQ     D$,,AUTO

      202     8258    2            GOTO SE61;

   8258  1 000224   000214 710000 1                  TRA     SE61

      203     8259    2            END;
      204     8260                %UNLOCK (G#=S_UDLGATE);

   8261  1 000225   000001 630400 2                  EPPR0   1
         1 000226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000227   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000230   000000 011000                    NOP     0
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:41   

      205     8263    1         S_HIR=0;                        /* DON'T INTERRUPT THIS GUY           */

   8263  1 000231   000000 450000 xsym               STZ     S_HIR

      206     8264                %LOCK (G#=S_ASFGATE);

   8265  1 000232   000003 630400 2                  EPPR0   3
         1 000233   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000234   000000 701000 xent               TSX1    HFC$LOCK
         1 000235   000000 011000                    NOP     0

      207     8267    1         IF S$CU$->B$U.ASYNCH & %U_CACHE THEN

   8267  1 000236   000000 470400 xsym               LDP0    S$CU$
         1 000237   000001 236100                    LDQ     1,,PR0
         1 000240   000003 376000 xsym               ANQ     B_VECTNIL+3
         1 000241   000262 600000 1                  TZE     s:8278

      208     8268    2         DO;

      209     8269    2            S$CU$->B$U.ASYNCH=S$CU$->B$U.ASYNCH & ~%U_RESET;

   8269  1 000242   000003 236000 xsym               LDQ     B_VECTNIL+3
         1 000243   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000244   000001 376100                    ANQ     1,,PR0
         1 000245   000001 756100                    STQ     1,,PR0

      210     8270    2            IF D$->B$DO.SCHDDO THEN

   8270  1 000246   200007 471500                    LDP1    D$,,AUTO
         1 000247   100002 236100                    LDQ     2,,PR1
         1 000250   100000 316003                    CANQ    32768,DU
         1 000251   000257 600000 1                  TZE     s:8275

      211     8271    3            DO;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:42   
      212     8272    3               D$->B$DO.SCHDDO='0'B;

   8272  1 000252   000004 236000 2                  LDQ     4
         1 000253   100002 356100                    ANSQ    2,,PR1

      213     8273    3               CALL HFC$ASSOCCLR;

   8273  1 000254   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000255   000000 701000 xent               TSX1    HFC$ASSOCCLR
         1 000256   000000 011000                    NOP     0

      214     8274    3               END;

      215     8275    2            CALL HFC$CACHECLR;

   8275  1 000257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000260   000000 701000 xent               TSX1    HFC$CACHECLR
         1 000261   000000 011000                    NOP     0

      216     8276    2            END;

      217     8277                %UNLOCK (G#=S_ASFGATE);

   8278  1 000262   000003 630400 2                  EPPR0   3
         1 000263   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000264   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000265   000000 011000                    NOP     0

      218     8280    1         I=D$->B$DO.WSR;                 /* DOMAIN IDENTIFIER                  */

   8280  1 000266   200007 470500                    LDP0    D$,,AUTO
         1 000267   000002 236100                    LDQ     2,,PR0
         1 000270   000022 772000                    QRL     18
         1 000271   000777 376007                    ANQ     511,DL
         1 000272   200003 756100                    STQ     I,,AUTO

      219     8281    1         EXC=1;                          /* EVENT CODE                         */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:43   

   8281  1 000273   000001 235007                    LDA     1,DL
         1 000274   200006 755100                    STA     EXC,,AUTO

      220     8282    1         DD$=D$;                         /* SAVE ENTRY POINTER FOR DELETE      */

   8282  1 000275   200007 236100                    LDQ     D$,,AUTO
         1 000276   200010 756100                    STQ     DD$,,AUTO

      221     8283    1         IF D$->B$DO.ENTER ~= ENTADDR(NIL) THEN

   8283  1 000277   000001 236100                    LDQ     1,,PR0
         1 000300   000002 116000 xsym               CMPQ    B_VECTNIL+2
         1 000301   000315 600000 1                  TZE     s:8288

      222     8284    2         DO;

      223     8285    2            CALL D$->B$DO.ENTER(D$) ALTRET(SE91); /* CALL SYSTEM EVENT PROC */

   8285  1 000302   200007 631500                    EPPR1   D$,,AUTO
         1 000303   200024 451500                    STP1    PN+2,,AUTO
         1 000304   200024 630500                    EPPR0   PN+2,,AUTO
         1 000305   200007 473500                    LDP3    D$,,AUTO
         1 000306   300001 220100                    LDX0    1,,PR3
         1 000307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000310   000000 701010                    TSX1    0,X0
         1 000311   001226 702000 1                  TSX2    SE91

      224     8286    2            D$->B$DO.ENTER=ENTADDR(NIL); /* ONLY ONCE                       */

   8286  1 000312   000002 236000 xsym               LDQ     B_VECTNIL+2
         1 000313   200007 470500                    LDP0    D$,,AUTO
         1 000314   000001 756100                    STQ     1,,PR0

      225     8287    2            END;

      226     8288    1         IF D$->B$DO.ECCSC = %EVSC_IO# THEN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:44   

   8288  1 000315   200007 470500                    LDP0    D$,,AUTO
         1 000316   000002 720100                    LXL0    2,,PR0
         1 000317   000001 100003                    CMPX0   1,DU
         1 000320   000341 601000 1                  TNZ     s:8294

      227     8289    2         DO;                          /* convert TYC to error code          */

      228     8290    2            CALL FMF$TYC(D$->B$DO.IOCOMP,D$->B$DO.ERRC);

   8290  1 000321   200007 236100                    LDQ     D$,,AUTO
         1 000322   000004 036003                    ADLQ    4,DU
         1 000323   200025 756100                    STQ     PN+3,,AUTO
         1 000324   200007 236100                    LDQ     D$,,AUTO
         1 000325   000006 036003                    ADLQ    6,DU
         1 000326   200024 756100                    STQ     PN+2,,AUTO
         1 000327   200024 630500                    EPPR0   PN+2,,AUTO
         1 000330   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000331   000000 701000 xent               TSX1    FMF$TYC
         1 000332   000000 011000                    NOP     0

      229     8291    2            IF D$->B$DO.ERRC THEN

   8291  1 000333   200007 470500                    LDP0    D$,,AUTO
         1 000334   000004 235100                    LDA     4,,PR0
         1 000335   000341 600000 1                  TZE     s:8294

      230     8292    2               D$->B$DO.ERRC = D$->B$DO.ERRC | '000000400000'O;

   8292  1 000336   000004 236100                    LDQ     4,,PR0
         1 000337   000016 276000 0                  ORQ     SEV+6
         1 000340   000004 756100                    STQ     4,,PR0

      231     8293    2            END;

      232     8294    1         D$=ADDR(D$->B$DO.BUSY);         /* PTR TO ECC INFO FOR SSFTCB         */

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:45   
   8294  1 000341   200007 236100                    LDQ     D$,,AUTO
         1 000342   000002 036003                    ADLQ    2,DU
         1 000343   200007 756100                    STQ     D$,,AUTO

      233     8295    1         GOTO SE8;

   8295  1 000344   000677 710000 1                  TRA     SE8

   8294  1 000345                       SE7          null
      234     8296        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:46   
      235     8297        /*         PROCESS ASYNCH FLAGS AND RUN STATUS                        */
      236     8298        /*                                                                    */
      237     8299    1   SE7:  ;
      238     8300    1         CALL SSC$SERV;

   8300  1 000345   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000346   000000 701000 xent               TSX1    SSC$SERV
         1 000347   000000 011000                    NOP     0

      239     8301              %LOCK (G#=S_ASFGATE);

   8302  1 000350   000003 630400 2                  EPPR0   3
         1 000351   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000352   000000 701000 xent               TSX1    HFC$LOCK
         1 000353   000000 011000                    NOP     0

      240     8304    1         ASFLAGS=S$CU$->B$U.ASYNCH;

   8304  1 000354   000000 470400 xsym               LDP0    S$CU$
         1 000355   000001 236100                    LDQ     1,,PR0
         1 000356   200015 756100                    STQ     ASFLAGS,,AUTO

      241     8305    2         IF ASFLAGS & %U_FPLDTRC THEN DO;

   8305  1 000357   000017 376000 0                  ANQ     SEV+7
         1 000360   000452 600000 1                  TZE     s:8346

      242     8306    2            S$CU$->B$U.ASYNCH = S$CU$->B$U.ASYNCH & ~%U_FPLDTRC;

   8306  1 000361   000017 236000 0                  LDQ     SEV+7
         1 000362   000027 676000 xsym               ERQ     B_VECTNIL+23
         1 000363   000001 376100                    ANQ     1,,PR0
         1 000364   000001 756100                    STQ     1,,PR0

      243     8307                   %UNLOCK (G#=S_ASFGATE);

   8308  1 000365   000003 630400 2                  EPPR0   3
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:47   
         1 000366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000367   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000370   000000 011000                    NOP     0

   8306  1 000371                       SE70         null
      244     8310
      245     8311                   /* If the LDTRC flag was set, look through the DOLIST events
      246     8312                      for those types of events.                            */
      247     8313
      248     8314    2   SE70:    ;
      249     8315                   %LOCK (G#=S_UDLGATE);

   8316  1 000371   000001 630400 2                  EPPR0   1
         1 000372   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000373   000000 701000 xent               TSX1    HFC$LOCK
         1 000374   000000 011000                    NOP     0

      250     8318    2            D$=S$CU$->B$U.DL$;

   8318  1 000375   000000 470400 xsym               LDP0    S$CU$
         1 000376   000015 236100                    LDQ     13,,PR0
         1 000377   200007 756100                    STQ     D$,,AUTO

      251     8319    3            DO WHILE (D$ ~= ADDR(NIL));

   8319  1 000400   000443 710000 1                  TRA     s:8335

      252     8320    4               IF D$->B$DO.ENTER = ENTADDR(KIF$LDTRC) THEN DO;

   8320  1 000401   000000 636000 xent               EAQ     KIF$LDTRC
         1 000402   200007 470500                    LDP0    D$,,AUTO
         1 000403   000001 116100                    CMPQ    1,,PR0
         1 000404   000433 601000 1                  TNZ     s:8330

      253     8321                         %UNLOCK (G#=S_UDLGATE);

   8322  1 000405   000001 630400 2                  EPPR0   1
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:48   
         1 000406   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000407   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000410   000000 011000                    NOP     0

      254     8324    4                  CALL KIF$LDTRC (D$);

   8324  1 000411   200007 630500                    EPPR0   D$,,AUTO
         1 000412   200024 450500                    STP0    PN+2,,AUTO
         1 000413   200024 630500                    EPPR0   PN+2,,AUTO
         1 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000415   000000 701000 xent               TSX1    KIF$LDTRC
         1 000416   000000 011000                    NOP     0

      255     8325    4                  D$->B$DO.ENTER = ENTADDR(NIL);

   8325  1 000417   000002 236000 xsym               LDQ     B_VECTNIL+2
         1 000420   200007 470500                    LDP0    D$,,AUTO
         1 000421   000001 756100                    STQ     1,,PR0

      256     8326    4                  CALL SSV$XXDO (0,D$);

   8326  1 000422   200007 630500                    EPPR0   D$,,AUTO
         1 000423   200025 450500                    STP0    PN+3,,AUTO
         1 000424   000005 236000 2                  LDQ     5
         1 000425   200024 756100                    STQ     PN+2,,AUTO
         1 000426   200024 630500                    EPPR0   PN+2,,AUTO
         1 000427   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000430   000000 701000 xent               TSX1    SSV$XXDO
         1 000431   000000 011000                    NOP     0

      257     8327    4                  GOTO SE70;

   8327  1 000432   000371 710000 1                  TRA     SE70

      258     8328    4                  END;
      259     8329    4               ELSE DO;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:49   
      260     8330    5                  IF D$->B$DO.CONT THEN DO;

   8330  1 000433   000002 236100                    LDQ     2,,PR0
         1 000434   200000 316003                    CANQ    65536,DU
         1 000435   000440 600000 1                  TZE     s:8333

      261     8331    5                     D$=D$->B$DO.LNK$;

   8331  1 000436   000000 236100                    LDQ     0,,PR0
         1 000437   200007 756100                    STQ     D$,,AUTO

      262     8332    5                     END;

      263     8333    4                  D$=D$->B$DO.LNK$;

   8333  1 000440   200007 470500                    LDP0    D$,,AUTO
         1 000441   000000 236100                    LDQ     0,,PR0
         1 000442   200007 756100                    STQ     D$,,AUTO

      264     8334    4                  END;

      265     8335    3               END;

   8335  1 000443   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000444   000401 601000 1                  TNZ     s:8320

      266     8336                   %UNLOCK (G#=S_UDLGATE);

   8337  1 000445   000001 630400 2                  EPPR0   1
         1 000446   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000447   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000450   000000 011000                    NOP     0

      267     8339
      268     8340                   /* After all the LDTRC events are processed, go back and
      269     8341                      begin asynch checks again.                           */
      270     8342
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:50   
      271     8343    2            GOTO SE4;

   8343  1 000451   000035 710000 1                  TRA     SE4

      272     8344    2            END;
      273     8345
      274     8346    1         S$CU$->B$U.ASYNCH=S$CU$->B$U.ASYNCH & %U_RESET; /* CLEAR FLAGS        */

   8346  1 000452   000001 236100                    LDQ     1,,PR0
         1 000453   000003 376000 xsym               ANQ     B_VECTNIL+3
         1 000454   000001 756100                    STQ     1,,PR0

      275     8347                %UNLOCK (G#=S_ASFGATE);

   8348  1 000455   000003 630400 2                  EPPR0   3
         1 000456   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000457   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000460   000000 011000                    NOP     0

      276     8350        /*         CHECK FOR LINE DISCONNECT                                  */
      277     8351    1         IF ASFLAGS & %U_DISC

   8351  1 000461   200015 236100                    LDQ     ASFLAGS,,AUTO
         1 000462   000020 376000 0                  ANQ     SEV+8
         1 000463   000470 600000 1                  TZE     s:8356

      278     8352    2         THEN DO;

      279     8353    2            CALL ABORTEX(3);

   8353  1 000464   000006 236000 2                  LDQ     6
         1 000465   200017 756100                    STQ     ASFLAGS+2,,AUTO
         1 000466   001476 701000 1                  TSX1    ABORTEX
         1 000467   000000 011000                    NOP     0

      280     8354    2            END;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:51   
      281     8355        /*         CHECK FOR ABORT KEYIN                                      */
      282     8356    1         IF ASFLAGS & %U_ABRT THEN

   8356  1 000470   200015 236100                    LDQ     ASFLAGS,,AUTO
         1 000471   000021 376000 0                  ANQ     SEV+9
         1 000472   000477 600000 1                  TZE     s:8359

      283     8357    1            CALL ABORTEX(0);

   8357  1 000473   000005 236000 2                  LDQ     5
         1 000474   200017 756100                    STQ     ASFLAGS+2,,AUTO
         1 000475   001476 701000 1                  TSX1    ABORTEX
         1 000476   000000 011000                    NOP     0

      284     8358        /*         CHECK IF CANCELED BY USER                                  */
      285     8359    1         IF ASFLAGS & %U_CNCLD THEN

   8359  1 000477   200015 236100                    LDQ     ASFLAGS,,AUTO
         1 000500   000022 376000 0                  ANQ     SEV+10
         1 000501   000511 600000 1                  TZE     s:8365

      286     8360    2         DO;

      287     8361    2            S$CU$->B$U.FLG.CAN = '1'B;

   8361  1 000502   000000 470400 xsym               LDP0    S$CU$
         1 000503   400000 236007                    LDQ     -131072,DL
         1 000504   000000 256100                    ORSQ    0,,PR0

      288     8362    2            CALL ABORTEX(1);

   8362  1 000505   000007 236000 2                  LDQ     7
         1 000506   200017 756100                    STQ     ASFLAGS+2,,AUTO
         1 000507   001476 701000 1                  TSX1    ABORTEX
         1 000510   000000 011000                    NOP     0

      289     8363    2            END;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:52   

      290     8364        /*         CHECK FOR ERR KEYIN                                        */
      291     8365    1         IF ASFLAGS & %U_ERR THEN

   8365  1 000511   200015 236100                    LDQ     ASFLAGS,,AUTO
         1 000512   000023 376000 0                  ANQ     SEV+11
         1 000513   000520 600000 1                  TZE     s:8368

      292     8366    1            CALL ABORTEX(1);

   8366  1 000514   000007 236000 2                  LDQ     7
         1 000515   200017 756100                    STQ     ASFLAGS+2,,AUTO
         1 000516   001476 701000 1                  TSX1    ABORTEX
         1 000517   000000 011000                    NOP     0

      293     8367        /*          CHECK FOR MONITOR LOGOFF             */
      294     8368    1         IF B$JIT.RNST & %RS_OFF# THEN

   8368  1 000520   000000 470400 xsym               LDP0    B$JIT$
         1 000521   000314 236100                    LDQ     204,,PR0
         1 000522   777000 376003                    ANQ     -512,DU
         1 000523   040000 376003                    ANQ     16384,DU
         1 000524   000531 600000 1                  TZE     s:8371

      295     8369    1            CALL ABORTEX(4);

   8369  1 000525   000010 236000 2                  LDQ     8
         1 000526   200017 756100                    STQ     ASFLAGS+2,,AUTO
         1 000527   001476 701000 1                  TSX1    ABORTEX
         1 000530   000000 011000                    NOP     0

      296     8370        /*         CHECK FOR LIMIT EXCEEDED AND NOT IN COMMAND PROCCESSOR     */
      297     8371    1         IF B$JIT.RNST & %RS_LIMX# THEN

   8371  1 000531   000000 470400 xsym               LDP0    B$JIT$
         1 000532   000314 236100                    LDQ     204,,PR0
         1 000533   777000 376003                    ANQ     -512,DU
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:53   
         1 000534   100000 376003                    ANQ     32768,DU
         1 000535   000546 600000 1                  TZE     s:8377

      298     8372    1            IF NOT S$CU$->B$U.FLG.CPIC THEN

   8372  1 000536   000000 471400 xsym               LDP1    S$CU$
         1 000537   100000 236100                    LDQ     0,,PR1
         1 000540   020000 316003                    CANQ    8192,DU
         1 000541   000546 601000 1                  TNZ     s:8377

      299     8373    1               CALL ABORTEX(2);

   8373  1 000542   000011 236000 2                  LDQ     9
         1 000543   200017 756100                    STQ     ASFLAGS+2,,AUTO
         1 000544   001476 701000 1                  TSX1    ABORTEX
         1 000545   000000 011000                    NOP     0

      300     8374        /*         CHECK FOR YC.   CALL CPEXIT FOR INITIAL ENTRY IF YC AND CPIC  */
      301     8375        /*         ARE SET BUT ACP IS ZERO.  IGNORE YC IF CPIC WITH ACP NON ZERO */
      302     8376        /*         OR BATCH.                                                  */
      303     8377    1         IF ASFLAGS & %U_YC THEN

   8377  1 000546   200015 236100                    LDQ     ASFLAGS,,AUTO
         1 000547   000024 376000 0                  ANQ     SEV+12
         1 000550   000651 600000 1                  TZE     s:8402

      304     8378    2         DO;

      305     8379    2            IF S$CU$->B$U.FLG.CPIC THEN

   8379  1 000551   000000 470400 xsym               LDP0    S$CU$
         1 000552   000000 236100                    LDQ     0,,PR0
         1 000553   020000 316003                    CANQ    8192,DU
         1 000554   000624 600000 1                  TZE     s:8393

      306     8380    2               IF S$CU$->B$U.ACP = 0 THEN

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:54   
   8380  1 000555   000006 236100                    LDQ     6,,PR0
         1 000556   000777 316003                    CANQ    511,DU
         1 000557   000615 601000 1                  TNZ     s:8388

      307     8381    3               DO;

      308     8382    3                  CALL SSS$BLOCK;

   8382  1 000560   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000561   000000 701000 xent               TSX1    SSS$BLOCK
         1 000562   000000 011000                    NOP     0

      309     8383    3                  CALL SSC$SERV;

   8383  1 000563   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000564   000000 701000 xent               TSX1    SSC$SERV
         1 000565   000000 011000                    NOP     0

      310     8384    3                  CALL JST$CPEXIT(ADDR(J_LOGON),

   8384  1 000566   000012 236000 2                  LDQ     10
         1 000567   200024 756100                    STQ     PN+2,,AUTO
         1 000570   000013 236000 2                  LDQ     11
         1 000571   200025 756100                    STQ     PN+3,,AUTO
         1 000572   000001 236000 xsym               LDQ     B_VECTNIL+1
         1 000573   200026 756100                    STQ     PN+4,,AUTO
         1 000574   200027 756100                    STQ     PN+5,,AUTO
         1 000575   200030 756100                    STQ     PN+6,,AUTO
         1 000576   200030 630500                    EPPR0   PN+6,,AUTO
         1 000577   200035 450500                    STP0    PN+11,,AUTO
         1 000600   200027 631500                    EPPR1   PN+5,,AUTO
         1 000601   200034 451500                    STP1    PN+10,,AUTO
         1 000602   200026 633500                    EPPR3   PN+4,,AUTO
         1 000603   200033 453500                    STP3    PN+9,,AUTO
         1 000604   200025 634500                    EPPR4   PN+3,,AUTO
         1 000605   200032 454500                    STP4    PN+8,,AUTO
         1 000606   200024 635500                    EPPR5   PN+2,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:55   
         1 000607   200031 455500                    STP5    PN+7,,AUTO
         1 000610   200031 630500                    EPPR0   PN+7,,AUTO
         1 000611   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000612   000000 701000 xent               TSX1    JST$CPEXIT
         1 000613   000000 011000                    NOP     0

      311     8385    3                     ADDR(J_SYSTXT),ADDR(NIL),ADDR(NIL),ADDR(NIL));
      312     8386    3                  END;

   8386  1 000614   000624 710000 1                  TRA     s:8393

      313     8387    2               ELSE
      314     8388    2                  IF B$JIT.STEPS = 0 AND NOT(S$CU$->B$U.FLG.CPIC)

   8388  1 000615   000000 471400 xsym               LDP1    B$JIT$
         1 000616   100315 720100                    LXL0    205,,PR1
         1 000617   000623 601000 1                  TNZ     s:8392
         1 000620   000000 236100                    LDQ     0,,PR0
         1 000621   020000 316003                    CANQ    8192,DU
         1 000622   000133 600000 1                  TZE     SE1A

      315     8389    2                  THEN
      316     8390    2                     GOTO SE1A;           /* Don't let user out of first CP */
      317     8391    2                  ELSE
      318     8392    2                     GOTO SE71;

   8392  1 000623   000654 710000 1                  TRA     SE71

      319     8393    2            IF S$CU$->B$U.MODE = %M_BATCH# THEN

   8393  1 000624   000000 470400 xsym               LDP0    S$CU$
         1 000625   000011 236100                    LDQ     9,,PR0
         1 000626   007700 376007                    ANQ     4032,DL
         1 000627   000100 116007                    CMPQ    64,DL
         1 000630   000133 600000 1                  TZE     SE1A

      320     8394    2               GOTO SE1A;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:56   
      321     8395    2   SET_YC:  B$JIT.CPFLAGS1=B$JIT.CPFLAGS1 | %CP_YC#;

   8395  1 000631   000000 470400 xsym  SET_YC       LDP0    B$JIT$
         1 000632   000143 236100                    LDQ     99,,PR0
         1 000633   000021 276000 0                  ORQ     SEV+9
         1 000634   000143 756100                    STQ     99,,PR0

      322     8396    2            CALL SSS$BLOCK;

   8396  1 000635   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000636   000000 701000 xent               TSX1    SSS$BLOCK
         1 000637   000000 011000                    NOP     0

      323     8397    2            CALL SSC$SERV;

   8397  1 000640   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000641   000000 701000 xent               TSX1    SSC$SERV
         1 000642   000000 011000                    NOP     0

      324     8398    2            CALL UDN$MAGIC;

   8398  1 000643   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000644   000000 701000 xent               TSX1    UDN$MAGIC
         1 000645   000000 011000                    NOP     0

      325     8399    2            CALL JSE$ACP;             /* GET THE COMMAND PROCESSOR          */

   8399  1 000646   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000647   000000 701000 xent               TSX1    JSE$ACP
         1 000650   000000 011000                    NOP     0

      326     8400    2            END;

      327     8401        /*         CHECK FOR BREAK.  CONTINUE USER IF NOT SET.                */
      328     8402    1         IF (ASFLAGS & %U_BRK) = '0'B THEN GOTO SE1A;

   8402  1 000651   200015 236100                    LDQ     ASFLAGS,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:57   
         1 000652   000030 376000 xsym               ANQ     B_VECTNIL+24
         1 000653   000133 600000 1                  TZE     SE1A

      329     8403    1   SE71: EXC=2;

   8403  1 000654   000002 235007       SE71         LDA     2,DL
         1 000655   200006 755100                    STA     EXC,,AUTO

      330     8404    1   SE72: D$=ADDR(ECINFO(0));             /* ECC INFO FOR BREAKS                */

   8404  1 000656   200011 630500       SE72         EPPR0   ECINFO,,AUTO
         1 000657   200007 450500                    STP0    D$,,AUTO

      331     8405    1         IF ASFLAGS & %U_YC THEN

   8405  1 000660   200015 236100                    LDQ     ASFLAGS,,AUTO
         1 000661   000024 376000 0                  ANQ     SEV+12
         1 000662   000666 600000 1                  TZE     s:8408

      332     8406    1            ECINFO(0)=%SC_BYC#;     /* Set YC code if going to CP break proc   */

   8406  1 000663   000001 235007                    LDA     1,DL
         1 000664   200011 755100                    STA     ECINFO,,AUTO
         1 000665   000667 710000 1                  TRA     s:8409

      333     8407    1         ELSE
      334     8408    1            ECINFO(0)=%SC_BRK#;          /* Set Break code                     */

   8408  1 000666   200011 450100                    STZ     ECINFO,,AUTO

      335     8409    1         ECINFO(2)=BITBIN(B$JIT.ERR);

   8409  1 000667   000000 471400 xsym               LDP1    B$JIT$
         1 000670   100012 235100                    LDA     10,,PR1
         1 000671   200013 755100                    STA     ECINFO+2,,AUTO

      336     8410    1         ECINFO(3)=0;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:58   

   8410  1 000672   200014 450100                    STZ     ECINFO+3,,AUTO

      337     8411    1         ECINFO(1)=S$CU$->B$U.BRKCNT;

   8411  1 000673   000000 473400 xsym               LDP3    S$CU$
         1 000674   300011 236100                    LDQ     9,,PR3
         1 000675   000077 376007                    ANQ     63,DL
         1 000676   200012 756100                    STQ     ECINFO+1,,AUTO

      338     8412        /*                                                                    */
      339     8413    1   SE8:  CALL UDN$MAGIC;

   8413  1 000677   000002 631400 xsym  SE8          EPPR1   B_VECTNIL+2
         1 000700   000000 701000 xent               TSX1    UDN$MAGIC
         1 000701   000000 011000                    NOP     0

   8411  1 000702                       SE80         null
      340     8414    1   SE80: ;
      341     8415    2         DO CASE (EXC);

   8415  1 000702   200006 235100                    LDA     EXC,,AUTO
         1 000703   000004 115007                    CMPA    4,DL
         1 000704   000706 602005 1                  TNC     SE80+4,AL
         1 000705   001206 710000 1                  TRA     s:8486
         1 000706   000712 710000 1                  TRA     s:8417
         1 000707   000712 710000 1                  TRA     s:8417
         1 000710   001075 710000 1                  TRA     s:8462
         1 000711   001161 710000 1                  TRA     s:8481

      342     8416    2          CASE(TIMER,EVENT);

      343     8417    2            IF SS$->B$SS.ISR.WSR ~= I THEN GOTO SE82;

   8417  1 000712   000000 470400 xsym               LDP0    B_MPT
         1 000713   000010 236100                    LDQ     8,,PR0
         1 000714   000004 772000                    QRL     4
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:59   
         1 000715   000007 376007                    ANQ     7,DL
         1 000716   200003 116100                    CMPQ    I,,AUTO
         1 000717   001237 601000 1                  TNZ     SE82

      344     8418    2            IF ECCB$->B$ECCBI.FLAGS(EXC) THEN

   8418  1 000720   000005 471400 xsym               LDP1    B_MPT+5
         1 000721   000000 066505                    CMPB    filb='0'B
         1 000722   100004 000001                    BDSC    4,A,PR1                  by=0,bit=0,n=1
         1 000723   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         1 000724   001024 600000 1                  TZE     s:8441

      345     8419    3            DO;

      346     8420    3               IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN

   8420  1 000725   000000 473400 xsym               LDP3    S$CU$
         1 000726   300000 236100                    LDQ     0,,PR3
         1 000727   000025 376000 0                  ANQ     SEV+13
         1 000730   000744 601000 1                  TNZ     s:8425

      347     8421    3                  IF S$CU$->B$U.FLG.DELA AND (I=7) AND (B$JIT.JUNK&%JJ_UDELTA#) THEN

   8421  1 000731   300000 236100                    LDQ     0,,PR3
         1 000732   040000 316003                    CANQ    16384,DU
         1 000733   000743 600000 1                  TZE     s:8421+10
         1 000734   200003 235100                    LDA     I,,AUTO
         1 000735   000007 115007                    CMPA    7,DL
         1 000736   000743 601000 1                  TNZ     s:8421+10
         1 000737   000000 474400 xsym               LDP4    B$JIT$
         1 000740   400315 220100                    LDX0    205,,PR4
         1 000741   200000 360003                    ANX0    65536,DU
         1 000742   001132 601000 1                  TNZ     SE83
         1 000743   000747 710000 1                  TRA     s:8426

      348     8422    3                     GOTO SE83;
      349     8423    3                  ELSE ;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:60   
      350     8424    3               ELSE
      351     8425    3                  IF I > 5 THEN GOTO SE1A;

   8425  1 000744   200003 236100                    LDQ     I,,AUTO
         1 000745   000006 116007                    CMPQ    6,DL
         1 000746   000133 603000 1                  TRC     SE1A

      352     8426    3               IF SS$->B$SS.TCBFLG = 0 THEN

   8426  1 000747   000056 236100                    LDQ     46,,PR0
         1 000750   000777 316007                    CANQ    511,DL
         1 000751   001206 601000 1                  TNZ     s:8486

      353     8427    4   SE84:       DO;

   8427  1 000752                       SE84         null
      354     8428    4                  J=ECCB$->B$ECCBI.ECIC(EXC);

   8428  1 000752   200006 235100                    LDA     EXC,,AUTO
         1 000753   000001 735000                    ALS     1
         1 000754   000005 470400 xsym               LDP0    B_MPT+5
         1 000755   000100 101505                    MRL     fill='000'O
         1 000756   000000 000002                    ADSC9   0,A,PR0                  cn=0,n=2
         1 000757   200004 000004                    ADSC9   J,,AUTO                  cn=0,n=4

      355     8429    4                  CALL SST$SSFTCB(J,EXC,D$->B$$WORD,SS$,TCB$) ALTRET(SE9);

   8429  1 000760   000014 236000 2                  LDQ     12
         1 000761   200030 756100                    STQ     PN+6,,AUTO
         1 000762   000015 236000 2                  LDQ     13
         1 000763   200007 235100                    LDA     D$,,AUTO
         1 000764   200026 757100                    STAQ    PN+4,,AUTO
         1 000765   200006 631500                    EPPR1   EXC,,AUTO
         1 000766   200025 451500                    STP1    PN+3,,AUTO
         1 000767   200004 633500                    EPPR3   J,,AUTO
         1 000770   200024 453500                    STP3    PN+2,,AUTO
         1 000771   200024 630500                    EPPR0   PN+2,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:61   
         1 000772   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000773   000000 701000 xent               TSX1    SST$SSFTCB
         1 000774   001207 702000 1                  TSX2    SE9

      356     8430    4                  SS$->B$SS.TCBFLG = EXC;

   8430  1 000775   000000 470400 xsym               LDP0    B_MPT
         1 000776   200006 236100                    LDQ     EXC,,AUTO
         1 000777   000056 552104                    STBQ    46,'04'O,PR0

      357     8431    5                  DO CASE(EXC);

   8431  1 001000   000002 116007                    CMPQ    2,DL
         1 001001   001003 602006 1                  TNC     s:8431+3,QL
         1 001002   001206 710000 1                  TRA     s:8486
         1 001003   001005 710000 1                  TRA     s:8433
         1 001004   001013 710000 1                  TRA     s:8436

      358     8432    5                   CASE(TIMER);

      359     8433    5                     ECCB$->B$ECCBI.FLAGS(0)='0'B;

   8433  1 001005   000005 471400 xsym               LDP1    B_MPT+5
         1 001006   000031 236000 xsym               LDQ     B_VECTNIL+25
         1 001007   100004 356100                    ANSQ    4,,PR1

      360     8434    5                     B$JIT.UTIMER=0;

   8434  1 001010   000000 471400 xsym               LDP1    B$JIT$
         1 001011   100301 450100                    STZ     193,,PR1
         1 001012   001206 710000 1                  TRA     s:8486

      361     8435    5                   CASE(EVENT);

      362     8436    5                     CALL SSV$XXDO(0,DD$);

   8436  1 001013   200010 631500                    EPPR1   DD$,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:62   
         1 001014   200025 451500                    STP1    PN+3,,AUTO
         1 001015   000005 236000 2                  LDQ     5
         1 001016   200024 756100                    STQ     PN+2,,AUTO
         1 001017   200024 630500                    EPPR0   PN+2,,AUTO
         1 001020   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001021   000000 701000 xent               TSX1    SSV$XXDO
         1 001022   000000 011000                    NOP     0

      363     8437    5                   END;

      364     8438    4                  END;

      365     8439    3               END;

   8439  1 001023   001206 710000 1                  TRA     s:8486

      366     8440    2            ELSE
      367     8441    2               IF EXC = EVENT THEN

   8441  1 001024   000001 115007                    CMPA    1,DL
         1 001025   001271 601000 1                  TNZ     SE85

      368     8442    3               DO;

      369     8443    3                  IF DD$->B$DO.SAVE THEN

   8443  1 001026   200010 473500                    LDP3    DD$,,AUTO
         1 001027   300002 236100                    LDQ     2,,PR3
         1 001030   040000 316003                    CANQ    16384,DU
         1 001031   000133 601000 1                  TNZ     SE1A

      370     8444    3                     GOTO SE1A;       /* RETAIN IT UNTIL HE'S READY*/
      371     8445    3                  I=B_MPT.SSDESC$->B$$DESCR.BASE; /* IF RETURNING TO        */

   8445  1 001032   000006 474400 xsym               LDP4    B_MPT+6
         1 001033   400001 235100                    LDA     1,,PR4
         1 001034   200003 755100                    STA     I,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:63   

      372     8446    3                  CALL UDN$MAGIC;     /* DOMAIN THAT THE EVENT IS           */

   8446  1 001035   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001036   000000 701000 xent               TSX1    UDN$MAGIC
         1 001037   000000 011000                    NOP     0

      373     8447    3                  IF I ~= B_MPT.SSDESC$->B$$DESCR.BASE THEN /* FOR, GO. ELSE WAIT*/

   8447  1 001040   000006 470400 xsym               LDP0    B_MPT+6
         1 001041   200003 236100                    LDQ     I,,AUTO
         1 001042   000133 604000 1                  TMI     SE1A
         1 001043   000001 116100                    CMPQ    1,,PR0
         1 001044   000133 601000 1                  TNZ     SE1A

      374     8448    3                     GOTO SE1A;       /* UNTIL GOING TO HIM.                */
      375     8449    3                  CALL SSV$XXDO(0,DD$); /* DISCARD IT                       */

   8449  1 001045   200010 631500                    EPPR1   DD$,,AUTO
         1 001046   200025 451500                    STP1    PN+3,,AUTO
         1 001047   000005 236000 2                  LDQ     5
         1 001050   200024 756100                    STQ     PN+2,,AUTO
         1 001051   200024 630500                    EPPR0   PN+2,,AUTO
         1 001052   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001053   000000 701000 xent               TSX1    SSV$XXDO
         1 001054   000000 011000                    NOP     0

      376     8450    3                  B$JIT.ERR='232321400006'O;

   8450  1 001055   000026 236000 0                  LDQ     SEV+14
         1 001056   000000 470400 xsym               LDP0    B$JIT$
         1 001057   000012 756100                    STQ     10,,PR0

      377     8451        /*E*    ERROR: SSQ-E$NOEVENT-6
      378     8452                MESSAGE: No event procedure for this event                      */
      379     8453    3                  B$JIT.ERR.CODE=%E$NOEVENT;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:64   
   8453  1 001060   000016 376000 2                  ANQ     14
         1 001061   007570 276007                    ORQ     3960,DL
         1 001062   000012 756100                    STQ     10,,PR0

      380     8454    3                  CALL SSS$BLOCK;

   8454  1 001063   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001064   000000 701000 xent               TSX1    SSS$BLOCK
         1 001065   000000 011000                    NOP     0

      381     8455    3                  CALL SSC$SERV;

   8455  1 001066   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001067   000000 701000 xent               TSX1    SSC$SERV
         1 001070   000000 011000                    NOP     0

      382     8456    3                  CALL JSE$ABORTM;    /* NO EVENT HANDLER--                 */

   8456  1 001071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001072   000000 701000 xent               TSX1    JSE$ABORTM
         1 001073   000000 011000                    NOP     0

      383     8457    3                  END;

   8457  1 001074   001206 710000 1                  TRA     s:8486

      384     8458    2               ELSE
      385     8459    2                  GOTO SE85;
      386     8460    2          CASE(BREAK);

      387     8461        /*         Defer breaks to user level if in M$YC pmme                 */
      388     8462    2            IF S$CU$->B$U.FLG.CPIC AND (B$JIT.CPFLAGS1 & %CP_YCPMME#)

   8462  1 001075   000000 470400 xsym               LDP0    S$CU$
         1 001076   000000 236100                    LDQ     0,,PR0
         1 001077   020000 316003                    CANQ    8192,DU
         1 001100   001113 600000 1                  TZE     s:8468
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:65   
         1 001101   000000 471400 xsym               LDP1    B$JIT$
         1 001102   100143 236100                    LDQ     99,,PR1
         1 001103   000022 376000 0                  ANQ     SEV+10
         1 001104   001113 600000 1                  TZE     s:8468
         1 001105   200011 236100                    LDQ     ECINFO,,AUTO
         1 001106   001113 601000 1                  TNZ     s:8468

      389     8463    2               AND ECINFO(0) = %SC_BRK# THEN
      390     8464    3            DO;

      391     8465    3               B$JIT.JUNK2 = B$JIT.JUNK2 | %JJ2_DFRBRK#;

   8465  1 001107   100321 220100                    LDX0    209,,PR1
         1 001110   000004 260003                    ORX0    4,DU
         1 001111   100321 740100                    STX0    209,,PR1

      392     8466    3               GOTO SE1A;

   8466  1 001112   000133 710000 1                  TRA     SE1A

      393     8467    3               END;
      394     8468    2            IF SS$->B$SS.ISR.WSR = 6 THEN

   8468  1 001113   000000 471400 xsym               LDP1    B_MPT
         1 001114   100010 236100                    LDQ     8,,PR1
         1 001115   000160 376007                    ANQ     112,DL
         1 001116   000140 116007                    CMPQ    96,DL
         1 001117   001142 600000 1                  TZE     SE87

      395     8469    2               GOTO SE87;
      396     8470    2            IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) AND S$CU$->B$U.FLG.DELA

   8470  1 001120   000000 236100                    LDQ     0,,PR0
         1 001121   000025 376000 0                  ANQ     SEV+13
         1 001122   001142 601000 1                  TNZ     SE87
         1 001123   000000 236100                    LDQ     0,,PR0
         1 001124   040000 316003                    CANQ    16384,DU
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:66   
         1 001125   001142 600000 1                  TZE     SE87
         1 001126   000000 473400 xsym               LDP3    B$JIT$
         1 001127   300315 220100                    LDX0    205,,PR3
         1 001130   200000 360003                    ANX0    65536,DU
         1 001131   001142 600000 1                  TZE     SE87

      397     8471    2               AND (B$JIT.JUNK & %JJ_UDELTA#) THEN
      398     8472    2   SE83:       CALL SSU$DELTAGO(EXC,D$->B$$WORD);

   8472  1 001132   200007 236100       SE83         LDQ     D$,,AUTO
         1 001133   200025 756100                    STQ     PN+3,,AUTO
         1 001134   200006 630500                    EPPR0   EXC,,AUTO
         1 001135   200024 450500                    STP0    PN+2,,AUTO
         1 001136   200024 630500                    EPPR0   PN+2,,AUTO
         1 001137   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001140   000000 701000 xent               TSX1    SSU$DELTAGO
         1 001141   000000 011000                    NOP     0

      399     8473    2   SE87:    IF ECCB$->B$ECCBI.FLAGS(BREAK) THEN

   8473  1 001142   000005 470400 xsym  SE87         LDP0    B_MPT+5
         1 001143   000004 236100                    LDQ     4,,PR0
         1 001144   100000 316003                    CANQ    32768,DU
         1 001145   001154 600000 1                  TZE     s:8478

      400     8474    2               IF SS$->B$SS.TCBFLG ~= BREAK THEN

   8474  1 001146   000000 471400 xsym               LDP1    B_MPT
         1 001147   100056 236100                    LDQ     46,,PR1
         1 001150   000777 376007                    ANQ     511,DL
         1 001151   000002 116007                    CMPQ    2,DL
         1 001152   000752 601000 1                  TNZ     SE84
         1 001153   001206 710000 1                  TRA     s:8486

      401     8475    2                  GOTO SE84;
      402     8476    2               ELSE ;
      403     8477    2            ELSE
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:67   
      404     8478    2               IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN

   8478  1 001154   000000 471400 xsym               LDP1    S$CU$
         1 001155   100000 236100                    LDQ     0,,PR1
         1 001156   000025 376000 0                  ANQ     SEV+13
         1 001157   001237 600000 1                  TZE     SE82
         1 001160   001206 710000 1                  TRA     s:8486

      405     8479    2                  GOTO SE82;
      406     8480    2          CASE(DTABRK);

      407     8481    2            EXC=%ECC_DBRK#;

   8481  1 001161   000141 236007                    LDQ     97,DL
         1 001162   200006 756100                    STQ     EXC,,AUTO

      408     8482    2            IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) AND S$CU$->B$U.FLG.DELA

   8482  1 001163   000000 470400 xsym               LDP0    S$CU$
         1 001164   000000 236100                    LDQ     0,,PR0
         1 001165   000025 376000 0                  ANQ     SEV+13
         1 001166   001206 601000 1                  TNZ     s:8486
         1 001167   000000 236100                    LDQ     0,,PR0
         1 001170   040000 316003                    CANQ    16384,DU
         1 001171   001206 600000 1                  TZE     s:8486
         1 001172   000000 471400 xsym               LDP1    B$JIT$
         1 001173   100315 220100                    LDX0    205,,PR1
         1 001174   200000 360003                    ANX0    65536,DU
         1 001175   001206 600000 1                  TZE     s:8486

      409     8483    2               AND (B$JIT.JUNK & %JJ_UDELTA#) THEN
      410     8484    2               CALL SSU$DELTAGO(EXC,D$->B$$WORD);

   8484  1 001176   200007 236100                    LDQ     D$,,AUTO
         1 001177   200025 756100                    STQ     PN+3,,AUTO
         1 001200   200006 633500                    EPPR3   EXC,,AUTO
         1 001201   200024 453500                    STP3    PN+2,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:68   
         1 001202   200024 630500                    EPPR0   PN+2,,AUTO
         1 001203   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001204   000000 701000 xent               TSX1    SSU$DELTAGO
         1 001205   000000 011000                    NOP     0

      411     8485    2          END;

      412     8486    1         GOTO SE1A;

   8486  1 001206   000133 710000 1                  TRA     SE1A

      413     8487        /*                                                                    */
      414     8488    1   SE9:  B$JIT.ERR='232321400006'O;

   8488  1 001207   000026 236000 0     SE9          LDQ     SEV+14
         1 001210   000000 470400 xsym               LDP0    B$JIT$
         1 001211   000012 756100                    STQ     10,,PR0

      415     8489    1         B$JIT.ERR.CODE=%E$TCBFULL;

   8489  1 001212   000016 376000 2                  ANQ     14
         1 001213   007630 276007                    ORQ     3992,DL
         1 001214   000012 756100                    STQ     10,,PR0

      416     8490    1         CALL SSS$BLOCK;

   8490  1 001215   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001216   000000 701000 xent               TSX1    SSS$BLOCK
         1 001217   000000 011000                    NOP     0

      417     8491    1         CALL SSC$SERV;

   8491  1 001220   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001221   000000 701000 xent               TSX1    SSC$SERV
         1 001222   000000 011000                    NOP     0

      418     8492    1         CALL JSE$ABORTM;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:69   

   8492  1 001223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001224   000000 701000 xent               TSX1    JSE$ABORTM
         1 001225   000000 011000                    NOP     0

      419     8493    1   SE91: CALL SSV$XXDO(0,DD$);           /* DON'T GO TO USER                   */

   8493  1 001226   200010 630500       SE91         EPPR0   DD$,,AUTO
         1 001227   200025 450500                    STP0    PN+3,,AUTO
         1 001230   000005 236000 2                  LDQ     5
         1 001231   200024 756100                    STQ     PN+2,,AUTO
         1 001232   200024 630500                    EPPR0   PN+2,,AUTO
         1 001233   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001234   000000 701000 xent               TSX1    SSV$XXDO
         1 001235   000000 011000                    NOP     0

      420     8494    1         GOTO SE5;

   8494  1 001236   000052 710000 1                  TRA     SE5

      421     8495        /*                                                                    */
      422     8496        /*                                                                    */
      423     8497        /*         GET THE NEXT FRAME FROM SS                                 */
      424     8498    1   SE82: IF SS$->B$SS.SCR = '0'B THEN J=64; ELSE J=256;

   8498  1 001237   000000 470400 xsym  SE82         LDP0    B_MPT
         1 001240   000005 236100                    LDQ     5,,PR0
         1 001241   030000 316007                    CANQ    12288,DL
         1 001242   001246 601000 1                  TNZ     s:8498+3

   8498  1 001243   000100 235007                    LDA     64,DL
         1 001244   200004 755100                    STA     J,,AUTO
         1 001245   001250 710000 1                  TRA     s:8499

   8498  1 001246   000400 235007                    LDA     256,DL
         1 001247   200004 755100                    STA     J,,AUTO

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:70   
      425     8499    1         B_MPT.SSDESC$->B$$DESCR.BASE=B_MPT.SSDESC$->B$$DESCR.BASE-J;

   8499  1 001250   000006 471400 xsym               LDP1    B_MPT+6
         1 001251   100001 236100                    LDQ     1,,PR1
         1 001252   200004 136100                    SBLQ    J,,AUTO
         1 001253   100001 756100                    STQ     1,,PR1

      426     8500    1         IF NOT (SS$->B$SS.ISR.FLAGS & '010'O) AND

   8500  1 001254   000010 236100                    LDQ     8,,PR0
         1 001255   000024 736000                    QLS     20
         1 001256   777000 376003                    ANQ     -512,DU
         1 001257   010000 376003                    ANQ     4096,DU
         1 001260   001265 601000 1                  TNZ     s:8505
         1 001261   000010 236100                    LDQ     8,,PR0
         1 001262   000160 376007                    ANQ     112,DL
         1 001263   000160 116007                    CMPQ    112,DL
         1 001264   001271 600000 1                  TZE     SE85

      427     8501    1            SS$->B$SS.ISR.WSR = 7 THEN
      428     8502    1            GOTO SE85;
      429     8503    1         ELSE
      430     8504    2         DO;

      431     8505    2            CALL UDN$MAGICSS;

   8505  1 001265   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001266   000000 701000 xent               TSX1    UDN$MAGICSS
         1 001267   000000 011000                    NOP     0

      432     8506    2            GOTO SE80;

   8506  1 001270   000702 710000 1                  TRA     SE80

      433     8507    2            END;
      434     8508        /*         END OF STACK AT NO EXECUTE FLAG                            */
      435     8509        /*                                                                    */
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:71   
      436     8510    2   SE85: DO CASE(EXC);

   8510  1 001271   200006 235100       SE85         LDA     EXC,,AUTO
         1 001272   000003 115007                    CMPA    3,DL
         1 001273   001275 602005 1                  TNC     SE85+4,AL
         1 001274   001466 710000 1                  TRA     s:8567
         1 001275   001300 710000 1                  TRA     s:8512
         1 001276   001304 710000 1                  TRA     s:8520
         1 001277   001303 710000 1                  TRA     s:8517

      437     8511    2          CASE(TIMER);

      438     8512    2            CALL SC_UTIMER;              /* UNWANTED UTIMER                    */

   8512  1 001300   000000 713400 xsym               CLIMB   SC_UTIMER
         1 001301   000000 600000 xsid               climb   nvectors=         0
         1 001302   001466 710000 1                  TRA     s:8567

      439     8513        /*S*    SCREECH_CODE: SSQ-S$UTIMER
      440     8514                TYPE: SCREECH
      441     8515                MESSAGE: UTIMER runout without user timer service request     */
      442     8516    2          CASE(BREAK);

      443     8517    2            GOTO SET_YC;

   8517  1 001303   000631 710000 1                  TRA     SET_YC

      444     8518    2          CASE(EVENT);

      445     8519        /*         EVENT FOR AN INACTIVE DOMAIN                               */
      446     8520    2            CALL UDN$MAGIC;

   8520  1 001304   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001305   000000 701000 xent               TSX1    UDN$MAGIC
         1 001306   000000 011000                    NOP     0

      447     8521    3            DO CASE(I);
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:72   

   8521  1 001307   200003 235100                    LDA     I,,AUTO
         1 001310   000010 115007                    CMPA    8,DL
         1 001311   001313 602005 1                  TNC     s:8521+4,AL
         1 001312   001366 710000 1                  TRA     s:8542
         1 001313   001323 710000 1                  TRA     s:8523
         1 001314   001366 710000 1                  TRA     s:8542
         1 001315   001366 710000 1                  TRA     s:8542
         1 001316   001366 710000 1                  TRA     s:8542
         1 001317   001324 710000 1                  TRA     s:8525
         1 001320   001332 710000 1                  TRA     s:8527
         1 001321   001345 710000 1                  TRA     s:8533
         1 001322   001357 710000 1                  TRA     s:8537

      448     8522    3             CASE (0);

      449     8523    3               GOTO SE91;

   8523  1 001323   001226 710000 1                  TRA     SE91

      450     8524    3             CASE (4);

      451     8525    3               B_MPT.LSDESC$->B$$DESCR=B$LS$->B$MLNK.CPLS; /* GET A LSEG DESC  */

   8525  1 001324   000007 470400 xsym               LDP0    B_MPT+7
         1 001325   000000 471400 xsym               LDP1    B$LS$
         1 001326   100070 237100                    LDAQ    56,,PR1
         1 001327   000000 755100                    STA     0,,PR0
         1 001330   000001 756100                    STQ     1,,PR0
         1 001331   001366 710000 1                  TRA     s:8542

      452     8526    3             CASE(5);

      453     8527    3               IF S$CU$->B$U.FLG.DELA/*if Delta associated with this process*/

   8527  1 001332   000000 470400 xsym               LDP0    S$CU$
         1 001333   000000 236100                    LDQ     0,,PR0
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:73   
         1 001334   040000 316003                    CANQ    16384,DU
         1 001335   001226 600000 1                  TZE     SE91
         1 001336   000000 471400 xsym               LDP1    B$JIT$
         1 001337   100315 220100                    LDX0    205,,PR1
         1 001340   200000 360003                    ANX0    65536,DU
         1 001341   001226 600000 1                  TZE     SE91

      454     8528    3                  AND (B$JIT.JUNK & %JJ_UDELTA#)/*not from ALIB*/
      455     8529    3               THEN IF S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN GOTO SE1A;

   8529  1 001342   000025 376000 0                  ANQ     SEV+13
         1 001343   000133 601000 1                  TNZ     SE1A

      456     8530    3                  ELSE GOTO SE83;

   8530  1 001344   001132 710000 1                  TRA     SE83

      457     8531    3               ELSE GOTO SE91;
      458     8532    3             CASE(6);

      459     8533    3               IF S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) THEN

   8533  1 001345   000000 470400 xsym               LDP0    S$CU$
         1 001346   000000 236100                    LDQ     0,,PR0
         1 001347   000025 376000 0                  ANQ     SEV+13
         1 001350   000133 601000 1                  TNZ     SE1A

      460     8534    3                  GOTO SE1A;
      461     8535    3               B_MPT.LSDESC$->B$$DESCR=B$LS$->B$MLNK.ASLLS;

   8535  1 001351   000007 471400 xsym               LDP1    B_MPT+7
         1 001352   000000 473400 xsym               LDP3    B$LS$
         1 001353   300066 237100                    LDAQ    54,,PR3
         1 001354   100000 755100                    STA     0,,PR1
         1 001355   100001 756100                    STQ     1,,PR1
         1 001356   001366 710000 1                  TRA     s:8542

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:74   
      462     8536    3             CASE(7);

      463     8537    3               IF B$JIT.XCONF & %XC_URND# THEN

   8537  1 001357   000000 470400 xsym               LDP0    B$JIT$
         1 001360   000316 236100                    LDQ     206,,PR0
         1 001361   777000 376003                    ANQ     -512,DU
         1 001362   004000 376003                    ANQ     2048,DU
         1 001363   001226 601000 1                  TNZ     SE91

      464     8538    3                  GOTO SE91;        /* USER IN EXIT CONTROL WHEN EVENT HIT     */
      465     8539    3               ELSE
      466     8540    3                  CALL SC_ASLEVNT;

   8540  1 001364   000000 713400 xsym               CLIMB   SC_ASLEVNT
         1 001365   000000 600000 xsid               climb   nvectors=         0

      467     8541    3             END;

      468     8542    2            CALL UDN$MAGICLS;

   8542  1 001366   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001367   000000 701000 xent               TSX1    UDN$MAGICLS
         1 001370   000000 011000                    NOP     0

      469     8543                                                /*                                    */
      470     8544    2            IF ECCB$->B$ECCBI.FLAGS(EVENT) THEN

   8544  1 001371   000005 470400 xsym               LDP0    B_MPT+5
         1 001372   000004 236100                    LDQ     4,,PR0
         1 001373   200000 316003                    CANQ    65536,DU
         1 001374   001464 600000 1                  TZE     s:8563

      471     8545    3            DO;

      472     8546    3               CALL SST$SSFTCB(-1,EXC,D$->B$$WORD,SS$,TCB$);

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:75   
   8546  1 001375   000014 236000 2                  LDQ     12
         1 001376   200030 756100                    STQ     PN+6,,AUTO
         1 001377   000015 236000 2                  LDQ     13
         1 001400   200007 235100                    LDA     D$,,AUTO
         1 001401   200026 757100                    STAQ    PN+4,,AUTO
         1 001402   200006 631500                    EPPR1   EXC,,AUTO
         1 001403   200025 451500                    STP1    PN+3,,AUTO
         1 001404   000017 236000 2                  LDQ     15
         1 001405   200024 756100                    STQ     PN+2,,AUTO
         1 001406   200024 630500                    EPPR0   PN+2,,AUTO
         1 001407   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001410   000000 701000 xent               TSX1    SST$SSFTCB
         1 001411   000000 011000                    NOP     0

      473     8547    4               DO INHIBIT;

      474     8548    4                  CALL SSV$XXDO (0,DD$);

   8548  1 001412   200010 630700                    EPPR0 ! DD$,,AUTO
         1 001413   200025 450700                    STP0  ! PN+3,,AUTO
         1 001414   000005 236200 2                  LDQ   ! 5
         1 001415   200024 756300                    STQ   ! PN+2,,AUTO
         1 001416   200024 630700                    EPPR0 ! PN+2,,AUTO
         1 001417   000020 631600 xsym               EPPR1 ! B_VECTNIL+16
         1 001420   000000 701200 xent               TSX1  ! SSV$XXDO
         1 001421   000000 011200                    NOP   ! 0

      475     8549    5                  DO CASE (I);        /* GET AN ENTRY DSCR FROM USER LSEG   */

   8549  1 001422   200003 235300                    LDA   ! I,,AUTO
         1 001423   000004 135207                    SBLA  ! 4,DL
         1 001424   000003 115207                    CMPA  ! 3,DL
         1 001425   001427 602205 1                  TNC   ! s:8549+5,AL
         1 001426   001450 710200 1                  TRA   ! s:8558
         1 001427   001432 710200 1                  TRA   ! s:8551
         1 001430   001437 710200 1                  TRA   ! s:8553
         1 001431   001444 710200 1                  TRA   ! s:8555
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:76   

      476     8550    5                   CASE (4);

      477     8551    5                     B$LS$->B$MLNK.MISC2=B$SDS0$->B$SDS.ACPENT;

   8551  1 001432   000000 470600 xsym               LDP0  ! B$SDS0$
         1 001433   000006 237300                    LDAQ  ! 6,,PR0
         1 001434   000000 471600 xsym               LDP1  ! B$LS$
         1 001435   100260 757300                    STAQ  ! 176,,PR1
         1 001436   001450 710200 1                  TRA   ! s:8558

      478     8552    5                   CASE (5);

      479     8553    5                     B$LS$->B$MLNK.MISC2=B$SDS0$->B$SDS.DBENT;

   8553  1 001437   000000 470600 xsym               LDP0  ! B$SDS0$
         1 001440   000004 237300                    LDAQ  ! 4,,PR0
         1 001441   000000 471600 xsym               LDP1  ! B$LS$
         1 001442   100260 757300                    STAQ  ! 176,,PR1
         1 001443   001450 710200 1                  TRA   ! s:8558

      480     8554    5                   CASE(6);

      481     8555    5                     B$LS$->B$MLNK.MISC2=B$USERLS$->B$ULNK.ASLENT;

   8555  1 001444   000000 470600 xsym               LDP0  ! B$USERLS$
         1 001445   000052 237300                    LDAQ  ! 42,,PR0
         1 001446   000000 471600 xsym               LDP1  ! B$LS$
         1 001447   100260 757300                    STAQ  ! 176,,PR1

      482     8556    5                   END;

      483     8557        /*                 INSERT THE EVENT ENTRY ADDR                                */
      484     8558    4                  ADDR(B$LS$->B$MLNK.MISC2)->ENTDESCR.ENTLOC=ECCB$->B$ECCBI.ECIC(1);

   8558  1 001450   000005 470600 xsym               LDP0  ! B_MPT+5
         1 001451   000000 720300                    LXL0  ! 0,,PR0
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:77   
         1 001452   000000 471600 xsym               LDP1  ! B$LS$
         1 001453   100260 740300                    STX0  ! 176,,PR1

      485     8559    4                  CALL SSS$LTRD(ADDR(B$MLS1$->B$MLNK.MISC2)->ENTDESCR);
              8559                           /* GO TO EVENT DOMAIN */

   8559  1 001454   000000 236200 xsym               LDQ   ! B$MLS1$
         1 001455   000260 036203                    ADLQ  ! 176,DU
         1 001456   200024 756300                    STQ   ! PN+2,,AUTO
         1 001457   200024 630700                    EPPR0 ! PN+2,,AUTO
         1 001460   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 001461   000000 701200 xent               TSX1  ! SSS$LTRD
         1 001462   000000 011200                    NOP   ! 0

      486     8560    4                  END;                   /* INHIBIT                            */

      487     8561    3               END;

   8561  1 001463   001466 710000 1                  TRA     s:8567

      488     8562    2            ELSE
      489     8563    2               CALL SC_ASLEVNT;

   8563  1 001464   000000 713400 xsym               CLIMB   SC_ASLEVNT
         1 001465   000000 600000 xsid               climb   nvectors=         0

      490     8564        /*S*    SCREECH_CODE: SSQ-S$NOASLEVNT
      491     8565                TYPE: SUA
      492     8566                MESSAGE: No event procedure in ASL, CP or DB for this event.  */
      493     8567    2          END;

   8567  1 001466   001471 710000 1                  TRA     s:8570

      494     8568        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:78   
      495     8569    1   SSQ$NUQUAN: ENTRY ALTRET;               /* GIVE USER NEW QUANTUM              */

   8569  1 001467   000000 700200 xent  SSQ$NUQUAN   TSX0  ! X66_AUTO_0
         1 001470   000036 000000                    ZERO    30,0

      496     8570    1         CALL ACCTEX;

   8570  1 001471   001550 701000 1                  TSX1    ACCTEX
         1 001472   000000 011000                    NOP     0

      497     8571    1         S_UXTSCHD = 0;

   8571  1 001473   000000 450000 xsym               STZ     S_UXTSCHD

      498     8572    1         S_USTSCHD = 0;

   8572  1 001474   000000 450000 xsym               STZ     S_USTSCHD

      499     8573    1         RETURN;

   8573  1 001475   000000 702200 xent               TSX2  ! X66_ARET

      500     8574        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:79   
      501     8575        /*                                                                    */
      502     8576        /*    SET JIT.RNST ACCORDING TO STATUS                                */
      503     8577        /*                                                                    */
      504     8578    1   ABORTEX: PROC(STATUS);

   8578  1 001476   200016 741300       ABORTEX      STX1  ! ASFLAGS+1,,AUTO

      505     8579    2   DCL   STATUS UBIN(36);
      506     8580    2   DCL    RNSTAT(0:4) CONSTANT BIT(9) INIT(%RS_XKEY#,%RS_EKEY#,%RS_LIMX#,%RS_DROP#,%
              8580            RS_OFF#);
      507     8581    2   DCL    JERR(0:4) CONSTANT UBIN(14) INIT(%E$XKEY,%E$EKEY,%E$LIMX,%E$DROP,%E$OFF);
      508     8582    2   DCL    SEV(0:4) CONSTANT UBIN(3) INIT(6,4,4,6,6);
      509     8583        /*                                                                    */
      510     8584    2         B$JIT.RNST = (B$JIT.RNST | RNSTAT(STATUS) );

   8584  1 001477   200017 470500                    LDP0    @STATUS,,AUTO
         1 001500   000000 235100                    LDA     0,,PR0
         1 001501   000100 100405                    MLR     fill='000'O
         1 001502   000001 000001 0                  ADSC9   RNSTAT,A                 cn=0,n=1
         1 001503   200024 000004                    ADSC9   PN+2,,AUTO               cn=0,n=4
         1 001504   000000 471400 xsym               LDP1    B$JIT$
         1 001505   100314 236100                    LDQ     204,,PR1
         1 001506   777000 376003                    ANQ     -512,DU
         1 001507   200024 276100                    ORQ     PN+2,,AUTO
         1 001510   100314 552140                    STBQ    204,'40'O,PR1

      511     8585    2         IF B$JIT.ERR.SEV = 0

   8585  1 001511   100012 236100                    LDQ     10,,PR1
         1 001512   000007 316007                    CANQ    7,DL
         1 001513   001532 601000 1                  TNZ     s:8591

      512     8586    3         THEN DO;

      513     8587    3            B$JIT.ERR='232321400006'O;

   8587  1 001514   000026 236000 0                  LDQ     SEV+14
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:80   
         1 001515   100012 756100                    STQ     10,,PR1

      514     8588    3            B$JIT.ERR.CODE=JERR(STATUS);

   8588  1 001516   000000 720100                    LXL0    0,,PR0
         1 001517   000003 236010 0                  LDQ     JERR,X0
         1 001520   000023 772000                    QRL     19
         1 001521   100012 676100                    ERQ     10,,PR1
         1 001522   377770 376007                    ANQ     131064,DL
         1 001523   100012 656100                    ERSQ    10,,PR1

      515     8589    3            B$JIT.ERR.SEV=SEV(STATUS);

   8589  1 001524   000000 720100                    LXL0    0,,PR0
         1 001525   000010 236010 0                  LDQ     SEV,X0
         1 001526   000041 772000                    QRL     33
         1 001527   100012 676100                    ERQ     10,,PR1
         1 001530   000007 376007                    ANQ     7,DL
         1 001531   100012 656100                    ERSQ    10,,PR1

      516     8590    3            END;

      517     8591    2         CALL SSS$BLOCK;

   8591  1 001532   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001533   000000 701000 xent               TSX1    SSS$BLOCK
         1 001534   000000 011000                    NOP     0

      518     8592    2         CALL SSC$SERV;

   8592  1 001535   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001536   000000 701000 xent               TSX1    SSC$SERV
         1 001537   000000 011000                    NOP     0

      519     8593    2         CALL UDN$BLDASR;

   8593  1 001540   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:81   
         1 001541   000000 701000 xent               TSX1    UDN$BLDASR
         1 001542   000000 011000                    NOP     0

      520     8594    2         CALL JSE$ABORTX;

   8594  1 001543   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001544   000000 701000 xent               TSX1    JSE$ABORTX
         1 001545   000000 011000                    NOP     0

      521     8595        /*E*   ERROR:  SSQ-E$XKEY-6
      522     8596               MESSAGE:  Job aborted by the operator
      523     8597        */
      524     8598        /*E*   ERROR:  SSQ-E$EKEY-4
      525     8599               MESSAGE:  Job errored by the operator
      526     8600        */
      527     8601        /*E*   ERROR:   SSQ-E$LIMX-4
      528     8602               MESSAGE: Limit exceeded; consult M$XCON (B$XCON.LIMIT) to
      529     8603                        determine which limit.
      530     8604        */
      531     8605        /*E*   ERROR:   SSQ-E$DROP-6
      532     8606               MESSAGE:  Line disconnect
      533     8607        */
      534     8608        /*E*   ERROR:   SSQ-E$OFF-6
      535     8609               MESSAGE:   Monitor has canceled the job
      536     8610        */
      537     8611    2   END;

   8611  1 001546   200016 221300                    LDX1  ! ASFLAGS+1,,AUTO
         1 001547   000001 702211                    TSX2  ! 1,X1

      538     8612        %EJECT;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:82   
      539     8613        /*                QUANTUM END ACCOUNTING PROCEDURE                    */
      540     8614        /*                                                                    */
      541     8615    1   ACCTEX: PROC;

   8615  1 001550   200016 741300       ACCTEX       STX1  ! ASFLAGS+1,,AUTO

      542     8616    2   DCL   CT UBIN(36);
      543     8617    2   DCL   XT SBIN(36);
      544     8618    2   DCL   ST SBIN(36);
      545     8619    2   DCL   PN UBIN(36);
      546     8620    2   DCL   SL_QUAN UBIN(36) SYMREF;
      547     8621        /*                                                                    */
      548     8622    3         DO INHIBIT;                     /* INHIBIT UNTIL PARKED               */

      549     8623        /*         SET QUANTUM TIME                                           */
      550     8624    3            IF B$JIT.MODE = %M_BATCH# THEN

   8624  1 001551   000000 470600 xsym               LDP0  ! B$JIT$
         1 001552   000000 236300                    LDQ   ! 0,,PR0
         1 001553   740000 376203                    ANQ   ! -16384,DU
         1 001554   040000 116203                    CMPQ  ! 16384,DU
         1 001555   001571 601200 1                  TNZ   ! s:8628

      551     8625    3               B$JIT.IDELTAT =

   8625  1 001556   000302 236300                    LDQ   ! 194,,PR0
         1 001557   000033 772200                    QRL   ! 27
         1 001560   000000 471606 xsym               LDP1  ! JM_PPTR$,QL
         1 001561   000260 236300                    LDQ   ! 176,,PR0
         1 001562   000022 732200                    QRS   ! 18
         1 001563   100002 036300                    ADLQ  ! 2,,PR1
         1 001564   001750 116207                    CMPQ  ! 1000,DL
         1 001565   001567 605200 1                  TPL   ! s:8625+9
         1 001566   001750 236207                    LDQ   ! 1000,DL
         1 001567   000266 756300                    STQ   ! 182,,PR0
         1 001570   001600 710200 1                  TRA   ! s:8629

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:83   
      552     8626    3                  MAXIMUM(JM_PPTR$(B$JIT.PNR)->JM$PT.QUAN + B$JIT.QUAN, 1000);
      553     8627    3            ELSE
      554     8628    3               B$JIT.IDELTAT=MAXIMUM(SL_QUAN + B$JIT.QUAN,1000);
              8628                        /* JIT value is an offset */

   8628  1 001571   000260 236300                    LDQ   ! 176,,PR0
         1 001572   000022 732200                    QRS   ! 18
         1 001573   000000 036200 xsym               ADLQ  ! SL_QUAN
         1 001574   001750 116207                    CMPQ  ! 1000,DL
         1 001575   001577 605200 1                  TPL   ! s:8628+6
         1 001576   001750 236207                    LDQ   ! 1000,DL
         1 001577   000266 756300                    STQ   ! 182,,PR0

      555     8629    3            XT=B$JIT.XTIME+B$JIT.EXTUS;  /* EX TIME IN USECS                   */

   8629  1 001600   000262 236300                    LDQ   ! 178,,PR0
         1 001601   000303 036300                    ADLQ  ! 195,,PR0
         1 001602   200020 756300                    STQ   ! XT,,AUTO

      556     8630    3            ST=B$JIT.STIME+B$JIT.SVTUS;  /* SRV TIME IN USECS*/

   8630  1 001603   000261 236300                    LDQ   ! 177,,PR0
         1 001604   000304 036300                    ADLQ  ! 196,,PR0
         1 001605   200021 756300                    STQ   ! ST,,AUTO

      557     8631    3            B$JIT.EXTUS=MOD(XT,10000);   /* QUANTUM TIME REMAINDER             */

   8631  1 001606   200020 236300                    LDQ   ! XT,,AUTO
         1 001607   023420 506207                    DIV   ! 10000,DL
         1 001610   000303 755300                    STA   ! 195,,PR0

      558     8632    3            B$JIT.SVTUS=MOD(ST,10000);   /* FOR EXECUTION AND SERVICE          */

   8632  1 001611   200021 236300                    LDQ   ! ST,,AUTO
         1 001612   023420 506207                    DIV   ! 10000,DL
         1 001613   000304 755300                    STA   ! 196,,PR0

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:84   
      559     8633                                                /* IF CP OR DELTA RUNNING, DON'T      */
      560     8634    3            B$LS$->B$MLNK.MISC2=B$USERLS$->B$ULNK.ECCB;

   8634  1 001614   000000 471600 xsym               LDP1  ! B$USERLS$
         1 001615   100034 237300                    LDAQ  ! 28,,PR1
         1 001616   000000 473600 xsym               LDP3  ! B$LS$
         1 001617   300260 757300                    STAQ  ! 176,,PR3

      561     8635    3            IF NOT S$CU$->B$U.FLG & %(%U_CPIC|%U_DIC) AND

   8635  1 001620   000000 474600 xsym               LDP4  ! S$CU$
         1 001621   400000 236300                    LDQ   ! 0,,PR4
         1 001622   000025 376200 0                  ANQ   ! SEV+13
         1 001623   001653 601200 1                  TNZ   ! s:8645
         1 001624   000301 235300                    LDA   ! 193,,PR0
         1 001625   001653 600200 1                  TZE   ! s:8645
         1 001626   000000 475600 xsym               LDP5  ! B$MISC2$
         1 001627   500004 234300                    SZN   ! 4,,PR5
         1 001630   001653 605200 1                  TPL   ! s:8645

      562     8636    3               B$JIT.UTIMER > 0 AND B$MISC2$->B$ECCB.FLAGS.TMRSET THEN
      563     8637    4            DO;

      564     8638    4               IF (XT + ST) >= B$JIT.UTIMER THEN

   8638  1 001631   200020 236300                    LDQ   ! XT,,AUTO
         1 001632   200021 036300                    ADLQ  ! ST,,AUTO
         1 001633   001641 604200 1                  TMI   ! s:8641
         1 001634   000301 116300                    CMPQ  ! 193,,PR0
         1 001635   001641 602200 1                  TNC   ! s:8641

      565     8639    4                  B$JIT.UTIMER = 7;   /* Just some small constant*/

   8639  1 001636   000007 236207                    LDQ   ! 7,DL
         1 001637   000301 756300                    STQ   ! 193,,PR0
         1 001640   001647 710200 1                  TRA   ! s:8642

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:85   
      566     8640    4               ELSE
      567     8641    4                  B$JIT.UTIMER=B$JIT.UTIMER-(XT+ST); /* Decrement timer     */

   8641  1 001641   200020 236300                    LDQ   ! XT,,AUTO
         1 001642   200021 036300                    ADLQ  ! ST,,AUTO
         1 001643   200024 756300                    STQ   ! PN+2,,AUTO
         1 001644   000301 236300                    LDQ   ! 193,,PR0
         1 001645   200024 136300                    SBLQ  ! PN+2,,AUTO
         1 001646   000301 756300                    STQ   ! 193,,PR0

      568     8642    4               IF B$JIT.UTIMER < B$JIT.IDELTAT THEN

   8642  1 001647   001653 604200 1                  TMI   ! s:8645
         1 001650   000266 116300                    CMPQ  ! 182,,PR0
         1 001651   001653 605200 1                  TPL   ! s:8645

      569     8643    4                  B$JIT.IDELTAT=B$JIT.UTIMER;

   8643  1 001652   000266 756300                    STQ   ! 182,,PR0

      570     8644    4               END;

      571     8645    3            XT=XT/10000;

   8645  1 001653   200020 236300                    LDQ   ! XT,,AUTO
         1 001654   023420 506207                    DIV   ! 10000,DL
         1 001655   200020 756300                    STQ   ! XT,,AUTO

      572     8646    3            ST=ST/10000;

   8646  1 001656   200021 236300                    LDQ   ! ST,,AUTO
         1 001657   023420 506207                    DIV   ! 10000,DL
         1 001660   200021 756300                    STQ   ! ST,,AUTO

      573     8647    3            CT=(XT+ST)*B$JIT.CURRCORE;   /* CORE TIME PRODUCT IN UTS*/

   8647  1 001661   200020 036300                    ADLQ  ! XT,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:86   
         1 001662   200024 756300                    STQ   ! PN+2,,AUTO
         1 001663   000210 236300                    LDQ   ! 136,,PR0
         1 001664   777777 376207                    ANQ   ! -1,DL
         1 001665   200025 756300                    STQ   ! PN+3,,AUTO
         1 001666   200024 236300                    LDQ   ! PN+2,,AUTO
         1 001667   200025 402300                    MPY   ! PN+3,,AUTO
         1 001670   200017 756300                    STQ   ! CT,,AUTO

      574     8648                   %LOCK (G#=P_GATE);

   8649  1 001671   000020 630600 2                  EPPR0 ! 16
         1 001672   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 001673   000000 701200 xent               TSX1  ! HFC$LOCK
         1 001674   000000 011200                    NOP   ! 0

      575     8651    3            IF B$JIT.RUNFLAGS & %RUN_USER# THEN

   8651  1 001675   000000 470600 xsym               LDP0  ! B$JIT$
         1 001676   000314 236300                    LDQ   ! 204,,PR0
         1 001677   000022 736200                    QLS   ! 18
         1 001700   777000 376203                    ANQ   ! -512,DU
         1 001701   004000 376203                    ANQ   ! 2048,DU
         1 001702   001715 600200 1                  TZE   ! s:8659

      576     8652    4            DO;

      577     8653    4               B$JIT.TUEXT=B$JIT.TUEXT+XT;

   8653  1 001703   000273 236300                    LDQ   ! 187,,PR0
         1 001704   200020 036300                    ADLQ  ! XT,,AUTO
         1 001705   000273 756300                    STQ   ! 187,,PR0

      578     8654    4               B$JIT.TUSVT=B$JIT.TUSVT+ST;

   8654  1 001706   000274 236300                    LDQ   ! 188,,PR0
         1 001707   200021 036300                    ADLQ  ! ST,,AUTO
         1 001710   000274 756300                    STQ   ! 188,,PR0
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:87   

      579     8655    4               B$JIT.UMEMTIM=B$JIT.UMEMTIM+CT;

   8655  1 001711   000275 236300                    LDQ   ! 189,,PR0
         1 001712   200017 036300                    ADLQ  ! CT,,AUTO
         1 001713   000275 756300                    STQ   ! 189,,PR0

      580     8656    4               END;

   8656  1 001714   001726 710200 1                  TRA   ! s:8663

      581     8657    3            ELSE
      582     8658    4            DO;

      583     8659    4               B$JIT.TPEXT=B$JIT.TPEXT+XT;

   8659  1 001715   000270 236300                    LDQ   ! 184,,PR0
         1 001716   200020 036300                    ADLQ  ! XT,,AUTO
         1 001717   000270 756300                    STQ   ! 184,,PR0

      584     8660    4               B$JIT.TPSVT=B$JIT.TPSVT+ST;

   8660  1 001720   000271 236300                    LDQ   ! 185,,PR0
         1 001721   200021 036300                    ADLQ  ! ST,,AUTO
         1 001722   000271 756300                    STQ   ! 185,,PR0

      585     8661    4               B$JIT.PMEMTIM=B$JIT.PMEMTIM+CT;

   8661  1 001723   000272 236300                    LDQ   ! 186,,PR0
         1 001724   200017 036300                    ADLQ  ! CT,,AUTO
         1 001725   000272 756300                    STQ   ! 186,,PR0

      586     8662    4               END;

      587     8663    3            PN = S$CU$->B$U.APR;

   8663  1 001726   000000 471600 xsym               LDP1  ! S$CU$
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:88   
         1 001727   100007 236300                    LDQ   ! 7,,PR1
         1 001730   000030 772200                    QRL   ! 24
         1 001731   200022 756300                    STQ   ! PN,,AUTO

      588     8664    3            IF S$CU$->B$U.FLG.CPIC

   8664  1 001732   100000 236300                    LDQ   ! 0,,PR1
         1 001733   020000 316203                    CANQ  ! 8192,DU
         1 001734   001742 600200 1                  TZE   ! s:8667

      589     8665    3            THEN PN=S$CU$->B$U.ACP;

   8665  1 001735   100006 236300                    LDQ   ! 6,,PR1
         1 001736   000022 772200                    QRL   ! 18
         1 001737   000777 376207                    ANQ   ! 511,DL
         1 001740   200022 756300                    STQ   ! PN,,AUTO
         1 001741   001750 710200 1                  TRA   ! s:8669

      590     8666    3            ELSE
      591     8667    3               IF S$CU$->B$U.FLG.DIC

   8667  1 001742   100000 316203                    CANQ  ! 32768,DU
         1 001743   001750 600200 1                  TZE   ! s:8669

      592     8668    3               THEN PN=S$CU$->B$U.DB;

   8668  1 001744   100006 236300                    LDQ   ! 6,,PR1
         1 001745   000011 772200                    QRL   ! 9
         1 001746   000777 376207                    ANQ   ! 511,DL
         1 001747   200022 756300                    STQ   ! PN,,AUTO

      593     8669    3            IF PN ~= 0

   8669  1 001750   200022 235300                    LDA   ! PN,,AUTO
         1 001751   001765 600200 1                  TZE   ! s:8674

      594     8670    4            THEN DO;
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:89   

      595     8671    4               B$P$->B$P.XEQTIME(PN) = B$P$->B$P.XEQTIME(PN) + XT;

   8671  1 001752   200022 236300                    LDQ   ! PN,,AUTO
         1 001753   000042 402207                    MPY   ! 34,DL
         1 001754   000000 473600 xsym               LDP3  ! B$P$
         1 001755   000000 620206                    EAX0  ! 0,QL
         1 001756   300006 236306                    LDQ   ! 6,QL,PR3
         1 001757   200020 036300                    ADLQ  ! XT,,AUTO
         1 001760   300006 756310                    STQ   ! 6,X0,PR3

      596     8672    4               B$P$->B$P.SRVTIME(PN) = B$P$->B$P.SRVTIME(PN) + ST;

   8672  1 001761   000000 471600 xsym               LDP1  ! B$P$
         1 001762   100007 236310                    LDQ   ! 7,X0,PR1
         1 001763   200021 036300                    ADLQ  ! ST,,AUTO
         1 001764   100007 756310                    STQ   ! 7,X0,PR1

      597     8673    4               END;

      598     8674    3            CALL SSS$CACHEBP;

   8674  1 001765   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 001766   000000 701200 xent               TSX1  ! SSS$CACHEBP
         1 001767   000000 011200                    NOP   ! 0

      599     8675    3            PN = B$JIT.MODE;

   8675  1 001770   000000 470600 xsym               LDP0  ! B$JIT$
         1 001771   000000 236300                    LDQ   ! 0,,PR0
         1 001772   000040 772200                    QRL   ! 32
         1 001773   200022 756300                    STQ   ! PN,,AUTO

      600     8676    3            P_UXEQTIME(PN)=P_UXEQTIME(PN)+XT;

   8676  1 001774   000000 236206 xsym               LDQ   ! P_UXEQTIME,QL
         1 001775   200020 036300                    ADLQ  ! XT,,AUTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:90   
         1 001776   200022 720300                    LXL0  ! PN,,AUTO
         1 001777   000000 756210 xsym               STQ   ! P_UXEQTIME,X0

      601     8677    3            P_USRVTIME(PN)=P_USRVTIME(PN)+ST;

   8677  1 002000   000000 236210 xsym               LDQ   ! P_USRVTIME,X0
         1 002001   200021 036300                    ADLQ  ! ST,,AUTO
         1 002002   000000 756210 xsym               STQ   ! P_USRVTIME,X0

      602     8678    3            CALL SSS$CACHE;

   8678  1 002003   000002 631600 xsym               EPPR1 ! B_VECTNIL+2
         1 002004   000000 701200 xent               TSX1  ! SSS$CACHE
         1 002005   000000 011200                    NOP   ! 0

      603     8679                   %UNLOCK (G#=P_GATE);

   8680  1 002006   000020 630600 2                  EPPR0 ! 16
         1 002007   000017 631600 xsym               EPPR1 ! B_VECTNIL+15
         1 002010   000000 701200 xent               TSX1  ! HFC$UNLOCK
         1 002011   000000 011200                    NOP   ! 0

      604     8682    3            B$JIT.CTIME=0;

   8682  1 002012   000000 470600 xsym               LDP0  ! B$JIT$
         1 002013   000263 450300                    STZ   ! 179,,PR0

      605     8683    3            B$JIT.STIME=0;

   8683  1 002014   000261 450300                    STZ   ! 177,,PR0

      606     8684    3            B$JIT.XTIME=0;

   8684  1 002015   000262 450300                    STZ   ! 178,,PR0

      607     8685    3            IF B$JIT.MRT > 0

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:91   
   8685  1 002016   000276 235300                    LDA   ! 190,,PR0
         1 002017   002040 604600 1                  TMOZ  ! s:8691

      608     8686    4            THEN DO;

      609     8687    4               IF H_MIXED_MP = 0

   8687  1 002020   000000 236200 xsym               LDQ   ! H_MIXED_MP
         1 002021   002031 601200 1                  TNZ   ! s:8689

      610     8688    4               THEN B$JIT.MRT = B$JIT.MRT - (XT+ST);

   8688  1 002022   200020 236300                    LDQ   ! XT,,AUTO
         1 002023   200021 036300                    ADLQ  ! ST,,AUTO
         1 002024   200024 756300                    STQ   ! PN+2,,AUTO
         1 002025   000276 236300                    LDQ   ! 190,,PR0
         1 002026   200024 136300                    SBLQ  ! PN+2,,AUTO
         1 002027   000276 756300                    STQ   ! 190,,PR0
         1 002030   002040 710200 1                  TRA   ! s:8691

      611     8689    4               ELSE B$JIT.MRT = B$JIT.MRT - (XT+ST)/2;

   8689  1 002031   200020 236300                    LDQ   ! XT,,AUTO
         1 002032   200021 036300                    ADLQ  ! ST,,AUTO
         1 002033   000002 506207                    DIV   ! 2,DL
         1 002034   200024 756300                    STQ   ! PN+2,,AUTO
         1 002035   000276 236300                    LDQ   ! 190,,PR0
         1 002036   200024 136300                    SBLQ  ! PN+2,,AUTO
         1 002037   000276 756300                    STQ   ! 190,,PR0

      612     8690    4               END;

      613     8691    4            IF B$JIT.PRIOB ~= 0 THEN DO;

   8691  1 002040   000260 236300                    LDQ   ! 176,,PR0
         1 002041   777000 316207                    CANQ  ! -512,DL
         1 002042   002060 600200 1                  TZE   ! s:8695
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:92   

      614     8692    4               S$CU$->B$U.PRIOB = S$CU$->B$U.PRIOB + B$JIT.PRIOB;

   8692  1 002043   000260 236300                    LDQ   ! 176,,PR0
         1 002044   000022 736200                    QLS   ! 18
         1 002045   000033 732200                    QRS   ! 27
         1 002046   200024 756300                    STQ   ! PN+2,,AUTO
         1 002047   000000 471600 xsym               LDP1  ! S$CU$
         1 002050   100011 236300                    LDQ   ! 9,,PR1
         1 002051   000014 772200                    QRL   ! 12
         1 002052   000077 376207                    ANQ   ! 63,DL
         1 002053   200024 036300                    ADLQ  ! PN+2,,AUTO
         1 002054   000014 736200                    QLS   ! 12
         1 002055   100011 752304                    STCQ  ! 9,'04'O,PR1

      615     8693    4               B$JIT.PRIOB = 0;

   8693  1 002056   000000 236203                    LDQ   ! 0,DU
         1 002057   000260 552310                    STBQ  ! 176,'10'O,PR0

      616     8694    4               END;

      617     8695    3            S$CU$->B$U.UTSUSED=S$CU$->B$U.UTSUSED+XT+ST;

   8695  1 002060   000000 471600 xsym               LDP1  ! S$CU$
         1 002061   100005 236300                    LDQ   ! 5,,PR1
         1 002062   200020 036300                    ADLQ  ! XT,,AUTO
         1 002063   200021 036300                    ADLQ  ! ST,,AUTO
         1 002064   100005 756300                    STQ   ! 5,,PR1

      618     8696    3            S$CU$ -> B$U.MRT = B$JIT.MRT;

   8696  1 002065   000276 235300                    LDA   ! 190,,PR0
         1 002066   100004 755300                    STA   ! 4,,PR1

      619     8697    3            IF B$JIT.MRT > 0 THEN RETURN;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:93   
   8697  1 002067   000276 235300                    LDA   ! 190,,PR0
         1 002070   002073 604600 1                  TMOZ  ! s:8698

   8697  1 002071   200016 221300                    LDX1  ! ASFLAGS+1,,AUTO
         1 002072   000001 702211                    TSX2  ! 1,X1

      620     8698    3            B$JIT.MRT=0;

   8698  1 002073   000276 450300                    STZ   ! 190,,PR0

      621     8699    3            B$JIT.RNST=(B$JIT.RNST | %RS_LIMX#);

   8699  1 002074   000314 236300                    LDQ   ! 204,,PR0
         1 002075   777000 376203                    ANQ   ! -512,DU
         1 002076   100000 276203                    ORQ   ! 32768,DU
         1 002077   000314 552340                    STBQ  ! 204,'40'O,PR0

      622     8700    3            B$JIT.XLIMFLG=(B$JIT.XLIMFLG | %XL_TIME#);

   8700  1 002100   000316 236300                    LDQ   ! 206,,PR0
         1 002101   000022 736200                    QLS   ! 18
         1 002102   777000 376203                    ANQ   ! -512,DU
         1 002103   001000 276203                    ORQ   ! 512,DU
         1 002104   000022 772200                    QRL   ! 18
         1 002105   000316 552310                    STBQ  ! 206,'10'O,PR0

      623     8701    3            B$JIT.ERR='232321400006'O;

   8701  1 002106   000026 236200 0                  LDQ   ! SEV+14
         1 002107   000012 756300                    STQ   ! 10,,PR0

      624     8702    3            B$JIT.ERR.CODE=%E$MAXTIME;

   8702  1 002110   000016 376200 2                  ANQ   ! 14
         1 002111   004030 276207                    ORQ   ! 2072,DL
         1 002112   000012 756300                    STQ   ! 10,,PR0

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:94   
      625     8703    3            RETURN;

   8703  1 002113   200016 221300                    LDX1  ! ASFLAGS+1,,AUTO
         1 002114   000001 702211                    TSX2  ! 1,X1

      626     8704        /*E*   ERROR:   SSQ-E$MAXTIME-6
      627     8705               MESSAGE:   Time limit exceeded
      628     8706        */
      629     8707    3            END;                           /* END INHIBIT                        */

      630     8708    2   END;

   8708  1 002115   000001 702211                    TSX2  ! 1,X1

(unnamed)
 Sect OctLoc
   0     000   000000 000001                                                    ....

RNSTAT
 Sect OctLoc
   0     001   400020 100200   040*** ******                                    ..@. ...

JERR
 Sect OctLoc
   0     003   00772* ******   00770* ******   00774* ******   00776* ******    ................
   0     007   01000* ******                                                    ....

SEV
 Sect OctLoc
   0     010   6***** ******   4***** ******   4***** ******   6***** ******    ................
   0     014   6***** ******                                                    ....

(unnamed)
 Sect OctLoc
   0     015   000004 010000   000000 400000   002000 000000   010000 000000    ................
   0     021   040000 000000   020000 000000   100000 000000   200000 000000     .......@.......
   0     025   120000 000000   232321 400006                                    P.......
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:95   

(unnamed)
 Sect OctLoc
   2     000   777773 777777   000000 006000   777777 767777   000000 006000    ................
   2     004   677777 777777   000002 006000   000005 006000   000003 006000    ................
   2     010   000006 006000   000004 006000   000000 006000   000000 006000    ................
   2     014   000004 006000   000000 006000   777777 400007   000027 006000    ................
   2     020   000000 006000                                                    ....
      631     8709    1   END;

PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:96   
--  Include file information  --

   B_MAGIC_C.:E05TOU  is referenced.
   B_MACROS_C.:E05TOU  is referenced.
   P_PMDAT_C.:E05TOU  is referenced.
   P_PMDAT_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   JM_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   JMA_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   F_CODE_R.:E05TOU  cannot be made into a system file and is referenced.
   J_ERRORS_C.:E05TOU  is referenced.
   UE_ERRORS_C.:E05TOU  is referenced.
   B$P.:E05TOU  cannot be made into a system file and is referenced.
   B$SS.:E05TOU  cannot be made into a system file and is referenced.
   UE_CP6.:E05TOU  is referenced.
   B_MLSMAC_C.:E05TOU  is referenced.
   B_ULSMAC_C.:E05TOU  is referenced.
   B_UHJMAC_C.:E05TOU  is referenced.
   SS_CNTRLD_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_CNTRL_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_R.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   JM$STRUCT.:E05TOU  is referenced.
      No diagnostics issued in procedure SSQ$QEND.
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:97   

 **** Variables and constants ****

  ****  Section 000 RoData SSQ$QEND

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN(14)    r     1 JERR(0:4)                  1-0-0/b BIT (9)     r     1 RNSTAT(0:4)
    10-0-0/w UBIN(3)     r     1 SEV(0:4)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    17-0-0/w PTR         r     1 @STATUS                   15-0-0/b BIT         r     1 ASFLAGS
    17-0-0/w UBIN        r     1 CT                         7-0-0/w PTR         r     1 D$
    10-0-0/w PTR         r     1 DD$                       11-0-0/w UBIN        r     1 ECINFO(0:3)
     6-0-0/w UBIN        r     1 EXC                        3-0-0/w UBIN        r     1 I
     4-0-0/w UBIN        r     1 J                         22-0-0/w UBIN        r     1 PN
     5-0-0/w SBIN        r     1 RTIME                     21-0-0/w SBIN        r     1 ST
    *0-0-0/w UBIN        r     1 STATUS                    20-0-0/w SBIN        r     1 XT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$LS$
     0-0-0/w PTR         r     1 B$MISC2$                   0-0-0/w PTR         r     1 B$MLS1$
     0-0-0/w PTR         r     1 B$P$                       0-0-0/w PTR         r     1 B$SDS0$
     0-0-0/w PTR         r     1 B$USERLS$                  0-0-0/d STRC(432)   r     1 B_MPT
     0-0-0/w SBIN        r     1 H_MIXED_MP
     0-0-0/w PTR         r     1 JM_PPTR$(0:15)
     0-0-0/c CHAR(8)     r     1 J_LOGON                    0-0-0/c CHAR(8)     r     1 J_SYSTXT
     0-0-0/w SBIN        r     1 P_GATE                     0-0-0/w PTR         r     1 P_RESOURCE$
     0-0-0/w SBIN        r     1 P_USRVTIME(0:4)
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:98   
     0-0-0/w SBIN        r     1 P_UXEQTIME(0:4)
     0-0-0/w PTR         r     1 S$CU$
     0-0-0/w SBIN        r     1 SL_QMIN(0:4)
     0-0-0/w UBIN        r     1 SL_QUAN                    0-0-0/b BIT (72)    r     1 S_ASFGATE
     0-0-0/w SBIN        r     1 S_HIR                      0-0-0/b BIT (72)    r     1 S_UDLGATE
     0-0-0/w UBIN        r     1 S_USTSCHD                  0-0-0/w UBIN        r     1 S_UXTSCHD

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(72)    r     1 B$$DESCR                   0-0-0/w UBIN        r     1 B$$WORD
     0-0-0/d STRC(396)   r     1 B$DO                       0-0-0/w STRC(180)   r     1 B$ECCB
     0-0-0/w STRC(180)   r     1 B$ECCBI                    0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/d STRC(10368) r     1 B$MLNK                     0-0-0/d STRC(1224)  r     1 B$P(0:0)
     0-0-0/d STRC(576)   r     1 B$SDS                      0-0-0/d STRC(2304)  r     1 B$SS
     0-0-0/d STRC(576)   r     1 B$U                        0-0-0/d STRC(2592)  r     1 B$ULNK
     0-0-0/w STRC(72)    r     1 ENTDESCR                   0-0-0/w STRC(684)   r     1 JM$PT


   Procedure SSQ$QEND requires 1102 words for executable code.
   Procedure SSQ$QEND requires 30 words of local(AUTO) storage.

    No errors detected in file SSQ$QEND.:E05TSI    .
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:99   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:100  
          MINI XREF LISTING

ABORTEX
      8578**PROC     8353--CALL     8357--CALL     8362--CALL     8366--CALL     8369--CALL     8373--CALL
ACCTEX
      8615**PROC     8228--CALL     8570--CALL
ASFLAGS
        59**DCL      8304<<ASSIGN   8305>>IF       8351>>IF       8356>>IF       8359>>IF       8365>>IF
      8377>>IF       8402>>IF       8405>>IF
B$$DESCR
      7854**DCL      8525<<ASSIGN   8535<<ASSIGN
B$$DESCR.BASE
      7859**DCL      8445>>ASSIGN   8447>>IF       8499<<ASSIGN   8499>>ASSIGN
B$$WORD
        63**DCL      8429<>CALL     8472<>CALL     8484<>CALL     8546<>CALL
B$BRK.CODE
      8109**DCL      8109--REDEF    8110--REDEF    8110--REDEF
B$BRK.ERR.ERR#
      8111**DCL      8111--REDEF
B$BRK.EVID
      8110**DCL      8110--REDEF    8110--REDEF
B$DO.BUSY
      1551**DCL      8255>>IF       8294--ASSIGN
B$DO.CONT
      1552**DCL      8330>>IF
B$DO.ECCINFO
      1564**DCL      1565--REDEF
B$DO.ECCSC
      1557**DCL      8288>>IF
B$DO.ENTER
      1550**DCL      8283>>IF       8285>>CALL     8286<<ASSIGN   8320>>IF       8325<<ASSIGN
B$DO.ERRC
      1559**DCL      8290<>CALL     8291>>IF       8292<<ASSIGN   8292>>ASSIGN
B$DO.IOCOMP
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:101  
      1565**DCL      8290<>CALL
B$DO.LNK$
      1549**DCL      8257>>ASSIGN   8331>>ASSIGN   8333>>ASSIGN
B$DO.SAVE
      1554**DCL      8443>>IF
B$DO.SCHDDO
      1553**DCL      8270>>IF       8272<<ASSIGN
B$DO.WSR
      1556**DCL      8280>>ASSIGN
B$ECCB.FLAGS.TMRSET
      8085**DCL      8206>>IF       8635>>IF
B$ECCBI.ECIC
      8105**DCL      8428>>ASSIGN   8558>>ASSIGN
B$ECCBI.FLAGS
      8105**DCL      8418>>IF       8433<<ASSIGN   8473>>IF       8544>>IF
B$EVNT.CODE
      8093**DCL      8093--REDEF    8094--REDEF    8094--REDEF
B$EVNT.ERR.ERR#
      8095**DCL      8095--REDEF
B$EVNT.EVID
      8094**DCL      8094--REDEF    8094--REDEF
B$JIT.CPFLAGS1
      1226**DCL      8395<<ASSIGN   8395>>ASSIGN   8462>>IF
B$JIT.CPFLAGS1.SLEAZE
      1231**DCL      1231--REDEF
B$JIT.CTIME
      1310**DCL      8193>>IF       8223>>ASSIGN   8682<<ASSIGN
B$JIT.CURRCORE
      1299**DCL      8647>>ASSIGN
B$JIT.ERR
      1137**DCL      8409>>ASSIGN   8450<<ASSIGN   8488<<ASSIGN   8587<<ASSIGN   8701<<ASSIGN
B$JIT.ERR.CODE
      1138**DCL      8453<<ASSIGN   8489<<ASSIGN   8588<<ASSIGN   8702<<ASSIGN
B$JIT.ERR.MID
      1138**DCL      1138--REDEF
B$JIT.ERR.SEV
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:102  
      1138**DCL      8585>>IF       8589<<ASSIGN
B$JIT.EXTUS
      1313**DCL      8629>>ASSIGN   8631<<ASSIGN
B$JIT.IDELTAT
      1311**DCL      8193>>IF       8223>>ASSIGN   8238>>ASSIGN   8625<<ASSIGN   8628<<ASSIGN   8642>>IF
      8643<<ASSIGN
B$JIT.JRESPEAK
      1299**DCL      1300--REDEF
B$JIT.JUNK
      1337**DCL      8193>>IF       8224<<ASSIGN   8224>>ASSIGN   8421>>IF       8470>>IF       8482>>IF
      8527>>IF
B$JIT.JUNK2
      1391**DCL      8465<<ASSIGN   8465>>ASSIGN
B$JIT.MODE
      1132**DCL      8238>>ASSIGN   8624>>IF       8675>>ASSIGN
B$JIT.MRT
      1311**DCL      8685>>IF       8688<<ASSIGN   8688>>ASSIGN   8689<<ASSIGN   8689>>ASSIGN   8696>>ASSIGN
      8697>>IF       8698<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      1408**DCL      1408--REDEF    1409--REDEF
B$JIT.PMEMTIM
      1311**DCL      8661<<ASSIGN   8661>>ASSIGN
B$JIT.PNR
      1312**DCL      1312--REDEF    8625>>ASSIGN
B$JIT.PRIOB
      1310**DCL      8691>>IF       8692>>ASSIGN   8693<<ASSIGN
B$JIT.QUAN
      1310**DCL      8625>>ASSIGN   8628>>ASSIGN
B$JIT.RNST
      1316**DCL      8163>>IF       8185>>IF       8368>>IF       8371>>IF       8584<<ASSIGN   8584>>ASSIGN
      8699<<ASSIGN   8699>>ASSIGN
B$JIT.RUNFLAGS
      1333**DCL      8651>>IF
B$JIT.SCHTIME
      1310**DCL      8238>>ASSIGN
B$JIT.STEPS
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:103  
      1358**DCL      8388>>IF
B$JIT.STIME
      1310**DCL      8193>>IF       8206>>IF       8223>>ASSIGN   8630>>ASSIGN   8683<<ASSIGN
B$JIT.SVTUS
      1313**DCL      8630>>ASSIGN   8632<<ASSIGN
B$JIT.TPEXT
      1311**DCL      8659<<ASSIGN   8659>>ASSIGN
B$JIT.TPSVT
      1311**DCL      8660<<ASSIGN   8660>>ASSIGN
B$JIT.TSLINE
      1406**DCL      1407--REDEF
B$JIT.TUEXT
      1311**DCL      8653<<ASSIGN   8653>>ASSIGN
B$JIT.TUSVT
      1311**DCL      8654<<ASSIGN   8654>>ASSIGN
B$JIT.UMEMTIM
      1311**DCL      8655<<ASSIGN   8655>>ASSIGN
B$JIT.UTIMER
      1312**DCL      8163>>IF       8203>>IF       8206>>IF       8434<<ASSIGN   8635>>IF       8638>>IF
      8639<<ASSIGN   8641<<ASSIGN   8641>>ASSIGN   8642>>IF       8643>>ASSIGN
B$JIT.XCONF
      1358**DCL      8537>>IF
B$JIT.XLIMFLG
      1368**DCL      8700<<ASSIGN   8700>>ASSIGN
B$JIT.XTIME
      1310**DCL      8193>>IF       8206>>IF       8223>>ASSIGN   8629>>ASSIGN   8684<<ASSIGN
B$JIT$
        44**DCL      1132--IMP-PTR  8163>>IF       8163>>IF       8185>>IF       8193>>IF       8193>>IF
      8193>>IF       8193>>IF       8193>>IF       8203>>IF       8206>>IF       8206>>IF       8206>>IF
      8223>>ASSIGN   8223>>ASSIGN   8223>>ASSIGN   8223>>ASSIGN   8224>>ASSIGN   8224>>ASSIGN   8238>>ASSIGN
      8238>>ASSIGN   8238>>ASSIGN   8368>>IF       8371>>IF       8388>>IF       8395>>ASSIGN   8395>>ASSIGN
      8409>>ASSIGN   8421>>IF       8434>>ASSIGN   8450>>ASSIGN   8453>>ASSIGN   8462>>IF       8465>>ASSIGN
      8465>>ASSIGN   8470>>IF       8482>>IF       8488>>ASSIGN   8489>>ASSIGN   8527>>IF       8537>>IF
      8584>>ASSIGN   8584>>ASSIGN   8585>>IF       8587>>ASSIGN   8588>>ASSIGN   8589>>ASSIGN   8624>>IF
      8625>>ASSIGN   8625>>ASSIGN   8625>>ASSIGN   8628>>ASSIGN   8628>>ASSIGN   8629>>ASSIGN   8629>>ASSIGN
      8630>>ASSIGN   8630>>ASSIGN   8631>>ASSIGN   8632>>ASSIGN   8635>>IF       8638>>IF       8639>>ASSIGN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:104  
      8641>>ASSIGN   8641>>ASSIGN   8642>>IF       8642>>IF       8643>>ASSIGN   8643>>ASSIGN   8647>>ASSIGN
      8651>>IF       8653>>ASSIGN   8653>>ASSIGN   8654>>ASSIGN   8654>>ASSIGN   8655>>ASSIGN   8655>>ASSIGN
      8659>>ASSIGN   8659>>ASSIGN   8660>>ASSIGN   8660>>ASSIGN   8661>>ASSIGN   8661>>ASSIGN   8675>>ASSIGN
      8682>>ASSIGN   8683>>ASSIGN   8684>>ASSIGN   8685>>IF       8688>>ASSIGN   8688>>ASSIGN   8689>>ASSIGN
      8689>>ASSIGN   8691>>IF       8692>>ASSIGN   8693>>ASSIGN   8696>>ASSIGN   8697>>IF       8698>>ASSIGN
      8699>>ASSIGN   8699>>ASSIGN   8700>>ASSIGN   8700>>ASSIGN   8701>>ASSIGN   8702>>ASSIGN
B$LS$
        45**DCL      8205>>ASSIGN   8525>>ASSIGN   8535>>ASSIGN   8551>>ASSIGN   8553>>ASSIGN   8555>>ASSIGN
      8558>>ASSIGN   8634>>ASSIGN
B$MISC2$
        47**DCL      8206>>IF       8635>>IF
B$MLNK.ASLLS
      4698**DCL      8535>>ASSIGN
B$MLNK.CPLS
      4704**DCL      8525>>ASSIGN
B$MLNK.MISC2
      5068**DCL      8205<<ASSIGN   8551<<ASSIGN   8553<<ASSIGN   8555<<ASSIGN   8558--ASSIGN   8559--CALL
      8634<<ASSIGN
B$MLS1$
        46**DCL      8559>>CALL
B$P.SRVTIME
      6296**DCL      8672<<ASSIGN   8672>>ASSIGN
B$P.XEQTIME
      6295**DCL      8671<<ASSIGN   8671>>ASSIGN
B$P$
      6342**DCL      8671>>ASSIGN   8671>>ASSIGN   8672>>ASSIGN   8672>>ASSIGN
B$SDS.ACPENT
      5345**DCL      8551>>ASSIGN
B$SDS.DBENT
      5337**DCL      8553>>ASSIGN
B$SDS0$
        48**DCL      8551>>ASSIGN   8553>>ASSIGN
B$SS.ISR.FLAGS
      6157**DCL      8500>>IF
B$SS.ISR.WSR
      6158**DCL      8417>>IF       8468>>IF       8500>>IF
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:105  
B$SS.RVA
      6153**DCL      6154--REDEF
B$SS.SCR
      6145**DCL      8498>>IF
B$SS.TCBFLG
      6263**DCL      8426>>IF       8430<<ASSIGN   8474>>IF
B$U.ACP
      1520**DCL      8380>>IF       8665>>ASSIGN
B$U.APR
      1523**DCL      8663>>ASSIGN
B$U.ASYNCH
      1501**DCL      8163>>IF       8185>>IF       8267>>IF       8269<<ASSIGN   8269>>ASSIGN   8304>>ASSIGN
      8306<<ASSIGN   8306>>ASSIGN   8346<<ASSIGN   8346>>ASSIGN
B$U.BRKCNT
      1535**DCL      8411>>ASSIGN
B$U.CPU
      1529**DCL      8176>>IF
B$U.DB
      1521**DCL      8668>>ASSIGN
B$U.DL$
      1539**DCL      8163>>IF       8187>>IF       8193>>IF       8253>>ASSIGN   8318>>ASSIGN
B$U.FLG
      1430**DCL      8163>>IF       8420>>IF       8470>>IF       8478>>IF       8482>>IF       8529>>IF
      8533>>IF       8635>>IF
B$U.FLG.CAN
      1455**DCL      8361<<ASSIGN
B$U.FLG.CPIC
      1436**DCL      8372>>IF       8379>>IF       8388>>IF       8462>>IF       8664>>IF
B$U.FLG.DBRK
      1461**DCL      8215>>IF       8218<<ASSIGN
B$U.FLG.DELA
      1435**DCL      8421>>IF       8470>>IF       8482>>IF       8527>>IF
B$U.FLG.DIC
      1433**DCL      8667>>IF
B$U.FLG.MSTR
      1451**DCL      8173>>IF       8175<<ASSIGN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:106  
B$U.MISC
      1543**DCL      1544--REDEF
B$U.MODE
      1534**DCL      8393>>IF
B$U.MRT
      1517**DCL      8696<<ASSIGN
B$U.PRIO
      1532**DCL      8229<<ASSIGN
B$U.PRIOB
      1533**DCL      8229>>ASSIGN   8692<<ASSIGN   8692>>ASSIGN
B$U.UTSUSED
      1518**DCL      8695<<ASSIGN   8695>>ASSIGN
B$ULNK.ASLENT
      4433**DCL      8555>>ASSIGN
B$ULNK.ECCB
      4391**DCL      8205>>ASSIGN   8634>>ASSIGN
B$USER.MISC
      1619**DCL      1620--REDEF
B$USERLS$
        49**DCL      8205>>ASSIGN   8555>>ASSIGN   8634>>ASSIGN
B_MPT.AS
      8025**DCL      8028--REDEF
B_MPT.ASDESC
      8057**DCL      8061--REDEF
B_MPT.ECCB
      8040**DCL      8043--REDEF
B_MPT.ECCB$
      8043**DCL      8418>>IF       8428>>ASSIGN   8433>>ASSIGN   8473>>IF       8544>>IF       8558>>ASSIGN
B_MPT.ECCBDESC
      8075**DCL      8079--REDEF
B_MPT.LS
      8020**DCL      8023--REDEF
B_MPT.LSDESC
      8051**DCL      8055--REDEF
B_MPT.LSDESC$
      8055**DCL      8525>>ASSIGN   8535>>ASSIGN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:107  
B_MPT.PS
      8030**DCL      8033--REDEF
B_MPT.PSDESC
      8063**DCL      8067--REDEF
B_MPT.SS
      8015**DCL      8018--REDEF
B_MPT.SS$
      8018**DCL      8417>>IF       8426>>IF       8429<>CALL     8430>>ASSIGN   8468>>IF       8474>>IF
      8498>>IF       8500>>IF       8500>>IF       8546<>CALL
B_MPT.SSDESC
      8045**DCL      8049--REDEF
B_MPT.SSDESC$
      8049**DCL      8445>>ASSIGN   8447>>IF       8499>>ASSIGN   8499>>ASSIGN
B_MPT.TCB
      8035**DCL      8038--REDEF
B_MPT.TCB$
      8038**DCL      8429<>CALL     8546<>CALL
B_MPT.TCBDESC
      8069**DCL      8073--REDEF
CT IN PROCEDURE ACCTEX
      8616**DCL      8647<<ASSIGN   8655>>ASSIGN   8661>>ASSIGN
D$
        56**DCL      8253<<ASSIGN   8254>>IF       8255>>IF       8257<<ASSIGN   8257>>ASSIGN   8270>>IF
      8272>>ASSIGN   8280>>ASSIGN   8282>>ASSIGN   8283>>IF       8285>>CALL     8285<>CALL     8286>>ASSIGN
      8288>>IF       8290>>CALL     8290>>CALL     8291>>IF       8292>>ASSIGN   8292>>ASSIGN   8294<<ASSIGN
      8294>>ASSIGN   8318<<ASSIGN   8319>>DOWHILE  8320>>IF       8324<>CALL     8325>>ASSIGN   8326<>CALL
      8330>>IF       8331<<ASSIGN   8331>>ASSIGN   8333<<ASSIGN   8333>>ASSIGN   8404<<ASSIGN   8429>>CALL
      8472>>CALL     8484>>CALL     8546>>CALL
DD$
        57**DCL      8282<<ASSIGN   8436<>CALL     8443>>IF       8449<>CALL     8493<>CALL     8548<>CALL
ECINFO
        58**DCL      8404--ASSIGN   8406<<ASSIGN   8408<<ASSIGN   8409<<ASSIGN   8410<<ASSIGN   8411<<ASSIGN
      8462>>IF
ENTDESCR
      7862**DCL      8559<>CALL
ENTDESCR.ENTLOC
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:108  
      7863**DCL      8558<<ASSIGN
EXC
        55**DCL      8210<<ASSIGN   8217<<ASSIGN   8281<<ASSIGN   8403<<ASSIGN   8415>>DOCASE   8418>>IF
      8428>>ASSIGN   8429<>CALL     8430>>ASSIGN   8431>>DOCASE   8441>>IF       8472<>CALL     8481<<ASSIGN
      8484<>CALL     8510>>DOCASE   8546<>CALL
FMF$TYC
        29**DCL-ENT  8290--CALL
HFC$ASSOCCLR
        19**DCL-ENT  8273--CALL
HFC$CACHECLR
        20**DCL-ENT  8275--CALL
HFC$LOCK
      7390**DCL-ENT  8191--CALL     8265--CALL     8302--CALL     8316--CALL     8649--CALL
HFC$UNLOCK
      7390**DCL-ENT  8199--CALL     8261--CALL     8278--CALL     8308--CALL     8322--CALL     8337--CALL
      8348--CALL     8680--CALL
H_MIXED_MP
      7412**DCL      8687>>IF
I
        51**DCL      8209<<ASSIGN   8280<<ASSIGN   8417>>IF       8421>>IF       8425>>IF       8445<<ASSIGN
      8447>>IF       8521>>DOCASE   8549>>DOCASE
J
        52**DCL      8428<<ASSIGN   8429<>CALL     8498<<ASSIGN   8498<<ASSIGN   8499>>ASSIGN
JERR IN PROCEDURE ABORTEX
      8581**DCL      8588>>ASSIGN
JM$PT.QUAN
      5379**DCL      8625>>ASSIGN
JM_PPTR$
      6487**DCL      8625>>ASSIGN
JSE$ABORTM
        31**DCL-ENT  8456--CALL     8492--CALL
JSE$ABORTX
        32**DCL-ENT  8594--CALL
JSE$ACP
        30**DCL-ENT  8399--CALL
JST$CPEXIT
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:109  
        33**DCL-ENT  8384--CALL
J_LOGON
        37**DCL      8384--CALL
J_SYSTXT
        38**DCL      8384--CALL
KIF$LDTRC
        35**DCL-ENT  8320--IF       8324--CALL
PN IN PROCEDURE ACCTEX
      8619**DCL      8663<<ASSIGN   8665<<ASSIGN   8668<<ASSIGN   8669>>IF       8671>>ASSIGN   8671>>ASSIGN
      8672>>ASSIGN   8672>>ASSIGN   8675<<ASSIGN   8676>>ASSIGN   8676>>ASSIGN   8677>>ASSIGN   8677>>ASSIGN
P_GATE
      7721**DCL      8649<>CALL     8680<>CALL
P_NSCPU
      7722**DCL      7723--REDEF
P_RESOURCE.RES
      7595**DCL      7662--REDEF
P_RESOURCE$
      7675**DCL      7563--IMP-PTR
P_UPTIME
      7711**DCL      7712--REDEF
P_USRVTIME
      7700**DCL      8677<<ASSIGN   8677>>ASSIGN
P_UXEQTIME
      7699**DCL      8676<<ASSIGN   8676>>ASSIGN
RNSTAT IN PROCEDURE ABORTEX
      8580**DCL      8584>>ASSIGN
RTIME
        54**DCL      8223<<ASSIGN   8225>>IF       8238<<ASSIGN   8238>>ASSIGN   8239>>IF       8248<>CALL
S$CU$
      1630**DCL      8163>>IF       8163>>IF       8163>>IF       8173>>IF       8175>>ASSIGN   8176>>IF
      8185>>IF       8187>>IF       8193>>IF       8215>>IF       8218>>ASSIGN   8229>>ASSIGN   8229>>ASSIGN
      8253>>ASSIGN   8267>>IF       8269>>ASSIGN   8269>>ASSIGN   8304>>ASSIGN   8306>>ASSIGN   8306>>ASSIGN
      8318>>ASSIGN   8346>>ASSIGN   8346>>ASSIGN   8361>>ASSIGN   8372>>IF       8379>>IF       8380>>IF
      8388>>IF       8393>>IF       8411>>ASSIGN   8420>>IF       8421>>IF       8462>>IF       8470>>IF
      8470>>IF       8478>>IF       8482>>IF       8482>>IF       8527>>IF       8529>>IF       8533>>IF
      8635>>IF       8663>>ASSIGN   8664>>IF       8665>>ASSIGN   8667>>IF       8668>>ASSIGN   8692>>ASSIGN
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:110  
      8692>>ASSIGN   8695>>ASSIGN   8695>>ASSIGN   8696>>ASSIGN
SC_ASLEVNT
        34**DCL-ENT  8540--CALL     8563--CALL
SC_UTIMER
        21**DCL-ENT  8512--CALL
SE1A
      8223**LABEL    8390--GOTO     8394--GOTO     8402--GOTO     8425--GOTO     8444--GOTO     8448--GOTO
      8466--GOTO     8486--GOTO     8529--GOTO     8534--GOTO
SE4
      8185**LABEL    8343--GOTO
SE5
      8187**LABEL    8494--GOTO
SE51
      8193**LABEL    8254--GOTO
SE6
      8253**LABEL    8196--GOTO
SE61
      8254**LABEL    8258--GOTO
SE7
      8294**LABEL    8186--GOTO
SE70
      8306**LABEL    8327--GOTO
SE71
      8403**LABEL    8392--GOTO
SE72
      8404**LABEL    8211--GOTO     8219--GOTO
SE8
      8413**LABEL    8295--GOTO
SE80
      8411**LABEL    8506--GOTO
SE82
      8498**LABEL    8417--GOTO     8479--GOTO
SE83
      8472**LABEL    8422--GOTO     8530--GOTO
SE84
      8427**LABEL    8475--GOTO
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:111  
SE85
      8510**LABEL    8459--GOTO     8502--GOTO
SE87
      8473**LABEL    8469--GOTO
SE9
      8488**LABEL    8429--CALLALT
SE91
      8493**LABEL    8285--CALLALT  8523--GOTO     8531--GOTO     8538--GOTO
SET_YC
      8395**LABEL    8517--GOTO
SEV IN PROCEDURE ABORTEX
      8582**DCL      8589>>ASSIGN
SL_QMIN
      1883**DCL      8238>>ASSIGN
SL_QUAN IN PROCEDURE ACCTEX
      8620**DCL      8628>>ASSIGN
SSC$MON
        12**DCL-ENT  8178--CALL     8227--CALL     8242--CALL
SSC$SERV
        14**DCL-ENT  8300--CALL     8383--CALL     8397--CALL     8455--CALL     8491--CALL     8592--CALL
SSS$BLOCK
        11**DCL-ENT  8382--CALL     8396--CALL     8454--CALL     8490--CALL     8591--CALL
SSS$CACHE
        25**DCL-ENT  8678--CALL
SSS$CACHEBP
        24**DCL-ENT  8674--CALL
SSS$LDT
        13**DCL-ENT  8248--CALL
SSS$LTRD
        23**DCL-ENT  8559--CALL
SST$SSFTCB
        26**DCL-ENT  8429--CALL     8546--CALL
SSU$DELTAGO
        27**DCL-ENT  8472--CALL     8484--CALL
SSV$XXDO
        28**DCL-ENT  8326--CALL     8436--CALL     8449--CALL     8493--CALL     8548--CALL
PL6.E3A0      #001=SSQ$QEND File=SSQ$QEND.:E05TSI                                WED 07/30/97 05:57 Page:112  
ST IN PROCEDURE ACCTEX
      8618**DCL      8630<<ASSIGN   8632>>ASSIGN   8638>>IF       8641>>ASSIGN   8646<<ASSIGN   8646>>ASSIGN
      8647>>ASSIGN   8654>>ASSIGN   8660>>ASSIGN   8672>>ASSIGN   8677>>ASSIGN   8688>>ASSIGN   8689>>ASSIGN
      8695>>ASSIGN
STATUS IN PROCEDURE ABORTEX
      8579**DCL      8578--PROC     8584>>ASSIGN   8588>>ASSIGN   8589>>ASSIGN
S_ASFGATE
      1907**DCL      8265<>CALL     8278<>CALL     8302<>CALL     8308<>CALL     8348<>CALL
S_HIR
      1894**DCL      8235>>IF       8241<<ASSIGN   8263<<ASSIGN
S_UDLGATE
      1906**DCL      8191<>CALL     8199<>CALL     8261<>CALL     8316<>CALL     8322<>CALL     8337<>CALL
S_USTSCHD
        43**DCL      8572<<ASSIGN
S_UXTSCHD
        42**DCL      8571<<ASSIGN
UDN$BLDASR
        18**DCL-ENT  8593--CALL
UDN$MAGIC
        15**DCL-ENT  8398--CALL     8413--CALL     8446--CALL     8520--CALL
UDN$MAGICLS
        17**DCL-ENT  8542--CALL
UDN$MAGICSS
        16**DCL-ENT  8505--CALL
XT IN PROCEDURE ACCTEX
      8617**DCL      8629<<ASSIGN   8631>>ASSIGN   8638>>IF       8641>>ASSIGN   8645<<ASSIGN   8645>>ASSIGN
      8647>>ASSIGN   8653>>ASSIGN   8659>>ASSIGN   8671>>ASSIGN   8676>>ASSIGN   8688>>ASSIGN   8689>>ASSIGN
      8695>>ASSIGN
