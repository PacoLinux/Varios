VERSION E05

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:1    
        1        1        /*M* QBA$APPLY:  APPLY a VISUAL-ATTRIBUTE to a form, frame, or field.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBA$APPLY
       10       10              PURPOSE:      APPLY a VISUAL-ATTRIBUTE to a form, frame, or field.
       11       11              DESCRIPTION:  Execute an APPLY op-code, whose argument may
       12       12                            be a field, a list of fields, a frame, a list of
       13       13                            frames, and/or a form, together with the
       14       14                            VISUAL-ATTRIBUTE to APPLY to the argument(s).
       15       15        */
       16       16
       17       17        QBA$APPLY: PROC;
       18       18
       19       19        /*D*  NAME:         QBA$APPLY
       20       20              CALL:         CALL QBA$APPLY;
       21       21              PARAMETERS:   None.
       22       22              INTERFACE:    Called by QAT$TALLYHO when an APPLY op-code is
       23       23                            encountered.
       24       24                            Calls M$MDFFLD.
       25       25              ENVIRONMENT:  Nothing unusual.
       26       26              INPUT:        QI_1,
       27       27                            FPL rununit static data following the op-code.
       28       28              OUTPUT:       Toins the field(s) a pretty color.
       29       29              SCRATCH:      Various otter data.
       30       30              DESCRIPTION:  M$MDFFLDs the appropriate fields.  If the
       31       31                            INITIAL-ATTRIBUTE is desired, the QI$FIELD_DAD
       32       32                            is queried to get it.
       33       33        */
       34       34
       35       35          %INCLUDE LCP_6;
       36      226          %INCLUDE QG_MACRO_M;
       37      363          %QGB_ENTRIES;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:2    
       38      376          %INCLUDE QI_EQUATES_E;
       39      735          %INCLUDE QI_PERR_C;
       40      903          %INCLUDE QI_MACROS_M;
       41     5961          %QI$ALL;
       42    17074          %QI_FPTS;
       43    19119
       44    19120    1     DCL OPERAND_COUNT UBIN;
       45    19121    1     DCL OPERAND_INDEX UBIN;
       46    19122    1     DCL FIELD_START_INDEX UBIN;
       47    19123    1     DCL FIELD_STOP_INDEX UBIN;
       48    19124    1     DCL FRAME$ PTR;
       49    19125    1     DCL FRAME_INDEX UBIN;
       50    19126    1     DCL FRAME_STATUS$ PTR;
       51    19127    1     DCL GZ_FIELD$ PTR;
       52    19128    1     DCL GZ_HEADER$ PTR;
       53    19129    1     DCL INSTR$ PTR;
       54    19130    1     DCL LAST_FILE$ PTR;
       55    19131    1     DCL VISUAL_ATTRIBUTE UBIN;
       56    19132
       57    19133    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       58    19134    1     DCL QCF$FIND_CURRENTS ENTRY;
       59    19135    1     DCL QCU$USE_IO ENTRY (1);
       60    19136
       61    19137          %SET LISTMAC = '1'B;
       62    19138
       63    19139          %INCLUDE QCU_USE_M;
       64    19193          %QCU@USE;
             19194            %BEGIN_MACRO;
             19195            %SET LISTDIR = '0'B;
             19208    1     DCL 1 QCU@USE AUTO ALIGNED,
             19209    1           2 CURR_FRAME$ PTR,
             19210                          /* Pointer to DAD of current frame or ADDR (NIL).  */
             19211    1           2 CURR_NODE$ PTR,
             19212                          /* Pointer to current node or ADDR (NIL).  */
             19213    1           2 USE_DEFAULT_IO UBIN,
             19214                          /* For USE procedures which default applies
             19215                             (see corresponding EQUs).  */
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:3    
             19216    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             19217                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             19218                             save the fields within the bounds of
             19219                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             19220                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             19221                             before calling the USE procedure.  */
             19222    1           2 FRAME_START_INDEX UBIN,
             19223                          /* Foist frame of the CURRENT.FORM$
             19224                             involved with the I-O error.  */
             19225    1           2 FRAME_STOP_INDEX UBIN,
             19226                          /* Larst frame of the CURRENT.FORM$
             19227                             involved with the I-O error.  */
             19228    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19229                          /* If IS_FIELD_INDEXES_VALID, use them;
             19230                             else use all the fields in the frame.  */
             19231    1           2 FIELD_START_INDEX UBIN,
             19232                          /* Starting index into QI$GZ_FIELD
             19233                             which may have values "pushed".  */
             19234    1           2 FIELD_STOP_INDEX UBIN,
             19235                          /* Stopping index into QI$GZ_FIELD
             19236                             which may have values "pushed".  */
             19237    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19238                          /* If IS_CURSOR_POSITION_VALID, use it;
             19239                             else allow cursor to default to upper-left-most field.  */
             19240    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19241                          /* POSition of the field on which to place the cursor.  */
             19242    1           2 STATUS UBIN;
             19243                          /* Returned action code; see corresponding EQUs.  */
             19250            %ENDIF;
       65    19253
       66    19254          %SET LISTMAC = '0'B;
       67    19255        %EJECT;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:4    
       68    19256    1       OPERAND_COUNT = QI_1.INSTR$ -> QI$OP_APPLY.OPERAND_COUNT;
       69    19257    1       INSTR$ = QI_1.INSTR$;
       70    19258    1       QI_1.INSTR$ = PINCRW ( QI_1.INSTR$, OPERAND_COUNT + 3 );
       71    19259
       72    19260    1       LAST_FILE$ = ADDR (NIL);
       73    19261
       74    19262    1   APPLY_FORM_FRAME_FIELD:
       75    19263    2       DO OPERAND_INDEX = 0 TO OPERAND_COUNT - 1;
       76    19264
       77    19265              %PROC_ADDRESS ( THING@P =
             19265                  "INSTR$ -> QI$OP_APPLY.OPERAND_A@P ( OPERAND_INDEX )",
       78    19266              CHECK_FOR_INDIRECTION = YES,
       79    19267              RESULT$ = "QI_1.CURRENT.NODE$" );
       80    19304
       81    19305    2   RETRY_NODE_APPLY:
       82    19306    2         CALL QCF$FIND_CURRENTS;
       83    19307
       84    19308    2         IF QI_1.CURRENT.NODE$ -> QI$DAD.WORD0_FLAGS.TYPE = %QI#TYPE_FORM
       85    19309    2         THEN
       86    19310    2   APPLY_TO_FORM:
       87    19311    3           DO;
       88    19312
       89    19313    3             IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19313                      IS_OUTPUT
       90    19314    3               AND NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.
             19314                        OPEN_FLAGS.IS_INPUT
       91    19315    3             THEN
       92    19316    4               DO;
       93    19317    4                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;
       94    19318    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;
       95    19319    4               END;
       96    19320
       97    19321    3   CHECK_ALL_THE_FRAMES:
       98    19322    3             DO FRAME_INDEX =
       99    19323    4               0 TO QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_COUNT - 1;
      100    19324
      101    19325                    %PROC_ADDRESS ( THING@P =
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:5    
             19325                        "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
      102    19326                    CHECK_FOR_INDIRECTION = NO,
      103    19327                    RESULT$ = FRAME$ );
      104    19364
      105    19365                    %DATA_ADDRESS ( THING@D = "FRAME$ -> QI$FRAME.STATUS_AREA@D",
      106    19366                    CHECK_FOR_INDIRECTION = NO,
      107    19367                    RESULT$ = FRAME_STATUS$ );
      108    19404
      109    19405    4               IF FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
      110    19406    4               THEN
      111    19407    4   APPLY_THAT_FRAME:
      112    19408    5                 DO;
      113    19409    5                   FIELD_START_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19409                            FIELD_START_INDEX;
      114    19410    5                   FIELD_STOP_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19410                            FIELD_STOP_INDEX;
      115    19411    5                   GZ_HEADER$ = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;
      116    19412    5                   GZ_FIELD$ = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$;
      117    19413
      118    19414    5                   CALL APPLY_TO_SELECTED_FIELDS;
      119    19415    5                 END APPLY_THAT_FRAME;
      120    19416
      121    19417    4             END CHECK_ALL_THE_FRAMES;
      122    19418
      123    19419    3           END APPLY_TO_FORM;
      124    19420    2         ELSE
      125    19421    2   APPLY_TO_FRAME_OR_LESS:
      126    19422    3           DO;
      127    19423    3             IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
      128    19424    3             THEN
      129    19425    4               DO;
      130    19426    4                 QI_1.ERROR_STATUS = %E$FRAME_NOT_ACTIVE;
      131    19427    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;
      132    19428    4               END;
      133    19429
      134    19430    3             IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19430                      IS_OUTPUT
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:6    
      135    19431    3               AND NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.
             19431                        OPEN_FLAGS.IS_INPUT
      136    19432    3             THEN
      137    19433    4               DO;
      138    19434    4                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;
      139    19435    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;
      140    19436    4               END;
      141    19437
      142    19438    3             FIELD_START_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.
             19438                      FIELD_START_INDEX;
      143    19439    3             FIELD_STOP_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.
             19439                      FIELD_STOP_INDEX;
      144    19440    3             GZ_HEADER$ = QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;
      145    19441    3             GZ_FIELD$ = PINCRW ( QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19441                      START$,
      146    19442    3               FIELD_START_INDEX * SIZEW (QI$GZ_FIELD) );
      147    19443
      148    19444    3             CALL APPLY_TO_SELECTED_FIELDS;
      149    19445    3           END APPLY_TO_FRAME_OR_LESS;
      150    19446
      151    19447    2   NEXT_NODE_PLEASE:
      152    19448
      153    19449    2       END APPLY_FORM_FRAME_FIELD;
      154    19450
      155    19451    1       RETURN;
      156    19452
      157    19453        %EJECT;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:7    
      158    19454    1   CHECK_USE_PROCEDURE_OR_INVALID:
      159    19455    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;
      160    19456    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;
      161    19457    1       QCU@USE.CURR_FRAME$ = QI_1.CURRENT.FRAME$;
      162    19458
      163    19459    1       IF QI_1.CURRENT.NODE$ -> QI$DAD.WORD0_FLAGS.TYPE < %QI#TYPE_MINOR
      164    19460    1       THEN
      165    19461    1         QCU@USE.CURR_NODE$ = QI_1.CURRENT.NODE$;
      166    19462    1       ELSE
      167    19463    1         QCU@USE.CURR_NODE$ = ADDR (NIL);
      168    19464
      169    19465    1       CALL QCU$USE_IO ( QCU@USE );
      170    19466
      171    19467    2       DO CASE ( QCU@USE.STATUS );
      172    19468
      173    19469    2         CASE ( %QI#USE_INVALID_RETURN );
      174    19470    2           RETURN;
      175    19471
      176    19472    2         CASE ( %QI#USE_INVALID_RETRY );
      177    19473    2           GOTO RETRY_NODE_APPLY;
      178    19474
      179    19475    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );
      180    19476    2           LAST_FILE$ = ADDR (NIL);
      181    19477    2           GOTO NEXT_NODE_PLEASE;
      182    19478
      183    19479    2         CASE ( ELSE );
      184    19480    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      185    19481
      186    19482    2       END;
      187    19483
      188    19484        %EJECT;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:8    
      189    19485    1   APPLY_TO_SELECTED_FIELDS: PROC;
      190    19486
      191    19487          %FPT_MDFFLD ( FPTN = FPT@MDFFLD,
      192    19488                        STCLASS = AUTO );
      193    19521          %VLP_FLDATR ( FPTN = VLP@FLDATR,
      194    19522                        STCLASS = AUTO );
      195    19548
      196    19549    2     DCL ERROR_STATUS$ PTR;
      197    19550    2     DCL FIELD_INDEX UBIN;
      198    19551
      199    19552    2     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
      200    19553
      201    19554    2       FPT@MDFFLD = QI_FPT_MDFFLD;
      202    19555    2       VBASE ( FPT@MDFFLD.V_ ) = ADDR ( FPT@MDFFLD.V );
      203    19556    2       FPT@MDFFLD.V.DCB# = GZ_HEADER$ -> QI$GZ_HEADER.DCB#;
      204    19557    2       FPT@MDFFLD.FLDATR_ = VECTOR ( VLP@FLDATR );
      205    19558    2       VLP@FLDATR = QI_VLP_FLDATR;
      206    19559
      207    19560    2   CHECK_SELECTED_FIELDS:
      208    19561    3       DO FIELD_INDEX = FIELD_START_INDEX TO FIELD_STOP_INDEX;
      209    19562
      210    19563    3         IF GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ ->
      211    19564    3           QI$INDICATORS.ENABLED_VALUE ~= %QI#DISABLED
      212    19565    3         THEN
      213    19566    3   FIELD_IS_SELECTED:
      214    19567    4           DO;
      215    19568
      216    19569    4             IF INSTR$ -> QI$OP_APPLY.VISUAL_ATTRIBUTE = %QI#INITIAL_VISUAL_ATTRIBUTE
      217    19570    4             THEN
      218    19571    5               DO;
      219    19572    5                 VISUAL_ATTRIBUTE = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ ->
      220    19573    5                   QI$FIELD_DAD.VISUAL_ATTRIBUTE;
      221    19574    5                 IF VISUAL_ATTRIBUTE = %QI#NO_VISUAL_ATTRIBUTE
      222    19575    5                 THEN
      223    19576    6                   DO;
      224    19577    6                     IF GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ ->
      225    19578    6                       QI$INDICATORS.OPEN_FLAGS.IS_INPUT
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:9    
      226    19579    6                     THEN
      227    19580    6                       VISUAL_ATTRIBUTE = %QI#INPUT_VISUAL_ATTRIBUTE;
      228    19581    6                     ELSE
      229    19582    6                       VISUAL_ATTRIBUTE = %QI#OUTPUT_VISUAL_ATTRIBUTE;
      230    19583    6                   END;
      231    19584    5               END;
      232    19585    4             ELSE
      233    19586    4               VISUAL_ATTRIBUTE = INSTR$ -> QI$OP_APPLY.VISUAL_ATTRIBUTE;
      234    19587
      235    19588    4             FPT@MDFFLD.KEY_ = VECTOR ( GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION )
             19588                      ;
      236    19589    4             VLP@FLDATR.ABSGRPRND = VISUAL_ATTRIBUTE;
      237    19590    4             GZ_FIELD$ -> QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE = VISUAL_ATTRIBUTE;
      238    19591
      239    19592    4             CALL QGB$MDFFLD ( FPT@MDFFLD, QGB_PARAM )
      240    19593    4             WHENALTRETURN
      241    19594    5               DO;
      242    19595    5                 CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );
      243    19596    5               END;
      244    19597
      245    19598    4             QI_1.SCREEN_UPDATE_FLAGS.WAS_APPLIED = %YES;
      246    19599
      247    19600    4             IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      248    19601    4             THEN
      249    19602    5               DO;
      250    19603    5                 IF QI_1.CURRENT.FORM$ ~= LAST_FILE$
      251    19604    5                 THEN
      252    19605    6                   DO;
      253    19606    6                     LAST_FILE$ = QI_1.CURRENT.FORM$;
      254    19607
      255    19608                          %DATA_ADDRESS ( THING@D =
             19608                              "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.ERROR_STATUS@D",
      256    19609                          CHECK_FOR_INDIRECTION = NO,
      257    19610                          RESULT$ = ERROR_STATUS$ );
      258    19647
      259    19648    6                     ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_APPLY_TEXT;
      260    19649    6                   END;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:10   
      261    19650    5               END;
      262    19651
      263    19652    4           END FIELD_IS_SELECTED;
      264    19653
      265    19654    3         GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );
      266    19655
      267    19656    3       END CHECK_SELECTED_FIELDS;
      268    19657
      269    19658    2       RETURN;
      270    19659
      271    19660    2   END APPLY_TO_SELECTED_FIELDS;
      272    19661
      273    19662    1   END QBA$APPLY;

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:11   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$APPLY.

   Procedure QBA$APPLY requires 525 words for executable code.
   Procedure QBA$APPLY requires 64 words of local(AUTO) storage.

    No errors detected in file QBA$APPLY.:E05TSI    .

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:12   

 Object Unit name= QBA$APPLY                                  File name= QBA$APPLY.:E05TOU
 UTS= JUL 30 '97 04:41:56.20 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      1      1  QBA$APPLY
    1   Proc  even  none   525    20D  QBA$APPLY
    2  RoData even  none     8      8  QBA$APPLY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        0  QBA$APPLY

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 QCF$FIND_CURRENTS
         yes           Std       1 QCU$USE_IO
         yes           Std       4 QCE$ERROR_INTERNAL
 yes     yes           Std       2 QGB$MDFFLD
         yes           Std       4 QCE$ERROR_M$INTERNAL
                       nStd      0 X6A_AUTO_0
                       nStd      0 X6D_MID
                       nStd      0 X6A_ARET
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     QI_1                                  QGB_PARAM                             QI_4_CHAR_ALPHANUMERIC
     QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY                      QI_32_BIT_BINARY
     QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING                     QI_VLP_FLDATR
     QI_FPT_MDFFLD                    r    G$ROS$
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:14   


        1        1        /*M* QBA$APPLY:  APPLY a VISUAL-ATTRIBUTE to a form, frame, or field.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QBA$APPLY
       10       10              PURPOSE:      APPLY a VISUAL-ATTRIBUTE to a form, frame, or field.
       11       11              DESCRIPTION:  Execute an APPLY op-code, whose argument may
       12       12                            be a field, a list of fields, a frame, a list of
       13       13                            frames, and/or a form, together with the
       14       14                            VISUAL-ATTRIBUTE to APPLY to the argument(s).
       15       15        */
       16       16
       17       17        QBA$APPLY: PROC;

     17   1 000000  D380 0000 0000  xent QBA$APPLY       LNJ,B5   X6A_AUTO_0
          1 000003       0040 0000                       DC       64,0

       18       18
       19       19        /*D*  NAME:         QBA$APPLY
       20       20              CALL:         CALL QBA$APPLY;
       21       21              PARAMETERS:   None.
       22       22              INTERFACE:    Called by QAT$TALLYHO when an APPLY op-code is
       23       23                            encountered.
       24       24                            Calls M$MDFFLD.
       25       25              ENVIRONMENT:  Nothing unusual.
       26       26              INPUT:        QI_1,
       27       27                            FPL rununit static data following the op-code.
       28       28              OUTPUT:       Toins the field(s) a pretty color.
       29       29              SCRATCH:      Various otter data.
       30       30              DESCRIPTION:  M$MDFFLDs the appropriate fields.  If the
       31       31                            INITIAL-ATTRIBUTE is desired, the QI$FIELD_DAD
       32       32                            is queried to get it.
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:15   
       33       33        */
       34       34
       35       35          %INCLUDE LCP_6;
       36      226          %INCLUDE QG_MACRO_M;
       37      363          %QGB_ENTRIES;
       38      376          %INCLUDE QI_EQUATES_E;
       39      735          %INCLUDE QI_PERR_C;
       40      903          %INCLUDE QI_MACROS_M;
       41     5961          %QI$ALL;
       42    17074          %QI_FPTS;
       43    19119
       44    19120    1     DCL OPERAND_COUNT UBIN;
       45    19121    1     DCL OPERAND_INDEX UBIN;
       46    19122    1     DCL FIELD_START_INDEX UBIN;
       47    19123    1     DCL FIELD_STOP_INDEX UBIN;
       48    19124    1     DCL FRAME$ PTR;
       49    19125    1     DCL FRAME_INDEX UBIN;
       50    19126    1     DCL FRAME_STATUS$ PTR;
       51    19127    1     DCL GZ_FIELD$ PTR;
       52    19128    1     DCL GZ_HEADER$ PTR;
       53    19129    1     DCL INSTR$ PTR;
       54    19130    1     DCL LAST_FILE$ PTR;
       55    19131    1     DCL VISUAL_ATTRIBUTE UBIN;
       56    19132
       57    19133    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
       58    19134    1     DCL QCF$FIND_CURRENTS ENTRY;
       59    19135    1     DCL QCU$USE_IO ENTRY (1);
       60    19136
       61    19137          %SET LISTMAC = '1'B;
       62    19138
       63    19139          %INCLUDE QCU_USE_M;
       64    19193          %QCU@USE;
             19194            %BEGIN_MACRO;
             19195            %SET LISTDIR = '0'B;
             19208    1     DCL 1 QCU@USE AUTO ALIGNED,
             19209    1           2 CURR_FRAME$ PTR,
             19210                          /* Pointer to DAD of current frame or ADDR (NIL).  */
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:16   
             19211    1           2 CURR_NODE$ PTR,
             19212                          /* Pointer to current node or ADDR (NIL).  */
             19213    1           2 USE_DEFAULT_IO UBIN,
             19214                          /* For USE procedures which default applies
             19215                             (see corresponding EQUs).  */
             19216    1           2 IS_TIME_TO_SAVE_AWAY_FIELDS BIT(1) ALIGNED,
             19217                          /* If IS_TIME_TO_SAVE_AWAY_FIELDS, then
             19218                             save the fields within the bounds of
             19219                             FRAME_START_INDEX, FRAME_STOP_INDEX,
             19220                             FIELD_START_INDEX, and FIELD_STOP_INDEX
             19221                             before calling the USE procedure.  */
             19222    1           2 FRAME_START_INDEX UBIN,
             19223                          /* Foist frame of the CURRENT.FORM$
             19224                             involved with the I-O error.  */
             19225    1           2 FRAME_STOP_INDEX UBIN,
             19226                          /* Larst frame of the CURRENT.FORM$
             19227                             involved with the I-O error.  */
             19228    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19229                          /* If IS_FIELD_INDEXES_VALID, use them;
             19230                             else use all the fields in the frame.  */
             19231    1           2 FIELD_START_INDEX UBIN,
             19232                          /* Starting index into QI$GZ_FIELD
             19233                             which may have values "pushed".  */
             19234    1           2 FIELD_STOP_INDEX UBIN,
             19235                          /* Stopping index into QI$GZ_FIELD
             19236                             which may have values "pushed".  */
             19237    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19238                          /* If IS_CURSOR_POSITION_VALID, use it;
             19239                             else allow cursor to default to upper-left-most field.  */
             19240    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19241                          /* POSition of the field on which to place the cursor.  */
             19242    1           2 STATUS UBIN;
             19243                          /* Returned action code; see corresponding EQUs.  */
             19250            %ENDIF;
       65    19253
       66    19254          %SET LISTMAC = '0'B;
       67    19255        %EJECT;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:17   
       68    19256    1       OPERAND_COUNT = QI_1.INSTR$ -> QI$OP_APPLY.OPERAND_COUNT;

  19256   1 000005  EC80 0000 0006  xsym                 LDB,B6   QI_1+6
          1 000008  E846 0002                            LDR,R6   2,B6
          1 00000A  EF47 0004                            STR,R6   OPERAND_COUNT,AUTO

       69    19257    1       INSTR$ = QI_1.INSTR$;

  19257   1 00000C  EFC7 0011                            STB,B6   INSTR$,AUTO

       70    19258    1       QI_1.INSTR$ = PINCRW ( QI_1.INSTR$, OPERAND_COUNT + 3 );

  19258   1 00000E  F856                                 LDR,R7   R6
          1 00000F  6C00                                 LDV,R6   0
          1 000010  8400 0000 0006  xsym                 AID      QI_1+6
          1 000013  8470 0000 0003                       AID      3,IMO
          1 000016  8D00 0000 0006  xsym                 SDI      QI_1+6

       71    19259
       72    19260    1       LAST_FILE$ = ADDR (NIL);

  19260   1 000019  DB80 0000 0000                       LAB,B5   0
          1 00001C  DFC7 0013                            STB,B5   LAST_FILE$,AUTO

       73    19261
       74    19262    1   APPLY_FORM_FRAME_FIELD:
       75    19263    2       DO OPERAND_INDEX = 0 TO OPERAND_COUNT - 1;

  19263   1 00001E  8747 0005            APPLY_FORM_FRAM*CL       OPERAND_INDEX,AUTO
          1 000020  0F81 00D6                            B        s:19445+2,PREL

       76    19264
       77    19265              %PROC_ADDRESS ( THING@P =
             19265                  "INSTR$ -> QI$OP_APPLY.OPERAND_A@P ( OPERAND_INDEX )",
       78    19266              CHECK_FOR_INDIRECTION = YES,
       79    19267              RESULT$ = "QI_1.CURRENT.NODE$" );

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:18   
  19285   1 000022  ECC7 0011                            LDB,B6   INSTR$,AUTO
          1 000024  B847 0005                            LDR,R3   OPERAND_INDEX,AUTO
          1 000026  3E03                                 ADV,R3   3
          1 000027  A836                                 LDR,R2   ,B6,R3
          1 000028  F852                                 LDR,R7   R2
          1 000029  6C00                                 LDV,R6   0
          1 00002A  8400 0000 0002  xsym                 AID      QI_1+2
          1 00002D  8D00 0000 0080  xsym                 SDI      QI_1+128

  19287   1 000030  DC80 0000 0080  xsym                 LDB,B5   QI_1+128
          1 000033  8985                                 CMZ      ,B5
          1 000034  0881 001C                            BAGE     s:19294,PREL

  19288   1 000036  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          1 000039  E806                                 LDR,R6   ,B6
          1 00003A  6046                                 SOR,R6   6
          1 00003B  E570 0001                            AND,R6   1,IMO
          1 00003D  B846 0002                            LDR,R3   2,B6
          1 00003F  A856                                 LDR,R2   R6
          1 000040  DCA0 0000 0000  xsym                 LDB,B5   QI_1,R2
          1 000043  DFC7 003C                            STB,B5   FIELD_INDEX+2,AUTO
          1 000045  F853                                 LDR,R7   R3
          1 000046  6C00                                 LDV,R6   0
          1 000047  8447 003C                            AID      FIELD_INDEX+2,AUTO
          1 000049  8D00 0000 0080  xsym                 SDI      QI_1+128

  19292   1 00004C  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          1 00004F  8986                                 CMZ      ,B6
          1 000050  0866                                 BAL      s:19288,SPREL

       80    19304
       81    19305    2   RETRY_NODE_APPLY:
       82    19306    2         CALL QCF$FIND_CURRENTS;

  19306   1 000051  CBF0 0000            RETRY_NODE_APPLYLAB,B4   0,IMO
          1 000053  E380 0000 0000  xent                 LNJ,B6   QCF$FIND_CURRENTS
          1 000056       0001                            DC       s:19308,PREL
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:19   

       83    19307
       84    19308    2         IF QI_1.CURRENT.NODE$ -> QI$DAD.WORD0_FLAGS.TYPE = %QI#TYPE_FORM

  19308   1 000057  EC80 0000 0080  xsym                 LDB,B6   QI_1+128
          1 00005A  E806                                 LDR,R6   ,B6
          1 00005B  E570 000F                            AND,R6   15,IMO
          1 00005D  6D0B                                 CMV,R6   11
          1 00005E  0981 0055                            BNE      s:19422,PREL

       85    19309    2         THEN
       86    19310    2   APPLY_TO_FORM:
       87    19311    3           DO;

  19311   1                              APPLY_TO_FORM   null
       88    19312
       89    19313    3             IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19313                      IS_OUTPUT

  19313   1 000060  DC80 0000 0078  xsym APPLY_TO_FORM   LDB,B5   QI_1+120
          1 000063  82C5 0008                            LB,'0400'X        8,B5
          1 000065       0400
          1 000066  0501 000C                            BBT      s:19323,PREL
          1 000068  82C5 0008                            LB,'0200'X        8,B5
          1 00006A       0200
          1 00006B  0501 0007                            BBT      s:19323,PREL

       90    19314    3               AND NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.
             19314                        OPEN_FLAGS.IS_INPUT
       91    19315    3             THEN
       92    19316    4               DO;

       93    19317    4                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;

  19317   1 00006D  5C01                                 LDV,R5   1
          1 00006E  DF00 0000 008C  xsym                 STR,R5   QI_1+140

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:20   
       94    19318    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  19318   1 000071  0F81 008E                            B        s:19455,PREL

       95    19319    4               END;
       96    19320
       97    19321    3   CHECK_ALL_THE_FRAMES:
       98    19322    3             DO FRAME_INDEX =
       99    19323    4               0 TO QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_COUNT - 1;

  19323   1 000073  8747 000A            CHECK_ALL_THE_F*CL       FRAME_INDEX,AUTO
          1 000075  0F81 0034                            B        s:19417+2,PREL

      100    19324
      101    19325                    %PROC_ADDRESS ( THING@P =
             19325                       "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
      102    19326                    CHECK_FOR_INDIRECTION = NO,
      103    19327                    RESULT$ = FRAME$ );

  19345   1 000077  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 00007A  B847 000A                            LDR,R3   FRAME_INDEX,AUTO
          1 00007C  3E0B                                 ADV,R3   11
          1 00007D  A836                                 LDR,R2   ,B6,R3
          1 00007E  F852                                 LDR,R7   R2
          1 00007F  6C00                                 LDV,R6   0
          1 000080  8400 0000 0002  xsym                 AID      QI_1+2
          1 000083  8D47 0008                            SDI      FRAME$,AUTO

      104    19364
      105    19365                    %DATA_ADDRESS ( THING@D = "FRAME$ -> QI$FRAME.STATUS_AREA@D",
      106    19366                    CHECK_FOR_INDIRECTION = NO,
      107    19367                    RESULT$ = FRAME_STATUS$ );

  19385   1 000085  DCC7 0008                            LDB,B5   FRAME$,AUTO
          1 000087  9845 0006                            LDR,R1   6,B5
          1 000089  F851                                 LDR,R7   R1
          1 00008A  6C00                                 LDV,R6   0
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:21   
          1 00008B  8400 0000 0000  xsym                 AID      QI_1
          1 00008E  8D47 000B                            SDI      FRAME_STATUS$,AUTO

      108    19404
      109    19405    4               IF FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  19405   1 000090  CCC7 000B                            LDB,B4   FRAME_STATUS$,AUTO
          1 000092  89C4 000C                            CMZ      12,B4
          1 000094  0881 0013                            BAGE     s:19417,PREL

      110    19406    4               THEN
      111    19407    4   APPLY_THAT_FRAME:
      112    19408    5                 DO;

  19408   1                              APPLY_THAT_FRAMEnull
      113    19409    5                   FIELD_START_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19409                            FIELD_START_INDEX;

  19409   1 000096  D804                 APPLY_THAT_FRAMELDR,R5   ,B4
          1 000097  DF47 0006                            STR,R5   FIELD_START_INDEX,AUTO

      114    19410    5                   FIELD_STOP_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19410                            FIELD_STOP_INDEX;

  19410   1 000099  C844 0001                            LDR,R4   1,B4
          1 00009B  CF47 0007                            STR,R4   FIELD_STOP_INDEX,AUTO

      115    19411    5                   GZ_HEADER$ = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;

  19411   1 00009D  BCC4 0004                            LDB,B3   4,B4
          1 00009F  BFC7 000F                            STB,B3   GZ_HEADER$,AUTO

      116    19412    5                   GZ_FIELD$ = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$;

  19412   1 0000A1  ACC4 0006                            LDB,B2   6,B4
          1 0000A3  AFC7 000D                            STB,B2   GZ_FIELD$,AUTO

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:22   
      117    19413
      118    19414    5                   CALL APPLY_TO_SELECTED_FIELDS;

  19414   1 0000A5  E3C0 00A3                            LNJ,B6   s:0,PREL
          1 0000A7       0001                            DC       s:19417,PREL

      119    19415    5                 END APPLY_THAT_FRAME;

      120    19416
      121    19417    4             END CHECK_ALL_THE_FRAMES;

  19417   1 0000A8  8AC7 000A                            INC      FRAME_INDEX,AUTO
          1 0000AA  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 0000AD  E847 000A                            LDR,R6   FRAME_INDEX,AUTO
          1 0000AF  E946 0001                            CMR,R6   1,B6
          1 0000B1  0246                                 BL       s:19345,SPREL

      122    19418
      123    19419    3           END APPLY_TO_FORM;

  19419   1 0000B2  0F81 0042                            B        s:19445,PREL

      124    19420    2         ELSE
      125    19421    2   APPLY_TO_FRAME_OR_LESS:
      126    19422    3           DO;

  19422   1                              APPLY_TO_FRAME_*null
      127    19423    3             IF NOT QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  19423   1 0000B4  DC80 0000 007C  xsym APPLY_TO_FRAME_*LDB,B5   QI_1+124
          1 0000B7  89C5 000C                            CMZ      12,B5
          1 0000B9  0801 0007                            BAL      s:19430,PREL

      128    19424    3             THEN
      129    19425    4               DO;

      130    19426    4                 QI_1.ERROR_STATUS = %E$FRAME_NOT_ACTIVE;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:23   

  19426   1 0000BB  5C07                                 LDV,R5   7
          1 0000BC  DF00 0000 008C  xsym                 STR,R5   QI_1+140

      131    19427    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  19427   1 0000BF  0F81 0040                            B        s:19455,PREL

      132    19428    4               END;
      133    19429
      134    19430    3             IF NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.
             19430                      IS_OUTPUT

  19430   1 0000C1  CC80 0000 0078  xsym                 LDB,B4   QI_1+120
          1 0000C4  82C4 0008                            LB,'0400'X        8,B4
          1 0000C6       0400
          1 0000C7  0501 000C                            BBT      s:19438,PREL
          1 0000C9  82C4 0008                            LB,'0200'X        8,B4
          1 0000CB       0200
          1 0000CC  0501 0007                            BBT      s:19438,PREL

      135    19431    3               AND NOT QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.INDICATORS.
             19431                        OPEN_FLAGS.IS_INPUT
      136    19432    3             THEN
      137    19433    4               DO;

      138    19434    4                 QI_1.ERROR_STATUS = %E$FILE_NOT_OPEN;

  19434   1 0000CE  5C01                                 LDV,R5   1
          1 0000CF  DF00 0000 008C  xsym                 STR,R5   QI_1+140

      139    19435    4                 GOTO CHECK_USE_PROCEDURE_OR_INVALID;

  19435   1 0000D2  0F81 002D                            B        s:19455,PREL

      140    19436    4               END;
      141    19437
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:24   
      142    19438    3             FIELD_START_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.
             19438                      FIELD_START_INDEX;

  19438   1 0000D4  BC80 0000 0082  xsym                 LDB,B3   QI_1+130
          1 0000D7  D803                                 LDR,R5   ,B3
          1 0000D8  DF47 0006                            STR,R5   FIELD_START_INDEX,AUTO

      143    19439    3             FIELD_STOP_INDEX = QI_1.CURRENT.NODE_STATUS$ -> QI$MAJOR_STATUS.GZ.
             19439                      FIELD_STOP_INDEX;

  19439   1 0000DA  C843 0001                            LDR,R4   1,B3
          1 0000DC  CF47 0007                            STR,R4   FIELD_STOP_INDEX,AUTO

      144    19440    3             GZ_HEADER$ = QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.HEADER$;

  19440   1 0000DE  ACC5 0004                            LDB,B2   4,B5
          1 0000E0  AFC7 000F                            STB,B2   GZ_HEADER$,AUTO

      145    19441    3             GZ_FIELD$ = PINCRW ( QI_1.CURRENT.FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19441                      START$,

  19441   1 0000E2  9CC5 0006                            LDB,B1   6,B5
          1 0000E4  9FC7 003C                            STB,B1   FIELD_INDEX+2,AUTO
          1 0000E6  F855                                 LDR,R7   R5
          1 0000E7  6C00                                 LDV,R6   0
          1 0000E8  9B80 0000 0000  02                   LAB,B1   0
          1 0000EB  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          1 0000EE  8447 003C                            AID      FIELD_INDEX+2,AUTO
          1 0000F0  8D47 000D                            SDI      GZ_FIELD$,AUTO

      146    19442    3               FIELD_START_INDEX * SIZEW (QI$GZ_FIELD) );
      147    19443
      148    19444    3             CALL APPLY_TO_SELECTED_FIELDS;

  19444   1 0000F2  E3C0 0056                            LNJ,B6   s:0,PREL
          1 0000F4       0001                            DC       s:19445,PREL

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:25   
      149    19445    3           END APPLY_TO_FRAME_OR_LESS;

      150    19446
      151    19447    2   NEXT_NODE_PLEASE:
      152    19448
      153    19449    2       END APPLY_FORM_FRAME_FIELD;

  19449   1 0000F5  8AC7 0005            NEXT_NODE_PLEASEINC      OPERAND_INDEX,AUTO
          1 0000F7  E847 0005                            LDR,R6   OPERAND_INDEX,AUTO
          1 0000F9  E947 0004                            CMR,R6   OPERAND_COUNT,AUTO
          1 0000FB  0201 FF26                            BL       s:19285,PREL

      154    19450
      155    19451    1       RETURN;

  19451   1 0000FD  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      156    19452
      157    19453        %EJECT;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:26   
      158    19454    1   CHECK_USE_PROCEDURE_OR_INVALID:
      159    19455    1       QCU@USE.USE_DEFAULT_IO = %QI#USE_DEFAULT_NONE;

  19455   1 000100  8747 001A            CHECK_USE_PROCE*CL       QCU@USE+4,AUTO

      160    19456    1       QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS = %NO;

  19456   1 000102  8747 001B                            CL       QCU@USE+5,AUTO

      161    19457    1       QCU@USE.CURR_FRAME$ = QI_1.CURRENT.FRAME$;

  19457   1 000104  DC80 0000 007A  xsym                 LDB,B5   QI_1+122
          1 000107  DFC7 0016                            STB,B5   QCU@USE,AUTO

      162    19458
      163    19459    1       IF QI_1.CURRENT.NODE$ -> QI$DAD.WORD0_FLAGS.TYPE < %QI#TYPE_MINOR

  19459   1 000109  E806                                 LDR,R6   ,B6
          1 00010A  E570 000F                            AND,R6   15,IMO
          1 00010C  6D08                                 CMV,R6   8
          1 00010D  0281 0005                            BGE      s:19463,PREL

      164    19460    1       THEN
      165    19461    1         QCU@USE.CURR_NODE$ = QI_1.CURRENT.NODE$;

  19461   1 00010F  EFC7 0018                            STB,B6   QCU@USE+2,AUTO
          1 000111  0F81 0006                            B        s:19465,PREL

      166    19462    1       ELSE
      167    19463    1         QCU@USE.CURR_NODE$ = ADDR (NIL);

  19463   1 000113  CB80 0000 0000                       LAB,B4   0
          1 000116  CFC7 0018                            STB,B4   QCU@USE+2,AUTO

      168    19464
      169    19465    1       CALL QCU$USE_IO ( QCU@USE );

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:27   
  19465   1 000118  CBC7 0016                            LAB,B4   QCU@USE,AUTO
          1 00011A  CFC7 003C                            STB,B4   FIELD_INDEX+2,AUTO
          1 00011C  BBC7 003C                            LAB,B3   FIELD_INDEX+2,AUTO
          1 00011E  CBF0 0100                            LAB,B4   256,IMO
          1 000120  E380 0000 0000  xent                 LNJ,B6   QCU$USE_IO
          1 000123       0001                            DC       s:19467,PREL

      170    19466
      171    19467    2       DO CASE ( QCU@USE.STATUS );

  19467   1 000124  B847 0023                            LDR,R3   QCU@USE+13,AUTO
          1 000126  3D03                                 CMV,R3   3
          1 000127  0281 0016                            BGE      s:19480,PREL
          1 000129  A830 0000 012F  01                   LDR,R2   s:19467+11,R3
          1 00012C  83A0 0000 0132  01                   JMP      s:19470,R2
          1 00012F       0000                            DC       s:19470,PREL
          1 000130       0003                            DC       s:19473,PREL
          1 000131       0005                            DC       s:19476,PREL

      172    19468
      173    19469    2         CASE ( %QI#USE_INVALID_RETURN );

      174    19470    2           RETURN;

  19470   1 000132  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      175    19471
      176    19472    2         CASE ( %QI#USE_INVALID_RETRY );

      177    19473    2           GOTO RETRY_NODE_APPLY;

  19473   1 000135  0F81 FF1B                            B        s:19294,PREL

      178    19474
      179    19475    2         CASE ( %QI#USE_INVALID_SKIP_TO_NEXT );

      180    19476    2           LAST_FILE$ = ADDR (NIL);
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:28   

  19476   1 000137  EB80 0000 0000                       LAB,B6   0
          1 00013A  EFC7 0013                            STB,B6   LAST_FILE$,AUTO

      181    19477    2           GOTO NEXT_NODE_PLEASE;

  19477   1 00013C  0F81 FFB8                            B        s:19445,PREL

      182    19478
      183    19479    2         CASE ( ELSE );

      184    19480    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19480   1 00013E  BB80 0000 0003  02                   LAB,B3   +3
          1 000141  CBF0 0100                            LAB,B4   256,IMO
          1 000143  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 000146       0001                            DC       s:19482,PREL

      185    19481
      186    19482    2       END;

  19482   1 000147  0F81 00C2                            B        s:19662,PREL

      187    19483
      188    19484        %EJECT;
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:29   
      189    19485    1   APPLY_TO_SELECTED_FIELDS: PROC;

  19485   1 000149  EFC7 0024            APPLY_TO_SELECT*STB,B6   QCU@USE+14,AUTO

      190    19486
      191    19487          %FPT_MDFFLD ( FPTN = FPT@MDFFLD,
      192    19488                        STCLASS = AUTO );
      193    19521          %VLP_FLDATR ( FPTN = VLP@FLDATR,
      194    19522                        STCLASS = AUTO );
      195    19548
      196    19549    2     DCL ERROR_STATUS$ PTR;
      197    19550    2     DCL FIELD_INDEX UBIN;
      198    19551
      199    19552    2     DCL QCE$ERROR_M$INTERNAL ENTRY (4);
      200    19553
      201    19554    2       FPT@MDFFLD = QI_FPT_MDFFLD;

  19554   1 00014B  AB80 0000 0000  xsym                 LAB,B2   QI_FPT_MDFFLD
          1 00014E  2C00                                 LDV,R2   0
          1 00014F  6C1E                                 LDV,R6   30
          1 000150  BB87                                 LAB,B3   ,AUTO
          1 000151  3C4C                                 LDV,R3   76
          1 000152  0008                                 MMM

      202    19555    2       VBASE ( FPT@MDFFLD.V_ ) = ADDR ( FPT@MDFFLD.V );

  19555   1 000153  EBC7 0032                            LAB,B6   FPT@MDFFLD+12,AUTO
          1 000155  EFC7 0027                            STB,B6   FPT@MDFFLD+1,AUTO

      203    19556    2       FPT@MDFFLD.V.DCB# = GZ_HEADER$ -> QI$GZ_HEADER.DCB#;

  19556   1 000157  DCC7 000F                            LDB,B5   GZ_HEADER$,AUTO
          1 000159  E845 0003                            LDR,R6   3,B5
          1 00015B  E7C7 0032                            STH,R6   FPT@MDFFLD+12,AUTO

      204    19557    2       FPT@MDFFLD.FLDATR_ = VECTOR ( VLP@FLDATR );

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:30   
  19557   1 00015D  CBC7 0035                            LAB,B4   VLP@FLDATR,AUTO
          1 00015F  CFC7 003D                            STB,B4   FIELD_INDEX+3,AUTO
          1 000161  6C05                                 LDV,R6   5
          1 000162  EF47 003C                            STR,R6   FIELD_INDEX+2,AUTO
          1 000164  ABC7 003C                            LAB,B2   FIELD_INDEX+2,AUTO
          1 000166  2C00                                 LDV,R2   0
          1 000167  6C06                                 LDV,R6   6
          1 000168  BB87                                 LAB,B3   ,AUTO
          1 000169  3C5E                                 LDV,R3   94
          1 00016A  0008                                 MMM

      205    19558    2       VLP@FLDATR = QI_VLP_FLDATR;

  19558   1 00016B  AB80 0000 0000  xsym                 LAB,B2   QI_VLP_FLDATR
          1 00016E  2C00                                 LDV,R2   0
          1 00016F  6C06                                 LDV,R6   6
          1 000170  BB87                                 LAB,B3   ,AUTO
          1 000171  3C6A                                 LDV,R3   106
          1 000172  0008                                 MMM

      206    19559
      207    19560    2   CHECK_SELECTED_FIELDS:
      208    19561    3       DO FIELD_INDEX = FIELD_START_INDEX TO FIELD_STOP_INDEX;

  19561   1 000173  E847 0006            CHECK_SELECTED_*LDR,R6   FIELD_START_INDEX,AUTO
          1 000175  EF47 003A                            STR,R6   FIELD_INDEX,AUTO
          1 000177  0F81 0088                            B        s:19656+2,PREL

      209    19562
      210    19563    3         IF GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ ->

  19563   1 000179  ECC7 000D                            LDB,B6   GZ_FIELD$,AUTO
          1 00017B  DC86                                 LDB,B5   ,B6
          1 00017C  8285                                 LB,'6000'X        ,B5
          1 00017D       6000
          1 00017E  0581 0078                            BBF      s:19654,PREL

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:31   
      211    19564    3           QI$INDICATORS.ENABLED_VALUE ~= %QI#DISABLED
      212    19565    3         THEN
      213    19566    3   FIELD_IS_SELECTED:
      214    19567    4           DO;

  19567   1                              FIELD_IS_SELECT*null
      215    19568
      216    19569    4             IF INSTR$ -> QI$OP_APPLY.VISUAL_ATTRIBUTE = %QI#INITIAL_VISUAL_ATTRIBUTE

  19569   1 000180  CCC7 0011            FIELD_IS_SELECT*LDB,B4   INSTR$,AUTO
          1 000182  E844 0001                            LDR,R6   1,B4
          1 000184  6D08                                 CMV,R6   8
          1 000185  0981 0019                            BNE      s:19586,PREL

      217    19570    4             THEN
      218    19571    5               DO;

      219    19572    5                 VISUAL_ATTRIBUTE = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ ->

  19572   1 000187  BCC6 0004                            LDB,B3   4,B6
          1 000189  D843 000A                            LDR,R5   10,B3
          1 00018B  D570 00FF                            AND,R5   255,IMO
          1 00018D  DF47 0015                            STR,R5   VISUAL_ATTRIBUTE,AUTO

      220    19573    5                   QI$FIELD_DAD.VISUAL_ATTRIBUTE;
      221    19574    5                 IF VISUAL_ATTRIBUTE = %QI#NO_VISUAL_ATTRIBUTE

  19574   1 00018F  5981 0011                            BNEZ,R5  s:19588,PREL

      222    19575    5                 THEN
      223    19576    6                   DO;

      224    19577    6                     IF GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ ->

  19577   1 000191  8285                                 LB,'0200'X        ,B5
  19577   1 000192       0200
          1 000193  0581 0006                            BBF      s:19582,PREL
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:32   

      225    19578    6                       QI$INDICATORS.OPEN_FLAGS.IS_INPUT
      226    19579    6                     THEN
      227    19580    6                       VISUAL_ATTRIBUTE = %QI#INPUT_VISUAL_ATTRIBUTE;

  19580   1 000195  5C04                                 LDV,R5   4
          1 000196  DF47 0015                            STR,R5   VISUAL_ATTRIBUTE,AUTO
          1 000198  0F81 0008                            B        s:19588,PREL

      228    19581    6                     ELSE
      229    19582    6                       VISUAL_ATTRIBUTE = %QI#OUTPUT_VISUAL_ATTRIBUTE;

  19582   1 00019A  5C05                                 LDV,R5   5
          1 00019B  DF47 0015                            STR,R5   VISUAL_ATTRIBUTE,AUTO

      230    19583    6                   END;

      231    19584    5               END;

  19584   1 00019D  0F81 0003                            B        s:19588,PREL

      232    19585    4             ELSE
      233    19586    4               VISUAL_ATTRIBUTE = INSTR$ -> QI$OP_APPLY.VISUAL_ATTRIBUTE;

  19586   1 00019F  EF47 0015                            STR,R6   VISUAL_ATTRIBUTE,AUTO

      234    19587
      235    19588    4            FPT@MDFFLD.KEY_ = VECTOR ( GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.POSITION )
             19588                      ;

  19588   1 0001A1  BBC6 0003                            LAB,B3   3,B6
          1 0001A3  BFC7 003D                            STB,B3   FIELD_INDEX+3,AUTO
          1 0001A5  6C01                                 LDV,R6   1
          1 0001A6  EF47 003C                            STR,R6   FIELD_INDEX+2,AUTO
          1 0001A8  ABC7 003C                            LAB,B2   FIELD_INDEX+2,AUTO
          1 0001AA  2C00                                 LDV,R2   0
          1 0001AB  6C06                                 LDV,R6   6
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:33   
          1 0001AC  BB87                                 LAB,B3   ,AUTO
          1 0001AD  3C58                                 LDV,R3   88
          1 0001AE  0008                                 MMM

      236    19589    4             VLP@FLDATR.ABSGRPRND = VISUAL_ATTRIBUTE;

  19589   1 0001AF  E847 0015                            LDR,R6   VISUAL_ATTRIBUTE,AUTO
          1 0001B1  E7C7 0037                            STH,R6   VLP@FLDATR+2,AUTO

      237    19590    4             GZ_FIELD$ -> QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE = VISUAL_ATTRIBUTE;

  19590   1 0001B3  ECC7 000D                            LDB,B6   GZ_FIELD$,AUTO
          1 0001B5  E7C6 0007                            STH,R6   7,B6

      238    19591
      239    19592    4             CALL QGB$MDFFLD ( FPT@MDFFLD, QGB_PARAM )

  19592   1 0001B7  DB80 0000 0000  xsym                 LAB,B5   QGB_PARAM
          1 0001BA  DFC7 003E                            STB,B5   FIELD_INDEX+4,AUTO
          1 0001BC  CBC7 0026                            LAB,B4   FPT@MDFFLD,AUTO
          1 0001BE  CFC7 003C                            STB,B4   FIELD_INDEX+2,AUTO
          1 0001C0  BBC7 003C                            LAB,B3   FIELD_INDEX+2,AUTO
          1 0001C2  CBF0 0200                            LAB,B4   512,IMO
          1 0001C4  E380 0000 0000  xent                 LNJ,B6   QGB$MDFFLD
          1 0001C7       0003                            DC       s:19595,PREL
          1 0001C8  0F81 000A                            B        s:19598,PREL

      240    19593    4             WHENALTRETURN
      241    19594    5               DO;

      242    19595    5                 CALL QCE$ERROR_M$INTERNAL ( %E$UNEXPECTED_ALTRET );

  19595   1 0001CA  BB80 0000 0006  02                   LAB,B3   +6
          1 0001CD  CBF0 0100                            LAB,B4   256,IMO
          1 0001CF  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_M$INTERNAL
          1 0001D2       0001                            DC       s:19598,PREL

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:34   
      243    19596    5               END;

      244    19597
      245    19598    4             QI_1.SCREEN_UPDATE_FLAGS.WAS_APPLIED = %YES;

  19598   1 0001D3  8900 0000 0016  xsym                 LBT,'8000'X       QI_1+22
  19598   1 0001D6       8000

      246    19599
      247    19600    4             IF QI_1.CURRENT.FORM$ -> QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID

  19600   1 0001D7  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 0001DA  8286                                 LB,'4000'X        ,B6
          1 0001DB       4000
          1 0001DC  0581 001A                            BBF      s:19654,PREL

      248    19601    4             THEN
      249    19602    5               DO;

      250    19603    5                 IF QI_1.CURRENT.FORM$ ~= LAST_FILE$

  19603   1 0001DE  EDC7 0013                            CMB,B6   LAST_FILE$,AUTO
          1 0001E0  0901 0016                            BE       s:19654,PREL

      251    19604    5                 THEN
      252    19605    6                   DO;

      253    19606    6                     LAST_FILE$ = QI_1.CURRENT.FORM$;

  19606   1 0001E2  EFC7 0013                            STB,B6   LAST_FILE$,AUTO

      254    19607
      255    19608                          %DATA_ADDRESS ( THING@D =
             19608                              "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.ERROR_STATUS@D",
      256    19609                          CHECK_FOR_INDIRECTION = NO,
      257    19610                          RESULT$ = ERROR_STATUS$ );

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:35   
  19628   1 0001E4  B846 0003                            LDR,R3   3,B6
          1 0001E6  F853                                 LDR,R7   R3
          1 0001E7  6C00                                 LDV,R6   0
          1 0001E8  8400 0000 0000  xsym                 AID      QI_1
          1 0001EB  8D47 0038                            SDI      ERROR_STATUS$,AUTO

      258    19647
      259    19648    6                     ERROR_STATUS$ -> QI$ERROR_STATUS.TEXT = %QI#OP_APPLY_TEXT;

  19648   1 0001ED  DB80 0000 0000  00                   LAB,B5   0
          1 0001F0  CCC7 0038                            LDB,B4   ERROR_STATUS$,AUTO
          1 0001F2  0021                                 ALR      ;
          1 0001F3       4205 0000                                ALPHANUM(0,B5,,2),;
          1 0001F5       4804 0000                                ALPHANUM(0,B4,,8,FILL)

      260    19649    6                   END;

      261    19650    5               END;

      262    19651
      263    19652    4           END FIELD_IS_SELECTED;

      264    19653
      265    19654    3         GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );

  19654   1 0001F7  437F                                 CSYNC    s:19648+9,SPREL
          1 0001F8  ECC7 000D                            LDB,B6   GZ_FIELD$,AUTO
          1 0001FA  DBC6 000C                            LAB,B5   12,B6
          1 0001FC  DFC7 000D                            STB,B5   GZ_FIELD$,AUTO

      266    19655
      267    19656    3       END CHECK_SELECTED_FIELDS;

  19656   1 0001FE  8AC7 003A                            INC      FIELD_INDEX,AUTO
          1 000200  E847 003A                            LDR,R6   FIELD_INDEX,AUTO
          1 000202  E947 0007                            CMR,R6   FIELD_STOP_INDEX,AUTO
          1 000204  0381 FF74                            BLE      s:19563,PREL
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:36   

      268    19657
      269    19658    2       RETURN;

  19658   1 000206  ECC7 0024                            LDB,B6   QCU@USE+14,AUTO
          1 000208  C3C6 0001                            LNJ,B4   1,B6

      270    19659
      271    19660    2   END APPLY_TO_SELECTED_FIELDS;
      272    19661
      273    19662    1   END QBA$APPLY;

  19662   1 00020A  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:37   
--  Include file information  --

   QCU_USE_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QBA$APPLY.
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:38   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    38-0-0/w PTR         r     1 ERROR_STATUS$             3A-0-0/w UBIN(16)    r     1 FIELD_INDEX
     6-0-0/w UBIN(16)    r     1 FIELD_START_INDEX          7-0-0/w UBIN(16)    r     1 FIELD_STOP_INDEX
    26-0-0/w STRC(240)   r     1 FPT@MDFFLD                 8-0-0/w PTR         r     1 FRAME$
     A-0-0/w UBIN(16)    r     1 FRAME_INDEX                B-0-0/w PTR         r     1 FRAME_STATUS$
     D-0-0/w PTR         r     1 GZ_FIELD$                  F-0-0/w PTR         r     1 GZ_HEADER$
    11-0-0/w PTR         r     1 INSTR$                    13-0-0/w PTR         r     1 LAST_FILE$
     4-0-0/w UBIN(16)    r     1 OPERAND_COUNT              5-0-0/w UBIN(16)    r     1 OPERAND_INDEX
    16-0-0/w STRC(224)   r     1 QCU@USE                   15-0-0/w UBIN(16)    r     1 VISUAL_ATTRIBUTE
    35-0-0/w STRC(48)    r     1 VLP@FLDATR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(432)   r     1 QGB_PARAM                  0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w STRC(240)   r     1 QI_FPT_MDFFLD              0-0-0/w STRC(48)    r     1 QI_VLP_FLDATR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(48)    r     1 QI$DAD                     0-0-0/c STRC(64)    r     1 QI$ERROR_STATUS
     0-0-0/w STRC(384)   r     1 QI$FIELD_DAD               0-0-0/w STRC(192)   r     1 QI$FORM_FILE
     0-0-0/w STRC(144)   r     1 QI$FORM_STATUS             0-0-0/w STRC(128)   r     1 QI$FRAME
     0-0-0/w STRC(208)   r     1 QI$FRAME_STATUS            0-0-0/w STRC(184)   r     1 QI$GZ_FIELD
     0-0-0/w STRC(176)   r     1 QI$GZ_HEADER               0-0-0/w STRC(16)    r     1 QI$INDICATORS
     0-0-0/w STRC(48)    r     1 QI$MAJOR_STATUS            0-0-0/w STRC(64)    r     1 QI$OP_APPLY
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:39   


   Procedure QBA$APPLY requires 525 words for executable code.
   Procedure QBA$APPLY requires 64 words of local(AUTO) storage.

    No errors detected in file QBA$APPLY.:E05TSI    .
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:40   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:41   
          MINI XREF LISTING

APPLY_TO_SELECTED_FIELDS
     19485**PROC    19414--CALL    19444--CALL
CHECK_USE_PROCEDURE_OR_INVALID
     19455**LABEL   19318--GOTO    19427--GOTO    19435--GOTO
ERROR_STATUS$ IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19549**DCL     19628<<ASSIGN  19648>>ASSIGN
FIELD_INDEX IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19550**DCL     19561<<DOINDEX
FIELD_START_INDEX
     19122**DCL     19409<<ASSIGN  19438<<ASSIGN  19441>>ASSIGN  19561>>DOINDEX
FIELD_STOP_INDEX
     19123**DCL     19410<<ASSIGN  19439<<ASSIGN  19561>>DOINDEX
FPT@MDFFLD IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19504**DCL     19554<<ASSIGN  19592<>CALL
FPT@MDFFLD.FLDATR_ IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19510**DCL     19557<<ASSIGN
FPT@MDFFLD.KEY_ IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19510**DCL     19588<<ASSIGN
FPT@MDFFLD.V IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19512**DCL     19555--ASSIGN
FPT@MDFFLD.V.DCB# IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19512**DCL     19556<<ASSIGN
FPT@MDFFLD.V_ IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19506**DCL     19555<<ASSIGN
FRAME$
     19124**DCL     19345<<ASSIGN  19385>>ASSIGN
FRAME_INDEX
     19125**DCL     19323<<DOINDEX 19345>>ASSIGN
FRAME_STATUS$
     19126**DCL     19385<<ASSIGN  19405>>IF      19409>>ASSIGN  19410>>ASSIGN  19411>>ASSIGN  19412>>ASSIGN
GZ_FIELD$
     19127**DCL     19412<<ASSIGN  19441<<ASSIGN  19563>>IF      19572>>ASSIGN  19577>>IF      19588>>ASSIGN
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:42   
     19590>>ASSIGN  19654<<ASSIGN  19654>>ASSIGN
GZ_HEADER$
     19128**DCL     19411<<ASSIGN  19440<<ASSIGN  19556>>ASSIGN
INSTR$
     19129**DCL     19257<<ASSIGN  19285>>ASSIGN  19569>>IF      19586>>ASSIGN
LAST_FILE$
     19130**DCL     19260<<ASSIGN  19476<<ASSIGN  19603>>IF      19606<<ASSIGN
NEXT_NODE_PLEASE
     19449**LABEL   19477--GOTO
OPERAND_COUNT
     19120**DCL     19256<<ASSIGN  19258>>ASSIGN  19263>>DOINDEX
OPERAND_INDEX
     19121**DCL     19263<<DOINDEX 19285>>ASSIGN
QCE$ERROR_INTERNAL
     19133**DCL-ENT 19480--CALL
QCE$ERROR_M$INTERNAL IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19552**DCL-ENT 19595--CALL
QCF$FIND_CURRENTS
     19134**DCL-ENT 19306--CALL
QCU$USE_IO
     19135**DCL-ENT 19465--CALL
QCU@USE
     19208**DCL     19465<>CALL
QCU@USE.CURR_FRAME$
     19209**DCL     19457<<ASSIGN
QCU@USE.CURR_NODE$
     19211**DCL     19461<<ASSIGN  19463<<ASSIGN
QCU@USE.IS_TIME_TO_SAVE_AWAY_FIELDS
     19216**DCL     19456<<ASSIGN
QCU@USE.STATUS
     19242**DCL     19467>>DOCASE
QCU@USE.USE_DEFAULT_IO
     19213**DCL     19455<<ASSIGN
QGB$MDFFLD
       367**DCL-ENT 19592--CALL
QGB_PARAM
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:43   
     11490**DCL     19592<>CALL
QGB_PARAM.DVE.DVBYTE.VFC
     11558**DCL     11559--REDEF
QGB_PARAM.DVE.EOMCHAR
     11570**DCL     11571--REDEF
QGB_PARAM.MSG$
     11552**DCL     11553--REDEF
QGB_PARAM.UHDR$
     11577**DCL     11578--REDEF
QI$ACTIVATION_STATUS
      9316**DCL      9322--REDEF
QI$CIP
      8157**DCL      8227--REDEF
QI$CIP.CA
      8162**DCL      8166--REDEF    8169--REDEF    8172--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      8401**DCL      8426--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      8403**DCL      8408--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      8409**DCL      8412--REDEF    8415--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      8437**DCL      8453--REDEF    8461--REDEF    8469--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      8438**DCL      8448--REDEF    8451--REDEF
QI$COBOL_DAD.WORD0
      8365**DCL      8366--REDEF    8380--REDEF
QI$COBOL_DAD_P_BITS.P
      8505**DCL      8511--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      7991**DCL      7992--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
      7987**DCL      7990--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      8024**DCL      8025--REDEF    8026--REDEF
QI$DAD.PSEUDO_CIP
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:44   
      8304**DCL      8329--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      8306**DCL      8311--REDEF
QI$DAD.PSEUDO_CIP.DATA@
      8328**DCL     19288>>ASSIGN
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      8312**DCL      8315--REDEF    8318--REDEF
QI$DAD.WORD0
      8273**DCL      8274--REDEF
QI$DAD.WORD0_FLAGS.INDIRECT
      8275**DCL     19287>>DOWHILE
QI$DAD.WORD0_FLAGS.IS_CONSTANT
      8280**DCL     19288>>ASSIGN
QI$DAD.WORD0_FLAGS.TYPE
      8282**DCL     19308>>IF      19459>>IF
QI$ERROR_MESSAGE_LINE
     11665**DCL     11667--REDEF
QI$ERROR_STATUS
     11662**DCL     11664--REDEF
QI$ERROR_STATUS.TEXT
     11663**DCL     19648<<ASSIGN
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      8719**DCL      8726--REDEF
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      8739**DCL      8746--REDEF
QI$FIELD_DAD.PSEUDO_CIP
      8646**DCL      8671--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      8648**DCL      8653--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      8654**DCL      8657--REDEF    8660--REDEF
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      8759**DCL      8766--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      8702**DCL      8718--REDEF    8736--REDEF    8754--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:45   
      8703**DCL      8713--REDEF    8716--REDEF
QI$FIELD_DAD.VISUAL_ATTRIBUTE
      8700**DCL     19572>>ASSIGN
QI$FIELD_DAD.WORD0
      8598**DCL      8599--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      8602**DCL      8607--REDEF
QI$FIELD_DAD_P.P
      8800**DCL      8807--REDEF
QI$FIELD_STATUS.INDICATORS
      9466**DCL      9498--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
      9470**DCL      9475--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
      9482**DCL      9489--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
      9476**DCL      9481--REDEF
QI$FILE.WORD0
      8922**DCL      8923--REDEF
QI$FILE_STATUS.INDICATORS
      9759**DCL      9791--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
      9763**DCL      9768--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
      9775**DCL      9782--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
      9769**DCL      9774--REDEF
QI$FORM_FILE.ERROR_STATUS@D
      9006**DCL     19628>>ASSIGN
QI$FORM_FILE.FRAME_COUNT
      9001**DCL     19323>>DOINDEX
QI$FORM_FILE.FRAME_LIST_A@P
      9030**DCL     19345>>ASSIGN
QI$FORM_FILE.USE_PROCEDURE
      9022**DCL      9029--REDEF
QI$FORM_FILE.WORD0
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:46   
      8976**DCL      8977--REDEF
QI$FORM_FILE.WORD0_FLAGS.IS_ERROR_STATUS_VALID
      8981**DCL     19600>>IF
QI$FORM_STATUS.INDICATORS
      9880**DCL      9912--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
      9884**DCL      9889--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
      9896**DCL      9903--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_INPUT
      9900**DCL     19313>>IF      19430>>IF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS.IS_OUTPUT
      9897**DCL     19313>>IF      19430>>IF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
      9890**DCL      9895--REDEF
QI$FRAME.STATUS_AREA@D
      9153**DCL     19385>>ASSIGN
QI$FRAME.WORD0
      9137**DCL      9138--REDEF
QI$FRAME_STATUS.GZ.FIELD_START_INDEX
     10062**DCL     19409>>ASSIGN
QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX
     10064**DCL     19410>>ASSIGN
QI$FRAME_STATUS.GZ.HEADER$
     10070**DCL     19411>>ASSIGN  19440>>ASSIGN
QI$FRAME_STATUS.GZ.START$
     10072**DCL     19412>>ASSIGN  19441>>ASSIGN
QI$FRAME_STATUS.INDICATORS
     10109**DCL     10141--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
     10113**DCL     10118--REDEF
QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     10111**DCL     19405>>IF      19423>>IF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     10125**DCL     10132--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:47   
     10119**DCL     10124--REDEF
QI$GZ_FIELD
     16988**DCL     19441--ASSIGN  19654--ASSIGN
QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$
     17012**DCL     19572>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     16991**DCL     16996--REDEF
QI$GZ_FIELD.DESCRIPTION.POSITION
     17007**DCL     19588--ASSIGN
QI$GZ_FIELD.INDICATORS$
     16989**DCL     19563>>IF      19577>>IF
QI$GZ_FIELD.STATUS.VISUAL_ATTRIBUTE
     17027**DCL     19590<<ASSIGN
QI$GZ_HEADER.DCB#
     16945**DCL     19556>>ASSIGN
QI$IDENTIFIER
     11668**DCL     11670--REDEF
QI$INDICATORS
      9380**DCL      9410--REDEF
QI$INDICATORS.ENABLED_FLAGS
      9386**DCL      9391--REDEF
QI$INDICATORS.ENABLED_VALUE
      9391**DCL     19563>>IF
QI$INDICATORS.OPEN_FLAGS
      9398**DCL      9405--REDEF
QI$INDICATORS.OPEN_FLAGS.IS_INPUT
      9402**DCL     19577>>IF
QI$INDICATORS.STATE_FLAGS
      9392**DCL      9397--REDEF
QI$MAJOR_NODE.WORD0
      8836**DCL      8837--REDEF
QI$MAJOR_STATUS.GZ.FIELD_START_INDEX
      9535**DCL     19438>>ASSIGN
QI$MAJOR_STATUS.GZ.FIELD_STOP_INDEX
      9537**DCL     19439>>ASSIGN
QI$MAJOR_STATUS.INDICATORS
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:48   
      9559**DCL      9591--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
      9563**DCL      9568--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
      9575**DCL      9582--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
      9569**DCL      9574--REDEF
QI$MESSAGE_TYPE
     11659**DCL     11661--REDEF
QI$MINOR_NODE.WORD0
      8879**DCL      8880--REDEF
QI$MINOR_STATUS.INDICATORS
      9652**DCL      9684--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
      9656**DCL      9661--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
      9668**DCL      9675--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
      9662**DCL      9667--REDEF
QI$OP_ACCEPT.DATANAME@P
      6067**DCL      6068--REDEF
QI$OP_APPLY.OPERAND_A@P
      6212**DCL     19285>>ASSIGN
QI$OP_APPLY.OPERAND_COUNT
      6211**DCL     19256>>ASSIGN
QI$OP_APPLY.VISUAL_ATTRIBUTE
      6210**DCL     19569>>IF      19586>>ASSIGN
QI$OP_CALL.EPTR$
      6239**DCL      6240--REDEF
QI$OP_CLEAR.IO_FLAGS
      6272**DCL      6275--REDEF
QI$OP_DISPLAY.FIELD_A@P
      6539**DCL      6540--REDEF
QI$OP_ENABLE.IO_FLAGS
      6626**DCL      6629--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:49   
      6719**DCL      6724--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      6953**DCL      6954--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      6955**DCL      6956--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      6951**DCL      6952--REDEF
QI$OP_OPEN.IO_FLAGS
      7513**DCL      7516--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      7551**DCL      7552--REDEF
QI$PSEUDO_CIP
      8052**DCL      8076--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      8056**DCL      8061--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      8062**DCL      8065--REDEF    8068--REDEF
QI$TERMINAL_ATTRIBUTES
      9273**DCL      9286--REDEF
QI$TRAN_FILE.WORD0
      9058**DCL      9059--REDEF
QI$TRAN_STATUS.INDICATORS
      9993**DCL     10025--REDEF
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
      9997**DCL     10002--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     10009**DCL     10016--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     10003**DCL     10008--REDEF
QI$VARIABLE_IDENTIFIER.LENGTH
     11672**DCL     11673--IMP-SIZ
QI_1.BASE
     10201**DCL     10208--REDEF
QI_1.BASE.DATA$
     10202**DCL     19385>>ASSIGN  19628>>ASSIGN
QI_1.BASE.PROC$
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:50   
     10204**DCL     19285>>ASSIGN  19345>>ASSIGN
QI_1.BASE_A$
     10208**DCL     19288>>ASSIGN
QI_1.CURRENT.FILE$
     11092**DCL     11094--REDEF   11096--REDEF
QI_1.CURRENT.FILE_STATUS$
     11098**DCL     11100--REDEF   11102--REDEF
QI_1.CURRENT.FORM$
     11094**DCL     19323>>DOINDEX 19345>>ASSIGN  19600>>IF      19603>>IF      19606>>ASSIGN  19628>>ASSIGN
QI_1.CURRENT.FORM_STATUS$
     11100**DCL     19313>>IF      19313>>IF      19430>>IF      19430>>IF
QI_1.CURRENT.FRAME$
     11104**DCL     19457>>ASSIGN
QI_1.CURRENT.FRAME_STATUS$
     11106**DCL     19423>>IF      19440>>ASSIGN  19441>>ASSIGN
QI_1.CURRENT.NODE$
     11111**DCL     19285<<ASSIGN  19287>>DOWHILE 19288<<ASSIGN  19288>>ASSIGN  19288>>ASSIGN  19308>>IF
     19459>>IF      19461>>ASSIGN
QI_1.CURRENT.NODE_STATUS$
     11113**DCL     19438>>ASSIGN  19439>>ASSIGN
QI_1.DAD
     10896**DCL     10901--REDEF
QI_1.ERROR_STATUS
     11126**DCL     19317<<ASSIGN  19426<<ASSIGN  19434<<ASSIGN
QI_1.FILE_HEAD
     11079**DCL     11086--REDEF
QI_1.INSTR$
     10209**DCL     19256>>ASSIGN  19257>>ASSIGN  19258<<ASSIGN  19258>>ASSIGN
QI_1.IS_ALL_LIT
     10902**DCL     10907--REDEF
QI_1.IS_FORM_VARIABLE
     10908**DCL     10913--REDEF
QI_1.IS_TEMP
     10914**DCL     10919--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     11012**DCL     11037--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:51   
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     11014**DCL     11019--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     11020**DCL     11023--REDEF   11026--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     10981**DCL     10982--REDEF
QI_1.OFFSET
     10920**DCL     10925--REDEF
QI_1.OP.CIP
     10281**DCL     10732--REDEF
QI_1.OP.CIP.AUX
     10647**DCL     10718--REDEF
QI_1.OP.CIP.AUX.CD
     10692**DCL     10695--REDEF   10699--REDEF   10702--REDEF
QI_1.OP.CIP.S
     10351**DCL     10422--REDEF
QI_1.OP.CIP.S.CD
     10396**DCL     10399--REDEF   10403--REDEF   10406--REDEF
QI_1.OP.CIP.T
     10499**DCL     10570--REDEF
QI_1.OP.CIP.T.CD
     10544**DCL     10547--REDEF   10551--REDEF   10554--REDEF
QI_1.OP.DATA
     10739**DCL     10743--REDEF
QI_1.OP.FILL_CHAR
     10863**DCL     10866--REDEF
QI_1.OP.INX
     10796**DCL     10800--REDEF   10801--REDEF   10805--REDEF
QI_1.OP.LEN
     10779**DCL     10783--REDEF   10784--REDEF   10788--REDEF   10789--REDEF   10793--REDEF
QI_1.OP.LEN.AUX
     10782**DCL     11683--IMP-SIZ
QI_1.OP.LEN.S
     10780**DCL     11679--IMP-SIZ
QI_1.OP.LEN.T
     10781**DCL     11681--IMP-SIZ
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:52   
QI_1.OP.PICTURE_STRING
     10849**DCL     10852--REDEF   10853--REDEF   10856--REDEF   10857--REDEF   10860--REDEF
QI_1.OP.ROUND
     10882**DCL     10883--REDEF   10884--REDEF
QI_1.OP.SRCH_VRFY_ELEMS
     10818**DCL     10821--REDEF
QI_1.OPENED_COUNT
     11087**DCL     11090--REDEF
QI_1.OTTER_SPACE
     10926**DCL     10931--REDEF
QI_1.PICTURE_STRING
     10932**DCL     10937--REDEF
QI_1.SCREEN_UPDATE_FLAGS.WAS_APPLIED
     10244**DCL     19598<<ASSIGN
QI_1.SPECIAL_NAMES
     11115**DCL     11124--REDEF
QI_1.TYPE
     10938**DCL     10943--REDEF
QI_16_BIT_BINARY
     16128**DCL     16198--REDEF
QI_16_BIT_BINARY.CB
     16147**DCL     16150--REDEF   16154--REDEF   16157--REDEF
QI_31_DIGIT_SLS_DISPLAY
     15961**DCL     16031--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     16008**DCL     16011--REDEF   16015--REDEF   16018--REDEF
QI_31_DIGIT_ST_PACKED
     16463**DCL     16533--REDEF
QI_31_DIGIT_ST_PACKED.CP
     16496**DCL     16499--REDEF   16503--REDEF   16506--REDEF
QI_32_BIT_BINARY
     16295**DCL     16365--REDEF
QI_32_BIT_BINARY.CB
     16314**DCL     16317--REDEF   16321--REDEF   16324--REDEF
QI_4_CHAR_ALPHANUMERIC
     15793**DCL     15863--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:53   
QI_4_CHAR_ALPHANUMERIC.CA
     15798**DCL     15802--REDEF   15805--REDEF   15808--REDEF
QI_ACCUMULATOR_DAD.CIP
     16806**DCL     16877--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     16837**DCL     16840--REDEF   16844--REDEF   16847--REDEF
QI_ALR.CIP
     11758**DCL     12209--REDEF
QI_ALR.CIP.AUX
     12124**DCL     12195--REDEF
QI_ALR.CIP.AUX.CA
     12127**DCL     12131--REDEF   12134--REDEF   12137--REDEF
QI_ALR.CIP.S
     11828**DCL     11899--REDEF
QI_ALR.CIP.S.CA
     11831**DCL     11835--REDEF   11838--REDEF   11841--REDEF
QI_ALR.CIP.T
     11976**DCL     12047--REDEF
QI_ALR.CIP.T.CA
     11979**DCL     11983--REDEF   11986--REDEF   11989--REDEF
QI_ALR.DATA
     12216**DCL     12220--REDEF
QI_ALR.FILL_CHAR
     12340**DCL     12343--REDEF
QI_ALR.INX
     12273**DCL     12277--REDEF   12278--REDEF   12282--REDEF
QI_ALR.LEN
     12256**DCL     12260--REDEF   12261--REDEF   12265--REDEF   12266--REDEF   12270--REDEF
QI_ALR.PICTURE_STRING
     12326**DCL     12329--REDEF   12330--REDEF   12333--REDEF   12334--REDEF   12337--REDEF
QI_ALR.ROUND
     12359**DCL     12360--REDEF   12361--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     12295**DCL     12298--REDEF
QI_FPT_DBCONTROL.V_
     17178**DCL     17178--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:54   
QI_FPT_INT.V_
     18016**DCL     18016--REDEF
QI_FPT_MDFFLD
     18123**DCL     19554>>ASSIGN
QI_MAT.CIP
     15097**DCL     15548--REDEF
QI_MAT.CIP.AUX
     15463**DCL     15534--REDEF
QI_MAT.CIP.AUX.CA
     15466**DCL     15470--REDEF   15473--REDEF   15476--REDEF
QI_MAT.CIP.S
     15167**DCL     15238--REDEF
QI_MAT.CIP.S.CA
     15170**DCL     15174--REDEF   15177--REDEF   15180--REDEF
QI_MAT.CIP.T
     15315**DCL     15386--REDEF
QI_MAT.CIP.T.CA
     15318**DCL     15322--REDEF   15325--REDEF   15328--REDEF
QI_MAT.DATA
     15555**DCL     15559--REDEF
QI_MAT.DEC
     15623**DCL     15627--REDEF   15628--REDEF   15632--REDEF
QI_MAT.FILL_CHAR
     15679**DCL     15682--REDEF
QI_MAT.LEN
     15595**DCL     15599--REDEF   15600--REDEF   15604--REDEF   15605--REDEF   15609--REDEF
QI_MAT.PICTURE_STRING
     15665**DCL     15668--REDEF   15669--REDEF   15672--REDEF   15673--REDEF   15676--REDEF
QI_MAT.ROUND
     15698**DCL     15699--REDEF   15700--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     15634**DCL     15637--REDEF
QI_PICTURE_STRING
     16631**DCL     16701--REDEF
QI_PICTURE_STRING.CA
     16636**DCL     16640--REDEF   16643--REDEF   16646--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:55   
QI_SRCH_VRFY.CIP
     14428**DCL     14879--REDEF
QI_SRCH_VRFY.CIP.AUX
     14794**DCL     14865--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     14797**DCL     14801--REDEF   14804--REDEF   14807--REDEF
QI_SRCH_VRFY.CIP.S
     14498**DCL     14569--REDEF
QI_SRCH_VRFY.CIP.S.CA
     14501**DCL     14505--REDEF   14508--REDEF   14511--REDEF
QI_SRCH_VRFY.CIP.T
     14646**DCL     14717--REDEF
QI_SRCH_VRFY.CIP.T.CA
     14649**DCL     14653--REDEF   14656--REDEF   14659--REDEF
QI_SRCH_VRFY.DATA
     14886**DCL     14890--REDEF
QI_SRCH_VRFY.DEC
     14954**DCL     14958--REDEF   14959--REDEF   14963--REDEF
QI_SRCH_VRFY.FILL_CHAR
     15010**DCL     15013--REDEF
QI_SRCH_VRFY.ROUND
     15029**DCL     15030--REDEF   15031--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     14970**DCL     14973--REDEF   14974--REDEF   14977--REDEF   14978--REDEF   14981--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     14894**DCL     14898--REDEF   14899--REDEF   14903--REDEF   14904--REDEF   14908--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     14965**DCL     14968--REDEF
QI_TYPE_BINARY_TARGET.CIP
     13755**DCL     14206--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     14121**DCL     14192--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     14124**DCL     14128--REDEF   14131--REDEF   14134--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     13825**DCL     13896--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:56   
QI_TYPE_BINARY_TARGET.CIP.S.CA
     13828**DCL     13832--REDEF   13835--REDEF   13838--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     13973**DCL     14044--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     13990**DCL     13993--REDEF   13997--REDEF   14000--REDEF
QI_TYPE_BINARY_TARGET.DATA
     14213**DCL     14217--REDEF
QI_TYPE_BINARY_TARGET.DEC
     14281**DCL     14285--REDEF   14286--REDEF   14290--REDEF
QI_TYPE_BINARY_TARGET.LEN
     14253**DCL     14257--REDEF   14258--REDEF   14262--REDEF   14263--REDEF   14267--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     14323**DCL     14326--REDEF   14327--REDEF   14330--REDEF   14331--REDEF   14334--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     14356**DCL     14357--REDEF   14358--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     14342**DCL     14343--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     14292**DCL     14295--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     12423**DCL     12874--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     12789**DCL     12860--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     12792**DCL     12796--REDEF   12799--REDEF   12802--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     12493**DCL     12564--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     12538**DCL     12541--REDEF   12545--REDEF   12548--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     12641**DCL     12712--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     12644**DCL     12648--REDEF   12651--REDEF   12654--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     12881**DCL     12885--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:57   
QI_TYPE_DISPLAY_SOURCE.DEC
     12949**DCL     12953--REDEF   12954--REDEF   12958--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     12921**DCL     12925--REDEF   12926--REDEF   12930--REDEF   12931--REDEF   12935--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     12991**DCL     12994--REDEF   12995--REDEF   12998--REDEF   12999--REDEF   13002--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     13024**DCL     13025--REDEF   13026--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     13010**DCL     13011--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     12960**DCL     12963--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     13089**DCL     13540--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     13455**DCL     13526--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     13458**DCL     13462--REDEF   13465--REDEF   13468--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     13159**DCL     13230--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     13162**DCL     13166--REDEF   13169--REDEF   13172--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     13307**DCL     13378--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     13352**DCL     13355--REDEF   13359--REDEF   13362--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     13547**DCL     13551--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     13615**DCL     13619--REDEF   13620--REDEF   13624--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     13587**DCL     13591--REDEF   13592--REDEF   13596--REDEF   13597--REDEF   13601--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     13657**DCL     13660--REDEF   13661--REDEF   13664--REDEF   13665--REDEF   13668--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     13690**DCL     13691--REDEF   13692--REDEF
PL6.E3A0      #001=QBA$APPLY File=QBA$APPLY.:E05TSI                              WED 07/30/97 04:41 Page:58   
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     13676**DCL     13677--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     13626**DCL     13629--REDEF
QI_VLP_FLDATR
     17299**DCL     19558>>ASSIGN
QI_VLP_SEGMENT.BASE
     17715**DCL     17715--REDEF
QI_VLP_SEGMENT_BUFFER.BASE
     17813**DCL     17813--REDEF
QI_VLP_SEGMENT_LOAD.BASE
     17911**DCL     17911--REDEF
QI_VLP_TRMCTL.BREAKCOUNT
     18905**DCL     18906--REDEF
QI_VLP_XBREAK.IC
     19095**DCL     19095--REDEF
QI_VLP_XBREAK.OLDIC
     19095**DCL     19096--REDEF   19096--REDEF
RETRY_NODE_APPLY
     19306**LABEL   19473--GOTO
VISUAL_ATTRIBUTE
     19131**DCL     19572<<ASSIGN  19574>>IF      19580<<ASSIGN  19582<<ASSIGN  19586<<ASSIGN  19589>>ASSIGN
     19590>>ASSIGN
VLP@FLDATR IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19539**DCL     19557--ASSIGN  19558<<ASSIGN
VLP@FLDATR.ABSGRPRND IN PROCEDURE APPLY_TO_SELECTED_FIELDS
     19545**DCL     19589<<ASSIGN
