VERSION E05

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:1    
        1        1        /*M* ASC$SETUP_BANNER - Handle modifications to the SETUP or BANNERTEXT */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: ASC$SETUP_BANNER
        9        9             PURPOSE:
       10       10             NAME: E
       11       11                  To make changes for either the SETUP or BANNERTEXT fields inside the
       12       12                  USERS which is supplied.
       13       13             DESCRIPTION:
       14       14                  One of the 2 entries in this file should be used for all
       15       15                  modifications to SETUP or BANNER (S/B).  These routines will either
       16       16                  add, modify, or remove text in S/B and update the counters and
       17       17                  pointers accordingly.
       18       18             REFERENCE:
       19       19                  These routines are also used by IBEX to maintain S/B.
       20       20        */
       21       21        /*F*
       22       22             NAME: ASC$BANNER
       23       23             PURPOSE:
       24       24                  To handle manipulation of text dealing with the users bannertext
       25       25                  fields inside the bannertext record.
       26       26             DESCRIPTION:
       27       27                  ASC$BANNER is called to insert, remove, or modify bannertext.
       28       28        */
       29       29        /*D*
       30       30             NAME: ASC$BANNER
       31       31             CALL:
       32       32                  None.
       33       33        */
       34       34        /*D*
       35       35             NAME: ASC$BANNER
       36       36             ENTRY:
       37       37                  ASC$BANNER
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:2    
       38       38             CALL:
       39       39                  CALL ASC$BANNER (USER_REC$, MODE, TEXTI) ALTRET (NO_FIT);
       40       40             PARAMETERS:
       41       41                  USER_REC$ -A pointer to a buffer containing the :USER record needing
       42       42                  the banner modified.
       43       43
       44       44                  MODE - says which S/B field to change.  The setup fields are 0 - 3,
       45       45                  and the banner fields are 1 - 9.
       46       46
       47       47                  TEXTI - The text field of varrying length which contains the new
       48       48                  text to go into the mode field of the buffer pointed to by USER_REC$.
       49       49                   This pointer is expected to point to a user record.  If the length
       50       50                  byte (byte 1) of TEXTI is 0, then that field is removed.
       51       51             INTERFACE:
       52       52                  This routine interfaces with both IBEX and SUPER.
       53       53             ENVIRONMENT:
       54       54                  Processor oriented!  This code does not run in the monitor.
       55       55             INPUT:
       56       56                  ALL parameters are input parameters.
       57       57             OUTPUT:
       58       58                  The only output is the buffer pointed to by USER_REC$ is modified.
       59       59             SCRATCH:
       60       60                  The routine will altret if the pool storing the S/B overflows.
       61       61             DESCRIPTION:
       62       62                  The SETUP and BANNERTEXT offsets are placed into an array (called
       63       63                  (odly enough) ARRAY).  The SETUP goes into positions 0-3, and the
       64       64                  BANNERTEXT goes into 4-13.  There is a pool approx 1024 chars large
       65       65                  where the setup and bannertext text are maintained.  They are
       66       66                  maintained in order, 4 setup followed by the 9 bannertext.  When a
       67       67                  new item is supplied, the location of where it is to be inserted is
       68       68                  determined,  the significant characters to the right of where the new
       69       69                  text goes are shifted either right or left to make room fo ar remove
       70       70                  the slack from the new character insertion.  After the new text is
       71       71                  inserted, the offsets which show where each field starts (these were
       72       72                  stored in ARRAY) are modified to reflect the changes caused by the
       73       73                  shift.  The shifting and offset changes are all handled by the SHIFTx
       74       74                  routines, where x is L or R for left or right.
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:3    
       75       75        */
       76       76        ASC$BANNER: PROC (USER_REC$, MODE, TEXTI) ALTRET;
       77       77    1   DCL USER_REC$ PTR ;
       78       78    1   DCL MODE UBIN ;
       79       79    1   DCL 1 TEXTI CALIGNED,
       80       80    1         2 LENGTH_ UBIN(9) UNAL ,
       81       81    1         2 VAL CHAR (TEXTI.LENGTH_) ;
       82       82
       83       83        %INCLUDE  AS_ENTRIES_M;
       84     1133        %SHIFTR ;
       85     1136        %SHIFTL ;
       86     1139        %INCLUDE      AS_SUPER_C ;
       87     1574        %AS_USERS (STCLASS="BASED (USER_REC$)");
       88     1752
       89     1753        %INCLUDE FS_BANNER_C;
       90     1794        %FS$BANNER;
       91     1816
       92     1817        %INCLUDE        CP_6 ;
       93     7376
       94     7377    1   DCL ARRAY (0:13) SBIN HALF;
       95     7378    1   DCL START SBIN WORD ;
       96     7379    1   DCL LEN UBIN WORD ;
       97     7380    1   DCL I SBIN WORD ;
       98     7381    1   DCL J SBIN WORD ;
       99     7382    1   DCL OFF SBIN;
      100     7383    1   DCL OLD_LEN UBIN;
      101     7384    1   DCL NEW_LEN UBIN;
      102     7385    1   DCL INDX UBIN;
      103     7386    1   DCL SIZE UBIN;
      104     7387    1   DCL SHIFT UBIN;
      105     7388
      106     7389    1   INDX = MODE + 4;
      107     7390    1   GOTO COMMON;
      108     7391
      109     7392        /*D*
      110     7393             NAME: ASC$SETUP
      111     7394             ENTRY:
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:4    
      112     7395                  ASC$BANNER
      113     7396             CALL:
      114     7397                  ASC$SETUP (USER_REC$, MODE, TEXTI) ALTRET (NO_SPACE);
      115     7398        */
      116     7399    1   ASC$SETUP: ENTRY (USER_REC$, MODE, TEXTI) ALTRET;
      117     7400    1   INDX = MODE;
      118     7401
      119     7402
      120     7403    1   COMMON: ;
      121     7404
      122     7405    2   DO I = 0 TO 3;
      123     7406    2     ARRAY (I) = AS_USERS.SETUP (I);
      124     7407    2     END;
      125     7408
      126     7409    2   DO I = 4 TO 13;
      127     7410    2     ARRAY (I) = AS_USERS.BANNER (I - 4);
      128     7411    2     END;
      129     7412
      130     7413    1   SIZE = AS_USERS.SETUP_CHRA.SIZE;
      131     7414
      132     7415    2   DO I = (INDX+1) TO 13;
      133     7416    2     IF (ARRAY (I) ~= -1) THEN EXIT;
      134     7417    2     END;
      135     7418
      136     7419    1     IF TEXTI.LENGTH_ = 0
      137     7420    2     THEN DO;
      138     7421    2        IF ARRAY (INDX) = -1 THEN GOTO CLEANUP;
      139     7422    2        OLD_LEN = AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX)) + 1;
      140     7423    2        IF I < 14
      141     7424    3        THEN DO;
      142     7425    3           OFF = ARRAY(I);
      143     7426    3           CALL SHIFTL (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR,OFF,OLD_LEN,SIZE);
      144     7427    3        END;
      145     7428    2        SIZE = SIZE - OLD_LEN;
      146     7429    2        ARRAY (INDX) = -1;
      147     7430    2        GOTO CLEANUP;
      148     7431    2        END;
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:5    
      149     7432
      150     7433    1   IF ( (I >= 14) AND (ARRAY (INDX) = -1) )
      151     7434    2   THEN DO;  /* NOTHING AFTER THIS FIELD NOR IT EXISTS */
      152     7435    2     IF ((SIZE + TEXTI.LENGTH_) > %SETUPMAX) THEN ALTRETURN;
      153     7436    2     ARRAY (INDX) = SIZE;
      154     7437    2     AS_USERS.SETUP_CHRA.TXT_UBIN (SIZE) = TEXTI.LENGTH_;
      155     7438    3     DO I = 1 TO TEXTI.LENGTH_;
      156     7439    3        AS_USERS.SETUP_CHRA.TXT_CHR (SIZE+I) = SUBSTR (TEXTI.VAL,I-1,1);
      157     7440    3        END;
      158     7441    2     SIZE = SIZE + TEXTI.LENGTH_ + 1;
      159     7442    2     END;
      160     7443    1   ELSE IF (I >= 14)
      161     7444    2   THEN DO;  /* CURRENT MODE EXISTS, BUT NONE AFTER IT */
      162     7445    2     OFF = ARRAY(INDX);
      163     7446    2     OLD_LEN = AS_USERS.SETUP_CHRA.TXT_UBIN (OFF);
      164     7447    2     IF ((SIZE + TEXTI.LENGTH_ - OLD_LEN) > %SETUPMAX) THEN ALTRETURN;
      165     7448    2     AS_USERS.SETUP_CHRA.TXT_UBIN (OFF) = TEXTI.LENGTH_;
      166     7449    3     DO I = 1 TO TEXTI.LENGTH_;
      167     7450    3        AS_USERS.SETUP_CHRA.TXT_CHR (OFF+I) = SUBSTR (TEXTI.VAL,I-1,1);
      168     7451    3        END;
      169     7452    2     SIZE = SIZE + TEXTI.LENGTH_ - OLD_LEN;
      170     7453    2     END;
      171     7454
      172     7455        /*  ITEM exists after the MODE one */
      173     7456    1   ELSE IF (ARRAY(INDX) = -1)
      174     7457    2   THEN DO;  /* The one we are putting in doesn't already exist */
      175     7458    2     IF ((SIZE + TEXTI.LENGTH_) > %SETUPMAX) THEN ALTRETURN;
      176     7459    2     SHIFT = TEXTI.LENGTH_ + 1;
      177     7460    2     OFF = ARRAY(I);
      178     7461    2     CALL SHIFTR (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR, OFF, SHIFT, SIZE);
      179     7462    2     ARRAY (INDX) = OFF;
      180     7463    2     AS_USERS.SETUP_CHRA.TXT_UBIN (OFF) = TEXTI.LENGTH_;
      181     7464    3     DO I = 1 TO TEXTI.LENGTH_;
      182     7465    3        AS_USERS.SETUP_CHRA.TXT_CHR (OFF+I) = SUBSTR (TEXTI.VAL,I-1,1);
      183     7466    3        END;
      184     7467    2     SIZE = SIZE + SHIFT;
      185     7468    2     END;
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:6    
      186     7469
      187     7470        /* MODE exists with an item after it */
      188     7471    2   ELSE DO;
      189     7472    2     OLD_LEN = AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX));
      190     7473    2     NEW_LEN = TEXTI.LENGTH_;
      191     7474    2     IF (OLD_LEN > NEW_LEN)
      192     7475    3     THEN DO;  /* NEW FIELD IS SHORTER */
      193     7476    3        SHIFT = OLD_LEN - NEW_LEN;
      194     7477    3        OFF = ARRAY(I);
      195     7478    3        CALL SHIFTL (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR, OFF, SHIFT, SIZE);
      196     7479    3        AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX)) = TEXTI.LENGTH_;
      197     7480    4        DO I = 1 TO TEXTI.LENGTH_;
      198     7481    4           AS_USERS.SETUP_CHRA.TXT_CHR (ARRAY(INDX)+I) = SUBSTR (TEXTI.VAL,I-1,1);
      199     7482    4           END;
      200     7483    3        SIZE = SIZE - SHIFT;
      201     7484    3        END;
      202     7485    2     ELSE IF (OLD_LEN = NEW_LEN)
      203     7486    3     THEN DO;  /* OLD and NEW lengths are = */
      204     7487    4        DO I = 1 TO TEXTI.LENGTH_;
      205     7488    4           AS_USERS.SETUP_CHRA.TXT_CHR (ARRAY(INDX)+I) = SUBSTR (TEXTI.VAL,I-1,1);
      206     7489    4           END;
      207     7490    3        END;
      208     7491    3     ELSE DO;  /* NEW length is longer than the old one */
      209     7492    3        SHIFT = NEW_LEN - OLD_LEN;
      210     7493    3        IF ((SIZE + SHIFT) > %SETUPMAX) THEN ALTRETURN;
      211     7494    3        OFF = ARRAY(I);
      212     7495    3        CALL SHIFTR (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR, OFF, SHIFT, SIZE);
      213     7496    3        AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX)) = TEXTI.LENGTH_;
      214     7497    4        DO I = 1 TO TEXTI.LENGTH_;
      215     7498    4           AS_USERS.SETUP_CHRA.TXT_CHR (ARRAY(INDX)+I) = SUBSTR (TEXTI.VAL,I-1,1);
      216     7499    4           END;
      217     7500    3        SIZE = SIZE + SHIFT;
      218     7501    3        END;
      219     7502    2     END;
      220     7503
      221     7504    1   CLEANUP: ;
      222     7505    2   DO I = 0 TO 3;
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:7    
      223     7506    2     AS_USERS.SETUP (I) = ARRAY (I);
      224     7507    2     END;
      225     7508
      226     7509    2   DO I = 4 TO 13;
      227     7510    2     AS_USERS.BANNER (I - 4) = ARRAY (I);
      228     7511    2     END;
      229     7512
      230     7513    1   AS_USERS.SETUP_CHRA.SIZE = SIZE;
      231     7514
      232     7515    1   RETURN;
      233     7516    1   END ASC$BANNER;

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:8    
--  Include file information  --

   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   FS_BANNER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASC$BANNER.

   Procedure ASC$BANNER requires 485 words for executable code.
   Procedure ASC$BANNER requires 36 words of local(AUTO) storage.

    No errors detected in file ASC$SETUP_BANNER.:E05TSI    .

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:9    

 Object Unit name= ASC$BANNER                                 File name= ASC$SETUP_BANNER.:E05TOU
 UTS= JUL 29 '97 09:44:07.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Proc  even  none   485    745  ASC$BANNER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        3  ASC$BANNER
     1      7          yes     yes      Std        3  ASC$SETUP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 SHIFTL
         yes           Std       5 SHIFTR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B_VECTNIL
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:10   


        1        1        /*M* ASC$SETUP_BANNER - Handle modifications to the SETUP or BANNERTEXT */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*P*
        8        8             NAME: ASC$SETUP_BANNER
        9        9             PURPOSE:
       10       10             NAME: E
       11       11                  To make changes for either the SETUP or BANNERTEXT fields inside the
       12       12                  USERS which is supplied.
       13       13             DESCRIPTION:
       14       14                  One of the 2 entries in this file should be used for all
       15       15                  modifications to SETUP or BANNER (S/B).  These routines will either
       16       16                  add, modify, or remove text in S/B and update the counters and
       17       17                  pointers accordingly.
       18       18             REFERENCE:
       19       19                  These routines are also used by IBEX to maintain S/B.
       20       20        */
       21       21        /*F*
       22       22             NAME: ASC$BANNER
       23       23             PURPOSE:
       24       24                  To handle manipulation of text dealing with the users bannertext
       25       25                  fields inside the bannertext record.
       26       26             DESCRIPTION:
       27       27                  ASC$BANNER is called to insert, remove, or modify bannertext.
       28       28        */
       29       29        /*D*
       30       30             NAME: ASC$BANNER
       31       31             CALL:
       32       32                  None.
       33       33        */
       34       34        /*D*
       35       35             NAME: ASC$BANNER
       36       36             ENTRY:
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:11   
       37       37                  ASC$BANNER
       38       38             CALL:
       39       39                  CALL ASC$BANNER (USER_REC$, MODE, TEXTI) ALTRET (NO_FIT);
       40       40             PARAMETERS:
       41       41                  USER_REC$ -A pointer to a buffer containing the :USER record needing
       42       42                  the banner modified.
       43       43
       44       44                  MODE - says which S/B field to change.  The setup fields are 0 - 3,
       45       45                  and the banner fields are 1 - 9.
       46       46
       47       47                  TEXTI - The text field of varrying length which contains the new
       48       48                  text to go into the mode field of the buffer pointed to by USER_REC$.
       49       49                   This pointer is expected to point to a user record.  If the length
       50       50                  byte (byte 1) of TEXTI is 0, then that field is removed.
       51       51             INTERFACE:
       52       52                  This routine interfaces with both IBEX and SUPER.
       53       53             ENVIRONMENT:
       54       54                  Processor oriented!  This code does not run in the monitor.
       55       55             INPUT:
       56       56                  ALL parameters are input parameters.
       57       57             OUTPUT:
       58       58                  The only output is the buffer pointed to by USER_REC$ is modified.
       59       59             SCRATCH:
       60       60                  The routine will altret if the pool storing the S/B overflows.
       61       61             DESCRIPTION:
       62       62                  The SETUP and BANNERTEXT offsets are placed into an array (called
       63       63                  (odly enough) ARRAY).  The SETUP goes into positions 0-3, and the
       64       64                  BANNERTEXT goes into 4-13.  There is a pool approx 1024 chars large
       65       65                  where the setup and bannertext text are maintained.  They are
       66       66                  maintained in order, 4 setup followed by the 9 bannertext.  When a
       67       67                  new item is supplied, the location of where it is to be inserted is
       68       68                  determined,  the significant characters to the right of where the new
       69       69                  text goes are shifted either right or left to make room fo ar remove
       70       70                  the slack from the new character insertion.  After the new text is
       71       71                  inserted, the offsets which show where each field starts (these were
       72       72                  stored in ARRAY) are modified to reflect the changes caused by the
       73       73                  shift.  The shifting and offset changes are all handled by the SHIFTx
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:12   
       74       74                  routines, where x is L or R for left or right.
       75       75        */
       76       76        ASC$BANNER: PROC (USER_REC$, MODE, TEXTI) ALTRET;

     76  1 000000   000000 700200 xent  ASC$BANNER   TSX0  ! X66_AUTO_3
         1 000001   000044 000003                    ZERO    36,3

       77       77    1   DCL USER_REC$ PTR ;
       78       78    1   DCL MODE UBIN ;
       79       79    1   DCL 1 TEXTI CALIGNED,
       80       80    1         2 LENGTH_ UBIN(9) UNAL ,
       81       81    1         2 VAL CHAR (TEXTI.LENGTH_) ;
       82       82
       83       83        %INCLUDE  AS_ENTRIES_M;
       84     1133        %SHIFTR ;
       85     1136        %SHIFTL ;
       86     1139        %INCLUDE      AS_SUPER_C ;
       87     1574        %AS_USERS (STCLASS="BASED (USER_REC$)");
       88     1752
       89     1753        %INCLUDE FS_BANNER_C;
       90     1794        %FS$BANNER;
       91     1816
       92     1817        %INCLUDE        CP_6 ;
       93     7376
       94     7377    1   DCL ARRAY (0:13) SBIN HALF;
       95     7378    1   DCL START SBIN WORD ;
       96     7379    1   DCL LEN UBIN WORD ;
       97     7380    1   DCL I SBIN WORD ;
       98     7381    1   DCL J SBIN WORD ;
       99     7382    1   DCL OFF SBIN;
      100     7383    1   DCL OLD_LEN UBIN;
      101     7384    1   DCL NEW_LEN UBIN;
      102     7385    1   DCL INDX UBIN;
      103     7386    1   DCL SIZE UBIN;
      104     7387    1   DCL SHIFT UBIN;
      105     7388
      106     7389    1   INDX = MODE + 4;
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:13   

   7389  1 000002   200004 470500                    LDP0    @MODE,,AUTO
         1 000003   000000 235100                    LDA     0,,PR0
         1 000004   000004 035007                    ADLA    4,DL
         1 000005   200033 755100                    STA     INDX,,AUTO

      107     7390    1   GOTO COMMON;

   7390  1 000006   000014 710000 1                  TRA     COMMON

      108     7391
      109     7392        /*D*
      110     7393             NAME: ASC$SETUP
      111     7394             ENTRY:
      112     7395                  ASC$BANNER
      113     7396             CALL:
      114     7397                  ASC$SETUP (USER_REC$, MODE, TEXTI) ALTRET (NO_SPACE);
      115     7398        */
      116     7399    1   ASC$SETUP: ENTRY (USER_REC$, MODE, TEXTI) ALTRET;

   7399  1 000007   000000 700200 xent  ASC$SETUP    TSX0  ! X66_AUTO_3
         1 000010   000044 000003                    ZERO    36,3

      117     7400    1   INDX = MODE;

   7400  1 000011   200004 470500                    LDP0    @MODE,,AUTO
         1 000012   000000 235100                    LDA     0,,PR0
         1 000013   200033 755100                    STA     INDX,,AUTO

   7400  1 000014                       COMMON       null
      118     7401
      119     7402
      120     7403    1   COMMON: ;
      121     7404
      122     7405    2   DO I = 0 TO 3;

   7405  1 000014   200026 450100                    STZ     I,,AUTO
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:14   

      123     7406    2     ARRAY (I) = AS_USERS.SETUP (I);

   7406  1 000015   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000016   000000 471500                    LDP1    0,,PR0
         1 000017   200026 235100                    LDA     I,,AUTO
         1 000020   000001 735000                    ALS     1
         1 000021   200026 236100                    LDQ     I,,AUTO
         1 000022   000002 736000                    QLS     2
         1 000023   000106 100505                    MLR     fill='000'O
         1 000024   100352 000002                    ADSC9   234,A,PR1                cn=0,n=2
         1 000025   200006 000002                    ADSC9   ARRAY,Q,AUTO             cn=0,n=2

      124     7407    2     END;

   7407  1 000026   200026 054100                    AOS     I,,AUTO
         1 000027   200026 235100                    LDA     I,,AUTO
         1 000030   000003 115007                    CMPA    3,DL
         1 000031   000015 604400 1                  TMOZ    s:7406

      125     7408
      126     7409    2   DO I = 4 TO 13;

   7409  1 000032   000004 236007                    LDQ     4,DL
         1 000033   200026 756100                    STQ     I,,AUTO

      127     7410    2     ARRAY (I) = AS_USERS.BANNER (I - 4);

   7410  1 000034   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000035   000000 471500                    LDP1    0,,PR0
         1 000036   200026 235100                    LDA     I,,AUTO
         1 000037   000001 735000                    ALS     1
         1 000040   200026 236100                    LDQ     I,,AUTO
         1 000041   000002 736000                    QLS     2
         1 000042   000106 100505                    MLR     fill='000'O
         1 000043   100352 000002                    ADSC9   234,A,PR1                cn=0,n=2
         1 000044   200006 000002                    ADSC9   ARRAY,Q,AUTO             cn=0,n=2
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:15   

      128     7411    2     END;

   7411  1 000045   200026 054100                    AOS     I,,AUTO
         1 000046   200026 235100                    LDA     I,,AUTO
         1 000047   000015 115007                    CMPA    13,DL
         1 000050   000034 604400 1                  TMOZ    s:7410

      129     7412
      130     7413    1   SIZE = AS_USERS.SETUP_CHRA.SIZE;

   7413  1 000051   000000 471500                    LDP1    0,,PR0
         1 000052   100361 235100                    LDA     241,,PR1
         1 000053   200034 755100                    STA     SIZE,,AUTO

      131     7414
      132     7415    2   DO I = (INDX+1) TO 13;

   7415  1 000054   200033 236100                    LDQ     INDX,,AUTO
         1 000055   000001 036007                    ADLQ    1,DL
         1 000056   200026 756100                    STQ     I,,AUTO
         1 000057   000065 710000 1                  TRA     s:7417+1

      133     7416    2     IF (ARRAY (I) ~= -1) THEN EXIT;

   7416  1 000060   200026 720100                    LXL0    I,,AUTO
         1 000061   200006 221110                    LDX1    ARRAY,X0,AUTO
         1 000062   777777 101003                    CMPX1   -1,DU
         1 000063   000070 601000 1                  TNZ     s:7419

      134     7417    2     END;

   7417  1 000064   200026 054100                    AOS     I,,AUTO
         1 000065   200026 235100                    LDA     I,,AUTO
         1 000066   000015 115007                    CMPA    13,DL
         1 000067   000060 604400 1                  TMOZ    s:7416

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:16   
      135     7418
      136     7419    1     IF TEXTI.LENGTH_ = 0

   7419  1 000070   200005 470500                    LDP0    @TEXTI,,AUTO
         1 000071   000100 101500                    MRL     fill='000'O
         1 000072   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000073   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000074   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000075   000000 116003                    CMPQ    0,DU
         1 000076   000151 601000 1                  TNZ     s:7433

      137     7420    2     THEN DO;

      138     7421    2        IF ARRAY (INDX) = -1 THEN GOTO CLEANUP;

   7421  1 000077   200033 720100                    LXL0    INDX,,AUTO
         1 000100   200006 221110                    LDX1    ARRAY,X0,AUTO
         1 000101   777777 101003                    CMPX1   -1,DU
         1 000102   000704 600000 1                  TZE     CLEANUP

      139     7422    2        OLD_LEN = AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX)) + 1;

   7422  1 000103   200003 471500                    LDP1    @USER_REC$,,AUTO
         1 000104   100000 473500                    LDP3    0,,PR1
         1 000105   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000106   000022 732000                    QRS     18
         1 000107   000100 101506                    MRL     fill='000'O
         1 000110   300362 000001                    ADSC9   242,Q,PR3                cn=0,n=1
         1 000111   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000112   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000113   000001 036007                    ADLQ    1,DL
         1 000114   200031 756100                    STQ     OLD_LEN,,AUTO

      140     7423    2        IF I < 14

   7423  1 000115   200026 235100                    LDA     I,,AUTO
         1 000116   000016 115007                    CMPA    14,DL
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:17   
         1 000117   000142 605000 1                  TPL     s:7428

      141     7424    3        THEN DO;

      142     7425    3           OFF = ARRAY(I);

   7425  1 000120   200006 236105                    LDQ     ARRAY,AL,AUTO
         1 000121   000022 732000                    QRS     18
         1 000122   200030 756100                    STQ     OFF,,AUTO

      143     7426    3           CALL SHIFTL (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR,OFF,OLD_LEN,SIZE);

   7426  1 000123   100000 473500                    LDP3    0,,PR1
         1 000124   200034 634500                    EPPR4   SIZE,,AUTO
         1 000125   200042 454500                    STP4    SHIFT+5,,AUTO
         1 000126   200031 635500                    EPPR5   OLD_LEN,,AUTO
         1 000127   200041 455500                    STP5    SHIFT+4,,AUTO
         1 000130   200030 636500                    EPPR6   OFF,,AUTO
         1 000131   200040 456500                    STP6    SHIFT+3,,AUTO
         1 000132   300362 637500                    EPPR7   242,,PR3
         1 000133   200037 457500                    STP7    SHIFT+2,,AUTO
         1 000134   200006 633500                    EPPR3   ARRAY,,AUTO
         1 000135   200036 453500                    STP3    SHIFT+1,,AUTO
         1 000136   200036 630500                    EPPR0   SHIFT+1,,AUTO
         1 000137   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000140   000000 701000 xent               TSX1    SHIFTL
         1 000141   000000 011000                    NOP     0

      144     7427    3        END;

      145     7428    2        SIZE = SIZE - OLD_LEN;

   7428  1 000142   200034 236100                    LDQ     SIZE,,AUTO
         1 000143   200031 136100                    SBLQ    OLD_LEN,,AUTO
         1 000144   200034 756100                    STQ     SIZE,,AUTO

      146     7429    2        ARRAY (INDX) = -1;
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:18   

   7429  1 000145   777777 220003                    LDX0    -1,DU
         1 000146   200033 721100                    LXL1    INDX,,AUTO
         1 000147   200006 740111                    STX0    ARRAY,X1,AUTO

      147     7430    2        GOTO CLEANUP;

   7430  1 000150   000704 710000 1                  TRA     CLEANUP

      148     7431    2        END;
      149     7432
      150     7433    1   IF ( (I >= 14) AND (ARRAY (INDX) = -1) )

   7433  1 000151   200026 235100                    LDA     I,,AUTO
         1 000152   000016 115007                    CMPA    14,DL
         1 000153   000240 604000 1                  TMI     s:7443
         1 000154   200033 720100                    LXL0    INDX,,AUTO
         1 000155   200006 221110                    LDX1    ARRAY,X0,AUTO
         1 000156   777777 101003                    CMPX1   -1,DU
         1 000157   000240 601000 1                  TNZ     s:7443

      151     7434    2   THEN DO;  /* NOTHING AFTER THIS FIELD NOR IT EXISTS */

      152     7435    2     IF ((SIZE + TEXTI.LENGTH_) > %SETUPMAX) THEN ALTRETURN;

   7435  1 000160   000100 101500                    MRL     fill='000'O
         1 000161   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000162   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000163   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000164   200034 036100                    ADLQ    SIZE,,AUTO
         1 000165   002001 116007                    CMPQ    1025,DL
         1 000166   000170 602000 1                  TNC     s:7436

   7435  1 000167   000000 702200 xent               TSX2  ! X66_AALT

      153     7436    2     ARRAY (INDX) = SIZE;

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:19   
   7436  1 000170   200034 721100                    LXL1    SIZE,,AUTO
         1 000171   200006 741110                    STX1    ARRAY,X0,AUTO

      154     7437    2     AS_USERS.SETUP_CHRA.TXT_UBIN (SIZE) = TEXTI.LENGTH_;

   7437  1 000172   200003 471500                    LDP1    @USER_REC$,,AUTO
         1 000173   100000 473500                    LDP3    0,,PR1
         1 000174   200034 236100                    LDQ     SIZE,,AUTO
         1 000175   000106 100500                    MLR     fill='000'O
         1 000176   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000177   300362 000001                    ADSC9   242,Q,PR3                cn=0,n=1

      155     7438    3     DO I = 1 TO TEXTI.LENGTH_;

   7438  1 000200   000001 236007                    LDQ     1,DL
         1 000201   200026 756100                    STQ     I,,AUTO
         1 000202   000221 710000 1                  TRA     s:7440+1

      156     7439    3        AS_USERS.SETUP_CHRA.TXT_CHR (SIZE+I) = SUBSTR (TEXTI.VAL,I-1,1);

   7439  1 000203   200034 236100                    LDQ     SIZE,,AUTO
         1 000204   200026 036100                    ADLQ    I,,AUTO
         1 000205   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000206   000000 471500                    LDP1    0,,PR0
         1 000207   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000210   000100 101500                    MRL     fill='000'O
         1 000211   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000212   200036 000002                    ADSC9   SHIFT+1,,AUTO            cn=0,n=2
         1 000213   200036 220100                    LDX0    SHIFT+1,,AUTO
         1 000214   200026 235100                    LDA     I,,AUTO
         1 000215   040106 100505                    MLR     fill='040'O
         1 000216   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         1 000217   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1

      157     7440    3        END;

   7440  1 000220   200026 054100                    AOS     I,,AUTO
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:20   
         1 000221   200005 470500                    LDP0    @TEXTI,,AUTO
         1 000222   000100 101500                    MRL     fill='000'O
         1 000223   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000224   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000225   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000226   200026 116100                    CMPQ    I,,AUTO
         1 000227   000203 605000 1                  TPL     s:7439

      158     7441    2     SIZE = SIZE + TEXTI.LENGTH_ + 1;

   7441  1 000230   000100 101500                    MRL     fill='000'O
         1 000231   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000232   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000233   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000234   200034 036100                    ADLQ    SIZE,,AUTO
         1 000235   000001 036007                    ADLQ    1,DL
         1 000236   200034 756100                    STQ     SIZE,,AUTO

      159     7442    2     END;

   7442  1 000237   000704 710000 1                  TRA     CLEANUP

      160     7443    1   ELSE IF (I >= 14)

   7443  1 000240   000016 115007                    CMPA    14,DL
         1 000241   000331 604000 1                  TMI     s:7456

      161     7444    2   THEN DO;  /* CURRENT MODE EXISTS, BUT NONE AFTER IT */

      162     7445    2     OFF = ARRAY(INDX);

   7445  1 000242   200033 720100                    LXL0    INDX,,AUTO
         1 000243   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000244   000022 732000                    QRS     18
         1 000245   200030 756100                    STQ     OFF,,AUTO

      163     7446    2     OLD_LEN = AS_USERS.SETUP_CHRA.TXT_UBIN (OFF);
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:21   

   7446  1 000246   200003 471500                    LDP1    @USER_REC$,,AUTO
         1 000247   100000 473500                    LDP3    0,,PR1
         1 000250   000100 101506                    MRL     fill='000'O
         1 000251   300362 000001                    ADSC9   242,Q,PR3                cn=0,n=1
         1 000252   200031 000004                    ADSC9   OLD_LEN,,AUTO            cn=0,n=4

      164     7447    2     IF ((SIZE + TEXTI.LENGTH_ - OLD_LEN) > %SETUPMAX) THEN ALTRETURN;

   7447  1 000253   000100 101500                    MRL     fill='000'O
         1 000254   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000255   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000256   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000257   200034 036100                    ADLQ    SIZE,,AUTO
         1 000260   200031 136100                    SBLQ    OLD_LEN,,AUTO
         1 000261   002000 116007                    CMPQ    1024,DL
         1 000262   000264 604400 1                  TMOZ    s:7448

   7447  1 000263   000000 702200 xent               TSX2  ! X66_AALT

      165     7448    2     AS_USERS.SETUP_CHRA.TXT_UBIN (OFF) = TEXTI.LENGTH_;

   7448  1 000264   100000 473500                    LDP3    0,,PR1
         1 000265   200030 236100                    LDQ     OFF,,AUTO
         1 000266   000106 100500                    MLR     fill='000'O
         1 000267   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000270   300362 000001                    ADSC9   242,Q,PR3                cn=0,n=1

      166     7449    3     DO I = 1 TO TEXTI.LENGTH_;

   7449  1 000271   000001 236007                    LDQ     1,DL
         1 000272   200026 756100                    STQ     I,,AUTO
         1 000273   000312 710000 1                  TRA     s:7451+1

      167     7450    3        AS_USERS.SETUP_CHRA.TXT_CHR (OFF+I) = SUBSTR (TEXTI.VAL,I-1,1);

   7450  1 000274   200030 236100                    LDQ     OFF,,AUTO
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:22   
         1 000275   200026 036100                    ADLQ    I,,AUTO
         1 000276   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000277   000000 471500                    LDP1    0,,PR0
         1 000300   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000301   000100 101500                    MRL     fill='000'O
         1 000302   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000303   200036 000002                    ADSC9   SHIFT+1,,AUTO            cn=0,n=2
         1 000304   200036 220100                    LDX0    SHIFT+1,,AUTO
         1 000305   200026 235100                    LDA     I,,AUTO
         1 000306   040106 100505                    MLR     fill='040'O
         1 000307   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         1 000310   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1

      168     7451    3        END;

   7451  1 000311   200026 054100                    AOS     I,,AUTO
         1 000312   200005 470500                    LDP0    @TEXTI,,AUTO
         1 000313   000100 101500                    MRL     fill='000'O
         1 000314   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000315   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000316   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000317   200026 116100                    CMPQ    I,,AUTO
         1 000320   000274 605000 1                  TPL     s:7450

      169     7452    2     SIZE = SIZE + TEXTI.LENGTH_ - OLD_LEN;

   7452  1 000321   000100 101500                    MRL     fill='000'O
         1 000322   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000323   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000324   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000325   200034 036100                    ADLQ    SIZE,,AUTO
         1 000326   200031 136100                    SBLQ    OLD_LEN,,AUTO
         1 000327   200034 756100                    STQ     SIZE,,AUTO

      170     7453    2     END;

   7453  1 000330   000704 710000 1                  TRA     CLEANUP
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:23   

      171     7454
      172     7455        /*  ITEM exists after the MODE one */
      173     7456    1   ELSE IF (ARRAY(INDX) = -1)

   7456  1 000331   200033 720100                    LXL0    INDX,,AUTO
         1 000332   200006 221110                    LDX1    ARRAY,X0,AUTO
         1 000333   777777 101003                    CMPX1   -1,DU
         1 000334   000443 601000 1                  TNZ     s:7472

      174     7457    2   THEN DO;  /* The one we are putting in doesn't already exist */

      175     7458    2     IF ((SIZE + TEXTI.LENGTH_) > %SETUPMAX) THEN ALTRETURN;

   7458  1 000335   000100 101500                    MRL     fill='000'O
         1 000336   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000337   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000340   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000341   200034 036100                    ADLQ    SIZE,,AUTO
         1 000342   002001 116007                    CMPQ    1025,DL
         1 000343   000345 602000 1                  TNC     s:7459

   7458  1 000344   000000 702200 xent               TSX2  ! X66_AALT

      176     7459    2     SHIFT = TEXTI.LENGTH_ + 1;

   7459  1 000345   000100 101500                    MRL     fill='000'O
         1 000346   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000347   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000350   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000351   000001 036007                    ADLQ    1,DL
         1 000352   200035 756100                    STQ     SHIFT,,AUTO

      177     7460    2     OFF = ARRAY(I);

   7460  1 000353   200006 236105                    LDQ     ARRAY,AL,AUTO
         1 000354   000022 732000                    QRS     18
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:24   
         1 000355   200030 756100                    STQ     OFF,,AUTO

      178     7461    2     CALL SHIFTR (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR, OFF, SHIFT, SIZE);

   7461  1 000356   200003 471500                    LDP1    @USER_REC$,,AUTO
         1 000357   100000 473500                    LDP3    0,,PR1
         1 000360   200034 634500                    EPPR4   SIZE,,AUTO
         1 000361   200042 454500                    STP4    SHIFT+5,,AUTO
         1 000362   200035 635500                    EPPR5   SHIFT,,AUTO
         1 000363   200041 455500                    STP5    SHIFT+4,,AUTO
         1 000364   200030 636500                    EPPR6   OFF,,AUTO
         1 000365   200040 456500                    STP6    SHIFT+3,,AUTO
         1 000366   300362 637500                    EPPR7   242,,PR3
         1 000367   200037 457500                    STP7    SHIFT+2,,AUTO
         1 000370   200006 633500                    EPPR3   ARRAY,,AUTO
         1 000371   200036 453500                    STP3    SHIFT+1,,AUTO
         1 000372   200036 630500                    EPPR0   SHIFT+1,,AUTO
         1 000373   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000374   000000 701000 xent               TSX1    SHIFTR
         1 000375   000000 011000                    NOP     0

      179     7462    2     ARRAY (INDX) = OFF;

   7462  1 000376   200030 720100                    LXL0    OFF,,AUTO
         1 000377   200033 721100                    LXL1    INDX,,AUTO
         1 000400   200006 740111                    STX0    ARRAY,X1,AUTO

      180     7463    2     AS_USERS.SETUP_CHRA.TXT_UBIN (OFF) = TEXTI.LENGTH_;

   7463  1 000401   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000402   000000 471500                    LDP1    0,,PR0
         1 000403   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000404   200030 235100                    LDA     OFF,,AUTO
         1 000405   000105 100500                    MLR     fill='000'O
         1 000406   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000407   100362 000001                    ADSC9   242,A,PR1                cn=0,n=1

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:25   
      181     7464    3     DO I = 1 TO TEXTI.LENGTH_;

   7464  1 000410   000001 235007                    LDA     1,DL
         1 000411   200026 755100                    STA     I,,AUTO
         1 000412   000431 710000 1                  TRA     s:7466+1

      182     7465    3        AS_USERS.SETUP_CHRA.TXT_CHR (OFF+I) = SUBSTR (TEXTI.VAL,I-1,1);

   7465  1 000413   200030 236100                    LDQ     OFF,,AUTO
         1 000414   200026 036100                    ADLQ    I,,AUTO
         1 000415   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000416   000000 471500                    LDP1    0,,PR0
         1 000417   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000420   000100 101500                    MRL     fill='000'O
         1 000421   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000422   200036 000002                    ADSC9   SHIFT+1,,AUTO            cn=0,n=2
         1 000423   200036 220100                    LDX0    SHIFT+1,,AUTO
         1 000424   200026 235100                    LDA     I,,AUTO
         1 000425   040106 100505                    MLR     fill='040'O
         1 000426   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         1 000427   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1

      183     7466    3        END;

   7466  1 000430   200026 054100                    AOS     I,,AUTO
         1 000431   000100 101500                    MRL     fill='000'O
         1 000432   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000433   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000434   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000435   200026 116100                    CMPQ    I,,AUTO
         1 000436   000413 605000 1                  TPL     s:7465

      184     7467    2     SIZE = SIZE + SHIFT;

   7467  1 000437   200034 236100                    LDQ     SIZE,,AUTO
         1 000440   200035 036100                    ADLQ    SHIFT,,AUTO
         1 000441   200034 756100                    STQ     SIZE,,AUTO
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:26   

      185     7468    2     END;

   7468  1 000442   000704 710000 1                  TRA     CLEANUP

      186     7469
      187     7470        /* MODE exists with an item after it */
      188     7471    2   ELSE DO;

      189     7472    2     OLD_LEN = AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX));

   7472  1 000443   200003 471500                    LDP1    @USER_REC$,,AUTO
         1 000444   100000 473500                    LDP3    0,,PR1
         1 000445   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000446   000022 732000                    QRS     18
         1 000447   000100 101506                    MRL     fill='000'O
         1 000450   300362 000001                    ADSC9   242,Q,PR3                cn=0,n=1
         1 000451   200031 000004                    ADSC9   OLD_LEN,,AUTO            cn=0,n=4

      190     7473    2     NEW_LEN = TEXTI.LENGTH_;

   7473  1 000452   000100 101500                    MRL     fill='000'O
         1 000453   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000454   200032 000004                    ADSC9   NEW_LEN,,AUTO            cn=0,n=4

      191     7474    2     IF (OLD_LEN > NEW_LEN)

   7474  1 000455   200032 236100                    LDQ     NEW_LEN,,AUTO
         1 000456   200031 116100                    CMPQ    OLD_LEN,,AUTO
         1 000457   000553 603000 1                  TRC     s:7485

      192     7475    3     THEN DO;  /* NEW FIELD IS SHORTER */

      193     7476    3        SHIFT = OLD_LEN - NEW_LEN;

   7476  1 000460   200031 236100                    LDQ     OLD_LEN,,AUTO
         1 000461   200032 136100                    SBLQ    NEW_LEN,,AUTO
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:27   
         1 000462   200035 756100                    STQ     SHIFT,,AUTO

      194     7477    3        OFF = ARRAY(I);

   7477  1 000463   200006 236105                    LDQ     ARRAY,AL,AUTO
         1 000464   000022 732000                    QRS     18
         1 000465   200030 756100                    STQ     OFF,,AUTO

      195     7478    3        CALL SHIFTL (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR, OFF, SHIFT, SIZE);

   7478  1 000466   100000 473500                    LDP3    0,,PR1
         1 000467   200034 634500                    EPPR4   SIZE,,AUTO
         1 000470   200042 454500                    STP4    SHIFT+5,,AUTO
         1 000471   200035 635500                    EPPR5   SHIFT,,AUTO
         1 000472   200041 455500                    STP5    SHIFT+4,,AUTO
         1 000473   200030 636500                    EPPR6   OFF,,AUTO
         1 000474   200040 456500                    STP6    SHIFT+3,,AUTO
         1 000475   300362 637500                    EPPR7   242,,PR3
         1 000476   200037 457500                    STP7    SHIFT+2,,AUTO
         1 000477   200006 633500                    EPPR3   ARRAY,,AUTO
         1 000500   200036 453500                    STP3    SHIFT+1,,AUTO
         1 000501   200036 630500                    EPPR0   SHIFT+1,,AUTO
         1 000502   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000503   000000 701000 xent               TSX1    SHIFTL
         1 000504   000000 011000                    NOP     0

      196     7479    3        AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX)) = TEXTI.LENGTH_;

   7479  1 000505   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000506   000000 471500                    LDP1    0,,PR0
         1 000507   200033 720100                    LXL0    INDX,,AUTO
         1 000510   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000511   000022 732000                    QRS     18
         1 000512   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000513   000106 100500                    MLR     fill='000'O
         1 000514   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000515   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:28   

      197     7480    4        DO I = 1 TO TEXTI.LENGTH_;

   7480  1 000516   000001 235007                    LDA     1,DL
         1 000517   200026 755100                    STA     I,,AUTO
         1 000520   000541 710000 1                  TRA     s:7482+1

      198     7481    4           AS_USERS.SETUP_CHRA.TXT_CHR (ARRAY(INDX)+I) = SUBSTR (TEXTI.VAL,I-1,1);

   7481  1 000521   200033 720100                    LXL0    INDX,,AUTO
         1 000522   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000523   000022 732000                    QRS     18
         1 000524   200026 036100                    ADLQ    I,,AUTO
         1 000525   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000526   000000 471500                    LDP1    0,,PR0
         1 000527   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000530   000100 101500                    MRL     fill='000'O
         1 000531   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000532   200036 000002                    ADSC9   SHIFT+1,,AUTO            cn=0,n=2
         1 000533   200036 221100                    LDX1    SHIFT+1,,AUTO
         1 000534   200026 235100                    LDA     I,,AUTO
         1 000535   040106 100505                    MLR     fill='040'O
         1 000536   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         1 000537   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1

      199     7482    4           END;

   7482  1 000540   200026 054100                    AOS     I,,AUTO
         1 000541   000100 101500                    MRL     fill='000'O
         1 000542   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000543   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000544   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000545   200026 116100                    CMPQ    I,,AUTO
         1 000546   000521 605000 1                  TPL     s:7481

      200     7483    3        SIZE = SIZE - SHIFT;

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:29   
   7483  1 000547   200034 236100                    LDQ     SIZE,,AUTO
         1 000550   200035 136100                    SBLQ    SHIFT,,AUTO
         1 000551   200034 756100                    STQ     SIZE,,AUTO

      201     7484    3        END;

   7484  1 000552   000704 710000 1                  TRA     CLEANUP

      202     7485    2     ELSE IF (OLD_LEN = NEW_LEN)

   7485  1 000553   000607 601000 1                  TNZ     s:7492

      203     7486    3     THEN DO;  /* OLD and NEW lengths are = */

      204     7487    4        DO I = 1 TO TEXTI.LENGTH_;

   7487  1 000554   000001 235007                    LDA     1,DL
         1 000555   200026 755100                    STA     I,,AUTO
         1 000556   000577 710000 1                  TRA     s:7489+1

      205     7488    4           AS_USERS.SETUP_CHRA.TXT_CHR (ARRAY(INDX)+I) = SUBSTR (TEXTI.VAL,I-1,1);

   7488  1 000557   200033 720100                    LXL0    INDX,,AUTO
         1 000560   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000561   000022 732000                    QRS     18
         1 000562   200026 036100                    ADLQ    I,,AUTO
         1 000563   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000564   000000 471500                    LDP1    0,,PR0
         1 000565   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000566   000100 101500                    MRL     fill='000'O
         1 000567   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000570   200036 000002                    ADSC9   SHIFT+1,,AUTO            cn=0,n=2
         1 000571   200036 221100                    LDX1    SHIFT+1,,AUTO
         1 000572   200026 235100                    LDA     I,,AUTO
         1 000573   040106 100505                    MLR     fill='040'O
         1 000574   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         1 000575   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:30   

      206     7489    4           END;

   7489  1 000576   200026 054100                    AOS     I,,AUTO
         1 000577   200005 470500                    LDP0    @TEXTI,,AUTO
         1 000600   000100 101500                    MRL     fill='000'O
         1 000601   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         1 000602   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000603   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000604   200026 116100                    CMPQ    I,,AUTO
         1 000605   000557 605000 1                  TPL     s:7488

      207     7490    3        END;

   7490  1 000606   000704 710000 1                  TRA     CLEANUP

      208     7491    3     ELSE DO;  /* NEW length is longer than the old one */

      209     7492    3        SHIFT = NEW_LEN - OLD_LEN;

   7492  1 000607   200031 136100                    SBLQ    OLD_LEN,,AUTO
         1 000610   200035 756100                    STQ     SHIFT,,AUTO

      210     7493    3        IF ((SIZE + SHIFT) > %SETUPMAX) THEN ALTRETURN;

   7493  1 000611   200034 036100                    ADLQ    SIZE,,AUTO
         1 000612   002001 116007                    CMPQ    1025,DL
         1 000613   000615 602000 1                  TNC     s:7494

   7493  1 000614   000000 702200 xent               TSX2  ! X66_AALT

      211     7494    3        OFF = ARRAY(I);

   7494  1 000615   200006 236105                    LDQ     ARRAY,AL,AUTO
         1 000616   000022 732000                    QRS     18
         1 000617   200030 756100                    STQ     OFF,,AUTO

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:31   
      212     7495    3        CALL SHIFTR (ARRAY, AS_USERS.SETUP_CHRA.TXT_CHR, OFF, SHIFT, SIZE);

   7495  1 000620   100000 473500                    LDP3    0,,PR1
         1 000621   200034 634500                    EPPR4   SIZE,,AUTO
         1 000622   200042 454500                    STP4    SHIFT+5,,AUTO
         1 000623   200035 635500                    EPPR5   SHIFT,,AUTO
         1 000624   200041 455500                    STP5    SHIFT+4,,AUTO
         1 000625   200030 636500                    EPPR6   OFF,,AUTO
         1 000626   200040 456500                    STP6    SHIFT+3,,AUTO
         1 000627   300362 637500                    EPPR7   242,,PR3
         1 000630   200037 457500                    STP7    SHIFT+2,,AUTO
         1 000631   200006 633500                    EPPR3   ARRAY,,AUTO
         1 000632   200036 453500                    STP3    SHIFT+1,,AUTO
         1 000633   200036 630500                    EPPR0   SHIFT+1,,AUTO
         1 000634   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 000635   000000 701000 xent               TSX1    SHIFTR
         1 000636   000000 011000                    NOP     0

      213     7496    3        AS_USERS.SETUP_CHRA.TXT_UBIN (ARRAY(INDX)) = TEXTI.LENGTH_;

   7496  1 000637   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000640   000000 471500                    LDP1    0,,PR0
         1 000641   200033 720100                    LXL0    INDX,,AUTO
         1 000642   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000643   000022 732000                    QRS     18
         1 000644   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000645   000106 100500                    MLR     fill='000'O
         1 000646   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000647   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1

      214     7497    4        DO I = 1 TO TEXTI.LENGTH_;

   7497  1 000650   000001 235007                    LDA     1,DL
         1 000651   200026 755100                    STA     I,,AUTO
         1 000652   000673 710000 1                  TRA     s:7499+1

      215     7498    4           AS_USERS.SETUP_CHRA.TXT_CHR (ARRAY(INDX)+I) = SUBSTR (TEXTI.VAL,I-1,1);
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:32   

   7498  1 000653   200033 720100                    LXL0    INDX,,AUTO
         1 000654   200006 236110                    LDQ     ARRAY,X0,AUTO
         1 000655   000022 732000                    QRS     18
         1 000656   200026 036100                    ADLQ    I,,AUTO
         1 000657   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000660   000000 471500                    LDP1    0,,PR0
         1 000661   200005 473500                    LDP3    @TEXTI,,AUTO
         1 000662   000100 101500                    MRL     fill='000'O
         1 000663   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000664   200036 000002                    ADSC9   SHIFT+1,,AUTO            cn=0,n=2
         1 000665   200036 221100                    LDX1    SHIFT+1,,AUTO
         1 000666   200026 235100                    LDA     I,,AUTO
         1 000667   040106 100505                    MLR     fill='040'O
         1 000670   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1
         1 000671   100362 000001                    ADSC9   242,Q,PR1                cn=0,n=1

      216     7499    4           END;

   7499  1 000672   200026 054100                    AOS     I,,AUTO
         1 000673   000100 101500                    MRL     fill='000'O
         1 000674   300000 000001                    ADSC9   0,,PR3                   cn=0,n=1
         1 000675   200036 000004                    ADSC9   SHIFT+1,,AUTO            cn=0,n=4
         1 000676   200036 236100                    LDQ     SHIFT+1,,AUTO
         1 000677   200026 116100                    CMPQ    I,,AUTO
         1 000700   000653 605000 1                  TPL     s:7498

      217     7500    3        SIZE = SIZE + SHIFT;

   7500  1 000701   200034 236100                    LDQ     SIZE,,AUTO
         1 000702   200035 036100                    ADLQ    SHIFT,,AUTO
         1 000703   200034 756100                    STQ     SIZE,,AUTO

      218     7501    3        END;

      219     7502    2     END;

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:33   
   7500  1 000704                       CLEANUP      null
      220     7503
      221     7504    1   CLEANUP: ;
      222     7505    2   DO I = 0 TO 3;

   7505  1 000704   200026 450100                    STZ     I,,AUTO

      223     7506    2     AS_USERS.SETUP (I) = ARRAY (I);

   7506  1 000705   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000706   000000 471500                    LDP1    0,,PR0
         1 000707   200026 235100                    LDA     I,,AUTO
         1 000710   000002 735000                    ALS     2
         1 000711   200026 236100                    LDQ     I,,AUTO
         1 000712   000001 736000                    QLS     1
         1 000713   000106 100505                    MLR     fill='000'O
         1 000714   200006 000002                    ADSC9   ARRAY,A,AUTO             cn=0,n=2
         1 000715   100352 000002                    ADSC9   234,Q,PR1                cn=0,n=2

      224     7507    2     END;

   7507  1 000716   200026 054100                    AOS     I,,AUTO
         1 000717   200026 235100                    LDA     I,,AUTO
         1 000720   000003 115007                    CMPA    3,DL
         1 000721   000705 604400 1                  TMOZ    s:7506

      225     7508
      226     7509    2   DO I = 4 TO 13;

   7509  1 000722   000004 236007                    LDQ     4,DL
         1 000723   200026 756100                    STQ     I,,AUTO

      227     7510    2     AS_USERS.BANNER (I - 4) = ARRAY (I);

   7510  1 000724   200003 470500                    LDP0    @USER_REC$,,AUTO
         1 000725   000000 471500                    LDP1    0,,PR0
         1 000726   200026 235100                    LDA     I,,AUTO
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:34   
         1 000727   000002 735000                    ALS     2
         1 000730   200026 236100                    LDQ     I,,AUTO
         1 000731   000001 736000                    QLS     1
         1 000732   000106 100505                    MLR     fill='000'O
         1 000733   200006 000002                    ADSC9   ARRAY,A,AUTO             cn=0,n=2
         1 000734   100352 000002                    ADSC9   234,Q,PR1                cn=0,n=2

      228     7511    2     END;

   7511  1 000735   200026 054100                    AOS     I,,AUTO
         1 000736   200026 235100                    LDA     I,,AUTO
         1 000737   000015 115007                    CMPA    13,DL
         1 000740   000724 604400 1                  TMOZ    s:7510

      229     7512
      230     7513    1   AS_USERS.SETUP_CHRA.SIZE = SIZE;

   7513  1 000741   000000 471500                    LDP1    0,,PR0
         1 000742   200034 236100                    LDQ     SIZE,,AUTO
         1 000743   100361 756100                    STQ     241,,PR1

      231     7514
      232     7515    1   RETURN;

   7515  1 000744   000000 702200 xent               TSX2  ! X66_ARET
      233     7516    1   END ASC$BANNER;

PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:35   
--  Include file information  --

   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   FS_BANNER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASC$BANNER.
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:36   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @MODE                      5-0-0/w PTR         r     1 @TEXTI
     3-0-0/w PTR         r     1 @USER_REC$                 6-0-0/w SBIN(18)    r     1 ARRAY(0:13)
    26-0-0/w SBIN        r     1 I                         33-0-0/w UBIN        r     1 INDX
    *0-0-0/w UBIN        r     1 MODE                      32-0-0/w UBIN        r     1 NEW_LEN
    30-0-0/w SBIN        r     1 OFF                       31-0-0/w UBIN        r     1 OLD_LEN
    35-0-0/w UBIN        r     1 SHIFT                     34-0-0/w UBIN        r     1 SIZE
    *0-0-0/c ASTR(9)     r     1 TEXTI                     *0-0-0/w PTR         r     1 USER_REC$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(18576) r     1 AS_USERS                   0-0-0/c ASTR(9)     r     1 TEXT


   Procedure ASC$BANNER requires 485 words for executable code.
   Procedure ASC$BANNER requires 36 words of local(AUTO) storage.

    No errors detected in file ASC$SETUP_BANNER.:E05TSI    .
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:37   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:38   
          MINI XREF LISTING

ARRAY
      7377**DCL      7406<<ASSIGN   7410<<ASSIGN   7416>>IF       7421>>IF       7422>>ASSIGN   7425>>ASSIGN
      7426<>CALL     7429<<ASSIGN   7433>>IF       7436<<ASSIGN   7445>>ASSIGN   7456>>IF       7460>>ASSIGN
      7461<>CALL     7462<<ASSIGN   7472>>ASSIGN   7477>>ASSIGN   7478<>CALL     7479>>ASSIGN   7481>>ASSIGN
      7488>>ASSIGN   7494>>ASSIGN   7495<>CALL     7496>>ASSIGN   7498>>ASSIGN   7506>>ASSIGN   7510>>ASSIGN
AS_USERS.BANNER
      1715**DCL      7410>>ASSIGN   7510<<ASSIGN
AS_USERS.BANNER_PERM
      1702**DCL      1703--REDEF
AS_USERS.BUDGET.MACCT
      1607**DCL      1611--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
      1620**DCL      1623--REDEF
AS_USERS.BUDGET.PACCUM
      1603**DCL      1605--REDEF
AS_USERS.BUDGET.PMAXC
      1598**DCL      1600--REDEF
AS_USERS.SETUP
      1714**DCL      7406>>ASSIGN   7506<<ASSIGN
AS_USERS.SETUP_CHRA.SIZE
      1717**DCL      7413>>ASSIGN   7513<<ASSIGN
AS_USERS.SETUP_CHRA.TXT
      1718**DCL      1719--REDEF    1720--REDEF
AS_USERS.SETUP_CHRA.TXT_CHR
      1719**DCL      7426<>CALL     7439<<ASSIGN   7450<<ASSIGN   7461<>CALL     7465<<ASSIGN   7478<>CALL
      7481<<ASSIGN   7488<<ASSIGN   7495<>CALL     7498<<ASSIGN
AS_USERS.SETUP_CHRA.TXT_UBIN
      1720**DCL      7422>>ASSIGN   7437<<ASSIGN   7446>>ASSIGN   7448<<ASSIGN   7463<<ASSIGN   7472>>ASSIGN
      7479<<ASSIGN   7496<<ASSIGN
CLEANUP
      7500**LABEL    7421--GOTO     7430--GOTO
COMMON
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:39   
      7400**LABEL    7390--GOTO
FS$BANNER.PERM
      1806**DCL      1807--REDEF
I
      7380**DCL      7405<<DOINDEX  7406>>ASSIGN   7406>>ASSIGN   7409<<DOINDEX  7410>>ASSIGN   7410>>ASSIGN
      7415<<DOINDEX  7416>>IF       7423>>IF       7425>>ASSIGN   7433>>IF       7438<<DOINDEX  7439>>ASSIGN
      7439>>ASSIGN   7443>>IF       7449<<DOINDEX  7450>>ASSIGN   7450>>ASSIGN   7460>>ASSIGN   7464<<DOINDEX
      7465>>ASSIGN   7465>>ASSIGN   7477>>ASSIGN   7480<<DOINDEX  7481>>ASSIGN   7481>>ASSIGN   7487<<DOINDEX
      7488>>ASSIGN   7488>>ASSIGN   7494>>ASSIGN   7497<<DOINDEX  7498>>ASSIGN   7498>>ASSIGN   7505<<DOINDEX
      7506>>ASSIGN   7506>>ASSIGN   7509<<DOINDEX  7510>>ASSIGN   7510>>ASSIGN
INDX
      7385**DCL      7389<<ASSIGN   7400<<ASSIGN   7415>>DOINDEX  7421>>IF       7422>>ASSIGN   7429>>ASSIGN
      7433>>IF       7436>>ASSIGN   7445>>ASSIGN   7456>>IF       7462>>ASSIGN   7472>>ASSIGN   7479>>ASSIGN
      7481>>ASSIGN   7488>>ASSIGN   7496>>ASSIGN   7498>>ASSIGN
MODE
        78**DCL        76--PROC     7389>>ASSIGN   7399--ENTRY    7400>>ASSIGN
NEW_LEN
      7384**DCL      7473<<ASSIGN   7474>>IF       7476>>ASSIGN   7485>>IF       7492>>ASSIGN
OFF
      7382**DCL      7425<<ASSIGN   7426<>CALL     7445<<ASSIGN   7446>>ASSIGN   7448>>ASSIGN   7450>>ASSIGN
      7460<<ASSIGN   7461<>CALL     7462>>ASSIGN   7463>>ASSIGN   7465>>ASSIGN   7477<<ASSIGN   7478<>CALL
      7494<<ASSIGN   7495<>CALL
OLD_LEN
      7383**DCL      7422<<ASSIGN   7426<>CALL     7428>>ASSIGN   7446<<ASSIGN   7447>>IF       7452>>ASSIGN
      7472<<ASSIGN   7474>>IF       7476>>ASSIGN   7485>>IF       7492>>ASSIGN
SHIFT
      7387**DCL      7459<<ASSIGN   7461<>CALL     7467>>ASSIGN   7476<<ASSIGN   7478<>CALL     7483>>ASSIGN
      7492<<ASSIGN   7493>>IF       7495<>CALL     7500>>ASSIGN
SHIFTL
      1137**DCL-ENT  7426--CALL     7478--CALL
SHIFTR
      1134**DCL-ENT  7461--CALL     7495--CALL
SIZE
      7386**DCL      7413<<ASSIGN   7426<>CALL     7428<<ASSIGN   7428>>ASSIGN   7435>>IF       7436>>ASSIGN
      7437>>ASSIGN   7439>>ASSIGN   7441<<ASSIGN   7441>>ASSIGN   7447>>IF       7452<<ASSIGN   7452>>ASSIGN
      7458>>IF       7461<>CALL     7467<<ASSIGN   7467>>ASSIGN   7478<>CALL     7483<<ASSIGN   7483>>ASSIGN
PL6.E3A0      #001=ASC$BANNER File=ASC$SETUP_BANNER.:E05TSI                      TUE 07/29/97 09:44 Page:40   
      7493>>IF       7495<>CALL     7500<<ASSIGN   7500>>ASSIGN   7513>>ASSIGN
TEXT.LENGTH_
      1813**DCL      1814--IMP-SIZ
TEXTI
        79**DCL        76--PROC     7399--ENTRY
TEXTI.LENGTH_
        80**DCL        81--IMP-SIZ  7419>>IF       7435>>IF       7437>>ASSIGN   7438>>DOINDEX  7439>>ASSIGN
      7441>>ASSIGN   7447>>IF       7448>>ASSIGN   7449>>DOINDEX  7450>>ASSIGN   7452>>ASSIGN   7458>>IF
      7459>>ASSIGN   7463>>ASSIGN   7464>>DOINDEX  7465>>ASSIGN   7473>>ASSIGN   7479>>ASSIGN   7480>>DOINDEX
      7481>>ASSIGN   7487>>DOINDEX  7488>>ASSIGN   7496>>ASSIGN   7497>>DOINDEX  7498>>ASSIGN
TEXTI.VAL
        81**DCL      7439>>ASSIGN   7450>>ASSIGN   7465>>ASSIGN   7481>>ASSIGN   7488>>ASSIGN   7498>>ASSIGN
USER_REC$
        77**DCL        76--PROC     1587--IMP-PTR  7399--ENTRY    7406>>ASSIGN   7410>>ASSIGN   7413>>ASSIGN
      7422>>ASSIGN   7426>>CALL     7437>>ASSIGN   7439>>ASSIGN   7446>>ASSIGN   7448>>ASSIGN   7450>>ASSIGN
      7461>>CALL     7463>>ASSIGN   7465>>ASSIGN   7472>>ASSIGN   7478>>CALL     7479>>ASSIGN   7481>>ASSIGN
      7488>>ASSIGN   7495>>CALL     7496>>ASSIGN   7498>>ASSIGN   7506>>ASSIGN   7510>>ASSIGN   7513>>ASSIGN
