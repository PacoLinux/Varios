VERSION E05

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:1    
        1        1        /*M* KCP$PMMES COMGROUP-specific PMMES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KCP$PMME
       10       10             PURPOSE:      To provide initial handling for comgroup-specific
       11       11                           PMMEs.
       12       12        */
       13       13        /**/
       14       14        KCP$PMME: PROC (FPTCODE) ALTRET;
       15       15        /**/
       16       16
       17       17
       18       18
       19       19        /**/
       20       20        /* INCLUDES */
       21       21        /**/
       22       22        %INCLUDE KQ_SUBS_C;
       23      322        %INCLUDE KQ_MAC_C;
       24     2872        %INCLUDE HF_LOCK_C;
       25     2886        %INCLUDE KQ_DATA_R;
       26     3718        %INCLUDE CP_6_SUBS;
       27     4258        %INCLUDE KC$CP6V_C;
       28     4378        %INCLUDE B$JIT_C;
       29     4692        %INCLUDE UD_SEV_C;
       30     4706        %INCLUDE KQ_ERRORS_C;
       31     4754        %INCLUDE KC_ERRORS_C;
       32     4801        %INCLUDE UD_ERRORS_C;
       33     4843        %INCLUDE KC_CP6;
       34     5403        %INCLUDE K_DATA_R;
       35     6114        %INCLUDE NK$LDCT;
       36     6216        %INCLUDE UD_EQU_E;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:2    
       37     6605        %INCLUDE NK_SUBS;
       38     6630        %INCLUDE F$DCB;
       39     6679        %INCLUDE NK_LDCT_R;
       40     6688        %INCLUDE KL_SUPER_C;
       41     9590
       42     9591
       43     9592
       44     9593        /**/
       45     9594        /* PARAMETERS */
       46     9595        /**/
       47     9596    1   DCL FPTCODE UBIN;
       48     9597
       49     9598
       50     9599
       51     9600        /**/
       52     9601        /* MACROS */
       53     9602        /**/
       54     9603        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       55     9604        DCL 1 NAME CONSTANT ALIGNED,
       56     9605              2 * BIT(18) UNAL INIT('130320'O),
       57     9606              2 * UBIN(15) UNAL INIT(CODE),
       58     9607              2 * UBIN(3) UNAL INIT(SEV);
       59     9608        %MEND;
       60     9609
       61     9610
       62     9611
       63     9612        /**/
       64     9613        /* BASED STRUCTURES */
       65     9614        /**/
       66     9615        %NK$LDCT (STCLASS="BASED(LDCT$)");
       67     9661        %KQ_CG   (FPTN=KQ$CG  ,STCLASS="BASED(CG$)");
       68    10400        %KQ_STA  (FPTN=KQ$STA ,STCLASS="BASED(STA$)");
       69    10739        %KQ_THDR (FPTN=KQ$THDR,STCLASS=BASED);
       70    10777        %FPT$UNLATCH_V  (FPTN=FPT$UNLATCH   ,BASED="BASED(B$PS0$)");
       71    10781        %FPT$ACTIVATE_V (FPTN=FPT$ACTIVATE  ,BASED="BASED(B$PS0$)");
       72    10787        %VLP$STATION_V  (FPTN=VLP$STATION   ,BASED="BASED(B$PS1$)");
       73    10799        %B$JIT0;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:3    
       74    10888        %U$JIT1X;
       75    10891        %M$JIT2X;
       76    10894        %F$JIT3;
       77    10899        %A$JIT6X;
       78    10902
       79    10903
       80    10904
       81    10905        /**/
       82    10906        /* AUTO */
       83    10907        /**/
       84    10908    1   DCL CG$ PTR;
       85    10909    1   DCL LDCT$ PTR;
       86    10910    1   DCL STA$ PTR;
       87    10911        %FPT$UNLATCH_V (FPTN=UFPT,BASED=AUTO);
       88    10915    1   DCL DCB$ PTR;
       89    10916        %FPT$ACTIVATE_V (FPTN=AFPT,BASED=AUTO);
       90    10922        %VLP$STATION_V (FPTN=VSTA,BASED=AUTO);
       91    10934
       92    10935
       93    10936
       94    10937        /**/
       95    10938        /* CONSTANT */
       96    10939        /**/
       97    10940        %$ERROR (NAME=E_NOTCG ,CODE=%E$NOTCG );
       98    10946        %$ERROR (NAME=E_NOTAU ,CODE=%E$NOTAU );
       99    10952        %$ERROR (NAME=E_NOTACT ,CODE=%E$NOTACT );
      100    10958        %$ERROR (NAME=E_NOSTA ,CODE=%E$CGAFNS,SEV=SEV_CONT#);
      101    10964        %$ERROR (NAME=E_BSYMA ,CODE=%E$BSYMA );
      102    10970        %$ERROR (NAME=E_NDSCL ,CODE=%E$NDSCL ,SEV=SEV_CONT#);
      103    10976        %$ERROR (NAME=E_NOAURD,CODE=%E$NOAURD);
      104    10982        %$ERROR (NAME=E_CGNWDR,CODE=%E$CGNWDR);
      105    10988        %$ERROR (NAME=E_NACTV ,CODE=%E$NACTV );
      106    10994
      107    10995        /**/
      108    10996        /* REFS */
      109    10997        /**/
      110    10998    1   DCL FRA$CGCON     ENTRY(3) ALTRET;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:4    
      111    10999    1   DCL HFF$NILERASE  ENTRY(1) ALTRET;
      112    11000    1   DCL HFF$TRAPALT   ENTRY(1) ALTRET;
      113    11001    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      114    11002    1   DCL KCD$PFPRG ENTRY(2) ALTRET;         /* Make a pure FPRG station */
      115    11003    1   DCL KCD$TFPRG ENTRY(1) ALTRET;         /* Make a transformed FPRG station */
      116    11004    1   DCL KCO$DSCTRMGO  ENTRY(1);
      117    11005    1   DCL KIS$OSI_ATTACH ENTRY ALTRET;
      118    11006    1   DCL KIS$OSI_DETACH ENTRY ALTRET;
      119    11007    1   DCL KQB$SRCH      ENTRY(3) ALTRET;
      120    11008    1   DCL KQC$ACTSTA    ENTRY(2) ALTRET;
      121    11009    1   DCL KQC$CGCTL     ENTRY(2) ALTRET;
      122    11010    1   DCL KQC$DACTSTA   ENTRY(2) ALTRET;
      123    11011    1   DCL KQC$DISCSTA   ENTRY(2) ALTRET;
      124    11012    1   DCL KQF$FWCG      ENTRY(1) ALTRET;
      125    11013    1   DCL KQI$CGINFO    ENTRY(1) ALTRET;
      126    11014    1   DCL KQP$UNLOCK    ENTRY(1) ALTRET;
      127    11015    1   DCL KQU$UNLATCH   ENTRY(3) ALTRET;
      128    11016    1   DCL KQX$LDASR     ENTRY(1);
      129    11017    1   DCL UDB$PMMEXIT   ENTRY;
      130    11018    1   DCL B$PS0$ PTR SYMREF READONLY;
      131    11019    1   DCL B$PS1$ PTR SYMREF READONLY;
      132    11020    1   DCL B$PS2$ PTR SYMREF READONLY;
      133    11021    1   DCL B$JIT$ PTR SYMREF;
      134    11022
      135    11023
      136    11024
      137    11025        /**/
      138    11026        /* SUBS */
      139    11027        /**/
      140    11028        %SUB KQ$QTREE="CG$->KQ$CG.QUEUE.QTREE$->KQ$THDR";
      141    11029        %SUB KQ$TTREE="CG$->KQ$CG.TTREE";
      142    11030        %SUB KQ$STREE="CG$->KQ$CG.STREE";
      143    11031        %EQU_CG;
      144    11079        %EJECT;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:5    
      145    11080        /**/
      146    11081    2           DO CASE (FPTCODE);
      147    11082
      148    11083    2             CASE (%C$FWCG#);
      149    11084    2               CALL AURDSET;
      150    11085    2               CALL KQF$FWCG (STA$) ALTRET(NOTAU);
      151    11086
      152    11087    2             CASE (%C$CGCTL#);
      153    11088    2               CALL AUSET;
      154    11089    2               CALL KQC$CGCTL (STA$);
      155    11090
      156    11091    2             CASE (%C$CGINFO#);
      157    11092    2               CALL AURDSET;
      158    11093    2               CALL KQI$CGINFO (CG$->KQ$CG);
      159    11094
      160    11095    2             CASE (%C$ACTIVATE#);
      161    11096    2               CALL ACTSET;
      162    11097    2               CALL ACTIVATE;
      163    11098
      164    11099    2             CASE (%C$DEACTIVATE#);
      165    11100    2               CALL ACTSET;
      166    11101    2               CALL DEACTIVATE;
      167    11102
      168    11103    2             CASE (%C$UNLATCH#);
      169    11104    2               CALL USET;
      170    11105                           /* Copy V area now so that if
      171    11106                            * it's bad, we trap now and
      172    11107                            * not in KQU$UNLATCH
      173    11108                            */
      174    11109    2               UFPT=FPT$UNLATCH;
      175    11110    2               CALL KQU$UNLATCH (STA$->KQ$STA,UFPT,B$JIT$->B$JIT.ERR);
      176    11111
      177    11112    2             CASE (%C$ATTACH#);
      178    11113    2               CALL AUSET;
      179    11114    2               CALL KIS$OSI_ATTACH
      180    11115    3               WHENALTRETURN DO;
      181    11116                      /* B$JIT.ERR has been filled in.  Just RETURN */
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:6    
      182    11117    3                 END;
      183    11118
      184    11119    2             CASE (%C$DETACH#);
      185    11120    2               CALL AUSET;
      186    11121    2               CALL KIS$OSI_DETACH
      187    11122    3               WHENALTRETURN DO;
      188    11123                      /* B$JIT.ERR has been filled in.  Just RETURN */
      189    11124    3                 END;
      190    11125
      191    11126    2           END; /*CASE FPTCODE*/
      192    11127    1         RETURN;
      193    11128        /**/
      194    11129    1   NOTAU:;
      195    11130    1         B$JIT$->B$JIT.ERR=E_NOTAU;
      196    11131    1         RETURN;
      197    11132        %EJECT;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:7    
      198    11133        /****************************************************************
      199    11134        *****************************************************************/
      200    11135        /*D* NAME:         USET
      201    11136             PURPOSE:      To validate the DCB passed
      202    11137             DESCRIPTION:  Ensures it's a comgroup DCB.  Returns the
      203    11138                           LDCT$ and STA$ of the user's station, and
      204    11139                           also CG$ pointing to the CG context block.
      205    11140                           Loads the comgroup ASR to allow us to see
      206    11141                           the comgroup. */
      207    11142    1   USET: PROC;
      208    11143        /**/
      209    11144    2         DCB$=B$JIT$->B$JIT.DCB$;
      210    11145    2         IF DCB$->F$DCB.FCD = '0'B THEN GOTO NOTCG;
      211    11146    2         IF DCB$->F$DCB.IASN=%STREAM#
      212    11147    3         THEN DO;
      213    11148    3           DCB$=DCB$->F$DCB.CFU$;
      214    11149    3           B$JIT$->B$JIT.DCB$=DCB$;
      215    11150    3           END;
      216    11151    2         IF DCB$->F$DCB.ASN ~= %COMGROUP# THEN
      217    11152    3           DO;
      218    11153    3   NOTCG:  B$JIT$->B$JIT.ERR=E_NOTCG;
      219    11154        /*E* ERROR:   KCP-E$NOTCG-E
      220    11155             MESSAGE: That DCB% (%DC)% is not open to comgroup.
      221    11156             MESSAGE1: The DCB specified in your service request is required
      222    11157                       to be open to a comgroup, but is not.
      223    11158             DESCRIPTION: The comgroup-specific PMMEs all require a DCB open
      224    11159                          to comgroup. */
      225    11160    3           CALL UDB$PMMEXIT;
      226    11161    3           END;
      227    11162    2         LDCT$=NK$LDCT$(DCB$->F$DCB.LDCTX);
      228    11163    2         STA$=LDCT$->NK$LDCT.STA$;
      229    11164    2         CG$=LDCT$->NK$LDCT.CG$;
      230    11165    2         CALL KQX$LDASR (CG$->KQ$CG);
      231    11166    2         RETURN;
      232    11167    2   END USET;
      233    11168        /****************************************************************
      234    11169        *****************************************************************/
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:8    
      235    11170        /*D* NAME:         AURDSET
      236    11171             PURPOSE:      To set up for AU read-access functions
      237    11172             DESCRIPTION:  Calls USET.  Then ensures the user has AURD
      238    11173                           access to the comgroup.
      239    11174        */
      240    11175    1   AURDSET: PROC;
      241    11176        /**/
      242    11177    2         CALL USET;
      243    11178    2         IF NOT ( DCB$->F$DCB.FFLG.AU | DCB$->F$DCB.FFLG.AURD) THEN
      244    11179    3           DO;
      245    11180    3           B$JIT$->B$JIT.ERR=E_NOAURD;
      246    11181        /*E* ERROR:   KCP-E$NOAURD-E
      247    11182             MESSAGE: You require AU or AURD access to get comgroup information
      248    11183             MESSAGE1: You issued a comgroup informational service request
      249    11184                       but do not have AU or AURD access to the comgroup. */
      250    11185    3           CALL UDB$PMMEXIT;
      251    11186    3           END;
      252    11187    2         RETURN;
      253    11188    2   END AURDSET;
      254    11189        /****************************************************************
      255    11190        *****************************************************************/
      256    11191        /*D* NAME:         AUSET
      257    11192             PURPOSE:      To set up for AU-only functions
      258    11193             DESCRIPTION:  Calls USET.  Then ensures the user has AU
      259    11194                           access to the comgroup.
      260    11195        */
      261    11196    1   AUSET: PROC ALTRET;
      262    11197        /**/
      263    11198    2         CALL USET;
      264    11199    2         IF DCB$->F$DCB.AU = '0'B THEN
      265    11200    3           DO;
      266    11201    3           B$JIT$->B$JIT.ERR=E_NOTAU;
      267    11202        /*E* ERROR:   KCP-E$NOTAU-E
      268    11203             MESSAGE: Only the administrative user may control the comgroup
      269    11204             MESSAGE1: You issued a comgroup control service request, the
      270    11205                       use of which is restricted to the administrative user.
      271    11206                       You are not he.
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:9    
      272    11207             DESCRIPTION: Only the AU may issued the comgroup control
      273    11208                          service requests. */
      274    11209    3           CALL UDB$PMMEXIT;
      275    11210    3           END;
      276    11211    2         RETURN;
      277    11212    2   END AUSET;
      278    11213        /****************************************************************
      279    11214        *****************************************************************/
      280    11215        /*D* NAME:         ACTSET
      281    11216             PURPOSE:      To set up for ACTIVATE and DEACTIVATE
      282    11217             DESCRIPTION:  Calls USET.  Then ensures the user has AU
      283    11218                           or TCTL access to the comgroup.
      284    11219        */
      285    11220    1   ACTSET: PROC ALTRET;
      286    11221        /**/
      287    11222    2         CALL USET;
      288    11223    2         IF DCB$->F$DCB.AU = '0'B AND DCB$->F$DCB.FFLG.TCTL = '0'B
      289    11224    3         THEN DO;
      290    11225    3           B$JIT$->B$JIT.ERR=E_NOTACT;
      291    11226        /*E* ERROR:   KCP-E$NOTACT-E
      292    11227             MESSAGE: Only the AU or a DCB with TCTL permissions are
      293    11228                      allowed to ACTIVATE or DEACTIVATE terminals.
      294    11229             MESSAGE1: You issued an ACTIVATE or DEACTIVATE request, the
      295    11230                       use of which is restricted to the AU or TCTL DCB's.
      296    11231                       You are not one of them.
      297    11232             DESCRIPTION: Only the AU or a DCB with TCTL permissions are
      298    11233                          allowed to ACTIVATE and DEACTIVATE terminals. */
      299    11234    3           CALL UDB$PMMEXIT;
      300    11235    3           END;
      301    11236    2         RETURN;
      302    11237    2   END ACTSET;
      303    11238        %EJECT;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:10   
      304    11239        /****************************************************************
      305    11240        *****************************************************************/
      306    11241        /*D* NAME:         ACTIVATE
      307    11242             PURPOSE:      To process the M$ACTIVATE PMME
      308    11243             INPUT:        LDCT$, STA$ point to the user's station
      309    11244                                     The user is the AU or a TCTL DCB.
      310    11245                           CG$ points to the comgroup.
      311    11246             DESCRIPTION:  The specified station(s) is(are) activated.
      312    11247        */
      313    11248    1   ACTIVATE: PROC;
      314    11249        /**/
      315    11250    2   DCL ACT BIT(36);
      316    11251    2   DCL KEY CHAR(8);
      317    11252    2   DCL KEYR REDEF KEY BIT(72);
      318    11253    2   DCL KEYL UBIN;
      319    11254    2   DCL FOUND SBIN;
      320    11255    2   DCL JITERR BIT(36) ALIGNED;
      321    11256    2   DCL ACTCNT UBIN;
      322    11257    2   DCL B$$CHARS CHAR(KEYL) BASED CALIGNED;
      323    11258        /**/
      324    11259
      325    11260         /* If we are connect a resource do it and then return */
      326    11261    2         IF FPT$ACTIVATE.CONNECTRES
      327    11262    3         THEN DO;
      328    11263    3           CALL FRA$CGCON(FPT$ACTIVATE.RES,FPT$ACTIVATE.ATTR,KQ$CG);
      329    11264    3           RETURN;
      330    11265    3           END;
      331    11266    2         ACT='1'B;
      332    11267    2         GOTO ACT0;
      333    11268        /**/
      334    11269        /*D* NAME:         DEACTIVATE
      335    11270             PURPOSE:      To process the M$DEACTIVATE PMME
      336    11271             INPUT:        Same as ACTIVATE
      337    11272             DESCRIPTION:  The specified station(s) is(are) deactivated
      338    11273                           as specified by the FPT
      339    11274        */
      340    11275    2   DEACTIVATE: ENTRY;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:11   
      341    11276        /**/
      342    11277    2         ACT='0'B;
      343    11278    2   ACT0: AFPT=FPT$ACTIVATE;
      344    11279    2         VSTA.STATION=VLP$STATION.STATION;
      345    11280    2         KEYR='0'B;
      346    11281    2         CALL INDEX (KEYL,'?',VSTA.STATION);
      347    11282    2         IF KEYL ~= 8 THEN VSTA=VLP$STATION;
      348    11283    2         ADDR(KEY)->B$$CHARS=ADDR(VSTA.STATION)->B$$CHARS;
      349    11284    2         FOUND=0;
      350    11285              %LOCK (G=KQ$STREE.GATE);
      351    11288    2   SRCH: CALL KQB$SRCH (KQ$STREE,KEY,STA$);
      352    11289    3           DO FOREVER;
      353    11290    3           IF STA$ = ADDR(NIL) THEN GOTO DONE;
      354    11291    3           IF ADDR(STA$->KQ$STA.BTN.KEY)->B$$CHARS > ADDR(VSTA.STATION)->B$$CHARS THEN
      355    11292    3            GOTO DONE;
      356    11293    3           ELSE IF ADDR(STA$->KQ$STA.BTN.KEY)->B$$CHARS = ADDR(VSTA.STATION)->B$$CHARS
             11293                    THEN
      357    11294    4              DO;
      358    11295    4              IF SUBSTR(STA$->KQ$STA.BTN.KEY,0,1) ~= '*' THEN
      359    11296    4               IF FOUND = 0
      360    11297    4               OR KEY ~= STA$->KQ$STA.BTN.KEY THEN GOTO GOT1;
      361    11298    4              END;
      362    11299    3   NXT:    STA$=STA$->KQ$STA.BTN.FLINK$;
      363    11300    3           END;
      364    11301    2   GOT1: ACTCNT=KQ$STREE.ACTCNT;
      365    11302    2         KEY=STA$->KQ$STA.BTN.KEY;
      366    11303              %LOCK (G=STA$->KQ$STA.GATE);
      367    11306    2         LDCT$=STA$->KQ$STA.LDCT$;
      368    11307    2         IF ACT THEN
      369    11308    3           DO;
      370    11309                          /*    M$ACTIVATE
      371    11310                           *
      372    11311                           *
      373    11312                           */
      374    11313    3           CALL SYMBCHK ALTRET(UNXT);
      375    11314    3           IF LDCT$ = ADDR(NIL)
      376    11315    3           OR STA$->KQ$STA.IDSC THEN
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:12   
      377    11316    4   UNXT:     DO;
      378    11317                  %UNLOCK (G=STA$->KQ$STA.GATE);
      379    11320    4             GOTO NXT;
      380    11321    4             END;
      381    11322    3           IF KEYL ~= 8 THEN
      382    11323    3            IF STA$->KQ$STA.TERM THEN
      383    11324    4              DO;
      384    11325    4              IF NOT VSTA.CTL.ALLTRMS THEN
      385    11326    4               IF NOT VSTA.CTL.ALLDCBS THEN
      386    11327    5                 DO;
      387    11328    5                 IF FOUND ~= 0 THEN
      388    11329    6   UDONE:          DO;
      389    11330                        %UNLOCK (G=STA$->KQ$STA.GATE);
      390    11333    6                   GOTO DONE;
      391    11334    6                   END;
      392    11335    5                 END;
      393    11336    4               ELSE GOTO UNXT;
      394    11337    4              END;
      395    11338    3            ELSE /* DCB */
      396    11339    4              DO;
      397    11340    4              IF DCB$->F$DCB.AU = '0'B THEN
      398    11341    5                DO;
      399    11342    5                FOUND=6;
      400    11343    5                GOTO UDONE;
      401    11344    5                END;
      402    11345    4              IF NOT VSTA.CTL.ALLDCBS THEN
      403    11346    4               IF NOT VSTA.CTL.ALLTRMS THEN
      404    11347    5                 DO;
      405    11348    5                 IF FOUND ~= 0 THEN GOTO UDONE;
      406    11349    5                 END;
      407    11350    4               ELSE GOTO UNXT;
      408    11351    4              END;
      409    11352    3           IF FOUND <= 0 THEN FOUND=FOUND-1;
      410    11353    3           STA$->KQ$STA.LOCKCNT=STA$->KQ$STA.LOCKCNT+1;
      411    11354    3           IF AFPT.MINRD = 0 THEN GOTO NOMIN;
      412    11355    3           STA$->KQ$STA.MINRD = MAXIMUM(2,AFPT.MINRD);
      413    11356    3   NOMIN:  IF AFPT.MAXRD = 0 THEN GOTO NOMAX;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:13   
      414    11357    3           STA$->KQ$STA.MAXRD = MAXIMUM(3,AFPT.MAXRD);
      415    11358    3   NOMAX:  ;
      416    11359                %UNLOCK (G=STA$->KQ$STA.GATE);
      417    11362                %UNLOCK (G=KQ$STREE.GATE);
      418    11365    3           IF AFPT.MAKEFPRG='1'B AND LDCT$->NK$LDCT.RESCOD=NK_CGTRM
      419    11366    3           AND LDCT$->NK$LDCT.TERMID.TTYP ~= %KLTY_PROG#
      420    11367    4           THEN DO;
      421    11368    4             STA$->KQ$STA.USEAUACCT = AFPT.USEAUACCT;
      422    11369    4             IF KEYL ~= 8 AND VSTA.CTL.ALLTRMS='1'B
      423    11370    4             THEN
      424    11371    4   TRANSFORM: CALL KCD$TFPRG(STA$->KQ$STA)
      425    11372    5              WHENALTRETURN DO;
      426    11373    5   JERR:        FOUND=5; /* Error in JITERR */
      427    11374    5                JITERR=B$JIT$->B$JIT.ERR;
      428    11375    5                END;
      429    11376    5             ELSE DO;
      430    11377    5               CALL HFF$NILERASE(B$PS2$) ALTRET(TRANSFORM);
      431    11378    5               CALL KCD$PFPRG(STA$->KQ$STA,B$PS2$->VLP$STATION.STATION) ALTRET(JERR);
      432    11379    5               END;
      433    11380    4             END;
      434    11381    3           ELSE CALL KQC$ACTSTA (STA$->KQ$STA,AFPT);
      435    11382    3   BACKINU:;
      436    11383    3           CALL KQP$UNLOCK (STA$->KQ$STA);
      437    11384    3   BACKIN: ;
      438    11385                %LOCK (G=KQ$STREE.GATE);
      439    11388    3           IF ACTCNT = KQ$STREE.ACTCNT THEN GOTO NXT;
      440    11389    3           GOTO SRCH;
      441    11390    3           END;
      442    11391        /**/
      443    11392        /**/
      444    11393                          /*    M$DEACTIVATE
      445    11394                           *
      446    11395                           *
      447    11396                           */
      448    11397    2         IF KEYL ~= 8 THEN
      449    11398    3           DO;
      450    11399    3           IF LDCT$ ~= ADDR(NIL) THEN
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:14   
      451    11400    4             DO;  /* PRESENT */
      452    11401    4             IF STA$->KQ$STA.TERM THEN
      453    11402    5               DO;
      454    11403    5               IF NOT VSTA.CTL.ALLTRMS THEN
      455    11404    5                IF  NOT VSTA.CTL.ALLDCBS
      456    11405    5                AND NOT VSTA.CTL.ALLABSENT THEN
      457    11406    6                  DO;
      458    11407    6                  IF FOUND ~= 0 THEN GOTO UDONE;
      459    11408    6                  END;
      460    11409    5                ELSE GOTO UNXT;
      461    11410    5               END;
      462    11411    4             ELSE /* DCB */
      463    11412    5               DO;
      464    11413    5               IF DCB$->F$DCB.AU = '0'B THEN
      465    11414    6                 DO;
      466    11415    6                 FOUND=6;
      467    11416    6                 GOTO UDONE;
      468    11417    6                 END;
      469    11418    5               IF NOT VSTA.CTL.ALLDCBS THEN
      470    11419    5                IF  NOT VSTA.CTL.ALLTRMS
      471    11420    5                AND NOT VSTA.CTL.ALLABSENT THEN
      472    11421    6                  DO;
      473    11422    6                  IF FOUND ~= 0 THEN GOTO UDONE;
      474    11423    6                  END;
      475    11424    5                ELSE GOTO UNXT;
      476    11425    5               END;
      477    11426    4             END; /* PRESENT */
      478    11427    3           ELSE   /* ABSENT  */
      479    11428    4             DO;
      480    11429    4             IF NOT VSTA.CTL.ALLABSENT THEN
      481    11430    4              IF  NOT VSTA.CTL.ALLTRMS
      482    11431    4              AND NOT VSTA.CTL.ALLDCBS THEN
      483    11432    5                DO;
      484    11433    5                IF FOUND ~= 0 THEN GOTO UDONE;
      485    11434    5                END;
      486    11435    4              ELSE GOTO UNXT;
      487    11436    4             END; /* ABSENT */
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:15   
      488    11437    3           END;
      489    11438        /**/
      490    11439    2         IF AFPT.DISCONNECT THEN
      491    11440    3           DO;
      492    11441    3           CALL SYMBCHK ALTRET(UNXT);
      493    11442    3           IF LDCT$ ~= ADDR(NIL) THEN
      494    11443    3            IF LDCT$->NK$LDCT.RESCOD = NK_CGTRM THEN
      495    11444    3             IF LDCT$->NK$LDCT.DFLG.LOCAL THEN
      496    11445    3              FOUND=1;
      497    11446    3           IF  STA$->KQ$STA.TERM
      498    11447    3           AND STA$->KQ$STA.DSCREQW THEN GOTO UNXT;
      499    11448    3           IF FOUND <= 0 THEN FOUND=FOUND-1;
      500    11449    3           STA$->KQ$STA.LOCKCNT=STA$->KQ$STA.LOCKCNT+1;
      501    11450                %UNLOCK (G=STA$->KQ$STA.GATE);
      502    11453                %UNLOCK (G=KQ$STREE.GATE);
      503    11456    3           CALL KQC$DISCSTA (STA$->KQ$STA,AFPT);
      504    11457    3           GOTO BACKINU;
      505    11458    3           END;
      506    11459        /**/
      507    11460    2         IF AFPT.DSCGO THEN
      508    11461    3           DO;
      509    11462    3           IF NOT STA$->KQ$STA.TERM
      510    11463    3           OR NOT STA$->KQ$STA.DSCREQW THEN
      511    11464    4             DO;
      512    11465    4             FOUND=3;
      513    11466    4             GOTO UNXT;
      514    11467    4             END;
      515    11468    3           IF FOUND <= 0 THEN FOUND=FOUND-1;
      516    11469    3           STA$->KQ$STA.DSCREQW='0'B;
      517    11470                %UNLOCK (G=STA$->KQ$STA.GATE);
      518    11473                %UNLOCK (G=KQ$STREE.GATE);
      519    11476    3           CALL KCO$DSCTRMGO (STA$->KQ$STA);
      520    11477    3           GOTO BACKIN;
      521    11478    3           END;
      522    11479        /**/
      523    11480    2         CALL SYMBCHK ALTRET(UNXT);
      524    11481    2         IF FOUND <= 0 THEN FOUND=FOUND-1;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:16   
      525    11482    2         STA$->KQ$STA.LOCKCNT=STA$->KQ$STA.LOCKCNT+1;
      526    11483              %UNLOCK (G=STA$->KQ$STA.GATE);
      527    11486              %UNLOCK (G=KQ$STREE.GATE);
      528    11489    2         CALL KQC$DACTSTA (STA$->KQ$STA,AFPT);
      529    11490    2         GOTO BACKINU;
      530    11491        /**/
      531    11492        /**/
      532    11493        /**/
      533    11494    2   DONE: ;
      534    11495              %UNLOCK (G=KQ$STREE.GATE);
      535    11498    2         IF FOUND >= 0 THEN
      536    11499    3           DO CASE (FOUND);
      537    11500    3             CASE (4);
      538    11501    3               B$JIT$->B$JIT.ERR=E_NACTV;
      539    11502        /*E* ERROR:    KCP-E$NACTV-E
      540    11503             MESSAGE: That station is not active
      541    11504             MESSAGE1: Your control service attempted to perform an
      542    11505                       illegal operation on a deactivated station. */
      543    11506    3             CASE (2);
      544    11507    3               B$JIT$->B$JIT.ERR=E_BSYMA;
      545    11508        /*E* ERROR:   KCP-E$BSYMA-E
      546    11509             MESSAGE: Illegal operation on symbiont device
      547    11510             DESCRIPTION: Only OUTSYM can get this error.  He has his own
      548    11511                          PMMEs to activate and deactivate his devices while
      549    11512                          they are symbiont. */
      550    11513    3             CASE (1);
      551    11514    3               B$JIT$->B$JIT.ERR=E_NDSCL;
      552    11515        /*E* ERROR:   KCP-E$NDSCL-C
      553    11516             MESSAGE: Don't try to disconnect a local device
      554    11517             MESSAGE1: One the targets of an M$DEACTIVATE service request with
      555    11518                       DISCONNECT=YES was not a communications device.  The
      556    11519                       device has been deactivated but cannot be disconnected.
      557    11520             DESCRIPTION: The operation would require wire cutters or some new
      558    11521                          order codes (BURN WIRES ASCII) in the IOM. */
      559    11522    3             CASE (3);
      560    11523    3               B$JIT$->B$JIT.ERR=E_CGNWDR;
      561    11524        /*E* ERROR:   KCP-E$CGNWDR-E
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:17   
      562    11525             MESSAGE: That STATION isn't awaiting disconnect permission
      563    11526             MESSAGE1: One of the targets of an M$DEACTIVATE service request
      564    11527                       with DSCGO=YES was not waiting for permission to
      565    11528                       disconnect. */
      566    11529    3             CASE (0);
      567    11530    3               B$JIT$->B$JIT.ERR=E_NOSTA;
      568    11531        /*E* ERROR:  KCP-E$CGAFNS-C
      569    11532             MESSAGE: That STATION does not exist!
      570    11533             MESSAGE1: Your M$ACTIVATE or M$DEACTIVE service specified
      571    11534                       STATION options which resulted in no stations
      572    11535                       being processed. */
      573    11536    3             CASE (5);
      574    11537    3               B$JIT$->B$JIT.ERR=JITERR; /* From a MAKEFPRG failure */
      575    11538    3             CASE(6);
      576    11539    3               B$JIT$->B$JIT.ERR=E_NOTAU;
      577    11540    3           END;
      578    11541    2         RETURN;
      579    11542        /**/
      580    11543    2   SYMBCHK: PROC ALTRET;
      581    11544        /**/
      582    11545    3         IF LDCT$ ~= ADDR(NIL) THEN
      583    11546    3          IF LDCT$->NK$LDCT.DFLG.SYMBIONT THEN
      584    11547    4            DO;
      585    11548    4            FOUND=2;
      586    11549    4            ALTRETURN;
      587    11550    4            END;
      588    11551    3         RETURN;
      589    11552    3   END SYMBCHK;
      590    11553    2   END ACTIVATE;
      591    11554    1   END KCP$PMME;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:18   
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC_CP6.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KQ_ERRORS_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KCP$PMME.

   Procedure KCP$PMME requires 684 words for executable code.
   Procedure KCP$PMME requires 44 words of local(AUTO) storage.

    No errors detected in file KCP$PMMES.:E05TSI    .

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:19   

 Object Unit name= KCP$PMME                                   File name= KCP$PMMES.:E05TOU
 UTS= JUL 30 '97 00:18:29.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      9     11  KCP$PMME
    1   Proc  even  none   684   1254  KCP$PMME
    2  RoData even  none     3      3  KCP$PMME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        1  KCP$PMME
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:20   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 KQF$FWCG
 yes     yes           Std       2 KQC$CGCTL
 yes     yes           Std       0 KIS$OSI_ATTACH
 yes     yes           Std       0 KIS$OSI_DETACH
 yes     yes           Std       1 KQI$CGINFO
 yes     yes           Std       3 KQU$UNLATCH
         yes           Std       0 UDB$PMMEXIT
         yes           Std       1 KQX$LDASR
 yes     yes           Std       3 FRA$CGCON
 yes     yes           Std       3 KQB$SRCH
         yes           Std       1 HFC$UNLOCK
 yes     yes           Std       1 KQP$UNLOCK
 yes     yes           Std       1 HFF$NILERASE
 yes     yes           Std       2 KCD$PFPRG
 yes     yes           Std       1 KCD$TFPRG
 yes     yes           Std       2 KQC$ACTSTA
 yes     yes           Std       2 KQC$DISCSTA
         yes           Std       1 HFC$LOCK
         yes           Std       1 KCO$DSCTRMGO
 yes     yes           Std       2 KQC$DACTSTA
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     N$DCT$$                          r    B$PS0$                           r    B$PS1$
r    B$PS2$                                B$JIT$                                B_VECTNIL
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:21   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:22   


        1        1        /*M* KCP$PMMES COMGROUP-specific PMMES */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7       /*X* DMC,PLM=6,IND=0,IDT=2,SDI=2,CTI=0,ENU=0,AND,DCI=4,CSU=2,ECU=4,THI=0,DTI=0,STI=1
                 7        ,IAD=0,PRB */
        8        8        /**/
        9        9        /*P* NAME:         KCP$PMME
       10       10             PURPOSE:      To provide initial handling for comgroup-specific
       11       11                           PMMEs.
       12       12        */
       13       13        /**/
       14       14        KCP$PMME: PROC (FPTCODE) ALTRET;

     14  1 000000   000000 700200 xent  KCP$PMME     TSX0  ! X66_AUTO_1
         1 000001   000054 000001                    ZERO    44,1

       15       15        /**/
       16       16
       17       17
       18       18
       19       19        /**/
       20       20        /* INCLUDES */
       21       21        /**/
       22       22        %INCLUDE KQ_SUBS_C;
       23      322        %INCLUDE KQ_MAC_C;
       24     2872        %INCLUDE HF_LOCK_C;
       25     2886        %INCLUDE KQ_DATA_R;
       26     3718        %INCLUDE CP_6_SUBS;
       27     4258        %INCLUDE KC$CP6V_C;
       28     4378        %INCLUDE B$JIT_C;
       29     4692        %INCLUDE UD_SEV_C;
       30     4706        %INCLUDE KQ_ERRORS_C;
       31     4754        %INCLUDE KC_ERRORS_C;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:23   
       32     4801        %INCLUDE UD_ERRORS_C;
       33     4843        %INCLUDE KC_CP6;
       34     5403        %INCLUDE K_DATA_R;
       35     6114        %INCLUDE NK$LDCT;
       36     6216        %INCLUDE UD_EQU_E;
       37     6605        %INCLUDE NK_SUBS;
       38     6630        %INCLUDE F$DCB;
       39     6679        %INCLUDE NK_LDCT_R;
       40     6688        %INCLUDE KL_SUPER_C;
       41     9590
       42     9591
       43     9592
       44     9593        /**/
       45     9594        /* PARAMETERS */
       46     9595        /**/
       47     9596    1   DCL FPTCODE UBIN;
       48     9597
       49     9598
       50     9599
       51     9600        /**/
       52     9601        /* MACROS */
       53     9602        /**/
       54     9603        %MACRO $ERROR (NAME=GORGO,CODE=0,SEV=SEV_ERROR#);
       55     9604        DCL 1 NAME CONSTANT ALIGNED,
       56     9605              2 * BIT(18) UNAL INIT('130320'O),
       57     9606              2 * UBIN(15) UNAL INIT(CODE),
       58     9607              2 * UBIN(3) UNAL INIT(SEV);
       59     9608        %MEND;
       60     9609
       61     9610
       62     9611
       63     9612        /**/
       64     9613        /* BASED STRUCTURES */
       65     9614        /**/
       66     9615        %NK$LDCT (STCLASS="BASED(LDCT$)");
       67     9661        %KQ_CG   (FPTN=KQ$CG  ,STCLASS="BASED(CG$)");
       68    10400        %KQ_STA  (FPTN=KQ$STA ,STCLASS="BASED(STA$)");
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:24   
       69    10739        %KQ_THDR (FPTN=KQ$THDR,STCLASS=BASED);
       70    10777        %FPT$UNLATCH_V  (FPTN=FPT$UNLATCH   ,BASED="BASED(B$PS0$)");
       71    10781        %FPT$ACTIVATE_V (FPTN=FPT$ACTIVATE  ,BASED="BASED(B$PS0$)");
       72    10787        %VLP$STATION_V  (FPTN=VLP$STATION   ,BASED="BASED(B$PS1$)");
       73    10799        %B$JIT0;
       74    10888        %U$JIT1X;
       75    10891        %M$JIT2X;
       76    10894        %F$JIT3;
       77    10899        %A$JIT6X;
       78    10902
       79    10903
       80    10904
       81    10905        /**/
       82    10906        /* AUTO */
       83    10907        /**/
       84    10908    1   DCL CG$ PTR;
       85    10909    1   DCL LDCT$ PTR;
       86    10910    1   DCL STA$ PTR;
       87    10911        %FPT$UNLATCH_V (FPTN=UFPT,BASED=AUTO);
       88    10915    1   DCL DCB$ PTR;
       89    10916        %FPT$ACTIVATE_V (FPTN=AFPT,BASED=AUTO);
       90    10922        %VLP$STATION_V (FPTN=VSTA,BASED=AUTO);
       91    10934
       92    10935
       93    10936
       94    10937        /**/
       95    10938        /* CONSTANT */
       96    10939        /**/
       97    10940        %$ERROR (NAME=E_NOTCG ,CODE=%E$NOTCG );
       98    10946        %$ERROR (NAME=E_NOTAU ,CODE=%E$NOTAU );
       99    10952        %$ERROR (NAME=E_NOTACT ,CODE=%E$NOTACT );
      100    10958        %$ERROR (NAME=E_NOSTA ,CODE=%E$CGAFNS,SEV=SEV_CONT#);
      101    10964        %$ERROR (NAME=E_BSYMA ,CODE=%E$BSYMA );
      102    10970        %$ERROR (NAME=E_NDSCL ,CODE=%E$NDSCL ,SEV=SEV_CONT#);
      103    10976        %$ERROR (NAME=E_NOAURD,CODE=%E$NOAURD);
      104    10982        %$ERROR (NAME=E_CGNWDR,CODE=%E$CGNWDR);
      105    10988        %$ERROR (NAME=E_NACTV ,CODE=%E$NACTV );
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:25   
      106    10994
      107    10995        /**/
      108    10996        /* REFS */
      109    10997        /**/
      110    10998    1   DCL FRA$CGCON     ENTRY(3) ALTRET;
      111    10999    1   DCL HFF$NILERASE  ENTRY(1) ALTRET;
      112    11000    1   DCL HFF$TRAPALT   ENTRY(1) ALTRET;
      113    11001    1   DCL HFF$DSIZ      ENTRY(2) ALTRET;
      114    11002    1   DCL KCD$PFPRG ENTRY(2) ALTRET;         /* Make a pure FPRG station */
      115    11003    1   DCL KCD$TFPRG ENTRY(1) ALTRET;         /* Make a transformed FPRG station */
      116    11004    1   DCL KCO$DSCTRMGO  ENTRY(1);
      117    11005    1   DCL KIS$OSI_ATTACH ENTRY ALTRET;
      118    11006    1   DCL KIS$OSI_DETACH ENTRY ALTRET;
      119    11007    1   DCL KQB$SRCH      ENTRY(3) ALTRET;
      120    11008    1   DCL KQC$ACTSTA    ENTRY(2) ALTRET;
      121    11009    1   DCL KQC$CGCTL     ENTRY(2) ALTRET;
      122    11010    1   DCL KQC$DACTSTA   ENTRY(2) ALTRET;
      123    11011    1   DCL KQC$DISCSTA   ENTRY(2) ALTRET;
      124    11012    1   DCL KQF$FWCG      ENTRY(1) ALTRET;
      125    11013    1   DCL KQI$CGINFO    ENTRY(1) ALTRET;
      126    11014    1   DCL KQP$UNLOCK    ENTRY(1) ALTRET;
      127    11015    1   DCL KQU$UNLATCH   ENTRY(3) ALTRET;
      128    11016    1   DCL KQX$LDASR     ENTRY(1);
      129    11017    1   DCL UDB$PMMEXIT   ENTRY;
      130    11018    1   DCL B$PS0$ PTR SYMREF READONLY;
      131    11019    1   DCL B$PS1$ PTR SYMREF READONLY;
      132    11020    1   DCL B$PS2$ PTR SYMREF READONLY;
      133    11021    1   DCL B$JIT$ PTR SYMREF;
      134    11022
      135    11023
      136    11024
      137    11025        /**/
      138    11026        /* SUBS */
      139    11027        /**/
      140    11028        %SUB KQ$QTREE="CG$->KQ$CG.QUEUE.QTREE$->KQ$THDR";
      141    11029        %SUB KQ$TTREE="CG$->KQ$CG.TTREE";
      142    11030        %SUB KQ$STREE="CG$->KQ$CG.STREE";
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:26   
      143    11031        %EQU_CG;
      144    11079        %EJECT;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:27   
      145    11080        /**/
      146    11081    2           DO CASE (FPTCODE);

  11081  1 000002   200003 470500                    LDP0    @FPTCODE,,AUTO
         1 000003   000000 235100                    LDA     0,,PR0
         1 000004   000010 115007                    CMPA    8,DL
         1 000005   000007 602005 1                  TNC     s:11081+5,AL
         1 000006   000121 710000 1                  TRA     s:11127
         1 000007   000050 710000 1                  TRA     s:11096
         1 000010   000055 710000 1                  TRA     s:11100
         1 000011   000062 710000 1                  TRA     s:11104
         1 000012   000030 710000 1                  TRA     s:11088
         1 000013   000041 710000 1                  TRA     s:11092
         1 000014   000017 710000 1                  TRA     s:11084
         1 000015   000104 710000 1                  TRA     s:11113
         1 000016   000113 710000 1                  TRA     s:11120

      147    11082
      148    11083    2             CASE (%C$FWCG#);

      149    11084    2               CALL AURDSET;

  11084  1 000017   000177 701000 1                  TSX1    AURDSET
         1 000020   000000 011000                    NOP     0

      150    11085    2               CALL KQF$FWCG (STA$) ALTRET(NOTAU);

  11085  1 000021   200006 630500                    EPPR0   STA$,,AUTO
         1 000022   200050 450500                    STP0    ACTCNT+3,,AUTO
         1 000023   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000025   000000 701000 xent               TSX1    KQF$FWCG
         1 000026   000122 702000 1                  TSX2    NOTAU
         1 000027   000121 710000 1                  TRA     s:11127

      151    11086
      152    11087    2             CASE (%C$CGCTL#);
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:28   

      153    11088    2               CALL AUSET;

  11088  1 000030   000224 701000 1                  TSX1    AUSET
         1 000031   000000 011000                    NOP     0

      154    11089    2               CALL KQC$CGCTL (STA$);

  11089  1 000032   200006 630500                    EPPR0   STA$,,AUTO
         1 000033   200050 450500                    STP0    ACTCNT+3,,AUTO
         1 000034   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000036   000000 701000 xent               TSX1    KQC$CGCTL
         1 000037   000000 011000                    NOP     0
         1 000040   000121 710000 1                  TRA     s:11127

      155    11090
      156    11091    2             CASE (%C$CGINFO#);

      157    11092    2               CALL AURDSET;

  11092  1 000041   000177 701000 1                  TSX1    AURDSET
         1 000042   000000 011000                    NOP     0

      158    11093    2               CALL KQI$CGINFO (CG$->KQ$CG);

  11093  1 000043   200004 630500                    EPPR0   CG$,,AUTO
         1 000044   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000045   000000 701000 xent               TSX1    KQI$CGINFO
         1 000046   000000 011000                    NOP     0
         1 000047   000121 710000 1                  TRA     s:11127

      159    11094
      160    11095    2             CASE (%C$ACTIVATE#);

      161    11096    2               CALL ACTSET;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:29   
  11096  1 000050   000243 701000 1                  TSX1    ACTSET
         1 000051   000000 011000                    NOP     0

      162    11097    2               CALL ACTIVATE;

  11097  1 000052   000265 701000 1                  TSX1    ACTIVATE
         1 000053   000000 011000                    NOP     0
         1 000054   000121 710000 1                  TRA     s:11127

      163    11098
      164    11099    2             CASE (%C$DEACTIVATE#);

      165    11100    2               CALL ACTSET;

  11100  1 000055   000243 701000 1                  TSX1    ACTSET
         1 000056   000000 011000                    NOP     0

      166    11101    2               CALL DEACTIVATE;

  11101  1 000057   000313 701000 1                  TSX1    DEACTIVATE
         1 000060   000000 011000                    NOP     0
         1 000061   000121 710000 1                  TRA     s:11127

      167    11102
      168    11103    2             CASE (%C$UNLATCH#);

      169    11104    2               CALL USET;

  11104  1 000062   000126 701000 1                  TSX1    USET
         1 000063   000000 011000                    NOP     0

      170    11105                           /* Copy V area now so that if
      171    11106                            * it's bad, we trap now and
      172    11107                            * not in KQU$UNLATCH
      173    11108                            */
      174    11109    2               UFPT=FPT$UNLATCH;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:30   
  11109  1 000064   000000 470400 xsym               LDP0    B$PS0$
         1 000065   000100 100500                    MLR     fill='000'O
         1 000066   000000 000014                    ADSC9   0,,PR0                   cn=0,n=12
         1 000067   200010 000014                    ADSC9   UFPT,,AUTO               cn=0,n=12

      175    11110    2               CALL KQU$UNLATCH (STA$->KQ$STA,UFPT,B$JIT$->B$JIT.ERR);

  11110  1 000070   000000 236000 xsym               LDQ     B$JIT$
         1 000071   000012 036003                    ADLQ    10,DU
         1 000072   200052 756100                    STQ     ACTCNT+5,,AUTO
         1 000073   200010 631500                    EPPR1   UFPT,,AUTO
         1 000074   200051 451500                    STP1    ACTCNT+4,,AUTO
         1 000075   200006 236100                    LDQ     STA$,,AUTO
         1 000076   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000077   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000100   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000101   000000 701000 xent               TSX1    KQU$UNLATCH
         1 000102   000000 011000                    NOP     0
         1 000103   000121 710000 1                  TRA     s:11127

      176    11111
      177    11112    2             CASE (%C$ATTACH#);

      178    11113    2               CALL AUSET;

  11113  1 000104   000224 701000 1                  TSX1    AUSET
         1 000105   000000 011000                    NOP     0

      179    11114    2               CALL KIS$OSI_ATTACH

  11114  1 000106   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000107   000000 701000 xent               TSX1    KIS$OSI_ATTACH
         1 000110   000112 702000 1                  TSX2    s:11117
         1 000111   000112 710000 1                  TRA     s:11117

      180    11115    3               WHENALTRETURN DO;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:31   
      181    11116                      /* B$JIT.ERR has been filled in.  Just RETURN */
      182    11117    3                 END;

  11117  1 000112   000121 710000 1                  TRA     s:11127

      183    11118
      184    11119    2             CASE (%C$DETACH#);

      185    11120    2               CALL AUSET;

  11120  1 000113   000224 701000 1                  TSX1    AUSET
         1 000114   000000 011000                    NOP     0

      186    11121    2               CALL KIS$OSI_DETACH

  11121  1 000115   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000116   000000 701000 xent               TSX1    KIS$OSI_DETACH
         1 000117   000121 702000 1                  TSX2    s:11127
         1 000120   000121 710000 1                  TRA     s:11127

      187    11122    3               WHENALTRETURN DO;

      188    11123                      /* B$JIT.ERR has been filled in.  Just RETURN */
      189    11124    3                 END;

      190    11125
      191    11126    2           END; /*CASE FPTCODE*/

      192    11127    1         RETURN;

  11127  1 000121   000000 702200 xent               TSX2  ! X66_ARET

  11112  1 000122                       NOTAU        null
      193    11128        /**/
      194    11129    1   NOTAU:;
      195    11130    1         B$JIT$->B$JIT.ERR=E_NOTAU;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:32   
  11130  1 000122   000001 236000 0                  LDQ     E_NOTAU
         1 000123   000000 470400 xsym               LDP0    B$JIT$
         1 000124   000012 756100                    STQ     10,,PR0

      196    11131    1         RETURN;

  11131  1 000125   000000 702200 xent               TSX2  ! X66_ARET

      197    11132        %EJECT;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:33   
      198    11133        /****************************************************************
      199    11134        *****************************************************************/
      200    11135        /*D* NAME:         USET
      201    11136             PURPOSE:      To validate the DCB passed
      202    11137             DESCRIPTION:  Ensures it's a comgroup DCB.  Returns the
      203    11138                           LDCT$ and STA$ of the user's station, and
      204    11139                           also CG$ pointing to the CG context block.
      205    11140                           Loads the comgroup ASR to allow us to see
      206    11141                           the comgroup. */
      207    11142    1   USET: PROC;

  11142  1 000126   200040 741300       USET         STX1  ! ACT+1,,AUTO

      208    11143        /**/
      209    11144    2         DCB$=B$JIT$->B$JIT.DCB$;

  11144  1 000127   000000 470400 xsym               LDP0    B$JIT$
         1 000130   000232 236100                    LDQ     154,,PR0
         1 000131   200014 756100                    STQ     DCB$,,AUTO

      210    11145    2         IF DCB$->F$DCB.FCD = '0'B THEN GOTO NOTCG;

  11145  1 000132   200014 471500                    LDP1    DCB$,,AUTO
         1 000133   100031 236100                    LDQ     25,,PR1
         1 000134   020000 316007                    CANQ    8192,DL
         1 000135   000152 600000 1                  TZE     NOTCG

      211    11146    2         IF DCB$->F$DCB.IASN=%STREAM#

  11146  1 000136   100103 236100                    LDQ     67,,PR1
         1 000137   000777 376007                    ANQ     511,DL
         1 000140   000005 116007                    CMPQ    5,DL
         1 000141   000145 601000 1                  TNZ     s:11151

      212    11147    3         THEN DO;

      213    11148    3           DCB$=DCB$->F$DCB.CFU$;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:34   

  11148  1 000142   100066 236100                    LDQ     54,,PR1
         1 000143   200014 756100                    STQ     DCB$,,AUTO

      214    11149    3           B$JIT$->B$JIT.DCB$=DCB$;

  11149  1 000144   000232 756100                    STQ     154,,PR0

      215    11150    3           END;

      216    11151    2         IF DCB$->F$DCB.ASN ~= %COMGROUP# THEN

  11151  1 000145   200014 471500                    LDP1    DCB$,,AUTO
         1 000146   100032 236100                    LDQ     26,,PR1
         1 000147   777000 376007                    ANQ     -512,DL
         1 000150   004000 116007                    CMPQ    2048,DL
         1 000151   000157 600000 1                  TZE     s:11162

      217    11152    3           DO;

      218    11153    3   NOTCG:  B$JIT$->B$JIT.ERR=E_NOTCG;

  11153  1 000152   000000 236000 0     NOTCG        LDQ     E_NOTCG
         1 000153   000012 756100                    STQ     10,,PR0

      219    11154        /*E* ERROR:   KCP-E$NOTCG-E
      220    11155             MESSAGE: That DCB% (%DC)% is not open to comgroup.
      221    11156             MESSAGE1: The DCB specified in your service request is required
      222    11157                       to be open to a comgroup, but is not.
      223    11158             DESCRIPTION: The comgroup-specific PMMEs all require a DCB open
      224    11159                          to comgroup. */
      225    11160    3           CALL UDB$PMMEXIT;

  11160  1 000154   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000155   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000156   000000 011000                    NOP     0

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:35   
      226    11161    3           END;

      227    11162    2         LDCT$=NK$LDCT$(DCB$->F$DCB.LDCTX);

  11162  1 000157   200014 470500                    LDP0    DCB$,,AUTO
         1 000160   000051 220100                    LDX0    41,,PR0
         1 000161   000000 471400 xsym               LDP1    N$DCT$$
         1 000162   100000 236110                    LDQ     0,X0,PR1
         1 000163   200005 756100                    STQ     LDCT$,,AUTO

      228    11163    2         STA$=LDCT$->NK$LDCT.STA$;

  11163  1 000164   200005 473500                    LDP3    LDCT$,,AUTO
         1 000165   300012 236100                    LDQ     10,,PR3
         1 000166   200006 756100                    STQ     STA$,,AUTO

      229    11164    2         CG$=LDCT$->NK$LDCT.CG$;

  11164  1 000167   300027 236100                    LDQ     23,,PR3
         1 000170   200004 756100                    STQ     CG$,,AUTO

      230    11165    2         CALL KQX$LDASR (CG$->KQ$CG);

  11165  1 000171   200004 630500                    EPPR0   CG$,,AUTO
         1 000172   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000173   000000 701000 xent               TSX1    KQX$LDASR
         1 000174   000000 011000                    NOP     0

      231    11166    2         RETURN;

  11166  1 000175   200040 221300                    LDX1  ! ACT+1,,AUTO
         1 000176   000001 702211                    TSX2  ! 1,X1

      232    11167    2   END USET;
      233    11168        /****************************************************************
      234    11169        *****************************************************************/
      235    11170        /*D* NAME:         AURDSET
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:36   
      236    11171             PURPOSE:      To set up for AU read-access functions
      237    11172             DESCRIPTION:  Calls USET.  Then ensures the user has AURD
      238    11173                           access to the comgroup.
      239    11174        */
      240    11175    1   AURDSET: PROC;

  11175  1 000177   200036 741300       AURDSET      STX1  ! VSTA+8,,AUTO

      241    11176        /**/
      242    11177    2         CALL USET;

  11177  1 000200   000126 701000 1                  TSX1    USET
         1 000201   000000 011000                    NOP     0

      243    11178    2         IF NOT ( DCB$->F$DCB.FFLG.AU | DCB$->F$DCB.FFLG.AURD) THEN

  11178  1 000202   200014 470500                    LDP0    DCB$,,AUTO
         1 000203   000004 236100                    LDQ     4,,PR0
         1 000204   000012 736000                    QLS     10
         1 000205   400000 376003                    ANQ     -131072,DU
         1 000206   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000207   000004 236100                    LDQ     4,,PR0
         1 000210   000011 736000                    QLS     9
         1 000211   400000 376003                    ANQ     -131072,DU
         1 000212   200050 276100                    ORQ     ACTCNT+3,,AUTO
         1 000213   000222 601000 1                  TNZ     s:11187

      244    11179    3           DO;

      245    11180    3           B$JIT$->B$JIT.ERR=E_NOAURD;

  11180  1 000214   000006 236000 0                  LDQ     E_NOAURD
         1 000215   000000 471400 xsym               LDP1    B$JIT$
         1 000216   100012 756100                    STQ     10,,PR1

      246    11181        /*E* ERROR:   KCP-E$NOAURD-E
      247    11182             MESSAGE: You require AU or AURD access to get comgroup information
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:37   
      248    11183             MESSAGE1: You issued a comgroup informational service request
      249    11184                       but do not have AU or AURD access to the comgroup. */
      250    11185    3           CALL UDB$PMMEXIT;

  11185  1 000217   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000220   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000221   000000 011000                    NOP     0

      251    11186    3           END;

      252    11187    2         RETURN;

  11187  1 000222   200036 221300                    LDX1  ! VSTA+8,,AUTO
         1 000223   000001 702211                    TSX2  ! 1,X1

      253    11188    2   END AURDSET;
      254    11189        /****************************************************************
      255    11190        *****************************************************************/
      256    11191        /*D* NAME:         AUSET
      257    11192             PURPOSE:      To set up for AU-only functions
      258    11193             DESCRIPTION:  Calls USET.  Then ensures the user has AU
      259    11194                           access to the comgroup.
      260    11195        */
      261    11196    1   AUSET: PROC ALTRET;

  11196  1 000224   200036 741300       AUSET        STX1  ! VSTA+8,,AUTO

      262    11197        /**/
      263    11198    2         CALL USET;

  11198  1 000225   000126 701000 1                  TSX1    USET
         1 000226   000000 011000                    NOP     0

      264    11199    2         IF DCB$->F$DCB.AU = '0'B THEN

  11199  1 000227   200014 470500                    LDP0    DCB$,,AUTO
         1 000230   000031 236100                    LDQ     25,,PR0
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:38   
         1 000231   200000 316003                    CANQ    65536,DU
         1 000232   000241 601000 1                  TNZ     s:11211

      265    11200    3           DO;

      266    11201    3           B$JIT$->B$JIT.ERR=E_NOTAU;

  11201  1 000233   000001 236000 0                  LDQ     E_NOTAU
         1 000234   000000 471400 xsym               LDP1    B$JIT$
         1 000235   100012 756100                    STQ     10,,PR1

      267    11202        /*E* ERROR:   KCP-E$NOTAU-E
      268    11203             MESSAGE: Only the administrative user may control the comgroup
      269    11204             MESSAGE1: You issued a comgroup control service request, the
      270    11205                       use of which is restricted to the administrative user.
      271    11206                       You are not he.
      272    11207             DESCRIPTION: Only the AU may issued the comgroup control
      273    11208                          service requests. */
      274    11209    3           CALL UDB$PMMEXIT;

  11209  1 000236   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000237   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000240   000000 011000                    NOP     0

      275    11210    3           END;

      276    11211    2         RETURN;

  11211  1 000241   200036 221300                    LDX1  ! VSTA+8,,AUTO
         1 000242   000001 702211                    TSX2  ! 1,X1

      277    11212    2   END AUSET;
      278    11213        /****************************************************************
      279    11214        *****************************************************************/
      280    11215        /*D* NAME:         ACTSET
      281    11216             PURPOSE:      To set up for ACTIVATE and DEACTIVATE
      282    11217             DESCRIPTION:  Calls USET.  Then ensures the user has AU
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:39   
      283    11218                           or TCTL access to the comgroup.
      284    11219        */
      285    11220    1   ACTSET: PROC ALTRET;

  11220  1 000243   200036 741300       ACTSET       STX1  ! VSTA+8,,AUTO

      286    11221        /**/
      287    11222    2         CALL USET;

  11222  1 000244   000126 701000 1                  TSX1    USET
         1 000245   000000 011000                    NOP     0

      288    11223    2         IF DCB$->F$DCB.AU = '0'B AND DCB$->F$DCB.FFLG.TCTL = '0'B

  11223  1 000246   200014 470500                    LDP0    DCB$,,AUTO
         1 000247   000031 236100                    LDQ     25,,PR0
         1 000250   200000 316003                    CANQ    65536,DU
         1 000251   000263 601000 1                  TNZ     s:11236
         1 000252   000004 236100                    LDQ     4,,PR0
         1 000253   000100 316003                    CANQ    64,DU
         1 000254   000263 601000 1                  TNZ     s:11236

      289    11224    3         THEN DO;

      290    11225    3           B$JIT$->B$JIT.ERR=E_NOTACT;

  11225  1 000255   000002 236000 0                  LDQ     E_NOTACT
         1 000256   000000 471400 xsym               LDP1    B$JIT$
         1 000257   100012 756100                    STQ     10,,PR1

      291    11226        /*E* ERROR:   KCP-E$NOTACT-E
      292    11227             MESSAGE: Only the AU or a DCB with TCTL permissions are
      293    11228                      allowed to ACTIVATE or DEACTIVATE terminals.
      294    11229             MESSAGE1: You issued an ACTIVATE or DEACTIVATE request, the
      295    11230                       use of which is restricted to the AU or TCTL DCB's.
      296    11231                       You are not one of them.
      297    11232             DESCRIPTION: Only the AU or a DCB with TCTL permissions are
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:40   
      298    11233                          allowed to ACTIVATE and DEACTIVATE terminals. */
      299    11234    3           CALL UDB$PMMEXIT;

  11234  1 000260   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000261   000000 701000 xent               TSX1    UDB$PMMEXIT
         1 000262   000000 011000                    NOP     0

      300    11235    3           END;

      301    11236    2         RETURN;

  11236  1 000263   200036 221300                    LDX1  ! VSTA+8,,AUTO
         1 000264   000001 702211                    TSX2  ! 1,X1

      302    11237    2   END ACTSET;
      303    11238        %EJECT;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:41   
      304    11239        /****************************************************************
      305    11240        *****************************************************************/
      306    11241        /*D* NAME:         ACTIVATE
      307    11242             PURPOSE:      To process the M$ACTIVATE PMME
      308    11243             INPUT:        LDCT$, STA$ point to the user's station
      309    11244                                     The user is the AU or a TCTL DCB.
      310    11245                           CG$ points to the comgroup.
      311    11246             DESCRIPTION:  The specified station(s) is(are) activated.
      312    11247        */
      313    11248    1   ACTIVATE: PROC;

  11248  1 000265   200036 741300       ACTIVATE     STX1  ! VSTA+8,,AUTO

      314    11249        /**/
      315    11250    2   DCL ACT BIT(36);
      316    11251    2   DCL KEY CHAR(8);
      317    11252    2   DCL KEYR REDEF KEY BIT(72);
      318    11253    2   DCL KEYL UBIN;
      319    11254    2   DCL FOUND SBIN;
      320    11255    2   DCL JITERR BIT(36) ALIGNED;
      321    11256    2   DCL ACTCNT UBIN;
      322    11257    2   DCL B$$CHARS CHAR(KEYL) BASED CALIGNED;
      323    11258        /**/
      324    11259
      325    11260         /* If we are connect a resource do it and then return */
      326    11261    2         IF FPT$ACTIVATE.CONNECTRES

  11261  1 000266   000000 470400 xsym               LDP0    B$PS0$
         1 000267   000002 236100                    LDQ     2,,PR0
         1 000270   010000 316003                    CANQ    4096,DU
         1 000271   000310 600000 1                  TZE     s:11266

      327    11262    3         THEN DO;

      328    11263    3           CALL FRA$CGCON(FPT$ACTIVATE.RES,FPT$ACTIVATE.ATTR,KQ$CG);

  11263  1 000272   200004 236100                    LDQ     CG$,,AUTO
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:42   
         1 000273   200052 756100                    STQ     ACTCNT+5,,AUTO
         1 000274   000000 236000 xsym               LDQ     B$PS0$
         1 000275   000005 036003                    ADLQ    5,DU
         1 000276   200051 756100                    STQ     ACTCNT+4,,AUTO
         1 000277   000000 236000 xsym               LDQ     B$PS0$
         1 000300   000004 036003                    ADLQ    4,DU
         1 000301   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000302   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000303   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000304   000000 701000 xent               TSX1    FRA$CGCON
         1 000305   000000 011000                    NOP     0

      329    11264    3           RETURN;

  11264  1 000306   200036 221300                    LDX1  ! VSTA+8,,AUTO
         1 000307   000001 702211                    TSX2  ! 1,X1

      330    11265    3           END;
      331    11266    2         ACT='1'B;

  11266  1 000310   400000 236003                    LDQ     -131072,DU
         1 000311   200037 756100                    STQ     ACT,,AUTO

      332    11267    2         GOTO ACT0;

  11267  1 000312   000315 710000 1                  TRA     ACT0

      333    11268        /**/
      334    11269        /*D* NAME:         DEACTIVATE
      335    11270             PURPOSE:      To process the M$DEACTIVATE PMME
      336    11271             INPUT:        Same as ACTIVATE
      337    11272             DESCRIPTION:  The specified station(s) is(are) deactivated
      338    11273                           as specified by the FPT
      339    11274        */
      340    11275    2   DEACTIVATE: ENTRY;

  11275  1 000313   200036 741300       DEACTIVATE   STX1  ! VSTA+8,,AUTO
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:43   

      341    11276        /**/
      342    11277    2         ACT='0'B;

  11277  1 000314   200037 450100                    STZ     ACT,,AUTO

      343    11278    2   ACT0: AFPT=FPT$ACTIVATE;

  11278  1 000315   000000 470400 xsym  ACT0         LDP0    B$PS0$
         1 000316   000100 100500                    MLR     fill='000'O
         1 000317   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
         1 000320   200016 000040                    ADSC9   AFPT,,AUTO               cn=0,n=32

      344    11279    2         VSTA.STATION=VLP$STATION.STATION;

  11279  1 000321   000000 471400 xsym               LDP1    B$PS1$
         1 000322   040100 100500                    MLR     fill='040'O
         1 000323   100000 000010                    ADSC9   0,,PR1                   cn=0,n=8
         1 000324   200026 000010                    ADSC9   VSTA,,AUTO               cn=0,n=8

      345    11280    2         KEYR='0'B;

  11280  1 000325   000000 235003                    LDA     0,DU
         1 000326   000000 236003                    LDQ     0,DU
         1 000327   200040 757100                    STAQ    KEY,,AUTO

      346    11281    2         CALL INDEX (KEYL,'?',VSTA.STATION);

  11281  1 000330   000000 124500                    SCM     mask='000'O
         1 000331   200026 000010                    ADSC9   VSTA,,AUTO               cn=0,n=8
         1 000332   000000 000001 2                  ADSC9   0                        cn=0,n=1
         1 000333   200042 000100                    ARG     KEYL,,AUTO

      347    11282    2         IF KEYL ~= 8 THEN VSTA=VLP$STATION;

  11282  1 000334   200042 235100                    LDA     KEYL,,AUTO
         1 000335   000010 115007                    CMPA    8,DL
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:44   
         1 000336   000342 600000 1                  TZE     s:11283

  11282  1 000337   000100 100500                    MLR     fill='000'O
         1 000340   100000 000040                    ADSC9   0,,PR1                   cn=0,n=32
         1 000341   200026 000040                    ADSC9   VSTA,,AUTO               cn=0,n=32

      348    11283    2         ADDR(KEY)->B$$CHARS=ADDR(VSTA.STATION)->B$$CHARS;

  11283  1 000342   000000 620005                    EAX0    0,AL
         1 000343   200042 722100                    LXL2    KEYL,,AUTO
         1 000344   040140 100540                    MLR     fill='040'O
         1 000345   200026 000010                    ADSC9   VSTA,,AUTO               cn=0,n=*X0
         1 000346   200040 000012                    ADSC9   KEY,,AUTO                cn=0,n=*X2

      349    11284    2         FOUND=0;

  11284  1 000347   200043 450100                    STZ     FOUND,,AUTO

      350    11285              %LOCK (G=KQ$STREE.GATE);

  11286  1 000350   200004 236100                    LDQ     CG$,,AUTO
         1 000351   000075 036003                    ADLQ    61,DU
         1 000352   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000353   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000354   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000355   000000 701000 xent               TSX1    HFC$LOCK
         1 000356   000000 011000                    NOP     0

      351    11288    2   SRCH: CALL KQB$SRCH (KQ$STREE,KEY,STA$);

  11288  1 000357   200006 630500       SRCH         EPPR0   STA$,,AUTO
         1 000360   200052 450500                    STP0    ACTCNT+5,,AUTO
         1 000361   200040 631500                    EPPR1   KEY,,AUTO
         1 000362   200051 451500                    STP1    ACTCNT+4,,AUTO
         1 000363   200004 236100                    LDQ     CG$,,AUTO
         1 000364   000075 036003                    ADLQ    61,DU
         1 000365   200050 756100                    STQ     ACTCNT+3,,AUTO
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:45   
         1 000366   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000367   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000370   000000 701000 xent               TSX1    KQB$SRCH
         1 000371   000000 011000                    NOP     0

      352    11289    3           DO FOREVER;

      353    11290    3           IF STA$ = ADDR(NIL) THEN GOTO DONE;

  11290  1 000372   200006 236100                    LDQ     STA$,,AUTO
         1 000373   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000374   001160 600000 1                  TZE     DONE

      354    11291    3           IF ADDR(STA$->KQ$STA.BTN.KEY)->B$$CHARS > ADDR(VSTA.STATION)->B$$CHARS THEN

  11291  1 000375   200042 720100                    LXL0    KEYL,,AUTO
         1 000376   200006 470500                    LDP0    STA$,,AUTO
         1 000377   040140 106540                    CMPC    fill='040'O
         1 000400   200026 000010                    ADSC9   VSTA,,AUTO               cn=0,n=*X0
         1 000401   000005 000010                    ADSC9   5,,PR0                   cn=0,n=*X0
         1 000402   001160 602000 1                  TNC     DONE

      355    11292    3            GOTO DONE;
      356    11293    3           ELSE IF ADDR(STA$->KQ$STA.BTN.KEY)->B$$CHARS = ADDR(VSTA.STATION)->B$$CHARS
             11293                    THEN

  11293  1 000403   000416 601000 1                  TNZ     NXT

      357    11294    4              DO;

      358    11295    4              IF SUBSTR(STA$->KQ$STA.BTN.KEY,0,1) ~= '*' THEN

  11295  1 000404   000005 236100                    LDQ     5,,PR0
         1 000405   777000 376003                    ANQ     -512,DU
         1 000406   052000 116003                    CMPQ    21504,DU
         1 000407   000416 600000 1                  TZE     NXT

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:46   
      359    11296    4               IF FOUND = 0

  11296  1 000410   200043 235100                    LDA     FOUND,,AUTO
         1 000411   000422 600000 1                  TZE     GOT1
         1 000412   040100 106500                    CMPC    fill='040'O
         1 000413   200040 000010                    ADSC9   KEY,,AUTO                cn=0,n=8
         1 000414   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 000415   000422 601000 1                  TNZ     GOT1

      360    11297    4               OR KEY ~= STA$->KQ$STA.BTN.KEY THEN GOTO GOT1;
      361    11298    4              END;

      362    11299    3   NXT:    STA$=STA$->KQ$STA.BTN.FLINK$;

  11299  1 000416   200006 470500       NXT          LDP0    STA$,,AUTO
         1 000417   000004 236100                    LDQ     4,,PR0
         1 000420   200006 756100                    STQ     STA$,,AUTO

      363    11300    3           END;

  11300  1 000421   000372 710000 1                  TRA     s:11290

      364    11301    2   GOT1: ACTCNT=KQ$STREE.ACTCNT;

  11301  1 000422   200004 471500       GOT1         LDP1    CG$,,AUTO
         1 000423   100102 236100                    LDQ     66,,PR1
         1 000424   000022 772000                    QRL     18
         1 000425   200045 756100                    STQ     ACTCNT,,AUTO

      365    11302    2         KEY=STA$->KQ$STA.BTN.KEY;

  11302  1 000426   040100 100500                    MLR     fill='040'O
         1 000427   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         1 000430   200040 000010                    ADSC9   KEY,,AUTO                cn=0,n=8

      366    11303              %LOCK (G=STA$->KQ$STA.GATE);

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:47   
  11304  1 000431   200006 236100                    LDQ     STA$,,AUTO
         1 000432   000016 036003                    ADLQ    14,DU
         1 000433   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000434   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000435   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000436   000000 701000 xent               TSX1    HFC$LOCK
         1 000437   000000 011000                    NOP     0

      367    11306    2         LDCT$=STA$->KQ$STA.LDCT$;

  11306  1 000440   200006 470500                    LDP0    STA$,,AUTO
         1 000441   000010 236100                    LDQ     8,,PR0
         1 000442   200005 756100                    STQ     LDCT$,,AUTO

      368    11307    2         IF ACT THEN

  11307  1 000443   200037 235100                    LDA     ACT,,AUTO
         1 000444   000707 600000 1                  TZE     s:11397

      369    11308    3           DO;

      370    11309                          /*    M$ACTIVATE
      371    11310                           *
      372    11311                           *
      373    11312                           */
      374    11313    3           CALL SYMBCHK ALTRET(UNXT);

  11313  1 000445   001240 701000 1                  TSX1    SYMBCHK
         1 000446   000455 702000 1                  TSX2    UNXT

      375    11314    3           IF LDCT$ = ADDR(NIL)

  11314  1 000447   200005 236100                    LDQ     LDCT$,,AUTO
         1 000450   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000451   000455 600000 1                  TZE     UNXT
         1 000452   200006 470500                    LDP0    STA$,,AUTO
         1 000453   000020 234100                    SZN     16,,PR0
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:48   
         1 000454   000465 605000 1                  TPL     s:11322

      376    11315    3           OR STA$->KQ$STA.IDSC THEN
      377    11316    4   UNXT:     DO;

  11316  1 000455                       UNXT         null
      378    11317                  %UNLOCK (G=STA$->KQ$STA.GATE);

  11318  1 000455   200006 236100                    LDQ     STA$,,AUTO
         1 000456   000016 036003                    ADLQ    14,DU
         1 000457   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000460   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000461   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000462   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000463   000000 011000                    NOP     0

      379    11320    4             GOTO NXT;

  11320  1 000464   000416 710000 1                  TRA     NXT

      380    11321    4             END;
      381    11322    3           IF KEYL ~= 8 THEN

  11322  1 000465   200042 235100                    LDA     KEYL,,AUTO
         1 000466   000010 115007                    CMPA    8,DL
         1 000467   000531 600000 1                  TZE     s:11352

      382    11323    3            IF STA$->KQ$STA.TERM THEN

  11323  1 000470   000020 236100                    LDQ     16,,PR0
         1 000471   040000 316003                    CANQ    16384,DU
         1 000472   000512 600000 1                  TZE     s:11340

      383    11324    4              DO;

      384    11325    4              IF NOT VSTA.CTL.ALLTRMS THEN

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:49   
  11325  1 000473   200032 236100                    LDQ     VSTA+4,,AUTO
         1 000474   020000 316003                    CANQ    8192,DU
         1 000475   000531 601000 1                  TNZ     s:11352

      385    11326    4               IF NOT VSTA.CTL.ALLDCBS THEN

  11326  1 000476   010000 316003                    CANQ    4096,DU
         1 000477   000455 601000 1                  TNZ     UNXT

      386    11327    5                 DO;

      387    11328    5                 IF FOUND ~= 0 THEN

  11328  1 000500   200043 235100                    LDA     FOUND,,AUTO
         1 000501   000531 600000 1                  TZE     s:11352

      388    11329    6   UDONE:          DO;

  11329  1 000502                       UDONE        null
      389    11330                        %UNLOCK (G=STA$->KQ$STA.GATE);

  11331  1 000502   200006 236100                    LDQ     STA$,,AUTO
         1 000503   000016 036003                    ADLQ    14,DU
         1 000504   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000505   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000506   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000507   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000510   000000 011000                    NOP     0

      390    11333    6                   GOTO DONE;

  11333  1 000511   001160 710000 1                  TRA     DONE

      391    11334    6                   END;
      392    11335    5                 END;
      393    11336    4               ELSE GOTO UNXT;
      394    11337    4              END;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:50   
      395    11338    3            ELSE /* DCB */
      396    11339    4              DO;

      397    11340    4              IF DCB$->F$DCB.AU = '0'B THEN

  11340  1 000512   200014 471500                    LDP1    DCB$,,AUTO
         1 000513   100031 236100                    LDQ     25,,PR1
         1 000514   200000 316003                    CANQ    65536,DU
         1 000515   000521 601000 1                  TNZ     s:11345

      398    11341    5                DO;

      399    11342    5                FOUND=6;

  11342  1 000516   000006 235007                    LDA     6,DL
         1 000517   200043 755100                    STA     FOUND,,AUTO

      400    11343    5                GOTO UDONE;

  11343  1 000520   000502 710000 1                  TRA     UDONE

      401    11344    5                END;
      402    11345    4              IF NOT VSTA.CTL.ALLDCBS THEN

  11345  1 000521   200032 236100                    LDQ     VSTA+4,,AUTO
         1 000522   010000 316003                    CANQ    4096,DU
         1 000523   000531 601000 1                  TNZ     s:11352

      403    11346    4               IF NOT VSTA.CTL.ALLTRMS THEN

  11346  1 000524   020000 316003                    CANQ    8192,DU
         1 000525   000455 601000 1                  TNZ     UNXT

      404    11347    5                 DO;

      405    11348    5                 IF FOUND ~= 0 THEN GOTO UDONE;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:51   
  11348  1 000526   200043 235100                    LDA     FOUND,,AUTO
         1 000527   000502 601000 1                  TNZ     UDONE

      406    11349    5                 END;

  11349  1 000530   000531 710000 1                  TRA     s:11352

      407    11350    4               ELSE GOTO UNXT;
      408    11351    4              END;
      409    11352    3           IF FOUND <= 0 THEN FOUND=FOUND-1;

  11352  1 000531   200043 235100                    LDA     FOUND,,AUTO
         1 000532   000535 605400 1                  TPNZ    s:11353

  11352  1 000533   000001 336007                    LCQ     1,DL
         1 000534   200043 056100                    ASQ     FOUND,,AUTO

      410    11353    3           STA$->KQ$STA.LOCKCNT=STA$->KQ$STA.LOCKCNT+1;

  11353  1 000535   000020 236100                    LDQ     16,,PR0
         1 000536   000001 036007                    ADLQ    1,DL
         1 000537   000020 552104                    STBQ    16,'04'O,PR0

      411    11354    3           IF AFPT.MINRD = 0 THEN GOTO NOMIN;

  11354  1 000540   200021 220100                    LDX0    AFPT+3,,AUTO
         1 000541   000551 600000 1                  TZE     NOMIN

      412    11355    3           STA$->KQ$STA.MINRD = MAXIMUM(2,AFPT.MINRD);

  11355  1 000542   200021 236100                    LDQ     AFPT+3,,AUTO
         1 000543   000022 772000                    QRL     18
         1 000544   000002 116007                    CMPQ    2,DL
         1 000545   000547 603000 1                  TRC     s:11355+5
         1 000546   000002 236007                    LDQ     2,DL
         1 000547   000000 621006                    EAX1    0,QL
         1 000550   000032 741100                    STX1    26,,PR0
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:52   

      413    11356    3   NOMIN:  IF AFPT.MAXRD = 0 THEN GOTO NOMAX;

  11356  1 000551   200021 721100       NOMIN        LXL1    AFPT+3,,AUTO
         1 000552   000562 600000 1                  TZE     NOMAX

      414    11357    3           STA$->KQ$STA.MAXRD = MAXIMUM(3,AFPT.MAXRD);

  11357  1 000553   200021 236100                    LDQ     AFPT+3,,AUTO
         1 000554   777777 376007                    ANQ     -1,DL
         1 000555   000003 116007                    CMPQ    3,DL
         1 000556   000560 603000 1                  TRC     s:11357+5
         1 000557   000003 236007                    LDQ     3,DL
         1 000560   000000 622006                    EAX2    0,QL
         1 000561   000032 442100                    SXL2    26,,PR0

  11357  1 000562                       NOMAX        null
      415    11358    3   NOMAX:  ;
      416    11359                %UNLOCK (G=STA$->KQ$STA.GATE);

  11360  1 000562   200006 236100                    LDQ     STA$,,AUTO
         1 000563   000016 036003                    ADLQ    14,DU
         1 000564   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000565   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000566   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000567   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000570   000000 011000                    NOP     0

      417    11362                %UNLOCK (G=KQ$STREE.GATE);

  11363  1 000571   200004 236100                    LDQ     CG$,,AUTO
         1 000572   000075 036003                    ADLQ    61,DU
         1 000573   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000574   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000575   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000576   000000 701000 xent               TSX1    HFC$UNLOCK
         1 000577   000000 011000                    NOP     0
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:53   

      418    11365    3           IF AFPT.MAKEFPRG='1'B AND LDCT$->NK$LDCT.RESCOD=NK_CGTRM

  11365  1 000600   200020 236100                    LDQ     AFPT+2,,AUTO
         1 000601   020000 316003                    CANQ    8192,DU
         1 000602   000656 600000 1                  TZE     s:11381
         1 000603   200005 470500                    LDP0    LDCT$,,AUTO
         1 000604   000006 236100                    LDQ     6,,PR0
         1 000605   000017 376007                    ANQ     15,DL
         1 000606   000002 116007                    CMPQ    2,DL
         1 000607   000656 601000 1                  TNZ     s:11381
         1 000610   000022 236100                    LDQ     18,,PR0
         1 000611   000777 316003                    CANQ    511,DU
         1 000612   000656 600000 1                  TZE     s:11381

      419    11366    3           AND LDCT$->NK$LDCT.TERMID.TTYP ~= %KLTY_PROG#
      420    11367    4           THEN DO;

      421    11368    4             STA$->KQ$STA.USEAUACCT = AFPT.USEAUACCT;

  11368  1 000613   200006 471500                    LDP1    STA$,,AUTO
         1 000614   200020 236100                    LDQ     AFPT+2,,AUTO
         1 000615   000026 772000                    QRL     22
         1 000616   100023 676100                    ERQ     19,,PR1
         1 000617   000200 376007                    ANQ     128,DL
         1 000620   100023 656100                    ERSQ    19,,PR1

      422    11369    4             IF KEYL ~= 8 AND VSTA.CTL.ALLTRMS='1'B

  11369  1 000621   200042 235100                    LDA     KEYL,,AUTO
         1 000622   000010 115007                    CMPA    8,DL
         1 000623   000642 600000 1                  TZE     s:11377
         1 000624   200032 236100                    LDQ     VSTA+4,,AUTO
         1 000625   020000 316003                    CANQ    8192,DU
         1 000626   000642 600000 1                  TZE     s:11377

      423    11370    4             THEN
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:54   
      424    11371    4   TRANSFORM: CALL KCD$TFPRG(STA$->KQ$STA)

  11371  1 000627   200006 630500       TRANSFORM    EPPR0   STA$,,AUTO
         1 000630   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000631   000000 701000 xent               TSX1    KCD$TFPRG
         1 000632   000634 702000 1                  TSX2    JERR
         1 000633   000641 710000 1                  TRA     s:11375

      425    11372    5              WHENALTRETURN DO;

      426    11373    5   JERR:        FOUND=5; /* Error in JITERR */

  11373  1 000634   000005 235007       JERR         LDA     5,DL
         1 000635   200043 755100                    STA     FOUND,,AUTO

      427    11374    5                JITERR=B$JIT$->B$JIT.ERR;

  11374  1 000636   000000 470400 xsym               LDP0    B$JIT$
         1 000637   000012 236100                    LDQ     10,,PR0
         1 000640   200044 756100                    STQ     JITERR,,AUTO

      428    11375    5                END;

  11375  1 000641   000666 710000 1                  TRA     BACKINU

      429    11376    5             ELSE DO;

      430    11377    5               CALL HFF$NILERASE(B$PS2$) ALTRET(TRANSFORM);

  11377  1 000642   000001 630400 2                  EPPR0   1
         1 000643   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000644   000000 701000 xent               TSX1    HFF$NILERASE
         1 000645   000627 702000 1                  TSX2    TRANSFORM

      431    11378    5               CALL KCD$PFPRG(STA$->KQ$STA,B$PS2$->VLP$STATION.STATION) ALTRET(JERR);

  11378  1 000646   000000 236000 xsym               LDQ     B$PS2$
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:55   
         1 000647   200006 235100                    LDA     STA$,,AUTO
         1 000650   200050 757100                    STAQ    ACTCNT+3,,AUTO
         1 000651   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000652   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000653   000000 701000 xent               TSX1    KCD$PFPRG
         1 000654   000634 702000 1                  TSX2    JERR

      432    11379    5               END;

      433    11380    4             END;

  11380  1 000655   000666 710000 1                  TRA     BACKINU

      434    11381    3           ELSE CALL KQC$ACTSTA (STA$->KQ$STA,AFPT);

  11381  1 000656   200016 630500                    EPPR0   AFPT,,AUTO
         1 000657   200051 450500                    STP0    ACTCNT+4,,AUTO
         1 000660   200006 236100                    LDQ     STA$,,AUTO
         1 000661   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000662   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000663   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000664   000000 701000 xent               TSX1    KQC$ACTSTA
         1 000665   000000 011000                    NOP     0

  11378  1 000666                       BACKINU      null
      435    11382    3   BACKINU:;
      436    11383    3           CALL KQP$UNLOCK (STA$->KQ$STA);

  11383  1 000666   200006 630500                    EPPR0   STA$,,AUTO
         1 000667   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000670   000000 701000 xent               TSX1    KQP$UNLOCK
         1 000671   000000 011000                    NOP     0

  11378  1 000672                       BACKIN       null
      437    11384    3   BACKIN: ;
      438    11385                %LOCK (G=KQ$STREE.GATE);

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:56   
  11386  1 000672   200004 236100                    LDQ     CG$,,AUTO
         1 000673   000075 036003                    ADLQ    61,DU
         1 000674   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 000675   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 000676   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000677   000000 701000 xent               TSX1    HFC$LOCK
         1 000700   000000 011000                    NOP     0

      439    11388    3           IF ACTCNT = KQ$STREE.ACTCNT THEN GOTO NXT;

  11388  1 000701   200004 470500                    LDP0    CG$,,AUTO
         1 000702   000102 236100                    LDQ     66,,PR0
         1 000703   000022 772000                    QRL     18
         1 000704   200045 116100                    CMPQ    ACTCNT,,AUTO
         1 000705   000416 600000 1                  TZE     NXT

      440    11389    3           GOTO SRCH;

  11389  1 000706   000357 710000 1                  TRA     SRCH

      441    11390    3           END;
      442    11391        /**/
      443    11392        /**/
      444    11393                          /*    M$DEACTIVATE
      445    11394                           *
      446    11395                           *
      447    11396                           */
      448    11397    2         IF KEYL ~= 8 THEN

  11397  1 000707   200042 235100                    LDA     KEYL,,AUTO
         1 000710   000010 115007                    CMPA    8,DL
         1 000711   000764 600000 1                  TZE     s:11439

      449    11398    3           DO;

      450    11399    3           IF LDCT$ ~= ADDR(NIL) THEN

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:57   
  11399  1 000712   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000713   000752 600000 1                  TZE     s:11429

      451    11400    4             DO;  /* PRESENT */

      452    11401    4             IF STA$->KQ$STA.TERM THEN

  11401  1 000714   000020 236100                    LDQ     16,,PR0
         1 000715   040000 316003                    CANQ    16384,DU
         1 000716   000731 600000 1                  TZE     s:11413

      453    11402    5               DO;

      454    11403    5               IF NOT VSTA.CTL.ALLTRMS THEN

  11403  1 000717   200032 236100                    LDQ     VSTA+4,,AUTO
         1 000720   020000 316003                    CANQ    8192,DU
         1 000721   000764 601000 1                  TNZ     s:11439

      455    11404    5                IF  NOT VSTA.CTL.ALLDCBS

  11404  1 000722   010000 316003                    CANQ    4096,DU
         1 000723   000455 601000 1                  TNZ     UNXT
         1 000724   000400 316003                    CANQ    256,DU
         1 000725   000455 601000 1                  TNZ     UNXT

      456    11405    5                AND NOT VSTA.CTL.ALLABSENT THEN
      457    11406    6                  DO;

      458    11407    6                  IF FOUND ~= 0 THEN GOTO UDONE;

  11407  1 000726   200043 235100                    LDA     FOUND,,AUTO
         1 000727   000502 601000 1                  TNZ     UDONE

      459    11408    6                  END;

  11408  1 000730   000764 710000 1                  TRA     s:11439
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:58   

      460    11409    5                ELSE GOTO UNXT;
      461    11410    5               END;
      462    11411    4             ELSE /* DCB */
      463    11412    5               DO;

      464    11413    5               IF DCB$->F$DCB.AU = '0'B THEN

  11413  1 000731   200014 471500                    LDP1    DCB$,,AUTO
         1 000732   100031 236100                    LDQ     25,,PR1
         1 000733   200000 316003                    CANQ    65536,DU
         1 000734   000740 601000 1                  TNZ     s:11418

      465    11414    6                 DO;

      466    11415    6                 FOUND=6;

  11415  1 000735   000006 235007                    LDA     6,DL
         1 000736   200043 755100                    STA     FOUND,,AUTO

      467    11416    6                 GOTO UDONE;

  11416  1 000737   000502 710000 1                  TRA     UDONE

      468    11417    6                 END;
      469    11418    5               IF NOT VSTA.CTL.ALLDCBS THEN

  11418  1 000740   200032 236100                    LDQ     VSTA+4,,AUTO
         1 000741   010000 316003                    CANQ    4096,DU
         1 000742   000764 601000 1                  TNZ     s:11439

      470    11419    5                IF  NOT VSTA.CTL.ALLTRMS

  11419  1 000743   020000 316003                    CANQ    8192,DU
         1 000744   000455 601000 1                  TNZ     UNXT
         1 000745   000400 316003                    CANQ    256,DU
         1 000746   000455 601000 1                  TNZ     UNXT
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:59   

      471    11420    5                AND NOT VSTA.CTL.ALLABSENT THEN
      472    11421    6                  DO;

      473    11422    6                  IF FOUND ~= 0 THEN GOTO UDONE;

  11422  1 000747   200043 235100                    LDA     FOUND,,AUTO
         1 000750   000502 601000 1                  TNZ     UDONE

      474    11423    6                  END;

  11423  1 000751   000764 710000 1                  TRA     s:11439

      475    11424    5                ELSE GOTO UNXT;
      476    11425    5               END;
      477    11426    4             END; /* PRESENT */
      478    11427    3           ELSE   /* ABSENT  */
      479    11428    4             DO;

      480    11429    4             IF NOT VSTA.CTL.ALLABSENT THEN

  11429  1 000752   200032 236100                    LDQ     VSTA+4,,AUTO
         1 000753   000400 316003                    CANQ    256,DU
         1 000754   000764 601000 1                  TNZ     s:11439

      481    11430    4              IF  NOT VSTA.CTL.ALLTRMS

  11430  1 000755   020000 316003                    CANQ    8192,DU
         1 000756   000455 601000 1                  TNZ     UNXT
         1 000757   010000 316003                    CANQ    4096,DU
         1 000760   000455 601000 1                  TNZ     UNXT

      482    11431    4              AND NOT VSTA.CTL.ALLDCBS THEN
      483    11432    5                DO;

      484    11433    5                IF FOUND ~= 0 THEN GOTO UDONE;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:60   
  11433  1 000761   200043 235100                    LDA     FOUND,,AUTO
         1 000762   000502 601000 1                  TNZ     UDONE

      485    11434    5                END;

  11434  1 000763   000764 710000 1                  TRA     s:11439

      486    11435    4              ELSE GOTO UNXT;
      487    11436    4             END; /* ABSENT */
      488    11437    3           END;
      489    11438        /**/
      490    11439    2         IF AFPT.DISCONNECT THEN

  11439  1 000764   200020 234100                    SZN     AFPT+2,,AUTO
         1 000765   001052 605000 1                  TPL     s:11460

      491    11440    3           DO;

      492    11441    3           CALL SYMBCHK ALTRET(UNXT);

  11441  1 000766   001240 701000 1                  TSX1    SYMBCHK
         1 000767   000455 702000 1                  TSX2    UNXT

      493    11442    3           IF LDCT$ ~= ADDR(NIL) THEN

  11442  1 000770   200005 236100                    LDQ     LDCT$,,AUTO
         1 000771   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000772   001005 600000 1                  TZE     s:11446

      494    11443    3            IF LDCT$->NK$LDCT.RESCOD = NK_CGTRM THEN

  11443  1 000773   200005 470500                    LDP0    LDCT$,,AUTO
         1 000774   000006 236100                    LDQ     6,,PR0
         1 000775   000017 376007                    ANQ     15,DL
         1 000776   000002 116007                    CMPQ    2,DL
         1 000777   001005 601000 1                  TNZ     s:11446

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:61   
      495    11444    3             IF LDCT$->NK$LDCT.DFLG.LOCAL THEN

  11444  1 001000   000006 236100                    LDQ     6,,PR0
         1 001001   002000 316007                    CANQ    1024,DL
         1 001002   001005 600000 1                  TZE     s:11446

      496    11445    3              FOUND=1;

  11445  1 001003   000001 235007                    LDA     1,DL
         1 001004   200043 755100                    STA     FOUND,,AUTO

      497    11446    3           IF  STA$->KQ$STA.TERM

  11446  1 001005   200006 470500                    LDP0    STA$,,AUTO
         1 001006   000020 236100                    LDQ     16,,PR0
         1 001007   040000 316003                    CANQ    16384,DU
         1 001010   001014 600000 1                  TZE     s:11448
         1 001011   000023 236100                    LDQ     19,,PR0
         1 001012   020000 316007                    CANQ    8192,DL
         1 001013   000455 601000 1                  TNZ     UNXT

      498    11447    3           AND STA$->KQ$STA.DSCREQW THEN GOTO UNXT;
      499    11448    3           IF FOUND <= 0 THEN FOUND=FOUND-1;

  11448  1 001014   200043 235100                    LDA     FOUND,,AUTO
         1 001015   001020 605400 1                  TPNZ    s:11449

  11448  1 001016   000001 336007                    LCQ     1,DL
         1 001017   200043 056100                    ASQ     FOUND,,AUTO

      500    11449    3           STA$->KQ$STA.LOCKCNT=STA$->KQ$STA.LOCKCNT+1;

  11449  1 001020   000020 236100                    LDQ     16,,PR0
         1 001021   000001 036007                    ADLQ    1,DL
         1 001022   000020 552104                    STBQ    16,'04'O,PR0

      501    11450                %UNLOCK (G=STA$->KQ$STA.GATE);
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:62   

  11451  1 001023   200006 236100                    LDQ     STA$,,AUTO
         1 001024   000016 036003                    ADLQ    14,DU
         1 001025   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001026   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001027   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001030   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001031   000000 011000                    NOP     0

      502    11453                %UNLOCK (G=KQ$STREE.GATE);

  11454  1 001032   200004 236100                    LDQ     CG$,,AUTO
         1 001033   000075 036003                    ADLQ    61,DU
         1 001034   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001035   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001037   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001040   000000 011000                    NOP     0

      503    11456    3           CALL KQC$DISCSTA (STA$->KQ$STA,AFPT);

  11456  1 001041   200016 630500                    EPPR0   AFPT,,AUTO
         1 001042   200051 450500                    STP0    ACTCNT+4,,AUTO
         1 001043   200006 236100                    LDQ     STA$,,AUTO
         1 001044   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001045   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001046   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001047   000000 701000 xent               TSX1    KQC$DISCSTA
         1 001050   000000 011000                    NOP     0

      504    11457    3           GOTO BACKINU;

  11457  1 001051   000666 710000 1                  TRA     BACKINU

      505    11458    3           END;
      506    11459        /**/
      507    11460    2         IF AFPT.DSCGO THEN
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:63   

  11460  1 001052   200020 236100                    LDQ     AFPT+2,,AUTO
         1 001053   040000 316003                    CANQ    16384,DU
         1 001054   001117 600000 1                  TZE     s:11480

      508    11461    3           DO;

      509    11462    3           IF NOT STA$->KQ$STA.TERM

  11462  1 001055   000020 236100                    LDQ     16,,PR0
         1 001056   040000 316003                    CANQ    16384,DU
         1 001057   001063 600000 1                  TZE     s:11465
         1 001060   000023 236100                    LDQ     19,,PR0
         1 001061   020000 316007                    CANQ    8192,DL
         1 001062   001066 601000 1                  TNZ     s:11468

      510    11463    3           OR NOT STA$->KQ$STA.DSCREQW THEN
      511    11464    4             DO;

      512    11465    4             FOUND=3;

  11465  1 001063   000003 235007                    LDA     3,DL
         1 001064   200043 755100                    STA     FOUND,,AUTO

      513    11466    4             GOTO UNXT;

  11466  1 001065   000455 710000 1                  TRA     UNXT

      514    11467    4             END;
      515    11468    3           IF FOUND <= 0 THEN FOUND=FOUND-1;

  11468  1 001066   200043 235100                    LDA     FOUND,,AUTO
         1 001067   001072 605400 1                  TPNZ    s:11469

  11468  1 001070   000001 336007                    LCQ     1,DL
         1 001071   200043 056100                    ASQ     FOUND,,AUTO

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:64   
      516    11469    3           STA$->KQ$STA.DSCREQW='0'B;

  11469  1 001072   000002 236000 2                  LDQ     2
         1 001073   000023 356100                    ANSQ    19,,PR0

      517    11470                %UNLOCK (G=STA$->KQ$STA.GATE);

  11471  1 001074   200006 236100                    LDQ     STA$,,AUTO
         1 001075   000016 036003                    ADLQ    14,DU
         1 001076   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001077   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001100   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001101   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001102   000000 011000                    NOP     0

      518    11473                %UNLOCK (G=KQ$STREE.GATE);

  11474  1 001103   200004 236100                    LDQ     CG$,,AUTO
         1 001104   000075 036003                    ADLQ    61,DU
         1 001105   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001106   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001107   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001110   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001111   000000 011000                    NOP     0

      519    11476    3           CALL KCO$DSCTRMGO (STA$->KQ$STA);

  11476  1 001112   200006 630500                    EPPR0   STA$,,AUTO
         1 001113   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001114   000000 701000 xent               TSX1    KCO$DSCTRMGO
         1 001115   000000 011000                    NOP     0

      520    11477    3           GOTO BACKIN;

  11477  1 001116   000672 710000 1                  TRA     BACKIN

      521    11478    3           END;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:65   
      522    11479        /**/
      523    11480    2         CALL SYMBCHK ALTRET(UNXT);

  11480  1 001117   001240 701000 1                  TSX1    SYMBCHK
         1 001120   000455 702000 1                  TSX2    UNXT

      524    11481    2         IF FOUND <= 0 THEN FOUND=FOUND-1;

  11481  1 001121   200043 235100                    LDA     FOUND,,AUTO
         1 001122   001125 605400 1                  TPNZ    s:11482

  11481  1 001123   000001 336007                    LCQ     1,DL
         1 001124   200043 056100                    ASQ     FOUND,,AUTO

      525    11482    2         STA$->KQ$STA.LOCKCNT=STA$->KQ$STA.LOCKCNT+1;

  11482  1 001125   200006 470500                    LDP0    STA$,,AUTO
         1 001126   000020 236100                    LDQ     16,,PR0
         1 001127   000001 036007                    ADLQ    1,DL
         1 001130   000020 552104                    STBQ    16,'04'O,PR0

      526    11483              %UNLOCK (G=STA$->KQ$STA.GATE);

  11484  1 001131   200006 236100                    LDQ     STA$,,AUTO
         1 001132   000016 036003                    ADLQ    14,DU
         1 001133   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001134   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001135   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001136   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001137   000000 011000                    NOP     0

      527    11486              %UNLOCK (G=KQ$STREE.GATE);

  11487  1 001140   200004 236100                    LDQ     CG$,,AUTO
         1 001141   000075 036003                    ADLQ    61,DU
         1 001142   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001143   200050 630500                    EPPR0   ACTCNT+3,,AUTO
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:66   
         1 001144   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001145   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001146   000000 011000                    NOP     0

      528    11489    2         CALL KQC$DACTSTA (STA$->KQ$STA,AFPT);

  11489  1 001147   200016 630500                    EPPR0   AFPT,,AUTO
         1 001150   200051 450500                    STP0    ACTCNT+4,,AUTO
         1 001151   200006 236100                    LDQ     STA$,,AUTO
         1 001152   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001153   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001155   000000 701000 xent               TSX1    KQC$DACTSTA
         1 001156   000000 011000                    NOP     0

      529    11490    2         GOTO BACKINU;

  11490  1 001157   000666 710000 1                  TRA     BACKINU

  11482  1 001160                       DONE         null
      530    11491        /**/
      531    11492        /**/
      532    11493        /**/
      533    11494    2   DONE: ;
      534    11495              %UNLOCK (G=KQ$STREE.GATE);

  11496  1 001160   200004 236100                    LDQ     CG$,,AUTO
         1 001161   000075 036003                    ADLQ    61,DU
         1 001162   200050 756100                    STQ     ACTCNT+3,,AUTO
         1 001163   200050 630500                    EPPR0   ACTCNT+3,,AUTO
         1 001164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001165   000000 701000 xent               TSX1    HFC$UNLOCK
         1 001166   000000 011000                    NOP     0

      535    11498    2         IF FOUND >= 0 THEN

  11498  1 001167   200043 235100                    LDA     FOUND,,AUTO
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:67   
         1 001170   001236 604000 1                  TMI     s:11541

      536    11499    3           DO CASE (FOUND);

  11499  1 001171   000007 115007                    CMPA    7,DL
         1 001172   001174 602005 1                  TNC     s:11499+3,AL
         1 001173   001236 710000 1                  TRA     s:11541
         1 001174   001223 710000 1                  TRA     s:11530
         1 001175   001213 710000 1                  TRA     s:11514
         1 001176   001207 710000 1                  TRA     s:11507
         1 001177   001217 710000 1                  TRA     s:11523
         1 001200   001203 710000 1                  TRA     s:11501
         1 001201   001227 710000 1                  TRA     s:11537
         1 001202   001233 710000 1                  TRA     s:11539

      537    11500    3             CASE (4);

      538    11501    3               B$JIT$->B$JIT.ERR=E_NACTV;

  11501  1 001203   000010 236000 0                  LDQ     E_NACTV
         1 001204   000000 470400 xsym               LDP0    B$JIT$
         1 001205   000012 756100                    STQ     10,,PR0
         1 001206   001236 710000 1                  TRA     s:11541

      539    11502        /*E* ERROR:    KCP-E$NACTV-E
      540    11503             MESSAGE: That station is not active
      541    11504             MESSAGE1: Your control service attempted to perform an
      542    11505                       illegal operation on a deactivated station. */
      543    11506    3             CASE (2);

      544    11507    3               B$JIT$->B$JIT.ERR=E_BSYMA;

  11507  1 001207   000004 236000 0                  LDQ     E_BSYMA
         1 001210   000000 470400 xsym               LDP0    B$JIT$
         1 001211   000012 756100                    STQ     10,,PR0
         1 001212   001236 710000 1                  TRA     s:11541

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:68   
      545    11508        /*E* ERROR:   KCP-E$BSYMA-E
      546    11509             MESSAGE: Illegal operation on symbiont device
      547    11510             DESCRIPTION: Only OUTSYM can get this error.  He has his own
      548    11511                          PMMEs to activate and deactivate his devices while
      549    11512                          they are symbiont. */
      550    11513    3             CASE (1);

      551    11514    3               B$JIT$->B$JIT.ERR=E_NDSCL;

  11514  1 001213   000005 236000 0                  LDQ     E_NDSCL
         1 001214   000000 470400 xsym               LDP0    B$JIT$
         1 001215   000012 756100                    STQ     10,,PR0
         1 001216   001236 710000 1                  TRA     s:11541

      552    11515        /*E* ERROR:   KCP-E$NDSCL-C
      553    11516             MESSAGE: Don't try to disconnect a local device
      554    11517             MESSAGE1: One the targets of an M$DEACTIVATE service request with
      555    11518                       DISCONNECT=YES was not a communications device.  The
      556    11519                       device has been deactivated but cannot be disconnected.
      557    11520             DESCRIPTION: The operation would require wire cutters or some new
      558    11521                          order codes (BURN WIRES ASCII) in the IOM. */
      559    11522    3             CASE (3);

      560    11523    3               B$JIT$->B$JIT.ERR=E_CGNWDR;

  11523  1 001217   000007 236000 0                  LDQ     E_CGNWDR
         1 001220   000000 470400 xsym               LDP0    B$JIT$
         1 001221   000012 756100                    STQ     10,,PR0
         1 001222   001236 710000 1                  TRA     s:11541

      561    11524        /*E* ERROR:   KCP-E$CGNWDR-E
      562    11525             MESSAGE: That STATION isn't awaiting disconnect permission
      563    11526             MESSAGE1: One of the targets of an M$DEACTIVATE service request
      564    11527                       with DSCGO=YES was not waiting for permission to
      565    11528                       disconnect. */
      566    11529    3             CASE (0);

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:69   
      567    11530    3               B$JIT$->B$JIT.ERR=E_NOSTA;

  11530  1 001223   000003 236000 0                  LDQ     E_NOSTA
         1 001224   000000 470400 xsym               LDP0    B$JIT$
         1 001225   000012 756100                    STQ     10,,PR0
         1 001226   001236 710000 1                  TRA     s:11541

      568    11531        /*E* ERROR:  KCP-E$CGAFNS-C
      569    11532             MESSAGE: That STATION does not exist!
      570    11533             MESSAGE1: Your M$ACTIVATE or M$DEACTIVE service specified
      571    11534                       STATION options which resulted in no stations
      572    11535                       being processed. */
      573    11536    3             CASE (5);

      574    11537    3               B$JIT$->B$JIT.ERR=JITERR; /* From a MAKEFPRG failure */

  11537  1 001227   200044 236100                    LDQ     JITERR,,AUTO
         1 001230   000000 470400 xsym               LDP0    B$JIT$
         1 001231   000012 756100                    STQ     10,,PR0
         1 001232   001236 710000 1                  TRA     s:11541

      575    11538    3             CASE(6);

      576    11539    3               B$JIT$->B$JIT.ERR=E_NOTAU;

  11539  1 001233   000001 236000 0                  LDQ     E_NOTAU
         1 001234   000000 470400 xsym               LDP0    B$JIT$
         1 001235   000012 756100                    STQ     10,,PR0

      577    11540    3           END;

      578    11541    2         RETURN;

  11541  1 001236   200036 221300                    LDX1  ! VSTA+8,,AUTO
         1 001237   000001 702211                    TSX2  ! 1,X1

      579    11542        /**/
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:70   
      580    11543    2   SYMBCHK: PROC ALTRET;

  11543  1 001240   200046 741300       SYMBCHK      STX1  ! ACTCNT+1,,AUTO

      581    11544        /**/
      582    11545    3         IF LDCT$ ~= ADDR(NIL) THEN

  11545  1 001241   200005 236100                    LDQ     LDCT$,,AUTO
         1 001242   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001243   001253 600000 1                  TZE     s:11551

      583    11546    3          IF LDCT$->NK$LDCT.DFLG.SYMBIONT THEN

  11546  1 001244   200005 470500                    LDP0    LDCT$,,AUTO
         1 001245   000006 236100                    LDQ     6,,PR0
         1 001246   020000 316007                    CANQ    8192,DL
         1 001247   001253 600000 1                  TZE     s:11551

      584    11547    4            DO;

      585    11548    4            FOUND=2;

  11548  1 001250   000002 235007                    LDA     2,DL
         1 001251   200043 755100                    STA     FOUND,,AUTO

      586    11549    4            ALTRETURN;

  11549  1 001252   000000 702211                    TSX2  ! 0,X1

      587    11550    4            END;
      588    11551    3         RETURN;

  11551  1 001253   000001 702211                    TSX2  ! 1,X1

E_NOTCG
 Sect OctLoc
   0     000   130320 015464                                                    X...
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:71   

E_NOTAU
 Sect OctLoc
   0     001   130320 015474                                                    X...

E_NOTACT
 Sect OctLoc
   0     002   130320 016024                                                    X...

E_NOSTA
 Sect OctLoc
   0     003   130320 022020                                                    X...

E_BSYMA
 Sect OctLoc
   0     004   130320 015514                                                    X...

E_NDSCL
 Sect OctLoc
   0     005   130320 015500                                                    X...

E_NOAURD
 Sect OctLoc
   0     006   130320 015674                                                    X...

E_CGNWDR
 Sect OctLoc
   0     007   130320 022464                                                    X...

E_NACTV
 Sect OctLoc
   0     010   130320 015624                                                    X...

(unnamed)
 Sect OctLoc
   2     000   077040 040040   000000 006000   777777 757777                    ?   ........
      589    11552    3   END SYMBCHK;
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:72   
      590    11553    2   END ACTIVATE;
      591    11554    1   END KCP$PMME;

PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:73   
--  Include file information  --

   KL_SUPER_C.:E05TOU  is referenced.
   NK_LDCT_R.:E05TOU  cannot be made into a system file and is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   NK_SUBS.:E05TOU  is referenced.
   UD_EQU_E.:E05TOU  is referenced.
   NK$LDCT.:E05TOU  is referenced.
   K$RWPARM.:E05TOU  is referenced.
   K_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   KC_CP6.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   KC_ERRORS_C.:E05TOU  is referenced.
   KQ_ERRORS_C.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   KC$CP6V_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   KQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   HF_LOCK_C.:E05TOU  cannot be made into a system file and is referenced.
   KQ_MAC_C.:E05TOU  is referenced.
   KQ_SUBS_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KCP$PMME.
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:74   

 **** Variables and constants ****

  ****  Section 000 RoData KCP$PMME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w STRC        r     1 E_BSYMA                    7-0-0/w STRC        r     1 E_CGNWDR
    10-0-0/w STRC        r     1 E_NACTV                    5-0-0/w STRC        r     1 E_NDSCL
     6-0-0/w STRC        r     1 E_NOAURD                   3-0-0/w STRC        r     1 E_NOSTA
     2-0-0/w STRC        r     1 E_NOTACT                   1-0-0/w STRC        r     1 E_NOTAU
     0-0-0/w STRC        r     1 E_NOTCG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPTCODE                  37-0-0/b BIT         r     1 ACT
    45-0-0/w UBIN        r     1 ACTCNT                    16-0-0/d STRC(288)   r     1 AFPT
     4-0-0/w PTR         r     1 CG$                       14-0-0/w PTR         r     1 DCB$
    43-0-0/w SBIN        r     1 FOUND                     *0-0-0/w UBIN        r     1 FPTCODE
    44-0-0/w BIT         r     1 JITERR                    40-0-0/c CHAR(8)     r     1 KEY
    42-0-0/w UBIN        r     1 KEYL                      40-0-0/c BIT (72)    r     1 KEYR
     5-0-0/w PTR         r     1 LDCT$                      6-0-0/w PTR         r     1 STA$
    10-0-0/d STRC(108)   r     1 UFPT                      26-0-0/w STRC(288)   r     1 VSTA

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 N$DCT$$

  ****  BASED and DCB variables  ****
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:75   

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c ACHR        r     1 B$$CHARS                   0-0-0/d STRC(7560)  r     1 B$JIT
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/d STRC(288)   r     1 FPT$ACTIVATE
     0-0-0/d STRC(108)   r     1 FPT$UNLATCH                0-0-0/d STRC(6516)  r     1 KQ$CG
     0-0-0/d STRC(1296)  r     1 KQ$STA                     0-0-0/d STRC(864)   r     1 NK$LDCT
     0-0-0/w PTR         r     1 NK$LDCT$(0:0)
     0-0-0/w STRC(288)   r     1 VLP$STATION


   Procedure KCP$PMME requires 684 words for executable code.
   Procedure KCP$PMME requires 44 words of local(AUTO) storage.

    No errors detected in file KCP$PMMES.:E05TSI    .
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:76   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:77   
          MINI XREF LISTING

ACT IN PROCEDURE ACTIVATE
     11250**DCL     11266<<ASSIGN  11277<<ASSIGN  11307>>IF
ACT0 IN PROCEDURE ACTIVATE
     11278**LABEL   11267--GOTO
ACTCNT IN PROCEDURE ACTIVATE
     11256**DCL     11301<<ASSIGN  11388>>IF
ACTIVATE
     11248**PROC    11097--CALL
ACTSET
     11220**PROC    11096--CALL    11100--CALL
AFPT
     10917**DCL     11278<<ASSIGN  11381<>CALL    11456<>CALL    11489<>CALL
AFPT.DISCONNECT
     10918**DCL     11439>>IF
AFPT.DSCGO
     10918**DCL     11460>>IF
AFPT.DVBYTE.REREAD
     10917**DCL     10917--REDEF
AFPT.MAKEFPRG
     10919**DCL     11365>>IF
AFPT.MAXRD
     10919**DCL     11356>>IF      11357>>ASSIGN
AFPT.MINRD
     10919**DCL     11354>>IF      11355>>ASSIGN
AFPT.USEAUACCT
     10919**DCL     11368>>ASSIGN
AURDSET
     11175**PROC    11084--CALL    11092--CALL
AUSET
     11196**PROC    11088--CALL    11113--CALL    11120--CALL
B$$CHARS IN PROCEDURE ACTIVATE
     11257**DCL     11283<<ASSIGN  11283>>ASSIGN  11291>>IF      11291>>IF      11293>>IF      11293>>IF
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:78   
B$JIT.DCB$
     10895**DCL     11144>>ASSIGN  11149<<ASSIGN
B$JIT.ERR
     10805**DCL     11110<>CALL    11130<<ASSIGN  11153<<ASSIGN  11180<<ASSIGN  11201<<ASSIGN  11225<<ASSIGN
     11374>>ASSIGN  11501<<ASSIGN  11507<<ASSIGN  11514<<ASSIGN  11523<<ASSIGN  11530<<ASSIGN  11537<<ASSIGN
     11539<<ASSIGN
B$JIT.ERR.MID
     10806**DCL     10806--REDEF
B$JIT$
     11021**DCL     10800--IMP-PTR 11110>>CALL    11130>>ASSIGN  11144>>ASSIGN  11149>>ASSIGN  11153>>ASSIGN
     11180>>ASSIGN  11201>>ASSIGN  11225>>ASSIGN  11374>>ASSIGN  11501>>ASSIGN  11507>>ASSIGN  11514>>ASSIGN
     11523>>ASSIGN  11530>>ASSIGN  11537>>ASSIGN  11539>>ASSIGN
B$PS0$
     11018**DCL     10778--IMP-PTR 10782--IMP-PTR 11109>>ASSIGN  11261>>IF      11263>>CALL    11263>>CALL
     11278>>ASSIGN
B$PS1$
     11019**DCL     10789--IMP-PTR 11279>>ASSIGN  11282>>ASSIGN
B$PS2$
     11020**DCL     11377<>CALL    11378>>CALL
BACKIN IN PROCEDURE ACTIVATE
     11378**LABEL   11477--GOTO
BACKINU IN PROCEDURE ACTIVATE
     11378**LABEL   11457--GOTO    11490--GOTO
CG$
     10908**DCL      9676--IMP-PTR 11093>>CALL    11164<<ASSIGN  11165>>CALL    11263>>CALL    11286>>CALL
     11288>>CALL    11301>>ASSIGN  11363>>CALL    11386>>CALL    11388>>IF      11454>>CALL    11474>>CALL
     11487>>CALL    11496>>CALL
DCB$
     10915**DCL     11144<<ASSIGN  11145>>IF      11146>>IF      11148<<ASSIGN  11148>>ASSIGN  11149>>ASSIGN
     11151>>IF      11162>>ASSIGN  11178>>IF      11178>>IF      11199>>IF      11223>>IF      11223>>IF
     11340>>IF      11413>>IF
DEACTIVATE IN PROCEDURE ACTIVATE
     11275**ENTRY   11101--CALL
DONE IN PROCEDURE ACTIVATE
     11482**LABEL   11290--GOTO    11292--GOTO    11333--GOTO
E_BSYMA
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:79   
     10965**DCL     11507>>ASSIGN
E_CGNWDR
     10983**DCL     11523>>ASSIGN
E_NACTV
     10989**DCL     11501>>ASSIGN
E_NDSCL
     10971**DCL     11514>>ASSIGN
E_NOAURD
     10977**DCL     11180>>ASSIGN
E_NOSTA
     10959**DCL     11530>>ASSIGN
E_NOTACT
     10953**DCL     11225>>ASSIGN
E_NOTAU
     10947**DCL     11130>>ASSIGN  11201>>ASSIGN  11539>>ASSIGN
E_NOTCG
     10941**DCL     11153>>ASSIGN
F$DCB.ACTPOS
      6656**DCL      6656--REDEF
F$DCB.ARS
      6631**DCL      6631--REDEF
F$DCB.ASN
      6646**DCL     11151>>IF
F$DCB.ATTR
      6649**DCL      6650--REDEF
F$DCB.AU
      6642**DCL     11199>>IF      11223>>IF      11340>>IF      11413>>IF
F$DCB.BORROW
      6664**DCL      6664--REDEF    6664--REDEF    6664--REDEF
F$DCB.CFU$
      6665**DCL     11148>>ASSIGN
F$DCB.DCBNAME.L
      6678**DCL      6678--IMP-SIZ
F$DCB.EOMCHAR
      6635**DCL      6635--REDEF
F$DCB.FCD
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:80   
      6644**DCL     11145>>IF
F$DCB.FFLG.AU
      6637**DCL     11178>>IF
F$DCB.FFLG.AURD
      6637**DCL     11178>>IF
F$DCB.FFLG.TCTL
      6637**DCL     11223>>IF
F$DCB.FLDID
      6659**DCL      6659--REDEF
F$DCB.FORM$
      6653**DCL      6653--REDEF
F$DCB.FSECT
      6669**DCL      6669--REDEF
F$DCB.FSN
      6646**DCL      6646--REDEF    6646--REDEF    6647--REDEF
F$DCB.HEADER$
      6652**DCL      6652--REDEF
F$DCB.IASN
      6672**DCL     11146>>IF
F$DCB.IXTNSIZE
      6650**DCL      6650--REDEF
F$DCB.LASTSTA$
      6640**DCL      6640--REDEF
F$DCB.LDCTX
      6653**DCL     11162>>ASSIGN
F$DCB.LVL
      6665**DCL      6665--REDEF
F$DCB.NAME.C
      6640**DCL      6640--REDEF
F$DCB.NOEOF
      6661**DCL      6661--REDEF
F$DCB.NRECS
      6651**DCL      6651--REDEF
F$DCB.NRECX
      6670**DCL      6670--REDEF
F$DCB.OHDR
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:81   
      6662**DCL      6662--REDEF
F$DCB.ORG
      6645**DCL      6645--REDEF
F$DCB.PRECNO
      6668**DCL      6668--REDEF
F$DCB.RCSZ
      6673**DCL      6673--REDEF
F$DCB.RES
      6641**DCL      6641--REDEF
F$DCB.SETX
      6653**DCL      6653--REDEF
F$DCB.TAB$
      6652**DCL      6653--REDEF
F$DCB.TDA
      6667**DCL      6667--REDEF
F$DCB.WSN
      6642**DCL      6642--REDEF
FOUND IN PROCEDURE ACTIVATE
     11254**DCL     11284<<ASSIGN  11296>>IF      11328>>IF      11342<<ASSIGN  11348>>IF      11352>>IF
     11352<<ASSIGN  11352>>ASSIGN  11373<<ASSIGN  11407>>IF      11415<<ASSIGN  11422>>IF      11433>>IF
     11445<<ASSIGN  11448>>IF      11448<<ASSIGN  11448>>ASSIGN  11465<<ASSIGN  11468>>IF      11468<<ASSIGN
     11468>>ASSIGN  11481>>IF      11481<<ASSIGN  11481>>ASSIGN  11498>>IF      11499>>DOCASE  11548<<ASSIGN
FPT$ACTIVATE
     10782**DCL     11278>>ASSIGN
FPT$ACTIVATE.ATTR
     10785**DCL     11263<>CALL
FPT$ACTIVATE.CONNECTRES
     10784**DCL     11261>>IF
FPT$ACTIVATE.DVBYTE.REREAD
     10782**DCL     10782--REDEF
FPT$ACTIVATE.RES
     10784**DCL     11263<>CALL
FPT$UNLATCH
     10778**DCL     11109>>ASSIGN
FPTCODE
      9596**DCL        14--PROC    11081>>DOCASE
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:82   
FRA$CGCON
     10998**DCL-ENT 11263--CALL
GOT1 IN PROCEDURE ACTIVATE
     11301**LABEL   11297--GOTO
HFC$LOCK
      2885**DCL-ENT 11286--CALL    11304--CALL    11386--CALL
HFC$UNLOCK
      2885**DCL-ENT 11318--CALL    11331--CALL    11360--CALL    11363--CALL    11451--CALL    11454--CALL
     11471--CALL    11474--CALL    11484--CALL    11487--CALL    11496--CALL
HFF$NILERASE
     10999**DCL-ENT 11377--CALL
JERR IN PROCEDURE ACTIVATE
     11373**LABEL   11378--CALLALT
JITERR IN PROCEDURE ACTIVATE
     11255**DCL     11374<<ASSIGN  11537>>ASSIGN
KCD$PFPRG
     11002**DCL-ENT 11378--CALL
KCD$TFPRG
     11003**DCL-ENT 11371--CALL
KCO$DSCTRMGO
     11004**DCL-ENT 11476--CALL
KEY IN PROCEDURE ACTIVATE
     11251**DCL     11252--REDEF   11283--ASSIGN  11288<>CALL    11296>>IF      11302<<ASSIGN
KEYL IN PROCEDURE ACTIVATE
     11253**DCL     11257--IMP-SIZ 11281<<CALLBLT 11282>>IF      11283>>ASSIGN  11283>>ASSIGN  11291>>IF
     11291>>IF      11293>>IF      11293>>IF      11322>>IF      11369>>IF      11397>>IF
KEYR IN PROCEDURE ACTIVATE
     11252**DCL     11280<<ASSIGN
KIS$OSI_ATTACH
     11005**DCL-ENT 11114--CALL
KIS$OSI_DETACH
     11006**DCL-ENT 11121--CALL
KQ$CG
      9676**DCL     11093<>CALL    11165<>CALL    11263<>CALL
KQ$CG.AUCTL.DVBYTE.REREAD
     10119**DCL     10120--REDEF
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:83   
KQ$CG.STREE
     10008**DCL     11288<>CALL
KQ$CG.STREE.ACTCNT
     10023**DCL     11301>>ASSIGN  11388>>IF
KQ$CG.STREE.GATE
     10010**DCL     11286<>CALL    11363<>CALL    11386<>CALL    11454<>CALL    11474<>CALL    11487<>CALL
     11496<>CALL
KQ$STA
     10414**DCL     11110<>CALL    11371<>CALL    11378<>CALL    11381<>CALL    11383<>CALL    11456<>CALL
     11476<>CALL    11489<>CALL
KQ$STA.ACTTYC
     10466**DCL     10470--REDEF
KQ$STA.BTN.FLINK$
     10448**DCL     11299>>ASSIGN
KQ$STA.BTN.KEY
     10450**DCL     11291--IF      11293--IF      11295>>IF      11296>>IF      11302>>ASSIGN
KQ$STA.DCBLNK$
     10473**DCL     10476--REDEF   10480--REDEF
KQ$STA.DSCREQW
     10589**DCL     11446>>IF      11462>>IF      11469<<ASSIGN
KQ$STA.EVCNT
     10559**DCL     10562--REDEF
KQ$STA.EVNT
     10525**DCL     10529--REDEF   10532--REDEF
KQ$STA.GATE
     10492**DCL     11304<>CALL    11318<>CALL    11331<>CALL    11360<>CALL    11451<>CALL    11471<>CALL
     11484<>CALL
KQ$STA.IDSC
     10494**DCL     11314>>IF
KQ$STA.LDCT$
     10455**DCL     11306>>ASSIGN
KQ$STA.LOCKCNT
     10548**DCL     11353<<ASSIGN  11353>>ASSIGN  11449<<ASSIGN  11449>>ASSIGN  11482<<ASSIGN  11482>>ASSIGN
KQ$STA.MAXRD
     10661**DCL     11357<<ASSIGN
KQ$STA.MINRD
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:84   
     10657**DCL     11355<<ASSIGN
KQ$STA.OPNBLKED
     10586**DCL     10589--REDEF
KQ$STA.OPNREJ
     10592**DCL     10594--REDEF
KQ$STA.SUCCREAD
     10515**DCL     10519--REDEF
KQ$STA.TCOUNT
     10644**DCL     10650--REDEF
KQ$STA.TERM
     10510**DCL     11323>>IF      11401>>IF      11446>>IF      11462>>IF
KQ$STA.USEAUACCT
     10617**DCL     11368<<ASSIGN
KQ$STA.VGOT$
     10629**DCL     10633--REDEF   10637--REDEF
KQB$SRCH
     11007**DCL-ENT 11288--CALL
KQC$ACTSTA
     11008**DCL-ENT 11381--CALL
KQC$CGCTL
     11009**DCL-ENT 11089--CALL
KQC$DACTSTA
     11010**DCL-ENT 11489--CALL
KQC$DISCSTA
     11011**DCL-ENT 11456--CALL
KQF$FWCG
     11012**DCL-ENT 11085--CALL
KQI$CGINFO
     11013**DCL-ENT 11093--CALL
KQP$UNLOCK
     11014**DCL-ENT 11383--CALL
KQU$UNLATCH
     11015**DCL-ENT 11110--CALL
KQX$LDASR
     11016**DCL-ENT 11165--CALL
KQ_IMBLK.DVE.EOMCHAR
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:85   
      3560**DCL      3562--REDEF
KQ_IMBLK.KEY1
      3486**DCL      3488--REDEF
KQ_IMBLK.KEY2
      3495**DCL      3513--REDEF
KQ_IMBLK.LNK$
      3460**DCL      3462--REDEF    3468--REDEF    3472--REDEF
KQ_IMBLK.TYC
      3609**DCL      3611--REDEF
KQ_IMBLK.XSP.MREQ$
      3515**DCL      3519--REDEF
KQ_IRBLK.BUF$
      3064**DCL      3066--REDEF
KQ_IRBLK.CNACTD
      2978**DCL      2987--REDEF
KQ_IRBLK.DBLKX
      3084**DCL      3088--REDEF
KQ_IRBLK.EOFNONE
      2956**DCL      2959--REDEF
KQ_IRBLK.FROMQ
      2962**DCL      2965--REDEF
KQ_IRBLK.KEY1R
      3003**DCL      3004--REDEF
KQ_IRBLK.KEY2R
      3008**DCL      3009--REDEF
KQ_IRBLK.LATCH
      2951**DCL      2953--REDEF
KQ_IRBLK.LWRITES$
      3095**DCL      3099--REDEF
KQ_IRBLKT.CNACTD
      3164**DCL      3173--REDEF
KQ_IRBLKT.DBLK$
      3227**DCL      3231--REDEF    3234--REDEF
KQ_IRBLKT.EOFNONE
      3142**DCL      3145--REDEF
KQ_IRBLKT.FROMQ
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:86   
      3148**DCL      3151--REDEF
KQ_IRBLKT.KEY1R
      3189**DCL      3190--REDEF
KQ_IRBLKT.KEY2R
      3194**DCL      3195--REDEF
KQ_IRBLKT.LATCH
      3137**DCL      3139--REDEF
K_RWPARM_CON.BLKREC
      5844**DCL      5869--REDEF
K_RWPARM_CON.BLKREC.BLKU#
      5845**DCL      5847--REDEF
K_RWPARM_CON.BLKREC.RECU#
      5857**DCL      5859--REDEF
K_RWPARM_CON.DVE.DVBYTE.VFC
      5884**DCL      5885--REDEF
K_RWPARM_CON.DVE.EOMCHAR
      5892**DCL      5896--REDEF
K_RWPARM_CON.ERR
      5956**DCL      5961--REDEF
K_RWPARM_CON.FC
      5920**DCL      5921--REDEF
K_RWPARM_CON.FLDID
      6102**DCL      6103--REDEF
K_RWPARM_CON.FPT$
      5983**DCL      5990--REDEF
K_RWPARM_CON.KEYTYPE
      6109**DCL      6110--REDEF
K_RWPARM_CON.MSG$
      5819**DCL      5825--REDEF
K_RWPARM_CON.MSGID
      5931**DCL      5936--REDEF
K_RWPARM_CON.MSGIDXT
      5944**DCL      5948--REDEF
K_RWPARM_CON.ORG
      6080**DCL      6081--REDEF
K_RWPARM_CON.THDRSZ
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:87   
      6024**DCL      6028--REDEF
K_RWPARM_CON.VDOFLGS
      6082**DCL      6093--REDEF
LDCT$
     10909**DCL      9628--IMP-PTR 11162<<ASSIGN  11163>>ASSIGN  11164>>ASSIGN  11306<<ASSIGN  11314>>IF
     11365>>IF      11365>>IF      11399>>IF      11442>>IF      11443>>IF      11444>>IF      11545>>IF
     11546>>IF
N$DCT$$
      6686**DCL      6686--IMP-PTR 11162>>ASSIGN
NK$LDCT.CG$
      9659**DCL     11164>>ASSIGN
NK$LDCT.DDT$
      9630**DCL      9630--REDEF
NK$LDCT.DFLG.LOCAL
      9634**DCL     11444>>IF
NK$LDCT.DFLG.SYMBIONT
      9633**DCL     11546>>IF
NK$LDCT.IOQ$
      9629**DCL      9630--REDEF
NK$LDCT.LDCTX
      9631**DCL      9631--REDEF
NK$LDCT.LKFLG.ABORTED
      9643**DCL      9644--REDEF
NK$LDCT.RESCOD
      9636**DCL     11365>>IF      11443>>IF
NK$LDCT.RLCID.LDCTX
      9653**DCL      9653--REDEF
NK$LDCT.STA$
      9649**DCL      9650--REDEF   11163>>ASSIGN
NK$LDCT.SYMB$
      9628**DCL      9628--REDEF    9628--REDEF    9629--REDEF
NK$LDCT.TERMID.TTYP
      9656**DCL     11365>>IF
NK$LDCT$
      6686**DCL     11162>>ASSIGN
NOMAX IN PROCEDURE ACTIVATE
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:88   
     11357**LABEL   11356--GOTO
NOMIN IN PROCEDURE ACTIVATE
     11356**LABEL   11354--GOTO
NOTAU
     11112**LABEL   11085--CALLALT
NOTCG IN PROCEDURE USET
     11153**LABEL   11145--GOTO
NXT IN PROCEDURE ACTIVATE
     11299**LABEL   11320--GOTO    11388--GOTO
SRCH IN PROCEDURE ACTIVATE
     11288**LABEL   11389--GOTO
STA$
     10910**DCL     10414--IMP-PTR 11085<>CALL    11089<>CALL    11110>>CALL    11163<<ASSIGN  11288<>CALL
     11290>>IF      11291>>IF      11293>>IF      11295>>IF      11296>>IF      11299<<ASSIGN  11299>>ASSIGN
     11302>>ASSIGN  11304>>CALL    11306>>ASSIGN  11314>>IF      11318>>CALL    11323>>IF      11331>>CALL
     11353>>ASSIGN  11353>>ASSIGN  11355>>ASSIGN  11357>>ASSIGN  11360>>CALL    11368>>ASSIGN  11371>>CALL
     11378>>CALL    11381>>CALL    11383>>CALL    11401>>IF      11446>>IF      11446>>IF      11449>>ASSIGN
     11449>>ASSIGN  11451>>CALL    11456>>CALL    11462>>IF      11462>>IF      11469>>ASSIGN  11471>>CALL
     11476>>CALL    11482>>ASSIGN  11482>>ASSIGN  11484>>CALL    11489>>CALL
SYMBCHK IN PROCEDURE ACTIVATE
     11543**PROC    11313--CALL    11441--CALL    11480--CALL
TRANSFORM IN PROCEDURE ACTIVATE
     11371**LABEL   11377--CALLALT
UDB$PMMEXIT
     11017**DCL-ENT 11160--CALL    11185--CALL    11209--CALL    11234--CALL
UDONE IN PROCEDURE ACTIVATE
     11329**LABEL   11343--GOTO    11348--GOTO    11407--GOTO    11416--GOTO    11422--GOTO    11433--GOTO
UFPT
     10912**DCL     11109<<ASSIGN  11110<>CALL
UNXT IN PROCEDURE ACTIVATE
     11316**LABEL   11313--CALLALT 11336--GOTO    11350--GOTO    11409--GOTO    11424--GOTO    11435--GOTO
     11441--CALLALT 11447--GOTO    11466--GOTO    11480--CALLALT
USET
     11142**PROC    11104--CALL    11177--CALL    11198--CALL    11222--CALL
VLP$STATION
     10789**DCL     11282>>ASSIGN
PL6.E3A0      #001=KCP$PMME File=KCP$PMMES.:E05TSI                               WED 07/30/97 00:18 Page:89   
VLP$STATION.MSGIDXT
     10795**DCL     10797--REDEF
VLP$STATION.STATION
     10793**DCL     11279>>ASSIGN  11378<>CALL
VSTA
     10924**DCL     11282<<ASSIGN
VSTA.CTL.ALLABSENT
     10930**DCL     11404>>IF      11419>>IF      11429>>IF
VSTA.CTL.ALLDCBS
     10929**DCL     11326>>IF      11345>>IF      11404>>IF      11418>>IF      11430>>IF
VSTA.CTL.ALLTRMS
     10929**DCL     11325>>IF      11346>>IF      11369>>IF      11403>>IF      11419>>IF      11430>>IF
VSTA.MSGIDXT
     10930**DCL     10932--REDEF
VSTA.STATION
     10928**DCL     11279<<ASSIGN  11281>>CALLBLT 11283--ASSIGN  11291--IF      11293--IF
