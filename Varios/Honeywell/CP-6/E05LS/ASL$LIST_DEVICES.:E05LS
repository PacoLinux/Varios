VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:1    
        1        1        /*M* ASL$LIST_ALL_DEVICES: Routine to list devices.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_DEVICES: PROC ;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_DEVICES
       13       13             CALL:     CALL ASL$LIST_ALL_DEVICES ;
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_DEVICES is the routine that
       17       17                           lists device names and calls the display
       18       18                           device routine.
       19       19                           This routine will read the following records
       20       20                           from :HLP  :
       21       21                                 device records - keys 'xxxxxxxx*'
       22       22                                 device records - keys 'xxxxxxxx'
       23       23                                 device records - keys 'xxxxxxxxxxxxxxxxxxxx'
       24       24                                 station records - keys 'xxxxxxxxSTATION'
       25       25                                 TERM record - keys 'TERM'
       26       26                                 TWSN records - keys 'TWSN9999'
       27       27                            And the device record from :CONFIG whose
       28       28                            key is 'term9999' where term is 4 characters of
       29       29                            device name and 9999 is 4 digits of subdevice
       30       30                            number.
       31       31                            Of the above records only the device records
       32       32                            are sure to be read in, the reading of the others
       33       33                            is dependent upon the actual command that was
       34       34                            input.
       35       35                       MEMORY UTILIZATION.
       36       36                            If the station clause was specified on the input
       37       37                            command, then the TERM record will be read into
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:2    
       38       38                            data segment 1 and the TWSNxxxx record will be
       39       39                            read into data segment 2.
       40       40                            If the terminal clause was specified on the input
       41       41                            command, then the terminals record will be read
       42       42                            into data segment 1 and the TWSNxxxx record will
       43       43                            be read into data segment 2.
       44       44                            The individual device records will be read into
       45       45                            data segment 3.
       46       46        */
       47       47        /********************************************************************/
       48       48        /*   Include files   include files   include files   include files  */
       49       49        /********************************************************************/
       50       50        %INCLUDE AS_PERR_C;
       51      652        %INCLUDE AS_SUPER_C;
       52     1087        %INCLUDE AS_SUBS_C;
       53     2501        %INCLUDE AS_MAC_C;
       54     2581        %INCLUDE AS_ENTRIES_M;
       55     3631        %INCLUDE AS_SSUBS_C;
       56     3723        %INCLUDE B_ERRORS_C;
       57     4850        %INCLUDE CP_6;
       58     4931        %INCLUDE CP_6_SUBS;
       59     5471        %INCLUDE KL_CONFIG_M;
       60     6233        %INCLUDE KL_MACRO_C;
       61     9585        %INCLUDE KL_SUPER_C;
       62    12487        %INCLUDE XU_MACRO_C;
       63    15593        %INCLUDE XU_FORMAT_C;
       64    15755        %INCLUDE OCI_SUBS_C;
       65    15853        %INCLUDE AS_SUPER_R;
       66    18869        /********************************************************************/
       67    18870        /*   Equs            equs            equs            equs           */
       68    18871        /********************************************************************/
       69    18872        %EQU SINGLE_DEVICE = 0;
       70    18873        %EQU SINGLE_TPDEVICE = 1;
       71    18874        %EQU DEV_WILD = 2;
       72    18875        %EQU TPDEV_WILD = 3;
       73    18876        %EQU TERMINAL = 4;
       74    18877        %EQU TERMINAL_WILD = 5;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:3    
       75    18878        %EQU STATION = 6;
       76    18879        %EQU STATION_WILD = 7;
       77    18880        %EQU ALL = 8;
       78    18881        /********************************************************************/
       79    18882        /*   Static data     static data     static data     static data    */
       80    18883        /********************************************************************/
       81    18884        %KL$CONFIG_KEY  ( NAME = CONFIG_KEY, STCLASS = STATIC);
       82    18931    1   DCL LINCNFG_BUF (0:49)   UBIN WORD STATIC INIT(0*0);
       83    18932    1   DCL LINCNFG$             PTR STATIC INIT (ADDR(LINCNFG_BUF));
       84    18933        %KL$LINCNFG     ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
       85    19091        %KL_SS;
       86    19126        /********************************************************************/
       87    19127        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       88    19128        /********************************************************************/
       89    19129        %ASA$ERROR ;
       90    19132        %ASB$BOF_HLP ;
       91    19135        %ASB$CHECK_TYPE ;
       92    19138        %ASB$GET_NEXT_STATION ;
       93    19141        %ASB$INIT_GET_STATION ;
       94    19144        %ASB$PREC_AND_SKIP_HLP ;
       95    19147        %ASB$PREC_HLP ;
       96    19150        %ASB$READ_HLP ;
       97    19153        %ASB$READ_HLP_SEQ ;
       98    19156        %ASB$WILD_MATCH ;
       99    19159        %ASB$WRITE_LO ;
      100    19162        %ASH$ERROR ;
      101    19165        %ASL$DISP_ONE_DEVICE ;
      102    19168        %ASL$FORMAT_DEVNAME ;
      103    19171    1   DCL X$FORMAT ENTRY(1);
      104    19172        /********************************************************************/
      105    19173        /*   Local based     local based     local based     local based    */
      106    19174        /********************************************************************/
      107    19175        %KL_DREC      ( NAME = KL$TREC, STCLASS = "BASED(DSEG3$)", LAST = ",");
      108    19288        %KL_GJOB      ( NAME = GJOB, STCLASS = BASED, LVL = 2, LAST = "," );
      109    19312        %KL_HASP      ( NAME = HASP, STCLASS = BASED, LVL = 2 );
      110    19462        %KL_TWSNREC   ( NAME = KL$TWSNREC, STCLASS = "BASED(DSEG2$)");
      111    19487        %KL_DREC      ( NAME = KL$DREC, LAST = ";", STCLASS = BASED) ;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:4    
      112    19600        %KL_WSNCVT    ( NAME = KL$WSNCVT, STCLASS = "BASED(DSEG1$)");
      113    19607        %PARSE$OUT    ( NAME = P$B, STCLASS = BASED,
      114    19608                        NDTYPE = TYPE);
      115    19653        %PARSE$SYM    ( NAME = OUT$SYM, STCLASS = "BASED(BLK$)" );
      116    19691        /********************************************************************/
      117    19692        /*   Auto data       auto data       auto data       auto data      */
      118    19693        /********************************************************************/
      119    19694    1   DCL ACCT                     CHAR(8);
      120    19695    1   DCL ACCT_LEN                 UBIN;
      121    19696    1   DCL ARS                      SBIN;
      122    19697    1   DCL 1 BEGIN_KEY,
      123    19698    1          2 COUNT               UBIN BYTE UNAL,
      124    19699    1          2 TEXT                CHAR(20) UNAL;
      125    19700    1   DCL BLK$                     PTR;
      126    19701    1   DCL CHECK                    BIT(1);
      127    19702    1   DCL COUNT                    UBIN WORD ;
      128    19703    1   DCL DEVICE_NAME_WILD         BIT(1);
      129    19704    1   DCL 1 DEV_NAME,
      130    19705    1          2 COUNT               UBIN BYTE UNAL,
      131    19706    1          2 TEXT                CHAR(8) UNAL,
      132    19707    1          2 *                   CHAR(33) UNAL;
      133    19708    1   DCL DEV_TYPE                 UBIN;
      134    19709    1   DCL DISP                     BIT(1);
      135    19710    1   DCL DISP_DEVICES             UBIN;
      136    19711    1   DCL 1 END_KEY,
      137    19712    1          2 COUNT               UBIN BYTE UNAL,
      138    19713    1          2 TEXT                CHAR(20) UNAL;
      139    19714    1   DCL I                        SBIN;
      140    19715    1   DCL JCL                      BIT(1);
      141    19716    1   DCL K                        SBIN;
      142    19717    1   DCL 1 LAST_KEY,
      143    19718    1          2 COUNT  UBIN BYTE UNAL,
      144    19719    1          2 TEXT   CHAR(41) UNAL;
      145    19720    1   DCL MATCH_LEN                UBIN;
      146    19721    1   DCL NAME                     CHAR(12);
      147    19722    1   DCL NAME_LEN                 UBIN;
      148    19723    1   DCL OPTION_CODE              UBIN;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:5    
      149    19724    1   DCL 1 STATION_NAME,
      150    19725    1          2 COUNT               UBIN BYTE UNAL,
      151    19726    1          2 TEXT                CHAR(8) UNAL;
      152    19727    1   DCL 1 TERMINAL_NAME,
      153    19728    1          2 COUNT               UBIN BYTE UNAL,
      154    19729    1          2 TEXT                CHAR(8) UNAL;
      155    19730    1   DCL 1 TPDEV,
      156    19731    1          2 COUNT               UBIN BYTE UNAL,
      157    19732    1          2 ACCT                CHAR(8) UNAL,
      158    19733    1          2 NAME                CHAR(12) UNAL;
      159    19734    1   DCL TPDEV_ACCT_WILD          BIT(1);
      160    19735    1   DCL TPDEV_NAME_SPECIFIED     BIT(1);
      161    19736    1   DCL TPDEV_NAME_WILD          BIT(1);
      162    19737    1   DCL TPDEV_SPECIFIED          BIT(1);
      163    19738    1   DCL TWSN_CHAR                CHAR(4);
      164    19739    1   DCL TWSN_NUMBER              UBIN;
      165    19740        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:6    
      166    19741        /********************************************************************/
      167    19742        /*   Constant data   constant data   constant data   constant data  */
      168    19743        /********************************************************************/
      169    19744    1   DCL DEVICE_STR CHAR(0) CONSTANT INIT ('device');
      170    19745    1   DCL DEVICES_STR CHAR(0) CONSTANT INIT ('devices');
      171    19746    1   DCL DISPLAY_STR CHAR(0) CONSTANT INIT ('displayed');
      172    19747    1   DCL LIST_STR CHAR(0) CONSTANT INIT ('listed');
      173    19748        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:7    
      174    19749        /********************************************************************/
      175    19750        /*   Procedure       procedure       procedure       procedure      */
      176    19751        /********************************************************************/
      177    19752    1   JCL = %NO#;
      178    19753
      179    19754    1   TPDEV_SPECIFIED = %NO#;
      180    19755    1   TPDEV_NAME_SPECIFIED = %NO#;
      181    19756    1   OPTION_CODE = %SINGLE_DEVICE;
      182    19757    1   TPDEV.COUNT = 9;
      183    19758    1   TPDEV.ACCT = '?';
      184    19759    1   TPDEV.NAME = '?';
      185    19760    1   DEV_NAME.COUNT = 1;
      186    19761    1   DEV_NAME.TEXT = '?';
      187    19762    1   STATION_NAME.COUNT = 1;
      188    19763    1   STATION_NAME.TEXT = '?';
      189    19764    1   TERMINAL_NAME.COUNT = 1;
      190    19765    1   TERMINAL_NAME.TEXT = '?';
      191    19766    1   DISP_DEVICES = 0;
      192    19767
      193    19768    2   DO I = 0 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      194    19769
      195    19770    2      CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      196    19771
      197    19772    3      DO SELECT (CODE);
      198    19773
      199    19774    3         SELECT ( %LIST_ALL_VAL );
      200    19775
      201    19776    3         DISP = %NO#;
      202    19777    3         OPTION_CODE = %ALL ;
      203    19778    3         CHECK = %NO#;
      204    19779    3         DEV_TYPE = %AS_CG_DEV#;
      205    19780
      206    19781    3         SELECT ( %DISPLAY_ALL_VAL );
      207    19782
      208    19783    3         DISP = %YES#;
      209    19784    3         OPTION_CODE = %ALL ;
      210    19785    3         CHECK = %NO#;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:8    
      211    19786    3         DEV_TYPE = %AS_CG_DEV#;
      212    19787    3         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN
      213    19788    4         DO K = 0 TO P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS - 1;
      214    19789    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(K)->P$B.CODE = %JCL_VAL THEN
      215    19790    4               JCL = %YES#;
      216    19791    4            END;
      217    19792
      218    19793    3         SELECT (%DISPLAY_TPDEV_VAL, %LIST_TPDEV_VAL);
      219    19794
      220    19795    3         DISP = (CODE = %DISPLAY_TPDEV_VAL);
      221    19796    3         DEV_TYPE = AS_TP_DEV#;
      222    19797    3         CHECK = %YES#;
      223    19798    3         TPDEV_SPECIFIED = %YES#;
      224    19799
      225    19800    3         SELECT (%TPDEV_ACCT_WILD_VAL);
      226    19801
      227    19802    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      228    19803    3         TPDEV.COUNT = OUT$SYM.COUNT;
      229    19804    3         TPDEV.ACCT = OUT$SYM.TEXT;
      230    19805
      231    19806    3         SELECT (%TPDEV_NAME_WILD_VAL);
      232    19807
      233    19808    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      234    19809    3         TPDEV.COUNT = OUT$SYM.COUNT + 8;
      235    19810    3         TPDEV.NAME = OUT$SYM.TEXT;
      236    19811    3         TPDEV_NAME_SPECIFIED = %YES#;
      237    19812
      238    19813    3         SELECT (%DISPLAY_DEVICE_VAL, %LIST_DEVICE_VAL);
      239    19814
      240    19815    3         DISP = (CODE = %DISPLAY_DEVICE_VAL);
      241    19816    3         DEV_TYPE = %AS_CG_DEV#;
      242    19817    3         CHECK = %NO#;
      243    19818
      244    19819    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN DO;
      245    19820    4            DEV_TYPE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$B.CODE;
      246    19821    4            CHECK = %YES#;
      247    19822    4            END; /*  Nsublks > 0  */
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:9    
      248    19823
      249    19824    3         SELECT (%DEVICE_NAME_WILD_VAL);
      250    19825
      251    19826    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      252    19827    3         DEV_NAME.COUNT = OUT$SYM.COUNT;
      253    19828    3         DEV_NAME.TEXT = OUT$SYM.TEXT;
      254    19829
      255    19830    3         SELECT (%STATION_NAME_WILD_VAL);
      256    19831
      257    19832    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      258    19833    3         STATION_NAME.COUNT = OUT$SYM.COUNT;
      259    19834    3         STATION_NAME.TEXT = OUT$SYM.TEXT;
      260    19835    3         OPTION_CODE = %STATION;
      261    19836    3         CALL INDEX (K, '?', STATION_NAME.TEXT)
      262    19837    4         WHENRETURN DO;
      263    19838    4            OPTION_CODE = %STATION_WILD;
      264    19839    4            END; /*  Whenreturn  */
      265    19840
      266    19841    3         SELECT (%TERMINAL_NAME_WILD_VAL);
      267    19842
      268    19843    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);
      269    19844    3         TERMINAL_NAME.COUNT = OUT$SYM.COUNT;
      270    19845    3         TERMINAL_NAME.TEXT = OUT$SYM.TEXT;
      271    19846    3         OPTION_CODE = %TERMINAL;
      272    19847    3         CALL INDEX (K, '?', TERMINAL_NAME.TEXT)
      273    19848    4         WHENRETURN DO;
      274    19849    4            OPTION_CODE = %TERMINAL_WILD;
      275    19850    4            END; /*  Whenreturn  */
      276    19851
      277    19852    3         SELECT (%JCL_VAL);
      278    19853
      279    19854    3         JCL = %YES#;
      280    19855
      281    19856    3         END;  /*  Do select on code  */
      282    19857
      283    19858    2      END;  /*  Do i  */
      284    19859
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:10   
      285    19860    1   FDS.NVECS# = 0;
      286    19861    2   IF JCL THEN DO;
      287    19862    2      CALL CONCAT (FMT_BUF, '%1/"', DEVICES_STR, '%1/');
      288    19863    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 6;
      289    19864    2      END;   /*  Jcl  */
      290    19865    2   ELSE DO;
      291    19866    2      CALL CONCAT (FMT_BUF, '%1/', DEVICES_STR, '%1/');
      292    19867    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 5;
      293    19868    2      END;  /*  Not jcl  */
      294    19869    1   FDS.TABDFLT# = 10;
      295    19870    1   CALL X$FORMAT (FDS);
      296    19871
      297    19872    1   IF OPTION_CODE = %SINGLE_DEVICE THEN
      298    19873    2      IF TPDEV_SPECIFIED THEN DO;
      299    19874    3         IF TPDEV_NAME_SPECIFIED THEN DO;
      300    19875    3            OPTION_CODE = %SINGLE_TPDEVICE;
      301    19876    3            TPDEV_ACCT_WILD = %NO#;
      302    19877    3            CALL INDEX (I, '?', TPDEV.ACCT)
      303    19878    4            WHENRETURN DO;
      304    19879    4               TPDEV_ACCT_WILD = %YES#;
      305    19880    4               OPTION_CODE = %TPDEV_WILD;
      306    19881    4               END; /*  Whenreturn  */
      307    19882    3            TPDEV_NAME_WILD = %NO#;
      308    19883    3            CALL INDEX (I, '?', TPDEV.NAME)
      309    19884    4            WHENRETURN DO;
      310    19885    4               TPDEV_NAME_WILD = %YES#;
      311    19886    4               OPTION_CODE = %TPDEV_WILD;
      312    19887    4               END; /*  Whenreturn  */
      313    19888    3            END; /* TPDEV_NAME specified  */
      314    19889    3         ELSE DO;
      315    19890    3            TPDEV_ACCT_WILD = %YES#;
      316    19891    3            TPDEV_NAME_WILD = %YES#;
      317    19892    3            OPTION_CODE = %TPDEV_WILD;
      318    19893    3            END; /*  Else  */
      319    19894    2         END;  /*  Tpdev specified  */
      320    19895    2      ELSE DO;
      321    19896    2         DEVICE_NAME_WILD = %NO#;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:11   
      322    19897    2         CALL INDEX (I, '?', DEV_NAME.TEXT)
      323    19898    3         WHENRETURN DO;
      324    19899    3            DEVICE_NAME_WILD = %YES#;
      325    19900    3            OPTION_CODE = %DEV_WILD;
      326    19901    3            END; /*  Whenreturn  */
      327    19902    2         END;  /*  Tpdev not specified  */
      328    19903
      329    19904    1   IF OPTION_CODE = %DEV_WILD THEN
      330    19905    1      IF DEV_NAME.TEXT = '?' THEN
      331    19906    1         OPTION_CODE = %ALL;
      332    19907    2      ELSE DO; END;
      333    19908    1   ELSE IF OPTION_CODE = %TPDEV_WILD THEN
      334    19909    1         IF TPDEV.ACCT = '?' AND TPDEV.NAME = '?' THEN
      335    19910    1            OPTION_CODE = %ALL;
      336    19911
      337    19912    2   DO SELECT  (OPTION_CODE);
      338    19913
      339    19914    2      SELECT  (%ALL); /*  List/display all devices  */
      340    19915
      341    19916    2      CALL ASB$BOF_HLP;
      342    19917    3      DO FOREVER;
      343    19918    3   NEXT: ARS = DSEG3SIZE;
      344    19919    3         CALL ASB$READ_HLP_SEQ( DSEG3$, ARS, 3 )
      345    19920    4         WHENRETURN DO;
      346    19921    4            CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(NEXT);
      347    19922    4            DEV_NAME = USERS_KEY;
      348    19923    5            IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      349    19924    6               IF DISP THEN DO;
      350    19925    6                  CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      351    19926    6                  CALL ASB$WRITE_LO  (' ',1);
      352    19927    6                  END;   /*  Disp  */
      353    19928    6               ELSE DO; /*  list out the device name  */
      354    19929    6                  CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      355    19930    6                  END; /*  List  */
      356    19931    5               DISP_DEVICES = DISP_DEVICES + 1;
      357    19932    5               END;  /*  The right type  */
      358    19933    5            IF DEV_NAME ~= USERS_KEY THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:12   
      359    19934    5               USERS_KEY = DEV_NAME;
      360    19935    5               CALL ASB$PREC_AND_SKIP_HLP;
      361    19936    5               END; /*  DEV_NAME ~= USERS_KEY  */
      362    19937    4            END; /*  Whenreturn  */
      363    19938    4         WHENALTRETURN DO;
      364    19939    4            IF MERR_CODE.CODE ~= %E$EOF THEN
      365    19940    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      366    19941    4            GOTO FINISH_UP;
      367    19942    4            END; /*  Whenaltreturn  */
      368    19943    3         END; /*  Do forever  */
      369    19944
      370    19945    2      SELECT  (%STATION_WILD);
      371    19946
      372    19947    2      CALL ASB$INIT_GET_STATION;
      373    19948    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;
      374    19949    3         CALL INDEX (NAME_LEN, ' ', KL$WSNCVT.WSN(TWSN_NUMBER));
      375    19950    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;
      376    19951    3         MATCH_LEN = STATION_NAME.COUNT;
      377    19952    3         CALL ASB$WILD_MATCH (NAME_LEN,KL$WSNCVT.WSN(TWSN_NUMBER),MATCH_LEN,
             19952                  STATION_NAME.TEXT) ALTRET (NEXT_STATION);
      378    19953    3         CALL ASB$GET_NEXT_STATION (TWSN_NUMBER) ALTRET (FINISH_UP);
      379    19954    4         DO I = 0 TO KL$TWSNREC.NDEV - 1;
      380    19955    5            IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;
      381    19956    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      382    19957    6                  NAME_LEN = 4;
      383    19958    6                  USERS_KEY.COUNT = 8;
      384    19959    6                  END; /*  A tdev  */
      385    19960    6               ELSE DO;          /* Not a tdev         */
      386    19961    6                  CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));
      387    19962    6                  USERS_KEY.COUNT = 9;
      388    19963    6                  END; /*  Not a tdev  */
      389    19964    5               MATCH_LEN = DEV_NAME.COUNT;
      390    19965    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME
             19965                        .TEXT)
      391    19966    6               WHENRETURN DO;
      392    19967    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      393    19968    6                  ARS = DSEG3SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:13   
      394    19969    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION1);
      395    19970    6                  CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(
             19970                           NO_REC_FOR_STATION1);
      396    19971    7                  IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      397    19972    7                     IF ~ DISP THEN
      398    19973    7                        CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      399    19974    8                     ELSE DO;
      400    19975    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      401    19976    8                        CALL ASB$WRITE_LO  (' ',1);
      402    19977    8                        END;   /*  Disp  */
      403    19978    7                     DISP_DEVICES = DISP_DEVICES + 1;
      404    19979    7                     END; /*  The right type  */
      405    19980    6                  END; /*  Whenreturn  */
      406    19981    5               END; /*  Not iom connected  */
      407    19982    4   NO_REC_FOR_STATION1:
      408    19983    4            END; /*  Do ndevs times  */
      409    19984    3   NEXT_STATION:
      410    19985    3         END; /*  Do ltwsn  */
      411    19986    2      GOTO FINISH_UP;
      412    19987
      413    19988    2      SELECT  (%STATION);
      414    19989
      415    19990    2      USERS_KEY.COUNT = 15;
      416    19991    2      CALL CONCAT( USERS_KEY.TXTC, STATION_NAME.TEXT, 'STATION' );
      417    19992    2      ARS = DSEG1SIZE;
      418    19993    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ALT3 );
      419    19994    2      USERS_KEY.COUNT = 8;
      420    19995    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );
      421    19996    2      ARS = DSEG2SIZE;
      422    19997    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      423    19998    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;
      424    19999    4         IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;
      425    20000    5            IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      426    20001    5               NAME_LEN = 4;
      427    20002    5               USERS_KEY.COUNT = 8;
      428    20003    5               END; /*  A tdev  */
      429    20004    5            ELSE DO;          /* Not a tdev         */
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:14   
      430    20005    5               CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));
      431    20006    5               USERS_KEY.COUNT = 9;
      432    20007    5               END; /*  Not a tdev  */
      433    20008    4            MATCH_LEN = DEV_NAME.COUNT;
      434    20009    4            CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             20009                     TEXT)
      435    20010    5            WHENRETURN DO;
      436    20011    5               CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      437    20012    5               ARS = DSEG3SIZE;
      438    20013    5               CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION2);
      439    20014    5               CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(NO_REC_FOR_STATION2)
             20014                        ;
      440    20015    6               IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      441    20016    7                  IF ~ DISP THEN DO;
      442    20017    7                     CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      443    20018    7                     END; /*  ~disp  */
      444    20019    7                  ELSE DO;
      445    20020    7                     CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      446    20021    7                     CALL ASB$WRITE_LO (' ',1);
      447    20022    7                     END;   /*  Disp  */
      448    20023    6                  DISP_DEVICES = DISP_DEVICES + 1;
      449    20024    6                  END; /*  The right type  */
      450    20025    5               END; /*  Whenreturn  */
      451    20026    4            END; /*  Not iom connected  */
      452    20027    3   NO_REC_FOR_STATION2:
      453    20028    3         END; /*  Do ndevs times  */
      454    20029    2      GOTO FINISH_UP;
      455    20030
      456    20031    2      SELECT  (%TERMINAL_WILD);
      457    20032
      458    20033    2      USERS_KEY.COUNT = 4;
      459    20034    2      USERS_KEY.TXTC = 'TERM';
      460    20035    2      ARS = DSEG1SIZE;
      461    20036    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );
      462    20037    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;
      463    20038    4         IF KL$WSNCVT.WSN(TWSN_NUMBER) ~= ' ' THEN DO;
      464    20039    4            USERS_KEY.COUNT = 8;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:15   
      465    20040    4            CALL BINCHAR (TWSN_CHAR, TWSN_NUMBER);
      466    20041    4            CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSN_CHAR );
      467    20042    4            ARS = DSEG2SIZE;
      468    20043    4            CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      469    20044    5            DO I = 0 TO KL$TWSNREC.NDEV - 1;
      470    20045    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      471    20046    6                  MATCH_LEN = DEV_NAME.COUNT;
      472    20047    6                  CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             20047                           TEXT)
      473    20048    7                  WHENRETURN DO;
      474    20049    7                     CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));
      475    20050    7                     MATCH_LEN = TERMINAL_NAME.COUNT;
      476    20051    7                     CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             20051                              TERMINAL_NAME.TEXT)
      477    20052    8                     WHENRETURN DO;
      478    20053    8                        USERS_KEY.COUNT = 8;
      479    20054    8                        CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      480    20055    8                        ARS = DSEG3SIZE;
      481    20056    8                        CALL ASB$READ_HLP(DSEG3$, ARS, 3)
      482    20057    9                        WHENRETURN DO;
      483    20058    9                           CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(
             20058                                    NO_REC_FOR_TERM1);
      484    20059   10                           IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      485    20060   11                              IF ~ DISP THEN DO;
      486    20061   11                                 CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      487    20062   11                                 END; /*  ~disp  */
      488    20063   11                              ELSE DO;
      489    20064   11                                 CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      490    20065   11                                 CALL ASB$WRITE_LO (' ',1);
      491    20066   11                                 END; /*  Disp  */
      492    20067   10                              DISP_DEVICES = DISP_DEVICES + 1;
      493    20068   10                              END; /*  The right type  */
      494    20069    9                           END; /*  Whenreturn from READ_HLP of device record  */
      495    20070    9                        WHENALTRETURN DO;
      496    20071        /*E* ERROR: ASL-E$NODEVFORTERM-C
      497    20072             MESSAGE:  Device %U1 does not exist.
      498    20073             MESSAGE1:  It is listed in TWSN %U2 but can't be read from :HLP.
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:16   
      499    20074        */
      500    20075    9                           AS_FIELD1.TEXT = KL$TWSNREC.DEVS.ACCT(I);
      501    20076    9                           AS_FIELD1.COUNT = 4;
      502    20077    9                           AS_FIELD2.TEXT = TWSN_CHAR;
      503    20078    9                           AS_FIELD2.COUNT = 4;
      504    20079                                %SCREAM (ERR#=%E$NODEVFORTERM,LEVEL=ERROR,MID='L');
      505    20094    9                           END; /*  Whenaltreturn from READ_HLP  */
      506    20095    8                        END; /*  Whenreturn from WILD_MATCH of terminal name */
      507    20096    7                     END; /*  Whenreturn  from WILD_MATCH of device name  */
      508    20097    6                  END; /*  A tdev  */
      509    20098    5   NO_REC_FOR_TERM1:
      510    20099    5               END; /*  Do ndevs times  */
      511    20100    4            USERS_KEY.COUNT = 4;
      512    20101    4            USERS_KEY.TXTC = 'TERM';
      513    20102    4            ARS = DSEG1SIZE;
      514    20103    4            CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );
      515    20104    4            END; /*  If station name not blank  */
      516    20105    3         END; /*  Do 0 to KL$WSNCVT.LTWSN  */
      517    20106
      518    20107    2      SELECT  (%TERMINAL);
      519    20108
      520    20109    2      USERS_KEY.COUNT = 9;
      521    20110    2      CALL CONCAT( USERS_KEY.TXTC, TERMINAL_NAME.TEXT, '*' );
      522    20111    2      ARS = DSEG1SIZE;
      523    20112    2      STATION_NAME = TERMINAL_NAME;
      524    20113    2      CALL ASB$READ_HLP( DSEG1$, ARS, 1) ALTRET( READ_ALT3 );
      525    20114    2      CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_TERM#, %NO#, TERMINAL_NAME ) ALTRET(
             20114               FINISH_UP);
      526    20115    2      AS_FIELD1.COUNT = TERMINAL_NAME.COUNT;
      527    20116    2      AS_FIELD1.TEXT = TERMINAL_NAME.TEXT;
      528    20117    2      AS_FIELD2.COUNT = 8;
      529    20118    2      AS_FIELD2.TEXT = 'TERMINAL';
      530    20119    2      USERS_KEY.COUNT = 8;
      531    20120    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );
      532    20121    2      ARS = DSEG2SIZE;
      533    20122    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );
      534    20123    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:17   
      535    20124    3         USERS_KEY.COUNT = 8;
      536    20125    4         IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */
      537    20126    4            MATCH_LEN = DEV_NAME.COUNT;
      538    20127    4            CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.TEXT)
      539    20128    5            WHENRETURN DO;
      540    20129    5               CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));
      541    20130    5               MATCH_LEN = TERMINAL_NAME.COUNT;
      542    20131    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             20131                        TERMINAL_NAME.TEXT)
      543    20132    6               WHENRETURN DO;
      544    20133    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');
      545    20134    6                  ARS = DSEG3SIZE;
      546    20135    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_TERM2);
      547    20136    6                  CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(NO_REC_FOR_TERM2)
             20136                           ;
      548    20137    7                  IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      549    20138    8                     IF ~ DISP THEN DO;
      550    20139    8                        CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      551    20140    8                        END; /*  ~disp  */
      552    20141    8                     ELSE DO;
      553    20142    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      554    20143    8                        CALL ASB$WRITE_LO (' ',1);
      555    20144    8                        END; /*  Disp  */
      556    20145    7                     DISP_DEVICES = DISP_DEVICES + 1;
      557    20146    7                     END; /*  The right type  */
      558    20147    6                  END; /*  Whenreturn  */
      559    20148    5               END; /*  Whenreturn  */
      560    20149    4            END; /*  A tdev  */
      561    20150    3   NO_REC_FOR_TERM2:
      562    20151    3         END; /*  Do ndevs times  */
      563    20152
      564    20153    2      SELECT  (%TPDEV_WILD);
      565    20154
      566    20155                 /*  Setup begin key  */
      567    20156                 /*  Setup end key  */
      568    20157    2      CALL INDEX (I,'?',TPDEV.ACCT);
      569    20158    2      BEGIN_KEY.TEXT = SUBSTR (TPDEV.ACCT,0,I);
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:18   
      570    20159    2      CALL CONCAT (END_KEY.TEXT,SUBSTR (TPDEV.ACCT,0,I),'~');
      571    20160    2      CALL INDEX (I,'?',TPDEV.NAME);
      572    20161    2      SUBSTR (BEGIN_KEY.TEXT,8,I) = SUBSTR (TPDEV.NAME,0,I);
      573    20162    2      BEGIN_KEY.COUNT = 8+I;
      574    20163    2      END_KEY.COUNT = 8+I+1;
      575    20164    2      SUBSTR (END_KEY.TEXT,8,I) = SUBSTR (TPDEV.NAME,0,I);
      576    20165    2      IF END_KEY.COUNT < 21 THEN
      577    20166    2         SUBSTR (END_KEY.TEXT,8+I,1) = '~';
      578    20167    2      USERS_KEY = BEGIN_KEY;
      579    20168    2      CALL ASB$PREC_HLP;
      580    20169    2      ARS = DSEG3SIZE;
      581    20170    3      CALL ASB$READ_HLP_SEQ (DSEG3$,ARS,3) WHENRETURN DO;
      582    20171    3         LAST_KEY = USERS_KEY;
      583    20172    4         DO WHILE USERS_KEY.TXTC < END_KEY.TEXT;
      584    20173    4            CALL ASB$CHECK_TYPE (DSEG3$, ARS, DEV_TYPE)
      585    20174    5            WHENRETURN DO;
      586    20175    6               IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;
      587    20176        /*  Calculate ACCT_LEN and MATCH_LEN  */
      588    20177    6                  CALL INDEX (ACCT_LEN,' ',USERS_KEY.TXTC);
      589    20178    6                  IF ACCT_LEN > 7 THEN ACCT_LEN = 8;
      590    20179    6                  ELSE IF ACCT_LEN = 0 THEN ACCT_LEN = 1;
      591    20180    6                  CALL INDEX (MATCH_LEN,' ',TPDEV.ACCT);
      592    20181    6                  IF MATCH_LEN > 7 THEN MATCH_LEN = 8;
      593    20182    6                  ELSE IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      594    20183    6                  ACCT = SUBSTR (USERS_KEY.TXTC,0,ACCT_LEN);
      595    20184    6                  CALL ASB$WILD_MATCH (ACCT_LEN,ACCT,MATCH_LEN,TPDEV.ACCT)
      596    20185    7                  WHENRETURN DO;
      597    20186        /*  Calculate NAME_LEN and MATCH_LEN  */
      598    20187    7                     CALL INDEX (NAME_LEN,' ',USERS_KEY.TXTC,8);
      599    20188    7                     IF NAME_LEN > 19 THEN NAME_LEN = 12;
      600    20189    7                     ELSE IF NAME_LEN = 8 THEN NAME_LEN = 1;
      601    20190    7                        ELSE NAME_LEN = NAME_LEN - 8;
      602    20191    7                     CALL INDEX (MATCH_LEN,' ',TPDEV.NAME);
      603    20192    7                     IF MATCH_LEN > 11 THEN MATCH_LEN = 12;
      604    20193    7                     ELSE IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      605    20194    7                     NAME = SUBSTR (USERS_KEY.TXTC,8,NAME_LEN);
      606    20195    7                     CALL ASB$WILD_MATCH (NAME_LEN,NAME,MATCH_LEN,TPDEV.NAME)
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:19   
      607    20196    8                     WHENRETURN DO;
      608    20197    9                        IF DISP THEN DO;
      609    20198    9                           CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      610    20199    9                           CALL ASB$WRITE_LO (' ',1);
      611    20200    9                           END;  /* Disp  */
      612    20201    9                        ELSE DO;
      613    20202    9                           CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      614    20203    9                           END; /*  List  */
      615    20204    8                        DISP_DEVICES = DISP_DEVICES + 1;
      616    20205    8                        END; /*  Whenreturn from ASB$WILD_MATCH on name  */
      617    20206    7                     END; /*  Whenreturn from ASB$WILD_MATCH on acct  */
      618    20207    6                  END; /*  Not check or .SUPER=DEV_TYPE  */
      619    20208    5               END; /*  Whenreturn from ASB$CHECK_TYPE  */
      620    20209    5            IF LAST_KEY ~= USERS_KEY THEN DO;
      621    20210    5               USERS_KEY = LAST_KEY;
      622    20211    5               CALL ASB$PREC_AND_SKIP_HLP;
      623    20212    5               END; /*  Last ~= users  */
      624    20213    4            ARS = DSEG3SIZE;
      625    20214    4            CALL ASB$READ_HLP_SEQ (DSEG3$, ARS, 3) ALTRET(FINISH_UP);
      626    20215    4            LAST_KEY = USERS_KEY ;
      627    20216    4            END; /*  Do while USERS_KEY < END_KEY  */
      628    20217    3         END; /*  Whenreturn from ASB$READ_HLP_SEQ  */
      629    20218
      630    20219    2      SELECT  (%SINGLE_TPDEVICE);
      631    20220
      632    20221    2      ARS = DSEG3SIZE;
      633    20222    2      USERS_KEY = TPDEV;
      634    20223    2      CALL INDEX (I,' ',TPDEV.ACCT);
      635    20224    2      CALL INDEX (COUNT,' ',TPDEV.NAME);
      636    20225    2      CALL CONCAT (AS_FIELD1.TEXT,SUBSTR(TPDEV.ACCT,0,I),',',SUBSTR(TPDEV.NAME,0,COUNT)
             20225               );
      637    20226    2      AS_FIELD1.COUNT = I + COUNT + 1;
      638    20227    3      CALL ASB$READ_HLP (DSEG3$, ARS, 3) WHENALTRETURN DO;
      639    20228              %SCREAM (ERR#=E$DEV_NO_EXIST2,LEVEL=ERROR,MID='L');
      640    20243    3         RETURN;
      641    20244    3         END; /*   Whenreturn from ASB$READ_HLP  */
      642    20245    3      IF KL$TREC.SUPER = DEV_TYPE THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:20   
      643    20246    4         IF DISP THEN DO;
      644    20247    4            CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      645    20248    4            CALL ASB$WRITE_LO (' ',1);
      646    20249    4            END;  /*  Disp  */
      647    20250    4         ELSE DO;
      648    20251    4            CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      649    20252    4            END; /*  List  */
      650    20253    3         DISP_DEVICES = DISP_DEVICES + 1;
      651    20254    3         END; /*  KL$TREC.SUPER = DEV_TYPE  */
      652    20255
      653    20256    2      SELECT  (%DEV_WILD);
      654    20257
      655    20258                 /*  Setup begin key  */
      656    20259                 /*  Setup end key  */
      657    20260    2      CALL INDEX (I,'?',DEV_NAME.TEXT);
      658    20261    2      BEGIN_KEY.TEXT = SUBSTR (DEV_NAME.TEXT,0,I);
      659    20262    2      CALL CONCAT (END_KEY.TEXT,SUBSTR (DEV_NAME.TEXT,0,I),'~');
      660    20263    2      BEGIN_KEY.COUNT = 8;
      661    20264    2      END_KEY.COUNT = 8;
      662    20265    2      USERS_KEY = BEGIN_KEY;
      663    20266    2      CALL ASB$PREC_HLP;
      664    20267    2      ARS = DSEG3SIZE;
      665    20268    3      CALL ASB$READ_HLP_SEQ (DSEG3$,ARS,3) WHENRETURN DO;
      666    20269    3         LAST_KEY = USERS_KEY;
      667    20270    4         DO WHILE USERS_KEY.TXTC < END_KEY.TEXT;
      668    20271    4            CALL ASB$CHECK_TYPE (DSEG3$, ARS, DEV_TYPE)
      669    20272    5            WHENRETURN DO;
      670    20273    6               IF NOT CHECK OR KL$TREC.SUPER = DEV_TYPE THEN DO;
      671    20274        /*  Calculate ACCT_LEN and MATCH_LEN  */
      672    20275    6                  CALL INDEX (ACCT_LEN,' ',USERS_KEY.TXTC);
      673    20276    6                  IF ACCT_LEN > 7 THEN ACCT_LEN = 8;
      674    20277    6                  ELSE IF ACCT_LEN = 0 THEN ACCT_LEN = 1;
      675    20278    6                  CALL INDEX (MATCH_LEN,' ',DEV_NAME.TEXT);
      676    20279    6                  IF MATCH_LEN > 7 THEN MATCH_LEN = 8;
      677    20280    6                  ELSE IF MATCH_LEN = 0 THEN MATCH_LEN = 1;
      678    20281    6                  ACCT = SUBSTR (USERS_KEY.TXTC,0,ACCT_LEN);
      679    20282    6                  CALL ASB$WILD_MATCH (ACCT_LEN,ACCT,MATCH_LEN,DEV_NAME.TEXT)
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:21   
      680    20283    7                  WHENRETURN DO;
      681    20284    8                     IF DISP THEN DO;
      682    20285    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      683    20286    8                        CALL ASB$WRITE_LO (' ',1);
      684    20287    8                        END;   /*  Disp  */
      685    20288    8                     ELSE DO;
      686    20289    8                        CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      687    20290    8                        END; /*  List  */
      688    20291    7                     DISP_DEVICES = DISP_DEVICES + 1;
      689    20292    7                     END; /*  Whenreturn from ASB$WILD_MATCH on acct  */
      690    20293    6                  END; /*  Not check or .SUPER = DEV_TYPE  */
      691    20294    5               END; /*  Whenreturn from ASB$CHECK_TYPE  */
      692    20295    5            IF LAST_KEY ~= USERS_KEY THEN DO;
      693    20296    5               USERS_KEY = LAST_KEY;
      694    20297    5               CALL ASB$PREC_AND_SKIP_HLP;
      695    20298    5               END;  /*  Last ~= users  */
      696    20299    4            ARS = DSEG3SIZE;
      697    20300    4            CALL ASB$READ_HLP_SEQ (DSEG3$, ARS, 3) ALTRET(FINISH_UP);
      698    20301    4            LAST_KEY = USERS_KEY;
      699    20302    4            END; /*  Do while USERS_KEY < END_KEY  */
      700    20303    3         END; /*  Whenreturn from ASB$READ_HLP_SEQ  */
      701    20304
      702    20305    2      SELECT  (%SINGLE_DEVICE);
      703    20306
      704    20307    2      USERS_KEY.COUNT = 9;
      705    20308    2      CALL CONCAT( USERS_KEY.TXTC, DEV_NAME.TEXT, '*' );
      706    20309    2      ARS = DSEG3SIZE;
      707    20310    2      CALL ASB$READ_HLP( DSEG3$, ARS, 3) ALTRET(RD_ALT2);
      708    20311    2      CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE, %NO#, DEV_NAME ) ALTRET(FINISH_UP);
      709    20312    3      IF NOT CHECK OR KL$TREC.SUPER = DEV_TYPE THEN DO;
      710    20313    4         IF DISP THEN DO;
      711    20314    4            CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );
      712    20315    4            CALL ASB$WRITE_LO (' ',1);
      713    20316    4            END;   /*  Disp  */
      714    20317    4         ELSE DO;
      715    20318    4            CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
      716    20319    4            END; /*  List  */
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:22   
      717    20320    3         DISP_DEVICES = DISP_DEVICES + 1;
      718    20321    3         END;  /*  Not check or KL$TREC.SUPER = DEV_TYPE  */
      719    20322
      720    20323    2      END; /*  Do case (OPTION_CODE)  */
      721    20324
      722    20325    2   DO NEVER;
      723    20326    2   RD_ALT2:
      724    20327    3      IF MERR_CODE.CODE = %E$NOKEY THEN DO;
      725    20328        /*E*  ERROR:  ASL-E$DEV_NO_EXIST2-C
      726    20329              MESSAGE: %U1 does not exist.
      727    20330              MESSAGE1: The specified DEVICE does not exist.
      728    20331        */
      729    20332    3         AS_FIELD1 = DEV_NAME;
      730    20333              %SCREAM( ERR#=E$DEV_NO_EXIST2, LEVEL=ERROR, MID='L' );
      731    20348    3         END; /*  Error  */
      732    20349    2      ELSE CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      733    20350    2      GOTO FINISH_UP;
      734    20351
      735    20352    3   READ_ALT3: IF MERR_CODE.CODE = %E$NOKEY THEN DO;
      736    20353    3         AS_FIELD1.COUNT = STATION_NAME.COUNT;
      737    20354    3         AS_FIELD1.TEXT  = STATION_NAME.TEXT;
      738    20355              %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='L' );
      739    20370    3         END;  /*  No such key error  */
      740    20371    2      ELSE
      741    20372    2   READ_ERR: CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      742    20373    2      END;  /*  Do never  */
      743    20374    1   FINISH_UP:
      744    20375    2   IF NOT DISP THEN DO;
      745    20376    2      FMT_BUF = '%\%/';
      746    20377    2      FDS.FMT_.BOUND = 3;
      747    20378    2      FDS.NVECS# = 0;
      748    20379    2      CALL X$FORMAT (FDS);
      749    20380    2      END; /*  If not disp  */
      750    20381    2   IF NOT JCL THEN DO;
      751    20382    2      FMT_VEC(0) = VECTOR (DISP_DEVICES);
      752    20383    2      IF DISP_DEVICES = 1 THEN
      753    20384    3      DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:23   
      754    20385    3         FMT_VEC(1) = VECTOR (DEVICE_STR);
      755    20386    3         END; /*  DISP_DEVICES = 1  */
      756    20387    3      ELSE DO;
      757    20388    3         FMT_VEC(1) = VECTOR (DEVICES_STR);
      758    20389    3         END; /*  DISP_DEVICES ~= 1  */
      759    20390    2      IF DISP THEN
      760    20391    3      DO;
      761    20392    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      762    20393    3         END; /*  If disp  */
      763    20394    3      ELSE DO;
      764    20395    3         FMT_VEC(2) = VECTOR (LIST_STR);
      765    20396    3         END; /*  If ~ disp  */
      766    20397    2      FDS.NVECS# = 3;
      767    20398    2      FMT_BUF = '   %5D %A %A.';
      768    20399    2      FDS.FMT_.BOUND = 12;
      769    20400    2      CALL X$FORMAT(FDS);
      770    20401    2      END; /* Not jcl */
      771    20402    1   RETURN;
      772    20403    1   END ASL$LIST_ALL_DEVICES;
      773    20404        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:24   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_DEVICES.

   Procedure ASL$LIST_ALL_DEVICES requires 1838 words for executable code.
   Procedure ASL$LIST_ALL_DEVICES requires 82 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:25   

 Object Unit name= ASL$LIST_ALL_DEVICES                       File name= ASL$LIST_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:07:29.72 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none    63     77  ASL$LIST_ALL_DEVICES
    3  RoData even  UTS     24     30  ASL$LIST_ALL_DEVICES
    4   Proc  even  none  1838   3456  ASL$LIST_ALL_DEVICES
    5  RoData even  none    38     46  ASL$LIST_ALL_DEVICES

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASL$LIST_ALL_DEVICES
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:26   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       0 ASB$BOF_HLP
         yes           Std       2 ASB$WRITE_LO
         yes           Std       2 ASL$FORMAT_DEVNAME
 yes     yes           Std       0 ASB$PREC_AND_SKIP_HLP
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP_SEQ
         yes           Std       2 ASL$DISP_ONE_DEVICE
         yes           Std       3 ASA$ERROR
 yes     yes           Std       0 ASB$INIT_GET_STATION
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       0 ASB$PREC_HLP
 yes     yes           Std       4 ASB$WILD_MATCH
         yes           Std       2 ASH$ERROR
 yes     yes           Std       5 ASB$CHECK_TYPE
 yes     yes           Std       1 ASB$GET_NEXT_STATION
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:27   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             FDS
     FMT_BUF                               FMT_VEC                               CODE
     ERR_CODE                              AS_FIELD1                             AS_FIELD2
     REMEM_VAR                             REM_FCMD                              ASA_BRKS_LOC
     DSEG1$                                DSEG1SIZE                             DSEG2$
     DSEG2SIZE                             DSEG3$                                DSEG3SIZE
     P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:28   


        1        1        /*M* ASL$LIST_ALL_DEVICES: Routine to list devices.    */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_DEVICES: PROC ;

      9  4 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         4 000001   000122 000000                    ZERO    82,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_DEVICES
       13       13             CALL:     CALL ASL$LIST_ALL_DEVICES ;
       14       14             INPUT:    None.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_DEVICES is the routine that
       17       17                           lists device names and calls the display
       18       18                           device routine.
       19       19                           This routine will read the following records
       20       20                           from :HLP  :
       21       21                                 device records - keys 'xxxxxxxx*'
       22       22                                 device records - keys 'xxxxxxxx'
       23       23                                 device records - keys 'xxxxxxxxxxxxxxxxxxxx'
       24       24                                 station records - keys 'xxxxxxxxSTATION'
       25       25                                 TERM record - keys 'TERM'
       26       26                                 TWSN records - keys 'TWSN9999'
       27       27                            And the device record from :CONFIG whose
       28       28                            key is 'term9999' where term is 4 characters of
       29       29                            device name and 9999 is 4 digits of subdevice
       30       30                            number.
       31       31                            Of the above records only the device records
       32       32                            are sure to be read in, the reading of the others
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:29   
       33       33                            is dependent upon the actual command that was
       34       34                            input.
       35       35                       MEMORY UTILIZATION.
       36       36                            If the station clause was specified on the input
       37       37                            command, then the TERM record will be read into
       38       38                            data segment 1 and the TWSNxxxx record will be
       39       39                            read into data segment 2.
       40       40                            If the terminal clause was specified on the input
       41       41                            command, then the terminals record will be read
       42       42                            into data segment 1 and the TWSNxxxx record will
       43       43                            be read into data segment 2.
       44       44                            The individual device records will be read into
       45       45                            data segment 3.
       46       46        */
       47       47        /********************************************************************/
       48       48        /*   Include files   include files   include files   include files  */
       49       49        /********************************************************************/
       50       50        %INCLUDE AS_PERR_C;
       51      652        %INCLUDE AS_SUPER_C;
       52     1087        %INCLUDE AS_SUBS_C;
       53     2501        %INCLUDE AS_MAC_C;
       54     2581        %INCLUDE AS_ENTRIES_M;
       55     3631        %INCLUDE AS_SSUBS_C;
       56     3723        %INCLUDE B_ERRORS_C;
       57     4850        %INCLUDE CP_6;
       58     4931        %INCLUDE CP_6_SUBS;
       59     5471        %INCLUDE KL_CONFIG_M;
       60     6233        %INCLUDE KL_MACRO_C;
       61     9585        %INCLUDE KL_SUPER_C;
       62    12487        %INCLUDE XU_MACRO_C;
       63    15593        %INCLUDE XU_FORMAT_C;
       64    15755        %INCLUDE OCI_SUBS_C;
       65    15853        %INCLUDE AS_SUPER_R;
       66    18869        /********************************************************************/
       67    18870        /*   Equs            equs            equs            equs           */
       68    18871        /********************************************************************/
       69    18872        %EQU SINGLE_DEVICE = 0;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:30   
       70    18873        %EQU SINGLE_TPDEVICE = 1;
       71    18874        %EQU DEV_WILD = 2;
       72    18875        %EQU TPDEV_WILD = 3;
       73    18876        %EQU TERMINAL = 4;
       74    18877        %EQU TERMINAL_WILD = 5;
       75    18878        %EQU STATION = 6;
       76    18879        %EQU STATION_WILD = 7;
       77    18880        %EQU ALL = 8;
       78    18881        /********************************************************************/
       79    18882        /*   Static data     static data     static data     static data    */
       80    18883        /********************************************************************/
       81    18884        %KL$CONFIG_KEY  ( NAME = CONFIG_KEY, STCLASS = STATIC);
       82    18931    1   DCL LINCNFG_BUF (0:49)   UBIN WORD STATIC INIT(0*0);
       83    18932    1   DCL LINCNFG$             PTR STATIC INIT (ADDR(LINCNFG_BUF));
       84    18933        %KL$LINCNFG     ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
       85    19091        %KL_SS;
       86    19126        /********************************************************************/
       87    19127        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       88    19128        /********************************************************************/
       89    19129        %ASA$ERROR ;
       90    19132        %ASB$BOF_HLP ;
       91    19135        %ASB$CHECK_TYPE ;
       92    19138        %ASB$GET_NEXT_STATION ;
       93    19141        %ASB$INIT_GET_STATION ;
       94    19144        %ASB$PREC_AND_SKIP_HLP ;
       95    19147        %ASB$PREC_HLP ;
       96    19150        %ASB$READ_HLP ;
       97    19153        %ASB$READ_HLP_SEQ ;
       98    19156        %ASB$WILD_MATCH ;
       99    19159        %ASB$WRITE_LO ;
      100    19162        %ASH$ERROR ;
      101    19165        %ASL$DISP_ONE_DEVICE ;
      102    19168        %ASL$FORMAT_DEVNAME ;
      103    19171    1   DCL X$FORMAT ENTRY(1);
      104    19172        /********************************************************************/
      105    19173        /*   Local based     local based     local based     local based    */
      106    19174        /********************************************************************/
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:31   
      107    19175        %KL_DREC      ( NAME = KL$TREC, STCLASS = "BASED(DSEG3$)", LAST = ",");
      108    19288        %KL_GJOB      ( NAME = GJOB, STCLASS = BASED, LVL = 2, LAST = "," );
      109    19312        %KL_HASP      ( NAME = HASP, STCLASS = BASED, LVL = 2 );
      110    19462        %KL_TWSNREC   ( NAME = KL$TWSNREC, STCLASS = "BASED(DSEG2$)");
      111    19487        %KL_DREC      ( NAME = KL$DREC, LAST = ";", STCLASS = BASED) ;
      112    19600        %KL_WSNCVT    ( NAME = KL$WSNCVT, STCLASS = "BASED(DSEG1$)");
      113    19607        %PARSE$OUT    ( NAME = P$B, STCLASS = BASED,
      114    19608                        NDTYPE = TYPE);
      115    19653        %PARSE$SYM    ( NAME = OUT$SYM, STCLASS = "BASED(BLK$)" );
      116    19691        /********************************************************************/
      117    19692        /*   Auto data       auto data       auto data       auto data      */
      118    19693        /********************************************************************/
      119    19694    1   DCL ACCT                     CHAR(8);
      120    19695    1   DCL ACCT_LEN                 UBIN;
      121    19696    1   DCL ARS                      SBIN;
      122    19697    1   DCL 1 BEGIN_KEY,
      123    19698    1          2 COUNT               UBIN BYTE UNAL,
      124    19699    1          2 TEXT                CHAR(20) UNAL;
      125    19700    1   DCL BLK$                     PTR;
      126    19701    1   DCL CHECK                    BIT(1);
      127    19702    1   DCL COUNT                    UBIN WORD ;
      128    19703    1   DCL DEVICE_NAME_WILD         BIT(1);
      129    19704    1   DCL 1 DEV_NAME,
      130    19705    1          2 COUNT               UBIN BYTE UNAL,
      131    19706    1          2 TEXT                CHAR(8) UNAL,
      132    19707    1          2 *                   CHAR(33) UNAL;
      133    19708    1   DCL DEV_TYPE                 UBIN;
      134    19709    1   DCL DISP                     BIT(1);
      135    19710    1   DCL DISP_DEVICES             UBIN;
      136    19711    1   DCL 1 END_KEY,
      137    19712    1          2 COUNT               UBIN BYTE UNAL,
      138    19713    1          2 TEXT                CHAR(20) UNAL;
      139    19714    1   DCL I                        SBIN;
      140    19715    1   DCL JCL                      BIT(1);
      141    19716    1   DCL K                        SBIN;
      142    19717    1   DCL 1 LAST_KEY,
      143    19718    1          2 COUNT  UBIN BYTE UNAL,
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:32   
      144    19719    1          2 TEXT   CHAR(41) UNAL;
      145    19720    1   DCL MATCH_LEN                UBIN;
      146    19721    1   DCL NAME                     CHAR(12);
      147    19722    1   DCL NAME_LEN                 UBIN;
      148    19723    1   DCL OPTION_CODE              UBIN;
      149    19724    1   DCL 1 STATION_NAME,
      150    19725    1          2 COUNT               UBIN BYTE UNAL,
      151    19726    1          2 TEXT                CHAR(8) UNAL;
      152    19727    1   DCL 1 TERMINAL_NAME,
      153    19728    1          2 COUNT               UBIN BYTE UNAL,
      154    19729    1          2 TEXT                CHAR(8) UNAL;
      155    19730    1   DCL 1 TPDEV,
      156    19731    1          2 COUNT               UBIN BYTE UNAL,
      157    19732    1          2 ACCT                CHAR(8) UNAL,
      158    19733    1          2 NAME                CHAR(12) UNAL;
      159    19734    1   DCL TPDEV_ACCT_WILD          BIT(1);
      160    19735    1   DCL TPDEV_NAME_SPECIFIED     BIT(1);
      161    19736    1   DCL TPDEV_NAME_WILD          BIT(1);
      162    19737    1   DCL TPDEV_SPECIFIED          BIT(1);
      163    19738    1   DCL TWSN_CHAR                CHAR(4);
      164    19739    1   DCL TWSN_NUMBER              UBIN;
      165    19740        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:33   
      166    19741        /********************************************************************/
      167    19742        /*   Constant data   constant data   constant data   constant data  */
      168    19743        /********************************************************************/
      169    19744    1   DCL DEVICE_STR CHAR(0) CONSTANT INIT ('device');
      170    19745    1   DCL DEVICES_STR CHAR(0) CONSTANT INIT ('devices');
      171    19746    1   DCL DISPLAY_STR CHAR(0) CONSTANT INIT ('displayed');
      172    19747    1   DCL LIST_STR CHAR(0) CONSTANT INIT ('listed');
      173    19748        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:34   
      174    19749        /********************************************************************/
      175    19750        /*   Procedure       procedure       procedure       procedure      */
      176    19751        /********************************************************************/
      177    19752    1   JCL = %NO#;

  19752  4 000002   200046 450100                    STZ     JCL,,AUTO

      178    19753
      179    19754    1   TPDEV_SPECIFIED = %NO#;

  19754  4 000003   200110 450100                    STZ     TPDEV_SPECIFIED,,AUTO

      180    19755    1   TPDEV_NAME_SPECIFIED = %NO#;

  19755  4 000004   200106 450100                    STZ     TPDEV_NAME_SPECIFIED,,AUTO

      181    19756    1   OPTION_CODE = %SINGLE_DEVICE;

  19756  4 000005   200070 450100                    STZ     OPTION_CODE,,AUTO

      182    19757    1   TPDEV.COUNT = 9;

  19757  4 000006   011000 236003                    LDQ     4608,DU
         4 000007   200077 552140                    STBQ    TPDEV,'40'O,AUTO

      183    19758    1   TPDEV.ACCT = '?';

  19758  4 000010   040100 100400                    MLR     fill='040'O
         4 000011   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000012   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8

      184    19759    1   TPDEV.NAME = '?';

  19759  4 000013   040100 100400                    MLR     fill='040'O
         4 000014   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000015   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:35   
      185    19760    1   DEV_NAME.COUNT = 1;

  19760  4 000016   001000 236003                    LDQ     512,DU
         4 000017   200021 552140                    STBQ    DEV_NAME,'40'O,AUTO

      186    19761    1   DEV_NAME.TEXT = '?';

  19761  4 000020   040100 100400                    MLR     fill='040'O
         4 000021   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000022   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8

      187    19762    1   STATION_NAME.COUNT = 1;

  19762  4 000023   200071 552140                    STBQ    STATION_NAME,'40'O,AUTO

      188    19763    1   STATION_NAME.TEXT = '?';

  19763  4 000024   040100 100400                    MLR     fill='040'O
         4 000025   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000026   200071 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8

      189    19764    1   TERMINAL_NAME.COUNT = 1;

  19764  4 000027   200074 552140                    STBQ    TERMINAL_NAME,'40'O,AUTO

      190    19765    1   TERMINAL_NAME.TEXT = '?';

  19765  4 000030   040100 100400                    MLR     fill='040'O
         4 000031   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000032   200074 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8

      191    19766    1   DISP_DEVICES = 0;

  19766  4 000033   200036 450100                    STZ     DISP_DEVICES,,AUTO

      192    19767
      193    19768    2   DO I = 0 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:36   

  19768  4 000034   200045 450100                    STZ     I,,AUTO
         4 000035   000341 710000 4                  TRA     s:19858+1

      194    19769
      195    19770    2      CODE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  19770  4 000036   000003 470400 xsym               LDP0    P_PCB+3
         4 000037   200045 720100                    LXL0    I,,AUTO
         4 000040   000003 471510                    LDP1    3,X0,PR0
         4 000041   100000 236100                    LDQ     0,,PR1
         4 000042   777777 376007                    ANQ     -1,DL
         4 000043   000000 756000 xsym               STQ     CODE

      196    19771
      197    19772    3      DO SELECT (CODE);

  19772  4 000044   000140 116007                    CMPQ    96,DL
         4 000045   000071 602000 4                  TNC     s:19772+21
         4 000046   000154 600000 4                  TZE     s:19795
         4 000047   000341 116007                    CMPQ    225,DL
         4 000050   000060 602000 4                  TNC     s:19772+12
         4 000051   000204 600000 4                  TZE     s:19808
         4 000052   000343 116007                    CMPQ    227,DL
         4 000053   000340 602000 4                  TNC     s:19858
         4 000054   000170 600000 4                  TZE     s:19802
         4 000055   000351 116007                    CMPQ    233,DL
         4 000056   000340 601000 4                  TNZ     s:19858
         4 000057   000311 710000 4                  TRA     s:19843
         4 000060   000311 116007                    CMPQ    201,DL
         4 000061   000066 602000 4                  TNC     s:19772+18
         4 000062   000264 600000 4                  TZE     s:19832
         4 000063   000337 116007                    CMPQ    223,DL
         4 000064   000340 601000 4                  TNZ     s:19858
         4 000065   000250 710000 4                  TRA     s:19826
         4 000066   000144 116007                    CMPQ    100,DL
         4 000067   000340 601000 4                  TNZ     s:19858
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:37   
         4 000070   000117 710000 4                  TRA     s:19783
         4 000071   000040 116007                    CMPQ    32,DL
         4 000072   000077 602000 4                  TNC     s:19772+27
         4 000073   000154 600000 4                  TZE     s:19795
         4 000074   000125 116007                    CMPQ    85,DL
         4 000075   000340 601000 4                  TNZ     s:19858
         4 000076   000225 710000 4                  TRA     s:19815
         4 000077   000005 116007                    CMPQ    5,DL
         4 000100   000105 602000 4                  TNC     s:19772+33
         4 000101   000225 600000 4                  TZE     s:19815
         4 000102   000022 116007                    CMPQ    18,DL
         4 000103   000340 601000 4                  TNZ     s:19858
         4 000104   000110 710000 4                  TRA     s:19776
         4 000105   000001 116007                    CMPQ    1,DL
         4 000106   000340 601000 4                  TNZ     s:19858
         4 000107   000336 710000 4                  TRA     s:19854

      198    19773
      199    19774    3         SELECT ( %LIST_ALL_VAL );

      200    19775
      201    19776    3         DISP = %NO#;

  19776  4 000110   200035 450100                    STZ     DISP,,AUTO

      202    19777    3         OPTION_CODE = %ALL ;

  19777  4 000111   000010 235007                    LDA     8,DL
         4 000112   200070 755100                    STA     OPTION_CODE,,AUTO

      203    19778    3         CHECK = %NO#;

  19778  4 000113   200016 450100                    STZ     CHECK,,AUTO

      204    19779    3         DEV_TYPE = %AS_CG_DEV#;

  19779  4 000114   000013 235007                    LDA     11,DL
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:38   
         4 000115   200034 755100                    STA     DEV_TYPE,,AUTO
         4 000116   000340 710000 4                  TRA     s:19858

      205    19780
      206    19781    3         SELECT ( %DISPLAY_ALL_VAL );

      207    19782
      208    19783    3         DISP = %YES#;

  19783  4 000117   400000 236003                    LDQ     -131072,DU
         4 000120   200035 756100                    STQ     DISP,,AUTO

      209    19784    3         OPTION_CODE = %ALL ;

  19784  4 000121   000010 235007                    LDA     8,DL
         4 000122   200070 755100                    STA     OPTION_CODE,,AUTO

      210    19785    3         CHECK = %NO#;

  19785  4 000123   200016 450100                    STZ     CHECK,,AUTO

      211    19786    3         DEV_TYPE = %AS_CG_DEV#;

  19786  4 000124   000013 235007                    LDA     11,DL
         4 000125   200034 755100                    STA     DEV_TYPE,,AUTO

      212    19787    3         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN

  19787  4 000126   000003 471510                    LDP1    3,X0,PR0
         4 000127   100001 221100                    LDX1    1,,PR1
         4 000130   000340 600000 4                  TZE     s:19858

      213    19788    4         DO K = 0 TO P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS - 1;

  19788  4 000131   200047 450100                    STZ     K,,AUTO
         4 000132   000146 710000 4                  TRA     s:19791+1

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:39   
      214    19789    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(K)->P$B.CODE = %JCL_VAL THEN

  19789  4 000133   000003 470400 xsym               LDP0    P_PCB+3
         4 000134   200045 720100                    LXL0    I,,AUTO
         4 000135   000003 471510                    LDP1    3,X0,PR0
         4 000136   200047 721100                    LXL1    K,,AUTO
         4 000137   100003 473511                    LDP3    3,X1,PR1
         4 000140   300000 722100                    LXL2    0,,PR3
         4 000141   000001 102003                    CMPX2   1,DU
         4 000142   000145 601000 4                  TNZ     s:19791

      215    19790    4               JCL = %YES#;

  19790  4 000143   400000 236003                    LDQ     -131072,DU
         4 000144   200046 756100                    STQ     JCL,,AUTO

      216    19791    4            END;

  19791  4 000145   200047 054100                    AOS     K,,AUTO
         4 000146   000003 471510                    LDP1    3,X0,PR0
         4 000147   100001 236100                    LDQ     1,,PR1
         4 000150   000022 772000                    QRL     18
         4 000151   200047 116100                    CMPQ    K,,AUTO
         4 000152   000133 605400 4                  TPNZ    s:19789
         4 000153   000340 710000 4                  TRA     s:19858

      217    19792
      218    19793    3         SELECT (%DISPLAY_TPDEV_VAL, %LIST_TPDEV_VAL);

      219    19794
      220    19795    3         DISP = (CODE = %DISPLAY_TPDEV_VAL);

  19795  4 000154   400000 221003                    LDX1    -131072,DU
         4 000155   000140 116007                    CMPQ    96,DL
         4 000156   000160 600000 4                  TZE     s:19795+4
         4 000157   000000 221003                    LDX1    0,DU
         4 000160   000000 636011                    EAQ     0,X1
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:40   
         4 000161   200035 756100                    STQ     DISP,,AUTO

      221    19796    3         DEV_TYPE = AS_TP_DEV#;

  19796  4 000162   000007 235007                    LDA     7,DL
         4 000163   200034 755100                    STA     DEV_TYPE,,AUTO

      222    19797    3         CHECK = %YES#;

  19797  4 000164   400000 236003                    LDQ     -131072,DU
         4 000165   200016 756100                    STQ     CHECK,,AUTO

      223    19798    3         TPDEV_SPECIFIED = %YES#;

  19798  4 000166   200110 756100                    STQ     TPDEV_SPECIFIED,,AUTO
         4 000167   000340 710000 4                  TRA     s:19858

      224    19799
      225    19800    3         SELECT (%TPDEV_ACCT_WILD_VAL);

      226    19801
      227    19802    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19802  4 000170   000003 236110                    LDQ     3,X0,PR0
         4 000171   200015 756100                    STQ     BLK$,,AUTO

      228    19803    3         TPDEV.COUNT = OUT$SYM.COUNT;

  19803  4 000172   200015 471500                    LDP1    BLK$,,AUTO
         4 000173   100004 236100                    LDQ     4,,PR1
         4 000174   200077 552140                    STBQ    TPDEV,'40'O,AUTO

      229    19804    3         TPDEV.ACCT = OUT$SYM.TEXT;

  19804  4 000175   100004 236100                    LDQ     4,,PR1
         4 000176   000033 772000                    QRL     27
         4 000177   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:41   
         4 000200   040100 100540                    MLR     fill='040'O
         4 000201   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000202   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8
         4 000203   000340 710000 4                  TRA     s:19858

      230    19805
      231    19806    3         SELECT (%TPDEV_NAME_WILD_VAL);

      232    19807
      233    19808    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19808  4 000204   000003 236110                    LDQ     3,X0,PR0
         4 000205   200015 756100                    STQ     BLK$,,AUTO

      234    19809    3         TPDEV.COUNT = OUT$SYM.COUNT + 8;

  19809  4 000206   200015 471500                    LDP1    BLK$,,AUTO
         4 000207   100004 236100                    LDQ     4,,PR1
         4 000210   000033 772000                    QRL     27
         4 000211   000010 036007                    ADLQ    8,DL
         4 000212   000033 736000                    QLS     27
         4 000213   200077 552140                    STBQ    TPDEV,'40'O,AUTO

      235    19810    3         TPDEV.NAME = OUT$SYM.TEXT;

  19810  4 000214   100004 236100                    LDQ     4,,PR1
         4 000215   000033 772000                    QRL     27
         4 000216   000000 621006                    EAX1    0,QL
         4 000217   040100 100540                    MLR     fill='040'O
         4 000220   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000221   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12

      236    19811    3         TPDEV_NAME_SPECIFIED = %YES#;

  19811  4 000222   400000 236003                    LDQ     -131072,DU
         4 000223   200106 756100                    STQ     TPDEV_NAME_SPECIFIED,,AUTO
         4 000224   000340 710000 4                  TRA     s:19858
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:42   

      237    19812
      238    19813    3         SELECT (%DISPLAY_DEVICE_VAL, %LIST_DEVICE_VAL);

      239    19814
      240    19815    3         DISP = (CODE = %DISPLAY_DEVICE_VAL);

  19815  4 000225   400000 221003                    LDX1    -131072,DU
         4 000226   000125 116007                    CMPQ    85,DL
         4 000227   000231 600000 4                  TZE     s:19815+4
         4 000230   000000 221003                    LDX1    0,DU
         4 000231   000000 636011                    EAQ     0,X1
         4 000232   200035 756100                    STQ     DISP,,AUTO

      241    19816    3         DEV_TYPE = %AS_CG_DEV#;

  19816  4 000233   000013 235007                    LDA     11,DL
         4 000234   200034 755100                    STA     DEV_TYPE,,AUTO

      242    19817    3         CHECK = %NO#;

  19817  4 000235   200016 450100                    STZ     CHECK,,AUTO

      243    19818
      244    19819    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.NSUBLKS > 0 THEN DO;

  19819  4 000236   000003 471510                    LDP1    3,X0,PR0
         4 000237   100001 221100                    LDX1    1,,PR1
         4 000240   000340 600000 4                  TZE     s:19858

      245    19820    4            DEV_TYPE = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.SUBLK$(0)->P$B.CODE;

  19820  4 000241   100003 473500                    LDP3    3,,PR1
         4 000242   300000 236100                    LDQ     0,,PR3
         4 000243   777777 376007                    ANQ     -1,DL
         4 000244   200034 756100                    STQ     DEV_TYPE,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:43   
      246    19821    4            CHECK = %YES#;

  19821  4 000245   400000 236003                    LDQ     -131072,DU
         4 000246   200016 756100                    STQ     CHECK,,AUTO

      247    19822    4            END; /*  Nsublks > 0  */

  19822  4 000247   000340 710000 4                  TRA     s:19858

      248    19823
      249    19824    3         SELECT (%DEVICE_NAME_WILD_VAL);

      250    19825
      251    19826    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19826  4 000250   000003 236110                    LDQ     3,X0,PR0
         4 000251   200015 756100                    STQ     BLK$,,AUTO

      252    19827    3         DEV_NAME.COUNT = OUT$SYM.COUNT;

  19827  4 000252   200015 471500                    LDP1    BLK$,,AUTO
         4 000253   100004 236100                    LDQ     4,,PR1
         4 000254   200021 552140                    STBQ    DEV_NAME,'40'O,AUTO

      253    19828    3         DEV_NAME.TEXT = OUT$SYM.TEXT;

  19828  4 000255   100004 236100                    LDQ     4,,PR1
         4 000256   000033 772000                    QRL     27
         4 000257   000000 621006                    EAX1    0,QL
         4 000260   040100 100540                    MLR     fill='040'O
         4 000261   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000262   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000263   000340 710000 4                  TRA     s:19858

      254    19829
      255    19830    3         SELECT (%STATION_NAME_WILD_VAL);

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:44   
      256    19831
      257    19832    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19832  4 000264   000003 236110                    LDQ     3,X0,PR0
         4 000265   200015 756100                    STQ     BLK$,,AUTO

      258    19833    3         STATION_NAME.COUNT = OUT$SYM.COUNT;

  19833  4 000266   200015 471500                    LDP1    BLK$,,AUTO
         4 000267   100004 236100                    LDQ     4,,PR1
         4 000270   200071 552140                    STBQ    STATION_NAME,'40'O,AUTO

      259    19834    3         STATION_NAME.TEXT = OUT$SYM.TEXT;

  19834  4 000271   100004 236100                    LDQ     4,,PR1
         4 000272   000033 772000                    QRL     27
         4 000273   000000 621006                    EAX1    0,QL
         4 000274   040100 100540                    MLR     fill='040'O
         4 000275   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000276   200071 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8

      260    19835    3         OPTION_CODE = %STATION;

  19835  4 000277   000006 235007                    LDA     6,DL
         4 000300   200070 755100                    STA     OPTION_CODE,,AUTO

      261    19836    3         CALL INDEX (K, '?', STATION_NAME.TEXT)

  19836  4 000301   000000 124500                    SCM     mask='000'O
         4 000302   200071 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 000303   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000304   200047 000100                    ARG     K,,AUTO
         4 000305   000310 606400 4                  TTN     s:19839

      262    19837    4         WHENRETURN DO;

      263    19838    4            OPTION_CODE = %STATION_WILD;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:45   

  19838  4 000306   000007 236007                    LDQ     7,DL
         4 000307   200070 756100                    STQ     OPTION_CODE,,AUTO

      264    19839    4            END; /*  Whenreturn  */

  19839  4 000310   000340 710000 4                  TRA     s:19858

      265    19840
      266    19841    3         SELECT (%TERMINAL_NAME_WILD_VAL);

      267    19842
      268    19843    3         BLK$ = P_PCB.OUT$->P$B.SUBLK$(I);

  19843  4 000311   000003 236110                    LDQ     3,X0,PR0
         4 000312   200015 756100                    STQ     BLK$,,AUTO

      269    19844    3         TERMINAL_NAME.COUNT = OUT$SYM.COUNT;

  19844  4 000313   200015 471500                    LDP1    BLK$,,AUTO
         4 000314   100004 236100                    LDQ     4,,PR1
         4 000315   200074 552140                    STBQ    TERMINAL_NAME,'40'O,AUTO

      270    19845    3         TERMINAL_NAME.TEXT = OUT$SYM.TEXT;

  19845  4 000316   100004 236100                    LDQ     4,,PR1
         4 000317   000033 772000                    QRL     27
         4 000320   000000 621006                    EAX1    0,QL
         4 000321   040100 100540                    MLR     fill='040'O
         4 000322   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         4 000323   200074 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8

      271    19846    3         OPTION_CODE = %TERMINAL;

  19846  4 000324   000004 235007                    LDA     4,DL
         4 000325   200070 755100                    STA     OPTION_CODE,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:46   
      272    19847    3         CALL INDEX (K, '?', TERMINAL_NAME.TEXT)

  19847  4 000326   000000 124500                    SCM     mask='000'O
         4 000327   200074 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 000330   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000331   200047 000100                    ARG     K,,AUTO
         4 000332   000335 606400 4                  TTN     s:19850

      273    19848    4         WHENRETURN DO;

      274    19849    4            OPTION_CODE = %TERMINAL_WILD;

  19849  4 000333   000005 236007                    LDQ     5,DL
         4 000334   200070 756100                    STQ     OPTION_CODE,,AUTO

      275    19850    4            END; /*  Whenreturn  */

  19850  4 000335   000340 710000 4                  TRA     s:19858

      276    19851
      277    19852    3         SELECT (%JCL_VAL);

      278    19853
      279    19854    3         JCL = %YES#;

  19854  4 000336   400000 236003                    LDQ     -131072,DU
         4 000337   200046 756100                    STQ     JCL,,AUTO

      280    19855
      281    19856    3         END;  /*  Do select on code  */

      282    19857
      283    19858    2      END;  /*  Do i  */

  19858  4 000340   200045 054100                    AOS     I,,AUTO
         4 000341   000003 470400 xsym               LDP0    P_PCB+3
         4 000342   000001 236100                    LDQ     1,,PR0
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:47   
         4 000343   000022 772000                    QRL     18
         4 000344   200045 116100                    CMPQ    I,,AUTO
         4 000345   000036 605400 4                  TPNZ    s:19770

      284    19859
      285    19860    1   FDS.NVECS# = 0;

  19860  4 000346   000011 450000 xsym               STZ     FDS+9

      286    19861    2   IF JCL THEN DO;

  19861  4 000347   200046 234100                    SZN     JCL,,AUTO
         4 000350   000366 605000 4                  TPL     s:19866

      287    19862    2      CALL CONCAT (FMT_BUF, '%1/"', DEVICES_STR, '%1/');

  19862  4 000351   000011 236000 3                  LDQ     LIST_STR+2
         4 000352   000000 756000 xsym               STQ     FMT_BUF
         4 000353   040000 100400                    MLR     fill='040'O
         4 000354   000002 000007 3                  ADSC9   DEVICES_STR              cn=0,n=7
         4 000355   000001 000007 xsym               ADSC9   FMT_BUF+1                cn=0,n=7
         4 000356   040000 100400                    MLR     fill='040'O
         4 000357   000011 000003 3                  ADSC9   LIST_STR+2               cn=0,n=3
         4 000360   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

      288    19863    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 6;

  19863  4 000361   000000 236000 xsym               LDQ     FDS
         4 000362   177777 376007                    ANQ     65535,DL
         4 000363   000001 276000 5                  ORQ     1
         4 000364   000000 756000 xsym               STQ     FDS

      289    19864    2      END;   /*  Jcl  */

  19864  4 000365   000404 710000 4                  TRA     s:19869

      290    19865    2   ELSE DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:48   

      291    19866    2      CALL CONCAT (FMT_BUF, '%1/', DEVICES_STR, '%1/');

  19866  4 000366   000011 236000 3                  LDQ     LIST_STR+2
         4 000367   000002 376000 5                  ANQ     2
         4 000370   000040 276007                    ORQ     32,DL
         4 000371   000000 756000 xsym               STQ     FMT_BUF
         4 000372   040000 100400                    MLR     fill='040'O
         4 000373   000002 000007 3                  ADSC9   DEVICES_STR              cn=0,n=7
         4 000374   000000 600007 xsym               ADSC9   FMT_BUF                  cn=3,n=7
         4 000375   040000 100400                    MLR     fill='040'O
         4 000376   000011 000003 3                  ADSC9   LIST_STR+2               cn=0,n=3
         4 000377   000002 400365 xsym               ADSC9   FMT_BUF+2                cn=2,n=245

      292    19867    2      FDS.FMT_.BOUND = LENGTHC (DEVICES_STR) + 5;

  19867  4 000400   000000 236000 xsym               LDQ     FDS
         4 000401   177777 376007                    ANQ     65535,DL
         4 000402   000003 276003                    ORQ     3,DU
         4 000403   000000 756000 xsym               STQ     FDS

      293    19868    2      END;  /*  Not jcl  */

      294    19869    1   FDS.TABDFLT# = 10;

  19869  4 000404   000012 235007                    LDA     10,DL
         4 000405   000017 755000 xsym               STA     FDS+15

      295    19870    1   CALL X$FORMAT (FDS);

  19870  4 000406   000003 630400 5                  EPPR0   3
         4 000407   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000410   000000 701000 xent               TSX1    X$FORMAT
         4 000411   000000 011000                    NOP     0

      296    19871
      297    19872    1   IF OPTION_CODE = %SINGLE_DEVICE THEN
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:49   

  19872  4 000412   200070 235100                    LDA     OPTION_CODE,,AUTO
         4 000413   000467 601000 4                  TNZ     s:19904

      298    19873    2      IF TPDEV_SPECIFIED THEN DO;

  19873  4 000414   200110 234100                    SZN     TPDEV_SPECIFIED,,AUTO
         4 000415   000455 605000 4                  TPL     s:19896

      299    19874    3         IF TPDEV_NAME_SPECIFIED THEN DO;

  19874  4 000416   200106 234100                    SZN     TPDEV_NAME_SPECIFIED,,AUTO
         4 000417   000447 605000 4                  TPL     s:19890

      300    19875    3            OPTION_CODE = %SINGLE_TPDEVICE;

  19875  4 000420   000001 236007                    LDQ     1,DL
         4 000421   200070 756100                    STQ     OPTION_CODE,,AUTO

      301    19876    3            TPDEV_ACCT_WILD = %NO#;

  19876  4 000422   200105 450100                    STZ     TPDEV_ACCT_WILD,,AUTO

      302    19877    3            CALL INDEX (I, '?', TPDEV.ACCT)

  19877  4 000423   000000 124500                    SCM     mask='000'O
         4 000424   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8
         4 000425   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000426   200045 000100                    ARG     I,,AUTO
         4 000427   000434 606400 4                  TTN     s:19882

      303    19878    4            WHENRETURN DO;

      304    19879    4               TPDEV_ACCT_WILD = %YES#;

  19879  4 000430   400000 236003                    LDQ     -131072,DU
         4 000431   200105 756100                    STQ     TPDEV_ACCT_WILD,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:50   

      305    19880    4               OPTION_CODE = %TPDEV_WILD;

  19880  4 000432   000003 235007                    LDA     3,DL
         4 000433   200070 755100                    STA     OPTION_CODE,,AUTO

      306    19881    4               END; /*  Whenreturn  */

      307    19882    3            TPDEV_NAME_WILD = %NO#;

  19882  4 000434   200107 450100                    STZ     TPDEV_NAME_WILD,,AUTO

      308    19883    3            CALL INDEX (I, '?', TPDEV.NAME)

  19883  4 000435   000000 124500                    SCM     mask='000'O
         4 000436   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12
         4 000437   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000440   200045 000100                    ARG     I,,AUTO
         4 000441   000446 606400 4                  TTN     s:19888

      309    19884    4            WHENRETURN DO;

      310    19885    4               TPDEV_NAME_WILD = %YES#;

  19885  4 000442   400000 236003                    LDQ     -131072,DU
         4 000443   200107 756100                    STQ     TPDEV_NAME_WILD,,AUTO

      311    19886    4               OPTION_CODE = %TPDEV_WILD;

  19886  4 000444   000003 235007                    LDA     3,DL
         4 000445   200070 755100                    STA     OPTION_CODE,,AUTO

      312    19887    4               END; /*  Whenreturn  */

      313    19888    3            END; /* TPDEV_NAME specified  */

  19888  4 000446   000467 710000 4                  TRA     s:19904
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:51   

      314    19889    3         ELSE DO;

      315    19890    3            TPDEV_ACCT_WILD = %YES#;

  19890  4 000447   400000 236003                    LDQ     -131072,DU
         4 000450   200105 756100                    STQ     TPDEV_ACCT_WILD,,AUTO

      316    19891    3            TPDEV_NAME_WILD = %YES#;

  19891  4 000451   200107 756100                    STQ     TPDEV_NAME_WILD,,AUTO

      317    19892    3            OPTION_CODE = %TPDEV_WILD;

  19892  4 000452   000003 235007                    LDA     3,DL
         4 000453   200070 755100                    STA     OPTION_CODE,,AUTO

      318    19893    3            END; /*  Else  */

      319    19894    2         END;  /*  Tpdev specified  */

  19894  4 000454   000467 710000 4                  TRA     s:19904

      320    19895    2      ELSE DO;

      321    19896    2         DEVICE_NAME_WILD = %NO#;

  19896  4 000455   200020 450100                    STZ     DEVICE_NAME_WILD,,AUTO

      322    19897    2         CALL INDEX (I, '?', DEV_NAME.TEXT)

  19897  4 000456   000000 124500                    SCM     mask='000'O
         4 000457   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000460   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000461   200045 000100                    ARG     I,,AUTO
         4 000462   000467 606400 4                  TTN     s:19904

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:52   
      323    19898    3         WHENRETURN DO;

      324    19899    3            DEVICE_NAME_WILD = %YES#;

  19899  4 000463   400000 236003                    LDQ     -131072,DU
         4 000464   200020 756100                    STQ     DEVICE_NAME_WILD,,AUTO

      325    19900    3            OPTION_CODE = %DEV_WILD;

  19900  4 000465   000002 235007                    LDA     2,DL
         4 000466   200070 755100                    STA     OPTION_CODE,,AUTO

      326    19901    3            END; /*  Whenreturn  */

      327    19902    2         END;  /*  Tpdev not specified  */

      328    19903
      329    19904    1   IF OPTION_CODE = %DEV_WILD THEN

  19904  4 000467   200070 235100                    LDA     OPTION_CODE,,AUTO
         4 000470   000002 115007                    CMPA    2,DL
         4 000471   000502 601000 4                  TNZ     s:19908

      330    19905    1      IF DEV_NAME.TEXT = '?' THEN

  19905  4 000472   040000 106500                    CMPC    fill='040'O
         4 000473   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 000474   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000475   000501 601000 4                  TNZ     s:19907

      331    19906    1         OPTION_CODE = %ALL;

  19906  4 000476   000010 236007                    LDQ     8,DL
         4 000477   200070 756100                    STQ     OPTION_CODE,,AUTO
         4 000500   000516 710000 4                  TRA     s:19912

      332    19907    2      ELSE DO; END;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:53   

  19907  4 000501   000516 710000 4                  TRA     s:19912

      333    19908    1   ELSE IF OPTION_CODE = %TPDEV_WILD THEN

  19908  4 000502   000003 115007                    CMPA    3,DL
         4 000503   000516 601000 4                  TNZ     s:19912

      334    19909    1         IF TPDEV.ACCT = '?' AND TPDEV.NAME = '?' THEN

  19909  4 000504   040000 106500                    CMPC    fill='040'O
         4 000505   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8
         4 000506   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000507   000516 601000 4                  TNZ     s:19912
         4 000510   040000 106500                    CMPC    fill='040'O
         4 000511   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12
         4 000512   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 000513   000516 601000 4                  TNZ     s:19912

      335    19910    1            OPTION_CODE = %ALL;

  19910  4 000514   000010 236007                    LDQ     8,DL
         4 000515   200070 756100                    STQ     OPTION_CODE,,AUTO

      336    19911
      337    19912    2   DO SELECT  (OPTION_CODE);

  19912  4 000516   200070 236100                    LDQ     OPTION_CODE,,AUTO
         4 000517   000005 116007                    CMPQ    5,DL
         4 000520   000533 602000 4                  TNC     s:19912+13
         4 000521   001406 600000 4                  TZE     s:20033
         4 000522   000007 116007                    CMPQ    7,DL
         4 000523   000530 602000 4                  TNC     s:19912+10
         4 000524   000674 600000 4                  TZE     s:19947
         4 000525   000010 116007                    CMPQ    8,DL
         4 000526   003323 601000 4                  TNZ     s:20325
         4 000527   000552 710000 4                  TRA     s:19916
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:54   
         4 000530   000006 116007                    CMPQ    6,DL
         4 000531   003323 601000 4                  TNZ     s:20325
         4 000532   001145 710000 4                  TRA     s:19990
         4 000533   000003 116007                    CMPQ    3,DL
         4 000534   000541 602000 4                  TNC     s:19912+19
         4 000535   002244 600000 4                  TZE     s:20157
         4 000536   000004 116007                    CMPQ    4,DL
         4 000537   003323 601000 4                  TNZ     s:20325
         4 000540   001743 710000 4                  TRA     s:20109
         4 000541   000001 116007                    CMPQ    1,DL
         4 000542   000547 602000 4                  TNC     s:19912+25
         4 000543   002625 600000 4                  TZE     s:20221
         4 000544   000002 116007                    CMPQ    2,DL
         4 000545   003323 601000 4                  TNZ     s:20325
         4 000546   002752 710000 4                  TRA     s:20260
         4 000547   000000 116003                    CMPQ    0,DU
         4 000550   003220 600000 4                  TZE     s:20307
         4 000551   003323 710000 4                  TRA     s:20325

      338    19913
      339    19914    2      SELECT  (%ALL); /*  List/display all devices  */

      340    19915
      341    19916    2      CALL ASB$BOF_HLP;

  19916  4 000552   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000553   000000 701000 xent               TSX1    ASB$BOF_HLP
         4 000554   000000 011000                    NOP     0

      342    19917    3      DO FOREVER;

      343    19918    3   NEXT: ARS = DSEG3SIZE;

  19918  4 000555   000000 235000 xsym  NEXT         LDA     DSEG3SIZE
         4 000556   200006 755100                    STA     ARS,,AUTO

      344    19919    3         CALL ASB$READ_HLP_SEQ( DSEG3$, ARS, 3 )
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:55   

  19919  4 000557   000004 236000 5                  LDQ     4
         4 000560   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 000561   200006 630500                    EPPR0   ARS,,AUTO
         4 000562   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 000563   000005 236000 5                  LDQ     5
         4 000564   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000565   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000566   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000567   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 000570   000662 702000 4                  TSX2    s:19939

      345    19920    4         WHENRETURN DO;

      346    19921    4            CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(NEXT);

  19921  4 000571   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 000572   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 000573   200006 631500                    EPPR1   ARS,,AUTO
         4 000574   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 000575   000005 236000 5                  LDQ     5
         4 000576   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000577   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000600   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000601   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 000602   000555 702000 4                  TSX2    NEXT

      347    19922    4            DEV_NAME = USERS_KEY;

  19922  4 000603   000100 100400                    MLR     fill='000'O
         4 000604   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 000605   200021 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42

      348    19923    5            IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  19923  4 000606   200016 234100                    SZN     CHECK,,AUTO
         4 000607   000615 605000 4                  TPL     s:19924
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:56   
         4 000610   000000 470400 xsym               LDP0    DSEG3$
         4 000611   000000 236100                    LDQ     0,,PR0
         4 000612   000777 376007                    ANQ     511,DL
         4 000613   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 000614   000647 601000 4                  TNZ     s:19933

      349    19924    6               IF DISP THEN DO;

  19924  4 000615   200035 234100                    SZN     DISP,,AUTO
         4 000616   000634 605000 4                  TPL     s:19929

      350    19925    6                  CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  19925  4 000617   000006 236000 5                  LDQ     6
         4 000620   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000621   200046 630500                    EPPR0   JCL,,AUTO
         4 000622   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000623   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000624   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000625   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 000626   000000 011000                    NOP     0

      351    19926    6                  CALL ASB$WRITE_LO  (' ',1);

  19926  4 000627   000007 630400 5                  EPPR0   7
         4 000630   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000631   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 000632   000000 011000                    NOP     0

      352    19927    6                  END;   /*  Disp  */

  19927  4 000633   000644 710000 4                  TRA     s:19931

      353    19928    6               ELSE DO; /*  list out the device name  */

      354    19929    6                  CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:57   
  19929  4 000634   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 000635   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 000636   000011 236000 5                  LDQ     9
         4 000637   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 000640   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000641   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000642   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 000643   000000 011000                    NOP     0

      355    19930    6                  END; /*  List  */

      356    19931    5               DISP_DEVICES = DISP_DEVICES + 1;

  19931  4 000644   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 000645   000001 035007                    ADLA    1,DL
         4 000646   200036 755100                    STA     DISP_DEVICES,,AUTO

      357    19932    5               END;  /*  The right type  */

      358    19933    5            IF DEV_NAME ~= USERS_KEY THEN DO;

  19933  4 000647   000000 106500                    CMPC    fill='000'O
         4 000650   200021 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42
         4 000651   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 000652   000661 600000 4                  TZE     s:19937

      359    19934    5               USERS_KEY = DEV_NAME;

  19934  4 000653   000000 100500                    MLR     fill='000'O
         4 000654   200021 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42
         4 000655   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      360    19935    5               CALL ASB$PREC_AND_SKIP_HLP;

  19935  4 000656   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000657   000000 701000 xent               TSX1    ASB$PREC_AND_SKIP_HLP
         4 000660   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:58   

      361    19936    5               END; /*  DEV_NAME ~= USERS_KEY  */

      362    19937    4            END; /*  Whenreturn  */

  19937  4 000661   000673 710000 4                  TRA     s:19943

      363    19938    4         WHENALTRETURN DO;

      364    19939    4            IF MERR_CODE.CODE ~= %E$EOF THEN

  19939  4 000662   000000 236000 xsym               LDQ     ERR_CODE
         4 000663   377770 376007                    ANQ     131064,DL
         4 000664   000060 116007                    CMPQ    48,DL
         4 000665   000672 600000 4                  TZE     s:19941

      365    19940    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  19940  4 000666   000013 630400 5                  EPPR0   11
         4 000667   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000670   000000 701000 xent               TSX1    ASA$ERROR
         4 000671   000000 011000                    NOP     0

      366    19941    4            GOTO FINISH_UP;

  19941  4 000672   003367 710000 4                  TRA     FINISH_UP

      367    19942    4            END; /*  Whenaltreturn  */
      368    19943    3         END; /*  Do forever  */

  19943  4 000673   000555 710000 4                  TRA     NEXT

      369    19944
      370    19945    2      SELECT  (%STATION_WILD);

      371    19946
      372    19947    2      CALL ASB$INIT_GET_STATION;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:59   

  19947  4 000674   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000675   000000 701000 xent               TSX1    ASB$INIT_GET_STATION
         4 000676   000000 011000                    NOP     0

      373    19948    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;

  19948  4 000677   200112 450100                    STZ     TWSN_NUMBER,,AUTO
         4 000700   001140 710000 4                  TRA     NEXT_STATION+3

      374    19949    3         CALL INDEX (NAME_LEN, ' ', KL$WSNCVT.WSN(TWSN_NUMBER));

  19949  4 000701   200112 235100                    LDA     TWSN_NUMBER,,AUTO
         4 000702   000003 735000                    ALS     3
         4 000703   000000 470400 xsym               LDP0    DSEG1$
         4 000704   000000 124505                    SCM     mask='000'O
         4 000705   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         4 000706   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000707   200067 000100                    ARG     NAME_LEN,,AUTO

      375    19950    3         IF NAME_LEN = 0 THEN NAME_LEN = 1;

  19950  4 000710   200067 236100                    LDQ     NAME_LEN,,AUTO
         4 000711   000714 601000 4                  TNZ     s:19951

  19950  4 000712   000001 235007                    LDA     1,DL
         4 000713   200067 755100                    STA     NAME_LEN,,AUTO

      376    19951    3         MATCH_LEN = STATION_NAME.COUNT;

  19951  4 000714   200071 236100                    LDQ     STATION_NAME,,AUTO
         4 000715   000033 772000                    QRL     27
         4 000716   200063 756100                    STQ     MATCH_LEN,,AUTO

      377    19952    3         CALL ASB$WILD_MATCH (NAME_LEN,KL$WSNCVT.WSN(TWSN_NUMBER),MATCH_LEN,
             19952                  STATION_NAME.TEXT) ALTRET (NEXT_STATION);

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:60   
  19952  4 000717   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 000720   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 000721   000015 036000 5                  ADLQ    13
         4 000722   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 000723   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 000724   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 000725   200112 236100                    LDQ     TWSN_NUMBER,,AUTO
         4 000726   000023 736000                    QLS     19
         4 000727   000002 036003                    ADLQ    2,DU
         4 000730   000000 036000 xsym               ADLQ    DSEG1$
         4 000731   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 000732   200067 633500                    EPPR3   NAME_LEN,,AUTO
         4 000733   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 000734   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000735   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 000736   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 000737   001135 702000 4                  TSX2    NEXT_STATION

      378    19953    3         CALL ASB$GET_NEXT_STATION (TWSN_NUMBER) ALTRET (FINISH_UP);

  19953  4 000740   200112 630500                    EPPR0   TWSN_NUMBER,,AUTO
         4 000741   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 000742   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 000743   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000744   000000 701000 xent               TSX1    ASB$GET_NEXT_STATION
         4 000745   003367 702000 4                  TSX2    FINISH_UP

      379    19954    4         DO I = 0 TO KL$TWSNREC.NDEV - 1;

  19954  4 000746   200045 450100                    STZ     I,,AUTO
         4 000747   001130 710000 4                  TRA     NO_REC_FOR_STATION1+1

      380    19955    5            IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;

  19955  4 000750   200045 236100                    LDQ     I,,AUTO
         4 000751   000013 402007                    MPY     11,DL
         4 000752   000000 470400 xsym               LDP0    DSEG2$
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:61   
         4 000753   000006 236106                    LDQ     6,QL,PR0
         4 000754   000036 736000                    QLS     30
         4 000755   400000 376003                    ANQ     -131072,DU
         4 000756   400000 676003                    ERQ     -131072,DU
         4 000757   001127 600000 4                  TZE     NO_REC_FOR_STATION1

      381    19956    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  19956  4 000760   200045 236100                    LDQ     I,,AUTO
         4 000761   000013 402007                    MPY     11,DL
         4 000762   000006 236106                    LDQ     6,QL,PR0
         4 000763   000100 316007                    CANQ    64,DL
         4 000764   000772 600000 4                  TZE     s:19961

      382    19957    6                  NAME_LEN = 4;

  19957  4 000765   000004 235007                    LDA     4,DL
         4 000766   200067 755100                    STA     NAME_LEN,,AUTO

      383    19958    6                  USERS_KEY.COUNT = 8;

  19958  4 000767   010000 236003                    LDQ     4096,DU
         4 000770   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      384    19959    6                  END; /*  A tdev  */

  19959  4 000771   001002 710000 4                  TRA     s:19964

      385    19960    6               ELSE DO;          /* Not a tdev         */

      386    19961    6                  CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));

  19961  4 000772   200045 236100                    LDQ     I,,AUTO
         4 000773   000054 402007                    MPY     44,DL
         4 000774   000000 124506                    SCM     mask='000'O
         4 000775   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 000776   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:62   
         4 000777   200067 000100                    ARG     NAME_LEN,,AUTO

      387    19962    6                  USERS_KEY.COUNT = 9;

  19962  4 001000   011000 236003                    LDQ     4608,DU
         4 001001   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      388    19963    6                  END; /*  Not a tdev  */

      389    19964    5               MATCH_LEN = DEV_NAME.COUNT;

  19964  4 001002   200021 236100                    LDQ     DEV_NAME,,AUTO
         4 001003   000033 772000                    QRL     27
         4 001004   200063 756100                    STQ     MATCH_LEN,,AUTO

      390    19965    5              CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME
             19965                        .TEXT)

  19965  4 001005   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 001006   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 001007   000016 036000 5                  ADLQ    14
         4 001010   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 001011   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001012   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 001013   200045 236100                    LDQ     I,,AUTO
         4 001014   000013 402003                    MPY     11,DU
         4 001015   000011 036003                    ADLQ    9,DU
         4 001016   000000 036000 xsym               ADLQ    DSEG2$
         4 001017   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001020   200067 633500                    EPPR3   NAME_LEN,,AUTO
         4 001021   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 001022   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001023   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001024   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001025   001127 702000 4                  TSX2    NO_REC_FOR_STATION1

      391    19966    6               WHENRETURN DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:63   

      392    19967    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  19967  4 001026   200045 236100                    LDQ     I,,AUTO
         4 001027   000054 402007                    MPY     44,DL
         4 001030   000000 470400 xsym               LDP0    DSEG2$
         4 001031   040000 100506                    MLR     fill='040'O
         4 001032   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001033   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001034   000052 236003                    LDQ     42,DU
         4 001035   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      393    19968    6                  ARS = DSEG3SIZE;

  19968  4 001036   000000 235000 xsym               LDA     DSEG3SIZE
         4 001037   200006 755100                    STA     ARS,,AUTO

      394    19969    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION1);

  19969  4 001040   000004 236000 5                  LDQ     4
         4 001041   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001042   200006 630500                    EPPR0   ARS,,AUTO
         4 001043   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001044   000005 236000 5                  LDQ     5
         4 001045   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001046   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001047   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001050   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001051   001127 702000 4                  TSX2    NO_REC_FOR_STATION1

      395    19970    6                  CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(
             19970                           NO_REC_FOR_STATION1);

  19970  4 001052   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 001053   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 001054   200006 631500                    EPPR1   ARS,,AUTO
         4 001055   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:64   
         4 001056   000005 236000 5                  LDQ     5
         4 001057   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001060   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001061   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001062   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 001063   001127 702000 4                  TSX2    NO_REC_FOR_STATION1

      396    19971    7                  IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  19971  4 001064   200016 234100                    SZN     CHECK,,AUTO
         4 001065   001073 605000 4                  TPL     s:19972
         4 001066   000000 470400 xsym               LDP0    DSEG3$
         4 001067   000000 236100                    LDQ     0,,PR0
         4 001070   000777 376007                    ANQ     511,DL
         4 001071   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 001072   001127 601000 4                  TNZ     NO_REC_FOR_STATION1

      397    19972    7                     IF ~ DISP THEN

  19972  4 001073   200035 236100                    LDQ     DISP,,AUTO
         4 001074   400000 376003                    ANQ     -131072,DU
         4 001075   400000 676003                    ERQ     -131072,DU
         4 001076   001110 600000 4                  TZE     s:19975

      398    19973    7                        CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  19973  4 001077   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 001100   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001101   000011 236000 5                  LDQ     9
         4 001102   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001103   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001104   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001105   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 001106   000000 011000                    NOP     0
         4 001107   001124 710000 4                  TRA     s:19978

      399    19974    8                     ELSE DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:65   

      400    19975    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  19975  4 001110   000006 236000 5                  LDQ     6
         4 001111   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001112   200046 630500                    EPPR0   JCL,,AUTO
         4 001113   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001114   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001115   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001116   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 001117   000000 011000                    NOP     0

      401    19976    8                        CALL ASB$WRITE_LO  (' ',1);

  19976  4 001120   000007 630400 5                  EPPR0   7
         4 001121   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001122   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001123   000000 011000                    NOP     0

      402    19977    8                        END;   /*  Disp  */

      403    19978    7                     DISP_DEVICES = DISP_DEVICES + 1;

  19978  4 001124   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 001125   000001 035007                    ADLA    1,DL
         4 001126   200036 755100                    STA     DISP_DEVICES,,AUTO

      404    19979    7                     END; /*  The right type  */

      405    19980    6                  END; /*  Whenreturn  */

      406    19981    5               END; /*  Not iom connected  */

      407    19982    4   NO_REC_FOR_STATION1:
      408    19983    4            END; /*  Do ndevs times  */

  19983  4 001127   200045 054100       NO_REC_FOR_* AOS     I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:66   
         4 001130   000000 470400 xsym               LDP0    DSEG2$
         4 001131   200045 236100                    LDQ     I,,AUTO
         4 001132   000750 604000 4                  TMI     s:19955
         4 001133   000004 116100                    CMPQ    4,,PR0
         4 001134   000750 602000 4                  TNC     s:19955

      409    19984    3   NEXT_STATION:
      410    19985    3         END; /*  Do ltwsn  */

  19985  4 001135   200112 235100       NEXT_STATION LDA     TWSN_NUMBER,,AUTO
         4 001136   000001 035007                    ADLA    1,DL
         4 001137   200112 755100                    STA     TWSN_NUMBER,,AUTO
         4 001140   000000 470400 xsym               LDP0    DSEG1$
         4 001141   000001 236100                    LDQ     1,,PR0
         4 001142   200112 116100                    CMPQ    TWSN_NUMBER,,AUTO
         4 001143   000701 603000 4                  TRC     s:19949

      411    19986    2      GOTO FINISH_UP;

  19986  4 001144   003367 710000 4                  TRA     FINISH_UP

      412    19987
      413    19988    2      SELECT  (%STATION);

      414    19989
      415    19990    2      USERS_KEY.COUNT = 15;

  19990  4 001145   017000 236003                    LDQ     7680,DU
         4 001146   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      416    19991    2      CALL CONCAT( USERS_KEY.TXTC, STATION_NAME.TEXT, 'STATION' );

  19991  4 001147   040000 100500                    MLR     fill='040'O
         4 001150   200071 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 001151   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001152   040000 100400                    MLR     fill='040'O
         4 001153   000012 000007 3                  ADSC9   LIST_STR+3               cn=0,n=7
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:67   
         4 001154   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      417    19992    2      ARS = DSEG1SIZE;

  19992  4 001155   000000 235000 xsym               LDA     DSEG1SIZE
         4 001156   200006 755100                    STA     ARS,,AUTO

      418    19993    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ALT3 );

  19993  4 001157   000010 236000 5                  LDQ     8
         4 001160   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001161   200006 630500                    EPPR0   ARS,,AUTO
         4 001162   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001163   000017 236000 5                  LDQ     15
         4 001164   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001165   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001166   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001167   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001170   003345 702000 4                  TSX2    READ_ALT3

      419    19994    2      USERS_KEY.COUNT = 8;

  19994  4 001171   010000 236003                    LDQ     4096,DU
         4 001172   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      420    19995    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );

  19995  4 001173   040000 100400                    MLR     fill='040'O
         4 001174   000014 000004 3                  ADSC9   LIST_STR+5               cn=0,n=4
         4 001175   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 001176   000000 470400 xsym               LDP0    DSEG1$
         4 001177   040000 100500                    MLR     fill='040'O
         4 001200   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         4 001201   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      421    19996    2      ARS = DSEG2SIZE;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:68   
  19996  4 001202   000000 235000 xsym               LDA     DSEG2SIZE
         4 001203   200006 755100                    STA     ARS,,AUTO

      422    19997    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  19997  4 001204   000020 236000 5                  LDQ     16
         4 001205   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001206   200006 630500                    EPPR0   ARS,,AUTO
         4 001207   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001210   000021 236000 5                  LDQ     17
         4 001211   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001212   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001213   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001214   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001215   003363 702000 4                  TSX2    READ_ERR

      423    19998    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;

  19998  4 001216   200045 450100                    STZ     I,,AUTO
         4 001217   001400 710000 4                  TRA     NO_REC_FOR_STATION2+1

      424    19999    4         IF ~KL$TWSNREC.DEVS.IOM_CONNECTED(I) THEN DO;

  19999  4 001220   200045 236100                    LDQ     I,,AUTO
         4 001221   000013 402007                    MPY     11,DL
         4 001222   000000 470400 xsym               LDP0    DSEG2$
         4 001223   000006 236106                    LDQ     6,QL,PR0
         4 001224   000036 736000                    QLS     30
         4 001225   400000 376003                    ANQ     -131072,DU
         4 001226   400000 676003                    ERQ     -131072,DU
         4 001227   001377 600000 4                  TZE     NO_REC_FOR_STATION2

      425    20000    5            IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  20000  4 001230   200045 236100                    LDQ     I,,AUTO
         4 001231   000013 402007                    MPY     11,DL
         4 001232   000006 236106                    LDQ     6,QL,PR0
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:69   
         4 001233   000100 316007                    CANQ    64,DL
         4 001234   001242 600000 4                  TZE     s:20005

      426    20001    5               NAME_LEN = 4;

  20001  4 001235   000004 235007                    LDA     4,DL
         4 001236   200067 755100                    STA     NAME_LEN,,AUTO

      427    20002    5               USERS_KEY.COUNT = 8;

  20002  4 001237   010000 236003                    LDQ     4096,DU
         4 001240   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      428    20003    5               END; /*  A tdev  */

  20003  4 001241   001252 710000 4                  TRA     s:20008

      429    20004    5            ELSE DO;          /* Not a tdev         */

      430    20005    5               CALL INDEX (NAME_LEN, ' ', KL$TWSNREC.DEVS.ACCT(I));

  20005  4 001242   200045 236100                    LDQ     I,,AUTO
         4 001243   000054 402007                    MPY     44,DL
         4 001244   000000 124506                    SCM     mask='000'O
         4 001245   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001246   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001247   200067 000100                    ARG     NAME_LEN,,AUTO

      431    20006    5               USERS_KEY.COUNT = 9;

  20006  4 001250   011000 236003                    LDQ     4608,DU
         4 001251   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      432    20007    5               END; /*  Not a tdev  */

      433    20008    4            MATCH_LEN = DEV_NAME.COUNT;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:70   
  20008  4 001252   200021 236100                    LDQ     DEV_NAME,,AUTO
         4 001253   000033 772000                    QRL     27
         4 001254   200063 756100                    STQ     MATCH_LEN,,AUTO

      434    20009    4            CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             20009                     TEXT)

  20009  4 001255   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 001256   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 001257   000016 036000 5                  ADLQ    14
         4 001260   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 001261   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001262   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 001263   200045 236100                    LDQ     I,,AUTO
         4 001264   000013 402003                    MPY     11,DU
         4 001265   000011 036003                    ADLQ    9,DU
         4 001266   000000 036000 xsym               ADLQ    DSEG2$
         4 001267   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001270   200067 633500                    EPPR3   NAME_LEN,,AUTO
         4 001271   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 001272   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001273   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001274   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001275   001377 702000 4                  TSX2    NO_REC_FOR_STATION2

      435    20010    5            WHENRETURN DO;

      436    20011    5               CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  20011  4 001276   200045 236100                    LDQ     I,,AUTO
         4 001277   000054 402007                    MPY     44,DL
         4 001300   000000 470400 xsym               LDP0    DSEG2$
         4 001301   040000 100506                    MLR     fill='040'O
         4 001302   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001303   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001304   000052 236003                    LDQ     42,DU
         4 001305   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:71   

      437    20012    5               ARS = DSEG3SIZE;

  20012  4 001306   000000 235000 xsym               LDA     DSEG3SIZE
         4 001307   200006 755100                    STA     ARS,,AUTO

      438    20013    5               CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_STATION2);

  20013  4 001310   000004 236000 5                  LDQ     4
         4 001311   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001312   200006 630500                    EPPR0   ARS,,AUTO
         4 001313   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001314   000005 236000 5                  LDQ     5
         4 001315   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001316   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001317   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001320   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001321   001377 702000 4                  TSX2    NO_REC_FOR_STATION2

      439    20014    5              CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(NO_REC_FOR_STATION2)
             20014                        ;

  20014  4 001322   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 001323   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 001324   200006 631500                    EPPR1   ARS,,AUTO
         4 001325   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001326   000005 236000 5                  LDQ     5
         4 001327   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001330   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001331   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001332   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 001333   001377 702000 4                  TSX2    NO_REC_FOR_STATION2

      440    20015    6               IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  20015  4 001334   200016 234100                    SZN     CHECK,,AUTO
         4 001335   001343 605000 4                  TPL     s:20016
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:72   
         4 001336   000000 470400 xsym               LDP0    DSEG3$
         4 001337   000000 236100                    LDQ     0,,PR0
         4 001340   000777 376007                    ANQ     511,DL
         4 001341   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 001342   001377 601000 4                  TNZ     NO_REC_FOR_STATION2

      441    20016    7                  IF ~ DISP THEN DO;

  20016  4 001343   200035 236100                    LDQ     DISP,,AUTO
         4 001344   400000 376003                    ANQ     -131072,DU
         4 001345   400000 676003                    ERQ     -131072,DU
         4 001346   001360 600000 4                  TZE     s:20020

      442    20017    7                     CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  20017  4 001347   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 001350   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001351   000011 236000 5                  LDQ     9
         4 001352   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001353   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001354   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001355   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 001356   000000 011000                    NOP     0

      443    20018    7                     END; /*  ~disp  */

  20018  4 001357   001374 710000 4                  TRA     s:20023

      444    20019    7                  ELSE DO;

      445    20020    7                     CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20020  4 001360   000006 236000 5                  LDQ     6
         4 001361   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001362   200046 630500                    EPPR0   JCL,,AUTO
         4 001363   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001364   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:73   
         4 001365   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001366   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 001367   000000 011000                    NOP     0

      446    20021    7                     CALL ASB$WRITE_LO (' ',1);

  20021  4 001370   000007 630400 5                  EPPR0   7
         4 001371   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001372   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001373   000000 011000                    NOP     0

      447    20022    7                     END;   /*  Disp  */

      448    20023    6                  DISP_DEVICES = DISP_DEVICES + 1;

  20023  4 001374   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 001375   000001 035007                    ADLA    1,DL
         4 001376   200036 755100                    STA     DISP_DEVICES,,AUTO

      449    20024    6                  END; /*  The right type  */

      450    20025    5               END; /*  Whenreturn  */

      451    20026    4            END; /*  Not iom connected  */

      452    20027    3   NO_REC_FOR_STATION2:
      453    20028    3         END; /*  Do ndevs times  */

  20028  4 001377   200045 054100       NO_REC_FOR_* AOS     I,,AUTO
         4 001400   000000 470400 xsym               LDP0    DSEG2$
         4 001401   200045 236100                    LDQ     I,,AUTO
         4 001402   001220 604000 4                  TMI     s:19999
         4 001403   000004 116100                    CMPQ    4,,PR0
         4 001404   001220 602000 4                  TNC     s:19999

      454    20029    2      GOTO FINISH_UP;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:74   
  20029  4 001405   003367 710000 4                  TRA     FINISH_UP

      455    20030
      456    20031    2      SELECT  (%TERMINAL_WILD);

      457    20032
      458    20033    2      USERS_KEY.COUNT = 4;

  20033  4 001406   004000 236003                    LDQ     2048,DU
         4 001407   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      459    20034    2      USERS_KEY.TXTC = 'TERM';

  20034  4 001410   040000 100400                    MLR     fill='040'O
         4 001411   000015 000004 3                  ADSC9   LIST_STR+6               cn=0,n=4
         4 001412   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      460    20035    2      ARS = DSEG1SIZE;

  20035  4 001413   000000 235000 xsym               LDA     DSEG1SIZE
         4 001414   200006 755100                    STA     ARS,,AUTO

      461    20036    2      CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );

  20036  4 001415   000010 236000 5                  LDQ     8
         4 001416   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001417   200006 630500                    EPPR0   ARS,,AUTO
         4 001420   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001421   000017 236000 5                  LDQ     15
         4 001422   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001423   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001424   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001425   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001426   003363 702000 4                  TSX2    READ_ERR

      462    20037    3      DO TWSN_NUMBER = 0 TO KL$WSNCVT.LTWSN ;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:75   
  20037  4 001427   200112 450100                    STZ     TWSN_NUMBER,,AUTO
         4 001430   001736 710000 4                  TRA     s:20105+3

      463    20038    4         IF KL$WSNCVT.WSN(TWSN_NUMBER) ~= ' ' THEN DO;

  20038  4 001431   200112 235100                    LDA     TWSN_NUMBER,,AUTO
         4 001432   000003 735000                    ALS     3
         4 001433   000000 470400 xsym               LDP0    DSEG1$
         4 001434   040000 106505                    CMPC    fill='040'O
         4 001435   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         4 001436   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001437   001733 600000 4                  TZE     s:20105

      464    20039    4            USERS_KEY.COUNT = 8;

  20039  4 001440   010000 236003                    LDQ     4096,DU
         4 001441   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      465    20040    4            CALL BINCHAR (TWSN_CHAR, TWSN_NUMBER);

  20040  4 001442   200112 235100                    LDA     TWSN_NUMBER,,AUTO
         4 001443   000044 773000                    LRL     36
         4 001444   200114 757100                    STAQ    TWSN_NUMBER+2,,AUTO
         4 001445   000100 301500                    BTD
         4 001446   200114 000010                    NDSC9   TWSN_NUMBER+2,,AUTO      cn=0,s=lsgnf,sf=0,n=8
         4 001447   200111 030004                    NDSC9   TWSN_CHAR,,AUTO          cn=0,s=nosgn,sf=0,n=4

      466    20041    4            CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSN_CHAR );

  20041  4 001450   040000 100400                    MLR     fill='040'O
         4 001451   000014 000004 3                  ADSC9   LIST_STR+5               cn=0,n=4
         4 001452   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 001453   040000 100500                    MLR     fill='040'O
         4 001454   200111 000004                    ADSC9   TWSN_CHAR,,AUTO          cn=0,n=4
         4 001455   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      467    20042    4            ARS = DSEG2SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:76   

  20042  4 001456   000000 235000 xsym               LDA     DSEG2SIZE
         4 001457   200006 755100                    STA     ARS,,AUTO

      468    20043    4            CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  20043  4 001460   000020 236000 5                  LDQ     16
         4 001461   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001462   200006 630500                    EPPR0   ARS,,AUTO
         4 001463   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001464   000021 236000 5                  LDQ     17
         4 001465   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001466   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001467   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001470   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001471   003363 702000 4                  TSX2    READ_ERR

      469    20044    5            DO I = 0 TO KL$TWSNREC.NDEV - 1;

  20044  4 001472   200045 450100                    STZ     I,,AUTO
         4 001473   001705 710000 4                  TRA     NO_REC_FOR_TERM1+1

      470    20045    6               IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  20045  4 001474   200045 236100                    LDQ     I,,AUTO
         4 001475   000013 402007                    MPY     11,DL
         4 001476   000000 470400 xsym               LDP0    DSEG2$
         4 001477   000006 236106                    LDQ     6,QL,PR0
         4 001500   000100 316007                    CANQ    64,DL
         4 001501   001704 600000 4                  TZE     NO_REC_FOR_TERM1

      471    20046    6                  MATCH_LEN = DEV_NAME.COUNT;

  20046  4 001502   200021 236100                    LDQ     DEV_NAME,,AUTO
         4 001503   000033 772000                    QRL     27
         4 001504   200063 756100                    STQ     MATCH_LEN,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:77   
      472    20047    6                  CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.
             20047                           TEXT)

  20047  4 001505   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 001506   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 001507   000016 036000 5                  ADLQ    14
         4 001510   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 001511   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001512   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 001513   200045 236100                    LDQ     I,,AUTO
         4 001514   000013 402003                    MPY     11,DU
         4 001515   000011 036003                    ADLQ    9,DU
         4 001516   000000 036000 xsym               ADLQ    DSEG2$
         4 001517   000022 235000 5                  LDA     18
         4 001520   200114 757100                    STAQ    TWSN_NUMBER+2,,AUTO
         4 001521   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001522   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001523   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001524   001704 702000 4                  TSX2    NO_REC_FOR_TERM1

      473    20048    7                  WHENRETURN DO;

      474    20049    7                     CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));

  20049  4 001525   200045 236100                    LDQ     I,,AUTO
         4 001526   000054 402007                    MPY     44,DL
         4 001527   000000 470400 xsym               LDP0    DSEG2$
         4 001530   000000 124506                    SCM     mask='000'O
         4 001531   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 001532   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001533   200067 000100                    ARG     NAME_LEN,,AUTO

      475    20050    7                     MATCH_LEN = TERMINAL_NAME.COUNT;

  20050  4 001534   200074 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 001535   000033 772000                    QRL     27
         4 001536   200063 756100                    STQ     MATCH_LEN,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:78   

      476    20051    7                     CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             20051                              TERMINAL_NAME.TEXT)

  20051  4 001537   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 001540   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 001541   000023 036000 5                  ADLQ    19
         4 001542   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 001543   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 001544   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 001545   200045 236100                    LDQ     I,,AUTO
         4 001546   000013 402003                    MPY     11,DU
         4 001547   000013 036003                    ADLQ    11,DU
         4 001550   000000 036000 xsym               ADLQ    DSEG2$
         4 001551   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001552   200067 633500                    EPPR3   NAME_LEN,,AUTO
         4 001553   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 001554   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001555   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 001556   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 001557   001704 702000 4                  TSX2    NO_REC_FOR_TERM1

      477    20052    8                     WHENRETURN DO;

      478    20053    8                        USERS_KEY.COUNT = 8;

  20053  4 001560   010000 236003                    LDQ     4096,DU
         4 001561   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      479    20054    8                        CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  20054  4 001562   200045 236100                    LDQ     I,,AUTO
         4 001563   000054 402007                    MPY     44,DL
         4 001564   000000 470400 xsym               LDP0    DSEG2$
         4 001565   040000 100506                    MLR     fill='040'O
         4 001566   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001567   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:79   
         4 001570   000052 236003                    LDQ     42,DU
         4 001571   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O

      480    20055    8                        ARS = DSEG3SIZE;

  20055  4 001572   000000 235000 xsym               LDA     DSEG3SIZE
         4 001573   200006 755100                    STA     ARS,,AUTO

      481    20056    8                        CALL ASB$READ_HLP(DSEG3$, ARS, 3)

  20056  4 001574   000004 236000 5                  LDQ     4
         4 001575   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001576   200006 630500                    EPPR0   ARS,,AUTO
         4 001577   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001600   000005 236000 5                  LDQ     5
         4 001601   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001602   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001603   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001604   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001605   001664 702000 4                  TSX2    s:20075

      482    20057    9                        WHENRETURN DO;

      483    20058    9                           CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(
             20058                                    NO_REC_FOR_TERM1);

  20058  4 001606   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 001607   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 001610   200006 631500                    EPPR1   ARS,,AUTO
         4 001611   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001612   000005 236000 5                  LDQ     5
         4 001613   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001614   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001615   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001616   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 001617   001704 702000 4                  TSX2    NO_REC_FOR_TERM1

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:80   
      484    20059   10                           IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  20059  4 001620   200016 234100                    SZN     CHECK,,AUTO
         4 001621   001627 605000 4                  TPL     s:20060
         4 001622   000000 470400 xsym               LDP0    DSEG3$
         4 001623   000000 236100                    LDQ     0,,PR0
         4 001624   000777 376007                    ANQ     511,DL
         4 001625   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 001626   001663 601000 4                  TNZ     s:20069

      485    20060   11                              IF ~ DISP THEN DO;

  20060  4 001627   200035 236100                    LDQ     DISP,,AUTO
         4 001630   400000 376003                    ANQ     -131072,DU
         4 001631   400000 676003                    ERQ     -131072,DU
         4 001632   001644 600000 4                  TZE     s:20064

      486    20061   11                                 CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  20061  4 001633   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 001634   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001635   000011 236000 5                  LDQ     9
         4 001636   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001637   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001640   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001641   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 001642   000000 011000                    NOP     0

      487    20062   11                                 END; /*  ~disp  */

  20062  4 001643   001660 710000 4                  TRA     s:20067

      488    20063   11                              ELSE DO;

      489    20064   11                                 CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20064  4 001644   000006 236000 5                  LDQ     6
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:81   
         4 001645   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 001646   200046 630500                    EPPR0   JCL,,AUTO
         4 001647   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 001650   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001651   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001652   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 001653   000000 011000                    NOP     0

      490    20065   11                                 CALL ASB$WRITE_LO (' ',1);

  20065  4 001654   000007 630400 5                  EPPR0   7
         4 001655   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001656   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 001657   000000 011000                    NOP     0

      491    20066   11                                 END; /*  Disp  */

      492    20067   10                              DISP_DEVICES = DISP_DEVICES + 1;

  20067  4 001660   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 001661   000001 035007                    ADLA    1,DL
         4 001662   200036 755100                    STA     DISP_DEVICES,,AUTO

      493    20068   10                              END; /*  The right type  */

      494    20069    9                           END; /*  Whenreturn from READ_HLP of device record  */

  20069  4 001663   001704 710000 4                  TRA     NO_REC_FOR_TERM1

      495    20070    9                        WHENALTRETURN DO;

      496    20071        /*E* ERROR: ASL-E$NODEVFORTERM-C
      497    20072             MESSAGE:  Device %U1 does not exist.
      498    20073             MESSAGE1:  It is listed in TWSN %U2 but can't be read from :HLP.
      499    20074        */
      500    20075    9                           AS_FIELD1.TEXT = KL$TWSNREC.DEVS.ACCT(I);

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:82   
  20075  4 001664   200045 236100                    LDQ     I,,AUTO
         4 001665   000054 402007                    MPY     44,DL
         4 001666   000000 470400 xsym               LDP0    DSEG2$
         4 001667   040000 100506                    MLR     fill='040'O
         4 001670   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 001671   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      501    20076    9                           AS_FIELD1.COUNT = 4;

  20076  4 001672   004000 236003                    LDQ     2048,DU
         4 001673   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      502    20077    9                           AS_FIELD2.TEXT = TWSN_CHAR;

  20077  4 001674   040000 100500                    MLR     fill='040'O
         4 001675   200111 000004                    ADSC9   TWSN_CHAR,,AUTO          cn=0,n=4
         4 001676   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      503    20078    9                           AS_FIELD2.COUNT = 4;

  20078  4 001677   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      504    20079                                %SCREAM (ERR#=%E$NODEVFORTERM,LEVEL=ERROR,MID='L');

  20091  4 001700   000024 630400 5                  EPPR0   20
         4 001701   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001702   000000 701000 xent               TSX1    ASH$ERROR
         4 001703   000000 011000                    NOP     0

      505    20094    9                           END; /*  Whenaltreturn from READ_HLP  */

      506    20095    8                        END; /*  Whenreturn from WILD_MATCH of terminal name */

      507    20096    7                     END; /*  Whenreturn  from WILD_MATCH of device name  */

      508    20097    6                  END; /*  A tdev  */

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:83   
      509    20098    5   NO_REC_FOR_TERM1:
      510    20099    5               END; /*  Do ndevs times  */

  20099  4 001704   200045 054100       NO_REC_FOR_* AOS     I,,AUTO
         4 001705   000000 470400 xsym               LDP0    DSEG2$
         4 001706   200045 236100                    LDQ     I,,AUTO
         4 001707   001474 604000 4                  TMI     s:20045
         4 001710   000004 116100                    CMPQ    4,,PR0
         4 001711   001474 602000 4                  TNC     s:20045

      511    20100    4            USERS_KEY.COUNT = 4;

  20100  4 001712   004000 236003                    LDQ     2048,DU
         4 001713   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      512    20101    4            USERS_KEY.TXTC = 'TERM';

  20101  4 001714   040000 100400                    MLR     fill='040'O
         4 001715   000015 000004 3                  ADSC9   LIST_STR+6               cn=0,n=4
         4 001716   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      513    20102    4            ARS = DSEG1SIZE;

  20102  4 001717   000000 235000 xsym               LDA     DSEG1SIZE
         4 001720   200006 755100                    STA     ARS,,AUTO

      514    20103    4            CALL ASB$READ_HLP(DSEG1$, ARS, 1 ) ALTRET( READ_ERR );

  20103  4 001721   000010 236000 5                  LDQ     8
         4 001722   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001723   200006 631500                    EPPR1   ARS,,AUTO
         4 001724   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 001725   000017 236000 5                  LDQ     15
         4 001726   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001727   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001730   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001731   000000 701000 xent               TSX1    ASB$READ_HLP
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:84   
         4 001732   003363 702000 4                  TSX2    READ_ERR

      515    20104    4            END; /*  If station name not blank  */

      516    20105    3         END; /*  Do 0 to KL$WSNCVT.LTWSN  */

  20105  4 001733   200112 235100                    LDA     TWSN_NUMBER,,AUTO
         4 001734   000001 035007                    ADLA    1,DL
         4 001735   200112 755100                    STA     TWSN_NUMBER,,AUTO
         4 001736   000000 470400 xsym               LDP0    DSEG1$
         4 001737   000001 236100                    LDQ     1,,PR0
         4 001740   200112 116100                    CMPQ    TWSN_NUMBER,,AUTO
         4 001741   001431 603000 4                  TRC     s:20038
         4 001742   003323 710000 4                  TRA     s:20325

      517    20106
      518    20107    2      SELECT  (%TERMINAL);

      519    20108
      520    20109    2      USERS_KEY.COUNT = 9;

  20109  4 001743   011000 236003                    LDQ     4608,DU
         4 001744   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      521    20110    2      CALL CONCAT( USERS_KEY.TXTC, TERMINAL_NAME.TEXT, '*' );

  20110  4 001745   040000 100500                    MLR     fill='040'O
         4 001746   200074 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 001747   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 001750   040000 100400                    MLR     fill='040'O
         4 001751   000025 000001 5                  ADSC9   21                       cn=0,n=1
         4 001752   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      522    20111    2      ARS = DSEG1SIZE;

  20111  4 001753   000000 235000 xsym               LDA     DSEG1SIZE
         4 001754   200006 755100                    STA     ARS,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:85   

      523    20112    2      STATION_NAME = TERMINAL_NAME;

  20112  4 001755   000100 100500                    MLR     fill='000'O
         4 001756   200074 000011                    ADSC9   TERMINAL_NAME,,AUTO      cn=0,n=9
         4 001757   200071 000011                    ADSC9   STATION_NAME,,AUTO       cn=0,n=9

      524    20113    2      CALL ASB$READ_HLP( DSEG1$, ARS, 1) ALTRET( READ_ALT3 );

  20113  4 001760   000010 236000 5                  LDQ     8
         4 001761   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 001762   200006 630500                    EPPR0   ARS,,AUTO
         4 001763   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 001764   000017 236000 5                  LDQ     15
         4 001765   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 001766   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 001767   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 001770   000000 701000 xent               TSX1    ASB$READ_HLP
         4 001771   003345 702000 4                  TSX2    READ_ALT3

      525    20114    2      CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_TERM#, %NO#, TERMINAL_NAME ) ALTRET(
             20114               FINISH_UP);

  20114  4 001772   200074 630500                    EPPR0   TERMINAL_NAME,,AUTO
         4 001773   200120 450500                    STP0    TWSN_NUMBER+6,,AUTO
         4 001774   000026 237000 5                  LDAQ    22
         4 001775   200116 757100                    STAQ    TWSN_NUMBER+4,,AUTO
         4 001776   200006 631500                    EPPR1   ARS,,AUTO
         4 001777   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002000   000017 236000 5                  LDQ     15
         4 002001   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002002   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002003   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 002004   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 002005   003367 702000 4                  TSX2    FINISH_UP

      526    20115    2      AS_FIELD1.COUNT = TERMINAL_NAME.COUNT;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:86   

  20115  4 002006   200074 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 002007   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      527    20116    2      AS_FIELD1.TEXT = TERMINAL_NAME.TEXT;

  20116  4 002010   040000 100500                    MLR     fill='040'O
         4 002011   200074 200010                    ADSC9   TERMINAL_NAME,,AUTO      cn=1,n=8
         4 002012   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      528    20117    2      AS_FIELD2.COUNT = 8;

  20117  4 002013   010000 236003                    LDQ     4096,DU
         4 002014   000000 552040 xsym               STBQ    AS_FIELD2,'40'O

      529    20118    2      AS_FIELD2.TEXT = 'TERMINAL';

  20118  4 002015   040000 100400                    MLR     fill='040'O
         4 002016   000017 000010 3                  ADSC9   LIST_STR+8               cn=0,n=8
         4 002017   000000 200050 xsym               ADSC9   AS_FIELD2                cn=1,n=40

      530    20119    2      USERS_KEY.COUNT = 8;

  20119  4 002020   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      531    20120    2      CALL CONCAT( USERS_KEY.TXTC, 'TWSN', DSEG1$->KL$DREC.TWSN# );

  20120  4 002021   040000 100400                    MLR     fill='040'O
         4 002022   000014 000004 3                  ADSC9   LIST_STR+5               cn=0,n=4
         4 002023   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 002024   000000 470400 xsym               LDP0    DSEG1$
         4 002025   040000 100500                    MLR     fill='040'O
         4 002026   000001 000004                    ADSC9   1,,PR0                   cn=0,n=4
         4 002027   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      532    20121    2      ARS = DSEG2SIZE;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:87   
  20121  4 002030   000000 235000 xsym               LDA     DSEG2SIZE
         4 002031   200006 755100                    STA     ARS,,AUTO

      533    20122    2      CALL ASB$READ_HLP( DSEG2$, ARS, 2 ) ALTRET( READ_ERR );

  20122  4 002032   000020 236000 5                  LDQ     16
         4 002033   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002034   200006 630500                    EPPR0   ARS,,AUTO
         4 002035   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002036   000021 236000 5                  LDQ     17
         4 002037   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002040   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002041   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002042   000000 701000 xent               TSX1    ASB$READ_HLP
         4 002043   003363 702000 4                  TSX2    READ_ERR

      534    20123    3      DO I = 0 TO KL$TWSNREC.NDEV - 1;

  20123  4 002044   200045 450100                    STZ     I,,AUTO
         4 002045   002236 710000 4                  TRA     NO_REC_FOR_TERM2+1

      535    20124    3         USERS_KEY.COUNT = 8;

  20124  4 002046   010000 236003                    LDQ     4096,DU
         4 002047   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      536    20125    4         IF KL$TWSNREC.DEVS.TDEV(I) THEN DO; /*  A tdev  */

  20125  4 002050   200045 236100                    LDQ     I,,AUTO
         4 002051   000013 402007                    MPY     11,DL
         4 002052   000000 470400 xsym               LDP0    DSEG2$
         4 002053   000006 236106                    LDQ     6,QL,PR0
         4 002054   000100 316007                    CANQ    64,DL
         4 002055   002235 600000 4                  TZE     NO_REC_FOR_TERM2

      537    20126    4            MATCH_LEN = DEV_NAME.COUNT;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:88   
  20126  4 002056   200021 236100                    LDQ     DEV_NAME,,AUTO
         4 002057   000033 772000                    QRL     27
         4 002060   200063 756100                    STQ     MATCH_LEN,,AUTO

      538    20127    4            CALL ASB$WILD_MATCH (4,KL$TWSNREC.DEVS.ACCT(I),MATCH_LEN,DEV_NAME.TEXT)

  20127  4 002061   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 002062   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 002063   000016 036000 5                  ADLQ    14
         4 002064   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 002065   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 002066   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 002067   200045 236100                    LDQ     I,,AUTO
         4 002070   000013 402003                    MPY     11,DU
         4 002071   000011 036003                    ADLQ    9,DU
         4 002072   000000 036000 xsym               ADLQ    DSEG2$
         4 002073   000022 235000 5                  LDA     18
         4 002074   200114 757100                    STAQ    TWSN_NUMBER+2,,AUTO
         4 002075   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002076   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002077   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 002100   002235 702000 4                  TSX2    NO_REC_FOR_TERM2

      539    20128    5            WHENRETURN DO;

      540    20129    5               CALL INDEX (NAME_LEN,' ',KL$TWSNREC.DEVS.TERM(I));

  20129  4 002101   200045 236100                    LDQ     I,,AUTO
         4 002102   000054 402007                    MPY     44,DL
         4 002103   000000 470400 xsym               LDP0    DSEG2$
         4 002104   000000 124506                    SCM     mask='000'O
         4 002105   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         4 002106   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002107   200067 000100                    ARG     NAME_LEN,,AUTO

      541    20130    5               MATCH_LEN = TERMINAL_NAME.COUNT;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:89   
  20130  4 002110   200074 236100                    LDQ     TERMINAL_NAME,,AUTO
         4 002111   000033 772000                    QRL     27
         4 002112   200063 756100                    STQ     MATCH_LEN,,AUTO

      542    20131    5               CALL ASB$WILD_MATCH (NAME_LEN,KL$TWSNREC.DEVS.TERM(I),MATCH_LEN,
             20131                        TERMINAL_NAME.TEXT)

  20131  4 002113   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 002114   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 002115   000023 036000 5                  ADLQ    19
         4 002116   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 002117   200063 631500                    EPPR1   MATCH_LEN,,AUTO
         4 002120   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 002121   200045 236100                    LDQ     I,,AUTO
         4 002122   000013 402003                    MPY     11,DU
         4 002123   000013 036003                    ADLQ    11,DU
         4 002124   000000 036000 xsym               ADLQ    DSEG2$
         4 002125   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 002126   200067 633500                    EPPR3   NAME_LEN,,AUTO
         4 002127   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 002130   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002131   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002132   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 002133   002235 702000 4                  TSX2    NO_REC_FOR_TERM2

      543    20132    6               WHENRETURN DO;

      544    20133    6                  CALL INSERT(USERS_KEY.TXTC,0,9,KL$TWSNREC.DEVS.ACCT(I),'*');

  20133  4 002134   200045 236100                    LDQ     I,,AUTO
         4 002135   000054 402007                    MPY     44,DL
         4 002136   000000 470400 xsym               LDP0    DSEG2$
         4 002137   040000 100506                    MLR     fill='040'O
         4 002140   000011 000010                    ADSC9   9,Q,PR0                  cn=0,n=8
         4 002141   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 002142   000052 236003                    LDQ     42,DU
         4 002143   000002 552020 xsym               STBQ    USERS_KEY+2,'20'O
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:90   

      545    20134    6                  ARS = DSEG3SIZE;

  20134  4 002144   000000 235000 xsym               LDA     DSEG3SIZE
         4 002145   200006 755100                    STA     ARS,,AUTO

      546    20135    6                  CALL ASB$READ_HLP(DSEG3$, ARS, 3) ALTRET(NO_REC_FOR_TERM2);

  20135  4 002146   000004 236000 5                  LDQ     4
         4 002147   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002150   200006 630500                    EPPR0   ARS,,AUTO
         4 002151   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002152   000005 236000 5                  LDQ     5
         4 002153   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002154   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002155   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002156   000000 701000 xent               TSX1    ASB$READ_HLP
         4 002157   002235 702000 4                  TSX2    NO_REC_FOR_TERM2

      547    20136    6                 CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE ) ALTRET(NO_REC_FOR_TERM2)
             20136                           ;

  20136  4 002160   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 002161   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 002162   200006 631500                    EPPR1   ARS,,AUTO
         4 002163   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002164   000005 236000 5                  LDQ     5
         4 002165   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002166   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002167   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002170   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 002171   002235 702000 4                  TSX2    NO_REC_FOR_TERM2

      548    20137    7                  IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  20137  4 002172   200016 234100                    SZN     CHECK,,AUTO
         4 002173   002201 605000 4                  TPL     s:20138
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:91   
         4 002174   000000 470400 xsym               LDP0    DSEG3$
         4 002175   000000 236100                    LDQ     0,,PR0
         4 002176   000777 376007                    ANQ     511,DL
         4 002177   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 002200   002235 601000 4                  TNZ     NO_REC_FOR_TERM2

      549    20138    8                     IF ~ DISP THEN DO;

  20138  4 002201   200035 236100                    LDQ     DISP,,AUTO
         4 002202   400000 376003                    ANQ     -131072,DU
         4 002203   400000 676003                    ERQ     -131072,DU
         4 002204   002216 600000 4                  TZE     s:20142

      550    20139    8                        CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  20139  4 002205   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 002206   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002207   000011 236000 5                  LDQ     9
         4 002210   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002211   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002213   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 002214   000000 011000                    NOP     0

      551    20140    8                        END; /*  ~disp  */

  20140  4 002215   002232 710000 4                  TRA     s:20145

      552    20141    8                     ELSE DO;

      553    20142    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20142  4 002216   000006 236000 5                  LDQ     6
         4 002217   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 002220   200046 630500                    EPPR0   JCL,,AUTO
         4 002221   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 002222   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:92   
         4 002223   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002224   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 002225   000000 011000                    NOP     0

      554    20143    8                        CALL ASB$WRITE_LO (' ',1);

  20143  4 002226   000007 630400 5                  EPPR0   7
         4 002227   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002230   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002231   000000 011000                    NOP     0

      555    20144    8                        END; /*  Disp  */

      556    20145    7                     DISP_DEVICES = DISP_DEVICES + 1;

  20145  4 002232   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 002233   000001 035007                    ADLA    1,DL
         4 002234   200036 755100                    STA     DISP_DEVICES,,AUTO

      557    20146    7                     END; /*  The right type  */

      558    20147    6                  END; /*  Whenreturn  */

      559    20148    5               END; /*  Whenreturn  */

      560    20149    4            END; /*  A tdev  */

      561    20150    3   NO_REC_FOR_TERM2:
      562    20151    3         END; /*  Do ndevs times  */

  20151  4 002235   200045 054100       NO_REC_FOR_* AOS     I,,AUTO
         4 002236   000000 470400 xsym               LDP0    DSEG2$
         4 002237   200045 236100                    LDQ     I,,AUTO
         4 002240   002046 604000 4                  TMI     s:20124
         4 002241   000004 116100                    CMPQ    4,,PR0
         4 002242   002046 602000 4                  TNC     s:20124
         4 002243   003323 710000 4                  TRA     s:20325
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:93   

      563    20152
      564    20153    2      SELECT  (%TPDEV_WILD);

      565    20154
      566    20155                 /*  Setup begin key  */
      567    20156                 /*  Setup end key  */
      568    20157    2      CALL INDEX (I,'?',TPDEV.ACCT);

  20157  4 002244   000000 124500                    SCM     mask='000'O
         4 002245   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8
         4 002246   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 002247   200045 000100                    ARG     I,,AUTO

      569    20158    2      BEGIN_KEY.TEXT = SUBSTR (TPDEV.ACCT,0,I);

  20158  4 002250   200045 720100                    LXL0    I,,AUTO
         4 002251   040100 100540                    MLR     fill='040'O
         4 002252   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=*X0
         4 002253   200007 200024                    ADSC9   BEGIN_KEY,,AUTO          cn=1,n=20

      570    20159    2      CALL CONCAT (END_KEY.TEXT,SUBSTR (TPDEV.ACCT,0,I),'~');

  20159  4 002254   040100 100540                    MLR     fill='040'O
         4 002255   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=*X0
         4 002256   200037 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 002257   200045 236100                    LDQ     I,,AUTO
         4 002260   000024 116007                    CMPQ    20,DL
         4 002261   002267 605000 4                  TPL     s:20160
         4 002262   777753 621006                    EAX1    -21,QL
         4 002263   777777 661003                    ERX1    -1,DU
         4 002264   040146 100400                    MLR     fill='040'O
         4 002265   000030 000001 5                  ADSC9   24                       cn=0,n=1
         4 002266   200037 200011                    ADSC9   END_KEY,Q,AUTO           cn=1,n=*X1

      571    20160    2      CALL INDEX (I,'?',TPDEV.NAME);

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:94   
  20160  4 002267   000000 124500                    SCM     mask='000'O
         4 002270   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12
         4 002271   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 002272   200045 000100                    ARG     I,,AUTO

      572    20161    2      SUBSTR (BEGIN_KEY.TEXT,8,I) = SUBSTR (TPDEV.NAME,0,I);

  20161  4 002273   200045 720100                    LXL0    I,,AUTO
         4 002274   040140 100540                    MLR     fill='040'O
         4 002275   200101 200010                    ADSC9   TPDEV+2,,AUTO            cn=1,n=*X0
         4 002276   200011 200010                    ADSC9   BEGIN_KEY+2,,AUTO        cn=1,n=*X0

      573    20162    2      BEGIN_KEY.COUNT = 8+I;

  20162  4 002277   200045 236100                    LDQ     I,,AUTO
         4 002300   000010 036007                    ADLQ    8,DL
         4 002301   000033 736000                    QLS     27
         4 002302   200007 552140                    STBQ    BEGIN_KEY,'40'O,AUTO

      574    20163    2      END_KEY.COUNT = 8+I+1;

  20163  4 002303   200045 236100                    LDQ     I,,AUTO
         4 002304   000011 036007                    ADLQ    9,DL
         4 002305   000033 736000                    QLS     27
         4 002306   200037 552140                    STBQ    END_KEY,'40'O,AUTO

      575    20164    2      SUBSTR (END_KEY.TEXT,8,I) = SUBSTR (TPDEV.NAME,0,I);

  20164  4 002307   040140 100540                    MLR     fill='040'O
         4 002310   200101 200010                    ADSC9   TPDEV+2,,AUTO            cn=1,n=*X0
         4 002311   200041 200010                    ADSC9   END_KEY+2,,AUTO          cn=1,n=*X0

      576    20165    2      IF END_KEY.COUNT < 21 THEN

  20165  4 002312   200037 236100                    LDQ     END_KEY,,AUTO
         4 002313   777000 376003                    ANQ     -512,DU
         4 002314   025000 116003                    CMPQ    10752,DU
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:95   
         4 002315   002322 603000 4                  TRC     s:20167

      577    20166    2         SUBSTR (END_KEY.TEXT,8+I,1) = '~';

  20166  4 002316   200045 235100                    LDA     I,,AUTO
         4 002317   040105 100400                    MLR     fill='040'O
         4 002320   000030 000001 5                  ADSC9   24                       cn=0,n=1
         4 002321   200041 200001                    ADSC9   END_KEY+2,A,AUTO         cn=1,n=1

      578    20167    2      USERS_KEY = BEGIN_KEY;

  20167  4 002322   000000 100500                    MLR     fill='000'O
         4 002323   200007 000025                    ADSC9   BEGIN_KEY,,AUTO          cn=0,n=21
         4 002324   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      579    20168    2      CALL ASB$PREC_HLP;

  20168  4 002325   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002326   000000 701000 xent               TSX1    ASB$PREC_HLP
         4 002327   000000 011000                    NOP     0

      580    20169    2      ARS = DSEG3SIZE;

  20169  4 002330   000000 235000 xsym               LDA     DSEG3SIZE
         4 002331   200006 755100                    STA     ARS,,AUTO

      581    20170    3      CALL ASB$READ_HLP_SEQ (DSEG3$,ARS,3) WHENRETURN DO;

  20170  4 002332   000004 236000 5                  LDQ     4
         4 002333   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002334   200006 630500                    EPPR0   ARS,,AUTO
         4 002335   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002336   000005 236000 5                  LDQ     5
         4 002337   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002340   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002341   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002342   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:96   
         4 002343   002624 702000 4                  TSX2    s:20217

      582    20171    3         LAST_KEY = USERS_KEY;

  20171  4 002344   000100 100400                    MLR     fill='000'O
         4 002345   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 002346   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42

      583    20172    4         DO WHILE USERS_KEY.TXTC < END_KEY.TEXT;

  20172  4 002347   040100 106400                    CMPC    fill='040'O
         4 002350   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 002351   200037 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 002352   002624 603000 4                  TRC     s:20217

      584    20173    4            CALL ASB$CHECK_TYPE (DSEG3$, ARS, DEV_TYPE)

  20173  4 002353   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 002354   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 002355   200006 631500                    EPPR1   ARS,,AUTO
         4 002356   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002357   000005 236000 5                  LDQ     5
         4 002360   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002361   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002362   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002363   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 002364   002567 702000 4                  TSX2    s:20209

      585    20174    5            WHENRETURN DO;

      586    20175    6               IF NOT CHECK OR DSEG3$->KL$DREC.SUPER = DEV_TYPE THEN DO;

  20175  4 002365   200016 234100                    SZN     CHECK,,AUTO
         4 002366   002374 605000 4                  TPL     s:20177
         4 002367   000000 470400 xsym               LDP0    DSEG3$
         4 002370   000000 236100                    LDQ     0,,PR0
         4 002371   000777 376007                    ANQ     511,DL
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:97   
         4 002372   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 002373   002567 601000 4                  TNZ     s:20209

      587    20176        /*  Calculate ACCT_LEN and MATCH_LEN  */
      588    20177    6                  CALL INDEX (ACCT_LEN,' ',USERS_KEY.TXTC);

  20177  4 002374   000000 124400                    SCM     mask='000'O
         4 002375   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 002376   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002377   200005 000100                    ARG     ACCT_LEN,,AUTO

      589    20178    6                  IF ACCT_LEN > 7 THEN ACCT_LEN = 8;

  20178  4 002400   200005 235100                    LDA     ACCT_LEN,,AUTO
         4 002401   000010 115007                    CMPA    8,DL
         4 002402   002406 602000 4                  TNC     s:20179

  20178  4 002403   000010 236007                    LDQ     8,DL
         4 002404   200005 756100                    STQ     ACCT_LEN,,AUTO
         4 002405   002412 710000 4                  TRA     s:20180

      590    20179    6                  ELSE IF ACCT_LEN = 0 THEN ACCT_LEN = 1;

  20179  4 002406   000000 115003                    CMPA    0,DU
         4 002407   002412 601000 4                  TNZ     s:20180

  20179  4 002410   000001 236007                    LDQ     1,DL
         4 002411   200005 756100                    STQ     ACCT_LEN,,AUTO

      591    20180    6                  CALL INDEX (MATCH_LEN,' ',TPDEV.ACCT);

  20180  4 002412   000000 124500                    SCM     mask='000'O
         4 002413   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8
         4 002414   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002415   200063 000100                    ARG     MATCH_LEN,,AUTO

      592    20181    6                  IF MATCH_LEN > 7 THEN MATCH_LEN = 8;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:98   

  20181  4 002416   200063 235100                    LDA     MATCH_LEN,,AUTO
         4 002417   000010 115007                    CMPA    8,DL
         4 002420   002424 602000 4                  TNC     s:20182

  20181  4 002421   000010 236007                    LDQ     8,DL
         4 002422   200063 756100                    STQ     MATCH_LEN,,AUTO
         4 002423   002430 710000 4                  TRA     s:20183

      593    20182    6                  ELSE IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  20182  4 002424   000000 115003                    CMPA    0,DU
         4 002425   002430 601000 4                  TNZ     s:20183

  20182  4 002426   000001 236007                    LDQ     1,DL
         4 002427   200063 756100                    STQ     MATCH_LEN,,AUTO

      594    20183    6                  ACCT = SUBSTR (USERS_KEY.TXTC,0,ACCT_LEN);

  20183  4 002430   200005 720100                    LXL0    ACCT_LEN,,AUTO
         4 002431   040100 100440                    MLR     fill='040'O
         4 002432   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         4 002433   200003 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      595    20184    6                  CALL ASB$WILD_MATCH (ACCT_LEN,ACCT,MATCH_LEN,TPDEV.ACCT)

  20184  4 002434   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 002435   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 002436   000031 036000 5                  ADLQ    25
         4 002437   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 002440   200063 630500                    EPPR0   MATCH_LEN,,AUTO
         4 002441   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 002442   200003 631500                    EPPR1   ACCT,,AUTO
         4 002443   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002444   200005 633500                    EPPR3   ACCT_LEN,,AUTO
         4 002445   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 002446   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:99   
         4 002447   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002450   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 002451   002567 702000 4                  TSX2    s:20209

      596    20185    7                  WHENRETURN DO;

      597    20186        /*  Calculate NAME_LEN and MATCH_LEN  */
      598    20187    7                     CALL INDEX (NAME_LEN,' ',USERS_KEY.TXTC,8);

  20187  4 002452   000000 124400                    SCM     mask='000'O
         4 002453   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33
         4 002454   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002455   200067 000100                    ARG     NAME_LEN,,AUTO
         4 002456   200067 235100                    LDA     NAME_LEN,,AUTO
         4 002457   000010 035007                    ADLA    8,DL
         4 002460   200067 755100                    STA     NAME_LEN,,AUTO

      599    20188    7                     IF NAME_LEN > 19 THEN NAME_LEN = 12;

  20188  4 002461   000024 115007                    CMPA    20,DL
         4 002462   002466 602000 4                  TNC     s:20189

  20188  4 002463   000014 236007                    LDQ     12,DL
         4 002464   200067 756100                    STQ     NAME_LEN,,AUTO
         4 002465   002475 710000 4                  TRA     s:20191

      600    20189    7                     ELSE IF NAME_LEN = 8 THEN NAME_LEN = 1;

  20189  4 002466   000010 115007                    CMPA    8,DL
         4 002467   002473 601000 4                  TNZ     s:20190

  20189  4 002470   000001 236007                    LDQ     1,DL
         4 002471   200067 756100                    STQ     NAME_LEN,,AUTO
         4 002472   002475 710000 4                  TRA     s:20191

      601    20190    7                        ELSE NAME_LEN = NAME_LEN - 8;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:100  
  20190  4 002473   000010 135007                    SBLA    8,DL
         4 002474   200067 755100                    STA     NAME_LEN,,AUTO

      602    20191    7                     CALL INDEX (MATCH_LEN,' ',TPDEV.NAME);

  20191  4 002475   000000 124500                    SCM     mask='000'O
         4 002476   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12
         4 002477   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002500   200063 000100                    ARG     MATCH_LEN,,AUTO

      603    20192    7                     IF MATCH_LEN > 11 THEN MATCH_LEN = 12;

  20192  4 002501   200063 235100                    LDA     MATCH_LEN,,AUTO
         4 002502   000014 115007                    CMPA    12,DL
         4 002503   002507 602000 4                  TNC     s:20193

  20192  4 002504   000014 236007                    LDQ     12,DL
         4 002505   200063 756100                    STQ     MATCH_LEN,,AUTO
         4 002506   002513 710000 4                  TRA     s:20194

      604    20193    7                     ELSE IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  20193  4 002507   000000 115003                    CMPA    0,DU
         4 002510   002513 601000 4                  TNZ     s:20194

  20193  4 002511   000001 236007                    LDQ     1,DL
         4 002512   200063 756100                    STQ     MATCH_LEN,,AUTO

      605    20194    7                     NAME = SUBSTR (USERS_KEY.TXTC,8,NAME_LEN);

  20194  4 002513   200067 720100                    LXL0    NAME_LEN,,AUTO
         4 002514   040100 100440                    MLR     fill='040'O
         4 002515   000002 200010 xsym               ADSC9   USERS_KEY+2              cn=1,n=*X0
         4 002516   200064 000014                    ADSC9   NAME,,AUTO               cn=0,n=12

      606    20195    7                     CALL ASB$WILD_MATCH (NAME_LEN,NAME,MATCH_LEN,TPDEV.NAME)

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:101  
  20195  4 002517   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 002520   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 002521   000032 036000 5                  ADLQ    26
         4 002522   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 002523   200063 630500                    EPPR0   MATCH_LEN,,AUTO
         4 002524   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 002525   200064 631500                    EPPR1   NAME,,AUTO
         4 002526   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002527   200067 633500                    EPPR3   NAME_LEN,,AUTO
         4 002530   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 002531   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002532   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 002533   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 002534   002567 702000 4                  TSX2    s:20209

      607    20196    8                     WHENRETURN DO;

      608    20197    9                        IF DISP THEN DO;

  20197  4 002535   200035 234100                    SZN     DISP,,AUTO
         4 002536   002554 605000 4                  TPL     s:20202

      609    20198    9                           CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20198  4 002537   000006 236000 5                  LDQ     6
         4 002540   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 002541   200046 630500                    EPPR0   JCL,,AUTO
         4 002542   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 002543   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002544   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002545   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 002546   000000 011000                    NOP     0

      610    20199    9                           CALL ASB$WRITE_LO (' ',1);

  20199  4 002547   000007 630400 5                  EPPR0   7
         4 002550   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:102  
         4 002551   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002552   000000 011000                    NOP     0

      611    20200    9                           END;  /* Disp  */

  20200  4 002553   002564 710000 4                  TRA     s:20204

      612    20201    9                        ELSE DO;

      613    20202    9                           CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  20202  4 002554   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 002555   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002556   000011 236000 5                  LDQ     9
         4 002557   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002560   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002561   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002562   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 002563   000000 011000                    NOP     0

      614    20203    9                           END; /*  List  */

      615    20204    8                        DISP_DEVICES = DISP_DEVICES + 1;

  20204  4 002564   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 002565   000001 035007                    ADLA    1,DL
         4 002566   200036 755100                    STA     DISP_DEVICES,,AUTO

      616    20205    8                        END; /*  Whenreturn from ASB$WILD_MATCH on name  */

      617    20206    7                     END; /*  Whenreturn from ASB$WILD_MATCH on acct  */

      618    20207    6                  END; /*  Not check or .SUPER=DEV_TYPE  */

      619    20208    5               END; /*  Whenreturn from ASB$CHECK_TYPE  */

      620    20209    5            IF LAST_KEY ~= USERS_KEY THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:103  

  20209  4 002567   000000 106500                    CMPC    fill='000'O
         4 002570   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42
         4 002571   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 002572   002601 600000 4                  TZE     s:20213

      621    20210    5               USERS_KEY = LAST_KEY;

  20210  4 002573   000000 100500                    MLR     fill='000'O
         4 002574   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42
         4 002575   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      622    20211    5               CALL ASB$PREC_AND_SKIP_HLP;

  20211  4 002576   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 002577   000000 701000 xent               TSX1    ASB$PREC_AND_SKIP_HLP
         4 002600   000000 011000                    NOP     0

      623    20212    5               END; /*  Last ~= users  */

      624    20213    4            ARS = DSEG3SIZE;

  20213  4 002601   000000 235000 xsym               LDA     DSEG3SIZE
         4 002602   200006 755100                    STA     ARS,,AUTO

      625    20214    4            CALL ASB$READ_HLP_SEQ (DSEG3$, ARS, 3) ALTRET(FINISH_UP);

  20214  4 002603   000004 236000 5                  LDQ     4
         4 002604   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002605   200006 630500                    EPPR0   ARS,,AUTO
         4 002606   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002607   000005 236000 5                  LDQ     5
         4 002610   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002611   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002612   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002613   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 002614   003367 702000 4                  TSX2    FINISH_UP
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:104  

      626    20215    4            LAST_KEY = USERS_KEY ;

  20215  4 002615   000100 100400                    MLR     fill='000'O
         4 002616   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 002617   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42

      627    20216    4            END; /*  Do while USERS_KEY < END_KEY  */

  20216  4 002620   040100 106400                    CMPC    fill='040'O
         4 002621   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 002622   200037 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 002623   002353 602000 4                  TNC     s:20173

      628    20217    3         END; /*  Whenreturn from ASB$READ_HLP_SEQ  */

  20217  4 002624   003323 710000 4                  TRA     s:20325

      629    20218
      630    20219    2      SELECT  (%SINGLE_TPDEVICE);

      631    20220
      632    20221    2      ARS = DSEG3SIZE;

  20221  4 002625   000000 235000 xsym               LDA     DSEG3SIZE
         4 002626   200006 755100                    STA     ARS,,AUTO

      633    20222    2      USERS_KEY = TPDEV;

  20222  4 002627   000000 100500                    MLR     fill='000'O
         4 002630   200077 000025                    ADSC9   TPDEV,,AUTO              cn=0,n=21
         4 002631   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      634    20223    2      CALL INDEX (I,' ',TPDEV.ACCT);

  20223  4 002632   000000 124500                    SCM     mask='000'O
         4 002633   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=8
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:105  
         4 002634   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002635   200045 000100                    ARG     I,,AUTO

      635    20224    2      CALL INDEX (COUNT,' ',TPDEV.NAME);

  20224  4 002636   000000 124500                    SCM     mask='000'O
         4 002637   200101 200014                    ADSC9   TPDEV+2,,AUTO            cn=1,n=12
         4 002640   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 002641   200017 000100                    ARG     COUNT,,AUTO

      636    20225    2     CALL CONCAT (AS_FIELD1.TEXT,SUBSTR(TPDEV.ACCT,0,I),',',SUBSTR(TPDEV.NAME,0,COUNT)
             20225               );

  20225  4 002642   200045 720100                    LXL0    I,,AUTO
         4 002643   040000 100540                    MLR     fill='040'O
         4 002644   200077 200010                    ADSC9   TPDEV,,AUTO              cn=1,n=*X0
         4 002645   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40
         4 002646   200045 236100                    LDQ     I,,AUTO
         4 002647   000050 116007                    CMPQ    40,DL
         4 002650   002666 605000 4                  TPL     s:20226
         4 002651   777727 621006                    EAX1    -41,QL
         4 002652   777777 661003                    ERX1    -1,DU
         4 002653   040046 100400                    MLR     fill='040'O
         4 002654   000033 000001 5                  ADSC9   27                       cn=0,n=1
         4 002655   000000 200011 xsym               ADSC9   AS_FIELD1,Q              cn=1,n=*X1
         4 002656   000047 116007                    CMPQ    39,DL
         4 002657   002666 605000 4                  TPL     s:20226
         4 002660   777730 622006                    EAX2    -40,QL
         4 002661   777777 662003                    ERX2    -1,DU
         4 002662   200017 723100                    LXL3    COUNT,,AUTO
         4 002663   040046 100540                    MLR     fill='040'O
         4 002664   200101 200013                    ADSC9   TPDEV+2,,AUTO            cn=1,n=*X3
         4 002665   000000 400012 xsym               ADSC9   AS_FIELD1,Q              cn=2,n=*X2

      637    20226    2      AS_FIELD1.COUNT = I + COUNT + 1;

  20226  4 002666   200017 036100                    ADLQ    COUNT,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:106  
         4 002667   000001 036007                    ADLQ    1,DL
         4 002670   000033 736000                    QLS     27
         4 002671   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      638    20227    3      CALL ASB$READ_HLP (DSEG3$, ARS, 3) WHENALTRETURN DO;

  20227  4 002672   000004 236000 5                  LDQ     4
         4 002673   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 002674   200006 630500                    EPPR0   ARS,,AUTO
         4 002675   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 002676   000005 236000 5                  LDQ     5
         4 002677   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002700   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002701   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 002702   000000 701000 xent               TSX1    ASB$READ_HLP
         4 002703   002705 702000 4                  TSX2    s:20240
         4 002704   002712 710000 4                  TRA     s:20245

      639    20228              %SCREAM (ERR#=E$DEV_NO_EXIST2,LEVEL=ERROR,MID='L');

  20240  4 002705   000034 630400 5                  EPPR0   28
         4 002706   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 002707   000000 701000 xent               TSX1    ASH$ERROR
         4 002710   000000 011000                    NOP     0

      640    20243    3         RETURN;

  20243  4 002711   000000 702200 xent               TSX2  ! X66_ARET

      641    20244    3         END; /*   Whenreturn from ASB$READ_HLP  */
      642    20245    3      IF KL$TREC.SUPER = DEV_TYPE THEN DO;

  20245  4 002712   000000 470400 xsym               LDP0    DSEG3$
         4 002713   000000 236100                    LDQ     0,,PR0
         4 002714   000777 376007                    ANQ     511,DL
         4 002715   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 002716   003323 601000 4                  TNZ     s:20325
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:107  

      643    20246    4         IF DISP THEN DO;

  20246  4 002717   200035 234100                    SZN     DISP,,AUTO
         4 002720   002736 605000 4                  TPL     s:20251

      644    20247    4            CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20247  4 002721   000006 236000 5                  LDQ     6
         4 002722   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 002723   200046 631500                    EPPR1   JCL,,AUTO
         4 002724   200114 451500                    STP1    TWSN_NUMBER+2,,AUTO
         4 002725   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 002726   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002727   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 002730   000000 011000                    NOP     0

      645    20248    4            CALL ASB$WRITE_LO (' ',1);

  20248  4 002731   000007 630400 5                  EPPR0   7
         4 002732   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002733   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 002734   000000 011000                    NOP     0

      646    20249    4            END;  /*  Disp  */

  20249  4 002735   002746 710000 4                  TRA     s:20253

      647    20250    4         ELSE DO;

      648    20251    4            CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  20251  4 002736   200036 631500                    EPPR1   DISP_DEVICES,,AUTO
         4 002737   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 002740   000011 236000 5                  LDQ     9
         4 002741   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 002742   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:108  
         4 002743   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 002744   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 002745   000000 011000                    NOP     0

      649    20252    4            END; /*  List  */

      650    20253    3         DISP_DEVICES = DISP_DEVICES + 1;

  20253  4 002746   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 002747   000001 035007                    ADLA    1,DL
         4 002750   200036 755100                    STA     DISP_DEVICES,,AUTO

      651    20254    3         END; /*  KL$TREC.SUPER = DEV_TYPE  */

  20254  4 002751   003323 710000 4                  TRA     s:20325

      652    20255
      653    20256    2      SELECT  (%DEV_WILD);

      654    20257
      655    20258                 /*  Setup begin key  */
      656    20259                 /*  Setup end key  */
      657    20260    2      CALL INDEX (I,'?',DEV_NAME.TEXT);

  20260  4 002752   000000 124500                    SCM     mask='000'O
         4 002753   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 002754   000000 000001 5                  ADSC9   0                        cn=0,n=1
         4 002755   200045 000100                    ARG     I,,AUTO

      658    20261    2      BEGIN_KEY.TEXT = SUBSTR (DEV_NAME.TEXT,0,I);

  20261  4 002756   200045 720100                    LXL0    I,,AUTO
         4 002757   040100 100540                    MLR     fill='040'O
         4 002760   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X0
         4 002761   200007 200024                    ADSC9   BEGIN_KEY,,AUTO          cn=1,n=20

      659    20262    2      CALL CONCAT (END_KEY.TEXT,SUBSTR (DEV_NAME.TEXT,0,I),'~');
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:109  

  20262  4 002762   040100 100540                    MLR     fill='040'O
         4 002763   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X0
         4 002764   200037 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 002765   200045 236100                    LDQ     I,,AUTO
         4 002766   000024 116007                    CMPQ    20,DL
         4 002767   002775 605000 4                  TPL     s:20263
         4 002770   777753 621006                    EAX1    -21,QL
         4 002771   777777 661003                    ERX1    -1,DU
         4 002772   040146 100400                    MLR     fill='040'O
         4 002773   000030 000001 5                  ADSC9   24                       cn=0,n=1
         4 002774   200037 200011                    ADSC9   END_KEY,Q,AUTO           cn=1,n=*X1

      660    20263    2      BEGIN_KEY.COUNT = 8;

  20263  4 002775   010000 236003                    LDQ     4096,DU
         4 002776   200007 552140                    STBQ    BEGIN_KEY,'40'O,AUTO

      661    20264    2      END_KEY.COUNT = 8;

  20264  4 002777   200037 552140                    STBQ    END_KEY,'40'O,AUTO

      662    20265    2      USERS_KEY = BEGIN_KEY;

  20265  4 003000   000000 100500                    MLR     fill='000'O
         4 003001   200007 000025                    ADSC9   BEGIN_KEY,,AUTO          cn=0,n=21
         4 003002   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      663    20266    2      CALL ASB$PREC_HLP;

  20266  4 003003   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003004   000000 701000 xent               TSX1    ASB$PREC_HLP
         4 003005   000000 011000                    NOP     0

      664    20267    2      ARS = DSEG3SIZE;

  20267  4 003006   000000 235000 xsym               LDA     DSEG3SIZE
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:110  
         4 003007   200006 755100                    STA     ARS,,AUTO

      665    20268    3      CALL ASB$READ_HLP_SEQ (DSEG3$,ARS,3) WHENRETURN DO;

  20268  4 003010   000004 236000 5                  LDQ     4
         4 003011   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 003012   200006 630500                    EPPR0   ARS,,AUTO
         4 003013   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 003014   000005 236000 5                  LDQ     5
         4 003015   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003016   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003017   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 003020   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 003021   003217 702000 4                  TSX2    s:20303

      666    20269    3         LAST_KEY = USERS_KEY;

  20269  4 003022   000100 100400                    MLR     fill='000'O
         4 003023   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 003024   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42

      667    20270    4         DO WHILE USERS_KEY.TXTC < END_KEY.TEXT;

  20270  4 003025   040100 106400                    CMPC    fill='040'O
         4 003026   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 003027   200037 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 003030   003217 603000 4                  TRC     s:20303

      668    20271    4            CALL ASB$CHECK_TYPE (DSEG3$, ARS, DEV_TYPE)

  20271  4 003031   200034 630500                    EPPR0   DEV_TYPE,,AUTO
         4 003032   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 003033   200006 631500                    EPPR1   ARS,,AUTO
         4 003034   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 003035   000005 236000 5                  LDQ     5
         4 003036   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003037   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:111  
         4 003040   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 003041   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 003042   003162 702000 4                  TSX2    s:20295

      669    20272    5            WHENRETURN DO;

      670    20273    6               IF NOT CHECK OR KL$TREC.SUPER = DEV_TYPE THEN DO;

  20273  4 003043   200016 234100                    SZN     CHECK,,AUTO
         4 003044   003052 605000 4                  TPL     s:20275
         4 003045   000000 470400 xsym               LDP0    DSEG3$
         4 003046   000000 236100                    LDQ     0,,PR0
         4 003047   000777 376007                    ANQ     511,DL
         4 003050   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 003051   003162 601000 4                  TNZ     s:20295

      671    20274        /*  Calculate ACCT_LEN and MATCH_LEN  */
      672    20275    6                  CALL INDEX (ACCT_LEN,' ',USERS_KEY.TXTC);

  20275  4 003052   000000 124400                    SCM     mask='000'O
         4 003053   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 003054   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003055   200005 000100                    ARG     ACCT_LEN,,AUTO

      673    20276    6                  IF ACCT_LEN > 7 THEN ACCT_LEN = 8;

  20276  4 003056   200005 235100                    LDA     ACCT_LEN,,AUTO
         4 003057   000010 115007                    CMPA    8,DL
         4 003060   003064 602000 4                  TNC     s:20277

  20276  4 003061   000010 236007                    LDQ     8,DL
         4 003062   200005 756100                    STQ     ACCT_LEN,,AUTO
         4 003063   003070 710000 4                  TRA     s:20278

      674    20277    6                  ELSE IF ACCT_LEN = 0 THEN ACCT_LEN = 1;

  20277  4 003064   000000 115003                    CMPA    0,DU
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:112  
         4 003065   003070 601000 4                  TNZ     s:20278

  20277  4 003066   000001 236007                    LDQ     1,DL
         4 003067   200005 756100                    STQ     ACCT_LEN,,AUTO

      675    20278    6                  CALL INDEX (MATCH_LEN,' ',DEV_NAME.TEXT);

  20278  4 003070   000000 124500                    SCM     mask='000'O
         4 003071   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 003072   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 003073   200063 000100                    ARG     MATCH_LEN,,AUTO

      676    20279    6                  IF MATCH_LEN > 7 THEN MATCH_LEN = 8;

  20279  4 003074   200063 235100                    LDA     MATCH_LEN,,AUTO
         4 003075   000010 115007                    CMPA    8,DL
         4 003076   003102 602000 4                  TNC     s:20280

  20279  4 003077   000010 236007                    LDQ     8,DL
         4 003100   200063 756100                    STQ     MATCH_LEN,,AUTO
         4 003101   003106 710000 4                  TRA     s:20281

      677    20280    6                  ELSE IF MATCH_LEN = 0 THEN MATCH_LEN = 1;

  20280  4 003102   000000 115003                    CMPA    0,DU
         4 003103   003106 601000 4                  TNZ     s:20281

  20280  4 003104   000001 236007                    LDQ     1,DL
         4 003105   200063 756100                    STQ     MATCH_LEN,,AUTO

      678    20281    6                  ACCT = SUBSTR (USERS_KEY.TXTC,0,ACCT_LEN);

  20281  4 003106   200005 720100                    LXL0    ACCT_LEN,,AUTO
         4 003107   040100 100440                    MLR     fill='040'O
         4 003110   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         4 003111   200003 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:113  
      679    20282    6                  CALL ASB$WILD_MATCH (ACCT_LEN,ACCT,MATCH_LEN,DEV_NAME.TEXT)

  20282  4 003112   200120 452500                    STP2    TWSN_NUMBER+6,,AUTO
         4 003113   200120 236100                    LDQ     TWSN_NUMBER+6,,AUTO
         4 003114   000016 036000 5                  ADLQ    14
         4 003115   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 003116   200063 630500                    EPPR0   MATCH_LEN,,AUTO
         4 003117   200116 450500                    STP0    TWSN_NUMBER+4,,AUTO
         4 003120   200003 631500                    EPPR1   ACCT,,AUTO
         4 003121   200115 451500                    STP1    TWSN_NUMBER+3,,AUTO
         4 003122   200005 633500                    EPPR3   ACCT_LEN,,AUTO
         4 003123   200114 453500                    STP3    TWSN_NUMBER+2,,AUTO
         4 003124   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003125   000022 631400 xsym               EPPR1   B_VECTNIL+18
         4 003126   000000 701000 xent               TSX1    ASB$WILD_MATCH
         4 003127   003162 702000 4                  TSX2    s:20295

      680    20283    7                  WHENRETURN DO;

      681    20284    8                     IF DISP THEN DO;

  20284  4 003130   200035 234100                    SZN     DISP,,AUTO
         4 003131   003147 605000 4                  TPL     s:20289

      682    20285    8                        CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20285  4 003132   000006 236000 5                  LDQ     6
         4 003133   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 003134   200046 630500                    EPPR0   JCL,,AUTO
         4 003135   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 003136   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003137   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003140   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 003141   000000 011000                    NOP     0

      683    20286    8                        CALL ASB$WRITE_LO (' ',1);

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:114  
  20286  4 003142   000007 630400 5                  EPPR0   7
         4 003143   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003144   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 003145   000000 011000                    NOP     0

      684    20287    8                        END;   /*  Disp  */

  20287  4 003146   003157 710000 4                  TRA     s:20291

      685    20288    8                     ELSE DO;

      686    20289    8                        CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);

  20289  4 003147   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 003150   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 003151   000011 236000 5                  LDQ     9
         4 003152   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003153   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003154   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003155   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 003156   000000 011000                    NOP     0

      687    20290    8                        END; /*  List  */

      688    20291    7                     DISP_DEVICES = DISP_DEVICES + 1;

  20291  4 003157   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 003160   000001 035007                    ADLA    1,DL
         4 003161   200036 755100                    STA     DISP_DEVICES,,AUTO

      689    20292    7                     END; /*  Whenreturn from ASB$WILD_MATCH on acct  */

      690    20293    6                  END; /*  Not check or .SUPER = DEV_TYPE  */

      691    20294    5               END; /*  Whenreturn from ASB$CHECK_TYPE  */

      692    20295    5            IF LAST_KEY ~= USERS_KEY THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:115  

  20295  4 003162   000000 106500                    CMPC    fill='000'O
         4 003163   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42
         4 003164   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 003165   003174 600000 4                  TZE     s:20299

      693    20296    5               USERS_KEY = LAST_KEY;

  20296  4 003166   000000 100500                    MLR     fill='000'O
         4 003167   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42
         4 003170   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      694    20297    5               CALL ASB$PREC_AND_SKIP_HLP;

  20297  4 003171   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 003172   000000 701000 xent               TSX1    ASB$PREC_AND_SKIP_HLP
         4 003173   000000 011000                    NOP     0

      695    20298    5               END;  /*  Last ~= users  */

      696    20299    4            ARS = DSEG3SIZE;

  20299  4 003174   000000 235000 xsym               LDA     DSEG3SIZE
         4 003175   200006 755100                    STA     ARS,,AUTO

      697    20300    4            CALL ASB$READ_HLP_SEQ (DSEG3$, ARS, 3) ALTRET(FINISH_UP);

  20300  4 003176   000004 236000 5                  LDQ     4
         4 003177   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 003200   200006 630500                    EPPR0   ARS,,AUTO
         4 003201   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 003202   000005 236000 5                  LDQ     5
         4 003203   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003204   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003205   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 003206   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         4 003207   003367 702000 4                  TSX2    FINISH_UP
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:116  

      698    20301    4            LAST_KEY = USERS_KEY;

  20301  4 003210   000100 100400                    MLR     fill='000'O
         4 003211   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         4 003212   200050 000052                    ADSC9   LAST_KEY,,AUTO           cn=0,n=42

      699    20302    4            END; /*  Do while USERS_KEY < END_KEY  */

  20302  4 003213   040100 106400                    CMPC    fill='040'O
         4 003214   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41
         4 003215   200037 200024                    ADSC9   END_KEY,,AUTO            cn=1,n=20
         4 003216   003031 602000 4                  TNC     s:20271

      700    20303    3         END; /*  Whenreturn from ASB$READ_HLP_SEQ  */

  20303  4 003217   003323 710000 4                  TRA     s:20325

      701    20304
      702    20305    2      SELECT  (%SINGLE_DEVICE);

      703    20306
      704    20307    2      USERS_KEY.COUNT = 9;

  20307  4 003220   011000 236003                    LDQ     4608,DU
         4 003221   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      705    20308    2      CALL CONCAT( USERS_KEY.TXTC, DEV_NAME.TEXT, '*' );

  20308  4 003222   040000 100500                    MLR     fill='040'O
         4 003223   200021 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         4 003224   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         4 003225   040000 100400                    MLR     fill='040'O
         4 003226   000025 000001 5                  ADSC9   21                       cn=0,n=1
         4 003227   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      706    20309    2      ARS = DSEG3SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:117  

  20309  4 003230   000000 235000 xsym               LDA     DSEG3SIZE
         4 003231   200006 755100                    STA     ARS,,AUTO

      707    20310    2      CALL ASB$READ_HLP( DSEG3$, ARS, 3) ALTRET(RD_ALT2);

  20310  4 003232   000004 236000 5                  LDQ     4
         4 003233   200116 756100                    STQ     TWSN_NUMBER+4,,AUTO
         4 003234   200006 630500                    EPPR0   ARS,,AUTO
         4 003235   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 003236   000005 236000 5                  LDQ     5
         4 003237   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003240   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003241   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 003242   000000 701000 xent               TSX1    ASB$READ_HLP
         4 003243   003324 702000 4                  TSX2    RD_ALT2

      708    20311    2      CALL ASB$CHECK_TYPE( DSEG3$, ARS, DEV_TYPE, %NO#, DEV_NAME ) ALTRET(FINISH_UP);

  20311  4 003244   200021 630500                    EPPR0   DEV_NAME,,AUTO
         4 003245   200120 450500                    STP0    TWSN_NUMBER+6,,AUTO
         4 003246   000006 236000 5                  LDQ     6
         4 003247   200117 756100                    STQ     TWSN_NUMBER+5,,AUTO
         4 003250   200034 631500                    EPPR1   DEV_TYPE,,AUTO
         4 003251   200116 451500                    STP1    TWSN_NUMBER+4,,AUTO
         4 003252   200006 633500                    EPPR3   ARS,,AUTO
         4 003253   200115 453500                    STP3    TWSN_NUMBER+3,,AUTO
         4 003254   000005 236000 5                  LDQ     5
         4 003255   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003256   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003257   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 003260   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 003261   003367 702000 4                  TSX2    FINISH_UP

      709    20312    3      IF NOT CHECK OR KL$TREC.SUPER = DEV_TYPE THEN DO;

  20312  4 003262   200016 234100                    SZN     CHECK,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:118  
         4 003263   003271 605000 4                  TPL     s:20313
         4 003264   000000 470400 xsym               LDP0    DSEG3$
         4 003265   000000 236100                    LDQ     0,,PR0
         4 003266   000777 376007                    ANQ     511,DL
         4 003267   200034 116100                    CMPQ    DEV_TYPE,,AUTO
         4 003270   003323 601000 4                  TNZ     s:20325

      710    20313    4         IF DISP THEN DO;

  20313  4 003271   200035 234100                    SZN     DISP,,AUTO
         4 003272   003310 605000 4                  TPL     s:20318

      711    20314    4            CALL ASL$DISP_ONE_DEVICE (JCL, %NO# );

  20314  4 003273   000006 236000 5                  LDQ     6
         4 003274   200115 756100                    STQ     TWSN_NUMBER+3,,AUTO
         4 003275   200046 630500                    EPPR0   JCL,,AUTO
         4 003276   200114 450500                    STP0    TWSN_NUMBER+2,,AUTO
         4 003277   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003300   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003301   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         4 003302   000000 011000                    NOP     0

      712    20315    4            CALL ASB$WRITE_LO (' ',1);

  20315  4 003303   000007 630400 5                  EPPR0   7
         4 003304   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003305   000000 701000 xent               TSX1    ASB$WRITE_LO
         4 003306   000000 011000                    NOP     0

      713    20316    4            END;   /*  Disp  */

  20316  4 003307   003320 710000 4                  TRA     s:20320

      714    20317    4         ELSE DO;

      715    20318    4            CALL ASL$FORMAT_DEVNAME (USERS_KEY, DISP_DEVICES);
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:119  

  20318  4 003310   200036 630500                    EPPR0   DISP_DEVICES,,AUTO
         4 003311   200115 450500                    STP0    TWSN_NUMBER+3,,AUTO
         4 003312   000011 236000 5                  LDQ     9
         4 003313   200114 756100                    STQ     TWSN_NUMBER+2,,AUTO
         4 003314   200114 630500                    EPPR0   TWSN_NUMBER+2,,AUTO
         4 003315   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003316   000000 701000 xent               TSX1    ASL$FORMAT_DEVNAME
         4 003317   000000 011000                    NOP     0

      716    20319    4            END; /*  List  */

      717    20320    3         DISP_DEVICES = DISP_DEVICES + 1;

  20320  4 003320   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 003321   000001 035007                    ADLA    1,DL
         4 003322   200036 755100                    STA     DISP_DEVICES,,AUTO

      718    20321    3         END;  /*  Not check or KL$TREC.SUPER = DEV_TYPE  */

      719    20322
      720    20323    2      END; /*  Do case (OPTION_CODE)  */

      721    20324
      722    20325    2   DO NEVER;

  20325  4 003323   003367 710000 4                  TRA     FINISH_UP

      723    20326    2   RD_ALT2:
      724    20327    3      IF MERR_CODE.CODE = %E$NOKEY THEN DO;

  20327  4 003324   000000 236000 xsym  RD_ALT2      LDQ     ERR_CODE
         4 003325   377770 376007                    ANQ     131064,DL
         4 003326   001020 116007                    CMPQ    528,DL
         4 003327   003340 601000 4                  TNZ     s:20349

      725    20328        /*E*  ERROR:  ASL-E$DEV_NO_EXIST2-C
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:120  
      726    20329              MESSAGE: %U1 does not exist.
      727    20330              MESSAGE1: The specified DEVICE does not exist.
      728    20331        */
      729    20332    3         AS_FIELD1 = DEV_NAME;

  20332  4 003330   000000 100500                    MLR     fill='000'O
         4 003331   200021 000051                    ADSC9   DEV_NAME,,AUTO           cn=0,n=41
         4 003332   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      730    20333              %SCREAM( ERR#=E$DEV_NO_EXIST2, LEVEL=ERROR, MID='L' );

  20345  4 003333   000034 630400 5                  EPPR0   28
         4 003334   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003335   000000 701000 xent               TSX1    ASH$ERROR
         4 003336   000000 011000                    NOP     0

      731    20348    3         END; /*  Error  */

  20348  4 003337   003344 710000 4                  TRA     s:20350

      732    20349    2      ELSE CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  20349  4 003340   000013 630400 5                  EPPR0   11
         4 003341   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003342   000000 701000 xent               TSX1    ASA$ERROR
         4 003343   000000 011000                    NOP     0

      733    20350    2      GOTO FINISH_UP;

  20350  4 003344   003367 710000 4                  TRA     FINISH_UP

      734    20351
      735    20352    3   READ_ALT3: IF MERR_CODE.CODE = %E$NOKEY THEN DO;

  20352  4 003345   000000 236000 xsym  READ_ALT3    LDQ     ERR_CODE
         4 003346   377770 376007                    ANQ     131064,DL
         4 003347   001020 116007                    CMPQ    528,DL
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:121  
         4 003350   003363 601000 4                  TNZ     READ_ERR

      736    20353    3         AS_FIELD1.COUNT = STATION_NAME.COUNT;

  20353  4 003351   200071 236100                    LDQ     STATION_NAME,,AUTO
         4 003352   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      737    20354    3         AS_FIELD1.TEXT  = STATION_NAME.TEXT;

  20354  4 003353   040000 100500                    MLR     fill='040'O
         4 003354   200071 200010                    ADSC9   STATION_NAME,,AUTO       cn=1,n=8
         4 003355   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      738    20355              %SCREAM( ERR#=E$TERMINAL_NOEXIST, LEVEL=ERROR, MID='L' );

  20367  4 003356   000035 630400 5                  EPPR0   29
         4 003357   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003360   000000 701000 xent               TSX1    ASH$ERROR
         4 003361   000000 011000                    NOP     0

      739    20370    3         END;  /*  No such key error  */

  20370  4 003362   003367 710000 4                  TRA     FINISH_UP

      740    20371    2      ELSE
      741    20372    2   READ_ERR: CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  20372  4 003363   000013 630400 5     READ_ERR     EPPR0   11
         4 003364   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 003365   000000 701000 xent               TSX1    ASA$ERROR
         4 003366   000000 011000                    NOP     0

      742    20373    2      END;  /*  Do never  */

      743    20374    1   FINISH_UP:
      744    20375    2   IF NOT DISP THEN DO;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:122  
  20375  4 003367   200035 234100       FINISH_UP    SZN     DISP,,AUTO
         4 003370   003405 604000 4                  TMI     s:20381

      745    20376    2      FMT_BUF = '%\%/';

  20376  4 003371   040000 100400                    MLR     fill='040'O
         4 003372   000023 000004 3                  ADSC9   LIST_STR+12              cn=0,n=4
         4 003373   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      746    20377    2      FDS.FMT_.BOUND = 3;

  20377  4 003374   000000 236000 xsym               LDQ     FDS
         4 003375   177777 376007                    ANQ     65535,DL
         4 003376   600000 276007                    ORQ     -65536,DL
         4 003377   000000 756000 xsym               STQ     FDS

      747    20378    2      FDS.NVECS# = 0;

  20378  4 003400   000011 450000 xsym               STZ     FDS+9

      748    20379    2      CALL X$FORMAT (FDS);

  20379  4 003401   000003 630400 5                  EPPR0   3
         4 003402   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003403   000000 701000 xent               TSX1    X$FORMAT
         4 003404   000000 011000                    NOP     0

      749    20380    2      END; /*  If not disp  */

      750    20381    2   IF NOT JCL THEN DO;

  20381  4 003405   200046 234100                    SZN     JCL,,AUTO
         4 003406   003455 604000 4                  TMI     s:20402

      751    20382    2      FMT_VEC(0) = VECTOR (DISP_DEVICES);

  20382  4 003407   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:123  
         4 003410   200114 452500                    STP2    TWSN_NUMBER+2,,AUTO
         4 003411   200114 236100                    LDQ     TWSN_NUMBER+2,,AUTO
         4 003412   000036 036003                    ADLQ    30,DU
         4 003413   000000 755000 xsym               STA     FMT_VEC
         4 003414   000001 756000 xsym               STQ     FMT_VEC+1

      752    20383    2      IF DISP_DEVICES = 1 THEN

  20383  4 003415   200036 235100                    LDA     DISP_DEVICES,,AUTO
         4 003416   000001 115007                    CMPA    1,DL
         4 003417   003424 601000 4                  TNZ     s:20388

      753    20384    3      DO;

      754    20385    3         FMT_VEC(1) = VECTOR (DEVICE_STR);

  20385  4 003420   000036 237000 5                  LDAQ    30
         4 003421   000002 755000 xsym               STA     FMT_VEC+2
         4 003422   000003 756000 xsym               STQ     FMT_VEC+3

      755    20386    3         END; /*  DISP_DEVICES = 1  */

  20386  4 003423   003427 710000 4                  TRA     s:20390

      756    20387    3      ELSE DO;

      757    20388    3         FMT_VEC(1) = VECTOR (DEVICES_STR);

  20388  4 003424   000040 237000 5                  LDAQ    32
         4 003425   000002 755000 xsym               STA     FMT_VEC+2
         4 003426   000003 756000 xsym               STQ     FMT_VEC+3

      758    20389    3         END; /*  DISP_DEVICES ~= 1  */

      759    20390    2      IF DISP THEN

  20390  4 003427   200035 234100                    SZN     DISP,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:124  
         4 003430   003435 605000 4                  TPL     s:20395

      760    20391    3      DO;

      761    20392    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  20392  4 003431   000042 237000 5                  LDAQ    34
         4 003432   000004 755000 xsym               STA     FMT_VEC+4
         4 003433   000005 756000 xsym               STQ     FMT_VEC+5

      762    20393    3         END; /*  If disp  */

  20393  4 003434   003440 710000 4                  TRA     s:20397

      763    20394    3      ELSE DO;

      764    20395    3         FMT_VEC(2) = VECTOR (LIST_STR);

  20395  4 003435   000044 237000 5                  LDAQ    36
         4 003436   000004 755000 xsym               STA     FMT_VEC+4
         4 003437   000005 756000 xsym               STQ     FMT_VEC+5

      765    20396    3         END; /*  If ~ disp  */

      766    20397    2      FDS.NVECS# = 3;

  20397  4 003440   000003 235007                    LDA     3,DL
         4 003441   000011 755000 xsym               STA     FDS+9

      767    20398    2      FMT_BUF = '   %5D %A %A.';

  20398  4 003442   040000 100400                    MLR     fill='040'O
         4 003443   000024 000015 3                  ADSC9   LIST_STR+13              cn=0,n=13
         4 003444   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      768    20399    2      FDS.FMT_.BOUND = 12;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:125  
  20399  4 003445   000000 236000 xsym               LDQ     FDS
         4 003446   177777 376007                    ANQ     65535,DL
         4 003447   000003 276003                    ORQ     3,DU
         4 003450   000000 756000 xsym               STQ     FDS

      769    20400    2      CALL X$FORMAT(FDS);

  20400  4 003451   000003 630400 5                  EPPR0   3
         4 003452   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 003453   000000 701000 xent               TSX1    X$FORMAT
         4 003454   000000 011000                    NOP     0

      770    20401    2      END; /* Not jcl */

      771    20402    1   RETURN;

  20402  4 003455   000000 702200 xent               TSX2  ! X66_ARET
      772    20403    1   END ASL$LIST_ALL_DEVICES;
      773    20404        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:126  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_DEVICES.
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:127  

 **** Variables and constants ****

  ****  Section 002  Data  ASL$LIST_ALL_DEVICES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    67-0-0/w PTR         r     1 LINCNFG$
     5-0-0/w UBIN        r     1 LINCNFG_BUF(0:49)

  ****  Section 003 RoData ASL$LIST_ALL_DEVICES

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/c CHAR(7)     r     1 DEVICES_STR                0-0-0/c CHAR(6)     r     1 DEVICE_STR
     4-0-0/c CHAR(9)     r     1 DISPLAY_STR                7-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/c CHAR(8)     r     1 ACCT                       5-0-0/w UBIN        r     1 ACCT_LEN
     6-0-0/w SBIN        r     1 ARS                        7-0-0/c STRC(189)   r     1 BEGIN_KEY
    15-0-0/w PTR         r     1 BLK$                      16-0-0/b BIT         r     1 CHECK
    17-0-0/w UBIN        r     1 COUNT                     20-0-0/b BIT         r     1 DEVICE_NAME_WILD
    21-0-0/c STRC(378)   r     1 DEV_NAME                  34-0-0/w UBIN        r     1 DEV_TYPE
    35-0-0/b BIT         r     1 DISP                      36-0-0/w UBIN        r     1 DISP_DEVICES
    37-0-0/c STRC(189)   r     1 END_KEY                   45-0-0/w SBIN        r     1 I
    46-0-0/b BIT         r     1 JCL                       47-0-0/w SBIN        r     1 K
    50-0-0/c STRC(378)   r     1 LAST_KEY                  63-0-0/w UBIN        r     1 MATCH_LEN
    64-0-0/c CHAR(12)    r     1 NAME                      67-0-0/w UBIN        r     1 NAME_LEN
    70-0-0/w UBIN        r     1 OPTION_CODE               71-0-0/c STRC(81)    r     1 STATION_NAME
    74-0-0/c STRC(81)    r     1 TERMINAL_NAME             77-0-0/c STRC(189)   r     1 TPDEV
   105-0-0/b BIT         r     1 TPDEV_ACCT_WILD          106-0-0/b BIT         r     1 TPDEV_NAME_SPECIFIED
   107-0-0/b BIT         r     1 TPDEV_NAME_WILD          110-0-0/b BIT         r     1 TPDEV_SPECIFIED
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:128  
   111-0-0/c CHAR(4)     r     1 TWSN_CHAR                112-0-0/w UBIN        r     1 TWSN_NUMBER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/w UBIN        r     1 CODE                       0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w UBIN        r     1 DSEG1SIZE                  0-0-0/w PTR         r     1 DSEG2$
     0-0-0/w UBIN        r     1 DSEG2SIZE                  0-0-0/w PTR         r     1 DSEG3$
     0-0-0/w UBIN        r     1 DSEG3SIZE                  0-0-0/b STRC        r     1 ERR_CODE
     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)              0-0-0/b STRC        r     1 MERR_CODE
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$DREC                    0-0-0/w STRC(2412)  r     1 KL$TREC
     0-0-0/w STRC(576)   r     1 KL$TWSNREC                 0-0-0/w STRC(144)   r     1 KL$WSNCVT
     0-0-0/w ASTR(387)   r     1 LINCNFG                    0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$B


   Procedure ASL$LIST_ALL_DEVICES requires 1838 words for executable code.
   Procedure ASL$LIST_ALL_DEVICES requires 82 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:129  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:130  
          MINI XREF LISTING

ACCT
     19694**DCL     20183<<ASSIGN  20184<>CALL    20281<<ASSIGN  20282<>CALL
ACCT_LEN
     19695**DCL     20177<<CALLBLT 20178>>IF      20178<<ASSIGN  20179>>IF      20179<<ASSIGN  20183>>ASSIGN
     20184<>CALL    20275<<CALLBLT 20276>>IF      20276<<ASSIGN  20277>>IF      20277<<ASSIGN  20281>>ASSIGN
     20282<>CALL
ARS
     19696**DCL     19918<<ASSIGN  19919<>CALL    19921<>CALL    19968<<ASSIGN  19969<>CALL    19970<>CALL
     19992<<ASSIGN  19993<>CALL    19996<<ASSIGN  19997<>CALL    20012<<ASSIGN  20013<>CALL    20014<>CALL
     20035<<ASSIGN  20036<>CALL    20042<<ASSIGN  20043<>CALL    20055<<ASSIGN  20056<>CALL    20058<>CALL
     20102<<ASSIGN  20103<>CALL    20111<<ASSIGN  20113<>CALL    20114<>CALL    20121<<ASSIGN  20122<>CALL
     20134<<ASSIGN  20135<>CALL    20136<>CALL    20169<<ASSIGN  20170<>CALL    20173<>CALL    20213<<ASSIGN
     20214<>CALL    20221<<ASSIGN  20227<>CALL    20267<<ASSIGN  20268<>CALL    20271<>CALL    20299<<ASSIGN
     20300<>CALL    20309<<ASSIGN  20310<>CALL    20311<>CALL
ASA$ERROR
     19130**DCL-ENT 19940--CALL    20349--CALL    20372--CALL
ASA_BRKS_LOC
     16017**DCL     16017--REDEF
ASB$BOF_HLP
     19133**DCL-ENT 19916--CALL
ASB$CHECK_TYPE
     19136**DCL-ENT 19921--CALL    19970--CALL    20014--CALL    20058--CALL    20114--CALL    20136--CALL
     20173--CALL    20271--CALL    20311--CALL
ASB$GET_NEXT_STATION
     19139**DCL-ENT 19953--CALL
ASB$INIT_GET_STATION
     19142**DCL-ENT 19947--CALL
ASB$PREC_AND_SKIP_HLP
     19145**DCL-ENT 19935--CALL    20211--CALL    20297--CALL
ASB$PREC_HLP
     19148**DCL-ENT 20168--CALL    20266--CALL
ASB$READ_HLP
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:131  
     19151**DCL-ENT 19969--CALL    19993--CALL    19997--CALL    20013--CALL    20036--CALL    20043--CALL
     20056--CALL    20103--CALL    20113--CALL    20122--CALL    20135--CALL    20227--CALL    20310--CALL
ASB$READ_HLP_SEQ
     19154**DCL-ENT 19919--CALL    20170--CALL    20214--CALL    20268--CALL    20300--CALL
ASB$WILD_MATCH
     19157**DCL-ENT 19952--CALL    19965--CALL    20009--CALL    20047--CALL    20051--CALL    20127--CALL
     20131--CALL    20184--CALL    20195--CALL    20282--CALL
ASB$WRITE_LO
     19160**DCL-ENT 19926--CALL    19976--CALL    20021--CALL    20065--CALL    20143--CALL    20199--CALL
     20248--CALL    20286--CALL    20315--CALL
ASH$ERROR
     19163**DCL-ENT 20091--CALL    20240--CALL    20345--CALL    20367--CALL
ASL$DISP_ONE_DEVICE
     19166**DCL-ENT 19925--CALL    19975--CALL    20020--CALL    20064--CALL    20142--CALL    20198--CALL
     20247--CALL    20285--CALL    20314--CALL
ASL$FORMAT_DEVNAME
     19169**DCL-ENT 19929--CALL    19973--CALL    20017--CALL    20061--CALL    20139--CALL    20202--CALL
     20251--CALL    20289--CALL    20318--CALL
AS_DEFAULT.BANNER_PERM
     16710**DCL     16711--REDEF
AS_DEFAULT.BUDGET.MACCT
     16615**DCL     16619--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     16628**DCL     16631--REDEF
AS_DEFAULT.BUDGET.PACCUM
     16611**DCL     16613--REDEF
AS_DEFAULT.BUDGET.PMAXC
     16606**DCL     16608--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     16726**DCL     16727--REDEF   16728--REDEF
AS_DEFAULT_DREC.PASSWORD
     17980**DCL     17984--REDEF
AS_DEFAULT_DREC.RENAME
     18003**DCL     18004--REDEF
AS_DFLT.BANNER_PERM
     16532**DCL     16533--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:132  
AS_DFLT.BUDGET.MACCT
     16437**DCL     16441--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     16450**DCL     16453--REDEF
AS_DFLT.BUDGET.PACCUM
     16433**DCL     16435--REDEF
AS_DFLT.BUDGET.PMAXC
     16428**DCL     16430--REDEF
AS_DFLT.SETUP_CHRA.TXT
     16548**DCL     16549--REDEF   16550--REDEF
AS_FE_MODE
     15883**DCL     15884--REDEF
AS_FIELD1
     16013**DCL     20332<<ASSIGN
AS_FIELD1.COUNT
     16014**DCL     20076<<ASSIGN  20115<<ASSIGN  20226<<ASSIGN  20353<<ASSIGN
AS_FIELD1.TEXT
     16014**DCL     20075<<ASSIGN  20116<<ASSIGN  20225<<CALLBLT 20354<<ASSIGN
AS_FIELD2.COUNT
     16014**DCL     20078<<ASSIGN  20117<<ASSIGN
AS_FIELD2.TEXT
     16014**DCL     20077<<ASSIGN  20118<<ASSIGN
AS_MODE
     15880**DCL     15882--REDEF
AS_MOD_USER.ACCESS
     18745**DCL     18746--REDEF
AS_MOD_USER.BANNER
     18732**DCL     18733--REDEF
AS_MOD_USER.BANNER_PERM
     18734**DCL     18735--REDEF
AS_MOD_USER.BILL
     18740**DCL     18741--REDEF
AS_MOD_USER.CPROC
     18736**DCL     18737--REDEF
AS_MOD_USER.FEBILL
     18816**DCL     18817--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:133  
AS_MOD_USER.FECXTMEM
     18833**DCL     18834--REDEF
AS_MOD_USER.FEMINTS
     18818**DCL     18819--REDEF
AS_MOD_USER.FEMMEM
     18829**DCL     18830--REDEF
AS_MOD_USER.FEMTIME
     18827**DCL     18828--REDEF
AS_MOD_USER.FEPPRIV
     18824**DCL     18826--REDEF
AS_MOD_USER.FEPRIV
     18821**DCL     18823--REDEF
AS_MOD_USER.FORCE_BIT
     18730**DCL     18731--REDEF
AS_MOD_USER.KEY
     18812**DCL     18814--REDEF
AS_MOD_USER.LASTCPROC
     18738**DCL     18739--REDEF
AS_MOD_USER.LIMITS.DO_
     18786**DCL     18787--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     18802**DCL     18803--REDEF
AS_MOD_USER.LIMITS.LO
     18782**DCL     18783--REDEF
AS_MOD_USER.LIMITS.MEM
     18778**DCL     18779--REDEF
AS_MOD_USER.LIMITS.MPRIO
     18806**DCL     18807--REDEF
AS_MOD_USER.LIMITS.PDIS
     18794**DCL     18795--REDEF
AS_MOD_USER.LIMITS.PO
     18790**DCL     18791--REDEF
AS_MOD_USER.LIMITS.TDIS
     18798**DCL     18799--REDEF
AS_MOD_USER.LIMITS.TIME
     18774**DCL     18775--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:134  
AS_MOD_USER.MAXENQ
     18755**DCL     18756--REDEF
AS_MOD_USER.PERM_BIT
     18728**DCL     18729--REDEF
AS_MOD_USER.PPRIV
     18750**DCL     18752--REDEF
AS_MOD_USER.PRIOB
     18757**DCL     18758--REDEF
AS_MOD_USER.PRIV
     18747**DCL     18749--REDEF
AS_MOD_USER.QUAN
     18753**DCL     18754--REDEF
AS_MOD_USER.SETUP
     18726**DCL     18727--REDEF
AS_PROJECT.BANNER_PERM
     17066**DCL     17067--REDEF
AS_PROJECT.BUDGET.MACCT
     16971**DCL     16975--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     16984**DCL     16987--REDEF
AS_PROJECT.BUDGET.PACCUM
     16967**DCL     16969--REDEF
AS_PROJECT.BUDGET.PMAXC
     16962**DCL     16964--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     17082**DCL     17083--REDEF   17084--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     17244**DCL     17245--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     17149**DCL     17153--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     17162**DCL     17165--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     17145**DCL     17147--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     17140**DCL     17142--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:135  
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     17260**DCL     17261--REDEF   17262--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     18466**DCL     18470--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     18489**DCL     18490--REDEF
AS_PROJECT_DREC.PASSWORD
     18304**DCL     18308--REDEF
AS_PROJECT_DREC.RENAME
     18327**DCL     18328--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     16888**DCL     16889--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     16793**DCL     16797--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     16806**DCL     16809--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     16789**DCL     16791--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     16784**DCL     16786--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     16904**DCL     16905--REDEF   16906--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     18142**DCL     18146--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     18165**DCL     18166--REDEF
AS_USERS.BANNER_PERM
     16354**DCL     16355--REDEF
AS_USERS.BUDGET.MACCT
     16259**DCL     16263--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     16272**DCL     16275--REDEF
AS_USERS.BUDGET.PACCUM
     16255**DCL     16257--REDEF
AS_USERS.BUDGET.PMAXC
     16250**DCL     16252--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:136  
AS_USERS.SETUP_CHRA.TXT
     16370**DCL     16371--REDEF   16372--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     17422**DCL     17423--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     17327**DCL     17331--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     17340**DCL     17343--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     17323**DCL     17325--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     17318**DCL     17320--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     17438**DCL     17439--REDEF   17440--REDEF
BEGIN_KEY
     19697**DCL     20167>>ASSIGN  20265>>ASSIGN
BEGIN_KEY.COUNT
     19698**DCL     20162<<ASSIGN  20263<<ASSIGN
BEGIN_KEY.TEXT
     19699**DCL     20158<<ASSIGN  20161<<ASSIGN  20261<<ASSIGN
BLK$
     19700**DCL     19660--IMP-PTR 19802<<ASSIGN  19803>>ASSIGN  19804>>ASSIGN  19804>>ASSIGN  19808<<ASSIGN
     19809>>ASSIGN  19810>>ASSIGN  19810>>ASSIGN  19826<<ASSIGN  19827>>ASSIGN  19828>>ASSIGN  19828>>ASSIGN
     19832<<ASSIGN  19833>>ASSIGN  19834>>ASSIGN  19834>>ASSIGN  19843<<ASSIGN  19844>>ASSIGN  19845>>ASSIGN
     19845>>ASSIGN
CHECK
     19701**DCL     19778<<ASSIGN  19785<<ASSIGN  19797<<ASSIGN  19817<<ASSIGN  19821<<ASSIGN  19923>>IF
     19971>>IF      20015>>IF      20059>>IF      20137>>IF      20175>>IF      20273>>IF      20312>>IF
CODE
     16010**DCL     19770<<ASSIGN  19772>>DOSELCT 19795>>ASSIGN  19815>>ASSIGN
CONFIG_KEY.TERMID.TERM
     18919**DCL     18928--REDEF
COUNT
     19702**DCL     20224<<CALLBLT 20225>>CALLBLT 20226>>ASSIGN
DEVICES_STR
     19745**DCL     19862>>CALLBLT 19863--ASSIGN  19866>>CALLBLT 19867--ASSIGN  20388--ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:137  
DEVICE_NAME_WILD
     19703**DCL     19896<<ASSIGN  19899<<ASSIGN
DEVICE_STR
     19744**DCL     20385--ASSIGN
DEV_NAME
     19704**DCL     19922<<ASSIGN  19933>>IF      19934>>ASSIGN  20311<>CALL    20332>>ASSIGN
DEV_NAME.COUNT
     19705**DCL     19760<<ASSIGN  19827<<ASSIGN  19964>>ASSIGN  20008>>ASSIGN  20046>>ASSIGN  20126>>ASSIGN
DEV_NAME.TEXT
     19706**DCL     19761<<ASSIGN  19828<<ASSIGN  19897>>CALLBLT 19905>>IF      19965<>CALL    20009<>CALL
     20047<>CALL    20127<>CALL    20260>>CALLBLT 20261>>ASSIGN  20262>>CALLBLT 20278>>CALLBLT 20282<>CALL
     20308>>CALLBLT
DEV_TYPE
     19708**DCL     19779<<ASSIGN  19786<<ASSIGN  19796<<ASSIGN  19816<<ASSIGN  19820<<ASSIGN  19921<>CALL
     19923>>IF      19970<>CALL    19971>>IF      20014<>CALL    20015>>IF      20058<>CALL    20059>>IF
     20136<>CALL    20137>>IF      20173<>CALL    20175>>IF      20245>>IF      20271<>CALL    20273>>IF
     20311<>CALL    20312>>IF
DISP
     19709**DCL     19776<<ASSIGN  19783<<ASSIGN  19795<<ASSIGN  19815<<ASSIGN  19924>>IF      19972>>IF
     20016>>IF      20060>>IF      20138>>IF      20197>>IF      20246>>IF      20284>>IF      20313>>IF
     20375>>IF      20390>>IF
DISPLAY_STR
     19746**DCL     20392--ASSIGN
DISP_DEVICES
     19710**DCL     19766<<ASSIGN  19929<>CALL    19931<<ASSIGN  19931>>ASSIGN  19973<>CALL    19978<<ASSIGN
     19978>>ASSIGN  20017<>CALL    20023<<ASSIGN  20023>>ASSIGN  20061<>CALL    20067<<ASSIGN  20067>>ASSIGN
     20139<>CALL    20145<<ASSIGN  20145>>ASSIGN  20202<>CALL    20204<<ASSIGN  20204>>ASSIGN  20251<>CALL
     20253<<ASSIGN  20253>>ASSIGN  20289<>CALL    20291<<ASSIGN  20291>>ASSIGN  20318<>CALL    20320<<ASSIGN
     20320>>ASSIGN  20382--ASSIGN  20383>>IF
DSEG1$
     16018**DCL     19601--IMP-PTR 19948>>DOINDEX 19949>>CALLBLT 19952>>CALL    19993<>CALL    19995>>CALLBLT
     20036<>CALL    20037>>DOINDEX 20038>>IF      20103<>CALL    20113<>CALL    20114<>CALL    20120>>CALLBLT
DSEG1SIZE
     16019**DCL     19992>>ASSIGN  20035>>ASSIGN  20102>>ASSIGN  20111>>ASSIGN
DSEG2$
     16019**DCL     19463--IMP-PTR 19954>>DOINDEX 19955>>IF      19956>>IF      19961>>CALLBLT 19965>>CALL
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:138  
     19967>>CALLBLT 19997<>CALL    19998>>DOINDEX 19999>>IF      20000>>IF      20005>>CALLBLT 20009>>CALL
     20011>>CALLBLT 20043<>CALL    20044>>DOINDEX 20045>>IF      20047>>CALL    20049>>CALLBLT 20051>>CALL
     20054>>CALLBLT 20075>>ASSIGN  20122<>CALL    20123>>DOINDEX 20125>>IF      20127>>CALL    20129>>CALLBLT
     20131>>CALL    20133>>CALLBLT
DSEG2SIZE
     16019**DCL     19996>>ASSIGN  20042>>ASSIGN  20121>>ASSIGN
DSEG3$
     16019**DCL     19188--IMP-PTR 19919<>CALL    19921<>CALL    19923>>IF      19969<>CALL    19970<>CALL
     19971>>IF      20013<>CALL    20014<>CALL    20015>>IF      20056<>CALL    20058<>CALL    20059>>IF
     20135<>CALL    20136<>CALL    20137>>IF      20170<>CALL    20173<>CALL    20175>>IF      20214<>CALL
     20227<>CALL    20245>>IF      20268<>CALL    20271<>CALL    20273>>IF      20300<>CALL    20310<>CALL
     20311<>CALL    20312>>IF
DSEG3SIZE
     16019**DCL     19918>>ASSIGN  19968>>ASSIGN  20012>>ASSIGN  20055>>ASSIGN  20134>>ASSIGN  20169>>ASSIGN
     20213>>ASSIGN  20221>>ASSIGN  20267>>ASSIGN  20299>>ASSIGN  20309>>ASSIGN
END_KEY.COUNT
     19712**DCL     20163<<ASSIGN  20165>>IF      20264<<ASSIGN
END_KEY.TEXT
     19713**DCL     20159<<CALLBLT 20164<<ASSIGN  20166<<ASSIGN  20172>>DOWHILE 20262<<CALLBLT 20270>>DOWHILE
ERR_CODE
     16012**DCL     16013--REDEF
FDS
     15909**DCL     19870<>CALL    20379<>CALL    20400<>CALL
FDS.FMT_.BOUND
     15914**DCL     19863<<ASSIGN  19867<<ASSIGN  20377<<ASSIGN  20399<<ASSIGN
FDS.NVECS#
     15937**DCL     19860<<ASSIGN  20378<<ASSIGN  20397<<ASSIGN
FDS.TABDFLT#
     15975**DCL     19869<<ASSIGN
FINISH_UP
     20375**LABEL   19941--GOTO    19953--CALLALT 19986--GOTO    20029--GOTO    20114--CALLALT 20214--CALLALT
     20300--CALLALT 20311--CALLALT 20350--GOTO
FMT_BUF
     16008**DCL     19862<<CALLBLT 19866<<CALLBLT 20376<<ASSIGN  20398<<ASSIGN
FMT_VEC
     16008**DCL     20382<<ASSIGN  20385<<ASSIGN  20388<<ASSIGN  20392<<ASSIGN  20395<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:139  
I
     19714**DCL     19768<<DOINDEX 19770>>ASSIGN  19787>>IF      19788>>DOINDEX 19789>>IF      19802>>ASSIGN
     19808>>ASSIGN  19819>>IF      19820>>ASSIGN  19826>>ASSIGN  19832>>ASSIGN  19843>>ASSIGN  19877<<CALLBLT
     19883<<CALLBLT 19897<<CALLBLT 19954<<DOINDEX 19955>>IF      19956>>IF      19961>>CALLBLT 19965>>CALL
     19967>>CALLBLT 19998<<DOINDEX 19999>>IF      20000>>IF      20005>>CALLBLT 20009>>CALL    20011>>CALLBLT
     20044<<DOINDEX 20045>>IF      20047>>CALL    20049>>CALLBLT 20051>>CALL    20054>>CALLBLT 20075>>ASSIGN
     20123<<DOINDEX 20125>>IF      20127>>CALL    20129>>CALLBLT 20131>>CALL    20133>>CALLBLT 20157<<CALLBLT
     20158>>ASSIGN  20159>>CALLBLT 20160<<CALLBLT 20161>>ASSIGN  20161>>ASSIGN  20162>>ASSIGN  20163>>ASSIGN
     20164>>ASSIGN  20164>>ASSIGN  20166>>ASSIGN  20223<<CALLBLT 20225>>CALLBLT 20226>>ASSIGN  20260<<CALLBLT
     20261>>ASSIGN  20262>>CALLBLT
JCL
     19715**DCL     19752<<ASSIGN  19790<<ASSIGN  19854<<ASSIGN  19861>>IF      19925<>CALL    19975<>CALL
     20020<>CALL    20064<>CALL    20142<>CALL    20198<>CALL    20247<>CALL    20285<>CALL    20314<>CALL
     20381>>IF
K
     19716**DCL     19788<<DOINDEX 19789>>IF      19836<<CALLBLT 19847<<CALLBLT
KL$DREC.PASSWORD
     19558**DCL     19562--REDEF
KL$DREC.RENAME
     19581**DCL     19582--REDEF
KL$DREC.SUPER
     19552**DCL     19923>>IF      19971>>IF      20015>>IF      20059>>IF      20137>>IF      20175>>IF
KL$DREC.TWSN#
     19555**DCL     19995>>CALLBLT 20120>>CALLBLT
KL$TREC.PASSWORD
     19246**DCL     19250--REDEF
KL$TREC.RENAME
     19269**DCL     19270--REDEF
KL$TREC.SUPER
     19240**DCL     20245>>IF      20273>>IF      20312>>IF
KL$TWSNREC.DEVS.ACCT
     19481**DCL     19961>>CALLBLT 19965<>CALL    19967>>CALLBLT 20005>>CALLBLT 20009<>CALL    20011>>CALLBLT
     20047<>CALL    20054>>CALLBLT 20075>>ASSIGN  20127<>CALL    20133>>CALLBLT
KL$TWSNREC.DEVS.IOM_CONNECTED
     19476**DCL     19955>>IF      19999>>IF
KL$TWSNREC.DEVS.TDEV
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:140  
     19475**DCL     19956>>IF      20000>>IF      20045>>IF      20125>>IF
KL$TWSNREC.DEVS.TERM
     19482**DCL     20049>>CALLBLT 20051<>CALL    20129>>CALLBLT 20131<>CALL
KL$TWSNREC.NDEV
     19466**DCL     19954>>DOINDEX 19998>>DOINDEX 20044>>DOINDEX 20123>>DOINDEX
KL$WSNCVT.LTWSN
     19604**DCL     19948>>DOINDEX 20037>>DOINDEX
KL$WSNCVT.WSN
     19605**DCL     19949>>CALLBLT 19952<>CALL    20038>>IF
KL_DEFAULT.PASSWORD
     18628**DCL     18632--REDEF
KL_DEFAULT.RENAME
     18651**DCL     18652--REDEF
KL_DFLT.PASSWORD
     17818**DCL     17822--REDEF
KL_DFLT.RENAME
     17841**DCL     17842--REDEF
KL_DREC.PASSWORD
     17656**DCL     17660--REDEF
KL_DREC.RENAME
     17679**DCL     17680--REDEF
KL_DREC_CNT.PASSWORD
     17543**DCL     17547--REDEF
KL_DREC_CNT.RENAME
     17566**DCL     17567--REDEF
KL_SS.SGN
     19115**DCL     19124--REDEF
LAST_KEY
     19717**DCL     20171<<ASSIGN  20209>>IF      20210>>ASSIGN  20215<<ASSIGN  20269<<ASSIGN  20295>>IF
     20296>>ASSIGN  20301<<ASSIGN
LINCNFG.LGN.LGNSIZE
     19088**DCL     19089--IMP-SIZ
LINCNFG$
     18932**DCL     18951--IMP-PTR
LINCNFG_BUF
     18931**DCL     18932--DCLINIT
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:141  
LIST_STR
     19747**DCL     20395--ASSIGN
MATCH_LEN
     19720**DCL     19951<<ASSIGN  19952<>CALL    19964<<ASSIGN  19965<>CALL    20008<<ASSIGN  20009<>CALL
     20046<<ASSIGN  20047<>CALL    20050<<ASSIGN  20051<>CALL    20126<<ASSIGN  20127<>CALL    20130<<ASSIGN
     20131<>CALL    20180<<CALLBLT 20181>>IF      20181<<ASSIGN  20182>>IF      20182<<ASSIGN  20184<>CALL
     20191<<CALLBLT 20192>>IF      20192<<ASSIGN  20193>>IF      20193<<ASSIGN  20195<>CALL    20278<<CALLBLT
     20279>>IF      20279<<ASSIGN  20280>>IF      20280<<ASSIGN  20282<>CALL
MERR_CODE.CODE
     16013**DCL     19939>>IF      20327>>IF      20352>>IF
NAME
     19721**DCL     20194<<ASSIGN  20195<>CALL
NAME_LEN
     19722**DCL     19949<<CALLBLT 19950>>IF      19950<<ASSIGN  19952<>CALL    19957<<ASSIGN  19961<<CALLBLT
     19965<>CALL    20001<<ASSIGN  20005<<CALLBLT 20009<>CALL    20049<<CALLBLT 20051<>CALL    20129<<CALLBLT
     20131<>CALL    20187<<CALLBLT 20188>>IF      20188<<ASSIGN  20189>>IF      20189<<ASSIGN  20190<<ASSIGN
     20190>>ASSIGN  20194>>ASSIGN  20195<>CALL
NEXT
     19918**LABEL   19921--CALLALT
NEXT_STATION
     19985**LABEL   19952--CALLALT
NO_REC_FOR_STATION1
     19983**LABEL   19969--CALLALT 19970--CALLALT
NO_REC_FOR_STATION2
     20028**LABEL   20013--CALLALT 20014--CALLALT
NO_REC_FOR_TERM1
     20099**LABEL   20058--CALLALT
NO_REC_FOR_TERM2
     20151**LABEL   20135--CALLALT 20136--CALLALT
OPTION_CODE
     19723**DCL     19756<<ASSIGN  19777<<ASSIGN  19784<<ASSIGN  19835<<ASSIGN  19838<<ASSIGN  19846<<ASSIGN
     19849<<ASSIGN  19872>>IF      19875<<ASSIGN  19880<<ASSIGN  19886<<ASSIGN  19892<<ASSIGN  19900<<ASSIGN
     19904>>IF      19906<<ASSIGN  19908>>IF      19910<<ASSIGN  19912>>DOSELCT
OUT$SYM.COUNT
     19683**DCL     19686--IMP-SIZ 19803>>ASSIGN  19804>>ASSIGN  19809>>ASSIGN  19810>>ASSIGN  19827>>ASSIGN
     19828>>ASSIGN  19833>>ASSIGN  19834>>ASSIGN  19844>>ASSIGN  19845>>ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:142  
OUT$SYM.TEXT
     19686**DCL     19804>>ASSIGN  19810>>ASSIGN  19828>>ASSIGN  19834>>ASSIGN  19845>>ASSIGN
P$B.CODE
     19622**DCL     19770>>ASSIGN  19789>>IF      19820>>ASSIGN
P$B.NSUBLKS
     19626**DCL     19768>>DOINDEX 19787>>IF      19788>>DOINDEX 19819>>IF
P$B.SUBLK$
     19647**DCL     19770>>ASSIGN  19787>>IF      19788>>DOINDEX 19789>>IF      19789>>IF      19802>>ASSIGN
     19808>>ASSIGN  19819>>IF      19820>>ASSIGN  19820>>ASSIGN  19826>>ASSIGN  19832>>ASSIGN  19843>>ASSIGN
PROJ_KEY.TEXT
     15890**DCL     15890--REDEF
PROJ_KEY.TXT.PROJECT
     15890**DCL     15890--REDEF
P_PCB.OUT$
     16058**DCL     19768>>DOINDEX 19770>>ASSIGN  19787>>IF      19788>>DOINDEX 19789>>IF      19802>>ASSIGN
     19808>>ASSIGN  19819>>IF      19820>>ASSIGN  19826>>ASSIGN  19832>>ASSIGN  19843>>ASSIGN
RD_ALT2
     20327**LABEL   20310--CALLALT
READ_ALT3
     20352**LABEL   19993--CALLALT 20113--CALLALT
READ_ERR
     20372**LABEL   19997--CALLALT 20036--CALLALT 20043--CALLALT 20103--CALLALT 20122--CALLALT
REMEM_VAR
     16016**DCL     16016--REDEF
REM_FCMD
     16016**DCL     16017--REDEF
STATION_NAME
     19724**DCL     20112<<ASSIGN
STATION_NAME.COUNT
     19725**DCL     19762<<ASSIGN  19833<<ASSIGN  19951>>ASSIGN  20353>>ASSIGN
STATION_NAME.TEXT
     19726**DCL     19763<<ASSIGN  19834<<ASSIGN  19836>>CALLBLT 19952<>CALL    19991>>CALLBLT 20354>>ASSIGN
TERMINAL_NAME
     19727**DCL     20112>>ASSIGN  20114<>CALL
TERMINAL_NAME.COUNT
     19728**DCL     19764<<ASSIGN  19844<<ASSIGN  20050>>ASSIGN  20115>>ASSIGN  20130>>ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:143  
TERMINAL_NAME.TEXT
     19729**DCL     19765<<ASSIGN  19845<<ASSIGN  19847>>CALLBLT 20051<>CALL    20110>>CALLBLT 20116>>ASSIGN
     20131<>CALL
TPDEV
     19730**DCL     20222>>ASSIGN
TPDEV.ACCT
     19732**DCL     19758<<ASSIGN  19804<<ASSIGN  19877>>CALLBLT 19909>>IF      20157>>CALLBLT 20158>>ASSIGN
     20159>>CALLBLT 20180>>CALLBLT 20184<>CALL    20223>>CALLBLT 20225>>CALLBLT
TPDEV.COUNT
     19731**DCL     19757<<ASSIGN  19803<<ASSIGN  19809<<ASSIGN
TPDEV.NAME
     19733**DCL     19759<<ASSIGN  19810<<ASSIGN  19883>>CALLBLT 19909>>IF      20160>>CALLBLT 20161>>ASSIGN
     20164>>ASSIGN  20191>>CALLBLT 20195<>CALL    20224>>CALLBLT 20225>>CALLBLT
TPDEV_ACCT_WILD
     19734**DCL     19876<<ASSIGN  19879<<ASSIGN  19890<<ASSIGN
TPDEV_NAME_SPECIFIED
     19735**DCL     19755<<ASSIGN  19811<<ASSIGN  19874>>IF
TPDEV_NAME_WILD
     19736**DCL     19882<<ASSIGN  19885<<ASSIGN  19891<<ASSIGN
TPDEV_SPECIFIED
     19737**DCL     19754<<ASSIGN  19798<<ASSIGN  19873>>IF
TWSN_CHAR
     19738**DCL     20040<<CALLBLT 20041>>CALLBLT 20077>>ASSIGN
TWSN_NUMBER
     19739**DCL     19948<<DOINDEX 19949>>CALLBLT 19952>>CALL    19953<>CALL    20037<<DOINDEX 20038>>IF
     20040>>CALLBLT
USERS_KEY
     15887**DCL     19922>>ASSIGN  19929<>CALL    19933>>IF      19934<<ASSIGN  19940<>CALL    19973<>CALL
     20017<>CALL    20061<>CALL    20139<>CALL    20167<<ASSIGN  20171>>ASSIGN  20202<>CALL    20209>>IF
     20210<<ASSIGN  20215>>ASSIGN  20222<<ASSIGN  20251<>CALL    20265<<ASSIGN  20269>>ASSIGN  20289<>CALL
     20295>>IF      20296<<ASSIGN  20301>>ASSIGN  20318<>CALL    20349<>CALL    20372<>CALL
USERS_KEY.COUNT
     15887**DCL     19958<<ASSIGN  19962<<ASSIGN  19990<<ASSIGN  19994<<ASSIGN  20002<<ASSIGN  20006<<ASSIGN
     20033<<ASSIGN  20039<<ASSIGN  20053<<ASSIGN  20100<<ASSIGN  20109<<ASSIGN  20119<<ASSIGN  20124<<ASSIGN
     20307<<ASSIGN
USERS_KEY.TEXT
PL6.E3A0      #001=ASL$LIST_ALL_DEVICES File=ASL$LIST_DEVICES.:E05TSI            TUE 07/29/97 10:07 Page:144  
     15887**DCL     15888--REDEF   15888--REDEF   15888--REDEF   15889--REDEF
USERS_KEY.TXTC
     15888**DCL     19967<<CALLBLT 19991<<CALLBLT 19995<<CALLBLT 20011<<CALLBLT 20034<<ASSIGN  20041<<CALLBLT
     20054<<CALLBLT 20101<<ASSIGN  20110<<CALLBLT 20120<<CALLBLT 20133<<CALLBLT 20172>>DOWHILE 20177>>CALLBLT
     20183>>ASSIGN  20187>>CALLBLT 20194>>ASSIGN  20270>>DOWHILE 20275>>CALLBLT 20281>>ASSIGN  20308<<CALLBLT
X$FORMAT
     19171**DCL-ENT 19870--CALL    20379--CALL    20400--CALL

PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:145  
      774        1        /*T***********************************************************/
      775        2        /*T*                                                         */
      776        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      777        4        /*T*                                                         */
      778        5        /*T***********************************************************/
      779        6        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:146  
      780        7        ASL$FORMAT_DEVNAME: PROC (TEXT$C, NUMBER);
      781        8        /**********************************************************/
      782        9
      783       10        /*D* NAME:     ASL$FORMAT_DEVNAME
      784       11             CALL:     CALL ASL$FORMAT_DEVNAME ;
      785       12             INPUT:    TEXT$C - A TEXTC string containing the key of the
      786       13                                 last device record read.
      787       14             OUTPUT:   Nothing is returned.
      788       15             DESCRIPTION:  ASL$FORMAT_DEVNAME is the routine that
      789       16                           formats the device records key into a device name
      790       17                           that can be recognized and used by a user.
      791       18                           This routine recognizes the following types of
      792       19                           record keys from :HLP:
      793       20                                 type 1 - device records - keys 'xxxxxxxx*'
      794       21                                 type 2 - device records - keys 'ddnn9999'
      795       22                                 type 3 - device records - keys 'xxxxxxxxxxxxxxxxxxxx'
      796       23                           And will format them like the following:
      797       24                                 type 1 - 'xxxxxxxx'  format - %>A
      798       25                                 type 2 - 'ddnn'      format - %A
      799       26                                 type 3 - 'xxxxxxxxxxxxxxxxxxxx' format - %8A','%12A
      800       27
      801       28                           The keys belong to the following types of devices:
      802       29                                 type 1 - regular devices and tp devices created
      803       30                                          with an account but no name.
      804       31                                 type 2 - devices belonging to a terminal.
      805       32                                 type 3 - tpdevices created with both an
      806       33                                          account and a name.
      807       34        */
      808       35        /********************************************************************/
      809       36        /*   Include files   include files   include files   include files  */
      810       37        /********************************************************************/
      811       38        %INCLUDE AS_SUPER_C;
      812      473        %INCLUDE AS_SUBS_C;
      813     1887        %INCLUDE AS_MAC_C;
      814     1967        %INCLUDE KL_SUPER_C;
      815     4869        %INCLUDE XU_MACRO_C;
      816     7975        %INCLUDE XU_FORMAT_C;
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:147  
      817     8137        %INCLUDE AS_SUPER_R;
      818    11153        /********************************************************************/
      819    11154        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      820    11155        /********************************************************************/
      821    11156    1   DCL X$FORMAT ENTRY(1);
      822    11157        /********************************************************************/
      823    11158        /*   Parameters      parameters      parameters      parameters     */
      824    11159        /********************************************************************/
      825    11160    1   DCL NUMBER UBIN;
      826    11161    1   DCL 1 TEXT$C,
      827    11162    1          2 COUNT UBIN BYTE UNAL,
      828    11163    1          2 TEXT CHAR(41) UNAL;
      829    11164        /********************************************************************/
      830    11165        /*   Auto data       auto data       auto data       auto data      */
      831    11166        /********************************************************************/
      832    11167    1   DCL ACCT                     CHAR(8);
      833    11168    1   DCL ACCT_LEN                 UBIN;
      834    11169    1   DCL 1 DEV_NAME,
      835    11170    1          2 COUNT               UBIN BYTE UNAL,
      836    11171    1          2 TEXT                CHAR(41) UNAL;
      837    11172    1   DCL LEN                      UBIN;
      838    11173    1   DCL NAME_LEN                 UBIN;
      839    11174    1   DCL NAME                     CHAR(12);
      840    11175        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:148  
      841    11176        /********************************************************************/
      842    11177        /*   Procedure       procedure       procedure       procedure      */
      843    11178        /********************************************************************/
      844    11179    2   IF TEXT$C.COUNT = 8 THEN DO;
      845    11180    2      DEV_NAME.COUNT = 4;
      846    11181    2      DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,4);
      847    11182    2      END;  /*  Count = 8  */
      848    11183    2   ELSE IF TEXT$C.COUNT = 9 THEN DO;
      849    11184    2         CALL INDEX (LEN, ' ', SUBSTR (TEXT$C.TEXT,0,8));
      850    11185    2         DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,LEN);
      851    11186    2         DEV_NAME.COUNT = LEN;
      852    11187    2         END; /*  If count = 9  */
      853    11188    2      ELSE DO;
      854    11189    2         CALL INDEX(ACCT_LEN, ' ', SUBSTR(TEXT$C.TEXT,0,8));
      855    11190    2         ACCT = SUBSTR (TEXT$C.TEXT,0,ACCT_LEN);
      856    11191    2         CALL INDEX (NAME_LEN, ' ', SUBSTR(TEXT$C.TEXT,8,12));
      857    11192    2         NAME = SUBSTR (TEXT$C.TEXT,8,NAME_LEN);
      858    11193    2         CALL CONCAT (DEV_NAME.TEXT, SUBSTR (ACCT,0,ACCT_LEN), ',', SUBSTR(NAME,0,
             11193                  NAME_LEN));
      859    11194    2         DEV_NAME.COUNT = ACCT_LEN + NAME_LEN + 1;
      860    11195    2         END; /*   Else  */
      861    11196    2   IF NUMBER = 0 THEN DO;
      862    11197    2      CALL CONCAT (FMT_BUF, '%\', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));
      863    11198    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 1;
      864    11199    2      END; /*  Number = 0  */
      865    11200    2   ELSE DO;
      866    11201    2      FMT_VEC(0) = VECTOR (DEV_NAME.COUNT);
      867    11202    2      FDS.NVECS# = 1;
      868    11203    2      CALL CONCAT (FMT_BUF, '%\%-%NR', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));
      869    11204    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 6;
      870    11205    2      END; /*  Else  */
      871    11206    1   CALL X$FORMAT(FDS);
      872    11207    1   END  ASL$FORMAT_DEVNAME;
      873    11208        %EOD;

PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:149  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FORMAT_DEVNAME.

   Procedure ASL$FORMAT_DEVNAME requires 119 words for executable code.
   Procedure ASL$FORMAT_DEVNAME requires 26 words of local(AUTO) storage.

PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:150  

 Object Unit name= ASL$FORMAT_DEVNAME                         File name= ASL$LIST_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:10:53.12 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      3      3  ASL$FORMAT_DEVNAME
    2   Proc  even  none   119    167  ASL$FORMAT_DEVNAME
    3  RoData even  none     2      2  ASL$FORMAT_DEVNAME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        2  ASL$FORMAT_DEVNAME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_2
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:151  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     FDS                                   FMT_BUF                               FMT_VEC
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:152  


      774        1        /*T***********************************************************/
      775        2        /*T*                                                         */
      776        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      777        4        /*T*                                                         */
      778        5        /*T***********************************************************/
      779        6        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:153  
      780        7        ASL$FORMAT_DEVNAME: PROC (TEXT$C, NUMBER);

      7  2 000000   000000 700200 xent  ASL$FORMAT_* TSX0  ! X66_AUTO_2
         2 000001   000032 000002                    ZERO    26,2

      781        8        /**********************************************************/
      782        9
      783       10        /*D* NAME:     ASL$FORMAT_DEVNAME
      784       11             CALL:     CALL ASL$FORMAT_DEVNAME ;
      785       12             INPUT:    TEXT$C - A TEXTC string containing the key of the
      786       13                                 last device record read.
      787       14             OUTPUT:   Nothing is returned.
      788       15             DESCRIPTION:  ASL$FORMAT_DEVNAME is the routine that
      789       16                           formats the device records key into a device name
      790       17                           that can be recognized and used by a user.
      791       18                           This routine recognizes the following types of
      792       19                           record keys from :HLP:
      793       20                                 type 1 - device records - keys 'xxxxxxxx*'
      794       21                                 type 2 - device records - keys 'ddnn9999'
      795       22                                 type 3 - device records - keys 'xxxxxxxxxxxxxxxxxxxx'
      796       23                           And will format them like the following:
      797       24                                 type 1 - 'xxxxxxxx'  format - %>A
      798       25                                 type 2 - 'ddnn'      format - %A
      799       26                                 type 3 - 'xxxxxxxxxxxxxxxxxxxx' format - %8A','%12A
      800       27
      801       28                           The keys belong to the following types of devices:
      802       29                                 type 1 - regular devices and tp devices created
      803       30                                          with an account but no name.
      804       31                                 type 2 - devices belonging to a terminal.
      805       32                                 type 3 - tpdevices created with both an
      806       33                                          account and a name.
      807       34        */
      808       35        /********************************************************************/
      809       36        /*   Include files   include files   include files   include files  */
      810       37        /********************************************************************/
      811       38        %INCLUDE AS_SUPER_C;
      812      473        %INCLUDE AS_SUBS_C;
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:154  
      813     1887        %INCLUDE AS_MAC_C;
      814     1967        %INCLUDE KL_SUPER_C;
      815     4869        %INCLUDE XU_MACRO_C;
      816     7975        %INCLUDE XU_FORMAT_C;
      817     8137        %INCLUDE AS_SUPER_R;
      818    11153        /********************************************************************/
      819    11154        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      820    11155        /********************************************************************/
      821    11156    1   DCL X$FORMAT ENTRY(1);
      822    11157        /********************************************************************/
      823    11158        /*   Parameters      parameters      parameters      parameters     */
      824    11159        /********************************************************************/
      825    11160    1   DCL NUMBER UBIN;
      826    11161    1   DCL 1 TEXT$C,
      827    11162    1          2 COUNT UBIN BYTE UNAL,
      828    11163    1          2 TEXT CHAR(41) UNAL;
      829    11164        /********************************************************************/
      830    11165        /*   Auto data       auto data       auto data       auto data      */
      831    11166        /********************************************************************/
      832    11167    1   DCL ACCT                     CHAR(8);
      833    11168    1   DCL ACCT_LEN                 UBIN;
      834    11169    1   DCL 1 DEV_NAME,
      835    11170    1          2 COUNT               UBIN BYTE UNAL,
      836    11171    1          2 TEXT                CHAR(41) UNAL;
      837    11172    1   DCL LEN                      UBIN;
      838    11173    1   DCL NAME_LEN                 UBIN;
      839    11174    1   DCL NAME                     CHAR(12);
      840    11175        %EJECT;
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:155  
      841    11176        /********************************************************************/
      842    11177        /*   Procedure       procedure       procedure       procedure      */
      843    11178        /********************************************************************/
      844    11179    2   IF TEXT$C.COUNT = 8 THEN DO;

  11179  2 000002   200003 470500                    LDP0    @TEXT$C,,AUTO
         2 000003   000100 101500                    MRL     fill='000'O
         2 000004   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000005   200030 000004                    ADSC9   NAME+3,,AUTO             cn=0,n=4
         2 000006   200030 236100                    LDQ     NAME+3,,AUTO
         2 000007   000010 116007                    CMPQ    8,DL
         2 000010   000017 601000 2                  TNZ     s:11183

      845    11180    2      DEV_NAME.COUNT = 4;

  11180  2 000011   004000 236003                    LDQ     2048,DU
         2 000012   200010 552140                    STBQ    DEV_NAME,'40'O,AUTO

      846    11181    2      DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,4);

  11181  2 000013   040100 100500                    MLR     fill='040'O
         2 000014   000000 200004                    ADSC9   0,,PR0                   cn=1,n=4
         2 000015   200010 200051                    ADSC9   DEV_NAME,,AUTO           cn=1,n=41

      847    11182    2      END;  /*  Count = 8  */

  11182  2 000016   000107 710000 2                  TRA     s:11196

      848    11183    2   ELSE IF TEXT$C.COUNT = 9 THEN DO;

  11183  2 000017   000100 101500                    MRL     fill='000'O
         2 000020   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000021   200030 000004                    ADSC9   NAME+3,,AUTO             cn=0,n=4
         2 000022   200030 236100                    LDQ     NAME+3,,AUTO
         2 000023   000011 116007                    CMPQ    9,DL
         2 000024   000041 601000 2                  TNZ     s:11189

PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:156  
      849    11184    2         CALL INDEX (LEN, ' ', SUBSTR (TEXT$C.TEXT,0,8));

  11184  2 000025   000000 124500                    SCM     mask='000'O
         2 000026   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000027   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000030   200023 000100                    ARG     LEN,,AUTO

      850    11185    2         DEV_NAME.TEXT = SUBSTR (TEXT$C.TEXT,0,LEN);

  11185  2 000031   200023 720100                    LXL0    LEN,,AUTO
         2 000032   040100 100540                    MLR     fill='040'O
         2 000033   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         2 000034   200010 200051                    ADSC9   DEV_NAME,,AUTO           cn=1,n=41

      851    11186    2         DEV_NAME.COUNT = LEN;

  11186  2 000035   200023 236100                    LDQ     LEN,,AUTO
         2 000036   000033 736000                    QLS     27
         2 000037   200010 552140                    STBQ    DEV_NAME,'40'O,AUTO

      852    11187    2         END; /*  If count = 9  */

  11187  2 000040   000107 710000 2                  TRA     s:11196

      853    11188    2      ELSE DO;

      854    11189    2         CALL INDEX(ACCT_LEN, ' ', SUBSTR(TEXT$C.TEXT,0,8));

  11189  2 000041   000000 124500                    SCM     mask='000'O
         2 000042   000000 200010                    ADSC9   0,,PR0                   cn=1,n=8
         2 000043   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000044   200007 000100                    ARG     ACCT_LEN,,AUTO

      855    11190    2         ACCT = SUBSTR (TEXT$C.TEXT,0,ACCT_LEN);

  11190  2 000045   200007 720100                    LXL0    ACCT_LEN,,AUTO
         2 000046   040100 100540                    MLR     fill='040'O
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:157  
         2 000047   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         2 000050   200005 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8

      856    11191    2         CALL INDEX (NAME_LEN, ' ', SUBSTR(TEXT$C.TEXT,8,12));

  11191  2 000051   000000 124500                    SCM     mask='000'O
         2 000052   000002 200014                    ADSC9   2,,PR0                   cn=1,n=12
         2 000053   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000054   200024 000100                    ARG     NAME_LEN,,AUTO

      857    11192    2         NAME = SUBSTR (TEXT$C.TEXT,8,NAME_LEN);

  11192  2 000055   200024 721100                    LXL1    NAME_LEN,,AUTO
         2 000056   040100 100540                    MLR     fill='040'O
         2 000057   000002 200011                    ADSC9   2,,PR0                   cn=1,n=*X1
         2 000060   200025 000014                    ADSC9   NAME,,AUTO               cn=0,n=12

      858    11193    2         CALL CONCAT (DEV_NAME.TEXT, SUBSTR (ACCT,0,ACCT_LEN), ',', SUBSTR(NAME,0,
             11193                  NAME_LEN));

  11193  2 000061   040100 100540                    MLR     fill='040'O
         2 000062   200005 000010                    ADSC9   ACCT,,AUTO               cn=0,n=*X0
         2 000063   200010 200051                    ADSC9   DEV_NAME,,AUTO           cn=1,n=41
         2 000064   200007 236100                    LDQ     ACCT_LEN,,AUTO
         2 000065   000051 116007                    CMPQ    41,DL
         2 000066   000103 603000 2                  TRC     s:11194
         2 000067   777726 622006                    EAX2    -42,QL
         2 000070   777777 662003                    ERX2    -1,DU
         2 000071   040146 100400                    MLR     fill='040'O
         2 000072   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000073   200010 200012                    ADSC9   DEV_NAME,Q,AUTO          cn=1,n=*X2
         2 000074   000050 116007                    CMPQ    40,DL
         2 000075   000103 603000 2                  TRC     s:11194
         2 000076   777727 623006                    EAX3    -41,QL
         2 000077   777777 663003                    ERX3    -1,DU
         2 000100   040146 100540                    MLR     fill='040'O
         2 000101   200025 000011                    ADSC9   NAME,,AUTO               cn=0,n=*X1
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:158  
         2 000102   200010 400013                    ADSC9   DEV_NAME,Q,AUTO          cn=2,n=*X3

      859    11194    2         DEV_NAME.COUNT = ACCT_LEN + NAME_LEN + 1;

  11194  2 000103   200024 036100                    ADLQ    NAME_LEN,,AUTO
         2 000104   000001 036007                    ADLQ    1,DL
         2 000105   000033 736000                    QLS     27
         2 000106   200010 552140                    STBQ    DEV_NAME,'40'O,AUTO

      860    11195    2         END; /*   Else  */

      861    11196    2   IF NUMBER = 0 THEN DO;

  11196  2 000107   200004 471500                    LDP1    @NUMBER,,AUTO
         2 000110   100000 235100                    LDA     0,,PR1
         2 000111   000132 601000 2                  TNZ     s:11201

      862    11197    2      CALL CONCAT (FMT_BUF, '%\', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));

  11197  2 000112   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000113   000033 772000                    QRL     27
         2 000114   000000 220000 1                  LDX0    0
         2 000115   000000 740000 xsym               STX0    FMT_BUF
         2 000116   000000 621006                    EAX1    0,QL
         2 000117   040000 100540                    MLR     fill='040'O
         2 000120   200010 200011                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X1
         2 000121   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      863    11198    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 1;

  11198  2 000122   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000123   000033 772000                    QRL     27
         2 000124   000001 036007                    ADLQ    1,DL
         2 000125   000020 736000                    QLS     16
         2 000126   000000 676000 xsym               ERQ     FDS
         2 000127   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000130   000000 656000 xsym               ERSQ    FDS
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:159  

      864    11199    2      END; /*  Number = 0  */

  11199  2 000131   000162 710000 2                  TRA     s:11206

      865    11200    2   ELSE DO;

      866    11201    2      FMT_VEC(0) = VECTOR (DEV_NAME.COUNT);

  11201  2 000132   177640 235007                    LDA     65440,DL
         2 000133   200030 452500                    STP2    NAME+3,,AUTO
         2 000134   200030 236100                    LDQ     NAME+3,,AUTO
         2 000135   000010 036003                    ADLQ    8,DU
         2 000136   000000 755000 xsym               STA     FMT_VEC
         2 000137   000001 756000 xsym               STQ     FMT_VEC+1

      867    11202    2      FDS.NVECS# = 1;

  11202  2 000140   000001 235007                    LDA     1,DL
         2 000141   000011 755000 xsym               STA     FDS+9

      868    11203    2      CALL CONCAT (FMT_BUF, '%\%-%NR', SUBSTR(DEV_NAME.TEXT,0,DEV_NAME.COUNT));

  11203  2 000142   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000143   000033 772000                    QRL     27
         2 000144   040000 100400                    MLR     fill='040'O
         2 000145   000001 000007 1                  ADSC9   1                        cn=0,n=7
         2 000146   000000 000007 xsym               ADSC9   FMT_BUF                  cn=0,n=7
         2 000147   000000 620006                    EAX0    0,QL
         2 000150   040000 100540                    MLR     fill='040'O
         2 000151   200010 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=*X0
         2 000152   000001 600370 xsym               ADSC9   FMT_BUF+1                cn=3,n=248

      869    11204    2      FDS.FMT_.BOUND = DEV_NAME.COUNT + 6;

  11204  2 000153   200010 236100                    LDQ     DEV_NAME,,AUTO
         2 000154   000033 772000                    QRL     27
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:160  
         2 000155   000006 036007                    ADLQ    6,DL
         2 000156   000020 736000                    QLS     16
         2 000157   000000 676000 xsym               ERQ     FDS
         2 000160   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000161   000000 656000 xsym               ERSQ    FDS

      870    11205    2      END; /*  Else  */

      871    11206    1   CALL X$FORMAT(FDS);

  11206  2 000162   000001 630400 3                  EPPR0   1
         2 000163   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000164   000000 701000 xent               TSX1    X$FORMAT
         2 000165   000000 011000                    NOP     0

      872    11207    1   END  ASL$FORMAT_DEVNAME;

  11207  2 000166   000000 702200 xent               TSX2  ! X66_ARET
      873    11208        %EOD;

PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:161  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FORMAT_DEVNAME.
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:162  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @NUMBER                    3-0-0/w PTR         r     1 @TEXT$C
     5-0-0/c CHAR(8)     r     1 ACCT                       7-0-0/w UBIN        r     1 ACCT_LEN
    10-0-0/c STRC(378)   r     1 DEV_NAME                  23-0-0/w UBIN        r     1 LEN
    25-0-0/c CHAR(12)    r     1 NAME                      24-0-0/w UBIN        r     1 NAME_LEN
    *0-0-0/w UBIN        r     1 NUMBER                    *0-0-0/c STRC(378)   r     1 TEXT$C

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)


   Procedure ASL$FORMAT_DEVNAME requires 119 words for executable code.
   Procedure ASL$FORMAT_DEVNAME requires 26 words of local(AUTO) storage.
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:163  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:164  
          MINI XREF LISTING

ACCT
     11167**DCL     11190<<ASSIGN  11193>>CALLBLT
ACCT_LEN
     11168**DCL     11189<<CALLBLT 11190>>ASSIGN  11193>>CALLBLT 11194>>ASSIGN
ASA_BRKS_LOC
      8301**DCL      8301--REDEF
AS_DEFAULT.BANNER_PERM
      8994**DCL      8995--REDEF
AS_DEFAULT.BUDGET.MACCT
      8899**DCL      8903--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
      8912**DCL      8915--REDEF
AS_DEFAULT.BUDGET.PACCUM
      8895**DCL      8897--REDEF
AS_DEFAULT.BUDGET.PMAXC
      8890**DCL      8892--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
      9010**DCL      9011--REDEF    9012--REDEF
AS_DEFAULT_DREC.PASSWORD
     10264**DCL     10268--REDEF
AS_DEFAULT_DREC.RENAME
     10287**DCL     10288--REDEF
AS_DFLT.BANNER_PERM
      8816**DCL      8817--REDEF
AS_DFLT.BUDGET.MACCT
      8721**DCL      8725--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
      8734**DCL      8737--REDEF
AS_DFLT.BUDGET.PACCUM
      8717**DCL      8719--REDEF
AS_DFLT.BUDGET.PMAXC
      8712**DCL      8714--REDEF
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:165  
AS_DFLT.SETUP_CHRA.TXT
      8832**DCL      8833--REDEF    8834--REDEF
AS_FE_MODE
      8167**DCL      8168--REDEF
AS_MODE
      8164**DCL      8166--REDEF
AS_MOD_USER.ACCESS
     11029**DCL     11030--REDEF
AS_MOD_USER.BANNER
     11016**DCL     11017--REDEF
AS_MOD_USER.BANNER_PERM
     11018**DCL     11019--REDEF
AS_MOD_USER.BILL
     11024**DCL     11025--REDEF
AS_MOD_USER.CPROC
     11020**DCL     11021--REDEF
AS_MOD_USER.FEBILL
     11100**DCL     11101--REDEF
AS_MOD_USER.FECXTMEM
     11117**DCL     11118--REDEF
AS_MOD_USER.FEMINTS
     11102**DCL     11103--REDEF
AS_MOD_USER.FEMMEM
     11113**DCL     11114--REDEF
AS_MOD_USER.FEMTIME
     11111**DCL     11112--REDEF
AS_MOD_USER.FEPPRIV
     11108**DCL     11110--REDEF
AS_MOD_USER.FEPRIV
     11105**DCL     11107--REDEF
AS_MOD_USER.FORCE_BIT
     11014**DCL     11015--REDEF
AS_MOD_USER.KEY
     11096**DCL     11098--REDEF
AS_MOD_USER.LASTCPROC
     11022**DCL     11023--REDEF
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:166  
AS_MOD_USER.LIMITS.DO_
     11070**DCL     11071--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     11086**DCL     11087--REDEF
AS_MOD_USER.LIMITS.LO
     11066**DCL     11067--REDEF
AS_MOD_USER.LIMITS.MEM
     11062**DCL     11063--REDEF
AS_MOD_USER.LIMITS.MPRIO
     11090**DCL     11091--REDEF
AS_MOD_USER.LIMITS.PDIS
     11078**DCL     11079--REDEF
AS_MOD_USER.LIMITS.PO
     11074**DCL     11075--REDEF
AS_MOD_USER.LIMITS.TDIS
     11082**DCL     11083--REDEF
AS_MOD_USER.LIMITS.TIME
     11058**DCL     11059--REDEF
AS_MOD_USER.MAXENQ
     11039**DCL     11040--REDEF
AS_MOD_USER.PERM_BIT
     11012**DCL     11013--REDEF
AS_MOD_USER.PPRIV
     11034**DCL     11036--REDEF
AS_MOD_USER.PRIOB
     11041**DCL     11042--REDEF
AS_MOD_USER.PRIV
     11031**DCL     11033--REDEF
AS_MOD_USER.QUAN
     11037**DCL     11038--REDEF
AS_MOD_USER.SETUP
     11010**DCL     11011--REDEF
AS_PROJECT.BANNER_PERM
      9350**DCL      9351--REDEF
AS_PROJECT.BUDGET.MACCT
      9255**DCL      9259--REDEF
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:167  
AS_PROJECT.BUDGET.MAX_PROJECTS
      9268**DCL      9271--REDEF
AS_PROJECT.BUDGET.PACCUM
      9251**DCL      9253--REDEF
AS_PROJECT.BUDGET.PMAXC
      9246**DCL      9248--REDEF
AS_PROJECT.SETUP_CHRA.TXT
      9366**DCL      9367--REDEF    9368--REDEF
AS_PROJECT_DFLT.BANNER_PERM
      9528**DCL      9529--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
      9433**DCL      9437--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
      9446**DCL      9449--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
      9429**DCL      9431--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
      9424**DCL      9426--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
      9544**DCL      9545--REDEF    9546--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     10750**DCL     10754--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     10773**DCL     10774--REDEF
AS_PROJECT_DREC.PASSWORD
     10588**DCL     10592--REDEF
AS_PROJECT_DREC.RENAME
     10611**DCL     10612--REDEF
AS_PROJ_ADMIN.BANNER_PERM
      9172**DCL      9173--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
      9077**DCL      9081--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
      9090**DCL      9093--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
      9073**DCL      9075--REDEF
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:168  
AS_PROJ_ADMIN.BUDGET.PMAXC
      9068**DCL      9070--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
      9188**DCL      9189--REDEF    9190--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     10426**DCL     10430--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     10449**DCL     10450--REDEF
AS_USERS.BANNER_PERM
      8638**DCL      8639--REDEF
AS_USERS.BUDGET.MACCT
      8543**DCL      8547--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
      8556**DCL      8559--REDEF
AS_USERS.BUDGET.PACCUM
      8539**DCL      8541--REDEF
AS_USERS.BUDGET.PMAXC
      8534**DCL      8536--REDEF
AS_USERS.SETUP_CHRA.TXT
      8654**DCL      8655--REDEF    8656--REDEF
AS_USERS_CONSTANT.BANNER_PERM
      9706**DCL      9707--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
      9611**DCL      9615--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
      9624**DCL      9627--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
      9607**DCL      9609--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
      9602**DCL      9604--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
      9722**DCL      9723--REDEF    9724--REDEF
DEV_NAME.COUNT
     11170**DCL     11180<<ASSIGN  11186<<ASSIGN  11194<<ASSIGN  11197>>CALLBLT 11198>>ASSIGN  11201--ASSIGN
     11203>>CALLBLT 11204>>ASSIGN
DEV_NAME.TEXT
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:169  
     11171**DCL     11181<<ASSIGN  11185<<ASSIGN  11193<<CALLBLT 11197>>CALLBLT 11203>>CALLBLT
ERR_CODE
      8296**DCL      8297--REDEF
FDS
      8193**DCL     11206<>CALL
FDS.FMT_.BOUND
      8198**DCL     11198<<ASSIGN  11204<<ASSIGN
FDS.NVECS#
      8221**DCL     11202<<ASSIGN
FMT_BUF
      8292**DCL     11197<<CALLBLT 11203<<CALLBLT
FMT_VEC
      8292**DCL     11201<<ASSIGN
KL_DEFAULT.PASSWORD
     10912**DCL     10916--REDEF
KL_DEFAULT.RENAME
     10935**DCL     10936--REDEF
KL_DFLT.PASSWORD
     10102**DCL     10106--REDEF
KL_DFLT.RENAME
     10125**DCL     10126--REDEF
KL_DREC.PASSWORD
      9940**DCL      9944--REDEF
KL_DREC.RENAME
      9963**DCL      9964--REDEF
KL_DREC_CNT.PASSWORD
      9827**DCL      9831--REDEF
KL_DREC_CNT.RENAME
      9850**DCL      9851--REDEF
LEN
     11172**DCL     11184<<CALLBLT 11185>>ASSIGN  11186>>ASSIGN
NAME
     11174**DCL     11192<<ASSIGN  11193>>CALLBLT
NAME_LEN
     11173**DCL     11191<<CALLBLT 11192>>ASSIGN  11193>>CALLBLT 11194>>ASSIGN
NUMBER
PL6.E3A0      #002=ASL$FORMAT_DEVNAME File=ASL$LIST_DEVICES.:E05TSI              TUE 07/29/97 10:10 Page:170  
     11160**DCL         7--PROC    11196>>IF
PROJ_KEY.TEXT
      8174**DCL      8174--REDEF
PROJ_KEY.TXT.PROJECT
      8174**DCL      8174--REDEF
REMEM_VAR
      8300**DCL      8300--REDEF
REM_FCMD
      8300**DCL      8301--REDEF
TEXT$C
     11161**DCL         7--PROC
TEXT$C.COUNT
     11162**DCL     11179>>IF      11183>>IF
TEXT$C.TEXT
     11163**DCL     11181>>ASSIGN  11184>>CALLBLT 11185>>ASSIGN  11189>>CALLBLT 11190>>ASSIGN  11191>>CALLBLT
     11192>>ASSIGN
USERS_KEY.TEXT
      8171**DCL      8172--REDEF    8172--REDEF    8172--REDEF    8173--REDEF
X$FORMAT
     11156**DCL-ENT 11206--CALL

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:171  
      874        1        /*T***********************************************************/
      875        2        /*T*                                                         */
      876        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      877        4        /*T*                                                         */
      878        5        /*T***********************************************************/
      879        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:172  
      880        7        /*M* ASL$DISP_ONE_DEVICE:  Routine to display one DEVICE. */
      881        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      882        9              ECU=3,CSU=3,SDI=3                                           */
      883       10        ASL$DISP_ONE_DEVICE: PROC (JCL, TERMINAL);
      884       11
      885       12        /********************************************************************/
      886       13        /*   Include files   include files   include files   include files  */
      887       14        /********************************************************************/
      888       15        %INCLUDE AS_SUBS_C;
      889     1429        %INCLUDE AS_MAC_C;
      890     1509        %INCLUDE AS_SSUBS_C;
      891     1601        %INCLUDE AS_PERR_C;
      892     2203        %INCLUDE AS_ENTRIES_M;
      893     3253        %INCLUDE AS_SUPER_C;
      894     3688        %INCLUDE KC$CGBLK;
      895     3736        %INCLUDE QQ_SUPER_C;
      896     3791        %INCLUDE FOO_MAC_C;
      897     4539        %INCLUDE FI_MAC_C;
      898     4909        %INCLUDE OC$INFO;
      899     4965        %INCLUDE OCI_SUBS_C;
      900     5063        %INCLUDE CP_6;
      901     5144        %INCLUDE KL_SUPER_C;
      902     8046        %INCLUDE XU_MACRO_C;
      903    11152        %INCLUDE XU_FORMAT_C;
      904    11314        %INCLUDE AS_SUPER_R;
      905    14330        /********************************************************************/
      906    14331        /*   Parameters      parameters      parameters      parameters     */
      907    14332        /********************************************************************/
      908    14333    1   DCL JCL      BIT (1);
      909    14334    1   DCL TERMINAL BIT (1);
      910    14335        /********************************************************************/
      911    14336        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      912    14337        /********************************************************************/
      913    14338        %ASB$READ_HLP ;
      914    14341        %ASA$ERROR ;
      915    14344        %ASB$WRITE_LO ;
      916    14347    1   DCL X$FORMAT ENTRY(1);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:173  
      917    14348        /********************************************************************/
      918    14349        /*   Local based     local based     local based     local based    */
      919    14350        /********************************************************************/
      920    14351        %KL_DREC       ( NAME = KL$DREC, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      921    14464        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ";", STCLASS = BASED );
      922    14490        %KL_DREC       ( NAME = RES$DREC, LAST = ";", STCLASS = "BASED(DSEG3$)" );
      923    14603        %KL_DREC       ( NAME = RESCL$DREC, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      924    14716        %KL_RES_CL_DEV ( NAME = CL_DEV, LAST = ";", LVL = 2, STCLASS = BASED);
      925    14776        %KL_DREC       ( NAME = CON$DREC, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      926    14889        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      927    14915        %OC$INFO       ( FPTN = OCINFO, LVL = 2, LAST = ";", STCLASS = BASED );
      928    14952        %KL_DREC       ( NAME = IN$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      929    15065        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      930    15091        %FI_CONINFO    ( FPTN = ISINFO, LVL = 2, LAST = ";", STCLASS = BASED );
      931    15135        %KL_DREC       ( NAME = OUT$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      932    15248        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      933    15274        %FO_CONINFO    ( FPTN = OSINFO, LVL = 2, LAST = ";", STCLASS = BASED );
      934    15305        %KL_DREC       ( NAME = CG$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      935    15418        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      936    15444        %B$CGAUINFO    ( FPTN = B$CGAUINFO, LVL = 2, STCLASS = BASED );
      937    15464        %KL_DREC       ( NAME = TP$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      938    15577        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      939    15603        %QQ$LOGON      ( FPTN = QQ$LOGON, LVL = 2, LAST = ";", STCLASS = BASED );
      940    15639        %KL_WSNDEV     ( NAME = DEVWSNS, STCLASS = "BASED (DSEG1$)");
      941    15644    1   DCL 1 TEXT$C BASED,
      942    15645    1          2 L UBIN BYTE UNAL,
      943    15646    1          2 C CHAR(TEXT$C.L) UNAL;
      944    15647    1   DCL OPT$ORDR(0:0) UBIN BYTE UNAL BASED(OPT_ORDR$);
      945    15648        /********************************************************************/
      946    15649        /*   Constant data   constant data   constant data   constant data  */
      947    15650        /********************************************************************/
      948    15651    1   DCL 1 OPT_TBL  CONSTANT,
      949    15652    1          2 HDR(0:70) CHAR(18) CALIGNED INIT(
      950    15653    1             '   PROFILE =',
      951    15654    1             '   PASSWORD =',
      952    15655    1             '   MAXPRIO =',
      953    15656    1             '   WSN =',
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:174  
      954    15657    1             '   SYSTEM =',
      955    15658    1             '   ADMIN =',
      956    15659    1             '   COMMUNICATION =',
      957    15660    1             '   DEVICE =',
      958    15661    1             '   SLAVE =',
      959    15662    1             '   CMD =',
      960    15663    1             '   USE =',
      961    15664    1             '   TYPE =',
      962    15665    1             '   UPLOCKED =',
      963    15666    1             '   FORM =',
      964    15667    1             '   DEFPRIO =',
      965    15668    1             '   NCTL =',
      966    15669    1             '   NCOK =',
      967    15670    1             '   NCACCT =',
      968    15671    1             '   NCFID =',
      969    15672    1             '   COMGROUP =',
      970    15673    1             '   SNAME =',
      971    15674    1             '   NOCG =',
      972    15675    1             '   USER1 =',
      973    15676    1             '   USER2 =',
      974    15677    1             '   USER3 =',
      975    15678    1             '   USER4 =',
      976    15679    1             '   INSTANCE =',
      977    15680    1             '   PRIORITY =',
      978    15681    1             '   MCT =',
      979    15682    1             '   NATIVEL =',
      980    15683    1             '   TP =',
      981    15684    1             '   MODE =',
      982    15685    1             '   RNAME =',
      983    15686    1             '   AUACCOUNT =',
      984    15687    1             '   B300 =',
      985    15688    1             '   B1200 =',
      986    15689    1             '   B2400 =',
      987    15690    1             '   HAYES =',
      988    15691    1             '   X28 =',
      989    15692    1             '   RFU1 =',
      990    15693    1             '   RFU2 =',
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:175  
      991    15694    1             '   RFU3 =',
      992    15695    1             '   RFU4 =',
      993    15696    1             '   RFU5 =',
      994    15697    1             '   RFU6 =',
      995    15698    1             '   RFU7 =',
      996    15699    1             '   RFU8 =',
      997    15700    1             '   RFU9 =',
      998    15701    1             '   RFU10 =',
      999    15702    1             '   RFU11 =',
     1000    15703    1             '   TCPIP =',
     1001    15704    1             '   RFU13 =',
     1002    15705    1             '   PRIVILEGED =',
     1003    15706    1             '   TCP =',
     1004    15707    1             '   IP =',
     1005    15708    1             ' '*0),
     1006    15709    1          2 CON_ORDR(0:11) UBIN BYTE CALIGNED INIT(
     1007    15710    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_MAXPRIO, L_CD_WSN, L_CD_NATIVEL,
     1008    15711    1             L_CD_SYS, L_CD_ADMIN, L_CD_COMM, L_CD_DEV, L_CD_SLAVE,
     1009    15712    1             L_CD_TP, L_CD_CMD ),
     1010    15713    1          2 OUT_ORDR(0:5) UBIN BYTE CALIGNED INIT(
     1011    15714    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_TYPE, L_CD_FORM,
     1012    15715    1             L_CD_UPLOCK ),
     1013    15716    1          2 IN_ORDR(0:10) UBIN BYTE CALIGNED INIT(
     1014    15717    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_TYPE, L_CD_WSN,
     1015    15718    1             L_CD_DEFPRIO, L_CD_MAXPRIO, L_CD_NCTL, L_CD_NCOK, L_CD_NCACCT,
     1016    15719    1             L_CD_NCFID ),
     1017    15720    1          2 CG_ORDR(0:10) UBIN BYTE CALIGNED INIT(
     1018    15721    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_SNAME, L_CD_NOCG,
     1019    15722    1             L_CD_USER1, L_CD_USER2, L_CD_USER3, L_CD_USER4,L_CD_COMGROUP,
     1020    15723    1             L_CD_CMD ),
     1021    15724    1          2 TP_ORDR(0:8) UBIN BYTE CALIGNED INIT(
     1022    15725    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_INSTANCE, L_CD_SNAME,
     1023    15726    1             L_CD_PRIORITY, L_CD_MCT, L_CD_NOCG, L_CD_CMD ),
     1024    15727    1          2 RES_CL_ORDR(0:24) UBIN BYTE CALIGNED INIT(
     1025    15728    1             L_CD_USE, L_CD_TYPE, L_CD_PROFILE, L_CD_PASSWORD,
     1026    15729    1             L_CD_MODE, L_CD_RNAME, L_CD_AUACCT, L_CD_HAYES, L_CD_X28, L_CD_TCPIP,
     1027    15730    1             L_CD_B300, L_CD_B1200, L_CD_B2400, L_CD_RFU1, L_CD_RFU2,
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:176  
     1028    15731    1             L_CD_RFU3, L_CD_RFU4, L_CD_RFU5, L_CD_RFU6, L_CD_RFU7,
     1029    15732    1             L_CD_RFU8, L_CD_RFU9, L_CD_RFU10, L_CD_RFU11, L_CD_RFU13 ),
     1030    15733    1          2 RES_ORDR(0:3) UBIN BYTE CALIGNED INIT(
     1031    15734    1             L_CD_USE, L_CD_TYPE, L_CD_PROFILE, L_CD_PASSWORD );
     1032    15735    1   DCL CG_STR         CHAR(0) CONSTANT INIT('CG');
     1033    15736    1   DCL COMMANDS_STR   CHAR(0) CONSTANT INIT('COMMANDS');
     1034    15737    1   DCL CONSOLE_STR    CHAR(0) CONSTANT INIT('CONSOLE');
     1035    15738    1   DCL DEVICE_STR     CHAR(0) CONSTANT INIT('DEVICE');
     1036    15739    1   DCL DEVWSNS_HDR    CHAR(0) CONSTANT INIT (
             15739            'The WSNs associated with this device are:');
     1037    15740    1   DCL DISPLAY_STR    CHAR(0) CONSTANT INIT('DISPLAY');
     1038    15741    1   DCL FIXED_STR      CHAR(0) CONSTANT INIT('FIXED');
     1039    15742    1   DCL INCOMING_STR   CHAR(0) CONSTANT INIT('INCOMING ');
     1040    15743    1   DCL INFORM_STR     CHAR(0) CONSTANT INIT('INFORM');
     1041    15744    1   DCL IN_STR         CHAR(0) CONSTANT INIT('IN');
     1042    15745    1   DCL KEYIN_STR      CHAR(0) CONSTANT INIT('KEYIN');
     1043    15746    1   DCL LINK_STR       CHAR(0) CONSTANT INIT(' FOR LINK ');
     1044    15747    1   DCL NONE_STR       CHAR(0) CONSTANT INIT('NONE');
     1045    15748    1   DCL NO_STR         CHAR(0) CONSTANT INIT('NO');
     1046    15749    1   DCL OK_STR         CHAR(0) CONSTANT INIT('OK');
     1047    15750    1   DCL OUTGOING_STR   CHAR(0) CONSTANT INIT('OUTGOING');
     1048    15751    1   DCL OUT_STR        CHAR(0) CONSTANT INIT('OUT');
     1049    15752    1   DCL REJECT_STR     CHAR(0) CONSTANT INIT('REJECT');
     1050    15753    1   DCL RES_STR        CHAR(0) CONSTANT INIT('RESOURCE');
     1051    15754    1   DCL STATION_STR    CHAR(0) CONSTANT INIT(' FOR STATION ');
     1052    15755    1   DCL TERMINAL_STR   CHAR(0) CONSTANT INIT(' FOR TERMINAL ');
     1053    15756    1   DCL TP_STR         CHAR(0) CONSTANT INIT('TP');
     1054    15757    1   DCL YES_STR        CHAR(0) CONSTANT INIT('YES');
     1055    15758        /********************************************************************/
     1056    15759        /*   Auto data       auto data       auto data       auto data      */
     1057    15760        /********************************************************************/
     1058    15761    1   DCL CG                            CHAR(32);
     1059    15762    1   DCL CGCNT                         UBIN;
     1060    15763    1   DCL CMD                           CHAR(80);
     1061    15764    1   DCL CMDCNT                        UBIN;
     1062    15765    1   DCL 1 DEV_NAME,
     1063    15766    1          2 COUNT                    UBIN BYTE CALIGNED,
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:177  
     1064    15767    1          2 TEXT                     CHAR(8) CALIGNED,
     1065    15768    1          2 UNAME                    CHAR(12) CALIGNED,
     1066    15769    1          2 *                        CHAR(21) CALIGNED;
     1067    15770    1   DCL I                             SBIN;
     1068    15771    1   DCL INSTANCE                      CHAR(18);
     1069    15772    1   DCL INSTANCECNT                   UBIN;
     1070    15773    1   DCL LEN                           SBIN;
     1071    15774    1   DCL L_TYPE                        UBIN;
     1072    15775    1   DCL MASK                          BIT(18);
     1073    15776    1   DCL NEXT                          SBIN;
     1074    15777    1   DCL NUM_OPTS                      UBIN;
     1075    15778    1   DCL OPT_ORDR$                     PTR;
     1076    15779    1   DCL SBINS   (0:99)                SBIN;
     1077    15780    1   DCL SBIN_IDX                      SBIN;
     1078    15781    1   DCL ST_IDX                        SBIN;
     1079    15782    1   DCL T_SNAME                       CHAR(8) ;
     1080    15783        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:178  
     1081    15784        /********************************************************************/
     1082    15785        /*   Procedure       procedure       procedure       procedure      */
     1083    15786        /********************************************************************/
     1084    15787
     1085    15788    1   IF (KL$DREC.ATYP = 0) THEN RETURN; /* This stops the listing of wsndev
     1086    15789                                               records */
     1087    15790    2   DO SELECT ( KL$DREC.SUPER );
     1088    15791    2      SELECT ( AS_IN_DEV# );
     1089    15792    2      L_TYPE = L_IN_DEV;
     1090    15793    2      OPT_ORDR$ = ADDR(OPT_TBL.IN_ORDR);
     1091    15794    2      NUM_OPTS  = LENGTHC(OPT_TBL.IN_ORDR);
     1092    15795    2      SELECT ( AS_OUT_DEV# );
     1093    15796    2      L_TYPE = L_OUT_DEV;
     1094    15797    2      OPT_ORDR$ = ADDR(OPT_TBL.OUT_ORDR);
     1095    15798    2      NUM_OPTS  = LENGTHC(OPT_TBL.OUT_ORDR);
     1096    15799    2      SELECT ( AS_CG_DEV# );
     1097    15800    2      L_TYPE = L_CG_DEV;
     1098    15801    2      OPT_ORDR$ = ADDR(OPT_TBL.CG_ORDR);
     1099    15802    2      NUM_OPTS  = LENGTHC(OPT_TBL.CG_ORDR);
     1100    15803    2      SELECT ( AS_TP_DEV# );
     1101    15804    2      L_TYPE = L_TP_DEV;
     1102    15805    2      OPT_ORDR$ = ADDR(OPT_TBL.TP_ORDR);
     1103    15806    2      NUM_OPTS  = LENGTHC(OPT_TBL.TP_ORDR);
     1104    15807    2      SELECT ( AS_CON# );
     1105    15808    2      L_TYPE = L_CONSOLE;
     1106    15809    2      OPT_ORDR$ = ADDR(OPT_TBL.CON_ORDR);
     1107    15810    2      NUM_OPTS  = LENGTHC(OPT_TBL.CON_ORDR);
     1108    15811    2      SELECT ( AS_RES_DEV# );
     1109    15812    2      L_TYPE = L_RES_DEV;
     1110    15813    3      IF SUBSTR (RESCL$DREC.RENAME,0,2) = 'CL' THEN DO;
     1111    15814    3         OPT_ORDR$ = ADDR(OPT_TBL.RES_CL_ORDR);
     1112    15815    3         NUM_OPTS  = LENGTHC(OPT_TBL.RES_CL_ORDR);
     1113    15816    3         END;   /*  Type = cl  */
     1114    15817    3      ELSE DO;
     1115    15818    3         OPT_ORDR$ = ADDR(OPT_TBL.RES_ORDR);
     1116    15819    3         NUM_OPTS  = LENGTHC(OPT_TBL.RES_ORDR);
     1117    15820    3         END;   /*  Not type = cl  */
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:179  
     1118    15821
     1119    15822    2      SELECT ( ELSE );
     1120    15823    2   RETURN;
     1121    15824    2      END;
     1122    15825    1   DEV_NAME = USERS_KEY;
     1123    15826    2   DO SELECT ( L_TYPE );
     1124    15827    2      SELECT ( L_CONSOLE );
     1125    15828    2      FMT_VEC(0) = VECTOR(CONSOLE_STR);
     1126    15829    2      SELECT ( ELSE );
     1127    15830    2   FMT_VEC(0) = VECTOR(DEVICE_STR);
     1128    15831    2      END;  /*  Case L_TYPE  */
     1129    15832    2   IF DEV_NAME.COUNT = 8 THEN DO;
     1130    15833    2      LEN = 4;
     1131    15834    2      END;  /*  Count = 8  */
     1132    15835    2   ELSE DO;
     1133    15836    2      LEN = 8;
     1134    15837    2      END; /*  If count ~= 8  */
     1135    15838    2   IF NOT TERMINAL THEN DO;
     1136    15839    2      FMT_VEC(1) = VECTOR( SUBSTR(DEV_NAME.TEXT,0,LEN) );
     1137    15840    2      FDS.NVECS# = 2;
     1138    15841    3      IF JCL THEN DO;
     1139    15842    3         FMT_BUF = 'CREATE ';
     1140    15843    3         FDS.FMT_.BOUND = 6;
     1141    15844    3         END;   /*  Jcl  */
     1142    15845    3      ELSE DO;
     1143    15846    3         FMT_BUF = ' ';
     1144    15847    3         FDS.FMT_.BOUND = 0;
     1145    15848    3         END;  /*   Not jcl  */
     1146    15849    3      IF L_TYPE = L_TP_DEV AND DEV_NAME.UNAME ~= '*' THEN DO;
     1147    15850    3         SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,13) = 'TP %A %>A,%>A';
     1148    15851    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + 13;
     1149    15852    3         FMT_VEC (FDS.NVECS#) = VECTOR (DEV_NAME.UNAME);
     1150    15853    3         FDS.NVECS# = FDS.NVECS# + 1;
     1151    15854    3         END;   /*  Tp dev with a uname  */
     1152    15855    3      ELSE DO;
     1153    15856    3         SUBSTR (FMT_BUF, FDS.FMT_.BOUND+1, 6) = '%A %>A';
     1154    15857    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + 6;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:180  
     1155    15858    3         END;  /*  Not tp  */
     1156    15859    2      END;   /*  Not terminal  */
     1157    15860    2   ELSE DO;
     1158    15861    2      FDS.NVECS# = 1;
     1159    15862    2      FMT_BUF = '%A';
     1160    15863    2      FDS.FMT_.BOUND = 1;
     1161    15864    2      END;  /*  Terminal  */
     1162    15865    2   IF NOT TERMINAL THEN DO;
     1163    15866    2      IF ((L_TYPE = L_CG_DEV) OR (L_TYPE = L_TP_DEV)) AND DEV_NAME.COUNT ~= 8 THEN
     1164    15867    2         GOTO NO_STATION;
     1165    15868    2      IF KL$DREC.TNAME = ' '
     1166    15869                                           /*  Is it a tdev??  */
     1167    15870    3      THEN DO;
     1168    15871    3         USERS_KEY.COUNT = 15;
     1169    15872    3         T_SNAME = KL$DREC.SNAME ;
     1170    15873    3         CALL CONCAT( USERS_KEY.TXTC, T_SNAME, 'STATION' );
     1171    15874    3         END; /* Then do */
     1172    15875    3      ELSE DO;
     1173    15876    4         IF JCL THEN DO;
     1174    15877    4            FMT_BUF = ' ';
     1175    15878    4            FDS.FMT_.BOUND = 0;
     1176    15879    4            FDS.NVECS# = 0;
     1177    15880    4            RETURN;
     1178    15881    4            END;   /*  Jcl  */
     1179    15882    4         ELSE DO;
     1180    15883    4            USERS_KEY.COUNT = 9;
     1181    15884    4            T_SNAME = KL$DREC.TNAME ;
     1182    15885    4            CALL CONCAT( USERS_KEY.TXTC, T_SNAME, '*' );
     1183    15886    4            END;  /*  Else do  */
     1184    15887    3         END; /* Else do */
     1185    15888    2      I = DSEG1SIZE;
     1186    15889    2      CALL ASB$READ_HLP( DSEG1$, I ) WHENALTRETURN
     1187    15890    3      DO ;
     1188    15891    3         CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
     1189    15892    3         RETURN;
     1190    15893    3         END;  /*  Whenaltreturn  */
     1191    15894    2      IF DSEG1$->KL$DREC.ATYP = %KLAT_STA# THEN
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:181  
     1192    15895    2         FMT_VEC(FDS.NVECS#) = VECTOR(STATION_STR);
     1193    15896    2      ELSE
     1194    15897    2         IF DSEG1$->KL$DREC.ATYP = %KLAT_TRM# THEN
     1195    15898    2            FMT_VEC(FDS.NVECS#) = VECTOR(TERMINAL_STR);
     1196    15899    2      FDS.NVECS# = FDS.NVECS# + 1;
     1197    15900    2      FMT_VEC(FDS.NVECS#) = VECTOR(T_SNAME);
     1198    15901    2      FDS.NVECS# = FDS.NVECS# + 1;
     1199    15902    2      SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,5) = '%A%>A';
     1200    15903    2      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 5;
     1201    15904    2      IF (L_TYPE = L_TP_DEV) AND
     1202    15905    2           (DEV_NAME.UNAME ~= '*') AND
     1203    15906    2           (DEV_NAME.COUNT > 8) THEN
     1204    15907    3      DO;
     1205    15908    3         SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,4) = ',%>A';
     1206    15909    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + 4;
     1207    15910    3         FMT_VEC (FDS.NVECS#) = VECTOR (DEV_NAME.UNAME);
     1208    15911    3         FDS.NVECS# = FDS.NVECS# + 1;
     1209    15912    3         END;
     1210    15913    2      END;  /*  Terminal  */
     1211    15914    1   NO_STATION:
     1212    15915    1   CALL X$FORMAT(FDS);
     1213    15916    1   FDS.NVECS# = 0;
     1214    15917
     1215    15918    1   ST_IDX = 0;
     1216    15919
     1217    15920    1   FDS.TABDFLT# = 36;
     1218    15921    1   FMT_BUF = '%\';
     1219    15922    1   FDS.FMT_.BOUND = 1;
     1220    15923    1   SBIN_IDX = 0 ;
     1221    15924    1   FDS.NVECS# = 0 ;
     1222    15925
     1223    15926    2   DO WHILE(ST_IDX < NUM_OPTS );
     1224    15927
     1225    15928    2      NEXT = OPT$ORDR(ST_IDX);
     1226    15929        /*  Get the option values length  */
     1227    15930        /*  For the variable options  */
     1228    15931
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:182  
     1229    15932    3      DO SELECT ( NEXT );
     1230    15933    3         SELECT ( L_CD_CMD );
     1231    15934    4         DO SELECT (L_TYPE);
     1232    15935    4            SELECT (L_CONSOLE);
     1233    15936    4            CMDCNT = CON$DREC.OCINFO.CMDCNT;
     1234    15937    4            CMD = CON$DREC.OCINFO.CMD;
     1235    15938    4            SELECT (L_CG_DEV);
     1236    15939    4            CMDCNT = CG$DEV.B$CGAUINFO.UCMDCNT;
     1237    15940    4            CMD = CG$DEV.B$CGAUINFO.UCMD;
     1238    15941    4            SELECT (L_TP_DEV);
     1239    15942    4            CMDCNT = TP$DEV.QQ$LOGON.CMDCNT;
     1240    15943    4            CMD = TP$DEV.QQ$LOGON.CMD;
     1241    15944    4            END;
     1242    15945    3         SELECT ( L_CD_COMGROUP );
     1243    15946    3         CALL INDEX( I, AS_BLANK, CG$DEV.KC$CGID.PSN# );
     1244    15947    4         IF I > 0 THEN DO;
     1245    15948    4            CALL CONCAT( CG, 'CG#', SUBSTR(CG$DEV.KC$CGID.PSN#,0,I), '/' );
     1246    15949    4            CGCNT = I + 4;
     1247    15950    4            END;
     1248    15951    4         ELSE DO;
     1249    15952    4            CG = 'CG/';
     1250    15953    4            CGCNT = 3;
     1251    15954    4            END;
     1252    15955    3         CALL INSERT( CG, CGCNT, ,
     1253    15956    3              SUBSTR(CG$DEV.KC$CGID.NAME#.TXT,0,CG$DEV.KC$CGID.NAME#.CNT),
     1254    15957    3              '.', CG$DEV.KC$CGID.ACCT# );
     1255    15958    3         CALL INDEX( I, AS_BLANK, CG$DEV.KC$CGID.ACCT# );
     1256    15959    3         CGCNT = CGCNT + CG$DEV.KC$CGID.NAME#.CNT + I + 1;
     1257    15960    3         SELECT ( L_CD_INSTANCE );
     1258    15961    4         IF TP$DEV.KC$CGID.PSN# = AS_BLANK THEN DO;
     1259    15962    4            INSTANCE = TP$DEV.KC$CGID.NAME#.TXT;
     1260    15963    4            INSTANCECNT = TP$DEV.KC$CGID.NAME#.CNT;
     1261    15964    4            END;
     1262    15965    4         ELSE DO;
     1263    15966    4            CALL INDEX( I, AS_BLANK, TP$DEV.KC$CGID.PSN# );
     1264    15967    4            CALL CONCAT( INSTANCE, 'DP#', SUBSTR(TP$DEV.KC$CGID.PSN#,0,I),
     1265    15968    4                 '.', TP$DEV.KC$CGID.NAME#.TXT );
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:183  
     1266    15969    4            INSTANCECNT = TP$DEV.KC$CGID.NAME#.CNT + I + 4;
     1267    15970    4            END;
     1268    15971    3         END;
     1269    15972
     1270    15973    2      CALL INSERT_FIELD ;
     1271    15974    2      CALL X$FORMAT(FDS);
     1272    15975    2      FDS.NVECS# = 0;
     1273    15976    2      FMT_BUF = '%\%-';
     1274    15977    2      FDS.FMT_.BOUND = 3;
     1275    15978    2      ST_IDX = ST_IDX + 1;
     1276    15979    2      END;
     1277    15980    1   FMT_BUF = '%\%/';
     1278    15981    1   FDS.FMT_.BOUND = 3;
     1279    15982    1   FDS.NVECS# = 0;
     1280    15983    1   CALL X$FORMAT(FDS);
     1281    15984    1   FDS.NVECS# = 0;
     1282    15985    2   IF NOT JCL THEN DO;
     1283    15986    2      CALL CONCAT (USERS_KEY.TXTC, SUBSTR (DEV_NAME.TEXT, 0, 8),'WSNS');
     1284    15987    2      USERS_KEY.COUNT = 12; /* DEVNAME=8 + 4 for 'WSNS' */
     1285    15988    2      I = DSEG1SIZE;
     1286    15989    2      CALL ASB$READ_HLP (DSEG1$, I)
     1287    15990    3      WHENRETURN DO;
     1288    15991    3         IF (DEVWSNS.NDEV > 0)
     1289    15992    4         THEN DO;
     1290    15993    4            CALL CONCAT(FMT_BUF, '%1\', DEVWSNS_HDR, '%/');
     1291    15994    4            FDS.FMT_.BOUND = LENGTHC(DEVWSNS_HDR) + 4;
     1292    15995    4            CALL X$FORMAT (FDS);
     1293    15996    4            FDS.NVECS# = 0;
     1294    15997    4            FDS.TABDFLT# = 10;
     1295    15998    5            DO I = 0 TO (DEVWSNS.NDEV - 1);
     1296    15999    6               IF I = 0 THEN DO;
     1297    16000    6                  CALL CONCAT(FMT_BUF, '%\',SUBSTR(DEVWSNS.DEV(I),0,8));
     1298    16001    6                  FDS.FMT_.BOUND = 9;
     1299    16002    6                  END;
     1300    16003    6               ELSE DO;
     1301    16004    6                  CALL CONCAT(FMT_BUF, '%\%-%10R', SUBSTR(DEVWSNS.DEV(I),0,8));
     1302    16005    6                  FDS.FMT_.BOUND = 15;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:184  
     1303    16006    6                  END;
     1304    16007    5               CALL X$FORMAT (FDS);
     1305    16008    5               END; /* Do i */
     1306    16009    4            FMT_BUF = '%\%/';
     1307    16010    4            FDS.FMT_.BOUND = 3;
     1308    16011    4            FDS.NVECS# = 0;
     1309    16012    4            CALL X$FORMAT (FDS);
     1310    16013    4            END; /* Do if DEVWSNS.NDEV > 0 */
     1311    16014    3         END; /* Whenreturn */
     1312    16015    3      WHENALTRETURN DO; /* Just in case there is no devwsn record */
     1313    16016    3         END;
     1314    16017    2      CALL ASB$WRITE_LO( AS_BLANK, 1 );
     1315    16018    2      END; /*  Not jcl  */
     1316    16019    1   RETURN;
     1317    16020
     1318    16021    1   INSERT_FIELD: PROC;
     1319    16022        %SUB C_ATTRIBUTES = 4;
     1320    16023        %SUB C_OCTAL = 5;
     1321    16024    2   DCL CLASS SBIN;
     1322    16025    2   DCL YES_NO BIT(1) ALIGNED;
     1323    16026
     1324    16027
     1325    16028    3   DO CASE (NEXT);
     1326    16029
     1327    16030    3      CASE (L_CD_PROFILE);
     1328    16031    4         IF KL$DREC.PNAME.CNT = 0 THEN DO;
     1329    16032    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR ( NONE_STR) ;
     1330    16033    4            LEN = 4;
     1331    16034    4            END;   /*  Blank profile  */
     1332    16035    4         ELSE DO;
     1333    16036    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR(ADDR(KL$DREC.PNAME)->TEXT$C.C);
     1334    16037    4            LEN = KL$DREC.PNAME.CNT;
     1335    16038    4            END;   /*  Non blank profile  */
     1336    16039    3         CLASS = C_TEXT;
     1337    16040
     1338    16041    3      CASE (L_CD_PASSWORD);
     1339    16042    4         IF NOT TERMINAL THEN DO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:185  
     1340    16043    5            IF KL$DREC.PASSWORD= BLANK_PASS THEN DO;
     1341    16044    5               FMT_VEC(FDS.NVECS# + 2) = VECTOR(NONE_STR);
     1342    16045    5               CLASS= C_TEXT;
     1343    16046    5               LEN = 4;
     1344    16047    5               END;
     1345    16048    5            ELSE DO;
     1346    16049    5               FMT_VEC(FDS.NVECS# + 2) = VECTOR ( SUBSTR(KL$DREC.PASSWORD,0,4) );
     1347    16050    5               FMT_VEC(FDS.NVECS# + 3) = VECTOR ( SUBSTR(KL$DREC.PASSWORD,4,4) );
     1348    16051    5               CLASS = C_OCTAL;
     1349    16052    5               LEN = 27;
     1350    16053    5               END;  /* BLANK_PASS */
     1351    16054    4            END;  /*  Not terminal  */
     1352    16055
     1353    16056    3      CASE (L_CD_MAXPRIO);
     1354    16057    4         DO CASE (L_TYPE);
     1355    16058    4            CASE (L_CONSOLE);
     1356    16059    4               SBINS(SBIN_IDX + 1) = CON$DREC.OCINFO.MXPRI;
     1357    16060    4            CASE (L_IN_DEV);
     1358    16061    4               SBINS(SBIN_IDX + 1) = IN$DEV.ISINFO.MXPRI;
     1359    16062    4            END;
     1360    16063    3         CLASS = C_SBIN;
     1361    16064    3         LEN = 3;
     1362    16065
     1363    16066    3      CASE (L_CD_WSN);
     1364    16067    4         DO CASE (L_TYPE);
     1365    16068    4            CASE (L_CONSOLE);
     1366    16069    5               IF CON$DREC.OCINFO.WSN = ' ' THEN DO;
     1367    16070    5                  FMT_VEC ( FDS.NVECS# + 2 ) = VECTOR (NONE_STR);
     1368    16071    5                  LEN = 4;
     1369    16072    5                  END;   /*  Blank wsn  */
     1370    16073    5               ELSE DO;
     1371    16074    5                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( CON$DREC.OCINFO.WSN );
     1372    16075    5                  LEN = 8;
     1373    16076    5                  END;  /*  Non blank wsn  */
     1374    16077
     1375    16078    4            CASE (L_IN_DEV);
     1376    16079    5               IF IN$DEV.ISINFO.WSN = ' ' THEN DO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:186  
     1377    16080    5                  FMT_VEC ( FDS.NVECS# + 2 ) = VECTOR (NONE_STR);
     1378    16081    5                  LEN = 4;
     1379    16082    5                  END;   /*  Blank wsn  */
     1380    16083    5               ELSE DO;
     1381    16084    5                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( IN$DEV.ISINFO.WSN );
     1382    16085    5                  LEN = 8;
     1383    16086    5                  END;  /*  Non blank wsn  */
     1384    16087    4            END;
     1385    16088    3         CLASS = C_TEXT;
     1386    16089
     1387    16090    3      CASE (L_CD_SYS);
     1388    16091    3         MASK = K_SYS;
     1389    16092    3         CLASS = C_ATTRIBUTES;
     1390    16093    3         LEN = 7;
     1391    16094
     1392    16095    3      CASE (L_CD_ADMIN);
     1393    16096    3         MASK = K_ADMIN;
     1394    16097    3         CLASS = C_ATTRIBUTES;
     1395    16098    3         LEN = 7;
     1396    16099
     1397    16100    3      CASE (L_CD_COMM);
     1398    16101    3         MASK = K_COMM;
     1399    16102    3         CLASS = C_ATTRIBUTES;
     1400    16103    3         LEN = 7;
     1401    16104
     1402    16105    3      CASE (L_CD_DEV);
     1403    16106    3         MASK = K_DEVC;
     1404    16107    3         CLASS = C_ATTRIBUTES;
     1405    16108    3         LEN = 7;
     1406    16109
     1407    16110    3      CASE (L_CD_SLAVE);
     1408    16111    3         MASK = K_SLAVE;
     1409    16112    3         CLASS = C_ATTRIBUTES;
     1410    16113    3         LEN = 7;
     1411    16114
     1412    16115    3      CASE (L_CD_TP);
     1413    16116    3         MASK = K_TP;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:187  
     1414    16117    3         CLASS = C_ATTRIBUTES;
     1415    16118    3         LEN = 7;
     1416    16119
     1417    16120    3      CASE (L_CD_CMD);
     1418    16121    3         IF CMDCNT = 0 THEN
     1419    16122    4         DO;
     1420    16123    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( NONE_STR );
     1421    16124    4            LEN = 4;
     1422    16125    4            END;
     1423    16126    4         ELSE DO;
     1424    16127    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(CMD,0,CMDCNT) );
     1425    16128    4            LEN = CMDCNT;
     1426    16129    4            END;
     1427    16130    3         CLASS = C_TEXT;
     1428    16131
     1429    16132    3      CASE (L_CD_NATIVEL);
     1430    16133    4         IF CON$DREC.OCINFO.LANG = ' ' THEN DO;
     1431    16134    4            FMT_VEC (FDS.NVECS# + 2) = VECTOR (NONE_STR) ;
     1432    16135    4            LEN = 4;
     1433    16136    4            END;  /*  Blank  */
     1434    16137    4         ELSE DO;
     1435    16138    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( CON$DREC.OCINFO.LANG );
     1436    16139    4            LEN = 1;
     1437    16140    4            END;  /*  Not blank  */
     1438    16141    3         CLASS = C_TEXT;
     1439    16142
     1440    16143    3      CASE (L_CD_USE);
     1441    16144    4         DO CASE (L_TYPE);
     1442    16145    4            CASE (L_OUT_DEV);
     1443    16146    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( OUT_STR);
     1444    16147    4            CASE (L_IN_DEV);
     1445    16148    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( IN_STR);
     1446    16149    4            CASE (L_CG_DEV);
     1447    16150    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( CG_STR);
     1448    16151    4            CASE (L_TP_DEV);
     1449    16152    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( TP_STR);
     1450    16153    4            CASE (L_RES_DEV);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:188  
     1451    16154    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( RES_STR);
     1452    16155    4            END;
     1453    16156    3         CLASS = C_TEXT;
     1454    16157    3         LEN = 3;
     1455    16158
     1456    16159    3      CASE (L_CD_TYPE);
     1457    16160    3         IF DEV_NAME.COUNT = 8 THEN
     1458    16161    3            FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(DEV_NAME.TEXT,0,2) );
     1459    16162    3         ELSE
     1460    16163    3            FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(KL$DREC.RENAME,0,2) );
     1461    16164    3         CLASS = C_TEXT;
     1462    16165    3         LEN = 2;
     1463    16166
     1464    16167    3      CASE (L_CD_UPLOCK );
     1465    16168    3         YES_NO = OUT$DEV.OSINFO.UPLOCKED;
     1466    16169    3         CLASS = C_YESNO;
     1467    16170    3         LEN = 3;
     1468    16171
     1469    16172    3      CASE (L_CD_FORM);
     1470    16173    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( OUT$DEV.OSINFO.FNAME );
     1471    16174    3         CLASS = C_TEXT;
     1472    16175    3         LEN = SIZEC (OUT$DEV.OSINFO.FNAME);
     1473    16176
     1474    16177    3      CASE (L_CD_DEFPRIO);
     1475    16178    3         SBINS(SBIN_IDX + 1) = IN$DEV.ISINFO.DFPRI;
     1476    16179    3         CLASS = C_SBIN;
     1477    16180    3         LEN = 3;
     1478    16181
     1479    16182    3      CASE (L_CD_NCTL);
     1480    16183    3         YES_NO = IN$DEV.ISINFO.NCTL;
     1481    16184    3         CLASS = C_YESNO;
     1482    16185    3         LEN = 3;
     1483    16186
     1484    16187    3      CASE (L_CD_NCOK);
     1485    16188    3         YES_NO = IN$DEV.ISINFO.NCTLOK;
     1486    16189    3         CLASS = C_YESNO;
     1487    16190    3         LEN = 3;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:189  
     1488    16191
     1489    16192    3      CASE (L_CD_NCACCT);
     1490    16193    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( IN$DEV.ISINFO.NCACCT );
     1491    16194    3         CLASS = C_TEXT;
     1492    16195    3         LEN = 12;
     1493    16196
     1494    16197    3      CASE (L_CD_NCFID);
     1495    16198    3         CALL INDEX (LEN, AS_BLANK, IN$DEV.ISINFO.NFID);
     1496    16199    4         IF LEN = 0 THEN DO;
     1497    16200    4            FMT_VEC ( FDS.NVECS# + 2) = VECTOR (NONE_STR);
     1498    16201    4            LEN = 4;
     1499    16202    4            END;   /*  Blank fid  */
     1500    16203    3         ELSE
     1501    16204    3            FMT_VEC(FDS.NVECS# + 2) = VECTOR(SUBSTR(IN$DEV.ISINFO.NFID,0,LEN));
     1502    16205    3         CLASS = C_TEXT;
     1503    16206
     1504    16207    3      CASE ( L_CD_COMGROUP );
     1505    16208    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(CG,0,CGCNT) );
     1506    16209    3         CLASS = C_TEXT;
     1507    16210    3         LEN = CGCNT;
     1508    16211
     1509    16212    3      CASE (L_CD_SNAME);
     1510    16213    4         IF KL$DREC.RENAME = ' ' THEN DO;
     1511    16214    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( NONE_STR );
     1512    16215    4            LEN = SIZEC (NONE_STR);
     1513    16216    4            END;
     1514    16217    4         ELSE DO;
     1515    16218    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( KL$DREC.RENAME );
     1516    16219    4            LEN = SIZEC (KL$DREC.RENAME);
     1517    16220    4            END;
     1518    16221    3         CLASS = C_TEXT;
     1519    16222
     1520    16223    3      CASE (L_CD_NOCG);
     1521    16224    3         IF KL$DREC.FLAGS.NOCGREJ THEN
     1522    16225    4         DO;
     1523    16226    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( REJECT_STR );
     1524    16227    4            LEN = 6;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:190  
     1525    16228    4            END;
     1526    16229    3         ELSE
     1527    16230    3            IF KL$DREC.FLAGS.NOCGINF THEN
     1528    16231    4            DO;
     1529    16232    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( INFORM_STR );
     1530    16233    4               LEN = 6;
     1531    16234    4               END;
     1532    16235    4            ELSE DO;
     1533    16236    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( OK_STR );
     1534    16237    4               LEN = 2;
     1535    16238    4               END;
     1536    16239    3         CLASS = C_TEXT;
     1537    16240
     1538    16241    3      CASE (L_CD_USER1);
     1539    16242    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER1;
     1540    16243    3         CLASS = C_SBIN;
     1541    16244    3         LEN = 11;
     1542    16245
     1543    16246    3      CASE (L_CD_USER2);
     1544    16247    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER2;
     1545    16248    3         CLASS = C_SBIN;
     1546    16249    3         LEN = 11;
     1547    16250
     1548    16251    3      CASE (L_CD_USER3);
     1549    16252    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER3;
     1550    16253    3         CLASS = C_SBIN;
     1551    16254    3         LEN = 11;
     1552    16255
     1553    16256    3      CASE (L_CD_USER4);
     1554    16257    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER4;
     1555    16258    3         CLASS = C_SBIN;
     1556    16259    3         LEN = 11;
     1557    16260
     1558    16261    3      CASE (L_CD_INSTANCE);
     1559    16262    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(INSTANCE,0,INSTANCECNT) );
     1560    16263    3         CLASS = C_TEXT;
     1561    16264    3         LEN = INSTANCECNT;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:191  
     1562    16265
     1563    16266    3      CASE (L_CD_PRIORITY);
     1564    16267    3         SBINS(SBIN_IDX + 1) = TP$DEV.QQ$LOGON.PRIO;
     1565    16268    3         CLASS = C_SBIN;
     1566    16269    3         LEN = 3;
     1567    16270
     1568    16271    3      CASE (L_CD_MCT );
     1569    16272        /*  This chart will show the use and combination of these bits...
     1570    16273                     | mct | mctcmd | mctd |
     1571    16274              -------|-----|--------|------|
     1572    16275                 yes |  1  |   1    |  0   |
     1573    16276              -------|-----|--------|------|
     1574    16277                 no  |  0  |   0    |  0   |
     1575    16278              -------|-----|--------|------|
     1576    16279              command|  0  |   1    |  0   |
     1577    16280              -------|-----|--------|------|
     1578    16281              display|  0  |   0    |  1   |
     1579    16282              ------------------------------
     1580    16283        and that's that!!!
     1581    16284        */
     1582    16285
     1583    16286    3         IF TP$DEV.QQ$LOGON.MCT THEN
     1584    16287    4         DO;
     1585    16288    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( YES_STR );
     1586    16289    4            LEN = 3;
     1587    16290    4            END;
     1588    16291    3         ELSE IF TP$DEV.QQ$LOGON.MCTD THEN
     1589    16292    4            DO;
     1590    16293    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( DISPLAY_STR );
     1591    16294    4               LEN = 7;
     1592    16295    4               END;
     1593    16296    3            ELSE IF TP$DEV.QQ$LOGON.MCTCMD THEN
     1594    16297    4               DO;
     1595    16298    4                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( COMMANDS_STR );
     1596    16299    4                  LEN = 8;
     1597    16300    4                  END;
     1598    16301    4               ELSE DO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:192  
     1599    16302    4                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( NO_STR );
     1600    16303    4                  LEN = 2;
     1601    16304    4                  END;
     1602    16305    3         CLASS = C_TEXT;
     1603    16306
     1604    16307    3      CASE ( L_CD_MODE );
     1605    16308
     1606    16309    4         DO CASE (RESCL$DREC.CL_DEV.MODE);
     1607    16310
     1608    16311    4            CASE (%KL_DEVMODE_INCOMING#);
     1609    16312
     1610    16313    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (INCOMING_STR);
     1611    16314    4               LEN = LENGTHC (INCOMING_STR);
     1612    16315
     1613    16316    4            CASE (%KL_DEVMODE_OUTGOING#);
     1614    16317
     1615    16318    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (OUTGOING_STR);
     1616    16319    4               LEN = LENGTHC (OUTGOING_STR);
     1617    16320
     1618    16321    4            CASE (%KL_DEVMODE_FIXED#);
     1619    16322
     1620    16323    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (FIXED_STR);
     1621    16324    4               LEN = LENGTHC (FIXED_STR);
     1622    16325
     1623    16326    4            CASE (ELSE);
     1624    16327
     1625    16328    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (NONE_STR);
     1626    16329    4               LEN = LENGTHC (NONE_STR);
     1627    16330
     1628    16331    4            END; /*  Do case mode  */
     1629    16332
     1630    16333    3         CLASS = C_TEXT;
     1631    16334
     1632    16335    3      CASE ( L_CD_RNAME );
     1633    16336
     1634    16337    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR (RESCL$DREC.CL_DEV.RNAME);
     1635    16338    3         LEN = LENGTHC (RESCL$DREC.CL_DEV.RNAME);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:193  
     1636    16339    3         CLASS = C_TEXT;
     1637    16340
     1638    16341    3      CASE ( L_CD_AUACCT );
     1639    16342
     1640    16343    4         IF RESCL$DREC.CL_DEV.AUACCOUNT = ' ' THEN DO;
     1641    16344    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR ( NONE_STR );
     1642    16345    4            LEN = 4;
     1643    16346    4            END;  /*  Blank  */
     1644    16347    4         ELSE DO;
     1645    16348    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR (RESCL$DREC.CL_DEV.AUACCOUNT);
     1646    16349    4            LEN = LENGTHC (RESCL$DREC.CL_DEV.AUACCOUNT);
     1647    16350    4            END;  /*  Non blank  */
     1648    16351    3         CLASS = C_TEXT;
     1649    16352
     1650    16353    3      CASE ( L_CD_B300 );
     1651    16354
     1652    16355    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.B300#;
     1653    16356    3         GOTO CHECK_TCPIP_ATTR;
     1654    16357
     1655    16358    3      CASE ( L_CD_B1200 );
     1656    16359
     1657    16360    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.B1200#;
     1658    16361    3         GOTO CHECK_TCPIP_ATTR;
     1659    16362
     1660    16363    3      CASE ( L_CD_B2400 );
     1661    16364
     1662    16365    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.B2400#;
     1663    16366    3   CHECK_TCPIP_ATTR: ;
     1664    16367    3         IF RESCL$DREC.CL_DEV.ATTR.TCPIP# THEN
     1665    16368    3            NEXT = NEXT + L_CD_TCP_PRIV - L_CD_B300; /* Show tcpip names */
     1666    16369    3         CLASS = C_YESNO;
     1667    16370    3         LEN = 3;
     1668    16371
     1669    16372    3      CASE ( L_CD_HAYES );
     1670    16373
     1671    16374    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.HAYES#;
     1672    16375    3         CLASS = C_YESNO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:194  
     1673    16376    3         LEN = 3;
     1674    16377
     1675    16378    3      CASE ( L_CD_X28 );
     1676    16379
     1677    16380    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.X28#;
     1678    16381    3         CLASS = C_YESNO;
     1679    16382    3         LEN = 3;
     1680    16383
     1681    16384    3      CASE ( L_CD_RFU1 );
     1682    16385
     1683    16386    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU1#;
     1684    16387    3         CLASS = C_YESNO;
     1685    16388    3         LEN = 3;
     1686    16389
     1687    16390    3      CASE ( L_CD_RFU2 );
     1688    16391
     1689    16392    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU2#;
     1690    16393    3         CLASS = C_YESNO;
     1691    16394    3         LEN = 3;
     1692    16395
     1693    16396    3      CASE ( L_CD_RFU3 );
     1694    16397
     1695    16398    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU3#;
     1696    16399    3         CLASS = C_YESNO;
     1697    16400    3         LEN = 3;
     1698    16401
     1699    16402    3      CASE ( L_CD_RFU4 );
     1700    16403
     1701    16404    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU4#;
     1702    16405    3         CLASS = C_YESNO;
     1703    16406    3         LEN = 3;
     1704    16407
     1705    16408    3      CASE ( L_CD_RFU5 );
     1706    16409
     1707    16410    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU5#;
     1708    16411    3         CLASS = C_YESNO;
     1709    16412    3         LEN = 3;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:195  
     1710    16413
     1711    16414    3      CASE ( L_CD_RFU6 );
     1712    16415
     1713    16416    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU6#;
     1714    16417    3         CLASS = C_YESNO;
     1715    16418    3         LEN = 3;
     1716    16419
     1717    16420    3      CASE ( L_CD_RFU7 );
     1718    16421
     1719    16422    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU7#;
     1720    16423    3         CLASS = C_YESNO;
     1721    16424    3         LEN = 3;
     1722    16425
     1723    16426    3      CASE ( L_CD_RFU8 );
     1724    16427
     1725    16428    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU8#;
     1726    16429    3         CLASS = C_YESNO;
     1727    16430    3         LEN = 3;
     1728    16431
     1729    16432    3      CASE ( L_CD_RFU9 );
     1730    16433
     1731    16434    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU9#;
     1732    16435    3         CLASS = C_YESNO;
     1733    16436    3         LEN = 3;
     1734    16437
     1735    16438    3      CASE ( L_CD_RFU10 );
     1736    16439
     1737    16440    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU10#;
     1738    16441    3         CLASS = C_YESNO;
     1739    16442    3         LEN = 3;
     1740    16443
     1741    16444    3      CASE ( L_CD_RFU11 );
     1742    16445
     1743    16446    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU11#;
     1744    16447    3         CLASS = C_YESNO;
     1745    16448    3         LEN = 3;
     1746    16449
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:196  
     1747    16450    3      CASE ( L_CD_TCPIP );
     1748    16451
     1749    16452    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.TCPIP#;
     1750    16453    3         CLASS = C_YESNO;
     1751    16454    3         LEN = 3;
     1752    16455
     1753    16456    3      CASE ( L_CD_RFU13 );
     1754    16457
     1755    16458    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU13#;
     1756    16459    3         CLASS = C_YESNO;
     1757    16460    3         LEN = 3;
     1758    16461
     1759    16462    3      END;                           /* End case ... finally               */
     1760    16463    2   SBINS (SBIN_IDX) = LEN + SIZEC (OPT_TBL.HDR(NEXT));
     1761    16464    2   FMT_VEC (FDS.NVECS#) = VECTOR (SBINS(SBIN_IDX));
     1762    16465    2   FMT_VEC (FDS.NVECS#+1) = VECTOR (OPT_TBL.HDR(NEXT));
     1763    16466    2   FDS.NVECS# = FDS.NVECS# + 2;
     1764    16467    2   SBIN_IDX = SBIN_IDX + 1;
     1765    16468    2   SUBSTR (FMT_BUF, FDS.FMT_.BOUND+1,5) = '%NR%A';
     1766    16469    2   FDS.FMT_.BOUND = FDS.FMT_.BOUND + 5;
     1767    16470    3   DO SELECT (CLASS);
     1768    16471    3      SELECT (C_TEXT);
     1769    16472    3      FDS.NVECS# = FDS.NVECS# + 1;
     1770    16473    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%>A');
     1771    16474    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;
     1772    16475    3      SELECT (C_SBIN);
     1773    16476    3      FMT_VEC(FDS.NVECS#) = VECTOR(SBINS(SBIN_IDX));
     1774    16477    3      FDS.NVECS# = FDS.NVECS# + 1;
     1775    16478    3      SBIN_IDX = SBIN_IDX + 1;
     1776    16479    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%+D');
     1777    16480    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;
     1778    16481    3      SELECT (C_YESNO);
     1779    16482    3      IF YES_NO THEN
     1780    16483    3         FMT_VEC(FDS.NVECS#) = VECTOR(YES_STR);
     1781    16484    3      ELSE
     1782    16485    3         FMT_VEC(FDS.NVECS#) = VECTOR(NO_STR);
     1783    16486    3      FDS.NVECS# = FDS.NVECS# + 1;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:197  
     1784    16487    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%>A');
     1785    16488    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;
     1786    16489    3      SELECT (C_ATTRIBUTES);
     1787    16490    3      IF CON$DREC.OCINFO.KCADDR & MASK THEN
     1788    16491    3         IF CON$DREC.OCINFO.CADDR & MASK THEN
     1789    16492    3            FMT_VEC(FDS.NVECS#) = VECTOR( YES_STR );
     1790    16493    3         ELSE
     1791    16494    3            FMT_VEC(FDS.NVECS#) = VECTOR( KEYIN_STR );
     1792    16495    3      ELSE
     1793    16496    3         IF CON$DREC.OCINFO.CADDR & MASK THEN
     1794    16497    3            FMT_VEC(FDS.NVECS#) = VECTOR( DISPLAY_STR);
     1795    16498    3         ELSE
     1796    16499    3            FMT_VEC(FDS.NVECS#) = VECTOR( NO_STR );
     1797    16500    3      FDS.NVECS# = FDS.NVECS# + 1;
     1798    16501    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%>A');
     1799    16502    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;
     1800    16503    3      SELECT  (C_OCTAL);
     1801    16504    3      FDS.NVECS# = FDS.NVECS# + 2;
     1802    16505    3      SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,13) = 'O''%12ZO%12ZO''';
     1803    16506    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 13;
     1804    16507    3      END;                           /* End case                      */
     1805    16508    3   IF JCL THEN DO;
     1806    16509    3      SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,1) = ';';
     1807    16510    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 1;
     1808    16511    3      END;  /*  Jcl  */
     1809    16512    2   RETURN;
     1810    16513    2   END INSERT_FIELD;
     1811    16514    1   END ASL$DISP_ONE_DEVICE;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:198  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$INFO.:E05TOU  is referenced.
   FI_MAC_C.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_DEVICE.

   Procedure ASL$DISP_ONE_DEVICE requires 1796 words for executable code.
   Procedure ASL$DISP_ONE_DEVICE requires 170 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_DEVICES.:E05TSI    .

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:199  

 Object Unit name= ASL$DISP_ONE_DEVICE                        File name= ASL$LIST_DEVICES.:E05TOU
 UTS= JUL 29 '97 10:12:18.88 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2  RoData even  UTS    425    651  ASL$DISP_ONE_DEVICE
    3   Proc  even  none  1796   3404  ASL$DISP_ONE_DEVICE
    4  RoData even  none    78    116  ASL$DISP_ONE_DEVICE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        2  ASL$DISP_ONE_DEVICE

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       1 X$FORMAT
         yes           Std       3 ASA$ERROR
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:200  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     FDS                                   FMT_BUF                               FMT_VEC
     BLANK_PASS                            ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             DSEG3$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:201  


      874        1        /*T***********************************************************/
      875        2        /*T*                                                         */
      876        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      877        4        /*T*                                                         */
      878        5        /*T***********************************************************/
      879        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:202  
      880        7        /*M* ASL$DISP_ONE_DEVICE:  Routine to display one DEVICE. */
      881        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      882        9              ECU=3,CSU=3,SDI=3                                           */
      883       10        ASL$DISP_ONE_DEVICE: PROC (JCL, TERMINAL);

     10  3 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_2
         3 000001   000252 000002                    ZERO    170,2

      884       11
      885       12        /********************************************************************/
      886       13        /*   Include files   include files   include files   include files  */
      887       14        /********************************************************************/
      888       15        %INCLUDE AS_SUBS_C;
      889     1429        %INCLUDE AS_MAC_C;
      890     1509        %INCLUDE AS_SSUBS_C;
      891     1601        %INCLUDE AS_PERR_C;
      892     2203        %INCLUDE AS_ENTRIES_M;
      893     3253        %INCLUDE AS_SUPER_C;
      894     3688        %INCLUDE KC$CGBLK;
      895     3736        %INCLUDE QQ_SUPER_C;
      896     3791        %INCLUDE FOO_MAC_C;
      897     4539        %INCLUDE FI_MAC_C;
      898     4909        %INCLUDE OC$INFO;
      899     4965        %INCLUDE OCI_SUBS_C;
      900     5063        %INCLUDE CP_6;
      901     5144        %INCLUDE KL_SUPER_C;
      902     8046        %INCLUDE XU_MACRO_C;
      903    11152        %INCLUDE XU_FORMAT_C;
      904    11314        %INCLUDE AS_SUPER_R;
      905    14330        /********************************************************************/
      906    14331        /*   Parameters      parameters      parameters      parameters     */
      907    14332        /********************************************************************/
      908    14333    1   DCL JCL      BIT (1);
      909    14334    1   DCL TERMINAL BIT (1);
      910    14335        /********************************************************************/
      911    14336        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      912    14337        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:203  
      913    14338        %ASB$READ_HLP ;
      914    14341        %ASA$ERROR ;
      915    14344        %ASB$WRITE_LO ;
      916    14347    1   DCL X$FORMAT ENTRY(1);
      917    14348        /********************************************************************/
      918    14349        /*   Local based     local based     local based     local based    */
      919    14350        /********************************************************************/
      920    14351        %KL_DREC       ( NAME = KL$DREC, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      921    14464        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ";", STCLASS = BASED );
      922    14490        %KL_DREC       ( NAME = RES$DREC, LAST = ";", STCLASS = "BASED(DSEG3$)" );
      923    14603        %KL_DREC       ( NAME = RESCL$DREC, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      924    14716        %KL_RES_CL_DEV ( NAME = CL_DEV, LAST = ";", LVL = 2, STCLASS = BASED);
      925    14776        %KL_DREC       ( NAME = CON$DREC, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      926    14889        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      927    14915        %OC$INFO       ( FPTN = OCINFO, LVL = 2, LAST = ";", STCLASS = BASED );
      928    14952        %KL_DREC       ( NAME = IN$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      929    15065        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      930    15091        %FI_CONINFO    ( FPTN = ISINFO, LVL = 2, LAST = ";", STCLASS = BASED );
      931    15135        %KL_DREC       ( NAME = OUT$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      932    15248        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      933    15274        %FO_CONINFO    ( FPTN = OSINFO, LVL = 2, LAST = ";", STCLASS = BASED );
      934    15305        %KL_DREC       ( NAME = CG$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      935    15418        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      936    15444        %B$CGAUINFO    ( FPTN = B$CGAUINFO, LVL = 2, STCLASS = BASED );
      937    15464        %KL_DREC       ( NAME = TP$DEV, LAST = ",", STCLASS = "BASED(DSEG3$)" );
      938    15577        %KC$CGID       ( FPTN = KC$CGID, LVL = 2, LAST = ",", STCLASS = BASED );
      939    15603        %QQ$LOGON      ( FPTN = QQ$LOGON, LVL = 2, LAST = ";", STCLASS = BASED );
      940    15639        %KL_WSNDEV     ( NAME = DEVWSNS, STCLASS = "BASED (DSEG1$)");
      941    15644    1   DCL 1 TEXT$C BASED,
      942    15645    1          2 L UBIN BYTE UNAL,
      943    15646    1          2 C CHAR(TEXT$C.L) UNAL;
      944    15647    1   DCL OPT$ORDR(0:0) UBIN BYTE UNAL BASED(OPT_ORDR$);
      945    15648        /********************************************************************/
      946    15649        /*   Constant data   constant data   constant data   constant data  */
      947    15650        /********************************************************************/
      948    15651    1   DCL 1 OPT_TBL  CONSTANT,
      949    15652    1          2 HDR(0:70) CHAR(18) CALIGNED INIT(
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:204  
      950    15653    1             '   PROFILE =',
      951    15654    1             '   PASSWORD =',
      952    15655    1             '   MAXPRIO =',
      953    15656    1             '   WSN =',
      954    15657    1             '   SYSTEM =',
      955    15658    1             '   ADMIN =',
      956    15659    1             '   COMMUNICATION =',
      957    15660    1             '   DEVICE =',
      958    15661    1             '   SLAVE =',
      959    15662    1             '   CMD =',
      960    15663    1             '   USE =',
      961    15664    1             '   TYPE =',
      962    15665    1             '   UPLOCKED =',
      963    15666    1             '   FORM =',
      964    15667    1             '   DEFPRIO =',
      965    15668    1             '   NCTL =',
      966    15669    1             '   NCOK =',
      967    15670    1             '   NCACCT =',
      968    15671    1             '   NCFID =',
      969    15672    1             '   COMGROUP =',
      970    15673    1             '   SNAME =',
      971    15674    1             '   NOCG =',
      972    15675    1             '   USER1 =',
      973    15676    1             '   USER2 =',
      974    15677    1             '   USER3 =',
      975    15678    1             '   USER4 =',
      976    15679    1             '   INSTANCE =',
      977    15680    1             '   PRIORITY =',
      978    15681    1             '   MCT =',
      979    15682    1             '   NATIVEL =',
      980    15683    1             '   TP =',
      981    15684    1             '   MODE =',
      982    15685    1             '   RNAME =',
      983    15686    1             '   AUACCOUNT =',
      984    15687    1             '   B300 =',
      985    15688    1             '   B1200 =',
      986    15689    1             '   B2400 =',
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:205  
      987    15690    1             '   HAYES =',
      988    15691    1             '   X28 =',
      989    15692    1             '   RFU1 =',
      990    15693    1             '   RFU2 =',
      991    15694    1             '   RFU3 =',
      992    15695    1             '   RFU4 =',
      993    15696    1             '   RFU5 =',
      994    15697    1             '   RFU6 =',
      995    15698    1             '   RFU7 =',
      996    15699    1             '   RFU8 =',
      997    15700    1             '   RFU9 =',
      998    15701    1             '   RFU10 =',
      999    15702    1             '   RFU11 =',
     1000    15703    1             '   TCPIP =',
     1001    15704    1             '   RFU13 =',
     1002    15705    1             '   PRIVILEGED =',
     1003    15706    1             '   TCP =',
     1004    15707    1             '   IP =',
     1005    15708    1             ' '*0),
     1006    15709    1          2 CON_ORDR(0:11) UBIN BYTE CALIGNED INIT(
     1007    15710    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_MAXPRIO, L_CD_WSN, L_CD_NATIVEL,
     1008    15711    1             L_CD_SYS, L_CD_ADMIN, L_CD_COMM, L_CD_DEV, L_CD_SLAVE,
     1009    15712    1             L_CD_TP, L_CD_CMD ),
     1010    15713    1          2 OUT_ORDR(0:5) UBIN BYTE CALIGNED INIT(
     1011    15714    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_TYPE, L_CD_FORM,
     1012    15715    1             L_CD_UPLOCK ),
     1013    15716    1          2 IN_ORDR(0:10) UBIN BYTE CALIGNED INIT(
     1014    15717    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_TYPE, L_CD_WSN,
     1015    15718    1             L_CD_DEFPRIO, L_CD_MAXPRIO, L_CD_NCTL, L_CD_NCOK, L_CD_NCACCT,
     1016    15719    1             L_CD_NCFID ),
     1017    15720    1          2 CG_ORDR(0:10) UBIN BYTE CALIGNED INIT(
     1018    15721    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_SNAME, L_CD_NOCG,
     1019    15722    1             L_CD_USER1, L_CD_USER2, L_CD_USER3, L_CD_USER4,L_CD_COMGROUP,
     1020    15723    1             L_CD_CMD ),
     1021    15724    1          2 TP_ORDR(0:8) UBIN BYTE CALIGNED INIT(
     1022    15725    1             L_CD_PROFILE, L_CD_PASSWORD, L_CD_USE, L_CD_INSTANCE, L_CD_SNAME,
     1023    15726    1             L_CD_PRIORITY, L_CD_MCT, L_CD_NOCG, L_CD_CMD ),
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:206  
     1024    15727    1          2 RES_CL_ORDR(0:24) UBIN BYTE CALIGNED INIT(
     1025    15728    1             L_CD_USE, L_CD_TYPE, L_CD_PROFILE, L_CD_PASSWORD,
     1026    15729    1             L_CD_MODE, L_CD_RNAME, L_CD_AUACCT, L_CD_HAYES, L_CD_X28, L_CD_TCPIP,
     1027    15730    1             L_CD_B300, L_CD_B1200, L_CD_B2400, L_CD_RFU1, L_CD_RFU2,
     1028    15731    1             L_CD_RFU3, L_CD_RFU4, L_CD_RFU5, L_CD_RFU6, L_CD_RFU7,
     1029    15732    1             L_CD_RFU8, L_CD_RFU9, L_CD_RFU10, L_CD_RFU11, L_CD_RFU13 ),
     1030    15733    1          2 RES_ORDR(0:3) UBIN BYTE CALIGNED INIT(
     1031    15734    1             L_CD_USE, L_CD_TYPE, L_CD_PROFILE, L_CD_PASSWORD );
     1032    15735    1   DCL CG_STR         CHAR(0) CONSTANT INIT('CG');
     1033    15736    1   DCL COMMANDS_STR   CHAR(0) CONSTANT INIT('COMMANDS');
     1034    15737    1   DCL CONSOLE_STR    CHAR(0) CONSTANT INIT('CONSOLE');
     1035    15738    1   DCL DEVICE_STR     CHAR(0) CONSTANT INIT('DEVICE');
     1036    15739    1   DCL DEVWSNS_HDR    CHAR(0) CONSTANT INIT (
             15739            'The WSNs associated with this device are:');
     1037    15740    1   DCL DISPLAY_STR    CHAR(0) CONSTANT INIT('DISPLAY');
     1038    15741    1   DCL FIXED_STR      CHAR(0) CONSTANT INIT('FIXED');
     1039    15742    1   DCL INCOMING_STR   CHAR(0) CONSTANT INIT('INCOMING ');
     1040    15743    1   DCL INFORM_STR     CHAR(0) CONSTANT INIT('INFORM');
     1041    15744    1   DCL IN_STR         CHAR(0) CONSTANT INIT('IN');
     1042    15745    1   DCL KEYIN_STR      CHAR(0) CONSTANT INIT('KEYIN');
     1043    15746    1   DCL LINK_STR       CHAR(0) CONSTANT INIT(' FOR LINK ');
     1044    15747    1   DCL NONE_STR       CHAR(0) CONSTANT INIT('NONE');
     1045    15748    1   DCL NO_STR         CHAR(0) CONSTANT INIT('NO');
     1046    15749    1   DCL OK_STR         CHAR(0) CONSTANT INIT('OK');
     1047    15750    1   DCL OUTGOING_STR   CHAR(0) CONSTANT INIT('OUTGOING');
     1048    15751    1   DCL OUT_STR        CHAR(0) CONSTANT INIT('OUT');
     1049    15752    1   DCL REJECT_STR     CHAR(0) CONSTANT INIT('REJECT');
     1050    15753    1   DCL RES_STR        CHAR(0) CONSTANT INIT('RESOURCE');
     1051    15754    1   DCL STATION_STR    CHAR(0) CONSTANT INIT(' FOR STATION ');
     1052    15755    1   DCL TERMINAL_STR   CHAR(0) CONSTANT INIT(' FOR TERMINAL ');
     1053    15756    1   DCL TP_STR         CHAR(0) CONSTANT INIT('TP');
     1054    15757    1   DCL YES_STR        CHAR(0) CONSTANT INIT('YES');
     1055    15758        /********************************************************************/
     1056    15759        /*   Auto data       auto data       auto data       auto data      */
     1057    15760        /********************************************************************/
     1058    15761    1   DCL CG                            CHAR(32);
     1059    15762    1   DCL CGCNT                         UBIN;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:207  
     1060    15763    1   DCL CMD                           CHAR(80);
     1061    15764    1   DCL CMDCNT                        UBIN;
     1062    15765    1   DCL 1 DEV_NAME,
     1063    15766    1          2 COUNT                    UBIN BYTE CALIGNED,
     1064    15767    1          2 TEXT                     CHAR(8) CALIGNED,
     1065    15768    1          2 UNAME                    CHAR(12) CALIGNED,
     1066    15769    1          2 *                        CHAR(21) CALIGNED;
     1067    15770    1   DCL I                             SBIN;
     1068    15771    1   DCL INSTANCE                      CHAR(18);
     1069    15772    1   DCL INSTANCECNT                   UBIN;
     1070    15773    1   DCL LEN                           SBIN;
     1071    15774    1   DCL L_TYPE                        UBIN;
     1072    15775    1   DCL MASK                          BIT(18);
     1073    15776    1   DCL NEXT                          SBIN;
     1074    15777    1   DCL NUM_OPTS                      UBIN;
     1075    15778    1   DCL OPT_ORDR$                     PTR;
     1076    15779    1   DCL SBINS   (0:99)                SBIN;
     1077    15780    1   DCL SBIN_IDX                      SBIN;
     1078    15781    1   DCL ST_IDX                        SBIN;
     1079    15782    1   DCL T_SNAME                       CHAR(8) ;
     1080    15783        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:208  
     1081    15784        /********************************************************************/
     1082    15785        /*   Procedure       procedure       procedure       procedure      */
     1083    15786        /********************************************************************/
     1084    15787
     1085    15788    1   IF (KL$DREC.ATYP = 0) THEN RETURN; /* This stops the listing of wsndev

  15788  3 000002   000000 470400 xsym               LDP0    DSEG3$
         3 000003   000000 236100                    LDQ     0,,PR0
         3 000004   777000 316003                    CANQ    -512,DU
         3 000005   000007 601000 3                  TNZ     s:15790

  15788  3 000006   000000 702200 xent               TSX2  ! X66_ARET

     1086    15789                                               records */
     1087    15790    2   DO SELECT ( KL$DREC.SUPER );

  15790  3 000007   000000 236100                    LDQ     0,,PR0
         3 000010   000777 376007                    ANQ     511,DL
         3 000011   000006 116007                    CMPQ    6,DL
         3 000012   000025 602000 3                  TNC     s:15790+14
         3 000013   000043 600000 3                  TZE     s:15796
         3 000014   000013 116007                    CMPQ    11,DL
         3 000015   000022 602000 3                  TNC     s:15790+11
         3 000016   000052 600000 3                  TZE     s:15800
         3 000017   000014 116007                    CMPQ    12,DL
         3 000020   000115 601000 3                  TNZ     s:15823
         3 000021   000076 710000 3                  TRA     s:15812
         3 000022   000007 116007                    CMPQ    7,DL
         3 000023   000115 601000 3                  TNZ     s:15823
         3 000024   000061 710000 3                  TRA     s:15804
         3 000025   000005 116007                    CMPQ    5,DL
         3 000026   000031 602000 3                  TNC     s:15790+18
         3 000027   000034 600000 3                  TZE     s:15792
         3 000030   000115 710000 3                  TRA     s:15823
         3 000031   000004 116007                    CMPQ    4,DL
         3 000032   000115 601000 3                  TNZ     s:15823
         3 000033   000070 710000 3                  TRA     s:15808
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:209  

     1088    15791    2      SELECT ( AS_IN_DEV# );

     1089    15792    2      L_TYPE = L_IN_DEV;

  15792  3 000034   000002 235007                    LDA     2,DL
         3 000035   200066 755100                    STA     L_TYPE,,AUTO

     1090    15793    2      OPT_ORDR$ = ADDR(OPT_TBL.IN_ORDR);

  15793  3 000036   000000 236000 4                  LDQ     0
         3 000037   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1091    15794    2      NUM_OPTS  = LENGTHC(OPT_TBL.IN_ORDR);

  15794  3 000040   000013 235007                    LDA     11,DL
         3 000041   200071 755100                    STA     NUM_OPTS,,AUTO
         3 000042   000116 710000 3                  TRA     s:15825

     1092    15795    2      SELECT ( AS_OUT_DEV# );

     1093    15796    2      L_TYPE = L_OUT_DEV;

  15796  3 000043   000001 235007                    LDA     1,DL
         3 000044   200066 755100                    STA     L_TYPE,,AUTO

     1094    15797    2      OPT_ORDR$ = ADDR(OPT_TBL.OUT_ORDR);

  15797  3 000045   000001 236000 4                  LDQ     1
         3 000046   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1095    15798    2      NUM_OPTS  = LENGTHC(OPT_TBL.OUT_ORDR);

  15798  3 000047   000006 235007                    LDA     6,DL
         3 000050   200071 755100                    STA     NUM_OPTS,,AUTO
         3 000051   000116 710000 3                  TRA     s:15825

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:210  
     1096    15799    2      SELECT ( AS_CG_DEV# );

     1097    15800    2      L_TYPE = L_CG_DEV;

  15800  3 000052   000003 235007                    LDA     3,DL
         3 000053   200066 755100                    STA     L_TYPE,,AUTO

     1098    15801    2      OPT_ORDR$ = ADDR(OPT_TBL.CG_ORDR);

  15801  3 000054   000002 236000 4                  LDQ     2
         3 000055   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1099    15802    2      NUM_OPTS  = LENGTHC(OPT_TBL.CG_ORDR);

  15802  3 000056   000013 235007                    LDA     11,DL
         3 000057   200071 755100                    STA     NUM_OPTS,,AUTO
         3 000060   000116 710000 3                  TRA     s:15825

     1100    15803    2      SELECT ( AS_TP_DEV# );

     1101    15804    2      L_TYPE = L_TP_DEV;

  15804  3 000061   000004 235007                    LDA     4,DL
         3 000062   200066 755100                    STA     L_TYPE,,AUTO

     1102    15805    2      OPT_ORDR$ = ADDR(OPT_TBL.TP_ORDR);

  15805  3 000063   000003 236000 4                  LDQ     3
         3 000064   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1103    15806    2      NUM_OPTS  = LENGTHC(OPT_TBL.TP_ORDR);

  15806  3 000065   000011 235007                    LDA     9,DL
         3 000066   200071 755100                    STA     NUM_OPTS,,AUTO
         3 000067   000116 710000 3                  TRA     s:15825

     1104    15807    2      SELECT ( AS_CON# );
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:211  

     1105    15808    2      L_TYPE = L_CONSOLE;

  15808  3 000070   200066 450100                    STZ     L_TYPE,,AUTO

     1106    15809    2      OPT_ORDR$ = ADDR(OPT_TBL.CON_ORDR);

  15809  3 000071   000004 236000 4                  LDQ     4
         3 000072   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1107    15810    2      NUM_OPTS  = LENGTHC(OPT_TBL.CON_ORDR);

  15810  3 000073   000014 235007                    LDA     12,DL
         3 000074   200071 755100                    STA     NUM_OPTS,,AUTO
         3 000075   000116 710000 3                  TRA     s:15825

     1108    15811    2      SELECT ( AS_RES_DEV# );

     1109    15812    2      L_TYPE = L_RES_DEV;

  15812  3 000076   000006 235007                    LDA     6,DL
         3 000077   200066 755100                    STA     L_TYPE,,AUTO

     1110    15813    3      IF SUBSTR (RESCL$DREC.RENAME,0,2) = 'CL' THEN DO;

  15813  3 000100   000011 220100                    LDX0    9,,PR0
         3 000101   000610 100000 2                  CMPX0   YES_STR+1
         3 000102   000110 601000 3                  TNZ     s:15818

     1111    15814    3         OPT_ORDR$ = ADDR(OPT_TBL.RES_CL_ORDR);

  15814  3 000103   000005 236000 4                  LDQ     5
         3 000104   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1112    15815    3         NUM_OPTS  = LENGTHC(OPT_TBL.RES_CL_ORDR);

  15815  3 000105   000031 235007                    LDA     25,DL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:212  
         3 000106   200071 755100                    STA     NUM_OPTS,,AUTO

     1113    15816    3         END;   /*  Type = cl  */

  15816  3 000107   000116 710000 3                  TRA     s:15825

     1114    15817    3      ELSE DO;

     1115    15818    3         OPT_ORDR$ = ADDR(OPT_TBL.RES_ORDR);

  15818  3 000110   000006 236000 4                  LDQ     6
         3 000111   200072 756100                    STQ     OPT_ORDR$,,AUTO

     1116    15819    3         NUM_OPTS  = LENGTHC(OPT_TBL.RES_ORDR);

  15819  3 000112   000004 235007                    LDA     4,DL
         3 000113   200071 755100                    STA     NUM_OPTS,,AUTO

     1117    15820    3         END;   /*  Not type = cl  */

  15820  3 000114   000116 710000 3                  TRA     s:15825

     1118    15821
     1119    15822    2      SELECT ( ELSE );

     1120    15823    2   RETURN;

  15823  3 000115   000000 702200 xent               TSX2  ! X66_ARET

     1121    15824    2      END;

     1122    15825    1   DEV_NAME = USERS_KEY;

  15825  3 000116   000100 100400                    MLR     fill='000'O
         3 000117   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42
         3 000120   200043 000052                    ADSC9   DEV_NAME,,AUTO           cn=0,n=42

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:213  
     1123    15826    2   DO SELECT ( L_TYPE );

  15826  3 000121   200066 235100                    LDA     L_TYPE,,AUTO
         3 000122   000124 600000 3                  TZE     s:15828
         3 000123   000130 710000 3                  TRA     s:15830

     1124    15827    2      SELECT ( L_CONSOLE );

     1125    15828    2      FMT_VEC(0) = VECTOR(CONSOLE_STR);

  15828  3 000124   000010 237000 4                  LDAQ    8
         3 000125   000000 755000 xsym               STA     FMT_VEC
         3 000126   000001 756000 xsym               STQ     FMT_VEC+1
         3 000127   000133 710000 3                  TRA     s:15832

     1126    15829    2      SELECT ( ELSE );

     1127    15830    2   FMT_VEC(0) = VECTOR(DEVICE_STR);

  15830  3 000130   000012 237000 4                  LDAQ    10
         3 000131   000000 755000 xsym               STA     FMT_VEC
         3 000132   000001 756000 xsym               STQ     FMT_VEC+1

     1128    15831    2      END;  /*  Case L_TYPE  */

     1129    15832    2   IF DEV_NAME.COUNT = 8 THEN DO;

  15832  3 000133   200043 236100                    LDQ     DEV_NAME,,AUTO
         3 000134   777000 376003                    ANQ     -512,DU
         3 000135   010000 116003                    CMPQ    4096,DU
         3 000136   000142 601000 3                  TNZ     s:15836

     1130    15833    2      LEN = 4;

  15833  3 000137   000004 235007                    LDA     4,DL
         3 000140   200065 755100                    STA     LEN,,AUTO

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:214  
     1131    15834    2      END;  /*  Count = 8  */

  15834  3 000141   000144 710000 3                  TRA     s:15838

     1132    15835    2   ELSE DO;

     1133    15836    2      LEN = 8;

  15836  3 000142   000010 235007                    LDA     8,DL
         3 000143   200065 755100                    STA     LEN,,AUTO

     1134    15837    2      END; /*  If count ~= 8  */

     1135    15838    2   IF NOT TERMINAL THEN DO;

  15838  3 000144   200004 471500                    LDP1    @TERMINAL,,AUTO
         3 000145   000000 066500                    CMPB    filb='0'B
         3 000146   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         3 000147   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000150   000252 601000 3                  TNZ     s:15861

     1136    15839    2      FMT_VEC(1) = VECTOR( SUBSTR(DEV_NAME.TEXT,0,LEN) );

  15839  3 000151   000020 735000                    ALS     16
         3 000152   000140 135007                    SBLA    96,DL
         3 000153   200250 452500                    STP2    YES_NO+2,,AUTO
         3 000154   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 000155   000014 036000 4                  ADLQ    12
         3 000156   000002 755000 xsym               STA     FMT_VEC+2
         3 000157   000003 756000 xsym               STQ     FMT_VEC+3

     1137    15840    2      FDS.NVECS# = 2;

  15840  3 000160   000002 235007                    LDA     2,DL
         3 000161   000011 755000 xsym               STA     FDS+9

     1138    15841    3      IF JCL THEN DO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:215  

  15841  3 000162   200003 473500                    LDP3    @JCL,,AUTO
         3 000163   000000 066500                    CMPB    filb='0'B
         3 000164   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         3 000165   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000166   000177 600000 3                  TZE     s:15846

     1139    15842    3         FMT_BUF = 'CREATE ';

  15842  3 000167   040000 100400                    MLR     fill='040'O
         3 000170   000611 000007 2                  ADSC9   YES_STR+2                cn=0,n=7
         3 000171   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1140    15843    3         FDS.FMT_.BOUND = 6;

  15843  3 000172   000000 236000 xsym               LDQ     FDS
         3 000173   177777 376007                    ANQ     65535,DL
         3 000174   000015 276000 4                  ORQ     13
         3 000175   000000 756000 xsym               STQ     FDS

     1141    15844    3         END;   /*  Jcl  */

  15844  3 000176   000204 710000 3                  TRA     s:15849

     1142    15845    3      ELSE DO;

     1143    15846    3         FMT_BUF = ' ';

  15846  3 000177   040000 100400                    MLR     fill='040'O
         3 000200   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000201   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1144    15847    3         FDS.FMT_.BOUND = 0;

  15847  3 000202   177777 236007                    LDQ     65535,DL
         3 000203   000000 356000 xsym               ANSQ    FDS

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:216  
     1145    15848    3         END;  /*   Not jcl  */

     1146    15849    3      IF L_TYPE = L_TP_DEV AND DEV_NAME.UNAME ~= '*' THEN DO;

  15849  3 000204   200066 236100                    LDQ     L_TYPE,,AUTO
         3 000205   000004 116007                    CMPQ    4,DL
         3 000206   000237 601000 3                  TNZ     s:15856
         3 000207   040000 106500                    CMPC    fill='040'O
         3 000210   200045 200014                    ADSC9   DEV_NAME+2,,AUTO         cn=1,n=12
         3 000211   000016 000001 4                  ADSC9   14                       cn=0,n=1
         3 000212   000237 600000 3                  TZE     s:15856

     1147    15850    3         SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,13) = 'TP %A %>A,%>A';

  15850  3 000213   000000 236000 xsym               LDQ     FDS
         3 000214   000020 772000                    QRL     16
         3 000215   040006 100400                    MLR     fill='040'O
         3 000216   000613 000015 2                  ADSC9   YES_STR+4                cn=0,n=13
         3 000217   000000 200015 xsym               ADSC9   FMT_BUF,Q                cn=1,n=13

     1148    15851    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + 13;

  15851  3 000220   000015 036007                    ADLQ    13,DL
         3 000221   000020 736000                    QLS     16
         3 000222   000000 676000 xsym               ERQ     FDS
         3 000223   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000224   000000 656000 xsym               ERSQ    FDS

     1149    15852    3         FMT_VEC (FDS.NVECS#) = VECTOR (DEV_NAME.UNAME);

  15852  3 000225   000001 735000                    ALS     1
         3 000226   000000 620005                    EAX0    0,AL
         3 000227   000017 235000 4                  LDA     15
         3 000230   200250 452500                    STP2    YES_NO+2,,AUTO
         3 000231   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 000232   000020 036000 4                  ADLQ    16
         3 000233   000000 755010 xsym               STA     FMT_VEC,X0
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:217  
         3 000234   000001 756010 xsym               STQ     FMT_VEC+1,X0

     1150    15853    3         FDS.NVECS# = FDS.NVECS# + 1;

  15853  3 000235   000011 054000 xsym               AOS     FDS+9

     1151    15854    3         END;   /*  Tp dev with a uname  */

  15854  3 000236   000263 710000 3                  TRA     s:15865

     1152    15855    3      ELSE DO;

     1153    15856    3         SUBSTR (FMT_BUF, FDS.FMT_.BOUND+1, 6) = '%A %>A';

  15856  3 000237   000000 236000 xsym               LDQ     FDS
         3 000240   000020 772000                    QRL     16
         3 000241   040006 100400                    MLR     fill='040'O
         3 000242   000617 000006 2                  ADSC9   YES_STR+8                cn=0,n=6
         3 000243   000000 200006 xsym               ADSC9   FMT_BUF,Q                cn=1,n=6

     1154    15857    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + 6;

  15857  3 000244   000006 036007                    ADLQ    6,DL
         3 000245   000020 736000                    QLS     16
         3 000246   000000 676000 xsym               ERQ     FDS
         3 000247   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000250   000000 656000 xsym               ERSQ    FDS

     1155    15858    3         END;  /*  Not tp  */

     1156    15859    2      END;   /*  Not terminal  */

  15859  3 000251   000263 710000 3                  TRA     s:15865

     1157    15860    2   ELSE DO;

     1158    15861    2      FDS.NVECS# = 1;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:218  

  15861  3 000252   000001 235007                    LDA     1,DL
         3 000253   000011 755000 xsym               STA     FDS+9

     1159    15862    2      FMT_BUF = '%A';

  15862  3 000254   040000 100400                    MLR     fill='040'O
         3 000255   000617 000002 2                  ADSC9   YES_STR+8                cn=0,n=2
         3 000256   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1160    15863    2      FDS.FMT_.BOUND = 1;

  15863  3 000257   000000 236000 xsym               LDQ     FDS
         3 000260   177777 376007                    ANQ     65535,DL
         3 000261   200000 276007                    ORQ     65536,DL
         3 000262   000000 756000 xsym               STQ     FDS

     1161    15864    2      END;  /*  Terminal  */

     1162    15865    2   IF NOT TERMINAL THEN DO;

  15865  3 000263   000000 066500                    CMPB    filb='0'B
         3 000264   100000 000001                    BDSC    0,,PR1                   by=0,bit=0,n=1
         3 000265   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000266   000502 601000 3                  TNZ     NO_STATION

     1163    15866    2      IF ((L_TYPE = L_CG_DEV) OR (L_TYPE = L_TP_DEV)) AND DEV_NAME.COUNT ~= 8 THEN

  15866  3 000267   200066 235100                    LDA     L_TYPE,,AUTO
         3 000270   000003 115007                    CMPA    3,DL
         3 000271   000274 600000 3                  TZE     s:15866+5
         3 000272   000004 115007                    CMPA    4,DL
         3 000273   000300 601000 3                  TNZ     s:15868
         3 000274   200043 236100                    LDQ     DEV_NAME,,AUTO
         3 000275   777000 376003                    ANQ     -512,DU
         3 000276   010000 116003                    CMPQ    4096,DU
         3 000277   000502 601000 3                  TNZ     NO_STATION
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:219  

     1164    15867    2         GOTO NO_STATION;
     1165    15868    2      IF KL$DREC.TNAME = ' '

  15868  3 000300   040000 106500                    CMPC    fill='040'O
         3 000301   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         3 000302   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000303   000320 601000 3                  TNZ     s:15876

     1166    15869                                           /*  Is it a tdev??  */
     1167    15870    3      THEN DO;

     1168    15871    3         USERS_KEY.COUNT = 15;

  15871  3 000304   017000 236003                    LDQ     7680,DU
         3 000305   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1169    15872    3         T_SNAME = KL$DREC.SNAME ;

  15872  3 000306   040100 100500                    MLR     fill='040'O
         3 000307   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8
         3 000310   200241 000010                    ADSC9   T_SNAME,,AUTO            cn=0,n=8

     1170    15873    3         CALL CONCAT( USERS_KEY.TXTC, T_SNAME, 'STATION' );

  15873  3 000311   040000 100500                    MLR     fill='040'O
         3 000312   200241 000010                    ADSC9   T_SNAME,,AUTO            cn=0,n=8
         3 000313   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 000314   040000 100400                    MLR     fill='040'O
         3 000315   000621 000007 2                  ADSC9   YES_STR+10               cn=0,n=7
         3 000316   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

     1171    15874    3         END; /* Then do */

  15874  3 000317   000347 710000 3                  TRA     s:15888

     1172    15875    3      ELSE DO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:220  

     1173    15876    4         IF JCL THEN DO;

  15876  3 000320   200003 473500                    LDP3    @JCL,,AUTO
         3 000321   000000 066500                    CMPB    filb='0'B
         3 000322   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         3 000323   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000324   000334 600000 3                  TZE     s:15883

     1174    15877    4            FMT_BUF = ' ';

  15877  3 000325   040000 100400                    MLR     fill='040'O
         3 000326   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 000327   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1175    15878    4            FDS.FMT_.BOUND = 0;

  15878  3 000330   177777 236007                    LDQ     65535,DL
         3 000331   000000 356000 xsym               ANSQ    FDS

     1176    15879    4            FDS.NVECS# = 0;

  15879  3 000332   000011 450000 xsym               STZ     FDS+9

     1177    15880    4            RETURN;

  15880  3 000333   000000 702200 xent               TSX2  ! X66_ARET

     1178    15881    4            END;   /*  Jcl  */
     1179    15882    4         ELSE DO;

     1180    15883    4            USERS_KEY.COUNT = 9;

  15883  3 000334   011000 236003                    LDQ     4608,DU
         3 000335   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1181    15884    4            T_SNAME = KL$DREC.TNAME ;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:221  

  15884  3 000336   040100 100500                    MLR     fill='040'O
         3 000337   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         3 000340   200241 000010                    ADSC9   T_SNAME,,AUTO            cn=0,n=8

     1182    15885    4            CALL CONCAT( USERS_KEY.TXTC, T_SNAME, '*' );

  15885  3 000341   040000 100500                    MLR     fill='040'O
         3 000342   200241 000010                    ADSC9   T_SNAME,,AUTO            cn=0,n=8
         3 000343   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 000344   040000 100400                    MLR     fill='040'O
         3 000345   000016 000001 4                  ADSC9   14                       cn=0,n=1
         3 000346   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

     1183    15886    4            END;  /*  Else do  */

     1184    15887    3         END; /* Else do */

     1185    15888    2      I = DSEG1SIZE;

  15888  3 000347   000000 235000 xsym               LDA     DSEG1SIZE
         3 000350   200056 755100                    STA     I,,AUTO

     1186    15889    2      CALL ASB$READ_HLP( DSEG1$, I ) WHENALTRETURN

  15889  3 000351   200056 630500                    EPPR0   I,,AUTO
         3 000352   200251 450500                    STP0    YES_NO+3,,AUTO
         3 000353   000021 236000 4                  LDQ     17
         3 000354   200250 756100                    STQ     YES_NO+2,,AUTO
         3 000355   200250 630500                    EPPR0   YES_NO+2,,AUTO
         3 000356   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000357   000000 701000 xent               TSX1    ASB$READ_HLP
         3 000360   000362 702000 3                  TSX2    s:15891
         3 000361   000367 710000 3                  TRA     s:15894

     1187    15890    3      DO ;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:222  
     1188    15891    3         CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15891  3 000362   000023 630400 4                  EPPR0   19
         3 000363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000364   000000 701000 xent               TSX1    ASA$ERROR
         3 000365   000000 011000                    NOP     0

     1189    15892    3         RETURN;

  15892  3 000366   000000 702200 xent               TSX2  ! X66_ARET

     1190    15893    3         END;  /*  Whenaltreturn  */
     1191    15894    2      IF DSEG1$->KL$DREC.ATYP = %KLAT_STA# THEN

  15894  3 000367   000000 470400 xsym               LDP0    DSEG1$
         3 000370   000000 236100                    LDQ     0,,PR0
         3 000371   777000 316003                    CANQ    -512,DU
         3 000372   000403 601000 3                  TNZ     s:15897

     1192    15895    2         FMT_VEC(FDS.NVECS#) = VECTOR(STATION_STR);

  15895  3 000373   000011 235000 xsym               LDA     FDS+9
         3 000374   000001 735000                    ALS     1
         3 000375   000000 620005                    EAX0    0,AL
         3 000376   000000 621005                    EAX1    0,AL
         3 000377   000026 237000 4                  LDAQ    22
         3 000400   000000 755010 xsym               STA     FMT_VEC,X0
         3 000401   000001 756011 xsym               STQ     FMT_VEC+1,X1
         3 000402   000416 710000 3                  TRA     s:15899

     1193    15896    2      ELSE
     1194    15897    2         IF DSEG1$->KL$DREC.ATYP = %KLAT_TRM# THEN

  15897  3 000403   000000 236100                    LDQ     0,,PR0
         3 000404   777000 376003                    ANQ     -512,DU
         3 000405   004000 116003                    CMPQ    2048,DU
         3 000406   000416 601000 3                  TNZ     s:15899
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:223  

     1195    15898    2            FMT_VEC(FDS.NVECS#) = VECTOR(TERMINAL_STR);

  15898  3 000407   000011 235000 xsym               LDA     FDS+9
         3 000410   000001 735000                    ALS     1
         3 000411   000000 620005                    EAX0    0,AL
         3 000412   000000 621005                    EAX1    0,AL
         3 000413   000030 237000 4                  LDAQ    24
         3 000414   000000 755010 xsym               STA     FMT_VEC,X0
         3 000415   000001 756011 xsym               STQ     FMT_VEC+1,X1

     1196    15899    2      FDS.NVECS# = FDS.NVECS# + 1;

  15899  3 000416   000011 054000 xsym               AOS     FDS+9

     1197    15900    2      FMT_VEC(FDS.NVECS#) = VECTOR(T_SNAME);

  15900  3 000417   000011 235000 xsym               LDA     FDS+9
         3 000420   000001 735000                    ALS     1
         3 000421   000000 620005                    EAX0    0,AL
         3 000422   000032 235000 4                  LDA     26
         3 000423   200250 452500                    STP2    YES_NO+2,,AUTO
         3 000424   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 000425   000241 036003                    ADLQ    161,DU
         3 000426   000000 755010 xsym               STA     FMT_VEC,X0
         3 000427   000001 756010 xsym               STQ     FMT_VEC+1,X0

     1198    15901    2      FDS.NVECS# = FDS.NVECS# + 1;

  15901  3 000430   000011 054000 xsym               AOS     FDS+9

     1199    15902    2      SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,5) = '%A%>A';

  15902  3 000431   000000 236000 xsym               LDQ     FDS
         3 000432   000020 772000                    QRL     16
         3 000433   040006 100400                    MLR     fill='040'O
         3 000434   000623 000005 2                  ADSC9   YES_STR+12               cn=0,n=5
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:224  
         3 000435   000000 200005 xsym               ADSC9   FMT_BUF,Q                cn=1,n=5

     1200    15903    2      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 5;

  15903  3 000436   000005 036007                    ADLQ    5,DL
         3 000437   000020 736000                    QLS     16
         3 000440   000000 676000 xsym               ERQ     FDS
         3 000441   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000442   000000 656000 xsym               ERSQ    FDS

     1201    15904    2      IF (L_TYPE = L_TP_DEV) AND

  15904  3 000443   200066 235100                    LDA     L_TYPE,,AUTO
         3 000444   000004 115007                    CMPA    4,DL
         3 000445   000502 601000 3                  TNZ     NO_STATION
         3 000446   040000 106500                    CMPC    fill='040'O
         3 000447   200045 200014                    ADSC9   DEV_NAME+2,,AUTO         cn=1,n=12
         3 000450   000016 000001 4                  ADSC9   14                       cn=0,n=1
         3 000451   000502 600000 3                  TZE     NO_STATION
         3 000452   200043 236100                    LDQ     DEV_NAME,,AUTO
         3 000453   777000 376003                    ANQ     -512,DU
         3 000454   011000 116003                    CMPQ    4608,DU
         3 000455   000502 602000 3                  TNC     NO_STATION

     1202    15905    2           (DEV_NAME.UNAME ~= '*') AND
     1203    15906    2           (DEV_NAME.COUNT > 8) THEN
     1204    15907    3      DO;

     1205    15908    3         SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,4) = ',%>A';

  15908  3 000456   000000 236000 xsym               LDQ     FDS
         3 000457   000020 772000                    QRL     16
         3 000460   040006 100400                    MLR     fill='040'O
         3 000461   000625 000004 2                  ADSC9   YES_STR+14               cn=0,n=4
         3 000462   000000 200004 xsym               ADSC9   FMT_BUF,Q                cn=1,n=4

     1206    15909    3         FDS.FMT_.BOUND = FDS.FMT_.BOUND + 4;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:225  

  15909  3 000463   000004 036007                    ADLQ    4,DL
         3 000464   000020 736000                    QLS     16
         3 000465   000000 676000 xsym               ERQ     FDS
         3 000466   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 000467   000000 656000 xsym               ERSQ    FDS

     1207    15910    3         FMT_VEC (FDS.NVECS#) = VECTOR (DEV_NAME.UNAME);

  15910  3 000470   000011 236000 xsym               LDQ     FDS+9
         3 000471   000001 736000                    QLS     1
         3 000472   000017 235000 4                  LDA     15
         3 000473   200250 452500                    STP2    YES_NO+2,,AUTO
         3 000474   000000 620006                    EAX0    0,QL
         3 000475   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 000476   000020 036000 4                  ADLQ    16
         3 000477   000000 755010 xsym               STA     FMT_VEC,X0
         3 000500   000001 756010 xsym               STQ     FMT_VEC+1,X0

     1208    15911    3         FDS.NVECS# = FDS.NVECS# + 1;

  15911  3 000501   000011 054000 xsym               AOS     FDS+9

     1209    15912    3         END;

     1210    15913    2      END;  /*  Terminal  */

     1211    15914    1   NO_STATION:
     1212    15915    1   CALL X$FORMAT(FDS);

  15915  3 000502   000033 630400 4     NO_STATION   EPPR0   27
         3 000503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000504   000000 701000 xent               TSX1    X$FORMAT
         3 000505   000000 011000                    NOP     0

     1213    15916    1   FDS.NVECS# = 0;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:226  
  15916  3 000506   000011 450000 xsym               STZ     FDS+9

     1214    15917
     1215    15918    1   ST_IDX = 0;

  15918  3 000507   200240 450100                    STZ     ST_IDX,,AUTO

     1216    15919
     1217    15920    1   FDS.TABDFLT# = 36;

  15920  3 000510   000044 235007                    LDA     36,DL
         3 000511   000017 755000 xsym               STA     FDS+15

     1218    15921    1   FMT_BUF = '%\';

  15921  3 000512   040000 100400                    MLR     fill='040'O
         3 000513   000626 000002 2                  ADSC9   YES_STR+15               cn=0,n=2
         3 000514   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1219    15922    1   FDS.FMT_.BOUND = 1;

  15922  3 000515   000000 236000 xsym               LDQ     FDS
         3 000516   177777 376007                    ANQ     65535,DL
         3 000517   200000 276007                    ORQ     65536,DL
         3 000520   000000 756000 xsym               STQ     FDS

     1220    15923    1   SBIN_IDX = 0 ;

  15923  3 000521   200237 450100                    STZ     SBIN_IDX,,AUTO

     1221    15924    1   FDS.NVECS# = 0 ;

  15924  3 000522   000011 450000 xsym               STZ     FDS+9

     1222    15925
     1223    15926    2   DO WHILE(ST_IDX < NUM_OPTS );

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:227  
  15926  3 000523   200240 236100                    LDQ     ST_IDX,,AUTO
         3 000524   000527 604000 3                  TMI     s:15928
         3 000525   200071 116100                    CMPQ    NUM_OPTS,,AUTO
         3 000526   001024 603000 3                  TRC     s:15980

     1224    15927
     1225    15928    2      NEXT = OPT$ORDR(ST_IDX);

  15928  3 000527   200240 236100                    LDQ     ST_IDX,,AUTO
         3 000530   000011 402007                    MPY     9,DL
         3 000531   000000 116003                    CMPQ    0,DU
         3 000532   000534 605000 3                  TPL     s:15928+5
         3 000533   000044 036003                    ADLQ    36,DU
         3 000534   200072 470500                    LDP0    OPT_ORDR$,,AUTO
         3 000535   003100 061506                    CSR     bolr='003'O
         3 000536   000000 000011                    BDSC    0,Q,PR0                  by=0,bit=0,n=9
         3 000537   200070 000044                    BDSC    NEXT,,AUTO               by=0,bit=0,n=36

     1226    15929        /*  Get the option values length  */
     1227    15930        /*  For the variable options  */
     1228    15931
     1229    15932    3      DO SELECT ( NEXT );

  15932  3 000540   200070 236100                    LDQ     NEXT,,AUTO
         3 000541   000023 116007                    CMPQ    19,DL
         3 000542   000547 604000 3                  TMI     s:15932+7
         3 000543   000611 600000 3                  TZE     s:15946
         3 000544   000032 116007                    CMPQ    26,DL
         3 000545   001001 601000 3                  TNZ     s:15973
         3 000546   000724 710000 3                  TRA     s:15961
         3 000547   000011 116007                    CMPQ    9,DL
         3 000550   001001 601000 3                  TNZ     s:15973
         3 000551   000552 710000 3                  TRA     s:15934

     1230    15933    3         SELECT ( L_CD_CMD );

     1231    15934    4         DO SELECT (L_TYPE);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:228  

  15934  3 000552   200066 236100                    LDQ     L_TYPE,,AUTO
         3 000553   000003 116007                    CMPQ    3,DL
         3 000554   000561 602000 3                  TNC     s:15934+7
         3 000555   000573 600000 3                  TZE     s:15939
         3 000556   000004 116007                    CMPQ    4,DL
         3 000557   001001 601000 3                  TNZ     s:15973
         3 000560   000602 710000 3                  TRA     s:15942
         3 000561   000000 116003                    CMPQ    0,DU
         3 000562   000564 600000 3                  TZE     s:15936
         3 000563   001001 710000 3                  TRA     s:15973

     1232    15935    4            SELECT (L_CONSOLE);

     1233    15936    4            CMDCNT = CON$DREC.OCINFO.CMDCNT;

  15936  3 000564   000000 471400 xsym               LDP1    DSEG3$
         3 000565   100043 235100                    LDA     35,,PR1
         3 000566   200042 755100                    STA     CMDCNT,,AUTO

     1234    15937    4            CMD = CON$DREC.OCINFO.CMD;

  15937  3 000567   040100 100500                    MLR     fill='040'O
         3 000570   100044 000120                    ADSC9   36,,PR1                  cn=0,n=80
         3 000571   200016 000120                    ADSC9   CMD,,AUTO                cn=0,n=80
         3 000572   001001 710000 3                  TRA     s:15973

     1235    15938    4            SELECT (L_CG_DEV);

     1236    15939    4            CMDCNT = CG$DEV.B$CGAUINFO.UCMDCNT;

  15939  3 000573   000000 471400 xsym               LDP1    DSEG3$
         3 000574   100040 235100                    LDA     32,,PR1
         3 000575   200042 755100                    STA     CMDCNT,,AUTO

     1237    15940    4            CMD = CG$DEV.B$CGAUINFO.UCMD;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:229  
  15940  3 000576   040100 100500                    MLR     fill='040'O
         3 000577   100041 000120                    ADSC9   33,,PR1                  cn=0,n=80
         3 000600   200016 000120                    ADSC9   CMD,,AUTO                cn=0,n=80
         3 000601   001001 710000 3                  TRA     s:15973

     1238    15941    4            SELECT (L_TP_DEV);

     1239    15942    4            CMDCNT = TP$DEV.QQ$LOGON.CMDCNT;

  15942  3 000602   000000 471400 xsym               LDP1    DSEG3$
         3 000603   100045 235100                    LDA     37,,PR1
         3 000604   200042 755100                    STA     CMDCNT,,AUTO

     1240    15943    4            CMD = TP$DEV.QQ$LOGON.CMD;

  15943  3 000605   040100 100500                    MLR     fill='040'O
         3 000606   100046 000120                    ADSC9   38,,PR1                  cn=0,n=80
         3 000607   200016 000120                    ADSC9   CMD,,AUTO                cn=0,n=80

     1241    15944    4            END;

  15944  3 000610   001001 710000 3                  TRA     s:15973

     1242    15945    3         SELECT ( L_CD_COMGROUP );

     1243    15946    3         CALL INDEX( I, AS_BLANK, CG$DEV.KC$CGID.PSN# );

  15946  3 000611   000000 471400 xsym               LDP1    DSEG3$
         3 000612   000000 124500                    SCM     mask='000'O
         3 000613   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6
         3 000614   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000615   200056 000100                    ARG     I,,AUTO

     1244    15947    4         IF I > 0 THEN DO;

  15947  3 000616   200056 235100                    LDA     I,,AUTO
         3 000617   000644 604400 3                  TMOZ    s:15952
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:230  

     1245    15948    4            CALL CONCAT( CG, 'CG#', SUBSTR(CG$DEV.KC$CGID.PSN#,0,I), '/' );

  15948  3 000620   000627 236000 2                  LDQ     YES_STR+16
         3 000621   000034 376000 4                  ANQ     28
         3 000622   000040 276007                    ORQ     32,DL
         3 000623   200005 756100                    STQ     CG,,AUTO
         3 000624   000000 620005                    EAX0    0,AL
         3 000625   040100 100540                    MLR     fill='040'O
         3 000626   100022 000010                    ADSC9   18,,PR1                  cn=0,n=*X0
         3 000627   200005 600035                    ADSC9   CG,,AUTO                 cn=3,n=29
         3 000630   200056 236100                    LDQ     I,,AUTO
         3 000631   000035 116007                    CMPQ    29,DL
         3 000632   000640 605000 3                  TPL     s:15949
         3 000633   777742 620006                    EAX0    -30,QL
         3 000634   777777 660003                    ERX0    -1,DU
         3 000635   040146 100400                    MLR     fill='040'O
         3 000636   000035 000001 4                  ADSC9   29                       cn=0,n=1
         3 000637   200005 600010                    ADSC9   CG,Q,AUTO                cn=3,n=*X0

     1246    15949    4            CGCNT = I + 4;

  15949  3 000640   200056 235100                    LDA     I,,AUTO
         3 000641   000004 035007                    ADLA    4,DL
         3 000642   200015 755100                    STA     CGCNT,,AUTO

     1247    15950    4            END;

  15950  3 000643   000651 710000 3                  TRA     s:15955

     1248    15951    4         ELSE DO;

     1249    15952    4            CG = 'CG/';

  15952  3 000644   040100 100400                    MLR     fill='040'O
         3 000645   000630 000003 2                  ADSC9   YES_STR+17               cn=0,n=3
         3 000646   200005 000040                    ADSC9   CG,,AUTO                 cn=0,n=32
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:231  

     1250    15953    4            CGCNT = 3;

  15953  3 000647   000003 235007                    LDA     3,DL
         3 000650   200015 755100                    STA     CGCNT,,AUTO

     1251    15954    4            END;

     1252    15955    3         CALL INSERT( CG, CGCNT, ,

  15955  3 000651   100024 236100                    LDQ     20,,PR1
         3 000652   000033 772000                    QRL     27
         3 000653   777737 620005                    EAX0    -33,AL
         3 000654   777777 660003                    ERX0    -1,DU
         3 000655   000000 621006                    EAX1    0,QL
         3 000656   040145 100540                    MLR     fill='040'O
         3 000657   100024 200011                    ADSC9   20,,PR1                  cn=1,n=*X1
         3 000660   200005 000010                    ADSC9   CG,A,AUTO                cn=0,n=*X0
         3 000661   000000 621006                    EAX1    0,QL
         3 000662   200015 036100                    ADLQ    CGCNT,,AUTO
         3 000663   000040 116007                    CMPQ    32,DL
         3 000664   000711 603000 3                  TRC     s:15958
         3 000665   200250 756100                    STQ     YES_NO+2,,AUTO
         3 000666   000000 636011                    EAQ     0,X1
         3 000667   000022 772000                    QRL     18
         3 000670   200015 036100                    ADLQ    CGCNT,,AUTO
         3 000671   200250 721100                    LXL1    YES_NO+2,,AUTO
         3 000672   777737 621011                    EAX1    -33,X1
         3 000673   777777 661003                    ERX1    -1,DU
         3 000674   040146 100400                    MLR     fill='040'O
         3 000675   000036 000001 4                  ADSC9   30                       cn=0,n=1
         3 000676   200005 000011                    ADSC9   CG,Q,AUTO                cn=0,n=*X1
         3 000677   200251 756100                    STQ     YES_NO+3,,AUTO
         3 000700   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 000701   000037 116007                    CMPQ    31,DL
         3 000702   000711 603000 3                  TRC     s:15958
         3 000703   777740 622006                    EAX2    -32,QL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:232  
         3 000704   777777 662003                    ERX2    -1,DU
         3 000705   200251 235100                    LDA     YES_NO+3,,AUTO
         3 000706   040145 100500                    MLR     fill='040'O
         3 000707   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         3 000710   200005 200012                    ADSC9   CG,A,AUTO                cn=1,n=*X2

     1253    15956    3              SUBSTR(CG$DEV.KC$CGID.NAME#.TXT,0,CG$DEV.KC$CGID.NAME#.CNT),
     1254    15957    3              '.', CG$DEV.KC$CGID.ACCT# );
     1255    15958    3         CALL INDEX( I, AS_BLANK, CG$DEV.KC$CGID.ACCT# );

  15958  3 000711   000000 124500                    SCM     mask='000'O
         3 000712   100020 000010                    ADSC9   16,,PR1                  cn=0,n=8
         3 000713   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000714   200056 000100                    ARG     I,,AUTO

     1256    15959    3         CGCNT = CGCNT + CG$DEV.KC$CGID.NAME#.CNT + I + 1;

  15959  3 000715   100024 236100                    LDQ     20,,PR1
         3 000716   000033 772000                    QRL     27
         3 000717   200015 036100                    ADLQ    CGCNT,,AUTO
         3 000720   200056 036100                    ADLQ    I,,AUTO
         3 000721   000001 036007                    ADLQ    1,DL
         3 000722   200015 756100                    STQ     CGCNT,,AUTO
         3 000723   001001 710000 3                  TRA     s:15973

     1257    15960    3         SELECT ( L_CD_INSTANCE );

     1258    15961    4         IF TP$DEV.KC$CGID.PSN# = AS_BLANK THEN DO;

  15961  3 000724   000000 471400 xsym               LDP1    DSEG3$
         3 000725   040000 106500                    CMPC    fill='040'O
         3 000726   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6
         3 000727   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000730   000740 601000 3                  TNZ     s:15966

     1259    15962    4            INSTANCE = TP$DEV.KC$CGID.NAME#.TXT;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:233  
  15962  3 000731   040100 100500                    MLR     fill='040'O
         3 000732   100024 200022                    ADSC9   20,,PR1                  cn=1,n=18
         3 000733   200057 000022                    ADSC9   INSTANCE,,AUTO           cn=0,n=18

     1260    15963    4            INSTANCECNT = TP$DEV.KC$CGID.NAME#.CNT;

  15963  3 000734   100024 236100                    LDQ     20,,PR1
         3 000735   000033 772000                    QRL     27
         3 000736   200064 756100                    STQ     INSTANCECNT,,AUTO

     1261    15964    4            END;

  15964  3 000737   001001 710000 3                  TRA     s:15973

     1262    15965    4         ELSE DO;

     1263    15966    4            CALL INDEX( I, AS_BLANK, TP$DEV.KC$CGID.PSN# );

  15966  3 000740   000000 124500                    SCM     mask='000'O
         3 000741   100022 000006                    ADSC9   18,,PR1                  cn=0,n=6
         3 000742   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 000743   200056 000100                    ARG     I,,AUTO

     1264    15967    4            CALL CONCAT( INSTANCE, 'DP#', SUBSTR(TP$DEV.KC$CGID.PSN#,0,I),

  15967  3 000744   000631 236000 2                  LDQ     YES_STR+18
         3 000745   000034 376000 4                  ANQ     28
         3 000746   000040 276007                    ORQ     32,DL
         3 000747   200057 756100                    STQ     INSTANCE,,AUTO
         3 000750   200056 720100                    LXL0    I,,AUTO
         3 000751   040100 100540                    MLR     fill='040'O
         3 000752   100022 000010                    ADSC9   18,,PR1                  cn=0,n=*X0
         3 000753   200057 600017                    ADSC9   INSTANCE,,AUTO           cn=3,n=15
         3 000754   200056 236100                    LDQ     I,,AUTO
         3 000755   000017 116007                    CMPQ    15,DL
         3 000756   000774 605000 3                  TPL     s:15969
         3 000757   777760 621006                    EAX1    -16,QL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:234  
         3 000760   777777 661003                    ERX1    -1,DU
         3 000761   040146 100400                    MLR     fill='040'O
         3 000762   000036 000001 4                  ADSC9   30                       cn=0,n=1
         3 000763   200057 600011                    ADSC9   INSTANCE,Q,AUTO          cn=3,n=*X1
         3 000764   200056 236100                    LDQ     I,,AUTO
         3 000765   000016 116007                    CMPQ    14,DL
         3 000766   000774 605000 3                  TPL     s:15969
         3 000767   777761 620006                    EAX0    -15,QL
         3 000770   777777 660003                    ERX0    -1,DU
         3 000771   040146 100500                    MLR     fill='040'O
         3 000772   100024 200037                    ADSC9   20,,PR1                  cn=1,n=31
         3 000773   200060 000010                    ADSC9   INSTANCE+1,Q,AUTO        cn=0,n=*X0

     1265    15968    4                 '.', TP$DEV.KC$CGID.NAME#.TXT );
     1266    15969    4            INSTANCECNT = TP$DEV.KC$CGID.NAME#.CNT + I + 4;

  15969  3 000774   100024 236100                    LDQ     20,,PR1
         3 000775   000033 772000                    QRL     27
         3 000776   200056 036100                    ADLQ    I,,AUTO
         3 000777   000004 036007                    ADLQ    4,DL
         3 001000   200064 756100                    STQ     INSTANCECNT,,AUTO

     1267    15970    4            END;

     1268    15971    3         END;

     1269    15972
     1270    15973    2      CALL INSERT_FIELD ;

  15973  3 001001   001210 701000 3                  TSX1    INSERT_FIELD
         3 001002   000000 011000                    NOP     0

     1271    15974    2      CALL X$FORMAT(FDS);

  15974  3 001003   000033 630400 4                  EPPR0   27
         3 001004   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001005   000000 701000 xent               TSX1    X$FORMAT
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:235  
         3 001006   000000 011000                    NOP     0

     1272    15975    2      FDS.NVECS# = 0;

  15975  3 001007   000011 450000 xsym               STZ     FDS+9

     1273    15976    2      FMT_BUF = '%\%-';

  15976  3 001010   040000 100400                    MLR     fill='040'O
         3 001011   000632 000004 2                  ADSC9   YES_STR+19               cn=0,n=4
         3 001012   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1274    15977    2      FDS.FMT_.BOUND = 3;

  15977  3 001013   000000 236000 xsym               LDQ     FDS
         3 001014   177777 376007                    ANQ     65535,DL
         3 001015   600000 276007                    ORQ     -65536,DL
         3 001016   000000 756000 xsym               STQ     FDS

     1275    15978    2      ST_IDX = ST_IDX + 1;

  15978  3 001017   200240 054100                    AOS     ST_IDX,,AUTO

     1276    15979    2      END;

  15979  3 001020   200240 236100                    LDQ     ST_IDX,,AUTO
         3 001021   000527 604000 3                  TMI     s:15928
         3 001022   200071 116100                    CMPQ    NUM_OPTS,,AUTO
         3 001023   000527 602000 3                  TNC     s:15928

     1277    15980    1   FMT_BUF = '%\%/';

  15980  3 001024   040000 100400                    MLR     fill='040'O
         3 001025   000633 000004 2                  ADSC9   YES_STR+20               cn=0,n=4
         3 001026   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1278    15981    1   FDS.FMT_.BOUND = 3;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:236  

  15981  3 001027   000000 236000 xsym               LDQ     FDS
         3 001030   177777 376007                    ANQ     65535,DL
         3 001031   600000 276007                    ORQ     -65536,DL
         3 001032   000000 756000 xsym               STQ     FDS

     1279    15982    1   FDS.NVECS# = 0;

  15982  3 001033   000011 450000 xsym               STZ     FDS+9

     1280    15983    1   CALL X$FORMAT(FDS);

  15983  3 001034   000033 630400 4                  EPPR0   27
         3 001035   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001036   000000 701000 xent               TSX1    X$FORMAT
         3 001037   000000 011000                    NOP     0

     1281    15984    1   FDS.NVECS# = 0;

  15984  3 001040   000011 450000 xsym               STZ     FDS+9

     1282    15985    2   IF NOT JCL THEN DO;

  15985  3 001041   200003 470500                    LDP0    @JCL,,AUTO
         3 001042   000000 066500                    CMPB    filb='0'B
         3 001043   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 001044   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001045   001207 601000 3                  TNZ     s:16019

     1283    15986    2      CALL CONCAT (USERS_KEY.TXTC, SUBSTR (DEV_NAME.TEXT, 0, 8),'WSNS');

  15986  3 001046   040000 100500                    MLR     fill='040'O
         3 001047   200043 200010                    ADSC9   DEV_NAME,,AUTO           cn=1,n=8
         3 001050   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         3 001051   040000 100400                    MLR     fill='040'O
         3 001052   000634 000004 2                  ADSC9   YES_STR+21               cn=0,n=4
         3 001053   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:237  

     1284    15987    2      USERS_KEY.COUNT = 12; /* DEVNAME=8 + 4 for 'WSNS' */

  15987  3 001054   014000 236003                    LDQ     6144,DU
         3 001055   000000 552040 xsym               STBQ    USERS_KEY,'40'O

     1285    15988    2      I = DSEG1SIZE;

  15988  3 001056   000000 235000 xsym               LDA     DSEG1SIZE
         3 001057   200056 755100                    STA     I,,AUTO

     1286    15989    2      CALL ASB$READ_HLP (DSEG1$, I)

  15989  3 001060   200056 630500                    EPPR0   I,,AUTO
         3 001061   200251 450500                    STP0    YES_NO+3,,AUTO
         3 001062   000021 236000 4                  LDQ     17
         3 001063   200250 756100                    STQ     YES_NO+2,,AUTO
         3 001064   200250 630500                    EPPR0   YES_NO+2,,AUTO
         3 001065   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001066   000000 701000 xent               TSX1    ASB$READ_HLP
         3 001067   001203 702000 3                  TSX2    s:16017

     1287    15990    3      WHENRETURN DO;

     1288    15991    3         IF (DEVWSNS.NDEV > 0)

  15991  3 001070   000000 470400 xsym               LDP0    DSEG1$
         3 001071   000000 235100                    LDA     0,,PR0
         3 001072   001202 600000 3                  TZE     s:16014

     1289    15992    4         THEN DO;

     1290    15993    4            CALL CONCAT(FMT_BUF, '%1\', DEVWSNS_HDR, '%/');

  15993  3 001073   000635 236000 2                  LDQ     YES_STR+22
         3 001074   000034 376000 4                  ANQ     28
         3 001075   000040 276007                    ORQ     32,DL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:238  
         3 001076   000000 756000 xsym               STQ     FMT_BUF
         3 001077   040000 100400                    MLR     fill='040'O
         3 001100   000532 000051 2                  ADSC9   DEVWSNS_HDR              cn=0,n=41
         3 001101   000000 600051 xsym               ADSC9   FMT_BUF                  cn=3,n=41
         3 001102   040000 100400                    MLR     fill='040'O
         3 001103   000636 000002 2                  ADSC9   YES_STR+23               cn=0,n=2
         3 001104   000013 000323 xsym               ADSC9   FMT_BUF+11               cn=0,n=211

     1291    15994    4            FDS.FMT_.BOUND = LENGTHC(DEVWSNS_HDR) + 4;

  15994  3 001105   000000 236000 xsym               LDQ     FDS
         3 001106   177777 376007                    ANQ     65535,DL
         3 001107   000037 276000 4                  ORQ     31
         3 001110   000000 756000 xsym               STQ     FDS

     1292    15995    4            CALL X$FORMAT (FDS);

  15995  3 001111   000033 630400 4                  EPPR0   27
         3 001112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001113   000000 701000 xent               TSX1    X$FORMAT
         3 001114   000000 011000                    NOP     0

     1293    15996    4            FDS.NVECS# = 0;

  15996  3 001115   000011 450000 xsym               STZ     FDS+9

     1294    15997    4            FDS.TABDFLT# = 10;

  15997  3 001116   000012 235007                    LDA     10,DL
         3 001117   000017 755000 xsym               STA     FDS+15

     1295    15998    5            DO I = 0 TO (DEVWSNS.NDEV - 1);

  15998  3 001120   200056 450100                    STZ     I,,AUTO
         3 001121   001161 710000 3                  TRA     s:16008+1

     1296    15999    6               IF I = 0 THEN DO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:239  

  15999  3 001122   200056 235100                    LDA     I,,AUTO
         3 001123   001140 601000 3                  TNZ     s:16004

     1297    16000    6                  CALL CONCAT(FMT_BUF, '%\',SUBSTR(DEVWSNS.DEV(I),0,8));

  16000  3 001124   000626 220000 2                  LDX0    YES_STR+15
         3 001125   000000 740000 xsym               STX0    FMT_BUF
         3 001126   000003 735000                    ALS     3
         3 001127   000000 470400 xsym               LDP0    DSEG1$
         3 001130   040000 100505                    MLR     fill='040'O
         3 001131   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         3 001132   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

     1298    16001    6                  FDS.FMT_.BOUND = 9;

  16001  3 001133   000000 236000 xsym               LDQ     FDS
         3 001134   177777 376007                    ANQ     65535,DL
         3 001135   000040 276000 4                  ORQ     32
         3 001136   000000 756000 xsym               STQ     FDS

     1299    16002    6                  END;

  16002  3 001137   001154 710000 3                  TRA     s:16007

     1300    16003    6               ELSE DO;

     1301    16004    6                  CALL CONCAT(FMT_BUF, '%\%-%10R', SUBSTR(DEVWSNS.DEV(I),0,8));

  16004  3 001140   040000 100400                    MLR     fill='040'O
         3 001141   000637 000010 2                  ADSC9   YES_STR+24               cn=0,n=8
         3 001142   000000 000010 xsym               ADSC9   FMT_BUF                  cn=0,n=8
         3 001143   000003 735000                    ALS     3
         3 001144   000000 470400 xsym               LDP0    DSEG1$
         3 001145   040000 100505                    MLR     fill='040'O
         3 001146   000001 000010                    ADSC9   1,A,PR0                  cn=0,n=8
         3 001147   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:240  

     1302    16005    6                  FDS.FMT_.BOUND = 15;

  16005  3 001150   000000 236000 xsym               LDQ     FDS
         3 001151   177777 376007                    ANQ     65535,DL
         3 001152   000041 276000 4                  ORQ     33
         3 001153   000000 756000 xsym               STQ     FDS

     1303    16006    6                  END;

     1304    16007    5               CALL X$FORMAT (FDS);

  16007  3 001154   000033 630400 4                  EPPR0   27
         3 001155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001156   000000 701000 xent               TSX1    X$FORMAT
         3 001157   000000 011000                    NOP     0

     1305    16008    5               END; /* Do i */

  16008  3 001160   200056 054100                    AOS     I,,AUTO
         3 001161   000000 470400 xsym               LDP0    DSEG1$
         3 001162   200056 236100                    LDQ     I,,AUTO
         3 001163   001122 604000 3                  TMI     s:15999
         3 001164   000000 116100                    CMPQ    0,,PR0
         3 001165   001122 602000 3                  TNC     s:15999

     1306    16009    4            FMT_BUF = '%\%/';

  16009  3 001166   040000 100400                    MLR     fill='040'O
         3 001167   000633 000004 2                  ADSC9   YES_STR+20               cn=0,n=4
         3 001170   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

     1307    16010    4            FDS.FMT_.BOUND = 3;

  16010  3 001171   000000 236000 xsym               LDQ     FDS
         3 001172   177777 376007                    ANQ     65535,DL
         3 001173   600000 276007                    ORQ     -65536,DL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:241  
         3 001174   000000 756000 xsym               STQ     FDS

     1308    16011    4            FDS.NVECS# = 0;

  16011  3 001175   000011 450000 xsym               STZ     FDS+9

     1309    16012    4            CALL X$FORMAT (FDS);

  16012  3 001176   000033 630400 4                  EPPR0   27
         3 001177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 001200   000000 701000 xent               TSX1    X$FORMAT
         3 001201   000000 011000                    NOP     0

     1310    16013    4            END; /* Do if DEVWSNS.NDEV > 0 */

     1311    16014    3         END; /* Whenreturn */

  16014  3 001202   001203 710000 3                  TRA     s:16017

     1312    16015    3      WHENALTRETURN DO; /* Just in case there is no devwsn record */

     1313    16016    3         END;

     1314    16017    2      CALL ASB$WRITE_LO( AS_BLANK, 1 );

  16017  3 001203   000042 630400 4                  EPPR0   34
         3 001204   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 001205   000000 701000 xent               TSX1    ASB$WRITE_LO
         3 001206   000000 011000                    NOP     0

     1315    16018    2      END; /*  Not jcl  */

     1316    16019    1   RETURN;

  16019  3 001207   000000 702200 xent               TSX2  ! X66_ARET

     1317    16020
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:242  
     1318    16021    1   INSERT_FIELD: PROC;

  16021  3 001210   200244 741300       INSERT_FIELD STX1  ! T_SNAME+3,,AUTO

     1319    16022        %SUB C_ATTRIBUTES = 4;
     1320    16023        %SUB C_OCTAL = 5;
     1321    16024    2   DCL CLASS SBIN;
     1322    16025    2   DCL YES_NO BIT(1) ALIGNED;
     1323    16026
     1324    16027
     1325    16028    3   DO CASE (NEXT);

  16028  3 001211   200070 235100                    LDA     NEXT,,AUTO
         3 001212   000064 115007                    CMPA    52,DL
         3 001213   001215 602005 3                  TNC     s:16028+4,AL
         3 001214   003075 710000 3                  TRA     s:16463
         3 001215   001301 710000 3                  TRA     s:16031
         3 001216   001340 710000 3                  TRA     s:16042
         3 001217   001410 710000 3                  TRA     s:16057
         3 001220   001437 710000 3                  TRA     s:16067
         3 001221   001534 710000 3                  TRA     s:16091
         3 001222   001543 710000 3                  TRA     s:16096
         3 001223   001552 710000 3                  TRA     s:16101
         3 001224   001561 710000 3                  TRA     s:16106
         3 001225   001570 710000 3                  TRA     s:16111
         3 001226   001606 710000 3                  TRA     s:16121
         3 001227   001675 710000 3                  TRA     s:16144
         3 001230   001764 710000 3                  TRA     s:16160
         3 001231   002017 710000 3                  TRA     s:16168
         3 001232   002030 710000 3                  TRA     s:16173
         3 001233   002045 710000 3                  TRA     s:16178
         3 001234   002060 710000 3                  TRA     s:16183
         3 001235   002071 710000 3                  TRA     s:16188
         3 001236   002103 710000 3                  TRA     s:16193
         3 001237   002120 710000 3                  TRA     s:16198
         3 001240   002155 710000 3                  TRA     s:16208
         3 001241   002175 710000 3                  TRA     s:16213
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:243  
         3 001242   002231 710000 3                  TRA     s:16224
         3 001243   002277 710000 3                  TRA     s:16242
         3 001244   002310 710000 3                  TRA     s:16247
         3 001245   002321 710000 3                  TRA     s:16252
         3 001246   002332 710000 3                  TRA     s:16257
         3 001247   002343 710000 3                  TRA     s:16262
         3 001250   002363 710000 3                  TRA     s:16267
         3 001251   002376 710000 3                  TRA     s:16286
         3 001252   001641 710000 3                  TRA     s:16133
         3 001253   001577 710000 3                  TRA     s:16116
         3 001254   002460 710000 3                  TRA     s:16309
         3 001255   002544 710000 3                  TRA     s:16337
         3 001256   002561 710000 3                  TRA     s:16343
         3 001257   002615 710000 3                  TRA     s:16355
         3 001260   002623 710000 3                  TRA     s:16360
         3 001261   002631 710000 3                  TRA     s:16365
         3 001262   002650 710000 3                  TRA     s:16374
         3 001263   002662 710000 3                  TRA     s:16380
         3 001264   002674 710000 3                  TRA     s:16386
         3 001265   002706 710000 3                  TRA     s:16392
         3 001266   002720 710000 3                  TRA     s:16398
         3 001267   002732 710000 3                  TRA     s:16404
         3 001270   002744 710000 3                  TRA     s:16410
         3 001271   002756 710000 3                  TRA     s:16416
         3 001272   002770 710000 3                  TRA     s:16422
         3 001273   003002 710000 3                  TRA     s:16428
         3 001274   003014 710000 3                  TRA     s:16434
         3 001275   003026 710000 3                  TRA     s:16440
         3 001276   003040 710000 3                  TRA     s:16446
         3 001277   003052 710000 3                  TRA     s:16452
         3 001300   003064 710000 3                  TRA     s:16458

     1326    16029
     1327    16030    3      CASE (L_CD_PROFILE);

     1328    16031    4         IF KL$DREC.PNAME.CNT = 0 THEN DO;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:244  
  16031  3 001301   000000 470400 xsym               LDP0    DSEG3$
         3 001302   000004 236100                    LDQ     4,,PR0
         3 001303   777000 316003                    CANQ    -512,DU
         3 001304   001317 601000 3                  TNZ     s:16036

     1329    16032    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR ( NONE_STR) ;

  16032  3 001305   000011 235000 xsym               LDA     FDS+9
         3 001306   000001 735000                    ALS     1
         3 001307   000000 620005                    EAX0    0,AL
         3 001310   000000 622005                    EAX2    0,AL
         3 001311   000044 237000 4                  LDAQ    36
         3 001312   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001313   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1330    16033    4            LEN = 4;

  16033  3 001314   000004 235007                    LDA     4,DL
         3 001315   200065 755100                    STA     LEN,,AUTO

     1331    16034    4            END;   /*  Blank profile  */

  16034  3 001316   001335 710000 3                  TRA     s:16039

     1332    16035    4         ELSE DO;

     1333    16036    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR(ADDR(KL$DREC.PNAME)->TEXT$C.C);

  16036  3 001317   000011 235000 xsym               LDA     FDS+9
         3 001320   000001 735000                    ALS     1
         3 001321   000004 236100                    LDQ     4,,PR0
         3 001322   000033 772000                    QRL     27
         3 001323   000000 620005                    EAX0    0,AL
         3 001324   000064 737000                    LLS     52
         3 001325   000140 135007                    SBLA    96,DL
         3 001326   000000 236000 xsym               LDQ     DSEG3$
         3 001327   000046 036000 4                  ADLQ    38
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:245  
         3 001330   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001331   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1334    16037    4            LEN = KL$DREC.PNAME.CNT;

  16037  3 001332   000004 236100                    LDQ     4,,PR0
         3 001333   000033 772000                    QRL     27
         3 001334   200065 756100                    STQ     LEN,,AUTO

     1335    16038    4            END;   /*  Non blank profile  */

     1336    16039    3         CLASS = C_TEXT;

  16039  3 001335   000001 235007                    LDA     1,DL
         3 001336   200245 755100                    STA     CLASS,,AUTO
         3 001337   003075 710000 3                  TRA     s:16463

     1337    16040
     1338    16041    3      CASE (L_CD_PASSWORD);

     1339    16042    4         IF NOT TERMINAL THEN DO;

  16042  3 001340   200004 470500                    LDP0    @TERMINAL,,AUTO
         3 001341   000000 066500                    CMPB    filb='0'B
         3 001342   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 001343   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 001344   003075 601000 3                  TNZ     s:16463

     1340    16043    5            IF KL$DREC.PASSWORD= BLANK_PASS THEN DO;

  16043  3 001345   000000 471400 xsym               LDP1    DSEG3$
         3 001346   040000 106500                    CMPC    fill='040'O
         3 001347   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         3 001350   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         3 001351   001366 601000 3                  TNZ     s:16049

     1341    16044    5               FMT_VEC(FDS.NVECS# + 2) = VECTOR(NONE_STR);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:246  

  16044  3 001352   000011 236000 xsym               LDQ     FDS+9
         3 001353   000001 736000                    QLS     1
         3 001354   000000 620006                    EAX0    0,QL
         3 001355   000000 622006                    EAX2    0,QL
         3 001356   000044 237000 4                  LDAQ    36
         3 001357   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001360   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1342    16045    5               CLASS= C_TEXT;

  16045  3 001361   000001 235007                    LDA     1,DL
         3 001362   200245 755100                    STA     CLASS,,AUTO

     1343    16046    5               LEN = 4;

  16046  3 001363   000004 235007                    LDA     4,DL
         3 001364   200065 755100                    STA     LEN,,AUTO

     1344    16047    5               END;

  16047  3 001365   003075 710000 3                  TRA     s:16463

     1345    16048    5            ELSE DO;

     1346    16049    5               FMT_VEC(FDS.NVECS# + 2) = VECTOR ( SUBSTR(KL$DREC.PASSWORD,0,4) );

  16049  3 001366   000011 236000 xsym               LDQ     FDS+9
         3 001367   000001 736000                    QLS     1
         3 001370   777640 235007                    LDA     -96,DL
         3 001371   000000 620006                    EAX0    0,QL
         3 001372   000000 236000 xsym               LDQ     DSEG3$
         3 001373   000002 036003                    ADLQ    2,DU
         3 001374   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001375   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1347    16050    5               FMT_VEC(FDS.NVECS# + 3) = VECTOR ( SUBSTR(KL$DREC.PASSWORD,4,4) );
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:247  

  16050  3 001376   777640 235007                    LDA     -96,DL
         3 001377   000000 236000 xsym               LDQ     DSEG3$
         3 001400   000003 036003                    ADLQ    3,DU
         3 001401   000006 755010 xsym               STA     FMT_VEC+6,X0
         3 001402   000007 756010 xsym               STQ     FMT_VEC+7,X0

     1348    16051    5               CLASS = C_OCTAL;

  16051  3 001403   000005 235007                    LDA     5,DL
         3 001404   200245 755100                    STA     CLASS,,AUTO

     1349    16052    5               LEN = 27;

  16052  3 001405   000033 235007                    LDA     27,DL
         3 001406   200065 755100                    STA     LEN,,AUTO

     1350    16053    5               END;  /* BLANK_PASS */

     1351    16054    4            END;  /*  Not terminal  */

  16054  3 001407   003075 710000 3                  TRA     s:16463

     1352    16055
     1353    16056    3      CASE (L_CD_MAXPRIO);

     1354    16057    4         DO CASE (L_TYPE);

  16057  3 001410   200066 236100                    LDQ     L_TYPE,,AUTO
         3 001411   000003 116007                    CMPQ    3,DL
         3 001412   001414 602006 3                  TNC     s:16057+4,QL
         3 001413   001432 710000 3                  TRA     s:16063
         3 001414   001417 710000 3                  TRA     s:16059
         3 001415   001432 710000 3                  TRA     s:16063
         3 001416   001425 710000 3                  TRA     s:16061

     1355    16058    4            CASE (L_CONSOLE);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:248  

     1356    16059    4               SBINS(SBIN_IDX + 1) = CON$DREC.OCINFO.MXPRI;

  16059  3 001417   000000 470400 xsym               LDP0    DSEG3$
         3 001420   000034 236100                    LDQ     28,,PR0
         3 001421   000777 376007                    ANQ     511,DL
         3 001422   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 001423   200074 756110                    STQ     SBINS+1,X0,AUTO
         3 001424   001432 710000 3                  TRA     s:16063

     1357    16060    4            CASE (L_IN_DEV);

     1358    16061    4               SBINS(SBIN_IDX + 1) = IN$DEV.ISINFO.MXPRI;

  16061  3 001425   000000 470400 xsym               LDP0    DSEG3$
         3 001426   000034 236100                    LDQ     28,,PR0
         3 001427   000777 376007                    ANQ     511,DL
         3 001430   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 001431   200074 756110                    STQ     SBINS+1,X0,AUTO

     1359    16062    4            END;

     1360    16063    3         CLASS = C_SBIN;

  16063  3 001432   000014 236007                    LDQ     12,DL
         3 001433   200245 756100                    STQ     CLASS,,AUTO

     1361    16064    3         LEN = 3;

  16064  3 001434   000003 235007                    LDA     3,DL
         3 001435   200065 755100                    STA     LEN,,AUTO
         3 001436   003075 710000 3                  TRA     s:16463

     1362    16065
     1363    16066    3      CASE (L_CD_WSN);

     1364    16067    4         DO CASE (L_TYPE);
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:249  

  16067  3 001437   200066 236100                    LDQ     L_TYPE,,AUTO
         3 001440   000003 116007                    CMPQ    3,DL
         3 001441   001443 602006 3                  TNC     s:16067+4,QL
         3 001442   001531 710000 3                  TRA     s:16088
         3 001443   001446 710000 3                  TRA     s:16069
         3 001444   001531 710000 3                  TRA     s:16088
         3 001445   001500 710000 3                  TRA     s:16079

     1365    16068    4            CASE (L_CONSOLE);

     1366    16069    5               IF CON$DREC.OCINFO.WSN = ' ' THEN DO;

  16069  3 001446   000000 470400 xsym               LDP0    DSEG3$
         3 001447   040000 106500                    CMPC    fill='040'O
         3 001450   000036 000010                    ADSC9   30,,PR0                  cn=0,n=8
         3 001451   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001452   001465 601000 3                  TNZ     s:16074

     1367    16070    5                  FMT_VEC ( FDS.NVECS# + 2 ) = VECTOR (NONE_STR);

  16070  3 001453   000011 235000 xsym               LDA     FDS+9
         3 001454   000001 735000                    ALS     1
         3 001455   000000 620005                    EAX0    0,AL
         3 001456   000000 622005                    EAX2    0,AL
         3 001457   000044 237000 4                  LDAQ    36
         3 001460   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001461   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1368    16071    5                  LEN = 4;

  16071  3 001462   000004 235007                    LDA     4,DL
         3 001463   200065 755100                    STA     LEN,,AUTO

     1369    16072    5                  END;   /*  Blank wsn  */

  16072  3 001464   001531 710000 3                  TRA     s:16088
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:250  

     1370    16073    5               ELSE DO;

     1371    16074    5                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( CON$DREC.OCINFO.WSN );

  16074  3 001465   000011 235000 xsym               LDA     FDS+9
         3 001466   000001 735000                    ALS     1
         3 001467   000000 620005                    EAX0    0,AL
         3 001470   000032 235000 4                  LDA     26
         3 001471   000000 236000 xsym               LDQ     DSEG3$
         3 001472   000036 036003                    ADLQ    30,DU
         3 001473   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001474   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1372    16075    5                  LEN = 8;

  16075  3 001475   000010 235007                    LDA     8,DL
         3 001476   200065 755100                    STA     LEN,,AUTO

     1373    16076    5                  END;  /*  Non blank wsn  */

  16076  3 001477   001531 710000 3                  TRA     s:16088

     1374    16077
     1375    16078    4            CASE (L_IN_DEV);

     1376    16079    5               IF IN$DEV.ISINFO.WSN = ' ' THEN DO;

  16079  3 001500   000000 470400 xsym               LDP0    DSEG3$
         3 001501   040000 106500                    CMPC    fill='040'O
         3 001502   000065 000010                    ADSC9   53,,PR0                  cn=0,n=8
         3 001503   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 001504   001517 601000 3                  TNZ     s:16084

     1377    16080    5                  FMT_VEC ( FDS.NVECS# + 2 ) = VECTOR (NONE_STR);

  16080  3 001505   000011 235000 xsym               LDA     FDS+9
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:251  
         3 001506   000001 735000                    ALS     1
         3 001507   000000 620005                    EAX0    0,AL
         3 001510   000000 622005                    EAX2    0,AL
         3 001511   000044 237000 4                  LDAQ    36
         3 001512   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001513   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1378    16081    5                  LEN = 4;

  16081  3 001514   000004 235007                    LDA     4,DL
         3 001515   200065 755100                    STA     LEN,,AUTO

     1379    16082    5                  END;   /*  Blank wsn  */

  16082  3 001516   001531 710000 3                  TRA     s:16088

     1380    16083    5               ELSE DO;

     1381    16084    5                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( IN$DEV.ISINFO.WSN );

  16084  3 001517   000011 235000 xsym               LDA     FDS+9
         3 001520   000001 735000                    ALS     1
         3 001521   000000 620005                    EAX0    0,AL
         3 001522   000032 235000 4                  LDA     26
         3 001523   000000 236000 xsym               LDQ     DSEG3$
         3 001524   000065 036003                    ADLQ    53,DU
         3 001525   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001526   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1382    16085    5                  LEN = 8;

  16085  3 001527   000010 235007                    LDA     8,DL
         3 001530   200065 755100                    STA     LEN,,AUTO

     1383    16086    5                  END;  /*  Non blank wsn  */

     1384    16087    4            END;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:252  

     1385    16088    3         CLASS = C_TEXT;

  16088  3 001531   000001 235007                    LDA     1,DL
         3 001532   200245 755100                    STA     CLASS,,AUTO
         3 001533   003075 710000 3                  TRA     s:16463

     1386    16089
     1387    16090    3      CASE (L_CD_SYS);

     1388    16091    3         MASK = K_SYS;

  16091  3 001534   200000 220003                    LDX0    65536,DU
         3 001535   200067 740100                    STX0    MASK,,AUTO

     1389    16092    3         CLASS = C_ATTRIBUTES;

  16092  3 001536   000004 236007                    LDQ     4,DL
         3 001537   200245 756100                    STQ     CLASS,,AUTO

     1390    16093    3         LEN = 7;

  16093  3 001540   000007 235007                    LDA     7,DL
         3 001541   200065 755100                    STA     LEN,,AUTO
         3 001542   003075 710000 3                  TRA     s:16463

     1391    16094
     1392    16095    3      CASE (L_CD_ADMIN);

     1393    16096    3         MASK = K_ADMIN;

  16096  3 001543   040000 220003                    LDX0    16384,DU
         3 001544   200067 740100                    STX0    MASK,,AUTO

     1394    16097    3         CLASS = C_ATTRIBUTES;

  16097  3 001545   000004 236007                    LDQ     4,DL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:253  
         3 001546   200245 756100                    STQ     CLASS,,AUTO

     1395    16098    3         LEN = 7;

  16098  3 001547   000007 235007                    LDA     7,DL
         3 001550   200065 755100                    STA     LEN,,AUTO
         3 001551   003075 710000 3                  TRA     s:16463

     1396    16099
     1397    16100    3      CASE (L_CD_COMM);

     1398    16101    3         MASK = K_COMM;

  16101  3 001552   004000 220003                    LDX0    2048,DU
         3 001553   200067 740100                    STX0    MASK,,AUTO

     1399    16102    3         CLASS = C_ATTRIBUTES;

  16102  3 001554   000004 236007                    LDQ     4,DL
         3 001555   200245 756100                    STQ     CLASS,,AUTO

     1400    16103    3         LEN = 7;

  16103  3 001556   000007 235007                    LDA     7,DL
         3 001557   200065 755100                    STA     LEN,,AUTO
         3 001560   003075 710000 3                  TRA     s:16463

     1401    16104
     1402    16105    3      CASE (L_CD_DEV);

     1403    16106    3         MASK = K_DEVC;

  16106  3 001561   100000 220003                    LDX0    32768,DU
         3 001562   200067 740100                    STX0    MASK,,AUTO

     1404    16107    3         CLASS = C_ATTRIBUTES;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:254  
  16107  3 001563   000004 236007                    LDQ     4,DL
         3 001564   200245 756100                    STQ     CLASS,,AUTO

     1405    16108    3         LEN = 7;

  16108  3 001565   000007 235007                    LDA     7,DL
         3 001566   200065 755100                    STA     LEN,,AUTO
         3 001567   003075 710000 3                  TRA     s:16463

     1406    16109
     1407    16110    3      CASE (L_CD_SLAVE);

     1408    16111    3         MASK = K_SLAVE;

  16111  3 001570   002000 220003                    LDX0    1024,DU
         3 001571   200067 740100                    STX0    MASK,,AUTO

     1409    16112    3         CLASS = C_ATTRIBUTES;

  16112  3 001572   000004 236007                    LDQ     4,DL
         3 001573   200245 756100                    STQ     CLASS,,AUTO

     1410    16113    3         LEN = 7;

  16113  3 001574   000007 235007                    LDA     7,DL
         3 001575   200065 755100                    STA     LEN,,AUTO
         3 001576   003075 710000 3                  TRA     s:16463

     1411    16114
     1412    16115    3      CASE (L_CD_TP);

     1413    16116    3         MASK = K_TP;

  16116  3 001577   001000 220003                    LDX0    512,DU
         3 001600   200067 740100                    STX0    MASK,,AUTO

     1414    16117    3         CLASS = C_ATTRIBUTES;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:255  

  16117  3 001601   000004 236007                    LDQ     4,DL
         3 001602   200245 756100                    STQ     CLASS,,AUTO

     1415    16118    3         LEN = 7;

  16118  3 001603   000007 235007                    LDA     7,DL
         3 001604   200065 755100                    STA     LEN,,AUTO
         3 001605   003075 710000 3                  TRA     s:16463

     1416    16119
     1417    16120    3      CASE (L_CD_CMD);

     1418    16121    3         IF CMDCNT = 0 THEN

  16121  3 001606   200042 236100                    LDQ     CMDCNT,,AUTO
         3 001607   001622 601000 3                  TNZ     s:16127

     1419    16122    4         DO;

     1420    16123    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( NONE_STR );

  16123  3 001610   000011 235000 xsym               LDA     FDS+9
         3 001611   000001 735000                    ALS     1
         3 001612   000000 620005                    EAX0    0,AL
         3 001613   000000 622005                    EAX2    0,AL
         3 001614   000044 237000 4                  LDAQ    36
         3 001615   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001616   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1421    16124    4            LEN = 4;

  16124  3 001617   000004 235007                    LDA     4,DL
         3 001620   200065 755100                    STA     LEN,,AUTO

     1422    16125    4            END;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:256  
  16125  3 001621   001636 710000 3                  TRA     s:16130

     1423    16126    4         ELSE DO;

     1424    16127    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(CMD,0,CMDCNT) );

  16127  3 001622   000011 235000 xsym               LDA     FDS+9
         3 001623   000001 735000                    ALS     1
         3 001624   000000 620005                    EAX0    0,AL
         3 001625   000064 737000                    LLS     52
         3 001626   000140 135007                    SBLA    96,DL
         3 001627   200250 452500                    STP2    YES_NO+2,,AUTO
         3 001630   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 001631   000016 036003                    ADLQ    14,DU
         3 001632   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001633   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1425    16128    4            LEN = CMDCNT;

  16128  3 001634   200042 235100                    LDA     CMDCNT,,AUTO
         3 001635   200065 755100                    STA     LEN,,AUTO

     1426    16129    4            END;

     1427    16130    3         CLASS = C_TEXT;

  16130  3 001636   000001 236007                    LDQ     1,DL
         3 001637   200245 756100                    STQ     CLASS,,AUTO
         3 001640   003075 710000 3                  TRA     s:16463

     1428    16131
     1429    16132    3      CASE (L_CD_NATIVEL);

     1430    16133    4         IF CON$DREC.OCINFO.LANG = ' ' THEN DO;

  16133  3 001641   000000 470400 xsym               LDP0    DSEG3$
         3 001642   000034 236100                    LDQ     28,,PR0
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:257  
         3 001643   777000 376007                    ANQ     -512,DL
         3 001644   040000 116007                    CMPQ    16384,DL
         3 001645   001660 601000 3                  TNZ     s:16138

     1431    16134    4            FMT_VEC (FDS.NVECS# + 2) = VECTOR (NONE_STR) ;

  16134  3 001646   000011 236000 xsym               LDQ     FDS+9
         3 001647   000001 736000                    QLS     1
         3 001650   000000 620006                    EAX0    0,QL
         3 001651   000000 622006                    EAX2    0,QL
         3 001652   000044 237000 4                  LDAQ    36
         3 001653   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001654   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1432    16135    4            LEN = 4;

  16135  3 001655   000004 235007                    LDA     4,DL
         3 001656   200065 755100                    STA     LEN,,AUTO

     1433    16136    4            END;  /*  Blank  */

  16136  3 001657   001672 710000 3                  TRA     s:16141

     1434    16137    4         ELSE DO;

     1435    16138    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( CON$DREC.OCINFO.LANG );

  16138  3 001660   000011 236000 xsym               LDQ     FDS+9
         3 001661   000001 736000                    QLS     1
         3 001662   177640 235007                    LDA     65440,DL
         3 001663   000000 620006                    EAX0    0,QL
         3 001664   000000 236000 xsym               LDQ     DSEG3$
         3 001665   000047 036000 4                  ADLQ    39
         3 001666   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001667   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1436    16139    4            LEN = 1;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:258  

  16139  3 001670   000001 235007                    LDA     1,DL
         3 001671   200065 755100                    STA     LEN,,AUTO

     1437    16140    4            END;  /*  Not blank  */

     1438    16141    3         CLASS = C_TEXT;

  16141  3 001672   000001 236007                    LDQ     1,DL
         3 001673   200245 756100                    STQ     CLASS,,AUTO
         3 001674   003075 710000 3                  TRA     s:16463

     1439    16142
     1440    16143    3      CASE (L_CD_USE);

     1441    16144    4         DO CASE (L_TYPE);

  16144  3 001675   200066 236100                    LDQ     L_TYPE,,AUTO
         3 001676   000007 116007                    CMPQ    7,DL
         3 001677   001701 602006 3                  TNC     s:16144+4,QL
         3 001700   001757 710000 3                  TRA     s:16156
         3 001701   001757 710000 3                  TRA     s:16156
         3 001702   001710 710000 3                  TRA     s:16146
         3 001703   001720 710000 3                  TRA     s:16148
         3 001704   001730 710000 3                  TRA     s:16150
         3 001705   001740 710000 3                  TRA     s:16152
         3 001706   001757 710000 3                  TRA     s:16156
         3 001707   001750 710000 3                  TRA     s:16154

     1442    16145    4            CASE (L_OUT_DEV);

     1443    16146    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( OUT_STR);

  16146  3 001710   000011 235000 xsym               LDA     FDS+9
         3 001711   000001 735000                    ALS     1
         3 001712   000000 620005                    EAX0    0,AL
         3 001713   000000 622005                    EAX2    0,AL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:259  
         3 001714   000050 237000 4                  LDAQ    40
         3 001715   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001716   000005 756012 xsym               STQ     FMT_VEC+5,X2
         3 001717   001757 710000 3                  TRA     s:16156

     1444    16147    4            CASE (L_IN_DEV);

     1445    16148    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( IN_STR);

  16148  3 001720   000011 235000 xsym               LDA     FDS+9
         3 001721   000001 735000                    ALS     1
         3 001722   000000 620005                    EAX0    0,AL
         3 001723   000000 622005                    EAX2    0,AL
         3 001724   000052 237000 4                  LDAQ    42
         3 001725   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001726   000005 756012 xsym               STQ     FMT_VEC+5,X2
         3 001727   001757 710000 3                  TRA     s:16156

     1446    16149    4            CASE (L_CG_DEV);

     1447    16150    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( CG_STR);

  16150  3 001730   000011 235000 xsym               LDA     FDS+9
         3 001731   000001 735000                    ALS     1
         3 001732   000000 620005                    EAX0    0,AL
         3 001733   000000 622005                    EAX2    0,AL
         3 001734   000054 237000 4                  LDAQ    44
         3 001735   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001736   000005 756012 xsym               STQ     FMT_VEC+5,X2
         3 001737   001757 710000 3                  TRA     s:16156

     1448    16151    4            CASE (L_TP_DEV);

     1449    16152    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( TP_STR);

  16152  3 001740   000011 235000 xsym               LDA     FDS+9
         3 001741   000001 735000                    ALS     1
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:260  
         3 001742   000000 620005                    EAX0    0,AL
         3 001743   000000 622005                    EAX2    0,AL
         3 001744   000056 237000 4                  LDAQ    46
         3 001745   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001746   000005 756012 xsym               STQ     FMT_VEC+5,X2
         3 001747   001757 710000 3                  TRA     s:16156

     1450    16153    4            CASE (L_RES_DEV);

     1451    16154    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( RES_STR);

  16154  3 001750   000011 235000 xsym               LDA     FDS+9
         3 001751   000001 735000                    ALS     1
         3 001752   000000 620005                    EAX0    0,AL
         3 001753   000000 622005                    EAX2    0,AL
         3 001754   000060 237000 4                  LDAQ    48
         3 001755   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 001756   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1452    16155    4            END;

     1453    16156    3         CLASS = C_TEXT;

  16156  3 001757   000001 235007                    LDA     1,DL
         3 001760   200245 755100                    STA     CLASS,,AUTO

     1454    16157    3         LEN = 3;

  16157  3 001761   000003 236007                    LDQ     3,DL
         3 001762   200065 756100                    STQ     LEN,,AUTO
         3 001763   003075 710000 3                  TRA     s:16463

     1455    16158
     1456    16159    3      CASE (L_CD_TYPE);

     1457    16160    3         IF DEV_NAME.COUNT = 8 THEN

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:261  
  16160  3 001764   200043 236100                    LDQ     DEV_NAME,,AUTO
         3 001765   777000 376003                    ANQ     -512,DU
         3 001766   010000 116003                    CMPQ    4096,DU
         3 001767   002002 601000 3                  TNZ     s:16163

     1458    16161    3            FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(DEV_NAME.TEXT,0,2) );

  16161  3 001770   000011 235000 xsym               LDA     FDS+9
         3 001771   000001 735000                    ALS     1
         3 001772   000000 620005                    EAX0    0,AL
         3 001773   377640 235007                    LDA     130976,DL
         3 001774   200250 452500                    STP2    YES_NO+2,,AUTO
         3 001775   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 001776   000014 036000 4                  ADLQ    12
         3 001777   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002000   000005 756010 xsym               STQ     FMT_VEC+5,X0
         3 002001   002012 710000 3                  TRA     s:16164

     1459    16162    3         ELSE
     1460    16163    3            FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(KL$DREC.RENAME,0,2) );

  16163  3 002002   000011 235000 xsym               LDA     FDS+9
         3 002003   000001 735000                    ALS     1
         3 002004   000000 620005                    EAX0    0,AL
         3 002005   377640 235007                    LDA     130976,DL
         3 002006   000000 236000 xsym               LDQ     DSEG3$
         3 002007   000011 036003                    ADLQ    9,DU
         3 002010   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002011   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1461    16164    3         CLASS = C_TEXT;

  16164  3 002012   000001 235007                    LDA     1,DL
         3 002013   200245 755100                    STA     CLASS,,AUTO

     1462    16165    3         LEN = 2;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:262  
  16165  3 002014   000002 236007                    LDQ     2,DL
         3 002015   200065 756100                    STQ     LEN,,AUTO
         3 002016   003075 710000 3                  TRA     s:16463

     1463    16166
     1464    16167    3      CASE (L_CD_UPLOCK );

     1465    16168    3         YES_NO = OUT$DEV.OSINFO.UPLOCKED;

  16168  3 002017   000000 470400 xsym               LDP0    DSEG3$
         3 002020   000034 236100                    LDQ     28,,PR0
         3 002021   400000 376003                    ANQ     -131072,DU
         3 002022   200246 756100                    STQ     YES_NO,,AUTO

     1466    16169    3         CLASS = C_YESNO;

  16169  3 002023   000002 235007                    LDA     2,DL
         3 002024   200245 755100                    STA     CLASS,,AUTO

     1467    16170    3         LEN = 3;

  16170  3 002025   000003 235007                    LDA     3,DL
         3 002026   200065 755100                    STA     LEN,,AUTO
         3 002027   003075 710000 3                  TRA     s:16463

     1468    16171
     1469    16172    3      CASE (L_CD_FORM);

     1470    16173    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( OUT$DEV.OSINFO.FNAME );

  16173  3 002030   000011 236000 xsym               LDQ     FDS+9
         3 002031   000001 736000                    QLS     1
         3 002032   000012 235000 4                  LDA     10
         3 002033   000000 620006                    EAX0    0,QL
         3 002034   000000 236000 xsym               LDQ     DSEG3$
         3 002035   000035 036003                    ADLQ    29,DU
         3 002036   000004 755010 xsym               STA     FMT_VEC+4,X0
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:263  
         3 002037   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1471    16174    3         CLASS = C_TEXT;

  16174  3 002040   000001 235007                    LDA     1,DL
         3 002041   200245 755100                    STA     CLASS,,AUTO

     1472    16175    3         LEN = SIZEC (OUT$DEV.OSINFO.FNAME);

  16175  3 002042   000006 235007                    LDA     6,DL
         3 002043   200065 755100                    STA     LEN,,AUTO
         3 002044   003075 710000 3                  TRA     s:16463

     1473    16176
     1474    16177    3      CASE (L_CD_DEFPRIO);

     1475    16178    3         SBINS(SBIN_IDX + 1) = IN$DEV.ISINFO.DFPRI;

  16178  3 002045   000000 470400 xsym               LDP0    DSEG3$
         3 002046   000034 236100                    LDQ     28,,PR0
         3 002047   000011 772000                    QRL     9
         3 002050   000777 376007                    ANQ     511,DL
         3 002051   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 002052   200074 756110                    STQ     SBINS+1,X0,AUTO

     1476    16179    3         CLASS = C_SBIN;

  16179  3 002053   000014 235007                    LDA     12,DL
         3 002054   200245 755100                    STA     CLASS,,AUTO

     1477    16180    3         LEN = 3;

  16180  3 002055   000003 235007                    LDA     3,DL
         3 002056   200065 755100                    STA     LEN,,AUTO
         3 002057   003075 710000 3                  TRA     s:16463

     1478    16181
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:264  
     1479    16182    3      CASE (L_CD_NCTL);

     1480    16183    3         YES_NO = IN$DEV.ISINFO.NCTL;

  16183  3 002060   000000 470400 xsym               LDP0    DSEG3$
         3 002061   000034 236100                    LDQ     28,,PR0
         3 002062   400000 376003                    ANQ     -131072,DU
         3 002063   200246 756100                    STQ     YES_NO,,AUTO

     1481    16184    3         CLASS = C_YESNO;

  16184  3 002064   000002 235007                    LDA     2,DL
         3 002065   200245 755100                    STA     CLASS,,AUTO

     1482    16185    3         LEN = 3;

  16185  3 002066   000003 235007                    LDA     3,DL
         3 002067   200065 755100                    STA     LEN,,AUTO
         3 002070   003075 710000 3                  TRA     s:16463

     1483    16186
     1484    16187    3      CASE (L_CD_NCOK);

     1485    16188    3         YES_NO = IN$DEV.ISINFO.NCTLOK;

  16188  3 002071   000000 470400 xsym               LDP0    DSEG3$
         3 002072   000034 236100                    LDQ     28,,PR0
         3 002073   000001 736000                    QLS     1
         3 002074   400000 376003                    ANQ     -131072,DU
         3 002075   200246 756100                    STQ     YES_NO,,AUTO

     1486    16189    3         CLASS = C_YESNO;

  16189  3 002076   000002 235007                    LDA     2,DL
         3 002077   200245 755100                    STA     CLASS,,AUTO

     1487    16190    3         LEN = 3;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:265  

  16190  3 002100   000003 235007                    LDA     3,DL
         3 002101   200065 755100                    STA     LEN,,AUTO
         3 002102   003075 710000 3                  TRA     s:16463

     1488    16191
     1489    16192    3      CASE (L_CD_NCACCT);

     1490    16193    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( IN$DEV.ISINFO.NCACCT );

  16193  3 002103   000011 236000 xsym               LDQ     FDS+9
         3 002104   000001 736000                    QLS     1
         3 002105   000032 235000 4                  LDA     26
         3 002106   000000 620006                    EAX0    0,QL
         3 002107   000000 236000 xsym               LDQ     DSEG3$
         3 002110   000035 036003                    ADLQ    29,DU
         3 002111   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002112   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1491    16194    3         CLASS = C_TEXT;

  16194  3 002113   000001 235007                    LDA     1,DL
         3 002114   200245 755100                    STA     CLASS,,AUTO

     1492    16195    3         LEN = 12;

  16195  3 002115   000014 235007                    LDA     12,DL
         3 002116   200065 755100                    STA     LEN,,AUTO
         3 002117   003075 710000 3                  TRA     s:16463

     1493    16196
     1494    16197    3      CASE (L_CD_NCFID);

     1495    16198    3         CALL INDEX (LEN, AS_BLANK, IN$DEV.ISINFO.NFID);

  16198  3 002120   000000 470400 xsym               LDP0    DSEG3$
         3 002121   000000 124500                    SCM     mask='000'O
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:266  
         3 002122   000037 000120                    ADSC9   31,,PR0                  cn=0,n=80
         3 002123   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         3 002124   200065 000100                    ARG     LEN,,AUTO

     1496    16199    4         IF LEN = 0 THEN DO;

  16199  3 002125   200065 236100                    LDQ     LEN,,AUTO
         3 002126   002141 601000 3                  TNZ     s:16204

     1497    16200    4            FMT_VEC ( FDS.NVECS# + 2) = VECTOR (NONE_STR);

  16200  3 002127   000011 235000 xsym               LDA     FDS+9
         3 002130   000001 735000                    ALS     1
         3 002131   000000 620005                    EAX0    0,AL
         3 002132   000000 622005                    EAX2    0,AL
         3 002133   000044 237000 4                  LDAQ    36
         3 002134   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002135   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1498    16201    4            LEN = 4;

  16201  3 002136   000004 235007                    LDA     4,DL
         3 002137   200065 755100                    STA     LEN,,AUTO

     1499    16202    4            END;   /*  Blank fid  */

  16202  3 002140   002152 710000 3                  TRA     s:16205

     1500    16203    3         ELSE
     1501    16204    3            FMT_VEC(FDS.NVECS# + 2) = VECTOR(SUBSTR(IN$DEV.ISINFO.NFID,0,LEN));

  16204  3 002141   000011 235000 xsym               LDA     FDS+9
         3 002142   000001 735000                    ALS     1
         3 002143   000000 620005                    EAX0    0,AL
         3 002144   000064 737000                    LLS     52
         3 002145   000140 135007                    SBLA    96,DL
         3 002146   000000 236000 xsym               LDQ     DSEG3$
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:267  
         3 002147   000037 036003                    ADLQ    31,DU
         3 002150   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002151   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1502    16205    3         CLASS = C_TEXT;

  16205  3 002152   000001 235007                    LDA     1,DL
         3 002153   200245 755100                    STA     CLASS,,AUTO
         3 002154   003075 710000 3                  TRA     s:16463

     1503    16206
     1504    16207    3      CASE ( L_CD_COMGROUP );

     1505    16208    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(CG,0,CGCNT) );

  16208  3 002155   000011 236000 xsym               LDQ     FDS+9
         3 002156   000001 736000                    QLS     1
         3 002157   200015 235100                    LDA     CGCNT,,AUTO
         3 002160   000020 735000                    ALS     16
         3 002161   000140 135007                    SBLA    96,DL
         3 002162   200250 452500                    STP2    YES_NO+2,,AUTO
         3 002163   000000 620006                    EAX0    0,QL
         3 002164   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 002165   000005 036003                    ADLQ    5,DU
         3 002166   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002167   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1506    16209    3         CLASS = C_TEXT;

  16209  3 002170   000001 235007                    LDA     1,DL
         3 002171   200245 755100                    STA     CLASS,,AUTO

     1507    16210    3         LEN = CGCNT;

  16210  3 002172   200015 235100                    LDA     CGCNT,,AUTO
         3 002173   200065 755100                    STA     LEN,,AUTO
         3 002174   003075 710000 3                  TRA     s:16463
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:268  

     1508    16211
     1509    16212    3      CASE (L_CD_SNAME);

     1510    16213    4         IF KL$DREC.RENAME = ' ' THEN DO;

  16213  3 002175   000000 470400 xsym               LDP0    DSEG3$
         3 002176   040000 106500                    CMPC    fill='040'O
         3 002177   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         3 002200   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 002201   002214 601000 3                  TNZ     s:16218

     1511    16214    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( NONE_STR );

  16214  3 002202   000011 236000 xsym               LDQ     FDS+9
         3 002203   000001 736000                    QLS     1
         3 002204   000000 620006                    EAX0    0,QL
         3 002205   000000 622006                    EAX2    0,QL
         3 002206   000044 237000 4                  LDAQ    36
         3 002207   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002210   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1512    16215    4            LEN = SIZEC (NONE_STR);

  16215  3 002211   000004 235007                    LDA     4,DL
         3 002212   200065 755100                    STA     LEN,,AUTO

     1513    16216    4            END;

  16216  3 002213   002226 710000 3                  TRA     s:16221

     1514    16217    4         ELSE DO;

     1515    16218    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( KL$DREC.RENAME );

  16218  3 002214   000011 236000 xsym               LDQ     FDS+9
         3 002215   000001 736000                    QLS     1
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:269  
         3 002216   000032 235000 4                  LDA     26
         3 002217   000000 620006                    EAX0    0,QL
         3 002220   000000 236000 xsym               LDQ     DSEG3$
         3 002221   000011 036003                    ADLQ    9,DU
         3 002222   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002223   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1516    16219    4            LEN = SIZEC (KL$DREC.RENAME);

  16219  3 002224   000010 235007                    LDA     8,DL
         3 002225   200065 755100                    STA     LEN,,AUTO

     1517    16220    4            END;

     1518    16221    3         CLASS = C_TEXT;

  16221  3 002226   000001 236007                    LDQ     1,DL
         3 002227   200245 756100                    STQ     CLASS,,AUTO
         3 002230   003075 710000 3                  TRA     s:16463

     1519    16222
     1520    16223    3      CASE (L_CD_NOCG);

     1521    16224    3         IF KL$DREC.FLAGS.NOCGREJ THEN

  16224  3 002231   000000 470400 xsym               LDP0    DSEG3$
         3 002232   000000 236100                    LDQ     0,,PR0
         3 002233   000004 316003                    CANQ    4,DU
         3 002234   002247 600000 3                  TZE     s:16230

     1522    16225    4         DO;

     1523    16226    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( REJECT_STR );

  16226  3 002235   000011 235000 xsym               LDA     FDS+9
         3 002236   000001 735000                    ALS     1
         3 002237   000000 620005                    EAX0    0,AL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:270  
         3 002240   000000 622005                    EAX2    0,AL
         3 002241   000062 237000 4                  LDAQ    50
         3 002242   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002243   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1524    16227    4            LEN = 6;

  16227  3 002244   000006 235007                    LDA     6,DL
         3 002245   200065 755100                    STA     LEN,,AUTO

     1525    16228    4            END;

  16228  3 002246   002274 710000 3                  TRA     s:16239

     1526    16229    3         ELSE
     1527    16230    3            IF KL$DREC.FLAGS.NOCGINF THEN

  16230  3 002247   000002 316003                    CANQ    2,DU
         3 002250   002263 600000 3                  TZE     s:16236

     1528    16231    4            DO;

     1529    16232    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( INFORM_STR );

  16232  3 002251   000011 235000 xsym               LDA     FDS+9
         3 002252   000001 735000                    ALS     1
         3 002253   000000 620005                    EAX0    0,AL
         3 002254   000000 622005                    EAX2    0,AL
         3 002255   000064 237000 4                  LDAQ    52
         3 002256   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002257   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1530    16233    4               LEN = 6;

  16233  3 002260   000006 235007                    LDA     6,DL
         3 002261   200065 755100                    STA     LEN,,AUTO

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:271  
     1531    16234    4               END;

  16234  3 002262   002274 710000 3                  TRA     s:16239

     1532    16235    4            ELSE DO;

     1533    16236    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( OK_STR );

  16236  3 002263   000011 235000 xsym               LDA     FDS+9
         3 002264   000001 735000                    ALS     1
         3 002265   000000 620005                    EAX0    0,AL
         3 002266   000000 622005                    EAX2    0,AL
         3 002267   000066 237000 4                  LDAQ    54
         3 002270   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002271   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1534    16237    4               LEN = 2;

  16237  3 002272   000002 235007                    LDA     2,DL
         3 002273   200065 755100                    STA     LEN,,AUTO

     1535    16238    4               END;

     1536    16239    3         CLASS = C_TEXT;

  16239  3 002274   000001 236007                    LDQ     1,DL
         3 002275   200245 756100                    STQ     CLASS,,AUTO
         3 002276   003075 710000 3                  TRA     s:16463

     1537    16240
     1538    16241    3      CASE (L_CD_USER1);

     1539    16242    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER1;

  16242  3 002277   000000 470400 xsym               LDP0    DSEG3$
         3 002300   000034 235100                    LDA     28,,PR0
         3 002301   200237 720100                    LXL0    SBIN_IDX,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:272  
         3 002302   200074 755110                    STA     SBINS+1,X0,AUTO

     1540    16243    3         CLASS = C_SBIN;

  16243  3 002303   000014 236007                    LDQ     12,DL
         3 002304   200245 756100                    STQ     CLASS,,AUTO

     1541    16244    3         LEN = 11;

  16244  3 002305   000013 235007                    LDA     11,DL
         3 002306   200065 755100                    STA     LEN,,AUTO
         3 002307   003075 710000 3                  TRA     s:16463

     1542    16245
     1543    16246    3      CASE (L_CD_USER2);

     1544    16247    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER2;

  16247  3 002310   000000 470400 xsym               LDP0    DSEG3$
         3 002311   000035 235100                    LDA     29,,PR0
         3 002312   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 002313   200074 755110                    STA     SBINS+1,X0,AUTO

     1545    16248    3         CLASS = C_SBIN;

  16248  3 002314   000014 236007                    LDQ     12,DL
         3 002315   200245 756100                    STQ     CLASS,,AUTO

     1546    16249    3         LEN = 11;

  16249  3 002316   000013 235007                    LDA     11,DL
         3 002317   200065 755100                    STA     LEN,,AUTO
         3 002320   003075 710000 3                  TRA     s:16463

     1547    16250
     1548    16251    3      CASE (L_CD_USER3);

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:273  
     1549    16252    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER3;

  16252  3 002321   000000 470400 xsym               LDP0    DSEG3$
         3 002322   000036 235100                    LDA     30,,PR0
         3 002323   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 002324   200074 755110                    STA     SBINS+1,X0,AUTO

     1550    16253    3         CLASS = C_SBIN;

  16253  3 002325   000014 236007                    LDQ     12,DL
         3 002326   200245 756100                    STQ     CLASS,,AUTO

     1551    16254    3         LEN = 11;

  16254  3 002327   000013 235007                    LDA     11,DL
         3 002330   200065 755100                    STA     LEN,,AUTO
         3 002331   003075 710000 3                  TRA     s:16463

     1552    16255
     1553    16256    3      CASE (L_CD_USER4);

     1554    16257    3         SBINS(SBIN_IDX + 1) = CG$DEV.B$CGAUINFO.USER4;

  16257  3 002332   000000 470400 xsym               LDP0    DSEG3$
         3 002333   000037 235100                    LDA     31,,PR0
         3 002334   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 002335   200074 755110                    STA     SBINS+1,X0,AUTO

     1555    16258    3         CLASS = C_SBIN;

  16258  3 002336   000014 236007                    LDQ     12,DL
         3 002337   200245 756100                    STQ     CLASS,,AUTO

     1556    16259    3         LEN = 11;

  16259  3 002340   000013 235007                    LDA     11,DL
         3 002341   200065 755100                    STA     LEN,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:274  
         3 002342   003075 710000 3                  TRA     s:16463

     1557    16260
     1558    16261    3      CASE (L_CD_INSTANCE);

     1559    16262    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR( SUBSTR(INSTANCE,0,INSTANCECNT) );

  16262  3 002343   000011 236000 xsym               LDQ     FDS+9
         3 002344   000001 736000                    QLS     1
         3 002345   200064 235100                    LDA     INSTANCECNT,,AUTO
         3 002346   000020 735000                    ALS     16
         3 002347   000140 135007                    SBLA    96,DL
         3 002350   200250 452500                    STP2    YES_NO+2,,AUTO
         3 002351   000000 620006                    EAX0    0,QL
         3 002352   200250 236100                    LDQ     YES_NO+2,,AUTO
         3 002353   000057 036003                    ADLQ    47,DU
         3 002354   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002355   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1560    16263    3         CLASS = C_TEXT;

  16263  3 002356   000001 235007                    LDA     1,DL
         3 002357   200245 755100                    STA     CLASS,,AUTO

     1561    16264    3         LEN = INSTANCECNT;

  16264  3 002360   200064 235100                    LDA     INSTANCECNT,,AUTO
         3 002361   200065 755100                    STA     LEN,,AUTO
         3 002362   003075 710000 3                  TRA     s:16463

     1562    16265
     1563    16266    3      CASE (L_CD_PRIORITY);

     1564    16267    3         SBINS(SBIN_IDX + 1) = TP$DEV.QQ$LOGON.PRIO;

  16267  3 002363   000000 470400 xsym               LDP0    DSEG3$
         3 002364   000034 236100                    LDQ     28,,PR0
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:275  
         3 002365   000011 772000                    QRL     9
         3 002366   000777 376007                    ANQ     511,DL
         3 002367   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 002370   200074 756110                    STQ     SBINS+1,X0,AUTO

     1565    16268    3         CLASS = C_SBIN;

  16268  3 002371   000014 235007                    LDA     12,DL
         3 002372   200245 755100                    STA     CLASS,,AUTO

     1566    16269    3         LEN = 3;

  16269  3 002373   000003 235007                    LDA     3,DL
         3 002374   200065 755100                    STA     LEN,,AUTO
         3 002375   003075 710000 3                  TRA     s:16463

     1567    16270
     1568    16271    3      CASE (L_CD_MCT );

     1569    16272        /*  This chart will show the use and combination of these bits...
     1570    16273                     | mct | mctcmd | mctd |
     1571    16274              -------|-----|--------|------|
     1572    16275                 yes |  1  |   1    |  0   |
     1573    16276              -------|-----|--------|------|
     1574    16277                 no  |  0  |   0    |  0   |
     1575    16278              -------|-----|--------|------|
     1576    16279              command|  0  |   1    |  0   |
     1577    16280              -------|-----|--------|------|
     1578    16281              display|  0  |   0    |  1   |
     1579    16282              ------------------------------
     1580    16283        and that's that!!!
     1581    16284        */
     1582    16285
     1583    16286    3         IF TP$DEV.QQ$LOGON.MCT THEN

  16286  3 002376   000000 470400 xsym               LDP0    DSEG3$
         3 002377   000034 234100                    SZN     28,,PR0
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:276  
         3 002400   002413 605000 3                  TPL     s:16291

     1584    16287    4         DO;

     1585    16288    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR( YES_STR );

  16288  3 002401   000011 236000 xsym               LDQ     FDS+9
         3 002402   000001 736000                    QLS     1
         3 002403   000000 620006                    EAX0    0,QL
         3 002404   000000 622006                    EAX2    0,QL
         3 002405   000070 237000 4                  LDAQ    56
         3 002406   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002407   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1586    16289    4            LEN = 3;

  16289  3 002410   000003 235007                    LDA     3,DL
         3 002411   200065 755100                    STA     LEN,,AUTO

     1587    16290    4            END;

  16290  3 002412   002455 710000 3                  TRA     s:16305

     1588    16291    3         ELSE IF TP$DEV.QQ$LOGON.MCTD THEN

  16291  3 002413   000034 236100                    LDQ     28,,PR0
         3 002414   100000 316003                    CANQ    32768,DU
         3 002415   002430 600000 3                  TZE     s:16296

     1589    16292    4            DO;

     1590    16293    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR( DISPLAY_STR );

  16293  3 002416   000011 235000 xsym               LDA     FDS+9
         3 002417   000001 735000                    ALS     1
         3 002420   000000 620005                    EAX0    0,AL
         3 002421   000000 622005                    EAX2    0,AL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:277  
         3 002422   000072 237000 4                  LDAQ    58
         3 002423   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002424   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1591    16294    4               LEN = 7;

  16294  3 002425   000007 235007                    LDA     7,DL
         3 002426   200065 755100                    STA     LEN,,AUTO

     1592    16295    4               END;

  16295  3 002427   002455 710000 3                  TRA     s:16305

     1593    16296    3            ELSE IF TP$DEV.QQ$LOGON.MCTCMD THEN

  16296  3 002430   200000 316003                    CANQ    65536,DU
         3 002431   002444 600000 3                  TZE     s:16302

     1594    16297    4               DO;

     1595    16298    4                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( COMMANDS_STR );

  16298  3 002432   000011 235000 xsym               LDA     FDS+9
         3 002433   000001 735000                    ALS     1
         3 002434   000000 620005                    EAX0    0,AL
         3 002435   000000 622005                    EAX2    0,AL
         3 002436   000074 237000 4                  LDAQ    60
         3 002437   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002440   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1596    16299    4                  LEN = 8;

  16299  3 002441   000010 235007                    LDA     8,DL
         3 002442   200065 755100                    STA     LEN,,AUTO

     1597    16300    4                  END;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:278  
  16300  3 002443   002455 710000 3                  TRA     s:16305

     1598    16301    4               ELSE DO;

     1599    16302    4                  FMT_VEC(FDS.NVECS# + 2) = VECTOR( NO_STR );

  16302  3 002444   000011 235000 xsym               LDA     FDS+9
         3 002445   000001 735000                    ALS     1
         3 002446   000000 620005                    EAX0    0,AL
         3 002447   000000 622005                    EAX2    0,AL
         3 002450   000076 237000 4                  LDAQ    62
         3 002451   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002452   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1600    16303    4                  LEN = 2;

  16303  3 002453   000002 235007                    LDA     2,DL
         3 002454   200065 755100                    STA     LEN,,AUTO

     1601    16304    4                  END;

     1602    16305    3         CLASS = C_TEXT;

  16305  3 002455   000001 236007                    LDQ     1,DL
         3 002456   200245 756100                    STQ     CLASS,,AUTO
         3 002457   003075 710000 3                  TRA     s:16463

     1603    16306
     1604    16307    3      CASE ( L_CD_MODE );

     1605    16308
     1606    16309    4         DO CASE (RESCL$DREC.CL_DEV.MODE);

  16309  3 002460   000000 470400 xsym               LDP0    DSEG3$
         3 002461   000020 236100                    LDQ     16,,PR0
         3 002462   000033 772000                    QRL     27
         3 002463   000004 116007                    CMPQ    4,DL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:279  
         3 002464   002466 602006 3                  TNC     s:16309+6,QL
         3 002465   002530 710000 3                  TRA     s:16328
         3 002466   002530 710000 3                  TRA     s:16328
         3 002467   002472 710000 3                  TRA     s:16313
         3 002470   002504 710000 3                  TRA     s:16318
         3 002471   002516 710000 3                  TRA     s:16323

     1607    16310
     1608    16311    4            CASE (%KL_DEVMODE_INCOMING#);

     1609    16312
     1610    16313    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (INCOMING_STR);

  16313  3 002472   000011 235000 xsym               LDA     FDS+9
         3 002473   000001 735000                    ALS     1
         3 002474   000000 620005                    EAX0    0,AL
         3 002475   000000 622005                    EAX2    0,AL
         3 002476   000100 237000 4                  LDAQ    64
         3 002477   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002500   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1611    16314    4               LEN = LENGTHC (INCOMING_STR);

  16314  3 002501   000011 235007                    LDA     9,DL
         3 002502   200065 755100                    STA     LEN,,AUTO
         3 002503   002541 710000 3                  TRA     s:16333

     1612    16315
     1613    16316    4            CASE (%KL_DEVMODE_OUTGOING#);

     1614    16317
     1615    16318    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (OUTGOING_STR);

  16318  3 002504   000011 235000 xsym               LDA     FDS+9
         3 002505   000001 735000                    ALS     1
         3 002506   000000 620005                    EAX0    0,AL
         3 002507   000000 622005                    EAX2    0,AL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:280  
         3 002510   000102 237000 4                  LDAQ    66
         3 002511   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002512   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1616    16319    4               LEN = LENGTHC (OUTGOING_STR);

  16319  3 002513   000010 235007                    LDA     8,DL
         3 002514   200065 755100                    STA     LEN,,AUTO
         3 002515   002541 710000 3                  TRA     s:16333

     1617    16320
     1618    16321    4            CASE (%KL_DEVMODE_FIXED#);

     1619    16322
     1620    16323    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (FIXED_STR);

  16323  3 002516   000011 235000 xsym               LDA     FDS+9
         3 002517   000001 735000                    ALS     1
         3 002520   000000 620005                    EAX0    0,AL
         3 002521   000000 622005                    EAX2    0,AL
         3 002522   000104 237000 4                  LDAQ    68
         3 002523   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002524   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1621    16324    4               LEN = LENGTHC (FIXED_STR);

  16324  3 002525   000005 235007                    LDA     5,DL
         3 002526   200065 755100                    STA     LEN,,AUTO
         3 002527   002541 710000 3                  TRA     s:16333

     1622    16325
     1623    16326    4            CASE (ELSE);

     1624    16327
     1625    16328    4               FMT_VEC(FDS.NVECS# + 2) = VECTOR (NONE_STR);

  16328  3 002530   000011 235000 xsym               LDA     FDS+9
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:281  
         3 002531   000001 735000                    ALS     1
         3 002532   000000 620005                    EAX0    0,AL
         3 002533   000000 622005                    EAX2    0,AL
         3 002534   000044 237000 4                  LDAQ    36
         3 002535   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002536   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1626    16329    4               LEN = LENGTHC (NONE_STR);

  16329  3 002537   000004 235007                    LDA     4,DL
         3 002540   200065 755100                    STA     LEN,,AUTO

     1627    16330
     1628    16331    4            END; /*  Do case mode  */

     1629    16332
     1630    16333    3         CLASS = C_TEXT;

  16333  3 002541   000001 236007                    LDQ     1,DL
         3 002542   200245 756100                    STQ     CLASS,,AUTO
         3 002543   003075 710000 3                  TRA     s:16463

     1631    16334
     1632    16335    3      CASE ( L_CD_RNAME );

     1633    16336
     1634    16337    3         FMT_VEC(FDS.NVECS# + 2) = VECTOR (RESCL$DREC.CL_DEV.RNAME);

  16337  3 002544   000011 236000 xsym               LDQ     FDS+9
         3 002545   000001 736000                    QLS     1
         3 002546   000012 235000 4                  LDA     10
         3 002547   000000 620006                    EAX0    0,QL
         3 002550   000000 236000 xsym               LDQ     DSEG3$
         3 002551   000106 036000 4                  ADLQ    70
         3 002552   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002553   000005 756010 xsym               STQ     FMT_VEC+5,X0

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:282  
     1635    16338    3         LEN = LENGTHC (RESCL$DREC.CL_DEV.RNAME);

  16338  3 002554   000006 235007                    LDA     6,DL
         3 002555   200065 755100                    STA     LEN,,AUTO

     1636    16339    3         CLASS = C_TEXT;

  16339  3 002556   000001 235007                    LDA     1,DL
         3 002557   200245 755100                    STA     CLASS,,AUTO
         3 002560   003075 710000 3                  TRA     s:16463

     1637    16340
     1638    16341    3      CASE ( L_CD_AUACCT );

     1639    16342
     1640    16343    4         IF RESCL$DREC.CL_DEV.AUACCOUNT = ' ' THEN DO;

  16343  3 002561   000000 470400 xsym               LDP0    DSEG3$
         3 002562   040000 106500                    CMPC    fill='040'O
         3 002563   000022 200010                    ADSC9   18,,PR0                  cn=1,n=8
         3 002564   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         3 002565   002600 601000 3                  TNZ     s:16348

     1641    16344    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR ( NONE_STR );

  16344  3 002566   000011 236000 xsym               LDQ     FDS+9
         3 002567   000001 736000                    QLS     1
         3 002570   000000 620006                    EAX0    0,QL
         3 002571   000000 622006                    EAX2    0,QL
         3 002572   000044 237000 4                  LDAQ    36
         3 002573   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002574   000005 756012 xsym               STQ     FMT_VEC+5,X2

     1642    16345    4            LEN = 4;

  16345  3 002575   000004 235007                    LDA     4,DL
         3 002576   200065 755100                    STA     LEN,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:283  

     1643    16346    4            END;  /*  Blank  */

  16346  3 002577   002612 710000 3                  TRA     s:16351

     1644    16347    4         ELSE DO;

     1645    16348    4            FMT_VEC(FDS.NVECS# + 2) = VECTOR (RESCL$DREC.CL_DEV.AUACCOUNT);

  16348  3 002600   000011 236000 xsym               LDQ     FDS+9
         3 002601   000001 736000                    QLS     1
         3 002602   000032 235000 4                  LDA     26
         3 002603   000000 620006                    EAX0    0,QL
         3 002604   000000 236000 xsym               LDQ     DSEG3$
         3 002605   000107 036000 4                  ADLQ    71
         3 002606   000004 755010 xsym               STA     FMT_VEC+4,X0
         3 002607   000005 756010 xsym               STQ     FMT_VEC+5,X0

     1646    16349    4            LEN = LENGTHC (RESCL$DREC.CL_DEV.AUACCOUNT);

  16349  3 002610   000010 235007                    LDA     8,DL
         3 002611   200065 755100                    STA     LEN,,AUTO

     1647    16350    4            END;  /*  Non blank  */

     1648    16351    3         CLASS = C_TEXT;

  16351  3 002612   000001 236007                    LDQ     1,DL
         3 002613   200245 756100                    STQ     CLASS,,AUTO
         3 002614   003075 710000 3                  TRA     s:16463

     1649    16352
     1650    16353    3      CASE ( L_CD_B300 );

     1651    16354
     1652    16355    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.B300#;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:284  
  16355  3 002615   000000 470400 xsym               LDP0    DSEG3$
         3 002616   000020 236100                    LDQ     16,,PR0
         3 002617   000011 736000                    QLS     9
         3 002620   400000 376003                    ANQ     -131072,DU
         3 002621   200246 756100                    STQ     YES_NO,,AUTO

     1653    16356    3         GOTO CHECK_TCPIP_ATTR;

  16356  3 002622   002636 710000 3                  TRA     CHECK_TCPIP_ATTR

     1654    16357
     1655    16358    3      CASE ( L_CD_B1200 );

     1656    16359
     1657    16360    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.B1200#;

  16360  3 002623   000000 470400 xsym               LDP0    DSEG3$
         3 002624   000020 236100                    LDQ     16,,PR0
         3 002625   000012 736000                    QLS     10
         3 002626   400000 376003                    ANQ     -131072,DU
         3 002627   200246 756100                    STQ     YES_NO,,AUTO

     1658    16361    3         GOTO CHECK_TCPIP_ATTR;

  16361  3 002630   002636 710000 3                  TRA     CHECK_TCPIP_ATTR

     1659    16362
     1660    16363    3      CASE ( L_CD_B2400 );

     1661    16364
     1662    16365    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.B2400#;

  16365  3 002631   000000 470400 xsym               LDP0    DSEG3$
         3 002632   000020 236100                    LDQ     16,,PR0
         3 002633   000013 736000                    QLS     11
         3 002634   400000 376003                    ANQ     -131072,DU
         3 002635   200246 756100                    STQ     YES_NO,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:285  

  16365  3 002636                       CHECK_TCPIP* null
     1663    16366    3   CHECK_TCPIP_ATTR: ;
     1664    16367    3         IF RESCL$DREC.CL_DEV.ATTR.TCPIP# THEN

  16367  3 002636   000020 236100                    LDQ     16,,PR0
         3 002637   000004 316003                    CANQ    4,DU
         3 002640   002643 600000 3                  TZE     s:16369

     1665    16368    3            NEXT = NEXT + L_CD_TCP_PRIV - L_CD_B300; /* Show tcpip names */

  16368  3 002641   000022 236007                    LDQ     18,DL
         3 002642   200070 056100                    ASQ     NEXT,,AUTO

     1666    16369    3         CLASS = C_YESNO;

  16369  3 002643   000002 235007                    LDA     2,DL
         3 002644   200245 755100                    STA     CLASS,,AUTO

     1667    16370    3         LEN = 3;

  16370  3 002645   000003 236007                    LDQ     3,DL
         3 002646   200065 756100                    STQ     LEN,,AUTO
         3 002647   003075 710000 3                  TRA     s:16463

     1668    16371
     1669    16372    3      CASE ( L_CD_HAYES );

     1670    16373
     1671    16374    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.HAYES#;

  16374  3 002650   000000 470400 xsym               LDP0    DSEG3$
         3 002651   000020 236100                    LDQ     16,,PR0
         3 002652   000014 736000                    QLS     12
         3 002653   400000 376003                    ANQ     -131072,DU
         3 002654   200246 756100                    STQ     YES_NO,,AUTO

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:286  
     1672    16375    3         CLASS = C_YESNO;

  16375  3 002655   000002 235007                    LDA     2,DL
         3 002656   200245 755100                    STA     CLASS,,AUTO

     1673    16376    3         LEN = 3;

  16376  3 002657   000003 235007                    LDA     3,DL
         3 002660   200065 755100                    STA     LEN,,AUTO
         3 002661   003075 710000 3                  TRA     s:16463

     1674    16377
     1675    16378    3      CASE ( L_CD_X28 );

     1676    16379
     1677    16380    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.X28#;

  16380  3 002662   000000 470400 xsym               LDP0    DSEG3$
         3 002663   000020 236100                    LDQ     16,,PR0
         3 002664   000015 736000                    QLS     13
         3 002665   400000 376003                    ANQ     -131072,DU
         3 002666   200246 756100                    STQ     YES_NO,,AUTO

     1678    16381    3         CLASS = C_YESNO;

  16381  3 002667   000002 235007                    LDA     2,DL
         3 002670   200245 755100                    STA     CLASS,,AUTO

     1679    16382    3         LEN = 3;

  16382  3 002671   000003 235007                    LDA     3,DL
         3 002672   200065 755100                    STA     LEN,,AUTO
         3 002673   003075 710000 3                  TRA     s:16463

     1680    16383
     1681    16384    3      CASE ( L_CD_RFU1 );

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:287  
     1682    16385
     1683    16386    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU1#;

  16386  3 002674   000000 470400 xsym               LDP0    DSEG3$
         3 002675   000020 236100                    LDQ     16,,PR0
         3 002676   000032 736000                    QLS     26
         3 002677   400000 376003                    ANQ     -131072,DU
         3 002700   200246 756100                    STQ     YES_NO,,AUTO

     1684    16387    3         CLASS = C_YESNO;

  16387  3 002701   000002 235007                    LDA     2,DL
         3 002702   200245 755100                    STA     CLASS,,AUTO

     1685    16388    3         LEN = 3;

  16388  3 002703   000003 235007                    LDA     3,DL
         3 002704   200065 755100                    STA     LEN,,AUTO
         3 002705   003075 710000 3                  TRA     s:16463

     1686    16389
     1687    16390    3      CASE ( L_CD_RFU2 );

     1688    16391
     1689    16392    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU2#;

  16392  3 002706   000000 470400 xsym               LDP0    DSEG3$
         3 002707   000020 236100                    LDQ     16,,PR0
         3 002710   000031 736000                    QLS     25
         3 002711   400000 376003                    ANQ     -131072,DU
         3 002712   200246 756100                    STQ     YES_NO,,AUTO

     1690    16393    3         CLASS = C_YESNO;

  16393  3 002713   000002 235007                    LDA     2,DL
         3 002714   200245 755100                    STA     CLASS,,AUTO

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:288  
     1691    16394    3         LEN = 3;

  16394  3 002715   000003 235007                    LDA     3,DL
         3 002716   200065 755100                    STA     LEN,,AUTO
         3 002717   003075 710000 3                  TRA     s:16463

     1692    16395
     1693    16396    3      CASE ( L_CD_RFU3 );

     1694    16397
     1695    16398    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU3#;

  16398  3 002720   000000 470400 xsym               LDP0    DSEG3$
         3 002721   000020 236100                    LDQ     16,,PR0
         3 002722   000030 736000                    QLS     24
         3 002723   400000 376003                    ANQ     -131072,DU
         3 002724   200246 756100                    STQ     YES_NO,,AUTO

     1696    16399    3         CLASS = C_YESNO;

  16399  3 002725   000002 235007                    LDA     2,DL
         3 002726   200245 755100                    STA     CLASS,,AUTO

     1697    16400    3         LEN = 3;

  16400  3 002727   000003 235007                    LDA     3,DL
         3 002730   200065 755100                    STA     LEN,,AUTO
         3 002731   003075 710000 3                  TRA     s:16463

     1698    16401
     1699    16402    3      CASE ( L_CD_RFU4 );

     1700    16403
     1701    16404    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU4#;

  16404  3 002732   000000 470400 xsym               LDP0    DSEG3$
         3 002733   000020 236100                    LDQ     16,,PR0
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:289  
         3 002734   000027 736000                    QLS     23
         3 002735   400000 376003                    ANQ     -131072,DU
         3 002736   200246 756100                    STQ     YES_NO,,AUTO

     1702    16405    3         CLASS = C_YESNO;

  16405  3 002737   000002 235007                    LDA     2,DL
         3 002740   200245 755100                    STA     CLASS,,AUTO

     1703    16406    3         LEN = 3;

  16406  3 002741   000003 235007                    LDA     3,DL
         3 002742   200065 755100                    STA     LEN,,AUTO
         3 002743   003075 710000 3                  TRA     s:16463

     1704    16407
     1705    16408    3      CASE ( L_CD_RFU5 );

     1706    16409
     1707    16410    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU5#;

  16410  3 002744   000000 470400 xsym               LDP0    DSEG3$
         3 002745   000020 236100                    LDQ     16,,PR0
         3 002746   000026 736000                    QLS     22
         3 002747   400000 376003                    ANQ     -131072,DU
         3 002750   200246 756100                    STQ     YES_NO,,AUTO

     1708    16411    3         CLASS = C_YESNO;

  16411  3 002751   000002 235007                    LDA     2,DL
         3 002752   200245 755100                    STA     CLASS,,AUTO

     1709    16412    3         LEN = 3;

  16412  3 002753   000003 235007                    LDA     3,DL
         3 002754   200065 755100                    STA     LEN,,AUTO
         3 002755   003075 710000 3                  TRA     s:16463
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:290  

     1710    16413
     1711    16414    3      CASE ( L_CD_RFU6 );

     1712    16415
     1713    16416    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU6#;

  16416  3 002756   000000 470400 xsym               LDP0    DSEG3$
         3 002757   000020 236100                    LDQ     16,,PR0
         3 002760   000025 736000                    QLS     21
         3 002761   400000 376003                    ANQ     -131072,DU
         3 002762   200246 756100                    STQ     YES_NO,,AUTO

     1714    16417    3         CLASS = C_YESNO;

  16417  3 002763   000002 235007                    LDA     2,DL
         3 002764   200245 755100                    STA     CLASS,,AUTO

     1715    16418    3         LEN = 3;

  16418  3 002765   000003 235007                    LDA     3,DL
         3 002766   200065 755100                    STA     LEN,,AUTO
         3 002767   003075 710000 3                  TRA     s:16463

     1716    16419
     1717    16420    3      CASE ( L_CD_RFU7 );

     1718    16421
     1719    16422    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU7#;

  16422  3 002770   000000 470400 xsym               LDP0    DSEG3$
         3 002771   000020 236100                    LDQ     16,,PR0
         3 002772   000024 736000                    QLS     20
         3 002773   400000 376003                    ANQ     -131072,DU
         3 002774   200246 756100                    STQ     YES_NO,,AUTO

     1720    16423    3         CLASS = C_YESNO;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:291  

  16423  3 002775   000002 235007                    LDA     2,DL
         3 002776   200245 755100                    STA     CLASS,,AUTO

     1721    16424    3         LEN = 3;

  16424  3 002777   000003 235007                    LDA     3,DL
         3 003000   200065 755100                    STA     LEN,,AUTO
         3 003001   003075 710000 3                  TRA     s:16463

     1722    16425
     1723    16426    3      CASE ( L_CD_RFU8 );

     1724    16427
     1725    16428    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU8#;

  16428  3 003002   000000 470400 xsym               LDP0    DSEG3$
         3 003003   000020 236100                    LDQ     16,,PR0
         3 003004   000023 736000                    QLS     19
         3 003005   400000 376003                    ANQ     -131072,DU
         3 003006   200246 756100                    STQ     YES_NO,,AUTO

     1726    16429    3         CLASS = C_YESNO;

  16429  3 003007   000002 235007                    LDA     2,DL
         3 003010   200245 755100                    STA     CLASS,,AUTO

     1727    16430    3         LEN = 3;

  16430  3 003011   000003 235007                    LDA     3,DL
         3 003012   200065 755100                    STA     LEN,,AUTO
         3 003013   003075 710000 3                  TRA     s:16463

     1728    16431
     1729    16432    3      CASE ( L_CD_RFU9 );

     1730    16433
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:292  
     1731    16434    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU9#;

  16434  3 003014   000000 470400 xsym               LDP0    DSEG3$
         3 003015   000020 236100                    LDQ     16,,PR0
         3 003016   000022 736000                    QLS     18
         3 003017   400000 376003                    ANQ     -131072,DU
         3 003020   200246 756100                    STQ     YES_NO,,AUTO

     1732    16435    3         CLASS = C_YESNO;

  16435  3 003021   000002 235007                    LDA     2,DL
         3 003022   200245 755100                    STA     CLASS,,AUTO

     1733    16436    3         LEN = 3;

  16436  3 003023   000003 235007                    LDA     3,DL
         3 003024   200065 755100                    STA     LEN,,AUTO
         3 003025   003075 710000 3                  TRA     s:16463

     1734    16437
     1735    16438    3      CASE ( L_CD_RFU10 );

     1736    16439
     1737    16440    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU10#;

  16440  3 003026   000000 470400 xsym               LDP0    DSEG3$
         3 003027   000020 236100                    LDQ     16,,PR0
         3 003030   000021 736000                    QLS     17
         3 003031   400000 376003                    ANQ     -131072,DU
         3 003032   200246 756100                    STQ     YES_NO,,AUTO

     1738    16441    3         CLASS = C_YESNO;

  16441  3 003033   000002 235007                    LDA     2,DL
         3 003034   200245 755100                    STA     CLASS,,AUTO

     1739    16442    3         LEN = 3;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:293  

  16442  3 003035   000003 235007                    LDA     3,DL
         3 003036   200065 755100                    STA     LEN,,AUTO
         3 003037   003075 710000 3                  TRA     s:16463

     1740    16443
     1741    16444    3      CASE ( L_CD_RFU11 );

     1742    16445
     1743    16446    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU11#;

  16446  3 003040   000000 470400 xsym               LDP0    DSEG3$
         3 003041   000020 236100                    LDQ     16,,PR0
         3 003042   000020 736000                    QLS     16
         3 003043   400000 376003                    ANQ     -131072,DU
         3 003044   200246 756100                    STQ     YES_NO,,AUTO

     1744    16447    3         CLASS = C_YESNO;

  16447  3 003045   000002 235007                    LDA     2,DL
         3 003046   200245 755100                    STA     CLASS,,AUTO

     1745    16448    3         LEN = 3;

  16448  3 003047   000003 235007                    LDA     3,DL
         3 003050   200065 755100                    STA     LEN,,AUTO
         3 003051   003075 710000 3                  TRA     s:16463

     1746    16449
     1747    16450    3      CASE ( L_CD_TCPIP );

     1748    16451
     1749    16452    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.TCPIP#;

  16452  3 003052   000000 470400 xsym               LDP0    DSEG3$
         3 003053   000020 236100                    LDQ     16,,PR0
         3 003054   000017 736000                    QLS     15
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:294  
         3 003055   400000 376003                    ANQ     -131072,DU
         3 003056   200246 756100                    STQ     YES_NO,,AUTO

     1750    16453    3         CLASS = C_YESNO;

  16453  3 003057   000002 235007                    LDA     2,DL
         3 003060   200245 755100                    STA     CLASS,,AUTO

     1751    16454    3         LEN = 3;

  16454  3 003061   000003 235007                    LDA     3,DL
         3 003062   200065 755100                    STA     LEN,,AUTO
         3 003063   003075 710000 3                  TRA     s:16463

     1752    16455
     1753    16456    3      CASE ( L_CD_RFU13 );

     1754    16457
     1755    16458    3         YES_NO = RESCL$DREC.CL_DEV.ATTR.RFU13#;

  16458  3 003064   000000 470400 xsym               LDP0    DSEG3$
         3 003065   000020 236100                    LDQ     16,,PR0
         3 003066   000016 736000                    QLS     14
         3 003067   400000 376003                    ANQ     -131072,DU
         3 003070   200246 756100                    STQ     YES_NO,,AUTO

     1756    16459    3         CLASS = C_YESNO;

  16459  3 003071   000002 235007                    LDA     2,DL
         3 003072   200245 755100                    STA     CLASS,,AUTO

     1757    16460    3         LEN = 3;

  16460  3 003073   000003 235007                    LDA     3,DL
         3 003074   200065 755100                    STA     LEN,,AUTO

     1758    16461
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:295  
     1759    16462    3      END;                           /* End case ... finally               */

     1760    16463    2   SBINS (SBIN_IDX) = LEN + SIZEC (OPT_TBL.HDR(NEXT));

  16463  3 003075   200237 720100                    LXL0    SBIN_IDX,,AUTO
         3 003076   200065 235100                    LDA     LEN,,AUTO
         3 003077   000022 035007                    ADLA    18,DL
         3 003100   200073 755110                    STA     SBINS,X0,AUTO

     1761    16464    2   FMT_VEC (FDS.NVECS#) = VECTOR (SBINS(SBIN_IDX));

  16464  3 003101   000011 236000 xsym               LDQ     FDS+9
         3 003102   000001 736000                    QLS     1
         3 003103   777640 235007                    LDA     -96,DL
         3 003104   200250 452500                    STP2    YES_NO+2,,AUTO
         3 003105   000000 621006                    EAX1    0,QL
         3 003106   200237 236100                    LDQ     SBIN_IDX,,AUTO
         3 003107   000022 736000                    QLS     18
         3 003110   000073 036003                    ADLQ    59,DU
         3 003111   200250 036100                    ADLQ    YES_NO+2,,AUTO
         3 003112   000000 755011 xsym               STA     FMT_VEC,X1
         3 003113   000001 756011 xsym               STQ     FMT_VEC+1,X1

     1762    16465    2   FMT_VEC (FDS.NVECS#+1) = VECTOR (OPT_TBL.HDR(NEXT));

  16465  3 003114   000110 235000 4                  LDA     72
         3 003115   200070 236100                    LDQ     NEXT,,AUTO
         3 003116   200250 755100                    STA     YES_NO+2,,AUTO
         3 003117   000112 402000 4                  MPY     74
         3 003120   000111 036000 4                  ADLQ    73
         3 003121   200250 235100                    LDA     YES_NO+2,,AUTO
         3 003122   000002 755011 xsym               STA     FMT_VEC+2,X1
         3 003123   000003 756011 xsym               STQ     FMT_VEC+3,X1

     1763    16466    2   FDS.NVECS# = FDS.NVECS# + 2;

  16466  3 003124   000002 236007                    LDQ     2,DL
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:296  
         3 003125   000011 056000 xsym               ASQ     FDS+9

     1764    16467    2   SBIN_IDX = SBIN_IDX + 1;

  16467  3 003126   200237 054100                    AOS     SBIN_IDX,,AUTO

     1765    16468    2   SUBSTR (FMT_BUF, FDS.FMT_.BOUND+1,5) = '%NR%A';

  16468  3 003127   000000 236000 xsym               LDQ     FDS
         3 003130   000020 772000                    QRL     16
         3 003131   040006 100400                    MLR     fill='040'O
         3 003132   000641 000005 2                  ADSC9   YES_STR+26               cn=0,n=5
         3 003133   000000 200005 xsym               ADSC9   FMT_BUF,Q                cn=1,n=5

     1766    16469    2   FDS.FMT_.BOUND = FDS.FMT_.BOUND + 5;

  16469  3 003134   000005 036007                    ADLQ    5,DL
         3 003135   000020 736000                    QLS     16
         3 003136   000000 676000 xsym               ERQ     FDS
         3 003137   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003140   000000 656000 xsym               ERSQ    FDS

     1767    16470    3   DO SELECT (CLASS);

  16470  3 003141   200245 236100                    LDQ     CLASS,,AUTO
         3 003142   000002 116007                    CMPQ    2,DL
         3 003143   003156 604000 3                  TMI     s:16470+13
         3 003144   003225 600000 3                  TZE     s:16482
         3 003145   000005 116007                    CMPQ    5,DL
         3 003146   003153 604000 3                  TMI     s:16470+10
         3 003147   003347 600000 3                  TZE     s:16504
         3 003150   000014 116007                    CMPQ    12,DL
         3 003151   003363 601000 3                  TNZ     s:16508
         3 003152   003175 710000 3                  TRA     s:16476
         3 003153   000004 116007                    CMPQ    4,DL
         3 003154   003363 601000 3                  TNZ     s:16508
         3 003155   003262 710000 3                  TRA     s:16490
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:297  
         3 003156   000001 116007                    CMPQ    1,DL
         3 003157   003363 601000 3                  TNZ     s:16508
         3 003160   003161 710000 3                  TRA     s:16472

     1768    16471    3      SELECT (C_TEXT);

     1769    16472    3      FDS.NVECS# = FDS.NVECS# + 1;

  16472  3 003161   000011 054000 xsym               AOS     FDS+9

     1770    16473    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%>A');

  16473  3 003162   000000 236000 xsym               LDQ     FDS
         3 003163   000020 772000                    QRL     16
         3 003164   040006 100400                    MLR     fill='040'O
         3 003165   000643 000003 2                  ADSC9   YES_STR+28               cn=0,n=3
         3 003166   000000 200003 xsym               ADSC9   FMT_BUF,Q                cn=1,n=3

     1771    16474    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;

  16474  3 003167   000003 036007                    ADLQ    3,DL
         3 003170   000020 736000                    QLS     16
         3 003171   000000 676000 xsym               ERQ     FDS
         3 003172   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003173   000000 656000 xsym               ERSQ    FDS
         3 003174   003363 710000 3                  TRA     s:16508

     1772    16475    3      SELECT (C_SBIN);

     1773    16476    3      FMT_VEC(FDS.NVECS#) = VECTOR(SBINS(SBIN_IDX));

  16476  3 003175   000011 235000 xsym               LDA     FDS+9
         3 003176   000001 735000                    ALS     1
         3 003177   000000 620005                    EAX0    0,AL
         3 003200   777640 235007                    LDA     -96,DL
         3 003201   200250 452500                    STP2    YES_NO+2,,AUTO
         3 003202   200237 236100                    LDQ     SBIN_IDX,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:298  
         3 003203   000022 736000                    QLS     18
         3 003204   000073 036003                    ADLQ    59,DU
         3 003205   200250 036100                    ADLQ    YES_NO+2,,AUTO
         3 003206   000000 755010 xsym               STA     FMT_VEC,X0
         3 003207   000001 756010 xsym               STQ     FMT_VEC+1,X0

     1774    16477    3      FDS.NVECS# = FDS.NVECS# + 1;

  16477  3 003210   000011 054000 xsym               AOS     FDS+9

     1775    16478    3      SBIN_IDX = SBIN_IDX + 1;

  16478  3 003211   200237 054100                    AOS     SBIN_IDX,,AUTO

     1776    16479    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%+D');

  16479  3 003212   000000 236000 xsym               LDQ     FDS
         3 003213   000020 772000                    QRL     16
         3 003214   040006 100400                    MLR     fill='040'O
         3 003215   000644 000003 2                  ADSC9   YES_STR+29               cn=0,n=3
         3 003216   000000 200003 xsym               ADSC9   FMT_BUF,Q                cn=1,n=3

     1777    16480    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;

  16480  3 003217   000003 036007                    ADLQ    3,DL
         3 003220   000020 736000                    QLS     16
         3 003221   000000 676000 xsym               ERQ     FDS
         3 003222   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003223   000000 656000 xsym               ERSQ    FDS
         3 003224   003363 710000 3                  TRA     s:16508

     1778    16481    3      SELECT (C_YESNO);

     1779    16482    3      IF YES_NO THEN

  16482  3 003225   200246 234100                    SZN     YES_NO,,AUTO
         3 003226   003237 605000 3                  TPL     s:16485
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:299  

     1780    16483    3         FMT_VEC(FDS.NVECS#) = VECTOR(YES_STR);

  16483  3 003227   000011 235000 xsym               LDA     FDS+9
         3 003230   000001 735000                    ALS     1
         3 003231   000000 620005                    EAX0    0,AL
         3 003232   000000 621005                    EAX1    0,AL
         3 003233   000070 237000 4                  LDAQ    56
         3 003234   000000 755010 xsym               STA     FMT_VEC,X0
         3 003235   000001 756011 xsym               STQ     FMT_VEC+1,X1
         3 003236   003246 710000 3                  TRA     s:16486

     1781    16484    3      ELSE
     1782    16485    3         FMT_VEC(FDS.NVECS#) = VECTOR(NO_STR);

  16485  3 003237   000011 235000 xsym               LDA     FDS+9
         3 003240   000001 735000                    ALS     1
         3 003241   000000 620005                    EAX0    0,AL
         3 003242   000000 621005                    EAX1    0,AL
         3 003243   000076 237000 4                  LDAQ    62
         3 003244   000000 755010 xsym               STA     FMT_VEC,X0
         3 003245   000001 756011 xsym               STQ     FMT_VEC+1,X1

     1783    16486    3      FDS.NVECS# = FDS.NVECS# + 1;

  16486  3 003246   000011 054000 xsym               AOS     FDS+9

     1784    16487    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%>A');

  16487  3 003247   000000 236000 xsym               LDQ     FDS
         3 003250   000020 772000                    QRL     16
         3 003251   040006 100400                    MLR     fill='040'O
         3 003252   000643 000003 2                  ADSC9   YES_STR+28               cn=0,n=3
         3 003253   000000 200003 xsym               ADSC9   FMT_BUF,Q                cn=1,n=3

     1785    16488    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:300  
  16488  3 003254   000003 036007                    ADLQ    3,DL
         3 003255   000020 736000                    QLS     16
         3 003256   000000 676000 xsym               ERQ     FDS
         3 003257   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003260   000000 656000 xsym               ERSQ    FDS
         3 003261   003363 710000 3                  TRA     s:16508

     1786    16489    3      SELECT (C_ATTRIBUTES);

     1787    16490    3      IF CON$DREC.OCINFO.KCADDR & MASK THEN

  16490  3 003262   000000 470400 xsym               LDP0    DSEG3$
         3 003263   000035 220100                    LDX0    29,,PR0
         3 003264   200067 360100                    ANX0    MASK,,AUTO
         3 003265   003311 600000 3                  TZE     s:16496

     1788    16491    3         IF CON$DREC.OCINFO.CADDR & MASK THEN

  16491  3 003266   000034 220100                    LDX0    28,,PR0
         3 003267   200067 360100                    ANX0    MASK,,AUTO
         3 003270   003301 600000 3                  TZE     s:16494

     1789    16492    3            FMT_VEC(FDS.NVECS#) = VECTOR( YES_STR );

  16492  3 003271   000011 235000 xsym               LDA     FDS+9
         3 003272   000001 735000                    ALS     1
         3 003273   000000 620005                    EAX0    0,AL
         3 003274   000000 621005                    EAX1    0,AL
         3 003275   000070 237000 4                  LDAQ    56
         3 003276   000000 755010 xsym               STA     FMT_VEC,X0
         3 003277   000001 756011 xsym               STQ     FMT_VEC+1,X1
         3 003300   003333 710000 3                  TRA     s:16500

     1790    16493    3         ELSE
     1791    16494    3            FMT_VEC(FDS.NVECS#) = VECTOR( KEYIN_STR );

  16494  3 003301   000011 235000 xsym               LDA     FDS+9
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:301  
         3 003302   000001 735000                    ALS     1
         3 003303   000000 620005                    EAX0    0,AL
         3 003304   000000 621005                    EAX1    0,AL
         3 003305   000114 237000 4                  LDAQ    76
         3 003306   000000 755010 xsym               STA     FMT_VEC,X0
         3 003307   000001 756011 xsym               STQ     FMT_VEC+1,X1
         3 003310   003333 710000 3                  TRA     s:16500

     1792    16495    3      ELSE
     1793    16496    3         IF CON$DREC.OCINFO.CADDR & MASK THEN

  16496  3 003311   000034 220100                    LDX0    28,,PR0
         3 003312   200067 360100                    ANX0    MASK,,AUTO
         3 003313   003324 600000 3                  TZE     s:16499

     1794    16497    3            FMT_VEC(FDS.NVECS#) = VECTOR( DISPLAY_STR);

  16497  3 003314   000011 235000 xsym               LDA     FDS+9
         3 003315   000001 735000                    ALS     1
         3 003316   000000 620005                    EAX0    0,AL
         3 003317   000000 621005                    EAX1    0,AL
         3 003320   000072 237000 4                  LDAQ    58
         3 003321   000000 755010 xsym               STA     FMT_VEC,X0
         3 003322   000001 756011 xsym               STQ     FMT_VEC+1,X1
         3 003323   003333 710000 3                  TRA     s:16500

     1795    16498    3         ELSE
     1796    16499    3            FMT_VEC(FDS.NVECS#) = VECTOR( NO_STR );

  16499  3 003324   000011 235000 xsym               LDA     FDS+9
         3 003325   000001 735000                    ALS     1
         3 003326   000000 620005                    EAX0    0,AL
         3 003327   000000 621005                    EAX1    0,AL
         3 003330   000076 237000 4                  LDAQ    62
         3 003331   000000 755010 xsym               STA     FMT_VEC,X0
         3 003332   000001 756011 xsym               STQ     FMT_VEC+1,X1

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:302  
     1797    16500    3      FDS.NVECS# = FDS.NVECS# + 1;

  16500  3 003333   000011 054000 xsym               AOS     FDS+9

     1798    16501    3      CALL INSERT(FMT_BUF,FDS.FMT_.BOUND+1,3,'%>A');

  16501  3 003334   000000 236000 xsym               LDQ     FDS
         3 003335   000020 772000                    QRL     16
         3 003336   040006 100400                    MLR     fill='040'O
         3 003337   000643 000003 2                  ADSC9   YES_STR+28               cn=0,n=3
         3 003340   000000 200003 xsym               ADSC9   FMT_BUF,Q                cn=1,n=3

     1799    16502    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 3;

  16502  3 003341   000003 036007                    ADLQ    3,DL
         3 003342   000020 736000                    QLS     16
         3 003343   000000 676000 xsym               ERQ     FDS
         3 003344   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003345   000000 656000 xsym               ERSQ    FDS
         3 003346   003363 710000 3                  TRA     s:16508

     1800    16503    3      SELECT  (C_OCTAL);

     1801    16504    3      FDS.NVECS# = FDS.NVECS# + 2;

  16504  3 003347   000002 236007                    LDQ     2,DL
         3 003350   000011 056000 xsym               ASQ     FDS+9

     1802    16505    3      SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,13) = 'O''%12ZO%12ZO''';

  16505  3 003351   000000 236000 xsym               LDQ     FDS
         3 003352   000020 772000                    QRL     16
         3 003353   040006 100400                    MLR     fill='040'O
         3 003354   000645 000015 2                  ADSC9   YES_STR+30               cn=0,n=13
         3 003355   000000 200015 xsym               ADSC9   FMT_BUF,Q                cn=1,n=13

     1803    16506    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 13;
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:303  

  16506  3 003356   000015 036007                    ADLQ    13,DL
         3 003357   000020 736000                    QLS     16
         3 003360   000000 676000 xsym               ERQ     FDS
         3 003361   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003362   000000 656000 xsym               ERSQ    FDS

     1804    16507    3      END;                           /* End case                      */

     1805    16508    3   IF JCL THEN DO;

  16508  3 003363   200003 470500                    LDP0    @JCL,,AUTO
         3 003364   000000 066500                    CMPB    filb='0'B
         3 003365   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         3 003366   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 003367   003402 600000 3                  TZE     s:16512

     1806    16509    3      SUBSTR (FMT_BUF,FDS.FMT_.BOUND+1,1) = ';';

  16509  3 003370   000000 236000 xsym               LDQ     FDS
         3 003371   000020 772000                    QRL     16
         3 003372   040006 100400                    MLR     fill='040'O
         3 003373   000113 000001 4                  ADSC9   75                       cn=0,n=1
         3 003374   000000 200001 xsym               ADSC9   FMT_BUF,Q                cn=1,n=1

     1807    16510    3      FDS.FMT_.BOUND = FDS.FMT_.BOUND + 1;

  16510  3 003375   000001 036007                    ADLQ    1,DL
         3 003376   000020 736000                    QLS     16
         3 003377   000000 676000 xsym               ERQ     FDS
         3 003400   000034 376000 xsym               ANQ     B_VECTNIL+28
         3 003401   000000 656000 xsym               ERSQ    FDS

     1808    16511    3      END;  /*  Jcl  */

     1809    16512    2   RETURN;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:304  
  16512  3 003402   200244 221300                    LDX1  ! T_SNAME+3,,AUTO
         3 003403   000001 702211                    TSX2  ! 1,X1
     1810    16513    2   END INSERT_FIELD;
     1811    16514    1   END ASL$DISP_ONE_DEVICE;

PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:305  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   OC$INFO.:E05TOU  is referenced.
   FI_MAC_C.:E05TOU  is referenced.
   FOO_MAC_C.:E05TOU  is referenced.
   QQ_SUPER_C.:E05TOU  is referenced.
   KC$CGBLK.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_DEVICE.
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:306  

 **** Variables and constants ****

  ****  Section 002 RoData ASL$DISP_ONE_DEVICE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   523-0-0/c CHAR(2)     r     1 CG_STR                   524-0-0/c CHAR(8)     r     1 COMMANDS_STR
   526-0-0/c CHAR(7)     r     1 CONSOLE_STR              530-0-0/c CHAR(6)     r     1 DEVICE_STR
   532-0-0/c CHAR(41)    r     1 DEVWSNS_HDR              545-0-0/c CHAR(7)     r     1 DISPLAY_STR
   547-0-0/c CHAR(5)     r     1 FIXED_STR                551-0-0/c CHAR(9)     r     1 INCOMING_STR
   554-0-0/c CHAR(6)     r     1 INFORM_STR               556-0-0/c CHAR(2)     r     1 IN_STR
   557-0-0/c CHAR(5)     r     1 KEYIN_STR                564-0-0/c CHAR(4)     r     1 NONE_STR
   565-0-0/c CHAR(2)     r     1 NO_STR                   566-0-0/c CHAR(2)     r     1 OK_STR
     0-0-0/c STRC(12204) r     1 OPT_TBL                  567-0-0/c CHAR(8)     r     1 OUTGOING_STR
   571-0-0/c CHAR(3)     r     1 OUT_STR                  572-0-0/c CHAR(6)     r     1 REJECT_STR
   574-0-0/c CHAR(8)     r     1 RES_STR                  576-0-0/c CHAR(13)    r     1 STATION_STR
   602-0-0/c CHAR(14)    r     1 TERMINAL_STR             606-0-0/c CHAR(2)     r     1 TP_STR
   607-0-0/c CHAR(3)     r     1 YES_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JCL                       4-0-0/w PTR         r     1 @TERMINAL
     5-0-0/c CHAR(32)    r     1 CG                        15-0-0/w UBIN        r     1 CGCNT
   245-0-0/w SBIN        r     1 CLASS                     16-0-0/c CHAR(80)    r     1 CMD
    42-0-0/w UBIN        r     1 CMDCNT                    43-0-0/c STRC(378)   r     1 DEV_NAME
    56-0-0/w SBIN        r     1 I                         57-0-0/c CHAR(18)    r     1 INSTANCE
    64-0-0/w UBIN        r     1 INSTANCECNT               *0-0-0/b BIT         r     1 JCL
    65-0-0/w SBIN        r     1 LEN                       66-0-0/w UBIN        r     1 L_TYPE
    67-0-0/b BIT (18)    r     1 MASK                      70-0-0/w SBIN        r     1 NEXT
    71-0-0/w UBIN        r     1 NUM_OPTS                  72-0-0/w PTR         r     1 OPT_ORDR$
    73-0-0/w SBIN        r     1 SBINS(0:99)              237-0-0/w SBIN        r     1 SBIN_IDX
   240-0-0/w SBIN        r     1 ST_IDX                    *0-0-0/b BIT         r     1 TERMINAL
   241-0-0/c CHAR(8)     r     1 T_SNAME                  246-0-0/w BIT         r     1 YES_NO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:307  

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/c CHAR(8)     r     1 BLANK_PASS
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/w PTR         r     1 DSEG3$                     0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1908)  r     1 CG$DEV                     0-0-0/w STRC(2016)  r     1 CON$DREC
     0-0-0/w STRC(108)   r     1 DEVWSNS                    0-0-0/w STRC(1980)  r     1 IN$DEV
     0-0-0/w STRC(1008)  r     1 KL$DREC
     0-0-0/b UBIN(9)     r     1 OPT$ORDR(0:0)
     0-0-0/w STRC(1188)  r     1 OUT$DEV                    0-0-0/w STRC(729)   r     1 RESCL$DREC
     0-0-0/c ASTR(9)     r     1 TEXT$C                     0-0-0/w STRC(2088)  r     1 TP$DEV


   Procedure ASL$DISP_ONE_DEVICE requires 1796 words for executable code.
   Procedure ASL$DISP_ONE_DEVICE requires 170 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_DEVICES.:E05TSI    .
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:308  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:309  
          MINI XREF LISTING

ASA$ERROR
     14342**DCL-ENT 15891--CALL
ASA_BRKS_LOC
     11478**DCL     11478--REDEF
ASB$READ_HLP
     14339**DCL-ENT 15889--CALL    15989--CALL
ASB$WRITE_LO
     14345**DCL-ENT 16017--CALL
AS_BLANK
     11338**DCL     15946>>CALLBLT 15958>>CALLBLT 15961>>IF      15966>>CALLBLT 16017<>CALL    16198>>CALLBLT
AS_DEFAULT.BANNER_PERM
     12171**DCL     12172--REDEF
AS_DEFAULT.BUDGET.MACCT
     12076**DCL     12080--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12089**DCL     12092--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12072**DCL     12074--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12067**DCL     12069--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12187**DCL     12188--REDEF   12189--REDEF
AS_DEFAULT_DREC.PASSWORD
     13441**DCL     13445--REDEF
AS_DEFAULT_DREC.RENAME
     13464**DCL     13465--REDEF
AS_DFLT.BANNER_PERM
     11993**DCL     11994--REDEF
AS_DFLT.BUDGET.MACCT
     11898**DCL     11902--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11911**DCL     11914--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:310  
AS_DFLT.BUDGET.PACCUM
     11894**DCL     11896--REDEF
AS_DFLT.BUDGET.PMAXC
     11889**DCL     11891--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12009**DCL     12010--REDEF   12011--REDEF
AS_FE_MODE
     11344**DCL     11345--REDEF
AS_MODE
     11341**DCL     11343--REDEF
AS_MOD_USER.ACCESS
     14206**DCL     14207--REDEF
AS_MOD_USER.BANNER
     14193**DCL     14194--REDEF
AS_MOD_USER.BANNER_PERM
     14195**DCL     14196--REDEF
AS_MOD_USER.BILL
     14201**DCL     14202--REDEF
AS_MOD_USER.CPROC
     14197**DCL     14198--REDEF
AS_MOD_USER.FEBILL
     14277**DCL     14278--REDEF
AS_MOD_USER.FECXTMEM
     14294**DCL     14295--REDEF
AS_MOD_USER.FEMINTS
     14279**DCL     14280--REDEF
AS_MOD_USER.FEMMEM
     14290**DCL     14291--REDEF
AS_MOD_USER.FEMTIME
     14288**DCL     14289--REDEF
AS_MOD_USER.FEPPRIV
     14285**DCL     14287--REDEF
AS_MOD_USER.FEPRIV
     14282**DCL     14284--REDEF
AS_MOD_USER.FORCE_BIT
     14191**DCL     14192--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:311  
AS_MOD_USER.KEY
     14273**DCL     14275--REDEF
AS_MOD_USER.LASTCPROC
     14199**DCL     14200--REDEF
AS_MOD_USER.LIMITS.DO_
     14247**DCL     14248--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14263**DCL     14264--REDEF
AS_MOD_USER.LIMITS.LO
     14243**DCL     14244--REDEF
AS_MOD_USER.LIMITS.MEM
     14239**DCL     14240--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14267**DCL     14268--REDEF
AS_MOD_USER.LIMITS.PDIS
     14255**DCL     14256--REDEF
AS_MOD_USER.LIMITS.PO
     14251**DCL     14252--REDEF
AS_MOD_USER.LIMITS.TDIS
     14259**DCL     14260--REDEF
AS_MOD_USER.LIMITS.TIME
     14235**DCL     14236--REDEF
AS_MOD_USER.MAXENQ
     14216**DCL     14217--REDEF
AS_MOD_USER.PERM_BIT
     14189**DCL     14190--REDEF
AS_MOD_USER.PPRIV
     14211**DCL     14213--REDEF
AS_MOD_USER.PRIOB
     14218**DCL     14219--REDEF
AS_MOD_USER.PRIV
     14208**DCL     14210--REDEF
AS_MOD_USER.QUAN
     14214**DCL     14215--REDEF
AS_MOD_USER.SETUP
     14187**DCL     14188--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:312  
AS_PROJECT.BANNER_PERM
     12527**DCL     12528--REDEF
AS_PROJECT.BUDGET.MACCT
     12432**DCL     12436--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12445**DCL     12448--REDEF
AS_PROJECT.BUDGET.PACCUM
     12428**DCL     12430--REDEF
AS_PROJECT.BUDGET.PMAXC
     12423**DCL     12425--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12543**DCL     12544--REDEF   12545--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12705**DCL     12706--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12610**DCL     12614--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12623**DCL     12626--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12606**DCL     12608--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12601**DCL     12603--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12721**DCL     12722--REDEF   12723--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13927**DCL     13931--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13950**DCL     13951--REDEF
AS_PROJECT_DREC.PASSWORD
     13765**DCL     13769--REDEF
AS_PROJECT_DREC.RENAME
     13788**DCL     13789--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12349**DCL     12350--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12254**DCL     12258--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:313  
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12267**DCL     12270--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12250**DCL     12252--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12245**DCL     12247--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12365**DCL     12366--REDEF   12367--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13603**DCL     13607--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13626**DCL     13627--REDEF
AS_USERS.BANNER_PERM
     11815**DCL     11816--REDEF
AS_USERS.BUDGET.MACCT
     11720**DCL     11724--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11733**DCL     11736--REDEF
AS_USERS.BUDGET.PACCUM
     11716**DCL     11718--REDEF
AS_USERS.BUDGET.PMAXC
     11711**DCL     11713--REDEF
AS_USERS.SETUP_CHRA.TXT
     11831**DCL     11832--REDEF   11833--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12883**DCL     12884--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12788**DCL     12792--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12801**DCL     12804--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12784**DCL     12786--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12779**DCL     12781--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12899**DCL     12900--REDEF   12901--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:314  
BLANK_PASS
     11469**DCL     16043>>IF
CG
     15761**DCL     15948<<CALLBLT 15952<<ASSIGN  15955<<CALLBLT 16208--ASSIGN
CG$DEV.B$CGAUINFO.UCMD
     15462**DCL     15940>>ASSIGN
CG$DEV.B$CGAUINFO.UCMDCNT
     15461**DCL     15939>>ASSIGN
CG$DEV.B$CGAUINFO.USER1
     15460**DCL     16242>>ASSIGN
CG$DEV.B$CGAUINFO.USER2
     15460**DCL     16247>>ASSIGN
CG$DEV.B$CGAUINFO.USER3
     15460**DCL     16252>>ASSIGN
CG$DEV.B$CGAUINFO.USER4
     15461**DCL     16257>>ASSIGN
CG$DEV.KC$CGID.ACCT#
     15437**DCL     15955>>CALLBLT 15958>>CALLBLT
CG$DEV.KC$CGID.NAME#.CNT
     15441**DCL     15955>>CALLBLT 15959>>ASSIGN
CG$DEV.KC$CGID.NAME#.TXT
     15442**DCL     15955>>CALLBLT
CG$DEV.KC$CGID.PSN#
     15438**DCL     15946>>CALLBLT 15948>>CALLBLT
CG$DEV.PASSWORD
     15376**DCL     15380--REDEF
CG$DEV.RENAME
     15399**DCL     15400--REDEF
CGCNT
     15762**DCL     15949<<ASSIGN  15953<<ASSIGN  15955>>CALLBLT 15959<<ASSIGN  15959>>ASSIGN  16208>>ASSIGN
     16210>>ASSIGN
CG_STR
     15735**DCL     16150--ASSIGN
CHECK_TCPIP_ATTR IN PROCEDURE INSERT_FIELD
     16365**LABEL   16356--GOTO    16361--GOTO
CLASS IN PROCEDURE INSERT_FIELD
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:315  
     16024**DCL     16039<<ASSIGN  16045<<ASSIGN  16051<<ASSIGN  16063<<ASSIGN  16088<<ASSIGN  16092<<ASSIGN
     16097<<ASSIGN  16102<<ASSIGN  16107<<ASSIGN  16112<<ASSIGN  16117<<ASSIGN  16130<<ASSIGN  16141<<ASSIGN
     16156<<ASSIGN  16164<<ASSIGN  16169<<ASSIGN  16174<<ASSIGN  16179<<ASSIGN  16184<<ASSIGN  16189<<ASSIGN
     16194<<ASSIGN  16205<<ASSIGN  16209<<ASSIGN  16221<<ASSIGN  16239<<ASSIGN  16243<<ASSIGN  16248<<ASSIGN
     16253<<ASSIGN  16258<<ASSIGN  16263<<ASSIGN  16268<<ASSIGN  16305<<ASSIGN  16333<<ASSIGN  16339<<ASSIGN
     16351<<ASSIGN  16369<<ASSIGN  16375<<ASSIGN  16381<<ASSIGN  16387<<ASSIGN  16393<<ASSIGN  16399<<ASSIGN
     16405<<ASSIGN  16411<<ASSIGN  16417<<ASSIGN  16423<<ASSIGN  16429<<ASSIGN  16435<<ASSIGN  16441<<ASSIGN
     16447<<ASSIGN  16453<<ASSIGN  16459<<ASSIGN  16470>>DOSELCT
CMD
     15763**DCL     15937<<ASSIGN  15940<<ASSIGN  15943<<ASSIGN  16127--ASSIGN
CMDCNT
     15764**DCL     15936<<ASSIGN  15939<<ASSIGN  15942<<ASSIGN  16121>>IF      16127>>ASSIGN  16128>>ASSIGN
COMMANDS_STR
     15736**DCL     16298--ASSIGN
CON$DREC.OCINFO.CADDR
     14933**DCL     16491>>IF      16496>>IF
CON$DREC.OCINFO.CMD
     14949**DCL     15937>>ASSIGN
CON$DREC.OCINFO.CMDCNT
     14947**DCL     15936>>ASSIGN
CON$DREC.OCINFO.KCADDR
     14939**DCL     16490>>IF
CON$DREC.OCINFO.LANG
     14935**DCL     16133>>IF      16138--ASSIGN
CON$DREC.OCINFO.MXPRI
     14937**DCL     16059>>ASSIGN
CON$DREC.OCINFO.WSN
     14942**DCL     16069>>IF      16074--ASSIGN
CON$DREC.PASSWORD
     14847**DCL     14851--REDEF
CON$DREC.RENAME
     14870**DCL     14871--REDEF
CONSOLE_STR
     15737**DCL     15828--ASSIGN
DEVICE_STR
     15738**DCL     15830--ASSIGN
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:316  
DEVWSNS.DEV
     15642**DCL     16000>>CALLBLT 16004>>CALLBLT
DEVWSNS.NDEV
     15641**DCL     15991>>IF      15998>>DOINDEX
DEVWSNS_HDR
     15739**DCL     15993>>CALLBLT 15994--ASSIGN
DEV_NAME
     15765**DCL     15825<<ASSIGN
DEV_NAME.COUNT
     15766**DCL     15832>>IF      15866>>IF      15904>>IF      16160>>IF
DEV_NAME.TEXT
     15767**DCL     15839--ASSIGN  15986>>CALLBLT 16161--ASSIGN
DEV_NAME.UNAME
     15768**DCL     15849>>IF      15852--ASSIGN  15904>>IF      15910--ASSIGN
DISPLAY_STR
     15740**DCL     16293--ASSIGN  16497--ASSIGN
DSEG1$
     11479**DCL     15640--IMP-PTR 15889<>CALL    15894>>IF      15897>>IF      15989<>CALL    15991>>IF
     15998>>DOINDEX 16000>>CALLBLT 16004>>CALLBLT
DSEG1SIZE
     11480**DCL     15888>>ASSIGN  15988>>ASSIGN
DSEG3$
     11480**DCL     14364--IMP-PTR 14503--IMP-PTR 14616--IMP-PTR 14789--IMP-PTR 14965--IMP-PTR 15148--IMP-PTR
     15318--IMP-PTR 15477--IMP-PTR 15788>>IF      15790>>DOSELCT 15813>>IF      15868>>IF      15872>>ASSIGN
     15884>>ASSIGN  15936>>ASSIGN  15937>>ASSIGN  15939>>ASSIGN  15940>>ASSIGN  15942>>ASSIGN  15943>>ASSIGN
     15946>>CALLBLT 15948>>CALLBLT 15955>>CALLBLT 15955>>CALLBLT 15955>>CALLBLT 15958>>CALLBLT 15959>>ASSIGN
     15961>>IF      15962>>ASSIGN  15963>>ASSIGN  15966>>CALLBLT 15967>>CALLBLT 15967>>CALLBLT 15969>>ASSIGN
     16031>>IF      16036>>ASSIGN  16036>>ASSIGN  16037>>ASSIGN  16043>>IF      16049>>ASSIGN  16050>>ASSIGN
     16059>>ASSIGN  16061>>ASSIGN  16069>>IF      16074>>ASSIGN  16079>>IF      16084>>ASSIGN  16133>>IF
     16138>>ASSIGN  16163>>ASSIGN  16168>>ASSIGN  16173>>ASSIGN  16178>>ASSIGN  16183>>ASSIGN  16188>>ASSIGN
     16193>>ASSIGN  16198>>CALLBLT 16204>>ASSIGN  16213>>IF      16218>>ASSIGN  16224>>IF      16230>>IF
     16242>>ASSIGN  16247>>ASSIGN  16252>>ASSIGN  16257>>ASSIGN  16267>>ASSIGN  16286>>IF      16291>>IF
     16296>>IF      16309>>DOCASE  16337>>ASSIGN  16343>>IF      16348>>ASSIGN  16355>>ASSIGN  16360>>ASSIGN
     16365>>ASSIGN  16367>>IF      16374>>ASSIGN  16380>>ASSIGN  16386>>ASSIGN  16392>>ASSIGN  16398>>ASSIGN
     16404>>ASSIGN  16410>>ASSIGN  16416>>ASSIGN  16422>>ASSIGN  16428>>ASSIGN  16434>>ASSIGN  16440>>ASSIGN
     16446>>ASSIGN  16452>>ASSIGN  16458>>ASSIGN  16490>>IF      16491>>IF      16496>>IF
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:317  
ERR_CODE
     11473**DCL     11474--REDEF
FDS
     11370**DCL     15915<>CALL    15974<>CALL    15983<>CALL    15995<>CALL    16007<>CALL    16012<>CALL
FDS.FMT_.BOUND
     11375**DCL     15843<<ASSIGN  15847<<ASSIGN  15850>>ASSIGN  15851<<ASSIGN  15851>>ASSIGN  15856>>ASSIGN
     15857<<ASSIGN  15857>>ASSIGN  15863<<ASSIGN  15878<<ASSIGN  15902>>ASSIGN  15903<<ASSIGN  15903>>ASSIGN
     15908>>ASSIGN  15909<<ASSIGN  15909>>ASSIGN  15922<<ASSIGN  15977<<ASSIGN  15981<<ASSIGN  15994<<ASSIGN
     16001<<ASSIGN  16005<<ASSIGN  16010<<ASSIGN  16468>>ASSIGN  16469<<ASSIGN  16469>>ASSIGN  16473>>CALLBLT
     16474<<ASSIGN  16474>>ASSIGN  16479>>CALLBLT 16480<<ASSIGN  16480>>ASSIGN  16487>>CALLBLT 16488<<ASSIGN
     16488>>ASSIGN  16501>>CALLBLT 16502<<ASSIGN  16502>>ASSIGN  16505>>ASSIGN  16506<<ASSIGN  16506>>ASSIGN
     16509>>ASSIGN  16510<<ASSIGN  16510>>ASSIGN
FDS.NVECS#
     11398**DCL     15840<<ASSIGN  15852>>ASSIGN  15853<<ASSIGN  15853>>ASSIGN  15861<<ASSIGN  15879<<ASSIGN
     15895>>ASSIGN  15898>>ASSIGN  15899<<ASSIGN  15899>>ASSIGN  15900>>ASSIGN  15901<<ASSIGN  15901>>ASSIGN
     15910>>ASSIGN  15911<<ASSIGN  15911>>ASSIGN  15916<<ASSIGN  15924<<ASSIGN  15975<<ASSIGN  15982<<ASSIGN
     15984<<ASSIGN  15996<<ASSIGN  16011<<ASSIGN  16032>>ASSIGN  16036>>ASSIGN  16044>>ASSIGN  16049>>ASSIGN
     16050>>ASSIGN  16070>>ASSIGN  16074>>ASSIGN  16080>>ASSIGN  16084>>ASSIGN  16123>>ASSIGN  16127>>ASSIGN
     16134>>ASSIGN  16138>>ASSIGN  16146>>ASSIGN  16148>>ASSIGN  16150>>ASSIGN  16152>>ASSIGN  16154>>ASSIGN
     16161>>ASSIGN  16163>>ASSIGN  16173>>ASSIGN  16193>>ASSIGN  16200>>ASSIGN  16204>>ASSIGN  16208>>ASSIGN
     16214>>ASSIGN  16218>>ASSIGN  16226>>ASSIGN  16232>>ASSIGN  16236>>ASSIGN  16262>>ASSIGN  16288>>ASSIGN
     16293>>ASSIGN  16298>>ASSIGN  16302>>ASSIGN  16313>>ASSIGN  16318>>ASSIGN  16323>>ASSIGN  16328>>ASSIGN
     16337>>ASSIGN  16344>>ASSIGN  16348>>ASSIGN  16464>>ASSIGN  16465>>ASSIGN  16466<<ASSIGN  16466>>ASSIGN
     16472<<ASSIGN  16472>>ASSIGN  16476>>ASSIGN  16477<<ASSIGN  16477>>ASSIGN  16483>>ASSIGN  16485>>ASSIGN
     16486<<ASSIGN  16486>>ASSIGN  16492>>ASSIGN  16494>>ASSIGN  16497>>ASSIGN  16499>>ASSIGN  16500<<ASSIGN
     16500>>ASSIGN  16504<<ASSIGN  16504>>ASSIGN
FDS.TABDFLT#
     11436**DCL     15920<<ASSIGN  15997<<ASSIGN
FIXED_STR
     15741**DCL     16323--ASSIGN  16324--ASSIGN
FMT_BUF
     11469**DCL     15842<<ASSIGN  15846<<ASSIGN  15850<<ASSIGN  15856<<ASSIGN  15862<<ASSIGN  15877<<ASSIGN
     15902<<ASSIGN  15908<<ASSIGN  15921<<ASSIGN  15976<<ASSIGN  15980<<ASSIGN  15993<<CALLBLT 16000<<CALLBLT
     16004<<CALLBLT 16009<<ASSIGN  16468<<ASSIGN  16473<<CALLBLT 16479<<CALLBLT 16487<<CALLBLT 16501<<CALLBLT
     16505<<ASSIGN  16509<<ASSIGN
FMT_VEC
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:318  
     11469**DCL     15828<<ASSIGN  15830<<ASSIGN  15839<<ASSIGN  15852<<ASSIGN  15895<<ASSIGN  15898<<ASSIGN
     15900<<ASSIGN  15910<<ASSIGN  16032<<ASSIGN  16036<<ASSIGN  16044<<ASSIGN  16049<<ASSIGN  16050<<ASSIGN
     16070<<ASSIGN  16074<<ASSIGN  16080<<ASSIGN  16084<<ASSIGN  16123<<ASSIGN  16127<<ASSIGN  16134<<ASSIGN
     16138<<ASSIGN  16146<<ASSIGN  16148<<ASSIGN  16150<<ASSIGN  16152<<ASSIGN  16154<<ASSIGN  16161<<ASSIGN
     16163<<ASSIGN  16173<<ASSIGN  16193<<ASSIGN  16200<<ASSIGN  16204<<ASSIGN  16208<<ASSIGN  16214<<ASSIGN
     16218<<ASSIGN  16226<<ASSIGN  16232<<ASSIGN  16236<<ASSIGN  16262<<ASSIGN  16288<<ASSIGN  16293<<ASSIGN
     16298<<ASSIGN  16302<<ASSIGN  16313<<ASSIGN  16318<<ASSIGN  16323<<ASSIGN  16328<<ASSIGN  16337<<ASSIGN
     16344<<ASSIGN  16348<<ASSIGN  16464<<ASSIGN  16465<<ASSIGN  16476<<ASSIGN  16483<<ASSIGN  16485<<ASSIGN
     16492<<ASSIGN  16494<<ASSIGN  16497<<ASSIGN  16499<<ASSIGN
I
     15770**DCL     15888<<ASSIGN  15889<>CALL    15946<<CALLBLT 15947>>IF      15948>>CALLBLT 15949>>ASSIGN
     15958<<CALLBLT 15959>>ASSIGN  15966<<CALLBLT 15967>>CALLBLT 15969>>ASSIGN  15988<<ASSIGN  15989<>CALL
     15998<<DOINDEX 15999>>IF      16000>>CALLBLT 16004>>CALLBLT
IN$DEV.ISINFO.DFLTPRI
     15120**DCL     15121--REDEF
IN$DEV.ISINFO.DFPRI
     15121**DCL     16178>>ASSIGN
IN$DEV.ISINFO.MXPRI
     15122**DCL     16061>>ASSIGN
IN$DEV.ISINFO.NCACCT
     15124**DCL     16193--ASSIGN
IN$DEV.ISINFO.NCTL
     15111**DCL     16183>>ASSIGN
IN$DEV.ISINFO.NCTLOK
     15113**DCL     16188>>ASSIGN
IN$DEV.ISINFO.NFID
     15127**DCL     16198>>CALLBLT 16204--ASSIGN
IN$DEV.ISINFO.WSN
     15132**DCL     16079>>IF      16084--ASSIGN
IN$DEV.PASSWORD
     15023**DCL     15027--REDEF
IN$DEV.RENAME
     15046**DCL     15047--REDEF
INCOMING_STR
     15742**DCL     16313--ASSIGN  16314--ASSIGN
INFORM_STR
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:319  
     15743**DCL     16232--ASSIGN
INSERT_FIELD
     16021**PROC    15973--CALL
INSTANCE
     15771**DCL     15962<<ASSIGN  15967<<CALLBLT 16262--ASSIGN
INSTANCECNT
     15772**DCL     15963<<ASSIGN  15969<<ASSIGN  16262>>ASSIGN  16264>>ASSIGN
IN_STR
     15744**DCL     16148--ASSIGN
JCL
     14333**DCL        10--PROC    15841>>IF      15876>>IF      15985>>IF      16508>>IF
KEYIN_STR
     15745**DCL     16494--ASSIGN
KL$DREC.ATYP
     14369**DCL     15788>>IF      15894>>IF      15897>>IF
KL$DREC.FLAGS.NOCGINF
     14403**DCL     16230>>IF
KL$DREC.FLAGS.NOCGREJ
     14398**DCL     16224>>IF
KL$DREC.PASSWORD
     14422**DCL     14426--REDEF   16043>>IF      16049--ASSIGN  16050--ASSIGN
KL$DREC.PNAME
     14428**DCL     16036--ASSIGN  16036--ASSIGN
KL$DREC.PNAME.CNT
     14436**DCL     16031>>IF      16037>>ASSIGN
KL$DREC.RENAME
     14445**DCL     14446--REDEF   16163--ASSIGN  16213>>IF      16218--ASSIGN  16219--ASSIGN
KL$DREC.SNAME
     14459**DCL     15872>>ASSIGN
KL$DREC.SUPER
     14416**DCL     15790>>DOSELCT
KL$DREC.TNAME
     14455**DCL     15868>>IF      15884>>ASSIGN
KL_DEFAULT.PASSWORD
     14089**DCL     14093--REDEF
KL_DEFAULT.RENAME
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:320  
     14112**DCL     14113--REDEF
KL_DFLT.PASSWORD
     13279**DCL     13283--REDEF
KL_DFLT.RENAME
     13302**DCL     13303--REDEF
KL_DREC.PASSWORD
     13117**DCL     13121--REDEF
KL_DREC.RENAME
     13140**DCL     13141--REDEF
KL_DREC_CNT.PASSWORD
     13004**DCL     13008--REDEF
KL_DREC_CNT.RENAME
     13027**DCL     13028--REDEF
LEN
     15773**DCL     15833<<ASSIGN  15836<<ASSIGN  15839>>ASSIGN  16033<<ASSIGN  16037<<ASSIGN  16046<<ASSIGN
     16052<<ASSIGN  16064<<ASSIGN  16071<<ASSIGN  16075<<ASSIGN  16081<<ASSIGN  16085<<ASSIGN  16093<<ASSIGN
     16098<<ASSIGN  16103<<ASSIGN  16108<<ASSIGN  16113<<ASSIGN  16118<<ASSIGN  16124<<ASSIGN  16128<<ASSIGN
     16135<<ASSIGN  16139<<ASSIGN  16157<<ASSIGN  16165<<ASSIGN  16170<<ASSIGN  16175<<ASSIGN  16180<<ASSIGN
     16185<<ASSIGN  16190<<ASSIGN  16195<<ASSIGN  16198<<CALLBLT 16199>>IF      16201<<ASSIGN  16204>>ASSIGN
     16210<<ASSIGN  16215<<ASSIGN  16219<<ASSIGN  16227<<ASSIGN  16233<<ASSIGN  16237<<ASSIGN  16244<<ASSIGN
     16249<<ASSIGN  16254<<ASSIGN  16259<<ASSIGN  16264<<ASSIGN  16269<<ASSIGN  16289<<ASSIGN  16294<<ASSIGN
     16299<<ASSIGN  16303<<ASSIGN  16314<<ASSIGN  16319<<ASSIGN  16324<<ASSIGN  16329<<ASSIGN  16338<<ASSIGN
     16345<<ASSIGN  16349<<ASSIGN  16370<<ASSIGN  16376<<ASSIGN  16382<<ASSIGN  16388<<ASSIGN  16394<<ASSIGN
     16400<<ASSIGN  16406<<ASSIGN  16412<<ASSIGN  16418<<ASSIGN  16424<<ASSIGN  16430<<ASSIGN  16436<<ASSIGN
     16442<<ASSIGN  16448<<ASSIGN  16454<<ASSIGN  16460<<ASSIGN  16463>>ASSIGN
L_TYPE
     15774**DCL     15792<<ASSIGN  15796<<ASSIGN  15800<<ASSIGN  15804<<ASSIGN  15808<<ASSIGN  15812<<ASSIGN
     15826>>DOSELCT 15849>>IF      15866>>IF      15866>>IF      15904>>IF      15934>>DOSELCT 16057>>DOCASE
     16067>>DOCASE  16144>>DOCASE
MASK
     15775**DCL     16091<<ASSIGN  16096<<ASSIGN  16101<<ASSIGN  16106<<ASSIGN  16111<<ASSIGN  16116<<ASSIGN
     16490>>IF      16491>>IF      16496>>IF
NEXT
     15776**DCL     15928<<ASSIGN  15932>>DOSELCT 16028>>DOCASE  16368<<ASSIGN  16368>>ASSIGN  16463>>ASSIGN
     16465>>ASSIGN
NONE_STR
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:321  
     15747**DCL     16032--ASSIGN  16044--ASSIGN  16070--ASSIGN  16080--ASSIGN  16123--ASSIGN  16134--ASSIGN
     16200--ASSIGN  16214--ASSIGN  16215--ASSIGN  16328--ASSIGN  16329--ASSIGN  16344--ASSIGN
NO_STATION
     15915**LABEL   15867--GOTO
NO_STR
     15748**DCL     16302--ASSIGN  16485--ASSIGN  16499--ASSIGN
NUM_OPTS
     15777**DCL     15794<<ASSIGN  15798<<ASSIGN  15802<<ASSIGN  15806<<ASSIGN  15810<<ASSIGN  15815<<ASSIGN
     15819<<ASSIGN  15926>>DOWHILE
OK_STR
     15749**DCL     16236--ASSIGN
OPT$ORDR
     15647**DCL     15928>>ASSIGN
OPT_ORDR$
     15778**DCL     15647--IMP-PTR 15793<<ASSIGN  15797<<ASSIGN  15801<<ASSIGN  15805<<ASSIGN  15809<<ASSIGN
     15814<<ASSIGN  15818<<ASSIGN  15928>>ASSIGN
OPT_TBL.CG_ORDR
     15720**DCL     15801--ASSIGN  15802--ASSIGN
OPT_TBL.CON_ORDR
     15709**DCL     15809--ASSIGN  15810--ASSIGN
OPT_TBL.HDR
     15652**DCL     16463--ASSIGN  16465--ASSIGN
OPT_TBL.IN_ORDR
     15716**DCL     15793--ASSIGN  15794--ASSIGN
OPT_TBL.OUT_ORDR
     15713**DCL     15797--ASSIGN  15798--ASSIGN
OPT_TBL.RES_CL_ORDR
     15727**DCL     15814--ASSIGN  15815--ASSIGN
OPT_TBL.RES_ORDR
     15733**DCL     15818--ASSIGN  15819--ASSIGN
OPT_TBL.TP_ORDR
     15724**DCL     15805--ASSIGN  15806--ASSIGN
OUT$DEV.OSINFO.FNAME
     15297**DCL     15300--REDEF   15301--REDEF   16173--ASSIGN  16175--ASSIGN
OUT$DEV.OSINFO.UPLOCKED
     15294**DCL     16168>>ASSIGN
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:322  
OUT$DEV.PASSWORD
     15206**DCL     15210--REDEF
OUT$DEV.RENAME
     15229**DCL     15230--REDEF
OUTGOING_STR
     15750**DCL     16318--ASSIGN  16319--ASSIGN
OUT_STR
     15751**DCL     16146--ASSIGN
PROJ_KEY.TEXT
     11351**DCL     11351--REDEF
PROJ_KEY.TXT.PROJECT
     11351**DCL     11351--REDEF
REJECT_STR
     15752**DCL     16226--ASSIGN
REMEM_VAR
     11477**DCL     11477--REDEF
REM_FCMD
     11477**DCL     11478--REDEF
RES$DREC.PASSWORD
     14561**DCL     14565--REDEF
RES$DREC.RENAME
     14584**DCL     14585--REDEF
RESCL$DREC.CL_DEV.ATTR.B1200#
     14752**DCL     16360>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.B2400#
     14753**DCL     16365>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.B300#
     14751**DCL     16355>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.HAYES#
     14754**DCL     16374>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU1#
     14768**DCL     16386>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU10#
     14759**DCL     16440>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU11#
     14758**DCL     16446>>ASSIGN
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:323  
RESCL$DREC.CL_DEV.ATTR.RFU13#
     14756**DCL     16458>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU2#
     14767**DCL     16392>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU3#
     14766**DCL     16398>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU4#
     14765**DCL     16404>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU5#
     14764**DCL     16410>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU6#
     14763**DCL     16416>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU7#
     14762**DCL     16422>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU8#
     14761**DCL     16428>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.RFU9#
     14760**DCL     16434>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.TCPIP#
     14757**DCL     16367>>IF      16452>>ASSIGN
RESCL$DREC.CL_DEV.ATTR.X28#
     14755**DCL     16380>>ASSIGN
RESCL$DREC.CL_DEV.AUACCOUNT
     14774**DCL     16343>>IF      16348--ASSIGN  16349--ASSIGN
RESCL$DREC.CL_DEV.MODE
     14747**DCL     16309>>DOCASE
RESCL$DREC.CL_DEV.RNAME
     14771**DCL     16337--ASSIGN  16338--ASSIGN
RESCL$DREC.PASSWORD
     14674**DCL     14678--REDEF
RESCL$DREC.RENAME
     14697**DCL     14698--REDEF   15813>>IF
RES_STR
     15753**DCL     16154--ASSIGN
SBINS
     15779**DCL     16059<<ASSIGN  16061<<ASSIGN  16178<<ASSIGN  16242<<ASSIGN  16247<<ASSIGN  16252<<ASSIGN
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:324  
     16257<<ASSIGN  16267<<ASSIGN  16463<<ASSIGN  16464--ASSIGN  16476--ASSIGN
SBIN_IDX
     15780**DCL     15923<<ASSIGN  16059>>ASSIGN  16061>>ASSIGN  16178>>ASSIGN  16242>>ASSIGN  16247>>ASSIGN
     16252>>ASSIGN  16257>>ASSIGN  16267>>ASSIGN  16463>>ASSIGN  16464>>ASSIGN  16467<<ASSIGN  16467>>ASSIGN
     16476>>ASSIGN  16478<<ASSIGN  16478>>ASSIGN
STATION_STR
     15754**DCL     15895--ASSIGN
ST_IDX
     15781**DCL     15918<<ASSIGN  15926>>DOWHILE 15928>>ASSIGN  15978<<ASSIGN  15978>>ASSIGN
TERMINAL
     14334**DCL        10--PROC    15838>>IF      15865>>IF      16042>>IF
TERMINAL_STR
     15755**DCL     15898--ASSIGN
TEXT$C.C
     15646**DCL     16036--ASSIGN
TEXT$C.L
     15645**DCL     15646--IMP-SIZ 16036>>ASSIGN
TP$DEV.KC$CGID.NAME#.CNT
     15600**DCL     15963>>ASSIGN  15969>>ASSIGN
TP$DEV.KC$CGID.NAME#.TXT
     15601**DCL     15962>>ASSIGN  15967>>CALLBLT
TP$DEV.KC$CGID.PSN#
     15597**DCL     15961>>IF      15966>>CALLBLT 15967>>CALLBLT
TP$DEV.PASSWORD
     15535**DCL     15539--REDEF
TP$DEV.QQ$LOGON.CMD
     15636**DCL     15943>>ASSIGN
TP$DEV.QQ$LOGON.CMDCNT
     15634**DCL     15942>>ASSIGN
TP$DEV.QQ$LOGON.MCT
     15621**DCL     16286>>IF
TP$DEV.QQ$LOGON.MCTCMD
     15623**DCL     16296>>IF
TP$DEV.QQ$LOGON.MCTD
     15625**DCL     16291>>IF
TP$DEV.QQ$LOGON.PRIO
PL6.E3A0      #003=ASL$DISP_ONE_DEVICE File=ASL$LIST_DEVICES.:E05TSI             TUE 07/29/97 10:12 Page:325  
     15628**DCL     16267>>ASSIGN
TP$DEV.RENAME
     15558**DCL     15559--REDEF
TP_STR
     15756**DCL     16152--ASSIGN
T_SNAME
     15782**DCL     15872<<ASSIGN  15873>>CALLBLT 15884<<ASSIGN  15885>>CALLBLT 15900--ASSIGN
USERS_KEY
     11348**DCL     15825>>ASSIGN  15891<>CALL
USERS_KEY.COUNT
     11348**DCL     15871<<ASSIGN  15883<<ASSIGN  15987<<ASSIGN
USERS_KEY.TEXT
     11348**DCL     11349--REDEF   11349--REDEF   11349--REDEF   11350--REDEF
USERS_KEY.TXTC
     11349**DCL     15873<<CALLBLT 15885<<CALLBLT 15986<<CALLBLT
X$FORMAT
     14347**DCL-ENT 15915--CALL    15974--CALL    15983--CALL    15995--CALL    16007--CALL    16012--CALL
YES_NO IN PROCEDURE INSERT_FIELD
     16025**DCL     16168<<ASSIGN  16183<<ASSIGN  16188<<ASSIGN  16355<<ASSIGN  16360<<ASSIGN  16365<<ASSIGN
     16374<<ASSIGN  16380<<ASSIGN  16386<<ASSIGN  16392<<ASSIGN  16398<<ASSIGN  16404<<ASSIGN  16410<<ASSIGN
     16416<<ASSIGN  16422<<ASSIGN  16428<<ASSIGN  16434<<ASSIGN  16440<<ASSIGN  16446<<ASSIGN  16452<<ASSIGN
     16458<<ASSIGN  16482>>IF
YES_STR
     15757**DCL     16288--ASSIGN  16483--ASSIGN  16492--ASSIGN
