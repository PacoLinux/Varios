VERSION E05

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:1    
        1        1        /*M*  DDK$EVAL - EVALUATES DATA DESCRIPTOR ADDRESS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME: DDK$EVAL
       10       10              PURPOSE: Using DDK$GETADDR, this routine evaluates a
       11       11                  data reference descriptor, returning a segid and a
       12       12                  word offset for the address of the item described.
       13       13              DESCRIPTION:  Input is a data reference descriptor @ S_D.DESC$
       14       14                            Output is ADDRESS - word offset in segment
       15       15                                 and SEG, DESC# the encoded segment ID
       16       16                                      SEG = 0 DESC# is $PSn
       17       17                                      SEG = 1 indicates encoded special segment
       18       18                                           DESC# = 0 $REAL
       19       19                                                   1 $VIRT
       20       20                                                   2 $IOBUF
       21       21                                                   3 $PSR
       22       22                                                   4 $ASR
       23       23                                                   5 $LSR
       24       24                                                   6 $SSR
       25       25                                                   7 $JIT
       26       26                                                   8 $HJIT
       27       27                                                   9 $TCB
       28       28                                                  10 $SAD
       29       29                                                  11 $RVB
       30       30                                                  12 $USD
       31       31                                                  13 $ERR
       32       32                                      SEG = 2 DESC# is $ASn
       33       33                                      SEG = 3 DESC# is $LSn
       34       34                                           (Normal addresses are SEG = 3,
       35       35                                            DESC# = 0, NOT_IS = '0'B )
       36       36                                      SEG = 5 DESC# IS DCB #
       37       37                                      SEG = 6 indicates Host encoded special symbol
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:2    
       38       38                                           DESC# = 0
       39       39                                                ADDRESS = 0 $E
       40       40                                                          1 $A
       41       41                                                          2 $Q
       42       42                                                          3 $X0
       43       43                                                          4 $X1
       44       44                                                          5 $X2
       45       45                                                          6 $X3
       46       46                                                          7 $X4
       47       47                                                          8 $X5
       48       48                                                          9 $X6
       49       49                                                         10 $X7
       50       50                                                         11 $IND
       51       51                                                         12 $IC
       52       52                                           DESC# = 1 $ARn
       53       53                                                ADDRESS = n
       54       54                                           DESC# = 2 $PRn
       55       55                                                ADDRESS = n
       56       56                                           DESC# = 3
       57       57                                                ADDRESS = 0 $AU
       58       58                                                          1 $AL
       59       59                                                          2 $QU
       60       60                                                          3 $QL
       61       61                                           DESC# = 4
       62       62                                                ADDRESS = 0 $IOBUFSZ
       63       63                                           DESC# = 5 $WSRn
       64       64                                                ADDRESS = n
       65       65                                           DESC# = 6 $WSQn
       66       66                                                ADDRESS = n
       67       67                                      SEG = 7 indicates HEAD record (RUM only)
       68       68                                           DESC# = 0 $SA
       69       69                                                   1 $PRIV
       70       70                                                   2 $HEAD (ADDRESS is offset)
       71       71                                      SEG = 8 DESC# = CG number (ANLZ_FILE only)
       72       72                                      SEG = 9 indicates L6 encoded special symbol
       73       73                                           DESC# = 0
       74       74                                                ADDRESS = 0 $R1
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:3    
       75       75                                                          1 $R2
       76       76                                                          2 $R3
       77       77                                                          3 $R4
       78       78                                                          4 $R5
       79       79                                                          5 $R6
       80       80                                                          6 $R7
       81       81                                                          7 $M1
       82       82                                                          8 $M2
       83       83                                                          9 $M3
       84       84                                                         10 $M4
       85       85                                                         11 $M5
       86       86                                                         12 $M6
       87       87                                                         13 $M7
       88       88                                                         14 $T
       89       89                                                         15 $S
       90       90                                                         16 $A
       91       91                                                         17 $IV
       92       92                                                         18 $Z
       93       93                                                         19 $ASV
       94       94                                                         20 $CI
       95       95                                                         21 $IND
       96       96                                           DESC# = 1
       97       97                                                ADDRESS = 0 $ROSEG
       98       98                                           DESC# = 2
       99       99                                                ADDRESS = 0 $RDBR
      100      100                                           DESC# = 3
      101      101                                                ADDRESS = 0 $TSA
      102      102                                           DESC# = 4
      103      103                                                ADDRESS = 0 $AUTO
      104      104
      105      105                                      SEG = 10   $Bn - L6
      106      106                                           DESC# = n
      107      107
      108      108                                      SEG = 11   $DSn - L6
      109      109                                           DESC# = n
      110      110
      111      111                                      SEG = 12  $ISn - L6
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:4    
      112      112                                           DESC# = n
      113      113
      114      114                                      SEG = 13 $RES
      115      115
      116      116                            The bit flag NOT_IS is set if the segment is not
      117      117                            the instruction segment (seg=3, DESC#=0)
      118      118
      119      119                       The ALTRET is taken if something prevents evaluation
      120      120                       of the address:
      121      121                            E@USE_CONFLICT  (need SS, dont have it)
      122      122                            E@CANTEVAL     (Self-ID'ing descriptor found)
      123      123                                                     */
      124      124        DDK$EVAL: PROC(ADDRESS, SEG, DESC#, NOT_IS, BITOFF, BSIZE) ALTRET;
      125      125          /* Parms */
      126      126    1   DCL ADDRESS SBIN;
      127      127    1   DCL ADDRESSBITS(0:35) REDEF ADDRESS UBIN(1) UNAL;
      128      128    1   DCL ADDRESSCHARS(0:3) REDEF ADDRESS CHAR(1);
      129      129    1   DCL SEG UBIN(36);
      130      130    1   DCL DESC# UBIN(36);
      131      131    1   DCL NOT_IS BIT(1) ALIGNED;
      132      132    1   DCL BITOFF SBIN;
      133      133    1   DCL BSIZE UBIN;
      134      134          /* Locals */
      135      135    1   DCL FALSE BIT(1) ALIGNED CONSTANT INIT('0'B);
      136      136    1   DCL I SBIN;
      137      137    1   DCL J UBIN;
      138      138    1   DCL SIZED9 UBIN;
      139      139    1   DCL SVALUE SBIN;
      140      140    1   DCL SIZE SBIN;
      141      141    1   DCL INDXX SBIN;
      142      142    1   DCL POINTER UBIN(36);
      143      143    1   DCL 1 POINTR REDEF POINTER,
      144      144    1         2 ADR,
      145      145    1           3 W UBIN(18) UNAL,
      146      146    1           3 C UBIN(2) UNAL,
      147      147    1           3 B UBIN(4) UNAL,
      148      148    1         2 SEG UBIN(2) UNAL,
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:5    
      149      149    1         2 DESC# UBIN(10) UNAL;
      150      150    1   DCL 1 PSDITEM REDEF POINTER,
      151      151    1         2 TYPE UBIN(6) UNAL,
      152      152    1         2 ID UBIN(9) UNAL,
      153      153    1         2 DISP UBIN(9) UNAL,
      154      154    1         2 SEGID UBIN(12) UNAL;
      155      155    1   DCL EXPR_VAL SBIN;
      156      156    1   DCL EXPR_OP SBIN;
      157      157    1   DCL ADDR_TYPE SBIN;
      158      158    1   DCL ARRAY_FLAG BIT(1);
      159      159    1   DCL SFLAG BIT(1);
      160      160    1   DCL 1 PNTR,
      161      161    1         2 ADR,
      162      162    1           3 W UBIN(18) UNAL,
      163      163    1           3 C UBIN(2) UNAL,
      164      164    1           3 B UBIN(4) UNAL,
      165      165    1         2 SEG UBIN(2) UNAL,
      166      166    1         2 DESC# UBIN(10) UNAL;
      167      167    1   DCL TEMP SBIN;
      168      168    1   DCL TADDRESS UBIN;
      169      169    1   DCL 1 PUP,
      170      170    1         2 SIZE UBIN(22) UNAL,
      171      171    1         2 SCALE SBIN(8) UNAL,
      172      172    1         2 PUB UBIN(2) UNAL,
      173      173    1         2 SIGNPOS UBIN(2) UNAL,
      174      174    1         2 SIGNTYP BIT(1),
      175      175    1         2 SIGNOVER BIT(1);
      176      176          /* Misc */
      177      177    1   DCL USE$ PTR SYMREF;
      178      178             %INCLUDE DD$BASED;
      179     1481             %U$SE;
      180     1489             %INCLUDE DD_DESC_R;
      181     1539    1   DCL SS_PTR(0:24) BIT(36) ALIGNED BASED;
      182     1540    1   DCL UDR2$ PTR SYMREF;
      183     1541    1   DCL UIS$ PTR SYMREF;
      184     1542    1   DCL STACKIC UBIN;
      185     1543    1   DCL STACKOFF UBIN;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:6    
      186     1544    1   DCL RSTACKOFF UBIN;
      187     1545    1   DCL RETADDR UBIN;
      188     1546    1   DCL STACK$ PTR;
      189     1547    1   DCL TEDEF$ PTR;
      190     1548             %INCLUDE DD_ERR_C;
      191     1945             %INCLUDE DD$DITEM;
       12+    2048             %LIST;
       13+    2049    1        DCL SDD$ PTR;
       14+    2050    1        DCL ZITEM$ PTR;
       15+    2051    1        DCL SDD_L6$ PTR;
       16+    2052    1        DCL ZITEM_L6$ PTR;
      192     2626             %ZITEM;
      193     2698             %DITEM (NAME=ITEM, STCLASS=AUTO);
      194     2778    1   DCL 1 W BASED ALIGNED,
      195     2779    1         2 LEFT UBIN HALF UNAL,
      196     2780    1         2 RIGHT UBIN HALF UNAL;
      197     2781             %INCLUDE B$OBJECT_C;
      198     6211             %B$EDEF;
      199     6281             %INCLUDE XUH_MACRO_C;
      200     6365             %INCLUDE DD_SD_M;
      201     7701             %S_D;
      202     9019    1   DCL D_XDELTA BIT(1) SYMREF;
      203     9020          /* External routines */
      204     9021    1   DCL DDE$ERROR ENTRY;
      205     9022    1   DCL DDI$GET_PATCH_SPACE ENTRY;
      206     9023    1   DCL DDK$GETADDR ENTRY(9) ALTRET;
      207     9024    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      208     9025    1   DCL DDK$GETSPEC ENTRY(2) ALTRET;
      209     9026    1   DCL DDK$GETPARM ENTRY(2) ALTRET;
      210     9027    1   DCL DDK$ADDEXPR ENTRY(3);
      211     9028    1   DCL DDF$FIND_PEDEF ENTRY(2) ALTRET;
      212     9029                                                /**/
      213     9030    1        ZITEM$ = S_D.DESC$;
      214     9031    1        IF ADDR(BITOFF) ~= ADDR(NIL)
      215     9032    1        THEN BITOFF=0;
      216     9033    1        IF D_XDELTA AND S_D.DESC$->ZITEM.FLAGS.MDSE.S
      217     9034    1          AND NOT U$SE.CUR
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:7    
      218     9035    2        THEN DO;
      219     9036    2             S_D.ERROR = 38;   /* E@USE_CONFLICT */
      220     9037    2             ALTRETURN;
      221     9038    2           END;
      222     9039    1        S_D.ARRAY.FIRST = '1'B;            /* In case it's an array */
      223     9040    1        CALL DDK$GETADDR(ITEM, SVALUE, SIZE, INDXX, POINTER, EXPR_VAL,
      224     9041    1          EXPR_OP, ADDR_TYPE, ARRAY_FLAG ) ALTRET(AERR);
      225     9042    1        PUP = ZITEM.PUP;
      226     9043    1        IF PUP.PUB = 1
      227     9044    1        THEN SIZE = (SIZE * 9)/ 2;
      228     9045                                                /**/
      229     9046    1        SEG = 3;                           /* Unless ...            */
      230     9047    1        DESC# = 0;                         /*  ... Something ...    */
      231     9048    1        NOT_IS = '0'B;                     /*        ... Happens    */
      232     9049                                                /**/
      233     9050    2        DO CASE(ADDR_TYPE);
      234     9051                                                     /*
      235     9052        DESC_ACODE     (must be $PRn )
      236     9053                                                     */
      237     9054    2          CASE( %DESC_ACODE );
      238     9055    2             IF NOT(ITEM.SP.VD.TYPE = 2 AND
      239     9056    2               ITEM.SP.VD.ID >= 16 AND
      240     9057    2               ITEM.SP.VD.ID <= 23)
      241     9058    3             THEN DO;
      242     9059    3                  IF S_D.RUM
      243     9060    3                  THEN S_D.ERROR = 232; /* E@NOSSRUM */
      244     9061    3                  ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */
      245     9062    3                  ALTRETURN;
      246     9063    3                END;
      247     9064    2             SEG = 6;
      248     9065    2             DESC# = 2;
      249     9066    2             ADDRESS = ( ITEM.SP.VD.DISP - 24 ) / 2;
      250     9067                                                /*
      251     9068        SPEC_ACODE
      252     9069                                                     */
      253     9070    2          CASE( %SPEC_ACODE );
      254     9071    3             DO CASE( ITEM.SP.VS.ID );
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:8    
      255     9072    3               CASE( %O_RTN );
      256     9073    3                  IF S_D.O$.NOT_IS
      257     9074    4                  THEN DO;
      258     9075    4                       SEG = S_D.O$.SEG;
      259     9076    4                       DESC# = S_D.O$.DESC#;
      260     9077    4                     END;
      261     9078    3                  ADDRESS = S_D.O$.ADDRESS;
      262     9079    3                  GOTO CHKADDREXP;
      263     9080    3               CASE( %N_RTN );
      264     9081    3                  IF S_D.O$.NOT_IS
      265     9082    4                  THEN DO;
      266     9083    4                       SEG = S_D.O$.SEG;
      267     9084    4                       DESC# = S_D.O$.DESC#;
      268     9085    4                     END;
      269     9086    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      270     9087    3                  THEN ADDRESS = S_D.O$.ADDRESS + 1;
      271     9088    3                  ELSE ADDRESS = S_D.O$.ADDRESS + S_D.O$SIZE;
      272     9089    3                  GOTO CHKADDREXP;
      273     9090    3               CASE( %I_RTN );
      274     9091    3                  ADDRESS = S_D.SAVEIC;
      275     9092    3                  GOTO CHKADDREXP;
      276     9093    3               CASE( %L_RTN );
      277     9094    3                  IF S_D.L$.SIZE >= 36
      278     9095    3                  THEN ADDRESS = S_D.L$.VALUE.L;
      279     9096    4                  ELSE DO CASE( S_D.L$.FMT );
      280     9097    4                    CASE( %BIT_FMT );
      281     9098    4                       ADDRESS = 0;
      282     9099    5                       DO I = 1 TO S_D.L$.SIZE;
      283     9100    5                            J = S_D.L$.SIZE - I;
      284     9101    5                            ADDRESSBITS( J ) = S_D.L$.VB.VBITS( J );
      285     9102    5                          END;
      286     9103    4                    CASE( %CHAR_FMT );
      287     9104    4                       ADDRESS = BITBIN('040040040040'O);
      288     9105    4                       SIZED9 = S_D.L$.SIZE / 9;
      289     9106    5                       DO I = 1 TO SIZED9;
      290     9107    5                            J = SIZED9 - I;
      291     9108    5                            ADDRESSCHARS( J ) = S_D.L$.VC.VCHARS( J );
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:9    
      292     9109    5                          END;
      293     9110    4                    CASE( ELSE );
      294     9111    4                       ADDRESS = S_D.L$.VALUE.L;
      295     9112    4                    END;                   /* DO CASE( S_D.L$.FMT ) */
      296     9113    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      297     9114    3                  THEN S_D.GOT$L = '1'B;
      298     9115    3   CHKADDREXP:
      299     9116    3                  IF EXPR_OP > 0
      300     9117    3                  THEN CALL DDK$ADDEXPR(ADDRESS, EXPR_VAL, EXPR_OP);
      301     9118    3                  GOTO GOTSEG;
      302     9119    3               CASE( %IOBUFSZ_RTN );
      303     9120    3                  IF NOT D_XDELTA
      304     9121    4                  THEN DO;
      305     9122    4   NOTXDELTA:
      306     9123    4                       S_D.ERROR = 111; /* E@XDONLYSYM */
      307     9124    4                       ALTRETURN;
      308     9125    4                     END;
      309     9126    3                  DESC# = 4;
      310     9127    3                  ADDRESS = 6;
      311     9128    3               CASE( %IND_RTN );
      312     9129    3                  DESC# = 0;
      313     9130    3                  ADDRESS = 11;
      314     9131    3               CASE( %IC_RTN );
      315     9132    3                  DESC# = 0;
      316     9133    3                  ADDRESS = 12;
      317     9134    3               CASE( %E_RTN );
      318     9135    3                  DESC# = 0;
      319     9136    3                  ADDRESS = 0;
      320     9137    3               CASE( %A_RTN );
      321     9138    3                  DESC# = 0;
      322     9139    3                  ADDRESS = 1;
      323     9140    3               CASE( %Q_RTN );
      324     9141    3                  DESC# = 0;
      325     9142    3                  ADDRESS= 2;
      326     9143    3               CASE( %X_RTN );
      327     9144    3                  DESC# = 0;
      328     9145    3                  ADDRESS = 3 + ITEM.SP.VS.SZ;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:10   
      329     9146    3               CASE( %AU_RTN );
      330     9147    3                  DESC# = 3;
      331     9148    3                  ADDRESS = 0;
      332     9149    3               CASE( %AL_RTN );
      333     9150    3                  DESC# = 3;
      334     9151    3                  ADDRESS = 1;
      335     9152    3               CASE( %QU_RTN );
      336     9153    3                  DESC# = 3;
      337     9154    3                  ADDRESS = 2;
      338     9155    3               CASE( %QL_RTN );
      339     9156    3                  DESC# = 3;
      340     9157    3                  ADDRESS = 3;
      341     9158    3               CASE( %AR_RTN );
      342     9159    3                  DESC# = 1;
      343     9160    3                  ADDRESS = ITEM.SP.VS.SZ;
      344     9161    3               CASE( %WSR_RTN );
      345     9162    3                  IF NOT D_XDELTA THEN GOTO NOTXDELTA;
      346     9163    3                  DESC# = 5;
      347     9164    3                  ADDRESS = ITEM.SP.VS.SZ;
      348     9165    3               CASE( %WSQ_RTN );
      349     9166    3                  IF NOT D_XDELTA THEN GOTO NOTXDELTA;
      350     9167    3                  DESC# = 6;
      351     9168    3                  ADDRESS = ITEM.SP.VS.SZ;
      352     9169    3               CASE( %@_RTN );
      353     9170    3                  IF NOT S_D.DEFINED@
      354     9171    3                  THEN CALL DDI$GET_PATCH_SPACE;
      355     9172    3                  IF NOT S_D.GOT@
      356     9173    4                  THEN DO;
      357     9174    4                       S_D.ERROR = 151;  /* E@NO@ */
      358     9175    4                       ALTRETURN;
      359     9176    4                     END;
      360     9177    3                  ADDRESS = S_D.NEXT@;
      361     9178    3                  GOTO CHKADDREXP;
      362     9179    3               CASE( %@@_RTN );
      363     9180    3                  IF NOT S_D.DEFINED@
      364     9181    3                  THEN CALL DDI$GET_PATCH_SPACE;
      365     9182    3                  IF NOT S_D.GOT@
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:11   
      366     9183    4                  THEN DO;
      367     9184    4                       S_D.ERROR = 151;  /* E@NO@ */
      368     9185    4                       ALTRETURN;
      369     9186    4                     END;
      370     9187    3                  ADDRESS = S_D.NEXT@;
      371     9188    3                  IF MOD(ADDRESS, 2) ~= 0
      372     9189    4                  THEN DO;
      373     9190    4                       ADDRESS = ADDRESS + 1;
      374     9191    4                     END;
      375     9192    3                  GOTO CHKADDREXP;
      376     9193    3               CASE( %#_RTN );
      377     9194    3                  IF NOT S_D.DEFINED#
      378     9195    3                  THEN CALL DDI$GET_PATCH_SPACE;
      379     9196    3                  IF NOT S_D.GOT#
      380     9197    4                  THEN DO;
      381     9198    4                       S_D.ERROR = 152;  /* E@NO# */
      382     9199    4                       ALTRETURN;
      383     9200    4                     END;
      384     9201    3                  ADDRESS = S_D.NEXT#;
      385     9202    3                  GOTO CHKADDREXP;
      386     9203    3               CASE( %##_RTN );
      387     9204    3                  IF NOT S_D.DEFINED#
      388     9205    3                  THEN CALL DDI$GET_PATCH_SPACE;
      389     9206    3                  IF NOT S_D.GOT#
      390     9207    4                  THEN DO;
      391     9208    4                       S_D.ERROR = 152;  /* E@NO# */
      392     9209    4                       ALTRETURN;
      393     9210    4                     END;
      394     9211    3                  ADDRESS = S_D.NEXT#;
      395     9212    3                  IF MOD(ADDRESS, 2) ~= 0
      396     9213    4                  THEN DO;
      397     9214    4                       ADDRESS = ADDRESS + 1;
      398     9215    4                     END;
      399     9216    3                  GOTO CHKADDREXP;
      400     9217    3               CASE( %RI_RTN );
      401     9218    3                  ADDRESS = S_D.RI$.OPS(0);
      402     9219    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:12   
      403     9220    3                  THEN S_D.GOT$RI = '1'B;
      404     9221    3                  GOTO CHKADDREXP;
      405     9222    3               CASE( %NA_RTN );
      406     9223    3                  ADDRESS = S_D.NA$;
      407     9224    3                  GOTO CHKADDREXP;
      408     9225    3               CASE( %SA_RTN );
      409     9226    3                  SEG = 7;
      410     9227    3                  DESC# = 0;
      411     9228    3                  ADDRESS = 0;
      412     9229    3                  GOTO GOTSEG;
      413     9230    3               CASE( %PRIV_RTN );
      414     9231    3                  SEG = 7;
      415     9232    3                  DESC# = 1;
      416     9233    3                  ADDRESS = 0;
      417     9234    3                  GOTO GOTSEG;
      418     9235    3               CASE( %FMASK_RTN );
      419     9236    3                  DESC# = 7;
      420     9237    3                  ADDRESS = 0;
      421     9238    3               CASE( %FRANGE_RTN );
      422     9239    3                  DESC# = 7;
      423     9240    3                  ADDRESS = 1;
      424     9241    3               CASE(%CI_RTN, %T_RTN, %S_RTN, %IV_RTN, %Z_RTN,
      425     9242    3                    %ASV_RTN, %R_RTN, %M_RTN);
      426     9243    3                  IF S_D.RUM
      427     9244    3                  THEN S_D.ERROR = 232; /* E@NOSSRUM */
      428     9245    3                  ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */
      429     9246    3                  ALTRETURN;
      430     9247    3               CASE( ELSE );
      431     9248    3                  S_D.ERROR = 503;    /* E@NOTIMP */
      432     9249    3                  ALTRETURN;
      433     9250    3               END;                        /* DO CASE( ITEM.SP.VS.ID ) */
      434     9251    2             SEG = 6;
      435     9252    2   GOTSEG:   SEG = SEG;                    /* Fall through DO CASE statement */
      436     9253                                                /*
      437     9254        BIGBASED_ACODE, BIGSTATIC_ACODE
      438     9255                                                */
      439     9256    2          CASE( %BIGBASED_ACODE, %BIGSTATIC_ACODE );
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:13   
      440     9257    2             ADDRESS = ITEM.VALUE;
      441     9258    2             GOTO BASED_STATIC;
      442     9259                                                /*
      443     9260        VIRT_ACODE
      444     9261                                                */
      445     9262    2          CASE( %VIRT_ACODE );
      446     9263    2             TADDRESS = ITEM.ADDRESS.W;
      447     9264    2             SEG = 3;
      448     9265    2             DESC# = 0;
      449     9266    2             NOT_IS = '0'B;
      450     9267                                                /* Go get offset */
      451     9268    2             CALL DDK$GETMVAL(ADDRESS, TADDRESS, SEG, DESC#, NOT_IS) ALTRET(
              9268                      TRAP_VIRTUAL);
      452     9269    2             TADDRESS = TADDRESS + 1;
      453     9270                                                /* Go get descriptor */
      454     9271    2             CALL DDK$GETMVAL(PNTR, TADDRESS, SEG, DESC#, NOT_IS) ALTRET(TRAP_VIRTUAL);
      455     9272    2             DESC# = PNTR.DESC#;
      456     9273    2             NOT_IS = '1'B;
      457     9274    2             GOTO ADD_INDXX;
      458     9275                                                /*
      459     9276        BASED_ACODE, STATIC_ACODE, AUTO_ACODE, PARM_ACODE, DCB_ACODE
      460     9277                                                */
      461     9278    2          CASE(%BASED_ACODE, %STATIC_ACODE, %AUTO_ACODE, %PARM_ACODE, %DCB_ACODE);
      462     9279    2             ADDRESS = ITEM.ADDRESS.W;
      463     9280    2   ADD_INDXX:
      464     9281    2             IF ARRAY_FLAG
      465     9282    2             THEN ADDRESS = ADDRESS + INDXX / 36;
      466     9283    2             IF ADDR(BITOFF) ~= ADDR(NIL)
      467     9284    3             THEN DO;
      468     9285    3                  I = MOD(INDXX,36) + ITEM.ADDRESS.C * 9 + ITEM.ADDRESS.B;
      469     9286    3                  ADDRESS = ADDRESS + I / 36;
      470     9287    3                  BITOFF = MOD(I, 36);
      471     9288    3                END;
      472     9289    2   BASED_STATIC:
      473     9290    2             IF EXPR_OP > 0
      474     9291    2             THEN CALL DDK$ADDEXPR(ADDRESS, EXPR_VAL, EXPR_OP);
      475     9292                                                /**/
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:14   
      476     9293    3             DO CASE(ADDR_TYPE);
      477     9294                                                /**/
      478     9295    3               CASE(%STATIC_ACODE,
      479     9296    3               %VIRT_ACODE,
      480     9297    3               %BIGSTATIC_ACODE);
      481     9298    3                  IF ADDR(BSIZE) ~= ADDR(NIL)
      482     9299    3                  THEN BSIZE = SIZE;
      483     9300    3                  RETURN;                  /* Shortcut out of here */
      484     9301    3               CASE(%AUTO_ACODE);
      485     9302    3                  POINTER = BITBIN(DESC.ITEM(%AUTO_DESC)
      486     9303    3                    & '777777770000'O | '000000002000'O);
      487     9304    3                  GOTO FINDSTACK;
      488     9305    3               CASE( %PARM_ACODE );
      489     9306    3   FINDSTACK:     ;
      490     9307    3                  IF S_D.RUM
      491     9308    3                    OR S_D.ANLZ
      492     9309    4                  THEN DO;
      493     9310    4                       S_D.ERROR = 214; /* E@CANTAUTOMODE */
      494     9311    4                       ALTRETURN;
      495     9312    4                     END;
      496     9313        /*N* TEMP TO USE TOP STACK FRAME */
      497     9314        %IF '0'B;
      531     9348        %ENDIF;
      532     9349    3   GOTSTACK:      ;
      533     9350    3                  S_D.ACCESS = '0'B;
      534     9351    3                  S_D.ASTACKOFF = STACKOFF;
      535     9352    3               CASE(ELSE);
      536     9353                                                /* Do nothing for based type acodes */
      537     9354    3               END;                        /* DO CASE(ADDR_TYPE) */
      538     9355                                                /*
      539     9356                                 Now need to interpret pointer to provide SEG, DESC# and
      540     9357                                 (perhaps) additional offset information
      541     9358                                 */
      542     9359    2             IF POINTR.SEG = 1
      543     9360    3             THEN DO;            /* Evaluate ITEM as special descriptor symbol */
      544     9361    4                  DO CASE(PSDITEM.TYPE);
      545     9362    4                    CASE(0);               /* $SSR, $JIT, $HJIT */
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:15   
      546     9363    4                       SEG = 1;
      547     9364    5                       DO CASE(PSDITEM.ID);
      548     9365    5                         CASE(0);          /* $SSR */
      549     9366    5                            DESC# = 6;
      550     9367    5                         CASE(1);          /* $JIT */
      551     9368    5                            DESC# = 7;
      552     9369    5                         CASE(2);          /* $HJIT */
      553     9370    5                            DESC# = 8;
      554     9371    5                         CASE(3);          /* $TCB */
      555     9372    5                            IF D_XDELTA
      556     9373    6                            THEN DO;
      557     9374    6                                 S_D.ERROR = 113; /* E@UDONLYSYM */
      558     9375    6                                 ALTRETURN;
      559     9376    6                               END;
      560     9377    5                            DESC# = 9;
      561     9378    5                         CASE(4);          /* $SAD */
      562     9379    5                            IF S_D.SAD < 0
      563     9380    6                            THEN DO;
      564     9381    6                                 S_D.ERROR = 181; /* E@NOSAD */
      565     9382    6                                 ALTRETURN;
      566     9383    6                               END;
      567     9384    5                            DESC# = 10;
      568     9385    5                         CASE(5, 6, 7);    /* $RVB, $USD, $ERR */
      569     9386    5                            IF NOT S_D.ANLZ_FILE
      570     9387    6                            THEN DO;
      571     9388    6                                 S_D.ERROR = 182; /* E@NOTANLZ_FILE */
      572     9389    6                                 ALTRETURN;
      573     9390    6                               END;
      574     9391    5                            DESC# = PSDITEM.ID + 6; /* 11, 12, 13 */
      575     9392    5                         CASE(8);          /* $HEAD */
      576     9393    5                            IF NOT S_D.RUM
      577     9394    6                            THEN DO;
      578     9395    6                                 S_D.ERROR = 202; /* E@RUMONLY */
      579     9396    6                                 ALTRETURN;
      580     9397    6                               END;
      581     9398    5                            SEG = 7;
      582     9399    5                            DESC# = 2;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:16   
      583     9400    5                         CASE(9);          /* $CGn */
      584     9401    5                            IF NOT S_D.ANLZ_FILE
      585     9402    6                            THEN DO;
      586     9403    6                                 S_D.ERROR = 182; /* E@NOTANLZ_FILE */
      587     9404    6                                 ALTRETURN;
      588     9405    6                               END;
      589     9406    5                            SEG = 8;
      590     9407    5                            DESC# = PSDITEM.DISP;
      591     9408    5                         END;              /* DO CASE(PSDITEM.ID) */
      592     9409    4                    CASE(1);               /* $PSR, $ASR, $ISR, $LSR */
      593     9410    4                       SEG = 1;
      594     9411    5                       DO CASE(PSDITEM.ID);
      595     9412    5                         CASE(0);          /* $PSR */
      596     9413    5                            DESC# = 3;
      597     9414    5                         CASE(2);          /* $ASR */
      598     9415    5                            DESC# = 4;
      599     9416    5                         CASE(1);          /* $ISR */
      600     9417    5                            SEG = 3;
      601     9418    5                            DESC# = 0;
      602     9419    5                         CASE(3);          /* $LSR */
      603     9420    5                            DESC# = 5;
      604     9421    5                         END;              /* DO CASE(PSDITEM.ID) */
      605     9422    4                    CASE(2);               /* $DRn, $PRn, $AUTO */
      606     9423    4                       TEMP = (PSDITEM.DISP - 24) / 2 + 16;
      607     9424    4                       PNTR = S_D.USS$ -> SS_PTR(TEMP);
      608     9425    4                       IF PSDITEM.ID ~= 0
      609     9426    5                       THEN DO;            /* Add offset from ARn */
      610     9427    5                            IF PSDITEM.ID = 24 AND FALSE /* TEMP FOR TOP FRAME !! */
      611     9428    6                            THEN DO;
      612     9429    6                                 PNTR.ADR='0'B;
      613     9430    6                                 PNTR.ADR.W = S_D.ASTACKOFF;
      614     9431    6                               END;
      615     9432    5                            CALL ADDPNTR;
      616     9433    5                          END;
      617     9434    5                       ELSE DO;
      618     9435    5                            SEG = PNTR.SEG;
      619     9436    5                            DESC# = PNTR.DESC#;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:17   
      620     9437    5                          END;
      621     9438    4                       IF DESC# >= BITBIN('1700'O)
      622     9439    5                       THEN DO;
      623     9440    5                            S_D.ERROR = 58; /* E@CANTEVAL */
      624     9441    5                            ALTRETURN;
      625     9442    5                          END;
      626     9443    4                    CASE(3);               /* $PSn, $ASn, $LSn, $DSn */
      627     9444    4                       SEG = PSDITEM.ID;
      628     9445    4                       DESC# = PSDITEM.DISP / 2;
      629     9446    4                    CASE(4);               /* $REAL, $VIRT */
      630     9447    4                       SEG = 1;
      631     9448    4                       DESC# = PSDITEM.ID;
      632     9449    4                    CASE(5);               /* $IOBUF */
      633     9450    4                       SEG = 1;
      634     9451    4                       DESC# = 2;
      635     9452    4                    CASE(6);               /* $PARMn */
      636     9453    4                       IF NOT U$SE.CUR
      637     9454    5                       THEN DO;
      638     9455    5                            S_D.ERROR = 38; /* E@USE_CONFLICT */
      639     9456    5                            ALTRETURN;
      640     9457    5                          END;
      641     9458    4                       TEMP = PSDITEM.DISP + PSDITEM.ID * 512;
      642     9459    4                       CALL DDK$GETPARM(TEMP, PNTR) ALTRET(BADPARM);
      643     9460    4                       CALL ADDPNTR;
      644     9461    4                    CASE(7);               /* $DCBn */
      645     9462    4                       SEG = 5;
      646     9463    4                       DESC# = PSDITEM.DISP;
      647     9464    4                    CASE(8,9);             /* $ROSEG, $RDBR, $TSA, $Bn */
      648     9465    4                       IF S_D.RUM
      649     9466    4                       THEN S_D.ERROR = 232; /* E@NOSSRUM */
      650     9467    4                       ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */
      651     9468    4                       ALTRETURN;
      652     9469    4                    CASE(10);              /* $RES */
      653     9470    4                       SEG = 13;
      654     9471    4                       DESC# = 0;
      655     9472    4                    END;                   /* DO CASE(PSDITEM.TYPE) */
      656     9473    3                END;        /* DO(Evaluate ITEM as special descriptor symbol) */
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:18   
      657     9474    3             ELSE DO;                      /* Evaluate ITEM as user pointer */
      658     9475    3                  PNTR = POINTR;
      659     9476    3                  CALL ADDPNTR;
      660     9477    3                END;                       /* DO(Evaluate ITEM as pointer) */
      661     9478    2          CASE( ELSE );                    /* Shouldn't happen */
      662     9479    2             S_D.ERROR = 502;         /* E@DELBUG */
      663     9480    2             CALL DDE$ERROR;
      664     9481    2             RETURN;
      665     9482    2          END;                             /* DO CASE(ADDR_TYPE) */
      666     9483                                                /**/
      667     9484    1        IF SEG ~= 3                        /* LS */
      668     9485    1          OR DESC# ~= 0                    /* IS */
      669     9486    1        THEN NOT_IS = '1'B;
      670     9487    1        IF ADDR(BSIZE) ~= ADDR(NIL)
      671     9488    1        THEN BSIZE = SIZE;
      672     9489    1        RETURN;
      673     9490    1   TRAP_VIRTUAL: ;
      674     9491    1        S_D.ERROR = 264;        /* E@TRAP_VIRTUAL */
      675     9492    1        ALTRETURN;
      676     9493    1   BADPARM:
      677     9494    1        S_D.ERROR = 103;       /* E@PACCESS_FAULT */
      678     9495    1   AERR:
      679     9496    1        ALTRETURN;
      680     9497             %EJECT;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:19   
      681     9498    1   ADDPNTR: PROC;                          /* Add user pointer to ADDRESS */
      682     9499    2        ADDRESS = ADDRESS + PNTR.ADR.W;
      683     9500    2        IF ADDR(BITOFF) ~= ADDR(NIL)
      684     9501    3        THEN DO;
      685     9502    3             BITOFF = BITOFF + PNTR.ADR.C * 9 + PNTR.ADR.B;
      686     9503    3             ADDRESS = ADDRESS + BITOFF / 36;
      687     9504    3             BITOFF = MOD(BITOFF, 36);
      688     9505    3           END;
      689     9506    2        SEG = PNTR.SEG;
      690     9507    2        DESC# = PNTR.DESC#;
      691     9508    2        RETURN;
      692     9509    2   END ADDPNTR;
      693     9510                                                /**/
      694     9511    1   END DDK$EVAL;

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:20   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$EVAL.

   Procedure DDK$EVAL requires 1087 words for executable code.
   Procedure DDK$EVAL requires 50 words of local(AUTO) storage.

    No errors detected in file DDK$EVAL.:E05TSI    .

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:21   

 Object Unit name= DDK$EVAL                                   File name= DDK$EVAL.:E05TOU
 UTS= JUL 29 '97 14:00:00.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      3      3  DDK$EVAL
    1   Proc  even  none  1087   2077  DDK$EVAL
    2  RoData even  none     1      1  DDK$EVAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        6  DDK$EVAL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       9 DDK$GETADDR
         yes           Std       3 DDK$ADDEXPR
 yes     yes           Std       5 DDK$GETMVAL
         yes           Std       0 DDI$GET_PATCH_SPACE
 yes     yes           Std       2 DDK$GETPARM
         yes           Std       0 DDE$ERROR
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AUTO_N
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:22   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     USE$                                  DESC                             r    S_D$
     D_XDELTA                              B_VECTNIL
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:23   


        1        1        /*M*  DDK$EVAL - EVALUATES DATA DESCRIPTOR ADDRESS */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MCL=4,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*F*  NAME: DDK$EVAL
       10       10              PURPOSE: Using DDK$GETADDR, this routine evaluates a
       11       11                  data reference descriptor, returning a segid and a
       12       12                  word offset for the address of the item described.
       13       13              DESCRIPTION:  Input is a data reference descriptor @ S_D.DESC$
       14       14                            Output is ADDRESS - word offset in segment
       15       15                                 and SEG, DESC# the encoded segment ID
       16       16                                      SEG = 0 DESC# is $PSn
       17       17                                      SEG = 1 indicates encoded special segment
       18       18                                           DESC# = 0 $REAL
       19       19                                                   1 $VIRT
       20       20                                                   2 $IOBUF
       21       21                                                   3 $PSR
       22       22                                                   4 $ASR
       23       23                                                   5 $LSR
       24       24                                                   6 $SSR
       25       25                                                   7 $JIT
       26       26                                                   8 $HJIT
       27       27                                                   9 $TCB
       28       28                                                  10 $SAD
       29       29                                                  11 $RVB
       30       30                                                  12 $USD
       31       31                                                  13 $ERR
       32       32                                      SEG = 2 DESC# is $ASn
       33       33                                      SEG = 3 DESC# is $LSn
       34       34                                           (Normal addresses are SEG = 3,
       35       35                                            DESC# = 0, NOT_IS = '0'B )
       36       36                                      SEG = 5 DESC# IS DCB #
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:24   
       37       37                                      SEG = 6 indicates Host encoded special symbol
       38       38                                           DESC# = 0
       39       39                                                ADDRESS = 0 $E
       40       40                                                          1 $A
       41       41                                                          2 $Q
       42       42                                                          3 $X0
       43       43                                                          4 $X1
       44       44                                                          5 $X2
       45       45                                                          6 $X3
       46       46                                                          7 $X4
       47       47                                                          8 $X5
       48       48                                                          9 $X6
       49       49                                                         10 $X7
       50       50                                                         11 $IND
       51       51                                                         12 $IC
       52       52                                           DESC# = 1 $ARn
       53       53                                                ADDRESS = n
       54       54                                           DESC# = 2 $PRn
       55       55                                                ADDRESS = n
       56       56                                           DESC# = 3
       57       57                                                ADDRESS = 0 $AU
       58       58                                                          1 $AL
       59       59                                                          2 $QU
       60       60                                                          3 $QL
       61       61                                           DESC# = 4
       62       62                                                ADDRESS = 0 $IOBUFSZ
       63       63                                           DESC# = 5 $WSRn
       64       64                                                ADDRESS = n
       65       65                                           DESC# = 6 $WSQn
       66       66                                                ADDRESS = n
       67       67                                      SEG = 7 indicates HEAD record (RUM only)
       68       68                                           DESC# = 0 $SA
       69       69                                                   1 $PRIV
       70       70                                                   2 $HEAD (ADDRESS is offset)
       71       71                                      SEG = 8 DESC# = CG number (ANLZ_FILE only)
       72       72                                      SEG = 9 indicates L6 encoded special symbol
       73       73                                           DESC# = 0
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:25   
       74       74                                                ADDRESS = 0 $R1
       75       75                                                          1 $R2
       76       76                                                          2 $R3
       77       77                                                          3 $R4
       78       78                                                          4 $R5
       79       79                                                          5 $R6
       80       80                                                          6 $R7
       81       81                                                          7 $M1
       82       82                                                          8 $M2
       83       83                                                          9 $M3
       84       84                                                         10 $M4
       85       85                                                         11 $M5
       86       86                                                         12 $M6
       87       87                                                         13 $M7
       88       88                                                         14 $T
       89       89                                                         15 $S
       90       90                                                         16 $A
       91       91                                                         17 $IV
       92       92                                                         18 $Z
       93       93                                                         19 $ASV
       94       94                                                         20 $CI
       95       95                                                         21 $IND
       96       96                                           DESC# = 1
       97       97                                                ADDRESS = 0 $ROSEG
       98       98                                           DESC# = 2
       99       99                                                ADDRESS = 0 $RDBR
      100      100                                           DESC# = 3
      101      101                                                ADDRESS = 0 $TSA
      102      102                                           DESC# = 4
      103      103                                                ADDRESS = 0 $AUTO
      104      104
      105      105                                      SEG = 10   $Bn - L6
      106      106                                           DESC# = n
      107      107
      108      108                                      SEG = 11   $DSn - L6
      109      109                                           DESC# = n
      110      110
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:26   
      111      111                                      SEG = 12  $ISn - L6
      112      112                                           DESC# = n
      113      113
      114      114                                      SEG = 13 $RES
      115      115
      116      116                            The bit flag NOT_IS is set if the segment is not
      117      117                            the instruction segment (seg=3, DESC#=0)
      118      118
      119      119                       The ALTRET is taken if something prevents evaluation
      120      120                       of the address:
      121      121                            E@USE_CONFLICT  (need SS, dont have it)
      122      122                            E@CANTEVAL     (Self-ID'ing descriptor found)
      123      123                                                     */
      124      124        DDK$EVAL: PROC(ADDRESS, SEG, DESC#, NOT_IS, BITOFF, BSIZE) ALTRET;

    124  1 000000   000000 700200 xent  DDK$EVAL     TSX0  ! X66_AUTO_N
         1 000001   000062 000006                    ZERO    50,6

      125      125          /* Parms */
      126      126    1   DCL ADDRESS SBIN;
      127      127    1   DCL ADDRESSBITS(0:35) REDEF ADDRESS UBIN(1) UNAL;
      128      128    1   DCL ADDRESSCHARS(0:3) REDEF ADDRESS CHAR(1);
      129      129    1   DCL SEG UBIN(36);
      130      130    1   DCL DESC# UBIN(36);
      131      131    1   DCL NOT_IS BIT(1) ALIGNED;
      132      132    1   DCL BITOFF SBIN;
      133      133    1   DCL BSIZE UBIN;
      134      134          /* Locals */
      135      135    1   DCL FALSE BIT(1) ALIGNED CONSTANT INIT('0'B);
      136      136    1   DCL I SBIN;
      137      137    1   DCL J UBIN;
      138      138    1   DCL SIZED9 UBIN;
      139      139    1   DCL SVALUE SBIN;
      140      140    1   DCL SIZE SBIN;
      141      141    1   DCL INDXX SBIN;
      142      142    1   DCL POINTER UBIN(36);
      143      143    1   DCL 1 POINTR REDEF POINTER,
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:27   
      144      144    1         2 ADR,
      145      145    1           3 W UBIN(18) UNAL,
      146      146    1           3 C UBIN(2) UNAL,
      147      147    1           3 B UBIN(4) UNAL,
      148      148    1         2 SEG UBIN(2) UNAL,
      149      149    1         2 DESC# UBIN(10) UNAL;
      150      150    1   DCL 1 PSDITEM REDEF POINTER,
      151      151    1         2 TYPE UBIN(6) UNAL,
      152      152    1         2 ID UBIN(9) UNAL,
      153      153    1         2 DISP UBIN(9) UNAL,
      154      154    1         2 SEGID UBIN(12) UNAL;
      155      155    1   DCL EXPR_VAL SBIN;
      156      156    1   DCL EXPR_OP SBIN;
      157      157    1   DCL ADDR_TYPE SBIN;
      158      158    1   DCL ARRAY_FLAG BIT(1);
      159      159    1   DCL SFLAG BIT(1);
      160      160    1   DCL 1 PNTR,
      161      161    1         2 ADR,
      162      162    1           3 W UBIN(18) UNAL,
      163      163    1           3 C UBIN(2) UNAL,
      164      164    1           3 B UBIN(4) UNAL,
      165      165    1         2 SEG UBIN(2) UNAL,
      166      166    1         2 DESC# UBIN(10) UNAL;
      167      167    1   DCL TEMP SBIN;
      168      168    1   DCL TADDRESS UBIN;
      169      169    1   DCL 1 PUP,
      170      170    1         2 SIZE UBIN(22) UNAL,
      171      171    1         2 SCALE SBIN(8) UNAL,
      172      172    1         2 PUB UBIN(2) UNAL,
      173      173    1         2 SIGNPOS UBIN(2) UNAL,
      174      174    1         2 SIGNTYP BIT(1),
      175      175    1         2 SIGNOVER BIT(1);
      176      176          /* Misc */
      177      177    1   DCL USE$ PTR SYMREF;
      178      178             %INCLUDE DD$BASED;
      179     1481             %U$SE;
      180     1489             %INCLUDE DD_DESC_R;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:28   
      181     1539    1   DCL SS_PTR(0:24) BIT(36) ALIGNED BASED;
      182     1540    1   DCL UDR2$ PTR SYMREF;
      183     1541    1   DCL UIS$ PTR SYMREF;
      184     1542    1   DCL STACKIC UBIN;
      185     1543    1   DCL STACKOFF UBIN;
      186     1544    1   DCL RSTACKOFF UBIN;
      187     1545    1   DCL RETADDR UBIN;
      188     1546    1   DCL STACK$ PTR;
      189     1547    1   DCL TEDEF$ PTR;
      190     1548             %INCLUDE DD_ERR_C;
      191     1945             %INCLUDE DD$DITEM;
       12+    2048             %LIST;
       13+    2049    1        DCL SDD$ PTR;
       14+    2050    1        DCL ZITEM$ PTR;
       15+    2051    1        DCL SDD_L6$ PTR;
       16+    2052    1        DCL ZITEM_L6$ PTR;
      192     2626             %ZITEM;
      193     2698             %DITEM (NAME=ITEM, STCLASS=AUTO);
      194     2778    1   DCL 1 W BASED ALIGNED,
      195     2779    1         2 LEFT UBIN HALF UNAL,
      196     2780    1         2 RIGHT UBIN HALF UNAL;
      197     2781             %INCLUDE B$OBJECT_C;
      198     6211             %B$EDEF;
      199     6281             %INCLUDE XUH_MACRO_C;
      200     6365             %INCLUDE DD_SD_M;
      201     7701             %S_D;
      202     9019    1   DCL D_XDELTA BIT(1) SYMREF;
      203     9020          /* External routines */
      204     9021    1   DCL DDE$ERROR ENTRY;
      205     9022    1   DCL DDI$GET_PATCH_SPACE ENTRY;
      206     9023    1   DCL DDK$GETADDR ENTRY(9) ALTRET;
      207     9024    1   DCL DDK$GETMVAL ENTRY(5) ALTRET;
      208     9025    1   DCL DDK$GETSPEC ENTRY(2) ALTRET;
      209     9026    1   DCL DDK$GETPARM ENTRY(2) ALTRET;
      210     9027    1   DCL DDK$ADDEXPR ENTRY(3);
      211     9028    1   DCL DDF$FIND_PEDEF ENTRY(2) ALTRET;
      212     9029                                                /**/
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:29   
      213     9030    1        ZITEM$ = S_D.DESC$;

   9030  1 000002   000000 470400 xsym               LDP0    S_D$
         1 000003   000041 236100                    LDQ     33,,PR0
         1 000004   200040 756100                    STQ     ZITEM$,,AUTO

      214     9031    1        IF ADDR(BITOFF) ~= ADDR(NIL)

   9031  1 000005   200007 236100                    LDQ     @BITOFF,,AUTO
         1 000006   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000007   000012 600000 1                  TZE     s:9033

      215     9032    1        THEN BITOFF=0;

   9032  1 000010   200007 471500                    LDP1    @BITOFF,,AUTO
         1 000011   100000 450100                    STZ     0,,PR1

      216     9033    1        IF D_XDELTA AND S_D.DESC$->ZITEM.FLAGS.MDSE.S

   9033  1 000012   000000 234000 xsym               SZN     D_XDELTA
         1 000013   000026 605000 1                  TPL     s:9039
         1 000014   000041 471500                    LDP1    33,,PR0
         1 000015   100001 236100                    LDQ     1,,PR1
         1 000016   100000 316003                    CANQ    32768,DU
         1 000017   000026 600000 1                  TZE     s:9039
         1 000020   000000 473400 xsym               LDP3    USE$
         1 000021   300000 234100                    SZN     0,,PR3
         1 000022   000026 604000 1                  TMI     s:9039

      217     9034    1          AND NOT U$SE.CUR
      218     9035    2        THEN DO;

      219     9036    2             S_D.ERROR = 38;   /* E@USE_CONFLICT */

   9036  1 000023   000046 235007                    LDA     38,DL
         1 000024   000013 755100                    STA     11,,PR0

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:30   
      220     9037    2             ALTRETURN;

   9037  1 000025   000000 702200 xent               TSX2  ! X66_AALT

      221     9038    2           END;
      222     9039    1        S_D.ARRAY.FIRST = '1'B;            /* In case it's an array */

   9039  1 000026   400000 236003                    LDQ     -131072,DU
         1 000027   000715 756100                    STQ     461,,PR0

      223     9040    1        CALL DDK$GETADDR(ITEM, SVALUE, SIZE, INDXX, POINTER, EXPR_VAL,

   9040  1 000030   200023 631500                    EPPR1   ARRAY_FLAG,,AUTO
         1 000031   200060 451500                    STP1    ITEM+13,,AUTO
         1 000032   200022 633500                    EPPR3   ADDR_TYPE,,AUTO
         1 000033   200057 453500                    STP3    ITEM+12,,AUTO
         1 000034   200021 634500                    EPPR4   EXPR_OP,,AUTO
         1 000035   200056 454500                    STP4    ITEM+11,,AUTO
         1 000036   200020 635500                    EPPR5   EXPR_VAL,,AUTO
         1 000037   200055 455500                    STP5    ITEM+10,,AUTO
         1 000040   200017 636500                    EPPR6   POINTER,,AUTO
         1 000041   200054 456500                    STP6    ITEM+9,,AUTO
         1 000042   200016 637500                    EPPR7   INDXX,,AUTO
         1 000043   200053 457500                    STP7    ITEM+8,,AUTO
         1 000044   200015 630500                    EPPR0   SIZE,,AUTO
         1 000045   200052 450500                    STP0    ITEM+7,,AUTO
         1 000046   200014 630500                    EPPR0   SVALUE,,AUTO
         1 000047   200051 450500                    STP0    ITEM+6,,AUTO
         1 000050   200043 630500                    EPPR0   ITEM,,AUTO
         1 000051   200050 450500                    STP0    ITEM+5,,AUTO
         1 000052   200050 630500                    EPPR0   ITEM+5,,AUTO
         1 000053   000000 631400 2                  EPPR1   0
         1 000054   000000 701000 xent               TSX1    DDK$GETADDR
         1 000055   002026 702000 1                  TSX2    AERR

      224     9041    1          EXPR_OP, ADDR_TYPE, ARRAY_FLAG ) ALTRET(AERR);
      225     9042    1        PUP = ZITEM.PUP;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:31   

   9042  1 000056   200040 470500                    LDP0    ZITEM$,,AUTO
         1 000057   000010 236100                    LDQ     8,,PR0
         1 000060   200030 756100                    STQ     PUP,,AUTO

      226     9043    1        IF PUP.PUB = 1

   9043  1 000061   200030 236100                    LDQ     PUP,,AUTO
         1 000062   000060 376007                    ANQ     48,DL
         1 000063   000020 116007                    CMPQ    16,DL
         1 000064   000071 601000 1                  TNZ     s:9046

      227     9044    1        THEN SIZE = (SIZE * 9)/ 2;

   9044  1 000065   200015 236100                    LDQ     SIZE,,AUTO
         1 000066   000011 402007                    MPY     9,DL
         1 000067   000002 506007                    DIV     2,DL
         1 000070   200015 756100                    STQ     SIZE,,AUTO

      228     9045                                                /**/
      229     9046    1        SEG = 3;                           /* Unless ...            */

   9046  1 000071   000003 235007                    LDA     3,DL
         1 000072   200004 471500                    LDP1    @SEG,,AUTO
         1 000073   100000 755100                    STA     0,,PR1

      230     9047    1        DESC# = 0;                         /*  ... Something ...    */

   9047  1 000074   200005 473500                    LDP3    @DESC#,,AUTO
         1 000075   300000 450100                    STZ     0,,PR3

      231     9048    1        NOT_IS = '0'B;                     /*        ... Happens    */

   9048  1 000076   200006 474500                    LDP4    @NOT_IS,,AUTO
         1 000077   400000 450100                    STZ     0,,PR4

      232     9049                                                /**/
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:32   
      233     9050    2        DO CASE(ADDR_TYPE);

   9050  1 000100   200022 236100                    LDQ     ADDR_TYPE,,AUTO
         1 000101   000105 116007                    CMPQ    69,DL
         1 000102   000104 602006 1                  TNC     s:9050+4,QL
         1 000103   001767 710000 1                  TRA     s:9479
         1 000104   001134 710000 1                  TRA     s:9279
         1 000105   001134 710000 1                  TRA     s:9279
         1 000106   001134 710000 1                  TRA     s:9279
         1 000107   001134 710000 1                  TRA     s:9279
         1 000110   001134 710000 1                  TRA     s:9279
         1 000111   001767 710000 1                  TRA     s:9479
         1 000112   001767 710000 1                  TRA     s:9479
         1 000113   001767 710000 1                  TRA     s:9479
         1 000114   001063 710000 1                  TRA     s:9263
         1 000115   001767 710000 1                  TRA     s:9479
         1 000116   001767 710000 1                  TRA     s:9479
         1 000117   001767 710000 1                  TRA     s:9479
         1 000120   001767 710000 1                  TRA     s:9479
         1 000121   001767 710000 1                  TRA     s:9479
         1 000122   001767 710000 1                  TRA     s:9479
         1 000123   001767 710000 1                  TRA     s:9479
         1 000124   001767 710000 1                  TRA     s:9479
         1 000125   001767 710000 1                  TRA     s:9479
         1 000126   001767 710000 1                  TRA     s:9479
         1 000127   001767 710000 1                  TRA     s:9479
         1 000130   001767 710000 1                  TRA     s:9479
         1 000131   001767 710000 1                  TRA     s:9479
         1 000132   001767 710000 1                  TRA     s:9479
         1 000133   001767 710000 1                  TRA     s:9479
         1 000134   001767 710000 1                  TRA     s:9479
         1 000135   001767 710000 1                  TRA     s:9479
         1 000136   001767 710000 1                  TRA     s:9479
         1 000137   001767 710000 1                  TRA     s:9479
         1 000140   001767 710000 1                  TRA     s:9479
         1 000141   001767 710000 1                  TRA     s:9479
         1 000142   001767 710000 1                  TRA     s:9479
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:33   
         1 000143   001767 710000 1                  TRA     s:9479
         1 000144   001767 710000 1                  TRA     s:9479
         1 000145   001767 710000 1                  TRA     s:9479
         1 000146   001767 710000 1                  TRA     s:9479
         1 000147   001767 710000 1                  TRA     s:9479
         1 000150   001767 710000 1                  TRA     s:9479
         1 000151   001767 710000 1                  TRA     s:9479
         1 000152   001767 710000 1                  TRA     s:9479
         1 000153   001767 710000 1                  TRA     s:9479
         1 000154   001767 710000 1                  TRA     s:9479
         1 000155   001767 710000 1                  TRA     s:9479
         1 000156   001767 710000 1                  TRA     s:9479
         1 000157   001767 710000 1                  TRA     s:9479
         1 000160   001767 710000 1                  TRA     s:9479
         1 000161   001767 710000 1                  TRA     s:9479
         1 000162   001767 710000 1                  TRA     s:9479
         1 000163   001767 710000 1                  TRA     s:9479
         1 000164   001767 710000 1                  TRA     s:9479
         1 000165   001767 710000 1                  TRA     s:9479
         1 000166   001767 710000 1                  TRA     s:9479
         1 000167   001767 710000 1                  TRA     s:9479
         1 000170   001767 710000 1                  TRA     s:9479
         1 000171   001767 710000 1                  TRA     s:9479
         1 000172   001767 710000 1                  TRA     s:9479
         1 000173   001767 710000 1                  TRA     s:9479
         1 000174   001767 710000 1                  TRA     s:9479
         1 000175   001767 710000 1                  TRA     s:9479
         1 000176   001767 710000 1                  TRA     s:9479
         1 000177   001767 710000 1                  TRA     s:9479
         1 000200   001767 710000 1                  TRA     s:9479
         1 000201   001767 710000 1                  TRA     s:9479
         1 000202   001767 710000 1                  TRA     s:9479
         1 000203   001767 710000 1                  TRA     s:9479
         1 000204   000211 710000 1                  TRA     s:9055
         1 000205   000250 710000 1                  TRA     s:9071
         1 000206   001767 710000 1                  TRA     s:9479
         1 000207   001057 710000 1                  TRA     s:9257
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:34   
         1 000210   001057 710000 1                  TRA     s:9257

      234     9051                                                     /*
      235     9052        DESC_ACODE     (must be $PRn )
      236     9053                                                     */
      237     9054    2          CASE( %DESC_ACODE );

      238     9055    2             IF NOT(ITEM.SP.VD.TYPE = 2 AND

   9055  1 000211   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000212   770000 376003                    ANQ     -4096,DU
         1 000213   020000 116003                    CMPQ    8192,DU
         1 000214   000223 601000 1                  TNZ     s:9059
         1 000215   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000216   007770 376003                    ANQ     4088,DU
         1 000217   000200 116003                    CMPQ    128,DU
         1 000220   000223 602000 1                  TNC     s:9059
         1 000221   000300 116003                    CMPQ    192,DU
         1 000222   000234 602000 1                  TNC     s:9064

      239     9056    2               ITEM.SP.VD.ID >= 16 AND
      240     9057    2               ITEM.SP.VD.ID <= 23)
      241     9058    3             THEN DO;

      242     9059    3                  IF S_D.RUM

   9059  1 000223   000000 475400 xsym               LDP5    S_D$
         1 000224   504755 234100                    SZN     2541,,PR5
         1 000225   000231 605000 1                  TPL     s:9061

      243     9060    3                  THEN S_D.ERROR = 232; /* E@NOSSRUM */

   9060  1 000226   000350 236007                    LDQ     232,DL
         1 000227   500013 756100                    STQ     11,,PR5
         1 000230   000233 710000 1                  TRA     s:9062

      244     9061    3                  ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:35   

   9061  1 000231   000460 236007                    LDQ     304,DL
         1 000232   500013 756100                    STQ     11,,PR5

      245     9062    3                  ALTRETURN;

   9062  1 000233   000000 702200 xent               TSX2  ! X66_AALT

      246     9063    3                END;
      247     9064    2             SEG = 6;

   9064  1 000234   000006 235007                    LDA     6,DL
         1 000235   100000 755100                    STA     0,,PR1

      248     9065    2             DESC# = 2;

   9065  1 000236   000002 236007                    LDQ     2,DL
         1 000237   300000 756100                    STQ     0,,PR3

      249     9066    2             ADDRESS = ( ITEM.SP.VD.DISP - 24 ) / 2;

   9066  1 000240   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000241   000014 772000                    QRL     12
         1 000242   000777 376007                    ANQ     511,DL
         1 000243   000030 136007                    SBLQ    24,DL
         1 000244   000002 506007                    DIV     2,DL
         1 000245   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000246   500000 756100                    STQ     0,,PR5
         1 000247   001776 710000 1                  TRA     s:9484

      250     9067                                                /*
      251     9068        SPEC_ACODE
      252     9069                                                     */
      253     9070    2          CASE( %SPEC_ACODE );

      254     9071    3             DO CASE( ITEM.SP.VS.ID );

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:36   
   9071  1 000250   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000251   000033 772000                    QRL     27
         1 000252   000061 116007                    CMPQ    49,DL
         1 000253   000255 602006 1                  TNC     s:9071+5,QL
         1 000254   001047 710000 1                  TRA     s:9248
         1 000255   000336 710000 1                  TRA     s:9073
         1 000256   000375 710000 1                  TRA     s:9091
         1 000257   000402 710000 1                  TRA     s:9094
         1 000260   001047 710000 1                  TRA     s:9248
         1 000261   000521 710000 1                  TRA     s:9120
         1 000262   000535 710000 1                  TRA     s:9129
         1 000263   001047 710000 1                  TRA     s:9248
         1 000264   001047 710000 1                  TRA     s:9248
         1 000265   001047 710000 1                  TRA     s:9248
         1 000266   001047 710000 1                  TRA     s:9248
         1 000267   001036 710000 1                  TRA     s:9243
         1 000270   001036 710000 1                  TRA     s:9243
         1 000271   001036 710000 1                  TRA     s:9243
         1 000272   001047 710000 1                  TRA     s:9248
         1 000273   000542 710000 1                  TRA     s:9132
         1 000274   000547 710000 1                  TRA     s:9135
         1 000275   000553 710000 1                  TRA     s:9138
         1 000276   000560 710000 1                  TRA     s:9141
         1 000277   000575 710000 1                  TRA     s:9147
         1 000300   000601 710000 1                  TRA     s:9150
         1 000301   000606 710000 1                  TRA     s:9153
         1 000302   000613 710000 1                  TRA     s:9156
         1 000303   001047 710000 1                  TRA     s:9248
         1 000304   001030 710000 1                  TRA     s:9239
         1 000305   001023 710000 1                  TRA     s:9236
         1 000306   000565 710000 1                  TRA     s:9144
         1 000307   000627 710000 1                  TRA     s:9162
         1 000310   000641 710000 1                  TRA     s:9166
         1 000311   001047 710000 1                  TRA     s:9248
         1 000312   000617 710000 1                  TRA     s:9159
         1 000313   000767 710000 1                  TRA     s:9218
         1 000314   001001 710000 1                  TRA     s:9223
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:37   
         1 000315   000653 710000 1                  TRA     s:9170
         1 000316   000673 710000 1                  TRA     s:9180
         1 000317   000721 710000 1                  TRA     s:9194
         1 000320   000741 710000 1                  TRA     s:9204
         1 000321   001047 710000 1                  TRA     s:9248
         1 000322   001047 710000 1                  TRA     s:9248
         1 000323   001047 710000 1                  TRA     s:9248
         1 000324   001047 710000 1                  TRA     s:9248
         1 000325   001006 710000 1                  TRA     s:9226
         1 000326   001014 710000 1                  TRA     s:9231
         1 000327   001047 710000 1                  TRA     s:9248
         1 000330   001036 710000 1                  TRA     s:9243
         1 000331   001036 710000 1                  TRA     s:9243
         1 000332   001036 710000 1                  TRA     s:9243
         1 000333   001036 710000 1                  TRA     s:9243
         1 000334   001036 710000 1                  TRA     s:9243
         1 000335   000351 710000 1                  TRA     s:9081

      255     9072    3               CASE( %O_RTN );

      256     9073    3                  IF S_D.O$.NOT_IS

   9073  1 000336   000000 475400 xsym               LDP5    S_D$
         1 000337   500133 234100                    SZN     91,,PR5
         1 000340   000345 605000 1                  TPL     s:9078

      257     9074    4                  THEN DO;

      258     9075    4                       SEG = S_D.O$.SEG;

   9075  1 000341   500130 235100                    LDA     88,,PR5
         1 000342   100000 755100                    STA     0,,PR1

      259     9076    4                       DESC# = S_D.O$.DESC#;

   9076  1 000343   500131 235100                    LDA     89,,PR5
         1 000344   300000 755100                    STA     0,,PR3
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:38   

      260     9077    4                     END;

      261     9078    3                  ADDRESS = S_D.O$.ADDRESS;

   9078  1 000345   500132 235100                    LDA     90,,PR5
         1 000346   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000347   600000 755100                    STA     0,,PR6

      262     9079    3                  GOTO CHKADDREXP;

   9079  1 000350   000504 710000 1                  TRA     CHKADDREXP

      263     9080    3               CASE( %N_RTN );

      264     9081    3                  IF S_D.O$.NOT_IS

   9081  1 000351   000000 475400 xsym               LDP5    S_D$
         1 000352   500133 234100                    SZN     91,,PR5
         1 000353   000360 605000 1                  TPL     s:9086

      265     9082    4                  THEN DO;

      266     9083    4                       SEG = S_D.O$.SEG;

   9083  1 000354   500130 235100                    LDA     88,,PR5
         1 000355   100000 755100                    STA     0,,PR1

      267     9084    4                       DESC# = S_D.O$.DESC#;

   9084  1 000356   500131 235100                    LDA     89,,PR5
         1 000357   300000 755100                    STA     0,,PR3

      268     9085    4                     END;

      269     9086    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:39   
   9086  1 000360   506714 235100                    LDA     3532,,PR5
         1 000361   000001 115007                    CMPA    1,DL
         1 000362   000370 601000 1                  TNZ     s:9088

      270     9087    3                  THEN ADDRESS = S_D.O$.ADDRESS + 1;

   9087  1 000363   500132 235100                    LDA     90,,PR5
         1 000364   000001 035007                    ADLA    1,DL
         1 000365   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000366   600000 755100                    STA     0,,PR6
         1 000367   000374 710000 1                  TRA     s:9089

      271     9088    3                  ELSE ADDRESS = S_D.O$.ADDRESS + S_D.O$SIZE;

   9088  1 000370   500132 236100                    LDQ     90,,PR5
         1 000371   506763 036100                    ADLQ    3571,,PR5
         1 000372   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000373   600000 756100                    STQ     0,,PR6

      272     9089    3                  GOTO CHKADDREXP;

   9089  1 000374   000504 710000 1                  TRA     CHKADDREXP

      273     9090    3               CASE( %I_RTN );

      274     9091    3                  ADDRESS = S_D.SAVEIC;

   9091  1 000375   000000 475400 xsym               LDP5    S_D$
         1 000376   500002 235100                    LDA     2,,PR5
         1 000377   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000400   600000 755100                    STA     0,,PR6

      275     9092    3                  GOTO CHKADDREXP;

   9092  1 000401   000504 710000 1                  TRA     CHKADDREXP

      276     9093    3               CASE( %L_RTN );
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:40   

      277     9094    3                  IF S_D.L$.SIZE >= 36

   9094  1 000402   000000 475400 xsym               LDP5    S_D$
         1 000403   500126 235100                    LDA     86,,PR5
         1 000404   000044 115007                    CMPA    36,DL
         1 000405   000412 604000 1                  TMI     s:9096

      278     9095    3                  THEN ADDRESS = S_D.L$.VALUE.L;

   9095  1 000406   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000407   500106 235100                    LDA     70,,PR5
         1 000410   600000 755100                    STA     0,,PR6
         1 000411   000476 710000 1                  TRA     s:9113

      279     9096    4                  ELSE DO CASE( S_D.L$.FMT );

   9096  1 000412   500127 235100                    LDA     87,,PR5
         1 000413   000004 135007                    SBLA    4,DL
         1 000414   000002 115007                    CMPA    2,DL
         1 000415   000417 602005 1                  TNC     s:9096+5,AL
         1 000416   000473 710000 1                  TRA     s:9111
         1 000417   000444 710000 1                  TRA     s:9104
         1 000420   000421 710000 1                  TRA     s:9098

      280     9097    4                    CASE( %BIT_FMT );

      281     9098    4                       ADDRESS = 0;

   9098  1 000421   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000422   600000 450100                    STZ     0,,PR6

      282     9099    5                       DO I = 1 TO S_D.L$.SIZE;

   9099  1 000423   000001 235007                    LDA     1,DL
         1 000424   200011 755100                    STA     I,,AUTO
         1 000425   000437 710000 1                  TRA     s:9102+1
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:41   

      283     9100    5                            J = S_D.L$.SIZE - I;

   9100  1 000426   000000 470400 xsym               LDP0    S_D$
         1 000427   000126 236100                    LDQ     86,,PR0
         1 000430   200011 136100                    SBLQ    I,,AUTO
         1 000431   200012 756100                    STQ     J,,AUTO

      284     9101    5                            ADDRESSBITS( J ) = S_D.L$.VB.VBITS( J );

   9101  1 000432   200003 471500                    LDP1    @ADDRESS,,AUTO
         1 000433   003106 060506                    CSL     bolr='003'O
         1 000434   000106 000001                    BDSC    70,Q,PR0                 by=0,bit=0,n=1
         1 000435   100000 000001                    BDSC    0,Q,PR1                  by=0,bit=0,n=1

      285     9102    5                          END;

   9102  1 000436   200011 054100                    AOS     I,,AUTO
         1 000437   000000 470400 xsym               LDP0    S_D$
         1 000440   200011 236100                    LDQ     I,,AUTO
         1 000441   000126 116100                    CMPQ    86,,PR0
         1 000442   000426 604400 1                  TMOZ    s:9100
         1 000443   000476 710000 1                  TRA     s:9113

      286     9103    4                    CASE( %CHAR_FMT );

      287     9104    4                       ADDRESS = BITBIN('040040040040'O);

   9104  1 000444   000035 235000 xsym               LDA     B_VECTNIL+29
         1 000445   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000446   600000 755100                    STA     0,,PR6

      288     9105    4                       SIZED9 = S_D.L$.SIZE / 9;

   9105  1 000447   500126 236100                    LDQ     86,,PR5
         1 000450   000011 506007                    DIV     9,DL
         1 000451   200013 756100                    STQ     SIZED9,,AUTO
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:42   

      289     9106    5                       DO I = 1 TO SIZED9;

   9106  1 000452   000001 235007                    LDA     1,DL
         1 000453   200011 755100                    STA     I,,AUTO
         1 000454   000466 710000 1                  TRA     s:9109+1

      290     9107    5                            J = SIZED9 - I;

   9107  1 000455   200013 236100                    LDQ     SIZED9,,AUTO
         1 000456   200011 136100                    SBLQ    I,,AUTO
         1 000457   200012 756100                    STQ     J,,AUTO

      291     9108    5                            ADDRESSCHARS( J ) = S_D.L$.VC.VCHARS( J );

   9108  1 000460   000000 470400 xsym               LDP0    S_D$
         1 000461   200003 471500                    LDP1    @ADDRESS,,AUTO
         1 000462   040106 100506                    MLR     fill='040'O
         1 000463   000106 000001                    ADSC9   70,Q,PR0                 cn=0,n=1
         1 000464   100000 000001                    ADSC9   0,Q,PR1                  cn=0,n=1

      292     9109    5                          END;

   9109  1 000465   200011 054100                    AOS     I,,AUTO
         1 000466   200013 236100                    LDQ     SIZED9,,AUTO
         1 000467   000455 604000 1                  TMI     s:9107
         1 000470   200011 116100                    CMPQ    I,,AUTO
         1 000471   000455 605000 1                  TPL     s:9107
         1 000472   000476 710000 1                  TRA     s:9113

      293     9110    4                    CASE( ELSE );

      294     9111    4                       ADDRESS = S_D.L$.VALUE.L;

   9111  1 000473   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000474   500106 235100                    LDA     70,,PR5
         1 000475   600000 755100                    STA     0,,PR6
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:43   

      295     9112    4                    END;                   /* DO CASE( S_D.L$.FMT ) */

      296     9113    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

   9113  1 000476   000000 470400 xsym               LDP0    S_D$
         1 000477   006714 235100                    LDA     3532,,PR0
         1 000500   000002 115007                    CMPA    2,DL
         1 000501   000504 601000 1                  TNZ     CHKADDREXP

      297     9114    3                  THEN S_D.GOT$L = '1'B;

   9114  1 000502   400000 236003                    LDQ     -131072,DU
         1 000503   006723 756100                    STQ     3539,,PR0

      298     9115    3   CHKADDREXP:
      299     9116    3                  IF EXPR_OP > 0

   9116  1 000504   200021 235100       CHKADDREXP   LDA     EXPR_OP,,AUTO
         1 000505   000520 604400 1                  TMOZ    s:9118

      300     9117    3                  THEN CALL DDK$ADDEXPR(ADDRESS, EXPR_VAL, EXPR_OP);

   9117  1 000506   200021 630500                    EPPR0   EXPR_OP,,AUTO
         1 000507   200052 450500                    STP0    ITEM+7,,AUTO
         1 000510   200020 631500                    EPPR1   EXPR_VAL,,AUTO
         1 000511   200051 451500                    STP1    ITEM+6,,AUTO
         1 000512   200003 236100                    LDQ     @ADDRESS,,AUTO
         1 000513   200050 756100                    STQ     ITEM+5,,AUTO
         1 000514   200050 630500                    EPPR0   ITEM+5,,AUTO
         1 000515   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 000516   000000 701000 xent               TSX1    DDK$ADDEXPR
         1 000517   000000 011000                    NOP     0

      301     9118    3                  GOTO GOTSEG;

   9118  1 000520   001055 710000 1                  TRA     GOTSEG
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:44   

      302     9119    3               CASE( %IOBUFSZ_RTN );

      303     9120    3                  IF NOT D_XDELTA

   9120  1 000521   000000 234000 xsym               SZN     D_XDELTA
         1 000522   000527 604000 1                  TMI     s:9126

      304     9121    4                  THEN DO;

      305     9122    4   NOTXDELTA:
      306     9123    4                       S_D.ERROR = 111; /* E@XDONLYSYM */

   9123  1 000523   000157 235007       NOTXDELTA    LDA     111,DL
         1 000524   000000 470400 xsym               LDP0    S_D$
         1 000525   000013 755100                    STA     11,,PR0

      307     9124    4                       ALTRETURN;

   9124  1 000526   000000 702200 xent               TSX2  ! X66_AALT

      308     9125    4                     END;
      309     9126    3                  DESC# = 4;

   9126  1 000527   000004 235007                    LDA     4,DL
         1 000530   300000 755100                    STA     0,,PR3

      310     9127    3                  ADDRESS = 6;

   9127  1 000531   000006 236007                    LDQ     6,DL
         1 000532   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000533   500000 756100                    STQ     0,,PR5
         1 000534   001053 710000 1                  TRA     s:9251

      311     9128    3               CASE( %IND_RTN );

      312     9129    3                  DESC# = 0;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:45   

   9129  1 000535   300000 450100                    STZ     0,,PR3

      313     9130    3                  ADDRESS = 11;

   9130  1 000536   000013 236007                    LDQ     11,DL
         1 000537   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000540   500000 756100                    STQ     0,,PR5
         1 000541   001053 710000 1                  TRA     s:9251

      314     9131    3               CASE( %IC_RTN );

      315     9132    3                  DESC# = 0;

   9132  1 000542   300000 450100                    STZ     0,,PR3

      316     9133    3                  ADDRESS = 12;

   9133  1 000543   000014 236007                    LDQ     12,DL
         1 000544   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000545   500000 756100                    STQ     0,,PR5
         1 000546   001053 710000 1                  TRA     s:9251

      317     9134    3               CASE( %E_RTN );

      318     9135    3                  DESC# = 0;

   9135  1 000547   300000 450100                    STZ     0,,PR3

      319     9136    3                  ADDRESS = 0;

   9136  1 000550   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000551   500000 450100                    STZ     0,,PR5
         1 000552   001053 710000 1                  TRA     s:9251

      320     9137    3               CASE( %A_RTN );

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:46   
      321     9138    3                  DESC# = 0;

   9138  1 000553   300000 450100                    STZ     0,,PR3

      322     9139    3                  ADDRESS = 1;

   9139  1 000554   000001 236007                    LDQ     1,DL
         1 000555   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000556   500000 756100                    STQ     0,,PR5
         1 000557   001053 710000 1                  TRA     s:9251

      323     9140    3               CASE( %Q_RTN );

      324     9141    3                  DESC# = 0;

   9141  1 000560   300000 450100                    STZ     0,,PR3

      325     9142    3                  ADDRESS= 2;

   9142  1 000561   000002 236007                    LDQ     2,DL
         1 000562   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000563   500000 756100                    STQ     0,,PR5
         1 000564   001053 710000 1                  TRA     s:9251

      326     9143    3               CASE( %X_RTN );

      327     9144    3                  DESC# = 0;

   9144  1 000565   300000 450100                    STZ     0,,PR3

      328     9145    3                  ADDRESS = 3 + ITEM.SP.VS.SZ;

   9145  1 000566   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000567   000022 772000                    QRL     18
         1 000570   000777 376007                    ANQ     511,DL
         1 000571   000003 036007                    ADLQ    3,DL
         1 000572   200003 475500                    LDP5    @ADDRESS,,AUTO
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:47   
         1 000573   500000 756100                    STQ     0,,PR5
         1 000574   001053 710000 1                  TRA     s:9251

      329     9146    3               CASE( %AU_RTN );

      330     9147    3                  DESC# = 3;

   9147  1 000575   300000 755100                    STA     0,,PR3

      331     9148    3                  ADDRESS = 0;

   9148  1 000576   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000577   500000 450100                    STZ     0,,PR5
         1 000600   001053 710000 1                  TRA     s:9251

      332     9149    3               CASE( %AL_RTN );

      333     9150    3                  DESC# = 3;

   9150  1 000601   300000 755100                    STA     0,,PR3

      334     9151    3                  ADDRESS = 1;

   9151  1 000602   000001 236007                    LDQ     1,DL
         1 000603   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000604   500000 756100                    STQ     0,,PR5
         1 000605   001053 710000 1                  TRA     s:9251

      335     9152    3               CASE( %QU_RTN );

      336     9153    3                  DESC# = 3;

   9153  1 000606   300000 755100                    STA     0,,PR3

      337     9154    3                  ADDRESS = 2;

   9154  1 000607   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:48   
         1 000610   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000611   500000 756100                    STQ     0,,PR5
         1 000612   001053 710000 1                  TRA     s:9251

      338     9155    3               CASE( %QL_RTN );

      339     9156    3                  DESC# = 3;

   9156  1 000613   300000 755100                    STA     0,,PR3

      340     9157    3                  ADDRESS = 3;

   9157  1 000614   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000615   500000 755100                    STA     0,,PR5
         1 000616   001053 710000 1                  TRA     s:9251

      341     9158    3               CASE( %AR_RTN );

      342     9159    3                  DESC# = 1;

   9159  1 000617   000001 235007                    LDA     1,DL
         1 000620   300000 755100                    STA     0,,PR3

      343     9160    3                  ADDRESS = ITEM.SP.VS.SZ;

   9160  1 000621   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000622   000022 772000                    QRL     18
         1 000623   000777 376007                    ANQ     511,DL
         1 000624   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000625   500000 756100                    STQ     0,,PR5
         1 000626   001053 710000 1                  TRA     s:9251

      344     9161    3               CASE( %WSR_RTN );

      345     9162    3                  IF NOT D_XDELTA THEN GOTO NOTXDELTA;

   9162  1 000627   000000 234000 xsym               SZN     D_XDELTA
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:49   
         1 000630   000523 605000 1                  TPL     NOTXDELTA

      346     9163    3                  DESC# = 5;

   9163  1 000631   000005 235007                    LDA     5,DL
         1 000632   300000 755100                    STA     0,,PR3

      347     9164    3                  ADDRESS = ITEM.SP.VS.SZ;

   9164  1 000633   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000634   000022 772000                    QRL     18
         1 000635   000777 376007                    ANQ     511,DL
         1 000636   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000637   500000 756100                    STQ     0,,PR5
         1 000640   001053 710000 1                  TRA     s:9251

      348     9165    3               CASE( %WSQ_RTN );

      349     9166    3                  IF NOT D_XDELTA THEN GOTO NOTXDELTA;

   9166  1 000641   000000 234000 xsym               SZN     D_XDELTA
         1 000642   000523 605000 1                  TPL     NOTXDELTA

      350     9167    3                  DESC# = 6;

   9167  1 000643   000006 235007                    LDA     6,DL
         1 000644   300000 755100                    STA     0,,PR3

      351     9168    3                  ADDRESS = ITEM.SP.VS.SZ;

   9168  1 000645   200044 236100                    LDQ     ITEM+1,,AUTO
         1 000646   000022 772000                    QRL     18
         1 000647   000777 376007                    ANQ     511,DL
         1 000650   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 000651   500000 756100                    STQ     0,,PR5
         1 000652   001053 710000 1                  TRA     s:9251

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:50   
      352     9169    3               CASE( %@_RTN );

      353     9170    3                  IF NOT S_D.DEFINED@

   9170  1 000653   000000 475400 xsym               LDP5    S_D$
         1 000654   505060 234100                    SZN     2608,,PR5
         1 000655   000661 604000 1                  TMI     s:9172

      354     9171    3                  THEN CALL DDI$GET_PATCH_SPACE;

   9171  1 000656   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000657   000000 701000 xent               TSX1    DDI$GET_PATCH_SPACE
         1 000660   000000 011000                    NOP     0

      355     9172    3                  IF NOT S_D.GOT@

   9172  1 000661   000000 470400 xsym               LDP0    S_D$
         1 000662   005054 234100                    SZN     2604,,PR0
         1 000663   000667 604000 1                  TMI     s:9177

      356     9173    4                  THEN DO;

      357     9174    4                       S_D.ERROR = 151;  /* E@NO@ */

   9174  1 000664   000227 235007                    LDA     151,DL
         1 000665   000013 755100                    STA     11,,PR0

      358     9175    4                       ALTRETURN;

   9175  1 000666   000000 702200 xent               TSX2  ! X66_AALT

      359     9176    4                     END;
      360     9177    3                  ADDRESS = S_D.NEXT@;

   9177  1 000667   005055 235100                    LDA     2605,,PR0
         1 000670   200003 471500                    LDP1    @ADDRESS,,AUTO
         1 000671   100000 755100                    STA     0,,PR1
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:51   

      361     9178    3                  GOTO CHKADDREXP;

   9178  1 000672   000504 710000 1                  TRA     CHKADDREXP

      362     9179    3               CASE( %@@_RTN );

      363     9180    3                  IF NOT S_D.DEFINED@

   9180  1 000673   000000 475400 xsym               LDP5    S_D$
         1 000674   505060 234100                    SZN     2608,,PR5
         1 000675   000701 604000 1                  TMI     s:9182

      364     9181    3                  THEN CALL DDI$GET_PATCH_SPACE;

   9181  1 000676   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000677   000000 701000 xent               TSX1    DDI$GET_PATCH_SPACE
         1 000700   000000 011000                    NOP     0

      365     9182    3                  IF NOT S_D.GOT@

   9182  1 000701   000000 470400 xsym               LDP0    S_D$
         1 000702   005054 234100                    SZN     2604,,PR0
         1 000703   000707 604000 1                  TMI     s:9187

      366     9183    4                  THEN DO;

      367     9184    4                       S_D.ERROR = 151;  /* E@NO@ */

   9184  1 000704   000227 235007                    LDA     151,DL
         1 000705   000013 755100                    STA     11,,PR0

      368     9185    4                       ALTRETURN;

   9185  1 000706   000000 702200 xent               TSX2  ! X66_AALT

      369     9186    4                     END;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:52   
      370     9187    3                  ADDRESS = S_D.NEXT@;

   9187  1 000707   005055 235100                    LDA     2605,,PR0
         1 000710   200003 471500                    LDP1    @ADDRESS,,AUTO
         1 000711   100000 755100                    STA     0,,PR1

      371     9188    3                  IF MOD(ADDRESS, 2) ~= 0

   9188  1 000712   100000 236100                    LDQ     0,,PR1
         1 000713   000002 506007                    DIV     2,DL
         1 000714   000044 733000                    LRS     36
         1 000715   000000 116003                    CMPQ    0,DU
         1 000716   000720 600000 1                  TZE     s:9192

      372     9189    4                  THEN DO;

      373     9190    4                       ADDRESS = ADDRESS + 1;

   9190  1 000717   100000 054100                    AOS     0,,PR1

      374     9191    4                     END;

      375     9192    3                  GOTO CHKADDREXP;

   9192  1 000720   000504 710000 1                  TRA     CHKADDREXP

      376     9193    3               CASE( %#_RTN );

      377     9194    3                  IF NOT S_D.DEFINED#

   9194  1 000721   000000 475400 xsym               LDP5    S_D$
         1 000722   505065 234100                    SZN     2613,,PR5
         1 000723   000727 604000 1                  TMI     s:9196

      378     9195    3                  THEN CALL DDI$GET_PATCH_SPACE;

   9195  1 000724   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:53   
         1 000725   000000 701000 xent               TSX1    DDI$GET_PATCH_SPACE
         1 000726   000000 011000                    NOP     0

      379     9196    3                  IF NOT S_D.GOT#

   9196  1 000727   000000 470400 xsym               LDP0    S_D$
         1 000730   005061 234100                    SZN     2609,,PR0
         1 000731   000735 604000 1                  TMI     s:9201

      380     9197    4                  THEN DO;

      381     9198    4                       S_D.ERROR = 152;  /* E@NO# */

   9198  1 000732   000230 235007                    LDA     152,DL
         1 000733   000013 755100                    STA     11,,PR0

      382     9199    4                       ALTRETURN;

   9199  1 000734   000000 702200 xent               TSX2  ! X66_AALT

      383     9200    4                     END;
      384     9201    3                  ADDRESS = S_D.NEXT#;

   9201  1 000735   005062 235100                    LDA     2610,,PR0
         1 000736   200003 471500                    LDP1    @ADDRESS,,AUTO
         1 000737   100000 755100                    STA     0,,PR1

      385     9202    3                  GOTO CHKADDREXP;

   9202  1 000740   000504 710000 1                  TRA     CHKADDREXP

      386     9203    3               CASE( %##_RTN );

      387     9204    3                  IF NOT S_D.DEFINED#

   9204  1 000741   000000 475400 xsym               LDP5    S_D$
         1 000742   505065 234100                    SZN     2613,,PR5
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:54   
         1 000743   000747 604000 1                  TMI     s:9206

      388     9205    3                  THEN CALL DDI$GET_PATCH_SPACE;

   9205  1 000744   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000745   000000 701000 xent               TSX1    DDI$GET_PATCH_SPACE
         1 000746   000000 011000                    NOP     0

      389     9206    3                  IF NOT S_D.GOT#

   9206  1 000747   000000 470400 xsym               LDP0    S_D$
         1 000750   005061 234100                    SZN     2609,,PR0
         1 000751   000755 604000 1                  TMI     s:9211

      390     9207    4                  THEN DO;

      391     9208    4                       S_D.ERROR = 152;  /* E@NO# */

   9208  1 000752   000230 235007                    LDA     152,DL
         1 000753   000013 755100                    STA     11,,PR0

      392     9209    4                       ALTRETURN;

   9209  1 000754   000000 702200 xent               TSX2  ! X66_AALT

      393     9210    4                     END;
      394     9211    3                  ADDRESS = S_D.NEXT#;

   9211  1 000755   005062 235100                    LDA     2610,,PR0
         1 000756   200003 471500                    LDP1    @ADDRESS,,AUTO
         1 000757   100000 755100                    STA     0,,PR1

      395     9212    3                  IF MOD(ADDRESS, 2) ~= 0

   9212  1 000760   100000 236100                    LDQ     0,,PR1
         1 000761   000002 506007                    DIV     2,DL
         1 000762   000044 733000                    LRS     36
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:55   
         1 000763   000000 116003                    CMPQ    0,DU
         1 000764   000766 600000 1                  TZE     s:9216

      396     9213    4                  THEN DO;

      397     9214    4                       ADDRESS = ADDRESS + 1;

   9214  1 000765   100000 054100                    AOS     0,,PR1

      398     9215    4                     END;

      399     9216    3                  GOTO CHKADDREXP;

   9216  1 000766   000504 710000 1                  TRA     CHKADDREXP

      400     9217    3               CASE( %RI_RTN );

      401     9218    3                  ADDRESS = S_D.RI$.OPS(0);

   9218  1 000767   000000 475400 xsym               LDP5    S_D$
         1 000770   505067 235100                    LDA     2615,,PR5
         1 000771   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 000772   600000 755100                    STA     0,,PR6

      402     9219    3                  IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

   9219  1 000773   506714 235100                    LDA     3532,,PR5
         1 000774   000002 115007                    CMPA    2,DL
         1 000775   001000 601000 1                  TNZ     s:9221

      403     9220    3                  THEN S_D.GOT$RI = '1'B;

   9220  1 000776   400000 236003                    LDQ     -131072,DU
         1 000777   505236 756100                    STQ     2718,,PR5

      404     9221    3                  GOTO CHKADDREXP;

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:56   
   9221  1 001000   000504 710000 1                  TRA     CHKADDREXP

      405     9222    3               CASE( %NA_RTN );

      406     9223    3                  ADDRESS = S_D.NA$;

   9223  1 001001   000000 475400 xsym               LDP5    S_D$
         1 001002   505107 235100                    LDA     2631,,PR5
         1 001003   200003 476500                    LDP6    @ADDRESS,,AUTO
         1 001004   600000 755100                    STA     0,,PR6

      407     9224    3                  GOTO CHKADDREXP;

   9224  1 001005   000504 710000 1                  TRA     CHKADDREXP

      408     9225    3               CASE( %SA_RTN );

      409     9226    3                  SEG = 7;

   9226  1 001006   000007 235007                    LDA     7,DL
         1 001007   100000 755100                    STA     0,,PR1

      410     9227    3                  DESC# = 0;

   9227  1 001010   300000 450100                    STZ     0,,PR3

      411     9228    3                  ADDRESS = 0;

   9228  1 001011   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 001012   500000 450100                    STZ     0,,PR5

      412     9229    3                  GOTO GOTSEG;

   9229  1 001013   001055 710000 1                  TRA     GOTSEG

      413     9230    3               CASE( %PRIV_RTN );

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:57   
      414     9231    3                  SEG = 7;

   9231  1 001014   000007 235007                    LDA     7,DL
         1 001015   100000 755100                    STA     0,,PR1

      415     9232    3                  DESC# = 1;

   9232  1 001016   000001 236007                    LDQ     1,DL
         1 001017   300000 756100                    STQ     0,,PR3

      416     9233    3                  ADDRESS = 0;

   9233  1 001020   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 001021   500000 450100                    STZ     0,,PR5

      417     9234    3                  GOTO GOTSEG;

   9234  1 001022   001055 710000 1                  TRA     GOTSEG

      418     9235    3               CASE( %FMASK_RTN );

      419     9236    3                  DESC# = 7;

   9236  1 001023   000007 235007                    LDA     7,DL
         1 001024   300000 755100                    STA     0,,PR3

      420     9237    3                  ADDRESS = 0;

   9237  1 001025   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 001026   500000 450100                    STZ     0,,PR5
         1 001027   001053 710000 1                  TRA     s:9251

      421     9238    3               CASE( %FRANGE_RTN );

      422     9239    3                  DESC# = 7;

   9239  1 001030   000007 235007                    LDA     7,DL
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:58   
         1 001031   300000 755100                    STA     0,,PR3

      423     9240    3                  ADDRESS = 1;

   9240  1 001032   000001 236007                    LDQ     1,DL
         1 001033   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 001034   500000 756100                    STQ     0,,PR5
         1 001035   001053 710000 1                  TRA     s:9251

      424     9241    3               CASE(%CI_RTN, %T_RTN, %S_RTN, %IV_RTN, %Z_RTN,

      425     9242    3                    %ASV_RTN, %R_RTN, %M_RTN);
      426     9243    3                  IF S_D.RUM

   9243  1 001036   000000 475400 xsym               LDP5    S_D$
         1 001037   504755 234100                    SZN     2541,,PR5
         1 001040   001044 605000 1                  TPL     s:9245

      427     9244    3                  THEN S_D.ERROR = 232; /* E@NOSSRUM */

   9244  1 001041   000350 235007                    LDA     232,DL
         1 001042   500013 755100                    STA     11,,PR5
         1 001043   001046 710000 1                  TRA     s:9246

      428     9245    3                  ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */

   9245  1 001044   000460 235007                    LDA     304,DL
         1 001045   500013 755100                    STA     11,,PR5

      429     9246    3                  ALTRETURN;

   9246  1 001046   000000 702200 xent               TSX2  ! X66_AALT

      430     9247    3               CASE( ELSE );

      431     9248    3                  S_D.ERROR = 503;    /* E@NOTIMP */

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:59   
   9248  1 001047   000767 235007                    LDA     503,DL
         1 001050   000000 475400 xsym               LDP5    S_D$
         1 001051   500013 755100                    STA     11,,PR5

      432     9249    3                  ALTRETURN;

   9249  1 001052   000000 702200 xent               TSX2  ! X66_AALT

      433     9250    3               END;                        /* DO CASE( ITEM.SP.VS.ID ) */

      434     9251    2             SEG = 6;

   9251  1 001053   000006 235007                    LDA     6,DL
         1 001054   100000 755100                    STA     0,,PR1

      435     9252    2   GOTSEG:   SEG = SEG;                    /* Fall through DO CASE statement */

   9252  1 001055   200004 470500       GOTSEG       LDP0    @SEG,,AUTO
         1 001056   001776 710000 1                  TRA     s:9484

      436     9253                                                /*
      437     9254        BIGBASED_ACODE, BIGSTATIC_ACODE
      438     9255                                                */
      439     9256    2          CASE( %BIGBASED_ACODE, %BIGSTATIC_ACODE );

      440     9257    2             ADDRESS = ITEM.VALUE;

   9257  1 001057   200044 235100                    LDA     ITEM+1,,AUTO
         1 001060   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 001061   500000 755100                    STA     0,,PR5

      441     9258    2             GOTO BASED_STATIC;

   9258  1 001062   001201 710000 1                  TRA     BASED_STATIC

      442     9259                                                /*
      443     9260        VIRT_ACODE
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:60   
      444     9261                                                */
      445     9262    2          CASE( %VIRT_ACODE );

      446     9263    2             TADDRESS = ITEM.ADDRESS.W;

   9263  1 001063   200044 236100                    LDQ     ITEM+1,,AUTO
         1 001064   000014 772000                    QRL     12
         1 001065   200027 756100                    STQ     TADDRESS,,AUTO

      447     9264    2             SEG = 3;

   9264  1 001066   100000 755100                    STA     0,,PR1

      448     9265    2             DESC# = 0;

   9265  1 001067   300000 450100                    STZ     0,,PR3

      449     9266    2             NOT_IS = '0'B;

   9266  1 001070   400000 450100                    STZ     0,,PR4

      450     9267                                                /* Go get offset */
      451     9268    2             CALL DDK$GETMVAL(ADDRESS, TADDRESS, SEG, DESC#, NOT_IS) ALTRET(
              9268                      TRAP_VIRTUAL);

   9268  1 001071   200006 236100                    LDQ     @NOT_IS,,AUTO
         1 001072   200054 756100                    STQ     ITEM+9,,AUTO
         1 001073   200004 237100                    LDAQ    @SEG,,AUTO
         1 001074   200052 757100                    STAQ    ITEM+7,,AUTO
         1 001075   200027 635500                    EPPR5   TADDRESS,,AUTO
         1 001076   200051 455500                    STP5    ITEM+6,,AUTO
         1 001077   200003 236100                    LDQ     @ADDRESS,,AUTO
         1 001100   200050 756100                    STQ     ITEM+5,,AUTO
         1 001101   200050 630500                    EPPR0   ITEM+5,,AUTO
         1 001102   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001103   000000 701000 xent               TSX1    DDK$GETMVAL
         1 001104   002017 702000 1                  TSX2    TRAP_VIRTUAL
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:61   

      452     9269    2             TADDRESS = TADDRESS + 1;

   9269  1 001105   200027 235100                    LDA     TADDRESS,,AUTO
         1 001106   000001 035007                    ADLA    1,DL
         1 001107   200027 755100                    STA     TADDRESS,,AUTO

      453     9270                                                /* Go get descriptor */
      454     9271    2            CALL DDK$GETMVAL(PNTR, TADDRESS, SEG, DESC#, NOT_IS) ALTRET(TRAP_VIRTUAL);

   9271  1 001110   200006 236100                    LDQ     @NOT_IS,,AUTO
         1 001111   200054 756100                    STQ     ITEM+9,,AUTO
         1 001112   200004 237100                    LDAQ    @SEG,,AUTO
         1 001113   200052 757100                    STAQ    ITEM+7,,AUTO
         1 001114   200027 630500                    EPPR0   TADDRESS,,AUTO
         1 001115   200051 450500                    STP0    ITEM+6,,AUTO
         1 001116   200025 631500                    EPPR1   PNTR,,AUTO
         1 001117   200050 451500                    STP1    ITEM+5,,AUTO
         1 001120   200050 630500                    EPPR0   ITEM+5,,AUTO
         1 001121   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001122   000000 701000 xent               TSX1    DDK$GETMVAL
         1 001123   002017 702000 1                  TSX2    TRAP_VIRTUAL

      455     9272    2             DESC# = PNTR.DESC#;

   9272  1 001124   200005 470500                    LDP0    @DESC#,,AUTO
         1 001125   200025 236100                    LDQ     PNTR,,AUTO
         1 001126   001777 376007                    ANQ     1023,DL
         1 001127   000000 756100                    STQ     0,,PR0

      456     9273    2             NOT_IS = '1'B;

   9273  1 001130   400000 236003                    LDQ     -131072,DU
         1 001131   200006 471500                    LDP1    @NOT_IS,,AUTO
         1 001132   100000 756100                    STQ     0,,PR1

      457     9274    2             GOTO ADD_INDXX;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:62   

   9274  1 001133   001140 710000 1                  TRA     ADD_INDXX

      458     9275                                                /*
      459     9276        BASED_ACODE, STATIC_ACODE, AUTO_ACODE, PARM_ACODE, DCB_ACODE
      460     9277                                                */
      461     9278    2          CASE(%BASED_ACODE, %STATIC_ACODE, %AUTO_ACODE, %PARM_ACODE, %DCB_ACODE);

      462     9279    2             ADDRESS = ITEM.ADDRESS.W;

   9279  1 001134   200044 236100                    LDQ     ITEM+1,,AUTO
         1 001135   000014 772000                    QRL     12
         1 001136   200003 475500                    LDP5    @ADDRESS,,AUTO
         1 001137   500000 756100                    STQ     0,,PR5

      463     9280    2   ADD_INDXX:
      464     9281    2             IF ARRAY_FLAG

   9281  1 001140   200023 234100       ADD_INDXX    SZN     ARRAY_FLAG,,AUTO
         1 001141   001147 605000 1                  TPL     s:9283

      465     9282    2             THEN ADDRESS = ADDRESS + INDXX / 36;

   9282  1 001142   200016 236100                    LDQ     INDXX,,AUTO
         1 001143   000044 506007                    DIV     36,DL
         1 001144   200003 470500                    LDP0    @ADDRESS,,AUTO
         1 001145   000000 036100                    ADLQ    0,,PR0
         1 001146   000000 756100                    STQ     0,,PR0

      466     9283    2             IF ADDR(BITOFF) ~= ADDR(NIL)

   9283  1 001147   200007 236100                    LDQ     @BITOFF,,AUTO
         1 001150   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001151   001201 600000 1                  TZE     BASED_STATIC

      467     9284    3             THEN DO;

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:63   
      468     9285    3                  I = MOD(INDXX,36) + ITEM.ADDRESS.C * 9 + ITEM.ADDRESS.B;

   9285  1 001152   200016 236100                    LDQ     INDXX,,AUTO
         1 001153   000044 506007                    DIV     36,DL
         1 001154   200050 755100                    STA     ITEM+5,,AUTO
         1 001155   200044 236100                    LDQ     ITEM+1,,AUTO
         1 001156   000006 772000                    QRL     6
         1 001157   000077 376007                    ANQ     63,DL
         1 001160   000011 402007                    MPY     9,DL
         1 001161   200050 036100                    ADLQ    ITEM+5,,AUTO
         1 001162   200051 756100                    STQ     ITEM+6,,AUTO
         1 001163   200044 236100                    LDQ     ITEM+1,,AUTO
         1 001164   000077 376007                    ANQ     63,DL
         1 001165   200052 756100                    STQ     ITEM+7,,AUTO
         1 001166   200051 236100                    LDQ     ITEM+6,,AUTO
         1 001167   200052 036100                    ADLQ    ITEM+7,,AUTO
         1 001170   200011 756100                    STQ     I,,AUTO

      469     9286    3                  ADDRESS = ADDRESS + I / 36;

   9286  1 001171   000044 506007                    DIV     36,DL
         1 001172   200003 470500                    LDP0    @ADDRESS,,AUTO
         1 001173   000000 036100                    ADLQ    0,,PR0
         1 001174   000000 756100                    STQ     0,,PR0

      470     9287    3                  BITOFF = MOD(I, 36);

   9287  1 001175   200011 236100                    LDQ     I,,AUTO
         1 001176   000044 506007                    DIV     36,DL
         1 001177   200007 471500                    LDP1    @BITOFF,,AUTO
         1 001200   100000 755100                    STA     0,,PR1

      471     9288    3                END;

      472     9289    2   BASED_STATIC:
      473     9290    2             IF EXPR_OP > 0

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:64   
   9290  1 001201   200021 235100       BASED_STATIC LDA     EXPR_OP,,AUTO
         1 001202   001215 604400 1                  TMOZ    s:9293

      474     9291    2             THEN CALL DDK$ADDEXPR(ADDRESS, EXPR_VAL, EXPR_OP);

   9291  1 001203   200021 630500                    EPPR0   EXPR_OP,,AUTO
         1 001204   200052 450500                    STP0    ITEM+7,,AUTO
         1 001205   200020 631500                    EPPR1   EXPR_VAL,,AUTO
         1 001206   200051 451500                    STP1    ITEM+6,,AUTO
         1 001207   200003 236100                    LDQ     @ADDRESS,,AUTO
         1 001210   200050 756100                    STQ     ITEM+5,,AUTO
         1 001211   200050 630500                    EPPR0   ITEM+5,,AUTO
         1 001212   000021 631400 xsym               EPPR1   B_VECTNIL+17
         1 001213   000000 701000 xent               TSX1    DDK$ADDEXPR
         1 001214   000000 011000                    NOP     0

      475     9292                                                /**/
      476     9293    3             DO CASE(ADDR_TYPE);

   9293  1 001215   200022 235100                    LDA     ADDR_TYPE,,AUTO
         1 001216   000105 115007                    CMPA    69,DL
         1 001217   001221 602005 1                  TNC     s:9293+4,AL
         1 001220   001356 710000 1                  TRA     s:9359
         1 001221   001326 710000 1                  TRA     s:9298
         1 001222   001335 710000 1                  TRA     s:9302
         1 001223   001356 710000 1                  TRA     s:9359
         1 001224   001356 710000 1                  TRA     s:9359
         1 001225   001342 710000 1                  TRA     FINDSTACK
         1 001226   001356 710000 1                  TRA     s:9359
         1 001227   001356 710000 1                  TRA     s:9359
         1 001230   001356 710000 1                  TRA     s:9359
         1 001231   001326 710000 1                  TRA     s:9298
         1 001232   001356 710000 1                  TRA     s:9359
         1 001233   001356 710000 1                  TRA     s:9359
         1 001234   001356 710000 1                  TRA     s:9359
         1 001235   001356 710000 1                  TRA     s:9359
         1 001236   001356 710000 1                  TRA     s:9359
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:65   
         1 001237   001356 710000 1                  TRA     s:9359
         1 001240   001356 710000 1                  TRA     s:9359
         1 001241   001356 710000 1                  TRA     s:9359
         1 001242   001356 710000 1                  TRA     s:9359
         1 001243   001356 710000 1                  TRA     s:9359
         1 001244   001356 710000 1                  TRA     s:9359
         1 001245   001356 710000 1                  TRA     s:9359
         1 001246   001356 710000 1                  TRA     s:9359
         1 001247   001356 710000 1                  TRA     s:9359
         1 001250   001356 710000 1                  TRA     s:9359
         1 001251   001356 710000 1                  TRA     s:9359
         1 001252   001356 710000 1                  TRA     s:9359
         1 001253   001356 710000 1                  TRA     s:9359
         1 001254   001356 710000 1                  TRA     s:9359
         1 001255   001356 710000 1                  TRA     s:9359
         1 001256   001356 710000 1                  TRA     s:9359
         1 001257   001356 710000 1                  TRA     s:9359
         1 001260   001356 710000 1                  TRA     s:9359
         1 001261   001356 710000 1                  TRA     s:9359
         1 001262   001356 710000 1                  TRA     s:9359
         1 001263   001356 710000 1                  TRA     s:9359
         1 001264   001356 710000 1                  TRA     s:9359
         1 001265   001356 710000 1                  TRA     s:9359
         1 001266   001356 710000 1                  TRA     s:9359
         1 001267   001356 710000 1                  TRA     s:9359
         1 001270   001356 710000 1                  TRA     s:9359
         1 001271   001356 710000 1                  TRA     s:9359
         1 001272   001356 710000 1                  TRA     s:9359
         1 001273   001356 710000 1                  TRA     s:9359
         1 001274   001356 710000 1                  TRA     s:9359
         1 001275   001356 710000 1                  TRA     s:9359
         1 001276   001356 710000 1                  TRA     s:9359
         1 001277   001356 710000 1                  TRA     s:9359
         1 001300   001356 710000 1                  TRA     s:9359
         1 001301   001356 710000 1                  TRA     s:9359
         1 001302   001356 710000 1                  TRA     s:9359
         1 001303   001356 710000 1                  TRA     s:9359
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:66   
         1 001304   001356 710000 1                  TRA     s:9359
         1 001305   001356 710000 1                  TRA     s:9359
         1 001306   001356 710000 1                  TRA     s:9359
         1 001307   001356 710000 1                  TRA     s:9359
         1 001310   001356 710000 1                  TRA     s:9359
         1 001311   001356 710000 1                  TRA     s:9359
         1 001312   001356 710000 1                  TRA     s:9359
         1 001313   001356 710000 1                  TRA     s:9359
         1 001314   001356 710000 1                  TRA     s:9359
         1 001315   001356 710000 1                  TRA     s:9359
         1 001316   001356 710000 1                  TRA     s:9359
         1 001317   001356 710000 1                  TRA     s:9359
         1 001320   001356 710000 1                  TRA     s:9359
         1 001321   001356 710000 1                  TRA     s:9359
         1 001322   001356 710000 1                  TRA     s:9359
         1 001323   001356 710000 1                  TRA     s:9359
         1 001324   001356 710000 1                  TRA     s:9359
         1 001325   001326 710000 1                  TRA     s:9298

      477     9294                                                /**/
      478     9295    3               CASE(%STATIC_ACODE,

      479     9296    3               %VIRT_ACODE,
      480     9297    3               %BIGSTATIC_ACODE);
      481     9298    3                  IF ADDR(BSIZE) ~= ADDR(NIL)

   9298  1 001326   200010 236100                    LDQ     @BSIZE,,AUTO
         1 001327   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001330   001334 600000 1                  TZE     s:9300

      482     9299    3                  THEN BSIZE = SIZE;

   9299  1 001331   200015 235100                    LDA     SIZE,,AUTO
         1 001332   200010 470500                    LDP0    @BSIZE,,AUTO
         1 001333   000000 755100                    STA     0,,PR0

      483     9300    3                  RETURN;                  /* Shortcut out of here */
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:67   

   9300  1 001334   000000 702200 xent               TSX2  ! X66_ARET

      484     9301    3               CASE(%AUTO_ACODE);

      485     9302    3                  POINTER = BITBIN(DESC.ITEM(%AUTO_DESC)

   9302  1 001335   000017 236000 xsym               LDQ     DESC+15
         1 001336   000001 376000 0                  ANQ     FALSE+1
         1 001337   000002 276000 0                  ORQ     FALSE+2
         1 001340   200017 756100                    STQ     POINTER,,AUTO

      486     9303    3                    & '777777770000'O | '000000002000'O);
      487     9304    3                  GOTO FINDSTACK;

   9304  1 001341   001342 710000 1                  TRA     FINDSTACK

      488     9305    3               CASE( %PARM_ACODE );

   9304  1 001342                       FINDSTACK    null
      489     9306    3   FINDSTACK:     ;
      490     9307    3                  IF S_D.RUM

   9307  1 001342   000000 470400 xsym               LDP0    S_D$
         1 001343   004755 234100                    SZN     2541,,PR0
         1 001344   001347 604000 1                  TMI     s:9310
         1 001345   004756 234100                    SZN     2542,,PR0
         1 001346   001352 605000 1                  TPL     GOTSTACK

      491     9308    3                    OR S_D.ANLZ
      492     9309    4                  THEN DO;

      493     9310    4                       S_D.ERROR = 214; /* E@CANTAUTOMODE */

   9310  1 001347   000326 236007                    LDQ     214,DL
         1 001350   000013 756100                    STQ     11,,PR0

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:68   
      494     9311    4                       ALTRETURN;

   9311  1 001351   000000 702200 xent               TSX2  ! X66_AALT

   9307  1 001352                       GOTSTACK     null
      495     9312    4                     END;
      496     9313        /*N* TEMP TO USE TOP STACK FRAME */
      497     9314        %IF '0'B;
      531     9348        %ENDIF;
      532     9349    3   GOTSTACK:      ;
      533     9350    3                  S_D.ACCESS = '0'B;

   9350  1 001352   000016 450100                    STZ     14,,PR0

      534     9351    3                  S_D.ASTACKOFF = STACKOFF;

   9351  1 001353   200032 235100                    LDA     STACKOFF,,AUTO
         1 001354   004670 755100                    STA     2488,,PR0
         1 001355   001356 710000 1                  TRA     s:9359

      535     9352    3               CASE(ELSE);

      536     9353                                                /* Do nothing for based type acodes */
      537     9354    3               END;                        /* DO CASE(ADDR_TYPE) */

      538     9355                                                /*
      539     9356                                 Now need to interpret pointer to provide SEG, DESC# and
      540     9357                                 (perhaps) additional offset information
      541     9358                                 */
      542     9359    2             IF POINTR.SEG = 1

   9359  1 001356   200017 236100                    LDQ     POINTER,,AUTO
         1 001357   006000 376007                    ANQ     3072,DL
         1 001360   002000 116007                    CMPQ    1024,DL
         1 001361   001762 601000 1                  TNZ     s:9475

      543     9360    3             THEN DO;            /* Evaluate ITEM as special descriptor symbol */
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:69   

      544     9361    4                  DO CASE(PSDITEM.TYPE);

   9361  1 001362   200017 236100                    LDQ     POINTER,,AUTO
         1 001363   000036 772000                    QRL     30
         1 001364   000013 116007                    CMPQ    11,DL
         1 001365   001367 602006 1                  TNC     s:9361+5,QL
         1 001366   001776 710000 1                  TRA     s:9484
         1 001367   001402 710000 1                  TRA     s:9363
         1 001370   001531 710000 1                  TRA     s:9410
         1 001371   001567 710000 1                  TRA     s:9423
         1 001372   001643 710000 1                  TRA     s:9444
         1 001373   001657 710000 1                  TRA     s:9447
         1 001374   001670 710000 1                  TRA     s:9450
         1 001375   001677 710000 1                  TRA     s:9453
         1 001376   001732 710000 1                  TRA     s:9462
         1 001377   001743 710000 1                  TRA     s:9465
         1 001400   001743 710000 1                  TRA     s:9465
         1 001401   001754 710000 1                  TRA     s:9470

      545     9362    4                    CASE(0);               /* $SSR, $JIT, $HJIT */

      546     9363    4                       SEG = 1;

   9363  1 001402   000001 235007                    LDA     1,DL
         1 001403   200004 470500                    LDP0    @SEG,,AUTO
         1 001404   000000 755100                    STA     0,,PR0

      547     9364    5                       DO CASE(PSDITEM.ID);

   9364  1 001405   200017 236100                    LDQ     POINTER,,AUTO
         1 001406   000025 772000                    QRL     21
         1 001407   000777 376007                    ANQ     511,DL
         1 001410   000012 116007                    CMPQ    10,DL
         1 001411   001413 602006 1                  TNC     s:9364+6,QL
         1 001412   001776 710000 1                  TRA     s:9484
         1 001413   001425 710000 1                  TRA     s:9366
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:70   
         1 001414   001431 710000 1                  TRA     s:9368
         1 001415   001435 710000 1                  TRA     s:9370
         1 001416   001441 710000 1                  TRA     s:9372
         1 001417   001453 710000 1                  TRA     s:9379
         1 001420   001465 710000 1                  TRA     s:9386
         1 001421   001465 710000 1                  TRA     s:9386
         1 001422   001465 710000 1                  TRA     s:9386
         1 001423   001477 710000 1                  TRA     s:9393
         1 001424   001513 710000 1                  TRA     s:9401

      548     9365    5                         CASE(0);          /* $SSR */

      549     9366    5                            DESC# = 6;

   9366  1 001425   000006 235007                    LDA     6,DL
         1 001426   200005 471500                    LDP1    @DESC#,,AUTO
         1 001427   100000 755100                    STA     0,,PR1
         1 001430   001776 710000 1                  TRA     s:9484

      550     9367    5                         CASE(1);          /* $JIT */

      551     9368    5                            DESC# = 7;

   9368  1 001431   000007 235007                    LDA     7,DL
         1 001432   200005 471500                    LDP1    @DESC#,,AUTO
         1 001433   100000 755100                    STA     0,,PR1
         1 001434   001776 710000 1                  TRA     s:9484

      552     9369    5                         CASE(2);          /* $HJIT */

      553     9370    5                            DESC# = 8;

   9370  1 001435   000010 235007                    LDA     8,DL
         1 001436   200005 471500                    LDP1    @DESC#,,AUTO
         1 001437   100000 755100                    STA     0,,PR1
         1 001440   001776 710000 1                  TRA     s:9484

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:71   
      554     9371    5                         CASE(3);          /* $TCB */

      555     9372    5                            IF D_XDELTA

   9372  1 001441   000000 234000 xsym               SZN     D_XDELTA
         1 001442   001447 605000 1                  TPL     s:9377

      556     9373    6                            THEN DO;

      557     9374    6                                 S_D.ERROR = 113; /* E@UDONLYSYM */

   9374  1 001443   000161 235007                    LDA     113,DL
         1 001444   000000 471400 xsym               LDP1    S_D$
         1 001445   100013 755100                    STA     11,,PR1

      558     9375    6                                 ALTRETURN;

   9375  1 001446   000000 702200 xent               TSX2  ! X66_AALT

      559     9376    6                               END;
      560     9377    5                            DESC# = 9;

   9377  1 001447   000011 235007                    LDA     9,DL
         1 001450   200005 471500                    LDP1    @DESC#,,AUTO
         1 001451   100000 755100                    STA     0,,PR1
         1 001452   001776 710000 1                  TRA     s:9484

      561     9378    5                         CASE(4);          /* $SAD */

      562     9379    5                            IF S_D.SAD < 0

   9379  1 001453   000000 471400 xsym               LDP1    S_D$
         1 001454   105255 235100                    LDA     2733,,PR1
         1 001455   001461 605000 1                  TPL     s:9384

      563     9380    6                            THEN DO;

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:72   
      564     9381    6                                 S_D.ERROR = 181; /* E@NOSAD */

   9381  1 001456   000265 235007                    LDA     181,DL
         1 001457   100013 755100                    STA     11,,PR1

      565     9382    6                                 ALTRETURN;

   9382  1 001460   000000 702200 xent               TSX2  ! X66_AALT

      566     9383    6                               END;
      567     9384    5                            DESC# = 10;

   9384  1 001461   000012 235007                    LDA     10,DL
         1 001462   200005 473500                    LDP3    @DESC#,,AUTO
         1 001463   300000 755100                    STA     0,,PR3
         1 001464   001776 710000 1                  TRA     s:9484

      568     9385    5                         CASE(5, 6, 7);    /* $RVB, $USD, $ERR */

      569     9386    5                            IF NOT S_D.ANLZ_FILE

   9386  1 001465   000000 471400 xsym               LDP1    S_D$
         1 001466   105052 234100                    SZN     2602,,PR1
         1 001467   001473 604000 1                  TMI     s:9391

      570     9387    6                            THEN DO;

      571     9388    6                                 S_D.ERROR = 182; /* E@NOTANLZ_FILE */

   9388  1 001470   000266 235007                    LDA     182,DL
         1 001471   100013 755100                    STA     11,,PR1

      572     9389    6                                 ALTRETURN;

   9389  1 001472   000000 702200 xent               TSX2  ! X66_AALT

      573     9390    6                               END;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:73   
      574     9391    5                            DESC# = PSDITEM.ID + 6; /* 11, 12, 13 */

   9391  1 001473   200005 473500                    LDP3    @DESC#,,AUTO
         1 001474   000006 036007                    ADLQ    6,DL
         1 001475   300000 756100                    STQ     0,,PR3
         1 001476   001776 710000 1                  TRA     s:9484

      575     9392    5                         CASE(8);          /* $HEAD */

      576     9393    5                            IF NOT S_D.RUM

   9393  1 001477   000000 471400 xsym               LDP1    S_D$
         1 001500   104755 234100                    SZN     2541,,PR1
         1 001501   001505 604000 1                  TMI     s:9398

      577     9394    6                            THEN DO;

      578     9395    6                                 S_D.ERROR = 202; /* E@RUMONLY */

   9395  1 001502   000312 235007                    LDA     202,DL
         1 001503   100013 755100                    STA     11,,PR1

      579     9396    6                                 ALTRETURN;

   9396  1 001504   000000 702200 xent               TSX2  ! X66_AALT

      580     9397    6                               END;
      581     9398    5                            SEG = 7;

   9398  1 001505   000007 235007                    LDA     7,DL
         1 001506   000000 755100                    STA     0,,PR0

      582     9399    5                            DESC# = 2;

   9399  1 001507   000002 236007                    LDQ     2,DL
         1 001510   200005 473500                    LDP3    @DESC#,,AUTO
         1 001511   300000 756100                    STQ     0,,PR3
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:74   
         1 001512   001776 710000 1                  TRA     s:9484

      583     9400    5                         CASE(9);          /* $CGn */

      584     9401    5                            IF NOT S_D.ANLZ_FILE

   9401  1 001513   000000 471400 xsym               LDP1    S_D$
         1 001514   105052 234100                    SZN     2602,,PR1
         1 001515   001521 604000 1                  TMI     s:9406

      585     9402    6                            THEN DO;

      586     9403    6                                 S_D.ERROR = 182; /* E@NOTANLZ_FILE */

   9403  1 001516   000266 235007                    LDA     182,DL
         1 001517   100013 755100                    STA     11,,PR1

      587     9404    6                                 ALTRETURN;

   9404  1 001520   000000 702200 xent               TSX2  ! X66_AALT

      588     9405    6                               END;
      589     9406    5                            SEG = 8;

   9406  1 001521   000010 235007                    LDA     8,DL
         1 001522   000000 755100                    STA     0,,PR0

      590     9407    5                            DESC# = PSDITEM.DISP;

   9407  1 001523   200005 473500                    LDP3    @DESC#,,AUTO
         1 001524   200017 236100                    LDQ     POINTER,,AUTO
         1 001525   000014 772000                    QRL     12
         1 001526   000777 376007                    ANQ     511,DL
         1 001527   300000 756100                    STQ     0,,PR3

      591     9408    5                         END;              /* DO CASE(PSDITEM.ID) */

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:75   
   9408  1 001530   001776 710000 1                  TRA     s:9484

      592     9409    4                    CASE(1);               /* $PSR, $ASR, $ISR, $LSR */

      593     9410    4                       SEG = 1;

   9410  1 001531   000001 235007                    LDA     1,DL
         1 001532   200004 470500                    LDP0    @SEG,,AUTO
         1 001533   000000 755100                    STA     0,,PR0

      594     9411    5                       DO CASE(PSDITEM.ID);

   9411  1 001534   200017 236100                    LDQ     POINTER,,AUTO
         1 001535   000025 772000                    QRL     21
         1 001536   000777 376007                    ANQ     511,DL
         1 001537   000004 116007                    CMPQ    4,DL
         1 001540   001542 602006 1                  TNC     s:9411+6,QL
         1 001541   001776 710000 1                  TRA     s:9484
         1 001542   001546 710000 1                  TRA     s:9413
         1 001543   001556 710000 1                  TRA     s:9417
         1 001544   001552 710000 1                  TRA     s:9415
         1 001545   001563 710000 1                  TRA     s:9420

      595     9412    5                         CASE(0);          /* $PSR */

      596     9413    5                            DESC# = 3;

   9413  1 001546   000003 235007                    LDA     3,DL
         1 001547   200005 471500                    LDP1    @DESC#,,AUTO
         1 001550   100000 755100                    STA     0,,PR1
         1 001551   001776 710000 1                  TRA     s:9484

      597     9414    5                         CASE(2);          /* $ASR */

      598     9415    5                            DESC# = 4;

   9415  1 001552   000004 235007                    LDA     4,DL
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:76   
         1 001553   200005 471500                    LDP1    @DESC#,,AUTO
         1 001554   100000 755100                    STA     0,,PR1
         1 001555   001776 710000 1                  TRA     s:9484

      599     9416    5                         CASE(1);          /* $ISR */

      600     9417    5                            SEG = 3;

   9417  1 001556   000003 235007                    LDA     3,DL
         1 001557   000000 755100                    STA     0,,PR0

      601     9418    5                            DESC# = 0;

   9418  1 001560   200005 471500                    LDP1    @DESC#,,AUTO
         1 001561   100000 450100                    STZ     0,,PR1
         1 001562   001776 710000 1                  TRA     s:9484

      602     9419    5                         CASE(3);          /* $LSR */

      603     9420    5                            DESC# = 5;

   9420  1 001563   000005 235007                    LDA     5,DL
         1 001564   200005 471500                    LDP1    @DESC#,,AUTO
         1 001565   100000 755100                    STA     0,,PR1

      604     9421    5                         END;              /* DO CASE(PSDITEM.ID) */

   9421  1 001566   001776 710000 1                  TRA     s:9484

      605     9422    4                    CASE(2);               /* $DRn, $PRn, $AUTO */

      606     9423    4                       TEMP = (PSDITEM.DISP - 24) / 2 + 16;

   9423  1 001567   200017 236100                    LDQ     POINTER,,AUTO
         1 001570   000014 772000                    QRL     12
         1 001571   000777 376007                    ANQ     511,DL
         1 001572   000030 136007                    SBLQ    24,DL
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:77   
         1 001573   000002 506007                    DIV     2,DL
         1 001574   000020 036007                    ADLQ    16,DL
         1 001575   200026 756100                    STQ     TEMP,,AUTO

      607     9424    4                       PNTR = S_D.USS$ -> SS_PTR(TEMP);

   9424  1 001576   000000 470400 xsym               LDP0    S_D$
         1 001577   000005 471500                    LDP1    5,,PR0
         1 001600   100000 236106                    LDQ     0,QL,PR1
         1 001601   200025 756100                    STQ     PNTR,,AUTO

      608     9425    4                       IF PSDITEM.ID ~= 0

   9425  1 001602   200017 236100                    LDQ     POINTER,,AUTO
         1 001603   007770 316003                    CANQ    4088,DU
         1 001604   001622 600000 1                  TZE     s:9435

      609     9426    5                       THEN DO;            /* Add offset from ARn */

      610     9427    5                            IF PSDITEM.ID = 24 AND FALSE /* TEMP FOR TOP FRAME !! */

   9427  1 001605   200017 236100                    LDQ     POINTER,,AUTO
         1 001606   007770 376003                    ANQ     4088,DU
         1 001607   000300 116003                    CMPQ    192,DU
         1 001610   001617 601000 1                  TNZ     s:9432
         1 001611   000000 234000 0                  SZN     FALSE
         1 001612   001617 605000 1                  TPL     s:9432

      611     9428    6                            THEN DO;

      612     9429    6                                 PNTR.ADR='0'B;

   9429  1 001613   000000 236003                    LDQ     0,DU
         1 001614   200025 752174                    STCQ    PNTR,'74'O,AUTO

      613     9430    6                                 PNTR.ADR.W = S_D.ASTACKOFF;

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:78   
   9430  1 001615   004670 720100                    LXL0    2488,,PR0
         1 001616   200025 740100                    STX0    PNTR,,AUTO

      614     9431    6                               END;

      615     9432    5                            CALL ADDPNTR;

   9432  1 001617   002027 701000 1                  TSX1    ADDPNTR
         1 001620   000000 011000                    NOP     0

      616     9433    5                          END;

   9433  1 001621   001633 710000 1                  TRA     s:9438

      617     9434    5                       ELSE DO;

      618     9435    5                            SEG = PNTR.SEG;

   9435  1 001622   200004 471500                    LDP1    @SEG,,AUTO
         1 001623   200025 236100                    LDQ     PNTR,,AUTO
         1 001624   000012 772000                    QRL     10
         1 001625   000003 376007                    ANQ     3,DL
         1 001626   100000 756100                    STQ     0,,PR1

      619     9436    5                            DESC# = PNTR.DESC#;

   9436  1 001627   200005 473500                    LDP3    @DESC#,,AUTO
         1 001630   200025 236100                    LDQ     PNTR,,AUTO
         1 001631   001777 376007                    ANQ     1023,DL
         1 001632   300000 756100                    STQ     0,,PR3

      620     9437    5                          END;

      621     9438    4                       IF DESC# >= BITBIN('1700'O)

   9438  1 001633   200005 470500                    LDP0    @DESC#,,AUTO
         1 001634   000000 235100                    LDA     0,,PR0
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:79   
         1 001635   001700 115007                    CMPA    960,DL
         1 001636   001776 602000 1                  TNC     s:9484

      622     9439    5                       THEN DO;

      623     9440    5                            S_D.ERROR = 58; /* E@CANTEVAL */

   9440  1 001637   000072 236007                    LDQ     58,DL
         1 001640   000000 471400 xsym               LDP1    S_D$
         1 001641   100013 756100                    STQ     11,,PR1

      624     9441    5                            ALTRETURN;

   9441  1 001642   000000 702200 xent               TSX2  ! X66_AALT

      625     9442    5                          END;
      626     9443    4                    CASE(3);               /* $PSn, $ASn, $LSn, $DSn */

      627     9444    4                       SEG = PSDITEM.ID;

   9444  1 001643   200004 470500                    LDP0    @SEG,,AUTO
         1 001644   200017 236100                    LDQ     POINTER,,AUTO
         1 001645   000025 772000                    QRL     21
         1 001646   000777 376007                    ANQ     511,DL
         1 001647   000000 756100                    STQ     0,,PR0

      628     9445    4                       DESC# = PSDITEM.DISP / 2;

   9445  1 001650   200017 236100                    LDQ     POINTER,,AUTO
         1 001651   000014 772000                    QRL     12
         1 001652   000777 376007                    ANQ     511,DL
         1 001653   000001 772000                    QRL     1
         1 001654   200005 471500                    LDP1    @DESC#,,AUTO
         1 001655   100000 756100                    STQ     0,,PR1
         1 001656   001776 710000 1                  TRA     s:9484

      629     9446    4                    CASE(4);               /* $REAL, $VIRT */
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:80   

      630     9447    4                       SEG = 1;

   9447  1 001657   000001 235007                    LDA     1,DL
         1 001660   200004 470500                    LDP0    @SEG,,AUTO
         1 001661   000000 755100                    STA     0,,PR0

      631     9448    4                       DESC# = PSDITEM.ID;

   9448  1 001662   200005 471500                    LDP1    @DESC#,,AUTO
         1 001663   200017 236100                    LDQ     POINTER,,AUTO
         1 001664   000025 772000                    QRL     21
         1 001665   000777 376007                    ANQ     511,DL
         1 001666   100000 756100                    STQ     0,,PR1
         1 001667   001776 710000 1                  TRA     s:9484

      632     9449    4                    CASE(5);               /* $IOBUF */

      633     9450    4                       SEG = 1;

   9450  1 001670   000001 235007                    LDA     1,DL
         1 001671   200004 470500                    LDP0    @SEG,,AUTO
         1 001672   000000 755100                    STA     0,,PR0

      634     9451    4                       DESC# = 2;

   9451  1 001673   000002 236007                    LDQ     2,DL
         1 001674   200005 471500                    LDP1    @DESC#,,AUTO
         1 001675   100000 756100                    STQ     0,,PR1
         1 001676   001776 710000 1                  TRA     s:9484

      635     9452    4                    CASE(6);               /* $PARMn */

      636     9453    4                       IF NOT U$SE.CUR

   9453  1 001677   000000 470400 xsym               LDP0    USE$
         1 001700   000000 234100                    SZN     0,,PR0
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:81   
         1 001701   001706 604000 1                  TMI     s:9458

      637     9454    5                       THEN DO;

      638     9455    5                            S_D.ERROR = 38; /* E@USE_CONFLICT */

   9455  1 001702   000046 235007                    LDA     38,DL
         1 001703   000000 471400 xsym               LDP1    S_D$
         1 001704   100013 755100                    STA     11,,PR1

      639     9456    5                            ALTRETURN;

   9456  1 001705   000000 702200 xent               TSX2  ! X66_AALT

      640     9457    5                          END;
      641     9458    4                       TEMP = PSDITEM.DISP + PSDITEM.ID * 512;

   9458  1 001706   200017 236100                    LDQ     POINTER,,AUTO
         1 001707   000014 772000                    QRL     12
         1 001710   000777 376007                    ANQ     511,DL
         1 001711   200050 756100                    STQ     ITEM+5,,AUTO
         1 001712   200017 236100                    LDQ     POINTER,,AUTO
         1 001713   000014 772000                    QRL     12
         1 001714   777000 376007                    ANQ     -512,DL
         1 001715   200050 036100                    ADLQ    ITEM+5,,AUTO
         1 001716   200026 756100                    STQ     TEMP,,AUTO

      642     9459    4                       CALL DDK$GETPARM(TEMP, PNTR) ALTRET(BADPARM);

   9459  1 001717   200025 631500                    EPPR1   PNTR,,AUTO
         1 001720   200051 451500                    STP1    ITEM+6,,AUTO
         1 001721   200026 633500                    EPPR3   TEMP,,AUTO
         1 001722   200050 453500                    STP3    ITEM+5,,AUTO
         1 001723   200050 630500                    EPPR0   ITEM+5,,AUTO
         1 001724   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001725   000000 701000 xent               TSX1    DDK$GETPARM
         1 001726   002023 702000 1                  TSX2    BADPARM
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:82   

      643     9460    4                       CALL ADDPNTR;

   9460  1 001727   002027 701000 1                  TSX1    ADDPNTR
         1 001730   000000 011000                    NOP     0
         1 001731   001776 710000 1                  TRA     s:9484

      644     9461    4                    CASE(7);               /* $DCBn */

      645     9462    4                       SEG = 5;

   9462  1 001732   000005 235007                    LDA     5,DL
         1 001733   200004 470500                    LDP0    @SEG,,AUTO
         1 001734   000000 755100                    STA     0,,PR0

      646     9463    4                       DESC# = PSDITEM.DISP;

   9463  1 001735   200005 471500                    LDP1    @DESC#,,AUTO
         1 001736   200017 236100                    LDQ     POINTER,,AUTO
         1 001737   000014 772000                    QRL     12
         1 001740   000777 376007                    ANQ     511,DL
         1 001741   100000 756100                    STQ     0,,PR1
         1 001742   001776 710000 1                  TRA     s:9484

      647     9464    4                    CASE(8,9);             /* $ROSEG, $RDBR, $TSA, $Bn */

      648     9465    4                       IF S_D.RUM

   9465  1 001743   000000 470400 xsym               LDP0    S_D$
         1 001744   004755 234100                    SZN     2541,,PR0
         1 001745   001751 605000 1                  TPL     s:9467

      649     9466    4                       THEN S_D.ERROR = 232; /* E@NOSSRUM */

   9466  1 001746   000350 235007                    LDA     232,DL
         1 001747   000013 755100                    STA     11,,PR0
         1 001750   001753 710000 1                  TRA     s:9468
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:83   

      650     9467    4                       ELSE S_D.ERROR = 304; /* E@SYMNOTHOST */

   9467  1 001751   000460 235007                    LDA     304,DL
         1 001752   000013 755100                    STA     11,,PR0

      651     9468    4                       ALTRETURN;

   9468  1 001753   000000 702200 xent               TSX2  ! X66_AALT

      652     9469    4                    CASE(10);              /* $RES */

      653     9470    4                       SEG = 13;

   9470  1 001754   000015 235007                    LDA     13,DL
         1 001755   200004 470500                    LDP0    @SEG,,AUTO
         1 001756   000000 755100                    STA     0,,PR0

      654     9471    4                       DESC# = 0;

   9471  1 001757   200005 471500                    LDP1    @DESC#,,AUTO
         1 001760   100000 450100                    STZ     0,,PR1

      655     9472    4                    END;                   /* DO CASE(PSDITEM.TYPE) */

      656     9473    3                END;        /* DO(Evaluate ITEM as special descriptor symbol) */

   9473  1 001761   001776 710000 1                  TRA     s:9484

      657     9474    3             ELSE DO;                      /* Evaluate ITEM as user pointer */

      658     9475    3                  PNTR = POINTR;

   9475  1 001762   200017 236100                    LDQ     POINTER,,AUTO
         1 001763   200025 756100                    STQ     PNTR,,AUTO

      659     9476    3                  CALL ADDPNTR;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:84   

   9476  1 001764   002027 701000 1                  TSX1    ADDPNTR
         1 001765   000000 011000                    NOP     0

      660     9477    3                END;                       /* DO(Evaluate ITEM as pointer) */

   9477  1 001766   001776 710000 1                  TRA     s:9484

      661     9478    2          CASE( ELSE );                    /* Shouldn't happen */

      662     9479    2             S_D.ERROR = 502;         /* E@DELBUG */

   9479  1 001767   000766 235007                    LDA     502,DL
         1 001770   000000 475400 xsym               LDP5    S_D$
         1 001771   500013 755100                    STA     11,,PR5

      663     9480    2             CALL DDE$ERROR;

   9480  1 001772   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001773   000000 701000 xent               TSX1    DDE$ERROR
         1 001774   000000 011000                    NOP     0

      664     9481    2             RETURN;

   9481  1 001775   000000 702200 xent               TSX2  ! X66_ARET

      665     9482    2          END;                             /* DO CASE(ADDR_TYPE) */

      666     9483                                                /**/
      667     9484    1        IF SEG ~= 3                        /* LS */

   9484  1 001776   200004 470500                    LDP0    @SEG,,AUTO
         1 001777   000000 235100                    LDA     0,,PR0
         1 002000   000003 115007                    CMPA    3,DL
         1 002001   002005 601000 1                  TNZ     s:9486
         1 002002   200005 471500                    LDP1    @DESC#,,AUTO
         1 002003   100000 235100                    LDA     0,,PR1
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:85   
         1 002004   002010 600000 1                  TZE     s:9487

      668     9485    1          OR DESC# ~= 0                    /* IS */
      669     9486    1        THEN NOT_IS = '1'B;

   9486  1 002005   400000 236003                    LDQ     -131072,DU
         1 002006   200006 471500                    LDP1    @NOT_IS,,AUTO
         1 002007   100000 756100                    STQ     0,,PR1

      670     9487    1        IF ADDR(BSIZE) ~= ADDR(NIL)

   9487  1 002010   200010 236100                    LDQ     @BSIZE,,AUTO
         1 002011   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002012   002016 600000 1                  TZE     s:9489

      671     9488    1        THEN BSIZE = SIZE;

   9488  1 002013   200015 235100                    LDA     SIZE,,AUTO
         1 002014   200010 471500                    LDP1    @BSIZE,,AUTO
         1 002015   100000 755100                    STA     0,,PR1

      672     9489    1        RETURN;

   9489  1 002016   000000 702200 xent               TSX2  ! X66_ARET

   9487  1 002017                       TRAP_VIRTUAL null
      673     9490    1   TRAP_VIRTUAL: ;
      674     9491    1        S_D.ERROR = 264;        /* E@TRAP_VIRTUAL */

   9491  1 002017   000410 235007                    LDA     264,DL
         1 002020   000000 470400 xsym               LDP0    S_D$
         1 002021   000013 755100                    STA     11,,PR0

      675     9492    1        ALTRETURN;

   9492  1 002022   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:86   
      676     9493    1   BADPARM:
      677     9494    1        S_D.ERROR = 103;       /* E@PACCESS_FAULT */

   9494  1 002023   000147 235007       BADPARM      LDA     103,DL
         1 002024   000000 470400 xsym               LDP0    S_D$
         1 002025   000013 755100                    STA     11,,PR0

      678     9495    1   AERR:
      679     9496    1        ALTRETURN;

   9496  1 002026   000000 702200 xent  AERR         TSX2  ! X66_AALT

      680     9497             %EJECT;
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:87   
      681     9498    1   ADDPNTR: PROC;                          /* Add user pointer to ADDRESS */

   9498  1 002027   200046 741300       ADDPNTR      STX1  ! ITEM+3,,AUTO

      682     9499    2        ADDRESS = ADDRESS + PNTR.ADR.W;

   9499  1 002030   200003 470500                    LDP0    @ADDRESS,,AUTO
         1 002031   200025 236100                    LDQ     PNTR,,AUTO
         1 002032   000022 772000                    QRL     18
         1 002033   000000 036100                    ADLQ    0,,PR0
         1 002034   000000 756100                    STQ     0,,PR0

      683     9500    2        IF ADDR(BITOFF) ~= ADDR(NIL)

   9500  1 002035   200007 236100                    LDQ     @BITOFF,,AUTO
         1 002036   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002037   002064 600000 1                  TZE     s:9506

      684     9501    3        THEN DO;

      685     9502    3             BITOFF = BITOFF + PNTR.ADR.C * 9 + PNTR.ADR.B;

   9502  1 002040   200007 471500                    LDP1    @BITOFF,,AUTO
         1 002041   200025 236100                    LDQ     PNTR,,AUTO
         1 002042   000020 772000                    QRL     16
         1 002043   000003 376007                    ANQ     3,DL
         1 002044   000011 402007                    MPY     9,DL
         1 002045   100000 036100                    ADLQ    0,,PR1
         1 002046   200050 756100                    STQ     ITEM+5,,AUTO
         1 002047   200025 236100                    LDQ     PNTR,,AUTO
         1 002050   000014 772000                    QRL     12
         1 002051   000017 376007                    ANQ     15,DL
         1 002052   200051 756100                    STQ     ITEM+6,,AUTO
         1 002053   200050 236100                    LDQ     ITEM+5,,AUTO
         1 002054   200051 036100                    ADLQ    ITEM+6,,AUTO
         1 002055   100000 756100                    STQ     0,,PR1

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:88   
      686     9503    3             ADDRESS = ADDRESS + BITOFF / 36;

   9503  1 002056   000044 506007                    DIV     36,DL
         1 002057   000000 036100                    ADLQ    0,,PR0
         1 002060   000000 756100                    STQ     0,,PR0

      687     9504    3             BITOFF = MOD(BITOFF, 36);

   9504  1 002061   100000 236100                    LDQ     0,,PR1
         1 002062   000044 506007                    DIV     36,DL
         1 002063   100000 755100                    STA     0,,PR1

      688     9505    3           END;

      689     9506    2        SEG = PNTR.SEG;

   9506  1 002064   200004 471500                    LDP1    @SEG,,AUTO
         1 002065   200025 236100                    LDQ     PNTR,,AUTO
         1 002066   000012 772000                    QRL     10
         1 002067   000003 376007                    ANQ     3,DL
         1 002070   100000 756100                    STQ     0,,PR1

      690     9507    2        DESC# = PNTR.DESC#;

   9507  1 002071   200005 473500                    LDP3    @DESC#,,AUTO
         1 002072   200025 236100                    LDQ     PNTR,,AUTO
         1 002073   001777 376007                    ANQ     1023,DL
         1 002074   300000 756100                    STQ     0,,PR3

      691     9508    2        RETURN;

   9508  1 002075   200046 221300                    LDX1  ! ITEM+3,,AUTO
         1 002076   000001 702211                    TSX2  ! 1,X1

FALSE
 Sect OctLoc
   0     000   0***** ******                                                    ....
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:89   

(unnamed)
 Sect OctLoc
   0     001   777777 770000   000000 002000                                    ........

(unnamed)
 Sect OctLoc
   2     000   000011 000000                                                    ....
      692     9509    2   END ADDPNTR;
      693     9510                                                /**/
      694     9511    1   END DDK$EVAL;

PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:90   
--  Include file information  --

   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   DD_DESC_R.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure DDK$EVAL.

   Procedure DDK$EVAL requires 1087 words for executable code.
   Procedure DDK$EVAL requires 50 words of local(AUTO) storage.

    No errors detected in file DDK$EVAL.:E05TSI    .
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:91   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:92   
          MINI XREF LISTING

ADDPNTR
      9498**PROC     9432--CALL     9460--CALL     9476--CALL
ADDRESS
       126**DCL       124--PROC      127--REDEF     128--REDEF    9066<<ASSIGN   9078<<ASSIGN   9087<<ASSIGN
      9088<<ASSIGN   9091<<ASSIGN   9095<<ASSIGN   9098<<ASSIGN   9104<<ASSIGN   9111<<ASSIGN   9117<>CALL
      9127<<ASSIGN   9130<<ASSIGN   9133<<ASSIGN   9136<<ASSIGN   9139<<ASSIGN   9142<<ASSIGN   9145<<ASSIGN
      9148<<ASSIGN   9151<<ASSIGN   9154<<ASSIGN   9157<<ASSIGN   9160<<ASSIGN   9164<<ASSIGN   9168<<ASSIGN
      9177<<ASSIGN   9187<<ASSIGN   9188>>IF       9190<<ASSIGN   9190>>ASSIGN   9201<<ASSIGN   9211<<ASSIGN
      9212>>IF       9214<<ASSIGN   9214>>ASSIGN   9218<<ASSIGN   9223<<ASSIGN   9228<<ASSIGN   9233<<ASSIGN
      9237<<ASSIGN   9240<<ASSIGN   9257<<ASSIGN   9268<>CALL     9279<<ASSIGN   9282<<ASSIGN   9282>>ASSIGN
      9286<<ASSIGN   9286>>ASSIGN   9291<>CALL     9499<<ASSIGN   9499>>ASSIGN   9503<<ASSIGN   9503>>ASSIGN
ADDRESSBITS
       127**DCL      9101<<ASSIGN
ADDRESSCHARS
       128**DCL      9108<<ASSIGN
ADDR_TYPE
       157**DCL      9040<>CALL     9050>>DOCASE   9293>>DOCASE
ADD_INDXX
      9281**LABEL    9274--GOTO
AERR
      9496**LABEL    9040--CALLALT
ARRAY_FLAG
       158**DCL      9040<>CALL     9281>>IF
B$EDEF.OU
      6229**DCL      6235--REDEF
BADPARM
      9494**LABEL    9459--CALLALT
BASED_STATIC
      9290**LABEL    9258--GOTO
BITOFF
       132**DCL       124--PROC     9031--IF       9032<<ASSIGN   9283--IF       9287<<ASSIGN   9500--IF
      9502<<ASSIGN   9502>>ASSIGN   9503>>ASSIGN   9504<<ASSIGN   9504>>ASSIGN
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:93   
BSIZE
       133**DCL       124--PROC     9298--IF       9299<<ASSIGN   9487--IF       9488<<ASSIGN
CHKADDREXP
      9116**LABEL    9079--GOTO     9089--GOTO     9092--GOTO     9178--GOTO     9192--GOTO     9202--GOTO
      9216--GOTO     9221--GOTO     9224--GOTO
DDE$ERROR
      9021**DCL-ENT  9480--CALL
DDI$GET_PATCH_SPACE
      9022**DCL-ENT  9171--CALL     9181--CALL     9195--CALL     9205--CALL
DDK$ADDEXPR
      9027**DCL-ENT  9117--CALL     9291--CALL
DDK$GETADDR
      9023**DCL-ENT  9040--CALL
DDK$GETMVAL
      9024**DCL-ENT  9268--CALL     9271--CALL
DDK$GETPARM
      9026**DCL-ENT  9459--CALL
DESC.ITEM
      1538**DCL      9302>>ASSIGN
DESC#
       130**DCL       124--PROC     9047<<ASSIGN   9065<<ASSIGN   9076<<ASSIGN   9084<<ASSIGN   9126<<ASSIGN
      9129<<ASSIGN   9132<<ASSIGN   9135<<ASSIGN   9138<<ASSIGN   9141<<ASSIGN   9144<<ASSIGN   9147<<ASSIGN
      9150<<ASSIGN   9153<<ASSIGN   9156<<ASSIGN   9159<<ASSIGN   9163<<ASSIGN   9167<<ASSIGN   9227<<ASSIGN
      9232<<ASSIGN   9236<<ASSIGN   9239<<ASSIGN   9265<<ASSIGN   9268<>CALL     9271<>CALL     9272<<ASSIGN
      9366<<ASSIGN   9368<<ASSIGN   9370<<ASSIGN   9377<<ASSIGN   9384<<ASSIGN   9391<<ASSIGN   9399<<ASSIGN
      9407<<ASSIGN   9413<<ASSIGN   9415<<ASSIGN   9418<<ASSIGN   9420<<ASSIGN   9436<<ASSIGN   9438>>IF
      9445<<ASSIGN   9448<<ASSIGN   9451<<ASSIGN   9463<<ASSIGN   9471<<ASSIGN   9484>>IF       9507<<ASSIGN
D_XDELTA
      9019**DCL      9033>>IF       9120>>IF       9162>>IF       9166>>IF       9372>>IF
EXPR_OP
       156**DCL      9040<>CALL     9116>>IF       9117<>CALL     9290>>IF       9291<>CALL
EXPR_VAL
       155**DCL      9040<>CALL     9117<>CALL     9291<>CALL
FALSE
       135**DCL      9427>>IF
FINDSTACK
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:94   
      9304**LABEL    9304--GOTO
GOTSEG
      9252**LABEL    9118--GOTO     9229--GOTO     9234--GOTO
I
       136**DCL      9099<<DOINDEX  9100>>ASSIGN   9106<<DOINDEX  9107>>ASSIGN   9285<<ASSIGN   9286>>ASSIGN
      9287>>ASSIGN
INDXX
       141**DCL      9040<>CALL     9282>>ASSIGN   9285>>ASSIGN
ITEM
      2699**DCL      9040<>CALL
ITEM.ADDRESS
      2720**DCL      2725--REDEF    2726--REDEF    2727--REDEF
ITEM.ADDRESS.B
      2724**DCL      9285>>ASSIGN
ITEM.ADDRESS.C
      2723**DCL      9285>>ASSIGN
ITEM.ADDRESS.W
      2722**DCL      9263>>ASSIGN   9279>>ASSIGN
ITEM.SP.VD
      2728**DCL      2732--REDEF    2735--REDEF
ITEM.SP.VD.DISP
      2731**DCL      9066>>ASSIGN
ITEM.SP.VD.ID
      2730**DCL      9055>>IF       9055>>IF
ITEM.SP.VD.TYPE
      2729**DCL      9055>>IF
ITEM.SP.VS.ID
      2736**DCL      9071>>DOCASE
ITEM.SP.VS.SZ
      2737**DCL      9145>>ASSIGN   9160>>ASSIGN   9164>>ASSIGN   9168>>ASSIGN
ITEM.VALUE
      2725**DCL      9257>>ASSIGN
J
       137**DCL      9100<<ASSIGN   9101>>ASSIGN   9101>>ASSIGN   9107<<ASSIGN   9108>>ASSIGN   9108>>ASSIGN
NOTXDELTA
      9123**LABEL    9162--GOTO     9166--GOTO
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:95   
NOT_IS
       131**DCL       124--PROC     9048<<ASSIGN   9266<<ASSIGN   9268<>CALL     9271<>CALL     9273<<ASSIGN
      9486<<ASSIGN
PNTR
       160**DCL      9271<>CALL     9424<<ASSIGN   9459<>CALL     9475<<ASSIGN
PNTR.ADR
       161**DCL      9429<<ASSIGN
PNTR.ADR.B
       164**DCL      9502>>ASSIGN
PNTR.ADR.C
       163**DCL      9502>>ASSIGN
PNTR.ADR.W
       162**DCL      9430<<ASSIGN   9499>>ASSIGN
PNTR.DESC#
       166**DCL      9272>>ASSIGN   9436>>ASSIGN   9507>>ASSIGN
PNTR.SEG
       165**DCL      9435>>ASSIGN   9506>>ASSIGN
POINTER
       142**DCL       143--REDEF     150--REDEF    9040<>CALL     9302<<ASSIGN
POINTR
       143**DCL      9475>>ASSIGN
POINTR.SEG
       148**DCL      9359>>IF
PSDITEM.DISP
       153**DCL      9407>>ASSIGN   9423>>ASSIGN   9445>>ASSIGN   9458>>ASSIGN   9463>>ASSIGN
PSDITEM.ID
       152**DCL      9364>>DOCASE   9391>>ASSIGN   9411>>DOCASE   9425>>IF       9427>>IF       9444>>ASSIGN
      9448>>ASSIGN   9458>>ASSIGN
PSDITEM.TYPE
       151**DCL      9361>>DOCASE
PUP
       169**DCL      9042<<ASSIGN
PUP.PUB
       172**DCL      9043>>IF
SEG
       129**DCL       124--PROC     9046<<ASSIGN   9064<<ASSIGN   9075<<ASSIGN   9083<<ASSIGN   9226<<ASSIGN
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:96   
      9231<<ASSIGN   9251<<ASSIGN   9252<<ASSIGN   9252>>ASSIGN   9264<<ASSIGN   9268<>CALL     9271<>CALL
      9363<<ASSIGN   9398<<ASSIGN   9406<<ASSIGN   9410<<ASSIGN   9417<<ASSIGN   9435<<ASSIGN   9444<<ASSIGN
      9447<<ASSIGN   9450<<ASSIGN   9462<<ASSIGN   9470<<ASSIGN   9484>>IF       9506<<ASSIGN
SIZE
       140**DCL      9040<>CALL     9044<<ASSIGN   9044>>ASSIGN   9299>>ASSIGN   9488>>ASSIGN
SIZED9
       138**DCL      9105<<ASSIGN   9106>>DOINDEX  9107>>ASSIGN
SS_PTR
      1539**DCL      9424>>ASSIGN
STACKOFF
      1543**DCL      9351>>ASSIGN
SVALUE
       139**DCL      9040<>CALL
S_D.ACCESS
      7740**DCL      9350<<ASSIGN
S_D.ANLZ
      8353**DCL      9307>>IF
S_D.ANLZ_FILE
      8417**DCL      9386>>IF       9401>>IF
S_D.ARRAY.FIRST
      7980**DCL      9039<<ASSIGN
S_D.ASTACKOFF
      8231**DCL      9351<<ASSIGN   9430>>ASSIGN
S_D.CURRENT_CHANNEL
      8653**DCL      8655--REDEF
S_D.DEBUGA
      7805**DCL      7807--REDEF
S_D.DEFINED#
      8439**DCL      9194>>IF       9204>>IF
S_D.DEFINED@
      8429**DCL      9170>>IF       9180>>IF
S_D.DESC$
      7785**DCL      9030>>ASSIGN   9033>>IF
S_D.EIS
      8763**DCL      8792--REDEF
S_D.ERROR
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:97   
      7734**DCL      9036<<ASSIGN   9060<<ASSIGN   9061<<ASSIGN   9123<<ASSIGN   9174<<ASSIGN   9184<<ASSIGN
      9198<<ASSIGN   9208<<ASSIGN   9244<<ASSIGN   9245<<ASSIGN   9248<<ASSIGN   9310<<ASSIGN   9374<<ASSIGN
      9381<<ASSIGN   9388<<ASSIGN   9395<<ASSIGN   9403<<ASSIGN   9440<<ASSIGN   9455<<ASSIGN   9466<<ASSIGN
      9467<<ASSIGN   9479<<ASSIGN   9491<<ASSIGN   9494<<ASSIGN
S_D.GOT#
      8431**DCL      9196>>IF       9206>>IF
S_D.GOT$L
      8742**DCL      9114<<ASSIGN
S_D.GOT$RI
      8536**DCL      9220<<ASSIGN
S_D.GOT@
      8421**DCL      9172>>IF       9182>>IF
S_D.HOST_MESSAGE_BUF_REMOTE
      8696**DCL      8697--REDEF    8711--REDEF
S_D.JDE
      8310**DCL      8311--REDEF
S_D.L$.FMT
      7889**DCL      9096>>DOCASE
S_D.L$.SIZE
      7888**DCL      9094>>IF       9099>>DOINDEX  9100>>ASSIGN   9105>>ASSIGN
S_D.L$.VALUE
      7863**DCL      7869--REDEF    7877--REDEF    7880--REDEF    7883--REDEF    7886--REDEF
S_D.L$.VALUE.L
      7864**DCL      7865--REDEF    7866--REDEF    9095>>ASSIGN   9111>>ASSIGN
S_D.L$.VB.VBITS
      7878**DCL      9101>>ASSIGN
S_D.L$.VC.VCHARS
      7881**DCL      9108>>ASSIGN
S_D.L6_MESSAGE_BUF
      8717**DCL      8719--REDEF
S_D.NA$
      8445**DCL      9223>>ASSIGN
S_D.NEXT#
      8433**DCL      9201>>ASSIGN   9211>>ASSIGN
S_D.NEXT@
      8423**DCL      9177>>ASSIGN   9187>>ASSIGN
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:98   
S_D.O$.ADDRESS
      7894**DCL      9078>>ASSIGN   9087>>ASSIGN   9088>>ASSIGN
S_D.O$.DESC#
      7893**DCL      9076>>ASSIGN   9084>>ASSIGN
S_D.O$.NOT_IS
      7895**DCL      9073>>IF       9081>>IF
S_D.O$.SEG
      7892**DCL      9075>>ASSIGN   9083>>ASSIGN
S_D.O$SIZE
      8815**DCL      9088>>ASSIGN
S_D.ONE_TO_TWO.EXEC_DOMAIN
      8728**DCL      9086>>IF       9113>>IF       9219>>IF
S_D.OUTPUT
      8683**DCL      8685--REDEF
S_D.REMOTE_MSG.FNCC
      8702**DCL      8703--REDEF
S_D.REMOTE_MSG.STXC
      8698**DCL      8699--REDEF
S_D.REMOTE_MSG.SUBFNCC
      8706**DCL      8707--REDEF
S_D.RI$.OPS
      8443**DCL      9218>>ASSIGN
S_D.RUM
      8351**DCL      9059>>IF       9243>>IF       9307>>IF       9393>>IF       9465>>IF
S_D.SAD
      8562**DCL      9379>>IF
S_D.SAVEIC
      7716**DCL      9091>>ASSIGN
S_D.SV
      7762**DCL      7783--REDEF
S_D.USS$
      7722**DCL      9424>>ASSIGN
S_D$
      9014**DCL      7710--IMP-PTR  9030>>ASSIGN   9033>>IF       9036>>ASSIGN   9039>>ASSIGN   9059>>IF
      9060>>ASSIGN   9061>>ASSIGN   9073>>IF       9075>>ASSIGN   9076>>ASSIGN   9078>>ASSIGN   9081>>IF
      9083>>ASSIGN   9084>>ASSIGN   9086>>IF       9087>>ASSIGN   9088>>ASSIGN   9088>>ASSIGN   9091>>ASSIGN
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:99   
      9094>>IF       9095>>ASSIGN   9096>>DOCASE   9099>>DOINDEX  9100>>ASSIGN   9101>>ASSIGN   9105>>ASSIGN
      9108>>ASSIGN   9111>>ASSIGN   9113>>IF       9114>>ASSIGN   9123>>ASSIGN   9170>>IF       9172>>IF
      9174>>ASSIGN   9177>>ASSIGN   9180>>IF       9182>>IF       9184>>ASSIGN   9187>>ASSIGN   9194>>IF
      9196>>IF       9198>>ASSIGN   9201>>ASSIGN   9204>>IF       9206>>IF       9208>>ASSIGN   9211>>ASSIGN
      9218>>ASSIGN   9219>>IF       9220>>ASSIGN   9223>>ASSIGN   9243>>IF       9244>>ASSIGN   9245>>ASSIGN
      9248>>ASSIGN   9307>>IF       9307>>IF       9310>>ASSIGN   9350>>ASSIGN   9351>>ASSIGN   9374>>ASSIGN
      9379>>IF       9381>>ASSIGN   9386>>IF       9388>>ASSIGN   9393>>IF       9395>>ASSIGN   9401>>IF
      9403>>ASSIGN   9424>>ASSIGN   9430>>ASSIGN   9440>>ASSIGN   9455>>ASSIGN   9465>>IF       9466>>ASSIGN
      9467>>ASSIGN   9479>>ASSIGN   9491>>ASSIGN   9494>>ASSIGN
TADDRESS
       168**DCL      9263<<ASSIGN   9268<>CALL     9269<<ASSIGN   9269>>ASSIGN   9271<>CALL
TEMP
       167**DCL      9423<<ASSIGN   9424>>ASSIGN   9458<<ASSIGN   9459<>CALL
TRAP_VIRTUAL
      9487**LABEL    9268--CALLALT  9271--CALLALT
U$SE.CUR
      1483**DCL      9033>>IF       9453>>IF
USE$
       177**DCL      1482--IMP-PTR  9033>>IF       9453>>IF
ZITEM.ADDRESS
      2661**DCL      2666--REDEF    2667--REDEF    2668--REDEF
ZITEM.FLAGS.MDSE.S
      2636**DCL      9033>>IF
ZITEM.PUP
      2682**DCL      9042>>ASSIGN
ZITEM.SP.VD
      2669**DCL      2673--REDEF    2676--REDEF
ZITEM$
      2050**DCL      2627--IMP-PTR  9030<<ASSIGN   9042>>ASSIGN
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:100  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DDK$EVAL File=DDK$EVAL.:E05TSI                                TUE 07/29/97 14:00 Page:101  
              MINI UREF LISTING

DDF$FIND_PEDEF    9028**DCL-ENT
DDK$EVAL     124**PROC
DDK$GETSPEC    9025**DCL-ENT
GOTSTACK    9307**LABEL
RETADDR    1545**DCL
RSTACKOFF    1544**DCL
SDD$    2049**DCL
SDD_L6$    2051**DCL
SFLAG     159**DCL
STACK$    1546**DCL
STACKIC    1542**DCL
TEDEF$    1547**DCL
UDR2$    1540**DCL
UIS$    1541**DCL
W    2778**DCL
ZITEM_L6$    2052**DCL
