VERSION E05

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:1    
        1        1        /*M* QQB$PASSWORD - Perform  PASSWORD  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$PASSWORD:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE KL_SUPER_C;
       17     4179        %INCLUDE XU_MACRO_C;
       18     7285        %INCLUDE QQ_SUBS_C;
       19     7477        %INCLUDE QQ_MACROS_C;
       20     7902        %INCLUDE QQ_DATA_R;
       21     8148        %INCLUDE QQ_PERR_C;
       22     8309        %INCLUDE Q_ERRCODE_C;
       23     8332        %PAGE(ARG="Externally defined routines");

              8349    1   /***************************************************************************
              8350    1    *                                                                         *
              8351    1    *                        Externally defined routines                      *
              8352    1    *                                                                         *
              8353    1    ***************************************************************************/

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:2    
       24     8357    1   DCL QQC$SCREECH ENTRY;
       25     8358    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       26     8359    1   DCL QQC$BLDMSG ENTRY(1);
       27     8360    1   DCL ASZ$SCRAMBLE ENTRY(1);
       28     8361        %PAGE(ARG="Symrefs");

              8378    1   /***************************************************************************
              8379    1    *                                                                         *
              8380    1    *                                  Symrefs                                *
              8381    1    *                                                                         *
              8382    1    ***************************************************************************/

       29     8386    1   DCL B$TCB$ PTR SYMREF;
       30     8387        %PAGE(ARG="DCBs");

              8404    1   /***************************************************************************
              8405    1    *                                                                         *
              8406    1    *                                    DCBs                                 *
              8407    1    *                                                                         *
              8408    1    ***************************************************************************/

       31     8412        %M$DCB(DCBN=M$HLP, NAME=':HLP', ACCT=':SYS', SHARE=ALL);
       32     8486        %PAGE(ARG="Based");

              8503    1   /***************************************************************************
              8504    1    *                                                                         *
              8505    1    *                                   Based                                 *
              8506    1    *                                                                         *
              8507    1    ***************************************************************************/

       33     8511        %B$TCB;
       34     8514        %F$DCB;
       35     8571        %B$ALT;
       36     8579        %TP$STATION;
       37     8652        %PARSE$OUT(STCLASS=BASED);
       38     8697        %PARSE$SYM(STCLASS=BASED);
       39     8735        %KL_DREC(NAME=KL$DREC, STCLASS="BASED(KL_DREC$)",LAST=";");
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:3    
       40     8848        %PAGE(ARG="Auto");

              8865    1   /***************************************************************************
              8866    1    *                                                                         *
              8867    1    *                                    Auto                                 *
              8868    1    *                                                                         *
              8869    1    ***************************************************************************/

       41     8873    1   DCL KL_DREC$ PTR;
       42     8874    1   DCL SUBLK$ PTR;
       43     8875    1   DCL M$HLP$ PTR;
       44     8876
       45     8877    1   DCL OLD_PASSWORD CHAR(8);
       46     8878    1   DCL NEW_PASSWORD CHAR(8);
       47     8879
       48     8880    1   DCL ENQ_FLAG BIT(1) ALIGNED;
       49     8881
       50     8882    1   DCL I UBIN WORD;
       51     8883
       52     8884        %MSGBLK;
       53     8974        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:4    
              8991    1   /***************************************************************************
              8992    1    *                                                                         *
              8993    1    *                                Error codes                              *
              8994    1    *                                                                         *
              8995    1    ***************************************************************************/

       54     8999        %ERRCODE(NAME=CODE_NOMATCH, CODE#=%E$NOMATCHPASS, FCG#=%FCG_QQ, MID#=%MID_B);
       55     9006        %ERRCODE(NAME=CODE_TRY_AGAIN, CODE#=%E$TRY_AGAIN, FCG#=%FCG_QQ, MID#=%MID_B);
       56     9013        %ERRCODE(NAME=CODE_PASSMSG, CODE#=%E$PASSMSG, FCG#=%FCG_QQ, MID#=%MID_B);
       57     9020        /*E*       ERROR: QQB-E$NOMATCHPASS-C
       58     9021
       59     9022                 MESSAGE: Password supplied doesn't match current
       60     9023                          password.
       61     9024             DESCRIPTION: To change your password you must supply a password
       62     9025                          which matches the one on file.
       63     9026        */
       64     9027        /*E*       ERROR: QQB-E$TRY_AGAIN-C
       65     9028
       66     9029                 MESSAGE: Unable to change your password now.  Please try
       67     9030                          again.
       68     9031             DESCRIPTION: If for instance, the :HLP is busy we recommend
       69     9032                          that the password change be tried later.
       70     9033        */
       71     9034        /*E*       ERROR: QQB-E$PASSMSG-C
       72     9035
       73     9036                 MESSAGE: Password change successful
       74     9037             DESCRIPTION: Informational message to user that password change
       75     9038                          was completed.
       76     9039        */
       77     9040        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:5    
              9057    1   /***************************************************************************
              9058    1    *                                                                         *
              9059    1    *                                    FPTs                                 *
              9060    1    *                                                                         *
              9061    1    ***************************************************************************/

       78     9065        %FPT_READ(DCB=M$HLP, KEY=VLP_KEY, KEYS=YES);
       79     9104
       80     9105        %FPT_WRITE(DCB=M$HLP, KEY=VLP_KEY);
       81     9136
       82     9137        %FPT_OPEN(DCB=M$HLP, ASN=FILE, FUN=UPDATE);
       83     9246
       84     9247        %FPT_CLOSE(DCB=M$HLP, DISP=SAVE);
       85     9289
       86     9290        %FPT_ENQ(DCB=M$HLP, SHARE=NONE, RNAME=VLP_KEY);
       87     9308
       88     9309        %FPT_DEQ(DCB=M$HLP, RNAME=VLP_KEY);
       89     9326        %PAGE(ARG="VLPs");

              9343    1   /***************************************************************************
              9344    1    *                                                                         *
              9345    1    *                                    VLPs                                 *
              9346    1    *                                                                         *
              9347    1    ***************************************************************************/

       90     9351    1   DCL 1 VLP_KEY STATIC,
       91     9352    1         2 L# UBIN(9) UNAL,
       92     9353    1         2 STATION CHAR(8),
       93     9354    1         2 UNAME   CHAR(8);
       94     9355
       95     9356    1   DCL POS UBIN WORD;
       96     9357
       97     9358        %PAGE(ARG="QQB$PASSWORD", PAGE=YES);

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:6    
              9375    1   /***************************************************************************
              9376    1    *                                                                         *
              9377    1    *                                QQB$PASSWORD                             *
              9378    1    *                                                                         *
              9379    1    ***************************************************************************/

       98     9383    1           ENQ_FLAG = '0'B;
       99     9384    1           OLD_PASSWORD = ' ';
      100     9385    1           NEW_PASSWORD = ' ';
      101     9386    1           KL_DREC$ = QQ_GLOBAL.TRASHBUF$;
      102     9387    1           M$HLP$ = DCBADDR(DCBNUM(M$HLP));
      103     9388
      104     9389    2           DO I = 0 TO QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;
      105     9390    2             SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);
      106     9391    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);
      107     9392
      108     9393    3               CASE(1 /* OPT_OLD */);
      109     9394    3                 OLD_PASSWORD = SUBLK$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
      110     9395
      111     9396    3               CASE(2 /* OPT_NEW */);
      112     9397    3                 NEW_PASSWORD = SUBLK$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;
      113     9398
      114     9399    3             END /* CASE */;
      115     9400    2           END;
      116     9401
      117     9402    1           CALL ASZ$SCRAMBLE(OLD_PASSWORD);
      118     9403    1           CALL ASZ$SCRAMBLE(NEW_PASSWORD);
      119     9404
      120     9405    1           VLP_KEY.STATION = QQ_CMDBLK.S$ -> TP$STATION.WHO.ACCT;
      121     9406    1           VLP_KEY.UNAME = QQ_CMDBLK.S$ -> TP$STATION.WHO.NAME;
      122     9407    1           CALL INDEX(POS, ' ', VLP_KEY.UNAME);
      123     9408    1           VLP_KEY.L# = POS + SIZEC(VLP_KEY.STATION);
      124     9409
      125     9410    1           CALL M$OPEN(FPT_OPEN) ALTRET(TRY_AGAIN);
      126     9411
      127     9412    1           CALL M$ENQ(FPT_ENQ) ALTRET(MON_ERR);
      128     9413    1           ENQ_FLAG = '1'B;
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:7    
      129     9414
      130     9415    1           FPT_READ.BUF_.BUF$ = KL_DREC$;
      131     9416    1           FPT_WRITE.BUF_.BUF$ = KL_DREC$;
      132     9417
      133     9418    1   READ_HLP:
      134     9419    1           FPT_READ.BUF_.BOUND = QQ_GLOBAL.TRASHBUF_SIZE - 1;
      135     9420    1           CALL M$READ(FPT_READ) ALTRET(READ_ERR);
      136     9421
      137     9422    2           DO WHILE('0'B);
      138     9423
      139     9424    2   READ_ERR:
      140     9425    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 66 /* E$NOKEY */ THEN
      141     9426    3               DO;
      142     9427    3                 GOTO MON_ERR;
      143     9428    3               END;
      144     9429
      145     9430    2             GOTO TRY_AGAIN;
      146     9431    2           END /* NEVER */;
      147     9432
      148     9433    1           FPT_WRITE.BUF_.BOUND = M$HLP$ -> F$DCB.ARS# - 1;
      149     9434
      150     9435    1           IF OLD_PASSWORD ~= KL$DREC.PASSWORD THEN
      151     9436    2             DO;
      152     9437    2               QQ_CMDBLK.MINOR_ERR = CODE_NOMATCH;
      153     9438    2               GOTO PRINT_ERR;
      154     9439    2             END;
      155     9440
      156     9441    1           KL$DREC.PASSWORD = NEW_PASSWORD;
      157     9442    1           CALL M$WRITE(FPT_WRITE) ALTRET(TRY_AGAIN);
      158     9443    1           QQ_CMDBLK.MINOR_ERR = CODE_PASSMSG;
      159     9444    1           GOTO PRINT_ERR;
      160     9445
      161     9446    1   TRY_AGAIN:
      162     9447    1           QQ_CMDBLK.MINOR_ERR = CODE_TRY_AGAIN;
      163     9448
      164     9449    1   PRINT_ERR:
      165     9450    1           CALL QQC$BLDMSG_BLK(MSGBLK);
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:8    
      166     9451    1           CALL QQC$BLDMSG(MSGBLK);
      167     9452
      168     9453    1   RET:
      169     9454    1           IF ENQ_FLAG THEN
      170     9455    2             DO;
      171     9456    2               CALL M$DEQ(FPT_DEQ) ALTRET(MON_ERR);
      172     9457    2             END;
      173     9458
      174     9459    1           IF M$HLP$ -> F$DCB.FCD# THEN
      175     9460    2             DO;
      176     9461    2               CALL M$CLOSE(FPT_CLOSE) ALTRET(MON_ERR);
      177     9462    2             END;
      178     9463
      179     9464    1           RETURN;
      180     9465
      181     9466    1   MON_ERR:
      182     9467    1           IF ENQ_FLAG THEN
      183     9468    2             DO;
      184     9469    2               ENQ_FLAG = '0'B;
      185     9470    2               CALL M$DEQ(FPT_DEQ) ALTRET(MON_ERR);
      186     9471    2             END;
      187     9472
      188     9473    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      189     9474    1           CALL QQC$SCREECH;
      190     9475
      191     9476    1   END QQB$PASSWORD;

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:9    
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$PASSWORD.

   Procedure QQB$PASSWORD requires 184 words for executable code.
   Procedure QQB$PASSWORD requires 38 words of local(AUTO) storage.

    No errors detected in file QQB$PASSWORD.:E05TSI    .

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:10   

 Object Unit name= QQB$PASSWORD                               File name= QQB$PASSWORD.:E05TOU
 UTS= JUL 30 '97 05:33:43.32 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none    98    142  M$HLP
    2  RoData even  UTS      3      3  QQB$PASSWORD
    3   Data  even  none   137    211  QQB$PASSWORD
    4   Proc  even  none   184    270  QQB$PASSWORD
    5  RoData even  none     1      1  QQB$PASSWORD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQB$PASSWORD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 ASZ$SCRAMBLE
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       0 QQC$SCREECH
         yes           Std       1 QQC$BLDMSG
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:11   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     B$TCB$                                M$HLP                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:12   


        1        1        /*M* QQB$PASSWORD - Perform  PASSWORD  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$PASSWORD:
        9        9                PROC;

      9  4 000000   000000 700200 xent  QQB$PASSWORD TSX0  ! X66_AUTO_0
         4 000001   000046 000000                    ZERO    38,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE KL_SUPER_C;
       17     4179        %INCLUDE XU_MACRO_C;
       18     7285        %INCLUDE QQ_SUBS_C;
       19     7477        %INCLUDE QQ_MACROS_C;
       20     7902        %INCLUDE QQ_DATA_R;
       21     8148        %INCLUDE QQ_PERR_C;
       22     8309        %INCLUDE Q_ERRCODE_C;
       23     8332        %PAGE(ARG="Externally defined routines");

              8349    1   /***************************************************************************
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:13   
              8350    1    *                                                                         *
              8351    1    *                        Externally defined routines                      *
              8352    1    *                                                                         *
              8353    1    ***************************************************************************/

       24     8357    1   DCL QQC$SCREECH ENTRY;
       25     8358    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       26     8359    1   DCL QQC$BLDMSG ENTRY(1);
       27     8360    1   DCL ASZ$SCRAMBLE ENTRY(1);
       28     8361        %PAGE(ARG="Symrefs");

              8378    1   /***************************************************************************
              8379    1    *                                                                         *
              8380    1    *                                  Symrefs                                *
              8381    1    *                                                                         *
              8382    1    ***************************************************************************/

       29     8386    1   DCL B$TCB$ PTR SYMREF;
       30     8387        %PAGE(ARG="DCBs");

              8404    1   /***************************************************************************
              8405    1    *                                                                         *
              8406    1    *                                    DCBs                                 *
              8407    1    *                                                                         *
              8408    1    ***************************************************************************/

       31     8412        %M$DCB(DCBN=M$HLP, NAME=':HLP', ACCT=':SYS', SHARE=ALL);
       32     8486        %PAGE(ARG="Based");

              8503    1   /***************************************************************************
              8504    1    *                                                                         *
              8505    1    *                                   Based                                 *
              8506    1    *                                                                         *
              8507    1    ***************************************************************************/

       33     8511        %B$TCB;
       34     8514        %F$DCB;
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:14   
       35     8571        %B$ALT;
       36     8579        %TP$STATION;
       37     8652        %PARSE$OUT(STCLASS=BASED);
       38     8697        %PARSE$SYM(STCLASS=BASED);
       39     8735        %KL_DREC(NAME=KL$DREC, STCLASS="BASED(KL_DREC$)",LAST=";");
       40     8848        %PAGE(ARG="Auto");

              8865    1   /***************************************************************************
              8866    1    *                                                                         *
              8867    1    *                                    Auto                                 *
              8868    1    *                                                                         *
              8869    1    ***************************************************************************/

       41     8873    1   DCL KL_DREC$ PTR;
       42     8874    1   DCL SUBLK$ PTR;
       43     8875    1   DCL M$HLP$ PTR;
       44     8876
       45     8877    1   DCL OLD_PASSWORD CHAR(8);
       46     8878    1   DCL NEW_PASSWORD CHAR(8);
       47     8879
       48     8880    1   DCL ENQ_FLAG BIT(1) ALIGNED;
       49     8881
       50     8882    1   DCL I UBIN WORD;
       51     8883
       52     8884        %MSGBLK;
       53     8974        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:15   
              8991    1   /***************************************************************************
              8992    1    *                                                                         *
              8993    1    *                                Error codes                              *
              8994    1    *                                                                         *
              8995    1    ***************************************************************************/

       54     8999        %ERRCODE(NAME=CODE_NOMATCH, CODE#=%E$NOMATCHPASS, FCG#=%FCG_QQ, MID#=%MID_B);
       55     9006        %ERRCODE(NAME=CODE_TRY_AGAIN, CODE#=%E$TRY_AGAIN, FCG#=%FCG_QQ, MID#=%MID_B);
       56     9013        %ERRCODE(NAME=CODE_PASSMSG, CODE#=%E$PASSMSG, FCG#=%FCG_QQ, MID#=%MID_B);
       57     9020        /*E*       ERROR: QQB-E$NOMATCHPASS-C
       58     9021
       59     9022                 MESSAGE: Password supplied doesn't match current
       60     9023                          password.
       61     9024             DESCRIPTION: To change your password you must supply a password
       62     9025                          which matches the one on file.
       63     9026        */
       64     9027        /*E*       ERROR: QQB-E$TRY_AGAIN-C
       65     9028
       66     9029                 MESSAGE: Unable to change your password now.  Please try
       67     9030                          again.
       68     9031             DESCRIPTION: If for instance, the :HLP is busy we recommend
       69     9032                          that the password change be tried later.
       70     9033        */
       71     9034        /*E*       ERROR: QQB-E$PASSMSG-C
       72     9035
       73     9036                 MESSAGE: Password change successful
       74     9037             DESCRIPTION: Informational message to user that password change
       75     9038                          was completed.
       76     9039        */
       77     9040        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:16   
              9057    1   /***************************************************************************
              9058    1    *                                                                         *
              9059    1    *                                    FPTs                                 *
              9060    1    *                                                                         *
              9061    1    ***************************************************************************/

       78     9065        %FPT_READ(DCB=M$HLP, KEY=VLP_KEY, KEYS=YES);
       79     9104
       80     9105        %FPT_WRITE(DCB=M$HLP, KEY=VLP_KEY);
       81     9136
       82     9137        %FPT_OPEN(DCB=M$HLP, ASN=FILE, FUN=UPDATE);
       83     9246
       84     9247        %FPT_CLOSE(DCB=M$HLP, DISP=SAVE);
       85     9289
       86     9290        %FPT_ENQ(DCB=M$HLP, SHARE=NONE, RNAME=VLP_KEY);
       87     9308
       88     9309        %FPT_DEQ(DCB=M$HLP, RNAME=VLP_KEY);
       89     9326        %PAGE(ARG="VLPs");

              9343    1   /***************************************************************************
              9344    1    *                                                                         *
              9345    1    *                                    VLPs                                 *
              9346    1    *                                                                         *
              9347    1    ***************************************************************************/

       90     9351    1   DCL 1 VLP_KEY STATIC,
       91     9352    1         2 L# UBIN(9) UNAL,
       92     9353    1         2 STATION CHAR(8),
       93     9354    1         2 UNAME   CHAR(8);
       94     9355
       95     9356    1   DCL POS UBIN WORD;
       96     9357
       97     9358        %PAGE(ARG="QQB$PASSWORD", PAGE=YES);

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:17   
              9375    1   /***************************************************************************
              9376    1    *                                                                         *
              9377    1    *                                QQB$PASSWORD                             *
              9378    1    *                                                                         *
              9379    1    ***************************************************************************/

       98     9383    1           ENQ_FLAG = '0'B;

   9383  4 000002   200013 450100                    STZ     ENQ_FLAG,,AUTO

       99     9384    1           OLD_PASSWORD = ' ';

   9384  4 000003   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000004   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000005   200007 755100                    STA     OLD_PASSWORD,,AUTO
         4 000006   200010 756100                    STQ     OLD_PASSWORD+1,,AUTO

      100     9385    1           NEW_PASSWORD = ' ';

   9385  4 000007   000035 235000 xsym               LDA     B_VECTNIL+29
         4 000010   000035 236000 xsym               LDQ     B_VECTNIL+29
         4 000011   200011 755100                    STA     NEW_PASSWORD,,AUTO
         4 000012   200012 756100                    STQ     NEW_PASSWORD+1,,AUTO

      101     9386    1           KL_DREC$ = QQ_GLOBAL.TRASHBUF$;

   9386  4 000013   000057 236000 xsym               LDQ     QQ_GLOBAL+47
         4 000014   200004 756100                    STQ     KL_DREC$,,AUTO

      102     9387    1           M$HLP$ = DCBADDR(DCBNUM(M$HLP));

   9387  4 000015   000000 236007 xsym               LDQ     M$HLP,DL
         4 000016   000000 470400 5                  LDP0    0
         4 000017   000000 471500                    LDP1    0,,PR0
         4 000020   100000 236106                    LDQ     0,QL,PR1
         4 000021   200006 756100                    STQ     M$HLP$,,AUTO

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:18   
      103     9388
      104     9389    2           DO I = 0 TO QQ_CMDBLK.OUT$ -> OUT$BLK.NSUBLKS - 1;

   9389  4 000022   200014 450100                    STZ     I,,AUTO
         4 000023   000062 710000 4                  TRA     s:9400+3

      105     9390    2             SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(I);

   9390  4 000024   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000025   200014 720100                    LXL0    I,,AUTO
         4 000026   000003 236110                    LDQ     3,X0,PR0
         4 000027   200005 756100                    STQ     SUBLK$,,AUTO

      106     9391    3             DO CASE(SUBLK$ -> OUT$SYM.CODE);

   9391  4 000030   200005 471500                    LDP1    SUBLK$,,AUTO
         4 000031   100000 721100                    LXL1    0,,PR1
         4 000032   000003 101003                    CMPX1   3,DU
         4 000033   000035 602011 4                  TNC     s:9391+5,X1
         4 000034   000057 710000 4                  TRA     s:9400
         4 000035   000057 710000 4                  TRA     s:9400
         4 000036   000040 710000 4                  TRA     s:9394
         4 000037   000050 710000 4                  TRA     s:9397

      107     9392
      108     9393    3               CASE(1 /* OPT_OLD */);

      109     9394    3                 OLD_PASSWORD = SUBLK$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

   9394  4 000040   100003 473500                    LDP3    3,,PR1
         4 000041   300004 236100                    LDQ     4,,PR3
         4 000042   000033 772000                    QRL     27
         4 000043   000000 622006                    EAX2    0,QL
         4 000044   040100 100540                    MLR     fill='040'O
         4 000045   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 000046   200007 000010                    ADSC9   OLD_PASSWORD,,AUTO       cn=0,n=8
         4 000047   000057 710000 4                  TRA     s:9400
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:19   

      110     9395
      111     9396    3               CASE(2 /* OPT_NEW */);

      112     9397    3                 NEW_PASSWORD = SUBLK$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.TEXT;

   9397  4 000050   100003 473500                    LDP3    3,,PR1
         4 000051   300004 236100                    LDQ     4,,PR3
         4 000052   000033 772000                    QRL     27
         4 000053   000000 622006                    EAX2    0,QL
         4 000054   040100 100540                    MLR     fill='040'O
         4 000055   300004 200012                    ADSC9   4,,PR3                   cn=1,n=*X2
         4 000056   200011 000010                    ADSC9   NEW_PASSWORD,,AUTO       cn=0,n=8

      113     9398
      114     9399    3             END /* CASE */;

      115     9400    2           END;

   9400  4 000057   200014 235100                    LDA     I,,AUTO
         4 000060   000001 035007                    ADLA    1,DL
         4 000061   200014 755100                    STA     I,,AUTO
         4 000062   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000063   000001 236100                    LDQ     1,,PR0
         4 000064   000022 772000                    QRL     18
         4 000065   200014 116100                    CMPQ    I,,AUTO
         4 000066   000070 600000 4                  TZE     s:9402
         4 000067   000024 603000 4                  TRC     s:9390

      116     9401
      117     9402    1           CALL ASZ$SCRAMBLE(OLD_PASSWORD);

   9402  4 000070   200007 631500                    EPPR1   OLD_PASSWORD,,AUTO
         4 000071   200044 451500                    STP1    POS+2,,AUTO
         4 000072   200044 630500                    EPPR0   POS+2,,AUTO
         4 000073   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000074   000000 701000 xent               TSX1    ASZ$SCRAMBLE
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:20   
         4 000075   000000 011000                    NOP     0

      118     9403    1           CALL ASZ$SCRAMBLE(NEW_PASSWORD);

   9403  4 000076   200011 630500                    EPPR0   NEW_PASSWORD,,AUTO
         4 000077   200044 450500                    STP0    POS+2,,AUTO
         4 000100   200044 630500                    EPPR0   POS+2,,AUTO
         4 000101   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000102   000000 701000 xent               TSX1    ASZ$SCRAMBLE
         4 000103   000000 011000                    NOP     0

      119     9404
      120     9405    1           VLP_KEY.STATION = QQ_CMDBLK.S$ -> TP$STATION.WHO.ACCT;

   9405  4 000104   000004 470400 xsym               LDP0    QQ_CMDBLK+4
         4 000105   040000 100500                    MLR     fill='040'O
         4 000106   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         4 000107   000204 200010 3                  ADSC9   VLP_KEY                  cn=1,n=8

      121     9406    1           VLP_KEY.UNAME = QQ_CMDBLK.S$ -> TP$STATION.WHO.NAME;

   9406  4 000110   040000 100500                    MLR     fill='040'O
         4 000111   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         4 000112   000206 200010 3                  ADSC9   VLP_KEY+2                cn=1,n=8

      122     9407    1           CALL INDEX(POS, ' ', VLP_KEY.UNAME);

   9407  4 000113   000000 124400                    SCM     mask='000'O
         4 000114   000206 200010 3                  ADSC9   VLP_KEY+2                cn=1,n=8
         4 000115   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000116   200042 000100                    ARG     POS,,AUTO

      123     9408    1           VLP_KEY.L# = POS + SIZEC(VLP_KEY.STATION);

   9408  4 000117   200042 236100                    LDQ     POS,,AUTO
         4 000120   000010 036007                    ADLQ    8,DL
         4 000121   000033 736000                    QLS     27
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:21   
         4 000122   000204 552040 3                  STBQ    VLP_KEY,'40'O

      124     9409
      125     9410    1           CALL M$OPEN(FPT_OPEN) ALTRET(TRY_AGAIN);

   9410  4 000123   000032 630400 3                  EPPR0   FPT_OPEN
         4 000124   450000 713400                    CLIMB   alt,open
         4 000125   410400 401760                    pmme    nvectors=18
         4 000126   000214 702000 4                  TSX2    TRY_AGAIN

      126     9411
      127     9412    1           CALL M$ENQ(FPT_ENQ) ALTRET(MON_ERR);

   9412  4 000127   000162 630400 3                  EPPR0   FPT_ENQ
         4 000130   420002 713400                    CLIMB   alt,+8194
         4 000131   401000 401760                    pmme    nvectors=3
         4 000132   000251 702000 4                  TSX2    MON_ERR

      128     9413    1           ENQ_FLAG = '1'B;

   9413  4 000133   400000 236003                    LDQ     -131072,DU
         4 000134   200013 756100                    STQ     ENQ_FLAG,,AUTO

      129     9414
      130     9415    1           FPT_READ.BUF_.BUF$ = KL_DREC$;

   9415  4 000135   200004 236100                    LDQ     KL_DREC$,,AUTO
         4 000136   000005 756000 3                  STQ     FPT_READ+5

      131     9416    1           FPT_WRITE.BUF_.BUF$ = KL_DREC$;

   9416  4 000137   000023 756000 3                  STQ     FPT_WRITE+5

      132     9417
      133     9418    1   READ_HLP:
      134     9419    1           FPT_READ.BUF_.BOUND = QQ_GLOBAL.TRASHBUF_SIZE - 1;

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:22   
   9419  4 000140   000060 236000 xsym  READ_HLP     LDQ     QQ_GLOBAL+48
         4 000141   000001 136007                    SBLQ    1,DL
         4 000142   000020 736000                    QLS     16
         4 000143   000004 676000 3                  ERQ     FPT_READ+4
         4 000144   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000145   000004 656000 3                  ERSQ    FPT_READ+4

      135     9420    1           CALL M$READ(FPT_READ) ALTRET(READ_ERR);

   9420  4 000146   000000 630400 3                  EPPR0   FPT_READ
         4 000147   440000 713400                    CLIMB   alt,read
         4 000150   401400 401760                    pmme    nvectors=4
         4 000151   000153 702000 4                  TSX2    READ_ERR

      136     9421
      137     9422    2           DO WHILE('0'B);

   9422  4 000152   000163 710000 4                  TRA     s:9433

      138     9423
      139     9424    2   READ_ERR:
      140     9425    2             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE ~= 66 /* E$NOKEY */ THEN

   9425  4 000153   000000 470400 xsym  READ_ERR     LDP0    B$TCB$
         4 000154   000000 471500                    LDP1    0,,PR0
         4 000155   100102 236100                    LDQ     66,,PR1
         4 000156   377770 376007                    ANQ     131064,DL
         4 000157   001020 116007                    CMPQ    528,DL
         4 000160   000162 600000 4                  TZE     s:9430

      141     9426    3               DO;

      142     9427    3                 GOTO MON_ERR;

   9427  4 000161   000251 710000 4                  TRA     MON_ERR

      143     9428    3               END;
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:23   
      144     9429
      145     9430    2             GOTO TRY_AGAIN;

   9430  4 000162   000214 710000 4                  TRA     TRY_AGAIN

      146     9431    2           END /* NEVER */;

      147     9432
      148     9433    1           FPT_WRITE.BUF_.BOUND = M$HLP$ -> F$DCB.ARS# - 1;

   9433  4 000163   200006 470500                    LDP0    M$HLP$,,AUTO
         4 000164   000000 236100                    LDQ     0,,PR0
         4 000165   000001 136007                    SBLQ    1,DL
         4 000166   000020 736000                    QLS     16
         4 000167   000022 676000 3                  ERQ     FPT_WRITE+4
         4 000170   000034 376000 xsym               ANQ     B_VECTNIL+28
         4 000171   000022 656000 3                  ERSQ    FPT_WRITE+4

      149     9434
      150     9435    1           IF OLD_PASSWORD ~= KL$DREC.PASSWORD THEN

   9435  4 000172   200004 471500                    LDP1    KL_DREC$,,AUTO
         4 000173   040100 106500                    CMPC    fill='040'O
         4 000174   200007 000010                    ADSC9   OLD_PASSWORD,,AUTO       cn=0,n=8
         4 000175   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8
         4 000176   000202 600000 4                  TZE     s:9441

      151     9436    2             DO;

      152     9437    2               QQ_CMDBLK.MINOR_ERR = CODE_NOMATCH;

   9437  4 000177   000000 236000 2                  LDQ     CODE_NOMATCH
         4 000200   000001 756000 xsym               STQ     QQ_CMDBLK+1

      153     9438    2               GOTO PRINT_ERR;

   9438  4 000201   000216 710000 4                  TRA     PRINT_ERR
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:24   

      154     9439    2             END;
      155     9440
      156     9441    1           KL$DREC.PASSWORD = NEW_PASSWORD;

   9441  4 000202   040100 100500                    MLR     fill='040'O
         4 000203   200011 000010                    ADSC9   NEW_PASSWORD,,AUTO       cn=0,n=8
         4 000204   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8

      157     9442    1           CALL M$WRITE(FPT_WRITE) ALTRET(TRY_AGAIN);

   9442  4 000205   000016 630400 3                  EPPR0   FPT_WRITE
         4 000206   440001 713400                    CLIMB   alt,write
         4 000207   401400 401760                    pmme    nvectors=4
         4 000210   000214 702000 4                  TSX2    TRY_AGAIN

      158     9443    1           QQ_CMDBLK.MINOR_ERR = CODE_PASSMSG;

   9443  4 000211   000002 236000 2                  LDQ     CODE_PASSMSG
         4 000212   000001 756000 xsym               STQ     QQ_CMDBLK+1

      159     9444    1           GOTO PRINT_ERR;

   9444  4 000213   000216 710000 4                  TRA     PRINT_ERR

      160     9445
      161     9446    1   TRY_AGAIN:
      162     9447    1           QQ_CMDBLK.MINOR_ERR = CODE_TRY_AGAIN;

   9447  4 000214   000001 236000 2     TRY_AGAIN    LDQ     CODE_TRY_AGAIN
         4 000215   000001 756000 xsym               STQ     QQ_CMDBLK+1

      163     9448
      164     9449    1   PRINT_ERR:
      165     9450    1           CALL QQC$BLDMSG_BLK(MSGBLK);

   9450  4 000216   200015 630500       PRINT_ERR    EPPR0   MSGBLK,,AUTO
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:25   
         4 000217   200044 450500                    STP0    POS+2,,AUTO
         4 000220   200044 630500                    EPPR0   POS+2,,AUTO
         4 000221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000222   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000223   000000 011000                    NOP     0

      166     9451    1           CALL QQC$BLDMSG(MSGBLK);

   9451  4 000224   200015 630500                    EPPR0   MSGBLK,,AUTO
         4 000225   200044 450500                    STP0    POS+2,,AUTO
         4 000226   200044 630500                    EPPR0   POS+2,,AUTO
         4 000227   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000230   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000231   000000 011000                    NOP     0

      167     9452
      168     9453    1   RET:
      169     9454    1           IF ENQ_FLAG THEN

   9454  4 000232   200013 234100       RET          SZN     ENQ_FLAG,,AUTO
         4 000233   000240 605000 4                  TPL     s:9459

      170     9455    2             DO;

      171     9456    2               CALL M$DEQ(FPT_DEQ) ALTRET(MON_ERR);

   9456  4 000234   000174 630400 3                  EPPR0   FPT_DEQ
         4 000235   420003 713400                    CLIMB   alt,+8195
         4 000236   401000 401760                    pmme    nvectors=3
         4 000237   000251 702000 4                  TSX2    MON_ERR

      172     9457    2             END;

      173     9458
      174     9459    1           IF M$HLP$ -> F$DCB.FCD# THEN

   9459  4 000240   200006 470500                    LDP0    M$HLP$,,AUTO
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:26   
         4 000241   000031 236100                    LDQ     25,,PR0
         4 000242   020000 316007                    CANQ    8192,DL
         4 000243   000250 600000 4                  TZE     s:9464

      175     9460    2             DO;

      176     9461    2               CALL M$CLOSE(FPT_CLOSE) ALTRET(MON_ERR);

   9461  4 000244   000124 630400 3                  EPPR0   FPT_CLOSE
         4 000245   450001 713400                    CLIMB   alt,close
         4 000246   406000 401760                    pmme    nvectors=13
         4 000247   000251 702000 4                  TSX2    MON_ERR

      177     9462    2             END;

      178     9463
      179     9464    1           RETURN;

   9464  4 000250   000000 702200 xent               TSX2  ! X66_ARET

      180     9465
      181     9466    1   MON_ERR:
      182     9467    1           IF ENQ_FLAG THEN

   9467  4 000251   200013 234100       MON_ERR      SZN     ENQ_FLAG,,AUTO
         4 000252   000260 605000 4                  TPL     s:9473

      183     9468    2             DO;

      184     9469    2               ENQ_FLAG = '0'B;

   9469  4 000253   200013 450100                    STZ     ENQ_FLAG,,AUTO

      185     9470    2               CALL M$DEQ(FPT_DEQ) ALTRET(MON_ERR);

   9470  4 000254   000174 630400 3                  EPPR0   FPT_DEQ
         4 000255   420003 713400                    CLIMB   alt,+8195
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:27   
         4 000256   401000 401760                    pmme    nvectors=3
         4 000257   000251 702000 4                  TSX2    MON_ERR

      186     9471    2             END;

      187     9472
      188     9473    1           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   9473  4 000260   000000 470400 xsym               LDP0    B$TCB$
         4 000261   000000 471500                    LDP1    0,,PR0
         4 000262   100102 236100                    LDQ     66,,PR1
         4 000263   000000 756000 xsym               STQ     QQ_GLOBAL

      189     9474    1           CALL QQC$SCREECH;

   9474  4 000264   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000265   000000 701000 xent               TSX1    QQC$SCREECH
         4 000266   000000 011000                    NOP     0

      190     9475
      191     9476    1   END QQB$PASSWORD;

   9476  4 000267   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:28   
--  Include file information  --

   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$PASSWORD.
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:29   

 **** Variables and constants ****

  ****  Section 002 RoData QQB$PASSWORD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/b STRC        r     1 CODE_NOMATCH               2-0-0/b STRC        r     1 CODE_PASSMSG
     1-0-0/b STRC        r     1 CODE_TRY_AGAIN

  ****  Section 003  Data  QQB$PASSWORD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   124-0-0/d STRC(1080)  r     1 FPT_CLOSE                174-0-0/d STRC(288)   r     1 FPT_DEQ
   162-0-0/d STRC(360)   r     1 FPT_ENQ                   32-0-0/d STRC(2088)  r     1 FPT_OPEN
     0-0-0/d STRC(504)   r     1 FPT_READ                  16-0-0/d STRC(432)   r     1 FPT_WRITE
   204-0-0/c STRC(153)   r     1 VLP_KEY

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    13-0-0/w BIT         r     1 ENQ_FLAG                  14-0-0/w UBIN        r     1 I
     4-0-0/w PTR         r     1 KL_DREC$                   6-0-0/w PTR         r     1 M$HLP$
    15-0-0/w STRC(738)   r     1 MSGBLK                    11-0-0/c CHAR(8)     r     1 NEW_PASSWORD
     7-0-0/c CHAR(8)     r     1 OLD_PASSWORD              42-0-0/w UBIN        r     1 POS
     3-0-0/w PTR         r     1 S$                         5-0-0/w PTR         r     1 SUBLK$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:30   
     0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(576)   r     1 KL$DREC
     0-0-0/d ASTR(3528)  r     1 M$HLP                      0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(909)   r     1 TP$STATION


   Procedure QQB$PASSWORD requires 184 words for executable code.
   Procedure QQB$PASSWORD requires 38 words of local(AUTO) storage.

    No errors detected in file QQB$PASSWORD.:E05TSI    .
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:31   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:32   
          MINI XREF LISTING

ASZ$SCRAMBLE
      8360**DCL-ENT  9402--CALL     9403--CALL
B$ALT.CODE
      8573**DCL      8573--REDEF    8574--REDEF    8574--REDEF
B$ALT.ERR
      8574**DCL      9473>>ASSIGN
B$ALT.ERR.CODE
      8575**DCL      9425>>IF
B$ALT.ERR.ERR#
      8575**DCL      8575--REDEF
B$ALT.EVID
      8574**DCL      8574--REDEF    8574--REDEF
B$TCB.ALT$
      8512**DCL      9425>>IF       9473>>ASSIGN
B$TCB$
      8386**DCL      9425>>IF       9473>>ASSIGN
CODE_NOMATCH
      9000**DCL      9437>>ASSIGN
CODE_PASSMSG
      9014**DCL      9443>>ASSIGN
CODE_TRY_AGAIN
      9007**DCL      9447>>ASSIGN
ENQ_FLAG
      8880**DCL      9383<<ASSIGN   9413<<ASSIGN   9454>>IF       9467>>IF       9469<<ASSIGN
F$DCB.ACTPOS
      8547**DCL      8547--REDEF
F$DCB.ARS#
      8521**DCL      8521--REDEF    9433>>ASSIGN
F$DCB.ATTR
      8540**DCL      8541--REDEF
F$DCB.BORROW
      8555**DCL      8555--REDEF    8555--REDEF    8555--REDEF
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:33   
F$DCB.DCBNAME.L
      8569**DCL      8569--IMP-SIZ
F$DCB.EOMCHAR#
      8525**DCL      8525--REDEF
F$DCB.FCD#
      8534**DCL      9459>>IF
F$DCB.FLDID
      8550**DCL      8550--REDEF
F$DCB.FORM$
      8544**DCL      8544--REDEF
F$DCB.FSECT
      8560**DCL      8560--REDEF
F$DCB.FSN#
      8537**DCL      8537--REDEF    8537--REDEF    8538--REDEF
F$DCB.HEADER$
      8543**DCL      8543--REDEF
F$DCB.IXTNSIZE#
      8541**DCL      8541--REDEF
F$DCB.LASTSTA$
      8530**DCL      8530--REDEF
F$DCB.LVL
      8556**DCL      8556--REDEF
F$DCB.NAME#.C
      8531**DCL      8531--REDEF
F$DCB.NOEOF
      8553**DCL      8553--REDEF
F$DCB.NRECS#
      8542**DCL      8542--REDEF
F$DCB.NRECX
      8561**DCL      8561--REDEF
F$DCB.OHDR
      8553**DCL      8553--REDEF
F$DCB.ORG#
      8536**DCL      8536--REDEF
F$DCB.PRECNO
      8559**DCL      8559--REDEF
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:34   
F$DCB.RCSZ
      8565**DCL      8565--REDEF
F$DCB.RES#
      8532**DCL      8532--REDEF
F$DCB.SETX
      8544**DCL      8544--REDEF
F$DCB.TAB$
      8544**DCL      8544--REDEF
F$DCB.TDA
      8558**DCL      8559--REDEF
F$DCB.WSN#
      8532**DCL      8532--REDEF
FPT_CLOSE
      9270**DCL      9461<>CALL
FPT_CLOSE.SN_
      9270**DCL      9270--REDEF
FPT_CLOSE.UTL_
      9271**DCL      9271--REDEF
FPT_CLOSE.V
      9275**DCL      9270--DCLINIT
FPT_CLOSE.V.EXPIRE#
      9285**DCL      9285--REDEF
FPT_CLOSE.V.TYPE#
      9283**DCL      9283--REDEF
FPT_CLOSE.V.XTNSIZE#
      9280**DCL      9280--REDEF    9282--REDEF
FPT_DEQ
      9320**DCL      9456<>CALL     9470<>CALL
FPT_DEQ.V
      9321**DCL      9320--DCLINIT
FPT_ENQ
      9301**DCL      9412<>CALL
FPT_ENQ.V
      9302**DCL      9301--DCLINIT
FPT_OPEN
      9202**DCL      9410<>CALL
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:35   
FPT_OPEN.ACSVEH_
      9204**DCL      9205--REDEF
FPT_OPEN.ALTKEYS_
      9210**DCL      9211--REDEF    9211--REDEF
FPT_OPEN.HDR_
      9209**DCL      9210--REDEF
FPT_OPEN.TAB_
      9208**DCL      9209--REDEF
FPT_OPEN.UHL_
      9202**DCL      9203--REDEF    9203--REDEF
FPT_OPEN.V
      9211**DCL      9202--DCLINIT
FPT_OPEN.V.FSN#
      9242**DCL      9242--REDEF    9242--REDEF
FPT_OPEN.WSN_
      9208**DCL      9208--REDEF
FPT_READ
      9082**DCL      9420<>CALL
FPT_READ.BUF_.BOUND
      9084**DCL      9419<<ASSIGN
FPT_READ.BUF_.BUF$
      9085**DCL      9415<<ASSIGN
FPT_READ.STATION_
      9085**DCL      9086--REDEF
FPT_READ.V
      9086**DCL      9082--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      9097**DCL      9097--REDEF
FPT_READ.V.INDX#
      9095**DCL      9095--REDEF
FPT_WRITE
      9122**DCL      9442<>CALL
FPT_WRITE.BUF_.BOUND
      9122**DCL      9433<<ASSIGN
FPT_WRITE.BUF_.BUF$
      9124**DCL      9416<<ASSIGN
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:36   
FPT_WRITE.STATION_
      9124**DCL      9124--REDEF
FPT_WRITE.V
      9125**DCL      9122--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      9131**DCL      9131--REDEF
I
      8882**DCL      9389<<DOINDEX  9390>>ASSIGN
KL$DREC.PASSWORD
      8806**DCL      8810--REDEF    9435>>IF       9441<<ASSIGN
KL$DREC.RENAME
      8829**DCL      8830--REDEF
KL_DREC$
      8873**DCL      8748--IMP-PTR  9386<<ASSIGN   9415>>ASSIGN   9416>>ASSIGN   9435>>IF       9441>>ASSIGN
M$CLOSE
        78**DCL-ENT  9461--CALL
M$DEQ
       145**DCL-ENT  9456--CALL     9470--CALL
M$ENQ
       144**DCL-ENT  9412--CALL
M$HLP
      8413**DCL      9387--ASSIGN
M$HLP.ACTPOS
      8454**DCL      8454--REDEF
M$HLP.ARS#
      8413**DCL      8413--REDEF
M$HLP.ATTR#
      8443**DCL      8443--REDEF    8445--REDEF
M$HLP.BORROW
      8465**DCL      8465--REDEF    8465--REDEF    8465--REDEF
M$HLP.DCBNAME.L
      8484**DCL      8484--IMP-SIZ  9387>>ASSIGN
M$HLP.EOMCHAR#
      8420**DCL      8421--REDEF
M$HLP.FLDID
      8457**DCL      8458--REDEF
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:37   
M$HLP.FORM$
      8449**DCL      8449--REDEF
M$HLP.FSECT
      8472**DCL      8472--REDEF
M$HLP.FSN#
      8439**DCL      8439--REDEF    8439--REDEF    8440--REDEF
M$HLP.HEADER$
      8448**DCL      8449--REDEF
M$HLP.IXTNSIZE#
      8445**DCL      8446--REDEF
M$HLP.LASTSTA$
      8429**DCL      8429--REDEF
M$HLP.LVL
      8466**DCL      8466--REDEF
M$HLP.NAME#.C
      8429**DCL      8430--REDEF
M$HLP.NOEOF
      8461**DCL      8461--REDEF
M$HLP.NRECS#
      8446**DCL      8446--REDEF
M$HLP.NRECX
      8473**DCL      8473--REDEF
M$HLP.OHDR
      8462**DCL      8462--REDEF
M$HLP.ORG#
      8437**DCL      8438--REDEF
M$HLP.PRECNO
      8470**DCL      8470--REDEF
M$HLP.RCSZ
      8478**DCL      8478--REDEF
M$HLP.RES#
      8431**DCL      8431--REDEF
M$HLP.SETX
      8450**DCL      8450--REDEF
M$HLP.TAB$
      8449**DCL      8449--REDEF
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:38   
M$HLP.TDA
      8469**DCL      8470--REDEF
M$HLP.WSN#
      8431**DCL      8432--REDEF
M$HLP$
      8875**DCL      9387<<ASSIGN   9433>>ASSIGN   9459>>IF
M$OPEN
        78**DCL-ENT  9410--CALL
M$READ
        79**DCL-ENT  9420--CALL
M$WRITE
        79**DCL-ENT  9442--CALL
MON_ERR
      9467**LABEL    9412--CALLALT  9427--GOTO     9456--CALLALT  9461--CALLALT  9470--CALLALT
MSGBLK
      8885**DCL      9450<>CALL     9451<>CALL
NEW_PASSWORD
      8878**DCL      9385<<ASSIGN   9397<<ASSIGN   9403<>CALL     9441>>ASSIGN
OLD_PASSWORD
      8877**DCL      9384<<ASSIGN   9394<<ASSIGN   9402<>CALL     9435>>IF
OUT$BLK.NSUBLKS
      8670**DCL      9389>>DOINDEX
OUT$BLK.SUBLK$
      8691**DCL      9390>>ASSIGN   9394>>ASSIGN   9394>>ASSIGN   9397>>ASSIGN   9397>>ASSIGN
OUT$SYM.CODE
      8710**DCL      9391>>DOCASE
OUT$SYM.COUNT
      8727**DCL      8730--IMP-SIZ  9394>>ASSIGN   9397>>ASSIGN
OUT$SYM.TEXT
      8730**DCL      9394>>ASSIGN   9397>>ASSIGN
POS
      9356**DCL      9407<<CALLBLT  9408>>ASSIGN
PRINT_ERR
      9450**LABEL    9438--GOTO     9444--GOTO
QQC$BLDMSG
      8359**DCL-ENT  9451--CALL
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:39   
QQC$BLDMSG_BLK
      8358**DCL-ENT  9450--CALL
QQC$SCREECH
      8357**DCL-ENT  9474--CALL
QQ_CMDBLK.MINOR_ERR
      7911**DCL      9437<<ASSIGN   9443<<ASSIGN   9447<<ASSIGN
QQ_CMDBLK.OUT$
      7911**DCL      9389>>DOINDEX  9390>>ASSIGN
QQ_CMDBLK.S$
      7911**DCL      9405>>ASSIGN   9406>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      7922**DCL      7922--REDEF
QQ_GLOBAL.DS2$_BITS
      7922**DCL      7923--REDEF
QQ_GLOBAL.DS3$_BITS
      7923**DCL      7923--REDEF
QQ_GLOBAL.DS4$_BITS
      7923**DCL      7924--REDEF
QQ_GLOBAL.ERR
      7912**DCL      9473<<ASSIGN
QQ_GLOBAL.TRASHBUF$
      7920**DCL      9386>>ASSIGN
QQ_GLOBAL.TRASHBUF_SIZE
      7920**DCL      9419>>ASSIGN
READ_ERR
      9425**LABEL    9420--CALLALT
S$
      8591**DCL      8593--IMP-PTR
SUBLK$
      8874**DCL      9390<<ASSIGN   9391>>DOCASE   9394>>ASSIGN   9394>>ASSIGN   9397>>ASSIGN   9397>>ASSIGN
TP$STATION.WHO.ACCT
      8605**DCL      9405>>ASSIGN
TP$STATION.WHO.NAME
      8607**DCL      9406>>ASSIGN
TRY_AGAIN
      9447**LABEL    9410--CALLALT  9430--GOTO     9442--CALLALT
PL6.E3A0      #001=QQB$PASSWORD File=QQB$PASSWORD.:E05TSI                        WED 07/30/97 05:33 Page:40   
VLP_KEY
      9351**DCL      9082--DCLINIT  9083--DCLINIT  9122--DCLINIT  9301--DCLINIT  9320--DCLINIT
VLP_KEY.L#
      9352**DCL      9408<<ASSIGN
VLP_KEY.STATION
      9353**DCL      9405<<ASSIGN   9408--ASSIGN
VLP_KEY.UNAME
      9354**DCL      9406<<ASSIGN   9407>>CALLBLT
