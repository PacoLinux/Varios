VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:1    
        1        1        /*M* ASL$LIST_ALL_CHARSETS:  routine to handle LIST CHARSET cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_CHARSETS: PROC;
       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_CHARSETS
       13       13             CALL:     CALL ASL$LIST_ALL_CHARSETS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_CHARSETS is a subroutine to handle
       17       17                           the LIST CHARSET command for SUPER.
       18       18                           Charset records are stored in the :FORM.:SYS
       19       19                           file and have keys that look like the following:
       20       20                                 '~xxxxxxxxCHARSET' where the x signifies
       21       21                                 a character from the alphanumeric character
       22       22                                 set plus the special characters ':$*' and
       23       23                                 is of length 8 or less.  If the charset name
       24       24                                 is less than 8 characters, the key is
       25       25                                 correspondingly smaller.
       26       26                           This routine will either read a single charset
       27       27                           record or it will cycle through all of the charset
       28       28                           records looking for matches
       29       29                           to the selection criteria as input in the
       30       30                           LIST/DISPLAY command.  If a match is found
       31       31                           this routine will do either
       32       32                           of two things.  It will call the display routine
       33       33                           if the command was a DISPLAY command, or it will
       34       34                           put the vector framing the charset name into the
       35       35                           formatter vector list.
       36       36
       37       37                  MEMORY REQUIREMENTS:
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:2    
       38       38                           For all of the routines that deal with listing/
       39       39                           displaying charsets:
       40       40
       41       41                            ASL$LIST_ALL_CHARSETS
       42       42                            ASL$DISP_ONE_CHARSET
       43       43
       44       44                            The ~charsetname record will be read into
       45       45                            data segment 1.  The name will be used by the
       46       46                            ASL$LIST_ALL_CHARSETS, while the other info
       47       47                            will be used by the ASL$DISP_ONE_CHARSET
       48       48                            routine.
       49       49        */
       50       50        /********************************************************************/
       51       51        /*   Include files   include files   include files   include files  */
       52       52        /********************************************************************/
       53       53        %INCLUDE AS_PERR_C;
       54      655        %INCLUDE AS_SUPER_C;
       55     1090        %INCLUDE AS_SUBS_C;
       56     2504        %INCLUDE AS_MAC_C;
       57     2584        %INCLUDE AS_ENTRIES_M;
       58     3634        %INCLUDE AS_SSUBS_C;
       59     3726        %INCLUDE B_ERRORS_C;
       60     4853        %INCLUDE FS_SUPER_C;
       61     5616        %INCLUDE KL_SUPER_C;
       62     8518        %INCLUDE XU_MACRO_C;
       63    11624        %INCLUDE XU_FORMAT_C;
       64    11786        %INCLUDE CP_6_SUBS;
       65    12326        %INCLUDE OCI_SUBS_C;
       66    12424        %INCLUDE AS_SUPER_R;
       67    15440        /********************************************************************/
       68    15441        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       69    15442        /********************************************************************/
       70    15443        %ASF$PREC_FORM ;
       71    15446        %ASF$READ_FORM ;
       72    15449        %ASF$READ_FORM_SEQ ;
       73    15452        %ASH$ERROR ;
       74    15455        %ASL$DISP_ONE_CHARSET ;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:3    
       75    15458        %ASB$WILD_MATCH ;
       76    15461    1   DCL X$FORMAT ENTRY(1) ;
       77    15462        /********************************************************************/
       78    15463        /*   Local based     local based     local based     local based    */
       79    15464        /********************************************************************/
       80    15465        %FS$CHARSET ( NAME = FS$CHARSET,
       81    15466                      STCLASS = "BASED( DSEG1$ )");
       82    15497        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       83    15498                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       84    15543        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       85    15581        /********************************************************************/
       86    15582        /*   Auto data       auto data       auto data       auto data      */
       87    15583        /********************************************************************/
       88    15584    1   DCL ALL_CHARSETS      BIT(1);
       89    15585    1   DCL 1 BEGIN_KEY ,
       90    15586    1          2 COUNT        UBIN BYTE,
       91    15587    1          2 TEXT         CHAR(8);
       92    15588    1   DCL CODE2             UBIN;
       93    15589    1   DCL CURRENT_CHARSET   CHAR(8);
       94    15590    1   DCL DISP              BIT(1);
       95    15591    1   DCL DISP_CHARSETS     SBIN;
       96    15592    1   DCL 1 END_KEY ,
       97    15593    1          2 COUNT        UBIN BYTE,
       98    15594    1          2 TEXT         CHAR(8);
       99    15595    1   DCL I                 UBIN;
      100    15596    1   DCL J                 UBIN;
      101    15597    1   DCL JCL               BIT(1);
      102    15598    1   DCL 1 TNAME ,
      103    15599    1          2 COUNT        UBIN BYTE,
      104    15600    1          2 TEXT         CHAR(8);
      105    15601    1   DCL WILD_CARD         BIT(1);
      106    15602        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:4    
      107    15603        /********************************************************************/
      108    15604        /*   Constant data   constant data   constant data   constant data  */
      109    15605        /********************************************************************/
      110    15606    1   DCL CHARSET_STR   CHAR(0) CONSTANT INIT ('charset');
      111    15607    1   DCL CHARSETS_STR  CHAR(0) CONSTANT INIT ('charsets');
      112    15608    1   DCL LIST_STR      CHAR(0) CONSTANT INIT ('listed');
      113    15609    1   DCL DISPLAY_STR   CHAR(0) CONSTANT INIT ('displayed');
      114    15610        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:5    
      115    15611        /********************************************************************/
      116    15612        /*   Procedure       procedure       procedure       procedure      */
      117    15613        /********************************************************************/
      118    15614    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      119    15615    1   JCL = %NO#;
      120    15616    1   WILD_CARD = %NO#;
      121    15617    1   TNAME.TEXT = '?';
      122    15618    1   TNAME.COUNT = 1;
      123    15619    1   DISP_CHARSETS = 0;
      124    15620
      125    15621    2   DO SELECT (CODE);
      126    15622
      127    15623    2      SELECT (%LIST_ALL_VAL);
      128    15624
      129    15625    2      DISP = %NO#;
      130    15626    2      JCL = %NO#;
      131    15627
      132    15628    2      SELECT (%DISPLAY_ALL_VAL);
      133    15629
      134    15630    2      DISP = %YES#;
      135    15631    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
      136    15632    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      137    15633    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      138    15634    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      139    15635
      140    15636    2      SELECT (%LIST_CHARSET_VAL);
      141    15637
      142    15638    2      DISP = %NO#;
      143    15639    2      JCL = %NO#;
      144    15640    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;
      145    15641    3         TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      146    15642    3         TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      147    15643    3         END; /*  Number of sublocks > 1  */
      148    15644
      149    15645    2      SELECT (%DISPLAY_CHARSET_VAL);
      150    15646
      151    15647    2      DISP = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:6    
      152    15648    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      153    15649    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;
      154    15650
      155    15651    4         DO SELECT (CODE2);
      156    15652
      157    15653    4            SELECT (%CHARSET_NAME_WILD_VAL);
      158    15654
      159    15655    4            TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      160    15656    4            TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      161    15657
      162    15658    4            SELECT (%JCL_VAL);
      163    15659
      164    15660    4            JCL = %YES#;
      165    15661
      166    15662    4            END;  /* Do case (CODE2) */
      167    15663
      168    15664    3         END;  /*  Do i  */
      169    15665
      170    15666    2      END;  /*  Do case (code)  */
      171    15667
      172    15668    1   IF TNAME.TEXT = '?' THEN
      173    15669    1      ALL_CHARSETS = %YES#;
      174    15670    2   ELSE DO;
      175    15671    2      ALL_CHARSETS = %NO#;
      176    15672    2      BEGIN_KEY.TEXT = ' ';
      177    15673    3      CALL INDEX (I,'?',TNAME.TEXT) WHENRETURN DO;
      178    15674    3         BEGIN_KEY.TEXT = SUBSTR(TNAME.TEXT,0,I);
      179    15675    3         BEGIN_KEY.COUNT = 8;
      180    15676    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(TNAME.TEXT,0,I),'~');
      181    15677    3         END_KEY.COUNT = I + 1;
      182    15678    3         WILD_CARD = %YES#;
      183    15679    3         END;  /*  Whenreturn from index  */
      184    15680    3      WHENALTRETURN DO;
      185    15681    3         WILD_CARD = %NO#;
      186    15682    3         END;  /* Whenaltreturn  */
      187    15683    2      END;  /*  Else  */
      188    15684
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:7    
      189    15685    1   FDS.NVECS# = 0;
      190    15686    2   IF JCL THEN DO;
      191    15687    2      CALL CONCAT (FMT_BUF, '%1/"', CHARSETS_STR, '%1/');
      192    15688    2      FDS.FMT_.BOUND = LENGTHC (CHARSETS_STR) + 6;
      193    15689    2      END;   /*  Jcl  */
      194    15690    2   ELSE DO;
      195    15691    2      CALL CONCAT (FMT_BUF, '%1/', CHARSETS_STR, '%1/');
      196    15692    2      FDS.FMT_.BOUND = LENGTHC (CHARSETS_STR) + 5;
      197    15693    2      END;  /*  Not jcl  */
      198    15694    1   FDS.TABDFLT# = 10;
      199    15695    1   CALL X$FORMAT (FDS);
      200    15696
      201    15697    2   IF ALL_CHARSETS THEN DO;
      202    15698    2      USERS_KEY = '001176'O;     /* To precord to begin of charsets */
      203    15699    2      END;  /*  ALL_CHARSETS  */
      204    15700    2   ELSE IF WILD_CARD THEN DO;
      205    15701    2         CALL CONCAT (USERS_KEY.TXTC,'~',SUBSTR(BEGIN_KEY.TEXT,0,BEGIN_KEY.COUNT),
             15701                  'CHARSET');
      206    15702    2         USERS_KEY.COUNT = BEGIN_KEY.COUNT + 8;
      207    15703    2         END; /*  WILD_CARD  */
      208    15704    2      ELSE DO;  /*  Single charset  */
      209    15705    2         CALL CONCAT (USERS_KEY.TXTC,'~',SUBSTR(TNAME.TEXT,0,TNAME.COUNT),'CHARSET');
      210    15706    2         USERS_KEY.COUNT = TNAME.COUNT + 8;
      211    15707    2         I = DSEG1SIZE;
      212    15708    2         CALL ASF$READ_FORM (USERS_KEY,DSEG1$,I)
      213    15709    3         WHENRETURN DO;
      214    15710    3            IF DISP THEN
      215    15711    4            DO;
      216    15712    4               CALL ASL$DISP_ONE_CHARSET (JCL);
      217    15713    4               END; /*  If disp  */
      218    15714    4            ELSE DO;
      219    15715    4               CALL CONCAT (FMT_BUF, SUBSTR(TNAME.TEXT,0,TNAME.COUNT), '%1/');
      220    15716    4               FDS.FMT_.BOUND = TNAME.COUNT + 2;
      221    15717    4               CALL X$FORMAT (FDS);
      222    15718    4               END; /*  Else  disp  */
      223    15719    3            END;  /*  Whenreturn  */
      224    15720    3         WHENALTRETURN DO;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:8    
      225    15721    3            IF MERR_CODE.CODE = %E$NOKEY
      226    15722    4            THEN DO;
      227    15723                   /*E*  ERROR:  ASL-E$CHARSETNOEXIST-C
      228    15724                    MESSAGE: Charset %U1 does not exist.
      229    15725                    MESSAGE1: The specified CHARSET does not exist.
      230    15726                   */
      231    15727    4               AS_FIELD1.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;
      232    15728    4               AS_FIELD1.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;
      233    15729                    %SCREAM( ERR#=E$CHARSETNOEXIST, LEVEL=ERROR, MID='L' );
      234    15744    4               END;  /*  Error = nokey  */
      235    15745    4            ELSE DO;
      236    15746    4               CALL ASH$ERROR( MERR_CODE );
      237    15747    4               END;  /* Error ~= nokey */
      238    15748    3            END;  /*  Whenaltreturn  */
      239    15749    2         RETURN;
      240    15750    2         END; /*  Else  */
      241    15751    1   CALL ASF$PREC_FORM(USERS_KEY);
      242    15752    2   DO FOREVER;
      243    15753
      244    15754    3      DO UNTIL ((USERS_KEY.COUNT > 9) AND (USERS_KEY.COUNT < 17));
      245    15755    3         I = DSEG1SIZE;
      246    15756    3         CALL ASF$READ_FORM_SEQ(USERS_KEY,DSEG1$,I)
      247    15757    4         WHENALTRETURN DO;
      248    15758    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      249    15759    4            GOTO FINISH_UP;
      250    15760    4            END;  /*  Whenaltreturn  */
      251    15761    3         END;  /*  Do until we find a charset record  */
      252    15762    3      CALL INDEX (I,'CHARSET',USERS_KEY.TXTC,2) WHENRETURN DO;
      253    15763    3         CURRENT_CHARSET = SUBSTR(USERS_KEY.TXTC,1,I-1);
      254    15764    4         IF WILD_CARD THEN DO;
      255    15765    4            J = TNAME.COUNT;
      256    15766    4            CALL ASB$WILD_MATCH (I-1, CURRENT_CHARSET, J, TNAME.TEXT)
      257    15767    5            WHENALTRETURN DO;
      258    15768    5               IF CURRENT_CHARSET > END_KEY.TEXT THEN
      259    15769    5                  GOTO FINISH_UP;
      260    15770    5               ELSE
      261    15771    5                  GOTO END_FOREVER;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:9    
      262    15772    5               END;  /*  Whenaltreturn  */
      263    15773    4            END; /*  WILD_CARD  */
      264    15774    3         IF DISP THEN
      265    15775    4         DO;
      266    15776    4            CALL ASL$DISP_ONE_CHARSET (JCL);
      267    15777    4            END; /*  If disp  */
      268    15778    4         ELSE DO;
      269    15779    5            IF DISP_CHARSETS = 0 THEN DO;
      270    15780    5               CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_CHARSET,0,I-1));
      271    15781    5               FDS.FMT_.BOUND = I ;
      272    15782    5               END; /*  DISP_CHARSETS = 0  */
      273    15783    5            ELSE DO;
      274    15784    5               CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_CHARSET,0,I-1));
      275    15785    5               FDS.FMT_.BOUND = I + 6;
      276    15786    5               END; /*  Else  */
      277    15787    4            CALL X$FORMAT (FDS);
      278    15788    4            END; /*  Else  disp  */
      279    15789    3         DISP_CHARSETS = DISP_CHARSETS + 1;
      280    15790    3         END; /*  Whenreturn from index  */
      281    15791    2   END_FOREVER:
      282    15792    2      END;  /*  Do forever  */
      283    15793    1   FINISH_UP:
      284    15794    2   IF NOT DISP THEN DO;
      285    15795    2      FMT_BUF = '%\%/';
      286    15796    2      FDS.FMT_.BOUND = 3;
      287    15797    2      FDS.NVECS# = 0;
      288    15798    2      CALL X$FORMAT(FDS);
      289    15799    2      END; /*  If not disp  */
      290    15800    2   IF NOT JCL THEN DO;
      291    15801    2      FMT_VEC(0) = VECTOR (DISP_CHARSETS);
      292    15802    2      IF DISP_CHARSETS = 1 THEN
      293    15803    3      DO;
      294    15804    3         FMT_VEC(1) = VECTOR (CHARSET_STR);
      295    15805    3         END; /*  DISP_CHARSETS = 1  */
      296    15806    3      ELSE DO;
      297    15807    3         FMT_VEC(1) = VECTOR (CHARSETS_STR);
      298    15808    3         END; /*  DISP_CHARSETS ~= 1  */
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:10   
      299    15809    2      IF DISP THEN
      300    15810    3      DO;
      301    15811    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      302    15812    3         END; /*  If disp  */
      303    15813    3      ELSE DO;
      304    15814    3         FMT_VEC(2) = VECTOR (LIST_STR);
      305    15815    3         END; /*  If ~ disp  */
      306    15816    2      FDS.NVECS# = 3;
      307    15817    2      FMT_BUF = '   %5D %A %A.';
      308    15818    2      FDS.FMT_.BOUND = 12;
      309    15819    2      CALL X$FORMAT(FDS);
      310    15820    2      END; /* Not jcl */
      311    15821    1   RETURN;
      312    15822    1   END ASL$LIST_ALL_CHARSETS;
      313    15823        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:11   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_CHARSETS.

   Procedure ASL$LIST_ALL_CHARSETS requires 492 words for executable code.
   Procedure ASL$LIST_ALL_CHARSETS requires 28 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:12   

 Object Unit name= ASL$LIST_ALL_CHARSETS                      File name= ASL$LIST_CHARSETS.:E05TOU
 UTS= JUL 29 '97 10:02:15.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     21     25  ASL$LIST_ALL_CHARSETS
    2   Proc  even  none   492    754  ASL$LIST_ALL_CHARSETS
    3  RoData even  none    20     24  ASL$LIST_ALL_CHARSETS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_CHARSETS

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       3 ASF$READ_FORM
         yes           Std       1 X$FORMAT
         yes           Std       1 ASL$DISP_ONE_CHARSET
         yes           Std       2 ASH$ERROR
 yes     yes           Std       3 ASF$READ_FORM_SEQ
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       1 ASF$PREC_FORM
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:13   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:14   


        1        1        /*M* ASL$LIST_ALL_CHARSETS:  routine to handle LIST CHARSET cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9        ASL$LIST_ALL_CHARSETS: PROC;

      9  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000034 000000                    ZERO    28,0

       10       10        /**********************************************************/
       11       11
       12       12        /*D* NAME:     ASL$LIST_ALL_CHARSETS
       13       13             CALL:     CALL ASL$LIST_ALL_CHARSETS
       14       14             INPUT:    Nothing is passed.
       15       15             OUTPUT:   Nothing is returned.
       16       16             DESCRIPTION:  ASL$LIST_ALL_CHARSETS is a subroutine to handle
       17       17                           the LIST CHARSET command for SUPER.
       18       18                           Charset records are stored in the :FORM.:SYS
       19       19                           file and have keys that look like the following:
       20       20                                 '~xxxxxxxxCHARSET' where the x signifies
       21       21                                 a character from the alphanumeric character
       22       22                                 set plus the special characters ':$*' and
       23       23                                 is of length 8 or less.  If the charset name
       24       24                                 is less than 8 characters, the key is
       25       25                                 correspondingly smaller.
       26       26                           This routine will either read a single charset
       27       27                           record or it will cycle through all of the charset
       28       28                           records looking for matches
       29       29                           to the selection criteria as input in the
       30       30                           LIST/DISPLAY command.  If a match is found
       31       31                           this routine will do either
       32       32                           of two things.  It will call the display routine
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:15   
       33       33                           if the command was a DISPLAY command, or it will
       34       34                           put the vector framing the charset name into the
       35       35                           formatter vector list.
       36       36
       37       37                  MEMORY REQUIREMENTS:
       38       38                           For all of the routines that deal with listing/
       39       39                           displaying charsets:
       40       40
       41       41                            ASL$LIST_ALL_CHARSETS
       42       42                            ASL$DISP_ONE_CHARSET
       43       43
       44       44                            The ~charsetname record will be read into
       45       45                            data segment 1.  The name will be used by the
       46       46                            ASL$LIST_ALL_CHARSETS, while the other info
       47       47                            will be used by the ASL$DISP_ONE_CHARSET
       48       48                            routine.
       49       49        */
       50       50        /********************************************************************/
       51       51        /*   Include files   include files   include files   include files  */
       52       52        /********************************************************************/
       53       53        %INCLUDE AS_PERR_C;
       54      655        %INCLUDE AS_SUPER_C;
       55     1090        %INCLUDE AS_SUBS_C;
       56     2504        %INCLUDE AS_MAC_C;
       57     2584        %INCLUDE AS_ENTRIES_M;
       58     3634        %INCLUDE AS_SSUBS_C;
       59     3726        %INCLUDE B_ERRORS_C;
       60     4853        %INCLUDE FS_SUPER_C;
       61     5616        %INCLUDE KL_SUPER_C;
       62     8518        %INCLUDE XU_MACRO_C;
       63    11624        %INCLUDE XU_FORMAT_C;
       64    11786        %INCLUDE CP_6_SUBS;
       65    12326        %INCLUDE OCI_SUBS_C;
       66    12424        %INCLUDE AS_SUPER_R;
       67    15440        /********************************************************************/
       68    15441        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       69    15442        /********************************************************************/
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:16   
       70    15443        %ASF$PREC_FORM ;
       71    15446        %ASF$READ_FORM ;
       72    15449        %ASF$READ_FORM_SEQ ;
       73    15452        %ASH$ERROR ;
       74    15455        %ASL$DISP_ONE_CHARSET ;
       75    15458        %ASB$WILD_MATCH ;
       76    15461    1   DCL X$FORMAT ENTRY(1) ;
       77    15462        /********************************************************************/
       78    15463        /*   Local based     local based     local based     local based    */
       79    15464        /********************************************************************/
       80    15465        %FS$CHARSET ( NAME = FS$CHARSET,
       81    15466                      STCLASS = "BASED( DSEG1$ )");
       82    15497        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       83    15498                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       84    15543        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       85    15581        /********************************************************************/
       86    15582        /*   Auto data       auto data       auto data       auto data      */
       87    15583        /********************************************************************/
       88    15584    1   DCL ALL_CHARSETS      BIT(1);
       89    15585    1   DCL 1 BEGIN_KEY ,
       90    15586    1          2 COUNT        UBIN BYTE,
       91    15587    1          2 TEXT         CHAR(8);
       92    15588    1   DCL CODE2             UBIN;
       93    15589    1   DCL CURRENT_CHARSET   CHAR(8);
       94    15590    1   DCL DISP              BIT(1);
       95    15591    1   DCL DISP_CHARSETS     SBIN;
       96    15592    1   DCL 1 END_KEY ,
       97    15593    1          2 COUNT        UBIN BYTE,
       98    15594    1          2 TEXT         CHAR(8);
       99    15595    1   DCL I                 UBIN;
      100    15596    1   DCL J                 UBIN;
      101    15597    1   DCL JCL               BIT(1);
      102    15598    1   DCL 1 TNAME ,
      103    15599    1          2 COUNT        UBIN BYTE,
      104    15600    1          2 TEXT         CHAR(8);
      105    15601    1   DCL WILD_CARD         BIT(1);
      106    15602        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:17   
      107    15603        /********************************************************************/
      108    15604        /*   Constant data   constant data   constant data   constant data  */
      109    15605        /********************************************************************/
      110    15606    1   DCL CHARSET_STR   CHAR(0) CONSTANT INIT ('charset');
      111    15607    1   DCL CHARSETS_STR  CHAR(0) CONSTANT INIT ('charsets');
      112    15608    1   DCL LIST_STR      CHAR(0) CONSTANT INIT ('listed');
      113    15609    1   DCL DISPLAY_STR   CHAR(0) CONSTANT INIT ('displayed');
      114    15610        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:18   
      115    15611        /********************************************************************/
      116    15612        /*   Procedure       procedure       procedure       procedure      */
      117    15613        /********************************************************************/
      118    15614    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15614  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      119    15615    1   JCL = %NO#;

  15615  2 000007   200021 450100                    STZ     JCL,,AUTO

      120    15616    1   WILD_CARD = %NO#;

  15616  2 000010   200025 450100                    STZ     WILD_CARD,,AUTO

      121    15617    1   TNAME.TEXT = '?';

  15617  2 000011   000000 235000 3                  LDA     0
         2 000012   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000013   200023 755100                    STA     TNAME+1,,AUTO
         2 000014   200024 756100                    STQ     TNAME+2,,AUTO

      122    15618    1   TNAME.COUNT = 1;

  15618  2 000015   001000 236003                    LDQ     512,DU
         2 000016   200022 756100                    STQ     TNAME,,AUTO

      123    15619    1   DISP_CHARSETS = 0;

  15619  2 000017   200013 450100                    STZ     DISP_CHARSETS,,AUTO

      124    15620
      125    15621    2   DO SELECT (CODE);
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:19   

  15621  2 000020   000000 236000 xsym               LDQ     CODE
         2 000021   000022 116007                    CMPQ    18,DL
         2 000022   000033 602000 2                  TNC     s:15621+11
         2 000023   000036 600000 2                  TZE     s:15625
         2 000024   000144 116007                    CMPQ    100,DL
         2 000025   000030 602000 2                  TNC     s:15621+8
         2 000026   000041 600000 2                  TZE     s:15630
         2 000027   000166 710000 2                  TRA     s:15668
         2 000030   000122 116007                    CMPQ    82,DL
         2 000031   000166 601000 2                  TNZ     s:15668
         2 000032   000115 710000 2                  TRA     s:15647
         2 000033   000021 116007                    CMPQ    17,DL
         2 000034   000166 601000 2                  TNZ     s:15668
         2 000035   000073 710000 2                  TRA     s:15638

      126    15622
      127    15623    2      SELECT (%LIST_ALL_VAL);

      128    15624
      129    15625    2      DISP = %NO#;

  15625  2 000036   200012 450100                    STZ     DISP,,AUTO

      130    15626    2      JCL = %NO#;

  15626  2 000037   200021 450100                    STZ     JCL,,AUTO
         2 000040   000166 710000 2                  TRA     s:15668

      131    15627
      132    15628    2      SELECT (%DISPLAY_ALL_VAL);

      133    15629
      134    15630    2      DISP = %YES#;

  15630  2 000041   400000 236003                    LDQ     -131072,DU
         2 000042   200012 756100                    STQ     DISP,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:20   

      135    15631    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  15631  2 000043   000003 471500                    LDP1    3,,PR0
         2 000044   100001 220100                    LDX0    1,,PR1
         2 000045   000002 100003                    CMPX0   2,DU
         2 000046   000060 601000 2                  TNZ     s:15633

      136    15632    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  15632  2 000047   100004 473500                    LDP3    4,,PR1
         2 000050   400000 221003                    LDX1    -131072,DU
         2 000051   300000 722100                    LXL2    0,,PR3
         2 000052   000001 102003                    CMPX2   1,DU
         2 000053   000055 600000 2                  TZE     s:15632+6
         2 000054   000000 221003                    LDX1    0,DU
         2 000055   000000 636011                    EAQ     0,X1
         2 000056   200021 756100                    STQ     JCL,,AUTO
         2 000057   000166 710000 2                  TRA     s:15668

      137    15633    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  15633  2 000060   000000 100003                    CMPX0   0,DU
         2 000061   000166 600000 2                  TZE     s:15668

      138    15634    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  15634  2 000062   100003 473500                    LDP3    3,,PR1
         2 000063   400000 221003                    LDX1    -131072,DU
         2 000064   300000 722100                    LXL2    0,,PR3
         2 000065   000001 102003                    CMPX2   1,DU
         2 000066   000070 600000 2                  TZE     s:15634+6
         2 000067   000000 221003                    LDX1    0,DU
         2 000070   000000 636011                    EAQ     0,X1
         2 000071   200021 756100                    STQ     JCL,,AUTO
         2 000072   000166 710000 2                  TRA     s:15668

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:21   
      139    15635
      140    15636    2      SELECT (%LIST_CHARSET_VAL);

      141    15637
      142    15638    2      DISP = %NO#;

  15638  2 000073   200012 450100                    STZ     DISP,,AUTO

      143    15639    2      JCL = %NO#;

  15639  2 000074   200021 450100                    STZ     JCL,,AUTO

      144    15640    3      IF P_PCB.OUT$->P$B.NSUBLKS > 1 THEN DO;

  15640  2 000075   000001 220100                    LDX0    1,,PR0
         2 000076   000002 100003                    CMPX0   2,DU
         2 000077   000166 602000 2                  TNC     s:15668

      145    15641    3         TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15641  2 000100   000004 471500                    LDP1    4,,PR0
         2 000101   100004 236100                    LDQ     4,,PR1
         2 000102   000033 772000                    QRL     27
         2 000103   000000 621006                    EAX1    0,QL
         2 000104   040100 100540                    MLR     fill='040'O
         2 000105   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000106   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8

      146    15642    3         TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15642  2 000107   000004 471500                    LDP1    4,,PR0
         2 000110   100004 236100                    LDQ     4,,PR1
         2 000111   000033 772000                    QRL     27
         2 000112   000033 736000                    QLS     27
         2 000113   200022 756100                    STQ     TNAME,,AUTO

      147    15643    3         END; /*  Number of sublocks > 1  */
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:22   

  15643  2 000114   000166 710000 2                  TRA     s:15668

      148    15644
      149    15645    2      SELECT (%DISPLAY_CHARSET_VAL);

      150    15646
      151    15647    2      DISP = %YES#;

  15647  2 000115   400000 236003                    LDQ     -131072,DU
         2 000116   200012 756100                    STQ     DISP,,AUTO

      152    15648    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15648  2 000117   000001 235007                    LDA     1,DL
         2 000120   200017 755100                    STA     I,,AUTO
         2 000121   000161 710000 2                  TRA     s:15664+3

      153    15649    3         CODE2 = P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE;

  15649  2 000122   000003 470400 xsym               LDP0    P_PCB+3
         2 000123   200017 720100                    LXL0    I,,AUTO
         2 000124   000003 471510                    LDP1    3,X0,PR0
         2 000125   100000 236100                    LDQ     0,,PR1
         2 000126   777777 376007                    ANQ     -1,DL
         2 000127   200007 756100                    STQ     CODE2,,AUTO

      154    15650
      155    15651    4         DO SELECT (CODE2);

  15651  2 000130   000362 116007                    CMPQ    242,DL
         2 000131   000134 602000 2                  TNC     s:15651+4
         2 000132   000137 600000 2                  TZE     s:15655
         2 000133   000156 710000 2                  TRA     s:15664
         2 000134   000001 116007                    CMPQ    1,DL
         2 000135   000156 601000 2                  TNZ     s:15664
         2 000136   000154 710000 2                  TRA     s:15660
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:23   

      156    15652
      157    15653    4            SELECT (%CHARSET_NAME_WILD_VAL);

      158    15654
      159    15655    4            TNAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15655  2 000137   000004 473500                    LDP3    4,,PR0
         2 000140   300004 236100                    LDQ     4,,PR3
         2 000141   000033 772000                    QRL     27
         2 000142   000000 621006                    EAX1    0,QL
         2 000143   040100 100540                    MLR     fill='040'O
         2 000144   300004 200011                    ADSC9   4,,PR3                   cn=1,n=*X1
         2 000145   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8

      160    15656    4            TNAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15656  2 000146   000004 471500                    LDP1    4,,PR0
         2 000147   100004 236100                    LDQ     4,,PR1
         2 000150   000033 772000                    QRL     27
         2 000151   000033 736000                    QLS     27
         2 000152   200022 756100                    STQ     TNAME,,AUTO
         2 000153   000156 710000 2                  TRA     s:15664

      161    15657
      162    15658    4            SELECT (%JCL_VAL);

      163    15659
      164    15660    4            JCL = %YES#;

  15660  2 000154   400000 236003                    LDQ     -131072,DU
         2 000155   200021 756100                    STQ     JCL,,AUTO

      165    15661
      166    15662    4            END;  /* Do case (CODE2) */

      167    15663
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:24   
      168    15664    3         END;  /*  Do i  */

  15664  2 000156   200017 235100                    LDA     I,,AUTO
         2 000157   000001 035007                    ADLA    1,DL
         2 000160   200017 755100                    STA     I,,AUTO
         2 000161   000001 236100                    LDQ     1,,PR0
         2 000162   000022 772000                    QRL     18
         2 000163   200017 116100                    CMPQ    I,,AUTO
         2 000164   000166 600000 2                  TZE     s:15668
         2 000165   000122 603000 2                  TRC     s:15649

      169    15665
      170    15666    2      END;  /*  Do case (code)  */

      171    15667
      172    15668    1   IF TNAME.TEXT = '?' THEN

  15668  2 000166   040000 106500                    CMPC    fill='040'O
         2 000167   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         2 000170   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000171   000175 601000 2                  TNZ     s:15671

      173    15669    1      ALL_CHARSETS = %YES#;

  15669  2 000172   400000 236003                    LDQ     -131072,DU
         2 000173   200003 756100                    STQ     ALL_CHARSETS,,AUTO
         2 000174   000237 710000 2                  TRA     s:15685

      174    15670    2   ELSE DO;

      175    15671    2      ALL_CHARSETS = %NO#;

  15671  2 000175   200003 450100                    STZ     ALL_CHARSETS,,AUTO

      176    15672    2      BEGIN_KEY.TEXT = ' ';

  15672  2 000176   000035 235000 xsym               LDA     B_VECTNIL+29
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:25   
         2 000177   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000200   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         2 000201   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      177    15673    3      CALL INDEX (I,'?',TNAME.TEXT) WHENRETURN DO;

  15673  2 000202   000000 124500                    SCM     mask='000'O
         2 000203   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=8
         2 000204   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000205   200017 000100                    ARG     I,,AUTO
         2 000206   000236 606400 2                  TTN     s:15681

      178    15674    3         BEGIN_KEY.TEXT = SUBSTR(TNAME.TEXT,0,I);

  15674  2 000207   200017 720100                    LXL0    I,,AUTO
         2 000210   040100 100540                    MLR     fill='040'O
         2 000211   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000212   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      179    15675    3         BEGIN_KEY.COUNT = 8;

  15675  2 000213   010000 236003                    LDQ     4096,DU
         2 000214   200004 756100                    STQ     BEGIN_KEY,,AUTO

      180    15676    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(TNAME.TEXT,0,I),'~');

  15676  2 000215   040100 100540                    MLR     fill='040'O
         2 000216   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000217   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000220   200017 236100                    LDQ     I,,AUTO
         2 000221   000010 116007                    CMPQ    8,DL
         2 000222   000230 603000 2                  TRC     s:15677
         2 000223   777767 621006                    EAX1    -9,QL
         2 000224   777777 661003                    ERX1    -1,DU
         2 000225   040146 100400                    MLR     fill='040'O
         2 000226   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000227   200015 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:26   

      181    15677    3         END_KEY.COUNT = I + 1;

  15677  2 000230   000001 036007                    ADLQ    1,DL
         2 000231   000033 736000                    QLS     27
         2 000232   200014 756100                    STQ     END_KEY,,AUTO

      182    15678    3         WILD_CARD = %YES#;

  15678  2 000233   400000 236003                    LDQ     -131072,DU
         2 000234   200025 756100                    STQ     WILD_CARD,,AUTO

      183    15679    3         END;  /*  Whenreturn from index  */

  15679  2 000235   000237 710000 2                  TRA     s:15685

      184    15680    3      WHENALTRETURN DO;

      185    15681    3         WILD_CARD = %NO#;

  15681  2 000236   200025 450100                    STZ     WILD_CARD,,AUTO

      186    15682    3         END;  /* Whenaltreturn  */

      187    15683    2      END;  /*  Else  */

      188    15684
      189    15685    1   FDS.NVECS# = 0;

  15685  2 000237   000011 450000 xsym               STZ     FDS+9

      190    15686    2   IF JCL THEN DO;

  15686  2 000240   200021 234100                    SZN     JCL,,AUTO
         2 000241   000257 605000 2                  TPL     s:15691

      191    15687    2      CALL CONCAT (FMT_BUF, '%1/"', CHARSETS_STR, '%1/');
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:27   

  15687  2 000242   000011 236000 1                  LDQ     DISPLAY_STR+3
         2 000243   000000 756000 xsym               STQ     FMT_BUF
         2 000244   000002 237000 1                  LDAQ    CHARSETS_STR
         2 000245   000001 755000 xsym               STA     FMT_BUF+1
         2 000246   000002 756000 xsym               STQ     FMT_BUF+2
         2 000247   040000 100400                    MLR     fill='040'O
         2 000250   000011 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000251   000003 000363 xsym               ADSC9   FMT_BUF+3                cn=0,n=243

      192    15688    2      FDS.FMT_.BOUND = LENGTHC (CHARSETS_STR) + 6;

  15688  2 000252   000000 236000 xsym               LDQ     FDS
         2 000253   177777 376007                    ANQ     65535,DL
         2 000254   000002 276000 3                  ORQ     2
         2 000255   000000 756000 xsym               STQ     FDS

      193    15689    2      END;   /*  Jcl  */

  15689  2 000256   000275 710000 2                  TRA     s:15694

      194    15690    2   ELSE DO;

      195    15691    2      CALL CONCAT (FMT_BUF, '%1/', CHARSETS_STR, '%1/');

  15691  2 000257   000011 236000 1                  LDQ     DISPLAY_STR+3
         2 000260   000003 376000 3                  ANQ     3
         2 000261   000040 276007                    ORQ     32,DL
         2 000262   000000 756000 xsym               STQ     FMT_BUF
         2 000263   040000 100400                    MLR     fill='040'O
         2 000264   000002 000010 1                  ADSC9   CHARSETS_STR             cn=0,n=8
         2 000265   000000 600010 xsym               ADSC9   FMT_BUF                  cn=3,n=8
         2 000266   040000 100400                    MLR     fill='040'O
         2 000267   000011 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000270   000002 600364 xsym               ADSC9   FMT_BUF+2                cn=3,n=244

      196    15692    2      FDS.FMT_.BOUND = LENGTHC (CHARSETS_STR) + 5;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:28   

  15692  2 000271   000000 236000 xsym               LDQ     FDS
         2 000272   177777 376007                    ANQ     65535,DL
         2 000273   000004 276000 3                  ORQ     4
         2 000274   000000 756000 xsym               STQ     FDS

      197    15693    2      END;  /*  Not jcl  */

      198    15694    1   FDS.TABDFLT# = 10;

  15694  2 000275   000012 235007                    LDA     10,DL
         2 000276   000017 755000 xsym               STA     FDS+15

      199    15695    1   CALL X$FORMAT (FDS);

  15695  2 000277   000005 630400 3                  EPPR0   5
         2 000300   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000301   000000 701000 xent               TSX1    X$FORMAT
         2 000302   000000 011000                    NOP     0

      200    15696
      201    15697    2   IF ALL_CHARSETS THEN DO;

  15697  2 000303   200003 234100                    SZN     ALL_CHARSETS,,AUTO
         2 000304   000311 605000 2                  TPL     s:15700

      202    15698    2      USERS_KEY = '001176'O;     /* To precord to begin of charsets */

  15698  2 000305   000000 100400                    MLR     fill='000'O
         2 000306   000006 000002 3                  ADSC9   6                        cn=0,n=2
         2 000307   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      203    15699    2      END;  /*  ALL_CHARSETS  */

  15699  2 000310   000502 710000 2                  TRA     s:15751

      204    15700    2   ELSE IF WILD_CARD THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:29   

  15700  2 000311   200025 234100                    SZN     WILD_CARD,,AUTO
         2 000312   000345 605000 2                  TPL     s:15705

      205    15701    2         CALL CONCAT (USERS_KEY.TXTC,'~',SUBSTR(BEGIN_KEY.TEXT,0,BEGIN_KEY.COUNT),
             15701                  'CHARSET');

  15701  2 000313   200004 236100                    LDQ     BEGIN_KEY,,AUTO
         2 000314   000033 772000                    QRL     27
         2 000315   000000 620006                    EAX0    0,QL
         2 000316   000176 236003                    LDQ     126,DU
         2 000317   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         2 000320   040000 100540                    MLR     fill='040'O
         2 000321   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=*X0
         2 000322   000000 400050 xsym               ADSC9   USERS_KEY                cn=2,n=40
         2 000323   000000 636010                    EAQ     0,X0
         2 000324   000022 772000                    QRL     18
         2 000325   000050 116007                    CMPQ    40,DL
         2 000326   000337 603000 2                  TRC     s:15702
         2 000327   200026 740100                    STX0    WILD_CARD+1,,AUTO
         2 000330   777727 620010                    EAX0    -41,X0
         2 000331   777777 660003                    ERX0    -1,DU
         2 000332   200026 235100                    LDA     WILD_CARD+1,,AUTO
         2 000333   000022 771000                    ARL     18
         2 000334   040045 100400                    MLR     fill='040'O
         2 000335   000012 000007 1                  ADSC9   DISPLAY_STR+4            cn=0,n=7
         2 000336   000000 400010 xsym               ADSC9   USERS_KEY,A              cn=2,n=*X0

      206    15702    2         USERS_KEY.COUNT = BEGIN_KEY.COUNT + 8;

  15702  2 000337   200004 236100                    LDQ     BEGIN_KEY,,AUTO
         2 000340   000033 772000                    QRL     27
         2 000341   000010 036007                    ADLQ    8,DL
         2 000342   000033 736000                    QLS     27
         2 000343   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      207    15703    2         END; /*  WILD_CARD  */
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:30   

  15703  2 000344   000502 710000 2                  TRA     s:15751

      208    15704    2      ELSE DO;  /*  Single charset  */

      209    15705    2         CALL CONCAT (USERS_KEY.TXTC,'~',SUBSTR(TNAME.TEXT,0,TNAME.COUNT),'CHARSET');

  15705  2 000345   200022 236100                    LDQ     TNAME,,AUTO
         2 000346   000033 772000                    QRL     27
         2 000347   000000 620006                    EAX0    0,QL
         2 000350   000176 236003                    LDQ     126,DU
         2 000351   000000 552020 xsym               STBQ    USERS_KEY,'20'O
         2 000352   040000 100540                    MLR     fill='040'O
         2 000353   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000354   000000 400050 xsym               ADSC9   USERS_KEY                cn=2,n=40
         2 000355   000000 636010                    EAQ     0,X0
         2 000356   000022 772000                    QRL     18
         2 000357   000050 116007                    CMPQ    40,DL
         2 000360   000371 603000 2                  TRC     s:15706
         2 000361   200026 740100                    STX0    WILD_CARD+1,,AUTO
         2 000362   777727 620010                    EAX0    -41,X0
         2 000363   777777 660003                    ERX0    -1,DU
         2 000364   200026 235100                    LDA     WILD_CARD+1,,AUTO
         2 000365   000022 771000                    ARL     18
         2 000366   040045 100400                    MLR     fill='040'O
         2 000367   000012 000007 1                  ADSC9   DISPLAY_STR+4            cn=0,n=7
         2 000370   000000 400010 xsym               ADSC9   USERS_KEY,A              cn=2,n=*X0

      210    15706    2         USERS_KEY.COUNT = TNAME.COUNT + 8;

  15706  2 000371   200022 236100                    LDQ     TNAME,,AUTO
         2 000372   000033 772000                    QRL     27
         2 000373   000010 036007                    ADLQ    8,DL
         2 000374   000033 736000                    QLS     27
         2 000375   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      211    15707    2         I = DSEG1SIZE;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:31   

  15707  2 000376   000000 235000 xsym               LDA     DSEG1SIZE
         2 000377   200017 755100                    STA     I,,AUTO

      212    15708    2         CALL ASF$READ_FORM (USERS_KEY,DSEG1$,I)

  15708  2 000400   200017 630500                    EPPR0   I,,AUTO
         2 000401   200030 450500                    STP0    WILD_CARD+3,,AUTO
         2 000402   000010 237000 3                  LDAQ    8
         2 000403   200026 757100                    STAQ    WILD_CARD+1,,AUTO
         2 000404   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000405   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000406   000000 701000 xent               TSX1    ASF$READ_FORM
         2 000407   000452 702000 2                  TSX2    s:15721

      213    15709    3         WHENRETURN DO;

      214    15710    3            IF DISP THEN

  15710  2 000410   200012 234100                    SZN     DISP,,AUTO
         2 000411   000421 605000 2                  TPL     s:15715

      215    15711    4            DO;

      216    15712    4               CALL ASL$DISP_ONE_CHARSET (JCL);

  15712  2 000412   200021 630500                    EPPR0   JCL,,AUTO
         2 000413   200026 450500                    STP0    WILD_CARD+1,,AUTO
         2 000414   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000415   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000416   000000 701000 xent               TSX1    ASL$DISP_ONE_CHARSET
         2 000417   000000 011000                    NOP     0

      217    15713    4               END; /*  If disp  */

  15713  2 000420   000451 710000 2                  TRA     s:15719

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:32   
      218    15714    4            ELSE DO;

      219    15715    4               CALL CONCAT (FMT_BUF, SUBSTR(TNAME.TEXT,0,TNAME.COUNT), '%1/');

  15715  2 000421   200022 236100                    LDQ     TNAME,,AUTO
         2 000422   000033 772000                    QRL     27
         2 000423   000000 620006                    EAX0    0,QL
         2 000424   040000 100540                    MLR     fill='040'O
         2 000425   200023 000010                    ADSC9   TNAME+1,,AUTO            cn=0,n=*X0
         2 000426   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255
         2 000427   000377 116007                    CMPQ    255,DL
         2 000430   000436 603000 2                  TRC     s:15716
         2 000431   777400 620006                    EAX0    -256,QL
         2 000432   777777 660003                    ERX0    -1,DU
         2 000433   040046 100400                    MLR     fill='040'O
         2 000434   000011 000003 1                  ADSC9   DISPLAY_STR+3            cn=0,n=3
         2 000435   000000 000010 xsym               ADSC9   FMT_BUF,Q                cn=0,n=*X0

      220    15716    4               FDS.FMT_.BOUND = TNAME.COUNT + 2;

  15716  2 000436   200022 236100                    LDQ     TNAME,,AUTO
         2 000437   000033 772000                    QRL     27
         2 000440   000002 036007                    ADLQ    2,DL
         2 000441   000020 736000                    QLS     16
         2 000442   000000 676000 xsym               ERQ     FDS
         2 000443   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000444   000000 656000 xsym               ERSQ    FDS

      221    15717    4               CALL X$FORMAT (FDS);

  15717  2 000445   000005 630400 3                  EPPR0   5
         2 000446   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000447   000000 701000 xent               TSX1    X$FORMAT
         2 000450   000000 011000                    NOP     0

      222    15718    4               END; /*  Else  disp  */

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:33   
      223    15719    3            END;  /*  Whenreturn  */

  15719  2 000451   000501 710000 2                  TRA     s:15749

      224    15720    3         WHENALTRETURN DO;

      225    15721    3            IF MERR_CODE.CODE = %E$NOKEY

  15721  2 000452   000000 236000 xsym               LDQ     ERR_CODE
         2 000453   377770 376007                    ANQ     131064,DL
         2 000454   001020 116007                    CMPQ    528,DL
         2 000455   000475 601000 2                  TNZ     s:15746

      226    15722    4            THEN DO;

      227    15723                   /*E*  ERROR:  ASL-E$CHARSETNOEXIST-C
      228    15724                    MESSAGE: Charset %U1 does not exist.
      229    15725                    MESSAGE1: The specified CHARSET does not exist.
      230    15726                   */
      231    15727    4               AS_FIELD1.COUNT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.COUNT;

  15727  2 000456   000003 470400 xsym               LDP0    P_PCB+3
         2 000457   000004 471500                    LDP1    4,,PR0
         2 000460   100004 236100                    LDQ     4,,PR1
         2 000461   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      232    15728    4               AS_FIELD1.TEXT = P_PCB.OUT$->P$B.SUBLK$(1)->P$S.TEXT;

  15728  2 000462   100004 236100                    LDQ     4,,PR1
         2 000463   000033 772000                    QRL     27
         2 000464   000000 620006                    EAX0    0,QL
         2 000465   040000 100540                    MLR     fill='040'O
         2 000466   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         2 000467   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      233    15729                    %SCREAM( ERR#=E$CHARSETNOEXIST, LEVEL=ERROR, MID='L' );

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:34   
  15741  2 000470   000007 630400 3                  EPPR0   7
         2 000471   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000472   000000 701000 xent               TSX1    ASH$ERROR
         2 000473   000000 011000                    NOP     0

      234    15744    4               END;  /*  Error = nokey  */

  15744  2 000474   000501 710000 2                  TRA     s:15749

      235    15745    4            ELSE DO;

      236    15746    4               CALL ASH$ERROR( MERR_CODE );

  15746  2 000475   000012 630400 3                  EPPR0   10
         2 000476   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000477   000000 701000 xent               TSX1    ASH$ERROR
         2 000500   000000 011000                    NOP     0

      237    15747    4               END;  /* Error ~= nokey */

      238    15748    3            END;  /*  Whenaltreturn  */

      239    15749    2         RETURN;

  15749  2 000501   000000 702200 xent               TSX2  ! X66_ARET

      240    15750    2         END; /*  Else  */
      241    15751    1   CALL ASF$PREC_FORM(USERS_KEY);

  15751  2 000502   000010 630400 3                  EPPR0   8
         2 000503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000504   000000 701000 xent               TSX1    ASF$PREC_FORM
         2 000505   000000 011000                    NOP     0

      242    15752    2   DO FOREVER;

      243    15753
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:35   
      244    15754    3      DO UNTIL ((USERS_KEY.COUNT > 9) AND (USERS_KEY.COUNT < 17));

      245    15755    3         I = DSEG1SIZE;

  15755  2 000506   000000 235000 xsym               LDA     DSEG1SIZE
         2 000507   200017 755100                    STA     I,,AUTO

      246    15756    3         CALL ASF$READ_FORM_SEQ(USERS_KEY,DSEG1$,I)

  15756  2 000510   200017 630500                    EPPR0   I,,AUTO
         2 000511   200030 450500                    STP0    WILD_CARD+3,,AUTO
         2 000512   000010 237000 3                  LDAQ    8
         2 000513   200026 757100                    STAQ    WILD_CARD+1,,AUTO
         2 000514   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000515   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000516   000000 701000 xent               TSX1    ASF$READ_FORM_SEQ
         2 000517   000521 702000 2                  TSX2    s:15758
         2 000520   000532 710000 2                  TRA     s:15761

      247    15757    4         WHENALTRETURN DO;

      248    15758    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

  15758  2 000521   000000 236000 xsym               LDQ     ERR_CODE
         2 000522   377770 376007                    ANQ     131064,DL
         2 000523   000060 116007                    CMPQ    48,DL
         2 000524   000531 600000 2                  TZE     s:15759

  15758  2 000525   000012 630400 3                  EPPR0   10
         2 000526   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000527   000000 701000 xent               TSX1    ASH$ERROR
         2 000530   000000 011000                    NOP     0

      249    15759    4            GOTO FINISH_UP;

  15759  2 000531   000665 710000 2                  TRA     FINISH_UP

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:36   
      250    15760    4            END;  /*  Whenaltreturn  */
      251    15761    3         END;  /*  Do until we find a charset record  */

  15761  2 000532   000000 236000 xsym               LDQ     USERS_KEY
         2 000533   777000 376003                    ANQ     -512,DU
         2 000534   012000 116003                    CMPQ    5120,DU
         2 000535   000506 602000 2                  TNC     s:15755
         2 000536   021000 116003                    CMPQ    8704,DU
         2 000537   000506 603000 2                  TRC     s:15755

      252    15762    3      CALL INDEX (I,'CHARSET',USERS_KEY.TXTC,2) WHENRETURN DO;

  15762  2 000540   200017 631500                    EPPR1   I,,AUTO
         2 000541   000012 633400 1                  EPPR3   DISPLAY_STR+4
         2 000542   000007 223003                    LDX3    7,DU
         2 000543   000000 630400 xsym               EPPR0   USERS_KEY
         2 000544   000001 220003                    LDX0    1,DU
         2 000545   000000 500510                    A9BD    0,X0,PR0
         2 000546   000051 220003                    LDX0    41,DU
         2 000547   000002 236007                    LDQ     2,DL
         2 000550   000000 701000 xent               TSX1    X66_INDEX
         2 000551   000664 710000 2                  TRA     END_FOREVER

      253    15763    3         CURRENT_CHARSET = SUBSTR(USERS_KEY.TXTC,1,I-1);

  15763  2 000552   200017 721100                    LXL1    I,,AUTO
         2 000553   777777 622011                    EAX2    -1,X1
         2 000554   040100 100440                    MLR     fill='040'O
         2 000555   000000 400012 xsym               ADSC9   USERS_KEY                cn=2,n=*X2
         2 000556   200010 000010                    ADSC9   CURRENT_CHARSET,,AUTO    cn=0,n=8

      254    15764    4         IF WILD_CARD THEN DO;

  15764  2 000557   200025 234100                    SZN     WILD_CARD,,AUTO
         2 000560   000611 605000 2                  TPL     s:15774

      255    15765    4            J = TNAME.COUNT;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:37   

  15765  2 000561   200022 236100                    LDQ     TNAME,,AUTO
         2 000562   000033 772000                    QRL     27
         2 000563   200020 756100                    STQ     J,,AUTO

      256    15766    4            CALL ASB$WILD_MATCH (I-1, CURRENT_CHARSET, J, TNAME.TEXT)

  15766  2 000564   200017 235100                    LDA     I,,AUTO
         2 000565   000001 135007                    SBLA    1,DL
         2 000566   200026 755100                    STA     WILD_CARD+1,,AUTO
         2 000567   200023 630500                    EPPR0   TNAME+1,,AUTO
         2 000570   200033 450500                    STP0    WILD_CARD+6,,AUTO
         2 000571   200020 631500                    EPPR1   J,,AUTO
         2 000572   200032 451500                    STP1    WILD_CARD+5,,AUTO
         2 000573   200010 633500                    EPPR3   CURRENT_CHARSET,,AUTO
         2 000574   200031 453500                    STP3    WILD_CARD+4,,AUTO
         2 000575   200026 634500                    EPPR4   WILD_CARD+1,,AUTO
         2 000576   200030 454500                    STP4    WILD_CARD+3,,AUTO
         2 000577   200030 630500                    EPPR0   WILD_CARD+3,,AUTO
         2 000600   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000601   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000602   000604 702000 2                  TSX2    s:15768
         2 000603   000611 710000 2                  TRA     s:15774

      257    15767    5            WHENALTRETURN DO;

      258    15768    5               IF CURRENT_CHARSET > END_KEY.TEXT THEN

  15768  2 000604   040100 106500                    CMPC    fill='040'O
         2 000605   200015 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000606   200010 000010                    ADSC9   CURRENT_CHARSET,,AUTO    cn=0,n=8
         2 000607   000665 602000 2                  TNC     FINISH_UP

      259    15769    5                  GOTO FINISH_UP;
      260    15770    5               ELSE
      261    15771    5                  GOTO END_FOREVER;

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:38   
  15771  2 000610   000664 710000 2                  TRA     END_FOREVER

      262    15772    5               END;  /*  Whenaltreturn  */
      263    15773    4            END; /*  WILD_CARD  */

      264    15774    3         IF DISP THEN

  15774  2 000611   200012 234100                    SZN     DISP,,AUTO
         2 000612   000622 605000 2                  TPL     s:15779

      265    15775    4         DO;

      266    15776    4            CALL ASL$DISP_ONE_CHARSET (JCL);

  15776  2 000613   200021 630500                    EPPR0   JCL,,AUTO
         2 000614   200026 450500                    STP0    WILD_CARD+1,,AUTO
         2 000615   200026 630500                    EPPR0   WILD_CARD+1,,AUTO
         2 000616   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000617   000000 701000 xent               TSX1    ASL$DISP_ONE_CHARSET
         2 000620   000000 011000                    NOP     0

      267    15777    4            END; /*  If disp  */

  15777  2 000621   000663 710000 2                  TRA     s:15789

      268    15778    4         ELSE DO;

      269    15779    5            IF DISP_CHARSETS = 0 THEN DO;

  15779  2 000622   200013 235100                    LDA     DISP_CHARSETS,,AUTO
         2 000623   000641 601000 2                  TNZ     s:15784

      270    15780    5               CALL CONCAT (FMT_BUF, '%\', SUBSTR(CURRENT_CHARSET,0,I-1));

  15780  2 000624   000015 220000 1                  LDX0    DISPLAY_STR+7
         2 000625   000000 740000 xsym               STX0    FMT_BUF
         2 000626   200017 721100                    LXL1    I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:39   
         2 000627   777777 622011                    EAX2    -1,X1
         2 000630   040000 100540                    MLR     fill='040'O
         2 000631   200010 000012                    ADSC9   CURRENT_CHARSET,,AUTO    cn=0,n=*X2
         2 000632   000000 400375 xsym               ADSC9   FMT_BUF                  cn=2,n=253

      271    15781    5               FDS.FMT_.BOUND = I ;

  15781  2 000633   200017 236100                    LDQ     I,,AUTO
         2 000634   000020 736000                    QLS     16
         2 000635   000000 676000 xsym               ERQ     FDS
         2 000636   000034 376000 xsym               ANQ     B_VECTNIL+28
         2 000637   000000 656000 xsym               ERSQ    FDS

      272    15782    5               END; /*  DISP_CHARSETS = 0  */

  15782  2 000640   000657 710000 2                  TRA     s:15787

      273    15783    5            ELSE DO;

      274    15784    5               CALL CONCAT (FMT_BUF, '%\%-%10R', SUBSTR(CURRENT_CHARSET,0,I-1));

  15784  2 000641   000016 237000 1                  LDAQ    DISPLAY_STR+8
         2 000642   000000 755000 xsym               STA     FMT_BUF
         2 000643   000001 756000 xsym               STQ     FMT_BUF+1
         2 000644   200017 720100                    LXL0    I,,AUTO
         2 000645   777777 621010                    EAX1    -1,X0
         2 000646   040000 100540                    MLR     fill='040'O
         2 000647   200010 000011                    ADSC9   CURRENT_CHARSET,,AUTO    cn=0,n=*X1
         2 000650   000002 000367 xsym               ADSC9   FMT_BUF+2                cn=0,n=247

      275    15785    5               FDS.FMT_.BOUND = I + 6;

  15785  2 000651   200017 236100                    LDQ     I,,AUTO
         2 000652   000006 036007                    ADLQ    6,DL
         2 000653   000020 736000                    QLS     16
         2 000654   000000 676000 xsym               ERQ     FDS
         2 000655   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:40   
         2 000656   000000 656000 xsym               ERSQ    FDS

      276    15786    5               END; /*  Else  */

      277    15787    4            CALL X$FORMAT (FDS);

  15787  2 000657   000005 630400 3                  EPPR0   5
         2 000660   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000661   000000 701000 xent               TSX1    X$FORMAT
         2 000662   000000 011000                    NOP     0

      278    15788    4            END; /*  Else  disp  */

      279    15789    3         DISP_CHARSETS = DISP_CHARSETS + 1;

  15789  2 000663   200013 054100                    AOS     DISP_CHARSETS,,AUTO

      280    15790    3         END; /*  Whenreturn from index  */

      281    15791    2   END_FOREVER:
      282    15792    2      END;  /*  Do forever  */

  15792  2 000664   000506 710000 2     END_FOREVER  TRA     s:15755

      283    15793    1   FINISH_UP:
      284    15794    2   IF NOT DISP THEN DO;

  15794  2 000665   200012 234100       FINISH_UP    SZN     DISP,,AUTO
         2 000666   000703 604000 2                  TMI     s:15800

      285    15795    2      FMT_BUF = '%\%/';

  15795  2 000667   040000 100400                    MLR     fill='040'O
         2 000670   000020 000004 1                  ADSC9   DISPLAY_STR+10           cn=0,n=4
         2 000671   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      286    15796    2      FDS.FMT_.BOUND = 3;
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:41   

  15796  2 000672   000000 236000 xsym               LDQ     FDS
         2 000673   177777 376007                    ANQ     65535,DL
         2 000674   600000 276007                    ORQ     -65536,DL
         2 000675   000000 756000 xsym               STQ     FDS

      287    15797    2      FDS.NVECS# = 0;

  15797  2 000676   000011 450000 xsym               STZ     FDS+9

      288    15798    2      CALL X$FORMAT(FDS);

  15798  2 000677   000005 630400 3                  EPPR0   5
         2 000700   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000701   000000 701000 xent               TSX1    X$FORMAT
         2 000702   000000 011000                    NOP     0

      289    15799    2      END; /*  If not disp  */

      290    15800    2   IF NOT JCL THEN DO;

  15800  2 000703   200021 234100                    SZN     JCL,,AUTO
         2 000704   000753 604000 2                  TMI     s:15821

      291    15801    2      FMT_VEC(0) = VECTOR (DISP_CHARSETS);

  15801  2 000705   777640 235007                    LDA     -96,DL
         2 000706   200026 452500                    STP2    WILD_CARD+1,,AUTO
         2 000707   200026 236100                    LDQ     WILD_CARD+1,,AUTO
         2 000710   000013 036003                    ADLQ    11,DU
         2 000711   000000 755000 xsym               STA     FMT_VEC
         2 000712   000001 756000 xsym               STQ     FMT_VEC+1

      292    15802    2      IF DISP_CHARSETS = 1 THEN

  15802  2 000713   200013 235100                    LDA     DISP_CHARSETS,,AUTO
         2 000714   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:42   
         2 000715   000722 601000 2                  TNZ     s:15807

      293    15803    3      DO;

      294    15804    3         FMT_VEC(1) = VECTOR (CHARSET_STR);

  15804  2 000716   000014 237000 3                  LDAQ    12
         2 000717   000002 755000 xsym               STA     FMT_VEC+2
         2 000720   000003 756000 xsym               STQ     FMT_VEC+3

      295    15805    3         END; /*  DISP_CHARSETS = 1  */

  15805  2 000721   000725 710000 2                  TRA     s:15809

      296    15806    3      ELSE DO;

      297    15807    3         FMT_VEC(1) = VECTOR (CHARSETS_STR);

  15807  2 000722   000016 237000 3                  LDAQ    14
         2 000723   000002 755000 xsym               STA     FMT_VEC+2
         2 000724   000003 756000 xsym               STQ     FMT_VEC+3

      298    15808    3         END; /*  DISP_CHARSETS ~= 1  */

      299    15809    2      IF DISP THEN

  15809  2 000725   200012 234100                    SZN     DISP,,AUTO
         2 000726   000733 605000 2                  TPL     s:15814

      300    15810    3      DO;

      301    15811    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15811  2 000727   000020 237000 3                  LDAQ    16
         2 000730   000004 755000 xsym               STA     FMT_VEC+4
         2 000731   000005 756000 xsym               STQ     FMT_VEC+5

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:43   
      302    15812    3         END; /*  If disp  */

  15812  2 000732   000736 710000 2                  TRA     s:15816

      303    15813    3      ELSE DO;

      304    15814    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15814  2 000733   000022 237000 3                  LDAQ    18
         2 000734   000004 755000 xsym               STA     FMT_VEC+4
         2 000735   000005 756000 xsym               STQ     FMT_VEC+5

      305    15815    3         END; /*  If ~ disp  */

      306    15816    2      FDS.NVECS# = 3;

  15816  2 000736   000003 235007                    LDA     3,DL
         2 000737   000011 755000 xsym               STA     FDS+9

      307    15817    2      FMT_BUF = '   %5D %A %A.';

  15817  2 000740   040000 100400                    MLR     fill='040'O
         2 000741   000021 000015 1                  ADSC9   DISPLAY_STR+11           cn=0,n=13
         2 000742   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      308    15818    2      FDS.FMT_.BOUND = 12;

  15818  2 000743   000000 236000 xsym               LDQ     FDS
         2 000744   177777 376007                    ANQ     65535,DL
         2 000745   000003 276003                    ORQ     3,DU
         2 000746   000000 756000 xsym               STQ     FDS

      309    15819    2      CALL X$FORMAT(FDS);

  15819  2 000747   000005 630400 3                  EPPR0   5
         2 000750   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000751   000000 701000 xent               TSX1    X$FORMAT
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:44   
         2 000752   000000 011000                    NOP     0

      310    15820    2      END; /* Not jcl */

      311    15821    1   RETURN;

  15821  2 000753   000000 702200 xent               TSX2  ! X66_ARET
      312    15822    1   END ASL$LIST_ALL_CHARSETS;
      313    15823        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:45   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_CHARSETS.
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:46   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_CHARSETS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/c CHAR(8)     r     1 CHARSETS_STR               0-0-0/c CHAR(7)     r     1 CHARSET_STR
     6-0-0/c CHAR(9)     r     1 DISPLAY_STR                4-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_CHARSETS               4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/w UBIN        r     1 CODE2                     10-0-0/c CHAR(8)     r     1 CURRENT_CHARSET
    12-0-0/b BIT         r     1 DISP                      13-0-0/w SBIN        r     1 DISP_CHARSETS
    14-0-0/w STRC(108)   r     1 END_KEY                   17-0-0/w UBIN        r     1 I
    20-0-0/w UBIN        r     1 J                         21-0-0/b BIT         r     1 JCL
    22-0-0/w STRC(108)   r     1 TNAME                     25-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:47   
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_CHARSETS requires 492 words for executable code.
   Procedure ASL$LIST_ALL_CHARSETS requires 28 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:48   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:49   
          MINI XREF LISTING

ALL_CHARSETS
     15584**DCL     15669<<ASSIGN  15671<<ASSIGN  15697>>IF
ASA_BRKS_LOC
     12588**DCL     12588--REDEF
ASB$WILD_MATCH
     15459**DCL-ENT 15766--CALL
ASF$PREC_FORM
     15444**DCL-ENT 15751--CALL
ASF$READ_FORM
     15447**DCL-ENT 15708--CALL
ASF$READ_FORM_SEQ
     15450**DCL-ENT 15756--CALL
ASH$ERROR
     15453**DCL-ENT 15741--CALL    15746--CALL    15758--CALL
ASL$DISP_ONE_CHARSET
     15456**DCL-ENT 15712--CALL    15776--CALL
AS_DEFAULT.BANNER_PERM
     13281**DCL     13282--REDEF
AS_DEFAULT.BUDGET.MACCT
     13186**DCL     13190--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     13199**DCL     13202--REDEF
AS_DEFAULT.BUDGET.PACCUM
     13182**DCL     13184--REDEF
AS_DEFAULT.BUDGET.PMAXC
     13177**DCL     13179--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     13297**DCL     13298--REDEF   13299--REDEF
AS_DEFAULT_DREC.PASSWORD
     14551**DCL     14555--REDEF
AS_DEFAULT_DREC.RENAME
     14574**DCL     14575--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:50   
AS_DFLT.BANNER_PERM
     13103**DCL     13104--REDEF
AS_DFLT.BUDGET.MACCT
     13008**DCL     13012--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     13021**DCL     13024--REDEF
AS_DFLT.BUDGET.PACCUM
     13004**DCL     13006--REDEF
AS_DFLT.BUDGET.PMAXC
     12999**DCL     13001--REDEF
AS_DFLT.SETUP_CHRA.TXT
     13119**DCL     13120--REDEF   13121--REDEF
AS_FE_MODE
     12454**DCL     12455--REDEF
AS_FIELD1.COUNT
     12585**DCL     15727<<ASSIGN
AS_FIELD1.TEXT
     12585**DCL     15728<<ASSIGN
AS_MODE
     12451**DCL     12453--REDEF
AS_MOD_USER.ACCESS
     15316**DCL     15317--REDEF
AS_MOD_USER.BANNER
     15303**DCL     15304--REDEF
AS_MOD_USER.BANNER_PERM
     15305**DCL     15306--REDEF
AS_MOD_USER.BILL
     15311**DCL     15312--REDEF
AS_MOD_USER.CPROC
     15307**DCL     15308--REDEF
AS_MOD_USER.FEBILL
     15387**DCL     15388--REDEF
AS_MOD_USER.FECXTMEM
     15404**DCL     15405--REDEF
AS_MOD_USER.FEMINTS
     15389**DCL     15390--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:51   
AS_MOD_USER.FEMMEM
     15400**DCL     15401--REDEF
AS_MOD_USER.FEMTIME
     15398**DCL     15399--REDEF
AS_MOD_USER.FEPPRIV
     15395**DCL     15397--REDEF
AS_MOD_USER.FEPRIV
     15392**DCL     15394--REDEF
AS_MOD_USER.FORCE_BIT
     15301**DCL     15302--REDEF
AS_MOD_USER.KEY
     15383**DCL     15385--REDEF
AS_MOD_USER.LASTCPROC
     15309**DCL     15310--REDEF
AS_MOD_USER.LIMITS.DO_
     15357**DCL     15358--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     15373**DCL     15374--REDEF
AS_MOD_USER.LIMITS.LO
     15353**DCL     15354--REDEF
AS_MOD_USER.LIMITS.MEM
     15349**DCL     15350--REDEF
AS_MOD_USER.LIMITS.MPRIO
     15377**DCL     15378--REDEF
AS_MOD_USER.LIMITS.PDIS
     15365**DCL     15366--REDEF
AS_MOD_USER.LIMITS.PO
     15361**DCL     15362--REDEF
AS_MOD_USER.LIMITS.TDIS
     15369**DCL     15370--REDEF
AS_MOD_USER.LIMITS.TIME
     15345**DCL     15346--REDEF
AS_MOD_USER.MAXENQ
     15326**DCL     15327--REDEF
AS_MOD_USER.PERM_BIT
     15299**DCL     15300--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:52   
AS_MOD_USER.PPRIV
     15321**DCL     15323--REDEF
AS_MOD_USER.PRIOB
     15328**DCL     15329--REDEF
AS_MOD_USER.PRIV
     15318**DCL     15320--REDEF
AS_MOD_USER.QUAN
     15324**DCL     15325--REDEF
AS_MOD_USER.SETUP
     15297**DCL     15298--REDEF
AS_PROJECT.BANNER_PERM
     13637**DCL     13638--REDEF
AS_PROJECT.BUDGET.MACCT
     13542**DCL     13546--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     13555**DCL     13558--REDEF
AS_PROJECT.BUDGET.PACCUM
     13538**DCL     13540--REDEF
AS_PROJECT.BUDGET.PMAXC
     13533**DCL     13535--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     13653**DCL     13654--REDEF   13655--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13815**DCL     13816--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     13720**DCL     13724--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     13733**DCL     13736--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     13716**DCL     13718--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     13711**DCL     13713--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13831**DCL     13832--REDEF   13833--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     15037**DCL     15041--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:53   
AS_PROJECT_DFLT_DREC.RENAME
     15060**DCL     15061--REDEF
AS_PROJECT_DREC.PASSWORD
     14875**DCL     14879--REDEF
AS_PROJECT_DREC.RENAME
     14898**DCL     14899--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     13459**DCL     13460--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     13364**DCL     13368--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     13377**DCL     13380--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     13360**DCL     13362--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     13355**DCL     13357--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     13475**DCL     13476--REDEF   13477--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     14713**DCL     14717--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     14736**DCL     14737--REDEF
AS_USERS.BANNER_PERM
     12925**DCL     12926--REDEF
AS_USERS.BUDGET.MACCT
     12830**DCL     12834--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12843**DCL     12846--REDEF
AS_USERS.BUDGET.PACCUM
     12826**DCL     12828--REDEF
AS_USERS.BUDGET.PMAXC
     12821**DCL     12823--REDEF
AS_USERS.SETUP_CHRA.TXT
     12941**DCL     12942--REDEF   12943--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13993**DCL     13994--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:54   
AS_USERS_CONSTANT.BUDGET.MACCT
     13898**DCL     13902--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13911**DCL     13914--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13894**DCL     13896--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13889**DCL     13891--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     14009**DCL     14010--REDEF   14011--REDEF
BEGIN_KEY.COUNT
     15586**DCL     15675<<ASSIGN  15701>>CALLBLT 15702>>ASSIGN
BEGIN_KEY.TEXT
     15587**DCL     15672<<ASSIGN  15674<<ASSIGN  15701>>CALLBLT
CHARSETS_STR
     15607**DCL     15687>>CALLBLT 15688--ASSIGN  15691>>CALLBLT 15692--ASSIGN  15807--ASSIGN
CHARSET_STR
     15606**DCL     15804--ASSIGN
CODE
     12581**DCL     15614<<ASSIGN  15621>>DOSELCT
CODE2
     15588**DCL     15649<<ASSIGN  15651>>DOSELCT
CURRENT_CHARSET
     15589**DCL     15763<<ASSIGN  15766<>CALL    15768>>IF      15780>>CALLBLT 15784>>CALLBLT
DISP
     15590**DCL     15625<<ASSIGN  15630<<ASSIGN  15638<<ASSIGN  15647<<ASSIGN  15710>>IF      15774>>IF
     15794>>IF      15809>>IF
DISPLAY_STR
     15609**DCL     15811--ASSIGN
DISP_CHARSETS
     15591**DCL     15619<<ASSIGN  15779>>IF      15789<<ASSIGN  15789>>ASSIGN  15801--ASSIGN  15802>>IF
DSEG1$
     12589**DCL     15475--IMP-PTR 15708<>CALL    15756<>CALL
DSEG1SIZE
     12590**DCL     15707>>ASSIGN  15755>>ASSIGN
END_FOREVER
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:55   
     15792**LABEL   15771--GOTO
END_KEY.COUNT
     15593**DCL     15677<<ASSIGN
END_KEY.TEXT
     15594**DCL     15676<<CALLBLT 15768>>IF
ERR_CODE
     12583**DCL     12584--REDEF
FDS
     12480**DCL     15695<>CALL    15717<>CALL    15787<>CALL    15798<>CALL    15819<>CALL
FDS.FMT_.BOUND
     12485**DCL     15688<<ASSIGN  15692<<ASSIGN  15716<<ASSIGN  15781<<ASSIGN  15785<<ASSIGN  15796<<ASSIGN
     15818<<ASSIGN
FDS.NVECS#
     12508**DCL     15685<<ASSIGN  15797<<ASSIGN  15816<<ASSIGN
FDS.TABDFLT#
     12546**DCL     15694<<ASSIGN
FINISH_UP
     15794**LABEL   15759--GOTO    15769--GOTO
FMT_BUF
     12579**DCL     15687<<CALLBLT 15691<<CALLBLT 15715<<CALLBLT 15780<<CALLBLT 15784<<CALLBLT 15795<<ASSIGN
     15817<<ASSIGN
FMT_VEC
     12579**DCL     15801<<ASSIGN  15804<<ASSIGN  15807<<ASSIGN  15811<<ASSIGN  15814<<ASSIGN
FS$CHARSET.SETS
     15476**DCL     15486--REDEF
I
     15595**DCL     15648<<DOINDEX 15649>>ASSIGN  15673<<CALLBLT 15674>>ASSIGN  15676>>CALLBLT 15677>>ASSIGN
     15707<<ASSIGN  15708<>CALL    15755<<ASSIGN  15756<>CALL    15762<<CALLBLT 15763>>ASSIGN  15766>>CALL
     15780>>CALLBLT 15781>>ASSIGN  15784>>CALLBLT 15785>>ASSIGN
J
     15596**DCL     15765<<ASSIGN  15766<>CALL
JCL
     15597**DCL     15615<<ASSIGN  15626<<ASSIGN  15632<<ASSIGN  15634<<ASSIGN  15639<<ASSIGN  15660<<ASSIGN
     15686>>IF      15712<>CALL    15776<>CALL    15800>>IF
KL_DEFAULT.PASSWORD
     15199**DCL     15203--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:56   
KL_DEFAULT.RENAME
     15222**DCL     15223--REDEF
KL_DFLT.PASSWORD
     14389**DCL     14393--REDEF
KL_DFLT.RENAME
     14412**DCL     14413--REDEF
KL_DREC.PASSWORD
     14227**DCL     14231--REDEF
KL_DREC.RENAME
     14250**DCL     14251--REDEF
KL_DREC_CNT.PASSWORD
     14114**DCL     14118--REDEF
KL_DREC_CNT.RENAME
     14137**DCL     14138--REDEF
LIST_STR
     15608**DCL     15814--ASSIGN
MERR_CODE
     12584**DCL     15746<>CALL    15758<>CALL
MERR_CODE.CODE
     12584**DCL     15721>>IF      15758>>IF
NODE$
     12581**DCL     15504--IMP-PTR
P$B.CODE
     15512**DCL     15614>>ASSIGN  15632>>ASSIGN  15634>>ASSIGN  15649>>ASSIGN
P$B.NSUBLKS
     15516**DCL     15631>>IF      15633>>IF      15640>>IF      15648>>DOINDEX
P$B.SUBLK$
     15537**DCL     15614>>ASSIGN  15631>>IF      15632>>ASSIGN  15632>>ASSIGN  15633>>IF      15634>>ASSIGN
     15634>>ASSIGN  15641>>ASSIGN  15641>>ASSIGN  15642>>ASSIGN  15649>>ASSIGN  15655>>ASSIGN  15655>>ASSIGN
     15656>>ASSIGN  15727>>ASSIGN  15728>>ASSIGN  15728>>ASSIGN
P$S.COUNT
     15573**DCL     15576--IMP-SIZ 15641>>ASSIGN  15642>>ASSIGN  15655>>ASSIGN  15656>>ASSIGN  15727>>ASSIGN
     15728>>ASSIGN
P$S.TEXT
     15576**DCL     15641>>ASSIGN  15655>>ASSIGN  15728>>ASSIGN
PROJ_KEY.TEXT
PL6.E3A0      #001=ASL$LIST_ALL_CHARSETS File=ASL$LIST_CHARSETS.:E05TSI          TUE 07/29/97 10:02 Page:57   
     12461**DCL     12461--REDEF
PROJ_KEY.TXT.PROJECT
     12461**DCL     12461--REDEF
P_PCB.OUT$
     12629**DCL     15614>>ASSIGN  15631>>IF      15632>>ASSIGN  15633>>IF      15634>>ASSIGN  15640>>IF
     15641>>ASSIGN  15641>>ASSIGN  15642>>ASSIGN  15648>>DOINDEX 15649>>ASSIGN  15655>>ASSIGN  15655>>ASSIGN
     15656>>ASSIGN  15727>>ASSIGN  15728>>ASSIGN  15728>>ASSIGN
REMEM_VAR
     12587**DCL     12587--REDEF
REM_FCMD
     12587**DCL     12588--REDEF
TNAME.COUNT
     15599**DCL     15618<<ASSIGN  15642<<ASSIGN  15656<<ASSIGN  15705>>CALLBLT 15706>>ASSIGN  15715>>CALLBLT
     15716>>ASSIGN  15765>>ASSIGN
TNAME.TEXT
     15600**DCL     15617<<ASSIGN  15641<<ASSIGN  15655<<ASSIGN  15668>>IF      15673>>CALLBLT 15674>>ASSIGN
     15676>>CALLBLT 15705>>CALLBLT 15715>>CALLBLT 15766<>CALL
USERS_KEY
     12458**DCL     15698<<ASSIGN  15708<>CALL    15751<>CALL    15756<>CALL
USERS_KEY.COUNT
     12458**DCL     15702<<ASSIGN  15706<<ASSIGN  15754>>DOUNTIL 15754>>DOUNTIL
USERS_KEY.TEXT
     12458**DCL     12459--REDEF   12459--REDEF   12459--REDEF   12460--REDEF
USERS_KEY.TXTC
     12459**DCL     15701<<CALLBLT 15705<<CALLBLT 15762>>CALLBLT 15763>>ASSIGN
WILD_CARD
     15601**DCL     15616<<ASSIGN  15678<<ASSIGN  15681<<ASSIGN  15700>>IF      15764>>IF
X$FORMAT
     15461**DCL-ENT 15695--CALL    15717--CALL    15787--CALL    15798--CALL    15819--CALL

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:58   
      314        1        /*T***********************************************************/
      315        2        /*T*                                                         */
      316        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      317        4        /*T*                                                         */
      318        5        /*T***********************************************************/
      319        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:59   
      320        7        /*M* ASL$DISP_ONE_CHARSET: routine to handle DISPLAY CHARSET cmd  */
      321        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      322        9              ECU=3,CSU=3,SDI=3                                           */
      323       10
      324       11        ASL$DISP_ONE_CHARSET: PROC (JCL);
      325       12        /**********************************************************/
      326       13
      327       14        /*D* NAME:     ASL$DISP_ONE_CHARSET
      328       15             CALL:     CALL ASL$DISP_ONE_CHARSET (JCL)
      329       16             INPUT:    JCL - flag for JCL type display
      330       17             OUTPUT:   Nothing is returned.
      331       18             DESCRIPTION:  ASL$DISP_ONE_CHARSET is a subroutine to handle
      332       19                            the DISPLAY CHARSET command for SUPER.
      333       20                            This routine will do the actual display of
      334       21                            a character set name followed by all of the
      335       22                            charsets options.
      336       23        */
      337       24        /********************************************************************/
      338       25        /*   Include files   include files   include files   include files  */
      339       26        /********************************************************************/
      340       27        %INCLUDE AS_PERR_C;
      341      629        %INCLUDE AS_SUPER_C;
      342     1064        %INCLUDE AS_SUBS_C;
      343     2478        %INCLUDE AS_MAC_C;
      344     2558        %INCLUDE AS_ENTRIES_M;
      345     3608        %INCLUDE AS_SSUBS_C;
      346     3700        %INCLUDE CP_6_SUBS;
      347     4240        %INCLUDE FS_SUPER_C;
      348     5003        %INCLUDE KL_SUPER_C;
      349     7905        %INCLUDE XU_MACRO_C;
      350    11011        %INCLUDE XU_FORMAT_C;
      351    11173        %INCLUDE AS_SUPER_R;
      352    14189        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:60   
      353    14190        /********************************************************************/
      354    14191        /*   Parameter       parameter       parameter       parameter      */
      355    14192        /********************************************************************/
      356    14193    1   DCL JCL  BIT(1);
      357    14194        /********************************************************************/
      358    14195        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      359    14196        /********************************************************************/
      360    14197    1   DCL X$FORMAT ENTRY(1);
      361    14198        /********************************************************************/
      362    14199        /*   Local based     local based     local based     local based    */
      363    14200        /********************************************************************/
      364    14201        %FS$CHARSET ( NAME = FS$CHARSET,
      365    14202                      STCLASS = "BASED( DSEG1$ )");
      366    14233    1   DCL ACHAR          CHAR(1) BASED;
      367    14234        /********************************************************************/
      368    14235        /*   Auto data       auto data       auto data       auto data      */
      369    14236        /********************************************************************/
      370    14237    1   DCL I              UBIN;
      371    14238    1   DCL K              UBIN;
      372    14239    1   DCL ATTR_COUNT     UBIN;
      373    14240    1   DCL TEMP_SET       (0:9)  CHAR(36) CALIGNED;
      374    14241    1   DCL TEMP$          PTR;
      375    14242    1   DCL SET$           PTR;
      376    14243        /********************************************************************/
      377    14244        /*   Constant data   constant data   constant data   constant data  */
      378    14245        /********************************************************************/
      379    14246    1   DCL BL_STR         CHAR(0) CONSTANT INIT(' ');
      380    14247    1   DCL CHARSET_STR    CHAR(0) CONSTANT INIT ('CHARSET');
      381    14248    1   DCL LPOK_STR       CHAR(0) CONSTANT INIT ('LPOK');
      382    14249    1   DCL TSOK_STR       CHAR(0) CONSTANT INIT ('TSOK');
      383    14250    1   DCL LTYP_STR       CHAR(0) CONSTANT INIT ('LTYP');
      384    14251    1   DCL ELSOK_STR      CHAR(0) CONSTANT INIT ('ELSOK');
      385    14252    1   DCL ATTRIBUTE_STR  CHAR(0) CONSTANT INIT ('ATTRIBUTE');
      386    14253    1   DCL BIN_STR        CHAR(0) CONSTANT INIT ('BIN');
      387    14254    1   DCL TRANSLGL_STR   CHAR(0) CONSTANT INIT ('TRANSLGL');
      388    14255    1   DCL OVERPRINT_STR  CHAR(0) CONSTANT INIT ('OVERPRINT');
      389    14256    1   DCL IMAGE_STR      CHAR(0) CONSTANT INIT ('IMAGE');
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:61   
      390    14257    1   DCL YES_STR        CHAR(0) CONSTANT INIT ('YES');
      391    14258    1   DCL NO_STR         CHAR(0) CONSTANT INIT ('NO');
      392    14259    1   DCL DEVICES_STR    CHAR(0) CONSTANT INIT ('DEVICES');
      393    14260    1   DCL SET_STR  (0:9) CHAR(4)  CONSTANT
      394    14261    1               INIT ('SET0',
      395    14262    1                     'SET1',
      396    14263    1                     'SET2',
      397    14264    1                     'SET3',
      398    14265    1                     'SET4',
      399    14266    1                     'SET5',
      400    14267    1                     'SET6',
      401    14268    1                     'SET7',
      402    14269    1                     'SET8',
      403    14270    1                     'SET9');
      404    14271    1   DCL NOXLATE_STR       CHAR(0) CONSTANT INIT('NOXLATE');
      405    14272    1   DCL NATL_STR          CHAR(0) CONSTANT INIT('NATL');
      406    14273    1   DCL APL_STR           CHAR(0) CONSTANT INIT('APL');
      407    14274    1   DCL UPPER_LOWER_STR   CHAR(0) CONSTANT INIT('UPPERCASE,LOWERCASE');
      408    14275    1   DCL UPPERCASE_STR     CHAR(0) CONSTANT INIT('UPPERCASE');
      409    14276    1   DCL LOWERCASE_STR     CHAR(0) CONSTANT INIT('LOWERCASE');
      410    14277    1   DCL COMMA_STR         CHAR(0) CONSTANT INIT(', ');
      411    14278    1   DCL JCL_FMT           CHAR(0) CONSTANT INIT
      412    14279    1      ('%/MODIFY %A  %A%/%A%/%4(   %A = %A%/%)%/%A = %N(%A%A%)%/%A%/%10(   %A = ''%A''%
             14279        /%)%/');
      413    14280    1   DCL DISP_FMT          CHAR(0) CONSTANT INIT
      414    14281    1      ('%/%A  %A%2/%A%2/%4(   %A = %A%/%)%/%A = %N(%A%A%)%2/%A%2/%10(   %A = %A%/%)');
      415    14282        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:62   
      416    14283        /********************************************************************/
      417    14284        /*   Procedure       procedure       procedure       procedure      */
      418    14285        /********************************************************************/
      419    14286        /*
      420    14287           The format buffer contains format codes for the following:
      421    14288
      422    14289             'CHARSET'  charset name
      423    14290             new line
      424    14291             'DEVICES'  - initiating a suboption mode
      425    14292                'ELSOK' ' = ' ('yes'|'no')
      426    14293                'LPOK' ' = ' ('yes'|'no')
      427    14294                'LTYP' ' = ' (cc|' ')
      428    14295                'tsok' ' = ' ('yes'|'no')
      429    14296             new line
      430    14297             the number of attributes + 1  where number <= 5
      431    14298             'ATTRIBUTES' ' = ' ['bin'] ['translegal'] ['overprint']
      432    14299                    (['natl']|['noxlate']|['lowercase']|['uppercase']|['apl'])
      433    14300             new line
      434    14301             'IMAGE'  -  initiating another suboption mode
      435    14302                new line
      436    14303                'SET0 = ' FS$CHARSET.SETS(0)
      437    14304                new line
      438    14305                'SET1 = ' FS$CHARSET.SETS(1)
      439    14306                new line
      440    14307                'SET2 = ' FS$CHARSET.SETS(2)
      441    14308                new line
      442    14309                'SET3 = ' FS$CHARSET.SETS(3)
      443    14310                new line
      444    14311                'SET4 = ' FS$CHARSET.SETS(4)
      445    14312                new line
      446    14313                'SET5 = ' FS$CHARSET.SETS(5)
      447    14314                new line
      448    14315                'SET6 = ' FS$CHARSET.SETS(6)
      449    14316                new line
      450    14317                'SET7 = ' FS$CHARSET.SETS(7)
      451    14318                new line
      452    14319                'SET8 = ' FS$CHARSET.SETS(8)
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:63   
      453    14320                new line
      454    14321                'SET9 = ' FS$CHARSET.SETS(9)
      455    14322                followed by a blank line
      456    14323        */
      457    14324    2   IF JCL THEN DO;
      458    14325    2      FMT_BUF = JCL_FMT ;
      459    14326    2      FDS.FMT_.BOUND = SIZEC (JCL_FMT);
      460    14327    2      END; /*  Disp  */
      461    14328    2   ELSE DO;
      462    14329    2      FMT_BUF = DISP_FMT ;
      463    14330    2      FDS.FMT_.BOUND = SIZEC (DISP_FMT);
      464    14331    2      END; /*  Not disp  */
      465    14332    1   FDS.NVECS# = 0;
      466    14333        /*
      467    14334          Setup the header and charset name
      468    14335        */
      469    14336    1   FMT_VEC(FDS.NVECS#) = VECTOR (CHARSET_STR);
      470    14337    1   FMT_VEC(FDS.NVECS#+1) = VECTOR (SUBSTR( USERS_KEY.TXTC, 1, USERS_KEY.COUNT - 8));
      471    14338    1   FDS.NVECS# = FDS.NVECS# + 2;
      472    14339        /*
      473    14340          Setup the devices header and options
      474    14341        */
      475    14342    1   FMT_VEC(FDS.NVECS#) = VECTOR (DEVICES_STR);
      476    14343    1   FDS.NVECS# = FDS.NVECS# + 1;
      477    14344    1   FMT_VEC(FDS.NVECS#) = VECTOR (LPOK_STR);
      478    14345    1   IF FS$CHARSET.LGLTYPS.LPOK
      479    14346    2   THEN DO;
      480    14347    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(YES_STR);
      481    14348    2      END;
      482    14349    2   ELSE DO;
      483    14350    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);
      484    14351    2      END;
      485    14352    1   FDS.NVECS# = FDS.NVECS# + 2;
      486    14353
      487    14354    1   FMT_VEC(FDS.NVECS#) = VECTOR (TSOK_STR);
      488    14355    1   IF FS$CHARSET.LGLTYPS.TSOK
      489    14356    2   THEN DO;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:64   
      490    14357    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(YES_STR);
      491    14358    2      END;
      492    14359    2   ELSE DO;
      493    14360    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);
      494    14361    2      END;
      495    14362    1   FDS.NVECS# = FDS.NVECS# + 2;
      496    14363
      497    14364    1   FMT_VEC(FDS.NVECS#) = VECTOR (ELSOK_STR);
      498    14365    1   IF FS$CHARSET.LGLTYPS.ELSOK
      499    14366    2   THEN DO;
      500    14367    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(YES_STR);
      501    14368    2      END;
      502    14369    2   ELSE DO;
      503    14370    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);
      504    14371    2      END;
      505    14372    1   FDS.NVECS# = FDS.NVECS# + 2;
      506    14373
      507    14374    1   FMT_VEC(FDS.NVECS#) = VECTOR (LTYP_STR);
      508    14375    1   IF FS$CHARSET.LGLTYPS.ONEOK
      509    14376    2   THEN DO;
      510    14377    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(FS$CHARSET.LGLTYPS.LTYP);
      511    14378    2      END;
      512    14379    2   ELSE DO;
      513    14380    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);
      514    14381    2      END;
      515    14382    1   FDS.NVECS# = FDS.NVECS# + 2;
      516    14383
      517    14384        /*
      518    14385                Do the attributes now
      519    14386        */
      520    14387    1   FMT_VEC(FDS.NVECS#) = VECTOR (ATTRIBUTE_STR);
      521    14388    1   FDS.NVECS# = FDS.NVECS# + 1;
      522    14389
      523    14390    1   ATTR_COUNT = 0;
      524    14391    1   FMT_VEC (FDS.NVECS#) = VECTOR (ATTR_COUNT);
      525    14392    1   FDS.NVECS# = FDS.NVECS# + 1;
      526    14393    1   IF ((FS$CHARSET.ATTRS & %ATTR_NOXLATE#) = %ATTR_NOXLATE#)
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:65   
      527    14394    2   THEN DO;
      528    14395    2      FMT_VEC(FDS.NVECS#) = VECTOR(NOXLATE_STR);
      529    14396    2      ATTR_COUNT = 1;
      530    14397    2      END;
      531    14398    1   ELSE IF ((FS$CHARSET.ATTRS & %ATTR_NATL#) = %ATTR_NATL#)
      532    14399    2      THEN DO;
      533    14400    2         FMT_VEC(FDS.NVECS#) = VECTOR(NATL_STR);
      534    14401    2         ATTR_COUNT = 1;
      535    14402    2         END;
      536    14403    1      ELSE IF ((FS$CHARSET.ATTRS & %ATTR_APL#) = %ATTR_APL#)
      537    14404    2         THEN DO;
      538    14405    2            FMT_VEC(FDS.NVECS#) = VECTOR(APL_STR);
      539    14406    2            ATTR_COUNT = 1;
      540    14407    2            END;
      541    14408    1         ELSE IF ((FS$CHARSET.ATTRS & %ATTR_UPPERCASE#) = %ATTR_UPPERCASE#)
      542    14409    1                 AND ((FS$CHARSET.ATTRS & %ATTR_LOWERCASE#) = %ATTR_LOWERCASE#)
      543    14410    2            THEN DO;
      544    14411    2               FMT_VEC(FDS.NVECS#) = VECTOR(UPPER_LOWER_STR);
      545    14412    2               ATTR_COUNT = 1;
      546    14413    2               END;
      547    14414    1            ELSE IF ((FS$CHARSET.ATTRS & %ATTR_UPPERCASE#) = %ATTR_UPPERCASE#)
      548    14415    2               THEN DO;
      549    14416    2                  FMT_VEC(FDS.NVECS#) = VECTOR(UPPERCASE_STR);
      550    14417    2                  ATTR_COUNT = 1;
      551    14418    2                  END;
      552    14419    1               ELSE IF ((FS$CHARSET.ATTRS & %ATTR_LOWERCASE#) = %ATTR_LOWERCASE#)
      553    14420    2                  THEN DO;
      554    14421    2                     FMT_VEC(FDS.NVECS#) = VECTOR(LOWERCASE_STR);
      555    14422    2                     ATTR_COUNT = 1;
      556    14423    2                     END;
      557    14424    2   IF ATTR_COUNT = 1 THEN DO;
      558    14425    2      FDS.NVECS# = FDS.NVECS# + 1;
      559    14426    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);
      560    14427    2      FDS.NVECS# = FDS.NVECS# + 1;
      561    14428    2      END; /*  ATTR_COUNT = 1  */
      562    14429
      563    14430    1   IF ((FS$CHARSET.ATTRS & %ATTR_BIN#) = %ATTR_BIN#)
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:66   
      564    14431    2   THEN DO;
      565    14432    2      FMT_VEC(FDS.NVECS#) = VECTOR(BIN_STR);
      566    14433    2      FDS.NVECS# = FDS.NVECS# + 1;
      567    14434    2      ATTR_COUNT = ATTR_COUNT + 1;
      568    14435    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);
      569    14436    2      FDS.NVECS# = FDS.NVECS# + 1;
      570    14437    2      END;
      571    14438
      572    14439    1   IF ((FS$CHARSET.ATTRS & %ATTR_TRANSLGL#) = %ATTR_TRANSLGL#)
      573    14440    2   THEN DO;
      574    14441    2      FMT_VEC(FDS.NVECS#) = VECTOR(TRANSLGL_STR);
      575    14442    2      FDS.NVECS# = FDS.NVECS# + 1;
      576    14443    2      ATTR_COUNT = ATTR_COUNT + 1;
      577    14444    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);
      578    14445    2      FDS.NVECS# = FDS.NVECS# + 1;
      579    14446    2      END;
      580    14447
      581    14448    1   IF ((FS$CHARSET.ATTRS & %ATTR_TRUOVRPRT#) = %ATTR_TRUOVRPRT#)
      582    14449    2   THEN DO;
      583    14450    2      FMT_VEC(FDS.NVECS#) = VECTOR(OVERPRINT_STR);
      584    14451    2      FDS.NVECS# = FDS.NVECS# + 1;
      585    14452    2      ATTR_COUNT = ATTR_COUNT + 1;
      586    14453    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);
      587    14454    2      FDS.NVECS# = FDS.NVECS# + 1;
      588    14455    2      END;
      589    14456
      590    14457    1   IF ATTR_COUNT > 0 THEN
      591    14458    1      FMT_VEC (FDS.NVECS# - 1) = VECTOR (BL_STR);  /*  To remove the last comma  */
      592    14459        /*
      593    14460             Print out chain image
      594    14461        */
      595    14462    1   FMT_VEC (FDS.NVECS#) = VECTOR (IMAGE_STR);
      596    14463    1   FDS.NVECS# = FDS.NVECS# + 1;
      597    14464    2   DO I= 0 TO 9;
      598    14465    2      FMT_VEC(FDS.NVECS#) = VECTOR (SET_STR(I));
      599    14466    2      SET$ = ADDR (FS$CHARSET.SETS(I));
      600    14467    2      TEMP$ = ADDR (TEMP_SET(I));
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:67   
      601    14468    3      DO K = 0 TO 23;
      602    14469    3         TEMP$->ACHAR = SET$->ACHAR;
      603    14470    4         IF TEMP$->ACHAR = '''' AND JCL THEN DO;
      604    14471    4            TEMP$ = PINCRC(TEMP$,1);
      605    14472    4            TEMP$->ACHAR = SET$->ACHAR;
      606    14473    4            END;   /*  Have a single quote  */
      607    14474    3         TEMP$ = PINCRC(TEMP$,1);
      608    14475    3         SET$ = PINCRC(SET$,1);
      609    14476    3         END;   /*  Do k  */
      610    14477    2      FMT_VEC(FDS.NVECS#+1) = VECTOR (SUBSTR(TEMP_SET(I),0,POFFC(TEMP$,ADDR(TEMP_SET(I)
             14477               ))));
      611    14478    2      FDS.NVECS# = FDS.NVECS# + 2;
      612    14479    2      END;
      613    14480    1   CALL X$FORMAT (FDS);
      614    14481    1   END ASL$DISP_ONE_CHARSET;

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:68   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_CHARSET.

   Procedure ASL$DISP_ONE_CHARSET requires 446 words for executable code.
   Procedure ASL$DISP_ONE_CHARSET requires 104 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_CHARSETS.:E05TSI    .

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:69   

 Object Unit name= ASL$DISP_ONE_CHARSET                       File name= ASL$LIST_CHARSETS.:E05TOU
 UTS= JUL 29 '97 10:04:46.92 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     89    131  ASL$DISP_ONE_CHARSET
    2   Proc  even  none   446    676  ASL$DISP_ONE_CHARSET
    3  RoData even  none    50     62  ASL$DISP_ONE_CHARSET

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  ASL$DISP_ONE_CHARSET

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:70   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               ERR_CODE                              REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:71   


      314        1        /*T***********************************************************/
      315        2        /*T*                                                         */
      316        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      317        4        /*T*                                                         */
      318        5        /*T***********************************************************/
      319        6        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:72   
      320        7        /*M* ASL$DISP_ONE_CHARSET: routine to handle DISPLAY CHARSET cmd  */
      321        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      322        9              ECU=3,CSU=3,SDI=3                                           */
      323       10
      324       11        ASL$DISP_ONE_CHARSET: PROC (JCL);

     11  2 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_1
         2 000001   000150 000001                    ZERO    104,1

      325       12        /**********************************************************/
      326       13
      327       14        /*D* NAME:     ASL$DISP_ONE_CHARSET
      328       15             CALL:     CALL ASL$DISP_ONE_CHARSET (JCL)
      329       16             INPUT:    JCL - flag for JCL type display
      330       17             OUTPUT:   Nothing is returned.
      331       18             DESCRIPTION:  ASL$DISP_ONE_CHARSET is a subroutine to handle
      332       19                            the DISPLAY CHARSET command for SUPER.
      333       20                            This routine will do the actual display of
      334       21                            a character set name followed by all of the
      335       22                            charsets options.
      336       23        */
      337       24        /********************************************************************/
      338       25        /*   Include files   include files   include files   include files  */
      339       26        /********************************************************************/
      340       27        %INCLUDE AS_PERR_C;
      341      629        %INCLUDE AS_SUPER_C;
      342     1064        %INCLUDE AS_SUBS_C;
      343     2478        %INCLUDE AS_MAC_C;
      344     2558        %INCLUDE AS_ENTRIES_M;
      345     3608        %INCLUDE AS_SSUBS_C;
      346     3700        %INCLUDE CP_6_SUBS;
      347     4240        %INCLUDE FS_SUPER_C;
      348     5003        %INCLUDE KL_SUPER_C;
      349     7905        %INCLUDE XU_MACRO_C;
      350    11011        %INCLUDE XU_FORMAT_C;
      351    11173        %INCLUDE AS_SUPER_R;
      352    14189        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:73   
      353    14190        /********************************************************************/
      354    14191        /*   Parameter       parameter       parameter       parameter      */
      355    14192        /********************************************************************/
      356    14193    1   DCL JCL  BIT(1);
      357    14194        /********************************************************************/
      358    14195        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      359    14196        /********************************************************************/
      360    14197    1   DCL X$FORMAT ENTRY(1);
      361    14198        /********************************************************************/
      362    14199        /*   Local based     local based     local based     local based    */
      363    14200        /********************************************************************/
      364    14201        %FS$CHARSET ( NAME = FS$CHARSET,
      365    14202                      STCLASS = "BASED( DSEG1$ )");
      366    14233    1   DCL ACHAR          CHAR(1) BASED;
      367    14234        /********************************************************************/
      368    14235        /*   Auto data       auto data       auto data       auto data      */
      369    14236        /********************************************************************/
      370    14237    1   DCL I              UBIN;
      371    14238    1   DCL K              UBIN;
      372    14239    1   DCL ATTR_COUNT     UBIN;
      373    14240    1   DCL TEMP_SET       (0:9)  CHAR(36) CALIGNED;
      374    14241    1   DCL TEMP$          PTR;
      375    14242    1   DCL SET$           PTR;
      376    14243        /********************************************************************/
      377    14244        /*   Constant data   constant data   constant data   constant data  */
      378    14245        /********************************************************************/
      379    14246    1   DCL BL_STR         CHAR(0) CONSTANT INIT(' ');
      380    14247    1   DCL CHARSET_STR    CHAR(0) CONSTANT INIT ('CHARSET');
      381    14248    1   DCL LPOK_STR       CHAR(0) CONSTANT INIT ('LPOK');
      382    14249    1   DCL TSOK_STR       CHAR(0) CONSTANT INIT ('TSOK');
      383    14250    1   DCL LTYP_STR       CHAR(0) CONSTANT INIT ('LTYP');
      384    14251    1   DCL ELSOK_STR      CHAR(0) CONSTANT INIT ('ELSOK');
      385    14252    1   DCL ATTRIBUTE_STR  CHAR(0) CONSTANT INIT ('ATTRIBUTE');
      386    14253    1   DCL BIN_STR        CHAR(0) CONSTANT INIT ('BIN');
      387    14254    1   DCL TRANSLGL_STR   CHAR(0) CONSTANT INIT ('TRANSLGL');
      388    14255    1   DCL OVERPRINT_STR  CHAR(0) CONSTANT INIT ('OVERPRINT');
      389    14256    1   DCL IMAGE_STR      CHAR(0) CONSTANT INIT ('IMAGE');
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:74   
      390    14257    1   DCL YES_STR        CHAR(0) CONSTANT INIT ('YES');
      391    14258    1   DCL NO_STR         CHAR(0) CONSTANT INIT ('NO');
      392    14259    1   DCL DEVICES_STR    CHAR(0) CONSTANT INIT ('DEVICES');
      393    14260    1   DCL SET_STR  (0:9) CHAR(4)  CONSTANT
      394    14261    1               INIT ('SET0',
      395    14262    1                     'SET1',
      396    14263    1                     'SET2',
      397    14264    1                     'SET3',
      398    14265    1                     'SET4',
      399    14266    1                     'SET5',
      400    14267    1                     'SET6',
      401    14268    1                     'SET7',
      402    14269    1                     'SET8',
      403    14270    1                     'SET9');
      404    14271    1   DCL NOXLATE_STR       CHAR(0) CONSTANT INIT('NOXLATE');
      405    14272    1   DCL NATL_STR          CHAR(0) CONSTANT INIT('NATL');
      406    14273    1   DCL APL_STR           CHAR(0) CONSTANT INIT('APL');
      407    14274    1   DCL UPPER_LOWER_STR   CHAR(0) CONSTANT INIT('UPPERCASE,LOWERCASE');
      408    14275    1   DCL UPPERCASE_STR     CHAR(0) CONSTANT INIT('UPPERCASE');
      409    14276    1   DCL LOWERCASE_STR     CHAR(0) CONSTANT INIT('LOWERCASE');
      410    14277    1   DCL COMMA_STR         CHAR(0) CONSTANT INIT(', ');
      411    14278    1   DCL JCL_FMT           CHAR(0) CONSTANT INIT
      412    14279    1      ('%/MODIFY %A  %A%/%A%/%4(   %A = %A%/%)%/%A = %N(%A%A%)%/%A%/%10(  %A = ''%A''%
             14279        /%)%/');
      413    14280    1   DCL DISP_FMT          CHAR(0) CONSTANT INIT
      414    14281    1      ('%/%A  %A%2/%A%2/%4(   %A = %A%/%)%/%A = %N(%A%A%)%2/%A%2/%10(   %A = %A%/%)');
      415    14282        %EJECT;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:75   
      416    14283        /********************************************************************/
      417    14284        /*   Procedure       procedure       procedure       procedure      */
      418    14285        /********************************************************************/
      419    14286        /*
      420    14287           The format buffer contains format codes for the following:
      421    14288
      422    14289             'CHARSET'  charset name
      423    14290             new line
      424    14291             'DEVICES'  - initiating a suboption mode
      425    14292                'ELSOK' ' = ' ('yes'|'no')
      426    14293                'LPOK' ' = ' ('yes'|'no')
      427    14294                'LTYP' ' = ' (cc|' ')
      428    14295                'tsok' ' = ' ('yes'|'no')
      429    14296             new line
      430    14297             the number of attributes + 1  where number <= 5
      431    14298             'ATTRIBUTES' ' = ' ['bin'] ['translegal'] ['overprint']
      432    14299                    (['natl']|['noxlate']|['lowercase']|['uppercase']|['apl'])
      433    14300             new line
      434    14301             'IMAGE'  -  initiating another suboption mode
      435    14302                new line
      436    14303                'SET0 = ' FS$CHARSET.SETS(0)
      437    14304                new line
      438    14305                'SET1 = ' FS$CHARSET.SETS(1)
      439    14306                new line
      440    14307                'SET2 = ' FS$CHARSET.SETS(2)
      441    14308                new line
      442    14309                'SET3 = ' FS$CHARSET.SETS(3)
      443    14310                new line
      444    14311                'SET4 = ' FS$CHARSET.SETS(4)
      445    14312                new line
      446    14313                'SET5 = ' FS$CHARSET.SETS(5)
      447    14314                new line
      448    14315                'SET6 = ' FS$CHARSET.SETS(6)
      449    14316                new line
      450    14317                'SET7 = ' FS$CHARSET.SETS(7)
      451    14318                new line
      452    14319                'SET8 = ' FS$CHARSET.SETS(8)
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:76   
      453    14320                new line
      454    14321                'SET9 = ' FS$CHARSET.SETS(9)
      455    14322                followed by a blank line
      456    14323        */
      457    14324    2   IF JCL THEN DO;

  14324  2 000002   200003 470500                    LDP0    @JCL,,AUTO
         2 000003   000000 066500                    CMPB    filb='0'B
         2 000004   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 000005   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000006   000017 600000 2                  TZE     s:14329

      458    14325    2      FMT_BUF = JCL_FMT ;

  14325  2 000007   040000 100400                    MLR     fill='040'O
         2 000010   000061 000122 1                  ADSC9   JCL_FMT                  cn=0,n=82
         2 000011   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      459    14326    2      FDS.FMT_.BOUND = SIZEC (JCL_FMT);

  14326  2 000012   000000 236000 xsym               LDQ     FDS
         2 000013   177777 376007                    ANQ     65535,DL
         2 000014   000000 276000 3                  ORQ     0
         2 000015   000000 756000 xsym               STQ     FDS

      460    14327    2      END; /*  Disp  */

  14327  2 000016   000026 710000 2                  TRA     s:14332

      461    14328    2   ELSE DO;

      462    14329    2      FMT_BUF = DISP_FMT ;

  14329  2 000017   040000 100400                    MLR     fill='040'O
         2 000020   000106 000113 1                  ADSC9   DISP_FMT                 cn=0,n=75
         2 000021   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:77   
      463    14330    2      FDS.FMT_.BOUND = SIZEC (DISP_FMT);

  14330  2 000022   000000 236000 xsym               LDQ     FDS
         2 000023   177777 376007                    ANQ     65535,DL
         2 000024   000001 276000 3                  ORQ     1
         2 000025   000000 756000 xsym               STQ     FDS

      464    14331    2      END; /*  Not disp  */

      465    14332    1   FDS.NVECS# = 0;

  14332  2 000026   000011 450000 xsym               STZ     FDS+9

      466    14333        /*
      467    14334          Setup the header and charset name
      468    14335        */
      469    14336    1   FMT_VEC(FDS.NVECS#) = VECTOR (CHARSET_STR);

  14336  2 000027   000011 235000 xsym               LDA     FDS+9
         2 000030   000001 735000                    ALS     1
         2 000031   000000 620005                    EAX0    0,AL
         2 000032   000000 621005                    EAX1    0,AL
         2 000033   000002 237000 3                  LDAQ    2
         2 000034   000000 755010 xsym               STA     FMT_VEC,X0
         2 000035   000001 756011 xsym               STQ     FMT_VEC+1,X1

      470    14337    1   FMT_VEC(FDS.NVECS#+1) = VECTOR (SUBSTR( USERS_KEY.TXTC, 1, USERS_KEY.COUNT - 8));

  14337  2 000036   000011 235000 xsym               LDA     FDS+9
         2 000037   000001 735000                    ALS     1
         2 000040   000000 236000 xsym               LDQ     USERS_KEY
         2 000041   000033 772000                    QRL     27
         2 000042   777770 620006                    EAX0    -8,QL
         2 000043   000000 636010                    EAQ     0,X0
         2 000044   000022 772000                    QRL     18
         2 000045   000000 620005                    EAX0    0,AL
         2 000046   000064 737000                    LLS     52
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:78   
         2 000047   000140 135007                    SBLA    96,DL
         2 000050   000004 236000 3                  LDQ     4
         2 000051   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000052   000003 756010 xsym               STQ     FMT_VEC+3,X0

      471    14338    1   FDS.NVECS# = FDS.NVECS# + 2;

  14338  2 000053   000002 236007                    LDQ     2,DL
         2 000054   000011 056000 xsym               ASQ     FDS+9

      472    14339        /*
      473    14340          Setup the devices header and options
      474    14341        */
      475    14342    1   FMT_VEC(FDS.NVECS#) = VECTOR (DEVICES_STR);

  14342  2 000055   000011 235000 xsym               LDA     FDS+9
         2 000056   000001 735000                    ALS     1
         2 000057   000000 620005                    EAX0    0,AL
         2 000060   000000 621005                    EAX1    0,AL
         2 000061   000006 237000 3                  LDAQ    6
         2 000062   000000 755010 xsym               STA     FMT_VEC,X0
         2 000063   000001 756011 xsym               STQ     FMT_VEC+1,X1

      476    14343    1   FDS.NVECS# = FDS.NVECS# + 1;

  14343  2 000064   000011 054000 xsym               AOS     FDS+9

      477    14344    1   FMT_VEC(FDS.NVECS#) = VECTOR (LPOK_STR);

  14344  2 000065   000011 235000 xsym               LDA     FDS+9
         2 000066   000001 735000                    ALS     1
         2 000067   000000 620005                    EAX0    0,AL
         2 000070   000000 621005                    EAX1    0,AL
         2 000071   000010 237000 3                  LDAQ    8
         2 000072   000000 755010 xsym               STA     FMT_VEC,X0
         2 000073   000001 756011 xsym               STQ     FMT_VEC+1,X1

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:79   
      478    14345    1   IF FS$CHARSET.LGLTYPS.LPOK

  14345  2 000074   000000 471400 xsym               LDP1    DSEG1$
         2 000075   100074 236100                    LDQ     60,,PR1
         2 000076   400000 316007                    CANQ    -131072,DL
         2 000077   000104 600000 2                  TZE     s:14350

      479    14346    2   THEN DO;

      480    14347    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(YES_STR);

  14347  2 000100   000012 237000 3                  LDAQ    10
         2 000101   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000102   000003 756010 xsym               STQ     FMT_VEC+3,X0

      481    14348    2      END;

  14348  2 000103   000107 710000 2                  TRA     s:14352

      482    14349    2   ELSE DO;

      483    14350    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);

  14350  2 000104   000014 237000 3                  LDAQ    12
         2 000105   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000106   000003 756010 xsym               STQ     FMT_VEC+3,X0

      484    14351    2      END;

      485    14352    1   FDS.NVECS# = FDS.NVECS# + 2;

  14352  2 000107   000002 236007                    LDQ     2,DL
         2 000110   000011 056000 xsym               ASQ     FDS+9

      486    14353
      487    14354    1   FMT_VEC(FDS.NVECS#) = VECTOR (TSOK_STR);

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:80   
  14354  2 000111   000011 235000 xsym               LDA     FDS+9
         2 000112   000001 735000                    ALS     1
         2 000113   000000 620005                    EAX0    0,AL
         2 000114   000000 621005                    EAX1    0,AL
         2 000115   000016 237000 3                  LDAQ    14
         2 000116   000000 755010 xsym               STA     FMT_VEC,X0
         2 000117   000001 756011 xsym               STQ     FMT_VEC+1,X1

      488    14355    1   IF FS$CHARSET.LGLTYPS.TSOK

  14355  2 000120   100074 236100                    LDQ     60,,PR1
         2 000121   200000 316007                    CANQ    65536,DL
         2 000122   000133 600000 2                  TZE     s:14360

      489    14356    2   THEN DO;

      490    14357    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(YES_STR);

  14357  2 000123   000011 235000 xsym               LDA     FDS+9
         2 000124   000001 735000                    ALS     1
         2 000125   000000 620005                    EAX0    0,AL
         2 000126   000000 621005                    EAX1    0,AL
         2 000127   000012 237000 3                  LDAQ    10
         2 000130   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000131   000003 756011 xsym               STQ     FMT_VEC+3,X1

      491    14358    2      END;

  14358  2 000132   000142 710000 2                  TRA     s:14362

      492    14359    2   ELSE DO;

      493    14360    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);

  14360  2 000133   000011 235000 xsym               LDA     FDS+9
         2 000134   000001 735000                    ALS     1
         2 000135   000000 620005                    EAX0    0,AL
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:81   
         2 000136   000000 621005                    EAX1    0,AL
         2 000137   000014 237000 3                  LDAQ    12
         2 000140   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000141   000003 756011 xsym               STQ     FMT_VEC+3,X1

      494    14361    2      END;

      495    14362    1   FDS.NVECS# = FDS.NVECS# + 2;

  14362  2 000142   000002 236007                    LDQ     2,DL
         2 000143   000011 056000 xsym               ASQ     FDS+9

      496    14363
      497    14364    1   FMT_VEC(FDS.NVECS#) = VECTOR (ELSOK_STR);

  14364  2 000144   000011 235000 xsym               LDA     FDS+9
         2 000145   000001 735000                    ALS     1
         2 000146   000000 620005                    EAX0    0,AL
         2 000147   000000 621005                    EAX1    0,AL
         2 000150   000020 237000 3                  LDAQ    16
         2 000151   000000 755010 xsym               STA     FMT_VEC,X0
         2 000152   000001 756011 xsym               STQ     FMT_VEC+1,X1

      498    14365    1   IF FS$CHARSET.LGLTYPS.ELSOK

  14365  2 000153   100074 236100                    LDQ     60,,PR1
         2 000154   100000 316007                    CANQ    32768,DL
         2 000155   000166 600000 2                  TZE     s:14370

      499    14366    2   THEN DO;

      500    14367    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(YES_STR);

  14367  2 000156   000011 235000 xsym               LDA     FDS+9
         2 000157   000001 735000                    ALS     1
         2 000160   000000 620005                    EAX0    0,AL
         2 000161   000000 621005                    EAX1    0,AL
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:82   
         2 000162   000012 237000 3                  LDAQ    10
         2 000163   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000164   000003 756011 xsym               STQ     FMT_VEC+3,X1

      501    14368    2      END;

  14368  2 000165   000175 710000 2                  TRA     s:14372

      502    14369    2   ELSE DO;

      503    14370    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);

  14370  2 000166   000011 235000 xsym               LDA     FDS+9
         2 000167   000001 735000                    ALS     1
         2 000170   000000 620005                    EAX0    0,AL
         2 000171   000000 621005                    EAX1    0,AL
         2 000172   000014 237000 3                  LDAQ    12
         2 000173   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000174   000003 756011 xsym               STQ     FMT_VEC+3,X1

      504    14371    2      END;

      505    14372    1   FDS.NVECS# = FDS.NVECS# + 2;

  14372  2 000175   000002 236007                    LDQ     2,DL
         2 000176   000011 056000 xsym               ASQ     FDS+9

      506    14373
      507    14374    1   FMT_VEC(FDS.NVECS#) = VECTOR (LTYP_STR);

  14374  2 000177   000011 235000 xsym               LDA     FDS+9
         2 000200   000001 735000                    ALS     1
         2 000201   000000 620005                    EAX0    0,AL
         2 000202   000000 621005                    EAX1    0,AL
         2 000203   000022 237000 3                  LDAQ    18
         2 000204   000000 755010 xsym               STA     FMT_VEC,X0
         2 000205   000001 756011 xsym               STQ     FMT_VEC+1,X1
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:83   

      508    14375    1   IF FS$CHARSET.LGLTYPS.ONEOK

  14375  2 000206   100074 236100                    LDQ     60,,PR1
         2 000207   040000 316007                    CANQ    16384,DL
         2 000210   000222 600000 2                  TZE     s:14380

      509    14376    2   THEN DO;

      510    14377    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(FS$CHARSET.LGLTYPS.LTYP);

  14377  2 000211   000011 235000 xsym               LDA     FDS+9
         2 000212   000001 735000                    ALS     1
         2 000213   000000 620005                    EAX0    0,AL
         2 000214   377640 235007                    LDA     130976,DL
         2 000215   000000 236000 xsym               LDQ     DSEG1$
         2 000216   000024 036000 3                  ADLQ    20
         2 000217   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000220   000003 756010 xsym               STQ     FMT_VEC+3,X0

      511    14378    2      END;

  14378  2 000221   000231 710000 2                  TRA     s:14382

      512    14379    2   ELSE DO;

      513    14380    2      FMT_VEC(FDS.NVECS#+1) = VECTOR(NO_STR);

  14380  2 000222   000011 235000 xsym               LDA     FDS+9
         2 000223   000001 735000                    ALS     1
         2 000224   000000 620005                    EAX0    0,AL
         2 000225   000000 621005                    EAX1    0,AL
         2 000226   000014 237000 3                  LDAQ    12
         2 000227   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000230   000003 756011 xsym               STQ     FMT_VEC+3,X1

      514    14381    2      END;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:84   

      515    14382    1   FDS.NVECS# = FDS.NVECS# + 2;

  14382  2 000231   000002 236007                    LDQ     2,DL
         2 000232   000011 056000 xsym               ASQ     FDS+9

      516    14383
      517    14384        /*
      518    14385                Do the attributes now
      519    14386        */
      520    14387    1   FMT_VEC(FDS.NVECS#) = VECTOR (ATTRIBUTE_STR);

  14387  2 000233   000011 235000 xsym               LDA     FDS+9
         2 000234   000001 735000                    ALS     1
         2 000235   000000 620005                    EAX0    0,AL
         2 000236   000000 621005                    EAX1    0,AL
         2 000237   000026 237000 3                  LDAQ    22
         2 000240   000000 755010 xsym               STA     FMT_VEC,X0
         2 000241   000001 756011 xsym               STQ     FMT_VEC+1,X1

      521    14388    1   FDS.NVECS# = FDS.NVECS# + 1;

  14388  2 000242   000011 054000 xsym               AOS     FDS+9

      522    14389
      523    14390    1   ATTR_COUNT = 0;

  14390  2 000243   200006 450100                    STZ     ATTR_COUNT,,AUTO

      524    14391    1   FMT_VEC (FDS.NVECS#) = VECTOR (ATTR_COUNT);

  14391  2 000244   000011 235000 xsym               LDA     FDS+9
         2 000245   000001 735000                    ALS     1
         2 000246   000000 620005                    EAX0    0,AL
         2 000247   777640 235007                    LDA     -96,DL
         2 000250   200144 452500                    STP2    SET$+2,,AUTO
         2 000251   200144 236100                    LDQ     SET$+2,,AUTO
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:85   
         2 000252   000006 036003                    ADLQ    6,DU
         2 000253   000000 755010 xsym               STA     FMT_VEC,X0
         2 000254   000001 756010 xsym               STQ     FMT_VEC+1,X0

      525    14392    1   FDS.NVECS# = FDS.NVECS# + 1;

  14392  2 000255   000011 054000 xsym               AOS     FDS+9

      526    14393    1   IF ((FS$CHARSET.ATTRS & %ATTR_NOXLATE#) = %ATTR_NOXLATE#)

  14393  2 000256   100074 220100                    LDX0    60,,PR1
         2 000257   000100 360003                    ANX0    64,DU
         2 000260   000100 100003                    CMPX0   64,DU
         2 000261   000274 601000 2                  TNZ     s:14398

      527    14394    2   THEN DO;

      528    14395    2      FMT_VEC(FDS.NVECS#) = VECTOR(NOXLATE_STR);

  14395  2 000262   000011 235000 xsym               LDA     FDS+9
         2 000263   000001 735000                    ALS     1
         2 000264   000000 620005                    EAX0    0,AL
         2 000265   000000 621005                    EAX1    0,AL
         2 000266   000030 237000 3                  LDAQ    24
         2 000267   000000 755010 xsym               STA     FMT_VEC,X0
         2 000270   000001 756011 xsym               STQ     FMT_VEC+1,X1

      529    14396    2      ATTR_COUNT = 1;

  14396  2 000271   000001 235007                    LDA     1,DL
         2 000272   200006 755100                    STA     ATTR_COUNT,,AUTO

      530    14397    2      END;

  14397  2 000273   000405 710000 2                  TRA     s:14424

      531    14398    1   ELSE IF ((FS$CHARSET.ATTRS & %ATTR_NATL#) = %ATTR_NATL#)
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:86   

  14398  2 000274   100074 220100                    LDX0    60,,PR1
         2 000275   000020 360003                    ANX0    16,DU
         2 000276   000020 100003                    CMPX0   16,DU
         2 000277   000312 601000 2                  TNZ     s:14403

      532    14399    2      THEN DO;

      533    14400    2         FMT_VEC(FDS.NVECS#) = VECTOR(NATL_STR);

  14400  2 000300   000011 235000 xsym               LDA     FDS+9
         2 000301   000001 735000                    ALS     1
         2 000302   000000 620005                    EAX0    0,AL
         2 000303   000000 621005                    EAX1    0,AL
         2 000304   000032 237000 3                  LDAQ    26
         2 000305   000000 755010 xsym               STA     FMT_VEC,X0
         2 000306   000001 756011 xsym               STQ     FMT_VEC+1,X1

      534    14401    2         ATTR_COUNT = 1;

  14401  2 000307   000001 235007                    LDA     1,DL
         2 000310   200006 755100                    STA     ATTR_COUNT,,AUTO

      535    14402    2         END;

  14402  2 000311   000405 710000 2                  TRA     s:14424

      536    14403    1      ELSE IF ((FS$CHARSET.ATTRS & %ATTR_APL#) = %ATTR_APL#)

  14403  2 000312   100074 220100                    LDX0    60,,PR1
         2 000313   000004 360003                    ANX0    4,DU
         2 000314   000004 100003                    CMPX0   4,DU
         2 000315   000330 601000 2                  TNZ     s:14408

      537    14404    2         THEN DO;

      538    14405    2            FMT_VEC(FDS.NVECS#) = VECTOR(APL_STR);
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:87   

  14405  2 000316   000011 235000 xsym               LDA     FDS+9
         2 000317   000001 735000                    ALS     1
         2 000320   000000 620005                    EAX0    0,AL
         2 000321   000000 621005                    EAX1    0,AL
         2 000322   000034 237000 3                  LDAQ    28
         2 000323   000000 755010 xsym               STA     FMT_VEC,X0
         2 000324   000001 756011 xsym               STQ     FMT_VEC+1,X1

      539    14406    2            ATTR_COUNT = 1;

  14406  2 000325   000001 235007                    LDA     1,DL
         2 000326   200006 755100                    STA     ATTR_COUNT,,AUTO

      540    14407    2            END;

  14407  2 000327   000405 710000 2                  TRA     s:14424

      541    14408    1         ELSE IF ((FS$CHARSET.ATTRS & %ATTR_UPPERCASE#) = %ATTR_UPPERCASE#)

  14408  2 000330   100074 220100                    LDX0    60,,PR1
         2 000331   000040 360003                    ANX0    32,DU
         2 000332   000040 100003                    CMPX0   32,DU
         2 000333   000352 601000 2                  TNZ     s:14414
         2 000334   100074 220100                    LDX0    60,,PR1
         2 000335   000001 360003                    ANX0    1,DU
         2 000336   000001 100003                    CMPX0   1,DU
         2 000337   000352 601000 2                  TNZ     s:14414

      542    14409    1                 AND ((FS$CHARSET.ATTRS & %ATTR_LOWERCASE#) = %ATTR_LOWERCASE#)
      543    14410    2            THEN DO;

      544    14411    2               FMT_VEC(FDS.NVECS#) = VECTOR(UPPER_LOWER_STR);

  14411  2 000340   000011 235000 xsym               LDA     FDS+9
         2 000341   000001 735000                    ALS     1
         2 000342   000000 620005                    EAX0    0,AL
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:88   
         2 000343   000000 621005                    EAX1    0,AL
         2 000344   000036 237000 3                  LDAQ    30
         2 000345   000000 755010 xsym               STA     FMT_VEC,X0
         2 000346   000001 756011 xsym               STQ     FMT_VEC+1,X1

      545    14412    2               ATTR_COUNT = 1;

  14412  2 000347   000001 235007                    LDA     1,DL
         2 000350   200006 755100                    STA     ATTR_COUNT,,AUTO

      546    14413    2               END;

  14413  2 000351   000405 710000 2                  TRA     s:14424

      547    14414    1            ELSE IF ((FS$CHARSET.ATTRS & %ATTR_UPPERCASE#) = %ATTR_UPPERCASE#)

  14414  2 000352   100074 220100                    LDX0    60,,PR1
         2 000353   000040 360003                    ANX0    32,DU
         2 000354   000040 100003                    CMPX0   32,DU
         2 000355   000370 601000 2                  TNZ     s:14419

      548    14415    2               THEN DO;

      549    14416    2                  FMT_VEC(FDS.NVECS#) = VECTOR(UPPERCASE_STR);

  14416  2 000356   000011 235000 xsym               LDA     FDS+9
         2 000357   000001 735000                    ALS     1
         2 000360   000000 620005                    EAX0    0,AL
         2 000361   000000 621005                    EAX1    0,AL
         2 000362   000040 237000 3                  LDAQ    32
         2 000363   000000 755010 xsym               STA     FMT_VEC,X0
         2 000364   000001 756011 xsym               STQ     FMT_VEC+1,X1

      550    14417    2                  ATTR_COUNT = 1;

  14417  2 000365   000001 235007                    LDA     1,DL
         2 000366   200006 755100                    STA     ATTR_COUNT,,AUTO
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:89   

      551    14418    2                  END;

  14418  2 000367   000405 710000 2                  TRA     s:14424

      552    14419    1               ELSE IF ((FS$CHARSET.ATTRS & %ATTR_LOWERCASE#) = %ATTR_LOWERCASE#)

  14419  2 000370   100074 220100                    LDX0    60,,PR1
         2 000371   000001 360003                    ANX0    1,DU
         2 000372   000001 100003                    CMPX0   1,DU
         2 000373   000405 601000 2                  TNZ     s:14424

      553    14420    2                  THEN DO;

      554    14421    2                     FMT_VEC(FDS.NVECS#) = VECTOR(LOWERCASE_STR);

  14421  2 000374   000011 235000 xsym               LDA     FDS+9
         2 000375   000001 735000                    ALS     1
         2 000376   000000 620005                    EAX0    0,AL
         2 000377   000000 621005                    EAX1    0,AL
         2 000400   000042 237000 3                  LDAQ    34
         2 000401   000000 755010 xsym               STA     FMT_VEC,X0
         2 000402   000001 756011 xsym               STQ     FMT_VEC+1,X1

      555    14422    2                     ATTR_COUNT = 1;

  14422  2 000403   000001 235007                    LDA     1,DL
         2 000404   200006 755100                    STA     ATTR_COUNT,,AUTO

      556    14423    2                     END;

      557    14424    2   IF ATTR_COUNT = 1 THEN DO;

  14424  2 000405   200006 235100                    LDA     ATTR_COUNT,,AUTO
         2 000406   000001 115007                    CMPA    1,DL
         2 000407   000421 601000 2                  TNZ     s:14430

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:90   
      558    14425    2      FDS.NVECS# = FDS.NVECS# + 1;

  14425  2 000410   000011 054000 xsym               AOS     FDS+9

      559    14426    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);

  14426  2 000411   000011 236000 xsym               LDQ     FDS+9
         2 000412   000001 736000                    QLS     1
         2 000413   000000 620006                    EAX0    0,QL
         2 000414   000000 621006                    EAX1    0,QL
         2 000415   000044 237000 3                  LDAQ    36
         2 000416   000000 755010 xsym               STA     FMT_VEC,X0
         2 000417   000001 756011 xsym               STQ     FMT_VEC+1,X1

      560    14427    2      FDS.NVECS# = FDS.NVECS# + 1;

  14427  2 000420   000011 054000 xsym               AOS     FDS+9

      561    14428    2      END; /*  ATTR_COUNT = 1  */

      562    14429
      563    14430    1   IF ((FS$CHARSET.ATTRS & %ATTR_BIN#) = %ATTR_BIN#)

  14430  2 000421   100074 220100                    LDX0    60,,PR1
         2 000422   000002 360003                    ANX0    2,DU
         2 000423   000002 100003                    CMPX0   2,DU
         2 000424   000450 601000 2                  TNZ     s:14439

      564    14431    2   THEN DO;

      565    14432    2      FMT_VEC(FDS.NVECS#) = VECTOR(BIN_STR);

  14432  2 000425   000011 235000 xsym               LDA     FDS+9
         2 000426   000001 735000                    ALS     1
         2 000427   000000 620005                    EAX0    0,AL
         2 000430   000000 621005                    EAX1    0,AL
         2 000431   000046 237000 3                  LDAQ    38
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:91   
         2 000432   000000 755010 xsym               STA     FMT_VEC,X0
         2 000433   000001 756011 xsym               STQ     FMT_VEC+1,X1

      566    14433    2      FDS.NVECS# = FDS.NVECS# + 1;

  14433  2 000434   000011 054000 xsym               AOS     FDS+9

      567    14434    2      ATTR_COUNT = ATTR_COUNT + 1;

  14434  2 000435   200006 235100                    LDA     ATTR_COUNT,,AUTO
         2 000436   000001 035007                    ADLA    1,DL
         2 000437   200006 755100                    STA     ATTR_COUNT,,AUTO

      568    14435    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);

  14435  2 000440   000011 236000 xsym               LDQ     FDS+9
         2 000441   000001 736000                    QLS     1
         2 000442   000000 620006                    EAX0    0,QL
         2 000443   000000 621006                    EAX1    0,QL
         2 000444   000044 237000 3                  LDAQ    36
         2 000445   000000 755010 xsym               STA     FMT_VEC,X0
         2 000446   000001 756011 xsym               STQ     FMT_VEC+1,X1

      569    14436    2      FDS.NVECS# = FDS.NVECS# + 1;

  14436  2 000447   000011 054000 xsym               AOS     FDS+9

      570    14437    2      END;

      571    14438
      572    14439    1   IF ((FS$CHARSET.ATTRS & %ATTR_TRANSLGL#) = %ATTR_TRANSLGL#)

  14439  2 000450   100074 220100                    LDX0    60,,PR1
         2 000451   000200 360003                    ANX0    128,DU
         2 000452   000200 100003                    CMPX0   128,DU
         2 000453   000477 601000 2                  TNZ     s:14448

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:92   
      573    14440    2   THEN DO;

      574    14441    2      FMT_VEC(FDS.NVECS#) = VECTOR(TRANSLGL_STR);

  14441  2 000454   000011 235000 xsym               LDA     FDS+9
         2 000455   000001 735000                    ALS     1
         2 000456   000000 620005                    EAX0    0,AL
         2 000457   000000 621005                    EAX1    0,AL
         2 000460   000050 237000 3                  LDAQ    40
         2 000461   000000 755010 xsym               STA     FMT_VEC,X0
         2 000462   000001 756011 xsym               STQ     FMT_VEC+1,X1

      575    14442    2      FDS.NVECS# = FDS.NVECS# + 1;

  14442  2 000463   000011 054000 xsym               AOS     FDS+9

      576    14443    2      ATTR_COUNT = ATTR_COUNT + 1;

  14443  2 000464   200006 235100                    LDA     ATTR_COUNT,,AUTO
         2 000465   000001 035007                    ADLA    1,DL
         2 000466   200006 755100                    STA     ATTR_COUNT,,AUTO

      577    14444    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);

  14444  2 000467   000011 236000 xsym               LDQ     FDS+9
         2 000470   000001 736000                    QLS     1
         2 000471   000000 620006                    EAX0    0,QL
         2 000472   000000 621006                    EAX1    0,QL
         2 000473   000044 237000 3                  LDAQ    36
         2 000474   000000 755010 xsym               STA     FMT_VEC,X0
         2 000475   000001 756011 xsym               STQ     FMT_VEC+1,X1

      578    14445    2      FDS.NVECS# = FDS.NVECS# + 1;

  14445  2 000476   000011 054000 xsym               AOS     FDS+9

      579    14446    2      END;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:93   

      580    14447
      581    14448    1   IF ((FS$CHARSET.ATTRS & %ATTR_TRUOVRPRT#) = %ATTR_TRUOVRPRT#)

  14448  2 000477   100074 220100                    LDX0    60,,PR1
         2 000500   000010 360003                    ANX0    8,DU
         2 000501   000010 100003                    CMPX0   8,DU
         2 000502   000526 601000 2                  TNZ     s:14457

      582    14449    2   THEN DO;

      583    14450    2      FMT_VEC(FDS.NVECS#) = VECTOR(OVERPRINT_STR);

  14450  2 000503   000011 235000 xsym               LDA     FDS+9
         2 000504   000001 735000                    ALS     1
         2 000505   000000 620005                    EAX0    0,AL
         2 000506   000000 621005                    EAX1    0,AL
         2 000507   000052 237000 3                  LDAQ    42
         2 000510   000000 755010 xsym               STA     FMT_VEC,X0
         2 000511   000001 756011 xsym               STQ     FMT_VEC+1,X1

      584    14451    2      FDS.NVECS# = FDS.NVECS# + 1;

  14451  2 000512   000011 054000 xsym               AOS     FDS+9

      585    14452    2      ATTR_COUNT = ATTR_COUNT + 1;

  14452  2 000513   200006 235100                    LDA     ATTR_COUNT,,AUTO
         2 000514   000001 035007                    ADLA    1,DL
         2 000515   200006 755100                    STA     ATTR_COUNT,,AUTO

      586    14453    2      FMT_VEC(FDS.NVECS#) = VECTOR (COMMA_STR);

  14453  2 000516   000011 236000 xsym               LDQ     FDS+9
         2 000517   000001 736000                    QLS     1
         2 000520   000000 620006                    EAX0    0,QL
         2 000521   000000 621006                    EAX1    0,QL
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:94   
         2 000522   000044 237000 3                  LDAQ    36
         2 000523   000000 755010 xsym               STA     FMT_VEC,X0
         2 000524   000001 756011 xsym               STQ     FMT_VEC+1,X1

      587    14454    2      FDS.NVECS# = FDS.NVECS# + 1;

  14454  2 000525   000011 054000 xsym               AOS     FDS+9

      588    14455    2      END;

      589    14456
      590    14457    1   IF ATTR_COUNT > 0 THEN

  14457  2 000526   200006 235100                    LDA     ATTR_COUNT,,AUTO
         2 000527   000537 600000 2                  TZE     s:14462

      591    14458    1      FMT_VEC (FDS.NVECS# - 1) = VECTOR (BL_STR);  /*  To remove the last comma  */

  14458  2 000530   000011 236000 xsym               LDQ     FDS+9
         2 000531   000001 736000                    QLS     1
         2 000532   000000 620006                    EAX0    0,QL
         2 000533   000000 621006                    EAX1    0,QL
         2 000534   000054 237000 3                  LDAQ    44
         2 000535   777776 755010 xsym               STA     FMT_VEC-2,X0
         2 000536   777777 756011 xsym               STQ     FMT_VEC-1,X1

      592    14459        /*
      593    14460             Print out chain image
      594    14461        */
      595    14462    1   FMT_VEC (FDS.NVECS#) = VECTOR (IMAGE_STR);

  14462  2 000537   000011 235000 xsym               LDA     FDS+9
         2 000540   000001 735000                    ALS     1
         2 000541   000000 620005                    EAX0    0,AL
         2 000542   000000 621005                    EAX1    0,AL
         2 000543   000056 237000 3                  LDAQ    46
         2 000544   000000 755010 xsym               STA     FMT_VEC,X0
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:95   
         2 000545   000001 756011 xsym               STQ     FMT_VEC+1,X1

      596    14463    1   FDS.NVECS# = FDS.NVECS# + 1;

  14463  2 000546   000011 054000 xsym               AOS     FDS+9

      597    14464    2   DO I= 0 TO 9;

  14464  2 000547   200004 450100                    STZ     I,,AUTO

      598    14465    2      FMT_VEC(FDS.NVECS#) = VECTOR (SET_STR(I));

  14465  2 000550   000011 235000 xsym               LDA     FDS+9
         2 000551   000001 735000                    ALS     1
         2 000552   000000 620005                    EAX0    0,AL
         2 000553   777640 235007                    LDA     -96,DL
         2 000554   200004 236100                    LDQ     I,,AUTO
         2 000555   000022 736000                    QLS     18
         2 000556   000025 036000 3                  ADLQ    21
         2 000557   000000 755010 xsym               STA     FMT_VEC,X0
         2 000560   000001 756010 xsym               STQ     FMT_VEC+1,X0

      599    14466    2      SET$ = ADDR (FS$CHARSET.SETS(I));

  14466  2 000561   200004 236100                    LDQ     I,,AUTO
         2 000562   000006 402003                    MPY     6,DU
         2 000563   000000 036000 xsym               ADLQ    DSEG1$
         2 000564   200142 756100                    STQ     SET$,,AUTO

      600    14467    2      TEMP$ = ADDR (TEMP_SET(I));

  14467  2 000565   200004 236100                    LDQ     I,,AUTO
         2 000566   000011 402007                    MPY     9,DL
         2 000567   200007 630506                    EPPR0   TEMP_SET,QL,AUTO
         2 000570   200141 450500                    STP0    TEMP$,,AUTO

      601    14468    3      DO K = 0 TO 23;
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:96   

  14468  2 000571   200005 450100                    STZ     K,,AUTO

      602    14469    3         TEMP$->ACHAR = SET$->ACHAR;

  14469  2 000572   200142 470500                    LDP0    SET$,,AUTO
         2 000573   200141 471500                    LDP1    TEMP$,,AUTO
         2 000574   040100 100500                    MLR     fill='040'O
         2 000575   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000576   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      603    14470    4         IF TEMP$->ACHAR = '''' AND JCL THEN DO;

  14470  2 000577   040000 106500                    CMPC    fill='040'O
         2 000600   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1
         2 000601   000060 000001 3                  ADSC9   48                       cn=0,n=1
         2 000602   000617 601000 2                  TNZ     s:14474
         2 000603   200003 473500                    LDP3    @JCL,,AUTO
         2 000604   000000 066500                    CMPB    filb='0'B
         2 000605   300000 000001                    BDSC    0,,PR3                   by=0,bit=0,n=1
         2 000606   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000607   000617 600000 2                  TZE     s:14474

      604    14471    4            TEMP$ = PINCRC(TEMP$,1);

  14471  2 000610   200141 236100                    LDQ     TEMP$,,AUTO
         2 000611   200000 036007                    ADLQ    65536,DL
         2 000612   200141 756100                    STQ     TEMP$,,AUTO

      605    14472    4            TEMP$->ACHAR = SET$->ACHAR;

  14472  2 000613   200141 471500                    LDP1    TEMP$,,AUTO
         2 000614   040100 100500                    MLR     fill='040'O
         2 000615   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 000616   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      606    14473    4            END;   /*  Have a single quote  */
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:97   

      607    14474    3         TEMP$ = PINCRC(TEMP$,1);

  14474  2 000617   200141 236100                    LDQ     TEMP$,,AUTO
         2 000620   200000 036007                    ADLQ    65536,DL
         2 000621   200141 756100                    STQ     TEMP$,,AUTO

      608    14475    3         SET$ = PINCRC(SET$,1);

  14475  2 000622   200142 236100                    LDQ     SET$,,AUTO
         2 000623   200000 036007                    ADLQ    65536,DL
         2 000624   200142 756100                    STQ     SET$,,AUTO

      609    14476    3         END;   /*  Do k  */

  14476  2 000625   200005 235100                    LDA     K,,AUTO
         2 000626   000001 035007                    ADLA    1,DL
         2 000627   200005 755100                    STA     K,,AUTO
         2 000630   000030 115007                    CMPA    24,DL
         2 000631   000572 602000 2                  TNC     s:14469

      610    14477    2     FMT_VEC(FDS.NVECS#+1) = VECTOR (SUBSTR(TEMP_SET(I),0,POFFC(TEMP$,ADDR(TEMP_SET(I)
             14477               ))));

  14477  2 000632   000011 235000 xsym               LDA     FDS+9
         2 000633   000001 735000                    ALS     1
         2 000634   200144 452500                    STP2    SET$+2,,AUTO
         2 000635   200004 236100                    LDQ     I,,AUTO
         2 000636   000000 620005                    EAX0    0,AL
         2 000637   000011 402003                    MPY     9,DU
         2 000640   000007 036003                    ADLQ    7,DU
         2 000641   200144 036100                    ADLQ    SET$+2,,AUTO
         2 000642   000020 772000                    QRL     16
         2 000643   200145 756100                    STQ     SET$+3,,AUTO
         2 000644   200141 236100                    LDQ     TEMP$,,AUTO
         2 000645   000020 772000                    QRL     16
         2 000646   200145 136100                    SBLQ    SET$+3,,AUTO
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:98   
         2 000647   000064 737000                    LLS     52
         2 000650   000140 135007                    SBLA    96,DL
         2 000651   200146 452500                    STP2    SET$+4,,AUTO
         2 000652   200004 236100                    LDQ     I,,AUTO
         2 000653   200147 755100                    STA     SET$+5,,AUTO
         2 000654   000011 402003                    MPY     9,DU
         2 000655   000007 036003                    ADLQ    7,DU
         2 000656   200146 036100                    ADLQ    SET$+4,,AUTO
         2 000657   200147 235100                    LDA     SET$+5,,AUTO
         2 000660   000002 755010 xsym               STA     FMT_VEC+2,X0
         2 000661   000003 756010 xsym               STQ     FMT_VEC+3,X0

      611    14478    2      FDS.NVECS# = FDS.NVECS# + 2;

  14478  2 000662   000002 236007                    LDQ     2,DL
         2 000663   000011 056000 xsym               ASQ     FDS+9

      612    14479    2      END;

  14479  2 000664   200004 235100                    LDA     I,,AUTO
         2 000665   000001 035007                    ADLA    1,DL
         2 000666   200004 755100                    STA     I,,AUTO
         2 000667   000012 115007                    CMPA    10,DL
         2 000670   000550 602000 2                  TNC     s:14465

      613    14480    1   CALL X$FORMAT (FDS);

  14480  2 000671   000061 630400 3                  EPPR0   49
         2 000672   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000673   000000 701000 xent               TSX1    X$FORMAT
         2 000674   000000 011000                    NOP     0

      614    14481    1   END ASL$DISP_ONE_CHARSET;

  14481  2 000675   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:99   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_CHARSET.
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:100  

 **** Variables and constants ****

  ****  Section 001 RoData ASL$DISP_ONE_CHARSET

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    44-0-0/c CHAR(3)     r     1 APL_STR                   10-0-0/c CHAR(9)     r     1 ATTRIBUTE_STR
    13-0-0/c CHAR(3)     r     1 BIN_STR                    0-0-0/c CHAR        r     1 BL_STR
     1-0-0/c CHAR(7)     r     1 CHARSET_STR               60-0-0/c CHAR(2)     r     1 COMMA_STR
    25-0-0/c CHAR(7)     r     1 DEVICES_STR              106-0-0/c CHAR(75)    r     1 DISP_FMT
     6-0-0/c CHAR(5)     r     1 ELSOK_STR                 21-0-0/c CHAR(5)     r     1 IMAGE_STR
    61-0-0/c CHAR(82)    r     1 JCL_FMT                   55-0-0/c CHAR(9)     r     1 LOWERCASE_STR
     3-0-0/c CHAR(4)     r     1 LPOK_STR                   5-0-0/c CHAR(4)     r     1 LTYP_STR
    43-0-0/c CHAR(4)     r     1 NATL_STR                  41-0-0/c CHAR(7)     r     1 NOXLATE_STR
    24-0-0/c CHAR(2)     r     1 NO_STR                    16-0-0/c CHAR(9)     r     1 OVERPRINT_STR
    27-0-0/c CHAR(4)     r     1 SET_STR(0:9)
    14-0-0/c CHAR(8)     r     1 TRANSLGL_STR               4-0-0/c CHAR(4)     r     1 TSOK_STR
    52-0-0/c CHAR(9)     r     1 UPPERCASE_STR             45-0-0/c CHAR(19)    r     1 UPPER_LOWER_STR
    23-0-0/c CHAR(3)     r     1 YES_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JCL                       6-0-0/w UBIN        r     1 ATTR_COUNT
     4-0-0/w UBIN        r     1 I                         *0-0-0/b BIT         r     1 JCL
     5-0-0/w UBIN        r     1 K                        142-0-0/w PTR         r     1 SET$
   141-0-0/w PTR         r     1 TEMP$
     7-0-0/c CHAR        r     1 TEMP_SET(0:9)

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:101  
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 ACHAR                      0-0-0/w STRC(2232)  r     1 FS$CHARSET


   Procedure ASL$DISP_ONE_CHARSET requires 446 words for executable code.
   Procedure ASL$DISP_ONE_CHARSET requires 104 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_CHARSETS.:E05TSI    .
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:102  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:103  
          MINI XREF LISTING

ACHAR
     14233**DCL     14469<<ASSIGN  14469>>ASSIGN  14470>>IF      14472<<ASSIGN  14472>>ASSIGN
APL_STR
     14273**DCL     14405--ASSIGN
ASA_BRKS_LOC
     11337**DCL     11337--REDEF
AS_DEFAULT.BANNER_PERM
     12030**DCL     12031--REDEF
AS_DEFAULT.BUDGET.MACCT
     11935**DCL     11939--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11948**DCL     11951--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11931**DCL     11933--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11926**DCL     11928--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12046**DCL     12047--REDEF   12048--REDEF
AS_DEFAULT_DREC.PASSWORD
     13300**DCL     13304--REDEF
AS_DEFAULT_DREC.RENAME
     13323**DCL     13324--REDEF
AS_DFLT.BANNER_PERM
     11852**DCL     11853--REDEF
AS_DFLT.BUDGET.MACCT
     11757**DCL     11761--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11770**DCL     11773--REDEF
AS_DFLT.BUDGET.PACCUM
     11753**DCL     11755--REDEF
AS_DFLT.BUDGET.PMAXC
     11748**DCL     11750--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:104  
AS_DFLT.SETUP_CHRA.TXT
     11868**DCL     11869--REDEF   11870--REDEF
AS_FE_MODE
     11203**DCL     11204--REDEF
AS_MODE
     11200**DCL     11202--REDEF
AS_MOD_USER.ACCESS
     14065**DCL     14066--REDEF
AS_MOD_USER.BANNER
     14052**DCL     14053--REDEF
AS_MOD_USER.BANNER_PERM
     14054**DCL     14055--REDEF
AS_MOD_USER.BILL
     14060**DCL     14061--REDEF
AS_MOD_USER.CPROC
     14056**DCL     14057--REDEF
AS_MOD_USER.FEBILL
     14136**DCL     14137--REDEF
AS_MOD_USER.FECXTMEM
     14153**DCL     14154--REDEF
AS_MOD_USER.FEMINTS
     14138**DCL     14139--REDEF
AS_MOD_USER.FEMMEM
     14149**DCL     14150--REDEF
AS_MOD_USER.FEMTIME
     14147**DCL     14148--REDEF
AS_MOD_USER.FEPPRIV
     14144**DCL     14146--REDEF
AS_MOD_USER.FEPRIV
     14141**DCL     14143--REDEF
AS_MOD_USER.FORCE_BIT
     14050**DCL     14051--REDEF
AS_MOD_USER.KEY
     14132**DCL     14134--REDEF
AS_MOD_USER.LASTCPROC
     14058**DCL     14059--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:105  
AS_MOD_USER.LIMITS.DO_
     14106**DCL     14107--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14122**DCL     14123--REDEF
AS_MOD_USER.LIMITS.LO
     14102**DCL     14103--REDEF
AS_MOD_USER.LIMITS.MEM
     14098**DCL     14099--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14126**DCL     14127--REDEF
AS_MOD_USER.LIMITS.PDIS
     14114**DCL     14115--REDEF
AS_MOD_USER.LIMITS.PO
     14110**DCL     14111--REDEF
AS_MOD_USER.LIMITS.TDIS
     14118**DCL     14119--REDEF
AS_MOD_USER.LIMITS.TIME
     14094**DCL     14095--REDEF
AS_MOD_USER.MAXENQ
     14075**DCL     14076--REDEF
AS_MOD_USER.PERM_BIT
     14048**DCL     14049--REDEF
AS_MOD_USER.PPRIV
     14070**DCL     14072--REDEF
AS_MOD_USER.PRIOB
     14077**DCL     14078--REDEF
AS_MOD_USER.PRIV
     14067**DCL     14069--REDEF
AS_MOD_USER.QUAN
     14073**DCL     14074--REDEF
AS_MOD_USER.SETUP
     14046**DCL     14047--REDEF
AS_PROJECT.BANNER_PERM
     12386**DCL     12387--REDEF
AS_PROJECT.BUDGET.MACCT
     12291**DCL     12295--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:106  
AS_PROJECT.BUDGET.MAX_PROJECTS
     12304**DCL     12307--REDEF
AS_PROJECT.BUDGET.PACCUM
     12287**DCL     12289--REDEF
AS_PROJECT.BUDGET.PMAXC
     12282**DCL     12284--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12402**DCL     12403--REDEF   12404--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12564**DCL     12565--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12469**DCL     12473--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12482**DCL     12485--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12465**DCL     12467--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12460**DCL     12462--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12580**DCL     12581--REDEF   12582--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13786**DCL     13790--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13809**DCL     13810--REDEF
AS_PROJECT_DREC.PASSWORD
     13624**DCL     13628--REDEF
AS_PROJECT_DREC.RENAME
     13647**DCL     13648--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12208**DCL     12209--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12113**DCL     12117--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12126**DCL     12129--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12109**DCL     12111--REDEF
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:107  
AS_PROJ_ADMIN.BUDGET.PMAXC
     12104**DCL     12106--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12224**DCL     12225--REDEF   12226--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13462**DCL     13466--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13485**DCL     13486--REDEF
AS_USERS.BANNER_PERM
     11674**DCL     11675--REDEF
AS_USERS.BUDGET.MACCT
     11579**DCL     11583--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11592**DCL     11595--REDEF
AS_USERS.BUDGET.PACCUM
     11575**DCL     11577--REDEF
AS_USERS.BUDGET.PMAXC
     11570**DCL     11572--REDEF
AS_USERS.SETUP_CHRA.TXT
     11690**DCL     11691--REDEF   11692--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12742**DCL     12743--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12647**DCL     12651--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12660**DCL     12663--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12643**DCL     12645--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12638**DCL     12640--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12758**DCL     12759--REDEF   12760--REDEF
ATTRIBUTE_STR
     14252**DCL     14387--ASSIGN
ATTR_COUNT
     14239**DCL     14390<<ASSIGN  14391--ASSIGN  14396<<ASSIGN  14401<<ASSIGN  14406<<ASSIGN  14412<<ASSIGN
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:108  
     14417<<ASSIGN  14422<<ASSIGN  14424>>IF      14434<<ASSIGN  14434>>ASSIGN  14443<<ASSIGN  14443>>ASSIGN
     14452<<ASSIGN  14452>>ASSIGN  14457>>IF
BIN_STR
     14253**DCL     14432--ASSIGN
BL_STR
     14246**DCL     14458--ASSIGN
CHARSET_STR
     14247**DCL     14336--ASSIGN
COMMA_STR
     14277**DCL     14426--ASSIGN  14435--ASSIGN  14444--ASSIGN  14453--ASSIGN
DEVICES_STR
     14259**DCL     14342--ASSIGN
DISP_FMT
     14280**DCL     14329>>ASSIGN  14330--ASSIGN
DSEG1$
     11338**DCL     14211--IMP-PTR 14345>>IF      14355>>IF      14365>>IF      14375>>IF      14377>>ASSIGN
     14393>>IF      14398>>IF      14403>>IF      14408>>IF      14408>>IF      14414>>IF      14419>>IF
     14430>>IF      14439>>IF      14448>>IF      14466>>ASSIGN
ELSOK_STR
     14251**DCL     14364--ASSIGN
ERR_CODE
     11332**DCL     11333--REDEF
FDS
     11229**DCL     14480<>CALL
FDS.FMT_.BOUND
     11234**DCL     14326<<ASSIGN  14330<<ASSIGN
FDS.NVECS#
     11257**DCL     14332<<ASSIGN  14336>>ASSIGN  14337>>ASSIGN  14338<<ASSIGN  14338>>ASSIGN  14342>>ASSIGN
     14343<<ASSIGN  14343>>ASSIGN  14344>>ASSIGN  14347>>ASSIGN  14350>>ASSIGN  14352<<ASSIGN  14352>>ASSIGN
     14354>>ASSIGN  14357>>ASSIGN  14360>>ASSIGN  14362<<ASSIGN  14362>>ASSIGN  14364>>ASSIGN  14367>>ASSIGN
     14370>>ASSIGN  14372<<ASSIGN  14372>>ASSIGN  14374>>ASSIGN  14377>>ASSIGN  14380>>ASSIGN  14382<<ASSIGN
     14382>>ASSIGN  14387>>ASSIGN  14388<<ASSIGN  14388>>ASSIGN  14391>>ASSIGN  14392<<ASSIGN  14392>>ASSIGN
     14395>>ASSIGN  14400>>ASSIGN  14405>>ASSIGN  14411>>ASSIGN  14416>>ASSIGN  14421>>ASSIGN  14425<<ASSIGN
     14425>>ASSIGN  14426>>ASSIGN  14427<<ASSIGN  14427>>ASSIGN  14432>>ASSIGN  14433<<ASSIGN  14433>>ASSIGN
     14435>>ASSIGN  14436<<ASSIGN  14436>>ASSIGN  14441>>ASSIGN  14442<<ASSIGN  14442>>ASSIGN  14444>>ASSIGN
     14445<<ASSIGN  14445>>ASSIGN  14450>>ASSIGN  14451<<ASSIGN  14451>>ASSIGN  14453>>ASSIGN  14454<<ASSIGN
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:109  
     14454>>ASSIGN  14458>>ASSIGN  14462>>ASSIGN  14463<<ASSIGN  14463>>ASSIGN  14465>>ASSIGN  14477>>ASSIGN
     14478<<ASSIGN  14478>>ASSIGN
FMT_BUF
     11328**DCL     14325<<ASSIGN  14329<<ASSIGN
FMT_VEC
     11328**DCL     14336<<ASSIGN  14337<<ASSIGN  14342<<ASSIGN  14344<<ASSIGN  14347<<ASSIGN  14350<<ASSIGN
     14354<<ASSIGN  14357<<ASSIGN  14360<<ASSIGN  14364<<ASSIGN  14367<<ASSIGN  14370<<ASSIGN  14374<<ASSIGN
     14377<<ASSIGN  14380<<ASSIGN  14387<<ASSIGN  14391<<ASSIGN  14395<<ASSIGN  14400<<ASSIGN  14405<<ASSIGN
     14411<<ASSIGN  14416<<ASSIGN  14421<<ASSIGN  14426<<ASSIGN  14432<<ASSIGN  14435<<ASSIGN  14441<<ASSIGN
     14444<<ASSIGN  14450<<ASSIGN  14453<<ASSIGN  14458<<ASSIGN  14462<<ASSIGN  14465<<ASSIGN  14477<<ASSIGN
FS$CHARSET.ATTRS
     14223**DCL     14393>>IF      14398>>IF      14403>>IF      14408>>IF      14408>>IF      14414>>IF
     14419>>IF      14430>>IF      14439>>IF      14448>>IF
FS$CHARSET.LGLTYPS.ELSOK
     14227**DCL     14365>>IF
FS$CHARSET.LGLTYPS.LPOK
     14225**DCL     14345>>IF
FS$CHARSET.LGLTYPS.LTYP
     14230**DCL     14377--ASSIGN
FS$CHARSET.LGLTYPS.ONEOK
     14228**DCL     14375>>IF
FS$CHARSET.LGLTYPS.TSOK
     14226**DCL     14355>>IF
FS$CHARSET.SETS
     14212**DCL     14222--REDEF   14466--ASSIGN
I
     14237**DCL     14464<<DOINDEX 14465>>ASSIGN  14466>>ASSIGN  14467>>ASSIGN  14477>>ASSIGN  14477>>ASSIGN
IMAGE_STR
     14256**DCL     14462--ASSIGN
JCL
     14193**DCL        11--PROC    14324>>IF      14470>>IF
JCL_FMT
     14278**DCL     14325>>ASSIGN  14326--ASSIGN
K
     14238**DCL     14468<<DOINDEX
KL_DEFAULT.PASSWORD
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:110  
     13948**DCL     13952--REDEF
KL_DEFAULT.RENAME
     13971**DCL     13972--REDEF
KL_DFLT.PASSWORD
     13138**DCL     13142--REDEF
KL_DFLT.RENAME
     13161**DCL     13162--REDEF
KL_DREC.PASSWORD
     12976**DCL     12980--REDEF
KL_DREC.RENAME
     12999**DCL     13000--REDEF
KL_DREC_CNT.PASSWORD
     12863**DCL     12867--REDEF
KL_DREC_CNT.RENAME
     12886**DCL     12887--REDEF
LOWERCASE_STR
     14276**DCL     14421--ASSIGN
LPOK_STR
     14248**DCL     14344--ASSIGN
LTYP_STR
     14250**DCL     14374--ASSIGN
NATL_STR
     14272**DCL     14400--ASSIGN
NOXLATE_STR
     14271**DCL     14395--ASSIGN
NO_STR
     14258**DCL     14350--ASSIGN  14360--ASSIGN  14370--ASSIGN  14380--ASSIGN
OVERPRINT_STR
     14255**DCL     14450--ASSIGN
PROJ_KEY.TEXT
     11210**DCL     11210--REDEF
PROJ_KEY.TXT.PROJECT
     11210**DCL     11210--REDEF
REMEM_VAR
     11336**DCL     11336--REDEF
REM_FCMD
PL6.E3A0      #002=ASL$DISP_ONE_CHARSET File=ASL$LIST_CHARSETS.:E05TSI           TUE 07/29/97 10:04 Page:111  
     11336**DCL     11337--REDEF
SET$
     14242**DCL     14466<<ASSIGN  14469>>ASSIGN  14472>>ASSIGN  14475<<ASSIGN  14475>>ASSIGN
SET_STR
     14260**DCL     14465--ASSIGN
TEMP$
     14241**DCL     14467<<ASSIGN  14469>>ASSIGN  14470>>IF      14471<<ASSIGN  14471>>ASSIGN  14472>>ASSIGN
     14474<<ASSIGN  14474>>ASSIGN  14477>>ASSIGN
TEMP_SET
     14240**DCL     14467--ASSIGN  14477--ASSIGN  14477--ASSIGN
TRANSLGL_STR
     14254**DCL     14441--ASSIGN
TSOK_STR
     14249**DCL     14354--ASSIGN
UPPERCASE_STR
     14275**DCL     14416--ASSIGN
UPPER_LOWER_STR
     14274**DCL     14411--ASSIGN
USERS_KEY.COUNT
     11207**DCL     14337>>ASSIGN
USERS_KEY.TEXT
     11207**DCL     11208--REDEF   11208--REDEF   11208--REDEF   11209--REDEF
USERS_KEY.TXTC
     11208**DCL     14337--ASSIGN
X$FORMAT
     14197**DCL-ENT 14480--CALL
YES_STR
     14257**DCL     14347--ASSIGN  14357--ASSIGN  14367--ASSIGN
