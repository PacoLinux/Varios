VERSION E05

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:1    
        1        1        /*M* Display Scheduler State Queues.                                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*                                                                    */
        8        8        /*D* NAME: DAD$SCHED
        9        9             CALL: CALL DAD$SCHED;
       10       10             DESCRIPTION: This routine displays the user number of each user
       11       11                in each Scheduler State Queue in the order in which they are
       12       12                linked through B$U.FL in the User Tables.
       13       13                                                                              */
       14       14        /*                                                                    */
       15       15        DAD$SCHED: PROC;
       16       16        /*                                                                    */
       17       17        %INCLUDE DA_FORMAT_C;
       18      259        %INCLUDE DA_MONSYM_C;
       19      310        %REPORT (NAME=SCHDRPRT,TITLE='SCHEDULER TABLES',HEADER=NO);
       20      376        %INCLUDE SS_SCHED_C;
       21      609        %INCLUDE B$USER;
       22      825        %B$USERREFS;
       23      829        %INCLUDE B$OBJECT_C;
       24     4259        %B$SDEF;
       25     4313        %S_STATE (FPTN=S);
       26     4345        %S_RSTATE (FPTN=R);
       27     4358        /*                                                                    */
       28     4359    1   DCL DAS$SDMONPTR ENTRY(2) ALTRET;
       29     4360    1   DCL DAM$MAP ENTRY(5) ALTRET;
       30     4361    1   DCL DAF$WRITE EPTR SYMREF;
       31     4362    1   DCL DAF$INIT ENTRY(1) ALTRET;
       32     4363    1   DCL DAF$NEWPAGE ENTRY;
       33     4364    1   DCL SFMAT STATIC CHAR(0) INIT(' %4A %14(%Q >%Z3O%)');
       34     4365    1   DCL ERRFMT STATIC CHAR(0) INIT('      LINK ERROR; TAIL= %Z3O');
       35     4366    1   DCL B$IS$ PTR SYMREF;
       36     4367    1   DCL DA_MONISDATA BIT(72) SYMREF;
       37     4368    1   DCL P$ PTR;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:2    
       38     4369    1   DCL U UBIN;
       39     4370    1   DCL FL UBIN;
       40     4371    1   DCL QUEUE(0:%SS_SNULL) UBIN BASED;
       41     4372    1   DCL 1 HQ STATIC,
       42     4373    1         2 * UBIN(18) INIT(%SS_SNULL) UNAL,
       43     4374    1         2 * BIT(18) INIT('600000'O) UNAL,
       44     4375    1         2 P$ PTR UNAL;
       45     4376    1   DCL 1 TQ STATIC,
       46     4377    1         2 * UBIN(18) INIT(%SS_SNULL) UNAL,
       47     4378    1         2 * BIT(18) INIT('600000'O) UNAL,
       48     4379    1         2 P$ PTR UNAL;
       49     4380    1   DCL 1 NV STATIC,
       50     4381    1         2 CT UBIN(18) UNAL,
       51     4382    1         2 * UBIN(2) INIT(3) UNAL,
       52     4383    1         2 * UBIN(16) INIT(0) UNAL,
       53     4384    1         2 * PTR INIT(ADDR(N)) UNAL;
       54     4385    1   DCL N(0:13) UBIN STATIC;
       55     4386    1   DCL SNAME CHAR(4);
       56     4387    1   DCL STATE UBIN;
       57     4388    1   DCL RESOURCE SBIN;
       58     4389    1   DCL RQ$ PTR;
       59     4390    1   DCL I UBIN;
       60     4391    1   DCL NS UBIN;
       61     4392        /*
       62     4393                   REPORT FORMATS TITLES AND SUCH
       63     4394        */
       64     4395        %REPORT(NAME=EV_RPT, TITLE='EVENT AND CONNECT BUFFERS', HEADER=YES);
       65     4461        %HEADER(TEXTADR=HDR_NAMES, LAST=NO);
       66     4503        %HEADER(TEXTADR=HDR_HB,LAST=NO);
       67     4545        %HEADER(TEXTADR=HDR_ULINE);
       68     4587
       69     4588    1   DCL 1  HDR_NAMES  CONSTANT,
       70     4589    1         2 LEN   UBIN(9)  UNAL INIT(SIZEC(HDR_NAMES.TX)),
       71     4590    1         2 TX    CHAR(0)  INIT(
       72     4591    1        'E    USR   EVENT    STATE    PORT  TIME DIFFERENCE     TIME STAMP');
       73     4592    1   DCL 1  HDR_HB     CONSTANT,
       74     4593    1         2 LEN   UBIN(9)  UNAL INIT(SIZEC(HDR_HB.TX)),
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:3    
       75     4594    1         2 TX    CHAR(0)  INIT(
       76     4595    1        'C    IC    WSR      MLBX           IN REVERSE');
       77     4596    1   DCL 1  HDR_ULINE  CONSTANT,
       78     4597    1         2 LEN   UBIN(9)  UNAL INIT(SIZEC(HDR_ULINE.TX)),
       79     4598    1         2 TX    CHAR(0)  INIT(
       80     4599    1        '- -------  ------   -----   -----  ---------------  --------------');
       81     4600
       82     4601    1   DCL  EVENT_FORMAT  CONSTANT CHAR(0) INIT(
       83     4602    1        'E    .%Z3O  %A  %A      %1O    %12D     .%12ZO');
       84     4603    1   DCL  HB_FORMAT     CONSTANT CHAR(0) INIT(
       85     4604    1        'C .%Z6O  WSR%Z1O     %A    %1O    %12D     .%12ZO');
       86     4605        /*
       87     4606                   INDICIES, FLAGS, AND WORKING VARIABLES
       88     4607        */
       89     4608    1   DCL  EV_STOP_X         SBIN;
       90     4609        /*  EV_STOP_X IS INITIALIZED TO S_EVX - 1 AND WHEN EV_X
       91     4610            EQUALS EV_STOP_X THEN EV_END IS SET TRUE*/
       92     4611    1   DCL  EV_X              SBIN;
       93     4612        /*  EV_X  IS SET FROM S_EVX AND IS USED TO STEP THRU THE
       94     4613            EVENT BUFFER    */
       95     4614    1   DCL  EV_END            BIT(1);
       96     4615        /*  EV_END IS THE LOOP CONTROL IT STARTS AT '0'B AND IS SET AS
       97     4616            ABOVE TO EXIT THE LOOP  */
       98     4617
       99     4618    1   DCL  HB_X           SBIN;
      100     4619        /*  INDEX THRU THE CONNECT BUFFER  */
      101     4620    1   DCL  HB_STOP_X        SBIN;
      102     4621        /*  STOP INDEX FOR THE CONNECT BUFFER */
      103     4622    1   DCL  HB_END           BIT(1);
      104     4623        /*  END OF CONNECT PROCESSING FLAG  */
      105     4624
      106     4625    1   DCL  BASE_TIME        UBIN;
      107     4626    1   DCL  TIME_EV_DIF      UBIN;
      108     4627    1   DCL  TIME_HB_DIF      UBIN;
      109     4628    1   DCL  USR_NO           UBIN;             /* USER # FROM EVENT BUFFER           */
      110     4629    1   DCL  EVENT            CHAR(7);          /* FROM EVENT BUFFER                  */
      111     4630    1   DCL  STATE_C            CHAR(5);        /* FROM EVENT BUFFER                  */
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:4    
      112     4631    1   DCL  PORT             UBIN;             /* FROM EVENT BUFFER                  */
      113     4632    1   DCL  HB_IC           UBIN;              /*  FROM CONNECT BUFFER               */
      114     4633    1   DCL  HB_WSR          UBIN;              /*  FROM CONNECT BUFFER               */
      115     4634    1   DCL  HB_PORT         UBIN;              /*  FROM CONNECT BUFFER               */
      116     4635    1   DCL  HB_MLBX         CHAR(7);           /*  FROM CONNECT BUFFER               */
      117     4636
      118     4637
      119     4638        %EQU EVX_MAX=99;
      120     4639    1   DCL 1  EVINF  (0:%EVX_MAX)    BASED(EV_BUF$)  DALIGNED,
      121     4640    1         2 USR      UBIN BYTE UNAL,
      122     4641    1         2 EVNR     UBIN BYTE UNAL,
      123     4642    1         2 STATE    UBIN BYTE UNAL,
      124     4643    1         2 PORT     UBIN BYTE UNAL,
      125     4644    1         2 TIME     UBIN;
      126     4645        /*  NOTE THAT THE ABOVE STRUCTURE IS A COPY OF THE SAME IN
      127     4646            SSR$RUE AND MUST BE CHANGED AS IT CHANGES
      128     4647        */
      129     4648        %EQU HBX_MAX=15;
      130     4649    1   DCL 1  HBINF (0:%HBX_MAX) BASED(HB_BUF$) DALIGNED,
      131     4650    1         2 IC                         UBIN(18) UNAL,
      132     4651    1         2 WSR                        UBIN(3)  UNAL,
      133     4652    1         2 PORT                       UBIN(3)  UNAL,
      134     4653    1         2 MLBX                       UBIN(12)  UNAL,
      135     4654    1         2 TIME                       UBIN;
      136     4655        /*  NOTE THAT THE ABOVE STRUCTURE IS FROM HFB AND
      137     4656            MUST CHANGE AS IT CHANGES */
      138     4657
      139     4658
      140     4659    1   DCL  INTERIM$                      PTR;
      141     4660    1   DCL  EV_X$                         PTR; /* TO S_EVX                           */
      142     4661    1   DCL  S_EVX     UBIN BASED;
      143     4662    1   DCL  EV_BUF$                       PTR; /* TO S_EVBUF                         */
      144     4663    1   DCL  HB_X$                         PTR; /* TO H_CNCTEVX                       */
      145     4664    1   DCL  H_CNCTEVX                     UBIN BASED;
      146     4665    1   DCL  HB_BUF$                       PTR; /* TO H_CNCTEVBF                      */
      147     4666
      148     4667        /*
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:5    
      149     4668                      EVENT DEFINITIONS
      150     4669
      151     4670        */
      152     4671    1   DCL  EVENT_TABLE (0:99) CONSTANT CHAR(7) INIT(
      153     4672    1        'NEWUSR',
      154     4673    1        'IIP',
      155     4674    1        'IIPC',
      156     4675    1        'QMF',
      157     4676    1        'CRD',
      158     4677    1        'CIC',
      159     4678    1        'CICCU',
      160     4679    1        'CBL',
      161     4680    1        'CUB',
      162     4681    1        'CUBEX',
      163     4682    1        'CBK',
      164     4683    1        'CBKEX',
      165     4684    1        'CEC',
      166     4685    1        'CECEX',
      167     4686    1        'ERR',                             /*  ERRORED BY OPERATOR               */
      168     4687    1        'ERRBLK',
      169     4688    1        'ABRT',
      170     4689    1        'ABTBLK',
      171     4690    1        'CAN',
      172     4691    1        'CANBLK',
      173     4692    1        'DISC',
      174     4693    1        'DSCBLK',
      175     4694    1        'DISCX',
      176     4695    1        'WU',
      177     4696    1        'WUEX',
      178     4697    1        'SL',
      179     4698    1        'SLPMME',
      180     4699    1        'QA',
      181     4700    1        'UQA',
      182     4701    1        'QE',
      183     4702    1        'IOC',
      184     4703    1        'IOCU',
      185     4704    1        'DISPCP',
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:6    
      186     4705    1        'DU',
      187     4706    1        'AU',
      188     4707    1        'AP',
      189     4708    1        'MP',
      190     4709    1        'QC',
      191     4710    1        'UQC',
      192     4711    1        'CW',
      193     4712    1        'FC',
      194     4713    1        'FPLDTRC',
      195     4714    1        'IIPCA',
      196     4715    1        'FPEVNT',
      197     4716    1        'ILLEGAL'*18,
      198     4717    1        'CBF',
      199     4718    1        'CBA',
      200     4719    1        'NC',
      201     4720    1        'CA',
      202     4721    1        'NQW',
      203     4722    1        'NQR',
      204     4723    1        'NQP',
      205     4724    1        'QPA',
      206     4725    1        'ILLEGAL'*9,
      207     4726    1        'PARK',
      208     4727    1         'ILLEGAL'*19,
      209     4728    1         'SKIPUSR'
      210     4729    1        );
      211     4730        /*
      212     4731                      MAILBOX DEFINITIONS
      213     4732
      214     4733        */
      215     4734    1   DCL  MLBX_TABLE (0:32) CONSTANT CHAR(7) INIT(
      216     4735    1        'NOP',
      217     4736    1        'PAUSE',
      218     4737    1        'SCREECH',
      219     4738    1        'ILLEGAL',
      220     4739    1        'TIME',
      221     4740    1        'ILLEGAL'*3,
      222     4741    1        'MAKE',
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:7    
      223     4742    1        'ILLEGAL'*7,
      224     4743    1        'CLEAR',
      225     4744    1        'ILLEGAL'*15,
      226     4745    1        'RELIEF');
      227     4746        %EJECT;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:8    
      228     4747    1           CALL DAF$INIT(SCHDRPRT);
      229     4748    1           CALL DAS$SDMONPTR(%M#S_HQ,HQ.P$);
      230     4749    1           CALL DAS$SDMONPTR(%M#S_TQ,TQ.P$);
      231     4750    1           CALL DAS$SDMONPTR(%M#S_RQH,RQ$);
      232     4751    1           STATE = %SS_SC1;
      233     4752    1           RESOURCE = -1;
      234     4753    2           DO WHILE(STATE<=%SS_SNULL);
      235     4754    3              IF STATE = %SS_SQR AND RESOURCE ~= -1 THEN DO;
      236     4755    3                 CALL DAM$MAP(RQ$,P$,0,0,DA_MONISDATA) ALTRET(ERR);
      237     4756    3                 U=P$->QUEUE(RESOURCE);
      238     4757    3                 END;
      239     4758    3              ELSE DO;
      240     4759    3                 CALL DAM$MAP(HQ.P$,P$,0,0,DA_MONISDATA) ALTRET(ERR);
      241     4760    3                 U=P$->QUEUE(STATE);
      242     4761    3                 END;
      243     4762    2              NS=0;
      244     4763    2              IF U ~= 0 THEN
      245     4764    3              DO;
      246     4765    3                 IF STATE = %SS_SQR AND RESOURCE ~= -1 THEN
      247     4766    3                    SNAME=R(RESOURCE);
      248     4767    3                 ELSE
      249     4768    3                    SNAME=S(STATE);
      250     4769    4   NXTL:         DO I = 0 TO 13;
      251     4770    4                    N(I)=U;
      252     4771    4                    NS=NS+1;
      253     4772    4                    IF NS > 511 THEN
      254     4773    4                       GOTO LASTU;
      255     4774    4                    IF STATE = %SS_SQR AND RESOURCE ~= -1 THEN
      256     4775    4                       FL = B$USRT$->B$USER.SQ(U);
      257     4776    4                    ELSE
      258     4777    4                       FL = B$USRT$->B$USER.FL(U);
      259     4778    4                    IF FL = 0 THEN
      260     4779    4                       GOTO LASTU;
      261     4780    4                    U=FL;
      262     4781    4                    END;
      263     4782    3                 CALL DAF$WRITE(VECTOR(SFMAT),VECTOR(SNAME),VECTOR(N));
      264     4783    3                 SNAME='    ';
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:9    
      265     4784    3                 GOTO NXTL;
      266     4785    3   LASTU:        NV.CT=I;
      267     4786    3                 CALL DAF$WRITE(VECTOR(SFMAT),VECTOR(SNAME),NV);
      268     4787    4                 IF STATE ~= %SS_SQR OR RESOURCE = -1 THEN DO;
      269     4788    4                    CALL DAM$MAP(TQ.P$,P$,0,0,DA_MONISDATA) ALTRET(ERR);
      270     4789    4                    IF U ~= P$->QUEUE(STATE) OR NS > 511 THEN
      271     4790    4                       CALL DAF$WRITE(VECTOR(ERRFMT),VECTOR(P$->QUEUE(STATE)));
      272     4791    4                    END;
      273     4792    3                 END;
      274     4793    2              IF STATE = %SS_SQR AND RESOURCE < SIZEW(R) THEN
      275     4794    2                 RESOURCE = RESOURCE + 1;
      276     4795    2              ELSE
      277     4796    2                 STATE = STATE + 1;
      278     4797    2              END;
      279     4798    1   ERR:    RETURN;
      280     4799        %EJECT;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:10   
      281     4800    1   DAD$EVBUF:ENTRY;
      282     4801        /*D*  THIS ENTRY FORMATS THE SCHEDULER EVENT BUFFER
      283     4802              AND THE CONNECT BUFFER   */
      284     4803    1           EV_END = '0'B;
      285     4804    1           HB_END = '0'B;
      286     4805    1           CALL DAF$INIT(EV_RPT);
      287     4806    1           CALL DAS$SDMONPTR(%M#S_EVX, INTERIM$) ALTRET(NO_EVX);
      288     4807    1           CALL DAM$MAP(INTERIM$, EV_X$,,,DA_MONISDATA) ALTRET(BAD_EVX_MAP);
      289     4808    1           EV_STOP_X = EV_X$->S_EVX;
      290     4809    1           IF EV_STOP_X>%EVX_MAX THEN EV_STOP_X=%EVX_MAX;
      291     4810    1           IF EV_STOP_X = 0 THEN EV_X = 99;
      292     4811    1           ELSE EV_X = EV_STOP_X - 1;
      293     4812
      294     4813    1           CALL DAS$SDMONPTR(%M#S_EVBF, INTERIM$) ALTRET(NO_EVBUF);
      295     4814    1           CALL DAM$MAP(INTERIM$, EV_BUF$,,,DA_MONISDATA) ALTRET(BAD_EVBUF_MAP);
      296     4815    1   TRY_FOR_CONNECT_BUFFER: ;
      297     4816    1           CALL DAS$SDMONPTR(%M#H_CNCTEVX, INTERIM$) ALTRET(NO_HB_EVX);
      298     4817    1           CALL DAM$MAP(INTERIM$, HB_X$,,,DA_MONISDATA) ALTRET(BAD_HB_EVX_MAP);
      299     4818    1           CALL DAS$SDMONPTR(%M#H_CNCTEVBF, INTERIM$) ALTRET(NO_HB_EVBUF);
      300     4819    1           CALL DAM$MAP(INTERIM$, HB_BUF$,,,DA_MONISDATA)
      301     4820    1             ALTRET(BAD_MAP_HB_BUF);
      302     4821
      303     4822    1           HB_STOP_X = HB_X$->H_CNCTEVX;
      304     4823    1           IF HB_STOP_X>%HBX_MAX THEN HB_STOP_X=%HBX_MAX;
      305     4824    1           IF HB_STOP_X = 0 THEN HB_X = 15;
      306     4825    1           ELSE HB_X = HB_STOP_X - 1;
      307     4826
      308     4827    1   DO_IT:  ;
      309     4828
      310     4829
      311     4830    1           IF ~EV_END THEN TIME_EV_DIF = EVINF.TIME(EV_X);
      312     4831    1           ELSE TIME_EV_DIF =  0;
      313     4832    1           IF ~HB_END THEN TIME_HB_DIF = HBINF.TIME(HB_X);
      314     4833    1           ELSE TIME_HB_DIF = 0;
      315     4834    1           IF TIME_EV_DIF < TIME_HB_DIF THEN
      316     4835    1              BASE_TIME = TIME_HB_DIF;
      317     4836    1           ELSE
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:11   
      318     4837    1              BASE_TIME = TIME_EV_DIF;
      319     4838
      320     4839    2           DO WHILE(~EV_END | ~HB_END);
      321     4840    2              IF ~EV_END THEN TIME_EV_DIF = BASE_TIME - EVINF.TIME(EV_X);
      322     4841    2              IF ~HB_END THEN TIME_HB_DIF = BASE_TIME - HBINF.TIME(HB_X);
      323     4842    2              IF EV_END THEN GOTO PRINT_CONNECT;
      324     4843    2              IF HB_END THEN GOTO PRINT_EVENT;
      325     4844    2              IF TIME_EV_DIF < TIME_HB_DIF THEN
      326     4845    3   PRINT_EVENT: DO;
      327     4846    3                 BASE_TIME = EVINF.TIME(EV_X);
      328     4847    3                 USR_NO = EVINF.USR(EV_X);
      329     4848    3                 EVENT = EVENT_TABLE(EVINF.EVNR(EV_X));
      330     4849    3                 STATE_C = S(EVINF.STATE(EV_X));
      331     4850    3                 PORT = EVINF.PORT(EV_X);
      332     4851    3                 CALL DAF$WRITE(VECTOR(EVENT_FORMAT),
      333     4852    3                   VECTOR(USR_NO),
      334     4853    3                   VECTOR(EVENT),
      335     4854    3                   VECTOR(STATE_C),
      336     4855    3                   VECTOR(PORT),
      337     4856    3                   VECTOR(TIME_EV_DIF),
      338     4857    3                   VECTOR(BASE_TIME));
      339     4858    3                 IF EV_X = EV_STOP_X THEN
      340     4859    3                    EV_END = '1'B;
      341     4860    3                 ELSE
      342     4861    3                    IF EV_X = 0 THEN EV_X = 99;
      343     4862    3                    ELSE EV_X = EV_X - 1;
      344     4863    3                 END;
      345     4864    2              ELSE
      346     4865    3   PRINT_CONNECT: DO;
      347     4866    3                 BASE_TIME = HBINF.TIME(HB_X);
      348     4867    3                 HB_IC = HBINF.IC(HB_X);
      349     4868    3                 HB_WSR = HBINF.WSR(HB_X);
      350     4869    3                 HB_PORT = HBINF.PORT(HB_X);
      351     4870    3                 IF HBINF.MLBX(HB_X) <= 16
      352     4871    3                 THEN HB_MLBX = MLBX_TABLE(HBINF.MLBX(HB_X));
      353     4872    3                 ELSE HB_MLBX = 'ILLEGAL';
      354     4873    3                 CALL DAF$WRITE(VECTOR(HB_FORMAT),
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:12   
      355     4874    3                   VECTOR(HB_IC),
      356     4875    3                   VECTOR(HB_WSR),
      357     4876    3                   VECTOR(HB_MLBX),
      358     4877    3                   VECTOR(HB_PORT),
      359     4878    3                   VECTOR(TIME_HB_DIF),
      360     4879    3                   VECTOR(BASE_TIME));
      361     4880    3                 IF HB_X = HB_STOP_X THEN
      362     4881    3                    HB_END = '1'B;
      363     4882    3                 ELSE
      364     4883    3                    IF HB_X = 0 THEN HB_X = 15;
      365     4884    3                    ELSE HB_X = HB_X - 1;
      366     4885    3                 END;
      367     4886    2              END;
      368     4887
      369     4888    1           RETURN;
      370     4889
      371     4890
      372     4891
      373     4892        /*
      374     4893                   ALTRETURN ROUTINES.
      375     4894        IF THE SYMBOL SEARCH OR MAP ROUTINES ALTRET THE APPROPRIATE
      376     4895        END OF TABLE FLAG IS SET.  IF THE EV_END FLAG IS SET WHEN
      377     4896        THE HB_END FLAG IS SET THEN THE ROUTINE RETURNS HAVING DONE
      378     4897        NOTHING.
      379     4898        */
      380     4899    1   NO_EVX: ;
      381     4900
      382     4901    1   BAD_EVX_MAP: ;
      383     4902
      384     4903    1   NO_EVBUF: ;
      385     4904
      386     4905    1   BAD_EVBUF_MAP: ;
      387     4906    1           EV_END = '1'B;
      388     4907    1           GOTO TRY_FOR_CONNECT_BUFFER;
      389     4908    1   NO_HB_EVX: ;
      390     4909    1   BAD_HB_EVX_MAP: ;
      391     4910    1   NO_HB_EVBUF: ;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:13   
      392     4911    1   BAD_MAP_HB_BUF: ;
      393     4912        /*
      394     4913                CHECK TO SEE IF THE EVENT BUFFER WAS MAPPED
      395     4914             IF SO THEN GO PRINT IT
      396     4915             IF NOT THEN THERE'S NOTHING TO DO
      397     4916        */
      398     4917    1           IF EV_END THEN RETURN;
      399     4918    1           HB_END    = '1'B;
      400     4919    1           GOTO DO_IT;                     /*  PRINT THE SS EVENT BUFFER         */
      401     4920    1   END;

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:14   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DAD$SCHED.

   Procedure DAD$SCHED requires 613 words for executable code.
   Procedure DAD$SCHED requires 82 words of local(AUTO) storage.

    No errors detected in file DAD$SCHED.:E05TSI    .

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:15   

 Object Unit name= DAD$SCHED                                  File name= DAD$SCHED.:E05TOU
 UTS= JUL 29 '97 12:46:19.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none    72    110  DAD$SCHED
    1  RoData even  UTS    338    522  DAD$SCHED
    2   Proc  even  none   613   1145  DAD$SCHED
    3  RoData even  none    35     43  DAD$SCHED

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  DAD$SCHED
     2    315                  yes      Std        0  DAD$EVBUF

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std       2 DAS$SDMONPTR
 yes     yes           Std       5 DAM$MAP
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:16   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$USRT$                               DAF$WRITE                             DA_MONISDATA
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:17   


        1        1        /*M* Display Scheduler State Queues.                                  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*                                                                    */
        8        8        /*D* NAME: DAD$SCHED
        9        9             CALL: CALL DAD$SCHED;
       10       10             DESCRIPTION: This routine displays the user number of each user
       11       11                in each Scheduler State Queue in the order in which they are
       12       12                linked through B$U.FL in the User Tables.
       13       13                                                                              */
       14       14        /*                                                                    */
       15       15        DAD$SCHED: PROC;

     15  2 000000   000000 700200 xent  DAD$SCHED    TSX0  ! X66_AUTO_0
         2 000001   000122 000000                    ZERO    82,0

       16       16        /*                                                                    */
       17       17        %INCLUDE DA_FORMAT_C;
       18      259        %INCLUDE DA_MONSYM_C;
       19      310        %REPORT (NAME=SCHDRPRT,TITLE='SCHEDULER TABLES',HEADER=NO);
       20      376        %INCLUDE SS_SCHED_C;
       21      609        %INCLUDE B$USER;
       22      825        %B$USERREFS;
       23      829        %INCLUDE B$OBJECT_C;
       24     4259        %B$SDEF;
       25     4313        %S_STATE (FPTN=S);
       26     4345        %S_RSTATE (FPTN=R);
       27     4358        /*                                                                    */
       28     4359    1   DCL DAS$SDMONPTR ENTRY(2) ALTRET;
       29     4360    1   DCL DAM$MAP ENTRY(5) ALTRET;
       30     4361    1   DCL DAF$WRITE EPTR SYMREF;
       31     4362    1   DCL DAF$INIT ENTRY(1) ALTRET;
       32     4363    1   DCL DAF$NEWPAGE ENTRY;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:18   
       33     4364    1   DCL SFMAT STATIC CHAR(0) INIT(' %4A %14(%Q >%Z3O%)');
       34     4365    1   DCL ERRFMT STATIC CHAR(0) INIT('      LINK ERROR; TAIL= %Z3O');
       35     4366    1   DCL B$IS$ PTR SYMREF;
       36     4367    1   DCL DA_MONISDATA BIT(72) SYMREF;
       37     4368    1   DCL P$ PTR;
       38     4369    1   DCL U UBIN;
       39     4370    1   DCL FL UBIN;
       40     4371    1   DCL QUEUE(0:%SS_SNULL) UBIN BASED;
       41     4372    1   DCL 1 HQ STATIC,
       42     4373    1         2 * UBIN(18) INIT(%SS_SNULL) UNAL,
       43     4374    1         2 * BIT(18) INIT('600000'O) UNAL,
       44     4375    1         2 P$ PTR UNAL;
       45     4376    1   DCL 1 TQ STATIC,
       46     4377    1         2 * UBIN(18) INIT(%SS_SNULL) UNAL,
       47     4378    1         2 * BIT(18) INIT('600000'O) UNAL,
       48     4379    1         2 P$ PTR UNAL;
       49     4380    1   DCL 1 NV STATIC,
       50     4381    1         2 CT UBIN(18) UNAL,
       51     4382    1         2 * UBIN(2) INIT(3) UNAL,
       52     4383    1         2 * UBIN(16) INIT(0) UNAL,
       53     4384    1         2 * PTR INIT(ADDR(N)) UNAL;
       54     4385    1   DCL N(0:13) UBIN STATIC;
       55     4386    1   DCL SNAME CHAR(4);
       56     4387    1   DCL STATE UBIN;
       57     4388    1   DCL RESOURCE SBIN;
       58     4389    1   DCL RQ$ PTR;
       59     4390    1   DCL I UBIN;
       60     4391    1   DCL NS UBIN;
       61     4392        /*
       62     4393                   REPORT FORMATS TITLES AND SUCH
       63     4394        */
       64     4395        %REPORT(NAME=EV_RPT, TITLE='EVENT AND CONNECT BUFFERS', HEADER=YES);
       65     4461        %HEADER(TEXTADR=HDR_NAMES, LAST=NO);
       66     4503        %HEADER(TEXTADR=HDR_HB,LAST=NO);
       67     4545        %HEADER(TEXTADR=HDR_ULINE);
       68     4587
       69     4588    1   DCL 1  HDR_NAMES  CONSTANT,
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:19   
       70     4589    1         2 LEN   UBIN(9)  UNAL INIT(SIZEC(HDR_NAMES.TX)),
       71     4590    1         2 TX    CHAR(0)  INIT(
       72     4591    1        'E    USR   EVENT    STATE    PORT  TIME DIFFERENCE     TIME STAMP');
       73     4592    1   DCL 1  HDR_HB     CONSTANT,
       74     4593    1         2 LEN   UBIN(9)  UNAL INIT(SIZEC(HDR_HB.TX)),
       75     4594    1         2 TX    CHAR(0)  INIT(
       76     4595    1        'C    IC    WSR      MLBX           IN REVERSE');
       77     4596    1   DCL 1  HDR_ULINE  CONSTANT,
       78     4597    1         2 LEN   UBIN(9)  UNAL INIT(SIZEC(HDR_ULINE.TX)),
       79     4598    1         2 TX    CHAR(0)  INIT(
       80     4599    1        '- -------  ------   -----   -----  ---------------  --------------');
       81     4600
       82     4601    1   DCL  EVENT_FORMAT  CONSTANT CHAR(0) INIT(
       83     4602    1        'E    .%Z3O  %A  %A      %1O    %12D     .%12ZO');
       84     4603    1   DCL  HB_FORMAT     CONSTANT CHAR(0) INIT(
       85     4604    1        'C .%Z6O  WSR%Z1O     %A    %1O    %12D     .%12ZO');
       86     4605        /*
       87     4606                   INDICIES, FLAGS, AND WORKING VARIABLES
       88     4607        */
       89     4608    1   DCL  EV_STOP_X         SBIN;
       90     4609        /*  EV_STOP_X IS INITIALIZED TO S_EVX - 1 AND WHEN EV_X
       91     4610            EQUALS EV_STOP_X THEN EV_END IS SET TRUE*/
       92     4611    1   DCL  EV_X              SBIN;
       93     4612        /*  EV_X  IS SET FROM S_EVX AND IS USED TO STEP THRU THE
       94     4613            EVENT BUFFER    */
       95     4614    1   DCL  EV_END            BIT(1);
       96     4615        /*  EV_END IS THE LOOP CONTROL IT STARTS AT '0'B AND IS SET AS
       97     4616            ABOVE TO EXIT THE LOOP  */
       98     4617
       99     4618    1   DCL  HB_X           SBIN;
      100     4619        /*  INDEX THRU THE CONNECT BUFFER  */
      101     4620    1   DCL  HB_STOP_X        SBIN;
      102     4621        /*  STOP INDEX FOR THE CONNECT BUFFER */
      103     4622    1   DCL  HB_END           BIT(1);
      104     4623        /*  END OF CONNECT PROCESSING FLAG  */
      105     4624
      106     4625    1   DCL  BASE_TIME        UBIN;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:20   
      107     4626    1   DCL  TIME_EV_DIF      UBIN;
      108     4627    1   DCL  TIME_HB_DIF      UBIN;
      109     4628    1   DCL  USR_NO           UBIN;             /* USER # FROM EVENT BUFFER           */
      110     4629    1   DCL  EVENT            CHAR(7);          /* FROM EVENT BUFFER                  */
      111     4630    1   DCL  STATE_C            CHAR(5);        /* FROM EVENT BUFFER                  */
      112     4631    1   DCL  PORT             UBIN;             /* FROM EVENT BUFFER                  */
      113     4632    1   DCL  HB_IC           UBIN;              /*  FROM CONNECT BUFFER               */
      114     4633    1   DCL  HB_WSR          UBIN;              /*  FROM CONNECT BUFFER               */
      115     4634    1   DCL  HB_PORT         UBIN;              /*  FROM CONNECT BUFFER               */
      116     4635    1   DCL  HB_MLBX         CHAR(7);           /*  FROM CONNECT BUFFER               */
      117     4636
      118     4637
      119     4638        %EQU EVX_MAX=99;
      120     4639    1   DCL 1  EVINF  (0:%EVX_MAX)    BASED(EV_BUF$)  DALIGNED,
      121     4640    1         2 USR      UBIN BYTE UNAL,
      122     4641    1         2 EVNR     UBIN BYTE UNAL,
      123     4642    1         2 STATE    UBIN BYTE UNAL,
      124     4643    1         2 PORT     UBIN BYTE UNAL,
      125     4644    1         2 TIME     UBIN;
      126     4645        /*  NOTE THAT THE ABOVE STRUCTURE IS A COPY OF THE SAME IN
      127     4646            SSR$RUE AND MUST BE CHANGED AS IT CHANGES
      128     4647        */
      129     4648        %EQU HBX_MAX=15;
      130     4649    1   DCL 1  HBINF (0:%HBX_MAX) BASED(HB_BUF$) DALIGNED,
      131     4650    1         2 IC                         UBIN(18) UNAL,
      132     4651    1         2 WSR                        UBIN(3)  UNAL,
      133     4652    1         2 PORT                       UBIN(3)  UNAL,
      134     4653    1         2 MLBX                       UBIN(12)  UNAL,
      135     4654    1         2 TIME                       UBIN;
      136     4655        /*  NOTE THAT THE ABOVE STRUCTURE IS FROM HFB AND
      137     4656            MUST CHANGE AS IT CHANGES */
      138     4657
      139     4658
      140     4659    1   DCL  INTERIM$                      PTR;
      141     4660    1   DCL  EV_X$                         PTR; /* TO S_EVX                           */
      142     4661    1   DCL  S_EVX     UBIN BASED;
      143     4662    1   DCL  EV_BUF$                       PTR; /* TO S_EVBUF                         */
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:21   
      144     4663    1   DCL  HB_X$                         PTR; /* TO H_CNCTEVX                       */
      145     4664    1   DCL  H_CNCTEVX                     UBIN BASED;
      146     4665    1   DCL  HB_BUF$                       PTR; /* TO H_CNCTEVBF                      */
      147     4666
      148     4667        /*
      149     4668                      EVENT DEFINITIONS
      150     4669
      151     4670        */
      152     4671    1   DCL  EVENT_TABLE (0:99) CONSTANT CHAR(7) INIT(
      153     4672    1        'NEWUSR',
      154     4673    1        'IIP',
      155     4674    1        'IIPC',
      156     4675    1        'QMF',
      157     4676    1        'CRD',
      158     4677    1        'CIC',
      159     4678    1        'CICCU',
      160     4679    1        'CBL',
      161     4680    1        'CUB',
      162     4681    1        'CUBEX',
      163     4682    1        'CBK',
      164     4683    1        'CBKEX',
      165     4684    1        'CEC',
      166     4685    1        'CECEX',
      167     4686    1        'ERR',                             /*  ERRORED BY OPERATOR               */
      168     4687    1        'ERRBLK',
      169     4688    1        'ABRT',
      170     4689    1        'ABTBLK',
      171     4690    1        'CAN',
      172     4691    1        'CANBLK',
      173     4692    1        'DISC',
      174     4693    1        'DSCBLK',
      175     4694    1        'DISCX',
      176     4695    1        'WU',
      177     4696    1        'WUEX',
      178     4697    1        'SL',
      179     4698    1        'SLPMME',
      180     4699    1        'QA',
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:22   
      181     4700    1        'UQA',
      182     4701    1        'QE',
      183     4702    1        'IOC',
      184     4703    1        'IOCU',
      185     4704    1        'DISPCP',
      186     4705    1        'DU',
      187     4706    1        'AU',
      188     4707    1        'AP',
      189     4708    1        'MP',
      190     4709    1        'QC',
      191     4710    1        'UQC',
      192     4711    1        'CW',
      193     4712    1        'FC',
      194     4713    1        'FPLDTRC',
      195     4714    1        'IIPCA',
      196     4715    1        'FPEVNT',
      197     4716    1        'ILLEGAL'*18,
      198     4717    1        'CBF',
      199     4718    1        'CBA',
      200     4719    1        'NC',
      201     4720    1        'CA',
      202     4721    1        'NQW',
      203     4722    1        'NQR',
      204     4723    1        'NQP',
      205     4724    1        'QPA',
      206     4725    1        'ILLEGAL'*9,
      207     4726    1        'PARK',
      208     4727    1         'ILLEGAL'*19,
      209     4728    1         'SKIPUSR'
      210     4729    1        );
      211     4730        /*
      212     4731                      MAILBOX DEFINITIONS
      213     4732
      214     4733        */
      215     4734    1   DCL  MLBX_TABLE (0:32) CONSTANT CHAR(7) INIT(
      216     4735    1        'NOP',
      217     4736    1        'PAUSE',
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:23   
      218     4737    1        'SCREECH',
      219     4738    1        'ILLEGAL',
      220     4739    1        'TIME',
      221     4740    1        'ILLEGAL'*3,
      222     4741    1        'MAKE',
      223     4742    1        'ILLEGAL'*7,
      224     4743    1        'CLEAR',
      225     4744    1        'ILLEGAL'*15,
      226     4745    1        'RELIEF');
      227     4746        %EJECT;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:24   
      228     4747    1           CALL DAF$INIT(SCHDRPRT);

   4747  2 000002   000000 630400 3                  EPPR0   0
         2 000003   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000004   000000 701000 xent               TSX1    DAF$INIT
         2 000005   000000 011000                    NOP     0

      229     4748    1           CALL DAS$SDMONPTR(%M#S_HQ,HQ.P$);

   4748  2 000006   000001 630400 3                  EPPR0   1
         2 000007   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000010   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000011   000000 011000                    NOP     0

      230     4749    1           CALL DAS$SDMONPTR(%M#S_TQ,TQ.P$);

   4749  2 000012   000003 630400 3                  EPPR0   3
         2 000013   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000014   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000015   000000 011000                    NOP     0

      231     4750    1           CALL DAS$SDMONPTR(%M#S_RQH,RQ$);

   4750  2 000016   200011 630500                    EPPR0   RQ$,,AUTO
         2 000017   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000020   000005 236000 3                  LDQ     5
         2 000021   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000022   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000023   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000024   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000025   000000 011000                    NOP     0

      232     4751    1           STATE = %SS_SC1;

   4751  2 000026   000001 235007                    LDA     1,DL
         2 000027   200007 755100                    STA     STATE,,AUTO

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:25   
      233     4752    1           RESOURCE = -1;

   4752  2 000030   000001 336007                    LCQ     1,DL
         2 000031   200010 756100                    STQ     RESOURCE,,AUTO

      234     4753    2           DO WHILE(STATE<=%SS_SNULL);

   4753  2 000032   000031 115007                    CMPA    25,DL
         2 000033   000314 603000 2                  TRC     ERR

      235     4754    3              IF STATE = %SS_SQR AND RESOURCE ~= -1 THEN DO;

   4754  2 000034   200007 235100                    LDA     STATE,,AUTO
         2 000035   000024 115007                    CMPA    20,DL
         2 000036   000063 601000 2                  TNZ     s:4759
         2 000037   200010 236100                    LDQ     RESOURCE,,AUTO
         2 000040   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 000041   000063 600000 2                  TZE     s:4759

      236     4755    3                 CALL DAM$MAP(RQ$,P$,0,0,DA_MONISDATA) ALTRET(ERR);

   4755  2 000042   000006 236000 3                  LDQ     6
         2 000043   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000044   000010 237000 3                  LDAQ    8
         2 000045   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000046   200003 630500                    EPPR0   P$,,AUTO
         2 000047   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000050   200011 631500                    EPPR1   RQ$,,AUTO
         2 000051   200046 451500                    STP1    HB_BUF$+2,,AUTO
         2 000052   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000053   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000054   000000 701000 xent               TSX1    DAM$MAP
         2 000055   000314 702000 2                  TSX2    ERR

      237     4756    3                 U=P$->QUEUE(RESOURCE);

   4756  2 000056   200003 470500                    LDP0    P$,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:26   
         2 000057   200010 720100                    LXL0    RESOURCE,,AUTO
         2 000060   000000 235110                    LDA     0,X0,PR0
         2 000061   200004 755100                    STA     U,,AUTO

      238     4757    3                 END;

   4757  2 000062   000103 710000 2                  TRA     s:4762

      239     4758    3              ELSE DO;

      240     4759    3                 CALL DAM$MAP(HQ.P$,P$,0,0,DA_MONISDATA) ALTRET(ERR);

   4759  2 000063   000006 236000 3                  LDQ     6
         2 000064   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000065   000010 237000 3                  LDAQ    8
         2 000066   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000067   200003 630500                    EPPR0   P$,,AUTO
         2 000070   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000071   000002 236000 3                  LDQ     2
         2 000072   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000073   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000074   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000075   000000 701000 xent               TSX1    DAM$MAP
         2 000076   000314 702000 2                  TSX2    ERR

      241     4760    3                 U=P$->QUEUE(STATE);

   4760  2 000077   200003 470500                    LDP0    P$,,AUTO
         2 000100   200007 720100                    LXL0    STATE,,AUTO
         2 000101   000000 235110                    LDA     0,X0,PR0
         2 000102   200004 755100                    STA     U,,AUTO

      242     4761    3                 END;

      243     4762    2              NS=0;

   4762  2 000103   200013 450100                    STZ     NS,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:27   

      244     4763    2              IF U ~= 0 THEN

   4763  2 000104   000300 600000 2                  TZE     s:4793

      245     4764    3              DO;

      246     4765    3                 IF STATE = %SS_SQR AND RESOURCE ~= -1 THEN

   4765  2 000105   200007 236100                    LDQ     STATE,,AUTO
         2 000106   000024 116007                    CMPQ    20,DL
         2 000107   000116 601000 2                  TNZ     s:4768
         2 000110   200010 235100                    LDA     RESOURCE,,AUTO
         2 000111   000027 115000 xsym               CMPA    B_VECTNIL+23
         2 000112   000116 600000 2                  TZE     s:4768

      247     4766    3                    SNAME=R(RESOURCE);

   4766  2 000113   000031 236005 1                  LDQ     R,AL
         2 000114   200006 756100                    STQ     SNAME,,AUTO
         2 000115   000120 710000 2                  TRA     NXTL

      248     4767    3                 ELSE
      249     4768    3                    SNAME=S(STATE);

   4768  2 000116   000000 236006 1                  LDQ     S,QL
         2 000117   200006 756100                    STQ     SNAME,,AUTO

      250     4769    4   NXTL:         DO I = 0 TO 13;

   4769  2 000120   200012 450100       NXTL         STZ     I,,AUTO

      251     4770    4                    N(I)=U;

   4770  2 000121   200012 720100                    LXL0    I,,AUTO
         2 000122   200004 235100                    LDA     U,,AUTO
         2 000123   000037 755010 0                  STA     N,X0
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:28   

      252     4771    4                    NS=NS+1;

   4771  2 000124   200013 236100                    LDQ     NS,,AUTO
         2 000125   000001 036007                    ADLQ    1,DL
         2 000126   200013 756100                    STQ     NS,,AUTO

      253     4772    4                    IF NS > 511 THEN

   4772  2 000127   001000 116007                    CMPQ    512,DL
         2 000130   000207 603000 2                  TRC     LASTU

      254     4773    4                       GOTO LASTU;
      255     4774    4                    IF STATE = %SS_SQR AND RESOURCE ~= -1 THEN

   4774  2 000131   200007 235100                    LDA     STATE,,AUTO
         2 000132   000024 115007                    CMPA    20,DL
         2 000133   000147 601000 2                  TNZ     s:4777
         2 000134   200010 235100                    LDA     RESOURCE,,AUTO
         2 000135   000027 115000 xsym               CMPA    B_VECTNIL+23
         2 000136   000147 600000 2                  TZE     s:4777

      256     4775    4                       FL = B$USRT$->B$USER.SQ(U);

   4775  2 000137   200004 235100                    LDA     U,,AUTO
         2 000140   000004 735000                    ALS     4
         2 000141   000000 470400 xsym               LDP0    B$USRT$
         2 000142   000010 236105                    LDQ     8,AL,PR0
         2 000143   000011 772000                    QRL     9
         2 000144   000777 376007                    ANQ     511,DL
         2 000145   200005 756100                    STQ     FL,,AUTO
         2 000146   000154 710000 2                  TRA     s:4778

      257     4776    4                    ELSE
      258     4777    4                       FL = B$USRT$->B$USER.FL(U);

   4777  2 000147   200004 235100                    LDA     U,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:29   
         2 000150   000004 735000                    ALS     4
         2 000151   000000 470400 xsym               LDP0    B$USRT$
         2 000152   000002 235105                    LDA     2,AL,PR0
         2 000153   200005 755100                    STA     FL,,AUTO

      259     4778    4                    IF FL = 0 THEN

   4778  2 000154   200005 235100                    LDA     FL,,AUTO
         2 000155   000207 600000 2                  TZE     LASTU

      260     4779    4                       GOTO LASTU;
      261     4780    4                    U=FL;

   4780  2 000156   200004 755100                    STA     U,,AUTO

      262     4781    4                    END;

   4781  2 000157   200012 236100                    LDQ     I,,AUTO
         2 000160   000001 036007                    ADLQ    1,DL
         2 000161   200012 756100                    STQ     I,,AUTO
         2 000162   000016 116007                    CMPQ    14,DL
         2 000163   000121 602000 2                  TNC     s:4770

      263     4782    3                 CALL DAF$WRITE(VECTOR(SFMAT),VECTOR(SNAME),VECTOR(N));

   4782  2 000164   777640 235007                    LDA     -96,DL
         2 000165   200046 452500                    STP2    HB_BUF$+2,,AUTO
         2 000166   200046 236100                    LDQ     HB_BUF$+2,,AUTO
         2 000167   000006 036003                    ADLQ    6,DU
         2 000170   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000171   000016 236000 3                  LDQ     14
         2 000172   200054 756100                    STQ     HB_BUF$+8,,AUTO
         2 000173   200050 631500                    EPPR1   HB_BUF$+4,,AUTO
         2 000174   200053 451500                    STP1    HB_BUF$+7,,AUTO
         2 000175   000017 236000 3                  LDQ     15
         2 000176   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000177   200052 630500                    EPPR0   HB_BUF$+6,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:30   
         2 000200   000000 220000 xsym               LDX0    DAF$WRITE
         2 000201   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000202   000000 701010                    TSX1    0,X0
         2 000203   000000 011000                    NOP     0

      264     4783    3                 SNAME='    ';

   4783  2 000204   000517 236000 1                  LDQ     MLBX_TABLE+58
         2 000205   200006 756100                    STQ     SNAME,,AUTO

      265     4784    3                 GOTO NXTL;

   4784  2 000206   000120 710000 2                  TRA     NXTL

      266     4785    3   LASTU:        NV.CT=I;

   4785  2 000207   000035 740000 0     LASTU        STX0    NV

      267     4786    3                 CALL DAF$WRITE(VECTOR(SFMAT),VECTOR(SNAME),NV);

   4786  2 000210   777640 235007                    LDA     -96,DL
         2 000211   200046 452500                    STP2    HB_BUF$+2,,AUTO
         2 000212   200046 236100                    LDQ     HB_BUF$+2,,AUTO
         2 000213   000006 036003                    ADLQ    6,DU
         2 000214   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000215   000020 236000 3                  LDQ     16
         2 000216   200054 756100                    STQ     HB_BUF$+8,,AUTO
         2 000217   200050 630500                    EPPR0   HB_BUF$+4,,AUTO
         2 000220   200053 450500                    STP0    HB_BUF$+7,,AUTO
         2 000221   000017 236000 3                  LDQ     15
         2 000222   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000223   200052 630500                    EPPR0   HB_BUF$+6,,AUTO
         2 000224   000000 221000 xsym               LDX1    DAF$WRITE
         2 000225   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000226   000000 701011                    TSX1    0,X1
         2 000227   000000 011000                    NOP     0

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:31   
      268     4787    4                 IF STATE ~= %SS_SQR OR RESOURCE = -1 THEN DO;

   4787  2 000230   200007 235100                    LDA     STATE,,AUTO
         2 000231   000024 115007                    CMPA    20,DL
         2 000232   000236 601000 2                  TNZ     s:4788
         2 000233   200010 236100                    LDQ     RESOURCE,,AUTO
         2 000234   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 000235   000300 601000 2                  TNZ     s:4793

      269     4788    4                    CALL DAM$MAP(TQ.P$,P$,0,0,DA_MONISDATA) ALTRET(ERR);

   4788  2 000236   000006 236000 3                  LDQ     6
         2 000237   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000240   000010 237000 3                  LDAQ    8
         2 000241   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000242   200003 630500                    EPPR0   P$,,AUTO
         2 000243   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000244   000004 236000 3                  LDQ     4
         2 000245   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000246   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000247   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000250   000000 701000 xent               TSX1    DAM$MAP
         2 000251   000314 702000 2                  TSX2    ERR

      270     4789    4                    IF U ~= P$->QUEUE(STATE) OR NS > 511 THEN

   4789  2 000252   200003 470500                    LDP0    P$,,AUTO
         2 000253   200007 720100                    LXL0    STATE,,AUTO
         2 000254   200004 236100                    LDQ     U,,AUTO
         2 000255   000000 116110                    CMPQ    0,X0,PR0
         2 000256   000262 601000 2                  TNZ     s:4790
         2 000257   200013 235100                    LDA     NS,,AUTO
         2 000260   001000 115007                    CMPA    512,DL
         2 000261   000300 602000 2                  TNC     s:4793

      271     4790    4                       CALL DAF$WRITE(VECTOR(ERRFMT),VECTOR(P$->QUEUE(STATE)));

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:32   
   4790  2 000262   777640 235007                    LDA     -96,DL
         2 000263   200007 236100                    LDQ     STATE,,AUTO
         2 000264   000022 736000                    QLS     18
         2 000265   200003 036100                    ADLQ    P$,,AUTO
         2 000266   200046 757100                    STAQ    HB_BUF$+2,,AUTO
         2 000267   200046 631500                    EPPR1   HB_BUF$+2,,AUTO
         2 000270   200051 451500                    STP1    HB_BUF$+5,,AUTO
         2 000271   000024 236000 3                  LDQ     20
         2 000272   200050 756100                    STQ     HB_BUF$+4,,AUTO
         2 000273   200050 630500                    EPPR0   HB_BUF$+4,,AUTO
         2 000274   000000 221000 xsym               LDX1    DAF$WRITE
         2 000275   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000276   000000 701011                    TSX1    0,X1
         2 000277   000000 011000                    NOP     0

      272     4791    4                    END;

      273     4792    3                 END;

      274     4793    2              IF STATE = %SS_SQR AND RESOURCE < SIZEW(R) THEN

   4793  2 000300   200007 235100                    LDA     STATE,,AUTO
         2 000301   000024 115007                    CMPA    20,DL
         2 000302   000310 601000 2                  TNZ     s:4796
         2 000303   200010 236100                    LDQ     RESOURCE,,AUTO
         2 000304   000006 116007                    CMPQ    6,DL
         2 000305   000310 605000 2                  TPL     s:4796

      275     4794    2                 RESOURCE = RESOURCE + 1;

   4794  2 000306   200010 054100                    AOS     RESOURCE,,AUTO
         2 000307   000312 710000 2                  TRA     s:4797

      276     4795    2              ELSE
      277     4796    2                 STATE = STATE + 1;

   4796  2 000310   000001 035007                    ADLA    1,DL
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:33   
         2 000311   200007 755100                    STA     STATE,,AUTO

      278     4797    2              END;

   4797  2 000312   000031 115007                    CMPA    25,DL
         2 000313   000034 602000 2                  TNC     s:4754

      279     4798    1   ERR:    RETURN;

   4798  2 000314   000000 702200 xent  ERR          TSX2  ! X66_ARET

      280     4799        %EJECT;
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:34   
      281     4800    1   DAD$EVBUF:ENTRY;

   4800  2 000315   000000 700200 xent  DAD$EVBUF    TSX0  ! X66_AUTO_0
         2 000316   000122 000000                    ZERO    82,0

      282     4801        /*D*  THIS ENTRY FORMATS THE SCHEDULER EVENT BUFFER
      283     4802              AND THE CONNECT BUFFER   */
      284     4803    1           EV_END = '0'B;

   4803  2 000317   200016 450100                    STZ     EV_END,,AUTO

      285     4804    1           HB_END = '0'B;

   4804  2 000320   200021 450100                    STZ     HB_END,,AUTO

      286     4805    1           CALL DAF$INIT(EV_RPT);

   4805  2 000321   000025 630400 3                  EPPR0   21
         2 000322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000323   000000 701000 xent               TSX1    DAF$INIT
         2 000324   000000 011000                    NOP     0

      287     4806    1           CALL DAS$SDMONPTR(%M#S_EVX, INTERIM$) ALTRET(NO_EVX);

   4806  2 000325   200040 630500                    EPPR0   INTERIM$,,AUTO
         2 000326   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000327   000026 236000 3                  LDQ     22
         2 000330   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000331   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000332   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000333   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000334   001134 702000 2                  TSX2    NO_EVX

      288     4807    1           CALL DAM$MAP(INTERIM$, EV_X$,,,DA_MONISDATA) ALTRET(BAD_EVX_MAP);

   4807  2 000335   000006 236000 3                  LDQ     6
         2 000336   200052 756100                    STQ     HB_BUF$+6,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:35   
         2 000337   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000340   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000341   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000342   200041 630500                    EPPR0   EV_X$,,AUTO
         2 000343   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000344   200040 631500                    EPPR1   INTERIM$,,AUTO
         2 000345   200046 451500                    STP1    HB_BUF$+2,,AUTO
         2 000346   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000347   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000350   000000 701000 xent               TSX1    DAM$MAP
         2 000351   001134 702000 2                  TSX2    NO_EVX

      289     4808    1           EV_STOP_X = EV_X$->S_EVX;

   4808  2 000352   200041 470500                    LDP0    EV_X$,,AUTO
         2 000353   000000 235100                    LDA     0,,PR0
         2 000354   200014 755100                    STA     EV_STOP_X,,AUTO

      290     4809    1           IF EV_STOP_X>%EVX_MAX THEN EV_STOP_X=%EVX_MAX;

   4809  2 000355   000143 115007                    CMPA    99,DL
         2 000356   000361 604400 2                  TMOZ    s:4810

   4809  2 000357   000143 236007                    LDQ     99,DL
         2 000360   200014 756100                    STQ     EV_STOP_X,,AUTO

      291     4810    1           IF EV_STOP_X = 0 THEN EV_X = 99;

   4810  2 000361   200014 236100                    LDQ     EV_STOP_X,,AUTO
         2 000362   000366 601000 2                  TNZ     s:4811

   4810  2 000363   000143 235007                    LDA     99,DL
         2 000364   200015 755100                    STA     EV_X,,AUTO
         2 000365   000370 710000 2                  TRA     s:4813

      292     4811    1           ELSE EV_X = EV_STOP_X - 1;

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:36   
   4811  2 000366   000001 136007                    SBLQ    1,DL
         2 000367   200015 756100                    STQ     EV_X,,AUTO

      293     4812
      294     4813    1           CALL DAS$SDMONPTR(%M#S_EVBF, INTERIM$) ALTRET(NO_EVBUF);

   4813  2 000370   200040 631500                    EPPR1   INTERIM$,,AUTO
         2 000371   200047 451500                    STP1    HB_BUF$+3,,AUTO
         2 000372   000027 236000 3                  LDQ     23
         2 000373   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000374   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000375   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000376   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000377   001134 702000 2                  TSX2    NO_EVX

      295     4814    1           CALL DAM$MAP(INTERIM$, EV_BUF$,,,DA_MONISDATA) ALTRET(BAD_EVBUF_MAP);

   4814  2 000400   000006 236000 3                  LDQ     6
         2 000401   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000402   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000403   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000404   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000405   200042 630500                    EPPR0   EV_BUF$,,AUTO
         2 000406   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000407   200040 631500                    EPPR1   INTERIM$,,AUTO
         2 000410   200046 451500                    STP1    HB_BUF$+2,,AUTO
         2 000411   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000412   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000413   000000 701000 xent               TSX1    DAM$MAP
         2 000414   001134 702000 2                  TSX2    NO_EVX

   4810  2 000415                       TRY_FOR_CON* null
      296     4815    1   TRY_FOR_CONNECT_BUFFER: ;
      297     4816    1           CALL DAS$SDMONPTR(%M#H_CNCTEVX, INTERIM$) ALTRET(NO_HB_EVX);

   4816  2 000415   200040 630500                    EPPR0   INTERIM$,,AUTO
         2 000416   200047 450500                    STP0    HB_BUF$+3,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:37   
         2 000417   000030 236000 3                  LDQ     24
         2 000420   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000421   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000422   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000423   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000424   001137 702000 2                  TSX2    NO_HB_EVX

      298     4817    1           CALL DAM$MAP(INTERIM$, HB_X$,,,DA_MONISDATA) ALTRET(BAD_HB_EVX_MAP);

   4817  2 000425   000006 236000 3                  LDQ     6
         2 000426   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000427   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000430   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000431   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000432   200043 630500                    EPPR0   HB_X$,,AUTO
         2 000433   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000434   200040 631500                    EPPR1   INTERIM$,,AUTO
         2 000435   200046 451500                    STP1    HB_BUF$+2,,AUTO
         2 000436   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000437   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000440   000000 701000 xent               TSX1    DAM$MAP
         2 000441   001137 702000 2                  TSX2    NO_HB_EVX

      299     4818    1           CALL DAS$SDMONPTR(%M#H_CNCTEVBF, INTERIM$) ALTRET(NO_HB_EVBUF);

   4818  2 000442   200040 630500                    EPPR0   INTERIM$,,AUTO
         2 000443   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000444   000031 236000 3                  LDQ     25
         2 000445   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 000446   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000447   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000450   000000 701000 xent               TSX1    DAS$SDMONPTR
         2 000451   001137 702000 2                  TSX2    NO_HB_EVX

      300     4819    1           CALL DAM$MAP(INTERIM$, HB_BUF$,,,DA_MONISDATA)

   4819  2 000452   000006 236000 3                  LDQ     6
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:38   
         2 000453   200052 756100                    STQ     HB_BUF$+6,,AUTO
         2 000454   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000455   000001 235000 xsym               LDA     B_VECTNIL+1
         2 000456   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000457   200044 630500                    EPPR0   HB_BUF$,,AUTO
         2 000460   200047 450500                    STP0    HB_BUF$+3,,AUTO
         2 000461   200040 631500                    EPPR1   INTERIM$,,AUTO
         2 000462   200046 451500                    STP1    HB_BUF$+2,,AUTO
         2 000463   200046 630500                    EPPR0   HB_BUF$+2,,AUTO
         2 000464   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 000465   000000 701000 xent               TSX1    DAM$MAP
         2 000466   001137 702000 2                  TSX2    NO_HB_EVX

      301     4820    1             ALTRET(BAD_MAP_HB_BUF);
      302     4821
      303     4822    1           HB_STOP_X = HB_X$->H_CNCTEVX;

   4822  2 000467   200043 470500                    LDP0    HB_X$,,AUTO
         2 000470   000000 235100                    LDA     0,,PR0
         2 000471   200020 755100                    STA     HB_STOP_X,,AUTO

      304     4823    1           IF HB_STOP_X>%HBX_MAX THEN HB_STOP_X=%HBX_MAX;

   4823  2 000472   000017 115007                    CMPA    15,DL
         2 000473   000476 604400 2                  TMOZ    s:4824

   4823  2 000474   000017 236007                    LDQ     15,DL
         2 000475   200020 756100                    STQ     HB_STOP_X,,AUTO

      305     4824    1           IF HB_STOP_X = 0 THEN HB_X = 15;

   4824  2 000476   200020 236100                    LDQ     HB_STOP_X,,AUTO
         2 000477   000503 601000 2                  TNZ     s:4825

   4824  2 000500   000017 235007                    LDA     15,DL
         2 000501   200017 755100                    STA     HB_X,,AUTO
         2 000502   000505 710000 2                  TRA     DO_IT
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:39   

      306     4825    1           ELSE HB_X = HB_STOP_X - 1;

   4825  2 000503   000001 136007                    SBLQ    1,DL
         2 000504   200017 756100                    STQ     HB_X,,AUTO

   4824  2 000505                       DO_IT        null
      307     4826
      308     4827    1   DO_IT:  ;
      309     4828
      310     4829
      311     4830    1           IF ~EV_END THEN TIME_EV_DIF = EVINF.TIME(EV_X);

   4830  2 000505   200016 236100                    LDQ     EV_END,,AUTO
         2 000506   400000 376003                    ANQ     -131072,DU
         2 000507   400000 676003                    ERQ     -131072,DU
         2 000510   000517 600000 2                  TZE     s:4831

   4830  2 000511   200015 235100                    LDA     EV_X,,AUTO
         2 000512   000001 735000                    ALS     1
         2 000513   200042 470500                    LDP0    EV_BUF$,,AUTO
         2 000514   000001 235105                    LDA     1,AL,PR0
         2 000515   200023 755100                    STA     TIME_EV_DIF,,AUTO
         2 000516   000520 710000 2                  TRA     s:4832

      312     4831    1           ELSE TIME_EV_DIF =  0;

   4831  2 000517   200023 450100                    STZ     TIME_EV_DIF,,AUTO

      313     4832    1           IF ~HB_END THEN TIME_HB_DIF = HBINF.TIME(HB_X);

   4832  2 000520   200021 236100                    LDQ     HB_END,,AUTO
         2 000521   400000 376003                    ANQ     -131072,DU
         2 000522   400000 676003                    ERQ     -131072,DU
         2 000523   000532 600000 2                  TZE     s:4833

   4832  2 000524   200017 235100                    LDA     HB_X,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:40   
         2 000525   000001 735000                    ALS     1
         2 000526   200044 470500                    LDP0    HB_BUF$,,AUTO
         2 000527   000001 235105                    LDA     1,AL,PR0
         2 000530   200024 755100                    STA     TIME_HB_DIF,,AUTO
         2 000531   000533 710000 2                  TRA     s:4834

      314     4833    1           ELSE TIME_HB_DIF = 0;

   4833  2 000532   200024 450100                    STZ     TIME_HB_DIF,,AUTO

      315     4834    1           IF TIME_EV_DIF < TIME_HB_DIF THEN

   4834  2 000533   200023 236100                    LDQ     TIME_EV_DIF,,AUTO
         2 000534   200024 116100                    CMPQ    TIME_HB_DIF,,AUTO
         2 000535   000541 603000 2                  TRC     s:4837

      316     4835    1              BASE_TIME = TIME_HB_DIF;

   4835  2 000536   200024 235100                    LDA     TIME_HB_DIF,,AUTO
         2 000537   200022 755100                    STA     BASE_TIME,,AUTO
         2 000540   000542 710000 2                  TRA     s:4839

      317     4836    1           ELSE
      318     4837    1              BASE_TIME = TIME_EV_DIF;

   4837  2 000541   200022 756100                    STQ     BASE_TIME,,AUTO

      319     4838
      320     4839    2           DO WHILE(~EV_END | ~HB_END);

   4839  2 000542   001122 710000 2                  TRA     s:4886

      321     4840    2              IF ~EV_END THEN TIME_EV_DIF = BASE_TIME - EVINF.TIME(EV_X);

   4840  2 000543   200016 236100                    LDQ     EV_END,,AUTO
         2 000544   400000 376003                    ANQ     -131072,DU
         2 000545   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:41   
         2 000546   000555 600000 2                  TZE     s:4841

   4840  2 000547   200015 235100                    LDA     EV_X,,AUTO
         2 000550   000001 735000                    ALS     1
         2 000551   200042 470500                    LDP0    EV_BUF$,,AUTO
         2 000552   200022 236100                    LDQ     BASE_TIME,,AUTO
         2 000553   000001 136105                    SBLQ    1,AL,PR0
         2 000554   200023 756100                    STQ     TIME_EV_DIF,,AUTO

      322     4841    2              IF ~HB_END THEN TIME_HB_DIF = BASE_TIME - HBINF.TIME(HB_X);

   4841  2 000555   200021 236100                    LDQ     HB_END,,AUTO
         2 000556   400000 376003                    ANQ     -131072,DU
         2 000557   400000 676003                    ERQ     -131072,DU
         2 000560   000567 600000 2                  TZE     s:4842

   4841  2 000561   200017 235100                    LDA     HB_X,,AUTO
         2 000562   000001 735000                    ALS     1
         2 000563   200044 470500                    LDP0    HB_BUF$,,AUTO
         2 000564   200022 236100                    LDQ     BASE_TIME,,AUTO
         2 000565   000001 136105                    SBLQ    1,AL,PR0
         2 000566   200024 756100                    STQ     TIME_HB_DIF,,AUTO

      323     4842    2              IF EV_END THEN GOTO PRINT_CONNECT;

   4842  2 000567   200016 234100                    SZN     EV_END,,AUTO
         2 000570   000750 604000 2                  TMI     PRINT_CONNECT

      324     4843    2              IF HB_END THEN GOTO PRINT_EVENT;

   4843  2 000571   200021 234100                    SZN     HB_END,,AUTO
         2 000572   000576 604000 2                  TMI     PRINT_EVENT

      325     4844    2              IF TIME_EV_DIF < TIME_HB_DIF THEN

   4844  2 000573   200023 236100                    LDQ     TIME_EV_DIF,,AUTO
         2 000574   200024 116100                    CMPQ    TIME_HB_DIF,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:42   
         2 000575   000750 603000 2                  TRC     PRINT_CONNECT

      326     4845    3   PRINT_EVENT: DO;

   4845  2 000576                       PRINT_EVENT  null
      327     4846    3                 BASE_TIME = EVINF.TIME(EV_X);

   4846  2 000576   200015 235100                    LDA     EV_X,,AUTO
         2 000577   000001 735000                    ALS     1
         2 000600   200042 470500                    LDP0    EV_BUF$,,AUTO
         2 000601   000001 235105                    LDA     1,AL,PR0
         2 000602   200022 755100                    STA     BASE_TIME,,AUTO

      328     4847    3                 USR_NO = EVINF.USR(EV_X);

   4847  2 000603   200015 236100                    LDQ     EV_X,,AUTO
         2 000604   000001 736000                    QLS     1
         2 000605   000000 236106                    LDQ     0,QL,PR0
         2 000606   000033 772000                    QRL     27
         2 000607   200025 756100                    STQ     USR_NO,,AUTO

      329     4848    3                 EVENT = EVENT_TABLE(EVINF.EVNR(EV_X));

   4848  2 000610   200015 235100                    LDA     EV_X,,AUTO
         2 000611   000001 735000                    ALS     1
         2 000612   000000 236105                    LDQ     0,AL,PR0
         2 000613   000022 772000                    QRL     18
         2 000614   000777 376007                    ANQ     511,DL
         2 000615   000007 402007                    MPY     7,DL
         2 000616   040100 100406                    MLR     fill='040'O
         2 000617   000146 000007 1                  ADSC9   EVENT_TABLE,Q            cn=0,n=7
         2 000620   200026 000007                    ADSC9   EVENT,,AUTO              cn=0,n=7

      330     4849    3                 STATE_C = S(EVINF.STATE(EV_X));

   4849  2 000621   200015 235100                    LDA     EV_X,,AUTO
         2 000622   000001 735000                    ALS     1
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:43   
         2 000623   000000 236105                    LDQ     0,AL,PR0
         2 000624   000011 772000                    QRL     9
         2 000625   000777 376007                    ANQ     511,DL
         2 000626   000002 736000                    QLS     2
         2 000627   040100 100406                    MLR     fill='040'O
         2 000630   000000 000004 1                  ADSC9   S,Q                      cn=0,n=4
         2 000631   200030 000005                    ADSC9   STATE_C,,AUTO            cn=0,n=5

      331     4850    3                 PORT = EVINF.PORT(EV_X);

   4850  2 000632   000000 236105                    LDQ     0,AL,PR0
         2 000633   000777 376007                    ANQ     511,DL
         2 000634   200032 756100                    STQ     PORT,,AUTO

      332     4851    3                 CALL DAF$WRITE(VECTOR(EVENT_FORMAT),

   4851  2 000635   777640 235007                    LDA     -96,DL
         2 000636   200046 452500                    STP2    HB_BUF$+2,,AUTO
         2 000637   200046 236100                    LDQ     HB_BUF$+2,,AUTO
         2 000640   000025 036003                    ADLQ    21,DU
         2 000641   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 000642   000034 235000 3                  LDA     28
         2 000643   200052 452500                    STP2    HB_BUF$+6,,AUTO
         2 000644   200052 236100                    LDQ     HB_BUF$+6,,AUTO
         2 000645   000026 036003                    ADLQ    22,DU
         2 000646   200054 757100                    STAQ    HB_BUF$+8,,AUTO
         2 000647   000035 235000 3                  LDA     29
         2 000650   200056 452500                    STP2    HB_BUF$+10,,AUTO
         2 000651   200056 236100                    LDQ     HB_BUF$+10,,AUTO
         2 000652   000030 036003                    ADLQ    24,DU
         2 000653   200060 757100                    STAQ    HB_BUF$+12,,AUTO
         2 000654   777640 235007                    LDA     -96,DL
         2 000655   200062 452500                    STP2    HB_BUF$+14,,AUTO
         2 000656   200062 236100                    LDQ     HB_BUF$+14,,AUTO
         2 000657   000032 036003                    ADLQ    26,DU
         2 000660   200064 757100                    STAQ    HB_BUF$+16,,AUTO
         2 000661   777640 235007                    LDA     -96,DL
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:44   
         2 000662   200066 452500                    STP2    HB_BUF$+18,,AUTO
         2 000663   200066 236100                    LDQ     HB_BUF$+18,,AUTO
         2 000664   000023 036003                    ADLQ    19,DU
         2 000665   200070 757100                    STAQ    HB_BUF$+20,,AUTO
         2 000666   777640 235007                    LDA     -96,DL
         2 000667   200072 452500                    STP2    HB_BUF$+22,,AUTO
         2 000670   200072 236100                    LDQ     HB_BUF$+22,,AUTO
         2 000671   000022 036003                    ADLQ    18,DU
         2 000672   200076 757100                    STAQ    HB_BUF$+26,,AUTO
         2 000673   200050 237100                    LDAQ    HB_BUF$+4,,AUTO
         2 000674   200074 757100                    STAQ    HB_BUF$+24,,AUTO
         2 000675   200054 237100                    LDAQ    HB_BUF$+8,,AUTO
         2 000676   200100 757100                    STAQ    HB_BUF$+28,,AUTO
         2 000677   200060 237100                    LDAQ    HB_BUF$+12,,AUTO
         2 000700   200102 757100                    STAQ    HB_BUF$+30,,AUTO
         2 000701   200064 237100                    LDAQ    HB_BUF$+16,,AUTO
         2 000702   200104 757100                    STAQ    HB_BUF$+32,,AUTO
         2 000703   200070 237100                    LDAQ    HB_BUF$+20,,AUTO
         2 000704   200106 757100                    STAQ    HB_BUF$+34,,AUTO
         2 000705   200076 237100                    LDAQ    HB_BUF$+26,,AUTO
         2 000706   200110 757100                    STAQ    HB_BUF$+36,,AUTO
         2 000707   200110 631500                    EPPR1   HB_BUF$+36,,AUTO
         2 000710   200120 451500                    STP1    HB_BUF$+44,,AUTO
         2 000711   200106 633500                    EPPR3   HB_BUF$+34,,AUTO
         2 000712   200117 453500                    STP3    HB_BUF$+43,,AUTO
         2 000713   200104 634500                    EPPR4   HB_BUF$+32,,AUTO
         2 000714   200116 454500                    STP4    HB_BUF$+42,,AUTO
         2 000715   200102 635500                    EPPR5   HB_BUF$+30,,AUTO
         2 000716   200115 455500                    STP5    HB_BUF$+41,,AUTO
         2 000717   200100 636500                    EPPR6   HB_BUF$+28,,AUTO
         2 000720   200114 456500                    STP6    HB_BUF$+40,,AUTO
         2 000721   200074 637500                    EPPR7   HB_BUF$+24,,AUTO
         2 000722   200113 457500                    STP7    HB_BUF$+39,,AUTO
         2 000723   000036 236000 3                  LDQ     30
         2 000724   200112 756100                    STQ     HB_BUF$+38,,AUTO
         2 000725   200112 630500                    EPPR0   HB_BUF$+38,,AUTO
         2 000726   000000 220000 xsym               LDX0    DAF$WRITE
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:45   
         2 000727   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 000730   000000 701010                    TSX1    0,X0
         2 000731   000000 011000                    NOP     0

      333     4852    3                   VECTOR(USR_NO),
      334     4853    3                   VECTOR(EVENT),
      335     4854    3                   VECTOR(STATE_C),
      336     4855    3                   VECTOR(PORT),
      337     4856    3                   VECTOR(TIME_EV_DIF),
      338     4857    3                   VECTOR(BASE_TIME));
      339     4858    3                 IF EV_X = EV_STOP_X THEN

   4858  2 000732   200015 236100                    LDQ     EV_X,,AUTO
         2 000733   200014 116100                    CMPQ    EV_STOP_X,,AUTO
         2 000734   000740 601000 2                  TNZ     s:4861

      340     4859    3                    EV_END = '1'B;

   4859  2 000735   400000 236003                    LDQ     -131072,DU
         2 000736   200016 756100                    STQ     EV_END,,AUTO
         2 000737   001122 710000 2                  TRA     s:4886

      341     4860    3                 ELSE
      342     4861    3                    IF EV_X = 0 THEN EV_X = 99;

   4861  2 000740   000000 116003                    CMPQ    0,DU
         2 000741   000745 601000 2                  TNZ     s:4862

   4861  2 000742   000143 235007                    LDA     99,DL
         2 000743   200015 755100                    STA     EV_X,,AUTO
         2 000744   001122 710000 2                  TRA     s:4886

      343     4862    3                    ELSE EV_X = EV_X - 1;

   4862  2 000745   000001 336007                    LCQ     1,DL
         2 000746   200015 056100                    ASQ     EV_X,,AUTO

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:46   
      344     4863    3                 END;

   4863  2 000747   001122 710000 2                  TRA     s:4886

      345     4864    2              ELSE
      346     4865    3   PRINT_CONNECT: DO;

   4865  2 000750                       PRINT_CONNE* null
      347     4866    3                 BASE_TIME = HBINF.TIME(HB_X);

   4866  2 000750   200017 235100                    LDA     HB_X,,AUTO
         2 000751   000001 735000                    ALS     1
         2 000752   200044 470500                    LDP0    HB_BUF$,,AUTO
         2 000753   000001 235105                    LDA     1,AL,PR0
         2 000754   200022 755100                    STA     BASE_TIME,,AUTO

      348     4867    3                 HB_IC = HBINF.IC(HB_X);

   4867  2 000755   200017 236100                    LDQ     HB_X,,AUTO
         2 000756   000001 736000                    QLS     1
         2 000757   000000 236106                    LDQ     0,QL,PR0
         2 000760   000022 772000                    QRL     18
         2 000761   200033 756100                    STQ     HB_IC,,AUTO

      349     4868    3                 HB_WSR = HBINF.WSR(HB_X);

   4868  2 000762   200017 235100                    LDA     HB_X,,AUTO
         2 000763   000001 735000                    ALS     1
         2 000764   000000 236105                    LDQ     0,AL,PR0
         2 000765   000017 772000                    QRL     15
         2 000766   000007 376007                    ANQ     7,DL
         2 000767   200034 756100                    STQ     HB_WSR,,AUTO

      350     4869    3                 HB_PORT = HBINF.PORT(HB_X);

   4869  2 000770   000000 236105                    LDQ     0,AL,PR0
         2 000771   000014 772000                    QRL     12
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:47   
         2 000772   000007 376007                    ANQ     7,DL
         2 000773   200035 756100                    STQ     HB_PORT,,AUTO

      351     4870    3                 IF HBINF.MLBX(HB_X) <= 16

   4870  2 000774   000000 236105                    LDQ     0,AL,PR0
         2 000775   007777 376007                    ANQ     4095,DL
         2 000776   000021 116007                    CMPQ    17,DL
         2 000777   001005 603000 2                  TRC     s:4872

      352     4871    3                 THEN HB_MLBX = MLBX_TABLE(HBINF.MLBX(HB_X));

   4871  2 001000   000007 402007                    MPY     7,DL
         2 001001   040100 100406                    MLR     fill='040'O
         2 001002   000425 000007 1                  ADSC9   MLBX_TABLE,Q             cn=0,n=7
         2 001003   200036 000007                    ADSC9   HB_MLBX,,AUTO            cn=0,n=7
         2 001004   001010 710000 2                  TRA     s:4873

      353     4872    3                 ELSE HB_MLBX = 'ILLEGAL';

   4872  2 001005   040100 100400                    MLR     fill='040'O
         2 001006   000520 000007 1                  ADSC9   MLBX_TABLE+59            cn=0,n=7
         2 001007   200036 000007                    ADSC9   HB_MLBX,,AUTO            cn=0,n=7

      354     4873    3                 CALL DAF$WRITE(VECTOR(HB_FORMAT),

   4873  2 001010   777640 235007                    LDA     -96,DL
         2 001011   200046 452500                    STP2    HB_BUF$+2,,AUTO
         2 001012   200046 236100                    LDQ     HB_BUF$+2,,AUTO
         2 001013   000033 036003                    ADLQ    27,DU
         2 001014   200050 757100                    STAQ    HB_BUF$+4,,AUTO
         2 001015   777640 235007                    LDA     -96,DL
         2 001016   200052 452500                    STP2    HB_BUF$+6,,AUTO
         2 001017   200052 236100                    LDQ     HB_BUF$+6,,AUTO
         2 001020   000034 036003                    ADLQ    28,DU
         2 001021   200054 757100                    STAQ    HB_BUF$+8,,AUTO
         2 001022   000034 235000 3                  LDA     28
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:48   
         2 001023   200056 452500                    STP2    HB_BUF$+10,,AUTO
         2 001024   200056 236100                    LDQ     HB_BUF$+10,,AUTO
         2 001025   000036 036003                    ADLQ    30,DU
         2 001026   200060 757100                    STAQ    HB_BUF$+12,,AUTO
         2 001027   777640 235007                    LDA     -96,DL
         2 001030   200062 452500                    STP2    HB_BUF$+14,,AUTO
         2 001031   200062 236100                    LDQ     HB_BUF$+14,,AUTO
         2 001032   000035 036003                    ADLQ    29,DU
         2 001033   200064 757100                    STAQ    HB_BUF$+16,,AUTO
         2 001034   777640 235007                    LDA     -96,DL
         2 001035   200066 452500                    STP2    HB_BUF$+18,,AUTO
         2 001036   200066 236100                    LDQ     HB_BUF$+18,,AUTO
         2 001037   000024 036003                    ADLQ    20,DU
         2 001040   200070 757100                    STAQ    HB_BUF$+20,,AUTO
         2 001041   777640 235007                    LDA     -96,DL
         2 001042   200072 452500                    STP2    HB_BUF$+22,,AUTO
         2 001043   200072 236100                    LDQ     HB_BUF$+22,,AUTO
         2 001044   000022 036003                    ADLQ    18,DU
         2 001045   200076 757100                    STAQ    HB_BUF$+26,,AUTO
         2 001046   200050 237100                    LDAQ    HB_BUF$+4,,AUTO
         2 001047   200074 757100                    STAQ    HB_BUF$+24,,AUTO
         2 001050   200054 237100                    LDAQ    HB_BUF$+8,,AUTO
         2 001051   200100 757100                    STAQ    HB_BUF$+28,,AUTO
         2 001052   200060 237100                    LDAQ    HB_BUF$+12,,AUTO
         2 001053   200102 757100                    STAQ    HB_BUF$+30,,AUTO
         2 001054   200064 237100                    LDAQ    HB_BUF$+16,,AUTO
         2 001055   200104 757100                    STAQ    HB_BUF$+32,,AUTO
         2 001056   200070 237100                    LDAQ    HB_BUF$+20,,AUTO
         2 001057   200106 757100                    STAQ    HB_BUF$+34,,AUTO
         2 001060   200076 237100                    LDAQ    HB_BUF$+26,,AUTO
         2 001061   200110 757100                    STAQ    HB_BUF$+36,,AUTO
         2 001062   200110 631500                    EPPR1   HB_BUF$+36,,AUTO
         2 001063   200120 451500                    STP1    HB_BUF$+44,,AUTO
         2 001064   200106 633500                    EPPR3   HB_BUF$+34,,AUTO
         2 001065   200117 453500                    STP3    HB_BUF$+43,,AUTO
         2 001066   200104 634500                    EPPR4   HB_BUF$+32,,AUTO
         2 001067   200116 454500                    STP4    HB_BUF$+42,,AUTO
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:49   
         2 001070   200102 635500                    EPPR5   HB_BUF$+30,,AUTO
         2 001071   200115 455500                    STP5    HB_BUF$+41,,AUTO
         2 001072   200100 636500                    EPPR6   HB_BUF$+28,,AUTO
         2 001073   200114 456500                    STP6    HB_BUF$+40,,AUTO
         2 001074   200074 637500                    EPPR7   HB_BUF$+24,,AUTO
         2 001075   200113 457500                    STP7    HB_BUF$+39,,AUTO
         2 001076   000042 236000 3                  LDQ     34
         2 001077   200112 756100                    STQ     HB_BUF$+38,,AUTO
         2 001100   200112 630500                    EPPR0   HB_BUF$+38,,AUTO
         2 001101   000000 220000 xsym               LDX0    DAF$WRITE
         2 001102   000025 631400 xsym               EPPR1   B_VECTNIL+21
         2 001103   000000 701010                    TSX1    0,X0
         2 001104   000000 011000                    NOP     0

      355     4874    3                   VECTOR(HB_IC),
      356     4875    3                   VECTOR(HB_WSR),
      357     4876    3                   VECTOR(HB_MLBX),
      358     4877    3                   VECTOR(HB_PORT),
      359     4878    3                   VECTOR(TIME_HB_DIF),
      360     4879    3                   VECTOR(BASE_TIME));
      361     4880    3                 IF HB_X = HB_STOP_X THEN

   4880  2 001105   200017 236100                    LDQ     HB_X,,AUTO
         2 001106   200020 116100                    CMPQ    HB_STOP_X,,AUTO
         2 001107   001113 601000 2                  TNZ     s:4883

      362     4881    3                    HB_END = '1'B;

   4881  2 001110   400000 236003                    LDQ     -131072,DU
         2 001111   200021 756100                    STQ     HB_END,,AUTO
         2 001112   001122 710000 2                  TRA     s:4886

      363     4882    3                 ELSE
      364     4883    3                    IF HB_X = 0 THEN HB_X = 15;

   4883  2 001113   000000 116003                    CMPQ    0,DU
         2 001114   001120 601000 2                  TNZ     s:4884
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:50   

   4883  2 001115   000017 235007                    LDA     15,DL
         2 001116   200017 755100                    STA     HB_X,,AUTO
         2 001117   001122 710000 2                  TRA     s:4886

      365     4884    3                    ELSE HB_X = HB_X - 1;

   4884  2 001120   000001 336007                    LCQ     1,DL
         2 001121   200017 056100                    ASQ     HB_X,,AUTO

      366     4885    3                 END;

      367     4886    2              END;

   4886  2 001122   200016 236100                    LDQ     EV_END,,AUTO
         2 001123   400000 376003                    ANQ     -131072,DU
         2 001124   400000 676003                    ERQ     -131072,DU
         2 001125   200046 756100                    STQ     HB_BUF$+2,,AUTO
         2 001126   200021 236100                    LDQ     HB_END,,AUTO
         2 001127   400000 376003                    ANQ     -131072,DU
         2 001130   400000 676003                    ERQ     -131072,DU
         2 001131   200046 276100                    ORQ     HB_BUF$+2,,AUTO
         2 001132   000543 601000 2                  TNZ     s:4840

      368     4887
      369     4888    1           RETURN;

   4888  2 001133   000000 702200 xent               TSX2  ! X66_ARET

   4884  2 001134                       NO_EVX       null
   4884  2 001134                       BAD_EVX_MAP  null
   4884  2 001134                       NO_EVBUF     null
   4884  2 001134                       BAD_EVBUF_M* null
      370     4889
      371     4890
      372     4891
      373     4892        /*
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:51   
      374     4893                   ALTRETURN ROUTINES.
      375     4894        IF THE SYMBOL SEARCH OR MAP ROUTINES ALTRET THE APPROPRIATE
      376     4895        END OF TABLE FLAG IS SET.  IF THE EV_END FLAG IS SET WHEN
      377     4896        THE HB_END FLAG IS SET THEN THE ROUTINE RETURNS HAVING DONE
      378     4897        NOTHING.
      379     4898        */
      380     4899    1   NO_EVX: ;
      381     4900
      382     4901    1   BAD_EVX_MAP: ;
      383     4902
      384     4903    1   NO_EVBUF: ;
      385     4904
      386     4905    1   BAD_EVBUF_MAP: ;
      387     4906    1           EV_END = '1'B;

   4906  2 001134   400000 236003                    LDQ     -131072,DU
         2 001135   200016 756100                    STQ     EV_END,,AUTO

      388     4907    1           GOTO TRY_FOR_CONNECT_BUFFER;

   4907  2 001136   000415 710000 2                  TRA     TRY_FOR_CONNECT_BUFFER

   4906  2 001137                       NO_HB_EVX    null
   4906  2 001137                       BAD_HB_EVX_* null
   4906  2 001137                       NO_HB_EVBUF  null
   4906  2 001137                       BAD_MAP_HB_* null
      389     4908    1   NO_HB_EVX: ;
      390     4909    1   BAD_HB_EVX_MAP: ;
      391     4910    1   NO_HB_EVBUF: ;
      392     4911    1   BAD_MAP_HB_BUF: ;
      393     4912        /*
      394     4913                CHECK TO SEE IF THE EVENT BUFFER WAS MAPPED
      395     4914             IF SO THEN GO PRINT IT
      396     4915             IF NOT THEN THERE'S NOTHING TO DO
      397     4916        */
      398     4917    1           IF EV_END THEN RETURN;

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:52   
   4917  2 001137   200016 234100                    SZN     EV_END,,AUTO
         2 001140   001142 605000 2                  TPL     s:4918

   4917  2 001141   000000 702200 xent               TSX2  ! X66_ARET

      399     4918    1           HB_END    = '1'B;

   4918  2 001142   400000 236003                    LDQ     -131072,DU
         2 001143   200021 756100                    STQ     HB_END,,AUTO

      400     4919    1           GOTO DO_IT;                     /*  PRINT THE SS EVENT BUFFER         */

   4919  2 001144   000505 710000 2                  TRA     DO_IT
      401     4920    1   END;

PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:53   
--  Include file information  --

   B$OBJECT_C.:E05TOU  is referenced.
   B$USER.:E05TOU  cannot be made into a system file and is referenced.
   SS_SCHED_C.:E05TOU  is referenced.
   DA_MONSYM_C.:E05TOU  is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure DAD$SCHED.
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:54   

 **** Variables and constants ****

  ****  Section 000  Data  DAD$SCHED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/c CHAR(28)    r     1 ERRFMT                    55-0-0/w STRC(288)   r     1 EV_RPT
    74-0-0/w STRC(144)   r     1 EV_RPTHD00               100-0-0/w STRC(144)   r     1 EV_RPTHD01
   104-0-0/w STRC(144)   r     1 EV_RPTHD02                65-0-0/c STRC(234)   r     1 EV_RPTTX00
    31-0-0/b STRC(72)    r     1 HQ                        37-0-0/w UBIN        r     1 N(0:13)
    35-0-0/b STRC(72)    r     1 NV                         0-0-0/w STRC(288)   r     1 SCHDRPRT
    10-0-0/c STRC(153)   r     1 SCHDRPRTTX00              15-0-0/c CHAR(19)    r     1 SFMAT
    33-0-0/b STRC(72)    r     1 TQ

  ****  Section 001 RoData DAD$SCHED

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   115-0-0/c CHAR(46)    r     1 EVENT_FORMAT
   146-0-0/c CHAR(7)     r     1 EVENT_TABLE(0:99)
   131-0-0/c CHAR(49)    r     1 HB_FORMAT                 60-0-0/c STRC(414)   r     1 HDR_HB
    37-0-0/c STRC(594)   r     1 HDR_NAMES                 74-0-0/c STRC(603)   r     1 HDR_ULINE
   425-0-0/c CHAR(7)     r     1 MLBX_TABLE(0:32)
    31-0-0/c CHAR(4)     r     1 R(0:5)                     0-0-0/c CHAR(4)     r     1 S(0:24)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    22-0-0/w UBIN        r     1 BASE_TIME                 26-0-0/c CHAR(7)     r     1 EVENT
    42-0-0/w PTR         r     1 EV_BUF$                   16-0-0/b BIT         r     1 EV_END
    14-0-0/w SBIN        r     1 EV_STOP_X                 15-0-0/w SBIN        r     1 EV_X
    41-0-0/w PTR         r     1 EV_X$                      5-0-0/w UBIN        r     1 FL
    44-0-0/w PTR         r     1 HB_BUF$                   21-0-0/b BIT         r     1 HB_END
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:55   
    33-0-0/w UBIN        r     1 HB_IC                     36-0-0/c CHAR(7)     r     1 HB_MLBX
    35-0-0/w UBIN        r     1 HB_PORT                   20-0-0/w SBIN        r     1 HB_STOP_X
    34-0-0/w UBIN        r     1 HB_WSR                    17-0-0/w SBIN        r     1 HB_X
    43-0-0/w PTR         r     1 HB_X$                     12-0-0/w UBIN        r     1 I
    40-0-0/w PTR         r     1 INTERIM$                  13-0-0/w UBIN        r     1 NS
     3-0-0/w PTR         r     1 P$                        32-0-0/w UBIN        r     1 PORT
    10-0-0/w SBIN        r     1 RESOURCE                  11-0-0/w PTR         r     1 RQ$
     6-0-0/c CHAR(4)     r     1 SNAME                      7-0-0/w UBIN        r     1 STATE
    30-0-0/c CHAR(5)     r     1 STATE_C                   23-0-0/w UBIN        r     1 TIME_EV_DIF
    24-0-0/w UBIN        r     1 TIME_HB_DIF                4-0-0/w UBIN        r     1 U
    25-0-0/w UBIN        r     1 USR_NO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$USRT$                    0-0-0/w EPTR        r     1 DAF$WRITE
     0-0-0/b BIT (72)    r     1 DA_MONISDATA

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 B$USER(0:0)                0-0-0/d STRC(72)    r     1 EVINF(0:99)
     0-0-0/d STRC(72)    r     1 HBINF(0:15)                0-0-0/w UBIN        r     1 H_CNCTEVX
     0-0-0/w UBIN        r     1 QUEUE(0:24)                0-0-0/w UBIN        r     1 S_EVX


   Procedure DAD$SCHED requires 613 words for executable code.
   Procedure DAD$SCHED requires 82 words of local(AUTO) storage.

    No errors detected in file DAD$SCHED.:E05TSI    .
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:56   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:57   
          MINI XREF LISTING

B$DO.ECCINFO
       760**DCL       761--REDEF
B$SDEF.AD.OU
      4280**DCL      4286--REDEF
B$SDEF.VALUE
      4261**DCL      4264--REDEF
B$U.MISC
       739**DCL       740--REDEF
B$USER.FL
       787**DCL      4777>>ASSIGN
B$USER.MISC
       815**DCL       816--REDEF
B$USER.SQ
       800**DCL      4775>>ASSIGN
B$USRT$
       827**DCL      4775>>ASSIGN   4777>>ASSIGN
BAD_EVBUF_MAP
      4884**LABEL    4814--CALLALT
BAD_EVX_MAP
      4884**LABEL    4807--CALLALT
BAD_HB_EVX_MAP
      4906**LABEL    4817--CALLALT
BAD_MAP_HB_BUF
      4906**LABEL    4819--CALLALT
BASE_TIME
      4625**DCL      4835<<ASSIGN   4837<<ASSIGN   4840>>ASSIGN   4841>>ASSIGN   4846<<ASSIGN   4851--CALL
      4866<<ASSIGN   4873--CALL
DAF$INIT
      4362**DCL-ENT  4747--CALL     4805--CALL
DAF$WRITE
      4361**DCL      4782>>CALL     4786>>CALL     4790>>CALL     4851>>CALL     4873>>CALL
DAM$MAP
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:58   
      4360**DCL-ENT  4755--CALL     4759--CALL     4788--CALL     4807--CALL     4814--CALL     4817--CALL
      4819--CALL
DAS$SDMONPTR
      4359**DCL-ENT  4748--CALL     4749--CALL     4750--CALL     4806--CALL     4813--CALL     4816--CALL
      4818--CALL
DA_MONISDATA
      4367**DCL      4755<>CALL     4759<>CALL     4788<>CALL     4807<>CALL     4814<>CALL     4817<>CALL
      4819<>CALL
DO_IT
      4824**LABEL    4919--GOTO
ERR
      4798**LABEL    4755--CALLALT  4759--CALLALT  4788--CALLALT
ERRFMT
      4365**DCL      4790--CALL
EVENT
      4629**DCL      4848<<ASSIGN   4851--CALL
EVENT_FORMAT
      4601**DCL      4851--CALL
EVENT_TABLE
      4671**DCL      4848>>ASSIGN
EVINF.EVNR
      4641**DCL      4848>>ASSIGN
EVINF.PORT
      4643**DCL      4850>>ASSIGN
EVINF.STATE
      4642**DCL      4849>>ASSIGN
EVINF.TIME
      4644**DCL      4830>>ASSIGN   4840>>ASSIGN   4846>>ASSIGN
EVINF.USR
      4640**DCL      4847>>ASSIGN
EV_BUF$
      4662**DCL      4639--IMP-PTR  4814<>CALL     4830>>ASSIGN   4840>>ASSIGN   4846>>ASSIGN   4847>>ASSIGN
      4848>>ASSIGN   4849>>ASSIGN   4850>>ASSIGN
EV_END
      4614**DCL      4803<<ASSIGN   4830>>IF       4839>>DOWHILE  4840>>IF       4842>>IF       4859<<ASSIGN
      4906<<ASSIGN   4917>>IF
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:59   
EV_RPT
      4412**DCL      4805<>CALL
EV_RPTHD00
      4478**DCL      4447--DCLINIT
EV_RPTHD01
      4520**DCL      4493--DCLINIT
EV_RPTHD02
      4562**DCL      4535--DCLINIT
EV_RPTTX00
      4455**DCL      4442--DCLINIT
EV_STOP_X
      4608**DCL      4808<<ASSIGN   4809>>IF       4809<<ASSIGN   4810>>IF       4811>>ASSIGN   4858>>IF
EV_X
      4611**DCL      4810<<ASSIGN   4811<<ASSIGN   4830>>ASSIGN   4840>>ASSIGN   4846>>ASSIGN   4847>>ASSIGN
      4848>>ASSIGN   4849>>ASSIGN   4850>>ASSIGN   4858>>IF       4861>>IF       4861<<ASSIGN   4862<<ASSIGN
      4862>>ASSIGN
EV_X$
      4660**DCL      4807<>CALL     4808>>ASSIGN
FL
      4370**DCL      4775<<ASSIGN   4777<<ASSIGN   4778>>IF       4780>>ASSIGN
HBINF.IC
      4650**DCL      4867>>ASSIGN
HBINF.MLBX
      4653**DCL      4870>>IF       4871>>ASSIGN
HBINF.PORT
      4652**DCL      4869>>ASSIGN
HBINF.TIME
      4654**DCL      4832>>ASSIGN   4841>>ASSIGN   4866>>ASSIGN
HBINF.WSR
      4651**DCL      4868>>ASSIGN
HB_BUF$
      4665**DCL      4649--IMP-PTR  4819<>CALL     4832>>ASSIGN   4841>>ASSIGN   4866>>ASSIGN   4867>>ASSIGN
      4868>>ASSIGN   4869>>ASSIGN   4870>>IF       4871>>ASSIGN
HB_END
      4622**DCL      4804<<ASSIGN   4832>>IF       4839>>DOWHILE  4841>>IF       4843>>IF       4881<<ASSIGN
      4918<<ASSIGN
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:60   
HB_FORMAT
      4603**DCL      4873--CALL
HB_IC
      4632**DCL      4867<<ASSIGN   4873--CALL
HB_MLBX
      4635**DCL      4871<<ASSIGN   4872<<ASSIGN   4873--CALL
HB_PORT
      4634**DCL      4869<<ASSIGN   4873--CALL
HB_STOP_X
      4620**DCL      4822<<ASSIGN   4823>>IF       4823<<ASSIGN   4824>>IF       4825>>ASSIGN   4880>>IF
HB_WSR
      4633**DCL      4868<<ASSIGN   4873--CALL
HB_X
      4618**DCL      4824<<ASSIGN   4825<<ASSIGN   4832>>ASSIGN   4841>>ASSIGN   4866>>ASSIGN   4867>>ASSIGN
      4868>>ASSIGN   4869>>ASSIGN   4870>>IF       4871>>ASSIGN   4880>>IF       4883>>IF       4883<<ASSIGN
      4884<<ASSIGN   4884>>ASSIGN
HB_X$
      4663**DCL      4817<>CALL     4822>>ASSIGN
HDR_HB
      4592**DCL      4526--DCLINIT
HDR_HB.TX
      4594**DCL      4593--DCLINIT
HDR_NAMES
      4588**DCL      4484--DCLINIT
HDR_NAMES.TX
      4590**DCL      4589--DCLINIT
HDR_ULINE
      4596**DCL      4568--DCLINIT
HDR_ULINE.TX
      4598**DCL      4597--DCLINIT
HQ.P$
      4375**DCL      4748<>CALL     4759<>CALL
H_CNCTEVX
      4664**DCL      4822>>ASSIGN
I
      4390**DCL      4769<<DOINDEX  4770>>ASSIGN   4785>>ASSIGN
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:61   
INTERIM$
      4659**DCL      4806<>CALL     4807<>CALL     4813<>CALL     4814<>CALL     4816<>CALL     4817<>CALL
      4818<>CALL     4819<>CALL
LASTU
      4785**LABEL    4773--GOTO     4779--GOTO
MLBX_TABLE
      4734**DCL      4871>>ASSIGN
N
      4385**DCL      4384--DCLINIT  4770<<ASSIGN   4782--CALL
NO_EVBUF
      4884**LABEL    4813--CALLALT
NO_EVX
      4884**LABEL    4806--CALLALT
NO_HB_EVBUF
      4906**LABEL    4818--CALLALT
NO_HB_EVX
      4906**LABEL    4816--CALLALT
NS
      4391**DCL      4762<<ASSIGN   4771<<ASSIGN   4771>>ASSIGN   4772>>IF       4789>>IF
NV
      4380**DCL      4786<>CALL
NV.CT
      4381**DCL      4785<<ASSIGN
NXTL
      4769**LABEL    4784--GOTO
P$
      4368**DCL      4755<>CALL     4756>>ASSIGN   4759<>CALL     4760>>ASSIGN   4788<>CALL     4789>>IF
      4790>>CALL
PORT
      4631**DCL      4850<<ASSIGN   4851--CALL
PRINT_CONNECT
      4865**LABEL    4842--GOTO
PRINT_EVENT
      4845**LABEL    4843--GOTO
QUEUE
      4371**DCL      4756>>ASSIGN   4760>>ASSIGN   4789>>IF       4790--CALL
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:62   
R
      4350**DCL      4766>>ASSIGN   4793--IF
RESOURCE
      4388**DCL      4752<<ASSIGN   4754>>IF       4756>>ASSIGN   4765>>IF       4766>>ASSIGN   4774>>IF
      4787>>IF       4793>>IF       4794<<ASSIGN   4794>>ASSIGN
RQ$
      4389**DCL      4750<>CALL     4755<>CALL
S
      4318**DCL      4768>>ASSIGN   4849>>ASSIGN
SCHDRPRT
       327**DCL      4747<>CALL
SCHDRPRTTX00
       370**DCL       357--DCLINIT
SFMAT
      4364**DCL      4782--CALL     4786--CALL
SNAME
      4386**DCL      4766<<ASSIGN   4768<<ASSIGN   4782--CALL     4783<<ASSIGN   4786--CALL
STATE
      4387**DCL      4751<<ASSIGN   4753>>DOWHILE  4754>>IF       4760>>ASSIGN   4765>>IF       4768>>ASSIGN
      4774>>IF       4787>>IF       4789>>IF       4790>>CALL     4793>>IF       4796<<ASSIGN   4796>>ASSIGN
STATE_C
      4630**DCL      4849<<ASSIGN   4851--CALL
S_EVX
      4661**DCL      4808>>ASSIGN
TIME_EV_DIF
      4626**DCL      4830<<ASSIGN   4831<<ASSIGN   4834>>IF       4837>>ASSIGN   4840<<ASSIGN   4844>>IF
      4851--CALL
TIME_HB_DIF
      4627**DCL      4832<<ASSIGN   4833<<ASSIGN   4834>>IF       4835>>ASSIGN   4841<<ASSIGN   4844>>IF
      4873--CALL
TQ.P$
      4379**DCL      4749<>CALL     4788<>CALL
TRY_FOR_CONNECT_BUFFER
      4810**LABEL    4907--GOTO
U
      4369**DCL      4756<<ASSIGN   4760<<ASSIGN   4763>>IF       4770>>ASSIGN   4775>>ASSIGN   4777>>ASSIGN
PL6.E3A0      #001=DAD$SCHED File=DAD$SCHED.:E05TSI                              TUE 07/29/97 12:46 Page:63   
      4780<<ASSIGN   4789>>IF
USR_NO
      4628**DCL      4847<<ASSIGN   4851--CALL
