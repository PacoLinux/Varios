VERSION E05

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:1    
        1        1        /*M* ALA$LOGON   MAIN ROUTINE FOR LOGON.              */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,PLM=6,IND=4,SDI=2,CTI=8,DCI=4,CSU=2,ECU=2,ENI=4,
        8        8              THI=0,DTI=0,IAD=0                              */
        9        9                                                              /**/
       10       10        ALA$LOGON: PROC MAIN ;
       11       11                                                              /**/
       12       12        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:2    
       13       13        /*********************************************************************/
       14       14        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       15       15        /*********************************************************************/
       16       16                                                              /**/
       17       17              %INCLUDE AS_SUPER_C ;
       18      452              %INCLUDE KL_SUPER_C ;
       19     3354              %INCLUDE B$JIT ;
       20     3644              %INCLUDE B$TABLES_C;
       21     3752              %INCLUDE CP_6 ;
       22     3833              %INCLUDE CP_6_SUBS ;
       23     4373              %INCLUDE AL_SUBS_C ;
       24     4382              %INCLUDE AL_PERR_C ;
       25     4404              %INCLUDE AL_MACROS_C ;
       26     4430              %INCLUDE CP_MACROS_C ;
       27     5182              %INCLUDE AL_LOGON_R ;
       28     5214              %INCLUDE JG_GHOSTS_C ;
       29     5304        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:3    
       30     5305        /*********************************************************************/
       31     5306        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
       32     5307        /*********************************************************************/
       33     5308                                                              /**/
       34     5309    1   DCL FCG UBIN(18) CONSTANT INIT(4865) ;          /*  'ALA' IN SIXBIT.  */
       35     5310                                                            /*   SCRATCH :USERS RECORD.   */
       36     5311              %AS_USERS(  STR_NAME = DF_USERS ,
       37     5312                          STCLASS = CONSTANT ) ;
       38     5490    1   DCL SUSMES CHAR(0) CONSTANT INIT('aProgram held. Reconnect');
       39     5491    1   DCL SUSYNDMES CHAR(0) CONSTANT INIT('@(Y/N/D)? ') ;
       40     5492    1   DCL 1 NO_MACCOUNT ALIGNED CONSTANT,
       41     5493    1         2 CNT UBIN BYTE UNAL INIT(4),
       42     5494    1         2 ACCT CHAR(8) UNAL INIT('NONE'),
       43     5495    1         2 NAME CHAR(12) UNAL INIT( ' ' );
       44     5496        %VLP_ERRCODE(FPTN=ALA_E$ASUSER_ERR,FCG='AL',MID='A',MON='0'B,ERR#=E$ASUSER_ERR,SEV=0
              5496            ,STCLASS=CONSTANT);
       45     5541        %VLP_ERRCODE(FPTN=ALA_E$DSUSER_ERR,FCG='AL',MID='A',MON='0'B,ERR#=E$DSUSER_ERR,SEV=0
              5541            ,STCLASS=CONSTANT);
       46     5586        %VLP_ERRCODE(FPTN=ALA_E$USERS_FILE_ERR,FCG='AL',MID='A',MON='0'B,ERR#=
              5586            E$USERS_FILE_ERR,SEV=0,STCLASS=CONSTANT);
       47     5631        %VLP_ERRCODE(FPTN=ALA_E$WRITE_S_ERR,FCG='AL',MID='A',MON='0'B,ERR#=E$WRITE_S_ERR,SEV
              5631            =0,STCLASS=CONSTANT);
       48     5676        %VLP_ERRCODE(FPTN=ALA_E$MAXC_EXCEEDED,FCG='AL',MID='A',MON='0'B,ERR#=E$MAXC_EXCEEDED
              5676            ,SEV=0,STCLASS=CONSTANT);
       49     5721        %VLP_ERRCODE(FPTN=ALA_E$PMAXC_EXCEEDED,FCG='AL',MID='A',MON='0'B,ERR#=
              5721            E$PMAXC_EXCEEDED,SEV=0,STCLASS=CONSTANT);
       50     5766        %VLP_ERRCODE(FPTN=ALA_E$NO_MASTER,FCG='AL',MID='A',MON='0'B,ERR#=E$NO_MASTER,SEV=0,
              5766            STCLASS=CONSTANT);
       51     5811        %VLP_ERRCODE(FPTN=ALA_E$BLANK_ACCT_UNAME,FCG='AL',MID='A',MON='0'B,
       52     5812                      ERR#=E$BLANK_ACCT_UNAME,SEV=0,STCLASS=CONSTANT );
       53     5857        %VLP_ERRCODE(FPTN=ALA_E$SETUP_FORCED, FCG='AL', MID='A', MON='0'B,
       54     5858                      ERR#=E$SETUP_FORCED, SEV=0, STCLASS=CONSTANT );
       55     5903        %B$XL_LOWER_UR;
       56     5907        %B$SR_NON_ZERO;
       57     5911        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:4    
       58     5912        /*********************************************************************/
       59     5913        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
       60     5914        /*********************************************************************/
       61     5915                                                              /**/
       62     5916                                                              /*   :USERS RECORD.   */
       63     5917              %AS_USERS (STR_NAME = AS_USERS, STCLASS = AUTO) ;
       64     6095    1   DCL OUT_BUF CHAR(80) ;
       65     6096    1   DCL SUSMES_ANS CHAR(10);
       66     6097    1   DCL ARS UBIN ;
       67     6098    1   DCL 1 USERS_KEY ,
       68     6099    1         2 CNT UBIN(9) UNAL ,
       69     6100    1         2 TEXT CHAR(20) UNAL ;
       70     6101    1   DCL 1 LIMIT_KEY ,
       71     6102    1         2 CNT UBIN(9) UNAL ,
       72     6103    1         2 TEXT CHAR(20) UNAL ;
       73     6104    1   DCL TEXT$BUF(0:19) CHAR(1) BASED (TEXT$) UNAL ;
       74     6105    1   DCL 1 TEXT$C BASED,
       75     6106    1         2 L UBIN BYTE UNAL,
       76     6107    1         2 C CHAR(TEXT$C.L);
       77     6108    1   DCL DCB$ PTR ;
       78     6109    1   DCL KEY$ PTR ;
       79     6110    1   DCL TEXT$ PTR ;
       80     6111    1   DCL I UBIN ;
       81     6112    1   DCL UMAX SBIN ;                                 /*   MAXIMUM CHARGES.   */
       82     6113    1   DCL UACCUM UBIN ;                               /*   ACCUMULATED CHARGES.   */
       83     6114    1   DCL UBKACC BIT(1) ;                             /*   BANKRUPTCY ACCESS.   */
       84     6115    1   DCL TEMP_BIT BIT (1) ALIGNED;
       85     6116    1   DCL NOSETUP BIT(1) ALIGNED; /*BIT INDICATING IF NS WAS SET ON LOGON*/
       86     6117    1   DCL NOHEADER BIT(1) ALIGNED; /*BIT INDICATING IF NH WAS SET ON LOGON*/
       87     6118    1   DCL 1 MASTER_ACCT ,
       88     6119    1         2 CNT UBIN(9) UNAL ,
       89     6120    1         2 ACCT CHAR(8) UNAL ,
       90     6121    1         2 NAME CHAR(12) UNAL ;
       91     6122    1   DCL RE_BUDGET SBIN ;
       92     6123    1   DCL MODE UBIN WORD ;
       93     6124    1   DCL CP_SLEAZE_SET BIT(1) ;
              6124            /* Set to the Initial value of B$JIT.CPFLAGS1 & %CP_SLEAZE# */
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:5    
       94     6125              %F$DCB( DCBN = F$DCB ) ;
       95     6182              %VLP_NAME(  FPTN = CP_NAME ,
       96     6183                          LEN = 31 ,
       97     6184                          STCLASS = AUTO ) ;
       98     6211    1   DCL CP_ACCT CHAR(8) ;
       99     6212    1   DCL CP_PASSW CHAR(8) ;
      100     6213    1   DCL 1 ERR_CODE AUTO ,
      101     6214    1         2 FCG_MID UBIN(18) UNAL ,
      102     6215    1         2 CODE UBIN(15) UNAL ,
      103     6216    1         2 SEV UBIN(3) UNAL ;
      104     6217    1   DCL AL_ACCT CHAR(8) ;
      105     6218    1   DCL SYS_GHOST BIT(1) ;
      106     6219        %LIST ;
      107     6220        %SET LISTSUB='1'B;
      108     6221                                                              /**/
      109     6222              %AL$TSTAMP ;
              6223                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
              6224    1         DCL 1 AL$TSTAMP AUTO ,
              6225    1               2 UTS UBIN WORD ,
              6226    1               2 TIME CHAR(11) UNAL ,
              6227    1               2 DAY  CHAR(3) UNAL ,
              6228    1               2 DATE CHAR(10) UNAL ;
      110     6230             /* The following is really for B$JIT.LAST_LOGON_TIME, ignore the comment. */
      111     6231              %AL$TSTAMP (STNAME=AL$LLT_TSTAMP);
              6232                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
              6233    1         DCL 1 AL$LLT_TSTAMP AUTO ,
              6234    1               2 UTS UBIN WORD ,
              6235    1               2 TIME CHAR(11) UNAL ,
              6236    1               2 DAY  CHAR(3) UNAL ,
              6237    1               2 DATE CHAR(10) UNAL ;
      112     6239              %CP_LIMREC( NAME = CP_LIMREC ,
      113     6240                          STCLASS =" ") ;
              6241    1   DCL 1 CP_LIMREC ALIGNED,
              6242    1         2 USER_MAX,                       /*JOB MAXIMUM*/
              6243    1           3 MAXCORE SBIN HALF UNAL,
              6244    1           3 FBUL SBIN HALF UNAL,
              6245    1           3 REMLO SBIN WORD,
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:6    
              6246    1           3 REMCPO SBIN WORD,
              6247    1           3 REMDO SBIN WORD,
              6248    1           3 PRDPRM SBIN,
              6249    1           3 MAXTMPDP SBIN,
              6250    1           3 MRT SBIN,
              6251    1         2 CUR_MAX,                        /*CURRENT-DEFAULT MAXIMUM*/
              6252                                                /*= TO JIT @ LOGON TIME*/
              6253    1           3 MAXCORE SBIN HALF UNAL,
              6254    1           3 FBUL SBIN HALF UNAL,
              6255    1           3 REMLO SBIN WORD,
              6256    1           3 REMCPO SBIN WORD,
              6257    1           3 REMDO SBIN WORD,
              6258    1           3 PRDPRM SBIN,
              6259    1           3 MAXTMPDP SBIN,
              6260    1           3 MRT SBIN,
              6261    1         2 STEP_MAX,                       /*JOB STEP MAXIMUM*/
              6262    1           3 MAXCORE SBIN HALF UNAL,
              6263    1           3 FBUL SBIN HALF UNAL,
              6264    1           3 REMLO SBIN WORD,
              6265    1           3 REMCPO SBIN WORD,
              6266    1           3 REMDO SBIN WORD,
              6267    1           3 PRDPRM SBIN,
              6268    1           3 MAXTMPDP SBIN,
              6269    1           3 MRT SBIN,
              6270    1         2 CUMUL,                          /*JOB CUMULATIVE*/
              6271    1           3 REMLO SBIN WORD,
              6272    1           3 REMCPO SBIN WORD,
              6273    1           3 REMDO SBIN WORD,
              6274    1           3 MAXTMPDP SBIN,
              6275    1           3 PRDPRM SBIN,
              6276    1           3 MRT SBIN;
      114     6278                                                              /**/
      115     6279        %PLIST ;
      116     6280        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:7    
      117     6281        /*********************************************************************/
      118     6282        /*   FPTS            FPTS            FPTS            FPTS            */
      119     6283        /*********************************************************************/
      120     6284                                                              /**/
      121     6285              %FPT_CPEXIT(  FPTN = FPT$CPEXIT ,
      122     6286                            STCLASS = AUTO ) ;
      123     6312            %FPT_CPEXIT(  FPTN = FPT_CPLOGOFF ,
      124     6313                          STCLASS ="CONSTANT SYMDEF");
      125     6339            %FPT_READ(FPTN = FPT_READ_SUSMES,
      126     6340                      DCB  = M$UC,
      127     6341                      STCLASS = CONSTANT);
      128     6380            %FPT_READ (FPTN = FPT$READ_SUSMES,
      129     6381                       STCLASS = AUTO);
      130     6420              %FPT_OPEN ( FPTN = FPT_OPEN_UC ,
      131     6421                          DCB = M$UC ,
      132     6422                          STCLASS = CONSTANT ) ;
      133     6531              %FPT_PROMPT(  FPTN = FPT_PROMPT_RESET, STCLASS = CONSTANT ) ;
      134     6559              %FPT_PROMPT(  FPTN = FPT_PROMPT_SUSYNDMES ,
      135     6560                            PROMPT = SUSYNDMES ,
      136     6561                            DCB = M$UC ,
      137     6562                            TRANS = NO ,
      138     6563                            VFC = YES ,
      139     6564                            STCLASS = CONSTANT ) ;
      140     6592              %FPT_WRITE( FPTN = FPT_WRITE_SUSMES ,
      141     6593                          BUF = SUSMES ,
      142     6594                          DCB = M$UC ,
      143     6595                          VFC = YES ,
      144     6596                          STCLASS = CONSTANT ) ;
      145     6627              %FPT_OCMSG (  FPTN = FPT_OCMSG ,
      146     6628                            MSG = USERS_NO_VAL ,
      147     6629                            OCTYPE = ADCOM ,
      148     6630                            STCLASS = CONSTANT ) ;
      149     6646         %FPT_TRAP ( ARITHMETIC=ALA$TRAP,ERRORS=ALA$TRAP,PROGRAMMED=ALA$TRAP,
      150     6647                    PMME=ALA$TRAP,DIVIDE_CHECK=TRAP,OVERFLOW=TRAP,COMMAND=TRAP,
      151     6648                    IPR=TRAP,LOCKUP=TRAP,MEMORY=TRAP,MISSING_PAGE=TRAP,
      152     6649                    MISSING_SEG=TRAP,SECURITY_1=TRAP,SECURITY_2=TRAP,
      153     6650                    DERAIL=TRAP,FAULT_TAG=TRAP,MME=TRAP,STCLASS=CONSTANT);
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:8    
      154     6673        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:9    
      155     6674        /*********************************************************************/
      156     6675        /*   ENTRIES         ENTRIES         ENTRIES         ENTRIES         */
      157     6676        /*********************************************************************/
      158     6677                                                              /**/
      159     6678    1   DCL ALA$OPEN_USERS ENTRY ALTRET ;
      160     6679    1   DCL ALA$BANNER2_STAR_S ENTRY (3) ALTRET ;
      161     6680    1   DCL ALA$CLOSE_USERS ENTRY ALTRET ;
      162     6681    1   DCL ALA$READ_USERS ENTRY(2) ALTRET ;
      163     6682    1   DCL ALA$GETUSERS ENTRY ALTRET ;
      164     6683    1   DCL ALA$LOG_ON ENTRY ;
      165     6684    1   DCL ALA$CPEXIT ENTRY(1) ;
      166     6685    1   DCL ALA$ERROR ENTRY(4) ;
      167     6686    1   DCL ALA$READ_SEQ_USERS ENTRY(2) ALTRET ;
      168     6687    1   DCL ALA$HEADING ENTRY(1) ;
      169     6688    1   DCL ALA$TIME ENTRY(1) ;
      170     6689    1   DCL ALA$OPEN_STAR_A ENTRY(1) ALTRET ;
      171     6690    1   DCL ALA$OPEN_STAR_S ENTRY(1) ALTRET ;
      172     6691    1   DCL ALA$CLOSE_STAR ENTRY ALTRET ;
      173     6692    1   DCL ALA$GETSTARS ENTRY ALTRET ;
      174     6693    1   DCL ALA$WRITE_STAR ENTRY(5) ALTRET ;
      175     6694    1   DCL ALA$WRITE_USERS ENTRY(2) ALTRET ;
      176     6695    1   DCL ALA$YESNOD ENTRY(2) ALTRET ;
      177     6696    1   DCL ALA$TRAP ENTRY ASYNC;
      178     6697    1   DCL ALA$SYS_ERROR ENTRY;
      179     6698        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:10   
      180     6699        /*********************************************************************/
      181     6700        /*   SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    */
      182     6701        /*********************************************************************/
      183     6702                                                              /**/
      184     6703    1   DCL SYS_UMAX SBIN WORD CONSTANT INIT(50000) ;
      185     6704        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:11   
      186     6705        /*********************************************************************/
      187     6706        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      188     6707        /*********************************************************************/
      189     6708                                                              /**/
      190     6709    1   BEGIN: ;
      191     6710                                                     /**/
      192     6711    1         LIMIT_KEY.CNT = 5;
      193     6712    1         LIMIT_KEY.TEXT = 'LIMIT';
      194     6713    1         DCB$ = DCBADDR(DCBNUM(M$UC));
      195     6714    1         MODE = B$JIT.MODE;
      196     6715    1         AL_ACCT = B$JIT.ACCN;
      197     6716    2         CALL M$TRAP( FPT_TRAP ) WHENALTRETURN DO;
      198     6717    2             END;
      199     6718    1         AL$TSTAMP.UTS = B$JIT.LOGONTIME;
      200     6719    1         CALL ALA$TIME( AL$TSTAMP );
      201     6720                                                     /**/
      202     6721                                                     /* ASSOCIATE SUSPENDED PROGRAM   */
      203     6722                                                     /* IF DESIRED                    */
      204     6723    1         IF MODE=%M_INT# AND DCB$->F$DCB.ASN#=%DEVICE#
      205     6724    2         THEN DO;          /* ONLINE OR CONSOLE GHOST */
      206     6725    2             CALL M$FSUSER ALTRET(NOT_SUSPENDED);
      207     6726    2             CALL M$OPEN( FPT_OPEN_UC ) ALTRET( READ_ERR_MESS ) ;
      208     6727    2             CALL M$WRITE( FPT_WRITE_SUSMES ) ;
      209     6728    2             CALL M$PROMPT( FPT_PROMPT_SUSYNDMES ) ;
      210     6729    2             FPT$READ_SUSMES = FPT_READ_SUSMES;
      211     6730    2             FPT$READ_SUSMES.V_ = VECTOR(FPT$READ_SUSMES.V);
      212     6731    2             FPT$READ_SUSMES.BUF_ = VECTOR(SUSMES_ANS);
      213     6732    2   YESNOD_ALT: ;
      214     6733    2             SUSMES_ANS = AL_BLANK ;
      215     6734    2             CALL M$READ(FPT$READ_SUSMES) ALTRET(YESNOD_ALT);
      216     6735    2             ARS = DCB$ -> F$DCB.ARS# ;
      217     6736    2             CALL ALA$YESNOD( SUSMES_ANS, ARS ) ALTRET( YESNOD_ALT );
      218     6737    2             CALL M$PROMPT( FPT_PROMPT_RESET );       /* Reset to the default prompt */
      219     6738    2             IF SUSMES_ANS = 'Y'
      220     6739    2             THEN                            /* RECONNECT */
      221     6740    3             DO ;
      222     6741    3                 CALL M$ASUSER ALTRET( ASUSER_ALT ) ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:12   
      223     6742    3                 CALL ALA$CPEXIT ;            /* LOG OFF THIS USER */
      224     6743    3                 END ; /* THEN DO */
      225     6744    2             ELSE
      226     6745    2                 IF SUSMES_ANS = 'D'
      227     6746    2                 THEN                    /* DELETE */
      228     6747    2                     CALL M$DSUSER ALTRET( DSUSER_ALT ) ;
      229     6748    3             DO WHILE( '0'B ) ;
      230     6749    3   ASUSER_ALT:   ;
      231     6750        /*E*  ERROR:    ALA-E$ASUSER_ERR-C
      232     6751              MESSAGE0: Image lost, no reconnect.
      233     6752        */
      234     6753    3                 CALL ALA$ERROR( ALA_E$ASUSER_ERR );
      235     6754    3                 END ; /* DO WHILE */
      236     6755    3             DO WHILE( '0'B ) ;
      237     6756    3   DSUSER_ALT:   ;
      238     6757        /*E*  ERROR:    ALA-E$DSUSER_ERR-C
      239     6758              MESSAGE0: Image already deleted.
      240     6759        */
      241     6760    3                 CALL ALA$ERROR( ALA_E$DSUSER_ERR );
      242     6761    3                 END ; /* DO WHILE */
      243     6762    2   NOT_SUSPENDED:
      244     6763    2             END;
      245     6764                                                              /**/
      246     6765    1         B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_FIRSTCP# ;
      247     6766    1         FPT$CPEXIT = FPT_CPLOGOFF ;
      248     6767    1         FPT$CPEXIT.NAME_ = VECTOR(CP_NAME) ;
      249     6768    1         FPT$CPEXIT.ACCT_ = VECTOR(CP_ACCT) ;
      250     6769    1         FPT$CPEXIT.PASS_ = VECTOR(CP_PASSW) ;
      251     6770    1         FPT$CPEXIT.V_ = VECTOR(FPT$CPEXIT.V) ;
      252     6771    1         IF B$JIT$ -> B$JIT.USRERR.CODE ~= 0
      253     6772    1         THEN
      254     6773    1             CALL CP_NO_EXISTS ;
      255     6774              /*                               */
      256     6775                                                              /* IS THIS A SYSTEM GHOST? */
      257     6776    1         IF B$JIT.USER <= 15/*JG_MING#    */
      258     6777    1         THEN
      259     6778    1             SYS_GHOST = AL_TRUE ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:13   
      260     6779    1         ELSE
      261     6780    1             SYS_GHOST = AL_FALSE ;
      262     6781              /*                               */
      263     6782    1         NOSETUP = B$JIT.BLINDACCTNG; /* SAVE THE FLAG */
      264     6783    1         NOHEADER = B$JIT.LOCK (0); /* SAVE THE FLAG */
      265     6784    1         CP_SLEAZE_SET = AL_FALSE;
      266     6785    1         IF (B$JIT.CPFLAGS1 & %CP_SLEAZE#) = %CP_SLEAZE#
      267     6786    2         THEN DO ;
      268     6787    2             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 & ~%CP_SLEAZE#;
      269     6788    2             CP_SLEAZE_SET = AL_TRUE;
      270     6789    2             AS_USERS = DF_USERS ;
      271     6790    2             CP_NAME = DF_CP_NAME ;
      272     6791    2             CP_ACCT = DF_CP_ACCT ;
      273     6792    2             CP_PASSW = DF_CP_PASS ;
      274     6793    2             B$JIT.SSLEV = %AZ_NONE# ;
      275     6794    2             B$JIT.PSLEV = %AZ_NONE# ;
      276     6795    2             B$JIT.JSLEV = %AZ_NONE# ;
      277     6796    2             GOTO DO_STARS ;
      278     6797    2             END ;   /*   THEN DO   */
      279     6798                                                              /*   SET UP USERS_KEY  */
      280     6799    1         CALL CONCAT( USERS_KEY.TEXT, B$JIT.ACCN, B$JIT.UNAME );
      281     6800    2         IF USERS_KEY.TEXT = AL_BLANK THEN DO;
      282     6801        /*E*  ERROR:  ALA-E$BLANK_ACCT_UNAME-A
      283     6802              MESSAGE: B$JIT.ACCT and B$JIT.UNAME are blank.
      284     6803        */
      285     6804    2             CALL ALA$ERROR( ALA_E$BLANK_ACCT_UNAME );
      286     6805    2             CALL ALA$CPEXIT;
      287     6806    2             END;
      288     6807    1         CALL INDEX( I, AL_BLANK, B$JIT.UNAME );
      289     6808    1         USERS_KEY.CNT = 8 + I;
      290     6809                                                      /* READ IN A :USERS RECORD. */
      291     6810    1         CALL ALA$GETUSERS ;                     /* SET UP M$USERS DCB FOR READ. */
      292     6811    1         CALL ALA$OPEN_USERS ALTRET(OPEN_USERS_ERR) ;
      293     6812    1         CALL ALA$READ_USERS (USERS_KEY, AS_USERS) ALTRET(READ_USERS_ERR) ;
      294     6813                                                              /*   RECORD EXISTS.  */
      295     6814                        /*                                    */
      296     6815                        /*      CHECK BUDGET.                 */
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:14   
      297     6816                        /*                                    */
      298     6817    1   USER_OK: ;
      299     6818                                                              /**/
      300     6819                                                              /*   SET ECHO IN JIT.   */
      301     6820    1         B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_ECHO# | %CP_CFREAD#;
      302     6821    1         B$JIT.PRIV.AUTH = AS_USERS.PRIV(MODE-1) ;
      303     6822                                                              /*  SHUT OFF EFT AND BLK */
      304     6823    1         B$JIT.PRIV.AUTH = B$JIT.PRIV.AUTH & ~%PR_FMEFT# & ~%PR_FMBLK#;
      305     6824                                                          /* SET ACTIVE, JOB, PRC TO '0'B */
      306     6825    1         B$JIT.PRIV.ACTIVE = '0'B ;
      307     6826    1         B$JIT.PRIV.JOB = '0'B ;
      308     6827    1         B$JIT.PRIV.PRC = '0'B ;
      309     6828                                                              /* Set PROC. PRIV. */
      310     6829    1         B$JIT.PPRIV = AS_USERS.PPRIV(MODE-1) ;
      311     6830    1         B$JIT.PRIOB = AS_USERS.PRIOB(MODE-1) ;
      312     6831    1         B$JIT.QUAN = AS_USERS.QUAN(MODE-1) * 1000;
      313     6832    1         IF AS_USERS.MAXENQ(MODE-1)>0 THEN B$JIT.MAXENQ = AS_USERS.MAXENQ(MODE-1);
      314     6833                                                        /* Set misc. stuff. */
      315     6834    1         B$JIT.CSLEV = 0; /* Level count for nested XEQs. */
      316     6835                                                             /**/
      317     6836    1         CALL BUDGET ALTRET(BUDGET_ERR) ;
      318     6837                                                              /*   BUDGET OK.   */
      319     6838    1   BUDGET_OK: ;
      320     6839                                                      /* Set BLIND ACCOUNTING */
      321     6840    1         B$JIT.BLINDACCTNG = AS_USERS.BUDGET.BLINDACCTNG;
      322     6841                                                              /*  MOVE HOME PACK SET.  */
      323     6842    1         B$JIT.HPSN = AS_USERS.HPSN ;
      324     6843    1         IF (B$JIT.CPFLAGS1 & %CP_BUFFULL#) = '0'B THEN CALL FREECMD ;
      325     6844    1         CALL CPROC ;
      326     6845                                                              /* CHECK FOR LAST CPROC */
      327     6846    1         IF AS_USERS.LASTCPROC.NAME.CNT(MODE-1) > 0 THEN
      328     6847    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_LASTCPEXISTS#;
      329     6848                                                     /* Set limits in the JIT         */
      330     6849    1         B$JIT.REMLO = AS_USERS.DLO(MODE-1);
      331     6850    1         IF (AS_USERS.MLO(MODE-1) = 0) /*IF LO=0 ->DONT ALLOW LO OUTPUT*/
      332     6851    1         THEN B$JIT.NOLOEVER = '1'B;
      333     6852    1         ELSE B$JIT.NOLOEVER = '0'B;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:15   
      334     6853    1         B$JIT.REMDO = AS_USERS.DDO(MODE-1);
      335     6854    1         IF (AS_USERS.MDO(MODE-1) = 0) /*IF DO=0 ->DONT ALLOW DO OUTPUT*/
      336     6855    1         THEN B$JIT.NODOEVER = '1'B;
      337     6856    1         ELSE B$JIT.NODOEVER = '0'B;
      338     6857    1         B$JIT.REMCPO = AS_USERS.DPO(MODE-1);
      339     6858    1         IF (AS_USERS.MPO(MODE-1) = 0) /*IF PO=0 ->DONT ALLOW PO OUTPUT*/
      340     6859    1         THEN B$JIT.NOPOEVER = '1'B;
      341     6860    1         ELSE B$JIT.NOPOEVER = '0'B;
      342     6861    1         B$JIT.MAXTMPDP = AS_USERS.DTDIS(MODE-1);
      343     6862    1         B$JIT.FBUL = MAXIMUM( AS_USERS.DFPOOLS(MODE-1), 5 );
      344     6863    1         B$JIT.DEFEXP = AS_USERS.DEXP;
      345     6864    1         B$JIT.MAXEXP = AS_USERS.MEXP;
      346     6865    1         B$JIT.PRDPRM = AS_USERS.DPDIS(MODE-1);
      347     6866    1         B$JIT.DEFPRI = AS_USERS.DMPRIO( MODE-1 ) ;
      348     6867    1         B$JIT.MAXPRI = AS_USERS.MMPRIO( MODE-1 ) ;
      349     6868    1         B$JIT.LOCK = AS_USERS.KEY;
      350     6869    1         IF AS_USERS.STEPACCNT
      351     6870    1         THEN
      352     6871    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STEPACCT# ;
      353     6872                                                              /* SET *S ACCOUNTING */
      354     6873    1         IF AS_USERS.FLAGS.STARSACC THEN
      355     6874    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STARSACC# ;
      356     6875    1         B$JIT.SSLEV = %AZ_NONE# ;
      357     6876    1         B$JIT.PSLEV = %AZ_NONE# ;
      358     6877    1         B$JIT.LANG = AS_USERS.NAT_LANG ;
      359     6878    1         B$JIT.OUTPRIO = AS_USERS.OUTPUTPRIO ;
      360     6879    1         IF MODE=%M_BATCH#
      361     6880    2         THEN DO;
      362     6881    2             B$JIT.JSLEV = %AZ_ALL#;
      363     6882    2             B$JIT.OLTA = '00'B;
      364     6883    2             END;
      365     6884    2         ELSE DO;
      366     6885    3             DO CASE(MODE);
      367     6886    3               CASE(%M_INT#);
      368     6887    3                 B$JIT.JSLEV = %AZ_SUMMARY#;
      369     6888    3               CASE(%M_GHOST#);
      370     6889    3                 B$JIT.JSLEV = %AZ_ALL# ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:16   
      371     6890    3               CASE(%M_TP#);
      372     6891    3                 B$JIT.JSLEV = %AZ_NONE# ;
      373     6892    3               END;
      374     6893    2             B$JIT.MRT = AS_USERS.DTIME(MODE-1);
      375     6894    2             B$JIT.MAXCORE = AS_USERS.DMEM(MODE-1);
      376     6895    2             B$JIT.RESCORE = B$JIT.MAXCORE ;
      377     6896    3             DO CASE(AS_USERS.RESL.OMAX(0));
      378     6897    3               CASE(0);
      379     6898    3                 B$JIT.OLTA = '00'B;
      380     6899    3               CASE(1);
      381     6900    3                 B$JIT.OLTA = '10'B;
      382     6901    3               CASE(ELSE);
      383     6902    3                 B$JIT.OLTA = '11'B;
      384     6903    3               END;
      385     6904    2             END;
      386     6905                                                             /**/
      387     6906    1         CALL CLRES;
      388     6907                                                              /* SET UP LIMIT
      389     6908                                                                 RECORD FOR '*S' */
      390     6909    1   DO_STARS: ;
      391     6910    1         CALL ALA$GETSTARS ;                             /*   SET UP M$STARS DCB.   */
      392     6911    1         CALL ALA$OPEN_STAR_A ( AL_ACCT ) ALTRET ( OPEN_A_ERR ) ;
      393     6912    1   OPEN_A_OK: ;
      394     6913    1         CALL ALA$CLOSE_STAR ALTRET ( CLOSE_A_ERR ) ;
      395     6914    1   CLOSE_A_OK: ;
      396     6915    1         CALL ALA$OPEN_STAR_S( AL_ACCT ) ALTRET ( OPEN_S_ERR ) ;
      397     6916    1   OPEN_S_OK: ;
      398     6917    1         CP_LIMREC = '0'B ;
      399     6918    1         CP_LIMREC.USER_MAX.MAXCORE = AS_USERS.MMEM(MODE-1) ;
      400     6919    1         CP_LIMREC.CUR_MAX.MAXCORE = B$JIT.MAXCORE ;
      401     6920    1         CP_LIMREC.USER_MAX.REMLO = AS_USERS.MLO(MODE-1) ;
      402     6921    1         CP_LIMREC.CUR_MAX.REMLO = B$JIT.REMLO ;
      403     6922    1         CP_LIMREC.USER_MAX.REMCPO = AS_USERS.MPO(MODE-1) ;
      404     6923    1         CP_LIMREC.CUR_MAX.REMCPO = B$JIT.REMCPO ;
      405     6924    1         CP_LIMREC.USER_MAX.REMDO = AS_USERS.MDO(MODE-1) ;
      406     6925    1         CP_LIMREC.CUR_MAX.REMDO = B$JIT.REMDO ;
      407     6926    1         CP_LIMREC.USER_MAX.MAXTMPDP = AS_USERS.MTDIS(MODE-1) ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:17   
      408     6927    1         CP_LIMREC.CUR_MAX.MAXTMPDP = B$JIT.MAXTMPDP ;
      409     6928    1         CP_LIMREC.USER_MAX.PRDPRM = AS_USERS.MPDIS(MODE-1) ;
      410     6929    1         CP_LIMREC.CUR_MAX.PRDPRM = B$JIT.PRDPRM ;
      411     6930    1         CP_LIMREC.USER_MAX.FBUL = AS_USERS.MFPOOLS(MODE-1) ;
      412     6931    1         CP_LIMREC.CUR_MAX.FBUL = B$JIT.FBUL ;
      413     6932    1         CP_LIMREC.USER_MAX.MRT = B$JIT.MRT ;
      414     6933    1         CP_LIMREC.CUR_MAX.MRT = B$JIT.MRT ;
      415     6934                                                              /* OUTPUT RECORD */
      416     6935    1         ARS = LENGTHC( CP_LIMREC ) ;
      417     6936    1         TEXT$ = ADDR( CP_LIMREC ) ;
      418     6937    1         CALL ALA$WRITE_STAR( TEXT$, ARS, LIMIT_KEY, AL_DCB2#, ERR_CODE)
      419     6938    1                 ALTRET( WRITE_STAR_S_ERR ) ;
      420     6939                   /* Call the routine to put the bannertext record into
      421     6940                      *S file.
      422     6941                   */
      423     6942    1         IF ((B$JIT.CPFLAGS1 & %CP_SLEAZE#) ~= %CP_SLEAZE#)
      424     6943    2         THEN DO ;
      425     6944    2             KEY$ = ADDR (AS_USERS);
      426     6945    2             CALL ALA$BANNER2_STAR_S (KEY$, AL_DCB2#, ERR_CODE) ALTRET (
              6945                      WRITE_STAR_S_ERR);
      427     6946    2             END;
      428     6947                                                              /**/
      429     6948    1         CALL ALA$CLOSE_STAR ALTRET ( CLOSE_S_ERR ) ;
      430     6949    1   CLOSE_S_OK: ;
      431     6950    1         B$JIT.LOGONTIME = AL$TSTAMP.UTS ;
      432     6951    1         IF NOT CP_SLEAZE_SET
      433     6952    2         THEN DO;
      434     6953    2             CALL SET_LAST_LOGON_TIME;
      435     6954    2             CALL ALA$WRITE_USERS (USERS_KEY, AS_USERS) ALTRET(READ_USERS_ERR);
      436     6955    2             END;  /* Then Do */
      437     6956    1         B$JIT.BILL = AS_USERS.BILL( MODE-1 ) ;
      438     6957    1         TEMP_BIT = B$JIT.BLINDACCTNG;
      439     6958    1         B$JIT.BLINDACCTNG = NOHEADER;
      440     6959    1         CALL ALA$HEADING( AL$TSTAMP ) ;
      441     6960    1         B$JIT.BLINDACCTNG = TEMP_BIT;  /* RESTORE FROM TEMP. */
      442     6961    1         CALL ALA$CPEXIT(FPT$CPEXIT);
      443     6962                                                              /**/
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:18   
      444     6963    1   READ_USERS_ERR: ;
      445     6964    1   READ_ERR_MESS: ;
      446     6965                                                              /**/
      447     6966        /*E*  ERROR:    ALA-E$USERS_FILE_ERR-C
      448     6967              MESSAGE:  Unable to logon -- see your SYSTEM MANAGER.
      449     6968
      450     6969        */
      451     6970    1         CALL ALA$SYS_ERROR;
      452     6971    1         CALL ALA$ERROR( ALA_E$USERS_FILE_ERR );
      453     6972                                                              /**/
      454     6973    1         IF SYS_GHOST
      455     6974    1         THEN
      456     6975    1             CALL ALA$CPEXIT( FPT$CPEXIT ) ;
      457     6976    1         ELSE
      458     6977    1             CALL ALA$CPEXIT ;
      459     6978                                                              /**/
      460     6979                                                              /*   OPEN :USERS ERROR.   */
      461     6980    1   OPEN_USERS_ERR: ;
      462     6981                                                              /**/
      463     6982    1         CALL ALA$SYS_ERROR;
      464     6983                                                       /*   OUTPUT MESSAGE TO OPERATOR.   */
      465     6984    1         CALL M$OCMSG ( FPT_OCMSG ) ;
      466     6985                                                              /**/
      467     6986    1   BUDGET_ERR: ;
      468     6987    1         IF SYS_GHOST
      469     6988    1         THEN
      470     6989    1             CALL ALA$CPEXIT( FPT$CPEXIT ) ;
      471     6990    1         ELSE
      472     6991    1             CALL ALA$CPEXIT ;
      473     6992                                                              /**/
      474     6993    1   OPEN_A_ERR: GOTO OPEN_A_OK ;
      475     6994    1   CLOSE_A_ERR: GOTO CLOSE_A_OK ;
      476     6995    1   OPEN_S_ERR: GOTO OPEN_S_OK ;
      477     6996    1   CLOSE_S_ERR: GOTO CLOSE_S_OK ;
      478     6997    1   WRITE_STAR_S_ERR: ;
      479     6998                                                              /**/
      480     6999        /*E*  ERROR:    ALA-E$WRITE_S_ERR-C
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:19   
      481     7000              MESSAGE:  Unable to write to *S file -- see your SYSTEM MANAGER.
      482     7001        */
      483     7002    1         CALL ALA$ERROR( ALA_E$WRITE_S_ERR );
      484     7003    1         IF SYS_GHOST
      485     7004    1         THEN
      486     7005    1             CALL ALA$CPEXIT( FPT$CPEXIT ) ;
      487     7006    1         ELSE
      488     7007    1             CALL ALA$CPEXIT ;
      489     7008        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:20   
      490     7009    1   BUDGET: PROC ALTRET ;
      491     7010                                                              /**/
      492     7011                    /*******************************/
      493     7012                    /*                             */
      494     7013                    /*          BUDGET             */
      495     7014                    /*                             */
      496     7015                    /*******************************/
      497     7016        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:21   
      498     7017        /*********************************************************************/
      499     7018        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      500     7019        /*********************************************************************/
      501     7020                                                              /**/
      502     7021                                                              /*   :USERS RECORD.   */
      503     7022              %AS_USERS (STR_NAME = T$USERS, STCLASS = AUTO) ;
      504     7200    2   DCL TEMP SBIN ;
      505     7201    2   DCL FIRST BIT(1) ;
      506     7202    2   DCL 1 FIELD1,
      507     7203    2         2 CNT UBIN BYTE UNAL,
      508     7204    2         2 TXT CHAR(40) UNAL;
      509     7205    2   DCL 1 FIELD2,
      510     7206    2         2 CNT UBIN BYTE UNAL,
      511     7207    2         2 TXT CHAR(40) UNAL;
      512     7208        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:22   
      513     7209        /*********************************************************************/
      514     7210        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      515     7211        /*********************************************************************/
      516     7212                                                              /**/
      517     7213    2         B$JIT.BUDLIM = 0;
      518     7214    2         UMAX = BITBIN('377777777777'O);
      519     7215    2         IF AS_USERS.BUDGET.ICHARGES  AND  AS_USERS.BUDGET.MAXC > -1
      520     7216    3         THEN DO;
      521     7217    3             TEMP = AS_USERS.BUDGET.MAXC - AS_USERS.BUDGET.ACCUM;
      522     7218    3             IF NOT AS_USERS.BUDGET.BKACC  AND  TEMP <= 0
      523     7219    4             THEN DO;
      524     7220        /*E* ERROR:   ALA-E$MAXC_EXCEEDED-C
      525     7221             MESSAGE: Individual budget exceeded -- unable to logon.
      526     7222        */
      527     7223    4                 CALL ALA$ERROR( ALA_E$MAXC_EXCEEDED );
      528     7224    4                 ALTRETURN;
      529     7225    4                 END;
      530     7226    3             IF AS_USERS.BUDGET.BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );
      531     7227    3             END;
      532     7228                                                      /*
      533     7229                                                         Do any project accounting
      534     7230                                                      */
      535     7231    2         T$USERS = AS_USERS;
      536     7232    2         MASTER_ACCT = AS_USERS.BUDGET.MACCT;
      537     7233    3         DO WHILE( T$USERS.BUDGET.PCHARGES  AND  MASTER_ACCT ~= NO_MACCOUNT );
      538     7234    3             CALL ALA$READ_USERS( MASTER_ACCT, T$USERS ) ALTRET(READ_USERS_ERR);
      539     7235    4             IF T$USERS.BUDGET.PMAXC > -1 THEN DO;
      540     7236    4                 TEMP = T$USERS.BUDGET.PMAXC - T$USERS.BUDGET.PACCUM;
      541     7237    5                 IF NOT T$USERS.BUDGET.BKACC AND TEMP <= 0 THEN DO;
      542     7238        /*E* ERROR:   ALA-E$PMAXC_EXCEEDED-C
      543     7239             MESSAGE: Unable to logon.  Budget for project "%U1,%U2" exceeded.
      544     7240        */
      545     7241    5   PROJECT_BUDGET_EXCEEDED:
      546     7242    5                     CALL INDEX( I, AL_BLANK, MASTER_ACCT.ACCT );
      547     7243    5                     FIELD1.CNT = I;
      548     7244    5                     FIELD1.TXT = MASTER_ACCT.ACCT;
      549     7245    5                     FIELD2.CNT = MASTER_ACCT.CNT - 8;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:23   
      550     7246    5                     FIELD2.TXT = MASTER_ACCT.NAME;
      551     7247    5                     CALL ALA$ERROR( ALA_E$PMAXC_EXCEEDED, FIELD1, FIELD2 );
      552     7248    5                     ALTRETURN;
      553     7249    5                     END;
      554     7250    4                 IF AS_USERS.BUDGET.BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );
      555     7251    4                 END;
      556     7252    3             MASTER_ACCT = T$USERS.BUDGET.MACCT;
      557     7253    3             END;
      558     7254    2         IF AS_USERS.BUDGET.BUDLIM THEN B$JIT.BUDLIM = MAXIMUM( 1, UMAX );
      559     7255    2         RETURN;
      560     7256
      561     7257    2   READ_USERS_ERR:
      562     7258                                                              /**/
      563     7259                                                              /**/
      564     7260        /*E*  ERROR:    ALA-E$NO_MASTER-C
      565     7261              MESSAGE:  PROJECT ADMINISTRATOR does not exist -- unable to logon.
      566     7262
      567     7263        */
      568     7264    2         CALL ALA$ERROR( ALA_E$NO_MASTER );
      569     7265                                                              /**/
      570     7266    2         ALTRETURN ;
      571     7267    2   END   BUDGET ;
      572     7268        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:24   
      573     7269                                                              /**/
      574     7270    1   CPROC: PROC ;
      575     7271                                                                      /**/
      576     7272    2         IF AS_USERS.CPROC.NAME.CNT(MODE-1) ~= 0
      577     7273    2         THEN
      578     7274    3         DO ;
      579     7275    3             CP_NAME = AS_USERS.CPROC.NAME(MODE-1) ;
      580     7276    3             CP_ACCT = ':SYS' ;
      581     7277    3             CP_PASSW = ' ' ;
      582     7278    3             END ;   /*  THEN DO  */
      583     7279    2         ELSE
      584     7280    3         DO ;
      585     7281    3             CP_NAME = DF_CP_NAME ;
      586     7282    3             CP_ACCT = ':SYS' ;
      587     7283    3             CP_PASSW = ' ' ;
      588     7284    3             END ;   /*  ELSE DO  */
      589     7285                                                              /**/
      590     7286    2         RETURN ;
      591     7287                                                              /**/
      592     7288    2   END   CPROC ;
      593     7289        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:25   
      594     7290                                                              /**/
      595     7291    1   FREECMD: PROC ;
      596     7292                                                                      /**/
      597     7293    2         IF AS_USERS.SETUP(MODE-1) = -1     /* Empty */
      598     7294    2         THEN
      599     7295                                                              /*  NO FREE COMMAND   */
      600     7296    2             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 &~ %CP_BUFFULL#;
      601     7297    2         ELSE
      602     7298    3         DO ;
      603     7299                                                              /*   FREE COMMAND EXITS   */
      604     7300    3             TEXT$=PINCRC(ADDR(AS_USERS.SETUP_CHRA.TXT),AS_USERS.SETUP(MODE-1));
      605     7301    3             B$JIT$ -> B$JIT.CCARS = TEXT$ -> TEXT$C.L;
      606     7302    3             B$JIT$ -> B$JIT.CCDISP = TEXT$ -> TEXT$C.L;
      607     7303    3             B$JIT$ -> B$JIT.CCBUF = TEXT$ -> TEXT$C.C;
      608     7304    3             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;
      609     7305    3             IF NOSETUP
      610     7306    4             THEN DO;
      611     7307    4                 IF (AS_USERS.SETUP_FORCE (MODE - 1) )
      612     7308    5                 THEN DO;
      613     7309        /*E* ERROR:  ALA-E$SETUP_FORCED-C
      614     7310             MESSAGE0: NS option ignored, your authorization requires setup.
      615     7311             MESSAGE1: You specified NoSetup when logging on, but your system
      616     7312                       administrator wants the FORCE to be with you.
      617     7313             MESSAGE2: If you have the FORCE, then your setup command must
      618     7314                       be executed.
      619     7315        */
      620     7316    5                     CALL ALA$ERROR (ALA_E$SETUP_FORCED);
      621     7317    5                     END;
      622     7318    5                 ELSE DO;
      623     7319    5                     B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 &~ %CP_BUFFULL#;
      624     7320    5                     END;
      625     7321    4                 END;
      626     7322    3             END ;   /*  THEN DO  */
      627     7323                                                              /**/
      628     7324    2         RETURN ;
      629     7325                                                              /**/
      630     7326    2   END   FREECMD ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:26   
      631     7327        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:27   
      632     7328                                                              /**/
      633     7329    1   CP_NO_EXISTS: PROC ;
      634     7330                                                              /**/
      635     7331                                                              /**/
      636     7332        /*********************************************************************/
      637     7333        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      638     7334        /*********************************************************************/
      639     7335                                                              /**/
      640     7336    2   DCL 1 ERR_BUF ALIGNED ,
      641     7337    2         2 CNT UBIN(9) UNAL ,
      642     7338    2         2 TEXT CHAR(40) UNAL ;
      643     7339    2   DCL CNT UBIN WORD ;
      644     7340    2   DCL I UBIN WORD ;
      645     7341        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:28   
      646     7342        /*********************************************************************/
      647     7343        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      648     7344        /*********************************************************************/
      649     7345                                                              /**/
      650     7346                                                             /*   PICK UP CP NAME.ACCT.   */
      651     7347    2         CP_NAME = DCBADDR(%M$LM#) -> F$DCB.NAME# ;
      652     7348    2         CP_ACCT = DCBADDR(%M$LM#) -> F$DCB.ACCT# ;
      653     7349                                                         /*   MOVE CP NAME TO ERR_BUFF.   */
      654     7350    2         ERR_BUF.TEXT = CP_NAME.NAME# ;
      655     7351                                                              /*   FIND SIZE OF ACCT.   */
      656     7352    2         CALL INDEX( CNT, AL_BLANK, CP_ACCT );
      657     7353                                                              /**/
      658     7354    2         ERR_BUF.CNT = CNT + CP_NAME.L# + 2 ;
      659     7355                                                             /*   MOVE ACCT TO ERR_BUF.   */
      660     7356    2         CALL INSERT(ERR_BUF.TEXT, CP_NAME.L#, 9, '.', CP_ACCT) ;
      661     7357                                                              /**/
      662     7358                                                              /*   CHECK FOR DEFAULT CP.  */
      663     7359    2         IF CP_NAME = DF_CP_NAME AND CP_ACCT = DF_CP_ACCT
      664     7360    2         THEN
      665     7361    3         DO ;
      666     7362    3             ERR_CODE.CODE = 1 /* DF_CP_MISSING */ ;
      667     7363    3             ERR_CODE.SEV = 7 ;
      668     7364    3             END ;   /*  THEN DO  */
      669     7365    2         ELSE
      670     7366    3         DO ;
      671     7367    3             ERR_CODE.CODE = 2 /* CP_MISSING */ ;
      672     7368    3             ERR_CODE.SEV = 0 ;
      673     7369    3             END ;   /*  ELSE DO  */
      674     7370    2         ERR_CODE.FCG_MID = FCG ;
      675     7371                                                              /**/
      676     7372        /*E*  ERROR:    ALA-E$DF_CP_MISSING-C
      677     7373              MESSAGE7: The default command processor %%U1%does not exist.
      678     7374                        See SYSTEM MANAGER.
      679     7375
      680     7376        */
      681     7377                                                              /**/
      682     7378        /*E*  ERROR:    ALA-E$CP_MISSING-C
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:29   
      683     7379              MESSAGE:  Command processor %%U1 %does not exist.
      684     7380
      685     7381        */
      686     7382                                                              /**/
      687     7383    2         CALL ALA$ERROR(ERR_CODE, ERR_BUF.CNT) ;
      688     7384                                                             /*   IF DEFAULT CP LOG-OFF.  */
      689     7385    2         IF ERR_CODE.CODE = 1 /* DF_CP_MISSING */
      690     7386    2         THEN
      691     7387    2             IF SYS_GHOST
      692     7388    2             THEN
      693     7389    2                 CALL ALA$CPEXIT( FPT$CPEXIT ) ;
      694     7390    2             ELSE
      695     7391    2                 CALL ALA$CPEXIT ;
      696     7392                                                              /**/
      697     7393                                                              /*   CPEXIT TO DEFAULT CP. */
      698     7394    2         CP_NAME = DF_CP_NAME ;
      699     7395    2         CP_ACCT = DF_CP_ACCT ;
      700     7396    2         CP_PASSW = DF_CP_PASS ;
      701     7397    2         CALL ALA$CPEXIT(FPT$CPEXIT);
      702     7398                                                              /**/
      703     7399    2   END   CP_NO_EXISTS ;
      704     7400        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:30   
      705     7401    1   CLRES: PROC;
      706     7402                                                              /**/
      707     7403        /*********************************************************************/
      708     7404        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      709     7405        /*********************************************************************/
      710     7406                                                              /**/
      711     7407    2   DCL I UBIN ;
      712     7408    2   DCL MAX UBIN;
      713     7409        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:31   
      714     7410        /*********************************************************************/
      715     7411        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      716     7412        /*********************************************************************/
      717     7413                                                              /**/
      718     7414    2         B$JIT.CLRES = '0'B;
      719     7415    3         DO I = 0 TO AS_USERS.TOT_TYPES-1;
      720     7416    3             IF AS_USERS.RESL.RNAME(I) = 'CL'
      721     7417    3             THEN
      722     7418    4             DO;
      723     7419    5                 DO CASE(MODE);
      724     7420    5                   CASE(%M_INT#);
      725     7421    5                     MAX = AS_USERS.RESL.OMAX(I);
      726     7422    5                   CASE(%M_BATCH#);
      727     7423    5                     MAX = AS_USERS.RESL.BMAX(I);
      728     7424    5                   CASE(%M_GHOST#);
      729     7425    5                     MAX = AS_USERS.RESL.GMAX(I);
      730     7426    5                   CASE(%M_TP#);
      731     7427    5                     MAX = AS_USERS.RESL.TMAX(I);
      732     7428    5                   END; /* Do Case */
      733     7429    4                 IF MAX=1
      734     7430    4                 THEN
      735     7431    4                     B$JIT.CLRES(0) = '1'B;
      736     7432    4                 IF MAX=2
      737     7433    4                 THEN
      738     7434    5                 DO;
      739     7435    5                     B$JIT.CLRES(0) = '1'B;
      740     7436    5                     B$JIT.CLRES(1) = '1'B;
      741     7437    5                     END;  /* Then Do */
      742     7438    4                 IF MAX>2
      743     7439    4                 THEN
      744     7440    4                     B$JIT.CLRES(2) = '1'B;
      745     7441    4                 END; /* Then Do */
      746     7442    3             END; /* Do I */
      747     7443
      748     7444    2         RETURN;
      749     7445
      750     7446    2   END   CLRES;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:32   
      751     7447        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:33   
      752     7448    1   SET_LAST_LOGON_TIME: PROC;
      753     7449                                                              /**/
      754     7450        /*********************************************************************/
      755     7451        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      756     7452        /*********************************************************************/
      757     7453                                                              /**/
      758     7454    2   DCL I UBIN ;
      759     7455    2   DCL POS UBIN;
      760     7456    2   DCL BAD_CNT_CHAR CHAR(10);
      761     7457    2   DCL 1 TMDATE ALIGNED ,
      762     7458    2         2 CNT UBIN(9) UNAL ,
      763     7459    2         2 BUFF UNAL ,
      764     7460    2           3 TIME CHAR(5) UNAL ,
      765     7461    2           3 * CHAR(1) UNAL ,
      766     7462    2           3 DAY CHAR(3) UNAL ,
      767     7463    2           3 * CHAR(1) UNAL ,
      768     7464    2           3 DATE CHAR(10) UNAL ,
      769     7465    2         2 RDEF_BUFF REDEF BUFF CHAR(20) ;
      770     7466    2   DCL 1 BAD_CNT_BUF,
      771     7467    2         2 CNT UBIN (9) UNAL,
      772     7468    2         2 TEXT CHAR(10);
      773     7469    2   DCL TBUF CHAR(6);
      774     7470                                                              /**/
      775     7471        /*********************************************************************/
      776     7472        /*   FPTs & VLPs     FPTs & VLPs     FPTs & VLPs     FPTs & VLPs     */
      777     7473        /*********************************************************************/
      778     7474                                                              /**/
      779     7475        %FPT_CMDVAR (FPTN = CFPT_CMDVAR,
      780     7476                     STCLASS = CONSTANT,
      781     7477                     FUN = STORE);
      782     7494        %FPT_CMDVAR (FPTN = FPT_CMDVAR,
      783     7495                     STCLASS = AUTO);
      784     7512        %VLP_NAME (FPTN=LLT_VLP,
      785     7513                   STCLASS = CONSTANT,
      786     7514                   LEN = 15,
      787     7515                   NAME = 'LAST_LOGON_TIME');
      788     7542        %VLP_NAME (FPTN=LFC_VLP,
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:34   
      789     7543                   STCLASS = CONSTANT,
      790     7544                   LEN = 19,
      791     7545                   NAME = 'LOGON_FAILURE_COUNT');
      792     7572        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:35   
      793     7573        /*********************************************************************/
      794     7574        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      795     7575        /*********************************************************************/
      796     7576                                                              /**/
      797     7577                                                              /* Setup Command variable
      798     7578                                                                 LAST_LOGON_TIME
      799     7579                                                              */
      800     7580    2         AL$LLT_TSTAMP.UTS = AS_USERS.LOGINS.LAST_LOGON_TIME(MODE-1);
      801     7581    2         CALL ALA$TIME (AL$LLT_TSTAMP);
      802     7582    2         TMDATE.RDEF_BUFF = AL_BLANK ;          /*   Blank fill time buffer. */
      803     7583    2         TMDATE.BUFF.TIME = SUBSTR (AL$LLT_TSTAMP.TIME, 0, 5);
      804     7584
      805     7585    2         TMDATE.BUFF.DAY  = AL$LLT_TSTAMP.DAY  ;
      806     7586    2         CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE.BUFF.DAY);
      807     7587    2         SUBSTR (TMDATE.BUFF.DAY, 1, 2) = SUBSTR (TBUF, 1, 2);
      808     7588
      809     7589    2         TMDATE.BUFF.DATE = AL$LLT_TSTAMP.DATE ;
      810     7590    2         CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE. BUFF.DATE);
      811     7591    2         SUBSTR (TMDATE.BUFF.DATE, 1, 2) = SUBSTR (TBUF, 1, 2);
      812     7592
      813     7593    2         TMDATE.CNT = 20;
      814     7594                                                                  /**/
      815     7595    2         FPT_CMDVAR = CFPT_CMDVAR;
      816     7596    2         FPT_CMDVAR.V_ = VECTOR(FPT_CMDVAR.V);
      817     7597    2         FPT_CMDVAR.NAME_ = VECTOR(LLT_VLP);
      818     7598    2         FPT_CMDVAR.VALUE_ = VECTOR(TMDATE);
      819     7599
      820     7600    3         CALL M$CMDVAR (FPT_CMDVAR) WHENALTRETURN DO;
      821     7601    3             END;
      822     7602                                                              /* Setup Command variable
      823     7603                                                                 LOGON_FAILURE_COUNT
      824     7604                                                              */
      825     7605    2         CALL BINCHAR(BAD_CNT_CHAR, AS_USERS.LOGINS.BAD_LOGON_CNT(MODE-1));
      826     7606    3         CALL SEARCH (POS, I, B$SR_NON_ZERO, BAD_CNT_CHAR) WHENALTRETURN DO;
      827     7607    3             POS = 9;
      828     7608    3             END;
      829     7609    2         BAD_CNT_BUF.CNT = 10 - POS;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:36   
      830     7610    2         BAD_CNT_BUF.TEXT = SUBSTR(BAD_CNT_CHAR, POS);
      831     7611                                                                  /**/
      832     7612    2         FPT_CMDVAR = CFPT_CMDVAR;
      833     7613    2         FPT_CMDVAR.V_ = VECTOR(FPT_CMDVAR.V);
      834     7614    2         FPT_CMDVAR.NAME_ = VECTOR(LFC_VLP);
      835     7615    2         FPT_CMDVAR.VALUE_ = VECTOR(BAD_CNT_BUF);
      836     7616
      837     7617    3         CALL M$CMDVAR (FPT_CMDVAR) WHENALTRETURN DO;
      838     7618    3             END;
      839     7619                                                              /* Set fields in :USERS record
      840     7620                                                              */
      841     7621    2         AS_USERS.LAST_LOGON_TIME = BINBIT(B$JIT.LOGONTIME,36);
      842     7622    2         AS_USERS.BAD_LOGON_CNT = 0;
      843     7623    2         AS_USERS.LOGINS.LAST_LOGON_TIME(MODE-1) = B$JIT.LOGONTIME;
      844     7624    2         AS_USERS.LOGINS.BAD_LOGON_CNT(MODE-1) = 0;
      845     7625
      846     7626    2         RETURN;
      847     7627
      848     7628    2   END   SET_LAST_LOGON_TIME;
      849     7629    1   END   ALA$LOGON ;
      850     7630        %EOD ;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:37   
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   AL_MACROS_C.:E05TOU  is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   AL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$LOGON.

   Procedure ALA$LOGON requires 1172 words for executable code.
   Procedure ALA$LOGON requires 1208 words of local(AUTO) storage.

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:38   

 Object Unit name= ALA$LOGON                                  File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:27:16.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    714   1312  ALA$LOGON
    2   Proc  even  none  1172   2224  ALA$LOGON
    3  RoData even  none    32     40  ALA$LOGON

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Main       0  ALA$LOGON

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1   1036  FPT_CPLOGOFF
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:39   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       1 ALA$TIME
         yes           Std       1 ALA$CPEXIT
 yes     yes           Std       1 ALA$OPEN_STAR_S
         yes          Async      0 ALA$TRAP
 yes     yes           Std       1 ALA$OPEN_STAR_A
 yes     yes           Std       2 ALA$WRITE_USERS
         yes           Std       1 ALA$HEADING
 yes     yes           Std       2 ALA$READ_USERS
         yes           Std       4 ALA$ERROR
 yes     yes           Std       0 ALA$CLOSE_STAR
 yes     yes           Std       5 ALA$WRITE_STAR
         yes           Std       0 ALA$SYS_ERROR
 yes     yes           Std       0 ALA$GETUSERS
 yes     yes           Std       0 ALA$GETSTARS
 yes     yes           Std       3 ALA$BANNER2_STAR_S
 yes     yes           Std       2 ALA$YESNOD
 yes     yes           Std       0 ALA$OPEN_USERS
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_MAUTO
                       nStd      0 X66_MARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  AL_BLANK                              AL_TRUE
     AL_FALSE                              DF_CP_NAME                            DF_CP_ACCT
     DF_CP_PASS                            AL_DCB2#                              B$JIT$
r    B$XL_LOWER_UR$                   r    B$SR_NON_ZERO$                        B_VECTNIL
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:40   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID                                 ROSID
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:41   


        1        1        /*M* ALA$LOGON   MAIN ROUTINE FOR LOGON.              */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,PLM=6,IND=4,SDI=2,CTI=8,DCI=4,CSU=2,ECU=2,ENI=4,
        8        8              THI=0,DTI=0,IAD=0                              */
        9        9                                                              /**/
       10       10        ALA$LOGON: PROC MAIN ;

     10  2 000000   000000 700200 xent  ALA$LOGON    TSX0  ! X66_MAUTO
         2 000001   002270 000000                    ZERO    1208,0

       11       11                                                              /**/
       12       12        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:42   
       13       13        /*********************************************************************/
       14       14        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
       15       15        /*********************************************************************/
       16       16                                                              /**/
       17       17              %INCLUDE AS_SUPER_C ;
       18      452              %INCLUDE KL_SUPER_C ;
       19     3354              %INCLUDE B$JIT ;
       20     3644              %INCLUDE B$TABLES_C;
       21     3752              %INCLUDE CP_6 ;
       22     3833              %INCLUDE CP_6_SUBS ;
       23     4373              %INCLUDE AL_SUBS_C ;
       24     4382              %INCLUDE AL_PERR_C ;
       25     4404              %INCLUDE AL_MACROS_C ;
       26     4430              %INCLUDE CP_MACROS_C ;
       27     5182              %INCLUDE AL_LOGON_R ;
       28     5214              %INCLUDE JG_GHOSTS_C ;
       29     5304        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:43   
       30     5305        /*********************************************************************/
       31     5306        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
       32     5307        /*********************************************************************/
       33     5308                                                              /**/
       34     5309    1   DCL FCG UBIN(18) CONSTANT INIT(4865) ;          /*  'ALA' IN SIXBIT.  */
       35     5310                                                            /*   SCRATCH :USERS RECORD.  */
       36     5311              %AS_USERS(  STR_NAME = DF_USERS ,
       37     5312                          STCLASS = CONSTANT ) ;
       38     5490    1   DCL SUSMES CHAR(0) CONSTANT INIT('aProgram held. Reconnect');
       39     5491    1   DCL SUSYNDMES CHAR(0) CONSTANT INIT('@(Y/N/D)? ') ;
       40     5492    1   DCL 1 NO_MACCOUNT ALIGNED CONSTANT,
       41     5493    1         2 CNT UBIN BYTE UNAL INIT(4),
       42     5494    1         2 ACCT CHAR(8) UNAL INIT('NONE'),
       43     5495    1         2 NAME CHAR(12) UNAL INIT( ' ' );
       44     5496       %VLP_ERRCODE(FPTN=ALA_E$ASUSER_ERR,FCG='AL',MID='A',MON='0'B,ERR#=E$ASUSER_ERR,SEV=0
              5496            ,STCLASS=CONSTANT);
       45     5541       %VLP_ERRCODE(FPTN=ALA_E$DSUSER_ERR,FCG='AL',MID='A',MON='0'B,ERR#=E$DSUSER_ERR,SEV=0
              5541            ,STCLASS=CONSTANT);
       46     5586        %VLP_ERRCODE(FPTN=ALA_E$USERS_FILE_ERR,FCG='AL',MID='A',MON='0'B,ERR#=
              5586            E$USERS_FILE_ERR,SEV=0,STCLASS=CONSTANT);
       47     5631       %VLP_ERRCODE(FPTN=ALA_E$WRITE_S_ERR,FCG='AL',MID='A',MON='0'B,ERR#=E$WRITE_S_ERR,SEV
              5631            =0,STCLASS=CONSTANT);
       48     5676       %VLP_ERRCODE(FPTN=ALA_E$MAXC_EXCEEDED,FCG='AL',MID='A',MON='0'B,ERR#=E$MAXC_EXCEEDED
              5676            ,SEV=0,STCLASS=CONSTANT);
       49     5721        %VLP_ERRCODE(FPTN=ALA_E$PMAXC_EXCEEDED,FCG='AL',MID='A',MON='0'B,ERR#=
              5721            E$PMAXC_EXCEEDED,SEV=0,STCLASS=CONSTANT);
       50     5766        %VLP_ERRCODE(FPTN=ALA_E$NO_MASTER,FCG='AL',MID='A',MON='0'B,ERR#=E$NO_MASTER,SEV=0,
              5766            STCLASS=CONSTANT);
       51     5811        %VLP_ERRCODE(FPTN=ALA_E$BLANK_ACCT_UNAME,FCG='AL',MID='A',MON='0'B,
       52     5812                      ERR#=E$BLANK_ACCT_UNAME,SEV=0,STCLASS=CONSTANT );
       53     5857        %VLP_ERRCODE(FPTN=ALA_E$SETUP_FORCED, FCG='AL', MID='A', MON='0'B,
       54     5858                      ERR#=E$SETUP_FORCED, SEV=0, STCLASS=CONSTANT );
       55     5903        %B$XL_LOWER_UR;
       56     5907        %B$SR_NON_ZERO;
       57     5911        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:44   
       58     5912        /*********************************************************************/
       59     5913        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
       60     5914        /*********************************************************************/
       61     5915                                                              /**/
       62     5916                                                              /*   :USERS RECORD.   */
       63     5917              %AS_USERS (STR_NAME = AS_USERS, STCLASS = AUTO) ;
       64     6095    1   DCL OUT_BUF CHAR(80) ;
       65     6096    1   DCL SUSMES_ANS CHAR(10);
       66     6097    1   DCL ARS UBIN ;
       67     6098    1   DCL 1 USERS_KEY ,
       68     6099    1         2 CNT UBIN(9) UNAL ,
       69     6100    1         2 TEXT CHAR(20) UNAL ;
       70     6101    1   DCL 1 LIMIT_KEY ,
       71     6102    1         2 CNT UBIN(9) UNAL ,
       72     6103    1         2 TEXT CHAR(20) UNAL ;
       73     6104    1   DCL TEXT$BUF(0:19) CHAR(1) BASED (TEXT$) UNAL ;
       74     6105    1   DCL 1 TEXT$C BASED,
       75     6106    1         2 L UBIN BYTE UNAL,
       76     6107    1         2 C CHAR(TEXT$C.L);
       77     6108    1   DCL DCB$ PTR ;
       78     6109    1   DCL KEY$ PTR ;
       79     6110    1   DCL TEXT$ PTR ;
       80     6111    1   DCL I UBIN ;
       81     6112    1   DCL UMAX SBIN ;                                 /*   MAXIMUM CHARGES.   */
       82     6113    1   DCL UACCUM UBIN ;                               /*   ACCUMULATED CHARGES.   */
       83     6114    1   DCL UBKACC BIT(1) ;                             /*   BANKRUPTCY ACCESS.   */
       84     6115    1   DCL TEMP_BIT BIT (1) ALIGNED;
       85     6116    1   DCL NOSETUP BIT(1) ALIGNED; /*BIT INDICATING IF NS WAS SET ON LOGON*/
       86     6117    1   DCL NOHEADER BIT(1) ALIGNED; /*BIT INDICATING IF NH WAS SET ON LOGON*/
       87     6118    1   DCL 1 MASTER_ACCT ,
       88     6119    1         2 CNT UBIN(9) UNAL ,
       89     6120    1         2 ACCT CHAR(8) UNAL ,
       90     6121    1         2 NAME CHAR(12) UNAL ;
       91     6122    1   DCL RE_BUDGET SBIN ;
       92     6123    1   DCL MODE UBIN WORD ;
       93     6124    1   DCL CP_SLEAZE_SET BIT(1) ;
              6124            /* Set to the Initial value of B$JIT.CPFLAGS1 & %CP_SLEAZE# */
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:45   
       94     6125              %F$DCB( DCBN = F$DCB ) ;
       95     6182              %VLP_NAME(  FPTN = CP_NAME ,
       96     6183                          LEN = 31 ,
       97     6184                          STCLASS = AUTO ) ;
       98     6211    1   DCL CP_ACCT CHAR(8) ;
       99     6212    1   DCL CP_PASSW CHAR(8) ;
      100     6213    1   DCL 1 ERR_CODE AUTO ,
      101     6214    1         2 FCG_MID UBIN(18) UNAL ,
      102     6215    1         2 CODE UBIN(15) UNAL ,
      103     6216    1         2 SEV UBIN(3) UNAL ;
      104     6217    1   DCL AL_ACCT CHAR(8) ;
      105     6218    1   DCL SYS_GHOST BIT(1) ;
      106     6219        %LIST ;
      107     6220        %SET LISTSUB='1'B;
      108     6221                                                              /**/
      109     6222              %AL$TSTAMP ;
              6223                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
              6224    1         DCL 1 AL$TSTAMP AUTO ,
              6225    1               2 UTS UBIN WORD ,
              6226    1               2 TIME CHAR(11) UNAL ,
              6227    1               2 DAY  CHAR(3) UNAL ,
              6228    1               2 DATE CHAR(10) UNAL ;
      110     6230             /* The following is really for B$JIT.LAST_LOGON_TIME, ignore the comment. */
      111     6231              %AL$TSTAMP (STNAME=AL$LLT_TSTAMP);
              6232                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
              6233    1         DCL 1 AL$LLT_TSTAMP AUTO ,
              6234    1               2 UTS UBIN WORD ,
              6235    1               2 TIME CHAR(11) UNAL ,
              6236    1               2 DAY  CHAR(3) UNAL ,
              6237    1               2 DATE CHAR(10) UNAL ;
      112     6239              %CP_LIMREC( NAME = CP_LIMREC ,
      113     6240                          STCLASS =" ") ;
              6241    1   DCL 1 CP_LIMREC ALIGNED,
              6242    1         2 USER_MAX,                       /*JOB MAXIMUM*/
              6243    1           3 MAXCORE SBIN HALF UNAL,
              6244    1           3 FBUL SBIN HALF UNAL,
              6245    1           3 REMLO SBIN WORD,
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:46   
              6246    1           3 REMCPO SBIN WORD,
              6247    1           3 REMDO SBIN WORD,
              6248    1           3 PRDPRM SBIN,
              6249    1           3 MAXTMPDP SBIN,
              6250    1           3 MRT SBIN,
              6251    1         2 CUR_MAX,                        /*CURRENT-DEFAULT MAXIMUM*/
              6252                                                /*= TO JIT @ LOGON TIME*/
              6253    1           3 MAXCORE SBIN HALF UNAL,
              6254    1           3 FBUL SBIN HALF UNAL,
              6255    1           3 REMLO SBIN WORD,
              6256    1           3 REMCPO SBIN WORD,
              6257    1           3 REMDO SBIN WORD,
              6258    1           3 PRDPRM SBIN,
              6259    1           3 MAXTMPDP SBIN,
              6260    1           3 MRT SBIN,
              6261    1         2 STEP_MAX,                       /*JOB STEP MAXIMUM*/
              6262    1           3 MAXCORE SBIN HALF UNAL,
              6263    1           3 FBUL SBIN HALF UNAL,
              6264    1           3 REMLO SBIN WORD,
              6265    1           3 REMCPO SBIN WORD,
              6266    1           3 REMDO SBIN WORD,
              6267    1           3 PRDPRM SBIN,
              6268    1           3 MAXTMPDP SBIN,
              6269    1           3 MRT SBIN,
              6270    1         2 CUMUL,                          /*JOB CUMULATIVE*/
              6271    1           3 REMLO SBIN WORD,
              6272    1           3 REMCPO SBIN WORD,
              6273    1           3 REMDO SBIN WORD,
              6274    1           3 MAXTMPDP SBIN,
              6275    1           3 PRDPRM SBIN,
              6276    1           3 MRT SBIN;
      114     6278                                                              /**/
      115     6279        %PLIST ;
      116     6280        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:47   
      117     6281        /*********************************************************************/
      118     6282        /*   FPTS            FPTS            FPTS            FPTS            */
      119     6283        /*********************************************************************/
      120     6284                                                              /**/
      121     6285              %FPT_CPEXIT(  FPTN = FPT$CPEXIT ,
      122     6286                            STCLASS = AUTO ) ;
      123     6312            %FPT_CPEXIT(  FPTN = FPT_CPLOGOFF ,
      124     6313                          STCLASS ="CONSTANT SYMDEF");
      125     6339            %FPT_READ(FPTN = FPT_READ_SUSMES,
      126     6340                      DCB  = M$UC,
      127     6341                      STCLASS = CONSTANT);
      128     6380            %FPT_READ (FPTN = FPT$READ_SUSMES,
      129     6381                       STCLASS = AUTO);
      130     6420              %FPT_OPEN ( FPTN = FPT_OPEN_UC ,
      131     6421                          DCB = M$UC ,
      132     6422                          STCLASS = CONSTANT ) ;
      133     6531              %FPT_PROMPT(  FPTN = FPT_PROMPT_RESET, STCLASS = CONSTANT ) ;
      134     6559              %FPT_PROMPT(  FPTN = FPT_PROMPT_SUSYNDMES ,
      135     6560                            PROMPT = SUSYNDMES ,
      136     6561                            DCB = M$UC ,
      137     6562                            TRANS = NO ,
      138     6563                            VFC = YES ,
      139     6564                            STCLASS = CONSTANT ) ;
      140     6592              %FPT_WRITE( FPTN = FPT_WRITE_SUSMES ,
      141     6593                          BUF = SUSMES ,
      142     6594                          DCB = M$UC ,
      143     6595                          VFC = YES ,
      144     6596                          STCLASS = CONSTANT ) ;
      145     6627              %FPT_OCMSG (  FPTN = FPT_OCMSG ,
      146     6628                            MSG = USERS_NO_VAL ,
      147     6629                            OCTYPE = ADCOM ,
      148     6630                            STCLASS = CONSTANT ) ;
      149     6646         %FPT_TRAP ( ARITHMETIC=ALA$TRAP,ERRORS=ALA$TRAP,PROGRAMMED=ALA$TRAP,
      150     6647                    PMME=ALA$TRAP,DIVIDE_CHECK=TRAP,OVERFLOW=TRAP,COMMAND=TRAP,
      151     6648                    IPR=TRAP,LOCKUP=TRAP,MEMORY=TRAP,MISSING_PAGE=TRAP,
      152     6649                    MISSING_SEG=TRAP,SECURITY_1=TRAP,SECURITY_2=TRAP,
      153     6650                    DERAIL=TRAP,FAULT_TAG=TRAP,MME=TRAP,STCLASS=CONSTANT);
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:48   
      154     6673        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:49   
      155     6674        /*********************************************************************/
      156     6675        /*   ENTRIES         ENTRIES         ENTRIES         ENTRIES         */
      157     6676        /*********************************************************************/
      158     6677                                                              /**/
      159     6678    1   DCL ALA$OPEN_USERS ENTRY ALTRET ;
      160     6679    1   DCL ALA$BANNER2_STAR_S ENTRY (3) ALTRET ;
      161     6680    1   DCL ALA$CLOSE_USERS ENTRY ALTRET ;
      162     6681    1   DCL ALA$READ_USERS ENTRY(2) ALTRET ;
      163     6682    1   DCL ALA$GETUSERS ENTRY ALTRET ;
      164     6683    1   DCL ALA$LOG_ON ENTRY ;
      165     6684    1   DCL ALA$CPEXIT ENTRY(1) ;
      166     6685    1   DCL ALA$ERROR ENTRY(4) ;
      167     6686    1   DCL ALA$READ_SEQ_USERS ENTRY(2) ALTRET ;
      168     6687    1   DCL ALA$HEADING ENTRY(1) ;
      169     6688    1   DCL ALA$TIME ENTRY(1) ;
      170     6689    1   DCL ALA$OPEN_STAR_A ENTRY(1) ALTRET ;
      171     6690    1   DCL ALA$OPEN_STAR_S ENTRY(1) ALTRET ;
      172     6691    1   DCL ALA$CLOSE_STAR ENTRY ALTRET ;
      173     6692    1   DCL ALA$GETSTARS ENTRY ALTRET ;
      174     6693    1   DCL ALA$WRITE_STAR ENTRY(5) ALTRET ;
      175     6694    1   DCL ALA$WRITE_USERS ENTRY(2) ALTRET ;
      176     6695    1   DCL ALA$YESNOD ENTRY(2) ALTRET ;
      177     6696    1   DCL ALA$TRAP ENTRY ASYNC;
      178     6697    1   DCL ALA$SYS_ERROR ENTRY;
      179     6698        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:50   
      180     6699        /*********************************************************************/
      181     6700        /*   SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    SYS DEFAULTS    */
      182     6701        /*********************************************************************/
      183     6702                                                              /**/
      184     6703    1   DCL SYS_UMAX SBIN WORD CONSTANT INIT(50000) ;

   6703  2 000002                       BEGIN        null
      185     6704        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:51   
      186     6705        /*********************************************************************/
      187     6706        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      188     6707        /*********************************************************************/
      189     6708                                                              /**/
      190     6709    1   BEGIN: ;
      191     6710                                                     /**/
      192     6711    1         LIMIT_KEY.CNT = 5;

   6711  2 000002   005000 236003                    LDQ     2560,DU
         2 000003   201045 552140                    STBQ    LIMIT_KEY,'40'O,AUTO

      193     6712    1         LIMIT_KEY.TEXT = 'LIMIT';

   6712  2 000004   040100 100400                    MLR     fill='040'O
         2 000005   001301 000005 1                  ADSC9   LFC_VLP+5                cn=0,n=5
         2 000006   201045 200024                    ADSC9   LIMIT_KEY,,AUTO          cn=1,n=20

      194     6713    1         DCB$ = DCBADDR(DCBNUM(M$UC));

   6713  2 000007   000000 236007 xsym               LDQ     M$UC,DL
         2 000010   000000 470400 3                  LDP0    0
         2 000011   000000 471500                    LDP1    0,,PR0
         2 000012   100000 236106                    LDQ     0,QL,PR1
         2 000013   201053 756100                    STQ     DCB$,,AUTO

      195     6714    1         MODE = B$JIT.MODE;

   6714  2 000014   000000 473400 xsym               LDP3    B$JIT$
         2 000015   300000 236100                    LDQ     0,,PR3
         2 000016   000040 772000                    QRL     32
         2 000017   201074 756100                    STQ     MODE,,AUTO

      196     6715    1         AL_ACCT = B$JIT.ACCN;

   6715  2 000020   040100 100500                    MLR     fill='040'O
         2 000021   300001 000010                    ADSC9   1,,PR3                   cn=0,n=8
         2 000022   201113 000010                    ADSC9   AL_ACCT,,AUTO            cn=0,n=8
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:52   

      197     6716    2         CALL M$TRAP( FPT_TRAP ) WHENALTRETURN DO;

   6716  2 000023   001236 630400 1                  EPPR0   FPT_TRAP
         2 000024   410004 713400                    CLIMB   alt,+4100
         2 000025   400400 401760                    pmme    nvectors=2
         2 000026   000030 702000 2                  TSX2    s:6718
         2 000027   000030 710000 2                  TRA     s:6718

      198     6717    2             END;

      199     6718    1         AL$TSTAMP.UTS = B$JIT.LOGONTIME;

   6718  2 000030   000000 470400 xsym               LDP0    B$JIT$
         2 000031   000150 235100                    LDA     104,,PR0
         2 000032   201116 755100                    STA     AL$TSTAMP,,AUTO

      200     6719    1         CALL ALA$TIME( AL$TSTAMP );

   6719  2 000033   201116 631500                    EPPR1   AL$TSTAMP,,AUTO
         2 000034   202262 451500                    STP1    FIELD2+12,,AUTO
         2 000035   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 000036   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000037   000000 701000 xent               TSX1    ALA$TIME
         2 000040   000000 011000                    NOP     0

      201     6720                                                     /**/
      202     6721                                                     /* ASSOCIATE SUSPENDED PROGRAM   */
      203     6722                                                     /* IF DESIRED                    */
      204     6723    1         IF MODE=%M_INT# AND DCB$->F$DCB.ASN#=%DEVICE#

   6723  2 000041   201074 235100                    LDA     MODE,,AUTO
         2 000042   000003 115007                    CMPA    3,DL
         2 000043   000164 601000 2                  TNZ     NOT_SUSPENDED
         2 000044   201053 470500                    LDP0    DCB$,,AUTO
         2 000045   000032 236100                    LDQ     26,,PR0
         2 000046   777000 376007                    ANQ     -512,DL
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:53   
         2 000047   003000 116007                    CMPQ    1536,DL
         2 000050   000164 601000 2                  TNZ     NOT_SUSPENDED

      205     6724    2         THEN DO;          /* ONLINE OR CONSOLE GHOST */

      206     6725    2             CALL M$FSUSER ALTRET(NOT_SUSPENDED);

   6725  2 000051   400014 713400                    CLIMB   alt,+12
         2 000052   000000 401760                    pmme    nvectors=0
         2 000053   000164 702000 2                  TSX2    NOT_SUSPENDED

      207     6726    2             CALL M$OPEN( FPT_OPEN_UC ) ALTRET( READ_ERR_MESS ) ;

   6726  2 000054   001072 630400 1                  EPPR0   FPT_OPEN_UC
         2 000055   450000 713400                    CLIMB   alt,open
         2 000056   410400 401760                    pmme    nvectors=18
         2 000057   001141 702000 2                  TSX2    READ_USERS_ERR

      208     6727    2             CALL M$WRITE( FPT_WRITE_SUSMES ) ;

   6727  2 000060   001210 630400 1                  EPPR0   FPT_WRITE_SUSMES
         2 000061   040001 713400                    CLIMB   write
         2 000062   401400 401760                    pmme    nvectors=4

      209     6728    2             CALL M$PROMPT( FPT_PROMPT_SUSYNDMES ) ;

   6728  2 000063   001176 630400 1                  EPPR0   FPT_PROMPT_SUSYNDMES
         2 000064   160002 713400                    CLIMB   57346
         2 000065   401000 401760                    pmme    nvectors=3

      210     6729    2             FPT$READ_SUSMES = FPT_READ_SUSMES;

   6729  2 000066   000100 100400                    MLR     fill='000'O
         2 000067   001054 000070 1                  ADSC9   FPT_READ_SUSMES          cn=0,n=56
         2 000070   201206 000070                    ADSC9   FPT$READ_SUSMES,,AUTO    cn=0,n=56

      211     6730    2             FPT$READ_SUSMES.V_ = VECTOR(FPT$READ_SUSMES.V);
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:54   

   6730  2 000071   000001 235000 3                  LDA     1
         2 000072   202262 452500                    STP2    FIELD2+12,,AUTO
         2 000073   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000074   001216 036003                    ADLQ    654,DU
         2 000075   201206 757100                    STAQ    FPT$READ_SUSMES,,AUTO

      212     6731    2             FPT$READ_SUSMES.BUF_ = VECTOR(SUSMES_ANS);

   6731  2 000076   000002 235000 3                  LDA     2
         2 000077   202262 452500                    STP2    FIELD2+12,,AUTO
         2 000100   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000101   001033 036003                    ADLQ    539,DU
         2 000102   201212 757100                    STAQ    FPT$READ_SUSMES+4,,AUTO

   6731  2 000103                       YESNOD_ALT   null
      213     6732    2   YESNOD_ALT: ;
      214     6733    2             SUSMES_ANS = AL_BLANK ;

   6733  2 000103   040100 100400                    MLR     fill='040'O
         2 000104   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000105   201033 000012                    ADSC9   SUSMES_ANS,,AUTO         cn=0,n=10

      215     6734    2             CALL M$READ(FPT$READ_SUSMES) ALTRET(YESNOD_ALT);

   6734  2 000106   201206 630500                    EPPR0   FPT$READ_SUSMES,,AUTO
         2 000107   440000 713400                    CLIMB   alt,read
         2 000110   401400 401760                    pmme    nvectors=4
         2 000111   000103 702000 2                  TSX2    YESNOD_ALT

      216     6735    2             ARS = DCB$ -> F$DCB.ARS# ;

   6735  2 000112   201053 470500                    LDP0    DCB$,,AUTO
         2 000113   000000 235100                    LDA     0,,PR0
         2 000114   201036 755100                    STA     ARS,,AUTO

      217     6736    2             CALL ALA$YESNOD( SUSMES_ANS, ARS ) ALTRET( YESNOD_ALT );
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:55   

   6736  2 000115   201036 631500                    EPPR1   ARS,,AUTO
         2 000116   202263 451500                    STP1    FIELD2+13,,AUTO
         2 000117   201033 633500                    EPPR3   SUSMES_ANS,,AUTO
         2 000120   202262 453500                    STP3    FIELD2+12,,AUTO
         2 000121   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 000122   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000123   000000 701000 xent               TSX1    ALA$YESNOD
         2 000124   000103 702000 2                  TSX2    YESNOD_ALT

      218     6737    2             CALL M$PROMPT( FPT_PROMPT_RESET );      /* Reset to the default prompt */

   6737  2 000125   001164 630400 1                  EPPR0   FPT_PROMPT_RESET
         2 000126   160002 713400                    CLIMB   57346
         2 000127   401000 401760                    pmme    nvectors=3

      219     6738    2             IF SUSMES_ANS = 'Y'

   6738  2 000130   040000 106500                    CMPC    fill='040'O
         2 000131   201033 000012                    ADSC9   SUSMES_ANS,,AUTO         cn=0,n=10
         2 000132   000003 000001 3                  ADSC9   3                        cn=0,n=1
         2 000133   000143 601000 2                  TNZ     s:6745

      220     6739    2             THEN                            /* RECONNECT */
      221     6740    3             DO ;

      222     6741    3                 CALL M$ASUSER ALTRET( ASUSER_ALT ) ;

   6741  2 000134   400015 713400                    CLIMB   alt,+13
         2 000135   000000 401760                    pmme    nvectors=0
         2 000136   000153 702000 2                  TSX2    ASUSER_ALT

      223     6742    3                 CALL ALA$CPEXIT ;            /* LOG OFF THIS USER */

   6742  2 000137   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000140   000000 701000 xent               TSX1    ALA$CPEXIT
         2 000141   000000 011000                    NOP     0
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:56   

      224     6743    3                 END ; /* THEN DO */

   6743  2 000142   000152 710000 2                  TRA     s:6748

      225     6744    2             ELSE
      226     6745    2                 IF SUSMES_ANS = 'D'

   6745  2 000143   040000 106500                    CMPC    fill='040'O
         2 000144   201033 000012                    ADSC9   SUSMES_ANS,,AUTO         cn=0,n=10
         2 000145   000004 000001 3                  ADSC9   4                        cn=0,n=1
         2 000146   000152 601000 2                  TNZ     s:6748

      227     6746    2                 THEN                    /* DELETE */
      228     6747    2                     CALL M$DSUSER ALTRET( DSUSER_ALT ) ;

   6747  2 000147   400016 713400                    CLIMB   alt,+14
         2 000150   000000 401760                    pmme    nvectors=0
         2 000151   000160 702000 2                  TSX2    DSUSER_ALT

      229     6748    3             DO WHILE( '0'B ) ;

   6748  2 000152   000157 710000 2                  TRA     s:6755

   6740  2 000153                       ASUSER_ALT   null
      230     6749    3   ASUSER_ALT:   ;
      231     6750        /*E*  ERROR:    ALA-E$ASUSER_ERR-C
      232     6751              MESSAGE0: Image lost, no reconnect.
      233     6752        */
      234     6753    3                 CALL ALA$ERROR( ALA_E$ASUSER_ERR );

   6753  2 000153   000005 630400 3                  EPPR0   5
         2 000154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000155   000000 701000 xent               TSX1    ALA$ERROR
         2 000156   000000 011000                    NOP     0

      235     6754    3                 END ; /* DO WHILE */
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:57   

      236     6755    3             DO WHILE( '0'B ) ;

   6755  2 000157   000164 710000 2                  TRA     NOT_SUSPENDED

      237     6756    3   DSUSER_ALT:   ;

   6756  2 000160                       DSUSER_ALT   null
      238     6757        /*E*  ERROR:    ALA-E$DSUSER_ERR-C
      239     6758              MESSAGE0: Image already deleted.
      240     6759        */
      241     6760    3                 CALL ALA$ERROR( ALA_E$DSUSER_ERR );

   6760  2 000160   000006 630400 3                  EPPR0   6
         2 000161   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000162   000000 701000 xent               TSX1    ALA$ERROR
         2 000163   000000 011000                    NOP     0

      242     6761    3                 END ; /* DO WHILE */

      243     6762    2   NOT_SUSPENDED:
      244     6763    2             END;

   6763  2 000164                       NOT_SUSPEND* null
      245     6764                                                              /**/
      246     6765    1         B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_FIRSTCP# ;

   6765  2 000164   000000 470400 xsym               LDP0    B$JIT$
         2 000165   000143 236100                    LDQ     99,,PR0
         2 000166   000020 276000 xsym               ORQ     B_VECTNIL+16
         2 000167   000143 756100                    STQ     99,,PR0

      247     6766    1         FPT$CPEXIT = FPT_CPLOGOFF ;

   6766  2 000170   000100 100400                    MLR     fill='000'O
         2 000171   001036 000070 1                  ADSC9   FPT_CPLOGOFF             cn=0,n=56
         2 000172   201170 000070                    ADSC9   FPT$CPEXIT,,AUTO         cn=0,n=56
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:58   

      248     6767    1         FPT$CPEXIT.NAME_ = VECTOR(CP_NAME) ;

   6767  2 000173   000007 235000 3                  LDA     7
         2 000174   202262 452500                    STP2    FIELD2+12,,AUTO
         2 000175   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000176   001076 036003                    ADLQ    574,DU
         2 000177   201170 757100                    STAQ    FPT$CPEXIT,,AUTO

      249     6768    1         FPT$CPEXIT.ACCT_ = VECTOR(CP_ACCT) ;

   6768  2 000200   000010 235000 3                  LDA     8
         2 000201   202262 452500                    STP2    FIELD2+12,,AUTO
         2 000202   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000203   001106 036003                    ADLQ    582,DU
         2 000204   201172 757100                    STAQ    FPT$CPEXIT+2,,AUTO

      250     6769    1         FPT$CPEXIT.PASS_ = VECTOR(CP_PASSW) ;

   6769  2 000205   000010 235000 3                  LDA     8
         2 000206   202262 452500                    STP2    FIELD2+12,,AUTO
         2 000207   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000210   001110 036003                    ADLQ    584,DU
         2 000211   201174 757100                    STAQ    FPT$CPEXIT+4,,AUTO

      251     6770    1         FPT$CPEXIT.V_ = VECTOR(FPT$CPEXIT.V) ;

   6770  2 000212   000010 235000 3                  LDA     8
         2 000213   202262 452500                    STP2    FIELD2+12,,AUTO
         2 000214   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000215   001204 036003                    ADLQ    644,DU
         2 000216   201202 757100                    STAQ    FPT$CPEXIT+10,,AUTO

      252     6771    1         IF B$JIT$ -> B$JIT.USRERR.CODE ~= 0

   6771  2 000217   000144 236100                    LDQ     100,,PR0
         2 000220   377770 316007                    CANQ    131064,DL
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:59   
         2 000221   000224 600000 2                  TZE     s:6776

      253     6772    1         THEN
      254     6773    1             CALL CP_NO_EXISTS ;

   6773  2 000222   001562 701000 2                  TSX1    CP_NO_EXISTS
         2 000223   000000 011000                    NOP     0

      255     6774              /*                               */
      256     6775                                                              /* IS THIS A SYSTEM GHOST? */
      257     6776    1         IF B$JIT.USER <= 15/*JG_MING#    */

   6776  2 000224   000000 470400 xsym               LDP0    B$JIT$
         2 000225   000000 236100                    LDQ     0,,PR0
         2 000226   000777 376003                    ANQ     511,DU
         2 000227   000020 116003                    CMPQ    16,DU
         2 000230   000235 603000 2                  TRC     s:6780

      258     6777    1         THEN
      259     6778    1             SYS_GHOST = AL_TRUE ;

   6778  2 000231   000000 236000 xsym               LDQ     AL_TRUE
         2 000232   400000 376003                    ANQ     -131072,DU
         2 000233   201115 756100                    STQ     SYS_GHOST,,AUTO
         2 000234   000240 710000 2                  TRA     s:6782

      260     6779    1         ELSE
      261     6780    1             SYS_GHOST = AL_FALSE ;

   6780  2 000235   000000 236000 xsym               LDQ     AL_FALSE
         2 000236   400000 376003                    ANQ     -131072,DU
         2 000237   201115 756100                    STQ     SYS_GHOST,,AUTO

      262     6781              /*                               */
      263     6782    1         NOSETUP = B$JIT.BLINDACCTNG; /* SAVE THE FLAG */

   6782  2 000240   000153 236100                    LDQ     107,,PR0
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:60   
         2 000241   000022 736000                    QLS     18
         2 000242   400000 376003                    ANQ     -131072,DU
         2 000243   201063 756100                    STQ     NOSETUP,,AUTO

      264     6783    1         NOHEADER = B$JIT.LOCK (0); /* SAVE THE FLAG */

   6783  2 000244   000154 236100                    LDQ     108,,PR0
         2 000245   400000 376003                    ANQ     -131072,DU
         2 000246   201064 756100                    STQ     NOHEADER,,AUTO

      265     6784    1         CP_SLEAZE_SET = AL_FALSE;

   6784  2 000247   000000 236000 xsym               LDQ     AL_FALSE
         2 000250   400000 376003                    ANQ     -131072,DU
         2 000251   201075 756100                    STQ     CP_SLEAZE_SET,,AUTO

      266     6785    1         IF (B$JIT.CPFLAGS1 & %CP_SLEAZE#) = %CP_SLEAZE#

   6785  2 000252   000143 236100                    LDQ     99,,PR0
         2 000253   000003 376000 xsym               ANQ     B_VECTNIL+3
         2 000254   000003 116000 xsym               CMPQ    B_VECTNIL+3
         2 000255   000316 601000 2                  TNZ     s:6799

      267     6786    2         THEN DO ;

      268     6787    2             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 & ~%CP_SLEAZE#;

   6787  2 000256   000003 236000 xsym               LDQ     B_VECTNIL+3
         2 000257   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 000260   000143 376100                    ANQ     99,,PR0
         2 000261   000143 756100                    STQ     99,,PR0

      269     6788    2             CP_SLEAZE_SET = AL_TRUE;

   6788  2 000262   000000 236000 xsym               LDQ     AL_TRUE
         2 000263   400000 376003                    ANQ     -131072,DU
         2 000264   201075 756100                    STQ     CP_SLEAZE_SET,,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:61   

      270     6789    2             AS_USERS = DF_USERS ;

   6789  2 000265   000100 100400                    MLR     fill='000'O
         2 000266   000001 004020 1                  ADSC9   DF_USERS                 cn=0,n=2064
         2 000267   200003 004020                    ADSC9   AS_USERS,,AUTO           cn=0,n=2064

      271     6790    2             CP_NAME = DF_CP_NAME ;

   6790  2 000270   000100 100400                    MLR     fill='000'O
         2 000271   000000 000040 xsym               ADSC9   DF_CP_NAME               cn=0,n=32
         2 000272   201076 000040                    ADSC9   CP_NAME,,AUTO            cn=0,n=32

      272     6791    2             CP_ACCT = DF_CP_ACCT ;

   6791  2 000273   040100 100400                    MLR     fill='040'O
         2 000274   000000 000010 xsym               ADSC9   DF_CP_ACCT               cn=0,n=8
         2 000275   201106 000010                    ADSC9   CP_ACCT,,AUTO            cn=0,n=8

      273     6792    2             CP_PASSW = DF_CP_PASS ;

   6792  2 000276   040100 100400                    MLR     fill='040'O
         2 000277   000000 000010 xsym               ADSC9   DF_CP_PASS               cn=0,n=8
         2 000300   201110 000010                    ADSC9   CP_PASSW,,AUTO           cn=0,n=8

      274     6793    2             B$JIT.SSLEV = %AZ_NONE# ;

   6793  2 000301   000151 236100                    LDQ     105,,PR0
         2 000302   000011 376000 3                  ANQ     9
         2 000303   003000 276003                    ORQ     1536,DU
         2 000304   000151 756100                    STQ     105,,PR0

      275     6794    2             B$JIT.PSLEV = %AZ_NONE# ;

   6794  2 000305   000151 236100                    LDQ     105,,PR0
         2 000306   000012 376000 3                  ANQ     10
         2 000307   030000 276003                    ORQ     12288,DU
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:62   
         2 000310   000151 756100                    STQ     105,,PR0

      276     6795    2             B$JIT.JSLEV = %AZ_NONE# ;

   6795  2 000311   000151 236100                    LDQ     105,,PR0
         2 000312   000013 376000 3                  ANQ     11
         2 000313   300000 276003                    ORQ     98304,DU
         2 000314   000151 756100                    STQ     105,,PR0

      277     6796    2             GOTO DO_STARS ;

   6796  2 000315   000717 710000 2                  TRA     DO_STARS

      278     6797    2             END ;   /*   THEN DO   */
      279     6798                                                              /*   SET UP USERS_KEY  */
      280     6799    1         CALL CONCAT( USERS_KEY.TEXT, B$JIT.ACCN, B$JIT.UNAME );

   6799  2 000316   040100 100500                    MLR     fill='040'O
         2 000317   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8
         2 000320   201037 200010                    ADSC9   USERS_KEY,,AUTO          cn=1,n=8
         2 000321   040100 100500                    MLR     fill='040'O
         2 000322   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 000323   201041 200014                    ADSC9   USERS_KEY+2,,AUTO        cn=1,n=12

      281     6800    2         IF USERS_KEY.TEXT = AL_BLANK THEN DO;

   6800  2 000324   040000 106500                    CMPC    fill='040'O
         2 000325   201037 200024                    ADSC9   USERS_KEY,,AUTO          cn=1,n=20
         2 000326   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000327   000337 601000 2                  TNZ     s:6807

      282     6801        /*E*  ERROR:  ALA-E$BLANK_ACCT_UNAME-A
      283     6802              MESSAGE: B$JIT.ACCT and B$JIT.UNAME are blank.
      284     6803        */
      285     6804    2             CALL ALA$ERROR( ALA_E$BLANK_ACCT_UNAME );

   6804  2 000330   000014 630400 3                  EPPR0   12
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:63   
         2 000331   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000332   000000 701000 xent               TSX1    ALA$ERROR
         2 000333   000000 011000                    NOP     0

      286     6805    2             CALL ALA$CPEXIT;

   6805  2 000334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000335   000000 701000 xent               TSX1    ALA$CPEXIT
         2 000336   000000 011000                    NOP     0

      287     6806    2             END;

      288     6807    1         CALL INDEX( I, AL_BLANK, B$JIT.UNAME );

   6807  2 000337   000000 470400 xsym               LDP0    B$JIT$
         2 000340   000000 124500                    SCM     mask='000'O
         2 000341   000003 000014                    ADSC9   3,,PR0                   cn=0,n=12
         2 000342   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000343   201056 000100                    ARG     I,,AUTO

      289     6808    1         USERS_KEY.CNT = 8 + I;

   6808  2 000344   201056 236100                    LDQ     I,,AUTO
         2 000345   000010 036007                    ADLQ    8,DL
         2 000346   000033 736000                    QLS     27
         2 000347   201037 552140                    STBQ    USERS_KEY,'40'O,AUTO

      290     6809                                                      /* READ IN A :USERS RECORD. */
      291     6810    1         CALL ALA$GETUSERS ;                     /* SET UP M$USERS DCB FOR READ. */

   6810  2 000350   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000351   000000 701000 xent               TSX1    ALA$GETUSERS
         2 000352   000000 011000                    NOP     0

      292     6811    1         CALL ALA$OPEN_USERS ALTRET(OPEN_USERS_ERR) ;

   6811  2 000353   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:64   
         2 000354   000000 701000 xent               TSX1    ALA$OPEN_USERS
         2 000355   001164 702000 2                  TSX2    OPEN_USERS_ERR

      293     6812    1         CALL ALA$READ_USERS (USERS_KEY, AS_USERS) ALTRET(READ_USERS_ERR) ;

   6812  2 000356   200003 630500                    EPPR0   AS_USERS,,AUTO
         2 000357   202263 450500                    STP0    FIELD2+13,,AUTO
         2 000360   201037 631500                    EPPR1   USERS_KEY,,AUTO
         2 000361   202262 451500                    STP1    FIELD2+12,,AUTO
         2 000362   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 000363   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000364   000000 701000 xent               TSX1    ALA$READ_USERS
         2 000365   001141 702000 2                  TSX2    READ_USERS_ERR

   6808  2 000366                       USER_OK      null
      294     6813                                                              /*   RECORD EXISTS.  */
      295     6814                        /*                                    */
      296     6815                        /*      CHECK BUDGET.                 */
      297     6816                        /*                                    */
      298     6817    1   USER_OK: ;
      299     6818                                                              /**/
      300     6819                                                              /*   SET ECHO IN JIT.   */
      301     6820    1         B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_ECHO# | %CP_CFREAD#;

   6820  2 000366   000000 470400 xsym               LDP0    B$JIT$
         2 000367   000143 236100                    LDQ     99,,PR0
         2 000370   000012 276000 xsym               ORQ     B_VECTNIL+10
         2 000371   001303 276000 1                  ORQ     LFC_VLP+7
         2 000372   000143 756100                    STQ     99,,PR0

      302     6821    1         B$JIT.PRIV.AUTH = AS_USERS.PRIV(MODE-1) ;

   6821  2 000373   201074 720100                    LXL0    MODE,,AUTO
         2 000374   200227 236110                    LDQ     AS_USERS+148,X0,AUTO
         2 000375   000014 756100                    STQ     12,,PR0

      303     6822                                                              /*  SHUT OFF EFT AND BLK */
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:65   
      304     6823    1         B$JIT.PRIV.AUTH = B$JIT.PRIV.AUTH & ~%PR_FMEFT# & ~%PR_FMBLK#;

   6823  2 000376   000030 236000 xsym               LDQ     B_VECTNIL+24
         2 000377   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 000400   000014 376100                    ANQ     12,,PR0
         2 000401   202262 756100                    STQ     FIELD2+12,,AUTO
         2 000402   001304 236000 1                  LDQ     LFC_VLP+8
         2 000403   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 000404   202262 376100                    ANQ     FIELD2+12,,AUTO
         2 000405   000014 756100                    STQ     12,,PR0

      305     6824                                                         /* SET ACTIVE, JOB, PRC TO '0'B */
      306     6825    1         B$JIT.PRIV.ACTIVE = '0'B ;

   6825  2 000406   000013 450100                    STZ     11,,PR0

      307     6826    1         B$JIT.PRIV.JOB = '0'B ;

   6826  2 000407   000015 450100                    STZ     13,,PR0

      308     6827    1         B$JIT.PRIV.PRC = '0'B ;

   6827  2 000410   000016 450100                    STZ     14,,PR0

      309     6828                                                              /* Set PROC. PRIV. */
      310     6829    1         B$JIT.PPRIV = AS_USERS.PPRIV(MODE-1) ;

   6829  2 000411   200233 236110                    LDQ     AS_USERS+152,X0,AUTO
         2 000412   000020 756100                    STQ     16,,PR0

      311     6830    1         B$JIT.PRIOB = AS_USERS.PRIOB(MODE-1) ;

   6830  2 000413   201074 235100                    LDA     MODE,,AUTO
         2 000414   000100 100505                    MLR     fill='000'O
         2 000415   200243 600001                    ADSC9   AS_USERS+160,A,AUTO      cn=3,n=1
         2 000416   000260 400001                    ADSC9   176,,PR0                 cn=2,n=1

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:66   
      312     6831    1         B$JIT.QUAN = AS_USERS.QUAN(MODE-1) * 1000;

   6831  2 000417   000001 735000                    ALS     1
         2 000420   000100 100505                    MLR     fill='000'O
         2 000421   200237 400002                    ADSC9   AS_USERS+156,A,AUTO      cn=2,n=2
         2 000422   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 000423   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000424   000022 732000                    QRS     18
         2 000425   001750 402007                    MPY     1000,DL
         2 000426   000000 621006                    EAX1    0,QL
         2 000427   000260 741100                    STX1    176,,PR0

      313     6832    1         IF AS_USERS.MAXENQ(MODE-1)>0 THEN B$JIT.MAXENQ = AS_USERS.MAXENQ(MODE-1);

   6832  2 000430   201074 235100                    LDA     MODE,,AUTO
         2 000431   000001 735000                    ALS     1
         2 000432   000100 101505                    MRL     fill='000'O
         2 000433   200777 400002                    ADSC9   AS_USERS+508,A,AUTO      cn=2,n=2
         2 000434   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 000435   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000436   000000 116003                    CMPQ    0,DU
         2 000437   000443 600000 2                  TZE     s:6834

   6832  2 000440   000100 100505                    MLR     fill='000'O
         2 000441   200777 400002                    ADSC9   AS_USERS+508,A,AUTO      cn=2,n=2
         2 000442   000363 000002                    ADSC9   243,,PR0                 cn=0,n=2

      314     6833                                                        /* Set misc. stuff. */
      315     6834    1         B$JIT.CSLEV = 0; /* Level count for nested XEQs. */

   6834  2 000443   000000 236003                    LDQ     0,DU
         2 000444   000170 552120                    STBQ    120,'20'O,PR0

      316     6835                                                             /**/
      317     6836    1         CALL BUDGET ALTRET(BUDGET_ERR) ;

   6836  2 000445   001233 701000 2                  TSX1    BUDGET
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:67   
         2 000446   001172 702000 2                  TSX2    BUDGET_ERR

   6834  2 000447                       BUDGET_OK    null
      318     6837                                                              /*   BUDGET OK.   */
      319     6838    1   BUDGET_OK: ;
      320     6839                                                      /* Set BLIND ACCOUNTING */
      321     6840    1         B$JIT.BLINDACCTNG = AS_USERS.BUDGET.BLINDACCTNG;

   6840  2 000447   000000 470400 xsym               LDP0    B$JIT$
         2 000450   200022 236100                    LDQ     AS_USERS+15,,AUTO
         2 000451   000005 772000                    QRL     5
         2 000452   000153 676100                    ERQ     107,,PR0
         2 000453   400000 376007                    ANQ     -131072,DL
         2 000454   000153 656100                    ERSQ    107,,PR0

      322     6841                                                              /*  MOVE HOME PACK SET.  */
      323     6842    1         B$JIT.HPSN = AS_USERS.HPSN ;

   6842  2 000455   040100 100500                    MLR     fill='040'O
         2 000456   200126 000006                    ADSC9   AS_USERS+83,,AUTO        cn=0,n=6
         2 000457   000234 000006                    ADSC9   156,,PR0                 cn=0,n=6

      324     6843    1         IF (B$JIT.CPFLAGS1 & %CP_BUFFULL#) = '0'B THEN CALL FREECMD ;

   6843  2 000460   000143 236100                    LDQ     99,,PR0
         2 000461   001305 376000 1                  ANQ     LFC_VLP+9
         2 000462   000465 601000 2                  TNZ     s:6844

   6843  2 000463   001462 701000 2                  TSX1    FREECMD
         2 000464   000000 011000                    NOP     0

      325     6844    1         CALL CPROC ;

   6844  2 000465   001424 701000 2                  TSX1    CPROC
         2 000466   000000 011000                    NOP     0

      326     6845                                                              /* CHECK FOR LAST CPROC */
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:68   
      327     6846    1         IF AS_USERS.LASTCPROC.NAME.CNT(MODE-1) > 0 THEN

   6846  2 000467   201074 235100                    LDA     MODE,,AUTO
         2 000470   000003 735000                    ALS     3
         2 000471   200160 236105                    LDQ     AS_USERS+109,AL,AUTO
         2 000472   777000 316003                    CANQ    -512,DU
         2 000473   000500 600000 2                  TZE     s:6849

      328     6847    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_LASTCPEXISTS#;

   6847  2 000474   000000 470400 xsym               LDP0    B$JIT$
         2 000475   000143 236100                    LDQ     99,,PR0
         2 000476   000026 276000 xsym               ORQ     B_VECTNIL+22
         2 000477   000143 756100                    STQ     99,,PR0

      329     6848                                                     /* Set limits in the JIT         */
      330     6849    1         B$JIT.REMLO = AS_USERS.DLO(MODE-1);

   6849  2 000500   201074 720100                    LXL0    MODE,,AUTO
         2 000501   200044 235110                    LDA     AS_USERS+33,X0,AUTO
         2 000502   000000 470400 xsym               LDP0    B$JIT$
         2 000503   000361 755100                    STA     241,,PR0

      331     6850    1         IF (AS_USERS.MLO(MODE-1) = 0) /*IF LO=0 ->DONT ALLOW LO OUTPUT*/

   6850  2 000504   200040 235110                    LDA     AS_USERS+29,X0,AUTO
         2 000505   000511 601000 2                  TNZ     s:6852

      332     6851    1         THEN B$JIT.NOLOEVER = '1'B;

   6851  2 000506   000100 236003                    LDQ     64,DU
         2 000507   000325 256100                    ORSQ    213,,PR0
         2 000510   000513 710000 2                  TRA     s:6853

      333     6852    1         ELSE B$JIT.NOLOEVER = '0'B;

   6852  2 000511   000015 236000 3                  LDQ     13
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:69   
         2 000512   000325 356100                    ANSQ    213,,PR0

      334     6853    1         B$JIT.REMDO = AS_USERS.DDO(MODE-1);

   6853  2 000513   200054 235110                    LDA     AS_USERS+41,X0,AUTO
         2 000514   000362 755100                    STA     242,,PR0

      335     6854    1         IF (AS_USERS.MDO(MODE-1) = 0) /*IF DO=0 ->DONT ALLOW DO OUTPUT*/

   6854  2 000515   200050 235110                    LDA     AS_USERS+37,X0,AUTO
         2 000516   000522 601000 2                  TNZ     s:6856

      336     6855    1         THEN B$JIT.NODOEVER = '1'B;

   6855  2 000517   000040 236003                    LDQ     32,DU
         2 000520   000325 256100                    ORSQ    213,,PR0
         2 000521   000524 710000 2                  TRA     s:6857

      337     6856    1         ELSE B$JIT.NODOEVER = '0'B;

   6856  2 000522   000016 236000 3                  LDQ     14
         2 000523   000325 356100                    ANSQ    213,,PR0

      338     6857    1         B$JIT.REMCPO = AS_USERS.DPO(MODE-1);

   6857  2 000524   200064 235110                    LDA     AS_USERS+49,X0,AUTO
         2 000525   000360 755100                    STA     240,,PR0

      339     6858    1         IF (AS_USERS.MPO(MODE-1) = 0) /*IF PO=0 ->DONT ALLOW PO OUTPUT*/

   6858  2 000526   200060 235110                    LDA     AS_USERS+45,X0,AUTO
         2 000527   000533 601000 2                  TNZ     s:6860

      340     6859    1         THEN B$JIT.NOPOEVER = '1'B;

   6859  2 000530   000020 236003                    LDQ     16,DU
         2 000531   000325 256100                    ORSQ    213,,PR0
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:70   
         2 000532   000535 710000 2                  TRA     s:6861

      341     6860    1         ELSE B$JIT.NOPOEVER = '0'B;

   6860  2 000533   000017 236000 3                  LDQ     15
         2 000534   000325 356100                    ANSQ    213,,PR0

      342     6861    1         B$JIT.MAXTMPDP = AS_USERS.DTDIS(MODE-1);

   6861  2 000535   200104 235110                    LDA     AS_USERS+65,X0,AUTO
         2 000536   000241 755100                    STA     161,,PR0

      343     6862    1         B$JIT.FBUL = MAXIMUM( AS_USERS.DFPOOLS(MODE-1), 5 );

   6862  2 000537   201074 236100                    LDQ     MODE,,AUTO
         2 000540   000100 101506                    MRL     fill='000'O
         2 000541   200111 600001                    ADSC9   AS_USERS+70,Q,AUTO       cn=3,n=1
         2 000542   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 000543   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 000544   000005 116007                    CMPQ    5,DL
         2 000545   000547 603000 2                  TRC     s:6862+8
         2 000546   000005 236007                    LDQ     5,DL
         2 000547   000000 621006                    EAX1    0,QL
         2 000550   000205 441100                    SXL1    133,,PR0

      344     6863    1         B$JIT.DEFEXP = AS_USERS.DEXP;

   6863  2 000551   200246 722100                    LXL2    AS_USERS+163,,AUTO
         2 000552   000221 742100                    STX2    145,,PR0

      345     6864    1         B$JIT.MAXEXP = AS_USERS.MEXP;

   6864  2 000553   200245 723100                    LXL3    AS_USERS+162,,AUTO
         2 000554   000221 443100                    SXL3    145,,PR0

      346     6865    1         B$JIT.PRDPRM = AS_USERS.DPDIS(MODE-1);

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:71   
   6865  2 000555   200074 235110                    LDA     AS_USERS+57,X0,AUTO
         2 000556   000242 755100                    STA     162,,PR0

      347     6866    1         B$JIT.DEFPRI = AS_USERS.DMPRIO( MODE-1 ) ;

   6866  2 000557   201074 236100                    LDQ     MODE,,AUTO
         2 000560   000100 100506                    MLR     fill='000'O
         2 000561   200113 600001                    ADSC9   AS_USERS+72,Q,AUTO       cn=3,n=1
         2 000562   000153 000001                    ADSC9   107,,PR0                 cn=0,n=1

      348     6867    1         B$JIT.MAXPRI = AS_USERS.MMPRIO( MODE-1 ) ;

   6867  2 000563   000100 100506                    MLR     fill='000'O
         2 000564   200112 600001                    ADSC9   AS_USERS+71,Q,AUTO       cn=3,n=1
         2 000565   000153 200001                    ADSC9   107,,PR0                 cn=1,n=1

      349     6868    1         B$JIT.LOCK = AS_USERS.KEY;

   6868  2 000566   000100 100500                    MLR     fill='000'O
         2 000567   200031 000010                    ADSC9   AS_USERS+22,,AUTO        cn=0,n=8
         2 000570   000154 000010                    ADSC9   108,,PR0                 cn=0,n=8

      350     6869    1         IF AS_USERS.STEPACCNT

   6869  2 000571   200010 236100                    LDQ     AS_USERS+5,,AUTO
         2 000572   000400 316003                    CANQ    256,DU
         2 000573   000577 600000 2                  TZE     s:6873

      351     6870    1         THEN
      352     6871    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STEPACCT# ;

   6871  2 000574   000143 236100                    LDQ     99,,PR0
         2 000575   001306 276000 1                  ORQ     LFC_VLP+10
         2 000576   000143 756100                    STQ     99,,PR0

      353     6872                                                              /* SET *S ACCOUNTING */
      354     6873    1         IF AS_USERS.FLAGS.STARSACC THEN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:72   

   6873  2 000577   200247 236100                    LDQ     AS_USERS+164,,AUTO
         2 000600   010000 316003                    CANQ    4096,DU
         2 000601   000605 600000 2                  TZE     s:6875

      355     6874    1             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_STARSACC# ;

   6874  2 000602   000143 236100                    LDQ     99,,PR0
         2 000603   001307 276000 1                  ORQ     LFC_VLP+11
         2 000604   000143 756100                    STQ     99,,PR0

      356     6875    1         B$JIT.SSLEV = %AZ_NONE# ;

   6875  2 000605   000151 236100                    LDQ     105,,PR0
         2 000606   000011 376000 3                  ANQ     9
         2 000607   003000 276003                    ORQ     1536,DU
         2 000610   000151 756100                    STQ     105,,PR0

      357     6876    1         B$JIT.PSLEV = %AZ_NONE# ;

   6876  2 000611   000151 236100                    LDQ     105,,PR0
         2 000612   000012 376000 3                  ANQ     10
         2 000613   030000 276003                    ORQ     12288,DU
         2 000614   000151 756100                    STQ     105,,PR0

      358     6877    1         B$JIT.LANG = AS_USERS.NAT_LANG ;

   6877  2 000615   200010 236100                    LDQ     AS_USERS+5,,AUTO
         2 000616   000033 772000                    QRL     27
         2 000617   000145 552104                    STBQ    101,'04'O,PR0

      359     6878    1         B$JIT.OUTPRIO = AS_USERS.OUTPUTPRIO ;

   6878  2 000620   200040 236100                    LDQ     AS_USERS+29,,AUTO
         2 000621   000011 736000                    QLS     9
         2 000622   000022 552110                    STBQ    18,'10'O,PR0

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:73   
      360     6879    1         IF MODE=%M_BATCH#

   6879  2 000623   201074 236100                    LDQ     MODE,,AUTO
         2 000624   000001 116007                    CMPQ    1,DL
         2 000625   000635 601000 2                  TNZ     s:6885

      361     6880    2         THEN DO;

      362     6881    2             B$JIT.JSLEV = %AZ_ALL#;

   6881  2 000626   000151 236100                    LDQ     105,,PR0
         2 000627   000013 376000 3                  ANQ     11
         2 000630   100000 276003                    ORQ     32768,DU
         2 000631   000151 756100                    STQ     105,,PR0

      363     6882    2             B$JIT.OLTA = '00'B;

   6882  2 000632   000020 236000 3                  LDQ     16
         2 000633   000333 356100                    ANSQ    219,,PR0

      364     6883    2             END;

   6883  2 000634   000715 710000 2                  TRA     s:6906

      365     6884    2         ELSE DO;

      366     6885    3             DO CASE(MODE);

   6885  2 000635   000005 116007                    CMPQ    5,DL
         2 000636   000640 602006 2                  TNC     s:6885+3,QL
         2 000637   000663 710000 2                  TRA     s:6893
         2 000640   000663 710000 2                  TRA     s:6893
         2 000641   000663 710000 2                  TRA     s:6893
         2 000642   000652 710000 2                  TRA     s:6889
         2 000643   000645 710000 2                  TRA     s:6887
         2 000644   000657 710000 2                  TRA     s:6891

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:74   
      367     6886    3               CASE(%M_INT#);

      368     6887    3                 B$JIT.JSLEV = %AZ_SUMMARY#;

   6887  2 000645   000151 236100                    LDQ     105,,PR0
         2 000646   000013 376000 3                  ANQ     11
         2 000647   200000 276003                    ORQ     65536,DU
         2 000650   000151 756100                    STQ     105,,PR0
         2 000651   000663 710000 2                  TRA     s:6893

      369     6888    3               CASE(%M_GHOST#);

      370     6889    3                 B$JIT.JSLEV = %AZ_ALL# ;

   6889  2 000652   000151 236100                    LDQ     105,,PR0
         2 000653   000013 376000 3                  ANQ     11
         2 000654   100000 276003                    ORQ     32768,DU
         2 000655   000151 756100                    STQ     105,,PR0
         2 000656   000663 710000 2                  TRA     s:6893

      371     6890    3               CASE(%M_TP#);

      372     6891    3                 B$JIT.JSLEV = %AZ_NONE# ;

   6891  2 000657   000151 236100                    LDQ     105,,PR0
         2 000660   000013 376000 3                  ANQ     11
         2 000661   300000 276003                    ORQ     98304,DU
         2 000662   000151 756100                    STQ     105,,PR0

      373     6892    3               END;

      374     6893    2             B$JIT.MRT = AS_USERS.DTIME(MODE-1);

   6893  2 000663   200257 235110                    LDA     AS_USERS+172,X0,AUTO
         2 000664   000276 755100                    STA     190,,PR0

      375     6894    2             B$JIT.MAXCORE = AS_USERS.DMEM(MODE-1);
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:75   

   6894  2 000665   201074 236100                    LDQ     MODE,,AUTO
         2 000666   000001 736000                    QLS     1
         2 000667   000100 100506                    MLR     fill='000'O
         2 000670   200265 400002                    ADSC9   AS_USERS+178,Q,AUTO      cn=2,n=2
         2 000671   000210 000002                    ADSC9   136,,PR0                 cn=0,n=2

      376     6895    2             B$JIT.RESCORE = B$JIT.MAXCORE ;

   6895  2 000672   000210 236100                    LDQ     136,,PR0
         2 000673   000022 772000                    QRL     18
         2 000674   000336 756100                    STQ     222,,PR0

      377     6896    3             DO CASE(AS_USERS.RESL.OMAX(0));

   6896  2 000675   200332 224100                    LDX4    AS_USERS+215,,AUTO
         2 000676   000002 104003                    CMPX4   2,DU
         2 000677   000701 602014 2                  TNC     s:6896+4,X4
         2 000700   000713 710000 2                  TRA     s:6902
         2 000701   000703 710000 2                  TRA     s:6898
         2 000702   000706 710000 2                  TRA     s:6900

      378     6897    3               CASE(0);

      379     6898    3                 B$JIT.OLTA = '00'B;

   6898  2 000703   000020 236000 3                  LDQ     16
         2 000704   000333 356100                    ANSQ    219,,PR0
         2 000705   000715 710000 2                  TRA     s:6906

      380     6899    3               CASE(1);

      381     6900    3                 B$JIT.OLTA = '10'B;

   6900  2 000706   000333 236100                    LDQ     219,,PR0
         2 000707   000020 376000 3                  ANQ     16
         2 000710   400000 276007                    ORQ     -131072,DL
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:76   
         2 000711   000333 756100                    STQ     219,,PR0
         2 000712   000715 710000 2                  TRA     s:6906

      382     6901    3               CASE(ELSE);

      383     6902    3                 B$JIT.OLTA = '11'B;

   6902  2 000713   600000 236007                    LDQ     -65536,DL
         2 000714   000333 256100                    ORSQ    219,,PR0

      384     6903    3               END;

      385     6904    2             END;

      386     6905                                                             /**/
      387     6906    1         CALL CLRES;

   6906  2 000715   001720 701000 2                  TSX1    CLRES
         2 000716   000000 011000                    NOP     0

      388     6907                                                              /* SET UP LIMIT
      389     6908                                                                 RECORD FOR '*S' */
      390     6909    1   DO_STARS: ;

   6909  2 000717                       DO_STARS     null
      391     6910    1         CALL ALA$GETSTARS ;                             /*   SET UP M$STARS DCB.   */

   6910  2 000717   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000720   000000 701000 xent               TSX1    ALA$GETSTARS
         2 000721   000000 011000                    NOP     0

      392     6911    1         CALL ALA$OPEN_STAR_A ( AL_ACCT ) ALTRET ( OPEN_A_ERR ) ;

   6911  2 000722   201113 630500                    EPPR0   AL_ACCT,,AUTO
         2 000723   202262 450500                    STP0    FIELD2+12,,AUTO
         2 000724   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 000725   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:77   
         2 000726   000000 701000 xent               TSX1    ALA$OPEN_STAR_A
         2 000727   001206 702000 2                  TSX2    OPEN_A_ERR

   6909  2 000730                       OPEN_A_OK    null
      393     6912    1   OPEN_A_OK: ;
      394     6913    1         CALL ALA$CLOSE_STAR ALTRET ( CLOSE_A_ERR ) ;

   6913  2 000730   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000731   000000 701000 xent               TSX1    ALA$CLOSE_STAR
         2 000732   001207 702000 2                  TSX2    CLOSE_A_ERR

   6909  2 000733                       CLOSE_A_OK   null
      395     6914    1   CLOSE_A_OK: ;
      396     6915    1         CALL ALA$OPEN_STAR_S( AL_ACCT ) ALTRET ( OPEN_S_ERR ) ;

   6915  2 000733   201113 630500                    EPPR0   AL_ACCT,,AUTO
         2 000734   202262 450500                    STP0    FIELD2+12,,AUTO
         2 000735   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 000736   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000737   000000 701000 xent               TSX1    ALA$OPEN_STAR_S
         2 000740   001210 702000 2                  TSX2    OPEN_S_ERR

   6909  2 000741                       OPEN_S_OK    null
      397     6916    1   OPEN_S_OK: ;
      398     6917    1         CP_LIMREC = '0'B ;

   6917  2 000741   000100 100400                    MLR     fill='000'O
         2 000742   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         2 000743   201134 000154                    ADSC9   CP_LIMREC,,AUTO          cn=0,n=108

      399     6918    1         CP_LIMREC.USER_MAX.MAXCORE = AS_USERS.MMEM(MODE-1) ;

   6918  2 000744   201074 235100                    LDA     MODE,,AUTO
         2 000745   000001 735000                    ALS     1
         2 000746   000100 100505                    MLR     fill='000'O
         2 000747   200263 400002                    ADSC9   AS_USERS+176,A,AUTO      cn=2,n=2
         2 000750   201134 000002                    ADSC9   CP_LIMREC,,AUTO          cn=0,n=2
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:78   

      400     6919    1         CP_LIMREC.CUR_MAX.MAXCORE = B$JIT.MAXCORE ;

   6919  2 000751   000000 470400 xsym               LDP0    B$JIT$
         2 000752   000210 220100                    LDX0    136,,PR0
         2 000753   201143 740100                    STX0    CP_LIMREC+7,,AUTO

      401     6920    1         CP_LIMREC.USER_MAX.REMLO = AS_USERS.MLO(MODE-1) ;

   6920  2 000754   201074 721100                    LXL1    MODE,,AUTO
         2 000755   200040 235111                    LDA     AS_USERS+29,X1,AUTO
         2 000756   201135 755100                    STA     CP_LIMREC+1,,AUTO

      402     6921    1         CP_LIMREC.CUR_MAX.REMLO = B$JIT.REMLO ;

   6921  2 000757   000361 235100                    LDA     241,,PR0
         2 000760   201144 755100                    STA     CP_LIMREC+8,,AUTO

      403     6922    1         CP_LIMREC.USER_MAX.REMCPO = AS_USERS.MPO(MODE-1) ;

   6922  2 000761   200060 235111                    LDA     AS_USERS+45,X1,AUTO
         2 000762   201136 755100                    STA     CP_LIMREC+2,,AUTO

      404     6923    1         CP_LIMREC.CUR_MAX.REMCPO = B$JIT.REMCPO ;

   6923  2 000763   000360 235100                    LDA     240,,PR0
         2 000764   201145 755100                    STA     CP_LIMREC+9,,AUTO

      405     6924    1         CP_LIMREC.USER_MAX.REMDO = AS_USERS.MDO(MODE-1) ;

   6924  2 000765   200050 235111                    LDA     AS_USERS+37,X1,AUTO
         2 000766   201137 755100                    STA     CP_LIMREC+3,,AUTO

      406     6925    1         CP_LIMREC.CUR_MAX.REMDO = B$JIT.REMDO ;

   6925  2 000767   000362 235100                    LDA     242,,PR0
         2 000770   201146 755100                    STA     CP_LIMREC+10,,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:79   

      407     6926    1         CP_LIMREC.USER_MAX.MAXTMPDP = AS_USERS.MTDIS(MODE-1) ;

   6926  2 000771   200100 235111                    LDA     AS_USERS+61,X1,AUTO
         2 000772   201141 755100                    STA     CP_LIMREC+5,,AUTO

      408     6927    1         CP_LIMREC.CUR_MAX.MAXTMPDP = B$JIT.MAXTMPDP ;

   6927  2 000773   000241 235100                    LDA     161,,PR0
         2 000774   201150 755100                    STA     CP_LIMREC+12,,AUTO

      409     6928    1         CP_LIMREC.USER_MAX.PRDPRM = AS_USERS.MPDIS(MODE-1) ;

   6928  2 000775   200070 235111                    LDA     AS_USERS+53,X1,AUTO
         2 000776   201140 755100                    STA     CP_LIMREC+4,,AUTO

      410     6929    1         CP_LIMREC.CUR_MAX.PRDPRM = B$JIT.PRDPRM ;

   6929  2 000777   000242 235100                    LDA     162,,PR0
         2 001000   201147 755100                    STA     CP_LIMREC+11,,AUTO

      411     6930    1         CP_LIMREC.USER_MAX.FBUL = AS_USERS.MFPOOLS(MODE-1) ;

   6930  2 001001   201074 236100                    LDQ     MODE,,AUTO
         2 001002   000100 101506                    MRL     fill='000'O
         2 001003   200110 600001                    ADSC9   AS_USERS+69,Q,AUTO       cn=3,n=1
         2 001004   201134 400002                    ADSC9   CP_LIMREC,,AUTO          cn=2,n=2

      412     6931    1         CP_LIMREC.CUR_MAX.FBUL = B$JIT.FBUL ;

   6931  2 001005   000205 722100                    LXL2    133,,PR0
         2 001006   201143 442100                    SXL2    CP_LIMREC+7,,AUTO

      413     6932    1         CP_LIMREC.USER_MAX.MRT = B$JIT.MRT ;

   6932  2 001007   000276 235100                    LDA     190,,PR0
         2 001010   201142 755100                    STA     CP_LIMREC+6,,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:80   

      414     6933    1         CP_LIMREC.CUR_MAX.MRT = B$JIT.MRT ;

   6933  2 001011   000276 235100                    LDA     190,,PR0
         2 001012   201151 755100                    STA     CP_LIMREC+13,,AUTO

      415     6934                                                              /* OUTPUT RECORD */
      416     6935    1         ARS = LENGTHC( CP_LIMREC ) ;

   6935  2 001013   000154 235007                    LDA     108,DL
         2 001014   201036 755100                    STA     ARS,,AUTO

      417     6936    1         TEXT$ = ADDR( CP_LIMREC ) ;

   6936  2 001015   201134 631500                    EPPR1   CP_LIMREC,,AUTO
         2 001016   201055 451500                    STP1    TEXT$,,AUTO

      418     6937    1         CALL ALA$WRITE_STAR( TEXT$, ARS, LIMIT_KEY, AL_DCB2#, ERR_CODE)

   6937  2 001017   201112 633500                    EPPR3   ERR_CODE,,AUTO
         2 001020   202266 453500                    STP3    FIELD2+16,,AUTO
         2 001021   000021 236000 3                  LDQ     17
         2 001022   202265 756100                    STQ     FIELD2+15,,AUTO
         2 001023   201045 634500                    EPPR4   LIMIT_KEY,,AUTO
         2 001024   202264 454500                    STP4    FIELD2+14,,AUTO
         2 001025   201036 635500                    EPPR5   ARS,,AUTO
         2 001026   202263 455500                    STP5    FIELD2+13,,AUTO
         2 001027   201055 636500                    EPPR6   TEXT$,,AUTO
         2 001030   202262 456500                    STP6    FIELD2+12,,AUTO
         2 001031   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001032   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 001033   000000 701000 xent               TSX1    ALA$WRITE_STAR
         2 001034   001212 702000 2                  TSX2    WRITE_STAR_S_ERR

      419     6938    1                 ALTRET( WRITE_STAR_S_ERR ) ;
      420     6939                   /* Call the routine to put the bannertext record into
      421     6940                      *S file.
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:81   
      422     6941                   */
      423     6942    1         IF ((B$JIT.CPFLAGS1 & %CP_SLEAZE#) ~= %CP_SLEAZE#)

   6942  2 001035   000000 470400 xsym               LDP0    B$JIT$
         2 001036   000143 236100                    LDQ     99,,PR0
         2 001037   000003 376000 xsym               ANQ     B_VECTNIL+3
         2 001040   000003 116000 xsym               CMPQ    B_VECTNIL+3
         2 001041   001056 600000 2                  TZE     s:6948

      424     6943    2         THEN DO ;

      425     6944    2             KEY$ = ADDR (AS_USERS);

   6944  2 001042   200003 631500                    EPPR1   AS_USERS,,AUTO
         2 001043   201054 451500                    STP1    KEY$,,AUTO

      426     6945    2             CALL ALA$BANNER2_STAR_S (KEY$, AL_DCB2#, ERR_CODE) ALTRET (
              6945                      WRITE_STAR_S_ERR);

   6945  2 001044   201112 633500                    EPPR3   ERR_CODE,,AUTO
         2 001045   202264 453500                    STP3    FIELD2+14,,AUTO
         2 001046   000021 236000 3                  LDQ     17
         2 001047   202263 756100                    STQ     FIELD2+13,,AUTO
         2 001050   201054 634500                    EPPR4   KEY$,,AUTO
         2 001051   202262 454500                    STP4    FIELD2+12,,AUTO
         2 001052   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001053   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001054   000000 701000 xent               TSX1    ALA$BANNER2_STAR_S
         2 001055   001212 702000 2                  TSX2    WRITE_STAR_S_ERR

      427     6946    2             END;

      428     6947                                                              /**/
      429     6948    1         CALL ALA$CLOSE_STAR ALTRET ( CLOSE_S_ERR ) ;

   6948  2 001056   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001057   000000 701000 xent               TSX1    ALA$CLOSE_STAR
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:82   
         2 001060   001211 702000 2                  TSX2    CLOSE_S_ERR

   6942  2 001061                       CLOSE_S_OK   null
      430     6949    1   CLOSE_S_OK: ;
      431     6950    1         B$JIT.LOGONTIME = AL$TSTAMP.UTS ;

   6950  2 001061   000000 470400 xsym               LDP0    B$JIT$
         2 001062   201116 235100                    LDA     AL$TSTAMP,,AUTO
         2 001063   000150 755100                    STA     104,,PR0

      432     6951    1         IF NOT CP_SLEAZE_SET

   6951  2 001064   201075 234100                    SZN     CP_SLEAZE_SET,,AUTO
         2 001065   001100 604000 2                  TMI     s:6956

      433     6952    2         THEN DO;

      434     6953    2             CALL SET_LAST_LOGON_TIME;

   6953  2 001066   002020 701000 2                  TSX1    SET_LAST_LOGON_TIME
         2 001067   000000 011000                    NOP     0

      435     6954    2             CALL ALA$WRITE_USERS (USERS_KEY, AS_USERS) ALTRET(READ_USERS_ERR);

   6954  2 001070   200003 630500                    EPPR0   AS_USERS,,AUTO
         2 001071   202263 450500                    STP0    FIELD2+13,,AUTO
         2 001072   201037 631500                    EPPR1   USERS_KEY,,AUTO
         2 001073   202262 451500                    STP1    FIELD2+12,,AUTO
         2 001074   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001075   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001076   000000 701000 xent               TSX1    ALA$WRITE_USERS
         2 001077   001141 702000 2                  TSX2    READ_USERS_ERR

      436     6955    2             END;  /* Then Do */

      437     6956    1         B$JIT.BILL = AS_USERS.BILL( MODE-1 ) ;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:83   
   6956  2 001100   201074 236100                    LDQ     MODE,,AUTO
         2 001101   000006 402007                    MPY     6,DL
         2 001102   000000 470400 xsym               LDP0    B$JIT$
         2 001103   040100 100506                    MLR     fill='040'O
         2 001104   200021 400006                    ADSC9   AS_USERS+14,Q,AUTO       cn=2,n=6
         2 001105   000151 400006                    ADSC9   105,,PR0                 cn=2,n=6

      438     6957    1         TEMP_BIT = B$JIT.BLINDACCTNG;

   6957  2 001106   000153 236100                    LDQ     107,,PR0
         2 001107   000022 736000                    QLS     18
         2 001110   400000 376003                    ANQ     -131072,DU
         2 001111   201062 756100                    STQ     TEMP_BIT,,AUTO

      439     6958    1         B$JIT.BLINDACCTNG = NOHEADER;

   6958  2 001112   201064 236100                    LDQ     NOHEADER,,AUTO
         2 001113   000022 772000                    QRL     18
         2 001114   000153 676100                    ERQ     107,,PR0
         2 001115   400000 376007                    ANQ     -131072,DL
         2 001116   000153 656100                    ERSQ    107,,PR0

      440     6959    1         CALL ALA$HEADING( AL$TSTAMP ) ;

   6959  2 001117   201116 631500                    EPPR1   AL$TSTAMP,,AUTO
         2 001120   202262 451500                    STP1    FIELD2+12,,AUTO
         2 001121   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001122   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001123   000000 701000 xent               TSX1    ALA$HEADING
         2 001124   000000 011000                    NOP     0

      441     6960    1         B$JIT.BLINDACCTNG = TEMP_BIT;  /* RESTORE FROM TEMP. */

   6960  2 001125   000000 470400 xsym               LDP0    B$JIT$
         2 001126   201062 236100                    LDQ     TEMP_BIT,,AUTO
         2 001127   000022 772000                    QRL     18
         2 001130   000153 676100                    ERQ     107,,PR0
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:84   
         2 001131   400000 376007                    ANQ     -131072,DL
         2 001132   000153 656100                    ERSQ    107,,PR0

      442     6961    1         CALL ALA$CPEXIT(FPT$CPEXIT);

   6961  2 001133   201170 631500                    EPPR1   FPT$CPEXIT,,AUTO
         2 001134   202262 451500                    STP1    FIELD2+12,,AUTO
         2 001135   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001137   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001140   000000 011000                    NOP     0

   6960  2 001141                       READ_USERS_* null
   6960  2 001141                       READ_ERR_ME* null
      443     6962                                                              /**/
      444     6963    1   READ_USERS_ERR: ;
      445     6964    1   READ_ERR_MESS: ;
      446     6965                                                              /**/
      447     6966        /*E*  ERROR:    ALA-E$USERS_FILE_ERR-C
      448     6967              MESSAGE:  Unable to logon -- see your SYSTEM MANAGER.
      449     6968
      450     6969        */
      451     6970    1         CALL ALA$SYS_ERROR;

   6970  2 001141   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001142   000000 701000 xent               TSX1    ALA$SYS_ERROR
         2 001143   000000 011000                    NOP     0

      452     6971    1         CALL ALA$ERROR( ALA_E$USERS_FILE_ERR );

   6971  2 001144   000022 630400 3                  EPPR0   18
         2 001145   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001146   000000 701000 xent               TSX1    ALA$ERROR
         2 001147   000000 011000                    NOP     0

      453     6972                                                              /**/
      454     6973    1         IF SYS_GHOST
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:85   

   6973  2 001150   201115 234100                    SZN     SYS_GHOST,,AUTO
         2 001151   001161 605000 2                  TPL     s:6977

      455     6974    1         THEN
      456     6975    1             CALL ALA$CPEXIT( FPT$CPEXIT ) ;

   6975  2 001152   201170 630500                    EPPR0   FPT$CPEXIT,,AUTO
         2 001153   202262 450500                    STP0    FIELD2+12,,AUTO
         2 001154   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001155   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001156   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001157   000000 011000                    NOP     0
         2 001160   001164 710000 2                  TRA     OPEN_USERS_ERR

      457     6976    1         ELSE
      458     6977    1             CALL ALA$CPEXIT ;

   6977  2 001161   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001162   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001163   000000 011000                    NOP     0

   6973  2 001164                       OPEN_USERS_* null
      459     6978                                                              /**/
      460     6979                                                              /*   OPEN :USERS ERROR.   */
      461     6980    1   OPEN_USERS_ERR: ;
      462     6981                                                              /**/
      463     6982    1         CALL ALA$SYS_ERROR;

   6982  2 001164   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001165   000000 701000 xent               TSX1    ALA$SYS_ERROR
         2 001166   000000 011000                    NOP     0

      464     6983                                                       /*   OUTPUT MESSAGE TO OPERATOR.  */
      465     6984    1         CALL M$OCMSG ( FPT_OCMSG ) ;

   6984  2 001167   001224 630400 1                  EPPR0   FPT_OCMSG
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:86   
         2 001170   120001 713400                    CLIMB   40961
         2 001171   401000 401760                    pmme    nvectors=3

   6973  2 001172                       BUDGET_ERR   null
      466     6985                                                              /**/
      467     6986    1   BUDGET_ERR: ;
      468     6987    1         IF SYS_GHOST

   6987  2 001172   201115 234100                    SZN     SYS_GHOST,,AUTO
         2 001173   001203 605000 2                  TPL     s:6991

      469     6988    1         THEN
      470     6989    1             CALL ALA$CPEXIT( FPT$CPEXIT ) ;

   6989  2 001174   201170 630500                    EPPR0   FPT$CPEXIT,,AUTO
         2 001175   202262 450500                    STP0    FIELD2+12,,AUTO
         2 001176   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001200   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001201   000000 011000                    NOP     0
         2 001202   001206 710000 2                  TRA     OPEN_A_ERR

      471     6990    1         ELSE
      472     6991    1             CALL ALA$CPEXIT ;

   6991  2 001203   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001204   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001205   000000 011000                    NOP     0

      473     6992                                                              /**/
      474     6993    1   OPEN_A_ERR: GOTO OPEN_A_OK ;

   6993  2 001206   000730 710000 2     OPEN_A_ERR   TRA     OPEN_A_OK

      475     6994    1   CLOSE_A_ERR: GOTO CLOSE_A_OK ;

   6994  2 001207   000733 710000 2     CLOSE_A_ERR  TRA     CLOSE_A_OK
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:87   

      476     6995    1   OPEN_S_ERR: GOTO OPEN_S_OK ;

   6995  2 001210   000741 710000 2     OPEN_S_ERR   TRA     OPEN_S_OK

      477     6996    1   CLOSE_S_ERR: GOTO CLOSE_S_OK ;

   6996  2 001211   001061 710000 2     CLOSE_S_ERR  TRA     CLOSE_S_OK

   6987  2 001212                       WRITE_STAR_* null
      478     6997    1   WRITE_STAR_S_ERR: ;
      479     6998                                                              /**/
      480     6999        /*E*  ERROR:    ALA-E$WRITE_S_ERR-C
      481     7000              MESSAGE:  Unable to write to *S file -- see your SYSTEM MANAGER.
      482     7001        */
      483     7002    1         CALL ALA$ERROR( ALA_E$WRITE_S_ERR );

   7002  2 001212   000023 630400 3                  EPPR0   19
         2 001213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001214   000000 701000 xent               TSX1    ALA$ERROR
         2 001215   000000 011000                    NOP     0

      484     7003    1         IF SYS_GHOST

   7003  2 001216   201115 234100                    SZN     SYS_GHOST,,AUTO
         2 001217   001227 605000 2                  TPL     s:7007

      485     7004    1         THEN
      486     7005    1             CALL ALA$CPEXIT( FPT$CPEXIT ) ;

   7005  2 001220   201170 630500                    EPPR0   FPT$CPEXIT,,AUTO
         2 001221   202262 450500                    STP0    FIELD2+12,,AUTO
         2 001222   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001223   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001224   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001225   000000 011000                    NOP     0
         2 001226   001232 710000 2                  TRA     s:7007+3
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:88   

      487     7006    1         ELSE
      488     7007    1             CALL ALA$CPEXIT ;

   7007  2 001227   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001230   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001231   000000 011000                    NOP     0
         2 001232   002223 710000 2                  TRA     s:7629

      489     7008        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:89   
      490     7009    1   BUDGET: PROC ALTRET ;

   7009  2 001233   201224 741300       BUDGET       STX1  ! FPT$READ_SUSMES+14,,AUTO

      491     7010                                                              /**/
      492     7011                    /*******************************/
      493     7012                    /*                             */
      494     7013                    /*          BUDGET             */
      495     7014                    /*                             */
      496     7015                    /*******************************/
      497     7016        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:90   
      498     7017        /*********************************************************************/
      499     7018        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      500     7019        /*********************************************************************/
      501     7020                                                              /**/
      502     7021                                                              /*   :USERS RECORD.   */
      503     7022              %AS_USERS (STR_NAME = T$USERS, STCLASS = AUTO) ;
      504     7200    2   DCL TEMP SBIN ;
      505     7201    2   DCL FIRST BIT(1) ;
      506     7202    2   DCL 1 FIELD1,
      507     7203    2         2 CNT UBIN BYTE UNAL,
      508     7204    2         2 TXT CHAR(40) UNAL;
      509     7205    2   DCL 1 FIELD2,
      510     7206    2         2 CNT UBIN BYTE UNAL,
      511     7207    2         2 TXT CHAR(40) UNAL;
      512     7208        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:91   
      513     7209        /*********************************************************************/
      514     7210        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      515     7211        /*********************************************************************/
      516     7212                                                              /**/
      517     7213    2         B$JIT.BUDLIM = 0;

   7213  2 001234   000000 470400 xsym               LDP0    B$JIT$
         2 001235   000147 450100                    STZ     103,,PR0

      518     7214    2         UMAX = BITBIN('377777777777'O);

   7214  2 001236   000031 235000 xsym               LDA     B_VECTNIL+25
         2 001237   201057 755100                    STA     UMAX,,AUTO

      519     7215    2         IF AS_USERS.BUDGET.ICHARGES  AND  AS_USERS.BUDGET.MAXC > -1

   7215  2 001240   200022 236100                    LDQ     AS_USERS+15,,AUTO
         2 001241   000040 316003                    CANQ    32,DU
         2 001242   001272 600000 2                  TZE     s:7231
         2 001243   200011 235100                    LDA     AS_USERS+6,,AUTO
         2 001244   001272 604000 2                  TMI     s:7231

      520     7216    3         THEN DO;

      521     7217    3             TEMP = AS_USERS.BUDGET.MAXC - AS_USERS.BUDGET.ACCUM;

   7217  2 001245   200011 236100                    LDQ     AS_USERS+6,,AUTO
         2 001246   200012 136100                    SBLQ    AS_USERS+7,,AUTO
         2 001247   202231 756100                    STQ     TEMP,,AUTO

      522     7218    3             IF NOT AS_USERS.BUDGET.BKACC  AND  TEMP <= 0

   7218  2 001250   200022 236100                    LDQ     AS_USERS+15,,AUTO
         2 001251   000400 316003                    CANQ    256,DU
         2 001252   001263 601000 2                  TNZ     s:7226
         2 001253   202231 235100                    LDA     TEMP,,AUTO
         2 001254   001263 605400 2                  TPNZ    s:7226
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:92   

      523     7219    4             THEN DO;

      524     7220        /*E* ERROR:   ALA-E$MAXC_EXCEEDED-C
      525     7221             MESSAGE: Individual budget exceeded -- unable to logon.
      526     7222        */
      527     7223    4                 CALL ALA$ERROR( ALA_E$MAXC_EXCEEDED );

   7223  2 001255   000024 630400 3                  EPPR0   20
         2 001256   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001257   000000 701000 xent               TSX1    ALA$ERROR
         2 001260   000000 011000                    NOP     0

      528     7224    4                 ALTRETURN;

   7224  2 001261   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 001262   000000 702211                    TSX2  ! 0,X1

      529     7225    4                 END;
      530     7226    3             IF AS_USERS.BUDGET.BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );

   7226  2 001263   000200 316003                    CANQ    128,DU
         2 001264   001272 600000 2                  TZE     s:7231

   7226  2 001265   202231 236100                    LDQ     TEMP,,AUTO
         2 001266   201057 116100                    CMPQ    UMAX,,AUTO
         2 001267   001271 604400 2                  TMOZ    s:7226+6
         2 001270   201057 236100                    LDQ     UMAX,,AUTO
         2 001271   201057 756100                    STQ     UMAX,,AUTO

      531     7227    3             END;

      532     7228                                                      /*
      533     7229                                                         Do any project accounting
      534     7230                                                      */
      535     7231    2         T$USERS = AS_USERS;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:93   
   7231  2 001272   000100 100500                    MLR     fill='000'O
         2 001273   200003 004020                    ADSC9   AS_USERS,,AUTO           cn=0,n=2064
         2 001274   201225 004020                    ADSC9   T$USERS,,AUTO            cn=0,n=2064

      536     7232    2         MASTER_ACCT = AS_USERS.BUDGET.MACCT;

   7232  2 001275   000100 100500                    MLR     fill='000'O
         2 001276   200015 000025                    ADSC9   AS_USERS+10,,AUTO        cn=0,n=21
         2 001277   201065 000025                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=21

      537     7233    3         DO WHILE( T$USERS.BUDGET.PCHARGES  AND  MASTER_ACCT ~= NO_MACCOUNT );

   7233  2 001300   001374 710000 2                  TRA     s:7253

      538     7234    3             CALL ALA$READ_USERS( MASTER_ACCT, T$USERS ) ALTRET(READ_USERS_ERR);

   7234  2 001301   201225 630500                    EPPR0   T$USERS,,AUTO
         2 001302   202263 450500                    STP0    FIELD2+13,,AUTO
         2 001303   201065 631500                    EPPR1   MASTER_ACCT,,AUTO
         2 001304   202262 451500                    STP1    FIELD2+12,,AUTO
         2 001305   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001306   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001307   000000 701000 xent               TSX1    ALA$READ_USERS
         2 001310   001416 702000 2                  TSX2    READ_USERS_ERR

      539     7235    4             IF T$USERS.BUDGET.PMAXC > -1 THEN DO;

   7235  2 001311   201235 235100                    LDA     TMDATE+3,,AUTO
         2 001312   001371 604000 2                  TMI     s:7252

      540     7236    4                 TEMP = T$USERS.BUDGET.PMAXC - T$USERS.BUDGET.PACCUM;

   7236  2 001313   201235 236100                    LDQ     TMDATE+3,,AUTO
         2 001314   201236 136100                    SBLQ    TMDATE+4,,AUTO
         2 001315   202231 756100                    STQ     TEMP,,AUTO

      541     7237    5                 IF NOT T$USERS.BUDGET.BKACC AND TEMP <= 0 THEN DO;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:94   

   7237  2 001316   201244 236100                    LDQ     TBUF+1,,AUTO
         2 001317   000400 316003                    CANQ    256,DU
         2 001320   001361 601000 2                  TNZ     s:7250
         2 001321   202231 235100                    LDA     TEMP,,AUTO
         2 001322   001361 605400 2                  TPNZ    s:7250

      542     7238        /*E* ERROR:   ALA-E$PMAXC_EXCEEDED-C
      543     7239             MESSAGE: Unable to logon.  Budget for project "%U1,%U2" exceeded.
      544     7240        */
      545     7241    5   PROJECT_BUDGET_EXCEEDED:
      546     7242    5                     CALL INDEX( I, AL_BLANK, MASTER_ACCT.ACCT );

   7242  2 001323   000000 124500       PROJECT_BUD* SCM     mask='000'O
         2 001324   201065 200010                    ADSC9   MASTER_ACCT,,AUTO        cn=1,n=8
         2 001325   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 001326   201056 000100                    ARG     I,,AUTO

      547     7243    5                     FIELD1.CNT = I;

   7243  2 001327   201056 236100                    LDQ     I,,AUTO
         2 001330   000033 736000                    QLS     27
         2 001331   202233 552140                    STBQ    FIELD1,'40'O,AUTO

      548     7244    5                     FIELD1.TXT = MASTER_ACCT.ACCT;

   7244  2 001332   040100 100500                    MLR     fill='040'O
         2 001333   201065 200010                    ADSC9   MASTER_ACCT,,AUTO        cn=1,n=8
         2 001334   202233 200050                    ADSC9   FIELD1,,AUTO             cn=1,n=40

      549     7245    5                     FIELD2.CNT = MASTER_ACCT.CNT - 8;

   7245  2 001335   201065 236100                    LDQ     MASTER_ACCT,,AUTO
         2 001336   000033 772000                    QRL     27
         2 001337   000010 136007                    SBLQ    8,DL
         2 001340   000033 736000                    QLS     27
         2 001341   202246 552140                    STBQ    FIELD2,'40'O,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:95   

      550     7246    5                     FIELD2.TXT = MASTER_ACCT.NAME;

   7246  2 001342   040100 100500                    MLR     fill='040'O
         2 001343   201067 200014                    ADSC9   MASTER_ACCT+2,,AUTO      cn=1,n=12
         2 001344   202246 200050                    ADSC9   FIELD2,,AUTO             cn=1,n=40

      551     7247    5                     CALL ALA$ERROR( ALA_E$PMAXC_EXCEEDED, FIELD1, FIELD2 );

   7247  2 001345   202246 630500                    EPPR0   FIELD2,,AUTO
         2 001346   202264 450500                    STP0    FIELD2+14,,AUTO
         2 001347   202233 631500                    EPPR1   FIELD1,,AUTO
         2 001350   202263 451500                    STP1    FIELD2+13,,AUTO
         2 001351   000025 236000 3                  LDQ     21
         2 001352   202262 756100                    STQ     FIELD2+12,,AUTO
         2 001353   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001354   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001355   000000 701000 xent               TSX1    ALA$ERROR
         2 001356   000000 011000                    NOP     0

      552     7248    5                     ALTRETURN;

   7248  2 001357   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 001360   000000 702211                    TSX2  ! 0,X1

      553     7249    5                     END;
      554     7250    4                 IF AS_USERS.BUDGET.BUDLIM THEN UMAX = MINIMUM( UMAX, TEMP );

   7250  2 001361   200022 236100                    LDQ     AS_USERS+15,,AUTO
         2 001362   000200 316003                    CANQ    128,DU
         2 001363   001371 600000 2                  TZE     s:7252

   7250  2 001364   202231 236100                    LDQ     TEMP,,AUTO
         2 001365   201057 116100                    CMPQ    UMAX,,AUTO
         2 001366   001370 604400 2                  TMOZ    s:7250+7
         2 001367   201057 236100                    LDQ     UMAX,,AUTO
         2 001370   201057 756100                    STQ     UMAX,,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:96   

      555     7251    4                 END;

      556     7252    3             MASTER_ACCT = T$USERS.BUDGET.MACCT;

   7252  2 001371   000100 100500                    MLR     fill='000'O
         2 001372   201237 000025                    ADSC9   TMDATE+5,,AUTO           cn=0,n=21
         2 001373   201065 000025                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=21

      557     7253    3             END;

   7253  2 001374   201244 236100                    LDQ     TBUF+1,,AUTO
         2 001375   000100 316003                    CANQ    64,DU
         2 001376   001403 600000 2                  TZE     s:7254
         2 001377   000000 106500                    CMPC    fill='000'O
         2 001400   201065 000025                    ADSC9   MASTER_ACCT,,AUTO        cn=0,n=21
         2 001401   001016 000025 1                  ADSC9   NO_MACCOUNT              cn=0,n=21
         2 001402   001301 601000 2                  TNZ     s:7234

      558     7254    2         IF AS_USERS.BUDGET.BUDLIM THEN B$JIT.BUDLIM = MAXIMUM( 1, UMAX );

   7254  2 001403   200022 236100                    LDQ     AS_USERS+15,,AUTO
         2 001404   000200 316003                    CANQ    128,DU
         2 001405   001414 600000 2                  TZE     s:7255

   7254  2 001406   201057 236100                    LDQ     UMAX,,AUTO
         2 001407   000001 116007                    CMPQ    1,DL
         2 001410   001412 605000 2                  TPL     s:7254+7
         2 001411   000001 236007                    LDQ     1,DL
         2 001412   000000 470400 xsym               LDP0    B$JIT$
         2 001413   000147 756100                    STQ     103,,PR0

      559     7255    2         RETURN;

   7255  2 001414   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 001415   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:97   
      560     7256
      561     7257    2   READ_USERS_ERR:
      562     7258                                                              /**/
      563     7259                                                              /**/
      564     7260        /*E*  ERROR:    ALA-E$NO_MASTER-C
      565     7261              MESSAGE:  PROJECT ADMINISTRATOR does not exist -- unable to logon.
      566     7262
      567     7263        */
      568     7264    2         CALL ALA$ERROR( ALA_E$NO_MASTER );

   7264  2 001416   000026 630400 3     READ_USERS_* EPPR0   22
         2 001417   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001420   000000 701000 xent               TSX1    ALA$ERROR
         2 001421   000000 011000                    NOP     0

      569     7265                                                              /**/
      570     7266    2         ALTRETURN ;

   7266  2 001422   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 001423   000000 702211                    TSX2  ! 0,X1

      571     7267    2   END   BUDGET ;
      572     7268        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:98   
      573     7269                                                              /**/
      574     7270    1   CPROC: PROC ;

   7270  2 001424   201224 741300       CPROC        STX1  ! FPT$READ_SUSMES+14,,AUTO

      575     7271                                                                      /**/
      576     7272    2         IF AS_USERS.CPROC.NAME.CNT(MODE-1) ~= 0

   7272  2 001425   201074 235100                    LDA     MODE,,AUTO
         2 001426   000003 735000                    ALS     3
         2 001427   200120 236105                    LDQ     AS_USERS+77,AL,AUTO
         2 001430   777000 316003                    CANQ    -512,DU
         2 001431   001447 600000 2                  TZE     s:7281

      577     7273    2         THEN
      578     7274    3         DO ;

      579     7275    3             CP_NAME = AS_USERS.CPROC.NAME(MODE-1) ;

   7275  2 001432   201074 235100                    LDA     MODE,,AUTO
         2 001433   000005 735000                    ALS     5
         2 001434   000100 100505                    MLR     fill='000'O
         2 001435   200120 000040                    ADSC9   AS_USERS+77,A,AUTO       cn=0,n=32
         2 001436   201076 000040                    ADSC9   CP_NAME,,AUTO            cn=0,n=32

      580     7276    3             CP_ACCT = ':SYS' ;

   7276  2 001437   001310 236000 1                  LDQ     LFC_VLP+12
         2 001440   000044 737000                    LLS     36
         2 001441   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001442   201106 757100                    STAQ    CP_ACCT,,AUTO

      581     7277    3             CP_PASSW = ' ' ;

   7277  2 001443   000035 235000 xsym               LDA     B_VECTNIL+29
         2 001444   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001445   201110 757100                    STAQ    CP_PASSW,,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:99   

      582     7278    3             END ;   /*  THEN DO  */

   7278  2 001446   001461 710000 2                  TRA     s:7286

      583     7279    2         ELSE
      584     7280    3         DO ;

      585     7281    3             CP_NAME = DF_CP_NAME ;

   7281  2 001447   000100 100400                    MLR     fill='000'O
         2 001450   000000 000040 xsym               ADSC9   DF_CP_NAME               cn=0,n=32
         2 001451   201076 000040                    ADSC9   CP_NAME,,AUTO            cn=0,n=32

      586     7282    3             CP_ACCT = ':SYS' ;

   7282  2 001452   001310 236000 1                  LDQ     LFC_VLP+12
         2 001453   000044 737000                    LLS     36
         2 001454   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001455   201106 757100                    STAQ    CP_ACCT,,AUTO

      587     7283    3             CP_PASSW = ' ' ;

   7283  2 001456   000035 235000 xsym               LDA     B_VECTNIL+29
         2 001457   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 001460   201110 757100                    STAQ    CP_PASSW,,AUTO

      588     7284    3             END ;   /*  ELSE DO  */

      589     7285                                                              /**/
      590     7286    2         RETURN ;

   7286  2 001461   000001 702211                    TSX2  ! 1,X1

      591     7287                                                              /**/
      592     7288    2   END   CPROC ;
      593     7289        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:100  
      594     7290                                                              /**/
      595     7291    1   FREECMD: PROC ;

   7291  2 001462   201224 741300       FREECMD      STX1  ! FPT$READ_SUSMES+14,,AUTO

      596     7292                                                                      /**/
      597     7293    2         IF AS_USERS.SETUP(MODE-1) = -1     /* Empty */

   7293  2 001463   201074 235100                    LDA     MODE,,AUTO
         2 001464   000001 735000                    ALS     1
         2 001465   000100 100505                    MLR     fill='000'O
         2 001466   200354 400002                    ADSC9   AS_USERS+233,A,AUTO      cn=2,n=2
         2 001467   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 001470   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 001471   000022 732000                    QRS     18
         2 001472   000027 116000 xsym               CMPQ    B_VECTNIL+23
         2 001473   001502 601000 2                  TNZ     s:7300

      598     7294    2         THEN
      599     7295                                                              /*  NO FREE COMMAND   */
      600     7296    2             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 &~ %CP_BUFFULL#;

   7296  2 001474   001305 236000 1                  LDQ     LFC_VLP+9
         2 001475   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 001476   000000 470400 xsym               LDP0    B$JIT$
         2 001477   000143 376100                    ANQ     99,,PR0
         2 001500   000143 756100                    STQ     99,,PR0
         2 001501   001560 710000 2                  TRA     s:7324

      601     7297    2         ELSE
      602     7298    3         DO ;

      603     7299                                                              /*   FREE COMMAND EXITS   */
      604     7300    3             TEXT$=PINCRC(ADDR(AS_USERS.SETUP_CHRA.TXT),AS_USERS.SETUP(MODE-1));

   7300  2 001502   000100 100505                    MLR     fill='000'O
         2 001503   200354 400002                    ADSC9   AS_USERS+233,A,AUTO      cn=2,n=2
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:101  
         2 001504   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 001505   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 001506   000022 732000                    QRS     18
         2 001507   202263 452500                    STP2    FIELD2+13,,AUTO
         2 001510   000020 736000                    QLS     16
         2 001511   000365 036003                    ADLQ    245,DU
         2 001512   202263 036100                    ADLQ    FIELD2+13,,AUTO
         2 001513   201055 756100                    STQ     TEXT$,,AUTO

      605     7301    3             B$JIT$ -> B$JIT.CCARS = TEXT$ -> TEXT$C.L;

   7301  2 001514   201055 470500                    LDP0    TEXT$,,AUTO
         2 001515   000000 471400 xsym               LDP1    B$JIT$
         2 001516   000100 101500                    MRL     fill='000'O
         2 001517   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 001520   100032 000002                    ADSC9   26,,PR1                  cn=0,n=2

      606     7302    3             B$JIT$ -> B$JIT.CCDISP = TEXT$ -> TEXT$C.L;

   7302  2 001521   201055 470500                    LDP0    TEXT$,,AUTO
         2 001522   000100 101500                    MRL     fill='000'O
         2 001523   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 001524   100032 400002                    ADSC9   26,,PR1                  cn=2,n=2

      607     7303    3             B$JIT$ -> B$JIT.CCBUF = TEXT$ -> TEXT$C.C;

   7303  2 001525   201055 470500                    LDP0    TEXT$,,AUTO
         2 001526   000100 101500                    MRL     fill='000'O
         2 001527   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         2 001530   202262 000002                    ADSC9   FIELD2+12,,AUTO          cn=0,n=2
         2 001531   202262 220100                    LDX0    FIELD2+12,,AUTO
         2 001532   040100 100540                    MLR     fill='040'O
         2 001533   000000 200010                    ADSC9   0,,PR0                   cn=1,n=*X0
         2 001534   100033 000400                    ADSC9   27,,PR1                  cn=0,n=256

      608     7304    3             B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 | %CP_BUFFULL#;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:102  
   7304  2 001535   100143 236100                    LDQ     99,,PR1
         2 001536   001305 276000 1                  ORQ     LFC_VLP+9
         2 001537   100143 756100                    STQ     99,,PR1

      609     7305    3             IF NOSETUP

   7305  2 001540   201063 234100                    SZN     NOSETUP,,AUTO
         2 001541   001560 605000 2                  TPL     s:7324

      610     7306    4             THEN DO;

      611     7307    4                 IF (AS_USERS.SETUP_FORCE (MODE - 1) )

   7307  2 001542   201074 235100                    LDA     MODE,,AUTO
         2 001543   000000 066505                    CMPB    filb='0'B
         2 001544   200354 640001                    BDSC    AS_USERS+233,A,AUTO      by=3,bit=4,n=1
         2 001545   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 001546   001554 600000 2                  TZE     s:7319

      612     7308    5                 THEN DO;

      613     7309        /*E* ERROR:  ALA-E$SETUP_FORCED-C
      614     7310             MESSAGE0: NS option ignored, your authorization requires setup.
      615     7311             MESSAGE1: You specified NoSetup when logging on, but your system
      616     7312                       administrator wants the FORCE to be with you.
      617     7313             MESSAGE2: If you have the FORCE, then your setup command must
      618     7314                       be executed.
      619     7315        */
      620     7316    5                     CALL ALA$ERROR (ALA_E$SETUP_FORCED);

   7316  2 001547   000027 630400 3                  EPPR0   23
         2 001550   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001551   000000 701000 xent               TSX1    ALA$ERROR
         2 001552   000000 011000                    NOP     0

      621     7317    5                     END;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:103  
   7317  2 001553   001560 710000 2                  TRA     s:7324

      622     7318    5                 ELSE DO;

      623     7319    5                     B$JIT.CPFLAGS1 = B$JIT.CPFLAGS1 &~ %CP_BUFFULL#;

   7319  2 001554   001305 236000 1                  LDQ     LFC_VLP+9
         2 001555   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 001556   100143 376100                    ANQ     99,,PR1
         2 001557   100143 756100                    STQ     99,,PR1

      624     7320    5                     END;

      625     7321    4                 END;

      626     7322    3             END ;   /*  THEN DO  */

      627     7323                                                              /**/
      628     7324    2         RETURN ;

   7324  2 001560   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 001561   000001 702211                    TSX2  ! 1,X1

      629     7325                                                              /**/
      630     7326    2   END   FREECMD ;
      631     7327        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:104  
      632     7328                                                              /**/
      633     7329    1   CP_NO_EXISTS: PROC ;

   7329  2 001562   201224 741300       CP_NO_EXISTS STX1  ! FPT$READ_SUSMES+14,,AUTO

      634     7330                                                              /**/
      635     7331                                                              /**/
      636     7332        /*********************************************************************/
      637     7333        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      638     7334        /*********************************************************************/
      639     7335                                                              /**/
      640     7336    2   DCL 1 ERR_BUF ALIGNED ,
      641     7337    2         2 CNT UBIN(9) UNAL ,
      642     7338    2         2 TEXT CHAR(40) UNAL ;
      643     7339    2   DCL CNT UBIN WORD ;
      644     7340    2   DCL I UBIN WORD ;
      645     7341        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:105  
      646     7342        /*********************************************************************/
      647     7343        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      648     7344        /*********************************************************************/
      649     7345                                                              /**/
      650     7346                                                             /*   PICK UP CP NAME.ACCT.  */
      651     7347    2         CP_NAME = DCBADDR(%M$LM#) -> F$DCB.NAME# ;

   7347  2 001563   000000 470400 3                  LDP0    0
         2 001564   000000 471500                    LDP1    0,,PR0
         2 001565   100002 473500                    LDP3    2,,PR1
         2 001566   000100 100500                    MLR     fill='000'O
         2 001567   300010 000040                    ADSC9   8,,PR3                   cn=0,n=32
         2 001570   201076 000040                    ADSC9   CP_NAME,,AUTO            cn=0,n=32

      652     7348    2         CP_ACCT = DCBADDR(%M$LM#) -> F$DCB.ACCT# ;

   7348  2 001571   300020 237100                    LDAQ    16,,PR3
         2 001572   201106 757100                    STAQ    CP_ACCT,,AUTO

      653     7349                                                         /*   MOVE CP NAME TO ERR_BUFF.  */
      654     7350    2         ERR_BUF.TEXT = CP_NAME.NAME# ;

   7350  2 001573   040100 100500                    MLR     fill='040'O
         2 001574   201076 200037                    ADSC9   CP_NAME,,AUTO            cn=1,n=31
         2 001575   201225 200050                    ADSC9   ERR_BUF,,AUTO            cn=1,n=40

      655     7351                                                              /*   FIND SIZE OF ACCT.   */
      656     7352    2         CALL INDEX( CNT, AL_BLANK, CP_ACCT );

   7352  2 001576   000000 124500                    SCM     mask='000'O
         2 001577   201106 000010                    ADSC9   CP_ACCT,,AUTO            cn=0,n=8
         2 001600   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 001601   201240 000100                    ARG     CNT,,AUTO

      657     7353                                                              /**/
      658     7354    2         ERR_BUF.CNT = CNT + CP_NAME.L# + 2 ;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:106  
   7354  2 001602   201076 236100                    LDQ     CP_NAME,,AUTO
         2 001603   000033 772000                    QRL     27
         2 001604   201240 036100                    ADLQ    CNT,,AUTO
         2 001605   000002 036007                    ADLQ    2,DL
         2 001606   000033 736000                    QLS     27
         2 001607   201225 552140                    STBQ    ERR_BUF,'40'O,AUTO

      659     7355                                                             /*   MOVE ACCT TO ERR_BUF.  */
      660     7356    2         CALL INSERT(ERR_BUF.TEXT, CP_NAME.L#, 9, '.', CP_ACCT) ;

   7356  2 001610   201076 236100                    LDQ     CP_NAME,,AUTO
         2 001611   000033 772000                    QRL     27
         2 001612   040106 100400                    MLR     fill='040'O
         2 001613   000030 000001 3                  ADSC9   24                       cn=0,n=1
         2 001614   201225 200001                    ADSC9   ERR_BUF,Q,AUTO           cn=1,n=1
         2 001615   040106 100500                    MLR     fill='040'O
         2 001616   201106 000010                    ADSC9   CP_ACCT,,AUTO            cn=0,n=8
         2 001617   201225 400010                    ADSC9   ERR_BUF,Q,AUTO           cn=2,n=8

      661     7357                                                              /**/
      662     7358                                                              /*   CHECK FOR DEFAULT CP. */
      663     7359    2         IF CP_NAME = DF_CP_NAME AND CP_ACCT = DF_CP_ACCT

   7359  2 001620   000000 106500                    CMPC    fill='000'O
         2 001621   201076 000040                    ADSC9   CP_NAME,,AUTO            cn=0,n=32
         2 001622   000000 000040 xsym               ADSC9   DF_CP_NAME               cn=0,n=32
         2 001623   001637 601000 2                  TNZ     s:7367
         2 001624   040000 106500                    CMPC    fill='040'O
         2 001625   201106 000010                    ADSC9   CP_ACCT,,AUTO            cn=0,n=8
         2 001626   000000 000010 xsym               ADSC9   DF_CP_ACCT               cn=0,n=8
         2 001627   001637 601000 2                  TNZ     s:7367

      664     7360    2         THEN
      665     7361    3         DO ;

      666     7362    3             ERR_CODE.CODE = 1 /* DF_CP_MISSING */ ;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:107  
   7362  2 001630   201112 236100                    LDQ     ERR_CODE,,AUTO
         2 001631   000031 376000 3                  ANQ     25
         2 001632   000010 276007                    ORQ     8,DL
         2 001633   201112 756100                    STQ     ERR_CODE,,AUTO

      667     7363    3             ERR_CODE.SEV = 7 ;

   7363  2 001634   000007 236007                    LDQ     7,DL
         2 001635   201112 256100                    ORSQ    ERR_CODE,,AUTO

      668     7364    3             END ;   /*  THEN DO  */

   7364  2 001636   001645 710000 2                  TRA     s:7370

      669     7365    2         ELSE
      670     7366    3         DO ;

      671     7367    3             ERR_CODE.CODE = 2 /* CP_MISSING */ ;

   7367  2 001637   201112 236100                    LDQ     ERR_CODE,,AUTO
         2 001640   000031 376000 3                  ANQ     25
         2 001641   000020 276007                    ORQ     16,DL
         2 001642   201112 756100                    STQ     ERR_CODE,,AUTO

      672     7368    3             ERR_CODE.SEV = 0 ;

   7368  2 001643   000032 236000 3                  LDQ     26
         2 001644   201112 356100                    ANSQ    ERR_CODE,,AUTO

      673     7369    3             END ;   /*  ELSE DO  */

      674     7370    2         ERR_CODE.FCG_MID = FCG ;

   7370  2 001645   000000 220000 1                  LDX0    FCG
         2 001646   201112 740100                    STX0    ERR_CODE,,AUTO

      675     7371                                                              /**/
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:108  
      676     7372        /*E*  ERROR:    ALA-E$DF_CP_MISSING-C
      677     7373              MESSAGE7: The default command processor %%U1%does not exist.
      678     7374                        See SYSTEM MANAGER.
      679     7375
      680     7376        */
      681     7377                                                              /**/
      682     7378        /*E*  ERROR:    ALA-E$CP_MISSING-C
      683     7379              MESSAGE:  Command processor %%U1 %does not exist.
      684     7380
      685     7381        */
      686     7382                                                              /**/
      687     7383    2         CALL ALA$ERROR(ERR_CODE, ERR_BUF.CNT) ;

   7383  2 001647   201225 630500                    EPPR0   ERR_BUF,,AUTO
         2 001650   202263 450500                    STP0    FIELD2+13,,AUTO
         2 001651   201112 631500                    EPPR1   ERR_CODE,,AUTO
         2 001652   202262 451500                    STP1    FIELD2+12,,AUTO
         2 001653   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001654   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001655   000000 701000 xent               TSX1    ALA$ERROR
         2 001656   000000 011000                    NOP     0

      688     7384                                                             /*   IF DEFAULT CP LOG-OFF. */
      689     7385    2         IF ERR_CODE.CODE = 1 /* DF_CP_MISSING */

   7385  2 001657   201112 236100                    LDQ     ERR_CODE,,AUTO
         2 001660   777770 376007                    ANQ     -8,DL
         2 001661   000010 116007                    CMPQ    8,DL
         2 001662   001677 601000 2                  TNZ     s:7394

      690     7386    2         THEN
      691     7387    2             IF SYS_GHOST

   7387  2 001663   201115 234100                    SZN     SYS_GHOST,,AUTO
         2 001664   001674 605000 2                  TPL     s:7391

      692     7388    2             THEN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:109  
      693     7389    2                 CALL ALA$CPEXIT( FPT$CPEXIT ) ;

   7389  2 001665   201170 630500                    EPPR0   FPT$CPEXIT,,AUTO
         2 001666   202262 450500                    STP0    FIELD2+12,,AUTO
         2 001667   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001670   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001671   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001672   000000 011000                    NOP     0
         2 001673   001677 710000 2                  TRA     s:7394

      694     7390    2             ELSE
      695     7391    2                 CALL ALA$CPEXIT ;

   7391  2 001674   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001675   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001676   000000 011000                    NOP     0

      696     7392                                                              /**/
      697     7393                                                              /*   CPEXIT TO DEFAULT CP. */
      698     7394    2         CP_NAME = DF_CP_NAME ;

   7394  2 001677   000100 100400                    MLR     fill='000'O
         2 001700   000000 000040 xsym               ADSC9   DF_CP_NAME               cn=0,n=32
         2 001701   201076 000040                    ADSC9   CP_NAME,,AUTO            cn=0,n=32

      699     7395    2         CP_ACCT = DF_CP_ACCT ;

   7395  2 001702   040100 100400                    MLR     fill='040'O
         2 001703   000000 000010 xsym               ADSC9   DF_CP_ACCT               cn=0,n=8
         2 001704   201106 000010                    ADSC9   CP_ACCT,,AUTO            cn=0,n=8

      700     7396    2         CP_PASSW = DF_CP_PASS ;

   7396  2 001705   040100 100400                    MLR     fill='040'O
         2 001706   000000 000010 xsym               ADSC9   DF_CP_PASS               cn=0,n=8
         2 001707   201110 000010                    ADSC9   CP_PASSW,,AUTO           cn=0,n=8

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:110  
      701     7397    2         CALL ALA$CPEXIT(FPT$CPEXIT);

   7397  2 001710   201170 630500                    EPPR0   FPT$CPEXIT,,AUTO
         2 001711   202262 450500                    STP0    FIELD2+12,,AUTO
         2 001712   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 001713   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001714   000000 701000 xent               TSX1    ALA$CPEXIT
         2 001715   000000 011000                    NOP     0

      702     7398                                                              /**/
      703     7399    2   END   CP_NO_EXISTS ;

   7399  2 001716   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 001717   000001 702211                    TSX2  ! 1,X1

      704     7400        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:111  
      705     7401    1   CLRES: PROC;

   7401  2 001720   201224 741300       CLRES        STX1  ! FPT$READ_SUSMES+14,,AUTO

      706     7402                                                              /**/
      707     7403        /*********************************************************************/
      708     7404        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      709     7405        /*********************************************************************/
      710     7406                                                              /**/
      711     7407    2   DCL I UBIN ;
      712     7408    2   DCL MAX UBIN;
      713     7409        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:112  
      714     7410        /*********************************************************************/
      715     7411        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      716     7412        /*********************************************************************/
      717     7413                                                              /**/
      718     7414    2         B$JIT.CLRES = '0'B;

   7414  2 001721   000000 470400 xsym               LDP0    B$JIT$
         2 001722   000013 236000 3                  LDQ     11
         2 001723   000325 356100                    ANSQ    213,,PR0

      719     7415    3         DO I = 0 TO AS_USERS.TOT_TYPES-1;

   7415  2 001724   201225 450100                    STZ     I,,AUTO
         2 001725   002011 710000 2                  TRA     s:7442+3

      720     7416    3             IF AS_USERS.RESL.RNAME(I) = 'CL'

   7416  2 001726   201225 236100                    LDQ     I,,AUTO
         2 001727   000012 402007                    MPY     10,DL
         2 001730   040000 106506                    CMPC    fill='040'O
         2 001731   200330 400002                    ADSC9   AS_USERS+213,Q,AUTO      cn=2,n=2
         2 001732   001311 000002 1                  ADSC9   LFC_VLP+13               cn=0,n=2
         2 001733   002006 601000 2                  TNZ     s:7442

      721     7417    3             THEN
      722     7418    4             DO;

      723     7419    5                 DO CASE(MODE);

   7419  2 001734   201074 235100                    LDA     MODE,,AUTO
         2 001735   000005 115007                    CMPA    5,DL
         2 001736   001740 602005 2                  TNC     s:7419+4,AL
         2 001737   001764 710000 2                  TRA     s:7429
         2 001740   001764 710000 2                  TRA     s:7429
         2 001741   001751 710000 2                  TRA     s:7423
         2 001742   001755 710000 2                  TRA     s:7425
         2 001743   001745 710000 2                  TRA     s:7421
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:113  
         2 001744   001761 710000 2                  TRA     s:7427

      724     7420    5                   CASE(%M_INT#);

      725     7421    5                     MAX = AS_USERS.RESL.OMAX(I);

   7421  2 001745   000100 101506                    MRL     fill='000'O
         2 001746   200332 000002                    ADSC9   AS_USERS+215,Q,AUTO      cn=0,n=2
         2 001747   201226 000004                    ADSC9   MAX,,AUTO                cn=0,n=4
         2 001750   001764 710000 2                  TRA     s:7429

      726     7422    5                   CASE(%M_BATCH#);

      727     7423    5                     MAX = AS_USERS.RESL.BMAX(I);

   7423  2 001751   000100 101506                    MRL     fill='000'O
         2 001752   200331 000002                    ADSC9   AS_USERS+214,Q,AUTO      cn=0,n=2
         2 001753   201226 000004                    ADSC9   MAX,,AUTO                cn=0,n=4
         2 001754   001764 710000 2                  TRA     s:7429

      728     7424    5                   CASE(%M_GHOST#);

      729     7425    5                     MAX = AS_USERS.RESL.GMAX(I);

   7425  2 001755   000100 101506                    MRL     fill='000'O
         2 001756   200331 400002                    ADSC9   AS_USERS+214,Q,AUTO      cn=2,n=2
         2 001757   201226 000004                    ADSC9   MAX,,AUTO                cn=0,n=4
         2 001760   001764 710000 2                  TRA     s:7429

      730     7426    5                   CASE(%M_TP#);

      731     7427    5                     MAX = AS_USERS.RESL.TMAX(I);

   7427  2 001761   000100 101506                    MRL     fill='000'O
         2 001762   200332 400002                    ADSC9   AS_USERS+215,Q,AUTO      cn=2,n=2
         2 001763   201226 000004                    ADSC9   MAX,,AUTO                cn=0,n=4

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:114  
      732     7428    5                   END; /* Do Case */

      733     7429    4                 IF MAX=1

   7429  2 001764   201226 235100                    LDA     MAX,,AUTO
         2 001765   000001 115007                    CMPA    1,DL
         2 001766   001772 601000 2                  TNZ     s:7432

      734     7430    4                 THEN
      735     7431    4                     B$JIT.CLRES(0) = '1'B;

   7431  2 001767   000000 470400 xsym               LDP0    B$JIT$
         2 001770   400000 236003                    LDQ     -131072,DU
         2 001771   000325 256100                    ORSQ    213,,PR0

      736     7432    4                 IF MAX=2

   7432  2 001772   000002 115007                    CMPA    2,DL
         2 001773   002001 601000 2                  TNZ     s:7438

      737     7433    4                 THEN
      738     7434    5                 DO;

      739     7435    5                     B$JIT.CLRES(0) = '1'B;

   7435  2 001774   000000 470400 xsym               LDP0    B$JIT$
         2 001775   400000 236003                    LDQ     -131072,DU
         2 001776   000325 256100                    ORSQ    213,,PR0

      740     7436    5                     B$JIT.CLRES(1) = '1'B;

   7436  2 001777   200000 236003                    LDQ     65536,DU
         2 002000   000325 256100                    ORSQ    213,,PR0

      741     7437    5                     END;  /* Then Do */

      742     7438    4                 IF MAX>2
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:115  

   7438  2 002001   000003 115007                    CMPA    3,DL
         2 002002   002006 602000 2                  TNC     s:7442

      743     7439    4                 THEN
      744     7440    4                     B$JIT.CLRES(2) = '1'B;

   7440  2 002003   000000 470400 xsym               LDP0    B$JIT$
         2 002004   100000 236003                    LDQ     32768,DU
         2 002005   000325 256100                    ORSQ    213,,PR0

      745     7441    4                 END; /* Then Do */

      746     7442    3             END; /* Do I */

   7442  2 002006   201225 235100                    LDA     I,,AUTO
         2 002007   000001 035007                    ADLA    1,DL
         2 002010   201225 755100                    STA     I,,AUTO
         2 002011   200330 236100                    LDQ     AS_USERS+213,,AUTO
         2 002012   000022 772000                    QRL     18
         2 002013   201225 116100                    CMPQ    I,,AUTO
         2 002014   002016 600000 2                  TZE     s:7444
         2 002015   001726 603000 2                  TRC     s:7416

      747     7443
      748     7444    2         RETURN;

   7444  2 002016   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 002017   000001 702211                    TSX2  ! 1,X1

      749     7445
      750     7446    2   END   CLRES;
      751     7447        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:116  
      752     7448    1   SET_LAST_LOGON_TIME: PROC;

   7448  2 002020   201224 741300       SET_LAST_LO* STX1  ! FPT$READ_SUSMES+14,,AUTO

      753     7449                                                              /**/
      754     7450        /*********************************************************************/
      755     7451        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
      756     7452        /*********************************************************************/
      757     7453                                                              /**/
      758     7454    2   DCL I UBIN ;
      759     7455    2   DCL POS UBIN;
      760     7456    2   DCL BAD_CNT_CHAR CHAR(10);
      761     7457    2   DCL 1 TMDATE ALIGNED ,
      762     7458    2         2 CNT UBIN(9) UNAL ,
      763     7459    2         2 BUFF UNAL ,
      764     7460    2           3 TIME CHAR(5) UNAL ,
      765     7461    2           3 * CHAR(1) UNAL ,
      766     7462    2           3 DAY CHAR(3) UNAL ,
      767     7463    2           3 * CHAR(1) UNAL ,
      768     7464    2           3 DATE CHAR(10) UNAL ,
      769     7465    2         2 RDEF_BUFF REDEF BUFF CHAR(20) ;
      770     7466    2   DCL 1 BAD_CNT_BUF,
      771     7467    2         2 CNT UBIN (9) UNAL,
      772     7468    2         2 TEXT CHAR(10);
      773     7469    2   DCL TBUF CHAR(6);
      774     7470                                                              /**/
      775     7471        /*********************************************************************/
      776     7472        /*   FPTs & VLPs     FPTs & VLPs     FPTs & VLPs     FPTs & VLPs     */
      777     7473        /*********************************************************************/
      778     7474                                                              /**/
      779     7475        %FPT_CMDVAR (FPTN = CFPT_CMDVAR,
      780     7476                     STCLASS = CONSTANT,
      781     7477                     FUN = STORE);
      782     7494        %FPT_CMDVAR (FPTN = FPT_CMDVAR,
      783     7495                     STCLASS = AUTO);
      784     7512        %VLP_NAME (FPTN=LLT_VLP,
      785     7513                   STCLASS = CONSTANT,
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:117  
      786     7514                   LEN = 15,
      787     7515                   NAME = 'LAST_LOGON_TIME');
      788     7542        %VLP_NAME (FPTN=LFC_VLP,
      789     7543                   STCLASS = CONSTANT,
      790     7544                   LEN = 19,
      791     7545                   NAME = 'LOGON_FAILURE_COUNT');
      792     7572        %EJECT ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:118  
      793     7573        /*********************************************************************/
      794     7574        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
      795     7575        /*********************************************************************/
      796     7576                                                              /**/
      797     7577                                                              /* Setup Command variable
      798     7578                                                                 LAST_LOGON_TIME
      799     7579                                                              */
      800     7580    2         AL$LLT_TSTAMP.UTS = AS_USERS.LOGINS.LAST_LOGON_TIME(MODE-1);

   7580  2 002021   201074 235100                    LDA     MODE,,AUTO
         2 002022   000001 735000                    ALS     1
         2 002023   200765 235105                    LDA     AS_USERS+498,AL,AUTO
         2 002024   201125 755100                    STA     AL$LLT_TSTAMP,,AUTO

      801     7581    2         CALL ALA$TIME (AL$LLT_TSTAMP);

   7581  2 002025   201125 630500                    EPPR0   AL$LLT_TSTAMP,,AUTO
         2 002026   202262 450500                    STP0    FIELD2+12,,AUTO
         2 002027   202262 630500                    EPPR0   FIELD2+12,,AUTO
         2 002030   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002031   000000 701000 xent               TSX1    ALA$TIME
         2 002032   000000 011000                    NOP     0

      802     7582    2         TMDATE.RDEF_BUFF = AL_BLANK ;          /*   Blank fill time buffer. */

   7582  2 002033   040100 100400                    MLR     fill='040'O
         2 002034   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 002035   201232 200024                    ADSC9   TMDATE,,AUTO             cn=1,n=20

      803     7583    2         TMDATE.BUFF.TIME = SUBSTR (AL$LLT_TSTAMP.TIME, 0, 5);

   7583  2 002036   040100 100500                    MLR     fill='040'O
         2 002037   201126 000005                    ADSC9   AL$LLT_TSTAMP+1,,AUTO    cn=0,n=5
         2 002040   201232 200005                    ADSC9   TMDATE,,AUTO             cn=1,n=5

      804     7584
      805     7585    2         TMDATE.BUFF.DAY  = AL$LLT_TSTAMP.DAY  ;
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:119  

   7585  2 002041   040100 100500                    MLR     fill='040'O
         2 002042   201130 600003                    ADSC9   AL$LLT_TSTAMP+3,,AUTO    cn=3,n=3
         2 002043   201233 600003                    ADSC9   TMDATE+1,,AUTO           cn=3,n=3

      806     7586    2         CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE.BUFF.DAY);

   7586  2 002044   000000 470400 xsym               LDP0    B$XL_LOWER_UR$
         2 002045   040100 160500                    MVT     fill='040'O
         2 002046   201233 600003                    ADSC9   TMDATE+1,,AUTO           cn=3,n=3
         2 002047   201243 000006                    ADSC9   TBUF,,AUTO               cn=0,n=6
         2 002050   000000 000100                    ARG     0,,PR0

      807     7587    2         SUBSTR (TMDATE.BUFF.DAY, 1, 2) = SUBSTR (TBUF, 1, 2);

   7587  2 002051   040100 100500                    MLR     fill='040'O
         2 002052   201243 200002                    ADSC9   TBUF,,AUTO               cn=1,n=2
         2 002053   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 002054   202262 220100                    LDX0    FIELD2+12,,AUTO
         2 002055   201234 740100                    STX0    TMDATE+2,,AUTO

      808     7588
      809     7589    2         TMDATE.BUFF.DATE = AL$LLT_TSTAMP.DATE ;

   7589  2 002056   040100 100500                    MLR     fill='040'O
         2 002057   201131 400012                    ADSC9   AL$LLT_TSTAMP+4,,AUTO    cn=2,n=10
         2 002060   201234 600012                    ADSC9   TMDATE+2,,AUTO           cn=3,n=10

      810     7590    2         CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE. BUFF.DATE);

   7590  2 002061   040100 160500                    MVT     fill='040'O
         2 002062   201234 600012                    ADSC9   TMDATE+2,,AUTO           cn=3,n=10
         2 002063   201243 000006                    ADSC9   TBUF,,AUTO               cn=0,n=6
         2 002064   000000 000100                    ARG     0,,PR0

      811     7591    2         SUBSTR (TMDATE.BUFF.DATE, 1, 2) = SUBSTR (TBUF, 1, 2);

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:120  
   7591  2 002065   040100 100500                    MLR     fill='040'O
         2 002066   201243 200002                    ADSC9   TBUF,,AUTO               cn=1,n=2
         2 002067   202262 000004                    ADSC9   FIELD2+12,,AUTO          cn=0,n=4
         2 002070   202262 221100                    LDX1    FIELD2+12,,AUTO
         2 002071   201235 741100                    STX1    TMDATE+3,,AUTO

      812     7592
      813     7593    2         TMDATE.CNT = 20;

   7593  2 002072   024000 236003                    LDQ     10240,DU
         2 002073   201232 552140                    STBQ    TMDATE,'40'O,AUTO

      814     7594                                                                  /**/
      815     7595    2         FPT_CMDVAR = CFPT_CMDVAR;

   7595  2 002074   000100 100400                    MLR     fill='000'O
         2 002075   001252 000070 1                  ADSC9   CFPT_CMDVAR              cn=0,n=56
         2 002076   201246 000070                    ADSC9   FPT_CMDVAR,,AUTO         cn=0,n=56

      816     7596    2         FPT_CMDVAR.V_ = VECTOR(FPT_CMDVAR.V);

   7596  2 002077   000010 235000 3                  LDA     8
         2 002100   202262 452500                    STP2    FIELD2+12,,AUTO
         2 002101   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 002102   001262 036003                    ADLQ    690,DU
         2 002103   201246 757100                    STAQ    FPT_CMDVAR,,AUTO

      817     7597    2         FPT_CMDVAR.NAME_ = VECTOR(LLT_VLP);

   7597  2 002104   000034 237000 3                  LDAQ    28
         2 002105   201250 757100                    STAQ    FPT_CMDVAR+2,,AUTO

      818     7598    2         FPT_CMDVAR.VALUE_ = VECTOR(TMDATE);

   7598  2 002106   000001 235000 3                  LDA     1
         2 002107   202262 452500                    STP2    FIELD2+12,,AUTO
         2 002110   202262 236100                    LDQ     FIELD2+12,,AUTO
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:121  
         2 002111   001232 036003                    ADLQ    666,DU
         2 002112   201252 757100                    STAQ    FPT_CMDVAR+4,,AUTO

      819     7599
      820     7600    3         CALL M$CMDVAR (FPT_CMDVAR) WHENALTRETURN DO;

   7600  2 002113   201246 630500                    EPPR0   FPT_CMDVAR,,AUTO
         2 002114   420025 713400                    CLIMB   alt,+8213
         2 002115   402400 401760                    pmme    nvectors=6
         2 002116   002120 702000 2                  TSX2    s:7605
         2 002117   002120 710000 2                  TRA     s:7605

      821     7601    3             END;

      822     7602                                                              /* Setup Command variable
      823     7603                                                                 LOGON_FAILURE_COUNT
      824     7604                                                              */
      825     7605    2         CALL BINCHAR(BAD_CNT_CHAR, AS_USERS.LOGINS.BAD_LOGON_CNT(MODE-1));

   7605  2 002120   201074 235100                    LDA     MODE,,AUTO
         2 002121   000001 735000                    ALS     1
         2 002122   200766 235105                    LDA     AS_USERS+499,AL,AUTO
         2 002123   000044 773000                    LRL     36
         2 002124   202262 757100                    STAQ    FIELD2+12,,AUTO
         2 002125   000100 301500                    BTD
         2 002126   202262 000010                    NDSC9   FIELD2+12,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 002127   201227 030012                    NDSC9   BAD_CNT_CHAR,,AUTO       cn=0,s=nosgn,sf=0,n=10

      826     7606    3         CALL SEARCH (POS, I, B$SR_NON_ZERO, BAD_CNT_CHAR) WHENALTRETURN DO;

   7606  2 002130   000000 470400 xsym               LDP0    B$SR_NON_ZERO$
         2 002131   000000 164500                    TCT
         2 002132   201227 000012                    ADSC9   BAD_CNT_CHAR,,AUTO       cn=0,n=10
         2 002133   000000 000100                    ARG     0,,PR0
         2 002134   201226 000100                    ARG     POS,,AUTO
         2 002135   201226 235100                    LDA     POS,,AUTO
         2 002136   000033 771000                    ARL     27
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:122  
         2 002137   201225 755100                    STA     I,,AUTO
         2 002140   201226 551140                    STBA    POS,'40'O,AUTO
         2 002141   002143 606400 2                  TTN     s:7607
         2 002142   002145 710000 2                  TRA     s:7609

      827     7607    3             POS = 9;

   7607  2 002143   000011 235007                    LDA     9,DL
         2 002144   201226 755100                    STA     POS,,AUTO

      828     7608    3             END;

      829     7609    2         BAD_CNT_BUF.CNT = 10 - POS;

   7609  2 002145   000012 236007                    LDQ     10,DL
         2 002146   201226 136100                    SBLQ    POS,,AUTO
         2 002147   000033 736000                    QLS     27
         2 002150   201240 552140                    STBQ    BAD_CNT_BUF,'40'O,AUTO

      830     7610    2         BAD_CNT_BUF.TEXT = SUBSTR(BAD_CNT_CHAR, POS);

   7610  2 002151   201226 720100                    LXL0    POS,,AUTO
         2 002152   777765 620010                    EAX0    -11,X0
         2 002153   777777 660003                    ERX0    -1,DU
         2 002154   201226 235100                    LDA     POS,,AUTO
         2 002155   040100 100545                    MLR     fill='040'O
         2 002156   201227 000010                    ADSC9   BAD_CNT_CHAR,A,AUTO      cn=0,n=*X0
         2 002157   201240 200012                    ADSC9   BAD_CNT_BUF,,AUTO        cn=1,n=10

      831     7611                                                                  /**/
      832     7612    2         FPT_CMDVAR = CFPT_CMDVAR;

   7612  2 002160   000100 100400                    MLR     fill='000'O
         2 002161   001252 000070 1                  ADSC9   CFPT_CMDVAR              cn=0,n=56
         2 002162   201246 000070                    ADSC9   FPT_CMDVAR,,AUTO         cn=0,n=56

      833     7613    2         FPT_CMDVAR.V_ = VECTOR(FPT_CMDVAR.V);
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:123  

   7613  2 002163   000010 235000 3                  LDA     8
         2 002164   202262 452500                    STP2    FIELD2+12,,AUTO
         2 002165   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 002166   001262 036003                    ADLQ    690,DU
         2 002167   201246 757100                    STAQ    FPT_CMDVAR,,AUTO

      834     7614    2         FPT_CMDVAR.NAME_ = VECTOR(LFC_VLP);

   7614  2 002170   000036 237000 3                  LDAQ    30
         2 002171   201250 757100                    STAQ    FPT_CMDVAR+2,,AUTO

      835     7615    2         FPT_CMDVAR.VALUE_ = VECTOR(BAD_CNT_BUF);

   7615  2 002172   000033 235000 3                  LDA     27
         2 002173   202262 452500                    STP2    FIELD2+12,,AUTO
         2 002174   202262 236100                    LDQ     FIELD2+12,,AUTO
         2 002175   001240 036003                    ADLQ    672,DU
         2 002176   201252 757100                    STAQ    FPT_CMDVAR+4,,AUTO

      836     7616
      837     7617    3         CALL M$CMDVAR (FPT_CMDVAR) WHENALTRETURN DO;

   7617  2 002177   201246 630500                    EPPR0   FPT_CMDVAR,,AUTO
         2 002200   420025 713400                    CLIMB   alt,+8213
         2 002201   402400 401760                    pmme    nvectors=6
         2 002202   002204 702000 2                  TSX2    s:7621
         2 002203   002204 710000 2                  TRA     s:7621

      838     7618    3             END;

      839     7619                                                             /* Set fields in :USERS record
      840     7620                                                              */
      841     7621    2         AS_USERS.LAST_LOGON_TIME = BINBIT(B$JIT.LOGONTIME,36);

   7621  2 002204   000000 470400 xsym               LDP0    B$JIT$
         2 002205   000150 236100                    LDQ     104,,PR0
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:124  
         2 002206   200765 756100                    STQ     AS_USERS+498,,AUTO

      842     7622    2         AS_USERS.BAD_LOGON_CNT = 0;

   7622  2 002207   000000 220003                    LDX0    0,DU
         2 002210   200766 740100                    STX0    AS_USERS+499,,AUTO

      843     7623    2         AS_USERS.LOGINS.LAST_LOGON_TIME(MODE-1) = B$JIT.LOGONTIME;

   7623  2 002211   201074 235100                    LDA     MODE,,AUTO
         2 002212   000001 735000                    ALS     1
         2 002213   000000 621005                    EAX1    0,AL
         2 002214   000150 235100                    LDA     104,,PR0
         2 002215   200765 755111                    STA     AS_USERS+498,X1,AUTO

      844     7624    2         AS_USERS.LOGINS.BAD_LOGON_CNT(MODE-1) = 0;

   7624  2 002216   201074 235100                    LDA     MODE,,AUTO
         2 002217   000001 735000                    ALS     1
         2 002220   200766 450105                    STZ     AS_USERS+499,AL,AUTO

      845     7625
      846     7626    2         RETURN;

   7626  2 002221   201224 221300                    LDX1  ! FPT$READ_SUSMES+14,,AUTO
         2 002222   000001 702211                    TSX2  ! 1,X1

      847     7627
      848     7628    2   END   SET_LAST_LOGON_TIME;
      849     7629    1   END   ALA$LOGON ;

   7629  2 002223   000000 702200 xent               TSX2  ! X66_MARET
      850     7630        %EOD ;

PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:125  
--  Include file information  --

   JG_GHOSTS_C.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_MACROS_C.:E05TOU  is referenced.
   AL_MACROS_C.:E05TOU  is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   AL_SUBS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$LOGON.
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:126  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$LOGON

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1024-0-0/w STRC        r     1 ALA_E$ASUSER_ERR
  1033-0-0/w STRC        r     1 ALA_E$BLANK_ACCT_UNAME
  1025-0-0/w STRC        r     1 ALA_E$DSUSER_ERR        1030-0-0/w STRC        r     1 ALA_E$MAXC_EXCEEDED
  1032-0-0/w STRC        r     1 ALA_E$NO_MASTER         1031-0-0/w STRC        r     1 ALA_E$PMAXC_EXCEEDED
  1034-0-0/w STRC        r     1 ALA_E$SETUP_FORCED      1026-0-0/w STRC        r     1 ALA_E$USERS_FILE_ERR
  1027-0-0/w STRC        r     1 ALA_E$WRITE_S_ERR       1252-0-0/d STRC(504)   r     1 CFPT_CMDVAR
     1-0-0/w STRC(18576) r     1 DF_USERS                   0-0-0/w UBIN(18)    r     1 FCG
  1036-0-0/d STRC(504)   r     1 FPT_CPLOGOFF            1224-0-0/d STRC(360)   r     1 FPT_OCMSG
  1072-0-0/d STRC(2088)  r     1 FPT_OPEN_UC             1164-0-0/d STRC(360)   r     1 FPT_PROMPT_RESET
  1176-0-0/d STRC(360)   r     1 FPT_PROMPT_SUSYNDMES    1054-0-0/d STRC(504)   r     1 FPT_READ_SUSMES
  1236-0-0/d STRC(360)   r     1 FPT_TRAP                1210-0-0/d STRC(432)   r     1 FPT_WRITE_SUSMES
  1274-0-0/c STRC(180)   r     1 LFC_VLP                 1270-0-0/c STRC(144)   r     1 LLT_VLP
  1016-0-0/w STRC(189)   r     1 NO_MACCOUNT             1005-0-0/c CHAR(24)    r     1 SUSMES
  1013-0-0/c CHAR(10)    r     1 SUSYNDMES

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  1125-0-0/w STRC(252)   r     1 AL$LLT_TSTAMP           1116-0-0/w STRC(252)   r     1 AL$TSTAMP
  1113-0-0/c CHAR(8)     r     1 AL_ACCT                 1036-0-0/w UBIN        r     1 ARS
     3-0-0/w STRC(18576) r     1 AS_USERS                1240-0-0/c STRC(99)    r     1 BAD_CNT_BUF
  1227-0-0/c CHAR(10)    r     1 BAD_CNT_CHAR            1240-0-0/w UBIN        r     1 CNT
  1106-0-0/c CHAR(8)     r     1 CP_ACCT                 1134-0-0/w STRC(972)   r     1 CP_LIMREC
  1076-0-0/c STRC(288)   r     1 CP_NAME                 1110-0-0/c CHAR(8)     r     1 CP_PASSW
  1075-0-0/b BIT         r     1 CP_SLEAZE_SET           1053-0-0/w PTR         r     1 DCB$
  1225-0-0/w STRC(369)   r     1 ERR_BUF                 1112-0-0/b STRC        r     1 ERR_CODE
  2233-0-0/c STRC(369)   r     1 FIELD1                  2246-0-0/c STRC(369)   r     1 FIELD2
  1170-0-0/d STRC(504)   r     1 FPT$CPEXIT              1206-0-0/d STRC(504)   r     1 FPT$READ_SUSMES
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:127  
  1246-0-0/d STRC(504)   r     1 FPT_CMDVAR              1056-0-0/w UBIN        r     1 I
  1225-0-0/w UBIN        r     1 I                       1225-0-0/w UBIN        r     1 I
  1054-0-0/w PTR         r     1 KEY$                    1045-0-0/c STRC(189)   r     1 LIMIT_KEY
  1065-0-0/c STRC(189)   r     1 MASTER_ACCT             1226-0-0/w UBIN        r     1 MAX
  1074-0-0/w UBIN        r     1 MODE                    1064-0-0/w BIT         r     1 NOHEADER
  1063-0-0/w BIT         r     1 NOSETUP                 1226-0-0/w UBIN        r     1 POS
  1033-0-0/c CHAR(10)    r     1 SUSMES_ANS              1115-0-0/b BIT         r     1 SYS_GHOST
  1225-0-0/w STRC(18576) r     1 T$USERS                 1243-0-0/c CHAR(6)     r     1 TBUF
  2231-0-0/w SBIN        r     1 TEMP                    1062-0-0/w BIT         r     1 TEMP_BIT
  1055-0-0/w PTR         r     1 TEXT$                   1232-0-0/w STRC(189)   r     1 TMDATE
  1057-0-0/w SBIN        r     1 UMAX                    1037-0-0/c STRC(189)   r     1 USERS_KEY

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AL_BLANK                   0-0-0/w UBIN        r     1 AL_DCB2#
     0-0-0/b BIT         r     1 AL_FALSE                   0-0-0/b BIT         r     1 AL_TRUE
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$SR_NON_ZERO$
     0-0-0/w PTR         r     1 B$XL_LOWER_UR$             0-0-0/c CHAR(8)     r     1 DF_CP_ACCT
     0-0-0/c STRC(288)   r     1 DF_CP_NAME                 0-0-0/c CHAR(8)     r     1 DF_CP_PASS

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(4608)  r     1 B$SR_NON_ZERO
     0-0-0/d STRC(4608)  r     1 B$XL_LOWER_UR              0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$UC                       0-0-0/c ASTR(9)     r     1 TEXT$C


   Procedure ALA$LOGON requires 1172 words for executable code.
   Procedure ALA$LOGON requires 1208 words of local(AUTO) storage.
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:128  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:129  
          MINI XREF LISTING

AL$LLT_TSTAMP
      6233**DCL      7581<>CALL
AL$LLT_TSTAMP.DATE
      6237**DCL      7589>>ASSIGN
AL$LLT_TSTAMP.DAY
      6236**DCL      7585>>ASSIGN
AL$LLT_TSTAMP.TIME
      6235**DCL      7583>>ASSIGN
AL$LLT_TSTAMP.UTS
      6234**DCL      7580<<ASSIGN
AL$TSTAMP
      6224**DCL      6719<>CALL     6959<>CALL
AL$TSTAMP.UTS
      6225**DCL      6718<<ASSIGN   6950>>ASSIGN
ALA$BANNER2_STAR_S
      6679**DCL-ENT  6945--CALL
ALA$CLOSE_STAR
      6691**DCL-ENT  6913--CALL     6948--CALL
ALA$CPEXIT
      6684**DCL-ENT  6742--CALL     6805--CALL     6961--CALL     6975--CALL     6977--CALL     6989--CALL
      6991--CALL     7005--CALL     7007--CALL     7389--CALL     7391--CALL     7397--CALL
ALA$ERROR
      6685**DCL-ENT  6753--CALL     6760--CALL     6804--CALL     6971--CALL     7002--CALL     7223--CALL
      7247--CALL     7264--CALL     7316--CALL     7383--CALL
ALA$GETSTARS
      6692**DCL-ENT  6910--CALL
ALA$GETUSERS
      6682**DCL-ENT  6810--CALL
ALA$HEADING
      6687**DCL-ENT  6959--CALL
ALA$OPEN_STAR_A
      6689**DCL-ENT  6911--CALL
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:130  
ALA$OPEN_STAR_S
      6690**DCL-ENT  6915--CALL
ALA$OPEN_USERS
      6678**DCL-ENT  6811--CALL
ALA$READ_USERS
      6681**DCL-ENT  6812--CALL     7234--CALL
ALA$SYS_ERROR
      6697**DCL-ENT  6970--CALL     6982--CALL
ALA$TIME
      6688**DCL-ENT  6719--CALL     7581--CALL
ALA$TRAP
      6696**DCL-ENT  6662--DCLINIT  6662--DCLINIT  6663--DCLINIT  6663--DCLINIT
ALA$WRITE_STAR
      6693**DCL-ENT  6937--CALL
ALA$WRITE_USERS
      6694**DCL-ENT  6954--CALL
ALA$YESNOD
      6695**DCL-ENT  6736--CALL
ALA_E$ASUSER_ERR
      5508**DCL      6753<>CALL
ALA_E$BLANK_ACCT_UNAME
      5824**DCL      6804<>CALL
ALA_E$DSUSER_ERR
      5553**DCL      6760<>CALL
ALA_E$MAXC_EXCEEDED
      5688**DCL      7223<>CALL
ALA_E$NO_MASTER
      5778**DCL      7264<>CALL
ALA_E$PMAXC_EXCEEDED
      5733**DCL      7247<>CALL
ALA_E$SETUP_FORCED
      5870**DCL      7316<>CALL
ALA_E$USERS_FILE_ERR
      5598**DCL      6971<>CALL
ALA_E$WRITE_S_ERR
      5643**DCL      7002<>CALL
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:131  
AL_ACCT
      6217**DCL      6715<<ASSIGN   6911<>CALL     6915<>CALL
AL_BLANK
      5196**DCL      6733>>ASSIGN   6800>>IF       6807>>CALLBLT  7242>>CALLBLT  7352>>CALLBLT  7582>>ASSIGN
AL_DCB2#
      5211**DCL      6937<>CALL     6945<>CALL
AL_FALSE
      5198**DCL      6780>>ASSIGN   6784>>ASSIGN
AL_TRUE
      5197**DCL      6778>>ASSIGN   6788>>ASSIGN
ARS
      6097**DCL      6735<<ASSIGN   6736<>CALL     6935<<ASSIGN   6937<>CALL
ASUSER_ALT
      6740**LABEL    6741--CALLALT
AS_USERS
      5930**DCL      6789<<ASSIGN   6812<>CALL     6944--ASSIGN   6954<>CALL     7231>>ASSIGN
AS_USERS.BAD_LOGON_CNT
      6072**DCL      7622<<ASSIGN
AS_USERS.BANNER_PERM
      6045**DCL      6046--REDEF
AS_USERS.BILL
      5969**DCL      6956>>ASSIGN
AS_USERS.BUDGET.ACCUM
      5940**DCL      7217>>ASSIGN
AS_USERS.BUDGET.BKACC
      5957**DCL      7218>>IF
AS_USERS.BUDGET.BLINDACCTNG
      5961**DCL      6840>>ASSIGN
AS_USERS.BUDGET.BUDLIM
      5958**DCL      7226>>IF       7250>>IF       7254>>IF
AS_USERS.BUDGET.ICHARGES
      5960**DCL      7215>>IF
AS_USERS.BUDGET.MACCT
      5950**DCL      5954--REDEF    7232>>ASSIGN
AS_USERS.BUDGET.MAXC
      5939**DCL      7215>>IF       7217>>ASSIGN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:132  
AS_USERS.BUDGET.MAX_PROJECTS
      5963**DCL      5966--REDEF
AS_USERS.BUDGET.PACCUM
      5946**DCL      5948--REDEF
AS_USERS.BUDGET.PMAXC
      5941**DCL      5943--REDEF
AS_USERS.CPROC.NAME
      5999**DCL      7275>>ASSIGN
AS_USERS.CPROC.NAME.CNT
      6000**DCL      7272>>IF
AS_USERS.DDO
      5982**DCL      6853>>ASSIGN
AS_USERS.DEXP
      6019**DCL      6863>>ASSIGN
AS_USERS.DFPOOLS
      5990**DCL      6862>>ASSIGN
AS_USERS.DLO
      5980**DCL      6849>>ASSIGN
AS_USERS.DMEM
      6030**DCL      6894>>ASSIGN
AS_USERS.DMPRIO
      5992**DCL      6866>>ASSIGN
AS_USERS.DPDIS
      5986**DCL      6865>>ASSIGN
AS_USERS.DPO
      5984**DCL      6857>>ASSIGN
AS_USERS.DTDIS
      5988**DCL      6861>>ASSIGN
AS_USERS.DTIME
      6027**DCL      6893>>ASSIGN
AS_USERS.FLAGS.STARSACC
      6022**DCL      6873>>IF
AS_USERS.HPSN
      5995**DCL      6842>>ASSIGN
AS_USERS.KEY
      5970**DCL      6868>>ASSIGN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:133  
AS_USERS.LASTCPROC.NAME.CNT
      6005**DCL      6846>>IF
AS_USERS.LAST_LOGON_TIME
      6070**DCL      7621<<ASSIGN
AS_USERS.LOGINS.BAD_LOGON_CNT
      6080**DCL      7605>>CALLBLT  7624<<ASSIGN
AS_USERS.LOGINS.LAST_LOGON_TIME
      6078**DCL      7580>>ASSIGN   7623<<ASSIGN
AS_USERS.MAXENQ
      6085**DCL      6832>>IF       6832>>ASSIGN
AS_USERS.MDO
      5981**DCL      6854>>IF       6924>>ASSIGN
AS_USERS.MEXP
      6018**DCL      6864>>ASSIGN
AS_USERS.MFPOOLS
      5989**DCL      6930>>ASSIGN
AS_USERS.MLO
      5979**DCL      6850>>IF       6920>>ASSIGN
AS_USERS.MMEM
      6029**DCL      6918>>ASSIGN
AS_USERS.MMPRIO
      5991**DCL      6867>>ASSIGN
AS_USERS.MPDIS
      5985**DCL      6928>>ASSIGN
AS_USERS.MPO
      5983**DCL      6858>>IF       6922>>ASSIGN
AS_USERS.MTDIS
      5987**DCL      6926>>ASSIGN
AS_USERS.NAT_LANG
      5933**DCL      6877>>ASSIGN
AS_USERS.OUTPUTPRIO
      5972**DCL      6878>>ASSIGN
AS_USERS.PPRIV
      6009**DCL      6829>>ASSIGN
AS_USERS.PRIOB
      6017**DCL      6830>>ASSIGN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:134  
AS_USERS.PRIV
      6008**DCL      6821>>ASSIGN
AS_USERS.QUAN
      6015**DCL      6831>>ASSIGN
AS_USERS.RESL.BMAX
      6040**DCL      7423>>ASSIGN
AS_USERS.RESL.GMAX
      6041**DCL      7425>>ASSIGN
AS_USERS.RESL.OMAX
      6042**DCL      6896>>DOCASE   7421>>ASSIGN
AS_USERS.RESL.RNAME
      6039**DCL      7416>>IF
AS_USERS.RESL.TMAX
      6043**DCL      7427>>ASSIGN
AS_USERS.SETUP
      6057**DCL      7293>>IF       7300>>ASSIGN
AS_USERS.SETUP_CHRA.TXT
      6061**DCL      6062--REDEF    6063--REDEF    7300--ASSIGN
AS_USERS.SETUP_FORCE
      6047**DCL      7307>>IF
AS_USERS.STEPACCNT
      5934**DCL      6869>>IF
AS_USERS.TOT_TYPES
      6037**DCL      7415>>DOINDEX
B$JIT.ACCN
      3368**DCL      6715>>ASSIGN   6799>>CALLBLT
B$JIT.BILL
      3516**DCL      6956<<ASSIGN
B$JIT.BLINDACCTNG
      3516**DCL      6782>>ASSIGN   6840<<ASSIGN   6957>>ASSIGN   6958<<ASSIGN   6960<<ASSIGN
B$JIT.BUDLIM
      3505**DCL      7213<<ASSIGN   7254<<ASSIGN
B$JIT.CCARS
      3456**DCL      7301<<ASSIGN
B$JIT.CCBUF
      3456**DCL      7303<<ASSIGN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:135  
B$JIT.CCDISP
      3456**DCL      7302<<ASSIGN
B$JIT.CLRES
      3635**DCL      7414<<ASSIGN   7431<<ASSIGN   7435<<ASSIGN   7436<<ASSIGN   7440<<ASSIGN
B$JIT.CPFLAGS1
      3457**DCL      6765<<ASSIGN   6765>>ASSIGN   6785>>IF       6787<<ASSIGN   6787>>ASSIGN   6820<<ASSIGN
      6820>>ASSIGN   6843>>IF       6847<<ASSIGN   6847>>ASSIGN   6871<<ASSIGN   6871>>ASSIGN   6874<<ASSIGN
      6874>>ASSIGN   6942>>IF       7296<<ASSIGN   7296>>ASSIGN   7304<<ASSIGN   7304>>ASSIGN   7319<<ASSIGN
      7319>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      3462**DCL      3462--REDEF
B$JIT.CSLEV
      3523**DCL      6834<<ASSIGN
B$JIT.DEFEXP
      3536**DCL      6863<<ASSIGN
B$JIT.DEFPRI
      3516**DCL      6866<<ASSIGN
B$JIT.ERR.MID
      3369**DCL      3369--REDEF
B$JIT.FBUL
      3528**DCL      6862<<ASSIGN   6931>>ASSIGN
B$JIT.HPSN
      3536**DCL      6842<<ASSIGN
B$JIT.JRESPEAK
      3530**DCL      3531--REDEF
B$JIT.JSLEV
      3505**DCL      6795<<ASSIGN   6881<<ASSIGN   6887<<ASSIGN   6889<<ASSIGN   6891<<ASSIGN
B$JIT.LANG
      3504**DCL      6877<<ASSIGN
B$JIT.LOCK
      3517**DCL      6783>>ASSIGN   6868<<ASSIGN
B$JIT.LOGONTIME
      3505**DCL      6718>>ASSIGN   6950<<ASSIGN   7621>>ASSIGN   7623>>ASSIGN
B$JIT.MAXCORE
      3529**DCL      6894<<ASSIGN   6895>>ASSIGN   6919>>ASSIGN
B$JIT.MAXENQ
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:136  
      3641**DCL      6832<<ASSIGN
B$JIT.MAXEXP
      3536**DCL      6864<<ASSIGN
B$JIT.MAXPRI
      3516**DCL      6867<<ASSIGN
B$JIT.MAXTMPDP
      3537**DCL      6861<<ASSIGN   6927>>ASSIGN
B$JIT.MODE
      3363**DCL      6714>>ASSIGN
B$JIT.MRT
      3542**DCL      6893<<ASSIGN   6932>>ASSIGN   6933>>ASSIGN
B$JIT.NODOEVER
      3635**DCL      6855<<ASSIGN   6856<<ASSIGN
B$JIT.NOLOEVER
      3635**DCL      6851<<ASSIGN   6852<<ASSIGN
B$JIT.NOPOEVER
      3635**DCL      6859<<ASSIGN   6860<<ASSIGN
B$JIT.OLTA
      3636**DCL      6882<<ASSIGN   6898<<ASSIGN   6900<<ASSIGN   6902<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
      3639**DCL      3639--REDEF    3640--REDEF
B$JIT.OUTPRIO
      3449**DCL      6878<<ASSIGN
B$JIT.PNR
      3543**DCL      3543--REDEF
B$JIT.PPRIV
      3424**DCL      6829<<ASSIGN
B$JIT.PRDPRM
      3537**DCL      6865<<ASSIGN   6929>>ASSIGN
B$JIT.PRIOB
      3541**DCL      6830<<ASSIGN
B$JIT.PRIV.ACTIVE
      3369**DCL      6825<<ASSIGN
B$JIT.PRIV.AUTH
      3409**DCL      6821<<ASSIGN   6823<<ASSIGN   6823>>ASSIGN
B$JIT.PRIV.JOB
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:137  
      3412**DCL      6826<<ASSIGN
B$JIT.PRIV.PRC
      3416**DCL      6827<<ASSIGN
B$JIT.PSLEV
      3505**DCL      6794<<ASSIGN   6876<<ASSIGN
B$JIT.QUAN
      3541**DCL      6831<<ASSIGN
B$JIT.REMCPO
      3641**DCL      6857<<ASSIGN   6923>>ASSIGN
B$JIT.REMDO
      3641**DCL      6853<<ASSIGN   6925>>ASSIGN
B$JIT.REMLO
      3641**DCL      6849<<ASSIGN   6921>>ASSIGN
B$JIT.RESCORE
      3637**DCL      6895<<ASSIGN
B$JIT.SSLEV
      3505**DCL      6793<<ASSIGN   6875<<ASSIGN
B$JIT.TSLINE
      3637**DCL      3638--REDEF
B$JIT.UNAME
      3368**DCL      6799>>CALLBLT  6807>>CALLBLT
B$JIT.USER
      3368**DCL      6776>>IF
B$JIT.USRERR.CODE
      3504**DCL      6771>>IF
B$JIT$
      5212**DCL      3363--IMP-PTR  6714>>ASSIGN   6715>>ASSIGN   6718>>ASSIGN   6765>>ASSIGN   6765>>ASSIGN
      6771>>IF       6776>>IF       6782>>ASSIGN   6783>>ASSIGN   6785>>IF       6787>>ASSIGN   6787>>ASSIGN
      6793>>ASSIGN   6794>>ASSIGN   6795>>ASSIGN   6799>>CALLBLT  6799>>CALLBLT  6807>>CALLBLT  6820>>ASSIGN
      6820>>ASSIGN   6821>>ASSIGN   6823>>ASSIGN   6823>>ASSIGN   6825>>ASSIGN   6826>>ASSIGN   6827>>ASSIGN
      6829>>ASSIGN   6830>>ASSIGN   6831>>ASSIGN   6832>>ASSIGN   6834>>ASSIGN   6840>>ASSIGN   6842>>ASSIGN
      6843>>IF       6847>>ASSIGN   6847>>ASSIGN   6849>>ASSIGN   6851>>ASSIGN   6852>>ASSIGN   6853>>ASSIGN
      6855>>ASSIGN   6856>>ASSIGN   6857>>ASSIGN   6859>>ASSIGN   6860>>ASSIGN   6861>>ASSIGN   6862>>ASSIGN
      6863>>ASSIGN   6864>>ASSIGN   6865>>ASSIGN   6866>>ASSIGN   6867>>ASSIGN   6868>>ASSIGN   6871>>ASSIGN
      6871>>ASSIGN   6874>>ASSIGN   6874>>ASSIGN   6875>>ASSIGN   6876>>ASSIGN   6877>>ASSIGN   6878>>ASSIGN
      6881>>ASSIGN   6882>>ASSIGN   6887>>ASSIGN   6889>>ASSIGN   6891>>ASSIGN   6893>>ASSIGN   6894>>ASSIGN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:138  
      6895>>ASSIGN   6895>>ASSIGN   6898>>ASSIGN   6900>>ASSIGN   6902>>ASSIGN   6919>>ASSIGN   6921>>ASSIGN
      6923>>ASSIGN   6925>>ASSIGN   6927>>ASSIGN   6929>>ASSIGN   6931>>ASSIGN   6932>>ASSIGN   6933>>ASSIGN
      6942>>IF       6950>>ASSIGN   6956>>ASSIGN   6957>>ASSIGN   6958>>ASSIGN   6960>>ASSIGN   7213>>ASSIGN
      7254>>ASSIGN   7296>>ASSIGN   7296>>ASSIGN   7301>>ASSIGN   7302>>ASSIGN   7303>>ASSIGN   7304>>ASSIGN
      7304>>ASSIGN   7319>>ASSIGN   7319>>ASSIGN   7414>>ASSIGN   7431>>ASSIGN   7435>>ASSIGN   7436>>ASSIGN
      7440>>ASSIGN   7621>>ASSIGN   7623>>ASSIGN
B$SR_NON_ZERO
      5909**DCL      7606>>CALLBLT
B$SR_NON_ZERO$
      5908**DCL      5909--IMP-PTR  7606>>CALLBLT
B$XL_LOWER_UR
      5905**DCL      7586>>CALLBLT  7590>>CALLBLT
B$XL_LOWER_UR$
      5904**DCL      5905--IMP-PTR  7586>>CALLBLT  7590>>CALLBLT
BAD_CNT_BUF IN PROCEDURE SET_LAST_LOGON_TIME
      7466**DCL      7615--ASSIGN
BAD_CNT_BUF.CNT IN PROCEDURE SET_LAST_LOGON_TIME
      7467**DCL      7609<<ASSIGN
BAD_CNT_BUF.TEXT IN PROCEDURE SET_LAST_LOGON_TIME
      7468**DCL      7610<<ASSIGN
BAD_CNT_CHAR IN PROCEDURE SET_LAST_LOGON_TIME
      7456**DCL      7605<<CALLBLT  7606>>CALLBLT  7610>>ASSIGN
BUDGET
      7009**PROC     6836--CALL
BUDGET_ERR
      6973**LABEL    6836--CALLALT
CFPT_CMDVAR IN PROCEDURE SET_LAST_LOGON_TIME
      7488**DCL      7595>>ASSIGN   7612>>ASSIGN
CFPT_CMDVAR.V IN PROCEDURE SET_LAST_LOGON_TIME
      7490**DCL      7488--DCLINIT
CLOSE_A_ERR
      6994**LABEL    6913--CALLALT
CLOSE_A_OK
      6909**LABEL    6994--GOTO
CLOSE_S_ERR
      6996**LABEL    6948--CALLALT
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:139  
CLOSE_S_OK
      6942**LABEL    6996--GOTO
CLRES
      7401**PROC     6906--CALL
CNT IN PROCEDURE CP_NO_EXISTS
      7339**DCL      7352<<CALLBLT  7354>>ASSIGN
CPROC
      7270**PROC     6844--CALL
CP_ACCT
      6211**DCL      6768--ASSIGN   6791<<ASSIGN   7276<<ASSIGN   7282<<ASSIGN   7348<<ASSIGN   7352>>CALLBLT
      7356>>CALLBLT  7359>>IF       7395<<ASSIGN
CP_LIMREC
      6241**DCL      6917<<ASSIGN   6935--ASSIGN   6936--ASSIGN
CP_LIMREC.CUR_MAX.FBUL
      6254**DCL      6931<<ASSIGN
CP_LIMREC.CUR_MAX.MAXCORE
      6253**DCL      6919<<ASSIGN
CP_LIMREC.CUR_MAX.MAXTMPDP
      6259**DCL      6927<<ASSIGN
CP_LIMREC.CUR_MAX.MRT
      6260**DCL      6933<<ASSIGN
CP_LIMREC.CUR_MAX.PRDPRM
      6258**DCL      6929<<ASSIGN
CP_LIMREC.CUR_MAX.REMCPO
      6256**DCL      6923<<ASSIGN
CP_LIMREC.CUR_MAX.REMDO
      6257**DCL      6925<<ASSIGN
CP_LIMREC.CUR_MAX.REMLO
      6255**DCL      6921<<ASSIGN
CP_LIMREC.USER_MAX.FBUL
      6244**DCL      6930<<ASSIGN
CP_LIMREC.USER_MAX.MAXCORE
      6243**DCL      6918<<ASSIGN
CP_LIMREC.USER_MAX.MAXTMPDP
      6249**DCL      6926<<ASSIGN
CP_LIMREC.USER_MAX.MRT
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:140  
      6250**DCL      6932<<ASSIGN
CP_LIMREC.USER_MAX.PRDPRM
      6248**DCL      6928<<ASSIGN
CP_LIMREC.USER_MAX.REMCPO
      6246**DCL      6922<<ASSIGN
CP_LIMREC.USER_MAX.REMDO
      6247**DCL      6924<<ASSIGN
CP_LIMREC.USER_MAX.REMLO
      6245**DCL      6920<<ASSIGN
CP_NAME
      6209**DCL      6767--ASSIGN   6790<<ASSIGN   7275<<ASSIGN   7281<<ASSIGN   7347<<ASSIGN   7359>>IF
      7394<<ASSIGN
CP_NAME.L#
      6209**DCL      7354>>ASSIGN   7356>>CALLBLT
CP_NAME.NAME#
      6209**DCL      7350>>ASSIGN
CP_NO_EXISTS
      7329**PROC     6773--CALL
CP_PASSW
      6212**DCL      6769--ASSIGN   6792<<ASSIGN   7277<<ASSIGN   7283<<ASSIGN   7396<<ASSIGN
CP_SLEAZE_SET
      6124**DCL      6784<<ASSIGN   6788<<ASSIGN   6951>>IF
DCB$
      6108**DCL      6713<<ASSIGN   6723>>IF       6735>>ASSIGN
DF_CP_ACCT
      5204**DCL      6791>>ASSIGN   7359>>IF       7395>>ASSIGN
DF_CP_NAME
      5200**DCL      6790>>ASSIGN   7281>>ASSIGN   7359>>IF       7394>>ASSIGN
DF_CP_PASS
      5206**DCL      6792>>ASSIGN   7396>>ASSIGN
DF_USERS
      5325**DCL      6789>>ASSIGN
DF_USERS.BANNER_PERM
      5440**DCL      5441--REDEF
DF_USERS.BUDGET.MACCT
      5345**DCL      5349--REDEF
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:141  
DF_USERS.BUDGET.MAX_PROJECTS
      5358**DCL      5361--REDEF
DF_USERS.BUDGET.PACCUM
      5341**DCL      5343--REDEF
DF_USERS.BUDGET.PMAXC
      5336**DCL      5338--REDEF
DF_USERS.SETUP_CHRA.TXT
      5456**DCL      5457--REDEF    5458--REDEF
DO_STARS
      6909**LABEL    6796--GOTO
DSUSER_ALT
      6756**LABEL    6747--CALLALT
ERR_BUF.CNT IN PROCEDURE CP_NO_EXISTS
      7337**DCL      7354<<ASSIGN   7383<>CALL
ERR_BUF.TEXT IN PROCEDURE CP_NO_EXISTS
      7338**DCL      7350<<ASSIGN   7356<<CALLBLT
ERR_CODE
      6213**DCL      6937<>CALL     6945<>CALL     7383<>CALL
ERR_CODE.CODE
      6215**DCL      7362<<ASSIGN   7367<<ASSIGN   7385>>IF
ERR_CODE.FCG_MID
      6214**DCL      7370<<ASSIGN
ERR_CODE.SEV
      6216**DCL      7363<<ASSIGN   7368<<ASSIGN
F$DCB.ACCT#
      6142**DCL      7348>>ASSIGN
F$DCB.ACTPOS
      6158**DCL      6158--REDEF
F$DCB.ARS#
      6132**DCL      6132--REDEF    6735>>ASSIGN
F$DCB.ASN#
      6147**DCL      6723>>IF
F$DCB.ATTR
      6151**DCL      6152--REDEF
F$DCB.BORROW
      6166**DCL      6166--REDEF    6166--REDEF    6166--REDEF
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:142  
F$DCB.DCBNAME.L
      6180**DCL      6180--IMP-SIZ
F$DCB.EOMCHAR#
      6136**DCL      6136--REDEF
F$DCB.FLDID
      6161**DCL      6161--REDEF
F$DCB.FORM$
      6155**DCL      6155--REDEF
F$DCB.FSECT
      6171**DCL      6171--REDEF
F$DCB.FSN#
      6148**DCL      6148--REDEF    6148--REDEF    6149--REDEF
F$DCB.HEADER$
      6154**DCL      6154--REDEF
F$DCB.IXTNSIZE#
      6152**DCL      6152--REDEF
F$DCB.LASTSTA$
      6141**DCL      6141--REDEF
F$DCB.LVL
      6167**DCL      6167--REDEF
F$DCB.NAME#
      6142**DCL      7347>>ASSIGN
F$DCB.NAME#.C
      6142**DCL      6142--REDEF
F$DCB.NOEOF
      6164**DCL      6164--REDEF
F$DCB.NRECS#
      6153**DCL      6153--REDEF
F$DCB.NRECX
      6172**DCL      6172--REDEF
F$DCB.OHDR
      6164**DCL      6164--REDEF
F$DCB.ORG#
      6147**DCL      6147--REDEF
F$DCB.PRECNO
      6170**DCL      6170--REDEF
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:143  
F$DCB.RCSZ
      6176**DCL      6176--REDEF
F$DCB.RES#
      6143**DCL      6143--REDEF
F$DCB.SETX
      6155**DCL      6155--REDEF
F$DCB.TAB$
      6155**DCL      6155--REDEF
F$DCB.TDA
      6169**DCL      6170--REDEF
F$DCB.WSN#
      6143**DCL      6143--REDEF
FCG
      5309**DCL      7370>>ASSIGN
FIELD1 IN PROCEDURE BUDGET
      7202**DCL      7247<>CALL
FIELD1.CNT IN PROCEDURE BUDGET
      7203**DCL      7243<<ASSIGN
FIELD1.TXT IN PROCEDURE BUDGET
      7204**DCL      7244<<ASSIGN
FIELD2 IN PROCEDURE BUDGET
      7205**DCL      7247<>CALL
FIELD2.CNT IN PROCEDURE BUDGET
      7206**DCL      7245<<ASSIGN
FIELD2.TXT IN PROCEDURE BUDGET
      7207**DCL      7246<<ASSIGN
FPT$CPEXIT
      6299**DCL      6766<<ASSIGN   6961<>CALL     6975<>CALL     6989<>CALL     7005<>CALL     7389<>CALL
      7397<>CALL
FPT$CPEXIT.ACCT_
      6301**DCL      6768<<ASSIGN
FPT$CPEXIT.NAME_
      6301**DCL      6767<<ASSIGN
FPT$CPEXIT.PASS_
      6301**DCL      6769<<ASSIGN
FPT$CPEXIT.V
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:144  
      6302**DCL      6770--ASSIGN
FPT$CPEXIT.V_
      6302**DCL      6770<<ASSIGN
FPT$READ_SUSMES
      6398**DCL      6729<<ASSIGN   6734<>CALL
FPT$READ_SUSMES.BUF_
      6400**DCL      6731<<ASSIGN
FPT$READ_SUSMES.STATION_
      6401**DCL      6402--REDEF
FPT$READ_SUSMES.V
      6402**DCL      6730--ASSIGN
FPT$READ_SUSMES.V.DVBYTE.REREAD#
      6413**DCL      6413--REDEF
FPT$READ_SUSMES.V.INDX#
      6411**DCL      6411--REDEF
FPT$READ_SUSMES.V_
      6398**DCL      6730<<ASSIGN
FPT_CMDVAR IN PROCEDURE SET_LAST_LOGON_TIME
      7506**DCL      7595<<ASSIGN   7600<>CALL     7612<<ASSIGN   7617<>CALL
FPT_CMDVAR.NAME_ IN PROCEDURE SET_LAST_LOGON_TIME
      7506**DCL      7597<<ASSIGN   7614<<ASSIGN
FPT_CMDVAR.V IN PROCEDURE SET_LAST_LOGON_TIME
      7508**DCL      7596--ASSIGN   7613--ASSIGN
FPT_CMDVAR.VALUE_ IN PROCEDURE SET_LAST_LOGON_TIME
      7506**DCL      7598<<ASSIGN   7615<<ASSIGN
FPT_CMDVAR.V_ IN PROCEDURE SET_LAST_LOGON_TIME
      7506**DCL      7596<<ASSIGN   7613<<ASSIGN
FPT_CPLOGOFF
      6326**DCL      6766>>ASSIGN
FPT_CPLOGOFF.V
      6329**DCL      6329--DCLINIT
FPT_OCMSG
      6641**DCL      6984<>CALL
FPT_OCMSG.V
      6642**DCL      6641--DCLINIT
FPT_OPEN_UC
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:145  
      6487**DCL      6726<>CALL
FPT_OPEN_UC.ACSVEH_
      6489**DCL      6490--REDEF
FPT_OPEN_UC.ALTKEYS_
      6495**DCL      6496--REDEF    6496--REDEF
FPT_OPEN_UC.HDR_
      6494**DCL      6495--REDEF
FPT_OPEN_UC.TAB_
      6493**DCL      6494--REDEF
FPT_OPEN_UC.UHL_
      6487**DCL      6488--REDEF    6488--REDEF
FPT_OPEN_UC.V
      6496**DCL      6487--DCLINIT
FPT_OPEN_UC.V.FSN#
      6527**DCL      6527--REDEF    6527--REDEF
FPT_OPEN_UC.WSN_
      6493**DCL      6493--REDEF
FPT_PROMPT_RESET
      6547**DCL      6737<>CALL
FPT_PROMPT_RESET.V
      6555**DCL      6549--DCLINIT
FPT_PROMPT_SUSYNDMES
      6580**DCL      6728<>CALL
FPT_PROMPT_SUSYNDMES.V
      6588**DCL      6582--DCLINIT
FPT_READ_SUSMES
      6358**DCL      6729>>ASSIGN
FPT_READ_SUSMES.STATION_
      6361**DCL      6362--REDEF
FPT_READ_SUSMES.V
      6362**DCL      6358--DCLINIT
FPT_READ_SUSMES.V.DVBYTE.REREAD#
      6373**DCL      6373--REDEF
FPT_READ_SUSMES.V.INDX#
      6371**DCL      6371--REDEF
FPT_TRAP
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:146  
      6661**DCL      6716<>CALL
FPT_TRAP.V
      6661**DCL      6661--DCLINIT
FPT_WRITE_SUSMES
      6613**DCL      6727<>CALL
FPT_WRITE_SUSMES.STATION_
      6615**DCL      6615--REDEF
FPT_WRITE_SUSMES.V
      6616**DCL      6613--DCLINIT
FPT_WRITE_SUSMES.V.DVBYTE.VFC#
      6622**DCL      6622--REDEF
FREECMD
      7291**PROC     6843--CALL
I
      6111**DCL      6807<<CALLBLT  6808>>ASSIGN   7242<<CALLBLT  7243>>ASSIGN
I IN PROCEDURE CLRES
      7407**DCL      7415<<DOINDEX  7416>>IF       7421>>ASSIGN   7423>>ASSIGN   7425>>ASSIGN   7427>>ASSIGN
I IN PROCEDURE SET_LAST_LOGON_TIME
      7454**DCL      7606<<CALLBLT
KEY$
      6109**DCL      6944<<ASSIGN   6945<>CALL
LFC_VLP IN PROCEDURE SET_LAST_LOGON_TIME
      7570**DCL      7614--ASSIGN
LIMIT_KEY
      6101**DCL      6937<>CALL
LIMIT_KEY.CNT
      6102**DCL      6711<<ASSIGN
LIMIT_KEY.TEXT
      6103**DCL      6712<<ASSIGN
LLT_VLP IN PROCEDURE SET_LAST_LOGON_TIME
      7540**DCL      7597--ASSIGN
M$ASUSER
      3776**DCL-ENT  6741--CALL
M$CMDVAR
      3830**DCL-ENT  7600--CALL     7617--CALL
M$DSUSER
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:147  
      3776**DCL-ENT  6747--CALL
M$FSUSER
      3776**DCL-ENT  6725--CALL
M$OCMSG
      3825**DCL-ENT  6984--CALL
M$OPEN
      3761**DCL-ENT  6726--CALL
M$PROMPT
      3785**DCL-ENT  6728--CALL     6737--CALL
M$READ
      3762**DCL-ENT  6734--CALL
M$TRAP
      3815**DCL-ENT  6716--CALL
M$UC
      3785**DCL      6713--ASSIGN
M$WRITE
      3762**DCL-ENT  6727--CALL
MASTER_ACCT
      6118**DCL      7232<<ASSIGN   7233>>DOWHILE  7234<>CALL     7252<<ASSIGN
MASTER_ACCT.ACCT
      6120**DCL      7242>>CALLBLT  7244>>ASSIGN
MASTER_ACCT.CNT
      6119**DCL      7245>>ASSIGN
MASTER_ACCT.NAME
      6121**DCL      7246>>ASSIGN
MAX IN PROCEDURE CLRES
      7408**DCL      7421<<ASSIGN   7423<<ASSIGN   7425<<ASSIGN   7427<<ASSIGN   7429>>IF       7432>>IF
      7438>>IF
MODE
      6123**DCL      6714<<ASSIGN   6723>>IF       6821>>ASSIGN   6829>>ASSIGN   6830>>ASSIGN   6831>>ASSIGN
      6832>>IF       6832>>ASSIGN   6846>>IF       6849>>ASSIGN   6850>>IF       6853>>ASSIGN   6854>>IF
      6857>>ASSIGN   6858>>IF       6861>>ASSIGN   6862>>ASSIGN   6865>>ASSIGN   6866>>ASSIGN   6867>>ASSIGN
      6879>>IF       6885>>DOCASE   6893>>ASSIGN   6894>>ASSIGN   6918>>ASSIGN   6920>>ASSIGN   6922>>ASSIGN
      6924>>ASSIGN   6926>>ASSIGN   6928>>ASSIGN   6930>>ASSIGN   6956>>ASSIGN   7272>>IF       7275>>ASSIGN
      7293>>IF       7300>>ASSIGN   7307>>IF       7419>>DOCASE   7580>>ASSIGN   7605>>CALLBLT  7623>>ASSIGN
      7624>>ASSIGN
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:148  
NOHEADER
      6117**DCL      6783<<ASSIGN   6958>>ASSIGN
NOSETUP
      6116**DCL      6782<<ASSIGN   7305>>IF
NOT_SUSPENDED
      6763**LABEL    6725--CALLALT
NO_MACCOUNT
      5492**DCL      7233>>DOWHILE
OPEN_A_ERR
      6993**LABEL    6911--CALLALT
OPEN_A_OK
      6909**LABEL    6993--GOTO
OPEN_S_ERR
      6995**LABEL    6915--CALLALT
OPEN_S_OK
      6909**LABEL    6995--GOTO
OPEN_USERS_ERR
      6973**LABEL    6811--CALLALT
POS IN PROCEDURE SET_LAST_LOGON_TIME
      7455**DCL      7606<<CALLBLT  7607<<ASSIGN   7609>>ASSIGN   7610>>ASSIGN
READ_ERR_MESS
      6960**LABEL    6726--CALLALT
READ_USERS_ERR
      6960**LABEL    6812--CALLALT  6954--CALLALT
READ_USERS_ERR IN PROCEDURE BUDGET
      7264**LABEL    7234--CALLALT
SET_LAST_LOGON_TIME
      7448**PROC     6953--CALL
SUSMES
      5490**DCL      6614--DCLINIT  6615--DCLINIT
SUSMES_ANS
      6096**DCL      6731--ASSIGN   6733<<ASSIGN   6736<>CALL     6738>>IF       6745>>IF
SUSYNDMES
      5491**DCL      6586--DCLINIT
SYS_GHOST
      6218**DCL      6778<<ASSIGN   6780<<ASSIGN   6973>>IF       6987>>IF       7003>>IF       7387>>IF
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:149  
T$USERS IN PROCEDURE BUDGET
      7035**DCL      7231<<ASSIGN   7234<>CALL
T$USERS.BANNER_PERM IN PROCEDURE BUDGET
      7150**DCL      7151--REDEF
T$USERS.BUDGET.BKACC IN PROCEDURE BUDGET
      7062**DCL      7237>>IF
T$USERS.BUDGET.MACCT IN PROCEDURE BUDGET
      7055**DCL      7059--REDEF    7252>>ASSIGN
T$USERS.BUDGET.MAX_PROJECTS IN PROCEDURE BUDGET
      7068**DCL      7071--REDEF
T$USERS.BUDGET.PACCUM IN PROCEDURE BUDGET
      7051**DCL      7053--REDEF    7236>>ASSIGN
T$USERS.BUDGET.PCHARGES IN PROCEDURE BUDGET
      7064**DCL      7233>>DOWHILE
T$USERS.BUDGET.PMAXC IN PROCEDURE BUDGET
      7046**DCL      7048--REDEF    7235>>IF       7236>>ASSIGN
T$USERS.SETUP_CHRA.TXT IN PROCEDURE BUDGET
      7166**DCL      7167--REDEF    7168--REDEF
TBUF IN PROCEDURE SET_LAST_LOGON_TIME
      7469**DCL      7586<<CALLBLT  7587>>ASSIGN   7590<<CALLBLT  7591>>ASSIGN
TEMP IN PROCEDURE BUDGET
      7200**DCL      7217<<ASSIGN   7218>>IF       7226>>ASSIGN   7236<<ASSIGN   7237>>IF       7250>>ASSIGN
TEMP_BIT
      6115**DCL      6957<<ASSIGN   6960>>ASSIGN
TEXT$
      6110**DCL      6104--IMP-PTR  6936<<ASSIGN   6937<>CALL     7300<<ASSIGN   7301>>ASSIGN   7302>>ASSIGN
      7303>>ASSIGN   7303>>ASSIGN
TEXT$C.C
      6107**DCL      7303>>ASSIGN
TEXT$C.L
      6106**DCL      6107--IMP-SIZ  7301>>ASSIGN   7302>>ASSIGN   7303>>ASSIGN
TMDATE IN PROCEDURE SET_LAST_LOGON_TIME
      7457**DCL      7598--ASSIGN
TMDATE.BUFF IN PROCEDURE SET_LAST_LOGON_TIME
      7459**DCL      7465--REDEF
TMDATE.BUFF.DATE IN PROCEDURE SET_LAST_LOGON_TIME
PL6.E3A0      #001=ALA$LOGON File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:27 Page:150  
      7464**DCL      7589<<ASSIGN   7590>>CALLBLT  7591<<ASSIGN
TMDATE.BUFF.DAY IN PROCEDURE SET_LAST_LOGON_TIME
      7462**DCL      7585<<ASSIGN   7586>>CALLBLT  7587<<ASSIGN
TMDATE.BUFF.TIME IN PROCEDURE SET_LAST_LOGON_TIME
      7460**DCL      7583<<ASSIGN
TMDATE.CNT IN PROCEDURE SET_LAST_LOGON_TIME
      7458**DCL      7593<<ASSIGN
TMDATE.RDEF_BUFF IN PROCEDURE SET_LAST_LOGON_TIME
      7465**DCL      7582<<ASSIGN
UMAX
      6112**DCL      7214<<ASSIGN   7226<<ASSIGN   7226>>ASSIGN   7250<<ASSIGN   7250>>ASSIGN   7254>>ASSIGN
USERS_KEY
      6098**DCL      6812<>CALL     6954<>CALL
USERS_KEY.CNT
      6099**DCL      6808<<ASSIGN
USERS_KEY.TEXT
      6100**DCL      6799<<CALLBLT  6800>>IF
WRITE_STAR_S_ERR
      6987**LABEL    6937--CALLALT  6945--CALLALT
YESNOD_ALT
      6731**LABEL    6734--CALLALT  6736--CALLALT

PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:151  
      851        1        /*T***********************************************************/
      852        2        /*T*                                                         */
      853        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      854        4        /*T*                                                         */
      855        5        /*T***********************************************************/
      856        6        ALA$CPEXIT: PROC(FPT$CPEXIT) ;
      857        7                                                              /**/
      858        8        %INCLUDE CP_6;
      859       89        %INCLUDE CP_6_SUBS ;
      860      629        %INCLUDE B_ERRORS_C;
      861     1756        %INCLUDE AL_PERR_C;
      862     1778        %INCLUDE B$JIT;
      863     2068        %INCLUDE AL_LOGON_R;
      864     2100        %F$DCB(DCBN=F$DCB);
      865     2157        %B$TCB;
      866     2160        %B$ALT;
      867     2168    1   DCL 1 MEM_STR ALIGNED,
      868     2169    1         2 LEN UBIN BYTE UNAL,
      869     2170    1         2 STR CHAR(3);
      870     2171    1   DCL ALA$ERROR ENTRY(4);
      871     2172    1   DCL ALA$CLOSE_USERS ENTRY ALTRET ;
      872     2173    1   DCL ALA$RELUSERS ENTRY ALTRET ;
      873     2174    1   DCL ALA$RELSTARS ENTRY ALTRET ;
      874     2175    1   DCL ALA$CLOSE_HLP ENTRY ALTRET ;
      875     2176                                                              /**/
      876     2177        %FPT_CPEXIT(  FPTN = FPT$CPEXIT ,
      877     2178                      STCLASS=" ") ;
      878     2204        %FPT_CPEXIT(  FPTN = FPT_CPLOGOFF ,
      879     2205                      STCLASS = SYMREF);
      880     2231        %VLP_ERRCODE( FPTN=ALA_E$LESMEM_ERR, FCG='AL',MID='A',MON='0'B,
      881     2232                      ERR#=E$LESMEM_ERR, SEV=0, STCLASS=CONSTANT );
      882     2277        %VLP_ERRCODE( FPTN=ERRCODE, STCLASS=AUTO );
      883     2322                                                              /**/
      884     2323    1         IF DCBADDR( AL_DCB1# ) ~= ADDR( NIL )
      885     2324    1         THEN
      886     2325    2         DO ;                                    /*   DID GET DCB.   */
      887     2326    2             CALL ALA$CLOSE_USERS ;
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:152  
      888     2327    2             CALL ALA$RELUSERS ;                 /*    RELEASE M$USERS DCB.   */
      889     2328    2             END ;     /*   END THEN DO   */
      890     2329    1         IF DCBADDR( AL_DCB2# ) ~= ADDR( NIL )
      891     2330    1         THEN
      892     2331    1             CALL ALA$RELSTARS ;                 /*   RELEASE M$STARS DCB.   */
      893     2332    1         IF ADDR(FPT$CPEXIT)~=ADDR(NIL)
      894     2333    2         THEN DO;
      895     2334    2             CALL M$RACST ALTRET(RACST_ALT);
      896     2335    3             DO WHILE('0'B);
      897     2336    3   RACST_ALT:    ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
      898     2337    3                 IF ERRCODE.ERR#=%E$LESMEM
      899     2338    3                         AND (B$JIT.MODE=%M_INT#
      900     2339    3                         OR (B$JIT.MODE=%M_GHOST#
      901     2340    3                         AND DCBADDR(DCBNUM(M$UC))->F$DCB.ASN#~=%DEVICE#))
      902     2341    4                 THEN DO;
      903     2342    4                     MEM_STR.LEN = 3;
      904     2343    4                     CALL BINCHAR(MEM_STR.STR,B$JIT.MAXCORE);
      905     2344    4                     CALL ALA$ERROR( ALA_E$LESMEM_ERR, MEM_STR );
      906     2345        /*E* ERROR:   ALA-E$LESMEM_ERR-C
      907     2346             MESSAGE: Cannot reserve your memory - Running you with %U1K!
      908     2347        */
      909     2348    4                     END;
      910     2349    4                 ELSE DO;
      911     2350    4                     CALL ALA$ERROR( ERRCODE );
      912     2351    4                     CALL M$CPEXIT(FPT_CPLOGOFF);
      913     2352    4                     END;
      914     2353    3                 END;
      915     2354    2             CALL M$CPEXIT(FPT$CPEXIT);
      916     2355    2             END;
      917     2356    1         ELSE
      918     2357    1             CALL M$CPEXIT(FPT_CPLOGOFF);
      919     2358    1   END   ALA$CPEXIT ;
      920     2359        %EOD ;

PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:153  
--  Include file information  --

   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$CPEXIT.

   Procedure ALA$CPEXIT requires 88 words for executable code.
   Procedure ALA$CPEXIT requires 8 words of local(AUTO) storage.

PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:154  

 Object Unit name= ALA$CPEXIT                                 File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:29:08.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS      1      1  ALA$CPEXIT
    2   Proc  even  none    88    130  ALA$CPEXIT
    3  RoData even  none     2      2  ALA$CPEXIT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  ALA$CPEXIT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 ALA$CLOSE_USERS
 yes     yes           Std       0 ALA$RELUSERS
         yes           Std       4 ALA$ERROR
 yes     yes           Std       0 ALA$RELSTARS
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:155  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  AL_DCB1#                              AL_DCB2#
     B$JIT$                                B$TCB$                                FPT_CPLOGOFF
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ROSID                                 ISSID
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:156  


      851        1        /*T***********************************************************/
      852        2        /*T*                                                         */
      853        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      854        4        /*T*                                                         */
      855        5        /*T***********************************************************/
      856        6        ALA$CPEXIT: PROC(FPT$CPEXIT) ;

      6  2 000000   000000 700200 xent  ALA$CPEXIT   TSX0  ! X66_AUTO_1
         2 000001   000010 000001                    ZERO    8,1

      857        7                                                              /**/
      858        8        %INCLUDE CP_6;
      859       89        %INCLUDE CP_6_SUBS ;
      860      629        %INCLUDE B_ERRORS_C;
      861     1756        %INCLUDE AL_PERR_C;
      862     1778        %INCLUDE B$JIT;
      863     2068        %INCLUDE AL_LOGON_R;
      864     2100        %F$DCB(DCBN=F$DCB);
      865     2157        %B$TCB;
      866     2160        %B$ALT;
      867     2168    1   DCL 1 MEM_STR ALIGNED,
      868     2169    1         2 LEN UBIN BYTE UNAL,
      869     2170    1         2 STR CHAR(3);
      870     2171    1   DCL ALA$ERROR ENTRY(4);
      871     2172    1   DCL ALA$CLOSE_USERS ENTRY ALTRET ;
      872     2173    1   DCL ALA$RELUSERS ENTRY ALTRET ;
      873     2174    1   DCL ALA$RELSTARS ENTRY ALTRET ;
      874     2175    1   DCL ALA$CLOSE_HLP ENTRY ALTRET ;
      875     2176                                                              /**/
      876     2177        %FPT_CPEXIT(  FPTN = FPT$CPEXIT ,
      877     2178                      STCLASS=" ") ;
      878     2204        %FPT_CPEXIT(  FPTN = FPT_CPLOGOFF ,
      879     2205                      STCLASS = SYMREF);
      880     2231        %VLP_ERRCODE( FPTN=ALA_E$LESMEM_ERR, FCG='AL',MID='A',MON='0'B,
      881     2232                      ERR#=E$LESMEM_ERR, SEV=0, STCLASS=CONSTANT );
      882     2277        %VLP_ERRCODE( FPTN=ERRCODE, STCLASS=AUTO );
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:157  
      883     2322                                                              /**/
      884     2323    1         IF DCBADDR( AL_DCB1# ) ~= ADDR( NIL )

   2323  2 000002   000000 470400 3                  LDP0    0
         2 000003   000000 471500                    LDP1    0,,PR0
         2 000004   000000 720000 xsym               LXL0    AL_DCB1#
         2 000005   100000 236110                    LDQ     0,X0,PR1
         2 000006   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000007   000016 600000 2                  TZE     s:2329

      885     2324    1         THEN
      886     2325    2         DO ;                                    /*   DID GET DCB.   */

      887     2326    2             CALL ALA$CLOSE_USERS ;

   2326  2 000010   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000011   000000 701000 xent               TSX1    ALA$CLOSE_USERS
         2 000012   000000 011000                    NOP     0

      888     2327    2             CALL ALA$RELUSERS ;                 /*    RELEASE M$USERS DCB.   */

   2327  2 000013   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000014   000000 701000 xent               TSX1    ALA$RELUSERS
         2 000015   000000 011000                    NOP     0

      889     2328    2             END ;     /*   END THEN DO   */

      890     2329    1         IF DCBADDR( AL_DCB2# ) ~= ADDR( NIL )

   2329  2 000016   000000 470400 3                  LDP0    0
         2 000017   000000 471500                    LDP1    0,,PR0
         2 000020   000000 720000 xsym               LXL0    AL_DCB2#
         2 000021   100000 236110                    LDQ     0,X0,PR1
         2 000022   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000023   000027 600000 2                  TZE     s:2332

      891     2330    1         THEN
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:158  
      892     2331    1             CALL ALA$RELSTARS ;                 /*   RELEASE M$STARS DCB.   */

   2331  2 000024   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000025   000000 701000 xent               TSX1    ALA$RELSTARS
         2 000026   000000 011000                    NOP     0

      893     2332    1         IF ADDR(FPT$CPEXIT)~=ADDR(NIL)

   2332  2 000027   200003 236100                    LDQ     @FPT$CPEXIT,,AUTO
         2 000030   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 000031   000124 600000 2                  TZE     s:2357

      894     2333    2         THEN DO;

      895     2334    2             CALL M$RACST ALTRET(RACST_ALT);

   2334  2 000032   550005 713400                    CLIMB   alt,+53253
         2 000033   000000 401760                    pmme    nvectors=0
         2 000034   000036 702000 2                  TSX2    RACST_ALT

      896     2335    3             DO WHILE('0'B);

   2335  2 000035   000120 710000 2                  TRA     s:2354

      897     2336    3   RACST_ALT:    ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

   2336  2 000036   000000 470400 xsym  RACST_ALT    LDP0    B$TCB$
         2 000037   000000 471500                    LDP1    0,,PR0
         2 000040   100102 236100                    LDQ     66,,PR1
         2 000041   200005 756100                    STQ     ERRCODE,,AUTO

      898     2337    3                 IF ERRCODE.ERR#=%E$LESMEM

   2337  2 000042   200005 236100                    LDQ     ERRCODE,,AUTO
         2 000043   377770 376007                    ANQ     131064,DL
         2 000044   012340 116007                    CMPQ    5344,DL
         2 000045   000107 601000 2                  TNZ     s:2350
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:159  
         2 000046   000000 471400 xsym               LDP1    B$JIT$
         2 000047   100000 236100                    LDQ     0,,PR1
         2 000050   740000 376003                    ANQ     -16384,DU
         2 000051   140000 116003                    CMPQ    49152,DU
         2 000052   000065 600000 2                  TZE     s:2342
         2 000053   100000 116003                    CMPQ    32768,DU
         2 000054   000107 601000 2                  TNZ     s:2350
         2 000055   000000 236007 xsym               LDQ     M$UC,DL
         2 000056   000000 473400 3                  LDP3    0
         2 000057   300000 474500                    LDP4    0,,PR3
         2 000060   400000 475506                    LDP5    0,QL,PR4
         2 000061   500032 236100                    LDQ     26,,PR5
         2 000062   777000 376007                    ANQ     -512,DL
         2 000063   003000 116007                    CMPQ    1536,DL
         2 000064   000107 600000 2                  TZE     s:2350

      899     2338    3                         AND (B$JIT.MODE=%M_INT#
      900     2339    3                         OR (B$JIT.MODE=%M_GHOST#
      901     2340    3                         AND DCBADDR(DCBNUM(M$UC))->F$DCB.ASN#~=%DEVICE#))
      902     2341    4                 THEN DO;

      903     2342    4                     MEM_STR.LEN = 3;

   2342  2 000065   003000 236003                    LDQ     1536,DU
         2 000066   200004 552140                    STBQ    MEM_STR,'40'O,AUTO

      904     2343    4                     CALL BINCHAR(MEM_STR.STR,B$JIT.MAXCORE);

   2343  2 000067   100210 236100                    LDQ     136,,PR1
         2 000070   000022 772000                    QRL     18
         2 000071   000000 235003                    LDA     0,DU
         2 000072   200006 757100                    STAQ    ERRCODE+1,,AUTO
         2 000073   000100 301500                    BTD
         2 000074   200006 000010                    NDSC9   ERRCODE+1,,AUTO          cn=0,s=lsgnf,sf=0,n=8
         2 000075   200004 230003                    NDSC9   MEM_STR,,AUTO            cn=1,s=nosgn,sf=0,n=3

      905     2344    4                     CALL ALA$ERROR( ALA_E$LESMEM_ERR, MEM_STR );
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:160  

   2344  2 000076   200004 633500                    EPPR3   MEM_STR,,AUTO
         2 000077   200007 453500                    STP3    ERRCODE+2,,AUTO
         2 000100   000001 236000 3                  LDQ     1
         2 000101   200006 756100                    STQ     ERRCODE+1,,AUTO
         2 000102   200006 630500                    EPPR0   ERRCODE+1,,AUTO
         2 000103   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000104   000000 701000 xent               TSX1    ALA$ERROR
         2 000105   000000 011000                    NOP     0

      906     2345        /*E* ERROR:   ALA-E$LESMEM_ERR-C
      907     2346             MESSAGE: Cannot reserve your memory - Running you with %U1K!
      908     2347        */
      909     2348    4                     END;

   2348  2 000106   000120 710000 2                  TRA     s:2354

      910     2349    4                 ELSE DO;

      911     2350    4                     CALL ALA$ERROR( ERRCODE );

   2350  2 000107   200005 631500                    EPPR1   ERRCODE,,AUTO
         2 000110   200006 451500                    STP1    ERRCODE+1,,AUTO
         2 000111   200006 630500                    EPPR0   ERRCODE+1,,AUTO
         2 000112   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000113   000000 701000 xent               TSX1    ALA$ERROR
         2 000114   000000 011000                    NOP     0

      912     2351    4                     CALL M$CPEXIT(FPT_CPLOGOFF);

   2351  2 000115   000000 630400 xsym               EPPR0   FPT_CPLOGOFF
         2 000116   000012 713400                    CLIMB   10
         2 000117   402400 401760                    pmme    nvectors=6

      913     2352    4                     END;

      914     2353    3                 END;
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:161  

      915     2354    2             CALL M$CPEXIT(FPT$CPEXIT);

   2354  2 000120   200003 470500                    LDP0    @FPT$CPEXIT,,AUTO
         2 000121   000012 713400                    CLIMB   10
         2 000122   402400 401760                    pmme    nvectors=6

      916     2355    2             END;

   2355  2 000123   000127 710000 2                  TRA     s:2358

      917     2356    1         ELSE
      918     2357    1             CALL M$CPEXIT(FPT_CPLOGOFF);

   2357  2 000124   000000 630400 xsym               EPPR0   FPT_CPLOGOFF
         2 000125   000012 713400                    CLIMB   10
         2 000126   402400 401760                    pmme    nvectors=6

      919     2358    1   END   ALA$CPEXIT ;

   2358  2 000127   000000 702200 xent               TSX2  ! X66_ARET
      920     2359        %EOD ;

PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:162  
--  Include file information  --

   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$CPEXIT.
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:163  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$CPEXIT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC        r     1 ALA_E$LESMEM_ERR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPT$CPEXIT                5-0-0/w STRC        r     1 ERRCODE
    *0-0-0/d STRC(504)   r     1 FPT$CPEXIT                 4-0-0/w STRC        r     1 MEM_STR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AL_DCB1#                   0-0-0/w UBIN        r     1 AL_DCB2#
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/d STRC(504)   r     1 FPT_CPLOGOFF

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0N  NULL        r     1 M$UC

PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:164  

   Procedure ALA$CPEXIT requires 88 words for executable code.
   Procedure ALA$CPEXIT requires 8 words of local(AUTO) storage.
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:165  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:166  
          MINI XREF LISTING

ALA$CLOSE_USERS
      2172**DCL-ENT  2326--CALL
ALA$ERROR
      2171**DCL-ENT  2344--CALL     2350--CALL
ALA$RELSTARS
      2174**DCL-ENT  2331--CALL
ALA$RELUSERS
      2173**DCL-ENT  2327--CALL
ALA_E$LESMEM_ERR
      2244**DCL      2344<>CALL
AL_DCB1#
      2096**DCL      2323--IF
AL_DCB2#
      2097**DCL      2329--IF
B$ALT.CODE
      2162**DCL      2162--REDEF    2163--REDEF    2163--REDEF
B$ALT.ERR
      2163**DCL      2336>>ASSIGN
B$ALT.ERR.ERR#
      2164**DCL      2164--REDEF
B$ALT.EVID
      2163**DCL      2163--REDEF    2163--REDEF
B$JIT.CPFLAGS1.SLEAZE
      1886**DCL      1886--REDEF
B$JIT.ERR.MID
      1793**DCL      1793--REDEF
B$JIT.JRESPEAK
      1954**DCL      1955--REDEF
B$JIT.MAXCORE
      1953**DCL      2343>>CALLBLT
B$JIT.MODE
      1787**DCL      2337>>IF       2337>>IF
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:167  
B$JIT.ORIGINATOR_PORT.FROM_CR
      2063**DCL      2063--REDEF    2064--REDEF
B$JIT.PNR
      1967**DCL      1967--REDEF
B$JIT.TSLINE
      2061**DCL      2062--REDEF
B$JIT$
      2098**DCL      1787--IMP-PTR  2337>>IF       2337>>IF       2343>>CALLBLT
B$TCB.ALT$
      2158**DCL      2336>>ASSIGN
B$TCB$
      2099**DCL      2336>>ASSIGN
ERRCODE
      2289**DCL      2336<<ASSIGN   2350<>CALL
ERRCODE.ERR#
      2319**DCL      2337>>IF
F$DCB.ACTPOS
      2133**DCL      2133--REDEF
F$DCB.ARS#
      2107**DCL      2107--REDEF
F$DCB.ASN#
      2122**DCL      2337>>IF
F$DCB.ATTR
      2126**DCL      2127--REDEF
F$DCB.BORROW
      2141**DCL      2141--REDEF    2141--REDEF    2141--REDEF
F$DCB.DCBNAME.L
      2155**DCL      2155--IMP-SIZ
F$DCB.EOMCHAR#
      2111**DCL      2111--REDEF
F$DCB.FLDID
      2136**DCL      2136--REDEF
F$DCB.FORM$
      2130**DCL      2130--REDEF
F$DCB.FSECT
      2146**DCL      2146--REDEF
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:168  
F$DCB.FSN#
      2123**DCL      2123--REDEF    2123--REDEF    2124--REDEF
F$DCB.HEADER$
      2129**DCL      2129--REDEF
F$DCB.IXTNSIZE#
      2127**DCL      2127--REDEF
F$DCB.LASTSTA$
      2116**DCL      2116--REDEF
F$DCB.LVL
      2142**DCL      2142--REDEF
F$DCB.NAME#.C
      2117**DCL      2117--REDEF
F$DCB.NOEOF
      2139**DCL      2139--REDEF
F$DCB.NRECS#
      2128**DCL      2128--REDEF
F$DCB.NRECX
      2147**DCL      2147--REDEF
F$DCB.OHDR
      2139**DCL      2139--REDEF
F$DCB.ORG#
      2122**DCL      2122--REDEF
F$DCB.PRECNO
      2145**DCL      2145--REDEF
F$DCB.RCSZ
      2151**DCL      2151--REDEF
F$DCB.RES#
      2118**DCL      2118--REDEF
F$DCB.SETX
      2130**DCL      2130--REDEF
F$DCB.TAB$
      2130**DCL      2130--REDEF
F$DCB.TDA
      2144**DCL      2145--REDEF
F$DCB.WSN#
      2118**DCL      2118--REDEF
PL6.E3A0      #002=ALA$CPEXIT File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:29 Page:169  
FPT$CPEXIT
      2191**DCL         6--PROC     2332--IF       2354<>CALL
FPT_CPLOGOFF
      2218**DCL      2351<>CALL     2357<>CALL
M$CPEXIT
        31**DCL-ENT  2351--CALL     2354--CALL     2357--CALL
M$RACST
        25**DCL-ENT  2334--CALL
M$UC
        41**DCL      2337--IF
MEM_STR
      2168**DCL      2344<>CALL
MEM_STR.LEN
      2169**DCL      2342<<ASSIGN
MEM_STR.STR
      2170**DCL      2343<<CALLBLT
RACST_ALT
      2336**LABEL    2334--CALLALT

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:170  
      921        1        /*T***********************************************************/
      922        2        /*T*                                                         */
      923        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      924        4        /*T*                                                         */
      925        5        /*T***********************************************************/
      926        6                                                                                      /**/
      927        7        ALA$READ_USERS: PROC (USERS_KEY, RW$USERS) ALTRET ;
      928        8                  /***********************************************************/
      929        9                  /*                                                         */
      930       10                  /*      NAME:     ALA$READ_USERS                           */
      931       11                  /*                                                         */
      932       12                  /*      CALL:     CALL ALA$READ_USERS (USERS_KEY, RW$USERS) */
      933       13                  /*                                                         */
      934       14                  /*      INPUT:    USERS_KEY  is the KEY to the :USERS      */
      935       15                  /*                           record to be read.            */
      936       16                  /*                RW$USERS   is the buffer to read the     */
      937       17                  /*                           the USERS record into.        */
      938       18                  /*                                                         */
      939       19                  /*      OUTPUT:   Nothing is passed.                       */
      940       20                  /*                                                         */
      941       21                  /*      DESCRIPTION:  ALA$READ_USERS is the routine to     */
      942       22                  /*                read a users record from :USERS.         */
      943       23                  /*                                                         */
      944       24                  /*      ENTRIES:                                           */
      945       25                  /*                ALA$READ_USERS (USERS_KEY, RW$USERS)     */
      946       26                  /*                ALA$OPEN_USERS                           */
      947       27                  /*                ALA$CLOSE_USERS                          */
      948       28                  /*                                                         */
      949       29                  /***********************************************************/
      950       30                                                                                      /**/
      951       31        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:171  
      952       32        /*********************************************************************/
      953       33        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
      954       34        /*********************************************************************/
      955       35                                                                                      /**/
      956       36              %INCLUDE CP_6 ;
      957      117              %INCLUDE CP_6_SUBS ;
      958      657              %INCLUDE AS_SUPER_C ;
      959     1092              %INCLUDE AL_LOGON_R ;
      960     1124                                                                                      /**/
      961     1125        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:172  
      962     1126        /*********************************************************************/
      963     1127        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
      964     1128        /*********************************************************************/
      965     1129                                                                                      /**/
      966     1130    1   DCL 1 FILE_NAME CONSTANT ,
      967     1131    1         2 COUNT UBIN(9) UNAL INIT(6) ,
      968     1132    1         2 TEXT CHAR(31) UNAL INIT(':USERS') ;
      969     1133    1   DCL 1 FILE_ACCT CONSTANT SYMDEF,
      970     1134    1         2 TEXT CHAR(8) INIT(':SYS') ;
      971     1135                                                                                      /**/
      972     1136    1   DCL ALA$SYS_ERROR ENTRY;
      973     1137        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:173  
      974     1138        /*********************************************************************/
      975     1139        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
      976     1140        /*********************************************************************/
      977     1141                                                                                      /**/
      978     1142              %AS_USERS (STR_NAME=RW$USERS, STCLASS=" ") ;
      979     1320    1   DCL 1 USERS_KEY ,
      980     1321    1         2 CNT UBIN(9) UNAL ,
      981     1322    1         2 TEXT CHAR(20) UNAL ;
      982     1323                                                                                      /**/
      983     1324        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:174  
      984     1325        /*********************************************************************/
      985     1326        /*   FPTS            FPTS            FPTS            FPTS            */
      986     1327        /*********************************************************************/
      987     1328                                                                                      /**/
      988     1329              %FPT_OPEN (FPTN=OPEN_USERS_FPT ,
      989     1330                          STCLASS = CONSTANT ,
      990     1331                          NAME = FILE_NAME ,
      991     1332                          ACCT = FILE_ACCT ,
      992     1333                          ASN  = FILE ,
      993     1334                          ACS = DIRECT ,
      994     1335                          ORG = KEYED ,
      995     1336                          FUN = UPDATE ,
      996     1337                          SHARE = ALL) ;
      997     1446              %FPT_OPEN ( FPTN=OPEN$USERS_FPT ,
      998     1447                          SCRUB = YES ,
      999     1448                          STCLASS = AUTO ) ;
     1000     1557              %FPT_CLOSE (FPTN = CLOSE_USERS_FPT ,
     1001     1558                          STCLASS = CONSTANT ,
     1002     1559                           DISP = SAVE) ;
     1003     1601              %FPT_CLOSE (  FPTN = CLOSE$USERS_FPT ,
     1004     1602                            STCLASS = AUTO ) ;
     1005     1644              %FPT_READ  (FPTN = READ_USERS_FPT ,
     1006     1645                          STCLASS = CONSTANT ,
     1007     1646                          KEYS = YES) ;
     1008     1685              %FPT_READ   (FPTN = FPT$READ ,
     1009     1686                            STCLASS = AUTO ) ;
     1010     1725              %FPT_READ     (FPTN = READ_SEQ_FPT ,
     1011     1726                              STCLASS = CONSTANT ,
     1012     1727                              KEYR = YES ,
     1013     1728                              KEYS = NO ) ;
     1014     1767              %FPT_READ     (FPTN = READ$SEQ_FPT ,
     1015     1768                              STCLASS = AUTO ) ;
     1016     1807              %FPT_WRITE ( FPTN = WRITE_USERS_FPT,
     1017     1808                            STCLASS = CONSTANT ) ;
     1018     1839              %FPT_WRITE ( FPTN = WRITE$USERS_FPT,
     1019     1840                            STCLASS = AUTO ) ;
     1020     1871              %VLP_NAME ( FPTN = VLP_USERSNAME ,
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:175  
     1021     1872                          STCLASS = CONSTANT ,
     1022     1873                          NAME = 'M$USERS' ) ;
     1023     1900              %FPT_GETDCB ( FPTN = FPT_GETUSERS ,
     1024     1901                            STCLASS = CONSTANT ,
     1025     1902                            DCBNAME = VLP_USERSNAME ) ;
     1026     1917              %FPT_GETDCB ( FPTN = FPT$GETUSERS ,
     1027     1918                            STCLASS = AUTO ) ;
     1028     1933              %FPT_RELDCB ( FPTN = FPT_RELUSERS ,
     1029     1934                            STCLASS = CONSTANT ) ;
     1030     1948              %FPT_RELDCB ( FPTN = FPT$RELUSERS ,
     1031     1949                            STCLASS = AUTO ) ;
     1032     1963              %VLP_NAME ( FPTN = VLP_STARSNAME ,
     1033     1964                          STCLASS = CONSTANT ,
     1034     1965                          NAME = 'M$STARS' ) ;
     1035     1992              %FPT_GETDCB ( FPTN = FPT_GETSTARS ,
     1036     1993                            STCLASS = CONSTANT ,
     1037     1994                            DCBNAME = VLP_STARSNAME ) ;
     1038     2009              %FPT_GETDCB ( FPTN = FPT$GETSTARS ,
     1039     2010                            STCLASS = AUTO ) ;
     1040     2025              %FPT_RELDCB ( FPTN = FPT_RELSTARS ,
     1041     2026                            STCLASS = CONSTANT ) ;
     1042     2040              %FPT_RELDCB ( FPTN = FPT$RELSTARS ,
     1043     2041                            STCLASS = AUTO ) ;
     1044     2055              %FPT_ENQ ( FPTN = FPT_ENQ_USERS ,
     1045     2056                            STCLASS = CONSTANT ) ;
     1046     2074              %FPT_ENQ ( FPTN = FPT$ENQ_USERS ,
     1047     2075                            STCLASS = AUTO ) ;
     1048     2093              %FPT_DEQ ( FPTN = FPT_DEQ_USERS ,
     1049     2094                            STCLASS = CONSTANT ) ;
     1050     2111              %FPT_DEQ ( FPTN = FPT$DEQ_USERS ,
     1051     2112                            STCLASS = AUTO ) ;
     1052     2129                                                                                      /**/
     1053     2130        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:176  
     1054     2131        /********************************************************************/
     1055     2132        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1056     2133        /*********************************************************************/
     1057     2134                                                              /**/
     1058     2135                                                              /*
     1059     2136                                                                   SET BUF$ IN READ FPT
     1060     2137                                                              */
     1061     2138    1         FPT$READ = READ_USERS_FPT ;
     1062     2139    1         FPT$READ.BUF_ = VECTOR(RW$USERS) ;
     1063     2140    1         FPT$READ.KEY_ = VECTOR(USERS_KEY) ;
     1064     2141    1         FPT$READ.V.DCB# = AL_DCB1# ;
     1065     2142    1         FPT$READ.V_ = VECTOR(FPT$READ.V) ;
     1066     2143                                                              /*
     1067     2144                                                                    ***** Init. Enq fpt
     1068     2145                                                              */
     1069     2146    1         FPT$ENQ_USERS = FPT_ENQ_USERS;
     1070     2147    1         FPT$ENQ_USERS.V_ = VECTOR(FPT$ENQ_USERS.V);
     1071     2148    1         FPT$ENQ_USERS.V.DCB# = AL_DCB1#;
     1072     2149    1         FPT$ENQ_USERS.RNAME_ = VECTOR(USERS_KEY);
     1073     2150    1         FPT$ENQ_USERS.V.SHARE# = %NONE#;
     1074     2151    1         CALL M$ENQ(FPT$ENQ_USERS) ALTRET(ENQ_DEQ_ERR);
     1075     2152    1         CALL M$READ (FPT$READ) ALTRET(READ_ERR) ;
     1076     2153    1         RETURN ;
     1077     2154    1   READ_ERR:
     1078     2155                                                              /*
     1079     2156                                                                    ***** Init. Deq fpt
     1080     2157                                                              */
     1081     2158    1         FPT$DEQ_USERS = FPT_DEQ_USERS;
     1082     2159    1         FPT$DEQ_USERS.V_ = VECTOR(FPT$DEQ_USERS.V);
     1083     2160    1         FPT$DEQ_USERS.V.DCB# = AL_DCB1#;
     1084     2161    1         FPT$DEQ_USERS.RNAME_ = VECTOR(USERS_KEY);
     1085     2162    1         CALL M$DEQ(FPT$DEQ_USERS) ALTRET(ENQ_DEQ_ERR);
     1086     2163    1   ENQ_DEQ_ERR: ALTRETURN ;
     1087     2164                                                              /**/
     1088     2165    1   ALA$READ_SEQ_USERS:
     1089     2166    1         ENTRY(USERS_KEY, RW$USERS) ALTRET ;
     1090     2167    1         READ$SEQ_FPT = READ_SEQ_FPT ;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:177  
     1091     2168    1         READ$SEQ_FPT.BUF_ = VECTOR(RW$USERS) ;
     1092     2169    1         READ$SEQ_FPT.KEY_ = VECTOR(USERS_KEY) ;
     1093     2170    1         READ$SEQ_FPT.V.DCB# = AL_DCB1# ;
     1094     2171    1         READ$SEQ_FPT.V_ = VECTOR(READ$SEQ_FPT.V) ;
     1095     2172    1         CALL M$READ( READ$SEQ_FPT ) ALTRET( READ_SEQ_ERR ) ;
     1096     2173    1         RETURN ;
     1097     2174    1   READ_SEQ_ERR: ALTRETURN ;
     1098     2175                                                              /**/
     1099     2176    1   ALA$OPEN_USERS:
     1100     2177    1         ENTRY     ALTRET ;
     1101     2178    1         OPEN$USERS_FPT = OPEN_USERS_FPT ;
     1102     2179    1         OPEN$USERS_FPT.V.DCB# = AL_DCB1# ;
     1103     2180    1         OPEN$USERS_FPT.V_ = VECTOR(OPEN$USERS_FPT.V) ;
     1104     2181    1         CALL M$OPEN (OPEN$USERS_FPT) ALTRET(OPEN_ERR) ;
     1105     2182    1         RETURN ;
     1106     2183    1   OPEN_ERR: ALTRETURN ;
     1107     2184                                                              /**/
     1108     2185    1   ALA$WRITE_USERS:
     1109     2186    1         ENTRY(USERS_KEY, RW$USERS) ALTRET ;
     1110     2187    1         WRITE$USERS_FPT = WRITE_USERS_FPT ;
     1111     2188    1         WRITE$USERS_FPT.V_ = VECTOR(WRITE$USERS_FPT.V) ;
     1112     2189    1         WRITE$USERS_FPT.V.DCB# = AL_DCB1# ;
     1113     2190    1         WRITE$USERS_FPT.BUF_ = VECTOR(RW$USERS);
     1114     2191    1         WRITE$USERS_FPT.KEY_ = VECTOR(USERS_KEY);
     1115     2192    1         CALL M$WRITE (WRITE$USERS_FPT) ALTRET(WRITE_ERR) ;
     1116     2193                                                              /*
     1117     2194                                                                    ***** Init. Deq fpt
     1118     2195                                                              */
     1119     2196    1         FPT$DEQ_USERS = FPT_DEQ_USERS;
     1120     2197    1         FPT$DEQ_USERS.V_ = VECTOR(FPT$DEQ_USERS.V);
     1121     2198    1         FPT$DEQ_USERS.V.DCB# = AL_DCB1#;
     1122     2199    1         FPT$DEQ_USERS.RNAME_ = VECTOR(USERS_KEY);
     1123     2200    1         CALL M$DEQ(FPT$DEQ_USERS) ALTRET(ENQ_DEQ_ERR);
     1124     2201    1         RETURN ;
     1125     2202    1   WRITE_ERR:
     1126     2203                                                              /*
     1127     2204                                                                    ***** Init. Deq fpt
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:178  
     1128     2205                                                              */
     1129     2206    1         FPT$DEQ_USERS = FPT_DEQ_USERS;
     1130     2207    1         FPT$DEQ_USERS.V_ = VECTOR(FPT$DEQ_USERS.V);
     1131     2208    1         FPT$DEQ_USERS.V.DCB# = AL_DCB1#;
     1132     2209    1         FPT$DEQ_USERS.RNAME_ = VECTOR(USERS_KEY);
     1133     2210    1         CALL M$DEQ(FPT$DEQ_USERS) ALTRET(ENQ_DEQ_ERR);
     1134     2211    1         ALTRETURN ;
     1135     2212                                                              /**/
     1136     2213    1   ALA$CLOSE_USERS:
     1137     2214    1         ENTRY     ALTRET ;
     1138     2215    1         CLOSE$USERS_FPT = CLOSE_USERS_FPT ;
     1139     2216    1         CLOSE$USERS_FPT.V.DCB# = AL_DCB1# ;
     1140     2217    1         CLOSE$USERS_FPT.V_ = VECTOR( CLOSE$USERS_FPT.V ) ;
     1141     2218    1         CALL M$CLOSE (CLOSE$USERS_FPT) ALTRET (CLOSE_ERR) ;
     1142     2219    1         RETURN ;
     1143     2220    1   CLOSE_ERR: RETURN ;
     1144     2221                                                              /**/
     1145     2222    1   ALA$GETUSERS:
     1146     2223    1         ENTRY ALTRET ;
     1147     2224    1         FPT$GETUSERS = FPT_GETUSERS ;
     1148     2225    1         FPT$GETUSERS.V_ = VECTOR(FPT$GETUSERS.V) ;
     1149     2226    1         FPT$GETUSERS.V.DCB# = AL_DCB1# ;
     1150     2227    1         CALL M$GETDCB( FPT$GETUSERS ) ALTRET( NODCB ) ;
     1151     2228    1         RETURN ;
     1152     2229    1   NODCB: CALL ALA$SYS_ERROR;
     1153     2230    1         CALL M$XXX;
     1154     2231                                                              /**/
     1155     2232    1   ALA$GETSTARS:
     1156     2233    1         ENTRY ALTRET ;
     1157     2234    1         FPT$GETSTARS = FPT_GETSTARS ;
     1158     2235    1         FPT$GETSTARS.V_ = VECTOR(FPT$GETSTARS.V) ;
     1159     2236    1         FPT$GETSTARS.V.DCB# = AL_DCB2# ;
     1160     2237    1         CALL M$GETDCB( FPT$GETSTARS ) ALTRET( NODCB1 ) ;
     1161     2238    1         RETURN ;
     1162     2239    1   NODCB1: CALL ALA$SYS_ERROR;
     1163     2240    1         CALL M$XXX;
     1164     2241                                                              /**/
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:179  
     1165     2242    1   ALA$RELUSERS:
     1166     2243    1         ENTRY ALTRET ;
     1167     2244    1         FPT$RELUSERS = FPT_RELUSERS ;
     1168     2245    1         FPT$RELUSERS.V.DCB# = AL_DCB1# ;
     1169     2246    1         FPT$RELUSERS.V_ = VECTOR( FPT$RELUSERS.V ) ;
     1170     2247    1         CALL M$RELDCB( FPT$RELUSERS ) ALTRET( NODCB2 ) ;
     1171     2248    1         RETURN ;
     1172     2249    1   NODCB2: RETURN ;
     1173     2250                                                              /**/
     1174     2251    1   ALA$RELSTARS:
     1175     2252    1         ENTRY ALTRET ;
     1176     2253    1         FPT$RELSTARS = FPT_RELSTARS ;
     1177     2254    1         FPT$RELSTARS.V.DCB# = AL_DCB2# ;
     1178     2255    1         FPT$RELSTARS.V_ = VECTOR( FPT$RELSTARS.V ) ;
     1179     2256    1         CALL M$RELDCB( FPT$RELSTARS ) ALTRET( NODCB3 ) ;
     1180     2257    1         RETURN ;
     1181     2258    1   NODCB3: RETURN ;
     1182     2259                                                              /**/
     1183     2260    1   END   ALA$READ_USERS ;
     1184     2261        %EOD ;

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:180  
--  Include file information  --

   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$READ_USERS.

   Procedure ALA$READ_USERS requires 259 words for executable code.
   Procedure ALA$READ_USERS requires 178 words of local(AUTO) storage.

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:181  

 Object Unit name= ALA$READ_USERS                             File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:29:38.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    184    270  ALA$READ_USERS
    2   Proc  even  none   259    403  ALA$READ_USERS
    3  RoData even  none     6      6  ALA$READ_USERS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        2  ALA$READ_USERS
     2     73          yes     yes      Std        2  ALA$READ_SEQ_USERS
     2    123          yes     yes      Std        0  ALA$OPEN_USERS
     2    145          yes     yes      Std        2  ALA$WRITE_USERS
     2    237          yes     yes      Std        0  ALA$CLOSE_USERS
     2    261          yes     yes      Std        0  ALA$GETUSERS
     2    310          yes     yes      Std        0  ALA$GETSTARS
     2    337          yes     yes      Std        0  ALA$RELUSERS
     2    361          yes     yes      Std        0  ALA$RELSTARS

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1     10  FILE_ACCT
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:182  

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 ALA$SYS_ERROR
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  AL_DCB1#                              AL_DCB2#
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:183  


      921        1        /*T***********************************************************/
      922        2        /*T*                                                         */
      923        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      924        4        /*T*                                                         */
      925        5        /*T***********************************************************/
      926        6                                                                                      /**/
      927        7        ALA$READ_USERS: PROC (USERS_KEY, RW$USERS) ALTRET ;

      7  2 000000   000000 700200 xent  ALA$READ_US* TSX0  ! X66_AUTO_2
         2 000001   000262 000002                    ZERO    178,2

      928        8                  /***********************************************************/
      929        9                  /*                                                         */
      930       10                  /*      NAME:     ALA$READ_USERS                           */
      931       11                  /*                                                         */
      932       12                  /*      CALL:     CALL ALA$READ_USERS (USERS_KEY, RW$USERS) */
      933       13                  /*                                                         */
      934       14                  /*      INPUT:    USERS_KEY  is the KEY to the :USERS      */
      935       15                  /*                           record to be read.            */
      936       16                  /*                RW$USERS   is the buffer to read the     */
      937       17                  /*                           the USERS record into.        */
      938       18                  /*                                                         */
      939       19                  /*      OUTPUT:   Nothing is passed.                       */
      940       20                  /*                                                         */
      941       21                  /*      DESCRIPTION:  ALA$READ_USERS is the routine to     */
      942       22                  /*                read a users record from :USERS.         */
      943       23                  /*                                                         */
      944       24                  /*      ENTRIES:                                           */
      945       25                  /*                ALA$READ_USERS (USERS_KEY, RW$USERS)     */
      946       26                  /*                ALA$OPEN_USERS                           */
      947       27                  /*                ALA$CLOSE_USERS                          */
      948       28                  /*                                                         */
      949       29                  /***********************************************************/
      950       30                                                                                      /**/
      951       31        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:184  
      952       32        /*********************************************************************/
      953       33        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
      954       34        /*********************************************************************/
      955       35                                                                                      /**/
      956       36              %INCLUDE CP_6 ;
      957      117              %INCLUDE CP_6_SUBS ;
      958      657              %INCLUDE AS_SUPER_C ;
      959     1092              %INCLUDE AL_LOGON_R ;
      960     1124                                                                                      /**/
      961     1125        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:185  
      962     1126        /*********************************************************************/
      963     1127        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
      964     1128        /*********************************************************************/
      965     1129                                                                                      /**/
      966     1130    1   DCL 1 FILE_NAME CONSTANT ,
      967     1131    1         2 COUNT UBIN(9) UNAL INIT(6) ,
      968     1132    1         2 TEXT CHAR(31) UNAL INIT(':USERS') ;
      969     1133    1   DCL 1 FILE_ACCT CONSTANT SYMDEF,
      970     1134    1         2 TEXT CHAR(8) INIT(':SYS') ;
      971     1135                                                                                      /**/
      972     1136    1   DCL ALA$SYS_ERROR ENTRY;
      973     1137        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:186  
      974     1138        /*********************************************************************/
      975     1139        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
      976     1140        /*********************************************************************/
      977     1141                                                                                      /**/
      978     1142              %AS_USERS (STR_NAME=RW$USERS, STCLASS=" ") ;
      979     1320    1   DCL 1 USERS_KEY ,
      980     1321    1         2 CNT UBIN(9) UNAL ,
      981     1322    1         2 TEXT CHAR(20) UNAL ;
      982     1323                                                                                      /**/
      983     1324        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:187  
      984     1325        /*********************************************************************/
      985     1326        /*   FPTS            FPTS            FPTS            FPTS            */
      986     1327        /*********************************************************************/
      987     1328                                                                                      /**/
      988     1329              %FPT_OPEN (FPTN=OPEN_USERS_FPT ,
      989     1330                          STCLASS = CONSTANT ,
      990     1331                          NAME = FILE_NAME ,
      991     1332                          ACCT = FILE_ACCT ,
      992     1333                          ASN  = FILE ,
      993     1334                          ACS = DIRECT ,
      994     1335                          ORG = KEYED ,
      995     1336                          FUN = UPDATE ,
      996     1337                          SHARE = ALL) ;
      997     1446              %FPT_OPEN ( FPTN=OPEN$USERS_FPT ,
      998     1447                          SCRUB = YES ,
      999     1448                          STCLASS = AUTO ) ;
     1000     1557              %FPT_CLOSE (FPTN = CLOSE_USERS_FPT ,
     1001     1558                          STCLASS = CONSTANT ,
     1002     1559                           DISP = SAVE) ;
     1003     1601              %FPT_CLOSE (  FPTN = CLOSE$USERS_FPT ,
     1004     1602                            STCLASS = AUTO ) ;
     1005     1644              %FPT_READ  (FPTN = READ_USERS_FPT ,
     1006     1645                          STCLASS = CONSTANT ,
     1007     1646                          KEYS = YES) ;
     1008     1685              %FPT_READ   (FPTN = FPT$READ ,
     1009     1686                            STCLASS = AUTO ) ;
     1010     1725              %FPT_READ     (FPTN = READ_SEQ_FPT ,
     1011     1726                              STCLASS = CONSTANT ,
     1012     1727                              KEYR = YES ,
     1013     1728                              KEYS = NO ) ;
     1014     1767              %FPT_READ     (FPTN = READ$SEQ_FPT ,
     1015     1768                              STCLASS = AUTO ) ;
     1016     1807              %FPT_WRITE ( FPTN = WRITE_USERS_FPT,
     1017     1808                            STCLASS = CONSTANT ) ;
     1018     1839              %FPT_WRITE ( FPTN = WRITE$USERS_FPT,
     1019     1840                            STCLASS = AUTO ) ;
     1020     1871              %VLP_NAME ( FPTN = VLP_USERSNAME ,
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:188  
     1021     1872                          STCLASS = CONSTANT ,
     1022     1873                          NAME = 'M$USERS' ) ;
     1023     1900              %FPT_GETDCB ( FPTN = FPT_GETUSERS ,
     1024     1901                            STCLASS = CONSTANT ,
     1025     1902                            DCBNAME = VLP_USERSNAME ) ;
     1026     1917              %FPT_GETDCB ( FPTN = FPT$GETUSERS ,
     1027     1918                            STCLASS = AUTO ) ;
     1028     1933              %FPT_RELDCB ( FPTN = FPT_RELUSERS ,
     1029     1934                            STCLASS = CONSTANT ) ;
     1030     1948              %FPT_RELDCB ( FPTN = FPT$RELUSERS ,
     1031     1949                            STCLASS = AUTO ) ;
     1032     1963              %VLP_NAME ( FPTN = VLP_STARSNAME ,
     1033     1964                          STCLASS = CONSTANT ,
     1034     1965                          NAME = 'M$STARS' ) ;
     1035     1992              %FPT_GETDCB ( FPTN = FPT_GETSTARS ,
     1036     1993                            STCLASS = CONSTANT ,
     1037     1994                            DCBNAME = VLP_STARSNAME ) ;
     1038     2009              %FPT_GETDCB ( FPTN = FPT$GETSTARS ,
     1039     2010                            STCLASS = AUTO ) ;
     1040     2025              %FPT_RELDCB ( FPTN = FPT_RELSTARS ,
     1041     2026                            STCLASS = CONSTANT ) ;
     1042     2040              %FPT_RELDCB ( FPTN = FPT$RELSTARS ,
     1043     2041                            STCLASS = AUTO ) ;
     1044     2055              %FPT_ENQ ( FPTN = FPT_ENQ_USERS ,
     1045     2056                            STCLASS = CONSTANT ) ;
     1046     2074              %FPT_ENQ ( FPTN = FPT$ENQ_USERS ,
     1047     2075                            STCLASS = AUTO ) ;
     1048     2093              %FPT_DEQ ( FPTN = FPT_DEQ_USERS ,
     1049     2094                            STCLASS = CONSTANT ) ;
     1050     2111              %FPT_DEQ ( FPTN = FPT$DEQ_USERS ,
     1051     2112                            STCLASS = AUTO ) ;
     1052     2129                                                                                      /**/
     1053     2130        %EJECT;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:189  
     1054     2131        /********************************************************************/
     1055     2132        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1056     2133        /*********************************************************************/
     1057     2134                                                              /**/
     1058     2135                                                              /*
     1059     2136                                                                   SET BUF$ IN READ FPT
     1060     2137                                                              */
     1061     2138    1         FPT$READ = READ_USERS_FPT ;

   2138  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000142 000070 1                  ADSC9   READ_USERS_FPT           cn=0,n=56
         2 000004   200136 000070                    ADSC9   FPT$READ,,AUTO           cn=0,n=56

     1062     2139    1         FPT$READ.BUF_ = VECTOR(RW$USERS) ;

   2139  2 000005   000000 235000 3                  LDA     0
         2 000006   200004 236100                    LDQ     @RW$USERS,,AUTO
         2 000007   200142 757100                    STAQ    FPT$READ+4,,AUTO

     1063     2140    1         FPT$READ.KEY_ = VECTOR(USERS_KEY) ;

   2140  2 000010   000001 235000 3                  LDA     1
         2 000011   200003 236100                    LDQ     @USERS_KEY,,AUTO
         2 000012   200140 757100                    STAQ    FPT$READ+2,,AUTO

     1064     2141    1         FPT$READ.V.DCB# = AL_DCB1# ;

   2141  2 000013   000000 720000 xsym               LXL0    AL_DCB1#
         2 000014   200146 740100                    STX0    FPT$READ+8,,AUTO

     1065     2142    1         FPT$READ.V_ = VECTOR(FPT$READ.V) ;

   2142  2 000015   000002 235000 3                  LDA     2
         2 000016   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000017   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000020   000146 036003                    ADLQ    102,DU
         2 000021   200136 757100                    STAQ    FPT$READ,,AUTO
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:190  

     1066     2143                                                              /*
     1067     2144                                                                    ***** Init. Enq fpt
     1068     2145                                                              */
     1069     2146    1         FPT$ENQ_USERS = FPT_ENQ_USERS;

   2146  2 000022   000100 100400                    MLR     fill='000'O
         2 000023   000246 000050 1                  ADSC9   FPT_ENQ_USERS            cn=0,n=40
         2 000024   200236 000050                    ADSC9   FPT$ENQ_USERS,,AUTO      cn=0,n=40

     1070     2147    1         FPT$ENQ_USERS.V_ = VECTOR(FPT$ENQ_USERS.V);

   2147  2 000025   000003 235000 3                  LDA     3
         2 000026   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000027   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000030   000244 036003                    ADLQ    164,DU
         2 000031   200236 757100                    STAQ    FPT$ENQ_USERS,,AUTO

     1071     2148    1         FPT$ENQ_USERS.V.DCB# = AL_DCB1#;

   2148  2 000032   200244 740100                    STX0    FPT$ENQ_USERS+6,,AUTO

     1072     2149    1         FPT$ENQ_USERS.RNAME_ = VECTOR(USERS_KEY);

   2149  2 000033   000001 235000 3                  LDA     1
         2 000034   200003 236100                    LDQ     @USERS_KEY,,AUTO
         2 000035   200240 757100                    STAQ    FPT$ENQ_USERS+2,,AUTO

     1073     2150    1         FPT$ENQ_USERS.V.SHARE# = %NONE#;

   2150  2 000036   140000 236007                    LDQ     49152,DL
         2 000037   200244 256100                    ORSQ    FPT$ENQ_USERS+6,,AUTO

     1074     2151    1         CALL M$ENQ(FPT$ENQ_USERS) ALTRET(ENQ_DEQ_ERR);

   2151  2 000040   200236 630500                    EPPR0   FPT$ENQ_USERS,,AUTO
         2 000041   420002 713400                    CLIMB   alt,+8194
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:191  
         2 000042   401000 401760                    pmme    nvectors=3
         2 000043   000072 702000 2                  TSX2    ENQ_DEQ_ERR

     1075     2152    1         CALL M$READ (FPT$READ) ALTRET(READ_ERR) ;

   2152  2 000044   200136 630500                    EPPR0   FPT$READ,,AUTO
         2 000045   440000 713400                    CLIMB   alt,read
         2 000046   401400 401760                    pmme    nvectors=4
         2 000047   000051 702000 2                  TSX2    READ_ERR

     1076     2153    1         RETURN ;

   2153  2 000050   000000 702200 xent               TSX2  ! X66_ARET

     1077     2154    1   READ_ERR:
     1078     2155                                                              /*
     1079     2156                                                                    ***** Init. Deq fpt
     1080     2157                                                              */
     1081     2158    1         FPT$DEQ_USERS = FPT_DEQ_USERS;

   2158  2 000051   000100 100400       READ_ERR     MLR     fill='000'O
         2 000052   000260 000040 1                  ADSC9   FPT_DEQ_USERS            cn=0,n=32
         2 000053   200250 000040                    ADSC9   FPT$DEQ_USERS,,AUTO      cn=0,n=32

     1082     2159    1         FPT$DEQ_USERS.V_ = VECTOR(FPT$DEQ_USERS.V);

   2159  2 000054   000004 235000 3                  LDA     4
         2 000055   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000056   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000057   000256 036003                    ADLQ    174,DU
         2 000060   200250 757100                    STAQ    FPT$DEQ_USERS,,AUTO

     1083     2160    1         FPT$DEQ_USERS.V.DCB# = AL_DCB1#;

   2160  2 000061   000000 720000 xsym               LXL0    AL_DCB1#
         2 000062   200256 740100                    STX0    FPT$DEQ_USERS+6,,AUTO

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:192  
     1084     2161    1         FPT$DEQ_USERS.RNAME_ = VECTOR(USERS_KEY);

   2161  2 000063   000001 235000 3                  LDA     1
         2 000064   200003 236100                    LDQ     @USERS_KEY,,AUTO
         2 000065   200252 757100                    STAQ    FPT$DEQ_USERS+2,,AUTO

     1085     2162    1         CALL M$DEQ(FPT$DEQ_USERS) ALTRET(ENQ_DEQ_ERR);

   2162  2 000066   200250 630500                    EPPR0   FPT$DEQ_USERS,,AUTO
         2 000067   420003 713400                    CLIMB   alt,+8195
         2 000070   401000 401760                    pmme    nvectors=3
         2 000071   000072 702000 2                  TSX2    ENQ_DEQ_ERR

     1086     2163    1   ENQ_DEQ_ERR: ALTRETURN ;

   2163  2 000072   000000 702200 xent  ENQ_DEQ_ERR  TSX2  ! X66_AALT

     1087     2164                                                              /**/
     1088     2165    1   ALA$READ_SEQ_USERS:
     1089     2166    1         ENTRY(USERS_KEY, RW$USERS) ALTRET ;

   2166  2 000073   000000 700200 xent  ALA$READ_SE* TSX0  ! X66_AUTO_2
         2 000074   000262 000002                    ZERO    178,2

     1090     2167    1         READ$SEQ_FPT = READ_SEQ_FPT ;

   2167  2 000075   000100 100400                    MLR     fill='000'O
         2 000076   000160 000070 1                  ADSC9   READ_SEQ_FPT             cn=0,n=56
         2 000077   200154 000070                    ADSC9   READ$SEQ_FPT,,AUTO       cn=0,n=56

     1091     2168    1         READ$SEQ_FPT.BUF_ = VECTOR(RW$USERS) ;

   2168  2 000100   000000 235000 3                  LDA     0
         2 000101   200004 236100                    LDQ     @RW$USERS,,AUTO
         2 000102   200160 757100                    STAQ    READ$SEQ_FPT+4,,AUTO

     1092     2169    1         READ$SEQ_FPT.KEY_ = VECTOR(USERS_KEY) ;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:193  

   2169  2 000103   000001 235000 3                  LDA     1
         2 000104   200003 236100                    LDQ     @USERS_KEY,,AUTO
         2 000105   200156 757100                    STAQ    READ$SEQ_FPT+2,,AUTO

     1093     2170    1         READ$SEQ_FPT.V.DCB# = AL_DCB1# ;

   2170  2 000106   000000 720000 xsym               LXL0    AL_DCB1#
         2 000107   200164 740100                    STX0    READ$SEQ_FPT+8,,AUTO

     1094     2171    1         READ$SEQ_FPT.V_ = VECTOR(READ$SEQ_FPT.V) ;

   2171  2 000110   000002 235000 3                  LDA     2
         2 000111   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000112   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000113   000164 036003                    ADLQ    116,DU
         2 000114   200154 757100                    STAQ    READ$SEQ_FPT,,AUTO

     1095     2172    1         CALL M$READ( READ$SEQ_FPT ) ALTRET( READ_SEQ_ERR ) ;

   2172  2 000115   200154 630500                    EPPR0   READ$SEQ_FPT,,AUTO
         2 000116   440000 713400                    CLIMB   alt,read
         2 000117   401400 401760                    pmme    nvectors=4
         2 000120   000122 702000 2                  TSX2    READ_SEQ_ERR

     1096     2173    1         RETURN ;

   2173  2 000121   000000 702200 xent               TSX2  ! X66_ARET

     1097     2174    1   READ_SEQ_ERR: ALTRETURN ;

   2174  2 000122   000000 702200 xent  READ_SEQ_ERR TSX2  ! X66_AALT

     1098     2175                                                              /**/
     1099     2176    1   ALA$OPEN_USERS:
     1100     2177    1         ENTRY     ALTRET ;

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:194  
   2177  2 000123   000000 700200 xent  ALA$OPEN_US* TSX0  ! X66_AUTO_2
         2 000124   000262 000002                    ZERO    178,2

     1101     2178    1         OPEN$USERS_FPT = OPEN_USERS_FPT ;

   2178  2 000125   000100 100400                    MLR     fill='000'O
         2 000126   000012 000350 1                  ADSC9   OPEN_USERS_FPT           cn=0,n=232
         2 000127   200006 000350                    ADSC9   OPEN$USERS_FPT,,AUTO     cn=0,n=232

     1102     2179    1         OPEN$USERS_FPT.V.DCB# = AL_DCB1# ;

   2179  2 000130   000000 720000 xsym               LXL0    AL_DCB1#
         2 000131   200052 740100                    STX0    OPEN$USERS_FPT+36,,AUTO

     1103     2180    1         OPEN$USERS_FPT.V_ = VECTOR(OPEN$USERS_FPT.V) ;

   2180  2 000132   000005 235000 3                  LDA     5
         2 000133   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000134   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000135   000052 036003                    ADLQ    42,DU
         2 000136   200006 757100                    STAQ    OPEN$USERS_FPT,,AUTO

     1104     2181    1         CALL M$OPEN (OPEN$USERS_FPT) ALTRET(OPEN_ERR) ;

   2181  2 000137   200006 630500                    EPPR0   OPEN$USERS_FPT,,AUTO
         2 000140   450000 713400                    CLIMB   alt,open
         2 000141   410400 401760                    pmme    nvectors=18
         2 000142   000144 702000 2                  TSX2    OPEN_ERR

     1105     2182    1         RETURN ;

   2182  2 000143   000000 702200 xent               TSX2  ! X66_ARET

     1106     2183    1   OPEN_ERR: ALTRETURN ;

   2183  2 000144   000000 702200 xent  OPEN_ERR     TSX2  ! X66_AALT

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:195  
     1107     2184                                                              /**/
     1108     2185    1   ALA$WRITE_USERS:
     1109     2186    1         ENTRY(USERS_KEY, RW$USERS) ALTRET ;

   2186  2 000145   000000 700200 xent  ALA$WRITE_U* TSX0  ! X66_AUTO_2
         2 000146   000262 000002                    ZERO    178,2

     1110     2187    1         WRITE$USERS_FPT = WRITE_USERS_FPT ;

   2187  2 000147   000100 100400                    MLR     fill='000'O
         2 000150   000176 000060 1                  ADSC9   WRITE_USERS_FPT          cn=0,n=48
         2 000151   200172 000060                    ADSC9   WRITE$USERS_FPT,,AUTO    cn=0,n=48

     1111     2188    1         WRITE$USERS_FPT.V_ = VECTOR(WRITE$USERS_FPT.V) ;

   2188  2 000152   000003 235000 3                  LDA     3
         2 000153   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000154   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000155   000202 036003                    ADLQ    130,DU
         2 000156   200172 757100                    STAQ    WRITE$USERS_FPT,,AUTO

     1112     2189    1         WRITE$USERS_FPT.V.DCB# = AL_DCB1# ;

   2189  2 000157   000000 720000 xsym               LXL0    AL_DCB1#
         2 000160   200202 740100                    STX0    WRITE$USERS_FPT+8,,AUTO

     1113     2190    1         WRITE$USERS_FPT.BUF_ = VECTOR(RW$USERS);

   2190  2 000161   000000 235000 3                  LDA     0
         2 000162   200004 236100                    LDQ     @RW$USERS,,AUTO
         2 000163   200176 757100                    STAQ    WRITE$USERS_FPT+4,,AUTO

     1114     2191    1         WRITE$USERS_FPT.KEY_ = VECTOR(USERS_KEY);

   2191  2 000164   000001 235000 3                  LDA     1
         2 000165   200003 236100                    LDQ     @USERS_KEY,,AUTO
         2 000166   200174 757100                    STAQ    WRITE$USERS_FPT+2,,AUTO
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:196  

     1115     2192    1         CALL M$WRITE (WRITE$USERS_FPT) ALTRET(WRITE_ERR) ;

   2192  2 000167   200172 630500                    EPPR0   WRITE$USERS_FPT,,AUTO
         2 000170   440001 713400                    CLIMB   alt,write
         2 000171   401400 401760                    pmme    nvectors=4
         2 000172   000215 702000 2                  TSX2    WRITE_ERR

     1116     2193                                                              /*
     1117     2194                                                                    ***** Init. Deq fpt
     1118     2195                                                              */
     1119     2196    1         FPT$DEQ_USERS = FPT_DEQ_USERS;

   2196  2 000173   000100 100400                    MLR     fill='000'O
         2 000174   000260 000040 1                  ADSC9   FPT_DEQ_USERS            cn=0,n=32
         2 000175   200250 000040                    ADSC9   FPT$DEQ_USERS,,AUTO      cn=0,n=32

     1120     2197    1         FPT$DEQ_USERS.V_ = VECTOR(FPT$DEQ_USERS.V);

   2197  2 000176   000004 235000 3                  LDA     4
         2 000177   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000200   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000201   000256 036003                    ADLQ    174,DU
         2 000202   200250 757100                    STAQ    FPT$DEQ_USERS,,AUTO

     1121     2198    1         FPT$DEQ_USERS.V.DCB# = AL_DCB1#;

   2198  2 000203   000000 720000 xsym               LXL0    AL_DCB1#
         2 000204   200256 740100                    STX0    FPT$DEQ_USERS+6,,AUTO

     1122     2199    1         FPT$DEQ_USERS.RNAME_ = VECTOR(USERS_KEY);

   2199  2 000205   000001 235000 3                  LDA     1
         2 000206   200003 236100                    LDQ     @USERS_KEY,,AUTO
         2 000207   200252 757100                    STAQ    FPT$DEQ_USERS+2,,AUTO

     1123     2200    1         CALL M$DEQ(FPT$DEQ_USERS) ALTRET(ENQ_DEQ_ERR);
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:197  

   2200  2 000210   200250 630500                    EPPR0   FPT$DEQ_USERS,,AUTO
         2 000211   420003 713400                    CLIMB   alt,+8195
         2 000212   401000 401760                    pmme    nvectors=3
         2 000213   000072 702000 2                  TSX2    ENQ_DEQ_ERR

     1124     2201    1         RETURN ;

   2201  2 000214   000000 702200 xent               TSX2  ! X66_ARET

     1125     2202    1   WRITE_ERR:
     1126     2203                                                              /*
     1127     2204                                                                    ***** Init. Deq fpt
     1128     2205                                                              */
     1129     2206    1         FPT$DEQ_USERS = FPT_DEQ_USERS;

   2206  2 000215   000100 100400       WRITE_ERR    MLR     fill='000'O
         2 000216   000260 000040 1                  ADSC9   FPT_DEQ_USERS            cn=0,n=32
         2 000217   200250 000040                    ADSC9   FPT$DEQ_USERS,,AUTO      cn=0,n=32

     1130     2207    1         FPT$DEQ_USERS.V_ = VECTOR(FPT$DEQ_USERS.V);

   2207  2 000220   000004 235000 3                  LDA     4
         2 000221   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000222   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000223   000256 036003                    ADLQ    174,DU
         2 000224   200250 757100                    STAQ    FPT$DEQ_USERS,,AUTO

     1131     2208    1         FPT$DEQ_USERS.V.DCB# = AL_DCB1#;

   2208  2 000225   000000 720000 xsym               LXL0    AL_DCB1#
         2 000226   200256 740100                    STX0    FPT$DEQ_USERS+6,,AUTO

     1132     2209    1         FPT$DEQ_USERS.RNAME_ = VECTOR(USERS_KEY);

   2209  2 000227   000001 235000 3                  LDA     1
         2 000230   200003 236100                    LDQ     @USERS_KEY,,AUTO
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:198  
         2 000231   200252 757100                    STAQ    FPT$DEQ_USERS+2,,AUTO

     1133     2210    1         CALL M$DEQ(FPT$DEQ_USERS) ALTRET(ENQ_DEQ_ERR);

   2210  2 000232   200250 630500                    EPPR0   FPT$DEQ_USERS,,AUTO
         2 000233   420003 713400                    CLIMB   alt,+8195
         2 000234   401000 401760                    pmme    nvectors=3
         2 000235   000072 702000 2                  TSX2    ENQ_DEQ_ERR

     1134     2211    1         ALTRETURN ;

   2211  2 000236   000000 702200 xent               TSX2  ! X66_AALT

     1135     2212                                                              /**/
     1136     2213    1   ALA$CLOSE_USERS:
     1137     2214    1         ENTRY     ALTRET ;

   2214  2 000237   000000 700200 xent  ALA$CLOSE_U* TSX0  ! X66_AUTO_2
         2 000240   000262 000002                    ZERO    178,2

     1138     2215    1         CLOSE$USERS_FPT = CLOSE_USERS_FPT ;

   2215  2 000241   000100 100400                    MLR     fill='000'O
         2 000242   000104 000170 1                  ADSC9   CLOSE_USERS_FPT          cn=0,n=120
         2 000243   200100 000170                    ADSC9   CLOSE$USERS_FPT,,AUTO    cn=0,n=120

     1139     2216    1         CLOSE$USERS_FPT.V.DCB# = AL_DCB1# ;

   2216  2 000244   000000 720000 xsym               LXL0    AL_DCB1#
         2 000245   200132 740100                    STX0    CLOSE$USERS_FPT+26,,AUTO

     1140     2217    1         CLOSE$USERS_FPT.V_ = VECTOR( CLOSE$USERS_FPT.V ) ;

   2217  2 000246   000003 235000 3                  LDA     3
         2 000247   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000250   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000251   000132 036003                    ADLQ    90,DU
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:199  
         2 000252   200100 757100                    STAQ    CLOSE$USERS_FPT,,AUTO

     1141     2218    1         CALL M$CLOSE (CLOSE$USERS_FPT) ALTRET (CLOSE_ERR) ;

   2218  2 000253   200100 630500                    EPPR0   CLOSE$USERS_FPT,,AUTO
         2 000254   450001 713400                    CLIMB   alt,close
         2 000255   406000 401760                    pmme    nvectors=13
         2 000256   000260 702000 2                  TSX2    CLOSE_ERR

     1142     2219    1         RETURN ;

   2219  2 000257   000000 702200 xent               TSX2  ! X66_ARET

     1143     2220    1   CLOSE_ERR: RETURN ;

   2220  2 000260   000000 702200 xent  CLOSE_ERR    TSX2  ! X66_ARET

     1144     2221                                                              /**/
     1145     2222    1   ALA$GETUSERS:
     1146     2223    1         ENTRY ALTRET ;

   2223  2 000261   000000 700200 xent  ALA$GETUSERS TSX0  ! X66_AUTO_2
         2 000262   000262 000002                    ZERO    178,2

     1147     2224    1         FPT$GETUSERS = FPT_GETUSERS ;

   2224  2 000263   000100 100400                    MLR     fill='000'O
         2 000264   000214 000040 1                  ADSC9   FPT_GETUSERS             cn=0,n=32
         2 000265   200206 000040                    ADSC9   FPT$GETUSERS,,AUTO       cn=0,n=32

     1148     2225    1         FPT$GETUSERS.V_ = VECTOR(FPT$GETUSERS.V) ;

   2225  2 000266   000004 235000 3                  LDA     4
         2 000267   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000270   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000271   000214 036003                    ADLQ    140,DU
         2 000272   200206 757100                    STAQ    FPT$GETUSERS,,AUTO
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:200  

     1149     2226    1         FPT$GETUSERS.V.DCB# = AL_DCB1# ;

   2226  2 000273   000000 720000 xsym               LXL0    AL_DCB1#
         2 000274   200214 740100                    STX0    FPT$GETUSERS+6,,AUTO

     1150     2227    1         CALL M$GETDCB( FPT$GETUSERS ) ALTRET( NODCB ) ;

   2227  2 000275   200206 630500                    EPPR0   FPT$GETUSERS,,AUTO
         2 000276   460002 713400                    CLIMB   alt,+24578
         2 000277   401000 401760                    pmme    nvectors=3
         2 000300   000302 702000 2                  TSX2    NODCB

     1151     2228    1         RETURN ;

   2228  2 000301   000000 702200 xent               TSX2  ! X66_ARET

     1152     2229    1   NODCB: CALL ALA$SYS_ERROR;

   2229  2 000302   000002 631400 xsym  NODCB        EPPR1   B_VECTNIL+2
         2 000303   000000 701000 xent               TSX1    ALA$SYS_ERROR
         2 000304   000000 011000                    NOP     0

     1153     2230    1         CALL M$XXX;

   2230  2 000305   000003 713400                    CLIMB   3
         2 000306   000000 401760                    pmme    nvectors=0
         2 000307   000312 710000 2                  TRA     s:2234

     1154     2231                                                              /**/
     1155     2232    1   ALA$GETSTARS:
     1156     2233    1         ENTRY ALTRET ;

   2233  2 000310   000000 700200 xent  ALA$GETSTARS TSX0  ! X66_AUTO_2
         2 000311   000262 000002                    ZERO    178,2

     1157     2234    1         FPT$GETSTARS = FPT_GETSTARS ;
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:201  

   2234  2 000312   000100 100400                    MLR     fill='000'O
         2 000313   000232 000040 1                  ADSC9   FPT_GETSTARS             cn=0,n=32
         2 000314   200222 000040                    ADSC9   FPT$GETSTARS,,AUTO       cn=0,n=32

     1158     2235    1         FPT$GETSTARS.V_ = VECTOR(FPT$GETSTARS.V) ;

   2235  2 000315   000004 235000 3                  LDA     4
         2 000316   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000317   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000320   000230 036003                    ADLQ    152,DU
         2 000321   200222 757100                    STAQ    FPT$GETSTARS,,AUTO

     1159     2236    1         FPT$GETSTARS.V.DCB# = AL_DCB2# ;

   2236  2 000322   000000 720000 xsym               LXL0    AL_DCB2#
         2 000323   200230 740100                    STX0    FPT$GETSTARS+6,,AUTO

     1160     2237    1         CALL M$GETDCB( FPT$GETSTARS ) ALTRET( NODCB1 ) ;

   2237  2 000324   200222 630500                    EPPR0   FPT$GETSTARS,,AUTO
         2 000325   460002 713400                    CLIMB   alt,+24578
         2 000326   401000 401760                    pmme    nvectors=3
         2 000327   000331 702000 2                  TSX2    NODCB1

     1161     2238    1         RETURN ;

   2238  2 000330   000000 702200 xent               TSX2  ! X66_ARET

     1162     2239    1   NODCB1: CALL ALA$SYS_ERROR;

   2239  2 000331   000002 631400 xsym  NODCB1       EPPR1   B_VECTNIL+2
         2 000332   000000 701000 xent               TSX1    ALA$SYS_ERROR
         2 000333   000000 011000                    NOP     0

     1163     2240    1         CALL M$XXX;

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:202  
   2240  2 000334   000003 713400                    CLIMB   3
         2 000335   000000 401760                    pmme    nvectors=0
         2 000336   000341 710000 2                  TRA     s:2244

     1164     2241                                                              /**/
     1165     2242    1   ALA$RELUSERS:
     1166     2243    1         ENTRY ALTRET ;

   2243  2 000337   000000 700200 xent  ALA$RELUSERS TSX0  ! X66_AUTO_2
         2 000340   000262 000002                    ZERO    178,2

     1167     2244    1         FPT$RELUSERS = FPT_RELUSERS ;

   2244  2 000341   000100 100400                    MLR     fill='000'O
         2 000342   000224 000020 1                  ADSC9   FPT_RELUSERS             cn=0,n=16
         2 000343   200216 000020                    ADSC9   FPT$RELUSERS,,AUTO       cn=0,n=16

     1168     2245    1         FPT$RELUSERS.V.DCB# = AL_DCB1# ;

   2245  2 000344   000000 720000 xsym               LXL0    AL_DCB1#
         2 000345   200220 740100                    STX0    FPT$RELUSERS+2,,AUTO

     1169     2246    1         FPT$RELUSERS.V_ = VECTOR( FPT$RELUSERS.V ) ;

   2246  2 000346   000004 235000 3                  LDA     4
         2 000347   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000350   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000351   000220 036003                    ADLQ    144,DU
         2 000352   200216 757100                    STAQ    FPT$RELUSERS,,AUTO

     1170     2247    1         CALL M$RELDCB( FPT$RELUSERS ) ALTRET( NODCB2 ) ;

   2247  2 000353   200216 630500                    EPPR0   FPT$RELUSERS,,AUTO
         2 000354   460003 713400                    CLIMB   alt,+24579
         2 000355   400000 401760                    pmme    nvectors=1
         2 000356   000360 702000 2                  TSX2    NODCB2

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:203  
     1171     2248    1         RETURN ;

   2248  2 000357   000000 702200 xent               TSX2  ! X66_ARET

     1172     2249    1   NODCB2: RETURN ;

   2249  2 000360   000000 702200 xent  NODCB2       TSX2  ! X66_ARET

     1173     2250                                                              /**/
     1174     2251    1   ALA$RELSTARS:
     1175     2252    1         ENTRY ALTRET ;

   2252  2 000361   000000 700200 xent  ALA$RELSTARS TSX0  ! X66_AUTO_2
         2 000362   000262 000002                    ZERO    178,2

     1176     2253    1         FPT$RELSTARS = FPT_RELSTARS ;

   2253  2 000363   000100 100400                    MLR     fill='000'O
         2 000364   000242 000020 1                  ADSC9   FPT_RELSTARS             cn=0,n=16
         2 000365   200232 000020                    ADSC9   FPT$RELSTARS,,AUTO       cn=0,n=16

     1177     2254    1         FPT$RELSTARS.V.DCB# = AL_DCB2# ;

   2254  2 000366   000000 720000 xsym               LXL0    AL_DCB2#
         2 000367   200234 740100                    STX0    FPT$RELSTARS+2,,AUTO

     1178     2255    1         FPT$RELSTARS.V_ = VECTOR( FPT$RELSTARS.V ) ;

   2255  2 000370   000004 235000 3                  LDA     4
         2 000371   200260 452500                    STP2    FPT$DEQ_USERS+8,,AUTO
         2 000372   200260 236100                    LDQ     FPT$DEQ_USERS+8,,AUTO
         2 000373   000234 036003                    ADLQ    156,DU
         2 000374   200232 757100                    STAQ    FPT$RELSTARS,,AUTO

     1179     2256    1         CALL M$RELDCB( FPT$RELSTARS ) ALTRET( NODCB3 ) ;

   2256  2 000375   200232 630500                    EPPR0   FPT$RELSTARS,,AUTO
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:204  
         2 000376   460003 713400                    CLIMB   alt,+24579
         2 000377   400000 401760                    pmme    nvectors=1
         2 000400   000402 702000 2                  TSX2    NODCB3

     1180     2257    1         RETURN ;

   2257  2 000401   000000 702200 xent               TSX2  ! X66_ARET

     1181     2258    1   NODCB3: RETURN ;

   2258  2 000402   000000 702200 xent  NODCB3       TSX2  ! X66_ARET
     1182     2259                                                              /**/
     1183     2260    1   END   ALA$READ_USERS ;
     1184     2261        %EOD ;

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:205  
--  Include file information  --

   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$READ_USERS.
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:206  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$READ_USERS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   104-0-0/d STRC(1080)  r     1 CLOSE_USERS_FPT           10-0-0/c STRC(72)    r     1 FILE_ACCT
     0-0-0/c STRC(288)   r     1 FILE_NAME                260-0-0/d STRC(288)   r     1 FPT_DEQ_USERS
   246-0-0/d STRC(360)   r     1 FPT_ENQ_USERS            232-0-0/d STRC(288)   r     1 FPT_GETSTARS
   214-0-0/d STRC(288)   r     1 FPT_GETUSERS             242-0-0/d STRC(144)   r     1 FPT_RELSTARS
   224-0-0/d STRC(144)   r     1 FPT_RELUSERS              12-0-0/d STRC(2088)  r     1 OPEN_USERS_FPT
   160-0-0/d STRC(504)   r     1 READ_SEQ_FPT             142-0-0/d STRC(504)   r     1 READ_USERS_FPT
   230-0-0/c STRC(72)    r     1 VLP_STARSNAME            212-0-0/c STRC(72)    r     1 VLP_USERSNAME
   176-0-0/d STRC(432)   r     1 WRITE_USERS_FPT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @RW$USERS                  3-0-0/w PTR         r     1 @USERS_KEY
   100-0-0/d STRC(1080)  r     1 CLOSE$USERS_FPT          250-0-0/d STRC(288)   r     1 FPT$DEQ_USERS
   236-0-0/d STRC(360)   r     1 FPT$ENQ_USERS            222-0-0/d STRC(288)   r     1 FPT$GETSTARS
   206-0-0/d STRC(288)   r     1 FPT$GETUSERS             136-0-0/d STRC(504)   r     1 FPT$READ
   232-0-0/d STRC(144)   r     1 FPT$RELSTARS             216-0-0/d STRC(144)   r     1 FPT$RELUSERS
     6-0-0/d STRC(2088)  r     1 OPEN$USERS_FPT           154-0-0/d STRC(504)   r     1 READ$SEQ_FPT
    *0-0-0/w STRC(18576) r     1 RW$USERS                  *0-0-0/c STRC(189)   r     1 USERS_KEY
   172-0-0/d STRC(432)   r     1 WRITE$USERS_FPT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AL_DCB1#                   0-0-0/w UBIN        r     1 AL_DCB2#

PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:207  

   Procedure ALA$READ_USERS requires 259 words for executable code.
   Procedure ALA$READ_USERS requires 178 words of local(AUTO) storage.
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:208  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:209  
          MINI XREF LISTING

ALA$SYS_ERROR
      1136**DCL-ENT  2229--CALL     2239--CALL
AL_DCB1#
      1120**DCL      2141>>ASSIGN   2148>>ASSIGN   2160>>ASSIGN   2170>>ASSIGN   2179>>ASSIGN   2189>>ASSIGN
      2198>>ASSIGN   2208>>ASSIGN   2216>>ASSIGN   2226>>ASSIGN   2245>>ASSIGN
AL_DCB2#
      1121**DCL      2236>>ASSIGN   2254>>ASSIGN
CLOSE$USERS_FPT
      1625**DCL      2215<<ASSIGN   2218<>CALL
CLOSE$USERS_FPT.SN_
      1625**DCL      1625--REDEF
CLOSE$USERS_FPT.UTL_
      1626**DCL      1626--REDEF
CLOSE$USERS_FPT.V
      1630**DCL      2217--ASSIGN
CLOSE$USERS_FPT.V.DCB#
      1631**DCL      2216<<ASSIGN
CLOSE$USERS_FPT.V.EXPIRE#
      1640**DCL      1640--REDEF
CLOSE$USERS_FPT.V.TYPE#
      1638**DCL      1638--REDEF
CLOSE$USERS_FPT.V.XTNSIZE#
      1635**DCL      1635--REDEF    1637--REDEF
CLOSE$USERS_FPT.V_
      1625**DCL      2217<<ASSIGN
CLOSE_ERR
      2220**LABEL    2218--CALLALT
CLOSE_USERS_FPT
      1582**DCL      2215>>ASSIGN
CLOSE_USERS_FPT.SN_
      1582**DCL      1582--REDEF
CLOSE_USERS_FPT.UTL_
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:210  
      1583**DCL      1583--REDEF
CLOSE_USERS_FPT.V
      1587**DCL      1582--DCLINIT
CLOSE_USERS_FPT.V.EXPIRE#
      1597**DCL      1597--REDEF
CLOSE_USERS_FPT.V.TYPE#
      1595**DCL      1595--REDEF
CLOSE_USERS_FPT.V.XTNSIZE#
      1592**DCL      1592--REDEF    1594--REDEF
ENQ_DEQ_ERR
      2163**LABEL    2151--CALLALT  2162--CALLALT  2200--CALLALT  2210--CALLALT
FILE_ACCT
      1133**DCL      1407--DCLINIT
FILE_NAME
      1130**DCL      1403--DCLINIT
FPT$DEQ_USERS
      2123**DCL      2158<<ASSIGN   2162<>CALL     2196<<ASSIGN   2200<>CALL     2206<<ASSIGN   2210<>CALL
FPT$DEQ_USERS.RNAME_
      2123**DCL      2161<<ASSIGN   2199<<ASSIGN   2209<<ASSIGN
FPT$DEQ_USERS.V
      2124**DCL      2159--ASSIGN   2197--ASSIGN   2207--ASSIGN
FPT$DEQ_USERS.V.DCB#
      2124**DCL      2160<<ASSIGN   2198<<ASSIGN   2208<<ASSIGN
FPT$DEQ_USERS.V_
      2123**DCL      2159<<ASSIGN   2197<<ASSIGN   2207<<ASSIGN
FPT$ENQ_USERS
      2086**DCL      2146<<ASSIGN   2151<>CALL
FPT$ENQ_USERS.RNAME_
      2086**DCL      2149<<ASSIGN
FPT$ENQ_USERS.V
      2087**DCL      2147--ASSIGN
FPT$ENQ_USERS.V.DCB#
      2087**DCL      2148<<ASSIGN
FPT$ENQ_USERS.V.SHARE#
      2088**DCL      2150<<ASSIGN
FPT$ENQ_USERS.V_
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:211  
      2086**DCL      2147<<ASSIGN
FPT$GETSTARS
      2021**DCL      2234<<ASSIGN   2237<>CALL
FPT$GETSTARS.V
      2022**DCL      2235--ASSIGN
FPT$GETSTARS.V.DCB#
      2022**DCL      2236<<ASSIGN
FPT$GETSTARS.V_
      2021**DCL      2235<<ASSIGN
FPT$GETUSERS
      1929**DCL      2224<<ASSIGN   2227<>CALL
FPT$GETUSERS.V
      1930**DCL      2225--ASSIGN
FPT$GETUSERS.V.DCB#
      1930**DCL      2226<<ASSIGN
FPT$GETUSERS.V_
      1929**DCL      2225<<ASSIGN
FPT$READ
      1703**DCL      2138<<ASSIGN   2152<>CALL
FPT$READ.BUF_
      1705**DCL      2139<<ASSIGN
FPT$READ.KEY_
      1703**DCL      2140<<ASSIGN
FPT$READ.STATION_
      1706**DCL      1707--REDEF
FPT$READ.V
      1707**DCL      2142--ASSIGN
FPT$READ.V.DCB#
      1707**DCL      2141<<ASSIGN
FPT$READ.V.DVBYTE.REREAD#
      1718**DCL      1718--REDEF
FPT$READ.V.INDX#
      1716**DCL      1716--REDEF
FPT$READ.V_
      1703**DCL      2142<<ASSIGN
FPT$RELSTARS
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:212  
      2052**DCL      2253<<ASSIGN   2256<>CALL
FPT$RELSTARS.V
      2052**DCL      2255--ASSIGN
FPT$RELSTARS.V.DCB#
      2052**DCL      2254<<ASSIGN
FPT$RELSTARS.V_
      2052**DCL      2255<<ASSIGN
FPT$RELUSERS
      1960**DCL      2244<<ASSIGN   2247<>CALL
FPT$RELUSERS.V
      1960**DCL      2246--ASSIGN
FPT$RELUSERS.V.DCB#
      1960**DCL      2245<<ASSIGN
FPT$RELUSERS.V_
      1960**DCL      2246<<ASSIGN
FPT_DEQ_USERS
      2105**DCL      2158>>ASSIGN   2196>>ASSIGN   2206>>ASSIGN
FPT_DEQ_USERS.V
      2106**DCL      2105--DCLINIT
FPT_ENQ_USERS
      2067**DCL      2146>>ASSIGN
FPT_ENQ_USERS.V
      2068**DCL      2067--DCLINIT
FPT_GETSTARS
      2005**DCL      2234>>ASSIGN
FPT_GETSTARS.V
      2006**DCL      2005--DCLINIT
FPT_GETUSERS
      1913**DCL      2224>>ASSIGN
FPT_GETUSERS.V
      1914**DCL      1913--DCLINIT
FPT_RELSTARS
      2037**DCL      2253>>ASSIGN
FPT_RELSTARS.V
      2037**DCL      2037--DCLINIT
FPT_RELUSERS
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:213  
      1945**DCL      2244>>ASSIGN
FPT_RELUSERS.V
      1945**DCL      1945--DCLINIT
M$CLOSE
        45**DCL-ENT  2218--CALL
M$DEQ
       112**DCL-ENT  2162--CALL     2200--CALL     2210--CALL
M$ENQ
       111**DCL-ENT  2151--CALL
M$GETDCB
        51**DCL-ENT  2227--CALL     2237--CALL
M$OPEN
        45**DCL-ENT  2181--CALL
M$READ
        46**DCL-ENT  2152--CALL     2172--CALL
M$RELDCB
        51**DCL-ENT  2247--CALL     2256--CALL
M$WRITE
        46**DCL-ENT  2192--CALL
M$XXX
        57**DCL-ENT  2230--CALL     2240--CALL
NODCB
      2229**LABEL    2227--CALLALT
NODCB1
      2239**LABEL    2237--CALLALT
NODCB2
      2249**LABEL    2247--CALLALT
NODCB3
      2258**LABEL    2256--CALLALT
OPEN$USERS_FPT
      1513**DCL      2178<<ASSIGN   2181<>CALL
OPEN$USERS_FPT.ACSVEH_
      1515**DCL      1516--REDEF
OPEN$USERS_FPT.ALTKEYS_
      1521**DCL      1522--REDEF    1522--REDEF
OPEN$USERS_FPT.HDR_
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:214  
      1520**DCL      1521--REDEF
OPEN$USERS_FPT.TAB_
      1519**DCL      1520--REDEF
OPEN$USERS_FPT.UHL_
      1513**DCL      1514--REDEF    1514--REDEF
OPEN$USERS_FPT.V
      1522**DCL      2180--ASSIGN
OPEN$USERS_FPT.V.DCB#
      1522**DCL      2179<<ASSIGN
OPEN$USERS_FPT.V.FSN#
      1553**DCL      1553--REDEF    1553--REDEF
OPEN$USERS_FPT.V_
      1513**DCL      2180<<ASSIGN
OPEN$USERS_FPT.WSN_
      1519**DCL      1519--REDEF
OPEN_ERR
      2183**LABEL    2181--CALLALT
OPEN_USERS_FPT
      1402**DCL      2178>>ASSIGN
OPEN_USERS_FPT.ACSVEH_
      1404**DCL      1405--REDEF
OPEN_USERS_FPT.ALTKEYS_
      1410**DCL      1411--REDEF    1411--REDEF
OPEN_USERS_FPT.HDR_
      1409**DCL      1410--REDEF
OPEN_USERS_FPT.TAB_
      1408**DCL      1409--REDEF
OPEN_USERS_FPT.UHL_
      1402**DCL      1403--REDEF    1403--REDEF
OPEN_USERS_FPT.V
      1411**DCL      1402--DCLINIT
OPEN_USERS_FPT.V.FSN#
      1442**DCL      1442--REDEF    1442--REDEF
OPEN_USERS_FPT.WSN_
      1408**DCL      1408--REDEF
READ$SEQ_FPT
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:215  
      1785**DCL      2167<<ASSIGN   2172<>CALL
READ$SEQ_FPT.BUF_
      1787**DCL      2168<<ASSIGN
READ$SEQ_FPT.KEY_
      1785**DCL      2169<<ASSIGN
READ$SEQ_FPT.STATION_
      1788**DCL      1789--REDEF
READ$SEQ_FPT.V
      1789**DCL      2171--ASSIGN
READ$SEQ_FPT.V.DCB#
      1789**DCL      2170<<ASSIGN
READ$SEQ_FPT.V.DVBYTE.REREAD#
      1800**DCL      1800--REDEF
READ$SEQ_FPT.V.INDX#
      1798**DCL      1798--REDEF
READ$SEQ_FPT.V_
      1785**DCL      2171<<ASSIGN
READ_ERR
      2158**LABEL    2152--CALLALT
READ_SEQ_ERR
      2174**LABEL    2172--CALLALT
READ_SEQ_FPT
      1745**DCL      2167>>ASSIGN
READ_SEQ_FPT.STATION_
      1748**DCL      1749--REDEF
READ_SEQ_FPT.V
      1749**DCL      1745--DCLINIT
READ_SEQ_FPT.V.DVBYTE.REREAD#
      1760**DCL      1760--REDEF
READ_SEQ_FPT.V.INDX#
      1758**DCL      1758--REDEF
READ_USERS_FPT
      1663**DCL      2138>>ASSIGN
READ_USERS_FPT.STATION_
      1666**DCL      1667--REDEF
READ_USERS_FPT.V
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:216  
      1667**DCL      1663--DCLINIT
READ_USERS_FPT.V.DVBYTE.REREAD#
      1678**DCL      1678--REDEF
READ_USERS_FPT.V.INDX#
      1676**DCL      1676--REDEF
RW$USERS
      1155**DCL         7--PROC     2139--ASSIGN   2165--ENTRY    2168--ASSIGN   2185--ENTRY    2190--ASSIGN
RW$USERS.BANNER_PERM
      1270**DCL      1271--REDEF
RW$USERS.BUDGET.MACCT
      1175**DCL      1179--REDEF
RW$USERS.BUDGET.MAX_PROJECTS
      1188**DCL      1191--REDEF
RW$USERS.BUDGET.PACCUM
      1171**DCL      1173--REDEF
RW$USERS.BUDGET.PMAXC
      1166**DCL      1168--REDEF
RW$USERS.SETUP_CHRA.TXT
      1286**DCL      1287--REDEF    1288--REDEF
USERS_KEY
      1320**DCL         7--PROC     2140--ASSIGN   2149--ASSIGN   2161--ASSIGN   2165--ENTRY    2169--ASSIGN
      2185--ENTRY    2191--ASSIGN   2199--ASSIGN   2209--ASSIGN
VLP_STARSNAME
      1990**DCL      2005--DCLINIT
VLP_USERSNAME
      1898**DCL      1913--DCLINIT
WRITE$USERS_FPT
      1857**DCL      2187<<ASSIGN   2192<>CALL
WRITE$USERS_FPT.BUF_
      1857**DCL      2190<<ASSIGN
WRITE$USERS_FPT.KEY_
      1857**DCL      2191<<ASSIGN
WRITE$USERS_FPT.STATION_
      1859**DCL      1859--REDEF
WRITE$USERS_FPT.V
      1860**DCL      2188--ASSIGN
PL6.E3A0      #003=ALA$READ_USERS File=ALA$LOGON.:E05TSI                         TUE 07/29/97 08:29 Page:217  
WRITE$USERS_FPT.V.DCB#
      1860**DCL      2189<<ASSIGN
WRITE$USERS_FPT.V.DVBYTE.VFC#
      1866**DCL      1866--REDEF
WRITE$USERS_FPT.V_
      1857**DCL      2188<<ASSIGN
WRITE_ERR
      2206**LABEL    2192--CALLALT
WRITE_USERS_FPT
      1825**DCL      2187>>ASSIGN
WRITE_USERS_FPT.STATION_
      1827**DCL      1827--REDEF
WRITE_USERS_FPT.V
      1828**DCL      1825--DCLINIT
WRITE_USERS_FPT.V.DVBYTE.VFC#
      1834**DCL      1834--REDEF

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:218  
     1185        1        /*T***********************************************************/
     1186        2        /*T*                                                         */
     1187        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1188        4        /*T*                                                         */
     1189        5        /*T***********************************************************/
     1190        6                                                              /**/
     1191        7        ALA$ERROR: PROC(ERR_CODE, FIELD1, FIELD2, FIELD3) ;
     1192        8                                                              /**/
     1193        9        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:219  
     1194       10        /*********************************************************************/
     1195       11        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1196       12        /*********************************************************************/
     1197       13                                                              /**/
     1198       14    1   DCL 1 ERR_CODE ALIGNED ,
     1199       15    1         2 FCG_MID UBIN(18) UNAL ,
     1200       16    1         2 CODE UBIN(15) UNAL ,
     1201       17    1         2 SEV UBIN(3) UNAL ;
     1202       18    1   DCL 1 FIELD1 ALIGNED ,
     1203       19    1         2 CNT UBIN(9) UNAL ,
     1204       20    1         2 TEXT CHAR(40) UNAL ;
     1205       21    1   DCL 1 FIELD2 ALIGNED ,
     1206       22    1         2 CNT UBIN(9) UNAL ,
     1207       23    1         2 TEXT CHAR(40) UNAL ;
     1208       24    1   DCL 1 FIELD3 ALIGNED ,
     1209       25    1         2 CNT UBIN(9) UNAL ,
     1210       26    1         2 TEXT CHAR(40) UNAL ;
     1211       27        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:220  
     1212       28        /*********************************************************************/
     1213       29        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1214       30        /*********************************************************************/
     1215       31                                                              /**/
     1216       32              %INCLUDE CP_6 ;
     1217      113              %INCLUDE B$JIT ;
     1218      403              %INCLUDE AL_LOGON_R ;
     1219      435              %INCLUDE AL_PERR_C ;
     1220      457              %INCLUDE NK_VFC_C ;
     1221      531        %B$TCB;
     1222      534        %B$ALT;
     1223      542        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:221  
     1224      543        /*********************************************************************/
     1225      544        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1226      545        /*********************************************************************/
     1227      546                                                              /**/
     1228      547              %FPT_ERRMSG(FPTN = FPT_ERRMSG, STCLASS = CONSTANT ,
     1229      548                            SUBMESS = YES ,
     1230      549                            FILEACCT = FILE_ACCT ,
     1231      550                            INCLCODE = NO ,
     1232      551                            VFC = 'a' ,
     1233      552                            OUTDCB1 = M$DO ) ;
     1234      579    1   DCL M$DO DCB ;
     1235      580        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:222  
     1236      581        /*********************************************************************/
     1237      582        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
     1238      583        /*********************************************************************/
     1239      584                                                              /**/
     1240      585              %FPT_ERRMSG(FPTN = FPT$ERRMSG, STCLASS = AUTO ) ;
     1241      612    1   DCL ERR_BUF CHAR(120) ;
     1242      613    1   DCL FILE_ACCT CHAR (8) SYMREF;
     1243      614              %VLR_ERRMSG(FPTN = VLR$ERRMSG, STCLASS = AUTO ) ;
     1244      636              %VLP_ERRCODE( STCLASS=AUTO );
     1245      681        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:223  
     1246      682        /*********************************************************************/
     1247      683        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1248      684        /*********************************************************************/
     1249      685                                                              /**/
     1250      686    1         IF B$JIT.MODE = %M_TP# THEN RETURN;
     1251      687                                                              /*   SET UP FPT$ERRMSG.   */
     1252      688    1         FPT$ERRMSG = FPT_ERRMSG ;
     1253      689    1         VLP_ERRCODE = ERR_CODE;
     1254      690    1         IF ADDR(FIELD1.CNT)~=ADDR(NIL) THEN FPT$ERRMSG.FIELD1_ = VECTOR(FIELD1);
     1255      691    1         IF ADDR(FIELD2.CNT)~=ADDR(NIL) THEN FPT$ERRMSG.FIELD2_ = VECTOR(FIELD2);
     1256      692    1         IF ADDR(FIELD3.CNT)~=ADDR(NIL) THEN FPT$ERRMSG.FIELD3_ = VECTOR(FIELD3);
     1257      693    1         GOTO ERRMSG_COMMON;
     1258      694
     1259      695
     1260      696    1   ALA$SYS_ERROR: ENTRY;
     1261      697
     1262      698    1         IF B$JIT.MODE = %M_TP# THEN RETURN;
     1263      699
     1264      700    1         FPT$ERRMSG = FPT_ERRMSG;
     1265      701    1         VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1266      702    1         FPT$ERRMSG.V.DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;
     1267      703
     1268      704    1   ERRMSG_COMMON:
     1269      705    1         VLP_ERRCODE.SEV = 7;
     1270      706    1         FPT$ERRMSG.CODE_ = VECTOR(VLP_ERRCODE);
     1271      707    1         FPT$ERRMSG.BUF_ = VECTOR(ERR_BUF);
     1272      708    1         FPT$ERRMSG.V_ = VECTOR(FPT$ERRMSG.V);
     1273      709    1         CALL M$ERRMSG(FPT$ERRMSG) ALTRET(ERR_ALT1) ;
     1274      710    1         RETURN ;
     1275      711
     1276      712                                                              /**/
     1277      713    1   ERR_ALT1: ;
     1278      714    1         VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;
     1279      715    1         VLP_ERRCODE.SEV = 7;
     1280      716    1         FPT$ERRMSG.V.DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;
     1281      717    1         CALL M$ERRMSG( FPT$ERRMSG ) ALTRET(ERR_ALT2);
     1282      718    1   ERR_ALT2:;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:224  
     1283      719    1         RETURN ;
     1284      720                                                              /**/
     1285      721    1   END   ALA$ERROR ;
     1286      722        %EOD ;

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:225  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$ERROR.

   Procedure ALA$ERROR requires 84 words for executable code.
   Procedure ALA$ERROR requires 72 words of local(AUTO) storage.

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:226  

 Object Unit name= ALA$ERROR                                  File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:30:55.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     26     32  ALA$ERROR
    2   DCB   even  none     0      0  M$DO
    3   Proc  even  none    84    124  ALA$ERROR
    4  RoData even  none     3      3  ALA$ERROR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        4  ALA$ERROR
     3     36                  yes      Std        0  ALA$SYS_ERROR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:227  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$JIT$                                B$TCB$
     M$DO                                  FILE_ACCT                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:228  


     1185        1        /*T***********************************************************/
     1186        2        /*T*                                                         */
     1187        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1188        4        /*T*                                                         */
     1189        5        /*T***********************************************************/
     1190        6                                                              /**/
     1191        7        ALA$ERROR: PROC(ERR_CODE, FIELD1, FIELD2, FIELD3) ;

      7  3 000000   000000 700200 xent  ALA$ERROR    TSX0  ! X66_AUTO_4
         3 000001   000110 000004                    ZERO    72,4

     1192        8                                                              /**/
     1193        9        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:229  
     1194       10        /*********************************************************************/
     1195       11        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1196       12        /*********************************************************************/
     1197       13                                                              /**/
     1198       14    1   DCL 1 ERR_CODE ALIGNED ,
     1199       15    1         2 FCG_MID UBIN(18) UNAL ,
     1200       16    1         2 CODE UBIN(15) UNAL ,
     1201       17    1         2 SEV UBIN(3) UNAL ;
     1202       18    1   DCL 1 FIELD1 ALIGNED ,
     1203       19    1         2 CNT UBIN(9) UNAL ,
     1204       20    1         2 TEXT CHAR(40) UNAL ;
     1205       21    1   DCL 1 FIELD2 ALIGNED ,
     1206       22    1         2 CNT UBIN(9) UNAL ,
     1207       23    1         2 TEXT CHAR(40) UNAL ;
     1208       24    1   DCL 1 FIELD3 ALIGNED ,
     1209       25    1         2 CNT UBIN(9) UNAL ,
     1210       26    1         2 TEXT CHAR(40) UNAL ;
     1211       27        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:230  
     1212       28        /*********************************************************************/
     1213       29        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1214       30        /*********************************************************************/
     1215       31                                                              /**/
     1216       32              %INCLUDE CP_6 ;
     1217      113              %INCLUDE B$JIT ;
     1218      403              %INCLUDE AL_LOGON_R ;
     1219      435              %INCLUDE AL_PERR_C ;
     1220      457              %INCLUDE NK_VFC_C ;
     1221      531        %B$TCB;
     1222      534        %B$ALT;
     1223      542        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:231  
     1224      543        /*********************************************************************/
     1225      544        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1226      545        /*********************************************************************/
     1227      546                                                              /**/
     1228      547              %FPT_ERRMSG(FPTN = FPT_ERRMSG, STCLASS = CONSTANT ,
     1229      548                            SUBMESS = YES ,
     1230      549                            FILEACCT = FILE_ACCT ,
     1231      550                            INCLCODE = NO ,
     1232      551                            VFC = 'a' ,
     1233      552                            OUTDCB1 = M$DO ) ;
     1234      579    1   DCL M$DO DCB ;
     1235      580        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:232  
     1236      581        /*********************************************************************/
     1237      582        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
     1238      583        /*********************************************************************/
     1239      584                                                              /**/
     1240      585              %FPT_ERRMSG(FPTN = FPT$ERRMSG, STCLASS = AUTO ) ;
     1241      612    1   DCL ERR_BUF CHAR(120) ;
     1242      613    1   DCL FILE_ACCT CHAR (8) SYMREF;
     1243      614              %VLR_ERRMSG(FPTN = VLR$ERRMSG, STCLASS = AUTO ) ;
     1244      636              %VLP_ERRCODE( STCLASS=AUTO );
     1245      681        %EJECT ;
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:233  
     1246      682        /*********************************************************************/
     1247      683        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1248      684        /*********************************************************************/
     1249      685                                                              /**/
     1250      686    1         IF B$JIT.MODE = %M_TP# THEN RETURN;

    686  3 000002   000000 470400 xsym               LDP0    B$JIT$
         3 000003   000000 236100                    LDQ     0,,PR0
         3 000004   740000 376003                    ANQ     -16384,DU
         3 000005   200000 116003                    CMPQ    65536,DU
         3 000006   000010 601000 3                  TNZ     s:688

    686  3 000007   000000 702200 xent               TSX2  ! X66_ARET

     1251      687                                                              /*   SET UP FPT$ERRMSG.   */
     1252      688    1         FPT$ERRMSG = FPT_ERRMSG ;

    688  3 000010   000100 100400                    MLR     fill='000'O
         3 000011   000000 000150 1                  ADSC9   FPT_ERRMSG               cn=0,n=104
         3 000012   200010 000150                    ADSC9   FPT$ERRMSG,,AUTO         cn=0,n=104

     1253      689    1         VLP_ERRCODE = ERR_CODE;

    689  3 000013   200003 471500                    LDP1    @ERR_CODE,,AUTO
         3 000014   100000 236100                    LDQ     0,,PR1
         3 000015   200104 756100                    STQ     VLP_ERRCODE,,AUTO

     1254      690    1         IF ADDR(FIELD1.CNT)~=ADDR(NIL) THEN FPT$ERRMSG.FIELD1_ = VECTOR(FIELD1);

    690  3 000016   200004 236100                    LDQ     @FIELD1,,AUTO
         3 000017   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000020   000023 600000 3                  TZE     s:691

    690  3 000021   000000 235000 4                  LDA     0
         3 000022   200024 757100                    STAQ    FPT$ERRMSG+12,,AUTO

     1255      691    1         IF ADDR(FIELD2.CNT)~=ADDR(NIL) THEN FPT$ERRMSG.FIELD2_ = VECTOR(FIELD2);
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:234  

    691  3 000023   200005 236100                    LDQ     @FIELD2,,AUTO
         3 000024   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000025   000030 600000 3                  TZE     s:692

    691  3 000026   000000 235000 4                  LDA     0
         3 000027   200026 757100                    STAQ    FPT$ERRMSG+14,,AUTO

     1256      692    1         IF ADDR(FIELD3.CNT)~=ADDR(NIL) THEN FPT$ERRMSG.FIELD3_ = VECTOR(FIELD3);

    692  3 000030   200006 236100                    LDQ     @FIELD3,,AUTO
         3 000031   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000032   000035 600000 3                  TZE     s:693

    692  3 000033   000000 235000 4                  LDA     0
         3 000034   200030 757100                    STAQ    FPT$ERRMSG+16,,AUTO

     1257      693    1         GOTO ERRMSG_COMMON;

    693  3 000035   000060 710000 3                  TRA     ERRMSG_COMMON

     1258      694
     1259      695
     1260      696    1   ALA$SYS_ERROR: ENTRY;

    696  3 000036   000000 700200 xent  ALA$SYS_ERR* TSX0  ! X66_AUTO_4
         3 000037   000110 000004                    ZERO    72,4

     1261      697
     1262      698    1         IF B$JIT.MODE = %M_TP# THEN RETURN;

    698  3 000040   000000 470400 xsym               LDP0    B$JIT$
         3 000041   000000 236100                    LDQ     0,,PR0
         3 000042   740000 376003                    ANQ     -16384,DU
         3 000043   200000 116003                    CMPQ    65536,DU
         3 000044   000046 601000 3                  TNZ     s:700

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:235  
    698  3 000045   000000 702200 xent               TSX2  ! X66_ARET

     1263      699
     1264      700    1         FPT$ERRMSG = FPT_ERRMSG;

    700  3 000046   000100 100400                    MLR     fill='000'O
         3 000047   000000 000150 1                  ADSC9   FPT_ERRMSG               cn=0,n=104
         3 000050   200010 000150                    ADSC9   FPT$ERRMSG,,AUTO         cn=0,n=104

     1265      701    1         VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

    701  3 000051   000000 471400 xsym               LDP1    B$TCB$
         3 000052   100000 473500                    LDP3    0,,PR1
         3 000053   300102 236100                    LDQ     66,,PR3
         3 000054   200104 756100                    STQ     VLP_ERRCODE,,AUTO

     1266      702    1         FPT$ERRMSG.V.DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;

    702  3 000055   100000 473500                    LDP3    0,,PR1
         3 000056   300101 720100                    LXL0    65,,PR3
         3 000057   200036 740100                    STX0    FPT$ERRMSG+22,,AUTO

     1267      703
     1268      704    1   ERRMSG_COMMON:
     1269      705    1         VLP_ERRCODE.SEV = 7;

    705  3 000060   000007 236007       ERRMSG_COMM* LDQ     7,DL
         3 000061   200104 256100                    ORSQ    VLP_ERRCODE,,AUTO

     1270      706    1         FPT$ERRMSG.CODE_ = VECTOR(VLP_ERRCODE);

    706  3 000062   777640 235007                    LDA     -96,DL
         3 000063   200106 452500                    STP2    VLP_ERRCODE+2,,AUTO
         3 000064   200106 236100                    LDQ     VLP_ERRCODE+2,,AUTO
         3 000065   000104 036003                    ADLQ    68,DU
         3 000066   200012 757100                    STAQ    FPT$ERRMSG+2,,AUTO

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:236  
     1271      707    1         FPT$ERRMSG.BUF_ = VECTOR(ERR_BUF);

    707  3 000067   000001 235000 4                  LDA     1
         3 000070   200106 452500                    STP2    VLP_ERRCODE+2,,AUTO
         3 000071   200106 236100                    LDQ     VLP_ERRCODE+2,,AUTO
         3 000072   000042 036003                    ADLQ    34,DU
         3 000073   200014 757100                    STAQ    FPT$ERRMSG+4,,AUTO

     1272      708    1         FPT$ERRMSG.V_ = VECTOR(FPT$ERRMSG.V);

    708  3 000074   000002 235000 4                  LDA     2
         3 000075   200106 452500                    STP2    VLP_ERRCODE+2,,AUTO
         3 000076   200106 236100                    LDQ     VLP_ERRCODE+2,,AUTO
         3 000077   000036 036003                    ADLQ    30,DU
         3 000100   200010 757100                    STAQ    FPT$ERRMSG,,AUTO

     1273      709    1         CALL M$ERRMSG(FPT$ERRMSG) ALTRET(ERR_ALT1) ;

    709  3 000101   200010 630500                    EPPR0   FPT$ERRMSG,,AUTO
         3 000102   420000 713400                    CLIMB   alt,+8192
         3 000103   405000 401760                    pmme    nvectors=11
         3 000104   000106 702000 3                  TSX2    ERR_ALT1

     1274      710    1         RETURN ;

    710  3 000105   000000 702200 xent               TSX2  ! X66_ARET

    708  3 000106                       ERR_ALT1     null
     1275      711
     1276      712                                                              /**/
     1277      713    1   ERR_ALT1: ;
     1278      714    1         VLP_ERRCODE = B$TCB$->B$TCB.ALT$->B$ALT.ERR;

    714  3 000106   000000 470400 xsym               LDP0    B$TCB$
         3 000107   000000 471500                    LDP1    0,,PR0
         3 000110   100102 236100                    LDQ     66,,PR1
         3 000111   200104 756100                    STQ     VLP_ERRCODE,,AUTO
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:237  

     1279      715    1         VLP_ERRCODE.SEV = 7;

    715  3 000112   000007 236007                    LDQ     7,DL
         3 000113   200104 256100                    ORSQ    VLP_ERRCODE,,AUTO

     1280      716    1         FPT$ERRMSG.V.DCB# = B$TCB$->B$TCB.ALT$->B$ALT.DCB#;

    716  3 000114   000000 471500                    LDP1    0,,PR0
         3 000115   100101 720100                    LXL0    65,,PR1
         3 000116   200036 740100                    STX0    FPT$ERRMSG+22,,AUTO

     1281      717    1         CALL M$ERRMSG( FPT$ERRMSG ) ALTRET(ERR_ALT2);

    717  3 000117   200010 630500                    EPPR0   FPT$ERRMSG,,AUTO
         3 000120   420000 713400                    CLIMB   alt,+8192
         3 000121   405000 401760                    pmme    nvectors=11
         3 000122   000123 702000 3                  TSX2    ERR_ALT2

    716  3 000123                       ERR_ALT2     null
     1282      718    1   ERR_ALT2:;
     1283      719    1         RETURN ;

    719  3 000123   000000 702200 xent               TSX2  ! X66_ARET
     1284      720                                                              /**/
     1285      721    1   END   ALA$ERROR ;
     1286      722        %EOD ;

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:238  
--  Include file information  --

   NK_VFC_C.:E05TOU  is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$ERROR.
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:239  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$ERROR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(936)   r     1 FPT_ERRMSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ERR_CODE                  4-0-0/w PTR         r     1 @FIELD1
     5-0-0/w PTR         r     1 @FIELD2                    6-0-0/w PTR         r     1 @FIELD3
    42-0-0/c CHAR(120)   r     1 ERR_BUF                   *0-0-0/w STRC        r     1 ERR_CODE
    *0-0-0/w STRC(369)   r     1 FIELD1                    *0-0-0/w STRC(369)   r     1 FIELD2
    *0-0-0/w STRC(369)   r     1 FIELD3                    10-0-0/d STRC(936)   r     1 FPT$ERRMSG
   104-0-0/w STRC        r     1 VLP_ERRCODE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$
     0-0-0/c CHAR(8)     r     1 FILE_ACCT

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0N  NULL        r     1 M$DO

PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:240  

   Procedure ALA$ERROR requires 84 words for executable code.
   Procedure ALA$ERROR requires 72 words of local(AUTO) storage.
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:241  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:242  
          MINI XREF LISTING

B$ALT.CODE
       536**DCL       536--REDEF     537--REDEF     537--REDEF
B$ALT.DCB#
       537**DCL       702>>ASSIGN    716>>ASSIGN
B$ALT.ERR
       537**DCL       701>>ASSIGN    714>>ASSIGN
B$ALT.ERR.ERR#
       538**DCL       538--REDEF
B$ALT.EVID
       537**DCL       537--REDEF     537--REDEF
B$JIT.CPFLAGS1.SLEAZE
       221**DCL       221--REDEF
B$JIT.ERR.MID
       128**DCL       128--REDEF
B$JIT.JRESPEAK
       289**DCL       290--REDEF
B$JIT.MODE
       122**DCL       686>>IF        698>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       398**DCL       398--REDEF     399--REDEF
B$JIT.PNR
       302**DCL       302--REDEF
B$JIT.TSLINE
       396**DCL       397--REDEF
B$JIT$
       433**DCL       122--IMP-PTR   686>>IF        698>>IF
B$TCB.ALT$
       532**DCL       701>>ASSIGN    702>>ASSIGN    714>>ASSIGN    716>>ASSIGN
B$TCB$
       434**DCL       701>>ASSIGN    702>>ASSIGN    714>>ASSIGN    716>>ASSIGN
ERRMSG_COMMON
       705**LABEL     693--GOTO
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:243  
ERR_ALT1
       708**LABEL     709--CALLALT
ERR_ALT2
       716**LABEL     717--CALLALT
ERR_BUF
       612**DCL       707--ASSIGN
ERR_CODE
        14**DCL         7--PROC      689>>ASSIGN
FIELD1
        18**DCL         7--PROC      690--ASSIGN
FIELD1.CNT
        19**DCL       690--IF
FIELD2
        21**DCL         7--PROC      691--ASSIGN
FIELD2.CNT
        22**DCL       691--IF
FIELD3
        24**DCL         7--PROC      692--ASSIGN
FIELD3.CNT
        25**DCL       692--IF
FILE_ACCT
       613**DCL       564--DCLINIT
FPT$ERRMSG
       596**DCL       688<<ASSIGN    700<<ASSIGN    709<>CALL      717<>CALL
FPT$ERRMSG.BUF_
       596**DCL       707<<ASSIGN
FPT$ERRMSG.CODE_
       596**DCL       706<<ASSIGN
FPT$ERRMSG.FIELD1_
       598**DCL       690<<ASSIGN
FPT$ERRMSG.FIELD2_
       599**DCL       691<<ASSIGN
FPT$ERRMSG.FIELD3_
       599**DCL       692<<ASSIGN
FPT$ERRMSG.V
       600**DCL       708--ASSIGN
PL6.E3A0      #004=ALA$ERROR File=ALA$LOGON.:E05TSI                              TUE 07/29/97 08:30 Page:244  
FPT$ERRMSG.V.DCB#
       600**DCL       702<<ASSIGN    716<<ASSIGN
FPT$ERRMSG.V_
       596**DCL       708<<ASSIGN
FPT_ERRMSG
       563**DCL       688>>ASSIGN    700>>ASSIGN
FPT_ERRMSG.V
       567**DCL       563--DCLINIT
M$ERRMSG
       104**DCL-ENT   709--CALL      717--CALL
VLP_ERRCODE
       648**DCL       689<<ASSIGN    701<<ASSIGN    706--ASSIGN    714<<ASSIGN
VLP_ERRCODE.SEV
       678**DCL       705<<ASSIGN    715<<ASSIGN

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:245  
     1287        1        /*T***********************************************************/
     1288        2        /*T*                                                         */
     1289        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1290        4        /*T*                                                         */
     1291        5        /*T***********************************************************/
     1292        6                                                              /**/
     1293        7        ALA$HEADING: PROC( AL$TSTAMP ) ;
     1294        8                                                              /**/
     1295        9        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:246  
     1296       10        /*********************************************************************/
     1297       11        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1298       12        /*********************************************************************/
     1299       13              %INCLUDE CP_6 ;
     1300       94              %INCLUDE AL_SUBS_C ;
     1301      103              %INCLUDE B$JIT ;
     1302      393              %INCLUDE AL_PERR_C ;
     1303      415              %INCLUDE AL_LOGON_R ;
     1304      447              %INCLUDE AL_MACROS_C ;
     1305      473              %INCLUDE B$TABLES_C ;
     1306      581
     1307      582        %B$XL_LOWER_UR;
     1308      586                                                              /**/
     1309      587        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:247  
     1310      588        /*********************************************************************/
     1311      589        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1312      590        /*********************************************************************/
     1313      591                                                              /**/
     1314      592        %LIST ;
     1315      593                                                              /**/
     1316      594              %AL$TSTAMP (STCLASS=" ") ;
               595                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
               596    1         DCL 1 STNAME STCLASS ,
               597    1               2 UTS UBIN WORD ,
               598    1               2 TIME CHAR(11) UNAL ,
               599    1               2 DAY  CHAR(3) UNAL ,
               600    1               2 DATE CHAR(10) UNAL ;
     1317      602                                                              /**/
     1318      603        %PLIST ;
     1319      604        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:248  
     1320      605        /*********************************************************************/
     1321      606        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
     1322      607        /*********************************************************************/
     1323      608                                                              /**/
     1324      609    1   DCL 1 ERR_CODE AUTO ,
     1325      610    1         2 FCG_MID UBIN(18) UNAL ,
     1326      611    1         2 CODE UBIN(15) UNAL ,
     1327      612    1         2 SEV UBIN(3) UNAL ;
     1328      613    1   DCL 1 TMDATE ALIGNED ,
     1329      614    1         2 CNT UBIN(9) UNAL ,
     1330      615    1         2 BUFF UNAL ,
     1331      616    1           3 TIME CHAR(5) UNAL ,
     1332      617    1           3 * CHAR(1) UNAL ,
     1333      618    1           3 DAY CHAR(3) UNAL ,
     1334      619    1           3 * CHAR(1) UNAL ,
     1335      620    1           3 DATE CHAR(10) UNAL ,
     1336      621    1         2 RDEF_BUFF REDEF BUFF CHAR(20) ;
     1337      622    1   DCL 1 SYSID ALIGNED ,
     1338      623    1         2 CNT UBIN BYTE UNAL ,
     1339      624    1         2 TXT CHAR(6) UNAL ;
     1340      625    1   DCL TBUF CHAR(6) ;
     1341      626    1   DCL CNT UBIN WORD ;
     1342      627    1   DCL I UBIN WORD ;
     1343      628        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:249  
     1344      629        /*********************************************************************/
     1345      630        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1346      631        /*********************************************************************/
     1347      632                                                              /**/
     1348      633    1   DCL FCG UBIN(18) CONSTANT INIT(4865) ;          /*   'ALA' IN SIX-BIT.   */
     1349      634              %FPT_OCMSG (  FPTN = FPT_OCMSG ,
     1350      635                            MSG = ON_MESSAGE_VAL ,
     1351      636                            OCTYPE = ADCOM ,
     1352      637                            STCLASS = CONSTANT ) ;
     1353      653        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:250  
     1354      654        /*********************************************************************/
     1355      655        /*   FPTs            FPTs            FPTs            FPTs            */
     1356      656        /*********************************************************************/
     1357      657                                                              /**/
     1358      658              %FPT_MONINFO( FPTN = FPT_MONINFO ,
     1359      659                            STCLASS = CONSTANT ) ;
     1360      674              %FPT_MONINFO( FPTN = FPT$MONINFO ,
     1361      675                            STCLASS = AUTO ) ;
     1362      690              %VLR_SITEINFO(  FPTN = VLR_SITEINFO ,
     1363      691                              STCLASS = AUTO ) ;
     1364      710        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:251  
     1365      711        /*********************************************************************/
     1366      712        /*   ENTRIES         ENTRIES         ENTRIES         ENTRIES         */
     1367      713        /*********************************************************************/
     1368      714                                                              /**/
     1369      715    1   DCL ALA$ERROR ENTRY(4) ;
     1370      716        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:252  
     1371      717        /*********************************************************************/
     1372      718        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1373      719        /*********************************************************************/
     1374      720                                                              /**/
     1375      721    2         IF B$JIT.MODE = %M_INT# THEN DO;          /* Write heading */
     1376      722                                                              /**/
     1377      723    2             TMDATE.RDEF_BUFF = AL_BLANK ;          /*   Blank fill time buffer. */
     1378      724    2             TMDATE.BUFF.TIME = SUBSTR (AL$TSTAMP.TIME, 0, 5);
     1379      725
     1380      726    2             TMDATE.BUFF.DAY  = AL$TSTAMP.DAY  ;
     1381      727    2             CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE.BUFF.DAY);
     1382      728    2             SUBSTR (TMDATE.BUFF.DAY, 1, 2) = SUBSTR (TBUF, 1, 2);
     1383      729
     1384      730    2             TMDATE.BUFF.DATE = AL$TSTAMP.DATE ;
     1385      731    2             CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE. BUFF.DATE);
     1386      732    2             SUBSTR (TMDATE.BUFF.DATE, 1, 2) = SUBSTR (TBUF, 1, 2);
     1387      733
     1388      734    2             TMDATE.CNT = 20;
     1389      735                                                                  /**/
     1390      736    2             CALL BINCHAR( TBUF, B$JIT.SYSID ) ;
     1391      737    2             I = 0 ;
     1392      738    3             DO WHILE( I < 6  AND  SUBSTR(TBUF,I,1) = '0' ) ;
     1393      739    3                 I = I + 1 ;
     1394      740    3                 END ;
     1395      741                                                                  /**/
     1396      742    2             SYSID.CNT = 6 - I ;
     1397      743    2             SYSID.TXT = SUBSTR( TBUF, I ) ;
     1398      744                                                                 /* Pick up site info */
     1399      745    2             FPT$MONINFO = FPT_MONINFO ;
     1400      746    2             FPT$MONINFO.SITEINFO_ = VECTOR( VLR_SITEINFO ) ;
     1401      747    2             CALL M$MONINFO( FPT$MONINFO ) ALTRET( MONINFO_ERR ) ;
     1402      748    2   MONINFO_ERR: ;
     1403      749        /*E*  ERROR:    ALA-E$HEADING-C
     1404      750              MESSAGE:  *** %Sysid %U1% %on %U2% at %U3.
     1405      751
     1406      752        */
     1407      753    2             ERR_CODE.CODE = E$HEADING ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:253  
     1408      754    2             ERR_CODE.FCG_MID = FCG ;
     1409      755    2             ERR_CODE.SEV = 0 ;
     1410      756    2             IF NOT B$JIT.BLINDACCTNG
     1411      757    3             THEN DO;  /* BLINDACCTNG is used to pass the NOHEADER option
     1412      758                               from the main routine for logon strings. */
     1413      759    3                 CALL ALA$ERROR( ERR_CODE, SYSID, VLR_SITEINFO.SITE_NAME#, TMDATE ) ;
     1414      760    3                 END;
     1415      761                                                              /**/
     1416      762        /*E*  ERROR:    ALA-E$SYS_MESSAGE-C
     1417      763              MESSAGE:
     1418      764        */
     1419      765    2             ERR_CODE.CODE = E$SYS_MESSAGE ;
     1420      766    2             IF NOT B$JIT.BLINDACCTNG
     1421      767    3             THEN DO;  /* See above */
     1422      768    3                 CALL ALA$ERROR( ERR_CODE ) ;
     1423      769    3                 B$JIT.RERUN = '0'B;
     1424      770    3                 END;
     1425      771    2             END;
     1426      772                                                          /* Write message to OC */
     1427      773    1         CALL M$OCMSG ( FPT_OCMSG ) ;
     1428      774                                                              /**/
     1429      775    1         RETURN ;
     1430      776    1   END   ALA$HEADING ;
     1431      777        %EOD ;

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:254  
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   AL_MACROS_C.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AL_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$HEADING.

   Procedure ALA$HEADING requires 126 words for executable code.
   Procedure ALA$HEADING requires 96 words of local(AUTO) storage.

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:255  

 Object Unit name= ALA$HEADING                                File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:31:26.44 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     24     30  ALA$HEADING
    2   Proc  even  none   126    176  ALA$HEADING
    3  RoData even  none     5      5  ALA$HEADING

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  ALA$HEADING

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 B_POINTER
         yes           Std       4 ALA$ERROR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:256  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  AL_BLANK                              B$JIT$
r    B$XL_LOWER_UR$                        B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:257  


     1287        1        /*T***********************************************************/
     1288        2        /*T*                                                         */
     1289        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1290        4        /*T*                                                         */
     1291        5        /*T***********************************************************/
     1292        6                                                              /**/
     1293        7        ALA$HEADING: PROC( AL$TSTAMP ) ;

      7  2 000000   000000 700200 xent  ALA$HEADING  TSX0  ! X66_AUTO_1
         2 000001   000140 000001                    ZERO    96,1

     1294        8                                                              /**/
     1295        9        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:258  
     1296       10        /*********************************************************************/
     1297       11        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1298       12        /*********************************************************************/
     1299       13              %INCLUDE CP_6 ;
     1300       94              %INCLUDE AL_SUBS_C ;
     1301      103              %INCLUDE B$JIT ;
     1302      393              %INCLUDE AL_PERR_C ;
     1303      415              %INCLUDE AL_LOGON_R ;
     1304      447              %INCLUDE AL_MACROS_C ;
     1305      473              %INCLUDE B$TABLES_C ;
     1306      581
     1307      582        %B$XL_LOWER_UR;
     1308      586                                                              /**/
     1309      587        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:259  
     1310      588        /*********************************************************************/
     1311      589        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1312      590        /*********************************************************************/
     1313      591                                                              /**/
     1314      592        %LIST ;
     1315      593                                                              /**/
     1316      594              %AL$TSTAMP (STCLASS=" ") ;
               595                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
               596    1         DCL 1 STNAME STCLASS ,
               597    1               2 UTS UBIN WORD ,
               598    1               2 TIME CHAR(11) UNAL ,
               599    1               2 DAY  CHAR(3) UNAL ,
               600    1               2 DATE CHAR(10) UNAL ;
     1317      602                                                              /**/
     1318      603        %PLIST ;
     1319      604        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:260  
     1320      605        /*********************************************************************/
     1321      606        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
     1322      607        /*********************************************************************/
     1323      608                                                              /**/
     1324      609    1   DCL 1 ERR_CODE AUTO ,
     1325      610    1         2 FCG_MID UBIN(18) UNAL ,
     1326      611    1         2 CODE UBIN(15) UNAL ,
     1327      612    1         2 SEV UBIN(3) UNAL ;
     1328      613    1   DCL 1 TMDATE ALIGNED ,
     1329      614    1         2 CNT UBIN(9) UNAL ,
     1330      615    1         2 BUFF UNAL ,
     1331      616    1           3 TIME CHAR(5) UNAL ,
     1332      617    1           3 * CHAR(1) UNAL ,
     1333      618    1           3 DAY CHAR(3) UNAL ,
     1334      619    1           3 * CHAR(1) UNAL ,
     1335      620    1           3 DATE CHAR(10) UNAL ,
     1336      621    1         2 RDEF_BUFF REDEF BUFF CHAR(20) ;
     1337      622    1   DCL 1 SYSID ALIGNED ,
     1338      623    1         2 CNT UBIN BYTE UNAL ,
     1339      624    1         2 TXT CHAR(6) UNAL ;
     1340      625    1   DCL TBUF CHAR(6) ;
     1341      626    1   DCL CNT UBIN WORD ;
     1342      627    1   DCL I UBIN WORD ;
     1343      628        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:261  
     1344      629        /*********************************************************************/
     1345      630        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1346      631        /*********************************************************************/
     1347      632                                                              /**/
     1348      633    1   DCL FCG UBIN(18) CONSTANT INIT(4865) ;          /*   'ALA' IN SIX-BIT.   */
     1349      634              %FPT_OCMSG (  FPTN = FPT_OCMSG ,
     1350      635                            MSG = ON_MESSAGE_VAL ,
     1351      636                            OCTYPE = ADCOM ,
     1352      637                            STCLASS = CONSTANT ) ;
     1353      653        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:262  
     1354      654        /*********************************************************************/
     1355      655        /*   FPTs            FPTs            FPTs            FPTs            */
     1356      656        /*********************************************************************/
     1357      657                                                              /**/
     1358      658              %FPT_MONINFO( FPTN = FPT_MONINFO ,
     1359      659                            STCLASS = CONSTANT ) ;
     1360      674              %FPT_MONINFO( FPTN = FPT$MONINFO ,
     1361      675                            STCLASS = AUTO ) ;
     1362      690              %VLR_SITEINFO(  FPTN = VLR_SITEINFO ,
     1363      691                              STCLASS = AUTO ) ;
     1364      710        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:263  
     1365      711        /*********************************************************************/
     1366      712        /*   ENTRIES         ENTRIES         ENTRIES         ENTRIES         */
     1367      713        /*********************************************************************/
     1368      714                                                              /**/
     1369      715    1   DCL ALA$ERROR ENTRY(4) ;
     1370      716        %EJECT ;
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:264  
     1371      717        /*********************************************************************/
     1372      718        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1373      719        /*********************************************************************/
     1374      720                                                              /**/
     1375      721    2         IF B$JIT.MODE = %M_INT# THEN DO;          /* Write heading */

    721  2 000002   000000 470400 xsym               LDP0    B$JIT$
         2 000003   000000 236100                    LDQ     0,,PR0
         2 000004   740000 376003                    ANQ     -16384,DU
         2 000005   140000 116003                    CMPQ    49152,DU
         2 000006   000172 601000 2                  TNZ     s:773

     1376      722                                                              /**/
     1377      723    2             TMDATE.RDEF_BUFF = AL_BLANK ;          /*   Blank fill time buffer. */

    723  2 000007   040100 100400                    MLR     fill='040'O
         2 000010   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000011   200005 200024                    ADSC9   TMDATE,,AUTO             cn=1,n=20

     1378      724    2             TMDATE.BUFF.TIME = SUBSTR (AL$TSTAMP.TIME, 0, 5);

    724  2 000012   200003 471500                    LDP1    @AL$TSTAMP,,AUTO
         2 000013   040100 100500                    MLR     fill='040'O
         2 000014   100001 000005                    ADSC9   1,,PR1                   cn=0,n=5
         2 000015   200005 200005                    ADSC9   TMDATE,,AUTO             cn=1,n=5

     1379      725
     1380      726    2             TMDATE.BUFF.DAY  = AL$TSTAMP.DAY  ;

    726  2 000016   040100 100500                    MLR     fill='040'O
         2 000017   100003 600003                    ADSC9   3,,PR1                   cn=3,n=3
         2 000020   200006 600003                    ADSC9   TMDATE+1,,AUTO           cn=3,n=3

     1381      727    2             CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE.BUFF.DAY);

    727  2 000021   000000 473400 xsym               LDP3    B$XL_LOWER_UR$
         2 000022   040100 160500                    MVT     fill='040'O
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:265  
         2 000023   200006 600003                    ADSC9   TMDATE+1,,AUTO           cn=3,n=3
         2 000024   200015 000006                    ADSC9   TBUF,,AUTO               cn=0,n=6
         2 000025   300000 000100                    ARG     0,,PR3

     1382      728    2             SUBSTR (TMDATE.BUFF.DAY, 1, 2) = SUBSTR (TBUF, 1, 2);

    728  2 000026   040100 100500                    MLR     fill='040'O
         2 000027   200015 200002                    ADSC9   TBUF,,AUTO               cn=1,n=2
         2 000030   200134 000004                    ADSC9   VLR_SITEINFO+62,,AUTO    cn=0,n=4
         2 000031   200134 220100                    LDX0    VLR_SITEINFO+62,,AUTO
         2 000032   200007 740100                    STX0    TMDATE+2,,AUTO

     1383      729
     1384      730    2             TMDATE.BUFF.DATE = AL$TSTAMP.DATE ;

    730  2 000033   040100 100500                    MLR     fill='040'O
         2 000034   100004 400012                    ADSC9   4,,PR1                   cn=2,n=10
         2 000035   200007 600012                    ADSC9   TMDATE+2,,AUTO           cn=3,n=10

     1385      731    2             CALL XLATE (TBUF, B$XL_LOWER_UR, TMDATE. BUFF.DATE);

    731  2 000036   040100 160500                    MVT     fill='040'O
         2 000037   200007 600012                    ADSC9   TMDATE+2,,AUTO           cn=3,n=10
         2 000040   200015 000006                    ADSC9   TBUF,,AUTO               cn=0,n=6
         2 000041   300000 000100                    ARG     0,,PR3

     1386      732    2             SUBSTR (TMDATE.BUFF.DATE, 1, 2) = SUBSTR (TBUF, 1, 2);

    732  2 000042   040100 100500                    MLR     fill='040'O
         2 000043   200015 200002                    ADSC9   TBUF,,AUTO               cn=1,n=2
         2 000044   200134 000004                    ADSC9   VLR_SITEINFO+62,,AUTO    cn=0,n=4
         2 000045   200134 221100                    LDX1    VLR_SITEINFO+62,,AUTO
         2 000046   200010 741100                    STX1    TMDATE+3,,AUTO

     1387      733
     1388      734    2             TMDATE.CNT = 20;

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:266  
    734  2 000047   024000 236003                    LDQ     10240,DU
         2 000050   200005 552140                    STBQ    TMDATE,'40'O,AUTO

     1389      735                                                                  /**/
     1390      736    2             CALL BINCHAR( TBUF, B$JIT.SYSID ) ;

    736  2 000051   000000 236100                    LDQ     0,,PR0
         2 000052   777777 376007                    ANQ     -1,DL
         2 000053   000000 235003                    LDA     0,DU
         2 000054   200134 757100                    STAQ    VLR_SITEINFO+62,,AUTO
         2 000055   000100 301500                    BTD
         2 000056   200134 000010                    NDSC9   VLR_SITEINFO+62,,AUTO    cn=0,s=lsgnf,sf=0,n=8
         2 000057   200015 030006                    NDSC9   TBUF,,AUTO               cn=0,s=nosgn,sf=0,n=6

     1391      737    2             I = 0 ;

    737  2 000060   200020 450100                    STZ     I,,AUTO

     1392      738    3             DO WHILE( I < 6  AND  SUBSTR(TBUF,I,1) = '0' ) ;

    738  2 000061   000065 710000 2                  TRA     s:740

     1393      739    3                 I = I + 1 ;

    739  2 000062   200020 235100                    LDA     I,,AUTO
         2 000063   000001 035007                    ADLA    1,DL
         2 000064   200020 755100                    STA     I,,AUTO

     1394      740    3                 END ;

    740  2 000065   200020 235100                    LDA     I,,AUTO
         2 000066   000006 115007                    CMPA    6,DL
         2 000067   000074 603000 2                  TRC     s:742
         2 000070   040000 106505                    CMPC    fill='040'O
         2 000071   200015 000001                    ADSC9   TBUF,A,AUTO              cn=0,n=1
         2 000072   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000073   000062 600000 2                  TZE     s:739
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:267  

     1395      741                                                                  /**/
     1396      742    2             SYSID.CNT = 6 - I ;

    742  2 000074   000006 236007                    LDQ     6,DL
         2 000075   200020 136100                    SBLQ    I,,AUTO
         2 000076   000033 736000                    QLS     27
         2 000077   200013 552140                    STBQ    SYSID,'40'O,AUTO

     1397      743    2             SYSID.TXT = SUBSTR( TBUF, I ) ;

    743  2 000100   777771 620005                    EAX0    -7,AL
         2 000101   777777 660003                    ERX0    -1,DU
         2 000102   040100 100545                    MLR     fill='040'O
         2 000103   200015 000010                    ADSC9   TBUF,A,AUTO              cn=0,n=*X0
         2 000104   200013 200006                    ADSC9   SYSID,,AUTO              cn=1,n=6

     1398      744                                                                 /* Pick up site info */
     1399      745    2             FPT$MONINFO = FPT_MONINFO ;

    745  2 000105   000100 100400                    MLR     fill='000'O
         2 000106   000014 000060 1                  ADSC9   FPT_MONINFO              cn=0,n=48
         2 000107   200022 000060                    ADSC9   FPT$MONINFO,,AUTO        cn=0,n=48

     1400      746    2             FPT$MONINFO.SITEINFO_ = VECTOR( VLR_SITEINFO ) ;

    746  2 000110   000001 235000 3                  LDA     1
         2 000111   200134 452500                    STP2    VLR_SITEINFO+62,,AUTO
         2 000112   200134 236100                    LDQ     VLR_SITEINFO+62,,AUTO
         2 000113   000036 036003                    ADLQ    30,DU
         2 000114   200022 757100                    STAQ    FPT$MONINFO,,AUTO

     1401      747    2             CALL M$MONINFO( FPT$MONINFO ) ALTRET( MONINFO_ERR ) ;

    747  2 000115   200022 630500                    EPPR0   FPT$MONINFO,,AUTO
         2 000116   420023 713400                    CLIMB   alt,+8211
         2 000117   402400 401760                    pmme    nvectors=6
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:268  
         2 000120   000121 702000 2                  TSX2    MONINFO_ERR

    746  2 000121                       MONINFO_ERR  null
     1402      748    2   MONINFO_ERR: ;
     1403      749        /*E*  ERROR:    ALA-E$HEADING-C
     1404      750              MESSAGE:  *** %Sysid %U1% %on %U2% at %U3.
     1405      751
     1406      752        */
     1407      753    2             ERR_CODE.CODE = E$HEADING ;

    753  2 000121   200004 236100                    LDQ     ERR_CODE,,AUTO
         2 000122   000002 376000 3                  ANQ     2
         2 000123   000030 276007                    ORQ     24,DL
         2 000124   200004 756100                    STQ     ERR_CODE,,AUTO

     1408      754    2             ERR_CODE.FCG_MID = FCG ;

    754  2 000125   000000 220000 1                  LDX0    FCG
         2 000126   200004 740100                    STX0    ERR_CODE,,AUTO

     1409      755    2             ERR_CODE.SEV = 0 ;

    755  2 000127   000003 236000 3                  LDQ     3
         2 000130   200004 356100                    ANSQ    ERR_CODE,,AUTO

     1410      756    2             IF NOT B$JIT.BLINDACCTNG

    756  2 000131   000000 470400 xsym               LDP0    B$JIT$
         2 000132   000153 236100                    LDQ     107,,PR0
         2 000133   400000 316007                    CANQ    -131072,DL
         2 000134   000151 601000 2                  TNZ     s:765

     1411      757    3             THEN DO;  /* BLINDACCTNG is used to pass the NOHEADER option

     1412      758                               from the main routine for logon strings. */
     1413      759    3                 CALL ALA$ERROR( ERR_CODE, SYSID, VLR_SITEINFO.SITE_NAME#, TMDATE ) ;

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:269  
    759  2 000135   200005 631500                    EPPR1   TMDATE,,AUTO
         2 000136   200137 451500                    STP1    VLR_SITEINFO+65,,AUTO
         2 000137   200037 633500                    EPPR3   VLR_SITEINFO+1,,AUTO
         2 000140   200136 453500                    STP3    VLR_SITEINFO+64,,AUTO
         2 000141   200013 634500                    EPPR4   SYSID,,AUTO
         2 000142   200135 454500                    STP4    VLR_SITEINFO+63,,AUTO
         2 000143   200004 635500                    EPPR5   ERR_CODE,,AUTO
         2 000144   200134 455500                    STP5    VLR_SITEINFO+62,,AUTO
         2 000145   200134 630500                    EPPR0   VLR_SITEINFO+62,,AUTO
         2 000146   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000147   000000 701000 xent               TSX1    ALA$ERROR
         2 000150   000000 011000                    NOP     0

     1414      760    3                 END;

     1415      761                                                              /**/
     1416      762        /*E*  ERROR:    ALA-E$SYS_MESSAGE-C
     1417      763              MESSAGE:
     1418      764        */
     1419      765    2             ERR_CODE.CODE = E$SYS_MESSAGE ;

    765  2 000151   200004 236100                    LDQ     ERR_CODE,,AUTO
         2 000152   000002 376000 3                  ANQ     2
         2 000153   000100 276007                    ORQ     64,DL
         2 000154   200004 756100                    STQ     ERR_CODE,,AUTO

     1420      766    2             IF NOT B$JIT.BLINDACCTNG

    766  2 000155   000000 470400 xsym               LDP0    B$JIT$
         2 000156   000153 236100                    LDQ     107,,PR0
         2 000157   400000 316007                    CANQ    -131072,DL
         2 000160   000172 601000 2                  TNZ     s:773

     1421      767    3             THEN DO;  /* See above */

     1422      768    3                 CALL ALA$ERROR( ERR_CODE ) ;

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:270  
    768  2 000161   200004 631500                    EPPR1   ERR_CODE,,AUTO
         2 000162   200134 451500                    STP1    VLR_SITEINFO+62,,AUTO
         2 000163   200134 630500                    EPPR0   VLR_SITEINFO+62,,AUTO
         2 000164   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000165   000000 701000 xent               TSX1    ALA$ERROR
         2 000166   000000 011000                    NOP     0

     1423      769    3                 B$JIT.RERUN = '0'B;

    769  2 000167   000000 470400 xsym               LDP0    B$JIT$
         2 000170   000004 236000 3                  LDQ     4
         2 000171   000302 356100                    ANSQ    194,,PR0

     1424      770    3                 END;

     1425      771    2             END;

     1426      772                                                          /* Write message to OC */
     1427      773    1         CALL M$OCMSG ( FPT_OCMSG ) ;

    773  2 000172   000002 630400 1                  EPPR0   FPT_OCMSG
         2 000173   120001 713400                    CLIMB   40961
         2 000174   401000 401760                    pmme    nvectors=3

     1428      774                                                              /**/
     1429      775    1         RETURN ;

    775  2 000175   000000 702200 xent               TSX2  ! X66_ARET
     1430      776    1   END   ALA$HEADING ;
     1431      777        %EOD ;

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:271  
--  Include file information  --

   B$TABLES_C.:E05TOU  cannot be made into a system file and is referenced.
   AL_MACROS_C.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   AL_PERR_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   AL_SUBS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$HEADING.
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:272  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$HEADING

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN(18)    r     1 FCG                       14-0-0/d STRC(432)   r     1 FPT_MONINFO
     2-0-0/d STRC(360)   r     1 FPT_OCMSG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @AL$TSTAMP                *0-0-0/w STRC(252)   r     1 AL$TSTAMP
     4-0-0/b STRC        r     1 ERR_CODE                  22-0-0/d STRC(432)   r     1 FPT$MONINFO
    20-0-0/w UBIN        r     1 I                         13-0-0/w STRC(63)    r     1 SYSID
    15-0-0/c CHAR(6)     r     1 TBUF                       5-0-0/w STRC(189)   r     1 TMDATE
    36-0-0/d STRC(2232)  r     1 VLR_SITEINFO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AL_BLANK                   0-0-0/w PTR         r     1 B$JIT$
     0-0-0/w PTR         r     1 B$XL_LOWER_UR$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/d STRC(4608)  r     1 B$XL_LOWER_UR

PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:273  

   Procedure ALA$HEADING requires 126 words for executable code.
   Procedure ALA$HEADING requires 96 words of local(AUTO) storage.
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:274  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:275  
          MINI XREF LISTING

AL$TSTAMP
       596**DCL         7--PROC
AL$TSTAMP.DATE
       600**DCL       730>>ASSIGN
AL$TSTAMP.DAY
       599**DCL       726>>ASSIGN
AL$TSTAMP.TIME
       598**DCL       724>>ASSIGN
ALA$ERROR
       715**DCL-ENT   759--CALL      768--CALL
AL_BLANK
       429**DCL       723>>ASSIGN
B$JIT.BLINDACCTNG
       265**DCL       756>>IF        766>>IF
B$JIT.CPFLAGS1.SLEAZE
       211**DCL       211--REDEF
B$JIT.ERR.MID
       118**DCL       118--REDEF
B$JIT.JRESPEAK
       279**DCL       280--REDEF
B$JIT.MODE
       112**DCL       721>>IF
B$JIT.ORIGINATOR_PORT.FROM_CR
       388**DCL       388--REDEF     389--REDEF
B$JIT.PNR
       292**DCL       292--REDEF
B$JIT.RERUN
       292**DCL       769<<ASSIGN
B$JIT.SYSID
       117**DCL       736>>CALLBLT
B$JIT.TSLINE
       386**DCL       387--REDEF
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:276  
B$JIT$
       445**DCL       112--IMP-PTR   721>>IF        736>>CALLBLT   756>>IF        766>>IF        769>>ASSIGN
B$XL_LOWER_UR
       584**DCL       727>>CALLBLT   731>>CALLBLT
B$XL_LOWER_UR$
       583**DCL       584--IMP-PTR   727>>CALLBLT   731>>CALLBLT
ERR_CODE
       609**DCL       759<>CALL      768<>CALL
ERR_CODE.CODE
       611**DCL       753<<ASSIGN    765<<ASSIGN
ERR_CODE.FCG_MID
       610**DCL       754<<ASSIGN
ERR_CODE.SEV
       612**DCL       755<<ASSIGN
FCG
       633**DCL       754>>ASSIGN
FPT$MONINFO
       686**DCL       745<<ASSIGN    747<>CALL
FPT$MONINFO.SITEINFO_
       686**DCL       746<<ASSIGN
FPT_MONINFO
       670**DCL       745>>ASSIGN
FPT_OCMSG
       648**DCL       773<>CALL
FPT_OCMSG.V
       649**DCL       648--DCLINIT
I
       627**DCL       737<<ASSIGN    738>>DOWHILE   738>>DOWHILE   739<<ASSIGN    739>>ASSIGN    742>>ASSIGN
       743>>ASSIGN
M$MONINFO
        90**DCL-ENT   747--CALL
M$OCMSG
        86**DCL-ENT   773--CALL
MONINFO_ERR
       746**LABEL     747--CALLALT
SYSID
PL6.E3A0      #005=ALA$HEADING File=ALA$LOGON.:E05TSI                            TUE 07/29/97 08:31 Page:277  
       622**DCL       759<>CALL
SYSID.CNT
       623**DCL       742<<ASSIGN
SYSID.TXT
       624**DCL       743<<ASSIGN
TBUF
       625**DCL       727<<CALLBLT   728>>ASSIGN    731<<CALLBLT   732>>ASSIGN    736<<CALLBLT   738>>DOWHILE
       743>>ASSIGN
TMDATE
       613**DCL       759<>CALL
TMDATE.BUFF
       615**DCL       621--REDEF
TMDATE.BUFF.DATE
       620**DCL       730<<ASSIGN    731>>CALLBLT   732<<ASSIGN
TMDATE.BUFF.DAY
       618**DCL       726<<ASSIGN    727>>CALLBLT   728<<ASSIGN
TMDATE.BUFF.TIME
       616**DCL       724<<ASSIGN
TMDATE.CNT
       614**DCL       734<<ASSIGN
TMDATE.RDEF_BUFF
       621**DCL       723<<ASSIGN
VLR_SITEINFO
       702**DCL       746--ASSIGN
VLR_SITEINFO.SITE_NAME#
       702**DCL       759<>CALL

PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:278  
     1432        1        /*T***********************************************************/
     1433        2        /*T*                                                         */
     1434        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1435        4        /*T*                                                         */
     1436        5        /*T***********************************************************/
     1437        6        ALA$TIME: PROC( AL$TSTAMP ) ;
     1438        7                                                              /**/
     1439        8        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:279  
     1440        9        /*********************************************************************/
     1441       10        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1442       11        /*********************************************************************/
     1443       12                                                              /**/
     1444       13              %INCLUDE CP_6 ;
     1445       94              %INCLUDE AL_MACROS_C ;
     1446      120              %INCLUDE AL_LOGON_R ;
     1447      152              %INCLUDE CP_6_SUBS;
     1448      692        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:280  
     1449      693        /*********************************************************************/
     1450      694        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1451      695        /*********************************************************************/
     1452      696                                                              /**/
     1453      697        %LIST ;
     1454      698                                                              /**/
     1455      699              %AL$TSTAMP (STNAME=AL$TSTAMP,STCLASS=" ") ;
               700                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
               701    1         DCL 1 STNAME STCLASS ,
               702    1               2 UTS UBIN WORD ,
               703    1               2 TIME CHAR(11) UNAL ,
               704    1               2 DAY  CHAR(3) UNAL ,
               705    1               2 DATE CHAR(10) UNAL ;
     1456      707                                                              /**/
     1457      708        %PLIST ;
     1458      709        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:281  
     1459      710        /*********************************************************************/
     1460      711        /*   FPTs            FPTs            FPTs            FPTs            */
     1461      712        /*********************************************************************/
     1462      713                                                              /**/
     1463      714              %FPT_TIME ( FPTN = FPT_TIME ,
     1464      715                          STCLASS = CONSTANT ) ;
     1465      734              %FPT_TIME ( FPTN = FPT$TIME ,
     1466      735                          STCLASS = AUTO ) ;
     1467      754        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:282  
     1468      755        /*********************************************************************/
     1469      756        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1470      757        /*********************************************************************/
     1471      758                                                              /**/
     1472      759    1         AL$TSTAMP.TIME = AL_BLANK ;
     1473      760    1         AL$TSTAMP.DAY  = AL_BLANK ;
     1474      761    1         AL$TSTAMP.DATE = AL_BLANK ;
     1475      762                                                            /*   SET UP FPT FOR M$TIME.   */
     1476      763    1         FPT$TIME = FPT_TIME ;
     1477      764    1         FPT$TIME.TIME_ = VECTOR( AL$TSTAMP.TIME ) ;
     1478      765    1         FPT$TIME.DAY_  = VECTOR( AL$TSTAMP.DAY  ) ;
     1479      766    1         FPT$TIME.DATE_ = VECTOR( AL$TSTAMP.DATE ) ;
     1480      767    1         FPT$TIME.TSTAMP_ = VECTOR( AL$TSTAMP.UTS ) ;
     1481      768    1         FPT$TIME.V_    = VECTOR( FPT$TIME.V     ) ;
     1482      769    1         IF AL$TSTAMP.UTS ~= 0
     1483      770    1         THEN
     1484      771    1             FPT$TIME.V.SOURCE# = %UTS#;
     1485      772                                                              /*   GET THE TIME.   */
     1486      773    1         CALL M$TIME( FPT$TIME )  ALTRET( TIME_ERR ) ;
     1487      774                                                              /**/
     1488      775    1         RETURN ;
     1489      776    1   TIME_ERR: ;
     1490      777    1         RETURN ;
     1491      778                                                              /**/
     1492      779    1   END   ALA$TIME ;
     1493      780        %EOD ;

PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:283  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   AL_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$TIME.

   Procedure ALA$TIME requires 45 words for executable code.
   Procedure ALA$TIME requires 18 words of local(AUTO) storage.

PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:284  

 Object Unit name= ALA$TIME                                   File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:31:55.24 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     12     14  ALA$TIME
    2   Proc  even  none    45     55  ALA$TIME
    3  RoData even  none     5      5  ALA$TIME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        1  ALA$TIME

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  AL_BLANK
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:285  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:286  


     1432        1        /*T***********************************************************/
     1433        2        /*T*                                                         */
     1434        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1435        4        /*T*                                                         */
     1436        5        /*T***********************************************************/
     1437        6        ALA$TIME: PROC( AL$TSTAMP ) ;

      6  2 000000   000000 700200 xent  ALA$TIME     TSX0  ! X66_AUTO_1
         2 000001   000022 000001                    ZERO    18,1

     1438        7                                                              /**/
     1439        8        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:287  
     1440        9        /*********************************************************************/
     1441       10        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1442       11        /*********************************************************************/
     1443       12                                                              /**/
     1444       13              %INCLUDE CP_6 ;
     1445       94              %INCLUDE AL_MACROS_C ;
     1446      120              %INCLUDE AL_LOGON_R ;
     1447      152              %INCLUDE CP_6_SUBS;
     1448      692        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:288  
     1449      693        /*********************************************************************/
     1450      694        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1451      695        /*********************************************************************/
     1452      696                                                              /**/
     1453      697        %LIST ;
     1454      698                                                              /**/
     1455      699              %AL$TSTAMP (STNAME=AL$TSTAMP,STCLASS=" ") ;
               700                                                /*   TIME STAMP FOR B$JIT.LOGONTIME.  */
               701    1         DCL 1 STNAME STCLASS ,
               702    1               2 UTS UBIN WORD ,
               703    1               2 TIME CHAR(11) UNAL ,
               704    1               2 DAY  CHAR(3) UNAL ,
               705    1               2 DATE CHAR(10) UNAL ;
     1456      707                                                              /**/
     1457      708        %PLIST ;
     1458      709        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:289  
     1459      710        /*********************************************************************/
     1460      711        /*   FPTs            FPTs            FPTs            FPTs            */
     1461      712        /*********************************************************************/
     1462      713                                                              /**/
     1463      714              %FPT_TIME ( FPTN = FPT_TIME ,
     1464      715                          STCLASS = CONSTANT ) ;
     1465      734              %FPT_TIME ( FPTN = FPT$TIME ,
     1466      735                          STCLASS = AUTO ) ;
     1467      754        %EJECT ;
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:290  
     1468      755        /*********************************************************************/
     1469      756        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1470      757        /*********************************************************************/
     1471      758                                                              /**/
     1472      759    1         AL$TSTAMP.TIME = AL_BLANK ;

    759  2 000002   200003 470500                    LDP0    @AL$TSTAMP,,AUTO
         2 000003   040100 100400                    MLR     fill='040'O
         2 000004   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000005   000001 000013                    ADSC9   1,,PR0                   cn=0,n=11

     1473      760    1         AL$TSTAMP.DAY  = AL_BLANK ;

    760  2 000006   040100 100400                    MLR     fill='040'O
         2 000007   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000010   000003 600003                    ADSC9   3,,PR0                   cn=3,n=3

     1474      761    1         AL$TSTAMP.DATE = AL_BLANK ;

    761  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 xsym               ADSC9   AL_BLANK                 cn=0,n=1
         2 000013   000004 400012                    ADSC9   4,,PR0                   cn=2,n=10

     1475      762                                                            /*   SET UP FPT FOR M$TIME.  */
     1476      763    1         FPT$TIME = FPT_TIME ;

    763  2 000014   000100 100400                    MLR     fill='000'O
         2 000015   000000 000060 1                  ADSC9   FPT_TIME                 cn=0,n=48
         2 000016   200004 000060                    ADSC9   FPT$TIME,,AUTO           cn=0,n=48

     1477      764    1         FPT$TIME.TIME_ = VECTOR( AL$TSTAMP.TIME ) ;

    764  2 000017   000000 235000 3                  LDA     0
         2 000020   200003 236100                    LDQ     @AL$TSTAMP,,AUTO
         2 000021   000001 036003                    ADLQ    1,DU
         2 000022   200010 757100                    STAQ    FPT$TIME+4,,AUTO

PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:291  
     1478      765    1         FPT$TIME.DAY_  = VECTOR( AL$TSTAMP.DAY  ) ;

    765  2 000023   577640 235007                    LDA     -65632,DL
         2 000024   200003 236100                    LDQ     @AL$TSTAMP,,AUTO
         2 000025   000001 036000 3                  ADLQ    1
         2 000026   200012 757100                    STAQ    FPT$TIME+6,,AUTO

     1479      766    1         FPT$TIME.DATE_ = VECTOR( AL$TSTAMP.DATE ) ;

    766  2 000027   000002 235000 3                  LDA     2
         2 000030   200003 236100                    LDQ     @AL$TSTAMP,,AUTO
         2 000031   000003 036000 3                  ADLQ    3
         2 000032   200006 757100                    STAQ    FPT$TIME+2,,AUTO

     1480      767    1         FPT$TIME.TSTAMP_ = VECTOR( AL$TSTAMP.UTS ) ;

    767  2 000033   777640 235007                    LDA     -96,DL
         2 000034   200003 236100                    LDQ     @AL$TSTAMP,,AUTO
         2 000035   200014 757100                    STAQ    FPT$TIME+8,,AUTO

     1481      768    1         FPT$TIME.V_    = VECTOR( FPT$TIME.V     ) ;

    768  2 000036   000004 235000 3                  LDA     4
         2 000037   200020 452500                    STP2    FPT$TIME+12,,AUTO
         2 000040   200020 236100                    LDQ     FPT$TIME+12,,AUTO
         2 000041   000016 036003                    ADLQ    14,DU
         2 000042   200004 757100                    STAQ    FPT$TIME,,AUTO

     1482      769    1         IF AL$TSTAMP.UTS ~= 0

    769  2 000043   000000 235100                    LDA     0,,PR0
         2 000044   000047 600000 2                  TZE     s:773

     1483      770    1         THEN
     1484      771    1             FPT$TIME.V.SOURCE# = %UTS#;

    771  2 000045   004000 236003                    LDQ     2048,DU
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:292  
         2 000046   200016 552140                    STBQ    FPT$TIME+10,'40'O,AUTO

     1485      772                                                              /*   GET THE TIME.   */
     1486      773    1         CALL M$TIME( FPT$TIME )  ALTRET( TIME_ERR ) ;

    773  2 000047   200004 630500                    EPPR0   FPT$TIME,,AUTO
         2 000050   420004 713400                    CLIMB   alt,+8196
         2 000051   402000 401760                    pmme    nvectors=5
         2 000052   000054 702000 2                  TSX2    TIME_ERR

     1487      774                                                              /**/
     1488      775    1         RETURN ;

    775  2 000053   000000 702200 xent               TSX2  ! X66_ARET

    769  2 000054                       TIME_ERR     null
     1489      776    1   TIME_ERR: ;
     1490      777    1         RETURN ;

    777  2 000054   000000 702200 xent               TSX2  ! X66_ARET
     1491      778                                                              /**/
     1492      779    1   END   ALA$TIME ;
     1493      780        %EOD ;

PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:293  
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   AL_MACROS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$TIME.
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:294  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$TIME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 FPT_TIME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @AL$TSTAMP                *0-0-0/w STRC(252)   r     1 AL$TSTAMP
     4-0-0/d STRC(432)   r     1 FPT$TIME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AL_BLANK


   Procedure ALA$TIME requires 45 words for executable code.
   Procedure ALA$TIME requires 18 words of local(AUTO) storage.
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:295  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:296  
          MINI XREF LISTING

AL$TSTAMP
       701**DCL         6--PROC
AL$TSTAMP.DATE
       705**DCL       761<<ASSIGN    766--ASSIGN
AL$TSTAMP.DAY
       704**DCL       760<<ASSIGN    765--ASSIGN
AL$TSTAMP.TIME
       703**DCL       759<<ASSIGN    764--ASSIGN
AL$TSTAMP.UTS
       702**DCL       767--ASSIGN    769>>IF
AL_BLANK
       134**DCL       759>>ASSIGN    760>>ASSIGN    761>>ASSIGN
FPT$TIME
       746**DCL       763<<ASSIGN    773<>CALL
FPT$TIME.DATE_
       746**DCL       766<<ASSIGN
FPT$TIME.DAY_
       749**DCL       765<<ASSIGN
FPT$TIME.TIME_
       748**DCL       764<<ASSIGN
FPT$TIME.TSTAMP_
       749**DCL       767<<ASSIGN
FPT$TIME.V
       750**DCL       768--ASSIGN
FPT$TIME.V.SOURCE#
       750**DCL       771<<ASSIGN
FPT$TIME.V_
       746**DCL       768<<ASSIGN
FPT_TIME
       726**DCL       763>>ASSIGN
FPT_TIME.V
       730**DCL       726--DCLINIT
PL6.E3A0      #006=ALA$TIME File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:31 Page:297  
M$TIME
        89**DCL-ENT   773--CALL
TIME_ERR
       769**LABEL     773--CALLALT

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:298  
     1494        1        /*T***********************************************************/
     1495        2        /*T*                                                         */
     1496        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1497        4        /*T*                                                         */
     1498        5        /*T***********************************************************/
     1499        6        ALA$OPEN_STAR_A: PROC( ACCN ) ALTRET ;
     1500        7                                                              /**/
     1501        8        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:299  
     1502        9        /*********************************************************************/
     1503       10        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1504       11        /*********************************************************************/
     1505       12                                                              /**/
     1506       13    1   DCL ACCN CHAR(8) ;
     1507       14                                                              /**/
     1508       15        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:300  
     1509       16        /*********************************************************************/
     1510       17        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1511       18        /*********************************************************************/
     1512       19                                                              /**/
     1513       20              %INCLUDE CP_6 ;
     1514      101              %INCLUDE CP_6_SUBS ;
     1515      641              %INCLUDE AL_LOGON_R ;
     1516      673                                                              /**/
     1517      674        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:301  
     1518      675        /*********************************************************************/
     1519      676        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1520      677        /*********************************************************************/
     1521      678                                                              /**/
     1522      679                                                              /**/
     1523      680              %VLP_NAME(  FPTN = VLP_STAR_A ,
     1524      681                          NAME='*A',
     1525      682                          LEN  = 2 ,
     1526      683                          STCLASS = CONSTANT ) ;
     1527      710              %VLP_NAME(  FPTN = VLP_STAR_S ,
     1528      711                          NAME='*S',
     1529      712                          LEN = 2 ,
     1530      713                          STCLASS = CONSTANT ) ;
     1531      740        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:302  
     1532      741        /*********************************************************************/
     1533      742        /*   FPTs            FPTs            FPTs            FPTs            */
     1534      743        /*********************************************************************/
     1535      744                                                              /**/
     1536      745              %FPT_OPEN ( FPTN = OPEN_STAR ,
     1537      746                          STCLASS = CONSTANT ,
     1538      747                          ASN = FILE ,
     1539      748                          ACS = DIRECT ,
     1540      749                          ORG = KEYED ,
     1541      750                          FUN = CREATE ,
     1542      751                          EXIST = OLDFILE ) ;
     1543      860              %FPT_OPEN ( FPTN = OPEN$STAR ,
     1544      861                          SCRUB = YES ,
     1545      862                          STCLASS = AUTO ) ;
     1546      971              %FPT_CLOSE (  FPTN = CLOSE_STAR ,
     1547      972                            STCLASS = CONSTANT ,
     1548      973                            DISP = SAVE ) ;
     1549     1015              %FPT_CLOSE (  FPTN = CLOSE$STAR ,
     1550     1016                            STCLASS = AUTO ) ;
     1551     1058        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:303  
     1552     1059        /*********************************************************************/
     1553     1060        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1554     1061        /*********************************************************************/
     1555     1062                                                              /**/
     1556     1063    1         OPEN$STAR = OPEN_STAR ;
     1557     1064    1         OPEN$STAR.NAME_ = VECTOR( VLP_STAR_A ) ;
     1558     1065    1         OPEN$STAR.ACCT_ = VECTOR( ACCN ) ;
     1559     1066    1         OPEN$STAR.V.DCB# = AL_DCB2# ;
     1560     1067    1         OPEN$STAR.V_ = VECTOR ( OPEN$STAR.V ) ;
     1561     1068                                                              /**/
     1562     1069    1         CALL M$OPEN( OPEN$STAR ) ALTRET( OPEN_A_ERR ) ;
     1563     1070                                                              /**/
     1564     1071    1         RETURN ;
     1565     1072                                                              /**/
     1566     1073    1   OPEN_A_ERR: ;
     1567     1074    1         ALTRETURN ;
     1568     1075                                                              /**/
     1569     1076    1   ALA$OPEN_STAR_S: ENTRY( ACCN ) ALTRET ;
     1570     1077                                                              /**/
     1571     1078    1         OPEN$STAR = OPEN_STAR ;
     1572     1079    1         OPEN$STAR.NAME_ = VECTOR( VLP_STAR_S ) ;
     1573     1080    1         OPEN$STAR.ACCT_ = VECTOR( ACCN ) ;
     1574     1081    1         OPEN$STAR.V.DCB# = AL_DCB2# ;
     1575     1082    1         OPEN$STAR.V_ = VECTOR ( OPEN$STAR.V ) ;
     1576     1083                                                              /**/
     1577     1084    1         CALL M$OPEN( OPEN$STAR ) ALTRET( OPEN_S_ERR ) ;
     1578     1085                                                              /**/
     1579     1086    1         RETURN ;
     1580     1087                                                              /**/
     1581     1088    1   OPEN_S_ERR: ;
     1582     1089    1         ALTRETURN ;
     1583     1090                                                              /**/
     1584     1091    1   ALA$CLOSE_STAR: ENTRY  ALTRET ;
     1585     1092                                                              /**/
     1586     1093    1         CLOSE$STAR = CLOSE_STAR ;
     1587     1094    1         CLOSE$STAR.V.DCB# = AL_DCB2# ;
     1588     1095    1         CLOSE$STAR.V_ = VECTOR( CLOSE$STAR.V ) ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:304  
     1589     1096                                                              /**/
     1590     1097    1         CALL M$CLOSE( CLOSE$STAR ) ALTRET( CLOSE_ERR ) ;
     1591     1098                                                              /**/
     1592     1099    1         RETURN ;
     1593     1100                                                              /**/
     1594     1101    1   CLOSE_ERR: ;
     1595     1102    1         RETURN ;
     1596     1103                                                              /**/
     1597     1104    1   END   ALA$OPEN_STAR_A ;
     1598     1105        %EOD ;

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:305  
--  Include file information  --

   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$OPEN_STAR_A.

   Procedure ALA$OPEN_STAR_A requires 64 words for executable code.
   Procedure ALA$OPEN_STAR_A requires 94 words of local(AUTO) storage.

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:306  

 Object Unit name= ALA$OPEN_STAR_A                            File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:32:12.60 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     90    132  ALA$OPEN_STAR_A
    2   Proc  even  none    64    100  ALA$OPEN_STAR_A
    3  RoData even  none     7      7  ALA$OPEN_STAR_A

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        1  ALA$OPEN_STAR_A
     2     27          yes     yes      Std        1  ALA$OPEN_STAR_S
     2     56          yes     yes      Std        0  ALA$CLOSE_STAR

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_1
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  AL_DCB2#
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:307  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:308  


     1494        1        /*T***********************************************************/
     1495        2        /*T*                                                         */
     1496        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1497        4        /*T*                                                         */
     1498        5        /*T***********************************************************/
     1499        6        ALA$OPEN_STAR_A: PROC( ACCN ) ALTRET ;

      6  2 000000   000000 700200 xent  ALA$OPEN_ST* TSX0  ! X66_AUTO_1
         2 000001   000136 000001                    ZERO    94,1

     1500        7                                                              /**/
     1501        8        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:309  
     1502        9        /*********************************************************************/
     1503       10        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1504       11        /*********************************************************************/
     1505       12                                                              /**/
     1506       13    1   DCL ACCN CHAR(8) ;
     1507       14                                                              /**/
     1508       15        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:310  
     1509       16        /*********************************************************************/
     1510       17        /*   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   INCLUDE FILES   */
     1511       18        /*********************************************************************/
     1512       19                                                              /**/
     1513       20              %INCLUDE CP_6 ;
     1514      101              %INCLUDE CP_6_SUBS ;
     1515      641              %INCLUDE AL_LOGON_R ;
     1516      673                                                              /**/
     1517      674        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:311  
     1518      675        /*********************************************************************/
     1519      676        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1520      677        /*********************************************************************/
     1521      678                                                              /**/
     1522      679                                                              /**/
     1523      680              %VLP_NAME(  FPTN = VLP_STAR_A ,
     1524      681                          NAME='*A',
     1525      682                          LEN  = 2 ,
     1526      683                          STCLASS = CONSTANT ) ;
     1527      710              %VLP_NAME(  FPTN = VLP_STAR_S ,
     1528      711                          NAME='*S',
     1529      712                          LEN = 2 ,
     1530      713                          STCLASS = CONSTANT ) ;
     1531      740        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:312  
     1532      741        /*********************************************************************/
     1533      742        /*   FPTs            FPTs            FPTs            FPTs            */
     1534      743        /*********************************************************************/
     1535      744                                                              /**/
     1536      745              %FPT_OPEN ( FPTN = OPEN_STAR ,
     1537      746                          STCLASS = CONSTANT ,
     1538      747                          ASN = FILE ,
     1539      748                          ACS = DIRECT ,
     1540      749                          ORG = KEYED ,
     1541      750                          FUN = CREATE ,
     1542      751                          EXIST = OLDFILE ) ;
     1543      860              %FPT_OPEN ( FPTN = OPEN$STAR ,
     1544      861                          SCRUB = YES ,
     1545      862                          STCLASS = AUTO ) ;
     1546      971              %FPT_CLOSE (  FPTN = CLOSE_STAR ,
     1547      972                            STCLASS = CONSTANT ,
     1548      973                            DISP = SAVE ) ;
     1549     1015              %FPT_CLOSE (  FPTN = CLOSE$STAR ,
     1550     1016                            STCLASS = AUTO ) ;
     1551     1058        %EJECT ;
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:313  
     1552     1059        /*********************************************************************/
     1553     1060        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1554     1061        /*********************************************************************/
     1555     1062                                                              /**/
     1556     1063    1         OPEN$STAR = OPEN_STAR ;

   1063  2 000002   000100 100400                    MLR     fill='000'O
         2 000003   000002 000350 1                  ADSC9   OPEN_STAR                cn=0,n=232
         2 000004   200004 000350                    ADSC9   OPEN$STAR,,AUTO          cn=0,n=232

     1557     1064    1         OPEN$STAR.NAME_ = VECTOR( VLP_STAR_A ) ;

   1064  2 000005   000000 237000 3                  LDAQ    0
         2 000006   200012 757100                    STAQ    OPEN$STAR+6,,AUTO

     1558     1065    1         OPEN$STAR.ACCT_ = VECTOR( ACCN ) ;

   1065  2 000007   000002 235000 3                  LDA     2
         2 000010   200003 236100                    LDQ     @ACCN,,AUTO
         2 000011   200030 757100                    STAQ    OPEN$STAR+20,,AUTO

     1559     1066    1         OPEN$STAR.V.DCB# = AL_DCB2# ;

   1066  2 000012   000000 720000 xsym               LXL0    AL_DCB2#
         2 000013   200050 740100                    STX0    OPEN$STAR+36,,AUTO

     1560     1067    1         OPEN$STAR.V_ = VECTOR ( OPEN$STAR.V ) ;

   1067  2 000014   000003 235000 3                  LDA     3
         2 000015   200134 452500                    STP2    CLOSE$STAR+30,,AUTO
         2 000016   200134 236100                    LDQ     CLOSE$STAR+30,,AUTO
         2 000017   000050 036003                    ADLQ    40,DU
         2 000020   200004 757100                    STAQ    OPEN$STAR,,AUTO

     1561     1068                                                              /**/
     1562     1069    1         CALL M$OPEN( OPEN$STAR ) ALTRET( OPEN_A_ERR ) ;

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:314  
   1069  2 000021   200004 630500                    EPPR0   OPEN$STAR,,AUTO
         2 000022   450000 713400                    CLIMB   alt,open
         2 000023   410400 401760                    pmme    nvectors=18
         2 000024   000026 702000 2                  TSX2    OPEN_A_ERR

     1563     1070                                                              /**/
     1564     1071    1         RETURN ;

   1071  2 000025   000000 702200 xent               TSX2  ! X66_ARET

   1067  2 000026                       OPEN_A_ERR   null
     1565     1072                                                              /**/
     1566     1073    1   OPEN_A_ERR: ;
     1567     1074    1         ALTRETURN ;

   1074  2 000026   000000 702200 xent               TSX2  ! X66_AALT

     1568     1075                                                              /**/
     1569     1076    1   ALA$OPEN_STAR_S: ENTRY( ACCN ) ALTRET ;

   1076  2 000027   000000 700200 xent  ALA$OPEN_ST* TSX0  ! X66_AUTO_1
         2 000030   000136 000001                    ZERO    94,1

     1570     1077                                                              /**/
     1571     1078    1         OPEN$STAR = OPEN_STAR ;

   1078  2 000031   000100 100400                    MLR     fill='000'O
         2 000032   000002 000350 1                  ADSC9   OPEN_STAR                cn=0,n=232
         2 000033   200004 000350                    ADSC9   OPEN$STAR,,AUTO          cn=0,n=232

     1572     1079    1         OPEN$STAR.NAME_ = VECTOR( VLP_STAR_S ) ;

   1079  2 000034   000004 237000 3                  LDAQ    4
         2 000035   200012 757100                    STAQ    OPEN$STAR+6,,AUTO

     1573     1080    1         OPEN$STAR.ACCT_ = VECTOR( ACCN ) ;

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:315  
   1080  2 000036   000002 235000 3                  LDA     2
         2 000037   200003 236100                    LDQ     @ACCN,,AUTO
         2 000040   200030 757100                    STAQ    OPEN$STAR+20,,AUTO

     1574     1081    1         OPEN$STAR.V.DCB# = AL_DCB2# ;

   1081  2 000041   000000 720000 xsym               LXL0    AL_DCB2#
         2 000042   200050 740100                    STX0    OPEN$STAR+36,,AUTO

     1575     1082    1         OPEN$STAR.V_ = VECTOR ( OPEN$STAR.V ) ;

   1082  2 000043   000003 235000 3                  LDA     3
         2 000044   200134 452500                    STP2    CLOSE$STAR+30,,AUTO
         2 000045   200134 236100                    LDQ     CLOSE$STAR+30,,AUTO
         2 000046   000050 036003                    ADLQ    40,DU
         2 000047   200004 757100                    STAQ    OPEN$STAR,,AUTO

     1576     1083                                                              /**/
     1577     1084    1         CALL M$OPEN( OPEN$STAR ) ALTRET( OPEN_S_ERR ) ;

   1084  2 000050   200004 630500                    EPPR0   OPEN$STAR,,AUTO
         2 000051   450000 713400                    CLIMB   alt,open
         2 000052   410400 401760                    pmme    nvectors=18
         2 000053   000055 702000 2                  TSX2    OPEN_S_ERR

     1578     1085                                                              /**/
     1579     1086    1         RETURN ;

   1086  2 000054   000000 702200 xent               TSX2  ! X66_ARET

   1082  2 000055                       OPEN_S_ERR   null
     1580     1087                                                              /**/
     1581     1088    1   OPEN_S_ERR: ;
     1582     1089    1         ALTRETURN ;

   1089  2 000055   000000 702200 xent               TSX2  ! X66_AALT

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:316  
     1583     1090                                                              /**/
     1584     1091    1   ALA$CLOSE_STAR: ENTRY  ALTRET ;

   1091  2 000056   000000 700200 xent  ALA$CLOSE_S* TSX0  ! X66_AUTO_1
         2 000057   000136 000001                    ZERO    94,1

     1585     1092                                                              /**/
     1586     1093    1         CLOSE$STAR = CLOSE_STAR ;

   1093  2 000060   000100 100400                    MLR     fill='000'O
         2 000061   000074 000170 1                  ADSC9   CLOSE_STAR               cn=0,n=120
         2 000062   200076 000170                    ADSC9   CLOSE$STAR,,AUTO         cn=0,n=120

     1587     1094    1         CLOSE$STAR.V.DCB# = AL_DCB2# ;

   1094  2 000063   000000 720000 xsym               LXL0    AL_DCB2#
         2 000064   200130 740100                    STX0    CLOSE$STAR+26,,AUTO

     1588     1095    1         CLOSE$STAR.V_ = VECTOR( CLOSE$STAR.V ) ;

   1095  2 000065   000006 235000 3                  LDA     6
         2 000066   200134 452500                    STP2    CLOSE$STAR+30,,AUTO
         2 000067   200134 236100                    LDQ     CLOSE$STAR+30,,AUTO
         2 000070   000130 036003                    ADLQ    88,DU
         2 000071   200076 757100                    STAQ    CLOSE$STAR,,AUTO

     1589     1096                                                              /**/
     1590     1097    1         CALL M$CLOSE( CLOSE$STAR ) ALTRET( CLOSE_ERR ) ;

   1097  2 000072   200076 630500                    EPPR0   CLOSE$STAR,,AUTO
         2 000073   450001 713400                    CLIMB   alt,close
         2 000074   406000 401760                    pmme    nvectors=13
         2 000075   000077 702000 2                  TSX2    CLOSE_ERR

     1591     1098                                                              /**/
     1592     1099    1         RETURN ;

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:317  
   1099  2 000076   000000 702200 xent               TSX2  ! X66_ARET

   1095  2 000077                       CLOSE_ERR    null
     1593     1100                                                              /**/
     1594     1101    1   CLOSE_ERR: ;
     1595     1102    1         RETURN ;

   1102  2 000077   000000 702200 xent               TSX2  ! X66_ARET
     1596     1103                                                              /**/
     1597     1104    1   END   ALA$OPEN_STAR_A ;
     1598     1105        %EOD ;

PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:318  
--  Include file information  --

   AL_LOGON_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$OPEN_STAR_A.
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:319  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$OPEN_STAR_A

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    74-0-0/d STRC(1080)  r     1 CLOSE_STAR                 2-0-0/d STRC(2088)  r     1 OPEN_STAR
     0-0-0/c STRC(27)    r     1 VLP_STAR_A                 1-0-0/c STRC(27)    r     1 VLP_STAR_S

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @ACCN                     *0-0-0/c CHAR(8)     r     1 ACCN
    76-0-0/d STRC(1080)  r     1 CLOSE$STAR                 4-0-0/d STRC(2088)  r     1 OPEN$STAR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 AL_DCB2#


   Procedure ALA$OPEN_STAR_A requires 64 words for executable code.
   Procedure ALA$OPEN_STAR_A requires 94 words of local(AUTO) storage.
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:320  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:321  
          MINI XREF LISTING

ACCN
        13**DCL         6--PROC     1065--ASSIGN   1076--ENTRY    1080--ASSIGN
AL_DCB2#
       670**DCL      1066>>ASSIGN   1081>>ASSIGN   1094>>ASSIGN
CLOSE$STAR
      1039**DCL      1093<<ASSIGN   1097<>CALL
CLOSE$STAR.SN_
      1039**DCL      1039--REDEF
CLOSE$STAR.UTL_
      1040**DCL      1040--REDEF
CLOSE$STAR.V
      1044**DCL      1095--ASSIGN
CLOSE$STAR.V.DCB#
      1045**DCL      1094<<ASSIGN
CLOSE$STAR.V.EXPIRE#
      1054**DCL      1054--REDEF
CLOSE$STAR.V.TYPE#
      1052**DCL      1052--REDEF
CLOSE$STAR.V.XTNSIZE#
      1049**DCL      1049--REDEF    1051--REDEF
CLOSE$STAR.V_
      1039**DCL      1095<<ASSIGN
CLOSE_ERR
      1095**LABEL    1097--CALLALT
CLOSE_STAR
       996**DCL      1093>>ASSIGN
CLOSE_STAR.SN_
       996**DCL       996--REDEF
CLOSE_STAR.UTL_
       997**DCL       997--REDEF
CLOSE_STAR.V
      1001**DCL       996--DCLINIT
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:322  
CLOSE_STAR.V.EXPIRE#
      1011**DCL      1011--REDEF
CLOSE_STAR.V.TYPE#
      1009**DCL      1009--REDEF
CLOSE_STAR.V.XTNSIZE#
      1006**DCL      1006--REDEF    1008--REDEF
M$CLOSE
        29**DCL-ENT  1097--CALL
M$OPEN
        29**DCL-ENT  1069--CALL     1084--CALL
OPEN$STAR
       927**DCL      1063<<ASSIGN   1069<>CALL     1078<<ASSIGN   1084<>CALL
OPEN$STAR.ACCT_
       931**DCL      1065<<ASSIGN   1080<<ASSIGN
OPEN$STAR.ACSVEH_
       929**DCL       930--REDEF
OPEN$STAR.ALTKEYS_
       935**DCL       936--REDEF     936--REDEF
OPEN$STAR.HDR_
       934**DCL       935--REDEF
OPEN$STAR.NAME_
       928**DCL      1064<<ASSIGN   1079<<ASSIGN
OPEN$STAR.TAB_
       933**DCL       934--REDEF
OPEN$STAR.UHL_
       927**DCL       928--REDEF     928--REDEF
OPEN$STAR.V
       936**DCL      1067--ASSIGN   1082--ASSIGN
OPEN$STAR.V.DCB#
       936**DCL      1066<<ASSIGN   1081<<ASSIGN
OPEN$STAR.V.FSN#
       967**DCL       967--REDEF     967--REDEF
OPEN$STAR.V_
       927**DCL      1067<<ASSIGN   1082<<ASSIGN
OPEN$STAR.WSN_
       933**DCL       933--REDEF
PL6.E3A0      #007=ALA$OPEN_STAR_A File=ALA$LOGON.:E05TSI                        TUE 07/29/97 08:32 Page:323  
OPEN_A_ERR
      1067**LABEL    1069--CALLALT
OPEN_STAR
       816**DCL      1063>>ASSIGN   1078>>ASSIGN
OPEN_STAR.ACSVEH_
       818**DCL       819--REDEF
OPEN_STAR.ALTKEYS_
       824**DCL       825--REDEF     825--REDEF
OPEN_STAR.HDR_
       823**DCL       824--REDEF
OPEN_STAR.TAB_
       822**DCL       823--REDEF
OPEN_STAR.UHL_
       816**DCL       817--REDEF     817--REDEF
OPEN_STAR.V
       825**DCL       816--DCLINIT
OPEN_STAR.V.FSN#
       856**DCL       856--REDEF     856--REDEF
OPEN_STAR.WSN_
       822**DCL       822--REDEF
OPEN_S_ERR
      1082**LABEL    1084--CALLALT
VLP_STAR_A
       708**DCL      1064--ASSIGN
VLP_STAR_S
       738**DCL      1079--ASSIGN

PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:324  
     1599        1        /*T***********************************************************/
     1600        2        /*T*                                                         */
     1601        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1602        4        /*T*                                                         */
     1603        5        /*T***********************************************************/
     1604        6        ALA$YESNOD: PROC( BUF, SIZE ) ALTRET ;
     1605        7        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:325  
     1606        8        /*********************************************************************/
     1607        9        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1608       10        /*********************************************************************/
     1609       11                                                              /**/
     1610       12    1   DCL BUF CHAR(10) ;
     1611       13    1   DCL SIZE UBIN ;
     1612       14        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:326  
     1613       15        /*********************************************************************/
     1614       16        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1615       17        /*********************************************************************/
     1616       18                                                              /**/
     1617       19    1   DCL RES_ARRY(0:5) CHAR(6) CONSTANT INIT(  'YES' ,
     1618       20    1                                                   'yes' ,
     1619       21    1                                                   'NO' ,
     1620       22    1                                                   'no' ,
     1621       23    1                                                   'DELETE' ,
     1622       24    1                                                   'delete' ) ;
     1623       25    1   DCL ANS_ARRY(0:5) CHAR(1) CONSTANT INIT(  'Y' ,
     1624       26    1                                                   'Y' ,
     1625       27    1                                                   'N' ,
     1626       28    1                                                   'N' ,
     1627       29    1                                                   'D' ,
     1628       30    1                                                   'D' ) ;
     1629       31        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:327  
     1630       32        /*********************************************************************/
     1631       33        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
     1632       34        /*********************************************************************/
     1633       35    1   DCL I UBIN ;
     1634       36    1   DCL T_BUF CHAR(10) ;
     1635       37        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:328  
     1636       38        /*********************************************************************/
     1637       39        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1638       40        /*********************************************************************/
     1639       41                                                              /**/
     1640       42    1         IF SIZE > 6
     1641       43    1         THEN
     1642       44    2         DO ;
     1643       45    2             ALTRETURN ;
     1644       46    2             END ; /* THEN DO */
     1645       47    2         DO I = 0 TO 5 ;
     1646       48    2             T_BUF = SUBSTR( RES_ARRY( I ), 0,  SIZE ) ;
     1647       49    2             IF BUF = T_BUF
     1648       50    2             THEN
     1649       51    3             DO ;
     1650       52    3                 BUF = ANS_ARRY( I ) ;
     1651       53    3                 RETURN ;
     1652       54    3                 END ; /* THEN DO */
     1653       55    2             END ; /* DO I */
     1654       56                                                              /* NO MATCH */
     1655       57    1         ALTRETURN ;
     1656       58                                                              /**/
     1657       59    1   END   ALA$YESNOD ;
     1658       60        %EOD;

PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:329  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ALA$YESNOD.

   Procedure ALA$YESNOD requires 31 words for executable code.
   Procedure ALA$YESNOD requires 10 words of local(AUTO) storage.

PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:330  

 Object Unit name= ALA$YESNOD                                 File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:32:44.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     11     13  ALA$YESNOD
    1   Proc  even  none    31     37  ALA$YESNOD

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        2  ALA$YESNOD

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_2
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:331  


     1599        1        /*T***********************************************************/
     1600        2        /*T*                                                         */
     1601        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1602        4        /*T*                                                         */
     1603        5        /*T***********************************************************/
     1604        6        ALA$YESNOD: PROC( BUF, SIZE ) ALTRET ;

      6  1 000000   000000 700200 xent  ALA$YESNOD   TSX0  ! X66_AUTO_2
         1 000001   000012 000002                    ZERO    10,2

     1605        7        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:332  
     1606        8        /*********************************************************************/
     1607        9        /*   PARAMETERS      PARAMETERS      PARAMETERS      PARAMETERS      */
     1608       10        /*********************************************************************/
     1609       11                                                              /**/
     1610       12    1   DCL BUF CHAR(10) ;
     1611       13    1   DCL SIZE UBIN ;
     1612       14        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:333  
     1613       15        /*********************************************************************/
     1614       16        /*   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   CONSTANT DATA   */
     1615       17        /*********************************************************************/
     1616       18                                                              /**/
     1617       19    1   DCL RES_ARRY(0:5) CHAR(6) CONSTANT INIT(  'YES' ,
     1618       20    1                                                   'yes' ,
     1619       21    1                                                   'NO' ,
     1620       22    1                                                   'no' ,
     1621       23    1                                                   'DELETE' ,
     1622       24    1                                                   'delete' ) ;
     1623       25    1   DCL ANS_ARRY(0:5) CHAR(1) CONSTANT INIT(  'Y' ,
     1624       26    1                                                   'Y' ,
     1625       27    1                                                   'N' ,
     1626       28    1                                                   'N' ,
     1627       29    1                                                   'D' ,
     1628       30    1                                                   'D' ) ;
     1629       31        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:334  
     1630       32        /*********************************************************************/
     1631       33        /*   AUTO DATA       AUTO DATA       AUTO DATA       AUTO DATA       */
     1632       34        /*********************************************************************/
     1633       35    1   DCL I UBIN ;
     1634       36    1   DCL T_BUF CHAR(10) ;
     1635       37        %EJECT ;
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:335  
     1636       38        /*********************************************************************/
     1637       39        /*   PROCEDURE       PROCEDURE       PROCEDURE       PROCEDURE       */
     1638       40        /*********************************************************************/
     1639       41                                                              /**/
     1640       42    1         IF SIZE > 6

     42  1 000002   200004 470500                    LDP0    @SIZE,,AUTO
         1 000003   000000 235100                    LDA     0,,PR0
         1 000004   000007 115007                    CMPA    7,DL
         1 000005   000007 602000 1                  TNC     s:47

     1641       43    1         THEN
     1642       44    2         DO ;

     1643       45    2             ALTRETURN ;

     45  1 000006   000000 702200 xent               TSX2  ! X66_AALT

     1644       46    2             END ; /* THEN DO */
     1645       47    2         DO I = 0 TO 5 ;

     47  1 000007   200005 450100                    STZ     I,,AUTO

     1646       48    2             T_BUF = SUBSTR( RES_ARRY( I ), 0,  SIZE ) ;

     48  1 000010   200004 470500                    LDP0    @SIZE,,AUTO
         1 000011   000000 720100                    LXL0    0,,PR0
         1 000012   200005 236100                    LDQ     I,,AUTO
         1 000013   000006 402007                    MPY     6,DL
         1 000014   040100 100446                    MLR     fill='040'O
         1 000015   000000 000010 0                  ADSC9   RES_ARRY,Q               cn=0,n=*X0
         1 000016   200006 000012                    ADSC9   T_BUF,,AUTO              cn=0,n=10

     1647       49    2             IF BUF = T_BUF

     49  1 000017   200003 471500                    LDP1    @BUF,,AUTO
         1 000020   040100 106500                    CMPC    fill='040'O
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:336  
         1 000021   100000 000012                    ADSC9   0,,PR1                   cn=0,n=10
         1 000022   200006 000012                    ADSC9   T_BUF,,AUTO              cn=0,n=10
         1 000023   000031 601000 1                  TNZ     s:55

     1648       50    2             THEN
     1649       51    3             DO ;

     1650       52    3                 BUF = ANS_ARRY( I ) ;

     52  1 000024   200005 235100                    LDA     I,,AUTO
         1 000025   040100 100405                    MLR     fill='040'O
         1 000026   000011 000001 0                  ADSC9   ANS_ARRY,A               cn=0,n=1
         1 000027   100000 000012                    ADSC9   0,,PR1                   cn=0,n=10

     1651       53    3                 RETURN ;

     53  1 000030   000000 702200 xent               TSX2  ! X66_ARET

     1652       54    3                 END ; /* THEN DO */
     1653       55    2             END ; /* DO I */

     55  1 000031   200005 235100                    LDA     I,,AUTO
         1 000032   000001 035007                    ADLA    1,DL
         1 000033   200005 755100                    STA     I,,AUTO
         1 000034   000006 115007                    CMPA    6,DL
         1 000035   000010 602000 1                  TNC     s:48

     1654       56                                                              /* NO MATCH */
     1655       57    1         ALTRETURN ;

     57  1 000036   000000 702200 xent               TSX2  ! X66_AALT
     1656       58                                                              /**/
     1657       59    1   END   ALA$YESNOD ;
     1658       60        %EOD;

PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:337  
--  Include file information  --

   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ALA$YESNOD.
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:338  

 **** Variables and constants ****

  ****  Section 000 RoData ALA$YESNOD

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/c CHAR        r     1 ANS_ARRY(0:5)
     0-0-0/c CHAR(6)     r     1 RES_ARRY(0:5)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @BUF                       4-0-0/w PTR         r     1 @SIZE
    *0-0-0/c CHAR(10)    r     1 BUF                        5-0-0/w UBIN        r     1 I
    *0-0-0/w UBIN        r     1 SIZE                       6-0-0/c CHAR(10)    r     1 T_BUF


   Procedure ALA$YESNOD requires 31 words for executable code.
   Procedure ALA$YESNOD requires 10 words of local(AUTO) storage.
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:339  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #008=ALA$YESNOD File=ALA$LOGON.:E05TSI                             TUE 07/29/97 08:32 Page:340  
          MINI XREF LISTING

ANS_ARRY
        25**DCL        52>>ASSIGN
BUF
        12**DCL         6--PROC       49>>IF         52<<ASSIGN
I
        35**DCL        47<<DOINDEX    48>>ASSIGN     52>>ASSIGN
RES_ARRY
        19**DCL        48>>ASSIGN
SIZE
        13**DCL         6--PROC       42>>IF         48>>ASSIGN
T_BUF
        36**DCL        48<<ASSIGN     49>>IF

PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:341  
     1659        1        /*M* ALA$TRAP -- Trap handler for LOGON */
     1660        2        /*T***********************************************************/
     1661        3        /*T*                                                         */
     1662        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1663        5        /*T*                                                         */
     1664        6        /*T***********************************************************/
     1665        7        ALA$TRAP: PROC ASYNC;
     1666        8         %INCLUDE CP_6;
     1667       89         %INCLUDE AL_PERR_C;
     1668      111    1   DCL B$TCB$ PTR SYMREF;
     1669      112         %B$TCB;
     1670      115         %B$EXCFR;
     1671      133         %FPT_TRAP (FPTN=NO_TRAP,ARITHMETIC=NIL,ERRORS=NIL,PROGRAMMED=NIL,PMME=NIL,
     1672      134                    DIVIDE_CHECK=ABORT,OVERFLOW=ABORT,COMMAND=ABORT,
     1673      135                    IPR=ABORT,LOCKUP=ABORT,MEMORY=ABORT,MISSING_PAGE=ABORT,
     1674      136                    MISSING_SEG=ABORT,SECURITY_1=ABORT,SECURITY_2=ABORT,
     1675      137                    DERAIL=ABORT,FAULT_TAG=ABORT,MME=ABORT,STCLASS=CONSTANT);
     1676      160        %VLP_ERRCODE(FPTN=ALA_E$LOGON_TRAP,FCG='AL',MID='A',MON='0'B,ERR#=E$LOGON_TRAP,SEV=0
               160            ,STCLASS=CONSTANT);
     1677      205    1   DCL ALA$ERROR ENTRY(4);
     1678      206    1   DCL ERR BIT(36) ALIGNED;
     1679      207    1   DCL 1 AT ALIGNED,
     1680      208    1         2 COUNT UBIN BYTE UNAL,
     1681      209    1         2 IC CHAR(6);
     1682      210
     1683      211    1         CALL M$TRAP( NO_TRAP ) ALTRET( IGNORE1 );
     1684      212    1   IGNORE1:;
     1685      213    1         ERR = B$TCB$->B$TCB.STK$->B$EXCFR.ERR;
     1686      214    1         CALL ALA$ERROR( ERR );
     1687      215        /*E*  ERROR:  ALA-E$LOGON_TRAP-A
     1688      216              MESSAGE: LOGON trapped at IC=%U1
     1689      217        */
     1690      218    1         AT.COUNT = LENGTHC(AT.IC);
     1691      219    1         CALL BINCHAR(AT.IC,B$TCB$->B$TCB.STK$->B$EXCFR.IC);
     1692      220    1         CALL ALA$ERROR( ALA_E$LOGON_TRAP, AT );
     1693      221    1         CALL M$XXX;
     1694      222    1   END ALA$TRAP;
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:342  

PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:343  
--  Include file information  --

   AL_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$TRAP.

   Procedure ALA$TRAP requires 38 words for executable code.
   Procedure ALA$TRAP requires 8 words of local(AUTO) storage.

    No errors detected in file ALA$LOGON.:E05TSI    .

PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:344  

 Object Unit name= ALA$TRAP                                   File name= ALA$LOGON.:E05TOU
 UTS= JUL 29 '97 08:32:48.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS     11     13  ALA$TRAP
    2   Proc  even  none    38     46  ALA$TRAP
    3  RoData even  none     1      1  ALA$TRAP

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes     Async       0  ALA$TRAP

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       4 ALA$ERROR
                       nStd      0 X66_AAUTO
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                B_VECTNIL
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:345  

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:346  


     1659        1        /*M* ALA$TRAP -- Trap handler for LOGON */
     1660        2        /*T***********************************************************/
     1661        3        /*T*                                                         */
     1662        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1663        5        /*T*                                                         */
     1664        6        /*T***********************************************************/
     1665        7        ALA$TRAP: PROC ASYNC;

      7  2 000000   000000 700200 xent  ALA$TRAP     TSX0  ! X66_AAUTO
         2 000001   000010 000000                    ZERO    8,0

     1666        8         %INCLUDE CP_6;
     1667       89         %INCLUDE AL_PERR_C;
     1668      111    1   DCL B$TCB$ PTR SYMREF;
     1669      112         %B$TCB;
     1670      115         %B$EXCFR;
     1671      133         %FPT_TRAP (FPTN=NO_TRAP,ARITHMETIC=NIL,ERRORS=NIL,PROGRAMMED=NIL,PMME=NIL,
     1672      134                    DIVIDE_CHECK=ABORT,OVERFLOW=ABORT,COMMAND=ABORT,
     1673      135                    IPR=ABORT,LOCKUP=ABORT,MEMORY=ABORT,MISSING_PAGE=ABORT,
     1674      136                    MISSING_SEG=ABORT,SECURITY_1=ABORT,SECURITY_2=ABORT,
     1675      137                    DERAIL=ABORT,FAULT_TAG=ABORT,MME=ABORT,STCLASS=CONSTANT);
     1676      160       %VLP_ERRCODE(FPTN=ALA_E$LOGON_TRAP,FCG='AL',MID='A',MON='0'B,ERR#=E$LOGON_TRAP,SEV=0
               160            ,STCLASS=CONSTANT);
     1677      205    1   DCL ALA$ERROR ENTRY(4);
     1678      206    1   DCL ERR BIT(36) ALIGNED;
     1679      207    1   DCL 1 AT ALIGNED,
     1680      208    1         2 COUNT UBIN BYTE UNAL,
     1681      209    1         2 IC CHAR(6);
     1682      210
     1683      211    1         CALL M$TRAP( NO_TRAP ) ALTRET( IGNORE1 );

    211  2 000002   000000 630400 1                  EPPR0   NO_TRAP
         2 000003   410004 713400                    CLIMB   alt,+4100
         2 000004   400400 401760                    pmme    nvectors=2
         2 000005   000006 702000 2                  TSX2    IGNORE1

PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:347  
    211  2 000006                       IGNORE1      null
     1684      212    1   IGNORE1:;
     1685      213    1         ERR = B$TCB$->B$TCB.STK$->B$EXCFR.ERR;

    213  2 000006   000000 470400 xsym               LDP0    B$TCB$
         2 000007   000001 471500                    LDP1    1,,PR0
         2 000010   100102 236100                    LDQ     66,,PR1
         2 000011   200003 756100                    STQ     ERR,,AUTO

     1686      214    1         CALL ALA$ERROR( ERR );

    214  2 000012   200003 631500                    EPPR1   ERR,,AUTO
         2 000013   200006 451500                    STP1    AT+2,,AUTO
         2 000014   200006 630500                    EPPR0   AT+2,,AUTO
         2 000015   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000016   000000 701000 xent               TSX1    ALA$ERROR
         2 000017   000000 011000                    NOP     0

     1687      215        /*E*  ERROR:  ALA-E$LOGON_TRAP-A
     1688      216              MESSAGE: LOGON trapped at IC=%U1
     1689      217        */
     1690      218    1         AT.COUNT = LENGTHC(AT.IC);

    218  2 000020   006000 236003                    LDQ     3072,DU
         2 000021   200004 552140                    STBQ    AT,'40'O,AUTO

     1691      219    1         CALL BINCHAR(AT.IC,B$TCB$->B$TCB.STK$->B$EXCFR.IC);

    219  2 000022   000000 470400 xsym               LDP0    B$TCB$
         2 000023   000001 471500                    LDP1    1,,PR0
         2 000024   100004 236100                    LDQ     4,,PR1
         2 000025   000022 772000                    QRL     18
         2 000026   000000 235003                    LDA     0,DU
         2 000027   200006 757100                    STAQ    AT+2,,AUTO
         2 000030   000100 301500                    BTD
         2 000031   200006 000010                    NDSC9   AT+2,,AUTO               cn=0,s=lsgnf,sf=0,n=8
         2 000032   200004 230006                    NDSC9   AT,,AUTO                 cn=1,s=nosgn,sf=0,n=6
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:348  

     1692      220    1         CALL ALA$ERROR( ALA_E$LOGON_TRAP, AT );

    220  2 000033   200004 631500                    EPPR1   AT,,AUTO
         2 000034   200007 451500                    STP1    AT+3,,AUTO
         2 000035   000000 236000 3                  LDQ     0
         2 000036   200006 756100                    STQ     AT+2,,AUTO
         2 000037   200006 630500                    EPPR0   AT+2,,AUTO
         2 000040   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000041   000000 701000 xent               TSX1    ALA$ERROR
         2 000042   000000 011000                    NOP     0

     1693      221    1         CALL M$XXX;

    221  2 000043   000003 713400                    CLIMB   3
         2 000044   000000 401760                    pmme    nvectors=0

     1694      222    1   END ALA$TRAP;

    222  2 000045   000000 702200 xent               TSX2  ! X66_AARET

PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:349  
--  Include file information  --

   AL_PERR_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure ALA$TRAP.
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:350  

 **** Variables and constants ****

  ****  Section 001 RoData ALA$TRAP

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    12-0-0/w STRC        r     1 ALA_E$LOGON_TRAP           0-0-0/d STRC(360)   r     1 NO_TRAP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w STRC(63)    r     1 AT                         3-0-0/w BIT         r     1 ERR

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$EXCFR                    0-0-0/w STRC(144)   r     1 B$TCB


   Procedure ALA$TRAP requires 38 words for executable code.
   Procedure ALA$TRAP requires 8 words of local(AUTO) storage.

    No errors detected in file ALA$LOGON.:E05TSI    .
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:351  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:352  
          MINI XREF LISTING

ALA$ERROR
       205**DCL-ENT   214--CALL      220--CALL
ALA_E$LOGON_TRAP
       172**DCL       220<>CALL
AT
       207**DCL       220<>CALL
AT.COUNT
       208**DCL       218<<ASSIGN
AT.IC
       209**DCL       218--ASSIGN    219<<CALLBLT
B$EXCFR.ASL
       116**DCL       116--REDEF
B$EXCFR.ERR
       130**DCL       213>>ASSIGN
B$EXCFR.ERR.ERR#
       130**DCL       130--REDEF
B$EXCFR.EVID
       129**DCL       129--REDEF     130--REDEF
B$EXCFR.IC
       117**DCL       219>>CALLBLT
B$EXCFR.IR
       117**DCL       117--REDEF
B$EXCFR.PREVSZ
       116**DCL       116--REDEF
B$EXCFR.SUBC
       128**DCL       128--REDEF     129--REDEF     129--REDEF
B$TCB.STK$
       113**DCL       213>>ASSIGN    219>>CALLBLT
B$TCB$
       111**DCL       213>>ASSIGN    219>>CALLBLT
ERR
       206**DCL       213<<ASSIGN    214<>CALL
PL6.E3A0      #009=ALA$TRAP File=ALA$LOGON.:E05TSI                               TUE 07/29/97 08:32 Page:353  
IGNORE1
       211**LABEL     211--CALLALT
M$TRAP
        71**DCL-ENT   211--CALL
M$XXX
        29**DCL-ENT   221--CALL
NO_TRAP
       148**DCL       211<>CALL
NO_TRAP.V
       148**DCL       148--DCLINIT
