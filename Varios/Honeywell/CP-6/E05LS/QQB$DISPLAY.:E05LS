VERSION E05

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:1    
        1        1        /*M* QQB$DISPLAY - Perform  DISPLAY  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$DISPLAY:
        9        9                PROC;
       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE PC_MACRO_C;
       17     1303        %INCLUDE QQ_SUBS_C;
       18     1495        %INCLUDE QQ_MACROS_C;
       19     1920        %INCLUDE QQ_DATA_R;
       20     2166        %INCLUDE QQ_CMDFLAGS_R;
       21     2220        %INCLUDE QQ_PERR_C;
       22     2381        %INCLUDE Q_ERRCODE_C;
       23     2404        %INCLUDE XU_MACRO_C;
       24     5510        %INCLUDE XU_FORMAT_C;
       25     5672        %PAGE(ARG="Externally defined routines");

              5689    1   /***************************************************************************
              5690    1    *                                                                         *
              5691    1    *                        Externally defined routines                      *
              5692    1    *                                                                         *
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:2    
              5693    1    ***************************************************************************/

       26     5697    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       27     5698    1   DCL QQC$RLS_BLK ENTRY(2);
       28     5699    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       29     5700    1   DCL QQC$BLDMSG ENTRY(1);
       30     5701    1   DCL QQC$CONVERT_NUM ENTRY(3);
       31     5702    1   DCL QQC$PRINT_FMT ENTRY(2) ALTRET;
       32     5703    1   DCL QQC$SCREECH ENTRY;
       33     5704    1   DCL X$FORMAT ENTRY(1);
       34     5705        %PAGE(ARG="Symrefs");

              5722    1   /***************************************************************************
              5723    1    *                                                                         *
              5724    1    *                                  Symrefs                                *
              5725    1    *                                                                         *
              5726    1    ***************************************************************************/

       35     5730    1   DCL B$TCB$ PTR SYMREF;
       36     5731        %PAGE(ARG="DCBs");

              5748    1   /***************************************************************************
              5749    1    *                                                                         *
              5750    1    *                                    DCBs                                 *
              5751    1    *                                                                         *
              5752    1    ***************************************************************************/

       37     5756    1   DCL M$CG DCB;
       38     5757        %PAGE(ARG="Based");

              5774    1   /***************************************************************************
              5775    1    *                                                                         *
              5776    1    *                                   Based                                 *
              5777    1    *                                                                         *
              5778    1    ***************************************************************************/

       39     5782    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:3    
       40     5783    1   DCL BYTTE UBIN(9) UNAL BASED;
       41     5784    1   DCL FLAG BIT(1) ALIGNED BASED;
       42     5785    1   DCL UBIN_WORD UBIN WORD BASED;
       43     5786
       44     5787        %DISAB$INFO;
       45     5803        %TPU$INFO;
       46     5832        %PARSE$OUT(STCLASS=BASED);
       47     5877        %PARSE$SYM(STCLASS=BASED);
       48     5915        %PC$INSTANCE(STCLASS="BASED(QQ_GLOBAL.PC$INSTANCE$)");
       49     5965        %B$TCB;
       50     5968        %B$ALT;
       51     5976        %PAGE(ARG="Subs");

              5993    1   /***************************************************************************
              5994    1    *                                                                         *
              5995    1    *                                    Subs                                 *
              5996    1    *                                                                         *
              5997    1    ***************************************************************************/

       52     6001        %EQU_CG;
       53     6049        %PAGE(ARG="Constants");

              6066    1   /***************************************************************************
              6067    1    *                                                                         *
              6068    1    *                                 Constants                               *
              6069    1    *                                                                         *
              6070    1    ***************************************************************************/

       54     6074    1   DCL USE_FIELD UBIN WORD CONSTANT INIT(1);
       55     6075    1   DCL SKIP_FIELD UBIN WORD CONSTANT INIT(0);
       56     6076
       57     6077    1   DCL BLANK CHAR(1) CONSTANT INIT(' ');
       58     6078    1   DCL BLANK_YES(0:1) CHAR(3) CONSTANT INIT('NO','YES');
       59     6079    1   DCL TPU_STRANGER(0:1) CHAR(8) CONSTANT INIT('TPU', 'Stranger');
       60     6080    1   DCL DISABLE_FORMAT CHAR(0) CONSTANT INIT(' %A %5.360U %A');
       61     6081    1   DCL DCB_FORMAT CHAR(0) CONSTANT INIT(
              6081            ' %A %N(%5.360U%)%17-%8A %8A %6D     %3A     %4D');
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:4    
       62     6082    1   DCL TYPE_FORMAT CHAR(0) CONSTANT INIT('%A  %6D %3D   %A %6D  %6D    %6D    %A');
       63     6083
       64     6084        %VLP_NAME(FPTN=TEXTC_OFF, STCLASS=CONSTANT, NAME='OFF');
       65     6111        %VLP_NAME(FPTN=TEXTC_ON, STCLASS=CONSTANT, NAME='ON');
       66     6138        %PAGE(ARG="Static",PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:5    
              6155    1   /***************************************************************************
              6156    1    *                                                                         *
              6157    1    *                                   Static                                *
              6158    1    *                                                                         *
              6159    1    ***************************************************************************/

       67     6163        %F_FDS(OUTPUT=QQC$PRINT_FMT, DVFC=' ');
       68     6276        %PAGE(ARG="Auto");

              6293    1   /***************************************************************************
              6294    1    *                                                                         *
              6295    1    *                                    Auto                                 *
              6296    1    *                                                                         *
              6297    1    ***************************************************************************/

       69     6301    1   DCL CHAR_STRING_SIZE UBIN WORD;
       70     6302    1   DCL I UBIN WORD;
       71     6303    1   DCL K UBIN WORD;
       72     6304    1   DCL START_POS SBIN WORD;
       73     6305    1   DCL END_POS SBIN WORD;
       74     6306    1   DCL PARAM_NUM UBIN WORD;
       75     6307    1   DCL DISP_FMT UBIN WORD;
       76     6308    1   DCL SIZE UBIN WORD;
       77     6309    1   DCL NSUBLKS UBIN WORD;
       78     6310    1   DCL TYPE UBIN WORD;
       79     6311    1   DCL TYPLIST_MULT UBIN WORD;             /*  used in getting TYPLIST blocks    */
       80     6312
       81     6313    1   DCL SUBLK$ PTR;
       82     6314    1   DCL OPT$ PTR;
       83     6315    1   DCL TYPE$ PTR;
       84     6316    1   DCL NEXT$ PTR;
       85     6317    1   DCL P$ PTR;                   /*  used in QQC get and release blk routine     */
       86     6318    1   DCL Q$ PTR;                   /*  used in QQC get and release blk routine     */
       87     6319
       88     6320    1   DCL BUF CHAR(80);
       89     6321
       90     6322    1   DCL DATA_VECTRS(0:19) BIT(72);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:6    
       91     6323
       92     6324    1   DCL 1 CMDFLAGS,
       93     6325    1         2 INFO,
       94     6326        %CMD_FLAGS (STCLASS=, LVL=3, LAST=";");
       95     6371        %MSGBLK;
       96     6461        %VLP_NAME(FPTN=TEXTC_NUM, STCLASS=AUTO, LEN=8);
       97     6488        %VLP_NAME(FPTN=TEXTC_STRING, STCLASS=AUTO, LEN=60);
       98     6515        %VLP_NAME(FPTN=TEXTC_STRING2, STCLASS=AUTO,LEN=30);
       99     6542
      100     6543    1   DCL 1 ERR,
      101     6544    1         2 FCG BIT(12) UNAL,
      102     6545    1         2 MID BIT(6) UNAL,
      103     6546    1         2 MON BIT(1) UNAL,
      104     6547    1         2 CODE UBIN(14) UNAL,
      105     6548    1         2 SEV UBIN(3) UNAL;
      106     6549        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:7    
              6566    1   /***************************************************************************
              6567    1    *                                                                         *
              6568    1    *                                Error codes                              *
              6569    1    *                                                                         *
              6570    1    ***************************************************************************/

      107     6574        %ERRCODE(NAME=CODE_LPARAM1, CODE#=%E$LPARAM1, FCG#=%FCG_QQ, MID#=%MID_B);
      108     6581        %ERRCODE(NAME=CODE_STATITLE, CODE#=%E$STATITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      109     6588        %ERRCODE(NAME=CODE_FPTITLE, CODE#=%E$FPTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      110     6595        %ERRCODE(NAME=CODE_DCBTITLE, CODE#=%E$DCBTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      111     6602        %ERRCODE(NAME=CODE_TYPETITLE, CODE#=%E$TYPETITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      112     6609        %ERRCODE(NAME=CODE_UNKTYPE, CODE#=%E$UNKTYPE, FCG#=%FCG_QQ, MID#=%MID_B);
      113     6616        %ERRCODE(NAME=CODE_INVTYPE, CODE#=%E$INVTYPE, FCG#=%FCG_QQ, MID#=%MID_B);
      114     6623        %ERRCODE(NAME=CODE_LPARAM13, CODE#=%E$LPARAM13, FCG#=%FCG_QQ, MID#=%MID_B);
      115     6630        %ERRCODE(NAME=CODE_LPARAM15, CODE#=%E$LPARAM15, FCG#=%FCG_QQ, MID#=%MID_B);
      116     6637        %ERRCODE(NAME=CODE_NOTFOUND, CODE#=%E$NOTFOUND, FCG#=%FCG_QQ, MID#=%MID_B);
      117     6644        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
      118     6651
      119     6652        /*E* ERROR:       QQB-E$LPARAM1-C
      120     6653
      121     6654             MESSAGE:     ACCOUNTING %U1
      122     6655             DESCRIPTION: LET parameter display
      123     6656        */
      124     6657        /*E* ERROR:       QQB-E$LPARAM2-C
      125     6658
      126     6659             MESSAGE:     CGPAGEMAX %U1
      127     6660             DESCRIPTION: LET parameter display
      128     6661        */
      129     6662        /*E* ERROR:       QQB-E$LPARAM3-C
      130     6663
      131     6664             MESSAGE:     CGPAGMIN %U1
      132     6665             DESCRIPTION: LET parameter display
      133     6666        */
      134     6667        /*E* ERROR:       QQB-E$LPARAM4-C
      135     6668
      136     6669             MESSAGE:     CGSIZEMAX %U1
      137     6670             DESCRIPTION: LET parameter display
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:8    
      138     6671        */
      139     6672        /*E* ERROR:       QQB-E$LPARAM5-C
      140     6673
      141     6674             MESSAGE:     DCBCON %U1
      142     6675             DESCRIPTION: LET parameter display
      143     6676        */
      144     6677        /*E* ERROR:       QQB-E$LPARAM6-C
      145     6678
      146     6679             MESSAGE:     HISTORY %U1
      147     6680             DESCRIPTION: LET parameter display
      148     6681        */
      149     6682        /*E* ERROR:       QQB-E$LPARAM7-C
      150     6683
      151     6684             MESSAGE:     IXTNSIZE %U1
      152     6685             DESCRIPTION: LET parameter display
      153     6686        */
      154     6687        /*E* ERROR:       QQB-E$LPARAM8-C
      155     6688
      156     6689             MESSAGE:     JOURNAL %U1
      157     6690             DESCRIPTION: LET parameter display
      158     6691        */
      159     6692        /*E* ERROR:       QQB-E$LPARAM9-C
      160     6693
      161     6694             MESSAGE:     LOG %U1
      162     6695             DESCRIPTION: LET parameter display
      163     6696        */
      164     6697        /*E* ERROR:       QQB-E$LPARAM10-C
      165     6698
      166     6699             MESSAGE:     MCTID %U1
      167     6700             DESCRIPTION: LET parameter display
      168     6701        */
      169     6702        /*E* ERROR:       QQB-E$LPARAM11-C
      170     6703
      171     6704             MESSAGE:     NEWCG %U1
      172     6705             DESCRIPTION: LET parameter display
      173     6706        */
      174     6707        /*E* ERROR:       QQB-E$LPARAM12-C
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:9    
      175     6708
      176     6709             MESSAGE:     POOLSIZE %U1
      177     6710             DESCRIPTION: LET parameter display
      178     6711        */
      179     6712        /*E* ERROR:       QQB-E$LPARAM13-C
      180     6713
      181     6714             MESSAGE:     DISKWARN %U1
      182     6715             DESCRIPTION: LET parameter display
      183     6716        */
      184     6717        /*E* ERROR:       QQB-E$LPARAM14-C
      185     6718
      186     6719             MESSAGE:     STATIONMAX %U1
      187     6720             DESCRIPTION: LET parameter display
      188     6721        */
      189     6722        /*E* ERROR:       QQB-E$LPARAM15-C
      190     6723
      191     6724             MESSAGE:     MEMWARN %U1
      192     6725             DESCRIPTION: LET parameter display
      193     6726        */
      194     6727        /*E* ERROR:       QQB-E$LPARAM16-C
      195     6728
      196     6729             MESSAGE:     TPCPRU %U1
      197     6730             DESCRIPTION: LET parameter display
      198     6731        */
      199     6732        /*E* ERROR:       QQB-E$LPARAM17-C
      200     6733
      201     6734             MESSAGE:     TPUINITIAL %U1
      202     6735             DESCRIPTION: LET parameter display
      203     6736        */
      204     6737        /*E* ERROR:       QQB-E$LPARAM18-C
      205     6738
      206     6739             MESSAGE:     TPUMAX %U1
      207     6740             DESCRIPTION: LET parameter display
      208     6741        */
      209     6742        /*E* ERROR:       QQB-E$LPARAM19-C
      210     6743
      211     6744             MESSAGE:     TPUMIN %U1
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:10   
      212     6745             DESCRIPTION: LET parameter display
      213     6746        */
      214     6747        /*E* ERROR:       QQB-E$LPARAM20-C
      215     6748             MESSAGE:     CFPRU %U1
      216     6749             DESCRIPTION: Let parameter display
      217     6750        */
      218     6751        /*E* ERROR:       QQB-E$LPARAM21-C
      219     6752
      220     6753             MESSAGE:     XTNSIZE %U1
      221     6754             DESCRIPTION: LET parameter display
      222     6755        */
      223     6756        /*E* ERROR:       QQB-E$LPARAM22-C
      224     6757
      225     6758             MESSAGE:     HEADER  %U1%U2
      226     6759             DESCRIPTION: LET parameter display
      227     6760        */
      228     6761        /*E* ERROR:       QQB-E$LPARAM23-C
      229     6762
      230     6763             MESSAGE:     +       %U1%U2
      231     6764             DESCRIPTION: LET parameter display Continued
      232     6765        */
      233     6766        /*E*       ERROR: QQB-E$STATITLE-C
      234     6767
      235     6768                 MESSAGE: Station  Time Disabled by
      236     6769             DESCRIPTION: Title for Disabled stations display
      237     6770        */
      238     6771        /*E*       ERROR: QQB-E$FPTITLE-C
      239     6772
      240     6773                 MESSAGE: FP       Time  Disabled by
      241     6774             DESCRIPTION: Title for disabled forms programs display
      242     6775        */
      243     6776        /*E*       ERROR: QQB-E$DCBTITLE-C
      244     6777
      245     6778                 MESSAGE: Station  Time  Type     Msgtyp   Sysid  Disconnect Timeout
      246     6779             DESCRIPTION: Title for connect DCBs display
      247     6780        */
      248     6781        /*E*  ERROR:      QQB-E$TYPETITLE-C
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:11   
      249     6782
      250     6783            MESSAGE: Msgtyp   Writes Prio Jrnl Count  MaxActive CurActive OneRpt
      251     6784             DESCRIPTION: Title of the DISPLAY TYPE command.
      252     6785        */
      253     6786        /*E*       ERROR: QQB-E$UNKTYPE-C
      254     6787
      255     6788                 MESSAGE: Unknown message type
      256     6789             DESCRIPTION: The type you tried to display has never been used
      257     6790                          or defined.
      258     6791        */
      259     6792        /*E*       ERROR: QQB-E$INVTYPE-C
      260     6793
      261     6794                 MESSAGE: The specified type name is invalid.
      262     6795                          Wildcarded type may only have a ? as the last
      263     6796                          character of the form or transaction type,
      264     6797                          e. g., A?B? is illegal, ? or AB? are legal.
      265     6798             DESCRIPTION: Wild carded type is more restrictive
      266     6799                          than generalized wild carding.  The rules are
      267     6800                          only one ?, and the ? must be the last character
      268     6801                          of the type group.  In addition ? may not
      269     6802                          be the only character E.G., ????.
      270     6803        */
      271     6804        /*E*       ERROR: QQB-E$NOTFOUND-C
      272     6805
      273     6806                 MESSAGE: Nothing found.
      274     6807             DESCRIPTION: No type match the wildcarded display type is found.
      275     6808        */
      276     6809        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:12   
              6826    1   /***************************************************************************
              6827    1    *                                                                         *
              6828    1    *                                    FPTs                                 *
              6829    1    *                                                                         *
              6830    1    ***************************************************************************/

      277     6834        %FPT_CGINFO(DCB=M$CG, TYPLIST=NIL, QLIST=NIL);
      278     6854        %PAGE(ARG="VLPs");

              6871    1   /***************************************************************************
              6872    1    *                                                                         *
              6873    1    *                                    VLPs                                 *
              6874    1    *                                                                         *
              6875    1    ***************************************************************************/

      279     6879        %VLP_CGTYPL(STCLASS="BASED(P$)");
      280     6904        %VLP_CGTYPL(FPTN=VLP_CGTYPL_SEL,STCLASS=AUTO);
      281     6929        %VLP_CGQL(STCLASS="BASED(Q$)");
      282     6951        %VLP_CGQL(FPTN=VLP_CGQL_SEL,STCLASS=AUTO);
      283     6973        %PAGE(ARG="QQB$DISPLAY", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:13   
              6990    1   /***************************************************************************
              6991    1    *                                                                         *
              6992    1    *                                QQB$DISPLAY                              *
              6993    1    *                                                                         *
              6994    1    ***************************************************************************/

      284     6998    1           SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0);
      285     6999    1           IF SUBLK$ ~= ADDR(NIL)
      286     7000    1           THEN
      287     7001    1             DISP_FMT = SUBLK$ -> OUT$BLK.CODE;
      288     7002    1           ELSE                            /* Called from QQB$SPY                */
      289     7003    1             DISP_FMT = 2 /* OPT_DCB */;
      290     7004
      291     7005    2           DO CASE(DISP_FMT);
      292     7006    2             CASE(1 /* OPT_PARAMETER */);
      293     7007    2               CALL DISPLAY_PARAMETER;
      294     7008
      295     7009    2             CASE(2 /* OPT_DCB */);
      296     7010    2               CALL DISPLAY_DCB;
      297     7011
      298     7012    2             CASE(3 /* OPT_DISABLED */);
      299     7013    2               CALL DISPLAY_DISABLED;
      300     7014
      301     7015    2             CASE(4 /* DIS_TYPE */);
      302     7016    2               CALL DISPLAY_TYPE;
      303     7017
      304     7018    2           END /* CASE */;
      305     7019
      306     7020    1           RETURN;
      307     7021                %PAGE(ARG="SEND_HEADER_ENTRY", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:14   
              7038    1   /***************************************************************************
              7039    1    *                                                                         *
              7040    1    *                             SEND_HEADER_ENTRY                           *
              7041    1    *                                                                         *
              7042    1    ***************************************************************************/

      308     7046    1   QQB$DISPLAY_HEADER:
      309     7047    1           ENTRY;
      310     7048
      311     7049    1           PARAM_NUM = 39 /* LET_TPHEAD */;
      312     7050    1           CALL FORMAT_HEADER;
      313     7051    1           RETURN;
      314     7052
      315     7053                %PAGE(ARG="DISPLAY_PARAMETER", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:15   
              7070    1   /***************************************************************************
              7071    1    *                                                                         *
              7072    1    *                             DISPLAY_PARAMETER                           *
              7073    1    *                                                                         *
              7074    1    ***************************************************************************/

      316     7078    1   DISPLAY_PARAMETER:
      317     7079    1           PROC;
      318     7080
      319     7081    2           NSUBLKS = SUBLK$ -> OUT$BLK.NSUBLKS;
      320     7082
      321     7083    3           DO I = 0 TO NSUBLKS - 1;
      322     7084    3             OPT$ = SUBLK$ -> OUT$BLK.SUBLK$(I);
      323     7085    3             PARAM_NUM = OPT$ -> OUT$SYM.CODE;
      324     7086    3             IF PARAM_NUM = 1 /* OPT_ALL */ THEN
      325     7087    4               DO;
      326     7088    5                 DO K = 18 /* LOW_LET */ TO 39 /* HIGH_LET */;
      327     7089    5                   PARAM_NUM = K;
      328     7090    5                   CALL FORMAT_PARAM;
      329     7091    5                 END;
      330     7092    4               END;
      331     7093    3             ELSE
      332     7094    4               DO;
      333     7095    4                 CALL FORMAT_PARAM;
      334     7096    4               END;
      335     7097    3           END;
      336     7098
      337     7099    2           RETURN;
      338     7100    2   END DISPLAY_PARAMETER;
      339     7101                %PAGE(ARG="FORMAT_PARAM", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:16   
              7118    2   /***************************************************************************
              7119    2    *                                                                         *
              7120    2    *                                FORMAT_PARAM                             *
              7121    2    *                                                                         *
              7122    2    ***************************************************************************/

      340     7126    1   FORMAT_PARAM:
      341     7127    1           PROC;
      342     7128
      343     7129    2           IF (PARAM_NUM = 39 /* LET_TPHEAD */) THEN
      344     7130    3             DO;
      345     7131    3               CALL FORMAT_HEADER;
      346     7132    3               RETURN;
      347     7133    3             END;
      348     7134    2           ERR = CODE_LPARAM1;
      349     7135    2           CALL QQC$BLDMSG_BLK(MSGBLK);
      350     7136    2           CMDFLAGS = QQ_CMDFLAGS.INFO(PARAM_NUM);
      351     7137    2           ERR.CODE = ERR.CODE + PARAM_NUM - 18 /* LOW_LET */;
      352     7138    2           MSGBLK.ERRINFO.ERR(0) = ERR;
      353     7139
      354     7140    3           DO CASE(CMDFLAGS.INFO.TYPE#);
      355     7141    3             CASE(1 /* TYPE_LOGL */);
      356     7142    3               IF CMDFLAGS.INFO.DATA$# -> FLAG THEN
      357     7143    4                 DO;
      358     7144    4                   MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_ON);
      359     7145    4                 END;
      360     7146    3               ELSE
      361     7147    4                 DO;
      362     7148    4                   MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_OFF);
      363     7149    4                 END;
      364     7150
      365     7151    3             CASE(2 /* TYPE_UBIN */);
      366     7152    3               CALL QQC$CONVERT_NUM(CMDFLAGS.INFO.DATA$# -> UBIN_WORD,
      367     7153    3                   SIZE, ADDR(TEXTC_NUM.NAME#));
      368     7154    3               TEXTC_NUM.L# = SIZE;
      369     7155    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);
      370     7156
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:17   
      371     7157    3             CASE(3 /* TYPE_CHAR */);
      372     7158    3               CHAR_STRING_SIZE = CMDFLAGS.INFO.LEN#;
      373     7159    3               TEXTC_STRING.NAME# = CMDFLAGS.INFO.DATA$# -> CHAR$STRING;
      374     7160    3               TEXTC_STRING.L# = CHAR_STRING_SIZE;
      375     7161    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STRING);
      376     7162
      377     7163    3             CASE(4 /* TYPE_TEXTC */);
      378     7164    3               CHAR_STRING_SIZE = CMDFLAGS.INFO.DATA$# -> BYTTE;
      379     7165    3               CHAR_STRING_SIZE = CHAR_STRING_SIZE + 1;
      380     7166    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(CMDFLAGS.INFO.DATA$# -> CHAR$STRING);
      381     7167
      382     7168    3           END /* CASE */;
      383     7169
      384     7170    2           IF NOT CMDFLAGS.INFO.INHIBPRINT# THEN
      385     7171    3             DO;
      386     7172    3               CALL QQC$BLDMSG(MSGBLK);
      387     7173    3             END;
      388     7174
      389     7175    2           RETURN;
      390     7176
      391     7177    2   END FORMAT_PARAM;
      392     7178                %PAGE(ARG="DISPLAY_DISABLED", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:18   
              7195    2   /***************************************************************************
              7196    2    *                                                                         *
              7197    2    *                              DISPLAY_DISABLED                           *
              7198    2    *                                                                         *
              7199    2    ***************************************************************************/

      393     7203    1   DISPLAY_DISABLED:
      394     7204    1           PROC;
      395     7205
      396     7206    2           TYPE = SUBLK$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE;
      397     7207
      398     7208    2           IF TYPE = 1 /* OPT_STATION */ THEN
      399     7209    3             DO;
      400     7210    3               QQ_CMDBLK.MINOR_ERR = CODE_STATITLE;
      401     7211    3             END;
      402     7212    2           ELSE
      403     7213    3             DO;
      404     7214    3               QQ_CMDBLK.MINOR_ERR = CODE_FPTITLE;
      405     7215    3             END;
      406     7216
      407     7217    2           CALL QQC$BLDMSG_BLK(MSGBLK);
      408     7218    2           CALL QQC$BLDMSG(MSGBLK);
      409     7219
      410     7220    2           F_FDS.BUF_ = VECTOR(BUF);
      411     7221    2           F_FDS.VECTR$ = ADDR(DATA_VECTRS);
      412     7222    2           F_FDS.NVECS# = 3;
      413     7223    2           F_FDS.FMT_ = VECTOR(DISABLE_FORMAT);
      414     7224
      415     7225    2           NEXT$ = QQ_GLOBAL.DISAB$;
      416     7226
      417     7227    3           DO WHILE('1'B);
      418     7228    3             NEXT$ = NEXT$ -> DISAB$INFO.FLINK$;
      419     7229    3             IF NEXT$ -> DISAB$INFO.FLINK$ = ADDR(NIL) THEN
      420     7230    4               DO;
      421     7231    4                 GOTO RET;
      422     7232    4               END;
      423     7233
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:19   
      424     7234    3             IF NEXT$ -> DISAB$INFO.TYPE ~= TYPE THEN
      425     7235    4               DO;
      426     7236    4                 GOTO LOOP;
      427     7237    4               END;
      428     7238
      429     7239    3             D$ = NEXT$;
      430     7240    3             DATA_VECTRS(0) = VECTOR(DISAB$INFO.ITEM);
      431     7241    3             DATA_VECTRS(1) = VECTOR(DISAB$INFO.UTS);
      432     7242    3             DATA_VECTRS(2) = VECTOR(DISAB$INFO.ID);
      433     7243
      434     7244    3             CALL X$FORMAT(F_FDS);
      435     7245
      436     7246    3   LOOP:
      437     7247    3           END /* WHILE */;
      438     7248
      439     7249    2   RET:
      440     7250    2           RETURN;
      441     7251
      442     7252    2   END DISPLAY_DISABLED;
      443     7253                %PAGE(ARG="DISPLAY_TYPE", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:20   
              7270    2   /***************************************************************************
              7271    2    *                                                                         *
              7272    2    *                                DISPLAY_TYPE                             *
              7273    2    *                                                                         *
              7274    2    ***************************************************************************/

      444     7278    1   DISPLAY_TYPE:
      445     7279    1           PROC;
      446     7280
      447     7281    2           TYPLIST_MULT = 25;         /* multiplied by sizes of cgql + cgtypl    */
      448     7282    2           P$ = ADDR(NIL);
      449     7283                       /*  get enough memory for sizes of (vlp_cgql + vlp_cgtypl)     */
      450     7284    2           CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, (TYPLIST_MULT *
      451     7285    2               (SIZEW(VLP_CGQL) + SIZEW(VLP_CGTYPL.LIST(0)))) +
      452     7286    2               SIZEW(VLP_CGTYPL.FOUND#), P$ ) ALTRET(NO_MEM);
      453     7287    2           Q$ = PINCRW(P$, (SIZEW(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT) +
      454     7288    2               SIZEW(VLP_CGTYPL.FOUND#));
      455     7289
      456     7290
      457     7291    2           VLP_CGTYPL.FOUND# = 1;
      458     7292    2           VLP_CGTYPL_SEL.FOUND# = 1;
      459     7293
      460     7294    2           FPT_CGINFO.V.TYPFC# = 1; /* Select                    */
      461     7295
      462     7296    2           TYPE$ = SUBLK$ -> OUT$BLK.SUBLK$(0);
      463     7297    2           VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;
      464     7298    2           VLP_CGTYPL_SEL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;
      465     7299
      466     7300    2           FPT_CGINFO.TYPLIST_ = VECTOR(VLP_CGTYPL_SEL);
      467     7301    2           FPT_CGINFO.QLIST_ = VECTOR(VLP_CGQL_SEL);
      468     7302
      469     7303    2           CALL INDEX(I, '?', VLP_CGTYPL.LIST.NAME#(0)) ALTRET(NO_Q1);
      470     7304
      471     7305    2           IF TYPE$ -> OUT$SYM.COUNT - 1 ~= I THEN
      472     7306    3             DO;
      473     7307    3               QQ_CMDBLK.MINOR_ERR = CODE_INVTYPE;
      474     7308    3               GOTO PRINT_ERR;
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:21   
      475     7309    3             END;
      476     7310    2           FPT_CGINFO.V.TYPFC# = 3; /* Wildcarded                  */
      477     7311    2           CHAR_STRING_SIZE = (SIZEC(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT)
      478     7312    2               + SIZEC(VLP_CGTYPL.FOUND#);
      479     7313    2           FPT_CGINFO.TYPLIST_ = VECTOR(P$ -> CHAR$STRING);
      480     7314    2           CHAR_STRING_SIZE = SIZEC(VLP_CGQL) * TYPLIST_MULT;
      481     7315    2           FPT_CGINFO.QLIST_ = VECTOR(Q$ -> CHAR$STRING);
      482     7316    2           TYPLIST_MULT = TYPLIST_MULT + 25; /* array size += 25                 */
      483     7317
      484     7318    2   NO_Q1:
      485     7319    2           CALL M$CGINFO(FPT_CGINFO) ALTRET(CGINFO_ERR);
      486     7320
      487     7321    3           DO WHILE('0'B);
      488     7322
      489     7323    3   CGINFO_ERR:
      490     7324    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 1153
      491     7325    3   /* E$CGAFNT */ THEN
      492     7326    3               QQ_CMDBLK.MINOR_ERR = CODE_UNKTYPE;
      493     7327    3             ELSE IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 1148
      494     7328    3   /* E$CGITLS */ THEN
      495     7329    4                 DO;
      496     7330                                      /* This case only happens with wildcarded types */
      497     7331    4                   IF P$ ~= ADDR(NIL) THEN
      498     7332    5                     DO;                   /* a previous GET_BLK was done        */
      499     7333
      500     7334    5                       CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, P$);
      501     7335    5                       P$ = ADDR(NIL);
      502     7336
      503     7337    5                     END;
      504     7338                        /* increment by typlist multiplier * (sizes of
      505     7339                                 vlp_cgql + vlp_cgtypl)
      506     7340                        */
      507     7341    4                   CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, (TYPLIST_MULT *
      508     7342    4                       (SIZEW(VLP_CGQL) + SIZEW(VLP_CGTYPL.LIST(0)))) +
      509     7343    4                       SIZEW(VLP_CGTYPL.FOUND#), P$) ALTRET(NO_MEM);
      510     7344    4                   Q$ = PINCRW(P$, (SIZEW(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT)
      511     7345    4                       + SIZEW(VLP_CGTYPL.FOUND#));
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:22   
      512     7346                                      /* refill in pertinent information for CGINFO   */
      513     7347    4                   VLP_CGTYPL.FOUND# = 1;
      514     7348    4                   VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;
      515     7349    4                   CHAR_STRING_SIZE = (SIZEC(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT)
      516     7350    4                       + SIZEC(VLP_CGTYPL.FOUND#);
      517     7351    4                   FPT_CGINFO.TYPLIST_ = VECTOR(P$ -> CHAR$STRING);
      518     7352    4                   CHAR_STRING_SIZE = SIZEC(VLP_CGQL) * TYPLIST_MULT;
      519     7353    4                   FPT_CGINFO.QLIST_ = VECTOR(Q$ -> CHAR$STRING);
      520     7354    4                   TYPLIST_MULT = TYPLIST_MULT + 25;
      521     7355
      522     7356    4                   GOTO NO_Q1;             /* try M$CGINFO again                 */
      523     7357    4                 END;
      524     7358    3               ELSE
      525     7359    3                 GOTO MON_ERR;
      526     7360    3   PRINT_ERR:
      527     7361    3             CALL QQC$BLDMSG_BLK(MSGBLK);
      528     7362    3             CALL QQC$BLDMSG(MSGBLK);
      529     7363    3             GOTO RET;
      530     7364    3           END /* NEVER */;
      531     7365
      532     7366    2           IF VLP_CGTYPL.FOUND# = 0 THEN
      533     7367    3             DO;
      534     7368    3               QQ_CMDBLK.MINOR_ERR = CODE_NOTFOUND;
      535     7369    3               GOTO PRINT_ERR;
      536     7370    3             END;
      537     7371
      538     7372    2           IF FPT_CGINFO.V.TYPFC# = 1 THEN /* Select             */
      539     7373    3             DO;
      540     7374    3               VLP_CGTYPL = VLP_CGTYPL_SEL;
      541     7375    3               VLP_CGQL = VLP_CGQL_SEL;
      542     7376    3             END;
      543     7377
      544     7378    2           QQ_CMDBLK.MINOR_ERR = CODE_TYPETITLE;
      545     7379    2           CALL QQC$BLDMSG_BLK(MSGBLK);
      546     7380    2           CALL QQC$BLDMSG(MSGBLK);
      547     7381
      548     7382    2           F_FDS.BUF_ = VECTOR(BUF);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:23   
      549     7383    2           F_FDS.VECTR$ = ADDR(DATA_VECTRS);
      550     7384    2           F_FDS.NVECS# = 8;
      551     7385    2           F_FDS.FMT_ = VECTOR(TYPE_FORMAT);
      552     7386
      553     7387    3           DO I = 0 TO VLP_CGTYPL.FOUND# - 1;
      554     7388    3             DATA_VECTRS(0) = VECTOR(VLP_CGTYPL.LIST.NAME#(I));
      555     7389
      556     7390    3             DATA_VECTRS(1) = VECTOR(VLP_CGTYPL.LIST.NUMWRITES#(I));
      557     7391
      558     7392    3             DATA_VECTRS(2) = VECTOR(VLP_CGTYPL.LIST.PRIO#(I));
      559     7393
      560     7394    3             DATA_VECTRS(3) = VECTOR(BLANK_YES(BITBIN(VLP_CGTYPL.LIST.JOURNAL#(I))));
      561     7395
      562     7396    3             DATA_VECTRS(4) = VECTOR(VLP_CGQL.LIST.MSGCNT#(I));
      563     7397
      564     7398    3             DATA_VECTRS(5) = VECTOR(VLP_CGQL.LIST.MXACT#(I));
      565     7399
      566     7400    3             DATA_VECTRS(6) = VECTOR(VLP_CGQL.LIST.CNACT#(I));
      567     7401
      568     7402    3             DATA_VECTRS(7) = VECTOR(BLANK_YES(BITBIN(VLP_CGTYPL.LIST.ONEREPORT#(I))));
      569     7403    3             CALL X$FORMAT(F_FDS);
      570     7404    3           END;                            /* of Do loop                         */
      571     7405
      572     7406    2   RET:
      573     7407    2           IF P$ ~= ADDR(NIL) THEN
      574     7408    3             DO;
      575     7409    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, P$);
      576     7410    3               P$ = ADDR(NIL);
      577     7411    3             END;
      578     7412    2           RETURN;
      579     7413
      580     7414    2   MON_ERR:
      581     7415    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;
      582     7416    2           CALL QQC$SCREECH;
      583     7417
      584     7418    2   NO_MEM:
      585     7419
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:24   
      586     7420    2           QQ_CMDBLK.MINOR_ERR = CODE_NO_POOLMEM;
      587     7421    2           CALL QQC$BLDMSG_BLK(MSGBLK);
      588     7422    2           CALL QQC$BLDMSG(MSGBLK);
      589     7423    2           RETURN;
      590     7424
      591     7425    2   END DISPLAY_TYPE;
      592     7426                %PAGE(ARG="DISPLAY_DCB", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:25   
              7443    2   /***************************************************************************
              7444    2    *                                                                         *
              7445    2    *                                DISPLAY_DCB                              *
              7446    2    *                                                                         *
              7447    2    ***************************************************************************/

      593     7451    1   DISPLAY_DCB:
      594     7452    1           PROC;
      595     7453
      596     7454    2           QQ_CMDBLK.MINOR_ERR = CODE_DCBTITLE;
      597     7455    2           CALL QQC$BLDMSG_BLK(MSGBLK);
      598     7456    2           CALL QQC$BLDMSG(MSGBLK);
      599     7457
      600     7458    2           F_FDS.BUF_ = VECTOR(BUF);
      601     7459    2           F_FDS.VECTR$ = ADDR(DATA_VECTRS);
      602     7460    2           F_FDS.NVECS# = 8;
      603     7461    2           F_FDS.FMT_ = VECTOR(DCB_FORMAT);
      604     7462
      605     7463    2           NEXT$ = QQ_GLOBAL.TPU$;
      606     7464
      607     7465    3           DO WHILE('1'B);
      608     7466    3             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;
      609     7467    3             IF NEXT$ -> TPU$INFO.FLINK$ = ADDR(NIL) THEN
      610     7468    4               DO;
      611     7469    4                 GOTO RET;
      612     7470    4               END;
      613     7471
      614     7472    3             T$ = NEXT$;
      615     7473    3             DATA_VECTRS(0) = VECTOR(TPU$INFO.STATION);
      616     7474
      617     7475    3             IF TPU$INFO.FLAGS.CONNECT THEN
      618     7476    4               DO;
      619     7477    4                 DATA_VECTRS(1) = VECTOR(USE_FIELD);
      620     7478    4                 DATA_VECTRS(2) = VECTOR(TPU$INFO.UTS);
      621     7479    4               END;
      622     7480    3             ELSE
      623     7481    4               DO;
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:26   
      624     7482    4                 DATA_VECTRS(1) = VECTOR(SKIP_FIELD);
      625     7483    4                 DATA_VECTRS(2) = VECTOR(NIL);
      626     7484    4               END;
      627     7485
      628     7486    3             DATA_VECTRS(3) = VECTOR(TPU_STRANGER(
      629     7487    3                 BITBIN(TPU$INFO.FLAGS.STRANGER)));
      630     7488
      631     7489    3             IF TPU$INFO.FLAGS.TPU THEN
      632     7490    4               DO;
      633     7491    4                 DATA_VECTRS(4) = VECTOR(TPU$INFO.MSGTYP);
      634     7492    4               END;
      635     7493    3             ELSE
      636     7494    4               DO;
      637     7495    4                 DATA_VECTRS(4) = VECTOR(BLANK);
      638     7496    4               END;
      639     7497
      640     7498    3             DATA_VECTRS(5) = VECTOR(TPU$INFO.SYSID);
      641     7499
      642     7500    3             DATA_VECTRS(6) = VECTOR(BLANK_YES(BITBIN(TPU$INFO.FLAGS.DISCONNECT)));
      643     7501
      644     7502    3             DATA_VECTRS(7) = VECTOR(TPU$INFO.TIMEOUT);
      645     7503
      646     7504    3             CALL X$FORMAT(F_FDS);
      647     7505
      648     7506    3   LOOP:
      649     7507    3           END /* WHILE */;
      650     7508
      651     7509    2   RET:
      652     7510    2           RETURN;
      653     7511
      654     7512    2   END DISPLAY_DCB;
      655     7513                %PAGE(ARG="FORMAT_HEADER", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:27   
              7530    2   /***************************************************************************
              7531    2    *                                                                         *
              7532    2    *                               FORMAT_HEADER                             *
              7533    2    *                                                                         *
              7534    2    ***************************************************************************/

      656     7538    1   FORMAT_HEADER:
      657     7539    1           PROC;
      658     7540
      659     7541    2           ERR = CODE_LPARAM1;
      660     7542    2           ERR.CODE = ERR.CODE + PARAM_NUM - 18 /* LOW_LET */;
      661     7543    2           START_POS = 0;
      662     7544
      663     7545    2           IF (PC$INSTANCE.HDR.CNT = 0) THEN
      664     7546    3             DO;
      665     7547    3               TEXTC_STRING.NAME# ='NONE';
      666     7548    3               TEXTC_STRING.L# = 4;
      667     7549    3               END_POS = 4;
      668     7550    3               GOTO SEND_HEADER;
      669     7551
      670     7552    3             END;
      671     7553    3           ELSE DO;              /* FORMAT HEADER MESSAGE INTO LINES OF 30 CHARS */
      672     7554    4               DO WHILE (START_POS < PC$INSTANCE.HDR.CNT) ;
      673     7555    4                 END_POS = START_POS + 60; /* MAX_LENGTH OF TEXTC                */
      674     7556    5                 DO WHILE (SUBSTR(PC$INSTANCE.HDR.MSG,END_POS,1) ~= ' ')
      675     7557    5                     AND (END_POS > START_POS);
      676     7558    5                   END_POS = END_POS - 1;
      677     7559    5                 END;                      /* FOUND A WORD BREAK  OR60CHARACTERS */
      678     7560    4                 IF (END_POS = START_POS) THEN END_POS = START_POS + 60;
      679     7561
      680     7562    4                 TEXTC_STRING.L# = END_POS - START_POS;
      681     7563    4                 TEXTC_STRING.NAME# = SUBSTR(PC$INSTANCE.HDR.MSG,
      682     7564    4                     START_POS,
      683     7565    4                     END_POS-START_POS);
      684     7566    4   SEND_HEADER:  CALL QQC$BLDMSG_BLK(MSGBLK);
      685     7567    4                 MSGBLK.ERRINFO.ERR(0) = ERR;
      686     7568    4                 IF (TEXTC_STRING.L# < 31) THEN /* Max substituion               */
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:28   
      687     7569    4                   MSGBLK.ERRINFO.FIELD2(0) = VECTOR(NIL);
      688     7570    5                 ELSE DO;             /* String is too long for one substition   */
      689     7571                                 /* move the second half to a second substitution     */
      690     7572    5                     TEXTC_STRING2.NAME# = SUBSTR(TEXTC_STRING.NAME#,
      691     7573    5                         31,
      692     7574    5                         TEXTC_STRING.L# - 30);
      693     7575    5                     TEXTC_STRING2.L# = TEXTC_STRING.L# - 30;
      694     7576    5                     MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_STRING2);
      695     7577
      696     7578                                                /* Delete that half from TEXTC_STRING */
      697     7579    5                     TEXTC_STRING.L# = 31;
      698     7580    5                   END ;                   /* ELSE                               */
      699     7581
      700     7582    4                 MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STRING);
      701     7583    4                 CALL QQC$BLDMSG(MSGBLK);
      702     7584
      703     7585                                                /* Move to Continuation ERR message   */
      704     7586    4                 ERR = CODE_LPARAM1;
      705     7587    4                 ERR.CODE = ERR.CODE + PARAM_NUM - 18 /* LOW_LET */ + 1;
      706     7588
      707     7589    4                 START_POS = END_POS + 1;
      708     7590    4               END;                        /* DO WHILE START_POS                 */
      709     7591    3             END;                          /* ELSE DO                            */
      710     7592    2           RETURN;
      711     7593
      712     7594    2   END FORMAT_HEADER;
      713     7595    1   END QQB$DISPLAY;

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:29   
--  Include file information  --

   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_CMDFLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$DISPLAY.

   Procedure QQB$DISPLAY requires 859 words for executable code.
   Procedure QQB$DISPLAY requires 164 words of local(AUTO) storage.

    No errors detected in file QQB$DISPLAY.:E05TSI    .

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:30   

 Object Unit name= QQB$DISPLAY                                File name= QQB$DISPLAY.:E05TOU
 UTS= JUL 30 '97 05:30:03.36 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$CG
    2  RoData even  UTS     49     61  QQB$DISPLAY
    3   Data  even  none    80    120  QQB$DISPLAY
    4   Proc  even  none   859   1533  QQB$DISPLAY
    5  RoData even  none    33     41  QQB$DISPLAY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  QQB$DISPLAY
     4     43                  yes      Std        0  QQB$DISPLAY_HEADER
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:31   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 QQC$PRINT_FMT
         yes           Std       1 QQC$BLDMSG_BLK
         yes           Std       1 QQC$BLDMSG
         yes           Std       3 QQC$CONVERT_NUM
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 QQC$GET_BLK
         yes           Std       2 QQC$RLS_BLK
         yes           Std       0 QQC$SCREECH
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  QQ_CMDBLK                             QQ_GLOBAL
     QQ_CMDFLAGS                           B$TCB$                                M$CG
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     NULLSID                               ISSID
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:32   


        1        1        /*M* QQB$DISPLAY - Perform  DISPLAY  command */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* IND=2, DCI=4, CSU=2, ECU=4, DTI=2, CTI=4, AND */
        8        8        QQB$DISPLAY:
        9        9                PROC;

      9  4 000000   000000 700200 xent  QQB$DISPLAY  TSX0  ! X66_AUTO_0
         4 000001   000244 000000                    ZERO    164,0

       10       10
       11       11        %INCLUDE Q_PAGE_C;
       12       43        %SET LISTEXP = '1'B;
       13       44        %PAGE(ARG="Includes");

                61        /***************************************************************************
                62         *                                                                         *
                63         *                                  Includes                               *
                64         *                                                                         *
                65         ***************************************************************************/

       14       69        %INCLUDE CP_6;
       15      150        %INCLUDE B_ERRORS_C;
       16     1277        %INCLUDE PC_MACRO_C;
       17     1303        %INCLUDE QQ_SUBS_C;
       18     1495        %INCLUDE QQ_MACROS_C;
       19     1920        %INCLUDE QQ_DATA_R;
       20     2166        %INCLUDE QQ_CMDFLAGS_R;
       21     2220        %INCLUDE QQ_PERR_C;
       22     2381        %INCLUDE Q_ERRCODE_C;
       23     2404        %INCLUDE XU_MACRO_C;
       24     5510        %INCLUDE XU_FORMAT_C;
       25     5672        %PAGE(ARG="Externally defined routines");
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:33   

              5689    1   /***************************************************************************
              5690    1    *                                                                         *
              5691    1    *                        Externally defined routines                      *
              5692    1    *                                                                         *
              5693    1    ***************************************************************************/

       26     5697    1   DCL QQC$GET_BLK ENTRY(3) ALTRET;
       27     5698    1   DCL QQC$RLS_BLK ENTRY(2);
       28     5699    1   DCL QQC$BLDMSG_BLK ENTRY(1);
       29     5700    1   DCL QQC$BLDMSG ENTRY(1);
       30     5701    1   DCL QQC$CONVERT_NUM ENTRY(3);
       31     5702    1   DCL QQC$PRINT_FMT ENTRY(2) ALTRET;
       32     5703    1   DCL QQC$SCREECH ENTRY;
       33     5704    1   DCL X$FORMAT ENTRY(1);
       34     5705        %PAGE(ARG="Symrefs");

              5722    1   /***************************************************************************
              5723    1    *                                                                         *
              5724    1    *                                  Symrefs                                *
              5725    1    *                                                                         *
              5726    1    ***************************************************************************/

       35     5730    1   DCL B$TCB$ PTR SYMREF;
       36     5731        %PAGE(ARG="DCBs");

              5748    1   /***************************************************************************
              5749    1    *                                                                         *
              5750    1    *                                    DCBs                                 *
              5751    1    *                                                                         *
              5752    1    ***************************************************************************/

       37     5756    1   DCL M$CG DCB;
       38     5757        %PAGE(ARG="Based");

              5774    1   /***************************************************************************
              5775    1    *                                                                         *
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:34   
              5776    1    *                                   Based                                 *
              5777    1    *                                                                         *
              5778    1    ***************************************************************************/

       39     5782    1   DCL CHAR$STRING CHAR(CHAR_STRING_SIZE) BASED;
       40     5783    1   DCL BYTTE UBIN(9) UNAL BASED;
       41     5784    1   DCL FLAG BIT(1) ALIGNED BASED;
       42     5785    1   DCL UBIN_WORD UBIN WORD BASED;
       43     5786
       44     5787        %DISAB$INFO;
       45     5803        %TPU$INFO;
       46     5832        %PARSE$OUT(STCLASS=BASED);
       47     5877        %PARSE$SYM(STCLASS=BASED);
       48     5915        %PC$INSTANCE(STCLASS="BASED(QQ_GLOBAL.PC$INSTANCE$)");
       49     5965        %B$TCB;
       50     5968        %B$ALT;
       51     5976        %PAGE(ARG="Subs");

              5993    1   /***************************************************************************
              5994    1    *                                                                         *
              5995    1    *                                    Subs                                 *
              5996    1    *                                                                         *
              5997    1    ***************************************************************************/

       52     6001        %EQU_CG;
       53     6049        %PAGE(ARG="Constants");

              6066    1   /***************************************************************************
              6067    1    *                                                                         *
              6068    1    *                                 Constants                               *
              6069    1    *                                                                         *
              6070    1    ***************************************************************************/

       54     6074    1   DCL USE_FIELD UBIN WORD CONSTANT INIT(1);
       55     6075    1   DCL SKIP_FIELD UBIN WORD CONSTANT INIT(0);
       56     6076
       57     6077    1   DCL BLANK CHAR(1) CONSTANT INIT(' ');
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:35   
       58     6078    1   DCL BLANK_YES(0:1) CHAR(3) CONSTANT INIT('NO','YES');
       59     6079    1   DCL TPU_STRANGER(0:1) CHAR(8) CONSTANT INIT('TPU', 'Stranger');
       60     6080    1   DCL DISABLE_FORMAT CHAR(0) CONSTANT INIT(' %A %5.360U %A');
       61     6081    1   DCL DCB_FORMAT CHAR(0) CONSTANT INIT(
              6081            ' %A %N(%5.360U%)%17-%8A %8A %6D     %3A     %4D');
       62     6082    1   DCL TYPE_FORMAT CHAR(0) CONSTANT INIT('%A  %6D %3D   %A %6D  %6D    %6D    %A');
       63     6083
       64     6084        %VLP_NAME(FPTN=TEXTC_OFF, STCLASS=CONSTANT, NAME='OFF');
       65     6111        %VLP_NAME(FPTN=TEXTC_ON, STCLASS=CONSTANT, NAME='ON');
       66     6138        %PAGE(ARG="Static",PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:36   
              6155    1   /***************************************************************************
              6156    1    *                                                                         *
              6157    1    *                                   Static                                *
              6158    1    *                                                                         *
              6159    1    ***************************************************************************/

       67     6163        %F_FDS(OUTPUT=QQC$PRINT_FMT, DVFC=' ');
       68     6276        %PAGE(ARG="Auto");

              6293    1   /***************************************************************************
              6294    1    *                                                                         *
              6295    1    *                                    Auto                                 *
              6296    1    *                                                                         *
              6297    1    ***************************************************************************/

       69     6301    1   DCL CHAR_STRING_SIZE UBIN WORD;
       70     6302    1   DCL I UBIN WORD;
       71     6303    1   DCL K UBIN WORD;
       72     6304    1   DCL START_POS SBIN WORD;
       73     6305    1   DCL END_POS SBIN WORD;
       74     6306    1   DCL PARAM_NUM UBIN WORD;
       75     6307    1   DCL DISP_FMT UBIN WORD;
       76     6308    1   DCL SIZE UBIN WORD;
       77     6309    1   DCL NSUBLKS UBIN WORD;
       78     6310    1   DCL TYPE UBIN WORD;
       79     6311    1   DCL TYPLIST_MULT UBIN WORD;             /*  used in getting TYPLIST blocks    */
       80     6312
       81     6313    1   DCL SUBLK$ PTR;
       82     6314    1   DCL OPT$ PTR;
       83     6315    1   DCL TYPE$ PTR;
       84     6316    1   DCL NEXT$ PTR;
       85     6317    1   DCL P$ PTR;                   /*  used in QQC get and release blk routine     */
       86     6318    1   DCL Q$ PTR;                   /*  used in QQC get and release blk routine     */
       87     6319
       88     6320    1   DCL BUF CHAR(80);
       89     6321
       90     6322    1   DCL DATA_VECTRS(0:19) BIT(72);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:37   
       91     6323
       92     6324    1   DCL 1 CMDFLAGS,
       93     6325    1         2 INFO,
       94     6326        %CMD_FLAGS (STCLASS=, LVL=3, LAST=";");
       95     6371        %MSGBLK;
       96     6461        %VLP_NAME(FPTN=TEXTC_NUM, STCLASS=AUTO, LEN=8);
       97     6488        %VLP_NAME(FPTN=TEXTC_STRING, STCLASS=AUTO, LEN=60);
       98     6515        %VLP_NAME(FPTN=TEXTC_STRING2, STCLASS=AUTO,LEN=30);
       99     6542
      100     6543    1   DCL 1 ERR,
      101     6544    1         2 FCG BIT(12) UNAL,
      102     6545    1         2 MID BIT(6) UNAL,
      103     6546    1         2 MON BIT(1) UNAL,
      104     6547    1         2 CODE UBIN(14) UNAL,
      105     6548    1         2 SEV UBIN(3) UNAL;
      106     6549        %PAGE(ARG="Error codes", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:38   
              6566    1   /***************************************************************************
              6567    1    *                                                                         *
              6568    1    *                                Error codes                              *
              6569    1    *                                                                         *
              6570    1    ***************************************************************************/

      107     6574        %ERRCODE(NAME=CODE_LPARAM1, CODE#=%E$LPARAM1, FCG#=%FCG_QQ, MID#=%MID_B);
      108     6581        %ERRCODE(NAME=CODE_STATITLE, CODE#=%E$STATITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      109     6588        %ERRCODE(NAME=CODE_FPTITLE, CODE#=%E$FPTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      110     6595        %ERRCODE(NAME=CODE_DCBTITLE, CODE#=%E$DCBTITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      111     6602        %ERRCODE(NAME=CODE_TYPETITLE, CODE#=%E$TYPETITLE, FCG#=%FCG_QQ, MID#=%MID_B);
      112     6609        %ERRCODE(NAME=CODE_UNKTYPE, CODE#=%E$UNKTYPE, FCG#=%FCG_QQ, MID#=%MID_B);
      113     6616        %ERRCODE(NAME=CODE_INVTYPE, CODE#=%E$INVTYPE, FCG#=%FCG_QQ, MID#=%MID_B);
      114     6623        %ERRCODE(NAME=CODE_LPARAM13, CODE#=%E$LPARAM13, FCG#=%FCG_QQ, MID#=%MID_B);
      115     6630        %ERRCODE(NAME=CODE_LPARAM15, CODE#=%E$LPARAM15, FCG#=%FCG_QQ, MID#=%MID_B);
      116     6637        %ERRCODE(NAME=CODE_NOTFOUND, CODE#=%E$NOTFOUND, FCG#=%FCG_QQ, MID#=%MID_B);
      117     6644        %ERRCODE(NAME=CODE_NO_POOLMEM, CODE#=%E$NO_POOLMEM, FCG#=%FCG_QQ, MID#=%MID_A);
      118     6651
      119     6652        /*E* ERROR:       QQB-E$LPARAM1-C
      120     6653
      121     6654             MESSAGE:     ACCOUNTING %U1
      122     6655             DESCRIPTION: LET parameter display
      123     6656        */
      124     6657        /*E* ERROR:       QQB-E$LPARAM2-C
      125     6658
      126     6659             MESSAGE:     CGPAGEMAX %U1
      127     6660             DESCRIPTION: LET parameter display
      128     6661        */
      129     6662        /*E* ERROR:       QQB-E$LPARAM3-C
      130     6663
      131     6664             MESSAGE:     CGPAGMIN %U1
      132     6665             DESCRIPTION: LET parameter display
      133     6666        */
      134     6667        /*E* ERROR:       QQB-E$LPARAM4-C
      135     6668
      136     6669             MESSAGE:     CGSIZEMAX %U1
      137     6670             DESCRIPTION: LET parameter display
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:39   
      138     6671        */
      139     6672        /*E* ERROR:       QQB-E$LPARAM5-C
      140     6673
      141     6674             MESSAGE:     DCBCON %U1
      142     6675             DESCRIPTION: LET parameter display
      143     6676        */
      144     6677        /*E* ERROR:       QQB-E$LPARAM6-C
      145     6678
      146     6679             MESSAGE:     HISTORY %U1
      147     6680             DESCRIPTION: LET parameter display
      148     6681        */
      149     6682        /*E* ERROR:       QQB-E$LPARAM7-C
      150     6683
      151     6684             MESSAGE:     IXTNSIZE %U1
      152     6685             DESCRIPTION: LET parameter display
      153     6686        */
      154     6687        /*E* ERROR:       QQB-E$LPARAM8-C
      155     6688
      156     6689             MESSAGE:     JOURNAL %U1
      157     6690             DESCRIPTION: LET parameter display
      158     6691        */
      159     6692        /*E* ERROR:       QQB-E$LPARAM9-C
      160     6693
      161     6694             MESSAGE:     LOG %U1
      162     6695             DESCRIPTION: LET parameter display
      163     6696        */
      164     6697        /*E* ERROR:       QQB-E$LPARAM10-C
      165     6698
      166     6699             MESSAGE:     MCTID %U1
      167     6700             DESCRIPTION: LET parameter display
      168     6701        */
      169     6702        /*E* ERROR:       QQB-E$LPARAM11-C
      170     6703
      171     6704             MESSAGE:     NEWCG %U1
      172     6705             DESCRIPTION: LET parameter display
      173     6706        */
      174     6707        /*E* ERROR:       QQB-E$LPARAM12-C
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:40   
      175     6708
      176     6709             MESSAGE:     POOLSIZE %U1
      177     6710             DESCRIPTION: LET parameter display
      178     6711        */
      179     6712        /*E* ERROR:       QQB-E$LPARAM13-C
      180     6713
      181     6714             MESSAGE:     DISKWARN %U1
      182     6715             DESCRIPTION: LET parameter display
      183     6716        */
      184     6717        /*E* ERROR:       QQB-E$LPARAM14-C
      185     6718
      186     6719             MESSAGE:     STATIONMAX %U1
      187     6720             DESCRIPTION: LET parameter display
      188     6721        */
      189     6722        /*E* ERROR:       QQB-E$LPARAM15-C
      190     6723
      191     6724             MESSAGE:     MEMWARN %U1
      192     6725             DESCRIPTION: LET parameter display
      193     6726        */
      194     6727        /*E* ERROR:       QQB-E$LPARAM16-C
      195     6728
      196     6729             MESSAGE:     TPCPRU %U1
      197     6730             DESCRIPTION: LET parameter display
      198     6731        */
      199     6732        /*E* ERROR:       QQB-E$LPARAM17-C
      200     6733
      201     6734             MESSAGE:     TPUINITIAL %U1
      202     6735             DESCRIPTION: LET parameter display
      203     6736        */
      204     6737        /*E* ERROR:       QQB-E$LPARAM18-C
      205     6738
      206     6739             MESSAGE:     TPUMAX %U1
      207     6740             DESCRIPTION: LET parameter display
      208     6741        */
      209     6742        /*E* ERROR:       QQB-E$LPARAM19-C
      210     6743
      211     6744             MESSAGE:     TPUMIN %U1
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:41   
      212     6745             DESCRIPTION: LET parameter display
      213     6746        */
      214     6747        /*E* ERROR:       QQB-E$LPARAM20-C
      215     6748             MESSAGE:     CFPRU %U1
      216     6749             DESCRIPTION: Let parameter display
      217     6750        */
      218     6751        /*E* ERROR:       QQB-E$LPARAM21-C
      219     6752
      220     6753             MESSAGE:     XTNSIZE %U1
      221     6754             DESCRIPTION: LET parameter display
      222     6755        */
      223     6756        /*E* ERROR:       QQB-E$LPARAM22-C
      224     6757
      225     6758             MESSAGE:     HEADER  %U1%U2
      226     6759             DESCRIPTION: LET parameter display
      227     6760        */
      228     6761        /*E* ERROR:       QQB-E$LPARAM23-C
      229     6762
      230     6763             MESSAGE:     +       %U1%U2
      231     6764             DESCRIPTION: LET parameter display Continued
      232     6765        */
      233     6766        /*E*       ERROR: QQB-E$STATITLE-C
      234     6767
      235     6768                 MESSAGE: Station  Time Disabled by
      236     6769             DESCRIPTION: Title for Disabled stations display
      237     6770        */
      238     6771        /*E*       ERROR: QQB-E$FPTITLE-C
      239     6772
      240     6773                 MESSAGE: FP       Time  Disabled by
      241     6774             DESCRIPTION: Title for disabled forms programs display
      242     6775        */
      243     6776        /*E*       ERROR: QQB-E$DCBTITLE-C
      244     6777
      245     6778                 MESSAGE: Station  Time  Type     Msgtyp   Sysid  Disconnect Timeout
      246     6779             DESCRIPTION: Title for connect DCBs display
      247     6780        */
      248     6781        /*E*  ERROR:      QQB-E$TYPETITLE-C
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:42   
      249     6782
      250     6783            MESSAGE: Msgtyp   Writes Prio Jrnl Count  MaxActive CurActive OneRpt
      251     6784             DESCRIPTION: Title of the DISPLAY TYPE command.
      252     6785        */
      253     6786        /*E*       ERROR: QQB-E$UNKTYPE-C
      254     6787
      255     6788                 MESSAGE: Unknown message type
      256     6789             DESCRIPTION: The type you tried to display has never been used
      257     6790                          or defined.
      258     6791        */
      259     6792        /*E*       ERROR: QQB-E$INVTYPE-C
      260     6793
      261     6794                 MESSAGE: The specified type name is invalid.
      262     6795                          Wildcarded type may only have a ? as the last
      263     6796                          character of the form or transaction type,
      264     6797                          e. g., A?B? is illegal, ? or AB? are legal.
      265     6798             DESCRIPTION: Wild carded type is more restrictive
      266     6799                          than generalized wild carding.  The rules are
      267     6800                          only one ?, and the ? must be the last character
      268     6801                          of the type group.  In addition ? may not
      269     6802                          be the only character E.G., ????.
      270     6803        */
      271     6804        /*E*       ERROR: QQB-E$NOTFOUND-C
      272     6805
      273     6806                 MESSAGE: Nothing found.
      274     6807             DESCRIPTION: No type match the wildcarded display type is found.
      275     6808        */
      276     6809        %PAGE(ARG="FPTs", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:43   
              6826    1   /***************************************************************************
              6827    1    *                                                                         *
              6828    1    *                                    FPTs                                 *
              6829    1    *                                                                         *
              6830    1    ***************************************************************************/

      277     6834        %FPT_CGINFO(DCB=M$CG, TYPLIST=NIL, QLIST=NIL);
      278     6854        %PAGE(ARG="VLPs");

              6871    1   /***************************************************************************
              6872    1    *                                                                         *
              6873    1    *                                    VLPs                                 *
              6874    1    *                                                                         *
              6875    1    ***************************************************************************/

      279     6879        %VLP_CGTYPL(STCLASS="BASED(P$)");
      280     6904        %VLP_CGTYPL(FPTN=VLP_CGTYPL_SEL,STCLASS=AUTO);
      281     6929        %VLP_CGQL(STCLASS="BASED(Q$)");
      282     6951        %VLP_CGQL(FPTN=VLP_CGQL_SEL,STCLASS=AUTO);
      283     6973        %PAGE(ARG="QQB$DISPLAY", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:44   
              6990    1   /***************************************************************************
              6991    1    *                                                                         *
              6992    1    *                                QQB$DISPLAY                              *
              6993    1    *                                                                         *
              6994    1    ***************************************************************************/

      284     6998    1           SUBLK$ = QQ_CMDBLK.OUT$ -> OUT$BLK.SUBLK$(0);

   6998  4 000002   000005 470400 xsym               LDP0    QQ_CMDBLK+5
         4 000003   000003 236100                    LDQ     3,,PR0
         4 000004   200020 756100                    STQ     SUBLK$,,AUTO

      285     6999    1           IF SUBLK$ ~= ADDR(NIL)

   6999  4 000005   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000006   000014 600000 4                  TZE     s:7003

      286     7000    1           THEN
      287     7001    1             DISP_FMT = SUBLK$ -> OUT$BLK.CODE;

   7001  4 000007   200020 471500                    LDP1    SUBLK$,,AUTO
         4 000010   100000 236100                    LDQ     0,,PR1
         4 000011   777777 376007                    ANQ     -1,DL
         4 000012   200013 756100                    STQ     DISP_FMT,,AUTO
         4 000013   000016 710000 4                  TRA     s:7005

      288     7002    1           ELSE                            /* Called from QQB$SPY                */
      289     7003    1             DISP_FMT = 2 /* OPT_DCB */;

   7003  4 000014   000002 235007                    LDA     2,DL
         4 000015   200013 755100                    STA     DISP_FMT,,AUTO

      290     7004
      291     7005    2           DO CASE(DISP_FMT);

   7005  4 000016   200013 235100                    LDA     DISP_FMT,,AUTO
         4 000017   000005 115007                    CMPA    5,DL
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:45   
         4 000020   000022 602005 4                  TNC     s:7005+4,AL
         4 000021   000042 710000 4                  TRA     s:7020
         4 000022   000042 710000 4                  TRA     s:7020
         4 000023   000027 710000 4                  TRA     s:7007
         4 000024   000032 710000 4                  TRA     s:7010
         4 000025   000035 710000 4                  TRA     s:7013
         4 000026   000040 710000 4                  TRA     s:7016

      292     7006    2             CASE(1 /* OPT_PARAMETER */);

      293     7007    2               CALL DISPLAY_PARAMETER;

   7007  4 000027   000052 701000 4                  TSX1    DISPLAY_PARAMETER
         4 000030   000000 011000                    NOP     0
         4 000031   000042 710000 4                  TRA     s:7020

      294     7008
      295     7009    2             CASE(2 /* OPT_DCB */);

      296     7010    2               CALL DISPLAY_DCB;

   7010  4 000032   001167 701000 4                  TSX1    DISPLAY_DCB
         4 000033   000000 011000                    NOP     0
         4 000034   000042 710000 4                  TRA     s:7020

      297     7011
      298     7012    2             CASE(3 /* OPT_DISABLED */);

      299     7013    2               CALL DISPLAY_DISABLED;

   7013  4 000035   000317 701000 4                  TSX1    DISPLAY_DISABLED
         4 000036   000000 011000                    NOP     0
         4 000037   000042 710000 4                  TRA     s:7020

      300     7014
      301     7015    2             CASE(4 /* DIS_TYPE */);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:46   
      302     7016    2               CALL DISPLAY_TYPE;

   7016  4 000040   000426 701000 4                  TSX1    DISPLAY_TYPE
         4 000041   000000 011000                    NOP     0

      303     7017
      304     7018    2           END /* CASE */;

      305     7019
      306     7020    1           RETURN;

   7020  4 000042   000000 702200 xent               TSX2  ! X66_ARET

      307     7021                %PAGE(ARG="SEND_HEADER_ENTRY", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:47   
              7038    1   /***************************************************************************
              7039    1    *                                                                         *
              7040    1    *                             SEND_HEADER_ENTRY                           *
              7041    1    *                                                                         *
              7042    1    ***************************************************************************/

      308     7046    1   QQB$DISPLAY_HEADER:
      309     7047    1           ENTRY;

   7047  4 000043   000000 700200 xent  QQB$DISPLAY* TSX0  ! X66_AUTO_0
         4 000044   000244 000000                    ZERO    164,0

      310     7048
      311     7049    1           PARAM_NUM = 39 /* LET_TPHEAD */;

   7049  4 000045   000047 235007                    LDA     39,DL
         4 000046   200012 755100                    STA     PARAM_NUM,,AUTO

      312     7050    1           CALL FORMAT_HEADER;

   7050  4 000047   001330 701000 4                  TSX1    FORMAT_HEADER
         4 000050   000000 011000                    NOP     0

      313     7051    1           RETURN;

   7051  4 000051   000000 702200 xent               TSX2  ! X66_ARET

      314     7052
      315     7053                %PAGE(ARG="DISPLAY_PARAMETER", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:48   
              7070    1   /***************************************************************************
              7071    1    *                                                                         *
              7072    1    *                             DISPLAY_PARAMETER                           *
              7073    1    *                                                                         *
              7074    1    ***************************************************************************/

      316     7078    1   DISPLAY_PARAMETER:

   7078  4 000052   200230 741300       DISPLAY_PAR* STX1  ! VLP_CGQL_SEL+10,,AUTO

      317     7079    1           PROC;
      318     7080
      319     7081    2           NSUBLKS = SUBLK$ -> OUT$BLK.NSUBLKS;

   7081  4 000053   200020 470500                    LDP0    SUBLK$,,AUTO
         4 000054   000001 236100                    LDQ     1,,PR0
         4 000055   000022 772000                    QRL     18
         4 000056   200015 756100                    STQ     NSUBLKS,,AUTO

      320     7082
      321     7083    3           DO I = 0 TO NSUBLKS - 1;

   7083  4 000057   200006 450100                    STZ     I,,AUTO
         4 000060   000114 710000 4                  TRA     s:7097+3

      322     7084    3             OPT$ = SUBLK$ -> OUT$BLK.SUBLK$(I);

   7084  4 000061   200020 470500                    LDP0    SUBLK$,,AUTO
         4 000062   200006 720100                    LXL0    I,,AUTO
         4 000063   000003 236110                    LDQ     3,X0,PR0
         4 000064   200021 756100                    STQ     OPT$,,AUTO

      323     7085    3             PARAM_NUM = OPT$ -> OUT$SYM.CODE;

   7085  4 000065   200021 471500                    LDP1    OPT$,,AUTO
         4 000066   100000 236100                    LDQ     0,,PR1
         4 000067   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:49   
         4 000070   200012 756100                    STQ     PARAM_NUM,,AUTO

      324     7086    3             IF PARAM_NUM = 1 /* OPT_ALL */ THEN

   7086  4 000071   000001 116007                    CMPQ    1,DL
         4 000072   000107 601000 4                  TNZ     s:7095

      325     7087    4               DO;

      326     7088    5                 DO K = 18 /* LOW_LET */ TO 39 /* HIGH_LET */;

   7088  4 000073   000022 235007                    LDA     18,DL
         4 000074   200007 755100                    STA     K,,AUTO

      327     7089    5                   PARAM_NUM = K;

   7089  4 000075   200007 235100                    LDA     K,,AUTO
         4 000076   200012 755100                    STA     PARAM_NUM,,AUTO

      328     7090    5                   CALL FORMAT_PARAM;

   7090  4 000077   000121 701000 4                  TSX1    FORMAT_PARAM
         4 000100   000000 011000                    NOP     0

      329     7091    5                 END;

   7091  4 000101   200007 235100                    LDA     K,,AUTO
         4 000102   000001 035007                    ADLA    1,DL
         4 000103   200007 755100                    STA     K,,AUTO
         4 000104   000050 115007                    CMPA    40,DL
         4 000105   000075 602000 4                  TNC     s:7089

      330     7092    4               END;

   7092  4 000106   000111 710000 4                  TRA     s:7097

      331     7093    3             ELSE
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:50   
      332     7094    4               DO;

      333     7095    4                 CALL FORMAT_PARAM;

   7095  4 000107   000121 701000 4                  TSX1    FORMAT_PARAM
         4 000110   000000 011000                    NOP     0

      334     7096    4               END;

      335     7097    3           END;

   7097  4 000111   200006 235100                    LDA     I,,AUTO
         4 000112   000001 035007                    ADLA    1,DL
         4 000113   200006 755100                    STA     I,,AUTO
         4 000114   200006 236100                    LDQ     I,,AUTO
         4 000115   200015 116100                    CMPQ    NSUBLKS,,AUTO
         4 000116   000061 602000 4                  TNC     s:7084

      336     7098
      337     7099    2           RETURN;

   7099  4 000117   200230 221300                    LDX1  ! VLP_CGQL_SEL+10,,AUTO
         4 000120   000001 702211                    TSX2  ! 1,X1

      338     7100    2   END DISPLAY_PARAMETER;
      339     7101                %PAGE(ARG="FORMAT_PARAM", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:51   
              7118    2   /***************************************************************************
              7119    2    *                                                                         *
              7120    2    *                                FORMAT_PARAM                             *
              7121    2    *                                                                         *
              7122    2    ***************************************************************************/

      340     7126    1   FORMAT_PARAM:

   7126  4 000121   200232 741300       FORMAT_PARAM STX1  ! VLP_CGQL_SEL+12,,AUTO

      341     7127    1           PROC;
      342     7128
      343     7129    2           IF (PARAM_NUM = 39 /* LET_TPHEAD */) THEN

   7129  4 000122   200012 235100                    LDA     PARAM_NUM,,AUTO
         4 000123   000047 115007                    CMPA    39,DL
         4 000124   000131 601000 4                  TNZ     s:7134

      344     7130    3             DO;

      345     7131    3               CALL FORMAT_HEADER;

   7131  4 000125   001330 701000 4                  TSX1    FORMAT_HEADER
         4 000126   000000 011000                    NOP     0

      346     7132    3               RETURN;

   7132  4 000127   200232 221300                    LDX1  ! VLP_CGQL_SEL+12,,AUTO
         4 000130   000001 702211                    TSX2  ! 1,X1

      347     7133    3             END;
      348     7134    2           ERR = CODE_LPARAM1;

   7134  4 000131   000045 236000 2                  LDQ     CODE_LPARAM1
         4 000132   200205 756100                    STQ     ERR,,AUTO

      349     7135    2           CALL QQC$BLDMSG_BLK(MSGBLK);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:52   

   7135  4 000133   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 000134   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000135   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000136   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000137   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000140   000000 011000                    NOP     0

      350     7136    2           CMDFLAGS = QQ_CMDFLAGS.INFO(PARAM_NUM);

   7136  4 000141   200012 236100                    LDQ     PARAM_NUM,,AUTO
         4 000142   000014 402007                    MPY     12,DL
         4 000143   000100 100406                    MLR     fill='000'O
         4 000144   000000 000014 xsym               ADSC9   QQ_CMDFLAGS,Q            cn=0,n=12
         4 000145   200122 000014                    ADSC9   CMDFLAGS,,AUTO           cn=0,n=12

      351     7137    2           ERR.CODE = ERR.CODE + PARAM_NUM - 18 /* LOW_LET */;

   7137  4 000146   200205 236100                    LDQ     ERR,,AUTO
         4 000147   000003 772000                    QRL     3
         4 000150   037777 376007                    ANQ     16383,DL
         4 000151   200012 036100                    ADLQ    PARAM_NUM,,AUTO
         4 000152   000022 136007                    SBLQ    18,DL
         4 000153   000003 736000                    QLS     3
         4 000154   200205 676100                    ERQ     ERR,,AUTO
         4 000155   377770 376007                    ANQ     131064,DL
         4 000156   200205 656100                    ERSQ    ERR,,AUTO

      352     7138    2           MSGBLK.ERRINFO.ERR(0) = ERR;

   7138  4 000157   200205 236100                    LDQ     ERR,,AUTO
         4 000160   200133 756100                    STQ     MSGBLK+6,,AUTO

      353     7139
      354     7140    3           DO CASE(CMDFLAGS.INFO.TYPE#);

   7140  4 000161   200122 236100                    LDQ     CMDFLAGS,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:53   
         4 000162   000007 772000                    QRL     7
         4 000163   000377 376007                    ANQ     255,DL
         4 000164   000005 116007                    CMPQ    5,DL
         4 000165   000167 602006 4                  TNC     s:7140+6,QL
         4 000166   000304 710000 4                  TRA     s:7170
         4 000167   000304 710000 4                  TRA     s:7170
         4 000170   000174 710000 4                  TRA     s:7142
         4 000171   000207 710000 4                  TRA     s:7152
         4 000172   000241 710000 4                  TRA     s:7158
         4 000173   000266 710000 4                  TRA     s:7164

      355     7141    3             CASE(1 /* TYPE_LOGL */);

      356     7142    3               IF CMDFLAGS.INFO.DATA$# -> FLAG THEN

   7142  4 000174   200124 470500                    LDP0    CMDFLAGS+2,,AUTO
         4 000175   000000 234100                    SZN     0,,PR0
         4 000176   000203 605000 4                  TPL     s:7148

      357     7143    4                 DO;

      358     7144    4                   MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_ON);

   7144  4 000177   000100 100400                    MLR     fill='000'O
         4 000200   000000 000010 5                  ADSC9   0                        cn=0,n=8
         4 000201   200134 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      359     7145    4                 END;

   7145  4 000202   000304 710000 4                  TRA     s:7170

      360     7146    3               ELSE
      361     7147    4                 DO;

      362     7148    4                   MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_OFF);

   7148  4 000203   000100 100400                    MLR     fill='000'O
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:54   
         4 000204   000002 000010 5                  ADSC9   2                        cn=0,n=8
         4 000205   200134 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      363     7149    4                 END;

   7149  4 000206   000304 710000 4                  TRA     s:7170

      364     7150
      365     7151    3             CASE(2 /* TYPE_UBIN */);

      366     7152    3               CALL QQC$CONVERT_NUM(CMDFLAGS.INFO.DATA$# -> UBIN_WORD,

   7152  4 000207   200237 452500                    STP2    VLP_CGQL_SEL+17,,AUTO
         4 000210   200237 236100                    LDQ     VLP_CGQL_SEL+17,,AUTO
         4 000211   000004 036000 5                  ADLQ    4
         4 000212   200236 756100                    STQ     VLP_CGQL_SEL+16,,AUTO
         4 000213   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000214   200242 450500                    STP0    VLP_CGQL_SEL+20,,AUTO
         4 000215   200014 631500                    EPPR1   SIZE,,AUTO
         4 000216   200241 451500                    STP1    VLP_CGQL_SEL+19,,AUTO
         4 000217   200124 236100                    LDQ     CMDFLAGS+2,,AUTO
         4 000220   200240 756100                    STQ     VLP_CGQL_SEL+18,,AUTO
         4 000221   200240 630500                    EPPR0   VLP_CGQL_SEL+18,,AUTO
         4 000222   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000223   000000 701000 xent               TSX1    QQC$CONVERT_NUM
         4 000224   000000 011000                    NOP     0

      367     7153    3                   SIZE, ADDR(TEXTC_NUM.NAME#));
      368     7154    3               TEXTC_NUM.L# = SIZE;

   7154  4 000225   200014 236100                    LDQ     SIZE,,AUTO
         4 000226   000033 736000                    QLS     27
         4 000227   200152 552140                    STBQ    TEXTC_NUM,'40'O,AUTO

      369     7155    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_NUM);

   7155  4 000230   000005 235000 5                  LDA     5
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:55   
         4 000231   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 000232   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 000233   000152 036003                    ADLQ    106,DU
         4 000234   200240 757100                    STAQ    VLP_CGQL_SEL+18,,AUTO
         4 000235   000100 100500                    MLR     fill='000'O
         4 000236   200240 000010                    ADSC9   VLP_CGQL_SEL+18,,AUTO    cn=0,n=8
         4 000237   200134 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8
         4 000240   000304 710000 4                  TRA     s:7170

      370     7156
      371     7157    3             CASE(3 /* TYPE_CHAR */);

      372     7158    3               CHAR_STRING_SIZE = CMDFLAGS.INFO.LEN#;

   7158  4 000241   200122 236100                    LDQ     CMDFLAGS,,AUTO
         4 000242   000020 772000                    QRL     16
         4 000243   000377 376007                    ANQ     255,DL
         4 000244   200005 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      373     7159    3               TEXTC_STRING.NAME# = CMDFLAGS.INFO.DATA$# -> CHAR$STRING;

   7159  4 000245   200124 470500                    LDP0    CMDFLAGS+2,,AUTO
         4 000246   000000 620006                    EAX0    0,QL
         4 000247   040100 100540                    MLR     fill='040'O
         4 000250   000000 000010                    ADSC9   0,,PR0                   cn=0,n=*X0
         4 000251   200155 200074                    ADSC9   TEXTC_STRING,,AUTO       cn=1,n=60

      374     7160    3               TEXTC_STRING.L# = CHAR_STRING_SIZE;

   7160  4 000252   200005 236100                    LDQ     CHAR_STRING_SIZE,,AUTO
         4 000253   000033 736000                    QLS     27
         4 000254   200155 552140                    STBQ    TEXTC_STRING,'40'O,AUTO

      375     7161    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STRING);

   7161  4 000255   000006 235000 5                  LDA     6
         4 000256   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:56   
         4 000257   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 000260   000155 036003                    ADLQ    109,DU
         4 000261   200240 757100                    STAQ    VLP_CGQL_SEL+18,,AUTO
         4 000262   000100 100500                    MLR     fill='000'O
         4 000263   200240 000010                    ADSC9   VLP_CGQL_SEL+18,,AUTO    cn=0,n=8
         4 000264   200134 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8
         4 000265   000304 710000 4                  TRA     s:7170

      376     7162
      377     7163    3             CASE(4 /* TYPE_TEXTC */);

      378     7164    3               CHAR_STRING_SIZE = CMDFLAGS.INFO.DATA$# -> BYTTE;

   7164  4 000266   200124 470500                    LDP0    CMDFLAGS+2,,AUTO
         4 000267   003100 061500                    CSR     bolr='003'O
         4 000270   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         4 000271   200005 000044                    BDSC    CHAR_STRING_SIZE,,AUTO   by=0,bit=0,n=36

      379     7165    3               CHAR_STRING_SIZE = CHAR_STRING_SIZE + 1;

   7165  4 000272   200005 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         4 000273   000001 035007                    ADLA    1,DL
         4 000274   200005 755100                    STA     CHAR_STRING_SIZE,,AUTO

      380     7166    3               MSGBLK.ERRINFO.FIELD1(0) = VECTOR(CMDFLAGS.INFO.DATA$# -> CHAR$STRING);

   7166  4 000275   000020 735000                    ALS     16
         4 000276   000140 135007                    SBLA    96,DL
         4 000277   200124 236100                    LDQ     CMDFLAGS+2,,AUTO
         4 000300   200236 757100                    STAQ    VLP_CGQL_SEL+16,,AUTO
         4 000301   000100 100500                    MLR     fill='000'O
         4 000302   200236 000010                    ADSC9   VLP_CGQL_SEL+16,,AUTO    cn=0,n=8
         4 000303   200134 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      381     7167
      382     7168    3           END /* CASE */;

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:57   
      383     7169
      384     7170    2           IF NOT CMDFLAGS.INFO.INHIBPRINT# THEN

   7170  4 000304   200122 236100                    LDQ     CMDFLAGS,,AUTO
         4 000305   100000 316007                    CANQ    32768,DL
         4 000306   000315 601000 4                  TNZ     s:7175

      385     7171    3             DO;

      386     7172    3               CALL QQC$BLDMSG(MSGBLK);

   7172  4 000307   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 000310   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000311   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000312   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000313   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000314   000000 011000                    NOP     0

      387     7173    3             END;

      388     7174
      389     7175    2           RETURN;

   7175  4 000315   200232 221300                    LDX1  ! VLP_CGQL_SEL+12,,AUTO
         4 000316   000001 702211                    TSX2  ! 1,X1

      390     7176
      391     7177    2   END FORMAT_PARAM;
      392     7178                %PAGE(ARG="DISPLAY_DISABLED", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:58   
              7195    2   /***************************************************************************
              7196    2    *                                                                         *
              7197    2    *                              DISPLAY_DISABLED                           *
              7198    2    *                                                                         *
              7199    2    ***************************************************************************/

      393     7203    1   DISPLAY_DISABLED:

   7203  4 000317   200230 741300       DISPLAY_DIS* STX1  ! VLP_CGQL_SEL+10,,AUTO

      394     7204    1           PROC;
      395     7205
      396     7206    2           TYPE = SUBLK$ -> OUT$BLK.SUBLK$(0) -> OUT$SYM.CODE;

   7206  4 000320   200020 470500                    LDP0    SUBLK$,,AUTO
         4 000321   000003 471500                    LDP1    3,,PR0
         4 000322   100000 236100                    LDQ     0,,PR1
         4 000323   777777 376007                    ANQ     -1,DL
         4 000324   200016 756100                    STQ     TYPE,,AUTO

      397     7207
      398     7208    2           IF TYPE = 1 /* OPT_STATION */ THEN

   7208  4 000325   000001 116007                    CMPQ    1,DL
         4 000326   000332 601000 4                  TNZ     s:7214

      399     7209    3             DO;

      400     7210    3               QQ_CMDBLK.MINOR_ERR = CODE_STATITLE;

   7210  4 000327   000046 236000 2                  LDQ     CODE_STATITLE
         4 000330   000001 756000 xsym               STQ     QQ_CMDBLK+1

      401     7211    3             END;

   7211  4 000331   000334 710000 4                  TRA     s:7217

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:59   
      402     7212    2           ELSE
      403     7213    3             DO;

      404     7214    3               QQ_CMDBLK.MINOR_ERR = CODE_FPTITLE;

   7214  4 000332   000047 236000 2                  LDQ     CODE_FPTITLE
         4 000333   000001 756000 xsym               STQ     QQ_CMDBLK+1

      405     7215    3             END;

      406     7216
      407     7217    2           CALL QQC$BLDMSG_BLK(MSGBLK);

   7217  4 000334   200125 633500                    EPPR3   MSGBLK,,AUTO
         4 000335   200236 453500                    STP3    VLP_CGQL_SEL+16,,AUTO
         4 000336   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000337   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000340   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000341   000000 011000                    NOP     0

      408     7218    2           CALL QQC$BLDMSG(MSGBLK);

   7218  4 000342   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 000343   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000344   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000345   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000346   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000347   000000 011000                    NOP     0

      409     7219
      410     7220    2           F_FDS.BUF_ = VECTOR(BUF);

   7220  4 000350   000007 235000 5                  LDA     7
         4 000351   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 000352   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 000353   000026 036003                    ADLQ    22,DU
         4 000354   000005 755000 3                  STA     F_FDS+5
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:60   
         4 000355   000006 756000 3                  STQ     F_FDS+6

      411     7221    2           F_FDS.VECTR$ = ADDR(DATA_VECTRS);

   7221  4 000356   200052 630500                    EPPR0   DATA_VECTRS,,AUTO
         4 000357   000012 450400 3                  STP0    F_FDS+10

      412     7222    2           F_FDS.NVECS# = 3;

   7222  4 000360   000003 235007                    LDA     3,DL
         4 000361   000011 755000 3                  STA     F_FDS+9

      413     7223    2           F_FDS.FMT_ = VECTOR(DISABLE_FORMAT);

   7223  4 000362   000010 237000 5                  LDAQ    8
         4 000363   000000 757000 3                  STAQ    F_FDS

      414     7224
      415     7225    2           NEXT$ = QQ_GLOBAL.DISAB$;

   7225  4 000364   000055 236000 xsym               LDQ     QQ_GLOBAL+45
         4 000365   200023 756100                    STQ     NEXT$,,AUTO

      416     7226
      417     7227    3           DO WHILE('1'B);

      418     7228    3             NEXT$ = NEXT$ -> DISAB$INFO.FLINK$;

   7228  4 000366   200023 470500                    LDP0    NEXT$,,AUTO
         4 000367   000001 236100                    LDQ     1,,PR0
         4 000370   200023 756100                    STQ     NEXT$,,AUTO

      419     7229    3             IF NEXT$ -> DISAB$INFO.FLINK$ = ADDR(NIL) THEN

   7229  4 000371   200023 470500                    LDP0    NEXT$,,AUTO
         4 000372   000001 236100                    LDQ     1,,PR0
         4 000373   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:61   
         4 000374   000376 601000 4                  TNZ     s:7234

      420     7230    4               DO;

      421     7231    4                 GOTO RET;

   7231  4 000375   000424 710000 4                  TRA     RET

      422     7232    4               END;
      423     7233
      424     7234    3             IF NEXT$ -> DISAB$INFO.TYPE ~= TYPE THEN

   7234  4 000376   000002 236100                    LDQ     2,,PR0
         4 000377   200016 116100                    CMPQ    TYPE,,AUTO
         4 000400   000402 600000 4                  TZE     s:7239

      425     7235    4               DO;

      426     7236    4                 GOTO LOOP;

   7236  4 000401   000423 710000 4                  TRA     LOOP

      427     7237    4               END;
      428     7238
      429     7239    3             D$ = NEXT$;

   7239  4 000402   200023 236100                    LDQ     NEXT$,,AUTO
         4 000403   200003 756100                    STQ     D$,,AUTO

      430     7240    3             DATA_VECTRS(0) = VECTOR(DISAB$INFO.ITEM);

   7240  4 000404   000012 235000 5                  LDA     10
         4 000405   000006 036003                    ADLQ    6,DU
         4 000406   200052 757100                    STAQ    DATA_VECTRS,,AUTO

      431     7241    3             DATA_VECTRS(1) = VECTOR(DISAB$INFO.UTS);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:62   
   7241  4 000407   777640 235007                    LDA     -96,DL
         4 000410   200003 236100                    LDQ     D$,,AUTO
         4 000411   000003 036003                    ADLQ    3,DU
         4 000412   200054 757100                    STAQ    DATA_VECTRS+2,,AUTO

      432     7242    3             DATA_VECTRS(2) = VECTOR(DISAB$INFO.ID);

   7242  4 000413   000012 235000 5                  LDA     10
         4 000414   200003 236100                    LDQ     D$,,AUTO
         4 000415   000004 036003                    ADLQ    4,DU
         4 000416   200056 757100                    STAQ    DATA_VECTRS+4,,AUTO

      433     7243
      434     7244    3             CALL X$FORMAT(F_FDS);

   7244  4 000417   000013 630400 5                  EPPR0   11
         4 000420   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000421   000000 701000 xent               TSX1    X$FORMAT
         4 000422   000000 011000                    NOP     0

      435     7245
      436     7246    3   LOOP:
      437     7247    3           END /* WHILE */;

   7247  4 000423   000366 710000 4     LOOP         TRA     s:7228

      438     7248
      439     7249    2   RET:
      440     7250    2           RETURN;

   7250  4 000424   200230 221300       RET          LDX1  ! VLP_CGQL_SEL+10,,AUTO
         4 000425   000001 702211                    TSX2  ! 1,X1

      441     7251
      442     7252    2   END DISPLAY_DISABLED;
      443     7253                %PAGE(ARG="DISPLAY_TYPE", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:63   
              7270    2   /***************************************************************************
              7271    2    *                                                                         *
              7272    2    *                                DISPLAY_TYPE                             *
              7273    2    *                                                                         *
              7274    2    ***************************************************************************/

      444     7278    1   DISPLAY_TYPE:

   7278  4 000426   200230 741300       DISPLAY_TYPE STX1  ! VLP_CGQL_SEL+10,,AUTO

      445     7279    1           PROC;
      446     7280
      447     7281    2           TYPLIST_MULT = 25;         /* multiplied by sizes of cgql + cgtypl    */

   7281  4 000427   000031 235007                    LDA     25,DL
         4 000430   200017 755100                    STA     TYPLIST_MULT,,AUTO

      448     7282    2           P$ = ADDR(NIL);

   7282  4 000431   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000432   200024 756100                    STQ     P$,,AUTO

      449     7283                       /*  get enough memory for sizes of (vlp_cgql + vlp_cgtypl)     */
      450     7284    2           CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, (TYPLIST_MULT *

   7284  4 000433   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000434   000021 402007                    MPY     17,DL
         4 000435   000001 036007                    ADLQ    1,DL
         4 000436   200236 756100                    STQ     VLP_CGQL_SEL+16,,AUTO
         4 000437   200024 630500                    EPPR0   P$,,AUTO
         4 000440   200241 450500                    STP0    VLP_CGQL_SEL+19,,AUTO
         4 000441   200236 631500                    EPPR1   VLP_CGQL_SEL+16,,AUTO
         4 000442   200240 451500                    STP1    VLP_CGQL_SEL+18,,AUTO
         4 000443   000014 236000 5                  LDQ     12
         4 000444   200237 756100                    STQ     VLP_CGQL_SEL+17,,AUTO
         4 000445   200237 630500                    EPPR0   VLP_CGQL_SEL+17,,AUTO
         4 000446   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:64   
         4 000447   000000 701000 xent               TSX1    QQC$GET_BLK
         4 000450   001147 702000 4                  TSX2    NO_MEM

      451     7285    2               (SIZEW(VLP_CGQL) + SIZEW(VLP_CGTYPL.LIST(0)))) +
      452     7286    2               SIZEW(VLP_CGTYPL.FOUND#), P$ ) ALTRET(NO_MEM);
      453     7287    2           Q$ = PINCRW(P$, (SIZEW(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT) +

   7287  4 000451   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000452   000007 402003                    MPY     7,DU
         4 000453   000001 036003                    ADLQ    1,DU
         4 000454   200024 036100                    ADLQ    P$,,AUTO
         4 000455   200025 756100                    STQ     Q$,,AUTO

      454     7288    2               SIZEW(VLP_CGTYPL.FOUND#));
      455     7289
      456     7290
      457     7291    2           VLP_CGTYPL.FOUND# = 1;

   7291  4 000456   000001 235007                    LDA     1,DL
         4 000457   200024 470500                    LDP0    P$,,AUTO
         4 000460   000000 755100                    STA     0,,PR0

      458     7292    2           VLP_CGTYPL_SEL.FOUND# = 1;

   7292  4 000461   200206 755100                    STA     VLP_CGTYPL_SEL,,AUTO

      459     7293
      460     7294    2           FPT_CGINFO.V.TYPFC# = 1; /* Select                    */

   7294  4 000462   000106 236000 3                  LDQ     FPT_CGINFO+40
         4 000463   000015 376000 5                  ANQ     13
         4 000464   000010 276007                    ORQ     8,DL
         4 000465   000106 756000 3                  STQ     FPT_CGINFO+40

      461     7295
      462     7296    2           TYPE$ = SUBLK$ -> OUT$BLK.SUBLK$(0);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:65   
   7296  4 000466   200020 470500                    LDP0    SUBLK$,,AUTO
         4 000467   000003 236100                    LDQ     3,,PR0
         4 000470   200022 756100                    STQ     TYPE$,,AUTO

      463     7297    2           VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;

   7297  4 000471   200022 471500                    LDP1    TYPE$,,AUTO
         4 000472   100004 236100                    LDQ     4,,PR1
         4 000473   000033 772000                    QRL     27
         4 000474   000000 620006                    EAX0    0,QL
         4 000475   200024 473500                    LDP3    P$,,AUTO
         4 000476   040100 100540                    MLR     fill='040'O
         4 000477   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000500   300001 000010                    ADSC9   1,,PR3                   cn=0,n=8

      464     7298    2           VLP_CGTYPL_SEL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;

   7298  4 000501   100004 236100                    LDQ     4,,PR1
         4 000502   000033 772000                    QRL     27
         4 000503   000000 620006                    EAX0    0,QL
         4 000504   040100 100540                    MLR     fill='040'O
         4 000505   100004 200010                    ADSC9   4,,PR1                   cn=1,n=*X0
         4 000506   200207 000010                    ADSC9   VLP_CGTYPL_SEL+1,,AUTO   cn=0,n=8

      465     7299
      466     7300    2           FPT_CGINFO.TYPLIST_ = VECTOR(VLP_CGTYPL_SEL);

   7300  4 000507   000016 235000 5                  LDA     14
         4 000510   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 000511   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 000512   000206 036003                    ADLQ    134,DU
         4 000513   000040 757000 3                  STAQ    FPT_CGINFO+2

      467     7301    2           FPT_CGINFO.QLIST_ = VECTOR(VLP_CGQL_SEL);

   7301  4 000514   000017 235000 5                  LDA     15
         4 000515   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:66   
         4 000516   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 000517   000216 036003                    ADLQ    142,DU
         4 000520   000052 757000 3                  STAQ    FPT_CGINFO+12

      468     7302
      469     7303    2           CALL INDEX(I, '?', VLP_CGTYPL.LIST.NAME#(0)) ALTRET(NO_Q1);

   7303  4 000521   200024 473500                    LDP3    P$,,AUTO
         4 000522   000000 124500                    SCM     mask='000'O
         4 000523   300001 000010                    ADSC9   1,,PR3                   cn=0,n=8
         4 000524   000020 000001 5                  ADSC9   16                       cn=0,n=1
         4 000525   200006 000100                    ARG     I,,AUTO
         4 000526   000570 606400 4                  TTN     NO_Q1

      470     7304
      471     7305    2           IF TYPE$ -> OUT$SYM.COUNT - 1 ~= I THEN

   7305  4 000527   100004 236100                    LDQ     4,,PR1
         4 000530   000033 772000                    QRL     27
         4 000531   000001 136007                    SBLQ    1,DL
         4 000532   000535 604000 4                  TMI     s:7307
         4 000533   200006 116100                    CMPQ    I,,AUTO
         4 000534   000540 600000 4                  TZE     s:7310

      472     7306    3             DO;

      473     7307    3               QQ_CMDBLK.MINOR_ERR = CODE_INVTYPE;

   7307  4 000535   000053 236000 2                  LDQ     CODE_INVTYPE
         4 000536   000001 756000 xsym               STQ     QQ_CMDBLK+1

      474     7308    3               GOTO PRINT_ERR;

   7308  4 000537   000710 710000 4                  TRA     PRINT_ERR

      475     7309    3             END;
      476     7310    2           FPT_CGINFO.V.TYPFC# = 3; /* Wildcarded                  */
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:67   

   7310  4 000540   000106 236000 3                  LDQ     FPT_CGINFO+40
         4 000541   000015 376000 5                  ANQ     13
         4 000542   000030 276007                    ORQ     24,DL
         4 000543   000106 756000 3                  STQ     FPT_CGINFO+40

      477     7311    2           CHAR_STRING_SIZE = (SIZEC(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT)

   7311  4 000544   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000545   000034 402007                    MPY     28,DL
         4 000546   000004 036007                    ADLQ    4,DL
         4 000547   200005 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      478     7312    2               + SIZEC(VLP_CGTYPL.FOUND#);
      479     7313    2           FPT_CGINFO.TYPLIST_ = VECTOR(P$ -> CHAR$STRING);

   7313  4 000550   200005 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         4 000551   000020 735000                    ALS     16
         4 000552   000140 135007                    SBLA    96,DL
         4 000553   200024 236100                    LDQ     P$,,AUTO
         4 000554   000040 757000 3                  STAQ    FPT_CGINFO+2

      480     7314    2           CHAR_STRING_SIZE = SIZEC(VLP_CGQL) * TYPLIST_MULT;

   7314  4 000555   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000556   000050 402007                    MPY     40,DL
         4 000557   200005 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      481     7315    2           FPT_CGINFO.QLIST_ = VECTOR(Q$ -> CHAR$STRING);

   7315  4 000560   200005 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         4 000561   000020 735000                    ALS     16
         4 000562   000140 135007                    SBLA    96,DL
         4 000563   200025 236100                    LDQ     Q$,,AUTO
         4 000564   000052 757000 3                  STAQ    FPT_CGINFO+12

      482     7316    2           TYPLIST_MULT = TYPLIST_MULT + 25; /* array size += 25                 */
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:68   

   7316  4 000565   200017 235100                    LDA     TYPLIST_MULT,,AUTO
         4 000566   000031 035007                    ADLA    25,DL
         4 000567   200017 755100                    STA     TYPLIST_MULT,,AUTO

      483     7317
      484     7318    2   NO_Q1:
      485     7319    2           CALL M$CGINFO(FPT_CGINFO) ALTRET(CGINFO_ERR);

   7319  4 000570   000036 630400 3     NO_Q1        EPPR0   FPT_CGINFO
         4 000571   500004 713400                    CLIMB   alt,+32772
         4 000572   411400 401760                    pmme    nvectors=20
         4 000573   000575 702000 4                  TSX2    CGINFO_ERR

      486     7320
      487     7321    3           DO WHILE('0'B);

   7321  4 000574   000725 710000 4                  TRA     s:7366

      488     7322
      489     7323    3   CGINFO_ERR:
      490     7324    3             IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = 1153

   7324  4 000575   000000 470400 xsym  CGINFO_ERR   LDP0    B$TCB$
         4 000576   000000 471500                    LDP1    0,,PR0
         4 000577   100102 236100                    LDQ     66,,PR1
         4 000600   377770 376007                    ANQ     131064,DL
         4 000601   022010 116007                    CMPQ    9224,DL
         4 000602   000606 601000 4                  TNZ     s:7327

      491     7325    3   /* E$CGAFNT */ THEN
      492     7326    3               QQ_CMDBLK.MINOR_ERR = CODE_UNKTYPE;

   7326  4 000603   000052 236000 2                  LDQ     CODE_UNKTYPE
         4 000604   000001 756000 xsym               STQ     QQ_CMDBLK+1
         4 000605   000710 710000 4                  TRA     PRINT_ERR

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:69   
      493     7327    3             ELSE IF B$TCB$->B$TCB.ALT$->B$ALT.ERR.CODE = 1148

   7327  4 000606   021740 116007                    CMPQ    9184,DL
         4 000607   001142 601000 4                  TNZ     MON_ERR

      494     7328    3   /* E$CGITLS */ THEN
      495     7329    4                 DO;

      496     7330                                      /* This case only happens with wildcarded types */
      497     7331    4                   IF P$ ~= ADDR(NIL) THEN

   7331  4 000610   200024 236100                    LDQ     P$,,AUTO
         4 000611   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 000612   000625 600000 4                  TZE     s:7341

      498     7332    5                     DO;                   /* a previous GET_BLK was done        */

      499     7333
      500     7334    5                       CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, P$);

   7334  4 000613   200024 633500                    EPPR3   P$,,AUTO
         4 000614   200237 453500                    STP3    VLP_CGQL_SEL+17,,AUTO
         4 000615   000014 236000 5                  LDQ     12
         4 000616   200236 756100                    STQ     VLP_CGQL_SEL+16,,AUTO
         4 000617   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000620   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000621   000000 701000 xent               TSX1    QQC$RLS_BLK
         4 000622   000000 011000                    NOP     0

      501     7335    5                       P$ = ADDR(NIL);

   7335  4 000623   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 000624   200024 756100                    STQ     P$,,AUTO

      502     7336
      503     7337    5                     END;

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:70   
      504     7338                        /* increment by typlist multiplier * (sizes of
      505     7339                                 vlp_cgql + vlp_cgtypl)
      506     7340                        */
      507     7341    4                   CALL QQC$GET_BLK(QQ_GLOBAL.POOL$, (TYPLIST_MULT *

   7341  4 000625   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000626   000021 402007                    MPY     17,DL
         4 000627   000001 036007                    ADLQ    1,DL
         4 000630   200236 756100                    STQ     VLP_CGQL_SEL+16,,AUTO
         4 000631   200024 630500                    EPPR0   P$,,AUTO
         4 000632   200241 450500                    STP0    VLP_CGQL_SEL+19,,AUTO
         4 000633   200236 631500                    EPPR1   VLP_CGQL_SEL+16,,AUTO
         4 000634   200240 451500                    STP1    VLP_CGQL_SEL+18,,AUTO
         4 000635   000014 236000 5                  LDQ     12
         4 000636   200237 756100                    STQ     VLP_CGQL_SEL+17,,AUTO
         4 000637   200237 630500                    EPPR0   VLP_CGQL_SEL+17,,AUTO
         4 000640   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000641   000000 701000 xent               TSX1    QQC$GET_BLK
         4 000642   001147 702000 4                  TSX2    NO_MEM

      508     7342    4                       (SIZEW(VLP_CGQL) + SIZEW(VLP_CGTYPL.LIST(0)))) +
      509     7343    4                       SIZEW(VLP_CGTYPL.FOUND#), P$) ALTRET(NO_MEM);
      510     7344    4                   Q$ = PINCRW(P$, (SIZEW(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT)

   7344  4 000643   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000644   000007 402003                    MPY     7,DU
         4 000645   000001 036003                    ADLQ    1,DU
         4 000646   200024 036100                    ADLQ    P$,,AUTO
         4 000647   200025 756100                    STQ     Q$,,AUTO

      511     7345    4                       + SIZEW(VLP_CGTYPL.FOUND#));
      512     7346                                      /* refill in pertinent information for CGINFO   */
      513     7347    4                   VLP_CGTYPL.FOUND# = 1;

   7347  4 000650   000001 235007                    LDA     1,DL
         4 000651   200024 470500                    LDP0    P$,,AUTO
         4 000652   000000 755100                    STA     0,,PR0
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:71   

      514     7348    4                   VLP_CGTYPL.LIST.NAME#(0) = TYPE$ -> OUT$SYM.TEXT;

   7348  4 000653   200022 470500                    LDP0    TYPE$,,AUTO
         4 000654   000004 236100                    LDQ     4,,PR0
         4 000655   000033 772000                    QRL     27
         4 000656   000000 620006                    EAX0    0,QL
         4 000657   200024 471500                    LDP1    P$,,AUTO
         4 000660   040100 100540                    MLR     fill='040'O
         4 000661   000004 200010                    ADSC9   4,,PR0                   cn=1,n=*X0
         4 000662   100001 000010                    ADSC9   1,,PR1                   cn=0,n=8

      515     7349    4                   CHAR_STRING_SIZE = (SIZEC(VLP_CGTYPL.LIST(0)) * TYPLIST_MULT)

   7349  4 000663   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000664   000034 402007                    MPY     28,DL
         4 000665   000004 036007                    ADLQ    4,DL
         4 000666   200005 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      516     7350    4                       + SIZEC(VLP_CGTYPL.FOUND#);
      517     7351    4                   FPT_CGINFO.TYPLIST_ = VECTOR(P$ -> CHAR$STRING);

   7351  4 000667   200005 235100                    LDA     CHAR_STRING_SIZE,,AUTO
         4 000670   000020 735000                    ALS     16
         4 000671   000140 135007                    SBLA    96,DL
         4 000672   200024 236100                    LDQ     P$,,AUTO
         4 000673   000040 757000 3                  STAQ    FPT_CGINFO+2

      518     7352    4                   CHAR_STRING_SIZE = SIZEC(VLP_CGQL) * TYPLIST_MULT;

   7352  4 000674   200017 236100                    LDQ     TYPLIST_MULT,,AUTO
         4 000675   000050 402007                    MPY     40,DL
         4 000676   200005 756100                    STQ     CHAR_STRING_SIZE,,AUTO

      519     7353    4                   FPT_CGINFO.QLIST_ = VECTOR(Q$ -> CHAR$STRING);

   7353  4 000677   200005 235100                    LDA     CHAR_STRING_SIZE,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:72   
         4 000700   000020 735000                    ALS     16
         4 000701   000140 135007                    SBLA    96,DL
         4 000702   200025 236100                    LDQ     Q$,,AUTO
         4 000703   000052 757000 3                  STAQ    FPT_CGINFO+12

      520     7354    4                   TYPLIST_MULT = TYPLIST_MULT + 25;

   7354  4 000704   200017 235100                    LDA     TYPLIST_MULT,,AUTO
         4 000705   000031 035007                    ADLA    25,DL
         4 000706   200017 755100                    STA     TYPLIST_MULT,,AUTO

      521     7355
      522     7356    4                   GOTO NO_Q1;             /* try M$CGINFO again                 */

   7356  4 000707   000570 710000 4                  TRA     NO_Q1

      523     7357    4                 END;
      524     7358    3               ELSE
      525     7359    3                 GOTO MON_ERR;
      526     7360    3   PRINT_ERR:
      527     7361    3             CALL QQC$BLDMSG_BLK(MSGBLK);

   7361  4 000710   200125 630500       PRINT_ERR    EPPR0   MSGBLK,,AUTO
         4 000711   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000712   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000713   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000714   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000715   000000 011000                    NOP     0

      528     7362    3             CALL QQC$BLDMSG(MSGBLK);

   7362  4 000716   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 000717   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000720   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000721   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000722   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000723   000000 011000                    NOP     0
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:73   

      529     7363    3             GOTO RET;

   7363  4 000724   001123 710000 4                  TRA     RET

      530     7364    3           END /* NEVER */;

      531     7365
      532     7366    2           IF VLP_CGTYPL.FOUND# = 0 THEN

   7366  4 000725   200024 470500                    LDP0    P$,,AUTO
         4 000726   000000 235100                    LDA     0,,PR0
         4 000727   000733 601000 4                  TNZ     s:7372

      533     7367    3             DO;

      534     7368    3               QQ_CMDBLK.MINOR_ERR = CODE_NOTFOUND;

   7368  4 000730   000056 236000 2                  LDQ     CODE_NOTFOUND
         4 000731   000001 756000 xsym               STQ     QQ_CMDBLK+1

      535     7369    3               GOTO PRINT_ERR;

   7369  4 000732   000710 710000 4                  TRA     PRINT_ERR

      536     7370    3             END;
      537     7371
      538     7372    2           IF FPT_CGINFO.V.TYPFC# = 1 THEN /* Select             */

   7372  4 000733   000106 236000 3                  LDQ     FPT_CGINFO+40
         4 000734   000070 376007                    ANQ     56,DL
         4 000735   000010 116007                    CMPQ    8,DL
         4 000736   000746 601000 4                  TNZ     s:7378

      539     7373    3             DO;

      540     7374    3               VLP_CGTYPL = VLP_CGTYPL_SEL;
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:74   

   7374  4 000737   000100 100500                    MLR     fill='000'O
         4 000740   200206 000040                    ADSC9   VLP_CGTYPL_SEL,,AUTO     cn=0,n=32
         4 000741   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32

      541     7375    3               VLP_CGQL = VLP_CGQL_SEL;

   7375  4 000742   200025 470500                    LDP0    Q$,,AUTO
         4 000743   000100 100500                    MLR     fill='000'O
         4 000744   200216 000044                    ADSC9   VLP_CGQL_SEL,,AUTO       cn=0,n=36
         4 000745   000000 000044                    ADSC9   0,,PR0                   cn=0,n=36

      542     7376    3             END;

      543     7377
      544     7378    2           QQ_CMDBLK.MINOR_ERR = CODE_TYPETITLE;

   7378  4 000746   000051 236000 2                  LDQ     CODE_TYPETITLE
         4 000747   000001 756000 xsym               STQ     QQ_CMDBLK+1

      545     7379    2           CALL QQC$BLDMSG_BLK(MSGBLK);

   7379  4 000750   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 000751   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000752   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000754   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 000755   000000 011000                    NOP     0

      546     7380    2           CALL QQC$BLDMSG(MSGBLK);

   7380  4 000756   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 000757   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 000760   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 000761   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000762   000000 701000 xent               TSX1    QQC$BLDMSG
         4 000763   000000 011000                    NOP     0
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:75   

      547     7381
      548     7382    2           F_FDS.BUF_ = VECTOR(BUF);

   7382  4 000764   000007 235000 5                  LDA     7
         4 000765   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 000766   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 000767   000026 036003                    ADLQ    22,DU
         4 000770   000005 755000 3                  STA     F_FDS+5
         4 000771   000006 756000 3                  STQ     F_FDS+6

      549     7383    2           F_FDS.VECTR$ = ADDR(DATA_VECTRS);

   7383  4 000772   200052 630500                    EPPR0   DATA_VECTRS,,AUTO
         4 000773   000012 450400 3                  STP0    F_FDS+10

      550     7384    2           F_FDS.NVECS# = 8;

   7384  4 000774   000010 235007                    LDA     8,DL
         4 000775   000011 755000 3                  STA     F_FDS+9

      551     7385    2           F_FDS.FMT_ = VECTOR(TYPE_FORMAT);

   7385  4 000776   000022 237000 5                  LDAQ    18
         4 000777   000000 757000 3                  STAQ    F_FDS

      552     7386
      553     7387    3           DO I = 0 TO VLP_CGTYPL.FOUND# - 1;

   7387  4 001000   200006 450100                    STZ     I,,AUTO
         4 001001   001117 710000 4                  TRA     s:7404+3

      554     7388    3             DATA_VECTRS(0) = VECTOR(VLP_CGTYPL.LIST.NAME#(I));

   7388  4 001002   000012 235000 5                  LDA     10
         4 001003   200006 236100                    LDQ     I,,AUTO
         4 001004   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:76   
         4 001005   000007 402003                    MPY     7,DU
         4 001006   000001 036003                    ADLQ    1,DU
         4 001007   200024 036100                    ADLQ    P$,,AUTO
         4 001010   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001011   200052 757100                    STAQ    DATA_VECTRS,,AUTO

      555     7389
      556     7390    3             DATA_VECTRS(1) = VECTOR(VLP_CGTYPL.LIST.NUMWRITES#(I));

   7390  4 001012   777640 235007                    LDA     -96,DL
         4 001013   200006 236100                    LDQ     I,,AUTO
         4 001014   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001015   000007 402003                    MPY     7,DU
         4 001016   000004 036003                    ADLQ    4,DU
         4 001017   200024 036100                    ADLQ    P$,,AUTO
         4 001020   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001021   200054 757100                    STAQ    DATA_VECTRS+2,,AUTO

      557     7391
      558     7392    3             DATA_VECTRS(2) = VECTOR(VLP_CGTYPL.LIST.PRIO#(I));

   7392  4 001022   177640 235007                    LDA     65440,DL
         4 001023   200006 236100                    LDQ     I,,AUTO
         4 001024   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001025   000007 402003                    MPY     7,DU
         4 001026   000003 036003                    ADLQ    3,DU
         4 001027   200024 036100                    ADLQ    P$,,AUTO
         4 001030   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001031   200056 757100                    STAQ    DATA_VECTRS+4,,AUTO

      559     7393
      560     7394    3             DATA_VECTRS(3) = VECTOR(BLANK_YES(BITBIN(VLP_CGTYPL.LIST.JOURNAL#(I))));

   7394  4 001032   200006 236100                    LDQ     I,,AUTO
         4 001033   000007 402007                    MPY     7,DL
         4 001034   200024 470500                    LDP0    P$,,AUTO
         4 001035   000003 236106                    LDQ     3,QL,PR0
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:77   
         4 001036   000031 772000                    QRL     25
         4 001037   000001 376007                    ANQ     1,DL
         4 001040   577640 235007                    LDA     -65632,DL
         4 001041   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001042   600000 402007                    MPY     -65536,DL
         4 001043   000021 036000 5                  ADLQ    17
         4 001044   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001045   200060 757100                    STAQ    DATA_VECTRS+6,,AUTO

      561     7395
      562     7396    3             DATA_VECTRS(4) = VECTOR(VLP_CGQL.LIST.MSGCNT#(I));

   7396  4 001046   777640 235007                    LDA     -96,DL
         4 001047   200006 236100                    LDQ     I,,AUTO
         4 001050   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001051   000011 402003                    MPY     9,DU
         4 001052   000002 036003                    ADLQ    2,DU
         4 001053   200025 036100                    ADLQ    Q$,,AUTO
         4 001054   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001055   200062 757100                    STAQ    DATA_VECTRS+8,,AUTO

      563     7397
      564     7398    3             DATA_VECTRS(5) = VECTOR(VLP_CGQL.LIST.MXACT#(I));

   7398  4 001056   777640 235007                    LDA     -96,DL
         4 001057   200006 236100                    LDQ     I,,AUTO
         4 001060   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001061   000011 402003                    MPY     9,DU
         4 001062   200025 036100                    ADLQ    Q$,,AUTO
         4 001063   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001064   200064 757100                    STAQ    DATA_VECTRS+10,,AUTO

      565     7399
      566     7400    3             DATA_VECTRS(6) = VECTOR(VLP_CGQL.LIST.CNACT#(I));

   7400  4 001065   777640 235007                    LDA     -96,DL
         4 001066   200006 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:78   
         4 001067   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001070   000011 402003                    MPY     9,DU
         4 001071   000001 036003                    ADLQ    1,DU
         4 001072   200025 036100                    ADLQ    Q$,,AUTO
         4 001073   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001074   200066 757100                    STAQ    DATA_VECTRS+12,,AUTO

      567     7401
      568     7402    3            DATA_VECTRS(7) = VECTOR(BLANK_YES(BITBIN(VLP_CGTYPL.LIST.ONEREPORT#(I))));

   7402  4 001075   200006 236100                    LDQ     I,,AUTO
         4 001076   000007 402007                    MPY     7,DL
         4 001077   000003 236106                    LDQ     3,QL,PR0
         4 001100   000030 772000                    QRL     24
         4 001101   000001 376007                    ANQ     1,DL
         4 001102   577640 235007                    LDA     -65632,DL
         4 001103   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001104   600000 402007                    MPY     -65536,DL
         4 001105   000021 036000 5                  ADLQ    17
         4 001106   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001107   200070 757100                    STAQ    DATA_VECTRS+14,,AUTO

      569     7403    3             CALL X$FORMAT(F_FDS);

   7403  4 001110   000013 630400 5                  EPPR0   11
         4 001111   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001112   000000 701000 xent               TSX1    X$FORMAT
         4 001113   000000 011000                    NOP     0

      570     7404    3           END;                            /* of Do loop                         */

   7404  4 001114   200006 235100                    LDA     I,,AUTO
         4 001115   000001 035007                    ADLA    1,DL
         4 001116   200006 755100                    STA     I,,AUTO
         4 001117   200024 470500                    LDP0    P$,,AUTO
         4 001120   200006 236100                    LDQ     I,,AUTO
         4 001121   000000 116100                    CMPQ    0,,PR0
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:79   
         4 001122   001002 602000 4                  TNC     s:7388

      571     7405
      572     7406    2   RET:
      573     7407    2           IF P$ ~= ADDR(NIL) THEN

   7407  4 001123   200024 236100       RET          LDQ     P$,,AUTO
         4 001124   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001125   001140 600000 4                  TZE     s:7412

      574     7408    3             DO;

      575     7409    3               CALL QQC$RLS_BLK(QQ_GLOBAL.POOL$, P$);

   7409  4 001126   200024 630500                    EPPR0   P$,,AUTO
         4 001127   200237 450500                    STP0    VLP_CGQL_SEL+17,,AUTO
         4 001130   000014 236000 5                  LDQ     12
         4 001131   200236 756100                    STQ     VLP_CGQL_SEL+16,,AUTO
         4 001132   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001133   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 001134   000000 701000 xent               TSX1    QQC$RLS_BLK
         4 001135   000000 011000                    NOP     0

      576     7410    3               P$ = ADDR(NIL);

   7410  4 001136   000001 236000 xsym               LDQ     B_VECTNIL+1
         4 001137   200024 756100                    STQ     P$,,AUTO

      577     7411    3             END;

      578     7412    2           RETURN;

   7412  4 001140   200230 221300                    LDX1  ! VLP_CGQL_SEL+10,,AUTO
         4 001141   000001 702211                    TSX2  ! 1,X1

      579     7413
      580     7414    2   MON_ERR:
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:80   
      581     7415    2           QQ_GLOBAL.ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR;

   7415  4 001142   100102 236100       MON_ERR      LDQ     66,,PR1
         4 001143   000000 756000 xsym               STQ     QQ_GLOBAL

      582     7416    2           CALL QQC$SCREECH;

   7416  4 001144   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 001145   000000 701000 xent               TSX1    QQC$SCREECH
         4 001146   000000 011000                    NOP     0

      583     7417
      584     7418    2   NO_MEM:
      585     7419
      586     7420    2           QQ_CMDBLK.MINOR_ERR = CODE_NO_POOLMEM;

   7420  4 001147   000057 236000 2     NO_MEM       LDQ     CODE_NO_POOLMEM
         4 001150   000001 756000 xsym               STQ     QQ_CMDBLK+1

      587     7421    2           CALL QQC$BLDMSG_BLK(MSGBLK);

   7421  4 001151   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 001152   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 001153   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001154   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001155   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001156   000000 011000                    NOP     0

      588     7422    2           CALL QQC$BLDMSG(MSGBLK);

   7422  4 001157   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 001160   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 001161   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001162   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001163   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001164   000000 011000                    NOP     0

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:81   
      589     7423    2           RETURN;

   7423  4 001165   200230 221300                    LDX1  ! VLP_CGQL_SEL+10,,AUTO
         4 001166   000001 702211                    TSX2  ! 1,X1

      590     7424
      591     7425    2   END DISPLAY_TYPE;
      592     7426                %PAGE(ARG="DISPLAY_DCB", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:82   
              7443    2   /***************************************************************************
              7444    2    *                                                                         *
              7445    2    *                                DISPLAY_DCB                              *
              7446    2    *                                                                         *
              7447    2    ***************************************************************************/

      593     7451    1   DISPLAY_DCB:

   7451  4 001167   200230 741300       DISPLAY_DCB  STX1  ! VLP_CGQL_SEL+10,,AUTO

      594     7452    1           PROC;
      595     7453
      596     7454    2           QQ_CMDBLK.MINOR_ERR = CODE_DCBTITLE;

   7454  4 001170   000050 236000 2                  LDQ     CODE_DCBTITLE
         4 001171   000001 756000 xsym               STQ     QQ_CMDBLK+1

      597     7455    2           CALL QQC$BLDMSG_BLK(MSGBLK);

   7455  4 001172   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 001173   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 001174   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001175   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001176   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001177   000000 011000                    NOP     0

      598     7456    2           CALL QQC$BLDMSG(MSGBLK);

   7456  4 001200   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 001201   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 001202   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001203   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001204   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001205   000000 011000                    NOP     0

      599     7457
      600     7458    2           F_FDS.BUF_ = VECTOR(BUF);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:83   

   7458  4 001206   000007 235000 5                  LDA     7
         4 001207   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 001210   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 001211   000026 036003                    ADLQ    22,DU
         4 001212   000005 755000 3                  STA     F_FDS+5
         4 001213   000006 756000 3                  STQ     F_FDS+6

      601     7459    2           F_FDS.VECTR$ = ADDR(DATA_VECTRS);

   7459  4 001214   200052 630500                    EPPR0   DATA_VECTRS,,AUTO
         4 001215   000012 450400 3                  STP0    F_FDS+10

      602     7460    2           F_FDS.NVECS# = 8;

   7460  4 001216   000010 235007                    LDA     8,DL
         4 001217   000011 755000 3                  STA     F_FDS+9

      603     7461    2           F_FDS.FMT_ = VECTOR(DCB_FORMAT);

   7461  4 001220   000024 237000 5                  LDAQ    20
         4 001221   000000 757000 3                  STAQ    F_FDS

      604     7462
      605     7463    2           NEXT$ = QQ_GLOBAL.TPU$;

   7463  4 001222   000155 236000 xsym               LDQ     QQ_GLOBAL+109
         4 001223   200023 756100                    STQ     NEXT$,,AUTO

      606     7464
      607     7465    3           DO WHILE('1'B);

      608     7466    3             NEXT$ = NEXT$ -> TPU$INFO.FLINK$;

   7466  4 001224   200023 470500                    LDP0    NEXT$,,AUTO
         4 001225   000001 236100                    LDQ     1,,PR0
         4 001226   200023 756100                    STQ     NEXT$,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:84   

      609     7467    3             IF NEXT$ -> TPU$INFO.FLINK$ = ADDR(NIL) THEN

   7467  4 001227   200023 470500                    LDP0    NEXT$,,AUTO
         4 001230   000001 236100                    LDQ     1,,PR0
         4 001231   000001 116000 xsym               CMPQ    B_VECTNIL+1
         4 001232   001234 601000 4                  TNZ     s:7472

      610     7468    4               DO;

      611     7469    4                 GOTO RET;

   7469  4 001233   001326 710000 4                  TRA     RET

      612     7470    4               END;
      613     7471
      614     7472    3             T$ = NEXT$;

   7472  4 001234   200023 236100                    LDQ     NEXT$,,AUTO
         4 001235   200004 756100                    STQ     T$,,AUTO

      615     7473    3             DATA_VECTRS(0) = VECTOR(TPU$INFO.STATION);

   7473  4 001236   000012 235000 5                  LDA     10
         4 001237   000004 036003                    ADLQ    4,DU
         4 001240   200052 757100                    STAQ    DATA_VECTRS,,AUTO

      616     7474
      617     7475    3             IF TPU$INFO.FLAGS.CONNECT THEN

   7475  4 001241   200004 471500                    LDP1    T$,,AUTO
         4 001242   100011 234100                    SZN     9,,PR1
         4 001243   001253 605000 4                  TPL     s:7482

      618     7476    4               DO;

      619     7477    4                 DATA_VECTRS(1) = VECTOR(USE_FIELD);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:85   

   7477  4 001244   000026 237000 5                  LDAQ    22
         4 001245   200054 757100                    STAQ    DATA_VECTRS+2,,AUTO

      620     7478    4                 DATA_VECTRS(2) = VECTOR(TPU$INFO.UTS);

   7478  4 001246   777640 235007                    LDA     -96,DL
         4 001247   200004 236100                    LDQ     T$,,AUTO
         4 001250   000003 036003                    ADLQ    3,DU
         4 001251   200056 757100                    STAQ    DATA_VECTRS+4,,AUTO

      621     7479    4               END;

   7479  4 001252   001257 710000 4                  TRA     s:7486

      622     7480    3             ELSE
      623     7481    4               DO;

      624     7482    4                 DATA_VECTRS(1) = VECTOR(SKIP_FIELD);

   7482  4 001253   000030 237000 5                  LDAQ    24
         4 001254   200054 757100                    STAQ    DATA_VECTRS+2,,AUTO

      625     7483    4                 DATA_VECTRS(2) = VECTOR(NIL);

   7483  4 001255   000032 237000 5                  LDAQ    26
         4 001256   200056 757100                    STAQ    DATA_VECTRS+4,,AUTO

      626     7484    4               END;

      627     7485
      628     7486    3             DATA_VECTRS(3) = VECTOR(TPU_STRANGER(

   7486  4 001257   100011 236100                    LDQ     9,,PR1
         4 001260   000040 772000                    QRL     32
         4 001261   000001 376007                    ANQ     1,DL
         4 001262   000012 235000 5                  LDA     10
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:86   
         4 001263   000023 736000                    QLS     19
         4 001264   000034 036000 5                  ADLQ    28
         4 001265   200060 757100                    STAQ    DATA_VECTRS+6,,AUTO

      629     7487    3                 BITBIN(TPU$INFO.FLAGS.STRANGER)));
      630     7488
      631     7489    3             IF TPU$INFO.FLAGS.TPU THEN

   7489  4 001266   100011 236100                    LDQ     9,,PR1
         4 001267   100000 316003                    CANQ    32768,DU
         4 001270   001276 600000 4                  TZE     s:7495

      632     7490    4               DO;

      633     7491    4                 DATA_VECTRS(4) = VECTOR(TPU$INFO.MSGTYP);

   7491  4 001271   000012 235000 5                  LDA     10
         4 001272   200004 236100                    LDQ     T$,,AUTO
         4 001273   000006 036003                    ADLQ    6,DU
         4 001274   200062 757100                    STAQ    DATA_VECTRS+8,,AUTO

      634     7492    4               END;

   7492  4 001275   001300 710000 4                  TRA     s:7498

      635     7493    3             ELSE
      636     7494    4               DO;

      637     7495    4                 DATA_VECTRS(4) = VECTOR(BLANK);

   7495  4 001276   000036 237000 5                  LDAQ    30
         4 001277   200062 757100                    STAQ    DATA_VECTRS+8,,AUTO

      638     7496    4               END;

      639     7497
      640     7498    3             DATA_VECTRS(5) = VECTOR(TPU$INFO.SYSID);
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:87   

   7498  4 001300   777640 235007                    LDA     -96,DL
         4 001301   200004 236100                    LDQ     T$,,AUTO
         4 001302   000002 036003                    ADLQ    2,DU
         4 001303   200064 757100                    STAQ    DATA_VECTRS+10,,AUTO

      641     7499
      642     7500    3             DATA_VECTRS(6) = VECTOR(BLANK_YES(BITBIN(TPU$INFO.FLAGS.DISCONNECT)));

   7500  4 001304   100011 236100                    LDQ     9,,PR1
         4 001305   000042 772000                    QRL     34
         4 001306   000001 376007                    ANQ     1,DL
         4 001307   577640 235007                    LDA     -65632,DL
         4 001310   200236 755100                    STA     VLP_CGQL_SEL+16,,AUTO
         4 001311   600000 402007                    MPY     -65536,DL
         4 001312   000021 036000 5                  ADLQ    17
         4 001313   200236 235100                    LDA     VLP_CGQL_SEL+16,,AUTO
         4 001314   200066 757100                    STAQ    DATA_VECTRS+12,,AUTO

      643     7501
      644     7502    3             DATA_VECTRS(7) = VECTOR(TPU$INFO.TIMEOUT);

   7502  4 001315   777640 235007                    LDA     -96,DL
         4 001316   200004 236100                    LDQ     T$,,AUTO
         4 001317   000010 036003                    ADLQ    8,DU
         4 001320   200070 757100                    STAQ    DATA_VECTRS+14,,AUTO

      645     7503
      646     7504    3             CALL X$FORMAT(F_FDS);

   7504  4 001321   000013 630400 5                  EPPR0   11
         4 001322   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001323   000000 701000 xent               TSX1    X$FORMAT
         4 001324   000000 011000                    NOP     0

      647     7505
      648     7506    3   LOOP:
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:88   
      649     7507    3           END /* WHILE */;

   7507  4 001325   001224 710000 4     LOOP         TRA     s:7466

      650     7508
      651     7509    2   RET:
      652     7510    2           RETURN;

   7510  4 001326   200230 221300       RET          LDX1  ! VLP_CGQL_SEL+10,,AUTO
         4 001327   000001 702211                    TSX2  ! 1,X1

      653     7511
      654     7512    2   END DISPLAY_DCB;
      655     7513                %PAGE(ARG="FORMAT_HEADER", PAGE=YES);

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:89   
              7530    2   /***************************************************************************
              7531    2    *                                                                         *
              7532    2    *                               FORMAT_HEADER                             *
              7533    2    *                                                                         *
              7534    2    ***************************************************************************/

      656     7538    1   FORMAT_HEADER:

   7538  4 001330   200234 741300       FORMAT_HEAD* STX1  ! VLP_CGQL_SEL+14,,AUTO

      657     7539    1           PROC;
      658     7540
      659     7541    2           ERR = CODE_LPARAM1;

   7541  4 001331   000045 236000 2                  LDQ     CODE_LPARAM1
         4 001332   200205 756100                    STQ     ERR,,AUTO

      660     7542    2           ERR.CODE = ERR.CODE + PARAM_NUM - 18 /* LOW_LET */;

   7542  4 001333   200205 236100                    LDQ     ERR,,AUTO
         4 001334   000003 772000                    QRL     3
         4 001335   037777 376007                    ANQ     16383,DL
         4 001336   200012 036100                    ADLQ    PARAM_NUM,,AUTO
         4 001337   000022 136007                    SBLQ    18,DL
         4 001340   000003 736000                    QLS     3
         4 001341   200205 676100                    ERQ     ERR,,AUTO
         4 001342   377770 376007                    ANQ     131064,DL
         4 001343   200205 656100                    ERSQ    ERR,,AUTO

      661     7543    2           START_POS = 0;

   7543  4 001344   200010 450100                    STZ     START_POS,,AUTO

      662     7544
      663     7545    2           IF (PC$INSTANCE.HDR.CNT = 0) THEN

   7545  4 001345   000154 470400 xsym               LDP0    QQ_GLOBAL+108
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:90   
         4 001346   000004 236100                    LDQ     4,,PR0
         4 001347   777000 316003                    CANQ    -512,DU
         4 001350   001361 601000 4                  TNZ     s:7554

      664     7546    3             DO;

      665     7547    3               TEXTC_STRING.NAME# ='NONE';

   7547  4 001351   040100 100400                    MLR     fill='040'O
         4 001352   000060 000004 2                  ADSC9   CODE_NO_POOLMEM+1        cn=0,n=4
         4 001353   200155 200074                    ADSC9   TEXTC_STRING,,AUTO       cn=1,n=60

      666     7548    3               TEXTC_STRING.L# = 4;

   7548  4 001354   004000 236003                    LDQ     2048,DU
         4 001355   200155 552140                    STBQ    TEXTC_STRING,'40'O,AUTO

      667     7549    3               END_POS = 4;

   7549  4 001356   000004 235007                    LDA     4,DL
         4 001357   200011 755100                    STA     END_POS,,AUTO

      668     7550    3               GOTO SEND_HEADER;

   7550  4 001360   001425 710000 4                  TRA     SEND_HEADER

      669     7551
      670     7552    3             END;
      671     7553    3           ELSE DO;              /* FORMAT HEADER MESSAGE INTO LINES OF 30 CHARS */

      672     7554    4               DO WHILE (START_POS < PC$INSTANCE.HDR.CNT) ;

   7554  4 001361   000004 236100                    LDQ     4,,PR0
         4 001362   000033 772000                    QRL     27
         4 001363   200010 116100                    CMPQ    START_POS,,AUTO
         4 001364   001531 604400 4                  TMOZ    s:7592

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:91   
      673     7555    4                 END_POS = START_POS + 60; /* MAX_LENGTH OF TEXTC                */

   7555  4 001365   200010 235100                    LDA     START_POS,,AUTO
         4 001366   000074 035007                    ADLA    60,DL
         4 001367   200011 755100                    STA     END_POS,,AUTO

      674     7556    5                 DO WHILE (SUBSTR(PC$INSTANCE.HDR.MSG,END_POS,1) ~= ' ')

   7556  4 001370   001373 710000 4                  TRA     s:7559

      675     7557    5                     AND (END_POS > START_POS);
      676     7558    5                   END_POS = END_POS - 1;

   7558  4 001371   000001 336007                    LCQ     1,DL
         4 001372   200011 056100                    ASQ     END_POS,,AUTO

      677     7559    5                 END;                      /* FOUND A WORD BREAK  OR60CHARACTERS */

   7559  4 001373   000154 470400 xsym               LDP0    QQ_GLOBAL+108
         4 001374   200011 235100                    LDA     END_POS,,AUTO
         4 001375   040000 106505                    CMPC    fill='040'O
         4 001376   000004 200001                    ADSC9   4,A,PR0                  cn=1,n=1
         4 001377   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 001400   001404 600000 4                  TZE     s:7560
         4 001401   200011 236100                    LDQ     END_POS,,AUTO
         4 001402   200010 116100                    CMPQ    START_POS,,AUTO
         4 001403   001371 605400 4                  TPNZ    s:7558

      678     7560    4                 IF (END_POS = START_POS) THEN END_POS = START_POS + 60;

   7560  4 001404   200011 236100                    LDQ     END_POS,,AUTO
         4 001405   200010 116100                    CMPQ    START_POS,,AUTO
         4 001406   001412 601000 4                  TNZ     s:7562

   7560  4 001407   200010 235100                    LDA     START_POS,,AUTO
         4 001410   000074 035007                    ADLA    60,DL
         4 001411   200011 755100                    STA     END_POS,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:92   

      679     7561
      680     7562    4                 TEXTC_STRING.L# = END_POS - START_POS;

   7562  4 001412   200011 236100                    LDQ     END_POS,,AUTO
         4 001413   200010 136100                    SBLQ    START_POS,,AUTO
         4 001414   000033 736000                    QLS     27
         4 001415   200155 552140                    STBQ    TEXTC_STRING,'40'O,AUTO

      681     7563    4                 TEXTC_STRING.NAME# = SUBSTR(PC$INSTANCE.HDR.MSG,

   7563  4 001416   200011 236100                    LDQ     END_POS,,AUTO
         4 001417   200010 136100                    SBLQ    START_POS,,AUTO
         4 001420   000000 620006                    EAX0    0,QL
         4 001421   200010 236100                    LDQ     START_POS,,AUTO
         4 001422   040100 100546                    MLR     fill='040'O
         4 001423   000004 200010                    ADSC9   4,Q,PR0                  cn=1,n=*X0
         4 001424   200155 200074                    ADSC9   TEXTC_STRING,,AUTO       cn=1,n=60

      682     7564    4                     START_POS,
      683     7565    4                     END_POS-START_POS);
      684     7566    4   SEND_HEADER:  CALL QQC$BLDMSG_BLK(MSGBLK);

   7566  4 001425   200125 631500       SEND_HEADER  EPPR1   MSGBLK,,AUTO
         4 001426   200236 451500                    STP1    VLP_CGQL_SEL+16,,AUTO
         4 001427   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001430   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001431   000000 701000 xent               TSX1    QQC$BLDMSG_BLK
         4 001432   000000 011000                    NOP     0

      685     7567    4                 MSGBLK.ERRINFO.ERR(0) = ERR;

   7567  4 001433   200205 236100                    LDQ     ERR,,AUTO
         4 001434   200133 756100                    STQ     MSGBLK+6,,AUTO

      686     7568    4                 IF (TEXTC_STRING.L# < 31) THEN /* Max substituion               */

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:93   
   7568  4 001435   200155 236100                    LDQ     TEXTC_STRING,,AUTO
         4 001436   777000 376003                    ANQ     -512,DU
         4 001437   037000 116003                    CMPQ    15872,DU
         4 001440   001445 603000 4                  TRC     s:7572

      687     7569    4                   MSGBLK.ERRINFO.FIELD2(0) = VECTOR(NIL);

   7569  4 001441   000100 100400                    MLR     fill='000'O
         4 001442   000032 000010 5                  ADSC9   26                       cn=0,n=8
         4 001443   200136 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8
         4 001444   001470 710000 4                  TRA     s:7582

      688     7570    5                 ELSE DO;             /* String is too long for one substition   */

      689     7571                                 /* move the second half to a second substitution     */
      690     7572    5                     TEXTC_STRING2.NAME# = SUBSTR(TEXTC_STRING.NAME#,

   7572  4 001445   200155 236100                    LDQ     TEXTC_STRING,,AUTO
         4 001446   000033 772000                    QRL     27
         4 001447   777742 620006                    EAX0    -30,QL
         4 001450   040100 100540                    MLR     fill='040'O
         4 001451   200165 000010                    ADSC9   TEXTC_STRING+8,,AUTO     cn=0,n=*X0
         4 001452   200175 200036                    ADSC9   TEXTC_STRING2,,AUTO      cn=1,n=30

      691     7573    5                         31,
      692     7574    5                         TEXTC_STRING.L# - 30);
      693     7575    5                     TEXTC_STRING2.L# = TEXTC_STRING.L# - 30;

   7575  4 001453   000036 136007                    SBLQ    30,DL
         4 001454   000033 736000                    QLS     27
         4 001455   200175 552140                    STBQ    TEXTC_STRING2,'40'O,AUTO

      694     7576    5                     MSGBLK.ERRINFO.FIELD2(0) = VECTOR(TEXTC_STRING2);

   7576  4 001456   000040 235000 5                  LDA     32
         4 001457   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 001460   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:94   
         4 001461   000175 036003                    ADLQ    125,DU
         4 001462   200240 757100                    STAQ    VLP_CGQL_SEL+18,,AUTO
         4 001463   000100 100500                    MLR     fill='000'O
         4 001464   200240 000010                    ADSC9   VLP_CGQL_SEL+18,,AUTO    cn=0,n=8
         4 001465   200136 200010                    ADSC9   MSGBLK+9,,AUTO           cn=1,n=8

      695     7577
      696     7578                                                /* Delete that half from TEXTC_STRING */
      697     7579    5                     TEXTC_STRING.L# = 31;

   7579  4 001466   037000 236003                    LDQ     15872,DU
         4 001467   200155 552140                    STBQ    TEXTC_STRING,'40'O,AUTO

      698     7580    5                   END ;                   /* ELSE                               */

      699     7581
      700     7582    4                 MSGBLK.ERRINFO.FIELD1(0) = VECTOR(TEXTC_STRING);

   7582  4 001470   000006 235000 5                  LDA     6
         4 001471   200236 452500                    STP2    VLP_CGQL_SEL+16,,AUTO
         4 001472   200236 236100                    LDQ     VLP_CGQL_SEL+16,,AUTO
         4 001473   000155 036003                    ADLQ    109,DU
         4 001474   200240 757100                    STAQ    VLP_CGQL_SEL+18,,AUTO
         4 001475   000100 100500                    MLR     fill='000'O
         4 001476   200240 000010                    ADSC9   VLP_CGQL_SEL+18,,AUTO    cn=0,n=8
         4 001477   200134 200010                    ADSC9   MSGBLK+7,,AUTO           cn=1,n=8

      701     7583    4                 CALL QQC$BLDMSG(MSGBLK);

   7583  4 001500   200125 630500                    EPPR0   MSGBLK,,AUTO
         4 001501   200236 450500                    STP0    VLP_CGQL_SEL+16,,AUTO
         4 001502   200236 630500                    EPPR0   VLP_CGQL_SEL+16,,AUTO
         4 001503   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 001504   000000 701000 xent               TSX1    QQC$BLDMSG
         4 001505   000000 011000                    NOP     0

      702     7584
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:95   
      703     7585                                                /* Move to Continuation ERR message   */
      704     7586    4                 ERR = CODE_LPARAM1;

   7586  4 001506   000045 236000 2                  LDQ     CODE_LPARAM1
         4 001507   200205 756100                    STQ     ERR,,AUTO

      705     7587    4                 ERR.CODE = ERR.CODE + PARAM_NUM - 18 /* LOW_LET */ + 1;

   7587  4 001510   200205 236100                    LDQ     ERR,,AUTO
         4 001511   000003 772000                    QRL     3
         4 001512   037777 376007                    ANQ     16383,DL
         4 001513   200012 036100                    ADLQ    PARAM_NUM,,AUTO
         4 001514   000021 136007                    SBLQ    17,DL
         4 001515   000003 736000                    QLS     3
         4 001516   200205 676100                    ERQ     ERR,,AUTO
         4 001517   377770 376007                    ANQ     131064,DL
         4 001520   200205 656100                    ERSQ    ERR,,AUTO

      706     7588
      707     7589    4                 START_POS = END_POS + 1;

   7589  4 001521   200011 235100                    LDA     END_POS,,AUTO
         4 001522   000001 035007                    ADLA    1,DL
         4 001523   200010 755100                    STA     START_POS,,AUTO

      708     7590    4               END;                        /* DO WHILE START_POS                 */

   7590  4 001524   000154 470400 xsym               LDP0    QQ_GLOBAL+108
         4 001525   000004 236100                    LDQ     4,,PR0
         4 001526   000033 772000                    QRL     27
         4 001527   200010 116100                    CMPQ    START_POS,,AUTO
         4 001530   001365 605400 4                  TPNZ    s:7555

      709     7591    3             END;                          /* ELSE DO                            */

      710     7592    2           RETURN;

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:96   
   7592  4 001531   200234 221300                    LDX1  ! VLP_CGQL_SEL+14,,AUTO
         4 001532   000001 702211                    TSX2  ! 1,X1
      711     7593
      712     7594    2   END FORMAT_HEADER;
      713     7595    1   END QQB$DISPLAY;

PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:97   
--  Include file information  --

   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   Q_ERRCODE_C.:E05TOU  is referenced.
   QQ_PERR_C.:E05TOU  is referenced.
   QQ_CMDFLAGS_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   QQ_MACROS_C.:E05TOU  is referenced.
   QQ_SUBS_C.:E05TOU  is referenced.
   PC_MACRO_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   Q_PAGE_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QQB$DISPLAY.
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:98   

 **** Variables and constants ****

  ****  Section 002 RoData QQB$DISPLAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/c CHAR        r     1 BLANK
     3-0-0/c CHAR(3)     r     1 BLANK_YES(0:1)
    50-0-0/b STRC        r     1 CODE_DCBTITLE             47-0-0/b STRC        r     1 CODE_FPTITLE
    53-0-0/b STRC        r     1 CODE_INVTYPE              45-0-0/b STRC        r     1 CODE_LPARAM1
    56-0-0/b STRC        r     1 CODE_NOTFOUND             57-0-0/b STRC        r     1 CODE_NO_POOLMEM
    46-0-0/b STRC        r     1 CODE_STATITLE             51-0-0/b STRC        r     1 CODE_TYPETITLE
    52-0-0/b STRC        r     1 CODE_UNKTYPE              15-0-0/c CHAR(47)    r     1 DCB_FORMAT
    11-0-0/c CHAR(14)    r     1 DISABLE_FORMAT             1-0-0/w UBIN        r     1 SKIP_FIELD
    43-0-0/c STRC        r     1 TEXTC_OFF                 44-0-0/c STRC(27)    r     1 TEXTC_ON
     5-0-0/c CHAR(8)     r     1 TPU_STRANGER(0:1)
    31-0-0/c CHAR(38)    r     1 TYPE_FORMAT                0-0-0/w UBIN        r     1 USE_FIELD

  ****  Section 003  Data  QQB$DISPLAY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    36-0-0/d STRC(1800)  r     1 FPT_CGINFO                 0-0-0/w STRC(1080)  r     1 F_FDS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    26-0-0/c CHAR(80)    r     1 BUF                        5-0-0/w UBIN        r     1 CHAR_STRING_SIZE
   122-0-0/w STRC(108)   r     1 CMDFLAGS                   3-0-0/w PTR         r     1 D$
    52-0-0/b BIT (72)    r     1 DATA_VECTRS(0:19)
    13-0-0/w UBIN        r     1 DISP_FMT                  11-0-0/w SBIN        r     1 END_POS
   205-0-0/b STRC        r     1 ERR                        6-0-0/w UBIN        r     1 I
     7-0-0/w UBIN        r     1 K                        125-0-0/w STRC(738)   r     1 MSGBLK
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:99   
    23-0-0/w PTR         r     1 NEXT$                     15-0-0/w UBIN        r     1 NSUBLKS
    21-0-0/w PTR         r     1 OPT$                      24-0-0/w PTR         r     1 P$
    12-0-0/w UBIN        r     1 PARAM_NUM                 25-0-0/w PTR         r     1 Q$
    14-0-0/w UBIN        r     1 SIZE                      10-0-0/w SBIN        r     1 START_POS
    20-0-0/w PTR         r     1 SUBLK$                     4-0-0/w PTR         r     1 T$
   152-0-0/c STRC(81)    r     1 TEXTC_NUM                155-0-0/c STRC(549)   r     1 TEXTC_STRING
   175-0-0/c STRC(279)   r     1 TEXTC_STRING2             16-0-0/w UBIN        r     1 TYPE
    22-0-0/w PTR         r     1 TYPE$                     17-0-0/w UBIN        r     1 TYPLIST_MULT
   216-0-0/d STRC(324)   r     1 VLP_CGQL_SEL             206-0-0/d STRC(288)   r     1 VLP_CGTYPL_SEL

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w STRC(315)   r     1 QQ_CMDBLK
     0-0-0/w STRC(6480)  r     1 QQ_CMDFLAGS                0-0-0/d STRC(9090)  r     1 QQ_GLOBAL

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/b UBIN(9)     r     1 BYTTE                      0-0-0/c ACHR        r     1 CHAR$STRING
     0-0-0/w STRC(288)   r     1 DISAB$INFO                 0-0-0/w BIT         r     1 FLAG
     0-0-0N  NULL        r     1 M$CG                       0-0-0/w STRC(144)   r     1 OUT$BLK
     0-0-0/w ASTR(153)   r     1 OUT$SYM                    0-0-0/w STRC(2700)  r     1 PC$INSTANCE
     0-0-0/w STRC(361)   r     1 TPU$INFO                   0-0-0/w UBIN        r     1 UBIN_WORD
     0-0-0/d STRC(324)   r     1 VLP_CGQL                   0-0-0/d STRC(288)   r     1 VLP_CGTYPL


   Procedure QQB$DISPLAY requires 859 words for executable code.
   Procedure QQB$DISPLAY requires 164 words of local(AUTO) storage.
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:100  

    No errors detected in file QQB$DISPLAY.:E05TSI    .
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:101  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:102  
          MINI XREF LISTING

B$ALT.CODE
      5970**DCL      5970--REDEF    5971--REDEF    5971--REDEF
B$ALT.ERR
      5971**DCL      7415>>ASSIGN
B$ALT.ERR.CODE
      5972**DCL      7324>>IF       7327>>IF
B$ALT.ERR.ERR#
      5972**DCL      5972--REDEF
B$ALT.EVID
      5971**DCL      5971--REDEF    5971--REDEF
B$TCB.ALT$
      5966**DCL      7324>>IF       7327>>IF       7415>>ASSIGN
B$TCB$
      5730**DCL      7324>>IF       7327>>IF       7415>>ASSIGN
BLANK
      6077**DCL      7495--ASSIGN
BLANK_YES
      6078**DCL      7394--ASSIGN   7402--ASSIGN   7500--ASSIGN
BUF
      6320**DCL      7220--ASSIGN   7382--ASSIGN   7458--ASSIGN
BYTTE
      5783**DCL      7164>>ASSIGN
CGINFO_ERR IN PROCEDURE DISPLAY_TYPE
      7324**LABEL    7319--CALLALT
CHAR$STRING
      5782**DCL      7159>>ASSIGN   7166--ASSIGN   7313--ASSIGN   7315--ASSIGN   7351--ASSIGN   7353--ASSIGN
CHAR_STRING_SIZE
      6301**DCL      5782--IMP-SIZ  7158<<ASSIGN   7159>>ASSIGN   7160>>ASSIGN   7164<<ASSIGN   7165<<ASSIGN
      7165>>ASSIGN   7166>>ASSIGN   7311<<ASSIGN   7313>>ASSIGN   7314<<ASSIGN   7315>>ASSIGN   7349<<ASSIGN
      7351>>ASSIGN   7352<<ASSIGN   7353>>ASSIGN
CMDFLAGS
      6324**DCL      7136<<ASSIGN
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:103  
CMDFLAGS.INFO.DATA$#
      6368**DCL      7142>>IF       7152>>CALL     7159>>ASSIGN   7164>>ASSIGN   7166>>ASSIGN
CMDFLAGS.INFO.INHIBPRINT#
      6362**DCL      7170>>IF
CMDFLAGS.INFO.LEN#
      6360**DCL      7158>>ASSIGN
CMDFLAGS.INFO.TYPE#
      6364**DCL      7140>>DOCASE
CODE_DCBTITLE
      6596**DCL      7454>>ASSIGN
CODE_FPTITLE
      6589**DCL      7214>>ASSIGN
CODE_INVTYPE
      6617**DCL      7307>>ASSIGN
CODE_LPARAM1
      6575**DCL      7134>>ASSIGN   7541>>ASSIGN   7586>>ASSIGN
CODE_NOTFOUND
      6638**DCL      7368>>ASSIGN
CODE_NO_POOLMEM
      6645**DCL      7420>>ASSIGN
CODE_STATITLE
      6582**DCL      7210>>ASSIGN
CODE_TYPETITLE
      6603**DCL      7378>>ASSIGN
CODE_UNKTYPE
      6610**DCL      7326>>ASSIGN
D$
      5788**DCL      5789--IMP-PTR  7239<<ASSIGN   7240>>ASSIGN   7241>>ASSIGN   7242>>ASSIGN
DATA_VECTRS
      6322**DCL      7221--ASSIGN   7240<<ASSIGN   7241<<ASSIGN   7242<<ASSIGN   7383--ASSIGN   7388<<ASSIGN
      7390<<ASSIGN   7392<<ASSIGN   7394<<ASSIGN   7396<<ASSIGN   7398<<ASSIGN   7400<<ASSIGN   7402<<ASSIGN
      7459--ASSIGN   7473<<ASSIGN   7477<<ASSIGN   7478<<ASSIGN   7482<<ASSIGN   7483<<ASSIGN   7486<<ASSIGN
      7491<<ASSIGN   7495<<ASSIGN   7498<<ASSIGN   7500<<ASSIGN   7502<<ASSIGN
DCB_FORMAT
      6081**DCL      7461--ASSIGN
DISAB$INFO.FLINK$
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:104  
      5792**DCL      7228>>ASSIGN   7229>>IF
DISAB$INFO.ID
      5798**DCL      7242--ASSIGN
DISAB$INFO.ITEM
      5800**DCL      7240--ASSIGN
DISAB$INFO.TYPE
      5794**DCL      7234>>IF
DISAB$INFO.UTS
      5796**DCL      7241--ASSIGN
DISABLE_FORMAT
      6080**DCL      7223--ASSIGN
DISPLAY_DCB
      7452**PROC     7010--CALL
DISPLAY_DISABLED
      7204**PROC     7013--CALL
DISPLAY_PARAMETER
      7079**PROC     7007--CALL
DISPLAY_TYPE
      7279**PROC     7016--CALL
DISP_FMT
      6307**DCL      7001<<ASSIGN   7003<<ASSIGN   7005>>DOCASE
END_POS
      6305**DCL      7549<<ASSIGN   7555<<ASSIGN   7556>>DOWHILE  7556>>DOWHILE  7558<<ASSIGN   7558>>ASSIGN
      7560>>IF       7560<<ASSIGN   7562>>ASSIGN   7563>>ASSIGN   7589>>ASSIGN
ERR
      6543**DCL      7134<<ASSIGN   7138>>ASSIGN   7541<<ASSIGN   7567>>ASSIGN   7586<<ASSIGN
ERR.CODE
      6547**DCL      7137<<ASSIGN   7137>>ASSIGN   7542<<ASSIGN   7542>>ASSIGN   7587<<ASSIGN   7587>>ASSIGN
FLAG
      5784**DCL      7142>>IF
FORMAT_HEADER
      7539**PROC     7050--CALL     7131--CALL
FORMAT_PARAM
      7127**PROC     7090--CALL     7095--CALL
FPT_CGINFO
      6845**DCL      7319<>CALL
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:105  
FPT_CGINFO.QLIST_
      6847**DCL      7301<<ASSIGN   7315<<ASSIGN   7353<<ASSIGN
FPT_CGINFO.TYPLIST_
      6845**DCL      7300<<ASSIGN   7313<<ASSIGN   7351<<ASSIGN
FPT_CGINFO.V
      6850**DCL      6845--DCLINIT
FPT_CGINFO.V.TYPFC#
      6851**DCL      7294<<ASSIGN   7310<<ASSIGN   7372>>IF
F_FDS
      6177**DCL      7244<>CALL     7403<>CALL     7504<>CALL
F_FDS.BUF_
      6194**DCL      7220<<ASSIGN   7382<<ASSIGN   7458<<ASSIGN
F_FDS.FMT_
      6181**DCL      7223<<ASSIGN   7385<<ASSIGN   7461<<ASSIGN
F_FDS.NVECS#
      6205**DCL      7222<<ASSIGN   7384<<ASSIGN   7460<<ASSIGN
F_FDS.VECTR$
      6207**DCL      7221<<ASSIGN   7383<<ASSIGN   7459<<ASSIGN
I
      6302**DCL      7083<<DOINDEX  7084>>ASSIGN   7303<<CALLBLT  7305>>IF       7387<<DOINDEX  7388>>ASSIGN
      7390>>ASSIGN   7392>>ASSIGN   7394>>ASSIGN   7396>>ASSIGN   7398>>ASSIGN   7400>>ASSIGN   7402>>ASSIGN
K
      6303**DCL      7088<<DOINDEX  7089>>ASSIGN
LOOP IN PROCEDURE DISPLAY_DISABLED
      7247**LABEL    7236--GOTO
M$CGINFO
        99**DCL-ENT  7319--CALL
MON_ERR IN PROCEDURE DISPLAY_TYPE
      7415**LABEL    7359--GOTO
MSGBLK
      6372**DCL      7135<>CALL     7172<>CALL     7217<>CALL     7218<>CALL     7361<>CALL     7362<>CALL
      7379<>CALL     7380<>CALL     7421<>CALL     7422<>CALL     7455<>CALL     7456<>CALL     7566<>CALL
      7583<>CALL
MSGBLK.ERRINFO.ERR
      6450**DCL      7138<<ASSIGN   7567<<ASSIGN
MSGBLK.ERRINFO.FIELD1
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:106  
      6454**DCL      7144<<ASSIGN   7148<<ASSIGN   7155<<ASSIGN   7161<<ASSIGN   7166<<ASSIGN   7582<<ASSIGN
MSGBLK.ERRINFO.FIELD2
      6456**DCL      7569<<ASSIGN   7576<<ASSIGN
NEXT$
      6316**DCL      7225<<ASSIGN   7228<<ASSIGN   7228>>ASSIGN   7229>>IF       7234>>IF       7239>>ASSIGN
      7463<<ASSIGN   7466<<ASSIGN   7466>>ASSIGN   7467>>IF       7472>>ASSIGN
NO_MEM IN PROCEDURE DISPLAY_TYPE
      7420**LABEL    7284--CALLALT  7341--CALLALT
NO_Q1 IN PROCEDURE DISPLAY_TYPE
      7319**LABEL    7303--CALLALT  7356--GOTO
NSUBLKS
      6309**DCL      7081<<ASSIGN   7083>>DOINDEX
OPT$
      6314**DCL      7084<<ASSIGN   7085>>ASSIGN
OUT$BLK.CODE
      5846**DCL      7001>>ASSIGN
OUT$BLK.NSUBLKS
      5850**DCL      7081>>ASSIGN
OUT$BLK.SUBLK$
      5871**DCL      6998>>ASSIGN   7084>>ASSIGN   7206>>ASSIGN   7296>>ASSIGN
OUT$SYM.CODE
      5890**DCL      7085>>ASSIGN   7206>>ASSIGN
OUT$SYM.COUNT
      5907**DCL      5910--IMP-SIZ  7297>>ASSIGN   7298>>ASSIGN   7305>>IF       7348>>ASSIGN
OUT$SYM.TEXT
      5910**DCL      7297>>ASSIGN   7298>>ASSIGN   7348>>ASSIGN
P$
      6317**DCL      6897--IMP-PTR  7282<<ASSIGN   7284<>CALL     7287>>ASSIGN   7291>>ASSIGN   7297>>ASSIGN
      7303>>CALLBLT  7313>>ASSIGN   7331>>IF       7334<>CALL     7335<<ASSIGN   7341<>CALL     7344>>ASSIGN
      7347>>ASSIGN   7348>>ASSIGN   7351>>ASSIGN   7366>>IF       7374>>ASSIGN   7387>>DOINDEX  7388>>ASSIGN
      7390>>ASSIGN   7392>>ASSIGN   7394>>ASSIGN   7402>>ASSIGN   7407>>IF       7409<>CALL     7410<<ASSIGN
PARAM_NUM
      6306**DCL      7049<<ASSIGN   7085<<ASSIGN   7086>>IF       7089<<ASSIGN   7129>>IF       7136>>ASSIGN
      7137>>ASSIGN   7542>>ASSIGN   7587>>ASSIGN
PC$INSTANCE.HDR.CNT
      5925**DCL      7545>>IF       7554>>DOWHILE
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:107  
PC$INSTANCE.HDR.MSG
      5926**DCL      7556>>DOWHILE  7563>>ASSIGN
PRINT_ERR IN PROCEDURE DISPLAY_TYPE
      7361**LABEL    7308--GOTO     7369--GOTO
Q$
      6318**DCL      6945--IMP-PTR  7287<<ASSIGN   7315>>ASSIGN   7344<<ASSIGN   7353>>ASSIGN   7375>>ASSIGN
      7396>>ASSIGN   7398>>ASSIGN   7400>>ASSIGN
QQC$BLDMSG
      5700**DCL-ENT  7172--CALL     7218--CALL     7362--CALL     7380--CALL     7422--CALL     7456--CALL
      7583--CALL
QQC$BLDMSG_BLK
      5699**DCL-ENT  7135--CALL     7217--CALL     7361--CALL     7379--CALL     7421--CALL     7455--CALL
      7566--CALL
QQC$CONVERT_NUM
      5701**DCL-ENT  7152--CALL
QQC$GET_BLK
      5697**DCL-ENT  7284--CALL     7341--CALL
QQC$PRINT_FMT
      5702**DCL-ENT  6231--DCLINIT
QQC$RLS_BLK
      5698**DCL-ENT  7334--CALL     7409--CALL
QQC$SCREECH
      5703**DCL-ENT  7416--CALL
QQ_CMDBLK.MINOR_ERR
      1929**DCL      7210<<ASSIGN   7214<<ASSIGN   7307<<ASSIGN   7326<<ASSIGN   7368<<ASSIGN   7378<<ASSIGN
      7420<<ASSIGN   7454<<ASSIGN
QQ_CMDBLK.OUT$
      1929**DCL      6998>>ASSIGN
QQ_CMDFLAGS.INFO
      2174**DCL      7136>>ASSIGN
QQ_GLOBAL.DISAB$
      1938**DCL      7225>>ASSIGN
QQ_GLOBAL.DS1$_BITS
      1940**DCL      1940--REDEF
QQ_GLOBAL.DS2$_BITS
      1940**DCL      1941--REDEF
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:108  
QQ_GLOBAL.DS3$_BITS
      1941**DCL      1941--REDEF
QQ_GLOBAL.DS4$_BITS
      1941**DCL      1942--REDEF
QQ_GLOBAL.ERR
      1930**DCL      7415<<ASSIGN
QQ_GLOBAL.PC$INSTANCE$
      1942**DCL      5916--IMP-PTR  7545>>IF       7554>>DOWHILE  7556>>DOWHILE  7563>>ASSIGN
QQ_GLOBAL.POOL$
      1941**DCL      7284<>CALL     7334<>CALL     7341<>CALL     7409<>CALL
QQ_GLOBAL.TPU$
      1942**DCL      7463>>ASSIGN
RET IN PROCEDURE DISPLAY_DCB
      7510**LABEL    7469--GOTO
RET IN PROCEDURE DISPLAY_DISABLED
      7250**LABEL    7231--GOTO
RET IN PROCEDURE DISPLAY_TYPE
      7407**LABEL    7363--GOTO
SEND_HEADER IN PROCEDURE FORMAT_HEADER
      7566**LABEL    7550--GOTO
SIZE
      6308**DCL      7152<>CALL     7154>>ASSIGN
SKIP_FIELD
      6075**DCL      7482--ASSIGN
START_POS
      6304**DCL      7543<<ASSIGN   7554>>DOWHILE  7555>>ASSIGN   7556>>DOWHILE  7560>>IF       7560>>ASSIGN
      7562>>ASSIGN   7563>>ASSIGN   7563>>ASSIGN   7589<<ASSIGN
SUBLK$
      6313**DCL      6998<<ASSIGN   6999>>IF       7001>>ASSIGN   7081>>ASSIGN   7084>>ASSIGN   7206>>ASSIGN
      7296>>ASSIGN
T$
      5804**DCL      5805--IMP-PTR  7472<<ASSIGN   7473>>ASSIGN   7475>>IF       7478>>ASSIGN   7486>>ASSIGN
      7489>>IF       7491>>ASSIGN   7498>>ASSIGN   7500>>ASSIGN   7502>>ASSIGN
TEXTC_NUM
      6486**DCL      7155--ASSIGN
TEXTC_NUM.L#
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:109  
      6486**DCL      7154<<ASSIGN
TEXTC_NUM.NAME#
      6486**DCL      7152--CALL
TEXTC_OFF
      6109**DCL      7148--ASSIGN
TEXTC_ON
      6136**DCL      7144--ASSIGN
TEXTC_STRING
      6513**DCL      7161--ASSIGN   7582--ASSIGN
TEXTC_STRING.L#
      6513**DCL      7160<<ASSIGN   7548<<ASSIGN   7562<<ASSIGN   7568>>IF       7572>>ASSIGN   7575>>ASSIGN
      7579<<ASSIGN
TEXTC_STRING.NAME#
      6513**DCL      7159<<ASSIGN   7547<<ASSIGN   7563<<ASSIGN   7572>>ASSIGN
TEXTC_STRING2
      6540**DCL      7576--ASSIGN
TEXTC_STRING2.L#
      6540**DCL      7575<<ASSIGN
TEXTC_STRING2.NAME#
      6540**DCL      7572<<ASSIGN
TPU$INFO.FLAGS.CONNECT
      5822**DCL      7475>>IF
TPU$INFO.FLAGS.DISCONNECT
      5824**DCL      7500>>ASSIGN
TPU$INFO.FLAGS.STRANGER
      5828**DCL      7486>>ASSIGN
TPU$INFO.FLAGS.TPU
      5826**DCL      7489>>IF
TPU$INFO.FLINK$
      5808**DCL      7466>>ASSIGN   7467>>IF
TPU$INFO.MSGTYP
      5816**DCL      7491--ASSIGN
TPU$INFO.STATION
      5814**DCL      7473--ASSIGN
TPU$INFO.SYSID
      5810**DCL      7498--ASSIGN
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:110  
TPU$INFO.TIMEOUT
      5818**DCL      7502--ASSIGN
TPU$INFO.UTS
      5812**DCL      7478--ASSIGN
TPU_STRANGER
      6079**DCL      7486--ASSIGN
TYPE
      6310**DCL      7206<<ASSIGN   7208>>IF       7234>>IF
TYPE$
      6315**DCL      7296<<ASSIGN   7297>>ASSIGN   7297>>ASSIGN   7298>>ASSIGN   7298>>ASSIGN   7305>>IF
      7348>>ASSIGN   7348>>ASSIGN
TYPE_FORMAT
      6082**DCL      7385--ASSIGN
TYPLIST_MULT
      6311**DCL      7281<<ASSIGN   7284>>CALL     7287>>ASSIGN   7311>>ASSIGN   7314>>ASSIGN   7316<<ASSIGN
      7316>>ASSIGN   7341>>CALL     7344>>ASSIGN   7349>>ASSIGN   7352>>ASSIGN   7354<<ASSIGN   7354>>ASSIGN
UBIN_WORD
      5785**DCL      7152<>CALL
USE_FIELD
      6074**DCL      7477--ASSIGN
VLP_CGQL
      6945**DCL      7284--CALL     7314--ASSIGN   7341--CALL     7352--ASSIGN   7375<<ASSIGN
VLP_CGQL.LIST.CNACT#
      6945**DCL      7400--ASSIGN
VLP_CGQL.LIST.MSGCNT#
      6946**DCL      7396--ASSIGN
VLP_CGQL.LIST.MXACT#
      6945**DCL      7398--ASSIGN
VLP_CGQL_SEL
      6967**DCL      7301--ASSIGN   7375>>ASSIGN
VLP_CGTYPL
      6897**DCL      7374<<ASSIGN
VLP_CGTYPL.FOUND#
      6897**DCL      7284--CALL     7287--ASSIGN   7291<<ASSIGN   7311--ASSIGN   7341--CALL     7344--ASSIGN
      7347<<ASSIGN   7349--ASSIGN   7366>>IF       7387>>DOINDEX
VLP_CGTYPL.LIST
PL6.E3A0      #001=QQB$DISPLAY File=QQB$DISPLAY.:E05TSI                          WED 07/30/97 05:30 Page:111  
      6897**DCL      7284--CALL     7287--ASSIGN   7311--ASSIGN   7341--CALL     7344--ASSIGN   7349--ASSIGN
VLP_CGTYPL.LIST.JOURNAL#
      6898**DCL      7394>>ASSIGN
VLP_CGTYPL.LIST.NAME#
      6897**DCL      7297<<ASSIGN   7303>>CALLBLT  7348<<ASSIGN   7388--ASSIGN
VLP_CGTYPL.LIST.NUMWRITES#
      6900**DCL      7390--ASSIGN
VLP_CGTYPL.LIST.ONEREPORT#
      6899**DCL      7402>>ASSIGN
VLP_CGTYPL.LIST.PRIO#
      6898**DCL      7392--ASSIGN
VLP_CGTYPL_SEL
      6922**DCL      7300--ASSIGN   7374>>ASSIGN
VLP_CGTYPL_SEL.FOUND#
      6922**DCL      7292<<ASSIGN
VLP_CGTYPL_SEL.LIST.NAME#
      6922**DCL      7298<<ASSIGN
X$FORMAT
      5704**DCL-ENT  7244--CALL     7403--CALL     7504--CALL
