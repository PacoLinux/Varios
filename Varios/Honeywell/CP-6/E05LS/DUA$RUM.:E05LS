VERSION E05

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:1    
        1        1        /*M* DUA$RUM - RUM DO routines for User DELTA */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DUA$RUM
       10       10             PURPOSE: This module contains various DO routines that perform
       11       11                      the outermost level of RUM functions.
       12       12             DESCRIPTION: This module contains the routines to perform the RUM
       13       13                          functions of showing which RU is being RUMed, setting
       14       14                          up the specified RU for RUMing, removing the current
       15       15                          RU from RUM mode, listing the modifications made to
       16       16                          the current RU, and deleteing the records that contain
       17       17                          a record of the modifications to the current RU being
       18       18                          RUMed. */
       19       19        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:2    
       20       20        /*F* NAME: DUA$RUM
       21       21             PURPOSE: To establish RUM mode for the specified FID.
       22       22             DESCRIPTION: If RUM mode is active, then it is implicitly killed.
       23       23                          If necessary, the RUM dcb is obtained. Memory for the
       24       24                          RU head record and read-only-segment is obtained. The
       25       25                          read-only-segment is built to look just like the one
       26       26                          STEP builds. */
       27       27        /*D* NAME: DUA$RUM
       28       28             ENTRY: DUA$RUM
       29       29             CALL: CALL DUA$RUM;
       30       30             INTERFACE: DDE$ERROR
       31       31                        DDM$GETMEM
       32       32                        DDM$PUTMEM
       33       33                        DDQ$READLM
       34       34                        DDQ$WRITE
       35       35                        DDR$BINTXT
       36       36                        DDR$REPORT
       37       37                        DDS$ES_INQ
       38       38                        DDS$SET_Q2C
       39       39                        DUE$ERRMSG
       40       40                        DUI$RU_ACCESS
       41       41             SCRATCH: Local AUTO only.
       42       42             DESCRIPTION: If RUM mode is active, then it is implicitly killed.
       43       43                          If necessary, the RUM dcb is obtained. Memory for the
       44       44                          RU head record and read-only-segment is obtained. The
       45       45                          read-only-segment is built to look just like the one
       46       46                          STEP builds. The UTS is obtained for time-stamping
       47       47                          any RUM modification record's keys. The current read-
       48       48                          only-segment is set to the one just built. The root
       49       49                          node in the overlay tree table is set as in memory. */
       50       50                                                /**/
       51       51        DUA$RUM: PROC;
       52       52                                                /**/
       53       53        %INCLUDE CP_6;
       54      134        %INCLUDE G_LCP6_E;
       55      392        %INCLUDE GM_VIRTUAL_E;
       56      602        %INCLUDE B$OBJECT_C;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:3    
       57     4032        %INCLUDE DD$BASED;
       58     5335        /* Auto */
       59     5336    1   DCL RECBUF CHAR(256);
       60     5337    1   DCL 1 KEYBUF,
       61     5338    1         2 * CHAR(256);
       62     5339    1   DCL LASTNODE UBIN;
       63     5340    1   DCL LASTUTS UBIN;
       64     5341    1   DCL INX UBIN;
       65     5342    1   DCL SIZE UBIN;
       66     5343    1   DCL BUF$ PTR;
       67     5344    1   DCL DCB$ PTR;
       68     5345    1   DCL DELETE_FLAG BIT(1) ALIGNED;
       69     5346    1   DCL ROSIZE UBIN;
       70     5347    1   DCL NEED UBIN;
       71     5348    1   DCL TOGET SBIN;
       72     5349    1   DCL TEMP$ PTR;
       73     5350    1   DCL TEMP1$ PTR;
       74     5351    1   DCL IX UBIN;
       75     5352    1   DCL DCBPTR$ PTR;
       76     5353    1   DCL NONE UBIN;
       77     5354    1   DCL ARS SBIN;
       78     5355    1   DCL PAGE UBIN;
       79     5356    1   DCL WARNINPUT BIT(1) ALIGNED;
       80     5357    1   DCL DCBRES UBIN;
       81     5358    1   DCL USED UBIN;
       82     5359    1   DCL CODE UBIN;
       83     5360    1   DCL PBSIZEC SBIN;
       84     5361    1   DCL COPYDCB UBIN;
       85     5362    1   DCL NBUFS UBIN;
       86     5363    1   DCL PROGBUF$ PTR;
       87     5364        %B$RUMKEY (NAME=BRUMKEY,
       88     5365                   STCLASS=,
       89     5366                   KEYSIZINIT=,
       90     5367                   NOTHDINIT=,
       91     5368                   TYPEINIT=,
       92     5369                   UTSINIT=,
       93     5370                   SEQINIT=,
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:4    
       94     5371                   NODEINIT=);
       95     5387        %FPT_CLOSE (FPTN=FPTCLOSE,
       96     5388                    STCLASS=);
       97     5430        %FPT_DELREC (FPTN=FPTDELREC,
       98     5431                     STCLASS=);
       99     5450        %FPT_FID (FPTN=FPTFID,
      100     5451                  STCLASS=);
      101     5474        %FPT_GETDCB (FPTN=FPTGETDCB,
      102     5475                     STCLASS=);
      103     5490        %FPT_OPEN (FPTN=FPTOPEN,
      104     5491                   STCLASS=);
      105     5600        %FPT_READ (FPTN=FPTREAD,
      106     5601                   STCLASS=);
      107     5640        %FPT_RELDCB (FPTN=FPTRELDCB,
      108     5641                     STCLASS=);
      109     5655        %FPT_TIME (FPTN=FPTTIME,
      110     5656                   STCLASS=);
      111     5675        %FPT_UNFID (FPTN=FPTUNFID,
      112     5676                    STCLASS=);
      113     5694        %FPT_WRITE (FPTN=FPTWRITE,
      114     5695                    STCLASS=);
      115     5726        %VLP_NAME (FPTN=VLPFID_NAME,
      116     5727                   STCLASS=,
      117     5728                   LEN=64);
      118     5755        %VLP_ACCT (FPTN=VLPFID_ACCT,
      119     5756                   STCLASS=);
      120     5769        %VLP_PASS (FPTN=VLPFID_PASS,
      121     5770                   STCLASS=);
      122     5783        %VLP_WSN (FPTN=VLPFID_WSN,
      123     5784                  STCLASS=);
      124     5797        %VLP_SN (FPTN=VLPFID_SN,
      125     5798                 STCLASS=,
      126     5799                 N=1);
      127     5812        %VLR_FID (FPTN=VLRFID,
      128     5813                  STCLASS=);
      129     5832        /* Based */
      130     5833    1   DCL 1 PAGE$BUF BASED ALIGNED,
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:5    
      131     5834    1         2 * CHAR( PBSIZEC );
      132     5835    1   DCL CHAR$5 CHAR(5) BASED UNAL;
      133     5836    1   DCL DCB$PTR$ PTR BASED ALIGNED;
      134     5837    1   DCL 1 PTR$WORD BASED ALIGNED,
      135     5838    1         2 LH UBIN HALF UNAL,
      136     5839    1         2 RH UBIN HALF UNAL,
      137     5840    1         2 RHB REDEF RH,
      138     5841    1           3 * BIT(1) UNAL,
      139     5842    1           3 UBYTE UBIN(8) UNAL,
      140     5843    1           3 * BIT(1) UNAL,
      141     5844    1           3 LBYTE UBIN(8) UNAL;
      142     5845    1   DCL 1 TEMP$WORD ALIGNED,
      143     5846    1         2 * UBIN(20) UNAL,
      144     5847    1         2 UBYTE UBIN(8) UNAL,
      145     5848    1         2 LBYTE UBIN(8) UNAL;
      146     5849    1   DCL TEMPWORD REDEF TEMP$WORD UBIN WORD ALIGNED;
      147     5850        %ACTIVE$CMD (NAME=LIST$CMD);
      148     5863        %TEXT$C;
      149     5868        %RUM$CMD;
      150     5892        %B$HEAD;
      151     6092        %RU_FLAVORS;
      152     6098        %B$RUBIRTH (STCLASS=BASED,
      153     6099                    COUNTINIT=);
      154     6108        %INCLUDE B$ROSEG;
      155     6171        %B$TCB;
      156     6174        %B$ALT;
      157     6182        %B$TREE_TABLE (HDR_NAME=B$TREEHDR,NODE_NAME="B$NODE(0:0)");
      158     6240    1   DCL 1 VLR$LOCAL BASED UNAL,
      159     6241    1         2 DATE CHAR(8) UNAL,
      160     6242    1         2 SPACE CHAR(1) UNAL,
      161     6243    1         2 TIME CHAR(11) UNAL;
      162     6244        %F$DCB;
      163     6301        /* Constant */
      164     6302        %B$RUMKEY (NAME=B_RUMKEY,
      165     6303                   STCLASS=CONSTANT);
      166     6319        %FPT_FID (FPTN=FPT_FID,
      167     6320                  STCLASS=CONSTANT SYMDEF);
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:6    
      168     6343        %FPT_GETDCB (FPTN=FPT_GETDCB,
      169     6344                     STCLASS=CONSTANT SYMDEF,
      170     6345                     MERGE=NO);
      171     6360        %FPT_READ (FPTN=FPT_READ,
      172     6361                   STCLASS=CONSTANT,
      173     6362                   KEYS=YES,
      174     6363                   KEYR=YES);
      175     6402        %FPT_DELREC (FPTN=FPT_DELREC,
      176     6403                     STCLASS=CONSTANT);
      177     6422        %FPT_OPEN (FPTN=FPT_OPEN,
      178     6423                   STCLASS=CONSTANT,
      179     6424                   FUN=UPDATE,
      180     6425                   REASSIGN=NO,
      181     6426                   SCRUB=YES);
      182     6535        %FPT_CLOSE (FPTN=FPT_CLOSE,
      183     6536                    STCLASS=CONSTANT SYMDEF,
      184     6537                    DISP=SAVE);
      185     6579        %FPT_RELDCB (FPTN=FPT_RELDCB,
      186     6580                     STCLASS=CONSTANT SYMDEF);
      187     6594        %FPT_TIME (FPTN=FPT_LOCTIME,
      188     6595                   STCLASS=CONSTANT,
      189     6596                   SOURCE=LOCAL,
      190     6597                   DEST=UTS);
      191     6616        %FPT_TIME (FPTN=FPT_UNTIME,
      192     6617                   STCLASS=CONSTANT,
      193     6618                   SOURCE=UTS,
      194     6619                   DEST=LOCAL);
      195     6638        %FPT_TIME (FPTN=FPT_TIME,
      196     6639                   STCLASS=CONSTANT,
      197     6640                   SOURCE=CLOCK,
      198     6641                   DEST=UTS);
      199     6660        %FPT_WRITE (FPTN=FPT_WRITE,
      200     6661                    STCLASS=CONSTANT);
      201     6692        %FPT_UNFID (FPTN=FPT_UNFID,
      202     6693                    STCLASS=CONSTANT);
      203     6711        %VLP_SN (FPTN=VLP_FID_SN,
      204     6712                 STCLASS=CONSTANT SYMDEF);
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:7    
      205     6725        /* Symref */
      206     6726    1   DCL B$TCB$ PTR SYMREF;
      207     6727    1   DCL B$ROS$ PTR SYMREF;
      208     6728    1   DCL D_M$DO# UBIN SYMREF;
      209     6729    1   DCL D_M$LM# UBIN SYMREF;
      210     6730    1   DCL DD_RUMNODE$ PTR SYMREF;
      211     6731        %FPT_EOM (FPTN=FPT_EOM,STCLASS=SYMREF);
      212     6761        /* DELTA static data */
      213     6762        %INCLUDE XUH_MACRO_C;
      214     6846        %INCLUDE DD_SD_M;
      215     8182        %S_D;
      216     9500        %S_D_PTRS;
      217     9537        /* Entry */
      218     9538    1   DCL DDA$TRACEON ENTRY(0);
      219     9539    1   DCL DDA$RESET_PATCH_SPACE ENTRY;
      220     9540    1   DCL DDB$BREAK ENTRY(0) ALTRET;
      221     9541    1   DCL DDE$ERROR ENTRY(0);
      222     9542    1   DCL DDM$GETMEM ENTRY(3) ALTRET;
      223     9543    1   DCL DDM$PUTMEM ENTRY(3) ALTRET;
      224     9544    1   DCL DDQ$READLM ENTRY(7) ALTRET;
      225     9545    1   DCL DDQ$WRITE ENTRY(2);
      226     9546    1   DCL DDQ$WRITED ENTRY(2);
      227     9547    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
      228     9548    1   DCL DDR$BINTXT ENTRY(4);
      229     9549    1   DCL DDR$REPORT ENTRY(1);
      230     9550    1   DCL DDS$ES_INQ ENTRY(1) ALTRET;
      231     9551    1   DCL DDS$SET_Q2C ENTRY(0) ALTRET;
      232     9552    1   DCL DDT$TRACEOFF ENTRY(0);
      233     9553    1   DCL DUA$EXITDELTA ENTRY(0);
      234     9554    1   DCL DUA$KILL_ANLZ ENTRY(0) ALTRET;
      235     9555    1   DCL DUE$ERRMSG ENTRY(0);
      236     9556    1   DCL DUI$INIT_HOST ENTRY;
      237     9557    1   DCL DUI$INIT_L6 ENTRY;
      238     9558    1   DCL DUI$RU_ACCESS ENTRY(0) ALTRET;
      239     9559    1   DCL DUU$TRUNC ENTRY(0) ALTRET;
      240     9560                                                /**/
      241     9561        /* Misc */
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:8    
      242     9562        %B$RECORDSUBS;
      243     9590        %INCLUDE CP_6_SUBS;
      244    10130        %INCLUDE DD_ERR_C;
      245    10527        %INCLUDE DD_PSUBS_C;
      246    11002        %INCLUDE DD_SUBS_C;
      247    11273        %INCLUDE F_ERRORS_C;
      248    11513        %INCLUDE DD$DITEM;
       12+   11616             %LIST;
       13+   11617    1        DCL SDD$ PTR;
       14+   11618    1        DCL ZITEM$ PTR;
       15+   11619    1        DCL SDD_L6$ PTR;
       16+   11620    1        DCL ZITEM_L6$ PTR;
      249    12194        %SUB @PAGE=0 /*@PAGE*/;
      250    12195        %SUB @NODE=0 /*@NODE*/;
      251    12196        %SUB @PSIZ=1024 /*@PSIZ*/;
      252    12197                                                /**/
      253    12198        /* Cleanup current RU access */
      254    12199    1        IF S_D.ANLZ
      255    12200    1        THEN CALL DUA$KILL_ANLZ;           /* Ignore altret */
      256    12201    1        IF S_D.TR$INFO.ACTIVE
      257    12202    2        THEN DO;
      258    12203    2             S_D.TRACE_STATE = '1'B;
      259    12204    2             CALL DDT$TRACEOFF;
      260    12205    2           END;
      261    12206    1        ELSE S_D.TRACE_STATE = '0'B;
      262    12207    1        CALL KILL_RUM ALTRET( REPORT_XXX );
      263    12208        /* Open RU */
      264    12209    1        FPTFID = FPT_FID;
      265    12210    1        FPTOPEN = FPT_OPEN;
      266    12211    1        FPTFID.V_ = VECTOR( FPTFID.V );
      267    12212    1        FPTFID.TEXTFID_ = VECTOR( ADDR( S_D.DO$ -> RUM$CMD.FID ) -> TEXT$C.TXT );
      268    12213    1        FPTFID.NAME_ = VECTOR( VLPFID_NAME );
      269    12214    1        FPTFID.ACCT_ = VECTOR( VLPFID_ACCT );
      270    12215    1        FPTFID.PASS_ = VECTOR( VLPFID_PASS );
      271    12216    1        VLPFID_SN = VLP_FID_SN;
      272    12217    1        FPTFID.SN_ = VECTOR( VLPFID_SN );
      273    12218    1        FPTFID.WSN_ = VECTOR( VLPFID_WSN );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:9    
      274    12219    1        FPTFID.ASN_ = VECTOR( FPTOPEN.V.ASN# );
      275    12220    1        FPTFID.RES_ = VECTOR( FPTOPEN.V.RES# );
      276    12221    1        FPTFID.RESULTS_ = VECTOR( VLRFID );
      277    12222    1        CALL M$FID( FPTFID ) ALTRET( ARETF );
      278    12223    1        IF NOT VLRFID.NAME
      279    12224    1        THEN GOTO NONAME;
      280    12225    1        FPTOPEN.V_ = VECTOR( FPTOPEN.V );
      281    12226    1        FPTOPEN.SN_ = VECTOR( VLPFID_SN );
      282    12227    1        FPTOPEN.NAME_ = VECTOR( VLPFID_NAME );
      283    12228    1        FPTOPEN.PASS_ = VECTOR( VLPFID_PASS );
      284    12229    1        FPTOPEN.ACCT_ = VECTOR( VLPFID_ACCT );
      285    12230    1        FPTOPEN.WSN_ = VECTOR( VLPFID_WSN );
      286    12231        /* We may need a dcb */
      287    12232    1        S_D.LMDCB_SAVE = S_D.LMDCB;
      288    12233    1        IF S_D.RUMDCB = 0
      289    12234    2        THEN DO;
      290    12235    2             FPTGETDCB = FPT_GETDCB;
      291    12236    2             FPTGETDCB.V_ = VECTOR( FPTGETDCB.V );
      292    12237    2             FPTGETDCB.DCBNUM_ = VECTOR( S_D.LMDCB );
      293    12238    2             CALL M$GETDCB( FPTGETDCB ) ALTRET( ARETG );
      294    12239    2             S_D.RUMDCB = S_D.LMDCB;
      295    12240    2           END;
      296    12241    1        ELSE S_D.LMDCB = S_D.RUMDCB;
      297    12242    1        FPTOPEN.V.DCB# = S_D.LMDCB;
      298    12243        /* We are now in RUM mode */
      299    12244    1        S_D.SAVEIC_SAVE = S_D.SAVEIC;
      300    12245    1        S_D.EXEC_DOMAIN_SAVE = S_D.ONE_TO_TWO.EXEC_DOMAIN;
      301    12246    1        S_D.RUM = '1'B;
      302    12247        /* Get some memory */
      303    12248    1        CALL DDM$GETMEM( DD_RUMNODE$, 1024 /*@PSIZ*/ ) ALTRET( NOMEM1 );
      304    12249    1        S_D.NODESEG_USED$ = PINCRW( DD_RUMNODE$, 1024 /*@PSIZ*/ );
      305    12250    1        CODE = S_D.DO$ -> RUM$CMD.CODE;
      306    12251    1        S_D.RUM_TEST = '0'B;
      307    12252    1        IF CODE ~= 0
      308    12253    2        THEN DO;                           /* Copy, Input, or Test specified */
      309    12254    2             FPTOPEN.V.FUN# = %IN#;
      310    12255    2             IF CODE = 82              /* C@COPY */
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:10   
      311    12256    3             THEN DO;
      312    12257    3                  PBSIZEC = 1024 /*@PSIZ*/ * LENGTHC( PBSIZEC );
      313    12258    3                  FPTOPEN.FPARAM_ = VECTOR( DD_RUMNODE$ -> PAGE$BUF );
      314    12259    3                END;
      315    12260    2             IF CODE = 98              /* C@TEST */
      316    12261    2             THEN S_D.RUM_TEST = '1'B;
      317    12262    2           END;
      318    12263    1        WARNINPUT = '0'B;
      319    12264    1        CALL M$OPEN( FPTOPEN ) ALTRET( NOOPN1 );
      320    12265    1        DCB$ = DCBADDR( S_D.RUMDCB );
      321    12266    1        IF FPTOPEN.V.FUN# = %UPDATE#
      322    12267    2        THEN DO;
      323    12268    2             IF ( NOT DCB$ -> F$DCB.FFLG.DELR# ) OR
      324    12269    2               ( NOT DCB$ -> F$DCB.FFLG.WNEW# ) OR
      325    12270    2               ( NOT DCB$ -> F$DCB.FFLG.UPD# )
      326    12271    2             THEN WARNINPUT = '1'B;
      327    12272    2           END;
      328    12273    1        IF SUBSTR(DCB$ -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'
      329    12274    1        THEN S_D.RUM_FEP = '1'B;
      330    12275    1        ELSE S_D.RUM_FEP = '0'B;
      331    12276    1   RUM1: ;
      332    12277        /* Must be a keyed file */
      333    12278    1        DCB$ = DCBADDR( S_D.RUMDCB );
      334    12279    1        IF ( DCB$ -> F$DCB.ORG# ~= %KEYED# ) OR ( DCB$ -> F$DCB.ASN# ~= %FILE# )
      335    12280    1        THEN GOTO NORU1;
      336    12281        /* Check for Copy mode */
      337    12282    1        IF CODE = 82                   /* C@COPY */
      338    12283    2        THEN DO;
      339    12284    2             COPYDCB = 0;
      340    12285    2             FPTGETDCB = FPT_GETDCB;
      341    12286    2             FPTGETDCB.V_ = VECTOR( FPTGETDCB.V );
      342    12287    2             FPTGETDCB.DCBNUM_ = VECTOR( COPYDCB );
      343    12288    2             CALL M$GETDCB( FPTGETDCB ) ALTRET( ARETGC );
      344    12289    2             FPTOPEN.V.DCB# = COPYDCB;
      345    12290    2             FPTOPEN.IFPARAM_ = FPTOPEN.FPARAM_;
      346    12291    2             FPTOPEN.FPARAM_ = VECTOR( NIL );
      347    12292    2             FPTOPEN.V.FUN# = %CREATE#;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:11   
      348    12293    2             FPTOPEN.V.EXIST# = %NEWFILE#;
      349    12294    2             FPTOPEN.V.ACS# = %DIRECT#;
      350    12295    2             CALL M$OPEN( FPTOPEN ) ALTRET( ARETOC );
      351    12296    2             FPTREAD = FPT_READ;
      352    12297    2             FPTREAD.V_ = VECTOR( FPTREAD.V );
      353    12298    2             FPTREAD.KEY_ = VECTOR( KEYBUF );
      354    12299    2             FPTREAD.BUF_ = VECTOR( DD_RUMNODE$ -> PAGE$BUF );
      355    12300    2             FPTREAD.V.DCB# = S_D.RUMDCB;
      356    12301    2             FPTREAD.V.KEYS# = %NO#;
      357    12302    2             FPTWRITE = FPT_WRITE;
      358    12303    2             FPTWRITE.V_ = VECTOR( FPTWRITE.V );
      359    12304    2             FPTWRITE.KEY_ = FPTREAD.KEY_;
      360    12305    2             FPTWRITE.V.DCB# = COPYDCB;
      361    12306    2             S_D.OUTPUT = '..Copying (BREAK to abort)';
      362    12307    2             BUF$ = ADDR( S_D.OUTPUT );
      363    12308    2             SIZE = LENGTHC( '..Copying (BREAK to abort)' );
      364    12309    2             CALL DDQ$WRITE( BUF$, SIZE );
      365    12310    3             DO WHILE ( '1'B );
      366    12311    3                  CALL DDB$BREAK ALTRET( COPY_BREAK );
      367    12312    3                  CALL M$READ( FPTREAD ) ALTRET( ARETRC );
      368    12313    3                  FPTREAD.V.DVBYTE.CONT# = %NO#;
      369    12314    3                  FPTWRITE.V.DVBYTE.CONT# = %NO#;
      370    12315    4                  DO WHILE ( '0'B );
      371    12316    4   ARETRC:             CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE;
      372    12317    4                       IF CODE = %E$LD
      373    12318    5                       THEN DO;
      374    12319    5                            FPTREAD.V.DVBYTE.CONT# = %YES#;
      375    12320    5                            FPTWRITE.V.DVBYTE.CONT# = %YES#;
      376    12321    5                          END;
      377    12322    4                       ELSE IF CODE = %E$EOF
      378    12323    4                            THEN GOTO COPY_CLOSE;
      379    12324    4                            ELSE GOTO COPY_ERROR;
      380    12325    4                     END;
      381    12326    3                  PBSIZEC = DCB$ -> F$DCB.ARS#;
      382    12327    3                  IF PBSIZEC <= 0
      383    12328    3                  THEN FPTWRITE.BUF_ = VECTOR( NIL );
      384    12329    3                  ELSE FPTWRITE.BUF_ = VECTOR( DD_RUMNODE$ -> PAGE$BUF );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:12   
      385    12330    3                  CALL M$WRITE( FPTWRITE ) ALTRET( COPY_ERROR );
      386    12331    3                END;
      387    12332    2   COPY_CLOSE: ;
      388    12333    2             FPTCLOSE = FPT_CLOSE;
      389    12334    2             FPTCLOSE.V_ = VECTOR( FPTCLOSE.V );
      390    12335    2             FPTCLOSE.V.DCB# = S_D.RUMDCB;
      391    12336    2             CALL M$CLOSE( FPTCLOSE ) ALTRET( ARETCC );
      392    12337    3             DO WHILE( '0'B );
      393    12338    3   ARETCC:        CALL DUE$ERRMSG;
      394    12339    3                END;
      395    12340    2             FPTRELDCB = FPT_RELDCB;
      396    12341    2             FPTRELDCB.V_ = VECTOR( FPTRELDCB.V );
      397    12342    2             FPTRELDCB.V.DCB# = S_D.RUMDCB;
      398    12343    2             CALL M$RELDCB( FPTRELDCB ) ALTRET( ARETRERC );
      399    12344    3             DO WHILE ( '0'B );
      400    12345    3   ARETRERC:      CALL DUE$ERRMSG;
      401    12346    3                END;
      402    12347    2             S_D.RUMDCB = COPYDCB;
      403    12348    2             S_D.LMDCB = COPYDCB;
      404    12349    2             DCB$ = DCBADDR( COPYDCB );
      405    12350    2           END;
      406    12351    1   RUM2: ;
      407    12352        /* Do a little bookkeeping */
      408    12353    1        S_D.RUM_BIRTH$ = DD_RUMNODE$;
      409    12354    1        S_D.RUM_HEAD$ = PINCRW( S_D.RUM_BIRTH$, SIZEW( B$RUBIRTH ) );
      410    12355    1        USED = SIZEW( B$RUBIRTH ) + SIZEW( B$HEAD );
      411    12356        /* Read head record */
      412    12357    1        ARS = 0;                           /* Positive */
      413    12358    1        CALL DDQ$READLM( %TYPHEAD, 0 /*@PAGE*/, 0 /*@NODE*/, S_D.RUM_HEAD$, SIZEC(
             12358                 B$HEAD ), ARS ) ALTRET( NOHEAD );
      414    12359    1        IF ARS ~= SIZEC(B$HEAD)
      415    12360    1        THEN GOTO NOHEAD;
      416    12361    2        DO CASE( S_D.RUM_HEAD$ -> B$HEAD.FLAVOR );
      417    12362    2          CASE( %HOST_RU );
      418    12363    2             CALL DUI$INIT_HOST;
      419    12364    2          CASE( %FEP_RU );
      420    12365    2             CALL DUI$INIT_L6;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:13   
      421    12366    2          CASE( ELSE );
      422    12367    2             S_D.ERROR = 273;  /* E@BADHEADRECORD */
      423    12368    2             GOTO KILL_IT;
      424    12369    2          END;
      425    12370        /* Read BIRTH record into memory */
      426    12371    1        ARS = 0;                           /* Positive */
      427    12372    1        CALL DDQ$READLM( %TYPBIRTH, 0 /*@PAGE*/, 0 /*@NODE*/, S_D.RUM_BIRTH$, SIZEC(
             12372                 B$RUBIRTH ), ARS ) ALTRET( NOBIRTH );
      428    12373    2        DO WHILE ( '0'B );
      429    12374    2   NOBIRTH:  S_D.RUM_BIRTH$ = ADDR( NIL );
      430    12375    2             S_D.ERROR = 193;       /* E@NORBIRTH */
      431    12376    2             CALL DDE$ERROR;
      432    12377    2           END;
      433    12378        /* Insure that UTS is ok */
      434    12379    1        IF S_D.DO$ -> RUM$CMD.GOTUTS
      435    12380    2        THEN DO;                           /* Must have valid UTS */
      436    12381    2             IF S_D.RUM_BIRTH$ = ADDR( NIL )
      437    12382    2             THEN GOTO UTSERR;
      438    12383    3             ELSE DO;
      439    12384    3                  FPTTIME = FPT_LOCTIME;
      440    12385    3                  FPTTIME.V_ = VECTOR( FPTTIME.V );
      441    12386    3                  FPTTIME.DATE_ = VECTOR( S_D.DO$ -> RUM$CMD.LUTS.DATE );
      442    12387    3                  FPTTIME.TIME_ = VECTOR( S_D.DO$ -> RUM$CMD.LUTS.TIME );
      443    12388    3                  FPTTIME.TSTAMP_ = VECTOR( LASTUTS );
      444    12389    3                  CALL M$TIME( FPTTIME ) ALTRET( UTSERRE );
      445    12390    3                  IF S_D.RUM_BIRTH$ -> B$RUBIRTH.CREATE_UTS ~= LASTUTS
      446    12391    3                  THEN GOTO UTSERR;
      447    12392    3                END;
      448    12393    2           END;
      449    12394    1        ELSE IF S_D.DO$ -> RUM$CMD.NUTS
      450    12395    2             THEN DO;                      /* Nothing */
      451    12396    2                END;
      452    12397    1             ELSE IF DCB$ -> F$DCB.ACCT# = ':SYS' AND
      453    12398    1                    ( DCB$ -> F$DCB.FUN# = %UPDATE# OR CODE = 82 ) /* C@COPY */
      454    12399    1                  THEN GOTO UTSERR;
      455    12400        /* Get memory for program records and read-only-segment */
      456    12401    1        S_D.RCBC.CUR_SEQ = 0;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:14   
      457    12402    1        IF S_D.DO$ -> RUM$CMD.BUFFERS = 0
      458    12403    1        THEN IF S_D.GHOST1
      459    12404    1             THEN NBUFS = 10;              /* Default if RUMing processors */
      460    12405    1             ELSE NBUFS = 5;               /* Default for vanilla users */
      461    12406    1        ELSE NBUFS = S_D.DO$ -> RUM$CMD.BUFFERS;
      462    12407    1        S_D.RCBC.BUFSM1 = NBUFS - 1;
      463    12408    1        S_D.RCBC.BUFSIZE = S_D.RUM_HEAD$ -> B$HEAD.PRECSIZE;
      464    12409    1        PROGBUF$ = PINCRW( S_D.RUM_HEAD$, SIZEW( B$HEAD ) );
      465    12410    2        DO IX = 0 TO S_D.RCBC.BUFSM1;
      466    12411    2             S_D.RCBC.BUF$( IX ) = PROGBUF$;
      467    12412    2             PROGBUF$ = PINCRW( PROGBUF$, S_D.RCBC.BUFSIZE );
      468    12413    2             S_D.RCBC.PAGE( IX ) = -1;
      469    12414    2             S_D.RCBC.SIZE( IX ) = -1;
      470    12415    2             S_D.RCBC.SEQ( IX ) = 0;
      471    12416    2             S_D.RCBC.WRITTEN( IX ) = '0'B;
      472    12417    2             S_D.RCBC.NODE( IX ) = 0;
      473    12418    2           END;
      474    12419    1        ROSIZE = S_D.RUM_HEAD$ -> B$HEAD.ROSIZE;
      475    12420    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      476    12421    1        THEN NEED = S_D.RCBC.BUFSIZE * NBUFS /* Buffers for program records */
      477    12422    1               + SIZEW( B$ROSEG )          /* Read-only-segment header */
      478    12423    1               + %M$1STDCB#                /* Fixed dcb pointers */
      479    12424    1               + ROSIZE;                   /* Read-only-segment from RU */
      480    12425    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6
      481    12426    1             THEN NEED = S_D.RCBC.BUFSIZE * NBUFS /* Buffers for program records */
      482    12427    1                    + SIZEW( B$ROSEG )     /* Read-only-segment header */
      483    12428    1                    + %G_FRST_USR_DCB#     /* Fixed dcb pointers */
      484    12429    1                    + (ROSIZE / 2);        /* Read-only-segment from RU */
      485    12430    2             ELSE DO;
      486    12431    2                  S_D.ERROR = 502;    /* E@DELBUG */
      487    12432    2                  GOTO KILL_IT;
      488    12433    2                END;
      489    12434    1        TOGET = ( 1024 /*@PSIZ*/ - USED ) - NEED;   /* To get = left - need */
      490    12435    1        IF TOGET < 0
      491    12436    2        THEN DO;
      492    12437    2             TOGET = ( ( -TOGET + 1024 /*@PSIZ*/ -1 ) / 1024 /*@PSIZ*/ ) * 1024
             12437                      /*@PSIZ*/;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:15   
      493    12438    2             CALL DDM$GETMEM( DD_RUMNODE$, TOGET ) ALTRET( NOMEM2 );
      494    12439    2             S_D.NODESEG_USED$ = PINCRW( S_D.NODESEG_USED$, TOGET );
      495    12440    2           END;
      496    12441        /* Whew - got it */
      497    12442    1        S_D.NODESEG$ = PINCRW( S_D.RCBC.BUF$( 0 ), NEED );
      498    12443    1        IF ROSIZE = 0
      499    12444    2        THEN DO;
      500    12445    2             S_D.B$ROS$ = ADDR( NIL );
      501    12446    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      502    12447    2             THEN S_D.PADDR = ( S_D.RUM_HEAD$ -> B$HEAD.BIAS / 1024 /*@PSIZ*/ )
      503    12448    2                    + ( S_D.RUM_HEAD$ -> B$HEAD.VDPGS * 1024 /*@PSIZ*/ );
      504    12449    3             ELSE DO;
      505    12450    3                  IF S_D.RUM_HEAD$ -> B$HEAD.LIB
      506    12451    3                  THEN IF S_D.RUM_HEAD$ -> B$HEAD.VERSION# = 0
      507    12452    3                       THEN S_D.PADDR = %GM_ISR6_BASE;
      508    12453    3                       ELSE S_D.PADDR = %GM_LIBIS1_BASE;
      509    12454    3                  ELSE IF S_D.RUM_HEAD$ -> B$HEAD.RDATA = 0
      510    12455    3                       THEN S_D.PADDR = S_D.RUM_HEAD$ -> B$HEAD.BIAS;
      511    12456    3                       ELSE S_D.PADDR = (((S_D.RUM_HEAD$ -> B$HEAD.RDATA + BITBIN(
             12456                                '277777'O))
      512    12457    3                              / BITBIN('200000'O)) * BITBIN('200000'O)) + BITBIN(
             12457                                       '200000'O);
      513    12458    3                END;
      514    12459    2           END;
      515    12460    2        ELSE DO;
      516    12461    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST
      517    12462    3             THEN DO;
      518    12463                                                /* Build pointers to system dcbs */
      519    12464    3                  S_D.RUM_ROS$ = PROGBUF$;
      520    12465    3                  S_D.B$ROS$ = S_D.RUM_ROS$;
      521    12466    3                  DCBPTR$ = PINCRW( S_D.B$ROS$, SIZEW( B$ROSEG ) );
      522    12467    3                  S_D.B$ROS$ -> B$ROSEG.DCBPTR$ = DCBPTR$;
      523    12468    4                  DO IX = 1 TO %M$1STDCB#;
      524    12469    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );
      525    12470    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );
      526    12471    4                     END;
      527    12472                                      /* Read read-only-segment from RU into memory */
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:16   
      528    12473    3                  TOGET = ROSIZE * SIZEC( ROSIZE );
      529    12474    3                  PAGE = 0;
      530    12475    3                  ARS = 0;
      531    12476    3                  TEMP$ = DCBPTR$;
      532    12477    4                  DO WHILE ( TOGET > 0 );
      533    12478    4                       CALL DDQ$READLM( %TYPROS, PAGE, 0 /*@NODE*/, TEMP$, TOGET, ARS )
             12478                                ALTRET( NOROS );
      534    12479    4                       PAGE = PAGE + S_D.RCBC.BUFSIZE;
      535    12480    4                       TOGET = TOGET - ARS;
      536    12481    4                       TEMP$ = PINCRC( TEMP$, ARS );
      537    12482    4                     END;
      538    12483                                           /* Setup pointers to user defined dcbs */
      539    12484    3                  TOGET = S_D.RUM_HEAD$ -> B$HEAD.UDCBNUM;
      540    12485    3                  DCBRES = S_D.RUM_HEAD$ -> B$HEAD.DCBRES;
      541    12486    3                  S_D.B$ROS$ -> B$ROSEG.NUMDCBS = %M$1STDCB# - 1 + TOGET + DCBRES;
      542    12487    3                  TEMP$ = DCBPTR$;
      543    12488    4                  DO IX = 1 TO TOGET;
      544    12489    4                       DCBPTR$ -> DCB$PTR$ = PINCRW( TEMP$, DCBPTR$ -> PTR$WORD.LH );
      545    12490    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );
      546    12491    4                     END;
      547    12492    4                  DO IX = 1 TO DCBRES;
      548    12493    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );
      549    12494    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCBPTR$ ) );
      550    12495    4                     END;
      551    12496                                                /* Setup tree table pointers */
      552    12497    3                  TEMP$ = PINCRW( TEMP$, S_D.RUM_HEAD$ -> B$HEAD.TREEDISP );
      553    12498    3                  IF S_D.RUM_HEAD$ -> B$HEAD.OVRL
      554    12499    3                  THEN S_D.B$ROS$ -> B$ROSEG.TREE$ = TEMP$;
      555    12500    3                  ELSE S_D.B$ROS$ -> B$ROSEG.TREE$ = ADDR( NIL );
      556    12501    3                  TEMP1$ = PINCRW( TEMP$, SIZEW( B$TREEHDR ) );
      557    12502    3                  TEMP1$ -> B$NODE.FLGS.NOW_IN( 0 ) = '1'B; /* Root as in */
      558    12503    3                  S_D.PADDR = TEMP1$ -> B$NODE.PADDR( 0 );
      559    12504    4                  DO IX = 0 TO TEMP$ -> B$TREEHDR.NODES - 1;
      560    12505    4                       TEMP1$ -> B$NODE.NAME$( 0 ) = PINCRW( TEMP$, TEMP1$ -> PTR$WORD.
             12505                                LH );
      561    12506    4                       TEMP1$ = PINCRW( TEMP1$, SIZEW( B$NODE ) );
      562    12507    4                     END;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:17   
      563    12508    3                END;
      564    12509    3             ELSE DO;
      565    12510                                                /* Build pointers to system dcbs */
      566    12511    3                  S_D.RUM_ROS$ = PROGBUF$;
      567    12512    3                  S_D.B$ROS$ = S_D.RUM_ROS$;
      568    12513    3                  DCBPTR$ = PINCRW( S_D.B$ROS$, SIZEW( B$ROSEG ) );
      569    12514    3                  S_D.B$ROS$ -> B$ROSEG.DCBPTR$ = DCBPTR$;
      570    12515    4                  DO IX = 1 TO %G_FRST_USR_DCB#;
      571    12516    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );
      572    12517    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );
      573    12518    4                     END;
      574    12519                                      /* Read read-only-segment from RU into memory */
      575    12520    3                  TOGET = (ROSIZE * 2);
      576    12521    3                  PAGE = BITBIN('1000'X);
      577    12522    3                  ARS = 0;
      578    12523    3                  TEMP$ = DCBPTR$;
      579    12524    4                  DO WHILE ( TOGET > 0 );
      580    12525    4                       CALL DDQ$READLM( %TYPPROG, PAGE, 0 /*@NODE*/, TEMP$, TOGET, ARS
             12525                                ) ALTRET( NOROS );
      581    12526    4                       PAGE = PAGE + 2048;
      582    12527    4                       TOGET = TOGET - ARS;
      583    12528    4                       TEMP$ = PINCRC( TEMP$, ARS );
      584    12529    4                     END;
      585    12530                                           /* Setup pointers to user defined dcbs */
      586    12531    3                  TOGET = S_D.RUM_HEAD$ -> B$HEAD.UDCBNUM;
      587    12532    3                  DCBRES = S_D.RUM_HEAD$ -> B$HEAD.DCBRES;
      588    12533    3                  S_D.B$ROS$ -> B$ROSEG.NUMDCBS = %G_FRST_USR_DCB# - 1 + TOGET + DCBRES
             12533                           ;
      589    12534    3                  TEMP$ = DCBPTR$;
      590    12535    4                  DO IX = 1 TO TOGET;
      591    12536    4                       TEMPWORD = 0;
      592    12537    4                       TEMP$WORD.UBYTE = DCBPTR$ -> PTR$WORD.RHB.UBYTE;
      593    12538    4                       TEMP$WORD.LBYTE = DCBPTR$ -> PTR$WORD.RHB.LBYTE;
      594    12539    4                       DCBPTR$ -> DCB$PTR$ = PINCRC( TEMP$, (TEMPWORD - BITBIN('1000'X)
             12539                                ) * 2 );
      595    12540    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );
      596    12541    4                     END;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:18   
      597    12542    4                  DO IX = 1 TO DCBRES;
      598    12543    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );
      599    12544    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCBPTR$ ) );
      600    12545    4                     END;
      601    12546                                                /* Setup tree table pointers */
      602    12547    3                  TEMP$ = PINCRW( TEMP$, S_D.RUM_HEAD$ -> B$HEAD.TREEDISP );
      603    12548    3                  IF S_D.RUM_HEAD$ -> B$HEAD.OVRL
      604    12549    3                  THEN S_D.B$ROS$ -> B$ROSEG.TREE$ = TEMP$;
      605    12550    3                  ELSE S_D.B$ROS$ -> B$ROSEG.TREE$ = ADDR( NIL );
      606    12551    3                  S_D.PADDR = (((S_D.RUM_HEAD$ -> B$HEAD.RDATA + BITBIN('277777'O))
      607    12552    3                    / BITBIN('200000'O)) * BITBIN('200000'O)) + BITBIN('200000'O);
      608    12553    3                END;
      609    12554    2           END;                            /* Done building read-only-segment */
      610    12555    1        CALL DDA$RESET_PATCH_SPACE;
      611    12556    1        S_D.FIRST_TIME = '1'B;
      612    12557    1        CALL DUI$RU_ACCESS ALTRET(KILL_IT);
      613    12558    1        S_D.SAVEIC = S_D.RUM_HEAD$ -> B$HEAD.START;
      614    12559    1        CALL DDS$ES_INQ( S_D.SAVEIC ) ALTRET( RUM0 );
      615    12560    1        CALL DDS$SET_Q2C;
      616    12561    1   RUM0: ;
      617    12562    1        S_D.RUMSEQ = 0;
      618    12563    1        FPTTIME = FPT_TIME;
      619    12564    1        FPTTIME.V_ = VECTOR( FPTTIME.V );
      620    12565    1        FPTTIME.TSTAMP_ = VECTOR( S_D.RUMUTS );
      621    12566    1        CALL M$TIME( FPTTIME ) ALTRET( NOTIME );
      622    12567    1        CALL DDR$REPORT( 18/*R_RUM*/ );
      623    12568    1        IF WARNINPUT
      624    12569    2        THEN DO;
      625    12570    2             S_D.ERROR = 127;        /* E@NOPNUPD */
      626    12571    2             CALL DDE$ERROR;
      627    12572    2           END;
      628    12573    1        S_D.RUM_ONLY = '0'B;
      629    12574    1        S_D.RUM_SKIP = '0'B;
      630    12575                                                /**/
      631    12576    1        IF S_D.STAND_ALONE AND
      632    12577    1          NOT S_D.EOM AND
      633    12578    1          NOT S_D.BATCH
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:19   
      634    12579    2        THEN DO;
      635    12580    2             CALL M$EOM (FPT_EOM) ALTRET(NOEOM);
      636    12581    2             S_D.EOM = '1'B;
      637    12582    3             DO WHILE ( '0'B );
      638    12583    3   NOEOM:
      639    12584    3                  IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0
      640    12585    3                  THEN GOTO KILL_ETI;
      641    12586    3                END;
      642    12587    2           END;
      643    12588    1        RETURN;
      644    12589                                                /**/
      645    12590        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:20   
      646    12591                                                /**/
      647    12592    1   NOOPN1: ;
      648    12593    1        IF ( FPTOPEN.V.FUN# = %UPDATE# ) AND
      649    12594    1          ( B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$FILEBUSY )
      650    12595    2        THEN DO;
      651    12596    2             FPTOPEN.V.FUN# = %IN#;
      652    12597    2             CALL M$OPEN( FPTOPEN ) ALTRET( KILL_ETI );
      653    12598    2             WARNINPUT = '1'B;
      654    12599    2             GOTO RUM1;
      655    12600    2           END;
      656    12601    1        ELSE GOTO KILL_ETI;
      657    12602                                                /**/
      658    12603    1   COPY_ERROR: ;
      659    12604    1        CALL DUE$ERRMSG;
      660    12605    1   COPY_BREAK: ;
      661    12606    1        FPTCLOSE = FPT_CLOSE;
      662    12607    1        FPTCLOSE.V_ = VECTOR( FPTCLOSE.V );
      663    12608    1        FPTCLOSE.V.DCB# = COPYDCB;
      664    12609    1        FPTCLOSE.V.DISP# = %RELEASE#;
      665    12610    1        CALL M$CLOSE( FPTCLOSE ) ALTRET( ARETCCE );
      666    12611    2        DO WHILE( '0'B );
      667    12612    2   ARETOC:   ;
      668    12613    2   ARETCCE:  ;
      669    12614    2             CALL DUE$ERRMSG;
      670    12615    2           END;
      671    12616    1        FPTRELDCB = FPT_RELDCB;
      672    12617    1        FPTRELDCB.V_ = VECTOR( FPTRELDCB.V );
      673    12618    1        FPTRELDCB.V.DCB# = COPYDCB;
      674    12619    1        CALL M$RELDCB( FPTRELDCB ) ALTRET( ARETRECE );
      675    12620    2        DO WHILE ( '0'B );
      676    12621    2   ARETGC:   ;
      677    12622    2   ARETRECE: ;
      678    12623    2             CALL DUE$ERRMSG;
      679    12624    2           END;
      680    12625    1        WARNINPUT = '1'B;
      681    12626    1        GOTO RUM2;
      682    12627                                                /**/
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:21   
      683    12628    1   NORELRUM: ;
      684    12629    1        S_D.ERROR = 515;              /* E@RELRUM */
      685    12630    1        GOTO REPORT_XXXE;
      686    12631    1   NORU1: ;
      687    12632    1   NOHEAD: ;
      688    12633    1        S_D.ERROR = 128;             /* E@IGLRFID */
      689    12634    1        GOTO KILL_IT;
      690    12635    1   NOMEM1: ;
      691    12636    1   NOMEM2: ;
      692    12637    1        S_D.ERROR = 129;               /* E@NOMEM */
      693    12638    1        GOTO KILL_IT;
      694    12639    1   NOROS: ;
      695    12640    1        S_D.ERROR = 519;               /* E@ACROS */
      696    12641    1        GOTO KILL_IT;
      697    12642    1   NONAME: ;
      698    12643    1        S_D.ERROR = 126;              /* E@NONAME */
      699    12644    1        GOTO KILL_IT;
      700    12645    1   NOTIME: ;
      701    12646    1        S_D.ERROR = 520;              /* E@NOTIME */
      702    12647    1        GOTO KILL_ITE;
      703    12648    1   UTSERRE: ;
      704    12649    1        CALL DUE$ERRMSG;
      705    12650    1   UTSERR: ;
      706    12651    1        S_D.ERROR = 205;              /* E@UTSERR */
      707    12652    1        GOTO KILL_IT;
      708    12653                                                /**/
      709    12654    1   REPORT_XXXE: ;
      710    12655    1        CALL DUE$ERRMSG;
      711    12656    1   REPORT_XXX: ;
      712    12657    1        CALL DDE$ERROR;
      713    12658    1        CALL M$XXX;
      714    12659                                                /**/
      715    12660    1   KILL_ITE: ;
      716    12661    1        CALL DUE$ERRMSG;
      717    12662    1   KILL_IT: ;
      718    12663    1        CALL DDE$ERROR;
      719    12664    1        GOTO KILL_IT1;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:22   
      720    12665    1   KILL_ETI: ;
      721    12666    1        CALL DUE$ERRMSG;
      722    12667    1        GOTO KILL_IT1;
      723    12668                                                /**/
      724    12669        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:23   
      725    12670        /*F* NAME: DUA$KILL_RUM
      726    12671             PURPOSE: To KILL the currently active RUM mode.
      727    12672             DESCRIPTION: RUM mode is reset, and DELTA mode is re-established. */
      728    12673        /*D* NAME: DUA$KILL_RUM
      729    12674             ENTRY: DUA$KILL_RUM
      730    12675             CALL: CALL DUA$KILL_RUM
      731    12676             SCRATCH: Local AUTO only.
      732    12677             DESCRIPTION: RUM mode is reset, and DELTA mode is re-established
      733    12678                          as follows. The RUM dcb is closed, and then released;
      734    12679                          the data segment (DD_RUMNODE$) that contains the program
      735    12680                          head record, read-only-segment, and overlay control
      736    12681                          tables is released; all memory in the static data segment
      737    12682                          (S_D_SEG$) beyond the initial static data area is released;
      738    12683                          and miscellaneous control information is updated. */
      739    12684                                                /**/
      740    12685    1   DUA$KILL_RUM: ENTRY;
      741    12686                                                /**/
      742    12687        /* Kill current RUM mode */
      743    12688    2        DO WHILE ( '0'B );
      744    12689    2   KILL_IT1: IF S_D.GHOST1 OR              /* GHOST1 is current user */
      745    12690    2               (S_D.RUM_COMMAND AND S_D.GHOST1)
             12690                        /* A RUM command was processed and GHOST1 */
      746    12691    2             THEN S_D.RUM_SKIP = '1'B;
      747    12692    2           END;
      748    12693    1        CALL KILL_RUM ALTRET( REPORT_XXX );
      749    12694    1        S_D.RUM = '0'B;
      750    12695    1        IF S_D.RUM_ONLY
      751    12696    1        THEN CALL DUA$EXITDELTA;
      752    12697        /* Release RUM dcb */
      753    12698    1        IF S_D.RUMDCB ~= 0
      754    12699    2        THEN DO;
      755    12700    2             FPTRELDCB = FPT_RELDCB;
      756    12701    2             FPTRELDCB.V_ = VECTOR( FPTRELDCB.V );
      757    12702    2             FPTRELDCB.V.DCB# = S_D.RUMDCB;
      758    12703    2             CALL M$RELDCB( FPTRELDCB ) ALTRET( NORELRUM );
      759    12704    2             S_D.RUMDCB = 0;
      760    12705    2           END;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:24   
      761    12706        /* Re-establish DELTA mode environment */
      762    12707    2        DO CASE(S_D.ONE_TO_TWO.EXEC_DOMAIN);
      763    12708    2          CASE(%HOST_RU);
      764    12709    2             CALL DUI$INIT_HOST;
      765    12710    2          CASE(%FEP_RU);
      766    12711    2             CALL DUI$INIT_L6;
      767    12712    2          CASE(ELSE);
      768    12713    2             S_D.ERROR = 502;         /* E@DELBUG */
      769    12714    2             GOTO REPORT_XXX;
      770    12715    2          END;
      771    12716    1        CALL DDA$RESET_PATCH_SPACE;
      772    12717    1        S_D.FIRST_TIME = '1'B;
      773    12718    1        CALL DUI$RU_ACCESS ALTRET(REPORT_XXX);
      774    12719    1        CALL DDS$ES_INQ( S_D.SAVEIC ) ALTRET( KRUM0 );
      775    12720    1        CALL DDS$SET_Q2C;
      776    12721    1   KRUM0: ;
      777    12722    1        IF S_D.DO$ ~= ADDR( NIL )
      778    12723    2        THEN DO;
      779    12724    2             ARS = S_D.DO$ -> RUM$CMD.CMD;
      780    12725    2             IF ( ARS ~= 59 ) AND ( ARS ~= 39 ) /* C_ANLZ, C_QUIT */
      781    12726    2             THEN CALL DDR$REPORT( 11/*R_DELTA*/ );
      782    12727    2           END;
      783    12728    1        IF S_D.TRACE_STATE
      784    12729    2        THEN DO;
      785    12730    2             S_D.TRACE_STATE = '0'B;
      786    12731    2             CALL DDA$TRACEON;
      787    12732    2           END;
      788    12733                                                /**/
      789    12734    1        RETURN;
      790    12735                                                /**/
      791    12736        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:25   
      792    12737                                                /**/
      793    12738    1   KILL_RUM: PROC ALTRET;
      794    12739                                                /**/
      795    12740    2   DCL TOBREL UBIN;
      796    12741    2   DCL DEFI SBIN;
      797    12742                                                /**/
      798    12743    2        IF S_D.RUM
      799    12744    2        THEN CALL DUU$TRUNC;               /* Ignore altret */
      800    12745    3        DO IX = 0 TO (SIZEW(S_D.RCBC.BUF$)/SIZEW(S_D.RCBC.BUF$(0)))-1;
      801    12746    3             S_D.RCBC.PAGE( IX ) = -1;
      802    12747    3             S_D.RCBC.SIZE( IX ) = -1;
      803    12748    3           END;
      804    12749    2        TOBREL = POFFW( S_D.SCHSEG$, S_D.SCHSEG_BEGIN$ );
      805    12750    2        IF TOBREL > 0
      806    12751    2        THEN CALL DDM$PUTMEM( S_D_SEG$, TOBREL ) ALTRET( NORELS_D );
      807    12752    2        S_D.SCHSEG$ = S_D.SCHSEG_BEGIN$;
      808    12753    2        TOBREL = POFFW( S_D.NODESEG_USED$, DD_RUMNODE$ );
      809    12754    2        IF TOBREL > 0
      810    12755    2        THEN CALL DDM$PUTMEM( DD_RUMNODE$, TOBREL ) ALTRET( NORELND );
      811    12756    2        IF S_D.RUM
      812    12757    3        THEN DO;
      813    12758                                      /* Write out number of errors during RUMming */
      814    12759    3             BUF$ = ADDR( S_D.OUTPUT );
      815    12760    3             S_D.OUTPUT = ' ';
      816    12761    3             CALL DDQ$WRITE( BUF$, 4 );
      817    12762    3             FPTUNFID = FPT_UNFID;
      818    12763    3             FPTUNFID.V_ = VECTOR(FPTUNFID.V);
      819    12764    3             FPTUNFID.V.DCB# = S_D.LMDCB;
      820    12765    3             IF S_D.RUM_ERRORS = 0
      821    12766    4             THEN DO;
      822    12767    4                  S_D.OUTPUT = '*** NO Errors encountered in file';
      823    12768    4                  FPTUNFID.TEXTFID_ = VECTOR(SUBSTR(S_D.OUTPUT,LENGTHC(
             12768                           '*** NO Errors encountered in file ')));
      824    12769    4                  CALL M$UNFID (FPTUNFID);
      825    12770    4                  CALL DDQ$WRITE( BUF$, 72 );
      826    12771    4                END;
      827    12772    4             ELSE DO;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:26   
      828    12773    4                  S_D.OUTPUT = '**** 00000 Errors encountered in file';
      829    12774    4                  CALL BINCHAR( SUBSTR( S_D.OUTPUT, 5, 5 ), S_D.RUM_ERRORS );
      830    12775    4                  FPTUNFID.TEXTFID_ = VECTOR(SUBSTR(S_D.OUTPUT,LENGTHC(
             12775                           '**** 00000 Errors encountered in file ')));
      831    12776    4                  CALL M$UNFID (FPTUNFID);
      832    12777    4                  CALL DDQ$WRITE( BUF$, 72 );
      833    12778    4                END;
      834    12779    3             S_D.OUTPUT = ' ';
      835    12780    3             CALL DDQ$WRITE( BUF$, 4 );
      836    12781    3             S_D.SAVEIC = S_D.SAVEIC_SAVE;
      837    12782    3             S_D.ONE_TO_TWO.EXEC_DOMAIN = S_D.EXEC_DOMAIN_SAVE;
      838    12783    3             S_D.LMDCB = S_D.LMDCB_SAVE;
      839    12784    3             IF DCBADDR( S_D.RUMDCB ) -> F$DCB.FCD#
      840    12785    4             THEN DO;
      841    12786    4                  FPTCLOSE = FPT_CLOSE;
      842    12787    4                  FPTCLOSE.V_ = VECTOR( FPTCLOSE.V );
      843    12788    4                  FPTCLOSE.V.DCB# = S_D.RUMDCB;
      844    12789    4                  CALL M$CLOSE( FPTCLOSE ) ALTRET( NOCLSRUM );
      845    12790    4                END;
      846    12791    3           END;
      847    12792    2        S_D.RUM_ERRORS = 0;
      848    12793    2        S_D.B$ROS$ = B$ROS$;
      849    12794    2        S_D.NODESEG$ = DD_RUMNODE$;
      850    12795    2        S_D.NODESEG_USED$ = DD_RUMNODE$;
      851    12796    2        IF S_D.GHOST1
      852    12797    3        THEN DO;
      853    12798    4             DO DEFI = 0 TO 24;
      854    12799    4                  S_D.UD.TEXTSZ(DEFI) = 0;
      855    12800    4                END;
      856    12801    3           END;
      857    12802                                                /**/
      858    12803    2        RETURN;
      859    12804                                                /**/
      860    12805    2   NORELS_D: ;
      861    12806    2        S_D.ERROR = 516;              /* E@RELS_D */
      862    12807    2        ALTRETURN;
      863    12808    2   NORELND: ;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:27   
      864    12809    2        S_D.ERROR = 517;               /* E@RELND */
      865    12810    2        ALTRETURN;
      866    12811    2   NOCLSRUM: ;
      867    12812    2        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$ACGRANS AND
      868    12813    2          S_D.RUM_ONLY
      869    12814    3        THEN DO;
      870    12815    3             CALL DUE$ERRMSG;
      871    12816    3             CALL DUA$EXITDELTA;
      872    12817    3           END;
      873    12818    2        ELSE CALL DUE$ERRMSG;
      874    12819    2        S_D.ERROR = 518;              /* E@CLSRUM */
      875    12820    2        ALTRETURN;
      876    12821                                                /**/
      877    12822    2   END KILL_RUM;
      878    12823                                                /**/
      879    12824        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:28   
      880    12825        /*F* NAME: DUA$DELETE
      881    12826             PURPOSE: To remove records of RUM modifications from RU.
      882    12827             DESCRIPTION: Positions to the beginning of RUM records with a keyed
      883    12828                          read. Reads and then deletes each record with a RUM
      884    12829                          key. RUM mode must be active. The actual code to read
      885    12830                          the RUM records is common with DUA$LIST. */
      886    12831        /*D* NAME: DUA$DELETE
      887    12832             ENTRY: DUA$DELETE
      888    12833             CALL: CALL DUA$DELETE;
      889    12834             OUTPUT: DELETE_FLAG - Set for DUA$LIST.
      890    12835             SCRATCH: Local AUTO only.
      891    12836             DESCRIPTION: Positions to the beginning of RUM records with a keyed
      892    12837                          read. Reads and then deletes each record with a RUM
      893    12838                          key. RUM mode must be active. The actual code to read
      894    12839                          the RUM records is common with DUA$LIST. */
      895    12840                                                /**/
      896    12841    1   DUA$DELETE: ENTRY;
      897    12842                                                /**/
      898    12843    1        DELETE_FLAG = '1'B;
      899    12844    1        FPTDELREC = FPT_DELREC;
      900    12845    1        FPTDELREC.V_ = VECTOR( FPTDELREC.V );
      901    12846    1        FPTDELREC.V.DCB# = S_D.LMDCB;
      902    12847    1        GOTO LIST_CODE;
      903    12848                                                /**/
      904    12849        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:29   
      905    12850        /*F* NAME: DUA$LIST
      906    12851             PURPOSE: To list the RUM modification records.
      907    12852             DESCRIPTION: All the modifications that have been made to the
      908    12853                          currently active RU by RUM are displayed. */
      909    12854        /*D* NAME: DUA$LIST
      910    12855             ENTRY: DUA$LIST
      911    12856             CALL: CALL DUA$LIST;
      912    12857             SCRATCH: Local AUTO only.
      913    12858             DESCRIPTION: All the modifications that have been made to the
      914    12859                          currently active RU by RUM are displayed. If the
      915    12860                          DELETE_FLAG is set, then the records are deleted, not
      916    12861                          listed. */
      917    12862                                                /**/
      918    12863    1   DUA$LIST: ENTRY;
      919    12864                                                /**/
      920    12865    1        DELETE_FLAG = '0'B;
      921    12866                                                /**/
      922    12867    1   LIST_CODE: ;
      923    12868    1        NONE = 0;
      924    12869    1        BUF$ = ADDR( S_D.OUTPUT );
      925    12870    1        DCB$ = DCBADDR( S_D.LMDCB );
      926    12871    1        IF S_D.ANLZ OR ( NOT S_D.RUM AND S_D.STAND_ALONE )
      927    12872    1        THEN GOTO NONCHK;
      928    12873    1        FPTTIME = FPT_UNTIME;
      929    12874    1        FPTTIME.V_ = VECTOR( FPTTIME.V );
      930    12875    1        FPTTIME.DATE_ = VECTOR( BUF$ -> VLR$LOCAL.DATE );
      931    12876    1        FPTTIME.TIME_ = VECTOR( BUF$ -> VLR$LOCAL.TIME );
      932    12877    1        FPTTIME.TSTAMP_ = VECTOR( LASTUTS );
      933    12878    1        IF S_D.RUM AND S_D.RUM_BIRTH$ ~= ADDR( NIL )
      934    12879    2        THEN DO;
      935    12880    2             LASTUTS = S_D.RUM_BIRTH$ -> B$RUBIRTH.CREATE_UTS;
      936    12881    2             CALL M$TIME( FPTTIME ) ALTRET( ARETT );
      937    12882    2             BUF$ -> VLR$LOCAL.SPACE = ' ';
      938    12883    2             SIZE = LENGTHC( VLR$LOCAL );
      939    12884    2             CALL INSERT( S_D.OUTPUT, SIZE, , ' Creation UTS' );
      940    12885    2             SIZE = SIZE + LENGTHC( ' Creation UTS' );
      941    12886        /* Don't print creation UTS in octal
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:30   
      942    12887                  TEMP$ = PINCRC( BUF$, SIZE );
      943    12888                  CALL DDR$BINTXT( TEMP$, LASTUTS, %OCT_FMT, ARS );
      944    12889                  TEMP$ -> CHAR$1 = '=';
      945    12890                  SIZE = SIZE + ARS;
      946    12891           Don't print creation UTS in octal */
      947    12892    2             CALL DDQ$WRITE( BUF$, SIZE );
      948    12893    2             USED = S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT;
      949    12894    2             IF USED ~= 0
      950    12895    3             THEN DO;
      951    12896    3                  LASTUTS = S_D.RUM_BIRTH$ -> B$RUBIRTH.RUMED_UTS;
      952    12897    3                  CALL M$TIME( FPTTIME ) ALTRET( ARETT );
      953    12898    3                  SIZE = LENGTHC( VLR$LOCAL );
      954    12899    3                  CALL INSERT( S_D.OUTPUT, SIZE, , ' Last RUMed (' );
      955    12900    3                  SIZE = SIZE + LENGTHC( ' Last RUMed (' );
      956    12901    3                  TEMP$ = PINCRC( BUF$, SIZE );
      957    12902    3                  CALL DDR$BINTXT( TEMP$, USED, %UINT_FMT, ARS );
      958    12903    3                  SIZE = SIZE + ARS;
      959    12904    3                  CALL INSERT( S_D.OUTPUT, SIZE, , ' times)' );
      960    12905    3                  SIZE = SIZE + LENGTHC( ' times)' );
      961    12906    3                  CALL DDQ$WRITE( BUF$, SIZE );
      962    12907    3                END;
      963    12908    2           END;
      964    12909    1        LASTUTS = 0;                       /* It will never be 1976 again */
      965    12910    1        INX = 0;
      966    12911    1        FPTREAD = FPT_READ;
      967    12912    1        FPTREAD.V_ = VECTOR( FPTREAD.V );
      968    12913    1        FPTREAD.BUF_ = VECTOR( RECBUF );
      969    12914    1        KEYBUF = B_RUMKEY;
      970    12915    1        FPTREAD.KEY_ = VECTOR( KEYBUF );
      971    12916    1        FPTREAD.V.DCB# = S_D.LMDCB;
      972    12917    1        BRUMKEY = B_RUMKEY;
      973    12918        /* Position to RUM reocrds */
      974    12919    1        CALL M$READ( FPTREAD ) ALTRET( ARETP );
      975    12920    1   READC: ;
      976    12921    1        FPTREAD.V.KEYS# = '0'B;
      977    12922    2        DO WHILE( '1'B );
      978    12923    2             CALL DDB$BREAK ALTRET( NONCHK );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:31   
      979    12924    2             CALL M$READ( FPTREAD ) ALTRET( ARETR );
      980    12925    2             BRUMKEY = KEYBUF;
      981    12926    2             IF BRUMKEY.KEYSIZ = B_RUMKEY.KEYSIZ
      982    12927    2             THEN IF ( BRUMKEY.NOTHD = B_RUMKEY.NOTHD ) AND
      983    12928    2                    ( BRUMKEY.TYPE = B_RUMKEY.TYPE )
      984    12929    3                  THEN DO;
      985    12930    3                       IF BRUMKEY.SEQ = 1 THEN INX = INX + 1;
      986    12931    3                       IF (NOT S_D.DO$->LIST$CMD.LIST_ALL) AND
      987    12932    3                         (INX<S_D.DO$->LIST$CMD.ID_FROM OR INX>S_D.DO$->LIST$CMD.ID_TO)
             12932                                  THEN GOTO READC;
      988    12933    3                       NONE = NONE + 1;
      989    12934    3                       IF DELETE_FLAG
      990    12935    3                       THEN CALL M$DELREC( FPTDELREC ) ALTRET( ARETD );
      991    12936    4                       ELSE DO;            /* List it */
      992    12937    4                            IF BRUMKEY.UTS ~= LASTUTS
      993    12938    5                            THEN DO;       /* Print UTS */
      994    12939    5                                 LASTUTS = BRUMKEY.UTS;
      995    12940    5                                 LASTNODE = 0; /* Root (doesn't get printed) */
      996    12941    5                                 BUF$ -> VLR$LOCAL.SPACE = ' ';
      997    12942    5                                 CALL M$TIME( FPTTIME ) ALTRET( ARETT );
      998    12943    5                                 SIZE = LENGTHC( VLR$LOCAL );
      999    12944    5                                 CALL DDQ$WRITE( BUF$, SIZE );
     1000    12945    5                               END;
     1001    12946    4                            IF BRUMKEY.NODE ~= LASTNODE
     1002    12947    5                            THEN DO;       /* Print node name */
     1003    12948    5                                 LASTNODE = BRUMKEY.NODE;
     1004    12949    5                                 CALL CONCAT( S_D.OUTPUT, 'Use Node ', S_D.B$TREE$ ->
             12949                                          B$NODE.NAME$( LASTNODE ) -> TEXT$C.TXT );
     1005    12950    5                                 SIZE = S_D.B$TREE$ -> B$NODE.NAME$( LASTNODE ) ->
             12950                                          TEXT$C.SIZE + LENGTHC( 'Use Node ' );
     1006    12951    5                                 CALL DDQ$WRITE( BUF$, SIZE );
     1007    12952    5                               END;
     1008    12953    4                            SIZE = BRUMKEY.SEQ;
     1009    12954    4                            CALL BINCHAR( BUF$ -> CHAR$5, SIZE );
     1010    12955    4                            CALL INSERT( S_D.OUTPUT, LENGTHC( CHAR$5 ), , ' ', RECBUF )
             12955                                     ;
     1011    12956    4                            SIZE = DCB$ -> F$DCB.ARS# + LENGTHC( CHAR$5 ) + LENGTHC(
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:32   
             12956                                     ' ' );
     1012    12957    4                            IF SIZE > LENGTHC( S_D.OUTPUT )
     1013    12958    4                            THEN SIZE = LENGTHC( S_D.OUTPUT );
     1014    12959    4                            CALL DDQ$WRITE( BUF$, SIZE );
     1015    12960    4                          END;             /* List it */
     1016    12961    3                     END;
     1017    12962    2                  ELSE GOTO NONCHK;
     1018    12963    2             ELSE
     1019    12964    3   NONCHK:   DO;
     1020    12965    3                  IF DELETE_FLAG
     1021    12966    4                  THEN DO;
     1022    12967    4                       CALL DDR$BINTXT( BUF$, NONE, %UINT_FMT, SIZE );
     1023    12968    4                       CALL INSERT( S_D.OUTPUT, SIZE, LENGTHC( S_D.OUTPUT ) - SIZE,
             12968                                ' record(s) deleted.' );
     1024    12969    4                       SIZE = SIZE + LENGTHC( ' record(s) deleted.' );
     1025    12970    4                     END;
     1026    12971    3                  ELSE IF NONE = 0 AND (S_D.DO$->LIST$CMD.ID_FROM > 0 AND S_D.DO$->
             12971                           LIST$CMD.ID_TO > 0)
     1027    12972    4                       THEN DO;
     1028    12973    4                            S_D.OUTPUT = 'None';
     1029    12974    4                            SIZE = LENGTHC( 'None' );
     1030    12975    4                          END;
     1031    12976    3                       ELSE SIZE = 0;
     1032    12977    3                  IF SIZE ~= 0
     1033    12978    3                  THEN CALL DDQ$WRITE( BUF$, SIZE );
     1034    12979    3                  RETURN;
     1035    12980    3                END NONCHK;
     1036    12981    2           END;
     1037    12982    1   ARETP: ;
     1038    12983    1        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$NOKEY
     1039    12984    1        THEN GOTO READC;
     1040    12985    1   ARETR: ;
     1041    12986    1        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$EOF
     1042    12987    1        THEN GOTO NONCHK;
     1043    12988    1   ARETD: ;
     1044    12989    1   ARETF: ;
     1045    12990    1   ARETG: ;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:33   
     1046    12991    1   ARETT: ;
     1047    12992    1   ARETU: ;
     1048    12993    1        CALL DUE$ERRMSG;
     1049    12994    1        RETURN;
     1050    12995                                                /**/
     1051    12996        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:34   
     1052    12997        /*F* NAME: DUA$SHOW_RUM
     1053    12998             PURPOSE: To put the text FID of the RU currently being RUMed into
     1054    12999                      the output display buffer.
     1055    13000             DESCRIPTION: The text name of the RU currently being RUMed is obtained
     1056    13001                          from the dcb S_D.RUMDCB using M$UNFID. DDQ$WRITE is
     1057    13002                          called to write out the message "RUM FID". */
     1058    13003        /*D* NAME: DUA$SHOW_RUM
     1059    13004             ENTRY: DUA$SHOW_RUM
     1060    13005             CALL: CALL DUA$SHOW_RUM;
     1061    13006             SCRATCH: Local AUTO only.
     1062    13007             DESCRIPTION: The text name of the RU currently being RUMed is obtained
     1063    13008                          from the dcb S_D.RUMDCB using M$UNFID. DDQ$WRITE is
     1064    13009                          called to write out the message "RUM FID". */
     1065    13010                                                /**/
     1066    13011    1   DUA$SHOW_RUM: ENTRY;
     1067    13012                                                /**/
     1068    13013    1        FPTUNFID = FPT_UNFID;
     1069    13014    1        FPTUNFID.V_ = VECTOR( FPTUNFID.V );
     1070    13015    1        FPTUNFID.V.DCB# = S_D.LMDCB;
     1071    13016    1        FPTUNFID.TEXTFID_ = VECTOR( RECBUF );
     1072    13017    1        CALL M$UNFID( FPTUNFID ) ALTRET( ARETU );
     1073    13018    1        BUF$ = ADDR( S_D.OUTPUT );
     1074    13019    1        CALL INDEX( SIZE, ' ', RECBUF );   /* Get 1st blank */
     1075    13020    1        SIZE = LENGTHC( 'RUM ' ) + SIZE;
     1076    13021    1        IF SIZE > LENGTHC( S_D.OUTPUT )
     1077    13022    1        THEN SIZE = LENGTHC( S_D.OUTPUT );
     1078    13023    1        CALL CONCAT( S_D.OUTPUT, 'RUM ', RECBUF );
     1079    13024    1        CALL DDQ$WRITED( BUF$, SIZE );
     1080    13025                                                /**/
     1081    13026    1        RETURN;
     1082    13027                                                /**/
     1083    13028        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:35   
     1084    13029        /*F* NAME: DUA$RUM_COMM
     1085    13030             PURPOSE: To record commands that are all comments in RUM RU.
     1086    13031             DESCRIPTION: eThe current command in S_D.INPUT consists of comments
     1087    13032                          only. These comments will be recorded in the current
     1088    13033                          RU being RUMed if the write access to the RU is available. */
     1089    13034        /*D* NAME: DUA$RUM_COMM
     1090    13035             ENTRY: DUA$RUM_COMM
     1091    13036             CALL: CALL DUA$RUM_COMM;
     1092    13037             INPUT: S_D.INPUT - Text string to be recorded.
     1093    13038                    S_D.NCHARS - Size of text string to be recorded.
     1094    13039             SCRATCH: Local AUTO only.
     1095    13040             DESCRIPTION: lThe current command in S_D.INPUT consists of comments
     1096    13041                          only. These comments will be recorded in the current
     1097    13042                          RU being RUMed if the write access to the RU is available. */
     1098    13043                                                /**/
     1099    13044    1   DUA$RUM_COMM: ENTRY;
     1100    13045                                                /**/
     1101    13046    1        DCB$ = DCBADDR( S_D.LMDCB );
     1102    13047    1        IF DCB$ -> F$DCB.FFLG.UPD#
     1103    13048    1        THEN IF ( S_D.RUMSEQ = 0 ) AND ( S_D.RUM_BIRTH$ ~= ADDR( NIL ) )
     1104    13049    2             THEN DO;
     1105    13050    2                  S_D.RUM_BIRTH$ -> B$RUBIRTH.RUMED_UTS = S_D.RUMUTS;
     1106    13051    2                  S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT = S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT
             13051                           + 1;
     1107    13052    2                  CALL DDQ$WRITELM( %TYPBIRTH, 0, 0, S_D.RUM_BIRTH$, SIZEC( B$RUBIRTH )
             13052                           ); /* Ignore altret */
     1108    13053    2                END;
     1109    13054    1        IF DCB$ -> F$DCB.FFLG.WNEW#
     1110    13055    1        THEN CALL DDQ$WRITELM( %TYPRUM, 0 /*@PAGE*/, S_D.NODE, ADDR( S_D.INPUT ), S_D.
             13055                 NCHARS ); /* Ignore altret */
     1111    13056                                                /**/
     1112    13057    1        RETURN;
     1113    13058                                                /**/
     1114    13059    1   END DUA$RUM;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:36   
--  Include file information  --

   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DUA$RUM.

   Procedure DUA$RUM requires 2011 words for executable code.
   Procedure DUA$RUM requires 408 words of local(AUTO) storage.

    No errors detected in file DUA$RUM.:E05TSI    .

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:37   

 Object Unit name= DUA$RUM                                    File name= DUA$RUM.:E05TOU
 UTS= JUL 29 '97 14:48:30.28 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1  RoData even  UTS    275    423  DUA$RUM
    2   Proc  even  none  2011   3733  DUA$RUM
    3  RoData even  none    54     66  DUA$RUM

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  DUA$RUM
     2   2227                  yes      Std        0  DUA$KILL_RUM
     2   2733                  yes      Std        0  DUA$DELETE
     2   2753                  yes      Std        0  DUA$LIST
     2   3555                  yes      Std        0  DUA$SHOW_RUM
     2   3640                  yes      Std        0  DUA$RUM_COMM

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      4  FPT_FID                            1     34  FPT_GETDCB
    1    166  FPT_CLOSE                          1    224  FPT_RELDCB
    1    336  VLP_FID_SN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:38   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 DUA$KILL_ANLZ
 yes     yes           Std       7 DDQ$READLM
         yes           Std       0 DUA$EXITDELTA
         yes           Std       2 DDQ$WRITED
         yes           Std       1 DDR$REPORT
         yes           Std       0 DDT$TRACEOFF
         yes           Std       2 DDQ$WRITE
         yes           Std       0 DDA$TRACEON
 yes     yes           Std       0 DDS$SET_Q2C
         yes           Std       0 DUE$ERRMSG
         yes           Std       0 DDA$RESET_PATCH_SPACE
 yes     yes           Std       1 DDS$ES_INQ
         yes           Std       0 DUI$INIT_HOST
 yes     yes           Std       3 DDM$GETMEM
 yes     yes           Std       0 DDB$BREAK
         yes           Std       0 DUI$INIT_L6
         yes           Std       0 DDE$ERROR
         yes           Std       4 DDR$BINTXT
 yes     yes           Std       5 DDQ$WRITELM
 yes     yes           Std       0 DUI$RU_ACCESS
 yes     yes           Std       0 DUU$TRUNC
 yes     yes           Std       3 DDM$PUTMEM
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:39   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                B$ROS$
     DD_RUMNODE$                           FPT_EOM                          r    S_D$
r    S_D_SEG$                              B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:40   


        1        1        /*M* DUA$RUM - RUM DO routines for User DELTA */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR,PLM=5,IND=5,CSU=3,EXM=0,ECU=3,MOC,DCI=5,CRT=5 */
        8        8        %SET LISTSUB='1'B;
        9        9        /*P* NAME: DUA$RUM
       10       10             PURPOSE: This module contains various DO routines that perform
       11       11                      the outermost level of RUM functions.
       12       12             DESCRIPTION: This module contains the routines to perform the RUM
       13       13                          functions of showing which RU is being RUMed, setting
       14       14                          up the specified RU for RUMing, removing the current
       15       15                          RU from RUM mode, listing the modifications made to
       16       16                          the current RU, and deleteing the records that contain
       17       17                          a record of the modifications to the current RU being
       18       18                          RUMed. */
       19       19        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:41   
       20       20        /*F* NAME: DUA$RUM
       21       21             PURPOSE: To establish RUM mode for the specified FID.
       22       22             DESCRIPTION: If RUM mode is active, then it is implicitly killed.
       23       23                          If necessary, the RUM dcb is obtained. Memory for the
       24       24                          RU head record and read-only-segment is obtained. The
       25       25                          read-only-segment is built to look just like the one
       26       26                          STEP builds. */
       27       27        /*D* NAME: DUA$RUM
       28       28             ENTRY: DUA$RUM
       29       29             CALL: CALL DUA$RUM;
       30       30             INTERFACE: DDE$ERROR
       31       31                        DDM$GETMEM
       32       32                        DDM$PUTMEM
       33       33                        DDQ$READLM
       34       34                        DDQ$WRITE
       35       35                        DDR$BINTXT
       36       36                        DDR$REPORT
       37       37                        DDS$ES_INQ
       38       38                        DDS$SET_Q2C
       39       39                        DUE$ERRMSG
       40       40                        DUI$RU_ACCESS
       41       41             SCRATCH: Local AUTO only.
       42       42             DESCRIPTION: If RUM mode is active, then it is implicitly killed.
       43       43                          If necessary, the RUM dcb is obtained. Memory for the
       44       44                          RU head record and read-only-segment is obtained. The
       45       45                          read-only-segment is built to look just like the one
       46       46                          STEP builds. The UTS is obtained for time-stamping
       47       47                          any RUM modification record's keys. The current read-
       48       48                          only-segment is set to the one just built. The root
       49       49                          node in the overlay tree table is set as in memory. */
       50       50                                                /**/
       51       51        DUA$RUM: PROC;

     51  2 000000   000000 700200 xent  DUA$RUM      TSX0  ! X66_AUTO_0
         2 000001   000630 000000                    ZERO    408,0

       52       52                                                /**/
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:42   
       53       53        %INCLUDE CP_6;
       54      134        %INCLUDE G_LCP6_E;
       55      392        %INCLUDE GM_VIRTUAL_E;
       56      602        %INCLUDE B$OBJECT_C;
       57     4032        %INCLUDE DD$BASED;
       58     5335        /* Auto */
       59     5336    1   DCL RECBUF CHAR(256);
       60     5337    1   DCL 1 KEYBUF,
       61     5338    1         2 * CHAR(256);
       62     5339    1   DCL LASTNODE UBIN;
       63     5340    1   DCL LASTUTS UBIN;
       64     5341    1   DCL INX UBIN;
       65     5342    1   DCL SIZE UBIN;
       66     5343    1   DCL BUF$ PTR;
       67     5344    1   DCL DCB$ PTR;
       68     5345    1   DCL DELETE_FLAG BIT(1) ALIGNED;
       69     5346    1   DCL ROSIZE UBIN;
       70     5347    1   DCL NEED UBIN;
       71     5348    1   DCL TOGET SBIN;
       72     5349    1   DCL TEMP$ PTR;
       73     5350    1   DCL TEMP1$ PTR;
       74     5351    1   DCL IX UBIN;
       75     5352    1   DCL DCBPTR$ PTR;
       76     5353    1   DCL NONE UBIN;
       77     5354    1   DCL ARS SBIN;
       78     5355    1   DCL PAGE UBIN;
       79     5356    1   DCL WARNINPUT BIT(1) ALIGNED;
       80     5357    1   DCL DCBRES UBIN;
       81     5358    1   DCL USED UBIN;
       82     5359    1   DCL CODE UBIN;
       83     5360    1   DCL PBSIZEC SBIN;
       84     5361    1   DCL COPYDCB UBIN;
       85     5362    1   DCL NBUFS UBIN;
       86     5363    1   DCL PROGBUF$ PTR;
       87     5364        %B$RUMKEY (NAME=BRUMKEY,
       88     5365                   STCLASS=,
       89     5366                   KEYSIZINIT=,
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:43   
       90     5367                   NOTHDINIT=,
       91     5368                   TYPEINIT=,
       92     5369                   UTSINIT=,
       93     5370                   SEQINIT=,
       94     5371                   NODEINIT=);
       95     5387        %FPT_CLOSE (FPTN=FPTCLOSE,
       96     5388                    STCLASS=);
       97     5430        %FPT_DELREC (FPTN=FPTDELREC,
       98     5431                     STCLASS=);
       99     5450        %FPT_FID (FPTN=FPTFID,
      100     5451                  STCLASS=);
      101     5474        %FPT_GETDCB (FPTN=FPTGETDCB,
      102     5475                     STCLASS=);
      103     5490        %FPT_OPEN (FPTN=FPTOPEN,
      104     5491                   STCLASS=);
      105     5600        %FPT_READ (FPTN=FPTREAD,
      106     5601                   STCLASS=);
      107     5640        %FPT_RELDCB (FPTN=FPTRELDCB,
      108     5641                     STCLASS=);
      109     5655        %FPT_TIME (FPTN=FPTTIME,
      110     5656                   STCLASS=);
      111     5675        %FPT_UNFID (FPTN=FPTUNFID,
      112     5676                    STCLASS=);
      113     5694        %FPT_WRITE (FPTN=FPTWRITE,
      114     5695                    STCLASS=);
      115     5726        %VLP_NAME (FPTN=VLPFID_NAME,
      116     5727                   STCLASS=,
      117     5728                   LEN=64);
      118     5755        %VLP_ACCT (FPTN=VLPFID_ACCT,
      119     5756                   STCLASS=);
      120     5769        %VLP_PASS (FPTN=VLPFID_PASS,
      121     5770                   STCLASS=);
      122     5783        %VLP_WSN (FPTN=VLPFID_WSN,
      123     5784                  STCLASS=);
      124     5797        %VLP_SN (FPTN=VLPFID_SN,
      125     5798                 STCLASS=,
      126     5799                 N=1);
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:44   
      127     5812        %VLR_FID (FPTN=VLRFID,
      128     5813                  STCLASS=);
      129     5832        /* Based */
      130     5833    1   DCL 1 PAGE$BUF BASED ALIGNED,
      131     5834    1         2 * CHAR( PBSIZEC );
      132     5835    1   DCL CHAR$5 CHAR(5) BASED UNAL;
      133     5836    1   DCL DCB$PTR$ PTR BASED ALIGNED;
      134     5837    1   DCL 1 PTR$WORD BASED ALIGNED,
      135     5838    1         2 LH UBIN HALF UNAL,
      136     5839    1         2 RH UBIN HALF UNAL,
      137     5840    1         2 RHB REDEF RH,
      138     5841    1           3 * BIT(1) UNAL,
      139     5842    1           3 UBYTE UBIN(8) UNAL,
      140     5843    1           3 * BIT(1) UNAL,
      141     5844    1           3 LBYTE UBIN(8) UNAL;
      142     5845    1   DCL 1 TEMP$WORD ALIGNED,
      143     5846    1         2 * UBIN(20) UNAL,
      144     5847    1         2 UBYTE UBIN(8) UNAL,
      145     5848    1         2 LBYTE UBIN(8) UNAL;
      146     5849    1   DCL TEMPWORD REDEF TEMP$WORD UBIN WORD ALIGNED;
      147     5850        %ACTIVE$CMD (NAME=LIST$CMD);
      148     5863        %TEXT$C;
      149     5868        %RUM$CMD;
      150     5892        %B$HEAD;
      151     6092        %RU_FLAVORS;
      152     6098        %B$RUBIRTH (STCLASS=BASED,
      153     6099                    COUNTINIT=);
      154     6108        %INCLUDE B$ROSEG;
      155     6171        %B$TCB;
      156     6174        %B$ALT;
      157     6182        %B$TREE_TABLE (HDR_NAME=B$TREEHDR,NODE_NAME="B$NODE(0:0)");
      158     6240    1   DCL 1 VLR$LOCAL BASED UNAL,
      159     6241    1         2 DATE CHAR(8) UNAL,
      160     6242    1         2 SPACE CHAR(1) UNAL,
      161     6243    1         2 TIME CHAR(11) UNAL;
      162     6244        %F$DCB;
      163     6301        /* Constant */
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:45   
      164     6302        %B$RUMKEY (NAME=B_RUMKEY,
      165     6303                   STCLASS=CONSTANT);
      166     6319        %FPT_FID (FPTN=FPT_FID,
      167     6320                  STCLASS=CONSTANT SYMDEF);
      168     6343        %FPT_GETDCB (FPTN=FPT_GETDCB,
      169     6344                     STCLASS=CONSTANT SYMDEF,
      170     6345                     MERGE=NO);
      171     6360        %FPT_READ (FPTN=FPT_READ,
      172     6361                   STCLASS=CONSTANT,
      173     6362                   KEYS=YES,
      174     6363                   KEYR=YES);
      175     6402        %FPT_DELREC (FPTN=FPT_DELREC,
      176     6403                     STCLASS=CONSTANT);
      177     6422        %FPT_OPEN (FPTN=FPT_OPEN,
      178     6423                   STCLASS=CONSTANT,
      179     6424                   FUN=UPDATE,
      180     6425                   REASSIGN=NO,
      181     6426                   SCRUB=YES);
      182     6535        %FPT_CLOSE (FPTN=FPT_CLOSE,
      183     6536                    STCLASS=CONSTANT SYMDEF,
      184     6537                    DISP=SAVE);
      185     6579        %FPT_RELDCB (FPTN=FPT_RELDCB,
      186     6580                     STCLASS=CONSTANT SYMDEF);
      187     6594        %FPT_TIME (FPTN=FPT_LOCTIME,
      188     6595                   STCLASS=CONSTANT,
      189     6596                   SOURCE=LOCAL,
      190     6597                   DEST=UTS);
      191     6616        %FPT_TIME (FPTN=FPT_UNTIME,
      192     6617                   STCLASS=CONSTANT,
      193     6618                   SOURCE=UTS,
      194     6619                   DEST=LOCAL);
      195     6638        %FPT_TIME (FPTN=FPT_TIME,
      196     6639                   STCLASS=CONSTANT,
      197     6640                   SOURCE=CLOCK,
      198     6641                   DEST=UTS);
      199     6660        %FPT_WRITE (FPTN=FPT_WRITE,
      200     6661                    STCLASS=CONSTANT);
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:46   
      201     6692        %FPT_UNFID (FPTN=FPT_UNFID,
      202     6693                    STCLASS=CONSTANT);
      203     6711        %VLP_SN (FPTN=VLP_FID_SN,
      204     6712                 STCLASS=CONSTANT SYMDEF);
      205     6725        /* Symref */
      206     6726    1   DCL B$TCB$ PTR SYMREF;
      207     6727    1   DCL B$ROS$ PTR SYMREF;
      208     6728    1   DCL D_M$DO# UBIN SYMREF;
      209     6729    1   DCL D_M$LM# UBIN SYMREF;
      210     6730    1   DCL DD_RUMNODE$ PTR SYMREF;
      211     6731        %FPT_EOM (FPTN=FPT_EOM,STCLASS=SYMREF);
      212     6761        /* DELTA static data */
      213     6762        %INCLUDE XUH_MACRO_C;
      214     6846        %INCLUDE DD_SD_M;
      215     8182        %S_D;
      216     9500        %S_D_PTRS;
      217     9537        /* Entry */
      218     9538    1   DCL DDA$TRACEON ENTRY(0);
      219     9539    1   DCL DDA$RESET_PATCH_SPACE ENTRY;
      220     9540    1   DCL DDB$BREAK ENTRY(0) ALTRET;
      221     9541    1   DCL DDE$ERROR ENTRY(0);
      222     9542    1   DCL DDM$GETMEM ENTRY(3) ALTRET;
      223     9543    1   DCL DDM$PUTMEM ENTRY(3) ALTRET;
      224     9544    1   DCL DDQ$READLM ENTRY(7) ALTRET;
      225     9545    1   DCL DDQ$WRITE ENTRY(2);
      226     9546    1   DCL DDQ$WRITED ENTRY(2);
      227     9547    1   DCL DDQ$WRITELM ENTRY(5) ALTRET;
      228     9548    1   DCL DDR$BINTXT ENTRY(4);
      229     9549    1   DCL DDR$REPORT ENTRY(1);
      230     9550    1   DCL DDS$ES_INQ ENTRY(1) ALTRET;
      231     9551    1   DCL DDS$SET_Q2C ENTRY(0) ALTRET;
      232     9552    1   DCL DDT$TRACEOFF ENTRY(0);
      233     9553    1   DCL DUA$EXITDELTA ENTRY(0);
      234     9554    1   DCL DUA$KILL_ANLZ ENTRY(0) ALTRET;
      235     9555    1   DCL DUE$ERRMSG ENTRY(0);
      236     9556    1   DCL DUI$INIT_HOST ENTRY;
      237     9557    1   DCL DUI$INIT_L6 ENTRY;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:47   
      238     9558    1   DCL DUI$RU_ACCESS ENTRY(0) ALTRET;
      239     9559    1   DCL DUU$TRUNC ENTRY(0) ALTRET;
      240     9560                                                /**/
      241     9561        /* Misc */
      242     9562        %B$RECORDSUBS;
      243     9590        %INCLUDE CP_6_SUBS;
      244    10130        %INCLUDE DD_ERR_C;
      245    10527        %INCLUDE DD_PSUBS_C;
      246    11002        %INCLUDE DD_SUBS_C;
      247    11273        %INCLUDE F_ERRORS_C;
      248    11513        %INCLUDE DD$DITEM;
       12+   11616             %LIST;
       13+   11617    1        DCL SDD$ PTR;
       14+   11618    1        DCL ZITEM$ PTR;
       15+   11619    1        DCL SDD_L6$ PTR;
       16+   11620    1        DCL ZITEM_L6$ PTR;
      249    12194        %SUB @PAGE=0 /*@PAGE*/;
      250    12195        %SUB @NODE=0 /*@NODE*/;
      251    12196        %SUB @PSIZ=1024 /*@PSIZ*/;
      252    12197                                                /**/
      253    12198        /* Cleanup current RU access */
      254    12199    1        IF S_D.ANLZ

  12199  2 000002   000000 470400 xsym               LDP0    S_D$
         2 000003   004756 234100                    SZN     2542,,PR0
         2 000004   000010 605000 2                  TPL     s:12201

      255    12200    1        THEN CALL DUA$KILL_ANLZ;           /* Ignore altret */

  12200  2 000005   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000006   000000 701000 xent               TSX1    DUA$KILL_ANLZ
         2 000007   000000 011000                    NOP     0

      256    12201    1        IF S_D.TR$INFO.ACTIVE

  12201  2 000010   000000 470400 xsym               LDP0    S_D$
         2 000011   004630 234100                    SZN     2456,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:48   
         2 000012   000021 605000 2                  TPL     s:12206

      257    12202    2        THEN DO;

      258    12203    2             S_D.TRACE_STATE = '1'B;

  12203  2 000013   400000 236003                    LDQ     -131072,DU
         2 000014   005143 756100                    STQ     2659,,PR0

      259    12204    2             CALL DDT$TRACEOFF;

  12204  2 000015   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000016   000000 701000 xent               TSX1    DDT$TRACEOFF
         2 000017   000000 011000                    NOP     0

      260    12205    2           END;

  12205  2 000020   000022 710000 2                  TRA     s:12207

      261    12206    1        ELSE S_D.TRACE_STATE = '0'B;

  12206  2 000021   005143 450100                    STZ     2659,,PR0

      262    12207    1        CALL KILL_RUM ALTRET( REPORT_XXX );

  12207  2 000022   002374 701000 2                  TSX1    KILL_RUM
         2 000023   002207 702000 2                  TSX2    REPORT_XXX

      263    12208        /* Open RU */
      264    12209    1        FPTFID = FPT_FID;

  12209  2 000024   000100 100400                    MLR     fill='000'O
         2 000025   000004 000140 1                  ADSC9   FPT_FID                  cn=0,n=96
         2 000026   200310 000140                    ADSC9   FPTFID,,AUTO             cn=0,n=96

      265    12210    1        FPTOPEN = FPT_OPEN;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:49   
  12210  2 000027   000100 100400                    MLR     fill='000'O
         2 000030   000074 000350 1                  ADSC9   FPT_OPEN                 cn=0,n=232
         2 000031   200350 000350                    ADSC9   FPTOPEN,,AUTO            cn=0,n=232

      266    12211    1        FPTFID.V_ = VECTOR( FPTFID.V );

  12211  2 000032   000000 235000 3                  LDA     0
         2 000033   200622 452500                    STP2    DEFI+2,,AUTO
         2 000034   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000035   000334 036003                    ADLQ    220,DU
         2 000036   200310 757100                    STAQ    FPTFID,,AUTO

      267    12212    1        FPTFID.TEXTFID_ = VECTOR( ADDR( S_D.DO$ -> RUM$CMD.FID ) -> TEXT$C.TXT );

  12212  2 000037   000000 470400 xsym               LDP0    S_D$
         2 000040   000031 471500                    LDP1    25,,PR0
         2 000041   100010 236100                    LDQ     8,,PR1
         2 000042   000033 772000                    QRL     27
         2 000043   000064 737000                    LLS     52
         2 000044   000140 135007                    SBLA    96,DL
         2 000045   200622 451500                    STP1    DEFI+2,,AUTO
         2 000046   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000047   000001 036000 3                  ADLQ    1
         2 000050   200312 757100                    STAQ    FPTFID+2,,AUTO

      268    12213    1        FPTFID.NAME_ = VECTOR( VLPFID_NAME );

  12213  2 000051   000002 235000 3                  LDA     2
         2 000052   200622 452500                    STP2    DEFI+2,,AUTO
         2 000053   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000054   000542 036003                    ADLQ    354,DU
         2 000055   200314 757100                    STAQ    FPTFID+4,,AUTO

      269    12214    1        FPTFID.ACCT_ = VECTOR( VLPFID_ACCT );

  12214  2 000056   000003 235000 3                  LDA     3
         2 000057   200622 452500                    STP2    DEFI+2,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:50   
         2 000060   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000061   000563 036003                    ADLQ    371,DU
         2 000062   200316 757100                    STAQ    FPTFID+6,,AUTO

      270    12215    1        FPTFID.PASS_ = VECTOR( VLPFID_PASS );

  12215  2 000063   000003 235000 3                  LDA     3
         2 000064   200622 452500                    STP2    DEFI+2,,AUTO
         2 000065   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000066   000565 036003                    ADLQ    373,DU
         2 000067   200320 757100                    STAQ    FPTFID+8,,AUTO

      271    12216    1        VLPFID_SN = VLP_FID_SN;

  12216  2 000070   000100 100400                    MLR     fill='000'O
         2 000071   000336 000012 1                  ADSC9   VLP_FID_SN               cn=0,n=10
         2 000072   200572 000012                    ADSC9   VLPFID_SN,,AUTO          cn=0,n=10

      272    12217    1        FPTFID.SN_ = VECTOR( VLPFID_SN );

  12217  2 000073   000000 235000 3                  LDA     0
         2 000074   200622 452500                    STP2    DEFI+2,,AUTO
         2 000075   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000076   000572 036003                    ADLQ    378,DU
         2 000077   200322 757100                    STAQ    FPTFID+10,,AUTO

      273    12218    1        FPTFID.WSN_ = VECTOR( VLPFID_WSN );

  12218  2 000100   000003 235000 3                  LDA     3
         2 000101   200622 452500                    STP2    DEFI+2,,AUTO
         2 000102   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000103   000567 036003                    ADLQ    375,DU
         2 000104   200324 757100                    STAQ    FPTFID+12,,AUTO

      274    12219    1        FPTFID.ASN_ = VECTOR( FPTOPEN.V.ASN# );

  12219  2 000105   177640 235007                    LDA     65440,DL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:51   
         2 000106   200622 452500                    STP2    DEFI+2,,AUTO
         2 000107   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000110   000004 036000 3                  ADLQ    4
         2 000111   200326 757100                    STAQ    FPTFID+14,,AUTO

      275    12220    1        FPTFID.RES_ = VECTOR( FPTOPEN.V.RES# );

  12220  2 000112   777640 235007                    LDA     -96,DL
         2 000113   200622 452500                    STP2    DEFI+2,,AUTO
         2 000114   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000115   000420 036003                    ADLQ    272,DU
         2 000116   200330 757100                    STAQ    FPTFID+16,,AUTO

      276    12221    1        FPTFID.RESULTS_ = VECTOR( VLRFID );

  12221  2 000117   000005 235000 3                  LDA     5
         2 000120   200622 452500                    STP2    DEFI+2,,AUTO
         2 000121   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000122   000576 036003                    ADLQ    382,DU
         2 000123   200332 757100                    STAQ    FPTFID+18,,AUTO

      277    12222    1        CALL M$FID( FPTFID ) ALTRET( ARETF );

  12222  2 000124   200310 630500                    EPPR0   FPTFID,,AUTO
         2 000125   420001 713400                    CLIMB   alt,+8193
         2 000126   404400 401760                    pmme    nvectors=10
         2 000127   003551 702000 2                  TSX2    ARETD

      278    12223    1        IF NOT VLRFID.NAME

  12223  2 000130   200576 234100                    SZN     VLRFID,,AUTO
         2 000131   002165 605000 2                  TPL     NONAME

      279    12224    1        THEN GOTO NONAME;
      280    12225    1        FPTOPEN.V_ = VECTOR( FPTOPEN.V );

  12225  2 000132   000006 235000 3                  LDA     6
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:52   
         2 000133   200622 452500                    STP2    DEFI+2,,AUTO
         2 000134   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000135   000414 036003                    ADLQ    268,DU
         2 000136   200350 757100                    STAQ    FPTOPEN,,AUTO

      281    12226    1        FPTOPEN.SN_ = VECTOR( VLPFID_SN );

  12226  2 000137   000000 235000 3                  LDA     0
         2 000140   200622 452500                    STP2    DEFI+2,,AUTO
         2 000141   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000142   000572 036003                    ADLQ    378,DU
         2 000143   200352 757100                    STAQ    FPTOPEN+2,,AUTO

      282    12227    1        FPTOPEN.NAME_ = VECTOR( VLPFID_NAME );

  12227  2 000144   000002 235000 3                  LDA     2
         2 000145   200622 452500                    STP2    DEFI+2,,AUTO
         2 000146   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000147   000542 036003                    ADLQ    354,DU
         2 000150   200356 757100                    STAQ    FPTOPEN+6,,AUTO

      283    12228    1        FPTOPEN.PASS_ = VECTOR( VLPFID_PASS );

  12228  2 000151   000003 235000 3                  LDA     3
         2 000152   200622 452500                    STP2    DEFI+2,,AUTO
         2 000153   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000154   000565 036003                    ADLQ    373,DU
         2 000155   200360 757100                    STAQ    FPTOPEN+8,,AUTO

      284    12229    1        FPTOPEN.ACCT_ = VECTOR( VLPFID_ACCT );

  12229  2 000156   000003 235000 3                  LDA     3
         2 000157   200622 452500                    STP2    DEFI+2,,AUTO
         2 000160   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000161   000563 036003                    ADLQ    371,DU
         2 000162   200374 757100                    STAQ    FPTOPEN+20,,AUTO

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:53   
      285    12230    1        FPTOPEN.WSN_ = VECTOR( VLPFID_WSN );

  12230  2 000163   000003 235000 3                  LDA     3
         2 000164   200622 452500                    STP2    DEFI+2,,AUTO
         2 000165   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000166   000567 036003                    ADLQ    375,DU
         2 000167   200402 757100                    STAQ    FPTOPEN+26,,AUTO

      286    12231        /* We may need a dcb */
      287    12232    1        S_D.LMDCB_SAVE = S_D.LMDCB;

  12232  2 000170   000000 470400 xsym               LDP0    S_D$
         2 000171   004774 235100                    LDA     2556,,PR0
         2 000172   006743 755100                    STA     3555,,PR0

      288    12233    1        IF S_D.RUMDCB = 0

  12233  2 000173   004776 235100                    LDA     2558,,PR0
         2 000174   000221 601000 2                  TNZ     s:12241

      289    12234    2        THEN DO;

      290    12235    2             FPTGETDCB = FPT_GETDCB;

  12235  2 000175   000100 100400                    MLR     fill='000'O
         2 000176   000034 000040 1                  ADSC9   FPT_GETDCB               cn=0,n=32
         2 000177   200340 000040                    ADSC9   FPTGETDCB,,AUTO          cn=0,n=32

      291    12236    2             FPTGETDCB.V_ = VECTOR( FPTGETDCB.V );

  12236  2 000200   000003 235000 3                  LDA     3
         2 000201   200622 452500                    STP2    DEFI+2,,AUTO
         2 000202   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000203   000346 036003                    ADLQ    230,DU
         2 000204   200340 757100                    STAQ    FPTGETDCB,,AUTO

      292    12237    2             FPTGETDCB.DCBNUM_ = VECTOR( S_D.LMDCB );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:54   

  12237  2 000205   777640 235007                    LDA     -96,DL
         2 000206   000000 236000 xsym               LDQ     S_D$
         2 000207   004774 036003                    ADLQ    2556,DU
         2 000210   200344 757100                    STAQ    FPTGETDCB+4,,AUTO

      293    12238    2             CALL M$GETDCB( FPTGETDCB ) ALTRET( ARETG );

  12238  2 000211   200340 630500                    EPPR0   FPTGETDCB,,AUTO
         2 000212   460002 713400                    CLIMB   alt,+24578
         2 000213   401000 401760                    pmme    nvectors=3
         2 000214   003551 702000 2                  TSX2    ARETD

      294    12239    2             S_D.RUMDCB = S_D.LMDCB;

  12239  2 000215   000000 470400 xsym               LDP0    S_D$
         2 000216   004774 235100                    LDA     2556,,PR0
         2 000217   004776 755100                    STA     2558,,PR0

      295    12240    2           END;

  12240  2 000220   000222 710000 2                  TRA     s:12242

      296    12241    1        ELSE S_D.LMDCB = S_D.RUMDCB;

  12241  2 000221   004774 755100                    STA     2556,,PR0

      297    12242    1        FPTOPEN.V.DCB# = S_D.LMDCB;

  12242  2 000222   004774 720100                    LXL0    2556,,PR0
         2 000223   200414 740100                    STX0    FPTOPEN+36,,AUTO

      298    12243        /* We are now in RUM mode */
      299    12244    1        S_D.SAVEIC_SAVE = S_D.SAVEIC;

  12244  2 000224   000002 235100                    LDA     2,,PR0
         2 000225   005051 755100                    STA     2601,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:55   

      300    12245    1        S_D.EXEC_DOMAIN_SAVE = S_D.ONE_TO_TWO.EXEC_DOMAIN;

  12245  2 000226   006714 235100                    LDA     3532,,PR0
         2 000227   005325 755100                    STA     2773,,PR0

      301    12246    1        S_D.RUM = '1'B;

  12246  2 000230   400000 236003                    LDQ     -131072,DU
         2 000231   004755 756100                    STQ     2541,,PR0

      302    12247        /* Get some memory */
      303    12248    1        CALL DDM$GETMEM( DD_RUMNODE$, 1024 /*@PSIZ*/ ) ALTRET( NOMEM1 );

  12248  2 000232   000010 630400 3                  EPPR0   8
         2 000233   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000234   000000 701000 xent               TSX1    DDM$GETMEM
         2 000235   002155 702000 2                  TSX2    NOMEM1

      304    12249    1        S_D.NODESEG_USED$ = PINCRW( DD_RUMNODE$, 1024 /*@PSIZ*/ );

  12249  2 000236   000000 236000 xsym               LDQ     DD_RUMNODE$
         2 000237   002000 036003                    ADLQ    1024,DU
         2 000240   000000 470400 xsym               LDP0    S_D$
         2 000241   004771 756100                    STQ     2553,,PR0

      305    12250    1        CODE = S_D.DO$ -> RUM$CMD.CODE;

  12250  2 000242   000031 471500                    LDP1    25,,PR0
         2 000243   100001 236100                    LDQ     1,,PR1
         2 000244   000011 772000                    QRL     9
         2 000245   000777 376007                    ANQ     511,DL
         2 000246   200227 756100                    STQ     CODE,,AUTO

      306    12251    1        S_D.RUM_TEST = '0'B;

  12251  2 000247   005004 450100                    STZ     2564,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:56   

      307    12252    1        IF CODE ~= 0

  12252  2 000250   000271 600000 2                  TZE     s:12263

      308    12253    2        THEN DO;                           /* Copy, Input, or Test specified */

      309    12254    2             FPTOPEN.V.FUN# = %IN#;

  12254  2 000251   002000 236007                    LDQ     1024,DL
         2 000252   200415 552110                    STBQ    FPTOPEN+37,'10'O,AUTO

      310    12255    2             IF CODE = 82              /* C@COPY */

  12255  2 000253   200227 235100                    LDA     CODE,,AUTO
         2 000254   000122 115007                    CMPA    82,DL
         2 000255   000264 601000 2                  TNZ     s:12260

      311    12256    3             THEN DO;

      312    12257    3                  PBSIZEC = 1024 /*@PSIZ*/ * LENGTHC( PBSIZEC );

  12257  2 000256   010000 235007                    LDA     4096,DL
         2 000257   200230 755100                    STA     PBSIZEC,,AUTO

      313    12258    3                  FPTOPEN.FPARAM_ = VECTOR( DD_RUMNODE$ -> PAGE$BUF );

  12258  2 000260   000020 735000                    ALS     16
         2 000261   000140 135007                    SBLA    96,DL
         2 000262   000000 236000 xsym               LDQ     DD_RUMNODE$
         2 000263   200400 757100                    STAQ    FPTOPEN+24,,AUTO

      314    12259    3                END;

      315    12260    2             IF CODE = 98              /* C@TEST */

  12260  2 000264   200227 235100                    LDA     CODE,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:57   
         2 000265   000142 115007                    CMPA    98,DL
         2 000266   000271 601000 2                  TNZ     s:12263

      316    12261    2             THEN S_D.RUM_TEST = '1'B;

  12261  2 000267   400000 236003                    LDQ     -131072,DU
         2 000270   005004 756100                    STQ     2564,,PR0

      317    12262    2           END;

      318    12263    1        WARNINPUT = '0'B;

  12263  2 000271   200224 450100                    STZ     WARNINPUT,,AUTO

      319    12264    1        CALL M$OPEN( FPTOPEN ) ALTRET( NOOPN1 );

  12264  2 000272   200350 630500                    EPPR0   FPTOPEN,,AUTO
         2 000273   450000 713400                    CLIMB   alt,open
         2 000274   410400 401760                    pmme    nvectors=18
         2 000275   002046 702000 2                  TSX2    NOOPN1

      320    12265    1        DCB$ = DCBADDR( S_D.RUMDCB );

  12265  2 000276   000012 470400 3                  LDP0    10
         2 000277   000000 471500                    LDP1    0,,PR0
         2 000300   000000 473400 xsym               LDP3    S_D$
         2 000301   304776 720100                    LXL0    2558,,PR3
         2 000302   100000 236110                    LDQ     0,X0,PR1
         2 000303   200210 756100                    STQ     DCB$,,AUTO

      321    12266    1        IF FPTOPEN.V.FUN# = %UPDATE#

  12266  2 000304   200415 236100                    LDQ     FPTOPEN+37,,AUTO
         2 000305   777000 376007                    ANQ     -512,DL
         2 000306   001000 116007                    CMPQ    512,DL
         2 000307   000322 601000 2                  TNZ     s:12273

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:58   
      322    12267    2        THEN DO;

      323    12268    2             IF ( NOT DCB$ -> F$DCB.FFLG.DELR# ) OR

  12268  2 000310   200210 474500                    LDP4    DCB$,,AUTO
         2 000311   400004 236100                    LDQ     4,,PR4
         2 000312   200000 316003                    CANQ    65536,DU
         2 000313   000320 600000 2                  TZE     s:12271
         2 000314   100000 316003                    CANQ    32768,DU
         2 000315   000320 600000 2                  TZE     s:12271
         2 000316   040000 316003                    CANQ    16384,DU
         2 000317   000322 601000 2                  TNZ     s:12273

      324    12269    2               ( NOT DCB$ -> F$DCB.FFLG.WNEW# ) OR
      325    12270    2               ( NOT DCB$ -> F$DCB.FFLG.UPD# )
      326    12271    2             THEN WARNINPUT = '1'B;

  12271  2 000320   400000 236003                    LDQ     -131072,DU
         2 000321   200224 756100                    STQ     WARNINPUT,,AUTO

      327    12272    2           END;

      328    12273    1        IF SUBSTR(DCB$ -> F$DCB.NAME#.C, 0, 5) = 'M:FEP'

  12273  2 000322   200210 474500                    LDP4    DCB$,,AUTO
         2 000323   040000 106500                    CMPC    fill='040'O
         2 000324   400010 200005                    ADSC9   8,,PR4                   cn=1,n=5
         2 000325   000342 000005 1                  ADSC9   VLP_FID_SN+4             cn=0,n=5
         2 000326   000332 601000 2                  TNZ     s:12275

      329    12274    1        THEN S_D.RUM_FEP = '1'B;

  12274  2 000327   400000 236003                    LDQ     -131072,DU
         2 000330   307017 756100                    STQ     3599,,PR3
         2 000331   000333 710000 2                  TRA     RUM1

      330    12275    1        ELSE S_D.RUM_FEP = '0'B;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:59   

  12275  2 000332   307017 450100                    STZ     3599,,PR3

  12273  2 000333                       RUM1         null
      331    12276    1   RUM1: ;
      332    12277        /* Must be a keyed file */
      333    12278    1        DCB$ = DCBADDR( S_D.RUMDCB );

  12278  2 000333   000012 470400 3                  LDP0    10
         2 000334   000000 471500                    LDP1    0,,PR0
         2 000335   000000 473400 xsym               LDP3    S_D$
         2 000336   304776 720100                    LXL0    2558,,PR3
         2 000337   100000 236110                    LDQ     0,X0,PR1
         2 000340   200210 756100                    STQ     DCB$,,AUTO

      334    12279    1        IF ( DCB$ -> F$DCB.ORG# ~= %KEYED# ) OR ( DCB$ -> F$DCB.ASN# ~= %FILE# )

  12279  2 000341   200210 474500                    LDP4    DCB$,,AUTO
         2 000342   400032 236100                    LDQ     26,,PR4
         2 000343   777000 376003                    ANQ     -512,DU
         2 000344   002000 116003                    CMPQ    1024,DU
         2 000345   002151 601000 2                  TNZ     NORU1
         2 000346   400032 236100                    LDQ     26,,PR4
         2 000347   777000 376007                    ANQ     -512,DL
         2 000350   001000 116007                    CMPQ    512,DL
         2 000351   002151 601000 2                  TNZ     NORU1

      335    12280    1        THEN GOTO NORU1;
      336    12281        /* Check for Copy mode */
      337    12282    1        IF CODE = 82                   /* C@COPY */

  12282  2 000352   200227 235100                    LDA     CODE,,AUTO
         2 000353   000122 115007                    CMPA    82,DL
         2 000354   000632 601000 2                  TNZ     RUM2

      338    12283    2        THEN DO;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:60   
      339    12284    2             COPYDCB = 0;

  12284  2 000355   200231 450100                    STZ     COPYDCB,,AUTO

      340    12285    2             FPTGETDCB = FPT_GETDCB;

  12285  2 000356   000100 100400                    MLR     fill='000'O
         2 000357   000034 000040 1                  ADSC9   FPT_GETDCB               cn=0,n=32
         2 000360   200340 000040                    ADSC9   FPTGETDCB,,AUTO          cn=0,n=32

      341    12286    2             FPTGETDCB.V_ = VECTOR( FPTGETDCB.V );

  12286  2 000361   000003 235000 3                  LDA     3
         2 000362   200622 452500                    STP2    DEFI+2,,AUTO
         2 000363   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000364   000346 036003                    ADLQ    230,DU
         2 000365   200340 757100                    STAQ    FPTGETDCB,,AUTO

      342    12287    2             FPTGETDCB.DCBNUM_ = VECTOR( COPYDCB );

  12287  2 000366   777640 235007                    LDA     -96,DL
         2 000367   200622 452500                    STP2    DEFI+2,,AUTO
         2 000370   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000371   000231 036003                    ADLQ    153,DU
         2 000372   200344 757100                    STAQ    FPTGETDCB+4,,AUTO

      343    12288    2             CALL M$GETDCB( FPTGETDCB ) ALTRET( ARETGC );

  12288  2 000373   200340 630500                    EPPR0   FPTGETDCB,,AUTO
         2 000374   460002 713400                    CLIMB   alt,+24578
         2 000375   401000 401760                    pmme    nvectors=3
         2 000376   002137 702000 2                  TSX2    ARETGC

      344    12289    2             FPTOPEN.V.DCB# = COPYDCB;

  12289  2 000377   200231 720100                    LXL0    COPYDCB,,AUTO
         2 000400   200414 740100                    STX0    FPTOPEN+36,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:61   

      345    12290    2             FPTOPEN.IFPARAM_ = FPTOPEN.FPARAM_;

  12290  2 000401   200400 237100                    LDAQ    FPTOPEN+24,,AUTO
         2 000402   200376 757100                    STAQ    FPTOPEN+22,,AUTO

      346    12291    2             FPTOPEN.FPARAM_ = VECTOR( NIL );

  12291  2 000403   000014 237000 3                  LDAQ    12
         2 000404   200400 757100                    STAQ    FPTOPEN+24,,AUTO

      347    12292    2             FPTOPEN.V.FUN# = %CREATE#;

  12292  2 000405   003000 236007                    LDQ     1536,DL
         2 000406   200415 552110                    STBQ    FPTOPEN+37,'10'O,AUTO

      348    12293    2             FPTOPEN.V.EXIST# = %NEWFILE#;

  12293  2 000407   000600 236007                    LDQ     384,DL
         2 000410   200414 256100                    ORSQ    FPTOPEN+36,,AUTO

      349    12294    2             FPTOPEN.V.ACS# = %DIRECT#;

  12294  2 000411   000002 236007                    LDQ     2,DL
         2 000412   200416 552104                    STBQ    FPTOPEN+38,'04'O,AUTO

      350    12295    2             CALL M$OPEN( FPTOPEN ) ALTRET( ARETOC );

  12295  2 000413   200350 630500                    EPPR0   FPTOPEN,,AUTO
         2 000414   450000 713400                    CLIMB   alt,open
         2 000415   410400 401760                    pmme    nvectors=18
         2 000416   002115 702000 2                  TSX2    ARETOC

      351    12296    2             FPTREAD = FPT_READ;

  12296  2 000417   000100 100400                    MLR     fill='000'O
         2 000420   000044 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:62   
         2 000421   200442 000070                    ADSC9   FPTREAD,,AUTO            cn=0,n=56

      352    12297    2             FPTREAD.V_ = VECTOR( FPTREAD.V );

  12297  2 000422   000016 235000 3                  LDA     14
         2 000423   200622 452500                    STP2    DEFI+2,,AUTO
         2 000424   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000425   000452 036003                    ADLQ    298,DU
         2 000426   200442 757100                    STAQ    FPTREAD,,AUTO

      353    12298    2             FPTREAD.KEY_ = VECTOR( KEYBUF );

  12298  2 000427   000017 235000 3                  LDA     15
         2 000430   200622 452500                    STP2    DEFI+2,,AUTO
         2 000431   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000432   000103 036003                    ADLQ    67,DU
         2 000433   200444 757100                    STAQ    FPTREAD+2,,AUTO

      354    12299    2             FPTREAD.BUF_ = VECTOR( DD_RUMNODE$ -> PAGE$BUF );

  12299  2 000434   200230 235100                    LDA     PBSIZEC,,AUTO
         2 000435   000020 735000                    ALS     16
         2 000436   000140 135007                    SBLA    96,DL
         2 000437   000000 236000 xsym               LDQ     DD_RUMNODE$
         2 000440   200446 757100                    STAQ    FPTREAD+4,,AUTO

      355    12300    2             FPTREAD.V.DCB# = S_D.RUMDCB;

  12300  2 000441   000000 470400 xsym               LDP0    S_D$
         2 000442   004776 720100                    LXL0    2558,,PR0
         2 000443   200452 740100                    STX0    FPTREAD+8,,AUTO

      356    12301    2             FPTREAD.V.KEYS# = %NO#;

  12301  2 000444   000020 236000 3                  LDQ     16
         2 000445   200452 356100                    ANSQ    FPTREAD+8,,AUTO

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:63   
      357    12302    2             FPTWRITE = FPT_WRITE;

  12302  2 000446   000100 100400                    MLR     fill='000'O
         2 000447   000274 000060 1                  ADSC9   FPT_WRITE                cn=0,n=48
         2 000450   200526 000060                    ADSC9   FPTWRITE,,AUTO           cn=0,n=48

      358    12303    2             FPTWRITE.V_ = VECTOR( FPTWRITE.V );

  12303  2 000451   000000 235000 3                  LDA     0
         2 000452   200622 452500                    STP2    DEFI+2,,AUTO
         2 000453   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000454   000536 036003                    ADLQ    350,DU
         2 000455   200526 757100                    STAQ    FPTWRITE,,AUTO

      359    12304    2             FPTWRITE.KEY_ = FPTREAD.KEY_;

  12304  2 000456   200444 237100                    LDAQ    FPTREAD+2,,AUTO
         2 000457   200530 757100                    STAQ    FPTWRITE+2,,AUTO

      360    12305    2             FPTWRITE.V.DCB# = COPYDCB;

  12305  2 000460   200231 721100                    LXL1    COPYDCB,,AUTO
         2 000461   200536 741100                    STX1    FPTWRITE+8,,AUTO

      361    12306    2             S_D.OUTPUT = '..Copying (BREAK to abort)';

  12306  2 000462   040100 100400                    MLR     fill='040'O
         2 000463   000344 000032 1                  ADSC9   VLP_FID_SN+6             cn=0,n=26
         2 000464   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      362    12307    2             BUF$ = ADDR( S_D.OUTPUT );

  12307  2 000465   000000 236000 xsym               LDQ     S_D$
         2 000466   005335 036003                    ADLQ    2781,DU
         2 000467   200207 756100                    STQ     BUF$,,AUTO

      363    12308    2             SIZE = LENGTHC( '..Copying (BREAK to abort)' );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:64   

  12308  2 000470   000032 235007                    LDA     26,DL
         2 000471   200206 755100                    STA     SIZE,,AUTO

      364    12309    2             CALL DDQ$WRITE( BUF$, SIZE );

  12309  2 000472   200206 631500                    EPPR1   SIZE,,AUTO
         2 000473   200623 451500                    STP1    DEFI+3,,AUTO
         2 000474   200207 633500                    EPPR3   BUF$,,AUTO
         2 000475   200622 453500                    STP3    DEFI+2,,AUTO
         2 000476   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 000477   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000500   000000 701000 xent               TSX1    DDQ$WRITE
         2 000501   000000 011000                    NOP     0

      365    12310    3             DO WHILE ( '1'B );

      366    12311    3                  CALL DDB$BREAK ALTRET( COPY_BREAK );

  12311  2 000502   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000503   000000 701000 xent               TSX1    DDB$BREAK
         2 000504   002074 702000 2                  TSX2    COPY_BREAK

      367    12312    3                  CALL M$READ( FPTREAD ) ALTRET( ARETRC );

  12312  2 000505   200442 630500                    EPPR0   FPTREAD,,AUTO
         2 000506   440000 713400                    CLIMB   alt,read
         2 000507   401400 401760                    pmme    nvectors=4
         2 000510   000515 702000 2                  TSX2    ARETRC

      368    12313    3                  FPTREAD.V.DVBYTE.CONT# = %NO#;

  12313  2 000511   000021 236000 3                  LDQ     17
         2 000512   200455 356100                    ANSQ    FPTREAD+11,,AUTO

      369    12314    3                  FPTWRITE.V.DVBYTE.CONT# = %NO#;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:65   
  12314  2 000513   200541 356100                    ANSQ    FPTWRITE+11,,AUTO

      370    12315    4                  DO WHILE ( '0'B );

  12315  2 000514   000534 710000 2                  TRA     s:12326

      371    12316    4   ARETRC:             CODE = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE;

  12316  2 000515   000000 470400 xsym  ARETRC       LDP0    B$TCB$
         2 000516   000000 471500                    LDP1    0,,PR0
         2 000517   100102 236100                    LDQ     66,,PR1
         2 000520   000003 772000                    QRL     3
         2 000521   037777 376007                    ANQ     16383,DL
         2 000522   200227 756100                    STQ     CODE,,AUTO

      372    12317    4                       IF CODE = %E$LD

  12317  2 000523   000007 116007                    CMPQ    7,DL
         2 000524   000531 601000 2                  TNZ     s:12322

      373    12318    5                       THEN DO;

      374    12319    5                            FPTREAD.V.DVBYTE.CONT# = %YES#;

  12319  2 000525   001000 236003                    LDQ     512,DU
         2 000526   200455 256100                    ORSQ    FPTREAD+11,,AUTO

      375    12320    5                            FPTWRITE.V.DVBYTE.CONT# = %YES#;

  12320  2 000527   200541 256100                    ORSQ    FPTWRITE+11,,AUTO

      376    12321    5                          END;

  12321  2 000530   000534 710000 2                  TRA     s:12326

      377    12322    4                       ELSE IF CODE = %E$EOF

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:66   
  12322  2 000531   000006 116007                    CMPQ    6,DL
         2 000532   000554 600000 2                  TZE     COPY_CLOSE

      378    12323    4                            THEN GOTO COPY_CLOSE;
      379    12324    4                            ELSE GOTO COPY_ERROR;

  12324  2 000533   002071 710000 2                  TRA     COPY_ERROR

      380    12325    4                     END;

      381    12326    3                  PBSIZEC = DCB$ -> F$DCB.ARS#;

  12326  2 000534   200210 470500                    LDP0    DCB$,,AUTO
         2 000535   000000 235100                    LDA     0,,PR0
         2 000536   200230 755100                    STA     PBSIZEC,,AUTO

      382    12327    3                  IF PBSIZEC <= 0

  12327  2 000537   000543 605400 2                  TPNZ    s:12329

      383    12328    3                  THEN FPTWRITE.BUF_ = VECTOR( NIL );

  12328  2 000540   000014 237000 3                  LDAQ    12
         2 000541   200532 757100                    STAQ    FPTWRITE+4,,AUTO
         2 000542   000547 710000 2                  TRA     s:12330

      384    12329    3                  ELSE FPTWRITE.BUF_ = VECTOR( DD_RUMNODE$ -> PAGE$BUF );

  12329  2 000543   000020 735000                    ALS     16
         2 000544   000140 135007                    SBLA    96,DL
         2 000545   000000 236000 xsym               LDQ     DD_RUMNODE$
         2 000546   200532 757100                    STAQ    FPTWRITE+4,,AUTO

      385    12330    3                  CALL M$WRITE( FPTWRITE ) ALTRET( COPY_ERROR );

  12330  2 000547   200526 630500                    EPPR0   FPTWRITE,,AUTO
         2 000550   440001 713400                    CLIMB   alt,write
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:67   
         2 000551   401400 401760                    pmme    nvectors=4
         2 000552   002071 702000 2                  TSX2    COPY_ERROR

      386    12331    3                END;

  12331  2 000553   000502 710000 2                  TRA     s:12311

  12325  2 000554                       COPY_CLOSE   null
      387    12332    2   COPY_CLOSE: ;
      388    12333    2             FPTCLOSE = FPT_CLOSE;

  12333  2 000554   000100 100400                    MLR     fill='000'O
         2 000555   000166 000170 1                  ADSC9   FPT_CLOSE                cn=0,n=120
         2 000556   200240 000170                    ADSC9   FPTCLOSE,,AUTO           cn=0,n=120

      389    12334    2             FPTCLOSE.V_ = VECTOR( FPTCLOSE.V );

  12334  2 000557   000000 235000 3                  LDA     0
         2 000560   200622 452500                    STP2    DEFI+2,,AUTO
         2 000561   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000562   000272 036003                    ADLQ    186,DU
         2 000563   200240 757100                    STAQ    FPTCLOSE,,AUTO

      390    12335    2             FPTCLOSE.V.DCB# = S_D.RUMDCB;

  12335  2 000564   000000 471400 xsym               LDP1    S_D$
         2 000565   104776 720100                    LXL0    2558,,PR1
         2 000566   200272 740100                    STX0    FPTCLOSE+26,,AUTO

      391    12336    2             CALL M$CLOSE( FPTCLOSE ) ALTRET( ARETCC );

  12336  2 000567   200240 630500                    EPPR0   FPTCLOSE,,AUTO
         2 000570   450001 713400                    CLIMB   alt,close
         2 000571   406000 401760                    pmme    nvectors=13
         2 000572   000574 702000 2                  TSX2    ARETCC

      392    12337    3             DO WHILE( '0'B );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:68   

  12337  2 000573   000577 710000 2                  TRA     s:12340

      393    12338    3   ARETCC:        CALL DUE$ERRMSG;

  12338  2 000574   000002 631400 xsym  ARETCC       EPPR1   B_VECTNIL+2
         2 000575   000000 701000 xent               TSX1    DUE$ERRMSG
         2 000576   000000 011000                    NOP     0

      394    12339    3                END;

      395    12340    2             FPTRELDCB = FPT_RELDCB;

  12340  2 000577   000100 100400                    MLR     fill='000'O
         2 000600   000224 000020 1                  ADSC9   FPT_RELDCB               cn=0,n=16
         2 000601   200460 000020                    ADSC9   FPTRELDCB,,AUTO          cn=0,n=16

      396    12341    2             FPTRELDCB.V_ = VECTOR( FPTRELDCB.V );

  12341  2 000602   000003 235000 3                  LDA     3
         2 000603   200622 452500                    STP2    DEFI+2,,AUTO
         2 000604   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000605   000462 036003                    ADLQ    306,DU
         2 000606   200460 757100                    STAQ    FPTRELDCB,,AUTO

      397    12342    2             FPTRELDCB.V.DCB# = S_D.RUMDCB;

  12342  2 000607   000000 470400 xsym               LDP0    S_D$
         2 000610   004776 720100                    LXL0    2558,,PR0
         2 000611   200462 740100                    STX0    FPTRELDCB+2,,AUTO

      398    12343    2             CALL M$RELDCB( FPTRELDCB ) ALTRET( ARETRERC );

  12343  2 000612   200460 630500                    EPPR0   FPTRELDCB,,AUTO
         2 000613   460003 713400                    CLIMB   alt,+24579
         2 000614   400000 401760                    pmme    nvectors=1
         2 000615   000617 702000 2                  TSX2    ARETRERC
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:69   

      399    12344    3             DO WHILE ( '0'B );

  12344  2 000616   000622 710000 2                  TRA     s:12347

      400    12345    3   ARETRERC:      CALL DUE$ERRMSG;

  12345  2 000617   000002 631400 xsym  ARETRERC     EPPR1   B_VECTNIL+2
         2 000620   000000 701000 xent               TSX1    DUE$ERRMSG
         2 000621   000000 011000                    NOP     0

      401    12346    3                END;

      402    12347    2             S_D.RUMDCB = COPYDCB;

  12347  2 000622   000000 470400 xsym               LDP0    S_D$
         2 000623   200231 235100                    LDA     COPYDCB,,AUTO
         2 000624   004776 755100                    STA     2558,,PR0

      403    12348    2             S_D.LMDCB = COPYDCB;

  12348  2 000625   004774 755100                    STA     2556,,PR0

      404    12349    2             DCB$ = DCBADDR( COPYDCB );

  12349  2 000626   000012 471400 3                  LDP1    10
         2 000627   100000 473500                    LDP3    0,,PR1
         2 000630   300000 236105                    LDQ     0,AL,PR3
         2 000631   200210 756100                    STQ     DCB$,,AUTO

      405    12350    2           END;

  12344  2 000632                       RUM2         null
      406    12351    1   RUM2: ;
      407    12352        /* Do a little bookkeeping */
      408    12353    1        S_D.RUM_BIRTH$ = DD_RUMNODE$;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:70   
  12353  2 000632   000000 236000 xsym               LDQ     DD_RUMNODE$
         2 000633   000000 470400 xsym               LDP0    S_D$
         2 000634   000502 756100                    STQ     322,,PR0

      409    12354    1        S_D.RUM_HEAD$ = PINCRW( S_D.RUM_BIRTH$, SIZEW( B$RUBIRTH ) );

  12354  2 000635   000003 036003                    ADLQ    3,DU
         2 000636   005001 756100                    STQ     2561,,PR0

      410    12355    1        USED = SIZEW( B$RUBIRTH ) + SIZEW( B$HEAD );

  12355  2 000637   000053 235007                    LDA     43,DL
         2 000640   200226 755100                    STA     USED,,AUTO

      411    12356        /* Read head record */
      412    12357    1        ARS = 0;                           /* Positive */

  12357  2 000641   200222 450100                    STZ     ARS,,AUTO

      413    12358    1        CALL DDQ$READLM( %TYPHEAD, 0 /*@PAGE*/, 0 /*@NODE*/, S_D.RUM_HEAD$, SIZEC(
             12358                 B$HEAD ), ARS ) ALTRET( NOHEAD );

  12358  2 000642   200222 631500                    EPPR1   ARS,,AUTO
         2 000643   200627 451500                    STP1    DEFI+7,,AUTO
         2 000644   000023 236000 3                  LDQ     19
         2 000645   200626 756100                    STQ     DEFI+6,,AUTO
         2 000646   000000 236000 xsym               LDQ     S_D$
         2 000647   005001 036003                    ADLQ    2561,DU
         2 000650   000024 235000 3                  LDA     20
         2 000651   200624 757100                    STAQ    DEFI+4,,AUTO
         2 000652   000026 237000 3                  LDAQ    22
         2 000653   200622 757100                    STAQ    DEFI+2,,AUTO
         2 000654   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 000655   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000656   000000 701000 xent               TSX1    DDQ$READLM
         2 000657   002151 702000 2                  TSX2    NORU1

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:71   
      414    12359    1        IF ARS ~= SIZEC(B$HEAD)

  12359  2 000660   200222 235100                    LDA     ARS,,AUTO
         2 000661   000240 115007                    CMPA    160,DL
         2 000662   002151 601000 2                  TNZ     NORU1

      415    12360    1        THEN GOTO NOHEAD;
      416    12361    2        DO CASE( S_D.RUM_HEAD$ -> B$HEAD.FLAVOR );

  12361  2 000663   000000 470400 xsym               LDP0    S_D$
         2 000664   005001 471500                    LDP1    2561,,PR0
         2 000665   100022 236100                    LDQ     18,,PR1
         2 000666   000033 772000                    QRL     27
         2 000667   000003 116007                    CMPQ    3,DL
         2 000670   000672 602006 2                  TNC     s:12361+7,QL
         2 000671   000705 710000 2                  TRA     s:12367
         2 000672   000705 710000 2                  TRA     s:12367
         2 000673   000675 710000 2                  TRA     s:12363
         2 000674   000701 710000 2                  TRA     s:12365

      417    12362    2          CASE( %HOST_RU );

      418    12363    2             CALL DUI$INIT_HOST;

  12363  2 000675   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000676   000000 701000 xent               TSX1    DUI$INIT_HOST
         2 000677   000000 011000                    NOP     0
         2 000700   000710 710000 2                  TRA     s:12371

      419    12364    2          CASE( %FEP_RU );

      420    12365    2             CALL DUI$INIT_L6;

  12365  2 000701   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000702   000000 701000 xent               TSX1    DUI$INIT_L6
         2 000703   000000 011000                    NOP     0
         2 000704   000710 710000 2                  TRA     s:12371
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:72   

      421    12366    2          CASE( ELSE );

      422    12367    2             S_D.ERROR = 273;  /* E@BADHEADRECORD */

  12367  2 000705   000421 235007                    LDA     273,DL
         2 000706   000013 755100                    STA     11,,PR0

      423    12368    2             GOTO KILL_IT;

  12368  2 000707   002217 710000 2                  TRA     KILL_IT

      424    12369    2          END;

      425    12370        /* Read BIRTH record into memory */
      426    12371    1        ARS = 0;                           /* Positive */

  12371  2 000710   200222 450100                    STZ     ARS,,AUTO

      427    12372    1        CALL DDQ$READLM( %TYPBIRTH, 0 /*@PAGE*/, 0 /*@NODE*/, S_D.RUM_BIRTH$, SIZEC(
             12372                 B$RUBIRTH ), ARS ) ALTRET( NOBIRTH );

  12372  2 000711   200222 630500                    EPPR0   ARS,,AUTO
         2 000712   200627 450500                    STP0    DEFI+7,,AUTO
         2 000713   000032 236000 3                  LDQ     26
         2 000714   200626 756100                    STQ     DEFI+6,,AUTO
         2 000715   000000 236000 xsym               LDQ     S_D$
         2 000716   000502 036003                    ADLQ    322,DU
         2 000717   000024 235000 3                  LDA     20
         2 000720   200624 757100                    STAQ    DEFI+4,,AUTO
         2 000721   000034 237000 3                  LDAQ    28
         2 000722   200622 757100                    STAQ    DEFI+2,,AUTO
         2 000723   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 000724   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 000725   000000 701000 xent               TSX1    DDQ$READLM
         2 000726   000730 702000 2                  TSX2    NOBIRTH

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:73   
      428    12373    2        DO WHILE ( '0'B );

  12373  2 000727   000740 710000 2                  TRA     s:12379

      429    12374    2   NOBIRTH:  S_D.RUM_BIRTH$ = ADDR( NIL );

  12374  2 000730   000001 236000 xsym  NOBIRTH      LDQ     B_VECTNIL+1
         2 000731   000000 470400 xsym               LDP0    S_D$
         2 000732   000502 756100                    STQ     322,,PR0

      430    12375    2             S_D.ERROR = 193;       /* E@NORBIRTH */

  12375  2 000733   000301 235007                    LDA     193,DL
         2 000734   000013 755100                    STA     11,,PR0

      431    12376    2             CALL DDE$ERROR;

  12376  2 000735   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000736   000000 701000 xent               TSX1    DDE$ERROR
         2 000737   000000 011000                    NOP     0

      432    12377    2           END;

      433    12378        /* Insure that UTS is ok */
      434    12379    1        IF S_D.DO$ -> RUM$CMD.GOTUTS

  12379  2 000740   000000 470400 xsym               LDP0    S_D$
         2 000741   000031 471500                    LDP1    25,,PR0
         2 000742   100001 234100                    SZN     1,,PR1
         2 000743   001012 605000 2                  TPL     s:12394

      435    12380    2        THEN DO;                           /* Must have valid UTS */

      436    12381    2             IF S_D.RUM_BIRTH$ = ADDR( NIL )

  12381  2 000744   000502 236100                    LDQ     322,,PR0
         2 000745   000001 116000 xsym               CMPQ    B_VECTNIL+1
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:74   
         2 000746   002200 600000 2                  TZE     UTSERR

      437    12382    2             THEN GOTO UTSERR;
      438    12383    3             ELSE DO;

      439    12384    3                  FPTTIME = FPT_LOCTIME;

  12384  2 000747   000100 100400                    MLR     fill='000'O
         2 000750   000230 000060 1                  ADSC9   FPT_LOCTIME              cn=0,n=48
         2 000751   200464 000060                    ADSC9   FPTTIME,,AUTO            cn=0,n=48

      440    12385    3                  FPTTIME.V_ = VECTOR( FPTTIME.V );

  12385  2 000752   000003 235000 3                  LDA     3
         2 000753   200622 452500                    STP2    DEFI+2,,AUTO
         2 000754   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000755   000476 036003                    ADLQ    318,DU
         2 000756   200464 757100                    STAQ    FPTTIME,,AUTO

      441    12386    3                  FPTTIME.DATE_ = VECTOR( S_D.DO$ -> RUM$CMD.LUTS.DATE );

  12386  2 000757   000031 471500                    LDP1    25,,PR0
         2 000760   000003 235000 3                  LDA     3
         2 000761   200622 451500                    STP1    DEFI+2,,AUTO
         2 000762   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000763   000002 036003                    ADLQ    2,DU
         2 000764   200466 757100                    STAQ    FPTTIME+2,,AUTO

      442    12387    3                  FPTTIME.TIME_ = VECTOR( S_D.DO$ -> RUM$CMD.LUTS.TIME );

  12387  2 000765   000031 471500                    LDP1    25,,PR0
         2 000766   000036 235000 3                  LDA     30
         2 000767   200622 451500                    STP1    DEFI+2,,AUTO
         2 000770   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000771   000037 036000 3                  ADLQ    31
         2 000772   200470 757100                    STAQ    FPTTIME+4,,AUTO

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:75   
      443    12388    3                  FPTTIME.TSTAMP_ = VECTOR( LASTUTS );

  12388  2 000773   777640 235007                    LDA     -96,DL
         2 000774   200622 452500                    STP2    DEFI+2,,AUTO
         2 000775   200622 236100                    LDQ     DEFI+2,,AUTO
         2 000776   000204 036003                    ADLQ    132,DU
         2 000777   200474 757100                    STAQ    FPTTIME+8,,AUTO

      444    12389    3                  CALL M$TIME( FPTTIME ) ALTRET( UTSERRE );

  12389  2 001000   200464 630500                    EPPR0   FPTTIME,,AUTO
         2 001001   420004 713400                    CLIMB   alt,+8196
         2 001002   402000 401760                    pmme    nvectors=5
         2 001003   002175 702000 2                  TSX2    UTSERRE

      445    12390    3                  IF S_D.RUM_BIRTH$ -> B$RUBIRTH.CREATE_UTS ~= LASTUTS

  12390  2 001004   000000 470400 xsym               LDP0    S_D$
         2 001005   000502 471500                    LDP1    322,,PR0
         2 001006   100000 236100                    LDQ     0,,PR1
         2 001007   200204 116100                    CMPQ    LASTUTS,,AUTO
         2 001010   002200 601000 2                  TNZ     UTSERR

      446    12391    3                  THEN GOTO UTSERR;
      447    12392    3                END;

      448    12393    2           END;

  12393  2 001011   001032 710000 2                  TRA     s:12401

      449    12394    1        ELSE IF S_D.DO$ -> RUM$CMD.NUTS

  12394  2 001012   100001 236100                    LDQ     1,,PR1
         2 001013   200000 316003                    CANQ    65536,DU
         2 001014   001016 600000 2                  TZE     s:12397

      450    12395    2             THEN DO;                      /* Nothing */
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:76   

      451    12396    2                END;

  12396  2 001015   001032 710000 2                  TRA     s:12401

      452    12397    1             ELSE IF DCB$ -> F$DCB.ACCT# = ':SYS' AND

  12397  2 001016   200210 473500                    LDP3    DCB$,,AUTO
         2 001017   040000 106500                    CMPC    fill='040'O
         2 001020   300020 000010                    ADSC9   16,,PR3                  cn=0,n=8
         2 001021   000353 000004 1                  ADSC9   VLP_FID_SN+13            cn=0,n=4
         2 001022   001032 601000 2                  TNZ     s:12401
         2 001023   300032 236100                    LDQ     26,,PR3
         2 001024   000777 376003                    ANQ     511,DU
         2 001025   000001 116003                    CMPQ    1,DU
         2 001026   002200 600000 2                  TZE     UTSERR
         2 001027   200227 235100                    LDA     CODE,,AUTO
         2 001030   000122 115007                    CMPA    82,DL
         2 001031   002200 600000 2                  TZE     UTSERR

      453    12398    1                    ( DCB$ -> F$DCB.FUN# = %UPDATE# OR CODE = 82 ) /* C@COPY */
      454    12399    1                  THEN GOTO UTSERR;
      455    12400        /* Get memory for program records and read-only-segment */
      456    12401    1        S_D.RCBC.CUR_SEQ = 0;

  12401  2 001032   000517 450100                    STZ     335,,PR0

      457    12402    1        IF S_D.DO$ -> RUM$CMD.BUFFERS = 0

  12402  2 001033   000031 471500                    LDP1    25,,PR0
         2 001034   100001 236100                    LDQ     1,,PR1
         2 001035   000777 316003                    CANQ    511,DU
         2 001036   001047 601000 2                  TNZ     s:12406

      458    12403    1        THEN IF S_D.GHOST1

  12403  2 001037   000605 234100                    SZN     389,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:77   
         2 001040   001044 605000 2                  TPL     s:12405

      459    12404    1             THEN NBUFS = 10;              /* Default if RUMing processors */

  12404  2 001041   000012 235007                    LDA     10,DL
         2 001042   200232 755100                    STA     NBUFS,,AUTO
         2 001043   001053 710000 2                  TRA     s:12407

      460    12405    1             ELSE NBUFS = 5;               /* Default for vanilla users */

  12405  2 001044   000005 235007                    LDA     5,DL
         2 001045   200232 755100                    STA     NBUFS,,AUTO
         2 001046   001053 710000 2                  TRA     s:12407

      461    12406    1        ELSE NBUFS = S_D.DO$ -> RUM$CMD.BUFFERS;

  12406  2 001047   100001 236100                    LDQ     1,,PR1
         2 001050   000022 772000                    QRL     18
         2 001051   000777 376007                    ANQ     511,DL
         2 001052   200232 756100                    STQ     NBUFS,,AUTO

      462    12407    1        S_D.RCBC.BUFSM1 = NBUFS - 1;

  12407  2 001053   200232 235100                    LDA     NBUFS,,AUTO
         2 001054   000001 135007                    SBLA    1,DL
         2 001055   000521 755100                    STA     337,,PR0

      463    12408    1        S_D.RCBC.BUFSIZE = S_D.RUM_HEAD$ -> B$HEAD.PRECSIZE;

  12408  2 001056   005001 473500                    LDP3    2561,,PR0
         2 001057   300006 236100                    LDQ     6,,PR3
         2 001060   000022 772000                    QRL     18
         2 001061   000520 756100                    STQ     336,,PR0

      464    12409    1        PROGBUF$ = PINCRW( S_D.RUM_HEAD$, SIZEW( B$HEAD ) );

  12409  2 001062   005001 236100                    LDQ     2561,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:78   
         2 001063   000050 036003                    ADLQ    40,DU
         2 001064   200233 756100                    STQ     PROGBUF$,,AUTO

      465    12410    2        DO IX = 0 TO S_D.RCBC.BUFSM1;

  12410  2 001065   200217 450100                    STZ     IX,,AUTO
         2 001066   001120 710000 2                  TRA     s:12418+3

      466    12411    2             S_D.RCBC.BUF$( IX ) = PROGBUF$;

  12411  2 001067   200233 236100                    LDQ     PROGBUF$,,AUTO
         2 001070   000000 470400 xsym               LDP0    S_D$
         2 001071   200217 720100                    LXL0    IX,,AUTO
         2 001072   000522 756110                    STQ     338,X0,PR0

      467    12412    2             PROGBUF$ = PINCRW( PROGBUF$, S_D.RCBC.BUFSIZE );

  12412  2 001073   000520 236100                    LDQ     336,,PR0
         2 001074   000022 736000                    QLS     18
         2 001075   200233 036100                    ADLQ    PROGBUF$,,AUTO
         2 001076   200233 756100                    STQ     PROGBUF$,,AUTO

      468    12413    2             S_D.RCBC.PAGE( IX ) = -1;

  12413  2 001077   000001 335007                    LCA     1,DL
         2 001100   000534 755110                    STA     348,X0,PR0

      469    12414    2             S_D.RCBC.SIZE( IX ) = -1;

  12414  2 001101   000546 755110                    STA     358,X0,PR0

      470    12415    2             S_D.RCBC.SEQ( IX ) = 0;

  12415  2 001102   000572 450110                    STZ     378,X0,PR0

      471    12416    2             S_D.RCBC.WRITTEN( IX ) = '0'B;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:79   
  12416  2 001103   200217 236100                    LDQ     IX,,AUTO
         2 001104   000022 402007                    MPY     18,DL
         2 001105   003106 060400                    CSL     bolr='003'O
         2 001106   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 001107   000560 000001                    BDSC    368,Q,PR0                by=0,bit=0,n=1

      472    12417    2             S_D.RCBC.NODE( IX ) = 0;

  12417  2 001110   200217 235100                    LDA     IX,,AUTO
         2 001111   000001 735000                    ALS     1
         2 001112   000105 101400                    MRL     fill='000'O
         2 001113   000002 000004 xsym               ADSC9   B_VECTNIL+2              cn=0,n=4
         2 001114   000565 000002                    ADSC9   373,A,PR0                cn=0,n=2

      473    12418    2           END;

  12418  2 001115   200217 235100                    LDA     IX,,AUTO
         2 001116   000001 035007                    ADLA    1,DL
         2 001117   200217 755100                    STA     IX,,AUTO
         2 001120   000521 236100                    LDQ     337,,PR0
         2 001121   200217 116100                    CMPQ    IX,,AUTO
         2 001122   001067 603000 2                  TRC     s:12411

      474    12419    1        ROSIZE = S_D.RUM_HEAD$ -> B$HEAD.ROSIZE;

  12419  2 001123   005001 471500                    LDP1    2561,,PR0
         2 001124   100010 236100                    LDQ     8,,PR1
         2 001125   777777 376007                    ANQ     -1,DL
         2 001126   200212 756100                    STQ     ROSIZE,,AUTO

      475    12420    1        IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  12420  2 001127   006714 235100                    LDA     3532,,PR0
         2 001130   000001 115007                    CMPA    1,DL
         2 001131   001140 601000 2                  TNZ     s:12425

      476    12421    1        THEN NEED = S_D.RCBC.BUFSIZE * NBUFS /* Buffers for program records */
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:80   

  12421  2 001132   000520 236100                    LDQ     336,,PR0
         2 001133   200232 402100                    MPY     NBUFS,,AUTO
         2 001134   200212 036100                    ADLQ    ROSIZE,,AUTO
         2 001135   000136 036007                    ADLQ    94,DL
         2 001136   200213 756100                    STQ     NEED,,AUTO
         2 001137   001156 710000 2                  TRA     s:12434

      477    12422    1               + SIZEW( B$ROSEG )          /* Read-only-segment header */
      478    12423    1               + %M$1STDCB#                /* Fixed dcb pointers */
      479    12424    1               + ROSIZE;                   /* Read-only-segment from RU */
      480    12425    1        ELSE IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %L6

  12425  2 001140   000002 115007                    CMPA    2,DL
         2 001141   001153 601000 2                  TNZ     s:12431

      481    12426    1             THEN NEED = S_D.RCBC.BUFSIZE * NBUFS /* Buffers for program records */

  12426  2 001142   000520 236100                    LDQ     336,,PR0
         2 001143   200232 402100                    MPY     NBUFS,,AUTO
         2 001144   200622 756100                    STQ     DEFI+2,,AUTO
         2 001145   200212 236100                    LDQ     ROSIZE,,AUTO
         2 001146   000001 772000                    QRL     1
         2 001147   200622 036100                    ADLQ    DEFI+2,,AUTO
         2 001150   000136 036007                    ADLQ    94,DL
         2 001151   200213 756100                    STQ     NEED,,AUTO
         2 001152   001156 710000 2                  TRA     s:12434

      482    12427    1                    + SIZEW( B$ROSEG )     /* Read-only-segment header */
      483    12428    1                    + %G_FRST_USR_DCB#     /* Fixed dcb pointers */
      484    12429    1                    + (ROSIZE / 2);        /* Read-only-segment from RU */
      485    12430    2             ELSE DO;

      486    12431    2                  S_D.ERROR = 502;    /* E@DELBUG */

  12431  2 001153   000766 235007                    LDA     502,DL
         2 001154   000013 755100                    STA     11,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:81   

      487    12432    2                  GOTO KILL_IT;

  12432  2 001155   002217 710000 2                  TRA     KILL_IT

      488    12433    2                END;
      489    12434    1        TOGET = ( 1024 /*@PSIZ*/ - USED ) - NEED;   /* To get = left - need */

  12434  2 001156   200226 036100                    ADLQ    USED,,AUTO
         2 001157   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 001160   002001 036007                    ADLQ    1025,DL
         2 001161   200214 756100                    STQ     TOGET,,AUTO

      490    12435    1        IF TOGET < 0

  12435  2 001162   001205 605000 2                  TPL     s:12442

      491    12436    2        THEN DO;

      492    12437    2             TOGET = ( ( -TOGET + 1024 /*@PSIZ*/ -1 ) / 1024 /*@PSIZ*/ ) * 1024
             12437                      /*@PSIZ*/;

  12437  2 001163   000027 676000 xsym               ERQ     B_VECTNIL+23
         2 001164   002000 036007                    ADLQ    1024,DL
         2 001165   002000 506007                    DIV     1024,DL
         2 001166   000012 736000                    QLS     10
         2 001167   200214 756100                    STQ     TOGET,,AUTO

      493    12438    2             CALL DDM$GETMEM( DD_RUMNODE$, TOGET ) ALTRET( NOMEM2 );

  12438  2 001170   200214 633500                    EPPR3   TOGET,,AUTO
         2 001171   200623 453500                    STP3    DEFI+3,,AUTO
         2 001172   000010 236000 3                  LDQ     8
         2 001173   200622 756100                    STQ     DEFI+2,,AUTO
         2 001174   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 001175   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001176   000000 701000 xent               TSX1    DDM$GETMEM
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:82   
         2 001177   002155 702000 2                  TSX2    NOMEM1

      494    12439    2             S_D.NODESEG_USED$ = PINCRW( S_D.NODESEG_USED$, TOGET );

  12439  2 001200   000000 470400 xsym               LDP0    S_D$
         2 001201   004771 471500                    LDP1    2553,,PR0
         2 001202   200214 720100                    LXL0    TOGET,,AUTO
         2 001203   100000 633510                    EPPR3   0,X0,PR1
         2 001204   004771 453500                    STP3    2553,,PR0

      495    12440    2           END;

      496    12441        /* Whew - got it */
      497    12442    1        S_D.NODESEG$ = PINCRW( S_D.RCBC.BUF$( 0 ), NEED );

  12442  2 001205   000522 471500                    LDP1    338,,PR0
         2 001206   200213 720100                    LXL0    NEED,,AUTO
         2 001207   100000 633510                    EPPR3   0,X0,PR1
         2 001210   005003 453500                    STP3    2563,,PR0

      498    12443    1        IF ROSIZE = 0

  12443  2 001211   200212 235100                    LDA     ROSIZE,,AUTO
         2 001212   001267 601000 2                  TNZ     s:12461

      499    12444    2        THEN DO;

      500    12445    2             S_D.B$ROS$ = ADDR( NIL );

  12445  2 001213   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001214   004775 756100                    STQ     2557,,PR0

      501    12446    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  12446  2 001215   006714 235100                    LDA     3532,,PR0
         2 001216   000001 115007                    CMPA    1,DL
         2 001217   001233 601000 2                  TNZ     s:12450
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:83   

      502    12447    2             THEN S_D.PADDR = ( S_D.RUM_HEAD$ -> B$HEAD.BIAS / 1024 /*@PSIZ*/ )

  12447  2 001220   005001 474500                    LDP4    2561,,PR0
         2 001221   400023 236100                    LDQ     19,,PR4
         2 001222   000040 376000 3                  ANQ     32
         2 001223   000012 772000                    QRL     10
         2 001224   200622 756100                    STQ     DEFI+2,,AUTO
         2 001225   400002 236100                    LDQ     2,,PR4
         2 001226   000014 772000                    QRL     12
         2 001227   000041 376000 3                  ANQ     33
         2 001230   200622 036100                    ADLQ    DEFI+2,,AUTO
         2 001231   004765 756100                    STQ     2549,,PR0
         2 001232   001731 710000 2                  TRA     s:12555

      503    12448    2                    + ( S_D.RUM_HEAD$ -> B$HEAD.VDPGS * 1024 /*@PSIZ*/ );
      504    12449    3             ELSE DO;

      505    12450    3                  IF S_D.RUM_HEAD$ -> B$HEAD.LIB

  12450  2 001233   005001 474500                    LDP4    2561,,PR0
         2 001234   400022 236100                    LDQ     18,,PR4
         2 001235   000200 316003                    CANQ    128,DU
         2 001236   001250 600000 2                  TZE     s:12454

      506    12451    3                  THEN IF S_D.RUM_HEAD$ -> B$HEAD.VERSION# = 0

  12451  2 001237   400011 236100                    LDQ     9,,PR4
         2 001240   777000 316003                    CANQ    -512,DU
         2 001241   001245 601000 2                  TNZ     s:12453

      507    12452    3                       THEN S_D.PADDR = %GM_ISR6_BASE;

  12452  2 001242   000042 235000 3                  LDA     34
         2 001243   004765 755100                    STA     2549,,PR0
         2 001244   001731 710000 2                  TRA     s:12555

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:84   
      508    12453    3                       ELSE S_D.PADDR = %GM_LIBIS1_BASE;

  12453  2 001245   000043 235000 3                  LDA     35
         2 001246   004765 755100                    STA     2549,,PR0
         2 001247   001731 710000 2                  TRA     s:12555

      509    12454    3                  ELSE IF S_D.RUM_HEAD$ -> B$HEAD.RDATA = 0

  12454  2 001250   400002 236100                    LDQ     2,,PR4
         2 001251   000040 316000 3                  CANQ    32
         2 001252   001257 601000 2                  TNZ     s:12456

      510    12455    3                       THEN S_D.PADDR = S_D.RUM_HEAD$ -> B$HEAD.BIAS;

  12455  2 001253   400023 236100                    LDQ     19,,PR4
         2 001254   000040 376000 3                  ANQ     32
         2 001255   004765 756100                    STQ     2549,,PR0
         2 001256   001731 710000 2                  TRA     s:12555

      511    12456    3                       ELSE S_D.PADDR = (((S_D.RUM_HEAD$ -> B$HEAD.RDATA + BITBIN(
             12456                                '277777'O))

  12456  2 001257   400002 236100                    LDQ     2,,PR4
         2 001260   000040 376000 3                  ANQ     32
         2 001261   277777 036007                    ADLQ    98303,DL
         2 001262   000020 772000                    QRL     16
         2 001263   000020 736000                    QLS     16
         2 001264   200000 036007                    ADLQ    65536,DL
         2 001265   004765 756100                    STQ     2549,,PR0

      512    12457    3                              / BITBIN('200000'O)) * BITBIN('200000'O)) + BITBIN(
             12457                                       '200000'O);
      513    12458    3                END;

      514    12459    2           END;

  12459  2 001266   001731 710000 2                  TRA     s:12555
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:85   

      515    12460    2        ELSE DO;

      516    12461    2             IF S_D.ONE_TO_TWO.EXEC_DOMAIN = %HOST

  12461  2 001267   006714 235100                    LDA     3532,,PR0
         2 001270   000001 115007                    CMPA    1,DL
         2 001271   001516 601000 2                  TNZ     s:12511

      517    12462    3             THEN DO;

      518    12463                                                /* Build pointers to system dcbs */
      519    12464    3                  S_D.RUM_ROS$ = PROGBUF$;

  12464  2 001272   200233 236100                    LDQ     PROGBUF$,,AUTO
         2 001273   005002 756100                    STQ     2562,,PR0

      520    12465    3                  S_D.B$ROS$ = S_D.RUM_ROS$;

  12465  2 001274   004775 756100                    STQ     2557,,PR0

      521    12466    3                  DCBPTR$ = PINCRW( S_D.B$ROS$, SIZEW( B$ROSEG ) );

  12466  2 001275   000124 036003                    ADLQ    84,DU
         2 001276   200220 756100                    STQ     DCBPTR$,,AUTO

      522    12467    3                  S_D.B$ROS$ -> B$ROSEG.DCBPTR$ = DCBPTR$;

  12467  2 001277   004775 474500                    LDP4    2557,,PR0
         2 001300   400000 756100                    STQ     0,,PR4

      523    12468    4                  DO IX = 1 TO %M$1STDCB#;

  12468  2 001301   000001 235007                    LDA     1,DL
         2 001302   200217 755100                    STA     IX,,AUTO

      524    12469    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:86   

  12469  2 001303   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001304   200220 470500                    LDP0    DCBPTR$,,AUTO
         2 001305   000000 756100                    STQ     0,,PR0

      525    12470    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );

  12470  2 001306   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001307   000001 036003                    ADLQ    1,DU
         2 001310   200220 756100                    STQ     DCBPTR$,,AUTO

      526    12471    4                     END;

  12471  2 001311   200217 235100                    LDA     IX,,AUTO
         2 001312   000001 035007                    ADLA    1,DL
         2 001313   200217 755100                    STA     IX,,AUTO
         2 001314   000013 115007                    CMPA    11,DL
         2 001315   001303 602000 2                  TNC     s:12469

      527    12472                                      /* Read read-only-segment from RU into memory */
      528    12473    3                  TOGET = ROSIZE * SIZEC( ROSIZE );

  12473  2 001316   200212 235100                    LDA     ROSIZE,,AUTO
         2 001317   000002 735000                    ALS     2
         2 001320   200214 755100                    STA     TOGET,,AUTO

      529    12474    3                  PAGE = 0;

  12474  2 001321   200223 450100                    STZ     PAGE,,AUTO

      530    12475    3                  ARS = 0;

  12475  2 001322   200222 450100                    STZ     ARS,,AUTO

      531    12476    3                  TEMP$ = DCBPTR$;

  12476  2 001323   200215 756100                    STQ     TEMP$,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:87   

      532    12477    4                  DO WHILE ( TOGET > 0 );

  12477  2 001324   001362 604400 2                  TMOZ    s:12484

      533    12478    4                      CALL DDQ$READLM( %TYPROS, PAGE, 0 /*@NODE*/, TEMP$, TOGET, ARS )
             12478                                ALTRET( NOROS );

  12478  2 001325   200222 630500                    EPPR0   ARS,,AUTO
         2 001326   200627 450500                    STP0    DEFI+7,,AUTO
         2 001327   200214 631500                    EPPR1   TOGET,,AUTO
         2 001330   200626 451500                    STP1    DEFI+6,,AUTO
         2 001331   200215 633500                    EPPR3   TEMP$,,AUTO
         2 001332   200625 453500                    STP3    DEFI+5,,AUTO
         2 001333   000024 236000 3                  LDQ     20
         2 001334   200624 756100                    STQ     DEFI+4,,AUTO
         2 001335   200223 634500                    EPPR4   PAGE,,AUTO
         2 001336   200623 454500                    STP4    DEFI+3,,AUTO
         2 001337   000045 236000 3                  LDQ     37
         2 001340   200622 756100                    STQ     DEFI+2,,AUTO
         2 001341   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 001342   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001343   000000 701000 xent               TSX1    DDQ$READLM
         2 001344   002161 702000 2                  TSX2    NOROS

      534    12479    4                       PAGE = PAGE + S_D.RCBC.BUFSIZE;

  12479  2 001345   000000 470400 xsym               LDP0    S_D$
         2 001346   200223 236100                    LDQ     PAGE,,AUTO
         2 001347   000520 036100                    ADLQ    336,,PR0
         2 001350   200223 756100                    STQ     PAGE,,AUTO

      535    12480    4                       TOGET = TOGET - ARS;

  12480  2 001351   200214 236100                    LDQ     TOGET,,AUTO
         2 001352   200222 136100                    SBLQ    ARS,,AUTO
         2 001353   200214 756100                    STQ     TOGET,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:88   

      536    12481    4                       TEMP$ = PINCRC( TEMP$, ARS );

  12481  2 001354   200222 236100                    LDQ     ARS,,AUTO
         2 001355   000020 736000                    QLS     16
         2 001356   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001357   200215 756100                    STQ     TEMP$,,AUTO

      537    12482    4                     END;

  12482  2 001360   200214 235100                    LDA     TOGET,,AUTO
         2 001361   001325 605400 2                  TPNZ    s:12478

      538    12483                                           /* Setup pointers to user defined dcbs */
      539    12484    3                  TOGET = S_D.RUM_HEAD$ -> B$HEAD.UDCBNUM;

  12484  2 001362   000000 470400 xsym               LDP0    S_D$
         2 001363   005001 471500                    LDP1    2561,,PR0
         2 001364   100004 236100                    LDQ     4,,PR1
         2 001365   000022 772000                    QRL     18
         2 001366   200214 756100                    STQ     TOGET,,AUTO

      540    12485    3                  DCBRES = S_D.RUM_HEAD$ -> B$HEAD.DCBRES;

  12485  2 001367   100004 236100                    LDQ     4,,PR1
         2 001370   777777 376007                    ANQ     -1,DL
         2 001371   200225 756100                    STQ     DCBRES,,AUTO

      541    12486    3                  S_D.B$ROS$ -> B$ROSEG.NUMDCBS = %M$1STDCB# - 1 + TOGET + DCBRES;

  12486  2 001372   004775 473500                    LDP3    2557,,PR0
         2 001373   200214 036100                    ADLQ    TOGET,,AUTO
         2 001374   000011 620006                    EAX0    9,QL
         2 001375   300002 740100                    STX0    2,,PR3

      542    12487    3                  TEMP$ = DCBPTR$;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:89   
  12487  2 001376   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001377   200215 756100                    STQ     TEMP$,,AUTO

      543    12488    4                  DO IX = 1 TO TOGET;

  12488  2 001400   000001 235007                    LDA     1,DL
         2 001401   200217 755100                    STA     IX,,AUTO
         2 001402   001416 710000 2                  TRA     s:12491+3

      544    12489    4                       DCBPTR$ -> DCB$PTR$ = PINCRW( TEMP$, DCBPTR$ -> PTR$WORD.LH );

  12489  2 001403   200220 470500                    LDP0    DCBPTR$,,AUTO
         2 001404   000000 220100                    LDX0    0,,PR0
         2 001405   000000 636010                    EAQ     0,X0
         2 001406   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001407   000000 756100                    STQ     0,,PR0

      545    12490    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );

  12490  2 001410   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001411   000001 036003                    ADLQ    1,DU
         2 001412   200220 756100                    STQ     DCBPTR$,,AUTO

      546    12491    4                     END;

  12491  2 001413   200217 235100                    LDA     IX,,AUTO
         2 001414   000001 035007                    ADLA    1,DL
         2 001415   200217 755100                    STA     IX,,AUTO
         2 001416   200217 236100                    LDQ     IX,,AUTO
         2 001417   001422 604000 2                  TMI     s:12492
         2 001420   200214 116100                    CMPQ    TOGET,,AUTO
         2 001421   001403 604400 2                  TMOZ    s:12489

      547    12492    4                  DO IX = 1 TO DCBRES;

  12492  2 001422   000001 235007                    LDA     1,DL
         2 001423   200217 755100                    STA     IX,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:90   
         2 001424   001436 710000 2                  TRA     s:12495+3

      548    12493    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );

  12493  2 001425   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001426   200220 470500                    LDP0    DCBPTR$,,AUTO
         2 001427   000000 756100                    STQ     0,,PR0

      549    12494    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCBPTR$ ) );

  12494  2 001430   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001431   000001 036003                    ADLQ    1,DU
         2 001432   200220 756100                    STQ     DCBPTR$,,AUTO

      550    12495    4                     END;

  12495  2 001433   200217 235100                    LDA     IX,,AUTO
         2 001434   000001 035007                    ADLA    1,DL
         2 001435   200217 755100                    STA     IX,,AUTO
         2 001436   200225 236100                    LDQ     DCBRES,,AUTO
         2 001437   200217 116100                    CMPQ    IX,,AUTO
         2 001440   001425 603000 2                  TRC     s:12493

      551    12496                                                /* Setup tree table pointers */
      552    12497    3                  TEMP$ = PINCRW( TEMP$, S_D.RUM_HEAD$ -> B$HEAD.TREEDISP );

  12497  2 001441   000000 470400 xsym               LDP0    S_D$
         2 001442   005001 471500                    LDP1    2561,,PR0
         2 001443   100005 220100                    LDX0    5,,PR1
         2 001444   000000 636010                    EAQ     0,X0
         2 001445   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001446   200215 756100                    STQ     TEMP$,,AUTO

      553    12498    3                  IF S_D.RUM_HEAD$ -> B$HEAD.OVRL

  12498  2 001447   100022 236100                    LDQ     18,,PR1
         2 001450   000010 316003                    CANQ    8,DU
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:91   
         2 001451   001456 600000 2                  TZE     s:12500

      554    12499    3                  THEN S_D.B$ROS$ -> B$ROSEG.TREE$ = TEMP$;

  12499  2 001452   004775 473500                    LDP3    2557,,PR0
         2 001453   200215 236100                    LDQ     TEMP$,,AUTO
         2 001454   300001 756100                    STQ     1,,PR3
         2 001455   001461 710000 2                  TRA     s:12501

      555    12500    3                  ELSE S_D.B$ROS$ -> B$ROSEG.TREE$ = ADDR( NIL );

  12500  2 001456   004775 473500                    LDP3    2557,,PR0
         2 001457   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001460   300001 756100                    STQ     1,,PR3

      556    12501    3                  TEMP1$ = PINCRW( TEMP$, SIZEW( B$TREEHDR ) );

  12501  2 001461   200215 236100                    LDQ     TEMP$,,AUTO
         2 001462   000003 036003                    ADLQ    3,DU
         2 001463   200216 756100                    STQ     TEMP1$,,AUTO

      557    12502    3                  TEMP1$ -> B$NODE.FLGS.NOW_IN( 0 ) = '1'B; /* Root as in */

  12502  2 001464   200216 471500                    LDP1    TEMP1$,,AUTO
         2 001465   400000 236003                    LDQ     -131072,DU
         2 001466   100001 256100                    ORSQ    1,,PR1

      558    12503    3                  S_D.PADDR = TEMP1$ -> B$NODE.PADDR( 0 );

  12503  2 001467   100003 236100                    LDQ     3,,PR1
         2 001470   000022 772000                    QRL     18
         2 001471   004765 756100                    STQ     2549,,PR0

      559    12504    4                  DO IX = 0 TO TEMP$ -> B$TREEHDR.NODES - 1;

  12504  2 001472   200217 450100                    STZ     IX,,AUTO
         2 001473   001507 710000 2                  TRA     s:12507+3
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:92   

      560    12505    4                      TEMP1$ -> B$NODE.NAME$( 0 ) = PINCRW( TEMP$, TEMP1$ -> PTR$WORD.
             12505                                LH );

  12505  2 001474   200216 470500                    LDP0    TEMP1$,,AUTO
         2 001475   000000 220100                    LDX0    0,,PR0
         2 001476   000000 636010                    EAQ     0,X0
         2 001477   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001500   000000 756100                    STQ     0,,PR0

      561    12506    4                       TEMP1$ = PINCRW( TEMP1$, SIZEW( B$NODE ) );

  12506  2 001501   200216 236100                    LDQ     TEMP1$,,AUTO
         2 001502   000006 036003                    ADLQ    6,DU
         2 001503   200216 756100                    STQ     TEMP1$,,AUTO

      562    12507    4                     END;

  12507  2 001504   200217 235100                    LDA     IX,,AUTO
         2 001505   000001 035007                    ADLA    1,DL
         2 001506   200217 755100                    STA     IX,,AUTO
         2 001507   200215 470500                    LDP0    TEMP$,,AUTO
         2 001510   000000 236100                    LDQ     0,,PR0
         2 001511   000022 772000                    QRL     18
         2 001512   200217 116100                    CMPQ    IX,,AUTO
         2 001513   001515 600000 2                  TZE     s:12508
         2 001514   001474 603000 2                  TRC     s:12505

      563    12508    3                END;

  12508  2 001515   001731 710000 2                  TRA     s:12555

      564    12509    3             ELSE DO;

      565    12510                                                /* Build pointers to system dcbs */
      566    12511    3                  S_D.RUM_ROS$ = PROGBUF$;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:93   
  12511  2 001516   200233 236100                    LDQ     PROGBUF$,,AUTO
         2 001517   005002 756100                    STQ     2562,,PR0

      567    12512    3                  S_D.B$ROS$ = S_D.RUM_ROS$;

  12512  2 001520   004775 756100                    STQ     2557,,PR0

      568    12513    3                  DCBPTR$ = PINCRW( S_D.B$ROS$, SIZEW( B$ROSEG ) );

  12513  2 001521   000124 036003                    ADLQ    84,DU
         2 001522   200220 756100                    STQ     DCBPTR$,,AUTO

      569    12514    3                  S_D.B$ROS$ -> B$ROSEG.DCBPTR$ = DCBPTR$;

  12514  2 001523   004775 474500                    LDP4    2557,,PR0
         2 001524   400000 756100                    STQ     0,,PR4

      570    12515    4                  DO IX = 1 TO %G_FRST_USR_DCB#;

  12515  2 001525   000001 235007                    LDA     1,DL
         2 001526   200217 755100                    STA     IX,,AUTO

      571    12516    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );

  12516  2 001527   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001530   200220 470500                    LDP0    DCBPTR$,,AUTO
         2 001531   000000 756100                    STQ     0,,PR0

      572    12517    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );

  12517  2 001532   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001533   000001 036003                    ADLQ    1,DU
         2 001534   200220 756100                    STQ     DCBPTR$,,AUTO

      573    12518    4                     END;

  12518  2 001535   200217 235100                    LDA     IX,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:94   
         2 001536   000001 035007                    ADLA    1,DL
         2 001537   200217 755100                    STA     IX,,AUTO
         2 001540   000013 115007                    CMPA    11,DL
         2 001541   001527 602000 2                  TNC     s:12516

      574    12519                                      /* Read read-only-segment from RU into memory */
      575    12520    3                  TOGET = (ROSIZE * 2);

  12520  2 001542   200212 235100                    LDA     ROSIZE,,AUTO
         2 001543   000001 735000                    ALS     1
         2 001544   200214 755100                    STA     TOGET,,AUTO

      576    12521    3                  PAGE = BITBIN('1000'X);

  12521  2 001545   010000 235007                    LDA     4096,DL
         2 001546   200223 755100                    STA     PAGE,,AUTO

      577    12522    3                  ARS = 0;

  12522  2 001547   200222 450100                    STZ     ARS,,AUTO

      578    12523    3                  TEMP$ = DCBPTR$;

  12523  2 001550   200215 756100                    STQ     TEMP$,,AUTO

      579    12524    4                  DO WHILE ( TOGET > 0 );

  12524  2 001551   200214 235100                    LDA     TOGET,,AUTO
         2 001552   001607 604400 2                  TMOZ    s:12531

      580    12525    4                       CALL DDQ$READLM( %TYPPROG, PAGE, 0 /*@NODE*/, TEMP$, TOGET, ARS
             12525                                ) ALTRET( NOROS );

  12525  2 001553   200222 630500                    EPPR0   ARS,,AUTO
         2 001554   200627 450500                    STP0    DEFI+7,,AUTO
         2 001555   200214 631500                    EPPR1   TOGET,,AUTO
         2 001556   200626 451500                    STP1    DEFI+6,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:95   
         2 001557   200215 633500                    EPPR3   TEMP$,,AUTO
         2 001560   200625 453500                    STP3    DEFI+5,,AUTO
         2 001561   000024 236000 3                  LDQ     20
         2 001562   200624 756100                    STQ     DEFI+4,,AUTO
         2 001563   200223 634500                    EPPR4   PAGE,,AUTO
         2 001564   200623 454500                    STP4    DEFI+3,,AUTO
         2 001565   000046 236000 3                  LDQ     38
         2 001566   200622 756100                    STQ     DEFI+2,,AUTO
         2 001567   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 001570   000024 631400 xsym               EPPR1   B_VECTNIL+20
         2 001571   000000 701000 xent               TSX1    DDQ$READLM
         2 001572   002161 702000 2                  TSX2    NOROS

      581    12526    4                       PAGE = PAGE + 2048;

  12526  2 001573   200223 235100                    LDA     PAGE,,AUTO
         2 001574   004000 035007                    ADLA    2048,DL
         2 001575   200223 755100                    STA     PAGE,,AUTO

      582    12527    4                       TOGET = TOGET - ARS;

  12527  2 001576   200214 236100                    LDQ     TOGET,,AUTO
         2 001577   200222 136100                    SBLQ    ARS,,AUTO
         2 001600   200214 756100                    STQ     TOGET,,AUTO

      583    12528    4                       TEMP$ = PINCRC( TEMP$, ARS );

  12528  2 001601   200222 236100                    LDQ     ARS,,AUTO
         2 001602   000020 736000                    QLS     16
         2 001603   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001604   200215 756100                    STQ     TEMP$,,AUTO

      584    12529    4                     END;

  12529  2 001605   200214 235100                    LDA     TOGET,,AUTO
         2 001606   001553 605400 2                  TPNZ    s:12525

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:96   
      585    12530                                           /* Setup pointers to user defined dcbs */
      586    12531    3                  TOGET = S_D.RUM_HEAD$ -> B$HEAD.UDCBNUM;

  12531  2 001607   000000 470400 xsym               LDP0    S_D$
         2 001610   005001 471500                    LDP1    2561,,PR0
         2 001611   100004 236100                    LDQ     4,,PR1
         2 001612   000022 772000                    QRL     18
         2 001613   200214 756100                    STQ     TOGET,,AUTO

      587    12532    3                  DCBRES = S_D.RUM_HEAD$ -> B$HEAD.DCBRES;

  12532  2 001614   100004 236100                    LDQ     4,,PR1
         2 001615   777777 376007                    ANQ     -1,DL
         2 001616   200225 756100                    STQ     DCBRES,,AUTO

      588    12533    3                 S_D.B$ROS$ -> B$ROSEG.NUMDCBS = %G_FRST_USR_DCB# - 1 + TOGET + DCBRES
             12533                           ;

  12533  2 001617   004775 473500                    LDP3    2557,,PR0
         2 001620   200214 036100                    ADLQ    TOGET,,AUTO
         2 001621   000011 620006                    EAX0    9,QL
         2 001622   300002 740100                    STX0    2,,PR3

      589    12534    3                  TEMP$ = DCBPTR$;

  12534  2 001623   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001624   200215 756100                    STQ     TEMP$,,AUTO

      590    12535    4                  DO IX = 1 TO TOGET;

  12535  2 001625   000001 235007                    LDA     1,DL
         2 001626   200217 755100                    STA     IX,,AUTO
         2 001627   001656 710000 2                  TRA     s:12541+3

      591    12536    4                       TEMPWORD = 0;

  12536  2 001630   200610 450100                    STZ     TEMP$WORD,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:97   

      592    12537    4                       TEMP$WORD.UBYTE = DCBPTR$ -> PTR$WORD.RHB.UBYTE;

  12537  2 001631   200220 470500                    LDP0    DCBPTR$,,AUTO
         2 001632   000000 236100                    LDQ     0,,PR0
         2 001633   000001 772000                    QRL     1
         2 001634   200610 676100                    ERQ     TEMP$WORD,,AUTO
         2 001635   177400 376007                    ANQ     65280,DL
         2 001636   200610 656100                    ERSQ    TEMP$WORD,,AUTO

      593    12538    4                       TEMP$WORD.LBYTE = DCBPTR$ -> PTR$WORD.RHB.LBYTE;

  12538  2 001637   000000 236100                    LDQ     0,,PR0
         2 001640   200610 676100                    ERQ     TEMP$WORD,,AUTO
         2 001641   000377 376007                    ANQ     255,DL
         2 001642   200610 656100                    ERSQ    TEMP$WORD,,AUTO

      594    12539    4                      DCBPTR$ -> DCB$PTR$ = PINCRC( TEMP$, (TEMPWORD - BITBIN('1000'X)
             12539                                ) * 2 );

  12539  2 001643   200610 236100                    LDQ     TEMP$WORD,,AUTO
         2 001644   000021 736000                    QLS     17
         2 001645   004000 136003                    SBLQ    2048,DU
         2 001646   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001647   000000 756100                    STQ     0,,PR0

      595    12540    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCB$PTR$ ) );

  12540  2 001650   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001651   000001 036003                    ADLQ    1,DU
         2 001652   200220 756100                    STQ     DCBPTR$,,AUTO

      596    12541    4                     END;

  12541  2 001653   200217 235100                    LDA     IX,,AUTO
         2 001654   000001 035007                    ADLA    1,DL
         2 001655   200217 755100                    STA     IX,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:98   
         2 001656   200217 236100                    LDQ     IX,,AUTO
         2 001657   001662 604000 2                  TMI     s:12542
         2 001660   200214 116100                    CMPQ    TOGET,,AUTO
         2 001661   001630 604400 2                  TMOZ    s:12536

      597    12542    4                  DO IX = 1 TO DCBRES;

  12542  2 001662   000001 235007                    LDA     1,DL
         2 001663   200217 755100                    STA     IX,,AUTO
         2 001664   001676 710000 2                  TRA     s:12545+3

      598    12543    4                       DCBPTR$ -> DCB$PTR$ = ADDR( NIL );

  12543  2 001665   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001666   200220 470500                    LDP0    DCBPTR$,,AUTO
         2 001667   000000 756100                    STQ     0,,PR0

      599    12544    4                       DCBPTR$ = PINCRW( DCBPTR$, SIZEW( DCBPTR$ ) );

  12544  2 001670   200220 236100                    LDQ     DCBPTR$,,AUTO
         2 001671   000001 036003                    ADLQ    1,DU
         2 001672   200220 756100                    STQ     DCBPTR$,,AUTO

      600    12545    4                     END;

  12545  2 001673   200217 235100                    LDA     IX,,AUTO
         2 001674   000001 035007                    ADLA    1,DL
         2 001675   200217 755100                    STA     IX,,AUTO
         2 001676   200225 236100                    LDQ     DCBRES,,AUTO
         2 001677   200217 116100                    CMPQ    IX,,AUTO
         2 001700   001665 603000 2                  TRC     s:12543

      601    12546                                                /* Setup tree table pointers */
      602    12547    3                  TEMP$ = PINCRW( TEMP$, S_D.RUM_HEAD$ -> B$HEAD.TREEDISP );

  12547  2 001701   000000 470400 xsym               LDP0    S_D$
         2 001702   005001 471500                    LDP1    2561,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:99   
         2 001703   100005 220100                    LDX0    5,,PR1
         2 001704   000000 636010                    EAQ     0,X0
         2 001705   200215 036100                    ADLQ    TEMP$,,AUTO
         2 001706   200215 756100                    STQ     TEMP$,,AUTO

      603    12548    3                  IF S_D.RUM_HEAD$ -> B$HEAD.OVRL

  12548  2 001707   100022 236100                    LDQ     18,,PR1
         2 001710   000010 316003                    CANQ    8,DU
         2 001711   001716 600000 2                  TZE     s:12550

      604    12549    3                  THEN S_D.B$ROS$ -> B$ROSEG.TREE$ = TEMP$;

  12549  2 001712   004775 473500                    LDP3    2557,,PR0
         2 001713   200215 236100                    LDQ     TEMP$,,AUTO
         2 001714   300001 756100                    STQ     1,,PR3
         2 001715   001721 710000 2                  TRA     s:12551

      605    12550    3                  ELSE S_D.B$ROS$ -> B$ROSEG.TREE$ = ADDR( NIL );

  12550  2 001716   004775 473500                    LDP3    2557,,PR0
         2 001717   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 001720   300001 756100                    STQ     1,,PR3

      606    12551    3                  S_D.PADDR = (((S_D.RUM_HEAD$ -> B$HEAD.RDATA + BITBIN('277777'O))

  12551  2 001721   005001 471500                    LDP1    2561,,PR0
         2 001722   100002 236100                    LDQ     2,,PR1
         2 001723   000040 376000 3                  ANQ     32
         2 001724   277777 036007                    ADLQ    98303,DL
         2 001725   000020 772000                    QRL     16
         2 001726   000020 736000                    QLS     16
         2 001727   200000 036007                    ADLQ    65536,DL
         2 001730   004765 756100                    STQ     2549,,PR0

      607    12552    3                    / BITBIN('200000'O)) * BITBIN('200000'O)) + BITBIN('200000'O);
      608    12553    3                END;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:100  

      609    12554    2           END;                            /* Done building read-only-segment */

      610    12555    1        CALL DDA$RESET_PATCH_SPACE;

  12555  2 001731   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001732   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 001733   000000 011000                    NOP     0

      611    12556    1        S_D.FIRST_TIME = '1'B;

  12556  2 001734   400000 236003                    LDQ     -131072,DU
         2 001735   000000 470400 xsym               LDP0    S_D$
         2 001736   006725 756100                    STQ     3541,,PR0

      612    12557    1        CALL DUI$RU_ACCESS ALTRET(KILL_IT);

  12557  2 001737   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001740   000000 701000 xent               TSX1    DUI$RU_ACCESS
         2 001741   002217 702000 2                  TSX2    KILL_IT

      613    12558    1        S_D.SAVEIC = S_D.RUM_HEAD$ -> B$HEAD.START;

  12558  2 001742   000000 470400 xsym               LDP0    S_D$
         2 001743   005001 471500                    LDP1    2561,,PR0
         2 001744   100003 236100                    LDQ     3,,PR1
         2 001745   000040 376000 3                  ANQ     32
         2 001746   000002 756100                    STQ     2,,PR0

      614    12559    1        CALL DDS$ES_INQ( S_D.SAVEIC ) ALTRET( RUM0 );

  12559  2 001747   000000 236000 xsym               LDQ     S_D$
         2 001750   000002 036003                    ADLQ    2,DU
         2 001751   200622 756100                    STQ     DEFI+2,,AUTO
         2 001752   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 001753   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001754   000000 701000 xent               TSX1    DDS$ES_INQ
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:101  
         2 001755   001761 702000 2                  TSX2    RUM0

      615    12560    1        CALL DDS$SET_Q2C;

  12560  2 001756   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001757   000000 701000 xent               TSX1    DDS$SET_Q2C
         2 001760   000000 011000                    NOP     0

  12558  2 001761                       RUM0         null
      616    12561    1   RUM0: ;
      617    12562    1        S_D.RUMSEQ = 0;

  12562  2 001761   000000 470400 xsym               LDP0    S_D$
         2 001762   005000 450100                    STZ     2560,,PR0

      618    12563    1        FPTTIME = FPT_TIME;

  12563  2 001763   000100 100400                    MLR     fill='000'O
         2 001764   000260 000060 1                  ADSC9   FPT_TIME                 cn=0,n=48
         2 001765   200464 000060                    ADSC9   FPTTIME,,AUTO            cn=0,n=48

      619    12564    1        FPTTIME.V_ = VECTOR( FPTTIME.V );

  12564  2 001766   000003 235000 3                  LDA     3
         2 001767   200622 452500                    STP2    DEFI+2,,AUTO
         2 001770   200622 236100                    LDQ     DEFI+2,,AUTO
         2 001771   000476 036003                    ADLQ    318,DU
         2 001772   200464 757100                    STAQ    FPTTIME,,AUTO

      620    12565    1        FPTTIME.TSTAMP_ = VECTOR( S_D.RUMUTS );

  12565  2 001773   777640 235007                    LDA     -96,DL
         2 001774   000000 236000 xsym               LDQ     S_D$
         2 001775   004777 036003                    ADLQ    2559,DU
         2 001776   200474 757100                    STAQ    FPTTIME+8,,AUTO

      621    12566    1        CALL M$TIME( FPTTIME ) ALTRET( NOTIME );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:102  

  12566  2 001777   200464 630500                    EPPR0   FPTTIME,,AUTO
         2 002000   420004 713400                    CLIMB   alt,+8196
         2 002001   402000 401760                    pmme    nvectors=5
         2 002002   002171 702000 2                  TSX2    NOTIME

      622    12567    1        CALL DDR$REPORT( 18/*R_RUM*/ );

  12567  2 002003   000050 630400 3                  EPPR0   40
         2 002004   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002005   000000 701000 xent               TSX1    DDR$REPORT
         2 002006   000000 011000                    NOP     0

      623    12568    1        IF WARNINPUT

  12568  2 002007   200224 234100                    SZN     WARNINPUT,,AUTO
         2 002010   002017 605000 2                  TPL     s:12573

      624    12569    2        THEN DO;

      625    12570    2             S_D.ERROR = 127;        /* E@NOPNUPD */

  12570  2 002011   000177 235007                    LDA     127,DL
         2 002012   000000 470400 xsym               LDP0    S_D$
         2 002013   000013 755100                    STA     11,,PR0

      626    12571    2             CALL DDE$ERROR;

  12571  2 002014   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002015   000000 701000 xent               TSX1    DDE$ERROR
         2 002016   000000 011000                    NOP     0

      627    12572    2           END;

      628    12573    1        S_D.RUM_ONLY = '0'B;

  12573  2 002017   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:103  
         2 002020   005145 450100                    STZ     2661,,PR0

      629    12574    1        S_D.RUM_SKIP = '0'B;

  12574  2 002021   000051 450100                    STZ     41,,PR0

      630    12575                                                /**/
      631    12576    1        IF S_D.STAND_ALONE AND

  12576  2 002022   004624 234100                    SZN     2452,,PR0
         2 002023   002045 605000 2                  TPL     s:12588
         2 002024   004752 234100                    SZN     2538,,PR0
         2 002025   002045 604000 2                  TMI     s:12588
         2 002026   004625 234100                    SZN     2453,,PR0
         2 002027   002045 604000 2                  TMI     s:12588

      632    12577    1          NOT S_D.EOM AND
      633    12578    1          NOT S_D.BATCH
      634    12579    2        THEN DO;

      635    12580    2             CALL M$EOM (FPT_EOM) ALTRET(NOEOM);

  12580  2 002030   000000 630400 xsym               EPPR0   FPT_EOM
         2 002031   560003 713400                    CLIMB   alt,+57347
         2 002032   401000 401760                    pmme    nvectors=3
         2 002033   002040 702000 2                  TSX2    NOEOM

      636    12581    2             S_D.EOM = '1'B;

  12581  2 002034   400000 236003                    LDQ     -131072,DU
         2 002035   000000 470400 xsym               LDP0    S_D$
         2 002036   004752 756100                    STQ     2538,,PR0

      637    12582    3             DO WHILE ( '0'B );

  12582  2 002037   002045 710000 2                  TRA     s:12588

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:104  
      638    12583    3   NOEOM:
      639    12584    3                  IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.SEV ~= 0

  12584  2 002040   000000 470400 xsym  NOEOM        LDP0    B$TCB$
         2 002041   000000 471500                    LDP1    0,,PR0
         2 002042   100102 236100                    LDQ     66,,PR1
         2 002043   000007 316007                    CANQ    7,DL
         2 002044   002223 601000 2                  TNZ     KILL_ETI

      640    12585    3                  THEN GOTO KILL_ETI;
      641    12586    3                END;

      642    12587    2           END;

      643    12588    1        RETURN;

  12588  2 002045   000000 702200 xent               TSX2  ! X66_ARET

  12584  2 002046                       NOOPN1       null
      644    12589                                                /**/
      645    12590        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:105  
      646    12591                                                /**/
      647    12592    1   NOOPN1: ;
      648    12593    1        IF ( FPTOPEN.V.FUN# = %UPDATE# ) AND

  12593  2 002046   200415 236100                    LDQ     FPTOPEN+37,,AUTO
         2 002047   777000 376007                    ANQ     -512,DL
         2 002050   001000 116007                    CMPQ    512,DL
         2 002051   002223 601000 2                  TNZ     KILL_ETI
         2 002052   000000 470400 xsym               LDP0    B$TCB$
         2 002053   000000 471500                    LDP1    0,,PR0
         2 002054   100102 236100                    LDQ     66,,PR1
         2 002055   377770 376007                    ANQ     131064,DL
         2 002056   001550 116007                    CMPQ    872,DL
         2 002057   002223 601000 2                  TNZ     KILL_ETI

      649    12594    1          ( B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$FILEBUSY )
      650    12595    2        THEN DO;

      651    12596    2             FPTOPEN.V.FUN# = %IN#;

  12596  2 002060   002000 236007                    LDQ     1024,DL
         2 002061   200415 552110                    STBQ    FPTOPEN+37,'10'O,AUTO

      652    12597    2             CALL M$OPEN( FPTOPEN ) ALTRET( KILL_ETI );

  12597  2 002062   200350 630500                    EPPR0   FPTOPEN,,AUTO
         2 002063   450000 713400                    CLIMB   alt,open
         2 002064   410400 401760                    pmme    nvectors=18
         2 002065   002223 702000 2                  TSX2    KILL_ETI

      653    12598    2             WARNINPUT = '1'B;

  12598  2 002066   400000 236003                    LDQ     -131072,DU
         2 002067   200224 756100                    STQ     WARNINPUT,,AUTO

      654    12599    2             GOTO RUM1;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:106  
  12599  2 002070   000333 710000 2                  TRA     RUM1

  12599  2 002071                       COPY_ERROR   null
      655    12600    2           END;
      656    12601    1        ELSE GOTO KILL_ETI;
      657    12602                                                /**/
      658    12603    1   COPY_ERROR: ;
      659    12604    1        CALL DUE$ERRMSG;

  12604  2 002071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002072   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002073   000000 011000                    NOP     0

  12599  2 002074                       COPY_BREAK   null
      660    12605    1   COPY_BREAK: ;
      661    12606    1        FPTCLOSE = FPT_CLOSE;

  12606  2 002074   000100 100400                    MLR     fill='000'O
         2 002075   000166 000170 1                  ADSC9   FPT_CLOSE                cn=0,n=120
         2 002076   200240 000170                    ADSC9   FPTCLOSE,,AUTO           cn=0,n=120

      662    12607    1        FPTCLOSE.V_ = VECTOR( FPTCLOSE.V );

  12607  2 002077   000000 235000 3                  LDA     0
         2 002100   200622 452500                    STP2    DEFI+2,,AUTO
         2 002101   200622 236100                    LDQ     DEFI+2,,AUTO
         2 002102   000272 036003                    ADLQ    186,DU
         2 002103   200240 757100                    STAQ    FPTCLOSE,,AUTO

      663    12608    1        FPTCLOSE.V.DCB# = COPYDCB;

  12608  2 002104   200231 720100                    LXL0    COPYDCB,,AUTO
         2 002105   200272 740100                    STX0    FPTCLOSE+26,,AUTO

      664    12609    1        FPTCLOSE.V.DISP# = %RELEASE#;

  12609  2 002106   000001 236007                    LDQ     1,DL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:107  
         2 002107   200272 552104                    STBQ    FPTCLOSE+26,'04'O,AUTO

      665    12610    1        CALL M$CLOSE( FPTCLOSE ) ALTRET( ARETCCE );

  12610  2 002110   200240 630500                    EPPR0   FPTCLOSE,,AUTO
         2 002111   450001 713400                    CLIMB   alt,close
         2 002112   406000 401760                    pmme    nvectors=13
         2 002113   002115 702000 2                  TSX2    ARETOC

      666    12611    2        DO WHILE( '0'B );

  12611  2 002114   002120 710000 2                  TRA     s:12616

  12610  2 002115                       ARETOC       null
  12607  2 002115                       ARETCCE      null
      667    12612    2   ARETOC:   ;
      668    12613    2   ARETCCE:  ;
      669    12614    2             CALL DUE$ERRMSG;

  12614  2 002115   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002116   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002117   000000 011000                    NOP     0

      670    12615    2           END;

      671    12616    1        FPTRELDCB = FPT_RELDCB;

  12616  2 002120   000100 100400                    MLR     fill='000'O
         2 002121   000224 000020 1                  ADSC9   FPT_RELDCB               cn=0,n=16
         2 002122   200460 000020                    ADSC9   FPTRELDCB,,AUTO          cn=0,n=16

      672    12617    1        FPTRELDCB.V_ = VECTOR( FPTRELDCB.V );

  12617  2 002123   000003 235000 3                  LDA     3
         2 002124   200622 452500                    STP2    DEFI+2,,AUTO
         2 002125   200622 236100                    LDQ     DEFI+2,,AUTO
         2 002126   000462 036003                    ADLQ    306,DU
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:108  
         2 002127   200460 757100                    STAQ    FPTRELDCB,,AUTO

      673    12618    1        FPTRELDCB.V.DCB# = COPYDCB;

  12618  2 002130   200231 720100                    LXL0    COPYDCB,,AUTO
         2 002131   200462 740100                    STX0    FPTRELDCB+2,,AUTO

      674    12619    1        CALL M$RELDCB( FPTRELDCB ) ALTRET( ARETRECE );

  12619  2 002132   200460 630500                    EPPR0   FPTRELDCB,,AUTO
         2 002133   460003 713400                    CLIMB   alt,+24579
         2 002134   400000 401760                    pmme    nvectors=1
         2 002135   002137 702000 2                  TSX2    ARETGC

      675    12620    2        DO WHILE ( '0'B );

  12620  2 002136   002142 710000 2                  TRA     s:12625

  12619  2 002137                       ARETGC       null
  12617  2 002137                       ARETRECE     null
      676    12621    2   ARETGC:   ;
      677    12622    2   ARETRECE: ;
      678    12623    2             CALL DUE$ERRMSG;

  12623  2 002137   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002140   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002141   000000 011000                    NOP     0

      679    12624    2           END;

      680    12625    1        WARNINPUT = '1'B;

  12625  2 002142   400000 236003                    LDQ     -131072,DU
         2 002143   200224 756100                    STQ     WARNINPUT,,AUTO

      681    12626    1        GOTO RUM2;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:109  
  12626  2 002144   000632 710000 2                  TRA     RUM2

  12625  2 002145                       NORELRUM     null
      682    12627                                                /**/
      683    12628    1   NORELRUM: ;
      684    12629    1        S_D.ERROR = 515;              /* E@RELRUM */

  12629  2 002145   001003 235007                    LDA     515,DL
         2 002146   000000 470400 xsym               LDP0    S_D$
         2 002147   000013 755100                    STA     11,,PR0

      685    12630    1        GOTO REPORT_XXXE;

  12630  2 002150   002204 710000 2                  TRA     REPORT_XXXE

  12629  2 002151                       NORU1        null
  12629  2 002151                       NOHEAD       null
      686    12631    1   NORU1: ;
      687    12632    1   NOHEAD: ;
      688    12633    1        S_D.ERROR = 128;             /* E@IGLRFID */

  12633  2 002151   000200 235007                    LDA     128,DL
         2 002152   000000 470400 xsym               LDP0    S_D$
         2 002153   000013 755100                    STA     11,,PR0

      689    12634    1        GOTO KILL_IT;

  12634  2 002154   002217 710000 2                  TRA     KILL_IT

  12633  2 002155                       NOMEM1       null
  12633  2 002155                       NOMEM2       null
      690    12635    1   NOMEM1: ;
      691    12636    1   NOMEM2: ;
      692    12637    1        S_D.ERROR = 129;               /* E@NOMEM */

  12637  2 002155   000201 235007                    LDA     129,DL
         2 002156   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:110  
         2 002157   000013 755100                    STA     11,,PR0

      693    12638    1        GOTO KILL_IT;

  12638  2 002160   002217 710000 2                  TRA     KILL_IT

  12637  2 002161                       NOROS        null
      694    12639    1   NOROS: ;
      695    12640    1        S_D.ERROR = 519;               /* E@ACROS */

  12640  2 002161   001007 235007                    LDA     519,DL
         2 002162   000000 470400 xsym               LDP0    S_D$
         2 002163   000013 755100                    STA     11,,PR0

      696    12641    1        GOTO KILL_IT;

  12641  2 002164   002217 710000 2                  TRA     KILL_IT

  12640  2 002165                       NONAME       null
      697    12642    1   NONAME: ;
      698    12643    1        S_D.ERROR = 126;              /* E@NONAME */

  12643  2 002165   000176 235007                    LDA     126,DL
         2 002166   000000 470400 xsym               LDP0    S_D$
         2 002167   000013 755100                    STA     11,,PR0

      699    12644    1        GOTO KILL_IT;

  12644  2 002170   002217 710000 2                  TRA     KILL_IT

  12643  2 002171                       NOTIME       null
      700    12645    1   NOTIME: ;
      701    12646    1        S_D.ERROR = 520;              /* E@NOTIME */

  12646  2 002171   001010 235007                    LDA     520,DL
         2 002172   000000 470400 xsym               LDP0    S_D$
         2 002173   000013 755100                    STA     11,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:111  

      702    12647    1        GOTO KILL_ITE;

  12647  2 002174   002214 710000 2                  TRA     KILL_ITE

  12646  2 002175                       UTSERRE      null
      703    12648    1   UTSERRE: ;
      704    12649    1        CALL DUE$ERRMSG;

  12649  2 002175   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002176   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002177   000000 011000                    NOP     0

  12646  2 002200                       UTSERR       null
      705    12650    1   UTSERR: ;
      706    12651    1        S_D.ERROR = 205;              /* E@UTSERR */

  12651  2 002200   000315 235007                    LDA     205,DL
         2 002201   000000 470400 xsym               LDP0    S_D$
         2 002202   000013 755100                    STA     11,,PR0

      707    12652    1        GOTO KILL_IT;

  12652  2 002203   002217 710000 2                  TRA     KILL_IT

  12651  2 002204                       REPORT_XXXE  null
      708    12653                                                /**/
      709    12654    1   REPORT_XXXE: ;
      710    12655    1        CALL DUE$ERRMSG;

  12655  2 002204   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002205   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002206   000000 011000                    NOP     0

  12651  2 002207                       REPORT_XXX   null
      711    12656    1   REPORT_XXX: ;
      712    12657    1        CALL DDE$ERROR;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:112  

  12657  2 002207   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002210   000000 701000 xent               TSX1    DDE$ERROR
         2 002211   000000 011000                    NOP     0

      713    12658    1        CALL M$XXX;

  12658  2 002212   000003 713400                    CLIMB   3
         2 002213   000000 401760                    pmme    nvectors=0

  12651  2 002214                       KILL_ITE     null
      714    12659                                                /**/
      715    12660    1   KILL_ITE: ;
      716    12661    1        CALL DUE$ERRMSG;

  12661  2 002214   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002215   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002216   000000 011000                    NOP     0

  12651  2 002217                       KILL_IT      null
      717    12662    1   KILL_IT: ;
      718    12663    1        CALL DDE$ERROR;

  12663  2 002217   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002220   000000 701000 xent               TSX1    DDE$ERROR
         2 002221   000000 011000                    NOP     0

      719    12664    1        GOTO KILL_IT1;

  12664  2 002222   002232 710000 2                  TRA     KILL_IT1

  12651  2 002223                       KILL_ETI     null
      720    12665    1   KILL_ETI: ;
      721    12666    1        CALL DUE$ERRMSG;

  12666  2 002223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002224   000000 701000 xent               TSX1    DUE$ERRMSG
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:113  
         2 002225   000000 011000                    NOP     0

      722    12667    1        GOTO KILL_IT1;

  12667  2 002226   002232 710000 2                  TRA     KILL_IT1

      723    12668                                                /**/
      724    12669        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:114  
      725    12670        /*F* NAME: DUA$KILL_RUM
      726    12671             PURPOSE: To KILL the currently active RUM mode.
      727    12672             DESCRIPTION: RUM mode is reset, and DELTA mode is re-established. */
      728    12673        /*D* NAME: DUA$KILL_RUM
      729    12674             ENTRY: DUA$KILL_RUM
      730    12675             CALL: CALL DUA$KILL_RUM
      731    12676             SCRATCH: Local AUTO only.
      732    12677             DESCRIPTION: RUM mode is reset, and DELTA mode is re-established
      733    12678                          as follows. The RUM dcb is closed, and then released;
      734    12679                          the data segment (DD_RUMNODE$) that contains the program
      735    12680                          head record, read-only-segment, and overlay control
      736    12681                          tables is released; all memory in the static data segment
      737    12682                          (S_D_SEG$) beyond the initial static data area is released;
      738    12683                          and miscellaneous control information is updated. */
      739    12684                                                /**/
      740    12685    1   DUA$KILL_RUM: ENTRY;

  12685  2 002227   000000 700200 xent  DUA$KILL_RUM TSX0  ! X66_AUTO_0
         2 002230   000630 000000                    ZERO    408,0

      741    12686                                                /**/
      742    12687        /* Kill current RUM mode */
      743    12688    2        DO WHILE ( '0'B );

  12688  2 002231   002243 710000 2                  TRA     s:12693

      744    12689    2   KILL_IT1: IF S_D.GHOST1 OR              /* GHOST1 is current user */

  12689  2 002232   000000 470400 xsym  KILL_IT1     LDP0    S_D$
         2 002233   000605 234100                    SZN     389,,PR0
         2 002234   002241 604000 2                  TMI     s:12691
         2 002235   000072 234100                    SZN     58,,PR0
         2 002236   002243 605000 2                  TPL     s:12693
         2 002237   000605 234100                    SZN     389,,PR0
         2 002240   002243 605000 2                  TPL     s:12693

      745    12690    2               (S_D.RUM_COMMAND AND S_D.GHOST1)
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:115  
             12690                        /* A RUM command was processed and GHOST1 */
      746    12691    2             THEN S_D.RUM_SKIP = '1'B;

  12691  2 002241   400000 236003                    LDQ     -131072,DU
         2 002242   000051 756100                    STQ     41,,PR0

      747    12692    2           END;

      748    12693    1        CALL KILL_RUM ALTRET( REPORT_XXX );

  12693  2 002243   002374 701000 2                  TSX1    KILL_RUM
         2 002244   002207 702000 2                  TSX2    REPORT_XXX

      749    12694    1        S_D.RUM = '0'B;

  12694  2 002245   000000 470400 xsym               LDP0    S_D$
         2 002246   004755 450100                    STZ     2541,,PR0

      750    12695    1        IF S_D.RUM_ONLY

  12695  2 002247   005145 234100                    SZN     2661,,PR0
         2 002250   002254 605000 2                  TPL     s:12698

      751    12696    1        THEN CALL DUA$EXITDELTA;

  12696  2 002251   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002252   000000 701000 xent               TSX1    DUA$EXITDELTA
         2 002253   000000 011000                    NOP     0

      752    12697        /* Release RUM dcb */
      753    12698    1        IF S_D.RUMDCB ~= 0

  12698  2 002254   000000 470400 xsym               LDP0    S_D$
         2 002255   004776 235100                    LDA     2558,,PR0
         2 002256   002277 600000 2                  TZE     s:12707

      754    12699    2        THEN DO;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:116  

      755    12700    2             FPTRELDCB = FPT_RELDCB;

  12700  2 002257   000100 100400                    MLR     fill='000'O
         2 002260   000224 000020 1                  ADSC9   FPT_RELDCB               cn=0,n=16
         2 002261   200460 000020                    ADSC9   FPTRELDCB,,AUTO          cn=0,n=16

      756    12701    2             FPTRELDCB.V_ = VECTOR( FPTRELDCB.V );

  12701  2 002262   000003 235000 3                  LDA     3
         2 002263   200622 452500                    STP2    DEFI+2,,AUTO
         2 002264   200622 236100                    LDQ     DEFI+2,,AUTO
         2 002265   000462 036003                    ADLQ    306,DU
         2 002266   200460 757100                    STAQ    FPTRELDCB,,AUTO

      757    12702    2             FPTRELDCB.V.DCB# = S_D.RUMDCB;

  12702  2 002267   004776 720100                    LXL0    2558,,PR0
         2 002270   200462 740100                    STX0    FPTRELDCB+2,,AUTO

      758    12703    2             CALL M$RELDCB( FPTRELDCB ) ALTRET( NORELRUM );

  12703  2 002271   200460 630500                    EPPR0   FPTRELDCB,,AUTO
         2 002272   460003 713400                    CLIMB   alt,+24579
         2 002273   400000 401760                    pmme    nvectors=1
         2 002274   002145 702000 2                  TSX2    NORELRUM

      759    12704    2             S_D.RUMDCB = 0;

  12704  2 002275   000000 470400 xsym               LDP0    S_D$
         2 002276   004776 450100                    STZ     2558,,PR0

      760    12705    2           END;

      761    12706        /* Re-establish DELTA mode environment */
      762    12707    2        DO CASE(S_D.ONE_TO_TWO.EXEC_DOMAIN);

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:117  
  12707  2 002277   006714 235100                    LDA     3532,,PR0
         2 002300   000003 115007                    CMPA    3,DL
         2 002301   002303 602005 2                  TNC     s:12707+4,AL
         2 002302   002316 710000 2                  TRA     s:12713
         2 002303   002316 710000 2                  TRA     s:12713
         2 002304   002306 710000 2                  TRA     s:12709
         2 002305   002312 710000 2                  TRA     s:12711

      763    12708    2          CASE(%HOST_RU);

      764    12709    2             CALL DUI$INIT_HOST;

  12709  2 002306   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002307   000000 701000 xent               TSX1    DUI$INIT_HOST
         2 002310   000000 011000                    NOP     0
         2 002311   002321 710000 2                  TRA     s:12716

      765    12710    2          CASE(%FEP_RU);

      766    12711    2             CALL DUI$INIT_L6;

  12711  2 002312   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002313   000000 701000 xent               TSX1    DUI$INIT_L6
         2 002314   000000 011000                    NOP     0
         2 002315   002321 710000 2                  TRA     s:12716

      767    12712    2          CASE(ELSE);

      768    12713    2             S_D.ERROR = 502;         /* E@DELBUG */

  12713  2 002316   000766 236007                    LDQ     502,DL
         2 002317   000013 756100                    STQ     11,,PR0

      769    12714    2             GOTO REPORT_XXX;

  12714  2 002320   002207 710000 2                  TRA     REPORT_XXX

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:118  
      770    12715    2          END;

      771    12716    1        CALL DDA$RESET_PATCH_SPACE;

  12716  2 002321   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002322   000000 701000 xent               TSX1    DDA$RESET_PATCH_SPACE
         2 002323   000000 011000                    NOP     0

      772    12717    1        S_D.FIRST_TIME = '1'B;

  12717  2 002324   400000 236003                    LDQ     -131072,DU
         2 002325   000000 470400 xsym               LDP0    S_D$
         2 002326   006725 756100                    STQ     3541,,PR0

      773    12718    1        CALL DUI$RU_ACCESS ALTRET(REPORT_XXX);

  12718  2 002327   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002330   000000 701000 xent               TSX1    DUI$RU_ACCESS
         2 002331   002207 702000 2                  TSX2    REPORT_XXX

      774    12719    1        CALL DDS$ES_INQ( S_D.SAVEIC ) ALTRET( KRUM0 );

  12719  2 002332   000000 236000 xsym               LDQ     S_D$
         2 002333   000002 036003                    ADLQ    2,DU
         2 002334   200622 756100                    STQ     DEFI+2,,AUTO
         2 002335   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002336   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002337   000000 701000 xent               TSX1    DDS$ES_INQ
         2 002340   002344 702000 2                  TSX2    KRUM0

      775    12720    1        CALL DDS$SET_Q2C;

  12720  2 002341   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002342   000000 701000 xent               TSX1    DDS$SET_Q2C
         2 002343   000000 011000                    NOP     0

  12717  2 002344                       KRUM0        null
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:119  
      776    12721    1   KRUM0: ;
      777    12722    1        IF S_D.DO$ ~= ADDR( NIL )

  12722  2 002344   000000 470400 xsym               LDP0    S_D$
         2 002345   000031 236100                    LDQ     25,,PR0
         2 002346   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 002347   002364 600000 2                  TZE     s:12728

      778    12723    2        THEN DO;

      779    12724    2             ARS = S_D.DO$ -> RUM$CMD.CMD;

  12724  2 002350   000031 471500                    LDP1    25,,PR0
         2 002351   100000 236100                    LDQ     0,,PR1
         2 002352   000033 772000                    QRL     27
         2 002353   200222 756100                    STQ     ARS,,AUTO

      780    12725    2             IF ( ARS ~= 59 ) AND ( ARS ~= 39 ) /* C_ANLZ, C_QUIT */

  12725  2 002354   000073 116007                    CMPQ    59,DL
         2 002355   002364 600000 2                  TZE     s:12728
         2 002356   000047 116007                    CMPQ    39,DL
         2 002357   002364 600000 2                  TZE     s:12728

      781    12726    2             THEN CALL DDR$REPORT( 11/*R_DELTA*/ );

  12726  2 002360   000051 630400 3                  EPPR0   41
         2 002361   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 002362   000000 701000 xent               TSX1    DDR$REPORT
         2 002363   000000 011000                    NOP     0

      782    12727    2           END;

      783    12728    1        IF S_D.TRACE_STATE

  12728  2 002364   000000 470400 xsym               LDP0    S_D$
         2 002365   005143 234100                    SZN     2659,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:120  
         2 002366   002373 605000 2                  TPL     s:12734

      784    12729    2        THEN DO;

      785    12730    2             S_D.TRACE_STATE = '0'B;

  12730  2 002367   005143 450100                    STZ     2659,,PR0

      786    12731    2             CALL DDA$TRACEON;

  12731  2 002370   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002371   000000 701000 xent               TSX1    DDA$TRACEON
         2 002372   000000 011000                    NOP     0

      787    12732    2           END;

      788    12733                                                /**/
      789    12734    1        RETURN;

  12734  2 002373   000000 702200 xent               TSX2  ! X66_ARET

      790    12735                                                /**/
      791    12736        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:121  
      792    12737                                                /**/
      793    12738    1   KILL_RUM: PROC ALTRET;

  12738  2 002374   200616 741300       KILL_RUM     STX1  ! TEMP$WORD+6,,AUTO

      794    12739                                                /**/
      795    12740    2   DCL TOBREL UBIN;
      796    12741    2   DCL DEFI SBIN;
      797    12742                                                /**/
      798    12743    2        IF S_D.RUM

  12743  2 002375   000000 470400 xsym               LDP0    S_D$
         2 002376   004755 234100                    SZN     2541,,PR0
         2 002377   002403 605000 2                  TPL     s:12745

      799    12744    2        THEN CALL DUU$TRUNC;               /* Ignore altret */

  12744  2 002400   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002401   000000 701000 xent               TSX1    DUU$TRUNC
         2 002402   000000 011000                    NOP     0

      800    12745    3        DO IX = 0 TO (SIZEW(S_D.RCBC.BUF$)/SIZEW(S_D.RCBC.BUF$(0)))-1;

  12745  2 002403   200217 450100                    STZ     IX,,AUTO
         2 002404   002415 710000 2                  TRA     s:12748+3

      801    12746    3             S_D.RCBC.PAGE( IX ) = -1;

  12746  2 002405   000001 335007                    LCA     1,DL
         2 002406   000000 470400 xsym               LDP0    S_D$
         2 002407   200217 720100                    LXL0    IX,,AUTO
         2 002410   000534 755110                    STA     348,X0,PR0

      802    12747    3             S_D.RCBC.SIZE( IX ) = -1;

  12747  2 002411   000546 755110                    STA     358,X0,PR0

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:122  
      803    12748    3           END;

  12748  2 002412   200217 236100                    LDQ     IX,,AUTO
         2 002413   000001 036007                    ADLQ    1,DL
         2 002414   200217 756100                    STQ     IX,,AUTO
         2 002415   200217 235100                    LDA     IX,,AUTO
         2 002416   000012 115007                    CMPA    10,DL
         2 002417   002405 602000 2                  TNC     s:12746

      804    12749    2        TOBREL = POFFW( S_D.SCHSEG$, S_D.SCHSEG_BEGIN$ );

  12749  2 002420   000000 470400 xsym               LDP0    S_D$
         2 002421   000043 236100                    LDQ     35,,PR0
         2 002422   000022 772000                    QRL     18
         2 002423   200622 756100                    STQ     DEFI+2,,AUTO
         2 002424   001034 236100                    LDQ     540,,PR0
         2 002425   000022 772000                    QRL     18
         2 002426   200622 136100                    SBLQ    DEFI+2,,AUTO
         2 002427   200617 756100                    STQ     TOBREL,,AUTO

      805    12750    2        IF TOBREL > 0

  12750  2 002430   002441 600000 2                  TZE     s:12752

      806    12751    2        THEN CALL DDM$PUTMEM( S_D_SEG$, TOBREL ) ALTRET( NORELS_D );

  12751  2 002431   200617 631500                    EPPR1   TOBREL,,AUTO
         2 002432   200623 451500                    STP1    DEFI+3,,AUTO
         2 002433   000052 236000 3                  LDQ     42
         2 002434   200622 756100                    STQ     DEFI+2,,AUTO
         2 002435   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002436   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002437   000000 701000 xent               TSX1    DDM$PUTMEM
         2 002440   002671 702000 2                  TSX2    NORELS_D

      807    12752    2        S_D.SCHSEG$ = S_D.SCHSEG_BEGIN$;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:123  
  12752  2 002441   000000 470400 xsym               LDP0    S_D$
         2 002442   000043 236100                    LDQ     35,,PR0
         2 002443   001034 756100                    STQ     540,,PR0

      808    12753    2        TOBREL = POFFW( S_D.NODESEG_USED$, DD_RUMNODE$ );

  12753  2 002444   000000 235000 xsym               LDA     DD_RUMNODE$
         2 002445   000022 771000                    ARL     18
         2 002446   200622 755100                    STA     DEFI+2,,AUTO
         2 002447   004771 236100                    LDQ     2553,,PR0
         2 002450   000022 772000                    QRL     18
         2 002451   200622 136100                    SBLQ    DEFI+2,,AUTO
         2 002452   200617 756100                    STQ     TOBREL,,AUTO

      809    12754    2        IF TOBREL > 0

  12754  2 002453   002464 600000 2                  TZE     s:12756

      810    12755    2        THEN CALL DDM$PUTMEM( DD_RUMNODE$, TOBREL ) ALTRET( NORELND );

  12755  2 002454   200617 631500                    EPPR1   TOBREL,,AUTO
         2 002455   200623 451500                    STP1    DEFI+3,,AUTO
         2 002456   000010 236000 3                  LDQ     8
         2 002457   200622 756100                    STQ     DEFI+2,,AUTO
         2 002460   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002461   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002462   000000 701000 xent               TSX1    DDM$PUTMEM
         2 002463   002676 702000 2                  TSX2    NORELND

      811    12756    2        IF S_D.RUM

  12756  2 002464   000000 470400 xsym               LDP0    S_D$
         2 002465   004755 234100                    SZN     2541,,PR0
         2 002466   002643 605000 2                  TPL     s:12792

      812    12757    3        THEN DO;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:124  
      813    12758                                      /* Write out number of errors during RUMming */
      814    12759    3             BUF$ = ADDR( S_D.OUTPUT );

  12759  2 002467   000000 236000 xsym               LDQ     S_D$
         2 002470   005335 036003                    ADLQ    2781,DU
         2 002471   200207 756100                    STQ     BUF$,,AUTO

      815    12760    3             S_D.OUTPUT = ' ';

  12760  2 002472   040100 100400                    MLR     fill='040'O
         2 002473   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002474   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      816    12761    3             CALL DDQ$WRITE( BUF$, 4 );

  12761  2 002475   000053 236000 3                  LDQ     43
         2 002476   200623 756100                    STQ     DEFI+3,,AUTO
         2 002477   200207 631500                    EPPR1   BUF$,,AUTO
         2 002500   200622 451500                    STP1    DEFI+2,,AUTO
         2 002501   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002502   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002503   000000 701000 xent               TSX1    DDQ$WRITE
         2 002504   000000 011000                    NOP     0

      817    12762    3             FPTUNFID = FPT_UNFID;

  12762  2 002505   000100 100400                    MLR     fill='000'O
         2 002506   000310 000130 1                  ADSC9   FPT_UNFID                cn=0,n=88
         2 002507   200500 000130                    ADSC9   FPTUNFID,,AUTO           cn=0,n=88

      818    12763    3             FPTUNFID.V_ = VECTOR(FPTUNFID.V);

  12763  2 002510   000003 235000 3                  LDA     3
         2 002511   200622 452500                    STP2    DEFI+2,,AUTO
         2 002512   200622 236100                    LDQ     DEFI+2,,AUTO
         2 002513   000524 036003                    ADLQ    340,DU
         2 002514   200500 757100                    STAQ    FPTUNFID,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:125  

      819    12764    3             FPTUNFID.V.DCB# = S_D.LMDCB;

  12764  2 002515   000000 470400 xsym               LDP0    S_D$
         2 002516   004774 720100                    LXL0    2556,,PR0
         2 002517   200524 740100                    STX0    FPTUNFID+20,,AUTO

      820    12765    3             IF S_D.RUM_ERRORS = 0

  12765  2 002520   000514 235100                    LDA     332,,PR0
         2 002521   002545 601000 2                  TNZ     s:12773

      821    12766    4             THEN DO;

      822    12767    4                  S_D.OUTPUT = '*** NO Errors encountered in file';

  12767  2 002522   040100 100400                    MLR     fill='040'O
         2 002523   000354 000041 1                  ADSC9   VLP_FID_SN+14            cn=0,n=33
         2 002524   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      823    12768    4                  FPTUNFID.TEXTFID_ = VECTOR(SUBSTR(S_D.OUTPUT,LENGTHC(
             12768                           '*** NO Errors encountered in file ')));

  12768  2 002525   000054 235000 3                  LDA     44
         2 002526   000000 236000 xsym               LDQ     S_D$
         2 002527   000055 036000 3                  ADLQ    45
         2 002530   200502 757100                    STAQ    FPTUNFID+2,,AUTO

      824    12769    4                  CALL M$UNFID (FPTUNFID);

  12769  2 002531   200500 630500                    EPPR0   FPTUNFID,,AUTO
         2 002532   020021 713400                    CLIMB   8209
         2 002533   404400 401760                    pmme    nvectors=10

      825    12770    4                  CALL DDQ$WRITE( BUF$, 72 );

  12770  2 002534   000057 236000 3                  LDQ     47
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:126  
         2 002535   200623 756100                    STQ     DEFI+3,,AUTO
         2 002536   200207 630500                    EPPR0   BUF$,,AUTO
         2 002537   200622 450500                    STP0    DEFI+2,,AUTO
         2 002540   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002541   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002542   000000 701000 xent               TSX1    DDQ$WRITE
         2 002543   000000 011000                    NOP     0

      826    12771    4                END;

  12771  2 002544   002574 710000 2                  TRA     s:12779

      827    12772    4             ELSE DO;

      828    12773    4                  S_D.OUTPUT = '**** 00000 Errors encountered in file';

  12773  2 002545   040100 100400                    MLR     fill='040'O
         2 002546   000365 000045 1                  ADSC9   VLP_FID_SN+23            cn=0,n=37
         2 002547   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      829    12774    4                  CALL BINCHAR( SUBSTR( S_D.OUTPUT, 5, 5 ), S_D.RUM_ERRORS );

  12774  2 002550   000044 773000                    LRL     36
         2 002551   200622 757100                    STAQ    DEFI+2,,AUTO
         2 002552   000100 301500                    BTD
         2 002553   200622 000010                    NDSC9   DEFI+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 002554   005336 230005                    NDSC9   2782,,PR0                cn=1,s=nosgn,sf=0,n=5

      830    12775    4                  FPTUNFID.TEXTFID_ = VECTOR(SUBSTR(S_D.OUTPUT,LENGTHC(
             12775                           '**** 00000 Errors encountered in file ')));

  12775  2 002555   000060 235000 3                  LDA     48
         2 002556   000000 236000 xsym               LDQ     S_D$
         2 002557   000061 036000 3                  ADLQ    49
         2 002560   200502 757100                    STAQ    FPTUNFID+2,,AUTO

      831    12776    4                  CALL M$UNFID (FPTUNFID);
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:127  

  12776  2 002561   200500 630500                    EPPR0   FPTUNFID,,AUTO
         2 002562   020021 713400                    CLIMB   8209
         2 002563   404400 401760                    pmme    nvectors=10

      832    12777    4                  CALL DDQ$WRITE( BUF$, 72 );

  12777  2 002564   000057 236000 3                  LDQ     47
         2 002565   200623 756100                    STQ     DEFI+3,,AUTO
         2 002566   200207 630500                    EPPR0   BUF$,,AUTO
         2 002567   200622 450500                    STP0    DEFI+2,,AUTO
         2 002570   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002571   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002572   000000 701000 xent               TSX1    DDQ$WRITE
         2 002573   000000 011000                    NOP     0

      833    12778    4                END;

      834    12779    3             S_D.OUTPUT = ' ';

  12779  2 002574   000000 470400 xsym               LDP0    S_D$
         2 002575   040100 100400                    MLR     fill='040'O
         2 002576   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 002577   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

      835    12780    3             CALL DDQ$WRITE( BUF$, 4 );

  12780  2 002600   000053 236000 3                  LDQ     43
         2 002601   200623 756100                    STQ     DEFI+3,,AUTO
         2 002602   200207 631500                    EPPR1   BUF$,,AUTO
         2 002603   200622 451500                    STP1    DEFI+2,,AUTO
         2 002604   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 002605   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 002606   000000 701000 xent               TSX1    DDQ$WRITE
         2 002607   000000 011000                    NOP     0

      836    12781    3             S_D.SAVEIC = S_D.SAVEIC_SAVE;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:128  

  12781  2 002610   000000 470400 xsym               LDP0    S_D$
         2 002611   005051 235100                    LDA     2601,,PR0
         2 002612   000002 755100                    STA     2,,PR0

      837    12782    3             S_D.ONE_TO_TWO.EXEC_DOMAIN = S_D.EXEC_DOMAIN_SAVE;

  12782  2 002613   005325 235100                    LDA     2773,,PR0
         2 002614   006714 755100                    STA     3532,,PR0

      838    12783    3             S_D.LMDCB = S_D.LMDCB_SAVE;

  12783  2 002615   006743 235100                    LDA     3555,,PR0
         2 002616   004774 755100                    STA     2556,,PR0

      839    12784    3             IF DCBADDR( S_D.RUMDCB ) -> F$DCB.FCD#

  12784  2 002617   000012 471400 3                  LDP1    10
         2 002620   100000 473500                    LDP3    0,,PR1
         2 002621   004776 720100                    LXL0    2558,,PR0
         2 002622   300000 474510                    LDP4    0,X0,PR3
         2 002623   400031 236100                    LDQ     25,,PR4
         2 002624   020000 316007                    CANQ    8192,DL
         2 002625   002643 600000 2                  TZE     s:12792

      840    12785    4             THEN DO;

      841    12786    4                  FPTCLOSE = FPT_CLOSE;

  12786  2 002626   000100 100400                    MLR     fill='000'O
         2 002627   000166 000170 1                  ADSC9   FPT_CLOSE                cn=0,n=120
         2 002630   200240 000170                    ADSC9   FPTCLOSE,,AUTO           cn=0,n=120

      842    12787    4                  FPTCLOSE.V_ = VECTOR( FPTCLOSE.V );

  12787  2 002631   000000 235000 3                  LDA     0
         2 002632   200622 452500                    STP2    DEFI+2,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:129  
         2 002633   200622 236100                    LDQ     DEFI+2,,AUTO
         2 002634   000272 036003                    ADLQ    186,DU
         2 002635   200240 757100                    STAQ    FPTCLOSE,,AUTO

      843    12788    4                  FPTCLOSE.V.DCB# = S_D.RUMDCB;

  12788  2 002636   200272 740100                    STX0    FPTCLOSE+26,,AUTO

      844    12789    4                  CALL M$CLOSE( FPTCLOSE ) ALTRET( NOCLSRUM );

  12789  2 002637   200240 630500                    EPPR0   FPTCLOSE,,AUTO
         2 002640   450001 713400                    CLIMB   alt,close
         2 002641   406000 401760                    pmme    nvectors=13
         2 002642   002703 702000 2                  TSX2    NOCLSRUM

      845    12790    4                END;

      846    12791    3           END;

      847    12792    2        S_D.RUM_ERRORS = 0;

  12792  2 002643   000000 470400 xsym               LDP0    S_D$
         2 002644   000514 450100                    STZ     332,,PR0

      848    12793    2        S_D.B$ROS$ = B$ROS$;

  12793  2 002645   000000 236000 xsym               LDQ     B$ROS$
         2 002646   004775 756100                    STQ     2557,,PR0

      849    12794    2        S_D.NODESEG$ = DD_RUMNODE$;

  12794  2 002647   000000 236000 xsym               LDQ     DD_RUMNODE$
         2 002650   005003 756100                    STQ     2563,,PR0

      850    12795    2        S_D.NODESEG_USED$ = DD_RUMNODE$;

  12795  2 002651   004771 756100                    STQ     2553,,PR0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:130  

      851    12796    2        IF S_D.GHOST1

  12796  2 002652   000605 234100                    SZN     389,,PR0
         2 002653   002667 605000 2                  TPL     s:12803

      852    12797    3        THEN DO;

      853    12798    4             DO DEFI = 0 TO 24;

  12798  2 002654   200620 450100                    STZ     DEFI,,AUTO

      854    12799    4                  S_D.UD.TEXTSZ(DEFI) = 0;

  12799  2 002655   200620 236100                    LDQ     DEFI,,AUTO
         2 002656   000011 402007                    MPY     9,DL
         2 002657   000000 470400 xsym               LDP0    S_D$
         2 002660   000000 620006                    EAX0    0,QL
         2 002661   000032 236000 xsym               LDQ     B_VECTNIL+26
         2 002662   000141 356110                    ANSQ    97,X0,PR0

      855    12800    4                END;

  12800  2 002663   200620 054100                    AOS     DEFI,,AUTO
         2 002664   200620 235100                    LDA     DEFI,,AUTO
         2 002665   000030 115007                    CMPA    24,DL
         2 002666   002655 604400 2                  TMOZ    s:12799

      856    12801    3           END;

      857    12802                                                /**/
      858    12803    2        RETURN;

  12803  2 002667   200616 221300                    LDX1  ! TEMP$WORD+6,,AUTO
         2 002670   000001 702211                    TSX2  ! 1,X1

  12796  2 002671                       NORELS_D     null
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:131  
      859    12804                                                /**/
      860    12805    2   NORELS_D: ;
      861    12806    2        S_D.ERROR = 516;              /* E@RELS_D */

  12806  2 002671   001004 235007                    LDA     516,DL
         2 002672   000000 470400 xsym               LDP0    S_D$
         2 002673   000013 755100                    STA     11,,PR0

      862    12807    2        ALTRETURN;

  12807  2 002674   200616 221300                    LDX1  ! TEMP$WORD+6,,AUTO
         2 002675   000000 702211                    TSX2  ! 0,X1

  12806  2 002676                       NORELND      null
      863    12808    2   NORELND: ;
      864    12809    2        S_D.ERROR = 517;               /* E@RELND */

  12809  2 002676   001005 235007                    LDA     517,DL
         2 002677   000000 470400 xsym               LDP0    S_D$
         2 002700   000013 755100                    STA     11,,PR0

      865    12810    2        ALTRETURN;

  12810  2 002701   200616 221300                    LDX1  ! TEMP$WORD+6,,AUTO
         2 002702   000000 702211                    TSX2  ! 0,X1

  12809  2 002703                       NOCLSRUM     null
      866    12811    2   NOCLSRUM: ;
      867    12812    2        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$ACGRANS AND

  12812  2 002703   000000 470400 xsym               LDP0    B$TCB$
         2 002704   000000 471500                    LDP1    0,,PR0
         2 002705   100102 236100                    LDQ     66,,PR1
         2 002706   377770 376007                    ANQ     131064,DL
         2 002707   002160 116007                    CMPQ    1136,DL
         2 002710   002723 601000 2                  TNZ     s:12818
         2 002711   000000 473400 xsym               LDP3    S_D$
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:132  
         2 002712   305145 234100                    SZN     2661,,PR3
         2 002713   002723 605000 2                  TPL     s:12818

      868    12813    2          S_D.RUM_ONLY
      869    12814    3        THEN DO;

      870    12815    3             CALL DUE$ERRMSG;

  12815  2 002714   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002715   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002716   000000 011000                    NOP     0

      871    12816    3             CALL DUA$EXITDELTA;

  12816  2 002717   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002720   000000 701000 xent               TSX1    DUA$EXITDELTA
         2 002721   000000 011000                    NOP     0

      872    12817    3           END;

  12817  2 002722   002726 710000 2                  TRA     s:12819

      873    12818    2        ELSE CALL DUE$ERRMSG;

  12818  2 002723   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 002724   000000 701000 xent               TSX1    DUE$ERRMSG
         2 002725   000000 011000                    NOP     0

      874    12819    2        S_D.ERROR = 518;              /* E@CLSRUM */

  12819  2 002726   001006 235007                    LDA     518,DL
         2 002727   000000 470400 xsym               LDP0    S_D$
         2 002730   000013 755100                    STA     11,,PR0

      875    12820    2        ALTRETURN;

  12820  2 002731   200616 221300                    LDX1  ! TEMP$WORD+6,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:133  
         2 002732   000000 702211                    TSX2  ! 0,X1

      876    12821                                                /**/
      877    12822    2   END KILL_RUM;
      878    12823                                                /**/
      879    12824        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:134  
      880    12825        /*F* NAME: DUA$DELETE
      881    12826             PURPOSE: To remove records of RUM modifications from RU.
      882    12827             DESCRIPTION: Positions to the beginning of RUM records with a keyed
      883    12828                          read. Reads and then deletes each record with a RUM
      884    12829                          key. RUM mode must be active. The actual code to read
      885    12830                          the RUM records is common with DUA$LIST. */
      886    12831        /*D* NAME: DUA$DELETE
      887    12832             ENTRY: DUA$DELETE
      888    12833             CALL: CALL DUA$DELETE;
      889    12834             OUTPUT: DELETE_FLAG - Set for DUA$LIST.
      890    12835             SCRATCH: Local AUTO only.
      891    12836             DESCRIPTION: Positions to the beginning of RUM records with a keyed
      892    12837                          read. Reads and then deletes each record with a RUM
      893    12838                          key. RUM mode must be active. The actual code to read
      894    12839                          the RUM records is common with DUA$LIST. */
      895    12840                                                /**/
      896    12841    1   DUA$DELETE: ENTRY;

  12841  2 002733   000000 700200 xent  DUA$DELETE   TSX0  ! X66_AUTO_0
         2 002734   000630 000000                    ZERO    408,0

      897    12842                                                /**/
      898    12843    1        DELETE_FLAG = '1'B;

  12843  2 002735   400000 236003                    LDQ     -131072,DU
         2 002736   200211 756100                    STQ     DELETE_FLAG,,AUTO

      899    12844    1        FPTDELREC = FPT_DELREC;

  12844  2 002737   000100 100400                    MLR     fill='000'O
         2 002740   000062 000050 1                  ADSC9   FPT_DELREC               cn=0,n=40
         2 002741   200276 000050                    ADSC9   FPTDELREC,,AUTO          cn=0,n=40

      900    12845    1        FPTDELREC.V_ = VECTOR( FPTDELREC.V );

  12845  2 002742   000003 235000 3                  LDA     3
         2 002743   200622 452500                    STP2    DEFI+2,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:135  
         2 002744   200622 236100                    LDQ     DEFI+2,,AUTO
         2 002745   000306 036003                    ADLQ    198,DU
         2 002746   200276 757100                    STAQ    FPTDELREC,,AUTO

      901    12846    1        FPTDELREC.V.DCB# = S_D.LMDCB;

  12846  2 002747   000000 470400 xsym               LDP0    S_D$
         2 002750   004774 720100                    LXL0    2556,,PR0
         2 002751   200306 740100                    STX0    FPTDELREC+8,,AUTO

      902    12847    1        GOTO LIST_CODE;

  12847  2 002752   002756 710000 2                  TRA     LIST_CODE

      903    12848                                                /**/
      904    12849        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:136  
      905    12850        /*F* NAME: DUA$LIST
      906    12851             PURPOSE: To list the RUM modification records.
      907    12852             DESCRIPTION: All the modifications that have been made to the
      908    12853                          currently active RU by RUM are displayed. */
      909    12854        /*D* NAME: DUA$LIST
      910    12855             ENTRY: DUA$LIST
      911    12856             CALL: CALL DUA$LIST;
      912    12857             SCRATCH: Local AUTO only.
      913    12858             DESCRIPTION: All the modifications that have been made to the
      914    12859                          currently active RU by RUM are displayed. If the
      915    12860                          DELETE_FLAG is set, then the records are deleted, not
      916    12861                          listed. */
      917    12862                                                /**/
      918    12863    1   DUA$LIST: ENTRY;

  12863  2 002753   000000 700200 xent  DUA$LIST     TSX0  ! X66_AUTO_0
         2 002754   000630 000000                    ZERO    408,0

      919    12864                                                /**/
      920    12865    1        DELETE_FLAG = '0'B;

  12865  2 002755   200211 450100                    STZ     DELETE_FLAG,,AUTO

  12865  2 002756                       LIST_CODE    null
      921    12866                                                /**/
      922    12867    1   LIST_CODE: ;
      923    12868    1        NONE = 0;

  12868  2 002756   200221 450100                    STZ     NONE,,AUTO

      924    12869    1        BUF$ = ADDR( S_D.OUTPUT );

  12869  2 002757   000000 236000 xsym               LDQ     S_D$
         2 002760   005335 036003                    ADLQ    2781,DU
         2 002761   200207 756100                    STQ     BUF$,,AUTO

      925    12870    1        DCB$ = DCBADDR( S_D.LMDCB );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:137  

  12870  2 002762   000012 470400 3                  LDP0    10
         2 002763   000000 471500                    LDP1    0,,PR0
         2 002764   000000 473400 xsym               LDP3    S_D$
         2 002765   304774 720100                    LXL0    2556,,PR3
         2 002766   100000 236110                    LDQ     0,X0,PR1
         2 002767   200210 756100                    STQ     DCB$,,AUTO

      926    12871    1        IF S_D.ANLZ OR ( NOT S_D.RUM AND S_D.STAND_ALONE )

  12871  2 002770   304756 234100                    SZN     2542,,PR3
         2 002771   003450 604000 2                  TMI     NONCHK
         2 002772   304755 234100                    SZN     2541,,PR3
         2 002773   002776 604000 2                  TMI     s:12873
         2 002774   304624 234100                    SZN     2452,,PR3
         2 002775   003450 604000 2                  TMI     NONCHK

      927    12872    1        THEN GOTO NONCHK;
      928    12873    1        FPTTIME = FPT_UNTIME;

  12873  2 002776   000100 100400                    MLR     fill='000'O
         2 002777   000244 000060 1                  ADSC9   FPT_UNTIME               cn=0,n=48
         2 003000   200464 000060                    ADSC9   FPTTIME,,AUTO            cn=0,n=48

      929    12874    1        FPTTIME.V_ = VECTOR( FPTTIME.V );

  12874  2 003001   000003 235000 3                  LDA     3
         2 003002   200622 452500                    STP2    DEFI+2,,AUTO
         2 003003   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003004   000476 036003                    ADLQ    318,DU
         2 003005   200464 757100                    STAQ    FPTTIME,,AUTO

      930    12875    1        FPTTIME.DATE_ = VECTOR( BUF$ -> VLR$LOCAL.DATE );

  12875  2 003006   000003 235000 3                  LDA     3
         2 003007   200207 236100                    LDQ     BUF$,,AUTO
         2 003010   200466 757100                    STAQ    FPTTIME+2,,AUTO
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:138  

      931    12876    1        FPTTIME.TIME_ = VECTOR( BUF$ -> VLR$LOCAL.TIME );

  12876  2 003011   000036 235000 3                  LDA     30
         2 003012   200207 236100                    LDQ     BUF$,,AUTO
         2 003013   000062 036000 3                  ADLQ    50
         2 003014   200470 757100                    STAQ    FPTTIME+4,,AUTO

      932    12877    1        FPTTIME.TSTAMP_ = VECTOR( LASTUTS );

  12877  2 003015   777640 235007                    LDA     -96,DL
         2 003016   200622 452500                    STP2    DEFI+2,,AUTO
         2 003017   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003020   000204 036003                    ADLQ    132,DU
         2 003021   200474 757100                    STAQ    FPTTIME+8,,AUTO

      933    12878    1        IF S_D.RUM AND S_D.RUM_BIRTH$ ~= ADDR( NIL )

  12878  2 003022   304755 234100                    SZN     2541,,PR3
         2 003023   003156 605000 2                  TPL     s:12909
         2 003024   300502 236100                    LDQ     322,,PR3
         2 003025   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003026   003156 600000 2                  TZE     s:12909

      934    12879    2        THEN DO;

      935    12880    2             LASTUTS = S_D.RUM_BIRTH$ -> B$RUBIRTH.CREATE_UTS;

  12880  2 003027   300502 474500                    LDP4    322,,PR3
         2 003030   400000 235100                    LDA     0,,PR4
         2 003031   200204 755100                    STA     LASTUTS,,AUTO

      936    12881    2             CALL M$TIME( FPTTIME ) ALTRET( ARETT );

  12881  2 003032   200464 630500                    EPPR0   FPTTIME,,AUTO
         2 003033   420004 713400                    CLIMB   alt,+8196
         2 003034   402000 401760                    pmme    nvectors=5
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:139  
         2 003035   003551 702000 2                  TSX2    ARETD

      937    12882    2             BUF$ -> VLR$LOCAL.SPACE = ' ';

  12882  2 003036   200207 470500                    LDP0    BUF$,,AUTO
         2 003037   040100 100400                    MLR     fill='040'O
         2 003040   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003041   000002 000001                    ADSC9   2,,PR0                   cn=0,n=1

      938    12883    2             SIZE = LENGTHC( VLR$LOCAL );

  12883  2 003042   000024 235007                    LDA     20,DL
         2 003043   200206 755100                    STA     SIZE,,AUTO

      939    12884    2             CALL INSERT( S_D.OUTPUT, SIZE, , ' Creation UTS' );

  12884  2 003044   773777 620005                    EAX0    -2049,AL
         2 003045   777777 660003                    ERX0    -1,DU
         2 003046   000000 470400 xsym               LDP0    S_D$
         2 003047   040145 100400                    MLR     fill='040'O
         2 003050   000377 000015 1                  ADSC9   VLP_FID_SN+33            cn=0,n=13
         2 003051   005335 000010                    ADSC9   2781,A,PR0               cn=0,n=*X0

      940    12885    2             SIZE = SIZE + LENGTHC( ' Creation UTS' );

  12885  2 003052   200206 236100                    LDQ     SIZE,,AUTO
         2 003053   000015 036007                    ADLQ    13,DL
         2 003054   200206 756100                    STQ     SIZE,,AUTO

      941    12886        /* Don't print creation UTS in octal
      942    12887                  TEMP$ = PINCRC( BUF$, SIZE );
      943    12888                  CALL DDR$BINTXT( TEMP$, LASTUTS, %OCT_FMT, ARS );
      944    12889                  TEMP$ -> CHAR$1 = '=';
      945    12890                  SIZE = SIZE + ARS;
      946    12891           Don't print creation UTS in octal */
      947    12892    2             CALL DDQ$WRITE( BUF$, SIZE );

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:140  
  12892  2 003055   200206 631500                    EPPR1   SIZE,,AUTO
         2 003056   200623 451500                    STP1    DEFI+3,,AUTO
         2 003057   200207 633500                    EPPR3   BUF$,,AUTO
         2 003060   200622 453500                    STP3    DEFI+2,,AUTO
         2 003061   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003062   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003063   000000 701000 xent               TSX1    DDQ$WRITE
         2 003064   000000 011000                    NOP     0

      948    12893    2             USED = S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT;

  12893  2 003065   000000 470400 xsym               LDP0    S_D$
         2 003066   000502 471500                    LDP1    322,,PR0
         2 003067   100002 235100                    LDA     2,,PR1
         2 003070   200226 755100                    STA     USED,,AUTO

      949    12894    2             IF USED ~= 0

  12894  2 003071   003156 600000 2                  TZE     s:12909

      950    12895    3             THEN DO;

      951    12896    3                  LASTUTS = S_D.RUM_BIRTH$ -> B$RUBIRTH.RUMED_UTS;

  12896  2 003072   100001 235100                    LDA     1,,PR1
         2 003073   200204 755100                    STA     LASTUTS,,AUTO

      952    12897    3                  CALL M$TIME( FPTTIME ) ALTRET( ARETT );

  12897  2 003074   200464 630500                    EPPR0   FPTTIME,,AUTO
         2 003075   420004 713400                    CLIMB   alt,+8196
         2 003076   402000 401760                    pmme    nvectors=5
         2 003077   003551 702000 2                  TSX2    ARETD

      953    12898    3                  SIZE = LENGTHC( VLR$LOCAL );

  12898  2 003100   000024 235007                    LDA     20,DL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:141  
         2 003101   200206 755100                    STA     SIZE,,AUTO

      954    12899    3                  CALL INSERT( S_D.OUTPUT, SIZE, , ' Last RUMed (' );

  12899  2 003102   773777 620005                    EAX0    -2049,AL
         2 003103   777777 660003                    ERX0    -1,DU
         2 003104   000000 470400 xsym               LDP0    S_D$
         2 003105   040145 100400                    MLR     fill='040'O
         2 003106   000403 000015 1                  ADSC9   VLP_FID_SN+37            cn=0,n=13
         2 003107   005335 000010                    ADSC9   2781,A,PR0               cn=0,n=*X0

      955    12900    3                  SIZE = SIZE + LENGTHC( ' Last RUMed (' );

  12900  2 003110   200206 236100                    LDQ     SIZE,,AUTO
         2 003111   000015 036007                    ADLQ    13,DL
         2 003112   200206 756100                    STQ     SIZE,,AUTO

      956    12901    3                  TEMP$ = PINCRC( BUF$, SIZE );

  12901  2 003113   000020 736000                    QLS     16
         2 003114   200207 036100                    ADLQ    BUF$,,AUTO
         2 003115   200215 756100                    STQ     TEMP$,,AUTO

      957    12902    3                  CALL DDR$BINTXT( TEMP$, USED, %UINT_FMT, ARS );

  12902  2 003116   200222 631500                    EPPR1   ARS,,AUTO
         2 003117   200625 451500                    STP1    DEFI+5,,AUTO
         2 003120   000063 236000 3                  LDQ     51
         2 003121   200624 756100                    STQ     DEFI+4,,AUTO
         2 003122   200226 633500                    EPPR3   USED,,AUTO
         2 003123   200623 453500                    STP3    DEFI+3,,AUTO
         2 003124   200215 634500                    EPPR4   TEMP$,,AUTO
         2 003125   200622 454500                    STP4    DEFI+2,,AUTO
         2 003126   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003127   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003130   000000 701000 xent               TSX1    DDR$BINTXT
         2 003131   000000 011000                    NOP     0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:142  

      958    12903    3                  SIZE = SIZE + ARS;

  12903  2 003132   200206 236100                    LDQ     SIZE,,AUTO
         2 003133   200222 036100                    ADLQ    ARS,,AUTO
         2 003134   200206 756100                    STQ     SIZE,,AUTO

      959    12904    3                  CALL INSERT( S_D.OUTPUT, SIZE, , ' times)' );

  12904  2 003135   773777 620006                    EAX0    -2049,QL
         2 003136   777777 660003                    ERX0    -1,DU
         2 003137   000000 470400 xsym               LDP0    S_D$
         2 003140   040146 100400                    MLR     fill='040'O
         2 003141   000407 000007 1                  ADSC9   VLP_FID_SN+41            cn=0,n=7
         2 003142   005335 000010                    ADSC9   2781,Q,PR0               cn=0,n=*X0

      960    12905    3                  SIZE = SIZE + LENGTHC( ' times)' );

  12905  2 003143   200206 235100                    LDA     SIZE,,AUTO
         2 003144   000007 035007                    ADLA    7,DL
         2 003145   200206 755100                    STA     SIZE,,AUTO

      961    12906    3                  CALL DDQ$WRITE( BUF$, SIZE );

  12906  2 003146   200206 631500                    EPPR1   SIZE,,AUTO
         2 003147   200623 451500                    STP1    DEFI+3,,AUTO
         2 003150   200207 633500                    EPPR3   BUF$,,AUTO
         2 003151   200622 453500                    STP3    DEFI+2,,AUTO
         2 003152   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003153   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003154   000000 701000 xent               TSX1    DDQ$WRITE
         2 003155   000000 011000                    NOP     0

      962    12907    3                END;

      963    12908    2           END;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:143  
      964    12909    1        LASTUTS = 0;                       /* It will never be 1976 again */

  12909  2 003156   200204 450100                    STZ     LASTUTS,,AUTO

      965    12910    1        INX = 0;

  12910  2 003157   200205 450100                    STZ     INX,,AUTO

      966    12911    1        FPTREAD = FPT_READ;

  12911  2 003160   000100 100400                    MLR     fill='000'O
         2 003161   000044 000070 1                  ADSC9   FPT_READ                 cn=0,n=56
         2 003162   200442 000070                    ADSC9   FPTREAD,,AUTO            cn=0,n=56

      967    12912    1        FPTREAD.V_ = VECTOR( FPTREAD.V );

  12912  2 003163   000016 235000 3                  LDA     14
         2 003164   200622 452500                    STP2    DEFI+2,,AUTO
         2 003165   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003166   000452 036003                    ADLQ    298,DU
         2 003167   200442 757100                    STAQ    FPTREAD,,AUTO

      968    12913    1        FPTREAD.BUF_ = VECTOR( RECBUF );

  12913  2 003170   000017 235000 3                  LDA     15
         2 003171   200622 452500                    STP2    DEFI+2,,AUTO
         2 003172   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003173   000003 036003                    ADLQ    3,DU
         2 003174   200446 757100                    STAQ    FPTREAD+4,,AUTO

      969    12914    1        KEYBUF = B_RUMKEY;

  12914  2 003175   000100 100400                    MLR     fill='000'O
         2 003176   000000 000013 1                  ADSC9   B_RUMKEY                 cn=0,n=11
         2 003177   200103 000400                    ADSC9   KEYBUF,,AUTO             cn=0,n=256

      970    12915    1        FPTREAD.KEY_ = VECTOR( KEYBUF );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:144  

  12915  2 003200   000017 235000 3                  LDA     15
         2 003201   200622 452500                    STP2    DEFI+2,,AUTO
         2 003202   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003203   000103 036003                    ADLQ    67,DU
         2 003204   200444 757100                    STAQ    FPTREAD+2,,AUTO

      971    12916    1        FPTREAD.V.DCB# = S_D.LMDCB;

  12916  2 003205   000000 470400 xsym               LDP0    S_D$
         2 003206   004774 720100                    LXL0    2556,,PR0
         2 003207   200452 740100                    STX0    FPTREAD+8,,AUTO

      972    12917    1        BRUMKEY = B_RUMKEY;

  12917  2 003210   000100 100400                    MLR     fill='000'O
         2 003211   000000 000013 1                  ADSC9   B_RUMKEY                 cn=0,n=11
         2 003212   200234 000013                    ADSC9   BRUMKEY,,AUTO            cn=0,n=11

      973    12918        /* Position to RUM reocrds */
      974    12919    1        CALL M$READ( FPTREAD ) ALTRET( ARETP );

  12919  2 003213   200442 630500                    EPPR0   FPTREAD,,AUTO
         2 003214   440000 713400                    CLIMB   alt,read
         2 003215   401400 401760                    pmme    nvectors=4
         2 003216   003535 702000 2                  TSX2    ARETP

  12917  2 003217                       READC        null
      975    12920    1   READC: ;
      976    12921    1        FPTREAD.V.KEYS# = '0'B;

  12921  2 003217   000020 236000 3                  LDQ     16
         2 003220   200452 356100                    ANSQ    FPTREAD+8,,AUTO

      977    12922    2        DO WHILE( '1'B );

      978    12923    2             CALL DDB$BREAK ALTRET( NONCHK );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:145  

  12923  2 003221   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003222   000000 701000 xent               TSX1    DDB$BREAK
         2 003223   003450 702000 2                  TSX2    NONCHK

      979    12924    2             CALL M$READ( FPTREAD ) ALTRET( ARETR );

  12924  2 003224   200442 630500                    EPPR0   FPTREAD,,AUTO
         2 003225   440000 713400                    CLIMB   alt,read
         2 003226   401400 401760                    pmme    nvectors=4
         2 003227   003543 702000 2                  TSX2    ARETR

      980    12925    2             BRUMKEY = KEYBUF;

  12925  2 003230   000100 100500                    MLR     fill='000'O
         2 003231   200103 000013                    ADSC9   KEYBUF,,AUTO             cn=0,n=11
         2 003232   200234 000013                    ADSC9   BRUMKEY,,AUTO            cn=0,n=11

      981    12926    2             IF BRUMKEY.KEYSIZ = B_RUMKEY.KEYSIZ

  12926  2 003233   200234 236100                    LDQ     BRUMKEY,,AUTO
         2 003234   000000 676000 1                  ERQ     B_RUMKEY
         2 003235   777000 376003                    ANQ     -512,DU
         2 003236   003450 601000 2                  TNZ     NONCHK

      982    12927    2             THEN IF ( BRUMKEY.NOTHD = B_RUMKEY.NOTHD ) AND

  12927  2 003237   200234 236100                    LDQ     BRUMKEY,,AUTO
         2 003240   000000 676000 1                  ERQ     B_RUMKEY
         2 003241   000777 376003                    ANQ     511,DU
         2 003242   003450 601000 2                  TNZ     NONCHK
         2 003243   200234 236100                    LDQ     BRUMKEY,,AUTO
         2 003244   000000 676000 1                  ERQ     B_RUMKEY
         2 003245   777000 376007                    ANQ     -512,DL
         2 003246   003450 601000 2                  TNZ     NONCHK

      983    12928    2                    ( BRUMKEY.TYPE = B_RUMKEY.TYPE )
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:146  
      984    12929    3                  THEN DO;

      985    12930    3                       IF BRUMKEY.SEQ = 1 THEN INX = INX + 1;

  12930  2 003247   200235 235100                    LDA     BRUMKEY+1,,AUTO
         2 003250   200236 236100                    LDQ     BRUMKEY+2,,AUTO
         2 003251   000033 773000                    LRL     27
         2 003252   777777 376007                    ANQ     -1,DL
         2 003253   000001 116007                    CMPQ    1,DL
         2 003254   003260 601000 2                  TNZ     s:12931

  12930  2 003255   200205 235100                    LDA     INX,,AUTO
         2 003256   000001 035007                    ADLA    1,DL
         2 003257   200205 755100                    STA     INX,,AUTO

      986    12931    3                       IF (NOT S_D.DO$->LIST$CMD.LIST_ALL) AND

  12931  2 003260   000000 470400 xsym               LDP0    S_D$
         2 003261   000031 471500                    LDP1    25,,PR0
         2 003262   100001 236100                    LDQ     1,,PR1
         2 003263   400000 316007                    CANQ    -131072,DL
         2 003264   003277 601000 2                  TNZ     s:12933
         2 003265   100001 236100                    LDQ     1,,PR1
         2 003266   000033 772000                    QRL     27
         2 003267   200205 116100                    CMPQ    INX,,AUTO
         2 003270   003272 600000 2                  TZE     s:12931+10
         2 003271   003217 603000 2                  TRC     READC
         2 003272   100001 236100                    LDQ     1,,PR1
         2 003273   000022 772000                    QRL     18
         2 003274   000777 376007                    ANQ     511,DL
         2 003275   200205 116100                    CMPQ    INX,,AUTO
         2 003276   003217 602000 2                  TNC     READC

      987    12932    3                        (INX<S_D.DO$->LIST$CMD.ID_FROM OR INX>S_D.DO$->LIST$CMD.ID_TO)
             12932                                  THEN GOTO READC;
      988    12933    3                       NONE = NONE + 1;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:147  
  12933  2 003277   200221 235100                    LDA     NONE,,AUTO
         2 003300   000001 035007                    ADLA    1,DL
         2 003301   200221 755100                    STA     NONE,,AUTO

      989    12934    3                       IF DELETE_FLAG

  12934  2 003302   200211 234100                    SZN     DELETE_FLAG,,AUTO
         2 003303   003311 605000 2                  TPL     s:12937

      990    12935    3                       THEN CALL M$DELREC( FPTDELREC ) ALTRET( ARETD );

  12935  2 003304   200276 630500                    EPPR0   FPTDELREC,,AUTO
         2 003305   440002 713400                    CLIMB   alt,+16386
         2 003306   401400 401760                    pmme    nvectors=4
         2 003307   003551 702000 2                  TSX2    ARETD
         2 003310   003221 710000 2                  TRA     s:12923

      991    12936    4                       ELSE DO;            /* List it */

      992    12937    4                            IF BRUMKEY.UTS ~= LASTUTS

  12937  2 003311   200234 235100                    LDA     BRUMKEY,,AUTO
         2 003312   200235 236100                    LDQ     BRUMKEY+1,,AUTO
         2 003313   000011 773000                    LRL     9
         2 003314   200204 116100                    CMPQ    LASTUTS,,AUTO
         2 003315   003342 600000 2                  TZE     s:12946

      993    12938    5                            THEN DO;       /* Print UTS */

      994    12939    5                                 LASTUTS = BRUMKEY.UTS;

  12939  2 003316   200204 756100                    STQ     LASTUTS,,AUTO

      995    12940    5                                 LASTNODE = 0; /* Root (doesn't get printed) */

  12940  2 003317   200203 450100                    STZ     LASTNODE,,AUTO

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:148  
      996    12941    5                                 BUF$ -> VLR$LOCAL.SPACE = ' ';

  12941  2 003320   200207 471500                    LDP1    BUF$,,AUTO
         2 003321   040100 100400                    MLR     fill='040'O
         2 003322   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003323   100002 000001                    ADSC9   2,,PR1                   cn=0,n=1

      997    12942    5                                 CALL M$TIME( FPTTIME ) ALTRET( ARETT );

  12942  2 003324   200464 630500                    EPPR0   FPTTIME,,AUTO
         2 003325   420004 713400                    CLIMB   alt,+8196
         2 003326   402000 401760                    pmme    nvectors=5
         2 003327   003551 702000 2                  TSX2    ARETD

      998    12943    5                                 SIZE = LENGTHC( VLR$LOCAL );

  12943  2 003330   000024 235007                    LDA     20,DL
         2 003331   200206 755100                    STA     SIZE,,AUTO

      999    12944    5                                 CALL DDQ$WRITE( BUF$, SIZE );

  12944  2 003332   200206 630500                    EPPR0   SIZE,,AUTO
         2 003333   200623 450500                    STP0    DEFI+3,,AUTO
         2 003334   200207 631500                    EPPR1   BUF$,,AUTO
         2 003335   200622 451500                    STP1    DEFI+2,,AUTO
         2 003336   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003337   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003340   000000 701000 xent               TSX1    DDQ$WRITE
         2 003341   000000 011000                    NOP     0

     1000    12945    5                               END;

     1001    12946    4                            IF BRUMKEY.NODE ~= LASTNODE

  12946  2 003342   200236 236100                    LDQ     BRUMKEY+2,,AUTO
         2 003343   000011 772000                    QRL     9
         2 003344   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:149  
         2 003345   200203 116100                    CMPQ    LASTNODE,,AUTO
         2 003346   003406 600000 2                  TZE     s:12953

     1002    12947    5                            THEN DO;       /* Print node name */

     1003    12948    5                                 LASTNODE = BRUMKEY.NODE;

  12948  2 003347   200203 756100                    STQ     LASTNODE,,AUTO

     1004    12949    5                                 CALL CONCAT( S_D.OUTPUT, 'Use Node ', S_D.B$TREE$ ->
             12949                                          B$NODE.NAME$( LASTNODE ) -> TEXT$C.TXT );

  12949  2 003350   000000 470400 xsym               LDP0    S_D$
         2 003351   004767 471500                    LDP1    2551,,PR0
         2 003352   000006 402007                    MPY     6,DL
         2 003353   100000 473506                    LDP3    0,QL,PR1
         2 003354   300000 236100                    LDQ     0,,PR3
         2 003355   000033 772000                    QRL     27
         2 003356   040100 100400                    MLR     fill='040'O
         2 003357   000411 000011 1                  ADSC9   VLP_FID_SN+43            cn=0,n=9
         2 003360   005335 000011                    ADSC9   2781,,PR0                cn=0,n=9
         2 003361   000000 620006                    EAX0    0,QL
         2 003362   040100 100540                    MLR     fill='040'O
         2 003363   300000 200010                    ADSC9   0,,PR3                   cn=1,n=*X0
         2 003364   005337 203767                    ADSC9   2783,,PR0                cn=1,n=2039

     1005    12950    5                                 SIZE = S_D.B$TREE$ -> B$NODE.NAME$( LASTNODE ) ->
             12950                                          TEXT$C.SIZE + LENGTHC( 'Use Node ' );

  12950  2 003365   000000 470400 xsym               LDP0    S_D$
         2 003366   004767 471500                    LDP1    2551,,PR0
         2 003367   200203 236100                    LDQ     LASTNODE,,AUTO
         2 003370   000006 402007                    MPY     6,DL
         2 003371   100000 473506                    LDP3    0,QL,PR1
         2 003372   300000 236100                    LDQ     0,,PR3
         2 003373   000033 772000                    QRL     27
         2 003374   000011 036007                    ADLQ    9,DL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:150  
         2 003375   200206 756100                    STQ     SIZE,,AUTO

     1006    12951    5                                 CALL DDQ$WRITE( BUF$, SIZE );

  12951  2 003376   200206 633500                    EPPR3   SIZE,,AUTO
         2 003377   200623 453500                    STP3    DEFI+3,,AUTO
         2 003400   200207 634500                    EPPR4   BUF$,,AUTO
         2 003401   200622 454500                    STP4    DEFI+2,,AUTO
         2 003402   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003403   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003404   000000 701000 xent               TSX1    DDQ$WRITE
         2 003405   000000 011000                    NOP     0

     1007    12952    5                               END;

     1008    12953    4                            SIZE = BRUMKEY.SEQ;

  12953  2 003406   200235 235100                    LDA     BRUMKEY+1,,AUTO
         2 003407   200236 236100                    LDQ     BRUMKEY+2,,AUTO
         2 003410   000033 773000                    LRL     27
         2 003411   777777 376007                    ANQ     -1,DL
         2 003412   200206 756100                    STQ     SIZE,,AUTO

     1009    12954    4                            CALL BINCHAR( BUF$ -> CHAR$5, SIZE );

  12954  2 003413   000000 235003                    LDA     0,DU
         2 003414   200622 757100                    STAQ    DEFI+2,,AUTO
         2 003415   200207 470500                    LDP0    BUF$,,AUTO
         2 003416   000100 301500                    BTD
         2 003417   200622 000010                    NDSC9   DEFI+2,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         2 003420   000000 030005                    NDSC9   0,,PR0                   cn=0,s=nosgn,sf=0,n=5

     1010    12955    4                           CALL INSERT( S_D.OUTPUT, LENGTHC( CHAR$5 ), , ' ', RECBUF )
             12955                                     ;

  12955  2 003421   000000 470400 xsym               LDP0    S_D$
         2 003422   000040 236003                    LDQ     32,DU
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:151  
         2 003423   005336 552120                    STBQ    2782,'20'O,PR0
         2 003424   040100 100500                    MLR     fill='040'O
         2 003425   200003 000400                    ADSC9   RECBUF,,AUTO             cn=0,n=256
         2 003426   005336 403772                    ADSC9   2782,,PR0                cn=2,n=2042

     1011    12956    4                            SIZE = DCB$ -> F$DCB.ARS# + LENGTHC( CHAR$5 ) + LENGTHC(
             12956                                     ' ' );

  12956  2 003427   200210 470500                    LDP0    DCB$,,AUTO
         2 003430   000000 235100                    LDA     0,,PR0
         2 003431   000006 035007                    ADLA    6,DL
         2 003432   200206 755100                    STA     SIZE,,AUTO

     1012    12957    4                            IF SIZE > LENGTHC( S_D.OUTPUT )

  12957  2 003433   004001 115007                    CMPA    2049,DL
         2 003434   003437 602000 2                  TNC     s:12959

     1013    12958    4                            THEN SIZE = LENGTHC( S_D.OUTPUT );

  12958  2 003435   004000 236007                    LDQ     2048,DL
         2 003436   200206 756100                    STQ     SIZE,,AUTO

     1014    12959    4                            CALL DDQ$WRITE( BUF$, SIZE );

  12959  2 003437   200206 631500                    EPPR1   SIZE,,AUTO
         2 003440   200623 451500                    STP1    DEFI+3,,AUTO
         2 003441   200207 633500                    EPPR3   BUF$,,AUTO
         2 003442   200622 453500                    STP3    DEFI+2,,AUTO
         2 003443   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003444   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003445   000000 701000 xent               TSX1    DDQ$WRITE
         2 003446   000000 011000                    NOP     0

     1015    12960    4                          END;             /* List it */

     1016    12961    3                     END;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:152  

  12961  2 003447   003221 710000 2                  TRA     s:12923

     1017    12962    2                  ELSE GOTO NONCHK;
     1018    12963    2             ELSE
     1019    12964    3   NONCHK:   DO;

  12964  2 003450                       NONCHK       null
     1020    12965    3                  IF DELETE_FLAG

  12965  2 003450   200211 234100                    SZN     DELETE_FLAG,,AUTO
         2 003451   003502 605000 2                  TPL     s:12971

     1021    12966    4                  THEN DO;

     1022    12967    4                       CALL DDR$BINTXT( BUF$, NONE, %UINT_FMT, SIZE );

  12967  2 003452   200206 630500                    EPPR0   SIZE,,AUTO
         2 003453   200625 450500                    STP0    DEFI+5,,AUTO
         2 003454   000063 236000 3                  LDQ     51
         2 003455   200624 756100                    STQ     DEFI+4,,AUTO
         2 003456   200221 631500                    EPPR1   NONE,,AUTO
         2 003457   200623 451500                    STP1    DEFI+3,,AUTO
         2 003460   200207 633500                    EPPR3   BUF$,,AUTO
         2 003461   200622 453500                    STP3    DEFI+2,,AUTO
         2 003462   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003463   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 003464   000000 701000 xent               TSX1    DDR$BINTXT
         2 003465   000000 011000                    NOP     0

     1023    12968    4                       CALL INSERT( S_D.OUTPUT, SIZE, LENGTHC( S_D.OUTPUT ) - SIZE,
             12968                                ' record(s) deleted.' );

  12968  2 003466   200206 720100                    LXL0    SIZE,,AUTO
         2 003467   773777 620010                    EAX0    -2049,X0
         2 003470   777777 660003                    ERX0    -1,DU
         2 003471   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:153  
         2 003472   200206 235100                    LDA     SIZE,,AUTO
         2 003473   040145 100400                    MLR     fill='040'O
         2 003474   000414 000023 1                  ADSC9   VLP_FID_SN+46            cn=0,n=19
         2 003475   005335 000010                    ADSC9   2781,A,PR0               cn=0,n=*X0

     1024    12969    4                       SIZE = SIZE + LENGTHC( ' record(s) deleted.' );

  12969  2 003476   200206 235100                    LDA     SIZE,,AUTO
         2 003477   000023 035007                    ADLA    19,DL
         2 003500   200206 755100                    STA     SIZE,,AUTO

     1025    12970    4                     END;

  12970  2 003501   003522 710000 2                  TRA     s:12977

     1026    12971    3                  ELSE IF NONE = 0 AND (S_D.DO$->LIST$CMD.ID_FROM > 0 AND S_D.DO$->
             12971                           LIST$CMD.ID_TO > 0)

  12971  2 003502   200221 235100                    LDA     NONE,,AUTO
         2 003503   003521 601000 2                  TNZ     s:12976
         2 003504   000000 470400 xsym               LDP0    S_D$
         2 003505   000031 471500                    LDP1    25,,PR0
         2 003506   100001 236100                    LDQ     1,,PR1
         2 003507   777000 316003                    CANQ    -512,DU
         2 003510   003521 600000 2                  TZE     s:12976
         2 003511   000777 316003                    CANQ    511,DU
         2 003512   003521 600000 2                  TZE     s:12976

     1027    12972    4                       THEN DO;

     1028    12973    4                            S_D.OUTPUT = 'None';

  12973  2 003513   040100 100400                    MLR     fill='040'O
         2 003514   000421 000004 1                  ADSC9   VLP_FID_SN+51            cn=0,n=4
         2 003515   005335 004000                    ADSC9   2781,,PR0                cn=0,n=2048

     1029    12974    4                            SIZE = LENGTHC( 'None' );
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:154  

  12974  2 003516   000004 236007                    LDQ     4,DL
         2 003517   200206 756100                    STQ     SIZE,,AUTO

     1030    12975    4                          END;

  12975  2 003520   003522 710000 2                  TRA     s:12977

     1031    12976    3                       ELSE SIZE = 0;

  12976  2 003521   200206 450100                    STZ     SIZE,,AUTO

     1032    12977    3                  IF SIZE ~= 0

  12977  2 003522   200206 235100                    LDA     SIZE,,AUTO
         2 003523   003534 600000 2                  TZE     s:12979

     1033    12978    3                  THEN CALL DDQ$WRITE( BUF$, SIZE );

  12978  2 003524   200206 630500                    EPPR0   SIZE,,AUTO
         2 003525   200623 450500                    STP0    DEFI+3,,AUTO
         2 003526   200207 631500                    EPPR1   BUF$,,AUTO
         2 003527   200622 451500                    STP1    DEFI+2,,AUTO
         2 003530   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003531   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003532   000000 701000 xent               TSX1    DDQ$WRITE
         2 003533   000000 011000                    NOP     0

     1034    12979    3                  RETURN;

  12979  2 003534   000000 702200 xent               TSX2  ! X66_ARET

     1035    12980    3                END NONCHK;
     1036    12981    2           END;

  12980  2 003535                       ARETP        null
     1037    12982    1   ARETP: ;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:155  
     1038    12983    1        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$NOKEY

  12983  2 003535   000000 470400 xsym               LDP0    B$TCB$
         2 003536   000000 471500                    LDP1    0,,PR0
         2 003537   100102 236100                    LDQ     66,,PR1
         2 003540   377770 376007                    ANQ     131064,DL
         2 003541   001020 116007                    CMPQ    528,DL
         2 003542   003217 600000 2                  TZE     READC

  12983  2 003543                       ARETR        null
     1039    12984    1        THEN GOTO READC;
     1040    12985    1   ARETR: ;
     1041    12986    1        IF B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.CODE = %E$EOF

  12986  2 003543   000000 470400 xsym               LDP0    B$TCB$
         2 003544   000000 471500                    LDP1    0,,PR0
         2 003545   100102 236100                    LDQ     66,,PR1
         2 003546   377770 376007                    ANQ     131064,DL
         2 003547   000060 116007                    CMPQ    48,DL
         2 003550   003450 600000 2                  TZE     NONCHK

  12986  2 003551                       ARETD        null
  12986  2 003551                       ARETF        null
  12986  2 003551                       ARETG        null
  12986  2 003551                       ARETT        null
  12986  2 003551                       ARETU        null
     1042    12987    1        THEN GOTO NONCHK;
     1043    12988    1   ARETD: ;
     1044    12989    1   ARETF: ;
     1045    12990    1   ARETG: ;
     1046    12991    1   ARETT: ;
     1047    12992    1   ARETU: ;
     1048    12993    1        CALL DUE$ERRMSG;

  12993  2 003551   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 003552   000000 701000 xent               TSX1    DUE$ERRMSG
         2 003553   000000 011000                    NOP     0
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:156  

     1049    12994    1        RETURN;

  12994  2 003554   000000 702200 xent               TSX2  ! X66_ARET

     1050    12995                                                /**/
     1051    12996        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:157  
     1052    12997        /*F* NAME: DUA$SHOW_RUM
     1053    12998             PURPOSE: To put the text FID of the RU currently being RUMed into
     1054    12999                      the output display buffer.
     1055    13000             DESCRIPTION: The text name of the RU currently being RUMed is obtained
     1056    13001                          from the dcb S_D.RUMDCB using M$UNFID. DDQ$WRITE is
     1057    13002                          called to write out the message "RUM FID". */
     1058    13003        /*D* NAME: DUA$SHOW_RUM
     1059    13004             ENTRY: DUA$SHOW_RUM
     1060    13005             CALL: CALL DUA$SHOW_RUM;
     1061    13006             SCRATCH: Local AUTO only.
     1062    13007             DESCRIPTION: The text name of the RU currently being RUMed is obtained
     1063    13008                          from the dcb S_D.RUMDCB using M$UNFID. DDQ$WRITE is
     1064    13009                          called to write out the message "RUM FID". */
     1065    13010                                                /**/
     1066    13011    1   DUA$SHOW_RUM: ENTRY;

  13011  2 003555   000000 700200 xent  DUA$SHOW_RUM TSX0  ! X66_AUTO_0
         2 003556   000630 000000                    ZERO    408,0

     1067    13012                                                /**/
     1068    13013    1        FPTUNFID = FPT_UNFID;

  13013  2 003557   000100 100400                    MLR     fill='000'O
         2 003560   000310 000130 1                  ADSC9   FPT_UNFID                cn=0,n=88
         2 003561   200500 000130                    ADSC9   FPTUNFID,,AUTO           cn=0,n=88

     1069    13014    1        FPTUNFID.V_ = VECTOR( FPTUNFID.V );

  13014  2 003562   000003 235000 3                  LDA     3
         2 003563   200622 452500                    STP2    DEFI+2,,AUTO
         2 003564   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003565   000524 036003                    ADLQ    340,DU
         2 003566   200500 757100                    STAQ    FPTUNFID,,AUTO

     1070    13015    1        FPTUNFID.V.DCB# = S_D.LMDCB;

  13015  2 003567   000000 470400 xsym               LDP0    S_D$
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:158  
         2 003570   004774 720100                    LXL0    2556,,PR0
         2 003571   200524 740100                    STX0    FPTUNFID+20,,AUTO

     1071    13016    1        FPTUNFID.TEXTFID_ = VECTOR( RECBUF );

  13016  2 003572   000017 235000 3                  LDA     15
         2 003573   200622 452500                    STP2    DEFI+2,,AUTO
         2 003574   200622 236100                    LDQ     DEFI+2,,AUTO
         2 003575   000003 036003                    ADLQ    3,DU
         2 003576   200502 757100                    STAQ    FPTUNFID+2,,AUTO

     1072    13017    1        CALL M$UNFID( FPTUNFID ) ALTRET( ARETU );

  13017  2 003577   200500 630500                    EPPR0   FPTUNFID,,AUTO
         2 003600   420021 713400                    CLIMB   alt,+8209
         2 003601   404400 401760                    pmme    nvectors=10
         2 003602   003551 702000 2                  TSX2    ARETD

     1073    13018    1        BUF$ = ADDR( S_D.OUTPUT );

  13018  2 003603   000000 236000 xsym               LDQ     S_D$
         2 003604   005335 036003                    ADLQ    2781,DU
         2 003605   200207 756100                    STQ     BUF$,,AUTO

     1074    13019    1        CALL INDEX( SIZE, ' ', RECBUF );   /* Get 1st blank */

  13019  2 003606   000000 124500                    SCM     mask='000'O
         2 003607   200003 000400                    ADSC9   RECBUF,,AUTO             cn=0,n=256
         2 003610   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 003611   200206 000100                    ARG     SIZE,,AUTO

     1075    13020    1        SIZE = LENGTHC( 'RUM ' ) + SIZE;

  13020  2 003612   200206 235100                    LDA     SIZE,,AUTO
         2 003613   000004 035007                    ADLA    4,DL
         2 003614   200206 755100                    STA     SIZE,,AUTO

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:159  
     1076    13021    1        IF SIZE > LENGTHC( S_D.OUTPUT )

  13021  2 003615   004001 115007                    CMPA    2049,DL
         2 003616   003621 602000 2                  TNC     s:13023

     1077    13022    1        THEN SIZE = LENGTHC( S_D.OUTPUT );

  13022  2 003617   004000 235007                    LDA     2048,DL
         2 003620   200206 755100                    STA     SIZE,,AUTO

     1078    13023    1        CALL CONCAT( S_D.OUTPUT, 'RUM ', RECBUF );

  13023  2 003621   000422 236000 1                  LDQ     VLP_FID_SN+52
         2 003622   000000 470400 xsym               LDP0    S_D$
         2 003623   005335 756100                    STQ     2781,,PR0
         2 003624   040100 100500                    MLR     fill='040'O
         2 003625   200003 000400                    ADSC9   RECBUF,,AUTO             cn=0,n=256
         2 003626   005336 003774                    ADSC9   2782,,PR0                cn=0,n=2044

     1079    13024    1        CALL DDQ$WRITED( BUF$, SIZE );

  13024  2 003627   200206 630500                    EPPR0   SIZE,,AUTO
         2 003630   200623 450500                    STP0    DEFI+3,,AUTO
         2 003631   200207 631500                    EPPR1   BUF$,,AUTO
         2 003632   200622 451500                    STP1    DEFI+2,,AUTO
         2 003633   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003634   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 003635   000000 701000 xent               TSX1    DDQ$WRITED
         2 003636   000000 011000                    NOP     0

     1080    13025                                                /**/
     1081    13026    1        RETURN;

  13026  2 003637   000000 702200 xent               TSX2  ! X66_ARET

     1082    13027                                                /**/
     1083    13028        %EJECT;
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:160  
     1084    13029        /*F* NAME: DUA$RUM_COMM
     1085    13030             PURPOSE: To record commands that are all comments in RUM RU.
     1086    13031             DESCRIPTION: eThe current command in S_D.INPUT consists of comments
     1087    13032                          only. These comments will be recorded in the current
     1088    13033                          RU being RUMed if the write access to the RU is available. */
     1089    13034        /*D* NAME: DUA$RUM_COMM
     1090    13035             ENTRY: DUA$RUM_COMM
     1091    13036             CALL: CALL DUA$RUM_COMM;
     1092    13037             INPUT: S_D.INPUT - Text string to be recorded.
     1093    13038                    S_D.NCHARS - Size of text string to be recorded.
     1094    13039             SCRATCH: Local AUTO only.
     1095    13040             DESCRIPTION: lThe current command in S_D.INPUT consists of comments
     1096    13041                          only. These comments will be recorded in the current
     1097    13042                          RU being RUMed if the write access to the RU is available. */
     1098    13043                                                /**/
     1099    13044    1   DUA$RUM_COMM: ENTRY;

  13044  2 003640   000000 700200 xent  DUA$RUM_COMM TSX0  ! X66_AUTO_0
         2 003641   000630 000000                    ZERO    408,0

     1100    13045                                                /**/
     1101    13046    1        DCB$ = DCBADDR( S_D.LMDCB );

  13046  2 003642   000012 470400 3                  LDP0    10
         2 003643   000000 471500                    LDP1    0,,PR0
         2 003644   000000 473400 xsym               LDP3    S_D$
         2 003645   304774 720100                    LXL0    2556,,PR3
         2 003646   100000 236110                    LDQ     0,X0,PR1
         2 003647   200210 756100                    STQ     DCB$,,AUTO

     1102    13047    1        IF DCB$ -> F$DCB.FFLG.UPD#

  13047  2 003650   200210 474500                    LDP4    DCB$,,AUTO
         2 003651   400004 236100                    LDQ     4,,PR4
         2 003652   040000 316003                    CANQ    16384,DU
         2 003653   003704 600000 2                  TZE     s:13054

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:161  
     1103    13048    1        THEN IF ( S_D.RUMSEQ = 0 ) AND ( S_D.RUM_BIRTH$ ~= ADDR( NIL ) )

  13048  2 003654   305000 235100                    LDA     2560,,PR3
         2 003655   003704 601000 2                  TNZ     s:13054
         2 003656   300502 236100                    LDQ     322,,PR3
         2 003657   000001 116000 xsym               CMPQ    B_VECTNIL+1
         2 003660   003704 600000 2                  TZE     s:13054

     1104    13049    2             THEN DO;

     1105    13050    2                  S_D.RUM_BIRTH$ -> B$RUBIRTH.RUMED_UTS = S_D.RUMUTS;

  13050  2 003661   300502 475500                    LDP5    322,,PR3
         2 003662   304777 235100                    LDA     2559,,PR3
         2 003663   500001 755100                    STA     1,,PR5

     1106    13051    2                 S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT = S_D.RUM_BIRTH$ -> B$RUBIRTH.COUNT
             13051                           + 1;

  13051  2 003664   300502 475500                    LDP5    322,,PR3
         2 003665   500002 235100                    LDA     2,,PR5
         2 003666   000001 035007                    ADLA    1,DL
         2 003667   500002 755100                    STA     2,,PR5

     1107    13052    2                 CALL DDQ$WRITELM( %TYPBIRTH, 0, 0, S_D.RUM_BIRTH$, SIZEC( B$RUBIRTH )
             13052                           ); /* Ignore altret */

  13052  2 003670   000032 236000 3                  LDQ     26
         2 003671   200626 756100                    STQ     DEFI+6,,AUTO
         2 003672   000000 236000 xsym               LDQ     S_D$
         2 003673   000502 036003                    ADLQ    322,DU
         2 003674   000024 235000 3                  LDA     20
         2 003675   200624 757100                    STAQ    DEFI+4,,AUTO
         2 003676   000034 237000 3                  LDAQ    28
         2 003677   200622 757100                    STAQ    DEFI+2,,AUTO
         2 003700   200622 630500                    EPPR0   DEFI+2,,AUTO
         2 003701   000023 631400 xsym               EPPR1   B_VECTNIL+19
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:162  
         2 003702   000000 701000 xent               TSX1    DDQ$WRITELM
         2 003703   000000 011000                    NOP     0

     1108    13053    2                END;

     1109    13054    1        IF DCB$ -> F$DCB.FFLG.WNEW#

  13054  2 003704   200210 470500                    LDP0    DCB$,,AUTO
         2 003705   000004 236100                    LDQ     4,,PR0
         2 003706   100000 316003                    CANQ    32768,DU
         2 003707   003732 600000 2                  TZE     s:13057

     1110    13055    1        THEN CALL DDQ$WRITELM( %TYPRUM, 0 /*@PAGE*/, S_D.NODE, ADDR( S_D.INPUT ), S_D.
             13055                 NCHARS ); /* Ignore altret */

  13055  2 003710   000000 236000 xsym               LDQ     S_D$
         2 003711   000610 036003                    ADLQ    392,DU
         2 003712   200622 756100                    STQ     DEFI+2,,AUTO
         2 003713   000000 236000 xsym               LDQ     S_D$
         2 003714   000065 036003                    ADLQ    53,DU
         2 003715   200627 756100                    STQ     DEFI+7,,AUTO
         2 003716   200622 631500                    EPPR1   DEFI+2,,AUTO
         2 003717   200626 451500                    STP1    DEFI+6,,AUTO
         2 003720   000000 236000 xsym               LDQ     S_D$
         2 003721   004706 036003                    ADLQ    2502,DU
         2 003722   000024 235000 3                  LDA     20
         2 003723   200624 757100                    STAQ    DEFI+4,,AUTO
         2 003724   000065 236000 3                  LDQ     53
         2 003725   200623 756100                    STQ     DEFI+3,,AUTO
         2 003726   200623 630500                    EPPR0   DEFI+3,,AUTO
         2 003727   000023 631400 xsym               EPPR1   B_VECTNIL+19
         2 003730   000000 701000 xent               TSX1    DDQ$WRITELM
         2 003731   000000 011000                    NOP     0

     1111    13056                                                /**/
     1112    13057    1        RETURN;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:163  
  13057  2 003732   000000 702200 xent               TSX2  ! X66_ARET

B_RUMKEY
 Sect OctLoc
   1     000   012777 024000   000000 000000   000000 000***                    ............

FPT_FID
 Sect OctLoc
   1     004   000003 777640   000030 006000   000000 177640   000000 006014    ................
   1     010   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     030*  777000 000000   000000 000000   000000 000000   ****** ******    ................

FPT_GETDCB
 Sect OctLoc
   1     034   000001 777640   000042 006000   000000 177640   000000 006014    ....."..........
   1     040   000000 177640   000000 006014   000000 000000   000000 000000    ................

FPT_READ
 Sect OctLoc
   1     044   000005 777640   000054 006000   000000 177640   000000 006014    .....,..........
   1     050   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     054   000000 700000   000000 000000   000000 000000   000000 000000    ................
   1     060   000000 000000   000000 000000                                    ........

FPT_DELREC
 Sect OctLoc
   1     062   000001 777640   000072 006000   000000 177640   000000 006014    .....:..........
   1     066   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     072   000000 000000   000000 000000                                    ........

FPT_OPEN
 Sect OctLoc
   1     074   000025 777640   000140 006000   000000 177640   000000 006014    .....`..........
   1     100   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     140*  000000 400042   000000 001000   252525 000000   000040 252520    ..."......... ..
   1     144   000040 040040   000000 000000   000000 777777   000000 000000    .   ............
   1     150   000000 000000   000000 000000   000000 000000   000000 000000    ................
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:164  
   1     154   251000 622000   000000 000000   000000 000000   111250 000000    ............I...
   1     160   040040 040040   000000 000000   000000 000000   000000 000000        ............
   1     164   000000 000000   ****** ******                                    ........

FPT_CLOSE
 Sect OctLoc
   1     166   000003 777640   000220 006000   000000 177640   000000 006014    ................
   1     172   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     216*  000000 177640   000000 006014   000000 000002   000000 000040    ...............
   1     222   000220 000000   000000 000000                                    ........

FPT_RELDCB
 Sect OctLoc
   1     224   000001 777640   000226 006000   000000 000000   000000 000000    ................

FPT_LOCTIME
 Sect OctLoc
   1     230   000001 777640   000242 006000   000000 177640   000000 006014    ................
   1     234   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     240   000000 177640   000000 006014   003004 000000   ****** ******    ................

FPT_UNTIME
 Sect OctLoc
   1     244   000001 777640   000256 006000   000000 177640   000000 006014    ................
   1     250   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     254   000000 177640   000000 006014   004003 000000   ****** ******    ................

FPT_TIME
 Sect OctLoc
   1     260   000001 777640   000272 006000   000000 177640   000000 006014    ................
   1     264   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     270   000000 177640   000000 006014   000004 000000   ****** ******    ................

FPT_WRITE
 Sect OctLoc
   1     274   000003 777640   000304 006000   000000 177640   000000 006014    ................
   1     300   000000 177640   000000 006014   000000 177640   000000 006014    ................
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:165  
   1     304   000000 400400   000000 000000   000000 000000   000000 000000    ................

FPT_UNFID
 Sect OctLoc
   1     310   000001 777640   000334 006000   000000 177640   000000 006014    ................
   1     314   000000 177640   000000 006014   000000 177640   000000 006014    ................
   1     334*  000000 000000   0***** ******                                    ........

VLP_FID_SN
 Sect OctLoc
   1     336   000000 000001   040040 040040   040040 ******                    ....      ..

(unnamed)
 Sect OctLoc
   1     341   ****** ******   115072 106105   120040 040040   056056 103157    ....M:FEP   ..Co
   1     345   160171 151156   147040 050102   122105 101113   040164 157040    pying (BREAK to
   1     351   141142 157162   164051 040040   072123 131123   052052 052040    abort)  :SYS***
   1     355   116117 040105   162162 157162   163040 145156   143157 165156    NO Errors encoun
   1     361   164145 162145   144040 151156   040146 151154   145040 040040    tered in file
   1     365   052052 052052   040060 060060   060060 040105   162162 157162    **** 00000 Error
   1     371   163040 145156   143157 165156   164145 162145   144040 151156    s encountered in
   1     375   040146 151154   145040 040040   040103 162145   141164 151157     file    Creatio
   1     401   156040 125124   123040 040040   040114 141163   164040 122125    n UTS    Last RU
   1     405   115145 144040   050040 040040   040164 151155   145163 051040    Med (    times)
   1     411   125163 145040   116157 144145   040040 040040   040162 145143    Use Node     rec
   1     415   157162 144050   163051 040144   145154 145164   145144 056040    ord(s) deleted.
   1     421   116157 156145   122125 115040                                    NoneRUM

(unnamed)
 Sect OctLoc
   3     000   000003 777640   000010 200000   000020 177640   000001 777640    ................
   3     004   000415 600000   000011 777640   000025 777640   000000 002000    ................
   3     010   000000 006000   000007 006000   000000 006003   000000 000000    ................
   3     014   000000 177640   000000 006014   000005 777640   000077 777640    .............?..
   3     020   777777 577777   776777 777777   000000 000240   000022 006000    ................
   3     024   000002 006000   000000 000000   000002 006000   000002 006000    ................
   3     030   000000 000025   000000 000014   000031 006000   000000 000000    ................
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:166  
   3     034   000030 006000   000002 006000   000002 577640   000004 200000    ................
   3     040   000003 777777   000077 776000   000001 400000   000003 400000    .....?..........
   3     044   000000 000036   000044 006000   000014 006000   000000 000022    .....$..........
   3     050   000047 006000   000015 006000   000000 006000   000006 006000    .'..............
   3     054   000767 377640   005345 400000   000000 000110   000056 006000    ...........H....
   3     060   000766 377640   005346 400000   000002 200000   000004 006000    ................
   3     064   000000 000024   000064 006000                                    .....4..
     1113    13058                                                /**/
     1114    13059    1   END DUA$RUM;

PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:167  
--  Include file information  --

   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   DD_SUBS_C.:E05TOU  is referenced.
   DD_PSUBS_C.:E05TOU  is referenced.
   DD_ERR_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   DD_SD_M.:E05TOU  is referenced.
   XUH_MACRO_C.:E05TOU  is referenced.
   B$ROSEG.:E05TOU  cannot be made into a system file and is referenced.
   DD$BASED.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure DUA$RUM.

   Procedure DUA$RUM requires 2011 words for executable code.
   Procedure DUA$RUM requires 408 words of local(AUTO) storage.

    No errors detected in file DUA$RUM.:E05TSI    .
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:168  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:169  
          MINI XREF LISTING

ARETCC
     12338**LABEL   12336--CALLALT
ARETCCE
     12607**LABEL   12610--CALLALT
ARETD
     12986**LABEL   12935--CALLALT
ARETF
     12986**LABEL   12222--CALLALT
ARETG
     12986**LABEL   12238--CALLALT
ARETGC
     12619**LABEL   12288--CALLALT
ARETOC
     12610**LABEL   12295--CALLALT
ARETP
     12980**LABEL   12919--CALLALT
ARETR
     12983**LABEL   12924--CALLALT
ARETRC
     12316**LABEL   12312--CALLALT
ARETRECE
     12617**LABEL   12619--CALLALT
ARETRERC
     12345**LABEL   12343--CALLALT
ARETT
     12986**LABEL   12881--CALLALT 12897--CALLALT 12942--CALLALT
ARETU
     12986**LABEL   13017--CALLALT
ARS
      5354**DCL     12357<<ASSIGN  12358<>CALL    12359>>IF      12371<<ASSIGN  12372<>CALL    12475<<ASSIGN
     12478<>CALL    12480>>ASSIGN  12481>>ASSIGN  12522<<ASSIGN  12525<>CALL    12527>>ASSIGN  12528>>ASSIGN
     12724<<ASSIGN  12725>>IF      12725>>IF      12902<>CALL    12903>>ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:170  
B$ALT.CODE
      6176**DCL      6176--REDEF    6177--REDEF    6177--REDEF
B$ALT.ERR.CODE
      6178**DCL     12316>>ASSIGN  12593>>IF      12812>>IF      12983>>IF      12986>>IF
B$ALT.ERR.ERR#
      6178**DCL      6178--REDEF
B$ALT.ERR.SEV
      6178**DCL     12584>>IF
B$ALT.EVID
      6177**DCL      6177--REDEF    6177--REDEF
B$HEAD
      5893**DCL     12355--ASSIGN  12358--CALL    12359--IF      12409--ASSIGN
B$HEAD.BIAS
      6057**DCL     12447>>ASSIGN  12455>>ASSIGN
B$HEAD.DCBRES
      5944**DCL     12485>>ASSIGN  12532>>ASSIGN
B$HEAD.FLAVOR
      6018**DCL     12361>>DOCASE
B$HEAD.LIB
      6023**DCL     12450>>IF
B$HEAD.OVRL
      6032**DCL     12498>>IF      12548>>IF
B$HEAD.PRECSIZE
      5955**DCL     12408>>ASSIGN
B$HEAD.RDATA
      5912**DCL     12454>>IF      12456>>ASSIGN  12551>>ASSIGN
B$HEAD.ROSIZE
      5971**DCL     12419>>ASSIGN
B$HEAD.START
      5938**DCL     12558>>ASSIGN
B$HEAD.TREEDISP
      5947**DCL     12497>>ASSIGN  12547>>ASSIGN
B$HEAD.UDCBNUM
      5941**DCL     12484>>ASSIGN  12531>>ASSIGN
B$HEAD.VDPGS
      5904**DCL     12447>>ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:171  
B$HEAD.VERSION#
      5973**DCL     12451>>IF
B$NODE
      6199**DCL     12506--ASSIGN
B$NODE.FLGS.NOW_IN
      6205**DCL     12502<<ASSIGN
B$NODE.NAME$
      6201**DCL     12505<<ASSIGN  12949>>CALLBLT 12949>>CALLBLT 12950>>ASSIGN
B$NODE.PADDR
      6229**DCL     12503>>ASSIGN
B$ROS$
      6727**DCL     12793>>ASSIGN
B$ROSEG
      6118**DCL     12421--ASSIGN  12426--ASSIGN  12466--ASSIGN  12513--ASSIGN
B$ROSEG.DCBPTR$
      6119**DCL     12467<<ASSIGN  12514<<ASSIGN
B$ROSEG.NUMDCBS
      6121**DCL     12486<<ASSIGN  12533<<ASSIGN
B$ROSEG.TREE$
      6120**DCL     12499<<ASSIGN  12500<<ASSIGN  12549<<ASSIGN  12550<<ASSIGN
B$RUBIRTH
      6100**DCL     12354--ASSIGN  12355--ASSIGN  12372--CALL    13052--CALL
B$RUBIRTH.COUNT
      6105**DCL     12893>>ASSIGN  13051<<ASSIGN  13051>>ASSIGN
B$RUBIRTH.CREATE_UTS
      6101**DCL     12390>>IF      12880>>ASSIGN
B$RUBIRTH.RUMED_UTS
      6103**DCL     12896>>ASSIGN  13050<<ASSIGN
B$TCB.ALT$
      6172**DCL     12316>>ASSIGN  12584>>IF      12593>>IF      12812>>IF      12983>>IF      12986>>IF
B$TCB$
      6726**DCL     12316>>ASSIGN  12584>>IF      12593>>IF      12812>>IF      12983>>IF      12986>>IF
B$TREEHDR
      6183**DCL     12501--ASSIGN
B$TREEHDR.NODES
      6185**DCL     12504>>DOINDEX
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:172  
BRUMKEY
      5372**DCL     12917<<ASSIGN  12925<<ASSIGN
BRUMKEY.KEYSIZ
      5373**DCL     12926>>IF
BRUMKEY.NODE
      5384**DCL     12946>>IF      12948>>ASSIGN
BRUMKEY.NOTHD
      5375**DCL     12927>>IF
BRUMKEY.SEQ
      5382**DCL     12930>>IF      12953>>ASSIGN
BRUMKEY.TYPE
      5378**DCL     12927>>IF
BRUMKEY.UTS
      5380**DCL     12937>>IF      12939>>ASSIGN
BUF$
      5343**DCL     12307<<ASSIGN  12309<>CALL    12759<<ASSIGN  12761<>CALL    12770<>CALL    12777<>CALL
     12780<>CALL    12869<<ASSIGN  12875>>ASSIGN  12876>>ASSIGN  12882>>ASSIGN  12892<>CALL    12901>>ASSIGN
     12906<>CALL    12941>>ASSIGN  12944<>CALL    12951<>CALL    12954>>CALLBLT 12959<>CALL    12967<>CALL
     12978<>CALL    13018<<ASSIGN  13024<>CALL
B_RUMKEY
      6304**DCL     12914>>ASSIGN  12917>>ASSIGN
B_RUMKEY.KEYSIZ
      6305**DCL     12926>>IF
B_RUMKEY.NOTHD
      6307**DCL     12927>>IF
B_RUMKEY.TYPE
      6310**DCL     12927>>IF
CHAR$5
      5835**DCL     12954<<CALLBLT 12955--CALLBLT 12956--ASSIGN
CODE
      5359**DCL     12250<<ASSIGN  12252>>IF      12255>>IF      12260>>IF      12282>>IF      12316<<ASSIGN
     12317>>IF      12322>>IF      12397>>IF
COPYDCB
      5361**DCL     12284<<ASSIGN  12287--ASSIGN  12289>>ASSIGN  12305>>ASSIGN  12347>>ASSIGN  12348>>ASSIGN
     12349--ASSIGN  12608>>ASSIGN  12618>>ASSIGN
COPY_BREAK
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:173  
     12599**LABEL   12311--CALLALT
COPY_CLOSE
     12325**LABEL   12323--GOTO
COPY_ERROR
     12599**LABEL   12324--GOTO    12330--CALLALT
DCB$
      5344**DCL     12265<<ASSIGN  12268>>IF      12268>>IF      12268>>IF      12273>>IF      12278<<ASSIGN
     12279>>IF      12279>>IF      12326>>ASSIGN  12349<<ASSIGN  12397>>IF      12397>>IF      12870<<ASSIGN
     12956>>ASSIGN  13046<<ASSIGN  13047>>IF      13054>>IF
DCB$PTR$
      5836**DCL     12469<<ASSIGN  12470--ASSIGN  12489<<ASSIGN  12490--ASSIGN  12493<<ASSIGN  12516<<ASSIGN
     12517--ASSIGN  12539<<ASSIGN  12540--ASSIGN  12543<<ASSIGN
DCBPTR$
      5352**DCL     12466<<ASSIGN  12467>>ASSIGN  12469>>ASSIGN  12470<<ASSIGN  12470>>ASSIGN  12476>>ASSIGN
     12487>>ASSIGN  12489>>ASSIGN  12489>>ASSIGN  12490<<ASSIGN  12490>>ASSIGN  12493>>ASSIGN  12494<<ASSIGN
     12494>>ASSIGN  12494--ASSIGN  12513<<ASSIGN  12514>>ASSIGN  12516>>ASSIGN  12517<<ASSIGN  12517>>ASSIGN
     12523>>ASSIGN  12534>>ASSIGN  12537>>ASSIGN  12538>>ASSIGN  12539>>ASSIGN  12540<<ASSIGN  12540>>ASSIGN
     12543>>ASSIGN  12544<<ASSIGN  12544>>ASSIGN  12544--ASSIGN
DCBRES
      5357**DCL     12485<<ASSIGN  12486>>ASSIGN  12492>>DOINDEX 12532<<ASSIGN  12533>>ASSIGN  12542>>DOINDEX
DDA$RESET_PATCH_SPACE
      9539**DCL-ENT 12555--CALL    12716--CALL
DDA$TRACEON
      9538**DCL-ENT 12731--CALL
DDB$BREAK
      9540**DCL-ENT 12311--CALL    12923--CALL
DDE$ERROR
      9541**DCL-ENT 12376--CALL    12571--CALL    12657--CALL    12663--CALL
DDM$GETMEM
      9542**DCL-ENT 12248--CALL    12438--CALL
DDM$PUTMEM
      9543**DCL-ENT 12751--CALL    12755--CALL
DDQ$READLM
      9544**DCL-ENT 12358--CALL    12372--CALL    12478--CALL    12525--CALL
DDQ$WRITE
      9545**DCL-ENT 12309--CALL    12761--CALL    12770--CALL    12777--CALL    12780--CALL    12892--CALL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:174  
     12906--CALL    12944--CALL    12951--CALL    12959--CALL    12978--CALL
DDQ$WRITED
      9546**DCL-ENT 13024--CALL
DDQ$WRITELM
      9547**DCL-ENT 13052--CALL    13055--CALL
DDR$BINTXT
      9548**DCL-ENT 12902--CALL    12967--CALL
DDR$REPORT
      9549**DCL-ENT 12567--CALL    12726--CALL
DDS$ES_INQ
      9550**DCL-ENT 12559--CALL    12719--CALL
DDS$SET_Q2C
      9551**DCL-ENT 12560--CALL    12720--CALL
DDT$TRACEOFF
      9552**DCL-ENT 12204--CALL
DD_RUMNODE$
      6730**DCL     12248<>CALL    12249>>ASSIGN  12258>>ASSIGN  12299>>ASSIGN  12329>>ASSIGN  12353>>ASSIGN
     12438<>CALL    12753>>ASSIGN  12755<>CALL    12794>>ASSIGN  12795>>ASSIGN
DEFI IN PROCEDURE KILL_RUM
     12741**DCL     12798<<DOINDEX 12799>>ASSIGN
DELETE_FLAG
      5345**DCL     12843<<ASSIGN  12865<<ASSIGN  12934>>IF      12965>>IF
DUA$EXITDELTA
      9553**DCL-ENT 12696--CALL    12816--CALL
DUA$KILL_ANLZ
      9554**DCL-ENT 12200--CALL
DUE$ERRMSG
      9555**DCL-ENT 12338--CALL    12345--CALL    12604--CALL    12614--CALL    12623--CALL    12649--CALL
     12655--CALL    12661--CALL    12666--CALL    12815--CALL    12818--CALL    12993--CALL
DUI$INIT_HOST
      9556**DCL-ENT 12363--CALL    12709--CALL
DUI$INIT_L6
      9557**DCL-ENT 12365--CALL    12711--CALL
DUI$RU_ACCESS
      9558**DCL-ENT 12557--CALL    12718--CALL
DUU$TRUNC
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:175  
      9559**DCL-ENT 12744--CALL
F$DCB.ACCT#
      6261**DCL     12397>>IF
F$DCB.ACTPOS
      6277**DCL      6277--REDEF
F$DCB.ARS#
      6251**DCL      6251--REDEF   12326>>ASSIGN  12956>>ASSIGN
F$DCB.ASN#
      6266**DCL     12279>>IF
F$DCB.ATTR
      6270**DCL      6271--REDEF
F$DCB.BORROW
      6285**DCL      6285--REDEF    6285--REDEF    6285--REDEF
F$DCB.DCBNAME.L
      6299**DCL      6299--IMP-SIZ
F$DCB.EOMCHAR#
      6255**DCL      6255--REDEF
F$DCB.FCD#
      6264**DCL     12784>>IF
F$DCB.FFLG.DELR#
      6256**DCL     12268>>IF
F$DCB.FFLG.UPD#
      6256**DCL     12268>>IF      13047>>IF
F$DCB.FFLG.WNEW#
      6256**DCL     12268>>IF      13054>>IF
F$DCB.FLDID
      6280**DCL      6280--REDEF
F$DCB.FORM$
      6274**DCL      6274--REDEF
F$DCB.FSECT
      6290**DCL      6290--REDEF
F$DCB.FSN#
      6267**DCL      6267--REDEF    6267--REDEF    6268--REDEF
F$DCB.FUN#
      6266**DCL     12397>>IF
F$DCB.HEADER$
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:176  
      6273**DCL      6273--REDEF
F$DCB.IXTNSIZE#
      6271**DCL      6271--REDEF
F$DCB.LASTSTA$
      6260**DCL      6260--REDEF
F$DCB.LVL
      6286**DCL      6286--REDEF
F$DCB.NAME#.C
      6261**DCL      6261--REDEF   12273>>IF
F$DCB.NOEOF
      6283**DCL      6283--REDEF
F$DCB.NRECS#
      6272**DCL      6272--REDEF
F$DCB.NRECX
      6291**DCL      6291--REDEF
F$DCB.OHDR
      6283**DCL      6283--REDEF
F$DCB.ORG#
      6266**DCL      6266--REDEF   12279>>IF
F$DCB.PRECNO
      6289**DCL      6289--REDEF
F$DCB.RCSZ
      6295**DCL      6295--REDEF
F$DCB.RES#
      6262**DCL      6262--REDEF
F$DCB.SETX
      6274**DCL      6274--REDEF
F$DCB.TAB$
      6274**DCL      6274--REDEF
F$DCB.TDA
      6288**DCL      6289--REDEF
F$DCB.WSN#
      6262**DCL      6262--REDEF
FPTCLOSE
      5411**DCL     12333<<ASSIGN  12336<>CALL    12606<<ASSIGN  12610<>CALL    12786<<ASSIGN  12789<>CALL
FPTCLOSE.SN_
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:177  
      5411**DCL      5411--REDEF
FPTCLOSE.UTL_
      5412**DCL      5412--REDEF
FPTCLOSE.V
      5416**DCL     12334--ASSIGN  12607--ASSIGN  12787--ASSIGN
FPTCLOSE.V.DCB#
      5417**DCL     12335<<ASSIGN  12608<<ASSIGN  12788<<ASSIGN
FPTCLOSE.V.DISP#
      5420**DCL     12609<<ASSIGN
FPTCLOSE.V.EXPIRE#
      5426**DCL      5426--REDEF
FPTCLOSE.V.TYPE#
      5424**DCL      5424--REDEF
FPTCLOSE.V.XTNSIZE#
      5421**DCL      5421--REDEF    5423--REDEF
FPTCLOSE.V_
      5411**DCL     12334<<ASSIGN  12607<<ASSIGN  12787<<ASSIGN
FPTDELREC
      5442**DCL     12844<<ASSIGN  12935<>CALL
FPTDELREC.V
      5445**DCL     12845--ASSIGN
FPTDELREC.V.DCB#
      5446**DCL     12846<<ASSIGN
FPTDELREC.V_
      5442**DCL     12845<<ASSIGN
FPTFID
      5462**DCL     12209<<ASSIGN  12222<>CALL
FPTFID.ACCT_
      5463**DCL     12214<<ASSIGN
FPTFID.ASN_
      5465**DCL     12219<<ASSIGN
FPTFID.NAME_
      5463**DCL     12213<<ASSIGN
FPTFID.PASS_
      5463**DCL     12215<<ASSIGN
FPTFID.RESULTS_
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:178  
      5465**DCL     12221<<ASSIGN
FPTFID.RES_
      5465**DCL     12220<<ASSIGN
FPTFID.SN_
      5464**DCL     12217<<ASSIGN
FPTFID.TEXTFID_
      5462**DCL     12212<<ASSIGN
FPTFID.V
      5466**DCL     12211--ASSIGN
FPTFID.V_
      5462**DCL     12211<<ASSIGN
FPTFID.WSN_
      5464**DCL     12218<<ASSIGN
FPTGETDCB
      5486**DCL     12235<<ASSIGN  12238<>CALL    12285<<ASSIGN  12288<>CALL
FPTGETDCB.DCBNUM_
      5486**DCL     12237<<ASSIGN  12287<<ASSIGN
FPTGETDCB.V
      5487**DCL     12236--ASSIGN  12286--ASSIGN
FPTGETDCB.V_
      5486**DCL     12236<<ASSIGN  12286<<ASSIGN
FPTOPEN
      5556**DCL     12210<<ASSIGN  12264<>CALL    12295<>CALL    12597<>CALL
FPTOPEN.ACCT_
      5560**DCL     12229<<ASSIGN
FPTOPEN.ACSVEH_
      5558**DCL      5559--REDEF
FPTOPEN.ALTKEYS_
      5564**DCL      5565--REDEF    5565--REDEF
FPTOPEN.FPARAM_
      5561**DCL     12258<<ASSIGN  12290>>ASSIGN  12291<<ASSIGN
FPTOPEN.HDR_
      5563**DCL      5564--REDEF
FPTOPEN.IFPARAM_
      5561**DCL     12290<<ASSIGN
FPTOPEN.NAME_
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:179  
      5557**DCL     12227<<ASSIGN
FPTOPEN.PASS_
      5558**DCL     12228<<ASSIGN
FPTOPEN.SN_
      5556**DCL     12226<<ASSIGN
FPTOPEN.TAB_
      5562**DCL      5563--REDEF
FPTOPEN.UHL_
      5556**DCL      5557--REDEF    5557--REDEF
FPTOPEN.V
      5565**DCL     12225--ASSIGN
FPTOPEN.V.ACS#
      5576**DCL     12294<<ASSIGN
FPTOPEN.V.ASN#
      5575**DCL     12219--ASSIGN
FPTOPEN.V.DCB#
      5565**DCL     12242<<ASSIGN  12289<<ASSIGN
FPTOPEN.V.EXIST#
      5569**DCL     12293<<ASSIGN
FPTOPEN.V.FSN#
      5596**DCL      5596--REDEF    5596--REDEF
FPTOPEN.V.FUN#
      5575**DCL     12254<<ASSIGN  12266>>IF      12292<<ASSIGN  12593>>IF      12596<<ASSIGN
FPTOPEN.V.RES#
      5580**DCL     12220--ASSIGN
FPTOPEN.V_
      5556**DCL     12225<<ASSIGN
FPTOPEN.WSN_
      5562**DCL      5562--REDEF   12230<<ASSIGN
FPTREAD
      5618**DCL     12296<<ASSIGN  12312<>CALL    12911<<ASSIGN  12919<>CALL    12924<>CALL
FPTREAD.BUF_
      5620**DCL     12299<<ASSIGN  12913<<ASSIGN
FPTREAD.KEY_
      5618**DCL     12298<<ASSIGN  12304>>ASSIGN  12915<<ASSIGN
FPTREAD.STATION_
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:180  
      5621**DCL      5622--REDEF
FPTREAD.V
      5622**DCL     12297--ASSIGN  12912--ASSIGN
FPTREAD.V.DCB#
      5622**DCL     12300<<ASSIGN  12916<<ASSIGN
FPTREAD.V.DVBYTE.CONT#
      5635**DCL     12313<<ASSIGN  12319<<ASSIGN
FPTREAD.V.DVBYTE.REREAD#
      5633**DCL      5633--REDEF
FPTREAD.V.INDX#
      5631**DCL      5631--REDEF
FPTREAD.V.KEYS#
      5623**DCL     12301<<ASSIGN  12921<<ASSIGN
FPTREAD.V_
      5618**DCL     12297<<ASSIGN  12912<<ASSIGN
FPTRELDCB
      5652**DCL     12340<<ASSIGN  12343<>CALL    12616<<ASSIGN  12619<>CALL    12700<<ASSIGN  12703<>CALL
FPTRELDCB.V
      5652**DCL     12341--ASSIGN  12617--ASSIGN  12701--ASSIGN
FPTRELDCB.V.DCB#
      5652**DCL     12342<<ASSIGN  12618<<ASSIGN  12702<<ASSIGN
FPTRELDCB.V_
      5652**DCL     12341<<ASSIGN  12617<<ASSIGN  12701<<ASSIGN
FPTTIME
      5667**DCL     12384<<ASSIGN  12389<>CALL    12563<<ASSIGN  12566<>CALL    12873<<ASSIGN  12881<>CALL
     12897<>CALL    12942<>CALL
FPTTIME.DATE_
      5667**DCL     12386<<ASSIGN  12875<<ASSIGN
FPTTIME.TIME_
      5669**DCL     12387<<ASSIGN  12876<<ASSIGN
FPTTIME.TSTAMP_
      5670**DCL     12388<<ASSIGN  12565<<ASSIGN  12877<<ASSIGN
FPTTIME.V
      5671**DCL     12385--ASSIGN  12564--ASSIGN  12874--ASSIGN
FPTTIME.V_
      5667**DCL     12385<<ASSIGN  12564<<ASSIGN  12874<<ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:181  
FPTUNFID
      5687**DCL     12762<<ASSIGN  12769<>CALL    12776<>CALL    13013<<ASSIGN  13017<>CALL
FPTUNFID.TEXTFID_
      5687**DCL     12768<<ASSIGN  12775<<ASSIGN  13016<<ASSIGN
FPTUNFID.V
      5691**DCL     12763--ASSIGN  13014--ASSIGN
FPTUNFID.V.DCB#
      5691**DCL     12764<<ASSIGN  13015<<ASSIGN
FPTUNFID.V_
      5687**DCL     12763<<ASSIGN  13014<<ASSIGN
FPTWRITE
      5712**DCL     12302<<ASSIGN  12330<>CALL
FPTWRITE.BUF_
      5712**DCL     12328<<ASSIGN  12329<<ASSIGN
FPTWRITE.KEY_
      5712**DCL     12304<<ASSIGN
FPTWRITE.STATION_
      5714**DCL      5714--REDEF
FPTWRITE.V
      5715**DCL     12303--ASSIGN
FPTWRITE.V.DCB#
      5715**DCL     12305<<ASSIGN
FPTWRITE.V.DVBYTE.CONT#
      5723**DCL     12314<<ASSIGN  12320<<ASSIGN
FPTWRITE.V.DVBYTE.VFC#
      5721**DCL      5721--REDEF
FPTWRITE.V_
      5712**DCL     12303<<ASSIGN
FPT_CLOSE
      6560**DCL     12333>>ASSIGN  12606>>ASSIGN  12786>>ASSIGN
FPT_CLOSE.SN_
      6560**DCL      6560--REDEF
FPT_CLOSE.UTL_
      6561**DCL      6561--REDEF
FPT_CLOSE.V
      6565**DCL      6560--DCLINIT
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:182  
FPT_CLOSE.V.EXPIRE#
      6575**DCL      6575--REDEF
FPT_CLOSE.V.TYPE#
      6573**DCL      6573--REDEF
FPT_CLOSE.V.XTNSIZE#
      6570**DCL      6570--REDEF    6572--REDEF
FPT_DELREC
      6414**DCL     12844>>ASSIGN
FPT_DELREC.V
      6417**DCL      6414--DCLINIT
FPT_EOM
      6749**DCL     12580<>CALL
FPT_FID
      6331**DCL     12209>>ASSIGN
FPT_FID.V
      6335**DCL      6331--DCLINIT
FPT_GETDCB
      6356**DCL     12235>>ASSIGN  12285>>ASSIGN
FPT_GETDCB.V
      6357**DCL      6356--DCLINIT
FPT_LOCTIME
      6608**DCL     12384>>ASSIGN
FPT_LOCTIME.V
      6612**DCL      6608--DCLINIT
FPT_OPEN
      6491**DCL     12210>>ASSIGN
FPT_OPEN.ACSVEH_
      6493**DCL      6494--REDEF
FPT_OPEN.ALTKEYS_
      6499**DCL      6500--REDEF    6500--REDEF
FPT_OPEN.HDR_
      6498**DCL      6499--REDEF
FPT_OPEN.TAB_
      6497**DCL      6498--REDEF
FPT_OPEN.UHL_
      6491**DCL      6492--REDEF    6492--REDEF
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:183  
FPT_OPEN.V
      6500**DCL      6491--DCLINIT
FPT_OPEN.V.FSN#
      6531**DCL      6531--REDEF    6531--REDEF
FPT_OPEN.WSN_
      6497**DCL      6497--REDEF
FPT_READ
      6380**DCL     12296>>ASSIGN  12911>>ASSIGN
FPT_READ.STATION_
      6383**DCL      6384--REDEF
FPT_READ.V
      6384**DCL      6380--DCLINIT
FPT_READ.V.DVBYTE.REREAD#
      6395**DCL      6395--REDEF
FPT_READ.V.INDX#
      6393**DCL      6393--REDEF
FPT_RELDCB
      6591**DCL     12340>>ASSIGN  12616>>ASSIGN  12700>>ASSIGN
FPT_RELDCB.V
      6591**DCL      6591--DCLINIT
FPT_TIME
      6652**DCL     12563>>ASSIGN
FPT_TIME.V
      6656**DCL      6652--DCLINIT
FPT_UNFID
      6704**DCL     12762>>ASSIGN  13013>>ASSIGN
FPT_UNFID.V
      6708**DCL      6704--DCLINIT
FPT_UNTIME
      6630**DCL     12873>>ASSIGN
FPT_UNTIME.V
      6634**DCL      6630--DCLINIT
FPT_WRITE
      6678**DCL     12302>>ASSIGN
FPT_WRITE.STATION_
      6680**DCL      6680--REDEF
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:184  
FPT_WRITE.V
      6681**DCL      6678--DCLINIT
FPT_WRITE.V.DVBYTE.VFC#
      6687**DCL      6687--REDEF
INX
      5341**DCL     12910<<ASSIGN  12930<<ASSIGN  12930>>ASSIGN  12931>>IF      12931>>IF
IX
      5351**DCL     12410<<DOINDEX 12411>>ASSIGN  12413>>ASSIGN  12414>>ASSIGN  12415>>ASSIGN  12416>>ASSIGN
     12417>>ASSIGN  12468<<DOINDEX 12488<<DOINDEX 12492<<DOINDEX 12504<<DOINDEX 12515<<DOINDEX 12535<<DOINDEX
     12542<<DOINDEX 12745<<DOINDEX 12746>>ASSIGN  12747>>ASSIGN
KEYBUF
      5337**DCL     12298--ASSIGN  12914<<ASSIGN  12915--ASSIGN  12925>>ASSIGN
KILL_ETI
     12651**LABEL   12585--GOTO    12597--CALLALT 12601--GOTO
KILL_IT
     12651**LABEL   12368--GOTO    12432--GOTO    12557--CALLALT 12634--GOTO    12638--GOTO    12641--GOTO
     12644--GOTO    12652--GOTO
KILL_IT1
     12689**LABEL   12664--GOTO    12667--GOTO
KILL_ITE
     12651**LABEL   12647--GOTO
KILL_RUM
     12738**PROC    12207--CALL    12693--CALL
KRUM0
     12717**LABEL   12719--CALLALT
LASTNODE
      5339**DCL     12940<<ASSIGN  12946>>IF      12948<<ASSIGN  12949>>CALLBLT 12949>>CALLBLT 12950>>ASSIGN
LASTUTS
      5340**DCL     12388--ASSIGN  12390>>IF      12877--ASSIGN  12880<<ASSIGN  12896<<ASSIGN  12909<<ASSIGN
     12937>>IF      12939<<ASSIGN
LIST$CMD.ID_FROM
      5855**DCL     12931>>IF      12971>>IF
LIST$CMD.ID_TO
      5856**DCL     12931>>IF      12971>>IF
LIST$CMD.LIST_ALL
      5857**DCL     12931>>IF
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:185  
LIST_CODE
     12865**LABEL   12847--GOTO
M$CLOSE
        62**DCL-ENT 12336--CALL    12610--CALL    12789--CALL
M$DELREC
        64**DCL-ENT 12935--CALL
M$EOM
        87**DCL-ENT 12580--CALL
M$FID
       125**DCL-ENT 12222--CALL
M$GETDCB
        68**DCL-ENT 12238--CALL    12288--CALL
M$OPEN
        62**DCL-ENT 12264--CALL    12295--CALL    12597--CALL
M$READ
        63**DCL-ENT 12312--CALL    12919--CALL    12924--CALL
M$RELDCB
        68**DCL-ENT 12343--CALL    12619--CALL    12703--CALL
M$TIME
       129**DCL-ENT 12389--CALL    12566--CALL    12881--CALL    12897--CALL    12942--CALL
M$UNFID
       125**DCL-ENT 12769--CALL    12776--CALL    13017--CALL
M$WRITE
        63**DCL-ENT 12330--CALL
M$XXX
        74**DCL-ENT 12658--CALL
NBUFS
      5362**DCL     12404<<ASSIGN  12405<<ASSIGN  12406<<ASSIGN  12407>>ASSIGN  12421>>ASSIGN  12426>>ASSIGN
NEED
      5347**DCL     12421<<ASSIGN  12426<<ASSIGN  12434>>ASSIGN  12442>>ASSIGN
NOBIRTH
     12374**LABEL   12372--CALLALT
NOCLSRUM IN PROCEDURE KILL_RUM
     12809**LABEL   12789--CALLALT
NOEOM
     12584**LABEL   12580--CALLALT
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:186  
NOHEAD
     12629**LABEL   12358--CALLALT 12360--GOTO
NOMEM1
     12633**LABEL   12248--CALLALT
NOMEM2
     12633**LABEL   12438--CALLALT
NONAME
     12640**LABEL   12224--GOTO
NONCHK
     12964**LABEL   12872--GOTO    12923--CALLALT 12962--GOTO    12987--GOTO
NONE
      5353**DCL     12868<<ASSIGN  12933<<ASSIGN  12933>>ASSIGN  12967<>CALL    12971>>IF
NOOPN1
     12584**LABEL   12264--CALLALT
NORELND IN PROCEDURE KILL_RUM
     12806**LABEL   12755--CALLALT
NORELRUM
     12625**LABEL   12703--CALLALT
NORELS_D IN PROCEDURE KILL_RUM
     12796**LABEL   12751--CALLALT
NOROS
     12637**LABEL   12478--CALLALT 12525--CALLALT
NORU1
     12629**LABEL   12280--GOTO
NOTIME
     12643**LABEL   12566--CALLALT
PAGE
      5355**DCL     12474<<ASSIGN  12478<>CALL    12479<<ASSIGN  12479>>ASSIGN  12521<<ASSIGN  12525<>CALL
     12526<<ASSIGN  12526>>ASSIGN
PAGE$BUF
      5833**DCL     12258--ASSIGN  12299--ASSIGN  12329--ASSIGN
PBSIZEC
      5360**DCL      5834--IMP-SIZ 12257<<ASSIGN  12257--ASSIGN  12258>>ASSIGN  12299>>ASSIGN  12326<<ASSIGN
     12327>>IF      12329>>ASSIGN
PROGBUF$
      5363**DCL     12409<<ASSIGN  12411>>ASSIGN  12412<<ASSIGN  12412>>ASSIGN  12464>>ASSIGN  12511>>ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:187  
PTR$WORD.LH
      5838**DCL     12489>>ASSIGN  12505>>ASSIGN
PTR$WORD.RH
      5839**DCL      5840--REDEF
PTR$WORD.RHB.LBYTE
      5844**DCL     12538>>ASSIGN
PTR$WORD.RHB.UBYTE
      5842**DCL     12537>>ASSIGN
READC
     12917**LABEL   12932--GOTO    12984--GOTO
RECBUF
      5336**DCL     12913--ASSIGN  12955>>CALLBLT 13016--ASSIGN  13019>>CALLBLT 13023>>CALLBLT
REPORT_XXX
     12651**LABEL   12207--CALLALT 12693--CALLALT 12714--GOTO    12718--CALLALT
REPORT_XXXE
     12651**LABEL   12630--GOTO
ROSIZE
      5346**DCL     12419<<ASSIGN  12421>>ASSIGN  12426>>ASSIGN  12443>>IF      12473>>ASSIGN  12473--ASSIGN
     12520>>ASSIGN
RUM$CMD.BUFFERS
      5877**DCL     12402>>IF      12406>>ASSIGN
RUM$CMD.CMD
      5870**DCL     12724>>ASSIGN
RUM$CMD.CODE
      5878**DCL     12250>>ASSIGN
RUM$CMD.FID
      5888**DCL     12212--ASSIGN  12212--ASSIGN
RUM$CMD.GOTUTS
      5873**DCL      5874--REDEF   12379>>IF
RUM$CMD.LUTS.DATE
      5884**DCL     12386--ASSIGN
RUM$CMD.LUTS.TIME
      5886**DCL     12387--ASSIGN
RUM$CMD.NUTS
      5875**DCL     12394>>IF
RUM$CMD.UTS
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:188  
      5882**DCL      5883--REDEF
RUM0
     12558**LABEL   12559--CALLALT
RUM1
     12273**LABEL   12599--GOTO
RUM2
     12344**LABEL   12626--GOTO
SIZE
      5342**DCL     12308<<ASSIGN  12309<>CALL    12883<<ASSIGN  12884>>CALLBLT 12885<<ASSIGN  12885>>ASSIGN
     12892<>CALL    12898<<ASSIGN  12899>>CALLBLT 12900<<ASSIGN  12900>>ASSIGN  12901>>ASSIGN  12903<<ASSIGN
     12903>>ASSIGN  12904>>CALLBLT 12905<<ASSIGN  12905>>ASSIGN  12906<>CALL    12943<<ASSIGN  12944<>CALL
     12950<<ASSIGN  12951<>CALL    12953<<ASSIGN  12954>>CALLBLT 12956<<ASSIGN  12957>>IF      12958<<ASSIGN
     12959<>CALL    12967<>CALL    12968>>CALLBLT 12968>>CALLBLT 12969<<ASSIGN  12969>>ASSIGN  12974<<ASSIGN
     12976<<ASSIGN  12977>>IF      12978<>CALL    13019<<CALLBLT 13020<<ASSIGN  13020>>ASSIGN  13021>>IF
     13022<<ASSIGN  13024<>CALL
S_D.ANLZ
      8834**DCL     12199>>IF      12871>>IF
S_D.B$ROS$
      8866**DCL     12445<<ASSIGN  12465<<ASSIGN  12466>>ASSIGN  12467>>ASSIGN  12486>>ASSIGN  12499>>ASSIGN
     12500>>ASSIGN  12512<<ASSIGN  12513>>ASSIGN  12514>>ASSIGN  12533>>ASSIGN  12549>>ASSIGN  12550>>ASSIGN
     12793<<ASSIGN
S_D.B$TREE$
      8854**DCL     12949>>CALLBLT 12949>>CALLBLT 12950>>ASSIGN
S_D.BATCH
      8661**DCL     12576>>IF
S_D.CURRENT_CHANNEL
      9134**DCL      9136--REDEF
S_D.DEBUGA
      8286**DCL      8288--REDEF
S_D.DO$
      8237**DCL     12212>>ASSIGN  12212>>ASSIGN  12250>>ASSIGN  12379>>IF      12386>>ASSIGN  12387>>ASSIGN
     12394>>IF      12402>>IF      12406>>ASSIGN  12722>>IF      12724>>ASSIGN  12931>>IF      12931>>IF
     12931>>IF      12971>>IF      12971>>IF
S_D.EIS
      9244**DCL      9273--REDEF
S_D.EOM
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:189  
      8826**DCL     12576>>IF      12581<<ASSIGN
S_D.ERROR
      8215**DCL     12367<<ASSIGN  12375<<ASSIGN  12431<<ASSIGN  12570<<ASSIGN  12629<<ASSIGN  12633<<ASSIGN
     12637<<ASSIGN  12640<<ASSIGN  12643<<ASSIGN  12646<<ASSIGN  12651<<ASSIGN  12713<<ASSIGN  12806<<ASSIGN
     12809<<ASSIGN  12819<<ASSIGN
S_D.EXEC_DOMAIN_SAVE
      9145**DCL     12245<<ASSIGN  12782>>ASSIGN
S_D.FIRST_TIME
      9227**DCL     12556<<ASSIGN  12717<<ASSIGN
S_D.GHOST1
      8441**DCL     12403>>IF      12689>>IF      12689>>IF      12796>>IF
S_D.HOST_MESSAGE_BUF_REMOTE
      9177**DCL      9178--REDEF    9192--REDEF
S_D.INPUT
      8449**DCL     13055--CALL
S_D.JDE
      8791**DCL      8792--REDEF
S_D.L$.VALUE
      8344**DCL      8350--REDEF    8358--REDEF    8361--REDEF    8364--REDEF    8367--REDEF
S_D.L$.VALUE.L
      8345**DCL      8346--REDEF    8347--REDEF
S_D.L6_MESSAGE_BUF
      9198**DCL      9200--REDEF
S_D.LMDCB
      8864**DCL     12232>>ASSIGN  12237--ASSIGN  12239>>ASSIGN  12241<<ASSIGN  12242>>ASSIGN  12348<<ASSIGN
     12764>>ASSIGN  12783<<ASSIGN  12846>>ASSIGN  12870--ASSIGN  12916>>ASSIGN  13015>>ASSIGN  13046--ASSIGN
S_D.LMDCB_SAVE
      9280**DCL     12232<<ASSIGN  12783>>ASSIGN
S_D.NCHARS
      8308**DCL     13055<>CALL
S_D.NODE
      8743**DCL     13055<>CALL
S_D.NODESEG$
      8878**DCL     12442<<ASSIGN  12794<<ASSIGN
S_D.NODESEG_USED$
      8858**DCL     12249<<ASSIGN  12439<<ASSIGN  12439>>ASSIGN  12753>>ASSIGN  12795<<ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:190  
S_D.ONE_TO_TWO.EXEC_DOMAIN
      9209**DCL     12245>>ASSIGN  12420>>IF      12425>>IF      12446>>IF      12461>>IF      12707>>DOCASE
     12782<<ASSIGN
S_D.OUTPUT
      9164**DCL      9166--REDEF   12306<<ASSIGN  12307--ASSIGN  12759--ASSIGN  12760<<ASSIGN  12767<<ASSIGN
     12768--ASSIGN  12773<<ASSIGN  12774<<CALLBLT 12775--ASSIGN  12779<<ASSIGN  12869--ASSIGN  12884<<CALLBLT
     12899<<CALLBLT 12904<<CALLBLT 12949<<CALLBLT 12955<<CALLBLT 12957--IF      12958--ASSIGN  12968<<CALLBLT
     12968--CALLBLT 12973<<ASSIGN  13018--ASSIGN  13021--IF      13022--ASSIGN  13023<<CALLBLT
S_D.PADDR
      8850**DCL     12447<<ASSIGN  12452<<ASSIGN  12453<<ASSIGN  12455<<ASSIGN  12456<<ASSIGN  12503<<ASSIGN
     12551<<ASSIGN
S_D.RCBC.BUF$
      8427**DCL     12411<<ASSIGN  12442>>ASSIGN  12745--DOINDEX 12745--DOINDEX
S_D.RCBC.BUFSIZE
      8423**DCL     12408<<ASSIGN  12412>>ASSIGN  12421>>ASSIGN  12426>>ASSIGN  12479>>ASSIGN
S_D.RCBC.BUFSM1
      8425**DCL     12407<<ASSIGN  12410>>DOINDEX
S_D.RCBC.CUR_SEQ
      8421**DCL     12401<<ASSIGN
S_D.RCBC.NODE
      8435**DCL     12417<<ASSIGN
S_D.RCBC.PAGE
      8429**DCL     12413<<ASSIGN  12746<<ASSIGN
S_D.RCBC.SEQ
      8437**DCL     12415<<ASSIGN
S_D.RCBC.SIZE
      8431**DCL     12414<<ASSIGN  12747<<ASSIGN
S_D.RCBC.WRITTEN
      8433**DCL     12416<<ASSIGN
S_D.REMOTE_MSG.FNCC
      9183**DCL      9184--REDEF
S_D.REMOTE_MSG.STXC
      9179**DCL      9180--REDEF
S_D.REMOTE_MSG.SUBFNCC
      9187**DCL      9188--REDEF
S_D.RUM
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:191  
      8832**DCL     12246<<ASSIGN  12694<<ASSIGN  12743>>IF      12756>>IF      12871>>IF      12878>>IF
S_D.RUMDCB
      8868**DCL     12233>>IF      12239<<ASSIGN  12241>>ASSIGN  12265--ASSIGN  12278--ASSIGN  12300>>ASSIGN
     12335>>ASSIGN  12342>>ASSIGN  12347<<ASSIGN  12698>>IF      12702>>ASSIGN  12704<<ASSIGN  12784--IF
     12788>>ASSIGN
S_D.RUMSEQ
      8872**DCL     12562<<ASSIGN  13048>>IF
S_D.RUMUTS
      8870**DCL     12565--ASSIGN  13050>>ASSIGN
S_D.RUM_BIRTH$
      8393**DCL     12353<<ASSIGN  12354>>ASSIGN  12372<>CALL    12374<<ASSIGN  12381>>IF      12390>>IF
     12878>>IF      12880>>ASSIGN  12893>>ASSIGN  12896>>ASSIGN  13048>>IF      13050>>ASSIGN  13051>>ASSIGN
     13051>>ASSIGN  13052<>CALL
S_D.RUM_COMMAND
      8318**DCL     12689>>IF
S_D.RUM_ERRORS
      8413**DCL     12765>>IF      12774>>CALLBLT 12792<<ASSIGN
S_D.RUM_FEP
      9314**DCL     12274<<ASSIGN  12275<<ASSIGN
S_D.RUM_HEAD$
      8874**DCL     12354<<ASSIGN  12358<>CALL    12361>>DOCASE  12408>>ASSIGN  12409>>ASSIGN  12419>>ASSIGN
     12447>>ASSIGN  12447>>ASSIGN  12450>>IF      12451>>IF      12454>>IF      12455>>ASSIGN  12456>>ASSIGN
     12484>>ASSIGN  12485>>ASSIGN  12497>>ASSIGN  12498>>IF      12531>>ASSIGN  12532>>ASSIGN  12547>>ASSIGN
     12548>>IF      12551>>ASSIGN  12558>>ASSIGN
S_D.RUM_ONLY
      8956**DCL     12573<<ASSIGN  12695>>IF      12812>>IF
S_D.RUM_ROS$
      8876**DCL     12464<<ASSIGN  12465>>ASSIGN  12511<<ASSIGN  12512>>ASSIGN
S_D.RUM_SKIP
      8282**DCL     12574<<ASSIGN  12691<<ASSIGN
S_D.RUM_TEST
      8880**DCL     12251<<ASSIGN  12261<<ASSIGN
S_D.SAVEIC
      8197**DCL     12244>>ASSIGN  12558<<ASSIGN  12559<>CALL    12719<>CALL    12781<<ASSIGN
S_D.SAVEIC_SAVE
      8896**DCL     12244<<ASSIGN  12781>>ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:192  
S_D.SCHSEG$
      8618**DCL     12749>>ASSIGN  12752<<ASSIGN
S_D.SCHSEG_BEGIN$
      8270**DCL     12749>>ASSIGN  12752>>ASSIGN
S_D.STAND_ALONE
      8659**DCL     12576>>IF      12871>>IF
S_D.SV
      8243**DCL      8264--REDEF
S_D.TR$INFO.ACTIVE
      8670**DCL     12201>>IF
S_D.TRACE_STATE
      8952**DCL     12203<<ASSIGN  12206<<ASSIGN  12728>>IF      12730<<ASSIGN
S_D.UD.TEXTSZ
      8389**DCL     12799<<ASSIGN
S_D$
      9495**DCL      8191--IMP-PTR 12199>>IF      12201>>IF      12203>>ASSIGN  12206>>ASSIGN  12212>>ASSIGN
     12212>>ASSIGN  12232>>ASSIGN  12232>>ASSIGN  12233>>IF      12237>>ASSIGN  12239>>ASSIGN  12239>>ASSIGN
     12241>>ASSIGN  12241>>ASSIGN  12242>>ASSIGN  12244>>ASSIGN  12244>>ASSIGN  12245>>ASSIGN  12245>>ASSIGN
     12246>>ASSIGN  12249>>ASSIGN  12250>>ASSIGN  12251>>ASSIGN  12261>>ASSIGN  12265>>ASSIGN  12274>>ASSIGN
     12275>>ASSIGN  12278>>ASSIGN  12300>>ASSIGN  12306>>ASSIGN  12307>>ASSIGN  12335>>ASSIGN  12342>>ASSIGN
     12347>>ASSIGN  12348>>ASSIGN  12353>>ASSIGN  12354>>ASSIGN  12354>>ASSIGN  12358>>CALL    12361>>DOCASE
     12367>>ASSIGN  12372>>CALL    12374>>ASSIGN  12375>>ASSIGN  12379>>IF      12381>>IF      12386>>ASSIGN
     12387>>ASSIGN  12390>>IF      12394>>IF      12401>>ASSIGN  12402>>IF      12403>>IF      12406>>ASSIGN
     12407>>ASSIGN  12408>>ASSIGN  12408>>ASSIGN  12409>>ASSIGN  12410>>DOINDEX 12411>>ASSIGN  12412>>ASSIGN
     12413>>ASSIGN  12414>>ASSIGN  12415>>ASSIGN  12416>>ASSIGN  12417>>ASSIGN  12419>>ASSIGN  12420>>IF
     12421>>ASSIGN  12425>>IF      12426>>ASSIGN  12431>>ASSIGN  12439>>ASSIGN  12439>>ASSIGN  12442>>ASSIGN
     12442>>ASSIGN  12445>>ASSIGN  12446>>IF      12447>>ASSIGN  12447>>ASSIGN  12447>>ASSIGN  12450>>IF
     12451>>IF      12452>>ASSIGN  12453>>ASSIGN  12454>>IF      12455>>ASSIGN  12455>>ASSIGN  12456>>ASSIGN
     12456>>ASSIGN  12461>>IF      12464>>ASSIGN  12465>>ASSIGN  12465>>ASSIGN  12466>>ASSIGN  12467>>ASSIGN
     12479>>ASSIGN  12484>>ASSIGN  12485>>ASSIGN  12486>>ASSIGN  12497>>ASSIGN  12498>>IF      12499>>ASSIGN
     12500>>ASSIGN  12503>>ASSIGN  12511>>ASSIGN  12512>>ASSIGN  12512>>ASSIGN  12513>>ASSIGN  12514>>ASSIGN
     12531>>ASSIGN  12532>>ASSIGN  12533>>ASSIGN  12547>>ASSIGN  12548>>IF      12549>>ASSIGN  12550>>ASSIGN
     12551>>ASSIGN  12551>>ASSIGN  12556>>ASSIGN  12558>>ASSIGN  12558>>ASSIGN  12559>>CALL    12562>>ASSIGN
     12565>>ASSIGN  12570>>ASSIGN  12573>>ASSIGN  12574>>ASSIGN  12576>>IF      12576>>IF      12576>>IF
     12581>>ASSIGN  12629>>ASSIGN  12633>>ASSIGN  12637>>ASSIGN  12640>>ASSIGN  12643>>ASSIGN  12646>>ASSIGN
     12651>>ASSIGN  12689>>IF      12689>>IF      12689>>IF      12691>>ASSIGN  12694>>ASSIGN  12695>>IF
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:193  
     12698>>IF      12702>>ASSIGN  12704>>ASSIGN  12707>>DOCASE  12713>>ASSIGN  12717>>ASSIGN  12719>>CALL
     12722>>IF      12724>>ASSIGN  12728>>IF      12730>>ASSIGN  12743>>IF      12746>>ASSIGN  12747>>ASSIGN
     12749>>ASSIGN  12749>>ASSIGN  12752>>ASSIGN  12752>>ASSIGN  12753>>ASSIGN  12756>>IF      12759>>ASSIGN
     12760>>ASSIGN  12764>>ASSIGN  12765>>IF      12767>>ASSIGN  12768>>ASSIGN  12773>>ASSIGN  12774>>CALLBLT
     12774>>CALLBLT 12775>>ASSIGN  12779>>ASSIGN  12781>>ASSIGN  12781>>ASSIGN  12782>>ASSIGN  12782>>ASSIGN
     12783>>ASSIGN  12783>>ASSIGN  12784>>IF      12788>>ASSIGN  12792>>ASSIGN  12793>>ASSIGN  12794>>ASSIGN
     12795>>ASSIGN  12796>>IF      12799>>ASSIGN  12806>>ASSIGN  12809>>ASSIGN  12812>>IF      12819>>ASSIGN
     12846>>ASSIGN  12869>>ASSIGN  12870>>ASSIGN  12871>>IF      12871>>IF      12871>>IF      12878>>IF
     12878>>IF      12880>>ASSIGN  12884>>CALLBLT 12893>>ASSIGN  12896>>ASSIGN  12899>>CALLBLT 12904>>CALLBLT
     12916>>ASSIGN  12931>>IF      12931>>IF      12931>>IF      12949>>CALLBLT 12949>>CALLBLT 12949>>CALLBLT
     12950>>ASSIGN  12955>>CALLBLT 12968>>CALLBLT 12971>>IF      12971>>IF      12973>>ASSIGN  13015>>ASSIGN
     13018>>ASSIGN  13023>>CALLBLT 13046>>ASSIGN  13048>>IF      13048>>IF      13050>>ASSIGN  13050>>ASSIGN
     13051>>ASSIGN  13051>>ASSIGN  13052>>CALL    13055>>CALL    13055>>CALL    13055>>CALL
S_D_SEG$
      9509**DCL     12751<>CALL
TEMP$
      5349**DCL     12476<<ASSIGN  12478<>CALL    12481<<ASSIGN  12481>>ASSIGN  12487<<ASSIGN  12489>>ASSIGN
     12497<<ASSIGN  12497>>ASSIGN  12499>>ASSIGN  12501>>ASSIGN  12504>>DOINDEX 12505>>ASSIGN  12523<<ASSIGN
     12525<>CALL    12528<<ASSIGN  12528>>ASSIGN  12534<<ASSIGN  12539>>ASSIGN  12547<<ASSIGN  12547>>ASSIGN
     12549>>ASSIGN  12901<<ASSIGN  12902<>CALL
TEMP$WORD
      5845**DCL      5849--REDEF
TEMP$WORD.LBYTE
      5848**DCL     12538<<ASSIGN
TEMP$WORD.UBYTE
      5847**DCL     12537<<ASSIGN
TEMP1$
      5350**DCL     12501<<ASSIGN  12502>>ASSIGN  12503>>ASSIGN  12505>>ASSIGN  12505>>ASSIGN  12506<<ASSIGN
     12506>>ASSIGN
TEMPWORD
      5849**DCL     12536<<ASSIGN  12539>>ASSIGN
TEXT$C.SIZE
      5865**DCL      5866--IMP-SIZ 12212>>ASSIGN  12949>>CALLBLT 12950>>ASSIGN
TEXT$C.TXT
      5866**DCL     12212--ASSIGN  12949>>CALLBLT
TOBREL IN PROCEDURE KILL_RUM
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:194  
     12740**DCL     12749<<ASSIGN  12750>>IF      12751<>CALL    12753<<ASSIGN  12754>>IF      12755<>CALL
TOGET
      5348**DCL     12434<<ASSIGN  12435>>IF      12437<<ASSIGN  12437>>ASSIGN  12438<>CALL    12439>>ASSIGN
     12473<<ASSIGN  12477>>DOWHILE 12478<>CALL    12480<<ASSIGN  12480>>ASSIGN  12484<<ASSIGN  12486>>ASSIGN
     12488>>DOINDEX 12520<<ASSIGN  12524>>DOWHILE 12525<>CALL    12527<<ASSIGN  12527>>ASSIGN  12531<<ASSIGN
     12533>>ASSIGN  12535>>DOINDEX
USED
      5358**DCL     12355<<ASSIGN  12434>>ASSIGN  12893<<ASSIGN  12894>>IF      12902<>CALL
UTSERR
     12646**LABEL   12382--GOTO    12391--GOTO    12399--GOTO
UTSERRE
     12646**LABEL   12389--CALLALT
VLPFID_ACCT
      5767**DCL     12214--ASSIGN  12229--ASSIGN
VLPFID_NAME
      5753**DCL     12213--ASSIGN  12227--ASSIGN
VLPFID_PASS
      5781**DCL     12215--ASSIGN  12228--ASSIGN
VLPFID_SN
      5810**DCL     12216<<ASSIGN  12217--ASSIGN  12226--ASSIGN
VLPFID_WSN
      5795**DCL     12218--ASSIGN  12230--ASSIGN
VLP_FID_SN
      6723**DCL     12216>>ASSIGN
VLR$LOCAL
      6240**DCL     12883--ASSIGN  12898--ASSIGN  12943--ASSIGN
VLR$LOCAL.DATE
      6241**DCL     12875--ASSIGN
VLR$LOCAL.SPACE
      6242**DCL     12882<<ASSIGN  12941<<ASSIGN
VLR$LOCAL.TIME
      6243**DCL     12876--ASSIGN
VLRFID
      5824**DCL     12221--ASSIGN
VLRFID.NAME
      5824**DCL     12223>>IF
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:195  
WARNINPUT
      5356**DCL     12263<<ASSIGN  12271<<ASSIGN  12568>>IF      12598<<ASSIGN  12625<<ASSIGN
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:196  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:197  
              MINI UREF LISTING

B$ROAVAIL    6158**DCL
B$RODCB$    6155**DCL
DUA$DELETE   12841**ENTRY
DUA$KILL_RUM   12685**ENTRY
DUA$LIST   12863**ENTRY
DUA$RUM      51**PROC
DUA$RUM_COMM   13044**ENTRY
DUA$SHOW_RUM   13011**ENTRY
D_M$DO#    6728**DCL
D_M$LM#    6729**DCL
M$ACCT      79**DCL-ENT
M$ACTIVATE      82**DCL-ENT
M$ALIB      75**DCL-ENT
M$ASUSER      77**DCL-ENT
M$ATTACH      84**DCL-ENT
M$BADPP     102**DCL-ENT
M$CGCTL      83**DCL-ENT
M$CGINFO      83**DCL-ENT
M$CHECK      64**DCL-ENT
M$CHGUNIT     122**DCL-ENT
M$CLRSTK     120**DCL-ENT
M$CMDVAR     131**DCL-ENT
M$CONFIG      92**DCL-ENT
M$CORRES      67**DCL-ENT
M$CPEXIT      76**DCL-ENT
M$CVM     100**DCL-ENT
M$CVOL      65**DCL-ENT
M$DCLFLD      92**DCL-ENT
M$DEACTIVATE      82**DCL-ENT
M$DEQ     129**DCL-ENT
M$DETACH      84**DCL-ENT
M$DEVICE      66**DCL-ENT
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:198  
M$DISPLAY     129**DCL-ENT
M$DISPRES      69**DCL-ENT
M$DLIB      75**DCL-ENT
M$DRIBBLE      92**DCL-ENT
M$DRTN     120**DCL-ENT
M$DSUSER      77**DCL-ENT
M$ENQ     128**DCL-ENT
M$ERASE      93**DCL-ENT
M$ERR      74**DCL-ENT
M$ERRMSG     125**DCL-ENT
M$EVENT     117**DCL-ENT
M$EXHUME     126**DCL-ENT
M$EXIT      74**DCL-ENT
M$EXTEND      66**DCL-ENT
M$FDP      98**DCL-ENT
M$FDS      97**DCL-ENT
M$FEBOOT      90**DCL-ENT
M$FECTL      91**DCL-ENT
M$FEDUMP      90**DCL-ENT
M$FINDPROC      79**DCL-ENT
M$FSUSER      77**DCL-ENT
M$FVP      99**DCL-ENT
M$FWCG      83**DCL-ENT
M$GBPL     103**DCL-ENT
M$GDDL      99**DCL-ENT
M$GDP      98**DCL-ENT
M$GDS      97**DCL-ENT
M$GETMOUSE     108**DCL-ENT
M$GETPM     109**DCL-ENT
M$GJOB     127**DCL-ENT
M$GLINEATTR      87**DCL-ENT
M$GOODPP     102**DCL-ENT
M$GPLATEN      95**DCL-ENT
M$GPROMPT      94**DCL-ENT
M$GTRMATTR      88**DCL-ENT
M$GTRMCTL      86**DCL-ENT
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:199  
M$GTRMTAB      89**DCL-ENT
M$GVP      98**DCL-ENT
M$HELP     125**DCL-ENT
M$INT     117**DCL-ENT
M$INTRTN      78**DCL-ENT
M$IOQ     113**DCL-ENT
M$JOBSTATS     127**DCL-ENT
M$KEYIN      67**DCL-ENT
M$LDEV      62**DCL-ENT
M$LDTRC      75**DCL-ENT
M$LIMIT      68**DCL-ENT
M$LINES      67**DCL-ENT
M$LINK      74**DCL-ENT
M$MADMUCK      70**DCL-ENT
M$MAKUSER     101**DCL-ENT
M$MBS      69**DCL-ENT
M$MDFFLD      93**DCL-ENT
M$MERC     118**DCL-ENT
M$MERCS     119**DCL-ENT
M$MIRROR     113**DCL-ENT
M$MONINFO     130**DCL-ENT
M$MPL     103**DCL-ENT
M$NODEINFO      94**DCL-ENT
M$NXTUSR     128**DCL-ENT
M$OCMSG     126**DCL-ENT
M$OLAY      74**DCL-ENT
M$PAS     103**DCL-ENT
M$PATHCON     126**DCL-ENT
M$PDS      97**DCL-ENT
M$PFIL      64**DCL-ENT
M$PLATEN      88**DCL-ENT
M$PRECORD      66**DCL-ENT
M$PROCNAME      79**DCL-ENT
M$PROFILE      90**DCL-ENT
M$PROMPT      86**DCL-ENT
M$RACST      70**DCL-ENT
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:200  
M$RDSYSLOG     111**DCL-ENT
M$RELRES      69**DCL-ENT
M$RELSTARF      71**DCL-ENT
M$REM      71**DCL-ENT
M$RENV     118**DCL-ENT
M$REQUIRE      70**DCL-ENT
M$RETRY     119**DCL-ENT
M$RETRYS     119**DCL-ENT
M$REW      65**DCL-ENT
M$RLSFLD      93**DCL-ENT
M$RPRIV     121**DCL-ENT
M$RSPP     100**DCL-ENT
M$RSWITCH     122**DCL-ENT
M$RUE     128**DCL-ENT
M$SAD     101**DCL-ENT
M$SAVE      77**DCL-ENT
M$SCON      78**DCL-ENT
M$SCREECH      76**DCL-ENT
M$SENV     118**DCL-ENT
M$SETFMA      62**DCL-ENT
M$SETFP      91**DCL-ENT
M$SINPUT      89**DCL-ENT
M$SLCFLD      94**DCL-ENT
M$SMOUSE     108**DCL-ENT
M$SMPRT     100**DCL-ENT
M$SPRIV     121**DCL-ENT
M$SSC     101**DCL-ENT
M$SSWITCH     121**DCL-ENT
M$STATE     130**DCL-ENT
M$STD     102**DCL-ENT
M$STIMER     116**DCL-ENT
M$STLPP      99**DCL-ENT
M$STRAP     116**DCL-ENT
M$STRMATTR      88**DCL-ENT
M$STRMCTL      86**DCL-ENT
M$STRMTAB      89**DCL-ENT
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:201  
M$SYMBIO     127**DCL-ENT
M$SYSCON     113**DCL-ENT
M$SYSID     131**DCL-ENT
M$TDCLOSE     112**DCL-ENT
M$TDIO     112**DCL-ENT
M$TDOPEN     111**DCL-ENT
M$TDREQCPU     112**DCL-ENT
M$TEMPWROC     106**DCL-ENT
M$TRAP     116**DCL-ENT
M$TRMISC      91**DCL-ENT
M$TRMPRG      87**DCL-ENT
M$TRTN     120**DCL-ENT
M$TRUNC      63**DCL-ENT
M$TTIMER     116**DCL-ENT
M$UC      86**DCL
M$UMPL     103**DCL-ENT
M$UNLATCH      82**DCL-ENT
M$UNSHARE      79**DCL-ENT
M$USRFIELD     122**DCL-ENT
M$VIRTUAL      97**DCL-ENT
M$WAIT     120**DCL-ENT
M$WEOF      65**DCL-ENT
M$WRSYSLOG     111**DCL-ENT
M$XCON     117**DCL-ENT
M$XCONRTN      78**DCL-ENT
M$XEQTIME     130**DCL-ENT
M$XFLUSH      71**DCL-ENT
M$XMOUSE     108**DCL-ENT
M$YC      76**DCL-ENT
SDD$   11617**DCL
SDD_L6$   11619**DCL
S_D_ACCESS$    9510**DCL
S_D_ANLZ$    9512**DCL
S_D_ASTACKOFF$    9511**DCL
S_D_BREAK$    9513**DCL
S_D_DO_SCAN$    9514**DCL
PL6.E3A0      #001=DUA$RUM File=DUA$RUM.:E05TSI                                  TUE 07/29/97 14:48 Page:202  
S_D_ERROR$    9515**DCL
S_D_FAULTCMD$$    9516**DCL
S_D_FAULTINS$$    9517**DCL
S_D_GOIC$    9518**DCL
S_D_GO_MODE$    9519**DCL
S_D_HOST_MESSAGE$    9531**DCL
S_D_HW_PTB_UNITS$    9535**DCL
S_D_HW_RES_MEM$    9533**DCL
S_D_HW_WSQ0PT$    9534**DCL
S_D_IPRFLT$    9521**DCL
S_D_IXFIX$    9520**DCL
S_D_L6_MESSAGE$    9532**DCL
S_D_REM_ACCESS$    9522**DCL
S_D_REM_DISKBOOT$    9524**DCL
S_D_REM_DO_SCAN$    9523**DCL
S_D_RETURNN$    9525**DCL
S_D_SAD$    9526**DCL
S_D_SAVEIC$    9527**DCL
S_D_TCB$$    9528**DCL
S_D_UREG$$    9529**DCL
S_D_USS$$    9530**DCL
ZITEM$   11618**DCL
ZITEM_L6$   11620**DCL
