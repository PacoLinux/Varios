VERSION E05

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:1    
        1        1        /*M* ASA$STATION  - Processes CREATE STATION. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        ASA$STATION: PROC ;
        9        9        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:2    
       10       10        /*********************************************************************/
       11       11        /*   Include files   include files   include files   include files   */
       12       12        /*********************************************************************/
       13       13                                                              /**/
       14       14              %INCLUDE  AS_ENTRIES_M  ;
       15     1064              %INCLUDE  AS_SUPER_C    ;
       16     1499              %INCLUDE  AS_MAC_C      ;
       17     1579              %INCLUDE  KL_SUPER_C    ;
       18     4481              %INCLUDE  XU_FORMAT_C   ;
       19     4643              %INCLUDE  XU_MACRO_C    ;
       20     7749              %INCLUDE  AS_SUBS_C     ;
       21     9163              %INCLUDE  AS_SSUBS_C    ;
       22     9255              %INCLUDE  AS_PERR_C     ;
       23     9857              %INCLUDE  CP_6          ;
       24    15416              %INCLUDE  AS_SUPER_R    ;
       25    18432        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:3    
       26    18433        /********************************************************************/
       27    18434        /*   Auto data       auto data       auto data       auto data       */
       28    18435        /*********************************************************************/
       29    18436                                                              /**/
       30    18437    1   DCL ARS UBIN WORD ;
       31    18438    1   DCL TWSN# UBIN WORD ;
       32    18439    1   DCL TWSNC CHAR(4) ;
       33    18440    1   DCL BLK$ PTR ;
       34    18441    1   DCL WSNCVT$ PTR ;
       35    18442    1   DCL TREC$ PTR ;
       36    18443    1   DCL TWSNR$ PTR ;
       37    18444    1   DCL TWSN_ARS UBIN WORD ;
       38    18445    1   DCL 1 NAME,
       39    18446    1          2 COUNT UBIN BYTE UNAL,
       40    18447    1          2 TEXT CHAR(8) UNAL;
       41    18448        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:4    
       42    18449        /********************************************************************/
       43    18450        /*   Symref's        symref's        symref's        symref's        */
       44    18451        /*********************************************************************/
       45    18452                                                              /**/
       46    18453    1   DCL STATION_CMD SYMREF UBIN(36) ;
       47    18454        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:5    
       48    18455        /********************************************************************/
       49    18456        /*   Static data     static data     static data     static data     */
       50    18457        /*********************************************************************/
       51    18458                                                              /**/
       52    18459    1   DCL 1 STAT_KEY ALIGNED STATIC ,
       53    18460    1          2 CNT UBIN BYTE UNAL INIT( 15 ),
       54    18461    1          2 TXT UNAL ,
       55    18462    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       56    18463    1             3 ASTR CHAR(7) UNAL INIT('STATION') ;
       57    18464        %KL_DREC( NAME = KL_TREC ,
       58    18465                  STCLASS = CONSTANT ,
       59    18466                  TYP = %KLAT_STA# ,
       60    18467                  RNAME = ' ' ,
       61    18468                  PASS = ' ' ,
       62    18469                  PRO = ' ' ,
       63    18470                  WORG = ' ' ,
       64    18471                  LAST = ";" ) ;
       65    18584        %EJECT;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:6    
       66    18585        /*********************************************************************/
       67    18586        /*   Local based     local based     local based     local based     */
       68    18587        /*********************************************************************/
       69    18588        %B$TCB;
       70    18591        %B$ALT;
       71    18599                                                              /**/
       72    18600        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       73    18601                    NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       74    18646        %PARSE$SYM( NAME = OUT$SYM ,
       75    18647                    STCLASS="BASED(BLK$)") ;
       76    18685        %KL_DREC (NAME = KL$TREC ,
       77    18686                  STCLASS="BASED( TREC$ )" , LAST = ";" );
       78    18799        %KL_TWSNREC(  NAME = KL$TWSNREC ,
       79    18800                      STCLASS="BASED( TWSNR$ )") ;
       80    18825        %KL_WSNCVT( NAME = KL$WSNCVT ,
       81    18826                    STCLASS="BASED( WSNCVT$ )") ;
       82    18833        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:7    
       83    18834        /********************************************************************/
       84    18835        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       85    18836        /*********************************************************************/
       86    18837                                                              /**/
       87    18838    1   DCL X$PARSE ENTRY(1) ALTRET ;
       88    18839        %ASB$ENQ_HLP ;
       89    18842        %ASB$DEQ_HLP ;
       90    18845        %ASB$READ_HLP ;
       91    18848        %ASB$WRITE_HLP ;
       92    18851        %ASB$GETSEG ;
       93    18854        %ASH$ERROR ;
       94    18857        %ASB$CHECK_TYPE ;
       95    18860        %ASB$GET_MORE_SEG ;
       96    18863        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:8    
       97    18864        /********************************************************************/
       98    18865        /*   Procedure       procedure       procedure       procedure       */
       99    18866        /*********************************************************************/
      100    18867                                                              /**/
      101    18868        /*
      102    18869            ***            Begin procedure                    ***
      103    18870        */
      104    18871    1   P_PCB.ROOT$ = ADDR( STATION_CMD ) ;
      105    18872    1   CALL X$PARSE( P_PCB ) ALTRET( TERM_CMD_ERR ) ;
      106    18873                                                              /**/
      107    18874    1   NODE$ = P_PCB.OUT$ ;
      108    18875                                                              /**/
      109    18876                                                              /*  Set up :HLP record.  */
      110    18877                                                              /*  Blank out password.   */
      111    18878                                                              /**/
      112    18879    1   USERS_KEY = AS_FALSE;
      113    18880    1   IF NOT DSEG_FLG THEN
      114    18881    1      CALL ASB$GETSEG
      115    18882    2      WHENALTRETURN DO;
      116    18883              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A') ;
      117    18898    2         RETURN ;
      118    18899    2         END;   /*  Whenaltreturn from ASB$GETSEG  */
      119    18900    1   TREC$ = DSEG1$ ;
      120    18901    1   TWSNR$ = DSEG2$ ;
      121    18902                                                              /* Check exist. Of
      122    18903                                                                   c/m terminal */
      123    18904    1   BLK$ = NODE$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
      124    18905    2   IF OUT$SYM.COUNT > 8 THEN DO;
      125    18906        /*E*  ERROR:    ASA-E$SNAMETOOBIG-C
      126    18907              MESSAGE:  Station name too long.
      127    18908              MESSAGE1: Station names can be at most 8 characters.
      128    18909        */
      129    18910           %SCREAM( ERR#=E$SNAMETOOBIG, LEVEL=ERROR, MID='A' );
      130    18925    2      RETURN ;
      131    18926    2      END ;    /* Then do */
      132    18927    1   NAME.COUNT = OUT$SYM.COUNT;
      133    18928    1   NAME.TEXT  = OUT$SYM.TEXT;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:9    
      134    18929    1   STAT_KEY.TXT.ACCT = NAME.TEXT;
      135    18930    1   USERS_KEY = STAT_KEY ;
      136    18931    1   ARS = DSEG1SIZE ;
      137    18932    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;
      138    18933    1   ENQDEQ_FLG = AS_TRUE ;
      139    18934    1   CALL ASB$READ_HLP( DSEG1$, ARS ) ALTRET( CM_STAT_ERR ) ;
      140    18935    1   CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_STAT#, '1'B, NAME ) ALTRET(EXIT#);
      141    18936        /*E*  ERROR:    ASA-E$STAT_ALREADY_EXISTS-C
      142    18937              MESSAGE0: Station %%U1 %already exists.
      143    18938              MESSAGE1: Cannot CREATE a station that already exists.
      144    18939        */
      145    18940    1   AS_FIELD1 = NAME;
      146    18941        %SCREAM( ERR#=E$STAT_ALREADY_EXISTS, LEVEL=ERROR, MID='A') ;
      147    18956    1   EXIT#: CALL ASB$DEQ_HLP ;
      148    18957    1   ENQDEQ_FLG = AS_FALSE ;
      149    18958    1   RETURN ;
      150    18959    1   CM_STAT_ERR: ;
      151    18960                                                              /**/
      152    18961        /*  Get twsn# from the twsn convert record. */
      153    18962    1   ARS = DSEG1SIZE ;
      154    18963    1   WSNCVT$ = DSEG1$ ;
      155    18964    1   USERS_KEY.COUNT = 4 ;
      156    18965    1   USERS_KEY.TXTC = 'TERM' ;
      157    18966    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;
      158    18967    1   CALL ASB$READ_HLP( WSNCVT$, ARS, 1 ) ALTRET( TERMCVT_ERR ) ;
      159    18968    1   TWSN# = 1;
      160    18969        /*
      161    18970          Look for the first available blank spot for a station name in
      162    18971        the 'TERM' record, ie. KL$WSNCVT.WSN(?) = AS_BLANK.  If none of
      163    18972        current spots are blank TWSN# will become > KL$WSNCVT.LTWSN.
      164    18973        This method of adding stations/twsns puts no limit on the number
      165    18974        of stations that may be added to the system.  There are probably
      166    18975        some implied limits, though.  The first that comes to mind is the
      167    18976        256K word limit on a data segment, which is what the 'TERM'
      168    18977        record is read into.  There may also be a limit to the record size
      169    18978        that file management can read or write.
      170    18979        */
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:10   
      171    18980
      172    18981    1   LOOP:
      173    18982    2   DO WHILE TWSN# <= KL$WSNCVT.LTWSN;
      174    18983    2      IF KL$WSNCVT.WSN(TWSN#) = '        ' THEN
      175    18984    2         EXIT LOOP;
      176    18985    2      ELSE
      177    18986    2         TWSN# = TWSN# + 1;
      178    18987    2      END LOOP;
      179    18988    1   IF TWSN# > KL$WSNCVT.LTWSN
      180    18989    2   THEN DO ;
      181    18990        /*
      182    18991           Check that data segment 1 has the room to add another 8 characters,
      183    18992           ie. the size of another station name.
      184    18993           If yes, we are ok.
      185    18994           If no, expand the data segment.
      186    18995        */
      187    18996
      188    18997    2      IF (KL$WSNCVT.LTWSN * SIZEC(KL$WSNCVT.WSN(0)) + 8) > (DSEG1SIZE - 8)
      189    18998    3      THEN DO;
      190    18999    3         CALL ASB$GET_MORE_SEG (1, 4096) WHENALTRETURN
      191    19000    4         DO;
      192    19001        /*E*  ERROR:    ASA-E$NO_TWSN_NUM-C
      193    19002              MESSAGE:  Unable to get TWSN number.
      194    19003        */
      195    19004                 %SCREAM( ERR#=E$NO_TWSN_NUM, LEVEL=ERROR, MID='A') ;
      196    19019    4            RETURN ;
      197    19020    4            END ;     /* Whenaltreturn from ASB$GET_MORE_SEG  */
      198    19021    3         END ; /* Size of 'TERM' record > DATASEG1  */
      199    19022    2      KL$WSNCVT.LTWSN = TWSN# ;
      200    19023    2      END ; /* TWSN# > KL$WSNCVT.LTWSN  */
      201    19024    1   KL$WSNCVT.WSN( TWSN# ) = STAT_KEY.TXT.ACCT ;
      202    19025    1   ARS = LENGTHC( KL$WSNCVT ) + LENGTHC( KL$WSNCVT.WSN(0) ) * (KL$WSNCVT.LTWSN ) ;
      203    19026    1   CALL ASB$WRITE_HLP( WSNCVT$, ARS ) ALTRET( WRITE_TREC_ERR ) ;
      204    19027    1   CALL ASB$DEQ_HLP ALTRET( DEQ_ERR ) ;
      205    19028        /*  Fill in and write to :HLP the  twsnxxxx record
      206    19029            and the station record.
      207    19030        */
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:11   
      208    19031    1   KL$TWSNREC = '0'B ;
      209    19032    1   KL$TWSNREC.WSN = AS_BLANK ;
      210    19033    1   KL$TWSNREC.STATION = STAT_KEY.TXT.ACCT ;
      211    19034    1   TWSN_ARS = LENGTHC( KL$TWSNREC ) - LENGTHC( KL$TWSNREC.DEVS(0) ) ;
      212    19035    1   KL$TREC = KL_TREC ;
      213    19036    1   KL$TREC.SUPER = AS_STAT#;
      214    19037    1   KL$TREC.SNAME = STAT_KEY.TXT.ACCT ;
      215    19038    1   KL$TREC.PNAME.CNT = 0 ;
      216    19039    1   KL$TREC.PNAME.TXT = ' ' ;
      217    19040                                                             /*  Station record */
      218    19041    1   CALL BINCHAR( TWSNC, TWSN# ) ;
      219    19042    1   KL$TREC.TWSN# = TWSNC ;
      220    19043    1   KL$TREC.ATYP = %KLAT_STA# ;
      221    19044    1   KL$TREC.NWINFO = 0 ;
      222    19045    1   ARS = LENGTHC (KL$TREC) ;
      223    19046    1   USERS_KEY = STAT_KEY ;
      224    19047    1   CALL ASB$WRITE_HLP( TREC$, ARS ) ALTRET ( WRITE_TREC_ERR ) ;
      225    19048                                                              /* Twsnxxxx record */
      226    19049    1   USERS_KEY.COUNT = 8 ;
      227    19050    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;
      228    19051    1   CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TREC_ERR ) ;
      229    19052                                                              /**/
      230    19053    1   RETURN ;
      231    19054                                                              /* Errors */
      232    19055                                                              /**/
      233    19056                                                              /**/
      234    19057                                                              /**/
      235    19058    1   WRITE_TREC_ERR: ;
      236    19059    1   CALL ASH$ERROR( ERR_CODE ) ;
      237    19060    1   RETURN ;
      238    19061                                                              /**/
      239    19062    1   TERM_CMD_ERR: ;
      240    19063    1   CALL ASH$ERROR( P_PCB.ERROR ) ;
      241    19064    1   RETURN ;
      242    19065                                                              /**/
      243    19066    1   TERMCVT_ERR: ;
      244    19067        /*E*  ERROR:    ASA-E$CANT_READ_TERM_CONV-C
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:12   
      245    19068              MESSAGE:  Unable to read TERMINAL CONVERT record.
      246    19069        */
      247    19070        %SCREAM( ERR#=E$CANT_READ_TERM_CONV, LEVEL=ERROR, MID='A') ;
      248    19085    1   RETURN ;
      249    19086                                                              /**/
      250    19087                                                              /**/
      251    19088    1   ENQ_ERR: ;
      252    19089                                                              /**/
      253    19090    1   DEQ_ERR: ;
      254    19091    1   END   ASA$STATION ;

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:13   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASA$STATION.

   Procedure ASA$STATION requires 278 words for executable code.
   Procedure ASA$STATION requires 20 words of local(AUTO) storage.

    No errors detected in file ASA$STATION.:E05TSI    .

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:14   

 Object Unit name= ASA$STATION                                File name= ASA$STATION.:E05TOU
 UTS= JUL 29 '97 08:44:08.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   Data  even  none     4      4  ASA$STATION
    3  RoData even  UTS     25     31  ASA$STATION
    4   Proc  even  none   278    426  ASA$STATION
    5  RoData even  none    17     21  ASA$STATION

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     4      0   yes            yes      Std        0  ASA$STATION
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
 yes     yes           Std       2 ASB$WRITE_HLP
 yes     yes           Std       1 X$PARSE
 yes     yes           Std       0 ASB$GETSEG
         yes           Std       2 ASH$ERROR
 yes     yes           Std       0 ASB$ENQ_HLP
 yes     yes           Std       3 ASB$READ_HLP
 yes     yes           Std       2 ASB$GET_MORE_SEG
 yes     yes           Std       0 ASB$DEQ_HLP
 yes     yes           Std       5 ASB$CHECK_TYPE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_TRUE
r    AS_FALSE                         r    AS_MODE                          r    AS_FE_MODE
     M$LO                                  USERS_KEY                             NODE$
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG_FLG
     DSEG1$                                DSEG1SIZE                             DSEG2$
     ENQDEQ_FLG                            P_PCB                                 STATION_CMD
     B_VECTNIL
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:16   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:17   


        1        1        /*M* ASA$STATION  - Processes CREATE STATION. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        ASA$STATION: PROC ;

      8  4 000000   000000 700200 xent  ASA$STATION  TSX0  ! X66_AUTO_0
         4 000001   000024 000000                    ZERO    20,0

        9        9        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:18   
       10       10        /*********************************************************************/
       11       11        /*   Include files   include files   include files   include files   */
       12       12        /*********************************************************************/
       13       13                                                              /**/
       14       14              %INCLUDE  AS_ENTRIES_M  ;
       15     1064              %INCLUDE  AS_SUPER_C    ;
       16     1499              %INCLUDE  AS_MAC_C      ;
       17     1579              %INCLUDE  KL_SUPER_C    ;
       18     4481              %INCLUDE  XU_FORMAT_C   ;
       19     4643              %INCLUDE  XU_MACRO_C    ;
       20     7749              %INCLUDE  AS_SUBS_C     ;
       21     9163              %INCLUDE  AS_SSUBS_C    ;
       22     9255              %INCLUDE  AS_PERR_C     ;
       23     9857              %INCLUDE  CP_6          ;
       24    15416              %INCLUDE  AS_SUPER_R    ;
       25    18432        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:19   
       26    18433        /********************************************************************/
       27    18434        /*   Auto data       auto data       auto data       auto data       */
       28    18435        /*********************************************************************/
       29    18436                                                              /**/
       30    18437    1   DCL ARS UBIN WORD ;
       31    18438    1   DCL TWSN# UBIN WORD ;
       32    18439    1   DCL TWSNC CHAR(4) ;
       33    18440    1   DCL BLK$ PTR ;
       34    18441    1   DCL WSNCVT$ PTR ;
       35    18442    1   DCL TREC$ PTR ;
       36    18443    1   DCL TWSNR$ PTR ;
       37    18444    1   DCL TWSN_ARS UBIN WORD ;
       38    18445    1   DCL 1 NAME,
       39    18446    1          2 COUNT UBIN BYTE UNAL,
       40    18447    1          2 TEXT CHAR(8) UNAL;
       41    18448        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:20   
       42    18449        /********************************************************************/
       43    18450        /*   Symref's        symref's        symref's        symref's        */
       44    18451        /*********************************************************************/
       45    18452                                                              /**/
       46    18453    1   DCL STATION_CMD SYMREF UBIN(36) ;
       47    18454        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:21   
       48    18455        /********************************************************************/
       49    18456        /*   Static data     static data     static data     static data     */
       50    18457        /*********************************************************************/
       51    18458                                                              /**/
       52    18459    1   DCL 1 STAT_KEY ALIGNED STATIC ,
       53    18460    1          2 CNT UBIN BYTE UNAL INIT( 15 ),
       54    18461    1          2 TXT UNAL ,
       55    18462    1             3 ACCT CHAR(8) UNAL INIT(' ') ,
       56    18463    1             3 ASTR CHAR(7) UNAL INIT('STATION') ;
       57    18464        %KL_DREC( NAME = KL_TREC ,
       58    18465                  STCLASS = CONSTANT ,
       59    18466                  TYP = %KLAT_STA# ,
       60    18467                  RNAME = ' ' ,
       61    18468                  PASS = ' ' ,
       62    18469                  PRO = ' ' ,
       63    18470                  WORG = ' ' ,
       64    18471                  LAST = ";" ) ;
       65    18584        %EJECT;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:22   
       66    18585        /*********************************************************************/
       67    18586        /*   Local based     local based     local based     local based     */
       68    18587        /*********************************************************************/
       69    18588        %B$TCB;
       70    18591        %B$ALT;
       71    18599                                                              /**/
       72    18600        %PARSE$OUT( NAME=P$NODE, STCLASS="BASED(NODE$)",
       73    18601                    NDTYPE=TYPE, NSUBLKS=SUBNODES) ;
       74    18646        %PARSE$SYM( NAME = OUT$SYM ,
       75    18647                    STCLASS="BASED(BLK$)") ;
       76    18685        %KL_DREC (NAME = KL$TREC ,
       77    18686                  STCLASS="BASED( TREC$ )" , LAST = ";" );
       78    18799        %KL_TWSNREC(  NAME = KL$TWSNREC ,
       79    18800                      STCLASS="BASED( TWSNR$ )") ;
       80    18825        %KL_WSNCVT( NAME = KL$WSNCVT ,
       81    18826                    STCLASS="BASED( WSNCVT$ )") ;
       82    18833        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:23   
       83    18834        /********************************************************************/
       84    18835        /*   Entry dcls      entry dcls      entry dcls      entry dcls      */
       85    18836        /*********************************************************************/
       86    18837                                                              /**/
       87    18838    1   DCL X$PARSE ENTRY(1) ALTRET ;
       88    18839        %ASB$ENQ_HLP ;
       89    18842        %ASB$DEQ_HLP ;
       90    18845        %ASB$READ_HLP ;
       91    18848        %ASB$WRITE_HLP ;
       92    18851        %ASB$GETSEG ;
       93    18854        %ASH$ERROR ;
       94    18857        %ASB$CHECK_TYPE ;
       95    18860        %ASB$GET_MORE_SEG ;
       96    18863        %EJECT ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:24   
       97    18864        /********************************************************************/
       98    18865        /*   Procedure       procedure       procedure       procedure       */
       99    18866        /*********************************************************************/
      100    18867                                                              /**/
      101    18868        /*
      102    18869            ***            Begin procedure                    ***
      103    18870        */
      104    18871    1   P_PCB.ROOT$ = ADDR( STATION_CMD ) ;

  18871  4 000002   000000 236000 5                  LDQ     0
         4 000003   000001 756000 xsym               STQ     P_PCB+1

      105    18872    1   CALL X$PARSE( P_PCB ) ALTRET( TERM_CMD_ERR ) ;

  18872  4 000004   000001 630400 5                  EPPR0   1
         4 000005   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000006   000000 701000 xent               TSX1    X$PARSE
         4 000007   000413 702000 4                  TSX2    TERM_CMD_ERR

      106    18873                                                              /**/
      107    18874    1   NODE$ = P_PCB.OUT$ ;

  18874  4 000010   000003 236000 xsym               LDQ     P_PCB+3
         4 000011   000000 756000 xsym               STQ     NODE$

      108    18875                                                              /**/
      109    18876                                                              /*  Set up :HLP record.  */
      110    18877                                                              /*  Blank out password.   */
      111    18878                                                              /**/
      112    18879    1   USERS_KEY = AS_FALSE;

  18879  4 000012   003000 060400                    CSL     bolr='003'O
         4 000013   000000 000001 xsym               BDSC    AS_FALSE                 by=0,bit=0,n=1
         4 000014   000000 000572 xsym               BDSC    USERS_KEY                by=0,bit=0,n=378

      113    18880    1   IF NOT DSEG_FLG THEN

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:25   
  18880  4 000015   000000 234000 xsym               SZN     DSEG_FLG
         4 000016   000030 604000 4                  TMI     s:18900

      114    18881    1      CALL ASB$GETSEG

  18881  4 000017   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000020   000000 701000 xent               TSX1    ASB$GETSEG
         4 000021   000023 702000 4                  TSX2    s:18895
         4 000022   000030 710000 4                  TRA     s:18900

      115    18882    2      WHENALTRETURN DO;

      116    18883              %SCREAM( ERR#=%E$GETSEGERR, LEVEL=ERROR, MID='A') ;

  18895  4 000023   000002 630400 5                  EPPR0   2
         4 000024   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000025   000000 701000 xent               TSX1    ASH$ERROR
         4 000026   000000 011000                    NOP     0

      117    18898    2         RETURN ;

  18898  4 000027   000000 702200 xent               TSX2  ! X66_ARET

      118    18899    2         END;   /*  Whenaltreturn from ASB$GETSEG  */
      119    18900    1   TREC$ = DSEG1$ ;

  18900  4 000030   000000 236000 xsym               LDQ     DSEG1$
         4 000031   200010 756100                    STQ     TREC$,,AUTO

      120    18901    1   TWSNR$ = DSEG2$ ;

  18901  4 000032   000000 236000 xsym               LDQ     DSEG2$
         4 000033   200011 756100                    STQ     TWSNR$,,AUTO

      121    18902                                                              /* Check exist. Of
      122    18903                                                                   c/m terminal */
      123    18904    1   BLK$ = NODE$ -> P$NODE.SUBLK$(0) -> P$NODE.SUBLK$(0) ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:26   

  18904  4 000034   000000 470400 xsym               LDP0    NODE$
         4 000035   000003 471500                    LDP1    3,,PR0
         4 000036   100003 236100                    LDQ     3,,PR1
         4 000037   200006 756100                    STQ     BLK$,,AUTO

      124    18905    2   IF OUT$SYM.COUNT > 8 THEN DO;

  18905  4 000040   200006 473500                    LDP3    BLK$,,AUTO
         4 000041   300004 236100                    LDQ     4,,PR3
         4 000042   777000 376003                    ANQ     -512,DU
         4 000043   011000 116003                    CMPQ    4608,DU
         4 000044   000052 602000 4                  TNC     s:18927

      125    18906        /*E*  ERROR:    ASA-E$SNAMETOOBIG-C
      126    18907              MESSAGE:  Station name too long.
      127    18908              MESSAGE1: Station names can be at most 8 characters.
      128    18909        */
      129    18910           %SCREAM( ERR#=E$SNAMETOOBIG, LEVEL=ERROR, MID='A' );

  18922  4 000045   000003 630400 5                  EPPR0   3
         4 000046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000047   000000 701000 xent               TSX1    ASH$ERROR
         4 000050   000000 011000                    NOP     0

      130    18925    2      RETURN ;

  18925  4 000051   000000 702200 xent               TSX2  ! X66_ARET

      131    18926    2      END ;    /* Then do */
      132    18927    1   NAME.COUNT = OUT$SYM.COUNT;

  18927  4 000052   300004 236100                    LDQ     4,,PR3
         4 000053   200013 552140                    STBQ    NAME,'40'O,AUTO

      133    18928    1   NAME.TEXT  = OUT$SYM.TEXT;

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:27   
  18928  4 000054   300004 236100                    LDQ     4,,PR3
         4 000055   000033 772000                    QRL     27
         4 000056   000000 620006                    EAX0    0,QL
         4 000057   040100 100540                    MLR     fill='040'O
         4 000060   300004 200010                    ADSC9   4,,PR3                   cn=1,n=*X0
         4 000061   200013 200010                    ADSC9   NAME,,AUTO               cn=1,n=8

      134    18929    1   STAT_KEY.TXT.ACCT = NAME.TEXT;

  18929  4 000062   040000 100500                    MLR     fill='040'O
         4 000063   200013 200010                    ADSC9   NAME,,AUTO               cn=1,n=8
         4 000064   000000 200010 2                  ADSC9   STAT_KEY                 cn=1,n=8

      135    18930    1   USERS_KEY = STAT_KEY ;

  18930  4 000065   000000 100400                    MLR     fill='000'O
         4 000066   000000 000020 2                  ADSC9   STAT_KEY                 cn=0,n=16
         4 000067   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      136    18931    1   ARS = DSEG1SIZE ;

  18931  4 000070   000000 235000 xsym               LDA     DSEG1SIZE
         4 000071   200003 755100                    STA     ARS,,AUTO

      137    18932    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;

  18932  4 000072   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000073   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000074   000425 702000 4                  TSX2    ENQ_ERR

      138    18933    1   ENQDEQ_FLG = AS_TRUE ;

  18933  4 000075   000000 236000 xsym               LDQ     AS_TRUE
         4 000076   400000 376003                    ANQ     -131072,DU
         4 000077   000000 756000 xsym               STQ     ENQDEQ_FLG

      139    18934    1   CALL ASB$READ_HLP( DSEG1$, ARS ) ALTRET( CM_STAT_ERR ) ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:28   

  18934  4 000100   200003 630500                    EPPR0   ARS,,AUTO
         4 000101   200017 450500                    STP0    NAME+4,,AUTO
         4 000102   000004 236000 5                  LDQ     4
         4 000103   200016 756100                    STQ     NAME+3,,AUTO
         4 000104   200016 630500                    EPPR0   NAME+3,,AUTO
         4 000105   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000106   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000107   000142 702000 4                  TSX2    CM_STAT_ERR

      140    18935    1   CALL ASB$CHECK_TYPE( DSEG1$, ARS, AS_STAT#, '1'B, NAME ) ALTRET(EXIT#);

  18935  4 000110   200013 630500                    EPPR0   NAME,,AUTO
         4 000111   200022 450500                    STP0    NAME+7,,AUTO
         4 000112   000006 237000 5                  LDAQ    6
         4 000113   200020 757100                    STAQ    NAME+5,,AUTO
         4 000114   200003 631500                    EPPR1   ARS,,AUTO
         4 000115   200017 451500                    STP1    NAME+4,,AUTO
         4 000116   000004 236000 5                  LDQ     4
         4 000117   200016 756100                    STQ     NAME+3,,AUTO
         4 000120   200016 630500                    EPPR0   NAME+3,,AUTO
         4 000121   000023 631400 xsym               EPPR1   B_VECTNIL+19
         4 000122   000000 701000 xent               TSX1    ASB$CHECK_TYPE
         4 000123   000133 702000 4                  TSX2    EXIT#

      141    18936        /*E*  ERROR:    ASA-E$STAT_ALREADY_EXISTS-C
      142    18937              MESSAGE0: Station %%U1 %already exists.
      143    18938              MESSAGE1: Cannot CREATE a station that already exists.
      144    18939        */
      145    18940    1   AS_FIELD1 = NAME;

  18940  4 000124   000000 100500                    MLR     fill='000'O
         4 000125   200013 000011                    ADSC9   NAME,,AUTO               cn=0,n=9
         4 000126   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      146    18941        %SCREAM( ERR#=E$STAT_ALREADY_EXISTS, LEVEL=ERROR, MID='A') ;

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:29   
  18953  4 000127   000010 630400 5                  EPPR0   8
         4 000130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000131   000000 701000 xent               TSX1    ASH$ERROR
         4 000132   000000 011000                    NOP     0

      147    18956    1   EXIT#: CALL ASB$DEQ_HLP ;

  18956  4 000133   000002 631400 xsym  EXIT#        EPPR1   B_VECTNIL+2
         4 000134   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000135   000000 011000                    NOP     0

      148    18957    1   ENQDEQ_FLG = AS_FALSE ;

  18957  4 000136   000000 236000 xsym               LDQ     AS_FALSE
         4 000137   400000 376003                    ANQ     -131072,DU
         4 000140   000000 756000 xsym               STQ     ENQDEQ_FLG

      149    18958    1   RETURN ;

  18958  4 000141   000000 702200 xent               TSX2  ! X66_ARET

  18957  4 000142                       CM_STAT_ERR  null
      150    18959    1   CM_STAT_ERR: ;
      151    18960                                                              /**/
      152    18961        /*  Get twsn# from the twsn convert record. */
      153    18962    1   ARS = DSEG1SIZE ;

  18962  4 000142   000000 235000 xsym               LDA     DSEG1SIZE
         4 000143   200003 755100                    STA     ARS,,AUTO

      154    18963    1   WSNCVT$ = DSEG1$ ;

  18963  4 000144   000000 236000 xsym               LDQ     DSEG1$
         4 000145   200007 756100                    STQ     WSNCVT$,,AUTO

      155    18964    1   USERS_KEY.COUNT = 4 ;

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:30   
  18964  4 000146   004000 236003                    LDQ     2048,DU
         4 000147   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      156    18965    1   USERS_KEY.TXTC = 'TERM' ;

  18965  4 000150   040000 100400                    MLR     fill='040'O
         4 000151   000023 000004 3                  ADSC9   KL_TREC+19               cn=0,n=4
         4 000152   000000 200051 xsym               ADSC9   USERS_KEY                cn=1,n=41

      157    18966    1   CALL ASB$ENQ_HLP ALTRET( ENQ_ERR ) ;

  18966  4 000153   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000154   000000 701000 xent               TSX1    ASB$ENQ_HLP
         4 000155   000425 702000 4                  TSX2    ENQ_ERR

      158    18967    1   CALL ASB$READ_HLP( WSNCVT$, ARS, 1 ) ALTRET( TERMCVT_ERR ) ;

  18967  4 000156   000011 236000 5                  LDQ     9
         4 000157   200020 756100                    STQ     NAME+5,,AUTO
         4 000160   200003 630500                    EPPR0   ARS,,AUTO
         4 000161   200017 450500                    STP0    NAME+4,,AUTO
         4 000162   200007 631500                    EPPR1   WSNCVT$,,AUTO
         4 000163   200016 451500                    STP1    NAME+3,,AUTO
         4 000164   200016 630500                    EPPR0   NAME+3,,AUTO
         4 000165   000021 631400 xsym               EPPR1   B_VECTNIL+17
         4 000166   000000 701000 xent               TSX1    ASB$READ_HLP
         4 000167   000420 702000 4                  TSX2    TERMCVT_ERR

      159    18968    1   TWSN# = 1;

  18968  4 000170   000001 235007                    LDA     1,DL
         4 000171   200004 755100                    STA     TWSN#,,AUTO

      160    18969        /*
      161    18970          Look for the first available blank spot for a station name in
      162    18971        the 'TERM' record, ie. KL$WSNCVT.WSN(?) = AS_BLANK.  If none of
      163    18972        current spots are blank TWSN# will become > KL$WSNCVT.LTWSN.
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:31   
      164    18973        This method of adding stations/twsns puts no limit on the number
      165    18974        of stations that may be added to the system.  There are probably
      166    18975        some implied limits, though.  The first that comes to mind is the
      167    18976        256K word limit on a data segment, which is what the 'TERM'
      168    18977        record is read into.  There may also be a limit to the record size
      169    18978        that file management can read or write.
      170    18979        */
      171    18980
      172    18981    1   LOOP:
      173    18982    2   DO WHILE TWSN# <= KL$WSNCVT.LTWSN;

  18982  4 000172   200007 470500       LOOP         LDP0    WSNCVT$,,AUTO
         4 000173   000001 236100                    LDQ     1,,PR0
         4 000174   200004 116100                    CMPQ    TWSN#,,AUTO
         4 000175   000213 602000 4                  TNC     s:18988

      174    18983    2      IF KL$WSNCVT.WSN(TWSN#) = '        ' THEN

  18983  4 000176   200004 235100                    LDA     TWSN#,,AUTO
         4 000177   000003 735000                    ALS     3
         4 000200   200007 470500                    LDP0    WSNCVT$,,AUTO
         4 000201   040000 106505                    CMPC    fill='040'O
         4 000202   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8
         4 000203   000024 000010 3                  ADSC9   KL_TREC+20               cn=0,n=8
         4 000204   000213 600000 4                  TZE     s:18988

      175    18984    2         EXIT LOOP;
      176    18985    2      ELSE
      177    18986    2         TWSN# = TWSN# + 1;

  18986  4 000205   200004 236100                    LDQ     TWSN#,,AUTO
         4 000206   000001 036007                    ADLQ    1,DL
         4 000207   200004 756100                    STQ     TWSN#,,AUTO

      178    18987    2      END LOOP;

  18987  4 000210   000001 116100                    CMPQ    1,,PR0
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:32   
         4 000211   000176 602000 4                  TNC     s:18983
         4 000212   000176 600000 4                  TZE     s:18983

      179    18988    1   IF TWSN# > KL$WSNCVT.LTWSN

  18988  4 000213   000001 236100                    LDQ     1,,PR0
         4 000214   200004 116100                    CMPQ    TWSN#,,AUTO
         4 000215   000244 603000 4                  TRC     s:19024

      180    18989    2   THEN DO ;

      181    18990        /*
      182    18991           Check that data segment 1 has the room to add another 8 characters,
      183    18992           ie. the size of another station name.
      184    18993           If yes, we are ok.
      185    18994           If no, expand the data segment.
      186    18995        */
      187    18996
      188    18997    2      IF (KL$WSNCVT.LTWSN * SIZEC(KL$WSNCVT.WSN(0)) + 8) > (DSEG1SIZE - 8)

  18997  4 000216   000001 235100                    LDA     1,,PR0
         4 000217   000003 735000                    ALS     3
         4 000220   000010 035007                    ADLA    8,DL
         4 000221   200016 755100                    STA     NAME+3,,AUTO
         4 000222   000000 236000 xsym               LDQ     DSEG1SIZE
         4 000223   000010 136007                    SBLQ    8,DL
         4 000224   000227 604000 4                  TMI     s:18999
         4 000225   200016 116100                    CMPQ    NAME+3,,AUTO
         4 000226   000241 603000 4                  TRC     s:19022

      189    18998    3      THEN DO;

      190    18999    3         CALL ASB$GET_MORE_SEG (1, 4096) WHENALTRETURN

  18999  4 000227   000013 630400 5                  EPPR0   11
         4 000230   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000231   000000 701000 xent               TSX1    ASB$GET_MORE_SEG
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:33   
         4 000232   000234 702000 4                  TSX2    s:19016
         4 000233   000241 710000 4                  TRA     s:19022

      191    19000    4         DO;

      192    19001        /*E*  ERROR:    ASA-E$NO_TWSN_NUM-C
      193    19002              MESSAGE:  Unable to get TWSN number.
      194    19003        */
      195    19004                 %SCREAM( ERR#=E$NO_TWSN_NUM, LEVEL=ERROR, MID='A') ;

  19016  4 000234   000015 630400 5                  EPPR0   13
         4 000235   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000236   000000 701000 xent               TSX1    ASH$ERROR
         4 000237   000000 011000                    NOP     0

      196    19019    4            RETURN ;

  19019  4 000240   000000 702200 xent               TSX2  ! X66_ARET

      197    19020    4            END ;     /* Whenaltreturn from ASB$GET_MORE_SEG  */
      198    19021    3         END ; /* Size of 'TERM' record > DATASEG1  */

      199    19022    2      KL$WSNCVT.LTWSN = TWSN# ;

  19022  4 000241   200007 470500                    LDP0    WSNCVT$,,AUTO
         4 000242   200004 235100                    LDA     TWSN#,,AUTO
         4 000243   000001 755100                    STA     1,,PR0

      200    19023    2      END ; /* TWSN# > KL$WSNCVT.LTWSN  */

      201    19024    1   KL$WSNCVT.WSN( TWSN# ) = STAT_KEY.TXT.ACCT ;

  19024  4 000244   200004 235100                    LDA     TWSN#,,AUTO
         4 000245   000001 735000                    ALS     1
         4 000246   000002 735000                    ALS     2
         4 000247   200007 470500                    LDP0    WSNCVT$,,AUTO
         4 000250   040105 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:34   
         4 000251   000000 200010 2                  ADSC9   STAT_KEY                 cn=1,n=8
         4 000252   000002 000010                    ADSC9   2,A,PR0                  cn=0,n=8

      202    19025    1   ARS = LENGTHC( KL$WSNCVT ) + LENGTHC( KL$WSNCVT.WSN(0) ) * (KL$WSNCVT.LTWSN ) ;

  19025  4 000253   200007 470500                    LDP0    WSNCVT$,,AUTO
         4 000254   000001 235100                    LDA     1,,PR0
         4 000255   000003 735000                    ALS     3
         4 000256   000020 035007                    ADLA    16,DL
         4 000257   200003 755100                    STA     ARS,,AUTO

      203    19026    1   CALL ASB$WRITE_HLP( WSNCVT$, ARS ) ALTRET( WRITE_TREC_ERR ) ;

  19026  4 000260   200003 631500                    EPPR1   ARS,,AUTO
         4 000261   200017 451500                    STP1    NAME+4,,AUTO
         4 000262   200007 633500                    EPPR3   WSNCVT$,,AUTO
         4 000263   200016 453500                    STP3    NAME+3,,AUTO
         4 000264   200016 630500                    EPPR0   NAME+3,,AUTO
         4 000265   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000266   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000267   000406 702000 4                  TSX2    WRITE_TREC_ERR

      204    19027    1   CALL ASB$DEQ_HLP ALTRET( DEQ_ERR ) ;

  19027  4 000270   000002 631400 xsym               EPPR1   B_VECTNIL+2
         4 000271   000000 701000 xent               TSX1    ASB$DEQ_HLP
         4 000272   000425 702000 4                  TSX2    ENQ_ERR

      205    19028        /*  Fill in and write to :HLP the  twsnxxxx record
      206    19029            and the station record.
      207    19030        */
      208    19031    1   KL$TWSNREC = '0'B ;

  19031  4 000273   200011 470500                    LDP0    TWSNR$,,AUTO
         4 000274   000100 100400                    MLR     fill='000'O
         4 000275   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         4 000276   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:35   

      209    19032    1   KL$TWSNREC.WSN = AS_BLANK ;

  19032  4 000277   200011 470500                    LDP0    TWSNR$,,AUTO
         4 000300   040100 100400                    MLR     fill='040'O
         4 000301   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         4 000302   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8

      210    19033    1   KL$TWSNREC.STATION = STAT_KEY.TXT.ACCT ;

  19033  4 000303   200011 470500                    LDP0    TWSNR$,,AUTO
         4 000304   040100 100400                    MLR     fill='040'O
         4 000305   000000 200010 2                  ADSC9   STAT_KEY                 cn=1,n=8
         4 000306   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      211    19034    1   TWSN_ARS = LENGTHC( KL$TWSNREC ) - LENGTHC( KL$TWSNREC.DEVS(0) ) ;

  19034  4 000307   000024 235007                    LDA     20,DL
         4 000310   200012 755100                    STA     TWSN_ARS,,AUTO

      212    19035    1   KL$TREC = KL_TREC ;

  19035  4 000311   200010 470500                    LDP0    TREC$,,AUTO
         4 000312   000100 100400                    MLR     fill='000'O
         4 000313   000000 000100 3                  ADSC9   KL_TREC                  cn=0,n=64
         4 000314   000000 000100                    ADSC9   0,,PR0                   cn=0,n=64

      213    19036    1   KL$TREC.SUPER = AS_STAT#;

  19036  4 000315   200010 470500                    LDP0    TREC$,,AUTO
         4 000316   000002 236007                    LDQ     2,DL
         4 000317   000000 552104                    STBQ    0,'04'O,PR0

      214    19037    1   KL$TREC.SNAME = STAT_KEY.TXT.ACCT ;

  19037  4 000320   200010 470500                    LDP0    TREC$,,AUTO
         4 000321   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:36   
         4 000322   000000 200010 2                  ADSC9   STAT_KEY                 cn=1,n=8
         4 000323   000015 000010                    ADSC9   13,,PR0                  cn=0,n=8

      215    19038    1   KL$TREC.PNAME.CNT = 0 ;

  19038  4 000324   000000 236003                    LDQ     0,DU
         4 000325   000004 552140                    STBQ    4,'40'O,PR0

      216    19039    1   KL$TREC.PNAME.TXT = ' ' ;

  19039  4 000326   200010 470500                    LDP0    TREC$,,AUTO
         4 000327   040100 100400                    MLR     fill='040'O
         4 000330   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         4 000331   000004 200013                    ADSC9   4,,PR0                   cn=1,n=11

      217    19040                                                             /*  Station record */
      218    19041    1   CALL BINCHAR( TWSNC, TWSN# ) ;

  19041  4 000332   200004 235100                    LDA     TWSN#,,AUTO
         4 000333   000044 773000                    LRL     36
         4 000334   200016 757100                    STAQ    NAME+3,,AUTO
         4 000335   000100 301500                    BTD
         4 000336   200016 000010                    NDSC9   NAME+3,,AUTO             cn=0,s=lsgnf,sf=0,n=8
         4 000337   200005 030004                    NDSC9   TWSNC,,AUTO              cn=0,s=nosgn,sf=0,n=4

      219    19042    1   KL$TREC.TWSN# = TWSNC ;

  19042  4 000340   200005 236100                    LDQ     TWSNC,,AUTO
         4 000341   200010 470500                    LDP0    TREC$,,AUTO
         4 000342   000001 756100                    STQ     1,,PR0

      220    19043    1   KL$TREC.ATYP = %KLAT_STA# ;

  19043  4 000343   200010 470500                    LDP0    TREC$,,AUTO
         4 000344   000000 236003                    LDQ     0,DU
         4 000345   000000 552140                    STBQ    0,'40'O,PR0

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:37   
      221    19044    1   KL$TREC.NWINFO = 0 ;

  19044  4 000346   200010 470500                    LDP0    TREC$,,AUTO
         4 000347   000017 450100                    STZ     15,,PR0

      222    19045    1   ARS = LENGTHC (KL$TREC) ;

  19045  4 000350   000100 235007                    LDA     64,DL
         4 000351   200003 755100                    STA     ARS,,AUTO

      223    19046    1   USERS_KEY = STAT_KEY ;

  19046  4 000352   000000 100400                    MLR     fill='000'O
         4 000353   000000 000020 2                  ADSC9   STAT_KEY                 cn=0,n=16
         4 000354   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      224    19047    1   CALL ASB$WRITE_HLP( TREC$, ARS ) ALTRET ( WRITE_TREC_ERR ) ;

  19047  4 000355   200003 631500                    EPPR1   ARS,,AUTO
         4 000356   200017 451500                    STP1    NAME+4,,AUTO
         4 000357   200010 633500                    EPPR3   TREC$,,AUTO
         4 000360   200016 453500                    STP3    NAME+3,,AUTO
         4 000361   200016 630500                    EPPR0   NAME+3,,AUTO
         4 000362   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000363   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000364   000406 702000 4                  TSX2    WRITE_TREC_ERR

      225    19048                                                              /* Twsnxxxx record */
      226    19049    1   USERS_KEY.COUNT = 8 ;

  19049  4 000365   010000 236003                    LDQ     4096,DU
         4 000366   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      227    19050    1   CALL CONCAT( USERS_KEY.TXTC, 'TWSN', TWSNC ) ;

  19050  4 000367   040000 100400                    MLR     fill='040'O
         4 000370   000027 000004 3                  ADSC9   KL_TREC+23               cn=0,n=4
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:38   
         4 000371   000000 200004 xsym               ADSC9   USERS_KEY                cn=1,n=4
         4 000372   040000 100500                    MLR     fill='040'O
         4 000373   200005 000004                    ADSC9   TWSNC,,AUTO              cn=0,n=4
         4 000374   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      228    19051    1   CALL ASB$WRITE_HLP( TWSNR$, TWSN_ARS ) ALTRET( WRITE_TREC_ERR ) ;

  19051  4 000375   200012 630500                    EPPR0   TWSN_ARS,,AUTO
         4 000376   200017 450500                    STP0    NAME+4,,AUTO
         4 000377   200011 631500                    EPPR1   TWSNR$,,AUTO
         4 000400   200016 451500                    STP1    NAME+3,,AUTO
         4 000401   200016 630500                    EPPR0   NAME+3,,AUTO
         4 000402   000020 631400 xsym               EPPR1   B_VECTNIL+16
         4 000403   000000 701000 xent               TSX1    ASB$WRITE_HLP
         4 000404   000406 702000 4                  TSX2    WRITE_TREC_ERR

      229    19052                                                              /**/
      230    19053    1   RETURN ;

  19053  4 000405   000000 702200 xent               TSX2  ! X66_ARET

  19050  4 000406                       WRITE_TREC_* null
      231    19054                                                              /* Errors */
      232    19055                                                              /**/
      233    19056                                                              /**/
      234    19057                                                              /**/
      235    19058    1   WRITE_TREC_ERR: ;
      236    19059    1   CALL ASH$ERROR( ERR_CODE ) ;

  19059  4 000406   000016 630400 5                  EPPR0   14
         4 000407   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000410   000000 701000 xent               TSX1    ASH$ERROR
         4 000411   000000 011000                    NOP     0

      237    19060    1   RETURN ;

  19060  4 000412   000000 702200 xent               TSX2  ! X66_ARET
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:39   

  19050  4 000413                       TERM_CMD_ERR null
      238    19061                                                              /**/
      239    19062    1   TERM_CMD_ERR: ;
      240    19063    1   CALL ASH$ERROR( P_PCB.ERROR ) ;

  19063  4 000413   000017 630400 5                  EPPR0   15
         4 000414   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000415   000000 701000 xent               TSX1    ASH$ERROR
         4 000416   000000 011000                    NOP     0

      241    19064    1   RETURN ;

  19064  4 000417   000000 702200 xent               TSX2  ! X66_ARET

  19050  4 000420                       TERMCVT_ERR  null
      242    19065                                                              /**/
      243    19066    1   TERMCVT_ERR: ;
      244    19067        /*E*  ERROR:    ASA-E$CANT_READ_TERM_CONV-C
      245    19068              MESSAGE:  Unable to read TERMINAL CONVERT record.
      246    19069        */
      247    19070        %SCREAM( ERR#=E$CANT_READ_TERM_CONV, LEVEL=ERROR, MID='A') ;

  19082  4 000420   000020 630400 5                  EPPR0   16
         4 000421   000017 631400 xsym               EPPR1   B_VECTNIL+15
         4 000422   000000 701000 xent               TSX1    ASH$ERROR
         4 000423   000000 011000                    NOP     0

      248    19085    1   RETURN ;

  19085  4 000424   000000 702200 xent               TSX2  ! X66_ARET

  19082  4 000425                       ENQ_ERR      null
  19082  4 000425                       DEQ_ERR      null
      249    19086                                                              /**/
      250    19087                                                              /**/
      251    19088    1   ENQ_ERR: ;
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:40   
      252    19089                                                              /**/
      253    19090    1   DEQ_ERR: ;
      254    19091    1   END   ASA$STATION ;

  19091  4 000425   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:41   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
      No diagnostics issued in procedure ASA$STATION.
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:42   

 **** Variables and constants ****

  ****  Section 002  Data  ASA$STATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 STAT_KEY

  ****  Section 003 RoData ASA$STATION

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL_TREC

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w UBIN        r     1 ARS                        6-0-0/w PTR         r     1 BLK$
    13-0-0/c STRC(81)    r     1 NAME                      10-0-0/w PTR         r     1 TREC$
     4-0-0/w UBIN        r     1 TWSN#                      5-0-0/c CHAR(4)     r     1 TWSNC
    11-0-0/w PTR         r     1 TWSNR$                    12-0-0/w UBIN        r     1 TWSN_ARS
     7-0-0/w PTR         r     1 WSNCVT$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/b BIT         r     1 AS_FALSE
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/b BIT         r     1 AS_TRUE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/b BIT         r     1 DSEG_FLG
     0-0-0/b BIT         r     1 ENQDEQ_FLG                 0-0-0/b STRC        r     1 ERR_CODE
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:43   
     0-0-0/w PTR         r     1 NODE$                      0-0-0/w STRC(504)   r     1 P_PCB
     0-0-0/w UBIN        r     1 STATION_CMD                0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$TREC                    0-0-0/w STRC(576)   r     1 KL$TWSNREC
     0-0-0/w STRC(144)   r     1 KL$WSNCVT                  0-0-0/w ASTR(153)   r     1 OUT$SYM
     0-0-0/w STRC(144)   r     1 P$NODE


   Procedure ASA$STATION requires 278 words for executable code.
   Procedure ASA$STATION requires 20 words of local(AUTO) storage.

    No errors detected in file ASA$STATION.:E05TSI    .
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:44   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:45   
          MINI XREF LISTING

ARS
     18437**DCL     18931<<ASSIGN  18934<>CALL    18935<>CALL    18962<<ASSIGN  18967<>CALL    19025<<ASSIGN
     19026<>CALL    19045<<ASSIGN  19047<>CALL
ASA_BRKS_LOC
     15580**DCL     15580--REDEF
ASB$CHECK_TYPE
     18858**DCL-ENT 18935--CALL
ASB$DEQ_HLP
     18843**DCL-ENT 18956--CALL    19027--CALL
ASB$ENQ_HLP
     18840**DCL-ENT 18932--CALL    18966--CALL
ASB$GETSEG
     18852**DCL-ENT 18881--CALL
ASB$GET_MORE_SEG
     18861**DCL-ENT 18999--CALL
ASB$READ_HLP
     18846**DCL-ENT 18934--CALL    18967--CALL
ASB$WRITE_HLP
     18849**DCL-ENT 19026--CALL    19047--CALL    19051--CALL
ASH$ERROR
     18855**DCL-ENT 18895--CALL    18922--CALL    18953--CALL    19016--CALL    19059--CALL    19063--CALL
     19082--CALL
AS_BLANK
     15440**DCL     19032>>ASSIGN
AS_DEFAULT.BANNER_PERM
     16273**DCL     16274--REDEF
AS_DEFAULT.BUDGET.MACCT
     16178**DCL     16182--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     16191**DCL     16194--REDEF
AS_DEFAULT.BUDGET.PACCUM
     16174**DCL     16176--REDEF
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:46   
AS_DEFAULT.BUDGET.PMAXC
     16169**DCL     16171--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     16289**DCL     16290--REDEF   16291--REDEF
AS_DEFAULT_DREC.PASSWORD
     17543**DCL     17547--REDEF
AS_DEFAULT_DREC.RENAME
     17566**DCL     17567--REDEF
AS_DFLT.BANNER_PERM
     16095**DCL     16096--REDEF
AS_DFLT.BUDGET.MACCT
     16000**DCL     16004--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     16013**DCL     16016--REDEF
AS_DFLT.BUDGET.PACCUM
     15996**DCL     15998--REDEF
AS_DFLT.BUDGET.PMAXC
     15991**DCL     15993--REDEF
AS_DFLT.SETUP_CHRA.TXT
     16111**DCL     16112--REDEF   16113--REDEF
AS_FALSE
     15440**DCL     18879>>ASSIGN  18957>>ASSIGN
AS_FE_MODE
     15446**DCL     15447--REDEF
AS_FIELD1
     15576**DCL     18940<<ASSIGN
AS_MODE
     15443**DCL     15445--REDEF
AS_MOD_USER.ACCESS
     18308**DCL     18309--REDEF
AS_MOD_USER.BANNER
     18295**DCL     18296--REDEF
AS_MOD_USER.BANNER_PERM
     18297**DCL     18298--REDEF
AS_MOD_USER.BILL
     18303**DCL     18304--REDEF
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:47   
AS_MOD_USER.CPROC
     18299**DCL     18300--REDEF
AS_MOD_USER.FEBILL
     18379**DCL     18380--REDEF
AS_MOD_USER.FECXTMEM
     18396**DCL     18397--REDEF
AS_MOD_USER.FEMINTS
     18381**DCL     18382--REDEF
AS_MOD_USER.FEMMEM
     18392**DCL     18393--REDEF
AS_MOD_USER.FEMTIME
     18390**DCL     18391--REDEF
AS_MOD_USER.FEPPRIV
     18387**DCL     18389--REDEF
AS_MOD_USER.FEPRIV
     18384**DCL     18386--REDEF
AS_MOD_USER.FORCE_BIT
     18293**DCL     18294--REDEF
AS_MOD_USER.KEY
     18375**DCL     18377--REDEF
AS_MOD_USER.LASTCPROC
     18301**DCL     18302--REDEF
AS_MOD_USER.LIMITS.DO_
     18349**DCL     18350--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     18365**DCL     18366--REDEF
AS_MOD_USER.LIMITS.LO
     18345**DCL     18346--REDEF
AS_MOD_USER.LIMITS.MEM
     18341**DCL     18342--REDEF
AS_MOD_USER.LIMITS.MPRIO
     18369**DCL     18370--REDEF
AS_MOD_USER.LIMITS.PDIS
     18357**DCL     18358--REDEF
AS_MOD_USER.LIMITS.PO
     18353**DCL     18354--REDEF
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:48   
AS_MOD_USER.LIMITS.TDIS
     18361**DCL     18362--REDEF
AS_MOD_USER.LIMITS.TIME
     18337**DCL     18338--REDEF
AS_MOD_USER.MAXENQ
     18318**DCL     18319--REDEF
AS_MOD_USER.PERM_BIT
     18291**DCL     18292--REDEF
AS_MOD_USER.PPRIV
     18313**DCL     18315--REDEF
AS_MOD_USER.PRIOB
     18320**DCL     18321--REDEF
AS_MOD_USER.PRIV
     18310**DCL     18312--REDEF
AS_MOD_USER.QUAN
     18316**DCL     18317--REDEF
AS_MOD_USER.SETUP
     18289**DCL     18290--REDEF
AS_PROJECT.BANNER_PERM
     16629**DCL     16630--REDEF
AS_PROJECT.BUDGET.MACCT
     16534**DCL     16538--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     16547**DCL     16550--REDEF
AS_PROJECT.BUDGET.PACCUM
     16530**DCL     16532--REDEF
AS_PROJECT.BUDGET.PMAXC
     16525**DCL     16527--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     16645**DCL     16646--REDEF   16647--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     16807**DCL     16808--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     16712**DCL     16716--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     16725**DCL     16728--REDEF
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:49   
AS_PROJECT_DFLT.BUDGET.PACCUM
     16708**DCL     16710--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     16703**DCL     16705--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     16823**DCL     16824--REDEF   16825--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     18029**DCL     18033--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     18052**DCL     18053--REDEF
AS_PROJECT_DREC.PASSWORD
     17867**DCL     17871--REDEF
AS_PROJECT_DREC.RENAME
     17890**DCL     17891--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     16451**DCL     16452--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     16356**DCL     16360--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     16369**DCL     16372--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     16352**DCL     16354--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     16347**DCL     16349--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     16467**DCL     16468--REDEF   16469--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     17705**DCL     17709--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     17728**DCL     17729--REDEF
AS_TRUE
     15440**DCL     18933>>ASSIGN
AS_USERS.BANNER_PERM
     15917**DCL     15918--REDEF
AS_USERS.BUDGET.MACCT
     15822**DCL     15826--REDEF
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:50   
AS_USERS.BUDGET.MAX_PROJECTS
     15835**DCL     15838--REDEF
AS_USERS.BUDGET.PACCUM
     15818**DCL     15820--REDEF
AS_USERS.BUDGET.PMAXC
     15813**DCL     15815--REDEF
AS_USERS.SETUP_CHRA.TXT
     15933**DCL     15934--REDEF   15935--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     16985**DCL     16986--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     16890**DCL     16894--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     16903**DCL     16906--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     16886**DCL     16888--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     16881**DCL     16883--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     17001**DCL     17002--REDEF   17003--REDEF
B$ALT.CODE
     18593**DCL     18593--REDEF   18594--REDEF   18594--REDEF
B$ALT.ERR.ERR#
     18595**DCL     18595--REDEF
B$ALT.EVID
     18594**DCL     18594--REDEF   18594--REDEF
BLK$
     18440**DCL     18654--IMP-PTR 18904<<ASSIGN  18905>>IF      18927>>ASSIGN  18928>>ASSIGN  18928>>ASSIGN
CM_STAT_ERR
     18957**LABEL   18934--CALLALT
DEQ_ERR
     19082**LABEL   19027--CALLALT
DSEG1$
     15581**DCL     18900>>ASSIGN  18934<>CALL    18935<>CALL    18963>>ASSIGN
DSEG1SIZE
     15582**DCL     18931>>ASSIGN  18962>>ASSIGN  18997>>IF
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:51   
DSEG2$
     15582**DCL     18901>>ASSIGN
DSEG_FLG
     15581**DCL     18880>>IF
ENQDEQ_FLG
     15583**DCL     18933<<ASSIGN  18957<<ASSIGN
ENQ_ERR
     19082**LABEL   18932--CALLALT 18966--CALLALT
ERR_CODE
     15575**DCL     15576--REDEF   19059<>CALL
EXIT#
     18956**LABEL   18935--CALLALT
KL$TREC
     18699**DCL     19035<<ASSIGN  19045--ASSIGN
KL$TREC.ATYP
     18704**DCL     19043<<ASSIGN
KL$TREC.NWINFO
     18797**DCL     19044<<ASSIGN
KL$TREC.PASSWORD
     18757**DCL     18761--REDEF
KL$TREC.PNAME.CNT
     18771**DCL     19038<<ASSIGN
KL$TREC.PNAME.TXT
     18774**DCL     19039<<ASSIGN
KL$TREC.RENAME
     18780**DCL     18781--REDEF
KL$TREC.SNAME
     18794**DCL     19037<<ASSIGN
KL$TREC.SUPER
     18751**DCL     19036<<ASSIGN
KL$TREC.TWSN#
     18754**DCL     19042<<ASSIGN
KL$TWSNREC
     18801**DCL     19031<<ASSIGN  19034--ASSIGN
KL$TWSNREC.DEVS
     18805**DCL     19034--ASSIGN
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:52   
KL$TWSNREC.STATION
     18803**DCL     19033<<ASSIGN
KL$TWSNREC.WSN
     18802**DCL     19032<<ASSIGN
KL$WSNCVT
     18827**DCL     19025--ASSIGN
KL$WSNCVT.LTWSN
     18830**DCL     18982>>DOWHILE 18988>>IF      18997>>IF      19022<<ASSIGN  19025>>ASSIGN
KL$WSNCVT.WSN
     18831**DCL     18983>>IF      18997--IF      19024<<ASSIGN  19025--ASSIGN
KL_DEFAULT.PASSWORD
     18191**DCL     18195--REDEF
KL_DEFAULT.RENAME
     18214**DCL     18215--REDEF
KL_DFLT.PASSWORD
     17381**DCL     17385--REDEF
KL_DFLT.RENAME
     17404**DCL     17405--REDEF
KL_DREC.PASSWORD
     17219**DCL     17223--REDEF
KL_DREC.RENAME
     17242**DCL     17243--REDEF
KL_DREC_CNT.PASSWORD
     17106**DCL     17110--REDEF
KL_DREC_CNT.RENAME
     17129**DCL     17130--REDEF
KL_TREC
     18484**DCL     19035>>ASSIGN
KL_TREC.PASSWORD
     18542**DCL     18546--REDEF
KL_TREC.RENAME
     18565**DCL     18566--REDEF
LOOP
     18982**LABEL   18984--EXIT
NAME
     18445**DCL     18935<>CALL    18940>>ASSIGN
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:53   
NAME.COUNT
     18446**DCL     18927<<ASSIGN
NAME.TEXT
     18447**DCL     18928<<ASSIGN  18929>>ASSIGN
NODE$
     15573**DCL     18607--IMP-PTR 18874<<ASSIGN  18904>>ASSIGN
OUT$SYM.COUNT
     18677**DCL     18680--IMP-SIZ 18905>>IF      18927>>ASSIGN  18928>>ASSIGN
OUT$SYM.TEXT
     18680**DCL     18928>>ASSIGN
P$NODE.SUBLK$
     18640**DCL     18904>>ASSIGN  18904>>ASSIGN
PROJ_KEY.TEXT
     15453**DCL     15453--REDEF
PROJ_KEY.TXT.PROJECT
     15453**DCL     15453--REDEF
P_PCB
     15608**DCL     18872<>CALL
P_PCB.ERROR
     15712**DCL     19063<>CALL
P_PCB.OUT$
     15621**DCL     18874>>ASSIGN
P_PCB.ROOT$
     15613**DCL     18871<<ASSIGN
REMEM_VAR
     15579**DCL     15579--REDEF
REM_FCMD
     15579**DCL     15580--REDEF
STATION_CMD
     18453**DCL     18871--ASSIGN
STAT_KEY
     18459**DCL     18930>>ASSIGN  19046>>ASSIGN
STAT_KEY.TXT.ACCT
     18462**DCL     18929<<ASSIGN  19024>>ASSIGN  19033>>ASSIGN  19037>>ASSIGN
TERMCVT_ERR
     19050**LABEL   18967--CALLALT
PL6.E3A0      #001=ASA$STATION File=ASA$STATION.:E05TSI                          TUE 07/29/97 08:44 Page:54   
TERM_CMD_ERR
     19050**LABEL   18872--CALLALT
TREC$
     18442**DCL     18699--IMP-PTR 18900<<ASSIGN  19035>>ASSIGN  19036>>ASSIGN  19037>>ASSIGN  19038>>ASSIGN
     19039>>ASSIGN  19042>>ASSIGN  19043>>ASSIGN  19044>>ASSIGN  19047<>CALL
TWSN#
     18438**DCL     18968<<ASSIGN  18982>>DOWHILE 18983>>IF      18986<<ASSIGN  18986>>ASSIGN  18988>>IF
     19022>>ASSIGN  19024>>ASSIGN  19041>>CALLBLT
TWSNC
     18439**DCL     19041<<CALLBLT 19042>>ASSIGN  19050>>CALLBLT
TWSNR$
     18443**DCL     18801--IMP-PTR 18901<<ASSIGN  19031>>ASSIGN  19032>>ASSIGN  19033>>ASSIGN  19051<>CALL
TWSN_ARS
     18444**DCL     19034<<ASSIGN  19051<>CALL
USERS_KEY
     15450**DCL     18879<<ASSIGN  18930<<ASSIGN  19046<<ASSIGN
USERS_KEY.COUNT
     15450**DCL     18964<<ASSIGN  19049<<ASSIGN
USERS_KEY.TEXT
     15450**DCL     15451--REDEF   15451--REDEF   15451--REDEF   15452--REDEF
USERS_KEY.TXTC
     15451**DCL     18965<<ASSIGN  19050<<CALLBLT
WRITE_TREC_ERR
     19050**LABEL   19026--CALLALT 19047--CALLALT 19051--CALLALT
WSNCVT$
     18441**DCL     18827--IMP-PTR 18963<<ASSIGN  18967<>CALL    18982>>DOWHILE 18983>>IF      18988>>IF
     18997>>IF      19022>>ASSIGN  19024>>ASSIGN  19025>>ASSIGN  19026<>CALL
X$PARSE
     18838**DCL-ENT 18872--CALL
