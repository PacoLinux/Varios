VERSION E05

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:1    
        1        1        /*M* GJM$MCL  Handler for fcg GJ Monitor Services  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0,CRM=70  */
        8        8
        9        9        GJM$MCL: PROC(GUD_PARAMS);
       10       10
       11       11        %INCLUDE G_JIT_M;
       12      276        %INCLUDE G_HJIT_M;
       13      421        %INCLUDE G_ROS_M;
       14      503        %INCLUDE GJ_MACROS_M;
       15      976        %INCLUDE GU_MACROS_M;
       16     1135        %INCLUDE GJ_MSG_M;
       17     1448 S      %INCLUDE GF_LCP6_M;
       18     1449 S      %INCLUDE KI_CP6;
       19     1450 S      %INCLUDE GH_LCP6_M;
       20     1451 S      %INCLUDE GJ_LCP6_M;
       21     1452 S      %INCLUDE GU_LCP6_M;
       22     1453 S      %INCLUDE G_LCP6_E;
       23     1454        %INCLUDE F_ERRORS_C;
       24     1694        %INCLUDE J_ERRORS_C;
       25     1781        %INCLUDE UD_ERRORS_C;
       26     1823
       27     1824                                                /* EQUs and SUBs            */
       28     1825        %GJ_FCN#;
       29     1851        %GJ_MCL_E;
       30     1860        %G$JIT_E;
       31     1922
       32     1923                                                /* Input parameters         */
       33     1924        %GUD_HAND_PARAMS (FPTN=GUD_PARAMS);
       34     2000
       35     2001                                                /* AUTO data                */
       36     2002    1   DCL MCL_CODE UBIN;
       37     2003    1   DCL P# UBIN;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:2    
       38     2004    1   DCL T$ PTR;
       39     2005    1   DCL INFO$ PTR;
       40     2006    1   DCL LDTRC_MSG_ VECTOR;
       41     2007        %GJ_LDTRC_MSG (FPTN=LDTRC_MSG,STCLASS=AUTO);
       42     2103    1   DCL REQUEST_MSG_ VECTOR;
       43     2104        %GJ_FCN_MSG (FPTN=REQUEST_MSG,STCLASS=AUTO);
       44     2174    1   DCL CCBUF$ PTR;
       45     2175
       46     2176                                                /*  Based Structures        */
       47     2177    1   DCL 1 B$NAME BASED,
       48     2178    1         2 L UBIN BYTE UNAL,
       49     2179    1         2 TEXT CHAR(B$NAME.L) UNAL;
       50     2180
       51     2181    1   DCL B$CHAR6 CHAR(6) BASED;
       52     2182    1   DCL B$CHAR8 CHAR(8) BASED;
       53     2183        %VLP_FPRG (FPTN=GJ_FID, STCLASS="BASED(CCBUF$)", LAST=NO);
       54     2204    1         2 MODTIME UBIN(32);
       55     2205
       56     2206        %G$ROS (FULL=YES,STCLASS="BASED(G$ROS$)");
       57     3157        %G$JIT (STCLASS="BASED(G$JIT$)");
       58     3571        %G$TSA (FPTN=G$TSA,STCLASS="BASED(GUD_PARAMS.TSA$)");
       59     3959        %G$TCB (STCLASS="BASED(G$TCB$)");
       60     3980        %G$ECCB (STCLASS="BASED(G$U_ECCB$)");
       61     4056        %G$EXCFR;
       62     4438        %GJ_LDTRC_MSG (FPTN=G$LDTRC_MSG,STCLASS=BASED);
       63     4534        %G$UHJIT (STCLASS="BASED(G$UHJIT$)");
       64     7508        %VLP_ERRCODE (FPTN=VLP$ERRCODE,
       65     7509                      STCLASS=BASED);
       66     7555        %FPT_EXIT (VECTORS=NO, STCLASS=BASED);
       67     7577        %FPT_LDTRC (VECTORS=NO, STCLASS=BASED);
       68     7601
       69     7602    1   DCL B$JERR(0:2) BASED BIT(32) WALIGNED;
       70     7603
       71     7604                                                /*  External data           */
       72     7605    1   DCL G$JIT$ PTR SYMREF READONLY;
       73     7606    1   DCL G$TCB$ PTR SYMREF READONLY;
       74     7607    1   DCL G$U_ECCB$ PTR SYMREF READONLY;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:3    
       75     7608    1   DCL G$UHJIT$ PTR SYMREF READONLY;
       76     7609    1   DCL G$ROS$ PTR SYMREF READONLY;
       77     7610
       78     7611                                                /* Internal data            */
       79     7612    1   DCL STEPCC(0:2) UBIN BYTE CONSTANT UNAL INIT(
       80     7613    1         %G_SEV_EXIT#,
       81     7614    1         %G_SEV_ERR#,
       82     7615    1         %G_SEV_XXX#);
       83     7616
       84     7617    1   DCL RNST(0:2) BIT(16) CONSTANT UNAL INIT(
       85     7618    1        %G_RS_EXIT#,
       86     7619    1        %G_RS_ERR#,
       87     7620    1        %G_RS_XXX#);
       88     7621
       89     7622    1   DCL 1 JERR CONSTANT,
       90     7623              %VLP_ERRCODE (FPTN=*,LVL=2,STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B,
       91     7624                            ERR#=0,SEV=%G_SEV_CONT#,LAST=NO);
       92     7670              %VLP_ERRCODE (FPTN=*,LVL=2,STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B,
       93     7671                            ERR#=%E$ERRPMME,SEV=%G_SEV_ERR#,LAST=NO);
       94     7717              %VLP_ERRCODE (FPTN=*,LVL=2,STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B,
       95     7718                            ERR#=%E$XXXPMME,SEV=%G_SEV_XXX#,LAST=YES);
       96     7764
       97     7765        %VLP_ERRCODE (FPTN=EBADFNME,ERR#=%E$BADFNME,SEV=G_SEV_ERROR#,
       98     7766                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
       99     7812
      100     7813        %VLP_ERRCODE (FPTN=EBADCODE,ERR#=%E$BADCODE,SEV=G_SEV_ERROR#,
      101     7814                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      102     7860
      103     7861        %VLP_ERRCODE (FPTN=EMODE,ERR#=%E$MODE,SEV=G_SEV_ERROR#,
      104     7862                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      105     7908
      106     7909        %VLP_ERRCODE (FPTN=EINTLVL,ERR#=%E$INTLVL,SEV=G_SEV_ERROR#,
      107     7910                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      108     7956
      109     7957        %VLP_ERRCODE (FPTN=ENOTAUTH,ERR#=%E$NOTAUTH,SEV=G_SEV_ERROR#,
      110     7958                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      111     8004
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:4    
      112     8005        %VLP_ERRCODE (FPTN=EALTRET,ERR#=%E$ALTRET,SEV=G_SEV_ERROR#,
      113     8006                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      114     8052
      115     8053        %VLP_ERRCODE (FPTN=EXCONLINK,ERR#=%E$XCONLINK,SEV=G_SEV_ERROR#,
      116     8054                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      117     8100
      118     8101                                                /* External Routines        */
      119     8102    1   DCL GJS$ABORTX ENTRY(1);
      120     8103    1   DCL KNA$WRITE ENTRY(4) ALTRET;
      121     8104    1   DCL KNA$WRITE_NOW ENTRY(4) ALTRET;
      122     8105    1   DCL GJS$STEP ENTRY(1);
      123     8106    1   DCL GJU$XCON ENTRY(2) ALTRET;
      124     8107
      125     8108        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:5    
      126     8109        /*F* NAME: GJM$MCL
      127     8110
      128     8111             PURPOSE:  GJM$MCL is the MCL handler for monitor
      129     8112                       services belonging to the GJ Functional
      130     8113                       Code Group.
      131     8114        */
      132     8115
      133     8116    1      MCL_CODE = GUD_PARAMS.MCL.C.MCL;
      134     8117    1      G$TSA.I.TRAP# = %G_MCL#;
      135     8118
      136     8119    2      DO CASE(GUD_PARAMS.MCL.CODE);
      137     8120
      138     8121
      139     8122        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:6    
      140     8123        /*************************************************************
      141     8124         *                                                           *
      142     8125         *               M$TRTN through an M$LDTRC frame             *
      143     8126         *                                                           *
      144     8127         *************************************************************/
      145     8128
      146     8129    2       CASE(0);
      147     8130    2         GOTO FINAL_EXIT;
      148     8131
      149     8132
      150     8133        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:7    
      151     8134        /*************************************************************
      152     8135         *                                                           *
      153     8136         *               M$EXIT   M$ERR   M$XXX                      *
      154     8137         *                                                           *
      155     8138         *************************************************************/
      156     8139
      157     8140        /*F* NAME: M$EXIT M$ERR M$XXX
      158     8141        */
      159     8142    2       CASE(%G_MCL_EXIT#,%G_MCL_ERR#,%G_MCL_XXX#);
      160     8143
      161     8144        /*D* If the user supplied the Step Condition Code setting on
      162     8145             the FPT it is moved to the JIT.  If not the default is
      163     8146             set in the JIT.
      164     8147        */
      165     8148    2         IF GUD_PARAMS.PTRS.PAR2$ ~= ADDR(NIL)
      166     8149    3         THEN DO;
      167     8150    3              G$JIT.STEPCC = GUD_PARAMS.PTRS.PAR2$->FPT_EXIT.STEPCC;
      168     8151    3              G$JIT.JUNK.SCCSET = '1'B;
      169     8152    3              END;
      170     8153    3         ELSE DO;
      171     8154    3              G$JIT.STEPCC = STEPCC(MCL_CODE);
      172     8155    3              END;
      173     8156
      174     8157        /*D* The same is done for the error code.
      175     8158        */
      176     8159    2         IF GUD_PARAMS.PTRS.PAR1$ ~= ADDR(NIL)
      177     8160    3         THEN DO;
      178     8161    3              GUD_PARAMS.ERR = GUD_PARAMS.PTRS.PAR1$->VLP$ERRCODE;
      179     8162    3              END;
      180     8163    3         ELSE DO;
      181     8164    3              T$ = ADDR(JERR);
      182     8165    3              GUD_PARAMS.ERR = T$->B$JERR(MCL_CODE);
      183     8166    3              END;
      184     8167
      185     8168        /*D* The run status and error code are set in the JIT.
      186     8169        */
      187     8170    2         G$JIT.RNST = RNST(MCL_CODE);
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:8    
      188     8171    2         G$JIT.ERR = GUD_PARAMS.ERR;
      189     8172
      190     8173        /*D* If the user has exit control it is entered now.
      191     8174        */
      192     8175    2         G$TSA.P = G$TSA.P -1;             /*point to the mcl*/
      193     8176    2         G$TSA.Z.IS = 0;              /*so delta doesn't confuse us*/
      194     8177    2         INFO$ = ADDR(NIL);
      195     8178    2         P#=0;
      196     8179    2         CALL GJU$XCON(INFO$,P#)
      197     8180    3         WHENRETURN DO;
      198     8181    3              IF G$JIT.DB# = 0
      199     8182    3              THEN G$TSA.P = G$TSA.P +1;
      200     8183                                 /*this is for post-association of delta*/
      201     8184    3              END;
      202     8185    3         WHENALTRETURN DO;
      203     8186    3              GUD_PARAMS.ERR = EALTRET;
      204     8187    3              RETURN;
      205     8188    3              END;
      206     8189
      207     8190        /*D* If this is the final exit following exit control for M$LDTRC,
      208     8191             the LDTRC information is moved from the exit conrol frame, the
      209     8192             frame is removed from the TCB stack, and we join up with the
      210     8193             LDTRC with no xcon logic.
      211     8194        */
      212     8195    2         IF G$TCB.CURRSZ ~= 0
      213     8196    3         THEN DO;
      214     8197    3              IF (G$TCB.STK$->G$EXCFR.ECC = %G_XCON#) AND
      215     8198    3                (G$TCB.STK$->G$EXCFR.TRLR.RNST & %G_RS_LDTRC#)
      216     8199    4              THEN DO;
      217     8200    4   FINAL_EXIT:     ;
      218     8201    4                   G$TSA.P$$ = G$TCB.STK$->G$EXCFR.P$$;
      219     8202    4                   G$TSA.R3 = G$TCB.STK$->G$EXCFR.REGS.R3;
      220     8203    4                   G$TSA.B3$ = G$TCB.STK$->G$EXCFR.REGS.B3$;
      221     8204
      222     8205    4                   G$TCB.AVSZ = G$TCB.AVSZ + G$TCB.CURRSZ;
      223     8206    4                   G$TCB.CURRSZ = G$TCB.STK$->G$EXCFR.PREVSZ;
      224     8207    4                   IF G$TCB.CURRSZ ~= 0
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:9    
      225     8208    4                   THEN G$TCB.STK$ = PINCRW(G$TCB.STK$,-G$TCB.CURRSZ);
      226     8209
      227     8210    4                   G$ECCB.FLAGS.XCONP = '0'B;
      228     8211    4                   G$ECCB.XCON$ = ENTADDR(NIL);
      229     8212
      230     8213    4                   G$TSA.I.TRAP# = 0;
      231     8214    4                   GUD_PARAMS.ERR = EALTRET;
      232     8215    4                   RETURN/*reissue M$LDTRC in user land*/;
      233     8216    4                   END;
      234     8217    3              END;
      235     8218
      236     8219        /*D* Otherwise GJS$ABORTX is called to begin the abort user process.
      237     8220        */
      238     8221    2         CALL GJS$ABORTX(GUD_PARAMS.ERR);
      239     8222    2         GUD_PARAMS.ERR = EALTRET;
      240     8223    2         RETURN;
      241     8224
      242     8225        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:10   
      243     8226        /*************************************************************
      244     8227         *                                                           *
      245     8228         *                        M$LDTRC                            *
      246     8229         *                                                           *
      247     8230         *************************************************************/
      248     8231
      249     8232        /*F* NAME: M$LDTRC
      250     8233        */
      251     8234    2       CASE(%G_MCL_LDTRC#);
      252     8235
      253     8236        /*D* If the M$LM DCB is not open it is a handler or a ghost user
      254     8237             and there is no entity on the host to communitcate with,
      255     8238             M$LDTRC requests are therefore not allowed.
      256     8239        */
      257     8240    2         IF NOT G$ROS.M$LM.FCD
      258     8241    3         THEN DO;
      259     8242    3              GUD_PARAMS.ERR = EMODE;
      260     8243    3              RETURN;
      261     8244    3              END;
      262     8245        /*E* ERROR: GJM-E$MODE-E
      263     8246             MESSAGE:  M$LDTRC not allowed in LCP-6 for handlers and ghosts.
      264     8247        */
      265     8248
      266     8249        /*D* Also, M$LDTRC is not allowed unless executing at the user base level.
      267     8250        */
      268     8251    2         IF G$UHJIT.DMN.ID ~= %G_DMN_USR_SVC#
      269     8252    3         THEN DO;
      270     8253    3              GUD_PARAMS.ERR = EINTLVL;
      271     8254    3              RETURN;
      272     8255    3              END;
      273     8256        /*E* ERROR: GJM-E$INTLVL-4
      274     8257             MESSAGE: M$LDTRC not allowed from interrupt level.
      275     8258        */
      276     8259
      277     8260        /*D* And M$LDTRC is not allowed if a Class 2 or Class 3 exit control
      278     8261             is in progress.
      279     8262        */
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:11   
      280     8263    2         IF (G$JIT.FRS & %G_RS_CL23#)
      281     8264    3         THEN DO;
      282     8265    3              G$JIT.ERR = EXCONLINK;
      283     8266    3              RETURN;
      284     8267    3              END;
      285     8268
      286     8269        /*D* The only other check that can be made initially is the existance
      287     8270             of the run-unit name.  If this fails, the return to the MCL
      288     8271             handler causes an ALTRET to the user's request.
      289     8272        */
      290     8273    2         IF (GUD_PARAMS.PTRS.PAR1$ ->B$NAME.L = 0) OR
      291     8274    2           (GUD_PARAMS.PTRS.PAR1$ ->B$NAME.TEXT = ' ') OR
      292     8275    2           (GUD_PARAMS.PTRS.PAR1$ ->B$NAME.L > GUD_PARAMS.BND.PAR1)
      293     8276    3         THEN DO;
      294     8277    3              GUD_PARAMS.ERR = EBADFNME;
      295     8278    3              RETURN;
      296     8279    3              END;
      297     8280        /*E* ERROR: GJM-E$BADFNME-E
      298     8281             MESSAGE:  Your M$LDTRC request did not specify a run-unit name.
      299     8282        */
      300     8283
      301     8284        /*D* If the user has exit control it is entered now.
      302     8285        */
      303     8286    2         G$JIT.RNST.LDTRC = '1'B;
      304     8287    2         G$TSA.P = G$TSA.P -1;
      305     8288    2         INFO$ = ADDR(NIL);
      306     8289    2         P# = 0;
      307     8290
      308     8291    2         CALL GJU$XCON(INFO$,P#)
      309     8292    3         WHENRETURN DO;
      310     8293    3              G$TSA.P = G$TSA.P +1;
      311     8294    3              END;
      312     8295    3         WHENALTRETURN DO;
      313     8296    3              GUD_PARAMS.ERR = EALTRET;
      314     8297    3              RETURN;
      315     8298    3              END;
      316     8299
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:12   
      317     8300        /* The user's parameters are moved to AUTO.
      318     8301        */
      319     8302    2   DO_LDTRC: ;
      320     8303    2         LDTRC_MSG.NAME = GUD_PARAMS.PTRS.PAR1$ -> B$NAME;
      321     8304
      322     8305    2         IF GUD_PARAMS.PTRS.PAR2$ = ADDR(NIL)
      323     8306    2         THEN LDTRC_MSG.ACCT = ' ';
      324     8307    2         ELSE LDTRC_MSG.ACCT = GUD_PARAMS.PTRS.PAR2$ -> B$CHAR8;
      325     8308
      326     8309    2         IF GUD_PARAMS.PTRS.PAR3$ = ADDR(NIL)
      327     8310    2         THEN LDTRC_MSG.PASS = ' ';
      328     8311    2         ELSE LDTRC_MSG.PASS = GUD_PARAMS.PTRS.PAR3$ -> B$CHAR8;
      329     8312
      330     8313    2         IF GUD_PARAMS.PTRS.PAR4$ = ADDR(NIL)
      331     8314    2         THEN LDTRC_MSG.PSN = ' ';
      332     8315    2         ELSE LDTRC_MSG.PSN = GUD_PARAMS.PTRS.PAR4$ -> B$CHAR6;
      333     8316
      334     8317    2         IF G$JIT.JUNK2.MICROFPL
      335     8318    3         THEN DO;
      336     8319    3              G$JIT.JUNK2.BYPASS_MFPL = '1'B;
      337     8320
      338     8321    3              IF GUD_PARAMS.PTRS.PAR6$ ~= ADDR(NIL)
      339     8322    3              THEN IF GUD_PARAMS.PTRS.PAR6$->FPT_LDTRC.NO_MICROFPL = '0'B
      340     8323    3                   THEN LDTRC_MSG.F1 = '1'B;
      341     8324    3              END;
      342     8325
      343     8326        /*D* A message is written to interrupt the Host program to tell him
      344     8327             that the current user program has terminated via M$LDTRC.
      345     8328        */
      346     8329    2         REQUEST_MSG_ = VECTOR(REQUEST_MSG);
      347     8330    2         REQUEST_MSG.FCN = %GJ_PROG_LDTRC#;
      348     8331    2         CALL KNA$WRITE_NOW(%G_M$LM#,REQUEST_MSG_,GUD_PARAMS.ERR)
      349     8332    3         WHENALTRETURN DO;
      350     8333    3              RETURN;
      351     8334    3              END;
      352     8335
      353     8336        /*D* Once in sync, a message is sent to the Host program to convey
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:13   
      354     8337             the identification of the run-unit requested.
      355     8338        */
      356     8339    2         LDTRC_MSG_ = VECTOR(LDTRC_MSG);
      357     8340    2         LDTRC_MSG.FCN = %GJ_LDTRC_FP#;
      358     8341    2         CALL KNA$WRITE(%G_M$LM#,LDTRC_MSG_,GUD_PARAMS.ERR)
      359     8342    3         WHENALTRETURN DO;
      360     8343    3              RETURN;
      361     8344    3              END;
      362     8345
      363     8346        /*D* The fid of the run-unit making the M$LDTRC request is saved
      364     8347             in the JIT.CCBUF so it is available to the called fprg,
      365     8348             or so it may be restored if GJS$STEP altrets.
      366     8349        */
      367     8350    2         CCBUF$ = ADDR(G$JIT.CCBUF);
      368     8351    2         GJ_FID.NAME = G$ROS.M$LM.NAME;
      369     8352    2         GJ_FID.ACCT# = G$ROS.M$LM.ACCT;
      370     8353    2         GJ_FID.PASS# = G$ROS.M$LM.PASS;
      371     8354    2         GJ_FID.PSN# = G$ROS.M$LM.PSN;
      372     8355    2         GJ_FID.MODTIME = G$ROS.M$LM.MODTIME;
      373     8356
      374     8357        /*D* The MLDTRC bit is set in JIT.JUNK and control is transfered to
      375     8358             the GJS$STEP module where the SETFP message will be read and
      376     8359             the run-unit fetched and put into execution.
      377     8360        */
      378     8361    2         IF GUD_PARAMS.PTRS.PAR6$ ~= ADDR(NIL)
      379     8362    3         THEN DO;
      380     8363    3              IF GUD_PARAMS.PTRS.PAR6$->FPT_LDTRC.DISP = %G_DISP_KEEP#
      381     8364    3              THEN G$JIT.JUNK.KEEP = '1'B;
      382     8365    3              END;
      383     8366
      384     8367    2         G$JIT.JUNK.MLDTRC = '1'B;
      385     8368    2         CALL GJS$STEP(GUD_PARAMS);
      386     8369
      387     8370        /*D* If GJS$STEP should return it will have set the error code
      388     8371             in GUD_PARAMS.ERR, so we reset G$ROS.M$LM.fid and the MLDTRC bit
      389     8372             in JIT.JUNK and return to the MCL handler to cause an ALTRET
      390     8373             to the user's M$LDTRC request.  Note that GJS$STEP will
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:14   
      391     8374             error here only if he gets an error on the SETFP message or
      392     8375             if the user program would exceed the user's memory allocation.
      393     8376             The error code will be E$ALTRET if we are to enter the debugger.
      394     8377        */
      395     8378    2         IF (GUD_PARAMS.ERR.ERR# ~= 0) AND (GUD_PARAMS.ERR.ERR# ~= %E$ALTRET)
      396     8379    3         THEN DO;
      397     8380    3              G$ROS.M$LM.NAME = GJ_FID.NAME;
      398     8381    3              G$ROS.M$LM.ACCT = GJ_FID.ACCT#;
      399     8382    3              G$ROS.M$LM.PASS = GJ_FID.PASS#;
      400     8383    3              G$ROS.M$LM.PSN = GJ_FID.PSN#;
      401     8384    3              G$ROS.M$LM.MODTIME = GJ_FID.MODTIME;
      402     8385    3              END;
      403     8386
      404     8387    2         G$JIT.JUNK.MLDTRC = '0'B;
      405     8388    2         G$JIT.JUNK.KEEP = '0'B;
      406     8389
      407     8390        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:15   
      408     8391    2       CASE(%G_MCL_SCREECH#);
      409     8392    2         GUD_PARAMS.ERR = ENOTAUTH;
      410     8393
      411     8394        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:16   
      412     8395    2       CASE(%G_MCL_CPEXIT#);
      413     8396    2         G$ROS.M$LM.DVBYTE.BP = '1'B;
      414     8397
      415     8398    2         IF GUD_PARAMS.PTRS.PAR1$ = ADDR(NIL)
      416     8399    2         THEN CALL GJS$STEP(GUD_PARAMS);
      417     8400
      418     8401        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:17   
      419     8402    2       CASE(ELSE);
      420     8403    2         GUD_PARAMS.ERR = EBADCODE;
      421     8404    2         END/* DO CASE(mcl code)*/;
      422     8405    1   END;

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:18   
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   J_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   GJ_MSG_M.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   GJ_MACROS_M.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   G_HJIT_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GJM$MCL.

   Procedure GJM$MCL requires 932 words for executable code.
   Procedure GJM$MCL requires 60 words of local(AUTO) storage.

    No errors detected in file GJM$MCL.:E05TSI    .

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:19   

 Object Unit name= GJM$MCL                                    File name= GJM$MCL.:E05TOU
 UTS= JUL 29 '97 21:57:23.80 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS     25     19  GJM$MCL
    1   Proc  even  none   932    3A4  GJM$MCL
    2  RoData even  none     3      3  GJM$MCL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  GJM$MCL

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 GJU$XCON
 yes     yes           Std       4 KNA$WRITE_NOW
 yes     yes           Std       4 KNA$WRITE
         yes           Std       1 GJS$STEP
         yes           Std       1 GJS$ABORTX
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
                       nStd      0 X6C_ALRZ
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:20   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    G$JIT$                           r    G$TCB$                           r    G$U_ECCB$
r    G$UHJIT$                         r    G$ROS$                           r    G$ROS$
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:21   


        1        1        /*M* GJM$MCL  Handler for fcg GJ Monitor Services  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0,CRM=70  */
        8        8
        9        9        GJM$MCL: PROC(GUD_PARAMS);

      9   1 000000  D380 0000 0000  xent GJM$MCL         LNJ,B5   X6A_AUTO_1
          1 000003       003C 0001                       DC       60,1

       10       10
       11       11        %INCLUDE G_JIT_M;
       12      276        %INCLUDE G_HJIT_M;
       13      421        %INCLUDE G_ROS_M;
       14      503        %INCLUDE GJ_MACROS_M;
       15      976        %INCLUDE GU_MACROS_M;
       16     1135        %INCLUDE GJ_MSG_M;
       17     1448 S      %INCLUDE GF_LCP6_M;
       18     1449 S      %INCLUDE KI_CP6;
       19     1450 S      %INCLUDE GH_LCP6_M;
       20     1451 S      %INCLUDE GJ_LCP6_M;
       21     1452 S      %INCLUDE GU_LCP6_M;
       22     1453 S      %INCLUDE G_LCP6_E;
       23     1454        %INCLUDE F_ERRORS_C;
       24     1694        %INCLUDE J_ERRORS_C;
       25     1781        %INCLUDE UD_ERRORS_C;
       26     1823
       27     1824                                                /* EQUs and SUBs            */
       28     1825        %GJ_FCN#;
       29     1851        %GJ_MCL_E;
       30     1860        %G$JIT_E;
       31     1922
       32     1923                                                /* Input parameters         */
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:22   
       33     1924        %GUD_HAND_PARAMS (FPTN=GUD_PARAMS);
       34     2000
       35     2001                                                /* AUTO data                */
       36     2002    1   DCL MCL_CODE UBIN;
       37     2003    1   DCL P# UBIN;
       38     2004    1   DCL T$ PTR;
       39     2005    1   DCL INFO$ PTR;
       40     2006    1   DCL LDTRC_MSG_ VECTOR;
       41     2007        %GJ_LDTRC_MSG (FPTN=LDTRC_MSG,STCLASS=AUTO);
       42     2103    1   DCL REQUEST_MSG_ VECTOR;
       43     2104        %GJ_FCN_MSG (FPTN=REQUEST_MSG,STCLASS=AUTO);
       44     2174    1   DCL CCBUF$ PTR;
       45     2175
       46     2176                                                /*  Based Structures        */
       47     2177    1   DCL 1 B$NAME BASED,
       48     2178    1         2 L UBIN BYTE UNAL,
       49     2179    1         2 TEXT CHAR(B$NAME.L) UNAL;
       50     2180
       51     2181    1   DCL B$CHAR6 CHAR(6) BASED;
       52     2182    1   DCL B$CHAR8 CHAR(8) BASED;
       53     2183        %VLP_FPRG (FPTN=GJ_FID, STCLASS="BASED(CCBUF$)", LAST=NO);
       54     2204    1         2 MODTIME UBIN(32);
       55     2205
       56     2206        %G$ROS (FULL=YES,STCLASS="BASED(G$ROS$)");
       57     3157        %G$JIT (STCLASS="BASED(G$JIT$)");
       58     3571        %G$TSA (FPTN=G$TSA,STCLASS="BASED(GUD_PARAMS.TSA$)");
       59     3959        %G$TCB (STCLASS="BASED(G$TCB$)");
       60     3980        %G$ECCB (STCLASS="BASED(G$U_ECCB$)");
       61     4056        %G$EXCFR;
       62     4438        %GJ_LDTRC_MSG (FPTN=G$LDTRC_MSG,STCLASS=BASED);
       63     4534        %G$UHJIT (STCLASS="BASED(G$UHJIT$)");
       64     7508        %VLP_ERRCODE (FPTN=VLP$ERRCODE,
       65     7509                      STCLASS=BASED);
       66     7555        %FPT_EXIT (VECTORS=NO, STCLASS=BASED);
       67     7577        %FPT_LDTRC (VECTORS=NO, STCLASS=BASED);
       68     7601
       69     7602    1   DCL B$JERR(0:2) BASED BIT(32) WALIGNED;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:23   
       70     7603
       71     7604                                                /*  External data           */
       72     7605    1   DCL G$JIT$ PTR SYMREF READONLY;
       73     7606    1   DCL G$TCB$ PTR SYMREF READONLY;
       74     7607    1   DCL G$U_ECCB$ PTR SYMREF READONLY;
       75     7608    1   DCL G$UHJIT$ PTR SYMREF READONLY;
       76     7609    1   DCL G$ROS$ PTR SYMREF READONLY;
       77     7610
       78     7611                                                /* Internal data            */
       79     7612    1   DCL STEPCC(0:2) UBIN BYTE CONSTANT UNAL INIT(
       80     7613    1         %G_SEV_EXIT#,
       81     7614    1         %G_SEV_ERR#,
       82     7615    1         %G_SEV_XXX#);
       83     7616
       84     7617    1   DCL RNST(0:2) BIT(16) CONSTANT UNAL INIT(
       85     7618    1        %G_RS_EXIT#,
       86     7619    1        %G_RS_ERR#,
       87     7620    1        %G_RS_XXX#);
       88     7621
       89     7622    1   DCL 1 JERR CONSTANT,
       90     7623              %VLP_ERRCODE (FPTN=*,LVL=2,STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B,
       91     7624                            ERR#=0,SEV=%G_SEV_CONT#,LAST=NO);
       92     7670              %VLP_ERRCODE (FPTN=*,LVL=2,STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B,
       93     7671                            ERR#=%E$ERRPMME,SEV=%G_SEV_ERR#,LAST=NO);
       94     7717              %VLP_ERRCODE (FPTN=*,LVL=2,STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B,
       95     7718                            ERR#=%E$XXXPMME,SEV=%G_SEV_XXX#,LAST=YES);
       96     7764
       97     7765        %VLP_ERRCODE (FPTN=EBADFNME,ERR#=%E$BADFNME,SEV=G_SEV_ERROR#,
       98     7766                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
       99     7812
      100     7813        %VLP_ERRCODE (FPTN=EBADCODE,ERR#=%E$BADCODE,SEV=G_SEV_ERROR#,
      101     7814                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      102     7860
      103     7861        %VLP_ERRCODE (FPTN=EMODE,ERR#=%E$MODE,SEV=G_SEV_ERROR#,
      104     7862                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      105     7908
      106     7909        %VLP_ERRCODE (FPTN=EINTLVL,ERR#=%E$INTLVL,SEV=G_SEV_ERROR#,
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:24   
      107     7910                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      108     7956
      109     7957        %VLP_ERRCODE (FPTN=ENOTAUTH,ERR#=%E$NOTAUTH,SEV=G_SEV_ERROR#,
      110     7958                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      111     8004
      112     8005        %VLP_ERRCODE (FPTN=EALTRET,ERR#=%E$ALTRET,SEV=G_SEV_ERROR#,
      113     8006                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      114     8052
      115     8053        %VLP_ERRCODE (FPTN=EXCONLINK,ERR#=%E$XCONLINK,SEV=G_SEV_ERROR#,
      116     8054                      STCLASS=CONSTANT,FCG=GJ,MID=M,MON='1'B);
      117     8100
      118     8101                                                /* External Routines        */
      119     8102    1   DCL GJS$ABORTX ENTRY(1);
      120     8103    1   DCL KNA$WRITE ENTRY(4) ALTRET;
      121     8104    1   DCL KNA$WRITE_NOW ENTRY(4) ALTRET;
      122     8105    1   DCL GJS$STEP ENTRY(1);
      123     8106    1   DCL GJU$XCON ENTRY(2) ALTRET;
      124     8107
      125     8108        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:25   
      126     8109        /*F* NAME: GJM$MCL
      127     8110
      128     8111             PURPOSE:  GJM$MCL is the MCL handler for monitor
      129     8112                       services belonging to the GJ Functional
      130     8113                       Code Group.
      131     8114        */
      132     8115
      133     8116    1      MCL_CODE = GUD_PARAMS.MCL.C.MCL;

   8116   1 000005  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 000007  E806                                 LDR,R6   ,B6
          1 000008  E570 003F                            AND,R6   63,IMO
          1 00000A  EF47 0006                            STR,R6   MCL_CODE,AUTO

      134     8117    1      G$TSA.I.TRAP# = %G_MCL#;

   8117   1 00000C  DCC6 0001                            LDB,B5   1,B6
          1 00000E  5C01                                 LDV,R5   1
          1 00000F  D7C5 0002                            STH,R5   2,B5

      135     8118
      136     8119    2      DO CASE(GUD_PARAMS.MCL.CODE);

   8119   1 000011  B806                                 LDR,R3   ,B6
          1 000012  B570 03FF                            AND,R3   1023,IMO
          1 000014  B970 0087                            CMR,R3   135,IMO
          1 000016  0281 0385                            BGE      s:8403,PREL
          1 000018  A830 0000 001E  01                   LDR,R2   s:8119+13,R3
          1 00001B  83A0 0000 00A5  01                   JMP      s:8130,R2
          1 00001E       0000                            DC       s:8130,PREL
          1 00001F       02F7                            DC       s:8403,PREL
          1 000020       02F7                            DC       s:8403,PREL
          1 000021       02F7                            DC       s:8403,PREL
          1 000022       02F7                            DC       s:8403,PREL
          1 000023       02F7                            DC       s:8403,PREL
          1 000024       02F7                            DC       s:8403,PREL
          1 000025       02F7                            DC       s:8403,PREL
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:26   
          1 000026       02F7                            DC       s:8403,PREL
          1 000027       02F7                            DC       s:8403,PREL
          1 000028       02F7                            DC       s:8403,PREL
          1 000029       02F7                            DC       s:8403,PREL
          1 00002A       02F7                            DC       s:8403,PREL
          1 00002B       02F7                            DC       s:8403,PREL
          1 00002C       02F7                            DC       s:8403,PREL
          1 00002D       02F7                            DC       s:8403,PREL
          1 00002E       02F7                            DC       s:8403,PREL
          1 00002F       02F7                            DC       s:8403,PREL
          1 000030       02F7                            DC       s:8403,PREL
          1 000031       02F7                            DC       s:8403,PREL
          1 000032       02F7                            DC       s:8403,PREL
          1 000033       02F7                            DC       s:8403,PREL
          1 000034       02F7                            DC       s:8403,PREL
          1 000035       02F7                            DC       s:8403,PREL
          1 000036       02F7                            DC       s:8403,PREL
          1 000037       02F7                            DC       s:8403,PREL
          1 000038       02F7                            DC       s:8403,PREL
          1 000039       02F7                            DC       s:8403,PREL
          1 00003A       02F7                            DC       s:8403,PREL
          1 00003B       02F7                            DC       s:8403,PREL
          1 00003C       02F7                            DC       s:8403,PREL
          1 00003D       02F7                            DC       s:8403,PREL
          1 00003E       02F7                            DC       s:8403,PREL
          1 00003F       02F7                            DC       s:8403,PREL
          1 000040       02F7                            DC       s:8403,PREL
          1 000041       02F7                            DC       s:8403,PREL
          1 000042       02F7                            DC       s:8403,PREL
          1 000043       02F7                            DC       s:8403,PREL
          1 000044       02F7                            DC       s:8403,PREL
          1 000045       02F7                            DC       s:8403,PREL
          1 000046       02F7                            DC       s:8403,PREL
          1 000047       02F7                            DC       s:8403,PREL
          1 000048       02F7                            DC       s:8403,PREL
          1 000049       02F7                            DC       s:8403,PREL
          1 00004A       02F7                            DC       s:8403,PREL
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:27   
          1 00004B       02F7                            DC       s:8403,PREL
          1 00004C       02F7                            DC       s:8403,PREL
          1 00004D       02F7                            DC       s:8403,PREL
          1 00004E       02F7                            DC       s:8403,PREL
          1 00004F       02F7                            DC       s:8403,PREL
          1 000050       02F7                            DC       s:8403,PREL
          1 000051       02F7                            DC       s:8403,PREL
          1 000052       02F7                            DC       s:8403,PREL
          1 000053       02F7                            DC       s:8403,PREL
          1 000054       02F7                            DC       s:8403,PREL
          1 000055       02F7                            DC       s:8403,PREL
          1 000056       02F7                            DC       s:8403,PREL
          1 000057       02F7                            DC       s:8403,PREL
          1 000058       02F7                            DC       s:8403,PREL
          1 000059       02F7                            DC       s:8403,PREL
          1 00005A       02F7                            DC       s:8403,PREL
          1 00005B       02F7                            DC       s:8403,PREL
          1 00005C       02F7                            DC       s:8403,PREL
          1 00005D       02F7                            DC       s:8403,PREL
          1 00005E       02F7                            DC       s:8403,PREL
          1 00005F       02F7                            DC       s:8403,PREL
          1 000060       02F7                            DC       s:8403,PREL
          1 000061       02F7                            DC       s:8403,PREL
          1 000062       02F7                            DC       s:8403,PREL
          1 000063       02F7                            DC       s:8403,PREL
          1 000064       02F7                            DC       s:8403,PREL
          1 000065       02F7                            DC       s:8403,PREL
          1 000066       02F7                            DC       s:8403,PREL
          1 000067       02F7                            DC       s:8403,PREL
          1 000068       02F7                            DC       s:8403,PREL
          1 000069       02F7                            DC       s:8403,PREL
          1 00006A       02F7                            DC       s:8403,PREL
          1 00006B       02F7                            DC       s:8403,PREL
          1 00006C       02F7                            DC       s:8403,PREL
          1 00006D       02F7                            DC       s:8403,PREL
          1 00006E       02F7                            DC       s:8403,PREL
          1 00006F       02F7                            DC       s:8403,PREL
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:28   
          1 000070       02F7                            DC       s:8403,PREL
          1 000071       02F7                            DC       s:8403,PREL
          1 000072       02F7                            DC       s:8403,PREL
          1 000073       02F7                            DC       s:8403,PREL
          1 000074       02F7                            DC       s:8403,PREL
          1 000075       02F7                            DC       s:8403,PREL
          1 000076       02F7                            DC       s:8403,PREL
          1 000077       02F7                            DC       s:8403,PREL
          1 000078       02F7                            DC       s:8403,PREL
          1 000079       02F7                            DC       s:8403,PREL
          1 00007A       02F7                            DC       s:8403,PREL
          1 00007B       02F7                            DC       s:8403,PREL
          1 00007C       02F7                            DC       s:8403,PREL
          1 00007D       02F7                            DC       s:8403,PREL
          1 00007E       02F7                            DC       s:8403,PREL
          1 00007F       02F7                            DC       s:8403,PREL
          1 000080       02F7                            DC       s:8403,PREL
          1 000081       02F7                            DC       s:8403,PREL
          1 000082       02F7                            DC       s:8403,PREL
          1 000083       02F7                            DC       s:8403,PREL
          1 000084       02F7                            DC       s:8403,PREL
          1 000085       02F7                            DC       s:8403,PREL
          1 000086       02F7                            DC       s:8403,PREL
          1 000087       02F7                            DC       s:8403,PREL
          1 000088       02F7                            DC       s:8403,PREL
          1 000089       02F7                            DC       s:8403,PREL
          1 00008A       02F7                            DC       s:8403,PREL
          1 00008B       02F7                            DC       s:8403,PREL
          1 00008C       02F7                            DC       s:8403,PREL
          1 00008D       02F7                            DC       s:8403,PREL
          1 00008E       02F7                            DC       s:8403,PREL
          1 00008F       02F7                            DC       s:8403,PREL
          1 000090       02F7                            DC       s:8403,PREL
          1 000091       02F7                            DC       s:8403,PREL
          1 000092       02F7                            DC       s:8403,PREL
          1 000093       02F7                            DC       s:8403,PREL
          1 000094       02F7                            DC       s:8403,PREL
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:29   
          1 000095       02F7                            DC       s:8403,PREL
          1 000096       02F7                            DC       s:8403,PREL
          1 000097       02F7                            DC       s:8403,PREL
          1 000098       02F7                            DC       s:8403,PREL
          1 000099       02F7                            DC       s:8403,PREL
          1 00009A       02F7                            DC       s:8403,PREL
          1 00009B       02F7                            DC       s:8403,PREL
          1 00009C       02F7                            DC       s:8403,PREL
          1 00009D       02F7                            DC       s:8403,PREL
          1 00009E       0002                            DC       s:8148,PREL
          1 00009F       0002                            DC       s:8148,PREL
          1 0000A0       0002                            DC       s:8148,PREL
          1 0000A1       00F9                            DC       s:8240,PREL
          1 0000A2       02F7                            DC       s:8403,PREL
          1 0000A3       02DC                            DC       s:8392,PREL
          1 0000A4       02E3                            DC       s:8396,PREL

      137     8120
      138     8121
      139     8122        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:30   
      140     8123        /*************************************************************
      141     8124         *                                                           *
      142     8125         *               M$TRTN through an M$LDTRC frame             *
      143     8126         *                                                           *
      144     8127         *************************************************************/
      145     8128
      146     8129    2       CASE(0);

      147     8130    2         GOTO FINAL_EXIT;

   8130   1 0000A5  0F81 0091                            B        s:8199,PREL

      148     8131
      149     8132
      150     8133        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:31   
      151     8134        /*************************************************************
      152     8135         *                                                           *
      153     8136         *               M$EXIT   M$ERR   M$XXX                      *
      154     8137         *                                                           *
      155     8138         *************************************************************/
      156     8139
      157     8140        /*F* NAME: M$EXIT M$ERR M$XXX
      158     8141        */
      159     8142    2       CASE(%G_MCL_EXIT#,%G_MCL_ERR#,%G_MCL_XXX#);

      160     8143
      161     8144        /*D* If the user supplied the Step Condition Code setting on
      162     8145             the FPT it is moved to the JIT.  If not the default is
      163     8146             set in the JIT.
      164     8147        */
      165     8148    2         IF GUD_PARAMS.PTRS.PAR2$ ~= ADDR(NIL)

   8148   1 0000A7  8DC6 0008                            CMN      8,B6
          1 0000A9  0901 000E                            BE       s:8154,PREL

      166     8149    3         THEN DO;

      167     8150    3              G$JIT.STEPCC = GUD_PARAMS.PTRS.PAR2$->FPT_EXIT.STEPCC;

   8150   1 0000AB  DCC6 0008                            LDB,B5   8,B6
          1 0000AD  C285                                 LLH,R4   ,B5
          1 0000AE  CC80 0000 0000  xsym                 LDB,B4   G$JIT$
          1 0000B1  C7C4 003F                            STH,R4   63,B4

      168     8151    3              G$JIT.JUNK.SCCSET = '1'B;

   8151   1 0000B3  8944 0098                            LBT,'0002'X       152,B4
   8151   1 0000B5       0002

      169     8152    3              END;

   8152   1 0000B6  0F81 000A                            B        s:8159,PREL
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:32   

      170     8153    3         ELSE DO;

      171     8154    3              G$JIT.STEPCC = STEPCC(MCL_CODE);

   8154   1 0000B8  9856                                 LDR,R1   R6
          1 0000B9  C290 0000 0000  00                   LLH,R4   STEPCC,R1
          1 0000BC  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0000BF  C7C5 003F                            STH,R4   63,B5

      172     8155    3              END;

      173     8156
      174     8157        /*D* The same is done for the error code.
      175     8158        */
      176     8159    2         IF GUD_PARAMS.PTRS.PAR1$ ~= ADDR(NIL)

   8159   1 0000C1  8DC6 0006                            CMN      6,B6
          1 0000C3  0901 0008                            BE       s:8164,PREL

      177     8160    3         THEN DO;

      178     8161    3              GUD_PARAMS.ERR = GUD_PARAMS.PTRS.PAR1$->VLP$ERRCODE;

   8161   1 0000C5  DCC6 0006                            LDB,B5   6,B6
          1 0000C7  8C85                                 LDI      ,B5
          1 0000C8  8D46 0003                            SDI      3,B6

      179     8162    3              END;

   8162   1 0000CA  0F81 000A                            B        s:8170,PREL

      180     8163    3         ELSE DO;

      181     8164    3              T$ = ADDR(JERR);

   8164   1 0000CC  DB80 0000 0005  00                   LAB,B5   JERR
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:33   
          1 0000CF  DFC7 0008                            STB,B5   T$,AUTO

      182     8165    3              GUD_PARAMS.ERR = T$->B$JERR(MCL_CODE);

   8165   1 0000D1  B856                                 LDR,R3   R6
          1 0000D2  8CB5                                 LDI      ,B5,R3
          1 0000D3  8D46 0003                            SDI      3,B6

      183     8166    3              END;

      184     8167
      185     8168        /*D* The run status and error code are set in the JIT.
      186     8169        */
      187     8170    2         G$JIT.RNST = RNST(MCL_CODE);

   8170   1 0000D5  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 0000D8  B847 0006                            LDR,R3   MCL_CODE,AUTO
          1 0000DA  C830 0000 0002  00                   LDR,R4   RNST,R3
          1 0000DD  CF45 0096                            STR,R4   150,B5

      188     8171    2         G$JIT.ERR = GUD_PARAMS.ERR;

   8171   1 0000DF  8CC6 0003                            LDI      3,B6
          1 0000E1  8D45 003C                            SDI      60,B5

      189     8172
      190     8173        /*D* If the user has exit control it is entered now.
      191     8174        */
      192     8175    2         G$TSA.P = G$TSA.P -1;             /*point to the mcl*/

   8175   1 0000E3  CCC6 0001                            LDB,B4   1,B6
          1 0000E5  8CC4 0008                            LDI      8,B4
          1 0000E7  8470 FFFF FFFF                       AID      -1,IMO
          1 0000EA  8D44 0008                            SDI      8,B4

      193     8176    2         G$TSA.Z.IS = 0;              /*so delta doesn't confuse us*/

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:34   
   8176   1 0000EC  CCC6 0001                            LDB,B4   1,B6
          1 0000EE  8844 0005                            LBF,'000F'X       5,B4
          1 0000F0       000F

      194     8177    2         INFO$ = ADDR(NIL);

   8177   1 0000F1  CB80 0000 0000                       LAB,B4   0
          1 0000F4  CFC7 000A                            STB,B4   INFO$,AUTO

      195     8178    2         P#=0;

   8178   1 0000F6  8747 0007                            CL       P#,AUTO

      196     8179    2         CALL GJU$XCON(INFO$,P#)

   8179   1 0000F8  BBC7 0007                            LAB,B3   P#,AUTO
          1 0000FA  BFC7 0038                            STB,B3   CCBUF$+5,AUTO
          1 0000FC  ABC7 000A                            LAB,B2   INFO$,AUTO
          1 0000FE  AFC7 0036                            STB,B2   CCBUF$+3,AUTO
          1 000100  BBC7 0036                            LAB,B3   CCBUF$+3,AUTO
          1 000102  CBF0 0200                            LAB,B4   512,IMO
          1 000104  E380 0000 0000  xent                 LNJ,B6   GJU$XCON
          1 000107       0012                            DC       s:8186,PREL

      197     8180    3         WHENRETURN DO;

      198     8181    3              IF G$JIT.DB# = 0

   8181   1 000108  EC80 0000 0000  xsym                 LDB,B6   G$JIT$
          1 00010B  E2C6 008D                            LLH,R6   141,B6
          1 00010D  6981 0009                            BNEZ,R6  s:8184,PREL

      199     8182    3              THEN G$TSA.P = G$TSA.P +1;

   8182   1 00010F  DCC7 0004                            LDB,B5   @GUD_PARAMS,AUTO
          1 000111  CCC5 0001                            LDB,B4   1,B5
          1 000113  8AC4 0009                            INC      9,B4
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:35   
          1 000115  8EC4 0008                            CAD      8,B4

      200     8183                                 /*this is for post-association of delta*/
      201     8184    3              END;

   8184   1 000117  0F81 000B                            B        s:8195,PREL

      202     8185    3         WHENALTRETURN DO;

      203     8186    3              GUD_PARAMS.ERR = EALTRET;

   8186   1 000119  8C80 0000 0015  00                   LDI      EALTRET
          1 00011C  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 00011E  8D46 0003                            SDI      3,B6

      204     8187    3              RETURN;

   8187   1 000120  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      205     8188    3              END;
      206     8189
      207     8190        /*D* If this is the final exit following exit control for M$LDTRC,
      208     8191             the LDTRC information is moved from the exit conrol frame, the
      209     8192             frame is removed from the TCB stack, and we join up with the
      210     8193             LDTRC with no xcon logic.
      211     8194        */
      212     8195    2         IF G$TCB.CURRSZ ~= 0

   8195   1 000123  DC80 0000 0000  xsym                 LDB,B5   G$TCB$
          1 000126  E845 0005                            LDR,R6   5,B5
          1 000128  6901 005D                            BEZ,R6   s:8221,PREL

      213     8196    3         THEN DO;

      214     8197    3              IF (G$TCB.STK$->G$EXCFR.ECC = %G_XCON#) AND

   8197   1 00012A  CCC5 0002                            LDB,B4   2,B5
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:36   
          1 00012C  D844 0001                            LDR,R5   1,B4
          1 00012E  5D02                                 CMV,R5   2
          1 00012F  0981 0056                            BNE      s:8221,PREL
          1 000131  C844 002A                            LDR,R4   42,B4
          1 000133  C570 0004                            AND,R4   4,IMO
          1 000135  4901 0050                            BEZ,R4   s:8221,PREL

      215     8198    3                (G$TCB.STK$->G$EXCFR.TRLR.RNST & %G_RS_LDTRC#)
      216     8199    4              THEN DO;

   8197   1                              FINAL_EXIT      null
      217     8200    4   FINAL_EXIT:     ;
      218     8201    4                   G$TSA.P$$ = G$TCB.STK$->G$EXCFR.P$$;

   8201   1 000137  ECC7 0004            FINAL_EXIT      LDB,B6   @GUD_PARAMS,AUTO
          1 000139  DCC6 0001                            LDB,B5   1,B6
          1 00013B  CC80 0000 0000  xsym                 LDB,B4   G$TCB$
          1 00013E  BCC4 0002                            LDB,B3   2,B4
          1 000140  ACC3 0004                            LDB,B2   4,B3
          1 000142  AFC5 0008                            STB,B2   8,B5

      219     8202    4                   G$TSA.R3 = G$TCB.STK$->G$EXCFR.REGS.R3;

   8202   1 000144  DCC6 0001                            LDB,B5   1,B6
          1 000146  BCC4 0002                            LDB,B3   2,B4
          1 000148  E843 001A                            LDR,R6   26,B3
          1 00014A  EF45 0003                            STR,R6   3,B5

      220     8203    4                   G$TSA.B3$ = G$TCB.STK$->G$EXCFR.REGS.B3$;

   8203   1 00014C  DCC6 0001                            LDB,B5   1,B6
          1 00014E  BCC4 0002                            LDB,B3   2,B4
          1 000150  ACC3 000F                            LDB,B2   15,B3
          1 000152  AFC5 000A                            STB,B2   10,B5

      221     8204
      222     8205    4                   G$TCB.AVSZ = G$TCB.AVSZ + G$TCB.CURRSZ;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:37   

   8205   1 000154  E844 0004                            LDR,R6   4,B4
          1 000156  EA44 0005                            ADD,R6   5,B4
          1 000158  EF44 0004                            STR,R6   4,B4

      223     8206    4                   G$TCB.CURRSZ = G$TCB.STK$->G$EXCFR.PREVSZ;

   8206   1 00015A  DCC4 0002                            LDB,B5   2,B4
          1 00015C  D805                                 LDR,R5   ,B5
          1 00015D  DF44 0005                            STR,R5   5,B4

      224     8207    4                   IF G$TCB.CURRSZ ~= 0

   8207   1 00015F  5901 000F                            BEZ,R5   s:8210,PREL

      225     8208    4                   THEN G$TCB.STK$ = PINCRW(G$TCB.STK$,-G$TCB.CURRSZ);

   8208   1 000161  B855                                 LDR,R3   R5
          1 000162  DFC7 0036                            STB,B5   CCBUF$+3,AUTO
          1 000164  E853                                 LDR,R6   R3
          1 000165  70F0                                 DAR,R7   16
          1 000166  84C7 0036                            SID      CCBUF$+3,AUTO
          1 000168  8656                                 CPL      R6
          1 000169  8657                                 CPL      R7
          1 00016A  8470 0000 0001                       AID      1,IMO
          1 00016D  8D44 0002                            SDI      2,B4

      226     8209
      227     8210    4                   G$ECCB.FLAGS.XCONP = '0'B;

   8210   1 00016F  DC80 0000 0000  xsym                 LDB,B5   G$U_ECCB$
          1 000172  8845 000A                            LBF,'8000'X       10,B5
          1 000174       8000

      228     8211    4                   G$ECCB.XCON$ = ENTADDR(NIL);

   8211   1 000175  BC80 0000 0000  02                   LDB,B3   0
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:38   
          1 000178  BFC5 0004                            STB,B3   4,B5

      229     8212
      230     8213    4                   G$TSA.I.TRAP# = 0;

   8213   1 00017A  ACC6 0001                            LDB,B2   1,B6
          1 00017C  87C2 0002                            CLH      2,B2

      231     8214    4                   GUD_PARAMS.ERR = EALTRET;

   8214   1 00017E  8C80 0000 0015  00                   LDI      EALTRET
          1 000181  8D46 0003                            SDI      3,B6

      232     8215    4                   RETURN/*reissue M$LDTRC in user land*/;

   8215   1 000183  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      233     8216    4                   END;
      234     8217    3              END;
      235     8218
      236     8219        /*D* Otherwise GJS$ABORTX is called to begin the abort user process.
      237     8220        */
      238     8221    2         CALL GJS$ABORTX(GUD_PARAMS.ERR);

   8221   1 000186  CCC7 0004                            LDB,B4   @GUD_PARAMS,AUTO
          1 000188  BBC4 0003                            LAB,B3   3,B4
          1 00018A  BFC7 0036                            STB,B3   CCBUF$+3,AUTO
          1 00018C  BBC7 0036                            LAB,B3   CCBUF$+3,AUTO
          1 00018E  CBF0 0100                            LAB,B4   256,IMO
          1 000190  E380 0000 0000  xent                 LNJ,B6   GJS$ABORTX
          1 000193       0001                            DC       s:8222,PREL

      239     8222    2         GUD_PARAMS.ERR = EALTRET;

   8222   1 000194  8C80 0000 0015  00                   LDI      EALTRET
          1 000197  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 000199  8D46 0003                            SDI      3,B6
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:39   

      240     8223    2         RETURN;

   8223   1 00019B  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      241     8224
      242     8225        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:40   
      243     8226        /*************************************************************
      244     8227         *                                                           *
      245     8228         *                        M$LDTRC                            *
      246     8229         *                                                           *
      247     8230         *************************************************************/
      248     8231
      249     8232        /*F* NAME: M$LDTRC
      250     8233        */
      251     8234    2       CASE(%G_MCL_LDTRC#);

      252     8235
      253     8236        /*D* If the M$LM DCB is not open it is a handler or a ghost user
      254     8237             and there is no entity on the host to communitcate with,
      255     8238             M$LDTRC requests are therefore not allowed.
      256     8239        */
      257     8240    2         IF NOT G$ROS.M$LM.FCD

   8240   1 00019E  DC80 0000 0000  xsym                 LDB,B5   G$ROS$
          1 0001A1  82C5 0218                            LB,'4000'X        536,B5
          1 0001A3       4000
          1 0001A4  0501 0009                            BBT      s:8251,PREL

      258     8241    3         THEN DO;

      259     8242    3              GUD_PARAMS.ERR = EMODE;

   8242   1 0001A6  8C80 0000 000F  00                   LDI      EMODE
          1 0001A9  8D46 0003                            SDI      3,B6

      260     8243    3              RETURN;

   8243   1 0001AB  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      261     8244    3              END;
      262     8245        /*E* ERROR: GJM-E$MODE-E
      263     8246             MESSAGE:  M$LDTRC not allowed in LCP-6 for handlers and ghosts.
      264     8247        */
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:41   
      265     8248
      266     8249        /*D* Also, M$LDTRC is not allowed unless executing at the user base level.
      267     8250        */
      268     8251    2         IF G$UHJIT.DMN.ID ~= %G_DMN_USR_SVC#

   8251   1 0001AE  CC80 0000 0000  xsym                 LDB,B4   G$UHJIT$
          1 0001B1  C844 007E                            LDR,R4   126,B4
          1 0001B3  4D03                                 CMV,R4   3
          1 0001B4  0901 0009                            BE       s:8263,PREL

      269     8252    3         THEN DO;

      270     8253    3              GUD_PARAMS.ERR = EINTLVL;

   8253   1 0001B6  8C80 0000 0011  00                   LDI      EINTLVL
          1 0001B9  8D46 0003                            SDI      3,B6

      271     8254    3              RETURN;

   8254   1 0001BB  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      272     8255    3              END;
      273     8256        /*E* ERROR: GJM-E$INTLVL-4
      274     8257             MESSAGE: M$LDTRC not allowed from interrupt level.
      275     8258        */
      276     8259
      277     8260        /*D* And M$LDTRC is not allowed if a Class 2 or Class 3 exit control
      278     8261             is in progress.
      279     8262        */
      280     8263    2         IF (G$JIT.FRS & %G_RS_CL23#)

   8263   1 0001BE  BC80 0000 0000  xsym                 LDB,B3   G$JIT$
          1 0001C1  9843 003E                            LDR,R1   62,B3
          1 0001C3  9570 FF00                            AND,R1   -256,IMO
          1 0001C5  1901 0009                            BEZ,R1   s:8273,PREL

      281     8264    3         THEN DO;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:42   

      282     8265    3              G$JIT.ERR = EXCONLINK;

   8265   1 0001C7  8C80 0000 0017  00                   LDI      EXCONLINK
          1 0001CA  8D43 003C                            SDI      60,B3

      283     8266    3              RETURN;

   8266   1 0001CC  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      284     8267    3              END;
      285     8268
      286     8269        /*D* The only other check that can be made initially is the existance
      287     8270             of the run-unit name.  If this fails, the return to the MCL
      288     8271             handler causes an ALTRET to the user's request.
      289     8272        */
      290     8273    2         IF (GUD_PARAMS.PTRS.PAR1$ ->B$NAME.L = 0) OR

   8273   1 0001CF  ACC6 0006                            LDB,B2   6,B6
          1 0001D1  9282                                 LLH,R1   ,B2
          1 0001D2  1901 0010                            BEZ,R1   s:8277,PREL
          1 0001D4  C851                                 LDR,R4   R1
          1 0001D5  9B80 0000 0000  02                   LAB,B1   0
          1 0001D8  0022                                 ACM      ;
          1 0001D9       C002 0000                                ALPHANUM(0,B2,1,R4,FILL),;
          1 0001DB       4101 0002                                ALPHANUM(2,B1,,1,FILL)
          1 0001DD  5381 0005                            CBE      s:8277,PREL
          1 0001DF  9946 0026                            CMR,R1   38,B6
          1 0001E1  0381 0009                            BLE      s:8286,PREL

      291     8274    2           (GUD_PARAMS.PTRS.PAR1$ ->B$NAME.TEXT = ' ') OR
      292     8275    2           (GUD_PARAMS.PTRS.PAR1$ ->B$NAME.L > GUD_PARAMS.BND.PAR1)
      293     8276    3         THEN DO;

      294     8277    3              GUD_PARAMS.ERR = EBADFNME;

   8277   1 0001E3  8C80 0000 000B  00                   LDI      EBADFNME
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:43   
          1 0001E6  8D46 0003                            SDI      3,B6

      295     8278    3              RETURN;

   8278   1 0001E8  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      296     8279    3              END;
      297     8280        /*E* ERROR: GJM-E$BADFNME-E
      298     8281             MESSAGE:  Your M$LDTRC request did not specify a run-unit name.
      299     8282        */
      300     8283
      301     8284        /*D* If the user has exit control it is entered now.
      302     8285        */
      303     8286    2         G$JIT.RNST.LDTRC = '1'B;

   8286   1 0001EB  8943 0096                            LBT,'0004'X       150,B3
   8286   1 0001ED       0004

      304     8287    2         G$TSA.P = G$TSA.P -1;

   8287   1 0001EE  ACC6 0001                            LDB,B2   1,B6
          1 0001F0  8CC2 0008                            LDI      8,B2
          1 0001F2  8470 FFFF FFFF                       AID      -1,IMO
          1 0001F5  8D42 0008                            SDI      8,B2

      305     8288    2         INFO$ = ADDR(NIL);

   8288   1 0001F7  AB80 0000 0000                       LAB,B2   0
          1 0001FA  AFC7 000A                            STB,B2   INFO$,AUTO

      306     8289    2         P# = 0;

   8289   1 0001FC  8747 0007                            CL       P#,AUTO

      307     8290
      308     8291    2         CALL GJU$XCON(INFO$,P#)

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:44   
   8291   1 0001FE  9BC7 0007                            LAB,B1   P#,AUTO
          1 000200  9FC7 0038                            STB,B1   CCBUF$+5,AUTO
          1 000202  EBC7 000A                            LAB,B6   INFO$,AUTO
          1 000204  EFC7 0036                            STB,B6   CCBUF$+3,AUTO
          1 000206  BBC7 0036                            LAB,B3   CCBUF$+3,AUTO
          1 000208  CBF0 0200                            LAB,B4   512,IMO
          1 00020A  E380 0000 0000  xent                 LNJ,B6   GJU$XCON
          1 00020D       000B                            DC       s:8296,PREL

      309     8292    3         WHENRETURN DO;

      310     8293    3              G$TSA.P = G$TSA.P +1;

   8293   1 00020E  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 000210  DCC6 0001                            LDB,B5   1,B6
          1 000212  8AC5 0009                            INC      9,B5
          1 000214  8EC5 0008                            CAD      8,B5

      311     8294    3              END;

   8294   1 000216  0F81 000B                            B        s:8289,PREL

      312     8295    3         WHENALTRETURN DO;

      313     8296    3              GUD_PARAMS.ERR = EALTRET;

   8296   1 000218  8C80 0000 0015  00                   LDI      EALTRET
          1 00021B  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 00021D  8D46 0003                            SDI      3,B6

      314     8297    3              RETURN;

   8297   1 00021F  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

   8289   1                              DO_LDTRC        null
      315     8298    3              END;
      316     8299
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:45   
      317     8300        /* The user's parameters are moved to AUTO.
      318     8301        */
      319     8302    2   DO_LDTRC: ;
      320     8303    2         LDTRC_MSG.NAME = GUD_PARAMS.PTRS.PAR1$ -> B$NAME;

   8303   1 000222  DCC6 0006            DO_LDTRC        LDB,B5   6,B6
          1 000224  E285                                 LLH,R6   ,B5
          1 000225  EF47 0036                            STR,R6   CCBUF$+3,AUTO
          1 000227  DFC7 0037                            STB,B5   CCBUF$+4,AUTO
          1 000229  AB85                                 LAB,B2   ,B5
          1 00022A  2C00                                 LDV,R2   0
          1 00022B  6E01                                 ADV,R6   1
          1 00022C  BB87                                 LAB,B3   ,AUTO
          1 00022D  3C24                                 LDV,R3   36
          1 00022E  7C20                                 LDV,R7   32
          1 00022F  D380 0000 0000  xent                 LNJ,B5   X6C_ALRZ

      321     8304
      322     8305    2         IF GUD_PARAMS.PTRS.PAR2$ = ADDR(NIL)

   8305   1 000232  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 000234  8DC6 0008                            CMN      8,B6
          1 000236  0981 0009                            BNE      s:8307,PREL

      323     8306    2         THEN LDTRC_MSG.ACCT = ' ';

   8306   1 000238  0021                                 ALR      ;
          1 000239       4178 2000                                ALPHANUM('2000'X,IMO,,1),;
          1 00023B       4807 0022                                ALPHANUM(LDTRC_MSG+19,AUTO,,8,FILL)
          1 00023D  437F                                 CSYNC    s:8306+4,SPREL
          1 00023E  0F81 0009                            B        s:8309,PREL

      324     8307    2         ELSE LDTRC_MSG.ACCT = GUD_PARAMS.PTRS.PAR2$ -> B$CHAR8;

   8307   1 000240  DCC6 0008                            LDB,B5   8,B6
          1 000242  AB85                                 LAB,B2   ,B5
          1 000243  2C00                                 LDV,R2   0
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:46   
          1 000244  6C08                                 LDV,R6   8
          1 000245  BB87                                 LAB,B3   ,AUTO
          1 000246  3C44                                 LDV,R3   68
          1 000247  0008                                 MMM

      325     8308
      326     8309    2         IF GUD_PARAMS.PTRS.PAR3$ = ADDR(NIL)

   8309   1 000248  8DC6 000A                            CMN      10,B6
          1 00024A  0981 0009                            BNE      s:8311,PREL

      327     8310    2         THEN LDTRC_MSG.PASS = ' ';

   8310   1 00024C  0021                                 ALR      ;
          1 00024D       4178 2000                                ALPHANUM('2000'X,IMO,,1),;
          1 00024F       4807 0026                                ALPHANUM(LDTRC_MSG+23,AUTO,,8,FILL)
          1 000251  437F                                 CSYNC    s:8310+4,SPREL
          1 000252  0F81 0009                            B        s:8313,PREL

      328     8311    2         ELSE LDTRC_MSG.PASS = GUD_PARAMS.PTRS.PAR3$ -> B$CHAR8;

   8311   1 000254  DCC6 000A                            LDB,B5   10,B6
          1 000256  AB85                                 LAB,B2   ,B5
          1 000257  2C00                                 LDV,R2   0
          1 000258  6C08                                 LDV,R6   8
          1 000259  BB87                                 LAB,B3   ,AUTO
          1 00025A  3C4C                                 LDV,R3   76
          1 00025B  0008                                 MMM

      329     8312
      330     8313    2         IF GUD_PARAMS.PTRS.PAR4$ = ADDR(NIL)

   8313   1 00025C  8DC6 000C                            CMN      12,B6
          1 00025E  0981 0009                            BNE      s:8315,PREL

      331     8314    2         THEN LDTRC_MSG.PSN = ' ';

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:47   
   8314   1 000260  0021                                 ALR      ;
          1 000261       4178 2000                                ALPHANUM('2000'X,IMO,,1),;
          1 000263       4607 002A                                ALPHANUM(LDTRC_MSG+27,AUTO,,6,FILL)
          1 000265  437F                                 CSYNC    s:8314+4,SPREL
          1 000266  0F81 0009                            B        s:8317,PREL

      332     8315    2         ELSE LDTRC_MSG.PSN = GUD_PARAMS.PTRS.PAR4$ -> B$CHAR6;

   8315   1 000268  DCC6 000C                            LDB,B5   12,B6
          1 00026A  AB85                                 LAB,B2   ,B5
          1 00026B  2C00                                 LDV,R2   0
          1 00026C  6C06                                 LDV,R6   6
          1 00026D  BB87                                 LAB,B3   ,AUTO
          1 00026E  3C54                                 LDV,R3   84
          1 00026F  0008                                 MMM

      333     8316
      334     8317    2         IF G$JIT.JUNK2.MICROFPL

   8317   1 000270  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 000273  82C5 0097                            LB,'0001'X        151,B5
          1 000275       0001
          1 000276  0581 0011                            BBF      s:8329,PREL

      335     8318    3         THEN DO;

      336     8319    3              G$JIT.JUNK2.BYPASS_MFPL = '1'B;

   8319   1 000278  8945 0097                            LBT,'0002'X       151,B5
   8319   1 00027A       0002

      337     8320
      338     8321    3              IF GUD_PARAMS.PTRS.PAR6$ ~= ADDR(NIL)

   8321   1 00027B  8DC6 0010                            CMN      16,B6
          1 00027D  0901 000A                            BE       s:8329,PREL

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:48   
      339     8322    3              THEN IF GUD_PARAMS.PTRS.PAR6$->FPT_LDTRC.NO_MICROFPL = '0'B

   8322   1 00027F  CCC6 0010                            LDB,B4   16,B6
          1 000281  8284                                 LB,'0001'X        ,B4
          1 000282       0001
          1 000283  0501 0004                            BBT      s:8329,PREL

      340     8323    3                   THEN LDTRC_MSG.F1 = '1'B;

   8323   1 000285  8947 000F                            LBT,'0080'X       LDTRC_MSG,AUTO
   8323   1 000287       0080

      341     8324    3              END;

      342     8325
      343     8326        /*D* A message is written to interrupt the Host program to tell him
      344     8327             that the current user program has terminated via M$LDTRC.
      345     8328        */
      346     8329    2         REQUEST_MSG_ = VECTOR(REQUEST_MSG);

   8329   1 000288  CBC7 0030                            LAB,B4   REQUEST_MSG,AUTO
          1 00028A  CFC7 0037                            STB,B4   CCBUF$+4,AUTO
          1 00028C  6C05                                 LDV,R6   5
          1 00028D  EF47 0036                            STR,R6   CCBUF$+3,AUTO
          1 00028F  ABC7 0036                            LAB,B2   CCBUF$+3,AUTO
          1 000291  2C00                                 LDV,R2   0
          1 000292  6C06                                 LDV,R6   6
          1 000293  BB87                                 LAB,B3   ,AUTO
          1 000294  3C5A                                 LDV,R3   90
          1 000295  0008                                 MMM

      347     8330    2         REQUEST_MSG.FCN = %GJ_PROG_LDTRC#;

   8330   1 000296  6C08                                 LDV,R6   8
          1 000297  E7C7 0030                            STH,R6   REQUEST_MSG,AUTO

      348     8331    2         CALL KNA$WRITE_NOW(%G_M$LM#,REQUEST_MSG_,GUD_PARAMS.ERR)
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:49   

   8331   1 000299  CBF0 0002                            LAB,B4   2,IMO
          1 00029B  ABC6 0003                            LAB,B2   3,B6
          1 00029D  AFC7 003A                            STB,B2   CCBUF$+7,AUTO
          1 00029F  9BC7 002D                            LAB,B1   REQUEST_MSG_,AUTO
          1 0002A1  9FC7 0038                            STB,B1   CCBUF$+5,AUTO
          1 0002A3  CFC7 0036                            STB,B4   CCBUF$+3,AUTO
          1 0002A5  BBC7 0036                            LAB,B3   CCBUF$+3,AUTO
          1 0002A7  CBF0 0300                            LAB,B4   768,IMO
          1 0002A9  E380 0000 0000  xent                 LNJ,B6   KNA$WRITE_NOW
          1 0002AC       0003                            DC       s:8333,PREL
          1 0002AD  0F81 0004                            B        s:8339,PREL

      349     8332    3         WHENALTRETURN DO;

      350     8333    3              RETURN;

   8333   1 0002AF  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      351     8334    3              END;
      352     8335
      353     8336        /*D* Once in sync, a message is sent to the Host program to convey
      354     8337             the identification of the run-unit requested.
      355     8338        */
      356     8339    2         LDTRC_MSG_ = VECTOR(LDTRC_MSG);

   8339   1 0002B2  EBC7 000F                            LAB,B6   LDTRC_MSG,AUTO
          1 0002B4  EFC7 0037                            STB,B6   CCBUF$+4,AUTO
          1 0002B6  6C3B                                 LDV,R6   59
          1 0002B7  EF47 0036                            STR,R6   CCBUF$+3,AUTO
          1 0002B9  ABC7 0036                            LAB,B2   CCBUF$+3,AUTO
          1 0002BB  2C00                                 LDV,R2   0
          1 0002BC  6C06                                 LDV,R6   6
          1 0002BD  BB87                                 LAB,B3   ,AUTO
          1 0002BE  3C18                                 LDV,R3   24
          1 0002BF  0008                                 MMM

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:50   
      357     8340    2         LDTRC_MSG.FCN = %GJ_LDTRC_FP#;

   8340   1 0002C0  6C09                                 LDV,R6   9
          1 0002C1  E7C7 000F                            STH,R6   LDTRC_MSG,AUTO

      358     8341    2         CALL KNA$WRITE(%G_M$LM#,LDTRC_MSG_,GUD_PARAMS.ERR)

   8341   1 0002C3  EBF0 0002                            LAB,B6   2,IMO
          1 0002C5  DCC7 0004                            LDB,B5   @GUD_PARAMS,AUTO
          1 0002C7  CBC5 0003                            LAB,B4   3,B5
          1 0002C9  CFC7 003A                            STB,B4   CCBUF$+7,AUTO
          1 0002CB  ABC7 000C                            LAB,B2   LDTRC_MSG_,AUTO
          1 0002CD  AFC7 0038                            STB,B2   CCBUF$+5,AUTO
          1 0002CF  EFC7 0036                            STB,B6   CCBUF$+3,AUTO
          1 0002D1  BBC7 0036                            LAB,B3   CCBUF$+3,AUTO
          1 0002D3  CBF0 0300                            LAB,B4   768,IMO
          1 0002D5  E380 0000 0000  xent                 LNJ,B6   KNA$WRITE
          1 0002D8       0003                            DC       s:8343,PREL
          1 0002D9  0F81 0004                            B        s:8350,PREL

      359     8342    3         WHENALTRETURN DO;

      360     8343    3              RETURN;

   8343   1 0002DB  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      361     8344    3              END;
      362     8345
      363     8346        /*D* The fid of the run-unit making the M$LDTRC request is saved
      364     8347             in the JIT.CCBUF so it is available to the called fprg,
      365     8348             or so it may be restored if GJS$STEP altrets.
      366     8349        */
      367     8350    2         CCBUF$ = ADDR(G$JIT.CCBUF);

   8350   1 0002DE  EC80 0000 0000  xsym                 LDB,B6   G$JIT$
          1 0002E1  DBC6 00CE                            LAB,B5   206,B6
          1 0002E3  DFC7 0033                            STB,B5   CCBUF$,AUTO
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:51   

      368     8351    2         GJ_FID.NAME = G$ROS.M$LM.NAME;

   8351   1 0002E5  AC80 0000 0000  xsym                 LDB,B2   G$ROS$
          1 0002E8  ABC2 01FE                            LAB,B2   510,B2
          1 0002EA  2C00                                 LDV,R2   0
          1 0002EB  6C20                                 LDV,R6   32
          1 0002EC  BB85                                 LAB,B3   ,B5
          1 0002ED  3C08                                 LDV,R3   8
          1 0002EE  0008                                 MMM

      369     8352    2         GJ_FID.ACCT# = G$ROS.M$LM.ACCT;

   8352   1 0002EF  AC80 0000 0000  xsym                 LDB,B2   G$ROS$
          1 0002F2  ABC2 020E                            LAB,B2   526,B2
          1 0002F4  2C00                                 LDV,R2   0
          1 0002F5  6C08                                 LDV,R6   8
          1 0002F6  BCC7 0033                            LDB,B3   CCBUF$,AUTO
          1 0002F8  3C28                                 LDV,R3   40
          1 0002F9  0008                                 MMM

      370     8353    2         GJ_FID.PASS# = G$ROS.M$LM.PASS;

   8353   1 0002FA  AC80 0000 0000  xsym                 LDB,B2   G$ROS$
          1 0002FD  ABC2 022D                            LAB,B2   557,B2
          1 0002FF  2C01                                 LDV,R2   1
          1 000300  6C08                                 LDV,R6   8
          1 000301  BCC7 0033                            LDB,B3   CCBUF$,AUTO
          1 000303  3C30                                 LDV,R3   48
          1 000304  0008                                 MMM

      371     8354    2         GJ_FID.PSN# = G$ROS.M$LM.PSN;

   8354   1 000305  AC80 0000 0000  xsym                 LDB,B2   G$ROS$
          1 000308  ABC2 0231                            LAB,B2   561,B2
          1 00030A  2C01                                 LDV,R2   1
          1 00030B  6C06                                 LDV,R6   6
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:52   
          1 00030C  BCC7 0033                            LDB,B3   CCBUF$,AUTO
          1 00030E  3C02                                 LDV,R3   2
          1 00030F  0008                                 MMM

      372     8355    2         GJ_FID.MODTIME = G$ROS.M$LM.MODTIME;

   8355   1 000310  CC80 0000 0000  xsym                 LDB,B4   G$ROS$
          1 000313  8CC4 0235                            LDI      565,B4
          1 000315  BCC7 0033                            LDB,B3   CCBUF$,AUTO
          1 000317  8D43 0022                            SDI      34,B3

      373     8356
      374     8357        /*D* The MLDTRC bit is set in JIT.JUNK and control is transfered to
      375     8358             the GJS$STEP module where the SETFP message will be read and
      376     8359             the run-unit fetched and put into execution.
      377     8360        */
      378     8361    2         IF GUD_PARAMS.PTRS.PAR6$ ~= ADDR(NIL)

   8361   1 000319  ACC7 0004                            LDB,B2   @GUD_PARAMS,AUTO
          1 00031B  8DC2 0010                            CMN      16,B2
          1 00031D  0901 000A                            BE       s:8367,PREL

      379     8362    3         THEN DO;

      380     8363    3              IF GUD_PARAMS.PTRS.PAR6$->FPT_LDTRC.DISP = %G_DISP_KEEP#

   8363   1 00031F  9CC2 0010                            LDB,B1   16,B2
          1 000321  D281                                 LLH,R5   ,B1
          1 000322  5D02                                 CMV,R5   2
          1 000323  0981 0004                            BNE      s:8367,PREL

      381     8364    3              THEN G$JIT.JUNK.KEEP = '1'B;

   8364   1 000325  8946 0098                            LBT,'4000'X       152,B6
   8364   1 000327       4000

      382     8365    3              END;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:53   

      383     8366
      384     8367    2         G$JIT.JUNK.MLDTRC = '1'B;

   8367   1 000328  8946 0098                            LBT,'0001'X       152,B6
   8367   1 00032A       0001

      385     8368    2         CALL GJS$STEP(GUD_PARAMS);

   8368   1 00032B  BBC7 0004                            LAB,B3   @GUD_PARAMS,AUTO
          1 00032D  CBF0 0100                            LAB,B4   256,IMO
          1 00032F  E380 0000 0000  xent                 LNJ,B6   GJS$STEP
          1 000332       0001                            DC       s:8378,PREL

      386     8369
      387     8370        /*D* If GJS$STEP should return it will have set the error code
      388     8371             in GUD_PARAMS.ERR, so we reset G$ROS.M$LM.fid and the MLDTRC bit
      389     8372             in JIT.JUNK and return to the MCL handler to cause an ALTRET
      390     8373             to the user's M$LDTRC request.  Note that GJS$STEP will
      391     8374             error here only if he gets an error on the SETFP message or
      392     8375             if the user program would exceed the user's memory allocation.
      393     8376             The error code will be E$ALTRET if we are to enter the debugger.
      394     8377        */
      395     8378    2         IF (GUD_PARAMS.ERR.ERR# ~= 0) AND (GUD_PARAMS.ERR.ERR# ~= %E$ALTRET)

   8378   1 000333  ECC7 0004                            LDB,B6   @GUD_PARAMS,AUTO
          1 000335  82C6 0004                            LB,'FFF8'X        4,B6
          1 000337       FFF8
          1 000338  0581 003D                            BBF      s:8387,PREL
          1 00033A  E846 0004                            LDR,R6   4,B6
          1 00033C  6043                                 SOR,R6   3
          1 00033D  E970 0192                            CMR,R6   402,IMO
          1 00033F  0901 0036                            BE       s:8387,PREL

      396     8379    3         THEN DO;

      397     8380    3              G$ROS.M$LM.NAME = GJ_FID.NAME;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:54   

   8380   1 000341  ACC7 0033                            LDB,B2   CCBUF$,AUTO
          1 000343  2C08                                 LDV,R2   8
          1 000344  6C20                                 LDV,R6   32
          1 000345  BC80 0000 0000  xsym                 LDB,B3   G$ROS$
          1 000348  BBC3 01FE                            LAB,B3   510,B3
          1 00034A  3C00                                 LDV,R3   0
          1 00034B  0008                                 MMM

      398     8381    3              G$ROS.M$LM.ACCT = GJ_FID.ACCT#;

   8381   1 00034C  ACC7 0033                            LDB,B2   CCBUF$,AUTO
          1 00034E  2C28                                 LDV,R2   40
          1 00034F  6C08                                 LDV,R6   8
          1 000350  BC80 0000 0000  xsym                 LDB,B3   G$ROS$
          1 000353  BBC3 020E                            LAB,B3   526,B3
          1 000355  3C00                                 LDV,R3   0
          1 000356  0008                                 MMM

      399     8382    3              G$ROS.M$LM.PASS = GJ_FID.PASS#;

   8382   1 000357  ACC7 0033                            LDB,B2   CCBUF$,AUTO
          1 000359  2C30                                 LDV,R2   48
          1 00035A  6C08                                 LDV,R6   8
          1 00035B  BC80 0000 0000  xsym                 LDB,B3   G$ROS$
          1 00035E  BBC3 022D                            LAB,B3   557,B3
          1 000360  3C01                                 LDV,R3   1
          1 000361  0008                                 MMM

      400     8383    3              G$ROS.M$LM.PSN = GJ_FID.PSN#;

   8383   1 000362  ACC7 0033                            LDB,B2   CCBUF$,AUTO
          1 000364  2C02                                 LDV,R2   2
          1 000365  6C06                                 LDV,R6   6
          1 000366  BC80 0000 0000  xsym                 LDB,B3   G$ROS$
          1 000369  BBC3 0231                            LAB,B3   561,B3
          1 00036B  3C01                                 LDV,R3   1
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:55   
          1 00036C  0008                                 MMM

      401     8384    3              G$ROS.M$LM.MODTIME = GJ_FID.MODTIME;

   8384   1 00036D  DCC7 0033                            LDB,B5   CCBUF$,AUTO
          1 00036F  8CC5 0022                            LDI      34,B5
          1 000371  CC80 0000 0000  xsym                 LDB,B4   G$ROS$
          1 000374  8D44 0235                            SDI      565,B4

      402     8385    3              END;

      403     8386
      404     8387    2         G$JIT.JUNK.MLDTRC = '0'B;

   8387   1 000376  DC80 0000 0000  xsym                 LDB,B5   G$JIT$
          1 000379  8845 0098                            LBF,'0001'X       152,B5
          1 00037B       0001

      405     8388    2         G$JIT.JUNK.KEEP = '0'B;

   8388   1 00037C  8845 0098                            LBF,'4000'X       152,B5
   8388   1 00037E       4000
          1 00037F  0F81 0021                            B        s:8405,PREL

      406     8389
      407     8390        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:56   
      408     8391    2       CASE(%G_MCL_SCREECH#);

      409     8392    2         GUD_PARAMS.ERR = ENOTAUTH;

   8392   1 000381  8C80 0000 0013  00                   LDI      ENOTAUTH
          1 000384  8D46 0003                            SDI      3,B6
          1 000386  0F81 001A                            B        s:8405,PREL

      410     8393
      411     8394        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:57   
      412     8395    2       CASE(%G_MCL_CPEXIT#);

      413     8396    2         G$ROS.M$LM.DVBYTE.BP = '1'B;

   8396   1 000388  DC80 0000 0000  xsym                 LDB,B5   G$ROS$
          1 00038B  8945 01FB                            LBT,'8000'X       507,B5
          1 00038D       8000

      414     8397
      415     8398    2         IF GUD_PARAMS.PTRS.PAR1$ = ADDR(NIL)

   8398   1 00038E  8DC6 0006                            CMN      6,B6
          1 000390  0981 0010                            BNE      s:8405,PREL

      416     8399    2         THEN CALL GJS$STEP(GUD_PARAMS);

   8399   1 000392  BBC7 0004                            LAB,B3   @GUD_PARAMS,AUTO
          1 000394  CBF0 0100                            LAB,B4   256,IMO
          1 000396  E380 0000 0000  xent                 LNJ,B6   GJS$STEP
          1 000399       0001                            DC       s:8399+8,PREL
          1 00039A  0F81 0006                            B        s:8405,PREL

      417     8400
      418     8401        %EJECT;
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:58   
      419     8402    2       CASE(ELSE);

      420     8403    2         GUD_PARAMS.ERR = EBADCODE;

   8403   1 00039C  8C80 0000 000D  00                   LDI      EBADCODE
          1 00039F  8D46 0003                            SDI      3,B6

      421     8404    2         END/* DO CASE(mcl code)*/;

      422     8405    1   END;

   8405   1 0003A1  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:59   
--  Include file information  --

   UD_ERRORS_C.:E05TOU  is referenced.
   J_ERRORS_C.:E05TOU  is referenced.
   F_ERRORS_C.:E05TOU  is referenced.
   GJ_MSG_M.:E05TOU  is referenced.
   GU_MACROS_M.:E05TOU  is referenced.
   GJ_MACROS_M.:E05TOU  is referenced.
   G_ROS_M.:E05TOU  is referenced.
   G_HJIT_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure GJM$MCL.
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:60   

 **** Variables and constants ****

  ****  Section 000 RoData GJM$MCL

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w STRC(32)    r     1 EALTRET                    D-0-0/w STRC(32)    r     1 EBADCODE
     B-0-0/w STRC(32)    r     1 EBADFNME                  11-0-0/w STRC(32)    r     1 EINTLVL
     F-0-0/w STRC(32)    r     1 EMODE                     13-0-0/w STRC(32)    r     1 ENOTAUTH
    17-0-0/w STRC(32)    r     1 EXCONLINK                  5-0-0/w STRC(96)    r     1 JERR
     2-0-0/b BIT (16)    r     1 RNST(0:2)                  0-0-0/b UBIN(8)     r     1 STEPCC(0:2)

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @GUD_PARAMS               33-0-0/w PTR         r     1 CCBUF$
    *0-0-0/w STRC(1280)  r     1 GUD_PARAMS                 A-0-0/w PTR         r     1 INFO$
     F-0-0/w STRC(480)   r     1 LDTRC_MSG                  C-0-0/w VECT        r     1 LDTRC_MSG_
     6-0-0/w UBIN(16)    r     1 MCL_CODE                   7-0-0/w UBIN(16)    r     1 P#
    30-0-0/w STRC(48)    r     1 REQUEST_MSG               2D-0-0/w VECT        r     1 REQUEST_MSG_
     8-0-0/w PTR         r     1 T$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$JIT$                     0-0-0/w PTR         r     1 G$ROS$
     0-0-0/w PTR         r     1 G$TCB$                     0-0-0/w PTR         r     1 G$UHJIT$
     0-0-0/w PTR         r     1 G$U_ECCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:61   
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)     r     1 B$CHAR6                    0-0-0/c CHAR(8)     r     1 B$CHAR8
     0-0-0/w BIT (32)    r     1 B$JERR(0:2)                0-0-0/c ASTR(8)     r     1 B$NAME
     0-0-0/w STRC(32)    r     1 FPT_EXIT                   0-0-0/w STRC(32)    r     1 FPT_LDTRC
     0-0-0/w STRC(224)   r     1 G$ECCB                     0-0-0/w STRC(736)   r     1 G$EXCFR
     0-0-0/w STRC(5616)  r     1 G$JIT                      0-0-0/w STRC(12000) r     1 G$ROS
     0-0-0/w STRC(96)    r     1 G$TCB                      0-0-0/w STRC(928)   r     1 G$TSA
     0-0-0/w STRC(6480)  r     1 G$UHJIT                    0-0-0/d STRC(576)   r     1 GJ_FID
     0-0-0/w STRC(32)    r     1 VLP$ERRCODE


   Procedure GJM$MCL requires 932 words for executable code.
   Procedure GJM$MCL requires 60 words of local(AUTO) storage.

    No errors detected in file GJM$MCL.:E05TSI    .
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:62   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:63   
          MINI XREF LISTING

B$CHAR6
      2181**DCL      8315>>ASSIGN
B$CHAR8
      2182**DCL      8307>>ASSIGN   8311>>ASSIGN
B$JERR
      7602**DCL      8165>>ASSIGN
B$NAME
      2177**DCL      8303>>ASSIGN
B$NAME.L
      2178**DCL      2179--IMP-SIZ  8273>>IF       8273>>IF       8273>>IF       8303>>ASSIGN
B$NAME.TEXT
      2179**DCL      8273>>IF
CCBUF$
      2174**DCL      2194--IMP-PTR  8350<<ASSIGN   8351>>ASSIGN   8352>>ASSIGN   8353>>ASSIGN   8354>>ASSIGN
      8355>>ASSIGN   8380>>ASSIGN   8381>>ASSIGN   8382>>ASSIGN   8383>>ASSIGN   8384>>ASSIGN
EALTRET
      8020**DCL      8186>>ASSIGN   8214>>ASSIGN   8222>>ASSIGN   8296>>ASSIGN
EBADCODE
      7828**DCL      8403>>ASSIGN
EBADFNME
      7780**DCL      8277>>ASSIGN
EINTLVL
      7924**DCL      8253>>ASSIGN
EMODE
      7876**DCL      8242>>ASSIGN
ENOTAUTH
      7972**DCL      8392>>ASSIGN
EXCONLINK
      8068**DCL      8265>>ASSIGN
FINAL_EXIT
      8197**LABEL    8130--GOTO
FPT_EXIT.STEPCC
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:64   
      7575**DCL      8150>>ASSIGN
FPT_LDTRC.DISP
      7598**DCL      8363>>IF
FPT_LDTRC.NO_MICROFPL
      7598**DCL      8322>>IF
G$ECCB.FLAGS.XCONP
      4005**DCL      8210<<ASSIGN
G$ECCB.FLTFLG
      4023**DCL      4054--REDEF
G$ECCB.XCON$
      4000**DCL      8211<<ASSIGN
G$EXCFR.ECC
      4075**DCL      8197>>IF
G$EXCFR.P$$
      4125**DCL      4125--REDEF    4125--REDEF    8201>>ASSIGN
G$EXCFR.PREVSZ
      4075**DCL      4075--REDEF    8206>>ASSIGN
G$EXCFR.REGS.B3$
      4168**DCL      8203>>ASSIGN
G$EXCFR.REGS.R3
      4194**DCL      8202>>ASSIGN
G$EXCFR.TRLR.EVID
      4362**DCL      4380--REDEF    4388--REDEF    4388--REDEF
G$EXCFR.TRLR.RNST
      4380**DCL      8197>>IF
G$EXCFR.TRLR.SUBC
      4339**DCL      4339--REDEF    4357--REDEF    4361--REDEF    4361--REDEF
G$JIT.CCBUF
      3566**DCL      8350--ASSIGN
G$JIT.DB#
      3352**DCL      8181>>IF
G$JIT.ERR
      3259**DCL      8171<<ASSIGN   8265<<ASSIGN
G$JIT.ERRLOG
      3501**DCL      3504--REDEF
G$JIT.FRS
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:65   
      3310**DCL      8263>>IF
G$JIT.JSUNIT
      3240**DCL      3241--REDEF
G$JIT.JUNK.KEEP
      3491**DCL      8364<<ASSIGN   8388<<ASSIGN
G$JIT.JUNK.MLDTRC
      3500**DCL      8367<<ASSIGN   8387<<ASSIGN
G$JIT.JUNK.SCCSET
      3500**DCL      8151<<ASSIGN
G$JIT.JUNK2.BYPASS_MFPL
      3486**DCL      8319<<ASSIGN
G$JIT.JUNK2.MICROFPL
      3487**DCL      8317>>IF
G$JIT.MCLS
      3239**DCL      3239--REDEF
G$JIT.RNST
      3471**DCL      8170<<ASSIGN
G$JIT.RNST.LDTRC
      3476**DCL      8286<<ASSIGN
G$JIT.STEPCC
      3327**DCL      8150<<ASSIGN   8154<<ASSIGN
G$JIT.TMRZ
      3508**DCL      3509--REDEF
G$JIT.USER_EXTIME
      3232**DCL      3233--REDEF
G$JIT.USER_MEMTIME
      3235**DCL      3235--REDEF
G$JIT.USER_SVTIME
      3234**DCL      3234--REDEF
G$JIT$
      7605**DCL      3171--IMP-PTR  8150>>ASSIGN   8151>>ASSIGN   8154>>ASSIGN   8170>>ASSIGN   8171>>ASSIGN
      8181>>IF       8263>>IF       8265>>ASSIGN   8286>>ASSIGN   8317>>IF       8319>>ASSIGN   8350>>ASSIGN
      8364>>ASSIGN   8367>>ASSIGN   8387>>ASSIGN   8388>>ASSIGN
G$ROS.AUTO_DS$
      2229**DCL      2230--REDEF
G$ROS.AUTO_T$
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:66   
      2230**DCL      2230--REDEF
G$ROS.CP_ECCB.FLTFLG
      2844**DCL      2875--REDEF
G$ROS.DB_ECCB.FLTFLG
      2768**DCL      2799--REDEF
G$ROS.JIT.ERRLOG
      2579**DCL      2582--REDEF
G$ROS.JIT.JSUNIT
      2318**DCL      2319--REDEF
G$ROS.JIT.MCLS
      2317**DCL      2317--REDEF
G$ROS.JIT.TMRZ
      2586**DCL      2587--REDEF
G$ROS.JIT.USER_EXTIME
      2310**DCL      2311--REDEF
G$ROS.JIT.USER_MEMTIME
      2313**DCL      2313--REDEF
G$ROS.JIT.USER_SVTIME
      2312**DCL      2312--REDEF
G$ROS.M$DEBUG.EOMCHAR
      2915**DCL      2915--REDEF    2916--REDEF
G$ROS.M$DEBUG.FLDID
      2914**DCL      2914--REDEF
G$ROS.M$DEBUG.RES
      2909**DCL      2910--REDEF
G$ROS.M$DO.EOMCHAR
      3120**DCL      3120--REDEF    3121--REDEF
G$ROS.M$DO.FLDID
      3119**DCL      3119--REDEF
G$ROS.M$DO.RES
      3114**DCL      3115--REDEF
G$ROS.M$HOST.EOMCHAR
      3069**DCL      3069--REDEF    3070--REDEF
G$ROS.M$HOST.FLDID
      3068**DCL      3068--REDEF
G$ROS.M$HOST.RES
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:67   
      3063**DCL      3064--REDEF
G$ROS.M$LM.ACCT
      2960**DCL      8352>>ASSIGN   8381<<ASSIGN
G$ROS.M$LM.DVBYTE.BP
      2953**DCL      8396<<ASSIGN
G$ROS.M$LM.EOMCHAR
      2966**DCL      2966--REDEF    2967--REDEF
G$ROS.M$LM.FCD
      2962**DCL      8240>>IF
G$ROS.M$LM.FLDID
      2965**DCL      2965--REDEF
G$ROS.M$LM.MODTIME
      2979**DCL      8355>>ASSIGN   8384<<ASSIGN
G$ROS.M$LM.NAME
      2959**DCL      8351>>ASSIGN   8380<<ASSIGN
G$ROS.M$LM.PASS
      2979**DCL      8353>>ASSIGN   8382<<ASSIGN
G$ROS.M$LM.PSN
      2979**DCL      8354>>ASSIGN   8383<<ASSIGN
G$ROS.M$LM.RES
      2960**DCL      2961--REDEF
G$ROS.M$ME.EOMCHAR
      3018**DCL      3018--REDEF    3019--REDEF
G$ROS.M$ME.FLDID
      3017**DCL      3017--REDEF
G$ROS.M$ME.RES
      3012**DCL      3013--REDEF
G$ROS.U_ECCB.FLTFLG
      2692**DCL      2723--REDEF
G$ROS$
      7609**DCL      2220--IMP-PTR  8240>>IF       8351>>ASSIGN   8352>>ASSIGN   8353>>ASSIGN   8354>>ASSIGN
      8355>>ASSIGN   8380>>ASSIGN   8381>>ASSIGN   8382>>ASSIGN   8383>>ASSIGN   8384>>ASSIGN   8396>>ASSIGN
G$TCB.AVSZ
      3977**DCL      8205<<ASSIGN   8205>>ASSIGN
G$TCB.CURRSZ
      3978**DCL      8195>>IF       8205>>ASSIGN   8206<<ASSIGN   8207>>IF       8208>>ASSIGN
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:68   
G$TCB.STK$
      3977**DCL      8197>>IF       8197>>IF       8201>>ASSIGN   8202>>ASSIGN   8203>>ASSIGN   8206>>ASSIGN
      8208<<ASSIGN   8208>>ASSIGN
G$TCB$
      7606**DCL      3973--IMP-PTR  8195>>IF       8197>>IF       8197>>IF       8201>>ASSIGN   8202>>ASSIGN
      8203>>ASSIGN   8205>>ASSIGN   8205>>ASSIGN   8205>>ASSIGN   8206>>ASSIGN   8206>>ASSIGN   8207>>IF
      8208>>ASSIGN   8208>>ASSIGN   8208>>ASSIGN
G$TSA.B3$
      3631**DCL      8203<<ASSIGN
G$TSA.I.TRAP#
      3622**DCL      8117<<ASSIGN   8213<<ASSIGN
G$TSA.ISA.P$$
      3759**DCL      3759--REDEF
G$TSA.P
      3631**DCL      8175<<ASSIGN   8175>>ASSIGN   8182<<ASSIGN   8182>>ASSIGN   8287<<ASSIGN   8287>>ASSIGN
      8293<<ASSIGN   8293>>ASSIGN
G$TSA.P$$
      3630**DCL      3630--REDEF    3631--REDEF    8201<<ASSIGN
G$TSA.R3
      3627**DCL      8202<<ASSIGN
G$TSA.Z.IS
      3629**DCL      8176<<ASSIGN
G$UHJIT.DMN.ID
      6269**DCL      8251>>IF
G$UHJIT.ISA_USR
      5974**DCL      6269--REDEF
G$UHJIT.ISA_USR.P$$
      6049**DCL      6049--REDEF
G$UHJIT.TSA_CP.ISA.P$$
      7256**DCL      7256--REDEF
G$UHJIT.TSA_CP.P$$
      7127**DCL      7127--REDEF    7128--REDEF
G$UHJIT.TSA_DB.ISA.P$$
      6868**DCL      6868--REDEF
G$UHJIT.TSA_DB.P$$
      6739**DCL      6739--REDEF    6740--REDEF
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:69   
G$UHJIT.TSA_RTT.P$$
      7502**DCL      7502--REDEF    7503--REDEF
G$UHJIT.TSA_USR.ISA.P$$
      6458**DCL      6458--REDEF
G$UHJIT.TSA_USR.P$$
      6329**DCL      6329--REDEF    6330--REDEF
G$UHJIT$
      7608**DCL      4551--IMP-PTR  8251>>IF
G$U_ECCB$
      7607**DCL      3994--IMP-PTR  8210>>ASSIGN   8211>>ASSIGN
GJS$ABORTX
      8102**DCL-ENT  8221--CALL
GJS$STEP
      8105**DCL-ENT  8368--CALL     8399--CALL
GJU$XCON
      8106**DCL-ENT  8179--CALL     8291--CALL
GJ_FID.ACCT#
      2200**DCL      8352<<ASSIGN   8381>>ASSIGN
GJ_FID.MODTIME
      2204**DCL      8355<<ASSIGN   8384>>ASSIGN
GJ_FID.NAME
      2199**DCL      8351<<ASSIGN   8380>>ASSIGN
GJ_FID.PASS#
      2201**DCL      8353<<ASSIGN   8382>>ASSIGN
GJ_FID.PSN#
      2199**DCL      8354<<ASSIGN   8383>>ASSIGN
GUD_PARAMS
      1925**DCL         9--PROC     8368<>CALL     8399<>CALL
GUD_PARAMS.BND
      1985**DCL      1986--REDEF
GUD_PARAMS.BND.PAR1
      1985**DCL      8273>>IF
GUD_PARAMS.DESC
      1987**DCL      1988--REDEF
GUD_PARAMS.ERR
      1951**DCL      8161<<ASSIGN   8165<<ASSIGN   8171>>ASSIGN   8186<<ASSIGN   8214<<ASSIGN   8221<>CALL
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:70   
      8222<<ASSIGN   8242<<ASSIGN   8253<<ASSIGN   8277<<ASSIGN   8296<<ASSIGN   8331<>CALL     8341<>CALL
      8392<<ASSIGN   8403<<ASSIGN
GUD_PARAMS.ERR.ERR#
      1978**DCL      8378>>IF       8378>>IF
GUD_PARAMS.MCL.C.MCL
      1932**DCL      8116>>ASSIGN
GUD_PARAMS.MCL.CODE
      1932**DCL      1932--REDEF    8119>>DOCASE
GUD_PARAMS.PTRS
      1981**DCL      1982--REDEF    1984--REDEF    1984--REDEF    1984--REDEF
GUD_PARAMS.PTRS.PAR1$
      1981**DCL      8159>>IF       8161>>ASSIGN   8273>>IF       8273>>IF       8273>>IF       8273>>IF
      8303>>ASSIGN   8303>>ASSIGN   8398>>IF
GUD_PARAMS.PTRS.PAR2$
      1981**DCL      8148>>IF       8150>>ASSIGN   8305>>IF       8307>>ASSIGN
GUD_PARAMS.PTRS.PAR3$
      1981**DCL      8309>>IF       8311>>ASSIGN
GUD_PARAMS.PTRS.PAR4$
      1981**DCL      8313>>IF       8315>>ASSIGN
GUD_PARAMS.PTRS.PAR6$
      1981**DCL      8321>>IF       8322>>IF       8361>>IF       8363>>IF
GUD_PARAMS.TSA$
      1934**DCL      3598--IMP-PTR  8117>>ASSIGN   8175>>ASSIGN   8175>>ASSIGN   8176>>ASSIGN   8182>>ASSIGN
      8182>>ASSIGN   8201>>ASSIGN   8202>>ASSIGN   8203>>ASSIGN   8213>>ASSIGN   8287>>ASSIGN   8287>>ASSIGN
      8293>>ASSIGN   8293>>ASSIGN
INFO$
      2005**DCL      8177<<ASSIGN   8179<>CALL     8288<<ASSIGN   8291<>CALL
JERR
      7622**DCL      8164--ASSIGN
KNA$WRITE
      8103**DCL-ENT  8341--CALL
KNA$WRITE_NOW
      8104**DCL-ENT  8331--CALL
LDTRC_MSG
      2033**DCL      8339--ASSIGN
LDTRC_MSG.ACCT
PL6.E3A0      #001=GJM$MCL File=GJM$MCL.:E05TSI                                  TUE 07/29/97 21:57 Page:71   
      2090**DCL      8306<<ASSIGN   8307<<ASSIGN
LDTRC_MSG.F1
      2037**DCL      8323<<ASSIGN
LDTRC_MSG.FCN
      2033**DCL      8340<<ASSIGN
LDTRC_MSG.NAME
      2090**DCL      8303<<ASSIGN
LDTRC_MSG.PASS
      2090**DCL      8310<<ASSIGN   8311<<ASSIGN
LDTRC_MSG.PSN
      2093**DCL      8314<<ASSIGN   8315<<ASSIGN
LDTRC_MSG_
      2006**DCL      8339<<ASSIGN   8341<>CALL
MCL_CODE
      2002**DCL      8116<<ASSIGN   8154>>ASSIGN   8165>>ASSIGN   8170>>ASSIGN
P#
      2003**DCL      8178<<ASSIGN   8179<>CALL     8289<<ASSIGN   8291<>CALL
REQUEST_MSG
      2117**DCL      8329--ASSIGN
REQUEST_MSG.FCN
      2117**DCL      8330<<ASSIGN
REQUEST_MSG_
      2103**DCL      8329<<ASSIGN   8331<>CALL
RNST
      7617**DCL      8170>>ASSIGN
STEPCC
      7612**DCL      8154>>ASSIGN
T$
      2004**DCL      8164<<ASSIGN   8165>>ASSIGN
VLP$ERRCODE
      7523**DCL      8161>>ASSIGN
