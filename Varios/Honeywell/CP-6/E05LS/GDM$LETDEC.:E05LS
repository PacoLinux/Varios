VERSION E05

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:1    
        1        1        /*M* GDM$LETDEC - This routine builds remote descriptors */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        GDM$LETDEC: PROC(ADR$,ZITEM$,SIZE,OFFSET);
        9        9        /**/
       10       10        %INCLUDE GD_STATIC_DATA;
       11      483        %INCLUDE DD$DITEM;
       12+     586             %LIST;
       13+     587    1        DCL SDD$ PTR;
       14+     588    1        DCL ZITEM$ PTR;
       15+     589    1        DCL SDD_L6$ PTR;
       16+     590    1        DCL ZITEM_L6$ PTR;
       12     1164        %ZITEM_L6(NAME=ZITEM,STCLASS="BASED(ZITEM$)");
       13     1206        %GD$MSG(STCLASS="BASED(MSG$)");
       14     1362        /**/
       15     1363    1   DCL 1 RD BASED DALIGNED,
       16     1364    1         2 C BIT(3) UNAL,
       17     1365    1         2 UC REDEF C,              /* Unpacked redef of C           */
       18     1366    1           3 C1 UBIN(1) UNAL,       /* Byte offset                   */
       19     1367    1           3 C2C3 BIT(2) UNAL,      /* Sign type                     */
       20     1368                       /* '00'B - Unsigned             */
       21     1369                       /* '01'B - Trailing Overpunched */
       22     1370                       /* '10'B - Leading Separate     */
       23     1371                       /* '11'B - Trailing Separate    */
       24     1372    1         2 PC REDEF C,              /* Packed redef of C             */
       25     1373    1           3 C1C2 UBIN(2) UNAL,     /* Nibble offset                 */
       26     1374    1           3 C3 BIT(1) UNAL,        /* Sign type                     */
       27     1375                       /* '0'B - Unsigned              */
       28     1376                       /* '1'B - Trailing Separate     */
       29     1377    1         2 L UBIN(5) UNAL,          /* # of digits  (including sign) */
       30     1378    1         2 T BIT(1) UNAL,
       31     1379                       /* '1'B - Packed                */
       32     1380                       /* '0'B - Unpacked              */
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:2    
       33     1381    1         2 AS UBIN(7) UNAL,         /* Address syllable              */
       34     1382    1         2 DISPLACEMENT BIT(16) UNAL;            /* 0 in LAF mode    */
       35     1383    1   DCL REMOTE_DESC(0:1) BIT(32) DALIGNED;
       36     1384    1   DCL ADR$ PTR;
       37     1385    1   DCL SIZE UBIN;    /* Number of digits */
       38     1386    1   DCL OFFSET UBIN;
       39     1387    1   DCL SCALE SBIN;
       40     1388    1   DCL RD0$ PTR;
       41     1389    1   DCL RD1$ PTR;
       42     1390    1   DCL WORK_AREA CHAR(32) ALIGNED;
       43     1391    1   DCL MSG$ PTR;
       44     1392    1   DCL ZEROS BIT(16) CONSTANT ALIGNED INIT('3030'X);
       45     1393        /**/
       46     1394    1   DCL GDH$DMC ENTRY(2);
       47     1395    1   DCL GDH$LRDB ENTRY(1);
       48     1396        /**/
       49     1397        %EQU B2_REG = 2;
       50     1398        %EQU B5_REG = 5;
       51     1399        %EQU PACKED = 1;
       52     1400        %EQU UNPACKED = 2;
       53     1401        %EQU LEADING = 1;
       54     1402        %EQU TRAILING = 2;
       55     1403        %EQU UNSIGNED = 0;
       56     1404        %EQU OVERPUNCHED = '1'B;
       57     1405        %EQU SEPARATE = '0'B;
       58     1406        /**/
       59     1407        /* Set up a pointer to GD$MSG. */
       60     1408    1           MSG$ = ADDR(GD$DELTA_DATA$->GD_DATA.GDA.RCV);
       61     1409        /* Load the remote descriptor base register (RDBR). */
       62     1410    1           CALL GDH$LRDB(ADDR(REMOTE_DESC));
       63     1411    1           SCALE = GD$MSG.LETMEM_D.VALUE.EXP - ZITEM$->ZITEM.SCALE;
       64     1412    1           RD0$ = ADDR(REMOTE_DESC(0));
       65     1413    1           RD0$->RD = '0'B;
       66     1414    1           RD1$ = ADDR(REMOTE_DESC(1));
       67     1415    1           RD1$->RD = '0'B;
       68     1416    2           IF SCALE < 0 THEN DO;
       69     1417    2              RD0$->RD.L = 31 + SCALE;
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:3    
       70     1418    2              RD1$->RD.L = 31;
       71     1419    2              END /* IF SCALE < 0 */;
       72     1420    2           ELSE DO;
       73     1421    2              RD0$->RD.L = 2;
       74     1422    2              RD0$->RD.AS = %B2_REG;
       75     1423    2              RD1$->RD.L = 31;
       76     1424    2              RD1$->RD.AS = %B5_REG;
       77     1425    2              CALL GDH$DMC(ADDR(ZEROS),ADDR(WORK_AREA));
       78     1426    2              RD0$->RD = '0'B;
       79     1427    2              RD0$->RD.L = 31;
       80     1428    2              RD1$->RD = '0'B;
       81     1429    2              RD1$->RD.L = 31 - SCALE;
       82     1430    2              END /* IF SCALE >= 0 */;
       83     1431    1           RD0$->RD.UC.C1 = 1;
       84     1432    1           RD0$->RD.UC.C2C3 = '10'B;
       85     1433    1           RD0$->RD.AS = %B2_REG;
       86     1434    1           RD1$->RD.UC.C2C3 = '10'B;
       87     1435    1           RD1$->RD.AS = %B5_REG;
       88     1436        /* Note that there is a 1 char offset into .VALUE */
       89     1437    1           CALL GDH$DMC(ADDR(GD$MSG.LETMEM_D.VALUE),ADDR(WORK_AREA));
       90     1438    1           RD0$->RD = RD1$->RD;
       91     1439    1           RD0$->RD.L = 31;
       92     1440    1           RD0$->RD.AS = %B2_REG;
       93     1441    1           RD1$->RD = '0'B;
       94     1442    1           RD1$->RD.AS = %B5_REG;
       95     1443    2           IF ZITEM$->ZITEM.PUP.PUB = %PACKED THEN DO;
       96     1444    2              RD1$->RD.T = '1'B;
       97     1445    2              IF ZITEM$->ZITEM.PUP.SIGNPOS = %TRAILING THEN
       98     1446    2                 RD1$->RD.PC.C3 = '1'B;
       99     1447    2              RD1$->RD.PC.C1C2 = OFFSET / 4;
      100     1448    2              END /* IF PACKED */;
      101     1449    2           ELSE DO;
      102     1450    2              RD1$->RD.UC.C1 = OFFSET / 8;
      103     1451    3              DO CASE(ZITEM$->ZITEM.PUP.SIGNPOS);
      104     1452    3                 CASE(%UNSIGNED);
      105     1453    3                 CASE(%TRAILING);
      106     1454    3                    IF ZITEM$->ZITEM.PUP.SIGNOVER /* OVERPUNCHED */ THEN
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:4    
      107     1455    3                       RD1$->RD.UC.C2C3 = '01'B; /* Trailing Overpunched */
      108     1456    3                    ELSE /* SEPARATE */
      109     1457    3                       RD1$->RD.UC.C2C3 = '11'B; /* Trailing Separate */
      110     1458    3                 CASE(%LEADING);
      111     1459    3                    RD1$->RD.UC.C2C3 = '10'B; /* Leading Separate */
      112     1460    3                 END /* CASE */;
      113     1461    2              END /* UNPACKED */;
      114     1462    1           RD1$->RD.L = SIZE; /* SIZE came in as number of digits */
      115     1463    1           CALL GDH$DMC(ADDR(WORK_AREA),ADR$);
      116     1464        /**/
      117     1465    1           RETURN;
      118     1466        /**/
      119     1467    1   END GDM$LETDEC;

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:5    
--  Include file information  --

   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   GD$MSG_M.:E05TOU  is referenced.
   GDA_EQUS_E.:E05TOU  is referenced.
   GD_EQUS_E.:E05TOU  is referenced.
   GD_DATA_M.:E05TOU  is referenced.
   GD_STATIC_DATA.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure GDM$LETDEC.

   Procedure GDM$LETDEC requires 285 words for executable code.
   Procedure GDM$LETDEC requires 54 words of local(AUTO) storage.

    No errors detected in file GDM$LETDEC.:E05TSI    .

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:6    

 Object Unit name= GDM$LETDEC                                 File name= GDM$LETDEC.:E05TOU
 UTS= JUL 29 '97 21:27:34.96 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS      1      1  GDM$LETDEC
    1   Proc  even  none   285    11D  GDM$LETDEC

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        4  GDM$LETDEC

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 GDH$LRDB
         yes           Std       2 GDH$DMC
                       nStd      0 X6A_AUTO_N
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     GD$DELTA_DATA$                   r    G$ROS$
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:7    


        1        1        /*M* GDM$LETDEC - This routine builds remote descriptors */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /**/
        8        8        GDM$LETDEC: PROC(ADR$,ZITEM$,SIZE,OFFSET);

      8   1 000000  D380 0000 0000  xent GDM$LETDEC      LNJ,B5   X6A_AUTO_N
          1 000003       0036 0004                       DC       54,4

        9        9        /**/
       10       10        %INCLUDE GD_STATIC_DATA;
       11      483        %INCLUDE DD$DITEM;
       12+     586             %LIST;
       13+     587    1        DCL SDD$ PTR;
       14+     588    1        DCL ZITEM$ PTR;
       15+     589    1        DCL SDD_L6$ PTR;
       16+     590    1        DCL ZITEM_L6$ PTR;
       12     1164        %ZITEM_L6(NAME=ZITEM,STCLASS="BASED(ZITEM$)");
       13     1206        %GD$MSG(STCLASS="BASED(MSG$)");
       14     1362        /**/
       15     1363    1   DCL 1 RD BASED DALIGNED,
       16     1364    1         2 C BIT(3) UNAL,
       17     1365    1         2 UC REDEF C,              /* Unpacked redef of C           */
       18     1366    1           3 C1 UBIN(1) UNAL,       /* Byte offset                   */
       19     1367    1           3 C2C3 BIT(2) UNAL,      /* Sign type                     */
       20     1368                       /* '00'B - Unsigned             */
       21     1369                       /* '01'B - Trailing Overpunched */
       22     1370                       /* '10'B - Leading Separate     */
       23     1371                       /* '11'B - Trailing Separate    */
       24     1372    1         2 PC REDEF C,              /* Packed redef of C             */
       25     1373    1           3 C1C2 UBIN(2) UNAL,     /* Nibble offset                 */
       26     1374    1           3 C3 BIT(1) UNAL,        /* Sign type                     */
       27     1375                       /* '0'B - Unsigned              */
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:8    
       28     1376                       /* '1'B - Trailing Separate     */
       29     1377    1         2 L UBIN(5) UNAL,          /* # of digits  (including sign) */
       30     1378    1         2 T BIT(1) UNAL,
       31     1379                       /* '1'B - Packed                */
       32     1380                       /* '0'B - Unpacked              */
       33     1381    1         2 AS UBIN(7) UNAL,         /* Address syllable              */
       34     1382    1         2 DISPLACEMENT BIT(16) UNAL;            /* 0 in LAF mode    */
       35     1383    1   DCL REMOTE_DESC(0:1) BIT(32) DALIGNED;
       36     1384    1   DCL ADR$ PTR;
       37     1385    1   DCL SIZE UBIN;    /* Number of digits */
       38     1386    1   DCL OFFSET UBIN;
       39     1387    1   DCL SCALE SBIN;
       40     1388    1   DCL RD0$ PTR;
       41     1389    1   DCL RD1$ PTR;
       42     1390    1   DCL WORK_AREA CHAR(32) ALIGNED;
       43     1391    1   DCL MSG$ PTR;
       44     1392    1   DCL ZEROS BIT(16) CONSTANT ALIGNED INIT('3030'X);
       45     1393        /**/
       46     1394    1   DCL GDH$DMC ENTRY(2);
       47     1395    1   DCL GDH$LRDB ENTRY(1);
       48     1396        /**/
       49     1397        %EQU B2_REG = 2;
       50     1398        %EQU B5_REG = 5;
       51     1399        %EQU PACKED = 1;
       52     1400        %EQU UNPACKED = 2;
       53     1401        %EQU LEADING = 1;
       54     1402        %EQU TRAILING = 2;
       55     1403        %EQU UNSIGNED = 0;
       56     1404        %EQU OVERPUNCHED = '1'B;
       57     1405        %EQU SEPARATE = '0'B;
       58     1406        /**/
       59     1407        /* Set up a pointer to GD$MSG. */
       60     1408    1           MSG$ = ADDR(GD$DELTA_DATA$->GD_DATA.GDA.RCV);

   1408   1 000005  EC80 0000 0000  xsym                 LDB,B6   GD$DELTA_DATA$
          1 000008  DBC6 000D                            LAB,B5   13,B6
          1 00000A  DFC7 002B                            STB,B5   MSG$,AUTO
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:9    

       61     1409        /* Load the remote descriptor base register (RDBR). */
       62     1410    1           CALL GDH$LRDB(ADDR(REMOTE_DESC));

   1410   1 00000C  CBC7 0012                            LAB,B4   REMOTE_DESC,AUTO
          1 00000E  CFC7 002E                            STB,B4   MSG$+3,AUTO
          1 000010  BBC7 002E                            LAB,B3   MSG$+3,AUTO
          1 000012  BFC7 0030                            STB,B3   MSG$+5,AUTO
          1 000014  BBC7 0030                            LAB,B3   MSG$+5,AUTO
          1 000016  CBF0 0100                            LAB,B4   256,IMO
          1 000018  E380 0000 0000  xent                 LNJ,B6   GDH$LRDB
          1 00001B       0001                            DC       s:1411,PREL

       63     1411    1           SCALE = GD$MSG.LETMEM_D.VALUE.EXP - ZITEM$->ZITEM.SCALE;

   1411   1 00001C  ECC7 0006                            LDB,B6   @ZITEM$,AUTO
          1 00001E  DC86                                 LDB,B5   ,B6
          1 00001F  CCC7 002B                            LDB,B4   MSG$,AUTO
          1 000021  E0C4 0007                            LDH,R6   7,B4
          1 000023  D845 0001                            LDR,R5   1,B5
          1 000025  D570 001F                            AND,R5   31,IMO
          1 000027  E255                                 SUB,R6   R5
          1 000028  EF47 0016                            STR,R6   SCALE,AUTO

       64     1412    1           RD0$ = ADDR(REMOTE_DESC(0));

   1412   1 00002A  BBC7 0012                            LAB,B3   REMOTE_DESC,AUTO
          1 00002C  BFC7 0017                            STB,B3   RD0$,AUTO

       65     1413    1           RD0$->RD = '0'B;

   1413   1 00002E  8703                                 CL       ,B3
          1 00002F  8743 0001                            CL       1,B3

       66     1414    1           RD1$ = ADDR(REMOTE_DESC(1));

   1414   1 000031  DBC7 0014                            LAB,B5   REMOTE_DESC+2,AUTO
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:10   
          1 000033  DFC7 0019                            STB,B5   RD1$,AUTO

       67     1415    1           RD1$->RD = '0'B;

   1415   1 000035  8705                                 CL       ,B5
          1 000036  8745 0001                            CL       1,B5

       68     1416    2           IF SCALE < 0 THEN DO;

   1416   1 000038  6881 0009                            BGEZ,R6  s:1421,PREL

       69     1417    2              RD0$->RD.L = 31 + SCALE;

   1417   1 00003A  6E1F                                 ADV,R6   31
          1 00003B  6008                                 SOL,R6   8
          1 00003C  EA83                                 SRM,R6,'1F00'X    ,B3
          1 00003D       1F00

       70     1418    2              RD1$->RD.L = 31;

   1418   1 00003E  8905                                 LBT,'1F00'X       ,B5
   1418   1 00003F       1F00

       71     1419    2              END /* IF SCALE < 0 */;

   1419   1 000040  0F81 0039                            B        s:1431,PREL

       72     1420    2           ELSE DO;

       73     1421    2              RD0$->RD.L = 2;

   1421   1 000042  D870 0200                            LDR,R5   512,IMO
          1 000044  DA83                                 SRM,R5,'1F00'X    ,B3
          1 000045       1F00

       74     1422    2              RD0$->RD.AS = %B2_REG;

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:11   
   1422   1 000046  4C02                                 LDV,R4   2
          1 000047  CA83                                 SRM,R4,'007F'X    ,B3
          1 000048       007F

       75     1423    2              RD1$->RD.L = 31;

   1423   1 000049  8905                                 LBT,'1F00'X       ,B5
   1423   1 00004A       1F00

       76     1424    2              RD1$->RD.AS = %B5_REG;

   1424   1 00004B  3C05                                 LDV,R3   5
          1 00004C  BA85                                 SRM,R3,'007F'X    ,B5
          1 00004D       007F

       77     1425    2              CALL GDH$DMC(ADDR(ZEROS),ADDR(WORK_AREA));

   1425   1 00004E  AB80 0000 0000  00                   LAB,B2   ZEROS
          1 000051  AFC7 002E                            STB,B2   MSG$+3,AUTO
          1 000053  9BC7 001B                            LAB,B1   WORK_AREA,AUTO
          1 000055  9FC7 0030                            STB,B1   MSG$+5,AUTO
          1 000057  EBC7 0030                            LAB,B6   MSG$+5,AUTO
          1 000059  EFC7 0034                            STB,B6   MSG$+9,AUTO
          1 00005B  EBC7 002E                            LAB,B6   MSG$+3,AUTO
          1 00005D  EFC7 0032                            STB,B6   MSG$+7,AUTO
          1 00005F  BBC7 0032                            LAB,B3   MSG$+7,AUTO
          1 000061  CBF0 0200                            LAB,B4   512,IMO
          1 000063  E380 0000 0000  xent                 LNJ,B6   GDH$DMC
          1 000066       0001                            DC       s:1426,PREL

       78     1426    2              RD0$->RD = '0'B;

   1426   1 000067  ECC7 0017                            LDB,B6   RD0$,AUTO
          1 000069  8706                                 CL       ,B6
          1 00006A  8746 0001                            CL       1,B6

       79     1427    2              RD0$->RD.L = 31;
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:12   

   1427   1 00006C  8906                                 LBT,'1F00'X       ,B6
   1427   1 00006D       1F00

       80     1428    2              RD1$->RD = '0'B;

   1428   1 00006E  DCC7 0019                            LDB,B5   RD1$,AUTO
          1 000070  8705                                 CL       ,B5
          1 000071  8745 0001                            CL       1,B5

       81     1429    2              RD1$->RD.L = 31 - SCALE;

   1429   1 000073  E847 0016                            LDR,R6   SCALE,AUTO
          1 000075  8256                                 NEG      R6
          1 000076  6E1F                                 ADV,R6   31
          1 000077  6008                                 SOL,R6   8
          1 000078  EA85                                 SRM,R6,'1F00'X    ,B5
          1 000079       1F00

       82     1430    2              END /* IF SCALE >= 0 */;

       83     1431    1           RD0$->RD.UC.C1 = 1;

   1431   1 00007A  ECC7 0017                            LDB,B6   RD0$,AUTO
          1 00007C  8906                                 LBT,'8000'X       ,B6
          1 00007D       8000

       84     1432    1           RD0$->RD.UC.C2C3 = '10'B;

   1432   1 00007E  E870 4000                            LDR,R6   16384,IMO
          1 000080  EA86                                 SRM,R6,'6000'X    ,B6
          1 000081       6000

       85     1433    1           RD0$->RD.AS = %B2_REG;

   1433   1 000082  5C02                                 LDV,R5   2
          1 000083  DA86                                 SRM,R5,'007F'X    ,B6
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:13   
          1 000084       007F

       86     1434    1           RD1$->RD.UC.C2C3 = '10'B;

   1434   1 000085  EA85                                 SRM,R6,'6000'X    ,B5
   1434   1 000086       6000

       87     1435    1           RD1$->RD.AS = %B5_REG;

   1435   1 000087  4C05                                 LDV,R4   5
          1 000088  CA85                                 SRM,R4,'007F'X    ,B5
          1 000089       007F

       88     1436        /* Note that there is a 1 char offset into .VALUE */
       89     1437    1           CALL GDH$DMC(ADDR(GD$MSG.LETMEM_D.VALUE),ADDR(WORK_AREA));

   1437   1 00008A  CCC7 002B                            LDB,B4   MSG$,AUTO
          1 00008C  BBC4 0007                            LAB,B3   7,B4
          1 00008E  BFC7 002E                            STB,B3   MSG$+3,AUTO
          1 000090  ABC7 001B                            LAB,B2   WORK_AREA,AUTO
          1 000092  AFC7 0030                            STB,B2   MSG$+5,AUTO
          1 000094  9BC7 0030                            LAB,B1   MSG$+5,AUTO
          1 000096  9FC7 0034                            STB,B1   MSG$+9,AUTO
          1 000098  EBC7 002E                            LAB,B6   MSG$+3,AUTO
          1 00009A  EFC7 0032                            STB,B6   MSG$+7,AUTO
          1 00009C  BBC7 0032                            LAB,B3   MSG$+7,AUTO
          1 00009E  CBF0 0200                            LAB,B4   512,IMO
          1 0000A0  E380 0000 0000  xent                 LNJ,B6   GDH$DMC
          1 0000A3       0001                            DC       s:1438,PREL

       90     1438    1           RD0$->RD = RD1$->RD;

   1438   1 0000A4  ECC7 0019                            LDB,B6   RD1$,AUTO
          1 0000A6  8C86                                 LDI      ,B6
          1 0000A7  DCC7 0017                            LDB,B5   RD0$,AUTO
          1 0000A9  8D05                                 SDI      ,B5

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:14   
       91     1439    1           RD0$->RD.L = 31;

   1439   1 0000AA  8905                                 LBT,'1F00'X       ,B5
   1439   1 0000AB       1F00

       92     1440    1           RD0$->RD.AS = %B2_REG;

   1440   1 0000AC  6C02                                 LDV,R6   2
          1 0000AD  EA85                                 SRM,R6,'007F'X    ,B5
          1 0000AE       007F

       93     1441    1           RD1$->RD = '0'B;

   1441   1 0000AF  8706                                 CL       ,B6
          1 0000B0  8746 0001                            CL       1,B6

       94     1442    1           RD1$->RD.AS = %B5_REG;

   1442   1 0000B2  5C05                                 LDV,R5   5
          1 0000B3  DA86                                 SRM,R5,'007F'X    ,B6
          1 0000B4       007F

       95     1443    2           IF ZITEM$->ZITEM.PUP.PUB = %PACKED THEN DO;

   1443   1 0000B5  CCC7 0006                            LDB,B4   @ZITEM$,AUTO
          1 0000B7  BC84                                 LDB,B3   ,B4
          1 0000B8  C843 0001                            LDR,R4   1,B3
          1 0000BA  404E                                 SOR,R4   14
          1 0000BB  4D01                                 CMV,R4   1
          1 0000BC  0981 0017                            BNE      s:1450,PREL

       96     1444    2              RD1$->RD.T = '1'B;

   1444   1 0000BE  8906                                 LBT,'0080'X       ,B6
   1444   1 0000BF       0080

       97     1445    2              IF ZITEM$->ZITEM.PUP.SIGNPOS = %TRAILING THEN
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:15   

   1445   1 0000C0  BC84                                 LDB,B3   ,B4
          1 0000C1  C843 0001                            LDR,R4   1,B3
          1 0000C3  404C                                 SOR,R4   12
          1 0000C4  C570 0003                            AND,R4   3,IMO
          1 0000C6  4D02                                 CMV,R4   2
          1 0000C7  0981 0003                            BNE      s:1447,PREL

       98     1446    2                 RD1$->RD.PC.C3 = '1'B;

   1446   1 0000C9  8906                                 LBT,'2000'X       ,B6
   1446   1 0000CA       2000

       99     1447    2              RD1$->RD.PC.C1C2 = OFFSET / 4;

   1447   1 0000CB  BCC7 000A                            LDB,B3   @OFFSET,AUTO
          1 0000CD  C803                                 LDR,R4   ,B3
          1 0000CE  4042                                 SOR,R4   2
          1 0000CF  400E                                 SOL,R4   14
          1 0000D0  CA86                                 SRM,R4,'C000'X    ,B6
          1 0000D1       C000

      100     1448    2              END /* IF PACKED */;

   1448   1 0000D2  0F81 002D                            B        s:1462,PREL

      101     1449    2           ELSE DO;

      102     1450    2              RD1$->RD.UC.C1 = OFFSET / 8;

   1450   1 0000D4  ACC7 000A                            LDB,B2   @OFFSET,AUTO
          1 0000D6  B802                                 LDR,R3   ,B2
          1 0000D7  3043                                 SOR,R3   3
          1 0000D8  300F                                 SOL,R3   15
          1 0000D9  BA86                                 SRM,R3,'8000'X    ,B6
          1 0000DA       8000

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:16   
      103     1451    3              DO CASE(ZITEM$->ZITEM.PUP.SIGNPOS);

   1451   1 0000DB  BC84                                 LDB,B3   ,B4
          1 0000DC  B843 0001                            LDR,R3   1,B3
          1 0000DE  304C                                 SOR,R3   12
          1 0000DF  B570 0003                            AND,R3   3,IMO
          1 0000E1  3D03                                 CMV,R3   3
          1 0000E2  0281 001D                            BGE      s:1462,PREL
          1 0000E4  A830 0000 00EA  01                   LDR,R2   s:1451+15,R3
          1 0000E7  83A0 0000 00ED  01                   JMP      s:1454,R2
          1 0000EA       0013                            DC       s:1462,PREL
          1 0000EB       000F                            DC       s:1459,PREL
          1 0000EC       0000                            DC       s:1454,PREL

      104     1452    3                 CASE(%UNSIGNED);

      105     1453    3                 CASE(%TRAILING);

      106     1454    3                    IF ZITEM$->ZITEM.PUP.SIGNOVER /* OVERPUNCHED */ THEN

   1454   1 0000ED  82C3 0001                            LB,'0400'X        1,B3
   1454   1 0000EF       0400
          1 0000F0  0581 0007                            BBF      s:1457,PREL

      107     1455    3                       RD1$->RD.UC.C2C3 = '01'B; /* Trailing Overpunched */

   1455   1 0000F2  C870 2000                            LDR,R4   8192,IMO
          1 0000F4  CA86                                 SRM,R4,'6000'X    ,B6
          1 0000F5       6000
          1 0000F6  0F81 0009                            B        s:1462,PREL

      108     1456    3                    ELSE /* SEPARATE */
      109     1457    3                       RD1$->RD.UC.C2C3 = '11'B; /* Trailing Separate */

   1457   1 0000F8  8906                                 LBT,'6000'X       ,B6
   1457   1 0000F9       6000
          1 0000FA  0F81 0005                            B        s:1462,PREL
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:17   

      110     1458    3                 CASE(%LEADING);

      111     1459    3                    RD1$->RD.UC.C2C3 = '10'B; /* Leading Separate */

   1459   1 0000FC  C870 4000                            LDR,R4   16384,IMO
          1 0000FE  CA86                                 SRM,R4,'6000'X    ,B6
          1 0000FF       6000

      112     1460    3                 END /* CASE */;

      113     1461    2              END /* UNPACKED */;

      114     1462    1           RD1$->RD.L = SIZE; /* SIZE came in as number of digits */

   1462   1 000100  BCC7 0008                            LDB,B3   @SIZE,AUTO
          1 000102  C803                                 LDR,R4   ,B3
          1 000103  4008                                 SOL,R4   8
          1 000104  CA86                                 SRM,R4,'1F00'X    ,B6
          1 000105       1F00

      115     1463    1           CALL GDH$DMC(ADDR(WORK_AREA),ADR$);

   1463   1 000106  ABC7 001B                            LAB,B2   WORK_AREA,AUTO
          1 000108  AFC7 002E                            STB,B2   MSG$+3,AUTO
          1 00010A  9CC7 0004                            LDB,B1   @ADR$,AUTO
          1 00010C  9FC7 0032                            STB,B1   MSG$+7,AUTO
          1 00010E  EBC7 002E                            LAB,B6   MSG$+3,AUTO
          1 000110  EFC7 0030                            STB,B6   MSG$+5,AUTO
          1 000112  BBC7 0030                            LAB,B3   MSG$+5,AUTO
          1 000114  CBF0 0200                            LAB,B4   512,IMO
          1 000116  E380 0000 0000  xent                 LNJ,B6   GDH$DMC
          1 000119       0001                            DC       s:1465,PREL

      116     1464        /**/
      117     1465    1           RETURN;

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:18   
   1465   1 00011A  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
      118     1466        /**/
      119     1467    1   END GDM$LETDEC;

PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:19   
--  Include file information  --

   DD_SRTN_C.:E05TOU  is referenced.
   DD_ACODE_C.:E05TOU  is referenced.
   DD_ICODE_C.:E05TOU  is referenced.
   DD$DITEM.:E05TOU  cannot be made into a system file and is referenced.
   GD$MSG_M.:E05TOU  is referenced.
   GDA_EQUS_E.:E05TOU  is referenced.
   GD_EQUS_E.:E05TOU  is referenced.
   GD_DATA_M.:E05TOU  is referenced.
   GD_STATIC_DATA.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is never referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   KI_CP6.:E05TOU  was found in the system file and is never referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is never referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure GDM$LETDEC.
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:20   

 **** Variables and constants ****

  ****  Section 000 RoData GDM$LETDEC

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w BIT (16)    r     1 ZEROS

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @ADR$                      A-0-0/w PTR         r     1 @OFFSET
     8-0-0/w PTR         r     1 @SIZE                      6-0-0/w PTR         r     1 @ZITEM$
    *0-0-0/w PTR         r     1 ADR$                      2B-0-0/w PTR         r     1 MSG$
    *0-0-0/w UBIN(16)    r     1 OFFSET                    17-0-0/w PTR         r     1 RD0$
    19-0-0/w PTR         r     1 RD1$
    12-0-0/d BIT (32)    r     1 REMOTE_DESC(0:1)
    16-0-0/w SBIN(16)    r     1 SCALE                     *0-0-0/w UBIN(16)    r     1 SIZE
    1B-0-0/w CHAR(32)    r     1 WORK_AREA                 *0-0-0/w PTR         r     1 ZITEM$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 GD$DELTA_DATA$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(3344)  r     1 GD$MSG                     0-0-0/w STRC(16704) r     1 GD_DATA
     0-0-0/d STRC(32)    r     1 RD                         0-0-0/w STRC(64)    r     1 ZITEM
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:21   


   Procedure GDM$LETDEC requires 285 words for executable code.
   Procedure GDM$LETDEC requires 54 words of local(AUTO) storage.

    No errors detected in file GDM$LETDEC.:E05TSI    .
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:22   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:23   
          MINI XREF LISTING

ADR$
      1384**DCL         8--PROC     1463<>CALL
GD$DELTA_DATA$
       436**DCL       450--IMP-PTR  1408>>ASSIGN
GD$MSG.BRKRQS.IF$CONST.SIZE
      1274**DCL      1274--REDEF
GD$MSG.BRKRQS.IF$CONST.TEXT
      1274**DCL      1275--REDEF    1275--REDEF    1276--REDEF    1277--REDEF
GD$MSG.BRKRSP.BRK#
      1288**DCL      1288--REDEF
GD$MSG.BRKRSP.USER#
      1288**DCL      1288--REDEF
GD$MSG.LETMEM_D.VALUE
      1246**DCL      1437--CALL
GD$MSG.LETMEM_D.VALUE.EXP
      1246**DCL      1411>>ASSIGN
GD$MSG.LETMEM_D.VALUE.SIZE
      1246**DCL      1246--REDEF
GD$MSG.LETMEM_D.VALUE.TEXT
      1247**DCL      1247--REDEF    1247--REDEF    1248--REDEF    1249--REDEF
GD$MSG.MESSAGE
      1228**DCL      1228--REDEF    1229--REDEF    1229--REDEF    1230--REDEF    1241--REDEF    1254--REDEF
      1259--REDEF    1266--REDEF    1282--REDEF    1287--REDEF    1293--REDEF    1294--REDEF    1323--REDEF
      1325--REDEF    1336--REDEF    1343--REDEF    1355--REDEF
GD$MSG.SUBFNC
      1223**DCL      1223--REDEF    1227--REDEF
GD$MSG.TSA.I
      1295**DCL      1295--REDEF
GD$MSG.TSA.S
      1297**DCL      1297--REDEF
GD$MSG.USERQS.ASDT$
      1323**DCL      1323--REDEF    1324--REDEF
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:24   
GDH$DMC
      1394**DCL-ENT  1425--CALL     1437--CALL     1463--CALL
GDH$LRDB
      1395**DCL-ENT  1410--CALL
GD_DATA.GD.DYNSP$
       463**DCL       463--REDEF
GD_DATA.GD.STEP_BRKPNT.ADR$
       464**DCL       465--REDEF
GD_DATA.GD.STEP_BRKPNT.START$
       465**DCL       465--REDEF
GD_DATA.GDA.RCV
       452**DCL      1408--ASSIGN
MSG$
      1391**DCL      1223--IMP-PTR  1408<<ASSIGN   1411>>ASSIGN   1437>>CALL
OFFSET
      1386**DCL         8--PROC     1447>>ASSIGN   1450>>ASSIGN
RD
      1363**DCL      1413<<ASSIGN   1415<<ASSIGN   1426<<ASSIGN   1428<<ASSIGN   1438<<ASSIGN   1438>>ASSIGN
      1441<<ASSIGN
RD.AS
      1381**DCL      1422<<ASSIGN   1424<<ASSIGN   1433<<ASSIGN   1435<<ASSIGN   1440<<ASSIGN   1442<<ASSIGN
RD.C
      1364**DCL      1365--REDEF    1372--REDEF
RD.L
      1377**DCL      1417<<ASSIGN   1418<<ASSIGN   1421<<ASSIGN   1423<<ASSIGN   1427<<ASSIGN   1429<<ASSIGN
      1439<<ASSIGN   1462<<ASSIGN
RD.PC.C1C2
      1373**DCL      1447<<ASSIGN
RD.PC.C3
      1374**DCL      1446<<ASSIGN
RD.T
      1378**DCL      1444<<ASSIGN
RD.UC.C1
      1366**DCL      1431<<ASSIGN   1450<<ASSIGN
RD.UC.C2C3
      1367**DCL      1432<<ASSIGN   1434<<ASSIGN   1455<<ASSIGN   1457<<ASSIGN   1459<<ASSIGN
PL6.E3A0      #001=GDM$LETDEC File=GDM$LETDEC.:E05TSI                            TUE 07/29/97 21:27 Page:25   
RD0$
      1388**DCL      1412<<ASSIGN   1413>>ASSIGN   1417>>ASSIGN   1421>>ASSIGN   1422>>ASSIGN   1426>>ASSIGN
      1427>>ASSIGN   1431>>ASSIGN   1432>>ASSIGN   1433>>ASSIGN   1438>>ASSIGN   1439>>ASSIGN   1440>>ASSIGN
RD1$
      1389**DCL      1414<<ASSIGN   1415>>ASSIGN   1418>>ASSIGN   1423>>ASSIGN   1424>>ASSIGN   1428>>ASSIGN
      1429>>ASSIGN   1434>>ASSIGN   1435>>ASSIGN   1438>>ASSIGN   1441>>ASSIGN   1442>>ASSIGN   1444>>ASSIGN
      1446>>ASSIGN   1447>>ASSIGN   1450>>ASSIGN   1455>>ASSIGN   1457>>ASSIGN   1459>>ASSIGN   1462>>ASSIGN
REMOTE_DESC
      1383**DCL      1410--CALL     1412--ASSIGN   1414--ASSIGN
SCALE
      1387**DCL      1411<<ASSIGN   1416>>IF       1417>>ASSIGN   1429>>ASSIGN
SIZE
      1385**DCL         8--PROC     1462>>ASSIGN
WORK_AREA
      1390**DCL      1425--CALL     1437--CALL     1463--CALL
ZEROS
      1392**DCL      1425--CALL
ZITEM.ADDRESS
      1180**DCL      1185--REDEF    1187--REDEF    1192--REDEF    1197--REDEF    1201--REDEF
ZITEM.DATA_TYPE
      1172**DCL      1173--REDEF
ZITEM.PUP.PUB
      1174**DCL      1443>>IF
ZITEM.PUP.SIGNOVER
      1177**DCL      1454>>IF
ZITEM.PUP.SIGNPOS
      1175**DCL      1445>>IF       1451>>DOCASE
ZITEM.SCALE
      1179**DCL      1411>>ASSIGN
ZITEM$
       588**DCL         8--PROC     1166--IMP-PTR  1411>>ASSIGN   1443>>IF       1445>>IF       1451>>DOCASE
      1454>>IF
