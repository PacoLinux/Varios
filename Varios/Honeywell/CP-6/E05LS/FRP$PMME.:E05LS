VERSION E05

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:1    
        1        1        /*M* FRP$PMME Handler for resource management pmmes*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=3,EXM=3,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,NSO,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9           /**/
       10       10           /**/
       11       11        FRP$PMME: PROC (FPTCODE);
       12       12           /**/
       13       13           /**/
       14       14        %INCLUDE FR$RAT;
       15       67        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
       16      107        %INCLUDE FR$RESLIST;
       17      130        %INCLUDE B$JIT_C;
       18      444        %B$JIT0;
       19      533        %U$JIT1X;
       20      536        %M$JIT2;
       21      546        %F$JIT3X;
       22      549        %S$JIT4X;
       23      552        %J$JIT5X;
       24      555        %A$JIT6;
       25      565        %INCLUDE FR_DATA_R;
       26      597        %INCLUDE F$CP6V_C;
       27      823        %INCLUDE JG_GHOSTS_C;
       28      913        %INCLUDE M_INFO_C;
       29     1053        %INCLUDE FM$MACROS;
       30     1428        %FM$SET(BASED="BASED(FM$SET$)");
       31     1433        %FM$VOL(ARY=,BASED="BASED(PRC$)");
       32     1439        %FM$DEV(BASED="BASED(FM$SET$)");
       33     1445        %FM$SETU(BASED="BASED(SETU$)");
       34     1448        %FM$CFUX;
       35     1453        %FM$CFUN;
       36     1456        %FM$CFU;
       37     1462        %INCLUDE NI$TABLES;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:2    
       38     1678        %NI$DCT;
       39     1726        %INCLUDE FR_SUBS;
       40     1794           /**/
       41     1795        %FR$RESLIST (FPTN=RLST);
       42     1807        %FPT$RESCTL_V (FPTN=VRCTL);
       43     1810        %VLP$PSEUDO_V (FPTN=VSU);
       44     1814        %VLP$PRES_V (FPTN=VPR);
       45     1818        %VLP$RPSN_V (FPTN=VPS);
       46     1822        %SUB SHARED#=1/*SHARED*/;
       47     1823           /**/
       48     1824           /**/
       49     1825           /**/
       50     1826    1   DCL FPTCODE UBIN WORD;
       51     1827    1   DCL SYSID SBIN WORD;
       52     1828    1   DCL MODE UBIN WORD;
       53     1829    1   DCL MEMORY SBIN WORD;
       54     1830    1   DCL I SBIN WORD;
       55     1831    1   DCL J SBIN WORD;
       56     1832    1   DCL K SBIN WORD;
       57     1833    1   DCL RCD REDEF K UBIN WORD;
       58     1834    1   DCL MAX SBIN WORD;
       59     1835    1   DCL CURRCORE REDEF MAX SBIN WORD;
       60     1836    1   DCL ARECX UBIN WORD;
       61     1837    1   DCL STRSOP UBIN WORD;
       62     1838    1   DCL SUDO SBIN WORD;
       63     1839    1   DCL RTYP CHAR(2);
       64     1840    1   DCL RNUM CHAR(2);
       65     1841    1   DCL 1 P,
       66     1842    1         2 PSN CHAR(6),
       67     1843    1         2 USAGE UBIN BYTE UNAL,
       68     1844    1         2 DISP UBIN BYTE UNAL;
       69     1845    1   DCL RAT$ PTR;
       70     1846    1   DCL PRM$ REDEF RAT$ PTR;
       71     1847    1   DCL SETU$ REDEF RAT$ PTR;
       72     1848    1   DCL PRC$ PTR;
       73     1849    1   DCL T$ PTR;
       74     1850    1   DCL SUARAY (0:7) UBIN (9) UNAL;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:3    
       75     1851    1   DCL B$JIT$ PTR SYMREF;
       76     1852    1   DCL B$PS0$ PTR SYMREF;
       77     1853    1   DCL B$PS1$ PTR SYMREF;
       78     1854    1   DCL B$PS2$ PTR SYMREF;
       79     1855    1   DCL B$PS3$ PTR SYMREF;
       80     1856    1   DCL FM$SET$ PTR SYMREF;
       81     1857    1   DCL F$CFU$ PTR SYMREF;
       82     1858    1   DCL N$DCT$(0:0)PTR BASED(N$DCT$$);
       83     1859    1   DCL N$DCT$$ PTR SYMREF;
       84     1860    1   DCL IRM_SYSID UBIN SYMREF;
       85     1861    1   DCL FMP$UDLIST ENTRY(2)ALTRET;
       86     1862    1   DCL FMP$ULIST ENTRY(2)ALTRET;
       87     1863    1   DCL FMR$GA ENTRY(2)ALTRET;
       88     1864    1   DCL FMR$L8 ENTRY;
       89     1865    1   DCL FMR$U8 ENTRY;
       90     1866    1   DCL FMR$ZA ENTRY(1);
       91     1867    1   DCL FMS$RELACCT ENTRY(1)ALTRET;
       92     1868    1   DCL HFF$DSIZ ENTRY(2);
       93     1869    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
       94     1870    1   DCL FRZ$DSMT ENTRY(1);
       95     1871    1   DCL FRZ$GETRES ENTRY(5) ALTRET;
       96     1872    1   DCL FRZ$RRESNA ENTRY(2);
       97     1873    1   DCL FRS$OPSTRS ENTRY;
       98     1874    1   DCL FRS$CLSTRS ENTRY;
       99     1875    1   DCL FRS$SUSTRT ENTRY(1);
      100     1876    1   DCL FRS$SUADD ENTRY(1);
      101     1877    1   DCL FRS$SUSUB ENTRY(1);
      102     1878    1   DCL FRS$RESADD ENTRY(1);
      103     1879    1   DCL FRS$RESSUB ENTRY(1);
      104     1880    1   DCL SSS$BLOCK ENTRY;
      105     1881    1   DCL UQB$DELQIDX ENTRY(1)ALTRET;
      106     1882           /**/
      107     1883    1   DCL SC_R2MANY ENTRY CONV(2,0); /* MORE MEMORY OR SUDOS RELEASED THAN EXIST*/
      108     1884    1   DCL SC_NRNDWN ENTRY CONV(2,0); /* RESOURCE STILL OPEN AT FRP$RLALL */
      109     1885           /**/
      110     1886           /**/
      111     1887        %INCLUDE FR_ERRORS_C;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:4    
      112     1918        %INCLUDE UD_ERRORS_C;
      113     1960        %INCLUDE UD_SEV_C;
      114     1974           /**/
      115     1975        %SUB FCG#='0622'O;
      116     1976        %SUB MID#='20'O;
      117     1977        %ERRCODE(NAME=NOMOS,COD#=%E$SUOUT);
      118     1981        %ERRCODE(NAME=NORMRM,COD#=%E$NORMRM);
      119     1985        %ERRCODE(NAME=BSUNM,COD#=%E$BSUNM,SEV#=SEV_CONT#);
      120     1989        %ERRCODE(NAME=BSUNMX,COD#=%E$BSUNM,SEV#=SEV_ABORT#);
      121     1993        %ERRCODE(NAME=NAUTH,COD#=%E$NOTAUTH,SEV#=SEV_ABORT#);
      122     1997        %ERRCODE(NAME=NORQD,COD#=%E$NORQ,SEV#=SEV_ABORT#);
      123     2001        %ERRCODE(NAME=NALRL,COD#=%E$NOTUR);
      124     2005        %ERRCODE(NAME=NRLOP,COD#=%E$NRLOPN);
      125     2009        %ERRCODE(NAME=NOPSN,COD#=%E$NODP);
      126     2013        %ERRCODE(NAME=LESMEM,COD#=%E$LESMEM,SEV#=SEV_CONT#);
      127     2017        %ERRCODE(NAME=NOMEM,COD#=%E$LESMEM);
      128     2021           /**/
      129     2022           /**/
      130     2023        %INCLUDE UD_EQU_E;
      131     2412           /**/
      132     2413           /**/
      133     2414        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:5    
      134     2415    1      STRSOP=0;
      135     2416    1      SYSID=B$JIT.SYSID;
      136     2417    1      MODE=B$JIT.MODE;
      137     2418    2      DO CASE (FPTCODE);
      138     2419    2      CASE (%C$LIMIT#);
      139     2420    2         SUARAY='0'B;
      140     2421    2         MEMORY=0;
      141     2422    2         CALL HFF$NILERASE (1) ALTRET (NOSU);
      142     2423    2         MEMORY=B$PS1$->VSU.MEMORY;
      143     2424    2         CALL SUCKM ALTRET (SUFAIL);
      144     2425    3         DO I=0 TO B$PS1$->VSU.NN-1;
      145     2426    4            DO J=0 TO FR_SUMX;
      146     2427    5               IF B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(J) THEN DO;
      147     2428    5                  SUARAY(J)=B$PS1$->VSU.PSLIST.NUM(I)+SUARAY(J);
      148     2429    5                  CALL SUCHK ALTRET (SUFAIL);
      149     2430    5                  GOTO NXTSU;
      150     2431    5                  END;
      151     2432    4               END;
      152     2433    3            B$JIT.ERR=BSUNM;
      153     2434           /*E*  ERROR:         FRP-E$BSUNM-C
      154     2435                  MESSAGE: The pseudo resource name specified does not exist!
      155     2436                 MESSAGE1: Pseudo resource names are established by the system
      156     2437                           manager at boot time when TIGR is run.  You attempted
      157     2438                           to acquire, release, or require a pseudo resource
      158     2439                           whose name does not appear in that list.
      159     2440                 DESCRIPTION:   In this case the error is reported on an M$LIMIT
      160     2441                                pmme issued by the command processor - probably the
      161     2442                                user put a bad pseudo name on a !LIMIT or
      162     2443                                !RESOURCE command.                                      */
      163     2444    3   SUFAIL:  ;
      164     2445    3            B$PS1$->VSU.FAILX=I;
      165     2446    3            RETURN;
      166     2447    3   NXTSU:   ;
      167     2448    3            END;
      168     2449    2   NOSU: ;
      169     2450    2         CALL FRS$OPSTRS;
      170     2451    2         STRSOP=1;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:6    
      171     2452    2         ARECX=B$JIT.ARECX;
      172     2453    2         CALL ALLOC ALTRET(CSEND);
      173     2454    2         B$JIT.ARECX=ARECX;
      174     2455    2         B$JIT.RESCORE=B$JIT.RESCORE+MEMORY;
      175     2456    2         B$JIT.MAXCORE=B$JIT.RESCORE;
      176     2457    3         IF SUARAY THEN DO;
      177     2458    4            DO I=0 TO FR_SUMX;
      178     2459    4               B$JIT.CURSUDO(I)=B$JIT.CURSUDO(I)+SUARAY(I);
      179     2460    4               END;
      180     2461    3            CALL FRS$SUADD (SUARAY);
      181     2462    3            END;
      182     2463        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:7    
      183     2464    2      CASE (%C$MBS#);
      184     2465    3         IF B$PS0$->VRCTL.MBSDISP THEN DO;
      185     2466    4            IF SYSID~=JG_MBS# THEN DO;
      186     2467    4               CALL HFF$NILERASE (1) ALTRET (MBDZU);
      187     2468    4               B$PS1$->VSU.MEMORY=FR_MEMM(0);
      188     2469    5               DO I=0 TO FR_SUMX;
      189     2470    5                  B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(I);
      190     2471    5                  END;
      191     2472    4               B$PS1$->VSU.NN=FR_SUMX+1;
      192     2473    4   MBDZU:      ;
      193     2474    4               SYSID=-1;
      194     2475    4               CALL DPHYS;
      195     2476    4               CALL DSETSM;
      196     2477    4               END;
      197     2478    4            ELSE DO;
      198     2479    4               CALL HFF$NILERASE (1) ALTRET (MBDZ);
      199     2480    4               IF FR_MEMM(0)-FR_MEMC(0)>=FR_MEMM(%M_BATCH#)-FR_MEMC(%M_BATCH#)
      200     2481    4               THEN MEMORY=FR_MEMM(%M_BATCH#)-FR_MEMC(%M_BATCH#);
      201     2482    4               ELSE MEMORY=FR_MEMM(0)-FR_MEMC(0);
      202     2483    4               IF MEMORY<0 THEN MEMORY=0;
      203     2484    4               B$PS1$->RLST.MEMORY=MEMORY;
      204     2485    4               PRM$=FR_PRM$(%M_BATCH#);
      205     2486    4               PRC$=FR_PRC$(%M_BATCH#);
      206     2487    4               B$PS1$->RLST.DISK=PRM$->FR$PR(FR_DP)-PRC$->FR$PR(FR_DP);
      207     2488    4               B$PS1$->RLST.TAPES=PRM$->FR$PR(FR_MT)-PRC$->FR$PR(FR_MT);
      208     2489    4               B$PS1$->RLST.OTHER=PRM$->FR$PR(FR_NPOOL)-PRC$->FR$PR(FR_NPOOL);
      209     2490    4               PRM$=FR_SUM$(%M_BATCH#);
      210     2491    4               PRC$=FR_SUC$(%M_BATCH#);
      211     2492    5               DO I=0 TO FR_SUMX;
      212     2493    5                  IF FR_SUMT(I)-FR_SUCT(I)>=PRM$->FR$SU(I)-PRC$->FR$SU(I)
      213     2494    5                  THEN SUDO=PRM$->FR$SU(I)-PRC$->FR$SU(I);
      214     2495    5                  ELSE SUDO=FR_SUMT(I)-FR_SUCT(I);
      215     2496    5                  IF SUDO<0 THEN SUDO=0;
      216     2497    5                  B$PS1$->RLST.SULST(I)=SUDO;
      217     2498    5                  END;
      218     2499    4   MBDZ:       ;
      219     2500    4               CALL DPHYSM;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:8    
      220     2501    4               CALL DSETSM;
      221     2502    4               END;
      222     2503    3            END;
      223     2504    3         ELSE DO;
      224     2505    4            IF SYSID~=JG_MBS# THEN DO;
      225     2506    4   NOTAUTH:    ;
      226     2507    4               B$JIT.ERR=NAUTH;
      227     2508           /*E*  ERROR:         FRP-E$NOTAUTH-A
      228     2509                  MESSAGE: M$MBS is not available to user programs!
      229     2510                 DESCRIPTION:   Only SYSTEM GHOSTS and CPs may issue M$MBS and
      230     2511                                except MBS, may only do the display form of the pmme    */
      231     2512    4               RETURN;
      232     2513    4               END;
      233     2514    3            SYSID=B$PS0$->VRCTL.SYSID;
      234     2515    3            MODE=%M_BATCH#;
      235     2516    3            MEMORY=B$PS1$->RLST.MEMORY;
      236     2517    3            CALL SUCKM ALTRET (SUFAIL);
      237     2518    3            SUARAY=B$PS1$->RLST.SULST;
      238     2519    4            DO J=0 TO FR_SUMX;
      239     2520    4               I=J;
      240     2521    4               CALL SUCHK ALTRET (SUFAIL);
      241     2522    4               END;
      242     2523    3            ARECX=1;
      243     2524    3            CALL ALLOC;
      244     2525    3            END;
      245     2526        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:9    
      246     2527    2      CASE (%C$DISPRES#);
      247     2528    2   DISPRES: ;
      248     2529    2         CALL HFF$DSIZ (1,MAX);
      249     2530    2         MAX=MAX-POFFC(ADDR(B$PS1$->VSU.PSLIST),ADDR(B$PS1$->VSU));
      250     2531    2         IF MAX<=0 THEN GOTO DPHY;
      251     2532    2         MAX=MAX/SIZEC(B$PS1$->VSU.PSLIST(0));
      252     2533    2         B$PS1$->VSU.FAILX=0;
      253     2534    3         IF MAX<FR_SUMX+1 THEN DO;
      254     2535    3            B$PS1$->VSU.FAILX=FR_SUMX+1;
      255     2536    3            B$JIT.ERR=NORMRM;
      256     2537           /*E*  ERROR:         FRP-E$NORMRM-E
      257     2538                  MESSAGE: Display area on M$DISPRES too small!
      258     2539                 MESSAGE1: One of the VLPs supplied on M$DISPRES is too small
      259     2540                           to hold all of the users resources.  The area that
      260     2541                           was supplied has been filled in and FAILX indicates
      261     2542                           how many entries were needed in the VLP in error.
      262     2543                 DESCRIPTION:   In this case VLP_PSEUDO was too small.                  */
      263     2544    3            END;
      264     2545    2         ELSE MAX=FR_SUMX+1;
      265     2546    2         B$PS1$->VSU.NN=MAX;
      266     2547    2         B$PS1$->VSU.MEMORY=B$JIT.RESCORE;
      267     2548    3         DO I=0 TO MAX-1;
      268     2549    3            B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(I);
      269     2550    3            B$PS1$->VSU.PSLIST.NUM(I)=B$JIT.CURSUDO(I);
      270     2551    3            END;
      271     2552    2   DPHY: ;
      272     2553    2         CALL DPHYS;
      273     2554    2   DPSN: ;
      274     2555    2         CALL DSETS;
      275     2556        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:10   
      276     2557    2      CASE (%C$REQUIRE#);
      277     2558    3         DO I=0 TO B$PS1$->VSU.NN-1;
      278     2559    4            DO J=0 TO FR_SUMX;
      279     2560    5               IF B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(J) THEN DO;
      280     2561    6                  IF B$JIT.CURSUDO(J)<B$PS1$->VSU.PSLIST.NUM(I) THEN DO;
      281     2562    6                     B$JIT.ERR=NORQD;
      282     2563           /*E*  ERROR:         FRP-E$NORQ-A
      283     2564                  MESSAGE: You do not own required pseudo resources!
      284     2565                 MESSAGE1: The processor you are attempting to run requires that
      285     2566                           its users own certain pseudo resources.  These must
      286     2567                           be acquired via the !RES or !ORES command before the
      287     2568                           processor is invoked.
      288     2569                 DESCRIPTION:   Standard failure for M$REQUIRE pmme.                    */
      289     2570    6                     GOTO SUFAIL;
      290     2571    6                     END;
      291     2572    5                  ELSE GOTO NXTRQD;
      292     2573    5                  END;
      293     2574    4               END;
      294     2575           /*E*  ERROR:         FRP-E$BSUNM-A
      295     2576                 DESCRIPTION:   In this case the severity of this error is abort
      296     2577                                since the calling processor presumably does not want
      297     2578                                to run the users program without the non-existent
      298     2579                                pseudo resource.                                        */
      299     2580    3            B$JIT.ERR=BSUNMX;
      300     2581    3            GOTO SUFAIL;
      301     2582    3   NXTRQD:  ;
      302     2583    3            END;
      303     2584        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:11   
      304     2585    2      CASE (%C$RACST#);
      305     2586    3         IF MODE~=%M_BATCH# THEN DO;
      306     2587    3            B$JIT.ARECX=1;
      307     2588    3            MEMORY=B$JIT.RESCORE;
      308     2589    3            IF MEMORY>FR_MEMM(MODE)-FR_MEMC(MODE)
      309     2590    3            THEN MEMORY=FR_MEMM(MODE)-FR_MEMC(MODE);
      310     2591    3            IF MEMORY>FR_MEMM(0)-FR_MEMC(0)
      311     2592    3            THEN MEMORY=FR_MEMM(0)-FR_MEMC(0);
      312     2593    3            IF MEMORY<0 THEN MEMORY=0;
      313     2594    3            FR_MEMC(MODE)=FR_MEMC(MODE)+MEMORY;
      314     2595    3            FR_MEMC(0)=FR_MEMC(0)+MEMORY;
      315     2596    4            IF MEMORY~=B$JIT.RESCORE THEN DO;
      316     2597    4               B$JIT.RESCORE=MEMORY;
      317     2598    4               B$JIT.ERR=LESMEM;
      318     2599           /*E*  ERROR:         FRP-E$LESMEM-C
      319     2600                 DESCRIPTION:   This error is reported to LOGON when a non-batch
      320     2601                                user's authorized memory is more than is currently
      321     2602                                available.  B$JIT.RESCORE is changed to reflect
      322     2603                                the memory actually allocated.  LOGON should refuse
      323     2604                                to continue if the number is too small.               */
      324     2605    4               END;
      325     2606    3            B$JIT.MAXCORE=B$JIT.RESCORE;
      326     2607    3            CALL FRS$OPSTRS;
      327     2608    3            END;
      328     2609    3         ELSE DO;
      329     2610    3            CALL FRS$OPSTRS;
      330     2611    3            ARECX=1;
      331     2612    4            DO RCD=0 TO FR_NPOOL;
      332     2613    4   NXTRACCK:   ;
      333     2614    4               RAT$=FR$HD$(RCD);
      334     2615    5               DO WHILE (RAT$~=ADDR(NIL));
      335     2616    6                  IF RAT.RES.SISID=SYSID AND RAT.RES.ACTX=0 THEN DO;
      336     2617    6                     RAT.RES.ACTX=ARECX;
      337     2618    6                     CALL FRS$RESADD (RAT);
      338     2619    6                     ARECX=ARECX+1;
      339     2620    6                     GOTO NXTRACCK; /* START OVER, SOMETHING MAYBE MOVED */
      340     2621    6                     END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:12   
      341     2622    5                  RAT$=RAT.LNK$;
      342     2623    5                  END;
      343     2624    4               END;
      344     2625    3            B$JIT.ARECX=ARECX;
      345     2626    3            END;
      346     2627    2         CALL FRS$SUSTRT (B$JIT.CURSUDO);
      347     2628    2         CALL FRS$CLSTRS;
      348     2629        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:13   
      349     2630    2      CASE (%C$RELRES#);
      350     2631    3         IF SYSID~=JG_SLUG# THEN DO;
      351     2632    3            CALL FRS$OPSTRS;
      352     2633    3            STRSOP=1;
      353     2634    3            END;
      354     2635    2         CURRCORE=B$JIT.CURRCORE;
      355     2636    2         IF CURRCORE<%MM_MINMEM# THEN CURRCORE=%MM_MINMEM#;
      356     2637    3         IF B$PS0$->VRCTL.RELALL THEN DO;
      357     2638    3            CALL RELALL;
      358     2639    3            IF B$JIT.ERR.CODE~=0 THEN GOTO DISPRES;
      359     2640    3            END;
      360     2641    3         ELSE DO;
      361     2642    3            CALL HFF$NILERASE (1) ALTRET (RPHYS);
      362     2643    3            MEMORY=B$PS1$->VSU.MEMORY;
      363     2644    4            IF MEMORY>B$JIT.RESCORE-CURRCORE THEN DO;
      364     2645    4               IF MEMORY>B$JIT.RESCORE THEN B$JIT.ERR=NALRL;
      365     2646    4               ELSE B$JIT.ERR=NRLOP;
      366     2647           /*E*  ERROR:         FRP-E$NOTUR-E
      367     2648                  MESSAGE: You tried to free resources you don't own!
      368     2649                 MESSAGE1: One or more of the resources you tried to free did
      369     2650                           not belong to you or you tried to free more than
      370     2651                           you owned.  The resources you did own have been
      371     2652                           freed as requested.
      372     2653                 DESCRIPTION:   This error is reported from various places in
      373     2654                                FRP$PMME.  In this case too much MEMory was freed.      */
      374     2655    4               MEMORY=MAXIMUM(B$JIT.RESCORE-CURRCORE,0);
      375     2656    4               END;
      376     2657    3            B$PS1$->VSU.MEMORY=B$PS1$->VSU.MEMORY-MEMORY;
      377     2658    3            CALL RMEM;
      378     2659    3            SUARAY='0'B;
      379     2660    3            K=0;
      380     2661    4            DO I=0 TO B$PS1$->VSU.NN-1;
      381     2662    5               DO J=0 TO FR_SUMX;
      382     2663    6                  IF B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(J) THEN DO;
      383     2664    6                     SUDO=B$PS1$->VSU.PSLIST.NUM(I)+SUARAY(J);
      384     2665    7                     IF SUDO>B$JIT.CURSUDO(J) THEN DO;
      385     2666    7                        B$PS1$->VSU.PSLIST.NUM(K)=SUDO-B$JIT.CURSUDO(J);
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:14   
      386     2667    7                        SUARAY(J)=B$JIT.CURSUDO(J);
      387     2668    7                        B$JIT.ERR=NALRL;
      388     2669           /*E*  ERROR:         FRP-E$NOTUR-E
      389     2670                 DESCRIPTION:   In this case an attempt to release more than the
      390     2671                                users owned pseudo resources was made                   */
      391     2672    7                        GOTO BADSU;
      392     2673    7                        END;
      393     2674    6                     SUARAY(J)=SUDO;
      394     2675    6                     GOTO NXTSUR;
      395     2676    6                     END;
      396     2677    5                  END;
      397     2678    4               IF B$JIT.ERR.CODE=0 THEN B$JIT.ERR=BSUNM;
      398     2679           /*E*  ERROR:         FRP-E$BSUNM-C
      399     2680                 DESCRIPTION:   In this case, a bad pseudo name was passed on an
      400     2681                                M$RELRES pmme.  This error is only reported if it
      401     2682                                is the most severe error on the M$RELRES.               */
      402     2683    4               B$PS1$->VSU.PSLIST.NUM(K)=B$PS1$->VSU.PSLIST.NUM(I);
      403     2684    4   BADSU:      ;
      404     2685    4               B$PS1$->VSU.PSLIST.PSEUDO(K)=B$PS1$->VSU.PSLIST.PSEUDO(I);
      405     2686    4               K=K+1;
      406     2687    4   NXTSUR:     ;
      407     2688    4               END;
      408     2689    3            CALL RSUDO;
      409     2690    3            B$PS1$->VSU.NN=K;
      410     2691    3   RPHYS:   ;
      411     2692    3            CALL HFF$NILERASE (2) ALTRET (RPSNS);
      412     2693    3            J=0;
      413     2694    4            DO I=0 TO B$PS2$->VPR.NN-1;
      414     2695    4               RTYP=B$PS2$->VPR.PRLIST.RNME.TYP(I);
      415     2696    4               RNUM=B$PS2$->VPR.PRLIST.RNME.NUM(I);
      416     2697    4               IF RTYP='DP' THEN RCD=FR_DP;
      417     2698    5               ELSE IF RTYP='MT' OR RTYP='LT' OR RTYP='FT' THEN DO;
      418     2699    5                     RTYP='MT';
      419     2700    5                     RCD=FR_MT;
      420     2701    5                     END;
      421     2702    4                  ELSE RCD=FR_NPOOL;
      422     2703    4               RAT$=FR$HD$(RCD);
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:15   
      423     2704    5               DO WHILE (RAT$~=ADDR(NIL));
      424     2705    5                  IF RAT.RES.SISID=SYSID AND RAT.TYP=RTYP
      425     2706    6                    AND RAT.RES.NUMB=RNUM THEN DO;
      426     2707    7                     IF RAT.FLG.OPN='0'B THEN DO;
      427     2708    7                        CALL FRS$RESSUB (RAT);
      428     2709    7                        CALL FRZ$RRESNA (RAT,MODE);
      429     2710    7                        GOTO NXTPRR;
      430     2711    7                        END;
      431     2712    7                     ELSE DO;
      432     2713    7                        B$JIT.ERR=NRLOP;
      433     2714           /*E*  ERROR:         FRP-E$NRLOPN-E
      434     2715                  MESSAGE: You tried to release an in use resource!
      435     2716                 MESSAGE1: There is still a DCB open to the physical resource
      436     2717                           you are attempting to release.
      437     2718                 DESCRIPTION:   In this case the user specifically requested the
      438     2719                                release of a physical resource he still had a DCB
      439     2720                                open to.                                                */
      440     2721    7                        GOTO BADPR;
      441     2722    7                        END;
      442     2723    6                     END;
      443     2724    5                  RAT$=RAT.LNK$;
      444     2725    5                  END;
      445     2726    4               IF B$JIT.ERR~=NRLOP THEN B$JIT.ERR=NALRL;
      446     2727           /*E*  ERROR:         FRP-E$NOTUR-E
      447     2728                 DESCRIPTION:   In this case an un-owned physical resource had its
      448     2729                                release requested.  This error is only reported
      449     2730                                if not superseded by E$NRLOPN above.                   */
      450     2731    4   BADPR:      ;
      451     2732    4               B$PS2$->VPR.PRLIST.RNME.TYP(J)=B$PS2$->VPR.PRLIST.RNME.TYP(I);
      452     2733    4               B$PS2$->VPR.PRLIST.RNME.NUM(J)=RNUM;
      453     2734    4               J=J+1;
      454     2735    4   NXTPRR:     ;
      455     2736    4               END;
      456     2737    3            B$PS2$->VPR.NN=J;
      457     2738    3   RPSNS:   ;
      458     2739    3            CALL HFF$NILERASE (3) ALTRET (CSEND);
      459     2740    3            K=0;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:16   
      460     2741    4            DO J=0 TO B$PS3$->VPS.NN-1;
      461     2742    4               P=B$PS3$->VPS.RPLIST(J);
      462     2743    4               CALL FINDSET;
      463     2744    5               IF I=0 THEN DO;
      464     2745    5                  IF B$JIT.ERR.CODE=0 THEN B$JIT.ERR=NALRL;
      465     2746    5   NORELPSN:      ;
      466     2747    5                  B$PS3$->VPS.RPLIST(K)=P;
      467     2748    5                  K=K+1;
      468     2749    5                  CALL FMR$U8;
      469     2750    5                  END;
      470     2751    4               ELSE CALL RELSET ALTRET(NORELPSN);
      471     2752    4               END;
      472     2753    3            B$PS3$->VPS.NN=K;
      473     2754    3            END;
      474     2755    2      END;
      475     2756    1   CSEND:;
      476     2757    1      IF STRSOP~=0 THEN CALL FRS$CLSTRS;
      477     2758    1      RETURN;
      478     2759        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:17   
      479     2760           /**/
      480     2761    1   FRP$RLALL: ENTRY;
      481     2762           /**/
      482     2763    1      CALL SSS$BLOCK;
      483     2764    1      SYSID=B$JIT.SYSID;
      484     2765    1      MODE=B$JIT.MODE;
      485     2766    1      STRSOP=0;
      486     2767    1      CURRCORE=0;
      487     2768    1      CALL RELALL;
      488     2769    1      RETURN;
      489     2770           /*S*  SCREECH_CODE:  FRP-S$NRNDWN
      490     2771                 TYPE:          Snap
      491     2772                 MESSAGE:       Resource released without being closed during logoff
      492     2773                 REMARKS:       When a user is being logged off, FRP$RLALL is called
      493     2774                                to release any resources he may own.  This screech
      494     2775                                occurs when resources are found that are still marked
      495     2776                                open.  This suggests a problem in running down users
      496     2777                                close, or resource management                           */
      497     2778           /**/
      498     2779        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:18   
      499     2780           /**/
      500     2781    1   ALLOC: PROC ALTRET;
      501     2782           /**/
      502     2783    2      CALL HFF$NILERASE (3) ALTRET (PHYALOC);
      503     2784    3      DO J=0 TO B$PS3$->VPS.NN-1;
      504     2785    3         P=B$PS3$->VPS.RPLIST(J);
      505     2786    3         CALL FINDSET;
      506     2787    4         IF I=0 THEN DO;
      507     2788    4            IF P.USAGE=SHARED# THEN GOTO NOGPSN;
      508     2789    4            CALL FMR$GA(SETU$,I)ALTRET(NOGPSN);
      509     2790    4            I=I/SIZEW(FM$SET(0));
      510     2791    4            FM$SET.PSN(I)=P.PSN;
      511     2792    4            FM$SET.XCL(I)='1'B;
      512     2793    4            FM$SET.SYSID(I)=SYSID;
      513     2794    4            FM$SET.ONEU(I)='1'B;
      514     2795    4            FM$SET.SETL(I)=FM$CFUX.SETH;
      515     2796    4            FM$CFUX.SETH=I;
      516     2797    4            CALL FMR$U8;
      517     2798    4            END;
      518     2799    4         ELSE DO;
      519     2800    5            IF P.USAGE=SHARED# THEN DO;
      520     2801    5               IF FM$SET.XCL(I) OR NOT FM$SET.SET(I) THEN GOTO NOGPSN;
      521     2802    5               END;
      522     2803    4            ELSE IF FM$SET.SYSID(I)~=0 AND FM$SET.SYSID(I)~=SYSID
      523     2804    4               THEN GOTO NOGPSN;
      524     2805    4            CALL FMP$ULIST(FM$SET(I),SYSID) ALTRET(NOGPSN);
      525     2806    4            CALL FMR$U8;
      526     2807    4            END;
      527     2808    3         END;
      528     2809    2   PHYALOC:;
      529     2810    2      CALL HFF$NILERASE (2) ALTRET (SUALOC);
      530     2811    3      DO I=0 TO B$PS2$->VPR.NN-1;
      531     2812    3         CALL FRZ$GETRES (B$PS2$->VPR.PRLIST.RNME.TYP(I),B$PS2$->VPR.PRLIST.ATTR(I),
              2812                  SYSID,MODE,T$) ALTRET (NOGET);
      532     2813    3         RAT$=T$;
      533     2814    3         B$PS2$->VPR.PRLIST.RAT$(I)=RAT$;
      534     2815    3         RAT.RES.NUMB=B$PS2$->VPR.PRLIST.RNME.NUM(I);
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:19   
      535     2816    4         IF STRSOP~=0 THEN DO;
      536     2817    4            RAT.RES.RFLG.NOSLD='1'B;
      537     2818    4            RAT.RES.ACTX=ARECX;
      538     2819    4            ARECX=ARECX+1;
      539     2820    4            END;
      540     2821    3         END;
      541     2822    3      IF STRSOP~=0 THEN DO J=0 TO B$PS2$->VPR.NN-1;
      542     2823    3         RAT$=B$PS2$->VPR.PRLIST.RAT$(J);
      543     2824    3         IF RAT.TYP='MT' THEN B$JIT.OLTA='0'B;
      544     2825    3         CALL FRS$RESADD (RAT);
      545     2826    3         RAT.RES.RFLG.NOSLD='0'B;
      546     2827    3         END;
      547     2828    2   SUALOC:;
      548     2829    2      FR_MEMC(MODE)=FR_MEMC(MODE)+MEMORY;
      549     2830    2      FR_MEMC(0)=FR_MEMC(0)+MEMORY;
      550     2831    3      IF SUARAY THEN DO I=0 TO FR_SUMX;
      551     2832    3         FR_SUC$(MODE)->FR$SU(I)=FR_SUC$(MODE)->FR$SU(I)+SUARAY(I);
      552     2833    3         FR_SUCT(I)=FR_SUCT(I)+SUARAY(I);
      553     2834    3         END;
      554     2835    2      RETURN;
      555     2836    2   NOGET:;
      556     2837    2      B$PS2$->VPR.FAILX=I;
      557     2838    3      DO J=0 TO I-1;
      558     2839    3         CALL FRZ$RRESNA (B$PS2$->VPR.PRLIST.RAT$(J)->RAT,MODE);
      559     2840    3         END;
      560     2841    2      CALL HFF$NILERASE (3) ALTRET (ALLOCX);
      561     2842    2      J=B$PS3$->VPS.NN;
      562     2843    2      CALL FMR$L8;
      563     2844    2   NOGPSN:;
      564     2845    2      B$PS3$->VPS.FAILX=J;
      565     2846    2      IF J~=B$PS3$->VPS.NN THEN B$JIT.ERR=NOPSN;
      566     2847           /*E*  ERROR:         FRP-E$NODP-E
      567     2848                  MESSAGE: Packset usage incompatible with request.
      568     2849                 MESSAGE1: The packset request at VLP_RPSN.FAILX wants exclusive and
      569     2850                           the set is in use, or wants shared and it isn't.
      570     2851                 DESCRIPTION:   The request cannot be satisfied until something changes.*/
      571     2852    3      DO J=0 TO B$PS3$->VPS.FAILX-1;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:20   
      572     2853    3         P=B$PS3$->VPS.RPLIST(J);
      573     2854    3         CALL FINDSET;
      574     2855    3         IF I~=0 THEN CALL FMP$UDLIST(FM$SET(I),SYSID);
      575     2856    3         END;
      576     2857    2      CALL FMR$U8;
      577     2858    2   ALLOCX:;
      578     2859    2      ALTRETURN;
      579     2860    2   END;
      580     2861           /**/
      581     2862        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:21   
      582     2863           /**/
      583     2864    1   SUCHK: PROC ALTRET;
      584     2865           /**/
      585     2866    2      IF SUARAY(J)=0
      586     2867    2        OR SUARAY(J)<=FR_SUMT(J)-FR_SUCT(J)
      587     2868    2        AND SUARAY(J)<=FR_SUM$(MODE)->FR$SU(J)-FR_SUC$(MODE)->FR$SU(J)
      588     2869    2      THEN RETURN;
      589     2870    2   SUF: ;
      590     2871    2      B$JIT.ERR=NOMOS;
      591     2872           /*E*  ERROR:         FRP-E$SUOUT-E
      592     2873                  MESSAGE: The pseudo resources you requested are not available.
      593     2874                 MESSAGE1: Granting your request for pseudo resources would
      594     2875                           cause the total in use on the system or the total
      595     2876                           in use for your mode (e.g. online) to exceed the maximum.
      596     2877                 MESSAGE2: The system manager sets maxima for the number
      597     2878                           of each pseudo resource that can be allocated
      598     2879                           and for the number that any mode can own.  Your
      599     2880                           request would exceed one or both of these.  If
      600     2881                           you are not requesting more than is legal, try
      601     2882                           again later after someone has released enough.
      602     2883                 DESCRIPTION:   He wants more than he can have now.                     */
      603     2884    2      ALTRETURN;
      604     2885           /**/
      605     2886    2   SUCKM: ENTRY ALTRET;
      606     2887           /**/
      607     2888    2      IF MEMORY<=FR_MEMM(0)-FR_MEMC(0)
      608     2889    2        AND MEMORY<=FR_MEMM(MODE)-FR_MEMC(MODE) THEN RETURN;
      609     2890    2      I=-1;
      610     2891    2      B$JIT.ERR=NOMEM;
      611     2892           /*E*  ERROR:         FRP-E$LESMEM-E
      612     2893                  MESSAGE: The memory you requested is not available.
      613     2894                 MESSAGE1: The system maximum or the maximum for your mode
      614     2895                           would be exceeded by your request for more memory.         */
      615     2896    2      ALTRETURN;
      616     2897    2   END;
      617     2898           /**/
      618     2899        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:22   
      619     2900           /**/
      620     2901    1   DPHYSM: PROC;
      621     2902           /**/
      622     2903    2      SYSID=0;
      623     2904           /**/
      624     2905    2   DPHYS: ENTRY;
      625     2906           /**/
      626     2907    2      CALL HFF$DSIZ (2,MAX);
      627     2908    2      MAX=MAX-POFFC(ADDR(B$PS2$->VPR.PRLIST),ADDR(B$PS2$->VPR));
      628     2909    2      IF MAX<=0 THEN RETURN;
      629     2910    2      MAX=MAX/SIZEC(B$PS2$->VPR.PRLIST(0));
      630     2911    2      B$PS2$->VPR.FAILX=0;
      631     2912    2      B$PS2$->VPR.NN=MAX;
      632     2913    2      I=0;
      633     2914    3      DO RCD=0 TO FR_NPOOL;
      634     2915    3         RAT$=FR$HD$(RCD);
      635     2916    4         DO WHILE (RAT$~=ADDR(NIL));
      636     2917    5            IF SYSID<0 OR RAT.RES.SISID=SYSID THEN DO;
      637     2918    6               IF I>=MAX THEN DO;
      638     2919    6                  B$PS2$->VPR.FAILX=I+1;
      639     2920    6                  B$JIT.ERR=NORMRM;
      640     2921           /*E*  ERROR:         FRP-E$NORMRM-E
      641     2922                 DESCRIPTION:   In this case the users physical resources won't fit.     */
      642     2923    6                  GOTO DPHYS1;
      643     2924    6                  END;
      644     2925    5               B$PS2$->VPR.PRLIST.RNME.TYP(I)=RAT.TYP;
      645     2926    6               IF SYSID<=0 THEN DO;
      646     2927    6                  IF RAT.FLG.DOWN AND SYSID=0 THEN I=I-1;
      647     2928    6                  ELSE B$PS2$->VPR.PRLIST.ATTR(I)=RAT.M1;
      648     2929    6                  END;
      649     2930    6               ELSE DO;
      650     2931    6                  B$PS2$->VPR.PRLIST.RNME.NUM(I)=RAT.RES.NUMB;
      651     2932    6                  B$PS2$->VPR.PRLIST.ATTR(I)=RAT.RES.M2;
      652     2933    6                  END;
      653     2934    5   DPHYS1:     ;
      654     2935    5               I=I+1;
      655     2936    5               END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:23   
      656     2937    4            RAT$=RAT$->RAT.LNK$;
      657     2938    4            END;
      658     2939    3         END;
      659     2940    2      IF I<MAX THEN B$PS2$->VPR.NN=I;
      660     2941    2      RETURN;
      661     2942    2   END;
      662     2943           /**/
      663     2944        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:24   
      664     2945           /**/
      665     2946    1   RMEM: PROC;
      666     2947    3      IF MODE=%M_BATCH# OR B$JIT.ARECX~=0 THEN DO;
      667     2948    3         FR_MEMC(MODE)=FR_MEMC(MODE)-MEMORY;
      668     2949    3         FR_MEMC(0)=FR_MEMC(0)-MEMORY;
      669     2950    3         IF FR_MEMC(0)<0 OR FR_MEMC(MODE)<0 THEN CALL SC_R2MANY;
      670     2951    3         END;
      671     2952    2      B$JIT.RESCORE=B$JIT.RESCORE-MEMORY;
      672     2953    2      IF B$JIT.MAXCORE>B$JIT.RESCORE THEN B$JIT.MAXCORE=B$JIT.RESCORE;
      673     2954    2      RETURN;
      674     2955           /**/
      675     2956           /**/
      676     2957           /*S*  SCREECH_CODE:  FRP-S$R2MANY
      677     2958                 TYPE:          Screech
      678     2959                 MESSAGE:       More resources released than were ever allocated
      679     2960                 REMARKS:       *THIS IS THE BUDDY DOEPPEL MEMORIAL SCREECH*
      680     2961                                This screech occurs when the "currently allocated"
      681     2962                                count for a resource goes negative.  The screech is
      682     2963                                done for memory directly above and for pseudos
      683     2964                                directly below this comment.  For physical resources
      684     2965                                the same screech is reported by FRZ$RRES as FRZ-S$R2MANY
      685     2966                                This screech occurs as a result of resource
      686     2967                                management bugs or possibly a malicious user with
      687     2968                                JIT or monitor access has changed some numbers          */
      688     2969           /**/
      689     2970           /**/
      690     2971    2   RSUDO: ENTRY;
      691     2972           /**/
      692     2973    3      DO J=0 TO FR_SUMX;
      693     2974    3         SUDO=SUARAY(J);
      694     2975    4         IF SUDO~=0 THEN DO;
      695     2976    4            FR_SUC$(MODE)->FR$SU(J)=FR_SUC$(MODE)->FR$SU(J)-SUDO;
      696     2977    4            FR_SUCT(J)=FR_SUCT(J)-SUDO;
      697     2978    4            IF FR_SUCT(J)<0 OR FR_SUC$(MODE)->FR$SU(J)<0
      698     2979    4            THEN CALL SC_R2MANY;
      699     2980    4            B$JIT.CURSUDO(J)=B$JIT.CURSUDO(J)-SUDO;
      700     2981    4            END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:25   
      701     2982    3         END;
      702     2983    2      IF STRSOP~=0 AND SUARAY THEN CALL FRS$SUSUB (SUARAY);
      703     2984    2      RETURN;
      704     2985    2   END;
      705     2986           /**/
      706     2987        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:26   
      707     2988           /**/
      708     2989    1   RELALL: PROC;
      709     2990           /**/
      710     2991    2      MEMORY=B$JIT.RESCORE-CURRCORE;
      711     2992    2      CALL RMEM;
      712     2993    2      SUARAY=B$JIT.CURSUDO;
      713     2994    2      CALL RSUDO;
      714     2995    2      P.DISP=2; /* LET UDLIST FIGURE WHETHER TO UNLOAD THE VOLUMES */
      715     2996    2      CALL FMR$L8;
      716     2997    2      I=FM$CFUX.SETH;
      717     2998    3      DO WHILE (I~=0);
      718     2999    3         CALL CKSET ALTRET(RPSN1);
      719     3000    3         CALL RELSET;
      720     3001    3   RPSN1: ;
      721     3002    3         I=FM$SET.SETL(I);
      722     3003    3         END;
      723     3004    2      CALL FMR$U8;
      724     3005    3      DO RCD=0 TO FR_NPOOL;
      725     3006    3   RLALLAGIN:;
      726     3007    3         RAT$=FR$HD$(RCD);
      727     3008    4         DO WHILE (RAT$~=ADDR(NIL));
      728     3009    5            IF RAT.RES.SISID=SYSID THEN DO;
      729     3010    6               IF RAT.FLG.OPN THEN DO;
      730     3011    7                  IF B$JIT.ERR~=NRLOP THEN DO;
      731     3012    7                     B$JIT.ERR=NRLOP;
      732     3013    7                     IF STRSOP=0 AND B$JIT.SYSID~=IRM_SYSID THEN CALL SC_NRNDWN;
      733     3014    7                     END;
      734     3015    6                  IF STRSOP=0 THEN RAT.FLG.OPN='0'B; /* RELEASE ANYWAY */
      735     3016    6                  END;
      736     3017           /*E*  ERROR:         FRP-E$NRLOPN-E
      737     3018                 DESCRIPTION:   In this case a release all was done with a DCB
      738     3019                                still open to a physical resource.                      */
      739     3020    6               IF NOT RAT.FLG.OPN THEN DO;
      740     3021    6                  IF STRSOP~=0 THEN CALL FRS$RESSUB (RAT);
      741     3022    6                  CALL FRZ$RRESNA (RAT,MODE);
      742     3023    6                  IF STRSOP~=0 THEN GOTO RLALLAGIN; /* SOMETHING MAYBE MOVED */
      743     3024    6                  END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:27   
      744     3025    5               END;
      745     3026    4            ELSE IF RAT.REEL.ASID=SYSID THEN RAT.REEL.ASID=0;
      746     3027    4            RAT$=RAT.LNK$;
      747     3028    4            END;
      748     3029    3         END;
      749     3030    2      RETURN;
      750     3031    2   END;
      751     3032           /**/
      752     3033        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:28   
      753     3034           /**/
      754     3035           /**/
      755     3036    1   DSETSM: PROC;
      756     3037           /**/
      757     3038    2      SYSID=0;
      758     3039           /**/
      759     3040    2   DSETS: ENTRY;
      760     3041           /**/
      761     3042    2      CALL HFF$DSIZ(3,J);
      762     3043    2      J=J-POFFC(ADDR(B$PS3$->VPS.RPLIST),ADDR(B$PS3$->VPS));
      763     3044    2      IF J<=0 THEN RETURN;
      764     3045    2      B$PS3$->VPS.NN=J/SIZEC(B$PS3$->VPS.RPLIST(0))-1;
      765     3046    2      J=0;
      766     3047    2      CALL FMR$L8;
      767     3048    2      I=FM$CFUX.SETH;
      768     3049    3      DO WHILE(I~=0);
      769     3050    3         IF FM$SET.SYSID(I)=0 THEN GOTO DSETS1;
      770     3051    3         IF SYSID~=0 THEN CALL CKSET ALTRET(DSETS1);
      771     3052    4         IF J>=B$PS3$->VPS.NN THEN DO;
      772     3053    4            J=J+1;
      773     3054    4            B$PS3$->VPS.FAILX=J;
      774     3055    4            GOTO DSETS1;
      775     3056    4            END;
      776     3057    3         B$PS3$->VPS.RPLIST.PSN(J)=FM$SET.PSN(I);
      777     3058    3         IF FM$SET.XCL(I) THEN B$PS3$->VPS.RPLIST.USAGE(J)=2;
      778     3059    3         ELSE B$PS3$->VPS.RPLIST.USAGE(J)=1;
      779     3060    3         J=J+1;
      780     3061    3   DSETS1: ;
      781     3062    3         I=FM$SET.SETL(I);
      782     3063    3         END;
      783     3064    2      CALL FMR$U8;
      784     3065    2      IF J>B$PS3$->VPS.NN THEN B$JIT.ERR=NORMRM;
      785     3066    3      ELSE DO;
      786     3067    3         B$PS3$->VPS.NN=J;
      787     3068    3         B$PS3$->VPS.FAILX=0;
      788     3069    3         END;
      789     3070    2      RETURN;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:29   
      790     3071           /**/
      791     3072           /**/
      792     3073    2   END;
      793     3074           /**/
      794     3075        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:30   
      795     3076           /**/
      796     3077    1   CKSET: PROC ALTRET;
      797     3078           /**/
      798     3079    3      IF FM$SET.XCL(I) OR FM$SET.ONEU(I) THEN DO;
      799     3080    3         IF SYSID~=FM$SET.SYSID(I) THEN ALTRETURN;
      800     3081    3         RETURN;
      801     3082    3         END;
      802     3083    2      SETU$=PINCRW(F$CFU$,FM$SET.USERLIST(I));
      803     3084    3      DO WHILE(SETU$~=F$CFU$);
      804     3085    4         DO K=0 TO FM$SETU.NUM-1;
      805     3086    4            IF FM$SETU.SYSID(K)=SYSID THEN RETURN;
      806     3087    4            END;
      807     3088    3         SETU$=PINCRW(F$CFU$,FM$SETU.LINKX);
      808     3089    3         END;
      809     3090    2      ALTRETURN;
      810     3091           /**/
      811     3092           /**/
      812     3093    2   FINDSET: ENTRY ALTRET;
      813     3094           /**/
      814     3095    2      CALL FMR$L8;
      815     3096    2      I=FM$CFUX.SETH;
      816     3097    3      DO WHILE(I~=0);
      817     3098    3         IF FM$SET.PSN(I)=P.PSN THEN RETURN;
      818     3099    3         I=FM$SET.SETL(I);
      819     3100    3         END;
      820     3101    2      ALTRETURN;
      821     3102           /**/
      822     3103           /**/
      823     3104    2   RELSET: ENTRY ALTRET;
      824     3105           /**/
      825     3106    3      IF FM$SET.SET(I) THEN DO;
      826     3107    3         IF STRSOP~=0 THEN CALL FRS$CLSTRS;
      827     3108    3         CALL FMS$RELACCT(I)ALTRET(RETALT);
      828     3109    3         IF STRSOP~=0 THEN CALL FRS$OPSTRS;
      829     3110    3         END;
      830     3111    3      IF FM$SET.XCL(I) THEN DO;
      831     3112    3         FM$SET.SET(I)='0'B;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:31   
      832     3113    3         PRC$=ADDR(FM$SET(FM$SET.DCTX(I)));
      833     3114    4         DO WHILE(PRC$~=FM$SET$); /* MARK FR$RAT.OPN FOR ALL THE VOLUMES */
      834     3115    4            RAT$=N$DCT$(FM$VOL.DCTX)->NI$DCT.RAT$;
      835     3116    5            IF RAT.RES.SISID=SYSID THEN DO;
      836     3117    5               RAT.FLG.OPN='0'B;
      837     3118    6               IF MOD(P.DISP,2)~=0 THEN DO;
      838     3119    6                  IF STRSOP~=0 THEN CALL FRS$RESSUB (RAT);
      839     3120    6                  CALL FRZ$RRESNA(RAT,MODE);
      840     3121    6                  END;
      841     3122    5               ELSE IF P.DISP~=0 THEN CALL FRZ$DSMT(RAT);
      842     3123    6                  ELSE DO;
      843     3124    6                     RAT.REEL.ASID=0;
      844     3125    6                     RAT.FLG.MBIT.MTD='0'B;
      845     3126    6                     END;
      846     3127    5               END;
      847     3128    4            PRC$=ADDR(FM$SET(FM$VOL.VOLL));
      848     3129    4            END;
      849     3130    3         END;
      850     3131    2      CALL FMR$L8;
      851     3132    2      IF P.DISP>1 THEN CALL FMP$UDLIST(FM$SET(I),SYSID);
      852     3133    2      RETURN;
      853     3134           /**/
      854     3135    2   RETALT:;
      855     3136    2      IF STRSOP~=0 THEN CALL FRS$OPSTRS;
      856     3137    2      CALL FMR$L8;
      857     3138    2      ALTRETURN;
      858     3139    2   END;
      859     3140    1   END;
      860     3141           /**/
      861     3142           /**/

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:32   
--  Include file information  --

   UD_EQU_E.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   FR$RESLIST.:E05TOU  is referenced.
   FR$RAT.:E05TOU  is referenced.
      No diagnostics issued in procedure FRP$PMME.

   Procedure FRP$PMME requires 1785 words for executable code.
   Procedure FRP$PMME requires 34 words of local(AUTO) storage.

    No errors detected in file FRP$PMME.:E05TSI    .

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:33   

 Object Unit name= FRP$PMME                                   File name= FRP$PMME.:E05TOU
 UTS= JUL 29 '97 17:23:31.76 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS     15     17  FRP$PMME
    1   Proc  even  none  1785   3371  FRP$PMME
    2  RoData even  none    11     13  FRP$PMME

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  FRP$PMME
     1   1445                  yes      Std        0  FRP$RLALL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:34   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 HFF$NILERASE
         yes           Std       1 FRS$RESADD
         yes           Std       2 HFF$DSIZ
         yes           Std       0 FRS$CLSTRS
         yes           Std       1 FRS$RESSUB
         yes           Std       0 FRS$OPSTRS
         yes           Std       1 FRS$SUADD
         yes           Std       2 FRZ$RRESNA
         yes           Std       0 FMR$U8
         yes           Std       0 SSS$BLOCK
         yes           Std       1 FRS$SUSTRT
 yes     yes           Std       2 FMR$GA
 yes     yes           Std       2 FMP$UDLIST
         yes           Std       0 FMR$L8
 yes     yes           Std       2 FMP$ULIST
 yes     yes           Std       5 FRZ$GETRES
         yes           Std       1 FRS$SUSUB
 yes     yes           Std       1 FMS$RELACCT
         yes           Std       1 FRZ$DSMT
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:35   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     SC_R2MANY                             SC_NRNDWN                             FR$HD$
     FR_PRC$                               FR_PRM$                               FR_MEMC
     FR_MEMM                               FR_SUC$                               FR_SUM$
     FR_SUMT                               FR_SUCT                               FR_SUMX
     FR_SUNM                               B$JIT$                                B$PS0$
     B$PS1$                                B$PS2$                                B$PS3$
     FM$SET$                               F$CFU$                                N$DCT$$
     IRM_SYSID                             B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ASLENTSID                             ISSID
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:36   


        1        1        /*M* FRP$PMME Handler for resource management pmmes*/
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* MCL=0,MOC,MEC,CLM=3,EXM=3,CRT=6,DMR,PLM=3,IND=3,ENU=0,DCI=3,NSO,
        8        8        CSU=3,ECU=3,THI=0,DTI=0,CRM=86 */
        9        9           /**/
       10       10           /**/
       11       11        FRP$PMME: PROC (FPTCODE);

     11  1 000000   000000 700200 xent  FRP$PMME     TSX0  ! X66_AUTO_1
         1 000001   000042 000001                    ZERO    34,1

       12       12           /**/
       13       13           /**/
       14       14        %INCLUDE FR$RAT;
       15       67        %FR$RAT (NAME=RAT,STCLASS="BASED(RAT$)");
       16      107        %INCLUDE FR$RESLIST;
       17      130        %INCLUDE B$JIT_C;
       18      444        %B$JIT0;
       19      533        %U$JIT1X;
       20      536        %M$JIT2;
       21      546        %F$JIT3X;
       22      549        %S$JIT4X;
       23      552        %J$JIT5X;
       24      555        %A$JIT6;
       25      565        %INCLUDE FR_DATA_R;
       26      597        %INCLUDE F$CP6V_C;
       27      823        %INCLUDE JG_GHOSTS_C;
       28      913        %INCLUDE M_INFO_C;
       29     1053        %INCLUDE FM$MACROS;
       30     1428        %FM$SET(BASED="BASED(FM$SET$)");
       31     1433        %FM$VOL(ARY=,BASED="BASED(PRC$)");
       32     1439        %FM$DEV(BASED="BASED(FM$SET$)");
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:37   
       33     1445        %FM$SETU(BASED="BASED(SETU$)");
       34     1448        %FM$CFUX;
       35     1453        %FM$CFUN;
       36     1456        %FM$CFU;
       37     1462        %INCLUDE NI$TABLES;
       38     1678        %NI$DCT;
       39     1726        %INCLUDE FR_SUBS;
       40     1794           /**/
       41     1795        %FR$RESLIST (FPTN=RLST);
       42     1807        %FPT$RESCTL_V (FPTN=VRCTL);
       43     1810        %VLP$PSEUDO_V (FPTN=VSU);
       44     1814        %VLP$PRES_V (FPTN=VPR);
       45     1818        %VLP$RPSN_V (FPTN=VPS);
       46     1822        %SUB SHARED#=1/*SHARED*/;
       47     1823           /**/
       48     1824           /**/
       49     1825           /**/
       50     1826    1   DCL FPTCODE UBIN WORD;
       51     1827    1   DCL SYSID SBIN WORD;
       52     1828    1   DCL MODE UBIN WORD;
       53     1829    1   DCL MEMORY SBIN WORD;
       54     1830    1   DCL I SBIN WORD;
       55     1831    1   DCL J SBIN WORD;
       56     1832    1   DCL K SBIN WORD;
       57     1833    1   DCL RCD REDEF K UBIN WORD;
       58     1834    1   DCL MAX SBIN WORD;
       59     1835    1   DCL CURRCORE REDEF MAX SBIN WORD;
       60     1836    1   DCL ARECX UBIN WORD;
       61     1837    1   DCL STRSOP UBIN WORD;
       62     1838    1   DCL SUDO SBIN WORD;
       63     1839    1   DCL RTYP CHAR(2);
       64     1840    1   DCL RNUM CHAR(2);
       65     1841    1   DCL 1 P,
       66     1842    1         2 PSN CHAR(6),
       67     1843    1         2 USAGE UBIN BYTE UNAL,
       68     1844    1         2 DISP UBIN BYTE UNAL;
       69     1845    1   DCL RAT$ PTR;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:38   
       70     1846    1   DCL PRM$ REDEF RAT$ PTR;
       71     1847    1   DCL SETU$ REDEF RAT$ PTR;
       72     1848    1   DCL PRC$ PTR;
       73     1849    1   DCL T$ PTR;
       74     1850    1   DCL SUARAY (0:7) UBIN (9) UNAL;
       75     1851    1   DCL B$JIT$ PTR SYMREF;
       76     1852    1   DCL B$PS0$ PTR SYMREF;
       77     1853    1   DCL B$PS1$ PTR SYMREF;
       78     1854    1   DCL B$PS2$ PTR SYMREF;
       79     1855    1   DCL B$PS3$ PTR SYMREF;
       80     1856    1   DCL FM$SET$ PTR SYMREF;
       81     1857    1   DCL F$CFU$ PTR SYMREF;
       82     1858    1   DCL N$DCT$(0:0)PTR BASED(N$DCT$$);
       83     1859    1   DCL N$DCT$$ PTR SYMREF;
       84     1860    1   DCL IRM_SYSID UBIN SYMREF;
       85     1861    1   DCL FMP$UDLIST ENTRY(2)ALTRET;
       86     1862    1   DCL FMP$ULIST ENTRY(2)ALTRET;
       87     1863    1   DCL FMR$GA ENTRY(2)ALTRET;
       88     1864    1   DCL FMR$L8 ENTRY;
       89     1865    1   DCL FMR$U8 ENTRY;
       90     1866    1   DCL FMR$ZA ENTRY(1);
       91     1867    1   DCL FMS$RELACCT ENTRY(1)ALTRET;
       92     1868    1   DCL HFF$DSIZ ENTRY(2);
       93     1869    1   DCL HFF$NILERASE ENTRY(1) ALTRET;
       94     1870    1   DCL FRZ$DSMT ENTRY(1);
       95     1871    1   DCL FRZ$GETRES ENTRY(5) ALTRET;
       96     1872    1   DCL FRZ$RRESNA ENTRY(2);
       97     1873    1   DCL FRS$OPSTRS ENTRY;
       98     1874    1   DCL FRS$CLSTRS ENTRY;
       99     1875    1   DCL FRS$SUSTRT ENTRY(1);
      100     1876    1   DCL FRS$SUADD ENTRY(1);
      101     1877    1   DCL FRS$SUSUB ENTRY(1);
      102     1878    1   DCL FRS$RESADD ENTRY(1);
      103     1879    1   DCL FRS$RESSUB ENTRY(1);
      104     1880    1   DCL SSS$BLOCK ENTRY;
      105     1881    1   DCL UQB$DELQIDX ENTRY(1)ALTRET;
      106     1882           /**/
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:39   
      107     1883    1   DCL SC_R2MANY ENTRY CONV(2,0); /* MORE MEMORY OR SUDOS RELEASED THAN EXIST*/
      108     1884    1   DCL SC_NRNDWN ENTRY CONV(2,0); /* RESOURCE STILL OPEN AT FRP$RLALL */
      109     1885           /**/
      110     1886           /**/
      111     1887        %INCLUDE FR_ERRORS_C;
      112     1918        %INCLUDE UD_ERRORS_C;
      113     1960        %INCLUDE UD_SEV_C;
      114     1974           /**/
      115     1975        %SUB FCG#='0622'O;
      116     1976        %SUB MID#='20'O;
      117     1977        %ERRCODE(NAME=NOMOS,COD#=%E$SUOUT);
      118     1981        %ERRCODE(NAME=NORMRM,COD#=%E$NORMRM);
      119     1985        %ERRCODE(NAME=BSUNM,COD#=%E$BSUNM,SEV#=SEV_CONT#);
      120     1989        %ERRCODE(NAME=BSUNMX,COD#=%E$BSUNM,SEV#=SEV_ABORT#);
      121     1993        %ERRCODE(NAME=NAUTH,COD#=%E$NOTAUTH,SEV#=SEV_ABORT#);
      122     1997        %ERRCODE(NAME=NORQD,COD#=%E$NORQ,SEV#=SEV_ABORT#);
      123     2001        %ERRCODE(NAME=NALRL,COD#=%E$NOTUR);
      124     2005        %ERRCODE(NAME=NRLOP,COD#=%E$NRLOPN);
      125     2009        %ERRCODE(NAME=NOPSN,COD#=%E$NODP);
      126     2013        %ERRCODE(NAME=LESMEM,COD#=%E$LESMEM,SEV#=SEV_CONT#);
      127     2017        %ERRCODE(NAME=NOMEM,COD#=%E$LESMEM);
      128     2021           /**/
      129     2022           /**/
      130     2023        %INCLUDE UD_EQU_E;
      131     2412           /**/
      132     2413           /**/
      133     2414        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:40   
      134     2415    1      STRSOP=0;

   2415  1 000002   200014 450100                    STZ     STRSOP,,AUTO

      135     2416    1      SYSID=B$JIT.SYSID;

   2416  1 000003   000000 470400 xsym               LDP0    B$JIT$
         1 000004   000000 236100                    LDQ     0,,PR0
         1 000005   777777 376007                    ANQ     -1,DL
         1 000006   200004 756100                    STQ     SYSID,,AUTO

      136     2417    1      MODE=B$JIT.MODE;

   2417  1 000007   000000 236100                    LDQ     0,,PR0
         1 000010   000040 772000                    QRL     32
         1 000011   200005 756100                    STQ     MODE,,AUTO

      137     2418    2      DO CASE (FPTCODE);

   2418  1 000012   200003 471500                    LDP1    @FPTCODE,,AUTO
         1 000013   100000 235100                    LDA     0,,PR1
         1 000014   000006 115007                    CMPA    6,DL
         1 000015   000017 602005 1                  TNC     s:2418+5,AL
         1 000016   001437 710000 1                  TRA     CSEND
         1 000017   000025 710000 1                  TRA     s:2420
         1 000020   000204 710000 1                  TRA     s:2465
         1 000021   000442 710000 1                  TRA     DISPRES
         1 000022   000766 710000 1                  TRA     s:2631
         1 000023   000552 710000 1                  TRA     s:2558
         1 000024   000625 710000 1                  TRA     s:2586

      138     2419    2      CASE (%C$LIMIT#);

      139     2420    2         SUARAY='0'B;

   2420  1 000025   200025 450100                    STZ     SUARAY,,AUTO
         1 000026   200026 450100                    STZ     SUARAY+1,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:41   

      140     2421    2         MEMORY=0;

   2421  1 000027   200006 450100                    STZ     MEMORY,,AUTO

      141     2422    2         CALL HFF$NILERASE (1) ALTRET (NOSU);

   2422  1 000030   000000 630400 2                  EPPR0   0
         1 000031   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000032   000000 701000 xent               TSX1    HFF$NILERASE
         1 000033   000120 702000 1                  TSX2    NOSU

      142     2423    2         MEMORY=B$PS1$->VSU.MEMORY;

   2423  1 000034   000000 470400 xsym               LDP0    B$PS1$
         1 000035   000002 236100                    LDQ     2,,PR0
         1 000036   000022 772000                    QRL     18
         1 000037   200006 756100                    STQ     MEMORY,,AUTO

      143     2424    2         CALL SUCKM ALTRET (SUFAIL);

   2424  1 000040   002201 701000 1                  TSX1    SUCKM
         1 000041   000107 702000 1                  TSX2    SUFAIL

      144     2425    3         DO I=0 TO B$PS1$->VSU.NN-1;

   2425  1 000042   200007 450100                    STZ     I,,AUTO
         1 000043   000114 710000 1                  TRA     NXTSU+1

      145     2426    4            DO J=0 TO FR_SUMX;

   2426  1 000044   200010 450100                    STZ     J,,AUTO
         1 000045   000101 710000 1                  TRA     s:2432+1

      146     2427    5               IF B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(J) THEN DO;

   2427  1 000046   200007 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:42   
         1 000047   000014 402007                    MPY     12,DL
         1 000050   200010 235100                    LDA     J,,AUTO
         1 000051   000003 735000                    ALS     3
         1 000052   000000 470400 xsym               LDP0    B$PS1$
         1 000053   040005 106506                    CMPC    fill='040'O
         1 000054   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         1 000055   000000 000010 xsym               ADSC9   FR_SUNM,A                cn=0,n=8
         1 000056   000100 601000 1                  TNZ     s:2432

      147     2428    5                  SUARAY(J)=B$PS1$->VSU.PSLIST.NUM(I)+SUARAY(J);

   2428  1 000057   200010 235100                    LDA     J,,AUTO
         1 000060   000100 101505                    MRL     fill='000'O
         1 000061   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 000062   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 000063   200007 236100                    LDQ     I,,AUTO
         1 000064   000003 402007                    MPY     3,DL
         1 000065   000006 236106                    LDQ     6,QL,PR0
         1 000066   000033 772000                    QRL     27
         1 000067   200034 036100                    ADLQ    SUARAY+7,,AUTO
         1 000070   200035 756100                    STQ     SUARAY+8,,AUTO
         1 000071   200010 235100                    LDA     J,,AUTO
         1 000072   000105 101500                    MRL     fill='000'O
         1 000073   200035 000004                    ADSC9   SUARAY+8,,AUTO           cn=0,n=4
         1 000074   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1

      148     2429    5                  CALL SUCHK ALTRET (SUFAIL);

   2429  1 000075   002134 701000 1                  TSX1    SUCHK
         1 000076   000107 702000 1                  TSX2    SUFAIL

      149     2430    5                  GOTO NXTSU;

   2430  1 000077   000113 710000 1                  TRA     NXTSU

      150     2431    5                  END;
      151     2432    4               END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:43   

   2432  1 000100   200010 054100                    AOS     J,,AUTO
         1 000101   200010 236100                    LDQ     J,,AUTO
         1 000102   000000 116000 xsym               CMPQ    FR_SUMX
         1 000103   000046 604400 1                  TMOZ    s:2427

      152     2433    3            B$JIT.ERR=BSUNM;

   2433  1 000104   000002 236000 0                  LDQ     BSUNM
         1 000105   000000 470400 xsym               LDP0    B$JIT$
         1 000106   000012 756100                    STQ     10,,PR0

   2433  1 000107                       SUFAIL       null
      153     2434           /*E*  ERROR:         FRP-E$BSUNM-C
      154     2435                  MESSAGE: The pseudo resource name specified does not exist!
      155     2436                 MESSAGE1: Pseudo resource names are established by the system
      156     2437                           manager at boot time when TIGR is run.  You attempted
      157     2438                           to acquire, release, or require a pseudo resource
      158     2439                           whose name does not appear in that list.
      159     2440                 DESCRIPTION:   In this case the error is reported on an M$LIMIT
      160     2441                                pmme issued by the command processor - probably the
      161     2442                                user put a bad pseudo name on a !LIMIT or
      162     2443                                !RESOURCE command.                                      */
      163     2444    3   SUFAIL:  ;
      164     2445    3            B$PS1$->VSU.FAILX=I;

   2445  1 000107   000000 470400 xsym               LDP0    B$PS1$
         1 000110   200007 235100                    LDA     I,,AUTO
         1 000111   000001 755100                    STA     1,,PR0

      165     2446    3            RETURN;

   2446  1 000112   000000 702200 xent               TSX2  ! X66_ARET

   2445  1 000113                       NXTSU        null
      166     2447    3   NXTSU:   ;
      167     2448    3            END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:44   

   2448  1 000113   200007 054100                    AOS     I,,AUTO
         1 000114   000000 470400 xsym               LDP0    B$PS1$
         1 000115   200007 236100                    LDQ     I,,AUTO
         1 000116   000000 116100                    CMPQ    0,,PR0
         1 000117   000044 604000 1                  TMI     s:2426

   2429  1 000120                       NOSU         null
      168     2449    2   NOSU: ;
      169     2450    2         CALL FRS$OPSTRS;

   2450  1 000120   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000121   000000 701000 xent               TSX1    FRS$OPSTRS
         1 000122   000000 011000                    NOP     0

      170     2451    2         STRSOP=1;

   2451  1 000123   000001 235007                    LDA     1,DL
         1 000124   200014 755100                    STA     STRSOP,,AUTO

      171     2452    2         ARECX=B$JIT.ARECX;

   2452  1 000125   000000 470400 xsym               LDP0    B$JIT$
         1 000126   000333 236100                    LDQ     219,,PR0
         1 000127   177777 376007                    ANQ     65535,DL
         1 000130   200013 756100                    STQ     ARECX,,AUTO

      172     2453    2         CALL ALLOC ALTRET(CSEND);

   2453  1 000131   001466 701000 1                  TSX1    ALLOC
         1 000132   001437 702000 1                  TSX2    CSEND

      173     2454    2         B$JIT.ARECX=ARECX;

   2454  1 000133   000000 470400 xsym               LDP0    B$JIT$
         1 000134   200013 236100                    LDQ     ARECX,,AUTO
         1 000135   000333 676100                    ERQ     219,,PR0
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:45   
         1 000136   177777 376007                    ANQ     65535,DL
         1 000137   000333 656100                    ERSQ    219,,PR0

      174     2455    2         B$JIT.RESCORE=B$JIT.RESCORE+MEMORY;

   2455  1 000140   000336 236100                    LDQ     222,,PR0
         1 000141   200006 036100                    ADLQ    MEMORY,,AUTO
         1 000142   000336 756100                    STQ     222,,PR0

      175     2456    2         B$JIT.MAXCORE=B$JIT.RESCORE;

   2456  1 000143   000336 720100                    LXL0    222,,PR0
         1 000144   000210 740100                    STX0    136,,PR0

      176     2457    3         IF SUARAY THEN DO;

   2457  1 000145   000000 106500                    CMPC    fill='000'O
         1 000146   200025 000010                    ADSC9   SUARAY,,AUTO             cn=0,n=8
         1 000147   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 000150   001437 600000 1                  TZE     CSEND

      177     2458    4            DO I=0 TO FR_SUMX;

   2458  1 000151   200007 450100                    STZ     I,,AUTO
         1 000152   000172 710000 1                  TRA     s:2460+1

      178     2459    4               B$JIT.CURSUDO(I)=B$JIT.CURSUDO(I)+SUARAY(I);

   2459  1 000153   200007 235100                    LDA     I,,AUTO
         1 000154   000100 101505                    MRL     fill='000'O
         1 000155   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 000156   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 000157   000000 470400 xsym               LDP0    B$JIT$
         1 000160   000100 101505                    MRL     fill='000'O
         1 000161   000334 000001                    ADSC9   220,A,PR0                cn=0,n=1
         1 000162   200035 000004                    ADSC9   SUARAY+8,,AUTO           cn=0,n=4
         1 000163   200035 236100                    LDQ     SUARAY+8,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:46   
         1 000164   200034 036100                    ADLQ    SUARAY+7,,AUTO
         1 000165   200036 756100                    STQ     SUARAY+9,,AUTO
         1 000166   000105 101500                    MRL     fill='000'O
         1 000167   200036 000004                    ADSC9   SUARAY+9,,AUTO           cn=0,n=4
         1 000170   000334 000001                    ADSC9   220,A,PR0                cn=0,n=1

      179     2460    4               END;

   2460  1 000171   200007 054100                    AOS     I,,AUTO
         1 000172   200007 236100                    LDQ     I,,AUTO
         1 000173   000000 116000 xsym               CMPQ    FR_SUMX
         1 000174   000153 604400 1                  TMOZ    s:2459

      180     2461    3            CALL FRS$SUADD (SUARAY);

   2461  1 000175   200025 630500                    EPPR0   SUARAY,,AUTO
         1 000176   200034 450500                    STP0    SUARAY+7,,AUTO
         1 000177   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 000200   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000201   000000 701000 xent               TSX1    FRS$SUADD
         1 000202   000000 011000                    NOP     0

      181     2462    3            END;

   2462  1 000203   001437 710000 1                  TRA     CSEND

      182     2463        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:47   
      183     2464    2      CASE (%C$MBS#);

      184     2465    3         IF B$PS0$->VRCTL.MBSDISP THEN DO;

   2465  1 000204   000000 473400 xsym               LDP3    B$PS0$
         1 000205   300001 236100                    LDQ     1,,PR3
         1 000206   200000 316003                    CANQ    65536,DU
         1 000207   000376 600000 1                  TZE     s:2505

      185     2466    4            IF SYSID~=JG_MBS# THEN DO;

   2466  1 000210   200004 235100                    LDA     SYSID,,AUTO
         1 000211   000001 115007                    CMPA    1,DL
         1 000212   000254 600000 1                  TZE     s:2479

      186     2467    4               CALL HFF$NILERASE (1) ALTRET (MBDZU);

   2467  1 000213   000000 630400 2                  EPPR0   0
         1 000214   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000215   000000 701000 xent               TSX1    HFF$NILERASE
         1 000216   000245 702000 1                  TSX2    MBDZU

      187     2468    4               B$PS1$->VSU.MEMORY=FR_MEMM(0);

   2468  1 000217   000000 720000 xsym               LXL0    FR_MEMM
         1 000220   000000 470400 xsym               LDP0    B$PS1$
         1 000221   000002 740100                    STX0    2,,PR0

      188     2469    5               DO I=0 TO FR_SUMX;

   2469  1 000222   200007 450100                    STZ     I,,AUTO
         1 000223   000236 710000 1                  TRA     s:2471+1

      189     2470    5                  B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(I);

   2470  1 000224   200007 236100                    LDQ     I,,AUTO
         1 000225   000003 402007                    MPY     3,DL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:48   
         1 000226   200007 235100                    LDA     I,,AUTO
         1 000227   000003 735000                    ALS     3
         1 000230   000002 736000                    QLS     2
         1 000231   000000 470400 xsym               LDP0    B$PS1$
         1 000232   040106 100405                    MLR     fill='040'O
         1 000233   000000 000010 xsym               ADSC9   FR_SUNM,A                cn=0,n=8
         1 000234   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8

      190     2471    5                  END;

   2471  1 000235   200007 054100                    AOS     I,,AUTO
         1 000236   200007 236100                    LDQ     I,,AUTO
         1 000237   000000 116000 xsym               CMPQ    FR_SUMX
         1 000240   000224 604400 1                  TMOZ    s:2470

      191     2472    4               B$PS1$->VSU.NN=FR_SUMX+1;

   2472  1 000241   000000 470400 xsym               LDP0    B$PS1$
         1 000242   000000 235000 xsym               LDA     FR_SUMX
         1 000243   000001 035007                    ADLA    1,DL
         1 000244   000000 755100                    STA     0,,PR0

   2472  1 000245                       MBDZU        null
      192     2473    4   MBDZU:      ;
      193     2474    4               SYSID=-1;

   2474  1 000245   000001 335007                    LCA     1,DL
         1 000246   200004 755100                    STA     SYSID,,AUTO

      194     2475    4               CALL DPHYS;

   2475  1 000247   002226 701000 1                  TSX1    DPHYS
         1 000250   000000 011000                    NOP     0

      195     2476    4               CALL DSETSM;

   2476  1 000251   002703 701000 1                  TSX1    DSETSM
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:49   
         1 000252   000000 011000                    NOP     0

      196     2477    4               END;

   2477  1 000253   001437 710000 1                  TRA     CSEND

      197     2478    4            ELSE DO;

      198     2479    4               CALL HFF$NILERASE (1) ALTRET (MBDZ);

   2479  1 000254   000000 630400 2                  EPPR0   0
         1 000255   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000256   000000 701000 xent               TSX1    HFF$NILERASE
         1 000257   000371 702000 1                  TSX2    MBDZ

      199     2480    4               IF FR_MEMM(0)-FR_MEMC(0)>=FR_MEMM(%M_BATCH#)-FR_MEMC(%M_BATCH#)

   2480  1 000260   000000 236000 xsym               LDQ     FR_MEMM
         1 000261   000000 136000 xsym               SBLQ    FR_MEMC
         1 000262   200034 756100                    STQ     SUARAY+7,,AUTO
         1 000263   000001 236000 xsym               LDQ     FR_MEMM+1
         1 000264   000001 136000 xsym               SBLQ    FR_MEMC+1
         1 000265   200034 116100                    CMPQ    SUARAY+7,,AUTO
         1 000266   000273 605400 1                  TPNZ    s:2482

      200     2481    4               THEN MEMORY=FR_MEMM(%M_BATCH#)-FR_MEMC(%M_BATCH#);

   2481  1 000267   000001 236000 xsym               LDQ     FR_MEMM+1
         1 000270   000001 136000 xsym               SBLQ    FR_MEMC+1
         1 000271   200006 756100                    STQ     MEMORY,,AUTO
         1 000272   000276 710000 1                  TRA     s:2483

      201     2482    4               ELSE MEMORY=FR_MEMM(0)-FR_MEMC(0);

   2482  1 000273   000000 236000 xsym               LDQ     FR_MEMM
         1 000274   000000 136000 xsym               SBLQ    FR_MEMC
         1 000275   200006 756100                    STQ     MEMORY,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:50   

      202     2483    4               IF MEMORY<0 THEN MEMORY=0;

   2483  1 000276   000300 605000 1                  TPL     s:2484

   2483  1 000277   200006 450100                    STZ     MEMORY,,AUTO

      203     2484    4               B$PS1$->RLST.MEMORY=MEMORY;

   2484  1 000300   200006 720100                    LXL0    MEMORY,,AUTO
         1 000301   000000 470400 xsym               LDP0    B$PS1$
         1 000302   000002 740100                    STX0    2,,PR0

      204     2485    4               PRM$=FR_PRM$(%M_BATCH#);

   2485  1 000303   000001 236000 xsym               LDQ     FR_PRM$+1
         1 000304   200022 756100                    STQ     RAT$,,AUTO

      205     2486    4               PRC$=FR_PRC$(%M_BATCH#);

   2486  1 000305   000001 236000 xsym               LDQ     FR_PRC$+1
         1 000306   200023 756100                    STQ     PRC$,,AUTO

      206     2487    4               B$PS1$->RLST.DISK=PRM$->FR$PR(FR_DP)-PRC$->FR$PR(FR_DP);

   2487  1 000307   200023 471500                    LDP1    PRC$,,AUTO
         1 000310   200022 473500                    LDP3    RAT$,,AUTO
         1 000311   300000 236100                    LDQ     0,,PR3
         1 000312   100000 136100                    SBLQ    0,,PR1
         1 000313   000000 621006                    EAX1    0,QL
         1 000314   000002 441100                    SXL1    2,,PR0

      207     2488    4               B$PS1$->RLST.TAPES=PRM$->FR$PR(FR_MT)-PRC$->FR$PR(FR_MT);

   2488  1 000315   200022 473500                    LDP3    RAT$,,AUTO
         1 000316   300001 236100                    LDQ     1,,PR3
         1 000317   100001 136100                    SBLQ    1,,PR1
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:51   
         1 000320   000000 622006                    EAX2    0,QL
         1 000321   000003 742100                    STX2    3,,PR0

      208     2489    4               B$PS1$->RLST.OTHER=PRM$->FR$PR(FR_NPOOL)-PRC$->FR$PR(FR_NPOOL);

   2489  1 000322   200022 473500                    LDP3    RAT$,,AUTO
         1 000323   300002 236100                    LDQ     2,,PR3
         1 000324   100002 136100                    SBLQ    2,,PR1
         1 000325   000000 623006                    EAX3    0,QL
         1 000326   000003 443100                    SXL3    3,,PR0

      209     2490    4               PRM$=FR_SUM$(%M_BATCH#);

   2490  1 000327   000001 236000 xsym               LDQ     FR_SUM$+1
         1 000330   200022 756100                    STQ     RAT$,,AUTO

      210     2491    4               PRC$=FR_SUC$(%M_BATCH#);

   2491  1 000331   000001 236000 xsym               LDQ     FR_SUC$+1
         1 000332   200023 756100                    STQ     PRC$,,AUTO

      211     2492    5               DO I=0 TO FR_SUMX;

   2492  1 000333   200007 450100                    STZ     I,,AUTO
         1 000334   000366 710000 1                  TRA     s:2498+1

      212     2493    5                  IF FR_SUMT(I)-FR_SUCT(I)>=PRM$->FR$SU(I)-PRC$->FR$SU(I)

   2493  1 000335   200007 720100                    LXL0    I,,AUTO
         1 000336   000000 236010 xsym               LDQ     FR_SUMT,X0
         1 000337   000000 136010 xsym               SBLQ    FR_SUCT,X0
         1 000340   200023 470500                    LDP0    PRC$,,AUTO
         1 000341   200022 471500                    LDP1    RAT$,,AUTO
         1 000342   200034 756100                    STQ     SUARAY+7,,AUTO
         1 000343   100000 236110                    LDQ     0,X0,PR1
         1 000344   000000 136110                    SBLQ    0,X0,PR0
         1 000345   200034 116100                    CMPQ    SUARAY+7,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:52   
         1 000346   000353 605400 1                  TPNZ    s:2495

      213     2494    5                  THEN SUDO=PRM$->FR$SU(I)-PRC$->FR$SU(I);

   2494  1 000347   100000 236110                    LDQ     0,X0,PR1
         1 000350   000000 136110                    SBLQ    0,X0,PR0
         1 000351   200015 756100                    STQ     SUDO,,AUTO
         1 000352   000356 710000 1                  TRA     s:2496

      214     2495    5                  ELSE SUDO=FR_SUMT(I)-FR_SUCT(I);

   2495  1 000353   000000 236010 xsym               LDQ     FR_SUMT,X0
         1 000354   000000 136010 xsym               SBLQ    FR_SUCT,X0
         1 000355   200015 756100                    STQ     SUDO,,AUTO

      215     2496    5                  IF SUDO<0 THEN SUDO=0;

   2496  1 000356   000360 605000 1                  TPL     s:2497

   2496  1 000357   200015 450100                    STZ     SUDO,,AUTO

      216     2497    5                  B$PS1$->RLST.SULST(I)=SUDO;

   2497  1 000360   000000 473400 xsym               LDP3    B$PS1$
         1 000361   200007 235100                    LDA     I,,AUTO
         1 000362   000105 101500                    MRL     fill='000'O
         1 000363   200015 000004                    ADSC9   SUDO,,AUTO               cn=0,n=4
         1 000364   300004 000001                    ADSC9   4,A,PR3                  cn=0,n=1

      217     2498    5                  END;

   2498  1 000365   200007 054100                    AOS     I,,AUTO
         1 000366   200007 236100                    LDQ     I,,AUTO
         1 000367   000000 116000 xsym               CMPQ    FR_SUMX
         1 000370   000335 604400 1                  TMOZ    s:2493

   2495  1 000371                       MBDZ         null
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:53   
      218     2499    4   MBDZ:       ;
      219     2500    4               CALL DPHYSM;

   2500  1 000371   002223 701000 1                  TSX1    DPHYSM
         1 000372   000000 011000                    NOP     0

      220     2501    4               CALL DSETSM;

   2501  1 000373   002703 701000 1                  TSX1    DSETSM
         1 000374   000000 011000                    NOP     0

      221     2502    4               END;

      222     2503    3            END;

   2503  1 000375   001437 710000 1                  TRA     CSEND

      223     2504    3         ELSE DO;

      224     2505    4            IF SYSID~=JG_MBS# THEN DO;

   2505  1 000376   200004 235100                    LDA     SYSID,,AUTO
         1 000377   000001 115007                    CMPA    1,DL
         1 000400   000404 600000 1                  TZE     s:2514

   2499  1 000401                       NOTAUTH      null
      225     2506    4   NOTAUTH:    ;
      226     2507    4               B$JIT.ERR=NAUTH;

   2507  1 000401   000004 236000 0                  LDQ     NAUTH
         1 000402   000012 756100                    STQ     10,,PR0

      227     2508           /*E*  ERROR:         FRP-E$NOTAUTH-A
      228     2509                  MESSAGE: M$MBS is not available to user programs!
      229     2510                 DESCRIPTION:   Only SYSTEM GHOSTS and CPs may issue M$MBS and
      230     2511                                except MBS, may only do the display form of the pmme    */
      231     2512    4               RETURN;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:54   

   2512  1 000403   000000 702200 xent               TSX2  ! X66_ARET

      232     2513    4               END;
      233     2514    3            SYSID=B$PS0$->VRCTL.SYSID;

   2514  1 000404   300001 236100                    LDQ     1,,PR3
         1 000405   777777 376007                    ANQ     -1,DL
         1 000406   200004 756100                    STQ     SYSID,,AUTO

      234     2515    3            MODE=%M_BATCH#;

   2515  1 000407   000001 235007                    LDA     1,DL
         1 000410   200005 755100                    STA     MODE,,AUTO

      235     2516    3            MEMORY=B$PS1$->RLST.MEMORY;

   2516  1 000411   000000 474400 xsym               LDP4    B$PS1$
         1 000412   400002 236100                    LDQ     2,,PR4
         1 000413   000022 772000                    QRL     18
         1 000414   200006 756100                    STQ     MEMORY,,AUTO

      236     2517    3            CALL SUCKM ALTRET (SUFAIL);

   2517  1 000415   002201 701000 1                  TSX1    SUCKM
         1 000416   000107 702000 1                  TSX2    SUFAIL

      237     2518    3            SUARAY=B$PS1$->RLST.SULST;

   2518  1 000417   000000 470400 xsym               LDP0    B$PS1$
         1 000420   000004 237100                    LDAQ    4,,PR0
         1 000421   200025 755100                    STA     SUARAY,,AUTO
         1 000422   200026 756100                    STQ     SUARAY+1,,AUTO

      238     2519    4            DO J=0 TO FR_SUMX;

   2519  1 000423   200010 450100                    STZ     J,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:55   
         1 000424   000432 710000 1                  TRA     s:2522+1

      239     2520    4               I=J;

   2520  1 000425   200010 235100                    LDA     J,,AUTO
         1 000426   200007 755100                    STA     I,,AUTO

      240     2521    4               CALL SUCHK ALTRET (SUFAIL);

   2521  1 000427   002134 701000 1                  TSX1    SUCHK
         1 000430   000107 702000 1                  TSX2    SUFAIL

      241     2522    4               END;

   2522  1 000431   200010 054100                    AOS     J,,AUTO
         1 000432   200010 236100                    LDQ     J,,AUTO
         1 000433   000000 116000 xsym               CMPQ    FR_SUMX
         1 000434   000425 604400 1                  TMOZ    s:2520

      242     2523    3            ARECX=1;

   2523  1 000435   000001 235007                    LDA     1,DL
         1 000436   200013 755100                    STA     ARECX,,AUTO

      243     2524    3            CALL ALLOC;

   2524  1 000437   001466 701000 1                  TSX1    ALLOC
         1 000440   000000 011000                    NOP     0

      244     2525    3            END;

   2525  1 000441   001437 710000 1                  TRA     CSEND

      245     2526        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:56   
      246     2527    2      CASE (%C$DISPRES#);

   2519  1 000442                       DISPRES      null
      247     2528    2   DISPRES: ;
      248     2529    2         CALL HFF$DSIZ (1,MAX);

   2529  1 000442   200012 630500                    EPPR0   MAX,,AUTO
         1 000443   200035 450500                    STP0    SUARAY+8,,AUTO
         1 000444   000000 236000 2                  LDQ     0
         1 000445   200034 756100                    STQ     SUARAY+7,,AUTO
         1 000446   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 000447   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 000450   000000 701000 xent               TSX1    HFF$DSIZ
         1 000451   000000 011000                    NOP     0

      249     2530    2         MAX=MAX-POFFC(ADDR(B$PS1$->VSU.PSLIST),ADDR(B$PS1$->VSU));

   2530  1 000452   000000 236000 xsym               LDQ     B$PS1$
         1 000453   000020 772000                    QRL     16
         1 000454   200034 756100                    STQ     SUARAY+7,,AUTO
         1 000455   000000 236000 xsym               LDQ     B$PS1$
         1 000456   000004 036003                    ADLQ    4,DU
         1 000457   000020 772000                    QRL     16
         1 000460   200034 136100                    SBLQ    SUARAY+7,,AUTO
         1 000461   200035 756100                    STQ     SUARAY+8,,AUTO
         1 000462   200012 236100                    LDQ     MAX,,AUTO
         1 000463   200035 136100                    SBLQ    SUARAY+8,,AUTO
         1 000464   200012 756100                    STQ     MAX,,AUTO

      250     2531    2         IF MAX<=0 THEN GOTO DPHY;

   2531  1 000465   000545 604400 1                  TMOZ    DPHY

      251     2532    2         MAX=MAX/SIZEC(B$PS1$->VSU.PSLIST(0));

   2532  1 000466   000014 506007                    DIV     12,DL
         1 000467   200012 756100                    STQ     MAX,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:57   

      252     2533    2         B$PS1$->VSU.FAILX=0;

   2533  1 000470   000000 470400 xsym               LDP0    B$PS1$
         1 000471   000001 450100                    STZ     1,,PR0

      253     2534    3         IF MAX<FR_SUMX+1 THEN DO;

   2534  1 000472   200012 236100                    LDQ     MAX,,AUTO
         1 000473   000000 116000 xsym               CMPQ    FR_SUMX
         1 000474   000504 605400 1                  TPNZ    s:2545

      254     2535    3            B$PS1$->VSU.FAILX=FR_SUMX+1;

   2535  1 000475   000000 235000 xsym               LDA     FR_SUMX
         1 000476   000001 035007                    ADLA    1,DL
         1 000477   000001 755100                    STA     1,,PR0

      255     2536    3            B$JIT.ERR=NORMRM;

   2536  1 000500   000001 236000 0                  LDQ     NORMRM
         1 000501   000000 471400 xsym               LDP1    B$JIT$
         1 000502   100012 756100                    STQ     10,,PR1

      256     2537           /*E*  ERROR:         FRP-E$NORMRM-E
      257     2538                  MESSAGE: Display area on M$DISPRES too small!
      258     2539                 MESSAGE1: One of the VLPs supplied on M$DISPRES is too small
      259     2540                           to hold all of the users resources.  The area that
      260     2541                           was supplied has been filled in and FAILX indicates
      261     2542                           how many entries were needed in the VLP in error.
      262     2543                 DESCRIPTION:   In this case VLP_PSEUDO was too small.                  */
      263     2544    3            END;

   2544  1 000503   000507 710000 1                  TRA     s:2546

      264     2545    2         ELSE MAX=FR_SUMX+1;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:58   
   2545  1 000504   000000 235000 xsym               LDA     FR_SUMX
         1 000505   000001 035007                    ADLA    1,DL
         1 000506   200012 755100                    STA     MAX,,AUTO

      265     2546    2         B$PS1$->VSU.NN=MAX;

   2546  1 000507   200012 236100                    LDQ     MAX,,AUTO
         1 000510   000000 756100                    STQ     0,,PR0

      266     2547    2         B$PS1$->VSU.MEMORY=B$JIT.RESCORE;

   2547  1 000511   000000 470400 xsym               LDP0    B$JIT$
         1 000512   000336 720100                    LXL0    222,,PR0
         1 000513   000000 471400 xsym               LDP1    B$PS1$
         1 000514   100002 740100                    STX0    2,,PR1

      267     2548    3         DO I=0 TO MAX-1;

   2548  1 000515   200007 450100                    STZ     I,,AUTO
         1 000516   000542 710000 1                  TRA     s:2551+1

      268     2549    3            B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(I);

   2549  1 000517   200007 236100                    LDQ     I,,AUTO
         1 000520   000003 402007                    MPY     3,DL
         1 000521   200007 235100                    LDA     I,,AUTO
         1 000522   000003 735000                    ALS     3
         1 000523   000002 736000                    QLS     2
         1 000524   000000 470400 xsym               LDP0    B$PS1$
         1 000525   040106 100405                    MLR     fill='040'O
         1 000526   000000 000010 xsym               ADSC9   FR_SUNM,A                cn=0,n=8
         1 000527   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8

      269     2550    3            B$PS1$->VSU.PSLIST.NUM(I)=B$JIT.CURSUDO(I);

   2550  1 000530   200007 236100                    LDQ     I,,AUTO
         1 000531   000003 402007                    MPY     3,DL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:59   
         1 000532   000002 736000                    QLS     2
         1 000533   000000 470400 xsym               LDP0    B$JIT$
         1 000534   200007 235100                    LDA     I,,AUTO
         1 000535   000000 471400 xsym               LDP1    B$PS1$
         1 000536   000106 100505                    MLR     fill='000'O
         1 000537   000334 000001                    ADSC9   220,A,PR0                cn=0,n=1
         1 000540   100006 000001                    ADSC9   6,Q,PR1                  cn=0,n=1

      270     2551    3            END;

   2551  1 000541   200007 054100                    AOS     I,,AUTO
         1 000542   200007 236100                    LDQ     I,,AUTO
         1 000543   200012 116100                    CMPQ    MAX,,AUTO
         1 000544   000517 604000 1                  TMI     s:2549

   2549  1 000545                       DPHY         null
      271     2552    2   DPHY: ;
      272     2553    2         CALL DPHYS;

   2553  1 000545   002226 701000 1                  TSX1    DPHYS
         1 000546   000000 011000                    NOP     0

   2549  1 000547                       DPSN         null
      273     2554    2   DPSN: ;
      274     2555    2         CALL DSETS;

   2555  1 000547   002706 701000 1                  TSX1    DSETS
         1 000550   000000 011000                    NOP     0
         1 000551   001437 710000 1                  TRA     CSEND

      275     2556        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:60   
      276     2557    2      CASE (%C$REQUIRE#);

      277     2558    3         DO I=0 TO B$PS1$->VSU.NN-1;

   2558  1 000552   200007 450100                    STZ     I,,AUTO
         1 000553   000620 710000 1                  TRA     NXTRQD+1

      278     2559    4            DO J=0 TO FR_SUMX;

   2559  1 000554   200010 450100                    STZ     J,,AUTO
         1 000555   000610 710000 1                  TRA     s:2574+1

      279     2560    5               IF B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(J) THEN DO;

   2560  1 000556   200007 236100                    LDQ     I,,AUTO
         1 000557   000014 402007                    MPY     12,DL
         1 000560   200010 235100                    LDA     J,,AUTO
         1 000561   000003 735000                    ALS     3
         1 000562   000000 470400 xsym               LDP0    B$PS1$
         1 000563   040005 106506                    CMPC    fill='040'O
         1 000564   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         1 000565   000000 000010 xsym               ADSC9   FR_SUNM,A                cn=0,n=8
         1 000566   000607 601000 1                  TNZ     s:2574

      280     2561    6                  IF B$JIT.CURSUDO(J)<B$PS1$->VSU.PSLIST.NUM(I) THEN DO;

   2561  1 000567   200007 236100                    LDQ     I,,AUTO
         1 000570   000003 402007                    MPY     3,DL
         1 000571   000006 236106                    LDQ     6,QL,PR0
         1 000572   000033 772000                    QRL     27
         1 000573   200034 756100                    STQ     SUARAY+7,,AUTO
         1 000574   000000 471400 xsym               LDP1    B$JIT$
         1 000575   200010 235100                    LDA     J,,AUTO
         1 000576   000100 101505                    MRL     fill='000'O
         1 000577   100334 000001                    ADSC9   220,A,PR1                cn=0,n=1
         1 000600   200035 000004                    ADSC9   SUARAY+8,,AUTO           cn=0,n=4
         1 000601   200035 236100                    LDQ     SUARAY+8,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:61   
         1 000602   200034 116100                    CMPQ    SUARAY+7,,AUTO
         1 000603   000617 605000 1                  TPL     NXTRQD

      281     2562    6                     B$JIT.ERR=NORQD;

   2562  1 000604   000005 236000 0                  LDQ     NORQD
         1 000605   100012 756100                    STQ     10,,PR1

      282     2563           /*E*  ERROR:         FRP-E$NORQ-A
      283     2564                  MESSAGE: You do not own required pseudo resources!
      284     2565                 MESSAGE1: The processor you are attempting to run requires that
      285     2566                           its users own certain pseudo resources.  These must
      286     2567                           be acquired via the !RES or !ORES command before the
      287     2568                           processor is invoked.
      288     2569                 DESCRIPTION:   Standard failure for M$REQUIRE pmme.                    */
      289     2570    6                     GOTO SUFAIL;

   2570  1 000606   000107 710000 1                  TRA     SUFAIL

      290     2571    6                     END;
      291     2572    5                  ELSE GOTO NXTRQD;
      292     2573    5                  END;
      293     2574    4               END;

   2574  1 000607   200010 054100                    AOS     J,,AUTO
         1 000610   200010 236100                    LDQ     J,,AUTO
         1 000611   000000 116000 xsym               CMPQ    FR_SUMX
         1 000612   000556 604400 1                  TMOZ    s:2560

      294     2575           /*E*  ERROR:         FRP-E$BSUNM-A
      295     2576                 DESCRIPTION:   In this case the severity of this error is abort
      296     2577                                since the calling processor presumably does not want
      297     2578                                to run the users program without the non-existent
      298     2579                                pseudo resource.                                        */
      299     2580    3            B$JIT.ERR=BSUNMX;

   2580  1 000613   000003 236000 0                  LDQ     BSUNMX
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:62   
         1 000614   000000 470400 xsym               LDP0    B$JIT$
         1 000615   000012 756100                    STQ     10,,PR0

      300     2581    3            GOTO SUFAIL;

   2581  1 000616   000107 710000 1                  TRA     SUFAIL

   2580  1 000617                       NXTRQD       null
      301     2582    3   NXTRQD:  ;
      302     2583    3            END;

   2583  1 000617   200007 054100                    AOS     I,,AUTO
         1 000620   000000 470400 xsym               LDP0    B$PS1$
         1 000621   200007 236100                    LDQ     I,,AUTO
         1 000622   000000 116100                    CMPQ    0,,PR0
         1 000623   000554 604000 1                  TMI     s:2559
         1 000624   001437 710000 1                  TRA     CSEND

      303     2584        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:63   
      304     2585    2      CASE (%C$RACST#);

      305     2586    3         IF MODE~=%M_BATCH# THEN DO;

   2586  1 000625   000001 116007                    CMPQ    1,DL
         1 000626   000702 600000 1                  TZE     s:2610

      306     2587    3            B$JIT.ARECX=1;

   2587  1 000627   000333 236100                    LDQ     219,,PR0
         1 000630   000034 376000 xsym               ANQ     B_VECTNIL+28
         1 000631   000001 276007                    ORQ     1,DL
         1 000632   000333 756100                    STQ     219,,PR0

      307     2588    3            MEMORY=B$JIT.RESCORE;

   2588  1 000633   000336 235100                    LDA     222,,PR0
         1 000634   200006 755100                    STA     MEMORY,,AUTO

      308     2589    3            IF MEMORY>FR_MEMM(MODE)-FR_MEMC(MODE)

   2589  1 000635   200005 720100                    LXL0    MODE,,AUTO
         1 000636   000000 236010 xsym               LDQ     FR_MEMM,X0
         1 000637   000000 136010 xsym               SBLQ    FR_MEMC,X0
         1 000640   200006 116100                    CMPQ    MEMORY,,AUTO
         1 000641   000645 605000 1                  TPL     s:2591

      309     2590    3            THEN MEMORY=FR_MEMM(MODE)-FR_MEMC(MODE);

   2590  1 000642   000000 236010 xsym               LDQ     FR_MEMM,X0
         1 000643   000000 136010 xsym               SBLQ    FR_MEMC,X0
         1 000644   200006 756100                    STQ     MEMORY,,AUTO

      310     2591    3            IF MEMORY>FR_MEMM(0)-FR_MEMC(0)

   2591  1 000645   000000 236000 xsym               LDQ     FR_MEMM
         1 000646   000000 136000 xsym               SBLQ    FR_MEMC
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:64   
         1 000647   200006 116100                    CMPQ    MEMORY,,AUTO
         1 000650   000654 605000 1                  TPL     s:2593

      311     2592    3            THEN MEMORY=FR_MEMM(0)-FR_MEMC(0);

   2592  1 000651   000000 236000 xsym               LDQ     FR_MEMM
         1 000652   000000 136000 xsym               SBLQ    FR_MEMC
         1 000653   200006 756100                    STQ     MEMORY,,AUTO

      312     2593    3            IF MEMORY<0 THEN MEMORY=0;

   2593  1 000654   200006 236100                    LDQ     MEMORY,,AUTO
         1 000655   000657 605000 1                  TPL     s:2594

   2593  1 000656   200006 450100                    STZ     MEMORY,,AUTO

      313     2594    3            FR_MEMC(MODE)=FR_MEMC(MODE)+MEMORY;

   2594  1 000657   000000 236010 xsym               LDQ     FR_MEMC,X0
         1 000660   200006 036100                    ADLQ    MEMORY,,AUTO
         1 000661   000000 756010 xsym               STQ     FR_MEMC,X0

      314     2595    3            FR_MEMC(0)=FR_MEMC(0)+MEMORY;

   2595  1 000662   000000 236000 xsym               LDQ     FR_MEMC
         1 000663   200006 036100                    ADLQ    MEMORY,,AUTO
         1 000664   000000 756000 xsym               STQ     FR_MEMC

      315     2596    4            IF MEMORY~=B$JIT.RESCORE THEN DO;

   2596  1 000665   200006 236100                    LDQ     MEMORY,,AUTO
         1 000666   000671 604000 1                  TMI     s:2597
         1 000667   000336 116100                    CMPQ    222,,PR0
         1 000670   000674 600000 1                  TZE     s:2606

      316     2597    4               B$JIT.RESCORE=MEMORY;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:65   
   2597  1 000671   000336 756100                    STQ     222,,PR0

      317     2598    4               B$JIT.ERR=LESMEM;

   2598  1 000672   000011 236000 0                  LDQ     LESMEM
         1 000673   000012 756100                    STQ     10,,PR0

      318     2599           /*E*  ERROR:         FRP-E$LESMEM-C
      319     2600                 DESCRIPTION:   This error is reported to LOGON when a non-batch
      320     2601                                user's authorized memory is more than is currently
      321     2602                                available.  B$JIT.RESCORE is changed to reflect
      322     2603                                the memory actually allocated.  LOGON should refuse
      323     2604                                to continue if the number is too small.               */
      324     2605    4               END;

      325     2606    3            B$JIT.MAXCORE=B$JIT.RESCORE;

   2606  1 000674   000336 721100                    LXL1    222,,PR0
         1 000675   000210 741100                    STX1    136,,PR0

      326     2607    3            CALL FRS$OPSTRS;

   2607  1 000676   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000677   000000 701000 xent               TSX1    FRS$OPSTRS
         1 000700   000000 011000                    NOP     0

      327     2608    3            END;

   2608  1 000701   000753 710000 1                  TRA     s:2627

      328     2609    3         ELSE DO;

      329     2610    3            CALL FRS$OPSTRS;

   2610  1 000702   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000703   000000 701000 xent               TSX1    FRS$OPSTRS
         1 000704   000000 011000                    NOP     0
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:66   

      330     2611    3            ARECX=1;

   2611  1 000705   000001 235007                    LDA     1,DL
         1 000706   200013 755100                    STA     ARECX,,AUTO

      331     2612    4            DO RCD=0 TO FR_NPOOL;

   2612  1 000707   200011 450100                    STZ     K,,AUTO

   2612  1 000710                       NXTRACCK     null
      332     2613    4   NXTRACCK:   ;
      333     2614    4               RAT$=FR$HD$(RCD);

   2614  1 000710   200011 720100                    LXL0    K,,AUTO
         1 000711   000000 236010 xsym               LDQ     FR$HD$,X0
         1 000712   200022 756100                    STQ     RAT$,,AUTO

      334     2615    5               DO WHILE (RAT$~=ADDR(NIL));

   2615  1 000713   000737 710000 1                  TRA     s:2623

      335     2616    6                  IF RAT.RES.SISID=SYSID AND RAT.RES.ACTX=0 THEN DO;

   2616  1 000714   200022 470500                    LDP0    RAT$,,AUTO
         1 000715   000001 236100                    LDQ     1,,PR0
         1 000716   000022 732000                    QRS     18
         1 000717   200004 116100                    CMPQ    SYSID,,AUTO
         1 000720   000735 601000 1                  TNZ     s:2622
         1 000721   000002 720100                    LXL0    2,,PR0
         1 000722   000735 601000 1                  TNZ     s:2622

      336     2617    6                     RAT.RES.ACTX=ARECX;

   2617  1 000723   200013 721100                    LXL1    ARECX,,AUTO
         1 000724   000002 441100                    SXL1    2,,PR0

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:67   
      337     2618    6                     CALL FRS$RESADD (RAT);

   2618  1 000725   200022 630500                    EPPR0   RAT$,,AUTO
         1 000726   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000727   000000 701000 xent               TSX1    FRS$RESADD
         1 000730   000000 011000                    NOP     0

      338     2619    6                     ARECX=ARECX+1;

   2619  1 000731   200013 235100                    LDA     ARECX,,AUTO
         1 000732   000001 035007                    ADLA    1,DL
         1 000733   200013 755100                    STA     ARECX,,AUTO

      339     2620    6                     GOTO NXTRACCK; /* START OVER, SOMETHING MAYBE MOVED */

   2620  1 000734   000710 710000 1                  TRA     NXTRACCK

      340     2621    6                     END;
      341     2622    5                  RAT$=RAT.LNK$;

   2622  1 000735   000000 236100                    LDQ     0,,PR0
         1 000736   200022 756100                    STQ     RAT$,,AUTO

      342     2623    5                  END;

   2623  1 000737   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 000740   000714 601000 1                  TNZ     s:2616

      343     2624    4               END;

   2624  1 000741   200011 235100                    LDA     K,,AUTO
         1 000742   000001 035007                    ADLA    1,DL
         1 000743   200011 755100                    STA     K,,AUTO
         1 000744   000003 115007                    CMPA    3,DL
         1 000745   000710 602000 1                  TNC     NXTRACCK

      344     2625    3            B$JIT.ARECX=ARECX;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:68   

   2625  1 000746   000000 470400 xsym               LDP0    B$JIT$
         1 000747   200013 236100                    LDQ     ARECX,,AUTO
         1 000750   000333 676100                    ERQ     219,,PR0
         1 000751   177777 376007                    ANQ     65535,DL
         1 000752   000333 656100                    ERSQ    219,,PR0

      345     2626    3            END;

      346     2627    2         CALL FRS$SUSTRT (B$JIT.CURSUDO);

   2627  1 000753   000000 236000 xsym               LDQ     B$JIT$
         1 000754   000334 036003                    ADLQ    220,DU
         1 000755   200034 756100                    STQ     SUARAY+7,,AUTO
         1 000756   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 000757   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 000760   000000 701000 xent               TSX1    FRS$SUSTRT
         1 000761   000000 011000                    NOP     0

      347     2628    2         CALL FRS$CLSTRS;

   2628  1 000762   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000763   000000 701000 xent               TSX1    FRS$CLSTRS
         1 000764   000000 011000                    NOP     0
         1 000765   001437 710000 1                  TRA     CSEND

      348     2629        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:69   
      349     2630    2      CASE (%C$RELRES#);

      350     2631    3         IF SYSID~=JG_SLUG# THEN DO;

   2631  1 000766   200004 235100                    LDA     SYSID,,AUTO
         1 000767   000001 115007                    CMPA    1,DL
         1 000770   000776 600000 1                  TZE     s:2635

      351     2632    3            CALL FRS$OPSTRS;

   2632  1 000771   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 000772   000000 701000 xent               TSX1    FRS$OPSTRS
         1 000773   000000 011000                    NOP     0

      352     2633    3            STRSOP=1;

   2633  1 000774   000001 235007                    LDA     1,DL
         1 000775   200014 755100                    STA     STRSOP,,AUTO

      353     2634    3            END;

      354     2635    2         CURRCORE=B$JIT.CURRCORE;

   2635  1 000776   000000 470400 xsym               LDP0    B$JIT$
         1 000777   000210 236100                    LDQ     136,,PR0
         1 001000   777777 376007                    ANQ     -1,DL
         1 001001   200012 756100                    STQ     MAX,,AUTO

      355     2636    2         IF CURRCORE<%MM_MINMEM# THEN CURRCORE=%MM_MINMEM#;

   2636  1 001002   000010 116007                    CMPQ    8,DL
         1 001003   001006 605000 1                  TPL     s:2637

   2636  1 001004   000010 235007                    LDA     8,DL
         1 001005   200012 755100                    STA     MAX,,AUTO

      356     2637    3         IF B$PS0$->VRCTL.RELALL THEN DO;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:70   

   2637  1 001006   000000 471400 xsym               LDP1    B$PS0$
         1 001007   100001 234100                    SZN     1,,PR1
         1 001010   001020 605000 1                  TPL     s:2642

      357     2638    3            CALL RELALL;

   2638  1 001011   002527 701000 1                  TSX1    RELALL
         1 001012   000000 011000                    NOP     0

      358     2639    3            IF B$JIT.ERR.CODE~=0 THEN GOTO DISPRES;

   2639  1 001013   000000 470400 xsym               LDP0    B$JIT$
         1 001014   000012 236100                    LDQ     10,,PR0
         1 001015   377770 316007                    CANQ    131064,DL
         1 001016   000442 601000 1                  TNZ     DISPRES

      359     2640    3            END;

   2640  1 001017   001437 710000 1                  TRA     CSEND

      360     2641    3         ELSE DO;

      361     2642    3            CALL HFF$NILERASE (1) ALTRET (RPHYS);

   2642  1 001020   000000 630400 2                  EPPR0   0
         1 001021   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001022   000000 701000 xent               TSX1    HFF$NILERASE
         1 001023   001225 702000 1                  TSX2    RPHYS

      362     2643    3            MEMORY=B$PS1$->VSU.MEMORY;

   2643  1 001024   000000 470400 xsym               LDP0    B$PS1$
         1 001025   000002 236100                    LDQ     2,,PR0
         1 001026   000022 772000                    QRL     18
         1 001027   200006 756100                    STQ     MEMORY,,AUTO

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:71   
      363     2644    4            IF MEMORY>B$JIT.RESCORE-CURRCORE THEN DO;

   2644  1 001030   000000 471400 xsym               LDP1    B$JIT$
         1 001031   100336 236100                    LDQ     222,,PR1
         1 001032   200012 136100                    SBLQ    MAX,,AUTO
         1 001033   200006 116100                    CMPQ    MEMORY,,AUTO
         1 001034   001054 605000 1                  TPL     s:2657

      364     2645    4               IF MEMORY>B$JIT.RESCORE THEN B$JIT.ERR=NALRL;

   2645  1 001035   100336 236100                    LDQ     222,,PR1
         1 001036   001044 604000 1                  TMI     s:2646
         1 001037   200006 116100                    CMPQ    MEMORY,,AUTO
         1 001040   001044 605000 1                  TPL     s:2646

   2645  1 001041   000006 236000 0                  LDQ     NALRL
         1 001042   100012 756100                    STQ     10,,PR1
         1 001043   001046 710000 1                  TRA     s:2655

      365     2646    4               ELSE B$JIT.ERR=NRLOP;

   2646  1 001044   000007 236000 0                  LDQ     NRLOP
         1 001045   100012 756100                    STQ     10,,PR1

      366     2647           /*E*  ERROR:         FRP-E$NOTUR-E
      367     2648                  MESSAGE: You tried to free resources you don't own!
      368     2649                 MESSAGE1: One or more of the resources you tried to free did
      369     2650                           not belong to you or you tried to free more than
      370     2651                           you owned.  The resources you did own have been
      371     2652                           freed as requested.
      372     2653                 DESCRIPTION:   This error is reported from various places in
      373     2654                                FRP$PMME.  In this case too much MEMory was freed.      */
      374     2655    4               MEMORY=MAXIMUM(B$JIT.RESCORE-CURRCORE,0);

   2655  1 001046   100336 236100                    LDQ     222,,PR1
         1 001047   200012 136100                    SBLQ    MAX,,AUTO
         1 001050   000000 116003                    CMPQ    0,DU
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:72   
         1 001051   001053 605000 1                  TPL     s:2655+5
         1 001052   000000 236003                    LDQ     0,DU
         1 001053   200006 756100                    STQ     MEMORY,,AUTO

      375     2656    4               END;

      376     2657    3            B$PS1$->VSU.MEMORY=B$PS1$->VSU.MEMORY-MEMORY;

   2657  1 001054   000002 236100                    LDQ     2,,PR0
         1 001055   000022 772000                    QRL     18
         1 001056   200006 136100                    SBLQ    MEMORY,,AUTO
         1 001057   000000 620006                    EAX0    0,QL
         1 001060   000002 740100                    STX0    2,,PR0

      377     2658    3            CALL RMEM;

   2658  1 001061   002377 701000 1                  TSX1    RMEM
         1 001062   000000 011000                    NOP     0

      378     2659    3            SUARAY='0'B;

   2659  1 001063   200025 450100                    STZ     SUARAY,,AUTO
         1 001064   200026 450100                    STZ     SUARAY+1,,AUTO

      379     2660    3            K=0;

   2660  1 001065   200011 450100                    STZ     K,,AUTO

      380     2661    4            DO I=0 TO B$PS1$->VSU.NN-1;

   2661  1 001066   200007 450100                    STZ     I,,AUTO
         1 001067   001214 710000 1                  TRA     NXTSUR+1

      381     2662    5               DO J=0 TO FR_SUMX;

   2662  1 001070   200010 450100                    STZ     J,,AUTO
         1 001071   001157 710000 1                  TRA     s:2677+1
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:73   

      382     2663    6                  IF B$PS1$->VSU.PSLIST.PSEUDO(I)=FR_SUNM(J) THEN DO;

   2663  1 001072   200007 236100                    LDQ     I,,AUTO
         1 001073   000014 402007                    MPY     12,DL
         1 001074   200010 235100                    LDA     J,,AUTO
         1 001075   000003 735000                    ALS     3
         1 001076   000000 470400 xsym               LDP0    B$PS1$
         1 001077   040005 106506                    CMPC    fill='040'O
         1 001100   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         1 001101   000000 000010 xsym               ADSC9   FR_SUNM,A                cn=0,n=8
         1 001102   001156 601000 1                  TNZ     s:2677

      383     2664    6                     SUDO=B$PS1$->VSU.PSLIST.NUM(I)+SUARAY(J);

   2664  1 001103   200010 235100                    LDA     J,,AUTO
         1 001104   000100 101505                    MRL     fill='000'O
         1 001105   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 001106   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 001107   200007 236100                    LDQ     I,,AUTO
         1 001110   000003 402007                    MPY     3,DL
         1 001111   000006 236106                    LDQ     6,QL,PR0
         1 001112   000033 772000                    QRL     27
         1 001113   200034 036100                    ADLQ    SUARAY+7,,AUTO
         1 001114   200015 756100                    STQ     SUDO,,AUTO

      384     2665    7                     IF SUDO>B$JIT.CURSUDO(J) THEN DO;

   2665  1 001115   000000 471400 xsym               LDP1    B$JIT$
         1 001116   200010 235100                    LDA     J,,AUTO
         1 001117   000100 101505                    MRL     fill='000'O
         1 001120   100334 000001                    ADSC9   220,A,PR1                cn=0,n=1
         1 001121   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 001122   200034 236100                    LDQ     SUARAY+7,,AUTO
         1 001123   200015 116100                    CMPQ    SUDO,,AUTO
         1 001124   001152 605000 1                  TPL     s:2674

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:74   
      385     2666    7                        B$PS1$->VSU.PSLIST.NUM(K)=SUDO-B$JIT.CURSUDO(J);

   2666  1 001125   200011 236100                    LDQ     K,,AUTO
         1 001126   000003 402007                    MPY     3,DL
         1 001127   200010 235100                    LDA     J,,AUTO
         1 001130   000100 101505                    MRL     fill='000'O
         1 001131   100334 000001                    ADSC9   220,A,PR1                cn=0,n=1
         1 001132   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 001133   000000 620006                    EAX0    0,QL
         1 001134   200015 236100                    LDQ     SUDO,,AUTO
         1 001135   200034 136100                    SBLQ    SUARAY+7,,AUTO
         1 001136   000033 736000                    QLS     27
         1 001137   000006 676110                    ERQ     6,X0,PR0
         1 001140   777000 376003                    ANQ     -512,DU
         1 001141   000006 656110                    ERSQ    6,X0,PR0

      386     2667    7                        SUARAY(J)=B$JIT.CURSUDO(J);

   2667  1 001142   000000 470400 xsym               LDP0    B$JIT$
         1 001143   200010 235100                    LDA     J,,AUTO
         1 001144   000105 100505                    MLR     fill='000'O
         1 001145   000334 000001                    ADSC9   220,A,PR0                cn=0,n=1
         1 001146   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1

      387     2668    7                        B$JIT.ERR=NALRL;

   2668  1 001147   000006 236000 0                  LDQ     NALRL
         1 001150   000012 756100                    STQ     10,,PR0

      388     2669           /*E*  ERROR:         FRP-E$NOTUR-E
      389     2670                 DESCRIPTION:   In this case an attempt to release more than the
      390     2671                                users owned pseudo resources was made                   */
      391     2672    7                        GOTO BADSU;

   2672  1 001151   001202 710000 1                  TRA     BADSU

      392     2673    7                        END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:75   
      393     2674    6                     SUARAY(J)=SUDO;

   2674  1 001152   000105 101500                    MRL     fill='000'O
         1 001153   200015 000004                    ADSC9   SUDO,,AUTO               cn=0,n=4
         1 001154   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1

      394     2675    6                     GOTO NXTSUR;

   2675  1 001155   001213 710000 1                  TRA     NXTSUR

      395     2676    6                     END;
      396     2677    5                  END;

   2677  1 001156   200010 054100                    AOS     J,,AUTO
         1 001157   200010 236100                    LDQ     J,,AUTO
         1 001160   000000 116000 xsym               CMPQ    FR_SUMX
         1 001161   001072 604400 1                  TMOZ    s:2663

      397     2678    4               IF B$JIT.ERR.CODE=0 THEN B$JIT.ERR=BSUNM;

   2678  1 001162   000000 470400 xsym               LDP0    B$JIT$
         1 001163   000012 236100                    LDQ     10,,PR0
         1 001164   377770 316007                    CANQ    131064,DL
         1 001165   001170 601000 1                  TNZ     s:2683

   2678  1 001166   000002 236000 0                  LDQ     BSUNM
         1 001167   000012 756100                    STQ     10,,PR0

      398     2679           /*E*  ERROR:         FRP-E$BSUNM-C
      399     2680                 DESCRIPTION:   In this case, a bad pseudo name was passed on an
      400     2681                                M$RELRES pmme.  This error is only reported if it
      401     2682                                is the most severe error on the M$RELRES.               */
      402     2683    4               B$PS1$->VSU.PSLIST.NUM(K)=B$PS1$->VSU.PSLIST.NUM(I);

   2683  1 001170   200011 236100                    LDQ     K,,AUTO
         1 001171   000003 402007                    MPY     3,DL
         1 001172   000000 620006                    EAX0    0,QL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:76   
         1 001173   200007 236100                    LDQ     I,,AUTO
         1 001174   000003 402007                    MPY     3,DL
         1 001175   000000 471400 xsym               LDP1    B$PS1$
         1 001176   100006 236106                    LDQ     6,QL,PR1
         1 001177   100006 676110                    ERQ     6,X0,PR1
         1 001200   777000 376003                    ANQ     -512,DU
         1 001201   100006 656110                    ERSQ    6,X0,PR1

   2683  1 001202                       BADSU        null
      403     2684    4   BADSU:      ;
      404     2685    4               B$PS1$->VSU.PSLIST.PSEUDO(K)=B$PS1$->VSU.PSLIST.PSEUDO(I);

   2685  1 001202   200007 236100                    LDQ     I,,AUTO
         1 001203   000014 402007                    MPY     12,DL
         1 001204   000000 635010                    EAA     0,X0
         1 001205   000020 731000                    ARS     16
         1 001206   000000 470400 xsym               LDP0    B$PS1$
         1 001207   040105 100506                    MLR     fill='040'O
         1 001210   000004 000010                    ADSC9   4,Q,PR0                  cn=0,n=8
         1 001211   000004 000010                    ADSC9   4,A,PR0                  cn=0,n=8

      405     2686    4               K=K+1;

   2686  1 001212   200011 054100                    AOS     K,,AUTO

   2686  1 001213                       NXTSUR       null
      406     2687    4   NXTSUR:     ;
      407     2688    4               END;

   2688  1 001213   200007 054100                    AOS     I,,AUTO
         1 001214   000000 470400 xsym               LDP0    B$PS1$
         1 001215   200007 236100                    LDQ     I,,AUTO
         1 001216   000000 116100                    CMPQ    0,,PR0
         1 001217   001070 604000 1                  TMI     s:2662

      408     2689    3            CALL RSUDO;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:77   
   2689  1 001220   002440 701000 1                  TSX1    RSUDO
         1 001221   000000 011000                    NOP     0

      409     2690    3            B$PS1$->VSU.NN=K;

   2690  1 001222   000000 470400 xsym               LDP0    B$PS1$
         1 001223   200011 235100                    LDA     K,,AUTO
         1 001224   000000 755100                    STA     0,,PR0

   2690  1 001225                       RPHYS        null
      410     2691    3   RPHYS:   ;
      411     2692    3            CALL HFF$NILERASE (2) ALTRET (RPSNS);

   2692  1 001225   000001 630400 2                  EPPR0   1
         1 001226   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001227   000000 701000 xent               TSX1    HFF$NILERASE
         1 001230   001365 702000 1                  TSX2    RPSNS

      412     2693    3            J=0;

   2693  1 001231   200010 450100                    STZ     J,,AUTO

      413     2694    4            DO I=0 TO B$PS2$->VPR.NN-1;

   2694  1 001232   200007 450100                    STZ     I,,AUTO
         1 001233   001357 710000 1                  TRA     NXTPRR+1

      414     2695    4               RTYP=B$PS2$->VPR.PRLIST.RNME.TYP(I);

   2695  1 001234   200007 235100                    LDA     I,,AUTO
         1 001235   000002 735000                    ALS     2
         1 001236   000000 470400 xsym               LDP0    B$PS2$
         1 001237   000002 220105                    LDX0    2,AL,PR0
         1 001240   200016 740100                    STX0    RTYP,,AUTO

      415     2696    4               RNUM=B$PS2$->VPR.PRLIST.RNME.NUM(I);

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:78   
   2696  1 001241   000002 721105                    LXL1    2,AL,PR0
         1 001242   200017 741100                    STX1    RNUM,,AUTO

      416     2697    4               IF RTYP='DP' THEN RCD=FR_DP;

   2697  1 001243   000013 100000 0                  CMPX0   NOMEM+1
         1 001244   001247 601000 1                  TNZ     s:2698

   2697  1 001245   200011 450100                    STZ     K,,AUTO
         1 001246   001264 710000 1                  TRA     s:2703

      417     2698    5               ELSE IF RTYP='MT' OR RTYP='LT' OR RTYP='FT' THEN DO;

   2698  1 001247   000014 100000 0                  CMPX0   NOMEM+2
         1 001250   001255 600000 1                  TZE     s:2699
         1 001251   000015 100000 0                  CMPX0   NOMEM+3
         1 001252   001255 600000 1                  TZE     s:2699
         1 001253   000016 100000 0                  CMPX0   NOMEM+4
         1 001254   001262 601000 1                  TNZ     s:2702

      418     2699    5                     RTYP='MT';

   2699  1 001255   000014 222000 0                  LDX2    NOMEM+2
         1 001256   200016 742100                    STX2    RTYP,,AUTO

      419     2700    5                     RCD=FR_MT;

   2700  1 001257   000001 236007                    LDQ     1,DL
         1 001260   200011 756100                    STQ     K,,AUTO

      420     2701    5                     END;

   2701  1 001261   001264 710000 1                  TRA     s:2703

      421     2702    4                  ELSE RCD=FR_NPOOL;

   2702  1 001262   000002 236007                    LDQ     2,DL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:79   
         1 001263   200011 756100                    STQ     K,,AUTO

      422     2703    4               RAT$=FR$HD$(RCD);

   2703  1 001264   200011 722100                    LXL2    K,,AUTO
         1 001265   000000 236012 xsym               LDQ     FR$HD$,X2
         1 001266   200022 756100                    STQ     RAT$,,AUTO

      423     2704    5               DO WHILE (RAT$~=ADDR(NIL));

   2704  1 001267   001331 710000 1                  TRA     s:2725

      424     2705    5                  IF RAT.RES.SISID=SYSID AND RAT.TYP=RTYP

   2705  1 001270   200022 470500                    LDP0    RAT$,,AUTO
         1 001271   000001 236100                    LDQ     1,,PR0
         1 001272   000022 732000                    QRS     18
         1 001273   200004 116100                    CMPQ    SYSID,,AUTO
         1 001274   001327 601000 1                  TNZ     s:2724
         1 001275   000010 220100                    LDX0    8,,PR0
         1 001276   200016 100100                    CMPX0   RTYP,,AUTO
         1 001277   001327 601000 1                  TNZ     s:2724
         1 001300   000001 721100                    LXL1    1,,PR0
         1 001301   200017 101100                    CMPX1   RNUM,,AUTO
         1 001302   001327 601000 1                  TNZ     s:2724

      425     2706    6                    AND RAT.RES.NUMB=RNUM THEN DO;

      426     2707    7                     IF RAT.FLG.OPN='0'B THEN DO;

   2707  1 001303   000010 236100                    LDQ     8,,PR0
         1 001304   000020 316007                    CANQ    16,DL
         1 001305   001323 601000 1                  TNZ     s:2713

      427     2708    7                        CALL FRS$RESSUB (RAT);

   2708  1 001306   200022 630500                    EPPR0   RAT$,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:80   
         1 001307   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001310   000000 701000 xent               TSX1    FRS$RESSUB
         1 001311   000000 011000                    NOP     0

      428     2709    7                        CALL FRZ$RRESNA (RAT,MODE);

   2709  1 001312   200005 630500                    EPPR0   MODE,,AUTO
         1 001313   200035 450500                    STP0    SUARAY+8,,AUTO
         1 001314   200022 236100                    LDQ     RAT$,,AUTO
         1 001315   200034 756100                    STQ     SUARAY+7,,AUTO
         1 001316   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 001317   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001320   000000 701000 xent               TSX1    FRZ$RRESNA
         1 001321   000000 011000                    NOP     0

      429     2710    7                        GOTO NXTPRR;

   2710  1 001322   001356 710000 1                  TRA     NXTPRR

      430     2711    7                        END;
      431     2712    7                     ELSE DO;

      432     2713    7                        B$JIT.ERR=NRLOP;

   2713  1 001323   000007 236000 0                  LDQ     NRLOP
         1 001324   000000 471400 xsym               LDP1    B$JIT$
         1 001325   100012 756100                    STQ     10,,PR1

      433     2714           /*E*  ERROR:         FRP-E$NRLOPN-E
      434     2715                  MESSAGE: You tried to release an in use resource!
      435     2716                 MESSAGE1: There is still a DCB open to the physical resource
      436     2717                           you are attempting to release.
      437     2718                 DESCRIPTION:   In this case the user specifically requested the
      438     2719                                release of a physical resource he still had a DCB
      439     2720                                open to.                                                */
      440     2721    7                        GOTO BADPR;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:81   
   2721  1 001326   001341 710000 1                  TRA     BADPR

      441     2722    7                        END;
      442     2723    6                     END;
      443     2724    5                  RAT$=RAT.LNK$;

   2724  1 001327   000000 236100                    LDQ     0,,PR0
         1 001330   200022 756100                    STQ     RAT$,,AUTO

      444     2725    5                  END;

   2725  1 001331   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 001332   001270 601000 1                  TNZ     s:2705

      445     2726    4               IF B$JIT.ERR~=NRLOP THEN B$JIT.ERR=NALRL;

   2726  1 001333   000000 470400 xsym               LDP0    B$JIT$
         1 001334   000012 236100                    LDQ     10,,PR0
         1 001335   000007 116000 0                  CMPQ    NRLOP
         1 001336   001341 600000 1                  TZE     BADPR

   2726  1 001337   000006 236000 0                  LDQ     NALRL
         1 001340   000012 756100                    STQ     10,,PR0

   2726  1 001341                       BADPR        null
      446     2727           /*E*  ERROR:         FRP-E$NOTUR-E
      447     2728                 DESCRIPTION:   In this case an un-owned physical resource had its
      448     2729                                release requested.  This error is only reported
      449     2730                                if not superseded by E$NRLOPN above.                   */
      450     2731    4   BADPR:      ;
      451     2732    4               B$PS2$->VPR.PRLIST.RNME.TYP(J)=B$PS2$->VPR.PRLIST.RNME.TYP(I);

   2732  1 001341   200010 235100                    LDA     J,,AUTO
         1 001342   000002 735000                    ALS     2
         1 001343   200007 236100                    LDQ     I,,AUTO
         1 001344   000002 736000                    QLS     2
         1 001345   000000 470400 xsym               LDP0    B$PS2$
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:82   
         1 001346   000002 220106                    LDX0    2,QL,PR0
         1 001347   000002 740105                    STX0    2,AL,PR0

      452     2733    4               B$PS2$->VPR.PRLIST.RNME.NUM(J)=RNUM;

   2733  1 001350   200010 235100                    LDA     J,,AUTO
         1 001351   000002 735000                    ALS     2
         1 001352   200017 220100                    LDX0    RNUM,,AUTO
         1 001353   000000 470400 xsym               LDP0    B$PS2$
         1 001354   000002 440105                    SXL0    2,AL,PR0

      453     2734    4               J=J+1;

   2734  1 001355   200010 054100                    AOS     J,,AUTO

   2734  1 001356                       NXTPRR       null
      454     2735    4   NXTPRR:     ;
      455     2736    4               END;

   2736  1 001356   200007 054100                    AOS     I,,AUTO
         1 001357   000000 470400 xsym               LDP0    B$PS2$
         1 001360   200007 236100                    LDQ     I,,AUTO
         1 001361   000000 116100                    CMPQ    0,,PR0
         1 001362   001234 604000 1                  TMI     s:2695

      456     2737    3            B$PS2$->VPR.NN=J;

   2737  1 001363   200010 235100                    LDA     J,,AUTO
         1 001364   000000 755100                    STA     0,,PR0

   2737  1 001365                       RPSNS        null
      457     2738    3   RPSNS:   ;
      458     2739    3            CALL HFF$NILERASE (3) ALTRET (CSEND);

   2739  1 001365   000002 630400 2                  EPPR0   2
         1 001366   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001367   000000 701000 xent               TSX1    HFF$NILERASE
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:83   
         1 001370   001437 702000 1                  TSX2    CSEND

      459     2740    3            K=0;

   2740  1 001371   200011 450100                    STZ     K,,AUTO

      460     2741    4            DO J=0 TO B$PS3$->VPS.NN-1;

   2741  1 001372   200010 450100                    STZ     J,,AUTO
         1 001373   001431 710000 1                  TRA     s:2752+1

      461     2742    4               P=B$PS3$->VPS.RPLIST(J);

   2742  1 001374   200010 235100                    LDA     J,,AUTO
         1 001375   000002 735000                    ALS     2
         1 001376   000000 470400 xsym               LDP0    B$PS3$
         1 001377   000002 237105                    LDAQ    2,AL,PR0
         1 001400   200020 757100                    STAQ    P,,AUTO

      462     2743    4               CALL FINDSET;

   2743  1 001401   003142 701000 1                  TSX1    FINDSET
         1 001402   000000 011000                    NOP     0

      463     2744    5               IF I=0 THEN DO;

   2744  1 001403   200007 235100                    LDA     I,,AUTO
         1 001404   001426 601000 1                  TNZ     s:2751

      464     2745    5                  IF B$JIT.ERR.CODE=0 THEN B$JIT.ERR=NALRL;

   2745  1 001405   000000 470400 xsym               LDP0    B$JIT$
         1 001406   000012 236100                    LDQ     10,,PR0
         1 001407   377770 316007                    CANQ    131064,DL
         1 001410   001413 601000 1                  TNZ     NORELPSN

   2745  1 001411   000006 236000 0                  LDQ     NALRL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:84   
         1 001412   000012 756100                    STQ     10,,PR0

   2745  1 001413                       NORELPSN     null
      465     2746    5   NORELPSN:      ;
      466     2747    5                  B$PS3$->VPS.RPLIST(K)=P;

   2747  1 001413   200011 235100                    LDA     K,,AUTO
         1 001414   000004 735000                    ALS     4
         1 001415   000000 470400 xsym               LDP0    B$PS3$
         1 001416   000105 100500                    MLR     fill='000'O
         1 001417   200020 000010                    ADSC9   P,,AUTO                  cn=0,n=8
         1 001420   000002 000020                    ADSC9   2,A,PR0                  cn=0,n=16

      467     2748    5                  K=K+1;

   2748  1 001421   200011 054100                    AOS     K,,AUTO

      468     2749    5                  CALL FMR$U8;

   2749  1 001422   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001423   000000 701000 xent               TSX1    FMR$U8
         1 001424   000000 011000                    NOP     0

      469     2750    5                  END;

   2750  1 001425   001430 710000 1                  TRA     s:2752

      470     2751    4               ELSE CALL RELSET ALTRET(NORELPSN);

   2751  1 001426   003174 701000 1                  TSX1    RELSET
         1 001427   001413 702000 1                  TSX2    NORELPSN

      471     2752    4               END;

   2752  1 001430   200010 054100                    AOS     J,,AUTO
         1 001431   000000 470400 xsym               LDP0    B$PS3$
         1 001432   200010 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:85   
         1 001433   000000 116100                    CMPQ    0,,PR0
         1 001434   001374 604000 1                  TMI     s:2742

      472     2753    3            B$PS3$->VPS.NN=K;

   2753  1 001435   200011 235100                    LDA     K,,AUTO
         1 001436   000000 755100                    STA     0,,PR0

      473     2754    3            END;

      474     2755    2      END;

   2752  1 001437                       CSEND        null
      475     2756    1   CSEND:;
      476     2757    1      IF STRSOP~=0 THEN CALL FRS$CLSTRS;

   2757  1 001437   200014 235100                    LDA     STRSOP,,AUTO
         1 001440   001444 600000 1                  TZE     s:2758

   2757  1 001441   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001442   000000 701000 xent               TSX1    FRS$CLSTRS
         1 001443   000000 011000                    NOP     0

      477     2758    1      RETURN;

   2758  1 001444   000000 702200 xent               TSX2  ! X66_ARET

      478     2759        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:86   
      479     2760           /**/
      480     2761    1   FRP$RLALL: ENTRY;

   2761  1 001445   000000 700200 xent  FRP$RLALL    TSX0  ! X66_AUTO_1
         1 001446   000042 000001                    ZERO    34,1

      481     2762           /**/
      482     2763    1      CALL SSS$BLOCK;

   2763  1 001447   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001450   000000 701000 xent               TSX1    SSS$BLOCK
         1 001451   000000 011000                    NOP     0

      483     2764    1      SYSID=B$JIT.SYSID;

   2764  1 001452   000000 470400 xsym               LDP0    B$JIT$
         1 001453   000000 236100                    LDQ     0,,PR0
         1 001454   777777 376007                    ANQ     -1,DL
         1 001455   200004 756100                    STQ     SYSID,,AUTO

      484     2765    1      MODE=B$JIT.MODE;

   2765  1 001456   000000 236100                    LDQ     0,,PR0
         1 001457   000040 772000                    QRL     32
         1 001460   200005 756100                    STQ     MODE,,AUTO

      485     2766    1      STRSOP=0;

   2766  1 001461   200014 450100                    STZ     STRSOP,,AUTO

      486     2767    1      CURRCORE=0;

   2767  1 001462   200012 450100                    STZ     MAX,,AUTO

      487     2768    1      CALL RELALL;

   2768  1 001463   002527 701000 1                  TSX1    RELALL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:87   
         1 001464   000000 011000                    NOP     0

      488     2769    1      RETURN;

   2769  1 001465   000000 702200 xent               TSX2  ! X66_ARET

      489     2770           /*S*  SCREECH_CODE:  FRP-S$NRNDWN
      490     2771                 TYPE:          Snap
      491     2772                 MESSAGE:       Resource released without being closed during logoff
      492     2773                 REMARKS:       When a user is being logged off, FRP$RLALL is called
      493     2774                                to release any resources he may own.  This screech
      494     2775                                occurs when resources are found that are still marked
      495     2776                                open.  This suggests a problem in running down users
      496     2777                                close, or resource management                           */
      497     2778           /**/
      498     2779        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:88   
      499     2780           /**/
      500     2781    1   ALLOC: PROC ALTRET;

   2781  1 001466   200030 741300       ALLOC        STX1  ! SUARAY+3,,AUTO

      501     2782           /**/
      502     2783    2      CALL HFF$NILERASE (3) ALTRET (PHYALOC);

   2783  1 001467   000002 630400 2                  EPPR0   2
         1 001470   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001471   000000 701000 xent               TSX1    HFF$NILERASE
         1 001472   001636 702000 1                  TSX2    PHYALOC

      503     2784    3      DO J=0 TO B$PS3$->VPS.NN-1;

   2784  1 001473   200010 450100                    STZ     J,,AUTO
         1 001474   001632 710000 1                  TRA     s:2808+1

      504     2785    3         P=B$PS3$->VPS.RPLIST(J);

   2785  1 001475   200010 235100                    LDA     J,,AUTO
         1 001476   000002 735000                    ALS     2
         1 001477   000000 470400 xsym               LDP0    B$PS3$
         1 001500   000002 237105                    LDAQ    2,AL,PR0
         1 001501   200020 757100                    STAQ    P,,AUTO

      505     2786    3         CALL FINDSET;

   2786  1 001502   003142 701000 1                  TSX1    FINDSET
         1 001503   000000 011000                    NOP     0

      506     2787    4         IF I=0 THEN DO;

   2787  1 001504   200007 235100                    LDA     I,,AUTO
         1 001505   001570 601000 1                  TNZ     s:2800

      507     2788    4            IF P.USAGE=SHARED# THEN GOTO NOGPSN;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:89   

   2788  1 001506   200021 236100                    LDQ     P+1,,AUTO
         1 001507   777000 376007                    ANQ     -512,DL
         1 001510   001000 116007                    CMPQ    512,DL
         1 001511   002063 600000 1                  TZE     NOGPSN

      508     2789    4            CALL FMR$GA(SETU$,I)ALTRET(NOGPSN);

   2789  1 001512   200007 630500                    EPPR0   I,,AUTO
         1 001513   200035 450500                    STP0    SUARAY+8,,AUTO
         1 001514   200022 631500                    EPPR1   RAT$,,AUTO
         1 001515   200034 451500                    STP1    SUARAY+7,,AUTO
         1 001516   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 001517   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001520   000000 701000 xent               TSX1    FMR$GA
         1 001521   002063 702000 1                  TSX2    NOGPSN

      509     2790    4            I=I/SIZEW(FM$SET(0));

   2790  1 001522   200007 236100                    LDQ     I,,AUTO
         1 001523   000010 506007                    DIV     8,DL
         1 001524   200007 756100                    STQ     I,,AUTO

      510     2791    4            FM$SET.PSN(I)=P.PSN;

   2791  1 001525   200007 235100                    LDA     I,,AUTO
         1 001526   000003 735000                    ALS     3
         1 001527   000002 735000                    ALS     2
         1 001530   000000 470400 xsym               LDP0    FM$SET$
         1 001531   040105 100500                    MLR     fill='040'O
         1 001532   200020 000006                    ADSC9   P,,AUTO                  cn=0,n=6
         1 001533   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6

      511     2792    4            FM$SET.XCL(I)='1'B;

   2792  1 001534   200007 235100                    LDA     I,,AUTO
         1 001535   000003 735000                    ALS     3
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:90   
         1 001536   000000 470400 xsym               LDP0    FM$SET$
         1 001537   400000 236003                    LDQ     -131072,DU
         1 001540   000002 256105                    ORSQ    2,AL,PR0

      512     2793    4            FM$SET.SYSID(I)=SYSID;

   2793  1 001541   200007 235100                    LDA     I,,AUTO
         1 001542   000003 735000                    ALS     3
         1 001543   200004 720100                    LXL0    SYSID,,AUTO
         1 001544   000000 470400 xsym               LDP0    FM$SET$
         1 001545   000002 440105                    SXL0    2,AL,PR0

      513     2794    4            FM$SET.ONEU(I)='1'B;

   2794  1 001546   200007 235100                    LDA     I,,AUTO
         1 001547   000003 735000                    ALS     3
         1 001550   000000 470400 xsym               LDP0    FM$SET$
         1 001551   000001 236003                    LDQ     1,DU
         1 001552   000002 256105                    ORSQ    2,AL,PR0

      514     2795    4            FM$SET.SETL(I)=FM$CFUX.SETH;

   2795  1 001553   200007 235100                    LDA     I,,AUTO
         1 001554   000003 735000                    ALS     3
         1 001555   000000 470400 xsym               LDP0    F$CFU$
         1 001556   000005 220100                    LDX0    5,,PR0
         1 001557   000000 471400 xsym               LDP1    FM$SET$
         1 001560   100005 740105                    STX0    5,AL,PR1

      515     2796    4            FM$CFUX.SETH=I;

   2796  1 001561   200007 720100                    LXL0    I,,AUTO
         1 001562   000000 470400 xsym               LDP0    F$CFU$
         1 001563   000005 740100                    STX0    5,,PR0

      516     2797    4            CALL FMR$U8;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:91   
   2797  1 001564   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001565   000000 701000 xent               TSX1    FMR$U8
         1 001566   000000 011000                    NOP     0

      517     2798    4            END;

   2798  1 001567   001631 710000 1                  TRA     s:2808

      518     2799    4         ELSE DO;

      519     2800    5            IF P.USAGE=SHARED# THEN DO;

   2800  1 001570   200021 236100                    LDQ     P+1,,AUTO
         1 001571   777000 376007                    ANQ     -512,DL
         1 001572   001000 116007                    CMPQ    512,DL
         1 001573   001604 601000 1                  TNZ     s:2803

      520     2801    5               IF FM$SET.XCL(I) OR NOT FM$SET.SET(I) THEN GOTO NOGPSN;

   2801  1 001574   000003 735000                    ALS     3
         1 001575   000000 470400 xsym               LDP0    FM$SET$
         1 001576   000002 234105                    SZN     2,AL,PR0
         1 001577   002063 604000 1                  TMI     NOGPSN
         1 001600   000002 236105                    LDQ     2,AL,PR0
         1 001601   200000 316003                    CANQ    65536,DU
         1 001602   002063 600000 1                  TZE     NOGPSN

      521     2802    5               END;

   2802  1 001603   001614 710000 1                  TRA     s:2805

      522     2803    4            ELSE IF FM$SET.SYSID(I)~=0 AND FM$SET.SYSID(I)~=SYSID

   2803  1 001604   000003 735000                    ALS     3
         1 001605   000000 470400 xsym               LDP0    FM$SET$
         1 001606   000002 720105                    LXL0    2,AL,PR0
         1 001607   001614 600000 1                  TZE     s:2805
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:92   
         1 001610   000002 236105                    LDQ     2,AL,PR0
         1 001611   777777 376007                    ANQ     -1,DL
         1 001612   200004 116100                    CMPQ    SYSID,,AUTO
         1 001613   002063 601000 1                  TNZ     NOGPSN

      523     2804    4               THEN GOTO NOGPSN;
      524     2805    4            CALL FMP$ULIST(FM$SET(I),SYSID) ALTRET(NOGPSN);

   2805  1 001614   200004 631500                    EPPR1   SYSID,,AUTO
         1 001615   200035 451500                    STP1    SUARAY+8,,AUTO
         1 001616   200007 236100                    LDQ     I,,AUTO
         1 001617   000025 736000                    QLS     21
         1 001620   000000 036000 xsym               ADLQ    FM$SET$
         1 001621   200034 756100                    STQ     SUARAY+7,,AUTO
         1 001622   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 001623   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 001624   000000 701000 xent               TSX1    FMP$ULIST
         1 001625   002063 702000 1                  TSX2    NOGPSN

      525     2806    4            CALL FMR$U8;

   2806  1 001626   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 001627   000000 701000 xent               TSX1    FMR$U8
         1 001630   000000 011000                    NOP     0

      526     2807    4            END;

      527     2808    3         END;

   2808  1 001631   200010 054100                    AOS     J,,AUTO
         1 001632   000000 470400 xsym               LDP0    B$PS3$
         1 001633   200010 236100                    LDQ     J,,AUTO
         1 001634   000000 116100                    CMPQ    0,,PR0
         1 001635   001475 604000 1                  TMI     s:2785

   2803  1 001636                       PHYALOC      null
      528     2809    2   PHYALOC:;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:93   
      529     2810    2      CALL HFF$NILERASE (2) ALTRET (SUALOC);

   2810  1 001636   000001 630400 2                  EPPR0   1
         1 001637   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001640   000000 701000 xent               TSX1    HFF$NILERASE
         1 001641   001760 702000 1                  TSX2    SUALOC

      530     2811    3      DO I=0 TO B$PS2$->VPR.NN-1;

   2811  1 001642   200007 450100                    STZ     I,,AUTO
         1 001643   001720 710000 1                  TRA     s:2821+1

      531     2812    3         CALL FRZ$GETRES (B$PS2$->VPR.PRLIST.RNME.TYP(I),B$PS2$->VPR.PRLIST.ATTR(I),
              2812                  SYSID,MODE,T$) ALTRET (NOGET);

   2812  1 001644   200024 630500                    EPPR0   T$,,AUTO
         1 001645   200040 450500                    STP0    SUARAY+11,,AUTO
         1 001646   200005 631500                    EPPR1   MODE,,AUTO
         1 001647   200037 451500                    STP1    SUARAY+10,,AUTO
         1 001650   200004 633500                    EPPR3   SYSID,,AUTO
         1 001651   200036 453500                    STP3    SUARAY+9,,AUTO
         1 001652   200007 236100                    LDQ     I,,AUTO
         1 001653   000024 736000                    QLS     20
         1 001654   000003 036000 2                  ADLQ    3
         1 001655   000000 036000 xsym               ADLQ    B$PS2$
         1 001656   200035 756100                    STQ     SUARAY+8,,AUTO
         1 001657   200007 236100                    LDQ     I,,AUTO
         1 001660   000024 736000                    QLS     20
         1 001661   000002 036003                    ADLQ    2,DU
         1 001662   000000 036000 xsym               ADLQ    B$PS2$
         1 001663   200034 756100                    STQ     SUARAY+7,,AUTO
         1 001664   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 001665   000023 631400 xsym               EPPR1   B_VECTNIL+19
         1 001666   000000 701000 xent               TSX1    FRZ$GETRES
         1 001667   002025 702000 1                  TSX2    NOGET

      532     2813    3         RAT$=T$;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:94   

   2813  1 001670   200024 236100                    LDQ     T$,,AUTO
         1 001671   200022 756100                    STQ     RAT$,,AUTO

      533     2814    3         B$PS2$->VPR.PRLIST.RAT$(I)=RAT$;

   2814  1 001672   200007 235100                    LDA     I,,AUTO
         1 001673   000002 735000                    ALS     2
         1 001674   000000 470400 xsym               LDP0    B$PS2$
         1 001675   000004 756105                    STQ     4,AL,PR0

      534     2815    3         RAT.RES.NUMB=B$PS2$->VPR.PRLIST.RNME.NUM(I);

   2815  1 001676   200007 235100                    LDA     I,,AUTO
         1 001677   000002 735000                    ALS     2
         1 001700   000000 470400 xsym               LDP0    B$PS2$
         1 001701   000002 720105                    LXL0    2,AL,PR0
         1 001702   200022 471500                    LDP1    RAT$,,AUTO
         1 001703   100001 440100                    SXL0    1,,PR1

      535     2816    4         IF STRSOP~=0 THEN DO;

   2816  1 001704   200014 235100                    LDA     STRSOP,,AUTO
         1 001705   001717 600000 1                  TZE     s:2821

      536     2817    4            RAT.RES.RFLG.NOSLD='1'B;

   2817  1 001706   200022 471500                    LDP1    RAT$,,AUTO
         1 001707   010000 236003                    LDQ     4096,DU
         1 001710   100003 256100                    ORSQ    3,,PR1

      537     2818    4            RAT.RES.ACTX=ARECX;

   2818  1 001711   200013 720100                    LXL0    ARECX,,AUTO
         1 001712   200022 471500                    LDP1    RAT$,,AUTO
         1 001713   100002 440100                    SXL0    2,,PR1

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:95   
      538     2819    4            ARECX=ARECX+1;

   2819  1 001714   200013 235100                    LDA     ARECX,,AUTO
         1 001715   000001 035007                    ADLA    1,DL
         1 001716   200013 755100                    STA     ARECX,,AUTO

      539     2820    4            END;

      540     2821    3         END;

   2821  1 001717   200007 054100                    AOS     I,,AUTO
         1 001720   000000 470400 xsym               LDP0    B$PS2$
         1 001721   200007 236100                    LDQ     I,,AUTO
         1 001722   000000 116100                    CMPQ    0,,PR0
         1 001723   001644 604000 1                  TMI     s:2812

      541     2822    3      IF STRSOP~=0 THEN DO J=0 TO B$PS2$->VPR.NN-1;

   2822  1 001724   200014 235100                    LDA     STRSOP,,AUTO
         1 001725   001760 600000 1                  TZE     SUALOC

   2822  1 001726   200010 450100                    STZ     J,,AUTO
         1 001727   001754 710000 1                  TRA     s:2827+1

      542     2823    3         RAT$=B$PS2$->VPR.PRLIST.RAT$(J);

   2823  1 001730   200010 235100                    LDA     J,,AUTO
         1 001731   000002 735000                    ALS     2
         1 001732   000000 470400 xsym               LDP0    B$PS2$
         1 001733   000004 236105                    LDQ     4,AL,PR0
         1 001734   200022 756100                    STQ     RAT$,,AUTO

      543     2824    3         IF RAT.TYP='MT' THEN B$JIT.OLTA='0'B;

   2824  1 001735   200022 471500                    LDP1    RAT$,,AUTO
         1 001736   100010 220100                    LDX0    8,,PR1
         1 001737   000014 100000 0                  CMPX0   NOMEM+2
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:96   
         1 001740   001744 601000 1                  TNZ     s:2825

   2824  1 001741   000000 473400 xsym               LDP3    B$JIT$
         1 001742   000004 236000 2                  LDQ     4
         1 001743   300333 356100                    ANSQ    219,,PR3

      544     2825    3         CALL FRS$RESADD (RAT);

   2825  1 001744   200022 630500                    EPPR0   RAT$,,AUTO
         1 001745   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 001746   000000 701000 xent               TSX1    FRS$RESADD
         1 001747   000000 011000                    NOP     0

      545     2826    3         RAT.RES.RFLG.NOSLD='0'B;

   2826  1 001750   200022 470500                    LDP0    RAT$,,AUTO
         1 001751   000005 236000 2                  LDQ     5
         1 001752   000003 356100                    ANSQ    3,,PR0

      546     2827    3         END;

   2827  1 001753   200010 054100                    AOS     J,,AUTO
         1 001754   000000 470400 xsym               LDP0    B$PS2$
         1 001755   200010 236100                    LDQ     J,,AUTO
         1 001756   000000 116100                    CMPQ    0,,PR0
         1 001757   001730 604000 1                  TMI     s:2823

   2826  1 001760                       SUALOC       null
      547     2828    2   SUALOC:;
      548     2829    2      FR_MEMC(MODE)=FR_MEMC(MODE)+MEMORY;

   2829  1 001760   200005 720100                    LXL0    MODE,,AUTO
         1 001761   000000 236010 xsym               LDQ     FR_MEMC,X0
         1 001762   200006 036100                    ADLQ    MEMORY,,AUTO
         1 001763   000000 756010 xsym               STQ     FR_MEMC,X0

      549     2830    2      FR_MEMC(0)=FR_MEMC(0)+MEMORY;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:97   

   2830  1 001764   000000 236000 xsym               LDQ     FR_MEMC
         1 001765   200006 036100                    ADLQ    MEMORY,,AUTO
         1 001766   000000 756000 xsym               STQ     FR_MEMC

      550     2831    3      IF SUARAY THEN DO I=0 TO FR_SUMX;

   2831  1 001767   000000 106500                    CMPC    fill='000'O
         1 001770   200025 000010                    ADSC9   SUARAY,,AUTO             cn=0,n=8
         1 001771   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 001772   002023 600000 1                  TZE     s:2835

   2831  1 001773   200007 450100                    STZ     I,,AUTO
         1 001774   002020 710000 1                  TRA     s:2834+1

      551     2832    3         FR_SUC$(MODE)->FR$SU(I)=FR_SUC$(MODE)->FR$SU(I)+SUARAY(I);

   2832  1 001775   200005 720100                    LXL0    MODE,,AUTO
         1 001776   000000 470410 xsym               LDP0    FR_SUC$,X0
         1 001777   200007 721100                    LXL1    I,,AUTO
         1 002000   200007 235100                    LDA     I,,AUTO
         1 002001   000100 101505                    MRL     fill='000'O
         1 002002   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 002003   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 002004   200034 236100                    LDQ     SUARAY+7,,AUTO
         1 002005   000000 036111                    ADLQ    0,X1,PR0
         1 002006   000000 756111                    STQ     0,X1,PR0

      552     2833    3         FR_SUCT(I)=FR_SUCT(I)+SUARAY(I);

   2833  1 002007   200007 720100                    LXL0    I,,AUTO
         1 002010   200007 235100                    LDA     I,,AUTO
         1 002011   000100 101505                    MRL     fill='000'O
         1 002012   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 002013   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 002014   200034 236100                    LDQ     SUARAY+7,,AUTO
         1 002015   000000 036010 xsym               ADLQ    FR_SUCT,X0
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:98   
         1 002016   000000 756010 xsym               STQ     FR_SUCT,X0

      553     2834    3         END;

   2834  1 002017   200007 054100                    AOS     I,,AUTO
         1 002020   200007 236100                    LDQ     I,,AUTO
         1 002021   000000 116000 xsym               CMPQ    FR_SUMX
         1 002022   001775 604400 1                  TMOZ    s:2832

      554     2835    2      RETURN;

   2835  1 002023   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002024   000001 702211                    TSX2  ! 1,X1

   2835  1 002025                       NOGET        null
      555     2836    2   NOGET:;
      556     2837    2      B$PS2$->VPR.FAILX=I;

   2837  1 002025   200007 235100                    LDA     I,,AUTO
         1 002026   000000 470400 xsym               LDP0    B$PS2$
         1 002027   000001 755100                    STA     1,,PR0

      557     2838    3      DO J=0 TO I-1;

   2838  1 002030   200010 450100                    STZ     J,,AUTO
         1 002031   002046 710000 1                  TRA     s:2840+1

      558     2839    3         CALL FRZ$RRESNA (B$PS2$->VPR.PRLIST.RAT$(J)->RAT,MODE);

   2839  1 002032   200010 235100                    LDA     J,,AUTO
         1 002033   000002 735000                    ALS     2
         1 002034   000000 470400 xsym               LDP0    B$PS2$
         1 002035   000004 471505                    LDP1    4,AL,PR0
         1 002036   200005 633500                    EPPR3   MODE,,AUTO
         1 002037   200035 453500                    STP3    SUARAY+8,,AUTO
         1 002040   200034 451500                    STP1    SUARAY+7,,AUTO
         1 002041   200034 630500                    EPPR0   SUARAY+7,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:99   
         1 002042   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002043   000000 701000 xent               TSX1    FRZ$RRESNA
         1 002044   000000 011000                    NOP     0

      559     2840    3         END;

   2840  1 002045   200010 054100                    AOS     J,,AUTO
         1 002046   200010 236100                    LDQ     J,,AUTO
         1 002047   200007 116100                    CMPQ    I,,AUTO
         1 002050   002032 604000 1                  TMI     s:2839

      560     2841    2      CALL HFF$NILERASE (3) ALTRET (ALLOCX);

   2841  1 002051   000002 630400 2                  EPPR0   2
         1 002052   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002053   000000 701000 xent               TSX1    HFF$NILERASE
         1 002054   002132 702000 1                  TSX2    ALLOCX

      561     2842    2      J=B$PS3$->VPS.NN;

   2842  1 002055   000000 470400 xsym               LDP0    B$PS3$
         1 002056   000000 235100                    LDA     0,,PR0
         1 002057   200010 755100                    STA     J,,AUTO

      562     2843    2      CALL FMR$L8;

   2843  1 002060   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002061   000000 701000 xent               TSX1    FMR$L8
         1 002062   000000 011000                    NOP     0

   2842  1 002063                       NOGPSN       null
      563     2844    2   NOGPSN:;
      564     2845    2      B$PS3$->VPS.FAILX=J;

   2845  1 002063   200010 235100                    LDA     J,,AUTO
         1 002064   000000 470400 xsym               LDP0    B$PS3$
         1 002065   000001 755100                    STA     1,,PR0
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:100  

      565     2846    2      IF J~=B$PS3$->VPS.NN THEN B$JIT.ERR=NOPSN;

   2846  1 002066   200010 236100                    LDQ     J,,AUTO
         1 002067   000000 116100                    CMPQ    0,,PR0
         1 002070   002074 600000 1                  TZE     s:2852

   2846  1 002071   000010 236000 0                  LDQ     NOPSN
         1 002072   000000 471400 xsym               LDP1    B$JIT$
         1 002073   100012 756100                    STQ     10,,PR1

      566     2847           /*E*  ERROR:         FRP-E$NODP-E
      567     2848                  MESSAGE: Packset usage incompatible with request.
      568     2849                 MESSAGE1: The packset request at VLP_RPSN.FAILX wants exclusive and
      569     2850                           the set is in use, or wants shared and it isn't.
      570     2851                 DESCRIPTION:   The request cannot be satisfied until something changes.*/
      571     2852    3      DO J=0 TO B$PS3$->VPS.FAILX-1;

   2852  1 002074   200010 450100                    STZ     J,,AUTO
         1 002075   002122 710000 1                  TRA     s:2856+1

      572     2853    3         P=B$PS3$->VPS.RPLIST(J);

   2853  1 002076   200010 235100                    LDA     J,,AUTO
         1 002077   000002 735000                    ALS     2
         1 002100   000000 470400 xsym               LDP0    B$PS3$
         1 002101   000002 237105                    LDAQ    2,AL,PR0
         1 002102   200020 757100                    STAQ    P,,AUTO

      573     2854    3         CALL FINDSET;

   2854  1 002103   003142 701000 1                  TSX1    FINDSET
         1 002104   000000 011000                    NOP     0

      574     2855    3         IF I~=0 THEN CALL FMP$UDLIST(FM$SET(I),SYSID);

   2855  1 002105   200007 235100                    LDA     I,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:101  
         1 002106   002121 600000 1                  TZE     s:2856

   2855  1 002107   200004 630500                    EPPR0   SYSID,,AUTO
         1 002110   200035 450500                    STP0    SUARAY+8,,AUTO
         1 002111   200007 236100                    LDQ     I,,AUTO
         1 002112   000025 736000                    QLS     21
         1 002113   000000 036000 xsym               ADLQ    FM$SET$
         1 002114   200034 756100                    STQ     SUARAY+7,,AUTO
         1 002115   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 002116   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002117   000000 701000 xent               TSX1    FMP$UDLIST
         1 002120   000000 011000                    NOP     0

      575     2856    3         END;

   2856  1 002121   200010 054100                    AOS     J,,AUTO
         1 002122   000000 470400 xsym               LDP0    B$PS3$
         1 002123   200010 236100                    LDQ     J,,AUTO
         1 002124   002076 604000 1                  TMI     s:2853
         1 002125   000001 116100                    CMPQ    1,,PR0
         1 002126   002076 602000 1                  TNC     s:2853

      576     2857    2      CALL FMR$U8;

   2857  1 002127   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002130   000000 701000 xent               TSX1    FMR$U8
         1 002131   000000 011000                    NOP     0

   2853  1 002132                       ALLOCX       null
      577     2858    2   ALLOCX:;
      578     2859    2      ALTRETURN;

   2859  1 002132   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002133   000000 702211                    TSX2  ! 0,X1

      579     2860    2   END;
      580     2861           /**/
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:102  
      581     2862        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:103  
      582     2863           /**/
      583     2864    1   SUCHK: PROC ALTRET;

   2864  1 002134   200030 741300       SUCHK        STX1  ! SUARAY+3,,AUTO

      584     2865           /**/
      585     2866    2      IF SUARAY(J)=0

   2866  1 002135   200010 235100                    LDA     J,,AUTO
         1 002136   000100 101505                    MRL     fill='000'O
         1 002137   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 002140   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 002141   200034 236100                    LDQ     SUARAY+7,,AUTO
         1 002142   000000 116003                    CMPQ    0,DU
         1 002143   002173 600000 1                  TZE     s:2869
         1 002144   200010 720100                    LXL0    J,,AUTO
         1 002145   000000 236010 xsym               LDQ     FR_SUMT,X0
         1 002146   000000 136005 xsym               SBLQ    FR_SUCT,AL
         1 002147   200035 756100                    STQ     SUARAY+8,,AUTO
         1 002150   200010 235100                    LDA     J,,AUTO
         1 002151   000100 101505                    MRL     fill='000'O
         1 002152   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 002153   200036 000004                    ADSC9   SUARAY+9,,AUTO           cn=0,n=4
         1 002154   200036 236100                    LDQ     SUARAY+9,,AUTO
         1 002155   200035 116100                    CMPQ    SUARAY+8,,AUTO
         1 002156   002174 605400 1                  TPNZ    SUF
         1 002157   200005 722100                    LXL2    MODE,,AUTO
         1 002160   000000 470412 xsym               LDP0    FR_SUM$,X2
         1 002161   000000 471412 xsym               LDP1    FR_SUC$,X2
         1 002162   000000 236110                    LDQ     0,X0,PR0
         1 002163   100000 136110                    SBLQ    0,X0,PR1
         1 002164   200037 756100                    STQ     SUARAY+10,,AUTO
         1 002165   000100 101505                    MRL     fill='000'O
         1 002166   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 002167   200040 000004                    ADSC9   SUARAY+11,,AUTO          cn=0,n=4
         1 002170   200040 236100                    LDQ     SUARAY+11,,AUTO
         1 002171   200037 116100                    CMPQ    SUARAY+10,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:104  
         1 002172   002174 605400 1                  TPNZ    SUF

      586     2867    2        OR SUARAY(J)<=FR_SUMT(J)-FR_SUCT(J)
      587     2868    2        AND SUARAY(J)<=FR_SUM$(MODE)->FR$SU(J)-FR_SUC$(MODE)->FR$SU(J)
      588     2869    2      THEN RETURN;

   2869  1 002173   000001 702211                    TSX2  ! 1,X1

   2869  1 002174                       SUF          null
      589     2870    2   SUF: ;
      590     2871    2      B$JIT.ERR=NOMOS;

   2871  1 002174   000000 236000 0                  LDQ     NOMOS
         1 002175   000000 470400 xsym               LDP0    B$JIT$
         1 002176   000012 756100                    STQ     10,,PR0

      591     2872           /*E*  ERROR:         FRP-E$SUOUT-E
      592     2873                  MESSAGE: The pseudo resources you requested are not available.
      593     2874                 MESSAGE1: Granting your request for pseudo resources would
      594     2875                           cause the total in use on the system or the total
      595     2876                           in use for your mode (e.g. online) to exceed the maximum.
      596     2877                 MESSAGE2: The system manager sets maxima for the number
      597     2878                           of each pseudo resource that can be allocated
      598     2879                           and for the number that any mode can own.  Your
      599     2880                           request would exceed one or both of these.  If
      600     2881                           you are not requesting more than is legal, try
      601     2882                           again later after someone has released enough.
      602     2883                 DESCRIPTION:   He wants more than he can have now.                     */
      603     2884    2      ALTRETURN;

   2884  1 002177   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002200   000000 702211                    TSX2  ! 0,X1

      604     2885           /**/
      605     2886    2   SUCKM: ENTRY ALTRET;

   2886  1 002201   200030 741300       SUCKM        STX1  ! SUARAY+3,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:105  

      606     2887           /**/
      607     2888    2      IF MEMORY<=FR_MEMM(0)-FR_MEMC(0)

   2888  1 002202   000000 236000 xsym               LDQ     FR_MEMM
         1 002203   000000 136000 xsym               SBLQ    FR_MEMC
         1 002204   200006 116100                    CMPQ    MEMORY,,AUTO
         1 002205   002214 604000 1                  TMI     s:2890
         1 002206   200005 720100                    LXL0    MODE,,AUTO
         1 002207   000000 236010 xsym               LDQ     FR_MEMM,X0
         1 002210   000000 136010 xsym               SBLQ    FR_MEMC,X0
         1 002211   200006 116100                    CMPQ    MEMORY,,AUTO
         1 002212   002214 604000 1                  TMI     s:2890

      608     2889    2        AND MEMORY<=FR_MEMM(MODE)-FR_MEMC(MODE) THEN RETURN;

   2889  1 002213   000001 702211                    TSX2  ! 1,X1

      609     2890    2      I=-1;

   2890  1 002214   000001 335007                    LCA     1,DL
         1 002215   200007 755100                    STA     I,,AUTO

      610     2891    2      B$JIT.ERR=NOMEM;

   2891  1 002216   000012 236000 0                  LDQ     NOMEM
         1 002217   000000 470400 xsym               LDP0    B$JIT$
         1 002220   000012 756100                    STQ     10,,PR0

      611     2892           /*E*  ERROR:         FRP-E$LESMEM-E
      612     2893                  MESSAGE: The memory you requested is not available.
      613     2894                 MESSAGE1: The system maximum or the maximum for your mode
      614     2895                           would be exceeded by your request for more memory.         */
      615     2896    2      ALTRETURN;

   2896  1 002221   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002222   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:106  

      616     2897    2   END;
      617     2898           /**/
      618     2899        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:107  
      619     2900           /**/
      620     2901    1   DPHYSM: PROC;

   2901  1 002223   200030 741300       DPHYSM       STX1  ! SUARAY+3,,AUTO

      621     2902           /**/
      622     2903    2      SYSID=0;

   2903  1 002224   200004 450100                    STZ     SYSID,,AUTO
         1 002225   002227 710000 1                  TRA     s:2907

      623     2904           /**/
      624     2905    2   DPHYS: ENTRY;

   2905  1 002226   200030 741300       DPHYS        STX1  ! SUARAY+3,,AUTO

      625     2906           /**/
      626     2907    2      CALL HFF$DSIZ (2,MAX);

   2907  1 002227   200012 630500                    EPPR0   MAX,,AUTO
         1 002230   200035 450500                    STP0    SUARAY+8,,AUTO
         1 002231   000001 236000 2                  LDQ     1
         1 002232   200034 756100                    STQ     SUARAY+7,,AUTO
         1 002233   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 002234   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002235   000000 701000 xent               TSX1    HFF$DSIZ
         1 002236   000000 011000                    NOP     0

      627     2908    2      MAX=MAX-POFFC(ADDR(B$PS2$->VPR.PRLIST),ADDR(B$PS2$->VPR));

   2908  1 002237   000000 236000 xsym               LDQ     B$PS2$
         1 002240   000020 772000                    QRL     16
         1 002241   200034 756100                    STQ     SUARAY+7,,AUTO
         1 002242   000000 236000 xsym               LDQ     B$PS2$
         1 002243   000002 036003                    ADLQ    2,DU
         1 002244   000020 772000                    QRL     16
         1 002245   200034 136100                    SBLQ    SUARAY+7,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:108  
         1 002246   200035 756100                    STQ     SUARAY+8,,AUTO
         1 002247   200012 236100                    LDQ     MAX,,AUTO
         1 002250   200035 136100                    SBLQ    SUARAY+8,,AUTO
         1 002251   200012 756100                    STQ     MAX,,AUTO

      628     2909    2      IF MAX<=0 THEN RETURN;

   2909  1 002252   002255 605400 1                  TPNZ    s:2910

   2909  1 002253   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002254   000001 702211                    TSX2  ! 1,X1

      629     2910    2      MAX=MAX/SIZEC(B$PS2$->VPR.PRLIST(0));

   2910  1 002255   000020 506007                    DIV     16,DL
         1 002256   200012 756100                    STQ     MAX,,AUTO

      630     2911    2      B$PS2$->VPR.FAILX=0;

   2911  1 002257   000000 470400 xsym               LDP0    B$PS2$
         1 002260   000001 450100                    STZ     1,,PR0

      631     2912    2      B$PS2$->VPR.NN=MAX;

   2912  1 002261   200012 235100                    LDA     MAX,,AUTO
         1 002262   000000 755100                    STA     0,,PR0

      632     2913    2      I=0;

   2913  1 002263   200007 450100                    STZ     I,,AUTO

      633     2914    3      DO RCD=0 TO FR_NPOOL;

   2914  1 002264   200011 450100                    STZ     K,,AUTO

      634     2915    3         RAT$=FR$HD$(RCD);

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:109  
   2915  1 002265   200011 720100                    LXL0    K,,AUTO
         1 002266   000000 236010 xsym               LDQ     FR$HD$,X0
         1 002267   200022 756100                    STQ     RAT$,,AUTO

      635     2916    4         DO WHILE (RAT$~=ADDR(NIL));

   2916  1 002270   002361 710000 1                  TRA     s:2938

      636     2917    5            IF SYSID<0 OR RAT.RES.SISID=SYSID THEN DO;

   2917  1 002271   200004 235100                    LDA     SYSID,,AUTO
         1 002272   002300 604000 1                  TMI     s:2918
         1 002273   200022 470500                    LDP0    RAT$,,AUTO
         1 002274   000001 236100                    LDQ     1,,PR0
         1 002275   000022 732000                    QRS     18
         1 002276   200004 116100                    CMPQ    SYSID,,AUTO
         1 002277   002356 601000 1                  TNZ     s:2937

      637     2918    6               IF I>=MAX THEN DO;

   2918  1 002300   200007 236100                    LDQ     I,,AUTO
         1 002301   200012 116100                    CMPQ    MAX,,AUTO
         1 002302   002312 604000 1                  TMI     s:2925

      638     2919    6                  B$PS2$->VPR.FAILX=I+1;

   2919  1 002303   000001 036007                    ADLQ    1,DL
         1 002304   000000 470400 xsym               LDP0    B$PS2$
         1 002305   000001 756100                    STQ     1,,PR0

      639     2920    6                  B$JIT.ERR=NORMRM;

   2920  1 002306   000001 236000 0                  LDQ     NORMRM
         1 002307   000000 471400 xsym               LDP1    B$JIT$
         1 002310   100012 756100                    STQ     10,,PR1

      640     2921           /*E*  ERROR:         FRP-E$NORMRM-E
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:110  
      641     2922                 DESCRIPTION:   In this case the users physical resources won't fit.     */
      642     2923    6                  GOTO DPHYS1;

   2923  1 002311   002355 710000 1                  TRA     DPHYS1

      643     2924    6                  END;
      644     2925    5               B$PS2$->VPR.PRLIST.RNME.TYP(I)=RAT.TYP;

   2925  1 002312   200007 235100                    LDA     I,,AUTO
         1 002313   000002 735000                    ALS     2
         1 002314   200022 470500                    LDP0    RAT$,,AUTO
         1 002315   000010 220100                    LDX0    8,,PR0
         1 002316   000000 471400 xsym               LDP1    B$PS2$
         1 002317   100002 740105                    STX0    2,AL,PR1

      645     2926    6               IF SYSID<=0 THEN DO;

   2926  1 002320   200004 235100                    LDA     SYSID,,AUTO
         1 002321   002341 605400 1                  TPNZ    s:2931

      646     2927    6                  IF RAT.FLG.DOWN AND SYSID=0 THEN I=I-1;

   2927  1 002322   200022 470500                    LDP0    RAT$,,AUTO
         1 002323   000010 236100                    LDQ     8,,PR0
         1 002324   000002 316007                    CANQ    2,DL
         1 002325   002333 600000 1                  TZE     s:2928
         1 002326   000000 115003                    CMPA    0,DU
         1 002327   002333 601000 1                  TNZ     s:2928

   2927  1 002330   000001 336007                    LCQ     1,DL
         1 002331   200007 056100                    ASQ     I,,AUTO
         1 002332   002355 710000 1                  TRA     DPHYS1

      647     2928    6                  ELSE B$PS2$->VPR.PRLIST.ATTR(I)=RAT.M1;

   2928  1 002333   200007 235100                    LDA     I,,AUTO
         1 002334   000002 735000                    ALS     2
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:111  
         1 002335   000006 220100                    LDX0    6,,PR0
         1 002336   000000 471400 xsym               LDP1    B$PS2$
         1 002337   100003 440105                    SXL0    3,AL,PR1

      648     2929    6                  END;

   2929  1 002340   002355 710000 1                  TRA     DPHYS1

      649     2930    6               ELSE DO;

      650     2931    6                  B$PS2$->VPR.PRLIST.RNME.NUM(I)=RAT.RES.NUMB;

   2931  1 002341   200007 236100                    LDQ     I,,AUTO
         1 002342   000002 736000                    QLS     2
         1 002343   200022 470500                    LDP0    RAT$,,AUTO
         1 002344   000001 720100                    LXL0    1,,PR0
         1 002345   000000 471400 xsym               LDP1    B$PS2$
         1 002346   100002 440106                    SXL0    2,QL,PR1

      651     2932    6                  B$PS2$->VPR.PRLIST.ATTR(I)=RAT.RES.M2;

   2932  1 002347   200007 235100                    LDA     I,,AUTO
         1 002350   000002 735000                    ALS     2
         1 002351   200022 470500                    LDP0    RAT$,,AUTO
         1 002352   000002 220100                    LDX0    2,,PR0
         1 002353   000000 471400 xsym               LDP1    B$PS2$
         1 002354   100003 440105                    SXL0    3,AL,PR1

      652     2933    6                  END;

   2931  1 002355                       DPHYS1       null
      653     2934    5   DPHYS1:     ;
      654     2935    5               I=I+1;

   2935  1 002355   200007 054100                    AOS     I,,AUTO

      655     2936    5               END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:112  

      656     2937    4            RAT$=RAT$->RAT.LNK$;

   2937  1 002356   200022 470500                    LDP0    RAT$,,AUTO
         1 002357   000000 236100                    LDQ     0,,PR0
         1 002360   200022 756100                    STQ     RAT$,,AUTO

      657     2938    4            END;

   2938  1 002361   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002362   002271 601000 1                  TNZ     s:2917

      658     2939    3         END;

   2939  1 002363   200011 235100                    LDA     K,,AUTO
         1 002364   000001 035007                    ADLA    1,DL
         1 002365   200011 755100                    STA     K,,AUTO
         1 002366   000003 115007                    CMPA    3,DL
         1 002367   002265 602000 1                  TNC     s:2915

      659     2940    2      IF I<MAX THEN B$PS2$->VPR.NN=I;

   2940  1 002370   200007 236100                    LDQ     I,,AUTO
         1 002371   200012 116100                    CMPQ    MAX,,AUTO
         1 002372   002375 605000 1                  TPL     s:2941

   2940  1 002373   000000 470400 xsym               LDP0    B$PS2$
         1 002374   000000 756100                    STQ     0,,PR0

      660     2941    2      RETURN;

   2941  1 002375   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002376   000001 702211                    TSX2  ! 1,X1

      661     2942    2   END;
      662     2943           /**/
      663     2944        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:113  
      664     2945           /**/
      665     2946    1   RMEM: PROC;

   2946  1 002377   200032 741300       RMEM         STX1  ! SUARAY+5,,AUTO

      666     2947    3      IF MODE=%M_BATCH# OR B$JIT.ARECX~=0 THEN DO;

   2947  1 002400   200005 235100                    LDA     MODE,,AUTO
         1 002401   000001 115007                    CMPA    1,DL
         1 002402   002407 600000 1                  TZE     s:2948
         1 002403   000000 470400 xsym               LDP0    B$JIT$
         1 002404   000333 236100                    LDQ     219,,PR0
         1 002405   177777 316007                    CANQ    65535,DL
         1 002406   002423 600000 1                  TZE     s:2952

      667     2948    3         FR_MEMC(MODE)=FR_MEMC(MODE)-MEMORY;

   2948  1 002407   000000 236005 xsym               LDQ     FR_MEMC,AL
         1 002410   200006 136100                    SBLQ    MEMORY,,AUTO
         1 002411   200005 720100                    LXL0    MODE,,AUTO
         1 002412   000000 756010 xsym               STQ     FR_MEMC,X0

      668     2949    3         FR_MEMC(0)=FR_MEMC(0)-MEMORY;

   2949  1 002413   000000 236000 xsym               LDQ     FR_MEMC
         1 002414   200006 136100                    SBLQ    MEMORY,,AUTO
         1 002415   000000 756000 xsym               STQ     FR_MEMC

      669     2950    3         IF FR_MEMC(0)<0 OR FR_MEMC(MODE)<0 THEN CALL SC_R2MANY;

   2950  1 002416   002421 604000 1                  TMI     s:2950+3
         1 002417   000000 235010 xsym               LDA     FR_MEMC,X0
         1 002420   002423 605000 1                  TPL     s:2952

   2950  1 002421   000000 713400 xsym               CLIMB   SC_R2MANY
         1 002422   000000 600000 xsid               climb   nvectors=         0

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:114  
      670     2951    3         END;

      671     2952    2      B$JIT.RESCORE=B$JIT.RESCORE-MEMORY;

   2952  1 002423   000000 470400 xsym               LDP0    B$JIT$
         1 002424   000336 236100                    LDQ     222,,PR0
         1 002425   200006 136100                    SBLQ    MEMORY,,AUTO
         1 002426   000336 756100                    STQ     222,,PR0

      672     2953    2      IF B$JIT.MAXCORE>B$JIT.RESCORE THEN B$JIT.MAXCORE=B$JIT.RESCORE;

   2953  1 002427   000210 236100                    LDQ     136,,PR0
         1 002430   000022 772000                    QRL     18
         1 002431   000336 116100                    CMPQ    222,,PR0
         1 002432   002436 602000 1                  TNC     s:2954
         1 002433   002436 600000 1                  TZE     s:2954

   2953  1 002434   000336 720100                    LXL0    222,,PR0
         1 002435   000210 740100                    STX0    136,,PR0

      673     2954    2      RETURN;

   2954  1 002436   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 002437   000001 702211                    TSX2  ! 1,X1

      674     2955           /**/
      675     2956           /**/
      676     2957           /*S*  SCREECH_CODE:  FRP-S$R2MANY
      677     2958                 TYPE:          Screech
      678     2959                 MESSAGE:       More resources released than were ever allocated
      679     2960                 REMARKS:       *THIS IS THE BUDDY DOEPPEL MEMORIAL SCREECH*
      680     2961                                This screech occurs when the "currently allocated"
      681     2962                                count for a resource goes negative.  The screech is
      682     2963                                done for memory directly above and for pseudos
      683     2964                                directly below this comment.  For physical resources
      684     2965                                the same screech is reported by FRZ$RRES as FRZ-S$R2MANY
      685     2966                                This screech occurs as a result of resource
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:115  
      686     2967                                management bugs or possibly a malicious user with
      687     2968                                JIT or monitor access has changed some numbers          */
      688     2969           /**/
      689     2970           /**/
      690     2971    2   RSUDO: ENTRY;

   2971  1 002440   200032 741300       RSUDO        STX1  ! SUARAY+5,,AUTO

      691     2972           /**/
      692     2973    3      DO J=0 TO FR_SUMX;

   2973  1 002441   200010 450100                    STZ     J,,AUTO
         1 002442   002506 710000 1                  TRA     s:2982+1

      693     2974    3         SUDO=SUARAY(J);

   2974  1 002443   200010 235100                    LDA     J,,AUTO
         1 002444   000100 101505                    MRL     fill='000'O
         1 002445   200025 000001                    ADSC9   SUARAY,A,AUTO            cn=0,n=1
         1 002446   200015 000004                    ADSC9   SUDO,,AUTO               cn=0,n=4

      694     2975    4         IF SUDO~=0 THEN DO;

   2975  1 002447   200015 236100                    LDQ     SUDO,,AUTO
         1 002450   002505 600000 1                  TZE     s:2982

      695     2976    4            FR_SUC$(MODE)->FR$SU(J)=FR_SUC$(MODE)->FR$SU(J)-SUDO;

   2976  1 002451   200005 720100                    LXL0    MODE,,AUTO
         1 002452   000000 470410 xsym               LDP0    FR_SUC$,X0
         1 002453   000000 236105                    LDQ     0,AL,PR0
         1 002454   200015 136100                    SBLQ    SUDO,,AUTO
         1 002455   200010 721100                    LXL1    J,,AUTO
         1 002456   000000 756111                    STQ     0,X1,PR0

      696     2977    4            FR_SUCT(J)=FR_SUCT(J)-SUDO;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:116  
   2977  1 002457   200010 720100                    LXL0    J,,AUTO
         1 002460   000000 236010 xsym               LDQ     FR_SUCT,X0
         1 002461   200015 136100                    SBLQ    SUDO,,AUTO
         1 002462   000000 756010 xsym               STQ     FR_SUCT,X0

      697     2978    4            IF FR_SUCT(J)<0 OR FR_SUC$(MODE)->FR$SU(J)<0

   2978  1 002463   002470 604000 1                  TMI     s:2979
         1 002464   200005 721100                    LXL1    MODE,,AUTO
         1 002465   000000 470411 xsym               LDP0    FR_SUC$,X1
         1 002466   000000 235110                    LDA     0,X0,PR0
         1 002467   002472 605000 1                  TPL     s:2980

      698     2979    4            THEN CALL SC_R2MANY;

   2979  1 002470   000000 713400 xsym               CLIMB   SC_R2MANY
         1 002471   000000 600000 xsid               climb   nvectors=         0

      699     2980    4            B$JIT.CURSUDO(J)=B$JIT.CURSUDO(J)-SUDO;

   2980  1 002472   000000 470400 xsym               LDP0    B$JIT$
         1 002473   200010 235100                    LDA     J,,AUTO
         1 002474   000100 101505                    MRL     fill='000'O
         1 002475   000334 000001                    ADSC9   220,A,PR0                cn=0,n=1
         1 002476   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 002477   200034 236100                    LDQ     SUARAY+7,,AUTO
         1 002500   200015 136100                    SBLQ    SUDO,,AUTO
         1 002501   200035 756100                    STQ     SUARAY+8,,AUTO
         1 002502   000105 101500                    MRL     fill='000'O
         1 002503   200035 000004                    ADSC9   SUARAY+8,,AUTO           cn=0,n=4
         1 002504   000334 000001                    ADSC9   220,A,PR0                cn=0,n=1

      700     2981    4            END;

      701     2982    3         END;

   2982  1 002505   200010 054100                    AOS     J,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:117  
         1 002506   200010 236100                    LDQ     J,,AUTO
         1 002507   000000 116000 xsym               CMPQ    FR_SUMX
         1 002510   002443 604400 1                  TMOZ    s:2974

      702     2983    2      IF STRSOP~=0 AND SUARAY THEN CALL FRS$SUSUB (SUARAY);

   2983  1 002511   200014 235100                    LDA     STRSOP,,AUTO
         1 002512   002525 600000 1                  TZE     s:2984
         1 002513   000000 106500                    CMPC    fill='000'O
         1 002514   200025 000010                    ADSC9   SUARAY,,AUTO             cn=0,n=8
         1 002515   000002 000002 xsym               ADSC9   B_VECTNIL+2              cn=0,n=2
         1 002516   002525 600000 1                  TZE     s:2984

   2983  1 002517   200025 630500                    EPPR0   SUARAY,,AUTO
         1 002520   200034 450500                    STP0    SUARAY+7,,AUTO
         1 002521   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 002522   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002523   000000 701000 xent               TSX1    FRS$SUSUB
         1 002524   000000 011000                    NOP     0

      703     2984    2      RETURN;

   2984  1 002525   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 002526   000001 702211                    TSX2  ! 1,X1

      704     2985    2   END;
      705     2986           /**/
      706     2987        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:118  
      707     2988           /**/
      708     2989    1   RELALL: PROC;

   2989  1 002527   200030 741300       RELALL       STX1  ! SUARAY+3,,AUTO

      709     2990           /**/
      710     2991    2      MEMORY=B$JIT.RESCORE-CURRCORE;

   2991  1 002530   000000 470400 xsym               LDP0    B$JIT$
         1 002531   000336 236100                    LDQ     222,,PR0
         1 002532   200012 136100                    SBLQ    MAX,,AUTO
         1 002533   200006 756100                    STQ     MEMORY,,AUTO

      711     2992    2      CALL RMEM;

   2992  1 002534   002377 701000 1                  TSX1    RMEM
         1 002535   000000 011000                    NOP     0

      712     2993    2      SUARAY=B$JIT.CURSUDO;

   2993  1 002536   000000 470400 xsym               LDP0    B$JIT$
         1 002537   000334 237100                    LDAQ    220,,PR0
         1 002540   200025 755100                    STA     SUARAY,,AUTO
         1 002541   200026 756100                    STQ     SUARAY+1,,AUTO

      713     2994    2      CALL RSUDO;

   2994  1 002542   002440 701000 1                  TSX1    RSUDO
         1 002543   000000 011000                    NOP     0

      714     2995    2      P.DISP=2; /* LET UDLIST FIGURE WHETHER TO UNLOAD THE VOLUMES */

   2995  1 002544   000002 236007                    LDQ     2,DL
         1 002545   200021 552104                    STBQ    P+1,'04'O,AUTO

      715     2996    2      CALL FMR$L8;

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:119  
   2996  1 002546   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002547   000000 701000 xent               TSX1    FMR$L8
         1 002550   000000 011000                    NOP     0

      716     2997    2      I=FM$CFUX.SETH;

   2997  1 002551   000000 470400 xsym               LDP0    F$CFU$
         1 002552   000005 236100                    LDQ     5,,PR0
         1 002553   000022 772000                    QRL     18
         1 002554   200007 756100                    STQ     I,,AUTO

      717     2998    3      DO WHILE (I~=0);

   2998  1 002555   002571 600000 1                  TZE     s:3004

      718     2999    3         CALL CKSET ALTRET(RPSN1);

   2999  1 002556   003062 701000 1                  TSX1    CKSET
         1 002557   002562 702000 1                  TSX2    RPSN1

      719     3000    3         CALL RELSET;

   3000  1 002560   003174 701000 1                  TSX1    RELSET
         1 002561   000000 011000                    NOP     0

   2999  1 002562                       RPSN1        null
      720     3001    3   RPSN1: ;
      721     3002    3         I=FM$SET.SETL(I);

   3002  1 002562   200007 235100                    LDA     I,,AUTO
         1 002563   000003 735000                    ALS     3
         1 002564   000000 470400 xsym               LDP0    FM$SET$
         1 002565   000005 236105                    LDQ     5,AL,PR0
         1 002566   000022 772000                    QRL     18
         1 002567   200007 756100                    STQ     I,,AUTO

      722     3003    3         END;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:120  

   3003  1 002570   002556 601000 1                  TNZ     s:2999

      723     3004    2      CALL FMR$U8;

   3004  1 002571   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002572   000000 701000 xent               TSX1    FMR$U8
         1 002573   000000 011000                    NOP     0

      724     3005    3      DO RCD=0 TO FR_NPOOL;

   3005  1 002574   200011 450100                    STZ     K,,AUTO

   3005  1 002575                       RLALLAGIN    null
      725     3006    3   RLALLAGIN:;
      726     3007    3         RAT$=FR$HD$(RCD);

   3007  1 002575   200011 720100                    LXL0    K,,AUTO
         1 002576   000000 236010 xsym               LDQ     FR$HD$,X0
         1 002577   200022 756100                    STQ     RAT$,,AUTO

      727     3008    4         DO WHILE (RAT$~=ADDR(NIL));

   3008  1 002600   002672 710000 1                  TRA     s:3028

      728     3009    5            IF RAT.RES.SISID=SYSID THEN DO;

   3009  1 002601   200022 470500                    LDP0    RAT$,,AUTO
         1 002602   000001 236100                    LDQ     1,,PR0
         1 002603   000022 732000                    QRS     18
         1 002604   200004 116100                    CMPQ    SYSID,,AUTO
         1 002605   002661 601000 1                  TNZ     s:3026

      729     3010    6               IF RAT.FLG.OPN THEN DO;

   3010  1 002606   000010 236100                    LDQ     8,,PR0
         1 002607   000020 316007                    CANQ    16,DL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:121  
         1 002610   002634 600000 1                  TZE     s:3020

      730     3011    7                  IF B$JIT.ERR~=NRLOP THEN DO;

   3011  1 002611   000000 471400 xsym               LDP1    B$JIT$
         1 002612   100012 236100                    LDQ     10,,PR1
         1 002613   000007 116000 0                  CMPQ    NRLOP
         1 002614   002627 600000 1                  TZE     s:3015

      731     3012    7                     B$JIT.ERR=NRLOP;

   3012  1 002615   000007 236000 0                  LDQ     NRLOP
         1 002616   100012 756100                    STQ     10,,PR1

      732     3013    7                     IF STRSOP=0 AND B$JIT.SYSID~=IRM_SYSID THEN CALL SC_NRNDWN;

   3013  1 002617   200014 235100                    LDA     STRSOP,,AUTO
         1 002620   002627 601000 1                  TNZ     s:3015
         1 002621   100000 236100                    LDQ     0,,PR1
         1 002622   777777 376007                    ANQ     -1,DL
         1 002623   000000 116000 xsym               CMPQ    IRM_SYSID
         1 002624   002627 600000 1                  TZE     s:3015

   3013  1 002625   000000 713400 xsym               CLIMB   SC_NRNDWN
         1 002626   000000 600000 xsid               climb   nvectors=         0

      733     3014    7                     END;

      734     3015    6                  IF STRSOP=0 THEN RAT.FLG.OPN='0'B; /* RELEASE ANYWAY */

   3015  1 002627   200014 235100                    LDA     STRSOP,,AUTO
         1 002630   002634 601000 1                  TNZ     s:3020

   3015  1 002631   200022 470500                    LDP0    RAT$,,AUTO
         1 002632   000006 236000 2                  LDQ     6
         1 002633   000010 356100                    ANSQ    8,,PR0

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:122  
      735     3016    6                  END;

      736     3017           /*E*  ERROR:         FRP-E$NRLOPN-E
      737     3018                 DESCRIPTION:   In this case a release all was done with a DCB
      738     3019                                still open to a physical resource.                      */
      739     3020    6               IF NOT RAT.FLG.OPN THEN DO;

   3020  1 002634   200022 470500                    LDP0    RAT$,,AUTO
         1 002635   000010 236100                    LDQ     8,,PR0
         1 002636   000020 316007                    CANQ    16,DL
         1 002637   002667 601000 1                  TNZ     s:3027

      740     3021    6                  IF STRSOP~=0 THEN CALL FRS$RESSUB (RAT);

   3021  1 002640   200014 235100                    LDA     STRSOP,,AUTO
         1 002641   002646 600000 1                  TZE     s:3022

   3021  1 002642   200022 630500                    EPPR0   RAT$,,AUTO
         1 002643   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 002644   000000 701000 xent               TSX1    FRS$RESSUB
         1 002645   000000 011000                    NOP     0

      741     3022    6                  CALL FRZ$RRESNA (RAT,MODE);

   3022  1 002646   200005 630500                    EPPR0   MODE,,AUTO
         1 002647   200035 450500                    STP0    SUARAY+8,,AUTO
         1 002650   200022 236100                    LDQ     RAT$,,AUTO
         1 002651   200034 756100                    STQ     SUARAY+7,,AUTO
         1 002652   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 002653   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002654   000000 701000 xent               TSX1    FRZ$RRESNA
         1 002655   000000 011000                    NOP     0

      742     3023    6                  IF STRSOP~=0 THEN GOTO RLALLAGIN; /* SOMETHING MAYBE MOVED */

   3023  1 002656   200014 235100                    LDA     STRSOP,,AUTO
         1 002657   002575 601000 1                  TNZ     RLALLAGIN
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:123  

      743     3024    6                  END;

      744     3025    5               END;

   3025  1 002660   002667 710000 1                  TRA     s:3027

      745     3026    4            ELSE IF RAT.REEL.ASID=SYSID THEN RAT.REEL.ASID=0;

   3026  1 002661   000004 236100                    LDQ     4,,PR0
         1 002662   000022 732000                    QRS     18
         1 002663   200004 116100                    CMPQ    SYSID,,AUTO
         1 002664   002667 601000 1                  TNZ     s:3027

   3026  1 002665   000000 220003                    LDX0    0,DU
         1 002666   000004 740100                    STX0    4,,PR0

      746     3027    4            RAT$=RAT.LNK$;

   3027  1 002667   200022 470500                    LDP0    RAT$,,AUTO
         1 002670   000000 236100                    LDQ     0,,PR0
         1 002671   200022 756100                    STQ     RAT$,,AUTO

      747     3028    4            END;

   3028  1 002672   000001 116000 xsym               CMPQ    B_VECTNIL+1
         1 002673   002601 601000 1                  TNZ     s:3009

      748     3029    3         END;

   3029  1 002674   200011 235100                    LDA     K,,AUTO
         1 002675   000001 035007                    ADLA    1,DL
         1 002676   200011 755100                    STA     K,,AUTO
         1 002677   000003 115007                    CMPA    3,DL
         1 002700   002575 602000 1                  TNC     RLALLAGIN

      749     3030    2      RETURN;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:124  

   3030  1 002701   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002702   000001 702211                    TSX2  ! 1,X1

      750     3031    2   END;
      751     3032           /**/
      752     3033        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:125  
      753     3034           /**/
      754     3035           /**/
      755     3036    1   DSETSM: PROC;

   3036  1 002703   200030 741300       DSETSM       STX1  ! SUARAY+3,,AUTO

      756     3037           /**/
      757     3038    2      SYSID=0;

   3038  1 002704   200004 450100                    STZ     SYSID,,AUTO
         1 002705   002707 710000 1                  TRA     s:3042

      758     3039           /**/
      759     3040    2   DSETS: ENTRY;

   3040  1 002706   200030 741300       DSETS        STX1  ! SUARAY+3,,AUTO

      760     3041           /**/
      761     3042    2      CALL HFF$DSIZ(3,J);

   3042  1 002707   200010 630500                    EPPR0   J,,AUTO
         1 002710   200035 450500                    STP0    SUARAY+8,,AUTO
         1 002711   000002 236000 2                  LDQ     2
         1 002712   200034 756100                    STQ     SUARAY+7,,AUTO
         1 002713   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 002714   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 002715   000000 701000 xent               TSX1    HFF$DSIZ
         1 002716   000000 011000                    NOP     0

      762     3043    2      J=J-POFFC(ADDR(B$PS3$->VPS.RPLIST),ADDR(B$PS3$->VPS));

   3043  1 002717   000000 236000 xsym               LDQ     B$PS3$
         1 002720   000020 772000                    QRL     16
         1 002721   200034 756100                    STQ     SUARAY+7,,AUTO
         1 002722   000000 236000 xsym               LDQ     B$PS3$
         1 002723   000002 036003                    ADLQ    2,DU
         1 002724   000020 772000                    QRL     16
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:126  
         1 002725   200034 136100                    SBLQ    SUARAY+7,,AUTO
         1 002726   200035 756100                    STQ     SUARAY+8,,AUTO
         1 002727   200010 236100                    LDQ     J,,AUTO
         1 002730   200035 136100                    SBLQ    SUARAY+8,,AUTO
         1 002731   200010 756100                    STQ     J,,AUTO

      763     3044    2      IF J<=0 THEN RETURN;

   3044  1 002732   002735 605400 1                  TPNZ    s:3045

   3044  1 002733   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 002734   000001 702211                    TSX2  ! 1,X1

      764     3045    2      B$PS3$->VPS.NN=J/SIZEC(B$PS3$->VPS.RPLIST(0))-1;

   3045  1 002735   000020 506007                    DIV     16,DL
         1 002736   000001 136007                    SBLQ    1,DL
         1 002737   000000 470400 xsym               LDP0    B$PS3$
         1 002740   000000 756100                    STQ     0,,PR0

      765     3046    2      J=0;

   3046  1 002741   200010 450100                    STZ     J,,AUTO

      766     3047    2      CALL FMR$L8;

   3047  1 002742   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 002743   000000 701000 xent               TSX1    FMR$L8
         1 002744   000000 011000                    NOP     0

      767     3048    2      I=FM$CFUX.SETH;

   3048  1 002745   000000 470400 xsym               LDP0    F$CFU$
         1 002746   000005 236100                    LDQ     5,,PR0
         1 002747   000022 772000                    QRL     18
         1 002750   200007 756100                    STQ     I,,AUTO

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:127  
      768     3049    3      DO WHILE(I~=0);

   3049  1 002751   003042 600000 1                  TZE     s:3064

      769     3050    3         IF FM$SET.SYSID(I)=0 THEN GOTO DSETS1;

   3050  1 002752   200007 235100                    LDA     I,,AUTO
         1 002753   000003 735000                    ALS     3
         1 002754   000000 470400 xsym               LDP0    FM$SET$
         1 002755   000002 720105                    LXL0    2,AL,PR0
         1 002756   003033 600000 1                  TZE     DSETS1

      770     3051    3         IF SYSID~=0 THEN CALL CKSET ALTRET(DSETS1);

   3051  1 002757   200004 236100                    LDQ     SYSID,,AUTO
         1 002760   002763 600000 1                  TZE     s:3052

   3051  1 002761   003062 701000 1                  TSX1    CKSET
         1 002762   003033 702000 1                  TSX2    DSETS1

      771     3052    4         IF J>=B$PS3$->VPS.NN THEN DO;

   3052  1 002763   000000 470400 xsym               LDP0    B$PS3$
         1 002764   200010 236100                    LDQ     J,,AUTO
         1 002765   000000 116100                    CMPQ    0,,PR0
         1 002766   002773 604000 1                  TMI     s:3057

      772     3053    4            J=J+1;

   3053  1 002767   200010 054100                    AOS     J,,AUTO

      773     3054    4            B$PS3$->VPS.FAILX=J;

   3054  1 002770   200010 235100                    LDA     J,,AUTO
         1 002771   000001 755100                    STA     1,,PR0

      774     3055    4            GOTO DSETS1;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:128  

   3055  1 002772   003033 710000 1                  TRA     DSETS1

      775     3056    4            END;
      776     3057    3         B$PS3$->VPS.RPLIST.PSN(J)=FM$SET.PSN(I);

   3057  1 002773   200010 235100                    LDA     J,,AUTO
         1 002774   000002 735000                    ALS     2
         1 002775   200007 236100                    LDQ     I,,AUTO
         1 002776   000005 736000                    QLS     5
         1 002777   000002 735000                    ALS     2
         1 003000   000000 471400 xsym               LDP1    FM$SET$
         1 003001   040105 100506                    MLR     fill='040'O
         1 003002   100000 400006                    ADSC9   0,Q,PR1                  cn=2,n=6
         1 003003   000002 000006                    ADSC9   2,A,PR0                  cn=0,n=6

      777     3058    3         IF FM$SET.XCL(I) THEN B$PS3$->VPS.RPLIST.USAGE(J)=2;

   3058  1 003004   200007 235100                    LDA     I,,AUTO
         1 003005   000003 735000                    ALS     3
         1 003006   000000 470400 xsym               LDP0    FM$SET$
         1 003007   000002 234105                    SZN     2,AL,PR0
         1 003010   003022 605000 1                  TPL     s:3059

   3058  1 003011   200010 236100                    LDQ     J,,AUTO
         1 003012   000002 736000                    QLS     2
         1 003013   000000 471400 xsym               LDP1    B$PS3$
         1 003014   000000 620006                    EAX0    0,QL
         1 003015   100003 236106                    LDQ     3,QL,PR1
         1 003016   000007 376000 2                  ANQ     7
         1 003017   002000 276007                    ORQ     1024,DL
         1 003020   100003 756110                    STQ     3,X0,PR1
         1 003021   003032 710000 1                  TRA     s:3060

      778     3059    3         ELSE B$PS3$->VPS.RPLIST.USAGE(J)=1;

   3059  1 003022   200010 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:129  
         1 003023   000002 736000                    QLS     2
         1 003024   000000 471400 xsym               LDP1    B$PS3$
         1 003025   000000 620006                    EAX0    0,QL
         1 003026   100003 236106                    LDQ     3,QL,PR1
         1 003027   000007 376000 2                  ANQ     7
         1 003030   001000 276007                    ORQ     512,DL
         1 003031   100003 756110                    STQ     3,X0,PR1

      779     3060    3         J=J+1;

   3060  1 003032   200010 054100                    AOS     J,,AUTO

   3060  1 003033                       DSETS1       null
      780     3061    3   DSETS1: ;
      781     3062    3         I=FM$SET.SETL(I);

   3062  1 003033   200007 235100                    LDA     I,,AUTO
         1 003034   000003 735000                    ALS     3
         1 003035   000000 470400 xsym               LDP0    FM$SET$
         1 003036   000005 236105                    LDQ     5,AL,PR0
         1 003037   000022 772000                    QRL     18
         1 003040   200007 756100                    STQ     I,,AUTO

      782     3063    3         END;

   3063  1 003041   002752 601000 1                  TNZ     s:3050

      783     3064    2      CALL FMR$U8;

   3064  1 003042   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003043   000000 701000 xent               TSX1    FMR$U8
         1 003044   000000 011000                    NOP     0

      784     3065    2      IF J>B$PS3$->VPS.NN THEN B$JIT.ERR=NORMRM;

   3065  1 003045   000000 470400 xsym               LDP0    B$PS3$
         1 003046   200010 236100                    LDQ     J,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:130  
         1 003047   000000 116100                    CMPQ    0,,PR0
         1 003050   003055 604400 1                  TMOZ    s:3067

   3065  1 003051   000001 236000 0                  LDQ     NORMRM
         1 003052   000000 471400 xsym               LDP1    B$JIT$
         1 003053   100012 756100                    STQ     10,,PR1
         1 003054   003060 710000 1                  TRA     s:3070

      785     3066    3      ELSE DO;

      786     3067    3         B$PS3$->VPS.NN=J;

   3067  1 003055   000000 756100                    STQ     0,,PR0

      787     3068    3         B$PS3$->VPS.FAILX=0;

   3068  1 003056   000000 470400 xsym               LDP0    B$PS3$
         1 003057   000001 450100                    STZ     1,,PR0

      788     3069    3         END;

      789     3070    2      RETURN;

   3070  1 003060   200030 221300                    LDX1  ! SUARAY+3,,AUTO
         1 003061   000001 702211                    TSX2  ! 1,X1

      790     3071           /**/
      791     3072           /**/
      792     3073    2   END;
      793     3074           /**/
      794     3075        %EJECT;
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:131  
      795     3076           /**/
      796     3077    1   CKSET: PROC ALTRET;

   3077  1 003062   200032 741300       CKSET        STX1  ! SUARAY+5,,AUTO

      797     3078           /**/
      798     3079    3      IF FM$SET.XCL(I) OR FM$SET.ONEU(I) THEN DO;

   3079  1 003063   200007 235100                    LDA     I,,AUTO
         1 003064   000003 735000                    ALS     3
         1 003065   000000 470400 xsym               LDP0    FM$SET$
         1 003066   000002 234105                    SZN     2,AL,PR0
         1 003067   003073 604000 1                  TMI     s:3080
         1 003070   000002 236105                    LDQ     2,AL,PR0
         1 003071   000001 316003                    CANQ    1,DU
         1 003072   003101 600000 1                  TZE     s:3083

      799     3080    3         IF SYSID~=FM$SET.SYSID(I) THEN ALTRETURN;

   3080  1 003073   000002 236105                    LDQ     2,AL,PR0
         1 003074   777777 376007                    ANQ     -1,DL
         1 003075   200004 116100                    CMPQ    SYSID,,AUTO
         1 003076   003100 600000 1                  TZE     s:3081

   3080  1 003077   000000 702211                    TSX2  ! 0,X1

      800     3081    3         RETURN;

   3081  1 003100   000001 702211                    TSX2  ! 1,X1

      801     3082    3         END;
      802     3083    2      SETU$=PINCRW(F$CFU$,FM$SET.USERLIST(I));

   3083  1 003101   000002 720105                    LXL0    2,AL,PR0
         1 003102   000000 636010                    EAQ     0,X0
         1 003103   000000 036000 xsym               ADLQ    F$CFU$
         1 003104   200022 756100                    STQ     RAT$,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:132  

      803     3084    3      DO WHILE(SETU$~=F$CFU$);

   3084  1 003105   000000 116000 xsym               CMPQ    F$CFU$
         1 003106   003140 600000 1                  TZE     s:3090

      804     3085    4         DO K=0 TO FM$SETU.NUM-1;

   3085  1 003107   200011 450100                    STZ     K,,AUTO
         1 003110   003125 710000 1                  TRA     s:3087+1

      805     3086    4            IF FM$SETU.SYSID(K)=SYSID THEN RETURN;

   3086  1 003111   200011 235100                    LDA     K,,AUTO
         1 003112   000001 735000                    ALS     1
         1 003113   200022 470500                    LDP0    RAT$,,AUTO
         1 003114   000100 101505                    MRL     fill='000'O
         1 003115   000001 000002                    ADSC9   1,A,PR0                  cn=0,n=2
         1 003116   200034 000004                    ADSC9   SUARAY+7,,AUTO           cn=0,n=4
         1 003117   200034 236100                    LDQ     SUARAY+7,,AUTO
         1 003120   200004 116100                    CMPQ    SYSID,,AUTO
         1 003121   003124 601000 1                  TNZ     s:3087

   3086  1 003122   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 003123   000001 702211                    TSX2  ! 1,X1

      806     3087    4            END;

   3087  1 003124   200011 054100                    AOS     K,,AUTO
         1 003125   200022 470500                    LDP0    RAT$,,AUTO
         1 003126   000000 236100                    LDQ     0,,PR0
         1 003127   000022 772000                    QRL     18
         1 003130   200011 116100                    CMPQ    K,,AUTO
         1 003131   003111 605400 1                  TPNZ    s:3086

      807     3088    3         SETU$=PINCRW(F$CFU$,FM$SETU.LINKX);

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:133  
   3088  1 003132   000000 720100                    LXL0    0,,PR0
         1 003133   000000 636010                    EAQ     0,X0
         1 003134   000000 036000 xsym               ADLQ    F$CFU$
         1 003135   200022 756100                    STQ     RAT$,,AUTO

      808     3089    3         END;

   3089  1 003136   000000 116000 xsym               CMPQ    F$CFU$
         1 003137   003107 601000 1                  TNZ     s:3085

      809     3090    2      ALTRETURN;

   3090  1 003140   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 003141   000000 702211                    TSX2  ! 0,X1

      810     3091           /**/
      811     3092           /**/
      812     3093    2   FINDSET: ENTRY ALTRET;

   3093  1 003142   200032 741300       FINDSET      STX1  ! SUARAY+5,,AUTO

      813     3094           /**/
      814     3095    2      CALL FMR$L8;

   3095  1 003143   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003144   000000 701000 xent               TSX1    FMR$L8
         1 003145   000000 011000                    NOP     0

      815     3096    2      I=FM$CFUX.SETH;

   3096  1 003146   000000 470400 xsym               LDP0    F$CFU$
         1 003147   000005 236100                    LDQ     5,,PR0
         1 003150   000022 772000                    QRL     18
         1 003151   200007 756100                    STQ     I,,AUTO

      816     3097    3      DO WHILE(I~=0);

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:134  
   3097  1 003152   003172 600000 1                  TZE     s:3101

      817     3098    3         IF FM$SET.PSN(I)=P.PSN THEN RETURN;

   3098  1 003153   200007 235100                    LDA     I,,AUTO
         1 003154   000005 735000                    ALS     5
         1 003155   000000 470400 xsym               LDP0    FM$SET$
         1 003156   040100 106505                    CMPC    fill='040'O
         1 003157   000000 400006                    ADSC9   0,A,PR0                  cn=2,n=6
         1 003160   200020 000006                    ADSC9   P,,AUTO                  cn=0,n=6
         1 003161   003164 601000 1                  TNZ     s:3099

   3098  1 003162   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 003163   000001 702211                    TSX2  ! 1,X1

      818     3099    3         I=FM$SET.SETL(I);

   3099  1 003164   200007 236100                    LDQ     I,,AUTO
         1 003165   000003 736000                    QLS     3
         1 003166   000005 236106                    LDQ     5,QL,PR0
         1 003167   000022 772000                    QRL     18
         1 003170   200007 756100                    STQ     I,,AUTO

      819     3100    3         END;

   3100  1 003171   003153 601000 1                  TNZ     s:3098

      820     3101    2      ALTRETURN;

   3101  1 003172   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 003173   000000 702211                    TSX2  ! 0,X1

      821     3102           /**/
      822     3103           /**/
      823     3104    2   RELSET: ENTRY ALTRET;

   3104  1 003174   200032 741300       RELSET       STX1  ! SUARAY+5,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:135  

      824     3105           /**/
      825     3106    3      IF FM$SET.SET(I) THEN DO;

   3106  1 003175   200007 235100                    LDA     I,,AUTO
         1 003176   000003 735000                    ALS     3
         1 003177   000000 470400 xsym               LDP0    FM$SET$
         1 003200   000002 236105                    LDQ     2,AL,PR0
         1 003201   200000 316003                    CANQ    65536,DU
         1 003202   003223 600000 1                  TZE     s:3111

      826     3107    3         IF STRSOP~=0 THEN CALL FRS$CLSTRS;

   3107  1 003203   200014 235100                    LDA     STRSOP,,AUTO
         1 003204   003210 600000 1                  TZE     s:3108

   3107  1 003205   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003206   000000 701000 xent               TSX1    FRS$CLSTRS
         1 003207   000000 011000                    NOP     0

      827     3108    3         CALL FMS$RELACCT(I)ALTRET(RETALT);

   3108  1 003210   200007 630500                    EPPR0   I,,AUTO
         1 003211   200034 450500                    STP0    SUARAY+7,,AUTO
         1 003212   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 003213   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003214   000000 701000 xent               TSX1    FMS$RELACCT
         1 003215   003357 702000 1                  TSX2    RETALT

      828     3109    3         IF STRSOP~=0 THEN CALL FRS$OPSTRS;

   3109  1 003216   200014 235100                    LDA     STRSOP,,AUTO
         1 003217   003223 600000 1                  TZE     s:3111

   3109  1 003220   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003221   000000 701000 xent               TSX1    FRS$OPSTRS
         1 003222   000000 011000                    NOP     0
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:136  

      829     3110    3         END;

      830     3111    3      IF FM$SET.XCL(I) THEN DO;

   3111  1 003223   200007 235100                    LDA     I,,AUTO
         1 003224   000003 735000                    ALS     3
         1 003225   000000 470400 xsym               LDP0    FM$SET$
         1 003226   000002 234105                    SZN     2,AL,PR0
         1 003227   003334 605000 1                  TPL     s:3131

      831     3112    3         FM$SET.SET(I)='0'B;

   3112  1 003230   000010 236000 2                  LDQ     8
         1 003231   000002 356105                    ANSQ    2,AL,PR0

      832     3113    3         PRC$=ADDR(FM$SET(FM$SET.DCTX(I)));

   3113  1 003232   200007 235100                    LDA     I,,AUTO
         1 003233   000003 735000                    ALS     3
         1 003234   000000 470400 xsym               LDP0    FM$SET$
         1 003235   000000 236105                    LDQ     0,AL,PR0
         1 003236   000017 772000                    QRL     15
         1 003237   000011 376000 2                  ANQ     9
         1 003240   000022 736000                    QLS     18
         1 003241   000000 036000 xsym               ADLQ    FM$SET$
         1 003242   200023 756100                    STQ     PRC$,,AUTO

      833     3114    4         DO WHILE(PRC$~=FM$SET$); /* MARK FR$RAT.OPN FOR ALL THE VOLUMES */

   3114  1 003243   000000 116000 xsym               CMPQ    FM$SET$
         1 003244   003334 600000 1                  TZE     s:3131

      834     3115    4            RAT$=N$DCT$(FM$VOL.DCTX)->NI$DCT.RAT$;

   3115  1 003245   200023 470500                    LDP0    PRC$,,AUTO
         1 003246   000000 220100                    LDX0    0,,PR0
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:137  
         1 003247   000000 471400 xsym               LDP1    N$DCT$$
         1 003250   100000 473510                    LDP3    0,X0,PR1
         1 003251   300005 236100                    LDQ     5,,PR3
         1 003252   200022 756100                    STQ     RAT$,,AUTO

      835     3116    5            IF RAT.RES.SISID=SYSID THEN DO;

   3116  1 003253   200022 473500                    LDP3    RAT$,,AUTO
         1 003254   300001 236100                    LDQ     1,,PR3
         1 003255   000022 732000                    QRS     18
         1 003256   200004 116100                    CMPQ    SYSID,,AUTO
         1 003257   003323 601000 1                  TNZ     s:3128

      836     3117    5               RAT.FLG.OPN='0'B;

   3117  1 003260   000006 236000 2                  LDQ     6
         1 003261   300010 356100                    ANSQ    8,,PR3

      837     3118    6               IF MOD(P.DISP,2)~=0 THEN DO;

   3118  1 003262   200021 236100                    LDQ     P+1,,AUTO
         1 003263   000777 376007                    ANQ     511,DL
         1 003264   000001 376007                    ANQ     1,DL
         1 003265   003305 600000 1                  TZE     s:3122

      838     3119    6                  IF STRSOP~=0 THEN CALL FRS$RESSUB (RAT);

   3119  1 003266   200014 235100                    LDA     STRSOP,,AUTO
         1 003267   003274 600000 1                  TZE     s:3120

   3119  1 003270   200022 630500                    EPPR0   RAT$,,AUTO
         1 003271   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003272   000000 701000 xent               TSX1    FRS$RESSUB
         1 003273   000000 011000                    NOP     0

      839     3120    6                  CALL FRZ$RRESNA(RAT,MODE);

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:138  
   3120  1 003274   200005 630500                    EPPR0   MODE,,AUTO
         1 003275   200035 450500                    STP0    SUARAY+8,,AUTO
         1 003276   200022 236100                    LDQ     RAT$,,AUTO
         1 003277   200034 756100                    STQ     SUARAY+7,,AUTO
         1 003300   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 003301   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003302   000000 701000 xent               TSX1    FRZ$RRESNA
         1 003303   000000 011000                    NOP     0

      840     3121    6                  END;

   3121  1 003304   003323 710000 1                  TRA     s:3128

      841     3122    5               ELSE IF P.DISP~=0 THEN CALL FRZ$DSMT(RAT);

   3122  1 003305   200021 236100                    LDQ     P+1,,AUTO
         1 003306   000777 316007                    CANQ    511,DL
         1 003307   003315 600000 1                  TZE     s:3124

   3122  1 003310   200022 630500                    EPPR0   RAT$,,AUTO
         1 003311   000017 631400 xsym               EPPR1   B_VECTNIL+15
         1 003312   000000 701000 xent               TSX1    FRZ$DSMT
         1 003313   000000 011000                    NOP     0
         1 003314   003323 710000 1                  TRA     s:3128

      842     3123    6                  ELSE DO;

      843     3124    6                     RAT.REEL.ASID=0;

   3124  1 003315   000000 220003                    LDX0    0,DU
         1 003316   200022 473500                    LDP3    RAT$,,AUTO
         1 003317   300004 740100                    STX0    4,,PR3

      844     3125    6                     RAT.FLG.MBIT.MTD='0'B;

   3125  1 003320   200022 473500                    LDP3    RAT$,,AUTO
         1 003321   000012 236000 2                  LDQ     10
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:139  
         1 003322   300010 356100                    ANSQ    8,,PR3

      845     3126    6                     END;

      846     3127    5               END;

      847     3128    4            PRC$=ADDR(FM$SET(FM$VOL.VOLL));

   3128  1 003323   200023 470500                    LDP0    PRC$,,AUTO
         1 003324   000005 236100                    LDQ     5,,PR0
         1 003325   000017 772000                    QRL     15
         1 003326   000011 376000 2                  ANQ     9
         1 003327   000022 736000                    QLS     18
         1 003330   000000 036000 xsym               ADLQ    FM$SET$
         1 003331   200023 756100                    STQ     PRC$,,AUTO

      848     3129    4            END;

   3129  1 003332   000000 116000 xsym               CMPQ    FM$SET$
         1 003333   003245 601000 1                  TNZ     s:3115

      849     3130    3         END;

      850     3131    2      CALL FMR$L8;

   3131  1 003334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003335   000000 701000 xent               TSX1    FMR$L8
         1 003336   000000 011000                    NOP     0

      851     3132    2      IF P.DISP>1 THEN CALL FMP$UDLIST(FM$SET(I),SYSID);

   3132  1 003337   200021 236100                    LDQ     P+1,,AUTO
         1 003340   000777 376007                    ANQ     511,DL
         1 003341   000002 116007                    CMPQ    2,DL
         1 003342   003355 602000 1                  TNC     s:3133

   3132  1 003343   200004 630500                    EPPR0   SYSID,,AUTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:140  
         1 003344   200035 450500                    STP0    SUARAY+8,,AUTO
         1 003345   200007 236100                    LDQ     I,,AUTO
         1 003346   000025 736000                    QLS     21
         1 003347   000000 036000 xsym               ADLQ    FM$SET$
         1 003350   200034 756100                    STQ     SUARAY+7,,AUTO
         1 003351   200034 630500                    EPPR0   SUARAY+7,,AUTO
         1 003352   000020 631400 xsym               EPPR1   B_VECTNIL+16
         1 003353   000000 701000 xent               TSX1    FMP$UDLIST
         1 003354   000000 011000                    NOP     0

      852     3133    2      RETURN;

   3133  1 003355   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 003356   000001 702211                    TSX2  ! 1,X1

   3132  1 003357                       RETALT       null
      853     3134           /**/
      854     3135    2   RETALT:;
      855     3136    2      IF STRSOP~=0 THEN CALL FRS$OPSTRS;

   3136  1 003357   200014 235100                    LDA     STRSOP,,AUTO
         1 003360   003364 600000 1                  TZE     s:3137

   3136  1 003361   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003362   000000 701000 xent               TSX1    FRS$OPSTRS
         1 003363   000000 011000                    NOP     0

      856     3137    2      CALL FMR$L8;

   3137  1 003364   000002 631400 xsym               EPPR1   B_VECTNIL+2
         1 003365   000000 701000 xent               TSX1    FMR$L8
         1 003366   000000 011000                    NOP     0

      857     3138    2      ALTRETURN;

   3138  1 003367   200032 221300                    LDX1  ! SUARAY+5,,AUTO
         1 003370   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:141  

NOMOS
 Sect OctLoc
   0     000   062220 012242                                                    2...

NORMRM
 Sect OctLoc
   0     001   062220 012332                                                    2...

BSUNM
 Sect OctLoc
   0     002   062220 012260                                                    2...

BSUNMX
 Sect OctLoc
   0     003   062220 012266                                                    2...

NAUTH
 Sect OctLoc
   0     004   062220 006256                                                    2...

NORQD
 Sect OctLoc
   0     005   062220 012276                                                    2...

NALRL
 Sect OctLoc
   0     006   062220 012222                                                    2...

NRLOP
 Sect OctLoc
   0     007   062220 012212                                                    2...

NOPSN
 Sect OctLoc
   0     010   062220 012172                                                    2..z

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:142  
LESMEM
 Sect OctLoc
   0     011   062220 012340                                                    2...

NOMEM
 Sect OctLoc
   0     012   062220 012342                                                    2...

(unnamed)
 Sect OctLoc
   0     013   104120 040040   115124 040040   114124 040040   106124 040040    DP  MT  LT  FT

(unnamed)
 Sect OctLoc
   2     000   000003 006000   000004 006000   000005 006000   000003 400000    ................
   2     004   777777 177777   767777 777777   777777 777757   777777 000777    ................
   2     010   577777 777777   000007 777770   777777 777377                    ............
      858     3139    2   END;
      859     3140    1   END;
      860     3141           /**/
      861     3142           /**/

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:143  
--  Include file information  --

   UD_EQU_E.:E05TOU  is referenced.
   UD_SEV_C.:E05TOU  is referenced.
   UD_ERRORS_C.:E05TOU  is referenced.
   FR_ERRORS_C.:E05TOU  is referenced.
   FR_SUBS.:E05TOU  is referenced.
   NI$TABLES.:E05TOU  is referenced.
   FM$MACROS.:E05TOU  is referenced.
   M_INFO_C.:E05TOU  is referenced.
   JG_GHOSTS_C.:E05TOU  is referenced.
   F$CP6V_C.:E05TOU  is referenced.
   FR_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   B$JIT_C.:E05TOU  is referenced.
   FR$RESLIST.:E05TOU  is referenced.
   FR$RAT.:E05TOU  is referenced.
      No diagnostics issued in procedure FRP$PMME.
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:144  

 **** Variables and constants ****

  ****  Section 000 RoData FRP$PMME

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     2-0-0/b STRC        r     1 BSUNM                      3-0-0/b STRC        r     1 BSUNMX
    11-0-0/b STRC        r     1 LESMEM                     6-0-0/b STRC        r     1 NALRL
     4-0-0/b STRC        r     1 NAUTH                     12-0-0/b STRC        r     1 NOMEM
     0-0-0/b STRC        r     1 NOMOS                     10-0-0/b STRC        r     1 NOPSN
     1-0-0/b STRC        r     1 NORMRM                     5-0-0/b STRC        r     1 NORQD
     7-0-0/b STRC        r     1 NRLOP

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @FPTCODE                  13-0-0/w UBIN        r     1 ARECX
    12-0-0/w SBIN        r     1 CURRCORE                  *0-0-0/w UBIN        r     1 FPTCODE
     7-0-0/w SBIN        r     1 I                         10-0-0/w SBIN        r     1 J
    11-0-0/w SBIN        r     1 K                         12-0-0/w SBIN        r     1 MAX
     6-0-0/w SBIN        r     1 MEMORY                     5-0-0/w UBIN        r     1 MODE
    20-0-0/c STRC(72)    r     1 P                         23-0-0/w PTR         r     1 PRC$
    22-0-0/w PTR         r     1 PRM$                      22-0-0/w PTR         r     1 RAT$
    11-0-0/w UBIN        r     1 RCD                       17-0-0/c CHAR(2)     r     1 RNUM
    16-0-0/c CHAR(2)     r     1 RTYP                      22-0-0/w PTR         r     1 SETU$
    14-0-0/w UBIN        r     1 STRSOP                    25-0-0/b UBIN(9)     r     1 SUARAY(0:7)
    15-0-0/w SBIN        r     1 SUDO                       4-0-0/w SBIN        r     1 SYSID
    24-0-0/w PTR         r     1 T$

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:145  
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$PS0$
     0-0-0/w PTR         r     1 B$PS1$                     0-0-0/w PTR         r     1 B$PS2$
     0-0-0/w PTR         r     1 B$PS3$                     0-0-0/w PTR         r     1 F$CFU$
     0-0-0/w PTR         r     1 FM$SET$                    0-0-0/w PTR         r     1 FR$HD$(0:3)
     0-0-0/w SBIN        r     1 FR_MEMC(0:0)
     0-0-0/w SBIN        r     1 FR_MEMM(0:0)
     0-0-0/w PTR         r     1 FR_PRC$(0:0)
     0-0-0/w PTR         r     1 FR_PRM$(0:0)
     0-0-0/w PTR         r     1 FR_SUC$(0:0)
     0-0-0/w SBIN        r     1 FR_SUCT(0:0)
     0-0-0/w PTR         r     1 FR_SUM$(0:0)
     0-0-0/w SBIN        r     1 FR_SUMT(0:0)
     0-0-0/w SBIN        r     1 FR_SUMX
     0-0-0/c CHAR(8)     r     1 FR_SUNM(0:0)
     0-0-0/w UBIN        r     1 IRM_SYSID                  0-0-0/w PTR         r     1 N$DCT$$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(8856)  r     1 B$JIT                      0-0-0/c ASTR(27)    r     1 FM$CFUN
     0-0-0/w STRC(288)   r     1 FM$CFUX                    0-0-0/w STRC(288)   r     1 FM$SET(0:0)
     0-0-0/w STRC(288)   r     1 FM$SETU                    0-0-0/w STRC(288)   r     1 FM$VOL
     0-0-0/w SBIN        r     1 FR$PR(0:0)                 0-0-0/w SBIN        r     1 FR$SU(0:0)
     0-0-0/w PTR         r     1 N$DCT$(0:0)                0-0-0/w STRC(1332)  r     1 NI$DCT
     0-0-0/w STRC(324)   r     1 RAT                        0-0-0/d STRC(216)   r     1 RLST
     0-0-0/d STRC(216)   r     1 VPR                        0-0-0/d STRC(216)   r     1 VPS
     0-0-0/d STRC(216)   r     1 VRCTL                      0-0-0/d STRC(252)   r     1 VSU


   Procedure FRP$PMME requires 1785 words for executable code.
   Procedure FRP$PMME requires 34 words of local(AUTO) storage.

    No errors detected in file FRP$PMME.:E05TSI    .
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:146  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:147  
          MINI XREF LISTING

ALLOC
      2781**PROC     2453--CALL     2524--CALL
ALLOCX IN PROCEDURE ALLOC
      2853**LABEL    2841--CALLALT
ARECX
      1836**DCL      2452<<ASSIGN   2454>>ASSIGN   2523<<ASSIGN   2611<<ASSIGN   2617>>ASSIGN   2619<<ASSIGN
      2619>>ASSIGN   2625>>ASSIGN   2818>>ASSIGN   2819<<ASSIGN   2819>>ASSIGN
B$JIT.ARECX
       557**DCL      2452>>ASSIGN   2454<<ASSIGN   2587<<ASSIGN   2625<<ASSIGN   2947>>IF
B$JIT.CURRCORE
       541**DCL      2635>>ASSIGN
B$JIT.CURSUDO
       558**DCL      2459<<ASSIGN   2459>>ASSIGN   2550>>ASSIGN   2561>>IF       2627<>CALL     2665>>IF
      2666>>ASSIGN   2667>>ASSIGN   2980<<ASSIGN   2980>>ASSIGN   2993>>ASSIGN
B$JIT.ERR
       450**DCL      2433<<ASSIGN   2507<<ASSIGN   2536<<ASSIGN   2562<<ASSIGN   2580<<ASSIGN   2598<<ASSIGN
      2645<<ASSIGN   2646<<ASSIGN   2668<<ASSIGN   2678<<ASSIGN   2713<<ASSIGN   2726>>IF       2726<<ASSIGN
      2745<<ASSIGN   2846<<ASSIGN   2871<<ASSIGN   2891<<ASSIGN   2920<<ASSIGN   3011>>IF       3012<<ASSIGN
      3065<<ASSIGN
B$JIT.ERR.CODE
       451**DCL      2639>>IF       2678>>IF       2745>>IF
B$JIT.ERR.MID
       451**DCL       451--REDEF
B$JIT.JRESPEAK
       541**DCL       542--REDEF
B$JIT.MAXCORE
       540**DCL      2456<<ASSIGN   2606<<ASSIGN   2953>>IF       2953<<ASSIGN
B$JIT.MODE
       445**DCL      2417>>ASSIGN   2765>>ASSIGN
B$JIT.OLTA
       557**DCL      2824<<ASSIGN
B$JIT.ORIGINATOR_PORT.FROM_CR
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:148  
       560**DCL       560--REDEF     561--REDEF
B$JIT.RESCORE
       558**DCL      2455<<ASSIGN   2455>>ASSIGN   2456>>ASSIGN   2547>>ASSIGN   2588>>ASSIGN   2596>>IF
      2597<<ASSIGN   2606>>ASSIGN   2644>>IF       2645>>IF       2655>>ASSIGN   2952<<ASSIGN   2952>>ASSIGN
      2953>>IF       2953>>ASSIGN   2991>>ASSIGN
B$JIT.SYSID
       450**DCL      2416>>ASSIGN   2764>>ASSIGN   3013>>IF
B$JIT.TSLINE
       558**DCL       559--REDEF
B$JIT$
      1851**DCL       445--IMP-PTR  2416>>ASSIGN   2417>>ASSIGN   2433>>ASSIGN   2452>>ASSIGN   2454>>ASSIGN
      2455>>ASSIGN   2455>>ASSIGN   2456>>ASSIGN   2456>>ASSIGN   2459>>ASSIGN   2459>>ASSIGN   2507>>ASSIGN
      2536>>ASSIGN   2547>>ASSIGN   2550>>ASSIGN   2561>>IF       2562>>ASSIGN   2580>>ASSIGN   2587>>ASSIGN
      2588>>ASSIGN   2596>>IF       2597>>ASSIGN   2598>>ASSIGN   2606>>ASSIGN   2606>>ASSIGN   2625>>ASSIGN
      2627>>CALL     2635>>ASSIGN   2639>>IF       2644>>IF       2645>>IF       2645>>ASSIGN   2646>>ASSIGN
      2655>>ASSIGN   2665>>IF       2666>>ASSIGN   2667>>ASSIGN   2668>>ASSIGN   2678>>IF       2678>>ASSIGN
      2713>>ASSIGN   2726>>IF       2726>>ASSIGN   2745>>IF       2745>>ASSIGN   2764>>ASSIGN   2765>>ASSIGN
      2824>>ASSIGN   2846>>ASSIGN   2871>>ASSIGN   2891>>ASSIGN   2920>>ASSIGN   2947>>IF       2952>>ASSIGN
      2952>>ASSIGN   2953>>IF       2953>>IF       2953>>ASSIGN   2953>>ASSIGN   2980>>ASSIGN   2980>>ASSIGN
      2991>>ASSIGN   2993>>ASSIGN   3011>>IF       3012>>ASSIGN   3013>>IF       3065>>ASSIGN
B$PS0$
      1852**DCL      2465>>IF       2514>>ASSIGN   2637>>IF
B$PS1$
      1853**DCL      2423>>ASSIGN   2425>>DOINDEX  2427>>IF       2428>>ASSIGN   2445>>ASSIGN   2468>>ASSIGN
      2470>>ASSIGN   2472>>ASSIGN   2484>>ASSIGN   2487>>ASSIGN   2488>>ASSIGN   2489>>ASSIGN   2497>>ASSIGN
      2516>>ASSIGN   2518>>ASSIGN   2530>>ASSIGN   2530>>ASSIGN   2532>>ASSIGN   2533>>ASSIGN   2535>>ASSIGN
      2546>>ASSIGN   2547>>ASSIGN   2549>>ASSIGN   2550>>ASSIGN   2558>>DOINDEX  2560>>IF       2561>>IF
      2643>>ASSIGN   2657>>ASSIGN   2657>>ASSIGN   2661>>DOINDEX  2663>>IF       2664>>ASSIGN   2666>>ASSIGN
      2683>>ASSIGN   2683>>ASSIGN   2685>>ASSIGN   2685>>ASSIGN   2690>>ASSIGN
B$PS2$
      1854**DCL      2694>>DOINDEX  2695>>ASSIGN   2696>>ASSIGN   2732>>ASSIGN   2732>>ASSIGN   2733>>ASSIGN
      2737>>ASSIGN   2811>>DOINDEX  2812>>CALL     2812>>CALL     2814>>ASSIGN   2815>>ASSIGN   2822>>DOINDEX
      2823>>ASSIGN   2837>>ASSIGN   2839>>CALL     2908>>ASSIGN   2908>>ASSIGN   2910>>ASSIGN   2911>>ASSIGN
      2912>>ASSIGN   2919>>ASSIGN   2925>>ASSIGN   2928>>ASSIGN   2931>>ASSIGN   2932>>ASSIGN   2940>>ASSIGN
B$PS3$
      1855**DCL      2741>>DOINDEX  2742>>ASSIGN   2747>>ASSIGN   2753>>ASSIGN   2784>>DOINDEX  2785>>ASSIGN
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:149  
      2842>>ASSIGN   2845>>ASSIGN   2846>>IF       2852>>DOINDEX  2853>>ASSIGN   3043>>ASSIGN   3043>>ASSIGN
      3045>>ASSIGN   3045>>ASSIGN   3052>>IF       3054>>ASSIGN   3057>>ASSIGN   3058>>ASSIGN   3059>>ASSIGN
      3065>>IF       3067>>ASSIGN   3068>>ASSIGN
BADPR
      2726**LABEL    2721--GOTO
BADSU
      2683**LABEL    2672--GOTO
BSUNM
      1986**DCL      2433>>ASSIGN   2678>>ASSIGN
BSUNMX
      1990**DCL      2580>>ASSIGN
CKSET
      3077**PROC     2999--CALL     3051--CALL
CSEND
      2752**LABEL    2453--CALLALT  2739--CALLALT
CURRCORE
      1835**DCL      2635<<ASSIGN   2636>>IF       2636<<ASSIGN   2644>>IF       2655>>ASSIGN   2767<<ASSIGN
      2991>>ASSIGN
DISPRES
      2519**LABEL    2639--GOTO
DPHY
      2549**LABEL    2531--GOTO
DPHYS IN PROCEDURE DPHYSM
      2905**ENTRY    2475--CALL     2553--CALL
DPHYS1 IN PROCEDURE DPHYSM
      2931**LABEL    2923--GOTO
DPHYSM
      2901**PROC     2500--CALL
DSETS IN PROCEDURE DSETSM
      3040**ENTRY    2555--CALL
DSETS1 IN PROCEDURE DSETSM
      3060**LABEL    3050--GOTO     3051--CALLALT  3055--GOTO
DSETSM
      3036**PROC     2476--CALL     2501--CALL
F$CFU$
      1857**DCL      1449--IMP-PTR  2795>>ASSIGN   2796>>ASSIGN   2997>>ASSIGN   3048>>ASSIGN   3083>>ASSIGN
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:150  
      3084>>DOWHILE  3088>>ASSIGN   3096>>ASSIGN
FINDSET IN PROCEDURE CKSET
      3093**ENTRY    2743--CALL     2786--CALL     2854--CALL
FM$CFU.ACCTX
      1458**DCL      1458--REDEF
FM$CFUN.L
      1454**DCL      1454--IMP-SIZ
FM$CFUX.SETH
      1450**DCL      2795>>ASSIGN   2796<<ASSIGN   2997>>ASSIGN   3048>>ASSIGN   3096>>ASSIGN
FM$DEV.USERLIST
      1441**DCL      1442--REDEF
FM$SET
      1429**DCL      2790--ASSIGN   2805<>CALL     2855<>CALL     3113--ASSIGN   3128--ASSIGN   3132<>CALL
FM$SET.DCTX
      1429**DCL      3113>>ASSIGN
FM$SET.ONEU
      1430**DCL      2794<<ASSIGN   3079>>IF
FM$SET.PSN
      1429**DCL      2791<<ASSIGN   3057>>ASSIGN   3098>>IF
FM$SET.SET
      1429**DCL      2801>>IF       3106>>IF       3112<<ASSIGN
FM$SET.SETL
      1431**DCL      2795<<ASSIGN   3002>>ASSIGN   3062>>ASSIGN   3099>>ASSIGN
FM$SET.SYSID
      1430**DCL      2793<<ASSIGN   2803>>IF       2803>>IF       3050>>IF       3080>>IF
FM$SET.USERLIST
      1430**DCL      1430--REDEF    3083>>ASSIGN
FM$SET.XCL
      1429**DCL      2792<<ASSIGN   2801>>IF       3058>>IF       3079>>IF       3111>>IF
FM$SET$
      1856**DCL      1429--IMP-PTR  1440--IMP-PTR  2791>>ASSIGN   2792>>ASSIGN   2793>>ASSIGN   2794>>ASSIGN
      2795>>ASSIGN   2801>>IF       2801>>IF       2803>>IF       2803>>IF       2805>>CALL     2855>>CALL
      3002>>ASSIGN   3050>>IF       3057>>ASSIGN   3058>>IF       3062>>ASSIGN   3079>>IF       3079>>IF
      3080>>IF       3083>>ASSIGN   3098>>IF       3099>>ASSIGN   3106>>IF       3111>>IF       3112>>ASSIGN
      3113>>ASSIGN   3113>>ASSIGN   3114>>DOWHILE  3128>>ASSIGN   3132>>CALL
FM$SETU.LINKX
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:151  
      1446**DCL      3088>>ASSIGN
FM$SETU.NUM
      1446**DCL      3085>>DOINDEX
FM$SETU.SYSID
      1446**DCL      3086>>IF
FM$VOL.DCTX
      1434**DCL      3115>>ASSIGN
FM$VOL.USERLIST
      1435**DCL      1436--REDEF
FM$VOL.VOLL
      1436**DCL      3128>>ASSIGN
FMP$UDLIST
      1861**DCL-ENT  2855--CALL     3132--CALL
FMP$ULIST
      1862**DCL-ENT  2805--CALL
FMR$GA
      1863**DCL-ENT  2789--CALL
FMR$L8
      1864**DCL-ENT  2843--CALL     2996--CALL     3047--CALL     3095--CALL     3131--CALL     3137--CALL
FMR$U8
      1865**DCL-ENT  2749--CALL     2797--CALL     2806--CALL     2857--CALL     3004--CALL     3064--CALL
FMS$RELACCT
      1867**DCL-ENT  3108--CALL
FPTCODE
      1826**DCL        11--PROC     2418>>DOCASE
FR$HD$
       574**DCL      2614>>ASSIGN   2703>>ASSIGN   2915>>ASSIGN   3007>>ASSIGN
FR$PR
       580**DCL      2487>>ASSIGN   2487>>ASSIGN   2488>>ASSIGN   2488>>ASSIGN   2489>>ASSIGN   2489>>ASSIGN
FR$SU
       585**DCL      2493>>IF       2493>>IF       2494>>ASSIGN   2494>>ASSIGN   2832<<ASSIGN   2832>>ASSIGN
      2866>>IF       2866>>IF       2976<<ASSIGN   2976>>ASSIGN   2978>>IF
FRS$CLSTRS
      1874**DCL-ENT  2628--CALL     2757--CALL     3107--CALL
FRS$OPSTRS
      1873**DCL-ENT  2450--CALL     2607--CALL     2610--CALL     2632--CALL     3109--CALL     3136--CALL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:152  
FRS$RESADD
      1878**DCL-ENT  2618--CALL     2825--CALL
FRS$RESSUB
      1879**DCL-ENT  2708--CALL     3021--CALL     3119--CALL
FRS$SUADD
      1876**DCL-ENT  2461--CALL
FRS$SUSTRT
      1875**DCL-ENT  2627--CALL
FRS$SUSUB
      1877**DCL-ENT  2983--CALL
FRZ$DSMT
      1870**DCL-ENT  3122--CALL
FRZ$GETRES
      1871**DCL-ENT  2812--CALL
FRZ$RRESNA
      1872**DCL-ENT  2709--CALL     2839--CALL     3022--CALL     3120--CALL
FR_MEMC
       582**DCL      2480>>IF       2480>>IF       2481>>ASSIGN   2482>>ASSIGN   2589>>IF       2590>>ASSIGN
      2591>>IF       2592>>ASSIGN   2594<<ASSIGN   2594>>ASSIGN   2595<<ASSIGN   2595>>ASSIGN   2829<<ASSIGN
      2829>>ASSIGN   2830<<ASSIGN   2830>>ASSIGN   2888>>IF       2888>>IF       2948<<ASSIGN   2948>>ASSIGN
      2949<<ASSIGN   2949>>ASSIGN   2950>>IF       2950>>IF
FR_MEMM
       583**DCL      2468>>ASSIGN   2480>>IF       2480>>IF       2481>>ASSIGN   2482>>ASSIGN   2589>>IF
      2590>>ASSIGN   2591>>IF       2592>>ASSIGN   2888>>IF       2888>>IF
FR_PRC$
       579**DCL      2486>>ASSIGN
FR_PRM$
       581**DCL      2485>>ASSIGN
FR_SUC$
       584**DCL      2491>>ASSIGN   2832>>ASSIGN   2832>>ASSIGN   2866>>IF       2976>>ASSIGN   2976>>ASSIGN
      2978>>IF
FR_SUCT
       588**DCL      2493>>IF       2495>>ASSIGN   2833<<ASSIGN   2833>>ASSIGN   2866>>IF       2977<<ASSIGN
      2977>>ASSIGN   2978>>IF
FR_SUM$
       586**DCL      2490>>ASSIGN   2866>>IF
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:153  
FR_SUMT
       587**DCL      2493>>IF       2495>>ASSIGN   2866>>IF
FR_SUMX
       589**DCL      2426>>DOINDEX  2458>>DOINDEX  2469>>DOINDEX  2472>>ASSIGN   2492>>DOINDEX  2519>>DOINDEX
      2534>>IF       2535>>ASSIGN   2545>>ASSIGN   2559>>DOINDEX  2662>>DOINDEX  2831>>DOINDEX  2973>>DOINDEX
FR_SUNM
       590**DCL      2427>>IF       2470>>ASSIGN   2549>>ASSIGN   2560>>IF       2663>>IF
HFF$DSIZ
      1868**DCL-ENT  2529--CALL     2907--CALL     3042--CALL
HFF$NILERASE
      1869**DCL-ENT  2422--CALL     2467--CALL     2479--CALL     2642--CALL     2692--CALL     2739--CALL
      2783--CALL     2810--CALL     2841--CALL
I
      1830**DCL      2425<<DOINDEX  2427>>IF       2428>>ASSIGN   2445>>ASSIGN   2458<<DOINDEX  2459>>ASSIGN
      2459>>ASSIGN   2459>>ASSIGN   2469<<DOINDEX  2470>>ASSIGN   2470>>ASSIGN   2492<<DOINDEX  2493>>IF
      2493>>IF       2493>>IF       2493>>IF       2494>>ASSIGN   2494>>ASSIGN   2495>>ASSIGN   2495>>ASSIGN
      2497>>ASSIGN   2520<<ASSIGN   2548<<DOINDEX  2549>>ASSIGN   2549>>ASSIGN   2550>>ASSIGN   2550>>ASSIGN
      2558<<DOINDEX  2560>>IF       2561>>IF       2661<<DOINDEX  2663>>IF       2664>>ASSIGN   2683>>ASSIGN
      2685>>ASSIGN   2694<<DOINDEX  2695>>ASSIGN   2696>>ASSIGN   2732>>ASSIGN   2744>>IF       2787>>IF
      2789<>CALL     2790<<ASSIGN   2790>>ASSIGN   2791>>ASSIGN   2792>>ASSIGN   2793>>ASSIGN   2794>>ASSIGN
      2795>>ASSIGN   2796>>ASSIGN   2801>>IF       2801>>IF       2803>>IF       2803>>IF       2805>>CALL
      2811<<DOINDEX  2812>>CALL     2812>>CALL     2814>>ASSIGN   2815>>ASSIGN   2831<<DOINDEX  2832>>ASSIGN
      2832>>ASSIGN   2832>>ASSIGN   2833>>ASSIGN   2833>>ASSIGN   2833>>ASSIGN   2837>>ASSIGN   2838>>DOINDEX
      2855>>IF       2855>>CALL     2890<<ASSIGN   2913<<ASSIGN   2918>>IF       2919>>ASSIGN   2925>>ASSIGN
      2927<<ASSIGN   2927>>ASSIGN   2928>>ASSIGN   2931>>ASSIGN   2932>>ASSIGN   2935<<ASSIGN   2935>>ASSIGN
      2940>>IF       2940>>ASSIGN   2997<<ASSIGN   2998>>DOWHILE  3002<<ASSIGN   3002>>ASSIGN   3048<<ASSIGN
      3049>>DOWHILE  3050>>IF       3057>>ASSIGN   3058>>IF       3062<<ASSIGN   3062>>ASSIGN   3079>>IF
      3079>>IF       3080>>IF       3083>>ASSIGN   3096<<ASSIGN   3097>>DOWHILE  3098>>IF       3099<<ASSIGN
      3099>>ASSIGN   3106>>IF       3108<>CALL     3111>>IF       3112>>ASSIGN   3113>>ASSIGN   3132>>CALL
IRM_SYSID
      1860**DCL      3013>>IF
J
      1831**DCL      2426<<DOINDEX  2427>>IF       2428>>ASSIGN   2428>>ASSIGN   2519<<DOINDEX  2520>>ASSIGN
      2559<<DOINDEX  2560>>IF       2561>>IF       2662<<DOINDEX  2663>>IF       2664>>ASSIGN   2665>>IF
      2666>>ASSIGN   2667>>ASSIGN   2667>>ASSIGN   2674>>ASSIGN   2693<<ASSIGN   2732>>ASSIGN   2733>>ASSIGN
      2734<<ASSIGN   2734>>ASSIGN   2737>>ASSIGN   2741<<DOINDEX  2742>>ASSIGN   2784<<DOINDEX  2785>>ASSIGN
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:154  
      2822<<DOINDEX  2823>>ASSIGN   2838<<DOINDEX  2839>>CALL     2842<<ASSIGN   2845>>ASSIGN   2846>>IF
      2852<<DOINDEX  2853>>ASSIGN   2866>>IF       2866>>IF       2866>>IF       2866>>IF       2866>>IF
      2866>>IF       2866>>IF       2973<<DOINDEX  2974>>ASSIGN   2976>>ASSIGN   2976>>ASSIGN   2977>>ASSIGN
      2977>>ASSIGN   2978>>IF       2978>>IF       2980>>ASSIGN   2980>>ASSIGN   3042<>CALL     3043<<ASSIGN
      3043>>ASSIGN   3044>>IF       3045>>ASSIGN   3046<<ASSIGN   3052>>IF       3053<<ASSIGN   3053>>ASSIGN
      3054>>ASSIGN   3057>>ASSIGN   3058>>ASSIGN   3059>>ASSIGN   3060<<ASSIGN   3060>>ASSIGN   3065>>IF
      3067>>ASSIGN
K
      1832**DCL      1833--REDEF    2660<<ASSIGN   2666>>ASSIGN   2683>>ASSIGN   2685>>ASSIGN   2686<<ASSIGN
      2686>>ASSIGN   2690>>ASSIGN   2740<<ASSIGN   2747>>ASSIGN   2748<<ASSIGN   2748>>ASSIGN   2753>>ASSIGN
      3085<<DOINDEX  3086>>IF
LESMEM
      2014**DCL      2598>>ASSIGN
MAX
      1834**DCL      1835--REDEF    2529<>CALL     2530<<ASSIGN   2530>>ASSIGN   2531>>IF       2532<<ASSIGN
      2532>>ASSIGN   2534>>IF       2545<<ASSIGN   2546>>ASSIGN   2548>>DOINDEX  2907<>CALL     2908<<ASSIGN
      2908>>ASSIGN   2909>>IF       2910<<ASSIGN   2910>>ASSIGN   2912>>ASSIGN   2918>>IF       2940>>IF
MBDZ
      2495**LABEL    2479--CALLALT
MBDZU
      2472**LABEL    2467--CALLALT
MEMORY
      1829**DCL      2421<<ASSIGN   2423<<ASSIGN   2455>>ASSIGN   2481<<ASSIGN   2482<<ASSIGN   2483>>IF
      2483<<ASSIGN   2484>>ASSIGN   2516<<ASSIGN   2588<<ASSIGN   2589>>IF       2590<<ASSIGN   2591>>IF
      2592<<ASSIGN   2593>>IF       2593<<ASSIGN   2594>>ASSIGN   2595>>ASSIGN   2596>>IF       2597>>ASSIGN
      2643<<ASSIGN   2644>>IF       2645>>IF       2655<<ASSIGN   2657>>ASSIGN   2829>>ASSIGN   2830>>ASSIGN
      2888>>IF       2888>>IF       2948>>ASSIGN   2949>>ASSIGN   2952>>ASSIGN   2991<<ASSIGN
MODE
      1828**DCL      2417<<ASSIGN   2515<<ASSIGN   2586>>IF       2589>>IF       2589>>IF       2590>>ASSIGN
      2590>>ASSIGN   2594>>ASSIGN   2594>>ASSIGN   2709<>CALL     2765<<ASSIGN   2812<>CALL     2829>>ASSIGN
      2829>>ASSIGN   2832>>ASSIGN   2832>>ASSIGN   2839<>CALL     2866>>IF       2866>>IF       2888>>IF
      2888>>IF       2947>>IF       2948>>ASSIGN   2948>>ASSIGN   2950>>IF       2976>>ASSIGN   2976>>ASSIGN
      2978>>IF       3022<>CALL     3120<>CALL
N$DCT$
      1858**DCL      3115>>ASSIGN
N$DCT$$
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:155  
      1859**DCL      1858--IMP-PTR  3115>>ASSIGN
NALRL
      2002**DCL      2645>>ASSIGN   2668>>ASSIGN   2726>>ASSIGN   2745>>ASSIGN
NAUTH
      1994**DCL      2507>>ASSIGN
NI$DCT.DP
      1707**DCL      1714--REDEF    1717--REDEF    1718--REDEF    1720--REDEF    1720--REDEF    1721--REDEF
      1722--REDEF    1722--REDEF
NI$DCT.MPC.IOCHANX
      1715**DCL      1715--REDEF
NI$DCT.RAT$
      1688**DCL      3115>>ASSIGN
NOGET IN PROCEDURE ALLOC
      2835**LABEL    2812--CALLALT
NOGPSN IN PROCEDURE ALLOC
      2842**LABEL    2788--GOTO     2789--CALLALT  2801--GOTO     2804--GOTO     2805--CALLALT
NOMEM
      2018**DCL      2891>>ASSIGN
NOMOS
      1978**DCL      2871>>ASSIGN
NOPSN
      2010**DCL      2846>>ASSIGN
NORELPSN
      2745**LABEL    2751--CALLALT
NORMRM
      1982**DCL      2536>>ASSIGN   2920>>ASSIGN   3065>>ASSIGN
NORQD
      1998**DCL      2562>>ASSIGN
NOSU
      2429**LABEL    2422--CALLALT
NRLOP
      2006**DCL      2646>>ASSIGN   2713>>ASSIGN   2726>>IF       3011>>IF       3012>>ASSIGN
NXTPRR
      2734**LABEL    2710--GOTO
NXTRACCK
      2612**LABEL    2620--GOTO
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:156  
NXTRQD
      2580**LABEL    2572--GOTO
NXTSU
      2445**LABEL    2430--GOTO
NXTSUR
      2686**LABEL    2675--GOTO
P
      1841**DCL      2742<<ASSIGN   2747>>ASSIGN   2785<<ASSIGN   2853<<ASSIGN
P.DISP
      1844**DCL      2995<<ASSIGN   3118>>IF       3122>>IF       3132>>IF
P.PSN
      1842**DCL      2791>>ASSIGN   3098>>IF
P.USAGE
      1843**DCL      2788>>IF       2800>>IF
PHYALOC IN PROCEDURE ALLOC
      2803**LABEL    2783--CALLALT
PRC$
      1848**DCL      1434--IMP-PTR  2486<<ASSIGN   2487>>ASSIGN   2488>>ASSIGN   2489>>ASSIGN   2491<<ASSIGN
      2493>>IF       2494>>ASSIGN   3113<<ASSIGN   3114>>DOWHILE  3115>>ASSIGN   3128<<ASSIGN   3128>>ASSIGN
PRM$
      1846**DCL      2485<<ASSIGN   2487>>ASSIGN   2488>>ASSIGN   2489>>ASSIGN   2490<<ASSIGN   2493>>IF
      2494>>ASSIGN
RAT
        69**DCL      2618<>CALL     2708<>CALL     2709<>CALL     2825<>CALL     2839<>CALL     3021<>CALL
      3022<>CALL     3119<>CALL     3120<>CALL     3122<>CALL
RAT.FLG.DOWN
       104**DCL      2927>>IF
RAT.FLG.MBIT.MTD
        97**DCL      3125<<ASSIGN
RAT.FLG.OPN
       101**DCL      2707>>IF       3010>>IF       3015<<ASSIGN   3020>>IF       3117<<ASSIGN
RAT.LNK$
        70**DCL      2622>>ASSIGN   2724>>ASSIGN   2937>>ASSIGN   3027>>ASSIGN
RAT.M1
        91**DCL      2928>>ASSIGN
RAT.REEL.ASID
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:157  
        89**DCL      3026>>IF       3026<<ASSIGN   3124<<ASSIGN
RAT.RES.ACTX
        75**DCL      2616>>IF       2617<<ASSIGN   2818<<ASSIGN
RAT.RES.M2
        74**DCL      2932>>ASSIGN
RAT.RES.NUMB
        73**DCL      2705>>IF       2815<<ASSIGN   2931>>ASSIGN
RAT.RES.RFLG.NOSLD
        79**DCL      2817<<ASSIGN   2826<<ASSIGN
RAT.RES.SISID
        72**DCL      2616>>IF       2705>>IF       2917>>IF       3009>>IF       3116>>IF
RAT.TYP
        93**DCL      2705>>IF       2824>>IF       2925>>ASSIGN
RAT$
      1845**DCL        69--IMP-PTR  1846--REDEF    1847--REDEF    2614<<ASSIGN   2615>>DOWHILE  2616>>IF
      2616>>IF       2617>>ASSIGN   2618>>CALL     2622<<ASSIGN   2622>>ASSIGN   2703<<ASSIGN   2704>>DOWHILE
      2705>>IF       2705>>IF       2705>>IF       2707>>IF       2708>>CALL     2709>>CALL     2724<<ASSIGN
      2724>>ASSIGN   2813<<ASSIGN   2814>>ASSIGN   2815>>ASSIGN   2817>>ASSIGN   2818>>ASSIGN   2823<<ASSIGN
      2824>>IF       2825>>CALL     2826>>ASSIGN   2915<<ASSIGN   2916>>DOWHILE  2917>>IF       2925>>ASSIGN
      2927>>IF       2928>>ASSIGN   2931>>ASSIGN   2932>>ASSIGN   2937<<ASSIGN   2937>>ASSIGN   3007<<ASSIGN
      3008>>DOWHILE  3009>>IF       3010>>IF       3015>>ASSIGN   3020>>IF       3021>>CALL     3022>>CALL
      3026>>IF       3026>>ASSIGN   3027<<ASSIGN   3027>>ASSIGN   3115<<ASSIGN   3116>>IF       3117>>ASSIGN
      3119>>CALL     3120>>CALL     3122>>CALL     3124>>ASSIGN   3125>>ASSIGN
RCD
      1833**DCL      2612<<DOINDEX  2614>>ASSIGN   2697<<ASSIGN   2700<<ASSIGN   2702<<ASSIGN   2703>>ASSIGN
      2914<<DOINDEX  2915>>ASSIGN   3005<<DOINDEX  3007>>ASSIGN
RELALL
      2989**PROC     2638--CALL     2768--CALL
RELSET IN PROCEDURE CKSET
      3104**ENTRY    2751--CALL     3000--CALL
RETALT IN PROCEDURE CKSET
      3132**LABEL    3108--CALLALT
RLALLAGIN IN PROCEDURE RELALL
      3005**LABEL    3023--GOTO
RLST.DISK
      1801**DCL      2487<<ASSIGN
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:158  
RLST.MEMORY
      1800**DCL      2484<<ASSIGN   2516>>ASSIGN
RLST.OTHER
      1803**DCL      2489<<ASSIGN
RLST.SULST
      1804**DCL      2497<<ASSIGN   2518>>ASSIGN
RLST.TAPES
      1802**DCL      2488<<ASSIGN
RMEM
      2946**PROC     2658--CALL     2992--CALL
RNUM
      1840**DCL      2696<<ASSIGN   2705>>IF       2733>>ASSIGN
RPHYS
      2690**LABEL    2642--CALLALT
RPSN1 IN PROCEDURE RELALL
      2999**LABEL    2999--CALLALT
RPSNS
      2737**LABEL    2692--CALLALT
RSUDO IN PROCEDURE RMEM
      2971**ENTRY    2689--CALL     2994--CALL
RTYP
      1839**DCL      2695<<ASSIGN   2697>>IF       2698>>IF       2698>>IF       2698>>IF       2699<<ASSIGN
      2705>>IF
SC_NRNDWN
      1884**DCL-ENT  3013--CALL
SC_R2MANY
      1883**DCL-ENT  2950--CALL     2979--CALL
SETU$
      1847**DCL      1446--IMP-PTR  2789<>CALL     3083<<ASSIGN   3084>>DOWHILE  3085>>DOINDEX  3086>>IF
      3088<<ASSIGN   3088>>ASSIGN
SSS$BLOCK
      1880**DCL-ENT  2763--CALL
STRSOP
      1837**DCL      2415<<ASSIGN   2451<<ASSIGN   2633<<ASSIGN   2757>>IF       2766<<ASSIGN   2816>>IF
      2822>>IF       2983>>IF       3013>>IF       3015>>IF       3021>>IF       3023>>IF       3107>>IF
      3109>>IF       3119>>IF       3136>>IF
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:159  
SUALOC IN PROCEDURE ALLOC
      2826**LABEL    2810--CALLALT
SUARAY
      1850**DCL      2420<<ASSIGN   2428<<ASSIGN   2428>>ASSIGN   2457>>IF       2459>>ASSIGN   2461<>CALL
      2518<<ASSIGN   2659<<ASSIGN   2664>>ASSIGN   2667<<ASSIGN   2674<<ASSIGN   2831>>IF       2832>>ASSIGN
      2833>>ASSIGN   2866>>IF       2866>>IF       2866>>IF       2974>>ASSIGN   2983>>IF       2983<>CALL
      2993<<ASSIGN
SUCHK
      2864**PROC     2429--CALL     2521--CALL
SUCKM IN PROCEDURE SUCHK
      2886**ENTRY    2424--CALL     2517--CALL
SUDO
      1838**DCL      2494<<ASSIGN   2495<<ASSIGN   2496>>IF       2496<<ASSIGN   2497>>ASSIGN   2664<<ASSIGN
      2665>>IF       2666>>ASSIGN   2674>>ASSIGN   2974<<ASSIGN   2975>>IF       2976>>ASSIGN   2977>>ASSIGN
      2980>>ASSIGN
SUFAIL
      2433**LABEL    2424--CALLALT  2429--CALLALT  2517--CALLALT  2521--CALLALT  2570--GOTO     2581--GOTO
SYSID
      1827**DCL      2416<<ASSIGN   2466>>IF       2474<<ASSIGN   2505>>IF       2514<<ASSIGN   2616>>IF
      2631>>IF       2705>>IF       2764<<ASSIGN   2793>>ASSIGN   2803>>IF       2805<>CALL     2812<>CALL
      2855<>CALL     2903<<ASSIGN   2917>>IF       2917>>IF       2926>>IF       2927>>IF       3009>>IF
      3026>>IF       3038<<ASSIGN   3051>>IF       3080>>IF       3086>>IF       3116>>IF       3132<>CALL
T$
      1849**DCL      2812<>CALL     2813>>ASSIGN
VPR
      1815**DCL      2908--ASSIGN
VPR.FAILX
      1815**DCL      2837<<ASSIGN   2911<<ASSIGN   2919<<ASSIGN
VPR.NN
      1815**DCL      2694>>DOINDEX  2737<<ASSIGN   2811>>DOINDEX  2822>>DOINDEX  2912<<ASSIGN   2940<<ASSIGN
VPR.PRLIST
      1815**DCL      2908--ASSIGN   2910--ASSIGN
VPR.PRLIST.ATTR
      1816**DCL      2812<>CALL     2928<<ASSIGN   2932<<ASSIGN
VPR.PRLIST.RAT$
      1816**DCL      2814<<ASSIGN   2823>>ASSIGN   2839>>CALL
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:160  
VPR.PRLIST.RNAME
      1815**DCL      1815--REDEF
VPR.PRLIST.RNME.NUM
      1815**DCL      2696>>ASSIGN   2733<<ASSIGN   2815>>ASSIGN   2931<<ASSIGN
VPR.PRLIST.RNME.TYP
      1815**DCL      2695>>ASSIGN   2732<<ASSIGN   2732>>ASSIGN   2812<>CALL     2925<<ASSIGN
VPS
      1819**DCL      3043--ASSIGN
VPS.FAILX
      1819**DCL      2845<<ASSIGN   2852>>DOINDEX  3054<<ASSIGN   3068<<ASSIGN
VPS.NN
      1819**DCL      2741>>DOINDEX  2753<<ASSIGN   2784>>DOINDEX  2842>>ASSIGN   2846>>IF       3045<<ASSIGN
      3052>>IF       3065>>IF       3067<<ASSIGN
VPS.RPLIST
      1819**DCL      2742>>ASSIGN   2747<<ASSIGN   2785>>ASSIGN   2853>>ASSIGN   3043--ASSIGN   3045--ASSIGN
VPS.RPLIST.PSN
      1819**DCL      3057<<ASSIGN
VPS.RPLIST.USAGE
      1819**DCL      3058<<ASSIGN   3059<<ASSIGN
VRCTL.MBSDISP
      1808**DCL      2465>>IF
VRCTL.RELALL
      1808**DCL      2637>>IF
VRCTL.SYSID
      1808**DCL      2514>>ASSIGN
VSU
      1811**DCL      2530--ASSIGN
VSU.FAILX
      1811**DCL      2445<<ASSIGN   2533<<ASSIGN   2535<<ASSIGN
VSU.MEMORY
      1811**DCL      2423>>ASSIGN   2468<<ASSIGN   2547<<ASSIGN   2643>>ASSIGN   2657<<ASSIGN   2657>>ASSIGN
VSU.NN
      1811**DCL      2425>>DOINDEX  2472<<ASSIGN   2546<<ASSIGN   2558>>DOINDEX  2661>>DOINDEX  2690<<ASSIGN
VSU.PSLIST
      1811**DCL      2530--ASSIGN   2532--ASSIGN
VSU.PSLIST.NUM
PL6.E3A0      #001=FRP$PMME File=FRP$PMME.:E05TSI                                TUE 07/29/97 17:23 Page:161  
      1812**DCL      2428>>ASSIGN   2550<<ASSIGN   2561>>IF       2664>>ASSIGN   2666<<ASSIGN   2683<<ASSIGN
      2683>>ASSIGN
VSU.PSLIST.PSEUDO
      1812**DCL      2427>>IF       2470<<ASSIGN   2549<<ASSIGN   2560>>IF       2663>>IF       2685<<ASSIGN
      2685>>ASSIGN
