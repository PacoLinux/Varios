VERSION E05

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:1    
        1        1        /*M* QCR$READ:  Screen READ or ACCEPT post-processing.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QCR$READ
       10       10              PURPOSE:      Do post-M$READ processing of fields.
       11       11              DESCRIPTION:  CALLs QCI$IO_READ, then edits the contents of fields
       12       12                            actually M$READ before returning to higher-level
       13       13                            callers.
       14       14        */
       15       15
       16       16        QCR$READ: PROC ( QCR@READ );
       17       17
       18       18        /*D*  NAME:         QCR$READ
       19       19              CALL:         CALL QCR$READ ( QCR@READ );
       20       20              PARAMETERS:   QCR@READ is a structure which contains information
       21       21                            concerning the fields to be read and edited; it's
       22       22                            generated by invoking the QCR@READ %MACRO within the
       23       23                            QCR_READ_M %INCLUDE file (see commentary within
       24       24                            that file).
       25       25              INTERFACE:    Called by routines wishing to perform perform
       26       26                            non-message-line terminal M$READs, and further
       27       27                            wishing the input to be edited after the read in
       28       28                            typical FPL fashion (QBA$ACCEPT, QBR$READ_FORM,
       29       29                            QCG$GET_FIELD).
       30       30              ENVIRONMENT:  Nothing unusual.
       31       31              INPUT:        QI_1, etc.
       32       32              OUTPUT:       QI_1, etc.
       33       33              SCRATCH:      Various otter stuff.
       34       34              DESCRIPTION:  The calling routine (ACCEPT, READ_FORM, or GET_FIELD),
       35       35                            sets up the starting and stopping indices for both
       36       36                            frames within the form to be read, and fields within
       37       37                            those frames to be read.  QCI$IO_READ is then called
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:2    
       38       38                            (with similar indices) to do the actual I-O.  The
       39       39                            indices are narrowed down, and the fields actually
       40       40                            read, are marked by QCI$IO_READ, and post-read editing
       41       41                            is performed on those fields.
       42       42                            This editing includes:
       43       43                            1)  supplying any necessary DEFAULT VALUEs;
       44       44                            2)  checking the composition of the input data according
       45       45                                to the field's DAD type;
       46       46                            3)  verifying the input data against any picture strings
       47       47                                associated with the field's DAD;
       48       48                            4)  taking into account any FILL CHARACTER, MINIMUM SIZE,
       49       49                                and/or CLASS clauses associated with the field's DAD.
       50       50                            If the input is deemed invalid, QCG$GET_FIELD is called
       51       51                            with indices indicating only the field in error, and
       52       52                            that routine re-prompts for that field.
       53       53        */
       54       54
       55       55          %INCLUDE LCP_6;
       56      246          %INCLUDE G_JIT_M;
       57      511          %G$JIT;
       58      925    1     DCL G$JIT$ PTR SYMREF;
       59      926
       60      927          %INCLUDE QG_MACRO_M;
       61     1064          %INCLUDE QI_EQUATES_E;
       62     1423          %INCLUDE QI_PERR_C;
       63     1591          %INCLUDE QI_MACROS_M;
       64     6649          %QI$ALL;
       65    17762
       66    17763    1     DCL CLASS_ALPHABET$ PTR;
       67    17764    1     DCL CLASS_INDEX SBIN;
       68    17765    1     DCL CLASS_THING$ PTR;
       69    17766    1     DCL CLASS_TYPE UBIN;
       70    17767    1     DCL CURRENT_INDEX SBIN;
       71    17768    1     DCL DATA_INDEX UBIN;
       72    17769    1     DCL DATA_SIGN UBIN;
       73    17770    1     DCL DEFAULT_INDEX SBIN;
       74    17771    1     DCL DIGIT_INDEX UBIN;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:3    
       75    17772    1     DCL DIGIT_LENGTH UBIN;
       76    17773    1     DCL ERROR_CODE UBIN;
       77    17774    1     DCL FIELD_DAD$ PTR;
       78    17775    1     DCL FIELD_DAD_P$ PTR;
       79    17776    1     DCL FIELD_IDENTIFIER$ PTR;
       80    17777    1     DCL FIELD_INDEX UBIN;
       81    17778    1     DCL FILL_CHARACTER UBIN;
       82    17779    1     DCL 1 FILL_CHARACTER_MINIMUM_SIZE REDEF FILL_CHARACTER,
       83    17780    1           2 FILL_CHARACTER UBIN(8) UNAL,
       84    17781    1           2 MINIMUM_SIZE UBIN(8) UNAL;
       85    17782    1     DCL FRAME$ PTR;
       86    17783    1     DCL FRAME_INDEX UBIN;
       87    17784    1     DCL FRAME_STATUS$ PTR;
       88    17785    1     DCL GZ_FIELD$ PTR;
       89    17786    1     DCL LAST_DAD$ PTR;
       90    17787    1     DCL MAXIMUM_SIZE UBIN;
       91    17788    1     DCL MAXIMUM_SIZE_TEXT CHAR(2);
       92    17789    1     DCL MINIMUM_SIZE UBIN;
       93    17790    1     DCL MINIMUM_SIZE_TEXT CHAR(3);
       94    17791    1     DCL MOP_STRING_INDEX UBIN;
       95    17792    1     DCL NONBLANK_INDEX UBIN;
       96    17793    1     DCL NONBLANK_LENGTH UBIN;
       97    17794    1     DCL PIC$ PTR;
       98    17795    1     DCL P_ITEM_INDEX UBIN;
       99    17796    1     DCL SOURCE_INDEX UBIN;
      100    17797    1     DCL STARTING_INDEX UBIN;
      101    17798    1     DCL TARGET_INDEX UBIN;
      102    17799    1     DCL THIS_MOP_FUNCTIONS_LENGTH UBIN;
      103    17800    1     DCL 1 U$1 BASED ( U1$ ),
      104    17801    1           2 LENGTH UBIN BYTE UNAL,
      105    17802    1           2 TEXT CHAR(3);
      106    17803    1     DCL 1 U1 AUTO,
      107    17804    1           2 LENGTH UBIN BYTE UNAL,
      108    17805    1           2 TEXT CHAR(3);
      109    17806    1     DCL U1$ PTR;
      110    17807    1     DCL VARIABLE_SOURCE$ CPTR;
      111    17808    1     DCL VARIABLE_TARGET$ CPTR;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:4    
      112    17809    1     DCL WE_GOTTA_DEFAULT_VALUE BIT(1) ALIGNED;
      113    17810    1     DCL WE_GOTTA_FILL_CHARACTER BIT(1) ALIGNED;
      114    17811
      115    17812          %QI@MAT;
      116    18480          %QI@SRCH_VRFY;
      117    19152
      118    19153          %SET LISTMAC = '1'B;
      119    19154
      120    19155          %QI@OTTER_SPACE ( BYTE_SIZE = %QI#MAXIMUM_FIELD_LENGTH );
             19156            %BEGIN_MACRO ( STCLASS = STCLASS );
             19157            %SET LISTDIR = '0'B;
             19170    1       DCL 1 QI@OTTER_SPACE AUTO ALIGNED,
             19171    1             2 *(0:255) UBIN BYTE UNAL /* Was INIT'ed to:  (0*0)/**/;
             19172    1       DCL 1 QI@OTTER_SPACE_CA (0:255) REDEF QI@OTTER_SPACE CHAR(1) UNAL;
             19173    1       DCL 1 QI@OTTER_SPACE_BA (0:255) REDEF QI@OTTER_SPACE UBIN BYTE UNAL;
             19180            %ENDIF;
      121    19183    1     DCL OTTER_ERROR_MESSAGE CHAR(80);
      122    19184
      123    19185          %INCLUDE QCD_DE_EDIT_M;
      124    19215          %QCD@DE_EDIT;
             19216            %BEGIN_MACRO ( STCLASS = STCLASS );
             19217            %SET LISTDIR = '0'B;
             19230    1     DCL 1 QCD@DE_EDIT ALIGNED,
             19231    1           2 IS_NUMBER_INVALID BIT(1) ALIGNED,
             19232                                           /* Set to 1 if the input is bad,
             19233                                                     0 otherwise.           */
             19234    1           2 RESULT ALIGNED,
             19235    1             3 DIGIT_A(0:30) UBIN BYTE UNAL,
             19236                                           /* The de-edited number, in the form:
             19237                                              UNPACKED((INDEX(RESULT),B7),0,31,LEADING) */
             19238    1             3 DEC SBIN,
             19239                                           /* Decimal position for DIGIT_A */
             19240    1             3 INPUT_SIZE SBIN;
             19241                                           /* Length of input minus
             19242                                              leading or trailing blanks */
             19249            %ENDIF;
      125    19252
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:5    
      126    19253          %INCLUDE QCG_GET_FIELD_M;
      127    19292          %QCG@GET_FIELD;
             19293            %BEGIN_MACRO;
             19294            %SET LISTDIR = '0'B;
             19307    1     DCL 1 QCG@GET_FIELD ALIGNED,
             19308    1           2 MESSAGE_LINE_GZ_HEADER$ PTR,
             19309                           /* Pointer to QI$GZ_HEADER for the
             19310                              MESSAGE LINE to use.  */
             19311    1           2 IS_MESSAGE_A_DAD BIT(1) ALIGNED,
             19312                           /* Set if MESSAGE$ points to a DAD,
             19313                              reset if MESSAGE$ points to text
             19314                              (in which case MESSAGE_LENGTH is valid).  */
             19315    1           2 MESSAGE_LENGTH UBIN,
             19316                           /* Length, in bytes, of the error message.  */
             19317    1           2 MESSAGE$ PTR,
             19318                           /* See IS_MESSAGE_A_DAD.  */
             19319    1           2 FRAME_INDEX UBIN,
             19320                           /* Index of the current frame.  */
             19321    1           2 FIELD_INDEX UBIN,
             19322                           /* Index of the field to re-get (if any).  */
             19323    1           2 STATUS UBIN,
             19324                           /* Returned status code:  0 -> Immediate return to level 0;
             19325                                                    >0 -> Status is ok.  */
             19326    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19327                           /* Passed index for QCG$GET_FIELD processing.  */
             19334            %ENDIF;
      128    19337
      129    19338          %INCLUDE QCI_IO_READ_M;
      130    19378          %QCI@IO_READ;
             19379            %BEGIN_MACRO ( STCLASS = STCLASS );
             19380            %SET LISTDIR = '0'B;
             19393    1     DCL 1 QCI@IO_READ ALIGNED,
             19394    1           2 FRAME_START_INDEX UBIN,
             19395                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19396    1           2 FRAME_STOP_INDEX UBIN,
             19397                          /* Stopping index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19398    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:6    
             19399                          /* If IS_FIELD_INDEXES_VALID, use them;
             19400                             else use all the fields in the frame.  */
             19401    1           2 FIELD_START_INDEX UBIN,
             19402                          /* Starting index into QI$GZ_FIELD table.  */
             19403    1           2 FIELD_STOP_INDEX UBIN,
             19404                          /* Stopping index into QI$GZ_FIELD table.  */
             19405    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19406                          /* If IS_CURSOR_POSITION_VALID, use it;
             19407                             else allow cursor to default to upper-left-most field.  */
             19408    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19409                          /* POSition of the field on which to place the cursor.  */
             19410    1           2 STATUS UBIN,
             19411                          /* Returned status code:  0 -> Immediate return to level 0;
             19412                                                   >0 -> Status is ok.  */
             19413    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19414                          /* Passed index for QCG$GET_FIELD processing.  */
             19421            %ENDIF;
      131    19424
      132    19425          %INCLUDE QCR_READ_M;
      133    19465          %QCR@READ;
             19466            %BEGIN_MACRO ( STCLASS = STCLASS );
             19467            %SET LISTDIR = '0'B;
             19480    1     DCL 1 QCR@READ ALIGNED,
             19481    1           2 FRAME_START_INDEX UBIN,
             19482                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19483    1           2 FRAME_STOP_INDEX UBIN,
             19484                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19485    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19486                          /* If IS_FIELD_INDEXES_VALID, use them;
             19487                             else use all the fields in the frame.  */
             19488    1           2 FIELD_START_INDEX UBIN,
             19489                          /* Starting index into QI$GZ_FIELD table.  */
             19490    1           2 FIELD_STOP_INDEX UBIN,
             19491                          /* Stopping index into QI$GZ_FIELD table.  */
             19492    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19493                          /* If IS_CURSOR_POSITION_VALID, use it;
             19494                             else allow cursor to default to upper-left-most field.  */
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:7    
             19495    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19496                          /* POSition of the field on which to place the cursor.  */
             19497    1           2 STATUS UBIN,
             19498                          /* Returned status code:  0 -> Immediate return to level 0;
             19499                                                   >0 -> Status is ok.  */
             19500    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19501                          /* Passed index for QCG$GET_FIELD processing.  */
             19508            %ENDIF;
      134    19511
      135    19512          %SET LISTMAC = '0'B;
      136    19513
      137    19514    1     DCL QCA$ALL_LITERAL_MOVE_A ENTRY;
      138    19515    1     DCL QCC$ACM ENTRY (1);
      139    19516    1     DCL QCC$CBD ENTRY (1);
      140    19517    1     DCL QCC$MAT ENTRY (1);
      141    19518    1     DCL QCC$DMC ENTRY (1) ALTRET;
      142    19519    1     DCL QCC$SRCH ENTRY (1) ALTRET;
      143    19520    1     DCL QCC$VRFY ENTRY (1) ALTRET;
      144    19521    1     DCL QCD$DE_EDIT ENTRY (1);
      145    19522    1     DCL QCE$ERROR ENTRY (4);
      146    19523    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
      147    19524    1     DCL QCE$ERROR_MESSAGE ENTRY (5);
      148    19525    1     DCL QCG$GET_FIELD ENTRY (1);
      149    19526    1     DCL QCI$IO_READ ENTRY (1);
      150    19527    1     DCL QCS$SETUP_SOURCE ENTRY;
      151    19528
      152    19529          /* CONSTANT error-message stuff */
      153    19530    1     DCL OOPS_EMBEDDED_BLANKS CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      154    19531    1       INIT ( 'Embedded blank(s) in numeric input.' );
      155    19532    1     DCL OOPS_SIGN_ONLY CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      156    19533    1       INIT ( 'No numeric value entered.' );
      157    19534    1     DCL OOPS_NON_NUMERICAL CHAR(0) CONSTANT
      158    19535    1       INIT ( 'Illegal numeric character:  "x".' );
      159    19536    1     DCL OOPS_ILLEGAL_CHARACTER CHAR(0) CONSTANT
      160    19537    1       INIT ( 'Illegal character:  "x".' );
      161    19538    1     DCL OOPS_MINIMUM_SIZE CHAR(0) CONSTANT
      162    19539    1       INIT ( 'Length of data must be at least ' );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:8    
      163    19540    1     DCL OOPS_MAXIMUM_SIZE CHAR(0) CONSTANT
      164    19541    1       INIT ( 'Length of data may be at most ' );
      165    19542    1     DCL OOPS_WITH_LEADING_SIGN CHAR(0) CONSTANT
      166    19543    1       INIT ( ' digits with an optional leading sign.' );
      167    19544    1     DCL OOPS_WITH_TRAILING_SIGN CHAR(0) CONSTANT
      168    19545    1       INIT ( ' digits with an optional trailing sign.' );
      169    19546    1     DCL OOPS_ILLEGAL_INPUT CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      170    19547    1       INIT ( 'Data entered is badly formed.' );
      171    19548    1     DCL OOPS_ENTRY_REQUIRED CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      172    19549    1       INIT ( 'Entry required.' );
      173    19550    1     DCL OOPS_FULLA_FILL CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      174    19551    1       INIT ( 'Data entry of only fill characters with class check is illegal.' );
      175    19552        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:9    
      176    19553            /*  Set up a global OTTER_SPACE pointer so that QCI$IO_READ
      177    19554                can use our auto for "scratch" space.  */
      178    19555    1       QI_1.OTTER_SPACE.T$ = ADDR ( QI@OTTER_SPACE );
      179    19556
      180    19557    1       QCI@IO_READ = QCR@READ;
      181    19558
      182    19559    1       CALL QCI$IO_READ ( QCI@IO_READ );
      183    19560
      184    19561    1       QCR@READ.STATUS = QCI@IO_READ.STATUS;
      185    19562
      186    19563    1       IF QCI@IO_READ.STATUS = %QI#USE_INVALID_RETURN
      187    19564    1       THEN
      188    19565    1         RETURN;
      189    19566
      190    19567            /*  If no field data was replaced by QCI$IO_READ,
      191    19568                QCI@IO_READ.FRAME_START_INDEX will be
      192    19569                > QCI@IO_READ.FRAME_STOP_INDEX, and we'll just return.  */
      193    19570    1   CHECK_THEM_FRAMES:
      194    19571    1       DO FRAME_INDEX =
      195    19572    2         QCI@IO_READ.FRAME_START_INDEX TO QCI@IO_READ.FRAME_STOP_INDEX;
      196    19573
      197    19574              %PROC_ADDRESS ( THING@P =
             19574                  "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
      198    19575              CHECK_FOR_INDIRECTION = NO,
      199    19576              RESULT$ = FRAME$ );
      200    19613
      201    19614              %DATA_ADDRESS ( THING@D = "FRAME$ -> QI$FRAME.STATUS_AREA@D",
      202    19615              CHECK_FOR_INDIRECTION = NO,
      203    19616              RESULT$ = FRAME_STATUS$ );
      204    19653
      205    19654    2         IF FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
      206    19655    2         THEN
      207    19656    2   FRAME_IS_ACTIVE:
      208    19657    3           DO;
      209    19658
      210    19659    3             IF NOT QCI@IO_READ.IS_FIELD_INDEXES_VALID
      211    19660    3             THEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:10   
      212    19661    4               DO;
      213    19662    4                 QCI@IO_READ.FIELD_START_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19662                          FIELD_START_INDEX;
      214    19663    4                 QCI@IO_READ.FIELD_STOP_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19663                          FIELD_STOP_INDEX;
      215    19664    4               END;
      216    19665
      217    19666                 %IF QI#DEBUG;
      218    19667
      219    19668    3             IF QCR@READ.IS_FIELD_INDEXES_VALID
      220    19669    3               AND QCI@IO_READ.IS_FIELD_INDEXES_VALID
      221    19670    3               AND ( QCR@READ.FIELD_START_INDEX >
      222    19671    3               QCI@IO_READ.FIELD_STOP_INDEX )
      223    19672    3             THEN
      224    19673    3               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      225    19674
      226    19675                 %ENDIF;
      227    19676
      228    19677    3             GZ_FIELD$ = PINCRW (
      229    19678    3               FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$,
      230    19679    3               QCI@IO_READ.FIELD_START_INDEX * SIZEW (QI$GZ_FIELD)
      231    19680    3               );
      232    19681
      233    19682    3             LAST_DAD$ = ADDR (NIL);
      234    19683
      235    19684    3   POST_EDIT_THEM_FIELDS:
      236    19685    4             DO FIELD_INDEX = QCI@IO_READ.FIELD_START_INDEX TO QCI@IO_READ.
             19685                      FIELD_STOP_INDEX;
      237    19686
      238    19687    4   RETRY_FIELD_POST_EDITING:
      239    19688    4               IF GZ_FIELD$ -> QI$GZ_FIELD.OPERATION.IS_DONE
      240    19689    4               THEN
      241    19690    4   THAT_SUCKER_IS_DONE:
      242    19691    5                 DO;
      243    19692
      244    19693    5                   GZ_FIELD$ -> QI$GZ_FIELD.OPERATION.IS_DONE = %NO;
      245    19694
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:11   
      246    19695    5                   FIELD_DAD$ = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$;
      247    19696
      248    19697                        /*  Increment past any level_multipliers to the
      249    19698                            P.whatever flags.  */
      250    19699    5                   FIELD_DAD_P$ = ADDR (
      251    19700    5                     FIELD_DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             19700                              LEVEL_MULTIPLIER_A
      252    19701    5                     ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      253    19702    5                     );
      254    19703
      255    19704    5                   IF GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_AOIM
      256    19705    5                     AND NOT GZ_FIELD$ -> QI$GZ_FIELD.STATUS.IS_AOIM_MODIFIED
      257    19706    5                   THEN
      258    19707    5   AOIM_FIELD_NOT_MODIFIED:
      259    19708    6                     DO;
      260    19709    6                       GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ -> QI$INDICATORS.
             19709                                STATE_VALUE = %QI#STATE_NULL;
      261    19710    6                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE = %YES;
      262    19711    6                       GOTO NEXT_FIELD_PLEASE;
      263    19712    6                     END AOIM_FIELD_NOT_MODIFIED;
      264    19713
      265    19714    5                   IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0
      266    19715    5                   THEN
      267    19716    5   NOTHING_ENTERED:
      268    19717    6                     DO;
      269    19718
      270    19719    6                       IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.DEFAULT
      271    19720    6                       THEN
      272    19721    7                         DO;
      273    19722
      274    19723                                %PRESENCE_DISPLACEMENT (
      275    19724                                PRESENCE_THING$ = FIELD_DAD_P$,
      276    19725                                INDEX = P_ITEM_INDEX,
      277    19726                                START = %QI#P_FIELD_FIRST_INDEX,
      278    19727                                STOP = %QI#P_DEFAULT_INDEX,
      279    19728                                RESULT = DEFAULT_INDEX
      280    19729                                );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:12   
      281    19761    7                           QI_1.SOURCE$ = ADDR (
      282    19762    7                             FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A ( DEFAULT_INDEX )
      283    19763    7                             );
      284    19764
      285    19765    7                           CALL QCS$SETUP_SOURCE;
      286    19766
      287    19767    7                           QI_1.OP.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;
      288    19768
      289    19769    8                           DO CASE ( QI_1.TYPE.S );
      290    19770
      291    19771    8                             CASE ( %QI#TYPE_DISPLAY );
      292    19772    8                               IF QI_1.IS_ALL_LIT.S
      293    19773    8                               THEN
      294    19774    8                                 GOTO PRETEND_ITS_ALPHANUMERIC;
      295    19775
      296    19776    8                               QI_1.OP.CIP.T_A (0) = %QI#CIP_DEFAULT_AS;
      297    19777    8                               QI_1.OP.CIP.T.CD.OFFSET = GZ_FIELD$ -> QI$GZ_FIELD.
             19777                                        STATUS.OFFSET;
      298    19778    8                               QI_1.OP.CIP.T.CD.SIGN = FIELD_DAD$ -> QI$FIELD_DAD.
             19778                                        PSEUDO_CIP.NUMERIC.CD.SIGN;
      299    19779    8                               QI_1.OP.CIP.T.LEN = QI_1.OP.CIP.S.LEN;
      300    19780    8                               IF QI_1.OP.CIP.T.CD.SIGN = %QI#CD_SIGN_LEADING_SEPARATE
      301    19781    8                                 OR QI_1.OP.CIP.T.CD.SIGN = %
             19781                                          QI#CD_SIGN_TRAILING_SEPARATE
      302    19782    8                               THEN
      303    19783    8                                 QI_1.OP.CIP.T.LEN = QI_1.OP.CIP.T.LEN + 1;
      304    19784    8                               QI_1.OP.DEC.T = 0;
      305    19785    8                               QI_1.OP.SIZE_ERROR = %QI#CHECK_FOR_SIZE_ERROR;
      306    19786
      307    19787    8                               CALL QCC$DMC ( QI_1.OP )
      308    19788    8                               WHENALTRETURN
      309    19789    9                                 DO;
      310    19790    9                                   GOTO OVERFLOW;
      311    19791    9                                 END;
      312    19792
      313    19793    8                               GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = QI_1.OP.CIP.T.
             19793                                        LEN;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:13   
      314    19794
      315    19795    8                             CASE ( %QI#TYPE_ALPHANUMERIC );
      316    19796    8   PRETEND_ITS_ALPHANUMERIC:
      317    19797    8                               QI_1.OP.CIP.T_A (0) = %( QI#CIP_INDEXED_TARGET_AS +
             19797                                        QI#FILL_BIT_MASK );
      318    19798    8                               QI_1.OP.CIP.T.CA.OFFSET = GZ_FIELD$ -> QI$GZ_FIELD.
             19798                                        STATUS.OFFSET;
      319    19799    8                               QI_1.OP.INX.T = 0;
      320    19800
      321    19801    8                               IF QI_1.IS_ALL_LIT.S
      322    19802    8                               THEN
      323    19803    9                                 DO;
      324    19804
      325    19805    9                                   QI_1.OP.LEN.T = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION
             19805                                            .LENGTH;
      326    19806
      327    19807    9                                   CALL QCA$ALL_LITERAL_MOVE_A;
      328    19808
      329    19809    9                                   GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = GZ_FIELD$
             19809                                            -> QI$GZ_FIELD.DESCRIPTION.LENGTH;
      330    19810
      331    19811    9                                 END;
      332    19812    8                               ELSE
      333    19813    9                                 DO;
      334    19814
      335    19815    9                                   QI_1.OP.LEN.T = QI_1.OP.LEN.S;
      336    19816
      337    19817    9                                   VARIABLE_SOURCE$ = PINCRC ( QI_1.OP.DATA.S$,
      338    19818    9                                     QI_1.OP.CIP.S.CA.OFFSET );
      339    19819    9                                   VARIABLE_TARGET$ = PINCRC ( QI_1.OP.DATA.T$,
      340    19820    9                                     QI_1.OP.CIP.T.CA.OFFSET );
      341    19821
      342    19822    9                                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =
      343    19823    9                                     VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT
             19823                                              ;
      344    19824
      345    19825    9                                   GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = QI_1.OP.LEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:14   
             19825                                            .T;
      346    19826
      347    19827    9                                 END;
      348    19828
      349    19829    8                             CASE ( ELSE );
      350    19830    8                               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      351    19831
      352    19832    8                           END;
      353    19833
      354    19834    7                           WE_GOTTA_DEFAULT_VALUE = %YES;
      355    19835
      356    19836    7                         END;
      357    19837    6                       ELSE
      358    19838    7                         DO; /* no DEFAULT specified */
      359    19839
      360    19840    7                           IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED
      361    19841    7                           THEN
      362    19842    7                             GOTO ENTRY_REQUIRED;
      363    19843
      364    19844    7                           GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ -> QI$INDICATORS.
             19844                                    STATE_VALUE = %QI#STATE_NULL;
      365    19845    7                           GZ_FIELD$ -> QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE = %YES;
      366    19846    7                           GOTO NEXT_FIELD_PLEASE;
      367    19847
      368    19848    7                         END;
      369    19849
      370    19850    6                     END NOTHING_ENTERED;
      371    19851    5                   ELSE
      372    19852    5   SOMETHING_ENTERED:
      373    19853    6                     DO;
      374    19854
      375    19855    6                       WE_GOTTA_DEFAULT_VALUE = %NO;
      376    19856
      377    19857    6                     END SOMETHING_ENTERED;
      378    19858
      379    19859        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:15   
      380    19860                  /*  We've got some data through either a toiminal
      381    19861                      or a DEFAULT VALUE.  Do something with it.  */
      382    19862                        %IF QI#DEBUG;
      383    19863
      384    19864    5                   IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH >
      385    19865    5                     GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH
      386    19866    5                   THEN
      387    19867    5                     CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
      388    19868
      389    19869                        %ENDIF;
      390    19870
      391    19871                 /*  Move the input stuff from the read buffer
      392    19872                     into a temp area in OTTER.  */
      393    19873    5                   VARIABLE_SOURCE$ = PINCRC ( GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$,
      394    19874    5                     GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET );
      395    19875    5                   QI_1.OP.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;
      396    19876
      397    19877    5                   VARIABLE_TARGET$ = QI_1.OTTER_SPACE.T$;
      398    19878    5                   QI_1.OP.LEN.T = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH;
      399    19879
      400    19880    5                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =
      401    19881    5                     VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
      402    19882
      403    19883        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:16   
      404    19884                 /*  Check for FILL CHARACTER, MINIMUM SIZE, and/or
      405    19885                     CLASS clauses.  These are independent of how many
      406    19886                     extra times we've been through here by calling
      407    19887                     QCG$GET_FIELD.  */
      408    19888    5                   IF LAST_DAD$ ~= FIELD_DAD$
      409    19889    5                   THEN
      410    19890    6                     DO;
      411    19891
      412    19892    6                       LAST_DAD$ = FIELD_DAD$;
      413    19893
      414    19894                      /* FILL CHARACTER and MINIMUM SIZE stuff.  */
      415    19895    6                       IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.FILL_CHARACTER_MINIMUM_SIZE
      416    19896    6                       THEN
      417    19897    7                         DO;
      418    19898    7                           FILL_CHARACTER = FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (%
             19898                                    QI#P_FILL_SIZE_INDEX);
      419    19899    7                           IF FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER = %QI#BLANK
      420    19900    7                           THEN
      421    19901    7                             WE_GOTTA_FILL_CHARACTER = %NO;
      422    19902    7                           ELSE
      423    19903    7                             WE_GOTTA_FILL_CHARACTER = %YES;
      424    19904    7                           MINIMUM_SIZE = FILL_CHARACTER_MINIMUM_SIZE.MINIMUM_SIZE;
      425    19905    7                         END;
      426    19906    6                       ELSE
      427    19907    7                         DO;
      428    19908    7                           WE_GOTTA_FILL_CHARACTER = %NO;
      429    19909    7                           MINIMUM_SIZE = 0;
      430    19910    7                         END;
      431    19911
      432    19912    6                       IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.CLASS_TYPE > 0
      433    19913    6                       THEN
      434    19914    6                         CLASS_TYPE = FIELD_DAD_P$ -> QI$FIELD_DAD_P.CLASS_TYPE;
      435    19915    6                       ELSE
      436    19916    7                         DO;
      437    19917    7                           IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.CLASS_ALPHABET
      438    19918    7                           THEN
      439    19919    8                             DO;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:17   
      440    19920                                    %PRESENCE_DISPLACEMENT (
      441    19921                                    PRESENCE_THING$ = FIELD_DAD_P$,
      442    19922                                    INDEX = P_ITEM_INDEX,
      443    19923                                    START = %QI#P_FIELD_FIRST_INDEX,
      444    19924                                    STOP = %QI#P_CLASS_INDEX,
      445    19925                                    RESULT = CLASS_INDEX
      446    19926                                    );
      447    19958                                    %PROC_ADDRESS (
      448    19959                                    THING@P =
             19959                                   "FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A ( CLASS_INDEX )"
             19959                                        ,
      449    19960                                    CHECK_FOR_INDIRECTION = NO,
      450    19961                                    RESULT$ = CLASS_ALPHABET$
      451    19962                                    );
      452    19999
      453    20000    8                               CLASS_TYPE = %QI#CLASS_ALPHABET;
      454    20001    8                             END;
      455    20002    7                           ELSE
      456    20003    7                             CLASS_TYPE = %QI#ABSOLUTELY_NO_CLASS;
      457    20004    7                         END;
      458    20005
      459    20006                      /* other stuff */
      460    20007
      461    20008    6                     END;
      462    20009
      463    20010        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:18   
      464    20011    6                   DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );
      465    20012
      466    20013    6                     CASE ( %QI#TYPE_DISPLAY );
      467    20014    6                       QI@SRCH_VRFY = QI_SRCH_VRFY;
      468    20015    6                       QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_BLANK );
      469    20016    6                       QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.SRCH_RESULT );
      470    20017    6                       QI@SRCH_VRFY.DATA.AUX$ = QI_1.OTTER_SPACE.T$;
      471    20018    6                       QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = GZ_FIELD$ -> QI$GZ_FIELD
             20018                                .STATUS.LENGTH;
      472    20019
      473    20020    6                       NONBLANK_INDEX = 0;
      474    20021    6                       NONBLANK_LENGTH = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;
      475    20022
      476    20023    6                       CALL QCC$SRCH ( QI@SRCH_VRFY )
      477    20024    6                         ALTRET ( BOSS_KEEN_NEAT_DISPLAY );
      478    20025
      479    20026                      /*
      480    20027                         <string> ::= [<whatevah>] <blank> [<whatevah>]
      481    20028                      */
      482    20029    6                       QI@SRCH_VRFY.INX.AUX = QI@SRCH_VRFY.SRCH_RESULT.DISP;
      483    20030    6                       QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = QI@SRCH_VRFY.
             20030                                SRCH_VRFY_ELEMS.LIST_LEN
      484    20031    6                         - QI@SRCH_VRFY.SRCH_RESULT.DISP;
      485    20032
      486    20033    6                       IF QI@SRCH_VRFY.INX.AUX = 0
      487    20034    6                       THEN
      488    20035    6   LEADING_BLANKS_IN_DISPLAY:
      489    20036    7                         DO;
      490    20037                          /*
      491    20038                             <string> ::= <blank> [<whatevah>]
      492    20039                          */
      493    20040
      494    20041    7                           CALL QCC$VRFY ( QI@SRCH_VRFY )
      495    20042    7                           WHENALTRETURN
      496    20043    8                             DO;
      497    20044
      498    20045    8                               QI@SRCH_VRFY.INX.AUX = QI@SRCH_VRFY.VRFY_RESULT.DISP;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:19   
      499    20046    8                               QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = QI@SRCH_VRFY.
             20046                                        SRCH_VRFY_ELEMS.LIST_LEN
      500    20047    8                                 - QI@SRCH_VRFY.VRFY_RESULT.DISP;
      501    20048
      502    20049    8                               NONBLANK_INDEX = QI@SRCH_VRFY.INX.AUX;
      503    20050    8                               NONBLANK_LENGTH = QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN;
      504    20051
      505    20052    8                               CALL QCC$SRCH ( QI@SRCH_VRFY )
      506    20053    8                                 ALTRET ( BOSS_KEEN_NEAT_DISPLAY );
      507    20054
      508    20055    8                               QI@SRCH_VRFY.INX.AUX = QI@SRCH_VRFY.INX.AUX
      509    20056    8                                 + QI@SRCH_VRFY.SRCH_RESULT.DISP;
      510    20057    8                               QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = QI@SRCH_VRFY.
             20057                                        SRCH_VRFY_ELEMS.LIST_LEN
      511    20058    8                                 - QI@SRCH_VRFY.SRCH_RESULT.DISP;
      512    20059
      513    20060    8                               EXIT LEADING_BLANKS_IN_DISPLAY;
      514    20061
      515    20062    8                             END;
      516    20063    7                           GOTO NOTHING_ENTERED;
      517    20064
      518    20065    7                         END LEADING_BLANKS_IN_DISPLAY;
      519    20066    6                       ELSE
      520    20067    7                         DO;
      521    20068                          /*
      522    20069                             <string> ::= <non-blank(s)> <blank> [<whatevah>]
      523    20070                          */
      524    20071    7                         END;
      525    20072
      526    20073                      /*
      527    20074                         <string> ::= <blank(s)> <non-blank(s)> <blank> [<whatevah>]
      528    20075                                      | <non-blank(s)> <blank> [<whatevah>]
      529    20076                         so...
      530    20077                         the [<whatevah>] should either:
      531    20078                           1) not exist;
      532    20079                           2) ::= <blank(s)>.
      533    20080                      */
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:20   
      534    20081
      535    20082    6                       CALL QCC$VRFY ( QI@SRCH_VRFY )
      536    20083    6                         ALTRET ( EMBEDDED_BLANKS_IN_DISPLAY );
      537    20084
      538    20085    6                       NONBLANK_LENGTH = NONBLANK_LENGTH
      539    20086    6                         - ( GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH - QI@SRCH_VRFY.INX.
             20086                                  AUX );
      540    20087
      541    20088    6   BOSS_KEEN_NEAT_DISPLAY: /* yeah yeah */;
      542    20089                            /*  MINIMUM SIZE check.  */
      543    20090    6                       IF NONBLANK_LENGTH < MINIMUM_SIZE
      544    20091    6                       THEN
      545    20092    6                         GOTO MINIMUM_SIZE_ERROR;
      546    20093
      547    20094    6                       DIGIT_INDEX = NONBLANK_INDEX;
      548    20095    6                       DIGIT_LENGTH = NONBLANK_LENGTH;
      549    20096
      550    20097    6   SIGN_STRIPPING_STUFF:
      551    20098    7                       DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.SIGN
             20098                                );
      552    20099
      553    20100    7                         CASE ( %QI#CD_SIGN_LEADING_SEPARATE );
      554    20101    7                           IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX ) = %
             20101                                    QI#PLUS
      555    20102    7                             OR QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX ) = %
             20102                                      QI#MINUS
      556    20103    7                           THEN
      557    20104    8                             DO;
      558    20105    8                               DIGIT_INDEX = DIGIT_INDEX + 1;
      559    20106    8                               DIGIT_LENGTH = DIGIT_LENGTH - 1;
      560    20107
      561    20108    8                               IF DIGIT_LENGTH = 0
      562    20109    8                               THEN
      563    20110    8                                 GOTO SIGN_ONLY_IN_DISPLAY;
      564    20111
      565    20112    8                               DATA_SIGN = %QI#CD_SIGN_LEADING_SEPARATE;
      566    20113    8                             END;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:21   
      567    20114    7                           ELSE
      568    20115    7                             DATA_SIGN = %QI#CD_UNSIGNED;
      569    20116
      570    20117    7                         CASE ( %QI#CD_SIGN_TRAILING_SEPARATE );
      571    20118    7                           IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX +
             20118                                    DIGIT_LENGTH - 1 ) = %QI#PLUS
      572    20119    7                             OR QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX +
             20119                                      DIGIT_LENGTH - 1 ) = %QI#MINUS
      573    20120    7                           THEN
      574    20121    8                             DO;
      575    20122    8                               DIGIT_LENGTH = DIGIT_LENGTH - 1;
      576    20123
      577    20124    8                               IF DIGIT_LENGTH = 0
      578    20125    8                               THEN
      579    20126    8                                 GOTO SIGN_ONLY_IN_DISPLAY;
      580    20127
      581    20128    8                               DATA_SIGN = %QI#CD_SIGN_TRAILING_SEPARATE;
      582    20129    8                             END;
      583    20130    7                           ELSE
      584    20131    7                             DATA_SIGN = %QI#CD_UNSIGNED;
      585    20132
      586    20133    7                         CASE ( %QI#CD_SIGN_TRAILING_OVER );
      587    20134    7                           QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_OVERPUNCHED_SIGNS );
      588    20135    7                           QI@SRCH_VRFY.SRCH_VRFY_ARGS.LIST_LEN = LENGTHC (
             20135                                    QI_OVERPUNCHED_SIGNS );
      589    20136    7                           QI@SRCH_VRFY.INX.AUX = DIGIT_INDEX
      590    20137    7                             + DIGIT_LENGTH
      591    20138    7                             - 1;
      592    20139    7                           QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = 1;
      593    20140
      594    20141    7                           CALL QCC$SRCH ( QI@SRCH_VRFY )
      595    20142    7                           WHENRETURN
      596    20143    8                             DO;
      597    20144                                  /*  There's an overpunched sign.  */
      598    20145    8                               DATA_SIGN = %QI#CD_SIGN_TRAILING_OVER;
      599    20146    8                               DIGIT_LENGTH = DIGIT_LENGTH - 1;
      600    20147    8                             END;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:22   
      601    20148    7                           WHENALTRETURN
      602    20149    8                             DO;
      603    20150                                  /*  There's no overpunched sign.  */
      604    20151    8                               DATA_SIGN = %QI#CD_UNSIGNED;
      605    20152    8                             END;
      606    20153
      607    20154    7                         CASE ( %QI#CD_UNSIGNED );
      608    20155    7                           DATA_SIGN = %QI#CD_UNSIGNED;
      609    20156
      610    20157    7                       END SIGN_STRIPPING_STUFF;
      611    20158
      612    20159                            /*  Composition checking:
      613    20160                                look for digits of the numerical variety.  */
      614    20161    6                       QI@MAT = QI_MAT;
      615    20162    6                       QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;
      616    20163    6                       QI@MAT.INX.S = DIGIT_INDEX;
      617    20164    6                       QI@MAT.LEN.S = DIGIT_LENGTH;
      618    20165    6                       QI@MAT.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;
      619    20166    6                       QI@MAT.INX.T = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET;
      620    20167    6                       QI@MAT.LEN.T = QI@MAT.LEN.S;
      621    20168    6                       QI@MAT.DATA.AUX$ = ADDR ( QI_CLASS_NUMERIC );
      622    20169
      623    20170    6                       CALL QCC$MAT ( QI@MAT );
      624    20171
      625    20172    6                       QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );
      626    20173    6                       QI@MAT.INX.S = 0;
      627    20174    6                       QI@MAT.LEN.S = 1;
      628    20175
      629    20176    6                       CALL QCC$ACM ( QI@MAT );
      630    20177
      631    20178    6                       IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL
      632    20179    6                       THEN
      633    20180    6                         GOTO NON_NUMERICAL_DISPLAY;
      634    20181
      635    20182    7                       DO CASE ( CLASS_TYPE );
      636    20183
      637    20184    7                         CASE ( %QI#ABSOLUTELY_NO_CLASS, %QI#CLASS_NUMERIC );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:23   
      638    20185                                /* ya bum */
      639    20186
      640    20187    7                         CASE ( %QI#CLASS_ALPHABET );
      641    20188    7                           QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;
      642    20189    7                           QI@MAT.INX.S = DIGIT_INDEX;
      643    20190    7                           QI@MAT.LEN.S = DIGIT_LENGTH;
      644    20191    7                           QI@MAT.DATA.AUX$ = CLASS_ALPHABET$;
      645    20192
      646    20193    7                           CALL QCC$MAT ( QI@MAT );
      647    20194
      648    20195    7                           QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );
      649    20196    7                           QI@MAT.INX.S = 0;
      650    20197    7                           QI@MAT.LEN.S = 1;
      651    20198
      652    20199    7                           CALL QCC$ACM ( QI@MAT );
      653    20200
      654    20201    7                           IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL
      655    20202    7                           THEN
      656    20203    7                             GOTO CLASS_VIOLATION_IN_DISPLAY;
      657    20204
      658    20205    7                         CASE ( ELSE );
      659    20206    7                           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      660    20207
      661    20208    7                       END;
      662    20209
      663    20210                            /*  The following is a specialized
      664    20211                                REPLACE_FIELD_DATA for NUMERIC items only.  */
      665    20212    6                       QI_1.OP.CIP.S_A (0) = %QI#CIP_DEFAULT_AS;
      666    20213    6                       QI_1.OP.CIP.S.CD.OFFSET = MOD ( NONBLANK_INDEX, 2 );
      667    20214    6                       QI_1.OP.CIP.S.CD.SIGN = DATA_SIGN;
      668    20215    6                       QI_1.OP.CIP.S.LEN = NONBLANK_LENGTH;
      669    20216    6                       QI_1.OP.DEC.S = 0;
      670    20217    6                       QI_1.OP.DATA.S$ = PINCRW ( QI_1.OTTER_SPACE.T$, NONBLANK_INDEX /
             20217                                2 );
      671    20218    6                       QI_1.OP.CIP.T_A (0) = %QI#CIP_DEFAULT_AS;
      672    20219    6                       QI_1.OP.CIP.T.CD.OFFSET = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET
             20219                                ;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:24   
      673    20220    6                       QI_1.OP.CIP.T.CD.SIGN = FIELD_DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.
             20220                                NUMERIC.CD.SIGN;
      674    20221    6                       QI_1.OP.CIP.T.LEN = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH;
      675    20222    6                       QI_1.OP.DEC.T = 0;
      676    20223    6                       QI_1.OP.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;
      677    20224    6                       QI_1.OP.SIZE_ERROR = %QI#CHECK_FOR_SIZE_ERROR;
      678    20225
      679    20226    6                       CALL QCC$DMC ( QI_1.OP )
      680    20227    6                       WHENALTRETURN
      681    20228    7                         DO;
      682    20229    7                           GOTO OVERFLOW;
      683    20230    7                         END;
      684    20231
      685    20232    6                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = GZ_FIELD$ ->
             20232                                QI$GZ_FIELD.DESCRIPTION.LENGTH;
      686    20233
      687    20234        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:25   
      688    20235    6                     CASE ( %QI#TYPE_ALPHANUMERIC );
      689    20236    6                       IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED
      690    20237    6                       THEN
      691    20238    7                         DO;
      692    20239    7                           VARIABLE_SOURCE$ = QI_1.OTTER_SPACE.T$;
      693    20240    7                           QI_1.OP.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;
      694    20241
      695    20242    7                           IF VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT = ' '
      696    20243    7                           THEN
      697    20244    7                             GOTO ENTRY_REQUIRED;
      698    20245    7                         END;
      699    20246
      700    20247                            /*  SOURCE_INDEX and TARGET_INDEX will eventually
      701    20248                                be used by REPLACE_FIELD_DATA.  */
      702    20249    6                       SOURCE_INDEX = 0;
      703    20250    6                       TARGET_INDEX = 0;
      704    20251
      705    20252    6                       IF FIELD_DAD$ -> QI$FIELD_DAD.PICTURE_STRING@P > 0
      706    20253    6                       THEN
      707    20254    6   PICTURE_STRING_STUFF:
      708    20255    7                         DO;
      709    20256
      710    20257                                %PROC_ADDRESS (
      711    20258                                THING@P = "FIELD_DAD$ -> QI$FIELD_DAD.PICTURE_STRING@P",
      712    20259                                CHECK_FOR_INDIRECTION = NO,
      713    20260                                RESULT$ = PIC$
      714    20261                                );
      715    20298    8                           DO CASE ( PIC$ -> QI$PICTURE_STRING.TYPE );
      716    20299
      717    20300    8                             CASE ( %QI#NUMERIC_PICTURE_STRING );
      718    20301                                  /*  Only fill in the fields that
      719    20302                                      QCD$DE_EDIT will need.  */
      720    20303    8                               QI_1.OP.LEN_A (%QI#DE_EDIT) = GZ_FIELD$ -> QI$GZ_FIELD.
             20303                                        STATUS.LENGTH;
      721    20304    8                               QI_1.OFFSET_A (%QI#DE_EDIT) = 0;
      722    20305    8                               QI_1.OP.DATA_A$ (%QI#DE_EDIT) = QI_1.OTTER_SPACE.T$;
      723    20306    8                               QI_1.PICTURE_STRING_A$ (%QI#DE_EDIT) = PIC$;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:26   
      724    20307
      725    20308    8                               CALL QCD$DE_EDIT ( QCD@DE_EDIT );
      726    20309
      727    20310    8                               IF QCD@DE_EDIT.IS_NUMBER_INVALID
      728    20311    8                               THEN
      729    20312    8                                 GOTO ILLEGAL_INPUT_IN_DE;
      730    20313
      731    20314    8                               IF QCD@DE_EDIT.RESULT.INPUT_SIZE < MINIMUM_SIZE
      732    20315    8                               THEN
      733    20316    8                                 GOTO MINIMUM_SIZE_ERROR;
      734    20317
      735    20318    8                               CALL REPLACE_FIELD_DATA;
      736    20319
      737    20320    8                             CASE ( %QI#ALPHANUMERIC_PICTURE_STRING );
      738    20321    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH < MINIMUM_SIZE
      739    20322    8                               THEN
      740    20323    8                                 GOTO MINIMUM_SIZE_ERROR;
      741    20324
      742    20325    8                               QI@SRCH_VRFY = QI_SRCH_VRFY;
      743    20326    8                               QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.VRFY_RESULT )
             20326                                        ;
      744    20327    8                               QI@SRCH_VRFY.DATA.AUX$ = QI_1.OTTER_SPACE.T$;
      745    20328
      746    20329    9                               DO CASE ( CLASS_TYPE );
      747    20330
      748    20331    9                                 CASE ( %QI#ABSOLUTELY_NO_CLASS );
      749    20332
      750    20333    9                                 CASE ( %QI#CLASS_NUMERIC );
      751    20334    9                                   CLASS_THING$ = ADDR ( QI_CLASS_NUMERIC );
      752    20335    9                                   GOTO SETUP_AE_CLASS_CHECK;
      753    20336
      754    20337    9                                 CASE ( %QI#CLASS_ALPHA );
      755    20338    9                                   CLASS_THING$ = ADDR ( QI_CLASS_ALPHA );
      756    20339    9                                   GOTO SETUP_AE_CLASS_CHECK;
      757    20340
      758    20341    9                                 CASE ( %QI#CLASS_ALPHABET );
      759    20342    9                                   CLASS_THING$ = CLASS_ALPHABET$;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:27   
      760    20343    9   SETUP_AE_CLASS_CHECK:
      761    20344    9                                   QI@MAT = QI_MAT;
      762    20345    9                                   QI@MAT.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.
             20345                                            DATA$;
      763    20346    9                                   QI@MAT.INX.T = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.
             20346                                            OFFSET;
      764    20347    9                                   QI@MAT.DATA.AUX$ = CLASS_THING$;
      765    20348
      766    20349    9                               END; /* do case class_type */
      767    20350
      768    20351    8                               DATA_INDEX = 0;
      769    20352
      770    20353    9                               DO MOP_STRING_INDEX = 0 TO PIC$ ->
             20353                                        QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_COUNT - 1
             20353                                        ;
      771    20354
      772    20355    9                                 THIS_MOP_FUNCTIONS_LENGTH = PIC$ ->
             20355                                          QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_A.
             20355                                          LENGTH (MOP_STRING_INDEX);
      773    20356
      774    20357   10                                 DO CASE ( PIC$ -> QI$ALPHANUMERIC_PICTURE_STRING.
             20357                                          EDIT_STRING_A.FUNCTION (MOP_STRING_INDEX) );
      775    20358
      776    20359   10                                   CASE ( %QI#PIC_M_9_A_X );
      777    20360
      778    20361   10                                     IF CLASS_TYPE ~= %QI#ABSOLUTELY_NO_CLASS
      779    20362   10                                     THEN
      780    20363   11                                       DO;
      781    20364   11                                         QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;
      782    20365   11                                         QI@MAT.INX.S = DATA_INDEX;
      783    20366   11                                         QI@MAT.LEN.S = THIS_MOP_FUNCTIONS_LENGTH;
      784    20367   11                                         QI@MAT.LEN.T = QI@MAT.LEN.S;
      785    20368
      786    20369   11                                         CALL QCC$MAT ( QI@MAT );
      787    20370
      788    20371   11                                         QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );
      789    20372   11                                         QI@MAT.INX.S = 0;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:28   
      790    20373   11                                         QI@MAT.LEN.S = 1;
      791    20374
      792    20375   11                                         CALL QCC$ACM ( QI@MAT );
      793    20376
      794    20377   11                                         IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL
      795    20378   11                                         THEN
      796    20379   11                                           GOTO CLASS_VIOLATION_IN_AE;
      797    20380   11                                       END;
      798    20381
      799    20382   10                                   CASE ( %QI#PIC_M_B );
      800    20383   10                                     QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_BLANK );
      801    20384   10                                     GOTO VRFY_IT;
      802    20385
      803    20386   10                                   CASE ( %QI#PIC_M_0 );
      804    20387   10                                     QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_ZERO );
      805    20388   10                                     GOTO VRFY_IT;
      806    20389
      807    20390   10                                   CASE ( %QI#PIC_M_SLASH );
      808    20391   10                                     QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_SLASH );
      809    20392   10   VRFY_IT:
      810    20393   10                                     QI@SRCH_VRFY.INX.AUX = DATA_INDEX;
      811    20394   10                                     QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN =
             20394                                              THIS_MOP_FUNCTIONS_LENGTH;
      812    20395
      813    20396   10                                     CALL QCC$VRFY ( QI@SRCH_VRFY )
      814    20397   10                                       ALTRET ( ILLEGAL_CHARACTER_IN_AE );
      815    20398
      816    20399   10                                 END; /* DO CASE ( PIC$ -> ... ) */
      817    20400
      818    20401    9                                 DATA_INDEX = DATA_INDEX + THIS_MOP_FUNCTIONS_LENGTH;
      819    20402
      820    20403    9                               END; /* DO MOP_STRING_INDEX ... */
      821    20404
      822    20405    8                             CASE ( ELSE );
      823    20406
      824    20407    8                           END; /* do case picture_string_type */
      825    20408
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:29   
      826    20409    7                           CALL REPLACE_FIELD_DATA;
      827    20410
      828    20411    7                         END PICTURE_STRING_STUFF;
      829    20412    6                       ELSE
      830    20413    6   NO_PICTURE_STRING_STUFF:
      831    20414                        /* We got just a regular old ALPHANUMERIC
      832    20415                           deal, with no PICture string.  */
      833    20416    7                         DO;
      834    20417    7                           IF WE_GOTTA_FILL_CHARACTER
      835    20418    7                           THEN
      836    20419    7   FILL_CHARACTER_STUFF:
      837    20420    8                             DO;
      838    20421
      839    20422                              /* Do real different stuff according to
      840    20423                                 rightwing-leftwing justification.  */
      841    20424    8                               IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.
             20424                                        IS_JUSTIFIED_RIGHT
      842    20425    8                               THEN
      843    20426    8   ITS_A_RIGHTWINGER:
      844    20427    9                                 DO;
      845    20428    9                                   QI@SRCH_VRFY = QI_SRCH_VRFY;
      846    20429    9                                   QI@SRCH_VRFY.DATA.S$ = ADDR (
             20429                                            FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER );
      847    20430    9                                   QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.
             20430                                            SRCH_RESULT );
      848    20431    9                                   QI@SRCH_VRFY.DATA.AUX$ = QI_1.OTTER_SPACE.T$;
      849    20432    9                                   QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = GZ_FIELD$ ->
             20432                                            QI$GZ_FIELD.STATUS.LENGTH;
      850    20433
      851    20434    9                                   CALL QCC$SRCH ( QI@SRCH_VRFY )
      852    20435    9                                     ALTRET ( BOSS_KEEN_NEAT_ALPHANUMERIC );
      853    20436
      854    20437    9                                   IF QI@SRCH_VRFY.SRCH_RESULT.DISP = 0
      855    20438    9                                   THEN
      856    20439    9   STRIP_LEADING_FILL_CHARACTER:
      857    20440   10                                     DO;
      858    20441                                            /*  FILL CHARACTER in first column:
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:30   
      859    20442                                                ask how many to strip off.  */
      860    20443
      861    20444   10                                       CALL QCC$VRFY ( QI@SRCH_VRFY )
      862    20445   10                                       WHENALTRETURN
      863    20446   11                                         DO;
      864    20447   11                                           SOURCE_INDEX = QI@SRCH_VRFY.VRFY_RESULT.DISP
             20447                                                    ;
      865    20448   11                                           GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH =
      866    20449   11                                             GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH -
             20449                                                      SOURCE_INDEX;
      867    20450
      868    20451   11                                           EXIT STRIP_LEADING_FILL_CHARACTER;
      869    20452   11                                         END;
      870    20453
      871    20454   10                                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0;
      872    20455
      873    20456   10                                     END STRIP_LEADING_FILL_CHARACTER;
      874    20457
      875    20458    9                                 END ITS_A_RIGHTWINGER;
      876    20459    8                               ELSE
      877    20460    8   ITS_A_LEFTWINGER:
      878    20461    9                                 DO;
      879    20462
      880    20463    9   STRIP_TRAILING_FILL_CHARACTER:
      881    20464                                        /*  FILL CHARACTER in last column:
      882    20465                                            peel off right-to-left.  */
      883    20466   10                                   DO CURRENT_INDEX = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.
             20466                                            LENGTH - 1 DOWNTO 0;
      884    20467
      885    20468   10                                     IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A (
             20468                                              CURRENT_INDEX ) =
      886    20469   10                                       FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER
      887    20470   10                                     THEN
      888    20471   10                                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH =
             20471                                                GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH - 1;
      889    20472   10                                     ELSE
      890    20473   10                                       EXIT STRIP_TRAILING_FILL_CHARACTER;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:31   
      891    20474
      892    20475   10                                   END STRIP_TRAILING_FILL_CHARACTER;
      893    20476
      894    20477    9                                 END ITS_A_LEFTWINGER;
      895    20478
      896    20479    8                             END FILL_CHARACTER_STUFF;
      897    20480
      898    20481    7   BOSS_KEEN_NEAT_ALPHANUMERIC:
      899    20482    7                           IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH < MINIMUM_SIZE
      900    20483    7                           THEN
      901    20484    7                             GOTO MINIMUM_SIZE_ERROR;
      902    20485
      903    20486    7   ALPHANUMERIC_CLASS_STUFF:
      904    20487    8                           DO CASE ( CLASS_TYPE );
      905    20488
      906    20489    8                             CASE ( %QI#ABSOLUTELY_NO_CLASS );
      907    20490                                  /* ya bum */
      908    20491
      909    20492    8                             CASE ( %QI#CLASS_NUMERIC );
      910    20493    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0
      911    20494    8                               THEN
      912    20495    8                                 GOTO FULLA_FILL;
      913    20496
      914    20497    8                               CLASS_THING$ = ADDR ( QI_CLASS_NUMERIC );
      915    20498    8                               GOTO ALPHANUMERIC_CLASS_CHECK;
      916    20499
      917    20500    8                             CASE ( %QI#CLASS_ALPHA );
      918    20501    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0
      919    20502    8                               THEN
      920    20503    8                                 EXIT ALPHANUMERIC_CLASS_STUFF;
      921    20504
      922    20505    8                               CLASS_THING$ = ADDR ( QI_CLASS_ALPHA );
      923    20506    8                               GOTO ALPHANUMERIC_CLASS_CHECK;
      924    20507
      925    20508    8                             CASE ( %QI#CLASS_ALPHABET );
      926    20509    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0
      927    20510    8                               THEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:32   
      928    20511    8                                 IF CLASS_ALPHABET$ -> QI$UBYTE_A (%QI#BLANK) > 0
      929    20512    8                                 THEN
      930    20513    8                                   EXIT ALPHANUMERIC_CLASS_STUFF;
      931    20514    8                                 ELSE
      932    20515    8                                   GOTO FULLA_FILL;
      933    20516
      934    20517    8                               CLASS_THING$ = CLASS_ALPHABET$;
      935    20518    8   ALPHANUMERIC_CLASS_CHECK:
      936    20519    8                               QI@MAT = QI_MAT;
      937    20520    8                               QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;
      938    20521    8                               QI@MAT.INX.S = SOURCE_INDEX;
      939    20522    8                               QI@MAT.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;
      940    20523    8                               QI@MAT.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;
      941    20524    8                               QI@MAT.INX.T = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET;
      942    20525    8                               QI@MAT.LEN.T = QI@MAT.LEN.S;
      943    20526    8                               QI@MAT.DATA.AUX$ = CLASS_THING$;
      944    20527
      945    20528    8                               CALL QCC$MAT ( QI@MAT );
      946    20529
      947    20530    8                               QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );
      948    20531    8                               QI@MAT.INX.S = 0;
      949    20532    8                               QI@MAT.LEN.S = 1;
      950    20533
      951    20534    8                               CALL QCC$ACM ( QI@MAT );
      952    20535
      953    20536    8                               IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL
      954    20537    8                               THEN
      955    20538    8                                 GOTO CLASS_VIOLATION_IN_ALPHA;
      956    20539
      957    20540    8                             CASE ( ELSE );
      958    20541    8                               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
      959    20542
      960    20543    8                           END ALPHANUMERIC_CLASS_STUFF;
      961    20544
      962    20545    7                           IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_JUSTIFIED_RIGHT
      963    20546    7                           THEN
      964    20547    7   JUSTIFY_RIGHT_IT:
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:33   
      965    20548                                  /*  JUSTIFY RIGHT it by peeling off
      966    20549                                      blanks, right-to-left.  */
      967    20550    8                             DO;
      968    20551
      969    20552    8   STRIP_TRAILING_BLANKS:
      970    20553    9                               DO CURRENT_INDEX = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.
             20553                                        LENGTH - 1 DOWNTO 0;
      971    20554
      972    20555    9                                 IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( CURRENT_INDEX )
             20555                                          =
      973    20556    9                                   %QI#BLANK
      974    20557    9                                 THEN
      975    20558    9                                   TARGET_INDEX = TARGET_INDEX + 1;
      976    20559    9                                 ELSE
      977    20560    9                                   EXIT STRIP_TRAILING_BLANKS;
      978    20561
      979    20562    9                               END STRIP_TRAILING_BLANKS;
      980    20563
      981    20564    8                               TARGET_INDEX = TARGET_INDEX
      982    20565    8                                 + SOURCE_INDEX;
      983    20566
      984    20567    8                               IF TARGET_INDEX > 0
      985    20568    8                               THEN
      986    20569    8   BLANK_FILL_ON_THE_LEFT:
      987    20570    9                                 DO;
      988    20571
      989    20572    9                                   VARIABLE_TARGET$ = PINCRC ( GZ_FIELD$ -> QI$GZ_FIELD
             20572                                            .STATUS.DATA$,
      990    20573    9                                     GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET );
      991    20574    9                                   QI_1.OP.LEN.T = TARGET_INDEX;
      992    20575
      993    20576    9                                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT
      994    20577    9                                     = ' ';
      995    20578
      996    20579    9                                 END BLANK_FILL_ON_THE_LEFT;
      997    20580
      998    20581    8                             END JUSTIFY_RIGHT_IT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:34   
      999    20582
     1000    20583    7                           CALL REPLACE_FIELD_DATA;
     1001    20584
     1002    20585    7                         END NO_PICTURE_STRING_STUFF;
     1003    20586
     1004    20587        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:35   
     1005    20588    6                     CASE ( ELSE );
     1006    20589    6                       CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );
     1007    20590
     1008    20591    6                   END; /* do case dad_type */
     1009    20592
     1010    20593    5                   GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ -> QI$INDICATORS.STATE_VALUE =
             20593                            %QI#STATE_AVAIL_VERIFY;
     1011    20594    5                   GZ_FIELD$ -> QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE = %YES;
     1012    20595
     1013    20596    5                 END THAT_SUCKER_IS_DONE;
     1014    20597
     1015    20598    4   NEXT_FIELD_PLEASE:
     1016    20599    4               GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );
     1017    20600
     1018    20601    4             END POST_EDIT_THEM_FIELDS;
     1019    20602
     1020    20603    3           END FRAME_IS_ACTIVE;
     1021    20604
     1022    20605    2       END CHECK_THEM_FRAMES;
     1023    20606
     1024    20607    1       RETURN;
     1025    20608
     1026    20609        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:36   
     1027    20610    1   ENTRY_REQUIRED:
     1028    20611    1       ERROR_CODE = %E$ENTRY_REQUIRED;
     1029    20612    1       U1$ = ADDR (NIL);
     1030    20613    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_ENTRY_REQUIRED );
     1031    20614    1       GOTO GET_FIELD_AGAIN_NO_DEFAULT;
     1032    20615
     1033    20616    1   ILLEGAL_INPUT_IN_DE:
     1034    20617    1       ERROR_CODE = %E$ILLEGAL_INPUT;
     1035    20618    1       U1$ = ADDR (NIL);
     1036    20619    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_ILLEGAL_INPUT );
     1037    20620    1       GOTO GET_THAT_FIELD_AGAIN;
     1038    20621
     1039    20622    1   EMBEDDED_BLANKS_IN_DISPLAY:
     1040    20623    1       ERROR_CODE = %E$EMBEDDED_BLANKS;
     1041    20624    1       U1$ = ADDR (NIL);
     1042    20625    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_EMBEDDED_BLANKS );
     1043    20626    1       GOTO GET_THAT_FIELD_AGAIN;
     1044    20627
     1045    20628    1   SIGN_ONLY_IN_DISPLAY:
     1046    20629    1       ERROR_CODE = %E$SIGN_ONLY;
     1047    20630    1       U1$ = ADDR (NIL);
     1048    20631    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_SIGN_ONLY );
     1049    20632    1       GOTO GET_THAT_FIELD_AGAIN;
     1050    20633
     1051    20634    1   MINIMUM_SIZE_ERROR:
     1052    20635    1       OTTER_ERROR_MESSAGE = OOPS_MINIMUM_SIZE;
     1053    20636
     1054    20637    1       CALL BINCHAR ( MINIMUM_SIZE_TEXT, MINIMUM_SIZE );
     1055    20638
     1056    20639    1       IF MINIMUM_SIZE <= 9
     1057    20640    1       THEN
     1058    20641    1         QI_1.OP.LEN.T = 1;
     1059    20642    1       ELSE
     1060    20643    1         IF MINIMUM_SIZE <= 99
     1061    20644    1         THEN
     1062    20645    1           QI_1.OP.LEN.T = 2;
     1063    20646    1         ELSE
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:37   
     1064    20647    1           QI_1.OP.LEN.T = 3;
     1065    20648
     1066    20649    1       SUBSTR ( OTTER_ERROR_MESSAGE,
     1067    20650    1         LENGTHC ( OOPS_MINIMUM_SIZE ) ) =
     1068    20651    1         SUBSTR ( MINIMUM_SIZE_TEXT,
     1069    20652    1         3 - QI_1.OP.LEN.T );
     1070    20653
     1071    20654    1       SUBSTR ( OTTER_ERROR_MESSAGE,
     1072    20655    1         LENGTHC ( OOPS_MINIMUM_SIZE ) + QI_1.OP.LEN.T,
     1073    20656    1         1 ) = '.';
     1074    20657
     1075    20658    1       ERROR_CODE = %E$MINIMUM_SIZE;
     1076    20659    1       U1.LENGTH = QI_1.OP.LEN.T;
     1077    20660    1       U1.TEXT = SUBSTR ( MINIMUM_SIZE_TEXT,
     1078    20661    1         3 - QI_1.OP.LEN.T );
     1079    20662    1       U1$ = ADDR ( U1 );
     1080    20663    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );
     1081    20664    1       GOTO GET_THAT_FIELD_AGAIN;
     1082    20665
     1083    20666    1   OVERFLOW:
     1084    20667    1       OTTER_ERROR_MESSAGE = OOPS_MAXIMUM_SIZE;
     1085    20668
     1086    20669    1       MAXIMUM_SIZE = QI_1.OP.LEN.S - 1;
     1087    20670    1       CALL BINCHAR ( MAXIMUM_SIZE_TEXT, MAXIMUM_SIZE );
     1088    20671
     1089    20672    1       IF MAXIMUM_SIZE <= 9
     1090    20673    1       THEN
     1091    20674    1         QI_1.OP.LEN.T = 1;
     1092    20675    1       ELSE
     1093    20676    1         QI_1.OP.LEN.T = 2;
     1094    20677
     1095    20678    1       SUBSTR ( OTTER_ERROR_MESSAGE,
     1096    20679    1         LENGTHC ( OOPS_MAXIMUM_SIZE ) ) =
     1097    20680    1         SUBSTR ( MAXIMUM_SIZE_TEXT,
     1098    20681    1         2 - QI_1.OP.LEN.T );
     1099    20682
     1100    20683    2       DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.SIGN );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:38   
     1101    20684
     1102    20685    2         CASE ( %QI#CD_UNSIGNED );
     1103    20686    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
     1104    20687
     1105    20688    2         CASE ( %QI#CD_SIGN_LEADING_SEPARATE );
     1106    20689    2           SUBSTR ( OTTER_ERROR_MESSAGE,
     1107    20690    2             LENGTHC ( OOPS_MAXIMUM_SIZE ) + QI_1.OP.LEN.T,
     1108    20691    2             LENGTHC ( OOPS_WITH_LEADING_SIGN ) ) = OOPS_WITH_LEADING_SIGN;
     1109    20692
     1110    20693    2           ERROR_CODE = %E$MAXIMUM_SIZE_LEADING_SIGN;
     1111    20694
     1112    20695    2         CASE ( %QI#CD_SIGN_TRAILING_SEPARATE );
     1113    20696    2           SUBSTR ( OTTER_ERROR_MESSAGE,
     1114    20697    2             LENGTHC ( OOPS_MAXIMUM_SIZE ) + QI_1.OP.LEN.T,
     1115    20698    2             LENGTHC ( OOPS_WITH_TRAILING_SIGN ) ) = OOPS_WITH_TRAILING_SIGN;
     1116    20699
     1117    20700    2           ERROR_CODE = %E$MAXIMUM_SIZE_TRAILING_SIGN;
     1118    20701
     1119    20702    2       END;
     1120    20703
     1121    20704    1       U1.LENGTH = QI_1.OP.LEN.T;
     1122    20705    1       U1.TEXT = SUBSTR ( MAXIMUM_SIZE_TEXT,
     1123    20706    1         2 - QI_1.OP.LEN.T );
     1124    20707    1       U1$ = ADDR ( U1 );
     1125    20708    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );
     1126    20709    1       GOTO GET_THAT_FIELD_AGAIN;
     1127    20710
     1128    20711    1   NON_NUMERICAL_DISPLAY: ;
     1129    20712    1   CLASS_VIOLATION_IN_DISPLAY:
     1130    20713    1       ERROR_CODE = %E$NON_NUMERICAL;
     1131    20714    1       OTTER_ERROR_MESSAGE = OOPS_NON_NUMERICAL;
     1132    20715
     1133    20716    1       STARTING_INDEX = LENGTHC ( OOPS_NON_NUMERICAL ) - 3;
     1134    20717
     1135    20718    1       GOTO SO_VIOLATE_IT_ALREADY;
     1136    20719
     1137    20720    1   CLASS_VIOLATION_IN_AE: ;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:39   
     1138    20721    1   CLASS_VIOLATION_IN_ALPHA:
     1139    20722    1       ERROR_CODE = %E$ILLEGAL_CHARACTER;
     1140    20723    1       OTTER_ERROR_MESSAGE = OOPS_ILLEGAL_CHARACTER;
     1141    20724
     1142    20725    1       STARTING_INDEX = LENGTHC ( OOPS_ILLEGAL_CHARACTER ) - 3;
     1143    20726
     1144    20727    1   SO_VIOLATE_IT_ALREADY:
     1145    20728    1       QI@SRCH_VRFY = QI_SRCH_VRFY;
     1146    20729    1       QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_MAT_NONMATCH );
     1147    20730    1       QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.SRCH_RESULT );
     1148    20731    1       QI@SRCH_VRFY.DATA.AUX$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;
     1149    20732    1       QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;
     1150    20733    1       QI@SRCH_VRFY.INX.AUX = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET;
     1151    20734
     1152    20735    1       CALL QCC$SRCH ( QI@SRCH_VRFY )
     1153    20736    1       WHENALTRETURN
     1154    20737    2         DO;
     1155    20738    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );
     1156    20739    2         END;
     1157    20740
     1158    20741    1       SUBSTR ( OTTER_ERROR_MESSAGE,
     1159    20742    1         STARTING_INDEX,
     1160    20743    1         1 ) = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.SRCH_RESULT.DISP );
     1161    20744
     1162    20745    1       U1.LENGTH = 1;
     1163    20746    1       U1.TEXT = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.SRCH_RESULT.DISP );
     1164    20747    1       U1$ = ADDR ( U1 );
     1165    20748    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );
     1166    20749    1       GOTO GET_THAT_FIELD_AGAIN;
     1167    20750
     1168    20751    1   ILLEGAL_CHARACTER_IN_AE:
     1169    20752    1       ERROR_CODE = %E$ILLEGAL_CHARACTER;
     1170    20753    1       OTTER_ERROR_MESSAGE = OOPS_ILLEGAL_CHARACTER;
     1171    20754
     1172    20755    1       SUBSTR ( OTTER_ERROR_MESSAGE,
     1173    20756    1         LENGTHC ( OOPS_ILLEGAL_CHARACTER ) - 3,
     1174    20757    1         1 ) = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.VRFY_RESULT.DISP );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:40   
     1175    20758
     1176    20759    1       U1.LENGTH = 1;
     1177    20760    1       U1.TEXT = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.VRFY_RESULT.DISP );
     1178    20761    1       U1$ = ADDR ( U1 );
     1179    20762    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );
     1180    20763    1       GOTO GET_THAT_FIELD_AGAIN;
     1181    20764
     1182    20765    1   FULLA_FILL:
     1183    20766    1       ERROR_CODE = %E$FULLA_FILL;
     1184    20767    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_FULLA_FILL );
     1185    20768
     1186    20769    1   GET_THAT_FIELD_AGAIN:
     1187    20770    1       IF WE_GOTTA_DEFAULT_VALUE
     1188    20771    1       THEN
     1189    20772    1   ILLEGAL_DEFAULT_VALUE:
     1190    20773    2         DO;
     1191    20774                %PROC_ADDRESS ( THING@P =
             20774              "GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ -> QI$FIELD_DAD.IDENTIFIER@P"
             20774                    ,
     1192    20775                CHECK_FOR_INDIRECTION = NO,
     1193    20776                RESULT$ = FIELD_IDENTIFIER$ );
     1194    20813
     1195    20814    2           CALL QCE$ERROR ( %E$POSTREAD_ILLEGAL_DEFAULT,
     1196    20815    2             FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER );
     1197    20816    2         END ILLEGAL_DEFAULT_VALUE;
     1198    20817
     1199    20818    1   GET_FIELD_AGAIN_NO_DEFAULT:
     1200    20819        /*N*
     1201    20820              MUCH ADO ABOUT ERROR MESSAGES
     1202    20821              When do we get the message from the host?
     1203    20822              Do we "cache" messages?  (Where?)
     1204    20823              Do we penalize non-English errors by going to the host each time?
     1205    20824
     1206    20825              For now, just to beat on the M$ERRMSG mcal a little,
     1207    20826              we go to the host every time, regardless of the language.
     1208    20827        */
     1209    20828    1       IF G$JIT$ -> G$JIT.LANG = G$JIT$ -> G$JIT.LANG
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:41   
     1210    20829    1       THEN
     1211    20830    1   GET_THE_ERRMSG_FROM_THE_HOST:
     1212    20831    2         DO;
     1213    20832    2           CALL QCE$ERROR_MESSAGE ( ERROR_CODE,
     1214    20833    2             U$1,
     1215    20834    2             /* no U2 */,
     1216    20835    2             /* no U3 */,
     1217    20836    2             OTTER_ERROR_MESSAGE );
     1218    20837
     1219    20838    2           QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );
     1220    20839    2         END GET_THE_ERRMSG_FROM_THE_HOST;
     1221    20840
     1222    20841        /*N*
     1223    20842              OK, so let's say someone decides to honor the MESSAGE LINE
     1224    20843              clause.  Then we'll pull out something like
     1225    20844              "QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.MESSAGE_LINE.GZ.HEADER$"
     1226    20845              to use for the GZ_HEADER$ to the MESSAGE LINE.
     1227    20846        */
     1228    20847    1       QCG@GET_FIELD.MESSAGE_LINE_GZ_HEADER$ = QI_1.MESSAGE_LINE_GZ.HEADER$;
     1229    20848    1       QCG@GET_FIELD.IS_MESSAGE_A_DAD = %NO;
     1230    20849    1       QCG@GET_FIELD.FRAME_INDEX = FRAME_INDEX;
     1231    20850    1       QCG@GET_FIELD.FIELD_INDEX = FIELD_INDEX;
     1232    20851
     1233    20852    1       CALL QCG$GET_FIELD ( QCG@GET_FIELD );
     1234    20853
     1235    20854    1       IF QCG@GET_FIELD.STATUS = %QI#USE_INVALID_RETURN
     1236    20855    1       THEN
     1237    20856    2         DO;
     1238    20857    2           QCR@READ.STATUS = %QI#USE_INVALID_RETURN;
     1239    20858    2           RETURN;
     1240    20859    2         END;
     1241    20860
     1242    20861    1       GOTO RETRY_FIELD_POST_EDITING;
     1243    20862
     1244    20863        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:42   
     1245    20864    1   REPLACE_FIELD_DATA: PROC;
     1246    20865
     1247    20866    2       VARIABLE_SOURCE$ = PINCRC ( QI_1.OTTER_SPACE.T$,
     1248    20867    2         SOURCE_INDEX );
     1249    20868    2       QI_1.OP.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;
     1250    20869
     1251    20870    2       VARIABLE_TARGET$ = PINCRC ( GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$,
     1252    20871    2         TARGET_INDEX
     1253    20872    2         + GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET );
     1254    20873    2       QI_1.OP.LEN.T = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH
     1255    20874    2         - TARGET_INDEX;
     1256    20875
     1257    20876    2       VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =
     1258    20877    2         VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
     1259    20878
     1260    20879    2       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.
             20879                LENGTH;
     1261    20880
     1262    20881    2       RETURN;
     1263    20882
     1264    20883    2   END REPLACE_FIELD_DATA;
     1265    20884
     1266    20885    1   END QCR$READ;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:43   
--  Include file information  --

   QCR_READ_M.:E05TOU  is referenced.
   QCI_IO_READ_M.:E05TOU  is referenced.
   QCG_GET_FIELD_M.:E05TOU  is referenced.
   QCD_DE_EDIT_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QCR$READ.

   Procedure QCR$READ requires 2722 words for executable code.
   Procedure QCR$READ requires 328 words of local(AUTO) storage.

    No errors detected in file QCR$READ.:E05TSI    .

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:44   

 Object Unit name= QCR$READ                                   File name= QCR$READ.:E05TOU
 UTS= JUL 30 '97 05:13:50.84 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0  RoData even  UTS    278    116  QCR$READ
    1   Proc  even  none  2722    AA2  QCR$READ
    2  RoData even  none    11      B  QCR$READ

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  QCR$READ
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:45   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       1 QCI$IO_READ
         yes           Std       4 QCE$ERROR_INTERNAL
         yes           Std       0 QCS$SETUP_SOURCE
 yes     yes           Std       1 QCC$SRCH
         yes           Std       0 QCA$ALL_LITERAL_MOVE_A
 yes     yes           Std       1 QCC$VRFY
 yes     yes           Std       1 QCC$DMC
         yes           Std       5 QCE$ERROR_MESSAGE
         yes           Std       1 QCG$GET_FIELD
         yes           Std       1 QCC$MAT
         yes           Std       1 QCC$ACM
         yes           Std       1 QCD$DE_EDIT
         yes           Std       4 QCE$ERROR
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
                       nStd      0 X6D_MID
                       nStd      0 X6C_ALR
                       nStd      0 X6C_ACM

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     G$JIT$                                QI_1                                  QI_BLANK
     QI_MAT_MATCH                          QI_MAT_NONMATCH                       QI_SLASH
     QI_ZERO                               QI_CLASS_ALPHA                        QI_CLASS_NUMERIC
     QI_OVERPUNCHED_SIGNS                  QI_SRCH_VRFY                          QI_MAT
     QI_4_CHAR_ALPHANUMERIC                QI_31_DIGIT_SLS_DISPLAY               QI_16_BIT_BINARY
     QI_32_BIT_BINARY                      QI_31_DIGIT_ST_PACKED                 QI_PICTURE_STRING
r    G$ROS$
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:46   


        1        1        /*M* QCR$READ:  Screen READ or ACCEPT post-processing.  */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMC,PLM=4,IND=0,DCI=4,CSI=2,IAD=2,DTI=2,AND,ECI=0,DIN=2,STI=2 */
        8        8
        9        9        /*P*  NAME:         QCR$READ
       10       10              PURPOSE:      Do post-M$READ processing of fields.
       11       11              DESCRIPTION:  CALLs QCI$IO_READ, then edits the contents of fields
       12       12                            actually M$READ before returning to higher-level
       13       13                            callers.
       14       14        */
       15       15
       16       16        QCR$READ: PROC ( QCR@READ );

     16   1 000000  D380 0000 0000  xent QCR$READ        LNJ,B5   X6A_AUTO_1
          1 000003       0148 0001                       DC       328,1

       17       17
       18       18        /*D*  NAME:         QCR$READ
       19       19              CALL:         CALL QCR$READ ( QCR@READ );
       20       20              PARAMETERS:   QCR@READ is a structure which contains information
       21       21                            concerning the fields to be read and edited; it's
       22       22                            generated by invoking the QCR@READ %MACRO within the
       23       23                            QCR_READ_M %INCLUDE file (see commentary within
       24       24                            that file).
       25       25              INTERFACE:    Called by routines wishing to perform perform
       26       26                            non-message-line terminal M$READs, and further
       27       27                            wishing the input to be edited after the read in
       28       28                            typical FPL fashion (QBA$ACCEPT, QBR$READ_FORM,
       29       29                            QCG$GET_FIELD).
       30       30              ENVIRONMENT:  Nothing unusual.
       31       31              INPUT:        QI_1, etc.
       32       32              OUTPUT:       QI_1, etc.
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:47   
       33       33              SCRATCH:      Various otter stuff.
       34       34              DESCRIPTION:  The calling routine (ACCEPT, READ_FORM, or GET_FIELD),
       35       35                            sets up the starting and stopping indices for both
       36       36                            frames within the form to be read, and fields within
       37       37                            those frames to be read.  QCI$IO_READ is then called
       38       38                            (with similar indices) to do the actual I-O.  The
       39       39                            indices are narrowed down, and the fields actually
       40       40                            read, are marked by QCI$IO_READ, and post-read editing
       41       41                            is performed on those fields.
       42       42                            This editing includes:
       43       43                            1)  supplying any necessary DEFAULT VALUEs;
       44       44                            2)  checking the composition of the input data according
       45       45                                to the field's DAD type;
       46       46                            3)  verifying the input data against any picture strings
       47       47                                associated with the field's DAD;
       48       48                            4)  taking into account any FILL CHARACTER, MINIMUM SIZE,
       49       49                                and/or CLASS clauses associated with the field's DAD.
       50       50                            If the input is deemed invalid, QCG$GET_FIELD is called
       51       51                            with indices indicating only the field in error, and
       52       52                            that routine re-prompts for that field.
       53       53        */
       54       54
       55       55          %INCLUDE LCP_6;
       56      246          %INCLUDE G_JIT_M;
       57      511          %G$JIT;
       58      925    1     DCL G$JIT$ PTR SYMREF;
       59      926
       60      927          %INCLUDE QG_MACRO_M;
       61     1064          %INCLUDE QI_EQUATES_E;
       62     1423          %INCLUDE QI_PERR_C;
       63     1591          %INCLUDE QI_MACROS_M;
       64     6649          %QI$ALL;
       65    17762
       66    17763    1     DCL CLASS_ALPHABET$ PTR;
       67    17764    1     DCL CLASS_INDEX SBIN;
       68    17765    1     DCL CLASS_THING$ PTR;
       69    17766    1     DCL CLASS_TYPE UBIN;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:48   
       70    17767    1     DCL CURRENT_INDEX SBIN;
       71    17768    1     DCL DATA_INDEX UBIN;
       72    17769    1     DCL DATA_SIGN UBIN;
       73    17770    1     DCL DEFAULT_INDEX SBIN;
       74    17771    1     DCL DIGIT_INDEX UBIN;
       75    17772    1     DCL DIGIT_LENGTH UBIN;
       76    17773    1     DCL ERROR_CODE UBIN;
       77    17774    1     DCL FIELD_DAD$ PTR;
       78    17775    1     DCL FIELD_DAD_P$ PTR;
       79    17776    1     DCL FIELD_IDENTIFIER$ PTR;
       80    17777    1     DCL FIELD_INDEX UBIN;
       81    17778    1     DCL FILL_CHARACTER UBIN;
       82    17779    1     DCL 1 FILL_CHARACTER_MINIMUM_SIZE REDEF FILL_CHARACTER,
       83    17780    1           2 FILL_CHARACTER UBIN(8) UNAL,
       84    17781    1           2 MINIMUM_SIZE UBIN(8) UNAL;
       85    17782    1     DCL FRAME$ PTR;
       86    17783    1     DCL FRAME_INDEX UBIN;
       87    17784    1     DCL FRAME_STATUS$ PTR;
       88    17785    1     DCL GZ_FIELD$ PTR;
       89    17786    1     DCL LAST_DAD$ PTR;
       90    17787    1     DCL MAXIMUM_SIZE UBIN;
       91    17788    1     DCL MAXIMUM_SIZE_TEXT CHAR(2);
       92    17789    1     DCL MINIMUM_SIZE UBIN;
       93    17790    1     DCL MINIMUM_SIZE_TEXT CHAR(3);
       94    17791    1     DCL MOP_STRING_INDEX UBIN;
       95    17792    1     DCL NONBLANK_INDEX UBIN;
       96    17793    1     DCL NONBLANK_LENGTH UBIN;
       97    17794    1     DCL PIC$ PTR;
       98    17795    1     DCL P_ITEM_INDEX UBIN;
       99    17796    1     DCL SOURCE_INDEX UBIN;
      100    17797    1     DCL STARTING_INDEX UBIN;
      101    17798    1     DCL TARGET_INDEX UBIN;
      102    17799    1     DCL THIS_MOP_FUNCTIONS_LENGTH UBIN;
      103    17800    1     DCL 1 U$1 BASED ( U1$ ),
      104    17801    1           2 LENGTH UBIN BYTE UNAL,
      105    17802    1           2 TEXT CHAR(3);
      106    17803    1     DCL 1 U1 AUTO,
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:49   
      107    17804    1           2 LENGTH UBIN BYTE UNAL,
      108    17805    1           2 TEXT CHAR(3);
      109    17806    1     DCL U1$ PTR;
      110    17807    1     DCL VARIABLE_SOURCE$ CPTR;
      111    17808    1     DCL VARIABLE_TARGET$ CPTR;
      112    17809    1     DCL WE_GOTTA_DEFAULT_VALUE BIT(1) ALIGNED;
      113    17810    1     DCL WE_GOTTA_FILL_CHARACTER BIT(1) ALIGNED;
      114    17811
      115    17812          %QI@MAT;
      116    18480          %QI@SRCH_VRFY;
      117    19152
      118    19153          %SET LISTMAC = '1'B;
      119    19154
      120    19155          %QI@OTTER_SPACE ( BYTE_SIZE = %QI#MAXIMUM_FIELD_LENGTH );
             19156            %BEGIN_MACRO ( STCLASS = STCLASS );
             19157            %SET LISTDIR = '0'B;
             19170    1       DCL 1 QI@OTTER_SPACE AUTO ALIGNED,
             19171    1             2 *(0:255) UBIN BYTE UNAL /* Was INIT'ed to:  (0*0)/**/;
             19172    1       DCL 1 QI@OTTER_SPACE_CA (0:255) REDEF QI@OTTER_SPACE CHAR(1) UNAL;
             19173    1       DCL 1 QI@OTTER_SPACE_BA (0:255) REDEF QI@OTTER_SPACE UBIN BYTE UNAL;
             19180            %ENDIF;
      121    19183    1     DCL OTTER_ERROR_MESSAGE CHAR(80);
      122    19184
      123    19185          %INCLUDE QCD_DE_EDIT_M;
      124    19215          %QCD@DE_EDIT;
             19216            %BEGIN_MACRO ( STCLASS = STCLASS );
             19217            %SET LISTDIR = '0'B;
             19230    1     DCL 1 QCD@DE_EDIT ALIGNED,
             19231    1           2 IS_NUMBER_INVALID BIT(1) ALIGNED,
             19232                                           /* Set to 1 if the input is bad,
             19233                                                     0 otherwise.           */
             19234    1           2 RESULT ALIGNED,
             19235    1             3 DIGIT_A(0:30) UBIN BYTE UNAL,
             19236                                           /* The de-edited number, in the form:
             19237                                              UNPACKED((INDEX(RESULT),B7),0,31,LEADING) */
             19238    1             3 DEC SBIN,
             19239                                           /* Decimal position for DIGIT_A */
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:50   
             19240    1             3 INPUT_SIZE SBIN;
             19241                                           /* Length of input minus
             19242                                              leading or trailing blanks */
             19249            %ENDIF;
      125    19252
      126    19253          %INCLUDE QCG_GET_FIELD_M;
      127    19292          %QCG@GET_FIELD;
             19293            %BEGIN_MACRO;
             19294            %SET LISTDIR = '0'B;
             19307    1     DCL 1 QCG@GET_FIELD ALIGNED,
             19308    1           2 MESSAGE_LINE_GZ_HEADER$ PTR,
             19309                           /* Pointer to QI$GZ_HEADER for the
             19310                              MESSAGE LINE to use.  */
             19311    1           2 IS_MESSAGE_A_DAD BIT(1) ALIGNED,
             19312                           /* Set if MESSAGE$ points to a DAD,
             19313                              reset if MESSAGE$ points to text
             19314                              (in which case MESSAGE_LENGTH is valid).  */
             19315    1           2 MESSAGE_LENGTH UBIN,
             19316                           /* Length, in bytes, of the error message.  */
             19317    1           2 MESSAGE$ PTR,
             19318                           /* See IS_MESSAGE_A_DAD.  */
             19319    1           2 FRAME_INDEX UBIN,
             19320                           /* Index of the current frame.  */
             19321    1           2 FIELD_INDEX UBIN,
             19322                           /* Index of the field to re-get (if any).  */
             19323    1           2 STATUS UBIN,
             19324                           /* Returned status code:  0 -> Immediate return to level 0;
             19325                                                    >0 -> Status is ok.  */
             19326    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19327                           /* Passed index for QCG$GET_FIELD processing.  */
             19334            %ENDIF;
      128    19337
      129    19338          %INCLUDE QCI_IO_READ_M;
      130    19378          %QCI@IO_READ;
             19379            %BEGIN_MACRO ( STCLASS = STCLASS );
             19380            %SET LISTDIR = '0'B;
             19393    1     DCL 1 QCI@IO_READ ALIGNED,
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:51   
             19394    1           2 FRAME_START_INDEX UBIN,
             19395                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19396    1           2 FRAME_STOP_INDEX UBIN,
             19397                          /* Stopping index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19398    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19399                          /* If IS_FIELD_INDEXES_VALID, use them;
             19400                             else use all the fields in the frame.  */
             19401    1           2 FIELD_START_INDEX UBIN,
             19402                          /* Starting index into QI$GZ_FIELD table.  */
             19403    1           2 FIELD_STOP_INDEX UBIN,
             19404                          /* Stopping index into QI$GZ_FIELD table.  */
             19405    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19406                          /* If IS_CURSOR_POSITION_VALID, use it;
             19407                             else allow cursor to default to upper-left-most field.  */
             19408    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19409                          /* POSition of the field on which to place the cursor.  */
             19410    1           2 STATUS UBIN,
             19411                          /* Returned status code:  0 -> Immediate return to level 0;
             19412                                                   >0 -> Status is ok.  */
             19413    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19414                          /* Passed index for QCG$GET_FIELD processing.  */
             19421            %ENDIF;
      131    19424
      132    19425          %INCLUDE QCR_READ_M;
      133    19465          %QCR@READ;
             19466            %BEGIN_MACRO ( STCLASS = STCLASS );
             19467            %SET LISTDIR = '0'B;
             19480    1     DCL 1 QCR@READ ALIGNED,
             19481    1           2 FRAME_START_INDEX UBIN,
             19482                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19483    1           2 FRAME_STOP_INDEX UBIN,
             19484                          /* Starting index into QI$FORM_FILE.FRAME_LIST_A@P.  */
             19485    1           2 IS_FIELD_INDEXES_VALID BIT(1) ALIGNED,
             19486                          /* If IS_FIELD_INDEXES_VALID, use them;
             19487                             else use all the fields in the frame.  */
             19488    1           2 FIELD_START_INDEX UBIN,
             19489                          /* Starting index into QI$GZ_FIELD table.  */
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:52   
             19490    1           2 FIELD_STOP_INDEX UBIN,
             19491                          /* Stopping index into QI$GZ_FIELD table.  */
             19492    1           2 IS_CURSOR_POSITION_VALID BIT(1) ALIGNED,
             19493                          /* If IS_CURSOR_POSITION_VALID, use it;
             19494                             else allow cursor to default to upper-left-most field.  */
             19495    1           2 CURSOR_POSITION BIT(16) ALIGNED,
             19496                          /* POSition of the field on which to place the cursor.  */
             19497    1           2 STATUS UBIN,
             19498                          /* Returned status code:  0 -> Immediate return to level 0;
             19499                                                   >0 -> Status is ok.  */
             19500    1           2 FIELD_ERROR_STOP_INDEX UBIN;
             19501                          /* Passed index for QCG$GET_FIELD processing.  */
             19508            %ENDIF;
      134    19511
      135    19512          %SET LISTMAC = '0'B;
      136    19513
      137    19514    1     DCL QCA$ALL_LITERAL_MOVE_A ENTRY;
      138    19515    1     DCL QCC$ACM ENTRY (1);
      139    19516    1     DCL QCC$CBD ENTRY (1);
      140    19517    1     DCL QCC$MAT ENTRY (1);
      141    19518    1     DCL QCC$DMC ENTRY (1) ALTRET;
      142    19519    1     DCL QCC$SRCH ENTRY (1) ALTRET;
      143    19520    1     DCL QCC$VRFY ENTRY (1) ALTRET;
      144    19521    1     DCL QCD$DE_EDIT ENTRY (1);
      145    19522    1     DCL QCE$ERROR ENTRY (4);
      146    19523    1     DCL QCE$ERROR_INTERNAL ENTRY (4);
      147    19524    1     DCL QCE$ERROR_MESSAGE ENTRY (5);
      148    19525    1     DCL QCG$GET_FIELD ENTRY (1);
      149    19526    1     DCL QCI$IO_READ ENTRY (1);
      150    19527    1     DCL QCS$SETUP_SOURCE ENTRY;
      151    19528
      152    19529          /* CONSTANT error-message stuff */
      153    19530    1     DCL OOPS_EMBEDDED_BLANKS CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      154    19531    1       INIT ( 'Embedded blank(s) in numeric input.' );
      155    19532    1     DCL OOPS_SIGN_ONLY CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      156    19533    1       INIT ( 'No numeric value entered.' );
      157    19534    1     DCL OOPS_NON_NUMERICAL CHAR(0) CONSTANT
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:53   
      158    19535    1       INIT ( 'Illegal numeric character:  "x".' );
      159    19536    1     DCL OOPS_ILLEGAL_CHARACTER CHAR(0) CONSTANT
      160    19537    1       INIT ( 'Illegal character:  "x".' );
      161    19538    1     DCL OOPS_MINIMUM_SIZE CHAR(0) CONSTANT
      162    19539    1       INIT ( 'Length of data must be at least ' );
      163    19540    1     DCL OOPS_MAXIMUM_SIZE CHAR(0) CONSTANT
      164    19541    1       INIT ( 'Length of data may be at most ' );
      165    19542    1     DCL OOPS_WITH_LEADING_SIGN CHAR(0) CONSTANT
      166    19543    1       INIT ( ' digits with an optional leading sign.' );
      167    19544    1     DCL OOPS_WITH_TRAILING_SIGN CHAR(0) CONSTANT
      168    19545    1       INIT ( ' digits with an optional trailing sign.' );
      169    19546    1     DCL OOPS_ILLEGAL_INPUT CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      170    19547    1       INIT ( 'Data entered is badly formed.' );
      171    19548    1     DCL OOPS_ENTRY_REQUIRED CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      172    19549    1       INIT ( 'Entry required.' );
      173    19550    1     DCL OOPS_FULLA_FILL CHAR(%QI#ERROR_MESSAGE_LINE_SIZE) CONSTANT
      174    19551    1       INIT ( 'Data entry of only fill characters with class check is illegal.' );
      175    19552        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:54   
      176    19553            /*  Set up a global OTTER_SPACE pointer so that QCI$IO_READ
      177    19554                can use our auto for "scratch" space.  */
      178    19555    1       QI_1.OTTER_SPACE.T$ = ADDR ( QI@OTTER_SPACE );

  19555   1 000005  EBC7 006E                            LAB,B6   QI@OTTER_SPACE,AUTO
          1 000007  EF80 0000 0046  xsym                 STB,B6   QI_1+70

      179    19556
      180    19557    1       QCI@IO_READ = QCR@READ;

  19557   1 00000A  ACC7 0004                            LDB,B2   @QCR@READ,AUTO
          1 00000C  2C00                                 LDV,R2   0
          1 00000D  6C12                                 LDV,R6   18
          1 00000E  BBC7 0133                            LAB,B3   QCI@IO_READ,AUTO
          1 000010  3C00                                 LDV,R3   0
          1 000011  0008                                 MMM

      181    19558
      182    19559    1       CALL QCI$IO_READ ( QCI@IO_READ );

  19559   1 000012  EBC7 0133                            LAB,B6   QCI@IO_READ,AUTO
          1 000014  EFC7 013E                            STB,B6   QCI@IO_READ+11,AUTO
          1 000016  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000018  CBF0 0100                            LAB,B4   256,IMO
          1 00001A  E380 0000 0000  xent                 LNJ,B6   QCI$IO_READ
          1 00001D       0001                            DC       s:19561,PREL

      183    19560
      184    19561    1       QCR@READ.STATUS = QCI@IO_READ.STATUS;

  19561   1 00001E  ECC7 0004                            LDB,B6   @QCR@READ,AUTO
          1 000020  E847 013A                            LDR,R6   QCI@IO_READ+7,AUTO
          1 000022  EF46 0007                            STR,R6   7,B6

      185    19562
      186    19563    1       IF QCI@IO_READ.STATUS = %QI#USE_INVALID_RETURN

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:55   
  19563   1 000024  D847 013A                            LDR,R5   QCI@IO_READ+7,AUTO
          1 000026  5981 0004                            BNEZ,R5  s:19572,PREL

      187    19564    1       THEN
      188    19565    1         RETURN;

  19565   1 000028  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

      189    19566
      190    19567            /*  If no field data was replaced by QCI$IO_READ,
      191    19568                QCI@IO_READ.FRAME_START_INDEX will be
      192    19569                > QCI@IO_READ.FRAME_STOP_INDEX, and we'll just return.  */
      193    19570    1   CHECK_THEM_FRAMES:
      194    19571    1       DO FRAME_INDEX =
      195    19572    2         QCI@IO_READ.FRAME_START_INDEX TO QCI@IO_READ.FRAME_STOP_INDEX;

  19572   1 00002B  C847 0133            CHECK_THEM_FRAM*LDR,R4   QCI@IO_READ,AUTO
          1 00002D  CF47 001D                            STR,R4   FRAME_INDEX,AUTO
          1 00002F  0F81 07BF                            B        s:20605+2,PREL

      196    19573
      197    19574              %PROC_ADDRESS ( THING@P =
             19574                  "QI_1.CURRENT.FORM$ -> QI$FORM_FILE.FRAME_LIST_A@P ( FRAME_INDEX )",
      198    19575              CHECK_FOR_INDIRECTION = NO,
      199    19576              RESULT$ = FRAME$ );

  19594   1 000031  EC80 0000 0076  xsym                 LDB,B6   QI_1+118
          1 000034  B847 001D                            LDR,R3   FRAME_INDEX,AUTO
          1 000036  3E0B                                 ADV,R3   11
          1 000037  A836                                 LDR,R2   ,B6,R3
          1 000038  F852                                 LDR,R7   R2
          1 000039  6C00                                 LDV,R6   0
          1 00003A  8400 0000 0002  xsym                 AID      QI_1+2
          1 00003D  8D47 001B                            SDI      FRAME$,AUTO

      200    19613
      201    19614              %DATA_ADDRESS ( THING@D = "FRAME$ -> QI$FRAME.STATUS_AREA@D",
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:56   
      202    19615              CHECK_FOR_INDIRECTION = NO,
      203    19616              RESULT$ = FRAME_STATUS$ );

  19634   1 00003F  DCC7 001B                            LDB,B5   FRAME$,AUTO
          1 000041  9845 0006                            LDR,R1   6,B5
          1 000043  F851                                 LDR,R7   R1
          1 000044  6C00                                 LDV,R6   0
          1 000045  8400 0000 0000  xsym                 AID      QI_1
          1 000048  8D47 001E                            SDI      FRAME_STATUS$,AUTO

      204    19653
      205    19654    2         IF FRAME_STATUS$ -> QI$FRAME_STATUS.INDICATORS.IS_ACTIVE

  19654   1 00004A  CCC7 001E                            LDB,B4   FRAME_STATUS$,AUTO
          1 00004C  89C4 000C                            CMZ      12,B4
          1 00004E  0881 079E                            BAGE     s:20605,PREL

      206    19655    2         THEN
      207    19656    2   FRAME_IS_ACTIVE:
      208    19657    3           DO;

  19657   1                              FRAME_IS_ACTIVE null
      209    19658
      210    19659    3             IF NOT QCI@IO_READ.IS_FIELD_INDEXES_VALID

  19659   1 000050  89C7 0135            FRAME_IS_ACTIVE CMZ      QCI@IO_READ+2,AUTO
          1 000052  0801 0008                            BAL      s:19668,PREL

      211    19660    3             THEN
      212    19661    4               DO;

      213    19662    4                 QCI@IO_READ.FIELD_START_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19662                          FIELD_START_INDEX;

  19662   1 000054  D804                                 LDR,R5   ,B4
          1 000055  DF47 0136                            STR,R5   QCI@IO_READ+3,AUTO

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:57   
      214    19663    4                 QCI@IO_READ.FIELD_STOP_INDEX = FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.
             19663                          FIELD_STOP_INDEX;

  19663   1 000057  C844 0001                            LDR,R4   1,B4
          1 000059  CF47 0137                            STR,R4   QCI@IO_READ+4,AUTO

      215    19664    4               END;

      216    19665
      217    19666                 %IF QI#DEBUG;
      218    19667
      219    19668    3             IF QCR@READ.IS_FIELD_INDEXES_VALID

  19668   1 00005B  BCC7 0004                            LDB,B3   @QCR@READ,AUTO
          1 00005D  89C3 0002                            CMZ      2,B3
          1 00005F  0881 0014                            BAGE     s:19677,PREL
          1 000061  89C7 0135                            CMZ      QCI@IO_READ+2,AUTO
          1 000063  0881 0010                            BAGE     s:19677,PREL
          1 000065  D843 0003                            LDR,R5   3,B3
          1 000067  D947 0137                            CMR,R5   QCI@IO_READ+4,AUTO
          1 000069  0381 000A                            BLE      s:19677,PREL

      220    19669    3               AND QCI@IO_READ.IS_FIELD_INDEXES_VALID
      221    19670    3               AND ( QCR@READ.FIELD_START_INDEX >
      222    19671    3               QCI@IO_READ.FIELD_STOP_INDEX )
      223    19672    3             THEN
      224    19673    3               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19673   1 00006B  BB80 0000 0001  02                   LAB,B3   +1
          1 00006E  CBF0 0100                            LAB,B4   256,IMO
          1 000070  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 000073       0001                            DC       s:19677,PREL

      225    19674
      226    19675                 %ENDIF;
      227    19676
      228    19677    3             GZ_FIELD$ = PINCRW (
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:58   

  19677   1 000074  ECC7 001E                            LDB,B6   FRAME_STATUS$,AUTO
          1 000076  DCC6 0006                            LDB,B5   6,B6
          1 000078  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 00007A  F847 0136                            LDR,R7   QCI@IO_READ+3,AUTO
          1 00007C  6C00                                 LDV,R6   0
          1 00007D  9B80 0000 0003  02                   LAB,B1   +3
          1 000080  D380 0000 0000  xent                 LNJ,B5   X6D_MID
          1 000083  8447 013E                            AID      QCI@IO_READ+11,AUTO
          1 000085  8D47 0020                            SDI      GZ_FIELD$,AUTO

      229    19678    3               FRAME_STATUS$ -> QI$FRAME_STATUS.GZ.START$,
      230    19679    3               QCI@IO_READ.FIELD_START_INDEX * SIZEW (QI$GZ_FIELD)
      231    19680    3               );
      232    19681
      233    19682    3             LAST_DAD$ = ADDR (NIL);

  19682   1 000087  EB80 0000 0000                       LAB,B6   0
          1 00008A  EFC7 0022                            STB,B6   LAST_DAD$,AUTO

      234    19683
      235    19684    3   POST_EDIT_THEM_FIELDS:
      236    19685    4             DO FIELD_INDEX = QCI@IO_READ.FIELD_START_INDEX TO QCI@IO_READ.
             19685                      FIELD_STOP_INDEX;

  19685   1 00008C  D847 0136            POST_EDIT_THEM_*LDR,R5   QCI@IO_READ+3,AUTO
          1 00008E  DF47 0019                            STR,R5   FIELD_INDEX,AUTO
          1 000090  0F81 0756                            B        s:20601+2,PREL

      237    19686
      238    19687    4   RETRY_FIELD_POST_EDITING:
      239    19688    4               IF GZ_FIELD$ -> QI$GZ_FIELD.OPERATION.IS_DONE

  19688   1 000092  ECC7 0020            RETRY_FIELD_POS*LDB,B6   GZ_FIELD$,AUTO
          1 000094  82C6 000B                            LB,'2000'X        11,B6
          1 000096       2000
          1 000097  0581 0747                            BBF      s:20596,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:59   

      240    19689    4               THEN
      241    19690    4   THAT_SUCKER_IS_DONE:
      242    19691    5                 DO;

  19691   1                              THAT_SUCKER_IS_*null
      243    19692
      244    19693    5                   GZ_FIELD$ -> QI$GZ_FIELD.OPERATION.IS_DONE = %NO;

  19693   1 000099  8846 000B            THAT_SUCKER_IS_*LBF,'2000'X       11,B6
  19693   1 00009B       2000

      245    19694
      246    19695    5                   FIELD_DAD$ = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$;

  19695   1 00009C  DCC6 0004                            LDB,B5   4,B6
          1 00009E  DFC7 0013                            STB,B5   FIELD_DAD$,AUTO

      247    19696
      248    19697                        /*  Increment past any level_multipliers to the
      249    19698                            P.whatever flags.  */
      250    19699    5                   FIELD_DAD_P$ = ADDR (

  19699   1 0000A0  B805                                 LDR,R3   ,B5
          1 0000A1  3044                                 SOR,R3   4
          1 0000A2  B570 0003                            AND,R3   3,IMO
          1 0000A4  3001                                 SOL,R3   1
          1 0000A5  3E0B                                 ADV,R3   11
          1 0000A6  CBB5                                 LAB,B4   ,B5,R3
          1 0000A7  CFC7 0015                            STB,B4   FIELD_DAD_P$,AUTO

      251    19700    5                     FIELD_DAD$ -> QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.
             19700                              LEVEL_MULTIPLIER_A
      252    19701    5                     ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT )
      253    19702    5                     );
      254    19703
      255    19704    5                   IF GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.IS_AOIM
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:60   

  19704   1 0000A9  82C6 0002                            LB,'0800'X        2,B6
  19704   1 0000AB       0800
          1 0000AC  0581 000E                            BBF      s:19714,PREL
          1 0000AE  82C6 0006                            LB,'4000'X        6,B6
          1 0000B0       4000
          1 0000B1  0501 0009                            BBT      s:19714,PREL

      256    19705    5                     AND NOT GZ_FIELD$ -> QI$GZ_FIELD.STATUS.IS_AOIM_MODIFIED
      257    19706    5                   THEN
      258    19707    5   AOIM_FIELD_NOT_MODIFIED:
      259    19708    6                     DO;

  19708   1                              AOIM_FIELD_NOT_*null
      260    19709    6                       GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ -> QI$INDICATORS.
             19709                                STATE_VALUE = %QI#STATE_NULL;

  19709   1 0000B3  BC86                 AOIM_FIELD_NOT_*LDB,B3   ,B6
          1 0000B4  8803                                 LBF,'1800'X       ,B3
          1 0000B5       1800

      261    19710    6                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE = %YES;

  19710   1 0000B6  8946 0006                            LBT,'1000'X       6,B6
  19710   1 0000B8       1000

      262    19711    6                       GOTO NEXT_FIELD_PLEASE;

  19711   1 0000B9  0F81 0725                            B        s:20596,PREL

      263    19712    6                     END AOIM_FIELD_NOT_MODIFIED;
      264    19713
      265    19714    5                   IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0

  19714   1 0000BB  82C6 0006                            LB,'00FF'X        6,B6
  19714   1 0000BD       00FF
          1 0000BE  0501 0130                            BBT      s:19853,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:61   

      266    19715    5                   THEN
      267    19716    5   NOTHING_ENTERED:
      268    19717    6                     DO;

  19717   1                              NOTHING_ENTERED null
      269    19718
      270    19719    6                       IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.DEFAULT

  19719   1 0000C0  ECC7 0015            NOTHING_ENTERED LDB,B6   FIELD_DAD_P$,AUTO
          1 0000C2  8286                                 LB,'2000'X        ,B6
          1 0000C3       2000
          1 0000C4  0581 011A                            BBF      s:19840,PREL

      271    19720    6                       THEN
      272    19721    7                         DO;

      273    19722
      274    19723                                %PRESENCE_DISPLACEMENT (
      275    19724                                PRESENCE_THING$ = FIELD_DAD_P$,
      276    19725                                INDEX = P_ITEM_INDEX,
      277    19726                                START = %QI#P_FIELD_FIRST_INDEX,
      278    19727                                STOP = %QI#P_DEFAULT_INDEX,
      279    19728                                RESULT = DEFAULT_INDEX
      280    19729                                );

  19745   1 0000C6  8947 000F                            LBT,'FFFF'X       DEFAULT_INDEX,AUTO
  19745   1 0000C8       FFFF

  19746   1 0000C9  8747 002E                            CL       P_ITEM_INDEX,AUTO

  19747   1 0000CB  ECC7 0015                            LDB,B6   FIELD_DAD_P$,AUTO
          1 0000CD  B847 002E                            LDR,R3   P_ITEM_INDEX,AUTO
          1 0000CF  82B6                                 LB       ,B6,R3
          1 0000D0  0581 0003                            BBF      s:19750,PREL

  19749   1 0000D2  8AC7 000F                            INC      DEFAULT_INDEX,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:62   

  19750   1 0000D4  8AC7 002E                            INC      P_ITEM_INDEX,AUTO
          1 0000D6  E847 002E                            LDR,R6   P_ITEM_INDEX,AUTO
          1 0000D8  6D02                                 CMV,R6   2
          1 0000D9  03F2                                 BLE      s:19747,SPREL

      281    19761    7                           QI_1.SOURCE$ = ADDR (

  19761   1 0000DA  B847 000F                            LDR,R3   DEFAULT_INDEX,AUTO
          1 0000DC  3E01                                 ADV,R3   1
          1 0000DD  DBB6                                 LAB,B5   ,B6,R3
          1 0000DE  DF80 0000 0018  xsym                 STB,B5   QI_1+24

      282    19762    7                             FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A ( DEFAULT_INDEX )
      283    19763    7                             );
      284    19764
      285    19765    7                           CALL QCS$SETUP_SOURCE;

  19765   1 0000E1  CBF0 0000                            LAB,B4   0,IMO
          1 0000E3  E380 0000 0000  xent                 LNJ,B6   QCS$SETUP_SOURCE
          1 0000E6       0001                            DC       s:19767,PREL

      286    19766
      287    19767    7                           QI_1.OP.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;

  19767   1 0000E7  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0000E9  DCC6 0009                            LDB,B5   9,B6
          1 0000EB  DF80 0000 0022  xsym                 STB,B5   QI_1+34

      288    19768
      289    19769    8                           DO CASE ( QI_1.TYPE.S );

  19769   1 0000EE  B800 0000 0050  xsym                 LDR,R3   QI_1+80
          1 0000F1  3D04                                 CMV,R3   4
          1 0000F2  0281 00DE                            BGE      s:19830,PREL
          1 0000F4  A830 0000 00FA  01                   LDR,R2   s:19769+12,R3
          1 0000F7  83A0 0000 00FE  01                   JMP      s:19772,R2
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:63   
          1 0000FA       0000                            DC       s:19772,PREL
          1 0000FB       00D3                            DC       s:19830,PREL
          1 0000FC       00D3                            DC       s:19830,PREL
          1 0000FD       0054                            DC       s:19795,PREL

      290    19770
      291    19771    8                             CASE ( %QI#TYPE_DISPLAY );

      292    19772    8                               IF QI_1.IS_ALL_LIT.S

  19772   1 0000FE  8980 0000 0038  xsym                 CMZ      QI_1+56
          1 000101  0801 0050                            BAL      s:19795,PREL

      293    19773    8                               THEN
      294    19774    8                                 GOTO PRETEND_ITS_ALPHANUMERIC;
      295    19775
      296    19776    8                               QI_1.OP.CIP.T_A (0) = %QI#CIP_DEFAULT_AS;

  19776   1 000103  6C0B                                 LDV,R6   11
          1 000104  EF00 0000 001C  xsym                 STR,R6   QI_1+28

      297    19777    8                               QI_1.OP.CIP.T.CD.OFFSET = GZ_FIELD$ -> QI$GZ_FIELD.
             19777                                        STATUS.OFFSET;

  19777   1 000107  D846 0006                            LDR,R5   6,B6
          1 000109  DA80 0000 001C  xsym                 SRM,R5,'8000'X    QI_1+28
          1 00010C       8000

      298    19778    8                               QI_1.OP.CIP.T.CD.SIGN = FIELD_DAD$ -> QI$FIELD_DAD.
             19778                                        PSEUDO_CIP.NUMERIC.CD.SIGN;

  19778   1 00010D  CCC7 0013                            LDB,B4   FIELD_DAD$,AUTO
          1 00010F  D844 0001                            LDR,R5   1,B4
          1 000111  DA80 0000 001C  xsym                 SRM,R5,'6000'X    QI_1+28
          1 000114       6000

      299    19779    8                               QI_1.OP.CIP.T.LEN = QI_1.OP.CIP.S.LEN;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:64   

  19779   1 000115  D800 0000 001A  xsym                 LDR,R5   QI_1+26
          1 000118  DA80 0000 001C  xsym                 SRM,R5,'1F00'X    QI_1+28
          1 00011B       1F00

      300    19780    8                               IF QI_1.OP.CIP.T.CD.SIGN = %QI#CD_SIGN_LEADING_SEPARATE

  19780   1 00011C  C800 0000 001C  xsym                 LDR,R4   QI_1+28
          1 00011F  404D                                 SOR,R4   13
          1 000120  C570 0003                            AND,R4   3,IMO
          1 000122  4D02                                 CMV,R4   2
          1 000123  0901 0004                            BE       s:19783,PREL
          1 000125  4D03                                 CMV,R4   3
          1 000126  0981 000A                            BNE      s:19784,PREL

      301    19781    8                                 OR QI_1.OP.CIP.T.CD.SIGN = %
             19781                                          QI#CD_SIGN_TRAILING_SEPARATE
      302    19782    8                               THEN
      303    19783    8                                 QI_1.OP.CIP.T.LEN = QI_1.OP.CIP.T.LEN + 1;

  19783   1 000128  9800 0000 001C  xsym                 LDR,R1   QI_1+28
          1 00012B  9A70 0100                            ADD,R1   256,IMO
          1 00012D  9A80 0000 001C  xsym                 SRM,R1,'1F00'X    QI_1+28
          1 000130       1F00

      304    19784    8                               QI_1.OP.DEC.T = 0;

  19784   1 000131  8700 0000 002A  xsym                 CL       QI_1+42

      305    19785    8                               QI_1.OP.SIZE_ERROR = %QI#CHECK_FOR_SIZE_ERROR;

  19785   1 000134  1C01                                 LDV,R1   1
          1 000135  9F00 0000 0030  xsym                 STR,R1   QI_1+48

      306    19786
      307    19787    8                               CALL QCC$DMC ( QI_1.OP )

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:65   
  19787   1 000138  BB80 0000 0005  02                   LAB,B3   +5
          1 00013B  CBF0 0100                            LAB,B4   256,IMO
          1 00013D  E380 0000 0000  xent                 LNJ,B6   QCC$DMC
          1 000140       0003                            DC       s:19790,PREL
          1 000141  0F81 0003                            B        s:19793,PREL

      308    19788    8                               WHENALTRETURN
      309    19789    9                                 DO;

      310    19790    9                                   GOTO OVERFLOW;

  19790   1 000143  0F81 074B                            B        s:20667,PREL

      311    19791    9                                 END;
      312    19792
      313    19793    8                               GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = QI_1.OP.CIP.T.
             19793                                        LEN;

  19793   1 000145  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 000147  E800 0000 001C  xsym                 LDR,R6   QI_1+28
          1 00014A  E570 1F00                            AND,R6   7936,IMO
          1 00014C  6048                                 SOR,R6   8
          1 00014D  EAC6 0006                            SRM,R6,'00FF'X    6,B6
          1 00014F       00FF
          1 000150  0F81 0089                            B        s:19834,PREL

      314    19794
      315    19795    8                             CASE ( %QI#TYPE_ALPHANUMERIC );

      316    19796    8   PRETEND_ITS_ALPHANUMERIC:
      317    19797    8                               QI_1.OP.CIP.T_A (0) = %( QI#CIP_INDEXED_TARGET_AS +
             19797                                        QI#FILL_BIT_MASK );

  19797   1 000152  E870 402B            PRETEND_ITS_ALP*LDR,R6   16427,IMO
          1 000154  EF00 0000 001C  xsym                 STR,R6   QI_1+28

      318    19798    8                               QI_1.OP.CIP.T.CA.OFFSET = GZ_FIELD$ -> QI$GZ_FIELD.
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:66   
             19798                                        STATUS.OFFSET;

  19798   1 000157  D846 0006                            LDR,R5   6,B6
          1 000159  DA80 0000 001C  xsym                 SRM,R5,'8000'X    QI_1+28
          1 00015C       8000

      319    19799    8                               QI_1.OP.INX.T = 0;

  19799   1 00015D  8700 0000 002A  xsym                 CL       QI_1+42

      320    19800
      321    19801    8                               IF QI_1.IS_ALL_LIT.S

  19801   1 000160  8980 0000 0038  xsym                 CMZ      QI_1+56
          1 000163  0881 0017                            BAGE     s:19815,PREL

      322    19802    8                               THEN
      323    19803    9                                 DO;

      324    19804
      325    19805    9                                  QI_1.OP.LEN.T = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION
             19805                                            .LENGTH;

  19805   1 000165  D846 0002                            LDR,R5   2,B6
          1 000167  D570 00FF                            AND,R5   255,IMO
          1 000169  DF00 0000 0027  xsym                 STR,R5   QI_1+39

      326    19806
      327    19807    9                                   CALL QCA$ALL_LITERAL_MOVE_A;

  19807   1 00016C  CBF0 0000                            LAB,B4   0,IMO
          1 00016E  E380 0000 0000  xent                 LNJ,B6   QCA$ALL_LITERAL_MOVE_A
          1 000171       0001                            DC       s:19809,PREL

      328    19808
      329    19809    9                                   GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = GZ_FIELD$
             19809                                            -> QI$GZ_FIELD.DESCRIPTION.LENGTH;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:67   

  19809   1 000172  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 000174  E846 0002                            LDR,R6   2,B6
          1 000176  EAC6 0006                            SRM,R6,'00FF'X    6,B6
          1 000178       00FF

      330    19810
      331    19811    9                                 END;

  19811   1 000179  0F81 0060                            B        s:19834,PREL

      332    19812    8                               ELSE
      333    19813    9                                 DO;

      334    19814
      335    19815    9                                   QI_1.OP.LEN.T = QI_1.OP.LEN.S;

  19815   1 00017B  D800 0000 0026  xsym                 LDR,R5   QI_1+38
          1 00017E  DF00 0000 0027  xsym                 STR,R5   QI_1+39

      336    19816
      337    19817    9                                   VARIABLE_SOURCE$ = PINCRC ( QI_1.OP.DATA.S$,

  19817   1 000181  9800 0000 001A  xsym                 LDR,R1   QI_1+26
          1 000184  104F                                 SOR,R1   15
          1 000185  8C80 0000 0020  xsym                 LDI      QI_1+32
          1 000188  7031                                 DCL,R7   1
          1 000189  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 00018B  F851                                 LDR,R7   R1
          1 00018C  6C00                                 LDV,R6   0
          1 00018D  8447 013E                            AID      QCI@IO_READ+11,AUTO
          1 00018F  7071                                 DCR,R7   1
          1 000190  8D47 0037                            SDI      VARIABLE_SOURCE$,AUTO

      338    19818    9                                     QI_1.OP.CIP.S.CA.OFFSET );
      339    19819    9                                   VARIABLE_TARGET$ = PINCRC ( QI_1.OP.DATA.T$,

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:68   
  19819   1 000192  B800 0000 001C  xsym                 LDR,R3   QI_1+28
          1 000195  304F                                 SOR,R3   15
          1 000196  8C80 0000 0022  xsym                 LDI      QI_1+34
          1 000199  7031                                 DCL,R7   1
          1 00019A  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 00019C  F853                                 LDR,R7   R3
          1 00019D  6C00                                 LDV,R6   0
          1 00019E  8447 013E                            AID      QCI@IO_READ+11,AUTO
          1 0001A0  7071                                 DCR,R7   1
          1 0001A1  8D47 0039                            SDI      VARIABLE_TARGET$,AUTO

      340    19820    9                                     QI_1.OP.CIP.T.CA.OFFSET );
      341    19821
      342    19822    9                                  VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =

  19822   1 0001A3  A856                                 LDR,R2   R6
          1 0001A4  E570 7FFF                            AND,R6   32767,IMO
          1 0001A6  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 0001A8  CCC7 013E                            LDB,B4   QCI@IO_READ+11,AUTO
          1 0001AA  204F                                 SOR,R2   15
          1 0001AB  8CC7 0037                            LDI      VARIABLE_SOURCE$,AUTO
          1 0001AD  B856                                 LDR,R3   R6
          1 0001AE  E570 7FFF                            AND,R6   32767,IMO
          1 0001B0  8D47 0140                            SDI      QCI@IO_READ+13,AUTO
          1 0001B2  BCC7 0140                            LDB,B3   QCI@IO_READ+13,AUTO
          1 0001B4  304F                                 SOR,R3   15
          1 0001B5  AF47 0142                            STR,R2   QCI@IO_READ+15,AUTO
          1 0001B7  BF47 0143                            STR,R3   QCI@IO_READ+16,AUTO
          1 0001B9  BFC7 0144                            STB,B3   QCI@IO_READ+17,AUTO
          1 0001BB  CFC7 0146                            STB,B4   QCI@IO_READ+19,AUTO
          1 0001BD  AB83                                 LAB,B2   ,B3
          1 0001BE  A853                                 LDR,R2   R3
          1 0001BF  E855                                 LDR,R6   R5
          1 0001C0  BB84                                 LAB,B3   ,B4
          1 0001C1  B847 0142                            LDR,R3   QCI@IO_READ+15,AUTO
          1 0001C3  F855                                 LDR,R7   R5
          1 0001C4  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:69   

      343    19823    9                                    VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT
             19823                                              ;
      344    19824
      345    19825    9                                  GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = QI_1.OP.LEN
             19825                                            .T;

  19825   1 0001C7  E800 0000 0027  xsym                 LDR,R6   QI_1+39
          1 0001CA  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0001CC  EAC6 0006                            SRM,R6,'00FF'X    6,B6
          1 0001CE       00FF

      346    19826
      347    19827    9                                 END;

  19827   1 0001CF  0F81 000A                            B        s:19834,PREL

      348    19828
      349    19829    8                             CASE ( ELSE );

      350    19830    8                               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  19830   1 0001D1  BB80 0000 0008  02                   LAB,B3   +8
          1 0001D4  CBF0 0100                            LAB,B4   256,IMO
          1 0001D6  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 0001D9       0001                            DC       s:19834,PREL

      351    19831
      352    19832    8                           END;

      353    19833
      354    19834    7                           WE_GOTTA_DEFAULT_VALUE = %YES;

  19834   1 0001DA  8947 003B                            LBT,'8000'X       WE_GOTTA_DEFAULT_VALUE,AUTO
  19834   1 0001DC       8000

      355    19835
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:70   
      356    19836    7                         END;

  19836   1 0001DD  0F81 0013                            B        s:19864,PREL

      357    19837    6                       ELSE
      358    19838    7                         DO; /* no DEFAULT specified */

      359    19839
      360    19840    7                           IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED

  19840   1 0001DF  DCC7 0013                            LDB,B5   FIELD_DAD$,AUTO
          1 0001E1  8285                                 LB,'1000'X        ,B5
          1 0001E2       1000
          1 0001E3  0501 0614                            BBT      s:20611,PREL

      361    19841    7                           THEN
      362    19842    7                             GOTO ENTRY_REQUIRED;
      363    19843
      364    19844    7                           GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ -> QI$INDICATORS.
             19844                                    STATE_VALUE = %QI#STATE_NULL;

  19844   1 0001E5  CCC7 0020                            LDB,B4   GZ_FIELD$,AUTO
          1 0001E7  BC84                                 LDB,B3   ,B4
          1 0001E8  8803                                 LBF,'1800'X       ,B3
          1 0001E9       1800

      365    19845    7                           GZ_FIELD$ -> QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE = %YES;

  19845   1 0001EA  8944 0006                            LBT,'1000'X       6,B4
  19845   1 0001EC       1000

      366    19846    7                           GOTO NEXT_FIELD_PLEASE;

  19846   1 0001ED  0F81 05F1                            B        s:20596,PREL

      367    19847
      368    19848    7                         END;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:71   
      369    19849
      370    19850    6                     END NOTHING_ENTERED;
      371    19851    5                   ELSE
      372    19852    5   SOMETHING_ENTERED:
      373    19853    6                     DO;

  19853   1                              SOMETHING_ENTER*null
      374    19854
      375    19855    6                       WE_GOTTA_DEFAULT_VALUE = %NO;

  19855   1 0001EF  8747 003B            SOMETHING_ENTER*CL       WE_GOTTA_DEFAULT_VALUE,AUTO

      376    19856
      377    19857    6                     END SOMETHING_ENTERED;

      378    19858
      379    19859        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:72   
      380    19860                  /*  We've got some data through either a toiminal
      381    19861                      or a DEFAULT VALUE.  Do something with it.  */
      382    19862                        %IF QI#DEBUG;
      383    19863
      384    19864    5                   IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH >

  19864   1 0001F1  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0001F3  E846 0006                            LDR,R6   6,B6
          1 0001F5  E570 00FF                            AND,R6   255,IMO
          1 0001F7  D846 0002                            LDR,R5   2,B6
          1 0001F9  D570 00FF                            AND,R5   255,IMO
          1 0001FB  E955                                 CMR,R6   R5
          1 0001FC  0A81 000A                            BALE     s:19873,PREL

      385    19865    5                     GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH
      386    19866    5                   THEN
      387    19867    5                     CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  19867   1 0001FE  BB80 0000 0001  02                   LAB,B3   +1
          1 000201  CBF0 0100                            LAB,B4   256,IMO
          1 000203  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 000206       0001                            DC       s:19873,PREL

      388    19868
      389    19869                        %ENDIF;
      390    19870
      391    19871                 /*  Move the input stuff from the read buffer
      392    19872                     into a temp area in OTTER.  */
      393    19873    5                   VARIABLE_SOURCE$ = PINCRC ( GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$,

  19873   1 000207  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 000209  B846 0006                            LDR,R3   6,B6
          1 00020B  304F                                 SOR,R3   15
          1 00020C  DCC6 0009                            LDB,B5   9,B6
          1 00020E  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 000210  8CC7 013E                            LDI      QCI@IO_READ+11,AUTO
          1 000212  7031                                 DCL,R7   1
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:73   
          1 000213  8D47 0140                            SDI      QCI@IO_READ+13,AUTO
          1 000215  F853                                 LDR,R7   R3
          1 000216  6C00                                 LDV,R6   0
          1 000217  8447 0140                            AID      QCI@IO_READ+13,AUTO
          1 000219  7071                                 DCR,R7   1
          1 00021A  8D47 0037                            SDI      VARIABLE_SOURCE$,AUTO

      394    19874    5                     GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET );
      395    19875    5                   QI_1.OP.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;

  19875   1 00021C  D846 0006                            LDR,R5   6,B6
          1 00021E  D570 00FF                            AND,R5   255,IMO
          1 000220  DF00 0000 0026  xsym                 STR,R5   QI_1+38

      396    19876
      397    19877    5                   VARIABLE_TARGET$ = QI_1.OTTER_SPACE.T$;

  19877   1 000223  CC80 0000 0046  xsym                 LDB,B4   QI_1+70
          1 000226  CFC7 0039                            STB,B4   VARIABLE_TARGET$,AUTO

      398    19878    5                   QI_1.OP.LEN.T = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH;

  19878   1 000228  C846 0002                            LDR,R4   2,B6
          1 00022A  C570 00FF                            AND,R4   255,IMO
          1 00022C  CF00 0000 0027  xsym                 STR,R4   QI_1+39

      399    19879
      400    19880    5                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =

  19880   1 00022F  8CC7 0039                            LDI      VARIABLE_TARGET$,AUTO
          1 000231  B856                                 LDR,R3   R6
          1 000232  E570 7FFF                            AND,R6   32767,IMO
          1 000234  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 000236  DCC7 013E                            LDB,B5   QCI@IO_READ+11,AUTO
          1 000238  304F                                 SOR,R3   15
          1 000239  8CC7 0037                            LDI      VARIABLE_SOURCE$,AUTO
          1 00023B  A856                                 LDR,R2   R6
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:74   
          1 00023C  E570 7FFF                            AND,R6   32767,IMO
          1 00023E  8D47 0140                            SDI      QCI@IO_READ+13,AUTO
          1 000240  BCC7 0140                            LDB,B3   QCI@IO_READ+13,AUTO
          1 000242  204F                                 SOR,R2   15
          1 000243  AF47 0142                            STR,R2   QCI@IO_READ+15,AUTO
          1 000245  BF47 0143                            STR,R3   QCI@IO_READ+16,AUTO
          1 000247  BFC7 0144                            STB,B3   QCI@IO_READ+17,AUTO
          1 000249  DFC7 0146                            STB,B5   QCI@IO_READ+19,AUTO
          1 00024B  AB83                                 LAB,B2   ,B3
          1 00024C  E855                                 LDR,R6   R5
          1 00024D  BB85                                 LAB,B3   ,B5
          1 00024E  F854                                 LDR,R7   R4
          1 00024F  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

      401    19881    5                     VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
      402    19882
      403    19883        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:75   
      404    19884                 /*  Check for FILL CHARACTER, MINIMUM SIZE, and/or
      405    19885                     CLASS clauses.  These are independent of how many
      406    19886                     extra times we've been through here by calling
      407    19887                     QCG$GET_FIELD.  */
      408    19888    5                   IF LAST_DAD$ ~= FIELD_DAD$

  19888   1 000252  ECC7 0022                            LDB,B6   LAST_DAD$,AUTO
          1 000254  EDC7 0013                            CMB,B6   FIELD_DAD$,AUTO
          1 000256  0901 005B                            BE       s:20011,PREL

      409    19889    5                   THEN
      410    19890    6                     DO;

      411    19891
      412    19892    6                       LAST_DAD$ = FIELD_DAD$;

  19892   1 000258  DCC7 0013                            LDB,B5   FIELD_DAD$,AUTO
          1 00025A  DFC7 0022                            STB,B5   LAST_DAD$,AUTO

      413    19893
      414    19894                      /* FILL CHARACTER and MINIMUM SIZE stuff.  */
      415    19895    6                       IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.FILL_CHARACTER_MINIMUM_SIZE

  19895   1 00025C  ECC7 0015                            LDB,B6   FIELD_DAD_P$,AUTO
          1 00025E  8986                                 CMZ      ,B6
          1 00025F  0881 0019                            BAGE     s:19908,PREL

      416    19896    6                       THEN
      417    19897    7                         DO;

      418    19898    7                           FILL_CHARACTER = FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A (%
             19898                                    QI#P_FILL_SIZE_INDEX);

  19898   1 000261  E846 0001                            LDR,R6   1,B6
          1 000263  EF47 001A                            STR,R6   FILL_CHARACTER,AUTO

      419    19899    7                           IF FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER = %QI#BLANK
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:76   

  19899   1 000265  D2C7 001A                            LLH,R5   FILL_CHARACTER,AUTO
          1 000267  5D20                                 CMV,R5   32
          1 000268  0981 0005                            BNE      s:19903,PREL

      420    19900    7                           THEN
      421    19901    7                             WE_GOTTA_FILL_CHARACTER = %NO;

  19901   1 00026A  8747 003C                            CL       WE_GOTTA_FILL_CHARACTER,AUTO
          1 00026C  0F81 0004                            B        s:19904,PREL

      422    19902    7                           ELSE
      423    19903    7                             WE_GOTTA_FILL_CHARACTER = %YES;

  19903   1 00026E  8947 003C                            LBT,'8000'X       WE_GOTTA_FILL_CHARACTER,AUTO
  19903   1 000270       8000

      424    19904    7                           MINIMUM_SIZE = FILL_CHARACTER_MINIMUM_SIZE.MINIMUM_SIZE;

  19904   1 000271  C847 001A                            LDR,R4   FILL_CHARACTER,AUTO
          1 000273  C570 00FF                            AND,R4   255,IMO
          1 000275  CF47 0026                            STR,R4   MINIMUM_SIZE,AUTO

      425    19905    7                         END;

  19905   1 000277  0F81 0005                            B        s:19912,PREL

      426    19906    6                       ELSE
      427    19907    7                         DO;

      428    19908    7                           WE_GOTTA_FILL_CHARACTER = %NO;

  19908   1 000279  8747 003C                            CL       WE_GOTTA_FILL_CHARACTER,AUTO

      429    19909    7                           MINIMUM_SIZE = 0;

  19909   1 00027B  8747 0026                            CL       MINIMUM_SIZE,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:77   

      430    19910    7                         END;

      431    19911
      432    19912    6                       IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.CLASS_TYPE > 0

  19912   1 00027D  8286                                 LB,'0007'X        ,B6
  19912   1 00027E       0007
          1 00027F  0581 0008                            BBF      s:19917,PREL

      433    19913    6                       THEN
      434    19914    6                         CLASS_TYPE = FIELD_DAD_P$ -> QI$FIELD_DAD_P.CLASS_TYPE;

  19914   1 000281  E806                                 LDR,R6   ,B6
          1 000282  E570 0007                            AND,R6   7,IMO
          1 000284  EF47 000B                            STR,R6   CLASS_TYPE,AUTO
          1 000286  0F81 002B                            B        s:20011,PREL

      435    19915    6                       ELSE
      436    19916    7                         DO;

      437    19917    7                           IF FIELD_DAD_P$ -> QI$FIELD_DAD_P.P.CLASS_ALPHABET

  19917   1 000288  8286                                 LB,'4000'X        ,B6
  19917   1 000289       4000
          1 00028A  0581 0025                            BBF      s:20003,PREL

      438    19918    7                           THEN
      439    19919    8                             DO;

      440    19920                                    %PRESENCE_DISPLACEMENT (
      441    19921                                    PRESENCE_THING$ = FIELD_DAD_P$,
      442    19922                                    INDEX = P_ITEM_INDEX,
      443    19923                                    START = %QI#P_FIELD_FIRST_INDEX,
      444    19924                                    STOP = %QI#P_CLASS_INDEX,
      445    19925                                    RESULT = CLASS_INDEX
      446    19926                                    );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:78   

  19942   1 00028C  8947 0008                            LBT,'FFFF'X       CLASS_INDEX,AUTO
  19942   1 00028E       FFFF

  19943   1 00028F  8747 002E                            CL       P_ITEM_INDEX,AUTO

  19944   1 000291  ECC7 0015                            LDB,B6   FIELD_DAD_P$,AUTO
          1 000293  B847 002E                            LDR,R3   P_ITEM_INDEX,AUTO
          1 000295  82B6                                 LB       ,B6,R3
          1 000296  0581 0003                            BBF      s:19947,PREL

  19946   1 000298  8AC7 0008                            INC      CLASS_INDEX,AUTO

  19947   1 00029A  8AC7 002E                            INC      P_ITEM_INDEX,AUTO
          1 00029C  E847 002E                            LDR,R6   P_ITEM_INDEX,AUTO
          1 00029E  6D01                                 CMV,R6   1
          1 00029F  03F2                                 BLE      s:19944,SPREL

      447    19958                                    %PROC_ADDRESS (
      448    19959                                    THING@P =
             19959                                  "FIELD_DAD_P$ -> QI$FIELD_DAD_P.P_ITEM_A ( CLASS_INDEX )"
             19959                                        ,
      449    19960                                    CHECK_FOR_INDIRECTION = NO,
      450    19961                                    RESULT$ = CLASS_ALPHABET$
      451    19962                                    );

  19980   1 0002A0  B847 0008                            LDR,R3   CLASS_INDEX,AUTO
          1 0002A2  3E01                                 ADV,R3   1
          1 0002A3  A836                                 LDR,R2   ,B6,R3
          1 0002A4  F852                                 LDR,R7   R2
          1 0002A5  6C00                                 LDV,R6   0
          1 0002A6  8400 0000 0002  xsym                 AID      QI_1+2
          1 0002A9  8D47 0006                            SDI      CLASS_ALPHABET$,AUTO

      452    19999
      453    20000    8                               CLASS_TYPE = %QI#CLASS_ALPHABET;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:79   
  20000   1 0002AB  5C03                                 LDV,R5   3
          1 0002AC  DF47 000B                            STR,R5   CLASS_TYPE,AUTO

      454    20001    8                             END;

  20001   1 0002AE  0F81 0003                            B        s:20011,PREL

      455    20002    7                           ELSE
      456    20003    7                             CLASS_TYPE = %QI#ABSOLUTELY_NO_CLASS;

  20003   1 0002B0  8747 000B                            CL       CLASS_TYPE,AUTO

      457    20004    7                         END;

      458    20005
      459    20006                      /* other stuff */
      460    20007
      461    20008    6                     END;

      462    20009
      463    20010        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:80   
      464    20011    6                   DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.TYPE );

  20011   1 0002B2  ECC7 0013                            LDB,B6   FIELD_DAD$,AUTO
          1 0002B4  B806                                 LDR,R3   ,B6
          1 0002B5  B570 000F                            AND,R3   15,IMO
          1 0002B7  3D04                                 CMV,R3   4
          1 0002B8  0281 0513                            BGE      s:20589,PREL
          1 0002BA  A830 0000 02C0  01                   LDR,R2   s:20011+14,R3
          1 0002BD  83A0 0000 02C4  01                   JMP      s:20014,R2
          1 0002C0       0000                            DC       s:20014,PREL
          1 0002C1       0508                            DC       s:20589,PREL
          1 0002C2       0508                            DC       s:20589,PREL
          1 0002C3       021F                            DC       s:20236,PREL

      465    20012
      466    20013    6                     CASE ( %QI#TYPE_DISPLAY );

      467    20014    6                       QI@SRCH_VRFY = QI_SRCH_VRFY;

  20014   1 0002C4  AB80 0000 0000  xsym                 LAB,B2   QI_SRCH_VRFY
          1 0002C7  2C00                                 LDV,R2   0
          1 0002C8  6C30                                 LDV,R6   48
          1 0002C9  BBC7 0056                            LAB,B3   QI@SRCH_VRFY,AUTO
          1 0002CB  3C00                                 LDV,R3   0
          1 0002CC  0008                                 MMM

      468    20015    6                       QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_BLANK );

  20015   1 0002CD  EB80 0000 0000  xsym                 LAB,B6   QI_BLANK
          1 0002D0  EFC7 005C                            STB,B6   QI@SRCH_VRFY+6,AUTO

      469    20016    6                       QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.SRCH_RESULT );

  20016   1 0002D2  DBC7 006A                            LAB,B5   QI@SRCH_VRFY+20,AUTO
          1 0002D4  DFC7 005E                            STB,B5   QI@SRCH_VRFY+8,AUTO

      470    20017    6                       QI@SRCH_VRFY.DATA.AUX$ = QI_1.OTTER_SPACE.T$;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:81   

  20017   1 0002D6  CC80 0000 0046  xsym                 LDB,B4   QI_1+70
          1 0002D9  CFC7 0060                            STB,B4   QI@SRCH_VRFY+10,AUTO

      471    20018    6                      QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = GZ_FIELD$ -> QI$GZ_FIELD
             20018                                .STATUS.LENGTH;

  20018   1 0002DB  BCC7 0020                            LDB,B3   GZ_FIELD$,AUTO
          1 0002DD  E843 0006                            LDR,R6   6,B3
          1 0002DF  E570 00FF                            AND,R6   255,IMO
          1 0002E1  EF47 0069                            STR,R6   QI@SRCH_VRFY+19,AUTO

      472    20019
      473    20020    6                       NONBLANK_INDEX = 0;

  20020   1 0002E3  8747 002A                            CL       NONBLANK_INDEX,AUTO

      474    20021    6                       NONBLANK_LENGTH = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;

  20021   1 0002E5  D843 0006                            LDR,R5   6,B3
          1 0002E7  D570 00FF                            AND,R5   255,IMO
          1 0002E9  DF47 002B                            STR,R5   NONBLANK_LENGTH,AUTO

      475    20022
      476    20023    6                       CALL QCC$SRCH ( QI@SRCH_VRFY )

  20023   1 0002EB  ABC7 0056                            LAB,B2   QI@SRCH_VRFY,AUTO
          1 0002ED  AFC7 013E                            STB,B2   QCI@IO_READ+11,AUTO
          1 0002EF  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 0002F1  CBF0 0100                            LAB,B4   256,IMO
          1 0002F3  E380 0000 0000  xent                 LNJ,B6   QCC$SRCH
          1 0002F6       0062                            DC       s:20085,PREL

      477    20024    6                         ALTRET ( BOSS_KEEN_NEAT_DISPLAY );
      478    20025
      479    20026                      /*
      480    20027                         <string> ::= [<whatevah>] <blank> [<whatevah>]
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:82   
      481    20028                      */
      482    20029    6                       QI@SRCH_VRFY.INX.AUX = QI@SRCH_VRFY.SRCH_RESULT.DISP;

  20029   1 0002F7  E847 006B                            LDR,R6   QI@SRCH_VRFY+21,AUTO
          1 0002F9  EF47 0067                            STR,R6   QI@SRCH_VRFY+17,AUTO

      483    20030    6                       QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = QI@SRCH_VRFY.
             20030                                SRCH_VRFY_ELEMS.LIST_LEN

  20030   1 0002FB  E247 0069                            SUB,R6   QI@SRCH_VRFY+19,AUTO
          1 0002FD  8256                                 NEG      R6
          1 0002FE  EF47 0069                            STR,R6   QI@SRCH_VRFY+19,AUTO

      484    20031    6                         - QI@SRCH_VRFY.SRCH_RESULT.DISP;
      485    20032
      486    20033    6                       IF QI@SRCH_VRFY.INX.AUX = 0

  20033   1 000300  D847 0067                            LDR,R5   QI@SRCH_VRFY+17,AUTO
          1 000302  5981 003C                            BNEZ,R5  s:20082,PREL

      487    20034    6                       THEN
      488    20035    6   LEADING_BLANKS_IN_DISPLAY:
      489    20036    7                         DO;

  20036   1                              LEADING_BLANKS_*null
      490    20037                          /*
      491    20038                             <string> ::= <blank> [<whatevah>]
      492    20039                          */
      493    20040
      494    20041    7                           CALL QCC$VRFY ( QI@SRCH_VRFY )

  20041   1 000304  EBC7 0056            LEADING_BLANKS_*LAB,B6   QI@SRCH_VRFY,AUTO
          1 000306  EFC7 013E                            STB,B6   QCI@IO_READ+11,AUTO
          1 000308  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 00030A  CBF0 0100                            LAB,B4   256,IMO
          1 00030C  E380 0000 0000  xent                 LNJ,B6   QCC$VRFY
          1 00030F       0003                            DC       s:20045,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:83   
          1 000310  0F81 002A                            B        s:20063,PREL

      495    20042    7                           WHENALTRETURN
      496    20043    8                             DO;

      497    20044
      498    20045    8                               QI@SRCH_VRFY.INX.AUX = QI@SRCH_VRFY.VRFY_RESULT.DISP;

  20045   1 000312  E847 006A                            LDR,R6   QI@SRCH_VRFY+20,AUTO
          1 000314  EF47 0067                            STR,R6   QI@SRCH_VRFY+17,AUTO

      499    20046    8                               QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = QI@SRCH_VRFY.
             20046                                        SRCH_VRFY_ELEMS.LIST_LEN

  20046   1 000316  E247 0069                            SUB,R6   QI@SRCH_VRFY+19,AUTO
          1 000318  8256                                 NEG      R6
          1 000319  EF47 0069                            STR,R6   QI@SRCH_VRFY+19,AUTO

      500    20047    8                                 - QI@SRCH_VRFY.VRFY_RESULT.DISP;
      501    20048
      502    20049    8                               NONBLANK_INDEX = QI@SRCH_VRFY.INX.AUX;

  20049   1 00031B  D847 0067                            LDR,R5   QI@SRCH_VRFY+17,AUTO
          1 00031D  DF47 002A                            STR,R5   NONBLANK_INDEX,AUTO

      503    20050    8                              NONBLANK_LENGTH = QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN;

  20050   1 00031F  EF47 002B                            STR,R6   NONBLANK_LENGTH,AUTO

      504    20051
      505    20052    8                               CALL QCC$SRCH ( QI@SRCH_VRFY )

  20052   1 000321  EBC7 0056                            LAB,B6   QI@SRCH_VRFY,AUTO
          1 000323  EFC7 013E                            STB,B6   QCI@IO_READ+11,AUTO
          1 000325  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000327  CBF0 0100                            LAB,B4   256,IMO
          1 000329  E380 0000 0000  xent                 LNJ,B6   QCC$SRCH
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:84   
          1 00032C       002C                            DC       s:20085,PREL

      506    20053    8                                 ALTRET ( BOSS_KEEN_NEAT_DISPLAY );
      507    20054
      508    20055    8                               QI@SRCH_VRFY.INX.AUX = QI@SRCH_VRFY.INX.AUX

  20055   1 00032D  E847 0067                            LDR,R6   QI@SRCH_VRFY+17,AUTO
          1 00032F  EA47 006B                            ADD,R6   QI@SRCH_VRFY+21,AUTO
          1 000331  EF47 0067                            STR,R6   QI@SRCH_VRFY+17,AUTO

      509    20056    8                                 + QI@SRCH_VRFY.SRCH_RESULT.DISP;
      510    20057    8                               QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = QI@SRCH_VRFY.
             20057                                        SRCH_VRFY_ELEMS.LIST_LEN

  20057   1 000333  D847 0069                            LDR,R5   QI@SRCH_VRFY+19,AUTO
          1 000335  D247 006B                            SUB,R5   QI@SRCH_VRFY+21,AUTO
          1 000337  DF47 0069                            STR,R5   QI@SRCH_VRFY+19,AUTO

      511    20058    8                                 - QI@SRCH_VRFY.SRCH_RESULT.DISP;
      512    20059
      513    20060    8                               EXIT LEADING_BLANKS_IN_DISPLAY;

  20060   1 000339  0F81 0003                            B        s:20063+2,PREL

      514    20061
      515    20062    8                             END;
      516    20063    7                           GOTO NOTHING_ENTERED;

  20063   1 00033B  0F81 FD84                            B        s:19717,PREL
          1 00033D  0F81 0001                            B        s:20082,PREL

      517    20064
      518    20065    7                         END LEADING_BLANKS_IN_DISPLAY;
      519    20066    6                       ELSE
      520    20067    7                         DO;

      521    20068                          /*
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:85   
      522    20069                             <string> ::= <non-blank(s)> <blank> [<whatevah>]
      523    20070                          */
      524    20071    7                         END;

      525    20072
      526    20073                      /*
      527    20074                         <string> ::= <blank(s)> <non-blank(s)> <blank> [<whatevah>]
      528    20075                                      | <non-blank(s)> <blank> [<whatevah>]
      529    20076                         so...
      530    20077                         the [<whatevah>] should either:
      531    20078                           1) not exist;
      532    20079                           2) ::= <blank(s)>.
      533    20080                      */
      534    20081
      535    20082    6                       CALL QCC$VRFY ( QI@SRCH_VRFY )

  20082   1 00033F  EBC7 0056                            LAB,B6   QI@SRCH_VRFY,AUTO
          1 000341  EFC7 013E                            STB,B6   QCI@IO_READ+11,AUTO
          1 000343  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000345  CBF0 0100                            LAB,B4   256,IMO
          1 000347  E380 0000 0000  xent                 LNJ,B6   QCC$VRFY
          1 00034A       04CC                            DC       s:20623,PREL

      536    20083    6                         ALTRET ( EMBEDDED_BLANKS_IN_DISPLAY );
      537    20084
      538    20085    6                       NONBLANK_LENGTH = NONBLANK_LENGTH

  20085   1 00034B  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 00034D  E846 0006                            LDR,R6   6,B6
          1 00034F  E570 00FF                            AND,R6   255,IMO
          1 000351  E247 0067                            SUB,R6   QI@SRCH_VRFY+17,AUTO
          1 000353  E247 002B                            SUB,R6   NONBLANK_LENGTH,AUTO
          1 000355  8256                                 NEG      R6
          1 000356  EF47 002B                            STR,R6   NONBLANK_LENGTH,AUTO

  20085   1                              BOSS_KEEN_NEAT_*null
      539    20086    6                        - ( GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH - QI@SRCH_VRFY.INX.
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:86   
             20086                                  AUX );
      540    20087
      541    20088    6   BOSS_KEEN_NEAT_DISPLAY: /* yeah yeah */;
      542    20089                            /*  MINIMUM SIZE check.  */
      543    20090    6                       IF NONBLANK_LENGTH < MINIMUM_SIZE

  20090   1 000358  E847 002B            BOSS_KEEN_NEAT_*LDR,R6   NONBLANK_LENGTH,AUTO
          1 00035A  E947 0026                            CMR,R6   MINIMUM_SIZE,AUTO
          1 00035C  0201 04D7                            BL       s:20635,PREL

      544    20091    6                       THEN
      545    20092    6                         GOTO MINIMUM_SIZE_ERROR;
      546    20093
      547    20094    6                       DIGIT_INDEX = NONBLANK_INDEX;

  20094   1 00035E  D847 002A                            LDR,R5   NONBLANK_INDEX,AUTO
          1 000360  DF47 0010                            STR,R5   DIGIT_INDEX,AUTO

      548    20095    6                       DIGIT_LENGTH = NONBLANK_LENGTH;

  20095   1 000362  EF47 0011                            STR,R6   DIGIT_LENGTH,AUTO

      549    20096
      550    20097    6   SIGN_STRIPPING_STUFF:
      551    20098    7                       DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.SIGN
             20098                                );

  20098   1 000364  ECC7 0013            SIGN_STRIPPING_*LDB,B6   FIELD_DAD$,AUTO
          1 000366  B846 0001                            LDR,R3   1,B6
          1 000368  304D                                 SOR,R3   13
          1 000369  B570 0003                            AND,R3   3,IMO
          1 00036B  3D04                                 CMV,R3   4
          1 00036C  0281 0070                            BGE      s:20161,PREL
          1 00036E  A830 0000 0374  01                   LDR,R2   SIGN_STRIPPING_STUFF+16,R3
          1 000371  83A0 0000 0378  01                   JMP      s:20101,R2
          1 000374       0063                            DC       s:20155,PREL
          1 000375       003D                            DC       s:20134,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:87   
          1 000376       0000                            DC       s:20101,PREL
          1 000377       001C                            DC       s:20118,PREL

      552    20099
      553    20100    7                         CASE ( %QI#CD_SIGN_LEADING_SEPARATE );

      554    20101    7                           IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX ) = %
             20101                                    QI#PLUS

  20101   1 000378  DC80 0000 0046  xsym                 LDB,B5   QI_1+70
          1 00037B  9855                                 LDR,R1   R5
          1 00037C  C295                                 LLH,R4   ,B5,R1
          1 00037D  4D2B                                 CMV,R4   43
          1 00037E  0901 0004                            BE       s:20105,PREL
          1 000380  4D2D                                 CMV,R4   45
          1 000381  0981 000E                            BNE      s:20115,PREL

      555    20102    7                             OR QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX ) = %
             20102                                      QI#MINUS
      556    20103    7                           THEN
      557    20104    8                             DO;

      558    20105    8                               DIGIT_INDEX = DIGIT_INDEX + 1;

  20105   1 000383  8AC7 0010                            INC      DIGIT_INDEX,AUTO

      559    20106    8                               DIGIT_LENGTH = DIGIT_LENGTH - 1;

  20106   1 000385  88C7 0011                            DEC      DIGIT_LENGTH,AUTO

      560    20107
      561    20108    8                               IF DIGIT_LENGTH = 0

  20108   1 000387  E847 0011                            LDR,R6   DIGIT_LENGTH,AUTO
          1 000389  6901 049B                            BEZ,R6   s:20629,PREL

      562    20109    8                               THEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:88   
      563    20110    8                                 GOTO SIGN_ONLY_IN_DISPLAY;
      564    20111
      565    20112    8                               DATA_SIGN = %QI#CD_SIGN_LEADING_SEPARATE;

  20112   1 00038B  6C02                                 LDV,R6   2
          1 00038C  EF47 000E                            STR,R6   DATA_SIGN,AUTO

      566    20113    8                             END;

  20113   1 00038E  0F81 004E                            B        s:20161,PREL

      567    20114    7                           ELSE
      568    20115    7                             DATA_SIGN = %QI#CD_UNSIGNED;

  20115   1 000390  8747 000E                            CL       DATA_SIGN,AUTO
          1 000392  0F81 004A                            B        s:20161,PREL

      569    20116
      570    20117    7                         CASE ( %QI#CD_SIGN_TRAILING_SEPARATE );

      571    20118    7                           IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX +
             20118                                    DIGIT_LENGTH - 1 ) = %QI#PLUS

  20118   1 000394  DA56                                 ADD,R5   R6
          1 000395  DC80 0000 0046  xsym                 LDB,B5   QI_1+70
          1 000398  9855                                 LDR,R1   R5
          1 000399  1EFF                                 ADV,R1   -1
          1 00039A  D295                                 LLH,R5   ,B5,R1
          1 00039B  5D2B                                 CMV,R5   43
          1 00039C  0901 0009                            BE       s:20122,PREL
          1 00039E  EA47 0010                            ADD,R6   DIGIT_INDEX,AUTO
          1 0003A0  9856                                 LDR,R1   R6
          1 0003A1  1EFF                                 ADV,R1   -1
          1 0003A2  E295                                 LLH,R6   ,B5,R1
          1 0003A3  6D2D                                 CMV,R6   45
          1 0003A4  0981 000C                            BNE      s:20131,PREL

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:89   
      572    20119    7                             OR QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( DIGIT_INDEX +
             20119                                      DIGIT_LENGTH - 1 ) = %QI#MINUS
      573    20120    7                           THEN
      574    20121    8                             DO;

      575    20122    8                               DIGIT_LENGTH = DIGIT_LENGTH - 1;

  20122   1 0003A6  88C7 0011                            DEC      DIGIT_LENGTH,AUTO

      576    20123
      577    20124    8                               IF DIGIT_LENGTH = 0

  20124   1 0003A8  E847 0011                            LDR,R6   DIGIT_LENGTH,AUTO
          1 0003AA  6901 047A                            BEZ,R6   s:20629,PREL

      578    20125    8                               THEN
      579    20126    8                                 GOTO SIGN_ONLY_IN_DISPLAY;
      580    20127
      581    20128    8                               DATA_SIGN = %QI#CD_SIGN_TRAILING_SEPARATE;

  20128   1 0003AC  5C03                                 LDV,R5   3
          1 0003AD  DF47 000E                            STR,R5   DATA_SIGN,AUTO

      582    20129    8                             END;

  20129   1 0003AF  0F81 002D                            B        s:20161,PREL

      583    20130    7                           ELSE
      584    20131    7                             DATA_SIGN = %QI#CD_UNSIGNED;

  20131   1 0003B1  8747 000E                            CL       DATA_SIGN,AUTO
          1 0003B3  0F81 0029                            B        s:20161,PREL

      585    20132
      586    20133    7                         CASE ( %QI#CD_SIGN_TRAILING_OVER );

      587    20134    7                           QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_OVERPUNCHED_SIGNS );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:90   

  20134   1 0003B5  DB80 0000 0000  xsym                 LAB,B5   QI_OVERPUNCHED_SIGNS
          1 0003B8  DFC7 005C                            STB,B5   QI@SRCH_VRFY+6,AUTO

      588    20135    7                           QI@SRCH_VRFY.SRCH_VRFY_ARGS.LIST_LEN = LENGTHC (
             20135                                    QI_OVERPUNCHED_SIGNS );

  20135   1 0003BA  4C14                                 LDV,R4   20
          1 0003BB  CF47 0063                            STR,R4   QI@SRCH_VRFY+13,AUTO

      589    20136    7                           QI@SRCH_VRFY.INX.AUX = DIGIT_INDEX

  20136   1 0003BD  DA56                                 ADD,R5   R6
          1 0003BE  5EFF                                 ADV,R5   -1
          1 0003BF  DF47 0067                            STR,R5   QI@SRCH_VRFY+17,AUTO

      590    20137    7                             + DIGIT_LENGTH
      591    20138    7                             - 1;
      592    20139    7                           QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = 1;

  20139   1 0003C1  3C01                                 LDV,R3   1
          1 0003C2  BF47 0069                            STR,R3   QI@SRCH_VRFY+19,AUTO

      593    20140
      594    20141    7                           CALL QCC$SRCH ( QI@SRCH_VRFY )

  20141   1 0003C4  CBC7 0056                            LAB,B4   QI@SRCH_VRFY,AUTO
          1 0003C6  CFC7 013E                            STB,B4   QCI@IO_READ+11,AUTO
          1 0003C8  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 0003CA  CBF0 0100                            LAB,B4   256,IMO
          1 0003CC  E380 0000 0000  xent                 LNJ,B6   QCC$SRCH
          1 0003CF       0008                            DC       s:20151,PREL

      595    20142    7                           WHENRETURN
      596    20143    8                             DO;

      597    20144                                  /*  There's an overpunched sign.  */
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:91   
      598    20145    8                               DATA_SIGN = %QI#CD_SIGN_TRAILING_OVER;

  20145   1 0003D0  6C01                                 LDV,R6   1
          1 0003D1  EF47 000E                            STR,R6   DATA_SIGN,AUTO

      599    20146    8                               DIGIT_LENGTH = DIGIT_LENGTH - 1;

  20146   1 0003D3  88C7 0011                            DEC      DIGIT_LENGTH,AUTO

      600    20147    8                             END;

  20147   1 0003D5  0F81 0003                            B        s:20152,PREL

      601    20148    7                           WHENALTRETURN
      602    20149    8                             DO;

      603    20150                                  /*  There's no overpunched sign.  */
      604    20151    8                               DATA_SIGN = %QI#CD_UNSIGNED;

  20151   1 0003D7  8747 000E                            CL       DATA_SIGN,AUTO

      605    20152    8                             END;

  20152   1 0003D9  0F81 0003                            B        s:20161,PREL

      606    20153
      607    20154    7                         CASE ( %QI#CD_UNSIGNED );

      608    20155    7                           DATA_SIGN = %QI#CD_UNSIGNED;

  20155   1 0003DB  8747 000E                            CL       DATA_SIGN,AUTO

      609    20156
      610    20157    7                       END SIGN_STRIPPING_STUFF;

      611    20158
      612    20159                            /*  Composition checking:
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:92   
      613    20160                                look for digits of the numerical variety.  */
      614    20161    6                       QI@MAT = QI_MAT;

  20161   1 0003DD  AB80 0000 0000  xsym                 LAB,B2   QI_MAT
          1 0003E0  2C00                                 LDV,R2   0
          1 0003E1  6C30                                 LDV,R6   48
          1 0003E2  BB87                                 LAB,B3   ,AUTO
          1 0003E3  3C7C                                 LDV,R3   124
          1 0003E4  0008                                 MMM

      615    20162    6                       QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;

  20162   1 0003E5  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 0003E8  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      616    20163    6                       QI@MAT.INX.S = DIGIT_INDEX;

  20163   1 0003EA  E847 0010                            LDR,R6   DIGIT_INDEX,AUTO
          1 0003EC  EF47 004D                            STR,R6   QI@MAT+15,AUTO

      617    20164    6                       QI@MAT.LEN.S = DIGIT_LENGTH;

  20164   1 0003EE  D847 0011                            LDR,R5   DIGIT_LENGTH,AUTO
          1 0003F0  DF47 004A                            STR,R5   QI@MAT+12,AUTO

      618    20165    6                       QI@MAT.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;

  20165   1 0003F2  DCC7 0020                            LDB,B5   GZ_FIELD$,AUTO
          1 0003F4  CCC5 0009                            LDB,B4   9,B5
          1 0003F6  CFC7 0046                            STB,B4   QI@MAT+8,AUTO

      619    20166    6                       QI@MAT.INX.T = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET;

  20166   1 0003F8  C845 0006                            LDR,R4   6,B5
          1 0003FA  404F                                 SOR,R4   15
          1 0003FB  CF47 004E                            STR,R4   QI@MAT+16,AUTO

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:93   
      620    20167    6                       QI@MAT.LEN.T = QI@MAT.LEN.S;

  20167   1 0003FD  DF47 004B                            STR,R5   QI@MAT+13,AUTO

      621    20168    6                       QI@MAT.DATA.AUX$ = ADDR ( QI_CLASS_NUMERIC );

  20168   1 0003FF  AB80 0000 0000  xsym                 LAB,B2   QI_CLASS_NUMERIC
          1 000402  AFC7 0048                            STB,B2   QI@MAT+10,AUTO

      622    20169
      623    20170    6                       CALL QCC$MAT ( QI@MAT );

  20170   1 000404  9BC7 003E                            LAB,B1   QI@MAT,AUTO
          1 000406  9FC7 013E                            STB,B1   QCI@IO_READ+11,AUTO
          1 000408  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 00040A  CBF0 0100                            LAB,B4   256,IMO
          1 00040C  E380 0000 0000  xent                 LNJ,B6   QCC$MAT
          1 00040F       0001                            DC       s:20172,PREL

      624    20171
      625    20172    6                       QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );

  20172   1 000410  EB80 0000 0000  xsym                 LAB,B6   QI_MAT_MATCH
          1 000413  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      626    20173    6                       QI@MAT.INX.S = 0;

  20173   1 000415  8747 004D                            CL       QI@MAT+15,AUTO

      627    20174    6                       QI@MAT.LEN.S = 1;

  20174   1 000417  6C01                                 LDV,R6   1
          1 000418  EF47 004A                            STR,R6   QI@MAT+12,AUTO

      628    20175
      629    20176    6                       CALL QCC$ACM ( QI@MAT );

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:94   
  20176   1 00041A  DBC7 003E                            LAB,B5   QI@MAT,AUTO
          1 00041C  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 00041E  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000420  CBF0 0100                            LAB,B4   256,IMO
          1 000422  E380 0000 0000  xent                 LNJ,B6   QCC$ACM
          1 000425       0001                            DC       s:20178,PREL

      630    20177
      631    20178    6                       IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL

  20178   1 000426  E847 0055                            LDR,R6   QI@MAT+23,AUTO
          1 000428  6D02                                 CMV,R6   2
          1 000429  0981 04EC                            BNE      s:20708,PREL

      632    20179    6                       THEN
      633    20180    6                         GOTO NON_NUMERICAL_DISPLAY;
      634    20181
      635    20182    7                       DO CASE ( CLASS_TYPE );

  20182   1 00042B  B847 000B                            LDR,R3   CLASS_TYPE,AUTO
          1 00042D  3D04                                 CMV,R3   4
          1 00042E  0281 0045                            BGE      s:20206,PREL
          1 000430  A830 0000 0436  01                   LDR,R2   s:20182+11,R3
          1 000433  83A0 0000 043A  01                   JMP      s:20188,R2
          1 000436       0043                            DC       s:20212,PREL
          1 000437       0043                            DC       s:20212,PREL
          1 000438       003A                            DC       s:20206,PREL
          1 000439       0000                            DC       s:20188,PREL

      636    20183
      637    20184    7                         CASE ( %QI#ABSOLUTELY_NO_CLASS, %QI#CLASS_NUMERIC );

      638    20185                                /* ya bum */
      639    20186
      640    20187    7                         CASE ( %QI#CLASS_ALPHABET );

      641    20188    7                           QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:95   

  20188   1 00043A  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 00043D  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      642    20189    7                           QI@MAT.INX.S = DIGIT_INDEX;

  20189   1 00043F  D847 0010                            LDR,R5   DIGIT_INDEX,AUTO
          1 000441  DF47 004D                            STR,R5   QI@MAT+15,AUTO

      643    20190    7                           QI@MAT.LEN.S = DIGIT_LENGTH;

  20190   1 000443  C847 0011                            LDR,R4   DIGIT_LENGTH,AUTO
          1 000445  CF47 004A                            STR,R4   QI@MAT+12,AUTO

      644    20191    7                           QI@MAT.DATA.AUX$ = CLASS_ALPHABET$;

  20191   1 000447  DCC7 0006                            LDB,B5   CLASS_ALPHABET$,AUTO
          1 000449  DFC7 0048                            STB,B5   QI@MAT+10,AUTO

      645    20192
      646    20193    7                           CALL QCC$MAT ( QI@MAT );

  20193   1 00044B  CBC7 003E                            LAB,B4   QI@MAT,AUTO
          1 00044D  CFC7 013E                            STB,B4   QCI@IO_READ+11,AUTO
          1 00044F  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000451  CBF0 0100                            LAB,B4   256,IMO
          1 000453  E380 0000 0000  xent                 LNJ,B6   QCC$MAT
          1 000456       0001                            DC       s:20195,PREL

      647    20194
      648    20195    7                           QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );

  20195   1 000457  EB80 0000 0000  xsym                 LAB,B6   QI_MAT_MATCH
          1 00045A  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      649    20196    7                           QI@MAT.INX.S = 0;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:96   
  20196   1 00045C  8747 004D                            CL       QI@MAT+15,AUTO

      650    20197    7                           QI@MAT.LEN.S = 1;

  20197   1 00045E  6C01                                 LDV,R6   1
          1 00045F  EF47 004A                            STR,R6   QI@MAT+12,AUTO

      651    20198
      652    20199    7                           CALL QCC$ACM ( QI@MAT );

  20199   1 000461  DBC7 003E                            LAB,B5   QI@MAT,AUTO
          1 000463  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 000465  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000467  CBF0 0100                            LAB,B4   256,IMO
          1 000469  E380 0000 0000  xent                 LNJ,B6   QCC$ACM
          1 00046C       0001                            DC       s:20201,PREL

      653    20200
      654    20201    7                           IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL

  20201   1 00046D  E847 0055                            LDR,R6   QI@MAT+23,AUTO
          1 00046F  6D02                                 CMV,R6   2
          1 000470  0981 04A5                            BNE      s:20708,PREL
          1 000472  0F81 000A                            B        s:20212,PREL

      655    20202    7                           THEN
      656    20203    7                             GOTO CLASS_VIOLATION_IN_DISPLAY;
      657    20204
      658    20205    7                         CASE ( ELSE );

      659    20206    7                           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20206   1 000474  BB80 0000 0008  02                   LAB,B3   +8
          1 000477  CBF0 0100                            LAB,B4   256,IMO
          1 000479  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 00047C       0001                            DC       s:20212,PREL

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:97   
      660    20207
      661    20208    7                       END;

      662    20209
      663    20210                            /*  The following is a specialized
      664    20211                                REPLACE_FIELD_DATA for NUMERIC items only.  */
      665    20212    6                       QI_1.OP.CIP.S_A (0) = %QI#CIP_DEFAULT_AS;

  20212   1 00047D  6C0B                                 LDV,R6   11
          1 00047E  EF00 0000 001A  xsym                 STR,R6   QI_1+26

      666    20213    6                       QI_1.OP.CIP.S.CD.OFFSET = MOD ( NONBLANK_INDEX, 2 );

  20213   1 000481  D847 002A                            LDR,R5   NONBLANK_INDEX,AUTO
          1 000483  D570 0001                            AND,R5   1,IMO
          1 000485  500F                                 SOL,R5   15
          1 000486  DA80 0000 001A  xsym                 SRM,R5,'8000'X    QI_1+26
          1 000489       8000

      667    20214    6                       QI_1.OP.CIP.S.CD.SIGN = DATA_SIGN;

  20214   1 00048A  D847 000E                            LDR,R5   DATA_SIGN,AUTO
          1 00048C  500D                                 SOL,R5   13
          1 00048D  DA80 0000 001A  xsym                 SRM,R5,'6000'X    QI_1+26
          1 000490       6000

      668    20215    6                       QI_1.OP.CIP.S.LEN = NONBLANK_LENGTH;

  20215   1 000491  D847 002B                            LDR,R5   NONBLANK_LENGTH,AUTO
          1 000493  5008                                 SOL,R5   8
          1 000494  DA80 0000 001A  xsym                 SRM,R5,'1F00'X    QI_1+26
          1 000497       1F00

      669    20216    6                       QI_1.OP.DEC.S = 0;

  20216   1 000498  8700 0000 0029  xsym                 CL       QI_1+41

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:98   
      670    20217    6                      QI_1.OP.DATA.S$ = PINCRW ( QI_1.OTTER_SPACE.T$, NONBLANK_INDEX /
             20217                                2 );

  20217   1 00049B  D847 002A                            LDR,R5   NONBLANK_INDEX,AUTO
          1 00049D  5041                                 SOR,R5   1
          1 00049E  F855                                 LDR,R7   R5
          1 00049F  6C00                                 LDV,R6   0
          1 0004A0  8400 0000 0046  xsym                 AID      QI_1+70
          1 0004A3  8D00 0000 0020  xsym                 SDI      QI_1+32

      671    20218    6                       QI_1.OP.CIP.T_A (0) = %QI#CIP_DEFAULT_AS;

  20218   1 0004A6  5C0B                                 LDV,R5   11
          1 0004A7  DF00 0000 001C  xsym                 STR,R5   QI_1+28

      672    20219    6                      QI_1.OP.CIP.T.CD.OFFSET = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET
             20219                                ;

  20219   1 0004AA  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0004AC  C846 0006                            LDR,R4   6,B6
          1 0004AE  CA80 0000 001C  xsym                 SRM,R4,'8000'X    QI_1+28
          1 0004B1       8000

      673    20220    6                       QI_1.OP.CIP.T.CD.SIGN = FIELD_DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.
             20220                                NUMERIC.CD.SIGN;

  20220   1 0004B2  DCC7 0013                            LDB,B5   FIELD_DAD$,AUTO
          1 0004B4  C845 0001                            LDR,R4   1,B5
          1 0004B6  CA80 0000 001C  xsym                 SRM,R4,'6000'X    QI_1+28
          1 0004B9       6000

      674    20221    6                      QI_1.OP.CIP.T.LEN = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH;

  20221   1 0004BA  C846 0002                            LDR,R4   2,B6
          1 0004BC  4008                                 SOL,R4   8
          1 0004BD  CA80 0000 001C  xsym                 SRM,R4,'1F00'X    QI_1+28
          1 0004C0       1F00
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:99   

      675    20222    6                       QI_1.OP.DEC.T = 0;

  20222   1 0004C1  8700 0000 002A  xsym                 CL       QI_1+42

      676    20223    6                       QI_1.OP.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;

  20223   1 0004C4  CCC6 0009                            LDB,B4   9,B6
          1 0004C6  CF80 0000 0022  xsym                 STB,B4   QI_1+34

      677    20224    6                       QI_1.OP.SIZE_ERROR = %QI#CHECK_FOR_SIZE_ERROR;

  20224   1 0004C9  4C01                                 LDV,R4   1
          1 0004CA  CF00 0000 0030  xsym                 STR,R4   QI_1+48

      678    20225
      679    20226    6                       CALL QCC$DMC ( QI_1.OP )

  20226   1 0004CD  BB80 0000 0005  02                   LAB,B3   +5
          1 0004D0  CBF0 0100                            LAB,B4   256,IMO
          1 0004D2  E380 0000 0000  xent                 LNJ,B6   QCC$DMC
          1 0004D5       0003                            DC       s:20229,PREL
          1 0004D6  0F81 0003                            B        s:20232,PREL

      680    20227    6                       WHENALTRETURN
      681    20228    7                         DO;

      682    20229    7                           GOTO OVERFLOW;

  20229   1 0004D8  0F81 03B6                            B        s:20667,PREL

      683    20230    7                         END;
      684    20231
      685    20232    6                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = GZ_FIELD$ ->
             20232                                QI$GZ_FIELD.DESCRIPTION.LENGTH;

  20232   1 0004DA  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:100  
          1 0004DC  E846 0002                            LDR,R6   2,B6
          1 0004DE  EAC6 0006                            SRM,R6,'00FF'X    6,B6
          1 0004E0       00FF
          1 0004E1  0F81 02F3                            B        s:20593,PREL

      686    20233
      687    20234        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:101  
      688    20235    6                     CASE ( %QI#TYPE_ALPHANUMERIC );

      689    20236    6                       IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED

  20236   1 0004E3  8286                                 LB,'1000'X        ,B6
  20236   1 0004E4       1000
          1 0004E5  0581 002C                            BBF      s:20249,PREL

      690    20237    6                       THEN
      691    20238    7                         DO;

      692    20239    7                           VARIABLE_SOURCE$ = QI_1.OTTER_SPACE.T$;

  20239   1 0004E7  DC80 0000 0046  xsym                 LDB,B5   QI_1+70
          1 0004EA  DFC7 0037                            STB,B5   VARIABLE_SOURCE$,AUTO

      693    20240    7                           QI_1.OP.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;

  20240   1 0004EC  CCC7 0020                            LDB,B4   GZ_FIELD$,AUTO
          1 0004EE  E844 0006                            LDR,R6   6,B4
          1 0004F0  E570 00FF                            AND,R6   255,IMO
          1 0004F2  EF00 0000 0026  xsym                 STR,R6   QI_1+38

      694    20241
      695    20242    7                           IF VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT = ' '

  20242   1 0004F5  8CC7 0037                            LDI      VARIABLE_SOURCE$,AUTO
          1 0004F7  B856                                 LDR,R3   R6
          1 0004F8  E570 7FFF                            AND,R6   32767,IMO
          1 0004FA  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 0004FC  BCC7 013E                            LDB,B3   QCI@IO_READ+11,AUTO
          1 0004FE  304F                                 SOR,R3   15
          1 0004FF  BF47 0140                            STR,R3   QCI@IO_READ+13,AUTO
          1 000501  BFC7 0141                            STB,B3   QCI@IO_READ+14,AUTO
          1 000503  AB83                                 LAB,B2   ,B3
          1 000504  A853                                 LDR,R2   R3
          1 000505  E800 0000 0026  xsym                 LDR,R6   QI_1+38
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:102  
          1 000508  BB80 0000 0000  02                   LAB,B3   0
          1 00050B  3C14                                 LDV,R3   20
          1 00050C  7C01                                 LDV,R7   1
          1 00050D  D380 0000 0000  xent                 LNJ,B5   X6C_ACM
          1 000510  5381 02E7                            CBE      s:20611,PREL

      696    20243    7                           THEN
      697    20244    7                             GOTO ENTRY_REQUIRED;
      698    20245    7                         END;

      699    20246
      700    20247                            /*  SOURCE_INDEX and TARGET_INDEX will eventually
      701    20248                                be used by REPLACE_FIELD_DATA.  */
      702    20249    6                       SOURCE_INDEX = 0;

  20249   1 000512  8747 002F                            CL       SOURCE_INDEX,AUTO

      703    20250    6                       TARGET_INDEX = 0;

  20250   1 000514  8747 0031                            CL       TARGET_INDEX,AUTO

      704    20251
      705    20252    6                       IF FIELD_DAD$ -> QI$FIELD_DAD.PICTURE_STRING@P > 0

  20252   1 000516  ECC7 0013                            LDB,B6   FIELD_DAD$,AUTO
          1 000518  E846 0003                            LDR,R6   3,B6
          1 00051A  6901 0134                            BEZ,R6   s:20416,PREL

      706    20253    6                       THEN
      707    20254    6   PICTURE_STRING_STUFF:
      708    20255    7                         DO;

  20255   1                              PICTURE_STRING_*null
      709    20256
      710    20257                                %PROC_ADDRESS (
      711    20258                                THING@P = "FIELD_DAD$ -> QI$FIELD_DAD.PICTURE_STRING@P",
      712    20259                                CHECK_FOR_INDIRECTION = NO,
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:103  
      713    20260                                RESULT$ = PIC$
      714    20261                                );

  20279   1 00051C  B856                 PICTURE_STRING_*LDR,R3   R6
          1 00051D  F853                                 LDR,R7   R3
          1 00051E  6C00                                 LDV,R6   0
          1 00051F  8400 0000 0002  xsym                 AID      QI_1+2
          1 000522  8D47 002C                            SDI      PIC$,AUTO

      715    20298    8                           DO CASE ( PIC$ -> QI$PICTURE_STRING.TYPE );

  20298   1 000524  DCC7 002C                            LDB,B5   PIC$,AUTO
          1 000526  A805                                 LDR,R2   ,B5
          1 000527  204D                                 SOR,R2   13
          1 000528  2D02                                 CMV,R2   2
          1 000529  0281 0120                            BGE      s:20409,PREL
          1 00052B  9820 0000 0531  01                   LDR,R1   s:20298+13,R2
          1 00052E  8390 0000 0533  01                   JMP      s:20303,R1
          1 000531       0032                            DC       s:20321,PREL
          1 000532       0000                            DC       s:20303,PREL

      716    20299
      717    20300    8                             CASE ( %QI#NUMERIC_PICTURE_STRING );

      718    20301                                  /*  Only fill in the fields that
      719    20302                                      QCD$DE_EDIT will need.  */
      720    20303    8                               QI_1.OP.LEN_A (%QI#DE_EDIT) = GZ_FIELD$ -> QI$GZ_FIELD.
             20303                                        STATUS.LENGTH;

  20303   1 000533  CCC7 0020                            LDB,B4   GZ_FIELD$,AUTO
          1 000535  D844 0006                            LDR,R5   6,B4
          1 000537  D570 00FF                            AND,R5   255,IMO
          1 000539  DF00 0000 0028  xsym                 STR,R5   QI_1+40

      721    20304    8                               QI_1.OFFSET_A (%QI#DE_EDIT) = 0;

  20304   1 00053C  8700 0000 0043  xsym                 CL       QI_1+67
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:104  

      722    20305    8                               QI_1.OP.DATA_A$ (%QI#DE_EDIT) = QI_1.OTTER_SPACE.T$;

  20305   1 00053F  BC80 0000 0046  xsym                 LDB,B3   QI_1+70
          1 000542  BF80 0000 0024  xsym                 STB,B3   QI_1+36

      723    20306    8                               QI_1.PICTURE_STRING_A$ (%QI#DE_EDIT) = PIC$;

  20306   1 000545  DF80 0000 004E  xsym                 STB,B5   QI_1+78

      724    20307
      725    20308    8                               CALL QCD$DE_EDIT ( QCD@DE_EDIT );

  20308   1 000548  ABC7 0116                            LAB,B2   QCD@DE_EDIT,AUTO
          1 00054A  AFC7 013E                            STB,B2   QCI@IO_READ+11,AUTO
          1 00054C  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 00054E  CBF0 0100                            LAB,B4   256,IMO
          1 000550  E380 0000 0000  xent                 LNJ,B6   QCD$DE_EDIT
          1 000553       0001                            DC       s:20310,PREL

      726    20309
      727    20310    8                               IF QCD@DE_EDIT.IS_NUMBER_INVALID

  20310   1 000554  89C7 0116                            CMZ      QCD@DE_EDIT,AUTO
          1 000556  0801 02B0                            BAL      s:20617,PREL

      728    20311    8                               THEN
      729    20312    8                                 GOTO ILLEGAL_INPUT_IN_DE;
      730    20313
      731    20314    8                               IF QCD@DE_EDIT.RESULT.INPUT_SIZE < MINIMUM_SIZE

  20314   1 000558  E847 0128                            LDR,R6   QCD@DE_EDIT+18,AUTO
          1 00055A  6801 02D9                            BLZ,R6   s:20635,PREL
          1 00055C  E947 0026                            CMR,R6   MINIMUM_SIZE,AUTO
          1 00055E  0201 02D5                            BL       s:20635,PREL

      732    20315    8                               THEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:105  
      733    20316    8                                 GOTO MINIMUM_SIZE_ERROR;
      734    20317
      735    20318    8                               CALL REPLACE_FIELD_DATA;

  20318   1 000560  E3C0 04DE                            LNJ,B6   s:0,PREL
          1 000562       0001                            DC       s:20318+3,PREL
          1 000563  0F81 00E6                            B        s:20409,PREL

      736    20319
      737    20320    8                             CASE ( %QI#ALPHANUMERIC_PICTURE_STRING );

      738    20321    8                              IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH < MINIMUM_SIZE

  20321   1 000565  CCC7 0020                            LDB,B4   GZ_FIELD$,AUTO
          1 000567  D844 0006                            LDR,R5   6,B4
          1 000569  D570 00FF                            AND,R5   255,IMO
          1 00056B  D947 0026                            CMR,R5   MINIMUM_SIZE,AUTO
          1 00056D  0201 02C6                            BL       s:20635,PREL

      739    20322    8                               THEN
      740    20323    8                                 GOTO MINIMUM_SIZE_ERROR;
      741    20324
      742    20325    8                               QI@SRCH_VRFY = QI_SRCH_VRFY;

  20325   1 00056F  AB80 0000 0000  xsym                 LAB,B2   QI_SRCH_VRFY
          1 000572  2C00                                 LDV,R2   0
          1 000573  6C30                                 LDV,R6   48
          1 000574  BBC7 0056                            LAB,B3   QI@SRCH_VRFY,AUTO
          1 000576  3C00                                 LDV,R3   0
          1 000577  0008                                 MMM

      743    20326    8                              QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.VRFY_RESULT )
             20326                                        ;

  20326   1 000578  EBC7 006A                            LAB,B6   QI@SRCH_VRFY+20,AUTO
          1 00057A  EFC7 005E                            STB,B6   QI@SRCH_VRFY+8,AUTO

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:106  
      744    20327    8                               QI@SRCH_VRFY.DATA.AUX$ = QI_1.OTTER_SPACE.T$;

  20327   1 00057C  DC80 0000 0046  xsym                 LDB,B5   QI_1+70
          1 00057F  DFC7 0060                            STB,B5   QI@SRCH_VRFY+10,AUTO

      745    20328
      746    20329    9                               DO CASE ( CLASS_TYPE );

  20329   1 000581  B847 000B                            LDR,R3   CLASS_TYPE,AUTO
          1 000583  3D04                                 CMV,R3   4
          1 000584  0281 0034                            BGE      s:20351,PREL
          1 000586  A830 0000 058C  01                   LDR,R2   s:20329+11,R3
          1 000589  83A0 0000 0590  01                   JMP      s:20334,R2
          1 00058C       0029                            DC       s:20351,PREL
          1 00058D       0000                            DC       s:20334,PREL
          1 00058E       0007                            DC       s:20338,PREL
          1 00058F       000E                            DC       s:20342,PREL

      747    20330
      748    20331    9                                 CASE ( %QI#ABSOLUTELY_NO_CLASS );

      749    20332
      750    20333    9                                 CASE ( %QI#CLASS_NUMERIC );

      751    20334    9                                   CLASS_THING$ = ADDR ( QI_CLASS_NUMERIC );

  20334   1 000590  CB80 0000 0000  xsym                 LAB,B4   QI_CLASS_NUMERIC
          1 000593  CFC7 0009                            STB,B4   CLASS_THING$,AUTO

      752    20335    9                                   GOTO SETUP_AE_CLASS_CHECK;

  20335   1 000595  0F81 000C                            B        s:20344,PREL

      753    20336
      754    20337    9                                 CASE ( %QI#CLASS_ALPHA );

      755    20338    9                                   CLASS_THING$ = ADDR ( QI_CLASS_ALPHA );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:107  

  20338   1 000597  CB80 0000 0000  xsym                 LAB,B4   QI_CLASS_ALPHA
          1 00059A  CFC7 0009                            STB,B4   CLASS_THING$,AUTO

      756    20339    9                                   GOTO SETUP_AE_CLASS_CHECK;

  20339   1 00059C  0F81 0005                            B        s:20344,PREL

      757    20340
      758    20341    9                                 CASE ( %QI#CLASS_ALPHABET );

      759    20342    9                                   CLASS_THING$ = CLASS_ALPHABET$;

  20342   1 00059E  CCC7 0006                            LDB,B4   CLASS_ALPHABET$,AUTO
          1 0005A0  CFC7 0009                            STB,B4   CLASS_THING$,AUTO

      760    20343    9   SETUP_AE_CLASS_CHECK:
      761    20344    9                                   QI@MAT = QI_MAT;

  20344   1 0005A2  AB80 0000 0000  xsym SETUP_AE_CLASS_*LAB,B2   QI_MAT
          1 0005A5  2C00                                 LDV,R2   0
          1 0005A6  6C30                                 LDV,R6   48
          1 0005A7  BB87                                 LAB,B3   ,AUTO
          1 0005A8  3C7C                                 LDV,R3   124
          1 0005A9  0008                                 MMM

      762    20345    9                                   QI@MAT.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.
             20345                                            DATA$;

  20345   1 0005AA  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0005AC  DCC6 0009                            LDB,B5   9,B6
          1 0005AE  DFC7 0046                            STB,B5   QI@MAT+8,AUTO

      763    20346    9                                   QI@MAT.INX.T = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.
             20346                                            OFFSET;

  20346   1 0005B0  E846 0006                            LDR,R6   6,B6
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:108  
          1 0005B2  604F                                 SOR,R6   15
          1 0005B3  EF47 004E                            STR,R6   QI@MAT+16,AUTO

      764    20347    9                                   QI@MAT.DATA.AUX$ = CLASS_THING$;

  20347   1 0005B5  CCC7 0009                            LDB,B4   CLASS_THING$,AUTO
          1 0005B7  CFC7 0048                            STB,B4   QI@MAT+10,AUTO

      765    20348
      766    20349    9                               END; /* do case class_type */

      767    20350
      768    20351    8                               DATA_INDEX = 0;

  20351   1 0005B9  8747 000D                            CL       DATA_INDEX,AUTO

      769    20352
      770    20353    9                               DO MOP_STRING_INDEX = 0 TO PIC$ ->
             20353                                       QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_COUNT - 1
             20353                                        ;

  20353   1 0005BB  8747 0029                            CL       MOP_STRING_INDEX,AUTO
          1 0005BD  0F81 0081                            B        s:20403+2,PREL

      771    20354
      772    20355    9                                 THIS_MOP_FUNCTIONS_LENGTH = PIC$ ->
             20355                                          QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_A.
             20355                                          LENGTH (MOP_STRING_INDEX);

  20355   1 0005BF  ECC7 002C                            LDB,B6   PIC$,AUTO
          1 0005C1  B847 0029                            LDR,R3   MOP_STRING_INDEX,AUTO
          1 0005C3  3E01                                 ADV,R3   1
          1 0005C4  E836                                 LDR,R6   ,B6,R3
          1 0005C5  E570 3FFF                            AND,R6   16383,IMO
          1 0005C7  EF47 0032                            STR,R6   THIS_MOP_FUNCTIONS_LENGTH,AUTO

      773    20356
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:109  
      774    20357   10                                 DO CASE ( PIC$ -> QI$ALPHANUMERIC_PICTURE_STRING.
             20357                                          EDIT_STRING_A.FUNCTION (MOP_STRING_INDEX) );

  20357   1 0005C9  A836                                 LDR,R2   ,B6,R3
          1 0005CA  204E                                 SOR,R2   14
          1 0005CB  2D04                                 CMV,R2   4
          1 0005CC  0281 006A                            BGE      s:20401,PREL
          1 0005CE  9820 0000 05D4  01                   LDR,R1   s:20357+11,R2
          1 0005D1  8390 0000 05D8  01                   JMP      s:20361,R1
          1 0005D4       0000                            DC       s:20361,PREL
          1 0005D5       003A                            DC       s:20383,PREL
          1 0005D6       0041                            DC       s:20387,PREL
          1 0005D7       0048                            DC       s:20391,PREL

      775    20358
      776    20359   10                                   CASE ( %QI#PIC_M_9_A_X );

      777    20360
      778    20361   10                                     IF CLASS_TYPE ~= %QI#ABSOLUTELY_NO_CLASS

  20361   1 0005D8  D847 000B                            LDR,R5   CLASS_TYPE,AUTO
          1 0005DA  5901 005C                            BEZ,R5   s:20401,PREL

      779    20362   10                                     THEN
      780    20363   11                                       DO;

      781    20364   11                                         QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;

  20364   1 0005DC  DC80 0000 0046  xsym                 LDB,B5   QI_1+70
          1 0005DF  DFC7 0044                            STB,B5   QI@MAT+6,AUTO

      782    20365   11                                         QI@MAT.INX.S = DATA_INDEX;

  20365   1 0005E1  C847 000D                            LDR,R4   DATA_INDEX,AUTO
          1 0005E3  CF47 004D                            STR,R4   QI@MAT+15,AUTO

      783    20366   11                                         QI@MAT.LEN.S = THIS_MOP_FUNCTIONS_LENGTH;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:110  

  20366   1 0005E5  EF47 004A                            STR,R6   QI@MAT+12,AUTO

      784    20367   11                                         QI@MAT.LEN.T = QI@MAT.LEN.S;

  20367   1 0005E7  EF47 004B                            STR,R6   QI@MAT+13,AUTO

      785    20368
      786    20369   11                                         CALL QCC$MAT ( QI@MAT );

  20369   1 0005E9  CBC7 003E                            LAB,B4   QI@MAT,AUTO
          1 0005EB  CFC7 013E                            STB,B4   QCI@IO_READ+11,AUTO
          1 0005ED  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 0005EF  CBF0 0100                            LAB,B4   256,IMO
          1 0005F1  E380 0000 0000  xent                 LNJ,B6   QCC$MAT
          1 0005F4       0001                            DC       s:20371,PREL

      787    20370
      788    20371   11                                         QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );

  20371   1 0005F5  EB80 0000 0000  xsym                 LAB,B6   QI_MAT_MATCH
          1 0005F8  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      789    20372   11                                         QI@MAT.INX.S = 0;

  20372   1 0005FA  8747 004D                            CL       QI@MAT+15,AUTO

      790    20373   11                                         QI@MAT.LEN.S = 1;

  20373   1 0005FC  6C01                                 LDV,R6   1
          1 0005FD  EF47 004A                            STR,R6   QI@MAT+12,AUTO

      791    20374
      792    20375   11                                         CALL QCC$ACM ( QI@MAT );

  20375   1 0005FF  DBC7 003E                            LAB,B5   QI@MAT,AUTO
          1 000601  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:111  
          1 000603  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000605  CBF0 0100                            LAB,B4   256,IMO
          1 000607  E380 0000 0000  xent                 LNJ,B6   QCC$ACM
          1 00060A       0001                            DC       s:20377,PREL

      793    20376
      794    20377   11                                         IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL

  20377   1 00060B  E847 0055                            LDR,R6   QI@MAT+23,AUTO
          1 00060D  6D02                                 CMV,R6   2
          1 00060E  0981 031B                            BNE      s:20716,PREL

      795    20378   11                                         THEN
      796    20379   11                                           GOTO CLASS_VIOLATION_IN_AE;
      797    20380   11                                       END;

  20380   1 000610  0F81 0026                            B        s:20401,PREL

      798    20381
      799    20382   10                                   CASE ( %QI#PIC_M_B );

      800    20383   10                                     QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_BLANK );

  20383   1 000612  DB80 0000 0000  xsym                 LAB,B5   QI_BLANK
          1 000615  DFC7 005C                            STB,B5   QI@SRCH_VRFY+6,AUTO

      801    20384   10                                     GOTO VRFY_IT;

  20384   1 000617  0F81 000D                            B        s:20393,PREL

      802    20385
      803    20386   10                                   CASE ( %QI#PIC_M_0 );

      804    20387   10                                     QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_ZERO );

  20387   1 000619  DB80 0000 0000  xsym                 LAB,B5   QI_ZERO
          1 00061C  DFC7 005C                            STB,B5   QI@SRCH_VRFY+6,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:112  

      805    20388   10                                     GOTO VRFY_IT;

  20388   1 00061E  0F81 0006                            B        s:20393,PREL

      806    20389
      807    20390   10                                   CASE ( %QI#PIC_M_SLASH );

      808    20391   10                                     QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_SLASH );

  20391   1 000620  DB80 0000 0000  xsym                 LAB,B5   QI_SLASH
          1 000623  DFC7 005C                            STB,B5   QI@SRCH_VRFY+6,AUTO

      809    20392   10   VRFY_IT:
      810    20393   10                                     QI@SRCH_VRFY.INX.AUX = DATA_INDEX;

  20393   1 000625  D847 000D            VRFY_IT         LDR,R5   DATA_INDEX,AUTO
          1 000627  DF47 0067                            STR,R5   QI@SRCH_VRFY+17,AUTO

      811    20394   10                                     QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN =
             20394                                              THIS_MOP_FUNCTIONS_LENGTH;

  20394   1 000629  EF47 0069                            STR,R6   QI@SRCH_VRFY+19,AUTO

      812    20395
      813    20396   10                                     CALL QCC$VRFY ( QI@SRCH_VRFY )

  20396   1 00062B  CBC7 0056                            LAB,B4   QI@SRCH_VRFY,AUTO
          1 00062D  CFC7 013E                            STB,B4   QCI@IO_READ+11,AUTO
          1 00062F  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000631  CBF0 0100                            LAB,B4   256,IMO
          1 000633  E380 0000 0000  xent                 LNJ,B6   QCC$VRFY
          1 000636       0362                            DC       s:20752,PREL

      814    20397   10                                       ALTRET ( ILLEGAL_CHARACTER_IN_AE );
      815    20398
      816    20399   10                                 END; /* DO CASE ( PIC$ -> ... ) */
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:113  

      817    20400
      818    20401    9                                 DATA_INDEX = DATA_INDEX + THIS_MOP_FUNCTIONS_LENGTH;

  20401   1 000637  E847 000D                            LDR,R6   DATA_INDEX,AUTO
          1 000639  EA47 0032                            ADD,R6   THIS_MOP_FUNCTIONS_LENGTH,AUTO
          1 00063B  EF47 000D                            STR,R6   DATA_INDEX,AUTO

      819    20402
      820    20403    9                               END; /* DO MOP_STRING_INDEX ... */

  20403   1 00063D  8AC7 0029                            INC      MOP_STRING_INDEX,AUTO
          1 00063F  ECC7 002C                            LDB,B6   PIC$,AUTO
          1 000641  E806                                 LDR,R6   ,B6
          1 000642  E570 1FFF                            AND,R6   8191,IMO
          1 000644  E947 0029                            CMR,R6   MOP_STRING_INDEX,AUTO
          1 000646  0301 FF78                            BG       s:20355,PREL
          1 000648  0F81 0001                            B        s:20409,PREL

      821    20404
      822    20405    8                             CASE ( ELSE );

      823    20406
      824    20407    8                           END; /* do case picture_string_type */

      825    20408
      826    20409    7                           CALL REPLACE_FIELD_DATA;

  20409   1 00064A  E3C0 03F4                            LNJ,B6   s:0,PREL
          1 00064C       0001                            DC       s:20411,PREL

      827    20410
      828    20411    7                         END PICTURE_STRING_STUFF;

  20411   1 00064D  0F81 0187                            B        s:20593,PREL

      829    20412    6                       ELSE
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:114  
      830    20413    6   NO_PICTURE_STRING_STUFF:
      831    20414                        /* We got just a regular old ALPHANUMERIC
      832    20415                           deal, with no PICture string.  */
      833    20416    7                         DO;

  20416   1                              NO_PICTURE_STRI*null
      834    20417    7                           IF WE_GOTTA_FILL_CHARACTER

  20417   1 00064F  89C7 003C            NO_PICTURE_STRI*CMZ      WE_GOTTA_FILL_CHARACTER,AUTO
          1 000651  0881 007E                            BAGE     s:20479,PREL

      835    20418    7                           THEN
      836    20419    7   FILL_CHARACTER_STUFF:
      837    20420    8                             DO;

  20420   1                              FILL_CHARACTER_*null
      838    20421
      839    20422                              /* Do real different stuff according to
      840    20423                                 rightwing-leftwing justification.  */
      841    20424    8                               IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.
             20424                                        IS_JUSTIFIED_RIGHT

  20424   1 000653  8286                 FILL_CHARACTER_*LB,'0400'X        ,B6
  20424   1 000654       0400
          1 000655  0581 0054                            BBF      s:20461,PREL

      842    20425    8                               THEN
      843    20426    8   ITS_A_RIGHTWINGER:
      844    20427    9                                 DO;

  20427   1                              ITS_A_RIGHTWING*null
      845    20428    9                                   QI@SRCH_VRFY = QI_SRCH_VRFY;

  20428   1 000657  AB80 0000 0000  xsym ITS_A_RIGHTWING*LAB,B2   QI_SRCH_VRFY
          1 00065A  2C00                                 LDV,R2   0
          1 00065B  6C30                                 LDV,R6   48
          1 00065C  BBC7 0056                            LAB,B3   QI@SRCH_VRFY,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:115  
          1 00065E  3C00                                 LDV,R3   0
          1 00065F  0008                                 MMM

      846    20429    9                                   QI@SRCH_VRFY.DATA.S$ = ADDR (
             20429                                            FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER );

  20429   1 000660  EBC7 001A                            LAB,B6   FILL_CHARACTER,AUTO
          1 000662  EFC7 005C                            STB,B6   QI@SRCH_VRFY+6,AUTO

      847    20430    9                                   QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.
             20430                                            SRCH_RESULT );

  20430   1 000664  DBC7 006A                            LAB,B5   QI@SRCH_VRFY+20,AUTO
          1 000666  DFC7 005E                            STB,B5   QI@SRCH_VRFY+8,AUTO

      848    20431    9                                   QI@SRCH_VRFY.DATA.AUX$ = QI_1.OTTER_SPACE.T$;

  20431   1 000668  CC80 0000 0046  xsym                 LDB,B4   QI_1+70
          1 00066B  CFC7 0060                            STB,B4   QI@SRCH_VRFY+10,AUTO

      849    20432    9                                  QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = GZ_FIELD$ ->
             20432                                            QI$GZ_FIELD.STATUS.LENGTH;

  20432   1 00066D  BCC7 0020                            LDB,B3   GZ_FIELD$,AUTO
          1 00066F  E843 0006                            LDR,R6   6,B3
          1 000671  E570 00FF                            AND,R6   255,IMO
          1 000673  EF47 0069                            STR,R6   QI@SRCH_VRFY+19,AUTO

      850    20433
      851    20434    9                                   CALL QCC$SRCH ( QI@SRCH_VRFY )

  20434   1 000675  ABC7 0056                            LAB,B2   QI@SRCH_VRFY,AUTO
          1 000677  AFC7 013E                            STB,B2   QCI@IO_READ+11,AUTO
          1 000679  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 00067B  CBF0 0100                            LAB,B4   256,IMO
          1 00067D  E380 0000 0000  xent                 LNJ,B6   QCC$SRCH
          1 000680       0050                            DC       s:20479,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:116  

      852    20435    9                                     ALTRET ( BOSS_KEEN_NEAT_ALPHANUMERIC );
      853    20436
      854    20437    9                                   IF QI@SRCH_VRFY.SRCH_RESULT.DISP = 0

  20437   1 000681  E847 006B                            LDR,R6   QI@SRCH_VRFY+21,AUTO
          1 000683  6981 004C                            BNEZ,R6  s:20479,PREL

      855    20438    9                                   THEN
      856    20439    9   STRIP_LEADING_FILL_CHARACTER:
      857    20440   10                                     DO;

  20440   1                              STRIP_LEADING_F*null
      858    20441                                            /*  FILL CHARACTER in first column:
      859    20442                                                ask how many to strip off.  */
      860    20443
      861    20444   10                                       CALL QCC$VRFY ( QI@SRCH_VRFY )

  20444   1 000685  EBC7 0056            STRIP_LEADING_F*LAB,B6   QI@SRCH_VRFY,AUTO
          1 000687  EFC7 013E                            STB,B6   QCI@IO_READ+11,AUTO
          1 000689  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 00068B  CBF0 0100                            LAB,B4   256,IMO
          1 00068D  E380 0000 0000  xent                 LNJ,B6   QCC$VRFY
          1 000690       0003                            DC       s:20447,PREL
          1 000691  0F81 0011                            B        s:20454,PREL

      862    20445   10                                       WHENALTRETURN
      863    20446   11                                         DO;

      864    20447   11                                          SOURCE_INDEX = QI@SRCH_VRFY.VRFY_RESULT.DISP
             20447                                                    ;

  20447   1 000693  E847 006A                            LDR,R6   QI@SRCH_VRFY+20,AUTO
          1 000695  EF47 002F                            STR,R6   SOURCE_INDEX,AUTO

      865    20448   11                                           GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH =

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:117  
  20448   1 000697  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 000699  D846 0006                            LDR,R5   6,B6
          1 00069B  D570 00FF                            AND,R5   255,IMO
          1 00069D  D256                                 SUB,R5   R6
          1 00069E  DAC6 0006                            SRM,R5,'00FF'X    6,B6
          1 0006A0       00FF

      866    20449   11                                             GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH -
             20449                                                      SOURCE_INDEX;
      867    20450
      868    20451   11                                           EXIT STRIP_LEADING_FILL_CHARACTER;

  20451   1 0006A1  0F81 0006                            B        s:20458,PREL

      869    20452   11                                         END;
      870    20453
      871    20454   10                                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0;

  20454   1 0006A3  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0006A5  8846 0006                            LBF,'00FF'X       6,B6
          1 0006A7       00FF

      872    20455
      873    20456   10                                     END STRIP_LEADING_FILL_CHARACTER;

      874    20457
      875    20458    9                                 END ITS_A_RIGHTWINGER;

  20458   1 0006A8  0F81 0027                            B        s:20479,PREL

      876    20459    8                               ELSE
      877    20460    8   ITS_A_LEFTWINGER:
      878    20461    9                                 DO;

  20461   1                              ITS_A_LEFTWINGERnull
      879    20462
      880    20463    9   STRIP_TRAILING_FILL_CHARACTER:
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:118  
      881    20464                                        /*  FILL CHARACTER in last column:
      882    20465                                            peel off right-to-left.  */
      883    20466   10                                   DO CURRENT_INDEX = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.
             20466                                            LENGTH - 1 DOWNTO 0;

  20466   1 0006AA  DCC7 0020            STRIP_TRAILING_*LDB,B5   GZ_FIELD$,AUTO
          1 0006AC  D845 0006                            LDR,R5   6,B5
          1 0006AE  D570 00FF                            AND,R5   255,IMO
          1 0006B0  5EFF                                 ADV,R5   -1
          1 0006B1  DF47 000C                            STR,R5   CURRENT_INDEX,AUTO
          1 0006B3  0F81 0019                            B        s:20475+2,PREL

      884    20467
      885    20468   10                                     IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A (
             20468                                              CURRENT_INDEX ) =

  20468   1 0006B5  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 0006B8  B847 000C                            LDR,R3   CURRENT_INDEX,AUTO
          1 0006BA  E2B6                                 LLH,R6   ,B6,R3
          1 0006BB  D2C7 001A                            LLH,R5   FILL_CHARACTER,AUTO
          1 0006BD  E955                                 CMR,R6   R5
          1 0006BE  0981 0011                            BNE      s:20479,PREL

      886    20469   10                                       FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER
      887    20470   10                                     THEN
      888    20471   10                                       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH =
             20471                                                GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH - 1;

  20471   1 0006C0  DCC7 0020                            LDB,B5   GZ_FIELD$,AUTO
          1 0006C2  C845 0006                            LDR,R4   6,B5
          1 0006C4  CA70 00FF                            ADD,R4   255,IMO
          1 0006C6  CAC5 0006                            SRM,R4,'00FF'X    6,B5
          1 0006C8       00FF
          1 0006C9  0F81 0001                            B        s:20475,PREL

      889    20472   10                                     ELSE
      890    20473   10                                       EXIT STRIP_TRAILING_FILL_CHARACTER;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:119  
      891    20474
      892    20475   10                                   END STRIP_TRAILING_FILL_CHARACTER;

  20475   1 0006CB  88C7 000C                            DEC      CURRENT_INDEX,AUTO
          1 0006CD  E847 000C                            LDR,R6   CURRENT_INDEX,AUTO
          1 0006CF  68E6                                 BGEZ,R6  s:20468,SPREL

      893    20476
      894    20477    9                                 END ITS_A_LEFTWINGER;

      895    20478
      896    20479    8                             END FILL_CHARACTER_STUFF;

      897    20480
      898    20481    7   BOSS_KEEN_NEAT_ALPHANUMERIC:
      899    20482    7                           IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH < MINIMUM_SIZE

  20482   1 0006D0  ECC7 0020            BOSS_KEEN_NEAT_*LDB,B6   GZ_FIELD$,AUTO
          1 0006D2  E846 0006                            LDR,R6   6,B6
          1 0006D4  E570 00FF                            AND,R6   255,IMO
          1 0006D6  E947 0026                            CMR,R6   MINIMUM_SIZE,AUTO
          1 0006D8  0201 015B                            BL       s:20635,PREL

      900    20483    7                           THEN
      901    20484    7                             GOTO MINIMUM_SIZE_ERROR;
      902    20485
      903    20486    7   ALPHANUMERIC_CLASS_STUFF:
      904    20487    8                           DO CASE ( CLASS_TYPE );

  20487   1 0006DA  B847 000B            ALPHANUMERIC_CL*LDR,R3   CLASS_TYPE,AUTO
          1 0006DC  3D04                                 CMV,R3   4
          1 0006DD  0281 0085                            BGE      s:20541,PREL
          1 0006DF  A830 0000 06E5  01                   LDR,R2   ALPHANUMERIC_CLASS_STUFF+11,R3
          1 0006E2  83A0 0000 06E9  01                   JMP      s:20493,R2
          1 0006E5       0083                            DC       s:20545,PREL
          1 0006E6       0000                            DC       s:20493,PREL
          1 0006E7       000C                            DC       s:20501,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:120  
          1 0006E8       0018                            DC       s:20509,PREL

      905    20488
      906    20489    8                             CASE ( %QI#ABSOLUTELY_NO_CLASS );

      907    20490                                  /* ya bum */
      908    20491
      909    20492    8                             CASE ( %QI#CLASS_NUMERIC );

      910    20493    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0

  20493   1 0006E9  82C6 0006                            LB,'00FF'X        6,B6
  20493   1 0006EB       00FF
          1 0006EC  0581 02D5                            BBF      s:20766,PREL

      911    20494    8                               THEN
      912    20495    8                                 GOTO FULLA_FILL;
      913    20496
      914    20497    8                               CLASS_THING$ = ADDR ( QI_CLASS_NUMERIC );

  20497   1 0006EE  DB80 0000 0000  xsym                 LAB,B5   QI_CLASS_NUMERIC
          1 0006F1  DFC7 0009                            STB,B5   CLASS_THING$,AUTO

      915    20498    8                               GOTO ALPHANUMERIC_CLASS_CHECK;

  20498   1 0006F3  0F81 001E                            B        s:20519,PREL

      916    20499
      917    20500    8                             CASE ( %QI#CLASS_ALPHA );

      918    20501    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0

  20501   1 0006F5  82C6 0006                            LB,'00FF'X        6,B6
  20501   1 0006F7       00FF
          1 0006F8  0581 0073                            BBF      s:20545,PREL

      919    20502    8                               THEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:121  
      920    20503    8                                 EXIT ALPHANUMERIC_CLASS_STUFF;
      921    20504
      922    20505    8                               CLASS_THING$ = ADDR ( QI_CLASS_ALPHA );

  20505   1 0006FA  DB80 0000 0000  xsym                 LAB,B5   QI_CLASS_ALPHA
          1 0006FD  DFC7 0009                            STB,B5   CLASS_THING$,AUTO

      923    20506    8                               GOTO ALPHANUMERIC_CLASS_CHECK;

  20506   1 0006FF  0F81 0012                            B        s:20519,PREL

      924    20507
      925    20508    8                             CASE ( %QI#CLASS_ALPHABET );

      926    20509    8                               IF GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = 0

  20509   1 000701  82C6 0006                            LB,'00FF'X        6,B6
  20509   1 000703       00FF
          1 000704  0501 0009                            BBT      s:20517,PREL

      927    20510    8                               THEN
      928    20511    8                                 IF CLASS_ALPHABET$ -> QI$UBYTE_A (%QI#BLANK) > 0

  20511   1 000706  DCC7 0006                            LDB,B5   CLASS_ALPHABET$,AUTO
          1 000708  D2C5 0010                            LLH,R5   16,B5
          1 00070A  5981 0061                            BNEZ,R5  s:20545,PREL

      929    20512    8                                 THEN
      930    20513    8                                   EXIT ALPHANUMERIC_CLASS_STUFF;
      931    20514    8                                 ELSE
      932    20515    8                                   GOTO FULLA_FILL;

  20515   1 00070C  0F81 02B5                            B        s:20766,PREL

      933    20516
      934    20517    8                               CLASS_THING$ = CLASS_ALPHABET$;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:122  
  20517   1 00070E  DCC7 0006                            LDB,B5   CLASS_ALPHABET$,AUTO
          1 000710  DFC7 0009                            STB,B5   CLASS_THING$,AUTO

      935    20518    8   ALPHANUMERIC_CLASS_CHECK:
      936    20519    8                               QI@MAT = QI_MAT;

  20519   1 000712  AB80 0000 0000  xsym ALPHANUMERIC_CL*LAB,B2   QI_MAT
          1 000715  2C00                                 LDV,R2   0
          1 000716  6C30                                 LDV,R6   48
          1 000717  BB87                                 LAB,B3   ,AUTO
          1 000718  3C7C                                 LDV,R3   124
          1 000719  0008                                 MMM

      937    20520    8                               QI@MAT.DATA.S$ = QI_1.OTTER_SPACE.T$;

  20520   1 00071A  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 00071D  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      938    20521    8                               QI@MAT.INX.S = SOURCE_INDEX;

  20521   1 00071F  E847 002F                            LDR,R6   SOURCE_INDEX,AUTO
          1 000721  EF47 004D                            STR,R6   QI@MAT+15,AUTO

      939    20522    8                               QI@MAT.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;

  20522   1 000723  DCC7 0020                            LDB,B5   GZ_FIELD$,AUTO
          1 000725  D845 0006                            LDR,R5   6,B5
          1 000727  D570 00FF                            AND,R5   255,IMO
          1 000729  DF47 004A                            STR,R5   QI@MAT+12,AUTO

      940    20523    8                               QI@MAT.DATA.T$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;

  20523   1 00072B  CCC5 0009                            LDB,B4   9,B5
          1 00072D  CFC7 0046                            STB,B4   QI@MAT+8,AUTO

      941    20524    8                               QI@MAT.INX.T = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:123  
  20524   1 00072F  C845 0006                            LDR,R4   6,B5
          1 000731  404F                                 SOR,R4   15
          1 000732  CF47 004E                            STR,R4   QI@MAT+16,AUTO

      942    20525    8                               QI@MAT.LEN.T = QI@MAT.LEN.S;

  20525   1 000734  DF47 004B                            STR,R5   QI@MAT+13,AUTO

      943    20526    8                               QI@MAT.DATA.AUX$ = CLASS_THING$;

  20526   1 000736  ACC7 0009                            LDB,B2   CLASS_THING$,AUTO
          1 000738  AFC7 0048                            STB,B2   QI@MAT+10,AUTO

      944    20527
      945    20528    8                               CALL QCC$MAT ( QI@MAT );

  20528   1 00073A  9BC7 003E                            LAB,B1   QI@MAT,AUTO
          1 00073C  9FC7 013E                            STB,B1   QCI@IO_READ+11,AUTO
          1 00073E  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000740  CBF0 0100                            LAB,B4   256,IMO
          1 000742  E380 0000 0000  xent                 LNJ,B6   QCC$MAT
          1 000745       0001                            DC       s:20530,PREL

      946    20529
      947    20530    8                               QI@MAT.DATA.S$ = ADDR ( QI_MAT_MATCH );

  20530   1 000746  EB80 0000 0000  xsym                 LAB,B6   QI_MAT_MATCH
          1 000749  EFC7 0044                            STB,B6   QI@MAT+6,AUTO

      948    20531    8                               QI@MAT.INX.S = 0;

  20531   1 00074B  8747 004D                            CL       QI@MAT+15,AUTO

      949    20532    8                               QI@MAT.LEN.S = 1;

  20532   1 00074D  6C01                                 LDV,R6   1
          1 00074E  EF47 004A                            STR,R6   QI@MAT+12,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:124  

      950    20533
      951    20534    8                               CALL QCC$ACM ( QI@MAT );

  20534   1 000750  DBC7 003E                            LAB,B5   QI@MAT,AUTO
          1 000752  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 000754  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000756  CBF0 0100                            LAB,B4   256,IMO
          1 000758  E380 0000 0000  xent                 LNJ,B6   QCC$ACM
          1 00075B       0001                            DC       s:20536,PREL

      952    20535
      953    20536    8                               IF QI@MAT.COMP_RESULT ~= %QI#IF_EQUAL

  20536   1 00075C  E847 0055                            LDR,R6   QI@MAT+23,AUTO
          1 00075E  6D02                                 CMV,R6   2
          1 00075F  0981 01CA                            BNE      s:20716,PREL
          1 000761  0F81 000A                            B        s:20545,PREL

      954    20537    8                               THEN
      955    20538    8                                 GOTO CLASS_VIOLATION_IN_ALPHA;
      956    20539
      957    20540    8                             CASE ( ELSE );

      958    20541    8                               CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20541   1 000763  BB80 0000 0008  02                   LAB,B3   +8
          1 000766  CBF0 0100                            LAB,B4   256,IMO
          1 000768  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 00076B       0001                            DC       s:20545,PREL

      959    20542
      960    20543    8                           END ALPHANUMERIC_CLASS_STUFF;

      961    20544
      962    20545    7                          IF FIELD_DAD$ -> QI$FIELD_DAD.WORD0_FLAGS.IS_JUSTIFIED_RIGHT

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:125  
  20545   1 00076C  ECC7 0013                            LDB,B6   FIELD_DAD$,AUTO
          1 00076E  8286                                 LB,'0400'X        ,B6
          1 00076F       0400
          1 000770  0581 0056                            BBF      s:20583,PREL

      963    20546    7                           THEN
      964    20547    7   JUSTIFY_RIGHT_IT:
      965    20548                                  /*  JUSTIFY RIGHT it by peeling off
      966    20549                                      blanks, right-to-left.  */
      967    20550    8                             DO;

  20550   1                              JUSTIFY_RIGHT_ITnull
      968    20551
      969    20552    8   STRIP_TRAILING_BLANKS:
      970    20553    9                              DO CURRENT_INDEX = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.
             20553                                        LENGTH - 1 DOWNTO 0;

  20553   1 000772  DCC7 0020            STRIP_TRAILING_*LDB,B5   GZ_FIELD$,AUTO
          1 000774  E845 0002                            LDR,R6   2,B5
          1 000776  E570 00FF                            AND,R6   255,IMO
          1 000778  6EFF                                 ADV,R6   -1
          1 000779  EF47 000C                            STR,R6   CURRENT_INDEX,AUTO
          1 00077B  0F81 0010                            B        s:20562+2,PREL

      971    20554
      972    20555    9                                IF QI_1.OTTER_SPACE.T$ -> QI$UBYTE_A ( CURRENT_INDEX )
             20555                                          =

  20555   1 00077D  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 000780  B847 000C                            LDR,R3   CURRENT_INDEX,AUTO
          1 000782  E2B6                                 LLH,R6   ,B6,R3
          1 000783  6D20                                 CMV,R6   32
          1 000784  0981 000A                            BNE      s:20564,PREL

      973    20556    9                                   %QI#BLANK
      974    20557    9                                 THEN
      975    20558    9                                   TARGET_INDEX = TARGET_INDEX + 1;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:126  

  20558   1 000786  8AC7 0031                            INC      TARGET_INDEX,AUTO
          1 000788  0F81 0001                            B        s:20562,PREL

      976    20559    9                                 ELSE
      977    20560    9                                   EXIT STRIP_TRAILING_BLANKS;
      978    20561
      979    20562    9                               END STRIP_TRAILING_BLANKS;

  20562   1 00078A  88C7 000C                            DEC      CURRENT_INDEX,AUTO
          1 00078C  E847 000C                            LDR,R6   CURRENT_INDEX,AUTO
          1 00078E  68EF                                 BGEZ,R6  s:20555,SPREL

      980    20563
      981    20564    8                               TARGET_INDEX = TARGET_INDEX

  20564   1 00078F  E847 0031                            LDR,R6   TARGET_INDEX,AUTO
          1 000791  EA47 002F                            ADD,R6   SOURCE_INDEX,AUTO
          1 000793  EF47 0031                            STR,R6   TARGET_INDEX,AUTO

      982    20565    8                                 + SOURCE_INDEX;
      983    20566
      984    20567    8                               IF TARGET_INDEX > 0

  20567   1 000795  6901 0031                            BEZ,R6   s:20583,PREL

      985    20568    8                               THEN
      986    20569    8   BLANK_FILL_ON_THE_LEFT:
      987    20570    9                                 DO;

  20570   1                              BLANK_FILL_ON_T*null
      988    20571
      989    20572    9                                  VARIABLE_TARGET$ = PINCRC ( GZ_FIELD$ -> QI$GZ_FIELD
             20572                                            .STATUS.DATA$,

  20572   1 000797  ECC7 0020            BLANK_FILL_ON_T*LDB,B6   GZ_FIELD$,AUTO
          1 000799  B846 0006                            LDR,R3   6,B6
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:127  
          1 00079B  304F                                 SOR,R3   15
          1 00079C  DCC6 0009                            LDB,B5   9,B6
          1 00079E  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 0007A0  8CC7 013E                            LDI      QCI@IO_READ+11,AUTO
          1 0007A2  7031                                 DCL,R7   1
          1 0007A3  8D47 0140                            SDI      QCI@IO_READ+13,AUTO
          1 0007A5  F853                                 LDR,R7   R3
          1 0007A6  6C00                                 LDV,R6   0
          1 0007A7  8447 0140                            AID      QCI@IO_READ+13,AUTO
          1 0007A9  7071                                 DCR,R7   1
          1 0007AA  8D47 0039                            SDI      VARIABLE_TARGET$,AUTO

      990    20573    9                                     GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET );
      991    20574    9                                   QI_1.OP.LEN.T = TARGET_INDEX;

  20574   1 0007AC  D847 0031                            LDR,R5   TARGET_INDEX,AUTO
          1 0007AE  DF00 0000 0027  xsym                 STR,R5   QI_1+39

      992    20575
      993    20576    9                                   VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT

  20576   1 0007B1  B856                                 LDR,R3   R6
          1 0007B2  E570 7FFF                            AND,R6   32767,IMO
          1 0007B4  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 0007B6  DCC7 013E                            LDB,B5   QCI@IO_READ+11,AUTO
          1 0007B8  304F                                 SOR,R3   15
          1 0007B9  BF47 0140                            STR,R3   QCI@IO_READ+13,AUTO
          1 0007BB  DFC7 0141                            STB,B5   QCI@IO_READ+14,AUTO
          1 0007BD  AB80 0000 0000  02                   LAB,B2   0
          1 0007C0  2C14                                 LDV,R2   20
          1 0007C1  6C01                                 LDV,R6   1
          1 0007C2  BB85                                 LAB,B3   ,B5
          1 0007C3  F855                                 LDR,R7   R5
          1 0007C4  D380 0000 0000  xent                 LNJ,B5   X6C_ALR

      994    20577    9                                     = ' ';
      995    20578
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:128  
      996    20579    9                                 END BLANK_FILL_ON_THE_LEFT;

      997    20580
      998    20581    8                             END JUSTIFY_RIGHT_IT;

      999    20582
     1000    20583    7                           CALL REPLACE_FIELD_DATA;

  20583   1 0007C7  E3C0 0277                            LNJ,B6   s:0,PREL
          1 0007C9       0001                            DC       s:20585,PREL

     1001    20584
     1002    20585    7                         END NO_PICTURE_STRING_STUFF;

  20585   1 0007CA  0F81 000A                            B        s:20593,PREL

     1003    20586
     1004    20587        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:129  
     1005    20588    6                     CASE ( ELSE );

     1006    20589    6                       CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_COMPILER_ERROR );

  20589   1 0007CC  BB80 0000 0008  02                   LAB,B3   +8
          1 0007CF  CBF0 0100                            LAB,B4   256,IMO
          1 0007D1  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 0007D4       0001                            DC       s:20593,PREL

     1007    20590
     1008    20591    6                   END; /* do case dad_type */

     1009    20592
     1010    20593    5                   GZ_FIELD$ -> QI$GZ_FIELD.INDICATORS$ -> QI$INDICATORS.STATE_VALUE =
             20593                            %QI#STATE_AVAIL_VERIFY;

  20593   1 0007D5  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 0007D7  DC86                                 LDB,B5   ,B6
          1 0007D8  E870 1000                            LDR,R6   4096,IMO
          1 0007DA  EA85                                 SRM,R6,'1800'X    ,B5
          1 0007DB       1800

     1011    20594    5                   GZ_FIELD$ -> QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE = %YES;

  20594   1 0007DC  8946 0006                            LBT,'1000'X       6,B6
  20594   1 0007DE       1000

     1012    20595
     1013    20596    5                 END THAT_SUCKER_IS_DONE;

     1014    20597
     1015    20598    4   NEXT_FIELD_PLEASE:
     1016    20599    4               GZ_FIELD$ = PINCRW ( GZ_FIELD$, SIZEW (QI$GZ_FIELD) );

  20599   1 0007DF  ECC7 0020            NEXT_FIELD_PLEA*LDB,B6   GZ_FIELD$,AUTO
          1 0007E1  DBC6 000C                            LAB,B5   12,B6
          1 0007E3  DFC7 0020                            STB,B5   GZ_FIELD$,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:130  

     1017    20600
     1018    20601    4             END POST_EDIT_THEM_FIELDS;

  20601   1 0007E5  8AC7 0019                            INC      FIELD_INDEX,AUTO
          1 0007E7  E847 0019                            LDR,R6   FIELD_INDEX,AUTO
          1 0007E9  E947 0137                            CMR,R6   QCI@IO_READ+4,AUTO
          1 0007EB  0381 F8A6                            BLE      s:19688,PREL

     1019    20602
     1020    20603    3           END FRAME_IS_ACTIVE;

     1021    20604
     1022    20605    2       END CHECK_THEM_FRAMES;

  20605   1 0007ED  8AC7 001D                            INC      FRAME_INDEX,AUTO
          1 0007EF  E847 001D                            LDR,R6   FRAME_INDEX,AUTO
          1 0007F1  E947 0134                            CMR,R6   QCI@IO_READ+1,AUTO
          1 0007F3  0381 F83D                            BLE      s:19594,PREL

     1023    20606
     1024    20607    1       RETURN;

  20607   1 0007F5  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1025    20608
     1026    20609        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:131  
     1027    20610    1   ENTRY_REQUIRED:
     1028    20611    1       ERROR_CODE = %E$ENTRY_REQUIRED;

  20611   1 0007F8  6C6D                 ENTRY_REQUIRED  LDV,R6   109
          1 0007F9  EF47 0012                            STR,R6   ERROR_CODE,AUTO

     1029    20612    1       U1$ = ADDR (NIL);

  20612   1 0007FB  EB80 0000 0000                       LAB,B6   0
          1 0007FE  EFC7 0035                            STB,B6   U1$,AUTO

     1030    20613    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_ENTRY_REQUIRED );

  20613   1 000800  DB80 0000 00CE  00                   LAB,B5   OOPS_ENTRY_REQUIRED
          1 000803  DFC7 012D                            STB,B5   QCG@GET_FIELD+4,AUTO

     1031    20614    1       GOTO GET_FIELD_AGAIN_NO_DEFAULT;

  20614   1 000805  0F81 01E5                            B        s:20816,PREL

     1032    20615
     1033    20616    1   ILLEGAL_INPUT_IN_DE:
     1034    20617    1       ERROR_CODE = %E$ILLEGAL_INPUT;

  20617   1 000807  6C6C                 ILLEGAL_INPUT_I*LDV,R6   108
          1 000808  EF47 0012                            STR,R6   ERROR_CODE,AUTO

     1035    20618    1       U1$ = ADDR (NIL);

  20618   1 00080A  EB80 0000 0000                       LAB,B6   0
          1 00080D  EFC7 0035                            STB,B6   U1$,AUTO

     1036    20619    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_ILLEGAL_INPUT );

  20619   1 00080F  DB80 0000 00AA  00                   LAB,B5   OOPS_ILLEGAL_INPUT
          1 000812  DFC7 012D                            STB,B5   QCG@GET_FIELD+4,AUTO

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:132  
     1037    20620    1       GOTO GET_THAT_FIELD_AGAIN;

  20620   1 000814  0F81 01B5                            B        s:20770,PREL

     1038    20621
     1039    20622    1   EMBEDDED_BLANKS_IN_DISPLAY:
     1040    20623    1       ERROR_CODE = %E$EMBEDDED_BLANKS;

  20623   1 000816  6C65                 EMBEDDED_BLANKS*LDV,R6   101
          1 000817  EF47 0012                            STR,R6   ERROR_CODE,AUTO

     1041    20624    1       U1$ = ADDR (NIL);

  20624   1 000819  EB80 0000 0000                       LAB,B6   0
          1 00081C  EFC7 0035                            STB,B6   U1$,AUTO

     1042    20625    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_EMBEDDED_BLANKS );

  20625   1 00081E  DB80 0000 0000  00                   LAB,B5   OOPS_EMBEDDED_BLANKS
          1 000821  DFC7 012D                            STB,B5   QCG@GET_FIELD+4,AUTO

     1043    20626    1       GOTO GET_THAT_FIELD_AGAIN;

  20626   1 000823  0F81 01A6                            B        s:20770,PREL

     1044    20627
     1045    20628    1   SIGN_ONLY_IN_DISPLAY:
     1046    20629    1       ERROR_CODE = %E$SIGN_ONLY;

  20629   1 000825  5C66                 SIGN_ONLY_IN_DI*LDV,R5   102
          1 000826  DF47 0012                            STR,R5   ERROR_CODE,AUTO

     1047    20630    1       U1$ = ADDR (NIL);

  20630   1 000828  CB80 0000 0000                       LAB,B4   0
          1 00082B  CFC7 0035                            STB,B4   U1$,AUTO

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:133  
     1048    20631    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_SIGN_ONLY );

  20631   1 00082D  BB80 0000 0024  00                   LAB,B3   OOPS_SIGN_ONLY
          1 000830  BFC7 012D                            STB,B3   QCG@GET_FIELD+4,AUTO

     1049    20632    1       GOTO GET_THAT_FIELD_AGAIN;

  20632   1 000832  0F81 0197                            B        s:20770,PREL

     1050    20633
     1051    20634    1   MINIMUM_SIZE_ERROR:
     1052    20635    1       OTTER_ERROR_MESSAGE = OOPS_MINIMUM_SIZE;

  20635   1 000834  EB80 0000 0000  00   MINIMUM_SIZE_ER*LAB,B6   OOPS_EMBEDDED_BLANKS
          1 000837  4C20                                 LDV,R4   32
          1 000838  D870 2050                            LDR,R5   8272,IMO
          1 00083A  0021                                 ALR      ;
          1 00083B       4006 0064                                ALPHANUM(100,B6,,R4),;
          1 00083D       4007 00EE                                ALPHANUM(OTTER_ERROR_MESSAGE,AUTO,,R5,FILL)

     1053    20636
     1054    20637    1       CALL BINCHAR ( MINIMUM_SIZE_TEXT, MINIMUM_SIZE );

  20637   1 00083F  F847 0026                            LDR,R7   MINIMUM_SIZE,AUTO
          1 000841  6C00                                 LDV,R6   0
          1 000842  437F                                 CSYNC    s:20637+2,SPREL
          1 000843  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 000845  0027                                 CBD      ;
          1 000846       0407 013E                                BINARY(QCI@IO_READ+11,AUTO,,4),;
          1 000848       0307 0027                               UNPACKED(MINIMUM_SIZE_TEXT,AUTO,,3,UNSIGNED)

     1055    20638
     1056    20639    1       IF MINIMUM_SIZE <= 9

  20639   1 00084A  B847 0026                            LDR,R3   MINIMUM_SIZE,AUTO
          1 00084C  3D09                                 CMV,R3   9
          1 00084D  437F                                 CSYNC    s:20639+2,SPREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:134  
          1 00084E  0301 0007                            BG       s:20643,PREL

     1057    20640    1       THEN
     1058    20641    1         QI_1.OP.LEN.T = 1;

  20641   1 000850  2C01                                 LDV,R2   1
          1 000851  AF00 0000 0027  xsym                 STR,R2   QI_1+39
          1 000854  0F81 000E                            B        s:20649,PREL

     1059    20642    1       ELSE
     1060    20643    1         IF MINIMUM_SIZE <= 99

  20643   1 000856  3D63                                 CMV,R3   99
          1 000857  0301 0007                            BG       s:20647,PREL

     1061    20644    1         THEN
     1062    20645    1           QI_1.OP.LEN.T = 2;

  20645   1 000859  2C02                                 LDV,R2   2
          1 00085A  AF00 0000 0027  xsym                 STR,R2   QI_1+39
          1 00085D  0F81 0005                            B        s:20649,PREL

     1063    20646    1         ELSE
     1064    20647    1           QI_1.OP.LEN.T = 3;

  20647   1 00085F  2C03                                 LDV,R2   3
          1 000860  AF00 0000 0027  xsym                 STR,R2   QI_1+39

     1065    20648
     1066    20649    1       SUBSTR ( OTTER_ERROR_MESSAGE,

  20649   1 000863  8252                                 NEG      R2
          1 000864  C800 0000 0027  xsym                 LDR,R4   QI_1+39
          1 000867  D870 2030                            LDR,R5   8240,IMO
          1 000869  0021                                 ALR      ;
          1 00086A       C027 0028                               ALPHANUM(MINIMUM_SIZE_TEXT+1,AUTO,R2,1,R4),;
          1 00086C       4007 00FE                             ALPHANUM(OTTER_ERROR_MESSAGE+16,AUTO,,R5,FILL)
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:135  

     1067    20650    1         LENGTHC ( OOPS_MINIMUM_SIZE ) ) =
     1068    20651    1         SUBSTR ( MINIMUM_SIZE_TEXT,
     1069    20652    1         3 - QI_1.OP.LEN.T );
     1070    20653
     1071    20654    1       SUBSTR ( OTTER_ERROR_MESSAGE,

  20654   1 00086E  6C2E                                 LDV,R6   46
          1 00086F  EBC7 00FE                            LAB,B6   OTTER_ERROR_MESSAGE+16,AUTO
          1 000871  9854                                 LDR,R1   R4
          1 000872  437F                                 CSYNC    s:20654+3,SPREL
          1 000873  E796                                 STH,R6   ,B6,R1

     1072    20655    1         LENGTHC ( OOPS_MINIMUM_SIZE ) + QI_1.OP.LEN.T,
     1073    20656    1         1 ) = '.';
     1074    20657
     1075    20658    1       ERROR_CODE = %E$MINIMUM_SIZE;

  20658   1 000874  2C69                                 LDV,R2   105
          1 000875  AF47 0012                            STR,R2   ERROR_CODE,AUTO

     1076    20659    1       U1.LENGTH = QI_1.OP.LEN.T;

  20659   1 000877  E800 0000 0027  xsym                 LDR,R6   QI_1+39
          1 00087A  E7C7 0033                            STH,R6   U1,AUTO

     1077    20660    1       U1.TEXT = SUBSTR ( MINIMUM_SIZE_TEXT,

  20660   1 00087C  B856                                 LDR,R3   R6
          1 00087D  8253                                 NEG      R3
          1 00087E  C856                                 LDR,R4   R6
          1 00087F  0021                                 ALR      ;
          1 000880       C037 0028                               ALPHANUM(MINIMUM_SIZE_TEXT+1,AUTO,R3,1,R4),;
          1 000882       C307 0033                                ALPHANUM(U1,AUTO,1,3,FILL)

     1078    20661    1         3 - QI_1.OP.LEN.T );
     1079    20662    1       U1$ = ADDR ( U1 );
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:136  

  20662   1 000884  EBC7 0033                            LAB,B6   U1,AUTO
          1 000886  437F                                 CSYNC    s:20662+1,SPREL
          1 000887  EFC7 0035                            STB,B6   U1$,AUTO

     1080    20663    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );

  20663   1 000889  DBC7 00EE                            LAB,B5   OTTER_ERROR_MESSAGE,AUTO
          1 00088B  DFC7 012D                            STB,B5   QCG@GET_FIELD+4,AUTO

     1081    20664    1       GOTO GET_THAT_FIELD_AGAIN;

  20664   1 00088D  0F81 013C                            B        s:20770,PREL

     1082    20665
     1083    20666    1   OVERFLOW:
     1084    20667    1       OTTER_ERROR_MESSAGE = OOPS_MAXIMUM_SIZE;

  20667   1 00088F  EB80 0000 0000  00   OVERFLOW        LAB,B6   OOPS_EMBEDDED_BLANKS
          1 000892  D870 2050                            LDR,R5   8272,IMO
          1 000894  0021                                 ALR      ;
          1 000895       5E06 0074                                ALPHANUM(116,B6,,30),;
          1 000897       4007 00EE                                ALPHANUM(OTTER_ERROR_MESSAGE,AUTO,,R5,FILL)

     1085    20668
     1086    20669    1       MAXIMUM_SIZE = QI_1.OP.LEN.S - 1;

  20669   1 000899  E800 0000 0026  xsym                 LDR,R6   QI_1+38
          1 00089C  6EFF                                 ADV,R6   -1
          1 00089D  EF47 0024                            STR,R6   MAXIMUM_SIZE,AUTO

     1087    20670    1       CALL BINCHAR ( MAXIMUM_SIZE_TEXT, MAXIMUM_SIZE );

  20670   1 00089F  F856                                 LDR,R7   R6
          1 0008A0  6C00                                 LDV,R6   0
          1 0008A1  437F                                 CSYNC    s:20670+1,SPREL
          1 0008A2  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:137  
          1 0008A4  0027                                 CBD      ;
          1 0008A5       0407 013E                                BINARY(QCI@IO_READ+11,AUTO,,4),;
          1 0008A7       0207 0025                               UNPACKED(MAXIMUM_SIZE_TEXT,AUTO,,2,UNSIGNED)

     1088    20671
     1089    20672    1       IF MAXIMUM_SIZE <= 9

  20672   1 0008A9  C847 0024                            LDR,R4   MAXIMUM_SIZE,AUTO
          1 0008AB  4D09                                 CMV,R4   9
          1 0008AC  437F                                 CSYNC    s:20672+2,SPREL
          1 0008AD  0301 0007                            BG       s:20676,PREL

     1090    20673    1       THEN
     1091    20674    1         QI_1.OP.LEN.T = 1;

  20674   1 0008AF  3C01                                 LDV,R3   1
          1 0008B0  BF00 0000 0027  xsym                 STR,R3   QI_1+39
          1 0008B3  0F81 0005                            B        s:20678,PREL

     1092    20675    1       ELSE
     1093    20676    1         QI_1.OP.LEN.T = 2;

  20676   1 0008B5  3C02                                 LDV,R3   2
          1 0008B6  BF00 0000 0027  xsym                 STR,R3   QI_1+39

     1094    20677
     1095    20678    1       SUBSTR ( OTTER_ERROR_MESSAGE,

  20678   1 0008B9  8253                                 NEG      R3
          1 0008BA  C800 0000 0027  xsym                 LDR,R4   QI_1+39
          1 0008BD  D870 2032                            LDR,R5   8242,IMO
          1 0008BF  0021                                 ALR      ;
          1 0008C0       4037 0026                                ALPHANUM(MINIMUM_SIZE,AUTO,R3,,R4),;
          1 0008C2       4007 00FD                             ALPHANUM(OTTER_ERROR_MESSAGE+15,AUTO,,R5,FILL)

     1096    20679    1         LENGTHC ( OOPS_MAXIMUM_SIZE ) ) =
     1097    20680    1         SUBSTR ( MAXIMUM_SIZE_TEXT,
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:138  
     1098    20681    1         2 - QI_1.OP.LEN.T );
     1099    20682
     1100    20683    2       DO CASE ( FIELD_DAD$ -> QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.SIGN );

  20683   1 0008C4  ECC7 0013                            LDB,B6   FIELD_DAD$,AUTO
          1 0008C6  437F                                 CSYNC    s:20683+1,SPREL
          1 0008C7  A846 0001                            LDR,R2   1,B6
          1 0008C9  204D                                 SOR,R2   13
          1 0008CA  A570 0003                            AND,R2   3,IMO
          1 0008CC  2D04                                 CMV,R2   4
          1 0008CD  0281 0030                            BGE      s:20704,PREL
          1 0008CF  9820 0000 08D5  01                   LDR,R1   s:20683+17,R2
          1 0008D2  8390 0000 08D9  01                   JMP      s:20686,R1
          1 0008D5       0000                            DC       s:20686,PREL
          1 0008D6       0025                            DC       s:20704,PREL
          1 0008D7       000B                            DC       s:20689,PREL
          1 0008D8       0019                            DC       s:20696,PREL

     1101    20684
     1102    20685    2         CASE ( %QI#CD_UNSIGNED );

     1103    20686    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  20686   1 0008D9  BB80 0000 0001  02                   LAB,B3   +1
          1 0008DC  CBF0 0100                            LAB,B4   256,IMO
          1 0008DE  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 0008E1       0001                            DC       s:20686+9,PREL
          1 0008E2  0F81 001B                            B        s:20704,PREL

     1104    20687
     1105    20688    2         CASE ( %QI#CD_SIGN_LEADING_SEPARATE );

     1106    20689    2           SUBSTR ( OTTER_ERROR_MESSAGE,

  20689   1 0008E4  AB80 0000 0083  00                   LAB,B2   OOPS_WITH_LEADING_SIGN
          1 0008E7  2C00                                 LDV,R2   0
          1 0008E8  6C26                                 LDV,R6   38
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:139  
          1 0008E9  BBC7 00FD                            LAB,B3   OTTER_ERROR_MESSAGE+15,AUTO
          1 0008EB  B854                                 LDR,R3   R4
          1 0008EC  0008                                 MMM

     1107    20690    2             LENGTHC ( OOPS_MAXIMUM_SIZE ) + QI_1.OP.LEN.T,
     1108    20691    2             LENGTHC ( OOPS_WITH_LEADING_SIGN ) ) = OOPS_WITH_LEADING_SIGN;
     1109    20692
     1110    20693    2           ERROR_CODE = %E$MAXIMUM_SIZE_LEADING_SIGN;

  20693   1 0008ED  6C6A                                 LDV,R6   106
          1 0008EE  EF47 0012                            STR,R6   ERROR_CODE,AUTO
          1 0008F0  0F81 000D                            B        s:20704,PREL

     1111    20694
     1112    20695    2         CASE ( %QI#CD_SIGN_TRAILING_SEPARATE );

     1113    20696    2           SUBSTR ( OTTER_ERROR_MESSAGE,

  20696   1 0008F2  AB80 0000 0096  00                   LAB,B2   OOPS_WITH_TRAILING_SIGN
          1 0008F5  2C00                                 LDV,R2   0
          1 0008F6  6C27                                 LDV,R6   39
          1 0008F7  BBC7 00FD                            LAB,B3   OTTER_ERROR_MESSAGE+15,AUTO
          1 0008F9  B854                                 LDR,R3   R4
          1 0008FA  0008                                 MMM

     1114    20697    2             LENGTHC ( OOPS_MAXIMUM_SIZE ) + QI_1.OP.LEN.T,
     1115    20698    2             LENGTHC ( OOPS_WITH_TRAILING_SIGN ) ) = OOPS_WITH_TRAILING_SIGN;
     1116    20699
     1117    20700    2           ERROR_CODE = %E$MAXIMUM_SIZE_TRAILING_SIGN;

  20700   1 0008FB  6C6B                                 LDV,R6   107
          1 0008FC  EF47 0012                            STR,R6   ERROR_CODE,AUTO

     1118    20701
     1119    20702    2       END;

     1120    20703
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:140  
     1121    20704    1       U1.LENGTH = QI_1.OP.LEN.T;

  20704   1 0008FE  E800 0000 0027  xsym                 LDR,R6   QI_1+39
          1 000901  E7C7 0033                            STH,R6   U1,AUTO

     1122    20705    1       U1.TEXT = SUBSTR ( MAXIMUM_SIZE_TEXT,

  20705   1 000903  B856                                 LDR,R3   R6
          1 000904  8253                                 NEG      R3
          1 000905  C856                                 LDR,R4   R6
          1 000906  0021                                 ALR      ;
          1 000907       4037 0026                                ALPHANUM(MINIMUM_SIZE,AUTO,R3,,R4),;
          1 000909       C307 0033                                ALPHANUM(U1,AUTO,1,3,FILL)

     1123    20706    1         2 - QI_1.OP.LEN.T );
     1124    20707    1       U1$ = ADDR ( U1 );

  20707   1 00090B  EBC7 0033                            LAB,B6   U1,AUTO
          1 00090D  437F                                 CSYNC    s:20707+1,SPREL
          1 00090E  EFC7 0035                            STB,B6   U1$,AUTO

     1125    20708    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );

  20708   1 000910  DBC7 00EE                            LAB,B5   OTTER_ERROR_MESSAGE,AUTO
          1 000912  DFC7 012D                            STB,B5   QCG@GET_FIELD+4,AUTO

     1126    20709    1       GOTO GET_THAT_FIELD_AGAIN;

  20709   1 000914  0F81 00B5                            B        s:20770,PREL

  20708   1                              NON_NUMERICAL_D*null
     1127    20710
     1128    20711    1   NON_NUMERICAL_DISPLAY: ;
     1129    20712    1   CLASS_VIOLATION_IN_DISPLAY:
     1130    20713    1       ERROR_CODE = %E$NON_NUMERICAL;

  20713   1 000916  5C67                 CLASS_VIOLATION*LDV,R5   103
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:141  
          1 000917  DF47 0012                            STR,R5   ERROR_CODE,AUTO

     1131    20714    1       OTTER_ERROR_MESSAGE = OOPS_NON_NUMERICAL;

  20714   1 000919  EB80 0000 0000  00                   LAB,B6   OOPS_EMBEDDED_BLANKS
          1 00091C  4C20                                 LDV,R4   32
          1 00091D  D870 2050                            LDR,R5   8272,IMO
          1 00091F  0021                                 ALR      ;
          1 000920       4006 0048                                ALPHANUM(72,B6,,R4),;
          1 000922       4007 00EE                                ALPHANUM(OTTER_ERROR_MESSAGE,AUTO,,R5,FILL)

     1132    20715
     1133    20716    1       STARTING_INDEX = LENGTHC ( OOPS_NON_NUMERICAL ) - 3;

  20716   1 000924  3C1D                                 LDV,R3   29
          1 000925  BF47 0030                            STR,R3   STARTING_INDEX,AUTO

     1134    20717
     1135    20718    1       GOTO SO_VIOLATE_IT_ALREADY;

  20718   1 000927  437F                                 CSYNC    s:20716+2,SPREL
          1 000928  0F81 0011                            B        s:20728,PREL

  20716   1                              CLASS_VIOLATION*null
     1136    20719
     1137    20720    1   CLASS_VIOLATION_IN_AE: ;
     1138    20721    1   CLASS_VIOLATION_IN_ALPHA:
     1139    20722    1       ERROR_CODE = %E$ILLEGAL_CHARACTER;

  20722   1 00092A  5C68                 CLASS_VIOLATION*LDV,R5   104
          1 00092B  DF47 0012                            STR,R5   ERROR_CODE,AUTO

     1140    20723    1       OTTER_ERROR_MESSAGE = OOPS_ILLEGAL_CHARACTER;

  20723   1 00092D  EB80 0000 0000  00                   LAB,B6   OOPS_EMBEDDED_BLANKS
          1 000930  D870 2050                            LDR,R5   8272,IMO
          1 000932  0021                                 ALR      ;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:142  
          1 000933       5806 0058                                ALPHANUM(88,B6,,24),;
          1 000935       4007 00EE                                ALPHANUM(OTTER_ERROR_MESSAGE,AUTO,,R5,FILL)

     1141    20724
     1142    20725    1       STARTING_INDEX = LENGTHC ( OOPS_ILLEGAL_CHARACTER ) - 3;

  20725   1 000937  4C15                                 LDV,R4   21
          1 000938  CF47 0030                            STR,R4   STARTING_INDEX,AUTO

     1143    20726
     1144    20727    1   SO_VIOLATE_IT_ALREADY:
     1145    20728    1       QI@SRCH_VRFY = QI_SRCH_VRFY;

  20728   1 00093A  AB80 0000 0000  xsym SO_VIOLATE_IT_A*LAB,B2   QI_SRCH_VRFY
          1 00093D  2C00                                 LDV,R2   0
          1 00093E  6C30                                 LDV,R6   48
          1 00093F  BBC7 0056                            LAB,B3   QI@SRCH_VRFY,AUTO
          1 000941  3C00                                 LDV,R3   0
          1 000942  437F                                 CSYNC    s:20728+7,SPREL
          1 000943  0008                                 MMM

     1146    20729    1       QI@SRCH_VRFY.DATA.S$ = ADDR ( QI_MAT_NONMATCH );

  20729   1 000944  EB80 0000 0000  xsym                 LAB,B6   QI_MAT_NONMATCH
          1 000947  EFC7 005C                            STB,B6   QI@SRCH_VRFY+6,AUTO

     1147    20730    1       QI@SRCH_VRFY.DATA.T$ = ADDR ( QI@SRCH_VRFY.SRCH_RESULT );

  20730   1 000949  DBC7 006A                            LAB,B5   QI@SRCH_VRFY+20,AUTO
          1 00094B  DFC7 005E                            STB,B5   QI@SRCH_VRFY+8,AUTO

     1148    20731    1       QI@SRCH_VRFY.DATA.AUX$ = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$;

  20731   1 00094D  CCC7 0020                            LDB,B4   GZ_FIELD$,AUTO
          1 00094F  BCC4 0009                            LDB,B3   9,B4
          1 000951  BFC7 0060                            STB,B3   QI@SRCH_VRFY+10,AUTO

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:143  
     1149    20732    1       QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;

  20732   1 000953  E844 0006                            LDR,R6   6,B4
          1 000955  E570 00FF                            AND,R6   255,IMO
          1 000957  EF47 0069                            STR,R6   QI@SRCH_VRFY+19,AUTO

     1150    20733    1       QI@SRCH_VRFY.INX.AUX = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET;

  20733   1 000959  C844 0006                            LDR,R4   6,B4
          1 00095B  404F                                 SOR,R4   15
          1 00095C  CF47 0067                            STR,R4   QI@SRCH_VRFY+17,AUTO

     1151    20734
     1152    20735    1       CALL QCC$SRCH ( QI@SRCH_VRFY )

  20735   1 00095E  ABC7 0056                            LAB,B2   QI@SRCH_VRFY,AUTO
          1 000960  AFC7 013E                            STB,B2   QCI@IO_READ+11,AUTO
          1 000962  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000964  CBF0 0100                            LAB,B4   256,IMO
          1 000966  E380 0000 0000  xent                 LNJ,B6   QCC$SRCH
          1 000969       0003                            DC       s:20738,PREL
          1 00096A  0F81 000A                            B        s:20741,PREL

     1153    20736    1       WHENALTRETURN
     1154    20737    2         DO;

     1155    20738    2           CALL QCE$ERROR_INTERNAL ( %E$INTERNAL_INTERPRETER_ERROR );

  20738   1 00096C  BB80 0000 0001  02                   LAB,B3   +1
          1 00096F  CBF0 0100                            LAB,B4   256,IMO
          1 000971  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_INTERNAL
          1 000974       0001                            DC       s:20741,PREL

     1156    20739    2         END;

     1157    20740
     1158    20741    1       SUBSTR ( OTTER_ERROR_MESSAGE,
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:144  

  20741   1 000975  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 000978  B847 006B                            LDR,R3   QI@SRCH_VRFY+21,AUTO
          1 00097A  E0B6                                 LDH,R6   ,B6,R3
          1 00097B  DBC7 00EE                            LAB,B5   OTTER_ERROR_MESSAGE,AUTO
          1 00097D  A847 0030                            LDR,R2   STARTING_INDEX,AUTO
          1 00097F  E7A5                                 STH,R6   ,B5,R2

     1159    20742    1         STARTING_INDEX,
     1160    20743    1         1 ) = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.SRCH_RESULT.DISP );
     1161    20744
     1162    20745    1       U1.LENGTH = 1;

  20745   1 000980  6C01                                 LDV,R6   1
          1 000981  E7C7 0033                            STH,R6   U1,AUTO

     1163    20746    1       U1.TEXT = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.SRCH_RESULT.DISP );

  20746   1 000983  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 000986  B847 006B                            LDR,R3   QI@SRCH_VRFY+21,AUTO
          1 000988  0021                                 ALR      ;
          1 000989       4136 0000                                ALPHANUM(0,B6,R3,,1),;
          1 00098B       C307 0033                                ALPHANUM(U1,AUTO,1,3,FILL)

     1164    20747    1       U1$ = ADDR ( U1 );

  20747   1 00098D  DBC7 0033                            LAB,B5   U1,AUTO
          1 00098F  437F                                 CSYNC    s:20747+1,SPREL
          1 000990  DFC7 0035                            STB,B5   U1$,AUTO

     1165    20748    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );

  20748   1 000992  CBC7 00EE                            LAB,B4   OTTER_ERROR_MESSAGE,AUTO
          1 000994  CFC7 012D                            STB,B4   QCG@GET_FIELD+4,AUTO

     1166    20749    1       GOTO GET_THAT_FIELD_AGAIN;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:145  
  20749   1 000996  0F81 0033                            B        s:20770,PREL

     1167    20750
     1168    20751    1   ILLEGAL_CHARACTER_IN_AE:
     1169    20752    1       ERROR_CODE = %E$ILLEGAL_CHARACTER;

  20752   1 000998  6C68                 ILLEGAL_CHARACT*LDV,R6   104
          1 000999  EF47 0012                            STR,R6   ERROR_CODE,AUTO

     1170    20753    1       OTTER_ERROR_MESSAGE = OOPS_ILLEGAL_CHARACTER;

  20753   1 00099B  EB80 0000 0000  00                   LAB,B6   OOPS_EMBEDDED_BLANKS
          1 00099E  D870 2050                            LDR,R5   8272,IMO
          1 0009A0  0021                                 ALR      ;
          1 0009A1       5806 0058                                ALPHANUM(88,B6,,24),;
          1 0009A3       4007 00EE                                ALPHANUM(OTTER_ERROR_MESSAGE,AUTO,,R5,FILL)

     1171    20754
     1172    20755    1       SUBSTR ( OTTER_ERROR_MESSAGE,

  20755   1 0009A5  EC80 0000 0046  xsym                 LDB,B6   QI_1+70
          1 0009A8  B847 006A                            LDR,R3   QI@SRCH_VRFY+20,AUTO
          1 0009AA  437F                                 CSYNC    s:20755+4,SPREL
          1 0009AB  C0B6                                 LDH,R4   ,B6,R3
          1 0009AC  CAC7 00F8                            SRM,R4,'00FF'X    OTTER_ERROR_MESSAGE+10,AUTO
          1 0009AE       00FF

     1173    20756    1         LENGTHC ( OOPS_ILLEGAL_CHARACTER ) - 3,
     1174    20757    1         1 ) = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.VRFY_RESULT.DISP );
     1175    20758
     1176    20759    1       U1.LENGTH = 1;

  20759   1 0009AF  4C01                                 LDV,R4   1
          1 0009B0  C7C7 0033                            STH,R4   U1,AUTO

     1177    20760    1       U1.TEXT = QI_1.OTTER_SPACE.T$ -> QI$CHAR_A ( QI@SRCH_VRFY.VRFY_RESULT.DISP );

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:146  
  20760   1 0009B2  0021                                 ALR      ;
          1 0009B3       4136 0000                                ALPHANUM(0,B6,R3,,1),;
          1 0009B5       C307 0033                                ALPHANUM(U1,AUTO,1,3,FILL)

     1178    20761    1       U1$ = ADDR ( U1 );

  20761   1 0009B7  DBC7 0033                            LAB,B5   U1,AUTO
          1 0009B9  437F                                 CSYNC    s:20761+1,SPREL
          1 0009BA  DFC7 0035                            STB,B5   U1$,AUTO

     1179    20762    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );

  20762   1 0009BC  CBC7 00EE                            LAB,B4   OTTER_ERROR_MESSAGE,AUTO
          1 0009BE  CFC7 012D                            STB,B4   QCG@GET_FIELD+4,AUTO

     1180    20763    1       GOTO GET_THAT_FIELD_AGAIN;

  20763   1 0009C0  0F81 0009                            B        s:20770,PREL

     1181    20764
     1182    20765    1   FULLA_FILL:
     1183    20766    1       ERROR_CODE = %E$FULLA_FILL;

  20766   1 0009C2  5C6E                 FULLA_FILL      LDV,R5   110
          1 0009C3  DF47 0012                            STR,R5   ERROR_CODE,AUTO

     1184    20767    1       QCG@GET_FIELD.MESSAGE$ = ADDR ( OOPS_FULLA_FILL );

  20767   1 0009C5  DB80 0000 00F2  00                   LAB,B5   OOPS_FULLA_FILL
          1 0009C8  DFC7 012D                            STB,B5   QCG@GET_FIELD+4,AUTO

     1185    20768
     1186    20769    1   GET_THAT_FIELD_AGAIN:
     1187    20770    1       IF WE_GOTTA_DEFAULT_VALUE

  20770   1 0009CA  89C7 003B            GET_THAT_FIELD_*CMZ      WE_GOTTA_DEFAULT_VALUE,AUTO
          1 0009CC  0881 001E                            BAGE     s:20816,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:147  

     1188    20771    1       THEN
     1189    20772    1   ILLEGAL_DEFAULT_VALUE:
     1190    20773    2         DO;

  20773   1                              ILLEGAL_DEFAULT*null
     1191    20774                %PROC_ADDRESS ( THING@P =
             20774             "GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$ -> QI$FIELD_DAD.IDENTIFIER@P"
             20774                    ,
     1192    20775                CHECK_FOR_INDIRECTION = NO,
     1193    20776                RESULT$ = FIELD_IDENTIFIER$ );

  20794   1 0009CE  ECC7 0020            ILLEGAL_DEFAULT*LDB,B6   GZ_FIELD$,AUTO
          1 0009D0  DCC6 0004                            LDB,B5   4,B6
          1 0009D2  B845 0007                            LDR,R3   7,B5
          1 0009D4  F853                                 LDR,R7   R3
          1 0009D5  6C00                                 LDV,R6   0
          1 0009D6  8400 0000 0002  xsym                 AID      QI_1+2
          1 0009D9  8D47 0017                            SDI      FIELD_IDENTIFIER$,AUTO

     1194    20813
     1195    20814    2           CALL QCE$ERROR ( %E$POSTREAD_ILLEGAL_DEFAULT,

  20814   1 0009DB  CBF0 0008                            LAB,B4   8,IMO
          1 0009DD  BCC7 0017                            LDB,B3   FIELD_IDENTIFIER$,AUTO
          1 0009DF  BFC7 0140                            STB,B3   QCI@IO_READ+13,AUTO
          1 0009E1  CFC7 013E                            STB,B4   QCI@IO_READ+11,AUTO
          1 0009E3  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 0009E5  CBF0 0200                            LAB,B4   512,IMO
          1 0009E7  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR
          1 0009EA       0001                            DC       s:20816,PREL

     1196    20815    2             FIELD_IDENTIFIER$ -> QI$VARIABLE_IDENTIFIER );
     1197    20816    2         END ILLEGAL_DEFAULT_VALUE;

     1198    20817
     1199    20818    1   GET_FIELD_AGAIN_NO_DEFAULT:
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:148  
     1200    20819        /*N*
     1201    20820              MUCH ADO ABOUT ERROR MESSAGES
     1202    20821              When do we get the message from the host?
     1203    20822              Do we "cache" messages?  (Where?)
     1204    20823              Do we penalize non-English errors by going to the host each time?
     1205    20824
     1206    20825              For now, just to beat on the M$ERRMSG mcal a little,
     1207    20826              we go to the host every time, regardless of the language.
     1208    20827        */
     1209    20828    1       IF G$JIT$ -> G$JIT.LANG = G$JIT$ -> G$JIT.LANG

  20828   1 0009EB  EC80 0000 0000  xsym GET_FIELD_AGAIN*LDB,B6   G$JIT$
          1 0009EE  E846 0099                            LDR,R6   153,B6
          1 0009F0  6008                                 SOL,R6   8
          1 0009F1  6068                                 SAR,R6   8
          1 0009F2  E1D6                                 CMH,R6   R6
          1 0009F3  0981 0023                            BNE      s:20847,PREL

     1210    20829    1       THEN
     1211    20830    1   GET_THE_ERRMSG_FROM_THE_HOST:
     1212    20831    2         DO;

  20831   1                              GET_THE_ERRMSG_*null
     1213    20832    2           CALL QCE$ERROR_MESSAGE ( ERROR_CODE,

  20832   1 0009F5  DBC7 00EE            GET_THE_ERRMSG_*LAB,B5   OTTER_ERROR_MESSAGE,AUTO
          1 0009F7  DFC7 0146                            STB,B5   QCI@IO_READ+19,AUTO
          1 0009F9  CB80 0000 0000                       LAB,B4   0
          1 0009FC  CFC7 0144                            STB,B4   QCI@IO_READ+17,AUTO
          1 0009FE  BB80 0000 0000                       LAB,B3   0
          1 000A01  BFC7 0142                            STB,B3   QCI@IO_READ+15,AUTO
          1 000A03  ACC7 0035                            LDB,B2   U1$,AUTO
          1 000A05  AFC7 0140                            STB,B2   QCI@IO_READ+13,AUTO
          1 000A07  9BC7 0012                            LAB,B1   ERROR_CODE,AUTO
          1 000A09  9FC7 013E                            STB,B1   QCI@IO_READ+11,AUTO
          1 000A0B  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000A0D  CBF0 0500                            LAB,B4   1280,IMO
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:149  
          1 000A0F  E380 0000 0000  xent                 LNJ,B6   QCE$ERROR_MESSAGE
          1 000A12       0001                            DC       s:20838,PREL

     1214    20833    2             U$1,
     1215    20834    2             /* no U2 */,
     1216    20835    2             /* no U3 */,
     1217    20836    2             OTTER_ERROR_MESSAGE );
     1218    20837
     1219    20838    2           QCG@GET_FIELD.MESSAGE$ = ADDR ( OTTER_ERROR_MESSAGE );

  20838   1 000A13  EBC7 00EE                            LAB,B6   OTTER_ERROR_MESSAGE,AUTO
          1 000A15  EFC7 012D                            STB,B6   QCG@GET_FIELD+4,AUTO

     1220    20839    2         END GET_THE_ERRMSG_FROM_THE_HOST;

     1221    20840
     1222    20841        /*N*
     1223    20842              OK, so let's say someone decides to honor the MESSAGE LINE
     1224    20843              clause.  Then we'll pull out something like
     1225    20844              "QI_1.CURRENT.FORM_STATUS$ -> QI$FORM_STATUS.MESSAGE_LINE.GZ.HEADER$"
     1226    20845              to use for the GZ_HEADER$ to the MESSAGE LINE.
     1227    20846        */
     1228    20847    1       QCG@GET_FIELD.MESSAGE_LINE_GZ_HEADER$ = QI_1.MESSAGE_LINE_GZ.HEADER$;

  20847   1 000A17  EC80 0000 0064  xsym                 LDB,B6   QI_1+100
          1 000A1A  EFC7 0129                            STB,B6   QCG@GET_FIELD,AUTO

     1229    20848    1       QCG@GET_FIELD.IS_MESSAGE_A_DAD = %NO;

  20848   1 000A1C  8747 012B                            CL       QCG@GET_FIELD+2,AUTO

     1230    20849    1       QCG@GET_FIELD.FRAME_INDEX = FRAME_INDEX;

  20849   1 000A1E  E847 001D                            LDR,R6   FRAME_INDEX,AUTO
          1 000A20  EF47 012F                            STR,R6   QCG@GET_FIELD+6,AUTO

     1231    20850    1       QCG@GET_FIELD.FIELD_INDEX = FIELD_INDEX;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:150  

  20850   1 000A22  D847 0019                            LDR,R5   FIELD_INDEX,AUTO
          1 000A24  DF47 0130                            STR,R5   QCG@GET_FIELD+7,AUTO

     1232    20851
     1233    20852    1       CALL QCG$GET_FIELD ( QCG@GET_FIELD );

  20852   1 000A26  DBC7 0129                            LAB,B5   QCG@GET_FIELD,AUTO
          1 000A28  DFC7 013E                            STB,B5   QCI@IO_READ+11,AUTO
          1 000A2A  BBC7 013E                            LAB,B3   QCI@IO_READ+11,AUTO
          1 000A2C  CBF0 0100                            LAB,B4   256,IMO
          1 000A2E  E380 0000 0000  xent                 LNJ,B6   QCG$GET_FIELD
          1 000A31       0001                            DC       s:20854,PREL

     1234    20853
     1235    20854    1       IF QCG@GET_FIELD.STATUS = %QI#USE_INVALID_RETURN

  20854   1 000A32  E847 0131                            LDR,R6   QCG@GET_FIELD+8,AUTO
          1 000A34  6981 0008                            BNEZ,R6  s:20861,PREL

     1236    20855    1       THEN
     1237    20856    2         DO;

     1238    20857    2           QCR@READ.STATUS = %QI#USE_INVALID_RETURN;

  20857   1 000A36  ECC7 0004                            LDB,B6   @QCR@READ,AUTO
          1 000A38  8746 0007                            CL       7,B6

     1239    20858    2           RETURN;

  20858   1 000A3A  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

     1240    20859    2         END;
     1241    20860
     1242    20861    1       GOTO RETRY_FIELD_POST_EDITING;

  20861   1 000A3D  0F81 F654                            B        s:19688,PREL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:151  

     1243    20862
     1244    20863        %EJECT;
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:152  
     1245    20864    1   REPLACE_FIELD_DATA: PROC;

  20864   1 000A3F  EFC7 013C            REPLACE_FIELD_D*STB,B6   QCI@IO_READ+9,AUTO

     1246    20865
     1247    20866    2       VARIABLE_SOURCE$ = PINCRC ( QI_1.OTTER_SPACE.T$,

  20866   1 000A41  8C80 0000 0046  xsym                 LDI      QI_1+70
          1 000A44  7031                                 DCL,R7   1
          1 000A45  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 000A47  F847 002F                            LDR,R7   SOURCE_INDEX,AUTO
          1 000A49  6C00                                 LDV,R6   0
          1 000A4A  8447 013E                            AID      QCI@IO_READ+11,AUTO
          1 000A4C  7071                                 DCR,R7   1
          1 000A4D  8D47 0037                            SDI      VARIABLE_SOURCE$,AUTO

     1248    20867    2         SOURCE_INDEX );
     1249    20868    2       QI_1.OP.LEN.S = GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH;

  20868   1 000A4F  DCC7 0020                            LDB,B5   GZ_FIELD$,AUTO
          1 000A51  D845 0006                            LDR,R5   6,B5
          1 000A53  D570 00FF                            AND,R5   255,IMO
          1 000A55  DF00 0000 0026  xsym                 STR,R5   QI_1+38

     1250    20869
     1251    20870    2       VARIABLE_TARGET$ = PINCRC ( GZ_FIELD$ -> QI$GZ_FIELD.STATUS.DATA$,

  20870   1 000A58  C845 0006                            LDR,R4   6,B5
          1 000A5A  404F                                 SOR,R4   15
          1 000A5B  CA47 0031                            ADD,R4   TARGET_INDEX,AUTO
          1 000A5D  CCC5 0009                            LDB,B4   9,B5
          1 000A5F  CFC7 013E                            STB,B4   QCI@IO_READ+11,AUTO
          1 000A61  8CC7 013E                            LDI      QCI@IO_READ+11,AUTO
          1 000A63  7031                                 DCL,R7   1
          1 000A64  8D47 0140                            SDI      QCI@IO_READ+13,AUTO
          1 000A66  F854                                 LDR,R7   R4
          1 000A67  6C00                                 LDV,R6   0
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:153  
          1 000A68  8447 0140                            AID      QCI@IO_READ+13,AUTO
          1 000A6A  7071                                 DCR,R7   1
          1 000A6B  8D47 0039                            SDI      VARIABLE_TARGET$,AUTO

     1252    20871    2         TARGET_INDEX
     1253    20872    2         + GZ_FIELD$ -> QI$GZ_FIELD.STATUS.OFFSET );
     1254    20873    2       QI_1.OP.LEN.T = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.LENGTH

  20873   1 000A6D  C845 0002                            LDR,R4   2,B5
          1 000A6F  C570 00FF                            AND,R4   255,IMO
          1 000A71  C247 0031                            SUB,R4   TARGET_INDEX,AUTO
          1 000A73  CF00 0000 0027  xsym                 STR,R4   QI_1+39

     1255    20874    2         - TARGET_INDEX;
     1256    20875
     1257    20876    2       VARIABLE_TARGET$ -> QI$VARIABLE_STRING_TARGET.TEXT =

  20876   1 000A76  B856                                 LDR,R3   R6
          1 000A77  E570 7FFF                            AND,R6   32767,IMO
          1 000A79  8D47 013E                            SDI      QCI@IO_READ+11,AUTO
          1 000A7B  CCC7 013E                            LDB,B4   QCI@IO_READ+11,AUTO
          1 000A7D  304F                                 SOR,R3   15
          1 000A7E  8CC7 0037                            LDI      VARIABLE_SOURCE$,AUTO
          1 000A80  A856                                 LDR,R2   R6
          1 000A81  E570 7FFF                            AND,R6   32767,IMO
          1 000A83  8D47 0140                            SDI      QCI@IO_READ+13,AUTO
          1 000A85  BCC7 0140                            LDB,B3   QCI@IO_READ+13,AUTO
          1 000A87  204F                                 SOR,R2   15
          1 000A88  AF47 0142                            STR,R2   QCI@IO_READ+15,AUTO
          1 000A8A  BF47 0143                            STR,R3   QCI@IO_READ+16,AUTO
          1 000A8C  BFC7 0144                            STB,B3   QCI@IO_READ+17,AUTO
          1 000A8E  CFC7 0146                            STB,B4   QCI@IO_READ+19,AUTO
          1 000A90  AB83                                 LAB,B2   ,B3
          1 000A91  E855                                 LDR,R6   R5
          1 000A92  BB84                                 LAB,B3   ,B4
          1 000A93  F854                                 LDR,R7   R4
          1 000A94  D380 0000 0000  xent                 LNJ,B5   X6C_ALR
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:154  

     1258    20877    2         VARIABLE_SOURCE$ -> QI$VARIABLE_STRING_SOURCE.TEXT;
     1259    20878
     1260    20879    2       GZ_FIELD$ -> QI$GZ_FIELD.STATUS.LENGTH = GZ_FIELD$ -> QI$GZ_FIELD.DESCRIPTION.
             20879                LENGTH;

  20879   1 000A97  ECC7 0020                            LDB,B6   GZ_FIELD$,AUTO
          1 000A99  E846 0002                            LDR,R6   2,B6
          1 000A9B  EAC6 0006                            SRM,R6,'00FF'X    6,B6
          1 000A9D       00FF

     1261    20880
     1262    20881    2       RETURN;

  20881   1 000A9E  ECC7 013C                            LDB,B6   QCI@IO_READ+9,AUTO
          1 000AA0  C3C6 0001                            LNJ,B4   1,B6
     1263    20882
     1264    20883    2   END REPLACE_FIELD_DATA;
     1265    20884
     1266    20885    1   END QCR$READ;

PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:155  
--  Include file information  --

   QCR_READ_M.:E05TOU  is referenced.
   QCI_IO_READ_M.:E05TOU  is referenced.
   QCG_GET_FIELD_M.:E05TOU  is referenced.
   QCD_DE_EDIT_M.:E05TOU  is referenced.
   QI_MACROS_M.:E05TOU  is referenced.
   QI_PERR_C.:E05TOU  is referenced.
   QI_EQUATES_E.:E05TOU  is referenced.
   QG_MACRO_M.:E05TOU  is referenced.
   G_JIT_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   G_LCP6_E.:E05TOU  was found in the system file and is referenced.
   GT_LCP6_M.:E05TOU  was found in the system file and is referenced.
   KI_CP6.:E05TOU  was found in the system file and is referenced.
   GF_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GM_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GU_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GJ_LCP6_M.:E05TOU  was found in the system file and is referenced.
   GH_LCP6_M.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure QCR$READ.
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:156  

 **** Variables and constants ****

  ****  Section 000 RoData QCR$READ

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(72)    r     1 OOPS_EMBEDDED_BLANKS      CE-0-0/c CHAR(72)    r     1 OOPS_ENTRY_REQUIRED
    F2-0-0/c CHAR(72)    r     1 OOPS_FULLA_FILL
    58-0-0/c CHAR(24)    r     1 OOPS_ILLEGAL_CHARACTER
    AA-0-0/c CHAR(72)    r     1 OOPS_ILLEGAL_INPUT        74-0-0/c CHAR(30)    r     1 OOPS_MAXIMUM_SIZE
    64-0-0/c CHAR(32)    r     1 OOPS_MINIMUM_SIZE         48-0-0/c CHAR(32)    r     1 OOPS_NON_NUMERICAL
    24-0-0/c CHAR(72)    r     1 OOPS_SIGN_ONLY
    83-0-0/c CHAR(38)    r     1 OOPS_WITH_LEADING_SIGN
    96-0-0/c CHAR(39)    r     1 OOPS_WITH_TRAILING_SIGN

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @QCR@READ                  6-0-0/w PTR         r     1 CLASS_ALPHABET$
     8-0-0/w SBIN(16)    r     1 CLASS_INDEX                9-0-0/w PTR         r     1 CLASS_THING$
     B-0-0/w UBIN(16)    r     1 CLASS_TYPE                 C-0-0/w SBIN(16)    r     1 CURRENT_INDEX
     D-0-0/w UBIN(16)    r     1 DATA_INDEX                 E-0-0/w UBIN(16)    r     1 DATA_SIGN
     F-0-0/w SBIN(16)    r     1 DEFAULT_INDEX             10-0-0/w UBIN(16)    r     1 DIGIT_INDEX
    11-0-0/w UBIN(16)    r     1 DIGIT_LENGTH              12-0-0/w UBIN(16)    r     1 ERROR_CODE
    13-0-0/w PTR         r     1 FIELD_DAD$                15-0-0/w PTR         r     1 FIELD_DAD_P$
    17-0-0/w PTR         r     1 FIELD_IDENTIFIER$         19-0-0/w UBIN(16)    r     1 FIELD_INDEX
    1A-0-0/w UBIN(16)    r     1 FILL_CHARACTER
    1A-0-0/w STRC(16)    r     1 FILL_CHARACTER_MINIMUM_SIZE
    1B-0-0/w PTR         r     1 FRAME$                    1D-0-0/w UBIN(16)    r     1 FRAME_INDEX
    1E-0-0/w PTR         r     1 FRAME_STATUS$             20-0-0/w PTR         r     1 GZ_FIELD$
    22-0-0/w PTR         r     1 LAST_DAD$                 24-0-0/w UBIN(16)    r     1 MAXIMUM_SIZE
    25-0-0/c CHAR(2)     r     1 MAXIMUM_SIZE_TEXT         26-0-0/w UBIN(16)    r     1 MINIMUM_SIZE
    27-0-0/c CHAR(3)     r     1 MINIMUM_SIZE_TEXT         29-0-0/w UBIN(16)    r     1 MOP_STRING_INDEX
    2A-0-0/w UBIN(16)    r     1 NONBLANK_INDEX            2B-0-0/w UBIN(16)    r     1 NONBLANK_LENGTH
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:157  
    EE-0-0/c CHAR(80)    r     1 OTTER_ERROR_MESSAGE       2C-0-0/w PTR         r     1 PIC$
    2E-0-0/w UBIN(16)    r     1 P_ITEM_INDEX             116-0-0/w STRC(304)   r     1 QCD@DE_EDIT
   129-0-0/w STRC(160)   r     1 QCG@GET_FIELD            133-0-0/w STRC(144)   r     1 QCI@IO_READ
    *0-0-0/w STRC(144)   r     1 QCR@READ                  3E-0-0/d STRC(384)   r     1 QI@MAT
    6E-0-0/w STRC(2048)  r     1 QI@OTTER_SPACE            56-0-0/d STRC(384)   r     1 QI@SRCH_VRFY
    2F-0-0/w UBIN(16)    r     1 SOURCE_INDEX              30-0-0/w UBIN(16)    r     1 STARTING_INDEX
    31-0-0/w UBIN(16)    r     1 TARGET_INDEX
    32-0-0/w UBIN(16)    r     1 THIS_MOP_FUNCTIONS_LENGTH
    33-0-0/c STRC(32)    r     1 U1                        35-0-0/w PTR         r     1 U1$
    37-0-0/w PTR         r     1 VARIABLE_SOURCE$          39-0-0/w PTR         r     1 VARIABLE_TARGET$
    3B-0-0/w BIT         r     1 WE_GOTTA_DEFAULT_VALUE
    3C-0-0/w BIT         r     1 WE_GOTTA_FILL_CHARACTER

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 G$JIT$                     0-0-0/d STRC(2576)  r     1 QI_1
     0-0-0/w UBIN(8)     r     1 QI_BLANK
     0-0-0/b UBIN(8)     r     1 QI_CLASS_ALPHA(0:255)
     0-0-0/b UBIN(8)     r     1 QI_CLASS_NUMERIC(0:255)
     0-0-0/d STRC(384)   r     1 QI_MAT                     0-0-0/w UBIN(8)     r     1 QI_MAT_MATCH
     0-0-0/w UBIN(8)     r     1 QI_MAT_NONMATCH
     0-0-0/b UBIN(8)     r     1 QI_OVERPUNCHED_SIGNS(0:19)
     0-0-0/w UBIN(8)     r     1 QI_SLASH                   0-0-0/d STRC(384)   r     1 QI_SRCH_VRFY
     0-0-0/w UBIN(8)     r     1 QI_ZERO

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(5616)  r     1 G$JIT
     0-0-0/w STRC(32)    r     1 QI$ALPHANUMERIC_PICTURE_STRING
     0-0-0/w STRC        r     1 QI$BITS
     0-0-0/c CHAR        r     1 QI$CHAR_A(0:0)
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:158  
     0-0-0/w STRC(384)   r     1 QI$FIELD_DAD               0-0-0/w STRC(112)   r     1 QI$FIELD_DAD_P
     0-0-0/w STRC(192)   r     1 QI$FORM_FILE               0-0-0/w STRC(128)   r     1 QI$FRAME
     0-0-0/w STRC(208)   r     1 QI$FRAME_STATUS            0-0-0/w STRC(184)   r     1 QI$GZ_FIELD
     0-0-0/w STRC(16)    r     1 QI$INDICATORS              0-0-0/w STRC(32)    r     1 QI$PICTURE_STRING
     0-0-0/c UBIN(8)     r     1 QI$UBYTE_A(0:0)
     0-0-0/c ASTR(8)     r     1 QI$VARIABLE_IDENTIFIER
     0-0-0/c ASTR(0)     r     1 QI$VARIABLE_STRING_SOURCE
     0-0-0/c ASTR(0)     r     1 QI$VARIABLE_STRING_TARGET
     0-0-0/c STRC(32)    r     1 U$1


   Procedure QCR$READ requires 2722 words for executable code.
   Procedure QCR$READ requires 328 words of local(AUTO) storage.

    No errors detected in file QCR$READ.:E05TSI    .
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:159  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:160  
          MINI XREF LISTING

ALPHANUMERIC_CLASS_CHECK
     20519**LABEL   20498--GOTO    20506--GOTO
ALPHANUMERIC_CLASS_STUFF
     20487**LABEL   20503--EXIT    20513--EXIT
BOSS_KEEN_NEAT_ALPHANUMERIC
     20482**LABEL   20434--CALLALT
BOSS_KEEN_NEAT_DISPLAY
     20085**LABEL   20023--CALLALT 20052--CALLALT
CLASS_ALPHABET$
     17763**DCL     19980<<ASSIGN  20191>>ASSIGN  20342>>ASSIGN  20511>>IF      20517>>ASSIGN
CLASS_INDEX
     17764**DCL     19942<<ASSIGN  19946<<ASSIGN  19946>>ASSIGN  19980>>ASSIGN
CLASS_THING$
     17765**DCL     20334<<ASSIGN  20338<<ASSIGN  20342<<ASSIGN  20347>>ASSIGN  20497<<ASSIGN  20505<<ASSIGN
     20517<<ASSIGN  20526>>ASSIGN
CLASS_TYPE
     17766**DCL     19914<<ASSIGN  20000<<ASSIGN  20003<<ASSIGN  20182>>DOCASE  20329>>DOCASE  20361>>IF
     20487>>DOCASE
CLASS_VIOLATION_IN_AE
     20716**LABEL   20379--GOTO
CLASS_VIOLATION_IN_ALPHA
     20722**LABEL   20538--GOTO
CLASS_VIOLATION_IN_DISPLAY
     20713**LABEL   20203--GOTO
CURRENT_INDEX
     17767**DCL     20466<<DOINDEX 20468>>IF      20553<<DOINDEX 20555>>IF
DATA_INDEX
     17768**DCL     20351<<ASSIGN  20365>>ASSIGN  20393>>ASSIGN  20401<<ASSIGN  20401>>ASSIGN
DATA_SIGN
     17769**DCL     20112<<ASSIGN  20115<<ASSIGN  20128<<ASSIGN  20131<<ASSIGN  20145<<ASSIGN  20151<<ASSIGN
     20155<<ASSIGN  20214>>ASSIGN
DEFAULT_INDEX
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:161  
     17770**DCL     19745<<ASSIGN  19749<<ASSIGN  19749>>ASSIGN  19761>>ASSIGN
DIGIT_INDEX
     17771**DCL     20094<<ASSIGN  20101>>IF      20101>>IF      20105<<ASSIGN  20105>>ASSIGN  20118>>IF
     20118>>IF      20136>>ASSIGN  20163>>ASSIGN  20189>>ASSIGN
DIGIT_LENGTH
     17772**DCL     20095<<ASSIGN  20106<<ASSIGN  20106>>ASSIGN  20108>>IF      20118>>IF      20118>>IF
     20122<<ASSIGN  20122>>ASSIGN  20124>>IF      20136>>ASSIGN  20146<<ASSIGN  20146>>ASSIGN  20164>>ASSIGN
     20190>>ASSIGN
EMBEDDED_BLANKS_IN_DISPLAY
     20623**LABEL   20082--CALLALT
ENTRY_REQUIRED
     20611**LABEL   19842--GOTO    20244--GOTO
ERROR_CODE
     17773**DCL     20611<<ASSIGN  20617<<ASSIGN  20623<<ASSIGN  20629<<ASSIGN  20658<<ASSIGN  20693<<ASSIGN
     20700<<ASSIGN  20713<<ASSIGN  20722<<ASSIGN  20752<<ASSIGN  20766<<ASSIGN  20832<>CALL
FIELD_DAD$
     17774**DCL     19695<<ASSIGN  19699>>ASSIGN  19699>>ASSIGN  19778>>ASSIGN  19840>>IF      19888>>IF
     19892>>ASSIGN  20011>>DOCASE  20098>>DOCASE  20220>>ASSIGN  20236>>IF      20252>>IF      20279>>ASSIGN
     20424>>IF      20545>>IF      20683>>DOCASE
FIELD_DAD_P$
     17775**DCL     19699<<ASSIGN  19719>>IF      19747>>IF      19761>>ASSIGN  19895>>IF      19898>>ASSIGN
     19912>>IF      19914>>ASSIGN  19917>>IF      19944>>IF      19980>>ASSIGN
FIELD_IDENTIFIER$
     17776**DCL     20794<<ASSIGN  20814>>CALL    20814>>CALL
FIELD_INDEX
     17777**DCL     19685<<DOINDEX 20850>>ASSIGN
FILL_CHARACTER
     17778**DCL     17779--REDEF   19898<<ASSIGN
FILL_CHARACTER_MINIMUM_SIZE.FILL_CHARACTER
     17780**DCL     19899>>IF      20429--ASSIGN  20468>>IF
FILL_CHARACTER_MINIMUM_SIZE.MINIMUM_SIZE
     17781**DCL     19904>>ASSIGN
FRAME$
     17782**DCL     19594<<ASSIGN  19634>>ASSIGN
FRAME_INDEX
     17783**DCL     19572<<DOINDEX 19594>>ASSIGN  20849>>ASSIGN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:162  
FRAME_STATUS$
     17784**DCL     19634<<ASSIGN  19654>>IF      19662>>ASSIGN  19663>>ASSIGN  19677>>ASSIGN
FULLA_FILL
     20766**LABEL   20495--GOTO    20515--GOTO
G$JIT.ERRLOG
       855**DCL       858--REDEF
G$JIT.JSUNIT
       594**DCL       595--REDEF
G$JIT.LANG
       858**DCL     20828>>IF      20828>>IF
G$JIT.MCLS
       593**DCL       593--REDEF
G$JIT.TMRZ
       862**DCL       863--REDEF
G$JIT.USER_EXTIME
       586**DCL       587--REDEF
G$JIT.USER_MEMTIME
       589**DCL       589--REDEF
G$JIT.USER_SVTIME
       588**DCL       588--REDEF
G$JIT$
       925**DCL     20828>>IF      20828>>IF
GET_FIELD_AGAIN_NO_DEFAULT
     20828**LABEL   20614--GOTO
GET_THAT_FIELD_AGAIN
     20770**LABEL   20620--GOTO    20626--GOTO    20632--GOTO    20664--GOTO    20709--GOTO    20749--GOTO
     20763--GOTO
GZ_FIELD$
     17785**DCL     19677<<ASSIGN  19688>>IF      19693>>ASSIGN  19695>>ASSIGN  19704>>IF      19704>>IF
     19709>>ASSIGN  19710>>ASSIGN  19714>>IF      19767>>ASSIGN  19777>>ASSIGN  19793>>ASSIGN  19798>>ASSIGN
     19805>>ASSIGN  19809>>ASSIGN  19809>>ASSIGN  19825>>ASSIGN  19844>>ASSIGN  19845>>ASSIGN  19864>>IF
     19864>>IF      19873>>ASSIGN  19873>>ASSIGN  19875>>ASSIGN  19878>>ASSIGN  20018>>ASSIGN  20021>>ASSIGN
     20085>>ASSIGN  20165>>ASSIGN  20166>>ASSIGN  20219>>ASSIGN  20221>>ASSIGN  20223>>ASSIGN  20232>>ASSIGN
     20232>>ASSIGN  20240>>ASSIGN  20303>>ASSIGN  20321>>IF      20345>>ASSIGN  20346>>ASSIGN  20432>>ASSIGN
     20448>>ASSIGN  20448>>ASSIGN  20454>>ASSIGN  20466>>DOINDEX 20471>>ASSIGN  20471>>ASSIGN  20482>>IF
     20493>>IF      20501>>IF      20509>>IF      20522>>ASSIGN  20523>>ASSIGN  20524>>ASSIGN  20553>>DOINDEX
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:163  
     20572>>ASSIGN  20572>>ASSIGN  20593>>ASSIGN  20594>>ASSIGN  20599<<ASSIGN  20599>>ASSIGN  20731>>ASSIGN
     20732>>ASSIGN  20733>>ASSIGN  20794>>ASSIGN  20868>>ASSIGN  20870>>ASSIGN  20870>>ASSIGN  20873>>ASSIGN
     20879>>ASSIGN  20879>>ASSIGN
ILLEGAL_CHARACTER_IN_AE
     20752**LABEL   20396--CALLALT
ILLEGAL_INPUT_IN_DE
     20617**LABEL   20312--GOTO
LAST_DAD$
     17786**DCL     19682<<ASSIGN  19888>>IF      19892<<ASSIGN
LEADING_BLANKS_IN_DISPLAY
     20036**LABEL   20060--EXIT
MAXIMUM_SIZE
     17787**DCL     20669<<ASSIGN  20670>>CALLBLT 20672>>IF
MAXIMUM_SIZE_TEXT
     17788**DCL     20670<<CALLBLT 20678>>ASSIGN  20705>>ASSIGN
MINIMUM_SIZE
     17789**DCL     19904<<ASSIGN  19909<<ASSIGN  20090>>IF      20314>>IF      20321>>IF      20482>>IF
     20637>>CALLBLT 20639>>IF      20643>>IF
MINIMUM_SIZE_ERROR
     20635**LABEL   20092--GOTO    20316--GOTO    20323--GOTO    20484--GOTO
MINIMUM_SIZE_TEXT
     17790**DCL     20637<<CALLBLT 20649>>ASSIGN  20660>>ASSIGN
MOP_STRING_INDEX
     17791**DCL     20353<<DOINDEX 20355>>ASSIGN  20357>>DOCASE
NEXT_FIELD_PLEASE
     20599**LABEL   19711--GOTO    19846--GOTO
NONBLANK_INDEX
     17792**DCL     20020<<ASSIGN  20049<<ASSIGN  20094>>ASSIGN  20213>>ASSIGN  20217>>ASSIGN
NONBLANK_LENGTH
     17793**DCL     20021<<ASSIGN  20050<<ASSIGN  20085<<ASSIGN  20085>>ASSIGN  20090>>IF      20095>>ASSIGN
     20215>>ASSIGN
NON_NUMERICAL_DISPLAY
     20708**LABEL   20180--GOTO
NOTHING_ENTERED
     19717**LABEL   20063--GOTO
OOPS_EMBEDDED_BLANKS
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:164  
     19530**DCL     20625--ASSIGN
OOPS_ENTRY_REQUIRED
     19548**DCL     20613--ASSIGN
OOPS_FULLA_FILL
     19550**DCL     20767--ASSIGN
OOPS_ILLEGAL_CHARACTER
     19536**DCL     20723>>ASSIGN  20725--ASSIGN  20753>>ASSIGN  20755--ASSIGN
OOPS_ILLEGAL_INPUT
     19546**DCL     20619--ASSIGN
OOPS_MAXIMUM_SIZE
     19540**DCL     20667>>ASSIGN  20678--ASSIGN  20689--ASSIGN  20696--ASSIGN
OOPS_MINIMUM_SIZE
     19538**DCL     20635>>ASSIGN  20649--ASSIGN  20654--ASSIGN
OOPS_NON_NUMERICAL
     19534**DCL     20714>>ASSIGN  20716--ASSIGN
OOPS_SIGN_ONLY
     19532**DCL     20631--ASSIGN
OOPS_WITH_LEADING_SIGN
     19542**DCL     20689--ASSIGN  20689>>ASSIGN
OOPS_WITH_TRAILING_SIGN
     19544**DCL     20696--ASSIGN  20696>>ASSIGN
OTTER_ERROR_MESSAGE
     19183**DCL     20635<<ASSIGN  20649<<ASSIGN  20654<<ASSIGN  20663--ASSIGN  20667<<ASSIGN  20678<<ASSIGN
     20689<<ASSIGN  20696<<ASSIGN  20708--ASSIGN  20714<<ASSIGN  20723<<ASSIGN  20741<<ASSIGN  20748--ASSIGN
     20753<<ASSIGN  20755<<ASSIGN  20762--ASSIGN  20832<>CALL    20838--ASSIGN
OVERFLOW
     20667**LABEL   19790--GOTO    20229--GOTO
PIC$
     17794**DCL     20279<<ASSIGN  20298>>DOCASE  20306>>ASSIGN  20353>>DOINDEX 20355>>ASSIGN  20357>>DOCASE
PRETEND_ITS_ALPHANUMERIC
     19797**LABEL   19774--GOTO
P_ITEM_INDEX
     17795**DCL     19746<<DOINDEX 19747>>IF      19943<<DOINDEX 19944>>IF
QCA$ALL_LITERAL_MOVE_A
     19514**DCL-ENT 19807--CALL
QCC$ACM
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:165  
     19515**DCL-ENT 20176--CALL    20199--CALL    20375--CALL    20534--CALL
QCC$DMC
     19518**DCL-ENT 19787--CALL    20226--CALL
QCC$MAT
     19517**DCL-ENT 20170--CALL    20193--CALL    20369--CALL    20528--CALL
QCC$SRCH
     19519**DCL-ENT 20023--CALL    20052--CALL    20141--CALL    20434--CALL    20735--CALL
QCC$VRFY
     19520**DCL-ENT 20041--CALL    20082--CALL    20396--CALL    20444--CALL
QCD$DE_EDIT
     19521**DCL-ENT 20308--CALL
QCD@DE_EDIT
     19230**DCL     20308<>CALL
QCD@DE_EDIT.IS_NUMBER_INVALID
     19231**DCL     20310>>IF
QCD@DE_EDIT.RESULT.INPUT_SIZE
     19240**DCL     20314>>IF
QCE$ERROR
     19522**DCL-ENT 20814--CALL
QCE$ERROR_INTERNAL
     19523**DCL-ENT 19673--CALL    19830--CALL    19867--CALL    20206--CALL    20541--CALL    20589--CALL
     20686--CALL    20738--CALL
QCE$ERROR_MESSAGE
     19524**DCL-ENT 20832--CALL
QCG$GET_FIELD
     19525**DCL-ENT 20852--CALL
QCG@GET_FIELD
     19307**DCL     20852<>CALL
QCG@GET_FIELD.FIELD_INDEX
     19321**DCL     20850<<ASSIGN
QCG@GET_FIELD.FRAME_INDEX
     19319**DCL     20849<<ASSIGN
QCG@GET_FIELD.IS_MESSAGE_A_DAD
     19311**DCL     20848<<ASSIGN
QCG@GET_FIELD.MESSAGE$
     19317**DCL     20613<<ASSIGN  20619<<ASSIGN  20625<<ASSIGN  20631<<ASSIGN  20663<<ASSIGN  20708<<ASSIGN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:166  
     20748<<ASSIGN  20762<<ASSIGN  20767<<ASSIGN  20838<<ASSIGN
QCG@GET_FIELD.MESSAGE_LINE_GZ_HEADER$
     19308**DCL     20847<<ASSIGN
QCG@GET_FIELD.STATUS
     19323**DCL     20854>>IF
QCI$IO_READ
     19526**DCL-ENT 19559--CALL
QCI@IO_READ
     19393**DCL     19557<<ASSIGN  19559<>CALL
QCI@IO_READ.FIELD_START_INDEX
     19401**DCL     19662<<ASSIGN  19677>>ASSIGN  19685>>DOINDEX
QCI@IO_READ.FIELD_STOP_INDEX
     19403**DCL     19663<<ASSIGN  19668>>IF      19685>>DOINDEX
QCI@IO_READ.FRAME_START_INDEX
     19394**DCL     19572>>DOINDEX
QCI@IO_READ.FRAME_STOP_INDEX
     19396**DCL     19572>>DOINDEX
QCI@IO_READ.IS_FIELD_INDEXES_VALID
     19398**DCL     19659>>IF      19668>>IF
QCI@IO_READ.STATUS
     19410**DCL     19561>>ASSIGN  19563>>IF
QCR@READ
     19480**DCL        16--PROC    19557>>ASSIGN
QCR@READ.FIELD_START_INDEX
     19488**DCL     19668>>IF
QCR@READ.IS_FIELD_INDEXES_VALID
     19485**DCL     19668>>IF
QCR@READ.STATUS
     19497**DCL     19561<<ASSIGN  20857<<ASSIGN
QCS$SETUP_SOURCE
     19527**DCL-ENT 19765--CALL
QGB_PARAM.DVE.DVBYTE.VFC
     12246**DCL     12247--REDEF
QGB_PARAM.DVE.EOMCHAR
     12258**DCL     12259--REDEF
QGB_PARAM.MSG$
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:167  
     12240**DCL     12241--REDEF
QGB_PARAM.UHDR$
     12265**DCL     12266--REDEF
QI$ACTIVATION_STATUS
     10004**DCL     10010--REDEF
QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_A.FUNCTION
      9930**DCL     20357>>DOCASE
QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_A.LENGTH
      9931**DCL     20355>>ASSIGN
QI$ALPHANUMERIC_PICTURE_STRING.EDIT_STRING_COUNT
      9928**DCL     20353>>DOINDEX
QI$BITS.BIT_A
     12339**DCL     19747>>IF      19944>>IF
QI$CHAR_A
     12340**DCL     20741>>ASSIGN  20746>>ASSIGN  20755>>ASSIGN  20760>>ASSIGN
QI$CIP
      8845**DCL      8915--REDEF
QI$CIP.CA
      8850**DCL      8854--REDEF    8857--REDEF    8860--REDEF
QI$COBOL_DAD.PSEUDO_CIP
      9089**DCL      9114--REDEF
QI$COBOL_DAD.PSEUDO_CIP.ALPHANUMERIC
      9091**DCL      9096--REDEF
QI$COBOL_DAD.PSEUDO_CIP.NUMERIC.CB
      9097**DCL      9100--REDEF    9103--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS
      9125**DCL      9141--REDEF    9149--REDEF    9157--REDEF
QI$COBOL_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
      9126**DCL      9136--REDEF    9139--REDEF
QI$COBOL_DAD.WORD0
      9053**DCL      9054--REDEF    9068--REDEF
QI$COBOL_DAD_P_BITS.P
      9193**DCL      9199--REDEF
QI$CONDITION_CONTROL_BLOCK.LIST_A@P
      8679**DCL      8680--REDEF
QI$CONDITION_CONTROL_BLOCK.WORD0_FLAGS
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:168  
      8675**DCL      8678--REDEF
QI$CONDITION_LEGAL_BLOCK.ARRAY@P
      8712**DCL      8713--REDEF    8714--REDEF
QI$DAD.PSEUDO_CIP
      8992**DCL      9017--REDEF
QI$DAD.PSEUDO_CIP.ALPHANUMERIC
      8994**DCL      8999--REDEF
QI$DAD.PSEUDO_CIP.NUMERIC.CB
      9000**DCL      9003--REDEF    9006--REDEF
QI$DAD.WORD0
      8961**DCL      8962--REDEF
QI$ERROR_MESSAGE_LINE
     12353**DCL     12355--REDEF
QI$ERROR_STATUS
     12350**DCL     12352--REDEF
QI$FIELD_DAD.ELEMENTARY_ITEM.P
      9407**DCL      9414--REDEF
QI$FIELD_DAD.IDENTIFIER@P
      9378**DCL     20794>>ASSIGN
QI$FIELD_DAD.ONE_DIMENSIONAL_ITEM.P
      9427**DCL      9434--REDEF
QI$FIELD_DAD.PICTURE_STRING@P
      9370**DCL     20252>>IF      20279>>ASSIGN
QI$FIELD_DAD.PSEUDO_CIP
      9334**DCL      9359--REDEF
QI$FIELD_DAD.PSEUDO_CIP.ALPHANUMERIC
      9336**DCL      9341--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CB
      9342**DCL      9345--REDEF    9348--REDEF
QI$FIELD_DAD.PSEUDO_CIP.NUMERIC.CD.SIGN
      9347**DCL     19778>>ASSIGN  20098>>DOCASE  20220>>ASSIGN  20683>>DOCASE
QI$FIELD_DAD.TWO_DIMENSIONAL_ITEM.P
      9447**DCL      9454--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS
      9390**DCL      9406--REDEF    9424--REDEF    9442--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIERS
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:169  
      9391**DCL      9401--REDEF    9404--REDEF
QI$FIELD_DAD.VARIABLE_LENGTH_ITEMS.LEVEL_MULTIPLIER_A
      9401**DCL     19699--ASSIGN
QI$FIELD_DAD.WORD0
      9286**DCL      9287--REDEF
QI$FIELD_DAD.WORD0_FLAGS.DIMENSION_COUNT
      9310**DCL     19699>>ASSIGN
QI$FIELD_DAD.WORD0_FLAGS.IO_FLAGS
      9290**DCL      9295--REDEF
QI$FIELD_DAD.WORD0_FLAGS.IS_ENTRY_REQUIRED
      9297**DCL     19840>>IF      20236>>IF
QI$FIELD_DAD.WORD0_FLAGS.IS_JUSTIFIED_RIGHT
      9301**DCL     20424>>IF      20545>>IF
QI$FIELD_DAD.WORD0_FLAGS.TYPE
      9312**DCL     20011>>DOCASE
QI$FIELD_DAD_P.CLASS_TYPE
      9497**DCL     19912>>IF      19914>>ASSIGN
QI$FIELD_DAD_P.P
      9488**DCL      9495--REDEF
QI$FIELD_DAD_P.P.CLASS_ALPHABET
      9490**DCL     19917>>IF
QI$FIELD_DAD_P.P.DEFAULT
      9491**DCL     19719>>IF
QI$FIELD_DAD_P.P.FILL_CHARACTER_MINIMUM_SIZE
      9489**DCL     19895>>IF
QI$FIELD_DAD_P.P_ITEM_A
      9498**DCL     19761--ASSIGN  19898>>ASSIGN  19980>>ASSIGN
QI$FIELD_STATUS.INDICATORS
     10154**DCL     10186--REDEF
QI$FIELD_STATUS.INDICATORS.ENABLED_FLAGS
     10158**DCL     10163--REDEF
QI$FIELD_STATUS.INDICATORS.OPEN_FLAGS
     10170**DCL     10177--REDEF
QI$FIELD_STATUS.INDICATORS.STATE_FLAGS
     10164**DCL     10169--REDEF
QI$FILE.WORD0
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:170  
      9610**DCL      9611--REDEF
QI$FILE_STATUS.INDICATORS
     10447**DCL     10479--REDEF
QI$FILE_STATUS.INDICATORS.ENABLED_FLAGS
     10451**DCL     10456--REDEF
QI$FILE_STATUS.INDICATORS.OPEN_FLAGS
     10463**DCL     10470--REDEF
QI$FILE_STATUS.INDICATORS.STATE_FLAGS
     10457**DCL     10462--REDEF
QI$FORM_FILE.FRAME_LIST_A@P
      9718**DCL     19594>>ASSIGN
QI$FORM_FILE.USE_PROCEDURE
      9710**DCL      9717--REDEF
QI$FORM_FILE.WORD0
      9664**DCL      9665--REDEF
QI$FORM_STATUS.INDICATORS
     10568**DCL     10600--REDEF
QI$FORM_STATUS.INDICATORS.ENABLED_FLAGS
     10572**DCL     10577--REDEF
QI$FORM_STATUS.INDICATORS.OPEN_FLAGS
     10584**DCL     10591--REDEF
QI$FORM_STATUS.INDICATORS.STATE_FLAGS
     10578**DCL     10583--REDEF
QI$FRAME.STATUS_AREA@D
      9841**DCL     19634>>ASSIGN
QI$FRAME.WORD0
      9825**DCL      9826--REDEF
QI$FRAME_STATUS.GZ.FIELD_START_INDEX
     10750**DCL     19662>>ASSIGN
QI$FRAME_STATUS.GZ.FIELD_STOP_INDEX
     10752**DCL     19663>>ASSIGN
QI$FRAME_STATUS.GZ.START$
     10760**DCL     19677>>ASSIGN
QI$FRAME_STATUS.INDICATORS
     10797**DCL     10829--REDEF
QI$FRAME_STATUS.INDICATORS.ENABLED_FLAGS
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:171  
     10801**DCL     10806--REDEF
QI$FRAME_STATUS.INDICATORS.IS_ACTIVE
     10799**DCL     19654>>IF
QI$FRAME_STATUS.INDICATORS.OPEN_FLAGS
     10813**DCL     10820--REDEF
QI$FRAME_STATUS.INDICATORS.STATE_FLAGS
     10807**DCL     10812--REDEF
QI$GZ_FIELD
     17676**DCL     19677--ASSIGN  20599--ASSIGN
QI$GZ_FIELD.DESCRIPTION.FIELD_DAD$
     17700**DCL     19695>>ASSIGN  20794>>ASSIGN
QI$GZ_FIELD.DESCRIPTION.IO_FLAGS
     17679**DCL     17684--REDEF
QI$GZ_FIELD.DESCRIPTION.IS_AOIM
     17690**DCL     19704>>IF
QI$GZ_FIELD.DESCRIPTION.LENGTH
     17693**DCL     19805>>ASSIGN  19809>>ASSIGN  19864>>IF      19878>>ASSIGN  20221>>ASSIGN  20232>>ASSIGN
     20553>>DOINDEX 20873>>ASSIGN  20879>>ASSIGN
QI$GZ_FIELD.INDICATORS$
     17677**DCL     19709>>ASSIGN  19844>>ASSIGN  20593>>ASSIGN
QI$GZ_FIELD.OPERATION.IS_DONE
     17728**DCL     19688>>IF      19693<<ASSIGN
QI$GZ_FIELD.STATUS.DATA$
     17720**DCL     19767>>ASSIGN  19873>>ASSIGN  20165>>ASSIGN  20223>>ASSIGN  20345>>ASSIGN  20523>>ASSIGN
     20572>>ASSIGN  20731>>ASSIGN  20870>>ASSIGN
QI$GZ_FIELD.STATUS.IS_AOIM_MODIFIED
     17705**DCL     19704>>IF
QI$GZ_FIELD.STATUS.LENGTH
     17713**DCL     19714>>IF      19793<<ASSIGN  19809<<ASSIGN  19825<<ASSIGN  19864>>IF      19875>>ASSIGN
     20018>>ASSIGN  20021>>ASSIGN  20085>>ASSIGN  20232<<ASSIGN  20240>>ASSIGN  20303>>ASSIGN  20321>>IF
     20432>>ASSIGN  20448<<ASSIGN  20448>>ASSIGN  20454<<ASSIGN  20466>>DOINDEX 20471<<ASSIGN  20471>>ASSIGN
     20482>>IF      20493>>IF      20501>>IF      20509>>IF      20522>>ASSIGN  20732>>ASSIGN  20868>>ASSIGN
     20879<<ASSIGN
QI$GZ_FIELD.STATUS.OFFSET
     17703**DCL     19777>>ASSIGN  19798>>ASSIGN  19873>>ASSIGN  20166>>ASSIGN  20219>>ASSIGN  20346>>ASSIGN
     20524>>ASSIGN  20572>>ASSIGN  20733>>ASSIGN  20870>>ASSIGN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:172  
QI$GZ_FIELD.STATUS.WAS_IO_EVER_DONE
     17711**DCL     19710<<ASSIGN  19845<<ASSIGN  20594<<ASSIGN
QI$IDENTIFIER
     12356**DCL     12358--REDEF
QI$INDICATORS
     10068**DCL     10098--REDEF
QI$INDICATORS.ENABLED_FLAGS
     10074**DCL     10079--REDEF
QI$INDICATORS.OPEN_FLAGS
     10086**DCL     10093--REDEF
QI$INDICATORS.STATE_FLAGS
     10080**DCL     10085--REDEF
QI$INDICATORS.STATE_VALUE
     10085**DCL     19709<<ASSIGN  19844<<ASSIGN  20593<<ASSIGN
QI$MAJOR_NODE.WORD0
      9524**DCL      9525--REDEF
QI$MAJOR_STATUS.INDICATORS
     10247**DCL     10279--REDEF
QI$MAJOR_STATUS.INDICATORS.ENABLED_FLAGS
     10251**DCL     10256--REDEF
QI$MAJOR_STATUS.INDICATORS.OPEN_FLAGS
     10263**DCL     10270--REDEF
QI$MAJOR_STATUS.INDICATORS.STATE_FLAGS
     10257**DCL     10262--REDEF
QI$MESSAGE_TYPE
     12347**DCL     12349--REDEF
QI$MINOR_NODE.WORD0
      9567**DCL      9568--REDEF
QI$MINOR_STATUS.INDICATORS
     10340**DCL     10372--REDEF
QI$MINOR_STATUS.INDICATORS.ENABLED_FLAGS
     10344**DCL     10349--REDEF
QI$MINOR_STATUS.INDICATORS.OPEN_FLAGS
     10356**DCL     10363--REDEF
QI$MINOR_STATUS.INDICATORS.STATE_FLAGS
     10350**DCL     10355--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:173  
QI$OP_ACCEPT.DATANAME@P
      6755**DCL      6756--REDEF
QI$OP_CALL.EPTR$
      6927**DCL      6928--REDEF
QI$OP_CLEAR.IO_FLAGS
      6960**DCL      6963--REDEF
QI$OP_DISPLAY.FIELD_A@P
      7227**DCL      7228--REDEF
QI$OP_ENABLE.IO_FLAGS
      7314**DCL      7317--REDEF
QI$OP_IFCLS.ATTRIBUTE.TYPE
      7407**DCL      7412--REDEF
QI$OP_INSPECT.TALLYING_FOR_ITEM@P
      7641**DCL      7642--REDEF
QI$OP_INSPECT.TALLYING_INITIAL_ITEM@P
      7643**DCL      7644--REDEF
QI$OP_INSPECT.TALLYING_ITEM@P
      7639**DCL      7640--REDEF
QI$OP_OPEN.IO_FLAGS
      8201**DCL      8204--REDEF
QI$OP_PERFM.BINARY_ITERATION_COUNT@P
      8239**DCL      8240--REDEF
QI$PICTURE_STRING.TYPE
      9868**DCL     20298>>DOCASE
QI$PSEUDO_CIP
      8740**DCL      8764--REDEF
QI$PSEUDO_CIP.ALPHANUMERIC
      8744**DCL      8749--REDEF
QI$PSEUDO_CIP.NUMERIC.CB
      8750**DCL      8753--REDEF    8756--REDEF
QI$TERMINAL_ATTRIBUTES
      9961**DCL      9974--REDEF
QI$TRAN_FILE.WORD0
      9746**DCL      9747--REDEF
QI$TRAN_STATUS.INDICATORS
     10681**DCL     10713--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:174  
QI$TRAN_STATUS.INDICATORS.ENABLED_FLAGS
     10685**DCL     10690--REDEF
QI$TRAN_STATUS.INDICATORS.OPEN_FLAGS
     10697**DCL     10704--REDEF
QI$TRAN_STATUS.INDICATORS.STATE_FLAGS
     10691**DCL     10696--REDEF
QI$UBYTE_A
     12341**DCL     20101>>IF      20101>>IF      20118>>IF      20118>>IF      20468>>IF      20511>>IF
     20555>>IF
QI$VARIABLE_IDENTIFIER
     12359**DCL     20814<>CALL
QI$VARIABLE_IDENTIFIER.LENGTH
     12360**DCL     12361--IMP-SIZ 20814>>CALL
QI$VARIABLE_STRING_SOURCE.TEXT
     12367**DCL     19822>>ASSIGN  19880>>ASSIGN  20242>>IF      20876>>ASSIGN
QI$VARIABLE_STRING_TARGET.TEXT
     12369**DCL     19822<<ASSIGN  19880<<ASSIGN  20576<<ASSIGN  20876<<ASSIGN
QI@MAT
     17852**DCL     20161<<ASSIGN  20170<>CALL    20176<>CALL    20193<>CALL    20199<>CALL    20344<<ASSIGN
     20369<>CALL    20375<>CALL    20519<<ASSIGN  20528<>CALL    20534<>CALL
QI@MAT.CIP
     17856**DCL     18307--REDEF
QI@MAT.CIP.AUX
     18222**DCL     18293--REDEF
QI@MAT.CIP.AUX.CA
     18225**DCL     18229--REDEF   18232--REDEF   18235--REDEF
QI@MAT.CIP.S
     17926**DCL     17997--REDEF
QI@MAT.CIP.S.CA
     17929**DCL     17933--REDEF   17936--REDEF   17939--REDEF
QI@MAT.CIP.T
     18074**DCL     18145--REDEF
QI@MAT.CIP.T.CA
     18077**DCL     18081--REDEF   18084--REDEF   18087--REDEF
QI@MAT.COMP_RESULT
     18458**DCL     20178>>IF      20201>>IF      20377>>IF      20536>>IF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:175  
QI@MAT.DATA
     18314**DCL     18318--REDEF
QI@MAT.DATA.AUX$
     18317**DCL     20168<<ASSIGN  20191<<ASSIGN  20347<<ASSIGN  20526<<ASSIGN
QI@MAT.DATA.S$
     18315**DCL     20162<<ASSIGN  20172<<ASSIGN  20188<<ASSIGN  20195<<ASSIGN  20364<<ASSIGN  20371<<ASSIGN
     20520<<ASSIGN  20530<<ASSIGN
QI@MAT.DATA.T$
     18316**DCL     20165<<ASSIGN  20345<<ASSIGN  20523<<ASSIGN
QI@MAT.DEC
     18382**DCL     18386--REDEF   18387--REDEF   18391--REDEF
QI@MAT.FILL_CHAR
     18438**DCL     18441--REDEF
QI@MAT.INX.S
     18388**DCL     20163<<ASSIGN  20173<<ASSIGN  20189<<ASSIGN  20196<<ASSIGN  20365<<ASSIGN  20372<<ASSIGN
     20521<<ASSIGN  20531<<ASSIGN
QI@MAT.INX.T
     18389**DCL     20166<<ASSIGN  20346<<ASSIGN  20524<<ASSIGN
QI@MAT.LEN
     18354**DCL     18358--REDEF   18359--REDEF   18363--REDEF   18364--REDEF   18368--REDEF
QI@MAT.LEN.S
     18355**DCL     20164<<ASSIGN  20167>>ASSIGN  20174<<ASSIGN  20190<<ASSIGN  20197<<ASSIGN  20366<<ASSIGN
     20367>>ASSIGN  20373<<ASSIGN  20522<<ASSIGN  20525>>ASSIGN  20532<<ASSIGN
QI@MAT.LEN.T
     18356**DCL     20167<<ASSIGN  20367<<ASSIGN  20525<<ASSIGN
QI@MAT.PICTURE_STRING
     18424**DCL     18427--REDEF   18428--REDEF   18431--REDEF   18432--REDEF   18435--REDEF
QI@MAT.ROUND
     18457**DCL     18458--REDEF   18459--REDEF
QI@MAT.SRCH_VRFY_ELEMS
     18393**DCL     18396--REDEF
QI@OTTER_SPACE
     19170**DCL     19172--REDEF   19173--REDEF   19555--ASSIGN
QI@SRCH_VRFY
     18524**DCL     20014<<ASSIGN  20023<>CALL    20041<>CALL    20052<>CALL    20082<>CALL    20141<>CALL
     20325<<ASSIGN  20396<>CALL    20428<<ASSIGN  20434<>CALL    20444<>CALL    20728<<ASSIGN  20735<>CALL
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:176  
QI@SRCH_VRFY.CIP
     18528**DCL     18979--REDEF
QI@SRCH_VRFY.CIP.AUX
     18894**DCL     18965--REDEF
QI@SRCH_VRFY.CIP.AUX.CA
     18897**DCL     18901--REDEF   18904--REDEF   18907--REDEF
QI@SRCH_VRFY.CIP.S
     18598**DCL     18669--REDEF
QI@SRCH_VRFY.CIP.S.CA
     18601**DCL     18605--REDEF   18608--REDEF   18611--REDEF
QI@SRCH_VRFY.CIP.T
     18746**DCL     18817--REDEF
QI@SRCH_VRFY.CIP.T.CA
     18749**DCL     18753--REDEF   18756--REDEF   18759--REDEF
QI@SRCH_VRFY.DATA
     18986**DCL     18990--REDEF
QI@SRCH_VRFY.DATA.AUX$
     18989**DCL     20017<<ASSIGN  20327<<ASSIGN  20431<<ASSIGN  20731<<ASSIGN
QI@SRCH_VRFY.DATA.S$
     18987**DCL     20015<<ASSIGN  20134<<ASSIGN  20383<<ASSIGN  20387<<ASSIGN  20391<<ASSIGN  20429<<ASSIGN
     20729<<ASSIGN
QI@SRCH_VRFY.DATA.T$
     18988**DCL     20016<<ASSIGN  20326<<ASSIGN  20430<<ASSIGN  20730<<ASSIGN
QI@SRCH_VRFY.DEC
     19054**DCL     19058--REDEF   19059--REDEF   19063--REDEF
QI@SRCH_VRFY.FILL_CHAR
     19110**DCL     19113--REDEF
QI@SRCH_VRFY.INX.AUX
     19062**DCL     20029<<ASSIGN  20033>>IF      20045<<ASSIGN  20049>>ASSIGN  20055<<ASSIGN  20055>>ASSIGN
     20085>>ASSIGN  20136<<ASSIGN  20393<<ASSIGN  20733<<ASSIGN
QI@SRCH_VRFY.ROUND
     19129**DCL     19130--REDEF   19131--REDEF
QI@SRCH_VRFY.SRCH_RESULT
     19070**DCL     19073--REDEF   19074--REDEF   19077--REDEF   19078--REDEF   19081--REDEF   20016--ASSIGN
     20430--ASSIGN  20730--ASSIGN
QI@SRCH_VRFY.SRCH_RESULT.DISP
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:177  
     19072**DCL     20029>>ASSIGN  20030>>ASSIGN  20055>>ASSIGN  20057>>ASSIGN  20437>>IF      20741>>ASSIGN
     20746>>ASSIGN
QI@SRCH_VRFY.SRCH_VRFY_ARGS
     18994**DCL     18998--REDEF   18999--REDEF   19003--REDEF   19004--REDEF   19008--REDEF
QI@SRCH_VRFY.SRCH_VRFY_ARGS.LIST_LEN
     18996**DCL     20135<<ASSIGN
QI@SRCH_VRFY.SRCH_VRFY_ELEMS
     19065**DCL     19068--REDEF
QI@SRCH_VRFY.SRCH_VRFY_ELEMS.LIST_LEN
     19067**DCL     20018<<ASSIGN  20030<<ASSIGN  20030>>ASSIGN  20046<<ASSIGN  20046>>ASSIGN  20050>>ASSIGN
     20057<<ASSIGN  20057>>ASSIGN  20139<<ASSIGN  20394<<ASSIGN  20432<<ASSIGN  20732<<ASSIGN
QI@SRCH_VRFY.VRFY_RESULT
     19074**DCL     20326--ASSIGN
QI@SRCH_VRFY.VRFY_RESULT.DISP
     19075**DCL     20045>>ASSIGN  20046>>ASSIGN  20447>>ASSIGN  20755>>ASSIGN  20760>>ASSIGN
QI_1.BASE
     10889**DCL     10896--REDEF
QI_1.BASE.DATA$
     10890**DCL     19634>>ASSIGN
QI_1.BASE.PROC$
     10892**DCL     19594>>ASSIGN  19980>>ASSIGN  20279>>ASSIGN  20794>>ASSIGN
QI_1.CURRENT.FILE$
     11780**DCL     11782--REDEF   11784--REDEF
QI_1.CURRENT.FILE_STATUS$
     11786**DCL     11788--REDEF   11790--REDEF
QI_1.CURRENT.FORM$
     11782**DCL     19594>>ASSIGN
QI_1.DAD
     11584**DCL     11589--REDEF
QI_1.FILE_HEAD
     11767**DCL     11774--REDEF
QI_1.IS_ALL_LIT
     11590**DCL     11595--REDEF
QI_1.IS_ALL_LIT.S
     11592**DCL     19772>>IF      19801>>IF
QI_1.IS_FORM_VARIABLE
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:178  
     11596**DCL     11601--REDEF
QI_1.IS_TEMP
     11602**DCL     11607--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP
     11700**DCL     11725--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.ALPHANUMERIC
     11702**DCL     11707--REDEF
QI_1.MESSAGE_LINE_DAD.PSEUDO_CIP.NUMERIC.CB
     11708**DCL     11711--REDEF   11714--REDEF
QI_1.MESSAGE_LINE_DAD.WORD0
     11669**DCL     11670--REDEF
QI_1.MESSAGE_LINE_GZ.HEADER$
     11746**DCL     20847>>ASSIGN
QI_1.OFFSET
     11608**DCL     11613--REDEF
QI_1.OFFSET_A
     11613**DCL     20304<<ASSIGN
QI_1.OP
     10967**DCL     19787<>CALL    20226<>CALL
QI_1.OP.CIP
     10969**DCL     11420--REDEF
QI_1.OP.CIP.AUX
     11335**DCL     11406--REDEF
QI_1.OP.CIP.AUX.CD
     11380**DCL     11383--REDEF   11387--REDEF   11390--REDEF
QI_1.OP.CIP.S
     11039**DCL     11110--REDEF
QI_1.OP.CIP.S.CA.OFFSET
     11088**DCL     19817>>ASSIGN
QI_1.OP.CIP.S.CD
     11084**DCL     11087--REDEF   11091--REDEF   11094--REDEF
QI_1.OP.CIP.S.CD.OFFSET
     11085**DCL     20213<<ASSIGN
QI_1.OP.CIP.S.CD.SIGN
     11086**DCL     20214<<ASSIGN
QI_1.OP.CIP.S.LEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:179  
     11098**DCL     19779>>ASSIGN  20215<<ASSIGN
QI_1.OP.CIP.S_A
     11110**DCL     20212<<ASSIGN
QI_1.OP.CIP.T
     11187**DCL     11258--REDEF
QI_1.OP.CIP.T.CA.OFFSET
     11236**DCL     19798<<ASSIGN  19819>>ASSIGN
QI_1.OP.CIP.T.CD
     11232**DCL     11235--REDEF   11239--REDEF   11242--REDEF
QI_1.OP.CIP.T.CD.OFFSET
     11233**DCL     19777<<ASSIGN  20219<<ASSIGN
QI_1.OP.CIP.T.CD.SIGN
     11234**DCL     19778<<ASSIGN  19780>>IF      19780>>IF      20220<<ASSIGN
QI_1.OP.CIP.T.LEN
     11246**DCL     19779<<ASSIGN  19783<<ASSIGN  19783>>ASSIGN  19793>>ASSIGN  20221<<ASSIGN
QI_1.OP.CIP.T_A
     11258**DCL     19776<<ASSIGN  19797<<ASSIGN  20218<<ASSIGN
QI_1.OP.DATA
     11427**DCL     11431--REDEF
QI_1.OP.DATA.S$
     11428**DCL     19817>>ASSIGN  20217<<ASSIGN
QI_1.OP.DATA.T$
     11429**DCL     19767<<ASSIGN  19819>>ASSIGN  20223<<ASSIGN
QI_1.OP.DATA_A$
     11431**DCL     20305<<ASSIGN
QI_1.OP.DEC.S
     11490**DCL     20216<<ASSIGN
QI_1.OP.DEC.T
     11491**DCL     19784<<ASSIGN  20222<<ASSIGN
QI_1.OP.FILL_CHAR
     11551**DCL     11554--REDEF
QI_1.OP.INX
     11484**DCL     11488--REDEF   11489--REDEF   11493--REDEF
QI_1.OP.INX.T
     11486**DCL     19799<<ASSIGN
QI_1.OP.LEN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:180  
     11467**DCL     11471--REDEF   11472--REDEF   11476--REDEF   11477--REDEF   11481--REDEF
QI_1.OP.LEN.AUX
     11470**DCL     12371--IMP-SIZ
QI_1.OP.LEN.S
     11468**DCL     12367--IMP-SIZ 19815>>ASSIGN  19822>>ASSIGN  19875<<ASSIGN  19880>>ASSIGN  20240<<ASSIGN
     20242>>IF      20669>>ASSIGN  20868<<ASSIGN  20876>>ASSIGN
QI_1.OP.LEN.T
     11469**DCL     12369--IMP-SIZ 19805<<ASSIGN  19815<<ASSIGN  19822>>ASSIGN  19825>>ASSIGN  19878<<ASSIGN
     19880>>ASSIGN  20574<<ASSIGN  20576>>ASSIGN  20641<<ASSIGN  20645<<ASSIGN  20647<<ASSIGN  20649>>ASSIGN
     20654>>ASSIGN  20659>>ASSIGN  20660>>ASSIGN  20674<<ASSIGN  20676<<ASSIGN  20678>>ASSIGN  20689>>ASSIGN
     20696>>ASSIGN  20704>>ASSIGN  20705>>ASSIGN  20873<<ASSIGN  20876>>ASSIGN
QI_1.OP.LEN_A
     11471**DCL     20303<<ASSIGN
QI_1.OP.PICTURE_STRING
     11537**DCL     11540--REDEF   11541--REDEF   11544--REDEF   11545--REDEF   11548--REDEF
QI_1.OP.ROUND
     11570**DCL     11571--REDEF   11572--REDEF
QI_1.OP.SIZE_ERROR
     11554**DCL     19785<<ASSIGN  20224<<ASSIGN
QI_1.OP.SRCH_VRFY_ELEMS
     11506**DCL     11509--REDEF
QI_1.OPENED_COUNT
     11775**DCL     11778--REDEF
QI_1.OTTER_SPACE
     11614**DCL     11619--REDEF
QI_1.OTTER_SPACE.T$
     11617**DCL     19555<<ASSIGN  19877>>ASSIGN  20017>>ASSIGN  20101>>IF      20101>>IF      20118>>IF
     20118>>IF      20162>>ASSIGN  20188>>ASSIGN  20217>>ASSIGN  20239>>ASSIGN  20305>>ASSIGN  20327>>ASSIGN
     20364>>ASSIGN  20431>>ASSIGN  20468>>IF      20520>>ASSIGN  20555>>IF      20741>>ASSIGN  20746>>ASSIGN
     20755>>ASSIGN  20760>>ASSIGN  20866>>ASSIGN
QI_1.PICTURE_STRING
     11620**DCL     11625--REDEF
QI_1.PICTURE_STRING_A$
     11625**DCL     20306<<ASSIGN
QI_1.SOURCE$
     10940**DCL     19761<<ASSIGN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:181  
QI_1.SPECIAL_NAMES
     11803**DCL     11812--REDEF
QI_1.TYPE
     11626**DCL     11631--REDEF
QI_1.TYPE.S
     11628**DCL     19769>>DOCASE
QI_16_BIT_BINARY
     16816**DCL     16886--REDEF
QI_16_BIT_BINARY.CB
     16835**DCL     16838--REDEF   16842--REDEF   16845--REDEF
QI_31_DIGIT_SLS_DISPLAY
     16649**DCL     16719--REDEF
QI_31_DIGIT_SLS_DISPLAY.CD
     16696**DCL     16699--REDEF   16703--REDEF   16706--REDEF
QI_31_DIGIT_ST_PACKED
     17151**DCL     17221--REDEF
QI_31_DIGIT_ST_PACKED.CP
     17184**DCL     17187--REDEF   17191--REDEF   17194--REDEF
QI_32_BIT_BINARY
     16983**DCL     17053--REDEF
QI_32_BIT_BINARY.CB
     17002**DCL     17005--REDEF   17009--REDEF   17012--REDEF
QI_4_CHAR_ALPHANUMERIC
     16481**DCL     16551--REDEF
QI_4_CHAR_ALPHANUMERIC.CA
     16486**DCL     16490--REDEF   16493--REDEF   16496--REDEF
QI_ACCUMULATOR_DAD.CIP
     17494**DCL     17565--REDEF
QI_ACCUMULATOR_DAD.CIP.CP
     17525**DCL     17528--REDEF   17532--REDEF   17535--REDEF
QI_ALR.CIP
     12446**DCL     12897--REDEF
QI_ALR.CIP.AUX
     12812**DCL     12883--REDEF
QI_ALR.CIP.AUX.CA
     12815**DCL     12819--REDEF   12822--REDEF   12825--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:182  
QI_ALR.CIP.S
     12516**DCL     12587--REDEF
QI_ALR.CIP.S.CA
     12519**DCL     12523--REDEF   12526--REDEF   12529--REDEF
QI_ALR.CIP.T
     12664**DCL     12735--REDEF
QI_ALR.CIP.T.CA
     12667**DCL     12671--REDEF   12674--REDEF   12677--REDEF
QI_ALR.DATA
     12904**DCL     12908--REDEF
QI_ALR.FILL_CHAR
     13028**DCL     13031--REDEF
QI_ALR.INX
     12961**DCL     12965--REDEF   12966--REDEF   12970--REDEF
QI_ALR.LEN
     12944**DCL     12948--REDEF   12949--REDEF   12953--REDEF   12954--REDEF   12958--REDEF
QI_ALR.PICTURE_STRING
     13014**DCL     13017--REDEF   13018--REDEF   13021--REDEF   13022--REDEF   13025--REDEF
QI_ALR.ROUND
     13047**DCL     13048--REDEF   13049--REDEF
QI_ALR.SRCH_VRFY_ELEMS
     12983**DCL     12986--REDEF
QI_BLANK
     11908**DCL     20015--ASSIGN  20383--ASSIGN
QI_CLASS_ALPHA
     12058**DCL     20338--ASSIGN  20505--ASSIGN
QI_CLASS_NUMERIC
     12092**DCL     20168--ASSIGN  20334--ASSIGN  20497--ASSIGN
QI_MAT
     15781**DCL     20161>>ASSIGN  20344>>ASSIGN  20519>>ASSIGN
QI_MAT.CIP
     15785**DCL     16236--REDEF
QI_MAT.CIP.AUX
     16151**DCL     16222--REDEF
QI_MAT.CIP.AUX.CA
     16154**DCL     16158--REDEF   16161--REDEF   16164--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:183  
QI_MAT.CIP.S
     15855**DCL     15926--REDEF
QI_MAT.CIP.S.CA
     15858**DCL     15862--REDEF   15865--REDEF   15868--REDEF
QI_MAT.CIP.T
     16003**DCL     16074--REDEF
QI_MAT.CIP.T.CA
     16006**DCL     16010--REDEF   16013--REDEF   16016--REDEF
QI_MAT.DATA
     16243**DCL     16247--REDEF
QI_MAT.DEC
     16311**DCL     16315--REDEF   16316--REDEF   16320--REDEF
QI_MAT.FILL_CHAR
     16367**DCL     16370--REDEF
QI_MAT.LEN
     16283**DCL     16287--REDEF   16288--REDEF   16292--REDEF   16293--REDEF   16297--REDEF
QI_MAT.PICTURE_STRING
     16353**DCL     16356--REDEF   16357--REDEF   16360--REDEF   16361--REDEF   16364--REDEF
QI_MAT.ROUND
     16386**DCL     16387--REDEF   16388--REDEF
QI_MAT.SRCH_VRFY_ELEMS
     16322**DCL     16325--REDEF
QI_MAT_MATCH
     11933**DCL     20172--ASSIGN  20195--ASSIGN  20371--ASSIGN  20530--ASSIGN
QI_MAT_NONMATCH
     11958**DCL     20729--ASSIGN
QI_OVERPUNCHED_SIGNS
     12126**DCL     20134--ASSIGN  20135--ASSIGN
QI_PICTURE_STRING
     17319**DCL     17389--REDEF
QI_PICTURE_STRING.CA
     17324**DCL     17328--REDEF   17331--REDEF   17334--REDEF
QI_SLASH
     11983**DCL     20391--ASSIGN
QI_SRCH_VRFY
     15112**DCL     20014>>ASSIGN  20325>>ASSIGN  20428>>ASSIGN  20728>>ASSIGN
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:184  
QI_SRCH_VRFY.CIP
     15116**DCL     15567--REDEF
QI_SRCH_VRFY.CIP.AUX
     15482**DCL     15553--REDEF
QI_SRCH_VRFY.CIP.AUX.CA
     15485**DCL     15489--REDEF   15492--REDEF   15495--REDEF
QI_SRCH_VRFY.CIP.S
     15186**DCL     15257--REDEF
QI_SRCH_VRFY.CIP.S.CA
     15189**DCL     15193--REDEF   15196--REDEF   15199--REDEF
QI_SRCH_VRFY.CIP.T
     15334**DCL     15405--REDEF
QI_SRCH_VRFY.CIP.T.CA
     15337**DCL     15341--REDEF   15344--REDEF   15347--REDEF
QI_SRCH_VRFY.DATA
     15574**DCL     15578--REDEF
QI_SRCH_VRFY.DEC
     15642**DCL     15646--REDEF   15647--REDEF   15651--REDEF
QI_SRCH_VRFY.FILL_CHAR
     15698**DCL     15701--REDEF
QI_SRCH_VRFY.ROUND
     15717**DCL     15718--REDEF   15719--REDEF
QI_SRCH_VRFY.SRCH_RESULT
     15658**DCL     15661--REDEF   15662--REDEF   15665--REDEF   15666--REDEF   15669--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ARGS
     15582**DCL     15586--REDEF   15587--REDEF   15591--REDEF   15592--REDEF   15596--REDEF
QI_SRCH_VRFY.SRCH_VRFY_ELEMS
     15653**DCL     15656--REDEF
QI_TYPE_BINARY_TARGET.CIP
     14443**DCL     14894--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX
     14809**DCL     14880--REDEF
QI_TYPE_BINARY_TARGET.CIP.AUX.CA
     14812**DCL     14816--REDEF   14819--REDEF   14822--REDEF
QI_TYPE_BINARY_TARGET.CIP.S
     14513**DCL     14584--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:185  
QI_TYPE_BINARY_TARGET.CIP.S.CA
     14516**DCL     14520--REDEF   14523--REDEF   14526--REDEF
QI_TYPE_BINARY_TARGET.CIP.T
     14661**DCL     14732--REDEF
QI_TYPE_BINARY_TARGET.CIP.T.CB
     14678**DCL     14681--REDEF   14685--REDEF   14688--REDEF
QI_TYPE_BINARY_TARGET.DATA
     14901**DCL     14905--REDEF
QI_TYPE_BINARY_TARGET.DEC
     14969**DCL     14973--REDEF   14974--REDEF   14978--REDEF
QI_TYPE_BINARY_TARGET.LEN
     14941**DCL     14945--REDEF   14946--REDEF   14950--REDEF   14951--REDEF   14955--REDEF
QI_TYPE_BINARY_TARGET.PICTURE_STRING
     15011**DCL     15014--REDEF   15015--REDEF   15018--REDEF   15019--REDEF   15022--REDEF
QI_TYPE_BINARY_TARGET.ROUND
     15044**DCL     15045--REDEF   15046--REDEF
QI_TYPE_BINARY_TARGET.SIZE_ERROR
     15030**DCL     15031--REDEF
QI_TYPE_BINARY_TARGET.SRCH_VRFY_ELEMS
     14980**DCL     14983--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP
     13111**DCL     13562--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX
     13477**DCL     13548--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.AUX.CA
     13480**DCL     13484--REDEF   13487--REDEF   13490--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S
     13181**DCL     13252--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.S.CD
     13226**DCL     13229--REDEF   13233--REDEF   13236--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T
     13329**DCL     13400--REDEF
QI_TYPE_DISPLAY_SOURCE.CIP.T.CA
     13332**DCL     13336--REDEF   13339--REDEF   13342--REDEF
QI_TYPE_DISPLAY_SOURCE.DATA
     13569**DCL     13573--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:186  
QI_TYPE_DISPLAY_SOURCE.DEC
     13637**DCL     13641--REDEF   13642--REDEF   13646--REDEF
QI_TYPE_DISPLAY_SOURCE.LEN
     13609**DCL     13613--REDEF   13614--REDEF   13618--REDEF   13619--REDEF   13623--REDEF
QI_TYPE_DISPLAY_SOURCE.PICTURE_STRING
     13679**DCL     13682--REDEF   13683--REDEF   13686--REDEF   13687--REDEF   13690--REDEF
QI_TYPE_DISPLAY_SOURCE.ROUND
     13712**DCL     13713--REDEF   13714--REDEF
QI_TYPE_DISPLAY_SOURCE.SIZE_ERROR
     13698**DCL     13699--REDEF
QI_TYPE_DISPLAY_SOURCE.SRCH_VRFY_ELEMS
     13648**DCL     13651--REDEF
QI_TYPE_DISPLAY_TARGET.CIP
     13777**DCL     14228--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX
     14143**DCL     14214--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.AUX.CA
     14146**DCL     14150--REDEF   14153--REDEF   14156--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S
     13847**DCL     13918--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.S.CA
     13850**DCL     13854--REDEF   13857--REDEF   13860--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T
     13995**DCL     14066--REDEF
QI_TYPE_DISPLAY_TARGET.CIP.T.CD
     14040**DCL     14043--REDEF   14047--REDEF   14050--REDEF
QI_TYPE_DISPLAY_TARGET.DATA
     14235**DCL     14239--REDEF
QI_TYPE_DISPLAY_TARGET.DEC
     14303**DCL     14307--REDEF   14308--REDEF   14312--REDEF
QI_TYPE_DISPLAY_TARGET.LEN
     14275**DCL     14279--REDEF   14280--REDEF   14284--REDEF   14285--REDEF   14289--REDEF
QI_TYPE_DISPLAY_TARGET.PICTURE_STRING
     14345**DCL     14348--REDEF   14349--REDEF   14352--REDEF   14353--REDEF   14356--REDEF
QI_TYPE_DISPLAY_TARGET.ROUND
     14378**DCL     14379--REDEF   14380--REDEF
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:187  
QI_TYPE_DISPLAY_TARGET.SIZE_ERROR
     14364**DCL     14365--REDEF
QI_TYPE_DISPLAY_TARGET.SRCH_VRFY_ELEMS
     14314**DCL     14317--REDEF
QI_ZERO
     12008**DCL     20387--ASSIGN
REPLACE_FIELD_DATA
     20864**PROC    20318--CALL    20409--CALL    20583--CALL
RETRY_FIELD_POST_EDITING
     19688**LABEL   20861--GOTO
SETUP_AE_CLASS_CHECK
     20344**LABEL   20335--GOTO    20339--GOTO
SIGN_ONLY_IN_DISPLAY
     20629**LABEL   20110--GOTO    20126--GOTO
SOURCE_INDEX
     17796**DCL     20249<<ASSIGN  20447<<ASSIGN  20448>>ASSIGN  20521>>ASSIGN  20564>>ASSIGN  20866>>ASSIGN
SO_VIOLATE_IT_ALREADY
     20728**LABEL   20718--GOTO
STARTING_INDEX
     17797**DCL     20716<<ASSIGN  20725<<ASSIGN  20741>>ASSIGN
STRIP_LEADING_FILL_CHARACTER
     20440**LABEL   20451--EXIT
STRIP_TRAILING_BLANKS
     20553**LABEL   20560--EXIT
STRIP_TRAILING_FILL_CHARACTER
     20466**LABEL   20473--EXIT
TARGET_INDEX
     17798**DCL     20250<<ASSIGN  20558<<ASSIGN  20558>>ASSIGN  20564<<ASSIGN  20564>>ASSIGN  20567>>IF
     20574>>ASSIGN  20870>>ASSIGN  20873>>ASSIGN
THIS_MOP_FUNCTIONS_LENGTH
     17799**DCL     20355<<ASSIGN  20366>>ASSIGN  20394>>ASSIGN  20401>>ASSIGN
U$1
     17800**DCL     20832<>CALL
U1
     17803**DCL     20662--ASSIGN  20707--ASSIGN  20747--ASSIGN  20761--ASSIGN
U1.LENGTH
PL6.E3A0      #001=QCR$READ File=QCR$READ.:E05TSI                                WED 07/30/97 05:13 Page:188  
     17804**DCL     20659<<ASSIGN  20704<<ASSIGN  20745<<ASSIGN  20759<<ASSIGN
U1.TEXT
     17805**DCL     20660<<ASSIGN  20705<<ASSIGN  20746<<ASSIGN  20760<<ASSIGN
U1$
     17806**DCL     17800--IMP-PTR 20612<<ASSIGN  20618<<ASSIGN  20624<<ASSIGN  20630<<ASSIGN  20662<<ASSIGN
     20707<<ASSIGN  20747<<ASSIGN  20761<<ASSIGN  20832>>CALL
VARIABLE_SOURCE$
     17807**DCL     19817<<ASSIGN  19822>>ASSIGN  19873<<ASSIGN  19880>>ASSIGN  20239<<ASSIGN  20242>>IF
     20866<<ASSIGN  20876>>ASSIGN
VARIABLE_TARGET$
     17808**DCL     19819<<ASSIGN  19822>>ASSIGN  19877<<ASSIGN  19880>>ASSIGN  20572<<ASSIGN  20576>>ASSIGN
     20870<<ASSIGN  20876>>ASSIGN
VRFY_IT
     20393**LABEL   20384--GOTO    20388--GOTO
WE_GOTTA_DEFAULT_VALUE
     17809**DCL     19834<<ASSIGN  19855<<ASSIGN  20770>>IF
WE_GOTTA_FILL_CHARACTER
     17810**DCL     19901<<ASSIGN  19903<<ASSIGN  19908<<ASSIGN  20417>>IF
