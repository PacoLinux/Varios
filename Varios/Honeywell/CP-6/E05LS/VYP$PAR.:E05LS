VERSION E05

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:1    
        1        1        /*M* VYP$PAR - interface with X$PARSE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,PLM=6,IND=4,SDI=2,CTI=8,DCI=4,CSU=2,ECU=2,ENI=4,
        8        8              THI=0,DTI=0,IAD=0,CCC                          */
        9        9        /*
       10       10              Type dcb  meaning
       11       11
       12       12               0   M$SI lemur command lines
       13       13               2   M$UC correcting file name
       14       14
       15       15        */
       16       16        VYP$PAR: PROC( TYPE, SYN_ROOT$, WKSZ ) ALTRET;
       17       17        /*
       18       18                  Include files
       19       19        */
       20       20        %INCLUDE VY_INC_C;
       21     9196        %INCLUDE B$JIT;
       22     9486        %INCLUDE XU_SUBS_C;
       23     9578        %INCLUDE XU_PERR_C;
       24     9769        %SET LISTMAC='1'B;
       25     9770        %P;
              9771        %LSET LISTDIR='0'B;

              9778    1   /*******************************************************************************
              9779    1   *                                                                              *
              9780    1   *                          PARAMETERS                                              *
              9781    1   *                                                                              *
              9782    1   *******************************************************************************/

       26     9786    1   DCL TYPE            SBIN WORD ALIGNED;
       27     9787    1   DCL SYN_ROOT$       PTR  ALIGNED;
       28     9788    1   DCL WKSZ            SBIN WORD ALIGNED;
       29     9789        %E;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:2    
              9790        %LSET LISTDIR='0'B;

              9797    1   /*******************************************************************************
              9798    1   *                                                                              *
              9799    1   *                          ENTRY                                                 *
              9800    1   *                                                                              *
              9801    1   *******************************************************************************/

       30     9805        %ENTRIES;
              9806    1   DCL VYE$ERROR       ENTRY(4);
              9807    1   DCL VYE$ERR         ENTRY(3);
              9808    1   DCL VYE$MERC        ENTRY;
              9809    1   DCL VYE$ERRMSG      ENTRY(1);
              9810    1   DCL VYR$READ        ENTRY( 3 ) ALTRET;
              9811    1   DCL VYW$WRITE       ENTRY( 3 ) ALTRET;
              9812    1   DCL VYW$WRITE_DO    ENTRY( 2 ) ALTRET;
              9813    1   DCL VYD$B2C         ENTRY( 5 );
              9814    1   DCL VYD$C2B         ENTRY( 3 );
              9815    1   DCL VYA$GET         ENTRY( 3 );
              9816    1   DCL VYF$FREE        ENTRY( 3 );
              9817    1   DCL VYQ$SORT        ENTRY( 7 );
              9818    1   DCL VYY$YESNO       ENTRY( 1 );
       31     9820        %ENTRIES_IO;
              9821    1   DCL VYF$OPEN        ENTRY(4)    ALTRET;
              9822    1   DCL VYF$CLOSE       ENTRY(3);
              9823    1   DCL VYU$PREAD       ENTRY(12)  ALTRET;
              9824    1   DCL VYK$KEY         ENTRY(4);
              9825    1   DCL VYI$READ        ENTRY(5)  ALTRET;
              9826    1   DCL VYI$WRITE       ENTRY(5)  ALTRET;
              9827    1   DCL VYI$WRITE_C     ENTRY(5)  ALTRET;
       32     9829    1   DCL VYI$EXIT        ENTRY;
       33     9830    1   DCL X$PARSE                   ENTRY(1)  ALTRET;
       34     9831        %PTR;
              9832        %LSET LISTDIR='0'B;

              9839    1   /*******************************************************************************
              9840    1   *                                                                              *
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:3    
              9841    1   *                          PTR                                                 *
              9842    1   *                                                                              *
              9843    1   *******************************************************************************/

       35     9847        %POINTER;
              9848    1   DCL P$         PTR       ALIGNED STATIC/*AUTO*/;
              9849    1   DCL Q$         PTR       ALIGNED STATIC/*AUTO*/;
              9850    1   DCL R$         PTR       ALIGNED STATIC/*AUTO*/;
       36     9852    1   DCL WORK$           PTR  ALIGNED STATIC;
       37     9853    1   DCL NEXT$           PTR  ALIGNED STATIC;
       38     9854    1   DCL START$          PTR  ALIGNED STATIC;
       39     9855    1   DCL PARSE_PARAM$    PTR  ALIGNED STATIC;
       40     9856    1   DCL DUMMY$          PTR  ALIGNED STATIC;
       41     9857        %S;
              9858        %LSET LISTDIR='0'B;

              9865    1   /*******************************************************************************
              9866    1   *                                                                              *
              9867    1   *                          SBIN                                                 *
              9868    1   *                                                                              *
              9869    1   *******************************************************************************/

       42     9873    1   DCL I               SBIN WORD  ALIGNED STATIC/*AUTO*/;
       43     9874    1   DCL J               SBIN WORD  ALIGNED STATIC/*AUTO*/;
       44     9875    1   DCL K               SBIN WORD  ALIGNED STATIC/*AUTO*/;
       45     9876    1   DCL GSIZE           SBIN WORD  ALIGNED STATIC;
       46     9877    1   DCL SIZE            SBIN WORD  ALIGNED STATIC;
       47     9878    1   DCL ALL_SIZE        SBIN WORD  ALIGNED STATIC;
       48     9879    1   DCL CPOS            SBIN WORD  ALIGNED STATIC;
       49     9880    1   DCL CHAR_COUNT      SBIN WORD  ALIGNED STATIC;
       50     9881    1   DCL PWKSZ           SBIN WORD  ALIGNED STATIC;
       51     9882    1   DCL DCB_TYPE        SBIN WORD  ALIGNED STATIC;
       52     9883        %BANNER( ARG=BASED );
              9884        %LSET LISTDIR='0'B;

              9891    1   /*******************************************************************************
              9892    1   *                                                                              *
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:4    
              9893    1   *                          BASED                                                 *
              9894    1   *                                                                              *
              9895    1   *******************************************************************************/

       53     9899        %SET LISTSUB='1'B;
       54     9900    1   DCL C$CHAR    CHAR(256) BASED;
       55     9901    1   DCL CHAR$STR  CHAR(CHAR_COUNT) BASED(START$);
       56     9902        %SET LISTMAC='0'B;
       57     9903        %PARSE$PARAM( NAME=PARSE$PARAM, STCLASS="BASED(PARSE_PARAM$)" );
       58     9984        %F$DCB;
       59    10041        %C;

             10049    1   /*******************************************************************************
             10050    1   *                                                                              *
             10051    1   *                          CHAR                                                 *
             10052    1   *                                                                              *
             10053    1   *******************************************************************************/

       60    10057    1   DCL ENTER_FILE_NAME CHAR(0) CONSTANT INIT(
       61    10058    1   'Enter correct file name. ( Return = start new command).' );
       62    10059    1   DCL TWOCHARS CHAR(2) STATIC;
       63    10060        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:5    
       64    10061    1         DCB_TYPE = TYPE;
       65    10062    1         WORK$ = ADDR(NIL);
       66    10063    1         GSIZE = WKSZ;
       67    10064              %ALLOCATE(PTR$=START$, TYPE=@GDP, SIZE=GSIZE);
       68    10071    2         DO INHIBIT;
       69    10072    2             REMEMBER READ_COMMAND IN VY_PAR_UNWIND;
       70    10073    2             END;
       71    10074    1   READ_COMMAND:
       72    10075    1         IF DCB_TYPE = 2 /* M$UC */ THEN
       73    10076    1             CALL VYW$WRITE( ENTER_FILE_NAME, LENGTHC(ENTER_FILE_NAME), 0 );
       74    10077    1         CALL VYR$READ( START$ -> C$CHAR, SIZE, DCB_TYPE ) ALTRET(EOF);
       75    10078    2         DO WHILE( '0'B );
       76    10079    2   EOF:      CALL VYI$EXIT;
       77    10080    2             END;
       78    10081
       79    10082    2         IF VY_SYNTAX_ERR THEN DO;
       80    10083    2             VY_SYNTAX_ERR = '0'B;
       81    10084    3             IF SIZE = 1 AND SUBSTR(CHAR$STR,0,1) = '?' THEN DO;
       82    10085    3                 SUBSTR(CHAR$STR,0,2) = TWOCHARS;
       83    10086    3                 VY_P_PCB_MAIN.NXT = '1'B;
       84    10087    3                 CALL X$PARSE( VY_P_PCB_MAIN );
       85    10088    3                 VY_P_PCB_MAIN.NXT = '0'B;
       86    10089    3                 GOTO READ_COMMAND;
       87    10090    3                 END;
       88    10091    2             END;
       89    10092    1         NEXT$ = START$;
       90    10093    1         CPOS = 0;
       91    10094    1         CHAR_COUNT = SIZE;
       92    10095        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:6    
       93    10096    1         VY_P_PCB_MAIN.ROOT$ = SYN_ROOT$;
       94    10097    1         VY_P_PCB_MAIN.TEXT$ = START$;
       95    10098    1         VY_P_PCB_MAIN.NCHARS = CHAR_COUNT;
       96    10099    2         IF WORK$ = ADDR(NIL) THEN DO;
       97    10100    2             ALL_SIZE = 7 * CHAR_COUNT + 100;  /* Compute work area ALL_SIZE */
       98    10101    2             PWKSZ = ALL_SIZE;                 /* Remember initial allocation */
       99    10102                  %ALLOCATE( PTR$=WORK$, TYPE=@DS3, SIZE=ALL_SIZE);
      100    10109    2             VY_P_PCB_MAIN.WORK$ = WORK$;
      101    10110    2             END;
      102    10111    1   AGAIN:
      103    10112    1         VY_P_PCB_MAIN.WKSZ = ALL_SIZE;
      104    10113    1         CALL X$PARSE( VY_P_PCB_MAIN )           ALTRET( PARSE_ERR );
      105    10114    2         DO INHIBIT;
      106    10115    2             VY_PAR_UNWIND_B = '0'B;
      107    10116    2             END;
      108    10117    1         WKSZ = ALL_SIZE;
      109    10118    1         CALL VYF$FREE( 8/*@GDP*/, GSIZE, 0 );
      110    10119    1         RETURN;
      111    10120
      112    10121        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:7    
      113    10122    1   PARSE_ERR:
      114    10123    2         DO CASE( VY_P_PCB_MAIN.ERROR.CODE );
      115    10124    2           CASE( 4, 5 );
      116    10125    2             PWKSZ      = PWKSZ   + PWKSZ; /* Double and get */
      117    10126                  %ALLOCATE( PTR$=DUMMY$, TYPE=@DS3, SIZE=PWKSZ);
      118    10133    2             ALL_SIZE = ALL_SIZE + PWKSZ;  /* Correct for total allocated */
      119    10134    2             GOTO AGAIN;                   /* Go try again     */
      120    10135    2           CASE( 1 );
      121    10136    2             IF VY_DO_ECHO  AND  ~ (M$SI$->F$DCB.DDEV.IC# & M$DO$->F$DCB.DDEV.IC#)
      122    10137    2             THEN CALL VYW$WRITE_DO( VY_LAST_LINE.TEXT, VY_LAST_LINE.SIZE );
      123    10138    2             J = VY_P_PCB_MAIN.HI_CHAR;
      124    10139    2             K = J + VY_LAST_LINE.OFFSET - CPOS + 1;
      125    10140    3             IF J >= CPOS AND K <= 120 THEN DO;
      126    10141        /*E*  ERROR: VYP-E$SYNTAX_ERROR_VY-0
      127    10142              MESSAGE:     Syntax error.
      128    10143              DESCRIPTION: Self-explanatory.
      129    10144        */
      130    10145    3                 VY_FPT_ERRMSG.V.POINTER# = K;
      131    10146                      %SCREAM( ERR#=%E$SYNTAX_ERROR_VY, MID="'P'", LEVEL=%@E$F_D_VY );
      132    10149    3                 VY_FPT_ERRMSG.V.POINTER# = 0;
      133    10150    3                 END;
      134    10151    3             ELSE DO;
      135    10152        /*E*  ERROR: VYP-E$ILLEGAL_SYNTAX_VY-0
      136    10153              MESSAGE: Illegal syntax detected at: %U1<?>%U2
      137    10154              DESCRIPTION: Self-explanatory.
      138    10155        */
      139    10156    3                 K = MAXIMUM( 0, J - 16 );
      140    10157    3                 VY_EFIELD1.COUNT = J - K;
      141    10158    3                 VY_EFIELD1.CHARS = SUBSTR( CHAR$STR, K );
      142    10159    3                 VY_EFIELD2.COUNT = MINIMUM( 15, CHAR_COUNT - J );
      143    10160    3                 VY_EFIELD2.CHARS = SUBSTR( CHAR$STR, J );
      144    10161                      %SCREAM( ERR#=%E$ILLEGAL_SYNTAX_VY, MID="'P'", LEVEL=%@E$F_D_VY );
      145    10164    3                 END;
      146    10165    2             VY_SYNTAX_ERR = '1'B;
      147    10166    2             TWOCHARS = SUBSTR(CHAR$STR, 0, 2);
      148    10167    2             GOTO READ_COMMAND;
      149    10168    2           CASE( ELSE );                   /* Open question */
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:8    
      150    10169    2             CALL VYE$ERRMSG( VY_P_PCB_MAIN.ERROR );
      151    10170    2           END;
      152    10171
      153    10172        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:9    
      154    10173    1   VYP$PAR_U: ENTRY(TYPE) ALTRET;
      155    10174
      156    10175    1         PARSE_PARAM$ = ADDR(TYPE);
      157    10176    2         IF PARSE$PARAM.TYPE = 4 THEN DO;
      158    10177    2             CPOS = PARSE$PARAM.CHARPOS + 1;
      159    10178    2             CHAR_COUNT = CPOS;
      160    10179    2             NEXT$ = PINCRC(START$, CHAR_COUNT);
      161    10180    3             IF CHAR_COUNT + 256 > GSIZE*4 THEN DO;
      162    10181                      %ALLOCATE( PTR$=DUMMY$, TYPE=@GDP, SIZE=@PAGE_SIZE );
      163    10188    3                 GSIZE = GSIZE + 1024/*@PAGE_SIZE*/;
      164    10189    3                 END;
      165    10190    2             CALL VYR$READ( NEXT$ -> C$CHAR, SIZE, DCB_TYPE );
      166    10191    2             CHAR_COUNT = CHAR_COUNT + SIZE;
      167    10192    2             VY_P_PCB_MAIN.NCHARS = CHAR_COUNT;
      168    10193    2             PARSE$PARAM.RETRY = '1'B;
      169    10194    2             END;
      170    10195
      171    10196    1         RETURN;
      172    10197
      173    10198
      174    10199    1   END VYP$PAR;

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:10   
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYP$PAR.

   Procedure VYP$PAR requires 307 words for executable code.
   Procedure VYP$PAR requires 10 words of local(AUTO) storage.

    No errors detected in file VYP$PAR.:E05TSI    .

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:11   

 Object Unit name= VYP$PAR                                    File name= VYP$PAR.:E05TOU
 UTS= JUL 30 '97 08:59:53.68 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    19     23  VYP$PAR
    2  RoData even  UTS     14     16  VYP$PAR
    3   Proc  even  none   307    463  VYP$PAR
    4  RoData even  none    40     50  VYP$PAR

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes    yes     yes      Std        3  VYP$PAR
     3    371          yes     yes      Std        1  VYP$PAR_U
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:12   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 VYA$GET
 yes     yes           Std       3 VYW$WRITE
 yes     yes           Std       3 VYR$READ
         yes           Std       0 VYI$EXIT
 yes     yes           Std       2 VYW$WRITE_DO
         yes           Std       3 VYF$FREE
         yes           Std       1 VYE$ERRMSG
 yes     yes           Std       1 X$PARSE
         yes           Std       4 VYE$ERROR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VY_FPT_ERRMSG                         VY_P_PCB_MAIN
     B$JIT$                                VY_ERRORS                             VY_M_FREE
     VY_M_ALL                              VY_M_BASE_PTR                         VY_EFIELD1
     VY_EFIELD2                            VY_SYNTAX_ERR                         VY_DO_ECHO
     VY_LAST_LINE                          VY_PAR_UNWIND                         M$SI$
     M$DO$                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:13   


        1        1        /*M* VYP$PAR - interface with X$PARSE */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,PLM=6,IND=4,SDI=2,CTI=8,DCI=4,CSU=2,ECU=2,ENI=4,
        8        8              THI=0,DTI=0,IAD=0,CCC                          */
        9        9        /*
       10       10              Type dcb  meaning
       11       11
       12       12               0   M$SI lemur command lines
       13       13               2   M$UC correcting file name
       14       14
       15       15        */
       16       16        VYP$PAR: PROC( TYPE, SYN_ROOT$, WKSZ ) ALTRET;

     16  3 000000   000000 700200 xent  VYP$PAR      TSX0  ! X66_AUTO_3
         3 000001   000012 000003                    ZERO    10,3

       17       17        /*
       18       18                  Include files
       19       19        */
       20       20        %INCLUDE VY_INC_C;
       21     9196        %INCLUDE B$JIT;
       22     9486        %INCLUDE XU_SUBS_C;
       23     9578        %INCLUDE XU_PERR_C;
       24     9769        %SET LISTMAC='1'B;
       25     9770        %P;
              9771        %LSET LISTDIR='0'B;

              9778    1   /*******************************************************************************
              9779    1   *                                                                              *
              9780    1   *                          PARAMETERS                                             *
              9781    1   *                                                                              *
              9782    1   *******************************************************************************/
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:14   

       26     9786    1   DCL TYPE            SBIN WORD ALIGNED;
       27     9787    1   DCL SYN_ROOT$       PTR  ALIGNED;
       28     9788    1   DCL WKSZ            SBIN WORD ALIGNED;
       29     9789        %E;
              9790        %LSET LISTDIR='0'B;

              9797    1   /*******************************************************************************
              9798    1   *                                                                              *
              9799    1   *                          ENTRY                                                 *
              9800    1   *                                                                              *
              9801    1   *******************************************************************************/

       30     9805        %ENTRIES;
              9806    1   DCL VYE$ERROR       ENTRY(4);
              9807    1   DCL VYE$ERR         ENTRY(3);
              9808    1   DCL VYE$MERC        ENTRY;
              9809    1   DCL VYE$ERRMSG      ENTRY(1);
              9810    1   DCL VYR$READ        ENTRY( 3 ) ALTRET;
              9811    1   DCL VYW$WRITE       ENTRY( 3 ) ALTRET;
              9812    1   DCL VYW$WRITE_DO    ENTRY( 2 ) ALTRET;
              9813    1   DCL VYD$B2C         ENTRY( 5 );
              9814    1   DCL VYD$C2B         ENTRY( 3 );
              9815    1   DCL VYA$GET         ENTRY( 3 );
              9816    1   DCL VYF$FREE        ENTRY( 3 );
              9817    1   DCL VYQ$SORT        ENTRY( 7 );
              9818    1   DCL VYY$YESNO       ENTRY( 1 );
       31     9820        %ENTRIES_IO;
              9821    1   DCL VYF$OPEN        ENTRY(4)    ALTRET;
              9822    1   DCL VYF$CLOSE       ENTRY(3);
              9823    1   DCL VYU$PREAD       ENTRY(12)  ALTRET;
              9824    1   DCL VYK$KEY         ENTRY(4);
              9825    1   DCL VYI$READ        ENTRY(5)  ALTRET;
              9826    1   DCL VYI$WRITE       ENTRY(5)  ALTRET;
              9827    1   DCL VYI$WRITE_C     ENTRY(5)  ALTRET;
       32     9829    1   DCL VYI$EXIT        ENTRY;
       33     9830    1   DCL X$PARSE                   ENTRY(1)  ALTRET;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:15   
       34     9831        %PTR;
              9832        %LSET LISTDIR='0'B;

              9839    1   /*******************************************************************************
              9840    1   *                                                                              *
              9841    1   *                          PTR                                                 *
              9842    1   *                                                                              *
              9843    1   *******************************************************************************/

       35     9847        %POINTER;
              9848    1   DCL P$         PTR       ALIGNED STATIC/*AUTO*/;
              9849    1   DCL Q$         PTR       ALIGNED STATIC/*AUTO*/;
              9850    1   DCL R$         PTR       ALIGNED STATIC/*AUTO*/;
       36     9852    1   DCL WORK$           PTR  ALIGNED STATIC;
       37     9853    1   DCL NEXT$           PTR  ALIGNED STATIC;
       38     9854    1   DCL START$          PTR  ALIGNED STATIC;
       39     9855    1   DCL PARSE_PARAM$    PTR  ALIGNED STATIC;
       40     9856    1   DCL DUMMY$          PTR  ALIGNED STATIC;
       41     9857        %S;
              9858        %LSET LISTDIR='0'B;

              9865    1   /*******************************************************************************
              9866    1   *                                                                              *
              9867    1   *                          SBIN                                                 *
              9868    1   *                                                                              *
              9869    1   *******************************************************************************/

       42     9873    1   DCL I               SBIN WORD  ALIGNED STATIC/*AUTO*/;
       43     9874    1   DCL J               SBIN WORD  ALIGNED STATIC/*AUTO*/;
       44     9875    1   DCL K               SBIN WORD  ALIGNED STATIC/*AUTO*/;
       45     9876    1   DCL GSIZE           SBIN WORD  ALIGNED STATIC;
       46     9877    1   DCL SIZE            SBIN WORD  ALIGNED STATIC;
       47     9878    1   DCL ALL_SIZE        SBIN WORD  ALIGNED STATIC;
       48     9879    1   DCL CPOS            SBIN WORD  ALIGNED STATIC;
       49     9880    1   DCL CHAR_COUNT      SBIN WORD  ALIGNED STATIC;
       50     9881    1   DCL PWKSZ           SBIN WORD  ALIGNED STATIC;
       51     9882    1   DCL DCB_TYPE        SBIN WORD  ALIGNED STATIC;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:16   
       52     9883        %BANNER( ARG=BASED );
              9884        %LSET LISTDIR='0'B;

              9891    1   /*******************************************************************************
              9892    1   *                                                                              *
              9893    1   *                          BASED                                                 *
              9894    1   *                                                                              *
              9895    1   *******************************************************************************/

       53     9899        %SET LISTSUB='1'B;
       54     9900    1   DCL C$CHAR    CHAR(256) BASED;
       55     9901    1   DCL CHAR$STR  CHAR(CHAR_COUNT) BASED(START$);
       56     9902        %SET LISTMAC='0'B;
       57     9903        %PARSE$PARAM( NAME=PARSE$PARAM, STCLASS="BASED(PARSE_PARAM$)" );
       58     9984        %F$DCB;
       59    10041        %C;

             10049    1   /*******************************************************************************
             10050    1   *                                                                              *
             10051    1   *                          CHAR                                                 *
             10052    1   *                                                                              *
             10053    1   *******************************************************************************/

       60    10057    1   DCL ENTER_FILE_NAME CHAR(0) CONSTANT INIT(
       61    10058    1   'Enter correct file name. ( Return = start new command).' );
       62    10059    1   DCL TWOCHARS CHAR(2) STATIC;
       63    10060        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:17   
       64    10061    1         DCB_TYPE = TYPE;

  10061  3 000002   200003 470500                    LDP0    @TYPE,,AUTO
         3 000003   000000 235100                    LDA     0,,PR0
         3 000004   000021 755000 1                  STA     DCB_TYPE

       65    10062    1         WORK$ = ADDR(NIL);

  10062  3 000005   000001 236000 xsym               LDQ     B_VECTNIL+1
         3 000006   000003 756000 1                  STQ     WORK$

       66    10063    1         GSIZE = WKSZ;

  10063  3 000007   200005 471500                    LDP1    @WKSZ,,AUTO
         3 000010   100000 235100                    LDA     0,,PR1
         3 000011   000013 755000 1                  STA     GSIZE

       67    10064              %ALLOCATE(PTR$=START$, TYPE=@GDP, SIZE=GSIZE);

  10065  3 000012   000010 236000 xsym               LDQ     VY_M_ALL+8
         3 000013   000010 136000 xsym               SBLQ    VY_M_FREE+8
         3 000014   000013 116000 1                  CMPQ    GSIZE
         3 000015   000026 604000 3                  TMI     s:10069

  10066  3 000016   000010 236000 xsym               LDQ     VY_M_FREE+8
         3 000017   000022 736000                    QLS     18
         3 000020   000010 036000 xsym               ADLQ    VY_M_BASE_PTR+8
         3 000021   000005 756000 1                  STQ     START$

  10067  3 000022   000010 236000 xsym               LDQ     VY_M_FREE+8
         3 000023   000013 036000 1                  ADLQ    GSIZE
         3 000024   000010 756000 xsym               STQ     VY_M_FREE+8

  10068  3 000025   000032 710000 3                  TRA     s:10072

  10069  3 000026   000000 630400 4                  EPPR0   0
         3 000027   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:18   
         3 000030   000000 701000 xent               TSX1    VYA$GET
         3 000031   000000 011000                    NOP     0

       68    10071    2         DO INHIBIT;

       69    10072    2             REMEMBER READ_COMMAND IN VY_PAR_UNWIND;

  10072  3 000032   000035 635200 3                  EAA   ! READ_COMMAND
         3 000033   000000 452600 xsym               STP2  ! VY_PAR_UNWIND
         3 000034   000001 755200 xsym               STA   ! VY_PAR_UNWIND+1

       70    10073    2             END;

       71    10074    1   READ_COMMAND:
       72    10075    1         IF DCB_TYPE = 2 /* M$UC */ THEN

  10075  3 000035   000021 235000 1     READ_COMMAND LDA     DCB_TYPE
         3 000036   000002 115007                    CMPA    2,DL
         3 000037   000044 601000 3                  TNZ     s:10077

       73    10076    1             CALL VYW$WRITE( ENTER_FILE_NAME, LENGTHC(ENTER_FILE_NAME), 0 );

  10076  3 000040   000004 630400 4                  EPPR0   4
         3 000041   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000042   000000 701000 xent               TSX1    VYW$WRITE
         3 000043   000000 011000                    NOP     0

       74    10077    1         CALL VYR$READ( START$ -> C$CHAR, SIZE, DCB_TYPE ) ALTRET(EOF);

  10077  3 000044   000007 236000 4                  LDQ     7
         3 000045   200010 756100                    STQ     @WKSZ+3,,AUTO
         3 000046   000010 236000 4                  LDQ     8
         3 000047   000005 235000 1                  LDA     START$
         3 000050   200006 757100                    STAQ    @WKSZ+1,,AUTO
         3 000051   200006 630500                    EPPR0   @WKSZ+1,,AUTO
         3 000052   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000053   000000 701000 xent               TSX1    VYR$READ
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:19   
         3 000054   000056 702000 3                  TSX2    EOF

       75    10078    2         DO WHILE( '0'B );

  10078  3 000055   000061 710000 3                  TRA     s:10082

       76    10079    2   EOF:      CALL VYI$EXIT;

  10079  3 000056   000002 631400 xsym  EOF          EPPR1   B_VECTNIL+2
         3 000057   000000 701000 xent               TSX1    VYI$EXIT
         3 000060   000000 011000                    NOP     0

       77    10080    2             END;

       78    10081
       79    10082    2         IF VY_SYNTAX_ERR THEN DO;

  10082  3 000061   000000 234000 xsym               SZN     VY_SYNTAX_ERR
         3 000062   000110 605000 3                  TPL     s:10092

       80    10083    2             VY_SYNTAX_ERR = '0'B;

  10083  3 000063   000000 450000 xsym               STZ     VY_SYNTAX_ERR

       81    10084    3             IF SIZE = 1 AND SUBSTR(CHAR$STR,0,1) = '?' THEN DO;

  10084  3 000064   000014 235000 1                  LDA     SIZE
         3 000065   000001 115007                    CMPA    1,DL
         3 000066   000110 601000 3                  TNZ     s:10092
         3 000067   000005 470400 1                  LDP0    START$
         3 000070   040000 106500                    CMPC    fill='040'O
         3 000071   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         3 000072   000011 000001 4                  ADSC9   9                        cn=0,n=1
         3 000073   000110 601000 3                  TNZ     s:10092

       82    10085    3                 SUBSTR(CHAR$STR,0,2) = TWOCHARS;

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:20   
  10085  3 000074   040100 100400                    MLR     fill='040'O
         3 000075   000022 000002 1                  ADSC9   TWOCHARS                 cn=0,n=2
         3 000076   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2

       83    10086    3                 VY_P_PCB_MAIN.NXT = '1'B;

  10086  3 000077   040000 236007                    LDQ     16384,DL
         3 000100   000005 256000 xsym               ORSQ    VY_P_PCB_MAIN+5

       84    10087    3                 CALL X$PARSE( VY_P_PCB_MAIN );

  10087  3 000101   000012 630400 4                  EPPR0   10
         3 000102   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000103   000000 701000 xent               TSX1    X$PARSE
         3 000104   000000 011000                    NOP     0

       85    10088    3                 VY_P_PCB_MAIN.NXT = '0'B;

  10088  3 000105   000013 236000 4                  LDQ     11
         3 000106   000005 356000 xsym               ANSQ    VY_P_PCB_MAIN+5

       86    10089    3                 GOTO READ_COMMAND;

  10089  3 000107   000035 710000 3                  TRA     READ_COMMAND

       87    10090    3                 END;
       88    10091    2             END;
       89    10092    1         NEXT$ = START$;

  10092  3 000110   000005 236000 1                  LDQ     START$
         3 000111   000004 756000 1                  STQ     NEXT$

       90    10093    1         CPOS = 0;

  10093  3 000112   000016 450000 1                  STZ     CPOS

       91    10094    1         CHAR_COUNT = SIZE;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:21   

  10094  3 000113   000014 235000 1                  LDA     SIZE
         3 000114   000017 755000 1                  STA     CHAR_COUNT

       92    10095        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:22   
       93    10096    1         VY_P_PCB_MAIN.ROOT$ = SYN_ROOT$;

  10096  3 000115   200004 470500                    LDP0    @SYN_ROOT$,,AUTO
         3 000116   000000 236100                    LDQ     0,,PR0
         3 000117   000001 756000 xsym               STQ     VY_P_PCB_MAIN+1

       94    10097    1         VY_P_PCB_MAIN.TEXT$ = START$;

  10097  3 000120   000005 236000 1                  LDQ     START$
         3 000121   000000 756000 xsym               STQ     VY_P_PCB_MAIN

       95    10098    1         VY_P_PCB_MAIN.NCHARS = CHAR_COUNT;

  10098  3 000122   000011 755000 xsym               STA     VY_P_PCB_MAIN+9

       96    10099    2         IF WORK$ = ADDR(NIL) THEN DO;

  10099  3 000123   000003 236000 1                  LDQ     WORK$
         3 000124   000001 116000 xsym               CMPQ    B_VECTNIL+1
         3 000125   000155 601000 3                  TNZ     AGAIN

       97    10100    2             ALL_SIZE = 7 * CHAR_COUNT + 100;  /* Compute work area ALL_SIZE */

  10100  3 000126   000017 236000 1                  LDQ     CHAR_COUNT
         3 000127   000007 402007                    MPY     7,DL
         3 000130   000144 036007                    ADLQ    100,DL
         3 000131   000015 756000 1                  STQ     ALL_SIZE

       98    10101    2             PWKSZ = ALL_SIZE;                 /* Remember initial allocation */

  10101  3 000132   000020 756000 1                  STQ     PWKSZ

       99    10102                  %ALLOCATE( PTR$=WORK$, TYPE=@DS3, SIZE=ALL_SIZE);

  10103  3 000133   000003 236000 xsym               LDQ     VY_M_ALL+3
         3 000134   000003 136000 xsym               SBLQ    VY_M_FREE+3
         3 000135   000015 116000 1                  CMPQ    ALL_SIZE
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:23   
         3 000136   000147 604000 3                  TMI     s:10107

  10104  3 000137   000003 236000 xsym               LDQ     VY_M_FREE+3
         3 000140   000022 736000                    QLS     18
         3 000141   000003 036000 xsym               ADLQ    VY_M_BASE_PTR+3
         3 000142   000003 756000 1                  STQ     WORK$

  10105  3 000143   000003 236000 xsym               LDQ     VY_M_FREE+3
         3 000144   000015 036000 1                  ADLQ    ALL_SIZE
         3 000145   000003 756000 xsym               STQ     VY_M_FREE+3

  10106  3 000146   000153 710000 3                  TRA     s:10109

  10107  3 000147   000014 630400 4                  EPPR0   12
         3 000150   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000151   000000 701000 xent               TSX1    VYA$GET
         3 000152   000000 011000                    NOP     0

      100    10109    2             VY_P_PCB_MAIN.WORK$ = WORK$;

  10109  3 000153   000003 236000 1                  LDQ     WORK$
         3 000154   000002 756000 xsym               STQ     VY_P_PCB_MAIN+2

      101    10110    2             END;

      102    10111    1   AGAIN:
      103    10112    1         VY_P_PCB_MAIN.WKSZ = ALL_SIZE;

  10112  3 000155   000015 720000 1     AGAIN        LXL0    ALL_SIZE
         3 000156   000005 740000 xsym               STX0    VY_P_PCB_MAIN+5

      104    10113    1         CALL X$PARSE( VY_P_PCB_MAIN )           ALTRET( PARSE_ERR );

  10113  3 000157   000012 630400 4                  EPPR0   10
         3 000160   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000161   000000 701000 xent               TSX1    X$PARSE
         3 000162   000176 702000 3                  TSX2    PARSE_ERR
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:24   

      105    10114    2         DO INHIBIT;

      106    10115    2             VY_PAR_UNWIND_B = '0'B;

  10115  3 000163   000000 235203                    LDA   ! 0,DU
         3 000164   000000 236203                    LDQ   ! 0,DU
         3 000165   000000 757200 xsym               STAQ  ! VY_PAR_UNWIND

      107    10116    2             END;

      108    10117    1         WKSZ = ALL_SIZE;

  10117  3 000166   200005 470500                    LDP0    @WKSZ,,AUTO
         3 000167   000015 235000 1                  LDA     ALL_SIZE
         3 000170   000000 755100                    STA     0,,PR0

      109    10118    1         CALL VYF$FREE( 8/*@GDP*/, GSIZE, 0 );

  10118  3 000171   000017 630400 4                  EPPR0   15
         3 000172   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000173   000000 701000 xent               TSX1    VYF$FREE
         3 000174   000000 011000                    NOP     0

      110    10119    1         RETURN;

  10119  3 000175   000000 702200 xent               TSX2  ! X66_ARET

      111    10120
      112    10121        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:25   
      113    10122    1   PARSE_ERR:
      114    10123    2         DO CASE( VY_P_PCB_MAIN.ERROR.CODE );

  10123  3 000176   000006 236000 xsym  PARSE_ERR    LDQ     VY_P_PCB_MAIN+6
         3 000177   000003 772000                    QRL     3
         3 000200   037777 376007                    ANQ     16383,DL
         3 000201   000006 116007                    CMPQ    6,DL
         3 000202   000204 602006 3                  TNC     PARSE_ERR+6,QL
         3 000203   000364 710000 3                  TRA     s:10169
         3 000204   000364 710000 3                  TRA     s:10169
         3 000205   000241 710000 3                  TRA     s:10136
         3 000206   000364 710000 3                  TRA     s:10169
         3 000207   000364 710000 3                  TRA     s:10169
         3 000210   000212 710000 3                  TRA     s:10125
         3 000211   000212 710000 3                  TRA     s:10125

      115    10124    2           CASE( 4, 5 );

      116    10125    2             PWKSZ      = PWKSZ   + PWKSZ; /* Double and get */

  10125  3 000212   000020 236000 1                  LDQ     PWKSZ
         3 000213   000020 036000 1                  ADLQ    PWKSZ
         3 000214   000020 756000 1                  STQ     PWKSZ

      117    10126                  %ALLOCATE( PTR$=DUMMY$, TYPE=@DS3, SIZE=PWKSZ);

  10127  3 000215   000003 236000 xsym               LDQ     VY_M_ALL+3
         3 000216   000003 136000 xsym               SBLQ    VY_M_FREE+3
         3 000217   000020 116000 1                  CMPQ    PWKSZ
         3 000220   000231 604000 3                  TMI     s:10131

  10128  3 000221   000003 236000 xsym               LDQ     VY_M_FREE+3
         3 000222   000022 736000                    QLS     18
         3 000223   000003 036000 xsym               ADLQ    VY_M_BASE_PTR+3
         3 000224   000007 756000 1                  STQ     DUMMY$

  10129  3 000225   000003 236000 xsym               LDQ     VY_M_FREE+3
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:26   
         3 000226   000020 036000 1                  ADLQ    PWKSZ
         3 000227   000003 756000 xsym               STQ     VY_M_FREE+3

  10130  3 000230   000235 710000 3                  TRA     s:10133

  10131  3 000231   000022 630400 4                  EPPR0   18
         3 000232   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000233   000000 701000 xent               TSX1    VYA$GET
         3 000234   000000 011000                    NOP     0

      118    10133    2             ALL_SIZE = ALL_SIZE + PWKSZ;  /* Correct for total allocated */

  10133  3 000235   000015 236000 1                  LDQ     ALL_SIZE
         3 000236   000020 036000 1                  ADLQ    PWKSZ
         3 000237   000015 756000 1                  STQ     ALL_SIZE

      119    10134    2             GOTO AGAIN;                   /* Go try again     */

  10134  3 000240   000155 710000 3                  TRA     AGAIN

      120    10135    2           CASE( 1 );

      121    10136    2             IF VY_DO_ECHO  AND  ~ (M$SI$->F$DCB.DDEV.IC# & M$DO$->F$DCB.DDEV.IC#)

  10136  3 000241   000000 234000 xsym               SZN     VY_DO_ECHO
         3 000242   000263 605000 3                  TPL     s:10138
         3 000243   000000 470400 xsym               LDP0    M$DO$
         3 000244   000004 236100                    LDQ     4,,PR0
         3 000245   000024 736000                    QLS     20
         3 000246   400000 376003                    ANQ     -131072,DU
         3 000247   200006 756100                    STQ     @WKSZ+1,,AUTO
         3 000250   000000 471400 xsym               LDP1    M$SI$
         3 000251   100004 236100                    LDQ     4,,PR1
         3 000252   000024 736000                    QLS     20
         3 000253   400000 376003                    ANQ     -131072,DU
         3 000254   200006 376100                    ANQ     @WKSZ+1,,AUTO
         3 000255   400000 676003                    ERQ     -131072,DU
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:27   
         3 000256   000263 600000 3                  TZE     s:10138

      122    10137    2             THEN CALL VYW$WRITE_DO( VY_LAST_LINE.TEXT, VY_LAST_LINE.SIZE );

  10137  3 000257   000025 630400 4                  EPPR0   21
         3 000260   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000261   000000 701000 xent               TSX1    VYW$WRITE_DO
         3 000262   000000 011000                    NOP     0

      123    10138    2             J = VY_P_PCB_MAIN.HI_CHAR;

  10138  3 000263   000012 235000 xsym               LDA     VY_P_PCB_MAIN+10
         3 000264   000011 755000 1                  STA     J

      124    10139    2             K = J + VY_LAST_LINE.OFFSET - CPOS + 1;

  10139  3 000265   000011 236000 1                  LDQ     J
         3 000266   000001 036000 xsym               ADLQ    VY_LAST_LINE+1
         3 000267   000016 136000 1                  SBLQ    CPOS
         3 000270   000001 036007                    ADLQ    1,DL
         3 000271   000012 756000 1                  STQ     K

      125    10140    3             IF J >= CPOS AND K <= 120 THEN DO;

  10140  3 000272   000011 236000 1                  LDQ     J
         3 000273   000016 116000 1                  CMPQ    CPOS
         3 000274   000312 604000 3                  TMI     s:10156
         3 000275   000012 235000 1                  LDA     K
         3 000276   000170 115007                    CMPA    120,DL
         3 000277   000312 605400 3                  TPNZ    s:10156

      126    10141        /*E*  ERROR: VYP-E$SYNTAX_ERROR_VY-0
      127    10142              MESSAGE:     Syntax error.
      128    10143              DESCRIPTION: Self-explanatory.
      129    10144        */
      130    10145    3                 VY_FPT_ERRMSG.V.POINTER# = K;

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:28   
  10145  3 000300   000012 236000 1                  LDQ     K
         3 000301   000022 736000                    QLS     18
         3 000302   000030 552020 xsym               STBQ    VY_FPT_ERRMSG+24,'20'O

      131    10146                      %SCREAM( ERR#=%E$SYNTAX_ERROR_VY, MID="'P'", LEVEL=%@E$F_D_VY );

  10147  3 000303   000032 630400 4                  EPPR0   26
         3 000304   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000305   000000 701000 xent               TSX1    VYE$ERROR
         3 000306   000000 011000                    NOP     0

      132    10149    3                 VY_FPT_ERRMSG.V.POINTER# = 0;

  10149  3 000307   000000 236003                    LDQ     0,DU
         3 000310   000030 552020 xsym               STBQ    VY_FPT_ERRMSG+24,'20'O

      133    10150    3                 END;

  10150  3 000311   000355 710000 3                  TRA     s:10165

      134    10151    3             ELSE DO;

      135    10152        /*E*  ERROR: VYP-E$ILLEGAL_SYNTAX_VY-0
      136    10153              MESSAGE: Illegal syntax detected at: %U1<?>%U2
      137    10154              DESCRIPTION: Self-explanatory.
      138    10155        */
      139    10156    3                 K = MAXIMUM( 0, J - 16 );

  10156  3 000312   000020 136007                    SBLQ    16,DL
         3 000313   000000 116003                    CMPQ    0,DU
         3 000314   000316 605000 3                  TPL     s:10156+4
         3 000315   000000 236003                    LDQ     0,DU
         3 000316   000012 756000 1                  STQ     K

      140    10157    3                 VY_EFIELD1.COUNT = J - K;

  10157  3 000317   000011 236000 1                  LDQ     J
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:29   
         3 000320   000012 136000 1                  SBLQ    K
         3 000321   000033 736000                    QLS     27
         3 000322   000000 552040 xsym               STBQ    VY_EFIELD1,'40'O

      141    10158    3                 VY_EFIELD1.CHARS = SUBSTR( CHAR$STR, K );

  10158  3 000323   000017 236000 1                  LDQ     CHAR_COUNT
         3 000324   000012 136000 1                  SBLQ    K
         3 000325   000005 470400 1                  LDP0    START$
         3 000326   000000 620006                    EAX0    0,QL
         3 000327   000012 235000 1                  LDA     K
         3 000330   040000 100545                    MLR     fill='040'O
         3 000331   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=*X0
         3 000332   000000 200117 xsym               ADSC9   VY_EFIELD1               cn=1,n=79

      142    10159    3                 VY_EFIELD2.COUNT = MINIMUM( 15, CHAR_COUNT - J );

  10159  3 000333   000017 236000 1                  LDQ     CHAR_COUNT
         3 000334   000011 136000 1                  SBLQ    J
         3 000335   000017 116007                    CMPQ    15,DL
         3 000336   000340 604400 3                  TMOZ    s:10159+5
         3 000337   000017 236007                    LDQ     15,DL
         3 000340   000033 736000                    QLS     27
         3 000341   000000 552040 xsym               STBQ    VY_EFIELD2,'40'O

      143    10160    3                 VY_EFIELD2.CHARS = SUBSTR( CHAR$STR, J );

  10160  3 000342   000017 236000 1                  LDQ     CHAR_COUNT
         3 000343   000011 136000 1                  SBLQ    J
         3 000344   000000 620006                    EAX0    0,QL
         3 000345   000011 236000 1                  LDQ     J
         3 000346   040000 100546                    MLR     fill='040'O
         3 000347   000000 000010                    ADSC9   0,Q,PR0                  cn=0,n=*X0
         3 000350   000000 200117 xsym               ADSC9   VY_EFIELD2               cn=1,n=79

      144    10161                      %SCREAM( ERR#=%E$ILLEGAL_SYNTAX_VY, MID="'P'", LEVEL=%@E$F_D_VY );

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:30   
  10162  3 000351   000037 630400 4                  EPPR0   31
         3 000352   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000353   000000 701000 xent               TSX1    VYE$ERROR
         3 000354   000000 011000                    NOP     0

      145    10164    3                 END;

      146    10165    2             VY_SYNTAX_ERR = '1'B;

  10165  3 000355   400000 236003                    LDQ     -131072,DU
         3 000356   000000 756000 xsym               STQ     VY_SYNTAX_ERR

      147    10166    2             TWOCHARS = SUBSTR(CHAR$STR, 0, 2);

  10166  3 000357   000005 470400 1                  LDP0    START$
         3 000360   040000 100500                    MLR     fill='040'O
         3 000361   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         3 000362   000022 000002 1                  ADSC9   TWOCHARS                 cn=0,n=2

      148    10167    2             GOTO READ_COMMAND;

  10167  3 000363   000035 710000 3                  TRA     READ_COMMAND

      149    10168    2           CASE( ELSE );                   /* Open question */

      150    10169    2             CALL VYE$ERRMSG( VY_P_PCB_MAIN.ERROR );

  10169  3 000364   000043 630400 4                  EPPR0   35
         3 000365   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000366   000000 701000 xent               TSX1    VYE$ERRMSG
         3 000367   000000 011000                    NOP     0

      151    10170    2           END;

  10170  3 000370   000373 710000 3                  TRA     s:10175

      152    10171
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:31   
      153    10172        %EJECT;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:32   
      154    10173    1   VYP$PAR_U: ENTRY(TYPE) ALTRET;

  10173  3 000371   000000 700200 xent  VYP$PAR_U    TSX0  ! X66_AUTO_3
         3 000372   000012 000003                    ZERO    10,3

      155    10174
      156    10175    1         PARSE_PARAM$ = ADDR(TYPE);

  10175  3 000373   200003 236100                    LDQ     @TYPE,,AUTO
         3 000374   000006 756000 1                  STQ     PARSE_PARAM$

      157    10176    2         IF PARSE$PARAM.TYPE = 4 THEN DO;

  10176  3 000375   000006 470400 1                  LDP0    PARSE_PARAM$
         3 000376   000000 236100                    LDQ     0,,PR0
         3 000377   777000 376003                    ANQ     -512,DU
         3 000400   004000 116003                    CMPQ    2048,DU
         3 000401   000462 601000 3                  TNZ     s:10196

      158    10177    2             CPOS = PARSE$PARAM.CHARPOS + 1;

  10177  3 000402   000004 235100                    LDA     4,,PR0
         3 000403   000001 035007                    ADLA    1,DL
         3 000404   000016 755000 1                  STA     CPOS

      159    10178    2             CHAR_COUNT = CPOS;

  10178  3 000405   000017 755000 1                  STA     CHAR_COUNT

      160    10179    2             NEXT$ = PINCRC(START$, CHAR_COUNT);

  10179  3 000406   000017 236000 1                  LDQ     CHAR_COUNT
         3 000407   000020 736000                    QLS     16
         3 000410   000005 036000 1                  ADLQ    START$
         3 000411   000004 756000 1                  STQ     NEXT$

      161    10180    3             IF CHAR_COUNT + 256 > GSIZE*4 THEN DO;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:33   

  10180  3 000412   000013 235000 1                  LDA     GSIZE
         3 000413   000002 735000                    ALS     2
         3 000414   200006 755100                    STA     @WKSZ+1,,AUTO
         3 000415   000017 236000 1                  LDQ     CHAR_COUNT
         3 000416   000400 036007                    ADLQ    256,DL
         3 000417   200006 116100                    CMPQ    @WKSZ+1,,AUTO
         3 000420   000442 604400 3                  TMOZ    s:10190

      162    10181                      %ALLOCATE( PTR$=DUMMY$, TYPE=@GDP, SIZE=@PAGE_SIZE );

  10182  3 000421   000010 236000 xsym               LDQ     VY_M_ALL+8
         3 000422   000010 136000 xsym               SBLQ    VY_M_FREE+8
         3 000423   002000 116007                    CMPQ    1024,DL
         3 000424   000434 604000 3                  TMI     s:10186

  10183  3 000425   000010 236000 xsym               LDQ     VY_M_FREE+8
         3 000426   000022 736000                    QLS     18
         3 000427   000010 036000 xsym               ADLQ    VY_M_BASE_PTR+8
         3 000430   000007 756000 1                  STQ     DUMMY$

  10184  3 000431   002000 236007                    LDQ     1024,DL
         3 000432   000010 056000 xsym               ASQ     VY_M_FREE+8

  10185  3 000433   000440 710000 3                  TRA     s:10188

  10186  3 000434   000045 630400 4                  EPPR0   37
         3 000435   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000436   000000 701000 xent               TSX1    VYA$GET
         3 000437   000000 011000                    NOP     0

      163    10188    3                 GSIZE = GSIZE + 1024/*@PAGE_SIZE*/;

  10188  3 000440   002000 236007                    LDQ     1024,DL
         3 000441   000013 056000 1                  ASQ     GSIZE

      164    10189    3                 END;
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:34   

      165    10190    2             CALL VYR$READ( NEXT$ -> C$CHAR, SIZE, DCB_TYPE );

  10190  3 000442   000007 236000 4                  LDQ     7
         3 000443   200010 756100                    STQ     @WKSZ+3,,AUTO
         3 000444   000010 236000 4                  LDQ     8
         3 000445   000004 235000 1                  LDA     NEXT$
         3 000446   200006 757100                    STAQ    @WKSZ+1,,AUTO
         3 000447   200006 630500                    EPPR0   @WKSZ+1,,AUTO
         3 000450   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000451   000000 701000 xent               TSX1    VYR$READ
         3 000452   000000 011000                    NOP     0

      166    10191    2             CHAR_COUNT = CHAR_COUNT + SIZE;

  10191  3 000453   000017 236000 1                  LDQ     CHAR_COUNT
         3 000454   000014 036000 1                  ADLQ    SIZE
         3 000455   000017 756000 1                  STQ     CHAR_COUNT

      167    10192    2             VY_P_PCB_MAIN.NCHARS = CHAR_COUNT;

  10192  3 000456   000011 756000 xsym               STQ     VY_P_PCB_MAIN+9

      168    10193    2             PARSE$PARAM.RETRY = '1'B;

  10193  3 000457   000006 470400 1                  LDP0    PARSE_PARAM$
         3 000460   000100 236003                    LDQ     64,DU
         3 000461   000000 256100                    ORSQ    0,,PR0

      169    10194    2             END;

      170    10195
      171    10196    1         RETURN;

  10196  3 000462   000000 702200 xent               TSX2  ! X66_ARET
      172    10197
      173    10198
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:35   
      174    10199    1   END VYP$PAR;

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:36   
--  Include file information  --

   XU_PERR_C.:E05TOU  is referenced.
   XU_SUBS_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYP$PAR.
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:37   

 **** Variables and constants ****

  ****  Section 001  Data  VYP$PAR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    15-0-0/w SBIN        r     1 ALL_SIZE                  17-0-0/w SBIN        r     1 CHAR_COUNT
    16-0-0/w SBIN        r     1 CPOS                      21-0-0/w SBIN        r     1 DCB_TYPE
     7-0-0/w PTR         r     1 DUMMY$                    13-0-0/w SBIN        r     1 GSIZE
    11-0-0/w SBIN        r     1 J                         12-0-0/w SBIN        r     1 K
     4-0-0/w PTR         r     1 NEXT$                      6-0-0/w PTR         r     1 PARSE_PARAM$
    20-0-0/w SBIN        r     1 PWKSZ                     14-0-0/w SBIN        r     1 SIZE
     5-0-0/w PTR         r     1 START$                    22-0-0/c CHAR(2)     r     1 TWOCHARS
     3-0-0/w PTR         r     1 WORK$

  ****  Section 002 RoData VYP$PAR

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(55)    r     1 ENTER_FILE_NAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @SYN_ROOT$                 3-0-0/w PTR         r     1 @TYPE
     5-0-0/w PTR         r     1 @WKSZ                     *0-0-0/w PTR         r     1 SYN_ROOT$
    *0-0-0/w SBIN        r     1 TYPE                      *0-0-0/w SBIN        r     1 WKSZ

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:38   
     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 M$DO$
     0-0-0/w PTR         r     1 M$SI$                      0-0-0/w BIT         r     1 VY_DO_ECHO
     0-0-0/w STRC(720)   r     1 VY_EFIELD1                 0-0-0/w STRC(720)   r     1 VY_EFIELD2
     0-0-0/d STRC(936)   r     1 VY_FPT_ERRMSG              0-0-0/w STRC(2466)  r     1 VY_LAST_LINE
     0-0-0/w SBIN        r     1 VY_M_ALL(0:8)
     0-0-0/w PTR         r     1 VY_M_BASE_PTR(0:8)
     0-0-0/w SBIN        r     1 VY_M_FREE(0:8)
     0-0-0/d REMB        r     1 VY_PAR_UNWIND              0-0-0/d BIT (72)    r     1 VY_PAR_UNWIND_B
     0-0-0/w STRC(504)   r     1 VY_P_PCB_MAIN              0-0-0/w BIT         r     1 VY_SYNTAX_ERR

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(256)   r     1 C$CHAR                     0-0-0/c ACHR        r     1 CHAR$STR
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(270)   r     1 PARSE$PARAM


   Procedure VYP$PAR requires 307 words for executable code.
   Procedure VYP$PAR requires 10 words of local(AUTO) storage.

    No errors detected in file VYP$PAR.:E05TSI    .
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:40   
          MINI XREF LISTING

AGAIN
     10112**LABEL   10134--GOTO
ALL_SIZE
      9878**DCL     10100<<ASSIGN  10101>>ASSIGN  10103>>IF      10105>>ASSIGN  10107<>CALL    10112>>ASSIGN
     10117>>ASSIGN  10133<<ASSIGN  10133>>ASSIGN
B$JIT.CPFLAGS1.SLEAZE
      9304**DCL      9304--REDEF
B$JIT.ERR.MID
      9211**DCL      9211--REDEF
B$JIT.JRESPEAK
      9372**DCL      9373--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
      9481**DCL      9481--REDEF    9482--REDEF
B$JIT.PNR
      9385**DCL      9385--REDEF
B$JIT.TSLINE
      9479**DCL      9480--REDEF
B$JIT$
      5347**DCL      9205--IMP-PTR
C$CHAR
      9900**DCL     10077<>CALL    10190<>CALL
CHAR$STR
      9901**DCL     10084>>IF      10085<<ASSIGN  10158>>ASSIGN  10160>>ASSIGN  10166>>ASSIGN
CHAR_COUNT
      9880**DCL      9901--IMP-SIZ 10084>>IF      10085>>ASSIGN  10094<<ASSIGN  10098>>ASSIGN  10100>>ASSIGN
     10158>>ASSIGN  10159>>ASSIGN  10160>>ASSIGN  10166>>ASSIGN  10178<<ASSIGN  10179>>ASSIGN  10180>>IF
     10191<<ASSIGN  10191>>ASSIGN  10192>>ASSIGN
CPOS
      9879**DCL     10093<<ASSIGN  10139>>ASSIGN  10140>>IF      10177<<ASSIGN  10178>>ASSIGN
DCB_TYPE
      9882**DCL     10061<<ASSIGN  10075>>IF      10077<>CALL    10190<>CALL
DUMMY$
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:41   
      9856**DCL     10128<<ASSIGN  10131<>CALL    10183<<ASSIGN  10186<>CALL
ENTER_FILE_NAME
     10057**DCL     10076<>CALL    10076--CALL
EOF
     10079**LABEL   10077--CALLALT
F$DCB.ACTPOS
     10017**DCL     10017--REDEF
F$DCB.ARS#
      9991**DCL      9991--REDEF
F$DCB.ATTR
     10010**DCL     10011--REDEF
F$DCB.BORROW
     10025**DCL     10025--REDEF   10025--REDEF   10025--REDEF
F$DCB.DCBNAME.L
     10039**DCL     10039--IMP-SIZ
F$DCB.DDEV.IC#
      9997**DCL     10136>>IF      10136>>IF
F$DCB.EOMCHAR#
      9995**DCL      9995--REDEF
F$DCB.FLDID
     10020**DCL     10020--REDEF
F$DCB.FORM$
     10014**DCL     10014--REDEF
F$DCB.FSECT
     10030**DCL     10030--REDEF
F$DCB.FSN#
     10007**DCL     10007--REDEF   10007--REDEF   10008--REDEF
F$DCB.HEADER$
     10013**DCL     10013--REDEF
F$DCB.IXTNSIZE#
     10011**DCL     10011--REDEF
F$DCB.LASTSTA$
     10000**DCL     10000--REDEF
F$DCB.LVL
     10026**DCL     10026--REDEF
F$DCB.NAME#.C
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:42   
     10001**DCL     10001--REDEF
F$DCB.NOEOF
     10023**DCL     10023--REDEF
F$DCB.NRECS#
     10012**DCL     10012--REDEF
F$DCB.NRECX
     10031**DCL     10031--REDEF
F$DCB.OHDR
     10023**DCL     10023--REDEF
F$DCB.ORG#
     10006**DCL     10006--REDEF
F$DCB.PRECNO
     10029**DCL     10029--REDEF
F$DCB.RCSZ
     10035**DCL     10035--REDEF
F$DCB.RES#
     10002**DCL     10002--REDEF
F$DCB.SETX
     10014**DCL     10014--REDEF
F$DCB.TAB$
     10014**DCL     10014--REDEF
F$DCB.TDA
     10028**DCL     10029--REDEF
F$DCB.WSN#
     10002**DCL     10002--REDEF
GSIZE
      9876**DCL     10063<<ASSIGN  10065>>IF      10067>>ASSIGN  10069<>CALL    10118<>CALL    10180>>IF
     10188<<ASSIGN  10188>>ASSIGN
J
      9874**DCL     10138<<ASSIGN  10139>>ASSIGN  10140>>IF      10156>>ASSIGN  10157>>ASSIGN  10159>>ASSIGN
     10160>>ASSIGN
K
      9875**DCL     10139<<ASSIGN  10140>>IF      10145>>ASSIGN  10156<<ASSIGN  10157>>ASSIGN  10158>>ASSIGN
M$DO$
      5764**DCL     10136>>IF
M$SI$
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:43   
      5764**DCL     10136>>IF
NEXT$
      9853**DCL     10092<<ASSIGN  10179<<ASSIGN  10190>>CALL
PARSE$PARAM.CHARPOS
      9960**DCL     10177>>ASSIGN
PARSE$PARAM.RETRY
      9938**DCL     10193<<ASSIGN
PARSE$PARAM.TYPE
      9923**DCL     10176>>IF
PARSE_ERR
     10123**LABEL   10113--CALLALT
PARSE_PARAM$
      9855**DCL      9922--IMP-PTR 10175<<ASSIGN  10176>>IF      10177>>ASSIGN  10193>>ASSIGN
PWKSZ
      9881**DCL     10101<<ASSIGN  10125<<ASSIGN  10125>>ASSIGN  10125>>ASSIGN  10127>>IF      10129>>ASSIGN
     10131<>CALL    10133>>ASSIGN
READ_COMMAND
     10075**LABEL   10072--REMEMBR 10089--GOTO    10167--GOTO
SIZE
      9877**DCL     10077<>CALL    10084>>IF      10094>>ASSIGN  10190<>CALL    10191>>ASSIGN
START$
      9854**DCL      9901--IMP-PTR 10066<<ASSIGN  10069<>CALL    10077>>CALL    10084>>IF      10085>>ASSIGN
     10092>>ASSIGN  10097>>ASSIGN  10158>>ASSIGN  10160>>ASSIGN  10166>>ASSIGN  10179>>ASSIGN
SYN_ROOT$
      9787**DCL        16--PROC    10096>>ASSIGN
TWOCHARS
     10059**DCL     10085>>ASSIGN  10166<<ASSIGN
TYPE
      9786**DCL        16--PROC    10061>>ASSIGN  10173--ENTRY   10175--ASSIGN
VYA$GET
      9815**DCL-ENT 10069--CALL    10107--CALL    10131--CALL    10186--CALL
VYE$ERRMSG
      9809**DCL-ENT 10169--CALL
VYE$ERROR
      9806**DCL-ENT 10147--CALL    10162--CALL
VYF$FREE
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:44   
      9816**DCL-ENT 10118--CALL
VYI$EXIT
      9829**DCL-ENT 10079--CALL
VYR$READ
      9810**DCL-ENT 10077--CALL    10190--CALL
VYW$WRITE
      9811**DCL-ENT 10076--CALL
VYW$WRITE_DO
      9812**DCL-ENT 10137--CALL
VY_BIAS.A
      5396**DCL      5396--REDEF
VY_CBUF.CHARS_A
      5387**DCL      5387--REDEF
VY_DO_ECHO
      5742**DCL     10136>>IF
VY_EBUF.CHARS_A
      5688**DCL      5689--REDEF
VY_EFIELD1.CHARS
      5689**DCL      5689--REDEF   10158<<ASSIGN
VY_EFIELD1.COUNT
      5689**DCL     10157<<ASSIGN
VY_EFIELD2.CHARS
      5690**DCL      5690--REDEF   10160<<ASSIGN
VY_EFIELD2.COUNT
      5690**DCL     10159<<ASSIGN
VY_EFIELD3.CHARS
      5691**DCL      5691--REDEF
VY_ERRORS
      5392**DCL      5394--REDEF
VY_ERRORS.CONFLICT_A
      5393**DCL      5394--REDEF
VY_ERRORS.UNSAT_A
      5392**DCL      5393--REDEF
VY_FPT_ERRMSG.V.POINTER#
      4825**DCL     10145<<ASSIGN  10149<<ASSIGN
VY_IMAGE_DATA.CPAGE#_A
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:45   
      5280**DCL      5281--REDEF
VY_IMAGE_DATA.NODE_A$
      5292**DCL      5293--REDEF
VY_IMAGE_DATA.START_A$
      5284**DCL      5285--REDEF
VY_IMAGE_DATA.STOP_A$
      5288**DCL      5289--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5303**DCL      5304--REDEF
VY_IMAGE_PROC.NODE_A$
      5315**DCL      5316--REDEF
VY_IMAGE_PROC.START_A$
      5307**DCL      5308--REDEF
VY_IMAGE_PROC.STOP_A$
      5311**DCL      5312--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5326**DCL      5327--REDEF
VY_IMAGE_ROS.NODE_A$
      5338**DCL      5339--REDEF
VY_IMAGE_ROS.START_A$
      5330**DCL      5331--REDEF
VY_IMAGE_ROS.STOP_A$
      5334**DCL      5335--REDEF
VY_LAST_LINE.OFFSET
      5744**DCL     10139>>ASSIGN
VY_LAST_LINE.SIZE
      5744**DCL     10137<>CALL
VY_LAST_LINE.TEXT
      5744**DCL     10137<>CALL
VY_MAP_HDR.CHARS
      5753**DCL      5754--REDEF    5754--REDEF
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5082**DCL      5082--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5089**DCL      5089--REDEF
VY_MAP_LO_FPT_WRITE.STATION_
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:46   
      5051**DCL      5051--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5058**DCL      5058--REDEF
VY_MBUF.CHARS
      5752**DCL      5753--REDEF    5753--REDEF
VY_M_ALL
      5397**DCL     10065>>IF      10103>>IF      10127>>IF      10182>>IF
VY_M_BASE_PTR
      5398**DCL     10066>>ASSIGN  10104>>ASSIGN  10128>>ASSIGN  10183>>ASSIGN
VY_M_FREE
      5397**DCL     10065>>IF      10066>>ASSIGN  10067<<ASSIGN  10067>>ASSIGN  10103>>IF      10104>>ASSIGN
     10105<<ASSIGN  10105>>ASSIGN  10127>>IF      10128>>ASSIGN  10129<<ASSIGN  10129>>ASSIGN  10182>>IF
     10183>>ASSIGN  10184<<ASSIGN  10184>>ASSIGN
VY_M_VECTOR.F
      5121**DCL      5125--REDEF
VY_M_VECTOR_DP.F
      5156**DCL      5160--REDEF
VY_O.DUPL_ATTCH
      5534**DCL      5538--REDEF
VY_O.MAP_ATTCH
      5522**DCL      5533--REDEF
VY_O.PRIMARY_OPTION
      5516**DCL      5521--REDEF
VY_O.SEV_ATTCH
      5539**DCL      5541--REDEF
VY_OD.DUPL_ATTCH
      5678**DCL      5682--REDEF
VY_OD.MAP_ATTCH
      5666**DCL      5677--REDEF
VY_OD.PRIMARY_OPTION
      5660**DCL      5665--REDEF
VY_OD.SEV_ATTCH
      5683**DCL      5685--REDEF
VY_OL_KEY_BUF.FORM0
      5189**DCL      5192--REDEF    5199--REDEF
VY_OU_HEAD.REC_A
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:47   
      5377**DCL      5378--REDEF
VY_O_KEY_BUF.FORM0
      5166**DCL      5169--REDEF    5176--REDEF
VY_O_KEY_BUF_L.FORM0
      5212**DCL      5215--REDEF    5222--REDEF
VY_PAR_UNWIND
      5747**DCL      5747--REDEF   10072<<REMEMBR
VY_PAR_UNWIND_B
      5747**DCL     10115<<ASSIGN
VY_PASS2_REF.OU.L_START
      5714**DCL      5715--REDEF
VY_PASS2_REF.OU.L_STOP
      5715**DCL      5716--REDEF
VY_PASS2_REF.OU.MAX
      5713**DCL      5714--REDEF
VY_PASS2_REF.OU.SIZE
      5716**DCL      5717--REDEF
VY_PASS2_REF.SAT.COUNT
      5720**DCL      5721--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5722**DCL      5723--REDEF
VY_PASS2_REF.SAT.L_START
      5718**DCL      5719--REDEF
VY_PASS2_REF.SAT.L_STOP
      5719**DCL      5720--REDEF
VY_PASS2_REF.SAT.MAX
      5717**DCL      5718--REDEF
VY_PASS2_REF.UNSAT.L_START
      5724**DCL      5725--REDEF
VY_PASS2_REF.UNSAT.L_STOP
      5725**DCL      5726--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5726**DCL      5727--REDEF
VY_PASS2_REF.UNSAT.MAX
      5723**DCL      5724--REDEF
VY_PASS2_REF.UNSAT.PAGE#
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:48   
      5728**DCL      5729--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5727**DCL      5728--REDEF
VY_PROGRAM_BIAS.A
      5395**DCL      5395--REDEF
VY_P_PCB_MAIN
      4850**DCL     10087<>CALL    10113<>CALL
VY_P_PCB_MAIN.ERROR
      4954**DCL     10169<>CALL
VY_P_PCB_MAIN.ERROR.CODE
      4962**DCL     10123>>DOCASE
VY_P_PCB_MAIN.HI_CHAR
      5001**DCL     10138>>ASSIGN
VY_P_PCB_MAIN.NCHARS
      4997**DCL     10098<<ASSIGN  10192<<ASSIGN
VY_P_PCB_MAIN.NXT
      4900**DCL     10086<<ASSIGN  10088<<ASSIGN
VY_P_PCB_MAIN.ROOT$
      4855**DCL     10096<<ASSIGN
VY_P_PCB_MAIN.TEXT$
      4851**DCL     10097<<ASSIGN
VY_P_PCB_MAIN.WKSZ
      4880**DCL     10112<<ASSIGN
VY_P_PCB_MAIN.WORK$
      4859**DCL     10109<<ASSIGN
VY_RU_HEAD.DATA_SEGMENT
      5363**DCL      5363--REDEF
VY_RU_HEAD.L
      5359**DCL      5360--REDEF
VY_RU_HEAD.MAP_BITS
      5360**DCL      5362--REDEF
VY_RU_HEAD.PBIT
      5356**DCL      5356--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
      5373**DCL      5373--REDEF
VY_RU_HEAD_BUF.L
PL6.E3A0      #001=VYP$PAR File=VYP$PAR.:E05TSI                                  WED 07/30/97 08:59 Page:49   
      5368**DCL      5369--REDEF
VY_RU_HEAD_BUF.MAP_BITS
      5370**DCL      5372--REDEF
VY_RU_HEAD_BUF.PBIT
      5365**DCL      5366--REDEF
VY_R_KEY_BUF.FORM0
      5235**DCL      5239--REDEF    5245--REDEF
VY_SI_KEY_BUF.KEY
      5743**DCL      5743--REDEF
VY_SPC.B$.MINE
      5738**DCL      5739--REDEF
VY_SPC.B$.NAME
      5735**DCL      5735--REDEF
VY_SPC.B$.SKIP
      5737**DCL      5738--REDEF
VY_SPC.B$.VALUE
      5736**DCL      5737--REDEF
VY_SPC.SEG.NAME
      5730**DCL      5731--REDEF
VY_SPC.SEG.VALUE
      5731**DCL      5732--REDEF
VY_SYNTAX_ERR
      5741**DCL     10082>>IF      10083<<ASSIGN  10165<<ASSIGN
VY_TSX0_OVERLAY.H
      5702**DCL      5703--REDEF
WKSZ
      9788**DCL        16--PROC    10063>>ASSIGN  10117<<ASSIGN
WORK$
      9852**DCL     10062<<ASSIGN  10099>>IF      10104<<ASSIGN  10107<>CALL    10109>>ASSIGN
X$PARSE
      9830**DCL-ENT 10087--CALL    10113--CALL
