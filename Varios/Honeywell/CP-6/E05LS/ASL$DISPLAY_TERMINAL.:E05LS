VERSION E05

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ASL$DISP_ONE_TERMINAL: PROC (JCL);
        7        7        /**********************************************************/
        8        8
        9        9        /*D* NAME:     ASL$DISP_ONE_TERMINAL
       10       10             CALL:     CALL ASL$DISP_ONE_TERMINAL (JCL)
       11       11             INPUT:    JCL -     Bit indicating JCL mode.
       12       12             OUTPUT:   Nothing is returned.
       13       13             DESCRIPTION:  ASL$DISP_ONE_TERMINAL is a subroutine to handle
       14       14                           the DISP TERMINAL command for SUPER.
       15       15                           This routine will display the information in
       16       16                           the terminal record in data segment 1.  It will
       17       17                           also use some of the information in the TWSN record
       18       18                           in data segment 2.
       19       19                           It will also read the individual device records
       20       20                           from :NETCON to pick up the signon string for the
       21       21                           device. The device record will be read into
       22       22                           auto memory.
       23       23                  MEMORY REQUIREMENTS:
       24       24                           For all of the routines that deal with listing/
       25       25                           displaying terminals:
       26       26
       27       27                            ASL$DISP_ONE_TERMINALS
       28       28                            ASL$DISP_ONE_TERMINAL
       29       29                            ASB$INIT_GET_TERMINAL
       30       30                            ASB$GET_NEXT_TERMINAL
       31       31
       32       32                           Data segment 1 will be used for reading records
       33       33                           from :HLP.  Terminal records will be left in data
       34       34                           segment 1.  Device records from :NETCON for
       35       35                           devices that belong to the current terminal will
       36       36                           be read one at a time into auto memory.
       37       37                           Data segment 2 will be used for the TWSN9999 record
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:2    
       38       38                           associated with the terminal record in data segment
       39       39                           1.
       40       40                           If this is a JCL mode display, this routine will
       41       41                           also read the necessary device records into data
       42       42                           segment 3 and call ASL$DISP_ONE_DEVICE, so that
       43       43                           the current terminal will be created correctly.
       44       44        */
       45       45        %EJECT;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:3    
       46       46        /********************************************************************/
       47       47        /*   Include files   include files   include files   include files  */
       48       48        /********************************************************************/
       49       49        %INCLUDE AS_PERR_C;
       50      651        %INCLUDE AS_SUPER_C;
       51     1086        %INCLUDE AS_SUBS_C;
       52     2500        %INCLUDE AS_MAC_C;
       53     2580        %INCLUDE AS_ENTRIES_M;
       54     3630        %INCLUDE AS_SSUBS_C;
       55     3722        %INCLUDE B_ERRORS_C;
       56     4849        %INCLUDE CP_6;
       57    10408        %INCLUDE CP_6_SUBS ;
       58    10948        %INCLUDE KL_CONFIG_M;
       59    11710        %INCLUDE KL_MACRO_C;
       60    15062        %INCLUDE KL_SUPER_C;
       61    17964        %INCLUDE XU_MACRO_C;
       62    21070        %INCLUDE XU_FORMAT_C;
       63    21232        %INCLUDE AS_SUPER_R;
       64    24248        /********************************************************************/
       65    24249        /*   dcbs           dcbs           dcbs           dcbs              */
       66    24250        /********************************************************************/
       67    24251    1   DCL M$PRO DCB;
       68    24252        /********************************************************************/
       69    24253        /*   Static data     static data     static data     static data    */
       70    24254        /********************************************************************/
       71    24255    1   DCL KL$HASPDEV$              PTR STATIC;
       72    24256    1   DCL LINCNFG_BUF    (0:49)    UBIN WORD STATIC INIT(0*0);
       73    24257    1   DCL LINCNFG$                 PTR STATIC INIT(ADDR(LINCNFG_BUF));
       74    24258        %KL$CONFIG_KEY ( NAME = CONFIG_KEY, STCLASS = STATIC);
       75    24305        %KL$LINCNFG    ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
       76    24463        %KL_SS;
       77    24498        /********************************************************************/
       78    24499        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       79    24500        /********************************************************************/
       80    24501        %ASA$ERROR ;
       81    24504        %ASB$READ_HLP ;
       82    24507        %ASB$READ_NETCON ;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:4    
       83    24510        %ASB$WRITE_LO ;
       84    24513        %ASD$READ_PRO ;
       85    24516        %ASH$ERROR ;
       86    24519        %ASL$DISP_ONE_DEVICE ;
       87    24522    1   DCL X$FORMAT ENTRY(1) ;
       88    24523        /********************************************************************/
       89    24524        /*   Local based     local based     local based     local based    */
       90    24525        /********************************************************************/
       91    24526        %KL_DREC         ( NAME      =  KL$DREC,
       92    24527                           LAST      = ";",
       93    24528                           STCLASS   = "BASED(DSEG1$)") ;
       94    24641
       95    24642        %KL_HASPDEV      ( NAME      = KL$HASPDEV,
       96    24643                           STCLASS   = "BASED(KL$HASPDEV$)");
       97    24877
       98    24878        %KL_PHDR         ( NAME      = KL$PHDR ,
       99    24879                           STCLASS   = "BASED( PRO$ )") ;
      100    24920
      101    24921        %KL_DREC         ( NAME      = KL$TREC,
      102    24922                           STCLASS   = "BASED(DSEG1$)",
      103    24923                           LAST      = ",");
      104    25036
      105    25037        %KL_GJOB         ( NAME      = GJOB,
      106    25038                           STCLASS   = BASED,
      107    25039                           LVL       = 2,
      108    25040                           LAST      = "," );
      109    25064
      110    25065        %KL_HASP         ( NAME      = HASP,
      111    25066                           STCLASS   = BASED,
      112    25067                           LVL       = 2 );
      113    25217
      114    25218        %KL_TRMD         ( NAME      = KL$TRMD ,
      115    25219                           STCLASS   = "BASED UNAL") ;
      116    25381
      117    25382        %KL_TWSNREC      ( NAME      =  KL$TWSNREC,
      118    25383                           STCLASS   = "BASED(DSEG2$)");
      119    25408
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:5    
      120    25409    1   DCL 1 PP$STRCT BASED( PP$ ) UNAL ,
      121    25410    1          2 TYPE                UBIN BYTE UNAL ,
      122    25411    1          2 SIZE                UBIN BYTE UNAL ;
      123    25412
      124    25413    1   DCL 1 TEXT$C BASED ALIGNED,
      125    25414    1          2 CNT                 UBIN(9) UNAL ,
      126    25415    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      127    25416        /********************************************************************/
      128    25417        /*   Auto data       auto data       auto data       auto data      */
      129    25418        /********************************************************************/
      130    25419    1   DCL ARS                      SBIN;
      131    25420    1   DCL DADR$                    PTR;
      132    25421    1   DCL DEVNUM                   UBIN;
      133    25422    1   DCL I                        SBIN;
      134    25423    1   DCL J                        SBIN;
      135    25424    1   DCL JCL                      BIT(1);
      136    25425    1   DCL PP$                      PTR ;
      137    25426    1   DCL PP_END$                  PTR;
      138    25427    1   DCL PP_SIZE                  UBIN WORD ;
      139    25428    1   DCL PP_TYPE                  UBIN;
      140    25429    1   DCL PRO$                     PTR;
      141    25430    1   DCL TERM_TYPE                 UBIN;
      142    25431        %EJECT;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:6    
      143    25432        /********************************************************************/
      144    25433        /*   Constant data   constant data   constant data   constant data  */
      145    25434        /********************************************************************/
      146    25435        %KL_GJOB     ( NAME = KL_GJOB, STCLASS = CONSTANT);
      147    25459        %KL_HASP     ( NAME = KL_HASP, STCLASS = CONSTANT );
      148    25609        %KL_HASPDEV  ( NAME = KL_HASPDEV, STCLASS = CONSTANT);
      149    25843    1   DCL GJOB_JCL_FMT             CHAR(0) CONSTANT INIT
      150    25844    1       ('%3-GJOB = %>A%Q,%>A,%O%O%Q CMD = %>A');
      151    25845    1   DCL HASPCP_STR               CHAR(0) CONSTANT INIT('HASPCP') ;
      152    25846    1   DCL HASPCR_STR               CHAR(0) CONSTANT INIT('HASPCR') ;
      153    25847    1   DCL HASPLP_STR               CHAR(0) CONSTANT INIT('HASPLP') ;
      154    25848    1   DCL HASPLP2_STR              CHAR(0) CONSTANT INIT('HASPLP2') ;
      155    25849    1   DCL HASPLP3_STR              CHAR(0) CONSTANT INIT('HASPLP3') ;
      156    25850    1   DCL HASPOC_STR               CHAR(0) CONSTANT INIT('HASPOC') ;
      157    25851    1   DCL HEX2_FMT                 CHAR(0) CONSTANT INIT ('X''%Z2Y''');
      158    25852    1   DCL INOUT_STR                CHAR(0) CONSTANT INIT('INOUT');
      159    25853    1   DCL IN_STR                   CHAR(0) CONSTANT INIT('IN');
      160    25854    1   DCL NA_STR                   CHAR(0) CONSTANT INIT('(NA)');
      161    25855    1   DCL NONE_STR                 CHAR(0) CONSTANT INIT('NONE');
      162    25856    1   DCL NO_PASSWORD              CHAR(0) CONSTANT INIT(' "no password"');
      163    25857    1   DCL NO_STR                   CHAR(0) CONSTANT INIT('NO');
      164    25858    1   DCL OUT_STR                  CHAR(0) CONSTANT INIT('OUT');
      165    25859    1   DCL PASSWORD                 CHAR(0) CONSTANT INIT(',"password"');
      166    25860    1   DCL PASSWORD_JCL_FMT         CHAR(0) CONSTANT INIT
      167    25861    1       ('%3-PASSWORD = O''%12ZO%12ZO''');
      168    25862    1   DCL PROFILE_JCL_FMT          CHAR(0) CONSTANT INIT
      169    25863    1       ('%3-PROFILE = %>A');
      170    25864    1   DCL RLS_JCL_FMT              CHAR(0) CONSTANT INIT
      171    25865    1       ('%3-RLS = %>A');
      172    25866    1   DCL S2780CP_STR              CHAR(0) CONSTANT INIT('S2780CP') ;
      173    25867    1   DCL S2780CR_STR              CHAR(0) CONSTANT INIT('S2780CR') ;
      174    25868    1   DCL S2780LP_STR              CHAR(0) CONSTANT INIT('S2780LP') ;
      175    25869    1   DCL S3780CP_STR              CHAR(0) CONSTANT INIT('S3780CP') ;
      176    25870    1   DCL S3780CR_STR              CHAR(0) CONSTANT INIT('S3780CR') ;
      177    25871    1   DCL S3780LP_STR              CHAR(0) CONSTANT INIT('S3780LP') ;
      178    25872    1   DCL SLAVE_JCL_FMT            CHAR(0) CONSTANT INIT
      179    25873    1       ('%3-SLAVE = %0.N[NO%1?YES%]');
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:7    
      180    25874    1   DCL TCONSOLE_STR             CHAR(0) CONSTANT INIT('TCONSOLE');
      181    25875    1   DCL TDEV_STR                 CHAR(0) CONSTANT INIT('TDEVICE');
      182    25876    1   DCL TERMINAL_STR             CHAR(0) CONSTANT INIT('TERMINAL');
      183    25877    1   DCL TERM_CREATE_JCL_FMT      CHAR(0) CONSTANT INIT
      184    25878    1       ('CREATE TERMINAL %>A %0.N[ %1?2780%2?3780%3?IRBT%7?IRBT%] FOR STATION %>A');
      185    25879    1   DCL TERM_DEV_FMT             CHAR(0) CONSTANT INIT
      186    25880    1      ('%3-%A%A%14-%A%23-%A%36-%A%46-%A%56-X''%Z4Y''%64-X''%Z2Y''%71-');
      187    25881    1   DCL TERM_DEV_HDR             CHAR(0) CONSTANT INIT
      188    25882    1      ('  NAME      IO       PROFILE      PASSWORD  CONNECT   DEVCTL   SDNUM  DEVNUM');
      189    25883    1   DCL TERM_HDR_FMT             CHAR(0) CONSTANT INIT
      190    25884    1      ('%>A %>A  PRO=%>A  TYPE=%0.N[ %1?2780%2?3780%3?IRBT%7?IRBT%]');
      191    25885    1   DCL TERM_OPT_FMT             CHAR(0) CONSTANT INIT
      192    25886    1      ('    GJOB=%>A%Q,%>A%A%Q CMD=''%>A''');
      193    25887    1   DCL TERM_RLS_FMT             CHAR(0) CONSTANT INIT
      194    25888    1      ('    SLAVE=%A%/    RLS=%>A');
      195    25889    1   DCL TEXT_FMT                 CHAR(0) CONSTANT INIT ('%A');
      196    25890    1   DCL YES_STR                  CHAR(0) CONSTANT INIT('YES');
      197    25891        /********************************************************************/
      198    25892        /*   Procedure       procedure       procedure       procedure      */
      199    25893        /********************************************************************/
      200    25894                                            /*  FIND THE TERMINAL TYPE
      201    25895                                                BY FINDING AND TRANSLATING
      202    25896                                                THE PROFILES TYPE          */
      203    25897    1   PRO$ = DSEG3$;
      204    25898    1   ARS = DSEG3SIZE;
      205    25899    1   USERS_KEY = KL$TREC.PNAME;
      206    25900    1   CALL ASD$READ_PRO(USERS_KEY,KL$PHDR,ARS)
      207    25901    2   WHENRETURN DO;
      208    25902    3      IF KL$PHDR.TTYP ~= %KLTY_STRM# THEN DO;
      209    25903        /*E* ERROR: ASL-E$BADTERMPROTYPE-0
      210    25904             MESSAGE: The profile is not correct.
      211    25905             MESSAGE1: %U1 is not a terminal profile.
      212    25906        */
      213    25907              %SCREAM( ERR#=E$BADTERMPROTYPE, LEVEL=ERROR, MID='L' );
      214    25922    3         AS_FIELD1 = USERS_KEY;
      215    25923    3         TERM_TYPE = 0;
      216    25924    3         END;   /*  PROFILE TYPE NOT %KLTY_STRM#  */
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:8    
      217    25925        /*
      218    25926            Find the trmd portion of the profile just read in.
      219    25927            It contains a profile type for stream type profiles.
      220    25928            Compare that to the terminal type.
      221    25929        */
      222    25930    2      PP$ = PRO$;
      223    25931    2      PP_END$ = PINCRC( PP$, ARS ) ;
      224    25932    2      PP$ = PINCRW( PP$, SIZEW( KL$PHDR ) ) ;
      225    25933    3      DO WHILE ( PP$ < PP_END$ ) ;
      226    25934    3         PP_TYPE = PP$STRCT.TYPE ;
      227    25935    3         PP_SIZE = PP$STRCT.SIZE ;
      228    25936    3         PP$ = PINCRC( PP$, 2 ) ;
      229    25937
      230    25938    4         DO SELECT( PP_TYPE ) ;
      231    25939
      232    25940    4            SELECT( %KL_PRMID_TRMD ) ;
      233    25941    4               GOTO FOUND_IT;
      234    25942
      235    25943    4            END ; /*  Do case  */
      236    25944
      237    25945    3         I = PP_SIZE + (MOD (PP_SIZE, 2)); /* Force i to be even */
      238    25946    3         PP$ = PINCRC ( PP$, I ) ;
      239    25947
      240    25948    3         END ; /*  Do while  */
      241    25949
      242    25950    2         IF NOT (PP$ < PP_END$) THEN
      243    25951    2            TERM_TYPE = 0;
      244    25952    2         ELSE
      245    25953    2   FOUND_IT:
      246    25954    2      TERM_TYPE = PP$ -> KL$TRMD.PROTYP#;
      247    25955    2      END;  /*  WHENRETURN FROM ASD$READ_PRO  */
      248    25956    2   WHENALTRETURN DO;
      249    25957        /*E* ERROR: ASL-E$TERM_PRO_MISSING-0
      250    25958             MESSAGE: %U1 terminals profile is missing.
      251    25959             MESSAGE1: %U2 is not in %FN.
      252    25960        */
      253    25961    2         AS_FIELD1.TEXT = KL$TREC.TNAME;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:9    
      254    25962    2         AS_FIELD1.COUNT = LENGTHC (KL$TREC.TNAME);
      255    25963    2         AS_FIELD2 = USERS_KEY;
      256    25964    2         AS_DCBNUM# = DCBNUM(M$PRO);
      257    25965              %SCREAM( ERR#=E$TERM_PRO_MISSING, LEVEL=ERROR, MID='L' );
      258    25980    2         TERM_TYPE = 0;
      259    25981    2     END;   /*  WHENALTRETURN FROM ASD$READ_PRO  */
      260    25982
      261    25983    1   CALL ASB$WRITE_LO(' ',1);
      262    25984    1   CALL ASB$WRITE_LO(' ',1);
      263    25985
      264    25986    2   IF NOT JCL THEN DO;
      265    25987    2   FMT_VEC(0) = VECTOR(KL$TREC.TNAME);
      266    25988    2   FMT_VEC(1) = VECTOR(TERMINAL_STR);
      267    25989    2   FMT_VEC(2) = VECTOR(ADDR(KL$DREC.PNAME)->TEXT$C.TEXT);
      268    25990    2   FMT_VEC(3) = VECTOR ( TERM_TYPE );
      269    25991    2   FMT_BUF = TERM_HDR_FMT;
      270    25992    2   FDS.FMT_.BOUND = SIZEC(TERM_HDR_FMT)-1;
      271    25993    2   FDS.NVECS# = 4;
      272    25994    2   CALL X$FORMAT(FDS);
      273    25995    2   CALL ASB$WRITE_LO(' ',1);
      274    25996    3   IF KL$TREC.FLAGS.GJOB THEN DO;
      275    25997    3      FMT_VEC(0) = VECTOR(KL$TREC.GJOB.ACCT);
      276    25998    3      FMT_VEC(1) = VECTOR(KL$TREC.GJOB.UNAME);
      277    25999    3      IF KL$TREC.GJOB.PASS = BLANK_PASS THEN
      278    26000    3         FMT_VEC(2) = VECTOR(NO_PASSWORD);
      279    26001    3      ELSE
      280    26002    3         FMT_VEC(2) = VECTOR(PASSWORD);
      281    26003    3      IF KL$TREC.GJOB.CMDCNT = 0 THEN
      282    26004    3         FDS.NVECS# = 3;
      283    26005    4      ELSE DO;
      284    26006    4         FMT_VEC(3) = VECTOR(KL$TREC.GJOB.CMD);
      285    26007    4         FDS.NVECS# = 4;
      286    26008    4         END;
      287    26009    3      END;
      288    26010    3   ELSE DO;
      289    26011    3      FMT_VEC(0) = VECTOR(NONE_STR);
      290    26012    3      FDS.NVECS# = 1;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:10   
      291    26013    3      END;
      292    26014    2   FMT_BUF = TERM_OPT_FMT;
      293    26015    2   FDS.FMT_.BOUND = SIZEV(TERM_OPT_FMT);
      294    26016    2   CALL X$FORMAT( FDS );
      295    26017    2   CALL ASB$WRITE_LO ( AS_BLANK, 1 );
      296    26018    2   IF KL$TREC.HASP.SLAVE# THEN
      297    26019    2      FMT_VEC(0) = VECTOR (YES_STR);
      298    26020    2   ELSE
      299    26021    2      FMT_VEC(0) = VECTOR (NO_STR);
      300    26022
      301    26023    2   IF KL$TREC.HASP.RLS# = AS_BLANK THEN
      302    26024    2      FMT_VEC(1) = VECTOR (NONE_STR);
      303    26025    2   ELSE
      304    26026    2      FMT_VEC(1) = VECTOR (KL$TREC.HASP.RLS#);
      305    26027
      306    26028    2   FDS.NVECS# = 2;
      307    26029    2   FMT_BUF = TERM_RLS_FMT;
      308    26030    2   FDS.FMT_.BOUND = SIZEC (TERM_RLS_FMT);
      309    26031    2   CALL X$FORMAT (FDS);
      310    26032    2   CALL ASB$WRITE_LO ( AS_BLANK, 1 );
      311    26033    2   CALL ASB$WRITE_LO(TERM_DEV_HDR,SIZEC(TERM_DEV_HDR));
      312    26034    2   FDS.NVECS# = 9;
      313    26035    2   DEVNUM = 1;
      314    26036    2   CONFIG_KEY.TERMID.TERM.TERM_NAME = KL$TREC.TNAME;
      315    26037    2   CONFIG_KEY.TERMID.LEV = 2;
      316    26038    2   KL$HASPDEV$ = PINCRC (DSEG1$,LENGTHC (KL_DREC_CNT));
      317    26039    2   KL$HASPDEV$ = PINCRW (KL$HASPDEV$,SIZEW(KL_GJOB)+SIZEW(KL_HASP));
      318    26040    3   DO I=0 TO KL$TWSNREC.NDEV-1;
      319    26041    3      IF KL$TWSNREC.DEVS.TDEV(I) AND KL$TWSNREC.DEVS.TERM(I)=KL$TREC.TNAME
      320    26042    4      THEN DO;
      321    26043    4         FMT_BUF = TERM_DEV_FMT;
      322    26044    4         FDS.FMT_.BOUND = SIZEC(TERM_DEV_FMT)-1;
      323    26045    4         FMT_VEC(0) = VECTOR(KL$TWSNREC.DEVS.TYP(I));
      324    26046    4         FMT_VEC(1) = VECTOR(KL$TWSNREC.DEVS.NUM(I));
      325    26047    4         IF KL$TWSNREC.DEVS.IO.INPUT(I)
      326    26048    4         THEN
      327    26049    4            IF KL$TWSNREC.DEVS.IO.OUTPUT(I)
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:11   
      328    26050    4            THEN
      329    26051    4               FMT_VEC(2) = VECTOR(INOUT_STR);
      330    26052    4            ELSE
      331    26053    4               FMT_VEC(2) = VECTOR(IN_STR);
      332    26054    4         ELSE
      333    26055    4            IF KL$TWSNREC.DEVS.IO.OUTPUT(I)
      334    26056    4            THEN
      335    26057    4               FMT_VEC(2) = VECTOR(OUT_STR);
      336    26058    4            ELSE
      337    26059    4               FMT_VEC(2) = VECTOR(NONE_STR);
      338    26060    4         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(0) = DEVNUM/256;
      339    26061    4         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(1) = MOD(DEVNUM,256);
      340    26062    4         DEVNUM = DEVNUM + 1;
      341    26063    4         CALL ASB$READ_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG_BUF))
      342    26064    5         WHENRETURN DO;
      343    26065    5            KL_SS.SGN_R = LINCNFG.LGN.LGNSTRING;
      344    26066    5            END;
      345    26067    5         WHENALTRETURN DO;
      346    26068    5            KL_SS.SGN_R = ' ';
      347    26069    5            END;
      348    26070    4         FMT_VEC(3) = VECTOR(KL_SS.SGN.PNAME);
      349    26071    4         FMT_VEC(4) = VECTOR(NA_STR);
      350    26072    4         IF (SUBSTR (KL$TWSNREC.DEVS.TYP (I), 0, 2) = 'OC')
      351    26073    5         THEN DO;
      352    26074    5            FMT_VEC (5) = VECTOR (TCONSOLE_STR);
      353    26075    5            END;
      354    26076    5         ELSE DO;
      355    26077    5            FMT_VEC (5) = VECTOR (TDEV_STR);
      356    26078    5            END;
      357    26079    4         FMT_VEC(6) = VECTOR (KL$HASPDEV.DADR.DEVCTL);
      358    26080    4         FMT_VEC(7) = VECTOR (KL$HASPDEV.DADR.SDNUM#);
      359    26081
      360    26082    5         DO SELECT ( BITBIN(KL$HASPDEV.DADR.DEVNUM#) ) ;
      361    26083
      362    26084    5            SELECT ( %BITBIN(%KLDN_2780LP#) ) ;
      363    26085
      364    26086    5               FMT_VEC(8) = VECTOR(S2780LP_STR) ;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:12   
      365    26087    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      366    26088    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      367    26089
      368    26090    5            SELECT ( %BITBIN(%KLDN_2780CR#) ) ;
      369    26091
      370    26092    5               FMT_VEC(8) = VECTOR(S2780CR_STR) ;
      371    26093    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      372    26094    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      373    26095
      374    26096    5            SELECT ( %BITBIN(%KLDN_2780CP#) ) ;
      375    26097
      376    26098    5               FMT_VEC(8) = VECTOR(S2780CP_STR) ;
      377    26099    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      378    26100    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      379    26101
      380    26102    5            SELECT ( %BITBIN(%KLDN_3780LP#) ) ;
      381    26103
      382    26104    5               FMT_VEC(8) = VECTOR(S3780LP_STR) ;
      383    26105    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      384    26106    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      385    26107
      386    26108    5            SELECT ( %BITBIN(%KLDN_3780CR#) ) ;
      387    26109
      388    26110    5               FMT_VEC(8) = VECTOR(S3780CR_STR) ;
      389    26111    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      390    26112    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      391    26113
      392    26114    5            SELECT ( %BITBIN(%KLDN_3780CP#) ) ;
      393    26115
      394    26116    5               FMT_VEC(8) = VECTOR(S3780CP_STR) ;
      395    26117    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      396    26118    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      397    26119
      398    26120    5            SELECT ( %BITBIN(%KLDN_HASPOC#) ) ;
      399    26121
      400    26122    5               FMT_VEC(8) = VECTOR(HASPOC_STR) ;
      401    26123    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:13   
      402    26124    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      403    26125
      404    26126    5            SELECT ( %BITBIN(%KLDN_HASPLP#) ) ;
      405    26127
      406    26128    5               FMT_VEC(8) = VECTOR(HASPLP_STR) ;
      407    26129    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      408    26130    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      409    26131
      410    26132    5            SELECT ( %BITBIN(%KLDN_HASPCR#) ) ;
      411    26133
      412    26134    5               FMT_VEC(8) = VECTOR(HASPCR_STR) ;
      413    26135    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      414    26136    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      415    26137
      416    26138    5            SELECT ( %BITBIN(%KLDN_HASPCP#) ) ;
      417    26139
      418    26140    5               FMT_VEC(8) = VECTOR(HASPCP_STR) ;
      419    26141    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      420    26142    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      421    26143
      422    26144    5            SELECT ( %BITBIN(%KLDN_HASPLP2#) ) ;
      423    26145
      424    26146    5               FMT_VEC(8) = VECTOR(HASPLP2_STR) ;
      425    26147    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      426    26148    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      427    26149
      428    26150    5            SELECT ( %BITBIN(%KLDN_HASPLP3#) ) ;
      429    26151
      430    26152    5               FMT_VEC(8) = VECTOR(HASPLP3_STR) ;
      431    26153    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
      432    26154    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;
      433    26155
      434    26156    5            SELECT ( ELSE ) ;
      435    26157
      436    26158    5               FMT_VEC(8) = VECTOR( KL$HASPDEV.DADR.DEVNUM# ) ;
      437    26159    5               CALL INSERT (FMT_BUF, FDS.FMT_.BOUND+1,LENGTHC(HEX2_FMT),HEX2_FMT);
      438    26160    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (HEX2_FMT) ;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:14   
      439    26161
      440    26162    5            END; /*  Case DEVNUM#  */
      441    26163
      442    26164    4         CALL X$FORMAT(FDS);
      443    26165    4         KL$HASPDEV$ = PINCRW (KL$HASPDEV$,SIZEW(KL_HASPDEV));
      444    26166    4         END; /*  End of then do */
      445    26167    3      END;            /*  End of do i  */
      446    26168    2     END;   /*  NOT JCL  */
      447    26169    2   ELSE DO;  /*  JCL  */
      448    26170    2      FMT_VEC (0) = VECTOR ( KL$TREC.TNAME );
      449    26171    2      FMT_VEC (1) = VECTOR ( TERM_TYPE );
      450    26172    2      FMT_VEC (2) = VECTOR ( KL$TREC.SNAME );
      451    26173    2      FMT_BUF = TERM_CREATE_JCL_FMT;
      452    26174    2      FDS.FMT_.BOUND = SIZEC ( TERM_CREATE_JCL_FMT ) - 1;
      453    26175    2      FDS.NVECS# = 3;
      454    26176    2      CALL X$FORMAT(FDS);
      455    26177    3      IF KL$TREC.FLAGS.GJOB THEN DO;
      456    26178    3         FMT_VEC (0) = VECTOR ( KL$TREC.GJOB.ACCT );
      457    26179    3         FMT_VEC (1) = VECTOR ( KL$TREC.GJOB.UNAME );
      458    26180    3         FMT_VEC (2) = VECTOR (SUBSTR ( KL$TREC.GJOB.PASS,0,4 ));
      459    26181    3         FMT_VEC (3) = VECTOR (SUBSTR ( KL$TREC.GJOB.PASS,4,4 ));
      460    26182    3         IF KL$TREC.GJOB.CMDCNT = 0 THEN
      461    26183    3            FDS.NVECS# = 4;
      462    26184    4         ELSE DO;
      463    26185    4            FMT_VEC (4) = VECTOR ( KL$TREC.GJOB.CMD );
      464    26186    4            FDS.NVECS# = 5;
      465    26187    4            END;  /*  GJOB.CMDCNT > 0  */
      466    26188    3         END;  /*  FLAGS.GJOB  */
      467    26189    3      ELSE DO;     /*  NOT FLAGS.GJOB  */
      468    26190    3         FMT_VEC (0) = VECTOR ( NONE_STR );
      469    26191    3         FDS.NVECS# = 1;
      470    26192    3         END;      /*  NOT FLAGS.GJOB  */
      471    26193    2      FMT_BUF = GJOB_JCL_FMT;
      472    26194    2      FDS.FMT_.BOUND = SIZEV ( GJOB_JCL_FMT);
      473    26195    2      CALL X$FORMAT( FDS );
      474    26196
      475    26197    2      FMT_VEC (0) = VECTOR (SUBSTR ( KL$TREC.PASSWORD,0,4 ));
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:15   
      476    26198    2      FMT_VEC (1) = VECTOR (SUBSTR ( KL$TREC.PASSWORD,4,4 ));
      477    26199    2      FMT_BUF = PASSWORD_JCL_FMT;
      478    26200    2      FDS.FMT_.BOUND = SIZEV ( PASSWORD_JCL_FMT);
      479    26201    2      FDS.NVECS# = 2;
      480    26202    2      CALL X$FORMAT( FDS );
      481    26203
      482    26204    2      FMT_VEC (0) = VECTOR ( KL$TREC.PNAME.TXT );
      483    26205    2      FMT_BUF = PROFILE_JCL_FMT;
      484    26206    2      FDS.FMT_.BOUND = SIZEV ( PROFILE_JCL_FMT);
      485    26207    2      FDS.NVECS# = 1;
      486    26208    2      CALL X$FORMAT( FDS );
      487    26209
      488    26210    2      IF KL$TREC.HASP.RLS# = AS_BLANK THEN
      489    26211    2         FMT_VEC (0) = VECTOR ( NONE_STR );
      490    26212    2      ELSE
      491    26213    2         FMT_VEC (0) = VECTOR ( KL$TREC.HASP.RLS# );
      492    26214    2      FMT_BUF = RLS_JCL_FMT;
      493    26215    2      FDS.FMT_.BOUND = SIZEV ( RLS_JCL_FMT);
      494    26216    2      FDS.NVECS# = 1;
      495    26217    2      CALL X$FORMAT( FDS );
      496    26218
      497    26219    2      I = BITBIN ( KL$TREC.HASP.SLAVE#);
      498    26220    2      FMT_VEC(0) = VECTOR ( I );
      499    26221    2      FMT_BUF = SLAVE_JCL_FMT;
      500    26222    2      FDS.FMT_.BOUND = SIZEV ( SLAVE_JCL_FMT);
      501    26223    2      FDS.NVECS# = 1;
      502    26224    2      CALL X$FORMAT( FDS );
      503    26225
      504    26226        /*  READ THE DEVICE RECORDS AND THEN CALL
      505    26227             ASL$DISP_ONE_DEVICE  */
      506    26228
      507    26229    3   DO I=0 TO KL$TWSNREC.NDEV-1;
      508    26230    3      IF KL$TWSNREC.DEVS.TDEV(I) AND KL$TWSNREC.DEVS.TERM(I)=KL$TREC.TNAME
      509    26231    4      THEN DO;
      510    26232    4         USERS_KEY.COUNT = 8;
      511    26233    4         CALL CONCAT (USERS_KEY.TXTC,
      512    26234    4                      KL$TWSNREC.DEVS.TYP(I),
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:16   
      513    26235    4                      KL$TWSNREC.DEVS.NUM(I),
      514    26236    4                      KL$TREC.TWSN#);
      515    26237    4         ARS = DSEG3SIZE;
      516    26238    4         CALL ASB$READ_HLP (DSEG3$, ARS, 3)
      517    26239    5         WHENALTRETURN DO;
      518    26240    5            CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      519    26241    5            RETURN;
      520    26242    5            END;  /*  WHENALTRETURN  */
      521    26243    4         CALL ASL$DISP_ONE_DEVICE ( %YES#, %YES# );
      522    26244    4         END; /*  End of TDEV and TWSNREC.TERM = TREC.TNAME  */
      523    26245    3      END;            /*  End of do i  */
      524    26246
      525    26247    2      CALL ASB$WRITE_LO(' ',1);
      526    26248    2      END;            /*  End JCL  */
      527    26249    1   RETURN;
      528    26250    1   END ASL$DISP_ONE_TERMINAL;

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:17   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_TERMINAL.

   Procedure ASL$DISP_ONE_TERMINAL requires 866 words for executable code.
   Procedure ASL$DISP_ONE_TERMINAL requires 20 words of local(AUTO) storage.

    No errors detected in file ASL$DISPLAY_TERMINAL.:E05TSI    .

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:18   

 Object Unit name= ASL$DISP_ONE_TERMINAL                      File name= ASL$DISPLAY_TERMINAL.:E05TOU
 UTS= JUL 29 '97 09:56:56.20 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$LO
    2   DCB   even  none     0      0  M$PRO
    3   Data  even  none    64    100  ASL$DISP_ONE_TERMINAL
    4  RoData even  UTS    221    335  ASL$DISP_ONE_TERMINAL
    5   Proc  even  none   866   1542  ASL$DISP_ONE_TERMINAL
    6  RoData even  none    88    130  ASL$DISP_ONE_TERMINAL

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     5      0   yes            yes      Std        1  ASL$DISP_ONE_TERMINAL
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:19   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASB$WRITE_LO
 yes     yes           Std       3 ASD$READ_PRO
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASL$DISP_ONE_DEVICE
         yes           Std       2 ASH$ERROR
 yes     yes           Std       3 ASB$READ_NETCON
         yes           Std       3 ASA$ERROR
                       nStd      0 X66_AUTO_1
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                             r    AS_BLANK                         r    AS_MODE
r    AS_FE_MODE                            M$LO                                  USERS_KEY
     FDS                                   FMT_BUF                               FMT_VEC
     BLANK_PASS                            ERR_CODE                              AS_FIELD1
     AS_FIELD2                             REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG1$                                DSEG2$
     DSEG3$                                DSEG3SIZE                             AS_DCBNUM#
     KL_DREC_CNT                           M$PRO                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:20   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        ASL$DISP_ONE_TERMINAL: PROC (JCL);

      6  5 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_1
         5 000001   000024 000001                    ZERO    20,1

        7        7        /**********************************************************/
        8        8
        9        9        /*D* NAME:     ASL$DISP_ONE_TERMINAL
       10       10             CALL:     CALL ASL$DISP_ONE_TERMINAL (JCL)
       11       11             INPUT:    JCL -     Bit indicating JCL mode.
       12       12             OUTPUT:   Nothing is returned.
       13       13             DESCRIPTION:  ASL$DISP_ONE_TERMINAL is a subroutine to handle
       14       14                           the DISP TERMINAL command for SUPER.
       15       15                           This routine will display the information in
       16       16                           the terminal record in data segment 1.  It will
       17       17                           also use some of the information in the TWSN record
       18       18                           in data segment 2.
       19       19                           It will also read the individual device records
       20       20                           from :NETCON to pick up the signon string for the
       21       21                           device. The device record will be read into
       22       22                           auto memory.
       23       23                  MEMORY REQUIREMENTS:
       24       24                           For all of the routines that deal with listing/
       25       25                           displaying terminals:
       26       26
       27       27                            ASL$DISP_ONE_TERMINALS
       28       28                            ASL$DISP_ONE_TERMINAL
       29       29                            ASB$INIT_GET_TERMINAL
       30       30                            ASB$GET_NEXT_TERMINAL
       31       31
       32       32                           Data segment 1 will be used for reading records
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:21   
       33       33                           from :HLP.  Terminal records will be left in data
       34       34                           segment 1.  Device records from :NETCON for
       35       35                           devices that belong to the current terminal will
       36       36                           be read one at a time into auto memory.
       37       37                           Data segment 2 will be used for the TWSN9999 record
       38       38                           associated with the terminal record in data segment
       39       39                           1.
       40       40                           If this is a JCL mode display, this routine will
       41       41                           also read the necessary device records into data
       42       42                           segment 3 and call ASL$DISP_ONE_DEVICE, so that
       43       43                           the current terminal will be created correctly.
       44       44        */
       45       45        %EJECT;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:22   
       46       46        /********************************************************************/
       47       47        /*   Include files   include files   include files   include files  */
       48       48        /********************************************************************/
       49       49        %INCLUDE AS_PERR_C;
       50      651        %INCLUDE AS_SUPER_C;
       51     1086        %INCLUDE AS_SUBS_C;
       52     2500        %INCLUDE AS_MAC_C;
       53     2580        %INCLUDE AS_ENTRIES_M;
       54     3630        %INCLUDE AS_SSUBS_C;
       55     3722        %INCLUDE B_ERRORS_C;
       56     4849        %INCLUDE CP_6;
       57    10408        %INCLUDE CP_6_SUBS ;
       58    10948        %INCLUDE KL_CONFIG_M;
       59    11710        %INCLUDE KL_MACRO_C;
       60    15062        %INCLUDE KL_SUPER_C;
       61    17964        %INCLUDE XU_MACRO_C;
       62    21070        %INCLUDE XU_FORMAT_C;
       63    21232        %INCLUDE AS_SUPER_R;
       64    24248        /********************************************************************/
       65    24249        /*   dcbs           dcbs           dcbs           dcbs              */
       66    24250        /********************************************************************/
       67    24251    1   DCL M$PRO DCB;
       68    24252        /********************************************************************/
       69    24253        /*   Static data     static data     static data     static data    */
       70    24254        /********************************************************************/
       71    24255    1   DCL KL$HASPDEV$              PTR STATIC;
       72    24256    1   DCL LINCNFG_BUF    (0:49)    UBIN WORD STATIC INIT(0*0);
       73    24257    1   DCL LINCNFG$                 PTR STATIC INIT(ADDR(LINCNFG_BUF));
       74    24258        %KL$CONFIG_KEY ( NAME = CONFIG_KEY, STCLASS = STATIC);
       75    24305        %KL$LINCNFG    ( NAME = LINCNFG, STCLASS = "BASED(LINCNFG$)");
       76    24463        %KL_SS;
       77    24498        /********************************************************************/
       78    24499        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       79    24500        /********************************************************************/
       80    24501        %ASA$ERROR ;
       81    24504        %ASB$READ_HLP ;
       82    24507        %ASB$READ_NETCON ;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:23   
       83    24510        %ASB$WRITE_LO ;
       84    24513        %ASD$READ_PRO ;
       85    24516        %ASH$ERROR ;
       86    24519        %ASL$DISP_ONE_DEVICE ;
       87    24522    1   DCL X$FORMAT ENTRY(1) ;
       88    24523        /********************************************************************/
       89    24524        /*   Local based     local based     local based     local based    */
       90    24525        /********************************************************************/
       91    24526        %KL_DREC         ( NAME      =  KL$DREC,
       92    24527                           LAST      = ";",
       93    24528                           STCLASS   = "BASED(DSEG1$)") ;
       94    24641
       95    24642        %KL_HASPDEV      ( NAME      = KL$HASPDEV,
       96    24643                           STCLASS   = "BASED(KL$HASPDEV$)");
       97    24877
       98    24878        %KL_PHDR         ( NAME      = KL$PHDR ,
       99    24879                           STCLASS   = "BASED( PRO$ )") ;
      100    24920
      101    24921        %KL_DREC         ( NAME      = KL$TREC,
      102    24922                           STCLASS   = "BASED(DSEG1$)",
      103    24923                           LAST      = ",");
      104    25036
      105    25037        %KL_GJOB         ( NAME      = GJOB,
      106    25038                           STCLASS   = BASED,
      107    25039                           LVL       = 2,
      108    25040                           LAST      = "," );
      109    25064
      110    25065        %KL_HASP         ( NAME      = HASP,
      111    25066                           STCLASS   = BASED,
      112    25067                           LVL       = 2 );
      113    25217
      114    25218        %KL_TRMD         ( NAME      = KL$TRMD ,
      115    25219                           STCLASS   = "BASED UNAL") ;
      116    25381
      117    25382        %KL_TWSNREC      ( NAME      =  KL$TWSNREC,
      118    25383                           STCLASS   = "BASED(DSEG2$)");
      119    25408
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:24   
      120    25409    1   DCL 1 PP$STRCT BASED( PP$ ) UNAL ,
      121    25410    1          2 TYPE                UBIN BYTE UNAL ,
      122    25411    1          2 SIZE                UBIN BYTE UNAL ;
      123    25412
      124    25413    1   DCL 1 TEXT$C BASED ALIGNED,
      125    25414    1          2 CNT                 UBIN(9) UNAL ,
      126    25415    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      127    25416        /********************************************************************/
      128    25417        /*   Auto data       auto data       auto data       auto data      */
      129    25418        /********************************************************************/
      130    25419    1   DCL ARS                      SBIN;
      131    25420    1   DCL DADR$                    PTR;
      132    25421    1   DCL DEVNUM                   UBIN;
      133    25422    1   DCL I                        SBIN;
      134    25423    1   DCL J                        SBIN;
      135    25424    1   DCL JCL                      BIT(1);
      136    25425    1   DCL PP$                      PTR ;
      137    25426    1   DCL PP_END$                  PTR;
      138    25427    1   DCL PP_SIZE                  UBIN WORD ;
      139    25428    1   DCL PP_TYPE                  UBIN;
      140    25429    1   DCL PRO$                     PTR;
      141    25430    1   DCL TERM_TYPE                 UBIN;
      142    25431        %EJECT;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:25   
      143    25432        /********************************************************************/
      144    25433        /*   Constant data   constant data   constant data   constant data  */
      145    25434        /********************************************************************/
      146    25435        %KL_GJOB     ( NAME = KL_GJOB, STCLASS = CONSTANT);
      147    25459        %KL_HASP     ( NAME = KL_HASP, STCLASS = CONSTANT );
      148    25609        %KL_HASPDEV  ( NAME = KL_HASPDEV, STCLASS = CONSTANT);
      149    25843    1   DCL GJOB_JCL_FMT             CHAR(0) CONSTANT INIT
      150    25844    1       ('%3-GJOB = %>A%Q,%>A,%O%O%Q CMD = %>A');
      151    25845    1   DCL HASPCP_STR               CHAR(0) CONSTANT INIT('HASPCP') ;
      152    25846    1   DCL HASPCR_STR               CHAR(0) CONSTANT INIT('HASPCR') ;
      153    25847    1   DCL HASPLP_STR               CHAR(0) CONSTANT INIT('HASPLP') ;
      154    25848    1   DCL HASPLP2_STR              CHAR(0) CONSTANT INIT('HASPLP2') ;
      155    25849    1   DCL HASPLP3_STR              CHAR(0) CONSTANT INIT('HASPLP3') ;
      156    25850    1   DCL HASPOC_STR               CHAR(0) CONSTANT INIT('HASPOC') ;
      157    25851    1   DCL HEX2_FMT                 CHAR(0) CONSTANT INIT ('X''%Z2Y''');
      158    25852    1   DCL INOUT_STR                CHAR(0) CONSTANT INIT('INOUT');
      159    25853    1   DCL IN_STR                   CHAR(0) CONSTANT INIT('IN');
      160    25854    1   DCL NA_STR                   CHAR(0) CONSTANT INIT('(NA)');
      161    25855    1   DCL NONE_STR                 CHAR(0) CONSTANT INIT('NONE');
      162    25856    1   DCL NO_PASSWORD              CHAR(0) CONSTANT INIT(' "no password"');
      163    25857    1   DCL NO_STR                   CHAR(0) CONSTANT INIT('NO');
      164    25858    1   DCL OUT_STR                  CHAR(0) CONSTANT INIT('OUT');
      165    25859    1   DCL PASSWORD                 CHAR(0) CONSTANT INIT(',"password"');
      166    25860    1   DCL PASSWORD_JCL_FMT         CHAR(0) CONSTANT INIT
      167    25861    1       ('%3-PASSWORD = O''%12ZO%12ZO''');
      168    25862    1   DCL PROFILE_JCL_FMT          CHAR(0) CONSTANT INIT
      169    25863    1       ('%3-PROFILE = %>A');
      170    25864    1   DCL RLS_JCL_FMT              CHAR(0) CONSTANT INIT
      171    25865    1       ('%3-RLS = %>A');
      172    25866    1   DCL S2780CP_STR              CHAR(0) CONSTANT INIT('S2780CP') ;
      173    25867    1   DCL S2780CR_STR              CHAR(0) CONSTANT INIT('S2780CR') ;
      174    25868    1   DCL S2780LP_STR              CHAR(0) CONSTANT INIT('S2780LP') ;
      175    25869    1   DCL S3780CP_STR              CHAR(0) CONSTANT INIT('S3780CP') ;
      176    25870    1   DCL S3780CR_STR              CHAR(0) CONSTANT INIT('S3780CR') ;
      177    25871    1   DCL S3780LP_STR              CHAR(0) CONSTANT INIT('S3780LP') ;
      178    25872    1   DCL SLAVE_JCL_FMT            CHAR(0) CONSTANT INIT
      179    25873    1       ('%3-SLAVE = %0.N[NO%1?YES%]');
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:26   
      180    25874    1   DCL TCONSOLE_STR             CHAR(0) CONSTANT INIT('TCONSOLE');
      181    25875    1   DCL TDEV_STR                 CHAR(0) CONSTANT INIT('TDEVICE');
      182    25876    1   DCL TERMINAL_STR             CHAR(0) CONSTANT INIT('TERMINAL');
      183    25877    1   DCL TERM_CREATE_JCL_FMT      CHAR(0) CONSTANT INIT
      184    25878    1       ('CREATE TERMINAL %>A %0.N[ %1?2780%2?3780%3?IRBT%7?IRBT%] FOR STATION %>A');
      185    25879    1   DCL TERM_DEV_FMT             CHAR(0) CONSTANT INIT
      186    25880    1      ('%3-%A%A%14-%A%23-%A%36-%A%46-%A%56-X''%Z4Y''%64-X''%Z2Y''%71-');
      187    25881    1   DCL TERM_DEV_HDR             CHAR(0) CONSTANT INIT
      188    25882    1      ('  NAME      IO       PROFILE      PASSWORD  CONNECT   DEVCTL   SDNUM DEVNUM');
      189    25883    1   DCL TERM_HDR_FMT             CHAR(0) CONSTANT INIT
      190    25884    1      ('%>A %>A  PRO=%>A  TYPE=%0.N[ %1?2780%2?3780%3?IRBT%7?IRBT%]');
      191    25885    1   DCL TERM_OPT_FMT             CHAR(0) CONSTANT INIT
      192    25886    1      ('    GJOB=%>A%Q,%>A%A%Q CMD=''%>A''');
      193    25887    1   DCL TERM_RLS_FMT             CHAR(0) CONSTANT INIT
      194    25888    1      ('    SLAVE=%A%/    RLS=%>A');
      195    25889    1   DCL TEXT_FMT                 CHAR(0) CONSTANT INIT ('%A');
      196    25890    1   DCL YES_STR                  CHAR(0) CONSTANT INIT('YES');
      197    25891        /********************************************************************/
      198    25892        /*   Procedure       procedure       procedure       procedure      */
      199    25893        /********************************************************************/
      200    25894                                            /*  FIND THE TERMINAL TYPE
      201    25895                                                BY FINDING AND TRANSLATING
      202    25896                                                THE PROFILES TYPE          */
      203    25897    1   PRO$ = DSEG3$;

  25897  5 000002   000000 236000 xsym               LDQ     DSEG3$
         5 000003   200015 756100                    STQ     PRO$,,AUTO

      204    25898    1   ARS = DSEG3SIZE;

  25898  5 000004   000000 235000 xsym               LDA     DSEG3SIZE
         5 000005   200004 755100                    STA     ARS,,AUTO

      205    25899    1   USERS_KEY = KL$TREC.PNAME;

  25899  5 000006   000000 470400 xsym               LDP0    DSEG1$
         5 000007   000000 100500                    MLR     fill='000'O
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:27   
         5 000010   000004 000014                    ADSC9   4,,PR0                   cn=0,n=12
         5 000011   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      206    25900    1   CALL ASD$READ_PRO(USERS_KEY,KL$PHDR,ARS)

  25900  5 000012   200004 631500                    EPPR1   ARS,,AUTO
         5 000013   200022 451500                    STP1    TERM_TYPE+4,,AUTO
         5 000014   000000 235000 6                  LDA     0
         5 000015   200020 757100                    STAQ    TERM_TYPE+2,,AUTO
         5 000016   200020 630500                    EPPR0   TERM_TYPE+2,,AUTO
         5 000017   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 000020   000000 701000 xent               TSX1    ASD$READ_PRO
         5 000021   000114 702000 5                  TSX2    s:25961

      207    25901    2   WHENRETURN DO;

      208    25902    3      IF KL$PHDR.TTYP ~= %KLTY_STRM# THEN DO;

  25902  5 000022   200015 470500                    LDP0    PRO$,,AUTO
         5 000023   000100 101500                    MRL     fill='000'O
         5 000024   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         5 000025   200020 000004                    ADSC9   TERM_TYPE+2,,AUTO        cn=0,n=4
         5 000026   200020 236100                    LDQ     TERM_TYPE+2,,AUTO
         5 000027   000003 116007                    CMPQ    3,DL
         5 000030   000041 600000 5                  TZE     s:25930

      209    25903        /*E* ERROR: ASL-E$BADTERMPROTYPE-0
      210    25904             MESSAGE: The profile is not correct.
      211    25905             MESSAGE1: %U1 is not a terminal profile.
      212    25906        */
      213    25907              %SCREAM( ERR#=E$BADTERMPROTYPE, LEVEL=ERROR, MID='L' );

  25919  5 000031   000001 630400 6                  EPPR0   1
         5 000032   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000033   000000 701000 xent               TSX1    ASH$ERROR
         5 000034   000000 011000                    NOP     0

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:28   
      214    25922    3         AS_FIELD1 = USERS_KEY;

  25922  5 000035   000000 100400                    MLR     fill='000'O
         5 000036   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         5 000037   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      215    25923    3         TERM_TYPE = 0;

  25923  5 000040   200016 450100                    STZ     TERM_TYPE,,AUTO

      216    25924    3         END;   /*  PROFILE TYPE NOT %KLTY_STRM#  */

      217    25925        /*
      218    25926            Find the trmd portion of the profile just read in.
      219    25927            It contains a profile type for stream type profiles.
      220    25928            Compare that to the terminal type.
      221    25929        */
      222    25930    2      PP$ = PRO$;

  25930  5 000041   200015 236100                    LDQ     PRO$,,AUTO
         5 000042   200011 756100                    STQ     PP$,,AUTO

      223    25931    2      PP_END$ = PINCRC( PP$, ARS ) ;

  25931  5 000043   200004 236100                    LDQ     ARS,,AUTO
         5 000044   000020 736000                    QLS     16
         5 000045   200011 036100                    ADLQ    PP$,,AUTO
         5 000046   200012 756100                    STQ     PP_END$,,AUTO

      224    25932    2      PP$ = PINCRW( PP$, SIZEW( KL$PHDR ) ) ;

  25932  5 000047   200011 236100                    LDQ     PP$,,AUTO
         5 000050   000024 036003                    ADLQ    20,DU
         5 000051   200011 756100                    STQ     PP$,,AUTO

      225    25933    3      DO WHILE ( PP$ < PP_END$ ) ;

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:29   
  25933  5 000052   200012 116100                    CMPQ    PP_END$,,AUTO
         5 000053   000104 603000 5                  TRC     s:25950

      226    25934    3         PP_TYPE = PP$STRCT.TYPE ;

  25934  5 000054   200011 470500                    LDP0    PP$,,AUTO
         5 000055   003100 061500                    CSR     bolr='003'O
         5 000056   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         5 000057   200014 000044                    BDSC    PP_TYPE,,AUTO            by=0,bit=0,n=36

      227    25935    3         PP_SIZE = PP$STRCT.SIZE ;

  25935  5 000060   003100 061500                    CSR     bolr='003'O
         5 000061   000000 200011                    BDSC    0,,PR0                   by=1,bit=0,n=9
         5 000062   200013 000044                    BDSC    PP_SIZE,,AUTO            by=0,bit=0,n=36

      228    25936    3         PP$ = PINCRC( PP$, 2 ) ;

  25936  5 000063   200011 236100                    LDQ     PP$,,AUTO
         5 000064   400000 036007                    ADLQ    -131072,DL
         5 000065   200011 756100                    STQ     PP$,,AUTO

      229    25937
      230    25938    4         DO SELECT( PP_TYPE ) ;

  25938  5 000066   200014 235100                    LDA     PP_TYPE,,AUTO
         5 000067   000015 115007                    CMPA    13,DL
         5 000070   000073 601000 5                  TNZ     s:25945
         5 000071   000072 710000 5                  TRA     s:25941

      231    25939
      232    25940    4            SELECT( %KL_PRMID_TRMD ) ;

      233    25941    4               GOTO FOUND_IT;

  25941  5 000072   000107 710000 5                  TRA     FOUND_IT

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:30   
      234    25942
      235    25943    4            END ; /*  Do case  */

      236    25944
      237    25945    3         I = PP_SIZE + (MOD (PP_SIZE, 2)); /* Force i to be even */

  25945  5 000073   200013 236100                    LDQ     PP_SIZE,,AUTO
         5 000074   000001 376007                    ANQ     1,DL
         5 000075   200013 036100                    ADLQ    PP_SIZE,,AUTO
         5 000076   200007 756100                    STQ     I,,AUTO

      238    25946    3         PP$ = PINCRC ( PP$, I ) ;

  25946  5 000077   000020 736000                    QLS     16
         5 000100   200011 036100                    ADLQ    PP$,,AUTO
         5 000101   200011 756100                    STQ     PP$,,AUTO

      239    25947
      240    25948    3         END ; /*  Do while  */

  25948  5 000102   200012 116100                    CMPQ    PP_END$,,AUTO
         5 000103   000054 602000 5                  TNC     s:25934

      241    25949
      242    25950    2         IF NOT (PP$ < PP_END$) THEN

  25950  5 000104   000107 602000 5                  TNC     FOUND_IT

      243    25951    2            TERM_TYPE = 0;

  25951  5 000105   200016 450100                    STZ     TERM_TYPE,,AUTO
         5 000106   000113 710000 5                  TRA     s:25955

      244    25952    2         ELSE
      245    25953    2   FOUND_IT:
      246    25954    2      TERM_TYPE = PP$ -> KL$TRMD.PROTYP#;

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:31   
  25954  5 000107   200011 470500       FOUND_IT     LDP0    PP$,,AUTO
         5 000110   003100 061500                    CSR     bolr='003'O
         5 000111   000000 000011                    BDSC    0,,PR0                   by=0,bit=0,n=9
         5 000112   200016 000044                    BDSC    TERM_TYPE,,AUTO          by=0,bit=0,n=36

      247    25955    2      END;  /*  WHENRETURN FROM ASD$READ_PRO  */

  25955  5 000113   000134 710000 5                  TRA     s:25983

      248    25956    2   WHENALTRETURN DO;

      249    25957        /*E* ERROR: ASL-E$TERM_PRO_MISSING-0
      250    25958             MESSAGE: %U1 terminals profile is missing.
      251    25959             MESSAGE1: %U2 is not in %FN.
      252    25960        */
      253    25961    2         AS_FIELD1.TEXT = KL$TREC.TNAME;

  25961  5 000114   000000 470400 xsym               LDP0    DSEG1$
         5 000115   040000 100500                    MLR     fill='040'O
         5 000116   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000117   000000 200050 xsym               ADSC9   AS_FIELD1                cn=1,n=40

      254    25962    2         AS_FIELD1.COUNT = LENGTHC (KL$TREC.TNAME);

  25962  5 000120   010000 236003                    LDQ     4096,DU
         5 000121   000000 552040 xsym               STBQ    AS_FIELD1,'40'O

      255    25963    2         AS_FIELD2 = USERS_KEY;

  25963  5 000122   000000 100400                    MLR     fill='000'O
         5 000123   000000 000051 xsym               ADSC9   USERS_KEY                cn=0,n=41
         5 000124   000000 000051 xsym               ADSC9   AS_FIELD2                cn=0,n=41

      256    25964    2         AS_DCBNUM# = DCBNUM(M$PRO);

  25964  5 000125   000000 236007 xsym               LDQ     M$PRO,DL
         5 000126   000000 756000 xsym               STQ     AS_DCBNUM#
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:32   

      257    25965              %SCREAM( ERR#=E$TERM_PRO_MISSING, LEVEL=ERROR, MID='L' );

  25977  5 000127   000002 630400 6                  EPPR0   2
         5 000130   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000131   000000 701000 xent               TSX1    ASH$ERROR
         5 000132   000000 011000                    NOP     0

      258    25980    2         TERM_TYPE = 0;

  25980  5 000133   200016 450100                    STZ     TERM_TYPE,,AUTO

      259    25981    2     END;   /*  WHENALTRETURN FROM ASD$READ_PRO  */

      260    25982
      261    25983    1   CALL ASB$WRITE_LO(' ',1);

  25983  5 000134   000003 630400 6                  EPPR0   3
         5 000135   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000136   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000137   000000 011000                    NOP     0

      262    25984    1   CALL ASB$WRITE_LO(' ',1);

  25984  5 000140   000003 630400 6                  EPPR0   3
         5 000141   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000142   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000143   000000 011000                    NOP     0

      263    25985
      264    25986    2   IF NOT JCL THEN DO;

  25986  5 000144   200003 470500                    LDP0    @JCL,,AUTO
         5 000145   000000 066500                    CMPB    filb='0'B
         5 000146   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         5 000147   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         5 000150   001165 601000 5                  TNZ     s:26170
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:33   

      265    25987    2   FMT_VEC(0) = VECTOR(KL$TREC.TNAME);

  25987  5 000151   000005 235000 6                  LDA     5
         5 000152   000000 236000 xsym               LDQ     DSEG1$
         5 000153   000013 036003                    ADLQ    11,DU
         5 000154   000000 755000 xsym               STA     FMT_VEC
         5 000155   000001 756000 xsym               STQ     FMT_VEC+1

      266    25988    2   FMT_VEC(1) = VECTOR(TERMINAL_STR);

  25988  5 000156   000006 237000 6                  LDAQ    6
         5 000157   000002 755000 xsym               STA     FMT_VEC+2
         5 000160   000003 756000 xsym               STQ     FMT_VEC+3

      267    25989    2   FMT_VEC(2) = VECTOR(ADDR(KL$DREC.PNAME)->TEXT$C.TEXT);

  25989  5 000161   000000 471400 xsym               LDP1    DSEG1$
         5 000162   100004 236100                    LDQ     4,,PR1
         5 000163   000033 772000                    QRL     27
         5 000164   000064 737000                    LLS     52
         5 000165   000140 135007                    SBLA    96,DL
         5 000166   000000 236000 xsym               LDQ     DSEG1$
         5 000167   000010 036000 6                  ADLQ    8
         5 000170   000004 755000 xsym               STA     FMT_VEC+4
         5 000171   000005 756000 xsym               STQ     FMT_VEC+5

      268    25990    2   FMT_VEC(3) = VECTOR ( TERM_TYPE );

  25990  5 000172   777640 235007                    LDA     -96,DL
         5 000173   200020 452500                    STP2    TERM_TYPE+2,,AUTO
         5 000174   200020 236100                    LDQ     TERM_TYPE+2,,AUTO
         5 000175   000016 036003                    ADLQ    14,DU
         5 000176   000006 755000 xsym               STA     FMT_VEC+6
         5 000177   000007 756000 xsym               STQ     FMT_VEC+7

      269    25991    2   FMT_BUF = TERM_HDR_FMT;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:34   

  25991  5 000200   040000 100400                    MLR     fill='040'O
         5 000201   000272 000073 4                  ADSC9   TERM_HDR_FMT             cn=0,n=59
         5 000202   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      270    25992    2   FDS.FMT_.BOUND = SIZEC(TERM_HDR_FMT)-1;

  25992  5 000203   000000 236000 xsym               LDQ     FDS
         5 000204   177777 376007                    ANQ     65535,DL
         5 000205   000011 276000 6                  ORQ     9
         5 000206   000000 756000 xsym               STQ     FDS

      271    25993    2   FDS.NVECS# = 4;

  25993  5 000207   000004 235007                    LDA     4,DL
         5 000210   000011 755000 xsym               STA     FDS+9

      272    25994    2   CALL X$FORMAT(FDS);

  25994  5 000211   000012 630400 6                  EPPR0   10
         5 000212   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000213   000000 701000 xent               TSX1    X$FORMAT
         5 000214   000000 011000                    NOP     0

      273    25995    2   CALL ASB$WRITE_LO(' ',1);

  25995  5 000215   000003 630400 6                  EPPR0   3
         5 000216   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000217   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000220   000000 011000                    NOP     0

      274    25996    3   IF KL$TREC.FLAGS.GJOB THEN DO;

  25996  5 000221   000000 470400 xsym               LDP0    DSEG1$
         5 000222   000000 236100                    LDQ     0,,PR0
         5 000223   000020 316003                    CANQ    16,DU
         5 000224   000267 600000 5                  TZE     s:26011
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:35   

      275    25997    3      FMT_VEC(0) = VECTOR(KL$TREC.GJOB.ACCT);

  25997  5 000225   000005 235000 6                  LDA     5
         5 000226   000000 236000 xsym               LDQ     DSEG1$
         5 000227   000020 036003                    ADLQ    16,DU
         5 000230   000000 755000 xsym               STA     FMT_VEC
         5 000231   000001 756000 xsym               STQ     FMT_VEC+1

      276    25998    3      FMT_VEC(1) = VECTOR(KL$TREC.GJOB.UNAME);

  25998  5 000232   000013 235000 6                  LDA     11
         5 000233   000000 236000 xsym               LDQ     DSEG1$
         5 000234   000022 036003                    ADLQ    18,DU
         5 000235   000002 755000 xsym               STA     FMT_VEC+2
         5 000236   000003 756000 xsym               STQ     FMT_VEC+3

      277    25999    3      IF KL$TREC.GJOB.PASS = BLANK_PASS THEN

  25999  5 000237   040000 106500                    CMPC    fill='040'O
         5 000240   000025 000010                    ADSC9   21,,PR0                  cn=0,n=8
         5 000241   000000 000010 xsym               ADSC9   BLANK_PASS               cn=0,n=8
         5 000242   000247 601000 5                  TNZ     s:26002

      278    26000    3         FMT_VEC(2) = VECTOR(NO_PASSWORD);

  26000  5 000243   000014 237000 6                  LDAQ    12
         5 000244   000004 755000 xsym               STA     FMT_VEC+4
         5 000245   000005 756000 xsym               STQ     FMT_VEC+5
         5 000246   000252 710000 5                  TRA     s:26003

      279    26001    3      ELSE
      280    26002    3         FMT_VEC(2) = VECTOR(PASSWORD);

  26002  5 000247   000016 237000 6                  LDAQ    14
         5 000250   000004 755000 xsym               STA     FMT_VEC+4
         5 000251   000005 756000 xsym               STQ     FMT_VEC+5
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:36   

      281    26003    3      IF KL$TREC.GJOB.CMDCNT = 0 THEN

  26003  5 000252   000027 235100                    LDA     23,,PR0
         5 000253   000257 601000 5                  TNZ     s:26006

      282    26004    3         FDS.NVECS# = 3;

  26004  5 000254   000003 235007                    LDA     3,DL
         5 000255   000011 755000 xsym               STA     FDS+9
         5 000256   000274 710000 5                  TRA     s:26014

      283    26005    4      ELSE DO;

      284    26006    4         FMT_VEC(3) = VECTOR(KL$TREC.GJOB.CMD);

  26006  5 000257   000020 235000 6                  LDA     16
         5 000260   000000 236000 xsym               LDQ     DSEG1$
         5 000261   000030 036003                    ADLQ    24,DU
         5 000262   000006 755000 xsym               STA     FMT_VEC+6
         5 000263   000007 756000 xsym               STQ     FMT_VEC+7

      285    26007    4         FDS.NVECS# = 4;

  26007  5 000264   000004 235007                    LDA     4,DL
         5 000265   000011 755000 xsym               STA     FDS+9

      286    26008    4         END;

      287    26009    3      END;

  26009  5 000266   000274 710000 5                  TRA     s:26014

      288    26010    3   ELSE DO;

      289    26011    3      FMT_VEC(0) = VECTOR(NONE_STR);

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:37   
  26011  5 000267   000022 237000 6                  LDAQ    18
         5 000270   000000 755000 xsym               STA     FMT_VEC
         5 000271   000001 756000 xsym               STQ     FMT_VEC+1

      290    26012    3      FDS.NVECS# = 1;

  26012  5 000272   000001 235007                    LDA     1,DL
         5 000273   000011 755000 xsym               STA     FDS+9

      291    26013    3      END;

      292    26014    2   FMT_BUF = TERM_OPT_FMT;

  26014  5 000274   040000 100400                    MLR     fill='040'O
         5 000275   000311 000040 4                  ADSC9   TERM_OPT_FMT             cn=0,n=32
         5 000276   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      293    26015    2   FDS.FMT_.BOUND = SIZEV(TERM_OPT_FMT);

  26015  5 000277   000000 236000 xsym               LDQ     FDS
         5 000300   177777 376007                    ANQ     65535,DL
         5 000301   000021 276000 6                  ORQ     17
         5 000302   000000 756000 xsym               STQ     FDS

      294    26016    2   CALL X$FORMAT( FDS );

  26016  5 000303   000012 630400 6                  EPPR0   10
         5 000304   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000305   000000 701000 xent               TSX1    X$FORMAT
         5 000306   000000 011000                    NOP     0

      295    26017    2   CALL ASB$WRITE_LO ( AS_BLANK, 1 );

  26017  5 000307   000024 630400 6                  EPPR0   20
         5 000310   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000311   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000312   000000 011000                    NOP     0
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:38   

      296    26018    2   IF KL$TREC.HASP.SLAVE# THEN

  26018  5 000313   000000 470400 xsym               LDP0    DSEG1$
         5 000314   000056 236100                    LDQ     46,,PR0
         5 000315   300000 316003                    CANQ    98304,DU
         5 000316   000323 600000 5                  TZE     s:26021

      297    26019    2      FMT_VEC(0) = VECTOR (YES_STR);

  26019  5 000317   000026 237000 6                  LDAQ    22
         5 000320   000000 755000 xsym               STA     FMT_VEC
         5 000321   000001 756000 xsym               STQ     FMT_VEC+1
         5 000322   000326 710000 5                  TRA     s:26023

      298    26020    2   ELSE
      299    26021    2      FMT_VEC(0) = VECTOR (NO_STR);

  26021  5 000323   000030 237000 6                  LDAQ    24
         5 000324   000000 755000 xsym               STA     FMT_VEC
         5 000325   000001 756000 xsym               STQ     FMT_VEC+1

      300    26022
      301    26023    2   IF KL$TREC.HASP.RLS# = AS_BLANK THEN

  26023  5 000326   040000 106500                    CMPC    fill='040'O
         5 000327   000056 400120                    ADSC9   46,,PR0                  cn=2,n=80
         5 000330   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         5 000331   000336 601000 5                  TNZ     s:26026

      302    26024    2      FMT_VEC(1) = VECTOR (NONE_STR);

  26024  5 000332   000022 237000 6                  LDAQ    18
         5 000333   000002 755000 xsym               STA     FMT_VEC+2
         5 000334   000003 756000 xsym               STQ     FMT_VEC+3
         5 000335   000343 710000 5                  TRA     s:26028

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:39   
      303    26025    2   ELSE
      304    26026    2      FMT_VEC(1) = VECTOR (KL$TREC.HASP.RLS#);

  26026  5 000336   000020 235000 6                  LDA     16
         5 000337   000000 236000 xsym               LDQ     DSEG1$
         5 000340   000032 036000 6                  ADLQ    26
         5 000341   000002 755000 xsym               STA     FMT_VEC+2
         5 000342   000003 756000 xsym               STQ     FMT_VEC+3

      305    26027
      306    26028    2   FDS.NVECS# = 2;

  26028  5 000343   000002 235007                    LDA     2,DL
         5 000344   000011 755000 xsym               STA     FDS+9

      307    26029    2   FMT_BUF = TERM_RLS_FMT;

  26029  5 000345   040000 100400                    MLR     fill='040'O
         5 000346   000321 000031 4                  ADSC9   TERM_RLS_FMT             cn=0,n=25
         5 000347   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      308    26030    2   FDS.FMT_.BOUND = SIZEC (TERM_RLS_FMT);

  26030  5 000350   000000 236000 xsym               LDQ     FDS
         5 000351   177777 376007                    ANQ     65535,DL
         5 000352   000033 276000 6                  ORQ     27
         5 000353   000000 756000 xsym               STQ     FDS

      309    26031    2   CALL X$FORMAT (FDS);

  26031  5 000354   000012 630400 6                  EPPR0   10
         5 000355   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 000356   000000 701000 xent               TSX1    X$FORMAT
         5 000357   000000 011000                    NOP     0

      310    26032    2   CALL ASB$WRITE_LO ( AS_BLANK, 1 );

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:40   
  26032  5 000360   000024 630400 6                  EPPR0   20
         5 000361   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000362   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000363   000000 011000                    NOP     0

      311    26033    2   CALL ASB$WRITE_LO(TERM_DEV_HDR,SIZEC(TERM_DEV_HDR));

  26033  5 000364   000035 630400 6                  EPPR0   29
         5 000365   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000366   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 000367   000000 011000                    NOP     0

      312    26034    2   FDS.NVECS# = 9;

  26034  5 000370   000011 235007                    LDA     9,DL
         5 000371   000011 755000 xsym               STA     FDS+9

      313    26035    2   DEVNUM = 1;

  26035  5 000372   000001 236007                    LDQ     1,DL
         5 000373   200006 756100                    STQ     DEVNUM,,AUTO

      314    26036    2   CONFIG_KEY.TERMID.TERM.TERM_NAME = KL$TREC.TNAME;

  26036  5 000374   000000 470400 xsym               LDP0    DSEG1$
         5 000375   040000 100500                    MLR     fill='040'O
         5 000376   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         5 000377   000066 600010 3                  ADSC9   CONFIG_KEY+2             cn=3,n=8

      315    26037    2   CONFIG_KEY.TERMID.LEV = 2;

  26037  5 000400   002000 236003                    LDQ     1024,DU
         5 000401   000065 552040 3                  STBQ    CONFIG_KEY+1,'40'O

      316    26038    2   KL$HASPDEV$ = PINCRC (DSEG1$,LENGTHC (KL_DREC_CNT));

  26038  5 000402   000000 236000 xsym               LDQ     DSEG1$
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:41   
         5 000403   000020 036003                    ADLQ    16,DU
         5 000404   000000 756000 3                  STQ     KL$HASPDEV$

      317    26039    2   KL$HASPDEV$ = PINCRW (KL$HASPDEV$,SIZEW(KL_GJOB)+SIZEW(KL_HASP));

  26039  5 000405   000063 036003                    ADLQ    51,DU
         5 000406   000000 756000 3                  STQ     KL$HASPDEV$

      318    26040    3   DO I=0 TO KL$TWSNREC.NDEV-1;

  26040  5 000407   200007 450100                    STZ     I,,AUTO
         5 000410   001157 710000 5                  TRA     s:26167+1

      319    26041    3      IF KL$TWSNREC.DEVS.TDEV(I) AND KL$TWSNREC.DEVS.TERM(I)=KL$TREC.TNAME

  26041  5 000411   200007 236100                    LDQ     I,,AUTO
         5 000412   000013 402007                    MPY     11,DL
         5 000413   000000 470400 xsym               LDP0    DSEG2$
         5 000414   000006 236106                    LDQ     6,QL,PR0
         5 000415   000100 316007                    CANQ    64,DL
         5 000416   001156 600000 5                  TZE     s:26167
         5 000417   200007 236100                    LDQ     I,,AUTO
         5 000420   000054 402007                    MPY     44,DL
         5 000421   000000 471400 xsym               LDP1    DSEG1$
         5 000422   040100 106506                    CMPC    fill='040'O
         5 000423   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         5 000424   100013 000010                    ADSC9   11,,PR1                  cn=0,n=8
         5 000425   001156 601000 5                  TNZ     s:26167

      320    26042    4      THEN DO;

      321    26043    4         FMT_BUF = TERM_DEV_FMT;

  26043  5 000426   040000 100400                    MLR     fill='040'O
         5 000427   000230 000071 4                  ADSC9   TERM_DEV_FMT             cn=0,n=57
         5 000430   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:42   
      322    26044    4         FDS.FMT_.BOUND = SIZEC(TERM_DEV_FMT)-1;

  26044  5 000431   000000 236000 xsym               LDQ     FDS
         5 000432   177777 376007                    ANQ     65535,DL
         5 000433   000016 276003                    ORQ     14,DU
         5 000434   000000 756000 xsym               STQ     FDS

      323    26045    4         FMT_VEC(0) = VECTOR(KL$TWSNREC.DEVS.TYP(I));

  26045  5 000435   377640 235007                    LDA     130976,DL
         5 000436   200007 236100                    LDQ     I,,AUTO
         5 000437   200020 755100                    STA     TERM_TYPE+2,,AUTO
         5 000440   000013 402003                    MPY     11,DU
         5 000441   000005 036003                    ADLQ    5,DU
         5 000442   000000 036000 xsym               ADLQ    DSEG2$
         5 000443   200020 235100                    LDA     TERM_TYPE+2,,AUTO
         5 000444   000000 755000 xsym               STA     FMT_VEC
         5 000445   000001 756000 xsym               STQ     FMT_VEC+1

      324    26046    4         FMT_VEC(1) = VECTOR(KL$TWSNREC.DEVS.NUM(I));

  26046  5 000446   377640 235007                    LDA     130976,DL
         5 000447   200007 236100                    LDQ     I,,AUTO
         5 000450   200020 755100                    STA     TERM_TYPE+2,,AUTO
         5 000451   000013 402003                    MPY     11,DU
         5 000452   000037 036000 6                  ADLQ    31
         5 000453   000000 036000 xsym               ADLQ    DSEG2$
         5 000454   200020 235100                    LDA     TERM_TYPE+2,,AUTO
         5 000455   000002 755000 xsym               STA     FMT_VEC+2
         5 000456   000003 756000 xsym               STQ     FMT_VEC+3

      325    26047    4         IF KL$TWSNREC.DEVS.IO.INPUT(I)

  26047  5 000457   200007 236100                    LDQ     I,,AUTO
         5 000460   000013 402007                    MPY     11,DL
         5 000461   000006 236106                    LDQ     6,QL,PR0
         5 000462   000400 316007                    CANQ    256,DL
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:43   
         5 000463   000501 600000 5                  TZE     s:26055

      326    26048    4         THEN
      327    26049    4            IF KL$TWSNREC.DEVS.IO.OUTPUT(I)

  26049  5 000464   200007 236100                    LDQ     I,,AUTO
         5 000465   000013 402007                    MPY     11,DL
         5 000466   000006 236106                    LDQ     6,QL,PR0
         5 000467   000200 316007                    CANQ    128,DL
         5 000470   000475 600000 5                  TZE     s:26053

      328    26050    4            THEN
      329    26051    4               FMT_VEC(2) = VECTOR(INOUT_STR);

  26051  5 000471   000040 237000 6                  LDAQ    32
         5 000472   000004 755000 xsym               STA     FMT_VEC+4
         5 000473   000005 756000 xsym               STQ     FMT_VEC+5
         5 000474   000515 710000 5                  TRA     s:26060

      330    26052    4            ELSE
      331    26053    4               FMT_VEC(2) = VECTOR(IN_STR);

  26053  5 000475   000042 237000 6                  LDAQ    34
         5 000476   000004 755000 xsym               STA     FMT_VEC+4
         5 000477   000005 756000 xsym               STQ     FMT_VEC+5
         5 000500   000515 710000 5                  TRA     s:26060

      332    26054    4         ELSE
      333    26055    4            IF KL$TWSNREC.DEVS.IO.OUTPUT(I)

  26055  5 000501   200007 236100                    LDQ     I,,AUTO
         5 000502   000013 402007                    MPY     11,DL
         5 000503   000006 236106                    LDQ     6,QL,PR0
         5 000504   000200 316007                    CANQ    128,DL
         5 000505   000512 600000 5                  TZE     s:26059

      334    26056    4            THEN
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:44   
      335    26057    4               FMT_VEC(2) = VECTOR(OUT_STR);

  26057  5 000506   000044 237000 6                  LDAQ    36
         5 000507   000004 755000 xsym               STA     FMT_VEC+4
         5 000510   000005 756000 xsym               STQ     FMT_VEC+5
         5 000511   000515 710000 5                  TRA     s:26060

      336    26058    4            ELSE
      337    26059    4               FMT_VEC(2) = VECTOR(NONE_STR);

  26059  5 000512   000022 237000 6                  LDAQ    18
         5 000513   000004 755000 xsym               STA     FMT_VEC+4
         5 000514   000005 756000 xsym               STQ     FMT_VEC+5

      338    26060    4         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(0) = DEVNUM/256;

  26060  5 000515   200006 236100                    LDQ     DEVNUM,,AUTO
         5 000516   000010 772000                    QRL     8
         5 000517   000065 676000 3                  ERQ     CONFIG_KEY+1
         5 000520   000377 376007                    ANQ     255,DL
         5 000521   000065 656000 3                  ERSQ    CONFIG_KEY+1

      339    26061    4         CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT(1) = MOD(DEVNUM,256);

  26061  5 000522   200006 236100                    LDQ     DEVNUM,,AUTO
         5 000523   000377 376007                    ANQ     255,DL
         5 000524   000033 736000                    QLS     27
         5 000525   000066 676000 3                  ERQ     CONFIG_KEY+2
         5 000526   377000 376003                    ANQ     130560,DU
         5 000527   000066 656000 3                  ERSQ    CONFIG_KEY+2

      340    26062    4         DEVNUM = DEVNUM + 1;

  26062  5 000530   200006 236100                    LDQ     DEVNUM,,AUTO
         5 000531   000001 036007                    ADLQ    1,DL
         5 000532   200006 756100                    STQ     DEVNUM,,AUTO

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:45   
      341    26063    4         CALL ASB$READ_NETCON(VECTOR(CONFIG_KEY),VECTOR(LINCNFG_BUF))

  26063  5 000533   000052 630400 6                  EPPR0   42
         5 000534   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 000535   000000 701000 xent               TSX1    ASB$READ_NETCON
         5 000536   000550 702000 5                  TSX2    s:26068

      342    26064    5         WHENRETURN DO;

      343    26065    5            KL_SS.SGN_R = LINCNFG.LGN.LGNSTRING;

  26065  5 000537   000063 470400 3                  LDP0    LINCNFG$
         5 000540   000012 236100                    LDQ     10,,PR0
         5 000541   000011 772000                    QRL     9
         5 000542   000777 376007                    ANQ     511,DL
         5 000543   000000 620006                    EAX0    0,QL
         5 000544   040000 100540                    MLR     fill='040'O
         5 000545   000012 600010                    ADSC9   10,,PR0                  cn=3,n=*X0
         5 000546   000071 200032 3                  ADSC9   KL_SS                    cn=1,n=26

      344    26066    5            END;

  26066  5 000547   000553 710000 5                  TRA     s:26070

      345    26067    5         WHENALTRETURN DO;

      346    26068    5            KL_SS.SGN_R = ' ';

  26068  5 000550   040000 100400                    MLR     fill='040'O
         5 000551   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         5 000552   000071 200032 3                  ADSC9   KL_SS                    cn=1,n=26

      347    26069    5            END;

      348    26070    4         FMT_VEC(3) = VECTOR(KL_SS.SGN.PNAME);

  26070  5 000553   000054 237000 6                  LDAQ    44
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:46   
         5 000554   000006 755000 xsym               STA     FMT_VEC+6
         5 000555   000007 756000 xsym               STQ     FMT_VEC+7

      349    26071    4         FMT_VEC(4) = VECTOR(NA_STR);

  26071  5 000556   000056 237000 6                  LDAQ    46
         5 000557   000010 755000 xsym               STA     FMT_VEC+8
         5 000560   000011 756000 xsym               STQ     FMT_VEC+9

      350    26072    4         IF (SUBSTR (KL$TWSNREC.DEVS.TYP (I), 0, 2) = 'OC')

  26072  5 000561   200007 236100                    LDQ     I,,AUTO
         5 000562   000013 402007                    MPY     11,DL
         5 000563   000000 470400 xsym               LDP0    DSEG2$
         5 000564   000005 220106                    LDX0    5,QL,PR0
         5 000565   000334 100000 4                  CMPX0   YES_STR+3
         5 000566   000573 601000 5                  TNZ     s:26077

      351    26073    5         THEN DO;

      352    26074    5            FMT_VEC (5) = VECTOR (TCONSOLE_STR);

  26074  5 000567   000060 237000 6                  LDAQ    48
         5 000570   000012 755000 xsym               STA     FMT_VEC+10
         5 000571   000013 756000 xsym               STQ     FMT_VEC+11

      353    26075    5            END;

  26075  5 000572   000576 710000 5                  TRA     s:26079

      354    26076    5         ELSE DO;

      355    26077    5            FMT_VEC (5) = VECTOR (TDEV_STR);

  26077  5 000573   000062 237000 6                  LDAQ    50
         5 000574   000012 755000 xsym               STA     FMT_VEC+10
         5 000575   000013 756000 xsym               STQ     FMT_VEC+11
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:47   

      356    26078    5            END;

      357    26079    4         FMT_VEC(6) = VECTOR (KL$HASPDEV.DADR.DEVCTL);

  26079  5 000576   377640 235007                    LDA     130976,DL
         5 000577   000000 236000 3                  LDQ     KL$HASPDEV$
         5 000600   000064 036000 6                  ADLQ    52
         5 000601   000014 755000 xsym               STA     FMT_VEC+12
         5 000602   000015 756000 xsym               STQ     FMT_VEC+13

      358    26080    4         FMT_VEC(7) = VECTOR (KL$HASPDEV.DADR.SDNUM#);

  26080  5 000603   177640 235007                    LDA     65440,DL
         5 000604   000000 236000 3                  LDQ     KL$HASPDEV$
         5 000605   000033 036000 6                  ADLQ    27
         5 000606   000016 755000 xsym               STA     FMT_VEC+14
         5 000607   000017 756000 xsym               STQ     FMT_VEC+15

      359    26081
      360    26082    5         DO SELECT ( BITBIN(KL$HASPDEV.DADR.DEVNUM#) ) ;

  26082  5 000610   000000 471400 3                  LDP1    KL$HASPDEV$
         5 000611   100006 236100                    LDQ     6,,PR1
         5 000612   000033 772000                    QRL     27
         5 000613   000221 116007                    CMPQ    145,DL
         5 000614   000635 602000 5                  TNC     s:26082+21
         5 000615   001004 600000 5                  TZE     s:26122
         5 000616   000224 116007                    CMPQ    148,DL
         5 000617   000632 602000 5                  TNC     s:26082+18
         5 000620   001022 600000 5                  TZE     s:26128
         5 000621   000244 116007                    CMPQ    164,DL
         5 000622   000627 602000 5                  TNC     s:26082+15
         5 000623   001074 600000 5                  TZE     s:26146
         5 000624   000264 116007                    CMPQ    180,DL
         5 000625   001130 601000 5                  TNZ     s:26158
         5 000626   001112 710000 5                  TRA     s:26152
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:48   
         5 000627   000225 116007                    CMPQ    149,DL
         5 000630   001130 601000 5                  TNZ     s:26158
         5 000631   001056 710000 5                  TRA     s:26140
         5 000632   000223 116007                    CMPQ    147,DL
         5 000633   001130 601000 5                  TNZ     s:26158
         5 000634   001040 710000 5                  TRA     s:26134
         5 000635   000004 116007                    CMPQ    4,DL
         5 000636   000651 602000 5                  TNC     s:26082+33
         5 000637   000714 600000 5                  TZE     s:26098
         5 000640   000021 116007                    CMPQ    17,DL
         5 000641   000646 602000 5                  TNC     s:26082+30
         5 000642   000732 600000 5                  TZE     s:26104
         5 000643   000022 116007                    CMPQ    18,DL
         5 000644   001130 601000 5                  TNZ     s:26158
         5 000645   000766 710000 5                  TRA     s:26116
         5 000646   000006 116007                    CMPQ    6,DL
         5 000647   001130 601000 5                  TNZ     s:26158
         5 000650   000676 710000 5                  TRA     s:26092
         5 000651   000003 116007                    CMPQ    3,DL
         5 000652   000655 602000 5                  TNC     s:26082+37
         5 000653   000660 600000 5                  TZE     s:26086
         5 000654   001130 710000 5                  TRA     s:26158
         5 000655   000000 116003                    CMPQ    0,DU
         5 000656   000750 600000 5                  TZE     s:26110
         5 000657   001130 710000 5                  TRA     s:26158

      361    26083
      362    26084    5            SELECT ( %BITBIN(%KLDN_2780LP#) ) ;

      363    26085
      364    26086    5               FMT_VEC(8) = VECTOR(S2780LP_STR) ;

  26086  5 000660   000066 237000 6                  LDAQ    54
         5 000661   000020 755000 xsym               STA     FMT_VEC+16
         5 000662   000021 756000 xsym               STQ     FMT_VEC+17

      365    26087    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:49   

  26087  5 000663   000000 236000 xsym               LDQ     FDS
         5 000664   000020 772000                    QRL     16
         5 000665   040006 100400                    MLR     fill='040'O
         5 000666   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 000667   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      366    26088    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26088  5 000670   000002 036007                    ADLQ    2,DL
         5 000671   000020 736000                    QLS     16
         5 000672   000000 676000 xsym               ERQ     FDS
         5 000673   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000674   000000 656000 xsym               ERSQ    FDS
         5 000675   001147 710000 5                  TRA     s:26164

      367    26089
      368    26090    5            SELECT ( %BITBIN(%KLDN_2780CR#) ) ;

      369    26091
      370    26092    5               FMT_VEC(8) = VECTOR(S2780CR_STR) ;

  26092  5 000676   000070 237000 6                  LDAQ    56
         5 000677   000020 755000 xsym               STA     FMT_VEC+16
         5 000700   000021 756000 xsym               STQ     FMT_VEC+17

      371    26093    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26093  5 000701   000000 236000 xsym               LDQ     FDS
         5 000702   000020 772000                    QRL     16
         5 000703   040006 100400                    MLR     fill='040'O
         5 000704   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 000705   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      372    26094    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26094  5 000706   000002 036007                    ADLQ    2,DL
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:50   
         5 000707   000020 736000                    QLS     16
         5 000710   000000 676000 xsym               ERQ     FDS
         5 000711   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000712   000000 656000 xsym               ERSQ    FDS
         5 000713   001147 710000 5                  TRA     s:26164

      373    26095
      374    26096    5            SELECT ( %BITBIN(%KLDN_2780CP#) ) ;

      375    26097
      376    26098    5               FMT_VEC(8) = VECTOR(S2780CP_STR) ;

  26098  5 000714   000072 237000 6                  LDAQ    58
         5 000715   000020 755000 xsym               STA     FMT_VEC+16
         5 000716   000021 756000 xsym               STQ     FMT_VEC+17

      377    26099    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26099  5 000717   000000 236000 xsym               LDQ     FDS
         5 000720   000020 772000                    QRL     16
         5 000721   040006 100400                    MLR     fill='040'O
         5 000722   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 000723   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      378    26100    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26100  5 000724   000002 036007                    ADLQ    2,DL
         5 000725   000020 736000                    QLS     16
         5 000726   000000 676000 xsym               ERQ     FDS
         5 000727   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000730   000000 656000 xsym               ERSQ    FDS
         5 000731   001147 710000 5                  TRA     s:26164

      379    26101
      380    26102    5            SELECT ( %BITBIN(%KLDN_3780LP#) ) ;

      381    26103
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:51   
      382    26104    5               FMT_VEC(8) = VECTOR(S3780LP_STR) ;

  26104  5 000732   000074 237000 6                  LDAQ    60
         5 000733   000020 755000 xsym               STA     FMT_VEC+16
         5 000734   000021 756000 xsym               STQ     FMT_VEC+17

      383    26105    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26105  5 000735   000000 236000 xsym               LDQ     FDS
         5 000736   000020 772000                    QRL     16
         5 000737   040006 100400                    MLR     fill='040'O
         5 000740   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 000741   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      384    26106    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26106  5 000742   000002 036007                    ADLQ    2,DL
         5 000743   000020 736000                    QLS     16
         5 000744   000000 676000 xsym               ERQ     FDS
         5 000745   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000746   000000 656000 xsym               ERSQ    FDS
         5 000747   001147 710000 5                  TRA     s:26164

      385    26107
      386    26108    5            SELECT ( %BITBIN(%KLDN_3780CR#) ) ;

      387    26109
      388    26110    5               FMT_VEC(8) = VECTOR(S3780CR_STR) ;

  26110  5 000750   000076 237000 6                  LDAQ    62
         5 000751   000020 755000 xsym               STA     FMT_VEC+16
         5 000752   000021 756000 xsym               STQ     FMT_VEC+17

      389    26111    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26111  5 000753   000000 236000 xsym               LDQ     FDS
         5 000754   000020 772000                    QRL     16
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:52   
         5 000755   040006 100400                    MLR     fill='040'O
         5 000756   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 000757   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      390    26112    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26112  5 000760   000002 036007                    ADLQ    2,DL
         5 000761   000020 736000                    QLS     16
         5 000762   000000 676000 xsym               ERQ     FDS
         5 000763   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 000764   000000 656000 xsym               ERSQ    FDS
         5 000765   001147 710000 5                  TRA     s:26164

      391    26113
      392    26114    5            SELECT ( %BITBIN(%KLDN_3780CP#) ) ;

      393    26115
      394    26116    5               FMT_VEC(8) = VECTOR(S3780CP_STR) ;

  26116  5 000766   000100 237000 6                  LDAQ    64
         5 000767   000020 755000 xsym               STA     FMT_VEC+16
         5 000770   000021 756000 xsym               STQ     FMT_VEC+17

      395    26117    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26117  5 000771   000000 236000 xsym               LDQ     FDS
         5 000772   000020 772000                    QRL     16
         5 000773   040006 100400                    MLR     fill='040'O
         5 000774   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 000775   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      396    26118    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26118  5 000776   000002 036007                    ADLQ    2,DL
         5 000777   000020 736000                    QLS     16
         5 001000   000000 676000 xsym               ERQ     FDS
         5 001001   000034 376000 xsym               ANQ     B_VECTNIL+28
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:53   
         5 001002   000000 656000 xsym               ERSQ    FDS
         5 001003   001147 710000 5                  TRA     s:26164

      397    26119
      398    26120    5            SELECT ( %BITBIN(%KLDN_HASPOC#) ) ;

      399    26121
      400    26122    5               FMT_VEC(8) = VECTOR(HASPOC_STR) ;

  26122  5 001004   000102 237000 6                  LDAQ    66
         5 001005   000020 755000 xsym               STA     FMT_VEC+16
         5 001006   000021 756000 xsym               STQ     FMT_VEC+17

      401    26123    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26123  5 001007   000000 236000 xsym               LDQ     FDS
         5 001010   000020 772000                    QRL     16
         5 001011   040006 100400                    MLR     fill='040'O
         5 001012   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 001013   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      402    26124    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26124  5 001014   000002 036007                    ADLQ    2,DL
         5 001015   000020 736000                    QLS     16
         5 001016   000000 676000 xsym               ERQ     FDS
         5 001017   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001020   000000 656000 xsym               ERSQ    FDS
         5 001021   001147 710000 5                  TRA     s:26164

      403    26125
      404    26126    5            SELECT ( %BITBIN(%KLDN_HASPLP#) ) ;

      405    26127
      406    26128    5               FMT_VEC(8) = VECTOR(HASPLP_STR) ;

  26128  5 001022   000104 237000 6                  LDAQ    68
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:54   
         5 001023   000020 755000 xsym               STA     FMT_VEC+16
         5 001024   000021 756000 xsym               STQ     FMT_VEC+17

      407    26129    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26129  5 001025   000000 236000 xsym               LDQ     FDS
         5 001026   000020 772000                    QRL     16
         5 001027   040006 100400                    MLR     fill='040'O
         5 001030   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 001031   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      408    26130    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26130  5 001032   000002 036007                    ADLQ    2,DL
         5 001033   000020 736000                    QLS     16
         5 001034   000000 676000 xsym               ERQ     FDS
         5 001035   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001036   000000 656000 xsym               ERSQ    FDS
         5 001037   001147 710000 5                  TRA     s:26164

      409    26131
      410    26132    5            SELECT ( %BITBIN(%KLDN_HASPCR#) ) ;

      411    26133
      412    26134    5               FMT_VEC(8) = VECTOR(HASPCR_STR) ;

  26134  5 001040   000106 237000 6                  LDAQ    70
         5 001041   000020 755000 xsym               STA     FMT_VEC+16
         5 001042   000021 756000 xsym               STQ     FMT_VEC+17

      413    26135    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26135  5 001043   000000 236000 xsym               LDQ     FDS
         5 001044   000020 772000                    QRL     16
         5 001045   040006 100400                    MLR     fill='040'O
         5 001046   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 001047   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:55   

      414    26136    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26136  5 001050   000002 036007                    ADLQ    2,DL
         5 001051   000020 736000                    QLS     16
         5 001052   000000 676000 xsym               ERQ     FDS
         5 001053   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001054   000000 656000 xsym               ERSQ    FDS
         5 001055   001147 710000 5                  TRA     s:26164

      415    26137
      416    26138    5            SELECT ( %BITBIN(%KLDN_HASPCP#) ) ;

      417    26139
      418    26140    5               FMT_VEC(8) = VECTOR(HASPCP_STR) ;

  26140  5 001056   000110 237000 6                  LDAQ    72
         5 001057   000020 755000 xsym               STA     FMT_VEC+16
         5 001060   000021 756000 xsym               STQ     FMT_VEC+17

      419    26141    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26141  5 001061   000000 236000 xsym               LDQ     FDS
         5 001062   000020 772000                    QRL     16
         5 001063   040006 100400                    MLR     fill='040'O
         5 001064   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 001065   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      420    26142    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26142  5 001066   000002 036007                    ADLQ    2,DL
         5 001067   000020 736000                    QLS     16
         5 001070   000000 676000 xsym               ERQ     FDS
         5 001071   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001072   000000 656000 xsym               ERSQ    FDS
         5 001073   001147 710000 5                  TRA     s:26164

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:56   
      421    26143
      422    26144    5            SELECT ( %BITBIN(%KLDN_HASPLP2#) ) ;

      423    26145
      424    26146    5               FMT_VEC(8) = VECTOR(HASPLP2_STR) ;

  26146  5 001074   000112 237000 6                  LDAQ    74
         5 001075   000020 755000 xsym               STA     FMT_VEC+16
         5 001076   000021 756000 xsym               STQ     FMT_VEC+17

      425    26147    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26147  5 001077   000000 236000 xsym               LDQ     FDS
         5 001100   000020 772000                    QRL     16
         5 001101   040006 100400                    MLR     fill='040'O
         5 001102   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 001103   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      426    26148    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26148  5 001104   000002 036007                    ADLQ    2,DL
         5 001105   000020 736000                    QLS     16
         5 001106   000000 676000 xsym               ERQ     FDS
         5 001107   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001110   000000 656000 xsym               ERSQ    FDS
         5 001111   001147 710000 5                  TRA     s:26164

      427    26149
      428    26150    5            SELECT ( %BITBIN(%KLDN_HASPLP3#) ) ;

      429    26151
      430    26152    5               FMT_VEC(8) = VECTOR(HASPLP3_STR) ;

  26152  5 001112   000114 237000 6                  LDAQ    76
         5 001113   000020 755000 xsym               STA     FMT_VEC+16
         5 001114   000021 756000 xsym               STQ     FMT_VEC+17

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:57   
      431    26153    5               CALL INSERT (FMT_BUF,FDS.FMT_.BOUND + 1,LENGTHC(TEXT_FMT),TEXT_FMT);

  26153  5 001115   000000 236000 xsym               LDQ     FDS
         5 001116   000020 772000                    QRL     16
         5 001117   040006 100400                    MLR     fill='040'O
         5 001120   000330 000002 4                  ADSC9   TEXT_FMT                 cn=0,n=2
         5 001121   000000 200002 xsym               ADSC9   FMT_BUF,Q                cn=1,n=2

      432    26154    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (TEXT_FMT) ;

  26154  5 001122   000002 036007                    ADLQ    2,DL
         5 001123   000020 736000                    QLS     16
         5 001124   000000 676000 xsym               ERQ     FDS
         5 001125   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001126   000000 656000 xsym               ERSQ    FDS
         5 001127   001147 710000 5                  TRA     s:26164

      433    26155
      434    26156    5            SELECT ( ELSE ) ;

      435    26157
      436    26158    5               FMT_VEC(8) = VECTOR( KL$HASPDEV.DADR.DEVNUM# ) ;

  26158  5 001130   177640 235007                    LDA     65440,DL
         5 001131   000000 236000 3                  LDQ     KL$HASPDEV$
         5 001132   000006 036003                    ADLQ    6,DU
         5 001133   000020 755000 xsym               STA     FMT_VEC+16
         5 001134   000021 756000 xsym               STQ     FMT_VEC+17

      437    26159    5               CALL INSERT (FMT_BUF, FDS.FMT_.BOUND+1,LENGTHC(HEX2_FMT),HEX2_FMT);

  26159  5 001135   000000 236000 xsym               LDQ     FDS
         5 001136   000020 772000                    QRL     16
         5 001137   040006 100400                    MLR     fill='040'O
         5 001140   000117 000007 4                  ADSC9   HEX2_FMT                 cn=0,n=7
         5 001141   000000 200007 xsym               ADSC9   FMT_BUF,Q                cn=1,n=7

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:58   
      438    26160    5               FDS.FMT_.BOUND = FDS.FMT_.BOUND + LENGTHC (HEX2_FMT) ;

  26160  5 001142   000007 036007                    ADLQ    7,DL
         5 001143   000020 736000                    QLS     16
         5 001144   000000 676000 xsym               ERQ     FDS
         5 001145   000034 376000 xsym               ANQ     B_VECTNIL+28
         5 001146   000000 656000 xsym               ERSQ    FDS

      439    26161
      440    26162    5            END; /*  Case DEVNUM#  */

      441    26163
      442    26164    4         CALL X$FORMAT(FDS);

  26164  5 001147   000012 630400 6                  EPPR0   10
         5 001150   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001151   000000 701000 xent               TSX1    X$FORMAT
         5 001152   000000 011000                    NOP     0

      443    26165    4         KL$HASPDEV$ = PINCRW (KL$HASPDEV$,SIZEW(KL_HASPDEV));

  26165  5 001153   000000 236000 3                  LDQ     KL$HASPDEV$
         5 001154   000007 036003                    ADLQ    7,DU
         5 001155   000000 756000 3                  STQ     KL$HASPDEV$

      444    26166    4         END; /*  End of then do */

      445    26167    3      END;            /*  End of do i  */

  26167  5 001156   200007 054100                    AOS     I,,AUTO
         5 001157   000000 470400 xsym               LDP0    DSEG2$
         5 001160   200007 236100                    LDQ     I,,AUTO
         5 001161   000411 604000 5                  TMI     s:26041
         5 001162   000004 116100                    CMPQ    4,,PR0
         5 001163   000411 602000 5                  TNC     s:26041

      446    26168    2     END;   /*  NOT JCL  */
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:59   

  26168  5 001164   001541 710000 5                  TRA     s:26249

      447    26169    2   ELSE DO;  /*  JCL  */

      448    26170    2      FMT_VEC (0) = VECTOR ( KL$TREC.TNAME );

  26170  5 001165   000005 235000 6                  LDA     5
         5 001166   000000 236000 xsym               LDQ     DSEG1$
         5 001167   000013 036003                    ADLQ    11,DU
         5 001170   000000 755000 xsym               STA     FMT_VEC
         5 001171   000001 756000 xsym               STQ     FMT_VEC+1

      449    26171    2      FMT_VEC (1) = VECTOR ( TERM_TYPE );

  26171  5 001172   777640 235007                    LDA     -96,DL
         5 001173   200020 452500                    STP2    TERM_TYPE+2,,AUTO
         5 001174   200020 236100                    LDQ     TERM_TYPE+2,,AUTO
         5 001175   000016 036003                    ADLQ    14,DU
         5 001176   000002 755000 xsym               STA     FMT_VEC+2
         5 001177   000003 756000 xsym               STQ     FMT_VEC+3

      450    26172    2      FMT_VEC (2) = VECTOR ( KL$TREC.SNAME );

  26172  5 001200   000005 235000 6                  LDA     5
         5 001201   000000 236000 xsym               LDQ     DSEG1$
         5 001202   000015 036003                    ADLQ    13,DU
         5 001203   000004 755000 xsym               STA     FMT_VEC+4
         5 001204   000005 756000 xsym               STQ     FMT_VEC+5

      451    26173    2      FMT_BUF = TERM_CREATE_JCL_FMT;

  26173  5 001205   040000 100400                    MLR     fill='040'O
         5 001206   000206 000110 4                  ADSC9   TERM_CREATE_JCL_FMT      cn=0,n=72
         5 001207   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      452    26174    2      FDS.FMT_.BOUND = SIZEC ( TERM_CREATE_JCL_FMT ) - 1;
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:60   

  26174  5 001210   000000 236000 xsym               LDQ     FDS
         5 001211   177777 376007                    ANQ     65535,DL
         5 001212   000065 276000 6                  ORQ     53
         5 001213   000000 756000 xsym               STQ     FDS

      453    26175    2      FDS.NVECS# = 3;

  26175  5 001214   000003 235007                    LDA     3,DL
         5 001215   000011 755000 xsym               STA     FDS+9

      454    26176    2      CALL X$FORMAT(FDS);

  26176  5 001216   000012 630400 6                  EPPR0   10
         5 001217   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001220   000000 701000 xent               TSX1    X$FORMAT
         5 001221   000000 011000                    NOP     0

      455    26177    3      IF KL$TREC.FLAGS.GJOB THEN DO;

  26177  5 001222   000000 470400 xsym               LDP0    DSEG1$
         5 001223   000000 236100                    LDQ     0,,PR0
         5 001224   000020 316003                    CANQ    16,DU
         5 001225   001267 600000 5                  TZE     s:26190

      456    26178    3         FMT_VEC (0) = VECTOR ( KL$TREC.GJOB.ACCT );

  26178  5 001226   000005 235000 6                  LDA     5
         5 001227   000000 236000 xsym               LDQ     DSEG1$
         5 001230   000020 036003                    ADLQ    16,DU
         5 001231   000000 755000 xsym               STA     FMT_VEC
         5 001232   000001 756000 xsym               STQ     FMT_VEC+1

      457    26179    3         FMT_VEC (1) = VECTOR ( KL$TREC.GJOB.UNAME );

  26179  5 001233   000013 235000 6                  LDA     11
         5 001234   000000 236000 xsym               LDQ     DSEG1$
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:61   
         5 001235   000022 036003                    ADLQ    18,DU
         5 001236   000002 755000 xsym               STA     FMT_VEC+2
         5 001237   000003 756000 xsym               STQ     FMT_VEC+3

      458    26180    3         FMT_VEC (2) = VECTOR (SUBSTR ( KL$TREC.GJOB.PASS,0,4 ));

  26180  5 001240   777640 235007                    LDA     -96,DL
         5 001241   000000 236000 xsym               LDQ     DSEG1$
         5 001242   000025 036003                    ADLQ    21,DU
         5 001243   000004 755000 xsym               STA     FMT_VEC+4
         5 001244   000005 756000 xsym               STQ     FMT_VEC+5

      459    26181    3         FMT_VEC (3) = VECTOR (SUBSTR ( KL$TREC.GJOB.PASS,4,4 ));

  26181  5 001245   777640 235007                    LDA     -96,DL
         5 001246   000000 236000 xsym               LDQ     DSEG1$
         5 001247   000026 036003                    ADLQ    22,DU
         5 001250   000006 755000 xsym               STA     FMT_VEC+6
         5 001251   000007 756000 xsym               STQ     FMT_VEC+7

      460    26182    3         IF KL$TREC.GJOB.CMDCNT = 0 THEN

  26182  5 001252   000027 235100                    LDA     23,,PR0
         5 001253   001257 601000 5                  TNZ     s:26185

      461    26183    3            FDS.NVECS# = 4;

  26183  5 001254   000004 235007                    LDA     4,DL
         5 001255   000011 755000 xsym               STA     FDS+9
         5 001256   001274 710000 5                  TRA     s:26193

      462    26184    4         ELSE DO;

      463    26185    4            FMT_VEC (4) = VECTOR ( KL$TREC.GJOB.CMD );

  26185  5 001257   000020 235000 6                  LDA     16
         5 001260   000000 236000 xsym               LDQ     DSEG1$
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:62   
         5 001261   000030 036003                    ADLQ    24,DU
         5 001262   000010 755000 xsym               STA     FMT_VEC+8
         5 001263   000011 756000 xsym               STQ     FMT_VEC+9

      464    26186    4            FDS.NVECS# = 5;

  26186  5 001264   000005 235007                    LDA     5,DL
         5 001265   000011 755000 xsym               STA     FDS+9

      465    26187    4            END;  /*  GJOB.CMDCNT > 0  */

      466    26188    3         END;  /*  FLAGS.GJOB  */

  26188  5 001266   001274 710000 5                  TRA     s:26193

      467    26189    3      ELSE DO;     /*  NOT FLAGS.GJOB  */

      468    26190    3         FMT_VEC (0) = VECTOR ( NONE_STR );

  26190  5 001267   000022 237000 6                  LDAQ    18
         5 001270   000000 755000 xsym               STA     FMT_VEC
         5 001271   000001 756000 xsym               STQ     FMT_VEC+1

      469    26191    3         FDS.NVECS# = 1;

  26191  5 001272   000001 235007                    LDA     1,DL
         5 001273   000011 755000 xsym               STA     FDS+9

      470    26192    3         END;      /*  NOT FLAGS.GJOB  */

      471    26193    2      FMT_BUF = GJOB_JCL_FMT;

  26193  5 001274   040000 100400                    MLR     fill='040'O
         5 001275   000072 000044 4                  ADSC9   GJOB_JCL_FMT             cn=0,n=36
         5 001276   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      472    26194    2      FDS.FMT_.BOUND = SIZEV ( GJOB_JCL_FMT);
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:63   

  26194  5 001277   000000 236000 xsym               LDQ     FDS
         5 001300   177777 376007                    ANQ     65535,DL
         5 001301   000116 276000 6                  ORQ     78
         5 001302   000000 756000 xsym               STQ     FDS

      473    26195    2      CALL X$FORMAT( FDS );

  26195  5 001303   000012 630400 6                  EPPR0   10
         5 001304   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001305   000000 701000 xent               TSX1    X$FORMAT
         5 001306   000000 011000                    NOP     0

      474    26196
      475    26197    2      FMT_VEC (0) = VECTOR (SUBSTR ( KL$TREC.PASSWORD,0,4 ));

  26197  5 001307   777640 235007                    LDA     -96,DL
         5 001310   000000 236000 xsym               LDQ     DSEG1$
         5 001311   000002 036003                    ADLQ    2,DU
         5 001312   000000 755000 xsym               STA     FMT_VEC
         5 001313   000001 756000 xsym               STQ     FMT_VEC+1

      476    26198    2      FMT_VEC (1) = VECTOR (SUBSTR ( KL$TREC.PASSWORD,4,4 ));

  26198  5 001314   777640 235007                    LDA     -96,DL
         5 001315   000000 236000 xsym               LDQ     DSEG1$
         5 001316   000003 036003                    ADLQ    3,DU
         5 001317   000002 755000 xsym               STA     FMT_VEC+2
         5 001320   000003 756000 xsym               STQ     FMT_VEC+3

      477    26199    2      FMT_BUF = PASSWORD_JCL_FMT;

  26199  5 001321   040000 100400                    MLR     fill='040'O
         5 001322   000137 000033 4                  ADSC9   PASSWORD_JCL_FMT         cn=0,n=27
         5 001323   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      478    26200    2      FDS.FMT_.BOUND = SIZEV ( PASSWORD_JCL_FMT);
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:64   

  26200  5 001324   000000 236000 xsym               LDQ     FDS
         5 001325   177777 376007                    ANQ     65535,DL
         5 001326   000064 276000 6                  ORQ     52
         5 001327   000000 756000 xsym               STQ     FDS

      479    26201    2      FDS.NVECS# = 2;

  26201  5 001330   000002 235007                    LDA     2,DL
         5 001331   000011 755000 xsym               STA     FDS+9

      480    26202    2      CALL X$FORMAT( FDS );

  26202  5 001332   000012 630400 6                  EPPR0   10
         5 001333   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001334   000000 701000 xent               TSX1    X$FORMAT
         5 001335   000000 011000                    NOP     0

      481    26203
      482    26204    2      FMT_VEC (0) = VECTOR ( KL$TREC.PNAME.TXT );

  26204  5 001336   000016 235000 6                  LDA     14
         5 001337   000000 236000 xsym               LDQ     DSEG1$
         5 001340   000010 036000 6                  ADLQ    8
         5 001341   000000 755000 xsym               STA     FMT_VEC
         5 001342   000001 756000 xsym               STQ     FMT_VEC+1

      483    26205    2      FMT_BUF = PROFILE_JCL_FMT;

  26205  5 001343   040000 100400                    MLR     fill='040'O
         5 001344   000146 000020 4                  ADSC9   PROFILE_JCL_FMT          cn=0,n=16
         5 001345   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      484    26206    2      FDS.FMT_.BOUND = SIZEV ( PROFILE_JCL_FMT);

  26206  5 001346   000000 236000 xsym               LDQ     FDS
         5 001347   177777 376007                    ANQ     65535,DL
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:65   
         5 001350   000117 276000 6                  ORQ     79
         5 001351   000000 756000 xsym               STQ     FDS

      485    26207    2      FDS.NVECS# = 1;

  26207  5 001352   000001 235007                    LDA     1,DL
         5 001353   000011 755000 xsym               STA     FDS+9

      486    26208    2      CALL X$FORMAT( FDS );

  26208  5 001354   000012 630400 6                  EPPR0   10
         5 001355   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001356   000000 701000 xent               TSX1    X$FORMAT
         5 001357   000000 011000                    NOP     0

      487    26209
      488    26210    2      IF KL$TREC.HASP.RLS# = AS_BLANK THEN

  26210  5 001360   000000 470400 xsym               LDP0    DSEG1$
         5 001361   040000 106500                    CMPC    fill='040'O
         5 001362   000056 400120                    ADSC9   46,,PR0                  cn=2,n=80
         5 001363   000000 000001 xsym               ADSC9   AS_BLANK                 cn=0,n=1
         5 001364   001371 601000 5                  TNZ     s:26213

      489    26211    2         FMT_VEC (0) = VECTOR ( NONE_STR );

  26211  5 001365   000022 237000 6                  LDAQ    18
         5 001366   000000 755000 xsym               STA     FMT_VEC
         5 001367   000001 756000 xsym               STQ     FMT_VEC+1
         5 001370   001376 710000 5                  TRA     s:26214

      490    26212    2      ELSE
      491    26213    2         FMT_VEC (0) = VECTOR ( KL$TREC.HASP.RLS# );

  26213  5 001371   000020 235000 6                  LDA     16
         5 001372   000000 236000 xsym               LDQ     DSEG1$
         5 001373   000032 036000 6                  ADLQ    26
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:66   
         5 001374   000000 755000 xsym               STA     FMT_VEC
         5 001375   000001 756000 xsym               STQ     FMT_VEC+1

      492    26214    2      FMT_BUF = RLS_JCL_FMT;

  26214  5 001376   040000 100400                    MLR     fill='040'O
         5 001377   000152 000014 4                  ADSC9   RLS_JCL_FMT              cn=0,n=12
         5 001400   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      493    26215    2      FDS.FMT_.BOUND = SIZEV ( RLS_JCL_FMT);

  26215  5 001401   000000 236000 xsym               LDQ     FDS
         5 001402   177777 376007                    ANQ     65535,DL
         5 001403   000120 276000 6                  ORQ     80
         5 001404   000000 756000 xsym               STQ     FDS

      494    26216    2      FDS.NVECS# = 1;

  26216  5 001405   000001 235007                    LDA     1,DL
         5 001406   000011 755000 xsym               STA     FDS+9

      495    26217    2      CALL X$FORMAT( FDS );

  26217  5 001407   000012 630400 6                  EPPR0   10
         5 001410   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001411   000000 701000 xent               TSX1    X$FORMAT
         5 001412   000000 011000                    NOP     0

      496    26218
      497    26219    2      I = BITBIN ( KL$TREC.HASP.SLAVE#);

  26219  5 001413   000000 470400 xsym               LDP0    DSEG1$
         5 001414   000056 236100                    LDQ     46,,PR0
         5 001415   000041 772000                    QRL     33
         5 001416   000003 376007                    ANQ     3,DL
         5 001417   200007 756100                    STQ     I,,AUTO

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:67   
      498    26220    2      FMT_VEC(0) = VECTOR ( I );

  26220  5 001420   777640 235007                    LDA     -96,DL
         5 001421   200020 452500                    STP2    TERM_TYPE+2,,AUTO
         5 001422   200020 236100                    LDQ     TERM_TYPE+2,,AUTO
         5 001423   000007 036003                    ADLQ    7,DU
         5 001424   000000 755000 xsym               STA     FMT_VEC
         5 001425   000001 756000 xsym               STQ     FMT_VEC+1

      499    26221    2      FMT_BUF = SLAVE_JCL_FMT;

  26221  5 001426   040000 100400                    MLR     fill='040'O
         5 001427   000171 000032 4                  ADSC9   SLAVE_JCL_FMT            cn=0,n=26
         5 001430   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      500    26222    2      FDS.FMT_.BOUND = SIZEV ( SLAVE_JCL_FMT);

  26222  5 001431   000000 236000 xsym               LDQ     FDS
         5 001432   177777 376007                    ANQ     65535,DL
         5 001433   000033 276000 6                  ORQ     27
         5 001434   000000 756000 xsym               STQ     FDS

      501    26223    2      FDS.NVECS# = 1;

  26223  5 001435   000001 235007                    LDA     1,DL
         5 001436   000011 755000 xsym               STA     FDS+9

      502    26224    2      CALL X$FORMAT( FDS );

  26224  5 001437   000012 630400 6                  EPPR0   10
         5 001440   000017 631400 xsym               EPPR1   B_VECTNIL+15
         5 001441   000000 701000 xent               TSX1    X$FORMAT
         5 001442   000000 011000                    NOP     0

      503    26225
      504    26226        /*  READ THE DEVICE RECORDS AND THEN CALL
      505    26227             ASL$DISP_ONE_DEVICE  */
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:68   
      506    26228
      507    26229    3   DO I=0 TO KL$TWSNREC.NDEV-1;

  26229  5 001443   200007 450100                    STZ     I,,AUTO
         5 001444   001530 710000 5                  TRA     s:26245+1

      508    26230    3      IF KL$TWSNREC.DEVS.TDEV(I) AND KL$TWSNREC.DEVS.TERM(I)=KL$TREC.TNAME

  26230  5 001445   200007 236100                    LDQ     I,,AUTO
         5 001446   000013 402007                    MPY     11,DL
         5 001447   000000 470400 xsym               LDP0    DSEG2$
         5 001450   000006 236106                    LDQ     6,QL,PR0
         5 001451   000100 316007                    CANQ    64,DL
         5 001452   001527 600000 5                  TZE     s:26245
         5 001453   200007 236100                    LDQ     I,,AUTO
         5 001454   000054 402007                    MPY     44,DL
         5 001455   000000 471400 xsym               LDP1    DSEG1$
         5 001456   040100 106506                    CMPC    fill='040'O
         5 001457   000013 000010                    ADSC9   11,Q,PR0                 cn=0,n=8
         5 001460   100013 000010                    ADSC9   11,,PR1                  cn=0,n=8
         5 001461   001527 601000 5                  TNZ     s:26245

      509    26231    4      THEN DO;

      510    26232    4         USERS_KEY.COUNT = 8;

  26232  5 001462   010000 236003                    LDQ     4096,DU
         5 001463   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      511    26233    4         CALL CONCAT (USERS_KEY.TXTC,

  26233  5 001464   200007 236100                    LDQ     I,,AUTO
         5 001465   000013 402007                    MPY     11,DL
         5 001466   000005 236106                    LDQ     5,QL,PR0
         5 001467   000011 772000                    QRL     9
         5 001470   000000 552030 xsym               STBQ    USERS_KEY,'30'O
         5 001471   200007 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:69   
         5 001472   000054 402007                    MPY     44,DL
         5 001473   040000 100506                    MLR     fill='040'O
         5 001474   000005 400002                    ADSC9   5,Q,PR0                  cn=2,n=2
         5 001475   000000 600002 xsym               ADSC9   USERS_KEY                cn=3,n=2
         5 001476   040000 100500                    MLR     fill='040'O
         5 001477   100001 000004                    ADSC9   1,,PR1                   cn=0,n=4
         5 001500   000001 200045 xsym               ADSC9   USERS_KEY+1              cn=1,n=37

      512    26234    4                      KL$TWSNREC.DEVS.TYP(I),
      513    26235    4                      KL$TWSNREC.DEVS.NUM(I),
      514    26236    4                      KL$TREC.TWSN#);
      515    26237    4         ARS = DSEG3SIZE;

  26237  5 001501   000000 235000 xsym               LDA     DSEG3SIZE
         5 001502   200004 755100                    STA     ARS,,AUTO

      516    26238    4         CALL ASB$READ_HLP (DSEG3$, ARS, 3)

  26238  5 001503   000121 236000 6                  LDQ     81
         5 001504   200022 756100                    STQ     TERM_TYPE+4,,AUTO
         5 001505   200004 630500                    EPPR0   ARS,,AUTO
         5 001506   200021 450500                    STP0    TERM_TYPE+3,,AUTO
         5 001507   000122 236000 6                  LDQ     82
         5 001510   200020 756100                    STQ     TERM_TYPE+2,,AUTO
         5 001511   200020 630500                    EPPR0   TERM_TYPE+2,,AUTO
         5 001512   000021 631400 xsym               EPPR1   B_VECTNIL+17
         5 001513   000000 701000 xent               TSX1    ASB$READ_HLP
         5 001514   001516 702000 5                  TSX2    s:26240
         5 001515   001523 710000 5                  TRA     s:26243

      517    26239    5         WHENALTRETURN DO;

      518    26240    5            CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  26240  5 001516   000124 630400 6                  EPPR0   84
         5 001517   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001520   000000 701000 xent               TSX1    ASA$ERROR
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:70   
         5 001521   000000 011000                    NOP     0

      519    26241    5            RETURN;

  26241  5 001522   000000 702200 xent               TSX2  ! X66_ARET

      520    26242    5            END;  /*  WHENALTRETURN  */
      521    26243    4         CALL ASL$DISP_ONE_DEVICE ( %YES#, %YES# );

  26243  5 001523   000126 630400 6                  EPPR0   86
         5 001524   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001525   000000 701000 xent               TSX1    ASL$DISP_ONE_DEVICE
         5 001526   000000 011000                    NOP     0

      522    26244    4         END; /*  End of TDEV and TWSNREC.TERM = TREC.TNAME  */

      523    26245    3      END;            /*  End of do i  */

  26245  5 001527   200007 054100                    AOS     I,,AUTO
         5 001530   000000 470400 xsym               LDP0    DSEG2$
         5 001531   200007 236100                    LDQ     I,,AUTO
         5 001532   001445 604000 5                  TMI     s:26230
         5 001533   000004 116100                    CMPQ    4,,PR0
         5 001534   001445 602000 5                  TNC     s:26230

      524    26246
      525    26247    2      CALL ASB$WRITE_LO(' ',1);

  26247  5 001535   000003 630400 6                  EPPR0   3
         5 001536   000020 631400 xsym               EPPR1   B_VECTNIL+16
         5 001537   000000 701000 xent               TSX1    ASB$WRITE_LO
         5 001540   000000 011000                    NOP     0

      526    26248    2      END;            /*  End JCL  */

      527    26249    1   RETURN;

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:71   
  26249  5 001541   000000 702200 xent               TSX2  ! X66_ARET
      528    26250    1   END ASL$DISP_ONE_TERMINAL;

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:72   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_TERMINAL.
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:73   

 **** Variables and constants ****

  ****  Section 003  Data  ASL$DISP_ONE_TERMINAL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    64-0-0/c STRC(171)   r     1 CONFIG_KEY                 0-0-0/w PTR         r     1 KL$HASPDEV$
    71-0-0/c STRC(243)   r     1 KL_SS                     63-0-0/w PTR         r     1 LINCNFG$
     1-0-0/w UBIN        r     1 LINCNFG_BUF(0:49)

  ****  Section 004 RoData ASL$DISP_ONE_TERMINAL

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    72-0-0/c CHAR        r     1 GJOB_JCL_FMT             103-0-0/c CHAR(6)     r     1 HASPCP_STR
   105-0-0/c CHAR(6)     r     1 HASPCR_STR               111-0-0/c CHAR(7)     r     1 HASPLP2_STR
   113-0-0/c CHAR(7)     r     1 HASPLP3_STR              107-0-0/c CHAR(6)     r     1 HASPLP_STR
   115-0-0/c CHAR(6)     r     1 HASPOC_STR               117-0-0/c CHAR(7)     r     1 HEX2_FMT
   121-0-0/c CHAR(5)     r     1 INOUT_STR                123-0-0/c CHAR(2)     r     1 IN_STR
     0-0-0/w STRC(1008)  r     1 KL_GJOB                   34-0-0/w STRC(828)   r     1 KL_HASP
    63-0-0/w STRC(252)   r     1 KL_HASPDEV               124-0-0/c CHAR(4)     r     1 NA_STR
   125-0-0/c CHAR(4)     r     1 NONE_STR                 126-0-0/c CHAR(14)    r     1 NO_PASSWORD
   132-0-0/c CHAR(2)     r     1 NO_STR                   133-0-0/c CHAR(3)     r     1 OUT_STR
   134-0-0/c CHAR(11)    r     1 PASSWORD                 137-0-0/c CHAR(27)    r     1 PASSWORD_JCL_FMT
   146-0-0/c CHAR(16)    r     1 PROFILE_JCL_FMT          152-0-0/c CHAR(12)    r     1 RLS_JCL_FMT
   155-0-0/c CHAR(7)     r     1 S2780CP_STR              157-0-0/c CHAR(7)     r     1 S2780CR_STR
   161-0-0/c CHAR(7)     r     1 S2780LP_STR              163-0-0/c CHAR(7)     r     1 S3780CP_STR
   165-0-0/c CHAR(7)     r     1 S3780CR_STR              167-0-0/c CHAR(7)     r     1 S3780LP_STR
   171-0-0/c CHAR(26)    r     1 SLAVE_JCL_FMT            200-0-0/c CHAR(8)     r     1 TCONSOLE_STR
   202-0-0/c CHAR(7)     r     1 TDEV_STR                 204-0-0/c CHAR(8)     r     1 TERMINAL_STR
   206-0-0/c CHAR(72)    r     1 TERM_CREATE_JCL_FMT      230-0-0/c CHAR(57)    r     1 TERM_DEV_FMT
   247-0-0/c CHAR(76)    r     1 TERM_DEV_HDR             272-0-0/c CHAR(59)    r     1 TERM_HDR_FMT
   311-0-0/c CHAR(32)    r     1 TERM_OPT_FMT             321-0-0/c CHAR(25)    r     1 TERM_RLS_FMT
   330-0-0/c CHAR(2)     r     1 TEXT_FMT                 331-0-0/c CHAR(3)     r     1 YES_STR

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:74   
  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @JCL                       4-0-0/w SBIN        r     1 ARS
     6-0-0/w UBIN        r     1 DEVNUM                     7-0-0/w SBIN        r     1 I
    *0-0-0/b BIT         r     1 JCL                       11-0-0/w PTR         r     1 PP$
    12-0-0/w PTR         r     1 PP_END$                   13-0-0/w UBIN        r     1 PP_SIZE
    14-0-0/w UBIN        r     1 PP_TYPE                   15-0-0/w PTR         r     1 PRO$
    16-0-0/w UBIN        r     1 TERM_TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR        r     1 AS_BLANK                   0-0-0/w UBIN        r     1 AS_DCBNUM#
     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w STRC(369)   r     1 AS_FIELD2
     0-0-0/c CHAR(8)     r     1 BLANK_PASS                 0-0-0/w PTR         r     1 DSEG1$
     0-0-0/w PTR         r     1 DSEG2$                     0-0-0/w PTR         r     1 DSEG3$
     0-0-0/w UBIN        r     1 DSEG3SIZE                  0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/w STRC(576)   r     1 KL_DREC_CNT                0-0-0/c STRC(378)   r     1 USERS_KEY

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(576)   r     1 KL$DREC                    0-0-0/w STRC(252)   r     1 KL$HASPDEV
     0-0-0/c STRC(720)   r     1 KL$PHDR                    0-0-0/w STRC(2412)  r     1 KL$TREC
     0-0-0/b STRC(126)   r     1 KL$TRMD                    0-0-0/w STRC(576)   r     1 KL$TWSNREC
     0-0-0/w ASTR(387)   r     1 LINCNFG                    0-0-0N  NULL        r     1 M$PRO
     0-0-0/b STRC(18)    r     1 PP$STRCT                   0-0-0/w ASTR(9)     r     1 TEXT$C

PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:75   

   Procedure ASL$DISP_ONE_TERMINAL requires 866 words for executable code.
   Procedure ASL$DISP_ONE_TERMINAL requires 20 words of local(AUTO) storage.

    No errors detected in file ASL$DISPLAY_TERMINAL.:E05TSI    .
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:76   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:77   
          MINI XREF LISTING

ARS
     25419**DCL     25898<<ASSIGN  25900<>CALL    25931>>ASSIGN  26237<<ASSIGN  26238<>CALL
ASA$ERROR
     24502**DCL-ENT 26240--CALL
ASA_BRKS_LOC
     21396**DCL     21396--REDEF
ASB$READ_HLP
     24505**DCL-ENT 26238--CALL
ASB$READ_NETCON
     24508**DCL-ENT 26063--CALL
ASB$WRITE_LO
     24511**DCL-ENT 25983--CALL    25984--CALL    25995--CALL    26017--CALL    26032--CALL    26033--CALL
     26247--CALL
ASD$READ_PRO
     24514**DCL-ENT 25900--CALL
ASH$ERROR
     24517**DCL-ENT 25919--CALL    25977--CALL
ASL$DISP_ONE_DEVICE
     24520**DCL-ENT 26243--CALL
AS_BLANK
     21256**DCL     26017<>CALL    26023>>IF      26032<>CALL    26210>>IF
AS_DCBNUM#
     21403**DCL     25964<<ASSIGN
AS_DEFAULT.BANNER_PERM
     22089**DCL     22090--REDEF
AS_DEFAULT.BUDGET.MACCT
     21994**DCL     21998--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     22007**DCL     22010--REDEF
AS_DEFAULT.BUDGET.PACCUM
     21990**DCL     21992--REDEF
AS_DEFAULT.BUDGET.PMAXC
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:78   
     21985**DCL     21987--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     22105**DCL     22106--REDEF   22107--REDEF
AS_DEFAULT_DREC.PASSWORD
     23359**DCL     23363--REDEF
AS_DEFAULT_DREC.RENAME
     23382**DCL     23383--REDEF
AS_DFLT.BANNER_PERM
     21911**DCL     21912--REDEF
AS_DFLT.BUDGET.MACCT
     21816**DCL     21820--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     21829**DCL     21832--REDEF
AS_DFLT.BUDGET.PACCUM
     21812**DCL     21814--REDEF
AS_DFLT.BUDGET.PMAXC
     21807**DCL     21809--REDEF
AS_DFLT.SETUP_CHRA.TXT
     21927**DCL     21928--REDEF   21929--REDEF
AS_FE_MODE
     21262**DCL     21263--REDEF
AS_FIELD1
     21392**DCL     25922<<ASSIGN
AS_FIELD1.COUNT
     21393**DCL     25962<<ASSIGN
AS_FIELD1.TEXT
     21393**DCL     25961<<ASSIGN
AS_FIELD2
     21393**DCL     25963<<ASSIGN
AS_MODE
     21259**DCL     21261--REDEF
AS_MOD_USER.ACCESS
     24124**DCL     24125--REDEF
AS_MOD_USER.BANNER
     24111**DCL     24112--REDEF
AS_MOD_USER.BANNER_PERM
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:79   
     24113**DCL     24114--REDEF
AS_MOD_USER.BILL
     24119**DCL     24120--REDEF
AS_MOD_USER.CPROC
     24115**DCL     24116--REDEF
AS_MOD_USER.FEBILL
     24195**DCL     24196--REDEF
AS_MOD_USER.FECXTMEM
     24212**DCL     24213--REDEF
AS_MOD_USER.FEMINTS
     24197**DCL     24198--REDEF
AS_MOD_USER.FEMMEM
     24208**DCL     24209--REDEF
AS_MOD_USER.FEMTIME
     24206**DCL     24207--REDEF
AS_MOD_USER.FEPPRIV
     24203**DCL     24205--REDEF
AS_MOD_USER.FEPRIV
     24200**DCL     24202--REDEF
AS_MOD_USER.FORCE_BIT
     24109**DCL     24110--REDEF
AS_MOD_USER.KEY
     24191**DCL     24193--REDEF
AS_MOD_USER.LASTCPROC
     24117**DCL     24118--REDEF
AS_MOD_USER.LIMITS.DO_
     24165**DCL     24166--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     24181**DCL     24182--REDEF
AS_MOD_USER.LIMITS.LO
     24161**DCL     24162--REDEF
AS_MOD_USER.LIMITS.MEM
     24157**DCL     24158--REDEF
AS_MOD_USER.LIMITS.MPRIO
     24185**DCL     24186--REDEF
AS_MOD_USER.LIMITS.PDIS
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:80   
     24173**DCL     24174--REDEF
AS_MOD_USER.LIMITS.PO
     24169**DCL     24170--REDEF
AS_MOD_USER.LIMITS.TDIS
     24177**DCL     24178--REDEF
AS_MOD_USER.LIMITS.TIME
     24153**DCL     24154--REDEF
AS_MOD_USER.MAXENQ
     24134**DCL     24135--REDEF
AS_MOD_USER.PERM_BIT
     24107**DCL     24108--REDEF
AS_MOD_USER.PPRIV
     24129**DCL     24131--REDEF
AS_MOD_USER.PRIOB
     24136**DCL     24137--REDEF
AS_MOD_USER.PRIV
     24126**DCL     24128--REDEF
AS_MOD_USER.QUAN
     24132**DCL     24133--REDEF
AS_MOD_USER.SETUP
     24105**DCL     24106--REDEF
AS_PROJECT.BANNER_PERM
     22445**DCL     22446--REDEF
AS_PROJECT.BUDGET.MACCT
     22350**DCL     22354--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     22363**DCL     22366--REDEF
AS_PROJECT.BUDGET.PACCUM
     22346**DCL     22348--REDEF
AS_PROJECT.BUDGET.PMAXC
     22341**DCL     22343--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     22461**DCL     22462--REDEF   22463--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     22623**DCL     22624--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:81   
     22528**DCL     22532--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     22541**DCL     22544--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     22524**DCL     22526--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     22519**DCL     22521--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     22639**DCL     22640--REDEF   22641--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     23845**DCL     23849--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     23868**DCL     23869--REDEF
AS_PROJECT_DREC.PASSWORD
     23683**DCL     23687--REDEF
AS_PROJECT_DREC.RENAME
     23706**DCL     23707--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     22267**DCL     22268--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     22172**DCL     22176--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     22185**DCL     22188--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     22168**DCL     22170--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     22163**DCL     22165--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     22283**DCL     22284--REDEF   22285--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     23521**DCL     23525--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     23544**DCL     23545--REDEF
AS_USERS.BANNER_PERM
     21733**DCL     21734--REDEF
AS_USERS.BUDGET.MACCT
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:82   
     21638**DCL     21642--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     21651**DCL     21654--REDEF
AS_USERS.BUDGET.PACCUM
     21634**DCL     21636--REDEF
AS_USERS.BUDGET.PMAXC
     21629**DCL     21631--REDEF
AS_USERS.SETUP_CHRA.TXT
     21749**DCL     21750--REDEF   21751--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     22801**DCL     22802--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     22706**DCL     22710--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     22719**DCL     22722--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     22702**DCL     22704--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     22697**DCL     22699--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     22817**DCL     22818--REDEF   22819--REDEF
BLANK_PASS
     21387**DCL     25999>>IF
CONFIG_KEY
     24271**DCL     26063--CALL
CONFIG_KEY.TERMID.LEV
     24293**DCL     26037<<ASSIGN
CONFIG_KEY.TERMID.TERM
     24293**DCL     24302--REDEF
CONFIG_KEY.TERMID.TERM.SUBDEVICE.BYT
     24296**DCL     26060<<ASSIGN  26061<<ASSIGN
CONFIG_KEY.TERMID.TERM.TERM_NAME
     24302**DCL     26036<<ASSIGN
DEVNUM
     25421**DCL     26035<<ASSIGN  26060>>ASSIGN  26061>>ASSIGN  26062<<ASSIGN  26062>>ASSIGN
DSEG1$
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:83   
     21397**DCL     24541--IMP-PTR 24936--IMP-PTR 25899>>ASSIGN  25961>>ASSIGN  25987>>ASSIGN  25989>>ASSIGN
     25989>>ASSIGN  25996>>IF      25997>>ASSIGN  25998>>ASSIGN  25999>>IF      26003>>IF      26006>>ASSIGN
     26018>>IF      26023>>IF      26026>>ASSIGN  26036>>ASSIGN  26038>>ASSIGN  26041>>IF      26170>>ASSIGN
     26172>>ASSIGN  26177>>IF      26178>>ASSIGN  26179>>ASSIGN  26180>>ASSIGN  26181>>ASSIGN  26182>>IF
     26185>>ASSIGN  26197>>ASSIGN  26198>>ASSIGN  26204>>ASSIGN  26210>>IF      26213>>ASSIGN  26219>>ASSIGN
     26230>>IF      26233>>CALLBLT
DSEG2$
     21398**DCL     25384--IMP-PTR 26040>>DOINDEX 26041>>IF      26041>>IF      26045>>ASSIGN  26046>>ASSIGN
     26047>>IF      26049>>IF      26055>>IF      26072>>IF      26229>>DOINDEX 26230>>IF      26230>>IF
     26233>>CALLBLT 26233>>CALLBLT
DSEG3$
     21398**DCL     25897>>ASSIGN  26238<>CALL
DSEG3SIZE
     21398**DCL     25898>>ASSIGN  26237>>ASSIGN
ERR_CODE
     21391**DCL     21392--REDEF
FDS
     21288**DCL     25994<>CALL    26016<>CALL    26031<>CALL    26164<>CALL    26176<>CALL    26195<>CALL
     26202<>CALL    26208<>CALL    26217<>CALL    26224<>CALL
FDS.FMT_.BOUND
     21293**DCL     25992<<ASSIGN  26015<<ASSIGN  26030<<ASSIGN  26044<<ASSIGN  26087>>CALLBLT 26088<<ASSIGN
     26088>>ASSIGN  26093>>CALLBLT 26094<<ASSIGN  26094>>ASSIGN  26099>>CALLBLT 26100<<ASSIGN  26100>>ASSIGN
     26105>>CALLBLT 26106<<ASSIGN  26106>>ASSIGN  26111>>CALLBLT 26112<<ASSIGN  26112>>ASSIGN  26117>>CALLBLT
     26118<<ASSIGN  26118>>ASSIGN  26123>>CALLBLT 26124<<ASSIGN  26124>>ASSIGN  26129>>CALLBLT 26130<<ASSIGN
     26130>>ASSIGN  26135>>CALLBLT 26136<<ASSIGN  26136>>ASSIGN  26141>>CALLBLT 26142<<ASSIGN  26142>>ASSIGN
     26147>>CALLBLT 26148<<ASSIGN  26148>>ASSIGN  26153>>CALLBLT 26154<<ASSIGN  26154>>ASSIGN  26159>>CALLBLT
     26160<<ASSIGN  26160>>ASSIGN  26174<<ASSIGN  26194<<ASSIGN  26200<<ASSIGN  26206<<ASSIGN  26215<<ASSIGN
     26222<<ASSIGN
FDS.NVECS#
     21316**DCL     25993<<ASSIGN  26004<<ASSIGN  26007<<ASSIGN  26012<<ASSIGN  26028<<ASSIGN  26034<<ASSIGN
     26175<<ASSIGN  26183<<ASSIGN  26186<<ASSIGN  26191<<ASSIGN  26201<<ASSIGN  26207<<ASSIGN  26216<<ASSIGN
     26223<<ASSIGN
FMT_BUF
     21387**DCL     25991<<ASSIGN  26014<<ASSIGN  26029<<ASSIGN  26043<<ASSIGN  26087<<CALLBLT 26093<<CALLBLT
     26099<<CALLBLT 26105<<CALLBLT 26111<<CALLBLT 26117<<CALLBLT 26123<<CALLBLT 26129<<CALLBLT 26135<<CALLBLT
     26141<<CALLBLT 26147<<CALLBLT 26153<<CALLBLT 26159<<CALLBLT 26173<<ASSIGN  26193<<ASSIGN  26199<<ASSIGN
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:84   
     26205<<ASSIGN  26214<<ASSIGN  26221<<ASSIGN
FMT_VEC
     21387**DCL     25987<<ASSIGN  25988<<ASSIGN  25989<<ASSIGN  25990<<ASSIGN  25997<<ASSIGN  25998<<ASSIGN
     26000<<ASSIGN  26002<<ASSIGN  26006<<ASSIGN  26011<<ASSIGN  26019<<ASSIGN  26021<<ASSIGN  26024<<ASSIGN
     26026<<ASSIGN  26045<<ASSIGN  26046<<ASSIGN  26051<<ASSIGN  26053<<ASSIGN  26057<<ASSIGN  26059<<ASSIGN
     26070<<ASSIGN  26071<<ASSIGN  26074<<ASSIGN  26077<<ASSIGN  26079<<ASSIGN  26080<<ASSIGN  26086<<ASSIGN
     26092<<ASSIGN  26098<<ASSIGN  26104<<ASSIGN  26110<<ASSIGN  26116<<ASSIGN  26122<<ASSIGN  26128<<ASSIGN
     26134<<ASSIGN  26140<<ASSIGN  26146<<ASSIGN  26152<<ASSIGN  26158<<ASSIGN  26170<<ASSIGN  26171<<ASSIGN
     26172<<ASSIGN  26178<<ASSIGN  26179<<ASSIGN  26180<<ASSIGN  26181<<ASSIGN  26185<<ASSIGN  26190<<ASSIGN
     26197<<ASSIGN  26198<<ASSIGN  26204<<ASSIGN  26211<<ASSIGN  26213<<ASSIGN  26220<<ASSIGN
FOUND_IT
     25954**LABEL   25941--GOTO
GJOB_JCL_FMT
     25843**DCL     26193>>ASSIGN  26194--ASSIGN
HASPCP_STR
     25845**DCL     26140--ASSIGN
HASPCR_STR
     25846**DCL     26134--ASSIGN
HASPLP2_STR
     25848**DCL     26146--ASSIGN
HASPLP3_STR
     25849**DCL     26152--ASSIGN
HASPLP_STR
     25847**DCL     26128--ASSIGN
HASPOC_STR
     25850**DCL     26122--ASSIGN
HEX2_FMT
     25851**DCL     26159--CALLBLT 26159>>CALLBLT 26160--ASSIGN
I
     25422**DCL     25945<<ASSIGN  25946>>ASSIGN  26040<<DOINDEX 26041>>IF      26041>>IF      26045>>ASSIGN
     26046>>ASSIGN  26047>>IF      26049>>IF      26055>>IF      26072>>IF      26219<<ASSIGN  26220--ASSIGN
     26229<<DOINDEX 26230>>IF      26230>>IF      26233>>CALLBLT 26233>>CALLBLT
INOUT_STR
     25852**DCL     26051--ASSIGN
IN_STR
     25853**DCL     26053--ASSIGN
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:85   
JCL
     25424**DCL         6--PROC    25986>>IF
KL$DREC.PASSWORD
     24599**DCL     24603--REDEF
KL$DREC.PNAME
     24605**DCL     25989--ASSIGN  25989--ASSIGN
KL$DREC.RENAME
     24622**DCL     24623--REDEF
KL$HASPDEV.DADR.DEVCTL
     24862**DCL     26079--ASSIGN
KL$HASPDEV.DADR.DEVNUM#
     24853**DCL     26082>>DOSELCT 26158--ASSIGN
KL$HASPDEV.DADR.SDNUM#
     24860**DCL     26080--ASSIGN
KL$HASPDEV.TERMID.TERM
     24808**DCL     24817--REDEF
KL$HASPDEV$
     24255**DCL     24658--IMP-PTR 26038<<ASSIGN  26039<<ASSIGN  26039>>ASSIGN  26079>>ASSIGN  26080>>ASSIGN
     26082>>DOSELCT 26158>>ASSIGN  26165<<ASSIGN  26165>>ASSIGN
KL$PHDR
     24892**DCL     25900<>CALL    25932--ASSIGN
KL$PHDR.TTYP
     24893**DCL     25902>>IF
KL$TREC.FLAGS.GJOB
     24962**DCL     25996>>IF      26177>>IF
KL$TREC.GJOB.ACCT
     25058**DCL     25997--ASSIGN  26178--ASSIGN
KL$TREC.GJOB.CMD
     25062**DCL     26006--ASSIGN  26185--ASSIGN
KL$TREC.GJOB.CMDCNT
     25061**DCL     26003>>IF      26182>>IF
KL$TREC.GJOB.PASS
     25060**DCL     25999>>IF      26180--ASSIGN  26181--ASSIGN
KL$TREC.GJOB.UNAME
     25059**DCL     25998--ASSIGN  26179--ASSIGN
KL$TREC.HASP.RLS#
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:86   
     25209**DCL     26023>>IF      26026--ASSIGN  26210>>IF      26213--ASSIGN
KL$TREC.HASP.SLAVE#
     25202**DCL     26018>>IF      26219>>ASSIGN
KL$TREC.PASSWORD
     24994**DCL     24998--REDEF   26197--ASSIGN  26198--ASSIGN
KL$TREC.PNAME
     25000**DCL     25899>>ASSIGN
KL$TREC.PNAME.TXT
     25011**DCL     26204--ASSIGN
KL$TREC.RENAME
     25017**DCL     25018--REDEF
KL$TREC.SNAME
     25031**DCL     26172--ASSIGN
KL$TREC.TNAME
     25027**DCL     25961>>ASSIGN  25962--ASSIGN  25987--ASSIGN  26036>>ASSIGN  26041>>IF      26170--ASSIGN
     26230>>IF
KL$TREC.TWSN#
     24991**DCL     26233>>CALLBLT
KL$TRMD.PROTYP#
     25237**DCL     25954>>ASSIGN
KL$TWSNREC.DEVS.IO.INPUT
     25394**DCL     26047>>IF
KL$TWSNREC.DEVS.IO.OUTPUT
     25395**DCL     26049>>IF      26055>>IF
KL$TWSNREC.DEVS.NUM
     25390**DCL     26046--ASSIGN  26233>>CALLBLT
KL$TWSNREC.DEVS.TDEV
     25396**DCL     26041>>IF      26230>>IF
KL$TWSNREC.DEVS.TERM
     25403**DCL     26041>>IF      26230>>IF
KL$TWSNREC.DEVS.TYP
     25389**DCL     26045--ASSIGN  26072>>IF      26233>>CALLBLT
KL$TWSNREC.NDEV
     25387**DCL     26040>>DOINDEX 26229>>DOINDEX
KL_DEFAULT.PASSWORD
     24007**DCL     24011--REDEF
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:87   
KL_DEFAULT.RENAME
     24030**DCL     24031--REDEF
KL_DFLT.PASSWORD
     23197**DCL     23201--REDEF
KL_DFLT.RENAME
     23220**DCL     23221--REDEF
KL_DREC.PASSWORD
     23035**DCL     23039--REDEF
KL_DREC.RENAME
     23058**DCL     23059--REDEF
KL_DREC_CNT
     22864**DCL     26038--ASSIGN
KL_DREC_CNT.PASSWORD
     22922**DCL     22926--REDEF
KL_DREC_CNT.RENAME
     22945**DCL     22946--REDEF
KL_GJOB
     25449**DCL     26039--ASSIGN
KL_HASP
     25474**DCL     26039--ASSIGN
KL_HASPDEV
     25624**DCL     26165--ASSIGN
KL_HASPDEV.TERMID.TERM
     25774**DCL     25783--REDEF
KL_SS.SGN
     24487**DCL     24496--REDEF
KL_SS.SGN.PNAME
     24495**DCL     26070--ASSIGN
KL_SS.SGN_R
     24496**DCL     26065<<ASSIGN  26068<<ASSIGN
LINCNFG.LGN.LGNSIZE
     24460**DCL     24461--IMP-SIZ 26065>>ASSIGN
LINCNFG.LGN.LGNSTRING
     24461**DCL     26065>>ASSIGN
LINCNFG$
     24257**DCL     24323--IMP-PTR 26065>>ASSIGN  26065>>ASSIGN
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:88   
LINCNFG_BUF
     24256**DCL     24257--DCLINIT 26063--CALL
M$PRO
     24251**DCL     25964>>ASSIGN
NA_STR
     25854**DCL     26071--ASSIGN
NONE_STR
     25855**DCL     26011--ASSIGN  26024--ASSIGN  26059--ASSIGN  26190--ASSIGN  26211--ASSIGN
NO_PASSWORD
     25856**DCL     26000--ASSIGN
NO_STR
     25857**DCL     26021--ASSIGN
OUT_STR
     25858**DCL     26057--ASSIGN
PASSWORD
     25859**DCL     26002--ASSIGN
PASSWORD_JCL_FMT
     25860**DCL     26199>>ASSIGN  26200--ASSIGN
PP$
     25425**DCL     25409--IMP-PTR 25930<<ASSIGN  25931>>ASSIGN  25932<<ASSIGN  25932>>ASSIGN  25933>>DOWHILE
     25934>>ASSIGN  25935>>ASSIGN  25936<<ASSIGN  25936>>ASSIGN  25946<<ASSIGN  25946>>ASSIGN  25950>>IF
     25954>>ASSIGN
PP$STRCT.SIZE
     25411**DCL     25935>>ASSIGN
PP$STRCT.TYPE
     25410**DCL     25934>>ASSIGN
PP_END$
     25426**DCL     25931<<ASSIGN  25933>>DOWHILE 25950>>IF
PP_SIZE
     25427**DCL     25935<<ASSIGN  25945>>ASSIGN  25945>>ASSIGN
PP_TYPE
     25428**DCL     25934<<ASSIGN  25938>>DOSELCT
PRO$
     25429**DCL     24892--IMP-PTR 25897<<ASSIGN  25900>>CALL    25902>>IF      25930>>ASSIGN
PROFILE_JCL_FMT
     25862**DCL     26205>>ASSIGN  26206--ASSIGN
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:89   
PROJ_KEY.TEXT
     21269**DCL     21269--REDEF
PROJ_KEY.TXT.PROJECT
     21269**DCL     21269--REDEF
REMEM_VAR
     21395**DCL     21395--REDEF
REM_FCMD
     21395**DCL     21396--REDEF
RLS_JCL_FMT
     25864**DCL     26214>>ASSIGN  26215--ASSIGN
S2780CP_STR
     25866**DCL     26098--ASSIGN
S2780CR_STR
     25867**DCL     26092--ASSIGN
S2780LP_STR
     25868**DCL     26086--ASSIGN
S3780CP_STR
     25869**DCL     26116--ASSIGN
S3780CR_STR
     25870**DCL     26110--ASSIGN
S3780LP_STR
     25871**DCL     26104--ASSIGN
SLAVE_JCL_FMT
     25872**DCL     26221>>ASSIGN  26222--ASSIGN
TCONSOLE_STR
     25874**DCL     26074--ASSIGN
TDEV_STR
     25875**DCL     26077--ASSIGN
TERMINAL_STR
     25876**DCL     25988--ASSIGN
TERM_CREATE_JCL_FMT
     25877**DCL     26173>>ASSIGN  26174--ASSIGN
TERM_DEV_FMT
     25879**DCL     26043>>ASSIGN  26044--ASSIGN
TERM_DEV_HDR
     25881**DCL     26033<>CALL    26033--CALL
PL6.E3A0      #001=ASL$DISP_ONE_TERMINAL File=ASL$DISPLAY_TERMINAL.:E05TSI       TUE 07/29/97 09:56 Page:90   
TERM_HDR_FMT
     25883**DCL     25991>>ASSIGN  25992--ASSIGN
TERM_OPT_FMT
     25885**DCL     26014>>ASSIGN  26015--ASSIGN
TERM_RLS_FMT
     25887**DCL     26029>>ASSIGN  26030--ASSIGN
TERM_TYPE
     25430**DCL     25923<<ASSIGN  25951<<ASSIGN  25954<<ASSIGN  25980<<ASSIGN  25990--ASSIGN  26171--ASSIGN
TEXT$C.CNT
     25414**DCL     25415--IMP-SIZ 25989>>ASSIGN
TEXT$C.TEXT
     25415**DCL     25989--ASSIGN
TEXT_FMT
     25889**DCL     26087--CALLBLT 26087>>CALLBLT 26088--ASSIGN  26093--CALLBLT 26093>>CALLBLT 26094--ASSIGN
     26099--CALLBLT 26099>>CALLBLT 26100--ASSIGN  26105--CALLBLT 26105>>CALLBLT 26106--ASSIGN  26111--CALLBLT
     26111>>CALLBLT 26112--ASSIGN  26117--CALLBLT 26117>>CALLBLT 26118--ASSIGN  26123--CALLBLT 26123>>CALLBLT
     26124--ASSIGN  26129--CALLBLT 26129>>CALLBLT 26130--ASSIGN  26135--CALLBLT 26135>>CALLBLT 26136--ASSIGN
     26141--CALLBLT 26141>>CALLBLT 26142--ASSIGN  26147--CALLBLT 26147>>CALLBLT 26148--ASSIGN  26153--CALLBLT
     26153>>CALLBLT 26154--ASSIGN
USERS_KEY
     21266**DCL     25899<<ASSIGN  25900<>CALL    25922>>ASSIGN  25963>>ASSIGN  26240<>CALL
USERS_KEY.COUNT
     21266**DCL     26232<<ASSIGN
USERS_KEY.TEXT
     21266**DCL     21267--REDEF   21267--REDEF   21267--REDEF   21268--REDEF
USERS_KEY.TXTC
     21267**DCL     26233<<CALLBLT
X$FORMAT
     24522**DCL-ENT 25994--CALL    26016--CALL    26031--CALL    26164--CALL    26176--CALL    26195--CALL
     26202--CALL    26208--CALL    26217--CALL    26224--CALL
YES_STR
     25890**DCL     26019--ASSIGN
