VERSION E05

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:1    
        1        1        /*M* KFF$FEBOOT - Routine to build a C00 FEP boot image */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        KFF$FEBOOT: PROC (FEX,BOOT_BUFFER,RET_ERROR_,WDSUSED_) ALTRET;
        9        9        /*D* NAME: KFF$FEBOOT
       10       10             CALL: CALL KFF$FEBOOT(FEPNAME,[BOOT_BUFFER],[RET_ERROR_])
       11       11                        ALTRETURN (X);
       12       12             DESCRIPTION:
       13       13                   KFF$FEBOOT builds a FEP boot-image.  Depending on the
       14       14                   calling parameters, the image will be left in a buffer
       15       15                   for later use, or actually booted into the FEP.
       16       16
       17       17                   'FEX' parameter - UBIN WORD that specifies which FEP to
       18       18                      boot or build boot image for.
       19       19
       20       20                   'BOOT_BUFFER' parameter - a VECTOR of a buffer that is to
       21       21                      hold the boot-image buffer.  If this parameter is not
       22       22                      supplied, KFF$FEBOOT allocates its own buffer and will
       23       23                      boot the FEP as soon as the image is built.  If this
       24       24                      parameter is supplied, the image will be built in the
       25       25                      buffer and the FEP will NOT be booted.
       26       26
       27       27                   'RET_ERROR_' parameter - a standard CP-6 error code, built
       28       28                      by VLP_ERRCODE.  This field dictates the disposition
       29       29                      of error conditions encountered in the course of KFF$FEBOOT.
       30       30                      If this parameter is supplied, no messages will be
       31       31                      displayed, but the error code will be passed back.
       32       32                      If this parameter is omitted, KFF$FEBOOT will attempt to
       33       33                      display a textual error message.
       34       34
       35       35                   'WDSUSED_' parameter - UBIN WORD that, if passed, will be
       36       36                      returned as a count of the L66 words required to hold
       37       37                      the boot-image.
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:2    
       38       38
       39       39                   The construction of certain types of boot images requires
       40       40                   access to certain control files.  If the caller intends to
       41       41                   call this routine repeatedly, or himself needs to access
       42       42                   the files, he should OPEN the files before calling this
       43       43                   routine.  If the files are not open on entry, KFF$FEBOOT
       44       44                   will open them and close them on exit.
       45       45
       46       46                   Control files are:
       47       47                        M$NETCON     :NETCON.:SYS
       48       48                        M$PROF       :PRO.:SYS
       49       49                        M$HLPF       :HLP.:SYS
       50       50
       51       51        */
       52       52        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:3    
       53       53        /**/
       54       54        /*  INCLUDE FILES  */
       55       55        /**/
       56       56        %INCLUDE B$OBJECT_C;
       57     3486        %INCLUDE CP_6;
       58     9045        %INCLUDE CP_6_SUBS;
       59     9585        %INCLUDE B_ERRORS_C;
       60    10712        %INCLUDE B_STRINGS_C;
       61    10841        %INCLUDE GI_DATA_M;
       62    10869        %INCLUDE GJ_MSG_M;
       63    11182        %INCLUDE GI_BOOT_C;
       64    11293        %INCLUDE KL_AFCN_C;
       65    11394        %INCLUDE KL_CONFIG_M;
       66    12156        %INCLUDE KL_CONTROL_C;
       67    12536        %INCLUDE KL_MACRO_C;
       68    15888        %INCLUDE KL_SUPER_C;
       69    18790        %INCLUDE B$JIT;
       70    19393        %INCLUDE B_SEGIDS_C;
       71    19932        %INCLUDE KI_SUBS_C;
       72    20068        %INCLUDE KS_SUBS_C;
       73    20311        %INCLUDE GM_VIRTUAL_E;
       74    20521        /**/
       75    20522        /*  PARAMETERS  */
       76    20523        /**/
       77    20524    1   DCL FEX UBIN;
       78    20525    1   DCL HOSTNODE UBIN;
       79    20526    1   DCL HOSTNAME CHAR(8);
       80    20527    1   DCL NODETYPE UBIN;
       81    20528    1   DCL BOOT_BUFFER VECTOR;
       82    20529        %VLP_ERRCODE (FPTN = RET_ERROR_,STCLASS = " ");
       83    20574    1   DCL WDSUSED_ UBIN WORD;
       84    20575        /**/
       85    20576        /* ENTRY DCLS */
       86    20577        /**/
       87    20578    1   DCL KFD$MLCPDUMP ENTRY(3) OPTIONAL;
       88    20579    1   DCL KFF$9TO8 ENTRY(3);
       89    20580    1   DCL KLH$SGSCAN ENTRY(9) ALTRET;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:4    
       90    20581        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:5    
       91    20582        /**/
       92    20583        /*  DCBS  */
       93    20584        /**/
       94    20585    1   DCL M$RU DCB;
       95    20586    1   DCL M$NETCON DCB;
       96    20587    1   DCL M$PROF DCB;
       97    20588    1   DCL M$HLPF DCB;
       98    20589    1   DCL M$HANDLER DCB;
       99    20590        /**/
      100    20591    1   DCL B$JIT$ PTR SYMREF;
      101    20592        %RU_FLAVORS;
      102    20598        %FPT_GDS (SEGSIZE=1024,RESULTS=DATASEG);
      103    20614        %FPT_FDS (SEGSIZE=262143,RESULTS=DATASEG);
      104    20629    1   DCL DATASEG VECTOR STATIC;
      105    20630    1   DCL 1 SAVE_INFO(0:KI_FEMAX#) STATIC ALIGNED,
      106    20631    1         2 FEX SBIN INIT(-1*0),
      107    20632    1         2 DATASEG VECTOR INIT(VECTOR(NIL)*0),
      108    20633    1         2 DFNAME,
      109    20634    1           3 L UBIN BYTE UNAL INIT(0*0),
      110    20635    1           3 C CHAR(31) INIT(' '*0);
      111    20636        %FPT_FECTL (FPTN=FPT_FEBOOT,RESULTS=BOOTRESULT,STCLASS="STATIC SYMDEF");
      112    20651        %FPT_MONINFO (STCLASS=CONSTANT,MONINFO=VLR_MONINFO,SITEINFO=VLR_SITEINFO);
      113    20666        %VLR_MONINFO;
      114    20684        %VLR_SITEINFO;
      115    20703        %FPT_NODEINFO (NODEINFO=VLR_NODEINFO);
      116    20715        %VLR_NODEINFO;
      117    20730    1   DCL BOOTRESULT(0:1) UBIN STATIC;
      118    20731        %FPT_OPEN (FPTN=OPEN_GOODIES,           /* DCB will get stuffed later         */
      119    20732                   ACCT=SYSACCT,
      120    20733                   FUN=IN,
      121    20734                   ORG=KEYED,
      122    20735                   ASN=FILE,
      123    20736                   SHARE=ALL,
      124    20737                   ACS=DIRECT,
      125    20738                   STCLASS=STATIC);
      126    20847        %FPT_CLOSE (FPTN=CLOSE_GOODIES,         /* DCB will get stuffed later         */
      127    20848                    DISP=SAVE,
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:6    
      128    20849                    STCLASS=STATIC);
      129    20891        %FPT_READ (FPTN=READ_NETCON,
      130    20892                   KEYS=YES,
      131    20893                   DCB=M$NETCON);
      132    20932        %FPT_READ (FPTN=READ_PRO,
      133    20933                   DCB=M$PROF,
      134    20934                   KEYS=YES);
      135    20973        %FPT_READ (FPTN=READ_HLP,
      136    20974                   DCB=M$HLPF,
      137    20975                   KEYS=YES);
      138    21014        %FPT_OPEN (FPTN=FPT_OPNRU,DCB=M$RU,
      139    21015                   FUN=IN,SHARE=IN,
      140    21016                   NAME=VLP_NAME,ACCT=VLP_ACCT,PASS=VLP_PASS,SN=VLP_SN);
      141    21125        %FPT_CLOSE (FPTN=CLOSE_RU,
      142    21126                    DCB=M$RU,
      143    21127                    DISP=SAVE);
      144    21169        %FPT_FID (FPTN=FPT_FID,
      145    21170                  NAME=VLP_NAME,ACCT=VLP_ACCT,PASS=VLP_PASS,SN=VLP_SN,
      146    21171                  RES=FPT_OPNRU.V.RES#,ASN=FPT_OPNRU.V.ASN#,
      147    21172                  RESULTS=VLR_FID);
      148    21195        %VLR_FID;
      149    21214        %VLP_NAME;
      150    21241        %VLP_ACCT;
      151    21254        %VLP_PASS;
      152    21267        %VLP_SN;
      153    21280        %VLP_NAME (FPTN=NETCONNAME,
      154    21281                   NAME=':NETCON',
      155    21282                   STCLASS=CONSTANT);
      156    21309        %VLP_NAME (FPTN=HLPNAME,
      157    21310                   NAME=':HLP',
      158    21311                   STCLASS=CONSTANT);
      159    21338        %VLP_NAME (FPTN=PRONAME,
      160    21339                   NAME=':PRO',
      161    21340                   STCLASS=CONSTANT);
      162    21367        %VLP_ACCT (FPTN=SYSACCT,ACCT=':SYS');
      163    21380        %FPT_WAIT (UNITS=11);
      164    21394        %FPT_OPEN (FPTN=FPT_STARTHANDLER,DCB=M$HANDLER,FUN=CREATE,NAME=HAND_NAME,ACCT=
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:7    
             21394            HAND_ACCT,
      165    21395                   ASN=DEVICE,RES='FE',ORG=HANDLER,FPRG=VLP_FPRG);
      166    21504        %VLP_ACCT (FPTN=HAND_ACCT,ACCT='       ');
      167    21517        %VLP_NAME (FPTN=HAND_NAME,NAME='            ');
      168    21544        %VLP_FPRG (FPTN=VLP_FPRG);
      169    21565        %FPT_CLOSE (FPTN=FPT_CLOSEHANDLER,DCB=M$HANDLER,DISP=SAVE);
      170    21607    1   DCL M$DO DCB;
      171    21608    1   DCL B$TCB$ PTR SYMREF;
      172    21609        %B$TCB;
      173    21612        %B$ALT;
      174    21620        %F$DCB;
      175    21677    1   DCL HEADBUF(0:49) UBIN STATIC INIT(0*0);
      176    21678    1   DCL HD$ PTR STATIC INIT(ADDR(HEADBUF));
      177    21679        %VLP_ERRCODE (FPTN = RET_ERROR,STCLASS = STATIC);
      178    21724        %B$HEAD (NAME=B$HEAD,STCLASS="BASED(HD$)");
      179    21924        /**/
      180    21925    1   DCL P$ PTR;
      181    21926    1   DCL SETFP$ PTR;
      182    21927    1   DCL PARAM$ PTR;
      183    21928    1   DCL CONTROL$ PTR;
      184    21929    1   DCL SECT$ PTR;
      185    21930    1   DCL SECTSIZE UBIN;
      186    21931    1   DCL NUMSECTS UBIN;
      187    21932
      188    21933    1   DCL IN$ PTR;
      189    21934    1   DCL OUT$ PTR;
      190    21935    1   DCL IPARAM$ PTR;
      191    21936    1   DCL INDX UBIN;
      192    21937    1   DCL OFFSET UBIN;
      193    21938    1   DCL ARRAY_WDSZ UBIN;
      194    21939
      195    21940    1   DCL B$PARAMI(0:0) UBIN HALF BASED UNAL;
      196    21941    1   DCL B$BYTE UBIN BYTE BASED;
      197    21942    1   DCL B$HALF UBIN(18) BASED;
      198    21943    1   DCL B$WORD UBIN WORD BASED;
      199    21944
      200    21945    1   DCL TBLOFFSET UBIN;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:8    
      201    21946    1   DCL DATAOFFSET UBIN;
      202    21947    1   DCL PROCOFFSET UBIN;
      203    21948    1   DCL ROSOFFSET UBIN;
      204    21949    1   DCL LIBOFFSET UBIN;
      205    21950    1   DCL PARAMOFFSET UBIN;
      206    21951    1   DCL PSEUDO$ PTR;
      207    21952    1   DCL START UBIN WORD;
      208    21953    1   DCL I SBIN;
      209    21954    1   DCL J UBIN;
      210    21955    1   DCL K SBIN;
      211    21956    1   DCL OFFSET_SIZE UBIN WORD;
      212    21957    1   DCL SKP_HNDLR UBIN;
      213    21958    1   DCL SKP_HNDLR2 UBIN;
      214    21959    1   DCL NHANDLERS UBIN WORD;      /* number of handlers to be booted with fep.  */
      215    21960    1   DCL NHNDLRS_DFR UBIN WORD; /* number of handlers started after fep is running */
      216    21961    1   DCL WDSUSED SBIN WORD;
      217    21962    1   DCL OFFSET$ PTR;
      218    21963    1   DCL NEXT$ PTR;
      219    21964    1   DCL BEGIN$ PTR;
      220    21965    1   DCL SVNEXT$ PTR;
      221    21966    1   DCL VDK UBIN WORD;
      222    21967    1   DCL VPK UBIN WORD;
      223    21968    1   DCL ROK UBIN WORD;
      224    21969    1   DCL TEMP SBIN;
      225    21970    1   DCL SAVEX UBIN;
      226    21971    1   DCL CLOSE_M$NETCON BIT(1);
      227    21972    1   DCL CLOSE_M$PROF BIT(1);
      228    21973    1   DCL CLOSE_M$HLPF BIT(1);
      229    21974    1   DCL WE_PRINT_ERRORS BIT(1);
      230    21975    1   DCL BUFFER_PASSED BIT(1);
      231    21976    1   DCL LIBX UBIN;
      232    21977    1   DCL NLIBS UBIN;
      233    21978    1   DCL LIB_PROCSIZ UBIN;
      234    21979    1   DCL LIB_DATASIZ UBIN;
      235    21980    1   DCL 1 LIB_TBL(0:9),
      236    21981    1         2 NAME CHAR(31) UNAL,
      237    21982    1         2 PROCOFFSET UBIN WALIGNED,
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:9    
      238    21983    1         2 DATAOFFSET UBIN WALIGNED,
      239    21984    1         2 PROCSIZE UBIN WORD WALIGNED,
      240    21985    1         2 DATASIZE UBIN WORD WALIGNED;
      241    21986    1   DCL 1 DFBASE BASED CALIGNED,
      242    21987    1         2 L UBIN BYTE UNAL,
      243    21988    1         2 C CHAR(31);
      244    21989        /**/
      245    21990    1   DCL ONEWORD UBIN BASED;
      246    21991        %GI$OFFSETS (FPTN=GI$OFFSETS,STCLASS="BASED(OFFSET$)",SYSTEM=CP6);
      247    21996        %GJ_SETFP_MSG (FPTN=GI$SETFP,
      248    21997                       BOOT=YES,
      249    21998                       STCLASS="BASED(SETFP$)");
      250    22162        %GI$PARAMS (STCLASS="BASED(PARAM$)",SYSTEM=CP6,NUM=GI_BOOT_HI);
      251    22165        %GI$PARAMS (FPTN=GI$CONTROL,STCLASS="BASED(CONTROL$)",SYSTEM=CP6,NUM=GI_CNTL_BOOTHI)
             22165            ;
      252    22168        %GI$PSEUDOS (FPTN=GI$PSEUDO,STCLASS="BASED(PSEUDO$)",SYSTEM=CP6,NUM=7);
      253    22172        %GI$SECTION (FPTN=TEMP_SECTION,STCLASS=STATIC,NUM=30,SYSTEM=CP6);
      254    22175        %GI$SECTION (FPTN=GI$SECTION,STCLASS="BASED(SECT$)",NUM=30,SYSTEM=CP6);
      255    22178        /**/
      256    22179
      257    22180        %KL_CONTROL_INIT (FPTN=KL$CONTROL_INIT,NUM_FIXED=%KL_FIXED_HI,NUM_INDXD = 4, STCLASS
             22180            ="BASED(PARAM$)",LAST=NO);
      258    22305    1           2 BLOCK(0:15) UBIN(18) UNAL,
      259    22306    1             2 UNBLOCK(0:15) UBIN(18) UNAL,
      260    22307    1             2 USRPARM1(0:7) UBIN(18) UNAL,
      261    22308    1             2 USRPARM2(0:7) UBIN(18) UNAL;
      262    22309
      263    22310        %KL_CONTROL_INIT (FPTN=KL$$CONTROL_INIT,NUM_FIXED=%KL_FIXED_HI,STCLASS=BASED);
             22310            /*fixed portion only */
      264    22435
      265    22436        %KL$FEPBOOT (NAME=KL_FEPBOOT,STCLASS=STATIC,NUM=GI_BOOT_HI);
      266    22461        %KL$FEPHNDLR (NAME=KL_FEPHNDLR,STCLASS=STATIC,NUM=9);
      267    22491
      268    22492        %KL$HNDLR (NAME=KL_HNDLR,NUM=%KL_FIXED_HI,NUMI=4,STCLASS=STATIC,LAST=NO);
             22492            /* buffer for the largest */
      269    22555    1         2 BLOCK(0:15) UBIN(18) UNAL,
      270    22556    1         2 UNBLOCK(0:15) UBIN(18) UNAL,
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:10   
      271    22557    1         2 USRPARM1(0:7) UBIN(18) UNAL,
      272    22558    1         2 USRPARM2(0:7) UBIN(18) UNAL;
      273    22559
      274    22560        %KL$HNDLR (NAME=KL$HNDLR,NUM=%KL_FIXED_HI,STCLASS=BASED); /*fixed portion only */
      275    22623
      276    22624        %KL$FEPBOOT_KEY (NAME=KEY_FEPBOOT,STCLASS=STATIC);
      277    22642        %KL$FEPHNDLR_KEY (NAME=KEY_FEPHNDLR,STCLASS=STATIC);
      278    22660        %KL$HNDLR_KEY (NAME=KEY_HNDLR,STCLASS=STATIC);
      279    22679        %KL$PSEUDO (NAME=KL_PSEUDO,STCLASS=STATIC,NUM=7);
      280    22723        %KL$PSEUDO_KEY (NAME=KEY_PSEUDO,STCLASS=STATIC);
      281    22741        %KL$FEPCTL (NAME=KL_FEPCTL,STCLASS=STATIC,NUM=GI_CNTL_BOOTHI);
      282    22761        %KL$FEPCTL_KEY (NAME=KEY_FEPCTL,STCLASS=STATIC);
      283    22779        /**/
      284    22780        %KL_LNK (NAME=KL$LNK,STCLASS=BASED);
      285    23004        %KL_CHNRSP (FPTN=KL$CHNRSP,MSGSIZE=1,STCLASS=BASED,ALGN=CALIGNED);
      286    23224        %KL_CHNRSP (FPTN=KL_CHNRSP,MSGSIZE=1);
      287    23444        /**/
      288    23445        %KL$NETWORK (NAME=KL_NETWORK,NUM=255,STCLASS=AUTO);
      289    23472        %KL$NETWORK_KEY (NAME=KL_NETWORK_KEY,STCLASS=CONSTANT);
      290    23489        /* A macro to convert host to front end */
      291    23490        %MACRO CNVRT9TO8 (S=DUM,D=DUM,SIZE=4);
      292    23491                TEMP=S;
      293    23492                CALL KFF$9TO8(TEMP,D,SIZE);
      294    23493
      295    23494        %MEND;
      296    23495        %SUB FOREVER="WHILE('1'B)";
      297    23496        %SUB NEVER="WHILE('0'B)";
      298    23497        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
      299    23498        %EQU MON = 1;
      300    23499        %EQU RU = 2;
      301    23500        %EQU LIB = 3;
      302    23501        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:11   
      303    23502    2           CALL GET_SAVEX(FEX,SAVEX) WHENALTRETURN DO;
      304    23503                                                /*PUT IN AN ERROR*/
      305    23504    2              ALTRETURN;
      306    23505    2              END;
      307    23506                                                /*  Reconcile parameters  */
      308    23507    1           IF ADDR(RET_ERROR_) = ADDR(NIL) THEN
      309    23508    1              WE_PRINT_ERRORS = '1'B;
      310    23509    1           ELSE
      311    23510    1              WE_PRINT_ERRORS = '0'B;
      312    23511    1           IF ADDR(BOOT_BUFFER) = ADDR(NIL) THEN
      313    23512    1              BUFFER_PASSED = '0'B;
      314    23513    1           ELSE
      315    23514    1              BUFFER_PASSED = '1'B;
      316    23515
      317    23516    1           CLOSE_M$NETCON = '0'B;
      318    23517    2           IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD# THEN DO;
      319    23518    2              CLOSE_M$NETCON = '1'B;
      320    23519    2              OPEN_GOODIES.V.DCB# = DCBNUM(M$NETCON);
      321    23520    2              OPEN_GOODIES.NAME_ = VECTOR(NETCONNAME);
      322    23521    2              CALL M$OPEN(OPEN_GOODIES) ALTRET(ALT);
      323    23522    2              END;                         /* IF */
      324    23523
      325    23524    1           CLOSE_M$PROF = '0'B;
      326    23525    2           IF NOT DCBADDR(DCBNUM(M$PROF)) -> F$DCB.FCD# THEN DO;
      327    23526    2              CLOSE_M$PROF = '1'B;
      328    23527    2              OPEN_GOODIES.V.DCB# = DCBNUM(M$PROF);
      329    23528    2              OPEN_GOODIES.NAME_ = VECTOR(PRONAME);
      330    23529    2              CALL M$OPEN (OPEN_GOODIES) ALTRET(ALT);
      331    23530    2              END;
      332    23531
      333    23532    1           CLOSE_M$HLPF = '0'B;
      334    23533    2           IF NOT DCBADDR(DCBNUM(M$HLPF)) -> F$DCB.FCD# THEN DO;
      335    23534    2              CLOSE_M$HLPF = '1'B;
      336    23535    2              OPEN_GOODIES.V.DCB# = DCBNUM(M$HLPF);
      337    23536    2              OPEN_GOODIES.NAME_ = VECTOR(HLPNAME);
      338    23537    2              CALL M$OPEN (OPEN_GOODIES) ALTRET(ALT);
      339    23538    2              END;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:12   
      340    23539
      341    23540                                                /*  Get a buffer to hold boot image  */
      342    23541    2           IF BUFFER_PASSED THEN DO;
      343    23542    2              DATASEG = BOOT_BUFFER;
      344    23543    2              END;
      345    23544    2           ELSE DO;
      346    23545    2              DATASEG=VECTOR(NIL);
      347    23546    2              END;
      348    23547    1           BEGIN$ = ADDR(NIL);
      349    23548    2           CALL GETSEG(VBASE(DATASEG),2048) WHENALTRETURN DO;
      350    23549    2              ALTRETURN;
      351    23550    2              END;
      352    23551
      353    23552    1           IF BUFFER_PASSED
      354    23553    1           THEN
      355    23554    1              BEGIN$ = VBASE(DATASEG);
      356    23555    1           ELSE
      357    23556    1              BEGIN$ = PINCRW(VBASE(DATASEG),1);
      358    23557    1           KEY_FEPBOOT.NODE = FEX;
      359    23558    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPBOOT);
      360    23559    1           READ_NETCON.BUF_ = VECTOR(KL_FEPBOOT);
      361    23560    1           CALL M$READ(READ_NETCON) ALTRET(ALT);
      362    23561    1           FPT_FID.TEXTFID_ = VECTOR(KL_FEPBOOT.BOOTFID);
      363    23562    1           CALL M$FID(FPT_FID) ALTRET(ALT);
      364    23563    1           CALL M$OPEN(FPT_OPNRU) ALTRET(ALT);
      365    23564    1           CALL READ_RU(BEGIN$,%MON) ALTRET(ALT);
      366    23565    1           P$=PINCRC(BEGIN$,%BITBIN('104'X)*2);
      367    23566    1           CALL STORVAL(P$->ONEWORD,WDSUSED,4);
      368    23567
      369    23568    1           KEY_HNDLR.NODE = FEX;
      370    23569    1           KEY_FEPHNDLR.NODE = FEX;
      371    23570    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPHNDLR);
      372    23571    1           READ_NETCON.BUF_ = VECTOR(KL_FEPHNDLR);
      373    23572    1           CALL M$READ(READ_NETCON) ALTRET(ALT);
      374    23573
      375    23574                                           /* Build GI$OFFSETS into the boot image */
      376    23575    1           OFFSET$=PINCRW(BEGIN$,WDSUSED);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:13   
      377    23576    1           NHANDLERS = 0;
      378    23577    2           DO J = 0 TO KL_FEPHNDLR.NHANDLERS - 1;
      379    23578    2              IF KL_FEPHNDLR.BOOTIME(J) = '1'B THEN
      380    23579    2                 NHANDLERS = NHANDLERS + 1;
      381    23580    2              END;
      382    23581    1           NHNDLRS_DFR = KL_FEPHNDLR.NHANDLERS - NHANDLERS;
      383    23582        /**/
      384    23583    1           OFFSET_SIZE = SIZEW(GI$OFFSETS) - SIZEW(GI$OFFSETS.HANDLER);
      385    23584    1           IF NHANDLERS > 0
      386    23585    1           THEN OFFSET_SIZE = OFFSET_SIZE + SIZEW(GI$OFFSETS.HANDLER) * NHANDLERS;
      387    23586    1           CALL GETSEG(OFFSET$,OFFSET_SIZE) ALTRET(ALT);
      388    23587    1           NEXT$ = PINCRW(OFFSET$,OFFSET_SIZE);
      389    23588    1           P$ = ADDR(GI$OFFSETS.NHANDLERS);
      390    23589    1           CALL STORVAL(P$->ONEWORD,NHANDLERS,4);
      391    23590    1           P$ = ADDR(GI$OFFSETS.FEX);
      392    23591    1           CALL STORVAL(P$->ONEWORD,FEX,4);
      393    23592    1           VLR_NODEINFO.NODENAME# = 'FEPNODE';
      394    23593    1           FPT_NODEINFO.V.NODENUM# = FEX;
      395    23594    1           CALL M$NODEINFO (FPT_NODEINFO)
      396    23595    2           WHENALTRETURN DO;
      397    23596    2              END;
      398    23597    1           GI$OFFSETS.NODENAME = VLR_NODEINFO.NODENAME#;
      399    23598    1           GI$OFFSETS.BOOTFID = KL_FEPBOOT.BOOTFID;
      400    23599    1           READ_NETCON.KEY_ = VECTOR(KL_NETWORK_KEY);
      401    23600    1           READ_NETCON.BUF_ = VECTOR(KL_NETWORK);
      402    23601    2           CALL M$READ(READ_NETCON) WHENRETURN DO;
      403    23602    2              IF KL_NETWORK.NODE# = 0 THEN
      404    23603    3              DO;
      405    23604        /*N* should err fact that no nodes exist */
      406    23605    3                 CALL M$MONINFO(FPT_MONINFO);
      407    23606    3                 HOSTNODE = VLR_MONINFO.NODE#;
      408    23607    3                 END;
      409    23608    3              ELSE DO;
      410    23609    3                 HOSTNAME = KL_NETWORK.NODE.CONTROL_NODE(FEX);
      411    23610    3                 IF HOSTNAME = ' ' THEN
      412    23611    4                 DO;
      413    23612    4                    CALL M$MONINFO(FPT_MONINFO);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:14   
      414    23613    4                    HOSTNODE = VLR_MONINFO.NODE#;
      415    23614    4                    END;
      416    23615    3                 ELSE
      417    23616    4                 DO;
      418    23617    4                    CALL CONV_NODENAME(HOSTNAME,HOSTNODE,NODETYPE) WHENALTRETURN
      419    23618    5                    DO;
      420    23619    5                       CALL M$MONINFO(FPT_MONINFO);
      421    23620    5                       HOSTNODE = VLR_MONINFO.NODE#;
      422    23621        /*N* err fact that conrol node does not exist */
      423    23622    5                       END;
      424    23623    4                    END;
      425    23624    3                 END;
      426    23625    2              END;
      427    23626    2           WHENALTRETURN DO;
      428    23627    2              CALL M$MONINFO(FPT_MONINFO);
      429    23628    2              HOSTNODE = VLR_MONINFO.NODE#;
      430    23629        /*N* should err fact that something is wrong with :netcon */
      431    23630    2              END;                         /* WHENALTRETURN */
      432    23631
      433    23632    1           P$ = ADDR(GI$OFFSETS.HOSTNODE);
      434    23633    1           CALL STORVAL(P$->ONEWORD,HOSTNODE,4);
      435    23634
      436    23635                                           /* Build GI$SECTION into the boot image */
      437    23636    1           SECT$ = NEXT$;
      438    23637    1           SECTSIZE = SIZEW(GI$SECTION.NUMSECTS) + SIZEW(GI$SECTION.SECT(0)) * NUMSECTS
             23637                    ;
      439    23638    1           CALL GETSEG(SECT$,SIZEW(GI$SECTION)); /* MORE THAN WE NEED */
      440    23639    1           NEXT$ = PINCRW(SECT$,SECTSIZE);
      441    23640    1           SECTSIZE = SECTSIZE * 2;        /* convert to L6 words */
      442    23641    1           P$ = ADDR(GI$OFFSETS.SECTSIZE);
      443    23642    1           CALL STORVAL(P$->ONEWORD,SECTSIZE,4);
      444    23643    1           TBLOFFSET = POFFW(SECT$,BEGIN$);
      445    23644    1           P$ = ADDR(GI$OFFSETS.SECTOFFSET);
      446    23645    1           CALL STORVAL(P$->ONEWORD,TBLOFFSET,4);
      447    23646    1           GI$SECTION = TEMP_SECTION;
      448    23647
      449    23648                                           /* Build the handlers into the boot image */
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:15   
      450    23649    1           NLIBS = 0;
      451    23650    1           LIB_TBL = '0'B;
      452    23651    1           SKP_HNDLR2 = 0;
      453    23652    2           DO J = 0 TO KL_FEPHNDLR.NHANDLERS - 1;
      454    23653    3   HNDLRS:    DO;
      455    23654    4                 IF KL_FEPHNDLR.BOOTIME(J) = '0'B THEN DO;
      456    23655    4                    SKP_HNDLR2 = SKP_HNDLR2 + 1;
      457    23656    4                    EXIT HNDLRS;
      458    23657    4                    END;
      459    23658    3                 KEY_HNDLR.HNDLR = KL_FEPHNDLR.HANDLER(J);
      460    23659    3                 READ_NETCON.KEY_ = VECTOR(KEY_HNDLR);
      461    23660    3                 READ_NETCON.BUF_ = VECTOR(KL_HNDLR);
      462    23661    3                 CALL M$READ(READ_NETCON) ALTRET(ALT);
      463    23662    3                 FPT_FID.TEXTFID_ = VECTOR(KL_HNDLR.HNDLRFID);
      464    23663    3                 CALL M$FID(FPT_FID) ALTRET(ALT);
      465    23664    3                 CALL M$OPEN(FPT_OPNRU) ALTRET(ALT);
      466    23665
      467    23666                                                /* build GI$SETFP into boot image */
      468    23667    3                 SETFP$ = NEXT$;
      469    23668    3                 TBLOFFSET = POFFW(SETFP$,BEGIN$);
      470    23669    3                 CALL GETSEG(SETFP$,SIZEW(GI$SETFP));
      471    23670    3                 NEXT$ = PINCRW(SETFP$,SIZEW(GI$SETFP));
      472    23671    3                 CALL READ_RU(NEXT$,%RU) ALTRET(ALT);
      473    23672    3                 NEXT$ = PINCRW(NEXT$,WDSUSED);
      474    23673    3                 GI$SETFP = '0'B;
      475    23674    3                 P$ = ADDR(GI$OFFSETS.HANDLER.TBLOFFSET(J-SKP_HNDLR2));
      476    23675    3                 CALL STORVAL(P$->ONEWORD,TBLOFFSET,4);
      477    23676    3                 P$ = ADDR(GI$SETFP.OFFSET_DATA);
      478    23677    3                 CALL STORVAL(P$->ONEWORD,DATAOFFSET,4);
      479    23678    3                 P$ = ADDR(GI$SETFP.OFFSET_PROC);
      480    23679    3                 CALL STORVAL(P$->ONEWORD,PROCOFFSET,4);
      481    23680    3                 P$ = ADDR(GI$SETFP.OFFSET_RO);
      482    23681    3                 CALL STORVAL(P$->ONEWORD,ROSOFFSET,4);
      483    23682    3                 GI$SETFP.PASS = VLP_PASS.PASS#;
      484    23683    3                 GI$SETFP.ACCT = VLP_ACCT.ACCT#;
      485    23684    3                 GI$SETFP.PSN = VLP_SN.SN#(0);
      486    23685    3                 GI$SETFP.NAME.L = VLP_NAME.L#;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:16   
      487    23686    3                 GI$SETFP.NAME.TEXT = KL_FEPHNDLR.HANDLER(J);
      488    23687    3                 GI$SETFP.FLAGS.DEBUG = '0'B;
      489    23688    3                 IF VLP_ACCT.ACCT# = ':SYS'
      490    23689    3                 THEN GI$SETFP.FLAGS.XEQ_ONLY = '1'B;
      491    23690    3                 CALL STORVAL(GI$SETFP.MODTIME,DCBADDR(DCBNUM(M$RU))->F$DCB.EXPIRE#,4);
      492    23691    3                 GI$SETFP.LIB_NAME = B$HEAD.LIBNAME;
      493    23692    3                 GI$SETFP.VERSION = B$HEAD.VERSION#;
      494    23693    3                 GI$SETFP.FLAGS.LAUTO = B$HEAD.LAUTO;
      495    23694    3                 GI$SETFP.FLAGS.PROCACC = B$HEAD.PROCACC;
      496    23695    3                 GI$SETFP.FLAGS.NOCHRPMEM = B$HEAD.NOCHGPMEM;
      497    23696    3                 GI$SETFP.FLAGS.S = B$HEAD.S;
      498    23697    3                 GI$SETFP.FLAGS.LIB = B$HEAD.LIB;
      499    23698                      %CNVRT9TO8(S="B$HEAD.START",D="GI$SETFP.START",SIZE=4);
      500    23702                      %CNVRT9TO8(S="B$HEAD.UDCBNUM",D="GI$SETFP.UDCBNUM",SIZE=2);
      501    23706                      %CNVRT9TO8(S="B$HEAD.DCBRES",D="GI$SETFP.DCBRES",SIZE=2);
      502    23710                      %CNVRT9TO8(S="B$HEAD.TCBSIZE",D="GI$SETFP.TCBSIZE",SIZE=2);
      503    23714                      %CNVRT9TO8(S="B$HEAD.VPPGS",D="GI$SETFP.VPPGS",SIZE=2);
      504    23718                      %CNVRT9TO8(S="B$HEAD.VDPGS",D="GI$SETFP.VDPGS",SIZE=2);
      505    23722                      %CNVRT9TO8(S="B$HEAD.ROSIZE",D="GI$SETFP.ROS_SZ",SIZE=2);
      506    23726                      %CNVRT9TO8(S="B$HEAD.RDATA",D="GI$SETFP.DATA_SZ",SIZE=4);
      507    23730                      %CNVRT9TO8(S="B$HEAD.RPROC",D="GI$SETFP.PROC_SZ",SIZE=4);
      508    23734                      %CNVRT9TO8(S="B$HEAD.BIAS",D="GI$SETFP.DATA_BIAS",SIZE=4);
      509    23738    3                 IF KL_FEPHNDLR.HANDLER(J) = 'NODEADMN'
      510    23739    4                 THEN DO;
      511    23740    4                    PARAM$ = NEXT$;
      512    23741    4                    PARAMOFFSET = POFFW(PARAM$,BEGIN$);
      513    23742    4                    CALL STORVAL(GI$SETFP.OFFSET_DS1,PARAMOFFSET,4);
      514    23743    4                    SVNEXT$ = NEXT$;
      515    23744
      516    23745        /*
      517    23746             The structure of the data segment is:
      518    23747
      519    23748             .A000   NHANDLES UBIN(32)
      520    23749             .A002   HANDLER1_CONTROL_OFFSET UBIN(32)
      521    23750             .A004   HANDLER2_CONTROL_OFFSET UBIN(32)
      522    23751               .
      523    23752               .
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:17   
      524    23753               .
      525    23754             .A000 + NHANDLERS*2 HANDLERn_CONTROL_OFFSET UBIN(32)
      526    23755             .A000 + NHANDLERS*2 + 2 OFFSET TO CONFIGURATION INFOMATIION.
      527    23756
      528    23757         */
      529    23758    4                    CALL GETSEG(PARAM$,NHANDLERS*(SIZEW(KL$CONTROL_INIT)+1)+2);
      530    23759    4                    CALL STORVAL(PARAM$->ONEWORD,NHANDLERS,4);
      531    23760    4                    PARAM$ = PINCRW(PARAM$,2+NHANDLERS);
      532    23761    4                    NEXT$ = PINCRW(NEXT$,NHANDLERS*(SIZEW(KL$CONTROL_INIT)+1)+2);
      533    23762    4                    CALL STORVAL(PINCRW(SVNEXT$,NHANDLERS+1)->ONEWORD,POFFC(NEXT$,
             23762                             SVNEXT$)/2,4);
      534    23763    4                    READ_NETCON.BUF_ = VECTOR (KL_HNDLR);
      535    23764    4                    READ_NETCON.KEY_ = VECTOR (KEY_HNDLR);
      536    23765
      537    23766        /* Read in each of the handler records and create a KL_CONTROL */
      538    23767    4                    SKP_HNDLR = 0;
      539    23768    5                    DO I = 0 TO KL_FEPHNDLR.NHANDLERS - 1;
      540    23769    6   HNDLR_SRCH:         DO;
      541    23770    7                          IF KL_FEPHNDLR.BOOTIME(I) = '0'B THEN DO;
      542    23771    7                             SKP_HNDLR = SKP_HNDLR + 1;
      543    23772    7                             EXIT HNDLR_SRCH;
      544    23773    7                             END;
      545    23774    6                          CALL STORVAL(PINCRW(SVNEXT$,1+I-SKP_HNDLR)->ONEWORD,POFFC(
             23774                                   PARAM$,SVNEXT$)/2,4);
      546    23775    6                          KEY_HNDLR.HNDLR = KL_FEPHNDLR.HANDLER(I);
      547    23776    6                          KL$CONTROL_INIT = '0'B;
      548    23777    6                          KL$CONTROL_INIT.CODE = IGA_CONTROL_INIT;
      549    23778    6                          KL$CONTROL_INIT.HANDLER = KEY_HNDLR.HNDLR;
      550    23779    6                          CALL M$READ (READ_NETCON)
      551    23780    7                          WHENRETURN DO;
      552    23781    7                             IF KL_HNDLR.NPARAMS ~= 0
      553    23782    8                             THEN DO;
      554    23783    8                                KL$CONTROL_INIT.TYPE = 1;
      555    23784    8                                KL$CONTROL_INIT.NUM_FPARAM = KL_HNDLR.NPARAMS;
      556    23785    8                                KL$CONTROL_INIT.NUM_IPARAM = KL_HNDLR.NPARAMI;
      557    23786    9                                DO K = 0 TO KL_HNDLR.NPARAMS - 1;
      558    23787    9                                   IF K = %KL_HNDLRPARM_RES
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:18   
      559    23788    9                                   THEN
      560    23789    9                                      KL$CONTROL_INIT.FPARAM(K) = KL_HNDLR.PARAMS(K);
      561    23790   10                                   ELSE DO;
      562    23791                                           %CNVRT9TO8(S="KL_HNDLR.PARAMS(K)",
      563    23792                                           D="KL$CONTROL_INIT.FPARAM(K)",
      564    23793                                           SIZE=2);
      565    23797   10                                      END;
      566    23798    9                                   END;
      567    23799
      568    23800    8                                IF KL_HNDLR.NPARAMI ~= 0
      569    23801    9                                THEN DO;
      570    23802    9                                   IPARAM$ = ADDR(KL$CONTROL_INIT.FPARAM(0));
      571    23803    9                                   IPARAM$ = PINCRC(IPARAM$,KL_HNDLR.NPARAMS*2);
      572    23804    9                                   OUT$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM(0
             23804                                            ))*KL_HNDLR.NPARAMI);
      573    23805
      574    23806   10                                   DO INDX=0 TO KL_HNDLR.NPARAMI - 1;
      575    23807   10                                      OFFSET = POFFC(OUT$,PARAM$);
      576    23808   10                                      IN$ = PINCRW(ADDR(KL_HNDLR),
      577    23809   10                                        KL_HNDLR.IPARAM.OFFSET(INDX));
      578    23810
      579    23811   10                                      ARRAY_WDSZ = (((KL_HNDLR.IPARAM.ARRAY_SZ(INDX) +
             23811                                               1) * 2)+ 3)/4;
      580    23812
      581    23813                                           %CNVRT9TO8(S="KL_HNDLR.IPARAM.ARRAY_SZ(INDX)",
      582    23814                                           D="IPARAM$->B$BYTE",
      583    23815                                           SIZE=1);
      584    23819   10                                      IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.
             23819                                               IPARAM.ARRAY_SZ(0)));
      585    23820
      586    23821                                           %CNVRT9TO8(S="KL_HNDLR.IPARAM.PARAM_SZ(INDX)",
      587    23822                                           D="IPARAM$->B$BYTE",
      588    23823                                           SIZE=1);
      589    23827   10                                      IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.
             23827                                               IPARAM.PARAM_SZ(0)));
      590    23828                                           %CNVRT9TO8(S="OFFSET",
      591    23829                                           D="IPARAM$->B$HALF",
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:19   
      592    23830                                           SIZE=2);
      593    23834   10                                      IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.
             23834                                               IPARAM.OFFSET(0)));
      594    23835   11                                      DO K=0 TO KL_HNDLR.IPARAM.ARRAY_SZ(INDX);
      595    23836                                              %CNVRT9TO8(S="IN$->B$PARAMI(K)",
      596    23837                                              D="OUT$->B$PARAMI(K)",
      597    23838                                              SIZE=2);
      598    23842   11                                         END;
      599    23843
      600    23844   10                                      OUT$ = PINCRW(OUT$,ARRAY_WDSZ);
      601    23845
      602    23846   10                                      END /*do INDX=0 to .NPARAMI-1*/;
      603    23847    9                                   END/* do if NPARAMI ~= 0*/;
      604    23848    8                                END/* do if NPARAMS ~= 0*/;
      605    23849    7                             END /* whenreturn do*/;
      606    23850    6                          PARAM$ = PINCRW(PARAM$,SIZEW(KL$CONTROL_INIT));
      607    23851    6                          END;             /* hndlr_srch */
      608    23852    5                       END/*do to NHANDLERS -1 */;
      609    23853    4                    P$=NEXT$;
      610    23854    4                    NEXT$=PINCRC(P$,2);
      611    23855    5                    CALL CONFIG_LINK(RET_ERROR) WHENALTRETURN DO;
      612    23856    5                       NEXT$=PINCRC(P$,2);
      613    23857    5                       CALL KFF$9TO8((SIZEC(KL$LNK)+SIZEC(KL$CHNRSP)-1)/2,NEXT$->
             23857                                ONEWORD,2);
      614    23858    5                       NEXT$->KL$LNK.BLKHDR.BLKTYP=%KLTY_LINK#;
      615    23859    5                       NEXT$->KL$LNK.BLKHDR.LEV=%TERMINAL_ID_LEV_CHAN#;
      616    23860    5                       NEXT$=PINCRC(NEXT$,2);
      617    23861    5                       NEXT$->KL$LNK='0'B;
      618    23862    5                       CALL KFF$9TO8(SIZEC(KL$LNK)+SIZEC(KL$CHNRSP)-1,NEXT$->KL$LNK.
             23862                                BLKHDR.LEN,2);
      619    23863    5                       NEXT$=PINCRC(NEXT$,SIZEC(KL$LNK));
      620    23864    5                       NEXT$->KL$CHNRSP=KL_CHNRSP;
      621    23865    5                       NEXT$=PINCRC(NEXT$,SIZEC(KL$CHNRSP)-1);
      622    23866    5                       END;
      623    23867    4                    TEMP=POFFC(NEXT$,P$)/2-1;
      624    23868    4                    CALL KFF$9TO8(TEMP,P$->ONEWORD,2);
      625    23869    4                    CALL ALIGNPTR (NEXT$);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:20   
      626    23870    4                    CALL STORVAL(GI$SETFP.DS1_SZ,POFFW(NEXT$,SVNEXT$)*2,4);
      627    23871    4                    END;
      628    23872
      629    23873                                           /* Read in the library if one was spec'd */
      630    23874    3                 PROCOFFSET = 0;
      631    23875    3                 DATAOFFSET = 0;
      632    23876    3                 LIB_PROCSIZ = 0;
      633    23877    3                 LIB_DATASIZ = 0;
      634    23878    4                 IF B$HEAD.LIBNAME.TXT ~= ' ' THEN DO;
      635    23879    5                    DO LIBX = 0 TO NLIBS - 1;
      636    23880    6                       IF B$HEAD.LIBNAME.TXT = LIB_TBL.NAME(LIBX) THEN DO;
      637    23881    6                          PROCOFFSET = LIB_TBL.PROCOFFSET(LIBX);
      638    23882    6                          DATAOFFSET = LIB_TBL.DATAOFFSET(LIBX);
      639    23883    6                          LIB_PROCSIZ = LIB_TBL.PROCSIZE(LIBX);
      640    23884    6                          LIB_DATASIZ = LIB_TBL.DATASIZE(LIBX);
      641    23885    6                          GOTO FOUND_LIB;
      642    23886    6                          END;             /* IF */
      643    23887    5                       END;                /* DO LIBX */
      644    23888    4                    FPT_FID.TEXTFID_ = VECTOR(B$HEAD.LIBNAME.TXT);
      645    23889    4                    CALL M$FID(FPT_FID) ALTRET(ALT);
      646    23890    4                    VLP_ACCT.ACCT# = KL_FEPHNDLR.DEFLIBACCT;
      647    23891    4                    CALL M$OPEN(FPT_OPNRU) ALTRET(ALT);
      648    23892    4                    CALL READ_RU(NEXT$,%LIB) ALTRET(ALT);
      649    23893                                      /* B$HEAD is now from the library just read */
      650    23894    4                    LIB_PROCSIZ = B$HEAD.RPROC;
      651    23895    4                    LIB_DATASIZ = B$HEAD.RDATA;
      652    23896    4                    NEXT$ = PINCRW(NEXT$,WDSUSED);
      653    23897    4                    LIB_TBL.NAME(NLIBS) = GI$SETFP.LIB_NAME.TEXT;
      654    23898    4                    LIB_TBL.PROCOFFSET(NLIBS) = PROCOFFSET;
      655    23899    4                    LIB_TBL.DATAOFFSET(NLIBS) = DATAOFFSET;
      656    23900    4                    LIB_TBL.PROCSIZE(NLIBS) = LIB_PROCSIZ;
      657    23901    4                    LIB_TBL.DATASIZE(NLIBS) = LIB_DATASIZ;
      658    23902    4                    NLIBS = NLIBS + 1;
      659    23903    4                    END;                   /* IF LIBNAME = ' ' */
      660    23904    3   FOUND_LIB:    ;
      661    23905                      %CNVRT9TO8(S="PROCOFFSET",D="GI$SETFP.OFFSET_LIB_PROC",SIZE=4);
      662    23909                      %CNVRT9TO8(S="DATAOFFSET",D="GI$SETFP.OFFSET_LIB_DATA",SIZE=4);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:21   
      663    23913                      %CNVRT9TO8(S="LIB_PROCSIZ",D="GI$SETFP.LIB_PROC_SZ",SIZE=4);
      664    23917                      %CNVRT9TO8(S="LIB_DATASIZ",D="GI$SETFP.LIB_DATA_SZ",SIZE=4);
      665    23921    3                 END;                      /* hndlrs */
      666    23922    2              END;                         /* DO J */
      667    23923
      668    23924                                           /* Build GI$PARAMS into the boot image */
      669    23925    1           CALL M$MONINFO (FPT_MONINFO);
      670    23926    1           PARAM$ = NEXT$;
      671    23927    1           GI$OFFSETS.PARAM# = %GI_BOOT_HI;
      672    23928    1           PARAMOFFSET = POFFW(PARAM$,BEGIN$);
      673    23929    1           CALL STORVAL(GI$OFFSETS.PARAMOFFSET,PARAMOFFSET,4);
      674    23930    1           CALL GETSEG(PARAM$,SIZEW(GI$PARAMS));
      675    23931    1           NEXT$ = PINCRW(NEXT$,SIZEW(GI$PARAMS));
      676    23932    1           KL_FEPBOOT.BOOTPARAMS(%GI_BOOT_NODES) = VLR_MONINFO.NUM_NODES;
      677    23933    1           IF VLR_SITEINFO.CPU_TYPE# = %DPS8000 THEN
      678    23934    1              KL_FEPBOOT.BOOTPARAMS(%GI_BOOT_DPS8000FLG) = 1;
      679    23935    1           ELSE
      680    23936    1              KL_FEPBOOT.BOOTPARAMS(%GI_BOOT_DPS8000FLG) = 0;
      681    23937    2           DO I = 0 TO %GI_BOOT_HI;
      682    23938    2              CALL STORVAL(GI$PARAMS.PARAMS(I),KL_FEPBOOT.BOOTPARAMS(I),4);
      683    23939    2              END;                         /* DO I */
      684    23940
      685    23941                                 /* Build the control parameters into the boot image */
      686    23942    1           CONTROL$ = NEXT$;
      687    23943    1           GI$OFFSETS.CNTL# = 0;
      688    23944    1           PARAMOFFSET = POFFW(CONTROL$,BEGIN$);
      689    23945    1           CALL STORVAL(GI$OFFSETS.CNTLOFFSET,PARAMOFFSET,4);
      690    23946    1           KEY_FEPCTL.NODE = FEX;
      691    23947    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPCTL);
      692    23948    1           READ_NETCON.BUF_ = VECTOR(KL_FEPCTL);
      693    23949    1           CALL M$READ(READ_NETCON) ALTRET(NO_CONTROL);
      694    23950    1           CALL GETSEG(CONTROL$,SIZEW(GI$CONTROL));
      695    23951    1           NEXT$ = PINCRW(NEXT$,SIZEW(GI$CONTROL));
      696    23952    2           DO I = 0 TO %GI_CNTL_BOOTHI;
      697    23953    2              CALL STORVAL(GI$CONTROL.PARAMS(I),KL_FEPCTL.PARAMS(I),4);
      698    23954    2              END;                         /* DO I */
      699    23955
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:22   
      700    23956    1           GI$OFFSETS.CNTL# = %GI_CNTL_BOOTHI;
      701    23957    1   NO_CONTROL: ;
      702    23958                                 /* Build the pseudo definitions into the boot image */
      703    23959    1           PSEUDO$ = NEXT$;
      704    23960    1           GI$OFFSETS.PSEUDO# = 0;
      705    23961    1           PARAMOFFSET = POFFW(PSEUDO$,BEGIN$);
      706    23962    1           CALL STORVAL(GI$OFFSETS.PSEUDOOFFSET,PARAMOFFSET,4);
      707    23963    1           KEY_PSEUDO.NODE = FEX;
      708    23964    1           READ_NETCON.KEY_ = VECTOR(KEY_PSEUDO);
      709    23965    1           READ_NETCON.BUF_ = VECTOR(KL_PSEUDO);
      710    23966    1           CALL M$READ(READ_NETCON) ALTRET(NO_PSEUDOS);
      711    23967    1           CALL GETSEG(NEXT$,KL_PSEUDO.PSEUDO#*SIZEW(GI$PSEUDO));
      712    23968    1           GI$OFFSETS.PSEUDO# = KL_PSEUDO.PSEUDO#;
      713    23969    2           DO I = 0 TO KL_PSEUDO.PSEUDO# - 1;
      714    23970    2              GI$PSEUDO.NAME(I) = KL_PSEUDO.PSEUDO.NAME(I);
      715    23971    2              CALL STORVAL(GI$PSEUDO.MAX_SYS(I),KL_PSEUDO.PSEUDO.MAX_SYS(I),4);
      716    23972    2              CALL STORVAL(GI$PSEUDO.MAX_USR(I),KL_PSEUDO.PSEUDO.MAX_USR(I),4);
      717    23973    2              CALL STORVAL(GI$PSEUDO.MAX_CG(I),KL_PSEUDO.PSEUDO.MAX_CG(I),4);
      718    23974    2              CALL STORVAL(GI$PSEUDO.MAX_HND(I),KL_PSEUDO.PSEUDO.MAX_HAND(I),4);
      719    23975    2              CALL STORVAL(GI$PSEUDO.MAX_GHST(I),KL_PSEUDO.PSEUDO.MAX_GHST(I),4);
      720    23976    2              END;                         /* DO I */
      721    23977    1           NEXT$ = PINCRW(NEXT$,KL_PSEUDO.PSEUDO#*SIZEW(GI$PSEUDO));
      722    23978    1   NO_PSEUDOS:;
      723    23979
      724    23980                                      /* Buffer now contains complete boot image. */
      725    23981    2           IF BUFFER_PASSED THEN DO;
      726    23982    2              BOOT_BUFFER=DATASEG;
      727    23983    2              WDSUSED_=POFFW(NEXT$,BEGIN$);
      728    23984    2              END;
      729    23985    2           ELSE DO;
      730    23986    2              SAVE_INFO.DATASEG(SAVEX)=DATASEG;
      731    23987    3              IF SAVE_INFO.DFNAME.L(SAVEX)~=0 THEN DO;
      732    23988    3                 FPT_FEBOOT.V.MLCPDUMP#='1'B;
      733    23989    3                 END;
      734    23990    3              ELSE DO;
      735    23991    3                 FPT_FEBOOT.V.MLCPDUMP#='0'B;
      736    23992    3                 END;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:23   
      737    23993    2              FPT_FEBOOT.BUF_=DATASEG;
      738    23994    2              FPT_FEBOOT.V.FEP# = FEX;
      739    23995        /* This section will check to see if we are to request a boot of a debug fep
      740    23996        if this is a debug fep, then we will specify the NOTIME option on the call
      741    23997        to M$FEBOOT */
      742    23998
      743    23999    2              READ_NETCON.BUF_ = VECTOR(KL_NETWORK);
      744    24000    2              READ_NETCON.KEY_ = VECTOR(KL_NETWORK_KEY);
      745    24001    2              CALL M$READ (READ_NETCON) ALTRET (ALT);
      746    24002    2              IF KL_NETWORK.NODE.TYPE(FEX) = %KL_NODETYPE_DEBUG
      747    24003    3              THEN DO;
      748    24004    3                 FPT_FEBOOT.V.NOTIME# ='1'B;
      749    24005    3                 END;
      750    24006    2              CALL M$FEBOOT(FPT_FEBOOT) ALTRET(ALT);
      751    24007    2              IF B$JIT.SYSID ~= 8
      752    24008    3              THEN DO;
      753    24009    4                 CALL M$FDS(FPT_FDS) WHENALTRETURN DO; END;
      754    24010    3                 SAVE_INFO.DATASEG(SAVEX)=VECTOR(NIL);
      755    24011    3                 END;
      756    24012    2              END;
      757    24013
      758    24014                                                /* Clean up after ourselves. */
      759    24015    1           CALL CLEANUP_DCBS;
      760    24016    1           RETURN;
      761    24017
      762    24018    1   ALT:    ;                               /* PMME ALTRET                        */
      763    24019    1           CALL PMMEERR;
      764    24020    1           SAVE_INFO.FEX(SAVEX)=-1;
      765    24021    1           IF NOT BUFFER_PASSED THEN
      766    24022    2              CALL M$FDS(FPT_FDS) WHENALTRETURN DO;
      767    24023    2                 END;
      768    24024    1           SAVE_INFO.DATASEG(SAVEX)=VECTOR(NIL);
      769    24025    1           CALL CLEANUP_DCBS;
      770    24026    1           IF ADDR(RET_ERROR_) ~= ADDR(NIL)
      771    24027    1           THEN RET_ERROR_ = RET_ERROR;
      772    24028    1           IF ADDR(WDSUSED_) ~= ADDR(NIL)
      773    24029    1           THEN WDSUSED_ = WDSUSED;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:24   
      774    24030    1           ALTRETURN;
      775    24031
      776    24032        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:25   
      777    24033    1   KFF$STARTHANDLERS: ENTRY(FEX) ALTRET ;
      778    24034        /*
      779    24035             wait for fep to go active before attempting to down load handlers
      780    24036        */
      781    24037
      782    24038    1           J = 0;
      783    24039    1           FPT_NODEINFO.V.NODENUM# = FEX;
      784    24040    2   FEACTV: DO WHILE (J<=5);
      785    24041    3              CALL M$NODEINFO(FPT_NODEINFO) WHENALTRETURN DO;
      786    24042    3                 CALL PMMEERR;
      787    24043    3                 END;
      788    24044    2              IF VLR_NODEINFO.ACTIVE# THEN
      789    24045    2                 EXIT FEACTV;
      790    24046    2              ELSE
      791    24047    3              DO;
      792    24048    3                 CALL M$WAIT(FPT_WAIT);
      793    24049    3                 J=J+1;
      794    24050    3                 IF J > 5 THEN
      795    24051    4                 DO;
      796    24052                         /*N*
      797    24053                            The fep failed to start within the allocated time frame
      798    24054                            and i got tired of waiting.  do the error message.
      799    24055                         */
      800    24056    4                    END;
      801    24057    3                 END;
      802    24058    2              END;                         /* DO WHILE */
      803    24059
      804    24060    1           KEY_FEPHNDLR.NODE = FEX;
      805    24061    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPHNDLR);
      806    24062    1           READ_NETCON.BUF_ = VECTOR(KL_FEPHNDLR);
      807    24063    2           CALL M$READ(READ_NETCON) WHENALTRETURN DO;
      808    24064    2              CALL PMMEERR;
      809    24065    2              RETURN;
      810    24066    2              END;
      811    24067    1           CALL BINCHAR(SUBSTR(FPT_STARTHANDLER.V.RES#,2,2),FEX);
      812    24068    2           DO J = 1 TO KL_FEPHNDLR.NHANDLERS-1;
      813    24069    3   START_HNDLRS: DO;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:26   
      814    24070    3                 IF KL_FEPHNDLR.BOOTIME(J) = '1'B THEN
      815    24071    3                    EXIT START_HNDLRS;
      816    24072    3                 KEY_HNDLR.HNDLR = KL_FEPHNDLR.HANDLER(J);
      817    24073    3                 KEY_HNDLR.NODE = FEX;
      818    24074    3                 READ_NETCON.KEY_ = VECTOR(KEY_HNDLR);
      819    24075    3                 READ_NETCON.BUF_ = VECTOR(KL_HNDLR);
      820    24076    4                 CALL M$READ(READ_NETCON) WHENRETURN DO;
      821    24077    4                    FPT_FID.TEXTFID_ = VECTOR(KL_HNDLR.HNDLRFID);
      822    24078    5                    CALL M$FID(FPT_FID) WHENRETURN DO;
      823    24079    5                       VLP_FPRG.NAME = VLP_NAME;
      824    24080    5                       VLP_FPRG.ACCT# = VLP_ACCT.ACCT#;
      825    24081    5                       VLP_FPRG.PASS# = VLP_PASS.PASS#;
      826    24082    5                       HAND_NAME.NAME# = VLP_NAME.NAME#;
      827    24083    5                       HAND_ACCT.ACCT# = VLP_ACCT.ACCT#;
      828    24084    6                       CALL M$OPEN(FPT_STARTHANDLER) WHENALTRETURN DO;
      829    24085    6                          CALL PMMEERR;
      830    24086                                 /* dont bother continuing if the line disconnected */
      831    24087    6                          IF B$ALT.ERR.ERR# = %E$LD THEN RETURN;
      832    24088    6                          END;
      833    24089    6                       CALL M$CLOSE(FPT_CLOSEHANDLER) WHENALTRETURN DO; END;
      834    24090    5                       END;
      835    24091    5                    WHENALTRETURN DO;
      836    24092    5                       CALL PMMEERR;
      837    24093    5                       END;
      838    24094    4                    END;
      839    24095    4                 WHENALTRETURN DO;
      840    24096    4                    CALL PMMEERR;
      841    24097    4                    END;
      842    24098    3                 END;                      /* start_handlers */
      843    24099    2              END;                         /* DO J */
      844    24100    1           RETURN;
      845    24101
      846    24102        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:27   
      847    24103    1   CONV_NODENAME: PROC (NODENAME,NODE#,NODETYPE) ALTRET;
      848    24104
      849    24105        /* Paremeters */
      850    24106    2   DCL NODENAME CHAR(8);
      851    24107    2   DCL NODE# UBIN;
      852    24108    2   DCL NODETYPE UBIN;
      853    24109
      854    24110    2   DCL I SBIN;
      855    24111
      856    24112    2           READ_NETCON.BUF_ = VECTOR(KL_NETWORK);
      857    24113    2           READ_NETCON.KEY_ = VECTOR(KL_NETWORK_KEY);
      858    24114    2           CALL M$READ (READ_NETCON)
      859    24115    3           WHENALTRETURN DO;
      860    24116    3              ALTRETURN;
      861    24117    3              END;
      862    24118
      863    24119    3           DO I = 0 TO KL_NETWORK.NODE#;
      864    24120    3              IF KL_NETWORK.NODE.NODE(I) = NODENAME
      865    24121    4              THEN DO;
      866    24122    4                 NODETYPE = KL_NETWORK.NODE.TYPE(I);
      867    24123    4                 IF NODETYPE = %KL_NODETYPE_UNDEF
      868    24124    4                 THEN
      869    24125    4                    ALTRETURN;
      870    24126    4                 NODE# = I;
      871    24127    4                 RETURN;
      872    24128    4                 END;
      873    24129    3              END;
      874    24130
      875    24131    2           ALTRETURN;
      876    24132    2   END CONV_NODENAME;
      877    24133
      878    24134        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:28   
      879    24135    1   KFF$FREE: ENTRY(FEX) ALTRET;
      880    24136
      881    24137    2           CALL FIND_SAVEX(FEX,SAVEX) WHENRETURN DO;
      882    24138    3              IF SAVE_INFO.DFNAME.L(SAVEX)~=0 THEN DO;
      883    24139    3                 CALL KFD$MLCPDUMP(FEX,SAVE_INFO.DATASEG(SAVEX),SAVE_INFO.DFNAME(SAVEX)
             24139                          );
      884    24140    3                 SAVE_INFO.DFNAME.L(SAVEX)=0;
      885    24141    3                 END;
      886    24142    3              DO INHIBIT;
      887    24143    3                 DATASEG=SAVE_INFO.DATASEG(SAVEX);
      888    24144    4                 CALL M$FDS(FPT_FDS) WHENALTRETURN DO; END;
      889    24145    3                 END;
      890    24146    2              SAVE_INFO.FEX(SAVEX)=-1;
      891    24147    2              END;
      892    24148    1           RETURN;
      893    24149
      894    24150        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:29   
      895    24151    1   KFF$SAVE_DFNAME: ENTRY(FEX,BOOT_BUFFER/*DFNAME*/) ALTRET;
      896    24152
      897    24153    2           CALL GET_SAVEX(FEX,SAVEX) WHENRETURN DO;
      898    24154    2              SAVE_INFO.DFNAME(SAVEX)=ADDR(BOOT_BUFFER)->DFBASE;
      899    24155    2              END;
      900    24156    2           WHENALTRETURN DO;
      901    24157    2              ALTRETURN;
      902    24158    2              END;
      903    24159    1           RETURN;
      904    24160
      905    24161        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:30   
      906    24162    1   READ_RU: PROC(IMAGE$,TYPE) ALTRET;
      907    24163    2   DCL IMAGE$ PTR;
      908    24164    2   DCL TYPE UBIN WORD;
      909    24165    2   DCL BUF$ PTR;
      910    24166    2   DCL ONEPAGE(0:1023) UBIN BASED(BUF$);
      911    24167    2   DCL PAGES SBIN;
      912    24168    2   DCL I SBIN;
      913    24169    2   DCL BIAS UBIN WORD;
      914    24170        %FPT_READ (FPTN=FPT_READRU,DCB=M$RU);
      915    24209        %FPT_PRECORD (DCB=M$RU,KEYR=YES,N=0,KEY=RUKEY);
      916    24230        %B$FEP_RUKEY (NAME=RUKEY,STCLASS=STATIC);
      917    24254        %B$RUHEADKEY (NAME=HEADKEY,STCLASS=STATIC);
      918    24261        %B$SECTABLE (STCLASS="(0:30) STATIC");
      919    24273        %B$SECTABLEKEY (NAME=SECTKEY,STCLASS=STATIC);
      920    24280    2   DCL BYTESLEFT SBIN;
      921    24281    2   DCL BYTESIZE UBIN;
      922    24282    2   DCL SECT$ PTR;
      923    24283    2   DCL OFFSET UBIN;
      924    24284    2   DCL START UBIN;
      925    24285    2   DCL SIZE UBIN;
      926    24286    2   DCL VDPGS UBIN;
      927    24287        /**/
      928    24288    2           WDSUSED = 0;
      929    24289    2           RUKEY.TYPE = 10;
      930    24290    2           RUKEY.NODE = 0;
      931    24291    2           FPT_READRU.BUF_=VECTOR(HEADBUF);
      932    24292    2           FPT_READRU.KEY_=VECTOR(HEADKEY);
      933    24293    2           FPT_READRU.V.KEYS#='1'B;
      934    24294    2           CALL M$READ(FPT_READRU) ALTRET(ALT);
      935    24295    3           DO CASE(TYPE);
      936    24296    3            CASE(%RU);
      937    24297    3              RUKEY.PAGE = 0;
      938    24298    3              ROK = (((B$HEAD.ROSIZE+1)/2)+1023)/1024;
      939    24299    3              FPT_PRECORD.V.KEYR# = '1'B;
      940    24300    3              FPT_PRECORD.V.KEYS# = '1'B;
      941    24301    3              FPT_PRECORD.V.N# = ROK;
      942    24302    3              CALL M$PRECORD(FPT_PRECORD) ALTRET(GO1);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:31   
      943    24303    3   GO1:       ;
      944    24304    3              VDPGS = ( (B$HEAD.RDATA + %GM_ISR1_BASE - RUKEY.PAGE) +255)/256;
      945    24305    3              VDK = (VDPGS + 7)/8;
      946    24306    3              VPK = (B$HEAD.VPPGS + 7)/8;
      947    24307    3              PAGES = (ROK + VPK + VDK + 1)*1024;
      948    24308    3              CALL GETSEG(IMAGE$,PAGES) ALTRET(ALT);
      949    24309    3              ROSOFFSET = POFFW(IMAGE$,BEGIN$);
      950    24310    3              DATAOFFSET = ROSOFFSET + ROK * 1024;
      951    24311    3              PROCOFFSET = DATAOFFSET + VDK * 1024;
      952    24312    3              RUKEY.PAGE = 0;
      953    24313    3              FPT_PRECORD.V.N# = 0;
      954    24314    3              CALL M$PRECORD(FPT_PRECORD) ALTRET(GO2);
      955    24315    3   GO2:       FPT_PRECORD.V.KEYS#='0'B;
      956    24316    3              CALL M$PRECORD(FPT_PRECORD);
      957    24317    3              FPT_READRU.KEY_ = VECTOR(RUKEY);
      958    24318    3              BUF$ = ADDR(NIL);
      959    24319    4              DO WHILE(RUKEY.TYPE=10);
      960    24320    4                 IF BUF$ = ADDR(NIL)
      961    24321    4                 THEN BUF$ = IMAGE$;
      962    24322    4                 ELSE BUF$ = PINCRW(BUF$,1024);
      963    24323    4                 FPT_READRU.BUF_ = VECTOR(ONEPAGE);
      964    24324    4                 CALL M$READ(FPT_READRU) ALTRET(ALT);
      965    24325    4                 CALL M$PRECORD(FPT_PRECORD);
      966    24326    4                 END;                      /* DO WHILE */
      967    24327    3              WDSUSED = POFFW(BUF$,IMAGE$) + SIZEW(ONEPAGE);
      968    24328    3            CASE(%MON);
      969    24329    3              FPT_READRU.BUF_ = VECTOR(B$SECTABLE);
      970    24330    3              FPT_READRU.KEY_ = VECTOR(SECTKEY);
      971    24331    3              FPT_READRU.V.KEYS# = '1'B;
      972    24332    3              CALL M$READ(FPT_READRU) ALTRET(ALT);
      973    24333    3              NUMSECTS = B$HEAD.SECTABLESIZE/SIZEW(B$SECTABLE(0)) - 2;
      974    24334    3              B$SECTABLE.SIZE(NUMSECTS) = SIZEW(ONEPAGE) * 2 + B$SECTABLE.SIZE(NUMSECTS
             24334                       +1);
      975    24335    3              P$ = ADDR(TEMP_SECTION.NUMSECTS);
      976    24336    3              CALL STORVAL(P$->ONEWORD,NUMSECTS,4);
      977    24337    3              SECT$ = IMAGE$;
      978    24338    3              FPT_READRU.KEY_ = VECTOR(RUKEY);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:32   
      979    24339    3              FPT_PRECORD.V.KEYR# = '0'B;
      980    24340    3              FPT_READRU.V.KEYS# = '0'B;
      981    24341    4              DO I = NUMSECTS DOWNTO 0;
      982    24342    4                 RUKEY.PAGE = B$SECTABLE.START(I);
      983    24343    4                 FPT_PRECORD.V.KEYS# = '1'B;
      984    24344    4                 CALL M$PRECORD(FPT_PRECORD) ALTRET(ALT);
      985    24345    4                 FPT_PRECORD.V.KEYS# = '0'B;
      986    24346    4                 P$ = ADDR(TEMP_SECTION.SECT.SIZE(I));
      987    24347    4                 SIZE = B$SECTABLE.SIZE(I);
      988    24348    4                 CALL STORVAL(P$->ONEWORD,SIZE,4);
      989    24349    4                 OFFSET = POFFW(SECT$,BEGIN$);
      990    24350    4                 P$ = ADDR(TEMP_SECTION.SECT.OFFSET(I));
      991    24351    4                 CALL STORVAL(P$->ONEWORD,OFFSET,4);
      992    24352    4                 P$ = ADDR(TEMP_SECTION.SECT.START(I));
      993    24353    4                 START = B$SECTABLE.START(I);
      994    24354    4                 CALL STORVAL(P$->ONEWORD,START,4);
      995    24355    4                 BYTESIZE = B$SECTABLE.SIZE(I) * 2;
      996    24356    4                 BYTESLEFT = BYTESIZE;
      997    24357    4                 BUF$ = SECT$;
      998    24358    5                 DO WHILE(BYTESLEFT > 0);
      999    24359    5                    CALL GETSEG(BUF$,SIZEW(ONEPAGE)) ALTRET(ALT);
     1000    24360    5                    FPT_READRU.BUF_ = VECTOR(ONEPAGE);
     1001    24361    5                    CALL M$READ(FPT_READRU) ALTRET(ALT);
     1002    24362    5                    CALL M$PRECORD(FPT_PRECORD) ALTRET(ALT);
     1003    24363    5                    BYTESLEFT = BYTESLEFT - SIZEC(ONEPAGE);
     1004    24364    5                    BUF$ = PINCRW(BUF$,SIZEW(ONEPAGE));
     1005    24365    5                    END;                   /* DO WHILE */
     1006    24366    4                 SECT$ = PINCRW(SECT$,(BYTESIZE+3)/4);
     1007    24367    4                 END;                      /* DO I */
     1008    24368    3              WDSUSED = (POFFC(SECT$,IMAGE$)+3)/4;
     1009    24369    3            CASE(%LIB);
     1010    24370    3              VPK = (B$HEAD.VPPGS+7)/8;
     1011    24371    3              VDK = (B$HEAD.VDPGS+7)/8;
     1012    24372    3              PAGES = (VDK + VPK + 1)*1024;
     1013    24373    3              CALL GETSEG(IMAGE$,PAGES) ALTRET(ALT);
     1014    24374    3              DATAOFFSET = POFFW(IMAGE$,BEGIN$);
     1015    24375    3              PROCOFFSET = DATAOFFSET + VDK * 1024;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:33   
     1016    24376    3              RUKEY.PAGE = B$HEAD.BIAS;
     1017    24377    3              FPT_PRECORD.V.KEYR# = '1'B;
     1018    24378    3              FPT_PRECORD.V.KEYS# = '1'B;
     1019    24379    3              CALL M$PRECORD(FPT_PRECORD) ALTRET(NEXT);
     1020    24380    3   NEXT:      FPT_PRECORD.V.KEYS# = '0'B;
     1021    24381    3              FPT_READRU.KEY_ = VECTOR(RUKEY);
     1022    24382    3              BUF$ = ADDR(NIL);
     1023    24383    4              DO WHILE(RUKEY.TYPE = 10);
     1024    24384    4                 IF BUF$ = ADDR(NIL)
     1025    24385    4                 THEN BUF$ = IMAGE$;
     1026    24386    4                 ELSE BUF$ = PINCRW(BUF$,SIZEW(ONEPAGE));
     1027    24387    4                 FPT_READRU.BUF_ = VECTOR(ONEPAGE);
     1028    24388    4                 CALL M$READ(FPT_READRU) ALTRET(ALT);
     1029    24389    4                 CALL M$PRECORD(FPT_PRECORD);
     1030    24390    4                 END;                      /* DO WHILE */
     1031    24391    3              WDSUSED = POFFW(BUF$,IMAGE$) + SIZEW(ONEPAGE);
     1032    24392    3            END;                           /* DO CASE(TYPE) */
     1033    24393    2           CALL M$CLOSE(CLOSE_RU) ALTRET(ALT);
     1034    24394    2           RETURN;
     1035    24395    2   ALT:
     1036    24396    2           ALTRETURN;
     1037    24397    2   END READ_RU;
     1038    24398        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:34   
     1039    24399    1   GETSEG: PROC(START$,SIZE) ALTRET;
     1040    24400    2   DCL START$ PTR;
     1041    24401    2   DCL SIZE SBIN;
     1042    24402    2   DCL CURSIZE SBIN;
     1043    24403    2   DCL NEWSIZE SBIN;
     1044    24404        /**/
     1045    24405    2           NEWSIZE=POFFW(START$,BEGIN$)+SIZE;
     1046    24406    2           IF MOD(NEWSIZE,1024) ~= 0
     1047    24407    2           THEN NEWSIZE=NEWSIZE+1024-MOD(NEWSIZE,1024);
     1048    24408    2           CURSIZE=(VBOUND(DATASEG))/4;
     1049    24409    3           IF NEWSIZE>CURSIZE THEN DO;
     1050    24410    3              FPT_GDS.V.SEGSIZE#=NEWSIZE-CURSIZE;
     1051    24411    3              CALL M$GDS(FPT_GDS) ALTRET(ALT);
     1052    24412    3              END;
     1053    24413    2           RETURN;
     1054    24414    2   ALT:
     1055    24415    2           CALL PMMEERR;
     1056    24416    2           ALTRETURN;
     1057    24417    2   END GETSEG;
     1058    24418        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:35   
     1059    24419    1   PMMEERR: PROC;
     1060    24420        %FPT_ERRMSG (OUTDCB1=M$DO,SUBMESS=YES,SUBFILE=YES,BUF=ERRBUF,CODE=RET_ERROR,INCLCODE
             24420            =NO);
     1061    24447        %FPT_KEYIN (MESS=ERRBUF,RESULTS=RSLT);
     1062    24466    2   DCL RSLT(0:1) UBIN STATIC;
     1063    24467    2   DCL ERRBUF CHAR(120) STATIC;
     1064    24468        /**/
     1065    24469    2           RET_ERROR=B$ALT.ERR & '777777777770'O;
     1066    24470    3           IF WE_PRINT_ERRORS THEN DO;
     1067    24471    3              FPT_ERRMSG.V.DCB#=B$ALT.DCB#;
     1068    24472    3              CALL M$ERRMSG(FPT_ERRMSG);
     1069    24473    3              IF B$JIT.SYSID = 8
     1070    24474    3              THEN CALL M$KEYIN(FPT_KEYIN) ALTRET(L1);
     1071    24475    3   L1:        ;
     1072    24476    3              END;
     1073    24477    2           RETURN;
     1074    24478    2   END PMMEERR;
     1075    24479        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:36   
     1076    24480    1   CLEANUP_DCBS: PROC;
     1077    24481        /**/
     1078    24482    2           IF DCBADDR(DCBNUM(M$RU))->F$DCB.FCD# THEN
     1079    24483    2              CALL M$CLOSE(CLOSE_RU);
     1080    24484
     1081    24485    3           IF DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD# AND CLOSE_M$NETCON THEN DO;
     1082    24486    3              CLOSE_GOODIES.V.DCB# = DCBNUM(M$NETCON);
     1083    24487    3              CALL M$CLOSE(CLOSE_GOODIES);
     1084    24488    3              END;                         /* IF                                 */
     1085    24489
     1086    24490    3           IF DCBADDR(DCBNUM(M$PROF))->F$DCB.FCD# AND CLOSE_M$PROF THEN DO;
     1087    24491    3              CLOSE_GOODIES.V.DCB# = DCBNUM(M$PROF);
     1088    24492    3              CALL M$CLOSE(CLOSE_GOODIES);
     1089    24493    3              END;                         /* IF                                 */
     1090    24494
     1091    24495    3           IF DCBADDR(DCBNUM(M$HLPF))->F$DCB.FCD# AND CLOSE_M$HLPF THEN DO;
     1092    24496    3              CLOSE_GOODIES.V.DCB# = DCBNUM(M$HLPF);
     1093    24497    3              CALL M$CLOSE(CLOSE_GOODIES);
     1094    24498    3              END;                         /* IF                                 */
     1095    24499
     1096    24500    2           RETURN;
     1097    24501    2   END CLEANUP_DCBS;
     1098    24502    1   STORVAL: PROC(L6DW,L66WD,SIZE);
     1099    24503    2   DCL 1 L6DW UNAL,
     1100    24504    2         2 BITES(0:3) UBIN(9) UNAL;
     1101    24505    2   DCL 1 L66WD UNAL,
     1102    24506    2         2 * UBIN(4) UNAL,
     1103    24507    2         2 BITES(0:3) UBIN(8) UNAL;
     1104    24508    2   DCL SIZE UBIN;
     1105    24509    2   DCL I SBIN;
     1106    24510        /**/
     1107    24511    3           DO I = 0 TO SIZE - 1;
     1108    24512    3              L6DW.BITES(I)=L66WD.BITES(I);
     1109    24513    3              END;
     1110    24514    2           RETURN;
     1111    24515    2   END STORVAL;
     1112    24516
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:37   
     1113    24517
     1114    24518    1   ALIGNPTR: PROC(POINTER);
     1115    24519
     1116    24520        /* Align pointer to L66 word boundary */
     1117    24521
     1118    24522    2   DCL 1 POINTER ALIGNED,
     1119    24523    2         2 WA UBIN(18) UNAL,
     1120    24524    2         2 CA UBIN(2) UNAL,
     1121    24525    2         2 BA UBIN(4) UNAL,
     1122    24526    2         2 SID BIT(12);
     1123    24527
     1124    24528    3           IF POINTER.CA~=0 OR POINTER.BA~=0 THEN DO;
     1125    24529    3              POINTER.WA=POINTER.WA+1;
     1126    24530    3              POINTER.CA=0;
     1127    24531    3              POINTER.BA=0;
     1128    24532    3              END;
     1129    24533    2           RETURN;
     1130    24534
     1131    24535    2   END ALIGNPTR;
     1132    24536        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:38   
     1133    24537    1   FIND_SAVEX: PROC(FEX,SAVX) ALTRET;
     1134    24538        /**/
     1135    24539    2   DCL FEX UBIN;
     1136    24540    2   DCL SAVX UBIN;
     1137    24541    2   DCL I UBIN;
     1138    24542        /**/
     1139    24543    3           DO I=0 TO KI_FEMAX#;
     1140    24544    4              IF SAVE_INFO.FEX(I)=FEX THEN DO;
     1141    24545    4                 SAVX=I;
     1142    24546    4                 RETURN;
     1143    24547    4                 END;
     1144    24548    3              END;
     1145    24549    2           ALTRETURN;
     1146    24550    2   END FIND_SAVEX;
     1147    24551        /**/
     1148    24552        /**/
     1149    24553    1   GET_SAVEX: PROC(FEX,SAVX) ALTRET;
     1150    24554        /**/
     1151    24555    2   DCL FEX UBIN;
     1152    24556    2   DCL SAVX UBIN;
     1153    24557    2   DCL I UBIN;
     1154    24558        /**/
     1155    24559    2           CALL FIND_SAVEX(FEX,SAVEX)
     1156    24560    3           WHENRETURN DO;
     1157    24561    3              RETURN;
     1158    24562    3              END;
     1159    24563    3           WHENALTRETURN DO;
     1160    24564    4              DO I=0 TO KI_FEMAX#;
     1161    24565    5                 IF SAVE_INFO.FEX(I)=-1 THEN DO;
     1162    24566    5                    SAVE_INFO.FEX(I)=FEX;
     1163    24567    5                    SAVE_INFO.DFNAME.L(I)=0;
     1164    24568    5                    SAVE_INFO.DATASEG(I)=VECTOR(NIL);
     1165    24569    5                    SAVX=I;
     1166    24570    5                    RETURN;
     1167    24571    5                    END;
     1168    24572    4                 END;
     1169    24573    3              END;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:39   
     1170    24574    2           ALTRETURN;
     1171    24575        /**/
     1172    24576    2   END GET_SAVEX;
     1173    24577        /**/
     1174    24578        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:40   
     1175    24579    1   CONFIG_LINK: PROC(ERR) ALTRET;
     1176    24580
     1177    24581    2   DCL ERR BIT(36) ALIGNED ;
     1178    24582
     1179    24583        /* KL$LINK */
     1180    24584
     1181    24585        %KL$LINK (NAME=KL$LINK,STCLASS=AUTO,NUM=5);
     1182    24614        %KL$LINK_KEY (NAME=KL_LINK_KEY,STCLASS=STATIC);
     1183    24632
     1184    24633        /* KL$LINCNFG */
     1185    24634
     1186    24635        %KL$LINCNFG (NAME=KL$LINCNFG,STCLASS=AUTO,LGNSIZ=200);
     1187    24793        %KL$CONFIG_KEY (NAME=KL_LINCNFG_KEY,STCLASS=STATIC);
     1188    24840
     1189    24841        /* KL$HLPR */
     1190    24842
     1191    24843        %KL_DREC (NAME=KL$HLPR,STCLASS=AUTO,LAST=",");
     1192    24956    2         2 REST(0:256) UBIN WORD;
     1193    24957    2   DCL 1 KL_HLPR_KEY STATIC,
     1194    24958    2         2 L UBIN BYTE CALIGNED,
     1195    24959    2         2 ACCT CHAR(8),
     1196    24960    2         2 UNAME CHAR(12);
     1197    24961    2   DCL HLP$ PTR;
     1198    24962
     1199    24963        /* KL_CHNRSP */
     1200    24964
     1201    24965    2   DCL CHNRSP$ PTR;
     1202    24966        %KL_CHNRSP (FPTN=KL$CHNRSP,STCLASS="BASED(CHNRSP$)",MSGSIZE=1,ALGN=CALIGNED);
     1203    25186
     1204    25187        /* KL$LNK */
     1205    25188
     1206    25189    2   DCL LNK$ PTR;
     1207    25190        %KL_LNK (NAME=KL$LNK,STCLASS="BASED(LNK$)",ALGN=CALIGNED);
     1208    25414        %KL_LNKVC (NAME=KL$LNKVC,STCLASS="BASED(LNK$)",ALGN=CALIGNED);
     1209    25638
     1210    25639        /* LOCAL */
     1211    25640
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:41   
     1212    25641    2   DCL LINKX UBIN;
     1213    25642    2   DCL PROFILE$ PTR;
     1214    25643    2   DCL ACCT CHAR(8);
     1215    25644    2   DCL 1 UNAME CALIGNED,
     1216    25645    2         2 L UBIN BYTE CALIGNED,
     1217    25646    2         2 C CHAR(12);
     1218    25647    2   DCL PW CHAR(8);
     1219    25648    2   DCL 1 PRONAME CALIGNED,
     1220    25649    2         2 L UBIN BYTE CALIGNED,
     1221    25650    2         2 C CHAR(11);
     1222    25651    2   DCL HOSTNAME CHAR(8);
     1223    25652    2   DCL NSUBS UBIN;
     1224    25653    2   DCL SUBX UBIN;
     1225    25654    2   DCL CHNRSPLEN UBIN;
     1226    25655    2   DCL TEMP UBIN;
     1227    25656    2   DCL HALFB UBIN HALF BASED CALIGNED;
     1228    25657    2   DCL PROLEN UBIN;
     1229    25658    2   DCL NOSETUP BIT (1) ALIGNED;
     1230    25659    2   DCL NOHEADER BIT (1) ALIGNED;
     1231    25660
     1232    25661        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:42   
     1233    25662
     1234    25663    2           KL_LINK_KEY.NODE=FEX;
     1235    25664    2           READ_NETCON.KEY_=VECTOR(KL_LINK_KEY);
     1236    25665    2           READ_NETCON.BUF_=VECTOR(KL$LINK);
     1237    25666    3           CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     1238    25667    3              ERR=B$ALT.ERR;
     1239    25668    3              ALTRETURN;
     1240    25669    3              END;
     1241    25670
     1242    25671    3   LINK:   DO LINKX=0 TO KL$LINK.LINKS#-1;
     1243    25672    3              LNK$=PINCRC(NEXT$,2);
     1244    25673    3              CHNRSP$=PINCRC(LNK$,SIZEC(KL$LNK));
     1245    25674    3              PROFILE$=ADDR(KL$CHNRSP.MESSAGE.MESSAGE);
     1246    25675
     1247    25676    4              CALL GETSEG(NEXT$,512) WHENALTRETURN DO;
     1248    25677    4                 ERR=B$ALT.ERR;
     1249    25678    4                 ALTRETURN;
     1250    25679    4                 END;
     1251    25680
     1252    25681    3              KL_LINCNFG_KEY.NODE=FEX;
     1253    25682    3              CALL SCRUB_TERMID(KL_LINCNFG_KEY.TERMID,%TERMINAL_ID_LEV_CHAN#);
     1254    25683    3              KL_LINCNFG_KEY.TERMID.TERM.CHANNEL=KL$LINK.CHANNEL(LINKX);
     1255    25684    3              READ_NETCON.KEY_=VECTOR(KL_LINCNFG_KEY);
     1256    25685    3              READ_NETCON.BUF_=VECTOR(KL$LINCNFG);
     1257    25686    4              CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     1258    25687    4                 ERR=B$ALT.ERR;
     1259    25688    4                 ALTRETURN;
     1260    25689    4                 END;
     1261    25690
     1262    25691    3              CALL KLH$SGSCAN(KL$LINCNFG.LGN,ACCT,UNAME,PW,PRONAME,ERR,HOSTNAME,NOSETUP
             25691                       ,NOHEADER)
     1263    25692    4              WHENRETURN DO;
     1264    25693    4                 KL_HLPR_KEY.ACCT=ACCT;
     1265    25694    4                 KL_HLPR_KEY.UNAME=UNAME.C;
     1266    25695    4                 KL_HLPR_KEY.L=SIZEC(KL_HLPR_KEY.ACCT)+UNAME.L;
     1267    25696    4                 READ_HLP.KEY_=VECTOR(KL_HLPR_KEY);
     1268    25697    4                 READ_HLP.BUF_=VECTOR(KL$HLPR);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:43   
     1269    25698    5                 CALL M$READ(READ_HLP) WHENALTRETURN DO;
     1270    25699    5                    ERR=B$ALT.ERR;
     1271    25700    5                    ALTRETURN;
     1272    25701    5                    END;
     1273    25702    4                 END;
     1274    25703    4              WHENALTRETURN DO;
     1275    25704    4                 KL$HLPR = '0'B;
     1276    25705    4                 END;
     1277    25706    3              HLP$=ADDR(KL$HLPR.REST);
     1278    25707    3              LNK$->KL$LNK=HLP$->KL$LNK;
     1279    25708    3              TEMP = HLP$->KL$LNK.LIC;
     1280    25709    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.LIC,2);
     1281    25710    3              TEMP = HLP$->KL$LNK.HIC;
     1282    25711    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.HIC,2);
     1283    25712    3              TEMP = HLP$->KL$LNK.LOC;
     1284    25713    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.LOC,2);
     1285    25714    3              TEMP = HLP$->KL$LNK.HOC;
     1286    25715    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.HOC,2);
     1287    25716    3              NSUBS=LNK$->KL$LNK.BLKHDR.NSUBS;
     1288    25717
     1289    25718    3              KL$CHNRSP='0'B;
     1290    25719    3              KL$CHNRSP.FCN=%IGA_CHNRSP;
     1291    25720    3              KL$CHNRSP.TERMINAL_ID=KL_LINCNFG_KEY.TERMID;
     1292    25721    3              KL$CHNRSP.TERMINAL_ID.TERM.TERM_NAME = ACCT;
     1293    25722    3              KL$CHNRSP.NA=KL$LINCNFG.NA;
     1294    25723    3              KL$CHNRSP.HNDCMN=KL$LINCNFG.KHA;
     1295    25724    3              CHNRSPLEN=POFFC(ADDR(KL$CHNRSP.MESSAGE.MESSAGE),CHNRSP$);
     1296    25725
     1297    25726    3              LNK$->KL$LNK.BLKHDR.PROOFFSET=POFFC(PROFILE$,LNK$);
     1298    25727    4              CALL GETPRO(KL$HLPR.PNAME,PROFILE$,PROLEN) WHENALTRETURN DO;
     1299    25728    4                 PROLEN=0;
     1300    25729    4                 END;
     1301    25730
     1302    25731
     1303    25732    3              TEMP=PROLEN+SIZEC(KL$LNK)+CHNRSPLEN;
     1304    25733    3              PROFILE$ = PINCRC(PROFILE$,PROLEN);
     1305    25734    4              CALL GETPRO(HLP$->KL$LNK.DFLTVCPRO,PROFILE$,PROLEN) WHENALTRETURN DO;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:44   
     1306    25735    4                 PROLEN=0;
     1307    25736    4                 END;
     1308    25737
     1309    25738    3              TEMP=PROLEN+TEMP;
     1310    25739    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.BLKHDR.LEN,2);
     1311    25740
     1312    25741    3              HLP$=PINCRC(HLP$,SIZEC(KL$LNK));
     1313    25742    3              TEMP=TEMP/2;                 /* size to words */
     1314    25743    3              CALL KFF$9TO8(TEMP,NEXT$->HALFB,2);
     1315    25744    3              NEXT$=PINCRC(NEXT$,(TEMP*2)+2);
     1316    25745
     1317    25746    4   SUB:       DO SUBX=1 TO NSUBS;
     1318    25747    5                 CALL GETSEG(NEXT$,512) WHENALTRETURN DO;
     1319    25748    5                    ERR=B$ALT.ERR;
     1320    25749    5                    ALTRETURN;
     1321    25750    5                    END;
     1322    25751    4                 LNK$=PINCRC(NEXT$,2);
     1323    25752    4                 CHNRSP$=PINCRC(LNK$,SIZEC(KL$LNKVC));
     1324    25753    4                 PROFILE$=ADDR(KL$CHNRSP.MESSAGE.MESSAGE);
     1325    25754
     1326    25755    4                 LNK$->KL$LNKVC=HLP$->KL$LNKVC;
     1327    25756    4                 KL_LINCNFG_KEY.NODE=FEX;
     1328    25757    4                 CALL SCRUB_TERMID(KL_LINCNFG_KEY.TERMID,%TERMINAL_ID_LEV_SUBCHAN#);
     1329    25758    4                 KL_LINCNFG_KEY.TERMID.TERM.SUBDEVICE.BYT(1)=KL$LNKVC.BLKHDR.DEVNUM;
     1330    25759    4                 KL_LINCNFG_KEY.TERMID.TERM.TERM_NAME=ACCT;
     1331    25760    4                 READ_NETCON.KEY_=VECTOR(KL_LINCNFG_KEY);
     1332    25761    4                 READ_NETCON.BUF_=VECTOR(KL$LINCNFG);
     1333    25762    5                 CALL M$READ(READ_NETCON) WHENALTRETURN DO;
     1334    25763    5                    END;
     1335    25764
     1336    25765    4                 KL$CHNRSP='0'B;
     1337    25766    4                 KL$CHNRSP.CONFIG = '1'B;
     1338    25767    4                 KL$CHNRSP.FCN=%IGA_CHNRSP;
     1339    25768    4                 KL$CHNRSP.TERMINAL_ID=KL_LINCNFG_KEY.TERMID;
     1340    25769    4                 KL$CHNRSP.NA=KL$LINCNFG.NA;
     1341    25770    4                 KL$CHNRSP.HNDCMN=KL$LINCNFG.KHA;
     1342    25771
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:45   
     1343    25772    5                 CALL GETPRO(KL$LNKVC.PRONM,PROFILE$,PROLEN) WHENALTRETURN DO;
     1344    25773    5                    ERR=B$ALT.ERR;
     1345    25774    5                    ALTRETURN;
     1346    25775    5                    END;
     1347    25776    4                 KL$LNKVC.BLKHDR.PROOFFSET=POFFC(PROFILE$,LNK$);
     1348    25777    4                 TEMP=PROLEN+SIZEC(KL$LNKVC)+CHNRSPLEN;
     1349    25778    4                 CALL KFF$9TO8(TEMP,LNK$->KL$LNK.BLKHDR.LEN,2);
     1350    25779    4                 TEMP=TEMP/2;
     1351    25780    4                 CALL KFF$9TO8(TEMP,NEXT$->HALFB,2);
     1352    25781    4                 NEXT$=PINCRC(NEXT$,(TEMP*2)+2);
     1353    25782    4                 HLP$=PINCRC(HLP$,SIZEC(KL$LNKVC));
     1354    25783
     1355    25784    4                 END SUB;
     1356    25785    3              END LINK;
     1357    25786
     1358    25787    2           RETURN;
     1359    25788
     1360    25789
     1361    25790        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:46   
     1362    25791
     1363    25792    2   GETPRO: PROC(PRO,OUT$,PROLEN) ALTRET;
     1364    25793
     1365    25794    3   DCL 1 PRO CALIGNED,
     1366    25795    3         2 L UBIN BYTE CALIGNED,
     1367    25796    3         2 C CHAR(11);
     1368    25797    3   DCL OUT$ PTR;
     1369    25798    3   DCL PROLEN UBIN;
     1370    25799
     1371    25800        %KL_BLKHDR (NAME=BLKHDR,STCLASS="BASED(OUT$)");
     1372    25895
     1373    25896    3   DCL PRO$ PTR;
     1374    25897    3   DCL PROSIZE UBIN;
     1375    25898    3   DCL PROBASE CHAR(PROSIZE) BASED(PRO$);
     1376    25899    3   DCL PROREC CHAR(512);
     1377    25900        %KL_PHDR (NAME=KL$PHDR,STCLASS="BASED(PRO$)");
     1378    25941
     1379    25942
     1380    25943    4           IF PRO.L=0 THEN DO;
     1381    25944    4              PROLEN=0;
     1382    25945    4              RETURN;
     1383    25946    4              END;
     1384    25947
     1385    25948    3           READ_PRO.KEY_=VECTOR(PRO);
     1386    25949    3           READ_PRO.BUF_=VECTOR(PROREC);
     1387    25950    4           CALL M$READ(READ_PRO) WHENALTRETURN DO;
     1388    25951    4              ALTRETURN;
     1389    25952    4              END;
     1390    25953    3           PRO$=OUT$;
     1391    25954    3           PROSIZE=DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS#-SIZEC(KL$PHDR);
     1392    25955    3           PROLEN=PROSIZE;
     1393    25956    3           PROBASE=PINCRC(ADDR(PROREC),SIZEC(KL$PHDR))->PROBASE;
     1394    25957    3           RETURN;
     1395    25958
     1396    25959    3   END GETPRO;
     1397    25960        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:47   
     1398    25961    2   SCRUB_TERMID: PROC(TERMID,LEV);
     1399    25962
     1400    25963        %B$TERMINAL_ID (FPTN=TERMID,STCLASS=PARAM);
     1401    25992    3   DCL LEV UBIN;
     1402    25993
     1403    25994    3           TERMID='0'B;
     1404    25995    3           TERMID.LEV=LEV;
     1405    25996    3           TERMID.TERM.TERM_NAME=' ';
     1406    25997
     1407    25998    3           RETURN;
     1408    25999
     1409    26000    3   END SCRUB_TERMID;
     1410    26001    2   END CONFIG_LINK;
     1411    26002    1   END KFF$FEBOOT;
     1412    26003        %EOD;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:48   
--  Include file information  --

   GM_VIRTUAL_E.:E05TOU  is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   GJ_MSG_M.:E05TOU  is referenced.
   GI_DATA_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KFF$FEBOOT.

   Procedure KFF$FEBOOT requires 3004 words for executable code.
   Procedure KFF$FEBOOT requires 1976 words of local(AUTO) storage.

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:49   

 Object Unit name= KFF$FEBOOT                                 File name= KFF$FEBOOT.:E05TOU
 UTS= JUL 30 '97 00:21:26.00 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   DCB   even  none     0      0  M$RU
    2   DCB   even  none     0      0  M$NETCON
    3   DCB   even  none     0      0  M$PROF
    4   DCB   even  none     0      0  M$HLPF
    5   DCB   even  none     0      0  M$HANDLER
    6   Data  even  none  2234   4272  KFF$FEBOOT
    7  RoData even  UTS     25     31  KFF$FEBOOT
    8   DCB   even  none     0      0  M$DO
    9   Proc  even  none  3004   5674  KFF$FEBOOT
   10  RoData even  none   119    167  KFF$FEBOOT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     9      0   yes    yes     yes      Std        4  KFF$FEBOOT
     9   3113          yes     yes      Std        1  KFF$STARTHANDLERS
     9   3365          yes     yes      Std        1  KFF$FREE
     9   3442          yes     yes      Std        2  KFF$SAVE_DFNAME

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    6   2276  FPT_FEBOOT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:50   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       3 KFF$9TO8
         yes    yes    Std       3 KFD$MLCPDUMP
 yes     yes           Std       9 KLH$SGSCAN
                       nStd      0 X66_AUTO_4
                       nStd      0 X66_AALT
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  M$RU                                  M$NETCON
     M$PROF                                M$HLPF                                M$HANDLER
     B$JIT$                                M$DO                                  B$TCB$
     B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID                               ROSID
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:51   


        1        1        /*M* KFF$FEBOOT - Routine to build a C00 FEP boot image */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* DMR */
        8        8        KFF$FEBOOT: PROC (FEX,BOOT_BUFFER,RET_ERROR_,WDSUSED_) ALTRET;

      8  9 000000   000000 700200 xent  KFF$FEBOOT   TSX0  ! X66_AUTO_4
         9 000001   003670 000004                    ZERO    1976,4

        9        9        /*D* NAME: KFF$FEBOOT
       10       10             CALL: CALL KFF$FEBOOT(FEPNAME,[BOOT_BUFFER],[RET_ERROR_])
       11       11                        ALTRETURN (X);
       12       12             DESCRIPTION:
       13       13                   KFF$FEBOOT builds a FEP boot-image.  Depending on the
       14       14                   calling parameters, the image will be left in a buffer
       15       15                   for later use, or actually booted into the FEP.
       16       16
       17       17                   'FEX' parameter - UBIN WORD that specifies which FEP to
       18       18                      boot or build boot image for.
       19       19
       20       20                   'BOOT_BUFFER' parameter - a VECTOR of a buffer that is to
       21       21                      hold the boot-image buffer.  If this parameter is not
       22       22                      supplied, KFF$FEBOOT allocates its own buffer and will
       23       23                      boot the FEP as soon as the image is built.  If this
       24       24                      parameter is supplied, the image will be built in the
       25       25                      buffer and the FEP will NOT be booted.
       26       26
       27       27                   'RET_ERROR_' parameter - a standard CP-6 error code, built
       28       28                      by VLP_ERRCODE.  This field dictates the disposition
       29       29                      of error conditions encountered in the course of KFF$FEBOOT.
       30       30                      If this parameter is supplied, no messages will be
       31       31                      displayed, but the error code will be passed back.
       32       32                      If this parameter is omitted, KFF$FEBOOT will attempt to
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:52   
       33       33                      display a textual error message.
       34       34
       35       35                   'WDSUSED_' parameter - UBIN WORD that, if passed, will be
       36       36                      returned as a count of the L66 words required to hold
       37       37                      the boot-image.
       38       38
       39       39                   The construction of certain types of boot images requires
       40       40                   access to certain control files.  If the caller intends to
       41       41                   call this routine repeatedly, or himself needs to access
       42       42                   the files, he should OPEN the files before calling this
       43       43                   routine.  If the files are not open on entry, KFF$FEBOOT
       44       44                   will open them and close them on exit.
       45       45
       46       46                   Control files are:
       47       47                        M$NETCON     :NETCON.:SYS
       48       48                        M$PROF       :PRO.:SYS
       49       49                        M$HLPF       :HLP.:SYS
       50       50
       51       51        */
       52       52        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:53   
       53       53        /**/
       54       54        /*  INCLUDE FILES  */
       55       55        /**/
       56       56        %INCLUDE B$OBJECT_C;
       57     3486        %INCLUDE CP_6;
       58     9045        %INCLUDE CP_6_SUBS;
       59     9585        %INCLUDE B_ERRORS_C;
       60    10712        %INCLUDE B_STRINGS_C;
       61    10841        %INCLUDE GI_DATA_M;
       62    10869        %INCLUDE GJ_MSG_M;
       63    11182        %INCLUDE GI_BOOT_C;
       64    11293        %INCLUDE KL_AFCN_C;
       65    11394        %INCLUDE KL_CONFIG_M;
       66    12156        %INCLUDE KL_CONTROL_C;
       67    12536        %INCLUDE KL_MACRO_C;
       68    15888        %INCLUDE KL_SUPER_C;
       69    18790        %INCLUDE B$JIT;
       70    19393        %INCLUDE B_SEGIDS_C;
       71    19932        %INCLUDE KI_SUBS_C;
       72    20068        %INCLUDE KS_SUBS_C;
       73    20311        %INCLUDE GM_VIRTUAL_E;
       74    20521        /**/
       75    20522        /*  PARAMETERS  */
       76    20523        /**/
       77    20524    1   DCL FEX UBIN;
       78    20525    1   DCL HOSTNODE UBIN;
       79    20526    1   DCL HOSTNAME CHAR(8);
       80    20527    1   DCL NODETYPE UBIN;
       81    20528    1   DCL BOOT_BUFFER VECTOR;
       82    20529        %VLP_ERRCODE (FPTN = RET_ERROR_,STCLASS = " ");
       83    20574    1   DCL WDSUSED_ UBIN WORD;
       84    20575        /**/
       85    20576        /* ENTRY DCLS */
       86    20577        /**/
       87    20578    1   DCL KFD$MLCPDUMP ENTRY(3) OPTIONAL;
       88    20579    1   DCL KFF$9TO8 ENTRY(3);
       89    20580    1   DCL KLH$SGSCAN ENTRY(9) ALTRET;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:54   
       90    20581        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:55   
       91    20582        /**/
       92    20583        /*  DCBS  */
       93    20584        /**/
       94    20585    1   DCL M$RU DCB;
       95    20586    1   DCL M$NETCON DCB;
       96    20587    1   DCL M$PROF DCB;
       97    20588    1   DCL M$HLPF DCB;
       98    20589    1   DCL M$HANDLER DCB;
       99    20590        /**/
      100    20591    1   DCL B$JIT$ PTR SYMREF;
      101    20592        %RU_FLAVORS;
      102    20598        %FPT_GDS (SEGSIZE=1024,RESULTS=DATASEG);
      103    20614        %FPT_FDS (SEGSIZE=262143,RESULTS=DATASEG);
      104    20629    1   DCL DATASEG VECTOR STATIC;
      105    20630    1   DCL 1 SAVE_INFO(0:KI_FEMAX#) STATIC ALIGNED,
      106    20631    1         2 FEX SBIN INIT(-1*0),
      107    20632    1         2 DATASEG VECTOR INIT(VECTOR(NIL)*0),
      108    20633    1         2 DFNAME,
      109    20634    1           3 L UBIN BYTE UNAL INIT(0*0),
      110    20635    1           3 C CHAR(31) INIT(' '*0);
      111    20636        %FPT_FECTL (FPTN=FPT_FEBOOT,RESULTS=BOOTRESULT,STCLASS="STATIC SYMDEF");
      112    20651        %FPT_MONINFO (STCLASS=CONSTANT,MONINFO=VLR_MONINFO,SITEINFO=VLR_SITEINFO);
      113    20666        %VLR_MONINFO;
      114    20684        %VLR_SITEINFO;
      115    20703        %FPT_NODEINFO (NODEINFO=VLR_NODEINFO);
      116    20715        %VLR_NODEINFO;
      117    20730    1   DCL BOOTRESULT(0:1) UBIN STATIC;
      118    20731        %FPT_OPEN (FPTN=OPEN_GOODIES,           /* DCB will get stuffed later         */
      119    20732                   ACCT=SYSACCT,
      120    20733                   FUN=IN,
      121    20734                   ORG=KEYED,
      122    20735                   ASN=FILE,
      123    20736                   SHARE=ALL,
      124    20737                   ACS=DIRECT,
      125    20738                   STCLASS=STATIC);
      126    20847        %FPT_CLOSE (FPTN=CLOSE_GOODIES,         /* DCB will get stuffed later         */
      127    20848                    DISP=SAVE,
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:56   
      128    20849                    STCLASS=STATIC);
      129    20891        %FPT_READ (FPTN=READ_NETCON,
      130    20892                   KEYS=YES,
      131    20893                   DCB=M$NETCON);
      132    20932        %FPT_READ (FPTN=READ_PRO,
      133    20933                   DCB=M$PROF,
      134    20934                   KEYS=YES);
      135    20973        %FPT_READ (FPTN=READ_HLP,
      136    20974                   DCB=M$HLPF,
      137    20975                   KEYS=YES);
      138    21014        %FPT_OPEN (FPTN=FPT_OPNRU,DCB=M$RU,
      139    21015                   FUN=IN,SHARE=IN,
      140    21016                   NAME=VLP_NAME,ACCT=VLP_ACCT,PASS=VLP_PASS,SN=VLP_SN);
      141    21125        %FPT_CLOSE (FPTN=CLOSE_RU,
      142    21126                    DCB=M$RU,
      143    21127                    DISP=SAVE);
      144    21169        %FPT_FID (FPTN=FPT_FID,
      145    21170                  NAME=VLP_NAME,ACCT=VLP_ACCT,PASS=VLP_PASS,SN=VLP_SN,
      146    21171                  RES=FPT_OPNRU.V.RES#,ASN=FPT_OPNRU.V.ASN#,
      147    21172                  RESULTS=VLR_FID);
      148    21195        %VLR_FID;
      149    21214        %VLP_NAME;
      150    21241        %VLP_ACCT;
      151    21254        %VLP_PASS;
      152    21267        %VLP_SN;
      153    21280        %VLP_NAME (FPTN=NETCONNAME,
      154    21281                   NAME=':NETCON',
      155    21282                   STCLASS=CONSTANT);
      156    21309        %VLP_NAME (FPTN=HLPNAME,
      157    21310                   NAME=':HLP',
      158    21311                   STCLASS=CONSTANT);
      159    21338        %VLP_NAME (FPTN=PRONAME,
      160    21339                   NAME=':PRO',
      161    21340                   STCLASS=CONSTANT);
      162    21367        %VLP_ACCT (FPTN=SYSACCT,ACCT=':SYS');
      163    21380        %FPT_WAIT (UNITS=11);
      164    21394        %FPT_OPEN (FPTN=FPT_STARTHANDLER,DCB=M$HANDLER,FUN=CREATE,NAME=HAND_NAME,ACCT=
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:57   
             21394            HAND_ACCT,
      165    21395                   ASN=DEVICE,RES='FE',ORG=HANDLER,FPRG=VLP_FPRG);
      166    21504        %VLP_ACCT (FPTN=HAND_ACCT,ACCT='       ');
      167    21517        %VLP_NAME (FPTN=HAND_NAME,NAME='            ');
      168    21544        %VLP_FPRG (FPTN=VLP_FPRG);
      169    21565        %FPT_CLOSE (FPTN=FPT_CLOSEHANDLER,DCB=M$HANDLER,DISP=SAVE);
      170    21607    1   DCL M$DO DCB;
      171    21608    1   DCL B$TCB$ PTR SYMREF;
      172    21609        %B$TCB;
      173    21612        %B$ALT;
      174    21620        %F$DCB;
      175    21677    1   DCL HEADBUF(0:49) UBIN STATIC INIT(0*0);
      176    21678    1   DCL HD$ PTR STATIC INIT(ADDR(HEADBUF));
      177    21679        %VLP_ERRCODE (FPTN = RET_ERROR,STCLASS = STATIC);
      178    21724        %B$HEAD (NAME=B$HEAD,STCLASS="BASED(HD$)");
      179    21924        /**/
      180    21925    1   DCL P$ PTR;
      181    21926    1   DCL SETFP$ PTR;
      182    21927    1   DCL PARAM$ PTR;
      183    21928    1   DCL CONTROL$ PTR;
      184    21929    1   DCL SECT$ PTR;
      185    21930    1   DCL SECTSIZE UBIN;
      186    21931    1   DCL NUMSECTS UBIN;
      187    21932
      188    21933    1   DCL IN$ PTR;
      189    21934    1   DCL OUT$ PTR;
      190    21935    1   DCL IPARAM$ PTR;
      191    21936    1   DCL INDX UBIN;
      192    21937    1   DCL OFFSET UBIN;
      193    21938    1   DCL ARRAY_WDSZ UBIN;
      194    21939
      195    21940    1   DCL B$PARAMI(0:0) UBIN HALF BASED UNAL;
      196    21941    1   DCL B$BYTE UBIN BYTE BASED;
      197    21942    1   DCL B$HALF UBIN(18) BASED;
      198    21943    1   DCL B$WORD UBIN WORD BASED;
      199    21944
      200    21945    1   DCL TBLOFFSET UBIN;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:58   
      201    21946    1   DCL DATAOFFSET UBIN;
      202    21947    1   DCL PROCOFFSET UBIN;
      203    21948    1   DCL ROSOFFSET UBIN;
      204    21949    1   DCL LIBOFFSET UBIN;
      205    21950    1   DCL PARAMOFFSET UBIN;
      206    21951    1   DCL PSEUDO$ PTR;
      207    21952    1   DCL START UBIN WORD;
      208    21953    1   DCL I SBIN;
      209    21954    1   DCL J UBIN;
      210    21955    1   DCL K SBIN;
      211    21956    1   DCL OFFSET_SIZE UBIN WORD;
      212    21957    1   DCL SKP_HNDLR UBIN;
      213    21958    1   DCL SKP_HNDLR2 UBIN;
      214    21959    1   DCL NHANDLERS UBIN WORD;      /* number of handlers to be booted with fep.  */
      215    21960    1   DCL NHNDLRS_DFR UBIN WORD; /* number of handlers started after fep is running */
      216    21961    1   DCL WDSUSED SBIN WORD;
      217    21962    1   DCL OFFSET$ PTR;
      218    21963    1   DCL NEXT$ PTR;
      219    21964    1   DCL BEGIN$ PTR;
      220    21965    1   DCL SVNEXT$ PTR;
      221    21966    1   DCL VDK UBIN WORD;
      222    21967    1   DCL VPK UBIN WORD;
      223    21968    1   DCL ROK UBIN WORD;
      224    21969    1   DCL TEMP SBIN;
      225    21970    1   DCL SAVEX UBIN;
      226    21971    1   DCL CLOSE_M$NETCON BIT(1);
      227    21972    1   DCL CLOSE_M$PROF BIT(1);
      228    21973    1   DCL CLOSE_M$HLPF BIT(1);
      229    21974    1   DCL WE_PRINT_ERRORS BIT(1);
      230    21975    1   DCL BUFFER_PASSED BIT(1);
      231    21976    1   DCL LIBX UBIN;
      232    21977    1   DCL NLIBS UBIN;
      233    21978    1   DCL LIB_PROCSIZ UBIN;
      234    21979    1   DCL LIB_DATASIZ UBIN;
      235    21980    1   DCL 1 LIB_TBL(0:9),
      236    21981    1         2 NAME CHAR(31) UNAL,
      237    21982    1         2 PROCOFFSET UBIN WALIGNED,
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:59   
      238    21983    1         2 DATAOFFSET UBIN WALIGNED,
      239    21984    1         2 PROCSIZE UBIN WORD WALIGNED,
      240    21985    1         2 DATASIZE UBIN WORD WALIGNED;
      241    21986    1   DCL 1 DFBASE BASED CALIGNED,
      242    21987    1         2 L UBIN BYTE UNAL,
      243    21988    1         2 C CHAR(31);
      244    21989        /**/
      245    21990    1   DCL ONEWORD UBIN BASED;
      246    21991        %GI$OFFSETS (FPTN=GI$OFFSETS,STCLASS="BASED(OFFSET$)",SYSTEM=CP6);
      247    21996        %GJ_SETFP_MSG (FPTN=GI$SETFP,
      248    21997                       BOOT=YES,
      249    21998                       STCLASS="BASED(SETFP$)");
      250    22162        %GI$PARAMS (STCLASS="BASED(PARAM$)",SYSTEM=CP6,NUM=GI_BOOT_HI);
      251    22165       %GI$PARAMS (FPTN=GI$CONTROL,STCLASS="BASED(CONTROL$)",SYSTEM=CP6,NUM=GI_CNTL_BOOTHI)
             22165            ;
      252    22168        %GI$PSEUDOS (FPTN=GI$PSEUDO,STCLASS="BASED(PSEUDO$)",SYSTEM=CP6,NUM=7);
      253    22172        %GI$SECTION (FPTN=TEMP_SECTION,STCLASS=STATIC,NUM=30,SYSTEM=CP6);
      254    22175        %GI$SECTION (FPTN=GI$SECTION,STCLASS="BASED(SECT$)",NUM=30,SYSTEM=CP6);
      255    22178        /**/
      256    22179
      257    22180       %KL_CONTROL_INIT (FPTN=KL$CONTROL_INIT,NUM_FIXED=%KL_FIXED_HI,NUM_INDXD = 4, STCLASS
             22180            ="BASED(PARAM$)",LAST=NO);
      258    22305    1           2 BLOCK(0:15) UBIN(18) UNAL,
      259    22306    1             2 UNBLOCK(0:15) UBIN(18) UNAL,
      260    22307    1             2 USRPARM1(0:7) UBIN(18) UNAL,
      261    22308    1             2 USRPARM2(0:7) UBIN(18) UNAL;
      262    22309
      263    22310        %KL_CONTROL_INIT (FPTN=KL$$CONTROL_INIT,NUM_FIXED=%KL_FIXED_HI,STCLASS=BASED);
             22310            /*fixed portion only */
      264    22435
      265    22436        %KL$FEPBOOT (NAME=KL_FEPBOOT,STCLASS=STATIC,NUM=GI_BOOT_HI);
      266    22461        %KL$FEPHNDLR (NAME=KL_FEPHNDLR,STCLASS=STATIC,NUM=9);
      267    22491
      268    22492        %KL$HNDLR (NAME=KL_HNDLR,NUM=%KL_FIXED_HI,NUMI=4,STCLASS=STATIC,LAST=NO);
             22492            /* buffer for the largest */
      269    22555    1         2 BLOCK(0:15) UBIN(18) UNAL,
      270    22556    1         2 UNBLOCK(0:15) UBIN(18) UNAL,
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:60   
      271    22557    1         2 USRPARM1(0:7) UBIN(18) UNAL,
      272    22558    1         2 USRPARM2(0:7) UBIN(18) UNAL;
      273    22559
      274    22560        %KL$HNDLR (NAME=KL$HNDLR,NUM=%KL_FIXED_HI,STCLASS=BASED); /*fixed portion only */
      275    22623
      276    22624        %KL$FEPBOOT_KEY (NAME=KEY_FEPBOOT,STCLASS=STATIC);
      277    22642        %KL$FEPHNDLR_KEY (NAME=KEY_FEPHNDLR,STCLASS=STATIC);
      278    22660        %KL$HNDLR_KEY (NAME=KEY_HNDLR,STCLASS=STATIC);
      279    22679        %KL$PSEUDO (NAME=KL_PSEUDO,STCLASS=STATIC,NUM=7);
      280    22723        %KL$PSEUDO_KEY (NAME=KEY_PSEUDO,STCLASS=STATIC);
      281    22741        %KL$FEPCTL (NAME=KL_FEPCTL,STCLASS=STATIC,NUM=GI_CNTL_BOOTHI);
      282    22761        %KL$FEPCTL_KEY (NAME=KEY_FEPCTL,STCLASS=STATIC);
      283    22779        /**/
      284    22780        %KL_LNK (NAME=KL$LNK,STCLASS=BASED);
      285    23004        %KL_CHNRSP (FPTN=KL$CHNRSP,MSGSIZE=1,STCLASS=BASED,ALGN=CALIGNED);
      286    23224        %KL_CHNRSP (FPTN=KL_CHNRSP,MSGSIZE=1);
      287    23444        /**/
      288    23445        %KL$NETWORK (NAME=KL_NETWORK,NUM=255,STCLASS=AUTO);
      289    23472        %KL$NETWORK_KEY (NAME=KL_NETWORK_KEY,STCLASS=CONSTANT);
      290    23489        /* A macro to convert host to front end */
      291    23490        %MACRO CNVRT9TO8 (S=DUM,D=DUM,SIZE=4);
      292    23491                TEMP=S;
      293    23492                CALL KFF$9TO8(TEMP,D,SIZE);
      294    23493
      295    23494        %MEND;
      296    23495        %SUB FOREVER="WHILE('1'B)";
      297    23496        %SUB NEVER="WHILE('0'B)";
      298    23497        %SUB B$ALT=B$TCB$->B$TCB.ALT$->B$ALT;
      299    23498        %EQU MON = 1;
      300    23499        %EQU RU = 2;
      301    23500        %EQU LIB = 3;
      302    23501        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:61   
      303    23502    2           CALL GET_SAVEX(FEX,SAVEX) WHENALTRETURN DO;

  23502  9 000002   200061 630500                    EPPR0   SAVEX,,AUTO
         9 000003   202666 450500                    STP0    @ERR+1,,AUTO
         9 000004   200003 236100                    LDQ     @FEX,,AUTO
         9 000005   202665 756100                    STQ     KL_NETWORK+1282,,AUTO
         9 000006   004612 701000 9                  TSX1    GET_SAVEX
         9 000007   000011 702000 9                  TSX2    s:23504
         9 000010   000012 710000 9                  TRA     s:23507

      304    23503                                                /*PUT IN AN ERROR*/
      305    23504    2              ALTRETURN;

  23504  9 000011   000000 702200 xent               TSX2  ! X66_AALT

      306    23505    2              END;
      307    23506                                                /*  Reconcile parameters  */
      308    23507    1           IF ADDR(RET_ERROR_) = ADDR(NIL) THEN

  23507  9 000012   200005 236100                    LDQ     @RET_ERROR_,,AUTO
         9 000013   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 000014   000020 601000 9                  TNZ     s:23510

      309    23508    1              WE_PRINT_ERRORS = '1'B;

  23508  9 000015   400000 236003                    LDQ     -131072,DU
         9 000016   200065 756100                    STQ     WE_PRINT_ERRORS,,AUTO
         9 000017   000021 710000 9                  TRA     s:23511

      310    23509    1           ELSE
      311    23510    1              WE_PRINT_ERRORS = '0'B;

  23510  9 000020   200065 450100                    STZ     WE_PRINT_ERRORS,,AUTO

      312    23511    1           IF ADDR(BOOT_BUFFER) = ADDR(NIL) THEN

  23511  9 000021   200004 236100                    LDQ     @BOOT_BUFFER,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:62   
         9 000022   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 000023   000026 601000 9                  TNZ     s:23514

      313    23512    1              BUFFER_PASSED = '0'B;

  23512  9 000024   200066 450100                    STZ     BUFFER_PASSED,,AUTO
         9 000025   000030 710000 9                  TRA     s:23516

      314    23513    1           ELSE
      315    23514    1              BUFFER_PASSED = '1'B;

  23514  9 000026   400000 236003                    LDQ     -131072,DU
         9 000027   200066 756100                    STQ     BUFFER_PASSED,,AUTO

      316    23515
      317    23516    1           CLOSE_M$NETCON = '0'B;

  23516  9 000030   200062 450100                    STZ     CLOSE_M$NETCON,,AUTO

      318    23517    2           IF NOT DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD# THEN DO;

  23517  9 000031   000000 236007 xsym               LDQ     M$NETCON,DL
         9 000032   000000 470400 10                 LDP0    0
         9 000033   000000 471500                    LDP1    0,,PR0
         9 000034   100000 473506                    LDP3    0,QL,PR1
         9 000035   300031 236100                    LDQ     25,,PR3
         9 000036   020000 316007                    CANQ    8192,DL
         9 000037   000053 601000 9                  TNZ     s:23524

      319    23518    2              CLOSE_M$NETCON = '1'B;

  23518  9 000040   400000 236003                    LDQ     -131072,DU
         9 000041   200062 756100                    STQ     CLOSE_M$NETCON,,AUTO

      320    23519    2              OPEN_GOODIES.V.DCB# = DCBNUM(M$NETCON);

  23519  9 000042   000000 236007 xsym               LDQ     M$NETCON,DL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:63   
         9 000043   000000 620006                    EAX0    0,QL
         9 000044   002512 740000 6                  STX0    OPEN_GOODIES+36

      321    23520    2              OPEN_GOODIES.NAME_ = VECTOR(NETCONNAME);

  23520  9 000045   000002 237000 10                 LDAQ    2
         9 000046   002454 757000 6                  STAQ    OPEN_GOODIES+6

      322    23521    2              CALL M$OPEN(OPEN_GOODIES) ALTRET(ALT);

  23521  9 000047   002446 630400 6                  EPPR0   OPEN_GOODIES
         9 000050   450000 713400                    CLIMB   alt,open
         9 000051   410400 401760                    pmme    nvectors=18
         9 000052   003052 702000 9                  TSX2    ALT

      323    23522    2              END;                         /* IF */

      324    23523
      325    23524    1           CLOSE_M$PROF = '0'B;

  23524  9 000053   200063 450100                    STZ     CLOSE_M$PROF,,AUTO

      326    23525    2           IF NOT DCBADDR(DCBNUM(M$PROF)) -> F$DCB.FCD# THEN DO;

  23525  9 000054   000000 236007 xsym               LDQ     M$PROF,DL
         9 000055   000000 470400 10                 LDP0    0
         9 000056   000000 471500                    LDP1    0,,PR0
         9 000057   100000 473506                    LDP3    0,QL,PR1
         9 000060   300031 236100                    LDQ     25,,PR3
         9 000061   020000 316007                    CANQ    8192,DL
         9 000062   000076 601000 9                  TNZ     s:23532

      327    23526    2              CLOSE_M$PROF = '1'B;

  23526  9 000063   400000 236003                    LDQ     -131072,DU
         9 000064   200063 756100                    STQ     CLOSE_M$PROF,,AUTO

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:64   
      328    23527    2              OPEN_GOODIES.V.DCB# = DCBNUM(M$PROF);

  23527  9 000065   000000 236007 xsym               LDQ     M$PROF,DL
         9 000066   000000 620006                    EAX0    0,QL
         9 000067   002512 740000 6                  STX0    OPEN_GOODIES+36

      329    23528    2              OPEN_GOODIES.NAME_ = VECTOR(PRONAME);

  23528  9 000070   000004 237000 10                 LDAQ    4
         9 000071   002454 757000 6                  STAQ    OPEN_GOODIES+6

      330    23529    2              CALL M$OPEN (OPEN_GOODIES) ALTRET(ALT);

  23529  9 000072   002446 630400 6                  EPPR0   OPEN_GOODIES
         9 000073   450000 713400                    CLIMB   alt,open
         9 000074   410400 401760                    pmme    nvectors=18
         9 000075   003052 702000 9                  TSX2    ALT

      331    23530    2              END;

      332    23531
      333    23532    1           CLOSE_M$HLPF = '0'B;

  23532  9 000076   200064 450100                    STZ     CLOSE_M$HLPF,,AUTO

      334    23533    2           IF NOT DCBADDR(DCBNUM(M$HLPF)) -> F$DCB.FCD# THEN DO;

  23533  9 000077   000000 236007 xsym               LDQ     M$HLPF,DL
         9 000100   000000 470400 10                 LDP0    0
         9 000101   000000 471500                    LDP1    0,,PR0
         9 000102   100000 473506                    LDP3    0,QL,PR1
         9 000103   300031 236100                    LDQ     25,,PR3
         9 000104   020000 316007                    CANQ    8192,DL
         9 000105   000121 601000 9                  TNZ     s:23541

      335    23534    2              CLOSE_M$HLPF = '1'B;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:65   
  23534  9 000106   400000 236003                    LDQ     -131072,DU
         9 000107   200064 756100                    STQ     CLOSE_M$HLPF,,AUTO

      336    23535    2              OPEN_GOODIES.V.DCB# = DCBNUM(M$HLPF);

  23535  9 000110   000000 236007 xsym               LDQ     M$HLPF,DL
         9 000111   000000 620006                    EAX0    0,QL
         9 000112   002512 740000 6                  STX0    OPEN_GOODIES+36

      337    23536    2              OPEN_GOODIES.NAME_ = VECTOR(HLPNAME);

  23536  9 000113   000006 237000 10                 LDAQ    6
         9 000114   002454 757000 6                  STAQ    OPEN_GOODIES+6

      338    23537    2              CALL M$OPEN (OPEN_GOODIES) ALTRET(ALT);

  23537  9 000115   002446 630400 6                  EPPR0   OPEN_GOODIES
         9 000116   450000 713400                    CLIMB   alt,open
         9 000117   410400 401760                    pmme    nvectors=18
         9 000120   003052 702000 9                  TSX2    ALT

      339    23538    2              END;

      340    23539
      341    23540                                                /*  Get a buffer to hold boot image  */
      342    23541    2           IF BUFFER_PASSED THEN DO;

  23541  9 000121   200066 234100                    SZN     BUFFER_PASSED,,AUTO
         9 000122   000127 605000 9                  TPL     s:23545

      343    23542    2              DATASEG = BOOT_BUFFER;

  23542  9 000123   200004 470500                    LDP0    @BOOT_BUFFER,,AUTO
         9 000124   000000 237100                    LDAQ    0,,PR0
         9 000125   000014 757000 6                  STAQ    DATASEG

      344    23543    2              END;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:66   

  23543  9 000126   000131 710000 9                  TRA     s:23547

      345    23544    2           ELSE DO;

      346    23545    2              DATASEG=VECTOR(NIL);

  23545  9 000127   000010 237000 10                 LDAQ    8
         9 000130   000014 757000 6                  STAQ    DATASEG

      347    23546    2              END;

      348    23547    1           BEGIN$ = ADDR(NIL);

  23547  9 000131   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 000132   200053 756100                    STQ     BEGIN$,,AUTO

      349    23548    2           CALL GETSEG(VBASE(DATASEG),2048) WHENALTRETURN DO;

  23548  9 000133   000013 236000 10                 LDQ     11
         9 000134   203444 756100                    STQ     @TERMID+1,,AUTO
         9 000135   000014 236000 10                 LDQ     12
         9 000136   203443 756100                    STQ     NOHEADER+3,,AUTO
         9 000137   004316 701000 9                  TSX1    GETSEG
         9 000140   000142 702000 9                  TSX2    s:23549
         9 000141   000143 710000 9                  TRA     s:23552

      350    23549    2              ALTRETURN;

  23549  9 000142   000000 702200 xent               TSX2  ! X66_AALT

      351    23550    2              END;
      352    23551
      353    23552    1           IF BUFFER_PASSED

  23552  9 000143   200066 234100                    SZN     BUFFER_PASSED,,AUTO
         9 000144   000150 605000 9                  TPL     s:23556
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:67   

      354    23553    1           THEN
      355    23554    1              BEGIN$ = VBASE(DATASEG);

  23554  9 000145   000015 236000 6                  LDQ     DATASEG+1
         9 000146   200053 756100                    STQ     BEGIN$,,AUTO
         9 000147   000153 710000 9                  TRA     s:23557

      356    23555    1           ELSE
      357    23556    1              BEGIN$ = PINCRW(VBASE(DATASEG),1);

  23556  9 000150   000015 236000 6                  LDQ     DATASEG+1
         9 000151   000001 036003                    ADLQ    1,DU
         9 000152   200053 756100                    STQ     BEGIN$,,AUTO

      358    23557    1           KEY_FEPBOOT.NODE = FEX;

  23557  9 000153   200003 470500                    LDP0    @FEX,,AUTO
         9 000154   000000 236100                    LDQ     0,,PR0
         9 000155   000011 736000                    QLS     9
         9 000156   003646 552010 6                  STBQ    KEY_FEPBOOT,'10'O

      359    23558    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPBOOT);

  23558  9 000157   000016 237000 10                 LDAQ    14
         9 000160   002600 757000 6                  STAQ    READ_NETCON+2

      360    23559    1           READ_NETCON.BUF_ = VECTOR(KL_FEPBOOT);

  23559  9 000161   000020 237000 10                 LDAQ    16
         9 000162   002602 757000 6                  STAQ    READ_NETCON+4

      361    23560    1           CALL M$READ(READ_NETCON) ALTRET(ALT);

  23560  9 000163   002576 630400 6                  EPPR0   READ_NETCON
         9 000164   440000 713400                    CLIMB   alt,read
         9 000165   401400 401760                    pmme    nvectors=4
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:68   
         9 000166   003052 702000 9                  TSX2    ALT

      362    23561    1           FPT_FID.TEXTFID_ = VECTOR(KL_FEPBOOT.BOOTFID);

  23561  9 000167   000022 237000 10                 LDAQ    18
         9 000170   003002 757000 6                  STAQ    FPT_FID+2

      363    23562    1           CALL M$FID(FPT_FID) ALTRET(ALT);

  23562  9 000171   003000 630400 6                  EPPR0   FPT_FID
         9 000172   420001 713400                    CLIMB   alt,+8193
         9 000173   404400 401760                    pmme    nvectors=10
         9 000174   003052 702000 9                  TSX2    ALT

      364    23563    1           CALL M$OPEN(FPT_OPNRU) ALTRET(ALT);

  23563  9 000175   002650 630400 6                  EPPR0   FPT_OPNRU
         9 000176   450000 713400                    CLIMB   alt,open
         9 000177   410400 401760                    pmme    nvectors=18
         9 000200   003052 702000 9                  TSX2    ALT

      365    23564    1           CALL READ_RU(BEGIN$,%MON) ALTRET(ALT);

  23564  9 000201   000024 236000 10                 LDQ     20
         9 000202   202666 756100                    STQ     @ERR+1,,AUTO
         9 000203   200053 630500                    EPPR0   BEGIN$,,AUTO
         9 000204   202665 450500                    STP0    KL_NETWORK+1282,,AUTO
         9 000205   003463 701000 9                  TSX1    READ_RU
         9 000206   003052 702000 9                  TSX2    ALT

      366    23565    1           P$=PINCRC(BEGIN$,%BITBIN('104'X)*2);

  23565  9 000207   200053 236100                    LDQ     BEGIN$,,AUTO
         9 000210   000202 036003                    ADLQ    130,DU
         9 000211   200013 756100                    STQ     P$,,AUTO

      367    23566    1           CALL STORVAL(P$->ONEWORD,WDSUSED,4);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:69   

  23566  9 000212   000025 236000 10                 LDQ     21
         9 000213   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000214   200050 630500                    EPPR0   WDSUSED,,AUTO
         9 000215   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000216   200013 236100                    LDQ     P$,,AUTO
         9 000217   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000220   004512 701000 9                  TSX1    STORVAL
         9 000221   000000 011000                    NOP     0

      368    23567
      369    23568    1           KEY_HNDLR.NODE = FEX;

  23568  9 000222   200003 470500                    LDP0    @FEX,,AUTO
         9 000223   000000 236100                    LDQ     0,,PR0
         9 000224   000011 736000                    QLS     9
         9 000225   003650 552010 6                  STBQ    KEY_HNDLR,'10'O

      370    23569    1           KEY_FEPHNDLR.NODE = FEX;

  23569  9 000226   000000 236100                    LDQ     0,,PR0
         9 000227   000011 736000                    QLS     9
         9 000230   003647 552010 6                  STBQ    KEY_FEPHNDLR,'10'O

      371    23570    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPHNDLR);

  23570  9 000231   000026 237000 10                 LDAQ    22
         9 000232   002600 757000 6                  STAQ    READ_NETCON+2

      372    23571    1           READ_NETCON.BUF_ = VECTOR(KL_FEPHNDLR);

  23571  9 000233   000030 237000 10                 LDAQ    24
         9 000234   002602 757000 6                  STAQ    READ_NETCON+4

      373    23572    1           CALL M$READ(READ_NETCON) ALTRET(ALT);

  23572  9 000235   002576 630400 6                  EPPR0   READ_NETCON
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:70   
         9 000236   440000 713400                    CLIMB   alt,read
         9 000237   401400 401760                    pmme    nvectors=4
         9 000240   003052 702000 9                  TSX2    ALT

      374    23573
      375    23574                                           /* Build GI$OFFSETS into the boot image */
      376    23575    1           OFFSET$=PINCRW(BEGIN$,WDSUSED);

  23575  9 000241   200050 236100                    LDQ     WDSUSED,,AUTO
         9 000242   000022 736000                    QLS     18
         9 000243   200053 036100                    ADLQ    BEGIN$,,AUTO
         9 000244   200051 756100                    STQ     OFFSET$,,AUTO

      377    23576    1           NHANDLERS = 0;

  23576  9 000245   200046 450100                    STZ     NHANDLERS,,AUTO

      378    23577    2           DO J = 0 TO KL_FEPHNDLR.NHANDLERS - 1;

  23577  9 000246   200041 450100                    STZ     J,,AUTO
         9 000247   000262 710000 9                  TRA     s:23580+2

      379    23578    2              IF KL_FEPHNDLR.BOOTIME(J) = '1'B THEN

  23578  9 000250   200041 235100                    LDA     J,,AUTO
         9 000251   000000 066405                    CMPB    filb='0'B
         9 000252   003531 000001 6                  BDSC    KL_FEPHNDLR+3,A          by=0,bit=0,n=1
         9 000253   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 000254   000260 600000 9                  TZE     s:23580

      380    23579    2                 NHANDLERS = NHANDLERS + 1;

  23579  9 000255   200046 236100                    LDQ     NHANDLERS,,AUTO
         9 000256   000001 036007                    ADLQ    1,DL
         9 000257   200046 756100                    STQ     NHANDLERS,,AUTO

      381    23580    2              END;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:71   

  23580  9 000260   000001 035007                    ADLA    1,DL
         9 000261   200041 755100                    STA     J,,AUTO
         9 000262   200041 236100                    LDQ     J,,AUTO
         9 000263   003526 116000 6                  CMPQ    KL_FEPHNDLR
         9 000264   000250 602000 9                  TNC     s:23578

      382    23581    1           NHNDLRS_DFR = KL_FEPHNDLR.NHANDLERS - NHANDLERS;

  23581  9 000265   003526 236000 6                  LDQ     KL_FEPHNDLR
         9 000266   200046 136100                    SBLQ    NHANDLERS,,AUTO
         9 000267   200047 756100                    STQ     NHNDLRS_DFR,,AUTO

      383    23582        /**/
      384    23583    1           OFFSET_SIZE = SIZEW(GI$OFFSETS) - SIZEW(GI$OFFSETS.HANDLER);

  23583  9 000270   000027 235007                    LDA     23,DL
         9 000271   200043 755100                    STA     OFFSET_SIZE,,AUTO

      385    23584    1           IF NHANDLERS > 0

  23584  9 000272   200046 235100                    LDA     NHANDLERS,,AUTO
         9 000273   000277 600000 9                  TZE     s:23586

      386    23585    1           THEN OFFSET_SIZE = OFFSET_SIZE + SIZEW(GI$OFFSETS.HANDLER) * NHANDLERS;

  23585  9 000274   200046 236100                    LDQ     NHANDLERS,,AUTO
         9 000275   200043 036100                    ADLQ    OFFSET_SIZE,,AUTO
         9 000276   200043 756100                    STQ     OFFSET_SIZE,,AUTO

      387    23586    1           CALL GETSEG(OFFSET$,OFFSET_SIZE) ALTRET(ALT);

  23586  9 000277   200043 630500                    EPPR0   OFFSET_SIZE,,AUTO
         9 000300   203444 450500                    STP0    @TERMID+1,,AUTO
         9 000301   200051 631500                    EPPR1   OFFSET$,,AUTO
         9 000302   203443 451500                    STP1    NOHEADER+3,,AUTO
         9 000303   004316 701000 9                  TSX1    GETSEG
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:72   
         9 000304   003052 702000 9                  TSX2    ALT

      388    23587    1           NEXT$ = PINCRW(OFFSET$,OFFSET_SIZE);

  23587  9 000305   200043 236100                    LDQ     OFFSET_SIZE,,AUTO
         9 000306   000022 736000                    QLS     18
         9 000307   200051 036100                    ADLQ    OFFSET$,,AUTO
         9 000310   200052 756100                    STQ     NEXT$,,AUTO

      389    23588    1           P$ = ADDR(GI$OFFSETS.NHANDLERS);

  23588  9 000311   200051 236100                    LDQ     OFFSET$,,AUTO
         9 000312   000026 036003                    ADLQ    22,DU
         9 000313   200013 756100                    STQ     P$,,AUTO

      390    23589    1           CALL STORVAL(P$->ONEWORD,NHANDLERS,4);

  23589  9 000314   000025 236000 10                 LDQ     21
         9 000315   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000316   200046 630500                    EPPR0   NHANDLERS,,AUTO
         9 000317   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000320   200013 236100                    LDQ     P$,,AUTO
         9 000321   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000322   004512 701000 9                  TSX1    STORVAL
         9 000323   000000 011000                    NOP     0

      391    23590    1           P$ = ADDR(GI$OFFSETS.FEX);

  23590  9 000324   200051 236100                    LDQ     OFFSET$,,AUTO
         9 000325   000010 036003                    ADLQ    8,DU
         9 000326   200013 756100                    STQ     P$,,AUTO

      392    23591    1           CALL STORVAL(P$->ONEWORD,FEX,4);

  23591  9 000327   000025 236000 10                 LDQ     21
         9 000330   200003 235100                    LDA     @FEX,,AUTO
         9 000331   202704 757100                    STAQ    @L6DW+1,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:73   
         9 000332   200013 236100                    LDQ     P$,,AUTO
         9 000333   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000334   004512 701000 9                  TSX1    STORVAL
         9 000335   000000 011000                    NOP     0

      393    23592    1           VLR_NODEINFO.NODENAME# = 'FEPNODE';

  23592  9 000336   040000 100400                    MLR     fill='040'O
         9 000337   000023 000007 7                  ADSC9   KL_NETWORK_KEY+1         cn=0,n=7
         9 000340   002436 000010 6                  ADSC9   VLR_NODEINFO             cn=0,n=8

      394    23593    1           FPT_NODEINFO.V.NODENUM# = FEX;

  23593  9 000341   200003 470500                    LDP0    @FEX,,AUTO
         9 000342   000000 236100                    LDQ     0,,PR0
         9 000343   000033 736000                    QLS     27
         9 000344   002434 552040 6                  STBQ    FPT_NODEINFO+6,'40'O

      395    23594    1           CALL M$NODEINFO (FPT_NODEINFO)

  23594  9 000345   002426 630400 6                  EPPR0   FPT_NODEINFO
         9 000346   560031 713400                    CLIMB   alt,+57369
         9 000347   400400 401760                    pmme    nvectors=2
         9 000350   000352 702000 9                  TSX2    s:23597
         9 000351   000352 710000 9                  TRA     s:23597

      396    23595    2           WHENALTRETURN DO;

      397    23596    2              END;

      398    23597    1           GI$OFFSETS.NODENAME = VLR_NODEINFO.NODENAME#;

  23597  9 000352   200051 470500                    LDP0    OFFSET$,,AUTO
         9 000353   002436 237000 6                  LDAQ    VLR_NODEINFO
         9 000354   000011 755100                    STA     9,,PR0
         9 000355   000012 756100                    STQ     10,,PR0

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:74   
      399    23598    1           GI$OFFSETS.BOOTFID = KL_FEPBOOT.BOOTFID;

  23598  9 000356   200051 470500                    LDP0    OFFSET$,,AUTO
         9 000357   040100 100400                    MLR     fill='040'O
         9 000360   003474 000050 6                  ADSC9   KL_FEPBOOT               cn=0,n=40
         9 000361   000014 000050                    ADSC9   12,,PR0                  cn=0,n=40

      400    23599    1           READ_NETCON.KEY_ = VECTOR(KL_NETWORK_KEY);

  23599  9 000362   000032 237000 10                 LDAQ    26
         9 000363   002600 757000 6                  STAQ    READ_NETCON+2

      401    23600    1           READ_NETCON.BUF_ = VECTOR(KL_NETWORK);

  23600  9 000364   000034 235000 10                 LDA     28
         9 000365   203650 452500                    STP2    PROREC+128,,AUTO
         9 000366   203650 236100                    LDQ     PROREC+128,,AUTO
         9 000367   000263 036003                    ADLQ    179,DU
         9 000370   002602 757000 6                  STAQ    READ_NETCON+4

      402    23601    2           CALL M$READ(READ_NETCON) WHENRETURN DO;

  23601  9 000371   002576 630400 6                  EPPR0   READ_NETCON
         9 000372   440000 713400                    CLIMB   alt,read
         9 000373   401400 401760                    pmme    nvectors=4
         9 000374   000444 702000 9                  TSX2    s:23627

      403    23602    2              IF KL_NETWORK.NODE# = 0 THEN

  23602  9 000375   200263 235100                    LDA     KL_NETWORK,,AUTO
         9 000376   000405 601000 9                  TNZ     s:23609

      404    23603    3              DO;

      405    23604        /*N* should err fact that no nodes exist */
      406    23605    3                 CALL M$MONINFO(FPT_MONINFO);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:75   
  23605  9 000377   000000 630400 7                  EPPR0   FPT_MONINFO
         9 000400   020023 713400                    CLIMB   8211
         9 000401   402400 401760                    pmme    nvectors=6

      407    23606    3                 HOSTNODE = VLR_MONINFO.NODE#;

  23606  9 000402   002321 235000 6                  LDA     VLR_MONINFO+9
         9 000403   200007 755100                    STA     HOSTNODE,,AUTO

      408    23607    3                 END;

  23607  9 000404   000443 710000 9                  TRA     s:23625

      409    23608    3              ELSE DO;

      410    23609    3                 HOSTNAME = KL_NETWORK.NODE.CONTROL_NODE(FEX);

  23609  9 000405   200003 470500                    LDP0    @FEX,,AUTO
         9 000406   000000 236100                    LDQ     0,,PR0
         9 000407   000005 402007                    MPY     5,DL
         9 000410   000002 736000                    QLS     2
         9 000411   040100 100506                    MLR     fill='040'O
         9 000412   200267 000010                    ADSC9   KL_NETWORK+4,Q,AUTO      cn=0,n=8
         9 000413   200010 000010                    ADSC9   HOSTNAME,,AUTO           cn=0,n=8

      411    23610    3                 IF HOSTNAME = ' ' THEN

  23610  9 000414   200010 237100                    LDAQ    HOSTNAME,,AUTO
         9 000415   000036 117000 10                 CMPAQ   30
         9 000416   000425 601000 9                  TNZ     s:23617

      412    23611    4                 DO;

      413    23612    4                    CALL M$MONINFO(FPT_MONINFO);

  23612  9 000417   000000 630400 7                  EPPR0   FPT_MONINFO
         9 000420   020023 713400                    CLIMB   8211
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:76   
         9 000421   402400 401760                    pmme    nvectors=6

      414    23613    4                    HOSTNODE = VLR_MONINFO.NODE#;

  23613  9 000422   002321 235000 6                  LDA     VLR_MONINFO+9
         9 000423   200007 755100                    STA     HOSTNODE,,AUTO

      415    23614    4                    END;

  23614  9 000424   000443 710000 9                  TRA     s:23625

      416    23615    3                 ELSE
      417    23616    4                 DO;

      418    23617    4                    CALL CONV_NODENAME(HOSTNAME,HOSTNODE,NODETYPE) WHENALTRETURN

  23617  9 000425   200012 631500                    EPPR1   NODETYPE,,AUTO
         9 000426   202667 451500                    STP1    KL$LINK+1,,AUTO
         9 000427   200007 633500                    EPPR3   HOSTNODE,,AUTO
         9 000430   202666 453500                    STP3    @ERR+1,,AUTO
         9 000431   200010 634500                    EPPR4   HOSTNAME,,AUTO
         9 000432   202665 454500                    STP4    KL_NETWORK+1282,,AUTO
         9 000433   003311 701000 9                  TSX1    CONV_NODENAME
         9 000434   000436 702000 9                  TSX2    s:23619
         9 000435   000443 710000 9                  TRA     s:23625

      419    23618    5                    DO;

      420    23619    5                       CALL M$MONINFO(FPT_MONINFO);

  23619  9 000436   000000 630400 7                  EPPR0   FPT_MONINFO
         9 000437   020023 713400                    CLIMB   8211
         9 000440   402400 401760                    pmme    nvectors=6

      421    23620    5                       HOSTNODE = VLR_MONINFO.NODE#;

  23620  9 000441   002321 235000 6                  LDA     VLR_MONINFO+9
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:77   
         9 000442   200007 755100                    STA     HOSTNODE,,AUTO

      422    23621        /*N* err fact that conrol node does not exist */
      423    23622    5                       END;

      424    23623    4                    END;

      425    23624    3                 END;

      426    23625    2              END;

  23625  9 000443   000451 710000 9                  TRA     s:23632

      427    23626    2           WHENALTRETURN DO;

      428    23627    2              CALL M$MONINFO(FPT_MONINFO);

  23627  9 000444   000000 630400 7                  EPPR0   FPT_MONINFO
         9 000445   020023 713400                    CLIMB   8211
         9 000446   402400 401760                    pmme    nvectors=6

      429    23628    2              HOSTNODE = VLR_MONINFO.NODE#;

  23628  9 000447   002321 235000 6                  LDA     VLR_MONINFO+9
         9 000450   200007 755100                    STA     HOSTNODE,,AUTO

      430    23629        /*N* should err fact that something is wrong with :netcon */
      431    23630    2              END;                         /* WHENALTRETURN */

      432    23631
      433    23632    1           P$ = ADDR(GI$OFFSETS.HOSTNODE);

  23632  9 000451   200051 236100                    LDQ     OFFSET$,,AUTO
         9 000452   000013 036003                    ADLQ    11,DU
         9 000453   200013 756100                    STQ     P$,,AUTO

      434    23633    1           CALL STORVAL(P$->ONEWORD,HOSTNODE,4);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:78   

  23633  9 000454   000025 236000 10                 LDQ     21
         9 000455   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000456   200007 630500                    EPPR0   HOSTNODE,,AUTO
         9 000457   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000460   200013 236100                    LDQ     P$,,AUTO
         9 000461   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000462   004512 701000 9                  TSX1    STORVAL
         9 000463   000000 011000                    NOP     0

      435    23634
      436    23635                                           /* Build GI$SECTION into the boot image */
      437    23636    1           SECT$ = NEXT$;

  23636  9 000464   200052 236100                    LDQ     NEXT$,,AUTO
         9 000465   200017 756100                    STQ     SECT$,,AUTO

      438    23637    1          SECTSIZE = SIZEW(GI$SECTION.NUMSECTS) + SIZEW(GI$SECTION.SECT(0)) * NUMSECTS
             23637                    ;

  23637  9 000466   200021 236100                    LDQ     NUMSECTS,,AUTO
         9 000467   000003 402007                    MPY     3,DL
         9 000470   000001 036007                    ADLQ    1,DL
         9 000471   200020 756100                    STQ     SECTSIZE,,AUTO

      439    23638    1           CALL GETSEG(SECT$,SIZEW(GI$SECTION)); /* MORE THAN WE NEED */

  23638  9 000472   000040 236000 10                 LDQ     32
         9 000473   203444 756100                    STQ     @TERMID+1,,AUTO
         9 000474   200017 630500                    EPPR0   SECT$,,AUTO
         9 000475   203443 450500                    STP0    NOHEADER+3,,AUTO
         9 000476   004316 701000 9                  TSX1    GETSEG
         9 000477   000000 011000                    NOP     0

      440    23639    1           NEXT$ = PINCRW(SECT$,SECTSIZE);

  23639  9 000500   200020 236100                    LDQ     SECTSIZE,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:79   
         9 000501   000022 736000                    QLS     18
         9 000502   200017 036100                    ADLQ    SECT$,,AUTO
         9 000503   200052 756100                    STQ     NEXT$,,AUTO

      441    23640    1           SECTSIZE = SECTSIZE * 2;        /* convert to L6 words */

  23640  9 000504   200020 235100                    LDA     SECTSIZE,,AUTO
         9 000505   000001 735000                    ALS     1
         9 000506   200020 755100                    STA     SECTSIZE,,AUTO

      442    23641    1           P$ = ADDR(GI$OFFSETS.SECTSIZE);

  23641  9 000507   200051 236100                    LDQ     OFFSET$,,AUTO
         9 000510   000007 036003                    ADLQ    7,DU
         9 000511   200013 756100                    STQ     P$,,AUTO

      443    23642    1           CALL STORVAL(P$->ONEWORD,SECTSIZE,4);

  23642  9 000512   000025 236000 10                 LDQ     21
         9 000513   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000514   200020 630500                    EPPR0   SECTSIZE,,AUTO
         9 000515   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000516   200013 236100                    LDQ     P$,,AUTO
         9 000517   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000520   004512 701000 9                  TSX1    STORVAL
         9 000521   000000 011000                    NOP     0

      444    23643    1           TBLOFFSET = POFFW(SECT$,BEGIN$);

  23643  9 000522   200053 235100                    LDA     BEGIN$,,AUTO
         9 000523   000022 771000                    ARL     18
         9 000524   203650 755100                    STA     PROREC+128,,AUTO
         9 000525   200017 236100                    LDQ     SECT$,,AUTO
         9 000526   000022 772000                    QRL     18
         9 000527   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 000530   200030 756100                    STQ     TBLOFFSET,,AUTO

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:80   
      445    23644    1           P$ = ADDR(GI$OFFSETS.SECTOFFSET);

  23644  9 000531   200051 236100                    LDQ     OFFSET$,,AUTO
         9 000532   000006 036003                    ADLQ    6,DU
         9 000533   200013 756100                    STQ     P$,,AUTO

      446    23645    1           CALL STORVAL(P$->ONEWORD,TBLOFFSET,4);

  23645  9 000534   000025 236000 10                 LDQ     21
         9 000535   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000536   200030 630500                    EPPR0   TBLOFFSET,,AUTO
         9 000537   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000540   200013 236100                    LDQ     P$,,AUTO
         9 000541   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000542   004512 701000 9                  TSX1    STORVAL
         9 000543   000000 011000                    NOP     0

      447    23646    1           GI$SECTION = TEMP_SECTION;

  23646  9 000544   200017 470500                    LDP0    SECT$,,AUTO
         9 000545   000100 100400                    MLR     fill='000'O
         9 000546   003336 000570 6                  ADSC9   TEMP_SECTION             cn=0,n=376
         9 000547   000000 000570                    ADSC9   0,,PR0                   cn=0,n=376

      448    23647
      449    23648                                           /* Build the handlers into the boot image */
      450    23649    1           NLIBS = 0;

  23649  9 000550   200070 450100                    STZ     NLIBS,,AUTO

      451    23650    1           LIB_TBL = '0'B;

  23650  9 000551   000100 100400                    MLR     fill='000'O
         9 000552   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 000553   200073 000740                    ADSC9   LIB_TBL,,AUTO            cn=0,n=480

      452    23651    1           SKP_HNDLR2 = 0;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:81   

  23651  9 000554   200045 450100                    STZ     SKP_HNDLR2,,AUTO

      453    23652    2           DO J = 0 TO KL_FEPHNDLR.NHANDLERS - 1;

  23652  9 000555   200041 450100                    STZ     J,,AUTO
         9 000556   002346 710000 9                  TRA     s:23922+3

      454    23653    3   HNDLRS:    DO;

  23653  9 000557                       HNDLRS       null
      455    23654    4                 IF KL_FEPHNDLR.BOOTIME(J) = '0'B THEN DO;

  23654  9 000557   200041 235100                    LDA     J,,AUTO
         9 000560   000000 066405                    CMPB    filb='0'B
         9 000561   003531 000001 6                  BDSC    KL_FEPHNDLR+3,A          by=0,bit=0,n=1
         9 000562   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 000563   000570 601000 9                  TNZ     s:23658

      456    23655    4                    SKP_HNDLR2 = SKP_HNDLR2 + 1;

  23655  9 000564   200045 236100                    LDQ     SKP_HNDLR2,,AUTO
         9 000565   000001 036007                    ADLQ    1,DL
         9 000566   200045 756100                    STQ     SKP_HNDLR2,,AUTO

      457    23656    4                    EXIT HNDLRS;

  23656  9 000567   002343 710000 9                  TRA     s:23922

      458    23657    4                    END;
      459    23658    3                 KEY_HNDLR.HNDLR = KL_FEPHNDLR.HANDLER(J);

  23658  9 000570   000003 735000                    ALS     3
         9 000571   040000 100405                    MLR     fill='040'O
         9 000572   003532 000010 6                  ADSC9   KL_FEPHNDLR+4,A          cn=0,n=8
         9 000573   003650 600010 6                  ADSC9   KEY_HNDLR                cn=3,n=8

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:82   
      460    23659    3                 READ_NETCON.KEY_ = VECTOR(KEY_HNDLR);

  23659  9 000574   000042 237000 10                 LDAQ    34
         9 000575   002600 757000 6                  STAQ    READ_NETCON+2

      461    23660    3                 READ_NETCON.BUF_ = VECTOR(KL_HNDLR);

  23660  9 000576   000044 237000 10                 LDAQ    36
         9 000577   002602 757000 6                  STAQ    READ_NETCON+4

      462    23661    3                 CALL M$READ(READ_NETCON) ALTRET(ALT);

  23661  9 000600   002576 630400 6                  EPPR0   READ_NETCON
         9 000601   440000 713400                    CLIMB   alt,read
         9 000602   401400 401760                    pmme    nvectors=4
         9 000603   003052 702000 9                  TSX2    ALT

      463    23662    3                 FPT_FID.TEXTFID_ = VECTOR(KL_HNDLR.HNDLRFID);

  23662  9 000604   000046 237000 10                 LDAQ    38
         9 000605   003002 757000 6                  STAQ    FPT_FID+2

      464    23663    3                 CALL M$FID(FPT_FID) ALTRET(ALT);

  23663  9 000606   003000 630400 6                  EPPR0   FPT_FID
         9 000607   420001 713400                    CLIMB   alt,+8193
         9 000610   404400 401760                    pmme    nvectors=10
         9 000611   003052 702000 9                  TSX2    ALT

      465    23664    3                 CALL M$OPEN(FPT_OPNRU) ALTRET(ALT);

  23664  9 000612   002650 630400 6                  EPPR0   FPT_OPNRU
         9 000613   450000 713400                    CLIMB   alt,open
         9 000614   410400 401760                    pmme    nvectors=18
         9 000615   003052 702000 9                  TSX2    ALT

      466    23665
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:83   
      467    23666                                                /* build GI$SETFP into boot image */
      468    23667    3                 SETFP$ = NEXT$;

  23667  9 000616   200052 236100                    LDQ     NEXT$,,AUTO
         9 000617   200014 756100                    STQ     SETFP$,,AUTO

      469    23668    3                 TBLOFFSET = POFFW(SETFP$,BEGIN$);

  23668  9 000620   200053 235100                    LDA     BEGIN$,,AUTO
         9 000621   000022 771000                    ARL     18
         9 000622   203650 755100                    STA     PROREC+128,,AUTO
         9 000623   200014 236100                    LDQ     SETFP$,,AUTO
         9 000624   000022 772000                    QRL     18
         9 000625   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 000626   200030 756100                    STQ     TBLOFFSET,,AUTO

      470    23669    3                 CALL GETSEG(SETFP$,SIZEW(GI$SETFP));

  23669  9 000627   000051 236000 10                 LDQ     41
         9 000630   203444 756100                    STQ     @TERMID+1,,AUTO
         9 000631   200014 630500                    EPPR0   SETFP$,,AUTO
         9 000632   203443 450500                    STP0    NOHEADER+3,,AUTO
         9 000633   004316 701000 9                  TSX1    GETSEG
         9 000634   000000 011000                    NOP     0

      471    23670    3                 NEXT$ = PINCRW(SETFP$,SIZEW(GI$SETFP));

  23670  9 000635   200014 236100                    LDQ     SETFP$,,AUTO
         9 000636   000054 036003                    ADLQ    44,DU
         9 000637   200052 756100                    STQ     NEXT$,,AUTO

      472    23671    3                 CALL READ_RU(NEXT$,%RU) ALTRET(ALT);

  23671  9 000640   000052 236000 10                 LDQ     42
         9 000641   202666 756100                    STQ     @ERR+1,,AUTO
         9 000642   200052 630500                    EPPR0   NEXT$,,AUTO
         9 000643   202665 450500                    STP0    KL_NETWORK+1282,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:84   
         9 000644   003463 701000 9                  TSX1    READ_RU
         9 000645   003052 702000 9                  TSX2    ALT

      473    23672    3                 NEXT$ = PINCRW(NEXT$,WDSUSED);

  23672  9 000646   200050 236100                    LDQ     WDSUSED,,AUTO
         9 000647   000022 736000                    QLS     18
         9 000650   200052 036100                    ADLQ    NEXT$,,AUTO
         9 000651   200052 756100                    STQ     NEXT$,,AUTO

      474    23673    3                 GI$SETFP = '0'B;

  23673  9 000652   200014 470500                    LDP0    SETFP$,,AUTO
         9 000653   000100 100400                    MLR     fill='000'O
         9 000654   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 000655   000000 000260                    ADSC9   0,,PR0                   cn=0,n=176

      475    23674    3                 P$ = ADDR(GI$OFFSETS.HANDLER.TBLOFFSET(J-SKP_HNDLR2));

  23674  9 000656   200041 236100                    LDQ     J,,AUTO
         9 000657   200045 136100                    SBLQ    SKP_HNDLR2,,AUTO
         9 000660   000022 736000                    QLS     18
         9 000661   000027 036003                    ADLQ    23,DU
         9 000662   200051 036100                    ADLQ    OFFSET$,,AUTO
         9 000663   200013 756100                    STQ     P$,,AUTO

      476    23675    3                 CALL STORVAL(P$->ONEWORD,TBLOFFSET,4);

  23675  9 000664   000025 236000 10                 LDQ     21
         9 000665   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000666   200030 630500                    EPPR0   TBLOFFSET,,AUTO
         9 000667   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000670   200013 236100                    LDQ     P$,,AUTO
         9 000671   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000672   004512 701000 9                  TSX1    STORVAL
         9 000673   000000 011000                    NOP     0

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:85   
      477    23676    3                 P$ = ADDR(GI$SETFP.OFFSET_DATA);

  23676  9 000674   200014 236100                    LDQ     SETFP$,,AUTO
         9 000675   000044 036003                    ADLQ    36,DU
         9 000676   200013 756100                    STQ     P$,,AUTO

      478    23677    3                 CALL STORVAL(P$->ONEWORD,DATAOFFSET,4);

  23677  9 000677   000025 236000 10                 LDQ     21
         9 000700   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000701   200031 630500                    EPPR0   DATAOFFSET,,AUTO
         9 000702   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000703   200013 236100                    LDQ     P$,,AUTO
         9 000704   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000705   004512 701000 9                  TSX1    STORVAL
         9 000706   000000 011000                    NOP     0

      479    23678    3                 P$ = ADDR(GI$SETFP.OFFSET_PROC);

  23678  9 000707   200014 236100                    LDQ     SETFP$,,AUTO
         9 000710   000045 036003                    ADLQ    37,DU
         9 000711   200013 756100                    STQ     P$,,AUTO

      480    23679    3                 CALL STORVAL(P$->ONEWORD,PROCOFFSET,4);

  23679  9 000712   000025 236000 10                 LDQ     21
         9 000713   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000714   200032 630500                    EPPR0   PROCOFFSET,,AUTO
         9 000715   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000716   200013 236100                    LDQ     P$,,AUTO
         9 000717   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000720   004512 701000 9                  TSX1    STORVAL
         9 000721   000000 011000                    NOP     0

      481    23680    3                 P$ = ADDR(GI$SETFP.OFFSET_RO);

  23680  9 000722   200014 236100                    LDQ     SETFP$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:86   
         9 000723   000043 036003                    ADLQ    35,DU
         9 000724   200013 756100                    STQ     P$,,AUTO

      482    23681    3                 CALL STORVAL(P$->ONEWORD,ROSOFFSET,4);

  23681  9 000725   000025 236000 10                 LDQ     21
         9 000726   202705 756100                    STQ     @L66WD+1,,AUTO
         9 000727   200033 630500                    EPPR0   ROSOFFSET,,AUTO
         9 000730   202704 450500                    STP0    @L6DW+1,,AUTO
         9 000731   200013 236100                    LDQ     P$,,AUTO
         9 000732   202703 756100                    STQ     VDPGS+2,,AUTO
         9 000733   004512 701000 9                  TSX1    STORVAL
         9 000734   000000 011000                    NOP     0

      483    23682    3                 GI$SETFP.PASS = VLP_PASS.PASS#;

  23682  9 000735   200014 470500                    LDP0    SETFP$,,AUTO
         9 000736   040100 100400                    MLR     fill='040'O
         9 000737   003054 000010 6                  ADSC9   VLP_PASS                 cn=0,n=8
         9 000740   000013 400010                    ADSC9   11,,PR0                  cn=2,n=8

      484    23683    3                 GI$SETFP.ACCT = VLP_ACCT.ACCT#;

  23683  9 000741   200014 470500                    LDP0    SETFP$,,AUTO
         9 000742   040100 100400                    MLR     fill='040'O
         9 000743   003052 000010 6                  ADSC9   VLP_ACCT                 cn=0,n=8
         9 000744   000011 400010                    ADSC9   9,,PR0                   cn=2,n=8

      485    23684    3                 GI$SETFP.PSN = VLP_SN.SN#(0);

  23684  9 000745   200014 470500                    LDP0    SETFP$,,AUTO
         9 000746   040100 100400                    MLR     fill='040'O
         9 000747   003057 000006 6                  ADSC9   VLP_SN+1                 cn=0,n=6
         9 000750   000015 400006                    ADSC9   13,,PR0                  cn=2,n=6

      486    23685    3                 GI$SETFP.NAME.L = VLP_NAME.L#;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:87   
  23685  9 000751   003042 236000 6                  LDQ     VLP_NAME
         9 000752   000022 772000                    QRL     18
         9 000753   000001 552110                    STBQ    1,'10'O,PR0

      487    23686    3                 GI$SETFP.NAME.TEXT = KL_FEPHNDLR.HANDLER(J);

  23686  9 000754   200041 235100                    LDA     J,,AUTO
         9 000755   000003 735000                    ALS     3
         9 000756   200014 470500                    LDP0    SETFP$,,AUTO
         9 000757   040100 100405                    MLR     fill='040'O
         9 000760   003532 000010 6                  ADSC9   KL_FEPHNDLR+4,A          cn=0,n=8
         9 000761   000001 600037                    ADSC9   1,,PR0                   cn=3,n=31

      488    23687    3                 GI$SETFP.FLAGS.DEBUG = '0'B;

  23687  9 000762   200014 470500                    LDP0    SETFP$,,AUTO
         9 000763   000053 236000 10                 LDQ     43
         9 000764   000022 356100                    ANSQ    18,,PR0

      489    23688    3                 IF VLP_ACCT.ACCT# = ':SYS'

  23688  9 000765   040000 106400                    CMPC    fill='040'O
         9 000766   003052 000010 6                  ADSC9   VLP_ACCT                 cn=0,n=8
         9 000767   000025 000004 7                  ADSC9   KL_NETWORK_KEY+3         cn=0,n=4
         9 000770   000773 601000 9                  TNZ     s:23690

      490    23689    3                 THEN GI$SETFP.FLAGS.XEQ_ONLY = '1'B;

  23689  9 000771   040000 236003                    LDQ     16384,DU
         9 000772   000022 256100                    ORSQ    18,,PR0

      491    23690    3                CALL STORVAL(GI$SETFP.MODTIME,DCBADDR(DCBNUM(M$RU))->F$DCB.EXPIRE#,4);

  23690  9 000773   000000 236007 xsym               LDQ     M$RU,DL
         9 000774   000000 471400 10                 LDP1    0
         9 000775   100000 473500                    LDP3    0,,PR1
         9 000776   300000 474506                    LDP4    0,QL,PR3
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:88   
         9 000777   000025 236000 10                 LDQ     21
         9 001000   202705 756100                    STQ     @L66WD+1,,AUTO
         9 001001   400035 635500                    EPPR5   29,,PR4
         9 001002   202704 455500                    STP5    @L6DW+1,,AUTO
         9 001003   200014 236100                    LDQ     SETFP$,,AUTO
         9 001004   000017 036003                    ADLQ    15,DU
         9 001005   202703 756100                    STQ     VDPGS+2,,AUTO
         9 001006   004512 701000 9                  TSX1    STORVAL
         9 001007   000000 011000                    NOP     0

      492    23691    3                 GI$SETFP.LIB_NAME = B$HEAD.LIBNAME;

  23691  9 001010   003334 470400 6                  LDP0    HD$
         9 001011   200014 471500                    LDP1    SETFP$,,AUTO
         9 001012   000100 100500                    MLR     fill='000'O
         9 001013   000030 000040                    ADSC9   24,,PR0                  cn=0,n=32
         9 001014   100033 000040                    ADSC9   27,,PR1                  cn=0,n=32

      493    23692    3                 GI$SETFP.VERSION = B$HEAD.VERSION#;

  23692  9 001015   000011 236100                    LDQ     9,,PR0
         9 001016   000033 772000                    QRL     27
         9 001017   100022 552104                    STBQ    18,'04'O,PR1

      494    23693    3                 GI$SETFP.FLAGS.LAUTO = B$HEAD.LAUTO;

  23693  9 001020   000011 236100                    LDQ     9,,PR0
         9 001021   000022 736000                    QLS     18
         9 001022   100022 676100                    ERQ     18,,PR1
         9 001023   000004 376003                    ANQ     4,DU
         9 001024   100022 656100                    ERSQ    18,,PR1

      495    23694    3                 GI$SETFP.FLAGS.PROCACC = B$HEAD.PROCACC;

  23694  9 001025   000022 236100                    LDQ     18,,PR0
         9 001026   000011 736000                    QLS     9
         9 001027   100022 676100                    ERQ     18,,PR1
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:89   
         9 001030   004000 376003                    ANQ     2048,DU
         9 001031   100022 656100                    ERSQ    18,,PR1

      496    23695    3                 GI$SETFP.FLAGS.NOCHRPMEM = B$HEAD.NOCHGPMEM;

  23695  9 001032   000022 236100                    LDQ     18,,PR0
         9 001033   000011 736000                    QLS     9
         9 001034   100022 676100                    ERQ     18,,PR1
         9 001035   002000 376003                    ANQ     1024,DU
         9 001036   100022 656100                    ERSQ    18,,PR1

      497    23696    3                 GI$SETFP.FLAGS.S = B$HEAD.S;

  23696  9 001037   000022 236100                    LDQ     18,,PR0
         9 001040   000010 736000                    QLS     8
         9 001041   100022 676100                    ERQ     18,,PR1
         9 001042   200000 376003                    ANQ     65536,DU
         9 001043   100022 656100                    ERSQ    18,,PR1

      498    23697    3                 GI$SETFP.FLAGS.LIB = B$HEAD.LIB;

  23697  9 001044   000022 236100                    LDQ     18,,PR0
         9 001045   000010 736000                    QLS     8
         9 001046   100022 676100                    ERQ     18,,PR1
         9 001047   100000 376003                    ANQ     32768,DU
         9 001050   100022 656100                    ERSQ    18,,PR1

      499    23698                      %CNVRT9TO8(S="B$HEAD.START",D="GI$SETFP.START",SIZE=4);

  23699  9 001051   000003 236100                    LDQ     3,,PR0
         9 001052   000054 376000 10                 ANQ     44
         9 001053   200060 756100                    STQ     TEMP,,AUTO

  23700  9 001054   000025 236000 10                 LDQ     21
         9 001055   203652 756100                    STQ     PROREC+130,,AUTO
         9 001056   200014 236100                    LDQ     SETFP$,,AUTO
         9 001057   000020 036003                    ADLQ    16,DU
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:90   
         9 001060   203651 756100                    STQ     PROREC+129,,AUTO
         9 001061   200060 633500                    EPPR3   TEMP,,AUTO
         9 001062   203650 453500                    STP3    PROREC+128,,AUTO
         9 001063   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001064   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001065   000000 701000 xent               TSX1    KFF$9TO8
         9 001066   000000 011000                    NOP     0

      500    23702                      %CNVRT9TO8(S="B$HEAD.UDCBNUM",D="GI$SETFP.UDCBNUM",SIZE=2);

  23703  9 001067   003334 470400 6                  LDP0    HD$
         9 001070   000004 236100                    LDQ     4,,PR0
         9 001071   000022 772000                    QRL     18
         9 001072   200060 756100                    STQ     TEMP,,AUTO

  23704  9 001073   000052 236000 10                 LDQ     42
         9 001074   203652 756100                    STQ     PROREC+130,,AUTO
         9 001075   200014 236100                    LDQ     SETFP$,,AUTO
         9 001076   000025 036003                    ADLQ    21,DU
         9 001077   203651 756100                    STQ     PROREC+129,,AUTO
         9 001100   200060 631500                    EPPR1   TEMP,,AUTO
         9 001101   203650 451500                    STP1    PROREC+128,,AUTO
         9 001102   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001103   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001104   000000 701000 xent               TSX1    KFF$9TO8
         9 001105   000000 011000                    NOP     0

      501    23706                      %CNVRT9TO8(S="B$HEAD.DCBRES",D="GI$SETFP.DCBRES",SIZE=2);

  23707  9 001106   003334 470400 6                  LDP0    HD$
         9 001107   000004 236100                    LDQ     4,,PR0
         9 001110   777777 376007                    ANQ     -1,DL
         9 001111   200060 756100                    STQ     TEMP,,AUTO

  23708  9 001112   000052 236000 10                 LDQ     42
         9 001113   203652 756100                    STQ     PROREC+130,,AUTO
         9 001114   200014 236100                    LDQ     SETFP$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:91   
         9 001115   000055 036000 10                 ADLQ    45
         9 001116   203651 756100                    STQ     PROREC+129,,AUTO
         9 001117   200060 631500                    EPPR1   TEMP,,AUTO
         9 001120   203650 451500                    STP1    PROREC+128,,AUTO
         9 001121   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001122   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001123   000000 701000 xent               TSX1    KFF$9TO8
         9 001124   000000 011000                    NOP     0

      502    23710                      %CNVRT9TO8(S="B$HEAD.TCBSIZE",D="GI$SETFP.TCBSIZE",SIZE=2);

  23711  9 001125   003334 470400 6                  LDP0    HD$
         9 001126   000005 236100                    LDQ     5,,PR0
         9 001127   777777 376007                    ANQ     -1,DL
         9 001130   200060 756100                    STQ     TEMP,,AUTO

  23712  9 001131   000052 236000 10                 LDQ     42
         9 001132   203652 756100                    STQ     PROREC+130,,AUTO
         9 001133   200014 236100                    LDQ     SETFP$,,AUTO
         9 001134   000026 036003                    ADLQ    22,DU
         9 001135   203651 756100                    STQ     PROREC+129,,AUTO
         9 001136   200060 631500                    EPPR1   TEMP,,AUTO
         9 001137   203650 451500                    STP1    PROREC+128,,AUTO
         9 001140   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001141   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001142   000000 701000 xent               TSX1    KFF$9TO8
         9 001143   000000 011000                    NOP     0

      503    23714                      %CNVRT9TO8(S="B$HEAD.VPPGS",D="GI$SETFP.VPPGS",SIZE=2);

  23715  9 001144   003334 470400 6                  LDP0    HD$
         9 001145   000001 236100                    LDQ     1,,PR0
         9 001146   000026 772000                    QRL     22
         9 001147   200060 756100                    STQ     TEMP,,AUTO

  23716  9 001150   000052 236000 10                 LDQ     42
         9 001151   203652 756100                    STQ     PROREC+130,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:92   
         9 001152   200014 236100                    LDQ     SETFP$,,AUTO
         9 001153   000056 036000 10                 ADLQ    46
         9 001154   203651 756100                    STQ     PROREC+129,,AUTO
         9 001155   200060 631500                    EPPR1   TEMP,,AUTO
         9 001156   203650 451500                    STP1    PROREC+128,,AUTO
         9 001157   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001160   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001161   000000 701000 xent               TSX1    KFF$9TO8
         9 001162   000000 011000                    NOP     0

      504    23718                      %CNVRT9TO8(S="B$HEAD.VDPGS",D="GI$SETFP.VDPGS",SIZE=2);

  23719  9 001163   003334 470400 6                  LDP0    HD$
         9 001164   000002 236100                    LDQ     2,,PR0
         9 001165   000026 772000                    QRL     22
         9 001166   200060 756100                    STQ     TEMP,,AUTO

  23720  9 001167   000052 236000 10                 LDQ     42
         9 001170   203652 756100                    STQ     PROREC+130,,AUTO
         9 001171   200014 236100                    LDQ     SETFP$,,AUTO
         9 001172   000027 036003                    ADLQ    23,DU
         9 001173   203651 756100                    STQ     PROREC+129,,AUTO
         9 001174   200060 631500                    EPPR1   TEMP,,AUTO
         9 001175   203650 451500                    STP1    PROREC+128,,AUTO
         9 001176   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001177   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001200   000000 701000 xent               TSX1    KFF$9TO8
         9 001201   000000 011000                    NOP     0

      505    23722                      %CNVRT9TO8(S="B$HEAD.ROSIZE",D="GI$SETFP.ROS_SZ",SIZE=2);

  23723  9 001202   003334 470400 6                  LDP0    HD$
         9 001203   000010 236100                    LDQ     8,,PR0
         9 001204   777777 376007                    ANQ     -1,DL
         9 001205   200060 756100                    STQ     TEMP,,AUTO

  23724  9 001206   000052 236000 10                 LDQ     42
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:93   
         9 001207   203652 756100                    STQ     PROREC+130,,AUTO
         9 001210   200014 236100                    LDQ     SETFP$,,AUTO
         9 001211   000057 036000 10                 ADLQ    47
         9 001212   203651 756100                    STQ     PROREC+129,,AUTO
         9 001213   200060 631500                    EPPR1   TEMP,,AUTO
         9 001214   203650 451500                    STP1    PROREC+128,,AUTO
         9 001215   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001216   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001217   000000 701000 xent               TSX1    KFF$9TO8
         9 001220   000000 011000                    NOP     0

      506    23726                      %CNVRT9TO8(S="B$HEAD.RDATA",D="GI$SETFP.DATA_SZ",SIZE=4);

  23727  9 001221   003334 470400 6                  LDP0    HD$
         9 001222   000002 236100                    LDQ     2,,PR0
         9 001223   000054 376000 10                 ANQ     44
         9 001224   200060 756100                    STQ     TEMP,,AUTO

  23728  9 001225   000025 236000 10                 LDQ     21
         9 001226   203652 756100                    STQ     PROREC+130,,AUTO
         9 001227   200014 236100                    LDQ     SETFP$,,AUTO
         9 001230   000030 036003                    ADLQ    24,DU
         9 001231   203651 756100                    STQ     PROREC+129,,AUTO
         9 001232   200060 631500                    EPPR1   TEMP,,AUTO
         9 001233   203650 451500                    STP1    PROREC+128,,AUTO
         9 001234   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001235   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001236   000000 701000 xent               TSX1    KFF$9TO8
         9 001237   000000 011000                    NOP     0

      507    23730                      %CNVRT9TO8(S="B$HEAD.RPROC",D="GI$SETFP.PROC_SZ",SIZE=4);

  23731  9 001240   003334 470400 6                  LDP0    HD$
         9 001241   000001 236100                    LDQ     1,,PR0
         9 001242   000054 376000 10                 ANQ     44
         9 001243   200060 756100                    STQ     TEMP,,AUTO

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:94   
  23732  9 001244   000025 236000 10                 LDQ     21
         9 001245   203652 756100                    STQ     PROREC+130,,AUTO
         9 001246   200014 236100                    LDQ     SETFP$,,AUTO
         9 001247   000031 036003                    ADLQ    25,DU
         9 001250   203651 756100                    STQ     PROREC+129,,AUTO
         9 001251   200060 631500                    EPPR1   TEMP,,AUTO
         9 001252   203650 451500                    STP1    PROREC+128,,AUTO
         9 001253   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001254   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001255   000000 701000 xent               TSX1    KFF$9TO8
         9 001256   000000 011000                    NOP     0

      508    23734                      %CNVRT9TO8(S="B$HEAD.BIAS",D="GI$SETFP.DATA_BIAS",SIZE=4);

  23735  9 001257   003334 470400 6                  LDP0    HD$
         9 001260   000023 236100                    LDQ     19,,PR0
         9 001261   000054 376000 10                 ANQ     44
         9 001262   200060 756100                    STQ     TEMP,,AUTO

  23736  9 001263   000025 236000 10                 LDQ     21
         9 001264   203652 756100                    STQ     PROREC+130,,AUTO
         9 001265   200014 236100                    LDQ     SETFP$,,AUTO
         9 001266   000032 036003                    ADLQ    26,DU
         9 001267   203651 756100                    STQ     PROREC+129,,AUTO
         9 001270   200060 631500                    EPPR1   TEMP,,AUTO
         9 001271   203650 451500                    STP1    PROREC+128,,AUTO
         9 001272   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001273   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001274   000000 701000 xent               TSX1    KFF$9TO8
         9 001275   000000 011000                    NOP     0

      509    23738    3                 IF KL_FEPHNDLR.HANDLER(J) = 'NODEADMN'

  23738  9 001276   200041 235100                    LDA     J,,AUTO
         9 001277   000001 735000                    ALS     1
         9 001300   003532 237005 6                  LDAQ    KL_FEPHNDLR+4,AL
         9 001301   000026 117000 7                  CMPAQ   KL_NETWORK_KEY+4
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:95   
         9 001302   002131 601000 9                  TNZ     s:23874

      510    23739    4                 THEN DO;

      511    23740    4                    PARAM$ = NEXT$;

  23740  9 001303   200052 236100                    LDQ     NEXT$,,AUTO
         9 001304   200015 756100                    STQ     PARAM$,,AUTO

      512    23741    4                    PARAMOFFSET = POFFW(PARAM$,BEGIN$);

  23741  9 001305   200053 235100                    LDA     BEGIN$,,AUTO
         9 001306   000022 771000                    ARL     18
         9 001307   203650 755100                    STA     PROREC+128,,AUTO
         9 001310   200015 236100                    LDQ     PARAM$,,AUTO
         9 001311   000022 772000                    QRL     18
         9 001312   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 001313   200035 756100                    STQ     PARAMOFFSET,,AUTO

      513    23742    4                    CALL STORVAL(GI$SETFP.OFFSET_DS1,PARAMOFFSET,4);

  23742  9 001314   000025 236000 10                 LDQ     21
         9 001315   202705 756100                    STQ     @L66WD+1,,AUTO
         9 001316   200035 630500                    EPPR0   PARAMOFFSET,,AUTO
         9 001317   202704 450500                    STP0    @L6DW+1,,AUTO
         9 001320   200014 236100                    LDQ     SETFP$,,AUTO
         9 001321   000052 036003                    ADLQ    42,DU
         9 001322   202703 756100                    STQ     VDPGS+2,,AUTO
         9 001323   004512 701000 9                  TSX1    STORVAL
         9 001324   000000 011000                    NOP     0

      514    23743    4                    SVNEXT$ = NEXT$;

  23743  9 001325   200052 236100                    LDQ     NEXT$,,AUTO
         9 001326   200054 756100                    STQ     SVNEXT$,,AUTO

      515    23744
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:96   
      516    23745        /*
      517    23746             The structure of the data segment is:
      518    23747
      519    23748             .A000   NHANDLES UBIN(32)
      520    23749             .A002   HANDLER1_CONTROL_OFFSET UBIN(32)
      521    23750             .A004   HANDLER2_CONTROL_OFFSET UBIN(32)
      522    23751               .
      523    23752               .
      524    23753               .
      525    23754             .A000 + NHANDLERS*2 HANDLERn_CONTROL_OFFSET UBIN(32)
      526    23755             .A000 + NHANDLERS*2 + 2 OFFSET TO CONFIGURATION INFOMATIION.
      527    23756
      528    23757         */
      529    23758    4                    CALL GETSEG(PARAM$,NHANDLERS*(SIZEW(KL$CONTROL_INIT)+1)+2);

  23758  9 001327   200046 236100                    LDQ     NHANDLERS,,AUTO
         9 001330   000066 402007                    MPY     54,DL
         9 001331   000002 036007                    ADLQ    2,DL
         9 001332   203662 756100                    STQ     PROREC+138,,AUTO
         9 001333   203662 630500                    EPPR0   PROREC+138,,AUTO
         9 001334   203444 450500                    STP0    @TERMID+1,,AUTO
         9 001335   200015 631500                    EPPR1   PARAM$,,AUTO
         9 001336   203443 451500                    STP1    NOHEADER+3,,AUTO
         9 001337   004316 701000 9                  TSX1    GETSEG
         9 001340   000000 011000                    NOP     0

      530    23759    4                    CALL STORVAL(PARAM$->ONEWORD,NHANDLERS,4);

  23759  9 001341   000025 236000 10                 LDQ     21
         9 001342   202705 756100                    STQ     @L66WD+1,,AUTO
         9 001343   200046 630500                    EPPR0   NHANDLERS,,AUTO
         9 001344   202704 450500                    STP0    @L6DW+1,,AUTO
         9 001345   200015 236100                    LDQ     PARAM$,,AUTO
         9 001346   202703 756100                    STQ     VDPGS+2,,AUTO
         9 001347   004512 701000 9                  TSX1    STORVAL
         9 001350   000000 011000                    NOP     0

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:97   
      531    23760    4                    PARAM$ = PINCRW(PARAM$,2+NHANDLERS);

  23760  9 001351   200046 236100                    LDQ     NHANDLERS,,AUTO
         9 001352   000022 736000                    QLS     18
         9 001353   000002 036003                    ADLQ    2,DU
         9 001354   200015 036100                    ADLQ    PARAM$,,AUTO
         9 001355   200015 756100                    STQ     PARAM$,,AUTO

      532    23761    4                    NEXT$ = PINCRW(NEXT$,NHANDLERS*(SIZEW(KL$CONTROL_INIT)+1)+2);

  23761  9 001356   200046 236100                    LDQ     NHANDLERS,,AUTO
         9 001357   000066 402003                    MPY     54,DU
         9 001360   000002 036003                    ADLQ    2,DU
         9 001361   200052 036100                    ADLQ    NEXT$,,AUTO
         9 001362   200052 756100                    STQ     NEXT$,,AUTO

      533    23762    4                    CALL STORVAL(PINCRW(SVNEXT$,NHANDLERS+1)->ONEWORD,POFFC(NEXT$,
             23762                             SVNEXT$)/2,4);

  23762  9 001363   200054 236100                    LDQ     SVNEXT$,,AUTO
         9 001364   000020 772000                    QRL     16
         9 001365   203650 756100                    STQ     PROREC+128,,AUTO
         9 001366   200052 236100                    LDQ     NEXT$,,AUTO
         9 001367   000020 772000                    QRL     16
         9 001370   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 001371   000002 506007                    DIV     2,DL
         9 001372   203663 756100                    STQ     PROREC+139,,AUTO
         9 001373   000025 236000 10                 LDQ     21
         9 001374   202705 756100                    STQ     @L66WD+1,,AUTO
         9 001375   203663 630500                    EPPR0   PROREC+139,,AUTO
         9 001376   202704 450500                    STP0    @L6DW+1,,AUTO
         9 001377   200046 236100                    LDQ     NHANDLERS,,AUTO
         9 001400   000022 736000                    QLS     18
         9 001401   000001 036003                    ADLQ    1,DU
         9 001402   200054 036100                    ADLQ    SVNEXT$,,AUTO
         9 001403   202703 756100                    STQ     VDPGS+2,,AUTO
         9 001404   004512 701000 9                  TSX1    STORVAL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:98   
         9 001405   000000 011000                    NOP     0

      534    23763    4                    READ_NETCON.BUF_ = VECTOR (KL_HNDLR);

  23763  9 001406   000044 237000 10                 LDAQ    36
         9 001407   002602 757000 6                  STAQ    READ_NETCON+4

      535    23764    4                    READ_NETCON.KEY_ = VECTOR (KEY_HNDLR);

  23764  9 001410   000042 237000 10                 LDAQ    34
         9 001411   002600 757000 6                  STAQ    READ_NETCON+2

      536    23765
      537    23766        /* Read in each of the handler records and create a KL_CONTROL */
      538    23767    4                    SKP_HNDLR = 0;

  23767  9 001412   200044 450100                    STZ     SKP_HNDLR,,AUTO

      539    23768    5                    DO I = 0 TO KL_FEPHNDLR.NHANDLERS - 1;

  23768  9 001413   200040 450100                    STZ     I,,AUTO
         9 001414   001767 710000 9                  TRA     s:23852+1

      540    23769    6   HNDLR_SRCH:         DO;

  23769  9 001415                       HNDLR_SRCH   null
      541    23770    7                          IF KL_FEPHNDLR.BOOTIME(I) = '0'B THEN DO;

  23770  9 001415   200040 235100                    LDA     I,,AUTO
         9 001416   001420 605000 9                  TPL     HNDLR_SRCH+3
         9 001417   000044 035003                    ADLA    36,DU
         9 001420   000000 066405                    CMPB    filb='0'B
         9 001421   003531 000001 6                  BDSC    KL_FEPHNDLR+3,A          by=0,bit=0,n=1
         9 001422   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 001423   001430 601000 9                  TNZ     s:23774

      542    23771    7                             SKP_HNDLR = SKP_HNDLR + 1;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:99   

  23771  9 001424   200044 235100                    LDA     SKP_HNDLR,,AUTO
         9 001425   000001 035007                    ADLA    1,DL
         9 001426   200044 755100                    STA     SKP_HNDLR,,AUTO

      543    23772    7                             EXIT HNDLR_SRCH;

  23772  9 001427   001766 710000 9                  TRA     s:23852

      544    23773    7                             END;
      545    23774    6                          CALL STORVAL(PINCRW(SVNEXT$,1+I-SKP_HNDLR)->ONEWORD,POFFC(
             23774                                   PARAM$,SVNEXT$)/2,4);

  23774  9 001430   200040 236100                    LDQ     I,,AUTO
         9 001431   200044 136100                    SBLQ    SKP_HNDLR,,AUTO
         9 001432   203650 756100                    STQ     PROREC+128,,AUTO
         9 001433   200054 236100                    LDQ     SVNEXT$,,AUTO
         9 001434   000020 772000                    QRL     16
         9 001435   203651 756100                    STQ     PROREC+129,,AUTO
         9 001436   200015 236100                    LDQ     PARAM$,,AUTO
         9 001437   000020 772000                    QRL     16
         9 001440   203651 136100                    SBLQ    PROREC+129,,AUTO
         9 001441   000002 506007                    DIV     2,DL
         9 001442   203664 756100                    STQ     PROREC+140,,AUTO
         9 001443   000025 236000 10                 LDQ     21
         9 001444   202705 756100                    STQ     @L66WD+1,,AUTO
         9 001445   203664 630500                    EPPR0   PROREC+140,,AUTO
         9 001446   202704 450500                    STP0    @L6DW+1,,AUTO
         9 001447   203650 236100                    LDQ     PROREC+128,,AUTO
         9 001450   000022 736000                    QLS     18
         9 001451   000001 036003                    ADLQ    1,DU
         9 001452   200054 036100                    ADLQ    SVNEXT$,,AUTO
         9 001453   202703 756100                    STQ     VDPGS+2,,AUTO
         9 001454   004512 701000 9                  TSX1    STORVAL
         9 001455   000000 011000                    NOP     0

      546    23775    6                          KEY_HNDLR.HNDLR = KL_FEPHNDLR.HANDLER(I);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:100  

  23775  9 001456   200040 235100                    LDA     I,,AUTO
         9 001457   000003 735000                    ALS     3
         9 001460   040000 100405                    MLR     fill='040'O
         9 001461   003532 000010 6                  ADSC9   KL_FEPHNDLR+4,A          cn=0,n=8
         9 001462   003650 600010 6                  ADSC9   KEY_HNDLR                cn=3,n=8

      547    23776    6                          KL$CONTROL_INIT = '0'B;

  23776  9 001463   200015 470500                    LDP0    PARAM$,,AUTO
         9 001464   000100 100400                    MLR     fill='000'O
         9 001465   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 001466   000000 000324                    ADSC9   0,,PR0                   cn=0,n=212

      548    23777    6                          KL$CONTROL_INIT.CODE = IGA_CONTROL_INIT;

  23777  9 001467   200015 470500                    LDP0    PARAM$,,AUTO
         9 001470   042000 236003                    LDQ     17408,DU
         9 001471   000000 552140                    STBQ    0,'40'O,PR0

      549    23778    6                          KL$CONTROL_INIT.HANDLER = KEY_HNDLR.HNDLR;

  23778  9 001472   200015 470500                    LDP0    PARAM$,,AUTO
         9 001473   040100 100400                    MLR     fill='040'O
         9 001474   003650 600010 6                  ADSC9   KEY_HNDLR                cn=3,n=8
         9 001475   000001 000010                    ADSC9   1,,PR0                   cn=0,n=8

      550    23779    6                          CALL M$READ (READ_NETCON)

  23779  9 001476   002576 630400 6                  EPPR0   READ_NETCON
         9 001477   440000 713400                    CLIMB   alt,read
         9 001500   401400 401760                    pmme    nvectors=4
         9 001501   001763 702000 9                  TSX2    s:23850

      551    23780    7                          WHENRETURN DO;

      552    23781    7                             IF KL_HNDLR.NPARAMS ~= 0
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:101  

  23781  9 001502   003572 236000 6                  LDQ     KL_HNDLR+12
         9 001503   777000 316007                    CANQ    -512,DL
         9 001504   001763 600000 9                  TZE     s:23850

      553    23782    8                             THEN DO;

      554    23783    8                                KL$CONTROL_INIT.TYPE = 1;

  23783  9 001505   200015 470500                    LDP0    PARAM$,,AUTO
         9 001506   000001 236003                    LDQ     1,DU
         9 001507   000000 552120                    STBQ    0,'20'O,PR0

      555    23784    8                                KL$CONTROL_INIT.NUM_FPARAM = KL_HNDLR.NPARAMS;

  23784  9 001510   003572 236000 6                  LDQ     KL_HNDLR+12
         9 001511   000011 772000                    QRL     9
         9 001512   000777 376007                    ANQ     511,DL
         9 001513   000000 620006                    EAX0    0,QL
         9 001514   200015 470500                    LDP0    PARAM$,,AUTO
         9 001515   000011 740100                    STX0    9,,PR0

      556    23785    8                                KL$CONTROL_INIT.NUM_IPARAM = KL_HNDLR.NPARAMI;

  23785  9 001516   003572 720000 6                  LXL0    KL_HNDLR+12
         9 001517   000777 360003                    ANX0    511,DU
         9 001520   200015 470500                    LDP0    PARAM$,,AUTO
         9 001521   000011 440100                    SXL0    9,,PR0

      557    23786    9                                DO K = 0 TO KL_HNDLR.NPARAMS - 1;

  23786  9 001522   200042 450100                    STZ     K,,AUTO
         9 001523   001557 710000 9                  TRA     s:23798+1

      558    23787    9                                   IF K = %KL_HNDLRPARM_RES

  23787  9 001524   200042 235100                    LDA     K,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:102  
         9 001525   000003 115007                    CMPA    3,DL
         9 001526   001535 601000 9                  TNZ     s:23794

      559    23788    9                                   THEN
      560    23789    9                                      KL$CONTROL_INIT.FPARAM(K) = KL_HNDLR.PARAMS(K);

  23789  9 001527   000001 735000                    ALS     1
         9 001530   200015 470500                    LDP0    PARAM$,,AUTO
         9 001531   000105 100405                    MLR     fill='000'O
         9 001532   003573 000002 6                  ADSC9   KL_HNDLR+13,A            cn=0,n=2
         9 001533   000012 000002                    ADSC9   10,A,PR0                 cn=0,n=2
         9 001534   001556 710000 9                  TRA     s:23798

      561    23790   10                                   ELSE DO;

      562    23791                                           %CNVRT9TO8(S="KL_HNDLR.PARAMS(K)",
      563    23792                                           D="KL$CONTROL_INIT.FPARAM(K)",
      564    23793                                           SIZE=2);

  23794  9 001535   000001 735000                    ALS     1
         9 001536   000100 101405                    MRL     fill='000'O
         9 001537   003573 000002 6                  ADSC9   KL_HNDLR+13,A            cn=0,n=2
         9 001540   200060 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

  23795  9 001541   000052 236000 10                 LDQ     42
         9 001542   203652 756100                    STQ     PROREC+130,,AUTO
         9 001543   200042 236100                    LDQ     K,,AUTO
         9 001544   000021 736000                    QLS     17
         9 001545   000012 036003                    ADLQ    10,DU
         9 001546   200015 036100                    ADLQ    PARAM$,,AUTO
         9 001547   203651 756100                    STQ     PROREC+129,,AUTO
         9 001550   200060 630500                    EPPR0   TEMP,,AUTO
         9 001551   203650 450500                    STP0    PROREC+128,,AUTO
         9 001552   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001553   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001554   000000 701000 xent               TSX1    KFF$9TO8
         9 001555   000000 011000                    NOP     0
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:103  

      565    23797   10                                      END;

      566    23798    9                                   END;

  23798  9 001556   200042 054100                    AOS     K,,AUTO
         9 001557   003572 236000 6                  LDQ     KL_HNDLR+12
         9 001560   000011 772000                    QRL     9
         9 001561   000777 376007                    ANQ     511,DL
         9 001562   200042 116100                    CMPQ    K,,AUTO
         9 001563   001524 605400 9                  TPNZ    s:23787

      567    23799
      568    23800    8                                IF KL_HNDLR.NPARAMI ~= 0

  23800  9 001564   003572 236000 6                  LDQ     KL_HNDLR+12
         9 001565   000777 316007                    CANQ    511,DL
         9 001566   001763 600000 9                  TZE     s:23850

      569    23801    9                                THEN DO;

      570    23802    9                                   IPARAM$ = ADDR(KL$CONTROL_INIT.FPARAM(0));

  23802  9 001567   200015 236100                    LDQ     PARAM$,,AUTO
         9 001570   000012 036003                    ADLQ    10,DU
         9 001571   200024 756100                    STQ     IPARAM$,,AUTO

      571    23803    9                                   IPARAM$ = PINCRC(IPARAM$,KL_HNDLR.NPARAMS*2);

  23803  9 001572   003572 236000 6                  LDQ     KL_HNDLR+12
         9 001573   000011 772000                    QRL     9
         9 001574   000777 376007                    ANQ     511,DL
         9 001575   000021 736000                    QLS     17
         9 001576   200024 036100                    ADLQ    IPARAM$,,AUTO
         9 001577   200024 756100                    STQ     IPARAM$,,AUTO

      572    23804    9                                  OUT$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.IPARAM(0
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:104  
             23804                                            ))*KL_HNDLR.NPARAMI);

  23804  9 001600   003572 720000 6                  LXL0    KL_HNDLR+12
         9 001601   000777 360003                    ANX0    511,DU
         9 001602   000000 636010                    EAQ     0,X0
         9 001603   200024 036100                    ADLQ    IPARAM$,,AUTO
         9 001604   200023 756100                    STQ     OUT$,,AUTO

      573    23805
      574    23806   10                                   DO INDX=0 TO KL_HNDLR.NPARAMI - 1;

  23806  9 001605   200025 450100                    STZ     INDX,,AUTO
         9 001606   001756 710000 9                  TRA     s:23846+3

      575    23807   10                                      OFFSET = POFFC(OUT$,PARAM$);

  23807  9 001607   200015 236100                    LDQ     PARAM$,,AUTO
         9 001610   000020 772000                    QRL     16
         9 001611   203650 756100                    STQ     PROREC+128,,AUTO
         9 001612   200023 236100                    LDQ     OUT$,,AUTO
         9 001613   000020 772000                    QRL     16
         9 001614   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 001615   200026 756100                    STQ     OFFSET,,AUTO

      576    23808   10                                      IN$ = PINCRW(ADDR(KL_HNDLR),

  23808  9 001616   200025 720100                    LXL0    INDX,,AUTO
         9 001617   003612 221010 6                  LDX1    KL_HNDLR+28,X0
         9 001620   003556 630411 6                  EPPR0   KL_HNDLR,X1
         9 001621   200022 450500                    STP0    IN$,,AUTO

      577    23809   10                                        KL_HNDLR.IPARAM.OFFSET(INDX));
      578    23810
      579    23811   10                                      ARRAY_WDSZ = (((KL_HNDLR.IPARAM.ARRAY_SZ(INDX) +
             23811                                               1) * 2)+ 3)/4;

  23811  9 001622   003611 236010 6                  LDQ     KL_HNDLR+27,X0
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:105  
         9 001623   000010 772000                    QRL     8
         9 001624   001776 376007                    ANQ     1022,DL
         9 001625   000005 036007                    ADLQ    5,DL
         9 001626   000002 772000                    QRL     2
         9 001627   200027 756100                    STQ     ARRAY_WDSZ,,AUTO

      580    23812
      581    23813                                           %CNVRT9TO8(S="KL_HNDLR.IPARAM.ARRAY_SZ(INDX)",
      582    23814                                           D="IPARAM$->B$BYTE",
      583    23815                                           SIZE=1);

  23816  9 001630   003611 236010 6                  LDQ     KL_HNDLR+27,X0
         9 001631   000011 772000                    QRL     9
         9 001632   000777 376007                    ANQ     511,DL
         9 001633   200060 756100                    STQ     TEMP,,AUTO

  23817  9 001634   000024 236000 10                 LDQ     20
         9 001635   203652 756100                    STQ     PROREC+130,,AUTO
         9 001636   200024 236100                    LDQ     IPARAM$,,AUTO
         9 001637   203651 756100                    STQ     PROREC+129,,AUTO
         9 001640   200060 631500                    EPPR1   TEMP,,AUTO
         9 001641   203650 451500                    STP1    PROREC+128,,AUTO
         9 001642   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001643   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001644   000000 701000 xent               TSX1    KFF$9TO8
         9 001645   000000 011000                    NOP     0

      584    23819   10                                      IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.
             23819                                               IPARAM.ARRAY_SZ(0)));

  23819  9 001646   200024 236100                    LDQ     IPARAM$,,AUTO
         9 001647   200000 036007                    ADLQ    65536,DL
         9 001650   200024 756100                    STQ     IPARAM$,,AUTO

      585    23820
      586    23821                                           %CNVRT9TO8(S="KL_HNDLR.IPARAM.PARAM_SZ(INDX)",
      587    23822                                           D="IPARAM$->B$BYTE",
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:106  
      588    23823                                           SIZE=1);

  23824  9 001651   200025 720100                    LXL0    INDX,,AUTO
         9 001652   003611 236010 6                  LDQ     KL_HNDLR+27,X0
         9 001653   000777 376007                    ANQ     511,DL
         9 001654   200060 756100                    STQ     TEMP,,AUTO

  23825  9 001655   000024 236000 10                 LDQ     20
         9 001656   203652 756100                    STQ     PROREC+130,,AUTO
         9 001657   200024 236100                    LDQ     IPARAM$,,AUTO
         9 001660   203651 756100                    STQ     PROREC+129,,AUTO
         9 001661   200060 630500                    EPPR0   TEMP,,AUTO
         9 001662   203650 450500                    STP0    PROREC+128,,AUTO
         9 001663   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001664   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001665   000000 701000 xent               TSX1    KFF$9TO8
         9 001666   000000 011000                    NOP     0

      589    23827   10                                      IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.
             23827                                               IPARAM.PARAM_SZ(0)));

  23827  9 001667   200024 236100                    LDQ     IPARAM$,,AUTO
         9 001670   200000 036007                    ADLQ    65536,DL
         9 001671   200024 756100                    STQ     IPARAM$,,AUTO

      590    23828                                           %CNVRT9TO8(S="OFFSET",
      591    23829                                           D="IPARAM$->B$HALF",
      592    23830                                           SIZE=2);

  23831  9 001672   200026 235100                    LDA     OFFSET,,AUTO
         9 001673   200060 755100                    STA     TEMP,,AUTO

  23832  9 001674   000052 236000 10                 LDQ     42
         9 001675   203652 756100                    STQ     PROREC+130,,AUTO
         9 001676   200024 236100                    LDQ     IPARAM$,,AUTO
         9 001677   203651 756100                    STQ     PROREC+129,,AUTO
         9 001700   200060 630500                    EPPR0   TEMP,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:107  
         9 001701   203650 450500                    STP0    PROREC+128,,AUTO
         9 001702   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001703   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001704   000000 701000 xent               TSX1    KFF$9TO8
         9 001705   000000 011000                    NOP     0

      593    23834   10                                      IPARAM$ = PINCRC(IPARAM$,SIZEC(KL$CONTROL_INIT.
             23834                                               IPARAM.OFFSET(0)));

  23834  9 001706   200024 236100                    LDQ     IPARAM$,,AUTO
         9 001707   400000 036007                    ADLQ    -131072,DL
         9 001710   200024 756100                    STQ     IPARAM$,,AUTO

      594    23835   11                                      DO K=0 TO KL_HNDLR.IPARAM.ARRAY_SZ(INDX);

  23835  9 001711   200042 450100                    STZ     K,,AUTO
         9 001712   001741 710000 9                  TRA     s:23842+1

      595    23836                                              %CNVRT9TO8(S="IN$->B$PARAMI(K)",
      596    23837                                              D="OUT$->B$PARAMI(K)",
      597    23838                                              SIZE=2);

  23839  9 001713   200042 236100                    LDQ     K,,AUTO
         9 001714   000022 402007                    MPY     18,DL
         9 001715   000000 116003                    CMPQ    0,DU
         9 001716   001720 605000 9                  TPL     s:23839+5
         9 001717   000044 036003                    ADLQ    36,DU
         9 001720   200022 470500                    LDP0    IN$,,AUTO
         9 001721   003100 061506                    CSR     bolr='003'O
         9 001722   000000 000022                    BDSC    0,Q,PR0                  by=0,bit=0,n=18
         9 001723   200060 000044                    BDSC    TEMP,,AUTO               by=0,bit=0,n=36

  23840  9 001724   000052 236000 10                 LDQ     42
         9 001725   203652 756100                    STQ     PROREC+130,,AUTO
         9 001726   200042 236100                    LDQ     K,,AUTO
         9 001727   000021 736000                    QLS     17
         9 001730   200023 036100                    ADLQ    OUT$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:108  
         9 001731   203651 756100                    STQ     PROREC+129,,AUTO
         9 001732   200060 631500                    EPPR1   TEMP,,AUTO
         9 001733   203650 451500                    STP1    PROREC+128,,AUTO
         9 001734   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 001735   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 001736   000000 701000 xent               TSX1    KFF$9TO8
         9 001737   000000 011000                    NOP     0

      598    23842   11                                         END;

  23842  9 001740   200042 054100                    AOS     K,,AUTO
         9 001741   200025 720100                    LXL0    INDX,,AUTO
         9 001742   003611 236010 6                  LDQ     KL_HNDLR+27,X0
         9 001743   000011 772000                    QRL     9
         9 001744   000777 376007                    ANQ     511,DL
         9 001745   200042 116100                    CMPQ    K,,AUTO
         9 001746   001713 605000 9                  TPL     s:23839

      599    23843
      600    23844   10                                      OUT$ = PINCRW(OUT$,ARRAY_WDSZ);

  23844  9 001747   200027 236100                    LDQ     ARRAY_WDSZ,,AUTO
         9 001750   000022 736000                    QLS     18
         9 001751   200023 036100                    ADLQ    OUT$,,AUTO
         9 001752   200023 756100                    STQ     OUT$,,AUTO

      601    23845
      602    23846   10                                      END /*do INDX=0 to .NPARAMI-1*/;

  23846  9 001753   200025 235100                    LDA     INDX,,AUTO
         9 001754   000001 035007                    ADLA    1,DL
         9 001755   200025 755100                    STA     INDX,,AUTO
         9 001756   003572 236000 6                  LDQ     KL_HNDLR+12
         9 001757   000777 376007                    ANQ     511,DL
         9 001760   200025 116100                    CMPQ    INDX,,AUTO
         9 001761   001763 600000 9                  TZE     s:23850
         9 001762   001607 603000 9                  TRC     s:23807
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:109  

      603    23847    9                                   END/* do if NPARAMI ~= 0*/;

      604    23848    8                                END/* do if NPARAMS ~= 0*/;

      605    23849    7                             END /* whenreturn do*/;

      606    23850    6                          PARAM$ = PINCRW(PARAM$,SIZEW(KL$CONTROL_INIT));

  23850  9 001763   200015 236100                    LDQ     PARAM$,,AUTO
         9 001764   000065 036003                    ADLQ    53,DU
         9 001765   200015 756100                    STQ     PARAM$,,AUTO

      607    23851    6                          END;             /* hndlr_srch */

      608    23852    5                       END/*do to NHANDLERS -1 */;

  23852  9 001766   200040 054100                    AOS     I,,AUTO
         9 001767   200040 236100                    LDQ     I,,AUTO
         9 001770   001415 604000 9                  TMI     HNDLR_SRCH
         9 001771   003526 116000 6                  CMPQ    KL_FEPHNDLR
         9 001772   001415 602000 9                  TNC     HNDLR_SRCH

      609    23853    4                    P$=NEXT$;

  23853  9 001773   200052 236100                    LDQ     NEXT$,,AUTO
         9 001774   200013 756100                    STQ     P$,,AUTO

      610    23854    4                    NEXT$=PINCRC(P$,2);

  23854  9 001775   400000 036007                    ADLQ    -131072,DL
         9 001776   200052 756100                    STQ     NEXT$,,AUTO

      611    23855    5                    CALL CONFIG_LINK(RET_ERROR) WHENALTRETURN DO;

  23855  9 001777   000060 236000 10                 LDQ     48
         9 002000   202665 756100                    STQ     KL_NETWORK+1282,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:110  
         9 002001   004655 701000 9                  TSX1    CONFIG_LINK
         9 002002   002004 702000 9                  TSX2    s:23856
         9 002003   002061 710000 9                  TRA     s:23867

      612    23856    5                       NEXT$=PINCRC(P$,2);

  23856  9 002004   200013 236100                    LDQ     P$,,AUTO
         9 002005   400000 036007                    ADLQ    -131072,DL
         9 002006   200052 756100                    STQ     NEXT$,,AUTO

      613    23857    5                       CALL KFF$9TO8((SIZEC(KL$LNK)+SIZEC(KL$CHNRSP)-1)/2,NEXT$->
             23857                                ONEWORD,2);

  23857  9 002007   000052 236000 10                 LDQ     42
         9 002010   203652 756100                    STQ     PROREC+130,,AUTO
         9 002011   200052 236100                    LDQ     NEXT$,,AUTO
         9 002012   000062 235000 10                 LDA     50
         9 002013   203650 757100                    STAQ    PROREC+128,,AUTO
         9 002014   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002015   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002016   000000 701000 xent               TSX1    KFF$9TO8
         9 002017   000000 011000                    NOP     0

      614    23858    5                       NEXT$->KL$LNK.BLKHDR.BLKTYP=%KLTY_LINK#;

  23858  9 002020   200052 470500                    LDP0    NEXT$,,AUTO
         9 002021   004000 236003                    LDQ     2048,DU
         9 002022   000001 552140                    STBQ    1,'40'O,PR0

      615    23859    5                       NEXT$->KL$LNK.BLKHDR.LEV=%TERMINAL_ID_LEV_CHAN#;

  23859  9 002023   200052 470500                    LDP0    NEXT$,,AUTO
         9 002024   001000 236003                    LDQ     512,DU
         9 002025   000000 552140                    STBQ    0,'40'O,PR0

      616    23860    5                       NEXT$=PINCRC(NEXT$,2);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:111  
  23860  9 002026   200052 236100                    LDQ     NEXT$,,AUTO
         9 002027   400000 036007                    ADLQ    -131072,DL
         9 002030   200052 756100                    STQ     NEXT$,,AUTO

      617    23861    5                       NEXT$->KL$LNK='0'B;

  23861  9 002031   200052 470500                    LDP0    NEXT$,,AUTO
         9 002032   000100 100400                    MLR     fill='000'O
         9 002033   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 002034   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48

      618    23862    5                       CALL KFF$9TO8(SIZEC(KL$LNK)+SIZEC(KL$CHNRSP)-1,NEXT$->KL$LNK.
             23862                                BLKHDR.LEN,2);

  23862  9 002035   000052 236000 10                 LDQ     42
         9 002036   203652 756100                    STQ     PROREC+130,,AUTO
         9 002037   200052 236100                    LDQ     NEXT$,,AUTO
         9 002040   400000 036007                    ADLQ    -131072,DL
         9 002041   000064 235000 10                 LDA     52
         9 002042   203650 757100                    STAQ    PROREC+128,,AUTO
         9 002043   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002044   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002045   000000 701000 xent               TSX1    KFF$9TO8
         9 002046   000000 011000                    NOP     0

      619    23863    5                       NEXT$=PINCRC(NEXT$,SIZEC(KL$LNK));

  23863  9 002047   200052 236100                    LDQ     NEXT$,,AUTO
         9 002050   000014 036003                    ADLQ    12,DU
         9 002051   200052 756100                    STQ     NEXT$,,AUTO

      620    23864    5                       NEXT$->KL$CHNRSP=KL_CHNRSP;

  23864  9 002052   200052 470500                    LDP0    NEXT$,,AUTO
         9 002053   000100 100400                    MLR     fill='000'O
         9 002054   003774 000067 6                  ADSC9   KL_CHNRSP                cn=0,n=55
         9 002055   000000 000067                    ADSC9   0,,PR0                   cn=0,n=55
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:112  

      621    23865    5                       NEXT$=PINCRC(NEXT$,SIZEC(KL$CHNRSP)-1);

  23865  9 002056   200052 236100                    LDQ     NEXT$,,AUTO
         9 002057   000065 036000 10                 ADLQ    53
         9 002060   200052 756100                    STQ     NEXT$,,AUTO

      622    23866    5                       END;

      623    23867    4                    TEMP=POFFC(NEXT$,P$)/2-1;

  23867  9 002061   200013 236100                    LDQ     P$,,AUTO
         9 002062   000020 772000                    QRL     16
         9 002063   203650 756100                    STQ     PROREC+128,,AUTO
         9 002064   200052 236100                    LDQ     NEXT$,,AUTO
         9 002065   000020 772000                    QRL     16
         9 002066   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 002067   000002 506007                    DIV     2,DL
         9 002070   000001 136007                    SBLQ    1,DL
         9 002071   200060 756100                    STQ     TEMP,,AUTO

      624    23868    4                    CALL KFF$9TO8(TEMP,P$->ONEWORD,2);

  23868  9 002072   000052 236000 10                 LDQ     42
         9 002073   203652 756100                    STQ     PROREC+130,,AUTO
         9 002074   200013 236100                    LDQ     P$,,AUTO
         9 002075   203651 756100                    STQ     PROREC+129,,AUTO
         9 002076   200060 630500                    EPPR0   TEMP,,AUTO
         9 002077   203650 450500                    STP0    PROREC+128,,AUTO
         9 002100   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002101   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002102   000000 701000 xent               TSX1    KFF$9TO8
         9 002103   000000 011000                    NOP     0

      625    23869    4                    CALL ALIGNPTR (NEXT$);

  23869  9 002104   200052 630500                    EPPR0   NEXT$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:113  
         9 002105   202665 450500                    STP0    KL_NETWORK+1282,,AUTO
         9 002106   004545 701000 9                  TSX1    ALIGNPTR
         9 002107   000000 011000                    NOP     0

      626    23870    4                    CALL STORVAL(GI$SETFP.DS1_SZ,POFFW(NEXT$,SVNEXT$)*2,4);

  23870  9 002110   200054 235100                    LDA     SVNEXT$,,AUTO
         9 002111   000022 771000                    ARL     18
         9 002112   203650 755100                    STA     PROREC+128,,AUTO
         9 002113   200052 236100                    LDQ     NEXT$,,AUTO
         9 002114   000022 772000                    QRL     18
         9 002115   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 002116   000001 736000                    QLS     1
         9 002117   203665 756100                    STQ     PROREC+141,,AUTO
         9 002120   000025 236000 10                 LDQ     21
         9 002121   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002122   203665 630500                    EPPR0   PROREC+141,,AUTO
         9 002123   202704 450500                    STP0    @L6DW+1,,AUTO
         9 002124   200014 236100                    LDQ     SETFP$,,AUTO
         9 002125   000053 036003                    ADLQ    43,DU
         9 002126   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002127   004512 701000 9                  TSX1    STORVAL
         9 002130   000000 011000                    NOP     0

      627    23871    4                    END;

      628    23872
      629    23873                                           /* Read in the library if one was spec'd */
      630    23874    3                 PROCOFFSET = 0;

  23874  9 002131   200032 450100                    STZ     PROCOFFSET,,AUTO

      631    23875    3                 DATAOFFSET = 0;

  23875  9 002132   200031 450100                    STZ     DATAOFFSET,,AUTO

      632    23876    3                 LIB_PROCSIZ = 0;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:114  

  23876  9 002133   200071 450100                    STZ     LIB_PROCSIZ,,AUTO

      633    23877    3                 LIB_DATASIZ = 0;

  23877  9 002134   200072 450100                    STZ     LIB_DATASIZ,,AUTO

      634    23878    4                 IF B$HEAD.LIBNAME.TXT ~= ' ' THEN DO;

  23878  9 002135   003334 470400 6                  LDP0    HD$
         9 002136   040000 106500                    CMPC    fill='040'O
         9 002137   000030 200037                    ADSC9   24,,PR0                  cn=1,n=31
         9 002140   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 002141   002257 600000 9                  TZE     FOUND_LIB

      635    23879    5                    DO LIBX = 0 TO NLIBS - 1;

  23879  9 002142   200067 450100                    STZ     LIBX,,AUTO
         9 002143   002171 710000 9                  TRA     s:23887+3

      636    23880    6                       IF B$HEAD.LIBNAME.TXT = LIB_TBL.NAME(LIBX) THEN DO;

  23880  9 002144   200067 236100                    LDQ     LIBX,,AUTO
         9 002145   000060 402007                    MPY     48,DL
         9 002146   003334 470400 6                  LDP0    HD$
         9 002147   040106 106500                    CMPC    fill='040'O
         9 002150   000030 200037                    ADSC9   24,,PR0                  cn=1,n=31
         9 002151   200073 000037                    ADSC9   LIB_TBL,Q,AUTO           cn=0,n=31
         9 002152   002166 601000 9                  TNZ     s:23887

      637    23881    6                          PROCOFFSET = LIB_TBL.PROCOFFSET(LIBX);

  23881  9 002153   200067 236100                    LDQ     LIBX,,AUTO
         9 002154   000014 402007                    MPY     12,DL
         9 002155   200103 235106                    LDA     LIB_TBL+8,QL,AUTO
         9 002156   200032 755100                    STA     PROCOFFSET,,AUTO

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:115  
      638    23882    6                          DATAOFFSET = LIB_TBL.DATAOFFSET(LIBX);

  23882  9 002157   200104 235106                    LDA     LIB_TBL+9,QL,AUTO
         9 002160   200031 755100                    STA     DATAOFFSET,,AUTO

      639    23883    6                          LIB_PROCSIZ = LIB_TBL.PROCSIZE(LIBX);

  23883  9 002161   200105 235106                    LDA     LIB_TBL+10,QL,AUTO
         9 002162   200071 755100                    STA     LIB_PROCSIZ,,AUTO

      640    23884    6                          LIB_DATASIZ = LIB_TBL.DATASIZE(LIBX);

  23884  9 002163   200106 235106                    LDA     LIB_TBL+11,QL,AUTO
         9 002164   200072 755100                    STA     LIB_DATASIZ,,AUTO

      641    23885    6                          GOTO FOUND_LIB;

  23885  9 002165   002257 710000 9                  TRA     FOUND_LIB

      642    23886    6                          END;             /* IF */
      643    23887    5                       END;                /* DO LIBX */

  23887  9 002166   200067 235100                    LDA     LIBX,,AUTO
         9 002167   000001 035007                    ADLA    1,DL
         9 002170   200067 755100                    STA     LIBX,,AUTO
         9 002171   200067 236100                    LDQ     LIBX,,AUTO
         9 002172   200070 116100                    CMPQ    NLIBS,,AUTO
         9 002173   002144 602000 9                  TNC     s:23880

      644    23888    4                    FPT_FID.TEXTFID_ = VECTOR(B$HEAD.LIBNAME.TXT);

  23888  9 002174   000066 235000 10                 LDA     54
         9 002175   003334 236000 6                  LDQ     HD$
         9 002176   000067 036000 10                 ADLQ    55
         9 002177   003002 757000 6                  STAQ    FPT_FID+2

      645    23889    4                    CALL M$FID(FPT_FID) ALTRET(ALT);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:116  

  23889  9 002200   003000 630400 6                  EPPR0   FPT_FID
         9 002201   420001 713400                    CLIMB   alt,+8193
         9 002202   404400 401760                    pmme    nvectors=10
         9 002203   003052 702000 9                  TSX2    ALT

      646    23890    4                    VLP_ACCT.ACCT# = KL_FEPHNDLR.DEFLIBACCT;

  23890  9 002204   040000 100400                    MLR     fill='040'O
         9 002205   003527 000010 6                  ADSC9   KL_FEPHNDLR+1            cn=0,n=8
         9 002206   003052 000010 6                  ADSC9   VLP_ACCT                 cn=0,n=8

      647    23891    4                    CALL M$OPEN(FPT_OPNRU) ALTRET(ALT);

  23891  9 002207   002650 630400 6                  EPPR0   FPT_OPNRU
         9 002210   450000 713400                    CLIMB   alt,open
         9 002211   410400 401760                    pmme    nvectors=18
         9 002212   003052 702000 9                  TSX2    ALT

      648    23892    4                    CALL READ_RU(NEXT$,%LIB) ALTRET(ALT);

  23892  9 002213   000070 236000 10                 LDQ     56
         9 002214   202666 756100                    STQ     @ERR+1,,AUTO
         9 002215   200052 630500                    EPPR0   NEXT$,,AUTO
         9 002216   202665 450500                    STP0    KL_NETWORK+1282,,AUTO
         9 002217   003463 701000 9                  TSX1    READ_RU
         9 002220   003052 702000 9                  TSX2    ALT

      649    23893                                      /* B$HEAD is now from the library just read */
      650    23894    4                    LIB_PROCSIZ = B$HEAD.RPROC;

  23894  9 002221   003334 470400 6                  LDP0    HD$
         9 002222   000001 236100                    LDQ     1,,PR0
         9 002223   000054 376000 10                 ANQ     44
         9 002224   200071 756100                    STQ     LIB_PROCSIZ,,AUTO

      651    23895    4                    LIB_DATASIZ = B$HEAD.RDATA;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:117  

  23895  9 002225   000002 236100                    LDQ     2,,PR0
         9 002226   000054 376000 10                 ANQ     44
         9 002227   200072 756100                    STQ     LIB_DATASIZ,,AUTO

      652    23896    4                    NEXT$ = PINCRW(NEXT$,WDSUSED);

  23896  9 002230   200050 236100                    LDQ     WDSUSED,,AUTO
         9 002231   000022 736000                    QLS     18
         9 002232   200052 036100                    ADLQ    NEXT$,,AUTO
         9 002233   200052 756100                    STQ     NEXT$,,AUTO

      653    23897    4                    LIB_TBL.NAME(NLIBS) = GI$SETFP.LIB_NAME.TEXT;

  23897  9 002234   200070 236100                    LDQ     NLIBS,,AUTO
         9 002235   000060 402007                    MPY     48,DL
         9 002236   200014 471500                    LDP1    SETFP$,,AUTO
         9 002237   040106 100500                    MLR     fill='040'O
         9 002240   100033 200037                    ADSC9   27,,PR1                  cn=1,n=31
         9 002241   200073 000037                    ADSC9   LIB_TBL,Q,AUTO           cn=0,n=31

      654    23898    4                    LIB_TBL.PROCOFFSET(NLIBS) = PROCOFFSET;

  23898  9 002242   200070 236100                    LDQ     NLIBS,,AUTO
         9 002243   000014 402007                    MPY     12,DL
         9 002244   200032 235100                    LDA     PROCOFFSET,,AUTO
         9 002245   200103 755106                    STA     LIB_TBL+8,QL,AUTO

      655    23899    4                    LIB_TBL.DATAOFFSET(NLIBS) = DATAOFFSET;

  23899  9 002246   200031 235100                    LDA     DATAOFFSET,,AUTO
         9 002247   200104 755106                    STA     LIB_TBL+9,QL,AUTO

      656    23900    4                    LIB_TBL.PROCSIZE(NLIBS) = LIB_PROCSIZ;

  23900  9 002250   200071 235100                    LDA     LIB_PROCSIZ,,AUTO
         9 002251   200105 755106                    STA     LIB_TBL+10,QL,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:118  

      657    23901    4                    LIB_TBL.DATASIZE(NLIBS) = LIB_DATASIZ;

  23901  9 002252   200072 235100                    LDA     LIB_DATASIZ,,AUTO
         9 002253   200106 755106                    STA     LIB_TBL+11,QL,AUTO

      658    23902    4                    NLIBS = NLIBS + 1;

  23902  9 002254   200070 235100                    LDA     NLIBS,,AUTO
         9 002255   000001 035007                    ADLA    1,DL
         9 002256   200070 755100                    STA     NLIBS,,AUTO

      659    23903    4                    END;                   /* IF LIBNAME = ' ' */

  23902  9 002257                       FOUND_LIB    null
      660    23904    3   FOUND_LIB:    ;
      661    23905                      %CNVRT9TO8(S="PROCOFFSET",D="GI$SETFP.OFFSET_LIB_PROC",SIZE=4);

  23906  9 002257   200032 235100                    LDA     PROCOFFSET,,AUTO
         9 002260   200060 755100                    STA     TEMP,,AUTO

  23907  9 002261   000025 236000 10                 LDQ     21
         9 002262   203652 756100                    STQ     PROREC+130,,AUTO
         9 002263   200014 236100                    LDQ     SETFP$,,AUTO
         9 002264   000047 036003                    ADLQ    39,DU
         9 002265   203651 756100                    STQ     PROREC+129,,AUTO
         9 002266   200060 631500                    EPPR1   TEMP,,AUTO
         9 002267   203650 451500                    STP1    PROREC+128,,AUTO
         9 002270   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002271   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002272   000000 701000 xent               TSX1    KFF$9TO8
         9 002273   000000 011000                    NOP     0

      662    23909                      %CNVRT9TO8(S="DATAOFFSET",D="GI$SETFP.OFFSET_LIB_DATA",SIZE=4);

  23910  9 002274   200031 235100                    LDA     DATAOFFSET,,AUTO
         9 002275   200060 755100                    STA     TEMP,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:119  

  23911  9 002276   000025 236000 10                 LDQ     21
         9 002277   203652 756100                    STQ     PROREC+130,,AUTO
         9 002300   200014 236100                    LDQ     SETFP$,,AUTO
         9 002301   000046 036003                    ADLQ    38,DU
         9 002302   203651 756100                    STQ     PROREC+129,,AUTO
         9 002303   200060 630500                    EPPR0   TEMP,,AUTO
         9 002304   203650 450500                    STP0    PROREC+128,,AUTO
         9 002305   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002306   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002307   000000 701000 xent               TSX1    KFF$9TO8
         9 002310   000000 011000                    NOP     0

      663    23913                      %CNVRT9TO8(S="LIB_PROCSIZ",D="GI$SETFP.LIB_PROC_SZ",SIZE=4);

  23914  9 002311   200071 235100                    LDA     LIB_PROCSIZ,,AUTO
         9 002312   200060 755100                    STA     TEMP,,AUTO

  23915  9 002313   000025 236000 10                 LDQ     21
         9 002314   203652 756100                    STQ     PROREC+130,,AUTO
         9 002315   200014 236100                    LDQ     SETFP$,,AUTO
         9 002316   000051 036003                    ADLQ    41,DU
         9 002317   203651 756100                    STQ     PROREC+129,,AUTO
         9 002320   200060 630500                    EPPR0   TEMP,,AUTO
         9 002321   203650 450500                    STP0    PROREC+128,,AUTO
         9 002322   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002323   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002324   000000 701000 xent               TSX1    KFF$9TO8
         9 002325   000000 011000                    NOP     0

      664    23917                      %CNVRT9TO8(S="LIB_DATASIZ",D="GI$SETFP.LIB_DATA_SZ",SIZE=4);

  23918  9 002326   200072 235100                    LDA     LIB_DATASIZ,,AUTO
         9 002327   200060 755100                    STA     TEMP,,AUTO

  23919  9 002330   000025 236000 10                 LDQ     21
         9 002331   203652 756100                    STQ     PROREC+130,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:120  
         9 002332   200014 236100                    LDQ     SETFP$,,AUTO
         9 002333   000050 036003                    ADLQ    40,DU
         9 002334   203651 756100                    STQ     PROREC+129,,AUTO
         9 002335   200060 630500                    EPPR0   TEMP,,AUTO
         9 002336   203650 450500                    STP0    PROREC+128,,AUTO
         9 002337   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 002340   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 002341   000000 701000 xent               TSX1    KFF$9TO8
         9 002342   000000 011000                    NOP     0

      665    23921    3                 END;                      /* hndlrs */

      666    23922    2              END;                         /* DO J */

  23922  9 002343   200041 235100                    LDA     J,,AUTO
         9 002344   000001 035007                    ADLA    1,DL
         9 002345   200041 755100                    STA     J,,AUTO
         9 002346   200041 236100                    LDQ     J,,AUTO
         9 002347   003526 116000 6                  CMPQ    KL_FEPHNDLR
         9 002350   000557 602000 9                  TNC     HNDLRS

      667    23923
      668    23924                                           /* Build GI$PARAMS into the boot image */
      669    23925    1           CALL M$MONINFO (FPT_MONINFO);

  23925  9 002351   000000 630400 7                  EPPR0   FPT_MONINFO
         9 002352   020023 713400                    CLIMB   8211
         9 002353   402400 401760                    pmme    nvectors=6

      670    23926    1           PARAM$ = NEXT$;

  23926  9 002354   200052 236100                    LDQ     NEXT$,,AUTO
         9 002355   200015 756100                    STQ     PARAM$,,AUTO

      671    23927    1           GI$OFFSETS.PARAM# = %GI_BOOT_HI;

  23927  9 002356   000017 235007                    LDA     15,DL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:121  
         9 002357   200051 470500                    LDP0    OFFSET$,,AUTO
         9 002360   000001 755100                    STA     1,,PR0

      672    23928    1           PARAMOFFSET = POFFW(PARAM$,BEGIN$);

  23928  9 002361   200053 236100                    LDQ     BEGIN$,,AUTO
         9 002362   000022 772000                    QRL     18
         9 002363   203650 756100                    STQ     PROREC+128,,AUTO
         9 002364   200015 236100                    LDQ     PARAM$,,AUTO
         9 002365   000022 772000                    QRL     18
         9 002366   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 002367   200035 756100                    STQ     PARAMOFFSET,,AUTO

      673    23929    1           CALL STORVAL(GI$OFFSETS.PARAMOFFSET,PARAMOFFSET,4);

  23929  9 002370   000025 236000 10                 LDQ     21
         9 002371   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002372   200035 630500                    EPPR0   PARAMOFFSET,,AUTO
         9 002373   202704 450500                    STP0    @L6DW+1,,AUTO
         9 002374   200051 236100                    LDQ     OFFSET$,,AUTO
         9 002375   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002376   004512 701000 9                  TSX1    STORVAL
         9 002377   000000 011000                    NOP     0

      674    23930    1           CALL GETSEG(PARAM$,SIZEW(GI$PARAMS));

  23930  9 002400   000072 236000 10                 LDQ     58
         9 002401   203444 756100                    STQ     @TERMID+1,,AUTO
         9 002402   200015 630500                    EPPR0   PARAM$,,AUTO
         9 002403   203443 450500                    STP0    NOHEADER+3,,AUTO
         9 002404   004316 701000 9                  TSX1    GETSEG
         9 002405   000000 011000                    NOP     0

      675    23931    1           NEXT$ = PINCRW(NEXT$,SIZEW(GI$PARAMS));

  23931  9 002406   200052 236100                    LDQ     NEXT$,,AUTO
         9 002407   000020 036003                    ADLQ    16,DU
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:122  
         9 002410   200052 756100                    STQ     NEXT$,,AUTO

      676    23932    1           KL_FEPBOOT.BOOTPARAMS(%GI_BOOT_NODES) = VLR_MONINFO.NUM_NODES;

  23932  9 002411   002324 235000 6                  LDA     VLR_MONINFO+12
         9 002412   003517 755000 6                  STA     KL_FEPBOOT+19

      677    23933    1           IF VLR_SITEINFO.CPU_TYPE# = %DPS8000 THEN

  23933  9 002413   002417 236000 6                  LDQ     VLR_SITEINFO+55
         9 002414   777000 376007                    ANQ     -512,DL
         9 002415   006000 116007                    CMPQ    3072,DL
         9 002416   002422 601000 9                  TNZ     s:23936

      678    23934    1              KL_FEPBOOT.BOOTPARAMS(%GI_BOOT_DPS8000FLG) = 1;

  23934  9 002417   000001 235007                    LDA     1,DL
         9 002420   003525 755000 6                  STA     KL_FEPBOOT+25
         9 002421   002423 710000 9                  TRA     s:23937

      679    23935    1           ELSE
      680    23936    1              KL_FEPBOOT.BOOTPARAMS(%GI_BOOT_DPS8000FLG) = 0;

  23936  9 002422   003525 450000 6                  STZ     KL_FEPBOOT+25

      681    23937    2           DO I = 0 TO %GI_BOOT_HI;

  23937  9 002423   200040 450100                    STZ     I,,AUTO

      682    23938    2              CALL STORVAL(GI$PARAMS.PARAMS(I),KL_FEPBOOT.BOOTPARAMS(I),4);

  23938  9 002424   000025 236000 10                 LDQ     21
         9 002425   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002426   200040 720100                    LXL0    I,,AUTO
         9 002427   003506 630410 6                  EPPR0   KL_FEPBOOT+10,X0
         9 002430   202704 450500                    STP0    @L6DW+1,,AUTO
         9 002431   200040 236100                    LDQ     I,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:123  
         9 002432   000022 736000                    QLS     18
         9 002433   200015 036100                    ADLQ    PARAM$,,AUTO
         9 002434   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002435   004512 701000 9                  TSX1    STORVAL
         9 002436   000000 011000                    NOP     0

      683    23939    2              END;                         /* DO I */

  23939  9 002437   200040 054100                    AOS     I,,AUTO
         9 002440   200040 235100                    LDA     I,,AUTO
         9 002441   000017 115007                    CMPA    15,DL
         9 002442   002424 604400 9                  TMOZ    s:23938

      684    23940
      685    23941                                 /* Build the control parameters into the boot image */
      686    23942    1           CONTROL$ = NEXT$;

  23942  9 002443   200052 236100                    LDQ     NEXT$,,AUTO
         9 002444   200016 756100                    STQ     CONTROL$,,AUTO

      687    23943    1           GI$OFFSETS.CNTL# = 0;

  23943  9 002445   200051 470500                    LDP0    OFFSET$,,AUTO
         9 002446   000003 450100                    STZ     3,,PR0

      688    23944    1           PARAMOFFSET = POFFW(CONTROL$,BEGIN$);

  23944  9 002447   200053 236100                    LDQ     BEGIN$,,AUTO
         9 002450   000022 772000                    QRL     18
         9 002451   203650 756100                    STQ     PROREC+128,,AUTO
         9 002452   200016 236100                    LDQ     CONTROL$,,AUTO
         9 002453   000022 772000                    QRL     18
         9 002454   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 002455   200035 756100                    STQ     PARAMOFFSET,,AUTO

      689    23945    1           CALL STORVAL(GI$OFFSETS.CNTLOFFSET,PARAMOFFSET,4);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:124  
  23945  9 002456   000025 236000 10                 LDQ     21
         9 002457   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002460   200035 630500                    EPPR0   PARAMOFFSET,,AUTO
         9 002461   202704 450500                    STP0    @L6DW+1,,AUTO
         9 002462   200051 236100                    LDQ     OFFSET$,,AUTO
         9 002463   000002 036003                    ADLQ    2,DU
         9 002464   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002465   004512 701000 9                  TSX1    STORVAL
         9 002466   000000 011000                    NOP     0

      690    23946    1           KEY_FEPCTL.NODE = FEX;

  23946  9 002467   200003 470500                    LDP0    @FEX,,AUTO
         9 002470   000000 236100                    LDQ     0,,PR0
         9 002471   000011 736000                    QLS     9
         9 002472   003773 552010 6                  STBQ    KEY_FEPCTL,'10'O

      691    23947    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPCTL);

  23947  9 002473   000074 237000 10                 LDAQ    60
         9 002474   002600 757000 6                  STAQ    READ_NETCON+2

      692    23948    1           READ_NETCON.BUF_ = VECTOR(KL_FEPCTL);

  23948  9 002475   000076 237000 10                 LDAQ    62
         9 002476   002602 757000 6                  STAQ    READ_NETCON+4

      693    23949    1           CALL M$READ(READ_NETCON) ALTRET(NO_CONTROL);

  23949  9 002477   002576 630400 6                  EPPR0   READ_NETCON
         9 002500   440000 713400                    CLIMB   alt,read
         9 002501   401400 401760                    pmme    nvectors=4
         9 002502   002537 702000 9                  TSX2    NO_CONTROL

      694    23950    1           CALL GETSEG(CONTROL$,SIZEW(GI$CONTROL));

  23950  9 002503   000101 236000 10                 LDQ     65
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:125  
         9 002504   203444 756100                    STQ     @TERMID+1,,AUTO
         9 002505   200016 630500                    EPPR0   CONTROL$,,AUTO
         9 002506   203443 450500                    STP0    NOHEADER+3,,AUTO
         9 002507   004316 701000 9                  TSX1    GETSEG
         9 002510   000000 011000                    NOP     0

      695    23951    1           NEXT$ = PINCRW(NEXT$,SIZEW(GI$CONTROL));

  23951  9 002511   200052 236100                    LDQ     NEXT$,,AUTO
         9 002512   000025 036003                    ADLQ    21,DU
         9 002513   200052 756100                    STQ     NEXT$,,AUTO

      696    23952    2           DO I = 0 TO %GI_CNTL_BOOTHI;

  23952  9 002514   200040 450100                    STZ     I,,AUTO

      697    23953    2              CALL STORVAL(GI$CONTROL.PARAMS(I),KL_FEPCTL.PARAMS(I),4);

  23953  9 002515   000025 236000 10                 LDQ     21
         9 002516   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002517   200040 720100                    LXL0    I,,AUTO
         9 002520   003746 630410 6                  EPPR0   KL_FEPCTL+1,X0
         9 002521   202704 450500                    STP0    @L6DW+1,,AUTO
         9 002522   200040 236100                    LDQ     I,,AUTO
         9 002523   000022 736000                    QLS     18
         9 002524   200016 036100                    ADLQ    CONTROL$,,AUTO
         9 002525   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002526   004512 701000 9                  TSX1    STORVAL
         9 002527   000000 011000                    NOP     0

      698    23954    2              END;                         /* DO I */

  23954  9 002530   200040 054100                    AOS     I,,AUTO
         9 002531   200040 235100                    LDA     I,,AUTO
         9 002532   000024 115007                    CMPA    20,DL
         9 002533   002515 604400 9                  TMOZ    s:23953

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:126  
      699    23955
      700    23956    1           GI$OFFSETS.CNTL# = %GI_CNTL_BOOTHI;

  23956  9 002534   000024 236007                    LDQ     20,DL
         9 002535   200051 470500                    LDP0    OFFSET$,,AUTO
         9 002536   000003 756100                    STQ     3,,PR0

  23956  9 002537                       NO_CONTROL   null
      701    23957    1   NO_CONTROL: ;
      702    23958                                 /* Build the pseudo definitions into the boot image */
      703    23959    1           PSEUDO$ = NEXT$;

  23959  9 002537   200052 236100                    LDQ     NEXT$,,AUTO
         9 002540   200036 756100                    STQ     PSEUDO$,,AUTO

      704    23960    1           GI$OFFSETS.PSEUDO# = 0;

  23960  9 002541   200051 470500                    LDP0    OFFSET$,,AUTO
         9 002542   000005 450100                    STZ     5,,PR0

      705    23961    1           PARAMOFFSET = POFFW(PSEUDO$,BEGIN$);

  23961  9 002543   200053 235100                    LDA     BEGIN$,,AUTO
         9 002544   000022 771000                    ARL     18
         9 002545   203650 755100                    STA     PROREC+128,,AUTO
         9 002546   200036 236100                    LDQ     PSEUDO$,,AUTO
         9 002547   000022 772000                    QRL     18
         9 002550   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 002551   200035 756100                    STQ     PARAMOFFSET,,AUTO

      706    23962    1           CALL STORVAL(GI$OFFSETS.PSEUDOOFFSET,PARAMOFFSET,4);

  23962  9 002552   000025 236000 10                 LDQ     21
         9 002553   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002554   200035 630500                    EPPR0   PARAMOFFSET,,AUTO
         9 002555   202704 450500                    STP0    @L6DW+1,,AUTO
         9 002556   200051 236100                    LDQ     OFFSET$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:127  
         9 002557   000004 036003                    ADLQ    4,DU
         9 002560   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002561   004512 701000 9                  TSX1    STORVAL
         9 002562   000000 011000                    NOP     0

      707    23963    1           KEY_PSEUDO.NODE = FEX;

  23963  9 002563   200003 470500                    LDP0    @FEX,,AUTO
         9 002564   000000 236100                    LDQ     0,,PR0
         9 002565   000011 736000                    QLS     9
         9 002566   003744 552010 6                  STBQ    KEY_PSEUDO,'10'O

      708    23964    1           READ_NETCON.KEY_ = VECTOR(KEY_PSEUDO);

  23964  9 002567   000102 237000 10                 LDAQ    66
         9 002570   002600 757000 6                  STAQ    READ_NETCON+2

      709    23965    1           READ_NETCON.BUF_ = VECTOR(KL_PSEUDO);

  23965  9 002571   000104 237000 10                 LDAQ    68
         9 002572   002602 757000 6                  STAQ    READ_NETCON+4

      710    23966    1           CALL M$READ(READ_NETCON) ALTRET(NO_PSEUDOS);

  23966  9 002573   002576 630400 6                  EPPR0   READ_NETCON
         9 002574   440000 713400                    CLIMB   alt,read
         9 002575   401400 401760                    pmme    nvectors=4
         9 002576   002742 702000 9                  TSX2    NO_PSEUDOS

      711    23967    1           CALL GETSEG(NEXT$,KL_PSEUDO.PSEUDO#*SIZEW(GI$PSEUDO));

  23967  9 002577   003653 236000 6                  LDQ     KL_PSEUDO
         9 002600   000070 402007                    MPY     56,DL
         9 002601   203666 756100                    STQ     PROREC+142,,AUTO
         9 002602   203666 630500                    EPPR0   PROREC+142,,AUTO
         9 002603   203444 450500                    STP0    @TERMID+1,,AUTO
         9 002604   200052 631500                    EPPR1   NEXT$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:128  
         9 002605   203443 451500                    STP1    NOHEADER+3,,AUTO
         9 002606   004316 701000 9                  TSX1    GETSEG
         9 002607   000000 011000                    NOP     0

      712    23968    1           GI$OFFSETS.PSEUDO# = KL_PSEUDO.PSEUDO#;

  23968  9 002610   200051 470500                    LDP0    OFFSET$,,AUTO
         9 002611   003653 235000 6                  LDA     KL_PSEUDO
         9 002612   000005 755100                    STA     5,,PR0

      713    23969    2           DO I = 0 TO KL_PSEUDO.PSEUDO# - 1;

  23969  9 002613   200040 450100                    STZ     I,,AUTO
         9 002614   002732 710000 9                  TRA     s:23976+1

      714    23970    2              GI$PSEUDO.NAME(I) = KL_PSEUDO.PSEUDO.NAME(I);

  23970  9 002615   200040 236100                    LDQ     I,,AUTO
         9 002616   000007 402007                    MPY     7,DL
         9 002617   000000 620006                    EAX0    0,QL
         9 002620   200040 236100                    LDQ     I,,AUTO
         9 002621   000034 402007                    MPY     28,DL
         9 002622   000000 635010                    EAA     0,X0
         9 002623   000020 731000                    ARS     16
         9 002624   200036 470500                    LDP0    PSEUDO$,,AUTO
         9 002625   040105 100406                    MLR     fill='040'O
         9 002626   003654 000010 6                  ADSC9   KL_PSEUDO+1,Q            cn=0,n=8
         9 002627   000000 000010                    ADSC9   0,A,PR0                  cn=0,n=8

      715    23971    2              CALL STORVAL(GI$PSEUDO.MAX_SYS(I),KL_PSEUDO.PSEUDO.MAX_SYS(I),4);

  23971  9 002630   000025 236000 10                 LDQ     21
         9 002631   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002632   200040 236100                    LDQ     I,,AUTO
         9 002633   000007 402003                    MPY     7,DU
         9 002634   000106 036000 10                 ADLQ    70
         9 002635   202704 756100                    STQ     @L6DW+1,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:129  
         9 002636   200040 236100                    LDQ     I,,AUTO
         9 002637   000007 402003                    MPY     7,DU
         9 002640   000002 036003                    ADLQ    2,DU
         9 002641   200036 036100                    ADLQ    PSEUDO$,,AUTO
         9 002642   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002643   004512 701000 9                  TSX1    STORVAL
         9 002644   000000 011000                    NOP     0

      716    23972    2              CALL STORVAL(GI$PSEUDO.MAX_USR(I),KL_PSEUDO.PSEUDO.MAX_USR(I),4);

  23972  9 002645   000025 236000 10                 LDQ     21
         9 002646   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002647   200040 236100                    LDQ     I,,AUTO
         9 002650   000007 402003                    MPY     7,DU
         9 002651   000107 036000 10                 ADLQ    71
         9 002652   202704 756100                    STQ     @L6DW+1,,AUTO
         9 002653   200040 236100                    LDQ     I,,AUTO
         9 002654   000007 402003                    MPY     7,DU
         9 002655   000003 036003                    ADLQ    3,DU
         9 002656   200036 036100                    ADLQ    PSEUDO$,,AUTO
         9 002657   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002660   004512 701000 9                  TSX1    STORVAL
         9 002661   000000 011000                    NOP     0

      717    23973    2              CALL STORVAL(GI$PSEUDO.MAX_CG(I),KL_PSEUDO.PSEUDO.MAX_CG(I),4);

  23973  9 002662   000025 236000 10                 LDQ     21
         9 002663   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002664   200040 236100                    LDQ     I,,AUTO
         9 002665   000007 402003                    MPY     7,DU
         9 002666   000110 036000 10                 ADLQ    72
         9 002667   202704 756100                    STQ     @L6DW+1,,AUTO
         9 002670   200040 236100                    LDQ     I,,AUTO
         9 002671   000007 402003                    MPY     7,DU
         9 002672   000004 036003                    ADLQ    4,DU
         9 002673   200036 036100                    ADLQ    PSEUDO$,,AUTO
         9 002674   202703 756100                    STQ     VDPGS+2,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:130  
         9 002675   004512 701000 9                  TSX1    STORVAL
         9 002676   000000 011000                    NOP     0

      718    23974    2              CALL STORVAL(GI$PSEUDO.MAX_HND(I),KL_PSEUDO.PSEUDO.MAX_HAND(I),4);

  23974  9 002677   000025 236000 10                 LDQ     21
         9 002700   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002701   200040 236100                    LDQ     I,,AUTO
         9 002702   000007 402003                    MPY     7,DU
         9 002703   000111 036000 10                 ADLQ    73
         9 002704   202704 756100                    STQ     @L6DW+1,,AUTO
         9 002705   200040 236100                    LDQ     I,,AUTO
         9 002706   000007 402003                    MPY     7,DU
         9 002707   000005 036003                    ADLQ    5,DU
         9 002710   200036 036100                    ADLQ    PSEUDO$,,AUTO
         9 002711   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002712   004512 701000 9                  TSX1    STORVAL
         9 002713   000000 011000                    NOP     0

      719    23975    2              CALL STORVAL(GI$PSEUDO.MAX_GHST(I),KL_PSEUDO.PSEUDO.MAX_GHST(I),4);

  23975  9 002714   000025 236000 10                 LDQ     21
         9 002715   202705 756100                    STQ     @L66WD+1,,AUTO
         9 002716   200040 236100                    LDQ     I,,AUTO
         9 002717   000007 402003                    MPY     7,DU
         9 002720   000112 036000 10                 ADLQ    74
         9 002721   202704 756100                    STQ     @L6DW+1,,AUTO
         9 002722   200040 236100                    LDQ     I,,AUTO
         9 002723   000007 402003                    MPY     7,DU
         9 002724   000006 036003                    ADLQ    6,DU
         9 002725   200036 036100                    ADLQ    PSEUDO$,,AUTO
         9 002726   202703 756100                    STQ     VDPGS+2,,AUTO
         9 002727   004512 701000 9                  TSX1    STORVAL
         9 002730   000000 011000                    NOP     0

      720    23976    2              END;                         /* DO I */

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:131  
  23976  9 002731   200040 054100                    AOS     I,,AUTO
         9 002732   200040 236100                    LDQ     I,,AUTO
         9 002733   002615 604000 9                  TMI     s:23970
         9 002734   003653 116000 6                  CMPQ    KL_PSEUDO
         9 002735   002615 602000 9                  TNC     s:23970

      721    23977    1           NEXT$ = PINCRW(NEXT$,KL_PSEUDO.PSEUDO#*SIZEW(GI$PSEUDO));

  23977  9 002736   003653 236000 6                  LDQ     KL_PSEUDO
         9 002737   000070 402003                    MPY     56,DU
         9 002740   200052 036100                    ADLQ    NEXT$,,AUTO
         9 002741   200052 756100                    STQ     NEXT$,,AUTO

  23977  9 002742                       NO_PSEUDOS   null
      722    23978    1   NO_PSEUDOS:;
      723    23979
      724    23980                                      /* Buffer now contains complete boot image. */
      725    23981    2           IF BUFFER_PASSED THEN DO;

  23981  9 002742   200066 234100                    SZN     BUFFER_PASSED,,AUTO
         9 002743   002760 605000 9                  TPL     s:23986

      726    23982    2              BOOT_BUFFER=DATASEG;

  23982  9 002744   000014 237000 6                  LDAQ    DATASEG
         9 002745   200004 470500                    LDP0    @BOOT_BUFFER,,AUTO
         9 002746   000000 757100                    STAQ    0,,PR0

      727    23983    2              WDSUSED_=POFFW(NEXT$,BEGIN$);

  23983  9 002747   200053 235100                    LDA     BEGIN$,,AUTO
         9 002750   000022 771000                    ARL     18
         9 002751   203650 755100                    STA     PROREC+128,,AUTO
         9 002752   200052 236100                    LDQ     NEXT$,,AUTO
         9 002753   000022 772000                    QRL     18
         9 002754   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 002755   200006 471500                    LDP1    @WDSUSED_,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:132  
         9 002756   100000 756100                    STQ     0,,PR1

      728    23984    2              END;

  23984  9 002757   003047 710000 9                  TRA     s:24015

      729    23985    2           ELSE DO;

      730    23986    2              SAVE_INFO.DATASEG(SAVEX)=DATASEG;

  23986  9 002760   200061 236100                    LDQ     SAVEX,,AUTO
         9 002761   000014 402007                    MPY     12,DL
         9 002762   000000 620006                    EAX0    0,QL
         9 002763   000014 237000 6                  LDAQ    DATASEG
         9 002764   000020 757010 6                  STAQ    SAVE_INFO+2,X0

      731    23987    3              IF SAVE_INFO.DFNAME.L(SAVEX)~=0 THEN DO;

  23987  9 002765   000022 236010 6                  LDQ     SAVE_INFO+4,X0
         9 002766   777000 316003                    CANQ    -512,DU
         9 002767   002773 600000 9                  TZE     s:23991

      732    23988    3                 FPT_FEBOOT.V.MLCPDUMP#='1'B;

  23988  9 002770   200000 236003                    LDQ     65536,DU
         9 002771   002306 256000 6                  ORSQ    FPT_FEBOOT+8

      733    23989    3                 END;

  23989  9 002772   002775 710000 9                  TRA     s:23993

      734    23990    3              ELSE DO;

      735    23991    3                 FPT_FEBOOT.V.MLCPDUMP#='0'B;

  23991  9 002773   000113 236000 10                 LDQ     75
         9 002774   002306 356000 6                  ANSQ    FPT_FEBOOT+8
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:133  

      736    23992    3                 END;

      737    23993    2              FPT_FEBOOT.BUF_=DATASEG;

  23993  9 002775   000014 237000 6                  LDAQ    DATASEG
         9 002776   002300 757000 6                  STAQ    FPT_FEBOOT+2

      738    23994    2              FPT_FEBOOT.V.FEP# = FEX;

  23994  9 002777   200003 470500                    LDP0    @FEX,,AUTO
         9 003000   000000 235100                    LDA     0,,PR0
         9 003001   002305 755000 6                  STA     FPT_FEBOOT+7

      739    23995        /* This section will check to see if we are to request a boot of a debug fep
      740    23996        if this is a debug fep, then we will specify the NOTIME option on the call
      741    23997        to M$FEBOOT */
      742    23998
      743    23999    2              READ_NETCON.BUF_ = VECTOR(KL_NETWORK);

  23999  9 003002   000034 235000 10                 LDA     28
         9 003003   203650 452500                    STP2    PROREC+128,,AUTO
         9 003004   203650 236100                    LDQ     PROREC+128,,AUTO
         9 003005   000263 036003                    ADLQ    179,DU
         9 003006   002602 757000 6                  STAQ    READ_NETCON+4

      744    24000    2              READ_NETCON.KEY_ = VECTOR(KL_NETWORK_KEY);

  24000  9 003007   000032 237000 10                 LDAQ    26
         9 003010   002600 757000 6                  STAQ    READ_NETCON+2

      745    24001    2              CALL M$READ (READ_NETCON) ALTRET (ALT);

  24001  9 003011   002576 630400 6                  EPPR0   READ_NETCON
         9 003012   440000 713400                    CLIMB   alt,read
         9 003013   401400 401760                    pmme    nvectors=4
         9 003014   003052 702000 9                  TSX2    ALT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:134  

      746    24002    2              IF KL_NETWORK.NODE.TYPE(FEX) = %KL_NODETYPE_DEBUG

  24002  9 003015   200003 470500                    LDP0    @FEX,,AUTO
         9 003016   000000 236100                    LDQ     0,,PR0
         9 003017   000005 402007                    MPY     5,DL
         9 003020   200264 235106                    LDA     KL_NETWORK+1,QL,AUTO
         9 003021   000004 115007                    CMPA    4,DL
         9 003022   003025 601000 9                  TNZ     s:24006

      747    24003    3              THEN DO;

      748    24004    3                 FPT_FEBOOT.V.NOTIME# ='1'B;

  24004  9 003023   020000 236003                    LDQ     8192,DU
         9 003024   002306 256000 6                  ORSQ    FPT_FEBOOT+8

      749    24005    3                 END;

      750    24006    2              CALL M$FEBOOT(FPT_FEBOOT) ALTRET(ALT);

  24006  9 003025   002276 630400 6                  EPPR0   FPT_FEBOOT
         9 003026   560015 713400                    CLIMB   alt,+57357
         9 003027   401000 401760                    pmme    nvectors=3
         9 003030   003052 702000 9                  TSX2    ALT

      751    24007    2              IF B$JIT.SYSID ~= 8

  24007  9 003031   000000 470400 xsym               LDP0    B$JIT$
         9 003032   000000 720100                    LXL0    0,,PR0
         9 003033   000010 100003                    CMPX0   8,DU
         9 003034   003047 600000 9                  TZE     s:24015

      752    24008    3              THEN DO;

      753    24009    4                 CALL M$FDS(FPT_FDS) WHENALTRETURN DO; END;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:135  
  24009  9 003035   000006 630400 6                  EPPR0   FPT_FDS
         9 003036   430002 713400                    CLIMB   alt,fds
         9 003037   400400 401760                    pmme    nvectors=2
         9 003040   003042 702000 9                  TSX2    s:24010
         9 003041   003042 710000 9                  TRA     s:24010

      754    24010    3                 SAVE_INFO.DATASEG(SAVEX)=VECTOR(NIL);

  24010  9 003042   200061 236100                    LDQ     SAVEX,,AUTO
         9 003043   000014 402007                    MPY     12,DL
         9 003044   000000 620006                    EAX0    0,QL
         9 003045   000010 237000 10                 LDAQ    8
         9 003046   000020 757010 6                  STAQ    SAVE_INFO+2,X0

      755    24011    3                 END;

      756    24012    2              END;

      757    24013
      758    24014                                                /* Clean up after ourselves. */
      759    24015    1           CALL CLEANUP_DCBS;

  24015  9 003047   004420 701000 9                  TSX1    CLEANUP_DCBS
         9 003050   000000 011000                    NOP     0

      760    24016    1           RETURN;

  24016  9 003051   000000 702200 xent               TSX2  ! X66_ARET

  24009  9 003052                       ALT          null
      761    24017
      762    24018    1   ALT:    ;                               /* PMME ALTRET                        */
      763    24019    1           CALL PMMEERR;

  24019  9 003052   004370 701000 9                  TSX1    PMMEERR
         9 003053   000000 011000                    NOP     0

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:136  
      764    24020    1           SAVE_INFO.FEX(SAVEX)=-1;

  24020  9 003054   200061 236100                    LDQ     SAVEX,,AUTO
         9 003055   000014 402007                    MPY     12,DL
         9 003056   000001 335007                    LCA     1,DL
         9 003057   000016 755006 6                  STA     SAVE_INFO,QL

      765    24021    1           IF NOT BUFFER_PASSED THEN

  24021  9 003060   200066 234100                    SZN     BUFFER_PASSED,,AUTO
         9 003061   003067 604000 9                  TMI     s:24024

      766    24022    2              CALL M$FDS(FPT_FDS) WHENALTRETURN DO;

  24022  9 003062   000006 630400 6                  EPPR0   FPT_FDS
         9 003063   430002 713400                    CLIMB   alt,fds
         9 003064   400400 401760                    pmme    nvectors=2
         9 003065   003067 702000 9                  TSX2    s:24024
         9 003066   003067 710000 9                  TRA     s:24024

      767    24023    2                 END;

      768    24024    1           SAVE_INFO.DATASEG(SAVEX)=VECTOR(NIL);

  24024  9 003067   200061 236100                    LDQ     SAVEX,,AUTO
         9 003070   000014 402007                    MPY     12,DL
         9 003071   000000 620006                    EAX0    0,QL
         9 003072   000010 237000 10                 LDAQ    8
         9 003073   000020 757010 6                  STAQ    SAVE_INFO+2,X0

      769    24025    1           CALL CLEANUP_DCBS;

  24025  9 003074   004420 701000 9                  TSX1    CLEANUP_DCBS
         9 003075   000000 011000                    NOP     0

      770    24026    1           IF ADDR(RET_ERROR_) ~= ADDR(NIL)

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:137  
  24026  9 003076   200005 236100                    LDQ     @RET_ERROR_,,AUTO
         9 003077   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 003100   003104 600000 9                  TZE     s:24028

      771    24027    1           THEN RET_ERROR_ = RET_ERROR;

  24027  9 003101   003335 236000 6                  LDQ     RET_ERROR
         9 003102   200005 470500                    LDP0    @RET_ERROR_,,AUTO
         9 003103   000000 756100                    STQ     0,,PR0

      772    24028    1           IF ADDR(WDSUSED_) ~= ADDR(NIL)

  24028  9 003104   200006 236100                    LDQ     @WDSUSED_,,AUTO
         9 003105   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 003106   003112 600000 9                  TZE     s:24030

      773    24029    1           THEN WDSUSED_ = WDSUSED;

  24029  9 003107   200050 235100                    LDA     WDSUSED,,AUTO
         9 003110   200006 470500                    LDP0    @WDSUSED_,,AUTO
         9 003111   000000 755100                    STA     0,,PR0

      774    24030    1           ALTRETURN;

  24030  9 003112   000000 702200 xent               TSX2  ! X66_AALT

      775    24031
      776    24032        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:138  
      777    24033    1   KFF$STARTHANDLERS: ENTRY(FEX) ALTRET ;

  24033  9 003113   000000 700200 xent  KFF$STARTHA* TSX0  ! X66_AUTO_4
         9 003114   003670 000004                    ZERO    1976,4

      778    24034        /*
      779    24035             wait for fep to go active before attempting to down load handlers
      780    24036        */
      781    24037
      782    24038    1           J = 0;

  24038  9 003115   200041 450100                    STZ     J,,AUTO

      783    24039    1           FPT_NODEINFO.V.NODENUM# = FEX;

  24039  9 003116   200003 470500                    LDP0    @FEX,,AUTO
         9 003117   000000 236100                    LDQ     0,,PR0
         9 003120   000033 736000                    QLS     27
         9 003121   002434 552040 6                  STBQ    FPT_NODEINFO+6,'40'O

      784    24040    2   FEACTV: DO WHILE (J<=5);

  24040  9 003122   200041 235100       FEACTV       LDA     J,,AUTO
         9 003123   000006 115007                    CMPA    6,DL
         9 003124   003150 603000 9                  TRC     s:24060

      785    24041    3              CALL M$NODEINFO(FPT_NODEINFO) WHENALTRETURN DO;

  24041  9 003125   002426 630400 6                  EPPR0   FPT_NODEINFO
         9 003126   560031 713400                    CLIMB   alt,+57369
         9 003127   400400 401760                    pmme    nvectors=2
         9 003130   003132 702000 9                  TSX2    s:24042
         9 003131   003134 710000 9                  TRA     s:24044

      786    24042    3                 CALL PMMEERR;

  24042  9 003132   004370 701000 9                  TSX1    PMMEERR
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:139  
         9 003133   000000 011000                    NOP     0

      787    24043    3                 END;

      788    24044    2              IF VLR_NODEINFO.ACTIVE# THEN

  24044  9 003134   002440 236000 6                  LDQ     VLR_NODEINFO+2
         9 003135   000200 316003                    CANQ    128,DU
         9 003136   003150 601000 9                  TNZ     s:24060

      789    24045    2                 EXIT FEACTV;
      790    24046    2              ELSE
      791    24047    3              DO;

      792    24048    3                 CALL M$WAIT(FPT_WAIT);

  24048  9 003137   003064 630400 6                  EPPR0   FPT_WAIT
         9 003140   020006 713400                    CLIMB   8198
         9 003141   400400 401760                    pmme    nvectors=2

      793    24049    3                 J=J+1;

  24049  9 003142   200041 235100                    LDA     J,,AUTO
         9 003143   000001 035007                    ADLA    1,DL
         9 003144   200041 755100                    STA     J,,AUTO

      794    24050    3                 IF J > 5 THEN

  24050  9 003145   000006 115007                    CMPA    6,DL
         9 003146   003147 602000 9                  TNC     s:24058

      795    24051    4                 DO;

      796    24052                         /*N*
      797    24053                            The fep failed to start within the allocated time frame
      798    24054                            and i got tired of waiting.  do the error message.
      799    24055                         */
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:140  
      800    24056    4                    END;

      801    24057    3                 END;

      802    24058    2              END;                         /* DO WHILE */

  24058  9 003147   003125 602000 9                  TNC     s:24041

      803    24059
      804    24060    1           KEY_FEPHNDLR.NODE = FEX;

  24060  9 003150   200003 470500                    LDP0    @FEX,,AUTO
         9 003151   000000 236100                    LDQ     0,,PR0
         9 003152   000011 736000                    QLS     9
         9 003153   003647 552010 6                  STBQ    KEY_FEPHNDLR,'10'O

      805    24061    1           READ_NETCON.KEY_ = VECTOR(KEY_FEPHNDLR);

  24061  9 003154   000026 237000 10                 LDAQ    22
         9 003155   002600 757000 6                  STAQ    READ_NETCON+2

      806    24062    1           READ_NETCON.BUF_ = VECTOR(KL_FEPHNDLR);

  24062  9 003156   000030 237000 10                 LDAQ    24
         9 003157   002602 757000 6                  STAQ    READ_NETCON+4

      807    24063    2           CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  24063  9 003160   002576 630400 6                  EPPR0   READ_NETCON
         9 003161   440000 713400                    CLIMB   alt,read
         9 003162   401400 401760                    pmme    nvectors=4
         9 003163   003165 702000 9                  TSX2    s:24064
         9 003164   003170 710000 9                  TRA     s:24067

      808    24064    2              CALL PMMEERR;

  24064  9 003165   004370 701000 9                  TSX1    PMMEERR
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:141  
         9 003166   000000 011000                    NOP     0

      809    24065    2              RETURN;

  24065  9 003167   000000 702200 xent               TSX2  ! X66_ARET

      810    24066    2              END;
      811    24067    1           CALL BINCHAR(SUBSTR(FPT_STARTHANDLER.V.RES#,2,2),FEX);

  24067  9 003170   200003 470500                    LDP0    @FEX,,AUTO
         9 003171   000000 235100                    LDA     0,,PR0
         9 003172   000044 773000                    LRL     36
         9 003173   203650 757100                    STAQ    PROREC+128,,AUTO
         9 003174   000000 301500                    BTD
         9 003175   203650 000010                    NDSC9   PROREC+128,,AUTO         cn=0,s=lsgnf,sf=0,n=8
         9 003176   003142 430002 6                  NDSC9   FPT_STARTHANDLER+40      cn=2,s=nosgn,sf=0,n=2

      812    24068    2           DO J = 1 TO KL_FEPHNDLR.NHANDLERS-1;

  24068  9 003177   000001 235007                    LDA     1,DL
         9 003200   200041 755100                    STA     J,,AUTO
         9 003201   003305 710000 9                  TRA     s:24099+3

      813    24069    3   START_HNDLRS: DO;

  24069  9 003202                       START_HNDLRS null
      814    24070    3                 IF KL_FEPHNDLR.BOOTIME(J) = '1'B THEN

  24070  9 003202   200041 235100                    LDA     J,,AUTO
         9 003203   000000 066405                    CMPB    filb='0'B
         9 003204   003531 000001 6                  BDSC    KL_FEPHNDLR+3,A          by=0,bit=0,n=1
         9 003205   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         9 003206   003302 601000 9                  TNZ     s:24099

      815    24071    3                    EXIT START_HNDLRS;
      816    24072    3                 KEY_HNDLR.HNDLR = KL_FEPHNDLR.HANDLER(J);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:142  
  24072  9 003207   000003 735000                    ALS     3
         9 003210   040000 100405                    MLR     fill='040'O
         9 003211   003532 000010 6                  ADSC9   KL_FEPHNDLR+4,A          cn=0,n=8
         9 003212   003650 600010 6                  ADSC9   KEY_HNDLR                cn=3,n=8

      817    24073    3                 KEY_HNDLR.NODE = FEX;

  24073  9 003213   200003 470500                    LDP0    @FEX,,AUTO
         9 003214   000000 236100                    LDQ     0,,PR0
         9 003215   000011 736000                    QLS     9
         9 003216   003650 552010 6                  STBQ    KEY_HNDLR,'10'O

      818    24074    3                 READ_NETCON.KEY_ = VECTOR(KEY_HNDLR);

  24074  9 003217   000042 237000 10                 LDAQ    34
         9 003220   002600 757000 6                  STAQ    READ_NETCON+2

      819    24075    3                 READ_NETCON.BUF_ = VECTOR(KL_HNDLR);

  24075  9 003221   000044 237000 10                 LDAQ    36
         9 003222   002602 757000 6                  STAQ    READ_NETCON+4

      820    24076    4                 CALL M$READ(READ_NETCON) WHENRETURN DO;

  24076  9 003223   002576 630400 6                  EPPR0   READ_NETCON
         9 003224   440000 713400                    CLIMB   alt,read
         9 003225   401400 401760                    pmme    nvectors=4
         9 003226   003300 702000 9                  TSX2    s:24096

      821    24077    4                    FPT_FID.TEXTFID_ = VECTOR(KL_HNDLR.HNDLRFID);

  24077  9 003227   000046 237000 10                 LDAQ    38
         9 003230   003002 757000 6                  STAQ    FPT_FID+2

      822    24078    5                    CALL M$FID(FPT_FID) WHENRETURN DO;

  24078  9 003231   003000 630400 6                  EPPR0   FPT_FID
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:143  
         9 003232   420001 713400                    CLIMB   alt,+8193
         9 003233   404400 401760                    pmme    nvectors=10
         9 003234   003275 702000 9                  TSX2    s:24092

      823    24079    5                       VLP_FPRG.NAME = VLP_NAME;

  24079  9 003235   000000 100400                    MLR     fill='000'O
         9 003236   003042 000040 6                  ADSC9   VLP_NAME                 cn=0,n=32
         9 003237   003174 000040 6                  ADSC9   VLP_FPRG+2               cn=0,n=32

      824    24080    5                       VLP_FPRG.ACCT# = VLP_ACCT.ACCT#;

  24080  9 003240   003052 237000 6                  LDAQ    VLP_ACCT
         9 003241   003204 757000 6                  STAQ    VLP_FPRG+10

      825    24081    5                       VLP_FPRG.PASS# = VLP_PASS.PASS#;

  24081  9 003242   003054 237000 6                  LDAQ    VLP_PASS
         9 003243   003206 757000 6                  STAQ    VLP_FPRG+12

      826    24082    5                       HAND_NAME.NAME# = VLP_NAME.NAME#;

  24082  9 003244   040000 100400                    MLR     fill='040'O
         9 003245   003042 200014 6                  ADSC9   VLP_NAME                 cn=1,n=12
         9 003246   003166 200014 6                  ADSC9   HAND_NAME                cn=1,n=12

      827    24083    5                       HAND_ACCT.ACCT# = VLP_ACCT.ACCT#;

  24083  9 003247   003052 237000 6                  LDAQ    VLP_ACCT
         9 003250   003164 757000 6                  STAQ    HAND_ACCT

      828    24084    6                       CALL M$OPEN(FPT_STARTHANDLER) WHENALTRETURN DO;

  24084  9 003251   003072 630400 6                  EPPR0   FPT_STARTHANDLER
         9 003252   450000 713400                    CLIMB   alt,open
         9 003253   410400 401760                    pmme    nvectors=18
         9 003254   003256 702000 9                  TSX2    s:24085
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:144  
         9 003255   003267 710000 9                  TRA     s:24089

      829    24085    6                          CALL PMMEERR;

  24085  9 003256   004370 701000 9                  TSX1    PMMEERR
         9 003257   000000 011000                    NOP     0

      830    24086                                 /* dont bother continuing if the line disconnected */
      831    24087    6                          IF B$ALT.ERR.ERR# = %E$LD THEN RETURN;

  24087  9 003260   000000 470400 xsym               LDP0    B$TCB$
         9 003261   000000 471500                    LDP1    0,,PR0
         9 003262   100102 236100                    LDQ     66,,PR1
         9 003263   377770 376007                    ANQ     131064,DL
         9 003264   000070 116007                    CMPQ    56,DL
         9 003265   003267 601000 9                  TNZ     s:24089

  24087  9 003266   000000 702200 xent               TSX2  ! X66_ARET

      832    24088    6                          END;
      833    24089    6                       CALL M$CLOSE(FPT_CLOSEHANDLER) WHENALTRETURN DO; END;

  24089  9 003267   003214 630400 6                  EPPR0   FPT_CLOSEHANDLER
         9 003270   450001 713400                    CLIMB   alt,close
         9 003271   406000 401760                    pmme    nvectors=13
         9 003272   003274 702000 9                  TSX2    s:24090
         9 003273   003274 710000 9                  TRA     s:24090

      834    24090    5                       END;

  24090  9 003274   003277 710000 9                  TRA     s:24094

      835    24091    5                    WHENALTRETURN DO;

      836    24092    5                       CALL PMMEERR;

  24092  9 003275   004370 701000 9                  TSX1    PMMEERR
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:145  
         9 003276   000000 011000                    NOP     0

      837    24093    5                       END;

      838    24094    4                    END;

  24094  9 003277   003302 710000 9                  TRA     s:24099

      839    24095    4                 WHENALTRETURN DO;

      840    24096    4                    CALL PMMEERR;

  24096  9 003300   004370 701000 9                  TSX1    PMMEERR
         9 003301   000000 011000                    NOP     0

      841    24097    4                    END;

      842    24098    3                 END;                      /* start_handlers */

      843    24099    2              END;                         /* DO J */

  24099  9 003302   200041 235100                    LDA     J,,AUTO
         9 003303   000001 035007                    ADLA    1,DL
         9 003304   200041 755100                    STA     J,,AUTO
         9 003305   200041 236100                    LDQ     J,,AUTO
         9 003306   003526 116000 6                  CMPQ    KL_FEPHNDLR
         9 003307   003202 602000 9                  TNC     START_HNDLRS

      844    24100    1           RETURN;

  24100  9 003310   000000 702200 xent               TSX2  ! X66_ARET

      845    24101
      846    24102        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:146  
      847    24103    1   CONV_NODENAME: PROC (NODENAME,NODE#,NODETYPE) ALTRET;

  24103  9 003311   202664 741300       CONV_NODENA* STX1  ! KL_NETWORK+1281,,AUTO

      848    24104
      849    24105        /* Paremeters */
      850    24106    2   DCL NODENAME CHAR(8);
      851    24107    2   DCL NODE# UBIN;
      852    24108    2   DCL NODETYPE UBIN;
      853    24109
      854    24110    2   DCL I SBIN;
      855    24111
      856    24112    2           READ_NETCON.BUF_ = VECTOR(KL_NETWORK);

  24112  9 003312   000034 235000 10                 LDA     28
         9 003313   203650 452500                    STP2    PROREC+128,,AUTO
         9 003314   203650 236100                    LDQ     PROREC+128,,AUTO
         9 003315   000263 036003                    ADLQ    179,DU
         9 003316   002602 757000 6                  STAQ    READ_NETCON+4

      857    24113    2           READ_NETCON.KEY_ = VECTOR(KL_NETWORK_KEY);

  24113  9 003317   000032 237000 10                 LDAQ    26
         9 003320   002600 757000 6                  STAQ    READ_NETCON+2

      858    24114    2           CALL M$READ (READ_NETCON)

  24114  9 003321   002576 630400 6                  EPPR0   READ_NETCON
         9 003322   440000 713400                    CLIMB   alt,read
         9 003323   401400 401760                    pmme    nvectors=4
         9 003324   003326 702000 9                  TSX2    s:24116
         9 003325   003330 710000 9                  TRA     s:24119

      859    24115    3           WHENALTRETURN DO;

      860    24116    3              ALTRETURN;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:147  
  24116  9 003326   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 003327   000000 702211                    TSX2  ! 0,X1

      861    24117    3              END;
      862    24118
      863    24119    3           DO I = 0 TO KL_NETWORK.NODE#;

  24119  9 003330   202670 450100                    STZ     I,,AUTO
         9 003331   003357 710000 9                  TRA     s:24129+1

      864    24120    3              IF KL_NETWORK.NODE.NODE(I) = NODENAME

  24120  9 003332   202670 236100                    LDQ     I,,AUTO
         9 003333   000024 402007                    MPY     20,DL
         9 003334   202665 470500                    LDP0    @NODENAME,,AUTO
         9 003335   040100 106506                    CMPC    fill='040'O
         9 003336   200265 000010                    ADSC9   KL_NETWORK+2,Q,AUTO      cn=0,n=8
         9 003337   000000 000010                    ADSC9   0,,PR0                   cn=0,n=8
         9 003340   003356 601000 9                  TNZ     s:24129

      865    24121    4              THEN DO;

      866    24122    4                 NODETYPE = KL_NETWORK.NODE.TYPE(I);

  24122  9 003341   202670 236100                    LDQ     I,,AUTO
         9 003342   000005 402007                    MPY     5,DL
         9 003343   202667 471500                    LDP1    @NODETYPE,,AUTO
         9 003344   200264 235106                    LDA     KL_NETWORK+1,QL,AUTO
         9 003345   100000 755100                    STA     0,,PR1

      867    24123    4                 IF NODETYPE = %KL_NODETYPE_UNDEF

  24123  9 003346   003351 601000 9                  TNZ     s:24126

      868    24124    4                 THEN
      869    24125    4                    ALTRETURN;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:148  
  24125  9 003347   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 003350   000000 702211                    TSX2  ! 0,X1

      870    24126    4                 NODE# = I;

  24126  9 003351   202670 235100                    LDA     I,,AUTO
         9 003352   202666 473500                    LDP3    @NODE#,,AUTO
         9 003353   300000 755100                    STA     0,,PR3

      871    24127    4                 RETURN;

  24127  9 003354   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 003355   000001 702211                    TSX2  ! 1,X1

      872    24128    4                 END;
      873    24129    3              END;

  24129  9 003356   202670 054100                    AOS     I,,AUTO
         9 003357   200263 236100                    LDQ     KL_NETWORK,,AUTO
         9 003360   003332 604000 9                  TMI     s:24120
         9 003361   202670 116100                    CMPQ    I,,AUTO
         9 003362   003332 605000 9                  TPL     s:24120

      874    24130
      875    24131    2           ALTRETURN;

  24131  9 003363   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 003364   000000 702211                    TSX2  ! 0,X1

      876    24132    2   END CONV_NODENAME;
      877    24133
      878    24134        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:149  
      879    24135    1   KFF$FREE: ENTRY(FEX) ALTRET;

  24135  9 003365   000000 700200 xent  KFF$FREE     TSX0  ! X66_AUTO_4
         9 003366   003670 000004                    ZERO    1976,4

      880    24136
      881    24137    2           CALL FIND_SAVEX(FEX,SAVEX) WHENRETURN DO;

  24137  9 003367   200061 630500                    EPPR0   SAVEX,,AUTO
         9 003370   202672 450500                    STP0    @FEX+1,,AUTO
         9 003371   200003 236100                    LDQ     @FEX,,AUTO
         9 003372   202671 756100                    STQ     PAGES+1,,AUTO
         9 003373   004565 701000 9                  TSX1    FIND_SAVEX
         9 003374   003441 702000 9                  TSX2    s:24148

      882    24138    3              IF SAVE_INFO.DFNAME.L(SAVEX)~=0 THEN DO;

  24138  9 003375   200061 236100                    LDQ     SAVEX,,AUTO
         9 003376   000014 402007                    MPY     12,DL
         9 003377   000022 236006 6                  LDQ     SAVE_INFO+4,QL
         9 003400   777000 316003                    CANQ    -512,DU
         9 003401   003424 600000 9                  TZE     s:24143

      883    24139    3                CALL KFD$MLCPDUMP(FEX,SAVE_INFO.DATASEG(SAVEX),SAVE_INFO.DFNAME(SAVEX)
             24139                          );

  24139  9 003402   200061 236100                    LDQ     SAVEX,,AUTO
         9 003403   000014 402003                    MPY     12,DU
         9 003404   000114 036000 10                 ADLQ    76
         9 003405   203652 756100                    STQ     PROREC+130,,AUTO
         9 003406   200061 236100                    LDQ     SAVEX,,AUTO
         9 003407   000014 402003                    MPY     12,DU
         9 003410   000115 036000 10                 ADLQ    77
         9 003411   200003 235100                    LDA     @FEX,,AUTO
         9 003412   203650 757100                    STAQ    PROREC+128,,AUTO
         9 003413   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 003414   000021 631400 xsym               EPPR1   B_VECTNIL+17
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:150  
         9 003415   000000 701000 xent               TSX1    KFD$MLCPDUMP
         9 003416   000000 011000                    NOP     0

      884    24140    3                 SAVE_INFO.DFNAME.L(SAVEX)=0;

  24140  9 003417   200061 236100                    LDQ     SAVEX,,AUTO
         9 003420   000014 402007                    MPY     12,DL
         9 003421   000000 620006                    EAX0    0,QL
         9 003422   000032 236000 xsym               LDQ     B_VECTNIL+26
         9 003423   000022 356010 6                  ANSQ    SAVE_INFO+4,X0

      885    24141    3                 END;

      886    24142    3              DO INHIBIT;

      887    24143    3                 DATASEG=SAVE_INFO.DATASEG(SAVEX);

  24143  9 003424   200061 236300                    LDQ   ! SAVEX,,AUTO
         9 003425   000014 402207                    MPY   ! 12,DL
         9 003426   000020 237206 6                  LDAQ  ! SAVE_INFO+2,QL
         9 003427   000014 757200 6                  STAQ  ! DATASEG

      888    24144    4                 CALL M$FDS(FPT_FDS) WHENALTRETURN DO; END;

  24144  9 003430   000006 630600 6                  EPPR0 ! FPT_FDS
         9 003431   430002 713600                    CLIMB ! alt,fds
         9 003432   400400 401760                    pmme    nvectors=2
         9 003433   003435 702200 9                  TSX2  ! s:24146
         9 003434   003435 710200 9                  TRA   ! s:24146

      889    24145    3                 END;

      890    24146    2              SAVE_INFO.FEX(SAVEX)=-1;

  24146  9 003435   200061 236100                    LDQ     SAVEX,,AUTO
         9 003436   000014 402007                    MPY     12,DL
         9 003437   000001 335007                    LCA     1,DL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:151  
         9 003440   000016 755006 6                  STA     SAVE_INFO,QL

      891    24147    2              END;

      892    24148    1           RETURN;

  24148  9 003441   000000 702200 xent               TSX2  ! X66_ARET

      893    24149
      894    24150        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:152  
      895    24151    1   KFF$SAVE_DFNAME: ENTRY(FEX,BOOT_BUFFER/*DFNAME*/) ALTRET;

  24151  9 003442   000000 700200 xent  KFF$SAVE_DF* TSX0  ! X66_AUTO_4
         9 003443   003670 000004                    ZERO    1976,4

      896    24152
      897    24153    2           CALL GET_SAVEX(FEX,SAVEX) WHENRETURN DO;

  24153  9 003444   200061 630500                    EPPR0   SAVEX,,AUTO
         9 003445   202666 450500                    STP0    @ERR+1,,AUTO
         9 003446   200003 236100                    LDQ     @FEX,,AUTO
         9 003447   202665 756100                    STQ     KL_NETWORK+1282,,AUTO
         9 003450   004612 701000 9                  TSX1    GET_SAVEX
         9 003451   003461 702000 9                  TSX2    s:24157

      898    24154    2              SAVE_INFO.DFNAME(SAVEX)=ADDR(BOOT_BUFFER)->DFBASE;

  24154  9 003452   200061 236100                    LDQ     SAVEX,,AUTO
         9 003453   000060 402007                    MPY     48,DL
         9 003454   200004 470500                    LDP0    @BOOT_BUFFER,,AUTO
         9 003455   000006 100500                    MLR     fill='000'O
         9 003456   000000 000040                    ADSC9   0,,PR0                   cn=0,n=32
         9 003457   000022 000040 6                  ADSC9   SAVE_INFO+4,Q            cn=0,n=32

      899    24155    2              END;

  24155  9 003460   003462 710000 9                  TRA     s:24159

      900    24156    2           WHENALTRETURN DO;

      901    24157    2              ALTRETURN;

  24157  9 003461   000000 702200 xent               TSX2  ! X66_AALT

      902    24158    2              END;
      903    24159    1           RETURN;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:153  
  24159  9 003462   000000 702200 xent               TSX2  ! X66_ARET

      904    24160
      905    24161        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:154  
      906    24162    1   READ_RU: PROC(IMAGE$,TYPE) ALTRET;

  24162  9 003463   202664 741300       READ_RU      STX1  ! KL_NETWORK+1281,,AUTO

      907    24163    2   DCL IMAGE$ PTR;
      908    24164    2   DCL TYPE UBIN WORD;
      909    24165    2   DCL BUF$ PTR;
      910    24166    2   DCL ONEPAGE(0:1023) UBIN BASED(BUF$);
      911    24167    2   DCL PAGES SBIN;
      912    24168    2   DCL I SBIN;
      913    24169    2   DCL BIAS UBIN WORD;
      914    24170        %FPT_READ (FPTN=FPT_READRU,DCB=M$RU);
      915    24209        %FPT_PRECORD (DCB=M$RU,KEYR=YES,N=0,KEY=RUKEY);
      916    24230        %B$FEP_RUKEY (NAME=RUKEY,STCLASS=STATIC);
      917    24254        %B$RUHEADKEY (NAME=HEADKEY,STCLASS=STATIC);
      918    24261        %B$SECTABLE (STCLASS="(0:30) STATIC");
      919    24273        %B$SECTABLEKEY (NAME=SECTKEY,STCLASS=STATIC);
      920    24280    2   DCL BYTESLEFT SBIN;
      921    24281    2   DCL BYTESIZE UBIN;
      922    24282    2   DCL SECT$ PTR;
      923    24283    2   DCL OFFSET UBIN;
      924    24284    2   DCL START UBIN;
      925    24285    2   DCL SIZE UBIN;
      926    24286    2   DCL VDPGS UBIN;
      927    24287        /**/
      928    24288    2           WDSUSED = 0;

  24288  9 003464   200050 450100                    STZ     WDSUSED,,AUTO

      929    24289    2           RUKEY.TYPE = 10;

  24289  9 003465   000012 236003                    LDQ     10,DU
         9 003466   004042 552020 6                  STBQ    RUKEY,'20'O

      930    24290    2           RUKEY.NODE = 0;

  24290  9 003467   000116 236000 10                 LDQ     78
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:155  
         9 003470   004042 356000 6                  ANSQ    RUKEY

      931    24291    2           FPT_READRU.BUF_=VECTOR(HEADBUF);

  24291  9 003471   000120 237000 10                 LDAQ    80
         9 003472   004016 757000 6                  STAQ    FPT_READRU+4

      932    24292    2           FPT_READRU.KEY_=VECTOR(HEADKEY);

  24292  9 003473   000122 237000 10                 LDAQ    82
         9 003474   004014 757000 6                  STAQ    FPT_READRU+2

      933    24293    2           FPT_READRU.V.KEYS#='1'B;

  24293  9 003475   200000 236007                    LDQ     65536,DL
         9 003476   004022 256000 6                  ORSQ    FPT_READRU+8

      934    24294    2           CALL M$READ(FPT_READRU) ALTRET(ALT);

  24294  9 003477   004012 630400 6                  EPPR0   FPT_READRU
         9 003500   440000 713400                    CLIMB   alt,read
         9 003501   401400 401760                    pmme    nvectors=4
         9 003502   004314 702000 9                  TSX2    ALT

      935    24295    3           DO CASE(TYPE);

  24295  9 003503   202666 470500                    LDP0    @TYPE,,AUTO
         9 003504   000000 235100                    LDA     0,,PR0
         9 003505   000004 115007                    CMPA    4,DL
         9 003506   003510 602005 9                  TNC     s:24295+5,AL
         9 003507   004306 710000 9                  TRA     s:24393
         9 003510   004306 710000 9                  TRA     s:24393
         9 003511   003705 710000 9                  TRA     s:24329
         9 003512   003514 710000 9                  TRA     s:24297
         9 003513   004160 710000 9                  TRA     s:24370

      936    24296    3            CASE(%RU);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:156  

      937    24297    3              RUKEY.PAGE = 0;

  24297  9 003514   003000 061400                    CSR     bolr='003'O
         9 003515   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         9 003516   004042 670024 6                  BDSC    RUKEY                    by=3,bit=7,n=20

      938    24298    3              ROK = (((B$HEAD.ROSIZE+1)/2)+1023)/1024;

  24298  9 003517   003334 471400 6                  LDP1    HD$
         9 003520   100010 236100                    LDQ     8,,PR1
         9 003521   777777 376007                    ANQ     -1,DL
         9 003522   000001 036007                    ADLQ    1,DL
         9 003523   000001 772000                    QRL     1
         9 003524   001777 036007                    ADLQ    1023,DL
         9 003525   000012 772000                    QRL     10
         9 003526   200057 756100                    STQ     ROK,,AUTO

      939    24299    3              FPT_PRECORD.V.KEYR# = '1'B;

  24299  9 003527   200000 236007                    LDQ     65536,DL
         9 003530   004036 256000 6                  ORSQ    FPT_PRECORD+6

      940    24300    3              FPT_PRECORD.V.KEYS# = '1'B;

  24300  9 003531   400000 236007                    LDQ     -131072,DL
         9 003532   004036 256000 6                  ORSQ    FPT_PRECORD+6

      941    24301    3              FPT_PRECORD.V.N# = ROK;

  24301  9 003533   200057 235100                    LDA     ROK,,AUTO
         9 003534   004037 755000 6                  STA     FPT_PRECORD+7

      942    24302    3              CALL M$PRECORD(FPT_PRECORD) ALTRET(GO1);

  24302  9 003535   004030 630400 6                  EPPR0   FPT_PRECORD
         9 003536   440003 713400                    CLIMB   alt,+16387
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:157  
         9 003537   401000 401760                    pmme    nvectors=3
         9 003540   003541 702000 9                  TSX2    GO1

  24301  9 003541                       GO1          null
      943    24303    3   GO1:       ;
      944    24304    3              VDPGS = ( (B$HEAD.RDATA + %GM_ISR1_BASE - RUKEY.PAGE) +255)/256;

  24304  9 003541   004042 235000 6                  LDA     RUKEY
         9 003542   004043 236000 6                  LDQ     RUKEY+1
         9 003543   000022 773000                    LRL     18
         9 003544   000054 376000 10                 ANQ     44
         9 003545   203650 756100                    STQ     PROREC+128,,AUTO
         9 003546   003334 470400 6                  LDP0    HD$
         9 003547   000002 236100                    LDQ     2,,PR0
         9 003550   000054 376000 10                 ANQ     44
         9 003551   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 003552   200377 036007                    ADLQ    65791,DL
         9 003553   000400 506007                    DIV     256,DL
         9 003554   202701 756100                    STQ     VDPGS,,AUTO

      945    24305    3              VDK = (VDPGS + 7)/8;

  24305  9 003555   000007 036007                    ADLQ    7,DL
         9 003556   000003 772000                    QRL     3
         9 003557   200055 756100                    STQ     VDK,,AUTO

      946    24306    3              VPK = (B$HEAD.VPPGS + 7)/8;

  24306  9 003560   000001 236100                    LDQ     1,,PR0
         9 003561   000026 772000                    QRL     22
         9 003562   000007 036007                    ADLQ    7,DL
         9 003563   000003 772000                    QRL     3
         9 003564   200056 756100                    STQ     VPK,,AUTO

      947    24307    3              PAGES = (ROK + VPK + VDK + 1)*1024;

  24307  9 003565   200057 036100                    ADLQ    ROK,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:158  
         9 003566   200055 036100                    ADLQ    VDK,,AUTO
         9 003567   000012 736000                    QLS     10
         9 003570   002000 036007                    ADLQ    1024,DL
         9 003571   202670 756100                    STQ     PAGES,,AUTO

      948    24308    3              CALL GETSEG(IMAGE$,PAGES) ALTRET(ALT);

  24308  9 003572   202670 631500                    EPPR1   PAGES,,AUTO
         9 003573   203444 451500                    STP1    @TERMID+1,,AUTO
         9 003574   202665 236100                    LDQ     @IMAGE$,,AUTO
         9 003575   203443 756100                    STQ     NOHEADER+3,,AUTO
         9 003576   004316 701000 9                  TSX1    GETSEG
         9 003577   004314 702000 9                  TSX2    ALT

      949    24309    3              ROSOFFSET = POFFW(IMAGE$,BEGIN$);

  24309  9 003600   200053 235100                    LDA     BEGIN$,,AUTO
         9 003601   000022 771000                    ARL     18
         9 003602   203650 755100                    STA     PROREC+128,,AUTO
         9 003603   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 003604   000000 236100                    LDQ     0,,PR0
         9 003605   000022 772000                    QRL     18
         9 003606   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 003607   200033 756100                    STQ     ROSOFFSET,,AUTO

      950    24310    3              DATAOFFSET = ROSOFFSET + ROK * 1024;

  24310  9 003610   200057 236100                    LDQ     ROK,,AUTO
         9 003611   000012 736000                    QLS     10
         9 003612   200033 036100                    ADLQ    ROSOFFSET,,AUTO
         9 003613   200031 756100                    STQ     DATAOFFSET,,AUTO

      951    24311    3              PROCOFFSET = DATAOFFSET + VDK * 1024;

  24311  9 003614   200055 236100                    LDQ     VDK,,AUTO
         9 003615   000012 736000                    QLS     10
         9 003616   200031 036100                    ADLQ    DATAOFFSET,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:159  
         9 003617   200032 756100                    STQ     PROCOFFSET,,AUTO

      952    24312    3              RUKEY.PAGE = 0;

  24312  9 003620   003000 061400                    CSR     bolr='003'O
         9 003621   000002 000044 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=36
         9 003622   004042 670024 6                  BDSC    RUKEY                    by=3,bit=7,n=20

      953    24313    3              FPT_PRECORD.V.N# = 0;

  24313  9 003623   004037 450000 6                  STZ     FPT_PRECORD+7

      954    24314    3              CALL M$PRECORD(FPT_PRECORD) ALTRET(GO2);

  24314  9 003624   004030 630400 6                  EPPR0   FPT_PRECORD
         9 003625   440003 713400                    CLIMB   alt,+16387
         9 003626   401000 401760                    pmme    nvectors=3
         9 003627   003630 702000 9                  TSX2    GO2

      955    24315    3   GO2:       FPT_PRECORD.V.KEYS#='0'B;

  24315  9 003630   000117 236000 10    GO2          LDQ     79
         9 003631   004036 356000 6                  ANSQ    FPT_PRECORD+6

      956    24316    3              CALL M$PRECORD(FPT_PRECORD);

  24316  9 003632   004030 630400 6                  EPPR0   FPT_PRECORD
         9 003633   040003 713400                    CLIMB   16387
         9 003634   401000 401760                    pmme    nvectors=3

      957    24317    3              FPT_READRU.KEY_ = VECTOR(RUKEY);

  24317  9 003635   000124 237000 10                 LDAQ    84
         9 003636   004014 757000 6                  STAQ    FPT_READRU+2

      958    24318    3              BUF$ = ADDR(NIL);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:160  
  24318  9 003637   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 003640   202667 756100                    STQ     BUF$,,AUTO

      959    24319    4              DO WHILE(RUKEY.TYPE=10);

  24319  9 003641   004042 236000 6                  LDQ     RUKEY
         9 003642   000777 376003                    ANQ     511,DU
         9 003643   000012 116003                    CMPQ    10,DU
         9 003644   003673 601000 9                  TNZ     s:24327

      960    24320    4                 IF BUF$ = ADDR(NIL)

  24320  9 003645   202667 236100                    LDQ     BUF$,,AUTO
         9 003646   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 003647   003654 601000 9                  TNZ     s:24322

      961    24321    4                 THEN BUF$ = IMAGE$;

  24321  9 003650   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 003651   000000 236100                    LDQ     0,,PR0
         9 003652   202667 756100                    STQ     BUF$,,AUTO
         9 003653   003656 710000 9                  TRA     s:24323

      962    24322    4                 ELSE BUF$ = PINCRW(BUF$,1024);

  24322  9 003654   002000 036003                    ADLQ    1024,DU
         9 003655   202667 756100                    STQ     BUF$,,AUTO

      963    24323    4                 FPT_READRU.BUF_ = VECTOR(ONEPAGE);

  24323  9 003656   000126 235000 10                 LDA     86
         9 003657   004016 757000 6                  STAQ    FPT_READRU+4

      964    24324    4                 CALL M$READ(FPT_READRU) ALTRET(ALT);

  24324  9 003660   004012 630400 6                  EPPR0   FPT_READRU
         9 003661   440000 713400                    CLIMB   alt,read
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:161  
         9 003662   401400 401760                    pmme    nvectors=4
         9 003663   004314 702000 9                  TSX2    ALT

      965    24325    4                 CALL M$PRECORD(FPT_PRECORD);

  24325  9 003664   004030 630400 6                  EPPR0   FPT_PRECORD
         9 003665   040003 713400                    CLIMB   16387
         9 003666   401000 401760                    pmme    nvectors=3

      966    24326    4                 END;                      /* DO WHILE */

  24326  9 003667   004042 236000 6                  LDQ     RUKEY
         9 003670   000777 376003                    ANQ     511,DU
         9 003671   000012 116003                    CMPQ    10,DU
         9 003672   003645 600000 9                  TZE     s:24320

      967    24327    3              WDSUSED = POFFW(BUF$,IMAGE$) + SIZEW(ONEPAGE);

  24327  9 003673   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 003674   000000 236100                    LDQ     0,,PR0
         9 003675   000022 772000                    QRL     18
         9 003676   203650 756100                    STQ     PROREC+128,,AUTO
         9 003677   202667 236100                    LDQ     BUF$,,AUTO
         9 003700   000022 772000                    QRL     18
         9 003701   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 003702   002000 036007                    ADLQ    1024,DL
         9 003703   200050 756100                    STQ     WDSUSED,,AUTO
         9 003704   004306 710000 9                  TRA     s:24393

      968    24328    3            CASE(%MON);

      969    24329    3              FPT_READRU.BUF_ = VECTOR(B$SECTABLE);

  24329  9 003705   000130 237000 10                 LDAQ    88
         9 003706   004016 757000 6                  STAQ    FPT_READRU+4

      970    24330    3              FPT_READRU.KEY_ = VECTOR(SECTKEY);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:162  

  24330  9 003707   000132 237000 10                 LDAQ    90
         9 003710   004014 757000 6                  STAQ    FPT_READRU+2

      971    24331    3              FPT_READRU.V.KEYS# = '1'B;

  24331  9 003711   200000 236007                    LDQ     65536,DL
         9 003712   004022 256000 6                  ORSQ    FPT_READRU+8

      972    24332    3              CALL M$READ(FPT_READRU) ALTRET(ALT);

  24332  9 003713   004012 630400 6                  EPPR0   FPT_READRU
         9 003714   440000 713400                    CLIMB   alt,read
         9 003715   401400 401760                    pmme    nvectors=4
         9 003716   004314 702000 9                  TSX2    ALT

      973    24333    3              NUMSECTS = B$HEAD.SECTABLESIZE/SIZEW(B$SECTABLE(0)) - 2;

  24333  9 003717   003334 470400 6                  LDP0    HD$
         9 003720   000011 236100                    LDQ     9,,PR0
         9 003721   000007 772000                    QRL     7
         9 003722   000377 376007                    ANQ     255,DL
         9 003723   000001 772000                    QRL     1
         9 003724   000002 136007                    SBLQ    2,DL
         9 003725   200021 756100                    STQ     NUMSECTS,,AUTO

      974    24334    3             B$SECTABLE.SIZE(NUMSECTS) = SIZEW(ONEPAGE) * 2 + B$SECTABLE.SIZE(NUMSECTS
             24334                       +1);

  24334  9 003726   200021 235100                    LDA     NUMSECTS,,AUTO
         9 003727   000001 735000                    ALS     1
         9 003730   004050 236005 6                  LDQ     B$SECTABLE+2,AL
         9 003731   000031 376000 xsym               ANQ     B_VECTNIL+25
         9 003732   004000 036007                    ADLQ    2048,DL
         9 003733   004046 676005 6                  ERQ     B$SECTABLE,AL
         9 003734   000031 376000 xsym               ANQ     B_VECTNIL+25
         9 003735   004046 656005 6                  ERSQ    B$SECTABLE,AL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:163  

      975    24335    3              P$ = ADDR(TEMP_SECTION.NUMSECTS);

  24335  9 003736   000127 236000 10                 LDQ     87
         9 003737   200013 756100                    STQ     P$,,AUTO

      976    24336    3              CALL STORVAL(P$->ONEWORD,NUMSECTS,4);

  24336  9 003740   000025 236000 10                 LDQ     21
         9 003741   202705 756100                    STQ     @L66WD+1,,AUTO
         9 003742   200021 631500                    EPPR1   NUMSECTS,,AUTO
         9 003743   202704 451500                    STP1    @L6DW+1,,AUTO
         9 003744   200013 236100                    LDQ     P$,,AUTO
         9 003745   202703 756100                    STQ     VDPGS+2,,AUTO
         9 003746   004512 701000 9                  TSX1    STORVAL
         9 003747   000000 011000                    NOP     0

      977    24337    3              SECT$ = IMAGE$;

  24337  9 003750   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 003751   000000 236100                    LDQ     0,,PR0
         9 003752   202675 756100                    STQ     SECT$,,AUTO

      978    24338    3              FPT_READRU.KEY_ = VECTOR(RUKEY);

  24338  9 003753   000124 237000 10                 LDAQ    84
         9 003754   004014 757000 6                  STAQ    FPT_READRU+2

      979    24339    3              FPT_PRECORD.V.KEYR# = '0'B;

  24339  9 003755   000134 236000 10                 LDQ     92
         9 003756   004036 356000 6                  ANSQ    FPT_PRECORD+6

      980    24340    3              FPT_READRU.V.KEYS# = '0'B;

  24340  9 003757   004022 356000 6                  ANSQ    FPT_READRU+8

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:164  
      981    24341    4              DO I = NUMSECTS DOWNTO 0;

  24341  9 003760   200021 235100                    LDA     NUMSECTS,,AUTO
         9 003761   202671 755100                    STA     I,,AUTO
         9 003762   004143 710000 9                  TRA     s:24367+2

      982    24342    4                 RUKEY.PAGE = B$SECTABLE.START(I);

  24342  9 003763   202671 235100                    LDA     I,,AUTO
         9 003764   000001 735000                    ALS     1
         9 003765   000044 733000                    LRS     36
         9 003766   000044 402007                    MPY     36,DL
         9 003767   000000 116003                    CMPQ    0,DU
         9 003770   003772 605000 9                  TPL     s:24342+7
         9 003771   000044 036003                    ADLQ    36,DU
         9 003772   003000 061406                    CSR     bolr='003'O
         9 003773   004047 000044 6                  BDSC    B$SECTABLE+1,Q           by=0,bit=0,n=36
         9 003774   004042 670024 6                  BDSC    RUKEY                    by=3,bit=7,n=20

      983    24343    4                 FPT_PRECORD.V.KEYS# = '1'B;

  24343  9 003775   400000 236007                    LDQ     -131072,DL
         9 003776   004036 256000 6                  ORSQ    FPT_PRECORD+6

      984    24344    4                 CALL M$PRECORD(FPT_PRECORD) ALTRET(ALT);

  24344  9 003777   004030 630400 6                  EPPR0   FPT_PRECORD
         9 004000   440003 713400                    CLIMB   alt,+16387
         9 004001   401000 401760                    pmme    nvectors=3
         9 004002   004314 702000 9                  TSX2    ALT

      985    24345    4                 FPT_PRECORD.V.KEYS# = '0'B;

  24345  9 004003   000117 236000 10                 LDQ     79
         9 004004   004036 356000 6                  ANSQ    FPT_PRECORD+6

      986    24346    4                 P$ = ADDR(TEMP_SECTION.SECT.SIZE(I));
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:165  

  24346  9 004005   202671 236100                    LDQ     I,,AUTO
         9 004006   000003 402003                    MPY     3,DU
         9 004007   000135 036000 10                 ADLQ    93
         9 004010   200013 756100                    STQ     P$,,AUTO

      987    24347    4                 SIZE = B$SECTABLE.SIZE(I);

  24347  9 004011   202671 235100                    LDA     I,,AUTO
         9 004012   000001 735000                    ALS     1
         9 004013   004046 236005 6                  LDQ     B$SECTABLE,AL
         9 004014   000031 376000 xsym               ANQ     B_VECTNIL+25
         9 004015   202700 756100                    STQ     SIZE,,AUTO

      988    24348    4                 CALL STORVAL(P$->ONEWORD,SIZE,4);

  24348  9 004016   000025 236000 10                 LDQ     21
         9 004017   202705 756100                    STQ     @L66WD+1,,AUTO
         9 004020   202700 630500                    EPPR0   SIZE,,AUTO
         9 004021   202704 450500                    STP0    @L6DW+1,,AUTO
         9 004022   200013 236100                    LDQ     P$,,AUTO
         9 004023   202703 756100                    STQ     VDPGS+2,,AUTO
         9 004024   004512 701000 9                  TSX1    STORVAL
         9 004025   000000 011000                    NOP     0

      989    24349    4                 OFFSET = POFFW(SECT$,BEGIN$);

  24349  9 004026   200053 235100                    LDA     BEGIN$,,AUTO
         9 004027   000022 771000                    ARL     18
         9 004030   203650 755100                    STA     PROREC+128,,AUTO
         9 004031   202675 236100                    LDQ     SECT$,,AUTO
         9 004032   000022 772000                    QRL     18
         9 004033   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 004034   202676 756100                    STQ     OFFSET,,AUTO

      990    24350    4                 P$ = ADDR(TEMP_SECTION.SECT.OFFSET(I));

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:166  
  24350  9 004035   202671 236100                    LDQ     I,,AUTO
         9 004036   000003 402003                    MPY     3,DU
         9 004037   000136 036000 10                 ADLQ    94
         9 004040   200013 756100                    STQ     P$,,AUTO

      991    24351    4                 CALL STORVAL(P$->ONEWORD,OFFSET,4);

  24351  9 004041   000025 236000 10                 LDQ     21
         9 004042   202705 756100                    STQ     @L66WD+1,,AUTO
         9 004043   202676 630500                    EPPR0   OFFSET,,AUTO
         9 004044   202704 450500                    STP0    @L6DW+1,,AUTO
         9 004045   200013 236100                    LDQ     P$,,AUTO
         9 004046   202703 756100                    STQ     VDPGS+2,,AUTO
         9 004047   004512 701000 9                  TSX1    STORVAL
         9 004050   000000 011000                    NOP     0

      992    24352    4                 P$ = ADDR(TEMP_SECTION.SECT.START(I));

  24352  9 004051   202671 236100                    LDQ     I,,AUTO
         9 004052   000003 402003                    MPY     3,DU
         9 004053   000137 036000 10                 ADLQ    95
         9 004054   200013 756100                    STQ     P$,,AUTO

      993    24353    4                 START = B$SECTABLE.START(I);

  24353  9 004055   202671 235100                    LDA     I,,AUTO
         9 004056   000001 735000                    ALS     1
         9 004057   004047 235005 6                  LDA     B$SECTABLE+1,AL
         9 004060   202677 755100                    STA     START,,AUTO

      994    24354    4                 CALL STORVAL(P$->ONEWORD,START,4);

  24354  9 004061   000025 236000 10                 LDQ     21
         9 004062   202705 756100                    STQ     @L66WD+1,,AUTO
         9 004063   202677 630500                    EPPR0   START,,AUTO
         9 004064   202704 450500                    STP0    @L6DW+1,,AUTO
         9 004065   200013 236100                    LDQ     P$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:167  
         9 004066   202703 756100                    STQ     VDPGS+2,,AUTO
         9 004067   004512 701000 9                  TSX1    STORVAL
         9 004070   000000 011000                    NOP     0

      995    24355    4                 BYTESIZE = B$SECTABLE.SIZE(I) * 2;

  24355  9 004071   202671 235100                    LDA     I,,AUTO
         9 004072   000001 735000                    ALS     1
         9 004073   004046 236005 6                  LDQ     B$SECTABLE,AL
         9 004074   000001 736000                    QLS     1
         9 004075   202674 756100                    STQ     BYTESIZE,,AUTO

      996    24356    4                 BYTESLEFT = BYTESIZE;

  24356  9 004076   202673 756100                    STQ     BYTESLEFT,,AUTO

      997    24357    4                 BUF$ = SECT$;

  24357  9 004077   202675 236100                    LDQ     SECT$,,AUTO
         9 004100   202667 756100                    STQ     BUF$,,AUTO

      998    24358    5                 DO WHILE(BYTESLEFT > 0);

  24358  9 004101   202673 235100                    LDA     BYTESLEFT,,AUTO
         9 004102   004133 604400 9                  TMOZ    s:24366

      999    24359    5                    CALL GETSEG(BUF$,SIZEW(ONEPAGE)) ALTRET(ALT);

  24359  9 004103   000141 236000 10                 LDQ     97
         9 004104   203444 756100                    STQ     @TERMID+1,,AUTO
         9 004105   202667 630500                    EPPR0   BUF$,,AUTO
         9 004106   203443 450500                    STP0    NOHEADER+3,,AUTO
         9 004107   004316 701000 9                  TSX1    GETSEG
         9 004110   004314 702000 9                  TSX2    ALT

     1000    24360    5                    FPT_READRU.BUF_ = VECTOR(ONEPAGE);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:168  
  24360  9 004111   000126 235000 10                 LDA     86
         9 004112   202667 236100                    LDQ     BUF$,,AUTO
         9 004113   004016 757000 6                  STAQ    FPT_READRU+4

     1001    24361    5                    CALL M$READ(FPT_READRU) ALTRET(ALT);

  24361  9 004114   004012 630400 6                  EPPR0   FPT_READRU
         9 004115   440000 713400                    CLIMB   alt,read
         9 004116   401400 401760                    pmme    nvectors=4
         9 004117   004314 702000 9                  TSX2    ALT

     1002    24362    5                    CALL M$PRECORD(FPT_PRECORD) ALTRET(ALT);

  24362  9 004120   004030 630400 6                  EPPR0   FPT_PRECORD
         9 004121   440003 713400                    CLIMB   alt,+16387
         9 004122   401000 401760                    pmme    nvectors=3
         9 004123   004314 702000 9                  TSX2    ALT

     1003    24363    5                    BYTESLEFT = BYTESLEFT - SIZEC(ONEPAGE);

  24363  9 004124   010000 336007                    LCQ     4096,DL
         9 004125   202673 056100                    ASQ     BYTESLEFT,,AUTO

     1004    24364    5                    BUF$ = PINCRW(BUF$,SIZEW(ONEPAGE));

  24364  9 004126   202667 236100                    LDQ     BUF$,,AUTO
         9 004127   002000 036003                    ADLQ    1024,DU
         9 004130   202667 756100                    STQ     BUF$,,AUTO

     1005    24365    5                    END;                   /* DO WHILE */

  24365  9 004131   202673 235100                    LDA     BYTESLEFT,,AUTO
         9 004132   004103 605400 9                  TPNZ    s:24359

     1006    24366    4                 SECT$ = PINCRW(SECT$,(BYTESIZE+3)/4);

  24366  9 004133   202674 236100                    LDQ     BYTESIZE,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:169  
         9 004134   000003 036007                    ADLQ    3,DL
         9 004135   000002 772000                    QRL     2
         9 004136   000022 736000                    QLS     18
         9 004137   202675 036100                    ADLQ    SECT$,,AUTO
         9 004140   202675 756100                    STQ     SECT$,,AUTO

     1007    24367    4                 END;                      /* DO I */

  24367  9 004141   000001 336007                    LCQ     1,DL
         9 004142   202671 056100                    ASQ     I,,AUTO
         9 004143   202671 235100                    LDA     I,,AUTO
         9 004144   003763 605000 9                  TPL     s:24342

     1008    24368    3              WDSUSED = (POFFC(SECT$,IMAGE$)+3)/4;

  24368  9 004145   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 004146   000000 236100                    LDQ     0,,PR0
         9 004147   000020 772000                    QRL     16
         9 004150   203650 756100                    STQ     PROREC+128,,AUTO
         9 004151   202675 236100                    LDQ     SECT$,,AUTO
         9 004152   000020 772000                    QRL     16
         9 004153   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 004154   000003 036007                    ADLQ    3,DL
         9 004155   000004 506007                    DIV     4,DL
         9 004156   200050 756100                    STQ     WDSUSED,,AUTO
         9 004157   004306 710000 9                  TRA     s:24393

     1009    24369    3            CASE(%LIB);

     1010    24370    3              VPK = (B$HEAD.VPPGS+7)/8;

  24370  9 004160   003334 471400 6                  LDP1    HD$
         9 004161   100001 236100                    LDQ     1,,PR1
         9 004162   000026 772000                    QRL     22
         9 004163   000007 036007                    ADLQ    7,DL
         9 004164   000003 772000                    QRL     3
         9 004165   200056 756100                    STQ     VPK,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:170  

     1011    24371    3              VDK = (B$HEAD.VDPGS+7)/8;

  24371  9 004166   100002 236100                    LDQ     2,,PR1
         9 004167   000026 772000                    QRL     22
         9 004170   000007 036007                    ADLQ    7,DL
         9 004171   000003 772000                    QRL     3
         9 004172   200055 756100                    STQ     VDK,,AUTO

     1012    24372    3              PAGES = (VDK + VPK + 1)*1024;

  24372  9 004173   200056 036100                    ADLQ    VPK,,AUTO
         9 004174   000012 736000                    QLS     10
         9 004175   002000 036007                    ADLQ    1024,DL
         9 004176   202670 756100                    STQ     PAGES,,AUTO

     1013    24373    3              CALL GETSEG(IMAGE$,PAGES) ALTRET(ALT);

  24373  9 004177   202670 633500                    EPPR3   PAGES,,AUTO
         9 004200   203444 453500                    STP3    @TERMID+1,,AUTO
         9 004201   202665 236100                    LDQ     @IMAGE$,,AUTO
         9 004202   203443 756100                    STQ     NOHEADER+3,,AUTO
         9 004203   004316 701000 9                  TSX1    GETSEG
         9 004204   004314 702000 9                  TSX2    ALT

     1014    24374    3              DATAOFFSET = POFFW(IMAGE$,BEGIN$);

  24374  9 004205   200053 235100                    LDA     BEGIN$,,AUTO
         9 004206   000022 771000                    ARL     18
         9 004207   203650 755100                    STA     PROREC+128,,AUTO
         9 004210   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 004211   000000 236100                    LDQ     0,,PR0
         9 004212   000022 772000                    QRL     18
         9 004213   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 004214   200031 756100                    STQ     DATAOFFSET,,AUTO

     1015    24375    3              PROCOFFSET = DATAOFFSET + VDK * 1024;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:171  

  24375  9 004215   200055 236100                    LDQ     VDK,,AUTO
         9 004216   000012 736000                    QLS     10
         9 004217   200031 036100                    ADLQ    DATAOFFSET,,AUTO
         9 004220   200032 756100                    STQ     PROCOFFSET,,AUTO

     1016    24376    3              RUKEY.PAGE = B$HEAD.BIAS;

  24376  9 004221   003334 471400 6                  LDP1    HD$
         9 004222   003000 060500                    CSL     bolr='003'O
         9 004223   100023 270024                    BDSC    19,,PR1                  by=1,bit=7,n=20
         9 004224   004042 670024 6                  BDSC    RUKEY                    by=3,bit=7,n=20

     1017    24377    3              FPT_PRECORD.V.KEYR# = '1'B;

  24377  9 004225   200000 236007                    LDQ     65536,DL
         9 004226   004036 256000 6                  ORSQ    FPT_PRECORD+6

     1018    24378    3              FPT_PRECORD.V.KEYS# = '1'B;

  24378  9 004227   400000 236007                    LDQ     -131072,DL
         9 004230   004036 256000 6                  ORSQ    FPT_PRECORD+6

     1019    24379    3              CALL M$PRECORD(FPT_PRECORD) ALTRET(NEXT);

  24379  9 004231   004030 630400 6                  EPPR0   FPT_PRECORD
         9 004232   440003 713400                    CLIMB   alt,+16387
         9 004233   401000 401760                    pmme    nvectors=3
         9 004234   004235 702000 9                  TSX2    NEXT

     1020    24380    3   NEXT:      FPT_PRECORD.V.KEYS# = '0'B;

  24380  9 004235   000117 236000 10    NEXT         LDQ     79
         9 004236   004036 356000 6                  ANSQ    FPT_PRECORD+6

     1021    24381    3              FPT_READRU.KEY_ = VECTOR(RUKEY);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:172  
  24381  9 004237   000124 237000 10                 LDAQ    84
         9 004240   004014 757000 6                  STAQ    FPT_READRU+2

     1022    24382    3              BUF$ = ADDR(NIL);

  24382  9 004241   000001 236000 xsym               LDQ     B_VECTNIL+1
         9 004242   202667 756100                    STQ     BUF$,,AUTO

     1023    24383    4              DO WHILE(RUKEY.TYPE = 10);

  24383  9 004243   004042 236000 6                  LDQ     RUKEY
         9 004244   000777 376003                    ANQ     511,DU
         9 004245   000012 116003                    CMPQ    10,DU
         9 004246   004275 601000 9                  TNZ     s:24391

     1024    24384    4                 IF BUF$ = ADDR(NIL)

  24384  9 004247   202667 236100                    LDQ     BUF$,,AUTO
         9 004250   000001 116000 xsym               CMPQ    B_VECTNIL+1
         9 004251   004256 601000 9                  TNZ     s:24386

     1025    24385    4                 THEN BUF$ = IMAGE$;

  24385  9 004252   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 004253   000000 236100                    LDQ     0,,PR0
         9 004254   202667 756100                    STQ     BUF$,,AUTO
         9 004255   004260 710000 9                  TRA     s:24387

     1026    24386    4                 ELSE BUF$ = PINCRW(BUF$,SIZEW(ONEPAGE));

  24386  9 004256   002000 036003                    ADLQ    1024,DU
         9 004257   202667 756100                    STQ     BUF$,,AUTO

     1027    24387    4                 FPT_READRU.BUF_ = VECTOR(ONEPAGE);

  24387  9 004260   000126 235000 10                 LDA     86
         9 004261   004016 757000 6                  STAQ    FPT_READRU+4
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:173  

     1028    24388    4                 CALL M$READ(FPT_READRU) ALTRET(ALT);

  24388  9 004262   004012 630400 6                  EPPR0   FPT_READRU
         9 004263   440000 713400                    CLIMB   alt,read
         9 004264   401400 401760                    pmme    nvectors=4
         9 004265   004314 702000 9                  TSX2    ALT

     1029    24389    4                 CALL M$PRECORD(FPT_PRECORD);

  24389  9 004266   004030 630400 6                  EPPR0   FPT_PRECORD
         9 004267   040003 713400                    CLIMB   16387
         9 004270   401000 401760                    pmme    nvectors=3

     1030    24390    4                 END;                      /* DO WHILE */

  24390  9 004271   004042 236000 6                  LDQ     RUKEY
         9 004272   000777 376003                    ANQ     511,DU
         9 004273   000012 116003                    CMPQ    10,DU
         9 004274   004247 600000 9                  TZE     s:24384

     1031    24391    3              WDSUSED = POFFW(BUF$,IMAGE$) + SIZEW(ONEPAGE);

  24391  9 004275   202665 470500                    LDP0    @IMAGE$,,AUTO
         9 004276   000000 236100                    LDQ     0,,PR0
         9 004277   000022 772000                    QRL     18
         9 004300   203650 756100                    STQ     PROREC+128,,AUTO
         9 004301   202667 236100                    LDQ     BUF$,,AUTO
         9 004302   000022 772000                    QRL     18
         9 004303   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 004304   002000 036007                    ADLQ    1024,DL
         9 004305   200050 756100                    STQ     WDSUSED,,AUTO

     1032    24392    3            END;                           /* DO CASE(TYPE) */

     1033    24393    2           CALL M$CLOSE(CLOSE_RU) ALTRET(ALT);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:174  
  24393  9 004306   002742 630400 6                  EPPR0   CLOSE_RU
         9 004307   450001 713400                    CLIMB   alt,close
         9 004310   406000 401760                    pmme    nvectors=13
         9 004311   004314 702000 9                  TSX2    ALT

     1034    24394    2           RETURN;

  24394  9 004312   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004313   000001 702211                    TSX2  ! 1,X1

     1035    24395    2   ALT:
     1036    24396    2           ALTRETURN;

  24396  9 004314   202664 221300       ALT          LDX1  ! KL_NETWORK+1281,,AUTO
         9 004315   000000 702211                    TSX2  ! 0,X1

     1037    24397    2   END READ_RU;
     1038    24398        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:175  
     1039    24399    1   GETSEG: PROC(START$,SIZE) ALTRET;

  24399  9 004316   203442 741300       GETSEG       STX1  ! NOHEADER+2,,AUTO

     1040    24400    2   DCL START$ PTR;
     1041    24401    2   DCL SIZE SBIN;
     1042    24402    2   DCL CURSIZE SBIN;
     1043    24403    2   DCL NEWSIZE SBIN;
     1044    24404        /**/
     1045    24405    2           NEWSIZE=POFFW(START$,BEGIN$)+SIZE;

  24405  9 004317   200053 235100                    LDA     BEGIN$,,AUTO
         9 004320   000022 771000                    ARL     18
         9 004321   203650 755100                    STA     PROREC+128,,AUTO
         9 004322   203443 470500                    LDP0    @START$,,AUTO
         9 004323   000000 236100                    LDQ     0,,PR0
         9 004324   000022 772000                    QRL     18
         9 004325   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 004326   203444 471500                    LDP1    @SIZE,,AUTO
         9 004327   100000 036100                    ADLQ    0,,PR1
         9 004330   203446 756100                    STQ     NEWSIZE,,AUTO

     1046    24406    2           IF MOD(NEWSIZE,1024) ~= 0

  24406  9 004331   002000 506007                    DIV     1024,DL
         9 004332   000044 733000                    LRS     36
         9 004333   000000 116003                    CMPQ    0,DU
         9 004334   004344 600000 9                  TZE     s:24408

     1047    24407    2           THEN NEWSIZE=NEWSIZE+1024-MOD(NEWSIZE,1024);

  24407  9 004335   203446 236100                    LDQ     NEWSIZE,,AUTO
         9 004336   002000 506007                    DIV     1024,DL
         9 004337   203650 755100                    STA     PROREC+128,,AUTO
         9 004340   203446 236100                    LDQ     NEWSIZE,,AUTO
         9 004341   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 004342   002000 036007                    ADLQ    1024,DL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:176  
         9 004343   203446 756100                    STQ     NEWSIZE,,AUTO

     1048    24408    2           CURSIZE=(VBOUND(DATASEG))/4;

  24408  9 004344   000014 236000 6                  LDQ     DATASEG
         9 004345   000020 772000                    QRL     16
         9 004346   000002 772000                    QRL     2
         9 004347   203445 756100                    STQ     CURSIZE,,AUTO

     1049    24409    3           IF NEWSIZE>CURSIZE THEN DO;

  24409  9 004350   203446 116100                    CMPQ    NEWSIZE,,AUTO
         9 004351   004362 605000 9                  TPL     s:24413

     1050    24410    3              FPT_GDS.V.SEGSIZE#=NEWSIZE-CURSIZE;

  24410  9 004352   203446 236100                    LDQ     NEWSIZE,,AUTO
         9 004353   203445 136100                    SBLQ    CURSIZE,,AUTO
         9 004354   000000 620006                    EAX0    0,QL
         9 004355   000004 440000 6                  SXL0    FPT_GDS+4

     1051    24411    3              CALL M$GDS(FPT_GDS) ALTRET(ALT);

  24411  9 004356   000000 630400 6                  EPPR0   FPT_GDS
         9 004357   430001 713400                    CLIMB   alt,gds
         9 004360   400400 401760                    pmme    nvectors=2
         9 004361   004364 702000 9                  TSX2    ALT

     1052    24412    3              END;

     1053    24413    2           RETURN;

  24413  9 004362   203442 221300                    LDX1  ! NOHEADER+2,,AUTO
         9 004363   000001 702211                    TSX2  ! 1,X1

     1054    24414    2   ALT:
     1055    24415    2           CALL PMMEERR;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:177  

  24415  9 004364   004370 701000 9     ALT          TSX1    PMMEERR
         9 004365   000000 011000                    NOP     0

     1056    24416    2           ALTRETURN;

  24416  9 004366   203442 221300                    LDX1  ! NOHEADER+2,,AUTO
         9 004367   000000 702211                    TSX2  ! 0,X1

     1057    24417    2   END GETSEG;
     1058    24418        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:178  
     1059    24419    1   PMMEERR: PROC;

  24419  9 004370   203450 741300       PMMEERR      STX1  ! PROSIZE+1,,AUTO

     1060    24420       %FPT_ERRMSG (OUTDCB1=M$DO,SUBMESS=YES,SUBFILE=YES,BUF=ERRBUF,CODE=RET_ERROR,INCLCODE
             24420            =NO);
     1061    24447        %FPT_KEYIN (MESS=ERRBUF,RESULTS=RSLT);
     1062    24466    2   DCL RSLT(0:1) UBIN STATIC;
     1063    24467    2   DCL ERRBUF CHAR(120) STATIC;
     1064    24468        /**/
     1065    24469    2           RET_ERROR=B$ALT.ERR & '777777777770'O;

  24469  9 004371   000000 470400 xsym               LDP0    B$TCB$
         9 004372   000000 471500                    LDP1    0,,PR0
         9 004373   100102 236100                    LDQ     66,,PR1
         9 004374   000030 376000 7                  ANQ     KL_NETWORK_KEY+6
         9 004375   003335 756000 6                  STQ     RET_ERROR

     1066    24470    3           IF WE_PRINT_ERRORS THEN DO;

  24470  9 004376   200065 234100                    SZN     WE_PRINT_ERRORS,,AUTO
         9 004377   004416 605000 9                  TPL     L1

     1067    24471    3              FPT_ERRMSG.V.DCB#=B$ALT.DCB#;

  24471  9 004400   000000 471500                    LDP1    0,,PR0
         9 004401   100101 720100                    LXL0    65,,PR1
         9 004402   004174 740000 6                  STX0    FPT_ERRMSG+22

     1068    24472    3              CALL M$ERRMSG(FPT_ERRMSG);

  24472  9 004403   004146 630400 6                  EPPR0   FPT_ERRMSG
         9 004404   020000 713400                    CLIMB   8192
         9 004405   405000 401760                    pmme    nvectors=11

     1069    24473    3              IF B$JIT.SYSID = 8

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:179  
  24473  9 004406   000000 470400 xsym               LDP0    B$JIT$
         9 004407   000000 720100                    LXL0    0,,PR0
         9 004410   000010 100003                    CMPX0   8,DU
         9 004411   004416 601000 9                  TNZ     L1

     1070    24474    3              THEN CALL M$KEYIN(FPT_KEYIN) ALTRET(L1);

  24474  9 004412   004200 630400 6                  EPPR0   FPT_KEYIN
         9 004413   520000 713400                    CLIMB   alt,+40960
         9 004414   401400 401760                    pmme    nvectors=4
         9 004415   004416 702000 9                  TSX2    L1

  24473  9 004416                       L1           null
     1071    24475    3   L1:        ;
     1072    24476    3              END;

     1073    24477    2           RETURN;

  24477  9 004416   203450 221300                    LDX1  ! PROSIZE+1,,AUTO
         9 004417   000001 702211                    TSX2  ! 1,X1

     1074    24478    2   END PMMEERR;
     1075    24479        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:180  
     1076    24480    1   CLEANUP_DCBS: PROC;

  24480  9 004420   202664 741300       CLEANUP_DCBS STX1  ! KL_NETWORK+1281,,AUTO

     1077    24481        /**/
     1078    24482    2           IF DCBADDR(DCBNUM(M$RU))->F$DCB.FCD# THEN

  24482  9 004421   000000 236007 xsym               LDQ     M$RU,DL
         9 004422   000000 470400 10                 LDP0    0
         9 004423   000000 471500                    LDP1    0,,PR0
         9 004424   100000 473506                    LDP3    0,QL,PR1
         9 004425   300031 236100                    LDQ     25,,PR3
         9 004426   020000 316007                    CANQ    8192,DL
         9 004427   004433 600000 9                  TZE     s:24485

     1079    24483    2              CALL M$CLOSE(CLOSE_RU);

  24483  9 004430   002742 630400 6                  EPPR0   CLOSE_RU
         9 004431   050001 713400                    CLIMB   close
         9 004432   406000 401760                    pmme    nvectors=13

     1080    24484
     1081    24485    3           IF DCBADDR(DCBNUM(M$NETCON))->F$DCB.FCD# AND CLOSE_M$NETCON THEN DO;

  24485  9 004433   000000 236007 xsym               LDQ     M$NETCON,DL
         9 004434   000000 470400 10                 LDP0    0
         9 004435   000000 471500                    LDP1    0,,PR0
         9 004436   100000 473506                    LDP3    0,QL,PR1
         9 004437   300031 236100                    LDQ     25,,PR3
         9 004440   020000 316007                    CANQ    8192,DL
         9 004441   004452 600000 9                  TZE     s:24490
         9 004442   200062 234100                    SZN     CLOSE_M$NETCON,,AUTO
         9 004443   004452 605000 9                  TPL     s:24490

     1082    24486    3              CLOSE_GOODIES.V.DCB# = DCBNUM(M$NETCON);

  24486  9 004444   000000 236007 xsym               LDQ     M$NETCON,DL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:181  
         9 004445   000000 620006                    EAX0    0,QL
         9 004446   002572 740000 6                  STX0    CLOSE_GOODIES+26

     1083    24487    3              CALL M$CLOSE(CLOSE_GOODIES);

  24487  9 004447   002540 630400 6                  EPPR0   CLOSE_GOODIES
         9 004450   050001 713400                    CLIMB   close
         9 004451   406000 401760                    pmme    nvectors=13

     1084    24488    3              END;                         /* IF                                 */

     1085    24489
     1086    24490    3           IF DCBADDR(DCBNUM(M$PROF))->F$DCB.FCD# AND CLOSE_M$PROF THEN DO;

  24490  9 004452   000000 236007 xsym               LDQ     M$PROF,DL
         9 004453   000000 470400 10                 LDP0    0
         9 004454   000000 471500                    LDP1    0,,PR0
         9 004455   100000 473506                    LDP3    0,QL,PR1
         9 004456   300031 236100                    LDQ     25,,PR3
         9 004457   020000 316007                    CANQ    8192,DL
         9 004460   004471 600000 9                  TZE     s:24495
         9 004461   200063 234100                    SZN     CLOSE_M$PROF,,AUTO
         9 004462   004471 605000 9                  TPL     s:24495

     1087    24491    3              CLOSE_GOODIES.V.DCB# = DCBNUM(M$PROF);

  24491  9 004463   000000 236007 xsym               LDQ     M$PROF,DL
         9 004464   000000 620006                    EAX0    0,QL
         9 004465   002572 740000 6                  STX0    CLOSE_GOODIES+26

     1088    24492    3              CALL M$CLOSE(CLOSE_GOODIES);

  24492  9 004466   002540 630400 6                  EPPR0   CLOSE_GOODIES
         9 004467   050001 713400                    CLIMB   close
         9 004470   406000 401760                    pmme    nvectors=13

     1089    24493    3              END;                         /* IF                                 */
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:182  

     1090    24494
     1091    24495    3           IF DCBADDR(DCBNUM(M$HLPF))->F$DCB.FCD# AND CLOSE_M$HLPF THEN DO;

  24495  9 004471   000000 236007 xsym               LDQ     M$HLPF,DL
         9 004472   000000 470400 10                 LDP0    0
         9 004473   000000 471500                    LDP1    0,,PR0
         9 004474   100000 473506                    LDP3    0,QL,PR1
         9 004475   300031 236100                    LDQ     25,,PR3
         9 004476   020000 316007                    CANQ    8192,DL
         9 004477   004510 600000 9                  TZE     s:24500
         9 004500   200064 234100                    SZN     CLOSE_M$HLPF,,AUTO
         9 004501   004510 605000 9                  TPL     s:24500

     1092    24496    3              CLOSE_GOODIES.V.DCB# = DCBNUM(M$HLPF);

  24496  9 004502   000000 236007 xsym               LDQ     M$HLPF,DL
         9 004503   000000 620006                    EAX0    0,QL
         9 004504   002572 740000 6                  STX0    CLOSE_GOODIES+26

     1093    24497    3              CALL M$CLOSE(CLOSE_GOODIES);

  24497  9 004505   002540 630400 6                  EPPR0   CLOSE_GOODIES
         9 004506   050001 713400                    CLIMB   close
         9 004507   406000 401760                    pmme    nvectors=13

     1094    24498    3              END;                         /* IF                                 */

     1095    24499
     1096    24500    2           RETURN;

  24500  9 004510   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004511   000001 702211                    TSX2  ! 1,X1

     1097    24501    2   END CLEANUP_DCBS;
     1098    24502    1   STORVAL: PROC(L6DW,L66WD,SIZE);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:183  
  24502  9 004512   202702 741300       STORVAL      STX1  ! VDPGS+1,,AUTO

     1099    24503    2   DCL 1 L6DW UNAL,
     1100    24504    2         2 BITES(0:3) UBIN(9) UNAL;
     1101    24505    2   DCL 1 L66WD UNAL,
     1102    24506    2         2 * UBIN(4) UNAL,
     1103    24507    2         2 BITES(0:3) UBIN(8) UNAL;
     1104    24508    2   DCL SIZE UBIN;
     1105    24509    2   DCL I SBIN;
     1106    24510        /**/
     1107    24511    3           DO I = 0 TO SIZE - 1;

  24511  9 004513   202706 450100                    STZ     I,,AUTO
         9 004514   004536 710000 9                  TRA     s:24513+1

     1108    24512    3              L6DW.BITES(I)=L66WD.BITES(I);

  24512  9 004515   202706 235100                    LDA     I,,AUTO
         9 004516   000003 735000                    ALS     3
         9 004517   004521 605000 9                  TPL     s:24512+4
         9 004520   000044 035003                    ADLA    36,DU
         9 004521   202706 236100                    LDQ     I,,AUTO
         9 004522   203650 755100                    STA     PROREC+128,,AUTO
         9 004523   000011 402007                    MPY     9,DL
         9 004524   000000 116003                    CMPQ    0,DU
         9 004525   004527 605000 9                  TPL     s:24512+10
         9 004526   000044 036003                    ADLQ    36,DU
         9 004527   202704 470500                    LDP0    @L66WD,,AUTO
         9 004530   203650 235100                    LDA     PROREC+128,,AUTO
         9 004531   202703 471500                    LDP1    @L6DW,,AUTO
         9 004532   003106 061505                    CSR     bolr='003'O
         9 004533   000000 040010                    BDSC    0,A,PR0                  by=0,bit=4,n=8
         9 004534   100000 000011                    BDSC    0,Q,PR1                  by=0,bit=0,n=9

     1109    24513    3              END;

  24513  9 004535   202706 054100                    AOS     I,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:184  
         9 004536   202705 470500                    LDP0    @SIZE,,AUTO
         9 004537   202706 236100                    LDQ     I,,AUTO
         9 004540   004515 604000 9                  TMI     s:24512
         9 004541   000000 116100                    CMPQ    0,,PR0
         9 004542   004515 602000 9                  TNC     s:24512

     1110    24514    2           RETURN;

  24514  9 004543   202702 221300                    LDX1  ! VDPGS+1,,AUTO
         9 004544   000001 702211                    TSX2  ! 1,X1

     1111    24515    2   END STORVAL;
     1112    24516
     1113    24517
     1114    24518    1   ALIGNPTR: PROC(POINTER);

  24518  9 004545   202664 741300       ALIGNPTR     STX1  ! KL_NETWORK+1281,,AUTO

     1115    24519
     1116    24520        /* Align pointer to L66 word boundary */
     1117    24521
     1118    24522    2   DCL 1 POINTER ALIGNED,
     1119    24523    2         2 WA UBIN(18) UNAL,
     1120    24524    2         2 CA UBIN(2) UNAL,
     1121    24525    2         2 BA UBIN(4) UNAL,
     1122    24526    2         2 SID BIT(12);
     1123    24527
     1124    24528    3           IF POINTER.CA~=0 OR POINTER.BA~=0 THEN DO;

  24528  9 004546   202665 470500                    LDP0    @POINTER,,AUTO
         9 004547   000000 236100                    LDQ     0,,PR0
         9 004550   600000 316007                    CANQ    -65536,DL
         9 004551   004554 601000 9                  TNZ     s:24529
         9 004552   170000 316007                    CANQ    61440,DL
         9 004553   004563 600000 9                  TZE     s:24533

     1125    24529    3              POINTER.WA=POINTER.WA+1;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:185  

  24529  9 004554   000000 220100                    LDX0    0,,PR0
         9 004555   000001 622010                    EAX2    1,X0
         9 004556   000000 742100                    STX2    0,,PR0

     1126    24530    3              POINTER.CA=0;

  24530  9 004557   000142 236000 10                 LDQ     98
         9 004560   000000 356100                    ANSQ    0,,PR0

     1127    24531    3              POINTER.BA=0;

  24531  9 004561   000143 236000 10                 LDQ     99
         9 004562   000000 356100                    ANSQ    0,,PR0

     1128    24532    3              END;

     1129    24533    2           RETURN;

  24533  9 004563   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004564   000001 702211                    TSX2  ! 1,X1

     1130    24534
     1131    24535    2   END ALIGNPTR;
     1132    24536        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:186  
     1133    24537    1   FIND_SAVEX: PROC(FEX,SAVX) ALTRET;

  24537  9 004565   202670 741300       FIND_SAVEX   STX1  ! PAGES,,AUTO

     1134    24538        /**/
     1135    24539    2   DCL FEX UBIN;
     1136    24540    2   DCL SAVX UBIN;
     1137    24541    2   DCL I UBIN;
     1138    24542        /**/
     1139    24543    3           DO I=0 TO KI_FEMAX#;

  24543  9 004566   202673 450100                    STZ     I,,AUTO

     1140    24544    4              IF SAVE_INFO.FEX(I)=FEX THEN DO;

  24544  9 004567   202671 470500                    LDP0    @FEX,,AUTO
         9 004570   202673 236100                    LDQ     I,,AUTO
         9 004571   000014 402007                    MPY     12,DL
         9 004572   000016 236006 6                  LDQ     SAVE_INFO,QL
         9 004573   004603 604000 9                  TMI     s:24548
         9 004574   000000 116100                    CMPQ    0,,PR0
         9 004575   004603 601000 9                  TNZ     s:24548

     1141    24545    4                 SAVX=I;

  24545  9 004576   202672 471500                    LDP1    @SAVX,,AUTO
         9 004577   202673 235100                    LDA     I,,AUTO
         9 004600   100000 755100                    STA     0,,PR1

     1142    24546    4                 RETURN;

  24546  9 004601   202670 221300                    LDX1  ! PAGES,,AUTO
         9 004602   000001 702211                    TSX2  ! 1,X1

     1143    24547    4                 END;
     1144    24548    3              END;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:187  
  24548  9 004603   202673 235100                    LDA     I,,AUTO
         9 004604   000001 035007                    ADLA    1,DL
         9 004605   202673 755100                    STA     I,,AUTO
         9 004606   000144 115007                    CMPA    100,DL
         9 004607   004567 602000 9                  TNC     s:24544

     1145    24549    2           ALTRETURN;

  24549  9 004610   202670 221300                    LDX1  ! PAGES,,AUTO
         9 004611   000000 702211                    TSX2  ! 0,X1

     1146    24550    2   END FIND_SAVEX;
     1147    24551        /**/
     1148    24552        /**/
     1149    24553    1   GET_SAVEX: PROC(FEX,SAVX) ALTRET;

  24553  9 004612   202664 741300       GET_SAVEX    STX1  ! KL_NETWORK+1281,,AUTO

     1150    24554        /**/
     1151    24555    2   DCL FEX UBIN;
     1152    24556    2   DCL SAVX UBIN;
     1153    24557    2   DCL I UBIN;
     1154    24558        /**/
     1155    24559    2           CALL FIND_SAVEX(FEX,SAVEX)

  24559  9 004613   200061 630500                    EPPR0   SAVEX,,AUTO
         9 004614   202672 450500                    STP0    @SAVX,,AUTO
         9 004615   202665 236100                    LDQ     @FEX,,AUTO
         9 004616   202671 756100                    STQ     @FEX,,AUTO
         9 004617   004565 701000 9                  TSX1    FIND_SAVEX
         9 004620   004623 702000 9                  TSX2    s:24564

     1156    24560    3           WHENRETURN DO;

     1157    24561    3              RETURN;

  24561  9 004621   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:188  
         9 004622   000001 702211                    TSX2  ! 1,X1

     1158    24562    3              END;
     1159    24563    3           WHENALTRETURN DO;

     1160    24564    4              DO I=0 TO KI_FEMAX#;

  24564  9 004623   202667 450100                    STZ     I,,AUTO

     1161    24565    5                 IF SAVE_INFO.FEX(I)=-1 THEN DO;

  24565  9 004624   202667 236100                    LDQ     I,,AUTO
         9 004625   000014 402007                    MPY     12,DL
         9 004626   000016 235006 6                  LDA     SAVE_INFO,QL
         9 004627   000027 115000 xsym               CMPA    B_VECTNIL+23
         9 004630   004646 601000 9                  TNZ     s:24572

     1162    24566    5                    SAVE_INFO.FEX(I)=FEX;

  24566  9 004631   202665 470500                    LDP0    @FEX,,AUTO
         9 004632   000000 235100                    LDA     0,,PR0
         9 004633   000016 755006 6                  STA     SAVE_INFO,QL

     1163    24567    5                    SAVE_INFO.DFNAME.L(I)=0;

  24567  9 004634   000000 620006                    EAX0    0,QL
         9 004635   000032 236000 xsym               LDQ     B_VECTNIL+26
         9 004636   000022 356010 6                  ANSQ    SAVE_INFO+4,X0

     1164    24568    5                    SAVE_INFO.DATASEG(I)=VECTOR(NIL);

  24568  9 004637   000010 237000 10                 LDAQ    8
         9 004640   000020 757010 6                  STAQ    SAVE_INFO+2,X0

     1165    24569    5                    SAVX=I;

  24569  9 004641   202666 471500                    LDP1    @SAVX,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:189  
         9 004642   202667 235100                    LDA     I,,AUTO
         9 004643   100000 755100                    STA     0,,PR1

     1166    24570    5                    RETURN;

  24570  9 004644   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004645   000001 702211                    TSX2  ! 1,X1

     1167    24571    5                    END;
     1168    24572    4                 END;

  24572  9 004646   202667 235100                    LDA     I,,AUTO
         9 004647   000001 035007                    ADLA    1,DL
         9 004650   202667 755100                    STA     I,,AUTO
         9 004651   000144 115007                    CMPA    100,DL
         9 004652   004624 602000 9                  TNC     s:24565

     1169    24573    3              END;

     1170    24574    2           ALTRETURN;

  24574  9 004653   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004654   000000 702211                    TSX2  ! 0,X1

     1171    24575        /**/
     1172    24576    2   END GET_SAVEX;
     1173    24577        /**/
     1174    24578        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:190  
     1175    24579    1   CONFIG_LINK: PROC(ERR) ALTRET;

  24579  9 004655   202664 741300       CONFIG_LINK  STX1  ! KL_NETWORK+1281,,AUTO

     1176    24580
     1177    24581    2   DCL ERR BIT(36) ALIGNED ;
     1178    24582
     1179    24583        /* KL$LINK */
     1180    24584
     1181    24585        %KL$LINK (NAME=KL$LINK,STCLASS=AUTO,NUM=5);
     1182    24614        %KL$LINK_KEY (NAME=KL_LINK_KEY,STCLASS=STATIC);
     1183    24632
     1184    24633        /* KL$LINCNFG */
     1185    24634
     1186    24635        %KL$LINCNFG (NAME=KL$LINCNFG,STCLASS=AUTO,LGNSIZ=200);
     1187    24793        %KL$CONFIG_KEY (NAME=KL_LINCNFG_KEY,STCLASS=STATIC);
     1188    24840
     1189    24841        /* KL$HLPR */
     1190    24842
     1191    24843        %KL_DREC (NAME=KL$HLPR,STCLASS=AUTO,LAST=",");
     1192    24956    2         2 REST(0:256) UBIN WORD;
     1193    24957    2   DCL 1 KL_HLPR_KEY STATIC,
     1194    24958    2         2 L UBIN BYTE CALIGNED,
     1195    24959    2         2 ACCT CHAR(8),
     1196    24960    2         2 UNAME CHAR(12);
     1197    24961    2   DCL HLP$ PTR;
     1198    24962
     1199    24963        /* KL_CHNRSP */
     1200    24964
     1201    24965    2   DCL CHNRSP$ PTR;
     1202    24966        %KL_CHNRSP (FPTN=KL$CHNRSP,STCLASS="BASED(CHNRSP$)",MSGSIZE=1,ALGN=CALIGNED);
     1203    25186
     1204    25187        /* KL$LNK */
     1205    25188
     1206    25189    2   DCL LNK$ PTR;
     1207    25190        %KL_LNK (NAME=KL$LNK,STCLASS="BASED(LNK$)",ALGN=CALIGNED);
     1208    25414        %KL_LNKVC (NAME=KL$LNKVC,STCLASS="BASED(LNK$)",ALGN=CALIGNED);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:191  
     1209    25638
     1210    25639        /* LOCAL */
     1211    25640
     1212    25641    2   DCL LINKX UBIN;
     1213    25642    2   DCL PROFILE$ PTR;
     1214    25643    2   DCL ACCT CHAR(8);
     1215    25644    2   DCL 1 UNAME CALIGNED,
     1216    25645    2         2 L UBIN BYTE CALIGNED,
     1217    25646    2         2 C CHAR(12);
     1218    25647    2   DCL PW CHAR(8);
     1219    25648    2   DCL 1 PRONAME CALIGNED,
     1220    25649    2         2 L UBIN BYTE CALIGNED,
     1221    25650    2         2 C CHAR(11);
     1222    25651    2   DCL HOSTNAME CHAR(8);
     1223    25652    2   DCL NSUBS UBIN;
     1224    25653    2   DCL SUBX UBIN;
     1225    25654    2   DCL CHNRSPLEN UBIN;
     1226    25655    2   DCL TEMP UBIN;
     1227    25656    2   DCL HALFB UBIN HALF BASED CALIGNED;
     1228    25657    2   DCL PROLEN UBIN;
     1229    25658    2   DCL NOSETUP BIT (1) ALIGNED;
     1230    25659    2   DCL NOHEADER BIT (1) ALIGNED;
     1231    25660
     1232    25661        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:192  
     1233    25662
     1234    25663    2           KL_LINK_KEY.NODE=FEX;

  25663  9 004656   200003 470500                    LDP0    @FEX,,AUTO
         9 004657   000000 236100                    LDQ     0,,PR0
         9 004660   000011 736000                    QLS     9
         9 004661   004256 552010 6                  STBQ    KL_LINK_KEY,'10'O

     1235    25664    2           READ_NETCON.KEY_=VECTOR(KL_LINK_KEY);

  25664  9 004662   000144 237000 10                 LDAQ    100
         9 004663   002600 757000 6                  STAQ    READ_NETCON+2

     1236    25665    2           READ_NETCON.BUF_=VECTOR(KL$LINK);

  25665  9 004664   000146 235000 10                 LDA     102
         9 004665   203650 452500                    STP2    PROREC+128,,AUTO
         9 004666   203650 236100                    LDQ     PROREC+128,,AUTO
         9 004667   002666 036003                    ADLQ    1462,DU
         9 004670   002602 757000 6                  STAQ    READ_NETCON+4

     1237    25666    3           CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  25666  9 004671   002576 630400 6                  EPPR0   READ_NETCON
         9 004672   440000 713400                    CLIMB   alt,read
         9 004673   401400 401760                    pmme    nvectors=4
         9 004674   004676 702000 9                  TSX2    s:25667
         9 004675   004705 710000 9                  TRA     LINK

     1238    25667    3              ERR=B$ALT.ERR;

  25667  9 004676   000000 470400 xsym               LDP0    B$TCB$
         9 004677   000000 471500                    LDP1    0,,PR0
         9 004700   100102 236100                    LDQ     66,,PR1
         9 004701   202665 473500                    LDP3    @ERR,,AUTO
         9 004702   300000 756100                    STQ     0,,PR3

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:193  
     1239    25668    3              ALTRETURN;

  25668  9 004703   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004704   000000 702211                    TSX2  ! 0,X1

     1240    25669    3              END;
     1241    25670
     1242    25671    3   LINK:   DO LINKX=0 TO KL$LINK.LINKS#-1;

  25671  9 004705   203413 450100       LINK         STZ     LINKX,,AUTO
         9 004706   005572 710000 9                  TRA     s:25785+3

     1243    25672    3              LNK$=PINCRC(NEXT$,2);

  25672  9 004707   200052 236100                    LDQ     NEXT$,,AUTO
         9 004710   400000 036007                    ADLQ    -131072,DL
         9 004711   203412 756100                    STQ     LNK$,,AUTO

     1244    25673    3              CHNRSP$=PINCRC(LNK$,SIZEC(KL$LNK));

  25673  9 004712   000014 036003                    ADLQ    12,DU
         9 004713   203411 756100                    STQ     CHNRSP$,,AUTO

     1245    25674    3              PROFILE$=ADDR(KL$CHNRSP.MESSAGE.MESSAGE);

  25674  9 004714   000065 036000 10                 ADLQ    53
         9 004715   203414 756100                    STQ     PROFILE$,,AUTO

     1246    25675
     1247    25676    4              CALL GETSEG(NEXT$,512) WHENALTRETURN DO;

  25676  9 004716   000150 236000 10                 LDQ     104
         9 004717   203444 756100                    STQ     @SIZE,,AUTO
         9 004720   200052 630500                    EPPR0   NEXT$,,AUTO
         9 004721   203443 450500                    STP0    @START$,,AUTO
         9 004722   004316 701000 9                  TSX1    GETSEG
         9 004723   004725 702000 9                  TSX2    s:25677
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:194  
         9 004724   004734 710000 9                  TRA     s:25681

     1248    25677    4                 ERR=B$ALT.ERR;

  25677  9 004725   000000 470400 xsym               LDP0    B$TCB$
         9 004726   000000 471500                    LDP1    0,,PR0
         9 004727   100102 236100                    LDQ     66,,PR1
         9 004730   202665 473500                    LDP3    @ERR,,AUTO
         9 004731   300000 756100                    STQ     0,,PR3

     1249    25678    4                 ALTRETURN;

  25678  9 004732   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004733   000000 702211                    TSX2  ! 0,X1

     1250    25679    4                 END;
     1251    25680
     1252    25681    3              KL_LINCNFG_KEY.NODE=FEX;

  25681  9 004734   200003 470500                    LDP0    @FEX,,AUTO
         9 004735   000000 236100                    LDQ     0,,PR0
         9 004736   000011 736000                    QLS     9
         9 004737   004257 552010 6                  STBQ    KL_LINCNFG_KEY,'10'O

     1253    25682    3              CALL SCRUB_TERMID(KL_LINCNFG_KEY.TERMID,%TERMINAL_ID_LEV_CHAN#);

  25682  9 004740   000024 236000 10                 LDQ     20
         9 004741   203444 756100                    STQ     @SIZE,,AUTO
         9 004742   000151 236000 10                 LDQ     105
         9 004743   203443 756100                    STQ     @START$,,AUTO
         9 004744   005656 701000 9                  TSX1    SCRUB_TERMID
         9 004745   000000 011000                    NOP     0

     1254    25683    3              KL_LINCNFG_KEY.TERMID.TERM.CHANNEL=KL$LINK.CHANNEL(LINKX);

  25683  9 004746   203413 235100                    LDA     LINKX,,AUTO
         9 004747   000001 735000                    ALS     1
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:195  
         9 004750   000000 100505                    MLR     fill='000'O
         9 004751   202667 000002                    ADSC9   I,A,AUTO                 cn=0,n=2
         9 004752   004260 200002 6                  ADSC9   KL_LINCNFG_KEY+1         cn=1,n=2

     1255    25684    3              READ_NETCON.KEY_=VECTOR(KL_LINCNFG_KEY);

  25684  9 004753   000152 237000 10                 LDAQ    106
         9 004754   002600 757000 6                  STAQ    READ_NETCON+2

     1256    25685    3              READ_NETCON.BUF_=VECTOR(KL$LINCNFG);

  25685  9 004755   000154 235000 10                 LDA     108
         9 004756   203650 452500                    STP2    PROREC+128,,AUTO
         9 004757   203650 236100                    LDQ     PROREC+128,,AUTO
         9 004760   002672 036003                    ADLQ    1466,DU
         9 004761   002602 757000 6                  STAQ    READ_NETCON+4

     1257    25686    4              CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  25686  9 004762   002576 630400 6                  EPPR0   READ_NETCON
         9 004763   440000 713400                    CLIMB   alt,read
         9 004764   401400 401760                    pmme    nvectors=4
         9 004765   004767 702000 9                  TSX2    s:25687
         9 004766   004776 710000 9                  TRA     s:25691

     1258    25687    4                 ERR=B$ALT.ERR;

  25687  9 004767   000000 470400 xsym               LDP0    B$TCB$
         9 004770   000000 471500                    LDP1    0,,PR0
         9 004771   100102 236100                    LDQ     66,,PR1
         9 004772   202665 473500                    LDP3    @ERR,,AUTO
         9 004773   300000 756100                    STQ     0,,PR3

     1259    25688    4                 ALTRETURN;

  25688  9 004774   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 004775   000000 702211                    TSX2  ! 0,X1
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:196  

     1260    25689    4                 END;
     1261    25690
     1262    25691    3             CALL KLH$SGSCAN(KL$LINCNFG.LGN,ACCT,UNAME,PW,PRONAME,ERR,HOSTNAME,NOSETUP
             25691                       ,NOHEADER)

  25691  9 004776   203440 630500                    EPPR0   NOHEADER,,AUTO
         9 004777   203660 450500                    STP0    PROREC+136,,AUTO
         9 005000   203437 631500                    EPPR1   NOSETUP,,AUTO
         9 005001   203657 451500                    STP1    PROREC+135,,AUTO
         9 005002   203430 633500                    EPPR3   HOSTNAME,,AUTO
         9 005003   203656 453500                    STP3    PROREC+134,,AUTO
         9 005004   202665 236100                    LDQ     @ERR,,AUTO
         9 005005   203655 756100                    STQ     PROREC+133,,AUTO
         9 005006   203425 634500                    EPPR4   PRONAME,,AUTO
         9 005007   203654 454500                    STP4    PROREC+132,,AUTO
         9 005010   203423 635500                    EPPR5   PW,,AUTO
         9 005011   203653 455500                    STP5    PROREC+131,,AUTO
         9 005012   203417 636500                    EPPR6   UNAME,,AUTO
         9 005013   203652 456500                    STP6    PROREC+130,,AUTO
         9 005014   203415 637500                    EPPR7   ACCT,,AUTO
         9 005015   203651 457500                    STP7    PROREC+129,,AUTO
         9 005016   203661 452500                    STP2    PROREC+137,,AUTO
         9 005017   203661 236100                    LDQ     PROREC+137,,AUTO
         9 005020   000156 036000 10                 ADLQ    110
         9 005021   203650 756100                    STQ     PROREC+128,,AUTO
         9 005022   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005023   000155 631400 10                 EPPR1   109
         9 005024   000000 701000 xent               TSX1    KLH$SGSCAN
         9 005025   005065 702000 9                  TSX2    s:25704

     1263    25692    4              WHENRETURN DO;

     1264    25693    4                 KL_HLPR_KEY.ACCT=ACCT;

  25693  9 005026   040000 100500                    MLR     fill='040'O
         9 005027   203415 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:197  
         9 005030   004264 200010 6                  ADSC9   KL_HLPR_KEY              cn=1,n=8

     1265    25694    4                 KL_HLPR_KEY.UNAME=UNAME.C;

  25694  9 005031   040000 100500                    MLR     fill='040'O
         9 005032   203417 200014                    ADSC9   UNAME,,AUTO              cn=1,n=12
         9 005033   004266 200014 6                  ADSC9   KL_HLPR_KEY+2            cn=1,n=12

     1266    25695    4                 KL_HLPR_KEY.L=SIZEC(KL_HLPR_KEY.ACCT)+UNAME.L;

  25695  9 005034   203417 236100                    LDQ     UNAME,,AUTO
         9 005035   000033 772000                    QRL     27
         9 005036   000010 036007                    ADLQ    8,DL
         9 005037   000033 736000                    QLS     27
         9 005040   004264 552040 6                  STBQ    KL_HLPR_KEY,'40'O

     1267    25696    4                 READ_HLP.KEY_=VECTOR(KL_HLPR_KEY);

  25696  9 005041   000160 237000 10                 LDAQ    112
         9 005042   002634 757000 6                  STAQ    READ_HLP+2

     1268    25697    4                 READ_HLP.BUF_=VECTOR(KL$HLPR);

  25697  9 005043   000157 235000 10                 LDA     111
         9 005044   203650 452500                    STP2    PROREC+128,,AUTO
         9 005045   203650 236100                    LDQ     PROREC+128,,AUTO
         9 005046   002767 036003                    ADLQ    1527,DU
         9 005047   002636 757000 6                  STAQ    READ_HLP+4

     1269    25698    5                 CALL M$READ(READ_HLP) WHENALTRETURN DO;

  25698  9 005050   002632 630400 6                  EPPR0   READ_HLP
         9 005051   440000 713400                    CLIMB   alt,read
         9 005052   401400 401760                    pmme    nvectors=4
         9 005053   005055 702000 9                  TSX2    s:25699
         9 005054   005064 710000 9                  TRA     s:25702

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:198  
     1270    25699    5                    ERR=B$ALT.ERR;

  25699  9 005055   000000 470400 xsym               LDP0    B$TCB$
         9 005056   000000 471500                    LDP1    0,,PR0
         9 005057   100102 236100                    LDQ     66,,PR1
         9 005060   202665 473500                    LDP3    @ERR,,AUTO
         9 005061   300000 756100                    STQ     0,,PR3

     1271    25700    5                    ALTRETURN;

  25700  9 005062   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 005063   000000 702211                    TSX2  ! 0,X1

     1272    25701    5                    END;
     1273    25702    4                 END;

  25702  9 005064   005070 710000 9                  TRA     s:25706

     1274    25703    4              WHENALTRETURN DO;

     1275    25704    4                 KL$HLPR = '0'B;

  25704  9 005065   000100 100400                    MLR     fill='000'O
         9 005066   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 005067   202767 002104                    ADSC9   KL$HLPR,,AUTO            cn=0,n=1092

     1276    25705    4                 END;

     1277    25706    3              HLP$=ADDR(KL$HLPR.REST);

  25706  9 005070   203007 630500                    EPPR0   KL$HLPR+16,,AUTO
         9 005071   203410 450500                    STP0    HLP$,,AUTO

     1278    25707    3              LNK$->KL$LNK=HLP$->KL$LNK;

  25707  9 005072   203412 471500                    LDP1    LNK$,,AUTO
         9 005073   000100 100500                    MLR     fill='000'O
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:199  
         9 005074   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48
         9 005075   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

     1279    25708    3              TEMP = HLP$->KL$LNK.LIC;

  25708  9 005076   000100 101500                    MRL     fill='000'O
         9 005077   000004 000002                    ADSC9   4,,PR0                   cn=0,n=2
         9 005100   203435 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

     1280    25709    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.LIC,2);

  25709  9 005101   000052 236000 10                 LDQ     42
         9 005102   203652 756100                    STQ     PROREC+130,,AUTO
         9 005103   203412 236100                    LDQ     LNK$,,AUTO
         9 005104   000004 036003                    ADLQ    4,DU
         9 005105   203651 756100                    STQ     PROREC+129,,AUTO
         9 005106   203435 633500                    EPPR3   TEMP,,AUTO
         9 005107   203650 453500                    STP3    PROREC+128,,AUTO
         9 005110   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005111   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005112   000000 701000 xent               TSX1    KFF$9TO8
         9 005113   000000 011000                    NOP     0

     1281    25710    3              TEMP = HLP$->KL$LNK.HIC;

  25710  9 005114   203410 470500                    LDP0    HLP$,,AUTO
         9 005115   000100 101500                    MRL     fill='000'O
         9 005116   000004 400002                    ADSC9   4,,PR0                   cn=2,n=2
         9 005117   203435 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

     1282    25711    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.HIC,2);

  25711  9 005120   000052 236000 10                 LDQ     42
         9 005121   203652 756100                    STQ     PROREC+130,,AUTO
         9 005122   203412 236100                    LDQ     LNK$,,AUTO
         9 005123   000162 036000 10                 ADLQ    114
         9 005124   203651 756100                    STQ     PROREC+129,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:200  
         9 005125   203435 631500                    EPPR1   TEMP,,AUTO
         9 005126   203650 451500                    STP1    PROREC+128,,AUTO
         9 005127   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005130   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005131   000000 701000 xent               TSX1    KFF$9TO8
         9 005132   000000 011000                    NOP     0

     1283    25712    3              TEMP = HLP$->KL$LNK.LOC;

  25712  9 005133   203410 470500                    LDP0    HLP$,,AUTO
         9 005134   000100 101500                    MRL     fill='000'O
         9 005135   000005 000002                    ADSC9   5,,PR0                   cn=0,n=2
         9 005136   203435 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

     1284    25713    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.LOC,2);

  25713  9 005137   000052 236000 10                 LDQ     42
         9 005140   203652 756100                    STQ     PROREC+130,,AUTO
         9 005141   203412 236100                    LDQ     LNK$,,AUTO
         9 005142   000005 036003                    ADLQ    5,DU
         9 005143   203651 756100                    STQ     PROREC+129,,AUTO
         9 005144   203435 631500                    EPPR1   TEMP,,AUTO
         9 005145   203650 451500                    STP1    PROREC+128,,AUTO
         9 005146   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005147   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005150   000000 701000 xent               TSX1    KFF$9TO8
         9 005151   000000 011000                    NOP     0

     1285    25714    3              TEMP = HLP$->KL$LNK.HOC;

  25714  9 005152   203410 470500                    LDP0    HLP$,,AUTO
         9 005153   000100 101500                    MRL     fill='000'O
         9 005154   000005 400002                    ADSC9   5,,PR0                   cn=2,n=2
         9 005155   203435 000004                    ADSC9   TEMP,,AUTO               cn=0,n=4

     1286    25715    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.HOC,2);

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:201  
  25715  9 005156   000052 236000 10                 LDQ     42
         9 005157   203652 756100                    STQ     PROREC+130,,AUTO
         9 005160   203412 236100                    LDQ     LNK$,,AUTO
         9 005161   000163 036000 10                 ADLQ    115
         9 005162   203651 756100                    STQ     PROREC+129,,AUTO
         9 005163   203435 631500                    EPPR1   TEMP,,AUTO
         9 005164   203650 451500                    STP1    PROREC+128,,AUTO
         9 005165   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005166   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005167   000000 701000 xent               TSX1    KFF$9TO8
         9 005170   000000 011000                    NOP     0

     1287    25716    3              NSUBS=LNK$->KL$LNK.BLKHDR.NSUBS;

  25716  9 005171   203412 470500                    LDP0    LNK$,,AUTO
         9 005172   000100 101500                    MRL     fill='000'O
         9 005173   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         9 005174   203432 000004                    ADSC9   NSUBS,,AUTO              cn=0,n=4

     1288    25717
     1289    25718    3              KL$CHNRSP='0'B;

  25718  9 005175   203411 471500                    LDP1    CHNRSP$,,AUTO
         9 005176   000100 100400                    MLR     fill='000'O
         9 005177   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 005200   100000 000067                    ADSC9   0,,PR1                   cn=0,n=55

     1290    25719    3              KL$CHNRSP.FCN=%IGA_CHNRSP;

  25719  9 005201   000100 101400                    MRL     fill='000'O
         9 005202   000164 000004 10                 ADSC9   116                      cn=0,n=4
         9 005203   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

     1291    25720    3              KL$CHNRSP.TERMINAL_ID=KL_LINCNFG_KEY.TERMID;

  25720  9 005204   000100 100400                    MLR     fill='000'O
         9 005205   004257 600020 6                  ADSC9   KL_LINCNFG_KEY           cn=3,n=16
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:202  
         9 005206   100002 400020                    ADSC9   2,,PR1                   cn=2,n=16

     1292    25721    3              KL$CHNRSP.TERMINAL_ID.TERM.TERM_NAME = ACCT;

  25721  9 005207   040100 100500                    MLR     fill='040'O
         9 005210   203415 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         9 005211   100004 400010                    ADSC9   4,,PR1                   cn=2,n=8

     1293    25722    3              KL$CHNRSP.NA=KL$LINCNFG.NA;

  25722  9 005212   000100 100500                    MLR     fill='000'O
         9 005213   202676 400010                    ADSC9   OFFSET,,AUTO             cn=2,n=8
         9 005214   100006 400010                    ADSC9   6,,PR1                   cn=2,n=8

     1294    25723    3              KL$CHNRSP.HNDCMN=KL$LINCNFG.KHA;

  25723  9 005215   000100 100500                    MLR     fill='000'O
         9 005216   202672 000022                    ADSC9   KL$LINCNFG,,AUTO         cn=0,n=18
         9 005217   100010 400022                    ADSC9   8,,PR1                   cn=2,n=18

     1295    25724    3              CHNRSPLEN=POFFC(ADDR(KL$CHNRSP.MESSAGE.MESSAGE),CHNRSP$);

  25724  9 005220   203411 236100                    LDQ     CHNRSP$,,AUTO
         9 005221   000065 036000 10                 ADLQ    53
         9 005222   000020 772000                    QRL     16
         9 005223   203650 756100                    STQ     PROREC+128,,AUTO
         9 005224   203411 236100                    LDQ     CHNRSP$,,AUTO
         9 005225   000020 772000                    QRL     16
         9 005226   203651 756100                    STQ     PROREC+129,,AUTO
         9 005227   203650 236100                    LDQ     PROREC+128,,AUTO
         9 005230   203651 136100                    SBLQ    PROREC+129,,AUTO
         9 005231   203434 756100                    STQ     CHNRSPLEN,,AUTO

     1296    25725
     1297    25726    3              LNK$->KL$LNK.BLKHDR.PROOFFSET=POFFC(PROFILE$,LNK$);

  25726  9 005232   203412 236100                    LDQ     LNK$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:203  
         9 005233   000020 772000                    QRL     16
         9 005234   203650 756100                    STQ     PROREC+128,,AUTO
         9 005235   203414 236100                    LDQ     PROFILE$,,AUTO
         9 005236   000020 772000                    QRL     16
         9 005237   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 005240   203651 756100                    STQ     PROREC+129,,AUTO
         9 005241   000100 101500                    MRL     fill='000'O
         9 005242   203651 000004                    ADSC9   PROREC+129,,AUTO         cn=0,n=4
         9 005243   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1

     1298    25727    4              CALL GETPRO(KL$HLPR.PNAME,PROFILE$,PROLEN) WHENALTRETURN DO;

  25727  9 005244   203436 633500                    EPPR3   PROLEN,,AUTO
         9 005245   203445 453500                    STP3    CURSIZE,,AUTO
         9 005246   203414 634500                    EPPR4   PROFILE$,,AUTO
         9 005247   203444 454500                    STP4    @SIZE,,AUTO
         9 005250   202773 635500                    EPPR5   KL$HLPR+4,,AUTO
         9 005251   203443 455500                    STP5    @START$,,AUTO
         9 005252   005577 701000 9                  TSX1    GETPRO
         9 005253   005255 702000 9                  TSX2    s:25728
         9 005254   005256 710000 9                  TRA     s:25732

     1299    25728    4                 PROLEN=0;

  25728  9 005255   203436 450100                    STZ     PROLEN,,AUTO

     1300    25729    4                 END;

     1301    25730
     1302    25731
     1303    25732    3              TEMP=PROLEN+SIZEC(KL$LNK)+CHNRSPLEN;

  25732  9 005256   203436 236100                    LDQ     PROLEN,,AUTO
         9 005257   203434 036100                    ADLQ    CHNRSPLEN,,AUTO
         9 005260   000060 036007                    ADLQ    48,DL
         9 005261   203435 756100                    STQ     TEMP,,AUTO

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:204  
     1304    25733    3              PROFILE$ = PINCRC(PROFILE$,PROLEN);

  25733  9 005262   203436 236100                    LDQ     PROLEN,,AUTO
         9 005263   000020 736000                    QLS     16
         9 005264   203414 036100                    ADLQ    PROFILE$,,AUTO
         9 005265   203414 756100                    STQ     PROFILE$,,AUTO

     1305    25734    4              CALL GETPRO(HLP$->KL$LNK.DFLTVCPRO,PROFILE$,PROLEN) WHENALTRETURN DO;

  25734  9 005266   203436 630500                    EPPR0   PROLEN,,AUTO
         9 005267   203445 450500                    STP0    CURSIZE,,AUTO
         9 005270   203414 631500                    EPPR1   PROFILE$,,AUTO
         9 005271   203444 451500                    STP1    @SIZE,,AUTO
         9 005272   203410 236100                    LDQ     HLP$,,AUTO
         9 005273   000165 036000 10                 ADLQ    117
         9 005274   203443 756100                    STQ     @START$,,AUTO
         9 005275   005577 701000 9                  TSX1    GETPRO
         9 005276   005300 702000 9                  TSX2    s:25735
         9 005277   005301 710000 9                  TRA     s:25738

     1306    25735    4                 PROLEN=0;

  25735  9 005300   203436 450100                    STZ     PROLEN,,AUTO

     1307    25736    4                 END;

     1308    25737
     1309    25738    3              TEMP=PROLEN+TEMP;

  25738  9 005301   203436 236100                    LDQ     PROLEN,,AUTO
         9 005302   203435 036100                    ADLQ    TEMP,,AUTO
         9 005303   203435 756100                    STQ     TEMP,,AUTO

     1310    25739    3              CALL KFF$9TO8(TEMP,LNK$->KL$LNK.BLKHDR.LEN,2);

  25739  9 005304   000052 236000 10                 LDQ     42
         9 005305   203652 756100                    STQ     PROREC+130,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:205  
         9 005306   203412 236100                    LDQ     LNK$,,AUTO
         9 005307   400000 036007                    ADLQ    -131072,DL
         9 005310   203651 756100                    STQ     PROREC+129,,AUTO
         9 005311   203435 630500                    EPPR0   TEMP,,AUTO
         9 005312   203650 450500                    STP0    PROREC+128,,AUTO
         9 005313   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005314   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005315   000000 701000 xent               TSX1    KFF$9TO8
         9 005316   000000 011000                    NOP     0

     1311    25740
     1312    25741    3              HLP$=PINCRC(HLP$,SIZEC(KL$LNK));

  25741  9 005317   203410 236100                    LDQ     HLP$,,AUTO
         9 005320   000014 036003                    ADLQ    12,DU
         9 005321   203410 756100                    STQ     HLP$,,AUTO

     1313    25742    3              TEMP=TEMP/2;                 /* size to words */

  25742  9 005322   203435 236100                    LDQ     TEMP,,AUTO
         9 005323   000001 772000                    QRL     1
         9 005324   203435 756100                    STQ     TEMP,,AUTO

     1314    25743    3              CALL KFF$9TO8(TEMP,NEXT$->HALFB,2);

  25743  9 005325   000052 236000 10                 LDQ     42
         9 005326   203652 756100                    STQ     PROREC+130,,AUTO
         9 005327   200052 236100                    LDQ     NEXT$,,AUTO
         9 005330   203651 756100                    STQ     PROREC+129,,AUTO
         9 005331   203435 630500                    EPPR0   TEMP,,AUTO
         9 005332   203650 450500                    STP0    PROREC+128,,AUTO
         9 005333   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005334   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005335   000000 701000 xent               TSX1    KFF$9TO8
         9 005336   000000 011000                    NOP     0

     1315    25744    3              NEXT$=PINCRC(NEXT$,(TEMP*2)+2);
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:206  

  25744  9 005337   203435 236100                    LDQ     TEMP,,AUTO
         9 005340   000021 736000                    QLS     17
         9 005341   400000 036007                    ADLQ    -131072,DL
         9 005342   200052 036100                    ADLQ    NEXT$,,AUTO
         9 005343   200052 756100                    STQ     NEXT$,,AUTO

     1316    25745
     1317    25746    4   SUB:       DO SUBX=1 TO NSUBS;

  25746  9 005344   000001 235007       SUB          LDA     1,DL
         9 005345   203433 755100                    STA     SUBX,,AUTO
         9 005346   005564 710000 9                  TRA     s:25784+3

     1318    25747    5                 CALL GETSEG(NEXT$,512) WHENALTRETURN DO;

  25747  9 005347   000150 236000 10                 LDQ     104
         9 005350   203444 756100                    STQ     @SIZE,,AUTO
         9 005351   200052 630500                    EPPR0   NEXT$,,AUTO
         9 005352   203443 450500                    STP0    @START$,,AUTO
         9 005353   004316 701000 9                  TSX1    GETSEG
         9 005354   005356 702000 9                  TSX2    s:25748
         9 005355   005365 710000 9                  TRA     s:25751

     1319    25748    5                    ERR=B$ALT.ERR;

  25748  9 005356   000000 470400 xsym               LDP0    B$TCB$
         9 005357   000000 471500                    LDP1    0,,PR0
         9 005360   100102 236100                    LDQ     66,,PR1
         9 005361   202665 473500                    LDP3    @ERR,,AUTO
         9 005362   300000 756100                    STQ     0,,PR3

     1320    25749    5                    ALTRETURN;

  25749  9 005363   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 005364   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:207  
     1321    25750    5                    END;
     1322    25751    4                 LNK$=PINCRC(NEXT$,2);

  25751  9 005365   200052 236100                    LDQ     NEXT$,,AUTO
         9 005366   400000 036007                    ADLQ    -131072,DL
         9 005367   203412 756100                    STQ     LNK$,,AUTO

     1323    25752    4                 CHNRSP$=PINCRC(LNK$,SIZEC(KL$LNKVC));

  25752  9 005370   000014 036003                    ADLQ    12,DU
         9 005371   203411 756100                    STQ     CHNRSP$,,AUTO

     1324    25753    4                 PROFILE$=ADDR(KL$CHNRSP.MESSAGE.MESSAGE);

  25753  9 005372   000065 036000 10                 ADLQ    53
         9 005373   203414 756100                    STQ     PROFILE$,,AUTO

     1325    25754
     1326    25755    4                 LNK$->KL$LNKVC=HLP$->KL$LNKVC;

  25755  9 005374   203410 470500                    LDP0    HLP$,,AUTO
         9 005375   203412 471500                    LDP1    LNK$,,AUTO
         9 005376   000100 100500                    MLR     fill='000'O
         9 005377   000000 000060                    ADSC9   0,,PR0                   cn=0,n=48
         9 005400   100000 000060                    ADSC9   0,,PR1                   cn=0,n=48

     1327    25756    4                 KL_LINCNFG_KEY.NODE=FEX;

  25756  9 005401   200003 473500                    LDP3    @FEX,,AUTO
         9 005402   300000 236100                    LDQ     0,,PR3
         9 005403   000011 736000                    QLS     9
         9 005404   004257 552010 6                  STBQ    KL_LINCNFG_KEY,'10'O

     1328    25757    4                 CALL SCRUB_TERMID(KL_LINCNFG_KEY.TERMID,%TERMINAL_ID_LEV_SUBCHAN#);

  25757  9 005405   000052 236000 10                 LDQ     42
         9 005406   203444 756100                    STQ     @SIZE,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:208  
         9 005407   000151 236000 10                 LDQ     105
         9 005410   203443 756100                    STQ     @START$,,AUTO
         9 005411   005656 701000 9                  TSX1    SCRUB_TERMID
         9 005412   000000 011000                    NOP     0

     1329    25758    4                 KL_LINCNFG_KEY.TERMID.TERM.SUBDEVICE.BYT(1)=KL$LNKVC.BLKHDR.DEVNUM;

  25758  9 005413   203412 470500                    LDP0    LNK$,,AUTO
         9 005414   003000 061500                    CSR     bolr='003'O
         9 005415   000001 400011                    BDSC    1,,PR0                   by=2,bit=0,n=9
         9 005416   004261 010010 6                  BDSC    KL_LINCNFG_KEY+2         by=0,bit=1,n=8

     1330    25759    4                 KL_LINCNFG_KEY.TERMID.TERM.TERM_NAME=ACCT;

  25759  9 005417   040000 100500                    MLR     fill='040'O
         9 005420   203415 000010                    ADSC9   ACCT,,AUTO               cn=0,n=8
         9 005421   004261 600010 6                  ADSC9   KL_LINCNFG_KEY+2         cn=3,n=8

     1331    25760    4                 READ_NETCON.KEY_=VECTOR(KL_LINCNFG_KEY);

  25760  9 005422   000152 237000 10                 LDAQ    106
         9 005423   002600 757000 6                  STAQ    READ_NETCON+2

     1332    25761    4                 READ_NETCON.BUF_=VECTOR(KL$LINCNFG);

  25761  9 005424   000154 235000 10                 LDA     108
         9 005425   203650 452500                    STP2    PROREC+128,,AUTO
         9 005426   203650 236100                    LDQ     PROREC+128,,AUTO
         9 005427   002672 036003                    ADLQ    1466,DU
         9 005430   002602 757000 6                  STAQ    READ_NETCON+4

     1333    25762    5                 CALL M$READ(READ_NETCON) WHENALTRETURN DO;

  25762  9 005431   002576 630400 6                  EPPR0   READ_NETCON
         9 005432   440000 713400                    CLIMB   alt,read
         9 005433   401400 401760                    pmme    nvectors=4
         9 005434   005436 702000 9                  TSX2    s:25765
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:209  
         9 005435   005436 710000 9                  TRA     s:25765

     1334    25763    5                    END;

     1335    25764
     1336    25765    4                 KL$CHNRSP='0'B;

  25765  9 005436   203411 470500                    LDP0    CHNRSP$,,AUTO
         9 005437   000100 100400                    MLR     fill='000'O
         9 005440   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 005441   000000 000067                    ADSC9   0,,PR0                   cn=0,n=55

     1337    25766    4                 KL$CHNRSP.CONFIG = '1'B;

  25766  9 005442   003100 060400                    CSL     bolr='003'O
         9 005443   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         9 005444   000000 220001                    BDSC    0,,PR0                   by=1,bit=2,n=1

     1338    25767    4                 KL$CHNRSP.FCN=%IGA_CHNRSP;

  25767  9 005445   000100 101400                    MRL     fill='000'O
         9 005446   000164 000004 10                 ADSC9   116                      cn=0,n=4
         9 005447   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1

     1339    25768    4                 KL$CHNRSP.TERMINAL_ID=KL_LINCNFG_KEY.TERMID;

  25768  9 005450   000100 100400                    MLR     fill='000'O
         9 005451   004257 600020 6                  ADSC9   KL_LINCNFG_KEY           cn=3,n=16
         9 005452   000002 400020                    ADSC9   2,,PR0                   cn=2,n=16

     1340    25769    4                 KL$CHNRSP.NA=KL$LINCNFG.NA;

  25769  9 005453   000100 100500                    MLR     fill='000'O
         9 005454   202676 400010                    ADSC9   OFFSET,,AUTO             cn=2,n=8
         9 005455   000006 400010                    ADSC9   6,,PR0                   cn=2,n=8

     1341    25770    4                 KL$CHNRSP.HNDCMN=KL$LINCNFG.KHA;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:210  

  25770  9 005456   000100 100500                    MLR     fill='000'O
         9 005457   202672 000022                    ADSC9   KL$LINCNFG,,AUTO         cn=0,n=18
         9 005460   000010 400022                    ADSC9   8,,PR0                   cn=2,n=18

     1342    25771
     1343    25772    5                 CALL GETPRO(KL$LNKVC.PRONM,PROFILE$,PROLEN) WHENALTRETURN DO;

  25772  9 005461   203436 631500                    EPPR1   PROLEN,,AUTO
         9 005462   203445 451500                    STP1    CURSIZE,,AUTO
         9 005463   203414 633500                    EPPR3   PROFILE$,,AUTO
         9 005464   203444 453500                    STP3    @SIZE,,AUTO
         9 005465   203412 236100                    LDQ     LNK$,,AUTO
         9 005466   000007 036003                    ADLQ    7,DU
         9 005467   203443 756100                    STQ     @START$,,AUTO
         9 005470   005577 701000 9                  TSX1    GETPRO
         9 005471   005473 702000 9                  TSX2    s:25773
         9 005472   005502 710000 9                  TRA     s:25776

     1344    25773    5                    ERR=B$ALT.ERR;

  25773  9 005473   000000 470400 xsym               LDP0    B$TCB$
         9 005474   000000 471500                    LDP1    0,,PR0
         9 005475   100102 236100                    LDQ     66,,PR1
         9 005476   202665 473500                    LDP3    @ERR,,AUTO
         9 005477   300000 756100                    STQ     0,,PR3

     1345    25774    5                    ALTRETURN;

  25774  9 005500   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 005501   000000 702211                    TSX2  ! 0,X1

     1346    25775    5                    END;
     1347    25776    4                 KL$LNKVC.BLKHDR.PROOFFSET=POFFC(PROFILE$,LNK$);

  25776  9 005502   203412 236100                    LDQ     LNK$,,AUTO
         9 005503   000020 772000                    QRL     16
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:211  
         9 005504   203650 756100                    STQ     PROREC+128,,AUTO
         9 005505   203414 236100                    LDQ     PROFILE$,,AUTO
         9 005506   000020 772000                    QRL     16
         9 005507   203650 136100                    SBLQ    PROREC+128,,AUTO
         9 005510   203651 756100                    STQ     PROREC+129,,AUTO
         9 005511   203412 470500                    LDP0    LNK$,,AUTO
         9 005512   000100 101500                    MRL     fill='000'O
         9 005513   203651 000004                    ADSC9   PROREC+129,,AUTO         cn=0,n=4
         9 005514   000001 200001                    ADSC9   1,,PR0                   cn=1,n=1

     1348    25777    4                 TEMP=PROLEN+SIZEC(KL$LNKVC)+CHNRSPLEN;

  25777  9 005515   203436 236100                    LDQ     PROLEN,,AUTO
         9 005516   203434 036100                    ADLQ    CHNRSPLEN,,AUTO
         9 005517   000060 036007                    ADLQ    48,DL
         9 005520   203435 756100                    STQ     TEMP,,AUTO

     1349    25778    4                 CALL KFF$9TO8(TEMP,LNK$->KL$LNK.BLKHDR.LEN,2);

  25778  9 005521   000052 236000 10                 LDQ     42
         9 005522   203652 756100                    STQ     PROREC+130,,AUTO
         9 005523   203412 236100                    LDQ     LNK$,,AUTO
         9 005524   400000 036007                    ADLQ    -131072,DL
         9 005525   203651 756100                    STQ     PROREC+129,,AUTO
         9 005526   203435 631500                    EPPR1   TEMP,,AUTO
         9 005527   203650 451500                    STP1    PROREC+128,,AUTO
         9 005530   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005531   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005532   000000 701000 xent               TSX1    KFF$9TO8
         9 005533   000000 011000                    NOP     0

     1350    25779    4                 TEMP=TEMP/2;

  25779  9 005534   203435 236100                    LDQ     TEMP,,AUTO
         9 005535   000001 772000                    QRL     1
         9 005536   203435 756100                    STQ     TEMP,,AUTO

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:212  
     1351    25780    4                 CALL KFF$9TO8(TEMP,NEXT$->HALFB,2);

  25780  9 005537   000052 236000 10                 LDQ     42
         9 005540   203652 756100                    STQ     PROREC+130,,AUTO
         9 005541   200052 236100                    LDQ     NEXT$,,AUTO
         9 005542   203651 756100                    STQ     PROREC+129,,AUTO
         9 005543   203435 630500                    EPPR0   TEMP,,AUTO
         9 005544   203650 450500                    STP0    PROREC+128,,AUTO
         9 005545   203650 630500                    EPPR0   PROREC+128,,AUTO
         9 005546   000021 631400 xsym               EPPR1   B_VECTNIL+17
         9 005547   000000 701000 xent               TSX1    KFF$9TO8
         9 005550   000000 011000                    NOP     0

     1352    25781    4                 NEXT$=PINCRC(NEXT$,(TEMP*2)+2);

  25781  9 005551   203435 236100                    LDQ     TEMP,,AUTO
         9 005552   000021 736000                    QLS     17
         9 005553   400000 036007                    ADLQ    -131072,DL
         9 005554   200052 036100                    ADLQ    NEXT$,,AUTO
         9 005555   200052 756100                    STQ     NEXT$,,AUTO

     1353    25782    4                 HLP$=PINCRC(HLP$,SIZEC(KL$LNKVC));

  25782  9 005556   203410 236100                    LDQ     HLP$,,AUTO
         9 005557   000014 036003                    ADLQ    12,DU
         9 005560   203410 756100                    STQ     HLP$,,AUTO

     1354    25783
     1355    25784    4                 END SUB;

  25784  9 005561   203433 235100                    LDA     SUBX,,AUTO
         9 005562   000001 035007                    ADLA    1,DL
         9 005563   203433 755100                    STA     SUBX,,AUTO
         9 005564   203432 236100                    LDQ     NSUBS,,AUTO
         9 005565   203433 116100                    CMPQ    SUBX,,AUTO
         9 005566   005347 603000 9                  TRC     s:25747

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:213  
     1356    25785    3              END LINK;

  25785  9 005567   203413 235100                    LDA     LINKX,,AUTO
         9 005570   000001 035007                    ADLA    1,DL
         9 005571   203413 755100                    STA     LINKX,,AUTO
         9 005572   203413 236100                    LDQ     LINKX,,AUTO
         9 005573   202666 116100                    CMPQ    KL$LINK,,AUTO
         9 005574   004707 602000 9                  TNC     s:25672

     1357    25786
     1358    25787    2           RETURN;

  25787  9 005575   202664 221300                    LDX1  ! KL_NETWORK+1281,,AUTO
         9 005576   000001 702211                    TSX2  ! 1,X1

     1359    25788
     1360    25789
     1361    25790        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:214  
     1362    25791
     1363    25792    2   GETPRO: PROC(PRO,OUT$,PROLEN) ALTRET;

  25792  9 005577   203442 741300       GETPRO       STX1  ! NOHEADER+2,,AUTO

     1364    25793
     1365    25794    3   DCL 1 PRO CALIGNED,
     1366    25795    3         2 L UBIN BYTE CALIGNED,
     1367    25796    3         2 C CHAR(11);
     1368    25797    3   DCL OUT$ PTR;
     1369    25798    3   DCL PROLEN UBIN;
     1370    25799
     1371    25800        %KL_BLKHDR (NAME=BLKHDR,STCLASS="BASED(OUT$)");
     1372    25895
     1373    25896    3   DCL PRO$ PTR;
     1374    25897    3   DCL PROSIZE UBIN;
     1375    25898    3   DCL PROBASE CHAR(PROSIZE) BASED(PRO$);
     1376    25899    3   DCL PROREC CHAR(512);
     1377    25900        %KL_PHDR (NAME=KL$PHDR,STCLASS="BASED(PRO$)");
     1378    25941
     1379    25942
     1380    25943    4           IF PRO.L=0 THEN DO;

  25943  9 005600   203443 470500                    LDP0    @PRO,,AUTO
         9 005601   000100 101500                    MRL     fill='000'O
         9 005602   000000 000001                    ADSC9   0,,PR0                   cn=0,n=1
         9 005603   203650 000004                    ADSC9   PROREC+128,,AUTO         cn=0,n=4
         9 005604   203650 236100                    LDQ     PROREC+128,,AUTO
         9 005605   000000 116003                    CMPQ    0,DU
         9 005606   005613 601000 9                  TNZ     s:25948

     1381    25944    4              PROLEN=0;

  25944  9 005607   203445 471500                    LDP1    @PROLEN,,AUTO
         9 005610   100000 450100                    STZ     0,,PR1

     1382    25945    4              RETURN;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:215  

  25945  9 005611   203442 221300                    LDX1  ! NOHEADER+2,,AUTO
         9 005612   000001 702211                    TSX2  ! 1,X1

     1383    25946    4              END;
     1384    25947
     1385    25948    3           READ_PRO.KEY_=VECTOR(PRO);

  25948  9 005613   000042 235000 10                 LDA     34
         9 005614   203443 236100                    LDQ     @PRO,,AUTO
         9 005615   002616 757000 6                  STAQ    READ_PRO+2

     1386    25949    3           READ_PRO.BUF_=VECTOR(PROREC);

  25949  9 005616   000166 235000 10                 LDA     118
         9 005617   203650 452500                    STP2    PROREC+128,,AUTO
         9 005620   203650 236100                    LDQ     PROREC+128,,AUTO
         9 005621   003450 036003                    ADLQ    1832,DU
         9 005622   002620 757000 6                  STAQ    READ_PRO+4

     1387    25950    4           CALL M$READ(READ_PRO) WHENALTRETURN DO;

  25950  9 005623   002614 630400 6                  EPPR0   READ_PRO
         9 005624   440000 713400                    CLIMB   alt,read
         9 005625   401400 401760                    pmme    nvectors=4
         9 005626   005630 702000 9                  TSX2    s:25951
         9 005627   005632 710000 9                  TRA     s:25953

     1388    25951    4              ALTRETURN;

  25951  9 005630   203442 221300                    LDX1  ! NOHEADER+2,,AUTO
         9 005631   000000 702211                    TSX2  ! 0,X1

     1389    25952    4              END;
     1390    25953    3           PRO$=OUT$;

  25953  9 005632   203444 470500                    LDP0    @OUT$,,AUTO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:216  
         9 005633   000000 236100                    LDQ     0,,PR0
         9 005634   203446 756100                    STQ     PRO$,,AUTO

     1391    25954    3           PROSIZE=DCBADDR(DCBNUM(M$PROF))->F$DCB.ARS#-SIZEC(KL$PHDR);

  25954  9 005635   000000 236007 xsym               LDQ     M$PROF,DL
         9 005636   000000 471400 10                 LDP1    0
         9 005637   100000 473500                    LDP3    0,,PR1
         9 005640   300000 474506                    LDP4    0,QL,PR3
         9 005641   400000 235100                    LDA     0,,PR4
         9 005642   000120 135007                    SBLA    80,DL
         9 005643   203447 755100                    STA     PROSIZE,,AUTO

     1392    25955    3           PROLEN=PROSIZE;

  25955  9 005644   203445 474500                    LDP4    @PROLEN,,AUTO
         9 005645   400000 755100                    STA     0,,PR4

     1393    25956    3           PROBASE=PINCRC(ADDR(PROREC),SIZEC(KL$PHDR))->PROBASE;

  25956  9 005646   000000 620005                    EAX0    0,AL
         9 005647   203446 475500                    LDP5    PRO$,,AUTO
         9 005650   203447 721100                    LXL1    PROSIZE,,AUTO
         9 005651   040140 100540                    MLR     fill='040'O
         9 005652   203474 000010                    ADSC9   PROREC+20,,AUTO          cn=0,n=*X0
         9 005653   500000 000011                    ADSC9   0,,PR5                   cn=0,n=*X1

     1394    25957    3           RETURN;

  25957  9 005654   203442 221300                    LDX1  ! NOHEADER+2,,AUTO
         9 005655   000001 702211                    TSX2  ! 1,X1

     1395    25958
     1396    25959    3   END GETPRO;
     1397    25960        %EJECT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:217  
     1398    25961    2   SCRUB_TERMID: PROC(TERMID,LEV);

  25961  9 005656   203442 741300       SCRUB_TERMID STX1  ! NOHEADER+2,,AUTO

     1399    25962
     1400    25963        %B$TERMINAL_ID (FPTN=TERMID,STCLASS=PARAM);
     1401    25992    3   DCL LEV UBIN;
     1402    25993
     1403    25994    3           TERMID='0'B;

  25994  9 005657   203443 470500                    LDP0    @TERMID,,AUTO
         9 005660   000100 100400                    MLR     fill='000'O
         9 005661   000002 000001 xsym               ADSC9   B_VECTNIL+2              cn=0,n=1
         9 005662   000000 000020                    ADSC9   0,,PR0                   cn=0,n=16

     1404    25995    3           TERMID.LEV=LEV;

  25995  9 005663   203444 471500                    LDP1    @LEV,,AUTO
         9 005664   000100 101500                    MRL     fill='000'O
         9 005665   100000 000004                    ADSC9   0,,PR1                   cn=0,n=4
         9 005666   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1

     1405    25996    3           TERMID.TERM.TERM_NAME=' ';

  25996  9 005667   040100 100400                    MLR     fill='040'O
         9 005670   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         9 005671   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

     1406    25997
     1407    25998    3           RETURN;

  25998  9 005672   203442 221300                    LDX1  ! NOHEADER+2,,AUTO
         9 005673   000001 702211                    TSX2  ! 1,X1
     1408    25999
     1409    26000    3   END SCRUB_TERMID;
     1410    26001    2   END CONFIG_LINK;
     1411    26002    1   END KFF$FEBOOT;
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:218  
     1412    26003        %EOD;

PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:219  
--  Include file information  --

   GM_VIRTUAL_E.:E05TOU  is referenced.
   KS_SUBS_C.:E05TOU  is referenced.
   KI_SUBS_C.:E05TOU  is referenced.
   B_SEGIDS_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   B$JIT.:E05TOU  cannot be made into a system file and is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   KL_CONTROL_C.:E05TOU  is referenced.
   KL_CONFIG_M.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   GI_BOOT_C.:E05TOU  is referenced.
   GJ_MSG_M.:E05TOU  is referenced.
   GI_DATA_M.:E05TOU  is referenced.
   B_STRINGS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
      No diagnostics issued in procedure KFF$FEBOOT.
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:220  

 **** Variables and constants ****

  ****  Section 006  Data  KFF$FEBOOT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

  4046-0-0/w STRC(72)    r     1 B$SECTABLE(0:30)
  2444-0-0/w UBIN        r     1 BOOTRESULT(0:1)
  2540-0-0/d STRC(1080)  r     1 CLOSE_GOODIES           2742-0-0/d STRC(1080)  r     1 CLOSE_RU
    14-0-0/d VECT        r     1 DATASEG                 4220-0-0/c CHAR(120)   r     1 ERRBUF
  3214-0-0/d STRC(1080)  r     1 FPT_CLOSEHANDLER        4146-0-0/d STRC(936)   r     1 FPT_ERRMSG
     6-0-0/d STRC(216)   r     1 FPT_FDS                 2276-0-0/d STRC(360)   r     1 FPT_FEBOOT
  3000-0-0/d STRC(864)   r     1 FPT_FID                    0-0-0/d STRC(216)   r     1 FPT_GDS
  4200-0-0/d STRC(504)   r     1 FPT_KEYIN               2426-0-0/d STRC(288)   r     1 FPT_NODEINFO
  2650-0-0/d STRC(2088)  r     1 FPT_OPNRU               4030-0-0/d STRC(360)   r     1 FPT_PRECORD
  4012-0-0/d STRC(504)   r     1 FPT_READRU              3072-0-0/d STRC(2088)  r     1 FPT_STARTHANDLER
  3064-0-0/d STRC(216)   r     1 FPT_WAIT                3164-0-0/c STRC(72)    r     1 HAND_ACCT
  3166-0-0/c STRC(117)   r     1 HAND_NAME               3334-0-0/w PTR         r     1 HD$
  3252-0-0/w UBIN        r     1 HEADBUF(0:49)           4044-0-0/w STRC(45)    r     1 HEADKEY
  3646-0-0/w STRC(27)    r     1 KEY_FEPBOOT             3773-0-0/w STRC(27)    r     1 KEY_FEPCTL
  3647-0-0/w STRC(27)    r     1 KEY_FEPHNDLR            3650-0-0/w STRC(99)    r     1 KEY_HNDLR
  3744-0-0/w STRC(27)    r     1 KEY_PSEUDO              3774-0-0/w STRC(495)   r     1 KL_CHNRSP
  3474-0-0/w STRC(936)   r     1 KL_FEPBOOT              3745-0-0/w STRC(792)   r     1 KL_FEPCTL
  3526-0-0/w STRC(864)   r     1 KL_FEPHNDLR             4264-0-0/c STRC(189)   r     1 KL_HLPR_KEY
  3556-0-0/w STRC(1998)  r     1 KL_HNDLR                4257-0-0/c STRC(171)   r     1 KL_LINCNFG_KEY
  4256-0-0/w STRC(27)    r     1 KL_LINK_KEY             3653-0-0/w STRC(2052)  r     1 KL_PSEUDO
  2446-0-0/d STRC(2088)  r     1 OPEN_GOODIES            2632-0-0/d STRC(504)   r     1 READ_HLP
  2576-0-0/d STRC(504)   r     1 READ_NETCON             2614-0-0/d STRC(504)   r     1 READ_PRO
  3335-0-0/w STRC        r     1 RET_ERROR               4216-0-0/w UBIN        r     1 RSLT(0:1)
  4042-0-0/w STRC(54)    r     1 RUKEY
    16-0-0/d STRC(432)   r     1 SAVE_INFO(0:99)
  4144-0-0/w STRC(54)    r     1 SECTKEY                 3062-0-0/c STRC(72)    r     1 SYSACCT
  3336-0-0/w STRC(3384)  r     1 TEMP_SECTION            3052-0-0/c STRC(72)    r     1 VLP_ACCT
  3172-0-0/d STRC(612)   r     1 VLP_FPRG                3042-0-0/c STRC(288)   r     1 VLP_NAME
  3054-0-0/c STRC(72)    r     1 VLP_PASS                3056-0-0/d STRC(90)    r     1 VLP_SN
  3030-0-0/d STRC(324)   r     1 VLR_FID                 2310-0-0/d STRC(540)   r     1 VLR_MONINFO
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:221  
  2436-0-0/d STRC(216)   r     1 VLR_NODEINFO            2330-0-0/d STRC(2232)  r     1 VLR_SITEINFO

  ****  Section 007 RoData KFF$FEBOOT

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(432)   r     1 FPT_MONINFO               16-0-0/c STRC(45)    r     1 HLPNAME
    22-0-0/w STRC(18)    r     1 KL_NETWORK_KEY            14-0-0/c STRC(72)    r     1 NETCONNAME
    20-0-0/c STRC(45)    r     1 PRONAME

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @BOOT_BUFFER            2665-0-0/w PTR         r     1 @ERR
     3-0-0/w PTR         r     1 @FEX                    2671-0-0/w PTR         r     1 @FEX
  2665-0-0/w PTR         r     1 @FEX                    2665-0-0/w PTR         r     1 @IMAGE$
  2704-0-0/w PTR         r     1 @L66WD                  2703-0-0/w PTR         r     1 @L6DW
  3444-0-0/w PTR         r     1 @LEV                    2666-0-0/w PTR         r     1 @NODE#
  2665-0-0/w PTR         r     1 @NODENAME               2667-0-0/w PTR         r     1 @NODETYPE
  3444-0-0/w PTR         r     1 @OUT$                   2665-0-0/w PTR         r     1 @POINTER
  3443-0-0/w PTR         r     1 @PRO                    3445-0-0/w PTR         r     1 @PROLEN
     5-0-0/w PTR         r     1 @RET_ERROR_             2672-0-0/w PTR         r     1 @SAVX
  2666-0-0/w PTR         r     1 @SAVX                   3444-0-0/w PTR         r     1 @SIZE
  2705-0-0/w PTR         r     1 @SIZE                   3443-0-0/w PTR         r     1 @START$
  3443-0-0/w PTR         r     1 @TERMID                 2666-0-0/w PTR         r     1 @TYPE
     6-0-0/w PTR         r     1 @WDSUSED_               3415-0-0/c CHAR(8)     r     1 ACCT
    27-0-0/w UBIN        r     1 ARRAY_WDSZ                53-0-0/w PTR         r     1 BEGIN$
    *0-0-0/d VECT        r     1 BOOT_BUFFER             2667-0-0/w PTR         r     1 BUF$
    66-0-0/b BIT         r     1 BUFFER_PASSED           2674-0-0/w UBIN        r     1 BYTESIZE
  2673-0-0/w SBIN        r     1 BYTESLEFT               3411-0-0/w PTR         r     1 CHNRSP$
  3434-0-0/w UBIN        r     1 CHNRSPLEN                 64-0-0/b BIT         r     1 CLOSE_M$HLPF
    62-0-0/b BIT         r     1 CLOSE_M$NETCON            63-0-0/b BIT         r     1 CLOSE_M$PROF
    16-0-0/w PTR         r     1 CONTROL$                3445-0-0/w SBIN        r     1 CURSIZE
    31-0-0/w UBIN        r     1 DATAOFFSET                *0-0-0/w BIT         r     1 ERR
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:222  
    *0-0-0/w UBIN        r     1 FEX                       *0-0-0/w UBIN        r     1 FEX
    *0-0-0/w UBIN        r     1 FEX                     3410-0-0/w PTR         r     1 HLP$
    10-0-0/c CHAR(8)     r     1 HOSTNAME                3430-0-0/c CHAR(8)     r     1 HOSTNAME
     7-0-0/w UBIN        r     1 HOSTNODE                  40-0-0/w SBIN        r     1 I
  2670-0-0/w SBIN        r     1 I                       2671-0-0/w SBIN        r     1 I
  2706-0-0/w SBIN        r     1 I                       2673-0-0/w UBIN        r     1 I
  2667-0-0/w UBIN        r     1 I                         *0-0-0/w PTR         r     1 IMAGE$
    22-0-0/w PTR         r     1 IN$                       25-0-0/w UBIN        r     1 INDX
    24-0-0/w PTR         r     1 IPARAM$                   41-0-0/w UBIN        r     1 J
    42-0-0/w SBIN        r     1 K                       2767-0-0/w STRC(9828)  r     1 KL$HLPR
  2672-0-0/w STRC(2187)  r     1 KL$LINCNFG              2666-0-0/w STRC(144)   r     1 KL$LINK
   263-0-0/w STRC(46116) r     1 KL_NETWORK                *0-0-0/b STRC        r     1 L66WD
    *0-0-0/b STRC        r     1 L6DW                      *0-0-0/w UBIN        r     1 LEV
    67-0-0/w UBIN        r     1 LIBX                      72-0-0/w UBIN        r     1 LIB_DATASIZ
    71-0-0/w UBIN        r     1 LIB_PROCSIZ
    73-0-0/w STRC(432)   r     1 LIB_TBL(0:9)
  3413-0-0/w UBIN        r     1 LINKX                   3412-0-0/w PTR         r     1 LNK$
  3446-0-0/w SBIN        r     1 NEWSIZE                   52-0-0/w PTR         r     1 NEXT$
    46-0-0/w UBIN        r     1 NHANDLERS                 47-0-0/w UBIN        r     1 NHNDLRS_DFR
    70-0-0/w UBIN        r     1 NLIBS                     *0-0-0/w UBIN        r     1 NODE#
    *0-0-0/c CHAR(8)     r     1 NODENAME                  12-0-0/w UBIN        r     1 NODETYPE
    *0-0-0/w UBIN        r     1 NODETYPE                3440-0-0/w BIT         r     1 NOHEADER
  3437-0-0/w BIT         r     1 NOSETUP                 3432-0-0/w UBIN        r     1 NSUBS
    21-0-0/w UBIN        r     1 NUMSECTS                  26-0-0/w UBIN        r     1 OFFSET
  2676-0-0/w UBIN        r     1 OFFSET                    51-0-0/w PTR         r     1 OFFSET$
    43-0-0/w UBIN        r     1 OFFSET_SIZE               23-0-0/w PTR         r     1 OUT$
    *0-0-0/w PTR         r     1 OUT$                      13-0-0/w PTR         r     1 P$
  2670-0-0/w SBIN        r     1 PAGES                     15-0-0/w PTR         r     1 PARAM$
    35-0-0/w UBIN        r     1 PARAMOFFSET               *0-0-0/w STRC        r     1 POINTER
    *0-0-0/c STRC(108)   r     1 PRO                     3446-0-0/w PTR         r     1 PRO$
    32-0-0/w UBIN        r     1 PROCOFFSET              3414-0-0/w PTR         r     1 PROFILE$
  3436-0-0/w UBIN        r     1 PROLEN                    *0-0-0/w UBIN        r     1 PROLEN
  3425-0-0/c STRC(108)   r     1 PRONAME                 3450-0-0/c CHAR(512)   r     1 PROREC
  3447-0-0/w UBIN        r     1 PROSIZE                   36-0-0/w PTR         r     1 PSEUDO$
  3423-0-0/c CHAR(8)     r     1 PW                        *0-0-0/w STRC        r     1 RET_ERROR_
    57-0-0/w UBIN        r     1 ROK                       33-0-0/w UBIN        r     1 ROSOFFSET
    61-0-0/w UBIN        r     1 SAVEX                     *0-0-0/w UBIN        r     1 SAVX
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:223  
    *0-0-0/w UBIN        r     1 SAVX                      17-0-0/w PTR         r     1 SECT$
  2675-0-0/w PTR         r     1 SECT$                     20-0-0/w UBIN        r     1 SECTSIZE
    14-0-0/w PTR         r     1 SETFP$                  2700-0-0/w UBIN        r     1 SIZE
    *0-0-0/w SBIN        r     1 SIZE                      *0-0-0/w UBIN        r     1 SIZE
    44-0-0/w UBIN        r     1 SKP_HNDLR                 45-0-0/w UBIN        r     1 SKP_HNDLR2
  2677-0-0/w UBIN        r     1 START                     *0-0-0/w PTR         r     1 START$
  3433-0-0/w UBIN        r     1 SUBX                      54-0-0/w PTR         r     1 SVNEXT$
    30-0-0/w UBIN        r     1 TBLOFFSET                 60-0-0/w SBIN        r     1 TEMP
  3435-0-0/w UBIN        r     1 TEMP                      *0-0-0/c STRC(144)   r     1 TERMID
    *0-0-0/w UBIN        r     1 TYPE                    3417-0-0/c STRC(117)   r     1 UNAME
    55-0-0/w UBIN        r     1 VDK                     2701-0-0/w UBIN        r     1 VDPGS
    56-0-0/w UBIN        r     1 VPK                       50-0-0/w SBIN        r     1 WDSUSED
    *0-0-0/w UBIN        r     1 WDSUSED_                  65-0-0/b BIT         r     1 WE_PRINT_ERRORS

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$                     0-0-0/w PTR         r     1 B$TCB$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w UBIN(9)     r     1 B$BYTE
     0-0-0/w UBIN(18)    r     1 B$HALF                     0-0-0/w STRC(1440)  r     1 B$HEAD
     0-0-0/d STRC(8856)  r     1 B$JIT
     0-0-0/b UBIN(18)    r     1 B$PARAMI(0:0)
     0-0-0/w STRC(144)   r     1 B$TCB                      0-0-0/c STRC(288)   r     1 DFBASE
     0-0-0/d ASTR(3528)  r     1 F$DCB                      0-0-0/w STRC(756)   r     1 GI$CONTROL
     0-0-0/w STRC(864)   r     1 GI$OFFSETS                 0-0-0/w STRC(576)   r     1 GI$PARAMS
     0-0-0/w STRC(252)   r     1 GI$PSEUDO(0:7)
     0-0-0/w STRC(3384)  r     1 GI$SECTION                 0-0-0/w STRC(1584)  r     1 GI$SETFP
     0-0-0/c UBIN(18)    r     1 HALFB                      0-0-0/c STRC(495)   r     1 KL$CHNRSP
     0-0-0/c STRC(495)   r     1 KL$CHNRSP                  0-0-0/w STRC(1908)  r     1 KL$CONTROL_INIT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:224  
     0-0-0/w STRC(432)   r     1 KL$LNK                     0-0-0/c STRC(432)   r     1 KL$LNK
     0-0-0/c STRC(432)   r     1 KL$LNKVC                   0-0-0/c STRC(720)   r     1 KL$PHDR
     0-0-0N  NULL        r     1 M$DO                       0-0-0N  NULL        r     1 M$HANDLER
     0-0-0N  NULL        r     1 M$HLPF                     0-0-0N  NULL        r     1 M$NETCON
     0-0-0N  NULL        r     1 M$PROF                     0-0-0N  NULL        r     1 M$RU
     0-0-0/w UBIN        r     1 ONEPAGE(0:1023)            0-0-0/w UBIN        r     1 ONEWORD
     0-0-0/c ACHR        r     1 PROBASE


   Procedure KFF$FEBOOT requires 3004 words for executable code.
   Procedure KFF$FEBOOT requires 1976 words of local(AUTO) storage.
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:225  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:226  
          MINI XREF LISTING

ACCT IN PROCEDURE CONFIG_LINK
     25643**DCL     25691<>CALL    25693>>ASSIGN  25721>>ASSIGN  25759>>ASSIGN
ALIGNPTR
     24518**PROC    23869--CALL
ALT
     24009**LABEL   23521--CALLALT 23529--CALLALT 23537--CALLALT 23560--CALLALT 23562--CALLALT 23563--CALLALT
     23564--CALLALT 23572--CALLALT 23586--CALLALT 23661--CALLALT 23663--CALLALT 23664--CALLALT 23671--CALLALT
     23889--CALLALT 23891--CALLALT 23892--CALLALT 24001--CALLALT 24006--CALLALT
ALT IN PROCEDURE GETSEG
     24415**LABEL   24411--CALLALT
ALT IN PROCEDURE READ_RU
     24396**LABEL   24294--CALLALT 24308--CALLALT 24324--CALLALT 24332--CALLALT 24344--CALLALT 24359--CALLALT
     24361--CALLALT 24362--CALLALT 24373--CALLALT 24388--CALLALT 24393--CALLALT
ARRAY_WDSZ
     21938**DCL     23811<<ASSIGN  23844>>ASSIGN
B$ALT.CODE
     21614**DCL     21614--REDEF   21615--REDEF   21615--REDEF
B$ALT.DCB#
     21615**DCL     24471>>ASSIGN
B$ALT.ERR
     21615**DCL     24469>>ASSIGN  25667>>ASSIGN  25677>>ASSIGN  25687>>ASSIGN  25699>>ASSIGN  25748>>ASSIGN
     25773>>ASSIGN
B$ALT.ERR.ERR#
     21616**DCL     21616--REDEF   24087>>IF
B$ALT.EVID
     21615**DCL     21615--REDEF   21615--REDEF
B$BYTE
     21941**DCL     23817<>CALL    23825<>CALL
B$HALF
     21942**DCL     23832<>CALL
B$HEAD.BIAS
     21889**DCL     23735>>ASSIGN  24376>>ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:227  
B$HEAD.DCBRES
     21776**DCL     23707>>ASSIGN
B$HEAD.LAUTO
     21834**DCL     23693>>ASSIGN
B$HEAD.LIB
     21855**DCL     23697>>ASSIGN
B$HEAD.LIBNAME
     21897**DCL     23691>>ASSIGN
B$HEAD.LIBNAME.TXT
     21905**DCL     23878>>IF      23880>>IF      23888--ASSIGN
B$HEAD.NOCHGPMEM
     21869**DCL     23695>>ASSIGN
B$HEAD.PROCACC
     21866**DCL     23694>>ASSIGN
B$HEAD.RDATA
     21744**DCL     23727>>ASSIGN  23895>>ASSIGN  24304>>ASSIGN
B$HEAD.ROSIZE
     21803**DCL     23723>>ASSIGN  24298>>ASSIGN
B$HEAD.RPROC
     21734**DCL     23731>>ASSIGN  23894>>ASSIGN
B$HEAD.S
     21853**DCL     23696>>ASSIGN
B$HEAD.SECTABLESIZE
     21818**DCL     24333>>ASSIGN
B$HEAD.START
     21770**DCL     23699>>ASSIGN
B$HEAD.TCBSIZE
     21783**DCL     23711>>ASSIGN
B$HEAD.UDCBNUM
     21773**DCL     23703>>ASSIGN
B$HEAD.VDPGS
     21736**DCL     23719>>ASSIGN  24371>>ASSIGN
B$HEAD.VERSION#
     21805**DCL     23692>>ASSIGN
B$HEAD.VPPGS
     21728**DCL     23715>>ASSIGN  24306>>ASSIGN  24370>>ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:228  
B$JIT.CPFLAGS1.SLEAZE
     19211**DCL     19211--REDEF
B$JIT.ERR.MID
     19118**DCL     19118--REDEF
B$JIT.JRESPEAK
     19279**DCL     19280--REDEF
B$JIT.ORIGINATOR_PORT.FROM_CR
     19388**DCL     19388--REDEF   19389--REDEF
B$JIT.PNR
     19292**DCL     19292--REDEF
B$JIT.SYSID
     19117**DCL     24007>>IF      24473>>IF
B$JIT.TSLINE
     19386**DCL     19387--REDEF
B$JIT$
     20591**DCL     19112--IMP-PTR 24007>>IF      24473>>IF
B$PARAMI
     21940**DCL     23839>>ASSIGN  23840<>CALL
B$SECTABLE IN PROCEDURE READ_RU
     24262**DCL     24329--ASSIGN  24333--ASSIGN
B$SECTABLE.SIZE IN PROCEDURE READ_RU
     24268**DCL     24334<<ASSIGN  24334>>ASSIGN  24347>>ASSIGN  24355>>ASSIGN
B$SECTABLE.START IN PROCEDURE READ_RU
     24270**DCL     24342>>ASSIGN  24353>>ASSIGN
B$TCB.ALT$
     21610**DCL     24087>>IF      24469>>ASSIGN  24471>>ASSIGN  25667>>ASSIGN  25677>>ASSIGN  25687>>ASSIGN
     25699>>ASSIGN  25748>>ASSIGN  25773>>ASSIGN
B$TCB$
     21608**DCL     24087>>IF      24469>>ASSIGN  24471>>ASSIGN  25667>>ASSIGN  25677>>ASSIGN  25687>>ASSIGN
     25699>>ASSIGN  25748>>ASSIGN  25773>>ASSIGN
BEGIN$
     21964**DCL     23547<<ASSIGN  23554<<ASSIGN  23556<<ASSIGN  23564<>CALL    23565>>ASSIGN  23575>>ASSIGN
     23643>>ASSIGN  23668>>ASSIGN  23741>>ASSIGN  23928>>ASSIGN  23944>>ASSIGN  23961>>ASSIGN  23983>>ASSIGN
     24309>>ASSIGN  24349>>ASSIGN  24374>>ASSIGN  24405>>ASSIGN
BOOTRESULT
     20730**DCL     20646--DCLINIT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:229  
BOOT_BUFFER
     20528**DCL         8--PROC    23511--IF      23542>>ASSIGN  23982<<ASSIGN  24151--ENTRY   24154--ASSIGN
BUF$ IN PROCEDURE READ_RU
     24165**DCL     24166--IMP-PTR 24318<<ASSIGN  24320>>IF      24321<<ASSIGN  24322<<ASSIGN  24322>>ASSIGN
     24323>>ASSIGN  24327>>ASSIGN  24357<<ASSIGN  24359<>CALL    24360>>ASSIGN  24364<<ASSIGN  24364>>ASSIGN
     24382<<ASSIGN  24384>>IF      24385<<ASSIGN  24386<<ASSIGN  24386>>ASSIGN  24387>>ASSIGN  24391>>ASSIGN
BUFFER_PASSED
     21975**DCL     23512<<ASSIGN  23514<<ASSIGN  23541>>IF      23552>>IF      23981>>IF      24021>>IF
BYTESIZE IN PROCEDURE READ_RU
     24281**DCL     24355<<ASSIGN  24356>>ASSIGN  24366>>ASSIGN
BYTESLEFT IN PROCEDURE READ_RU
     24280**DCL     24356<<ASSIGN  24358>>DOWHILE 24363<<ASSIGN  24363>>ASSIGN
CHNRSP$ IN PROCEDURE CONFIG_LINK
     24965**DCL     24981--IMP-PTR 25673<<ASSIGN  25674>>ASSIGN  25718>>ASSIGN  25719>>ASSIGN  25720>>ASSIGN
     25721>>ASSIGN  25722>>ASSIGN  25723>>ASSIGN  25724>>ASSIGN  25724>>ASSIGN  25752<<ASSIGN  25753>>ASSIGN
     25765>>ASSIGN  25766>>ASSIGN  25767>>ASSIGN  25768>>ASSIGN  25769>>ASSIGN  25770>>ASSIGN
CHNRSPLEN IN PROCEDURE CONFIG_LINK
     25654**DCL     25724<<ASSIGN  25732>>ASSIGN  25777>>ASSIGN
CLEANUP_DCBS
     24480**PROC    24015--CALL    24025--CALL
CLOSE_GOODIES
     20872**DCL     24487<>CALL    24492<>CALL    24497<>CALL
CLOSE_GOODIES.SN_
     20872**DCL     20872--REDEF
CLOSE_GOODIES.UTL_
     20873**DCL     20873--REDEF
CLOSE_GOODIES.V
     20877**DCL     20872--DCLINIT
CLOSE_GOODIES.V.DCB#
     20878**DCL     24486<<ASSIGN  24491<<ASSIGN  24496<<ASSIGN
CLOSE_GOODIES.V.EXPIRE#
     20887**DCL     20887--REDEF
CLOSE_GOODIES.V.TYPE#
     20885**DCL     20885--REDEF
CLOSE_GOODIES.V.XTNSIZE#
     20882**DCL     20882--REDEF   20884--REDEF
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:230  
CLOSE_M$HLPF
     21973**DCL     23532<<ASSIGN  23534<<ASSIGN  24495>>IF
CLOSE_M$NETCON
     21971**DCL     23516<<ASSIGN  23518<<ASSIGN  24485>>IF
CLOSE_M$PROF
     21972**DCL     23524<<ASSIGN  23526<<ASSIGN  24490>>IF
CLOSE_RU
     21150**DCL     24393<>CALL    24483<>CALL
CLOSE_RU.SN_
     21150**DCL     21150--REDEF
CLOSE_RU.UTL_
     21151**DCL     21151--REDEF
CLOSE_RU.V
     21155**DCL     21150--DCLINIT
CLOSE_RU.V.EXPIRE#
     21165**DCL     21165--REDEF
CLOSE_RU.V.TYPE#
     21163**DCL     21163--REDEF
CLOSE_RU.V.XTNSIZE#
     21160**DCL     21160--REDEF   21162--REDEF
CONFIG_LINK
     24579**PROC    23855--CALL
CONTROL$
     21928**DCL     22166--IMP-PTR 23942<<ASSIGN  23944>>ASSIGN  23950<>CALL    23953>>CALL
CONV_NODENAME
     24103**PROC    23617--CALL
CURSIZE IN PROCEDURE GETSEG
     24402**DCL     24408<<ASSIGN  24409>>IF      24410>>ASSIGN
DATAOFFSET
     21946**DCL     23677<>CALL    23875<<ASSIGN  23882<<ASSIGN  23899>>ASSIGN  23910>>ASSIGN  24310<<ASSIGN
     24311>>ASSIGN  24374<<ASSIGN  24375>>ASSIGN
DATASEG
     20629**DCL     20609--DCLINIT 20625--DCLINIT 23542<<ASSIGN  23545<<ASSIGN  23548<>CALL    23554>>ASSIGN
     23556>>ASSIGN  23982>>ASSIGN  23986>>ASSIGN  23993>>ASSIGN  24143<<ASSIGN  24408>>ASSIGN
DFBASE
     21986**DCL     24154>>ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:231  
ERR IN PROCEDURE CONFIG_LINK
     24581**DCL     24579--PROC    25667<<ASSIGN  25677<<ASSIGN  25687<<ASSIGN  25691<>CALL    25699<<ASSIGN
     25748<<ASSIGN  25773<<ASSIGN
ERRBUF IN PROCEDURE PMMEERR
     24467**DCL     24432--DCLINIT 24458--DCLINIT 24459--DCLINIT
F$DCB.ACTPOS
     21653**DCL     21653--REDEF
F$DCB.ARS#
     21627**DCL     21627--REDEF   25954>>ASSIGN
F$DCB.ATTR
     21646**DCL     21647--REDEF
F$DCB.BORROW
     21661**DCL     21661--REDEF   21661--REDEF   21661--REDEF
F$DCB.DCBNAME.L
     21675**DCL     21675--IMP-SIZ
F$DCB.EOMCHAR#
     21631**DCL     21631--REDEF
F$DCB.EXPIRE#
     21644**DCL     23690<>CALL
F$DCB.FCD#
     21640**DCL     23517>>IF      23525>>IF      23533>>IF      24482>>IF      24485>>IF      24490>>IF
     24495>>IF
F$DCB.FLDID
     21656**DCL     21656--REDEF
F$DCB.FORM$
     21650**DCL     21650--REDEF
F$DCB.FSECT
     21666**DCL     21666--REDEF
F$DCB.FSN#
     21643**DCL     21643--REDEF   21643--REDEF   21644--REDEF
F$DCB.HEADER$
     21649**DCL     21649--REDEF
F$DCB.IXTNSIZE#
     21647**DCL     21647--REDEF
F$DCB.LASTSTA$
     21636**DCL     21636--REDEF
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:232  
F$DCB.LVL
     21662**DCL     21662--REDEF
F$DCB.NAME#.C
     21637**DCL     21637--REDEF
F$DCB.NOEOF
     21659**DCL     21659--REDEF
F$DCB.NRECS#
     21648**DCL     21648--REDEF
F$DCB.NRECX
     21667**DCL     21667--REDEF
F$DCB.OHDR
     21659**DCL     21659--REDEF
F$DCB.ORG#
     21642**DCL     21642--REDEF
F$DCB.PRECNO
     21665**DCL     21665--REDEF
F$DCB.RCSZ
     21671**DCL     21671--REDEF
F$DCB.RES#
     21638**DCL     21638--REDEF
F$DCB.SETX
     21650**DCL     21650--REDEF
F$DCB.TAB$
     21650**DCL     21650--REDEF
F$DCB.TDA
     21664**DCL     21665--REDEF
F$DCB.WSN#
     21638**DCL     21638--REDEF
FEACTV
     24040**LABEL   24045--EXIT
FEX
     20524**DCL         8--PROC    23502<>CALL    23557>>ASSIGN  23568>>ASSIGN  23569>>ASSIGN  23591<>CALL
     23593>>ASSIGN  23609>>ASSIGN  23946>>ASSIGN  23963>>ASSIGN  23994>>ASSIGN  24002>>IF      24033--ENTRY
     24039>>ASSIGN  24060>>ASSIGN  24067>>CALLBLT 24073>>ASSIGN  24135--ENTRY   24137<>CALL    24139<>CALL
     24151--ENTRY   24153<>CALL    25663>>ASSIGN  25681>>ASSIGN  25756>>ASSIGN
FEX IN PROCEDURE FIND_SAVEX
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:233  
     24539**DCL     24537--PROC    24544>>IF
FEX IN PROCEDURE GET_SAVEX
     24555**DCL     24553--PROC    24559<>CALL    24566>>ASSIGN
FIND_SAVEX
     24537**PROC    24137--CALL    24559--CALL
FOUND_LIB
     23902**LABEL   23885--GOTO
FPT_CLOSEHANDLER
     21588**DCL     24089<>CALL
FPT_CLOSEHANDLER.SN_
     21588**DCL     21588--REDEF
FPT_CLOSEHANDLER.UTL_
     21589**DCL     21589--REDEF
FPT_CLOSEHANDLER.V
     21593**DCL     21588--DCLINIT
FPT_CLOSEHANDLER.V.EXPIRE#
     21603**DCL     21603--REDEF
FPT_CLOSEHANDLER.V.TYPE#
     21601**DCL     21601--REDEF
FPT_CLOSEHANDLER.V.XTNSIZE#
     21598**DCL     21598--REDEF   21600--REDEF
FPT_ERRMSG IN PROCEDURE PMMEERR
     24431**DCL     24472<>CALL
FPT_ERRMSG.V IN PROCEDURE PMMEERR
     24435**DCL     24431--DCLINIT
FPT_ERRMSG.V.DCB# IN PROCEDURE PMMEERR
     24435**DCL     24471<<ASSIGN
FPT_FDS
     20625**DCL     24009<>CALL    24022<>CALL    24144<>CALL
FPT_FDS.V
     20625**DCL     20625--DCLINIT
FPT_FEBOOT
     20645**DCL     24006<>CALL
FPT_FEBOOT.BUF_
     20645**DCL     23993<<ASSIGN
FPT_FEBOOT.V
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:234  
     20646**DCL     20645--DCLINIT
FPT_FEBOOT.V.DMPSTART#
     20646**DCL     20647--REDEF
FPT_FEBOOT.V.FEP#
     20647**DCL     23994<<ASSIGN
FPT_FEBOOT.V.MLCPDUMP#
     20648**DCL     23988<<ASSIGN  23991<<ASSIGN
FPT_FEBOOT.V.NOTIME#
     20649**DCL     24004<<ASSIGN
FPT_FID
     21183**DCL     23562<>CALL    23663<>CALL    23889<>CALL    24078<>CALL
FPT_FID.TEXTFID_
     21183**DCL     23561<<ASSIGN  23662<<ASSIGN  23888<<ASSIGN  24077<<ASSIGN
FPT_FID.V
     21187**DCL     21183--DCLINIT
FPT_GDS
     20609**DCL     24411<>CALL
FPT_GDS.V
     20609**DCL     20609--DCLINIT
FPT_GDS.V.SEGSIZE#
     20612**DCL     24410<<ASSIGN
FPT_KEYIN IN PROCEDURE PMMEERR
     24458**DCL     24474<>CALL
FPT_KEYIN.V IN PROCEDURE PMMEERR
     24461**DCL     24458--DCLINIT
FPT_MONINFO
     20662**DCL     23605<>CALL    23612<>CALL    23619<>CALL    23627<>CALL    23925<>CALL
FPT_NODEINFO
     20712**DCL     23594<>CALL    24041<>CALL
FPT_NODEINFO.V
     20712**DCL     20712--DCLINIT
FPT_NODEINFO.V.NODENUM#
     20713**DCL     23593<<ASSIGN  24039<<ASSIGN
FPT_OPNRU
     21081**DCL     23563<>CALL    23664<>CALL    23891<>CALL
FPT_OPNRU.ACSVEH_
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:235  
     21083**DCL     21084--REDEF
FPT_OPNRU.ALTKEYS_
     21089**DCL     21090--REDEF   21090--REDEF
FPT_OPNRU.HDR_
     21088**DCL     21089--REDEF
FPT_OPNRU.TAB_
     21087**DCL     21088--REDEF
FPT_OPNRU.UHL_
     21081**DCL     21082--REDEF   21082--REDEF
FPT_OPNRU.V
     21090**DCL     21081--DCLINIT
FPT_OPNRU.V.ASN#
     21100**DCL     21186--DCLINIT
FPT_OPNRU.V.FSN#
     21121**DCL     21121--REDEF   21121--REDEF
FPT_OPNRU.V.RES#
     21105**DCL     21186--DCLINIT
FPT_OPNRU.WSN_
     21087**DCL     21087--REDEF
FPT_PRECORD IN PROCEDURE READ_RU
     24220**DCL     24302<>CALL    24314<>CALL    24316<>CALL    24325<>CALL    24344<>CALL    24362<>CALL
     24379<>CALL    24389<>CALL
FPT_PRECORD.V IN PROCEDURE READ_RU
     24222**DCL     24220--DCLINIT
FPT_PRECORD.V.KEYR# IN PROCEDURE READ_RU
     24223**DCL     24299<<ASSIGN  24339<<ASSIGN  24377<<ASSIGN
FPT_PRECORD.V.KEYS# IN PROCEDURE READ_RU
     24223**DCL     24300<<ASSIGN  24315<<ASSIGN  24343<<ASSIGN  24345<<ASSIGN  24378<<ASSIGN  24380<<ASSIGN
FPT_PRECORD.V.N# IN PROCEDURE READ_RU
     24226**DCL     24301<<ASSIGN  24313<<ASSIGN
FPT_READRU IN PROCEDURE READ_RU
     24187**DCL     24294<>CALL    24324<>CALL    24332<>CALL    24361<>CALL    24388<>CALL
FPT_READRU.BUF_ IN PROCEDURE READ_RU
     24189**DCL     24291<<ASSIGN  24323<<ASSIGN  24329<<ASSIGN  24360<<ASSIGN  24387<<ASSIGN
FPT_READRU.KEY_ IN PROCEDURE READ_RU
     24187**DCL     24292<<ASSIGN  24317<<ASSIGN  24330<<ASSIGN  24338<<ASSIGN  24381<<ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:236  
FPT_READRU.STATION_ IN PROCEDURE READ_RU
     24190**DCL     24191--REDEF
FPT_READRU.V IN PROCEDURE READ_RU
     24191**DCL     24187--DCLINIT
FPT_READRU.V.DVBYTE.REREAD# IN PROCEDURE READ_RU
     24202**DCL     24202--REDEF
FPT_READRU.V.INDX# IN PROCEDURE READ_RU
     24200**DCL     24200--REDEF
FPT_READRU.V.KEYS# IN PROCEDURE READ_RU
     24192**DCL     24293<<ASSIGN  24331<<ASSIGN  24340<<ASSIGN
FPT_STARTHANDLER
     21460**DCL     24084<>CALL
FPT_STARTHANDLER.ACSVEH_
     21462**DCL     21463--REDEF
FPT_STARTHANDLER.ALTKEYS_
     21468**DCL     21469--REDEF   21469--REDEF
FPT_STARTHANDLER.HDR_
     21467**DCL     21468--REDEF
FPT_STARTHANDLER.TAB_
     21466**DCL     21467--REDEF
FPT_STARTHANDLER.UHL_
     21460**DCL     21461--REDEF   21461--REDEF
FPT_STARTHANDLER.V
     21469**DCL     21460--DCLINIT
FPT_STARTHANDLER.V.FSN#
     21500**DCL     21500--REDEF   21500--REDEF
FPT_STARTHANDLER.V.RES#
     21484**DCL     24067<<CALLBLT
FPT_STARTHANDLER.WSN_
     21466**DCL     21466--REDEF
FPT_WAIT
     21391**DCL     24048<>CALL
FPT_WAIT.V
     21392**DCL     21391--DCLINIT
GETPRO IN PROCEDURE CONFIG_LINK
     25792**PROC    25727--CALL    25734--CALL    25772--CALL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:237  
GETSEG
     24399**PROC    23548--CALL    23586--CALL    23638--CALL    23669--CALL    23758--CALL    23930--CALL
     23950--CALL    23967--CALL    24308--CALL    24359--CALL    24373--CALL    25676--CALL    25747--CALL
GET_SAVEX
     24553**PROC    23502--CALL    24153--CALL
GI$CONTROL
     22166**DCL     23950--CALL    23951--ASSIGN
GI$CONTROL.PARAMS
     22166**DCL     23953<>CALL
GI$OFFSETS
     21992**DCL     23583--ASSIGN
GI$OFFSETS.BOOTFID
     21994**DCL     23598<<ASSIGN
GI$OFFSETS.CNTL#
     21992**DCL     23943<<ASSIGN  23956<<ASSIGN
GI$OFFSETS.CNTLOFFSET
     21992**DCL     23945<>CALL
GI$OFFSETS.FEX
     21993**DCL     23590--ASSIGN
GI$OFFSETS.HANDLER
     21994**DCL     23583--ASSIGN  23585--ASSIGN
GI$OFFSETS.HANDLER.TBLOFFSET
     21994**DCL     23674--ASSIGN
GI$OFFSETS.HOSTNODE
     21994**DCL     23632--ASSIGN
GI$OFFSETS.NHANDLERS
     21994**DCL     23588--ASSIGN
GI$OFFSETS.NODENAME
     21993**DCL     23597<<ASSIGN
GI$OFFSETS.PARAM#
     21992**DCL     23927<<ASSIGN
GI$OFFSETS.PARAMOFFSET
     21992**DCL     23929<>CALL
GI$OFFSETS.PSEUDO#
     21993**DCL     23960<<ASSIGN  23968<<ASSIGN
GI$OFFSETS.PSEUDOOFFSET
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:238  
     21992**DCL     23962<>CALL
GI$OFFSETS.SECTOFFSET
     21993**DCL     23644--ASSIGN
GI$OFFSETS.SECTSIZE
     21993**DCL     23641--ASSIGN
GI$PARAMS
     22163**DCL     23930--CALL    23931--ASSIGN
GI$PARAMS.PARAMS
     22163**DCL     23938<>CALL
GI$PSEUDO
     22169**DCL     23967--CALL    23977--ASSIGN
GI$PSEUDO.MAX_CG
     22169**DCL     23973<>CALL
GI$PSEUDO.MAX_GHST
     22170**DCL     23975<>CALL
GI$PSEUDO.MAX_HND
     22169**DCL     23974<>CALL
GI$PSEUDO.MAX_SYS
     22169**DCL     23971<>CALL
GI$PSEUDO.MAX_USR
     22169**DCL     23972<>CALL
GI$PSEUDO.NAME
     22169**DCL     23970<<ASSIGN
GI$SECTION
     22176**DCL     23638--CALL    23646<<ASSIGN
GI$SECTION.NUMSECTS
     22176**DCL     23637--ASSIGN
GI$SECTION.SECT
     22176**DCL     23637--ASSIGN
GI$SETFP
     22024**DCL     23669--CALL    23670--ASSIGN  23673<<ASSIGN
GI$SETFP.ACCT
     22036**DCL     23683<<ASSIGN
GI$SETFP.DATA_BIAS
     22106**DCL     23736<>CALL
GI$SETFP.DATA_SZ
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:239  
     22096**DCL     23728<>CALL
GI$SETFP.DCBRES
     22071**DCL     23708<>CALL
GI$SETFP.DS1_SZ
     22156**DCL     23870<>CALL
GI$SETFP.FLAGS.DEBUG
     22063**DCL     23687<<ASSIGN
GI$SETFP.FLAGS.LAUTO
     22063**DCL     23693<<ASSIGN
GI$SETFP.FLAGS.LIB
     22057**DCL     23697<<ASSIGN
GI$SETFP.FLAGS.NOCHRPMEM
     22058**DCL     23695<<ASSIGN
GI$SETFP.FLAGS.PROCACC
     22058**DCL     23694<<ASSIGN
GI$SETFP.FLAGS.S
     22057**DCL     23696<<ASSIGN
GI$SETFP.FLAGS.XEQ_ONLY
     22057**DCL     23689<<ASSIGN
GI$SETFP.LIB_DATA_SZ
     22141**DCL     23919<>CALL
GI$SETFP.LIB_NAME
     22110**DCL     23691<<ASSIGN
GI$SETFP.LIB_NAME.TEXT
     22114**DCL     23897>>ASSIGN
GI$SETFP.LIB_PROC_SZ
     22146**DCL     23915<>CALL
GI$SETFP.MODTIME
     22039**DCL     23690<>CALL
GI$SETFP.NAME.L
     22036**DCL     23685<<ASSIGN
GI$SETFP.NAME.TEXT
     22036**DCL     23686<<ASSIGN
GI$SETFP.OFFSET_DATA
     22121**DCL     23676--ASSIGN
GI$SETFP.OFFSET_DS1
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:240  
     22151**DCL     23742<>CALL
GI$SETFP.OFFSET_LIB_DATA
     22131**DCL     23911<>CALL
GI$SETFP.OFFSET_LIB_PROC
     22136**DCL     23907<>CALL
GI$SETFP.OFFSET_PROC
     22126**DCL     23678--ASSIGN
GI$SETFP.OFFSET_RO
     22116**DCL     23680--ASSIGN
GI$SETFP.PASS
     22036**DCL     23682<<ASSIGN
GI$SETFP.PROC_SZ
     22101**DCL     23732<>CALL
GI$SETFP.PSN
     22037**DCL     23684<<ASSIGN
GI$SETFP.ROS_SZ
     22091**DCL     23724<>CALL
GI$SETFP.START
     22044**DCL     23700<>CALL
GI$SETFP.TCBSIZE
     22076**DCL     23712<>CALL
GI$SETFP.UDCBNUM
     22066**DCL     23704<>CALL
GI$SETFP.VDPGS
     22086**DCL     23720<>CALL
GI$SETFP.VERSION
     22064**DCL     23692<<ASSIGN
GI$SETFP.VPPGS
     22081**DCL     23716<>CALL
GO1 IN PROCEDURE READ_RU
     24301**LABEL   24302--CALLALT
GO2 IN PROCEDURE READ_RU
     24315**LABEL   24314--CALLALT
HALFB IN PROCEDURE CONFIG_LINK
     25656**DCL     25743<>CALL    25780<>CALL
HAND_ACCT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:241  
     21515**DCL     21465--DCLINIT
HAND_ACCT.ACCT#
     21515**DCL     24083<<ASSIGN
HAND_NAME
     21542**DCL     21461--DCLINIT
HAND_NAME.NAME#
     21542**DCL     24082<<ASSIGN
HD$
     21678**DCL     21725--IMP-PTR 23691>>ASSIGN  23692>>ASSIGN  23693>>ASSIGN  23694>>ASSIGN  23695>>ASSIGN
     23696>>ASSIGN  23697>>ASSIGN  23699>>ASSIGN  23703>>ASSIGN  23707>>ASSIGN  23711>>ASSIGN  23715>>ASSIGN
     23719>>ASSIGN  23723>>ASSIGN  23727>>ASSIGN  23731>>ASSIGN  23735>>ASSIGN  23878>>IF      23880>>IF
     23888>>ASSIGN  23894>>ASSIGN  23895>>ASSIGN  24298>>ASSIGN  24304>>ASSIGN  24306>>ASSIGN  24333>>ASSIGN
     24370>>ASSIGN  24371>>ASSIGN  24376>>ASSIGN
HEADBUF
     21677**DCL     21678--DCLINIT 24291--ASSIGN
HEADKEY IN PROCEDURE READ_RU
     24255**DCL     24292--ASSIGN
HLP$ IN PROCEDURE CONFIG_LINK
     24961**DCL     25706<<ASSIGN  25707>>ASSIGN  25708>>ASSIGN  25710>>ASSIGN  25712>>ASSIGN  25714>>ASSIGN
     25734>>CALL    25741<<ASSIGN  25741>>ASSIGN  25755>>ASSIGN  25782<<ASSIGN  25782>>ASSIGN
HLPNAME
     21336**DCL     23536--ASSIGN
HNDLRS
     23653**LABEL   23656--EXIT
HNDLR_SRCH
     23769**LABEL   23772--EXIT
HOSTNAME
     20526**DCL     23609<<ASSIGN  23610>>IF      23617<>CALL
HOSTNAME IN PROCEDURE CONFIG_LINK
     25651**DCL     25691<>CALL
HOSTNODE
     20525**DCL     23606<<ASSIGN  23613<<ASSIGN  23617<>CALL    23620<<ASSIGN  23628<<ASSIGN  23633<>CALL
I
     21953**DCL     23768<<DOINDEX 23770>>IF      23774>>CALL    23775>>ASSIGN  23937<<DOINDEX 23938>>CALL
     23938>>CALL    23952<<DOINDEX 23953>>CALL    23953>>CALL    23969<<DOINDEX 23970>>ASSIGN  23970>>ASSIGN
     23971>>CALL    23971>>CALL    23972>>CALL    23972>>CALL    23973>>CALL    23973>>CALL    23974>>CALL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:242  
     23974>>CALL    23975>>CALL    23975>>CALL
I IN PROCEDURE CONV_NODENAME
     24110**DCL     24119<<DOINDEX 24120>>IF      24122>>ASSIGN  24126>>ASSIGN
I IN PROCEDURE FIND_SAVEX
     24541**DCL     24543<<DOINDEX 24544>>IF      24545>>ASSIGN
I IN PROCEDURE GET_SAVEX
     24557**DCL     24564<<DOINDEX 24565>>IF      24566>>ASSIGN  24567>>ASSIGN  24568>>ASSIGN  24569>>ASSIGN
I IN PROCEDURE READ_RU
     24168**DCL     24341<<DOINDEX 24342>>ASSIGN  24346>>ASSIGN  24347>>ASSIGN  24350>>ASSIGN  24352>>ASSIGN
     24353>>ASSIGN  24355>>ASSIGN
I IN PROCEDURE STORVAL
     24509**DCL     24511<<DOINDEX 24512>>ASSIGN  24512>>ASSIGN
IMAGE$ IN PROCEDURE READ_RU
     24163**DCL     24162--PROC    24308<>CALL    24309>>ASSIGN  24321>>ASSIGN  24327>>ASSIGN  24337>>ASSIGN
     24368>>ASSIGN  24373<>CALL    24374>>ASSIGN  24385>>ASSIGN  24391>>ASSIGN
IN$
     21933**DCL     23808<<ASSIGN  23839>>ASSIGN
INDX
     21936**DCL     23806<<DOINDEX 23808>>ASSIGN  23811>>ASSIGN  23816>>ASSIGN  23824>>ASSIGN  23835>>DOINDEX
IPARAM$
     21935**DCL     23802<<ASSIGN  23803<<ASSIGN  23803>>ASSIGN  23804>>ASSIGN  23817>>CALL    23819<<ASSIGN
     23819>>ASSIGN  23825>>CALL    23827<<ASSIGN  23827>>ASSIGN  23832>>CALL    23834<<ASSIGN  23834>>ASSIGN
J
     21954**DCL     23577<<DOINDEX 23578>>IF      23652<<DOINDEX 23654>>IF      23658>>ASSIGN  23674>>ASSIGN
     23686>>ASSIGN  23738>>IF      24038<<ASSIGN  24040>>DOWHILE 24049<<ASSIGN  24049>>ASSIGN  24050>>IF
     24068<<DOINDEX 24070>>IF      24072>>ASSIGN
K
     21955**DCL     23786<<DOINDEX 23787>>IF      23789>>ASSIGN  23789>>ASSIGN  23794>>ASSIGN  23795>>CALL
     23835<<DOINDEX 23839>>ASSIGN  23840>>CALL
KEY_FEPBOOT
     22637**DCL     23558--ASSIGN
KEY_FEPBOOT.NODE
     22640**DCL     23557<<ASSIGN
KEY_FEPCTL
     22774**DCL     23947--ASSIGN
KEY_FEPCTL.NODE
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:243  
     22777**DCL     23946<<ASSIGN
KEY_FEPHNDLR
     22655**DCL     23570--ASSIGN  24061--ASSIGN
KEY_FEPHNDLR.NODE
     22658**DCL     23569<<ASSIGN  24060<<ASSIGN
KEY_HNDLR
     22673**DCL     23659--ASSIGN  23764--ASSIGN  24074--ASSIGN
KEY_HNDLR.HNDLR
     22677**DCL     23658<<ASSIGN  23775<<ASSIGN  23778>>ASSIGN  24072<<ASSIGN
KEY_HNDLR.NODE
     22676**DCL     23568<<ASSIGN  24073<<ASSIGN
KEY_PSEUDO
     22736**DCL     23964--ASSIGN
KEY_PSEUDO.NODE
     22739**DCL     23963<<ASSIGN
KFD$MLCPDUMP
     20578**DCL-ENT 24139--CALL
KFF$9TO8
     20579**DCL-ENT 23700--CALL    23704--CALL    23708--CALL    23712--CALL    23716--CALL    23720--CALL
     23724--CALL    23728--CALL    23732--CALL    23736--CALL    23795--CALL    23817--CALL    23825--CALL
     23832--CALL    23840--CALL    23857--CALL    23862--CALL    23868--CALL    23907--CALL    23911--CALL
     23915--CALL    23919--CALL    25709--CALL    25711--CALL    25713--CALL    25715--CALL    25739--CALL
     25743--CALL    25778--CALL    25780--CALL
KL$CHNRSP
     23019**DCL     23857--CALL    23862--CALL    23864<<ASSIGN  23865--ASSIGN
KL$CHNRSP.TERMINAL_ID.TERM
     23070**DCL     23079--REDEF
KL$CHNRSP IN PROCEDURE CONFIG_LINK
     24981**DCL     25718<<ASSIGN  25765<<ASSIGN
KL$CHNRSP.CONFIG IN PROCEDURE CONFIG_LINK
     24992**DCL     25766<<ASSIGN
KL$CHNRSP.FCN IN PROCEDURE CONFIG_LINK
     24982**DCL     25719<<ASSIGN  25767<<ASSIGN
KL$CHNRSP.HNDCMN IN PROCEDURE CONFIG_LINK
     25110**DCL     25723<<ASSIGN  25770<<ASSIGN
KL$CHNRSP.MESSAGE.MESSAGE IN PROCEDURE CONFIG_LINK
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:244  
     25182**DCL     25674--ASSIGN  25724--ASSIGN  25753--ASSIGN
KL$CHNRSP.NA IN PROCEDURE CONFIG_LINK
     25061**DCL     25722<<ASSIGN  25769<<ASSIGN
KL$CHNRSP.TERMINAL_ID IN PROCEDURE CONFIG_LINK
     25030**DCL     25720<<ASSIGN  25768<<ASSIGN
KL$CHNRSP.TERMINAL_ID.TERM IN PROCEDURE CONFIG_LINK
     25032**DCL     25041--REDEF
KL$CHNRSP.TERMINAL_ID.TERM.TERM_NAME IN PROCEDURE CONFIG_LINK
     25041**DCL     25721<<ASSIGN
KL$CONTROL_INIT
     22213**DCL     23758--CALL    23761--ASSIGN  23776<<ASSIGN  23850--ASSIGN
KL$CONTROL_INIT.CODE
     22218**DCL     23777<<ASSIGN
KL$CONTROL_INIT.FPARAM
     22292**DCL     23789<<ASSIGN  23795<>CALL    23802--ASSIGN
KL$CONTROL_INIT.HANDLER
     22222**DCL     23778<<ASSIGN
KL$CONTROL_INIT.IPARAM
     22294**DCL     23804--ASSIGN
KL$CONTROL_INIT.IPARAM.ARRAY_SZ
     22300**DCL     23819--ASSIGN
KL$CONTROL_INIT.IPARAM.OFFSET
     22302**DCL     23834--ASSIGN
KL$CONTROL_INIT.IPARAM.PARAM_SZ
     22301**DCL     23827--ASSIGN
KL$CONTROL_INIT.NUM_FPARAM
     22286**DCL     23784<<ASSIGN
KL$CONTROL_INIT.NUM_IPARAM
     22287**DCL     23785<<ASSIGN
KL$CONTROL_INIT.TYPE
     22219**DCL     23783<<ASSIGN
KL$HLPR IN PROCEDURE CONFIG_LINK
     24856**DCL     25697--ASSIGN  25704<<ASSIGN
KL$HLPR.PASSWORD IN PROCEDURE CONFIG_LINK
     24914**DCL     24918--REDEF
KL$HLPR.PNAME IN PROCEDURE CONFIG_LINK
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:245  
     24920**DCL     25727<>CALL
KL$HLPR.RENAME IN PROCEDURE CONFIG_LINK
     24937**DCL     24938--REDEF
KL$HLPR.REST IN PROCEDURE CONFIG_LINK
     24956**DCL     25706--ASSIGN
KL$LINCNFG IN PROCEDURE CONFIG_LINK
     24653**DCL     25685--ASSIGN  25761--ASSIGN
KL$LINCNFG.KHA IN PROCEDURE CONFIG_LINK
     24672**DCL     25723>>ASSIGN  25770>>ASSIGN
KL$LINCNFG.LGN IN PROCEDURE CONFIG_LINK
     24789**DCL     25691<>CALL
KL$LINCNFG.NA IN PROCEDURE CONFIG_LINK
     24752**DCL     25722>>ASSIGN  25769>>ASSIGN
KL$LINK IN PROCEDURE CONFIG_LINK
     24603**DCL     25665--ASSIGN
KL$LINK.CHANNEL IN PROCEDURE CONFIG_LINK
     24605**DCL     24612--REDEF   25683>>ASSIGN
KL$LINK.LINKS# IN PROCEDURE CONFIG_LINK
     24604**DCL     25671>>DOINDEX
KL$LNK
     22797**DCL     23857--CALL    23861<<ASSIGN  23862--CALL    23863--ASSIGN
KL$LNK.BLKHDR.BLKTYP
     22843**DCL     23858<<ASSIGN
KL$LNK.BLKHDR.LEN
     22834**DCL     23862<>CALL
KL$LNK.BLKHDR.LEV
     22819**DCL     23859<<ASSIGN
KL$LNK IN PROCEDURE CONFIG_LINK
     25207**DCL     25673--ASSIGN  25707<<ASSIGN  25707>>ASSIGN  25732--ASSIGN  25741--ASSIGN
KL$LNK.BLKHDR.LEN IN PROCEDURE CONFIG_LINK
     25244**DCL     25739<>CALL    25778<>CALL
KL$LNK.BLKHDR.NSUBS IN PROCEDURE CONFIG_LINK
     25240**DCL     25716>>ASSIGN
KL$LNK.BLKHDR.PROOFFSET IN PROCEDURE CONFIG_LINK
     25276**DCL     25726<<ASSIGN
KL$LNK.DFLTVCPRO IN PROCEDURE CONFIG_LINK
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:246  
     25372**DCL     25734<>CALL
KL$LNK.HIC IN PROCEDURE CONFIG_LINK
     25345**DCL     25710>>ASSIGN  25711<>CALL
KL$LNK.HOC IN PROCEDURE CONFIG_LINK
     25355**DCL     25714>>ASSIGN  25715<>CALL
KL$LNK.LIC IN PROCEDURE CONFIG_LINK
     25340**DCL     25708>>ASSIGN  25709<>CALL
KL$LNK.LOC IN PROCEDURE CONFIG_LINK
     25350**DCL     25712>>ASSIGN  25713<>CALL
KL$LNKVC IN PROCEDURE CONFIG_LINK
     25429**DCL     25752--ASSIGN  25755<<ASSIGN  25755>>ASSIGN  25777--ASSIGN  25782--ASSIGN
KL$LNKVC.BLKHDR.DEVNUM IN PROCEDURE CONFIG_LINK
     25502**DCL     25758>>ASSIGN
KL$LNKVC.BLKHDR.PROOFFSET IN PROCEDURE CONFIG_LINK
     25498**DCL     25776<<ASSIGN
KL$LNKVC.CUG IN PROCEDURE CONFIG_LINK
     25528**DCL     25572--REDEF
KL$LNKVC.PRONM IN PROCEDURE CONFIG_LINK
     25599**DCL     25772<>CALL
KL$PHDR IN PROCEDURE GETPRO
     25913**DCL     25954--ASSIGN  25956--ASSIGN
KLH$SGSCAN
     20580**DCL-ENT 25691--CALL
KL_CHNRSP
     23239**DCL     23864>>ASSIGN
KL_CHNRSP.TERMINAL_ID.TERM
     23290**DCL     23299--REDEF
KL_FEPBOOT
     22449**DCL     23559--ASSIGN
KL_FEPBOOT.BOOTFID
     22450**DCL     23561--ASSIGN  23598>>ASSIGN
KL_FEPBOOT.BOOTPARAMS
     22456**DCL     23932<<ASSIGN  23934<<ASSIGN  23936<<ASSIGN  23938<>CALL
KL_FEPCTL
     22754**DCL     23948--ASSIGN
KL_FEPCTL.PARAMS
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:247  
     22757**DCL     23953<>CALL
KL_FEPHNDLR
     22474**DCL     23571--ASSIGN  24062--ASSIGN
KL_FEPHNDLR.BOOTIME
     22481**DCL     23578>>IF      23654>>IF      23770>>IF      24070>>IF
KL_FEPHNDLR.DEFLIBACCT
     22478**DCL     23890>>ASSIGN
KL_FEPHNDLR.HANDLER
     22485**DCL     23658>>ASSIGN  23686>>ASSIGN  23738>>IF      23775>>ASSIGN  24072>>ASSIGN
KL_FEPHNDLR.NHANDLERS
     22475**DCL     23577>>DOINDEX 23581>>ASSIGN  23652>>DOINDEX 23768>>DOINDEX 24068>>DOINDEX
KL_HLPR_KEY IN PROCEDURE CONFIG_LINK
     24957**DCL     25696--ASSIGN
KL_HLPR_KEY.ACCT IN PROCEDURE CONFIG_LINK
     24959**DCL     25693<<ASSIGN  25695--ASSIGN
KL_HLPR_KEY.L IN PROCEDURE CONFIG_LINK
     24958**DCL     25695<<ASSIGN
KL_HLPR_KEY.UNAME IN PROCEDURE CONFIG_LINK
     24960**DCL     25694<<ASSIGN
KL_HNDLR
     22507**DCL     23660--ASSIGN  23763--ASSIGN  23808--ASSIGN  24075--ASSIGN
KL_HNDLR.HNDLRFID
     22508**DCL     23662--ASSIGN  24077--ASSIGN
KL_HNDLR.IPARAM.ARRAY_SZ
     22540**DCL     23811>>ASSIGN  23816>>ASSIGN  23835>>DOINDEX
KL_HNDLR.IPARAM.OFFSET
     22549**DCL     23808>>ASSIGN
KL_HNDLR.IPARAM.PARAM_SZ
     22545**DCL     23824>>ASSIGN
KL_HNDLR.NPARAMI
     22529**DCL     23785>>ASSIGN  23800>>IF      23804>>ASSIGN  23806>>DOINDEX
KL_HNDLR.NPARAMS
     22524**DCL     23781>>IF      23784>>ASSIGN  23786>>DOINDEX 23803>>ASSIGN
KL_HNDLR.PARAMS
     22534**DCL     23789>>ASSIGN  23794>>ASSIGN
KL_LINCNFG_KEY IN PROCEDURE CONFIG_LINK
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:248  
     24806**DCL     25684--ASSIGN  25760--ASSIGN
KL_LINCNFG_KEY.NODE IN PROCEDURE CONFIG_LINK
     24809**DCL     25681<<ASSIGN  25756<<ASSIGN
KL_LINCNFG_KEY.TERMID IN PROCEDURE CONFIG_LINK
     24826**DCL     25682<>CALL    25720>>ASSIGN  25757<>CALL    25768>>ASSIGN
KL_LINCNFG_KEY.TERMID.TERM IN PROCEDURE CONFIG_LINK
     24828**DCL     24837--REDEF
KL_LINCNFG_KEY.TERMID.TERM.CHANNEL IN PROCEDURE CONFIG_LINK
     24830**DCL     25683<<ASSIGN
KL_LINCNFG_KEY.TERMID.TERM.SUBDEVICE.BYT IN PROCEDURE CONFIG_LINK
     24831**DCL     25758<<ASSIGN
KL_LINCNFG_KEY.TERMID.TERM.TERM_NAME IN PROCEDURE CONFIG_LINK
     24837**DCL     25759<<ASSIGN
KL_LINK_KEY IN PROCEDURE CONFIG_LINK
     24627**DCL     25664--ASSIGN
KL_LINK_KEY.NODE IN PROCEDURE CONFIG_LINK
     24630**DCL     25663<<ASSIGN
KL_NETWORK
     23458**DCL     23600--ASSIGN  23999--ASSIGN  24112--ASSIGN
KL_NETWORK.NODE.CONTROL_NODE
     23468**DCL     23609>>ASSIGN
KL_NETWORK.NODE.NODE
     23467**DCL     24120>>IF
KL_NETWORK.NODE.TYPE
     23464**DCL     24002>>IF      24122>>ASSIGN
KL_NETWORK.NODE#
     23459**DCL     23602>>IF      24119>>DOINDEX
KL_NETWORK_KEY
     23485**DCL     23599--ASSIGN  24000--ASSIGN  24113--ASSIGN
KL_PSEUDO
     22692**DCL     23965--ASSIGN
KL_PSEUDO.PSEUDO.MAX_CG
     22707**DCL     23973<>CALL
KL_PSEUDO.PSEUDO.MAX_GHST
     22717**DCL     23975<>CALL
KL_PSEUDO.PSEUDO.MAX_HAND
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:249  
     22712**DCL     23974<>CALL
KL_PSEUDO.PSEUDO.MAX_SYS
     22698**DCL     23971<>CALL
KL_PSEUDO.PSEUDO.MAX_USR
     22702**DCL     23972<>CALL
KL_PSEUDO.PSEUDO.NAME
     22696**DCL     23970>>ASSIGN
KL_PSEUDO.PSEUDO#
     22693**DCL     23967>>CALL    23968>>ASSIGN  23969>>DOINDEX 23977>>ASSIGN
L1 IN PROCEDURE PMMEERR
     24473**LABEL   24474--CALLALT
L66WD IN PROCEDURE STORVAL
     24505**DCL     24502--PROC
L66WD.BITES IN PROCEDURE STORVAL
     24507**DCL     24512>>ASSIGN
L6DW IN PROCEDURE STORVAL
     24503**DCL     24502--PROC
L6DW.BITES IN PROCEDURE STORVAL
     24504**DCL     24512<<ASSIGN
LEV IN PROCEDURE SCRUB_TERMID
     25992**DCL     25961--PROC    25995>>ASSIGN
LIBX
     21976**DCL     23879<<DOINDEX 23880>>IF      23881>>ASSIGN  23882>>ASSIGN  23883>>ASSIGN  23884>>ASSIGN
LIB_DATASIZ
     21979**DCL     23877<<ASSIGN  23884<<ASSIGN  23895<<ASSIGN  23901>>ASSIGN  23918>>ASSIGN
LIB_PROCSIZ
     21978**DCL     23876<<ASSIGN  23883<<ASSIGN  23894<<ASSIGN  23900>>ASSIGN  23914>>ASSIGN
LIB_TBL
     21980**DCL     23650<<ASSIGN
LIB_TBL.DATAOFFSET
     21983**DCL     23882>>ASSIGN  23899<<ASSIGN
LIB_TBL.DATASIZE
     21985**DCL     23884>>ASSIGN  23901<<ASSIGN
LIB_TBL.NAME
     21981**DCL     23880>>IF      23897<<ASSIGN
LIB_TBL.PROCOFFSET
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:250  
     21982**DCL     23881>>ASSIGN  23898<<ASSIGN
LIB_TBL.PROCSIZE
     21984**DCL     23883>>ASSIGN  23900<<ASSIGN
LINKX IN PROCEDURE CONFIG_LINK
     25641**DCL     25671<<DOINDEX 25683>>ASSIGN
LNK$ IN PROCEDURE CONFIG_LINK
     25189**DCL     25207--IMP-PTR 25429--IMP-PTR 25672<<ASSIGN  25673>>ASSIGN  25707>>ASSIGN  25709>>CALL
     25711>>CALL    25713>>CALL    25715>>CALL    25716>>ASSIGN  25726>>ASSIGN  25726>>ASSIGN  25739>>CALL
     25751<<ASSIGN  25752>>ASSIGN  25755>>ASSIGN  25758>>ASSIGN  25772>>CALL    25776>>ASSIGN  25776>>ASSIGN
     25778>>CALL
M$CLOSE
      8973**DCL-ENT 24089--CALL    24393--CALL    24483--CALL    24487--CALL    24492--CALL    24497--CALL
M$ERRMSG
      9036**DCL-ENT 24472--CALL
M$FDS
      9008**DCL-ENT 24009--CALL    24022--CALL    24144--CALL
M$FEBOOT
      9001**DCL-ENT 24006--CALL
M$FID
      9036**DCL-ENT 23562--CALL    23663--CALL    23889--CALL    24078--CALL
M$GDS
      9008**DCL-ENT 24411--CALL
M$HLPF
     20588**DCL     23533--IF      23535>>ASSIGN  24495--IF      24496>>ASSIGN
M$KEYIN
      8978**DCL-ENT 24474--CALL
M$MONINFO
      9041**DCL-ENT 23605--CALL    23612--CALL    23619--CALL    23627--CALL    23925--CALL
M$NETCON
     20586**DCL     23517--IF      23519>>ASSIGN  24485--IF      24486>>ASSIGN
M$NODEINFO
      9005**DCL-ENT 23594--CALL    24041--CALL
M$OPEN
      8973**DCL-ENT 23521--CALL    23529--CALL    23537--CALL    23563--CALL    23664--CALL    23891--CALL
     24084--CALL
M$PRECORD
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:251  
      8977**DCL-ENT 24302--CALL    24314--CALL    24316--CALL    24325--CALL    24344--CALL    24362--CALL
     24379--CALL    24389--CALL
M$PROF
     20587**DCL     23525--IF      23527>>ASSIGN  24490--IF      24491>>ASSIGN  25954--ASSIGN
M$READ
      8974**DCL-ENT 23560--CALL    23572--CALL    23601--CALL    23661--CALL    23779--CALL    23949--CALL
     23966--CALL    24001--CALL    24063--CALL    24076--CALL    24114--CALL    24294--CALL    24324--CALL
     24332--CALL    24361--CALL    24388--CALL    25666--CALL    25686--CALL    25698--CALL    25762--CALL
     25950--CALL
M$RU
     20585**DCL     23690--CALL    24482--IF
M$WAIT
      9031**DCL-ENT 24048--CALL
NETCONNAME
     21307**DCL     23520--ASSIGN
NEWSIZE IN PROCEDURE GETSEG
     24403**DCL     24405<<ASSIGN  24406>>IF      24407<<ASSIGN  24407>>ASSIGN  24407>>ASSIGN  24409>>IF
     24410>>ASSIGN
NEXT IN PROCEDURE READ_RU
     24380**LABEL   24379--CALLALT
NEXT$
     21963**DCL     23587<<ASSIGN  23636>>ASSIGN  23639<<ASSIGN  23667>>ASSIGN  23670<<ASSIGN  23671<>CALL
     23672<<ASSIGN  23672>>ASSIGN  23740>>ASSIGN  23743>>ASSIGN  23761<<ASSIGN  23761>>ASSIGN  23762>>CALL
     23853>>ASSIGN  23854<<ASSIGN  23856<<ASSIGN  23857>>CALL    23858>>ASSIGN  23859>>ASSIGN  23860<<ASSIGN
     23860>>ASSIGN  23861>>ASSIGN  23862>>CALL    23863<<ASSIGN  23863>>ASSIGN  23864>>ASSIGN  23865<<ASSIGN
     23865>>ASSIGN  23867>>ASSIGN  23869<>CALL    23870>>CALL    23892<>CALL    23896<<ASSIGN  23896>>ASSIGN
     23926>>ASSIGN  23931<<ASSIGN  23931>>ASSIGN  23942>>ASSIGN  23951<<ASSIGN  23951>>ASSIGN  23959>>ASSIGN
     23967<>CALL    23977<<ASSIGN  23977>>ASSIGN  23983>>ASSIGN  25672>>ASSIGN  25676<>CALL    25743>>CALL
     25744<<ASSIGN  25744>>ASSIGN  25747<>CALL    25751>>ASSIGN  25780>>CALL    25781<<ASSIGN  25781>>ASSIGN
NHANDLERS
     21959**DCL     23576<<ASSIGN  23579<<ASSIGN  23579>>ASSIGN  23581>>ASSIGN  23584>>IF      23585>>ASSIGN
     23589<>CALL    23758>>CALL    23759<>CALL    23760>>ASSIGN  23761>>ASSIGN  23762>>CALL
NHNDLRS_DFR
     21960**DCL     23581<<ASSIGN
NLIBS
     21977**DCL     23649<<ASSIGN  23879>>DOINDEX 23897>>ASSIGN  23898>>ASSIGN  23899>>ASSIGN  23900>>ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:252  
     23901>>ASSIGN  23902<<ASSIGN  23902>>ASSIGN
NODE# IN PROCEDURE CONV_NODENAME
     24107**DCL     24103--PROC    24126<<ASSIGN
NODENAME IN PROCEDURE CONV_NODENAME
     24106**DCL     24103--PROC    24120>>IF
NODETYPE
     20527**DCL     23617<>CALL
NODETYPE IN PROCEDURE CONV_NODENAME
     24108**DCL     24103--PROC    24122<<ASSIGN  24123>>IF
NOHEADER IN PROCEDURE CONFIG_LINK
     25659**DCL     25691<>CALL
NOSETUP IN PROCEDURE CONFIG_LINK
     25658**DCL     25691<>CALL
NO_CONTROL
     23956**LABEL   23949--CALLALT
NO_PSEUDOS
     23977**LABEL   23966--CALLALT
NSUBS IN PROCEDURE CONFIG_LINK
     25652**DCL     25716<<ASSIGN  25746>>DOINDEX
NUMSECTS
     21931**DCL     23637>>ASSIGN  24333<<ASSIGN  24334>>ASSIGN  24334>>ASSIGN  24336<>CALL    24341>>DOINDEX
OFFSET
     21937**DCL     23807<<ASSIGN  23831>>ASSIGN
OFFSET IN PROCEDURE READ_RU
     24283**DCL     24349<<ASSIGN  24351<>CALL
OFFSET$
     21962**DCL     21992--IMP-PTR 23575<<ASSIGN  23586<>CALL    23587>>ASSIGN  23588>>ASSIGN  23590>>ASSIGN
     23597>>ASSIGN  23598>>ASSIGN  23632>>ASSIGN  23641>>ASSIGN  23644>>ASSIGN  23674>>ASSIGN  23927>>ASSIGN
     23929>>CALL    23943>>ASSIGN  23945>>CALL    23956>>ASSIGN  23960>>ASSIGN  23962>>CALL    23968>>ASSIGN
OFFSET_SIZE
     21956**DCL     23583<<ASSIGN  23585<<ASSIGN  23585>>ASSIGN  23586<>CALL    23587>>ASSIGN
ONEPAGE IN PROCEDURE READ_RU
     24166**DCL     24323--ASSIGN  24327--ASSIGN  24334--ASSIGN  24359--CALL    24360--ASSIGN  24363--ASSIGN
     24364--ASSIGN  24386--ASSIGN  24387--ASSIGN  24391--ASSIGN
ONEWORD
     21990**DCL     23566<>CALL    23589<>CALL    23591<>CALL    23633<>CALL    23642<>CALL    23645<>CALL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:253  
     23675<>CALL    23677<>CALL    23679<>CALL    23681<>CALL    23759<>CALL    23762<>CALL    23774<>CALL
     23857<>CALL    23868<>CALL    24336<>CALL    24348<>CALL    24351<>CALL    24354<>CALL
OPEN_GOODIES
     20803**DCL     23521<>CALL    23529<>CALL    23537<>CALL
OPEN_GOODIES.ACSVEH_
     20805**DCL     20806--REDEF
OPEN_GOODIES.ALTKEYS_
     20811**DCL     20812--REDEF   20812--REDEF
OPEN_GOODIES.HDR_
     20810**DCL     20811--REDEF
OPEN_GOODIES.NAME_
     20804**DCL     23520<<ASSIGN  23528<<ASSIGN  23536<<ASSIGN
OPEN_GOODIES.TAB_
     20809**DCL     20810--REDEF
OPEN_GOODIES.UHL_
     20803**DCL     20804--REDEF   20804--REDEF
OPEN_GOODIES.V
     20812**DCL     20803--DCLINIT
OPEN_GOODIES.V.DCB#
     20812**DCL     23519<<ASSIGN  23527<<ASSIGN  23535<<ASSIGN
OPEN_GOODIES.V.FSN#
     20843**DCL     20843--REDEF   20843--REDEF
OPEN_GOODIES.WSN_
     20809**DCL     20809--REDEF
OUT$
     21934**DCL     23804<<ASSIGN  23807>>ASSIGN  23840>>CALL    23844<<ASSIGN  23844>>ASSIGN
OUT$ IN PROCEDURE GETPRO
     25797**DCL     25792--PROC    25814--IMP-PTR 25953>>ASSIGN
P$
     21925**DCL     23565<<ASSIGN  23566>>CALL    23588<<ASSIGN  23589>>CALL    23590<<ASSIGN  23591>>CALL
     23632<<ASSIGN  23633>>CALL    23641<<ASSIGN  23642>>CALL    23644<<ASSIGN  23645>>CALL    23674<<ASSIGN
     23675>>CALL    23676<<ASSIGN  23677>>CALL    23678<<ASSIGN  23679>>CALL    23680<<ASSIGN  23681>>CALL
     23853<<ASSIGN  23854>>ASSIGN  23856>>ASSIGN  23867>>ASSIGN  23868>>CALL    24335<<ASSIGN  24336>>CALL
     24346<<ASSIGN  24348>>CALL    24350<<ASSIGN  24351>>CALL    24352<<ASSIGN  24354>>CALL
PAGES IN PROCEDURE READ_RU
     24167**DCL     24307<<ASSIGN  24308<>CALL    24372<<ASSIGN  24373<>CALL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:254  
PARAM$
     21927**DCL     22163--IMP-PTR 22213--IMP-PTR 23740<<ASSIGN  23741>>ASSIGN  23758<>CALL    23759>>CALL
     23760<<ASSIGN  23760>>ASSIGN  23774>>CALL    23776>>ASSIGN  23777>>ASSIGN  23778>>ASSIGN  23783>>ASSIGN
     23784>>ASSIGN  23785>>ASSIGN  23789>>ASSIGN  23795>>CALL    23802>>ASSIGN  23807>>ASSIGN  23850<<ASSIGN
     23850>>ASSIGN  23926<<ASSIGN  23928>>ASSIGN  23930<>CALL    23938>>CALL
PARAMOFFSET
     21950**DCL     23741<<ASSIGN  23742<>CALL    23928<<ASSIGN  23929<>CALL    23944<<ASSIGN  23945<>CALL
     23961<<ASSIGN  23962<>CALL
PMMEERR
     24419**PROC    24019--CALL    24042--CALL    24064--CALL    24085--CALL    24092--CALL    24096--CALL
     24415--CALL
POINTER IN PROCEDURE ALIGNPTR
     24522**DCL     24518--PROC
POINTER.BA IN PROCEDURE ALIGNPTR
     24525**DCL     24528>>IF      24531<<ASSIGN
POINTER.CA IN PROCEDURE ALIGNPTR
     24524**DCL     24528>>IF      24530<<ASSIGN
POINTER.WA IN PROCEDURE ALIGNPTR
     24523**DCL     24529<<ASSIGN  24529>>ASSIGN
PRO IN PROCEDURE GETPRO
     25794**DCL     25792--PROC    25948--ASSIGN
PRO.L IN PROCEDURE GETPRO
     25795**DCL     25943>>IF
PRO$ IN PROCEDURE GETPRO
     25896**DCL     25898--IMP-PTR 25913--IMP-PTR 25953<<ASSIGN  25956>>ASSIGN
PROBASE IN PROCEDURE GETPRO
     25898**DCL     25956<<ASSIGN  25956>>ASSIGN
PROCOFFSET
     21947**DCL     23679<>CALL    23874<<ASSIGN  23881<<ASSIGN  23898>>ASSIGN  23906>>ASSIGN  24311<<ASSIGN
     24375<<ASSIGN
PROFILE$ IN PROCEDURE CONFIG_LINK
     25642**DCL     25674<<ASSIGN  25726>>ASSIGN  25727<>CALL    25733<<ASSIGN  25733>>ASSIGN  25734<>CALL
     25753<<ASSIGN  25772<>CALL    25776>>ASSIGN
PROLEN IN PROCEDURE CONFIG_LINK
     25657**DCL     25727<>CALL    25728<<ASSIGN  25732>>ASSIGN  25733>>ASSIGN  25734<>CALL    25735<<ASSIGN
     25738>>ASSIGN  25772<>CALL    25777>>ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:255  
PROLEN IN PROCEDURE GETPRO
     25798**DCL     25792--PROC    25944<<ASSIGN  25955<<ASSIGN
PRONAME
     21365**DCL     23528--ASSIGN
PRONAME IN PROCEDURE CONFIG_LINK
     25648**DCL     25691<>CALL
PROREC IN PROCEDURE GETPRO
     25899**DCL     25949--ASSIGN  25956--ASSIGN
PROSIZE IN PROCEDURE GETPRO
     25897**DCL     25898--IMP-SIZ 25954<<ASSIGN  25955>>ASSIGN  25956>>ASSIGN  25956>>ASSIGN
PSEUDO$
     21951**DCL     22169--IMP-PTR 23959<<ASSIGN  23961>>ASSIGN  23970>>ASSIGN  23971>>CALL    23972>>CALL
     23973>>CALL    23974>>CALL    23975>>CALL
PW IN PROCEDURE CONFIG_LINK
     25647**DCL     25691<>CALL
READ_HLP
     20992**DCL     25698<>CALL
READ_HLP.BUF_
     20994**DCL     25697<<ASSIGN
READ_HLP.KEY_
     20992**DCL     25696<<ASSIGN
READ_HLP.STATION_
     20995**DCL     20996--REDEF
READ_HLP.V
     20996**DCL     20992--DCLINIT
READ_HLP.V.DVBYTE.REREAD#
     21007**DCL     21007--REDEF
READ_HLP.V.INDX#
     21005**DCL     21005--REDEF
READ_NETCON
     20910**DCL     23560<>CALL    23572<>CALL    23601<>CALL    23661<>CALL    23779<>CALL    23949<>CALL
     23966<>CALL    24001<>CALL    24063<>CALL    24076<>CALL    24114<>CALL    25666<>CALL    25686<>CALL
     25762<>CALL
READ_NETCON.BUF_
     20912**DCL     23559<<ASSIGN  23571<<ASSIGN  23600<<ASSIGN  23660<<ASSIGN  23763<<ASSIGN  23948<<ASSIGN
     23965<<ASSIGN  23999<<ASSIGN  24062<<ASSIGN  24075<<ASSIGN  24112<<ASSIGN  25665<<ASSIGN  25685<<ASSIGN
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:256  
     25761<<ASSIGN
READ_NETCON.KEY_
     20910**DCL     23558<<ASSIGN  23570<<ASSIGN  23599<<ASSIGN  23659<<ASSIGN  23764<<ASSIGN  23947<<ASSIGN
     23964<<ASSIGN  24000<<ASSIGN  24061<<ASSIGN  24074<<ASSIGN  24113<<ASSIGN  25664<<ASSIGN  25684<<ASSIGN
     25760<<ASSIGN
READ_NETCON.STATION_
     20913**DCL     20914--REDEF
READ_NETCON.V
     20914**DCL     20910--DCLINIT
READ_NETCON.V.DVBYTE.REREAD#
     20925**DCL     20925--REDEF
READ_NETCON.V.INDX#
     20923**DCL     20923--REDEF
READ_PRO
     20951**DCL     25950<>CALL
READ_PRO.BUF_
     20953**DCL     25949<<ASSIGN
READ_PRO.KEY_
     20951**DCL     25948<<ASSIGN
READ_PRO.STATION_
     20954**DCL     20955--REDEF
READ_PRO.V
     20955**DCL     20951--DCLINIT
READ_PRO.V.DVBYTE.REREAD#
     20966**DCL     20966--REDEF
READ_PRO.V.INDX#
     20964**DCL     20964--REDEF
READ_RU
     24162**PROC    23564--CALL    23671--CALL    23892--CALL
RET_ERROR
     21691**DCL     23855<>CALL    24027>>ASSIGN  24431--DCLINIT 24469<<ASSIGN
RET_ERROR_
     20541**DCL         8--PROC    23507--IF      24026--IF      24027<<ASSIGN
ROK
     21968**DCL     24298<<ASSIGN  24301>>ASSIGN  24307>>ASSIGN  24310>>ASSIGN
ROSOFFSET
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:257  
     21948**DCL     23681<>CALL    24309<<ASSIGN  24310>>ASSIGN
RSLT IN PROCEDURE PMMEERR
     24466**DCL     24461--DCLINIT
RUKEY IN PROCEDURE READ_RU
     24243**DCL     24220--DCLINIT 24221--DCLINIT 24317--ASSIGN  24338--ASSIGN  24381--ASSIGN
RUKEY.NODE IN PROCEDURE READ_RU
     24248**DCL     24290<<ASSIGN
RUKEY.PAGE IN PROCEDURE READ_RU
     24250**DCL     24252--REDEF   24297<<ASSIGN  24304>>ASSIGN  24312<<ASSIGN  24342<<ASSIGN  24376<<ASSIGN
RUKEY.TYPE IN PROCEDURE READ_RU
     24246**DCL     24289<<ASSIGN  24319>>DOWHILE 24383>>DOWHILE
SAVEX
     21970**DCL     23502<>CALL    23986>>ASSIGN  23987>>IF      24010>>ASSIGN  24020>>ASSIGN  24024>>ASSIGN
     24137<>CALL    24138>>IF      24139>>CALL    24139>>CALL    24140>>ASSIGN  24143>>ASSIGN  24146>>ASSIGN
     24153<>CALL    24154>>ASSIGN  24559<>CALL
SAVE_INFO.DATASEG
     20632**DCL     23986<<ASSIGN  24010<<ASSIGN  24024<<ASSIGN  24139<>CALL    24143>>ASSIGN  24568<<ASSIGN
SAVE_INFO.DFNAME
     20633**DCL     24139<>CALL    24154<<ASSIGN
SAVE_INFO.DFNAME.L
     20634**DCL     23987>>IF      24138>>IF      24140<<ASSIGN  24567<<ASSIGN
SAVE_INFO.FEX
     20631**DCL     24020<<ASSIGN  24146<<ASSIGN  24544>>IF      24565>>IF      24566<<ASSIGN
SAVX IN PROCEDURE FIND_SAVEX
     24540**DCL     24537--PROC    24545<<ASSIGN
SAVX IN PROCEDURE GET_SAVEX
     24556**DCL     24553--PROC    24569<<ASSIGN
SCRUB_TERMID IN PROCEDURE CONFIG_LINK
     25961**PROC    25682--CALL    25757--CALL
SECT$
     21929**DCL     22176--IMP-PTR 23636<<ASSIGN  23638<>CALL    23639>>ASSIGN  23643>>ASSIGN  23646>>ASSIGN
SECT$ IN PROCEDURE READ_RU
     24282**DCL     24337<<ASSIGN  24349>>ASSIGN  24357>>ASSIGN  24366<<ASSIGN  24366>>ASSIGN  24368>>ASSIGN
SECTKEY IN PROCEDURE READ_RU
     24274**DCL     24330--ASSIGN
SECTSIZE
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:258  
     21930**DCL     23637<<ASSIGN  23639>>ASSIGN  23640<<ASSIGN  23640>>ASSIGN  23642<>CALL
SETFP$
     21926**DCL     22024--IMP-PTR 23667<<ASSIGN  23668>>ASSIGN  23669<>CALL    23670>>ASSIGN  23673>>ASSIGN
     23676>>ASSIGN  23678>>ASSIGN  23680>>ASSIGN  23682>>ASSIGN  23683>>ASSIGN  23684>>ASSIGN  23685>>ASSIGN
     23686>>ASSIGN  23687>>ASSIGN  23689>>ASSIGN  23690>>CALL    23691>>ASSIGN  23692>>ASSIGN  23693>>ASSIGN
     23694>>ASSIGN  23695>>ASSIGN  23696>>ASSIGN  23697>>ASSIGN  23700>>CALL    23704>>CALL    23708>>CALL
     23712>>CALL    23716>>CALL    23720>>CALL    23724>>CALL    23728>>CALL    23732>>CALL    23736>>CALL
     23742>>CALL    23870>>CALL    23897>>ASSIGN  23907>>CALL    23911>>CALL    23915>>CALL    23919>>CALL
SIZE IN PROCEDURE GETSEG
     24401**DCL     24399--PROC    24405>>ASSIGN
SIZE IN PROCEDURE READ_RU
     24285**DCL     24347<<ASSIGN  24348<>CALL
SIZE IN PROCEDURE STORVAL
     24508**DCL     24502--PROC    24511>>DOINDEX
SKP_HNDLR
     21957**DCL     23767<<ASSIGN  23771<<ASSIGN  23771>>ASSIGN  23774>>CALL
SKP_HNDLR2
     21958**DCL     23651<<ASSIGN  23655<<ASSIGN  23655>>ASSIGN  23674>>ASSIGN
START IN PROCEDURE READ_RU
     24284**DCL     24353<<ASSIGN  24354<>CALL
START$ IN PROCEDURE GETSEG
     24400**DCL     24399--PROC    24405>>ASSIGN
START_HNDLRS
     24069**LABEL   24071--EXIT
STORVAL
     24502**PROC    23566--CALL    23589--CALL    23591--CALL    23633--CALL    23642--CALL    23645--CALL
     23675--CALL    23677--CALL    23679--CALL    23681--CALL    23690--CALL    23742--CALL    23759--CALL
     23762--CALL    23774--CALL    23870--CALL    23929--CALL    23938--CALL    23945--CALL    23953--CALL
     23962--CALL    23971--CALL    23972--CALL    23973--CALL    23974--CALL    23975--CALL    24336--CALL
     24348--CALL    24351--CALL    24354--CALL
SUBX IN PROCEDURE CONFIG_LINK
     25653**DCL     25746<<DOINDEX
SVNEXT$
     21965**DCL     23743<<ASSIGN  23762>>CALL    23762>>CALL    23774>>CALL    23774>>CALL    23870>>CALL
SYSACCT
     21378**DCL     20808--DCLINIT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:259  
TBLOFFSET
     21945**DCL     23643<<ASSIGN  23645<>CALL    23668<<ASSIGN  23675<>CALL
TEMP
     21969**DCL     23699<<ASSIGN  23700<>CALL    23703<<ASSIGN  23704<>CALL    23707<<ASSIGN  23708<>CALL
     23711<<ASSIGN  23712<>CALL    23715<<ASSIGN  23716<>CALL    23719<<ASSIGN  23720<>CALL    23723<<ASSIGN
     23724<>CALL    23727<<ASSIGN  23728<>CALL    23731<<ASSIGN  23732<>CALL    23735<<ASSIGN  23736<>CALL
     23794<<ASSIGN  23795<>CALL    23816<<ASSIGN  23817<>CALL    23824<<ASSIGN  23825<>CALL    23831<<ASSIGN
     23832<>CALL    23839<<ASSIGN  23840<>CALL    23867<<ASSIGN  23868<>CALL    23906<<ASSIGN  23907<>CALL
     23910<<ASSIGN  23911<>CALL    23914<<ASSIGN  23915<>CALL    23918<<ASSIGN  23919<>CALL
TEMP IN PROCEDURE CONFIG_LINK
     25655**DCL     25708<<ASSIGN  25709<>CALL    25710<<ASSIGN  25711<>CALL    25712<<ASSIGN  25713<>CALL
     25714<<ASSIGN  25715<>CALL    25732<<ASSIGN  25738<<ASSIGN  25738>>ASSIGN  25739<>CALL    25742<<ASSIGN
     25742>>ASSIGN  25743<>CALL    25744>>ASSIGN  25777<<ASSIGN  25778<>CALL    25779<<ASSIGN  25779>>ASSIGN
     25780<>CALL    25781>>ASSIGN
TEMP_SECTION
     22173**DCL     23646>>ASSIGN
TEMP_SECTION.NUMSECTS
     22173**DCL     24335--ASSIGN
TEMP_SECTION.SECT.OFFSET
     22173**DCL     24350--ASSIGN
TEMP_SECTION.SECT.SIZE
     22173**DCL     24346--ASSIGN
TEMP_SECTION.SECT.START
     22173**DCL     24352--ASSIGN
TERMID IN PROCEDURE SCRUB_TERMID
     25977**DCL     25961--PROC    25994<<ASSIGN
TERMID.LEV IN PROCEDURE SCRUB_TERMID
     25981**DCL     25995<<ASSIGN
TERMID.TERM IN PROCEDURE SCRUB_TERMID
     25981**DCL     25990--REDEF
TERMID.TERM.TERM_NAME IN PROCEDURE SCRUB_TERMID
     25990**DCL     25996<<ASSIGN
TYPE IN PROCEDURE READ_RU
     24164**DCL     24162--PROC    24295>>DOCASE
UNAME IN PROCEDURE CONFIG_LINK
     25644**DCL     25691<>CALL
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:260  
UNAME.C IN PROCEDURE CONFIG_LINK
     25646**DCL     25694>>ASSIGN
UNAME.L IN PROCEDURE CONFIG_LINK
     25645**DCL     25695>>ASSIGN
VDK
     21966**DCL     24305<<ASSIGN  24307>>ASSIGN  24311>>ASSIGN  24371<<ASSIGN  24372>>ASSIGN  24375>>ASSIGN
VDPGS IN PROCEDURE READ_RU
     24286**DCL     24304<<ASSIGN  24305>>ASSIGN
VLP_ACCT
     21252**DCL     21086--DCLINIT 21184--DCLINIT
VLP_ACCT.ACCT#
     21252**DCL     23683>>ASSIGN  23688>>IF      23890<<ASSIGN  24080>>ASSIGN  24083>>ASSIGN
VLP_FPRG
     21555**DCL     21468--DCLINIT
VLP_FPRG.ACCT#
     21561**DCL     24080<<ASSIGN
VLP_FPRG.NAME
     21560**DCL     24079<<ASSIGN
VLP_FPRG.PASS#
     21562**DCL     24081<<ASSIGN
VLP_NAME
     21239**DCL     21082--DCLINIT 21184--DCLINIT 24079>>ASSIGN
VLP_NAME.L#
     21239**DCL     23685>>ASSIGN
VLP_NAME.NAME#
     21239**DCL     24082>>ASSIGN
VLP_PASS
     21265**DCL     21083--DCLINIT 21185--DCLINIT
VLP_PASS.PASS#
     21265**DCL     23682>>ASSIGN  24081>>ASSIGN
VLP_SN
     21278**DCL     21081--DCLINIT 21185--DCLINIT
VLP_SN.SN#
     21278**DCL     23684>>ASSIGN
VLR_FID
     21206**DCL     21187--DCLINIT
PL6.E3A0      #001=KFF$FEBOOT File=KFF$FEBOOT.:E05TSI                            WED 07/30/97 00:21 Page:261  
VLR_MONINFO
     20677**DCL     20662--DCLINIT
VLR_MONINFO.NODE#
     20680**DCL     23606>>ASSIGN  23613>>ASSIGN  23620>>ASSIGN  23628>>ASSIGN
VLR_MONINFO.NUM_NODES
     20681**DCL     23932>>ASSIGN
VLR_NODEINFO
     20724**DCL     20712--DCLINIT
VLR_NODEINFO.ACTIVE#
     20725**DCL     24044>>IF
VLR_NODEINFO.NODENAME#
     20724**DCL     23592<<ASSIGN  23597>>ASSIGN
VLR_SITEINFO
     20695**DCL     20662--DCLINIT
VLR_SITEINFO.CPU_TYPE#
     20699**DCL     23933>>IF
VPK
     21967**DCL     24306<<ASSIGN  24307>>ASSIGN  24370<<ASSIGN  24372>>ASSIGN
WDSUSED
     21961**DCL     23566<>CALL    23575>>ASSIGN  23672>>ASSIGN  23896>>ASSIGN  24029>>ASSIGN  24288<<ASSIGN
     24327<<ASSIGN  24368<<ASSIGN  24391<<ASSIGN
WDSUSED_
     20574**DCL         8--PROC    23983<<ASSIGN  24028--IF      24029<<ASSIGN
WE_PRINT_ERRORS
     21974**DCL     23508<<ASSIGN  23510<<ASSIGN  24470>>IF

PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:262  
     1413        1        /*T***********************************************************/
     1414        2        /*T*                                                         */
     1415        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1416        4        /*T*                                                         */
     1417        5        /*T***********************************************************/
     1418        6        /*F*    NAME:  KFF$9TO8
     1419        7                CALL:  CALL KFF$9TO8(SOURCE,DEST,SIZE);
     1420        8                PURPOSE:  Unpacks a SBIN WORD into a byte string with a zero
     1421        9                high order bit in each byte.
     1422       10                                                                           */
     1423       11
     1424       12        KFF$9TO8: PROC(SOURCE,DEST,SIZE);
     1425       13
     1426       14    1   DCL SOURCE SBIN WORD;
     1427       15    1   DCL DEST(0:0) SBIN BYTE CALIGNED;
     1428       16    1   DCL SIZE SBIN WORD;
     1429       17
     1430       18    1   DCL T1 SBIN WORD;
     1431       19    1   DCL T2 SBIN WORD;
     1432       20
     1433       21    1   DCL I SBIN;
     1434       22    1           T1=SOURCE;
     1435       23    2           DO I=SIZE-1 DOWNTO 0;
     1436       24    2              T2=MOD(T1,256);
     1437       25    2              T1=T1/256;
     1438       26    2              DEST(I)=T2;
     1439       27    2              END;
     1440       28    1           RETURN;
     1441       29
     1442       30    1   END KFF$9TO8;

PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:263  
      No diagnostics issued in procedure KFF$9TO8.

   Procedure KFF$9TO8 requires 26 words for executable code.
   Procedure KFF$9TO8 requires 10 words of local(AUTO) storage.

    No errors detected in file KFF$FEBOOT.:E05TSI    .

PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:264  

 Object Unit name= KFF$9TO8                                   File name= KFF$FEBOOT.:E05TOU
 UTS= JUL 30 '97 00:23:56.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Proc  even  none    26     32  KFF$9TO8

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        3  KFF$9TO8

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
                       nStd      0 X66_AUTO_3
                       nStd      0 X66_ARET
PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:265  


     1413        1        /*T***********************************************************/
     1414        2        /*T*                                                         */
     1415        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
     1416        4        /*T*                                                         */
     1417        5        /*T***********************************************************/
     1418        6        /*F*    NAME:  KFF$9TO8
     1419        7                CALL:  CALL KFF$9TO8(SOURCE,DEST,SIZE);
     1420        8                PURPOSE:  Unpacks a SBIN WORD into a byte string with a zero
     1421        9                high order bit in each byte.
     1422       10                                                                           */
     1423       11
     1424       12        KFF$9TO8: PROC(SOURCE,DEST,SIZE);

     12  0 000000   000000 700200 xent  KFF$9TO8     TSX0  ! X66_AUTO_3
         0 000001   000012 000003                    ZERO    10,3

     1425       13
     1426       14    1   DCL SOURCE SBIN WORD;
     1427       15    1   DCL DEST(0:0) SBIN BYTE CALIGNED;
     1428       16    1   DCL SIZE SBIN WORD;
     1429       17
     1430       18    1   DCL T1 SBIN WORD;
     1431       19    1   DCL T2 SBIN WORD;
     1432       20
     1433       21    1   DCL I SBIN;
     1434       22    1           T1=SOURCE;

     22  0 000002   200003 470500                    LDP0    @SOURCE,,AUTO
         0 000003   000000 235100                    LDA     0,,PR0
         0 000004   200006 755100                    STA     T1,,AUTO

     1435       23    2           DO I=SIZE-1 DOWNTO 0;

     23  0 000005   200005 471500                    LDP1    @SIZE,,AUTO
         0 000006   100000 235100                    LDA     0,,PR1
         0 000007   000001 135007                    SBLA    1,DL
PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:266  
         0 000010   200010 755100                    STA     I,,AUTO
         0 000011   000027 710000 0                  TRA     s:27+2

     1436       24    2              T2=MOD(T1,256);

     24  0 000012   200006 236100                    LDQ     T1,,AUTO
         0 000013   000400 506007                    DIV     256,DL
         0 000014   200007 755100                    STA     T2,,AUTO

     1437       25    2              T1=T1/256;

     25  0 000015   200006 236100                    LDQ     T1,,AUTO
         0 000016   000400 506007                    DIV     256,DL
         0 000017   200006 756100                    STQ     T1,,AUTO

     1438       26    2              DEST(I)=T2;

     26  0 000020   200004 470500                    LDP0    @DEST,,AUTO
         0 000021   200010 235100                    LDA     I,,AUTO
         0 000022   000105 101500                    MRL     fill='000'O
         0 000023   200007 000004                    ADSC9   T2,,AUTO                 cn=0,n=4
         0 000024   000000 000001                    ADSC9   0,A,PR0                  cn=0,n=1

     1439       27    2              END;

     27  0 000025   000001 336007                    LCQ     1,DL
         0 000026   200010 056100                    ASQ     I,,AUTO
         0 000027   200010 235100                    LDA     I,,AUTO
         0 000030   000012 605000 0                  TPL     s:24

     1440       28    1           RETURN;

     28  0 000031   000000 702200 xent               TSX2  ! X66_ARET
     1441       29
     1442       30    1   END KFF$9TO8;

PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:267  
      No diagnostics issued in procedure KFF$9TO8.
PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:268  

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @DEST                      5-0-0/w PTR         r     1 @SIZE
     3-0-0/w PTR         r     1 @SOURCE                   *0-0-0/c SBIN(9)     r     1 DEST(0:0)
    10-0-0/w SBIN        r     1 I                         *0-0-0/w SBIN        r     1 SIZE
    *0-0-0/w SBIN        r     1 SOURCE                     6-0-0/w SBIN        r     1 T1
     7-0-0/w SBIN        r     1 T2


   Procedure KFF$9TO8 requires 26 words for executable code.
   Procedure KFF$9TO8 requires 10 words of local(AUTO) storage.

    No errors detected in file KFF$FEBOOT.:E05TSI    .
PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:269  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KFF$9TO8 File=KFF$FEBOOT.:E05TSI                              WED 07/30/97 00:23 Page:270  
          MINI XREF LISTING

DEST
        15**DCL        12--PROC       26<<ASSIGN
I
        21**DCL        23<<DOINDEX    26>>ASSIGN
SIZE
        16**DCL        12--PROC       23>>DOINDEX
SOURCE
        14**DCL        12--PROC       22>>ASSIGN
T1
        18**DCL        22<<ASSIGN     24>>ASSIGN     25<<ASSIGN     25>>ASSIGN
T2
        19**DCL        24<<ASSIGN     26>>ASSIGN
