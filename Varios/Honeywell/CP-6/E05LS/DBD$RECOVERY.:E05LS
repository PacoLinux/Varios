VERSION E05

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:1    
        1        1        /*M* DBD$RECOVERY - Display recovery buffer for FEP ANLZ */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8
        9        9        DBD$RECOVERY: PROC;
       10       10
       11       11        %INCLUDE DA_ANLZ_R;
       12       24        %INCLUDE DA_MAP_R;
       13       54        %INCLUDE DA_FORMAT_C;
       14      296        %INCLUDE DA_FORMAT_R;
       15      308        %INCLUDE DBD_FEP_E;
       16      319        %INCLUDE CP_6;
       17     5878        %INCLUDE DB_PERR_C;
       18     5896        %INCLUDE IR_DATA_M;
       19     6060        %INCLUDE GH_SCHD_M;
       20     6204        %INCLUDE GM_VIRTUAL_E;
       21     6414        %INCLUDE G_HJIT_M;
       22     6559
       23     6560        %GI_RCVR_EQU;
       24     6572
       25     6573    1   DCL DAF$INIT ENTRY(1) ALTRET;
       26     6574    1   DCL DAF$WRITE EPTR SYMREF;
       27     6575    1   DCL DAF$UPDLNCNT ENTRY;
       28     6576    1   DCL DBB$TSA ENTRY(1);
       29     6577    1   DCL DBD$INTCON_ACTIVE ENTRY;
       30     6578    1   DCL DBD$SPY_RCV ENTRY;
       31     6579    1   DCL DBM$PACK ENTRY(3);
       32     6580    1   DCL DBM$PACKB ENTRY(2);
       33     6581    1   DCL DBM$PACK1 ENTRY(2);
       34     6582    1   DCL DBM$PACK2 ENTRY(2);
       35     6583    1   DCL DBM$PACK4 ENTRY(2);
       36     6584    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       37     6585    1   DCL DBM$SETSYMBOLS ENTRY(1);
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:2    
       38     6586    1   DCL DBM$SETLIB_SYM ENTRY(1);
       39     6587    1   DCL DBM$READ_PAGE ENTRY(1) ALTRET;
       40     6588    1   DCL XUR$ERRCNVRT ENTRY(2);
       41     6589
       42     6590    1   DCL DB_CURRENT_USER UBIN SYMREF;
       43     6591    1   DCL 1 DB_MONASDT(0:30) SYMREF,
       44     6592    1         2 V BIT(1),
       45     6593    1         2 BASE UBIN(15) UNAL,
       46     6594    1         2 * BIT(6),
       47     6595    1         2 * BIT(1),
       48     6596    1         2 SIZE UBIN(9) UNAL;
       49     6597
       50     6598        %FPT_ERRMSG (CODE=SCODE,SUBMESS=YES,INCLCODE=YES,RESULTS=VLR_ERRMSG,
       51     6599                     ALTCODE=SCODEM,FILENAME=SCRMSG,FILEACCT=SYSACCT);
       52     6626        %VLP_NAME (FPTN=SCRMSG,NAME=':SCRMSG');
       53     6653        %VLP_ACCT (FPTN=SYSACCT,ACCT=':SYS');
       54     6666        %VLR_ERRMSG;
       55     6688        %VLP_ERRCODE (FPTN=SCODE);
       56     6733        %VLP_ERRCODE (FPTN=SCODEM);
       57     6778    1   DCL ERRBUF CHAR(120);
       58     6779
       59     6780        %FPT_TIME (SOURCE=FUTS, DEST=UTS);
       60     6799
       61     6800        %REPORT (NAME=REPORT,TITLE='FEP Recovery Information');
       62     6866
       63     6867
       64     6868    1   DCL PPUTBAD CHAR(0) CONSTANT INIT('%/PPUT inconsistent.  Index = %D');
       65     6869
       66     6870    1   DCL TIME_FMT CHAR(0) CONSTANT INIT(
       67     6871    1   'Boot time: %11..3.2U  Curr time: %11..3.2U');
       68     6872
       69     6873    1   DCL USER_FMT CHAR(0) CONSTANT INIT(
       70     6874    1   '%/Current scheduled user: .%H   Currently mapped user: .%H');
       71     6875
       72     6876    1   DCL INTERVAL_FMT CHAR(0) CONSTANT INIT(
       73     6877    1   '%/MHJIT Interval Type: %>A  HJIT Domain %>A');
       74     6878
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:3    
       75     6879    1   DCL TSA_FMT CHAR(0) CONSTANT INIT(
       76     6880    1   'TSA @ .%H for user .%H  using ASDT at .%H:');
       77     6881
       78     6882        %G_INTRVL_TXT;
       79     6898
       80     6899    1   DCL DMN_WHO(0:7) CHAR(24) CONSTANT INIT(
       81     6900    1      '0 - Monitor Service',
       82     6901    1      '1 - Debugger Service',
       83     6902    1      '2 - Int Level Service',
       84     6903    1      '3 - User Service',
       85     6904    1      '4 - Monitor Execution',
       86     6905    1      '5 - Debugger Execution',
       87     6906    1      '6 - Int Level Execution',
       88     6907    1      '7 - User Execution');
       89     6908
       90     6909    1   DCL RVBUF$ UBIN CONSTANT INIT(%(GM_LOW_MEM_BASE+GI_RVBUF_LOC));
       91     6910    1   DCL LIB_START UBIN CONSTANT INIT(%GM_ISR6_BASE);
       92     6911
       93     6912    1   DCL DMN$ UBIN CONSTANT INIT(%(GM_UHJIT_BASE+G_UHJIT_DMN#));
       94     6913    1   DCL MON_TSA$ UBIN CONSTANT INIT(%(GM_UHJIT_BASE+G_UHJIT_TSA_DB#));
       95     6914    1   DCL MHJIT_CUN$ UBIN CONSTANT INIT(%(GM_MHJIT_BASE+G_MHJIT_CUN#));
       96     6915
       97     6916        %RV_FEP_BUFF (FPTN=RVBUF,STCLASS=AUTO);
       98     6949    1   DCL 1 FLAGS ALIGNED,
       99     6950    1         2 BADPPUT BIT(1);
      100     6951
      101     6952    1   DCL I SBIN;
      102     6953    1   DCL ASDT UBIN;
      103     6954    1   DCL WHO CHAR(24);
      104     6955    1   DCL INTV_TYPE CHAR(20);
      105     6956    1   DCL DMN UBIN;
      106     6957    1   DCL DMN_BUF UBIN;
      107     6958    1   DCL SYSID SBIN;
      108     6959    1   DCL CUN UBIN;
      109     6960    1   DCL TSA$ UBIN;
      110     6961    1   DCL P$ UBIN;
      111     6962
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:4    
      112     6963    1   DCL 1 TSABUF CALIGNED,
      113     6964    1         2 TSAL$ PTR CALIGNED,
      114     6965    1         2 IREG UBIN HALF CALIGNED,
      115     6966    1         2 R3 UBIN HALF CALIGNED,
      116     6967    1         2 INST UBIN HALF CALIGNED,
      117     6968    1         2 ZREG UBIN HALF CALIGNED,
      118     6969    1         2 A$ PTR CALIGNED,
      119     6970    1         2 P EPTR CALIGNED,
      120     6971    1         2 B3$ PTR CALIGNED,
      121     6972    1         2 SREG UBIN HALF CALIGNED,
      122     6973    1         2 ISA,
      123     6974    1           3 ASV$ PTR CALIGNED,
      124     6975    1           3 * UBIN HALF CALIGNED,
      125     6976    1           3 TSAP$ PTR CALIGNED,
      126     6977    1           3 CHN UBIN HALF CALIGNED,
      127     6978    1           3 ISM1 UBIN HALF CALIGNED,
      128     6979    1           3 ISM2 UBIN HALF CALIGNED,
      129     6980    1           3 P$ EPTR CALIGNED,
      130     6981    1           3 S UBIN HALF CALIGNED,
      131     6982    1           3 BREGS(0:6) PTR CALIGNED,
      132     6983    1           3 I UBIN HALF CALIGNED,
      133     6984    1           3 RREGS(0:6) UBIN HALF CALIGNED,
      134     6985    1           3 *(0:12) UBIN HALF CALIGNED;
      135     6986
      136     6987
      137     6988        %G$MHJIT_CPU (FPTN=CPU_INFO,STCLASS=AUTO);
      138     7012
      139     7013    1   DCL INTERVAL_TYPE UBIN;
      140     7014    1   DCL BOOTUTS UBIN;
      141     7015    1   DCL CURRUTS UBIN;
      142     7016    1   DCL TICKS UBIN;
      143     7017
      144     7018    1   DCL DUMPMAP(0:%(GI_BITMAP_SIZE-1)) BIT(1);
      145     7019    1   DCL DUMPSIZE SBIN;
      146     7020    1   DCL DUMPHIGH SBIN;
      147     7021    1   DCL DUMPTRACKS SBIN;
      148     7022    1   DCL BOOTTRACKS SBIN;
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:5    
      149     7023
      150     7024    1   DCL 1 DUMPSIZEFMT CONSTANT,
      151     7025    1         2 * CHAR(0) INIT('%/This dump is incomplete.%/'),
      152     7026    1         2 * CHAR(0) INIT('  Full dump size (pages):        %3D%/'),
      153     7027    1         2 * CHAR(0) INIT('  Required tracks for dump:      %3D%/'),
      154     7028    1         2 * CHAR(0) INIT('  Maximum tracks for boot image: %3D%/');
      155     7029
      156     7030        /*N* A little info about the floppy disks  */
      157     7031        /*N* that should probably be in an include file */
      158     7032
      159     7033        %EQU SECTORS_PER_TRACK=32;
      160     7034        %EQU TRACKS_PER_SIDE=80;
      161     7035        %EQU SECTORS_PER_PAGE=2;
      162     7036        %EQU PAGES_PER_TRACK=SECTORS_PER_TRACK/SECTORS_PER_PAGE;
      163     7037        %EQU TOTAL_TRACKS=TRACKS_PER_SIDE * 2;
      164     7038
      165     7039
      166     7040
      167     7041        %EJECT;
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:6    
      168     7042    1      IF NOT DA_DUMPFILE
      169     7043    2      THEN DO;
      170     7044    2           DA_ANLZERR='040204000000'O;
      171     7045    2           DA_ANLZERR.CODE=%E$DB_NO_RVBUF;
      172     7046    2           RETURN;
      173     7047    2           END;
      174     7048        /*E*    ERROR:  DBD-E$DB_NO_RVBUF
      175     7049                MESSAGE: Using running system - no recovery buffer.
      176     7050        */
      177     7051
      178     7052    1      CALL DAF$INIT(REPORT);
      179     7053
      180     7054    1      CALL DBM$GETMEM(RVBUF$,RVBUF,0,SIZEC(RVBUF),,SIZEC(RVBUF))
      181     7055    2      WHENALTRETURN DO;
      182     7056    2           RETURN;
      183     7057    2           END;
      184     7058
      185     7059    1      CALL XUR$ERRCNVRT(RVBUF.SCODE,SCODE);
      186     7060    1      SCODEM=SCODE;
      187     7061    1      SCODEM.MON=~SCODE.MON;
      188     7062    1      FPT_ERRMSG.BUF_=VECTOR(ERRBUF);
      189     7063    1      FPT_ERRMSG.V.OUTDCB1#=DAF_DCB#;
      190     7064    1      CALL M$ERRMSG(FPT_ERRMSG);
      191     7065    1      CALL DAF$UPDLNCNT;
      192     7066
      193     7067    1      CALL DBM$PACKB(RVBUF.FLAGS,FLAGS);
      194     7068    1      IF FLAGS.BADPPUT
      195     7069    2      THEN DO;
      196     7070    2           CALL DBM$PACK2(RVBUF.BADPPX,I);
      197     7071    2           CALL DAF$WRITE(VECTOR(PPUTBAD),VECTOR(I));
      198     7072    2           END;
      199     7073
      200     7074    1      CALL DBM$PACK2(RVBUF.CUN,CUN);
      201     7075    1      CALL DBM$PACK4(RVBUF.TSA$,TSA$);
      202     7076
      203     7077    1      ASDT = DB_MONASDT.BASE(5) *256;
      204     7078
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:7    
      205     7079    1      CALL DBM$GETMEM(MHJIT_CUN$,CPU_INFO,0,SIZEC(CPU_INFO),,SIZEC(CPU_INFO))
      206     7080    2      WHENALTRETURN DO;
      207     7081    2           RETURN;
      208     7082    2           END;
      209     7083
      210     7084    1      CALL DBM$PACK2(CPU_INFO.INTRVL_TYPE,INTERVAL_TYPE);
      211     7085    1      IF INTERVAL_TYPE <= 3
      212     7086    1      THEN INTV_TYPE = G_INTRVL_TXT(INTERVAL_TYPE);
      213     7087    1      ELSE CALL BINCHAR(INTV_TYPE,INTERVAL_TYPE);
      214     7088
      215     7089    1      CALL DBM$PACK4(CPU_INFO.BOOTUTS,BOOTUTS);
      216     7090    1      CALL DBM$PACK4(CPU_INFO.UTS,CURRUTS);
      217     7091    1      CALL DBM$PACK2(CPU_INFO.TICKS,TICKS);
      218     7092    1      TICKS = (TICKS / 16);
      219     7093    1      CURRUTS = CURRUTS + BOOTUTS + TICKS;
      220     7094
      221     7095    1      FPT_TIME.TSTAMP_ = VECTOR(BOOTUTS);
      222     7096    1      CALL M$TIME(FPT_TIME);
      223     7097
      224     7098    1      FPT_TIME.TSTAMP_ = VECTOR(CURRUTS);
      225     7099    1      CALL M$TIME(FPT_TIME);
      226     7100
      227     7101    1      CALL DBM$GETMEM(DMN$,DMN_BUF,,4,,4)
      228     7102    2      WHENRETURN DO;
      229     7103    2           CALL DBM$PACK2(DMN_BUF,DMN);
      230     7104    2           IF DMN <= 7
      231     7105    2           THEN WHO = DMN_WHO(DMN);
      232     7106    2           ELSE CALL BINCHAR(WHO,DMN);
      233     7107    2           END;
      234     7108
      235     7109    1      CALL DAF$WRITE(VECTOR(TIME_FMT), VECTOR(BOOTUTS), VECTOR(CURRUTS));
      236     7110
      237     7111    1      CALL DAF$WRITE(VECTOR(INTERVAL_FMT),VECTOR(INTV_TYPE),VECTOR(WHO));
      238     7112
      239     7113    1      CALL DBD$INTCON_ACTIVE;
      240     7114
      241     7115    1      CALL DAF$WRITE(VECTOR(USER_FMT),VECTOR(CUN),VECTOR(DB_CURRENT_USER));
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:8    
      242     7116
      243     7117    1      CALL DBD$SPY_RCV;
      244     7118
      245     7119    1      SYSID = 0;
      246     7120
      247     7121        /*  ???  DO WHILE(TSA$~=0);  */
      248     7122    1      CALL DBM$GETMEM(TSA$,TSABUF,,SIZEC(TSABUF),,1)
      249     7123    2      WHENRETURN DO;
      250     7124
      251     7125    2           IF TSA$ < MON_TSA$
      252     7126    3           THEN DO;
      253     7127    3                SYSID = -DB_CURRENT_USER;
      254     7128    3                CALL DBM$PACK4(TSABUF.P,P$);
      255     7129    3                IF P$ >= LIB_START
      256     7130    4                THEN DO;
      257     7131    4                     CALL DBM$SETLIB_SYM(SYSID);
      258     7132    4                     END;
      259     7133    4                ELSE DO;
      260     7134    4                     CALL DBM$SETSYMBOLS(SYSID);
      261     7135    4                     END;
      262     7136    3                END;
      263     7137
      264     7138    2           CALL DAF$WRITE(VECTOR(TSA_FMT),VECTOR(TSA$),VECTOR(DB_CURRENT_USER),VECTOR(
              7138                    ASDT));
      265     7139    2           CALL DBB$TSA(TSABUF);
      266     7140    2           CALL DBM$PACK4(TSABUF,TSA$);
      267     7141    2           END;
      268     7142    2      WHENALTRETURN DO;
      269     7143    2           TSA$=0;
      270     7144    2           END;
      271     7145        /*  ???     END;   */
      272     7146
      273     7147    1      IF SYSID ~= 0
      274     7148    2      THEN DO;
      275     7149    2           CALL DBM$SETSYMBOLS(0);
      276     7150    2           END;
      277     7151
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:9    
      278     7152    1      CALL DBM$PACK(RVBUF.DUMPMAP,DUMPMAP,%(GI_BITMAP_SIZE/8));
      279     7153    1      DUMPSIZE = 0;
      280     7154    1      DUMPHIGH = 0;
      281     7155    2      DO I = 0 TO %GI_BITMAP_SIZE-1;
      282     7156    2           IF DUMPMAP(I)
      283     7157    3           THEN DO;
      284     7158    3                DUMPSIZE = DUMPSIZE + %GI_PGS_PER_BIT;
      285     7159    3                DUMPHIGH = I;
      286     7160    3                END;
      287     7161    2           END;
      288     7162
      289     7163
      290     7164    1      DUMPHIGH = (DUMPHIGH * %GI_PGS_PER_BIT) + %GI_PGS_PER_BIT - 1;
      291     7165    1      CALL DBM$READ_PAGE(DUMPHIGH)
      292     7166    2      WHENALTRETURN DO;
      293     7167    2           DUMPTRACKS = ((DUMPSIZE * %SECTORS_PER_PAGE) + %SECTORS_PER_TRACK - 1) / %
              7167                    SECTORS_PER_TRACK;
      294     7168    2           BOOTTRACKS = %TOTAL_TRACKS - DUMPTRACKS;
      295     7169    2           CALL DAF$WRITE(VECTOR(DUMPSIZEFMT),VECTOR(DUMPSIZE),VECTOR(DUMPTRACKS),
              7169                    VECTOR(BOOTTRACKS));
      296     7170    2           END;
      297     7171    1      RETURN;
      298     7172
      299     7173    1   END DBD$RECOVERY;

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:10   
--  Include file information  --

   G_HJIT_M.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   GH_SCHD_M.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   DB_PERR_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   DBD_FEP_E.:E05TOU  is referenced.
   DA_FORMAT_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DBD$RECOVERY.

   Procedure DBD$RECOVERY requires 493 words for executable code.
   Procedure DBD$RECOVERY requires 368 words of local(AUTO) storage.

    No errors detected in file DBD$RECOVERY.:E05TSI    .

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:11   

 Object Unit name= DBD$RECOVERY                               File name= DBD$RECOVERY.:E05TOU
 UTS= JUL 29 '97 13:08:43.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    63     77  DBD$RECOVERY
    2  RoData even  UTS    166    246  DBD$RECOVERY
    3   Proc  even  none   493    755  DBD$RECOVERY
    4  RoData even  none    55     67  DBD$RECOVERY

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     3      0   yes            yes      Std        0  DBD$RECOVERY
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:12   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       1 DAF$INIT
 yes     yes           Std      10 DBM$GETMEM
         yes           Std       2 DBM$PACK2
 yes     yes           Std       1 DBM$READ_PAGE
         yes           Std       1 DBM$SETSYMBOLS
         yes           Std       3 DBM$PACK
         yes           Std       2 XUR$ERRCNVRT
         yes           Std       0 DAF$UPDLNCNT
         yes           Std       2 DBM$PACK4
         yes           Std       0 DBD$SPY_RCV
         yes           Std       1 DBB$TSA
         yes           Std       0 DBD$INTCON_ACTIVE
         yes           Std       1 DBM$SETLIB_SYM
         yes           Std       2 DBM$PACKB
                       nStd      0 X66_AUTO_0
                       nStd      0 X66_ARET
                       Std       0 B_CONSPOOL_D

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DA_ANLZERR                            DA_DUMPFILE                           DAF_DCB#
     M$UC                                  DAF$WRITE                             DB_CURRENT_USER
     DB_MONASDT                            B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:13   


        1        1        /*M* DBD$RECOVERY - Display recovery buffer for FEP ANLZ */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=3,IND=5,ENU=0,ECU=0  */
        8        8
        9        9        DBD$RECOVERY: PROC;

      9  3 000000   000000 700200 xent  DBD$RECOVERY TSX0  ! X66_AUTO_0
         3 000001   000560 000000                    ZERO    368,0

       10       10
       11       11        %INCLUDE DA_ANLZ_R;
       12       24        %INCLUDE DA_MAP_R;
       13       54        %INCLUDE DA_FORMAT_C;
       14      296        %INCLUDE DA_FORMAT_R;
       15      308        %INCLUDE DBD_FEP_E;
       16      319        %INCLUDE CP_6;
       17     5878        %INCLUDE DB_PERR_C;
       18     5896        %INCLUDE IR_DATA_M;
       19     6060        %INCLUDE GH_SCHD_M;
       20     6204        %INCLUDE GM_VIRTUAL_E;
       21     6414        %INCLUDE G_HJIT_M;
       22     6559
       23     6560        %GI_RCVR_EQU;
       24     6572
       25     6573    1   DCL DAF$INIT ENTRY(1) ALTRET;
       26     6574    1   DCL DAF$WRITE EPTR SYMREF;
       27     6575    1   DCL DAF$UPDLNCNT ENTRY;
       28     6576    1   DCL DBB$TSA ENTRY(1);
       29     6577    1   DCL DBD$INTCON_ACTIVE ENTRY;
       30     6578    1   DCL DBD$SPY_RCV ENTRY;
       31     6579    1   DCL DBM$PACK ENTRY(3);
       32     6580    1   DCL DBM$PACKB ENTRY(2);
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:14   
       33     6581    1   DCL DBM$PACK1 ENTRY(2);
       34     6582    1   DCL DBM$PACK2 ENTRY(2);
       35     6583    1   DCL DBM$PACK4 ENTRY(2);
       36     6584    1   DCL DBM$GETMEM ENTRY(10) ALTRET;
       37     6585    1   DCL DBM$SETSYMBOLS ENTRY(1);
       38     6586    1   DCL DBM$SETLIB_SYM ENTRY(1);
       39     6587    1   DCL DBM$READ_PAGE ENTRY(1) ALTRET;
       40     6588    1   DCL XUR$ERRCNVRT ENTRY(2);
       41     6589
       42     6590    1   DCL DB_CURRENT_USER UBIN SYMREF;
       43     6591    1   DCL 1 DB_MONASDT(0:30) SYMREF,
       44     6592    1         2 V BIT(1),
       45     6593    1         2 BASE UBIN(15) UNAL,
       46     6594    1         2 * BIT(6),
       47     6595    1         2 * BIT(1),
       48     6596    1         2 SIZE UBIN(9) UNAL;
       49     6597
       50     6598        %FPT_ERRMSG (CODE=SCODE,SUBMESS=YES,INCLCODE=YES,RESULTS=VLR_ERRMSG,
       51     6599                     ALTCODE=SCODEM,FILENAME=SCRMSG,FILEACCT=SYSACCT);
       52     6626        %VLP_NAME (FPTN=SCRMSG,NAME=':SCRMSG');
       53     6653        %VLP_ACCT (FPTN=SYSACCT,ACCT=':SYS');
       54     6666        %VLR_ERRMSG;
       55     6688        %VLP_ERRCODE (FPTN=SCODE);
       56     6733        %VLP_ERRCODE (FPTN=SCODEM);
       57     6778    1   DCL ERRBUF CHAR(120);
       58     6779
       59     6780        %FPT_TIME (SOURCE=FUTS, DEST=UTS);
       60     6799
       61     6800        %REPORT (NAME=REPORT,TITLE='FEP Recovery Information');
       62     6866
       63     6867
       64     6868    1   DCL PPUTBAD CHAR(0) CONSTANT INIT('%/PPUT inconsistent.  Index = %D');
       65     6869
       66     6870    1   DCL TIME_FMT CHAR(0) CONSTANT INIT(
       67     6871    1   'Boot time: %11..3.2U  Curr time: %11..3.2U');
       68     6872
       69     6873    1   DCL USER_FMT CHAR(0) CONSTANT INIT(
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:15   
       70     6874    1   '%/Current scheduled user: .%H   Currently mapped user: .%H');
       71     6875
       72     6876    1   DCL INTERVAL_FMT CHAR(0) CONSTANT INIT(
       73     6877    1   '%/MHJIT Interval Type: %>A  HJIT Domain %>A');
       74     6878
       75     6879    1   DCL TSA_FMT CHAR(0) CONSTANT INIT(
       76     6880    1   'TSA @ .%H for user .%H  using ASDT at .%H:');
       77     6881
       78     6882        %G_INTRVL_TXT;
       79     6898
       80     6899    1   DCL DMN_WHO(0:7) CHAR(24) CONSTANT INIT(
       81     6900    1      '0 - Monitor Service',
       82     6901    1      '1 - Debugger Service',
       83     6902    1      '2 - Int Level Service',
       84     6903    1      '3 - User Service',
       85     6904    1      '4 - Monitor Execution',
       86     6905    1      '5 - Debugger Execution',
       87     6906    1      '6 - Int Level Execution',
       88     6907    1      '7 - User Execution');
       89     6908
       90     6909    1   DCL RVBUF$ UBIN CONSTANT INIT(%(GM_LOW_MEM_BASE+GI_RVBUF_LOC));
       91     6910    1   DCL LIB_START UBIN CONSTANT INIT(%GM_ISR6_BASE);
       92     6911
       93     6912    1   DCL DMN$ UBIN CONSTANT INIT(%(GM_UHJIT_BASE+G_UHJIT_DMN#));
       94     6913    1   DCL MON_TSA$ UBIN CONSTANT INIT(%(GM_UHJIT_BASE+G_UHJIT_TSA_DB#));
       95     6914    1   DCL MHJIT_CUN$ UBIN CONSTANT INIT(%(GM_MHJIT_BASE+G_MHJIT_CUN#));
       96     6915
       97     6916        %RV_FEP_BUFF (FPTN=RVBUF,STCLASS=AUTO);
       98     6949    1   DCL 1 FLAGS ALIGNED,
       99     6950    1         2 BADPPUT BIT(1);
      100     6951
      101     6952    1   DCL I SBIN;
      102     6953    1   DCL ASDT UBIN;
      103     6954    1   DCL WHO CHAR(24);
      104     6955    1   DCL INTV_TYPE CHAR(20);
      105     6956    1   DCL DMN UBIN;
      106     6957    1   DCL DMN_BUF UBIN;
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:16   
      107     6958    1   DCL SYSID SBIN;
      108     6959    1   DCL CUN UBIN;
      109     6960    1   DCL TSA$ UBIN;
      110     6961    1   DCL P$ UBIN;
      111     6962
      112     6963    1   DCL 1 TSABUF CALIGNED,
      113     6964    1         2 TSAL$ PTR CALIGNED,
      114     6965    1         2 IREG UBIN HALF CALIGNED,
      115     6966    1         2 R3 UBIN HALF CALIGNED,
      116     6967    1         2 INST UBIN HALF CALIGNED,
      117     6968    1         2 ZREG UBIN HALF CALIGNED,
      118     6969    1         2 A$ PTR CALIGNED,
      119     6970    1         2 P EPTR CALIGNED,
      120     6971    1         2 B3$ PTR CALIGNED,
      121     6972    1         2 SREG UBIN HALF CALIGNED,
      122     6973    1         2 ISA,
      123     6974    1           3 ASV$ PTR CALIGNED,
      124     6975    1           3 * UBIN HALF CALIGNED,
      125     6976    1           3 TSAP$ PTR CALIGNED,
      126     6977    1           3 CHN UBIN HALF CALIGNED,
      127     6978    1           3 ISM1 UBIN HALF CALIGNED,
      128     6979    1           3 ISM2 UBIN HALF CALIGNED,
      129     6980    1           3 P$ EPTR CALIGNED,
      130     6981    1           3 S UBIN HALF CALIGNED,
      131     6982    1           3 BREGS(0:6) PTR CALIGNED,
      132     6983    1           3 I UBIN HALF CALIGNED,
      133     6984    1           3 RREGS(0:6) UBIN HALF CALIGNED,
      134     6985    1           3 *(0:12) UBIN HALF CALIGNED;
      135     6986
      136     6987
      137     6988        %G$MHJIT_CPU (FPTN=CPU_INFO,STCLASS=AUTO);
      138     7012
      139     7013    1   DCL INTERVAL_TYPE UBIN;
      140     7014    1   DCL BOOTUTS UBIN;
      141     7015    1   DCL CURRUTS UBIN;
      142     7016    1   DCL TICKS UBIN;
      143     7017
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:17   
      144     7018    1   DCL DUMPMAP(0:%(GI_BITMAP_SIZE-1)) BIT(1);
      145     7019    1   DCL DUMPSIZE SBIN;
      146     7020    1   DCL DUMPHIGH SBIN;
      147     7021    1   DCL DUMPTRACKS SBIN;
      148     7022    1   DCL BOOTTRACKS SBIN;
      149     7023
      150     7024    1   DCL 1 DUMPSIZEFMT CONSTANT,
      151     7025    1         2 * CHAR(0) INIT('%/This dump is incomplete.%/'),
      152     7026    1         2 * CHAR(0) INIT('  Full dump size (pages):        %3D%/'),
      153     7027    1         2 * CHAR(0) INIT('  Required tracks for dump:      %3D%/'),
      154     7028    1         2 * CHAR(0) INIT('  Maximum tracks for boot image: %3D%/');
      155     7029
      156     7030        /*N* A little info about the floppy disks  */
      157     7031        /*N* that should probably be in an include file */
      158     7032
      159     7033        %EQU SECTORS_PER_TRACK=32;
      160     7034        %EQU TRACKS_PER_SIDE=80;
      161     7035        %EQU SECTORS_PER_PAGE=2;
      162     7036        %EQU PAGES_PER_TRACK=SECTORS_PER_TRACK/SECTORS_PER_PAGE;
      163     7037        %EQU TOTAL_TRACKS=TRACKS_PER_SIDE * 2;
      164     7038
      165     7039
      166     7040
      167     7041        %EJECT;
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:18   
      168     7042    1      IF NOT DA_DUMPFILE

   7042  3 000002   000000 234000 xsym               SZN     DA_DUMPFILE
         3 000003   000012 604000 3                  TMI     s:7052

      169     7043    2      THEN DO;

      170     7044    2           DA_ANLZERR='040204000000'O;

   7044  3 000004   000245 236000 2                  LDQ     DUMPSIZEFMT+36
         3 000005   000000 756000 xsym               STQ     DA_ANLZERR

      171     7045    2           DA_ANLZERR.CODE=%E$DB_NO_RVBUF;

   7045  3 000006   000000 376000 4                  ANQ     0
         3 000007   000010 276007                    ORQ     8,DL
         3 000010   000000 756000 xsym               STQ     DA_ANLZERR

      172     7046    2           RETURN;

   7046  3 000011   000000 702200 xent               TSX2  ! X66_ARET

      173     7047    2           END;
      174     7048        /*E*    ERROR:  DBD-E$DB_NO_RVBUF
      175     7049                MESSAGE: Using running system - no recovery buffer.
      176     7050        */
      177     7051
      178     7052    1      CALL DAF$INIT(REPORT);

   7052  3 000012   000001 630400 4                  EPPR0   1
         3 000013   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000014   000000 701000 xent               TSX1    DAF$INIT
         3 000015   000000 011000                    NOP     0

      179     7053
      180     7054    1      CALL DBM$GETMEM(RVBUF$,RVBUF,0,SIZEC(RVBUF),,SIZEC(RVBUF))

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:19   
   7054  3 000016   000003 236000 4                  LDQ     3
         3 000017   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000020   200536 757100                    STAQ    BOOTTRACKS+6,,AUTO
         3 000021   000004 237000 4                  LDAQ    4
         3 000022   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000023   200041 630500                    EPPR0   RVBUF,,AUTO
         3 000024   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000025   000006 236000 4                  LDQ     6
         3 000026   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000027   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000030   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000031   000000 701000 xent               TSX1    DBM$GETMEM
         3 000032   000034 702000 3                  TSX2    s:7056
         3 000033   000035 710000 3                  TRA     s:7059

      181     7055    2      WHENALTRETURN DO;

      182     7056    2           RETURN;

   7056  3 000034   000000 702200 xent               TSX2  ! X66_ARET

      183     7057    2           END;
      184     7058
      185     7059    1      CALL XUR$ERRCNVRT(RVBUF.SCODE,SCODE);

   7059  3 000035   000007 236000 4                  LDQ     7
         3 000036   200533 756100                    STQ     BOOTTRACKS+3,,AUTO
         3 000037   200243 630500                    EPPR0   RVBUF+130,,AUTO
         3 000040   200532 450500                    STP0    BOOTTRACKS+2,,AUTO
         3 000041   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000042   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000043   000000 701000 xent               TSX1    XUR$ERRCNVRT
         3 000044   000000 011000                    NOP     0

      186     7060    1      SCODEM=SCODE;

   7060  3 000045   000042 236000 1                  LDQ     SCODE
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:20   
         3 000046   000043 756000 1                  STQ     SCODEM

      187     7061    1      SCODEM.MON=~SCODE.MON;

   7061  3 000047   000042 236000 1                  LDQ     SCODE
         3 000050   000022 736000                    QLS     18
         3 000051   400000 376003                    ANQ     -131072,DU
         3 000052   400000 676003                    ERQ     -131072,DU
         3 000053   000022 772000                    QRL     18
         3 000054   000043 676000 1                  ERQ     SCODEM
         3 000055   400000 376007                    ANQ     -131072,DL
         3 000056   000043 656000 1                  ERSQ    SCODEM

      188     7062    1      FPT_ERRMSG.BUF_=VECTOR(ERRBUF);

   7062  3 000057   000010 235000 4                  LDA     8
         3 000060   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000061   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000062   000003 036003                    ADLQ    3,DU
         3 000063   000004 757000 1                  STAQ    FPT_ERRMSG+4

      189     7063    1      FPT_ERRMSG.V.OUTDCB1#=DAF_DCB#;

   7063  3 000064   000000 720000 xsym               LXL0    DAF_DCB#
         3 000065   000026 440000 1                  SXL0    FPT_ERRMSG+22

      190     7064    1      CALL M$ERRMSG(FPT_ERRMSG);

   7064  3 000066   000000 630400 1                  EPPR0   FPT_ERRMSG
         3 000067   020000 713400                    CLIMB   8192
         3 000070   405000 401760                    pmme    nvectors=11

      191     7065    1      CALL DAF$UPDLNCNT;

   7065  3 000071   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000072   000000 701000 xent               TSX1    DAF$UPDLNCNT
         3 000073   000000 011000                    NOP     0
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:21   

      192     7066
      193     7067    1      CALL DBM$PACKB(RVBUF.FLAGS,FLAGS);

   7067  3 000074   200247 630500                    EPPR0   FLAGS,,AUTO
         3 000075   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000076   200534 452500                    STP2    BOOTTRACKS+4,,AUTO
         3 000077   200534 236100                    LDQ     BOOTTRACKS+4,,AUTO
         3 000100   000011 036000 4                  ADLQ    9
         3 000101   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000102   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000103   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000104   000000 701000 xent               TSX1    DBM$PACKB
         3 000105   000000 011000                    NOP     0

      194     7068    1      IF FLAGS.BADPPUT

   7068  3 000106   200247 234100                    SZN     FLAGS,,AUTO
         3 000107   000140 605000 3                  TPL     s:7074

      195     7069    2      THEN DO;

      196     7070    2           CALL DBM$PACK2(RVBUF.BADPPX,I);

   7070  3 000110   200250 630500                    EPPR0   I,,AUTO
         3 000111   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000112   200534 452500                    STP2    BOOTTRACKS+4,,AUTO
         3 000113   200534 236100                    LDQ     BOOTTRACKS+4,,AUTO
         3 000114   000012 036000 4                  ADLQ    10
         3 000115   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000116   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000117   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000120   000000 701000 xent               TSX1    DBM$PACK2
         3 000121   000000 011000                    NOP     0

      197     7071    2           CALL DAF$WRITE(VECTOR(PPUTBAD),VECTOR(I));

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:22   
   7071  3 000122   777640 235007                    LDA     -96,DL
         3 000123   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000124   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000125   000250 036003                    ADLQ    168,DU
         3 000126   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000127   200534 630500                    EPPR0   BOOTTRACKS+4,,AUTO
         3 000130   200537 450500                    STP0    BOOTTRACKS+7,,AUTO
         3 000131   000013 236000 4                  LDQ     11
         3 000132   200536 756100                    STQ     BOOTTRACKS+6,,AUTO
         3 000133   200536 630500                    EPPR0   BOOTTRACKS+6,,AUTO
         3 000134   000000 220000 xsym               LDX0    DAF$WRITE
         3 000135   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000136   000000 701010                    TSX1    0,X0
         3 000137   000000 011000                    NOP     0

      198     7072    2           END;

      199     7073
      200     7074    1      CALL DBM$PACK2(RVBUF.CUN,CUN);

   7074  3 000140   200270 630500                    EPPR0   CUN,,AUTO
         3 000141   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000142   200245 631500                    EPPR1   RVBUF+132,,AUTO
         3 000143   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000144   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000145   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000146   000000 701000 xent               TSX1    DBM$PACK2
         3 000147   000000 011000                    NOP     0

      201     7075    1      CALL DBM$PACK4(RVBUF.TSA$,TSA$);

   7075  3 000150   200271 630500                    EPPR0   TSA$,,AUTO
         3 000151   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000152   200534 452500                    STP2    BOOTTRACKS+4,,AUTO
         3 000153   200534 236100                    LDQ     BOOTTRACKS+4,,AUTO
         3 000154   000016 036000 4                  ADLQ    14
         3 000155   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:23   
         3 000156   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000157   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000160   000000 701000 xent               TSX1    DBM$PACK4
         3 000161   000000 011000                    NOP     0

      202     7076
      203     7077    1      ASDT = DB_MONASDT.BASE(5) *256;

   7077  3 000162   000004 236000 xsym               LDQ     DB_MONASDT+4
         3 000163   000004 736000                    QLS     4
         3 000164   000017 376000 4                  ANQ     15
         3 000165   200251 756100                    STQ     ASDT,,AUTO

      204     7078
      205     7079    1      CALL DBM$GETMEM(MHJIT_CUN$,CPU_INFO,0,SIZEC(CPU_INFO),,SIZEC(CPU_INFO))

   7079  3 000166   000021 236000 4                  LDQ     17
         3 000167   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000170   200536 757100                    STAQ    BOOTTRACKS+6,,AUTO
         3 000171   000022 237000 4                  LDAQ    18
         3 000172   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000173   200331 630500                    EPPR0   CPU_INFO,,AUTO
         3 000174   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000175   000024 236000 4                  LDQ     20
         3 000176   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000177   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000200   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000201   000000 701000 xent               TSX1    DBM$GETMEM
         3 000202   000204 702000 3                  TSX2    s:7081
         3 000203   000205 710000 3                  TRA     s:7084

      206     7080    2      WHENALTRETURN DO;

      207     7081    2           RETURN;

   7081  3 000204   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:24   
      208     7082    2           END;
      209     7083
      210     7084    1      CALL DBM$PACK2(CPU_INFO.INTRVL_TYPE,INTERVAL_TYPE);

   7084  3 000205   200337 630500                    EPPR0   INTERVAL_TYPE,,AUTO
         3 000206   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000207   200333 631500                    EPPR1   CPU_INFO+2,,AUTO
         3 000210   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000211   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000212   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000213   000000 701000 xent               TSX1    DBM$PACK2
         3 000214   000000 011000                    NOP     0

      211     7085    1      IF INTERVAL_TYPE <= 3

   7085  3 000215   200337 235100                    LDA     INTERVAL_TYPE,,AUTO
         3 000216   000004 115007                    CMPA    4,DL
         3 000217   000226 603000 3                  TRC     s:7087

      212     7086    1      THEN INTV_TYPE = G_INTRVL_TXT(INTERVAL_TYPE);

   7086  3 000220   200337 236100                    LDQ     INTERVAL_TYPE,,AUTO
         3 000221   000024 402007                    MPY     20,DL
         3 000222   040100 100406                    MLR     fill='040'O
         3 000223   000070 000024 2                  ADSC9   G_INTRVL_TXT,Q           cn=0,n=20
         3 000224   200260 000024                    ADSC9   INTV_TYPE,,AUTO          cn=0,n=20
         3 000225   000233 710000 3                  TRA     s:7089

      213     7087    1      ELSE CALL BINCHAR(INTV_TYPE,INTERVAL_TYPE);

   7087  3 000226   000044 773000                    LRL     36
         3 000227   200532 757100                    STAQ    BOOTTRACKS+2,,AUTO
         3 000230   000100 301500                    BTD
         3 000231   200532 000010                    NDSC9   BOOTTRACKS+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         3 000232   200260 030024                    NDSC9   INTV_TYPE,,AUTO          cn=0,s=nosgn,sf=0,n=20

      214     7088
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:25   
      215     7089    1      CALL DBM$PACK4(CPU_INFO.BOOTUTS,BOOTUTS);

   7089  3 000233   200340 630500                    EPPR0   BOOTUTS,,AUTO
         3 000234   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000235   200534 452500                    STP2    BOOTTRACKS+4,,AUTO
         3 000236   200534 236100                    LDQ     BOOTTRACKS+4,,AUTO
         3 000237   000025 036000 4                  ADLQ    21
         3 000240   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000241   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000242   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000243   000000 701000 xent               TSX1    DBM$PACK4
         3 000244   000000 011000                    NOP     0

      216     7090    1      CALL DBM$PACK4(CPU_INFO.UTS,CURRUTS);

   7090  3 000245   200341 630500                    EPPR0   CURRUTS,,AUTO
         3 000246   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000247   200534 452500                    STP2    BOOTTRACKS+4,,AUTO
         3 000250   200534 236100                    LDQ     BOOTTRACKS+4,,AUTO
         3 000251   000026 036000 4                  ADLQ    22
         3 000252   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000253   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000254   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000255   000000 701000 xent               TSX1    DBM$PACK4
         3 000256   000000 011000                    NOP     0

      217     7091    1      CALL DBM$PACK2(CPU_INFO.TICKS,TICKS);

   7091  3 000257   200342 630500                    EPPR0   TICKS,,AUTO
         3 000260   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000261   200534 452500                    STP2    BOOTTRACKS+4,,AUTO
         3 000262   200534 236100                    LDQ     BOOTTRACKS+4,,AUTO
         3 000263   000027 036000 4                  ADLQ    23
         3 000264   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000265   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000266   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000267   000000 701000 xent               TSX1    DBM$PACK2
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:26   
         3 000270   000000 011000                    NOP     0

      218     7092    1      TICKS = (TICKS / 16);

   7092  3 000271   200342 236100                    LDQ     TICKS,,AUTO
         3 000272   000004 772000                    QRL     4
         3 000273   200342 756100                    STQ     TICKS,,AUTO

      219     7093    1      CURRUTS = CURRUTS + BOOTUTS + TICKS;

   7093  3 000274   200341 236100                    LDQ     CURRUTS,,AUTO
         3 000275   200340 036100                    ADLQ    BOOTUTS,,AUTO
         3 000276   200342 036100                    ADLQ    TICKS,,AUTO
         3 000277   200341 756100                    STQ     CURRUTS,,AUTO

      220     7094
      221     7095    1      FPT_TIME.TSTAMP_ = VECTOR(BOOTUTS);

   7095  3 000300   777640 235007                    LDA     -96,DL
         3 000301   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000302   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000303   000340 036003                    ADLQ    224,DU
         3 000304   000054 757000 1                  STAQ    FPT_TIME+8

      222     7096    1      CALL M$TIME(FPT_TIME);

   7096  3 000305   000044 630400 1                  EPPR0   FPT_TIME
         3 000306   020004 713400                    CLIMB   8196
         3 000307   402000 401760                    pmme    nvectors=5

      223     7097
      224     7098    1      FPT_TIME.TSTAMP_ = VECTOR(CURRUTS);

   7098  3 000310   777640 235007                    LDA     -96,DL
         3 000311   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000312   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000313   000341 036003                    ADLQ    225,DU
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:27   
         3 000314   000054 757000 1                  STAQ    FPT_TIME+8

      225     7099    1      CALL M$TIME(FPT_TIME);

   7099  3 000315   000044 630400 1                  EPPR0   FPT_TIME
         3 000316   020004 713400                    CLIMB   8196
         3 000317   402000 401760                    pmme    nvectors=5

      226     7100
      227     7101    1      CALL DBM$GETMEM(DMN$,DMN_BUF,,4,,4)

   7101  3 000320   000030 236000 4                  LDQ     24
         3 000321   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000322   200536 757100                    STAQ    BOOTTRACKS+6,,AUTO
         3 000323   000030 236000 4                  LDQ     24
         3 000324   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000325   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000326   200266 630500                    EPPR0   DMN_BUF,,AUTO
         3 000327   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000330   000031 236000 4                  LDQ     25
         3 000331   200532 756100                    STQ     BOOTTRACKS+2,,AUTO
         3 000332   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000333   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000334   000000 701000 xent               TSX1    DBM$GETMEM
         3 000335   000364 702000 3                  TSX2    s:7109

      228     7102    2      WHENRETURN DO;

      229     7103    2           CALL DBM$PACK2(DMN_BUF,DMN);

   7103  3 000336   200265 630500                    EPPR0   DMN,,AUTO
         3 000337   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000340   200266 631500                    EPPR1   DMN_BUF,,AUTO
         3 000341   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000342   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000343   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000344   000000 701000 xent               TSX1    DBM$PACK2
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:28   
         3 000345   000000 011000                    NOP     0

      230     7104    2           IF DMN <= 7

   7104  3 000346   200265 235100                    LDA     DMN,,AUTO
         3 000347   000010 115007                    CMPA    8,DL
         3 000350   000357 603000 3                  TRC     s:7106

      231     7105    2           THEN WHO = DMN_WHO(DMN);

   7105  3 000351   200265 236100                    LDQ     DMN,,AUTO
         3 000352   000030 402007                    MPY     24,DL
         3 000353   040100 100406                    MLR     fill='040'O
         3 000354   000114 000030 2                  ADSC9   DMN_WHO,Q                cn=0,n=24
         3 000355   200252 000030                    ADSC9   WHO,,AUTO                cn=0,n=24
         3 000356   000364 710000 3                  TRA     s:7109

      232     7106    2           ELSE CALL BINCHAR(WHO,DMN);

   7106  3 000357   000044 773000                    LRL     36
         3 000360   200532 757100                    STAQ    BOOTTRACKS+2,,AUTO
         3 000361   000100 301500                    BTD
         3 000362   200532 000010                    NDSC9   BOOTTRACKS+2,,AUTO       cn=0,s=lsgnf,sf=0,n=8
         3 000363   200252 030030                    NDSC9   WHO,,AUTO                cn=0,s=nosgn,sf=0,n=24

      233     7107    2           END;

      234     7108
      235     7109    1      CALL DAF$WRITE(VECTOR(TIME_FMT), VECTOR(BOOTUTS), VECTOR(CURRUTS));

   7109  3 000364   777640 235007                    LDA     -96,DL
         3 000365   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000366   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000367   000340 036003                    ADLQ    224,DU
         3 000370   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000371   777640 235007                    LDA     -96,DL
         3 000372   200536 452500                    STP2    BOOTTRACKS+6,,AUTO
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:29   
         3 000373   200536 236100                    LDQ     BOOTTRACKS+6,,AUTO
         3 000374   000341 036003                    ADLQ    225,DU
         3 000375   200542 757100                    STAQ    BOOTTRACKS+10,,AUTO
         3 000376   200534 237100                    LDAQ    BOOTTRACKS+4,,AUTO
         3 000377   200540 757100                    STAQ    BOOTTRACKS+8,,AUTO
         3 000400   200542 237100                    LDAQ    BOOTTRACKS+10,,AUTO
         3 000401   200544 757100                    STAQ    BOOTTRACKS+12,,AUTO
         3 000402   200544 630500                    EPPR0   BOOTTRACKS+12,,AUTO
         3 000403   200550 450500                    STP0    BOOTTRACKS+16,,AUTO
         3 000404   200540 631500                    EPPR1   BOOTTRACKS+8,,AUTO
         3 000405   200547 451500                    STP1    BOOTTRACKS+15,,AUTO
         3 000406   000034 236000 4                  LDQ     28
         3 000407   200546 756100                    STQ     BOOTTRACKS+14,,AUTO
         3 000410   200546 630500                    EPPR0   BOOTTRACKS+14,,AUTO
         3 000411   000000 220000 xsym               LDX0    DAF$WRITE
         3 000412   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000413   000000 701010                    TSX1    0,X0
         3 000414   000000 011000                    NOP     0

      236     7110
      237     7111    1      CALL DAF$WRITE(VECTOR(INTERVAL_FMT),VECTOR(INTV_TYPE),VECTOR(WHO));

   7111  3 000415   000040 235000 4                  LDA     32
         3 000416   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000417   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000420   000260 036003                    ADLQ    176,DU
         3 000421   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000422   000041 235000 4                  LDA     33
         3 000423   200536 452500                    STP2    BOOTTRACKS+6,,AUTO
         3 000424   200536 236100                    LDQ     BOOTTRACKS+6,,AUTO
         3 000425   000252 036003                    ADLQ    170,DU
         3 000426   200542 757100                    STAQ    BOOTTRACKS+10,,AUTO
         3 000427   200534 237100                    LDAQ    BOOTTRACKS+4,,AUTO
         3 000430   200540 757100                    STAQ    BOOTTRACKS+8,,AUTO
         3 000431   200542 237100                    LDAQ    BOOTTRACKS+10,,AUTO
         3 000432   200544 757100                    STAQ    BOOTTRACKS+12,,AUTO
         3 000433   200544 630500                    EPPR0   BOOTTRACKS+12,,AUTO
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:30   
         3 000434   200550 450500                    STP0    BOOTTRACKS+16,,AUTO
         3 000435   200540 631500                    EPPR1   BOOTTRACKS+8,,AUTO
         3 000436   200547 451500                    STP1    BOOTTRACKS+15,,AUTO
         3 000437   000042 236000 4                  LDQ     34
         3 000440   200546 756100                    STQ     BOOTTRACKS+14,,AUTO
         3 000441   200546 630500                    EPPR0   BOOTTRACKS+14,,AUTO
         3 000442   000000 220000 xsym               LDX0    DAF$WRITE
         3 000443   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000444   000000 701010                    TSX1    0,X0
         3 000445   000000 011000                    NOP     0

      238     7112
      239     7113    1      CALL DBD$INTCON_ACTIVE;

   7113  3 000446   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000447   000000 701000 xent               TSX1    DBD$INTCON_ACTIVE
         3 000450   000000 011000                    NOP     0

      240     7114
      241     7115    1      CALL DAF$WRITE(VECTOR(USER_FMT),VECTOR(CUN),VECTOR(DB_CURRENT_USER));

   7115  3 000451   777640 235007                    LDA     -96,DL
         3 000452   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000453   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000454   000270 036003                    ADLQ    184,DU
         3 000455   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000456   000050 236000 4                  LDQ     40
         3 000457   200540 756100                    STQ     BOOTTRACKS+8,,AUTO
         3 000460   200534 630500                    EPPR0   BOOTTRACKS+4,,AUTO
         3 000461   200537 450500                    STP0    BOOTTRACKS+7,,AUTO
         3 000462   000051 236000 4                  LDQ     41
         3 000463   200536 756100                    STQ     BOOTTRACKS+6,,AUTO
         3 000464   200536 630500                    EPPR0   BOOTTRACKS+6,,AUTO
         3 000465   000000 220000 xsym               LDX0    DAF$WRITE
         3 000466   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000467   000000 701010                    TSX1    0,X0
         3 000470   000000 011000                    NOP     0
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:31   

      242     7116
      243     7117    1      CALL DBD$SPY_RCV;

   7117  3 000471   000002 631400 xsym               EPPR1   B_VECTNIL+2
         3 000472   000000 701000 xent               TSX1    DBD$SPY_RCV
         3 000473   000000 011000                    NOP     0

      244     7118
      245     7119    1      SYSID = 0;

   7119  3 000474   200267 450100                    STZ     SYSID,,AUTO

      246     7120
      247     7121        /*  ???  DO WHILE(TSA$~=0);  */
      248     7122    1      CALL DBM$GETMEM(TSA$,TSABUF,,SIZEC(TSABUF),,1)

   7122  3 000475   000053 236000 4                  LDQ     43
         3 000476   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000477   200536 757100                    STAQ    BOOTTRACKS+6,,AUTO
         3 000500   000054 236000 4                  LDQ     44
         3 000501   000001 235000 xsym               LDA     B_VECTNIL+1
         3 000502   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000503   200273 630500                    EPPR0   TSABUF,,AUTO
         3 000504   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000505   200271 631500                    EPPR1   TSA$,,AUTO
         3 000506   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000507   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000510   000024 631400 xsym               EPPR1   B_VECTNIL+20
         3 000511   000000 701000 xent               TSX1    DBM$GETMEM
         3 000512   000623 702000 3                  TSX2    s:7143

      249     7123    2      WHENRETURN DO;

      250     7124
      251     7125    2           IF TSA$ < MON_TSA$

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:32   
   7125  3 000513   200271 236100                    LDQ     TSA$,,AUTO
         3 000514   000177 116000 2                  CMPQ    MON_TSA$
         3 000515   000551 603000 3                  TRC     s:7138

      252     7126    3           THEN DO;

      253     7127    3                SYSID = -DB_CURRENT_USER;

   7127  3 000516   000000 235003                    LDA     0,DU
         3 000517   000000 135000 xsym               SBLA    DB_CURRENT_USER
         3 000520   200267 755100                    STA     SYSID,,AUTO

      254     7128    3                CALL DBM$PACK4(TSABUF.P,P$);

   7128  3 000521   200272 630500                    EPPR0   P$,,AUTO
         3 000522   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000523   200277 631500                    EPPR1   TSABUF+4,,AUTO
         3 000524   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000525   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000526   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000527   000000 701000 xent               TSX1    DBM$PACK4
         3 000530   000000 011000                    NOP     0

      255     7129    3                IF P$ >= LIB_START

   7129  3 000531   200272 236100                    LDQ     P$,,AUTO
         3 000532   000175 116000 2                  CMPQ    LIB_START
         3 000533   000543 602000 3                  TNC     s:7134

      256     7130    4                THEN DO;

      257     7131    4                     CALL DBM$SETLIB_SYM(SYSID);

   7131  3 000534   200267 630500                    EPPR0   SYSID,,AUTO
         3 000535   200532 450500                    STP0    BOOTTRACKS+2,,AUTO
         3 000536   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000537   000017 631400 xsym               EPPR1   B_VECTNIL+15
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:33   
         3 000540   000000 701000 xent               TSX1    DBM$SETLIB_SYM
         3 000541   000000 011000                    NOP     0

      258     7132    4                     END;

   7132  3 000542   000551 710000 3                  TRA     s:7138

      259     7133    4                ELSE DO;

      260     7134    4                     CALL DBM$SETSYMBOLS(SYSID);

   7134  3 000543   200267 630500                    EPPR0   SYSID,,AUTO
         3 000544   200532 450500                    STP0    BOOTTRACKS+2,,AUTO
         3 000545   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000546   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000547   000000 701000 xent               TSX1    DBM$SETSYMBOLS
         3 000550   000000 011000                    NOP     0

      261     7135    4                     END;

      262     7136    3                END;

      263     7137
      264     7138    2           CALL DAF$WRITE(VECTOR(TSA_FMT),VECTOR(TSA$),VECTOR(DB_CURRENT_USER),VECTOR(
              7138                    ASDT));

   7138  3 000551   777640 235007                    LDA     -96,DL
         3 000552   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000553   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000554   000271 036003                    ADLQ    185,DU
         3 000555   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000556   777640 235007                    LDA     -96,DL
         3 000557   200536 452500                    STP2    BOOTTRACKS+6,,AUTO
         3 000560   200536 236100                    LDQ     BOOTTRACKS+6,,AUTO
         3 000561   000251 036003                    ADLQ    169,DU
         3 000562   200542 757100                    STAQ    BOOTTRACKS+10,,AUTO
         3 000563   200534 237100                    LDAQ    BOOTTRACKS+4,,AUTO
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:34   
         3 000564   200540 757100                    STAQ    BOOTTRACKS+8,,AUTO
         3 000565   200542 237100                    LDAQ    BOOTTRACKS+10,,AUTO
         3 000566   200544 757100                    STAQ    BOOTTRACKS+12,,AUTO
         3 000567   200544 630500                    EPPR0   BOOTTRACKS+12,,AUTO
         3 000570   200551 450500                    STP0    BOOTTRACKS+17,,AUTO
         3 000571   000050 236000 4                  LDQ     40
         3 000572   200550 756100                    STQ     BOOTTRACKS+16,,AUTO
         3 000573   200540 631500                    EPPR1   BOOTTRACKS+8,,AUTO
         3 000574   200547 451500                    STP1    BOOTTRACKS+15,,AUTO
         3 000575   000060 236000 4                  LDQ     48
         3 000576   200546 756100                    STQ     BOOTTRACKS+14,,AUTO
         3 000577   200546 630500                    EPPR0   BOOTTRACKS+14,,AUTO
         3 000600   000000 220000 xsym               LDX0    DAF$WRITE
         3 000601   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000602   000000 701010                    TSX1    0,X0
         3 000603   000000 011000                    NOP     0

      265     7139    2           CALL DBB$TSA(TSABUF);

   7139  3 000604   200273 630500                    EPPR0   TSABUF,,AUTO
         3 000605   200532 450500                    STP0    BOOTTRACKS+2,,AUTO
         3 000606   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000607   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000610   000000 701000 xent               TSX1    DBB$TSA
         3 000611   000000 011000                    NOP     0

      266     7140    2           CALL DBM$PACK4(TSABUF,TSA$);

   7140  3 000612   200271 630500                    EPPR0   TSA$,,AUTO
         3 000613   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
         3 000614   200273 631500                    EPPR1   TSABUF,,AUTO
         3 000615   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000616   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000617   000020 631400 xsym               EPPR1   B_VECTNIL+16
         3 000620   000000 701000 xent               TSX1    DBM$PACK4
         3 000621   000000 011000                    NOP     0

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:35   
      267     7141    2           END;

   7141  3 000622   000624 710000 3                  TRA     s:7147

      268     7142    2      WHENALTRETURN DO;

      269     7143    2           TSA$=0;

   7143  3 000623   200271 450100                    STZ     TSA$,,AUTO

      270     7144    2           END;

      271     7145        /*  ???     END;   */
      272     7146
      273     7147    1      IF SYSID ~= 0

   7147  3 000624   200267 235100                    LDA     SYSID,,AUTO
         3 000625   000632 600000 3                  TZE     s:7152

      274     7148    2      THEN DO;

      275     7149    2           CALL DBM$SETSYMBOLS(0);

   7149  3 000626   000004 630400 4                  EPPR0   4
         3 000627   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000630   000000 701000 xent               TSX1    DBM$SETSYMBOLS
         3 000631   000000 011000                    NOP     0

      276     7150    2           END;

      277     7151
      278     7152    1      CALL DBM$PACK(RVBUF.DUMPMAP,DUMPMAP,%(GI_BITMAP_SIZE/8));

   7152  3 000632   000062 236000 4                  LDQ     50
         3 000633   200534 756100                    STQ     BOOTTRACKS+4,,AUTO
         3 000634   200343 630500                    EPPR0   DUMPMAP,,AUTO
         3 000635   200533 450500                    STP0    BOOTTRACKS+3,,AUTO
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:36   
         3 000636   200041 631500                    EPPR1   RVBUF,,AUTO
         3 000637   200532 451500                    STP1    BOOTTRACKS+2,,AUTO
         3 000640   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000641   000021 631400 xsym               EPPR1   B_VECTNIL+17
         3 000642   000000 701000 xent               TSX1    DBM$PACK
         3 000643   000000 011000                    NOP     0

      279     7153    1      DUMPSIZE = 0;

   7153  3 000644   200525 450100                    STZ     DUMPSIZE,,AUTO

      280     7154    1      DUMPHIGH = 0;

   7154  3 000645   200526 450100                    STZ     DUMPHIGH,,AUTO

      281     7155    2      DO I = 0 TO %GI_BITMAP_SIZE-1;

   7155  3 000646   200250 450100                    STZ     I,,AUTO
         3 000647   000664 710000 3                  TRA     s:7161+1

      282     7156    2           IF DUMPMAP(I)

   7156  3 000650   200250 235100                    LDA     I,,AUTO
         3 000651   000653 605000 3                  TPL     s:7156+3
         3 000652   000044 035003                    ADLA    36,DU
         3 000653   000000 066505                    CMPB    filb='0'B
         3 000654   200343 000001                    BDSC    DUMPMAP,A,AUTO           by=0,bit=0,n=1
         3 000655   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         3 000656   000663 600000 3                  TZE     s:7161

      283     7157    3           THEN DO;

      284     7158    3                DUMPSIZE = DUMPSIZE + %GI_PGS_PER_BIT;

   7158  3 000657   000004 236007                    LDQ     4,DL
         3 000660   200525 056100                    ASQ     DUMPSIZE,,AUTO

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:37   
      285     7159    3                DUMPHIGH = I;

   7159  3 000661   200250 235100                    LDA     I,,AUTO
         3 000662   200526 755100                    STA     DUMPHIGH,,AUTO

      286     7160    3                END;

      287     7161    2           END;

   7161  3 000663   200250 054100                    AOS     I,,AUTO
         3 000664   200250 235100                    LDA     I,,AUTO
         3 000665   007777 115007                    CMPA    4095,DL
         3 000666   000650 604400 3                  TMOZ    s:7156

      288     7162
      289     7163
      290     7164    1      DUMPHIGH = (DUMPHIGH * %GI_PGS_PER_BIT) + %GI_PGS_PER_BIT - 1;

   7164  3 000667   200526 236100                    LDQ     DUMPHIGH,,AUTO
         3 000670   000002 736000                    QLS     2
         3 000671   000003 036007                    ADLQ    3,DL
         3 000672   200526 756100                    STQ     DUMPHIGH,,AUTO

      291     7165    1      CALL DBM$READ_PAGE(DUMPHIGH)

   7165  3 000673   200526 630500                    EPPR0   DUMPHIGH,,AUTO
         3 000674   200532 450500                    STP0    BOOTTRACKS+2,,AUTO
         3 000675   200532 630500                    EPPR0   BOOTTRACKS+2,,AUTO
         3 000676   000017 631400 xsym               EPPR1   B_VECTNIL+15
         3 000677   000000 701000 xent               TSX1    DBM$READ_PAGE
         3 000700   000702 702000 3                  TSX2    s:7167
         3 000701   000754 710000 3                  TRA     s:7171

      292     7166    2      WHENALTRETURN DO;

      293     7167    2           DUMPTRACKS = ((DUMPSIZE * %SECTORS_PER_PAGE) + %SECTORS_PER_TRACK - 1) / %
              7167                    SECTORS_PER_TRACK;
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:38   

   7167  3 000702   200525 236100                    LDQ     DUMPSIZE,,AUTO
         3 000703   000001 736000                    QLS     1
         3 000704   000037 036007                    ADLQ    31,DL
         3 000705   000040 506007                    DIV     32,DL
         3 000706   200527 756100                    STQ     DUMPTRACKS,,AUTO

      294     7168    2           BOOTTRACKS = %TOTAL_TRACKS - DUMPTRACKS;

   7168  3 000707   000240 235007                    LDA     160,DL
         3 000710   200527 135100                    SBLA    DUMPTRACKS,,AUTO
         3 000711   200530 755100                    STA     BOOTTRACKS,,AUTO

      295     7169    2           CALL DAF$WRITE(VECTOR(DUMPSIZEFMT),VECTOR(DUMPSIZE),VECTOR(DUMPTRACKS),
              7169                    VECTOR(BOOTTRACKS));

   7169  3 000712   777640 235007                    LDA     -96,DL
         3 000713   200532 452500                    STP2    BOOTTRACKS+2,,AUTO
         3 000714   200532 236100                    LDQ     BOOTTRACKS+2,,AUTO
         3 000715   000525 036003                    ADLQ    341,DU
         3 000716   200534 757100                    STAQ    BOOTTRACKS+4,,AUTO
         3 000717   777640 235007                    LDA     -96,DL
         3 000720   200536 452500                    STP2    BOOTTRACKS+6,,AUTO
         3 000721   200536 236100                    LDQ     BOOTTRACKS+6,,AUTO
         3 000722   000527 036003                    ADLQ    343,DU
         3 000723   200540 757100                    STAQ    BOOTTRACKS+8,,AUTO
         3 000724   777640 235007                    LDA     -96,DL
         3 000725   200542 452500                    STP2    BOOTTRACKS+10,,AUTO
         3 000726   200542 236100                    LDQ     BOOTTRACKS+10,,AUTO
         3 000727   000530 036003                    ADLQ    344,DU
         3 000730   200546 757100                    STAQ    BOOTTRACKS+14,,AUTO
         3 000731   200534 237100                    LDAQ    BOOTTRACKS+4,,AUTO
         3 000732   200544 757100                    STAQ    BOOTTRACKS+12,,AUTO
         3 000733   200540 237100                    LDAQ    BOOTTRACKS+8,,AUTO
         3 000734   200550 757100                    STAQ    BOOTTRACKS+16,,AUTO
         3 000735   200546 237100                    LDAQ    BOOTTRACKS+14,,AUTO
         3 000736   200552 757100                    STAQ    BOOTTRACKS+18,,AUTO
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:39   
         3 000737   200552 630500                    EPPR0   BOOTTRACKS+18,,AUTO
         3 000740   200557 450500                    STP0    BOOTTRACKS+23,,AUTO
         3 000741   200550 631500                    EPPR1   BOOTTRACKS+16,,AUTO
         3 000742   200556 451500                    STP1    BOOTTRACKS+22,,AUTO
         3 000743   200544 633500                    EPPR3   BOOTTRACKS+12,,AUTO
         3 000744   200555 453500                    STP3    BOOTTRACKS+21,,AUTO
         3 000745   000066 236000 4                  LDQ     54
         3 000746   200554 756100                    STQ     BOOTTRACKS+20,,AUTO
         3 000747   200554 630500                    EPPR0   BOOTTRACKS+20,,AUTO
         3 000750   000000 220000 xsym               LDX0    DAF$WRITE
         3 000751   000022 631400 xsym               EPPR1   B_VECTNIL+18
         3 000752   000000 701010                    TSX1    0,X0
         3 000753   000000 011000                    NOP     0

      296     7170    2           END;

      297     7171    1      RETURN;

   7171  3 000754   000000 702200 xent               TSX2  ! X66_ARET
      298     7172
      299     7173    1   END DBD$RECOVERY;

PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:40   
--  Include file information  --

   G_HJIT_M.:E05TOU  is referenced.
   GM_VIRTUAL_E.:E05TOU  is referenced.
   GH_SCHD_M.:E05TOU  is referenced.
   IR_DATA_M.:E05TOU  is referenced.
   DB_PERR_C.:E05TOU  is referenced.
   CP_6_C.:E05TOU  is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   DBD_FEP_E.:E05TOU  is referenced.
   DA_FORMAT_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_FORMAT_C.:E05TOU  is referenced.
   DA_MAP_R.:E05TOU  cannot be made into a system file and is referenced.
   DA_ANLZ_R.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure DBD$RECOVERY.
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:41   

 **** Variables and constants ****

  ****  Section 001  Data  DBD$RECOVERY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(936)   r     1 FPT_ERRMSG                44-0-0/d STRC(432)   r     1 FPT_TIME
    60-0-0/w STRC(288)   r     1 REPORT                    70-0-0/c STRC(225)   r     1 REPORTTX00
    42-0-0/w STRC        r     1 SCODE                     43-0-0/w STRC        r     1 SCODEM
    32-0-0/c STRC(72)    r     1 SCRMSG                    34-0-0/c STRC(72)    r     1 SYSACCT
    36-0-0/d STRC(144)   r     1 VLR_ERRMSG

  ****  Section 002 RoData DBD$RECOVERY

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   176-0-0/w UBIN        r     1 DMN$
   114-0-0/c CHAR(24)    r     1 DMN_WHO(0:7)
   201-0-0/c STRC(1278)  r     1 DUMPSIZEFMT
    70-0-0/c CHAR(20)    r     1 G_INTRVL_TXT(0:3)
    42-0-0/c CHAR(43)    r     1 INTERVAL_FMT             175-0-0/w UBIN        r     1 LIB_START
   200-0-0/w UBIN        r     1 MHJIT_CUN$               177-0-0/w UBIN        r     1 MON_TSA$
     0-0-0/c CHAR(32)    r     1 PPUTBAD                  174-0-0/w UBIN        r     1 RVBUF$
    10-0-0/c CHAR(42)    r     1 TIME_FMT                  55-0-0/c CHAR(42)    r     1 TSA_FMT
    23-0-0/c CHAR(58)    r     1 USER_FMT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   251-0-0/w UBIN        r     1 ASDT                     530-0-0/w SBIN        r     1 BOOTTRACKS
   340-0-0/w UBIN        r     1 BOOTUTS                  331-0-0/w STRC(198)   r     1 CPU_INFO
   270-0-0/w UBIN        r     1 CUN                      341-0-0/w UBIN        r     1 CURRUTS
   265-0-0/w UBIN        r     1 DMN                      266-0-0/w UBIN        r     1 DMN_BUF
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:42   
   526-0-0/w SBIN        r     1 DUMPHIGH                 343-0-0/b BIT         r     1 DUMPMAP(0:4095)
   525-0-0/w SBIN        r     1 DUMPSIZE                 527-0-0/w SBIN        r     1 DUMPTRACKS
     3-0-0/c CHAR(120)   r     1 ERRBUF                   247-0-0/w STRC        r     1 FLAGS
   250-0-0/w SBIN        r     1 I                        337-0-0/w UBIN        r     1 INTERVAL_TYPE
   260-0-0/c CHAR(20)    r     1 INTV_TYPE                272-0-0/w UBIN        r     1 P$
    41-0-0/w STRC(4824)  r     1 RVBUF                    267-0-0/w SBIN        r     1 SYSID
   342-0-0/w UBIN        r     1 TICKS                    271-0-0/w UBIN        r     1 TSA$
   273-0-0/c STRC(1062)  r     1 TSABUF                   252-0-0/c CHAR(24)    r     1 WHO

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w EPTR        r     1 DAF$WRITE                  0-0-0/w UBIN        r     1 DAF_DCB#
     0-0-0/w STRC        r     1 DA_ANLZERR                 0-0-0/w BIT         r     1 DA_DUMPFILE
     0-0-0/w UBIN        r     1 DB_CURRENT_USER
     0-0-0/b STRC(32)    r     1 DB_MONASDT(0:30)


   Procedure DBD$RECOVERY requires 493 words for executable code.
   Procedure DBD$RECOVERY requires 368 words of local(AUTO) storage.

    No errors detected in file DBD$RECOVERY.:E05TSI    .
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:43   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:44   
          MINI XREF LISTING

ASDT
      6953**DCL      7077<<ASSIGN   7138--CALL
BOOTTRACKS
      7022**DCL      7168<<ASSIGN   7169--CALL
BOOTUTS
      7014**DCL      7089<>CALL     7093>>ASSIGN   7095--ASSIGN   7109--CALL
CPU_INFO
      7002**DCL      7079<>CALL     7079--CALL     7079--CALL
CPU_INFO.BOOTUTS
      7009**DCL      7089<>CALL
CPU_INFO.INTRVL_TYPE
      7008**DCL      7084<>CALL
CPU_INFO.TICKS
      7008**DCL      7091<>CALL
CPU_INFO.UTS
      7008**DCL      7090<>CALL
CUN
      6959**DCL      7074<>CALL     7115--CALL
CURRUTS
      7015**DCL      7090<>CALL     7093<<ASSIGN   7093>>ASSIGN   7098--ASSIGN   7109--CALL
DAF$INIT
      6573**DCL-ENT  7052--CALL
DAF$UPDLNCNT
      6575**DCL-ENT  7065--CALL
DAF$WRITE
      6574**DCL      7071>>CALL     7109>>CALL     7111>>CALL     7115>>CALL     7138>>CALL     7169>>CALL
DAF_DCB#
       304**DCL      7063>>ASSIGN
DA_ANLZERR
        19**DCL      7044<<ASSIGN
DA_ANLZERR.CODE
        19**DCL      7045<<ASSIGN
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:45   
DA_DUMPFILE
        39**DCL      7042>>IF
DA_FMTSEG.P
       305**DCL       305--REDEF
DA_MAPSEG.P
        49**DCL        50--REDEF
DA_SDASN.DESC.TYPE0
        34**DCL        34--REDEF
DA_TIGRSEG.P
        50**DCL        51--REDEF
DBB$TSA
      6576**DCL-ENT  7139--CALL
DBD$INTCON_ACTIVE
      6577**DCL-ENT  7113--CALL
DBD$SPY_RCV
      6578**DCL-ENT  7117--CALL
DBM$GETMEM
      6584**DCL-ENT  7054--CALL     7079--CALL     7101--CALL     7122--CALL
DBM$PACK
      6579**DCL-ENT  7152--CALL
DBM$PACK2
      6582**DCL-ENT  7070--CALL     7074--CALL     7084--CALL     7091--CALL     7103--CALL
DBM$PACK4
      6583**DCL-ENT  7075--CALL     7089--CALL     7090--CALL     7128--CALL     7140--CALL
DBM$PACKB
      6580**DCL-ENT  7067--CALL
DBM$READ_PAGE
      6587**DCL-ENT  7165--CALL
DBM$SETLIB_SYM
      6586**DCL-ENT  7131--CALL
DBM$SETSYMBOLS
      6585**DCL-ENT  7134--CALL     7149--CALL
DB_CURRENT_USER
      6590**DCL      7115--CALL     7127>>ASSIGN   7138--CALL
DB_MONASDT.BASE
      6593**DCL      7077>>ASSIGN
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:46   
DMN
      6956**DCL      7103<>CALL     7104>>IF       7105>>ASSIGN   7106>>CALLBLT
DMN$
      6912**DCL      7101<>CALL
DMN_BUF
      6957**DCL      7101<>CALL     7103<>CALL
DMN_WHO
      6899**DCL      7105>>ASSIGN
DUMPHIGH
      7020**DCL      7154<<ASSIGN   7159<<ASSIGN   7164<<ASSIGN   7164>>ASSIGN   7165<>CALL
DUMPMAP
      7018**DCL      7152<>CALL     7156>>IF
DUMPSIZE
      7019**DCL      7153<<ASSIGN   7158<<ASSIGN   7158>>ASSIGN   7167>>ASSIGN   7169--CALL
DUMPSIZEFMT
      7024**DCL      7169--CALL
DUMPTRACKS
      7021**DCL      7167<<ASSIGN   7168>>ASSIGN   7169--CALL
ERRBUF
      6778**DCL      7062--ASSIGN
FLAGS
      6949**DCL      7067<>CALL
FLAGS.BADPPUT
      6950**DCL      7068>>IF
FPT_ERRMSG
      6610**DCL      7064<>CALL
FPT_ERRMSG.BUF_
      6610**DCL      7062<<ASSIGN
FPT_ERRMSG.V
      6614**DCL      6610--DCLINIT
FPT_ERRMSG.V.OUTDCB1#
      6615**DCL      7063<<ASSIGN
FPT_TIME
      6791**DCL      7096<>CALL     7099<>CALL
FPT_TIME.TSTAMP_
      6794**DCL      7095<<ASSIGN   7098<<ASSIGN
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:47   
FPT_TIME.V
      6795**DCL      6791--DCLINIT
G_INTRVL_TXT
      6895**DCL      7086>>ASSIGN
I
      6952**DCL      7070<>CALL     7071--CALL     7155<<DOINDEX  7156>>IF       7159>>ASSIGN
INTERVAL_FMT
      6876**DCL      7111--CALL
INTERVAL_TYPE
      7013**DCL      7084<>CALL     7085>>IF       7086>>ASSIGN   7087>>CALLBLT
INTV_TYPE
      6955**DCL      7086<<ASSIGN   7087<<CALLBLT  7111--CALL
LIB_START
      6910**DCL      7129>>IF
M$ERRMSG
      5869**DCL-ENT  7064--CALL
M$TIME
      5873**DCL-ENT  7096--CALL     7099--CALL
MHJIT_CUN$
      6914**DCL      7079<>CALL
MON_TSA$
      6913**DCL      7125>>IF
P$
      6961**DCL      7128<>CALL     7129>>IF
PPUTBAD
      6868**DCL      7071--CALL
REPORT
      6817**DCL      7052<>CALL
REPORTTX00
      6860**DCL      6847--DCLINIT
RVBUF
      6929**DCL      7054<>CALL     7054--CALL     7054--CALL
RVBUF.BADPPX
      6947**DCL      7070<>CALL
RVBUF.CUN
      6947**DCL      7074<>CALL
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:48   
RVBUF.DUMPMAP
      6934**DCL      7152<>CALL
RVBUF.FLAGS
      6937**DCL      7067<>CALL
RVBUF.SCODE
      6945**DCL      7059<>CALL
RVBUF.TSA$
      6947**DCL      7075<>CALL
RVBUF$
      6909**DCL      7054<>CALL
SCODE
      6700**DCL      6610--DCLINIT  7059<>CALL     7060>>ASSIGN
SCODE.MON
      6729**DCL      7061>>ASSIGN
SCODEM
      6745**DCL      6614--DCLINIT  7060<<ASSIGN
SCODEM.MON
      6774**DCL      7061<<ASSIGN
SCRMSG
      6651**DCL      6611--DCLINIT
SYSACCT
      6664**DCL      6611--DCLINIT
SYSID
      6958**DCL      7119<<ASSIGN   7127<<ASSIGN   7131<>CALL     7134<>CALL     7147>>IF
TICKS
      7016**DCL      7091<>CALL     7092<<ASSIGN   7092>>ASSIGN   7093>>ASSIGN
TIME_FMT
      6870**DCL      7109--CALL
TSA$
      6960**DCL      7075<>CALL     7122<>CALL     7125>>IF       7138--CALL     7140<>CALL     7143<<ASSIGN
TSABUF
      6963**DCL      7122<>CALL     7122--CALL     7139<>CALL     7140<>CALL
TSABUF.P
      6970**DCL      7128<>CALL
TSA_FMT
      6879**DCL      7138--CALL
PL6.E3A0      #001=DBD$RECOVERY File=DBD$RECOVERY.:E05TSI                        TUE 07/29/97 13:08 Page:49   
USER_FMT
      6873**DCL      7115--CALL
VLR_ERRMSG
      6677**DCL      6614--DCLINIT
WHO
      6954**DCL      7105<<ASSIGN   7106<<CALLBLT  7111--CALL
XUR$ERRCNVRT
      6588**DCL-ENT  7059--CALL
