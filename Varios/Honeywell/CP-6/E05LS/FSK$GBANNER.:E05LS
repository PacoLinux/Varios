VERSION E05

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:1    
        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        FSK$GBANNER: PROC (GFORM, GWRSP, BUFFA, WORKA) ALTRET;
        7        7        %INCLUDE FS_SUPER_C;
        8      770        %INCLUDE XG_SUBS_C;
        9     1264
       10     1265        %FS$GFORMREC (NAME=GFORM,
       11     1266                      STCLASS="");
       12     1325        %FS$GWRSP    (NAME=GWRSP,
       13     1326                      STCLASS="");
       14     1350        %FS$WORKAUTO (NAME=WORKA,
       15     1351                      STCLASS="");
       16     1370    1   DCL 1 BUFFA,
       17     1371    1         2 VFC CHAR (1) UNAL,
       18     1372    1         2 TEXT CHAR (255) UNAL,
       19     1373    1         2 TEXT3 REDEF TEXT,
       20     1374    1            3 OPCODE,
       21     1375    1               4 CLASS UBIN (9) UNAL,
       22     1376    1               4 INDX UBIN (9) UNAL,
       23     1377    1            3 NUM_CHARS UBIN (18) UNAL,
       24     1378    1            3 CHAR_ENTRY (0:34),
       25     1379    1               4 CHARACTER CHAR (1) UNAL,
       26     1380    1               4 X UBIN (18) UNAL,
       27     1381    1               4 Y UBIN (18) UNAL,
       28     1382    1               4 Z UBIN (18) UNAL,
       29     1383    1            3 * CHAR (6);
       30     1384
       31     1385    1   DCL ENTDISP$ PTR ALIGNED;
       32     1386        %FS$GRAPHIC_BANNER (NAME=GBAN,
       33     1387                           STCLASS="BASED(ENTDISP$)");
       34     1444
       35     1445        %INCLUDE B$JIT_C;
       36     1759           %B$JIT0;
       37     1848           %U$JIT1;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:2    
       38     1922           %A$JIT6X;
       39     1925    1   DCL B$JIT$ PTR SYMREF;
       40     1926        %INCLUDE UM_CP6;
       41     2778        %VLR_SITEINFO (FPTN=SITEINFO,
       42     2779                       STCLASS=BASED);
       43     2798
       44     2799        %INCLUDE FS$FIT;
       45     2842        %FS_OSFN(STCLASS=BASED);
       46     2856        %INCLUDE F$DCB;
       47     2905        %INCLUDE FM$FIT;
       48     3126        %CODE16;
       49     3134    1   DCL FSK$GETBANNERTEXT ENTRY (4) ALTRET;
       50     3135
       51     3136    1   DCL 1 BEGIN_PICTURE_CMD CONSTANT,
       52     3137    1         2 OPCODE,
       53     3138    1            3 CLASS UBIN (9) UNAL INIT (%XG_COOP_CONTROL#),
       54     3139    1            3 INDX UBIN (9) UNAL INIT (%XG_COOP_BEGIN_PICTURE#),
       55     3140    1         2 REVISION UBIN (18) UNAL INIT (%XG_COOP_REVISION_LEVEL#),
       56     3141    1         2 PRECISION UBIN (9) UNAL INIT (%XG_COOP_COORD_PRECISION#),
       57     3142    1         2 SURFACE UBIN (9) UNAL INIT (1);
       58     3143    1   DCL BEGIN_PICTURE_CHAR REDEF BEGIN_PICTURE_CMD CHAR (6) UNAL;
       59     3144
       60     3145    1   DCL 1 SET_CHARPRECISION_CMD CONSTANT,
       61     3146    1         2 OPCODE,
       62     3147    1            3 CLASS UBIN (9) UNAL INIT (%XG_COOP_ATTR_BAS_NONE_2#),
       63     3148    1            3 INDX UBIN (9) UNAL INIT (%XG_COOP_SET_CHARPRECISION#),
       64     3149    1         2 CHAR_PRECISION UBIN (9) UNAL INIT (2);
       65     3150    1   DCL SET_CHARPRECISION_CHAR REDEF SET_CHARPRECISION_CMD CHAR (3) UNAL;
       66     3151
       67     3152    1   DCL 1 NEW_FRAME_CMD CONSTANT,
       68     3153    1         2 CLASS UBIN (9) UNAL INIT (%XG_COOP_CONTROL#),
       69     3154    1         2 INDX UBIN (9) UNAL INIT (%XG_COOP_NEW_FRAME#);
       70     3155    1   DCL NEW_FRAME_CHAR REDEF NEW_FRAME_CMD CHAR (2) UNAL;
       71     3156
       72     3157    1   DCL BANREC$ PTR ALIGNED;
       73     3158    1   DCL CHAR$ PTR ALIGNED;
       74     3159    1   DCL BIGGEST SBIN;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:3    
       75     3160    1   DCL I UBIN;
       76     3161    1   DCL START_POS UBIN;
       77     3162    1   DCL RDFLAG BIT (1);
       78     3163    1   DCL XCOORD UBIN (18) ALIGNED;
       79     3164    1   DCL YCOORD UBIN (18) ALIGNED;
       80     3165    1   DCL ZCOORD UBIN (18) ALIGNED;
       81     3166    1   DCL TEXT CHAR (256) BASED;
       82     3167    1   DCL TEXT2 (0:0) CHAR (1) BASED;
       83     3168    1   DCL 1 FEP HALIGNED,
       84     3169    1         2 * BIT (1) UNAL,
       85     3170    1         2 U BIT (8) UNAL,
       86     3171    1         2 * BIT (1) UNAL,
       87     3172    1         2 L BIT (8) UNAL;
       88     3173    1   DCL FEP18 REDEF FEP UBIN (18) HALIGNED;
       89     3174
       90     3175    1   DCL 1 HOST HALIGNED,
       91     3176    1         2 * BIT (2) UNAL,
       92     3177    1         2 U BIT (8) UNAL,
       93     3178    1         2 L BIT (8) UNAL;
       94     3179    1   DCL HOST18 REDEF HOST UBIN (18) HALIGNED;
       95     3180
       96     3181    1   DCL 1 CHAR_ENTRY BASED UNAL,
       97     3182    1         2 CHARACTER CHAR (1) UNAL,
       98     3183    1         2 X UBIN (18) UNAL,
       99     3184    1         2 Y UBIN (18) UNAL,
      100     3185    1         2 Z UBIN (18) UNAL;
      101     3186
      102     3187    1   IF GWRSP.START = 0      /* VERY FIRST CALL- INITIALIZE VARIABLES */
      103     3188    2   THEN DO;
      104     3189    2      GWRSP.ENTDISP$ = PINCRW (ADDR(GFORM),GWRSP.ENTDISP);
      105     3190    2      ENTDISP$ = GWRSP.ENTDISP$;
      106     3191    2      GWRSP.REPEATS = GBAN.REPEATS;             /*COUNTER FOR #PAGES*/
      107     3192    2      GWRSP.CUR_ENT = 0;      /* CURRENT ENTRY 0 MEANS BEGIN A NEW PAGE*/
      108     3193    2      GWRSP.LINE_CNT = 0;  /* LINE COUNT FOR THIS PARTICULAR ENTRY  */
      109     3194    2      RDFLAG ='0'B;
      110     3195    2        GWRSP.DATE = 'MM/DD/YY';
      111     3196    2        GWRSP.TIME = 'HH:MM';
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:4    
      112     3197    2      IF (GWRSP.ENTDISP ~= GFORM.ALGNDISP)
      113     3198    3      THEN DO; /* DONT CALL DATE TIME ROUTINE IF DOING ALIGNMENT */
      114     3199    3        IF GWRSP.DATE_TIME ~= ENTADDR(NIL)
      115     3200    3        THEN
      116     3201    3         CALL GWRSP.DATE_TIME(GWRSP.DATE,GWRSP.TIME)  /* SETTUM */
      117     3202    4         WHENALTRETURN DO;
      118     3203    4            END;
      119     3204    3         END;
      120     3205    2      GWRSP.START = 1;
      121     3206    2      END;
      122     3207
      123     3208    1      BANREC$ = PINCRC (ADDR(WORKA), SIZEC(WORKA));
      124     3209    1   BUFFA.VFC = BITASC ('036'O);
      125     3210    1   ENTDISP$ = GWRSP.ENTDISP$;     /* GEN BETTER CODE */
      126     3211    1   BIGGEST = MAXIMUM (GFORM.X_SIZE, GFORM.Y_SIZE, GFORM.Z_SIZE);
      127     3212    1   IF ((BIGGEST = 0) OR (GFORM.X_SIZE + GFORM.Y_SIZE +
      128     3213    1       GFORM.Z_SIZE = BIGGEST))
      129     3214    2   THEN DO;
      130     3215              /* IF THE LARGEST VALUE FOR ALL 3 AXIS IS 0 OR THE
      131     3216                 VALUE OF 2 AXIS SIZES IS = 0 THEN THERE SHALL
      132     3217                 BE NO BANNER.  SEND THE DEVICE LIMITS CMD AND
      133     3218                 TERMINATE CALLS TO THIS ROUTINE.
      134     3219              */
      135     3220    2      GWRSP.CUR_ENT = 0;
      136     3221    2      GWRSP.LINE_CNT = 0;
      137     3222    2      ENTDISP$ = ADDR (GFORM);
      138     3223    2      END;
      139     3224
      140     3225    1   IF GWRSP.CUR_ENT = 0
      141     3226    2   THEN DO;
      142     3227    3      DO CASE (GWRSP.LINE_CNT);
      143     3228    3         CASE (0);            /* NO LINES FOR THIS PAGE YET           */
      144     3229    3            IF ENTDISP$ = ADDR (GFORM)
      145     3230    4            THEN DO;          /* ENTRIES = 0 (ENTDISP WAS 0) */
      146     3231    4               BUFFA.TEXT = GFORM.SET_DEV_LIM_CMD;
      147     3232    4               GWRSP.MAXBYTES = SIZEC (GFORM.SET_DEV_LIM_CMD);
      148     3233    4               GWRSP.LINE_CNT = 4;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:5    
      149     3234    4               END;
      150     3235    4            ELSE DO;
      151     3236    4               GWRSP.START = 1;
      152     3237    4               BUFFA.VFC = 'p';
      153     3238    4               BUFFA.TEXT = BEGIN_PICTURE_CHAR;
      154     3239    4               GWRSP.MAXBYTES = SIZEC (BEGIN_PICTURE_CHAR);
      155     3240    4               GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;
      156     3241    4               END;
      157     3242    3         CASE (1);
      158     3243    3            BUFFA.TEXT = GFORM.SET_DEV_LIM_CMD;
      159     3244    3            GWRSP.MAXBYTES = SIZEC (GFORM.SET_DEV_LIM_CMD);
      160     3245    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;
      161     3246    3         CASE (2);
      162     3247    3            BUFFA.TEXT = SET_CHARPRECISION_CHAR;
      163     3248    3            GWRSP.MAXBYTES = SIZEC (SET_CHARPRECISION_CHAR);
      164     3249    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;
      165     3250    3            GWRSP.CUR_ENT = 1;
      166     3251    3            GWRSP.LINE_CNT = 0;
      167     3252    3         CASE (3);  /* THIS IS THE END OF A PAGE, FINISH UP! */
      168     3253    3            BUFFA.TEXT = NEW_FRAME_CHAR;
      169     3254    3            GWRSP.MAXBYTES = SIZEC (NEW_FRAME_CHAR);
      170     3255    3            IF GWRSP.REPEATS = 0
      171     3256    4            THEN DO;
      172     3257    4               GWRSP.LINE_CNT = 4;
      173     3258    4               END;
      174     3259    4            ELSE DO;
      175     3260    4               GWRSP.CUR_ENT = 0;
      176     3261    4               GWRSP.LINE_CNT = 0;
      177     3262    4               END;
      178     3263    3         CASE (4);   /* This is the end, we are all done! */
      179     3264    3            GWRSP.START = -1;
      180     3265    3         CASE (ELSE);
      181     3266                 /* THIS CASE SHOULD NEVER BE ENTERED; IF IT IS - BOY DID I
      182     3267                    MESS UP!!!!! */
      183     3268    3         END; /* DO CASE ON GWRSP.LINE_CNT */
      184     3269    2      END; /* IF GWRSP.CUR_ENT = 0 */
      185     3270    2   ELSE DO;                   /* DO ENTRIES, GWRSP.CUR_ENT <> 0 */
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:6    
      186     3271    3      DO CASE (GWRSP.LINE_CNT);
      187     3272    3         CASE (0);
      188     3273    3            BUFFA.TEXT = GBAN.ENTRIES.SET_CHARSIZE_CMD (GWRSP.CUR_ENT-1);
      189     3274    3            GWRSP.MAXBYTES = SIZEC (GBAN.ENTRIES.SET_CHARSIZE_CMD (GWRSP.CUR_ENT - 1));
      190     3275    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;
      191     3276    3         CASE (1);
      192     3277    3            BUFFA.TEXT = GBAN.ENTRIES.SET_CHARSPACE_CMD (GWRSP.CUR_ENT-1);
      193     3278    3            GWRSP.MAXBYTES = SIZEC (GBAN.ENTRIES.SET_CHARSPACE_CMD (GWRSP.CUR_ENT - 1))
              3278                     ;
      194     3279    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;
      195     3280    3         CASE (2);
      196     3281    3            BUFFA.TEXT = GBAN.ENTRIES.SET_CHARUP_CMD (GWRSP.CUR_ENT - 1);
      197     3282    3            GWRSP.MAXBYTES = SIZEC (GBAN.ENTRIES.SET_CHARUP_CMD (GWRSP.CUR_ENT - 1));
      198     3283    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;
      199     3284    3         CASE (3);  /* THIS IS WHERE THE ACTUAL ENTRY IS FIRST HANDLED */
      200     3285                 /* PUT ENTRIES TEXT INTO WORK AREA AND INIT TEXT 3 CMD */
      201     3286    4            DO CASE (GBAN.ENTRIES.TYPE (GWRSP.CUR_ENT - 1));
      202     3287    4               CASE(FS_PLAIN_TEXT);
      203     3288    4                   CHAR$ = PINCRW (ADDR (GBAN), GBAN.ENTRIES.DISP (GWRSP.CUR_ENT - 1));
      204     3289    4                   WORKA.TWORK.COUNT = GBAN.ENTRIES.COUNT (GWRSP.CUR_ENT - 1);
      205     3290    4                   WORKA.TWORK.TEXT = SUBSTR (CHAR$->TEXT,0,WORKA.TWORK.COUNT);
      206     3291    4               CASE(FS_X_INT);
      207     3292    4                   CHAR$ = ADDR (WORKA.TWORK.TEXT);
      208     3293    4                   WORKA.TWORK.COUNT = SIZEC(WORKA.TWORK.TEXT);
      209     3294    5                   DO I = 0 TO WORKA.TWORK.COUNT-1;
      210     3295    5                     CHAR$->TEXT2(I) = GBAN.ENTRIES.CHR(GWRSP.CUR_ENT-1);
      211     3296    5                     END;
      212     3297    4               CASE(FS_SYSID_INT);
      213     3298    4                   WORKA.TWORK.COUNT = 6;
      214     3299    4                   I = GWRSP.JIT$->B$JIT.SYSID;
      215     3300    4                   CALL BINCHAR(SUBSTR(WORKA.TWORK.TEXT,0,6),I);
      216     3301    4               CASE(FS_ACCN_INT);
      217     3302    4                   WORKA.TWORK.COUNT = SIZEC(B$JIT.ACCN);
      218     3303    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(B$JIT.ACCN),GWRSP.JIT$->B$JIT.
              3303                            ACCN);
      219     3304    4               CASE(FS_UNAME_INT);
      220     3305    4                   WORKA.TWORK.COUNT = SIZEC(B$JIT.UNAME);
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:7    
      221     3306    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(B$JIT.UNAME),GWRSP.JIT$->B$JIT.
              3306                            UNAME);
      222     3307    4               CASE(FS_WOO_INT);
      223     3308    4                   WORKA.TWORK.COUNT = 1+SIZEC(B$JIT.WOO);
      224     3309    4                   CALL INSERT(WORKA.TWORK.TEXT,0,1+SIZEC(B$JIT.WOO),GWRSP.JIT$->B$JIT.
              3309                            WOO);
      225     3310    4               CASE(FS_JOBNAME_INT);
      226     3311    4                   WORKA.TWORK.COUNT = SIZEC(B$JIT.JOBNAME);
      227     3312    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(B$JIT.JOBNAME),B$JIT.JOBNAME);
      228     3313    4               CASE(FS_TIME_INT);
      229     3314    4                   WORKA.TWORK.COUNT = 5;
      230     3315    4                   CALL INSERT(WORKA.TWORK.TEXT,0,5,GWRSP.TIME);
      231     3316    4               CASE(FS_DATE_INT);
      232     3317    4                   WORKA.TWORK.COUNT = 8;
      233     3318    4                   CALL INSERT(WORKA.TWORK.TEXT,0,8,GWRSP.DATE);
      234     3319    4               CASE(FS_SUBFILE_INT);
      235     3320    4                   WORKA.TWORK.COUNT = 6;
      236     3321    4                   CALL INSERT(WORKA.TWORK.TEXT,0,6,ADDR(GWRSP.SUBFILE$->F$DCB.NAME)->
              3321                            FS_OSFN.NUM);
      237     3322    4               CASE(FS_VERSION_INT);
      238     3323    4                   WORKA.TWORK.COUNT = SIZEC(SITEINFO.VERSION#);
      239     3324    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(SITEINFO.VERSION#),GWRSP.
              3324                            SITEINFO->SITEINFO.VERSION#);
      240     3325    4               CASE(FS_SITENAME_INT);
      241     3326    4                   WORKA.TWORK.COUNT = GWRSP.SITEINFO->SITEINFO.
      242     3327    4                        SITE_NAME#.L;
      243     3328    4                   CALL INSERT(WORKA.TWORK.TEXT,0,WORKA.TWORK.COUNT,GWRSP.SITEINFO->
              3328                            SITEINFO.SITE_NAME#.C);
      244     3329    4               CASE(FS_SALUTE_INT);
      245     3330    4                   WORKA.TWORK.COUNT = GWRSP.SITEINFO->SITEINFO.
      246     3331    4                        SALUTATION#.L;
      247     3332    4                   CALL INSERT(WORKA.TWORK.TEXT,0,WORKA.TWORK.COUNT,GWRSP.SITEINFO->
              3332                            SITEINFO.SALUTATION#.C);
      248     3333    4               CASE(FS_WOD_INT);
      249     3334    4                   WORKA.TWORK.COUNT = SIZEC(F$DCB.WSN);
      250     3335    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(F$DCB.WSN),GWRSP.SUBFILE$->
              3335                            F$DCB.WSN);
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:8    
      251     3336    4               CASE(FS_FORM_INT);
      252     3337    4                   WORKA.TWORK.COUNT = SIZEC(CODE16.FORM);
      253     3338    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(CODE16.FORM),GWRSP.SUBFILE$->
              3338                            F$DCB.FORM$->CODE16.FORM);
      254     3339    4               CASE(FS_MINI_ID_INT);
      255     3340    4                   WORKA.TWORK.COUNT = SIZEC(SITEINFO.MINI_ID#);
      256     3341    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(SITEINFO.MINI_ID#),GWRSP.
              3341                            SITEINFO->SITEINFO.MINI_ID#);
      257     3342    4               CASE( FS_BANNERTEXT0_INT, FS_REGISTEREDNAME_INT );
      258     3343    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 0)
      259     3344    5                   WHENALTRETURN DO;
      260     3345    5                        WORKA.TWORK.TEXT = ' ';
      261     3346    5                        WORKA.TWORK.COUNT = 1;
      262     3347    5                      END;
      263     3348    4               CASE( FS_BANNERTEXT1_INT );
      264     3349    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 1)
      265     3350    5                   WHENALTRETURN DO;
      266     3351    5                        WORKA.TWORK.TEXT = ' ';
      267     3352    5                        WORKA.TWORK.COUNT = 1;
      268     3353    5                      END;
      269     3354    4               CASE( FS_BANNERTEXT2_INT );
      270     3355    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 2)
      271     3356    5                   WHENALTRETURN DO;
      272     3357    5                        WORKA.TWORK.TEXT = ' ';
      273     3358    5                        WORKA.TWORK.COUNT = 1;
      274     3359    5                      END;
      275     3360    4               CASE( FS_BANNERTEXT3_INT );
      276     3361    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 3)
      277     3362    5                   WHENALTRETURN DO;
      278     3363    5                        WORKA.TWORK.TEXT = ' ';
      279     3364    5                        WORKA.TWORK.COUNT = 1;
      280     3365    5                      END;
      281     3366    4               CASE( FS_BANNERTEXT4_INT );
      282     3367    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 4)
      283     3368    5                   WHENALTRETURN DO;
      284     3369    5                        WORKA.TWORK.TEXT = ' ';
      285     3370    5                        WORKA.TWORK.COUNT = 1;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:9    
      286     3371    5                      END;
      287     3372    4               CASE( FS_BANNERTEXT5_INT );
      288     3373    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 5)
      289     3374    5                   WHENALTRETURN DO;
      290     3375    5                        WORKA.TWORK.TEXT = ' ';
      291     3376    5                        WORKA.TWORK.COUNT = 1;
      292     3377    5                      END;
      293     3378    4               CASE( FS_BANNERTEXT6_INT );
      294     3379    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 6)
      295     3380    5                   WHENALTRETURN DO;
      296     3381    5                        WORKA.TWORK.TEXT = ' ';
      297     3382    5                        WORKA.TWORK.COUNT = 1;
      298     3383    5                      END;
      299     3384    4               CASE( FS_BANNERTEXT7_INT );
      300     3385    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 7)
      301     3386    5                   WHENALTRETURN DO;
      302     3387    5                        WORKA.TWORK.TEXT = ' ';
      303     3388    5                        WORKA.TWORK.COUNT = 1;
      304     3389    5                      END;
      305     3390    4               CASE( FS_BANNERTEXT8_INT );
      306     3391    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 8)
      307     3392    5                   WHENALTRETURN DO;
      308     3393    5                        WORKA.TWORK.TEXT = ' ';
      309     3394    5                        WORKA.TWORK.COUNT = 1;
      310     3395    5                      END;
      311     3396    4               CASE( FS_BANNERTEXT9_INT );
      312     3397    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 9)
      313     3398    5                   WHENALTRETURN DO;
      314     3399    5                        WORKA.TWORK.TEXT = ' ';
      315     3400    5                        WORKA.TWORK.COUNT = 1;
      316     3401    5                      END;
      317     3402    4               END;  /* DO CASE ON ENTRIES */
      318     3403                 /* SET THE DELTA VALUES - SINCE THE STRING IS ALWAYS GOING
      319     3404                   TO BE WRITTEN TO THE RIGHT, THIS BECOMES EASY.    */
      320     3405    3            GWRSP.DELTA_Y = 0;
      321     3406    3            GWRSP.DELTA_Z = 0;
      322     3407    3            CALL SPLIT9X92_18 (GBAN.ENTRIES.CHARSIZE.CHAR_HITE
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:10   
      323     3408    3                              (GWRSP.CUR_ENT - 1));
      324     3409    3            GWRSP.DELTA_X = HOST18;
      325     3410    3            CALL SPLIT9X92_18 (GBAN.ENTRIES.CHARSPACE.CHAR_SPACE
      326     3411    3                              (GWRSP.CUR_ENT - 1));
      327     3412    3            GWRSP.DELTA_X = GWRSP.DELTA_X + HOST18;
      328     3413    3            GWRSP.X_MAX = (GFORM.X_SIZE * %XG_DEFAULT_MAX_NDC#) / BIGGEST;
      329     3414    3            GWRSP.Y_MAX = (GFORM.Y_SIZE * %XG_DEFAULT_MAX_NDC#) / BIGGEST;
      330     3415    3            GWRSP.Z_MAX = (GFORM.Z_SIZE * %XG_DEFAULT_MAX_NDC#) / BIGGEST;
      331     3416    3            GWRSP.X_MAX = GWRSP.X_MAX - GWRSP.DELTA_X;
      332     3417    3            GWRSP.Y_MAX = GWRSP.Y_MAX - GWRSP.DELTA_Y;
      333     3418    3            GWRSP.Z_MAX = GWRSP.Z_MAX - GWRSP.DELTA_Z;
      334     3419    3            BUFFA.TEXT3.OPCODE.CLASS = %XG_COOP_OUTPUT_3#;
      335     3420    3            BUFFA.TEXT3.OPCODE.INDX = %XG_COOP_TEXT_3#;
      336     3421    3            GWRSP.LINE_CNT = 0;
      337     3422    3            GWRSP.CHAR_CNT = 0;    /* NUM OF CHAR TO PRINT */
      338     3423    4            DO I = 0 TO WORKA.TWORK.COUNT - 1;
      339     3424    4               IF I <= 35      /* 35 = MAX CHAR ENTRIES TO FIT IN BUFF */
      340     3425    5               THEN DO;
      341     3426    5                  CALL SPLIT9X92_18 (GBAN.ENTRIES.NDC_X_VAL (GWRSP.CUR_ENT - 1));
      342     3427    5                  XCOORD = ( I * GWRSP.DELTA_X) + HOST18;
      343     3428    5                  CALL SPLIT9X92_18 (GBAN.ENTRIES.NDC_Y_VAL (GWRSP.CUR_ENT - 1));
      344     3429    5                  YCOORD = ( I * GWRSP.DELTA_Y) + HOST18;
      345     3430    5                  CALL SPLIT9X92_18 (GBAN.ENTRIES.NDC_Z_VAL (GWRSP.CUR_ENT - 1));
      346     3431    5                  ZCOORD = ( I * GWRSP.DELTA_Z) + HOST18;
      347     3432    5                  IF ((XCOORD > GWRSP.X_MAX) OR (YCOORD > GWRSP.Y_MAX) OR
      348     3433    5                      (ZCOORD > GWRSP.Z_MAX) )
      349     3434    6                  THEN DO;
      350     3435    6                     GWRSP.CHAR_CNT = 0;
      351     3436    6                     IF I > 0
      352     3437    7                     THEN DO;
      353     3438    7                        GWRSP.CHAR_CNT = I - 1;/* THIS ENTRY DONE */
      354     3439    7                        END;
      355     3440    6                     I = 9999;  /* CAUSE EXIT FROM LOOP DOING AN ENTRY */
      356     3441    6                     END;
      357     3442    6                  ELSE DO;
      358     3443    6                     CALL SPLIT182_9X9 (XCOORD);
      359     3444    6                     BUFFA.TEXT3.CHAR_ENTRY.X (I) = FEP18;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:11   
      360     3445    6                     CALL SPLIT182_9X9 (YCOORD);
      361     3446    6                     BUFFA.TEXT3.CHAR_ENTRY.Y (I) = FEP18;
      362     3447    6                     CALL SPLIT182_9X9 (ZCOORD);
      363     3448    6                     BUFFA.TEXT3.CHAR_ENTRY.Z (I) = FEP18;
      364     3449    6                     BUFFA.TEXT3.CHAR_ENTRY.CHARACTER (I) =
      365     3450    6                        SUBSTR (WORKA.TWORK.TEXT, I, 1);
      366     3451    6                     GWRSP.CHAR_CNT = GWRSP.CHAR_CNT + 1;
      367     3452    6                     END;
      368     3453    5                  END;
      369     3454    5               ELSE DO;
      370     3455    5                  GWRSP.CHAR_CNT = I - 1;
      371     3456    5                  GWRSP.LINE_CNT = 4; /* THIS MEANS CONTINUE THE LINE */
      372     3457    5                  GWRSP.CUR_ENT = GWRSP.CUR_ENT - 1; /* CONTINUE */
      373     3458    5                  I = WORKA.TWORK.COUNT;
      374     3459    5                  END;
      375     3460    4               END;   /* DO WHILE */
      376     3461
      377     3462    3            GWRSP.CUR_ENT = GWRSP.CUR_ENT + 1;
      378     3463    3            CALL SPLIT182_9X9 (GWRSP.CHAR_CNT);
      379     3464    3            BUFFA.TEXT3.NUM_CHARS = FEP18;
      380     3465    3            GWRSP.MAXBYTES = 4 + (GWRSP.CHAR_CNT * SIZEC (CHAR_ENTRY));
      381     3466    3            IF (GWRSP.CUR_ENT - 1) = GBAN.NUM_ENTRIES
      382     3467    4            THEN DO;    /* FINISHED ALL THE ENTRIES FOR THISA PAGE */
      383     3468    4               GWRSP.REPEATS = GWRSP.REPEATS - 1;
      384     3469    4               GWRSP.LINE_CNT = 3; /* END PIX IN 1ST DO CASE */
      385     3470    4               GWRSP.CUR_ENT = 0;
      386     3471    4               END;
      387     3472    3         CASE (4);   /* THIS IS MIDDLE OF CHARACTER LOOP, LINE_CNT=4 */
      388     3473    3            BUFFA.TEXT3.OPCODE.CLASS = %XG_COOP_OUTPUT_3#;
      389     3474    3            BUFFA.TEXT3.OPCODE.INDX = %XG_COOP_TEXT_3#;
      390     3475    3            START_POS = GWRSP.CHAR_CNT;
      391     3476    3            GWRSP.LINE_CNT = 0;
      392     3477    3            GWRSP.CHAR_CNT = 0;    /* NUM OF CHAR TO PRINT */
      393     3478    4            DO I = 0 TO WORKA.TWORK.COUNT - 1 - START_POS;
      394     3479    4               IF I <= 35      /* 35 = MAX CHAR ENTRIES TO FIT IN BUFF */
      395     3480    5               THEN DO;
      396     3481    5                  XCOORD = ((I + START_POS) * GWRSP.DELTA_X) + GBAN.ENTRIES.NDC_X_VAL (
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:12   
              3481                           GWRSP.CUR_ENT-1);
      397     3482    5                  YCOORD = ((I + START_POS) * GWRSP.DELTA_Y) + GBAN.ENTRIES.NDC_Y_VAL (
              3482                           GWRSP.CUR_ENT-1);
      398     3483    5                  ZCOORD = ((I + START_POS) * GWRSP.DELTA_Z) + GBAN.ENTRIES.NDC_Z_VAL (
              3483                           GWRSP.CUR_ENT-1);
      399     3484    5                  IF ((XCOORD > GWRSP.X_MAX) OR (YCOORD > GWRSP.Y_MAX) OR
      400     3485    5                      (ZCOORD > GWRSP.Z_MAX) )
      401     3486    6                  THEN DO;
      402     3487    6                     GWRSP.CHAR_CNT = 0;
      403     3488    6                     IF I > 0
      404     3489    7                     THEN DO;
      405     3490    7                        GWRSP.CHAR_CNT = I - 1;/* THIS ENTRY DONE */
      406     3491    7                        END;
      407     3492    6                     I = 9999;  /* CAUSE EXIT FROM LOOP DOING AN ENTRY */
      408     3493    6                     END;
      409     3494    6                  ELSE DO;
      410     3495    6                     CALL SPLIT182_9X9 (XCOORD);
      411     3496    6                     BUFFA.TEXT3.CHAR_ENTRY.X (I) = FEP18;
      412     3497    6                     CALL SPLIT182_9X9 (YCOORD);
      413     3498    6                     BUFFA.TEXT3.CHAR_ENTRY.Y (I) = FEP18;
      414     3499    6                     CALL SPLIT182_9X9 (ZCOORD);
      415     3500    6                     BUFFA.TEXT3.CHAR_ENTRY.Z (I) = FEP18;
      416     3501    6                     BUFFA.TEXT3.CHAR_ENTRY.CHARACTER (I) =
      417     3502    6                        SUBSTR (WORKA.TWORK.TEXT, (I + START_POS), 1);
      418     3503    6                     GWRSP.CHAR_CNT = GWRSP.CHAR_CNT + 1;
      419     3504    6                     END;
      420     3505    5                  END;
      421     3506    5               ELSE DO;
      422     3507    5                  GWRSP.CHAR_CNT = I - 1;
      423     3508    5                  GWRSP.LINE_CNT = 4; /* THIS MEANS CONTINUE THE LINE */
      424     3509    5                  GWRSP.CUR_ENT = GWRSP.CUR_ENT - 1; /* CONTINUE */
      425     3510    5                  I = WORKA.TWORK.COUNT;
      426     3511    5                  END;
      427     3512    4               END;   /* DO WHILE */
      428     3513
      429     3514    3            GWRSP.CUR_ENT = GWRSP.CUR_ENT + 1;
      430     3515    3            CALL SPLIT182_9X9 (GWRSP.CHAR_CNT);
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:13   
      431     3516    3            BUFFA.TEXT3.NUM_CHARS = FEP18;
      432     3517    3            GWRSP.MAXBYTES = (GWRSP.CHAR_CNT * SIZEC (CHAR_ENTRY)) + 4;
      433     3518    3            IF (GWRSP.CUR_ENT - 1) = GBAN.NUM_ENTRIES
      434     3519    4            THEN DO;    /* FINISHED ALL THE ENTRIES FOR THISA PAGE */
      435     3520    4               GWRSP.REPEATS = GWRSP.REPEATS - 1;
      436     3521    4               GWRSP.LINE_CNT = 3; /* END PIX IN 1ST DO CASE */
      437     3522    4               GWRSP.CUR_ENT = 0;
      438     3523    4               END;
      439     3524    3         END; /* DO CASE */
      440     3525    2      END; /* THIS GETS US TO THE OUTERMOST LEVEL */
      441     3526    1   RETURN;
      442     3527        /* ROUTINE TO CONVERT A HOST 18 BIT TO A FEP 18 BIT */
      443     3528    1   SPLIT182_9X9: PROC (VALUE);
      444     3529    2   DCL VALUE UBIN (18) HALIGNED;
      445     3530
      446     3531    2   FEP18 = 0;
      447     3532    2   HOST18 = VALUE;
      448     3533    2   FEP.U = HOST.U;
      449     3534    2   FEP.L = HOST.L;
      450     3535    2   RETURN;
      451     3536    2   END SPLIT182_9X9;
      452     3537
      453     3538        /* ROUTINE TO CONVERT A FEP 18 BIT TO A HOST 18 BIT */
      454     3539    1   SPLIT9X92_18: PROC (VALUE);
      455     3540    2   DCL VALUE UBIN (18) HALIGNED;
      456     3541
      457     3542    2   FEP18 = VALUE;
      458     3543    2   HOST18 = 0;
      459     3544    2   HOST.U = FEP.U;
      460     3545    2   HOST.L = FEP.L;
      461     3546    2   RETURN;
      462     3547    2   END SPLIT9X92_18;
      463     3548
      464     3549    1   END FSK$GBANNER;

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:14   
--  Include file information  --

   FM$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   FS$FIT.:E05TOU  is referenced.
   UM_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   XG_SUBS_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FSK$GBANNER.

   Procedure FSK$GBANNER requires 1085 words for executable code.
   Procedure FSK$GBANNER requires 26 words of local(AUTO) storage.

    No errors detected in file FSK$GBANNER.:E05TSI    .

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:15   

 Object Unit name= FSK$GBANNER                                File name= FSK$GBANNER.:E05TOU
 UTS= JUL 29 '97 17:33:34.84 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0  RoData even  UTS      8     10  FSK$GBANNER
    1   Proc  even  none  1085   2075  FSK$GBANNER
    2  RoData even  none    20     24  FSK$GBANNER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     1      0   yes    yes     yes      Std        4  FSK$GBANNER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       4 FSK$GETBANNERTEXT
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     B$JIT$                                B_VECTNIL
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:16   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:17   


        1        1        /*T***********************************************************/
        2        2        /*T*                                                         */
        3        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        4        4        /*T*                                                         */
        5        5        /*T***********************************************************/
        6        6        FSK$GBANNER: PROC (GFORM, GWRSP, BUFFA, WORKA) ALTRET;

      6  1 000000   000000 700200 xent  FSK$GBANNER  TSX0  ! X66_AUTO_4
         1 000001   000032 000004                    ZERO    26,4

        7        7        %INCLUDE FS_SUPER_C;
        8      770        %INCLUDE XG_SUBS_C;
        9     1264
       10     1265        %FS$GFORMREC (NAME=GFORM,
       11     1266                      STCLASS="");
       12     1325        %FS$GWRSP    (NAME=GWRSP,
       13     1326                      STCLASS="");
       14     1350        %FS$WORKAUTO (NAME=WORKA,
       15     1351                      STCLASS="");
       16     1370    1   DCL 1 BUFFA,
       17     1371    1         2 VFC CHAR (1) UNAL,
       18     1372    1         2 TEXT CHAR (255) UNAL,
       19     1373    1         2 TEXT3 REDEF TEXT,
       20     1374    1            3 OPCODE,
       21     1375    1               4 CLASS UBIN (9) UNAL,
       22     1376    1               4 INDX UBIN (9) UNAL,
       23     1377    1            3 NUM_CHARS UBIN (18) UNAL,
       24     1378    1            3 CHAR_ENTRY (0:34),
       25     1379    1               4 CHARACTER CHAR (1) UNAL,
       26     1380    1               4 X UBIN (18) UNAL,
       27     1381    1               4 Y UBIN (18) UNAL,
       28     1382    1               4 Z UBIN (18) UNAL,
       29     1383    1            3 * CHAR (6);
       30     1384
       31     1385    1   DCL ENTDISP$ PTR ALIGNED;
       32     1386        %FS$GRAPHIC_BANNER (NAME=GBAN,
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:18   
       33     1387                           STCLASS="BASED(ENTDISP$)");
       34     1444
       35     1445        %INCLUDE B$JIT_C;
       36     1759           %B$JIT0;
       37     1848           %U$JIT1;
       38     1922           %A$JIT6X;
       39     1925    1   DCL B$JIT$ PTR SYMREF;
       40     1926        %INCLUDE UM_CP6;
       41     2778        %VLR_SITEINFO (FPTN=SITEINFO,
       42     2779                       STCLASS=BASED);
       43     2798
       44     2799        %INCLUDE FS$FIT;
       45     2842        %FS_OSFN(STCLASS=BASED);
       46     2856        %INCLUDE F$DCB;
       47     2905        %INCLUDE FM$FIT;
       48     3126        %CODE16;
       49     3134    1   DCL FSK$GETBANNERTEXT ENTRY (4) ALTRET;
       50     3135
       51     3136    1   DCL 1 BEGIN_PICTURE_CMD CONSTANT,
       52     3137    1         2 OPCODE,
       53     3138    1            3 CLASS UBIN (9) UNAL INIT (%XG_COOP_CONTROL#),
       54     3139    1            3 INDX UBIN (9) UNAL INIT (%XG_COOP_BEGIN_PICTURE#),
       55     3140    1         2 REVISION UBIN (18) UNAL INIT (%XG_COOP_REVISION_LEVEL#),
       56     3141    1         2 PRECISION UBIN (9) UNAL INIT (%XG_COOP_COORD_PRECISION#),
       57     3142    1         2 SURFACE UBIN (9) UNAL INIT (1);
       58     3143    1   DCL BEGIN_PICTURE_CHAR REDEF BEGIN_PICTURE_CMD CHAR (6) UNAL;
       59     3144
       60     3145    1   DCL 1 SET_CHARPRECISION_CMD CONSTANT,
       61     3146    1         2 OPCODE,
       62     3147    1            3 CLASS UBIN (9) UNAL INIT (%XG_COOP_ATTR_BAS_NONE_2#),
       63     3148    1            3 INDX UBIN (9) UNAL INIT (%XG_COOP_SET_CHARPRECISION#),
       64     3149    1         2 CHAR_PRECISION UBIN (9) UNAL INIT (2);
       65     3150    1   DCL SET_CHARPRECISION_CHAR REDEF SET_CHARPRECISION_CMD CHAR (3) UNAL;
       66     3151
       67     3152    1   DCL 1 NEW_FRAME_CMD CONSTANT,
       68     3153    1         2 CLASS UBIN (9) UNAL INIT (%XG_COOP_CONTROL#),
       69     3154    1         2 INDX UBIN (9) UNAL INIT (%XG_COOP_NEW_FRAME#);
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:19   
       70     3155    1   DCL NEW_FRAME_CHAR REDEF NEW_FRAME_CMD CHAR (2) UNAL;
       71     3156
       72     3157    1   DCL BANREC$ PTR ALIGNED;
       73     3158    1   DCL CHAR$ PTR ALIGNED;
       74     3159    1   DCL BIGGEST SBIN;
       75     3160    1   DCL I UBIN;
       76     3161    1   DCL START_POS UBIN;
       77     3162    1   DCL RDFLAG BIT (1);
       78     3163    1   DCL XCOORD UBIN (18) ALIGNED;
       79     3164    1   DCL YCOORD UBIN (18) ALIGNED;
       80     3165    1   DCL ZCOORD UBIN (18) ALIGNED;
       81     3166    1   DCL TEXT CHAR (256) BASED;
       82     3167    1   DCL TEXT2 (0:0) CHAR (1) BASED;
       83     3168    1   DCL 1 FEP HALIGNED,
       84     3169    1         2 * BIT (1) UNAL,
       85     3170    1         2 U BIT (8) UNAL,
       86     3171    1         2 * BIT (1) UNAL,
       87     3172    1         2 L BIT (8) UNAL;
       88     3173    1   DCL FEP18 REDEF FEP UBIN (18) HALIGNED;
       89     3174
       90     3175    1   DCL 1 HOST HALIGNED,
       91     3176    1         2 * BIT (2) UNAL,
       92     3177    1         2 U BIT (8) UNAL,
       93     3178    1         2 L BIT (8) UNAL;
       94     3179    1   DCL HOST18 REDEF HOST UBIN (18) HALIGNED;
       95     3180
       96     3181    1   DCL 1 CHAR_ENTRY BASED UNAL,
       97     3182    1         2 CHARACTER CHAR (1) UNAL,
       98     3183    1         2 X UBIN (18) UNAL,
       99     3184    1         2 Y UBIN (18) UNAL,
      100     3185    1         2 Z UBIN (18) UNAL;
      101     3186
      102     3187    1   IF GWRSP.START = 0      /* VERY FIRST CALL- INITIALIZE VARIABLES */

   3187  1 000002   200004 470500                    LDP0    @GWRSP,,AUTO
         1 000003   000000 235100                    LDA     0,,PR0
         1 000004   000057 601000 1                  TNZ     s:3208
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:20   

      103     3188    2   THEN DO;

      104     3189    2      GWRSP.ENTDISP$ = PINCRW (ADDR(GFORM),GWRSP.ENTDISP);

   3189  1 000005   000022 720100                    LXL0    18,,PR0
         1 000006   000000 636010                    EAQ     0,X0
         1 000007   200003 036100                    ADLQ    @GFORM,,AUTO
         1 000010   000022 756100                    STQ     18,,PR0

      105     3190    2      ENTDISP$ = GWRSP.ENTDISP$;

   3190  1 000011   200007 756100                    STQ     ENTDISP$,,AUTO

      106     3191    2      GWRSP.REPEATS = GBAN.REPEATS;             /*COUNTER FOR #PAGES*/

   3191  1 000012   200007 471500                    LDP1    ENTDISP$,,AUTO
         1 000013   000100 101500                    MRL     fill='000'O
         1 000014   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1
         1 000015   000004 000002                    ADSC9   4,,PR0                   cn=0,n=2

      107     3192    2      GWRSP.CUR_ENT = 0;      /* CURRENT ENTRY 0 MEANS BEGIN A NEW PAGE*/

   3192  1 000016   000002 450100                    STZ     2,,PR0

      108     3193    2      GWRSP.LINE_CNT = 0;  /* LINE COUNT FOR THIS PARTICULAR ENTRY  */

   3193  1 000017   000001 450100                    STZ     1,,PR0

      109     3194    2      RDFLAG ='0'B;

   3194  1 000020   200015 450100                    STZ     RDFLAG,,AUTO

      110     3195    2        GWRSP.DATE = 'MM/DD/YY';

   3195  1 000021   040100 100400                    MLR     fill='040'O
         1 000022   000004 000010 0                  ADSC9   NEW_FRAME_CMD+1          cn=0,n=8
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:21   
         1 000023   000015 200010                    ADSC9   13,,PR0                  cn=1,n=8

      111     3196    2        GWRSP.TIME = 'HH:MM';

   3196  1 000024   040100 100400                    MLR     fill='040'O
         1 000025   000006 000005 0                  ADSC9   NEW_FRAME_CMD+3          cn=0,n=5
         1 000026   000014 000005                    ADSC9   12,,PR0                  cn=0,n=5

      112     3197    2      IF (GWRSP.ENTDISP ~= GFORM.ALGNDISP)

   3197  1 000027   200003 473500                    LDP3    @GFORM,,AUTO
         1 000030   300003 236100                    LDQ     3,,PR3
         1 000031   777777 376007                    ANQ     -1,DL
         1 000032   000022 116100                    CMPQ    18,,PR0
         1 000033   000054 600000 1                  TZE     s:3205

      113     3198    3      THEN DO; /* DONT CALL DATE TIME ROUTINE IF DOING ALIGNMENT */

      114     3199    3        IF GWRSP.DATE_TIME ~= ENTADDR(NIL)

   3199  1 000034   000024 236100                    LDQ     20,,PR0
         1 000035   000002 116000 xsym               CMPQ    B_VECTNIL+2
         1 000036   000054 600000 1                  TZE     s:3205

      115     3200    3        THEN
      116     3201    3         CALL GWRSP.DATE_TIME(GWRSP.DATE,GWRSP.TIME)  /* SETTUM */

   3201  1 000037   200004 236100                    LDQ     @GWRSP,,AUTO
         1 000040   000014 036003                    ADLQ    12,DU
         1 000041   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000042   200004 236100                    LDQ     @GWRSP,,AUTO
         1 000043   000000 036000 2                  ADLQ    0
         1 000044   200026 756100                    STQ     @VALUE+1,,AUTO
         1 000045   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 000046   200004 474500                    LDP4    @GWRSP,,AUTO
         1 000047   400024 220100                    LDX0    20,,PR4
         1 000050   000020 631400 xsym               EPPR1   B_VECTNIL+16
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:22   
         1 000051   000000 701010                    TSX1    0,X0
         1 000052   000054 702000 1                  TSX2    s:3205
         1 000053   000054 710000 1                  TRA     s:3205

      117     3202    4         WHENALTRETURN DO;

      118     3203    4            END;

      119     3204    3         END;

      120     3205    2      GWRSP.START = 1;

   3205  1 000054   000001 235007                    LDA     1,DL
         1 000055   200004 470500                    LDP0    @GWRSP,,AUTO
         1 000056   000000 755100                    STA     0,,PR0

      121     3206    2      END;

      122     3207
      123     3208    1      BANREC$ = PINCRC (ADDR(WORKA), SIZEC(WORKA));

   3208  1 000057   200006 236100                    LDQ     @WORKA,,AUTO
         1 000060   000101 036003                    ADLQ    65,DU
         1 000061   200010 756100                    STQ     BANREC$,,AUTO

      124     3209    1   BUFFA.VFC = BITASC ('036'O);

   3209  1 000062   200005 471500                    LDP1    @BUFFA,,AUTO
         1 000063   040100 100400                    MLR     fill='040'O
         1 000064   000001 000001 2                  ADSC9   1                        cn=0,n=1
         1 000065   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      125     3210    1   ENTDISP$ = GWRSP.ENTDISP$;     /* GEN BETTER CODE */

   3210  1 000066   000022 236100                    LDQ     18,,PR0
         1 000067   200007 756100                    STQ     ENTDISP$,,AUTO

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:23   
      126     3211    1   BIGGEST = MAXIMUM (GFORM.X_SIZE, GFORM.Y_SIZE, GFORM.Z_SIZE);

   3211  1 000070   200003 473500                    LDP3    @GFORM,,AUTO
         1 000071   300010 236100                    LDQ     8,,PR3
         1 000072   777777 376007                    ANQ     -1,DL
         1 000073   200026 756100                    STQ     @VALUE+1,,AUTO
         1 000074   300010 236100                    LDQ     8,,PR3
         1 000075   000022 772000                    QRL     18
         1 000076   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000077   300007 236100                    LDQ     7,,PR3
         1 000100   777777 376007                    ANQ     -1,DL
         1 000101   200027 116100                    CMPQ    @VALUE+2,,AUTO
         1 000102   000104 603000 1                  TRC     s:3211+12
         1 000103   200027 236100                    LDQ     @VALUE+2,,AUTO
         1 000104   200026 116100                    CMPQ    @VALUE+1,,AUTO
         1 000105   000107 603000 1                  TRC     s:3211+15
         1 000106   200026 236100                    LDQ     @VALUE+1,,AUTO
         1 000107   200012 756100                    STQ     BIGGEST,,AUTO

      127     3212    1   IF ((BIGGEST = 0) OR (GFORM.X_SIZE + GFORM.Y_SIZE +

   3212  1 000110   000000 116003                    CMPQ    0,DU
         1 000111   000131 600000 1                  TZE     s:3220
         1 000112   300010 236100                    LDQ     8,,PR3
         1 000113   000022 772000                    QRL     18
         1 000114   200026 756100                    STQ     @VALUE+1,,AUTO
         1 000115   300007 236100                    LDQ     7,,PR3
         1 000116   777777 376007                    ANQ     -1,DL
         1 000117   200026 036100                    ADLQ    @VALUE+1,,AUTO
         1 000120   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000121   300010 236100                    LDQ     8,,PR3
         1 000122   777777 376007                    ANQ     -1,DL
         1 000123   200030 756100                    STQ     @VALUE+3,,AUTO
         1 000124   200027 236100                    LDQ     @VALUE+2,,AUTO
         1 000125   200030 036100                    ADLQ    @VALUE+3,,AUTO
         1 000126   000135 604000 1                  TMI     s:3225
         1 000127   200012 116100                    CMPQ    BIGGEST,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:24   
         1 000130   000135 601000 1                  TNZ     s:3225

      128     3213    1       GFORM.Z_SIZE = BIGGEST))
      129     3214    2   THEN DO;

      130     3215              /* IF THE LARGEST VALUE FOR ALL 3 AXIS IS 0 OR THE
      131     3216                 VALUE OF 2 AXIS SIZES IS = 0 THEN THERE SHALL
      132     3217                 BE NO BANNER.  SEND THE DEVICE LIMITS CMD AND
      133     3218                 TERMINATE CALLS TO THIS ROUTINE.
      134     3219              */
      135     3220    2      GWRSP.CUR_ENT = 0;

   3220  1 000131   000002 450100                    STZ     2,,PR0

      136     3221    2      GWRSP.LINE_CNT = 0;

   3221  1 000132   000001 450100                    STZ     1,,PR0

      137     3222    2      ENTDISP$ = ADDR (GFORM);

   3222  1 000133   200003 236100                    LDQ     @GFORM,,AUTO
         1 000134   200007 756100                    STQ     ENTDISP$,,AUTO

      138     3223    2      END;

      139     3224
      140     3225    1   IF GWRSP.CUR_ENT = 0

   3225  1 000135   000002 235100                    LDA     2,,PR0
         1 000136   000246 601000 1                  TNZ     s:3271

      141     3226    2   THEN DO;

      142     3227    3      DO CASE (GWRSP.LINE_CNT);

   3227  1 000137   000001 235100                    LDA     1,,PR0
         1 000140   000005 115007                    CMPA    5,DL
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:25   
         1 000141   000143 602005 1                  TNC     s:3227+4,AL
         1 000142   002032 710000 1                  TRA     s:3526
         1 000143   000150 710000 1                  TRA     s:3229
         1 000144   000201 710000 1                  TRA     s:3243
         1 000145   000212 710000 1                  TRA     s:3247
         1 000146   000226 710000 1                  TRA     s:3253
         1 000147   000243 710000 1                  TRA     s:3264

      143     3228    3         CASE (0);            /* NO LINES FOR THIS PAGE YET           */

      144     3229    3            IF ENTDISP$ = ADDR (GFORM)

   3229  1 000150   200007 236100                    LDQ     ENTDISP$,,AUTO
         1 000151   200003 116100                    CMPQ    @GFORM,,AUTO
         1 000152   000163 601000 1                  TNZ     s:3236

      145     3230    4            THEN DO;          /* ENTRIES = 0 (ENTDISP WAS 0) */

      146     3231    4               BUFFA.TEXT = GFORM.SET_DEV_LIM_CMD;

   3231  1 000153   040100 100500                    MLR     fill='040'O
         1 000154   300012 400052                    ADSC9   10,,PR3                  cn=2,n=42
         1 000155   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      147     3232    4               GWRSP.MAXBYTES = SIZEC (GFORM.SET_DEV_LIM_CMD);

   3232  1 000156   000052 235007                    LDA     42,DL
         1 000157   000005 755100                    STA     5,,PR0

      148     3233    4               GWRSP.LINE_CNT = 4;

   3233  1 000160   000004 235007                    LDA     4,DL
         1 000161   000001 755100                    STA     1,,PR0

      149     3234    4               END;

   3234  1 000162   002032 710000 1                  TRA     s:3526
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:26   

      150     3235    4            ELSE DO;

      151     3236    4               GWRSP.START = 1;

   3236  1 000163   000001 235007                    LDA     1,DL
         1 000164   000000 755100                    STA     0,,PR0

      152     3237    4               BUFFA.VFC = 'p';

   3237  1 000165   040100 100400                    MLR     fill='040'O
         1 000166   000002 000001 2                  ADSC9   2                        cn=0,n=1
         1 000167   100000 000001                    ADSC9   0,,PR1                   cn=0,n=1

      153     3238    4               BUFFA.TEXT = BEGIN_PICTURE_CHAR;

   3238  1 000170   040100 100400                    MLR     fill='040'O
         1 000171   000000 000006 0                  ADSC9   BEGIN_PICTURE_CMD        cn=0,n=6
         1 000172   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      154     3239    4               GWRSP.MAXBYTES = SIZEC (BEGIN_PICTURE_CHAR);

   3239  1 000173   000006 235007                    LDA     6,DL
         1 000174   000005 755100                    STA     5,,PR0

      155     3240    4               GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;

   3240  1 000175   000001 235100                    LDA     1,,PR0
         1 000176   000001 035007                    ADLA    1,DL
         1 000177   000001 755100                    STA     1,,PR0

      156     3241    4               END;

   3241  1 000200   002032 710000 1                  TRA     s:3526

      157     3242    3         CASE (1);

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:27   
      158     3243    3            BUFFA.TEXT = GFORM.SET_DEV_LIM_CMD;

   3243  1 000201   040100 100500                    MLR     fill='040'O
         1 000202   300012 400052                    ADSC9   10,,PR3                  cn=2,n=42
         1 000203   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      159     3244    3            GWRSP.MAXBYTES = SIZEC (GFORM.SET_DEV_LIM_CMD);

   3244  1 000204   000052 235007                    LDA     42,DL
         1 000205   000005 755100                    STA     5,,PR0

      160     3245    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;

   3245  1 000206   000001 235100                    LDA     1,,PR0
         1 000207   000001 035007                    ADLA    1,DL
         1 000210   000001 755100                    STA     1,,PR0
         1 000211   002032 710000 1                  TRA     s:3526

      161     3246    3         CASE (2);

      162     3247    3            BUFFA.TEXT = SET_CHARPRECISION_CHAR;

   3247  1 000212   040100 100400                    MLR     fill='040'O
         1 000213   000002 000003 0                  ADSC9   SET_CHARPRECISION_CMD    cn=0,n=3
         1 000214   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      163     3248    3            GWRSP.MAXBYTES = SIZEC (SET_CHARPRECISION_CHAR);

   3248  1 000215   000003 235007                    LDA     3,DL
         1 000216   000005 755100                    STA     5,,PR0

      164     3249    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;

   3249  1 000217   000001 235100                    LDA     1,,PR0
         1 000220   000001 035007                    ADLA    1,DL
         1 000221   000001 755100                    STA     1,,PR0

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:28   
      165     3250    3            GWRSP.CUR_ENT = 1;

   3250  1 000222   000001 236007                    LDQ     1,DL
         1 000223   000002 756100                    STQ     2,,PR0

      166     3251    3            GWRSP.LINE_CNT = 0;

   3251  1 000224   000001 450100                    STZ     1,,PR0
         1 000225   002032 710000 1                  TRA     s:3526

      167     3252    3         CASE (3);  /* THIS IS THE END OF A PAGE, FINISH UP! */

      168     3253    3            BUFFA.TEXT = NEW_FRAME_CHAR;

   3253  1 000226   040100 100400                    MLR     fill='040'O
         1 000227   000003 000002 0                  ADSC9   NEW_FRAME_CMD            cn=0,n=2
         1 000230   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      169     3254    3            GWRSP.MAXBYTES = SIZEC (NEW_FRAME_CHAR);

   3254  1 000231   000002 235007                    LDA     2,DL
         1 000232   000005 755100                    STA     5,,PR0

      170     3255    3            IF GWRSP.REPEATS = 0

   3255  1 000233   000004 220100                    LDX0    4,,PR0
         1 000234   000240 601000 1                  TNZ     s:3260

      171     3256    4            THEN DO;

      172     3257    4               GWRSP.LINE_CNT = 4;

   3257  1 000235   000004 236007                    LDQ     4,DL
         1 000236   000001 756100                    STQ     1,,PR0

      173     3258    4               END;

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:29   
   3258  1 000237   002032 710000 1                  TRA     s:3526

      174     3259    4            ELSE DO;

      175     3260    4               GWRSP.CUR_ENT = 0;

   3260  1 000240   000002 450100                    STZ     2,,PR0

      176     3261    4               GWRSP.LINE_CNT = 0;

   3261  1 000241   000001 450100                    STZ     1,,PR0

      177     3262    4               END;

   3262  1 000242   002032 710000 1                  TRA     s:3526

      178     3263    3         CASE (4);   /* This is the end, we are all done! */

      179     3264    3            GWRSP.START = -1;

   3264  1 000243   000001 336007                    LCQ     1,DL
         1 000244   000000 756100                    STQ     0,,PR0
         1 000245   002032 710000 1                  TRA     s:3526

      180     3265    3         CASE (ELSE);

      181     3266                 /* THIS CASE SHOULD NEVER BE ENTERED; IF IT IS - BOY DID I
      182     3267                    MESS UP!!!!! */
      183     3268    3         END; /* DO CASE ON GWRSP.LINE_CNT */

      184     3269    2      END; /* IF GWRSP.CUR_ENT = 0 */
      185     3270    2   ELSE DO;                   /* DO ENTRIES, GWRSP.CUR_ENT <> 0 */

      186     3271    3      DO CASE (GWRSP.LINE_CNT);

   3271  1 000246   000001 235100                    LDA     1,,PR0
         1 000247   000005 115007                    CMPA    5,DL
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:30   
         1 000250   000252 602005 1                  TNC     s:3271+4,AL
         1 000251   002032 710000 1                  TRA     s:3526
         1 000252   000257 710000 1                  TRA     s:3273
         1 000253   000275 710000 1                  TRA     s:3277
         1 000254   000313 710000 1                  TRA     s:3281
         1 000255   000331 710000 1                  TRA     s:3286
         1 000256   001543 710000 1                  TRA     s:3473

      187     3272    3         CASE (0);

      188     3273    3            BUFFA.TEXT = GBAN.ENTRIES.SET_CHARSIZE_CMD (GWRSP.CUR_ENT-1);

   3273  1 000257   000002 236100                    LDQ     2,,PR0
         1 000260   000060 402007                    MPY     48,DL
         1 000261   200007 474500                    LDP4    ENTDISP$,,AUTO
         1 000262   040100 100506                    MLR     fill='040'O
         1 000263   477767 200006                    ADSC9   -9,Q,PR4                 cn=1,n=6
         1 000264   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      189     3274    3           GWRSP.MAXBYTES = SIZEC (GBAN.ENTRIES.SET_CHARSIZE_CMD (GWRSP.CUR_ENT - 1));

   3274  1 000265   000002 236100                    LDQ     2,,PR0
         1 000266   000060 402007                    MPY     48,DL
         1 000267   000006 235007                    LDA     6,DL
         1 000270   000005 755100                    STA     5,,PR0

      190     3275    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;

   3275  1 000271   000001 235100                    LDA     1,,PR0
         1 000272   000001 035007                    ADLA    1,DL
         1 000273   000001 755100                    STA     1,,PR0
         1 000274   002032 710000 1                  TRA     s:3526

      191     3276    3         CASE (1);

      192     3277    3            BUFFA.TEXT = GBAN.ENTRIES.SET_CHARSPACE_CMD (GWRSP.CUR_ENT-1);

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:31   
   3277  1 000275   000002 236100                    LDQ     2,,PR0
         1 000276   000060 402007                    MPY     48,DL
         1 000277   200007 474500                    LDP4    ENTDISP$,,AUTO
         1 000300   040100 100506                    MLR     fill='040'O
         1 000301   477771 600004                    ADSC9   -7,Q,PR4                 cn=3,n=4
         1 000302   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      193     3278    3           GWRSP.MAXBYTES = SIZEC (GBAN.ENTRIES.SET_CHARSPACE_CMD (GWRSP.CUR_ENT - 1))
              3278                     ;

   3278  1 000303   000002 236100                    LDQ     2,,PR0
         1 000304   000060 402007                    MPY     48,DL
         1 000305   000004 235007                    LDA     4,DL
         1 000306   000005 755100                    STA     5,,PR0

      194     3279    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;

   3279  1 000307   000001 235100                    LDA     1,,PR0
         1 000310   000001 035007                    ADLA    1,DL
         1 000311   000001 755100                    STA     1,,PR0
         1 000312   002032 710000 1                  TRA     s:3526

      195     3280    3         CASE (2);

      196     3281    3            BUFFA.TEXT = GBAN.ENTRIES.SET_CHARUP_CMD (GWRSP.CUR_ENT - 1);

   3281  1 000313   000002 235100                    LDA     2,,PR0
         1 000314   000044 733000                    LRS     36
         1 000315   000060 402007                    MPY     48,DL
         1 000316   200007 474500                    LDP4    ENTDISP$,,AUTO
         1 000317   040100 100506                    MLR     fill='040'O
         1 000320   477765 000010                    ADSC9   -11,Q,PR4                cn=0,n=8
         1 000321   100000 200377                    ADSC9   0,,PR1                   cn=1,n=255

      197     3282    3            GWRSP.MAXBYTES = SIZEC (GBAN.ENTRIES.SET_CHARUP_CMD (GWRSP.CUR_ENT - 1));

   3282  1 000322   000002 235100                    LDA     2,,PR0
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:32   
         1 000323   000010 236007                    LDQ     8,DL
         1 000324   000005 756100                    STQ     5,,PR0

      198     3283    3            GWRSP.LINE_CNT = GWRSP.LINE_CNT + 1;

   3283  1 000325   000001 235100                    LDA     1,,PR0
         1 000326   000001 035007                    ADLA    1,DL
         1 000327   000001 755100                    STA     1,,PR0
         1 000330   002032 710000 1                  TRA     s:3526

      199     3284    3         CASE (3);  /* THIS IS WHERE THE ACTUAL ENTRY IS FIRST HANDLED */

      200     3285                 /* PUT ENTRIES TEXT INTO WORK AREA AND INIT TEXT 3 CMD */
      201     3286    4            DO CASE (GBAN.ENTRIES.TYPE (GWRSP.CUR_ENT - 1));

   3286  1 000331   000002 236100                    LDQ     2,,PR0
         1 000332   000060 402007                    MPY     48,DL
         1 000333   200007 474500                    LDP4    ENTDISP$,,AUTO
         1 000334   000100 101506                    MRL     fill='000'O
         1 000335   477776 200001                    ADSC9   -2,Q,PR4                 cn=1,n=1
         1 000336   200026 000002                    ADSC9   @VALUE+1,,AUTO           cn=0,n=2
         1 000337   200026 220100                    LDX0    @VALUE+1,,AUTO
         1 000340   000035 100003                    CMPX0   29,DU
         1 000341   000343 602010 1                  TNC     s:3286+10,X0
         1 000342   001164 710000 1                  TRA     s:3405
         1 000343   000400 710000 1                  TRA     s:3288
         1 000344   000461 710000 1                  TRA     s:3298
         1 000345   000476 710000 1                  TRA     s:3302
         1 000346   000506 710000 1                  TRA     s:3305
         1 000347   000516 710000 1                  TRA     s:3308
         1 000350   000526 710000 1                  TRA     s:3311
         1 000351   000536 710000 1                  TRA     s:3314
         1 000352   000545 710000 1                  TRA     s:3317
         1 000353   000564 710000 1                  TRA     s:3323
         1 000354   000554 710000 1                  TRA     s:3320
         1 000355   001164 710000 1                  TRA     s:3405
         1 000356   000427 710000 1                  TRA     s:3292
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:33   
         1 000357   000624 710000 1                  TRA     s:3334
         1 000360   001164 710000 1                  TRA     s:3405
         1 000361   000574 710000 1                  TRA     s:3326
         1 000362   000610 710000 1                  TRA     s:3330
         1 000363   000634 710000 1                  TRA     s:3337
         1 000364   000645 710000 1                  TRA     s:3340
         1 000365   000655 710000 1                  TRA     s:3343
         1 000366   000701 710000 1                  TRA     s:3349
         1 000367   000725 710000 1                  TRA     s:3355
         1 000370   000751 710000 1                  TRA     s:3361
         1 000371   000775 710000 1                  TRA     s:3367
         1 000372   001021 710000 1                  TRA     s:3373
         1 000373   001045 710000 1                  TRA     s:3379
         1 000374   001071 710000 1                  TRA     s:3385
         1 000375   001115 710000 1                  TRA     s:3391
         1 000376   001141 710000 1                  TRA     s:3397
         1 000377   000655 710000 1                  TRA     s:3343

      202     3287    4               CASE(FS_PLAIN_TEXT);

      203     3288    4                  CHAR$ = PINCRW (ADDR (GBAN), GBAN.ENTRIES.DISP (GWRSP.CUR_ENT - 1));

   3288  1 000400   000002 236100                    LDQ     2,,PR0
         1 000401   000060 402007                    MPY     48,DL
         1 000402   000100 100506                    MLR     fill='000'O
         1 000403   477776 600002                    ADSC9   -2,Q,PR4                 cn=3,n=2
         1 000404   200026 000004                    ADSC9   @VALUE+1,,AUTO           cn=0,n=4
         1 000405   200026 220100                    LDX0    @VALUE+1,,AUTO
         1 000406   000000 636010                    EAQ     0,X0
         1 000407   200007 036100                    ADLQ    ENTDISP$,,AUTO
         1 000410   200011 756100                    STQ     CHAR$,,AUTO

      204     3289    4                   WORKA.TWORK.COUNT = GBAN.ENTRIES.COUNT (GWRSP.CUR_ENT - 1);

   3289  1 000411   000002 236100                    LDQ     2,,PR0
         1 000412   000060 402007                    MPY     48,DL
         1 000413   200006 475500                    LDP5    @WORKA,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:34   
         1 000414   000100 100506                    MLR     fill='000'O
         1 000415   477776 400001                    ADSC9   -2,Q,PR4                 cn=2,n=1
         1 000416   500000 000001                    ADSC9   0,,PR5                   cn=0,n=1

      205     3290    4                   WORKA.TWORK.TEXT = SUBSTR (CHAR$->TEXT,0,WORKA.TWORK.COUNT);

   3290  1 000417   500000 236100                    LDQ     0,,PR5
         1 000420   000033 772000                    QRL     27
         1 000421   200011 476500                    LDP6    CHAR$,,AUTO
         1 000422   000000 620006                    EAX0    0,QL
         1 000423   040100 100540                    MLR     fill='040'O
         1 000424   600000 000010                    ADSC9   0,,PR6                   cn=0,n=*X0
         1 000425   500000 200400                    ADSC9   0,,PR5                   cn=1,n=256
         1 000426   001164 710000 1                  TRA     s:3405

      206     3291    4               CASE(FS_X_INT);

      207     3292    4                   CHAR$ = ADDR (WORKA.TWORK.TEXT);

   3292  1 000427   200006 236100                    LDQ     @WORKA,,AUTO
         1 000430   200000 036007                    ADLQ    65536,DL
         1 000431   200011 756100                    STQ     CHAR$,,AUTO

      208     3293    4                   WORKA.TWORK.COUNT = SIZEC(WORKA.TWORK.TEXT);

   3293  1 000432   200006 475500                    LDP5    @WORKA,,AUTO
         1 000433   400000 236003                    LDQ     -131072,DU
         1 000434   500000 552140                    STBQ    0,'40'O,PR5

      209     3294    5                   DO I = 0 TO WORKA.TWORK.COUNT-1;

   3294  1 000435   200013 450100                    STZ     I,,AUTO
         1 000436   000452 710000 1                  TRA     s:3296+2

      210     3295    5                     CHAR$->TEXT2(I) = GBAN.ENTRIES.CHR(GWRSP.CUR_ENT-1);

   3295  1 000437   200004 470500                    LDP0    @GWRSP,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:35   
         1 000440   000002 236100                    LDQ     2,,PR0
         1 000441   000060 402007                    MPY     48,DL
         1 000442   200007 471500                    LDP1    ENTDISP$,,AUTO
         1 000443   200011 473500                    LDP3    CHAR$,,AUTO
         1 000444   200013 235100                    LDA     I,,AUTO
         1 000445   040105 100506                    MLR     fill='040'O
         1 000446   177776 400001                    ADSC9   -2,Q,PR1                 cn=2,n=1
         1 000447   300000 000001                    ADSC9   0,A,PR3                  cn=0,n=1

      211     3296    5                     END;

   3296  1 000450   000001 035007                    ADLA    1,DL
         1 000451   200013 755100                    STA     I,,AUTO
         1 000452   200006 471500                    LDP1    @WORKA,,AUTO
         1 000453   100000 236100                    LDQ     0,,PR1
         1 000454   000033 772000                    QRL     27
         1 000455   200013 116100                    CMPQ    I,,AUTO
         1 000456   000460 600000 1                  TZE     s:3296+8
         1 000457   000437 603000 1                  TRC     s:3295
         1 000460   001164 710000 1                  TRA     s:3405

      212     3297    4               CASE(FS_SYSID_INT);

      213     3298    4                   WORKA.TWORK.COUNT = 6;

   3298  1 000461   200006 475500                    LDP5    @WORKA,,AUTO
         1 000462   006000 236003                    LDQ     3072,DU
         1 000463   500000 552140                    STBQ    0,'40'O,PR5

      214     3299    4                   I = GWRSP.JIT$->B$JIT.SYSID;

   3299  1 000464   000021 476500                    LDP6    17,,PR0
         1 000465   600000 236100                    LDQ     0,,PR6
         1 000466   777777 376007                    ANQ     -1,DL
         1 000467   200013 756100                    STQ     I,,AUTO

      215     3300    4                   CALL BINCHAR(SUBSTR(WORKA.TWORK.TEXT,0,6),I);
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:36   

   3300  1 000470   000000 235003                    LDA     0,DU
         1 000471   200026 757100                    STAQ    @VALUE+1,,AUTO
         1 000472   000100 301500                    BTD
         1 000473   200026 000010                    NDSC9   @VALUE+1,,AUTO           cn=0,s=lsgnf,sf=0,n=8
         1 000474   500000 230006                    NDSC9   0,,PR5                   cn=1,s=nosgn,sf=0,n=6
         1 000475   001164 710000 1                  TRA     s:3405

      216     3301    4               CASE(FS_ACCN_INT);

      217     3302    4                   WORKA.TWORK.COUNT = SIZEC(B$JIT.ACCN);

   3302  1 000476   200006 475500                    LDP5    @WORKA,,AUTO
         1 000477   010000 236003                    LDQ     4096,DU
         1 000500   500000 552140                    STBQ    0,'40'O,PR5

      218     3303    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(B$JIT.ACCN),GWRSP.JIT$->B$JIT.
              3303                            ACCN);

   3303  1 000501   000021 476500                    LDP6    17,,PR0
         1 000502   040100 100500                    MLR     fill='040'O
         1 000503   600001 000010                    ADSC9   1,,PR6                   cn=0,n=8
         1 000504   500000 200010                    ADSC9   0,,PR5                   cn=1,n=8
         1 000505   001164 710000 1                  TRA     s:3405

      219     3304    4               CASE(FS_UNAME_INT);

      220     3305    4                   WORKA.TWORK.COUNT = SIZEC(B$JIT.UNAME);

   3305  1 000506   200006 475500                    LDP5    @WORKA,,AUTO
         1 000507   014000 236003                    LDQ     6144,DU
         1 000510   500000 552140                    STBQ    0,'40'O,PR5

      221     3306    4                  CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(B$JIT.UNAME),GWRSP.JIT$->B$JIT.
              3306                            UNAME);

   3306  1 000511   000021 476500                    LDP6    17,,PR0
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:37   
         1 000512   040100 100500                    MLR     fill='040'O
         1 000513   600003 000014                    ADSC9   3,,PR6                   cn=0,n=12
         1 000514   500000 200014                    ADSC9   0,,PR5                   cn=1,n=12
         1 000515   001164 710000 1                  TRA     s:3405

      222     3307    4               CASE(FS_WOO_INT);

      223     3308    4                   WORKA.TWORK.COUNT = 1+SIZEC(B$JIT.WOO);

   3308  1 000516   200006 475500                    LDP5    @WORKA,,AUTO
         1 000517   011000 236003                    LDQ     4608,DU
         1 000520   500000 552140                    STBQ    0,'40'O,PR5

      224     3309    4                  CALL INSERT(WORKA.TWORK.TEXT,0,1+SIZEC(B$JIT.WOO),GWRSP.JIT$->B$JIT.
              3309                            WOO);

   3309  1 000521   000021 476500                    LDP6    17,,PR0
         1 000522   040100 100500                    MLR     fill='040'O
         1 000523   600010 000010                    ADSC9   8,,PR6                   cn=0,n=8
         1 000524   500000 200011                    ADSC9   0,,PR5                   cn=1,n=9
         1 000525   001164 710000 1                  TRA     s:3405

      225     3310    4               CASE(FS_JOBNAME_INT);

      226     3311    4                   WORKA.TWORK.COUNT = SIZEC(B$JIT.JOBNAME);

   3311  1 000526   200006 475500                    LDP5    @WORKA,,AUTO
         1 000527   037000 236003                    LDQ     15872,DU
         1 000530   500000 552140                    STBQ    0,'40'O,PR5

      227     3312    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(B$JIT.JOBNAME),B$JIT.JOBNAME);

   3312  1 000531   000000 476400 xsym               LDP6    B$JIT$
         1 000532   040100 100500                    MLR     fill='040'O
         1 000533   600156 200037                    ADSC9   110,,PR6                 cn=1,n=31
         1 000534   500000 200037                    ADSC9   0,,PR5                   cn=1,n=31
         1 000535   001164 710000 1                  TRA     s:3405
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:38   

      228     3313    4               CASE(FS_TIME_INT);

      229     3314    4                   WORKA.TWORK.COUNT = 5;

   3314  1 000536   200006 475500                    LDP5    @WORKA,,AUTO
         1 000537   005000 236003                    LDQ     2560,DU
         1 000540   500000 552140                    STBQ    0,'40'O,PR5

      230     3315    4                   CALL INSERT(WORKA.TWORK.TEXT,0,5,GWRSP.TIME);

   3315  1 000541   040100 100500                    MLR     fill='040'O
         1 000542   000014 000005                    ADSC9   12,,PR0                  cn=0,n=5
         1 000543   500000 200005                    ADSC9   0,,PR5                   cn=1,n=5
         1 000544   001164 710000 1                  TRA     s:3405

      231     3316    4               CASE(FS_DATE_INT);

      232     3317    4                   WORKA.TWORK.COUNT = 8;

   3317  1 000545   200006 475500                    LDP5    @WORKA,,AUTO
         1 000546   010000 236003                    LDQ     4096,DU
         1 000547   500000 552140                    STBQ    0,'40'O,PR5

      233     3318    4                   CALL INSERT(WORKA.TWORK.TEXT,0,8,GWRSP.DATE);

   3318  1 000550   040100 100500                    MLR     fill='040'O
         1 000551   000015 200010                    ADSC9   13,,PR0                  cn=1,n=8
         1 000552   500000 200010                    ADSC9   0,,PR5                   cn=1,n=8
         1 000553   001164 710000 1                  TRA     s:3405

      234     3319    4               CASE(FS_SUBFILE_INT);

      235     3320    4                   WORKA.TWORK.COUNT = 6;

   3320  1 000554   200006 475500                    LDP5    @WORKA,,AUTO
         1 000555   006000 236003                    LDQ     3072,DU
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:39   
         1 000556   500000 552140                    STBQ    0,'40'O,PR5

      236     3321    4                   CALL INSERT(WORKA.TWORK.TEXT,0,6,ADDR(GWRSP.SUBFILE$->F$DCB.NAME)->
              3321                            FS_OSFN.NUM);

   3321  1 000557   000020 476500                    LDP6    16,,PR0
         1 000560   040100 100500                    MLR     fill='040'O
         1 000561   600012 400006                    ADSC9   10,,PR6                  cn=2,n=6
         1 000562   500000 200006                    ADSC9   0,,PR5                   cn=1,n=6
         1 000563   001164 710000 1                  TRA     s:3405

      237     3322    4               CASE(FS_VERSION_INT);

      238     3323    4                   WORKA.TWORK.COUNT = SIZEC(SITEINFO.VERSION#);

   3323  1 000564   200006 475500                    LDP5    @WORKA,,AUTO
         1 000565   004000 236003                    LDQ     2048,DU
         1 000566   500000 552140                    STBQ    0,'40'O,PR5

      239     3324    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(SITEINFO.VERSION#),GWRSP.
              3324                            SITEINFO->SITEINFO.VERSION#);

   3324  1 000567   000023 476500                    LDP6    19,,PR0
         1 000570   040100 100500                    MLR     fill='040'O
         1 000571   600064 000004                    ADSC9   52,,PR6                  cn=0,n=4
         1 000572   500000 200004                    ADSC9   0,,PR5                   cn=1,n=4
         1 000573   001164 710000 1                  TRA     s:3405

      240     3325    4               CASE(FS_SITENAME_INT);

      241     3326    4                   WORKA.TWORK.COUNT = GWRSP.SITEINFO->SITEINFO.

   3326  1 000574   000023 475500                    LDP5    19,,PR0
         1 000575   200006 476500                    LDP6    @WORKA,,AUTO
         1 000576   500001 236100                    LDQ     1,,PR5
         1 000577   600000 552140                    STBQ    0,'40'O,PR6

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:40   
      242     3327    4                        SITE_NAME#.L;
      243     3328    4                   CALL INSERT(WORKA.TWORK.TEXT,0,WORKA.TWORK.COUNT,GWRSP.SITEINFO->
              3328                            SITEINFO.SITE_NAME#.C);

   3328  1 000600   000023 475500                    LDP5    19,,PR0
         1 000601   600000 236100                    LDQ     0,,PR6
         1 000602   000033 772000                    QRL     27
         1 000603   000000 621006                    EAX1    0,QL
         1 000604   040140 100500                    MLR     fill='040'O
         1 000605   500001 200167                    ADSC9   1,,PR5                   cn=1,n=119
         1 000606   600000 200011                    ADSC9   0,,PR6                   cn=1,n=*X1
         1 000607   001164 710000 1                  TRA     s:3405

      244     3329    4               CASE(FS_SALUTE_INT);

      245     3330    4                   WORKA.TWORK.COUNT = GWRSP.SITEINFO->SITEINFO.

   3330  1 000610   000023 475500                    LDP5    19,,PR0
         1 000611   200006 476500                    LDP6    @WORKA,,AUTO
         1 000612   500037 236100                    LDQ     31,,PR5
         1 000613   600000 552140                    STBQ    0,'40'O,PR6

      246     3331    4                        SALUTATION#.L;
      247     3332    4                   CALL INSERT(WORKA.TWORK.TEXT,0,WORKA.TWORK.COUNT,GWRSP.SITEINFO->
              3332                            SITEINFO.SALUTATION#.C);

   3332  1 000614   000023 475500                    LDP5    19,,PR0
         1 000615   600000 236100                    LDQ     0,,PR6
         1 000616   000033 772000                    QRL     27
         1 000617   000000 621006                    EAX1    0,QL
         1 000620   040140 100500                    MLR     fill='040'O
         1 000621   500037 200117                    ADSC9   31,,PR5                  cn=1,n=79
         1 000622   600000 200011                    ADSC9   0,,PR6                   cn=1,n=*X1
         1 000623   001164 710000 1                  TRA     s:3405

      248     3333    4               CASE(FS_WOD_INT);

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:41   
      249     3334    4                   WORKA.TWORK.COUNT = SIZEC(F$DCB.WSN);

   3334  1 000624   200006 475500                    LDP5    @WORKA,,AUTO
         1 000625   010000 236003                    LDQ     4096,DU
         1 000626   500000 552140                    STBQ    0,'40'O,PR5

      250     3335    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(F$DCB.WSN),GWRSP.SUBFILE$->
              3335                            F$DCB.WSN);

   3335  1 000627   000020 476500                    LDP6    16,,PR0
         1 000630   040100 100500                    MLR     fill='040'O
         1 000631   600027 000010                    ADSC9   23,,PR6                  cn=0,n=8
         1 000632   500000 200010                    ADSC9   0,,PR5                   cn=1,n=8
         1 000633   001164 710000 1                  TRA     s:3405

      251     3336    4               CASE(FS_FORM_INT);

      252     3337    4                   WORKA.TWORK.COUNT = SIZEC(CODE16.FORM);

   3337  1 000634   200006 475500                    LDP5    @WORKA,,AUTO
         1 000635   006000 236003                    LDQ     3072,DU
         1 000636   500000 552140                    STBQ    0,'40'O,PR5

      253     3338    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(CODE16.FORM),GWRSP.SUBFILE$->
              3338                            F$DCB.FORM$->CODE16.FORM);

   3338  1 000637   000020 476500                    LDP6    16,,PR0
         1 000640   600050 477500                    LDP7    40,,PR6
         1 000641   040100 100500                    MLR     fill='040'O
         1 000642   700000 000006                    ADSC9   0,,PR7                   cn=0,n=6
         1 000643   500000 200006                    ADSC9   0,,PR5                   cn=1,n=6
         1 000644   001164 710000 1                  TRA     s:3405

      254     3339    4               CASE(FS_MINI_ID_INT);

      255     3340    4                   WORKA.TWORK.COUNT = SIZEC(SITEINFO.MINI_ID#);

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:42   
   3340  1 000645   200006 475500                    LDP5    @WORKA,,AUTO
         1 000646   003000 236003                    LDQ     1536,DU
         1 000647   500000 552140                    STBQ    0,'40'O,PR5

      256     3341    4                   CALL INSERT(WORKA.TWORK.TEXT,0,SIZEC(SITEINFO.MINI_ID#),GWRSP.
              3341                            SITEINFO->SITEINFO.MINI_ID#);

   3341  1 000650   000023 476500                    LDP6    19,,PR0
         1 000651   600000 236100                    LDQ     0,,PR6
         1 000652   000011 772000                    QRL     9
         1 000653   500000 552134                    STBQ    0,'34'O,PR5
         1 000654   001164 710000 1                  TRA     s:3405

      257     3342    4               CASE( FS_BANNERTEXT0_INT, FS_REGISTEREDNAME_INT );

      258     3343    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 0)

   3343  1 000655   000003 236000 2                  LDQ     3
         1 000656   200031 756100                    STQ     @VALUE+4,,AUTO
         1 000657   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 000660   200030 455500                    STP5    @VALUE+3,,AUTO
         1 000661   200006 236100                    LDQ     @WORKA,,AUTO
         1 000662   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000663   200010 636500                    EPPR6   BANREC$,,AUTO
         1 000664   200026 456500                    STP6    @VALUE+1,,AUTO
         1 000665   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 000666   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000667   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 000670   000672 702000 1                  TSX2    s:3345
         1 000671   000700 710000 1                  TRA     s:3347

      259     3344    5                   WHENALTRETURN DO;

      260     3345    5                        WORKA.TWORK.TEXT = ' ';

   3345  1 000672   200006 470500                    LDP0    @WORKA,,AUTO
         1 000673   040100 100400                    MLR     fill='040'O
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:43   
         1 000674   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000675   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      261     3346    5                        WORKA.TWORK.COUNT = 1;

   3346  1 000676   001000 236003                    LDQ     512,DU
         1 000677   000000 552140                    STBQ    0,'40'O,PR0

      262     3347    5                      END;

   3347  1 000700   001164 710000 1                  TRA     s:3405

      263     3348    4               CASE( FS_BANNERTEXT1_INT );

      264     3349    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 1)

   3349  1 000701   000004 236000 2                  LDQ     4
         1 000702   200031 756100                    STQ     @VALUE+4,,AUTO
         1 000703   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 000704   200030 455500                    STP5    @VALUE+3,,AUTO
         1 000705   200006 236100                    LDQ     @WORKA,,AUTO
         1 000706   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000707   200010 636500                    EPPR6   BANREC$,,AUTO
         1 000710   200026 456500                    STP6    @VALUE+1,,AUTO
         1 000711   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 000712   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000713   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 000714   000716 702000 1                  TSX2    s:3351
         1 000715   000724 710000 1                  TRA     s:3353

      265     3350    5                   WHENALTRETURN DO;

      266     3351    5                        WORKA.TWORK.TEXT = ' ';

   3351  1 000716   200006 470500                    LDP0    @WORKA,,AUTO
         1 000717   040100 100400                    MLR     fill='040'O
         1 000720   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:44   
         1 000721   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      267     3352    5                        WORKA.TWORK.COUNT = 1;

   3352  1 000722   001000 236003                    LDQ     512,DU
         1 000723   000000 552140                    STBQ    0,'40'O,PR0

      268     3353    5                      END;

   3353  1 000724   001164 710000 1                  TRA     s:3405

      269     3354    4               CASE( FS_BANNERTEXT2_INT );

      270     3355    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 2)

   3355  1 000725   000005 236000 2                  LDQ     5
         1 000726   200031 756100                    STQ     @VALUE+4,,AUTO
         1 000727   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 000730   200030 455500                    STP5    @VALUE+3,,AUTO
         1 000731   200006 236100                    LDQ     @WORKA,,AUTO
         1 000732   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000733   200010 636500                    EPPR6   BANREC$,,AUTO
         1 000734   200026 456500                    STP6    @VALUE+1,,AUTO
         1 000735   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 000736   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000737   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 000740   000742 702000 1                  TSX2    s:3357
         1 000741   000750 710000 1                  TRA     s:3359

      271     3356    5                   WHENALTRETURN DO;

      272     3357    5                        WORKA.TWORK.TEXT = ' ';

   3357  1 000742   200006 470500                    LDP0    @WORKA,,AUTO
         1 000743   040100 100400                    MLR     fill='040'O
         1 000744   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000745   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:45   

      273     3358    5                        WORKA.TWORK.COUNT = 1;

   3358  1 000746   001000 236003                    LDQ     512,DU
         1 000747   000000 552140                    STBQ    0,'40'O,PR0

      274     3359    5                      END;

   3359  1 000750   001164 710000 1                  TRA     s:3405

      275     3360    4               CASE( FS_BANNERTEXT3_INT );

      276     3361    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 3)

   3361  1 000751   000006 236000 2                  LDQ     6
         1 000752   200031 756100                    STQ     @VALUE+4,,AUTO
         1 000753   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 000754   200030 455500                    STP5    @VALUE+3,,AUTO
         1 000755   200006 236100                    LDQ     @WORKA,,AUTO
         1 000756   200027 756100                    STQ     @VALUE+2,,AUTO
         1 000757   200010 636500                    EPPR6   BANREC$,,AUTO
         1 000760   200026 456500                    STP6    @VALUE+1,,AUTO
         1 000761   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 000762   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 000763   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 000764   000766 702000 1                  TSX2    s:3363
         1 000765   000774 710000 1                  TRA     s:3365

      277     3362    5                   WHENALTRETURN DO;

      278     3363    5                        WORKA.TWORK.TEXT = ' ';

   3363  1 000766   200006 470500                    LDP0    @WORKA,,AUTO
         1 000767   040100 100400                    MLR     fill='040'O
         1 000770   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 000771   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:46   
      279     3364    5                        WORKA.TWORK.COUNT = 1;

   3364  1 000772   001000 236003                    LDQ     512,DU
         1 000773   000000 552140                    STBQ    0,'40'O,PR0

      280     3365    5                      END;

   3365  1 000774   001164 710000 1                  TRA     s:3405

      281     3366    4               CASE( FS_BANNERTEXT4_INT );

      282     3367    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 4)

   3367  1 000775   000007 236000 2                  LDQ     7
         1 000776   200031 756100                    STQ     @VALUE+4,,AUTO
         1 000777   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 001000   200030 455500                    STP5    @VALUE+3,,AUTO
         1 001001   200006 236100                    LDQ     @WORKA,,AUTO
         1 001002   200027 756100                    STQ     @VALUE+2,,AUTO
         1 001003   200010 636500                    EPPR6   BANREC$,,AUTO
         1 001004   200026 456500                    STP6    @VALUE+1,,AUTO
         1 001005   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 001006   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001007   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 001010   001012 702000 1                  TSX2    s:3369
         1 001011   001020 710000 1                  TRA     s:3371

      283     3368    5                   WHENALTRETURN DO;

      284     3369    5                        WORKA.TWORK.TEXT = ' ';

   3369  1 001012   200006 470500                    LDP0    @WORKA,,AUTO
         1 001013   040100 100400                    MLR     fill='040'O
         1 001014   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001015   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      285     3370    5                        WORKA.TWORK.COUNT = 1;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:47   

   3370  1 001016   001000 236003                    LDQ     512,DU
         1 001017   000000 552140                    STBQ    0,'40'O,PR0

      286     3371    5                      END;

   3371  1 001020   001164 710000 1                  TRA     s:3405

      287     3372    4               CASE( FS_BANNERTEXT5_INT );

      288     3373    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 5)

   3373  1 001021   000010 236000 2                  LDQ     8
         1 001022   200031 756100                    STQ     @VALUE+4,,AUTO
         1 001023   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 001024   200030 455500                    STP5    @VALUE+3,,AUTO
         1 001025   200006 236100                    LDQ     @WORKA,,AUTO
         1 001026   200027 756100                    STQ     @VALUE+2,,AUTO
         1 001027   200010 636500                    EPPR6   BANREC$,,AUTO
         1 001030   200026 456500                    STP6    @VALUE+1,,AUTO
         1 001031   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 001032   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001033   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 001034   001036 702000 1                  TSX2    s:3375
         1 001035   001044 710000 1                  TRA     s:3377

      289     3374    5                   WHENALTRETURN DO;

      290     3375    5                        WORKA.TWORK.TEXT = ' ';

   3375  1 001036   200006 470500                    LDP0    @WORKA,,AUTO
         1 001037   040100 100400                    MLR     fill='040'O
         1 001040   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001041   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      291     3376    5                        WORKA.TWORK.COUNT = 1;

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:48   
   3376  1 001042   001000 236003                    LDQ     512,DU
         1 001043   000000 552140                    STBQ    0,'40'O,PR0

      292     3377    5                      END;

   3377  1 001044   001164 710000 1                  TRA     s:3405

      293     3378    4               CASE( FS_BANNERTEXT6_INT );

      294     3379    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 6)

   3379  1 001045   000011 236000 2                  LDQ     9
         1 001046   200031 756100                    STQ     @VALUE+4,,AUTO
         1 001047   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 001050   200030 455500                    STP5    @VALUE+3,,AUTO
         1 001051   200006 236100                    LDQ     @WORKA,,AUTO
         1 001052   200027 756100                    STQ     @VALUE+2,,AUTO
         1 001053   200010 636500                    EPPR6   BANREC$,,AUTO
         1 001054   200026 456500                    STP6    @VALUE+1,,AUTO
         1 001055   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 001056   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001057   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 001060   001062 702000 1                  TSX2    s:3381
         1 001061   001070 710000 1                  TRA     s:3383

      295     3380    5                   WHENALTRETURN DO;

      296     3381    5                        WORKA.TWORK.TEXT = ' ';

   3381  1 001062   200006 470500                    LDP0    @WORKA,,AUTO
         1 001063   040100 100400                    MLR     fill='040'O
         1 001064   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001065   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      297     3382    5                        WORKA.TWORK.COUNT = 1;

   3382  1 001066   001000 236003                    LDQ     512,DU
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:49   
         1 001067   000000 552140                    STBQ    0,'40'O,PR0

      298     3383    5                      END;

   3383  1 001070   001164 710000 1                  TRA     s:3405

      299     3384    4               CASE( FS_BANNERTEXT7_INT );

      300     3385    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 7)

   3385  1 001071   000012 236000 2                  LDQ     10
         1 001072   200031 756100                    STQ     @VALUE+4,,AUTO
         1 001073   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 001074   200030 455500                    STP5    @VALUE+3,,AUTO
         1 001075   200006 236100                    LDQ     @WORKA,,AUTO
         1 001076   200027 756100                    STQ     @VALUE+2,,AUTO
         1 001077   200010 636500                    EPPR6   BANREC$,,AUTO
         1 001100   200026 456500                    STP6    @VALUE+1,,AUTO
         1 001101   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 001102   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001103   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 001104   001106 702000 1                  TSX2    s:3387
         1 001105   001114 710000 1                  TRA     s:3389

      301     3386    5                   WHENALTRETURN DO;

      302     3387    5                        WORKA.TWORK.TEXT = ' ';

   3387  1 001106   200006 470500                    LDP0    @WORKA,,AUTO
         1 001107   040100 100400                    MLR     fill='040'O
         1 001110   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001111   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      303     3388    5                        WORKA.TWORK.COUNT = 1;

   3388  1 001112   001000 236003                    LDQ     512,DU
         1 001113   000000 552140                    STBQ    0,'40'O,PR0
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:50   

      304     3389    5                      END;

   3389  1 001114   001164 710000 1                  TRA     s:3405

      305     3390    4               CASE( FS_BANNERTEXT8_INT );

      306     3391    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 8)

   3391  1 001115   000013 236000 2                  LDQ     11
         1 001116   200031 756100                    STQ     @VALUE+4,,AUTO
         1 001117   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 001120   200030 455500                    STP5    @VALUE+3,,AUTO
         1 001121   200006 236100                    LDQ     @WORKA,,AUTO
         1 001122   200027 756100                    STQ     @VALUE+2,,AUTO
         1 001123   200010 636500                    EPPR6   BANREC$,,AUTO
         1 001124   200026 456500                    STP6    @VALUE+1,,AUTO
         1 001125   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 001126   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001127   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 001130   001132 702000 1                  TSX2    s:3393
         1 001131   001140 710000 1                  TRA     s:3395

      307     3392    5                   WHENALTRETURN DO;

      308     3393    5                        WORKA.TWORK.TEXT = ' ';

   3393  1 001132   200006 470500                    LDP0    @WORKA,,AUTO
         1 001133   040100 100400                    MLR     fill='040'O
         1 001134   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001135   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      309     3394    5                        WORKA.TWORK.COUNT = 1;

   3394  1 001136   001000 236003                    LDQ     512,DU
         1 001137   000000 552140                    STBQ    0,'40'O,PR0

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:51   
      310     3395    5                      END;

   3395  1 001140   001164 710000 1                  TRA     s:3405

      311     3396    4               CASE( FS_BANNERTEXT9_INT );

      312     3397    4                   CALL FSK$GETBANNERTEXT (BANREC$,WORKA.TWORK,RDFLAG, 9)

   3397  1 001141   000014 236000 2                  LDQ     12
         1 001142   200031 756100                    STQ     @VALUE+4,,AUTO
         1 001143   200015 635500                    EPPR5   RDFLAG,,AUTO
         1 001144   200030 455500                    STP5    @VALUE+3,,AUTO
         1 001145   200006 236100                    LDQ     @WORKA,,AUTO
         1 001146   200027 756100                    STQ     @VALUE+2,,AUTO
         1 001147   200010 636500                    EPPR6   BANREC$,,AUTO
         1 001150   200026 456500                    STP6    @VALUE+1,,AUTO
         1 001151   200026 630500                    EPPR0   @VALUE+1,,AUTO
         1 001152   000022 631400 xsym               EPPR1   B_VECTNIL+18
         1 001153   000000 701000 xent               TSX1    FSK$GETBANNERTEXT
         1 001154   001156 702000 1                  TSX2    s:3399
         1 001155   001164 710000 1                  TRA     s:3405

      313     3398    5                   WHENALTRETURN DO;

      314     3399    5                        WORKA.TWORK.TEXT = ' ';

   3399  1 001156   200006 470500                    LDP0    @WORKA,,AUTO
         1 001157   040100 100400                    MLR     fill='040'O
         1 001160   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         1 001161   000000 200400                    ADSC9   0,,PR0                   cn=1,n=256

      315     3400    5                        WORKA.TWORK.COUNT = 1;

   3400  1 001162   001000 236003                    LDQ     512,DU
         1 001163   000000 552140                    STBQ    0,'40'O,PR0

      316     3401    5                      END;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:52   

      317     3402    4               END;  /* DO CASE ON ENTRIES */

      318     3403                 /* SET THE DELTA VALUES - SINCE THE STRING IS ALWAYS GOING
      319     3404                   TO BE WRITTEN TO THE RIGHT, THIS BECOMES EASY.    */
      320     3405    3            GWRSP.DELTA_Y = 0;

   3405  1 001164   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001165   000012 450100                    STZ     10,,PR0

      321     3406    3            GWRSP.DELTA_Z = 0;

   3406  1 001166   000013 450100                    STZ     11,,PR0

      322     3407    3            CALL SPLIT9X92_18 (GBAN.ENTRIES.CHARSIZE.CHAR_HITE

   3407  1 001167   000002 236100                    LDQ     2,,PR0
         1 001170   000060 402007                    MPY     48,DL
         1 001171   000020 736000                    QLS     16
         1 001172   000015 136000 2                  SBLQ    13
         1 001173   200007 036100                    ADLQ    ENTDISP$,,AUTO
         1 001174   200025 756100                    STQ     HOST+3,,AUTO
         1 001175   002054 701000 1                  TSX1    SPLIT9X92_18
         1 001176   000000 011000                    NOP     0

      323     3408    3                              (GWRSP.CUR_ENT - 1));
      324     3409    3            GWRSP.DELTA_X = HOST18;

   3409  1 001177   200022 235100                    LDA     HOST,,AUTO
         1 001200   000022 771000                    ARL     18
         1 001201   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001202   000011 755100                    STA     9,,PR0

      325     3410    3            CALL SPLIT9X92_18 (GBAN.ENTRIES.CHARSPACE.CHAR_SPACE

   3410  1 001203   000002 236100                    LDQ     2,,PR0
         1 001204   000060 402007                    MPY     48,DL
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:53   
         1 001205   000020 736000                    QLS     16
         1 001206   000016 136000 2                  SBLQ    14
         1 001207   200007 036100                    ADLQ    ENTDISP$,,AUTO
         1 001210   200025 756100                    STQ     HOST+3,,AUTO
         1 001211   002054 701000 1                  TSX1    SPLIT9X92_18
         1 001212   000000 011000                    NOP     0

      326     3411    3                              (GWRSP.CUR_ENT - 1));
      327     3412    3            GWRSP.DELTA_X = GWRSP.DELTA_X + HOST18;

   3412  1 001213   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001214   200022 236100                    LDQ     HOST,,AUTO
         1 001215   000022 772000                    QRL     18
         1 001216   000011 036100                    ADLQ    9,,PR0
         1 001217   000011 756100                    STQ     9,,PR0

      328     3413    3            GWRSP.X_MAX = (GFORM.X_SIZE * %XG_DEFAULT_MAX_NDC#) / BIGGEST;

   3413  1 001220   200003 471500                    LDP1    @GFORM,,AUTO
         1 001221   100007 236100                    LDQ     7,,PR1
         1 001222   777777 376007                    ANQ     -1,DL
         1 001223   077777 402007                    MPY     32767,DL
         1 001224   200012 506100                    DIV     BIGGEST,,AUTO
         1 001225   000006 756100                    STQ     6,,PR0

      329     3414    3            GWRSP.Y_MAX = (GFORM.Y_SIZE * %XG_DEFAULT_MAX_NDC#) / BIGGEST;

   3414  1 001226   100010 236100                    LDQ     8,,PR1
         1 001227   000022 772000                    QRL     18
         1 001230   077777 402007                    MPY     32767,DL
         1 001231   200012 506100                    DIV     BIGGEST,,AUTO
         1 001232   000007 756100                    STQ     7,,PR0

      330     3415    3            GWRSP.Z_MAX = (GFORM.Z_SIZE * %XG_DEFAULT_MAX_NDC#) / BIGGEST;

   3415  1 001233   100010 236100                    LDQ     8,,PR1
         1 001234   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:54   
         1 001235   077777 402007                    MPY     32767,DL
         1 001236   200012 506100                    DIV     BIGGEST,,AUTO
         1 001237   000010 756100                    STQ     8,,PR0

      331     3416    3            GWRSP.X_MAX = GWRSP.X_MAX - GWRSP.DELTA_X;

   3416  1 001240   000006 236100                    LDQ     6,,PR0
         1 001241   000011 136100                    SBLQ    9,,PR0
         1 001242   000006 756100                    STQ     6,,PR0

      332     3417    3            GWRSP.Y_MAX = GWRSP.Y_MAX - GWRSP.DELTA_Y;

   3417  1 001243   000007 236100                    LDQ     7,,PR0
         1 001244   000012 136100                    SBLQ    10,,PR0
         1 001245   000007 756100                    STQ     7,,PR0

      333     3418    3            GWRSP.Z_MAX = GWRSP.Z_MAX - GWRSP.DELTA_Z;

   3418  1 001246   000010 236100                    LDQ     8,,PR0
         1 001247   000013 136100                    SBLQ    11,,PR0
         1 001250   000010 756100                    STQ     8,,PR0

      334     3419    3            BUFFA.TEXT3.OPCODE.CLASS = %XG_COOP_OUTPUT_3#;

   3419  1 001251   200005 473500                    LDP3    @BUFFA,,AUTO
         1 001252   000100 101400                    MRL     fill='000'O
         1 001253   000017 000004 2                  ADSC9   15                       cn=0,n=4
         1 001254   300000 200001                    ADSC9   0,,PR3                   cn=1,n=1

      335     3420    3            BUFFA.TEXT3.OPCODE.INDX = %XG_COOP_TEXT_3#;

   3420  1 001255   000100 101400                    MRL     fill='000'O
         1 001256   000020 000004 2                  ADSC9   16                       cn=0,n=4
         1 001257   300000 400001                    ADSC9   0,,PR3                   cn=2,n=1

      336     3421    3            GWRSP.LINE_CNT = 0;

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:55   
   3421  1 001260   000001 450100                    STZ     1,,PR0

      337     3422    3            GWRSP.CHAR_CNT = 0;    /* NUM OF CHAR TO PRINT */

   3422  1 001261   000000 220003                    LDX0    0,DU
         1 001262   000003 740100                    STX0    3,,PR0

      338     3423    4            DO I = 0 TO WORKA.TWORK.COUNT - 1;

   3423  1 001263   200013 450100                    STZ     I,,AUTO
         1 001264   001473 710000 1                  TRA     s:3460+3

      339     3424    4               IF I <= 35      /* 35 = MAX CHAR ENTRIES TO FIT IN BUFF */

   3424  1 001265   200013 235100                    LDA     I,,AUTO
         1 001266   000044 115007                    CMPA    36,DL
         1 001267   001454 603000 1                  TRC     s:3455

      340     3425    5               THEN DO;

      341     3426    5                  CALL SPLIT9X92_18 (GBAN.ENTRIES.NDC_X_VAL (GWRSP.CUR_ENT - 1));

   3426  1 001270   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001271   000002 236100                    LDQ     2,,PR0
         1 001272   000060 402007                    MPY     48,DL
         1 001273   000020 736000                    QLS     16
         1 001274   000021 136000 2                  SBLQ    17
         1 001275   200007 036100                    ADLQ    ENTDISP$,,AUTO
         1 001276   200025 756100                    STQ     HOST+3,,AUTO
         1 001277   002054 701000 1                  TSX1    SPLIT9X92_18
         1 001300   000000 011000                    NOP     0

      342     3427    5                  XCOORD = ( I * GWRSP.DELTA_X) + HOST18;

   3427  1 001301   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001302   200013 236100                    LDQ     I,,AUTO
         1 001303   000011 402100                    MPY     9,,PR0
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:56   
         1 001304   200022 235100                    LDA     HOST,,AUTO
         1 001305   000022 771000                    ARL     18
         1 001306   200026 755100                    STA     @VALUE+1,,AUTO
         1 001307   200026 036100                    ADLQ    @VALUE+1,,AUTO
         1 001310   000000 620006                    EAX0    0,QL
         1 001311   200016 740100                    STX0    XCOORD,,AUTO

      343     3428    5                  CALL SPLIT9X92_18 (GBAN.ENTRIES.NDC_Y_VAL (GWRSP.CUR_ENT - 1));

   3428  1 001312   000002 236100                    LDQ     2,,PR0
         1 001313   000060 402007                    MPY     48,DL
         1 001314   000020 736000                    QLS     16
         1 001315   000022 136000 2                  SBLQ    18
         1 001316   200007 036100                    ADLQ    ENTDISP$,,AUTO
         1 001317   200025 756100                    STQ     HOST+3,,AUTO
         1 001320   002054 701000 1                  TSX1    SPLIT9X92_18
         1 001321   000000 011000                    NOP     0

      344     3429    5                  YCOORD = ( I * GWRSP.DELTA_Y) + HOST18;

   3429  1 001322   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001323   200013 236100                    LDQ     I,,AUTO
         1 001324   000012 402100                    MPY     10,,PR0
         1 001325   200022 235100                    LDA     HOST,,AUTO
         1 001326   000022 771000                    ARL     18
         1 001327   200026 755100                    STA     @VALUE+1,,AUTO
         1 001330   200026 036100                    ADLQ    @VALUE+1,,AUTO
         1 001331   000000 620006                    EAX0    0,QL
         1 001332   200017 740100                    STX0    YCOORD,,AUTO

      345     3430    5                  CALL SPLIT9X92_18 (GBAN.ENTRIES.NDC_Z_VAL (GWRSP.CUR_ENT - 1));

   3430  1 001333   000002 236100                    LDQ     2,,PR0
         1 001334   000060 402007                    MPY     48,DL
         1 001335   000020 736000                    QLS     16
         1 001336   000023 136000 2                  SBLQ    19
         1 001337   200007 036100                    ADLQ    ENTDISP$,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:57   
         1 001340   200025 756100                    STQ     HOST+3,,AUTO
         1 001341   002054 701000 1                  TSX1    SPLIT9X92_18
         1 001342   000000 011000                    NOP     0

      346     3431    5                  ZCOORD = ( I * GWRSP.DELTA_Z) + HOST18;

   3431  1 001343   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001344   200013 236100                    LDQ     I,,AUTO
         1 001345   000013 402100                    MPY     11,,PR0
         1 001346   200022 235100                    LDA     HOST,,AUTO
         1 001347   000022 771000                    ARL     18
         1 001350   200026 755100                    STA     @VALUE+1,,AUTO
         1 001351   200026 036100                    ADLQ    @VALUE+1,,AUTO
         1 001352   000000 620006                    EAX0    0,QL
         1 001353   200020 740100                    STX0    ZCOORD,,AUTO

      347     3432    5                  IF ((XCOORD > GWRSP.X_MAX) OR (YCOORD > GWRSP.Y_MAX) OR

   3432  1 001354   200016 236100                    LDQ     XCOORD,,AUTO
         1 001355   000022 772000                    QRL     18
         1 001356   000006 116100                    CMPQ    6,,PR0
         1 001357   001361 600000 1                  TZE     s:3432+5
         1 001360   001373 603000 1                  TRC     s:3435
         1 001361   200017 236100                    LDQ     YCOORD,,AUTO
         1 001362   000022 772000                    QRL     18
         1 001363   000007 116100                    CMPQ    7,,PR0
         1 001364   001366 600000 1                  TZE     s:3432+10
         1 001365   001373 603000 1                  TRC     s:3435
         1 001366   200020 236100                    LDQ     ZCOORD,,AUTO
         1 001367   000022 772000                    QRL     18
         1 001370   000010 116100                    CMPQ    8,,PR0
         1 001371   001404 602000 1                  TNC     s:3443
         1 001372   001404 600000 1                  TZE     s:3443

      348     3433    5                      (ZCOORD > GWRSP.Z_MAX) )
      349     3434    6                  THEN DO;

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:58   
      350     3435    6                     GWRSP.CHAR_CNT = 0;

   3435  1 001373   000000 221003                    LDX1    0,DU
         1 001374   000003 741100                    STX1    3,,PR0

      351     3436    6                     IF I > 0

   3436  1 001375   200013 236100                    LDQ     I,,AUTO
         1 001376   001401 600000 1                  TZE     s:3440

      352     3437    7                     THEN DO;

      353     3438    7                        GWRSP.CHAR_CNT = I - 1;/* THIS ENTRY DONE */

   3438  1 001377   777777 620006                    EAX0    -1,QL
         1 001400   000003 740100                    STX0    3,,PR0

      354     3439    7                        END;

      355     3440    6                     I = 9999;  /* CAUSE EXIT FROM LOOP DOING AN ENTRY */

   3440  1 001401   023417 235007                    LDA     9999,DL
         1 001402   200013 755100                    STA     I,,AUTO

      356     3441    6                     END;

   3441  1 001403   001470 710000 1                  TRA     s:3460

      357     3442    6                  ELSE DO;

      358     3443    6                     CALL SPLIT182_9X9 (XCOORD);

   3443  1 001404   200016 631500                    EPPR1   XCOORD,,AUTO
         1 001405   200025 451500                    STP1    HOST+3,,AUTO
         1 001406   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001407   000000 011000                    NOP     0

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:59   
      359     3444    6                     BUFFA.TEXT3.CHAR_ENTRY.X (I) = FEP18;

   3444  1 001410   200013 236100                    LDQ     I,,AUTO
         1 001411   000007 402007                    MPY     7,DL
         1 001412   200005 470500                    LDP0    @BUFFA,,AUTO
         1 001413   000106 100500                    MLR     fill='000'O
         1 001414   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001415   000001 400002                    ADSC9   1,Q,PR0                  cn=2,n=2

      360     3445    6                     CALL SPLIT182_9X9 (YCOORD);

   3445  1 001416   200017 631500                    EPPR1   YCOORD,,AUTO
         1 001417   200025 451500                    STP1    HOST+3,,AUTO
         1 001420   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001421   000000 011000                    NOP     0

      361     3446    6                     BUFFA.TEXT3.CHAR_ENTRY.Y (I) = FEP18;

   3446  1 001422   200013 236100                    LDQ     I,,AUTO
         1 001423   000007 402007                    MPY     7,DL
         1 001424   200005 470500                    LDP0    @BUFFA,,AUTO
         1 001425   000106 100500                    MLR     fill='000'O
         1 001426   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001427   000002 000002                    ADSC9   2,Q,PR0                  cn=0,n=2

      362     3447    6                     CALL SPLIT182_9X9 (ZCOORD);

   3447  1 001430   200020 631500                    EPPR1   ZCOORD,,AUTO
         1 001431   200025 451500                    STP1    HOST+3,,AUTO
         1 001432   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001433   000000 011000                    NOP     0

      363     3448    6                     BUFFA.TEXT3.CHAR_ENTRY.Z (I) = FEP18;

   3448  1 001434   200013 236100                    LDQ     I,,AUTO
         1 001435   000007 402007                    MPY     7,DL
         1 001436   200005 470500                    LDP0    @BUFFA,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:60   
         1 001437   000106 100500                    MLR     fill='000'O
         1 001440   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001441   000002 400002                    ADSC9   2,Q,PR0                  cn=2,n=2

      364     3449    6                     BUFFA.TEXT3.CHAR_ENTRY.CHARACTER (I) =

   3449  1 001442   200006 471500                    LDP1    @WORKA,,AUTO
         1 001443   200013 235100                    LDA     I,,AUTO
         1 001444   040106 100505                    MLR     fill='040'O
         1 001445   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         1 001446   000001 200001                    ADSC9   1,Q,PR0                  cn=1,n=1

      365     3450    6                        SUBSTR (WORKA.TWORK.TEXT, I, 1);
      366     3451    6                     GWRSP.CHAR_CNT = GWRSP.CHAR_CNT + 1;

   3451  1 001447   200004 473500                    LDP3    @GWRSP,,AUTO
         1 001450   300003 220100                    LDX0    3,,PR3
         1 001451   000001 621010                    EAX1    1,X0
         1 001452   300003 741100                    STX1    3,,PR3

      367     3452    6                     END;

      368     3453    5                  END;

   3453  1 001453   001470 710000 1                  TRA     s:3460

      369     3454    5               ELSE DO;

      370     3455    5                  GWRSP.CHAR_CNT = I - 1;

   3455  1 001454   777777 620005                    EAX0    -1,AL
         1 001455   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001456   000003 740100                    STX0    3,,PR0

      371     3456    5                  GWRSP.LINE_CNT = 4; /* THIS MEANS CONTINUE THE LINE */

   3456  1 001457   000004 236007                    LDQ     4,DL
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:61   
         1 001460   000001 756100                    STQ     1,,PR0

      372     3457    5                  GWRSP.CUR_ENT = GWRSP.CUR_ENT - 1; /* CONTINUE */

   3457  1 001461   000002 235100                    LDA     2,,PR0
         1 001462   000001 135007                    SBLA    1,DL
         1 001463   000002 755100                    STA     2,,PR0

      373     3458    5                  I = WORKA.TWORK.COUNT;

   3458  1 001464   200006 471500                    LDP1    @WORKA,,AUTO
         1 001465   100000 236100                    LDQ     0,,PR1
         1 001466   000033 772000                    QRL     27
         1 001467   200013 756100                    STQ     I,,AUTO

      374     3459    5                  END;

      375     3460    4               END;   /* DO WHILE */

   3460  1 001470   200013 235100                    LDA     I,,AUTO
         1 001471   000001 035007                    ADLA    1,DL
         1 001472   200013 755100                    STA     I,,AUTO
         1 001473   200006 470500                    LDP0    @WORKA,,AUTO
         1 001474   000000 236100                    LDQ     0,,PR0
         1 001475   000033 772000                    QRL     27
         1 001476   200013 116100                    CMPQ    I,,AUTO
         1 001477   001501 600000 1                  TZE     s:3462
         1 001500   001265 603000 1                  TRC     s:3424

      376     3461
      377     3462    3            GWRSP.CUR_ENT = GWRSP.CUR_ENT + 1;

   3462  1 001501   200004 471500                    LDP1    @GWRSP,,AUTO
         1 001502   100002 235100                    LDA     2,,PR1
         1 001503   000001 035007                    ADLA    1,DL
         1 001504   100002 755100                    STA     2,,PR1

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:62   
      378     3463    3            CALL SPLIT182_9X9 (GWRSP.CHAR_CNT);

   3463  1 001505   200004 236100                    LDQ     @GWRSP,,AUTO
         1 001506   000003 036003                    ADLQ    3,DU
         1 001507   200025 756100                    STQ     HOST+3,,AUTO
         1 001510   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001511   000000 011000                    NOP     0

      379     3464    3            BUFFA.TEXT3.NUM_CHARS = FEP18;

   3464  1 001512   200005 470500                    LDP0    @BUFFA,,AUTO
         1 001513   000100 100500                    MLR     fill='000'O
         1 001514   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001515   000000 600002                    ADSC9   0,,PR0                   cn=3,n=2

      380     3465    3            GWRSP.MAXBYTES = 4 + (GWRSP.CHAR_CNT * SIZEC (CHAR_ENTRY));

   3465  1 001516   200004 471500                    LDP1    @GWRSP,,AUTO
         1 001517   100003 236100                    LDQ     3,,PR1
         1 001520   000022 772000                    QRL     18
         1 001521   000007 402007                    MPY     7,DL
         1 001522   000004 036007                    ADLQ    4,DL
         1 001523   100005 756100                    STQ     5,,PR1

      381     3466    3            IF (GWRSP.CUR_ENT - 1) = GBAN.NUM_ENTRIES

   3466  1 001524   200007 473500                    LDP3    ENTDISP$,,AUTO
         1 001525   000100 101500                    MRL     fill='000'O
         1 001526   300000 600001                    ADSC9   0,,PR3                   cn=3,n=1
         1 001527   200026 000004                    ADSC9   @VALUE+1,,AUTO           cn=0,n=4
         1 001530   100002 236100                    LDQ     2,,PR1
         1 001531   000001 136007                    SBLQ    1,DL
         1 001532   200026 116100                    CMPQ    @VALUE+1,,AUTO
         1 001533   002032 601000 1                  TNZ     s:3526

      382     3467    4            THEN DO;    /* FINISHED ALL THE ENTRIES FOR THISA PAGE */

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:63   
      383     3468    4               GWRSP.REPEATS = GWRSP.REPEATS - 1;

   3468  1 001534   100004 220100                    LDX0    4,,PR1
         1 001535   777777 621010                    EAX1    -1,X0
         1 001536   100004 741100                    STX1    4,,PR1

      384     3469    4               GWRSP.LINE_CNT = 3; /* END PIX IN 1ST DO CASE */

   3469  1 001537   000003 235007                    LDA     3,DL
         1 001540   100001 755100                    STA     1,,PR1

      385     3470    4               GWRSP.CUR_ENT = 0;

   3470  1 001541   100002 450100                    STZ     2,,PR1

      386     3471    4               END;

   3471  1 001542   002032 710000 1                  TRA     s:3526

      387     3472    3         CASE (4);   /* THIS IS MIDDLE OF CHARACTER LOOP, LINE_CNT=4 */

      388     3473    3            BUFFA.TEXT3.OPCODE.CLASS = %XG_COOP_OUTPUT_3#;

   3473  1 001543   000100 101400                    MRL     fill='000'O
         1 001544   000017 000004 2                  ADSC9   15                       cn=0,n=4
         1 001545   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1

      389     3474    3            BUFFA.TEXT3.OPCODE.INDX = %XG_COOP_TEXT_3#;

   3474  1 001546   000100 101400                    MRL     fill='000'O
         1 001547   000020 000004 2                  ADSC9   16                       cn=0,n=4
         1 001550   100000 400001                    ADSC9   0,,PR1                   cn=2,n=1

      390     3475    3            START_POS = GWRSP.CHAR_CNT;

   3475  1 001551   000003 236100                    LDQ     3,,PR0
         1 001552   000022 772000                    QRL     18
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:64   
         1 001553   200014 756100                    STQ     START_POS,,AUTO

      391     3476    3            GWRSP.LINE_CNT = 0;

   3476  1 001554   000001 450100                    STZ     1,,PR0

      392     3477    3            GWRSP.CHAR_CNT = 0;    /* NUM OF CHAR TO PRINT */

   3477  1 001555   000000 220003                    LDX0    0,DU
         1 001556   000003 740100                    STX0    3,,PR0

      393     3478    4            DO I = 0 TO WORKA.TWORK.COUNT - 1 - START_POS;

   3478  1 001557   200013 450100                    STZ     I,,AUTO
         1 001560   001761 710000 1                  TRA     s:3512+3

      394     3479    4               IF I <= 35      /* 35 = MAX CHAR ENTRIES TO FIT IN BUFF */

   3479  1 001561   200013 235100                    LDA     I,,AUTO
         1 001562   000044 115007                    CMPA    36,DL
         1 001563   001742 603000 1                  TRC     s:3507

      395     3480    5               THEN DO;

      396     3481    5                 XCOORD = ((I + START_POS) * GWRSP.DELTA_X) + GBAN.ENTRIES.NDC_X_VAL (
              3481                           GWRSP.CUR_ENT-1);

   3481  1 001564   200013 236100                    LDQ     I,,AUTO
         1 001565   200014 036100                    ADLQ    START_POS,,AUTO
         1 001566   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001567   000011 402100                    MPY     9,,PR0
         1 001570   200026 756100                    STQ     @VALUE+1,,AUTO
         1 001571   000002 236100                    LDQ     2,,PR0
         1 001572   000060 402007                    MPY     48,DL
         1 001573   200007 471500                    LDP1    ENTDISP$,,AUTO
         1 001574   000100 101506                    MRL     fill='000'O
         1 001575   177774 600002                    ADSC9   -4,Q,PR1                 cn=3,n=2
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:65   
         1 001576   200027 000004                    ADSC9   @VALUE+2,,AUTO           cn=0,n=4
         1 001577   200027 236100                    LDQ     @VALUE+2,,AUTO
         1 001600   200026 036100                    ADLQ    @VALUE+1,,AUTO
         1 001601   000000 620006                    EAX0    0,QL
         1 001602   200016 740100                    STX0    XCOORD,,AUTO

      397     3482    5                 YCOORD = ((I + START_POS) * GWRSP.DELTA_Y) + GBAN.ENTRIES.NDC_Y_VAL (
              3482                           GWRSP.CUR_ENT-1);

   3482  1 001603   200013 236100                    LDQ     I,,AUTO
         1 001604   200014 036100                    ADLQ    START_POS,,AUTO
         1 001605   000012 402100                    MPY     10,,PR0
         1 001606   200026 756100                    STQ     @VALUE+1,,AUTO
         1 001607   000002 236100                    LDQ     2,,PR0
         1 001610   000060 402007                    MPY     48,DL
         1 001611   000100 101506                    MRL     fill='000'O
         1 001612   177775 200002                    ADSC9   -3,Q,PR1                 cn=1,n=2
         1 001613   200027 000004                    ADSC9   @VALUE+2,,AUTO           cn=0,n=4
         1 001614   200027 236100                    LDQ     @VALUE+2,,AUTO
         1 001615   200026 036100                    ADLQ    @VALUE+1,,AUTO
         1 001616   000000 621006                    EAX1    0,QL
         1 001617   200017 741100                    STX1    YCOORD,,AUTO

      398     3483    5                 ZCOORD = ((I + START_POS) * GWRSP.DELTA_Z) + GBAN.ENTRIES.NDC_Z_VAL (
              3483                           GWRSP.CUR_ENT-1);

   3483  1 001620   200013 236100                    LDQ     I,,AUTO
         1 001621   200014 036100                    ADLQ    START_POS,,AUTO
         1 001622   000013 402100                    MPY     11,,PR0
         1 001623   200026 756100                    STQ     @VALUE+1,,AUTO
         1 001624   000002 236100                    LDQ     2,,PR0
         1 001625   000060 402007                    MPY     48,DL
         1 001626   000100 101506                    MRL     fill='000'O
         1 001627   177775 600002                    ADSC9   -3,Q,PR1                 cn=3,n=2
         1 001630   200027 000004                    ADSC9   @VALUE+2,,AUTO           cn=0,n=4
         1 001631   200027 236100                    LDQ     @VALUE+2,,AUTO
         1 001632   200026 036100                    ADLQ    @VALUE+1,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:66   
         1 001633   000000 622006                    EAX2    0,QL
         1 001634   200020 742100                    STX2    ZCOORD,,AUTO

      399     3484    5                  IF ((XCOORD > GWRSP.X_MAX) OR (YCOORD > GWRSP.Y_MAX) OR

   3484  1 001635   200016 236100                    LDQ     XCOORD,,AUTO
         1 001636   000022 772000                    QRL     18
         1 001637   000006 116100                    CMPQ    6,,PR0
         1 001640   001642 600000 1                  TZE     s:3484+5
         1 001641   001654 603000 1                  TRC     s:3487
         1 001642   200017 236100                    LDQ     YCOORD,,AUTO
         1 001643   000022 772000                    QRL     18
         1 001644   000007 116100                    CMPQ    7,,PR0
         1 001645   001647 600000 1                  TZE     s:3484+10
         1 001646   001654 603000 1                  TRC     s:3487
         1 001647   200020 236100                    LDQ     ZCOORD,,AUTO
         1 001650   000022 772000                    QRL     18
         1 001651   000010 116100                    CMPQ    8,,PR0
         1 001652   001665 602000 1                  TNC     s:3495
         1 001653   001665 600000 1                  TZE     s:3495

      400     3485    5                      (ZCOORD > GWRSP.Z_MAX) )
      401     3486    6                  THEN DO;

      402     3487    6                     GWRSP.CHAR_CNT = 0;

   3487  1 001654   000000 223003                    LDX3    0,DU
         1 001655   000003 743100                    STX3    3,,PR0

      403     3488    6                     IF I > 0

   3488  1 001656   200013 235100                    LDA     I,,AUTO
         1 001657   001662 600000 1                  TZE     s:3492

      404     3489    7                     THEN DO;

      405     3490    7                        GWRSP.CHAR_CNT = I - 1;/* THIS ENTRY DONE */
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:67   

   3490  1 001660   777777 620005                    EAX0    -1,AL
         1 001661   000003 740100                    STX0    3,,PR0

      406     3491    7                        END;

      407     3492    6                     I = 9999;  /* CAUSE EXIT FROM LOOP DOING AN ENTRY */

   3492  1 001662   023417 236007                    LDQ     9999,DL
         1 001663   200013 756100                    STQ     I,,AUTO

      408     3493    6                     END;

   3493  1 001664   001756 710000 1                  TRA     s:3512

      409     3494    6                  ELSE DO;

      410     3495    6                     CALL SPLIT182_9X9 (XCOORD);

   3495  1 001665   200016 633500                    EPPR3   XCOORD,,AUTO
         1 001666   200025 453500                    STP3    HOST+3,,AUTO
         1 001667   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001670   000000 011000                    NOP     0

      411     3496    6                     BUFFA.TEXT3.CHAR_ENTRY.X (I) = FEP18;

   3496  1 001671   200013 236100                    LDQ     I,,AUTO
         1 001672   000007 402007                    MPY     7,DL
         1 001673   200005 470500                    LDP0    @BUFFA,,AUTO
         1 001674   000106 100500                    MLR     fill='000'O
         1 001675   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001676   000001 400002                    ADSC9   1,Q,PR0                  cn=2,n=2

      412     3497    6                     CALL SPLIT182_9X9 (YCOORD);

   3497  1 001677   200017 631500                    EPPR1   YCOORD,,AUTO
         1 001700   200025 451500                    STP1    HOST+3,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:68   
         1 001701   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001702   000000 011000                    NOP     0

      413     3498    6                     BUFFA.TEXT3.CHAR_ENTRY.Y (I) = FEP18;

   3498  1 001703   200013 236100                    LDQ     I,,AUTO
         1 001704   000007 402007                    MPY     7,DL
         1 001705   200005 470500                    LDP0    @BUFFA,,AUTO
         1 001706   000106 100500                    MLR     fill='000'O
         1 001707   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001710   000002 000002                    ADSC9   2,Q,PR0                  cn=0,n=2

      414     3499    6                     CALL SPLIT182_9X9 (ZCOORD);

   3499  1 001711   200020 631500                    EPPR1   ZCOORD,,AUTO
         1 001712   200025 451500                    STP1    HOST+3,,AUTO
         1 001713   002033 701000 1                  TSX1    SPLIT182_9X9
         1 001714   000000 011000                    NOP     0

      415     3500    6                     BUFFA.TEXT3.CHAR_ENTRY.Z (I) = FEP18;

   3500  1 001715   200013 236100                    LDQ     I,,AUTO
         1 001716   000007 402007                    MPY     7,DL
         1 001717   200005 470500                    LDP0    @BUFFA,,AUTO
         1 001720   000106 100500                    MLR     fill='000'O
         1 001721   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 001722   000002 400002                    ADSC9   2,Q,PR0                  cn=2,n=2

      416     3501    6                     BUFFA.TEXT3.CHAR_ENTRY.CHARACTER (I) =

   3501  1 001723   200013 236100                    LDQ     I,,AUTO
         1 001724   200014 036100                    ADLQ    START_POS,,AUTO
         1 001725   200026 756100                    STQ     @VALUE+1,,AUTO
         1 001726   200013 236100                    LDQ     I,,AUTO
         1 001727   000007 402007                    MPY     7,DL
         1 001730   200006 471500                    LDP1    @WORKA,,AUTO
         1 001731   200026 235100                    LDA     @VALUE+1,,AUTO
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:69   
         1 001732   040106 100505                    MLR     fill='040'O
         1 001733   100000 200001                    ADSC9   0,A,PR1                  cn=1,n=1
         1 001734   000001 200001                    ADSC9   1,Q,PR0                  cn=1,n=1

      417     3502    6                        SUBSTR (WORKA.TWORK.TEXT, (I + START_POS), 1);
      418     3503    6                     GWRSP.CHAR_CNT = GWRSP.CHAR_CNT + 1;

   3503  1 001735   200004 473500                    LDP3    @GWRSP,,AUTO
         1 001736   300003 220100                    LDX0    3,,PR3
         1 001737   000001 621010                    EAX1    1,X0
         1 001740   300003 741100                    STX1    3,,PR3

      419     3504    6                     END;

      420     3505    5                  END;

   3505  1 001741   001756 710000 1                  TRA     s:3512

      421     3506    5               ELSE DO;

      422     3507    5                  GWRSP.CHAR_CNT = I - 1;

   3507  1 001742   777777 620005                    EAX0    -1,AL
         1 001743   200004 470500                    LDP0    @GWRSP,,AUTO
         1 001744   000003 740100                    STX0    3,,PR0

      423     3508    5                  GWRSP.LINE_CNT = 4; /* THIS MEANS CONTINUE THE LINE */

   3508  1 001745   000004 236007                    LDQ     4,DL
         1 001746   000001 756100                    STQ     1,,PR0

      424     3509    5                  GWRSP.CUR_ENT = GWRSP.CUR_ENT - 1; /* CONTINUE */

   3509  1 001747   000002 235100                    LDA     2,,PR0
         1 001750   000001 135007                    SBLA    1,DL
         1 001751   000002 755100                    STA     2,,PR0

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:70   
      425     3510    5                  I = WORKA.TWORK.COUNT;

   3510  1 001752   200006 471500                    LDP1    @WORKA,,AUTO
         1 001753   100000 236100                    LDQ     0,,PR1
         1 001754   000033 772000                    QRL     27
         1 001755   200013 756100                    STQ     I,,AUTO

      426     3511    5                  END;

      427     3512    4               END;   /* DO WHILE */

   3512  1 001756   200013 235100                    LDA     I,,AUTO
         1 001757   000001 035007                    ADLA    1,DL
         1 001760   200013 755100                    STA     I,,AUTO
         1 001761   200006 470500                    LDP0    @WORKA,,AUTO
         1 001762   000000 236100                    LDQ     0,,PR0
         1 001763   000033 772000                    QRL     27
         1 001764   200014 136100                    SBLQ    START_POS,,AUTO
         1 001765   001771 604000 1                  TMI     s:3514
         1 001766   200013 116100                    CMPQ    I,,AUTO
         1 001767   001771 600000 1                  TZE     s:3514
         1 001770   001561 603000 1                  TRC     s:3479

      428     3513
      429     3514    3            GWRSP.CUR_ENT = GWRSP.CUR_ENT + 1;

   3514  1 001771   200004 471500                    LDP1    @GWRSP,,AUTO
         1 001772   100002 235100                    LDA     2,,PR1
         1 001773   000001 035007                    ADLA    1,DL
         1 001774   100002 755100                    STA     2,,PR1

      430     3515    3            CALL SPLIT182_9X9 (GWRSP.CHAR_CNT);

   3515  1 001775   200004 236100                    LDQ     @GWRSP,,AUTO
         1 001776   000003 036003                    ADLQ    3,DU
         1 001777   200025 756100                    STQ     HOST+3,,AUTO
         1 002000   002033 701000 1                  TSX1    SPLIT182_9X9
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:71   
         1 002001   000000 011000                    NOP     0

      431     3516    3            BUFFA.TEXT3.NUM_CHARS = FEP18;

   3516  1 002002   200005 470500                    LDP0    @BUFFA,,AUTO
         1 002003   000100 100500                    MLR     fill='000'O
         1 002004   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2
         1 002005   000000 600002                    ADSC9   0,,PR0                   cn=3,n=2

      432     3517    3            GWRSP.MAXBYTES = (GWRSP.CHAR_CNT * SIZEC (CHAR_ENTRY)) + 4;

   3517  1 002006   200004 471500                    LDP1    @GWRSP,,AUTO
         1 002007   100003 236100                    LDQ     3,,PR1
         1 002010   000022 772000                    QRL     18
         1 002011   000007 402007                    MPY     7,DL
         1 002012   000004 036007                    ADLQ    4,DL
         1 002013   100005 756100                    STQ     5,,PR1

      433     3518    3            IF (GWRSP.CUR_ENT - 1) = GBAN.NUM_ENTRIES

   3518  1 002014   200007 473500                    LDP3    ENTDISP$,,AUTO
         1 002015   000100 101500                    MRL     fill='000'O
         1 002016   300000 600001                    ADSC9   0,,PR3                   cn=3,n=1
         1 002017   200026 000004                    ADSC9   @VALUE+1,,AUTO           cn=0,n=4
         1 002020   100002 236100                    LDQ     2,,PR1
         1 002021   000001 136007                    SBLQ    1,DL
         1 002022   200026 116100                    CMPQ    @VALUE+1,,AUTO
         1 002023   002032 601000 1                  TNZ     s:3526

      434     3519    4            THEN DO;    /* FINISHED ALL THE ENTRIES FOR THISA PAGE */

      435     3520    4               GWRSP.REPEATS = GWRSP.REPEATS - 1;

   3520  1 002024   100004 220100                    LDX0    4,,PR1
         1 002025   777777 621010                    EAX1    -1,X0
         1 002026   100004 741100                    STX1    4,,PR1

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:72   
      436     3521    4               GWRSP.LINE_CNT = 3; /* END PIX IN 1ST DO CASE */

   3521  1 002027   000003 235007                    LDA     3,DL
         1 002030   100001 755100                    STA     1,,PR1

      437     3522    4               GWRSP.CUR_ENT = 0;

   3522  1 002031   100002 450100                    STZ     2,,PR1

      438     3523    4               END;

      439     3524    3         END; /* DO CASE */

      440     3525    2      END; /* THIS GETS US TO THE OUTERMOST LEVEL */

      441     3526    1   RETURN;

   3526  1 002032   000000 702200 xent               TSX2  ! X66_ARET

      442     3527        /* ROUTINE TO CONVERT A HOST 18 BIT TO A FEP 18 BIT */
      443     3528    1   SPLIT182_9X9: PROC (VALUE);

   3528  1 002033   200024 741300       SPLIT182_9X9 STX1  ! HOST+2,,AUTO

      444     3529    2   DCL VALUE UBIN (18) HALIGNED;
      445     3530
      446     3531    2   FEP18 = 0;

   3531  1 002034   000000 220003                    LDX0    0,DU
         1 002035   200021 740100                    STX0    FEP,,AUTO

      447     3532    2   HOST18 = VALUE;

   3532  1 002036   200025 470500                    LDP0    @VALUE,,AUTO
         1 002037   000100 100500                    MLR     fill='000'O
         1 002040   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         1 002041   200022 000002                    ADSC9   HOST,,AUTO               cn=0,n=2
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:73   

      448     3533    2   FEP.U = HOST.U;

   3533  1 002042   200022 236100                    LDQ     HOST,,AUTO
         1 002043   000001 736000                    QLS     1
         1 002044   200021 676100                    ERQ     FEP,,AUTO
         1 002045   377000 376003                    ANQ     130560,DU
         1 002046   200021 656100                    ERSQ    FEP,,AUTO

      449     3534    2   FEP.L = HOST.L;

   3534  1 002047   200022 236100                    LDQ     HOST,,AUTO
         1 002050   200021 676100                    ERQ     FEP,,AUTO
         1 002051   000377 376003                    ANQ     255,DU
         1 002052   200021 656100                    ERSQ    FEP,,AUTO

      450     3535    2   RETURN;

   3535  1 002053   000001 702211                    TSX2  ! 1,X1

      451     3536    2   END SPLIT182_9X9;
      452     3537
      453     3538        /* ROUTINE TO CONVERT A FEP 18 BIT TO A HOST 18 BIT */
      454     3539    1   SPLIT9X92_18: PROC (VALUE);

   3539  1 002054   200024 741300       SPLIT9X92_18 STX1  ! HOST+2,,AUTO

      455     3540    2   DCL VALUE UBIN (18) HALIGNED;
      456     3541
      457     3542    2   FEP18 = VALUE;

   3542  1 002055   200025 470500                    LDP0    @VALUE,,AUTO
         1 002056   000100 100500                    MLR     fill='000'O
         1 002057   000000 000002                    ADSC9   0,,PR0                   cn=0,n=2
         1 002060   200021 000002                    ADSC9   FEP,,AUTO                cn=0,n=2

      458     3543    2   HOST18 = 0;
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:74   

   3543  1 002061   000000 220003                    LDX0    0,DU
         1 002062   200022 740100                    STX0    HOST,,AUTO

      459     3544    2   HOST.U = FEP.U;

   3544  1 002063   200021 236100                    LDQ     FEP,,AUTO
         1 002064   000001 772000                    QRL     1
         1 002065   200022 676100                    ERQ     HOST,,AUTO
         1 002066   177400 376003                    ANQ     65280,DU
         1 002067   200022 656100                    ERSQ    HOST,,AUTO

      460     3545    2   HOST.L = FEP.L;

   3545  1 002070   200021 236100                    LDQ     FEP,,AUTO
         1 002071   200022 676100                    ERQ     HOST,,AUTO
         1 002072   000377 376003                    ANQ     255,DU
         1 002073   200022 656100                    ERSQ    HOST,,AUTO

      461     3546    2   RETURN;

   3546  1 002074   000001 702211                    TSX2  ! 1,X1

BEGIN_PICTURE_CMD
 Sect OctLoc
   0     000   224002 000002   017001 ******                                    ........

SET_CHARPRECISION_CMD
 Sect OctLoc
   0     002   205011 002***                                                    ....

NEW_FRAME_CMD
 Sect OctLoc
   0     003   224003 ******                                                    ....

(unnamed)
 Sect OctLoc
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:75   
   0     004   115115 057104   104057 131131   110110 072115   115040 040040    MM/DD/YYHH:MM

(unnamed)
 Sect OctLoc
   2     000   000015 200000   036040 040040   160040 040040   000002 006000    .....   p   ....
   2     004   000003 006000   000004 006000   000005 006000   000006 006000    ................
   2     010   000007 006000   000010 006000   000011 006000   000012 006000    ................
   2     014   000013 006000   000007 600000   000005 600000   000000 000202    ................
   2     020   000000 000377   000003 200000   000002 600000   000002 200000    ................
      462     3547    2   END SPLIT9X92_18;
      463     3548
      464     3549    1   END FSK$GBANNER;

PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:76   
--  Include file information  --

   FM$FIT.:E05TOU  is referenced.
   F$DCB.:E05TOU  cannot be made into a system file and is referenced.
   FS$FIT.:E05TOU  is referenced.
   UM_CP6.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  is referenced.
   XG_SUBS_C.:E05TOU  is referenced.
   FS_SUPER_C.:E05TOU  is referenced.
      No diagnostics issued in procedure FSK$GBANNER.
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:77   

 **** Variables and constants ****

  ****  Section 000 RoData FSK$GBANNER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(6)     r     1 BEGIN_PICTURE_CHAR         0-0-0/b STRC(54)    r     1 BEGIN_PICTURE_CMD
     3-0-0/c CHAR(2)     r     1 NEW_FRAME_CHAR             3-0-0/b STRC(18)    r     1 NEW_FRAME_CMD
     2-0-0/c CHAR(3)     r     1 SET_CHARPRECISION_CHAR
     2-0-0/b STRC(27)    r     1 SET_CHARPRECISION_CMD

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     5-0-0/w PTR         r     1 @BUFFA                     3-0-0/w PTR         r     1 @GFORM
     4-0-0/w PTR         r     1 @GWRSP                    25-0-0/w PTR         r     1 @VALUE
    25-0-0/w PTR         r     1 @VALUE                     6-0-0/w PTR         r     1 @WORKA
    10-0-0/w PTR         r     1 BANREC$                   12-0-0/w SBIN        r     1 BIGGEST
    *0-0-0/c STRC(2304)  r     1 BUFFA                     11-0-0/w PTR         r     1 CHAR$
     7-0-0/w PTR         r     1 ENTDISP$                  21-0-0/h STRC(18)    r     1 FEP
    21-0-0/h UBIN(18)    r     1 FEP18                     *0-0-0/w STRC(756)   r     1 GFORM
    *0-0-0/w STRC(756)   r     1 GWRSP                     22-0-0/h STRC(18)    r     1 HOST
    22-0-0/h UBIN(18)    r     1 HOST18                    13-0-0/w UBIN        r     1 I
    15-0-0/b BIT         r     1 RDFLAG                    14-0-0/w UBIN        r     1 START_POS
    *0-0-0/h UBIN(18)    r     1 VALUE                     *0-0-0/h UBIN(18)    r     1 VALUE
    *0-0-0/w STRC(2313)  r     1 WORKA                     16-0-0/w UBIN(18)    r     1 XCOORD
    17-0-0/w UBIN(18)    r     1 YCOORD                    20-0-0/w UBIN(18)    r     1 ZCOORD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$JIT$
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:78   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(5760)  r     1 B$JIT                      0-0-0/c STRC(63)    r     1 CHAR_ENTRY
     0-0-0/w STRC(1404)  r     1 CODE16                     0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/w STRC(171)   r     1 FS_OSFN                    0-0-0/c STRC(468)   r     1 GBAN
     0-0-0/d STRC(2232)  r     1 SITEINFO                   0-0-0/c CHAR(256)   r     1 TEXT
     0-0-0/c CHAR        r     1 TEXT2(0:0)


   Procedure FSK$GBANNER requires 1085 words for executable code.
   Procedure FSK$GBANNER requires 26 words of local(AUTO) storage.

    No errors detected in file FSK$GBANNER.:E05TSI    .
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:79   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:80   
          MINI XREF LISTING

B$JIT.ACCN
      1765**DCL      3302--ASSIGN   3303--CALLBLT  3303>>CALLBLT
B$JIT.CPFLAGS1.SLEAZE
      1859**DCL      1859--REDEF
B$JIT.ERR.MID
      1766**DCL      1766--REDEF
B$JIT.JOBNAME
      1914**DCL      3311--ASSIGN   3312--CALLBLT  3312>>CALLBLT
B$JIT.SYSID
      1765**DCL      3299>>ASSIGN
B$JIT.UNAME
      1765**DCL      3305--ASSIGN   3306--CALLBLT  3306>>CALLBLT
B$JIT.WOO
      1765**DCL      3308--ASSIGN   3309--CALLBLT  3309>>CALLBLT
B$JIT$
      1925**DCL      1760--IMP-PTR  3312>>CALLBLT
BANREC$
      3157**DCL      3208<<ASSIGN   3343<>CALL     3349<>CALL     3355<>CALL     3361<>CALL     3367<>CALL
      3373<>CALL     3379<>CALL     3385<>CALL     3391<>CALL     3397<>CALL
BEGIN_PICTURE_CHAR
      3143**DCL      3238>>ASSIGN   3239--ASSIGN
BEGIN_PICTURE_CMD
      3136**DCL      3143--REDEF
BIGGEST
      3159**DCL      3211<<ASSIGN   3212>>IF       3212>>IF       3413>>ASSIGN   3414>>ASSIGN   3415>>ASSIGN
BUFFA
      1370**DCL         6--PROC
BUFFA.TEXT
      1372**DCL      1373--REDEF    3231<<ASSIGN   3238<<ASSIGN   3243<<ASSIGN   3247<<ASSIGN   3253<<ASSIGN
      3273<<ASSIGN   3277<<ASSIGN   3281<<ASSIGN
BUFFA.TEXT3.CHAR_ENTRY.CHARACTER
      1379**DCL      3449<<ASSIGN   3501<<ASSIGN
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:81   
BUFFA.TEXT3.CHAR_ENTRY.X
      1380**DCL      3444<<ASSIGN   3496<<ASSIGN
BUFFA.TEXT3.CHAR_ENTRY.Y
      1381**DCL      3446<<ASSIGN   3498<<ASSIGN
BUFFA.TEXT3.CHAR_ENTRY.Z
      1382**DCL      3448<<ASSIGN   3500<<ASSIGN
BUFFA.TEXT3.NUM_CHARS
      1377**DCL      3464<<ASSIGN   3516<<ASSIGN
BUFFA.TEXT3.OPCODE.CLASS
      1375**DCL      3419<<ASSIGN   3473<<ASSIGN
BUFFA.TEXT3.OPCODE.INDX
      1376**DCL      3420<<ASSIGN   3474<<ASSIGN
BUFFA.VFC
      1371**DCL      3209<<ASSIGN   3237<<ASSIGN
CHAR$
      3158**DCL      3288<<ASSIGN   3290>>ASSIGN   3292<<ASSIGN   3295>>ASSIGN
CHAR_ENTRY
      3181**DCL      3465--ASSIGN   3517--ASSIGN
CODE16.FORM
      3127**DCL      3337--ASSIGN   3338--CALLBLT  3338>>CALLBLT
ENTDISP$
      1385**DCL      1396--IMP-PTR  3190<<ASSIGN   3191>>ASSIGN   3210<<ASSIGN   3222<<ASSIGN   3229>>IF
      3273>>ASSIGN   3277>>ASSIGN   3281>>ASSIGN   3286>>DOCASE   3288>>ASSIGN   3288>>ASSIGN   3289>>ASSIGN
      3295>>ASSIGN   3407>>CALL     3410>>CALL     3426>>CALL     3428>>CALL     3430>>CALL     3466>>IF
      3481>>ASSIGN   3482>>ASSIGN   3483>>ASSIGN   3518>>IF
F$DCB.ACTPOS
      2882**DCL      2882--REDEF
F$DCB.ARS
      2857**DCL      2857--REDEF
F$DCB.ATTR
      2875**DCL      2876--REDEF
F$DCB.BORROW
      2890**DCL      2890--REDEF    2890--REDEF    2890--REDEF
F$DCB.DCBNAME.L
      2904**DCL      2904--IMP-SIZ
F$DCB.EOMCHAR
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:82   
      2861**DCL      2861--REDEF
F$DCB.FLDID
      2885**DCL      2885--REDEF
F$DCB.FORM$
      2879**DCL      2879--REDEF    3338>>CALLBLT
F$DCB.FSECT
      2895**DCL      2895--REDEF
F$DCB.FSN
      2872**DCL      2872--REDEF    2872--REDEF    2873--REDEF
F$DCB.HEADER$
      2878**DCL      2878--REDEF
F$DCB.IXTNSIZE
      2876**DCL      2876--REDEF
F$DCB.LASTSTA$
      2866**DCL      2866--REDEF
F$DCB.LVL
      2891**DCL      2891--REDEF
F$DCB.NAME
      2866**DCL      3321--CALLBLT
F$DCB.NAME.C
      2866**DCL      2866--REDEF
F$DCB.NOEOF
      2887**DCL      2887--REDEF
F$DCB.NRECS
      2877**DCL      2877--REDEF
F$DCB.NRECX
      2896**DCL      2896--REDEF
F$DCB.OHDR
      2888**DCL      2888--REDEF
F$DCB.ORG
      2871**DCL      2871--REDEF
F$DCB.PRECNO
      2894**DCL      2894--REDEF
F$DCB.RCSZ
      2899**DCL      2899--REDEF
F$DCB.RES
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:83   
      2867**DCL      2867--REDEF
F$DCB.SETX
      2879**DCL      2879--REDEF
F$DCB.TAB$
      2878**DCL      2879--REDEF
F$DCB.TDA
      2893**DCL      2893--REDEF
F$DCB.WSN
      2868**DCL      2868--REDEF    3334--ASSIGN   3335--CALLBLT  3335>>CALLBLT
FEP
      3168**DCL      3173--REDEF
FEP.L
      3172**DCL      3534<<ASSIGN   3545>>ASSIGN
FEP.U
      3170**DCL      3533<<ASSIGN   3544>>ASSIGN
FEP18
      3173**DCL      3444>>ASSIGN   3446>>ASSIGN   3448>>ASSIGN   3464>>ASSIGN   3496>>ASSIGN   3498>>ASSIGN
      3500>>ASSIGN   3516>>ASSIGN   3531<<ASSIGN   3542<<ASSIGN
FSK$GETBANNERTEXT
      3134**DCL-ENT  3343--CALL     3349--CALL     3355--CALL     3361--CALL     3367--CALL     3373--CALL
      3379--CALL     3385--CALL     3391--CALL     3397--CALL
FS_OSFN.NUM
      2854**DCL      3321>>CALLBLT
GBAN
      1396**DCL      3288--ASSIGN
GBAN.CHARGE
      1397**DCL      1398--REDEF
GBAN.ENTRIES.CHARSIZE
      1414**DCL      1420--REDEF
GBAN.ENTRIES.CHARSIZE.CHAR_HITE
      1419**DCL      3407<>CALL
GBAN.ENTRIES.CHARSPACE
      1423**DCL      1428--REDEF
GBAN.ENTRIES.CHARSPACE.CHAR_SPACE
      1427**DCL      3410<>CALL
GBAN.ENTRIES.CHARUP
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:84   
      1405**DCL      1412--REDEF
GBAN.ENTRIES.CHR
      1438**DCL      3295>>ASSIGN
GBAN.ENTRIES.COUNT
      1437**DCL      1438--REDEF    3289>>ASSIGN
GBAN.ENTRIES.DISP
      1439**DCL      3288>>ASSIGN
GBAN.ENTRIES.NDC_X_VAL
      1433**DCL      3426<>CALL     3481>>ASSIGN
GBAN.ENTRIES.NDC_Y_VAL
      1434**DCL      3428<>CALL     3482>>ASSIGN
GBAN.ENTRIES.NDC_Z_VAL
      1435**DCL      3430<>CALL     3483>>ASSIGN
GBAN.ENTRIES.SET_CHARSIZE_CMD
      1420**DCL      3273>>ASSIGN   3274--ASSIGN
GBAN.ENTRIES.SET_CHARSPACE_CMD
      1428**DCL      3277>>ASSIGN   3278--ASSIGN
GBAN.ENTRIES.SET_CHARUP_CMD
      1412**DCL      3281>>ASSIGN   3282--ASSIGN
GBAN.ENTRIES.TYPE
      1436**DCL      3286>>DOCASE
GBAN.NUM_ENTRIES
      1403**DCL      3466>>IF       3518>>IF
GBAN.REPEATS
      1401**DCL      3191>>ASSIGN
GFORM
      1275**DCL         6--PROC     3189--ASSIGN   3222--ASSIGN   3229--IF
GFORM.ALGNDISP
      1281**DCL      3197>>IF
GFORM.SET_DEV_LIM
      1306**DCL      1323--REDEF
GFORM.SET_DEV_LIM_CMD
      1323**DCL      3231>>ASSIGN   3232--ASSIGN   3243>>ASSIGN   3244--ASSIGN
GFORM.X_SIZE
      1300**DCL      3211>>ASSIGN   3212>>IF       3413>>ASSIGN
GFORM.Y_SIZE
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:85   
      1301**DCL      3211>>ASSIGN   3212>>IF       3414>>ASSIGN
GFORM.Z_SIZE
      1302**DCL      3211>>ASSIGN   3212>>IF       3415>>ASSIGN
GWRSP
      1327**DCL         6--PROC
GWRSP.CHAR_CNT
      1331**DCL      3422<<ASSIGN   3435<<ASSIGN   3438<<ASSIGN   3451<<ASSIGN   3451>>ASSIGN   3455<<ASSIGN
      3463<>CALL     3465>>ASSIGN   3475>>ASSIGN   3477<<ASSIGN   3487<<ASSIGN   3490<<ASSIGN   3503<<ASSIGN
      3503>>ASSIGN   3507<<ASSIGN   3515<>CALL     3517>>ASSIGN
GWRSP.CUR_ENT
      1330**DCL      3192<<ASSIGN   3220<<ASSIGN   3225>>IF       3250<<ASSIGN   3260<<ASSIGN   3273>>ASSIGN
      3274>>ASSIGN   3277>>ASSIGN   3278>>ASSIGN   3281>>ASSIGN   3282>>ASSIGN   3286>>DOCASE   3288>>ASSIGN
      3289>>ASSIGN   3295>>ASSIGN   3407>>CALL     3410>>CALL     3426>>CALL     3428>>CALL     3430>>CALL
      3457<<ASSIGN   3457>>ASSIGN   3462<<ASSIGN   3462>>ASSIGN   3466>>IF       3470<<ASSIGN   3481>>ASSIGN
      3482>>ASSIGN   3483>>ASSIGN   3509<<ASSIGN   3509>>ASSIGN   3514<<ASSIGN   3514>>ASSIGN   3518>>IF
      3522<<ASSIGN
GWRSP.DATE
      1341**DCL      3195<<ASSIGN   3201<>CALL     3318>>CALLBLT
GWRSP.DATE_TIME
      1348**DCL      3199>>IF       3201>>CALL
GWRSP.DELTA_X
      1337**DCL      3409<<ASSIGN   3412<<ASSIGN   3412>>ASSIGN   3416>>ASSIGN   3427>>ASSIGN   3481>>ASSIGN
GWRSP.DELTA_Y
      1338**DCL      3405<<ASSIGN   3417>>ASSIGN   3429>>ASSIGN   3482>>ASSIGN
GWRSP.DELTA_Z
      1339**DCL      3406<<ASSIGN   3418>>ASSIGN   3431>>ASSIGN   3483>>ASSIGN
GWRSP.ENTDISP
      1346**DCL      3189>>ASSIGN   3197>>IF
GWRSP.ENTDISP$
      1345**DCL      1346--REDEF    3189<<ASSIGN   3190>>ASSIGN   3210>>ASSIGN
GWRSP.JIT$
      1344**DCL      3299>>ASSIGN   3303>>CALLBLT  3306>>CALLBLT  3309>>CALLBLT
GWRSP.LINE_CNT
      1329**DCL      3193<<ASSIGN   3221<<ASSIGN   3227>>DOCASE   3233<<ASSIGN   3240<<ASSIGN   3240>>ASSIGN
      3245<<ASSIGN   3245>>ASSIGN   3249<<ASSIGN   3249>>ASSIGN   3251<<ASSIGN   3257<<ASSIGN   3261<<ASSIGN
      3271>>DOCASE   3275<<ASSIGN   3275>>ASSIGN   3279<<ASSIGN   3279>>ASSIGN   3283<<ASSIGN   3283>>ASSIGN
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:86   
      3421<<ASSIGN   3456<<ASSIGN   3469<<ASSIGN   3476<<ASSIGN   3508<<ASSIGN   3521<<ASSIGN
GWRSP.MAXBYTES
      1333**DCL      3232<<ASSIGN   3239<<ASSIGN   3244<<ASSIGN   3248<<ASSIGN   3254<<ASSIGN   3274<<ASSIGN
      3278<<ASSIGN   3282<<ASSIGN   3465<<ASSIGN   3517<<ASSIGN
GWRSP.REPEATS
      1332**DCL      3191<<ASSIGN   3255>>IF       3468<<ASSIGN   3468>>ASSIGN   3520<<ASSIGN   3520>>ASSIGN
GWRSP.SITEINFO
      1347**DCL      3324>>CALLBLT  3326>>ASSIGN   3328>>CALLBLT  3330>>ASSIGN   3332>>CALLBLT  3341>>CALLBLT
GWRSP.START
      1328**DCL      3187>>IF       3205<<ASSIGN   3236<<ASSIGN   3264<<ASSIGN
GWRSP.SUBFILE$
      1343**DCL      3321>>CALLBLT  3335>>CALLBLT  3338>>CALLBLT
GWRSP.TIME
      1340**DCL      3196<<ASSIGN   3201<>CALL     3315>>CALLBLT
GWRSP.X_MAX
      1334**DCL      3413<<ASSIGN   3416<<ASSIGN   3416>>ASSIGN   3432>>IF       3484>>IF
GWRSP.Y_MAX
      1335**DCL      3414<<ASSIGN   3417<<ASSIGN   3417>>ASSIGN   3432>>IF       3484>>IF
GWRSP.Z_MAX
      1336**DCL      3415<<ASSIGN   3418<<ASSIGN   3418>>ASSIGN   3432>>IF       3484>>IF
HOST
      3175**DCL      3179--REDEF
HOST.L
      3178**DCL      3534>>ASSIGN   3545<<ASSIGN
HOST.U
      3177**DCL      3533>>ASSIGN   3544<<ASSIGN
HOST18
      3179**DCL      3409>>ASSIGN   3412>>ASSIGN   3427>>ASSIGN   3429>>ASSIGN   3431>>ASSIGN   3532<<ASSIGN
      3543<<ASSIGN
I
      3160**DCL      3294<<DOINDEX  3295>>ASSIGN   3299<<ASSIGN   3300>>CALLBLT  3423<<DOINDEX  3424>>IF
      3427>>ASSIGN   3429>>ASSIGN   3431>>ASSIGN   3436>>IF       3438>>ASSIGN   3440<<ASSIGN   3444>>ASSIGN
      3446>>ASSIGN   3448>>ASSIGN   3449>>ASSIGN   3449>>ASSIGN   3455>>ASSIGN   3458<<ASSIGN   3478<<DOINDEX
      3479>>IF       3481>>ASSIGN   3482>>ASSIGN   3483>>ASSIGN   3488>>IF       3490>>ASSIGN   3492<<ASSIGN
      3496>>ASSIGN   3498>>ASSIGN   3500>>ASSIGN   3501>>ASSIGN   3501>>ASSIGN   3507>>ASSIGN   3510<<ASSIGN
NEW_FRAME_CHAR
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:87   
      3155**DCL      3253>>ASSIGN   3254--ASSIGN
NEW_FRAME_CMD
      3152**DCL      3155--REDEF
RDFLAG
      3162**DCL      3194<<ASSIGN   3343<>CALL     3349<>CALL     3355<>CALL     3361<>CALL     3367<>CALL
      3373<>CALL     3379<>CALL     3385<>CALL     3391<>CALL     3397<>CALL
SET_CHARPRECISION_CHAR
      3150**DCL      3247>>ASSIGN   3248--ASSIGN
SET_CHARPRECISION_CMD
      3145**DCL      3150--REDEF
SITEINFO.MINI_ID#
      2790**DCL      3340--ASSIGN   3341--CALLBLT  3341>>CALLBLT
SITEINFO.SALUTATION#.C
      2792**DCL      3332>>CALLBLT
SITEINFO.SALUTATION#.L
      2792**DCL      3330>>ASSIGN
SITEINFO.SITE_NAME#.C
      2791**DCL      3328>>CALLBLT
SITEINFO.SITE_NAME#.L
      2791**DCL      3326>>ASSIGN
SITEINFO.VERSION#
      2793**DCL      3323--ASSIGN   3324--CALLBLT  3324>>CALLBLT
SPLIT182_9X9
      3528**PROC     3443--CALL     3445--CALL     3447--CALL     3463--CALL     3495--CALL     3497--CALL
      3499--CALL     3515--CALL
SPLIT9X92_18
      3539**PROC     3407--CALL     3410--CALL     3426--CALL     3428--CALL     3430--CALL
START_POS
      3161**DCL      3475<<ASSIGN   3478>>DOINDEX  3481>>ASSIGN   3482>>ASSIGN   3483>>ASSIGN   3501>>ASSIGN
TEXT
      3166**DCL      3290>>ASSIGN
TEXT2
      3167**DCL      3295<<ASSIGN
VALUE IN PROCEDURE SPLIT182_9X9
      3529**DCL      3528--PROC     3532>>ASSIGN
VALUE IN PROCEDURE SPLIT9X92_18
PL6.E3A0      #001=FSK$GBANNER File=FSK$GBANNER.:E05TSI                          TUE 07/29/97 17:33 Page:88   
      3540**DCL      3539--PROC     3542>>ASSIGN
WORKA
      1365**DCL         6--PROC     3208--ASSIGN   3208--ASSIGN
WORKA.TWORK
      1366**DCL      3343<>CALL     3349<>CALL     3355<>CALL     3361<>CALL     3367<>CALL     3373<>CALL
      3379<>CALL     3385<>CALL     3391<>CALL     3397<>CALL
WORKA.TWORK.COUNT
      1367**DCL      3289<<ASSIGN   3290>>ASSIGN   3293<<ASSIGN   3294>>DOINDEX  3298<<ASSIGN   3302<<ASSIGN
      3305<<ASSIGN   3308<<ASSIGN   3311<<ASSIGN   3314<<ASSIGN   3317<<ASSIGN   3320<<ASSIGN   3323<<ASSIGN
      3326<<ASSIGN   3328>>CALLBLT  3330<<ASSIGN   3332>>CALLBLT  3334<<ASSIGN   3337<<ASSIGN   3340<<ASSIGN
      3346<<ASSIGN   3352<<ASSIGN   3358<<ASSIGN   3364<<ASSIGN   3370<<ASSIGN   3376<<ASSIGN   3382<<ASSIGN
      3388<<ASSIGN   3394<<ASSIGN   3400<<ASSIGN   3423>>DOINDEX  3458>>ASSIGN   3478>>DOINDEX  3510>>ASSIGN
WORKA.TWORK.TEXT
      1368**DCL      3290<<ASSIGN   3292--ASSIGN   3293--ASSIGN   3300<<CALLBLT  3303<<CALLBLT  3306<<CALLBLT
      3309<<CALLBLT  3312<<CALLBLT  3315<<CALLBLT  3318<<CALLBLT  3321<<CALLBLT  3324<<CALLBLT  3328<<CALLBLT
      3332<<CALLBLT  3335<<CALLBLT  3338<<CALLBLT  3341<<CALLBLT  3345<<ASSIGN   3351<<ASSIGN   3357<<ASSIGN
      3363<<ASSIGN   3369<<ASSIGN   3375<<ASSIGN   3381<<ASSIGN   3387<<ASSIGN   3393<<ASSIGN   3399<<ASSIGN
      3449>>ASSIGN   3501>>ASSIGN
XCOORD
      3163**DCL      3427<<ASSIGN   3432>>IF       3443<>CALL     3481<<ASSIGN   3484>>IF       3495<>CALL
YCOORD
      3164**DCL      3429<<ASSIGN   3432>>IF       3445<>CALL     3482<<ASSIGN   3484>>IF       3497<>CALL
ZCOORD
      3165**DCL      3431<<ASSIGN   3432>>IF       3447<>CALL     3483<<ASSIGN   3484>>IF       3499<>CALL
