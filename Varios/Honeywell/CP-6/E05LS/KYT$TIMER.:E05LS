VERSION E05

PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:1    
        1        1        /*M* KYT$TIMETICK           ROUTINE CALLED WHEN TIMER EXPIRES. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
        8        8               ECI=0,DIN=7,CSU=3,AND      */
        9        9        /*
       10       10
       11       11          E X T E R N A L    I N T E R F A C E    D E S C R I P T I O N
       12       12
       13       13        This routine is invoked by the clock approximately once every
       14       14        5 CPU seconds.  It has the responsibility of checking whether
       15       15        or not to inform a device controller that a timeout has been
       16       16        detected for a particular device.
       17       17        Each context block on the URP context block chain is checked for
       18       18        timeout if TIMEOUT in the context block is non-zero.  TIMEOUT is
       19       19        decremented by one and if the new value is zero then the
       20       20        appropriate device controller is called with a timeout event.
       21       21
       22       22        */
       23       23        %EJECT;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:2    
       24       24        /*P* NAME: KYT$TIMETICK      Invoke the correct device controller */
       25       25        /**/
       26       26        KYT$TIMETICK: PROC (KH$EXP);
       27       27        /**/
       28       28        %INCLUDE GH_HARDWARE_M;
       29      126        %INCLUDE KV_GLBCNS_E;
       30      467        %INCLUDE KV_PRMID_E;
       31      641        %INCLUDE KV$GLB;
       32     1060        %INCLUDE KV_GLB_M;
       33     1182        %INCLUDE KV$GLBCTX;
       34     1627        %INCLUDE KV$PRM;
       35     1840        %INCLUDE KY_URP_M;
       36     2135        %INCLUDE KY_SUBS_C;
       37     2224        %INCLUDE KH$STT;
       38     2254        %INCLUDE LCP_6;
       39     6533        %INCLUDE KL_MACRO_C;
       40     9885        %INCLUDE KL_AFCN_C;
       41     9986        %INCLUDE K_ID_E;
       42    10036        %K#ENTID_E;
       43    10055        %K#LYRID_E;
       44    10062        %INCLUDE KY_DATA_R;
       45    10857        %INCLUDE KH$CLK;
       46    11227        %INCLUDE KH_CLKFNC_E;
       47    11272        /**/
       48    11273    1          DCL KYT$TIMEOUT ENTRY(1);
       49    11274    1          DCL KYN$ENABLE ENTRY;
       50    11275    1          DCL KYN$DISABLE ENTRY;
       51    11276        /**/
       52    11277        %KV$VDI;
       53    11348        %KH$EXP(STCLASS=PARAM);
       54    11411        %KV$SSN;
       55    11490        %KV$STT;
       56    11884        %KV$PTR;
       57    11927        %KV$USRPRM;
       58    11978        %KV@USRENT;
       59    11998        %KY$CTX( STCLASS="BASED(CTX$)" );
       60    12175    1          DCL CTX$ PTR;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:3    
       61    12176    1          DCL OLDPTR$ PTR;
       62    12177        /**/
       63    12178        %KV_PRMID_E;
       64    12334        /**/
       65    12335        %EJECT;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:4    
       66    12336    1          CALL KYN$DISABLE;
       67    12337    1          CTX$ = KY_FIRSTCTX$;
       68    12338    2          DO WHILE(CTX$ ~= ADDR(NIL));
       69    12339    2             IF KY$CTX.DVC_STATE = %KY#ST_BUSY THEN
       70    12340    3                DO;
       71    12341    3                   IF KY$CTX.TIMEOUT > 0 THEN
       72    12342    4                      DO;
       73    12343    4                         KY$CTX.TIMEOUT = KY$CTX.TIMEOUT - 1;
       74    12344    4                      END;                 /* IF TIMEOUT > 0 */
       75    12345    3                   ELSE
       76    12346    3                      IF NOT(KY$CTX.RESCHEDULE.INTERRUPT) AND
       77    12347    3                         NOT(KY$CTX.RESCHEDULE.TIMER) THEN
       78    12348    4                         DO;
       79    12349                                 %KV$USRENT (VDI$="KY$CTX.VDI$",DFR$=DFR,SCHRSN=1);
             12362    4           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT =
             12362                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT + 1;
             12363    5           IF NOT KY$CTX.VDI$->KV$VDI.BSY THEN DO;
             12364    5              KY$CTX.VDI$->KV$VDI.BSY = '1'B;
             12365    5              KV@USRENT.SVDPTR$ = KV$PTR$;
             12366    5              KV$PTR$ = KY$CTX.VDI$->KV$VDI.ASNINPPTR$;
             12367    5              END;                         /* ELSE IF ~BSY                       */
             12368    5           ELSE DO;
             12369    5              KY$CTX.VDI$->KV$VDI.DFR.USR(1) = '1'B;
             12370    5           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT =
             12370                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT + 1;
             12371    5              GOTO DFR;
             12372    5              END;                         /* END IF                             */
       80    12375    4                            CALL KYT$TIMEOUT(KY$CTX);
       81    12376                                 %KV$USREXT;
             12382    4           KV$PTR.VDI$->KV$VDI.BSY = '0'B;
             12384    4           KV$PTR$ = KV@USRENT.SVDPTR$;
       82    12386    4                            GOTO NEXT;
       83    12387    4   DFR:                     ;
       84    12388    4                            KY$CTX.RESCHEDULE.TIMER = '1'B;
       85    12389    4                         END;              /* IF NOT INTERRUPT AND NOT TIMER */
       86    12390    3                END;                       /* IF DVC_STATE = BUSY */
       87    12391    2   NEXT:     CTX$ = KY$CTX.NEXT$;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:5    
       88    12392    2          END;                             /* DO WHILE */
       89    12393    1          CALL KYN$ENABLE;
       90    12394    1          RETURN;
       91    12395    1   END KYT$TIMETICK;
       92    12396        %EOD;

PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:6    
--  Include file information  --

   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KH$STT.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
      No diagnostics issued in procedure KYT$TIMETICK.

   Procedure KYT$TIMETICK requires 140 words for executable code.
   Procedure KYT$TIMETICK requires 12 words of local(AUTO) storage.

PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:7    

 Object Unit name= KYT$TIMETICK                               File name= KYT$TIMER.:E05TOU
 UTS= JUL 30 '97 02:45:47.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Proc  even  none   140     8C  KYT$TIMETICK

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     0      0   yes            yes      Std        1  KYT$TIMETICK

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 KYN$DISABLE
         yes           Std       1 KYT$TIMEOUT
         yes           Std       0 KYN$ENABLE
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     KY_FIRSTCTX$                          KV$PTR$                          r    G$ROS$
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:8    


        1        1        /*M* KYT$TIMETICK           ROUTINE CALLED WHEN TIMER EXPIRES. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
        8        8               ECI=0,DIN=7,CSU=3,AND      */
        9        9        /*
       10       10
       11       11          E X T E R N A L    I N T E R F A C E    D E S C R I P T I O N
       12       12
       13       13        This routine is invoked by the clock approximately once every
       14       14        5 CPU seconds.  It has the responsibility of checking whether
       15       15        or not to inform a device controller that a timeout has been
       16       16        detected for a particular device.
       17       17        Each context block on the URP context block chain is checked for
       18       18        timeout if TIMEOUT in the context block is non-zero.  TIMEOUT is
       19       19        decremented by one and if the new value is zero then the
       20       20        appropriate device controller is called with a timeout event.
       21       21
       22       22        */
       23       23        %EJECT;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:9    
       24       24        /*P* NAME: KYT$TIMETICK      Invoke the correct device controller */
       25       25        /**/
       26       26        KYT$TIMETICK: PROC (KH$EXP);

     26   0 000000  D380 0000 0000  xent KYT$TIMETICK    LNJ,B5   X6A_AUTO_1
          0 000003       000C 0001                       DC       12,1

       27       27        /**/
       28       28        %INCLUDE GH_HARDWARE_M;
       29      126        %INCLUDE KV_GLBCNS_E;
       30      467        %INCLUDE KV_PRMID_E;
       31      641        %INCLUDE KV$GLB;
       32     1060        %INCLUDE KV_GLB_M;
       33     1182        %INCLUDE KV$GLBCTX;
       34     1627        %INCLUDE KV$PRM;
       35     1840        %INCLUDE KY_URP_M;
       36     2135        %INCLUDE KY_SUBS_C;
       37     2224        %INCLUDE KH$STT;
       38     2254        %INCLUDE LCP_6;
       39     6533        %INCLUDE KL_MACRO_C;
       40     9885        %INCLUDE KL_AFCN_C;
       41     9986        %INCLUDE K_ID_E;
       42    10036        %K#ENTID_E;
       43    10055        %K#LYRID_E;
       44    10062        %INCLUDE KY_DATA_R;
       45    10857        %INCLUDE KH$CLK;
       46    11227        %INCLUDE KH_CLKFNC_E;
       47    11272        /**/
       48    11273    1          DCL KYT$TIMEOUT ENTRY(1);
       49    11274    1          DCL KYN$ENABLE ENTRY;
       50    11275    1          DCL KYN$DISABLE ENTRY;
       51    11276        /**/
       52    11277        %KV$VDI;
       53    11348        %KH$EXP(STCLASS=PARAM);
       54    11411        %KV$SSN;
       55    11490        %KV$STT;
       56    11884        %KV$PTR;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:10   
       57    11927        %KV$USRPRM;
       58    11978        %KV@USRENT;
       59    11998        %KY$CTX( STCLASS="BASED(CTX$)" );
       60    12175    1          DCL CTX$ PTR;
       61    12176    1          DCL OLDPTR$ PTR;
       62    12177        /**/
       63    12178        %KV_PRMID_E;
       64    12334        /**/
       65    12335        %EJECT;
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:11   
       66    12336    1          CALL KYN$DISABLE;

  12336   0 000005  CBF0 0000                            LAB,B4   0,IMO
          0 000007  E380 0000 0000  xent                 LNJ,B6   KYN$DISABLE
          0 00000A       0001                            DC       s:12337,PREL

       67    12337    1          CTX$ = KY_FIRSTCTX$;

  12337   0 00000B  EC80 0000 0000  xsym                 LDB,B6   KY_FIRSTCTX$
          0 00000E  EFC7 0008                            STB,B6   CTX$,AUTO

       68    12338    2          DO WHILE(CTX$ ~= ADDR(NIL));

  12338   0 000010  0F81 006E                            B        s:12392,PREL

       69    12339    2             IF KY$CTX.DVC_STATE = %KY#ST_BUSY THEN

  12339   0 000012  ECC7 0008                            LDB,B6   CTX$,AUTO
          0 000014  E2C6 0004                            LLH,R6   4,B6
          0 000016  6D04                                 CMV,R6   4
          0 000017  0981 0062                            BNE      s:12390,PREL

       70    12340    3                DO;

       71    12341    3                   IF KY$CTX.TIMEOUT > 0 THEN

  12341   0 000019  82C6 000B                            LB,'00FF'X        11,B6
  12341   0 00001B       00FF
          0 00001C  0581 000A                            BBF      s:12346,PREL

       72    12342    4                      DO;

       73    12343    4                         KY$CTX.TIMEOUT = KY$CTX.TIMEOUT - 1;

  12343   0 00001E  D846 000B                            LDR,R5   11,B6
          0 000020  DA70 00FF                            ADD,R5   255,IMO
          0 000022  DAC6 000B                            SRM,R5,'00FF'X    11,B6
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:12   
          0 000024       00FF

       74    12344    4                      END;                 /* IF TIMEOUT > 0 */

  12344   0 000025  0F81 0054                            B        s:12390,PREL

       75    12345    3                   ELSE
       76    12346    3                      IF NOT(KY$CTX.RESCHEDULE.INTERRUPT) AND

  12346   0 000027  82C6 0021                            LB,'4000'X        33,B6
  12346   0 000029       4000
          0 00002A  0501 004F                            BBT      s:12390,PREL
          0 00002C  89C6 0021                            CMZ      33,B6
          0 00002E  0801 004B                            BAL      s:12390,PREL

       77    12347    3                         NOT(KY$CTX.RESCHEDULE.TIMER) THEN
       78    12348    4                         DO;

       79    12349                                 %KV$USRENT (VDI$="KY$CTX.VDI$",DFR$=DFR,SCHRSN=1);
             12362    4           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT =
             12362                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTCNT + 1;

  12362   0 000030  DCC6 0008                            LDB,B5   8,B6
          0 000032  CCC5 0008                            LDB,B4   8,B5
          0 000034  BCC4 0033                            LDB,B3   51,B4
          0 000036  8AC3 0039                            INC      57,B3
          0 000038  8EC3 0038                            CAD      56,B3

             12363    5           IF NOT KY$CTX.VDI$->KV$VDI.BSY THEN DO;

  12363   0 00003A  DCC6 0008                            LDB,B5   8,B6
          0 00003C  82C5 0019                            LB,'0080'X        25,B5
          0 00003E       0080
          0 00003F  0501 0012                            BBT      s:12369,PREL

             12364    5              KY$CTX.VDI$->KV$VDI.BSY = '1'B;

PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:13   
  12364   0 000041  8945 0019                            LBT,'0080'X       25,B5
  12364   0 000043       0080

             12365    5              KV@USRENT.SVDPTR$ = KV$PTR$;

  12365   0 000044  DC80 0000 0000  xsym                 LDB,B5   KV$PTR$
          0 000047  DFC7 0006                            STB,B5   KV@USRENT,AUTO

             12366    5              KV$PTR$ = KY$CTX.VDI$->KV$VDI.ASNINPPTR$;

  12366   0 000049  CCC6 0008                            LDB,B4   8,B6
          0 00004B  BCC4 0006                            LDB,B3   6,B4
          0 00004D  BF80 0000 0000  xsym                 STB,B3   KV$PTR$

             12367    5              END;                         /* ELSE IF ~BSY                       */

  12367   0 000050  0F81 0010                            B        s:12375,PREL

             12368    5           ELSE DO;

             12369    5              KY$CTX.VDI$->KV$VDI.DFR.USR(1) = '1'B;

  12369   0 000052  8945 0018                            LBT,'4000'X       24,B5
  12369   0 000054       4000

             12370    5           KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT =
             12370                    KY$CTX.VDI$->KV$VDI.USRPRM$->KV$USRPRM.STT$->KV$STT.USRENTDFRCNT + 1;

  12370   0 000055  DCC6 0008                            LDB,B5   8,B6
          0 000057  CCC5 0008                            LDB,B4   8,B5
          0 000059  BCC4 0033                            LDB,B3   51,B4
          0 00005B  8AC3 003B                            INC      59,B3
          0 00005D  8EC3 003A                            CAD      58,B3

             12371    5              GOTO DFR;

  12371   0 00005F  0F81 0017                            B        s:12384,PREL
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:14   

             12372    5              END;                         /* END IF                             */
       80    12375    4                            CALL KYT$TIMEOUT(KY$CTX);

  12375   0 000061  BBC7 0008                            LAB,B3   CTX$,AUTO
          0 000063  CBF0 0100                            LAB,B4   256,IMO
          0 000065  E380 0000 0000  xent                 LNJ,B6   KYT$TIMEOUT
          0 000068       0001                            DC       s:12382,PREL

       81    12376                                 %KV$USREXT;
             12382    4           KV$PTR.VDI$->KV$VDI.BSY = '0'B;

  12382   0 000069  EC80 0000 0000  xsym                 LDB,B6   KV$PTR$
          0 00006C  DC86                                 LDB,B5   ,B6
          0 00006D  8845 0019                            LBF,'0080'X       25,B5
          0 00006F       0080

             12384    4           KV$PTR$ = KV@USRENT.SVDPTR$;

  12384   0 000070  DCC7 0006                            LDB,B5   KV@USRENT,AUTO
          0 000072  DF80 0000 0000  xsym                 STB,B5   KV$PTR$

       82    12386    4                            GOTO NEXT;

  12386   0 000075  0F81 0004                            B        s:12390,PREL

  12384   0                              DFR             null
       83    12387    4   DFR:                     ;
       84    12388    4                            KY$CTX.RESCHEDULE.TIMER = '1'B;

  12388   0 000077  8946 0021            DFR             LBT,'8000'X       33,B6
  12388   0 000079       8000

       85    12389    4                         END;              /* IF NOT INTERRUPT AND NOT TIMER */

       86    12390    3                END;                       /* IF DVC_STATE = BUSY */

PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:15   
       87    12391    2   NEXT:     CTX$ = KY$CTX.NEXT$;

  12391   0 00007A  ECC7 0008            NEXT            LDB,B6   CTX$,AUTO
          0 00007C  DC86                                 LDB,B5   ,B6
          0 00007D  DFC7 0008                            STB,B5   CTX$,AUTO

       88    12392    2          END;                             /* DO WHILE */

  12392   0 00007F  8DC7 0008                            CMN      CTX$,AUTO
          0 000081  0981 FF90                            BNE      s:12339,PREL

       89    12393    1          CALL KYN$ENABLE;

  12393   0 000083  CBF0 0000                            LAB,B4   0,IMO
          0 000085  E380 0000 0000  xent                 LNJ,B6   KYN$ENABLE
          0 000088       0001                            DC       s:12394,PREL

       90    12394    1          RETURN;

  12394   0 000089  C380 0000 0000  xent                 LNJ,B4   X6A_ARET
       91    12395    1   END KYT$TIMETICK;
       92    12396        %EOD;

PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:16   
--  Include file information  --

   KH_CLKFNC_E.:E05TOU  is referenced.
   KH$CLK.:E05TOU  is referenced.
   KY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   K_ID_E.:E05TOU  is referenced.
   KL_AFCN_C.:E05TOU  is referenced.
   KL_MACRO_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
   KH$STT.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KV$PRM.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_PRMID_E.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   GH_HARDWARE_M.:E05TOU  is referenced.
      No diagnostics issued in procedure KYT$TIMETICK.
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:17   

 **** Variables and constants ****

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KH$EXP                    8-0-0/w PTR         r     1 CTX$
    *0-0-0/w STRC(96)    r     1 KH$EXP                     6-0-0/w STRC(32)    r     1 KV@USRENT

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 KV$PTR$                    0-0-0/w PTR         r     1 KY_FIRSTCTX$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(480)   r     1 KV$PTR                     0-0-0/w STRC(8960)  r     1 KV$STT
     0-0-0/w STRC(912)   r     1 KV$USRPRM                  0-0-0/w STRC(512)   r     1 KV$VDI
     0-0-0/w STRC(608)   r     1 KY$CTX


   Procedure KYT$TIMETICK requires 140 words for executable code.
   Procedure KYT$TIMETICK requires 12 words of local(AUTO) storage.
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:18   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:19   
          MINI XREF LISTING

CTX$
     12175**DCL     12009--IMP-PTR 12337<<ASSIGN  12338>>DOWHILE 12339>>IF      12341>>IF      12343>>ASSIGN
     12343>>ASSIGN  12346>>IF      12346>>IF      12362>>ASSIGN  12362>>ASSIGN  12363>>IF      12364>>ASSIGN
     12366>>ASSIGN  12369>>ASSIGN  12370>>ASSIGN  12370>>ASSIGN  12375>>CALL    12388>>ASSIGN  12391<<ASSIGN
     12391>>ASSIGN
DFR
     12384**LABEL   12371--GOTO
KH$EXP
     11362**DCL        26--PROC
KH$EXP.UID
     11368**DCL     11369--REDEF
KV$PTR.INPCNDPND
     11911**DCL     11920--REDEF   11924--REDEF
KV$PTR.LINLST$
     11907**DCL     11908--REDEF
KV$PTR.VDI$
     11905**DCL     12382>>ASSIGN
KV$PTR$
     11899**DCL     11905--IMP-PTR 12365>>ASSIGN  12366<<ASSIGN  12382>>ASSIGN  12384<<ASSIGN
KV$SSN.REDRSPCNT
     11440**DCL     11441--REDEF
KV$STT.REQSTATS.DSPMSK
     11763**DCL     11769--REDEF
KV$STT.REQSTATS.SLCMSK
     11804**DCL     11811--REDEF
KV$STT.USRENTCNT
     11873**DCL     12362<<ASSIGN  12362>>ASSIGN
KV$STT.USRENTDFRCNT
     11874**DCL     12370<<ASSIGN  12370>>ASSIGN
KV$USRPRM.STT$
     11975**DCL     12362>>ASSIGN  12362>>ASSIGN  12370>>ASSIGN  12370>>ASSIGN
KV$VDI.ASNINPPTR$
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:20   
     11299**DCL     12366>>ASSIGN
KV$VDI.BSY
     11333**DCL     12363>>IF      12364<<ASSIGN  12382<<ASSIGN
KV$VDI.DFR.USR
     11330**DCL     12369<<ASSIGN
KV$VDI.USRPRM$
     11299**DCL     12362>>ASSIGN  12362>>ASSIGN  12370>>ASSIGN  12370>>ASSIGN
KV@USRENT.SVDPTR$
     11996**DCL     12365<<ASSIGN  12384>>ASSIGN
KV_STT.REQSTATS.DSPMSK
     10733**DCL     10739--REDEF
KV_STT.REQSTATS.SLCMSK
     10774**DCL     10781--REDEF
KY$CTX
     12009**DCL     12375<>CALL
KY$CTX.DEFRD.STATUSW
     12151**DCL     12153--REDEF
KY$CTX.DVC_STATE
     12012**DCL     12339>>IF
KY$CTX.MODE
     12100**DCL     12108--REDEF
KY$CTX.NEXT$
     12010**DCL     12391>>ASSIGN
KY$CTX.RESCHEDULE.INTERRUPT
     12160**DCL     12346>>IF
KY$CTX.RESCHEDULE.TIMER
     12159**DCL     12346>>IF      12388<<ASSIGN
KY$CTX.STATUSW
     12027**DCL     12029--REDEF   12037--REDEF   12051--REDEF   12065--REDEF   12079--REDEF
KY$CTX.TIMEOUT
     12098**DCL     12341>>IF      12343<<ASSIGN  12343>>ASSIGN
KY$CTX.VDI$
     12094**DCL     12362>>ASSIGN  12362>>ASSIGN  12363>>IF      12364>>ASSIGN  12366>>ASSIGN  12369>>ASSIGN
     12370>>ASSIGN  12370>>ASSIGN
KY$CTX.VDIENB
     12165**DCL     12171--REDEF
PL6.E3A0      #001=KYT$TIMETICK File=KYT$TIMER.:E05TSI                           WED 07/30/97 02:45 Page:21   
KYN$DISABLE
     11275**DCL-ENT 12336--CALL
KYN$ENABLE
     11274**DCL-ENT 12393--CALL
KYT$TIMEOUT
     11273**DCL-ENT 12375--CALL
KY_FIRSTCTX$
     10121**DCL     12337>>ASSIGN
KY_STT_URP.REQSTATS.DSPMSK
     10382**DCL     10388--REDEF
KY_STT_URP.REQSTATS.SLCMSK
     10423**DCL     10430--REDEF
NEXT
     12391**LABEL   12386--GOTO

PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:22   
       93        1        /*M* KYT$TIMEOUT   ROUTINE CALLED WHEN DEVICE TIMES OUT. */
       94        2        /*T***********************************************************/
       95        3        /*T*                                                         */
       96        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       97        5        /*T*                                                         */
       98        6        /*T***********************************************************/
       99        7        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
      100        8               ECI=0,DIN=7,CSU=3,AND      */
      101        9        /*
      102       10
      103       11          E X T E R N A L    I N T E R F A C E    D E S C R I P T I O N
      104       12
      105       13        This routine is called only when it has been decided that a device
      106       14        is really ready to time-out.  It is called either when VDH issues
      107       15        the deffered event 'Timeout,' or when the timeout has occured and
      108       16        is not delayed.
      109       17
      110       18        It has the job of determining if the device really has gone out to
      111       19        lunch, or if it looks as if we have just lost an interrupt.  And
      112       20        based on the result of that checking, it will either complain to
      113       21        the operator, or it will simply pretend that the interrupt happened
      114       22        and call the appropriate device controller.
      115       23
      116       24        */
      117       25        %EJECT;
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:23   
      118       26        /*
      119       27                  I N T E R N A L   O V E R V I E W
      120       28
      121       29        There is only one minor complication involved in correct handling of
      122       30        a timeout event.  That being that we beleive that it is possilbe for
      123       31        the device to physically loose an interrupt.  So rather than having
      124       32        that rare event totally halt the world, do a little bit of special
      125       33        checking in order to determine what is really happening.
      126       34
      127       35           Do a Get Status Word.
      128       36            ACK:
      129       37              O.K.  What must have happened is that an interrupt was lost
      130       38               so errlog that that is what we think.  And proceed as if an
      131       39               interrupt caused the handler to be invoked.
      132       40              I.E. Call the approprite device handler.
      133       41
      134       42            NACK:
      135       43              O.K.  This should mean that the device really is screwed up.
      136       44               The only way to get into this state is to have had one I/O
      137       45               request last longer than the timeout interval, without an
      138       46               interrupt and with the device still busy.
      139       47              DVC_STATE  <=  OPWAIT_ON
      140       48
      141       49        */
      142       50        %EJECT;
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:24   
      143       51        /*P* NAME: KYT$TIMEOUT        Physical Device timeout manager. */
      144       52
      145       53        KYT$TIMEOUT: PROC ( KY$CTX );
      146       54        %INCLUDE LCP_6;
      147     4333        %INCLUDE KY_PERR_C;
      148     4355        %INCLUDE KY_URP_M;
      149     4650        %INCLUDE KY_SUBS_C;
      150     4739        %INCLUDE KV_GLBCNS_E;                   /* VDI equates */
      151     5080        %INCLUDE OC_SUBS_C;
      152     5811        %INCLUDE KV$GLBCTX;
      153     6256        %INCLUDE KV_GLB_M;
      154     6378        %INCLUDE KV$GLB;
      155     6797        %INCLUDE KH$CHN;
      156     6919        %KH$CHN;
      157     7043        %KV$VDI;
      158     7114        %KY$CTX;
      159     7291
      160     7292    1          DCL KYI$IO ENTRY(2) ALTRET;
      161     7293    1          DCL KYN$OUR_HNDLR ENTRY(1);
      162     7294    1          DCL KYN$IUR_HNDLR ENTRY(1);
      163     7295    1          DCL KYK$OPCON ENTRY(2);
      164     7296    1          DCL KHA$ERRLOG ENTRY(2) ALTRET;
      165     7297        /*  */
      166     7298               %FPT_WRSYSLOG(FCG='KY',MID='R',STCLASS=STATIC);
      167     7393        /**/
      168     7394    1          DCL TEMP_STATUSW UBIN WORD;
      169     7395        %EJECT;
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:25   
      170     7396    1          KY$CTX.RESCHEDULE.TIMER = '0'B;
      171     7397    1          TEMP_STATUSW = KY$CTX.STATUSW;
      172     7398    1          FPT_WRSYSLOG.V.TERMID = KY$CTX.VDI$->KV$VDI.CHN$->KH$CHN.TERMID;
      173     7399    1          CALL KYI$IO(KY$CTX,%KY#GET_STAT) ALTRET(NAKED);
      174     7400    1          KY$CTX.DEFRD.STATUSW = KY$CTX.STATUSW;
      175     7401    1          KY$CTX.TIMEOUT = %KY#DEV_TIMEOUT_CNT;
      176     7402    1          FPT_WRSYSLOG.V.ERRCODE.ERR#=%GG#EC_KYR_LOST_INTRUPT;
      177     7403    1          CALL KHA$ERRLOG(FPT_WRSYSLOG);
      178     7404        /*E* ERROR:   KYR-GG#EC_KYR_LOST_INTRUPT
      179     7405             MESSAGE: Interrupt lost on i/o termination
      180     7406             DESCRIPTION:        THE INTERRUPT THAT MUST HAVE OCCURRED WHEN
      181     7407                                THE LAST I/O COMPLETED WAS NOT SENT TO US.
      182     7408        */
      183     7409    2          DO CASE(KY$CTX.DVCTYP);
      184     7410    2             CASE(%KY#TYP_LP,%KY#TYP_CP);
      185     7411    2                CALL KYN$OUR_HNDLR(KY$CTX);
      186     7412    2             CASE(%KY#TYP_CR);
      187     7413    2                CALL KYN$IUR_HNDLR(KY$CTX);
      188     7414    2          END;                             /* DO CASE */
      189     7415    1          RETURN;
      190     7416    1   NAKED: ;
      191     7417    1          KY$CTX.STATUSW = TEMP_STATUSW;
      192     7418    1          CALL KYI$IO(KY$CTX,%KY#STOP) ALTRET(ALT);
      193     7419    1          FPT_WRSYSLOG.V.ERRCODE.ERR#=%GG#EC_KYR_DVC_TIMEOUT;
      194     7420    1          CALL KHA$ERRLOG(FPT_WRSYSLOG);
      195     7421        /*E* ERROR:   KYR-GG#EC_KYR_DVC_TIMEOUT
      196     7422             MESSAGE: I/O execution exceeded timeout interval
      197     7423             DESCRIPTION:        THE INTERRUPT THAT SAYS I/O COMPLETE NEVER
      198     7424                                HAPPENED.  AND THE DEVICE IS STILL BUSY.
      199     7425        */
      200     7426    1          KY$CTX.DVC_STATE = %KY#ST_OPWAIT_ON;
      201     7427    1          KY$CTX.DVC_STATUS = %KY#DVC_TIMEOUT;
      202     7428    1          CALL KYK$OPCON(KY$CTX,OC_WRTM);
      203     7429    1   ALT:   RETURN;
      204     7430    1   END KYT$TIMEOUT;

PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:26   
--  Include file information  --

   KH$CHN.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KY_PERR_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYT$TIMEOUT.

   Procedure KYT$TIMEOUT requires 163 words for executable code.
   Procedure KYT$TIMEOUT requires 12 words of local(AUTO) storage.

    No errors detected in file KYT$TIMER.:E05TSI    .

PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:27   

 Object Unit name= KYT$TIMEOUT                                File name= KYT$TIMER.:E05TOU
 UTS= JUL 30 '97 02:46:35.88 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_LCP6_SYSTEM                               Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size HexSiz  Section name
    0   Data  even  none    21     15  KYT$TIMEOUT
    1   Proc  even  none   163     A3  KYT$TIMEOUT
    2  RoData even  none     2      2  KYT$TIMEOUT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect HexLoc Primary Altret sequence   type   Parms  Name
     1      0   yes            yes      Std        1  KYT$TIMEOUT

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       2 KYI$IO
 yes     yes           Std       2 KHA$ERRLOG
         yes           Std       1 KYN$IUR_HNDLR
         yes           Std       2 KYK$OPCON
         yes           Std       1 KYN$OUR_HNDLR
                       nStd      0 X6A_AUTO_1
                       nStd      0 X6A_ARET
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:28   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    G$ROS$
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:29   


       93        1        /*M* KYT$TIMEOUT   ROUTINE CALLED WHEN DEVICE TIMES OUT. */
       94        2        /*T***********************************************************/
       95        3        /*T*                                                         */
       96        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
       97        5        /*T*                                                         */
       98        6        /*T***********************************************************/
       99        7        /*X*   DMR,PLM=7,IND=3,CTI=3,SDI=3,MCL=10,CSI=3,DTI=3,DCI=6,
      100        8               ECI=0,DIN=7,CSU=3,AND      */
      101        9        /*
      102       10
      103       11          E X T E R N A L    I N T E R F A C E    D E S C R I P T I O N
      104       12
      105       13        This routine is called only when it has been decided that a device
      106       14        is really ready to time-out.  It is called either when VDH issues
      107       15        the deffered event 'Timeout,' or when the timeout has occured and
      108       16        is not delayed.
      109       17
      110       18        It has the job of determining if the device really has gone out to
      111       19        lunch, or if it looks as if we have just lost an interrupt.  And
      112       20        based on the result of that checking, it will either complain to
      113       21        the operator, or it will simply pretend that the interrupt happened
      114       22        and call the appropriate device controller.
      115       23
      116       24        */
      117       25        %EJECT;
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:30   
      118       26        /*
      119       27                  I N T E R N A L   O V E R V I E W
      120       28
      121       29        There is only one minor complication involved in correct handling of
      122       30        a timeout event.  That being that we beleive that it is possilbe for
      123       31        the device to physically loose an interrupt.  So rather than having
      124       32        that rare event totally halt the world, do a little bit of special
      125       33        checking in order to determine what is really happening.
      126       34
      127       35           Do a Get Status Word.
      128       36            ACK:
      129       37              O.K.  What must have happened is that an interrupt was lost
      130       38               so errlog that that is what we think.  And proceed as if an
      131       39               interrupt caused the handler to be invoked.
      132       40              I.E. Call the approprite device handler.
      133       41
      134       42            NACK:
      135       43              O.K.  This should mean that the device really is screwed up.
      136       44               The only way to get into this state is to have had one I/O
      137       45               request last longer than the timeout interval, without an
      138       46               interrupt and with the device still busy.
      139       47              DVC_STATE  <=  OPWAIT_ON
      140       48
      141       49        */
      142       50        %EJECT;
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:31   
      143       51        /*P* NAME: KYT$TIMEOUT        Physical Device timeout manager. */
      144       52
      145       53        KYT$TIMEOUT: PROC ( KY$CTX );

     53   1 000000  D380 0000 0000  xent KYT$TIMEOUT     LNJ,B5   X6A_AUTO_1
          1 000003       000C 0001                       DC       12,1

      146       54        %INCLUDE LCP_6;
      147     4333        %INCLUDE KY_PERR_C;
      148     4355        %INCLUDE KY_URP_M;
      149     4650        %INCLUDE KY_SUBS_C;
      150     4739        %INCLUDE KV_GLBCNS_E;                   /* VDI equates */
      151     5080        %INCLUDE OC_SUBS_C;
      152     5811        %INCLUDE KV$GLBCTX;
      153     6256        %INCLUDE KV_GLB_M;
      154     6378        %INCLUDE KV$GLB;
      155     6797        %INCLUDE KH$CHN;
      156     6919        %KH$CHN;
      157     7043        %KV$VDI;
      158     7114        %KY$CTX;
      159     7291
      160     7292    1          DCL KYI$IO ENTRY(2) ALTRET;
      161     7293    1          DCL KYN$OUR_HNDLR ENTRY(1);
      162     7294    1          DCL KYN$IUR_HNDLR ENTRY(1);
      163     7295    1          DCL KYK$OPCON ENTRY(2);
      164     7296    1          DCL KHA$ERRLOG ENTRY(2) ALTRET;
      165     7297        /*  */
      166     7298               %FPT_WRSYSLOG(FCG='KY',MID='R',STCLASS=STATIC);
      167     7393        /**/
      168     7394    1          DCL TEMP_STATUSW UBIN WORD;
      169     7395        %EJECT;
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:32   
      170     7396    1          KY$CTX.RESCHEDULE.TIMER = '0'B;

   7396   1 000005  ECC7 0004                            LDB,B6   @KY$CTX,AUTO
          1 000007  8846 0021                            LBF,'8000'X       33,B6
          1 000009       8000

      171     7397    1          TEMP_STATUSW = KY$CTX.STATUSW;

   7397   1 00000A  E846 0006                            LDR,R6   6,B6
          1 00000C  EF47 0006                            STR,R6   TEMP_STATUSW,AUTO

      172     7398    1          FPT_WRSYSLOG.V.TERMID = KY$CTX.VDI$->KV$VDI.CHN$->KH$CHN.TERMID;

   7398   1 00000E  DCC6 0008                            LDB,B5   8,B6
          1 000010  CC85                                 LDB,B4   ,B5
          1 000011  AB84                                 LAB,B2   ,B4
          1 000012  2C24                                 LDV,R2   36
          1 000013  6C10                                 LDV,R6   16
          1 000014  BB80 0000 0000  00                   LAB,B3   FPT_WRSYSLOG
          1 000017  3C10                                 LDV,R3   16
          1 000018  0008                                 MMM

      173     7399    1          CALL KYI$IO(KY$CTX,%KY#GET_STAT) ALTRET(NAKED);

   7399   1 000019  DBF0 0002                            LAB,B5   2,IMO
          1 00001B  DFC7 000A                            STB,B5   TEMP_STATUSW+4,AUTO
          1 00001D  EFC7 0008                            STB,B6   TEMP_STATUSW+2,AUTO
          1 00001F  BBC7 0008                            LAB,B3   TEMP_STATUSW+2,AUTO
          1 000021  CBF0 0200                            LAB,B4   512,IMO
          1 000023  E380 0000 0000  xent                 LNJ,B6   KYI$IO
          1 000026       0040                            DC       s:7409,PREL

      174     7400    1          KY$CTX.DEFRD.STATUSW = KY$CTX.STATUSW;

   7400   1 000027  ECC7 0004                            LDB,B6   @KY$CTX,AUTO
          1 000029  E846 0006                            LDR,R6   6,B6
          1 00002B  EF46 0020                            STR,R6   32,B6
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:33   

      175     7401    1          KY$CTX.TIMEOUT = %KY#DEV_TIMEOUT_CNT;

   7401   1 00002D  5C12                                 LDV,R5   18
          1 00002E  DAC6 000B                            SRM,R5,'00FF'X    11,B6
          1 000030       00FF

      176     7402    1          FPT_WRSYSLOG.V.ERRCODE.ERR#=%GG#EC_KYR_LOST_INTRUPT;

   7402   1 000031  C870 0648                            LDR,R4   1608,IMO
          1 000033  CA80 0000 0007  00                   SRM,R4,'FFF8'X    FPT_WRSYSLOG+7
          1 000036       FFF8

      177     7403    1          CALL KHA$ERRLOG(FPT_WRSYSLOG);

   7403   1 000037  BB80 0000 0000  02                   LAB,B3   0
          1 00003A  CBF0 0100                            LAB,B4   256,IMO
          1 00003C  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          1 00003F       0001                            DC       s:7409,PREL

      178     7404        /*E* ERROR:   KYR-GG#EC_KYR_LOST_INTRUPT
      179     7405             MESSAGE: Interrupt lost on i/o termination
      180     7406             DESCRIPTION:        THE INTERRUPT THAT MUST HAVE OCCURRED WHEN
      181     7407                                THE LAST I/O COMPLETED WAS NOT SENT TO US.
      182     7408        */
      183     7409    2          DO CASE(KY$CTX.DVCTYP);

   7409   1 000040  ECC7 0004                            LDB,B6   @KY$CTX,AUTO
          1 000042  B2C6 000B                            LLH,R3   11,B6
          1 000044  3D04                                 CMV,R3   4
          1 000045  0281 001D                            BGE      s:7415,PREL
          1 000047  A830 0000 004D  01                   LDR,R2   s:7409+13,R3
          1 00004A  83A0 0000 0051  01                   JMP      s:7411,R2
          1 00004D       0012                            DC       s:7415,PREL
          1 00004E       0000                            DC       s:7411,PREL
          1 00004F       0000                            DC       s:7411,PREL
          1 000050       000A                            DC       s:7413,PREL
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:34   

      184     7410    2             CASE(%KY#TYP_LP,%KY#TYP_CP);

      185     7411    2                CALL KYN$OUR_HNDLR(KY$CTX);

   7411   1 000051  BBC7 0004                            LAB,B3   @KY$CTX,AUTO
          1 000053  CBF0 0100                            LAB,B4   256,IMO
          1 000055  E380 0000 0000  xent                 LNJ,B6   KYN$OUR_HNDLR
          1 000058       0001                            DC       s:7411+8,PREL
          1 000059  0F81 0009                            B        s:7415,PREL

      186     7412    2             CASE(%KY#TYP_CR);

      187     7413    2                CALL KYN$IUR_HNDLR(KY$CTX);

   7413   1 00005B  BBC7 0004                            LAB,B3   @KY$CTX,AUTO
          1 00005D  CBF0 0100                            LAB,B4   256,IMO
          1 00005F  E380 0000 0000  xent                 LNJ,B6   KYN$IUR_HNDLR
          1 000062       0001                            DC       s:7415,PREL

      188     7414    2          END;                             /* DO CASE */

      189     7415    1          RETURN;

   7415   1 000063  C380 0000 0000  xent                 LNJ,B4   X6A_ARET

   7409   1                              NAKED           null
      190     7416    1   NAKED: ;
      191     7417    1          KY$CTX.STATUSW = TEMP_STATUSW;

   7417   1 000066  ECC7 0004            NAKED           LDB,B6   @KY$CTX,AUTO
          1 000068  E847 0006                            LDR,R6   TEMP_STATUSW,AUTO
          1 00006A  EF46 0006                            STR,R6   6,B6

      192     7418    1          CALL KYI$IO(KY$CTX,%KY#STOP) ALTRET(ALT);

   7418   1 00006C  DBF0 0001                            LAB,B5   1,IMO
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:35   
          1 00006E  DFC7 000A                            STB,B5   TEMP_STATUSW+4,AUTO
          1 000070  EFC7 0008                            STB,B6   TEMP_STATUSW+2,AUTO
          1 000072  BBC7 0008                            LAB,B3   TEMP_STATUSW+2,AUTO
          1 000074  CBF0 0200                            LAB,B4   512,IMO
          1 000076  E380 0000 0000  xent                 LNJ,B6   KYI$IO
          1 000079       0027                            DC       s:7429,PREL

      193     7419    1          FPT_WRSYSLOG.V.ERRCODE.ERR#=%GG#EC_KYR_DVC_TIMEOUT;

   7419   1 00007A  E870 0650                            LDR,R6   1616,IMO
          1 00007C  EA80 0000 0007  00                   SRM,R6,'FFF8'X    FPT_WRSYSLOG+7
          1 00007F       FFF8

      194     7420    1          CALL KHA$ERRLOG(FPT_WRSYSLOG);

   7420   1 000080  BB80 0000 0000  02                   LAB,B3   0
          1 000083  CBF0 0100                            LAB,B4   256,IMO
          1 000085  E380 0000 0000  xent                 LNJ,B6   KHA$ERRLOG
          1 000088       0001                            DC       s:7426,PREL

      195     7421        /*E* ERROR:   KYR-GG#EC_KYR_DVC_TIMEOUT
      196     7422             MESSAGE: I/O execution exceeded timeout interval
      197     7423             DESCRIPTION:        THE INTERRUPT THAT SAYS I/O COMPLETE NEVER
      198     7424                                HAPPENED.  AND THE DEVICE IS STILL BUSY.
      199     7425        */
      200     7426    1          KY$CTX.DVC_STATE = %KY#ST_OPWAIT_ON;

   7426   1 000089  6C05                                 LDV,R6   5
          1 00008A  ECC7 0004                            LDB,B6   @KY$CTX,AUTO
          1 00008C  E7C6 0004                            STH,R6   4,B6

      201     7427    1          KY$CTX.DVC_STATUS = %KY#DVC_TIMEOUT;

   7427   1 00008E  5C06                                 LDV,R5   6
          1 00008F  DAC6 0004                            SRM,R5,'00FF'X    4,B6
          1 000091       00FF

PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:36   
      202     7428    1          CALL KYK$OPCON(KY$CTX,OC_WRTM);

   7428   1 000092  DBF0 0002                            LAB,B5   2,IMO
          1 000094  DFC7 000A                            STB,B5   TEMP_STATUSW+4,AUTO
          1 000096  EFC7 0008                            STB,B6   TEMP_STATUSW+2,AUTO
          1 000098  BBC7 0008                            LAB,B3   TEMP_STATUSW+2,AUTO
          1 00009A  CBF0 0200                            LAB,B4   512,IMO
          1 00009C  E380 0000 0000  xent                 LNJ,B6   KYK$OPCON
          1 00009F       0001                            DC       s:7429,PREL

      203     7429    1   ALT:   RETURN;

   7429   1 0000A0  C380 0000 0000  xent ALT             LNJ,B4   X6A_ARET
      204     7430    1   END KYT$TIMEOUT;

PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:37   
--  Include file information  --

   KH$CHN.:E05TOU  is referenced.
   KV$GLB.:E05TOU  is referenced.
   KV_GLB_M.:E05TOU  is referenced.
   KV$GLBCTX.:E05TOU  is referenced.
   OC_SUBS_C.:E05TOU  is referenced.
   KV_GLBCNS_E.:E05TOU  is referenced.
   KY_SUBS_C.:E05TOU  is referenced.
   KY_URP_M.:E05TOU  is referenced.
   KY_PERR_C.:E05TOU  is referenced.
   G_LCP6_E.:E05TOU  is referenced.
   GT_LCP6_M.:E05TOU  is referenced.
   KI_CP6.:E05TOU  is referenced.
   GF_LCP6_M.:E05TOU  is referenced.
   GM_LCP6_M.:E05TOU  is referenced.
   GU_LCP6_M.:E05TOU  is referenced.
   GJ_LCP6_M.:E05TOU  is referenced.
   GH_LCP6_M.:E05TOU  is referenced.
   LCP_6.:E05TOU  cannot be made into a system file and is referenced.
      No diagnostics issued in procedure KYT$TIMEOUT.
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:38   

 **** Variables and constants ****

  ****  Section 000  Data  KYT$TIMEOUT

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(336)   r     1 FPT_WRSYSLOG

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     4-0-0/w PTR         r     1 @KY$CTX                   *0-0-0/w STRC(608)   r     1 KY$CTX
     6-0-0/w UBIN(16)    r     1 TEMP_STATUSW

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
HexLoc.c.b A Datatyp(siz) R M Lvl/name                 HexLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(512)   r     1 KH$CHN                     0-0-0/w STRC(512)   r     1 KV$VDI


   Procedure KYT$TIMEOUT requires 163 words for executable code.
   Procedure KYT$TIMEOUT requires 12 words of local(AUTO) storage.

    No errors detected in file KYT$TIMER.:E05TSI    .
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:39   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:40   
          MINI XREF LISTING

ALT
      7429**LABEL    7418--CALLALT
FPT_WRSYSLOG
      7311**DCL      7403<>CALL     7420<>CALL
FPT_WRSYSLOG.V
      7315**DCL      7313--DCLINIT
FPT_WRSYSLOG.V.ERRCODE.ERR#
      7359**DCL      7402<<ASSIGN   7419<<ASSIGN
FPT_WRSYSLOG.V.TERMID
      7378**DCL      7398<<ASSIGN
FPT_WRSYSLOG.V.TERMID.TERM
      7380**DCL      7389--REDEF
KH$CHN.TERMID
      7028**DCL      7398>>ASSIGN
KH$CHN.TERMID.TERM
      7030**DCL      7039--REDEF
KHA$ERRLOG
      7296**DCL-ENT  7403--CALL     7420--CALL
KV$VDI.CHN$
      7064**DCL      7398>>ASSIGN
KY$CTX
      7125**DCL        53--PROC     7399<>CALL     7411<>CALL     7413<>CALL     7418<>CALL     7428<>CALL
KY$CTX.DEFRD.STATUSW
      7267**DCL      7269--REDEF    7400<<ASSIGN
KY$CTX.DVCTYP
      7213**DCL      7409>>DOCASE
KY$CTX.DVC_STATE
      7128**DCL      7426<<ASSIGN
KY$CTX.DVC_STATUS
      7129**DCL      7427<<ASSIGN
KY$CTX.MODE
      7216**DCL      7224--REDEF
PL6.E3A0      #002=KYT$TIMEOUT File=KYT$TIMER.:E05TSI                            WED 07/30/97 02:46 Page:41   
KY$CTX.RESCHEDULE.TIMER
      7275**DCL      7396<<ASSIGN
KY$CTX.STATUSW
      7143**DCL      7145--REDEF    7153--REDEF    7167--REDEF    7181--REDEF    7195--REDEF    7397>>ASSIGN
      7400>>ASSIGN   7417<<ASSIGN
KY$CTX.TIMEOUT
      7214**DCL      7401<<ASSIGN
KY$CTX.VDI$
      7210**DCL      7398>>ASSIGN
KY$CTX.VDIENB
      7281**DCL      7287--REDEF
KYI$IO
      7292**DCL-ENT  7399--CALL     7418--CALL
KYK$OPCON
      7295**DCL-ENT  7428--CALL
KYN$IUR_HNDLR
      7294**DCL-ENT  7413--CALL
KYN$OUR_HNDLR
      7293**DCL-ENT  7411--CALL
NAKED
      7409**LABEL    7399--CALLALT
TEMP_STATUSW
      7394**DCL      7397<<ASSIGN   7417>>ASSIGN
