VERSION E05

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:1    
        1        1        /*M* TOU$NEWCAT     DEckfile Editor Routine NEW CATALOG Function */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* PLM=3,DCI=6,SQB=N,PRB=N,DTI=5,ENI=0,AND=Y,ECI=0,CSU=3,DIN=3,
        9        9             CTI=8,CRM=109,CRT=1,NLB=N,NTB=Y,MCL=110 */
       10       10
       11       11        /*P*  NAME:        TOU$NEWCAT
       12       12              AUTHOR:      Scott S. Sheppard
       13       13              PURPOSE:     DEckfile Editor Routine NEW CATALOG Function
       14       14              DESCRIPTION: This program is called when the NEWCAT function
       15       15                           is invoked by the  CP-6 deckfile editor driver.
       16       16                           This program adds a new catalog  to an existing
       17       17                           CP-6 deckfile.
       18       18              REFERENCE:   CP-6 Release C0M0
       19       19              LAST UPDATE: 10/27/83
       20       20        */
       21       21        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:2    
       22       22        /*F*  NAME:        TOU$NEWCAT
       23       23              DESCRIPTION: Procedure Nesting Hierarchy
       24       24
       25       25              TOU$NEWCAT: procedure
       26       26                 NC_INIT_DUP: procedure
       27       27                 NC_COMMAND_SETUP: procedure ALTRET
       28       28                 NC_SETUP_DF: procedure ALTRET
       29       29                 NC_CHECK_FOR_CATALOG: procedure ALTRET
       30       30                    NC_VERIFY_ADDITION: procedure ALTRET
       31       31                 NC_ADD_CATALOG: procedure ALTRET
       32       32                    NC_PROCESS_IFAD: procedure ALTRET
       33       33                       NC_CHECK_MATCH: procedure
       34       34                       NC_STORE_OBJECT_DECK: procedure ALTRET
       35       35                       NC_STORE_CATALOG_ENTRY: procedure ALTRET
       36       36                       NC_STORE_SUBCATALOG: procedure ALTRET
       37       37                       NC_STORE_CATALOG: procedure ALTRET
       38       38                       NC_STORE_MASTER_ENTRY: procedure ALTRET
       39       39                       NC_STORE_MASTER_CATALOG: procedure ALTRET
       40       40                       NC_STORE_LAST_DECK#: procedure ALTRET
       41       41                    NC_PROCESS_TEMP: procedure ALTRET
       42       42                       NC_SAVE_MASTER_CONTROL: procedure ALTRET
       43       43                       NC_SAVE_MASTER_ENTRY: procedure ALTRET
       44       44                       NC_SAVE_SUBCATALOG: procedure ALTRET
       45       45                       NC_SAVE_CATALOG_ENTRY: procedure ALTRET
       46       46                       NC_SAVE_LOG: procedure ALTRET
       47       47                       NC_SETUP_PRINT: procedure
       48       48                       NC_PRINT_ADDED_CATALOG: procedure
       49       49                 NC_ERR_MSG: procedure (ERR_CODE)
       50       50        */
       51       51        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:3    
       52       52        TOU$NEWCAT: PROC ;
       53       53
       54       54        /* Include Files */
       55       55
       56       56           %INCLUDE TOU_DEER_M ;
       57     1467           %INCLUDE TOU_RQSTS_E ;
       58     1542           %INCLUDE TO_PERR_C ;
       59     2127           %INCLUDE XU_MACRO_C ;
       60     5233
       61     5234        /* Macros */
       62     5235
       63     5236           %DUP (STCLASS = SYMREF) ;
       64     5379           %BCD_B (STCLASS = "BASED (DUP.BCD_V.PTR$)") ;
       65     5391           %BCD_CARD (STCLASS = SYMREF) ;
       66     5411           %BCD_KEY (STCLASS = SYMREF) ;
       67     5425           %BINARY_CARD (STCLASS = SYMREF) ;
       68     5452           %BINARY_KEY (STCLASS = SYMREF) ;
       69     5466           %CATALOG_DATA (STCLASS = SYMREF) ;
       70     5480           %CATALOG_ENTRY_KEY (STCLASS = SYMREF) ;
       71     5494           %CATALOG_KEY (STCLASS = SYMREF) ;
       72     5508           %CATALOG_SEARCH_KEY (STCLASS = "STATIC SYMDEF") ;
       73     5520           %DKEND (STCLASS = SYMREF) ;
       74     5544           %ID (STCLASS = SYMREF) ;
       75     5561           %LAST (STCLASS = SYMREF) ;
       76     5574           %MASTER_DATA (STCLASS = SYMREF) ;
       77     5588           %MASTER_ENTRY_KEY (STCLASS = SYMREF) ;
       78     5602           %OBJECT (STCLASS = SYMREF) ;
       79     5665           %OBJECT_KEY (STCLASS = SYMREF) ;
       80     5678           %RECORD (STCLASS = SYMREF) ;
       81     5705           %SUBCATALOG_DATA (STCLASS = SYMREF) ;
       82     5718           %SUBCATALOG_KEY (STCLASS = SYMREF) ;
       83     5732           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:4    
       84     5733        /* Variables */
       85     5734
       86     5735    1      DCL BCD#             UBIN WORD SYMREF ;
       87     5736    1      DCL BIN#             UBIN WORD SYMREF ;
       88     5737    1      DCL CATALOG_KEY_SET  BIT (1) SYMREF CALIGNED ;
       89     5738    1      DCL DECK_SAVED       BIT (1) SYMREF CALIGNED ;
       90     5739    1      DCL FILE_EOF         UBIN WORD SYMREF ALIGNED;
       91     5740           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:5    
       92     5741        /* External Entry Points */
       93     5742
       94     5743    1      DCL TOU$DU_SET_IFAD_FID            ENTRY ALTRET ;
       95     5744    1      DCL TOU$DU_OPEN_IFAD               ENTRY ALTRET ;
       96     5745    1      DCL TOU$DU_CLOSE_IFAD              ENTRY ALTRET ;
       97     5746
       98     5747    1      DCL TOU$DU_SET_DF_FID              ENTRY ALTRET ;
       99     5748    1      DCL TOU$DU_OPEN_DF                 ENTRY ALTRET ;
      100     5749    1      DCL TOU$DU_CLOSE_DF                ENTRY ALTRET ;
      101     5750
      102     5751    1      DCL TOU$DU_SET_EDIT_PROMPT         ENTRY ALTRET ;
      103     5752    1      DCL TOU$DU_SET_PROMPT              ENTRY ALTRET ;
      104     5753    1      DCL TOU$DU_USER_READ               ENTRY ALTRET ;
      105     5754    1      DCL TOU$DU_USER_WRITE              ENTRY ALTRET ;
      106     5755    1      DCL TOU$DU_PRINTER_WRITE           ENTRY ALTRET ;
      107     5756    1      DCL TOU$DU_UPDATE_LOG              ENTRY ALTRET ;
      108     5757
      109     5758    1      DCL TOU$CHECKSUM                   ENTRY (4) ALTRET ;
      110     5759    1      DCL TOU$CLEAR_IFAD                 ENTRY ALTRET ;
      111     5760    1      DCL TOU$REPLACE                    ENTRY (2) ;
      112     5761
      113     5762    1      DCL TOU$GET_CP6_OBJECT             ENTRY ALTRET ;
      114     5763    1      DCL TOU$GET_BINARY_CARDS           ENTRY ALTRET ;
      115     5764    1      DCL TOU$GET_BCD_CARDS              ENTRY ALTRET ;
      116     5765    1      DCL TOU$B_SHOW_DCBS                ENTRY ALTRET ;
      117     5766    1      DCL TOU$B_GET_CATALOG              ENTRY ALTRET ;
      118     5767    1      DCL TOU$B_SET_CATALOG_KEY          ENTRY ALTRET ;
      119     5768    1      DCL TOU$B_SET_OBJECT_KEY           ENTRY ALTRET ;
      120     5769    1      DCL TOU$B_CHECK_CORRECT_FILE       ENTRY ALTRET ;
      121     5770    1      DCL TOU$B_PRINT_DECK_LINE          ENTRY ALTRET ;
      122     5771    1      DCL TOU$ND_SAVE_CATALOG_CONTROL    ENTRY ALTRET ;
      123     5772    1      DCL TOU$ND_SAVE_OBJECT_DECK        ENTRY ALTRET ;
      124     5773    1      DCL TOU$ND_SAVE_LAST_DECK#         ENTRY ALTRET ;
      125     5774           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:6    
      126     5775        /* External Entry Points */
      127     5776
      128     5777    1      DCL TOU$DFU_DF_RD_MASTER_CONTROL   ENTRY ALTRET ;
      129     5778    1      DCL TOU$DFU_DF_RD_MASTER_ENTRY     ENTRY ALTRET ;
      130     5779    1      DCL TOU$DFU_DF_RD_LAST_DECK#       ENTRY ALTRET ;
      131     5780    1      DCL TOU$DFU_DF_RD_LOG              ENTRY ALTRET ;
      132     5781
      133     5782    1      DCL TOU$DFU_DF_WR_MASTER_CONTROL   ENTRY ALTRET ;
      134     5783    1      DCL TOU$DFU_DF_WR_MASTER_ENTRY     ENTRY ALTRET ;
      135     5784    1      DCL TOU$DFU_DF_WR_SUBCATALOG       ENTRY ALTRET ;
      136     5785    1      DCL TOU$DFU_DF_WR_CATALOG_ENTRY    ENTRY ALTRET ;
      137     5786    1      DCL TOU$DFU_DF_WR_LOG              ENTRY ALTRET ;
      138     5787           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:7    
      139     5788        /* External Entry Points */
      140     5789
      141     5790    1      DCL TOU$DFU_OPEN_TEMP              ENTRY ALTRET ;
      142     5791    1      DCL TOU$DFU_CLOSE_TEMP             ENTRY ALTRET ;
      143     5792
      144     5793    1      DCL TOU$DFU_TF_RD_MASTER_CONTROL   ENTRY ALTRET ;
      145     5794    1      DCL TOU$DFU_TF_RD_MASTER_ENTRY     ENTRY ALTRET ;
      146     5795    1      DCL TOU$DFU_TF_RD_SUBCATALOG       ENTRY ALTRET ;
      147     5796    1      DCL TOU$DFU_TF_RD_CATALOG_ENTRY    ENTRY ALTRET ;
      148     5797
      149     5798    1      DCL TOU$DFU_TF_WR_MASTER_CONTROL   ENTRY ALTRET ;
      150     5799    1      DCL TOU$DFU_TF_WR_MASTER_ENTRY     ENTRY ALTRET ;
      151     5800    1      DCL TOU$DFU_TF_WR_CATALOG_CONTROL  ENTRY ALTRET ;
      152     5801    1      DCL TOU$DFU_TF_WR_SUBCATALOG       ENTRY ALTRET ;
      153     5802    1      DCL TOU$DFU_TF_WR_CATALOG_ENTRY    ENTRY ALTRET ;
      154     5803    1      DCL TOU$DFU_TF_WR_OBJECT           ENTRY ALTRET ;
      155     5804    1      DCL TOU$DFU_TF_WR_BINARY           ENTRY ALTRET ;
      156     5805    1      DCL TOU$DFU_TF_WR_BCD_CARDS        ENTRY ALTRET ;
      157     5806    1      DCL TOU$DFU_TF_WR_LAST_DECK#       ENTRY ALTRET ;
      158     5807           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:8    
      159     5808        /* ********************
      160     5809           ********************
      161     5810           **  Main Program  **
      162     5811           ********************
      163     5812           ******************** */
      164     5813
      165     5814    1      CALL NC_INIT_DUP ;
      166     5815    1      CALL NC_COMMAND_SETUP ALTRET (ERROR_RETURN) ;
      167     5816    1      CALL TOU$B_SHOW_DCBS ;
      168     5817
      169     5818    1      CALL TOU$DU_OPEN_DF ALTRET (ERROR_RETURN) ;
      170     5819    1      CALL NC_SETUP_DF ALTRET (ERROR_RETURN) ;
      171     5820    1      CALL NC_CHECK_FOR_CATALOG ALTRET (ERROR_RETURN) ;
      172     5821    1      CALL NC_ADD_CATALOG ALTRET (ERROR_RETURN) ;
      173     5822    1      CALL TOU$DU_CLOSE_DF ALTRET (ERROR_RETURN) ;
      174     5823
      175     5824        /* NORMAL_RETURN: */
      176     5825    1      DUP.MSG_CODE = %T$NC_SUCCESS;
      177     5826    1      CALL TOU$DU_USER_WRITE ;
      178     5827    1      RETURN ;
      179     5828
      180     5829    1   ERROR_RETURN:
      181     5830    1      CALL TOU$DU_CLOSE_DF ;
      182     5831    1      DUP.MSG_CODE = %T$NC_FAILURE;
      183     5832    1      CALL TOU$DU_USER_WRITE ;
      184     5833    1      RETURN ;
      185     5834
      186     5835        /* ********************
      187     5836           ********************
      188     5837           **  End Of  Main  **
      189     5838           ********************
      190     5839           ******************** */
      191     5840        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:9    
      192     5841        /*I*  NAME:        NC_INIT_DUP
      193     5842              AUTHOR:      Scott S. Sheppard
      194     5843              PURPOSE:     Initilization
      195     5844              INTERFACE:   None called.
      196     5845              INPUT:       H$NEWCAT  - default header code for new catalog
      197     5846                           LINES_PER_PAGE - force new page write
      198     5847                           UPDATE    - deckfile opened for update
      199     5848              OUTPUT:      DUP - Deckfile Utility Parameter
      200     5849                           DECK_SAVED
      201     5850              DESCRIPTION: This procedure initializes variables to
      202     5851                           appropriate starting values.
      203     5852        */
      204     5853
      205     5854    1   NC_INIT_DUP: PROC ;
      206     5855
      207     5856        /* Code */
      208     5857
      209     5858    2      DUP.HDR_CODE = %H$NEWCAT ;
      210     5859    2      DUP.LINE_VFC = %SKIP_WRITE ;
      211     5860    2      DUP.FORCE_NEW_PAGE = %TRUE ;
      212     5861    2      DUP.IFAD.ME_ALLOWED = %FALSE ;
      213     5862    2      DUP.IFAD.ENTERED = %FALSE ;
      214     5863    2      DUP.DF.ENTERED = %FALSE ;
      215     5864    2      DUP.DF.OPEN_TYPE = %UPDATE_FILE ;
      216     5865    2      DUP.DF.REPORT_ERROR = %TRUE ;
      217     5866    2      DUP.DF.CLOSE_TYPE = %SAVE_FILE ;
      218     5867    2      DECK_SAVED = %FALSE ;
      219     5868    2      RETURN ;
      220     5869
      221     5870    2   END NC_INIT_DUP ;
      222     5871        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:10   
      223     5872        /*I*  NAME:        NC_COMMAND_SETUP
      224     5873              AUTHOR:      Scott S. Sheppard
      225     5874              PURPOSE:     Sets up NEWCAT Command
      226     5875              INTERFACE:   TOU$DU_SET_IFAD_FID
      227     5876                           TOU$DU_SET_DF_FID
      228     5877              INPUT:       DUP.CMD$ - pointer to the parse control block
      229     5878              OUTPUT:      DUP.DF.HOLD_AREA
      230     5879                           DUP.DF.HOLD_AREA_LGTH
      231     5880                           DUP.IFAD.ENTERED
      232     5881                           DUP.DF.ENTERED
      233     5882                           CATALOG_SEARCH_KEY.DATA
      234     5883              DESCRIPTION: This procedure sets up the NEWCAT command from the
      235     5884                           information entered by the user.     DUP.CMD$ is a
      236     5885                           pointer to a   parse control block  that  contains
      237     5886                           the tokens entered by the user.
      238     5887                           Command Forms:
      239     5888              Case 1: NC <catalog key>
      240     5889              Case 2: NC <ifad fid> <catalog key>
      241     5890              Case 3: NC <catalog key> INTO <deckfile fid>
      242     5891              Case 4: NC <ifad fid> <catalog key> INTO <deckfile fid>
      243     5892        */
      244     5893
      245     5894    1   NC_COMMAND_SETUP: PROC ALTRET ;
      246     5895
      247     5896    2      DCL OUTBLK#                    UBIN WORD ALIGNED ;
      248     5897    2      DCL OUTBLK$                    PTR ALIGNED ;
      249     5898           %PARSE$OUT (STCLASS = BASED) ;
      250     5943           %PARSE$SYM (STCLASS = BASED) ;
      251     5981           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:11   
      252     5982        /* Code */
      253     5983
      254     5984    3      DO OUTBLK# = 0 TO DUP.CMD$ -> OUT$BLK.NSUBLKS - 1 ;
      255     5985    3         OUTBLK$ = DUP.CMD$ -> OUT$BLK.SUBLK$(OUTBLK#) ;
      256     5986    4         DO CASE (OUTBLK$ -> OUT$BLK.CODE) ;
      257     5987    4            CASE (%IFAD_FID) ;
      258     5988    4               DUP.IFAD.ENTERED = %TRUE ;
      259     5989    4               DUP.HOLD_AREA = OUTBLK$ -> OUT$SYM.TEXT ;
      260     5990    4               DUP.HOLD_AREA_LGTH = OUTBLK$ -> OUT$SYM.COUNT ;
      261     5991    4               CALL TOU$DU_SET_IFAD_FID ALTRET (ERROR) ;
      262     5992    4            CASE (%CATKEY) ;
      263     5993    4               CATALOG_SEARCH_KEY.DATA = OUTBLK$ -> OUT$SYM.TEXT ;
      264     5994    4            CASE (%DECKFILE_FID) ;
      265     5995    4               DUP.DF.ENTERED = %TRUE ;
      266     5996    4               DUP.HOLD_AREA = OUTBLK$ -> OUT$SYM.TEXT ;
      267     5997    4               DUP.HOLD_AREA_LGTH = OUTBLK$ -> OUT$SYM.COUNT ;
      268     5998    4               CALL TOU$DU_SET_DF_FID ALTRET (ERROR) ;
      269     5999    4         END /* CASE */ ;
      270     6000    3      END /* DO */ ;
      271     6001
      272     6002    2      IF DUP.IFAD.ENTERED
      273     6003    2      THEN /* FID set from DEER command */ ;
      274     6004    2      ELSE CALL TOU$DU_SET_IFAD_FID ALTRET (ERROR) ;
      275     6005    2      IF DUP.DF.ENTERED
      276     6006    2      THEN /* FID set from DEER command */ ;
      277     6007    2      ELSE CALL TOU$DU_SET_DF_FID ALTRET (ERROR) ;
      278     6008    2      RETURN ;
      279     6009
      280     6010    2   ERROR:
      281     6011    2      ALTRETURN ;
      282     6012
      283     6013    2   END NC_COMMAND_SETUP ;
      284     6014        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:12   
      285     6015        /*I*  NAME:        NC_SETUP_DF
      286     6016              AUTHOR:      Scott S. Sheppard
      287     6017              PURPOSE:     Initilization
      288     6018              INTERFACE:   TOU$DFU_DF_RD_CATALOG_CONTROL
      289     6019                           TOU$DFU_DF_RD_LAST_DECK#
      290     6020                           TOU$DFU_DF_RD_LOG
      291     6021              INPUT:       MASTER_DATA
      292     6022              OUTPUT:      MASTER_DATA
      293     6023                           MASTER_ENTRY
      294     6024                           LAST.DECK#
      295     6025              DESCRIPTION: This procedure initializes variables for the
      296     6026                           deckfile by reading them from the deckfile.
      297     6027        */
      298     6028
      299     6029    1   NC_SETUP_DF: PROC ALTRET ;
      300     6030
      301     6031        /* Code */
      302     6032
      303     6033    2      CALL TOU$DFU_DF_RD_MASTER_CONTROL ALTRET (ERROR) ;
      304     6034    2      MASTER_ENTRY_KEY.DECK# = MASTER_DATA.DECK# ;
      305     6035    2      MASTER_ENTRY_KEY.ENTRY# = MASTER_DATA.ENTRY_COUNT ;
      306     6036    2      CALL TOU$DFU_DF_RD_LAST_DECK# ALTRET (ERROR) ;
      307     6037    2      LAST.DECK# = LAST.DECK# + 1 ;
      308     6038    2      CATALOG_KEY_SET = %FALSE ;
      309     6039    2      CALL TOU$DFU_DF_RD_LOG ALTRET (ERROR) ;
      310     6040    2      RETURN ;
      311     6041
      312     6042    2   ERROR:
      313     6043    2      ALTRETURN ;
      314     6044
      315     6045    2   END NC_SETUP_DF ;
      316     6046        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:13   
      317     6047        /*I*  NAME:        NC_CHECK_FOR_CATALOG
      318     6048              AUTHOR:      Scott S. Sheppard
      319     6049              PURPOSE:     Catalog Existance Checking
      320     6050              INTERFACE:   TOU$DFU_DF_RD_MASTER_ENTRY
      321     6051                           NC_VERIFY_ADDITION
      322     6052              INPUT:       MASTER_ENTRY
      323     6053                           MASTER_DATA
      324     6054                           CATALOG_KEY
      325     6055                           CATALOG_SEARCH_KEY
      326     6056                           TOU$DU_USER_WRITE
      327     6057              OUTPUT:      MASTER_ENTRY_KEY.ENTRY#
      328     6058              DESCRIPTION: This procedure checks the deckfile to determine if
      329     6059                           a catalog already exists in the deckfile  with the
      330     6060                           same key value as the one specified. If no catalog
      331     6061                           exists,  the new one  may be added.   If a catalog
      332     6062                           exists,  and it's  an  ITR catalog,  the  user  is
      333     6063                           prompted to determine if another catalog should be
      334     6064                           added to the deckfile.
      335     6065        */
      336     6066        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:14   
      337     6067    1   NC_CHECK_FOR_CATALOG: PROC ALTRET ;
      338     6068
      339     6069    2      DCL FOUND                      BIT (1) CALIGNED ;
      340     6070    2      DCL ITR_INX                    UBIN WORD ALIGNED ;
      341     6071
      342     6072        /* Code */
      343     6073
      344     6074    2      FOUND = %FALSE ;
      345     6075    2      MASTER_ENTRY_KEY.ENTRY# = 1 ;
      346     6076    3      DO UNTIL (FOUND OR MASTER_ENTRY_KEY.ENTRY# > MASTER_DATA.ENTRY_COUNT) ;
      347     6077    3         CALL TOU$DFU_DF_RD_MASTER_ENTRY ALTRET (ERROR) ;
      348     6078    3         IF CATALOG_KEY.DATA = CATALOG_SEARCH_KEY.DATA
      349     6079    3         THEN FOUND = %TRUE ;
      350     6080    3         ELSE MASTER_ENTRY_KEY.ENTRY# = MASTER_ENTRY_KEY.ENTRY# + 1 ;
      351     6081    3      END /* UNTIL */ ;
      352     6082
      353     6083    2      IF FOUND
      354     6084    3      THEN DO ;
      355     6085    3              DUP.MSG_CODE = %E$NCFC_ALREADY_IN ;
      356     6086    3              CALL TOU$DU_USER_WRITE ;
      357     6087    3              CALL INDEX (ITR_INX, 'ITR', CATALOG_KEY.DATA, 0) ALTRET (ERROR) ;
      358     6088    3              CALL NC_VERIFY_ADDITION ALTRET (STILL_DO_IT) ;
      359     6089    3   ERROR:
      360     6090    3              ALTRETURN ;
      361     6091    3           END /* THEN */ ;
      362     6092    3      ELSE DO ;
      363     6093    3   STILL_DO_IT:
      364     6094    3              RETURN ;
      365     6095    3           END /* ELSE */ ;
      366     6096
      367     6097        /* END NC_CHECK_FOR_CATALOG */
      368     6098        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:15   
      369     6099        /*I*  NAME:        NC_VERIFY_ADDITION
      370     6100              AUTHOR:      Scott S. Sheppard
      371     6101              PURPOSE:     Catalog Addition Verification
      372     6102              INTERFACE:   TOU$DU_SET_PROMPT
      373     6103                           TOU$DU_USER_READ
      374     6104                           TOU$DU_SET_EDIT_PROMPT
      375     6105              INPUT:       DUP.COMMAND
      376     6106                           CATALOG_SEARCH_KEY.DATA
      377     6107              OUTPUT:      DUP.MSG_CODE
      378     6108                           DUP.HOLD_AREA
      379     6109                           DUP.HOLD_AREA_LGTH
      380     6110              DESCRIPTION: This procedure prompts the user to determine if
      381     6111                           the catalog should actually be added.
      382     6112        */
      383     6113
      384     6114    2   NC_VERIFY_ADDITION: PROC ALTRET ;
      385     6115
      386     6116    3      DCL RESPONSE_ CHAR (40) CALIGNED ;
      387     6117    3      DCL RESPONSE  (0:39) REDEF RESPONSE_ CHAR (1) CALIGNED ;
      388     6118    3      DCL CHR_INX   UBIN WORD ALIGNED ;
      389     6119    3      DCL BL_INX    UBIN WORD ALIGNED ;
      390     6120    3      DCL VALID_RESPONSE BIT (1) ;
      391     6121
      392     6122        /* Code */
      393     6123
      394     6124           /* Inform that another may be added. */
      395     6125    3      DUP.MSG_CODE = %E$NVA_MAY_ADD ;
      396     6126    3      CALL TOU$DU_USER_WRITE ;
      397     6127
      398     6128           /* Set prompt to ask question */
      399     6129    3      DUP.HOLD_AREA = 'Still wish to add catalog: ' ;
      400     6130    3      DUP.HOLD_AREA_LGTH = 27 ;
      401     6131    3      CALL TOU$DU_SET_PROMPT ;
      402     6132           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:16   
      403     6133    4      DO UNTIL VALID_RESPONSE ;
      404     6134    4         DUP.RESPONSE_LGTH = 3 ;
      405     6135    4         CALL TOU$DU_USER_READ ;
      406     6136    4         RESPONSE_ = DUP.RESPONSE ;
      407     6137
      408     6138              /* Skip leading spaces */
      409     6139    4         CHR_INX = 0 ;
      410     6140    5         DO WHILE RESPONSE(CHR_INX) = ' ' & CHR_INX < 40 ;
      411     6141    5            CHR_INX = CHR_INX + 1 ;
      412     6142    5         END /* WHILE */ ;
      413     6143
      414     6144              /* Find first blank following first non-blank */
      415     6145    4         CALL INDEX (BL_INX, ' ', RESPONSE_, CHR_INX) ;
      416     6146
      417     6147              /* Check Response for Yes or No */
      418     6148    5         DO SELECT (SUBSTR (RESPONSE_, CHR_INX, BL_INX - CHR_INX)) ;
      419     6149    5            SELECT ('Y', 'YE', 'YES', 'N', 'NO') ;
      420     6150    5            VALID_RESPONSE = %TRUE ;
      421     6151    5            SELECT (ELSE) ;
      422     6152    5         VALID_RESPONSE = %FALSE ;
      423     6153    5         DUP.MSG_CODE = %E$NVA_INVALID_REPLY ;
      424     6154    5         CALL TOU$DU_USER_WRITE ;
      425     6155    5         END /* SELECT */ ;
      426     6156    4      END /* UNTIL */ ;
      427     6157
      428     6158           /* Put PROMPT back to normal. */
      429     6159    3      CALL TOU$DU_SET_EDIT_PROMPT ;
      430     6160
      431     6161           /* If affirmative then take alternate return */
      432     6162    3      IF RESPONSE(CHR_INX) = 'Y'
      433     6163    3      THEN ALTRETURN ;
      434     6164    3      ELSE RETURN ;
      435     6165
      436     6166    3   END NC_VERIFY_ADDITION ;
      437     6167    2   END NC_CHECK_FOR_CATALOG ;
      438     6168        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:17   
      439     6169        /*I*  NAME:        NC_ADD_CATALOG
      440     6170              AUTHOR:      Scott S. Sheppard
      441     6171              PURPOSE:     Adds the Catalog to the Deckfile
      442     6172              INTERFACE:   TOU$DFU_OPEN_TEMP
      443     6173                           TOU$DFU_CLOSE_TEMP
      444     6174                           TOU$DU_OPEN_IFAD
      445     6175                           TOU$CLEAR_IFAD
      446     6176                           TOU$DU_CLOSE_IFAD
      447     6177                           TOU$DU_USER_WRITE
      448     6178                           NC_PROCESS_IFAD
      449     6179                           NC_PROCESS_TEMP
      450     6180              INPUT:       IFAD input source
      451     6181                           DEER temporary file
      452     6182              OUTPUT:      DEER temporary file
      453     6183                           Deckfile - catalog added
      454     6184              DESCRIPTION: This procedure processes the IFAD input source
      455     6185                           to the temporary file.   If no errors occurred
      456     6186                           the temporary file, which contains the updates
      457     6187                           to be made to the deckfile,  is processed  and
      458     6188                           the new catalog is added.
      459     6189        */
      460     6190        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:18   
      461     6191    1   NC_ADD_CATALOG: PROC ALTRET ;
      462     6192
      463     6193        /* Code */
      464     6194
      465     6195    2      DUP.TEMP.OPEN_TYPE = %CREATE_FILE ;
      466     6196    2      CALL TOU$DFU_OPEN_TEMP ALTRET (ERROR) ;
      467     6197    2      CALL TOU$DU_OPEN_IFAD ALTRET (ERROR) ;
      468     6198    2      CALL TOU$CLEAR_IFAD ;
      469     6199    2      CALL NC_PROCESS_IFAD ALTRET (ERROR) ;
      470     6200    2      CALL TOU$DU_CLOSE_IFAD ALTRET (ERROR) ;
      471     6201    2      DUP.TEMP.CLOSE_TYPE = %SAVE_FILE ;
      472     6202    2      CALL TOU$DFU_CLOSE_TEMP ALTRET (ERROR) ;
      473     6203
      474     6204    2      DUP.TEMP.OPEN_TYPE = %READ_FILE ;
      475     6205    2      CALL TOU$DFU_OPEN_TEMP ALTRET (ERROR) ;
      476     6206    2      CALL NC_PROCESS_TEMP ALTRET (ERROR) ;
      477     6207    2      DUP.TEMP.CLOSE_TYPE = %DISCARD_FILE ;
      478     6208    2      CALL TOU$DFU_CLOSE_TEMP ALTRET (ERROR) ;
      479     6209    2      RETURN ;
      480     6210
      481     6211    2   ERROR:
      482     6212    2      CALL TOU$DU_CLOSE_IFAD ;
      483     6213    2      DUP.TEMP.CLOSE_TYPE = %DISCARD_FILE ;
      484     6214    2      CALL TOU$DFU_CLOSE_TEMP ;
      485     6215    2      ALTRETURN ;
      486     6216
      487     6217        /* END NC_ADD_CATALOG */
      488     6218        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:19   
      489     6219        /*I*  NAME:        NC_PROCESS_IFAD
      490     6220              AUTHOR:      Scott S. Sheppard
      491     6221              PURPOSE:     Processes IFAD Input
      492     6222              INTERFACE:   NC_GET_CP6_OBJECT
      493     6223                           NC_GET_CATALOG
      494     6224                           NC_STORE_CATALOG
      495     6225                           NC_HOLD_BCD
      496     6226                           NC_HOLD_BINARY
      497     6227                           NC_ERR_MSG
      498     6228                           NC_STORE_MASTER_CATALOG
      499     6229                           NC_STORE_LAST_DECK#
      500     6230                           TOU$DFU_OPEN_TEMP
      501     6231                           TOU$DFU_CLOSE_TEMP
      502     6232              INPUT:       OBJECT_FOUND
      503     6233                           RECORD.SIZE
      504     6234                           FILE_EOF
      505     6235              OUTPUT:      DUP.TEMP.CLOSE_TYPE - set if wrong file used
      506     6236              DESCRIPTION: This procedure processes the IFAD input source
      507     6237                           from start to end (two EOF marks in a row).
      508     6238        */
      509     6239        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:20   
      510     6240    2   NC_PROCESS_IFAD: PROC ALTRET ;
      511     6241
      512     6242    3      DCL MATCHING_CATALOG           BIT (1) CALIGNED ;
      513     6243
      514     6244        /* Code */
      515     6245
      516     6246    3      CALL TOU$GET_CP6_OBJECT ALTRET (ERROR) ;
      517     6247    3      MATCHING_CATALOG = %FALSE ;
      518     6248    4      DO WHILE (~MATCHING_CATALOG AND FILE_EOF < 2) ;
      519     6249    4         CALL NC_SETUP_DF ;
      520     6250    4         CALL TOU$B_GET_CATALOG ;
      521     6251    4         CALL TOU$B_SET_CATALOG_KEY ALTRET (ERROR) ;
      522     6252    5         DO WHILE (FILE_EOF = 0) ;
      523     6253    5            CALL TOU$GET_BINARY_CARDS ALTRET (ERROR) ;
      524     6254    5            CALL TOU$GET_BCD_CARDS ALTRET (ERROR) ;
      525     6255    5            CALL TOU$B_SET_OBJECT_KEY ALTRET (ERROR) ;
      526     6256    5            CALL NC_STORE_OBJECT_DECK ALTRET (ERROR) ;
      527     6257    5            CALL TOU$B_CHECK_CORRECT_FILE ALTRET (ERROR) ;
      528     6258    5            CALL NC_STORE_CATALOG_ENTRY ALTRET (ERROR) ;
      529     6259    5            CALL TOU$GET_CP6_OBJECT ALTRET (ERROR) ;
      530     6260    5         END /* WHILE */ ;
      531     6261    4         CALL NC_CHECK_MATCH (MATCHING_CATALOG) ;
      532     6262    4         IF MATCHING_CATALOG
      533     6263    4         THEN /* No further reads are necessary */ ;
      534     6264    5         ELSE DO ;
      535     6265    5                 DUP.TEMP.CLOSE_TYPE = %DISCARD_FILE ;
      536     6266    5                 CALL TOU$DFU_CLOSE_TEMP ALTRET (ERROR) ;
      537     6267    5                 CALL TOU$DFU_OPEN_TEMP ALTRET (ERROR) ;
      538     6268    5                 CALL TOU$GET_CP6_OBJECT ALTRET (ERROR) ;
      539     6269    5              END /* ELSE */ ;
      540     6270    4      END /* WHILE */ ;
      541     6271           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:21   
      542     6272    3      IF MATCHING_CATALOG
      543     6273    4      THEN DO ;
      544     6274    4              CALL NC_STORE_SUBCATALOG ALTRET (ERROR) ;
      545     6275    4              CALL NC_STORE_CATALOG ALTRET (ERROR) ;
      546     6276    4              CALL NC_STORE_MASTER_ENTRY ALTRET (ERROR) ;
      547     6277    4              CALL NC_STORE_MASTER_CATALOG ALTRET (ERROR) ;
      548     6278    4              CALL NC_STORE_LAST_DECK# ALTRET (ERROR) ;
      549     6279    4              RETURN ;
      550     6280    4           END /* THEN */ ;
      551     6281    4      ELSE DO ;
      552     6282    4              CATALOG_KEY.DATA = CATALOG_SEARCH_KEY.DATA ;
      553     6283    4              CALL NC_ERR_MSG (%E$NPI_NO_ENTRIES) ;
      554     6284    4   ERROR:
      555     6285    4              ALTRETURN ;
      556     6286    4           END /* ELSE */ ;
      557     6287
      558     6288        /* END NC_PROCESS_IFAD */
      559     6289        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:22   
      560     6290        /*I*  NAME:        NC_CHECK_MATCH
      561     6291              AUTHOR:      Scott S. Sheppard
      562     6292              PURPOSE:     Checks for Catalog
      563     6293              INTERFACE:   None called.
      564     6294              INPUT:       CATALOG_SEARCH_KEY
      565     6295                           CATALOG_KEY
      566     6296              OUTPUT:      CATALOG_KEYS_MATCH - output parameter
      567     6297              DESCRIPTION: This procedure determines if the current $Object
      568     6298                           card is the first $object card of the catalog to
      569     6299                           be added.
      570     6300        */
      571     6301
      572     6302    3   NC_CHECK_MATCH: PROC (CATALOG_KEYS_MATCH) ;
      573     6303
      574     6304    4      DCL CATALOG_KEYS_MATCH         BIT (1) CALIGNED ;
      575     6305
      576     6306        /* Code */
      577     6307
      578     6308    4      IF CATALOG_KEY.DATA = CATALOG_SEARCH_KEY.DATA
      579     6309    4      THEN CATALOG_KEYS_MATCH = %TRUE ;
      580     6310    4      ELSE CATALOG_KEYS_MATCH = %FALSE ;
      581     6311    4      RETURN ;
      582     6312
      583     6313    4   END NC_CHECK_MATCH ;
      584     6314        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:23   
      585     6315        /*I*  NAME:        B_STORE_OBJECT_DECK
      586     6316              AUTHORS:     Dave Augustine
      587     6317                           Scott Sheppard
      588     6318              PURPOSE:     Saves a Binary Deck in Tempfile
      589     6319              INTERFACE:   TOU$CHECKSUM
      590     6320                           TOU$DFU_TF_WR_OBJECT
      591     6321                           TOU$DFU_TF_WR_BINARY
      592     6322                           TOU$DFU_TF_WR_BCD_CARDS
      593     6323              INPUT:       LAST.DECK#
      594     6324                           BIN#
      595     6325                           BCD#
      596     6326              OUTPUT:      OBJECT.DECK#
      597     6327                           OBJECT.BINARY_COUNT
      598     6328                           OBJECT.TOTAL_COUNT
      599     6329                           OBJECT.CHECKSUM
      600     6330                           DECK_SAVED
      601     6331                           LAST.DECK#
      602     6332                           BINARY_KEY.DECK#
      603     6333                           BCD_KEY.DECK#
      604     6334              DESCRIPTION: This procedure saves all of the records for an
      605     6335                           in the temporay file.
      606     6336        */
      607     6337        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:24   
      608     6338    3   NC_STORE_OBJECT_DECK: PROC ALTRET ;
      609     6339
      610     6340        /* Code */
      611     6341
      612     6342    4      DECK_SAVED = %TRUE ;
      613     6343
      614     6344           /* Set up $OBJECT card */
      615     6345    4      OBJECT.DECK# = LAST.DECK#;
      616     6346    4      OBJECT.BINARY_COUNT = BIN# ;
      617     6347    4      OBJECT.TOTAL_COUNT = BIN# + BCD# + 1;
      618     6348    4      CALL TOU$CHECKSUM (0,
      619     6349    4              ADDR (OBJECT),
      620     6350    4              23,
      621     6351    4              OBJECT.CHECKSUM);
      622     6352    4      LAST.DECK# = LAST.DECK# + 1 ;
      623     6353
      624     6354           /* Save the deck parts */
      625     6355    4      CALL TOU$DFU_TF_WR_OBJECT ALTRET (ERROR) ;
      626     6356    4      BINARY_KEY.DECK# = OBJECT.DECK# ;
      627     6357    4      CALL TOU$DFU_TF_WR_BINARY ALTRET (ERROR) ;
      628     6358    4      BCD_KEY.DECK# = OBJECT.DECK# ;
      629     6359    4      CALL TOU$DFU_TF_WR_BCD_CARDS ALTRET (ERROR) ;
      630     6360    4      RETURN ;
      631     6361
      632     6362    4   ERROR:
      633     6363    4      ALTRETURN ;
      634     6364
      635     6365    4   END NC_STORE_OBJECT_DECK;
      636     6366        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:25   
      637     6367        /*I*  NAME:        NC_STORE_CATALOG_ENTRY
      638     6368              AUTHORS:     David M. Augustine
      639     6369                           Scott S. Sheppard
      640     6370              PURPOSE:     Saves the Deck as a Catalog Entry
      641     6371              INTERFACE:   TOU$DFU_TF_WR_CATALOG_ENTRY
      642     6372              INPUT:       CATALOG_ENTRY_KEY.ENTRY#
      643     6373                           CATALOG_ENTRY_KEY.ENTRY_COUNT
      644     6374              OUTPUT:      CATALOG_ENTRY_KEY.ENTRY#
      645     6375                           CATALOG_DATA.ENTRY_COUNT
      646     6376              DESCRIPTION: This procedure is called to save the object deck as
      647     6377                           an entry of the current catalog.
      648     6378        */
      649     6379
      650     6380    3   NC_STORE_CATALOG_ENTRY: PROC ALTRET ;
      651     6381
      652     6382        /* Code */
      653     6383
      654     6384    4      CALL TOU$DFU_TF_WR_CATALOG_ENTRY ALTRET (ERROR) ;
      655     6385    4      CATALOG_ENTRY_KEY.ENTRY# = CATALOG_ENTRY_KEY.ENTRY# + 1;
      656     6386    4      CATALOG_DATA.ENTRY_COUNT = CATALOG_DATA.ENTRY_COUNT + 1;
      657     6387    4      RETURN;
      658     6388
      659     6389    4   ERROR:
      660     6390    4      ALTRETURN ;
      661     6391
      662     6392    4   END NC_STORE_CATALOG_ENTRY;
      663     6393        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:26   
      664     6394        /*I*  NAME:        NC_STORE_SUBCATALOG
      665     6395              AUTHORS:     David M. Augustine
      666     6396                           Scott S. Sheppard
      667     6397              PURPOSE:     Saves Subcatalog
      668     6398              INTERFACE:   TOU$REPLACE
      669     6399                           TOU$DFU_TF_WR_SUBCATALOG
      670     6400              INPUT:       DUP.IFAD.FID
      671     6401                           CATALOG_DATA.DECK#
      672     6402              OUTPUT:      SUBCATALOG_DATA.IFAD_FID
      673     6403                           SUBCATALOG_DATA.IFAD_FN
      674     6404                           SUBCATALOG_KEY.DECK#
      675     6405              DESCRIPTION: This procedure saves the subcatalog information
      676     6406                           (IFAD file identifier and file number) for  the
      677     6407                           current catalog being procesed.
      678     6408        */
      679     6409
      680     6410    3   NC_STORE_SUBCATALOG: PROC ALTRET ;
      681     6411
      682     6412        /* Code */
      683     6413
      684     6414    4      SUBCATALOG_KEY.DECK# = CATALOG_DATA.DECK# ;
      685     6415    4      SUBCATALOG_DATA.IFAD_FID = DUP.IFAD.FID ;
      686     6416    4      SUBCATALOG_DATA.IFAD_FN = '~FM' ;
      687     6417    4      CALL TOU$REPLACE (SUBCATALOG_DATA.IFAD_FN, 3) ;
      688     6418    4      CALL TOU$DFU_TF_WR_SUBCATALOG ALTRET (ERROR) ;
      689     6419    4      RETURN ;
      690     6420
      691     6421    4   ERROR:
      692     6422    4      ALTRETURN ;
      693     6423
      694     6424    4   END NC_STORE_SUBCATALOG ;
      695     6425        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:27   
      696     6426        /*I*  NAME:        NC_STORE_CATALOG
      697     6427              AUTHORS:     David M. Augustine
      698     6428                           Scott S. Sheppard
      699     6429              PURPOSE:     Saves Catalog Information
      700     6430              INTERFACE:   NC_ERR_MSG
      701     6431                           TOU$DFU_TF_WR_MASTER_ENTRY
      702     6432                           TOU$DFU_TF_WR_CATALOG_CONTROL
      703     6433              INPUT:       CATALOG_KEY_SET
      704     6434              OUTPUT:      CATALOG_KEY_SET
      705     6435                           DECK_SAVED
      706     6436              DESCRIPTION: This procedure saves the catalog control record
      707     6437                           in the temporary file.
      708     6438        */
      709     6439
      710     6440    3   NC_STORE_CATALOG: PROC ALTRET ;
      711     6441
      712     6442        /* Code */
      713     6443
      714     6444    4      IF CATALOG_KEY_SET
      715     6445    5      THEN DO ;
      716     6446    5              CALL TOU$DFU_TF_WR_CATALOG_CONTROL ALTRET (ERROR) ;
      717     6447
      718     6448    5              CATALOG_KEY_SET = %FALSE ;
      719     6449    5              DECK_SAVED = %FALSE ;
      720     6450    5              RETURN ;
      721     6451    5           END /* THEN */ ;
      722     6452    5      ELSE DO ;
      723     6453    5              CALL NC_ERR_MSG (%E$BSC_ITR_NO_FIRM) ;
      724     6454    5   ERROR:
      725     6455    5              ALTRETURN ;
      726     6456    5           END /* ELSE */ ;
      727     6457
      728     6458    4   END NC_STORE_CATALOG ;
      729     6459        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:28   
      730     6460        /*I*  NAME:        NC_STORE_MASTER_ENTRY
      731     6461              AUTHORS:     David M. Augustine
      732     6462                           Scott S. Sheppard
      733     6463              PURPOSE:     Saves Catalog as a Master Entry
      734     6464              INTERFACE:   TOU$DFU_TF_WR_MASTER_ENTRY
      735     6465              INPUT:       MASTER_ENTRY_KEY
      736     6466                           MASTER_DATA
      737     6467              OUTPUT:      MASTER_ENTRY_KEY
      738     6468                           MASTER_DATA
      739     6469              DESCRIPTION: This procedure saves the current catalog as an entry
      740     6470                           of the master catalog.
      741     6471        */
      742     6472
      743     6473    3   NC_STORE_MASTER_ENTRY: PROC ALTRET ;
      744     6474
      745     6475        /* Code */
      746     6476
      747     6477    4      MASTER_ENTRY_KEY.ENTRY# = MASTER_ENTRY_KEY.ENTRY# + 1;
      748     6478    4      MASTER_DATA.ENTRY_COUNT = MASTER_DATA.ENTRY_COUNT + 1;
      749     6479    4      CALL TOU$DFU_TF_WR_MASTER_ENTRY ALTRET (ERROR) ;
      750     6480    4      RETURN ;
      751     6481
      752     6482    4   ERROR:
      753     6483    4      ALTRETURN ;
      754     6484
      755     6485    4   END NC_STORE_MASTER_ENTRY ;
      756     6486        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:29   
      757     6487        /*I*  NAME:        NC_STORE_MASTER_CATALOG
      758     6488              AUTHORS:     Dave Augustine
      759     6489                           Scott Sheppard
      760     6490              PURPOSE:     Saves Master Catalog Deck
      761     6491              INTERFACE:   TOU$DFU_TF_WR_MASTER_CONTROL
      762     6492              INPUT:       MASTER_DATA.ENTRY_COUNT
      763     6493              OUTPUT:      No external data altered.
      764     6494              DESCRIPTION: This procedure saves the master catalog in the
      765     6495                           deckfile after the IFAD input source  has been
      766     6496                           processed.
      767     6497        */
      768     6498
      769     6499    3   NC_STORE_MASTER_CATALOG: PROC ALTRET ;
      770     6500
      771     6501        /* Code */
      772     6502
      773     6503    4      CALL TOU$DFU_TF_WR_MASTER_CONTROL ALTRET (ERROR) ;
      774     6504    4      RETURN;
      775     6505
      776     6506    4   ERROR:
      777     6507    4      ALTRETURN ;
      778     6508
      779     6509    4   END NC_STORE_MASTER_CATALOG;
      780     6510        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:30   
      781     6511        /*I*  NAME:        NC_STORE_LAST_DECK#
      782     6512              AUTHOR:      Scott S. Sheppard
      783     6513              PURPOSE:     Saves the Last Deck Number
      784     6514              INTERFACE:   TOU$DFU_TF_WR_LAST_DECK#
      785     6515              INPUT:       LAST.DECK# - set to the next available deck number
      786     6516              OUTPUT:      LAST.DECK# - set to the actual last value used
      787     6517              DESCRIPTION: The last deck number is incremented each time a
      788     6518                           deck is saved. During processing, the last deck
      789     6519                           number represents the next deck number since it
      790     6520                           is  constantly  being  assigned from  and  THEN
      791     6521                           incremented.   When the last deck is saved, the
      792     6522                           last deck number is actually  one  greater than
      793     6523                           the largest deck value stored in the deckfile.
      794     6524        */
      795     6525
      796     6526    3   NC_STORE_LAST_DECK#: PROC ALTRET ;
      797     6527
      798     6528        /* Code */
      799     6529
      800     6530    4      LAST.DECK# = LAST.DECK# - 1 ;
      801     6531    4      CALL TOU$DFU_TF_WR_LAST_DECK# ALTRET (ERROR) ;
      802     6532    4      RETURN ;
      803     6533
      804     6534    4   ERROR:
      805     6535    4      ALTRETURN ;
      806     6536
      807     6537    4   END NC_STORE_LAST_DECK# ;
      808     6538    3   END NC_PROCESS_IFAD ;
      809     6539        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:31   
      810     6540        /*I*  NAME:        NC_PROCESS_TEMP
      811     6541              AUTHOR:      Scott S. Sheppard
      812     6542              PURPOSE:     Processes TEMP Input to Deckfile
      813     6543              INTERFACE:   NC_SAVE_MASTER_CONTROL
      814     6544                           NC_SAVE_MASTER_ENTRY
      815     6545                           NC_SAVE_CATALOG_CONTROL
      816     6546                           NC_SAVE_SUBCATALOG
      817     6547                           NC_SAVE_CATALOG_ENTRY
      818     6548                           NC_SAVE_OBJECT_DECK
      819     6549                           NC_SAVE_LOG
      820     6550                           NC_ADJUST_REFLIST
      821     6551                           NC_SETUP_PRINT
      822     6552                           TOU$B_PRINT_DECK_LINE
      823     6553                           NC_PRINT_ADDED_CATALOG
      824     6554                           NC_SAVE_LAST_DECK#
      825     6555              INPUT:       DEER temporary file - contains catalog records
      826     6556              OUTPUT:      DECKFILE            - catalog copied in
      827     6557              DESCRIPTION: This procedure processes the temporary file. It adds
      828     6558                           in any  object decks  for the catalog  (that are not
      829     6559                           already in the file) and the catalog control inform-
      830     6560                           ation to the deckfile.
      831     6561        */
      832     6562        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:32   
      833     6563    2   NC_PROCESS_TEMP: PROC ALTRET ;
      834     6564
      835     6565        /* Code */
      836     6566
      837     6567    3      DUP.BREAK_DISABLED = %TRUE ;
      838     6568    3      CALL NC_SAVE_MASTER_CONTROL ALTRET (ERROR) ;
      839     6569    3      CALL NC_SAVE_MASTER_ENTRY ALTRET (ERROR) ;
      840     6570    3      CALL TOU$ND_SAVE_CATALOG_CONTROL ALTRET (ERROR) ;
      841     6571    3      CALL NC_SAVE_SUBCATALOG ALTRET (ERROR) ;
      842     6572    3      CATALOG_ENTRY_KEY.DECK# = CATALOG_DATA.DECK# ;
      843     6573    4      DO CATALOG_ENTRY_KEY.ENTRY# = 1 TO CATALOG_DATA.ENTRY_COUNT ;
      844     6574    4         CALL NC_SAVE_CATALOG_ENTRY ALTRET (ERROR) ;
      845     6575    4         CALL TOU$ND_SAVE_OBJECT_DECK ALTRET (ERROR) ;
      846     6576    4         CALL NC_SETUP_PRINT ;
      847     6577    4         CALL TOU$B_PRINT_DECK_LINE ;
      848     6578    4      END /* DO */ ;
      849     6579    3      CALL NC_PRINT_ADDED_CATALOG ;
      850     6580
      851     6581    3      CALL TOU$ND_SAVE_LAST_DECK# ALTRET (ERROR) ;
      852     6582    3      CALL NC_SAVE_LOG ALTRET (ERROR) ;
      853     6583    3      DUP.BREAK_DISABLED = %FALSE ;
      854     6584    3      RETURN ;
      855     6585
      856     6586    3   ERROR:
      857     6587    3      DUP.BREAK_DISABLED = %FALSE ;
      858     6588    3      DUP.DF.CLOSE_TYPE = %DISCARD_FILE ;
      859     6589    3      CALL NC_ERR_MSG (%E$NPT_BAD_DECKFILE) ;
      860     6590    3      ALTRETURN ;
      861     6591
      862     6592        /* END NC_PROCESS_TEMP */
      863     6593        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:33   
      864     6594        /*I*  NAME:        NC_SAVE_MASTER_CONTROL
      865     6595              AUTHOR:      Scott S. Sheppard
      866     6596              PURPOSE:     Saves New Master Control
      867     6597              INTERFACE:   TOU$DFU_TF_RD_MASTER_CONTROL
      868     6598                           TOU$DFU_DF_WR_MASTER_CONTROL
      869     6599              INPUT:       MASTER_DATA
      870     6600              OUTPUT:      MASTER_DATA
      871     6601              DESCRIPTION: This  procedure saves the  new  master control,
      872     6602                           updated to include the new catalog in its entry
      873     6603                           count and checksum, in the deckfile.
      874     6604        */
      875     6605
      876     6606    3   NC_SAVE_MASTER_CONTROL: PROC ALTRET ;
      877     6607
      878     6608        /* Code */
      879     6609
      880     6610    4      CALL TOU$DFU_TF_RD_MASTER_CONTROL ALTRET (ERROR) ;
      881     6611    4      CALL TOU$DFU_DF_WR_MASTER_CONTROL ALTRET (ERROR) ;
      882     6612    4      RETURN ;
      883     6613
      884     6614    4   ERROR:
      885     6615    4      ALTRETURN ;
      886     6616
      887     6617    4   END NC_SAVE_MASTER_CONTROL ;
      888     6618        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:34   
      889     6619        /*I*  NAME:        NC_SAVE_MASTER_ENTRY
      890     6620              AUTHOR:      Scott S. Sheppard
      891     6621              PURPOSE:     Saves Master Entry
      892     6622              INTERFACE:   TOU$DFU_TF_RD_MASTER_ENTRY
      893     6623                           TOU$DFU_DF_WR_MASTER_ENTRY
      894     6624              INPUT:       MASTER_DATA
      895     6625              OUTPUT:      MASTER_ENTRY
      896     6626              DESCRIPTION: This procedure saves the master entry for the
      897     6627                           new catalog.
      898     6628        */
      899     6629
      900     6630    3   NC_SAVE_MASTER_ENTRY: PROC ALTRET ;
      901     6631
      902     6632        /* Code */
      903     6633
      904     6634    4      MASTER_ENTRY_KEY.DECK# = MASTER_DATA.DECK# ;
      905     6635    4      MASTER_ENTRY_KEY.ENTRY# = MASTER_DATA.ENTRY_COUNT ;
      906     6636    4      CALL TOU$DFU_TF_RD_MASTER_ENTRY ALTRET (ERROR) ;
      907     6637    4      CALL TOU$DFU_DF_WR_MASTER_ENTRY ALTRET (ERROR) ;
      908     6638    4      RETURN ;
      909     6639
      910     6640    4   ERROR:
      911     6641    4      ALTRETURN ;
      912     6642
      913     6643    4   END NC_SAVE_MASTER_ENTRY ;
      914     6644        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:35   
      915     6645        /*I*  NAME:        NC_SAVE_SUBCATALOG
      916     6646              AUTHOR:      Scott S. Sheppard
      917     6647              PURPOSE:     Saves Subcatalog
      918     6648              INTERFACE:   TOU$DFU_TF_RD_SUBCATALOG
      919     6649                           TOU$DFU_DF_WR_SUBCATALOG
      920     6650              INPUT:       CATALOG_DATA
      921     6651              OUTPUT:      SUBCATALOG_KEY
      922     6652              DESCRIPTION: This procedure saves the  IFAD file id and file
      923     6653                           number of the new catalog in the subcatalog for
      924     6654                           the new catalog.
      925     6655        */
      926     6656
      927     6657    3   NC_SAVE_SUBCATALOG: PROC ALTRET ;
      928     6658
      929     6659        /* Code */
      930     6660
      931     6661    4      SUBCATALOG_KEY.DECK# = CATALOG_DATA.DECK# ;
      932     6662    4      CALL TOU$DFU_TF_RD_SUBCATALOG ALTRET (ERROR) ;
      933     6663    4      CALL TOU$DFU_DF_WR_SUBCATALOG ALTRET (ERROR) ;
      934     6664    4      RETURN ;
      935     6665
      936     6666    4   ERROR:
      937     6667    4      ALTRETURN ;
      938     6668
      939     6669    4   END NC_SAVE_SUBCATALOG ;
      940     6670        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:36   
      941     6671        /*I*  NAME:        NC_SAVE_CATALOG_ENTRY
      942     6672              AUTHOR:      Scott S. Sheppard
      943     6673              PURPOSE:     Saves Catalog Entry
      944     6674              INTERFACE:   TOU$DFU_TF_RD_CATALOG_ENTRY
      945     6675                           TOU$DFU_DF_WR_CATALOG_ENTRY
      946     6676              INPUT:       CATALOG_ENTRY
      947     6677              OUTPUT:      CATALOG_ENTRY
      948     6678              DESCRIPTION: This procedure save a catalog entry for an object
      949     6679                           deck of the new catalog.
      950     6680        */
      951     6681
      952     6682    3   NC_SAVE_CATALOG_ENTRY: PROC ALTRET ;
      953     6683
      954     6684        /* Code */
      955     6685
      956     6686    4      CALL TOU$DFU_TF_RD_CATALOG_ENTRY ALTRET (ERROR) ;
      957     6687    4      CALL TOU$DFU_DF_WR_CATALOG_ENTRY ALTRET (ERROR) ;
      958     6688    4      RETURN ;
      959     6689
      960     6690    4   ERROR:
      961     6691    4      ALTRETURN ;
      962     6692
      963     6693    4   END NC_SAVE_CATALOG_ENTRY ;
      964     6694        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:37   
      965     6695        /*I*  NAME:        NC_SAVE_LOG
      966     6696              AUTHOR:      Scott S. Sheppard
      967     6697              PURPOSE:     Saves the deckfile history log
      968     6698              INTERFACE:   TOU$DU_UPDATE_LOG
      969     6699                           TOU$DFU_DF_WR_LOG
      970     6700              INPUT:       No system data accessed.
      971     6701              OUTPUT:      DUP.LOG.CATALOG
      972     6702                           DUP.LOG.DECK
      973     6703                           DUP.HOLD_AREA
      974     6704              DESCRIPTION: This procedure stores the deckfile history log.
      975     6705        */
      976     6706
      977     6707    3   NC_SAVE_LOG: PROC ALTRET ;
      978     6708
      979     6709        /* Code */
      980     6710
      981     6711    4      DUP.LOG.TYPE = %T$SF_NEWCAT ;
      982     6712    4      DUP.LOG.CATALOG = CATALOG_KEY.DATA ;
      983     6713    4      DUP.LOG.DECK = ' ' ;
      984     6714    4      DUP.HOLD_AREA = DUP.IFAD.FID ;
      985     6715    4      CALL TOU$DU_UPDATE_LOG ALTRET (ERROR) ;
      986     6716    4      CALL TOU$DFU_DF_WR_LOG ALTRET (ERROR) ;
      987     6717    4      RETURN ;
      988     6718
      989     6719    4   ERROR:
      990     6720    4      ALTRETURN ;
      991     6721
      992     6722    4   END NC_SAVE_LOG ;
      993     6723        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:38   
      994     6724        /*I*  NAME:        NC_SETUP_PRINT
      995     6725              AUTHOR:      Scott S. Sheppard
      996     6726              PURPOSE:     Assign Replacement Variables
      997     6727              INTERFACE:   None Called.
      998     6728              INPUT:       OBJECT.BCD.LIBRARY - used to determine GECALL or not
      999     6729                           OBJECT.BCD.CLASS   - used to determine ITR or MDR
     1000     6730                           BCD_B(BCD#-1)      - $DKEND card saved
     1001     6731                           H$NEWCAT_ITR     T$B_ITR
     1002     6732                           H$NEWCAT_MDR    T$B_MDR
     1003     6733                           H$NEWCAT_PROG   T$B_GECALL
     1004     6734              OUTPUT:      DUP.HDR_CODE  - set to correct heading
     1005     6735                           DUP.MSG_CODE  - used to write messages
     1006     6736                           ID.ID         - set for IDENT CODE field
     1007     6737                           ID.REVISION  - set for REV field
     1008     6738                           BIN#          - used in RECORD LENGTH field
     1009     6739                           DKEND         - $DKEND Card Structure
     1010     6740              DESCRIPTION: This procedure assigns variables needed values so
     1011     6741                           that TOU$REPLACE  will insert proper  values  for
     1012     6742                           the dummy ~strings.
     1013     6743        */
     1014     6744        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:39   
     1015     6745    3   NC_SETUP_PRINT: PROC ;
     1016     6746
     1017     6747        /* Code */
     1018     6748    4      BIN# = OBJECT.BINARY_COUNT ;
     1019     6749
     1020     6750    4      IF OBJECT.BCD.LIBRARY = 'HMPCJ1'
     1021     6751    4      THEN IF OBJECT.BCD.CLASS = 'I' | OBJECT.BCD.CLASS = 'F'
     1022     6752    5         THEN DO ;
     1023     6753    5                 IF OBJECT.BCD.CLASS = 'F'
     1024     6754    5                 THEN ID.ID = SUBSTR (OBJECT_KEY.DATA, 7, 6) ;
     1025     6755    5                 ELSE ID.ID = SUBSTR (OBJECT_KEY.DATA, 4, 6) ;
     1026     6756    5                 DKEND.BCD_ = BCD_B(BCD#-1) ;
     1027     6757    5                 ID.REVISION = DKEND.BCD.REVISION ;
     1028     6758    5                 DUP.HDR_CODE = %H$NEWCAT_ITR ;
     1029     6759    5                 DUP.MSG_CODE = %T$B_ITR ;
     1030     6760    5              END /* THEN */ ;
     1031     6761    5         ELSE DO ;
     1032     6762    5                 ID.ID = SUBSTR (OBJECT_KEY.DATA, 4, 6) ;
     1033     6763    5                 DKEND.BCD_ = BCD_B(BCD#-1) ;
     1034     6764    5                 ID.REVISION = DKEND.BCD.REVISION ;
     1035     6765    5                 DUP.HDR_CODE = %H$NEWCAT_MDR ;
     1036     6766    5                 DUP.MSG_CODE = %T$B_MDR ;
     1037     6767    5              END /* ELSE */ ;
     1038     6768    5      ELSE DO ;
     1039     6769    5              DUP.HDR_CODE = %H$NEWCAT_PROG ;
     1040     6770    5              DUP.MSG_CODE = %T$B_GECALL ;
     1041     6771    5           END /* ELSE */ ;
     1042     6772    4      RETURN ;
     1043     6773
     1044     6774    4   END NC_SETUP_PRINT ;
     1045     6775        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:40   
     1046     6776        /*I*  NAME:        NC_PRINT_ADDED_CATALOG
     1047     6777              AUTHOR:      Scott S. Sheppard
     1048     6778              PURPOSE:     Prints added Catalog line
     1049     6779              INTERFACE:   TOU$DU_USER_WRITE
     1050     6780                           TOU$DU_PRINTER_WRITE
     1051     6781              INPUT:       T$B_CATALOG
     1052     6782                           T$NC_INFORM
     1053     6783              OUTPUT:      DUP.MSG_CODE - integer message number
     1054     6784              DESCRIPTION: This procedure adds the completed catalog message
     1055     6785                           to the edit listing  by calling  TOU$DU_PRINTER_WRITE
     1056     6786                           with the proper message numbers. The catalog info
     1057     6787                           message is also displayed to the user.
     1058     6788        */
     1059     6789
     1060     6790    3   NC_PRINT_ADDED_CATALOG: PROC ;
     1061     6791
     1062     6792        /* Code */
     1063     6793
     1064     6794    4      DUP.MSG_CODE = %T$B_CATALOG ;
     1065     6795    4      CALL TOU$DU_PRINTER_WRITE ;
     1066     6796    4      DUP.MSG_CODE = %T$NC_INFORM ;
     1067     6797    4      CALL TOU$DU_USER_WRITE ;
     1068     6798    4      CALL TOU$DU_PRINTER_WRITE ;
     1069     6799    4      RETURN ;
     1070     6800
     1071     6801    4   END NC_PRINT_ADDED_CATALOG ;
     1072     6802    3   END NC_PROCESS_TEMP ;
     1073     6803    2   END NC_ADD_CATALOG ;
     1074     6804        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:41   
     1075     6805        /*I*  NAME:        NC_ERR_MSG
     1076     6806              AUTHOR:      Scott S. Sheppard
     1077     6807              PURPOSE:     Build Error Message Reporter
     1078     6808              INTERFACE:   TOU$DU_USER_WRITE
     1079     6809              INPUT:       ERR_CODE - error message code
     1080     6810              OUTPUT:      DUP.MSG_CODE - set to appropriate message code
     1081     6811              DESCRIPTION: This procedure sets the error occurred flag to
     1082     6812                           true and reports the error.
     1083     6813        */
     1084     6814
     1085     6815    1   NC_ERR_MSG: PROC (ERR_CODE) ;
     1086     6816
     1087     6817    2      DCL ERR_CODE                   UBIN WORD ALIGNED ;
     1088     6818
     1089     6819        /* Code */
     1090     6820
     1091     6821    2      DUP.MSG_CODE = ERR_CODE ;
     1092     6822    2      CALL TOU$DU_USER_WRITE ;
     1093     6823    2      RETURN ;
     1094     6824
     1095     6825    2   END NC_ERR_MSG ;
     1096     6826    1   END TOU$NEWCAT ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:42   
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   TO_PERR_C.:E05TOU  is referenced.
   TOU_RQSTS_E.:E05TOU  is referenced.
   TOU_DEER_M.:E05TOU  is referenced.
      No diagnostics issued in procedure TOU$NEWCAT.

   Procedure TOU$NEWCAT requires 858 words for executable code.
   Procedure TOU$NEWCAT requires 28 words of local(AUTO) storage.

    No errors detected in file TOU$NEWCAT.:E05TSI    .

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:43   

 Object Unit name= TOU$NEWCAT                                 File name= TOU$NEWCAT.:E05TOU
 UTS= JUL 30 '97 06:47:48.96 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   Data  even  none     6      6  TOU$NEWCAT
    1  RoData even  UTS     14     16  TOU$NEWCAT
    2   Proc  even  none   858   1532  TOU$NEWCAT
    3  RoData even  none    16     20  TOU$NEWCAT

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  TOU$NEWCAT

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    0      0  CATALOG_SEARCH_KEY
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:44   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
 yes     yes           Std       0 TOU$B_SHOW_DCBS
 yes     yes           Std       0 TOU$DU_OPEN_DF
 yes     yes           Std       0 TOU$DU_CLOSE_DF
 yes     yes           Std       0 TOU$DU_USER_WRITE
 yes     yes           Std       0 TOU$DU_SET_IFAD_FID
 yes     yes           Std       0 TOU$DU_SET_DF_FID
 yes     yes           Std       0 TOU$DFU_DF_RD_MASTER_CONTROL
 yes     yes           Std       0 TOU$DFU_DF_RD_LAST_DECK#
 yes     yes           Std       0 TOU$DFU_DF_RD_LOG
 yes     yes           Std       0 TOU$DFU_DF_RD_MASTER_ENTRY
 yes     yes           Std       0 TOU$DU_SET_PROMPT
 yes     yes           Std       0 TOU$DU_SET_EDIT_PROMPT
 yes     yes           Std       0 TOU$DU_USER_READ
 yes     yes           Std       0 TOU$DFU_OPEN_TEMP
 yes     yes           Std       0 TOU$CLEAR_IFAD
 yes     yes           Std       0 TOU$DU_OPEN_IFAD
 yes     yes           Std       0 TOU$DU_CLOSE_IFAD
 yes     yes           Std       0 TOU$DFU_CLOSE_TEMP
 yes     yes           Std       0 TOU$GET_CP6_OBJECT
 yes     yes           Std       0 TOU$B_GET_CATALOG
 yes     yes           Std       0 TOU$B_SET_OBJECT_KEY
 yes     yes           Std       0 TOU$B_CHECK_CORRECT_FILE
 yes     yes           Std       0 TOU$B_SET_CATALOG_KEY
 yes     yes           Std       0 TOU$GET_BINARY_CARDS
 yes     yes           Std       0 TOU$GET_BCD_CARDS
 yes     yes           Std       4 TOU$CHECKSUM
 yes     yes           Std       0 TOU$DFU_TF_WR_BCD_CARDS
 yes     yes           Std       0 TOU$DFU_TF_WR_OBJECT
 yes     yes           Std       0 TOU$DFU_TF_WR_BINARY
 yes     yes           Std       0 TOU$DFU_TF_WR_CATALOG_ENTRY
         yes           Std       2 TOU$REPLACE
 yes     yes           Std       0 TOU$DFU_TF_WR_SUBCATALOG
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:45   
 yes     yes           Std       0 TOU$DFU_TF_WR_CATALOG_CONTROL
 yes     yes           Std       0 TOU$DFU_TF_WR_MASTER_ENTRY
 yes     yes           Std       0 TOU$DFU_TF_WR_MASTER_CONTROL
 yes     yes           Std       0 TOU$DFU_TF_WR_LAST_DECK#
 yes     yes           Std       0 TOU$B_PRINT_DECK_LINE
 yes     yes           Std       0 TOU$ND_SAVE_CATALOG_CONTROL
 yes     yes           Std       0 TOU$ND_SAVE_OBJECT_DECK
 yes     yes           Std       0 TOU$ND_SAVE_LAST_DECK#
 yes     yes           Std       0 TOU$DFU_TF_RD_MASTER_CONTROL
 yes     yes           Std       0 TOU$DFU_DF_WR_MASTER_CONTROL
 yes     yes           Std       0 TOU$DFU_TF_RD_MASTER_ENTRY
 yes     yes           Std       0 TOU$DFU_DF_WR_MASTER_ENTRY
 yes     yes           Std       0 TOU$DFU_TF_RD_SUBCATALOG
 yes     yes           Std       0 TOU$DFU_DF_WR_SUBCATALOG
 yes     yes           Std       0 TOU$DFU_TF_RD_CATALOG_ENTRY
 yes     yes           Std       0 TOU$DFU_DF_WR_CATALOG_ENTRY
 yes     yes           Std       0 TOU$DU_UPDATE_LOG
 yes     yes           Std       0 TOU$DFU_DF_WR_LOG
 yes     yes           Std       0 TOU$DU_PRINTER_WRITE
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_INDEX

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     DUP                                   BCD_CARD                              BCD_KEY
     BINARY_CARD                           BINARY_KEY                            CATALOG_DATA
     CATALOG_ENTRY_KEY                     CATALOG_KEY                           DKEND
     ID                                    LAST                                  MASTER_DATA
     MASTER_ENTRY_KEY                      OBJECT                                OBJECT_KEY
     SUBCATALOG_DATA                       SUBCATALOG_KEY                        BCD#
     BIN#                                  CATALOG_KEY_SET                       DECK_SAVED
     FILE_EOF                              B_VECTNIL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:46   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:47   


        1        1        /*M* TOU$NEWCAT     DEckfile Editor Routine NEW CATALOG Function */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7
        8        8        /*X* PLM=3,DCI=6,SQB=N,PRB=N,DTI=5,ENI=0,AND=Y,ECI=0,CSU=3,DIN=3,
        9        9             CTI=8,CRM=109,CRT=1,NLB=N,NTB=Y,MCL=110 */
       10       10
       11       11        /*P*  NAME:        TOU$NEWCAT
       12       12              AUTHOR:      Scott S. Sheppard
       13       13              PURPOSE:     DEckfile Editor Routine NEW CATALOG Function
       14       14              DESCRIPTION: This program is called when the NEWCAT function
       15       15                           is invoked by the  CP-6 deckfile editor driver.
       16       16                           This program adds a new catalog  to an existing
       17       17                           CP-6 deckfile.
       18       18              REFERENCE:   CP-6 Release C0M0
       19       19              LAST UPDATE: 10/27/83
       20       20        */
       21       21        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:48   
       22       22        /*F*  NAME:        TOU$NEWCAT
       23       23              DESCRIPTION: Procedure Nesting Hierarchy
       24       24
       25       25              TOU$NEWCAT: procedure
       26       26                 NC_INIT_DUP: procedure
       27       27                 NC_COMMAND_SETUP: procedure ALTRET
       28       28                 NC_SETUP_DF: procedure ALTRET
       29       29                 NC_CHECK_FOR_CATALOG: procedure ALTRET
       30       30                    NC_VERIFY_ADDITION: procedure ALTRET
       31       31                 NC_ADD_CATALOG: procedure ALTRET
       32       32                    NC_PROCESS_IFAD: procedure ALTRET
       33       33                       NC_CHECK_MATCH: procedure
       34       34                       NC_STORE_OBJECT_DECK: procedure ALTRET
       35       35                       NC_STORE_CATALOG_ENTRY: procedure ALTRET
       36       36                       NC_STORE_SUBCATALOG: procedure ALTRET
       37       37                       NC_STORE_CATALOG: procedure ALTRET
       38       38                       NC_STORE_MASTER_ENTRY: procedure ALTRET
       39       39                       NC_STORE_MASTER_CATALOG: procedure ALTRET
       40       40                       NC_STORE_LAST_DECK#: procedure ALTRET
       41       41                    NC_PROCESS_TEMP: procedure ALTRET
       42       42                       NC_SAVE_MASTER_CONTROL: procedure ALTRET
       43       43                       NC_SAVE_MASTER_ENTRY: procedure ALTRET
       44       44                       NC_SAVE_SUBCATALOG: procedure ALTRET
       45       45                       NC_SAVE_CATALOG_ENTRY: procedure ALTRET
       46       46                       NC_SAVE_LOG: procedure ALTRET
       47       47                       NC_SETUP_PRINT: procedure
       48       48                       NC_PRINT_ADDED_CATALOG: procedure
       49       49                 NC_ERR_MSG: procedure (ERR_CODE)
       50       50        */
       51       51        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:49   
       52       52        TOU$NEWCAT: PROC ;

     52  2 000000   000000 700200 xent  TOU$NEWCAT   TSX0  ! X66_AUTO_0
         2 000001   000034 000000                    ZERO    28,0

       53       53
       54       54        /* Include Files */
       55       55
       56       56           %INCLUDE TOU_DEER_M ;
       57     1467           %INCLUDE TOU_RQSTS_E ;
       58     1542           %INCLUDE TO_PERR_C ;
       59     2127           %INCLUDE XU_MACRO_C ;
       60     5233
       61     5234        /* Macros */
       62     5235
       63     5236           %DUP (STCLASS = SYMREF) ;
       64     5379           %BCD_B (STCLASS = "BASED (DUP.BCD_V.PTR$)") ;
       65     5391           %BCD_CARD (STCLASS = SYMREF) ;
       66     5411           %BCD_KEY (STCLASS = SYMREF) ;
       67     5425           %BINARY_CARD (STCLASS = SYMREF) ;
       68     5452           %BINARY_KEY (STCLASS = SYMREF) ;
       69     5466           %CATALOG_DATA (STCLASS = SYMREF) ;
       70     5480           %CATALOG_ENTRY_KEY (STCLASS = SYMREF) ;
       71     5494           %CATALOG_KEY (STCLASS = SYMREF) ;
       72     5508           %CATALOG_SEARCH_KEY (STCLASS = "STATIC SYMDEF") ;
       73     5520           %DKEND (STCLASS = SYMREF) ;
       74     5544           %ID (STCLASS = SYMREF) ;
       75     5561           %LAST (STCLASS = SYMREF) ;
       76     5574           %MASTER_DATA (STCLASS = SYMREF) ;
       77     5588           %MASTER_ENTRY_KEY (STCLASS = SYMREF) ;
       78     5602           %OBJECT (STCLASS = SYMREF) ;
       79     5665           %OBJECT_KEY (STCLASS = SYMREF) ;
       80     5678           %RECORD (STCLASS = SYMREF) ;
       81     5705           %SUBCATALOG_DATA (STCLASS = SYMREF) ;
       82     5718           %SUBCATALOG_KEY (STCLASS = SYMREF) ;
       83     5732           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:50   
       84     5733        /* Variables */
       85     5734
       86     5735    1      DCL BCD#             UBIN WORD SYMREF ;
       87     5736    1      DCL BIN#             UBIN WORD SYMREF ;
       88     5737    1      DCL CATALOG_KEY_SET  BIT (1) SYMREF CALIGNED ;
       89     5738    1      DCL DECK_SAVED       BIT (1) SYMREF CALIGNED ;
       90     5739    1      DCL FILE_EOF         UBIN WORD SYMREF ALIGNED;
       91     5740           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:51   
       92     5741        /* External Entry Points */
       93     5742
       94     5743    1      DCL TOU$DU_SET_IFAD_FID            ENTRY ALTRET ;
       95     5744    1      DCL TOU$DU_OPEN_IFAD               ENTRY ALTRET ;
       96     5745    1      DCL TOU$DU_CLOSE_IFAD              ENTRY ALTRET ;
       97     5746
       98     5747    1      DCL TOU$DU_SET_DF_FID              ENTRY ALTRET ;
       99     5748    1      DCL TOU$DU_OPEN_DF                 ENTRY ALTRET ;
      100     5749    1      DCL TOU$DU_CLOSE_DF                ENTRY ALTRET ;
      101     5750
      102     5751    1      DCL TOU$DU_SET_EDIT_PROMPT         ENTRY ALTRET ;
      103     5752    1      DCL TOU$DU_SET_PROMPT              ENTRY ALTRET ;
      104     5753    1      DCL TOU$DU_USER_READ               ENTRY ALTRET ;
      105     5754    1      DCL TOU$DU_USER_WRITE              ENTRY ALTRET ;
      106     5755    1      DCL TOU$DU_PRINTER_WRITE           ENTRY ALTRET ;
      107     5756    1      DCL TOU$DU_UPDATE_LOG              ENTRY ALTRET ;
      108     5757
      109     5758    1      DCL TOU$CHECKSUM                   ENTRY (4) ALTRET ;
      110     5759    1      DCL TOU$CLEAR_IFAD                 ENTRY ALTRET ;
      111     5760    1      DCL TOU$REPLACE                    ENTRY (2) ;
      112     5761
      113     5762    1      DCL TOU$GET_CP6_OBJECT             ENTRY ALTRET ;
      114     5763    1      DCL TOU$GET_BINARY_CARDS           ENTRY ALTRET ;
      115     5764    1      DCL TOU$GET_BCD_CARDS              ENTRY ALTRET ;
      116     5765    1      DCL TOU$B_SHOW_DCBS                ENTRY ALTRET ;
      117     5766    1      DCL TOU$B_GET_CATALOG              ENTRY ALTRET ;
      118     5767    1      DCL TOU$B_SET_CATALOG_KEY          ENTRY ALTRET ;
      119     5768    1      DCL TOU$B_SET_OBJECT_KEY           ENTRY ALTRET ;
      120     5769    1      DCL TOU$B_CHECK_CORRECT_FILE       ENTRY ALTRET ;
      121     5770    1      DCL TOU$B_PRINT_DECK_LINE          ENTRY ALTRET ;
      122     5771    1      DCL TOU$ND_SAVE_CATALOG_CONTROL    ENTRY ALTRET ;
      123     5772    1      DCL TOU$ND_SAVE_OBJECT_DECK        ENTRY ALTRET ;
      124     5773    1      DCL TOU$ND_SAVE_LAST_DECK#         ENTRY ALTRET ;
      125     5774           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:52   
      126     5775        /* External Entry Points */
      127     5776
      128     5777    1      DCL TOU$DFU_DF_RD_MASTER_CONTROL   ENTRY ALTRET ;
      129     5778    1      DCL TOU$DFU_DF_RD_MASTER_ENTRY     ENTRY ALTRET ;
      130     5779    1      DCL TOU$DFU_DF_RD_LAST_DECK#       ENTRY ALTRET ;
      131     5780    1      DCL TOU$DFU_DF_RD_LOG              ENTRY ALTRET ;
      132     5781
      133     5782    1      DCL TOU$DFU_DF_WR_MASTER_CONTROL   ENTRY ALTRET ;
      134     5783    1      DCL TOU$DFU_DF_WR_MASTER_ENTRY     ENTRY ALTRET ;
      135     5784    1      DCL TOU$DFU_DF_WR_SUBCATALOG       ENTRY ALTRET ;
      136     5785    1      DCL TOU$DFU_DF_WR_CATALOG_ENTRY    ENTRY ALTRET ;
      137     5786    1      DCL TOU$DFU_DF_WR_LOG              ENTRY ALTRET ;
      138     5787           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:53   
      139     5788        /* External Entry Points */
      140     5789
      141     5790    1      DCL TOU$DFU_OPEN_TEMP              ENTRY ALTRET ;
      142     5791    1      DCL TOU$DFU_CLOSE_TEMP             ENTRY ALTRET ;
      143     5792
      144     5793    1      DCL TOU$DFU_TF_RD_MASTER_CONTROL   ENTRY ALTRET ;
      145     5794    1      DCL TOU$DFU_TF_RD_MASTER_ENTRY     ENTRY ALTRET ;
      146     5795    1      DCL TOU$DFU_TF_RD_SUBCATALOG       ENTRY ALTRET ;
      147     5796    1      DCL TOU$DFU_TF_RD_CATALOG_ENTRY    ENTRY ALTRET ;
      148     5797
      149     5798    1      DCL TOU$DFU_TF_WR_MASTER_CONTROL   ENTRY ALTRET ;
      150     5799    1      DCL TOU$DFU_TF_WR_MASTER_ENTRY     ENTRY ALTRET ;
      151     5800    1      DCL TOU$DFU_TF_WR_CATALOG_CONTROL  ENTRY ALTRET ;
      152     5801    1      DCL TOU$DFU_TF_WR_SUBCATALOG       ENTRY ALTRET ;
      153     5802    1      DCL TOU$DFU_TF_WR_CATALOG_ENTRY    ENTRY ALTRET ;
      154     5803    1      DCL TOU$DFU_TF_WR_OBJECT           ENTRY ALTRET ;
      155     5804    1      DCL TOU$DFU_TF_WR_BINARY           ENTRY ALTRET ;
      156     5805    1      DCL TOU$DFU_TF_WR_BCD_CARDS        ENTRY ALTRET ;
      157     5806    1      DCL TOU$DFU_TF_WR_LAST_DECK#       ENTRY ALTRET ;
      158     5807           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:54   
      159     5808        /* ********************
      160     5809           ********************
      161     5810           **  Main Program  **
      162     5811           ********************
      163     5812           ******************** */
      164     5813
      165     5814    1      CALL NC_INIT_DUP ;

   5814  2 000002   000044 701000 2                  TSX1    NC_INIT_DUP
         2 000003   000000 011000                    NOP     0

      166     5815    1      CALL NC_COMMAND_SETUP ALTRET (ERROR_RETURN) ;

   5815  2 000004   000070 701000 2                  TSX1    NC_COMMAND_SETUP
         2 000005   000033 702000 2                  TSX2    ERROR_RETURN

      167     5816    1      CALL TOU$B_SHOW_DCBS ;

   5816  2 000006   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000007   000000 701000 xent               TSX1    TOU$B_SHOW_DCBS
         2 000010   000000 011000                    NOP     0

      168     5817
      169     5818    1      CALL TOU$DU_OPEN_DF ALTRET (ERROR_RETURN) ;

   5818  2 000011   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000012   000000 701000 xent               TSX1    TOU$DU_OPEN_DF
         2 000013   000033 702000 2                  TSX2    ERROR_RETURN

      170     5819    1      CALL NC_SETUP_DF ALTRET (ERROR_RETURN) ;

   5819  2 000014   000211 701000 2                  TSX1    NC_SETUP_DF
         2 000015   000033 702000 2                  TSX2    ERROR_RETURN

      171     5820    1      CALL NC_CHECK_FOR_CATALOG ALTRET (ERROR_RETURN) ;

   5820  2 000016   000241 701000 2                  TSX1    NC_CHECK_FOR_CATALOG
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:55   
         2 000017   000033 702000 2                  TSX2    ERROR_RETURN

      172     5821    1      CALL NC_ADD_CATALOG ALTRET (ERROR_RETURN) ;

   5821  2 000020   000515 701000 2                  TSX1    NC_ADD_CATALOG
         2 000021   000033 702000 2                  TSX2    ERROR_RETURN

      173     5822    1      CALL TOU$DU_CLOSE_DF ALTRET (ERROR_RETURN) ;

   5822  2 000022   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000023   000000 701000 xent               TSX1    TOU$DU_CLOSE_DF
         2 000024   000033 702000 2                  TSX2    ERROR_RETURN

      174     5823
      175     5824        /* NORMAL_RETURN: */
      176     5825    1      DUP.MSG_CODE = %T$NC_SUCCESS;

   5825  2 000025   000132 235007                    LDA     90,DL
         2 000026   000020 755000 xsym               STA     DUP+16

      177     5826    1      CALL TOU$DU_USER_WRITE ;

   5826  2 000027   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000030   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 000031   000000 011000                    NOP     0

      178     5827    1      RETURN ;

   5827  2 000032   000000 702200 xent               TSX2  ! X66_ARET

      179     5828
      180     5829    1   ERROR_RETURN:
      181     5830    1      CALL TOU$DU_CLOSE_DF ;

   5830  2 000033   000002 631400 xsym  ERROR_RETURN EPPR1   B_VECTNIL+2
         2 000034   000000 701000 xent               TSX1    TOU$DU_CLOSE_DF
         2 000035   000000 011000                    NOP     0
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:56   

      182     5831    1      DUP.MSG_CODE = %T$NC_FAILURE;

   5831  2 000036   000133 235007                    LDA     91,DL
         2 000037   000020 755000 xsym               STA     DUP+16

      183     5832    1      CALL TOU$DU_USER_WRITE ;

   5832  2 000040   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000041   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 000042   000000 011000                    NOP     0

      184     5833    1      RETURN ;

   5833  2 000043   000000 702200 xent               TSX2  ! X66_ARET

      185     5834
      186     5835        /* ********************
      187     5836           ********************
      188     5837           **  End Of  Main  **
      189     5838           ********************
      190     5839           ******************** */
      191     5840        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:57   
      192     5841        /*I*  NAME:        NC_INIT_DUP
      193     5842              AUTHOR:      Scott S. Sheppard
      194     5843              PURPOSE:     Initilization
      195     5844              INTERFACE:   None called.
      196     5845              INPUT:       H$NEWCAT  - default header code for new catalog
      197     5846                           LINES_PER_PAGE - force new page write
      198     5847                           UPDATE    - deckfile opened for update
      199     5848              OUTPUT:      DUP - Deckfile Utility Parameter
      200     5849                           DECK_SAVED
      201     5850              DESCRIPTION: This procedure initializes variables to
      202     5851                           appropriate starting values.
      203     5852        */
      204     5853
      205     5854    1   NC_INIT_DUP: PROC ;

   5854  2 000044   200004 741300       NC_INIT_DUP  STX1  ! 4,,AUTO

      206     5855
      207     5856        /* Code */
      208     5857
      209     5858    2      DUP.HDR_CODE = %H$NEWCAT ;

   5858  2 000045   001356 235007                    LDA     750,DL
         2 000046   000021 755000 xsym               STA     DUP+17

      210     5859    2      DUP.LINE_VFC = %SKIP_WRITE ;

   5859  2 000047   142000 236003                    LDQ     50176,DU
         2 000050   000026 756000 xsym               STQ     DUP+22

      211     5860    2      DUP.FORCE_NEW_PAGE = %TRUE ;

   5860  2 000051   400000 236003                    LDQ     -131072,DU
         2 000052   000056 756000 xsym               STQ     DUP+46

      212     5861    2      DUP.IFAD.ME_ALLOWED = %FALSE ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:58   
   5861  2 000053   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 000054   000057 356000 xsym               ANSQ    DUP+47

      213     5862    2      DUP.IFAD.ENTERED = %FALSE ;

   5862  2 000055   000000 236000 3                  LDQ     0
         2 000056   000057 356000 xsym               ANSQ    DUP+47

      214     5863    2      DUP.DF.ENTERED = %FALSE ;

   5863  2 000057   000031 236000 xsym               LDQ     B_VECTNIL+25
         2 000060   000104 356000 xsym               ANSQ    DUP+68

      215     5864    2      DUP.DF.OPEN_TYPE = %UPDATE_FILE ;

   5864  2 000061   000001 235007                    LDA     1,DL
         2 000062   000105 755000 xsym               STA     DUP+69

      216     5865    2      DUP.DF.REPORT_ERROR = %TRUE ;

   5865  2 000063   400000 236007                    LDQ     -131072,DL
         2 000064   000104 256000 xsym               ORSQ    DUP+68

      217     5866    2      DUP.DF.CLOSE_TYPE = %SAVE_FILE ;

   5866  2 000065   000106 450000 xsym               STZ     DUP+70

      218     5867    2      DECK_SAVED = %FALSE ;

   5867  2 000066   000000 450000 xsym               STZ     DECK_SAVED

      219     5868    2      RETURN ;

   5868  2 000067   000001 702211                    TSX2  ! 1,X1

      220     5869
      221     5870    2   END NC_INIT_DUP ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:59   
      222     5871        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:60   
      223     5872        /*I*  NAME:        NC_COMMAND_SETUP
      224     5873              AUTHOR:      Scott S. Sheppard
      225     5874              PURPOSE:     Sets up NEWCAT Command
      226     5875              INTERFACE:   TOU$DU_SET_IFAD_FID
      227     5876                           TOU$DU_SET_DF_FID
      228     5877              INPUT:       DUP.CMD$ - pointer to the parse control block
      229     5878              OUTPUT:      DUP.DF.HOLD_AREA
      230     5879                           DUP.DF.HOLD_AREA_LGTH
      231     5880                           DUP.IFAD.ENTERED
      232     5881                           DUP.DF.ENTERED
      233     5882                           CATALOG_SEARCH_KEY.DATA
      234     5883              DESCRIPTION: This procedure sets up the NEWCAT command from the
      235     5884                           information entered by the user.     DUP.CMD$ is a
      236     5885                           pointer to a   parse control block  that  contains
      237     5886                           the tokens entered by the user.
      238     5887                           Command Forms:
      239     5888              Case 1: NC <catalog key>
      240     5889              Case 2: NC <ifad fid> <catalog key>
      241     5890              Case 3: NC <catalog key> INTO <deckfile fid>
      242     5891              Case 4: NC <ifad fid> <catalog key> INTO <deckfile fid>
      243     5892        */
      244     5893
      245     5894    1   NC_COMMAND_SETUP: PROC ALTRET ;

   5894  2 000070   200004 741300       NC_COMMAND_* STX1  ! 4,,AUTO

      246     5895
      247     5896    2      DCL OUTBLK#                    UBIN WORD ALIGNED ;
      248     5897    2      DCL OUTBLK$                    PTR ALIGNED ;
      249     5898           %PARSE$OUT (STCLASS = BASED) ;
      250     5943           %PARSE$SYM (STCLASS = BASED) ;
      251     5981           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:61   
      252     5982        /* Code */
      253     5983
      254     5984    3      DO OUTBLK# = 0 TO DUP.CMD$ -> OUT$BLK.NSUBLKS - 1 ;

   5984  2 000071   200005 450100                    STZ     OUTBLK#,,AUTO
         2 000072   000164 710000 2                  TRA     s:6000+3

      255     5985    3         OUTBLK$ = DUP.CMD$ -> OUT$BLK.SUBLK$(OUTBLK#) ;

   5985  2 000073   000017 470400 xsym               LDP0    DUP+15
         2 000074   200005 720100                    LXL0    OUTBLK#,,AUTO
         2 000075   000003 236110                    LDQ     3,X0,PR0
         2 000076   200006 756100                    STQ     OUTBLK$,,AUTO

      256     5986    4         DO CASE (OUTBLK$ -> OUT$BLK.CODE) ;

   5986  2 000077   200006 471500                    LDP1    OUTBLK$,,AUTO
         2 000100   100000 721100                    LXL1    0,,PR1
         2 000101   000011 101003                    CMPX1   9,DU
         2 000102   000104 602011 2                  TNC     s:5986+5,X1
         2 000103   000161 710000 2                  TRA     s:6000
         2 000104   000161 710000 2                  TRA     s:6000
         2 000105   000115 710000 2                  TRA     s:5988
         2 000106   000161 710000 2                  TRA     s:6000
         2 000107   000161 710000 2                  TRA     s:6000
         2 000110   000143 710000 2                  TRA     s:5995
         2 000111   000161 710000 2                  TRA     s:6000
         2 000112   000161 710000 2                  TRA     s:6000
         2 000113   000161 710000 2                  TRA     s:6000
         2 000114   000134 710000 2                  TRA     s:5993

      257     5987    4            CASE (%IFAD_FID) ;

      258     5988    4               DUP.IFAD.ENTERED = %TRUE ;

   5988  2 000115   000400 236003                    LDQ     256,DU
         2 000116   000057 256000 xsym               ORSQ    DUP+47
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:62   

      259     5989    4               DUP.HOLD_AREA = OUTBLK$ -> OUT$SYM.TEXT ;

   5989  2 000117   100004 236100                    LDQ     4,,PR1
         2 000120   000033 772000                    QRL     27
         2 000121   000000 621006                    EAX1    0,QL
         2 000122   040000 100540                    MLR     fill='040'O
         2 000123   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000124   000142 000050 xsym               ADSC9   DUP+98                   cn=0,n=40

      260     5990    4               DUP.HOLD_AREA_LGTH = OUTBLK$ -> OUT$SYM.COUNT ;

   5990  2 000125   100004 236100                    LDQ     4,,PR1
         2 000126   000033 772000                    QRL     27
         2 000127   000154 756000 xsym               STQ     DUP+108

      261     5991    4               CALL TOU$DU_SET_IFAD_FID ALTRET (ERROR) ;

   5991  2 000130   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000131   000000 701000 xent               TSX1    TOU$DU_SET_IFAD_FID
         2 000132   000207 702000 2                  TSX2    ERROR
         2 000133   000161 710000 2                  TRA     s:6000

      262     5992    4            CASE (%CATKEY) ;

      263     5993    4               CATALOG_SEARCH_KEY.DATA = OUTBLK$ -> OUT$SYM.TEXT ;

   5993  2 000134   100004 236100                    LDQ     4,,PR1
         2 000135   000033 772000                    QRL     27
         2 000136   000000 622006                    EAX2    0,QL
         2 000137   040000 100540                    MLR     fill='040'O
         2 000140   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000141   000000 000025 0                  ADSC9   CATALOG_SEARCH_KEY       cn=0,n=21
         2 000142   000161 710000 2                  TRA     s:6000

      264     5994    4            CASE (%DECKFILE_FID) ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:63   
      265     5995    4               DUP.DF.ENTERED = %TRUE ;

   5995  2 000143   400000 236003                    LDQ     -131072,DU
         2 000144   000104 256000 xsym               ORSQ    DUP+68

      266     5996    4               DUP.HOLD_AREA = OUTBLK$ -> OUT$SYM.TEXT ;

   5996  2 000145   100004 236100                    LDQ     4,,PR1
         2 000146   000033 772000                    QRL     27
         2 000147   000000 621006                    EAX1    0,QL
         2 000150   040000 100540                    MLR     fill='040'O
         2 000151   100004 200011                    ADSC9   4,,PR1                   cn=1,n=*X1
         2 000152   000142 000050 xsym               ADSC9   DUP+98                   cn=0,n=40

      267     5997    4               DUP.HOLD_AREA_LGTH = OUTBLK$ -> OUT$SYM.COUNT ;

   5997  2 000153   100004 236100                    LDQ     4,,PR1
         2 000154   000033 772000                    QRL     27
         2 000155   000154 756000 xsym               STQ     DUP+108

      268     5998    4               CALL TOU$DU_SET_DF_FID ALTRET (ERROR) ;

   5998  2 000156   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000157   000000 701000 xent               TSX1    TOU$DU_SET_DF_FID
         2 000160   000207 702000 2                  TSX2    ERROR

      269     5999    4         END /* CASE */ ;

      270     6000    3      END /* DO */ ;

   6000  2 000161   200005 235100                    LDA     OUTBLK#,,AUTO
         2 000162   000001 035007                    ADLA    1,DL
         2 000163   200005 755100                    STA     OUTBLK#,,AUTO
         2 000164   000017 470400 xsym               LDP0    DUP+15
         2 000165   000001 236100                    LDQ     1,,PR0
         2 000166   000022 772000                    QRL     18
         2 000167   200005 116100                    CMPQ    OUTBLK#,,AUTO
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:64   
         2 000170   000172 600000 2                  TZE     s:6002
         2 000171   000073 603000 2                  TRC     s:5985

      271     6001
      272     6002    2      IF DUP.IFAD.ENTERED

   6002  2 000172   000057 236000 xsym               LDQ     DUP+47
         2 000173   000400 316003                    CANQ    256,DU
         2 000174   000200 601000 2                  TNZ     s:6005

      273     6003    2      THEN /* FID set from DEER command */ ;
      274     6004    2      ELSE CALL TOU$DU_SET_IFAD_FID ALTRET (ERROR) ;

   6004  2 000175   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000176   000000 701000 xent               TSX1    TOU$DU_SET_IFAD_FID
         2 000177   000207 702000 2                  TSX2    ERROR

      275     6005    2      IF DUP.DF.ENTERED

   6005  2 000200   000104 234000 xsym               SZN     DUP+68
         2 000201   000205 604000 2                  TMI     s:6008

      276     6006    2      THEN /* FID set from DEER command */ ;
      277     6007    2      ELSE CALL TOU$DU_SET_DF_FID ALTRET (ERROR) ;

   6007  2 000202   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000203   000000 701000 xent               TSX1    TOU$DU_SET_DF_FID
         2 000204   000207 702000 2                  TSX2    ERROR

      278     6008    2      RETURN ;

   6008  2 000205   200004 221300                    LDX1  ! 4,,AUTO
         2 000206   000001 702211                    TSX2  ! 1,X1

      279     6009
      280     6010    2   ERROR:
      281     6011    2      ALTRETURN ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:65   

   6011  2 000207   200004 221300       ERROR        LDX1  ! 4,,AUTO
         2 000210   000000 702211                    TSX2  ! 0,X1

      282     6012
      283     6013    2   END NC_COMMAND_SETUP ;
      284     6014        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:66   
      285     6015        /*I*  NAME:        NC_SETUP_DF
      286     6016              AUTHOR:      Scott S. Sheppard
      287     6017              PURPOSE:     Initilization
      288     6018              INTERFACE:   TOU$DFU_DF_RD_CATALOG_CONTROL
      289     6019                           TOU$DFU_DF_RD_LAST_DECK#
      290     6020                           TOU$DFU_DF_RD_LOG
      291     6021              INPUT:       MASTER_DATA
      292     6022              OUTPUT:      MASTER_DATA
      293     6023                           MASTER_ENTRY
      294     6024                           LAST.DECK#
      295     6025              DESCRIPTION: This procedure initializes variables for the
      296     6026                           deckfile by reading them from the deckfile.
      297     6027        */
      298     6028
      299     6029    1   NC_SETUP_DF: PROC ALTRET ;

   6029  2 000211   200010 741300       NC_SETUP_DF  STX1  ! MATCHING_CATALOG+1,,AUTO

      300     6030
      301     6031        /* Code */
      302     6032
      303     6033    2      CALL TOU$DFU_DF_RD_MASTER_CONTROL ALTRET (ERROR) ;

   6033  2 000212   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000213   000000 701000 xent               TSX1    TOU$DFU_DF_RD_MASTER_CONTROL
         2 000214   000237 702000 2                  TSX2    ERROR

      304     6034    2      MASTER_ENTRY_KEY.DECK# = MASTER_DATA.DECK# ;

   6034  2 000215   000000 236000 xsym               LDQ     MASTER_DATA
         2 000216   000011 772000                    QRL     9
         2 000217   000000 552030 xsym               STBQ    MASTER_ENTRY_KEY,'30'O

      305     6035    2      MASTER_ENTRY_KEY.ENTRY# = MASTER_DATA.ENTRY_COUNT ;

   6035  2 000220   000000 100400                    MLR     fill='000'O
         2 000221   000000 400002 xsym               ADSC9   MASTER_DATA              cn=2,n=2
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:67   
         2 000222   000000 600002 xsym               ADSC9   MASTER_ENTRY_KEY         cn=3,n=2

      306     6036    2      CALL TOU$DFU_DF_RD_LAST_DECK# ALTRET (ERROR) ;

   6036  2 000223   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000224   000000 701000 xent               TSX1    TOU$DFU_DF_RD_LAST_DECK#
         2 000225   000237 702000 2                  TSX2    ERROR

      307     6037    2      LAST.DECK# = LAST.DECK# + 1 ;

   6037  2 000226   000000 220000 xsym               LDX0    LAST
         2 000227   000001 621010                    EAX1    1,X0
         2 000230   000000 741000 xsym               STX1    LAST

      308     6038    2      CATALOG_KEY_SET = %FALSE ;

   6038  2 000231   000000 450000 xsym               STZ     CATALOG_KEY_SET

      309     6039    2      CALL TOU$DFU_DF_RD_LOG ALTRET (ERROR) ;

   6039  2 000232   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000233   000000 701000 xent               TSX1    TOU$DFU_DF_RD_LOG
         2 000234   000237 702000 2                  TSX2    ERROR

      310     6040    2      RETURN ;

   6040  2 000235   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 000236   000001 702211                    TSX2  ! 1,X1

      311     6041
      312     6042    2   ERROR:
      313     6043    2      ALTRETURN ;

   6043  2 000237   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 000240   000000 702211                    TSX2  ! 0,X1

      314     6044
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:68   
      315     6045    2   END NC_SETUP_DF ;
      316     6046        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:69   
      317     6047        /*I*  NAME:        NC_CHECK_FOR_CATALOG
      318     6048              AUTHOR:      Scott S. Sheppard
      319     6049              PURPOSE:     Catalog Existance Checking
      320     6050              INTERFACE:   TOU$DFU_DF_RD_MASTER_ENTRY
      321     6051                           NC_VERIFY_ADDITION
      322     6052              INPUT:       MASTER_ENTRY
      323     6053                           MASTER_DATA
      324     6054                           CATALOG_KEY
      325     6055                           CATALOG_SEARCH_KEY
      326     6056                           TOU$DU_USER_WRITE
      327     6057              OUTPUT:      MASTER_ENTRY_KEY.ENTRY#
      328     6058              DESCRIPTION: This procedure checks the deckfile to determine if
      329     6059                           a catalog already exists in the deckfile  with the
      330     6060                           same key value as the one specified. If no catalog
      331     6061                           exists,  the new one  may be added.   If a catalog
      332     6062                           exists,  and it's  an  ITR catalog,  the  user  is
      333     6063                           prompted to determine if another catalog should be
      334     6064                           added to the deckfile.
      335     6065        */
      336     6066        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:70   
      337     6067    1   NC_CHECK_FOR_CATALOG: PROC ALTRET ;

   6067  2 000241   200004 741300       NC_CHECK_FO* STX1  ! 4,,AUTO

      338     6068
      339     6069    2      DCL FOUND                      BIT (1) CALIGNED ;
      340     6070    2      DCL ITR_INX                    UBIN WORD ALIGNED ;
      341     6071
      342     6072        /* Code */
      343     6073
      344     6074    2      FOUND = %FALSE ;

   6074  2 000242   200005 450100                    STZ     FOUND,,AUTO

      345     6075    2      MASTER_ENTRY_KEY.ENTRY# = 1 ;

   6075  2 000243   000000 101400                    MRL     fill='000'O
         2 000244   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         2 000245   000000 600002 xsym               ADSC9   MASTER_ENTRY_KEY         cn=3,n=2

      346     6076    3      DO UNTIL (FOUND OR MASTER_ENTRY_KEY.ENTRY# > MASTER_DATA.ENTRY_COUNT) ;

      347     6077    3         CALL TOU$DFU_DF_RD_MASTER_ENTRY ALTRET (ERROR) ;

   6077  2 000246   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000247   000000 701000 xent               TSX1    TOU$DFU_DF_RD_MASTER_ENTRY
         2 000250   000327 702000 2                  TSX2    ERROR

      348     6078    3         IF CATALOG_KEY.DATA = CATALOG_SEARCH_KEY.DATA

   6078  2 000251   040000 106400                    CMPC    fill='040'O
         2 000252   000000 200025 xsym               ADSC9   CATALOG_KEY              cn=1,n=21
         2 000253   000000 000025 0                  ADSC9   CATALOG_SEARCH_KEY       cn=0,n=21
         2 000254   000260 601000 2                  TNZ     s:6080

      349     6079    3         THEN FOUND = %TRUE ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:71   
   6079  2 000255   400000 236003                    LDQ     -131072,DU
         2 000256   200005 756100                    STQ     FOUND,,AUTO
         2 000257   000271 710000 2                  TRA     s:6081

      350     6080    3         ELSE MASTER_ENTRY_KEY.ENTRY# = MASTER_ENTRY_KEY.ENTRY# + 1 ;

   6080  2 000260   000000 235000 xsym               LDA     MASTER_ENTRY_KEY
         2 000261   000001 236000 xsym               LDQ     MASTER_ENTRY_KEY+1
         2 000262   000033 773000                    LRL     27
         2 000263   777777 376007                    ANQ     -1,DL
         2 000264   000001 036007                    ADLQ    1,DL
         2 000265   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 000266   000000 101500                    MRL     fill='000'O
         2 000267   200026 000004                    ADSC9   VALID_RESPONSE+1,,AUTO   cn=0,n=4
         2 000270   000000 600002 xsym               ADSC9   MASTER_ENTRY_KEY         cn=3,n=2

      351     6081    3      END /* UNTIL */ ;

   6081  2 000271   200005 234100                    SZN     FOUND,,AUTO
         2 000272   000304 604000 2                  TMI     s:6083
         2 000273   000000 235000 xsym               LDA     MASTER_ENTRY_KEY
         2 000274   000001 236000 xsym               LDQ     MASTER_ENTRY_KEY+1
         2 000275   000033 773000                    LRL     27
         2 000276   777777 376007                    ANQ     -1,DL
         2 000277   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 000300   000000 236000 xsym               LDQ     MASTER_DATA
         2 000301   777777 376007                    ANQ     -1,DL
         2 000302   200026 116100                    CMPQ    VALID_RESPONSE+1,,AUTO
         2 000303   000246 605000 2                  TPL     s:6077

      352     6082
      353     6083    2      IF FOUND

   6083  2 000304   200005 234100                    SZN     FOUND,,AUTO
         2 000305   000331 605000 2                  TPL     STILL_DO_IT

      354     6084    3      THEN DO ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:72   

      355     6085    3              DUP.MSG_CODE = %E$NCFC_ALREADY_IN ;

   6085  2 000306   000670 235007                    LDA     440,DL
         2 000307   000020 755000 xsym               STA     DUP+16

      356     6086    3              CALL TOU$DU_USER_WRITE ;

   6086  2 000310   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000311   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 000312   000000 011000                    NOP     0

      357     6087    3              CALL INDEX (ITR_INX, 'ITR', CATALOG_KEY.DATA, 0) ALTRET (ERROR) ;

   6087  2 000313   200006 631500                    EPPR1   ITR_INX,,AUTO
         2 000314   000000 633400 1                  EPPR3   0
         2 000315   000003 223003                    LDX3    3,DU
         2 000316   000000 630400 xsym               EPPR0   CATALOG_KEY
         2 000317   000001 220003                    LDX0    1,DU
         2 000320   000000 500510                    A9BD    0,X0,PR0
         2 000321   000025 220003                    LDX0    21,DU
         2 000322   000000 236003                    LDQ     0,DU
         2 000323   000000 701000 xent               TSX1    X66_INDEX
         2 000324   000327 710000 2                  TRA     ERROR

      358     6088    3              CALL NC_VERIFY_ADDITION ALTRET (STILL_DO_IT) ;

   6088  2 000325   000333 701000 2                  TSX1    NC_VERIFY_ADDITION
         2 000326   000331 702000 2                  TSX2    STILL_DO_IT

      359     6089    3   ERROR:
      360     6090    3              ALTRETURN ;

   6090  2 000327   200004 221300       ERROR        LDX1  ! 4,,AUTO
         2 000330   000000 702211                    TSX2  ! 0,X1

      361     6091    3           END /* THEN */ ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:73   
      362     6092    3      ELSE DO ;

      363     6093    3   STILL_DO_IT:
      364     6094    3              RETURN ;

   6094  2 000331   200004 221300       STILL_DO_IT  LDX1  ! 4,,AUTO
         2 000332   000001 702211                    TSX2  ! 1,X1

      365     6095    3           END /* ELSE */ ;
      366     6096
      367     6097        /* END NC_CHECK_FOR_CATALOG */
      368     6098        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:74   
      369     6099        /*I*  NAME:        NC_VERIFY_ADDITION
      370     6100              AUTHOR:      Scott S. Sheppard
      371     6101              PURPOSE:     Catalog Addition Verification
      372     6102              INTERFACE:   TOU$DU_SET_PROMPT
      373     6103                           TOU$DU_USER_READ
      374     6104                           TOU$DU_SET_EDIT_PROMPT
      375     6105              INPUT:       DUP.COMMAND
      376     6106                           CATALOG_SEARCH_KEY.DATA
      377     6107              OUTPUT:      DUP.MSG_CODE
      378     6108                           DUP.HOLD_AREA
      379     6109                           DUP.HOLD_AREA_LGTH
      380     6110              DESCRIPTION: This procedure prompts the user to determine if
      381     6111                           the catalog should actually be added.
      382     6112        */
      383     6113
      384     6114    2   NC_VERIFY_ADDITION: PROC ALTRET ;

   6114  2 000333   200010 741300       NC_VERIFY_A* STX1  ! MATCHING_CATALOG+1,,AUTO

      385     6115
      386     6116    3      DCL RESPONSE_ CHAR (40) CALIGNED ;
      387     6117    3      DCL RESPONSE  (0:39) REDEF RESPONSE_ CHAR (1) CALIGNED ;
      388     6118    3      DCL CHR_INX   UBIN WORD ALIGNED ;
      389     6119    3      DCL BL_INX    UBIN WORD ALIGNED ;
      390     6120    3      DCL VALID_RESPONSE BIT (1) ;
      391     6121
      392     6122        /* Code */
      393     6123
      394     6124           /* Inform that another may be added. */
      395     6125    3      DUP.MSG_CODE = %E$NVA_MAY_ADD ;

   6125  2 000334   000671 235007                    LDA     441,DL
         2 000335   000020 755000 xsym               STA     DUP+16

      396     6126    3      CALL TOU$DU_USER_WRITE ;

   6126  2 000336   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:75   
         2 000337   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 000340   000000 011000                    NOP     0

      397     6127
      398     6128           /* Set prompt to ask question */
      399     6129    3      DUP.HOLD_AREA = 'Still wish to add catalog: ' ;

   6129  2 000341   040000 100400                    MLR     fill='040'O
         2 000342   000001 000033 1                  ADSC9   1                        cn=0,n=27
         2 000343   000142 000050 xsym               ADSC9   DUP+98                   cn=0,n=40

      400     6130    3      DUP.HOLD_AREA_LGTH = 27 ;

   6130  2 000344   000033 235007                    LDA     27,DL
         2 000345   000154 755000 xsym               STA     DUP+108

      401     6131    3      CALL TOU$DU_SET_PROMPT ;

   6131  2 000346   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000347   000000 701000 xent               TSX1    TOU$DU_SET_PROMPT
         2 000350   000000 011000                    NOP     0

      402     6132           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:76   
      403     6133    4      DO UNTIL VALID_RESPONSE ;

      404     6134    4         DUP.RESPONSE_LGTH = 3 ;

   6134  2 000351   000003 235007                    LDA     3,DL
         2 000352   000016 755000 xsym               STA     DUP+14

      405     6135    4         CALL TOU$DU_USER_READ ;

   6135  2 000353   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000354   000000 701000 xent               TSX1    TOU$DU_USER_READ
         2 000355   000000 011000                    NOP     0

      406     6136    4         RESPONSE_ = DUP.RESPONSE ;

   6136  2 000356   040100 100400                    MLR     fill='040'O
         2 000357   000004 000050 xsym               ADSC9   DUP+4                    cn=0,n=40
         2 000360   200011 000050                    ADSC9   RESPONSE_,,AUTO          cn=0,n=40

      407     6137
      408     6138              /* Skip leading spaces */
      409     6139    4         CHR_INX = 0 ;

   6139  2 000361   200023 450100                    STZ     CHR_INX,,AUTO

      410     6140    5         DO WHILE RESPONSE(CHR_INX) = ' ' & CHR_INX < 40 ;

   6140  2 000362   000366 710000 2                  TRA     s:6142

      411     6141    5            CHR_INX = CHR_INX + 1 ;

   6141  2 000363   200023 235100                    LDA     CHR_INX,,AUTO
         2 000364   000001 035007                    ADLA    1,DL
         2 000365   200023 755100                    STA     CHR_INX,,AUTO

      412     6142    5         END /* WHILE */ ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:77   
   6142  2 000366   400000 220003                    LDX0    -131072,DU
         2 000367   200023 235100                    LDA     CHR_INX,,AUTO
         2 000370   040000 106505                    CMPC    fill='040'O
         2 000371   200011 000001                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=1
         2 000372   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000373   000375 600000 2                  TZE     s:6142+7
         2 000374   000000 220003                    LDX0    0,DU
         2 000375   400000 221003                    LDX1    -131072,DU
         2 000376   000050 115007                    CMPA    40,DL
         2 000377   000401 602000 2                  TNC     s:6142+11
         2 000400   000000 221003                    LDX1    0,DU
         2 000401   000000 636011                    EAQ     0,X1
         2 000402   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 000403   000000 636010                    EAQ     0,X0
         2 000404   200026 376100                    ANQ     VALID_RESPONSE+1,,AUTO
         2 000405   000363 601000 2                  TNZ     s:6141

      413     6143
      414     6144              /* Find first blank following first non-blank */
      415     6145    4         CALL INDEX (BL_INX, ' ', RESPONSE_, CHR_INX) ;

   6145  2 000406   777727 620005                    EAX0    -41,AL
         2 000407   777777 660003                    ERX0    -1,DU
         2 000410   200023 236100                    LDQ     CHR_INX,,AUTO
         2 000411   000000 124545                    SCM     mask='000'O
         2 000412   200011 000010                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X0
         2 000413   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000414   200024 000100                    ARG     BL_INX,,AUTO
         2 000415   200024 056100                    ASQ     BL_INX,,AUTO

      416     6146
      417     6147              /* Check Response for Yes or No */
      418     6148    5         DO SELECT (SUBSTR (RESPONSE_, CHR_INX, BL_INX - CHR_INX)) ;

   6148  2 000416   200024 236100                    LDQ     BL_INX,,AUTO
         2 000417   200023 136100                    SBLQ    CHR_INX,,AUTO
         2 000420   000000 621006                    EAX1    0,QL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:78   
         2 000421   040000 106545                    CMPC    fill='040'O
         2 000422   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000423   000010 000002 1                  ADSC9   8                        cn=0,n=2
         2 000424   000440 602000 2                  TNC     s:6148+18
         2 000425   000000 621006                    EAX1    0,QL
         2 000426   040000 106545                    CMPC    fill='040'O
         2 000427   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000430   000010 000002 1                  ADSC9   8                        cn=0,n=2
         2 000431   000466 600000 2                  TZE     s:6150
         2 000432   000000 621006                    EAX1    0,QL
         2 000433   040000 106545                    CMPC    fill='040'O
         2 000434   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000435   000011 000003 1                  ADSC9   9                        cn=0,n=3
         2 000436   000471 601000 2                  TNZ     s:6152
         2 000437   000466 710000 2                  TRA     s:6150
         2 000440   000000 621006                    EAX1    0,QL
         2 000441   040000 106545                    CMPC    fill='040'O
         2 000442   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000443   000012 000002 1                  ADSC9   10                       cn=0,n=2
         2 000444   000460 602000 2                  TNC     s:6148+34
         2 000445   000000 621006                    EAX1    0,QL
         2 000446   040000 106545                    CMPC    fill='040'O
         2 000447   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000450   000012 000002 1                  ADSC9   10                       cn=0,n=2
         2 000451   000466 600000 2                  TZE     s:6150
         2 000452   000000 621006                    EAX1    0,QL
         2 000453   040000 106545                    CMPC    fill='040'O
         2 000454   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000455   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000456   000471 601000 2                  TNZ     s:6152
         2 000457   000466 710000 2                  TRA     s:6150
         2 000460   000000 621006                    EAX1    0,QL
         2 000461   040000 106545                    CMPC    fill='040'O
         2 000462   200011 000011                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=*X1
         2 000463   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000464   000471 601000 2                  TNZ     s:6152
         2 000465   000466 710000 2                  TRA     s:6150
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:79   

      419     6149    5            SELECT ('Y', 'YE', 'YES', 'N', 'NO') ;

      420     6150    5            VALID_RESPONSE = %TRUE ;

   6150  2 000466   400000 236003                    LDQ     -131072,DU
         2 000467   200025 756100                    STQ     VALID_RESPONSE,,AUTO
         2 000470   000477 710000 2                  TRA     s:6156

      421     6151    5            SELECT (ELSE) ;

      422     6152    5         VALID_RESPONSE = %FALSE ;

   6152  2 000471   200025 450100                    STZ     VALID_RESPONSE,,AUTO

      423     6153    5         DUP.MSG_CODE = %E$NVA_INVALID_REPLY ;

   6153  2 000472   000672 236007                    LDQ     442,DL
         2 000473   000020 756000 xsym               STQ     DUP+16

      424     6154    5         CALL TOU$DU_USER_WRITE ;

   6154  2 000474   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000475   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 000476   000000 011000                    NOP     0

      425     6155    5         END /* SELECT */ ;

      426     6156    4      END /* UNTIL */ ;

   6156  2 000477   200025 234100                    SZN     VALID_RESPONSE,,AUTO
         2 000500   000351 605000 2                  TPL     s:6134

      427     6157
      428     6158           /* Put PROMPT back to normal. */
      429     6159    3      CALL TOU$DU_SET_EDIT_PROMPT ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:80   
   6159  2 000501   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000502   000000 701000 xent               TSX1    TOU$DU_SET_EDIT_PROMPT
         2 000503   000000 011000                    NOP     0

      430     6160
      431     6161           /* If affirmative then take alternate return */
      432     6162    3      IF RESPONSE(CHR_INX) = 'Y'

   6162  2 000504   200023 235100                    LDA     CHR_INX,,AUTO
         2 000505   040000 106505                    CMPC    fill='040'O
         2 000506   200011 000001                    ADSC9   RESPONSE_,A,AUTO         cn=0,n=1
         2 000507   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000510   000513 601000 2                  TNZ     s:6164

      433     6163    3      THEN ALTRETURN ;

   6163  2 000511   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 000512   000000 702211                    TSX2  ! 0,X1

      434     6164    3      ELSE RETURN ;

   6164  2 000513   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 000514   000001 702211                    TSX2  ! 1,X1

      435     6165
      436     6166    3   END NC_VERIFY_ADDITION ;
      437     6167    2   END NC_CHECK_FOR_CATALOG ;
      438     6168        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:81   
      439     6169        /*I*  NAME:        NC_ADD_CATALOG
      440     6170              AUTHOR:      Scott S. Sheppard
      441     6171              PURPOSE:     Adds the Catalog to the Deckfile
      442     6172              INTERFACE:   TOU$DFU_OPEN_TEMP
      443     6173                           TOU$DFU_CLOSE_TEMP
      444     6174                           TOU$DU_OPEN_IFAD
      445     6175                           TOU$CLEAR_IFAD
      446     6176                           TOU$DU_CLOSE_IFAD
      447     6177                           TOU$DU_USER_WRITE
      448     6178                           NC_PROCESS_IFAD
      449     6179                           NC_PROCESS_TEMP
      450     6180              INPUT:       IFAD input source
      451     6181                           DEER temporary file
      452     6182              OUTPUT:      DEER temporary file
      453     6183                           Deckfile - catalog added
      454     6184              DESCRIPTION: This procedure processes the IFAD input source
      455     6185                           to the temporary file.   If no errors occurred
      456     6186                           the temporary file, which contains the updates
      457     6187                           to be made to the deckfile,  is processed  and
      458     6188                           the new catalog is added.
      459     6189        */
      460     6190        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:82   
      461     6191    1   NC_ADD_CATALOG: PROC ALTRET ;

   6191  2 000515   200004 741300       NC_ADD_CATA* STX1  ! 4,,AUTO

      462     6192
      463     6193        /* Code */
      464     6194
      465     6195    2      DUP.TEMP.OPEN_TYPE = %CREATE_FILE ;

   6195  2 000516   000140 450000 xsym               STZ     DUP+96

      466     6196    2      CALL TOU$DFU_OPEN_TEMP ALTRET (ERROR) ;

   6196  2 000517   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000520   000000 701000 xent               TSX1    TOU$DFU_OPEN_TEMP
         2 000521   000557 702000 2                  TSX2    ERROR

      467     6197    2      CALL TOU$DU_OPEN_IFAD ALTRET (ERROR) ;

   6197  2 000522   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000523   000000 701000 xent               TSX1    TOU$DU_OPEN_IFAD
         2 000524   000557 702000 2                  TSX2    ERROR

      468     6198    2      CALL TOU$CLEAR_IFAD ;

   6198  2 000525   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000526   000000 701000 xent               TSX1    TOU$CLEAR_IFAD
         2 000527   000000 011000                    NOP     0

      469     6199    2      CALL NC_PROCESS_IFAD ALTRET (ERROR) ;

   6199  2 000530   000571 701000 2                  TSX1    NC_PROCESS_IFAD
         2 000531   000557 702000 2                  TSX2    ERROR

      470     6200    2      CALL TOU$DU_CLOSE_IFAD ALTRET (ERROR) ;

   6200  2 000532   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:83   
         2 000533   000000 701000 xent               TSX1    TOU$DU_CLOSE_IFAD
         2 000534   000557 702000 2                  TSX2    ERROR

      471     6201    2      DUP.TEMP.CLOSE_TYPE = %SAVE_FILE ;

   6201  2 000535   000141 450000 xsym               STZ     DUP+97

      472     6202    2      CALL TOU$DFU_CLOSE_TEMP ALTRET (ERROR) ;

   6202  2 000536   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000537   000000 701000 xent               TSX1    TOU$DFU_CLOSE_TEMP
         2 000540   000557 702000 2                  TSX2    ERROR

      473     6203
      474     6204    2      DUP.TEMP.OPEN_TYPE = %READ_FILE ;

   6204  2 000541   000002 235007                    LDA     2,DL
         2 000542   000140 755000 xsym               STA     DUP+96

      475     6205    2      CALL TOU$DFU_OPEN_TEMP ALTRET (ERROR) ;

   6205  2 000543   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000544   000000 701000 xent               TSX1    TOU$DFU_OPEN_TEMP
         2 000545   000557 702000 2                  TSX2    ERROR

      476     6206    2      CALL NC_PROCESS_TEMP ALTRET (ERROR) ;

   6206  2 000546   001152 701000 2                  TSX1    NC_PROCESS_TEMP
         2 000547   000557 702000 2                  TSX2    ERROR

      477     6207    2      DUP.TEMP.CLOSE_TYPE = %DISCARD_FILE ;

   6207  2 000550   000001 235007                    LDA     1,DL
         2 000551   000141 755000 xsym               STA     DUP+97

      478     6208    2      CALL TOU$DFU_CLOSE_TEMP ALTRET (ERROR) ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:84   
   6208  2 000552   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000553   000000 701000 xent               TSX1    TOU$DFU_CLOSE_TEMP
         2 000554   000557 702000 2                  TSX2    ERROR

      479     6209    2      RETURN ;

   6209  2 000555   200004 221300                    LDX1  ! 4,,AUTO
         2 000556   000001 702211                    TSX2  ! 1,X1

      480     6210
      481     6211    2   ERROR:
      482     6212    2      CALL TOU$DU_CLOSE_IFAD ;

   6212  2 000557   000002 631400 xsym  ERROR        EPPR1   B_VECTNIL+2
         2 000560   000000 701000 xent               TSX1    TOU$DU_CLOSE_IFAD
         2 000561   000000 011000                    NOP     0

      483     6213    2      DUP.TEMP.CLOSE_TYPE = %DISCARD_FILE ;

   6213  2 000562   000001 235007                    LDA     1,DL
         2 000563   000141 755000 xsym               STA     DUP+97

      484     6214    2      CALL TOU$DFU_CLOSE_TEMP ;

   6214  2 000564   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000565   000000 701000 xent               TSX1    TOU$DFU_CLOSE_TEMP
         2 000566   000000 011000                    NOP     0

      485     6215    2      ALTRETURN ;

   6215  2 000567   200004 221300                    LDX1  ! 4,,AUTO
         2 000570   000000 702211                    TSX2  ! 0,X1

      486     6216
      487     6217        /* END NC_ADD_CATALOG */
      488     6218        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:85   
      489     6219        /*I*  NAME:        NC_PROCESS_IFAD
      490     6220              AUTHOR:      Scott S. Sheppard
      491     6221              PURPOSE:     Processes IFAD Input
      492     6222              INTERFACE:   NC_GET_CP6_OBJECT
      493     6223                           NC_GET_CATALOG
      494     6224                           NC_STORE_CATALOG
      495     6225                           NC_HOLD_BCD
      496     6226                           NC_HOLD_BINARY
      497     6227                           NC_ERR_MSG
      498     6228                           NC_STORE_MASTER_CATALOG
      499     6229                           NC_STORE_LAST_DECK#
      500     6230                           TOU$DFU_OPEN_TEMP
      501     6231                           TOU$DFU_CLOSE_TEMP
      502     6232              INPUT:       OBJECT_FOUND
      503     6233                           RECORD.SIZE
      504     6234                           FILE_EOF
      505     6235              OUTPUT:      DUP.TEMP.CLOSE_TYPE - set if wrong file used
      506     6236              DESCRIPTION: This procedure processes the IFAD input source
      507     6237                           from start to end (two EOF marks in a row).
      508     6238        */
      509     6239        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:86   
      510     6240    2   NC_PROCESS_IFAD: PROC ALTRET ;

   6240  2 000571   200006 741300       NC_PROCESS_* STX1  ! ITR_INX,,AUTO

      511     6241
      512     6242    3      DCL MATCHING_CATALOG           BIT (1) CALIGNED ;
      513     6243
      514     6244        /* Code */
      515     6245
      516     6246    3      CALL TOU$GET_CP6_OBJECT ALTRET (ERROR) ;

   6246  2 000572   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000573   000000 701000 xent               TSX1    TOU$GET_CP6_OBJECT
         2 000574   000713 702000 2                  TSX2    ERROR

      517     6247    3      MATCHING_CATALOG = %FALSE ;

   6247  2 000575   200007 450100                    STZ     MATCHING_CATALOG,,AUTO

      518     6248    4      DO WHILE (~MATCHING_CATALOG AND FILE_EOF < 2) ;

   6248  2 000576   000657 710000 2                  TRA     s:6270

      519     6249    4         CALL NC_SETUP_DF ;

   6249  2 000577   000211 701000 2                  TSX1    NC_SETUP_DF
         2 000600   000000 011000                    NOP     0

      520     6250    4         CALL TOU$B_GET_CATALOG ;

   6250  2 000601   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000602   000000 701000 xent               TSX1    TOU$B_GET_CATALOG
         2 000603   000000 011000                    NOP     0

      521     6251    4         CALL TOU$B_SET_CATALOG_KEY ALTRET (ERROR) ;

   6251  2 000604   000002 631400 xsym               EPPR1   B_VECTNIL+2
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:87   
         2 000605   000000 701000 xent               TSX1    TOU$B_SET_CATALOG_KEY
         2 000606   000713 702000 2                  TSX2    ERROR

      522     6252    5         DO WHILE (FILE_EOF = 0) ;

   6252  2 000607   000000 235000 xsym               LDA     FILE_EOF
         2 000610   000636 601000 2                  TNZ     s:6261

      523     6253    5            CALL TOU$GET_BINARY_CARDS ALTRET (ERROR) ;

   6253  2 000611   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000612   000000 701000 xent               TSX1    TOU$GET_BINARY_CARDS
         2 000613   000713 702000 2                  TSX2    ERROR

      524     6254    5            CALL TOU$GET_BCD_CARDS ALTRET (ERROR) ;

   6254  2 000614   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000615   000000 701000 xent               TSX1    TOU$GET_BCD_CARDS
         2 000616   000713 702000 2                  TSX2    ERROR

      525     6255    5            CALL TOU$B_SET_OBJECT_KEY ALTRET (ERROR) ;

   6255  2 000617   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000620   000000 701000 xent               TSX1    TOU$B_SET_OBJECT_KEY
         2 000621   000713 702000 2                  TSX2    ERROR

      526     6256    5            CALL NC_STORE_OBJECT_DECK ALTRET (ERROR) ;

   6256  2 000622   000735 701000 2                  TSX1    NC_STORE_OBJECT_DECK
         2 000623   000713 702000 2                  TSX2    ERROR

      527     6257    5            CALL TOU$B_CHECK_CORRECT_FILE ALTRET (ERROR) ;

   6257  2 000624   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000625   000000 701000 xent               TSX1    TOU$B_CHECK_CORRECT_FILE
         2 000626   000713 702000 2                  TSX2    ERROR

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:88   
      528     6258    5            CALL NC_STORE_CATALOG_ENTRY ALTRET (ERROR) ;

   6258  2 000627   001012 701000 2                  TSX1    NC_STORE_CATALOG_ENTRY
         2 000630   000713 702000 2                  TSX2    ERROR

      529     6259    5            CALL TOU$GET_CP6_OBJECT ALTRET (ERROR) ;

   6259  2 000631   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000632   000000 701000 xent               TSX1    TOU$GET_CP6_OBJECT
         2 000633   000713 702000 2                  TSX2    ERROR

      530     6260    5         END /* WHILE */ ;

   6260  2 000634   000000 235000 xsym               LDA     FILE_EOF
         2 000635   000611 600000 2                  TZE     s:6253

      531     6261    4         CALL NC_CHECK_MATCH (MATCHING_CATALOG) ;

   6261  2 000636   200007 630500                    EPPR0   MATCHING_CATALOG,,AUTO
         2 000637   200011 450500                    STP0    RESPONSE_,,AUTO
         2 000640   000715 701000 2                  TSX1    NC_CHECK_MATCH
         2 000641   000000 011000                    NOP     0

      532     6262    4         IF MATCHING_CATALOG

   6262  2 000642   200007 234100                    SZN     MATCHING_CATALOG,,AUTO
         2 000643   000657 604000 2                  TMI     s:6270

      533     6263    4         THEN /* No further reads are necessary */ ;
      534     6264    5         ELSE DO ;

      535     6265    5                 DUP.TEMP.CLOSE_TYPE = %DISCARD_FILE ;

   6265  2 000644   000001 235007                    LDA     1,DL
         2 000645   000141 755000 xsym               STA     DUP+97

      536     6266    5                 CALL TOU$DFU_CLOSE_TEMP ALTRET (ERROR) ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:89   

   6266  2 000646   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000647   000000 701000 xent               TSX1    TOU$DFU_CLOSE_TEMP
         2 000650   000713 702000 2                  TSX2    ERROR

      537     6267    5                 CALL TOU$DFU_OPEN_TEMP ALTRET (ERROR) ;

   6267  2 000651   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000652   000000 701000 xent               TSX1    TOU$DFU_OPEN_TEMP
         2 000653   000713 702000 2                  TSX2    ERROR

      538     6268    5                 CALL TOU$GET_CP6_OBJECT ALTRET (ERROR) ;

   6268  2 000654   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000655   000000 701000 xent               TSX1    TOU$GET_CP6_OBJECT
         2 000656   000713 702000 2                  TSX2    ERROR

      539     6269    5              END /* ELSE */ ;

      540     6270    4      END /* WHILE */ ;

   6270  2 000657   200007 236100                    LDQ     MATCHING_CATALOG,,AUTO
         2 000660   400000 376003                    ANQ     -131072,DU
         2 000661   400000 676003                    ERQ     -131072,DU
         2 000662   000666 600000 2                  TZE     s:6272
         2 000663   000000 235000 xsym               LDA     FILE_EOF
         2 000664   000002 115007                    CMPA    2,DL
         2 000665   000577 602000 2                  TNC     s:6249

      541     6271           %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:90   
      542     6272    3      IF MATCHING_CATALOG

   6272  2 000666   200007 234100                    SZN     MATCHING_CATALOG,,AUTO
         2 000667   000704 605000 2                  TPL     s:6282

      543     6273    4      THEN DO ;

      544     6274    4              CALL NC_STORE_SUBCATALOG ALTRET (ERROR) ;

   6274  2 000670   001036 701000 2                  TSX1    NC_STORE_SUBCATALOG
         2 000671   000713 702000 2                  TSX2    ERROR

      545     6275    4              CALL NC_STORE_CATALOG ALTRET (ERROR) ;

   6275  2 000672   001063 701000 2                  TSX1    NC_STORE_CATALOG
         2 000673   000713 702000 2                  TSX2    ERROR

      546     6276    4              CALL NC_STORE_MASTER_ENTRY ALTRET (ERROR) ;

   6276  2 000674   001103 701000 2                  TSX1    NC_STORE_MASTER_ENTRY
         2 000675   000713 702000 2                  TSX2    ERROR

      547     6277    4              CALL NC_STORE_MASTER_CATALOG ALTRET (ERROR) ;

   6277  2 000676   001127 701000 2                  TSX1    NC_STORE_MASTER_CATALOG
         2 000677   000713 702000 2                  TSX2    ERROR

      548     6278    4              CALL NC_STORE_LAST_DECK# ALTRET (ERROR) ;

   6278  2 000700   001137 701000 2                  TSX1    NC_STORE_LAST_DECK#
         2 000701   000713 702000 2                  TSX2    ERROR

      549     6279    4              RETURN ;

   6279  2 000702   200006 221300                    LDX1  ! ITR_INX,,AUTO
         2 000703   000001 702211                    TSX2  ! 1,X1

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:91   
      550     6280    4           END /* THEN */ ;
      551     6281    4      ELSE DO ;

      552     6282    4              CATALOG_KEY.DATA = CATALOG_SEARCH_KEY.DATA ;

   6282  2 000704   040000 100400                    MLR     fill='040'O
         2 000705   000000 000025 0                  ADSC9   CATALOG_SEARCH_KEY       cn=0,n=21
         2 000706   000000 200025 xsym               ADSC9   CATALOG_KEY              cn=1,n=21

      553     6283    4              CALL NC_ERR_MSG (%E$NPI_NO_ENTRIES) ;

   6283  2 000707   000004 236000 3                  LDQ     4
         2 000710   200013 756100                    STQ     @CATALOG_KEYS_MATCH+2,,AUTO
         2 000711   001521 701000 2                  TSX1    NC_ERR_MSG
         2 000712   000000 011000                    NOP     0

      554     6284    4   ERROR:
      555     6285    4              ALTRETURN ;

   6285  2 000713   200006 221300       ERROR        LDX1  ! ITR_INX,,AUTO
         2 000714   000000 702211                    TSX2  ! 0,X1

      556     6286    4           END /* ELSE */ ;
      557     6287
      558     6288        /* END NC_PROCESS_IFAD */
      559     6289        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:92   
      560     6290        /*I*  NAME:        NC_CHECK_MATCH
      561     6291              AUTHOR:      Scott S. Sheppard
      562     6292              PURPOSE:     Checks for Catalog
      563     6293              INTERFACE:   None called.
      564     6294              INPUT:       CATALOG_SEARCH_KEY
      565     6295                           CATALOG_KEY
      566     6296              OUTPUT:      CATALOG_KEYS_MATCH - output parameter
      567     6297              DESCRIPTION: This procedure determines if the current $Object
      568     6298                           card is the first $object card of the catalog to
      569     6299                           be added.
      570     6300        */
      571     6301
      572     6302    3   NC_CHECK_MATCH: PROC (CATALOG_KEYS_MATCH) ;

   6302  2 000715   200010 741300       NC_CHECK_MA* STX1  ! MATCHING_CATALOG+1,,AUTO

      573     6303
      574     6304    4      DCL CATALOG_KEYS_MATCH         BIT (1) CALIGNED ;
      575     6305
      576     6306        /* Code */
      577     6307
      578     6308    4      IF CATALOG_KEY.DATA = CATALOG_SEARCH_KEY.DATA

   6308  2 000716   040000 106400                    CMPC    fill='040'O
         2 000717   000000 200025 xsym               ADSC9   CATALOG_KEY              cn=1,n=21
         2 000720   000000 000025 0                  ADSC9   CATALOG_SEARCH_KEY       cn=0,n=21
         2 000721   000727 601000 2                  TNZ     s:6310

      579     6309    4      THEN CATALOG_KEYS_MATCH = %TRUE ;

   6309  2 000722   200011 470500                    LDP0    @CATALOG_KEYS_MATCH,,AUTO
         2 000723   003100 060400                    CSL     bolr='003'O
         2 000724   000030 000001 xsym               BDSC    B_VECTNIL+24             by=0,bit=0,n=1
         2 000725   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 000726   000733 710000 2                  TRA     s:6311

      580     6310    4      ELSE CATALOG_KEYS_MATCH = %FALSE ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:93   

   6310  2 000727   200011 470500                    LDP0    @CATALOG_KEYS_MATCH,,AUTO
         2 000730   003100 060400                    CSL     bolr='003'O
         2 000731   000002 000001 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=1
         2 000732   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1

      581     6311    4      RETURN ;

   6311  2 000733   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 000734   000001 702211                    TSX2  ! 1,X1

      582     6312
      583     6313    4   END NC_CHECK_MATCH ;
      584     6314        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:94   
      585     6315        /*I*  NAME:        B_STORE_OBJECT_DECK
      586     6316              AUTHORS:     Dave Augustine
      587     6317                           Scott Sheppard
      588     6318              PURPOSE:     Saves a Binary Deck in Tempfile
      589     6319              INTERFACE:   TOU$CHECKSUM
      590     6320                           TOU$DFU_TF_WR_OBJECT
      591     6321                           TOU$DFU_TF_WR_BINARY
      592     6322                           TOU$DFU_TF_WR_BCD_CARDS
      593     6323              INPUT:       LAST.DECK#
      594     6324                           BIN#
      595     6325                           BCD#
      596     6326              OUTPUT:      OBJECT.DECK#
      597     6327                           OBJECT.BINARY_COUNT
      598     6328                           OBJECT.TOTAL_COUNT
      599     6329                           OBJECT.CHECKSUM
      600     6330                           DECK_SAVED
      601     6331                           LAST.DECK#
      602     6332                           BINARY_KEY.DECK#
      603     6333                           BCD_KEY.DECK#
      604     6334              DESCRIPTION: This procedure saves all of the records for an
      605     6335                           in the temporay file.
      606     6336        */
      607     6337        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:95   
      608     6338    3   NC_STORE_OBJECT_DECK: PROC ALTRET ;

   6338  2 000735   200010 741300       NC_STORE_OB* STX1  ! MATCHING_CATALOG+1,,AUTO

      609     6339
      610     6340        /* Code */
      611     6341
      612     6342    4      DECK_SAVED = %TRUE ;

   6342  2 000736   400000 236003                    LDQ     -131072,DU
         2 000737   000000 756000 xsym               STQ     DECK_SAVED

      613     6343
      614     6344           /* Set up $OBJECT card */
      615     6345    4      OBJECT.DECK# = LAST.DECK#;

   6345  2 000740   000000 220000 xsym               LDX0    LAST
         2 000741   000024 740000 xsym               STX0    OBJECT+20

      616     6346    4      OBJECT.BINARY_COUNT = BIN# ;

   6346  2 000742   000000 722000 xsym               LXL2    BIN#
         2 000743   000024 442000 xsym               SXL2    OBJECT+20

      617     6347    4      OBJECT.TOTAL_COUNT = BIN# + BCD# + 1;

   6347  2 000744   000000 236000 xsym               LDQ     BIN#
         2 000745   000000 036000 xsym               ADLQ    BCD#
         2 000746   000001 623006                    EAX3    1,QL
         2 000747   000025 743000 xsym               STX3    OBJECT+21

      618     6348    4      CALL TOU$CHECKSUM (0,

   6348  2 000750   000005 236000 3                  LDQ     5
         2 000751   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 000752   000010 237000 3                  LDAQ    8
         2 000753   200032 757100                    STAQ    VALID_RESPONSE+5,,AUTO
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:96   
         2 000754   200026 630500                    EPPR0   VALID_RESPONSE+1,,AUTO
         2 000755   200031 450500                    STP0    VALID_RESPONSE+4,,AUTO
         2 000756   000007 236000 3                  LDQ     7
         2 000757   200030 756100                    STQ     VALID_RESPONSE+3,,AUTO
         2 000760   200030 630500                    EPPR0   VALID_RESPONSE+3,,AUTO
         2 000761   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000762   000000 701000 xent               TSX1    TOU$CHECKSUM
         2 000763   000000 011000                    NOP     0

      619     6349    4              ADDR (OBJECT),
      620     6350    4              23,
      621     6351    4              OBJECT.CHECKSUM);
      622     6352    4      LAST.DECK# = LAST.DECK# + 1 ;

   6352  2 000764   000000 220000 xsym               LDX0    LAST
         2 000765   000001 621010                    EAX1    1,X0
         2 000766   000000 741000 xsym               STX1    LAST

      623     6353
      624     6354           /* Save the deck parts */
      625     6355    4      CALL TOU$DFU_TF_WR_OBJECT ALTRET (ERROR) ;

   6355  2 000767   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000770   000000 701000 xent               TSX1    TOU$DFU_TF_WR_OBJECT
         2 000771   001010 702000 2                  TSX2    ERROR

      626     6356    4      BINARY_KEY.DECK# = OBJECT.DECK# ;

   6356  2 000772   000024 236000 xsym               LDQ     OBJECT+20
         2 000773   000011 772000                    QRL     9
         2 000774   000000 552030 xsym               STBQ    BINARY_KEY,'30'O

      627     6357    4      CALL TOU$DFU_TF_WR_BINARY ALTRET (ERROR) ;

   6357  2 000775   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000776   000000 701000 xent               TSX1    TOU$DFU_TF_WR_BINARY
         2 000777   001010 702000 2                  TSX2    ERROR
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:97   

      628     6358    4      BCD_KEY.DECK# = OBJECT.DECK# ;

   6358  2 001000   000024 236000 xsym               LDQ     OBJECT+20
         2 001001   000011 772000                    QRL     9
         2 001002   000000 552030 xsym               STBQ    BCD_KEY,'30'O

      629     6359    4      CALL TOU$DFU_TF_WR_BCD_CARDS ALTRET (ERROR) ;

   6359  2 001003   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001004   000000 701000 xent               TSX1    TOU$DFU_TF_WR_BCD_CARDS
         2 001005   001010 702000 2                  TSX2    ERROR

      630     6360    4      RETURN ;

   6360  2 001006   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001007   000001 702211                    TSX2  ! 1,X1

      631     6361
      632     6362    4   ERROR:
      633     6363    4      ALTRETURN ;

   6363  2 001010   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001011   000000 702211                    TSX2  ! 0,X1

      634     6364
      635     6365    4   END NC_STORE_OBJECT_DECK;
      636     6366        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:98   
      637     6367        /*I*  NAME:        NC_STORE_CATALOG_ENTRY
      638     6368              AUTHORS:     David M. Augustine
      639     6369                           Scott S. Sheppard
      640     6370              PURPOSE:     Saves the Deck as a Catalog Entry
      641     6371              INTERFACE:   TOU$DFU_TF_WR_CATALOG_ENTRY
      642     6372              INPUT:       CATALOG_ENTRY_KEY.ENTRY#
      643     6373                           CATALOG_ENTRY_KEY.ENTRY_COUNT
      644     6374              OUTPUT:      CATALOG_ENTRY_KEY.ENTRY#
      645     6375                           CATALOG_DATA.ENTRY_COUNT
      646     6376              DESCRIPTION: This procedure is called to save the object deck as
      647     6377                           an entry of the current catalog.
      648     6378        */
      649     6379
      650     6380    3   NC_STORE_CATALOG_ENTRY: PROC ALTRET ;

   6380  2 001012   200010 741300       NC_STORE_CA* STX1  ! MATCHING_CATALOG+1,,AUTO

      651     6381
      652     6382        /* Code */
      653     6383
      654     6384    4      CALL TOU$DFU_TF_WR_CATALOG_ENTRY ALTRET (ERROR) ;

   6384  2 001013   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001014   000000 701000 xent               TSX1    TOU$DFU_TF_WR_CATALOG_ENTRY
         2 001015   001034 702000 2                  TSX2    ERROR

      655     6385    4      CATALOG_ENTRY_KEY.ENTRY# = CATALOG_ENTRY_KEY.ENTRY# + 1;

   6385  2 001016   000000 235000 xsym               LDA     CATALOG_ENTRY_KEY
         2 001017   000001 236000 xsym               LDQ     CATALOG_ENTRY_KEY+1
         2 001020   000033 773000                    LRL     27
         2 001021   777777 376007                    ANQ     -1,DL
         2 001022   000001 036007                    ADLQ    1,DL
         2 001023   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 001024   000000 101500                    MRL     fill='000'O
         2 001025   200026 000004                    ADSC9   VALID_RESPONSE+1,,AUTO   cn=0,n=4
         2 001026   000000 600002 xsym               ADSC9   CATALOG_ENTRY_KEY        cn=3,n=2
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:99   

      656     6386    4      CATALOG_DATA.ENTRY_COUNT = CATALOG_DATA.ENTRY_COUNT + 1;

   6386  2 001027   000000 720000 xsym               LXL0    CATALOG_DATA
         2 001030   000001 621010                    EAX1    1,X0
         2 001031   000000 441000 xsym               SXL1    CATALOG_DATA

      657     6387    4      RETURN;

   6387  2 001032   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001033   000001 702211                    TSX2  ! 1,X1

      658     6388
      659     6389    4   ERROR:
      660     6390    4      ALTRETURN ;

   6390  2 001034   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001035   000000 702211                    TSX2  ! 0,X1

      661     6391
      662     6392    4   END NC_STORE_CATALOG_ENTRY;
      663     6393        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:100  
      664     6394        /*I*  NAME:        NC_STORE_SUBCATALOG
      665     6395              AUTHORS:     David M. Augustine
      666     6396                           Scott S. Sheppard
      667     6397              PURPOSE:     Saves Subcatalog
      668     6398              INTERFACE:   TOU$REPLACE
      669     6399                           TOU$DFU_TF_WR_SUBCATALOG
      670     6400              INPUT:       DUP.IFAD.FID
      671     6401                           CATALOG_DATA.DECK#
      672     6402              OUTPUT:      SUBCATALOG_DATA.IFAD_FID
      673     6403                           SUBCATALOG_DATA.IFAD_FN
      674     6404                           SUBCATALOG_KEY.DECK#
      675     6405              DESCRIPTION: This procedure saves the subcatalog information
      676     6406                           (IFAD file identifier and file number) for  the
      677     6407                           current catalog being procesed.
      678     6408        */
      679     6409
      680     6410    3   NC_STORE_SUBCATALOG: PROC ALTRET ;

   6410  2 001036   200010 741300       NC_STORE_SU* STX1  ! MATCHING_CATALOG+1,,AUTO

      681     6411
      682     6412        /* Code */
      683     6413
      684     6414    4      SUBCATALOG_KEY.DECK# = CATALOG_DATA.DECK# ;

   6414  2 001037   000000 236000 xsym               LDQ     CATALOG_DATA
         2 001040   000011 772000                    QRL     9
         2 001041   000000 552030 xsym               STBQ    SUBCATALOG_KEY,'30'O

      685     6415    4      SUBCATALOG_DATA.IFAD_FID = DUP.IFAD.FID ;

   6415  2 001042   040000 100400                    MLR     fill='040'O
         2 001043   000063 200050 xsym               ADSC9   DUP+51                   cn=1,n=40
         2 001044   000000 000050 xsym               ADSC9   SUBCATALOG_DATA          cn=0,n=40

      686     6416    4      SUBCATALOG_DATA.IFAD_FN = '~FM' ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:101  
   6416  2 001045   040000 100400                    MLR     fill='040'O
         2 001046   000013 000003 1                  ADSC9   11                       cn=0,n=3
         2 001047   000012 000014 xsym               ADSC9   SUBCATALOG_DATA+10       cn=0,n=12

      687     6417    4      CALL TOU$REPLACE (SUBCATALOG_DATA.IFAD_FN, 3) ;

   6417  2 001050   000012 630400 3                  EPPR0   10
         2 001051   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 001052   000000 701000 xent               TSX1    TOU$REPLACE
         2 001053   000000 011000                    NOP     0

      688     6418    4      CALL TOU$DFU_TF_WR_SUBCATALOG ALTRET (ERROR) ;

   6418  2 001054   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001055   000000 701000 xent               TSX1    TOU$DFU_TF_WR_SUBCATALOG
         2 001056   001061 702000 2                  TSX2    ERROR

      689     6419    4      RETURN ;

   6419  2 001057   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001060   000001 702211                    TSX2  ! 1,X1

      690     6420
      691     6421    4   ERROR:
      692     6422    4      ALTRETURN ;

   6422  2 001061   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001062   000000 702211                    TSX2  ! 0,X1

      693     6423
      694     6424    4   END NC_STORE_SUBCATALOG ;
      695     6425        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:102  
      696     6426        /*I*  NAME:        NC_STORE_CATALOG
      697     6427              AUTHORS:     David M. Augustine
      698     6428                           Scott S. Sheppard
      699     6429              PURPOSE:     Saves Catalog Information
      700     6430              INTERFACE:   NC_ERR_MSG
      701     6431                           TOU$DFU_TF_WR_MASTER_ENTRY
      702     6432                           TOU$DFU_TF_WR_CATALOG_CONTROL
      703     6433              INPUT:       CATALOG_KEY_SET
      704     6434              OUTPUT:      CATALOG_KEY_SET
      705     6435                           DECK_SAVED
      706     6436              DESCRIPTION: This procedure saves the catalog control record
      707     6437                           in the temporary file.
      708     6438        */
      709     6439
      710     6440    3   NC_STORE_CATALOG: PROC ALTRET ;

   6440  2 001063   200010 741300       NC_STORE_CA* STX1  ! MATCHING_CATALOG+1,,AUTO

      711     6441
      712     6442        /* Code */
      713     6443
      714     6444    4      IF CATALOG_KEY_SET

   6444  2 001064   000000 234000 xsym               SZN     CATALOG_KEY_SET
         2 001065   001075 605000 2                  TPL     s:6453

      715     6445    5      THEN DO ;

      716     6446    5              CALL TOU$DFU_TF_WR_CATALOG_CONTROL ALTRET (ERROR) ;

   6446  2 001066   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001067   000000 701000 xent               TSX1    TOU$DFU_TF_WR_CATALOG_CONTROL
         2 001070   001101 702000 2                  TSX2    ERROR

      717     6447
      718     6448    5              CATALOG_KEY_SET = %FALSE ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:103  
   6448  2 001071   000000 450000 xsym               STZ     CATALOG_KEY_SET

      719     6449    5              DECK_SAVED = %FALSE ;

   6449  2 001072   000000 450000 xsym               STZ     DECK_SAVED

      720     6450    5              RETURN ;

   6450  2 001073   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001074   000001 702211                    TSX2  ! 1,X1

      721     6451    5           END /* THEN */ ;
      722     6452    5      ELSE DO ;

      723     6453    5              CALL NC_ERR_MSG (%E$BSC_ITR_NO_FIRM) ;

   6453  2 001075   000015 236000 3                  LDQ     13
         2 001076   200013 756100                    STQ     @CATALOG_KEYS_MATCH+2,,AUTO
         2 001077   001521 701000 2                  TSX1    NC_ERR_MSG
         2 001100   000000 011000                    NOP     0

      724     6454    5   ERROR:
      725     6455    5              ALTRETURN ;

   6455  2 001101   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001102   000000 702211                    TSX2  ! 0,X1

      726     6456    5           END /* ELSE */ ;
      727     6457
      728     6458    4   END NC_STORE_CATALOG ;
      729     6459        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:104  
      730     6460        /*I*  NAME:        NC_STORE_MASTER_ENTRY
      731     6461              AUTHORS:     David M. Augustine
      732     6462                           Scott S. Sheppard
      733     6463              PURPOSE:     Saves Catalog as a Master Entry
      734     6464              INTERFACE:   TOU$DFU_TF_WR_MASTER_ENTRY
      735     6465              INPUT:       MASTER_ENTRY_KEY
      736     6466                           MASTER_DATA
      737     6467              OUTPUT:      MASTER_ENTRY_KEY
      738     6468                           MASTER_DATA
      739     6469              DESCRIPTION: This procedure saves the current catalog as an entry
      740     6470                           of the master catalog.
      741     6471        */
      742     6472
      743     6473    3   NC_STORE_MASTER_ENTRY: PROC ALTRET ;

   6473  2 001103   200010 741300       NC_STORE_MA* STX1  ! MATCHING_CATALOG+1,,AUTO

      744     6474
      745     6475        /* Code */
      746     6476
      747     6477    4      MASTER_ENTRY_KEY.ENTRY# = MASTER_ENTRY_KEY.ENTRY# + 1;

   6477  2 001104   000000 235000 xsym               LDA     MASTER_ENTRY_KEY
         2 001105   000001 236000 xsym               LDQ     MASTER_ENTRY_KEY+1
         2 001106   000033 773000                    LRL     27
         2 001107   777777 376007                    ANQ     -1,DL
         2 001110   000001 036007                    ADLQ    1,DL
         2 001111   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 001112   000000 101500                    MRL     fill='000'O
         2 001113   200026 000004                    ADSC9   VALID_RESPONSE+1,,AUTO   cn=0,n=4
         2 001114   000000 600002 xsym               ADSC9   MASTER_ENTRY_KEY         cn=3,n=2

      748     6478    4      MASTER_DATA.ENTRY_COUNT = MASTER_DATA.ENTRY_COUNT + 1;

   6478  2 001115   000000 720000 xsym               LXL0    MASTER_DATA
         2 001116   000001 622010                    EAX2    1,X0
         2 001117   000000 442000 xsym               SXL2    MASTER_DATA
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:105  

      749     6479    4      CALL TOU$DFU_TF_WR_MASTER_ENTRY ALTRET (ERROR) ;

   6479  2 001120   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001121   000000 701000 xent               TSX1    TOU$DFU_TF_WR_MASTER_ENTRY
         2 001122   001125 702000 2                  TSX2    ERROR

      750     6480    4      RETURN ;

   6480  2 001123   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001124   000001 702211                    TSX2  ! 1,X1

      751     6481
      752     6482    4   ERROR:
      753     6483    4      ALTRETURN ;

   6483  2 001125   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001126   000000 702211                    TSX2  ! 0,X1

      754     6484
      755     6485    4   END NC_STORE_MASTER_ENTRY ;
      756     6486        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:106  
      757     6487        /*I*  NAME:        NC_STORE_MASTER_CATALOG
      758     6488              AUTHORS:     Dave Augustine
      759     6489                           Scott Sheppard
      760     6490              PURPOSE:     Saves Master Catalog Deck
      761     6491              INTERFACE:   TOU$DFU_TF_WR_MASTER_CONTROL
      762     6492              INPUT:       MASTER_DATA.ENTRY_COUNT
      763     6493              OUTPUT:      No external data altered.
      764     6494              DESCRIPTION: This procedure saves the master catalog in the
      765     6495                           deckfile after the IFAD input source  has been
      766     6496                           processed.
      767     6497        */
      768     6498
      769     6499    3   NC_STORE_MASTER_CATALOG: PROC ALTRET ;

   6499  2 001127   200010 741300       NC_STORE_MA* STX1  ! MATCHING_CATALOG+1,,AUTO

      770     6500
      771     6501        /* Code */
      772     6502
      773     6503    4      CALL TOU$DFU_TF_WR_MASTER_CONTROL ALTRET (ERROR) ;

   6503  2 001130   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001131   000000 701000 xent               TSX1    TOU$DFU_TF_WR_MASTER_CONTROL
         2 001132   001135 702000 2                  TSX2    ERROR

      774     6504    4      RETURN;

   6504  2 001133   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001134   000001 702211                    TSX2  ! 1,X1

      775     6505
      776     6506    4   ERROR:
      777     6507    4      ALTRETURN ;

   6507  2 001135   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001136   000000 702211                    TSX2  ! 0,X1

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:107  
      778     6508
      779     6509    4   END NC_STORE_MASTER_CATALOG;
      780     6510        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:108  
      781     6511        /*I*  NAME:        NC_STORE_LAST_DECK#
      782     6512              AUTHOR:      Scott S. Sheppard
      783     6513              PURPOSE:     Saves the Last Deck Number
      784     6514              INTERFACE:   TOU$DFU_TF_WR_LAST_DECK#
      785     6515              INPUT:       LAST.DECK# - set to the next available deck number
      786     6516              OUTPUT:      LAST.DECK# - set to the actual last value used
      787     6517              DESCRIPTION: The last deck number is incremented each time a
      788     6518                           deck is saved. During processing, the last deck
      789     6519                           number represents the next deck number since it
      790     6520                           is  constantly  being  assigned from  and  THEN
      791     6521                           incremented.   When the last deck is saved, the
      792     6522                           last deck number is actually  one  greater than
      793     6523                           the largest deck value stored in the deckfile.
      794     6524        */
      795     6525
      796     6526    3   NC_STORE_LAST_DECK#: PROC ALTRET ;

   6526  2 001137   200010 741300       NC_STORE_LA* STX1  ! MATCHING_CATALOG+1,,AUTO

      797     6527
      798     6528        /* Code */
      799     6529
      800     6530    4      LAST.DECK# = LAST.DECK# - 1 ;

   6530  2 001140   000000 220000 xsym               LDX0    LAST
         2 001141   777777 622010                    EAX2    -1,X0
         2 001142   000000 742000 xsym               STX2    LAST

      801     6531    4      CALL TOU$DFU_TF_WR_LAST_DECK# ALTRET (ERROR) ;

   6531  2 001143   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001144   000000 701000 xent               TSX1    TOU$DFU_TF_WR_LAST_DECK#
         2 001145   001150 702000 2                  TSX2    ERROR

      802     6532    4      RETURN ;

   6532  2 001146   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:109  
         2 001147   000001 702211                    TSX2  ! 1,X1

      803     6533
      804     6534    4   ERROR:
      805     6535    4      ALTRETURN ;

   6535  2 001150   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001151   000000 702211                    TSX2  ! 0,X1

      806     6536
      807     6537    4   END NC_STORE_LAST_DECK# ;
      808     6538    3   END NC_PROCESS_IFAD ;
      809     6539        %EJECT;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:110  
      810     6540        /*I*  NAME:        NC_PROCESS_TEMP
      811     6541              AUTHOR:      Scott S. Sheppard
      812     6542              PURPOSE:     Processes TEMP Input to Deckfile
      813     6543              INTERFACE:   NC_SAVE_MASTER_CONTROL
      814     6544                           NC_SAVE_MASTER_ENTRY
      815     6545                           NC_SAVE_CATALOG_CONTROL
      816     6546                           NC_SAVE_SUBCATALOG
      817     6547                           NC_SAVE_CATALOG_ENTRY
      818     6548                           NC_SAVE_OBJECT_DECK
      819     6549                           NC_SAVE_LOG
      820     6550                           NC_ADJUST_REFLIST
      821     6551                           NC_SETUP_PRINT
      822     6552                           TOU$B_PRINT_DECK_LINE
      823     6553                           NC_PRINT_ADDED_CATALOG
      824     6554                           NC_SAVE_LAST_DECK#
      825     6555              INPUT:       DEER temporary file - contains catalog records
      826     6556              OUTPUT:      DECKFILE            - catalog copied in
      827     6557              DESCRIPTION: This procedure processes the temporary file. It adds
      828     6558                           in any  object decks  for the catalog  (that are not
      829     6559                           already in the file) and the catalog control inform-
      830     6560                           ation to the deckfile.
      831     6561        */
      832     6562        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:111  
      833     6563    2   NC_PROCESS_TEMP: PROC ALTRET ;

   6563  2 001152   200006 741300       NC_PROCESS_* STX1  ! ITR_INX,,AUTO

      834     6564
      835     6565        /* Code */
      836     6566
      837     6567    3      DUP.BREAK_DISABLED = %TRUE ;

   6567  2 001153   000400 236003                    LDQ     256,DU
         2 001154   000155 256000 xsym               ORSQ    DUP+109

      838     6568    3      CALL NC_SAVE_MASTER_CONTROL ALTRET (ERROR) ;

   6568  2 001155   001256 701000 2                  TSX1    NC_SAVE_MASTER_CONTROL
         2 001156   001244 702000 2                  TSX2    ERROR

      839     6569    3      CALL NC_SAVE_MASTER_ENTRY ALTRET (ERROR) ;

   6569  2 001157   001271 701000 2                  TSX1    NC_SAVE_MASTER_ENTRY
         2 001160   001244 702000 2                  TSX2    ERROR

      840     6570    3      CALL TOU$ND_SAVE_CATALOG_CONTROL ALTRET (ERROR) ;

   6570  2 001161   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001162   000000 701000 xent               TSX1    TOU$ND_SAVE_CATALOG_CONTROL
         2 001163   001244 702000 2                  TSX2    ERROR

      841     6571    3      CALL NC_SAVE_SUBCATALOG ALTRET (ERROR) ;

   6571  2 001164   001312 701000 2                  TSX1    NC_SAVE_SUBCATALOG
         2 001165   001244 702000 2                  TSX2    ERROR

      842     6572    3      CATALOG_ENTRY_KEY.DECK# = CATALOG_DATA.DECK# ;

   6572  2 001166   000000 236000 xsym               LDQ     CATALOG_DATA
         2 001167   000011 772000                    QRL     9
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:112  
         2 001170   000000 552030 xsym               STBQ    CATALOG_ENTRY_KEY,'30'O

      843     6573    4      DO CATALOG_ENTRY_KEY.ENTRY# = 1 TO CATALOG_DATA.ENTRY_COUNT ;

   6573  2 001171   000000 101400                    MRL     fill='000'O
         2 001172   000003 000004 xsym               ADSC9   B_VECTNIL+3              cn=0,n=4
         2 001173   000000 600002 xsym               ADSC9   CATALOG_ENTRY_KEY        cn=3,n=2
         2 001174   001220 710000 2                  TRA     s:6578+9

      844     6574    4         CALL NC_SAVE_CATALOG_ENTRY ALTRET (ERROR) ;

   6574  2 001175   001330 701000 2                  TSX1    NC_SAVE_CATALOG_ENTRY
         2 001176   001244 702000 2                  TSX2    ERROR

      845     6575    4         CALL TOU$ND_SAVE_OBJECT_DECK ALTRET (ERROR) ;

   6575  2 001177   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001200   000000 701000 xent               TSX1    TOU$ND_SAVE_OBJECT_DECK
         2 001201   001244 702000 2                  TSX2    ERROR

      846     6576    4         CALL NC_SETUP_PRINT ;

   6576  2 001202   001371 701000 2                  TSX1    NC_SETUP_PRINT
         2 001203   000000 011000                    NOP     0

      847     6577    4         CALL TOU$B_PRINT_DECK_LINE ;

   6577  2 001204   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001205   000000 701000 xent               TSX1    TOU$B_PRINT_DECK_LINE
         2 001206   000000 011000                    NOP     0

      848     6578    4      END /* DO */ ;

   6578  2 001207   000000 235000 xsym               LDA     CATALOG_ENTRY_KEY
         2 001210   000001 236000 xsym               LDQ     CATALOG_ENTRY_KEY+1
         2 001211   000033 773000                    LRL     27
         2 001212   777777 376007                    ANQ     -1,DL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:113  
         2 001213   000001 036007                    ADLQ    1,DL
         2 001214   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 001215   000000 101500                    MRL     fill='000'O
         2 001216   200026 000004                    ADSC9   VALID_RESPONSE+1,,AUTO   cn=0,n=4
         2 001217   000000 600002 xsym               ADSC9   CATALOG_ENTRY_KEY        cn=3,n=2
         2 001220   000000 235000 xsym               LDA     CATALOG_ENTRY_KEY
         2 001221   000001 236000 xsym               LDQ     CATALOG_ENTRY_KEY+1
         2 001222   000033 773000                    LRL     27
         2 001223   777777 376007                    ANQ     -1,DL
         2 001224   200027 756100                    STQ     VALID_RESPONSE+2,,AUTO
         2 001225   000000 236000 xsym               LDQ     CATALOG_DATA
         2 001226   777777 376007                    ANQ     -1,DL
         2 001227   200027 116100                    CMPQ    VALID_RESPONSE+2,,AUTO
         2 001230   001175 605000 2                  TPL     s:6574

      849     6579    3      CALL NC_PRINT_ADDED_CATALOG ;

   6579  2 001231   001501 701000 2                  TSX1    NC_PRINT_ADDED_CATALOG
         2 001232   000000 011000                    NOP     0

      850     6580
      851     6581    3      CALL TOU$ND_SAVE_LAST_DECK# ALTRET (ERROR) ;

   6581  2 001233   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001234   000000 701000 xent               TSX1    TOU$ND_SAVE_LAST_DECK#
         2 001235   001244 702000 2                  TSX2    ERROR

      852     6582    3      CALL NC_SAVE_LOG ALTRET (ERROR) ;

   6582  2 001236   001343 701000 2                  TSX1    NC_SAVE_LOG
         2 001237   001244 702000 2                  TSX2    ERROR

      853     6583    3      DUP.BREAK_DISABLED = %FALSE ;

   6583  2 001240   000000 236000 3                  LDQ     0
         2 001241   000155 356000 xsym               ANSQ    DUP+109

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:114  
      854     6584    3      RETURN ;

   6584  2 001242   200006 221300                    LDX1  ! ITR_INX,,AUTO
         2 001243   000001 702211                    TSX2  ! 1,X1

      855     6585
      856     6586    3   ERROR:
      857     6587    3      DUP.BREAK_DISABLED = %FALSE ;

   6587  2 001244   000000 236000 3     ERROR        LDQ     0
         2 001245   000155 356000 xsym               ANSQ    DUP+109

      858     6588    3      DUP.DF.CLOSE_TYPE = %DISCARD_FILE ;

   6588  2 001246   000001 235007                    LDA     1,DL
         2 001247   000106 755000 xsym               STA     DUP+70

      859     6589    3      CALL NC_ERR_MSG (%E$NPT_BAD_DECKFILE) ;

   6589  2 001250   000017 236000 3                  LDQ     15
         2 001251   200013 756100                    STQ     @CATALOG_KEYS_MATCH+2,,AUTO
         2 001252   001521 701000 2                  TSX1    NC_ERR_MSG
         2 001253   000000 011000                    NOP     0

      860     6590    3      ALTRETURN ;

   6590  2 001254   200006 221300                    LDX1  ! ITR_INX,,AUTO
         2 001255   000000 702211                    TSX2  ! 0,X1

      861     6591
      862     6592        /* END NC_PROCESS_TEMP */
      863     6593        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:115  
      864     6594        /*I*  NAME:        NC_SAVE_MASTER_CONTROL
      865     6595              AUTHOR:      Scott S. Sheppard
      866     6596              PURPOSE:     Saves New Master Control
      867     6597              INTERFACE:   TOU$DFU_TF_RD_MASTER_CONTROL
      868     6598                           TOU$DFU_DF_WR_MASTER_CONTROL
      869     6599              INPUT:       MASTER_DATA
      870     6600              OUTPUT:      MASTER_DATA
      871     6601              DESCRIPTION: This  procedure saves the  new  master control,
      872     6602                           updated to include the new catalog in its entry
      873     6603                           count and checksum, in the deckfile.
      874     6604        */
      875     6605
      876     6606    3   NC_SAVE_MASTER_CONTROL: PROC ALTRET ;

   6606  2 001256   200010 741300       NC_SAVE_MAS* STX1  ! MATCHING_CATALOG+1,,AUTO

      877     6607
      878     6608        /* Code */
      879     6609
      880     6610    4      CALL TOU$DFU_TF_RD_MASTER_CONTROL ALTRET (ERROR) ;

   6610  2 001257   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001260   000000 701000 xent               TSX1    TOU$DFU_TF_RD_MASTER_CONTROL
         2 001261   001267 702000 2                  TSX2    ERROR

      881     6611    4      CALL TOU$DFU_DF_WR_MASTER_CONTROL ALTRET (ERROR) ;

   6611  2 001262   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001263   000000 701000 xent               TSX1    TOU$DFU_DF_WR_MASTER_CONTROL
         2 001264   001267 702000 2                  TSX2    ERROR

      882     6612    4      RETURN ;

   6612  2 001265   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001266   000001 702211                    TSX2  ! 1,X1

      883     6613
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:116  
      884     6614    4   ERROR:
      885     6615    4      ALTRETURN ;

   6615  2 001267   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001270   000000 702211                    TSX2  ! 0,X1

      886     6616
      887     6617    4   END NC_SAVE_MASTER_CONTROL ;
      888     6618        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:117  
      889     6619        /*I*  NAME:        NC_SAVE_MASTER_ENTRY
      890     6620              AUTHOR:      Scott S. Sheppard
      891     6621              PURPOSE:     Saves Master Entry
      892     6622              INTERFACE:   TOU$DFU_TF_RD_MASTER_ENTRY
      893     6623                           TOU$DFU_DF_WR_MASTER_ENTRY
      894     6624              INPUT:       MASTER_DATA
      895     6625              OUTPUT:      MASTER_ENTRY
      896     6626              DESCRIPTION: This procedure saves the master entry for the
      897     6627                           new catalog.
      898     6628        */
      899     6629
      900     6630    3   NC_SAVE_MASTER_ENTRY: PROC ALTRET ;

   6630  2 001271   200010 741300       NC_SAVE_MAS* STX1  ! MATCHING_CATALOG+1,,AUTO

      901     6631
      902     6632        /* Code */
      903     6633
      904     6634    4      MASTER_ENTRY_KEY.DECK# = MASTER_DATA.DECK# ;

   6634  2 001272   000000 236000 xsym               LDQ     MASTER_DATA
         2 001273   000011 772000                    QRL     9
         2 001274   000000 552030 xsym               STBQ    MASTER_ENTRY_KEY,'30'O

      905     6635    4      MASTER_ENTRY_KEY.ENTRY# = MASTER_DATA.ENTRY_COUNT ;

   6635  2 001275   000000 100400                    MLR     fill='000'O
         2 001276   000000 400002 xsym               ADSC9   MASTER_DATA              cn=2,n=2
         2 001277   000000 600002 xsym               ADSC9   MASTER_ENTRY_KEY         cn=3,n=2

      906     6636    4      CALL TOU$DFU_TF_RD_MASTER_ENTRY ALTRET (ERROR) ;

   6636  2 001300   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001301   000000 701000 xent               TSX1    TOU$DFU_TF_RD_MASTER_ENTRY
         2 001302   001310 702000 2                  TSX2    ERROR

      907     6637    4      CALL TOU$DFU_DF_WR_MASTER_ENTRY ALTRET (ERROR) ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:118  

   6637  2 001303   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001304   000000 701000 xent               TSX1    TOU$DFU_DF_WR_MASTER_ENTRY
         2 001305   001310 702000 2                  TSX2    ERROR

      908     6638    4      RETURN ;

   6638  2 001306   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001307   000001 702211                    TSX2  ! 1,X1

      909     6639
      910     6640    4   ERROR:
      911     6641    4      ALTRETURN ;

   6641  2 001310   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001311   000000 702211                    TSX2  ! 0,X1

      912     6642
      913     6643    4   END NC_SAVE_MASTER_ENTRY ;
      914     6644        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:119  
      915     6645        /*I*  NAME:        NC_SAVE_SUBCATALOG
      916     6646              AUTHOR:      Scott S. Sheppard
      917     6647              PURPOSE:     Saves Subcatalog
      918     6648              INTERFACE:   TOU$DFU_TF_RD_SUBCATALOG
      919     6649                           TOU$DFU_DF_WR_SUBCATALOG
      920     6650              INPUT:       CATALOG_DATA
      921     6651              OUTPUT:      SUBCATALOG_KEY
      922     6652              DESCRIPTION: This procedure saves the  IFAD file id and file
      923     6653                           number of the new catalog in the subcatalog for
      924     6654                           the new catalog.
      925     6655        */
      926     6656
      927     6657    3   NC_SAVE_SUBCATALOG: PROC ALTRET ;

   6657  2 001312   200010 741300       NC_SAVE_SUB* STX1  ! MATCHING_CATALOG+1,,AUTO

      928     6658
      929     6659        /* Code */
      930     6660
      931     6661    4      SUBCATALOG_KEY.DECK# = CATALOG_DATA.DECK# ;

   6661  2 001313   000000 236000 xsym               LDQ     CATALOG_DATA
         2 001314   000011 772000                    QRL     9
         2 001315   000000 552030 xsym               STBQ    SUBCATALOG_KEY,'30'O

      932     6662    4      CALL TOU$DFU_TF_RD_SUBCATALOG ALTRET (ERROR) ;

   6662  2 001316   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001317   000000 701000 xent               TSX1    TOU$DFU_TF_RD_SUBCATALOG
         2 001320   001326 702000 2                  TSX2    ERROR

      933     6663    4      CALL TOU$DFU_DF_WR_SUBCATALOG ALTRET (ERROR) ;

   6663  2 001321   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001322   000000 701000 xent               TSX1    TOU$DFU_DF_WR_SUBCATALOG
         2 001323   001326 702000 2                  TSX2    ERROR

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:120  
      934     6664    4      RETURN ;

   6664  2 001324   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001325   000001 702211                    TSX2  ! 1,X1

      935     6665
      936     6666    4   ERROR:
      937     6667    4      ALTRETURN ;

   6667  2 001326   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001327   000000 702211                    TSX2  ! 0,X1

      938     6668
      939     6669    4   END NC_SAVE_SUBCATALOG ;
      940     6670        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:121  
      941     6671        /*I*  NAME:        NC_SAVE_CATALOG_ENTRY
      942     6672              AUTHOR:      Scott S. Sheppard
      943     6673              PURPOSE:     Saves Catalog Entry
      944     6674              INTERFACE:   TOU$DFU_TF_RD_CATALOG_ENTRY
      945     6675                           TOU$DFU_DF_WR_CATALOG_ENTRY
      946     6676              INPUT:       CATALOG_ENTRY
      947     6677              OUTPUT:      CATALOG_ENTRY
      948     6678              DESCRIPTION: This procedure save a catalog entry for an object
      949     6679                           deck of the new catalog.
      950     6680        */
      951     6681
      952     6682    3   NC_SAVE_CATALOG_ENTRY: PROC ALTRET ;

   6682  2 001330   200010 741300       NC_SAVE_CAT* STX1  ! MATCHING_CATALOG+1,,AUTO

      953     6683
      954     6684        /* Code */
      955     6685
      956     6686    4      CALL TOU$DFU_TF_RD_CATALOG_ENTRY ALTRET (ERROR) ;

   6686  2 001331   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001332   000000 701000 xent               TSX1    TOU$DFU_TF_RD_CATALOG_ENTRY
         2 001333   001341 702000 2                  TSX2    ERROR

      957     6687    4      CALL TOU$DFU_DF_WR_CATALOG_ENTRY ALTRET (ERROR) ;

   6687  2 001334   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001335   000000 701000 xent               TSX1    TOU$DFU_DF_WR_CATALOG_ENTRY
         2 001336   001341 702000 2                  TSX2    ERROR

      958     6688    4      RETURN ;

   6688  2 001337   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001340   000001 702211                    TSX2  ! 1,X1

      959     6689
      960     6690    4   ERROR:
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:122  
      961     6691    4      ALTRETURN ;

   6691  2 001341   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001342   000000 702211                    TSX2  ! 0,X1

      962     6692
      963     6693    4   END NC_SAVE_CATALOG_ENTRY ;
      964     6694        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:123  
      965     6695        /*I*  NAME:        NC_SAVE_LOG
      966     6696              AUTHOR:      Scott S. Sheppard
      967     6697              PURPOSE:     Saves the deckfile history log
      968     6698              INTERFACE:   TOU$DU_UPDATE_LOG
      969     6699                           TOU$DFU_DF_WR_LOG
      970     6700              INPUT:       No system data accessed.
      971     6701              OUTPUT:      DUP.LOG.CATALOG
      972     6702                           DUP.LOG.DECK
      973     6703                           DUP.HOLD_AREA
      974     6704              DESCRIPTION: This procedure stores the deckfile history log.
      975     6705        */
      976     6706
      977     6707    3   NC_SAVE_LOG: PROC ALTRET ;

   6707  2 001343   200010 741300       NC_SAVE_LOG  STX1  ! MATCHING_CATALOG+1,,AUTO

      978     6708
      979     6709        /* Code */
      980     6710
      981     6711    4      DUP.LOG.TYPE = %T$SF_NEWCAT ;

   6711  2 001344   000111 235007                    LDA     73,DL
         2 001345   000122 755000 xsym               STA     DUP+82

      982     6712    4      DUP.LOG.CATALOG = CATALOG_KEY.DATA ;

   6712  2 001346   040000 100400                    MLR     fill='040'O
         2 001347   000000 200025 xsym               ADSC9   CATALOG_KEY              cn=1,n=21
         2 001350   000123 000025 xsym               ADSC9   DUP+83                   cn=0,n=21

      983     6713    4      DUP.LOG.DECK = ' ' ;

   6713  2 001351   040000 100400                    MLR     fill='040'O
         2 001352   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 001353   000130 200027 xsym               ADSC9   DUP+88                   cn=1,n=23

      984     6714    4      DUP.HOLD_AREA = DUP.IFAD.FID ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:124  

   6714  2 001354   040000 100400                    MLR     fill='040'O
         2 001355   000063 200050 xsym               ADSC9   DUP+51                   cn=1,n=40
         2 001356   000142 000050 xsym               ADSC9   DUP+98                   cn=0,n=40

      985     6715    4      CALL TOU$DU_UPDATE_LOG ALTRET (ERROR) ;

   6715  2 001357   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001360   000000 701000 xent               TSX1    TOU$DU_UPDATE_LOG
         2 001361   001367 702000 2                  TSX2    ERROR

      986     6716    4      CALL TOU$DFU_DF_WR_LOG ALTRET (ERROR) ;

   6716  2 001362   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001363   000000 701000 xent               TSX1    TOU$DFU_DF_WR_LOG
         2 001364   001367 702000 2                  TSX2    ERROR

      987     6717    4      RETURN ;

   6717  2 001365   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001366   000001 702211                    TSX2  ! 1,X1

      988     6718
      989     6719    4   ERROR:
      990     6720    4      ALTRETURN ;

   6720  2 001367   200010 221300       ERROR        LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001370   000000 702211                    TSX2  ! 0,X1

      991     6721
      992     6722    4   END NC_SAVE_LOG ;
      993     6723        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:125  
      994     6724        /*I*  NAME:        NC_SETUP_PRINT
      995     6725              AUTHOR:      Scott S. Sheppard
      996     6726              PURPOSE:     Assign Replacement Variables
      997     6727              INTERFACE:   None Called.
      998     6728              INPUT:       OBJECT.BCD.LIBRARY - used to determine GECALL or not
      999     6729                           OBJECT.BCD.CLASS   - used to determine ITR or MDR
     1000     6730                           BCD_B(BCD#-1)      - $DKEND card saved
     1001     6731                           H$NEWCAT_ITR     T$B_ITR
     1002     6732                           H$NEWCAT_MDR    T$B_MDR
     1003     6733                           H$NEWCAT_PROG   T$B_GECALL
     1004     6734              OUTPUT:      DUP.HDR_CODE  - set to correct heading
     1005     6735                           DUP.MSG_CODE  - used to write messages
     1006     6736                           ID.ID         - set for IDENT CODE field
     1007     6737                           ID.REVISION  - set for REV field
     1008     6738                           BIN#          - used in RECORD LENGTH field
     1009     6739                           DKEND         - $DKEND Card Structure
     1010     6740              DESCRIPTION: This procedure assigns variables needed values so
     1011     6741                           that TOU$REPLACE  will insert proper  values  for
     1012     6742                           the dummy ~strings.
     1013     6743        */
     1014     6744        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:126  
     1015     6745    3   NC_SETUP_PRINT: PROC ;

   6745  2 001371   200010 741300       NC_SETUP_PR* STX1  ! MATCHING_CATALOG+1,,AUTO

     1016     6746
     1017     6747        /* Code */
     1018     6748    4      BIN# = OBJECT.BINARY_COUNT ;

   6748  2 001372   000024 236000 xsym               LDQ     OBJECT+20
         2 001373   777777 376007                    ANQ     -1,DL
         2 001374   000000 756000 xsym               STQ     BIN#

     1019     6749
     1020     6750    4      IF OBJECT.BCD.LIBRARY = 'HMPCJ1'

   6750  2 001375   040000 106400                    CMPC    fill='040'O
         2 001376   000003 600006 xsym               ADSC9   OBJECT+3                 cn=3,n=6
         2 001377   000014 000006 1                  ADSC9   12                       cn=0,n=6
         2 001400   001474 601000 2                  TNZ     s:6769

     1021     6751    4      THEN IF OBJECT.BCD.CLASS = 'I' | OBJECT.BCD.CLASS = 'F'

   6751  2 001401   400000 220003                    LDX0    -131072,DU
         2 001402   000005 236000 xsym               LDQ     OBJECT+5
         2 001403   777000 376007                    ANQ     -512,DL
         2 001404   111000 116007                    CMPQ    37376,DL
         2 001405   001407 600000 2                  TZE     s:6751+6
         2 001406   000000 220003                    LDX0    0,DU
         2 001407   400000 222003                    LDX2    -131072,DU
         2 001410   000005 236000 xsym               LDQ     OBJECT+5
         2 001411   777000 376007                    ANQ     -512,DL
         2 001412   106000 116007                    CMPQ    35840,DL
         2 001413   001415 600000 2                  TZE     s:6751+12
         2 001414   000000 222003                    LDX2    0,DU
         2 001415   000000 636012                    EAQ     0,X2
         2 001416   200026 756100                    STQ     VALID_RESPONSE+1,,AUTO
         2 001417   000000 636010                    EAQ     0,X0
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:127  
         2 001420   200026 276100                    ORQ     VALID_RESPONSE+1,,AUTO
         2 001421   001453 600000 2                  TZE     s:6762

     1022     6752    5         THEN DO ;

     1023     6753    5                 IF OBJECT.BCD.CLASS = 'F'

   6753  2 001422   000005 236000 xsym               LDQ     OBJECT+5
         2 001423   777000 376007                    ANQ     -512,DL
         2 001424   106000 116007                    CMPQ    35840,DL
         2 001425   001432 601000 2                  TNZ     s:6755

     1024     6754    5                 THEN ID.ID = SUBSTR (OBJECT_KEY.DATA, 7, 6) ;

   6754  2 001426   040000 100400                    MLR     fill='040'O
         2 001427   000002 000006 xsym               ADSC9   OBJECT_KEY+2             cn=0,n=6
         2 001430   000000 000006 xsym               ADSC9   ID                       cn=0,n=6
         2 001431   001435 710000 2                  TRA     s:6756

     1025     6755    5                 ELSE ID.ID = SUBSTR (OBJECT_KEY.DATA, 4, 6) ;

   6755  2 001432   040000 100400                    MLR     fill='040'O
         2 001433   000001 200006 xsym               ADSC9   OBJECT_KEY+1             cn=1,n=6
         2 001434   000000 000006 xsym               ADSC9   ID                       cn=0,n=6

     1026     6756    5                 DKEND.BCD_ = BCD_B(BCD#-1) ;

   6756  2 001435   000000 236000 xsym               LDQ     BCD#
         2 001436   000124 402007                    MPY     84,DL
         2 001437   000103 470400 xsym               LDP0    DUP+67
         2 001440   040000 100506                    MLR     fill='040'O
         2 001441   077753 000120                    ADSC9   -21,Q,PR0                cn=0,n=80
         2 001442   000000 000120 xsym               ADSC9   DKEND                    cn=0,n=80

     1027     6757    5                 ID.REVISION = DKEND.BCD.REVISION ;

   6757  2 001443   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:128  
         2 001444   000020 400006 xsym               ADSC9   DKEND+16                 cn=2,n=6
         2 001445   000001 400006 xsym               ADSC9   ID+1                     cn=2,n=6

     1028     6758    5                 DUP.HDR_CODE = %H$NEWCAT_ITR ;

   6758  2 001446   001357 235007                    LDA     751,DL
         2 001447   000021 755000 xsym               STA     DUP+17

     1029     6759    5                 DUP.MSG_CODE = %T$B_ITR ;

   6759  2 001450   000031 235007                    LDA     25,DL
         2 001451   000020 755000 xsym               STA     DUP+16

     1030     6760    5              END /* THEN */ ;

   6760  2 001452   001500 710000 2                  TRA     s:6772

     1031     6761    5         ELSE DO ;

     1032     6762    5                 ID.ID = SUBSTR (OBJECT_KEY.DATA, 4, 6) ;

   6762  2 001453   040000 100400                    MLR     fill='040'O
         2 001454   000001 200006 xsym               ADSC9   OBJECT_KEY+1             cn=1,n=6
         2 001455   000000 000006 xsym               ADSC9   ID                       cn=0,n=6

     1033     6763    5                 DKEND.BCD_ = BCD_B(BCD#-1) ;

   6763  2 001456   000000 236000 xsym               LDQ     BCD#
         2 001457   000124 402007                    MPY     84,DL
         2 001460   000103 470400 xsym               LDP0    DUP+67
         2 001461   040000 100506                    MLR     fill='040'O
         2 001462   077753 000120                    ADSC9   -21,Q,PR0                cn=0,n=80
         2 001463   000000 000120 xsym               ADSC9   DKEND                    cn=0,n=80

     1034     6764    5                 ID.REVISION = DKEND.BCD.REVISION ;

   6764  2 001464   040000 100400                    MLR     fill='040'O
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:129  
         2 001465   000020 400006 xsym               ADSC9   DKEND+16                 cn=2,n=6
         2 001466   000001 400006 xsym               ADSC9   ID+1                     cn=2,n=6

     1035     6765    5                 DUP.HDR_CODE = %H$NEWCAT_MDR ;

   6765  2 001467   001360 235007                    LDA     752,DL
         2 001470   000021 755000 xsym               STA     DUP+17

     1036     6766    5                 DUP.MSG_CODE = %T$B_MDR ;

   6766  2 001471   000032 235007                    LDA     26,DL
         2 001472   000020 755000 xsym               STA     DUP+16

     1037     6767    5              END /* ELSE */ ;

   6767  2 001473   001500 710000 2                  TRA     s:6772

     1038     6768    5      ELSE DO ;

     1039     6769    5              DUP.HDR_CODE = %H$NEWCAT_PROG ;

   6769  2 001474   001361 235007                    LDA     753,DL
         2 001475   000021 755000 xsym               STA     DUP+17

     1040     6770    5              DUP.MSG_CODE = %T$B_GECALL ;

   6770  2 001476   000030 235007                    LDA     24,DL
         2 001477   000020 755000 xsym               STA     DUP+16

     1041     6771    5           END /* ELSE */ ;

     1042     6772    4      RETURN ;

   6772  2 001500   000001 702211                    TSX2  ! 1,X1

     1043     6773
     1044     6774    4   END NC_SETUP_PRINT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:130  
     1045     6775        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:131  
     1046     6776        /*I*  NAME:        NC_PRINT_ADDED_CATALOG
     1047     6777              AUTHOR:      Scott S. Sheppard
     1048     6778              PURPOSE:     Prints added Catalog line
     1049     6779              INTERFACE:   TOU$DU_USER_WRITE
     1050     6780                           TOU$DU_PRINTER_WRITE
     1051     6781              INPUT:       T$B_CATALOG
     1052     6782                           T$NC_INFORM
     1053     6783              OUTPUT:      DUP.MSG_CODE - integer message number
     1054     6784              DESCRIPTION: This procedure adds the completed catalog message
     1055     6785                           to the edit listing  by calling  TOU$DU_PRINTER_WRITE
     1056     6786                           with the proper message numbers. The catalog info
     1057     6787                           message is also displayed to the user.
     1058     6788        */
     1059     6789
     1060     6790    3   NC_PRINT_ADDED_CATALOG: PROC ;

   6790  2 001501   200010 741300       NC_PRINT_AD* STX1  ! MATCHING_CATALOG+1,,AUTO

     1061     6791
     1062     6792        /* Code */
     1063     6793
     1064     6794    4      DUP.MSG_CODE = %T$B_CATALOG ;

   6794  2 001502   000027 235007                    LDA     23,DL
         2 001503   000020 755000 xsym               STA     DUP+16

     1065     6795    4      CALL TOU$DU_PRINTER_WRITE ;

   6795  2 001504   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001505   000000 701000 xent               TSX1    TOU$DU_PRINTER_WRITE
         2 001506   000000 011000                    NOP     0

     1066     6796    4      DUP.MSG_CODE = %T$NC_INFORM ;

   6796  2 001507   000134 235007                    LDA     92,DL
         2 001510   000020 755000 xsym               STA     DUP+16

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:132  
     1067     6797    4      CALL TOU$DU_USER_WRITE ;

   6797  2 001511   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001512   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 001513   000000 011000                    NOP     0

     1068     6798    4      CALL TOU$DU_PRINTER_WRITE ;

   6798  2 001514   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001515   000000 701000 xent               TSX1    TOU$DU_PRINTER_WRITE
         2 001516   000000 011000                    NOP     0

     1069     6799    4      RETURN ;

   6799  2 001517   200010 221300                    LDX1  ! MATCHING_CATALOG+1,,AUTO
         2 001520   000001 702211                    TSX2  ! 1,X1

     1070     6800
     1071     6801    4   END NC_PRINT_ADDED_CATALOG ;
     1072     6802    3   END NC_PROCESS_TEMP ;
     1073     6803    2   END NC_ADD_CATALOG ;
     1074     6804        %EJECT ;
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:133  
     1075     6805        /*I*  NAME:        NC_ERR_MSG
     1076     6806              AUTHOR:      Scott S. Sheppard
     1077     6807              PURPOSE:     Build Error Message Reporter
     1078     6808              INTERFACE:   TOU$DU_USER_WRITE
     1079     6809              INPUT:       ERR_CODE - error message code
     1080     6810              OUTPUT:      DUP.MSG_CODE - set to appropriate message code
     1081     6811              DESCRIPTION: This procedure sets the error occurred flag to
     1082     6812                           true and reports the error.
     1083     6813        */
     1084     6814
     1085     6815    1   NC_ERR_MSG: PROC (ERR_CODE) ;

   6815  2 001521   200012 741300       NC_ERR_MSG   STX1  ! @CATALOG_KEYS_MATCH+1,,AUTO

     1086     6816
     1087     6817    2      DCL ERR_CODE                   UBIN WORD ALIGNED ;
     1088     6818
     1089     6819        /* Code */
     1090     6820
     1091     6821    2      DUP.MSG_CODE = ERR_CODE ;

   6821  2 001522   200013 470500                    LDP0    @ERR_CODE,,AUTO
         2 001523   000000 235100                    LDA     0,,PR0
         2 001524   000020 755000 xsym               STA     DUP+16

     1092     6822    2      CALL TOU$DU_USER_WRITE ;

   6822  2 001525   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 001526   000000 701000 xent               TSX1    TOU$DU_USER_WRITE
         2 001527   000000 011000                    NOP     0

     1093     6823    2      RETURN ;

   6823  2 001530   200012 221300                    LDX1  ! @CATALOG_KEYS_MATCH+1,,AUTO
         2 001531   000001 702211                    TSX2  ! 1,X1

CATALOG_SEARCH_KEY
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:134  
 Sect OctLoc
   0     000   040040 040040   040040 040040   040040 040040   040040 040040
   0     004   040040 040040   040*** ******                                         ...

(unnamed)
 Sect OctLoc
   1     000   111124 122040   123164 151154   154040 167151   163150 040164    ITR Still wish t
   1     004   157040 141144   144040 143141   164141 154157   147072 040040    o add catalog:
   1     010   131105 040040   131105 123040   116117 040040   176106 115040    YE  YES NO  ~FM
   1     014   110115 120103   112061 040040                                    HMPCJ1

(unnamed)
 Sect OctLoc
   3     000   777377 777777   131040 040040   116040 040040   000000 000673    ....Y   N   ....
   3     004   000003 006000   000000 006000   000000 000027   000002 006000    ................
   3     010   000006 006000   000027 006000   000012 006000   000005 006000    ................
   3     014   000000 000600   000014 006000   000000 000674   000016 006000    ................
     1094     6824
     1095     6825    2   END NC_ERR_MSG ;
     1096     6826    1   END TOU$NEWCAT ;

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:135  
--  Include file information  --

   XU_MACRO_C.:E05TOU  is referenced.
   TO_PERR_C.:E05TOU  is referenced.
   TOU_RQSTS_E.:E05TOU  is referenced.
   TOU_DEER_M.:E05TOU  is referenced.
      No diagnostics issued in procedure TOU$NEWCAT.
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:136  

 **** Procedure blocks ****

LB#    Line#s    #stmts #vars Sect# OctLoc  P A C   NP Lvl/name
  0    52-  6826    312    79     2      0  y   y    0   1 TOU$NEWCAT
  1  5854-  5870     12     0     2     44  y   y    0     2 NC_INIT_DUP
  2  5894-  6013     24     9     2     70  y y y    0     2 NC_COMMAND_SETUP
  3  6029-  6045     10     0     2    211  y y y    0     2 NC_SETUP_DF
  4  6067-  6167     46     2     2    241  y y y    0     2 NC_CHECK_FOR_CATALOG
  5  6114-  6166     28     5     2    333  y y y    0      3 NC_VERIFY_ADDITION
  6  6191-  6803    200     0     2    515  y y y    0     2 NC_ADD_CATALOG
  7  6240-  6538     95     1     2    571  y y y    0      3 NC_PROCESS_IFAD
  8  6302-  6313      5     2     2    715  y   y    1       4 NC_CHECK_MATCH
  9  6338-  6365     14     0     2    735  y y y    0       4 NC_STORE_OBJECT_DECK
 10  6380-  6392      6     0     2   1012  y y y    0       4 NC_STORE_CATALOG_ENTRY
 11  6410-  6424      8     0     2   1036  y y y    0       4 NC_STORE_SUBCATALOG
 12  6440-  6458     10     0     2   1063  y y y    0       4 NC_STORE_CATALOG
 13  6473-  6485      6     0     2   1103  y y y    0       4 NC_STORE_MASTER_ENTRY
 14  6499-  6509      4     0     2   1127  y y y    0       4 NC_STORE_MASTER_CATALOG
 15  6526-  6537      5     0     2   1137  y y y    0       4 NC_STORE_LAST_DECK#
 16  6563-  6802     86     0     2   1152  y y y    0      3 NC_PROCESS_TEMP
 17  6606-  6617      5     0     2   1256  y y y    0       4 NC_SAVE_MASTER_CONTROL
 18  6630-  6643      7     0     2   1271  y y y    0       4 NC_SAVE_MASTER_ENTRY
 19  6657-  6669      6     0     2   1312  y y y    0       4 NC_SAVE_SUBCATALOG
 20  6682-  6693      5     0     2   1330  y y y    0       4 NC_SAVE_CATALOG_ENTRY
 21  6707-  6722      9     0     2   1343  y y y    0       4 NC_SAVE_LOG
 22  6745-  6774     25     0     2   1371  y   y    0       4 NC_SETUP_PRINT
 23  6790-  6801      7     0     2   1501  y   y    0       4 NC_PRINT_ADDED_CATALOG
 24  6815-  6825      4     2     2   1521  y   y    1     2 NC_ERR_MSG
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:137  

    **** Executable statements  ****

  Exec cost Stmt Sec OctLoc Type   LB Label              Exec cost Stmt Sec OctLoc Type   LB Label

              52   2      0 Proc    0                              5814   2      2 Call    0
            5815   2      4 Call    0                              5816   2      6 Call    0
            5818   2     11 Call    0                              5819   2     14 Call    0
            5820   2     16 Call    0                              5821   2     20 Call    0
            5822   2     22 Call    0                              5825   2     25 Assign  0
            5826   2     27 Call    0                              5827   2     32 Return  0
            5830   2     33 Call    0 ERROR_RETURN                 5831   2     36 Assign  0
            5832   2     40 Call    0                              5833   2     43 Return  0
            5854   2     44 Proc    1                              5858   2     45 Assign  1
            5859   2     47 Assign  1                              5860   2     51 Assign  1
            5861   2     53 Assign  1                              5862   2     55 Assign  1
            5863   2     57 Assign  1                              5864   2     61 Assign  1
            5865   2     63 Assign  1                              5866   2     65 Assign  1
            5867   2     66 Assign  1                              5868   2     67 Return  1
            5894   2     70 Proc    2                              5984   2     71 DoIndx  2
         $  5985   2     73 Assign  2                       $$$$$  5986   2     77 DoCase  2
            5987   2    115 Case    2                              5988   2    115 Assign  2
         $  5989   2    117 Assign  2                              5990   2    125 Assign  2
            5991   2    130 Call    2                              5992   2    134 Case    2
         $  5993   2    134 Assign  2                              5994   2    143 Case    2
            5995   2    143 Assign  2                           $  5996   2    145 Assign  2
            5997   2    153 Assign  2                              5998   2    156 Call    2
            5999   2    161 EndCse  2                          $$  6000   2    161 EndInd  2
            6002   2    172 If      2                              6004   2    175 Call    2
            6005   2    200 If      2                              6007   2    202 Call    2
            6008   2    205 Return  2                              6011   2    207 Altret  2 ERROR
            6029   2    211 Proc    3                              6033   2    212 Call    3
            6034   2    215 Assign  3                              6035   2    220 Assign  3
            6036   2    223 Call    3                              6037   2    226 Assign  3
            6038   2    231 Assign  3                              6039   2    232 Call    3
            6040   2    235 Return  3                              6043   2    237 Altret  3 ERROR
            6067   2    241 Proc    4                              6074   2    242 Assign  4
         $  6075   2    243 Assign  4                              6076   2    246 DoUntl  4
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:138  
            6077   2    246 Call    4                              6078   2    251 If      4
            6079   2    255 Assign  4                         $$$  6080   2    260 Assign  4
        $$  6081   2    271 EndUnt  4                              6083   2    304 If      4
            6084   2    306 Do      4                              6085   2    306 Assign  4
            6086   2    310 Call    4                          $$  6087   2    313 IntCal  4
            6088   2    325 Call    4                              6090   2    327 Altret  4 ERROR
            6092   2    331 Do      4                              6094   2    331 Return  4 STILL_DO_IT
            6114   2    333 Proc    5                              6125   2    334 Assign  5
            6126   2    336 Call    5                              6129   2    341 Assign  5
            6130   2    344 Assign  5                              6131   2    346 Call    5
            6133   2    351 DoUntl  5                              6134   2    351 Assign  5
            6135   2    353 Call    5                              6136   2    356 Assign  5
            6139   2    361 Assign  5                              6140   2    362 DoWhil  5
            6141   2    363 Assign  5                        $$$$  6142   2    366 EndWhi  5
       $$$  6145   2    406 IntCal  5                  $$$$$$$$$$  6148   2    416 Do Sel  5
            6149   2    466 Select  5                              6150   2    466 Assign  5
            6151   2    471 Select  5                              6152   2    471 Assign  5
            6153   2    472 Assign  5                              6154   2    474 Call    5
            6155   2    477 EndSel  5                              6156   2    477 EndUnt  5
            6159   2    501 Call    5                           $  6162   2    504 If      5
            6163   2    511 Altret  5                              6164   2    513 Return  5
            6191   2    515 Proc    6                              6195   2    516 Assign  6
            6196   2    517 Call    6                              6197   2    522 Call    6
            6198   2    525 Call    6                              6199   2    530 Call    6
            6200   2    532 Call    6                              6201   2    535 Assign  6
            6202   2    536 Call    6                              6204   2    541 Assign  6
            6205   2    543 Call    6                              6206   2    546 Call    6
            6207   2    550 Assign  6                              6208   2    552 Call    6
            6209   2    555 Return  6                              6212   2    557 Call    6 ERROR
            6213   2    562 Assign  6                              6214   2    564 Call    6
            6215   2    567 Altret  6                              6240   2    571 Proc    7
            6246   2    572 Call    7                              6247   2    575 Assign  7
            6248   2    576 DoWhil  7                              6249   2    577 Call    7
            6250   2    601 Call    7                              6251   2    604 Call    7
            6252   2    607 DoWhil  7                              6253   2    611 Call    7
            6254   2    614 Call    7                              6255   2    617 Call    7
            6256   2    622 Call    7                              6257   2    624 Call    7
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:139  
            6258   2    627 Call    7                              6259   2    631 Call    7
            6260   2    634 EndWhi  7                              6261   2    636 Call    7
            6262   2    642 If      7                              6264   2    644 Do      7
            6265   2    644 Assign  7                              6266   2    646 Call    7
            6267   2    651 Call    7                              6268   2    654 Call    7
            6269   2    657 EndDo   7                           $  6270   2    657 EndWhi  7
            6272   2    666 If      7                              6273   2    670 Do      7
            6274   2    670 Call    7                              6275   2    672 Call    7
            6276   2    674 Call    7                              6277   2    676 Call    7
            6278   2    700 Call    7                              6279   2    702 Return  7
            6281   2    704 Do      7                              6282   2    704 Assign  7
            6283   2    707 Call    7                              6285   2    713 Altret  7 ERROR
            6302   2    715 Proc    8                              6308   2    716 If      8
       $$$  6309   2    722 Assign  8                         $$$  6310   2    727 Assign  8
            6311   2    733 Return  8                              6338   2    735 Proc    9
            6342   2    736 Assign  9                              6345   2    740 Assign  9
            6346   2    742 Assign  9                              6347   2    744 Assign  9
       $$$  6348   2    750 Call    9                              6352   2    764 Assign  9
            6355   2    767 Call    9                              6356   2    772 Assign  9
            6357   2    775 Call    9                              6358   2   1000 Assign  9
            6359   2   1003 Call    9                              6360   2   1006 Return  9
            6363   2   1010 Altret  9 ERROR                        6380   2   1012 Proc   10
            6384   2   1013 Call   10                         $$$  6385   2   1016 Assign 10
            6386   2   1027 Assign 10                              6387   2   1032 Return 10
            6390   2   1034 Altret 10 ERROR                        6410   2   1036 Proc   11
            6414   2   1037 Assign 11                              6415   2   1042 Assign 11
            6416   2   1045 Assign 11                              6417   2   1050 Call   11
            6418   2   1054 Call   11                              6419   2   1057 Return 11
            6422   2   1061 Altret 11 ERROR                        6440   2   1063 Proc   12
            6444   2   1064 If     12                              6445   2   1066 Do     12
            6446   2   1066 Call   12                              6448   2   1071 Assign 12
            6449   2   1072 Assign 12                              6450   2   1073 Return 12
            6452   2   1075 Do     12                              6453   2   1075 Call   12
            6455   2   1101 Altret 12 ERROR                        6473   2   1103 Proc   13
       $$$  6477   2   1104 Assign 13                              6478   2   1115 Assign 13
            6479   2   1120 Call   13                              6480   2   1123 Return 13
            6483   2   1125 Altret 13 ERROR                        6499   2   1127 Proc   14
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:140  
            6503   2   1130 Call   14                              6504   2   1133 Return 14
            6507   2   1135 Altret 14 ERROR                        6526   2   1137 Proc   15
            6530   2   1140 Assign 15                              6531   2   1143 Call   15
            6532   2   1146 Return 15                              6535   2   1150 Altret 15 ERROR
            6563   2   1152 Proc   16                              6567   2   1153 Assign 16
            6568   2   1155 Call   16                              6569   2   1157 Call   16
            6570   2   1161 Call   16                              6571   2   1164 Call   16
            6572   2   1166 Assign 16                           $  6573   2   1171 DoIndx 16
            6574   2   1175 Call   16                              6575   2   1177 Call   16
            6576   2   1202 Call   16                              6577   2   1204 Call   16
    $$$$$$  6578   2   1207 EndInd 16                              6579   2   1231 Call   16
            6581   2   1233 Call   16                              6582   2   1236 Call   16
            6583   2   1240 Assign 16                              6584   2   1242 Return 16
            6587   2   1244 Assign 16 ERROR                        6588   2   1246 Assign 16
            6589   2   1250 Call   16                              6590   2   1254 Altret 16
            6606   2   1256 Proc   17                              6610   2   1257 Call   17
            6611   2   1262 Call   17                              6612   2   1265 Return 17
            6615   2   1267 Altret 17 ERROR                        6630   2   1271 Proc   18
            6634   2   1272 Assign 18                              6635   2   1275 Assign 18
            6636   2   1300 Call   18                              6637   2   1303 Call   18
            6638   2   1306 Return 18                              6641   2   1310 Altret 18 ERROR
            6657   2   1312 Proc   19                              6661   2   1313 Assign 19
            6662   2   1316 Call   19                              6663   2   1321 Call   19
            6664   2   1324 Return 19                              6667   2   1326 Altret 19 ERROR
            6682   2   1330 Proc   20                              6686   2   1331 Call   20
            6687   2   1334 Call   20                              6688   2   1337 Return 20
            6691   2   1341 Altret 20 ERROR                        6707   2   1343 Proc   21
            6711   2   1344 Assign 21                              6712   2   1346 Assign 21
            6713   2   1351 Assign 21                              6714   2   1354 Assign 21
            6715   2   1357 Call   21                              6716   2   1362 Call   21
            6717   2   1365 Return 21                              6720   2   1367 Altret 21 ERROR
            6745   2   1371 Proc   22                              6748   2   1372 Assign 22
            6750   2   1375 If     22                        $$$$  6751   2   1401 If     22
            6752   2   1422 Do     22                              6753   2   1422 If     22
            6754   2   1426 Assign 22                              6755   2   1432 Assign 22
       $$$  6756   2   1435 Assign 22                              6757   2   1443 Assign 22
            6758   2   1446 Assign 22                              6759   2   1450 Assign 22
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:141  
            6760   2   1452 EndDo  22                              6761   2   1453 Do     22
            6762   2   1453 Assign 22                         $$$  6763   2   1456 Assign 22
            6764   2   1464 Assign 22                              6765   2   1467 Assign 22
            6766   2   1471 Assign 22                              6767   2   1473 EndDo  22
            6768   2   1474 Do     22                              6769   2   1474 Assign 22
            6770   2   1476 Assign 22                              6771   2   1500 EndDo  22
            6772   2   1500 Return 22                              6790   2   1501 Proc   23
            6794   2   1502 Assign 23                              6795   2   1504 Call   23
            6796   2   1507 Assign 23                              6797   2   1511 Call   23
            6798   2   1514 Call   23                              6799   2   1517 Return 23
            6815   2   1521 Proc   24                              6821   2   1522 Assign 24
            6822   2   1525 Call   24                              6823   2   1530 Return 24


  **** Statement type totals  ****

    95 Assign    96 Call      12 If         3 Case      26 Return    19 Altret
     2 IntCal     1 Do Sel     1 EndSel     2 Select     2 DoUntl     2 DoIndx
     3 DoWhil     1 DoCase    10 Do         2 EndUnt     2 EndInd     3 EndWhi
     1 EndCse     4 EndDo     25 Proc      20 Labels

 # major stmts=  262 Code/major= 3.27 # stmts=  312 Code/stmt= 2.75  Point total=105.5
 Cost/major stmt=  2.7 Cost/stmt=  2.3 Total cost=    719.8

   0-4  $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
   4-6  $$
   6-8  $
  8-10  $$$
 10-12
 12-14
 14-16
 16-18
 18-20
 20-22
 22-??
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:142  

 **** Variables and constants ****

  ****  Section 000  Data  TOU$NEWCAT

  ****  Structures  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(189)   r     1 CATALOG_SEARCH_KEY
     0-0-0/c CHAR(21)    r         2 DATA


  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

    11-0-0/w PTR         r     1 @CATALOG_KEYS_MATCH       13-0-0/w PTR         r     1 @ERR_CODE
    24-0-0/w UBIN        r     1 BL_INX                    *0-0-0/c BIT         r     1 CATALOG_KEYS_MATCH
    23-0-0/w UBIN        r     1 CHR_INX                   *0-0-0/w UBIN        r     1 ERR_CODE
     5-0-0/c BIT         r     1 FOUND                      6-0-0/w UBIN        r     1 ITR_INX
     7-0-0/c BIT         r     1 MATCHING_CATALOG           5-0-0/w UBIN        r     1 OUTBLK#
     6-0-0/w PTR         r     1 OUTBLK$
    11-0-0/c CHAR        r     1 RESPONSE(0:39)
    11-0-0/c CHAR(40)    r     1 RESPONSE_                 25-0-0/b BIT         r     1 VALID_RESPONSE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w UBIN        r     1 BCD#                       0-0-0/w UBIN        r     1 BIN#
     0-0-0/c BIT         r     1 CATALOG_KEY_SET            0-0-0/c BIT         r     1 DECK_SAVED
     0-0-0/w UBIN        r     1 FILE_EOF

  ****  Structures  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name

PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:143  
     0-0-0/c STRC(45)    r     1 BCD_KEY
     0-1-0/b UBIN(18)    r         2 DECK#

     0-0-0/c STRC(45)    r     1 BINARY_KEY
     0-1-0/b UBIN(18)    r         2 DECK#

     0-0-0/w STRC(72)    r     1 CATALOG_DATA
     0-0-0/b UBIN(18)    r         2 DECK#
     0-2-0/b UBIN(18)    r         2 ENTRY_COUNT

     0-0-0/c STRC(45)    r     1 CATALOG_ENTRY_KEY
     0-1-0/b UBIN(18)    r         2 DECK#
     0-3-0/b UBIN(18)    r         2 ENTRY#

     0-0-0/w STRC(216)   r     1 CATALOG_KEY
     0-1-0/c CHAR(21)    r         2 DATA

     0-0-0/w STRC(756)   r     1 DKEND
     0-0-0/c STRC(720)   r         2 BCD
    20-2-0/c CHAR(6)     r          3 REVISION
     0-0-0/c CHAR(80)    r         2 BCD_

     0-0-0/d STRC(5220)  r     1 DUP
     4-0-0/c CHAR(40)    r         2 RESPONSE
    16-0-0/w UBIN        r         2 RESPONSE_LGTH
    17-0-0/w PTR         r         2 CMD$
    20-0-0/w UBIN        r         2 MSG_CODE
    21-0-0/w UBIN        r         2 HDR_CODE
    26-0-0/c CHAR        r         2 LINE_VFC
    56-0-0/c BIT         r         2 FORCE_NEW_PAGE
    57-0-0/w STRC(576)   r         2 IFAD
    57-0-0/c BIT         r          3 ME_ALLOWED
    57-1-0/c BIT         r          3 ENTERED
    63-1-0/c CHAR(40)    r          3 FID
   102-0-0/d STRC(72)    r         2 BCD_V
   103-0-0/b PTR         r          3 PTR$
   104-0-0/w STRC(504)   r         2 DF
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:144  
   104-0-0/c BIT         r          3 ENTERED
   104-2-0/c BIT         r          3 REPORT_ERROR
   105-0-0/w UBIN        r          3 OPEN_TYPE
   106-0-0/w UBIN        r          3 CLOSE_TYPE
   122-0-0/w STRC(432)   r         2 LOG
   122-0-0/w UBIN        r          3 TYPE
   123-0-0/c CHAR(21)    r          3 CATALOG
   130-1-0/c CHAR(23)    r          3 DECK
   140-0-0/w STRC(72)    r         2 TEMP
   140-0-0/w UBIN        r          3 OPEN_TYPE
   141-0-0/w UBIN        r          3 CLOSE_TYPE
   142-0-0/c CHAR(40)    r         2 HOLD_AREA
   154-0-0/w UBIN        r         2 HOLD_AREA_LGTH
   155-1-0/c BIT         r         2 BREAK_DISABLED

     0-0-0/c STRC(162)   r     1 ID
     0-0-0/c CHAR(6)     r         2 ID
     1-2-0/c CHAR(6)     r         2 REVISION

     0-0-0/c STRC(54)    r     1 LAST
     0-0-0/c UBIN(18)    r         2 DECK#

     0-0-0/w STRC(72)    r     1 MASTER_DATA
     0-0-0/b UBIN(18)    r         2 DECK#
     0-2-0/b UBIN(18)    r         2 ENTRY_COUNT

     0-0-0/c STRC(45)    r     1 MASTER_ENTRY_KEY
     0-1-0/b UBIN(18)    r         2 DECK#
     0-3-0/b UBIN(18)    r         2 ENTRY#

     0-0-0/w STRC(864)   r     1 OBJECT
     0-0-0/w STRC(720)   r         2 BCD
     3-3-0/c CHAR(6)     r          3 LIBRARY
     5-2-0/c CHAR        r          3 CLASS
    24-0-0/b UBIN(18)    r         2 DECK#
    24-2-0/b UBIN(18)    r         2 BINARY_COUNT
    25-0-0/b UBIN(18)    r         2 TOTAL_COUNT
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:145  
    27-0-0/w UBIN        r         2 CHECKSUM

     0-0-0/w STRC(216)   r     1 OBJECT_KEY
     0-1-0/c CHAR(23)    r         2 DATA

     0-0-0/c STRC(468)   r     1 SUBCATALOG_DATA
     0-0-0/c CHAR(40)    r         2 IFAD_FID
    12-0-0/c CHAR(12)    r         2 IFAD_FN

     0-0-0/c STRC(45)    r     1 SUBCATALOG_KEY
     0-1-0/b UBIN(18)    r         2 DECK#


  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(84)    r     1 BCD_B(0:199)

  ****  Structures  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(144)   r     1 OUT$BLK
     0-2-0/h UBIN(18)    r         2 CODE
     1-0-0/h UBIN(18)    r         2 NSUBLKS
     3-0-0/b PTR         r         2 SUBLK$(0:0)

     0-0-0/w ASTR(153)   r     1 OUT$SYM
     4-0-0/c UBIN(9)     r         2 COUNT
     4-1-0/c ACHR        r         2 TEXT



   Procedure TOU$NEWCAT requires 858 words for executable code.
   Procedure TOU$NEWCAT requires 28 words of local(AUTO) storage.
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:146  

    No errors detected in file TOU$NEWCAT.:E05TSI    .
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:147  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:148  
          MINI XREF LISTING

BCD#
      5735**DCL      6347>>ASSIGN   6756>>ASSIGN   6763>>ASSIGN
BCD_B
      5388**DCL      6756>>ASSIGN   6763>>ASSIGN
BCD_CARD
      5400**DCL      5409--REDEF
BCD_CARD.BCD
      5401**DCL      5407--REDEF
BCD_KEY.DECK#
      5422**DCL      6358<<ASSIGN
BIN#
      5736**DCL      6346>>ASSIGN   6347>>ASSIGN   6748<<ASSIGN
BINARY_CARD
      5434**DCL      5449--REDEF
BINARY_CARD.DATA
      5443**DCL      5444--REDEF
BINARY_CARD.LBL_SEQ
      5445**DCL      5446--REDEF
BINARY_CARD.WD1
      5435**DCL      5440--REDEF
BINARY_KEY.DECK#
      5463**DCL      6356<<ASSIGN
BL_INX IN PROCEDURE NC_VERIFY_ADDITION
      6119**DCL      6145<<CALLBLT  6148>>DOSELCT
CATALOG_DATA.DECK#
      5476**DCL      6414>>ASSIGN   6572>>ASSIGN   6661>>ASSIGN
CATALOG_DATA.ENTRY_COUNT
      5477**DCL      6386<<ASSIGN   6386>>ASSIGN   6573>>DOINDEX
CATALOG_ENTRY_KEY.DECK#
      5491**DCL      6572<<ASSIGN
CATALOG_ENTRY_KEY.ENTRY#
      5492**DCL      6385<<ASSIGN   6385>>ASSIGN   6573<<DOINDEX
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:149  
CATALOG_KEY.DATA
      5505**DCL      6078>>IF       6087>>CALLBLT  6282<<ASSIGN   6308>>IF       6712>>ASSIGN
CATALOG_KEYS_MATCH IN PROCEDURE NC_CHECK_MATCH
      6304**DCL      6302--PROC     6309<<ASSIGN   6310<<ASSIGN
CATALOG_KEY_SET
      5737**DCL      6038<<ASSIGN   6444>>IF       6448<<ASSIGN
CATALOG_SEARCH_KEY.DATA
      5518**DCL      5993<<ASSIGN   6078>>IF       6282>>ASSIGN   6308>>IF
CHR_INX IN PROCEDURE NC_VERIFY_ADDITION
      6118**DCL      6139<<ASSIGN   6140>>DOWHILE  6140>>DOWHILE  6141<<ASSIGN   6141>>ASSIGN   6145>>CALLBLT
      6148>>DOSELCT  6148>>DOSELCT  6162>>IF
DECK_SAVED
      5738**DCL      5867<<ASSIGN   6342<<ASSIGN   6449<<ASSIGN
DKEND
      5529**DCL      5542--REDEF
DKEND.BCD
      5530**DCL      5540--REDEF
DKEND.BCD.REVISION
      5537**DCL      6757>>ASSIGN   6764>>ASSIGN
DKEND.BCD_
      5540**DCL      6756<<ASSIGN   6763<<ASSIGN
DUP.BCD_V.PTR$
      5319**DCL      5388--IMP-PTR  6756>>ASSIGN   6763>>ASSIGN
DUP.BREAK_DISABLED
      5365**DCL      6567<<ASSIGN   6583<<ASSIGN   6587<<ASSIGN
DUP.CMD$
      5263**DCL      5984>>DOINDEX  5985>>ASSIGN
DUP.DF.CLOSE_TYPE
      5331**DCL      5866<<ASSIGN   6588<<ASSIGN
DUP.DF.ENTERED
      5323**DCL      5863<<ASSIGN   5995<<ASSIGN   6005>>IF
DUP.DF.OPEN_TYPE
      5329**DCL      5864<<ASSIGN
DUP.DF.REPORT_ERROR
      5327**DCL      5865<<ASSIGN
DUP.FORCE_NEW_PAGE
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:150  
      5287**DCL      5860<<ASSIGN
DUP.HDR_CODE
      5268**DCL      5858<<ASSIGN   6758<<ASSIGN   6765<<ASSIGN   6769<<ASSIGN
DUP.HOLD_AREA
      5358**DCL      5989<<ASSIGN   5996<<ASSIGN   6129<<ASSIGN   6714<<ASSIGN
DUP.HOLD_AREA_LGTH
      5360**DCL      5990<<ASSIGN   5997<<ASSIGN   6130<<ASSIGN
DUP.IFAD.ENTERED
      5293**DCL      5862<<ASSIGN   5988<<ASSIGN   6002>>IF
DUP.IFAD.FID
      5307**DCL      6415>>ASSIGN   6714>>ASSIGN
DUP.IFAD.ME_ALLOWED
      5291**DCL      5861<<ASSIGN
DUP.LINE_VFC
      5277**DCL      5859<<ASSIGN
DUP.LOG.CATALOG
      5341**DCL      6712<<ASSIGN
DUP.LOG.DECK
      5343**DCL      6713<<ASSIGN
DUP.LOG.TYPE
      5339**DCL      6711<<ASSIGN
DUP.LOG_V
      5345**DCL      5350--REDEF
DUP.MSG_CODE
      5266**DCL      5825<<ASSIGN   5831<<ASSIGN   6085<<ASSIGN   6125<<ASSIGN   6153<<ASSIGN   6759<<ASSIGN
      6766<<ASSIGN   6770<<ASSIGN   6794<<ASSIGN   6796<<ASSIGN   6821<<ASSIGN
DUP.RESPONSE
      5259**DCL      6136>>ASSIGN
DUP.RESPONSE_LGTH
      5261**DCL      6134<<ASSIGN
DUP.TEMP.CLOSE_TYPE
      5355**DCL      6201<<ASSIGN   6207<<ASSIGN   6213<<ASSIGN   6265<<ASSIGN
DUP.TEMP.OPEN_TYPE
      5353**DCL      6195<<ASSIGN   6204<<ASSIGN
ERROR IN PROCEDURE NC_ADD_CATALOG
      6212**LABEL    6196--CALLALT  6197--CALLALT  6199--CALLALT  6200--CALLALT  6202--CALLALT  6205--CALLALT
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:151  
      6206--CALLALT  6208--CALLALT
ERROR IN PROCEDURE NC_CHECK_FOR_CATALOG
      6090**LABEL    6077--CALLALT  6087--CALLALT
ERROR IN PROCEDURE NC_COMMAND_SETUP
      6011**LABEL    5991--CALLALT  5998--CALLALT  6004--CALLALT  6007--CALLALT
ERROR IN PROCEDURE NC_PROCESS_IFAD
      6285**LABEL    6246--CALLALT  6251--CALLALT  6253--CALLALT  6254--CALLALT  6255--CALLALT  6256--CALLALT
      6257--CALLALT  6258--CALLALT  6259--CALLALT  6266--CALLALT  6267--CALLALT  6268--CALLALT  6274--CALLALT
      6275--CALLALT  6276--CALLALT  6277--CALLALT  6278--CALLALT
ERROR IN PROCEDURE NC_PROCESS_TEMP
      6587**LABEL    6568--CALLALT  6569--CALLALT  6570--CALLALT  6571--CALLALT  6574--CALLALT  6575--CALLALT
      6581--CALLALT  6582--CALLALT
ERROR IN PROCEDURE NC_SAVE_CATALOG_ENTRY
      6691**LABEL    6686--CALLALT  6687--CALLALT
ERROR IN PROCEDURE NC_SAVE_LOG
      6720**LABEL    6715--CALLALT  6716--CALLALT
ERROR IN PROCEDURE NC_SAVE_MASTER_CONTROL
      6615**LABEL    6610--CALLALT  6611--CALLALT
ERROR IN PROCEDURE NC_SAVE_MASTER_ENTRY
      6641**LABEL    6636--CALLALT  6637--CALLALT
ERROR IN PROCEDURE NC_SAVE_SUBCATALOG
      6667**LABEL    6662--CALLALT  6663--CALLALT
ERROR IN PROCEDURE NC_SETUP_DF
      6043**LABEL    6033--CALLALT  6036--CALLALT  6039--CALLALT
ERROR IN PROCEDURE NC_STORE_CATALOG
      6455**LABEL    6446--CALLALT
ERROR IN PROCEDURE NC_STORE_CATALOG_ENTRY
      6390**LABEL    6384--CALLALT
ERROR IN PROCEDURE NC_STORE_LAST_DECK#
      6535**LABEL    6531--CALLALT
ERROR IN PROCEDURE NC_STORE_MASTER_CATALOG
      6507**LABEL    6503--CALLALT
ERROR IN PROCEDURE NC_STORE_MASTER_ENTRY
      6483**LABEL    6479--CALLALT
ERROR IN PROCEDURE NC_STORE_OBJECT_DECK
      6363**LABEL    6355--CALLALT  6357--CALLALT  6359--CALLALT
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:152  
ERROR IN PROCEDURE NC_STORE_SUBCATALOG
      6422**LABEL    6418--CALLALT
ERROR_RETURN
      5830**LABEL    5815--CALLALT  5818--CALLALT  5819--CALLALT  5820--CALLALT  5821--CALLALT  5822--CALLALT
ERR_CODE IN PROCEDURE NC_ERR_MSG
      6817**DCL      6815--PROC     6821>>ASSIGN
FILE_EOF
      5739**DCL      6248>>DOWHILE  6252>>DOWHILE
FOUND IN PROCEDURE NC_CHECK_FOR_CATALOG
      6069**DCL      6074<<ASSIGN   6076>>DOUNTIL  6079<<ASSIGN   6083>>IF
ID.ID
      5554**DCL      6754<<ASSIGN   6755<<ASSIGN   6762<<ASSIGN
ID.REVISION
      5555**DCL      5556--REDEF    6757<<ASSIGN   6764<<ASSIGN
ITR_INX IN PROCEDURE NC_CHECK_FOR_CATALOG
      6070**DCL      6087<<CALLBLT
LAST.DECK#
      5571**DCL      6037<<ASSIGN   6037>>ASSIGN   6345>>ASSIGN   6352<<ASSIGN   6352>>ASSIGN   6530<<ASSIGN
      6530>>ASSIGN
MASTER_DATA.DECK#
      5584**DCL      6034>>ASSIGN   6634>>ASSIGN
MASTER_DATA.ENTRY_COUNT
      5585**DCL      6035>>ASSIGN   6076>>DOUNTIL  6478<<ASSIGN   6478>>ASSIGN   6635>>ASSIGN
MASTER_ENTRY_KEY.DECK#
      5599**DCL      6034<<ASSIGN   6634<<ASSIGN
MASTER_ENTRY_KEY.ENTRY#
      5600**DCL      6035<<ASSIGN   6075<<ASSIGN   6076>>DOUNTIL  6080<<ASSIGN   6080>>ASSIGN   6477<<ASSIGN
      6477>>ASSIGN   6635<<ASSIGN
MATCHING_CATALOG IN PROCEDURE NC_PROCESS_IFAD
      6242**DCL      6247<<ASSIGN   6248>>DOWHILE  6261<>CALL     6262>>IF       6272>>IF
NC_ADD_CATALOG
      6191**PROC     5821--CALL
NC_CHECK_FOR_CATALOG
      6067**PROC     5820--CALL
NC_CHECK_MATCH IN PROCEDURE NC_PROCESS_IFAD
      6302**PROC     6261--CALL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:153  
NC_COMMAND_SETUP
      5894**PROC     5815--CALL
NC_ERR_MSG
      6815**PROC     6283--CALL     6453--CALL     6589--CALL
NC_INIT_DUP
      5854**PROC     5814--CALL
NC_PRINT_ADDED_CATALOG IN PROCEDURE NC_PROCESS_TEMP
      6790**PROC     6579--CALL
NC_PROCESS_IFAD IN PROCEDURE NC_ADD_CATALOG
      6240**PROC     6199--CALL
NC_PROCESS_TEMP IN PROCEDURE NC_ADD_CATALOG
      6563**PROC     6206--CALL
NC_SAVE_CATALOG_ENTRY IN PROCEDURE NC_PROCESS_TEMP
      6682**PROC     6574--CALL
NC_SAVE_LOG IN PROCEDURE NC_PROCESS_TEMP
      6707**PROC     6582--CALL
NC_SAVE_MASTER_CONTROL IN PROCEDURE NC_PROCESS_TEMP
      6606**PROC     6568--CALL
NC_SAVE_MASTER_ENTRY IN PROCEDURE NC_PROCESS_TEMP
      6630**PROC     6569--CALL
NC_SAVE_SUBCATALOG IN PROCEDURE NC_PROCESS_TEMP
      6657**PROC     6571--CALL
NC_SETUP_DF
      6029**PROC     5819--CALL     6249--CALL
NC_SETUP_PRINT IN PROCEDURE NC_PROCESS_TEMP
      6745**PROC     6576--CALL
NC_STORE_CATALOG IN PROCEDURE NC_PROCESS_IFAD
      6440**PROC     6275--CALL
NC_STORE_CATALOG_ENTRY IN PROCEDURE NC_PROCESS_IFAD
      6380**PROC     6258--CALL
NC_STORE_LAST_DECK# IN PROCEDURE NC_PROCESS_IFAD
      6526**PROC     6278--CALL
NC_STORE_MASTER_CATALOG IN PROCEDURE NC_PROCESS_IFAD
      6499**PROC     6277--CALL
NC_STORE_MASTER_ENTRY IN PROCEDURE NC_PROCESS_IFAD
      6473**PROC     6276--CALL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:154  
NC_STORE_OBJECT_DECK IN PROCEDURE NC_PROCESS_IFAD
      6338**PROC     6256--CALL
NC_STORE_SUBCATALOG IN PROCEDURE NC_PROCESS_IFAD
      6410**PROC     6274--CALL
NC_VERIFY_ADDITION IN PROCEDURE NC_CHECK_FOR_CATALOG
      6114**PROC     6088--CALL
OBJECT
      5611**DCL      6348--CALL
OBJECT.BCD
      5612**DCL      5634--REDEF    5657--REDEF
OBJECT.BCD.CLASS
      5617**DCL      6751>>IF       6751>>IF       6753>>IF
OBJECT.BCD.LIBRARY
      5615**DCL      6750>>IF
OBJECT.BINARY_COUNT
      5659**DCL      6346<<ASSIGN   6748>>ASSIGN
OBJECT.CHECKSUM
      5663**DCL      6348<>CALL
OBJECT.DECK#
      5658**DCL      6345<<ASSIGN   6356>>ASSIGN   6358>>ASSIGN
OBJECT.NIO_BCD.X_OF_N
      5645**DCL      5650--REDEF
OBJECT.TOTAL_COUNT
      5660**DCL      6347<<ASSIGN
OBJECT_KEY.DATA
      5676**DCL      6754>>ASSIGN   6755>>ASSIGN   6762>>ASSIGN
OUT$BLK.CODE IN PROCEDURE NC_COMMAND_SETUP
      5912**DCL      5986>>DOCASE
OUT$BLK.NSUBLKS IN PROCEDURE NC_COMMAND_SETUP
      5916**DCL      5984>>DOINDEX
OUT$BLK.SUBLK$ IN PROCEDURE NC_COMMAND_SETUP
      5937**DCL      5985>>ASSIGN
OUT$SYM.COUNT IN PROCEDURE NC_COMMAND_SETUP
      5973**DCL      5976--IMP-SIZ  5989>>ASSIGN   5990>>ASSIGN   5993>>ASSIGN   5996>>ASSIGN   5997>>ASSIGN
OUT$SYM.TEXT IN PROCEDURE NC_COMMAND_SETUP
      5976**DCL      5989>>ASSIGN   5993>>ASSIGN   5996>>ASSIGN
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:155  
OUTBLK# IN PROCEDURE NC_COMMAND_SETUP
      5896**DCL      5984<<DOINDEX  5985>>ASSIGN
OUTBLK$ IN PROCEDURE NC_COMMAND_SETUP
      5897**DCL      5985<<ASSIGN   5986>>DOCASE   5989>>ASSIGN   5989>>ASSIGN   5990>>ASSIGN   5993>>ASSIGN
      5993>>ASSIGN   5996>>ASSIGN   5996>>ASSIGN   5997>>ASSIGN
RECORD.BCD
      5690**DCL      5694--REDEF    5703--REDEF
RECORD.BINARY.DATA.BINARY
      5696**DCL      5697--REDEF
RESPONSE IN PROCEDURE NC_VERIFY_ADDITION
      6117**DCL      6140>>DOWHILE  6162>>IF
RESPONSE_ IN PROCEDURE NC_VERIFY_ADDITION
      6116**DCL      6117--REDEF    6136<<ASSIGN   6145>>CALLBLT  6148>>DOSELCT
STILL_DO_IT IN PROCEDURE NC_CHECK_FOR_CATALOG
      6094**LABEL    6088--CALLALT
SUBCATALOG_DATA.IFAD_FID
      5715**DCL      6415<<ASSIGN
SUBCATALOG_DATA.IFAD_FN
      5716**DCL      6416<<ASSIGN   6417<>CALL
SUBCATALOG_KEY.DECK#
      5729**DCL      6414<<ASSIGN   6661<<ASSIGN
TOU$B_CHECK_CORRECT_FILE
      5769**DCL-ENT  6257--CALL
TOU$B_GET_CATALOG
      5766**DCL-ENT  6250--CALL
TOU$B_PRINT_DECK_LINE
      5770**DCL-ENT  6577--CALL
TOU$B_SET_CATALOG_KEY
      5767**DCL-ENT  6251--CALL
TOU$B_SET_OBJECT_KEY
      5768**DCL-ENT  6255--CALL
TOU$B_SHOW_DCBS
      5765**DCL-ENT  5816--CALL
TOU$CHECKSUM
      5758**DCL-ENT  6348--CALL
TOU$CLEAR_IFAD
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:156  
      5759**DCL-ENT  6198--CALL
TOU$DFU_CLOSE_TEMP
      5791**DCL-ENT  6202--CALL     6208--CALL     6214--CALL     6266--CALL
TOU$DFU_DF_RD_LAST_DECK#
      5779**DCL-ENT  6036--CALL
TOU$DFU_DF_RD_LOG
      5780**DCL-ENT  6039--CALL
TOU$DFU_DF_RD_MASTER_CONTROL
      5777**DCL-ENT  6033--CALL
TOU$DFU_DF_RD_MASTER_ENTRY
      5778**DCL-ENT  6077--CALL
TOU$DFU_DF_WR_CATALOG_ENTRY
      5785**DCL-ENT  6687--CALL
TOU$DFU_DF_WR_LOG
      5786**DCL-ENT  6716--CALL
TOU$DFU_DF_WR_MASTER_CONTROL
      5782**DCL-ENT  6611--CALL
TOU$DFU_DF_WR_MASTER_ENTRY
      5783**DCL-ENT  6637--CALL
TOU$DFU_DF_WR_SUBCATALOG
      5784**DCL-ENT  6663--CALL
TOU$DFU_OPEN_TEMP
      5790**DCL-ENT  6196--CALL     6205--CALL     6267--CALL
TOU$DFU_TF_RD_CATALOG_ENTRY
      5796**DCL-ENT  6686--CALL
TOU$DFU_TF_RD_MASTER_CONTROL
      5793**DCL-ENT  6610--CALL
TOU$DFU_TF_RD_MASTER_ENTRY
      5794**DCL-ENT  6636--CALL
TOU$DFU_TF_RD_SUBCATALOG
      5795**DCL-ENT  6662--CALL
TOU$DFU_TF_WR_BCD_CARDS
      5805**DCL-ENT  6359--CALL
TOU$DFU_TF_WR_BINARY
      5804**DCL-ENT  6357--CALL
TOU$DFU_TF_WR_CATALOG_CONTROL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:157  
      5800**DCL-ENT  6446--CALL
TOU$DFU_TF_WR_CATALOG_ENTRY
      5802**DCL-ENT  6384--CALL
TOU$DFU_TF_WR_LAST_DECK#
      5806**DCL-ENT  6531--CALL
TOU$DFU_TF_WR_MASTER_CONTROL
      5798**DCL-ENT  6503--CALL
TOU$DFU_TF_WR_MASTER_ENTRY
      5799**DCL-ENT  6479--CALL
TOU$DFU_TF_WR_OBJECT
      5803**DCL-ENT  6355--CALL
TOU$DFU_TF_WR_SUBCATALOG
      5801**DCL-ENT  6418--CALL
TOU$DU_CLOSE_DF
      5749**DCL-ENT  5822--CALL     5830--CALL
TOU$DU_CLOSE_IFAD
      5745**DCL-ENT  6200--CALL     6212--CALL
TOU$DU_OPEN_DF
      5748**DCL-ENT  5818--CALL
TOU$DU_OPEN_IFAD
      5744**DCL-ENT  6197--CALL
TOU$DU_PRINTER_WRITE
      5755**DCL-ENT  6795--CALL     6798--CALL
TOU$DU_SET_DF_FID
      5747**DCL-ENT  5998--CALL     6007--CALL
TOU$DU_SET_EDIT_PROMPT
      5751**DCL-ENT  6159--CALL
TOU$DU_SET_IFAD_FID
      5743**DCL-ENT  5991--CALL     6004--CALL
TOU$DU_SET_PROMPT
      5752**DCL-ENT  6131--CALL
TOU$DU_UPDATE_LOG
      5756**DCL-ENT  6715--CALL
TOU$DU_USER_READ
      5753**DCL-ENT  6135--CALL
TOU$DU_USER_WRITE
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:158  
      5754**DCL-ENT  5826--CALL     5832--CALL     6086--CALL     6126--CALL     6154--CALL     6797--CALL
      6822--CALL
TOU$GET_BCD_CARDS
      5764**DCL-ENT  6254--CALL
TOU$GET_BINARY_CARDS
      5763**DCL-ENT  6253--CALL
TOU$GET_CP6_OBJECT
      5762**DCL-ENT  6246--CALL     6259--CALL     6268--CALL
TOU$ND_SAVE_CATALOG_CONTROL
      5771**DCL-ENT  6570--CALL
TOU$ND_SAVE_LAST_DECK#
      5773**DCL-ENT  6581--CALL
TOU$ND_SAVE_OBJECT_DECK
      5772**DCL-ENT  6575--CALL
TOU$REPLACE
      5760**DCL-ENT  6417--CALL
VALID_RESPONSE IN PROCEDURE NC_VERIFY_ADDITION
      6120**DCL      6133>>DOUNTIL  6150<<ASSIGN   6152<<ASSIGN
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:159  
              *** CROSS REFERENCE LISTING ***
    **     DENOTES     IDENTIFIER DEFINITION
    <<                 IDENTIFIER'S VALUE SET
    >>                 IDENTIFIER'S VALUE USED
    <>                 IDENTIFIER SET AND/OR USED
    --                 IDENTIFIER REFERENCED
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:160  
              FULL UREF LISTING

BCD_CARD.BCD.CONTROL
      5402**DCL
BCD_CARD.BCD.DATA
      5404**DCL
BCD_CARD.BCD.LBL
      5405**DCL
BCD_CARD.BCD.SEQ
      5406**DCL
BCD_CARD.BCD.TYPE
      5403**DCL
BCD_CARD.BCD_
      5407**DCL
BCD_CARD.CHECKSUM
      5408**DCL
BCD_CARD_
      5409**DCL
BCD_KEY
      5420**DCL
BCD_KEY.CARD#
      5423**DCL
BCD_KEY.SIZE
      5421**DCL
BINARY_CARD.CHECKSUM
      5441**DCL
BINARY_CARD.DATA_CHAR
      5444**DCL
BINARY_CARD.LABEL_
      5446**DCL
BINARY_CARD.LABEL_.LBL
      5447**DCL
BINARY_CARD.LABEL_.SEQ
      5448**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:161  
BINARY_CARD.RELOCATION
      5442**DCL
BINARY_CARD.WD1.ADDRESS
      5439**DCL
BINARY_CARD.WD1.SIZE
      5438**DCL
BINARY_CARD.WD1.TYPE
      5436**DCL
BINARY_CARD.WRD_CHAR
      5440**DCL
BINARY_CARD_
      5449**DCL
BINARY_CARD_.DATA
      5450**DCL
BINARY_KEY
      5461**DCL
BINARY_KEY.ENTRY#
      5464**DCL
BINARY_KEY.SIZE
      5462**DCL
CATALOG_DATA
      5475**DCL
CATALOG_DATA.RFU
      5478**DCL
CATALOG_ENTRY_KEY
      5489**DCL
CATALOG_ENTRY_KEY.SIZE
      5490**DCL
CATALOG_KEY
      5503**DCL
CATALOG_KEY.DECK#
      5506**DCL
CATALOG_KEY.SIZE
      5504**DCL
CATALOG_SEARCH_KEY
      5517**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:162  
DKEND.BCD.CONTROL
      5531**DCL
DKEND.BCD.DATE
      5536**DCL
DKEND.BCD.LBL
      5538**DCL
DKEND.BCD.MOD_DATE
      5535**DCL
DKEND.BCD.SEQ
      5539**DCL
DKEND.BCD.TTL_DATE
      5534**DCL
DKEND.BCD.TYPE
      5532**DCL
DKEND.CHECKSUM
      5541**DCL
DKEND_
      5542**DCL
DUP
      5245**DCL
DUP.BATCH_MODE
      5247**DCL
DUP.BCD_V
      5316**DCL
DUP.BINARY_V
      5311**DCL
DUP.BINARY_V.PTR$
      5314**DCL
DUP.BOTTOM_LINE#
      5283**DCL
DUP.BREAK_RETURN
      5367**DCL
DUP.BREAK_TERMINATE
      5363**DCL
DUP.CPU_TYPE
      5376**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:163  
DUP.CURRENT_LINE#
      5281**DCL
DUP.CURRENT_PAGE#
      5279**DCL
DUP.DF
      5322**DCL
DUP.DF.FID
      5333**DCL
DUP.DF.FID_LGTH
      5335**DCL
DUP.DF.NO_EXIST
      5325**DCL
DUP.DS_V
      5256**DCL
DUP.ERROR_IMAGE
      5285**DCL
DUP.FAULT_ERROR
      5251**DCL
DUP.IFAD
      5290**DCL
DUP.IFAD.CONFIG_TAB
      5299**DCL
DUP.IFAD.DEVICE_INPUT
      5295**DCL
DUP.IFAD.DRIVE_NUMBER
      5305**DCL
DUP.IFAD.FID_LGTH
      5309**DCL
DUP.IFAD.IMU_NUMBER
      5303**DCL
DUP.IFAD.IMU_TAB
      5297**DCL
DUP.IFAD.NUM_VOLUMES
      5301**DCL
DUP.LOG
      5338**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:164  
DUP.LOG_V.PTR$
      5348**DCL
DUP.LOG_V_
      5350**DCL
DUP.MSG_V
      5272**DCL
DUP.MSG_V.PTR$
      5275**DCL
DUP.NUM_LINES
      5270**DCL
DUP.NUM_WORDS
      5254**DCL
DUP.PROCESS_COMPLETE
      5249**DCL
DUP.SITE_ID
      5374**DCL
DUP.SITE_NAME
      5369**DCL
DUP.SITE_NAME.LGTH
      5370**DCL
DUP.SITE_NAME.TEXT
      5372**DCL
DUP.TEMP
      5352**DCL
ID
      5553**DCL
ID.REV
      5556**DCL
ID.REV.LEVEL
      5558**DCL
ID.USAGE
      5559**DCL
LAST
      5570**DCL
LAST.EDIT_NAME
      5572**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:165  
MASTER_DATA
      5583**DCL
MASTER_DATA.RFU
      5586**DCL
MASTER_ENTRY_KEY
      5597**DCL
MASTER_ENTRY_KEY.SIZE
      5598**DCL
OBJECT.BCD.ASSEMBLER
      5629**DCL
OBJECT.BCD.CONTROL
      5613**DCL
OBJECT.BCD.DATE
      5631**DCL
OBJECT.BCD.DONT_APPLY
      5618**DCL
OBJECT.BCD.DONT_APPLY.CP6
      5620**DCL
OBJECT.BCD.DONT_APPLY.DPS8000
      5623**DCL
OBJECT.BCD.DONT_APPLY.DPS90
      5622**DCL
OBJECT.BCD.FILENAME
      5627**DCL
OBJECT.BCD.GECALL
      5630**DCL
OBJECT.BCD.LBL
      5632**DCL
OBJECT.BCD.LOAD_TYPE
      5616**DCL
OBJECT.BCD.MODEL
      5626**DCL
OBJECT.BCD.SEQ
      5633**DCL
OBJECT.BCD.TYPE
      5614**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:166  
OBJECT.BCD_
      5657**DCL
OBJECT.DECK_CHECKSUM
      5662**DCL
OBJECT.LOAD_SIZE
      5661**DCL
OBJECT.NIO_BCD
      5634**DCL
OBJECT.NIO_BCD.ASSEMBLER
      5651**DCL
OBJECT.NIO_BCD.CLASS
      5639**DCL
OBJECT.NIO_BCD.CONTROL
      5635**DCL
OBJECT.NIO_BCD.DATA
      5641**DCL
OBJECT.NIO_BCD.EQUIP_TYPE
      5643**DCL
OBJECT.NIO_BCD.FILE_NAME
      5644**DCL
OBJECT.NIO_BCD.LBL
      5655**DCL
OBJECT.NIO_BCD.LIBRARY
      5637**DCL
OBJECT.NIO_BCD.LOAD_TYPE
      5638**DCL
OBJECT.NIO_BCD.PRD_NUM_TAB
      5652**DCL
OBJECT.NIO_BCD.PRG_NUM_TAB
      5653**DCL
OBJECT.NIO_BCD.SEQ
      5656**DCL
OBJECT.NIO_BCD.TYPE
      5636**DCL
OBJECT.NIO_BCD.X_OF_N.N
      5649**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:167  
OBJECT.NIO_BCD.X_OF_N.X
      5647**DCL
OBJECT.NIO_BCD.X_OF_N_
      5650**DCL
OBJECT_KEY
      5674**DCL
OBJECT_KEY.SIZE
      5675**DCL
OUT$BLK IN PROCEDURE NC_COMMAND_SETUP
      5904**DCL
OUT$BLK.CPOS IN PROCEDURE NC_COMMAND_SETUP
      5930**DCL
OUT$BLK.NDTYPE IN PROCEDURE NC_COMMAND_SETUP
      5907**DCL
OUT$BLK.SCRITCH IN PROCEDURE NC_COMMAND_SETUP
      5920**DCL
OUT$BLK.TEMP IN PROCEDURE NC_COMMAND_SETUP
      5905**DCL
OUT$SYM IN PROCEDURE NC_COMMAND_SETUP
      5950**DCL
OUT$SYM.CODE IN PROCEDURE NC_COMMAND_SETUP
      5956**DCL
OUT$SYM.CPOS IN PROCEDURE NC_COMMAND_SETUP
      5965**DCL
OUT$SYM.NDTYPE IN PROCEDURE NC_COMMAND_SETUP
      5953**DCL
OUT$SYM.NSUBLKS IN PROCEDURE NC_COMMAND_SETUP
      5959**DCL
OUT$SYM.SCRITCH IN PROCEDURE NC_COMMAND_SETUP
      5962**DCL
OUT$SYM.TEMP IN PROCEDURE NC_COMMAND_SETUP
      5951**DCL
OUT$SYM.TEXTC$ IN PROCEDURE NC_COMMAND_SETUP
      5968**DCL
RECORD
      5687**DCL
PL6.E3A0      #001=TOU$NEWCAT File=TOU$NEWCAT.:E05TSI                            WED 07/30/97 06:47 Page:168  
RECORD.BCD.DATA
      5691**DCL
RECORD.BINARY
      5694**DCL
RECORD.BINARY.DATA
      5695**DCL
RECORD.BINARY.DATA.CS
      5697**DCL
RECORD.BINARY.DATA.CS.CHECKSUM
      5699**DCL
RECORD.BINARY.DATA.CS.DATA
      5700**DCL
RECORD.BINARY.DATA.CS.WD1
      5698**DCL
RECORD.BINARY.DATA.LBL_SEQ
      5701**DCL
RECORD.DATA
      5703**DCL
RECORD.SIZE
      5688**DCL
SUBCATALOG_DATA
      5714**DCL
SUBCATALOG_KEY
      5727**DCL
SUBCATALOG_KEY.ENTRY#
      5730**DCL
SUBCATALOG_KEY.SIZE
      5728**DCL
TOU$NEWCAT
        52**PROC
