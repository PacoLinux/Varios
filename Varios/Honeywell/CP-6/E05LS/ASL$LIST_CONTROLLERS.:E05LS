VERSION E05

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:1    
        1        1        /*M* ASL$LIST_ALL_CONTROLLERS:  routine to handle LIST CONT cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_CONTROLLERS: PROC;
       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_CONTROLLERS
       14       14             CALL:     CALL ASL$LIST_ALL_CONTROLLERS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_CONTROLLERS is a subroutine to handle
       18       18                           the LIST CONT command for SUPER.
       19       19                           Line records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual line name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for lines
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For lines the
       35       35                           EQU is KLAT_LINE# and its value is 5.
       36       36                           This routine will either read a single line
       37       37                           record or it will cycle through all of the :HLP
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:2    
       38       38                           records looking for lines and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the controllers
       42       42                           belonging to the line just found.  It will match
       43       43                           controller numbers in the line record against the
       44       44                           controller number asked for and if found
       45       45                           it will call the display routine
       46       46                           if the command was a DISPLAY command, or it will
       47       47                           call the formatter with the line name and the
       48       48                           controller number.
       49       49
       50       50                  MEMORY REQUIREMENTS:
       51       51                           For all of the routines that deal with listing/
       52       52                           displaying lines:
       53       53
       54       54                            ASL$LIST_ALL_CONTROLLERS
       55       55                            ASL$FIND_CONTROLLER
       56       56                            ASL$DISP_ONE_CONTROLLER
       57       57
       58       58                            The line record will be read into
       59       59                            data segment 1.  The name will be used by the
       60       60                            ASL$LIST_ALL_CONTROLLERS and ASL$FIND_CONTROLLER,
       61       61                            while the other info
       62       62                            will be used by the ASL$DISP_ONE_CONTROLLER routine.
       63       63        */
       64       64        /********************************************************************/
       65       65        /*   Include files   include files   include files   include files  */
       66       66        /********************************************************************/
       67       67        %INCLUDE AS_PERR_C;
       68      669        %INCLUDE AS_SUPER_C;
       69     1104        %INCLUDE AS_SUBS_C;
       70     2518        %INCLUDE AS_MAC_C;
       71     2598        %INCLUDE AS_ENTRIES_M;
       72     3648        %INCLUDE AS_SSUBS_C;
       73     3740        %INCLUDE B_ERRORS_C;
       74     4867        %INCLUDE CP_6_SUBS;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:3    
       75     5407        %INCLUDE KL_SUPER_C;
       76     8309        %INCLUDE XU_MACRO_C;
       77    11415        %INCLUDE XU_FORMAT_C;
       78    11577        %INCLUDE OCI_SUBS_C;
       79    11675        %INCLUDE AS_SUPER_R;
       80    14691        /********************************************************************/
       81    14692        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       82    14693        /********************************************************************/
       83    14694        %ASB$PREC_HLP ;
       84    14697        %ASB$READ_HLP ;
       85    14700        %ASB$READ_HLP_SEQ ;
       86    14703        %ASH$ERROR ;
       87    14706        %ASA$ERROR ;
       88    14709        %ASL$FIND_CONTROLLER ;
       89    14712        %ASL$DISP_ONE_CONTROLLER ;
       90    14715        %ASB$WILD_MATCH ;
       91    14718    1   DCL X$FORMAT ENTRY(1) ;
       92    14719        /********************************************************************/
       93    14720        /*   Local based     local based     local based     local based    */
       94    14721        /********************************************************************/
       95    14722        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       96    14723                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       97    14768        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       98    14806        %KL_DREC ( NAME = LINE$DREC,
       99    14807                   STCLASS = "BASED(DSEG1$)",
      100    14808                   LAST = ";");
      101    14921        %KL_CONTROLLER ( NAME = KL$CONTROLLER,
      102    14922                         LVL = 1,
      103    14923                         LAST = ";",
      104    14924                         STCLASS = "BASED( CONT$ )" );
      105    15073        /********************************************************************/
      106    15074        /*   Auto data       auto data       auto data       auto data      */
      107    15075        /********************************************************************/
      108    15076    1   DCL ALL_LINES         BIT(1);
      109    15077    1   DCL 1 BEGIN_KEY ,
      110    15078    1          2 COUNT        UBIN BYTE,
      111    15079    1          2 TEXT         CHAR(8);
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:4    
      112    15080    1   DCL CONT$    PTR;
      113    15081    1   DCL 1 CONT_NAME,
      114    15082    1          2 COUNT        UBIN BYTE UNAL,
      115    15083    1          2 TEXT         CHAR(2) UNAL;
      116    15084    1   DCL CURRENT_LINE      CHAR(8);
      117    15085    1   DCL DISP              BIT(1);
      118    15086    1   DCL DISP_CONTROLLERS  SBIN;
      119    15087    1   DCL DISP_LINES        SBIN;
      120    15088    1   DCL 1 END_KEY ,
      121    15089    1          2 COUNT        UBIN BYTE,
      122    15090    1          2 TEXT         CHAR(8);
      123    15091    1   DCL I                 UBIN;
      124    15092    1   DCL J                 UBIN;
      125    15093    1   DCL JCL               BIT(1);
      126    15094    1   DCL 1 LINE_NAME,
      127    15095    1          2 COUNT        UBIN BYTE UNAL,
      128    15096    1          2 TEXT         CHAR(8) UNAL;
      129    15097    1   DCL NEW_LINE#         BIT(1);
      130    15098    1   DCL WILD_CARD         BIT(1);
      131    15099
      132    15100        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:5    
      133    15101        /********************************************************************/
      134    15102        /*   Constant data   constant data   constant data   constant data  */
      135    15103        /********************************************************************/
      136    15104    1   DCL LINE_STR          CHAR(0) CONSTANT INIT ('line');
      137    15105    1   DCL LINES_STR         CHAR(0) CONSTANT INIT ('lines');
      138    15106    1   DCL CONTROLLER_STR    CHAR(0) CONSTANT INIT ('controller');
      139    15107    1   DCL CONTROLLERS_STR   CHAR(0) CONSTANT INIT ('controllers');
      140    15108    1   DCL LIST_STR          CHAR(0) CONSTANT INIT ('listed');
      141    15109    1   DCL DISPLAY_STR       CHAR(0) CONSTANT INIT ('displayed');
      142    15110    1   DCL FOUND_STR         CHAR(0) CONSTANT INIT ('found');
      143    15111        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:6    
      144    15112        /********************************************************************/
      145    15113        /*   Procedure       procedure       procedure       procedure      */
      146    15114        /********************************************************************/
      147    15115    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;
      148    15116    1   JCL = %NO#;
      149    15117    1   WILD_CARD = %NO#;
      150    15118    1   LINE_NAME.TEXT = '?';
      151    15119    1   LINE_NAME.COUNT = 1;
      152    15120    1   CONT_NAME.TEXT = '?';
      153    15121    1   CONT_NAME.COUNT = 1;
      154    15122    1   DISP_CONTROLLERS = 0;
      155    15123    1   DISP_LINES = 0;
      156    15124
      157    15125    2   DO SELECT (CODE);
      158    15126
      159    15127    2      SELECT (%LIST_ALL_VAL);
      160    15128
      161    15129    2      DISP = %NO#;
      162    15130    2      JCL = %NO#;
      163    15131
      164    15132    2      SELECT (%DISPLAY_ALL_VAL);
      165    15133
      166    15134    2      DISP = %YES#;
      167    15135    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN
      168    15136    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);
      169    15137    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN
      170    15138    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);
      171    15139
      172    15140    2      SELECT ( %LIST_CONT_VAL,
      173    15141    2           %DISPLAY_CONT_VAL);
      174    15142
      175    15143    2      DISP = (CODE = %DISPLAY_CONT_VAL);
      176    15144    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;
      177    15145    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINE_NAME_WILD_VAL THEN DO;
      178    15146    4            LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      179    15147    4            LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      180    15148    4            END;  /*  Code = LINE_NAME_WILD  */
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:7    
      181    15149    3         ELSE
      182    15150    4            IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %CONTROLLER_NAME_WILD_VAL THEN DO;
      183    15151    4               CONT_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;
      184    15152    4               CONT_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;
      185    15153    4               END; /*  Code = CONTROLLER_NAME_WILD  */
      186    15154    3            ELSE
      187    15155    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;
      188    15156
      189    15157    4                  JCL = %YES#;
      190    15158
      191    15159    4                  END; /*  Code = JCL_VAL  */
      192    15160
      193    15161    3         END;  /*  Do i  */
      194    15162
      195    15163    2      END;  /*  Do case (code)  */
      196    15164
      197    15165    1   FDS.NVECS# = 0;
      198    15166    2   IF JCL THEN DO;
      199    15167    2      CALL CONCAT (FMT_BUF, '%1/"', CONTROLLERS_STR, '%1/');
      200    15168    2      FDS.FMT_.BOUND = LENGTHC (CONTROLLERS_STR) + 6;
      201    15169    2      END;  /*   Jcl   */
      202    15170    2   ELSE DO;
      203    15171    2      CALL CONCAT (FMT_BUF, '%1/', CONTROLLERS_STR, '%1/');
      204    15172    2      FDS.FMT_.BOUND = LENGTHC (CONTROLLERS_STR) + 5;
      205    15173    2      END;  /*  Not jcl  */
      206    15174    1   FDS.TABDFLT# = 10;
      207    15175    1   CALL X$FORMAT (FDS);
      208    15176
      209    15177    1   IF LINE_NAME.TEXT = '?' THEN
      210    15178    1      ALL_LINES = %YES#;
      211    15179    2   ELSE DO;
      212    15180    2      ALL_LINES = %NO#;
      213    15181    2      BEGIN_KEY.TEXT = ' ';
      214    15182    2      END_KEY.TEXT = ' ';
      215    15183    3      CALL INDEX (I,'?',LINE_NAME.TEXT) WHENRETURN DO;
      216    15184    3         BEGIN_KEY.TEXT = SUBSTR(LINE_NAME.TEXT,0,I);
      217    15185    3         BEGIN_KEY.COUNT = 8;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:8    
      218    15186    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINE_NAME.TEXT,0,I),'~');
      219    15187    3         END_KEY.COUNT = I + 1;
      220    15188    3         WILD_CARD = %YES#;
      221    15189    3         END;  /*  Whenreturn from index  */
      222    15190    3      WHENALTRETURN DO;
      223    15191    3         WILD_CARD = %NO#;
      224    15192    3         END;  /* Whenaltreturn  */
      225    15193    2      END;  /*  Else  */
      226    15194
      227    15195    1   FDS.NVECS# = 0;
      228    15196
      229    15197    2   IF ALL_LINES THEN DO;
      230    15198    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */
      231    15199    2      END;  /*  ALL_LINES  */
      232    15200    2   ELSE IF WILD_CARD THEN DO;
      233    15201    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');
      234    15202    2         USERS_KEY.COUNT = 9 ;
      235    15203    2         END; /*  WILD_CARD  */
      236    15204    2      ELSE DO;  /*  Single line  */
      237    15205    2         CALL CONCAT (USERS_KEY.TXTC,LINE_NAME.TEXT,'*');
      238    15206    2         USERS_KEY.COUNT = 9 ;
      239    15207    2         I = DSEG1SIZE;
      240    15208    2         CALL ASB$READ_HLP (DSEG1$,I,1)
      241    15209    3         WHENRETURN DO;
      242    15210    4            IF LINE$DREC.ATYP ~= %KLAT_LINE# THEN DO;
      243    15211    4               AS_FIELD1 = LINE_NAME;
      244    15212                    %SCREAM( ERR#=E$NOTLINE , LEVEL=ERROR, MID='L' );
      245    15227    4               RETURN ;
      246    15228    4               END ; /* Then do */
      247    15229    3            I = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;
      248    15230    3            CONT$ = DSEG1$;
      249    15231    3            DISP_LINES = 1;
      250    15232    4            DO FOREVER;
      251    15233    4               CALL ASL$FIND_CONTROLLER (DSEG1$, I, CONT_NAME, CONT$) ALTRET (FINISH_UP
             15233                        );
      252    15234    5               IF DISP AND DISP_CONTROLLERS = 0 THEN DO;
      253    15235    6                  IF JCL THEN DO;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:9    
      254    15236    6                     CALL CONCAT (FMT_BUF, '%1/"   ', LINE_STR, '    ', LINE_NAME.TEXT,
             15236                              '%2/');
      255    15237    6                     FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 21;
      256    15238    6                     END; /*  Jcl  */
      257    15239    6                  ELSE DO;
      258    15240    6                     CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', LINE_NAME.TEXT,
             15240                              '%2/');
      259    15241    6                     FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 20;
      260    15242    6                     END; /*  Not jcl  */
      261    15243    5                  FDS.NVECS# = 0;
      262    15244    5                  CALL X$FORMAT (FDS);
      263    15245    5                  CALL ASL$DISP_ONE_CONTROLLER (CONT$, JCL, LINE_NAME.TEXT);
      264    15246    5                  END; /*  Disp  */
      265    15247    5               ELSE DO;
      266    15248    5                  FMT_BUF = '%1/   %A  %A  %A  %2D';
      267    15249    5                  FDS.FMT_.BOUND = 20;
      268    15250    5                  FDS.NVECS# = 4;
      269    15251    5                  FMT_VEC (0) = VECTOR (LINE_STR);
      270    15252    5                  FMT_VEC (1) = VECTOR (LINE_NAME.TEXT);
      271    15253    5                  FMT_VEC (2) = VECTOR (CONTROLLER_STR);
      272    15254    5                  FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);
      273    15255    5                  CALL X$FORMAT (FDS);
      274    15256    5                  END; /*  ~ disp  */
      275    15257    4               DISP_CONTROLLERS = DISP_CONTROLLERS + 1;
      276    15258    4               END; /*  Forever  */
      277    15259    3            END;  /*  Whenreturn  */
      278    15260    3         WHENALTRETURN DO;
      279    15261    3            IF MERR_CODE.CODE = %E$NOKEY
      280    15262    4            THEN DO;
      281    15263    4               AS_FIELD1 = LINE_NAME;
      282    15264                    %SCREAM( ERR#=E$LINE_NO_EXIST2, MID='L', LEVEL=ERROR );
      283    15279    4               END;  /*  Error = nokey  */
      284    15280    4            ELSE DO;
      285    15281    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );
      286    15282    4               END;  /* Error ~= nokey */
      287    15283    3            END;  /*  Whenaltreturn  */
      288    15284    2         GOTO FINISH_UP;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:10   
      289    15285    2         END; /*  Else  */
      290    15286    1   CALL ASB$PREC_HLP ;
      291    15287    2   DO FOREVER;
      292    15288
      293    15289    3      DO UNTIL LINE$DREC.ATYP = %KLAT_LINE# ;
      294    15290    3         I = DSEG1SIZE;
      295    15291    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)
      296    15292    4         WHENALTRETURN DO;
      297    15293    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);
      298    15294    4            GOTO FINISH_UP;
      299    15295    4            END;  /*  Whenaltreturn  */
      300    15296    3         END;  /*  Do until we find a line record  */
      301    15297    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;
      302    15298    2      IF I > 8 THEN I = 8;
      303    15299    2      CURRENT_LINE = SUBSTR(USERS_KEY.TXTC,0,I);
      304    15300    3      IF WILD_CARD THEN DO;
      305    15301    3         J = LINE_NAME.COUNT;
      306    15302    3         CALL ASB$WILD_MATCH (I, CURRENT_LINE, J, LINE_NAME.TEXT)
      307    15303    4         WHENALTRETURN DO;
      308    15304    4            IF CURRENT_LINE > END_KEY.TEXT THEN
      309    15305    4               GOTO FINISH_UP;
      310    15306    4            ELSE
      311    15307    4               GOTO END_FOREVER;
      312    15308    4            END;  /*  Whenaltreturn  */
      313    15309    3         END; /*  WILD_CARD  */
      314    15310    2      NEW_LINE# = %YES#;
      315    15311    2      DISP_LINES = DISP_LINES + 1;
      316    15312    2      I = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;
      317    15313    2      CONT$ = DSEG1$;
      318    15314    3      DO FOREVER;
      319    15315    3         CALL ASL$FIND_CONTROLLER (DSEG1$, I, CONT_NAME, CONT$) ALTRET (END_FOREVER);
      320    15316    4         IF DISP THEN DO;
      321    15317    5            IF NEW_LINE# THEN DO;
      322    15318    5               NEW_LINE# = %NO#;
      323    15319    6               IF JCL THEN DO;
      324    15320    6                  CALL CONCAT (FMT_BUF, '%1/"   ', LINE_STR, '    ', SUBSTR(USERS_KEY.
             15320                           TXTC,0,8),'%2/');
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:11   
      325    15321    6                  FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 21;
      326    15322    6                  END;  /*  Jcl  */
      327    15323    6               ELSE DO;
      328    15324    6                  CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', SUBSTR(USERS_KEY.
             15324                           TXTC,0,8));
      329    15325    6                  FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 17;
      330    15326    6                  END;  /*  Not jcl  */
      331    15327    5               FDS.NVECS# = 0;
      332    15328    5               CALL X$FORMAT (FDS);
      333    15329    5               END;  /*  DISP_CONTROLLER = 0  */
      334    15330    4            CALL ASL$DISP_ONE_CONTROLLER (CONT$, JCL, CURRENT_LINE);
      335    15331    4            END;  /*  Disp  */
      336    15332    4         ELSE DO;
      337    15333    4            FMT_BUF = '%1/   %A  %A  %A  %2D';
      338    15334    4            FDS.FMT_.BOUND = 20;
      339    15335    4            FDS.NVECS# = 4;
      340    15336    4            FMT_VEC (0) = VECTOR (LINE_STR);
      341    15337    4            FMT_VEC (1) = VECTOR (CURRENT_LINE);
      342    15338    4            FMT_VEC (2) = VECTOR (CONTROLLER_STR);
      343    15339    4            FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);
      344    15340    4            CALL X$FORMAT (FDS);
      345    15341    4            END;  /*  ~ disp  */
      346    15342    3         DISP_CONTROLLERS = DISP_CONTROLLERS + 1;
      347    15343    3         END;  /*  Forever  */
      348    15344    2   END_FOREVER:
      349    15345    2      END;  /*  Do forever  */
      350    15346    1   FINISH_UP:
      351    15347    2   IF NOT DISP THEN DO;
      352    15348    2      FMT_BUF = '%\%/';
      353    15349    2      FDS.FMT_.BOUND = 3;
      354    15350    2      FDS.NVECS# = 0;
      355    15351    2      CALL X$FORMAT(FDS);
      356    15352    2      END; /*  If not disp  */
      357    15353    2   IF NOT JCL THEN DO;
      358    15354    2      FMT_VEC(0) = VECTOR (DISP_LINES);
      359    15355    2      IF DISP_LINES = 1 THEN
      360    15356    3      DO;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:12   
      361    15357    3         FMT_VEC(1) = VECTOR (LINE_STR);
      362    15358    3         END; /*  DISP_LINES = 1  */
      363    15359    3      ELSE DO;
      364    15360    3         FMT_VEC(1) = VECTOR (LINES_STR);
      365    15361    3         END; /*  DISP_LINES ~= 1  */
      366    15362    2      FMT_VEC(2) = VECTOR (FOUND_STR);
      367    15363    2      FDS.NVECS# = 3;
      368    15364    2      FMT_BUF = '   %5D %A %A.';
      369    15365    2      FDS.FMT_.BOUND = 12;
      370    15366    2      CALL X$FORMAT(FDS);
      371    15367    2      FMT_VEC(0) = VECTOR (DISP_CONTROLLERS);
      372    15368    2      IF DISP_CONTROLLERS = 1 THEN
      373    15369    3      DO;
      374    15370    3         FMT_VEC(1) = VECTOR (CONTROLLER_STR);
      375    15371    3         END; /*  DISP_CONTROLLERS = 1  */
      376    15372    3      ELSE DO;
      377    15373    3         FMT_VEC(1) = VECTOR (CONTROLLERS_STR);
      378    15374    3         END; /*  DISP_CONTROLLERS ~= 1  */
      379    15375    2      IF DISP THEN
      380    15376    3      DO;
      381    15377    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);
      382    15378    3         END; /*  If disp  */
      383    15379    3      ELSE DO;
      384    15380    3         FMT_VEC(2) = VECTOR (LIST_STR);
      385    15381    3         END; /*  If ~ disp  */
      386    15382    2      FDS.NVECS# = 3;
      387    15383    2      FMT_BUF = '   %5D %A %A.';
      388    15384    2      FDS.FMT_.BOUND = 12;
      389    15385    2      CALL X$FORMAT(FDS);
      390    15386    2      END; /* Not jcl */
      391    15387    1   RETURN;
      392    15388    1   END ASL$LIST_ALL_CONTROLLERS;
      393    15389        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:13   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_CONTROLLERS.

   Procedure ASL$LIST_ALL_CONTROLLERS requires 643 words for executable code.
   Procedure ASL$LIST_ALL_CONTROLLERS requires 32 words of local(AUTO) storage.

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:14   

 Object Unit name= ASL$LIST_ALL_CONTROLLERS                   File name= ASL$LIST_CONTROLLERS.:E05TOU
 UTS= JUL 29 '97 10:06:10.00 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     35     43  ASL$LIST_ALL_CONTROLLERS
    2   Proc  even  none   643   1203  ASL$LIST_ALL_CONTROLLERS
    3  RoData even  none    34     42  ASL$LIST_ALL_CONTROLLERS

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        0  ASL$LIST_ALL_CONTROLLERS
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:15   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
 yes     yes           Std       3 ASB$READ_HLP
         yes           Std       2 ASH$ERROR
 yes     yes           Std       4 ASL$FIND_CONTROLLER
         yes           Std       3 ASL$DISP_ONE_CONTROLLER
 yes     yes           Std       0 ASB$PREC_HLP
         yes           Std       3 ASA$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
 yes     yes           Std       3 ASB$READ_HLP_SEQ
                       nStd      0 X66_AUTO_0
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     USERS_KEY                             FDS                                   FMT_BUF
     FMT_VEC                               NODE$                                 CODE
     ERR_CODE                              AS_FIELD1                             REMEM_VAR
     REM_FCMD                              ASA_BRKS_LOC                          DSEG1$
     DSEG1SIZE                             P_PCB                                 B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:16   


        1        1        /*M* ASL$LIST_ALL_CONTROLLERS:  routine to handle LIST CONT cmd. */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
        8        8              ECU=3,CSU=3,SDI=3                                           */
        9        9
       10       10        ASL$LIST_ALL_CONTROLLERS: PROC;

     10  2 000000   000000 700200 xent  ASL$LIST_AL* TSX0  ! X66_AUTO_0
         2 000001   000040 000000                    ZERO    32,0

       11       11        /**********************************************************/
       12       12
       13       13        /*D* NAME:     ASL$LIST_ALL_CONTROLLERS
       14       14             CALL:     CALL ASL$LIST_ALL_CONTROLLERS
       15       15             INPUT:    Nothing is passed.
       16       16             OUTPUT:   Nothing is returned.
       17       17             DESCRIPTION:  ASL$LIST_ALL_CONTROLLERS is a subroutine to handle
       18       18                           the LIST CONT command for SUPER.
       19       19                           Line records are stored in the :HLP.:SYS
       20       20                           file and have keys that look like the following:
       21       21                           'xxxxxxxx*' where the x signifies
       22       22                           a character from the alphanumeric character
       23       23                           set plus the special characters ':$*' and
       24       24                           is of length 8 or less.
       25       25                           If the actual line name is less than 8
       26       26                           characters, the key will be blank padded to
       27       27                           8 characters.
       28       28                           The key is not a unique identifier for lines
       29       29                           though.  Other types of objects known to
       30       30                           SUPER have the same type of key structure.
       31       31                           The unique identifier for these objects is
       32       32                           the first byte of the actual record, which
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:17   
       33       33                           contains a value specified by the KLAT_?
       34       34                           EQU's found in KL_SUPER_C.  For lines the
       35       35                           EQU is KLAT_LINE# and its value is 5.
       36       36                           This routine will either read a single line
       37       37                           record or it will cycle through all of the :HLP
       38       38                           records looking for lines and matches
       39       39                           to the selection criteria as input in the
       40       40                           LIST/DISPLAY command.  If a match is found
       41       41                           this routine will then look for the controllers
       42       42                           belonging to the line just found.  It will match
       43       43                           controller numbers in the line record against the
       44       44                           controller number asked for and if found
       45       45                           it will call the display routine
       46       46                           if the command was a DISPLAY command, or it will
       47       47                           call the formatter with the line name and the
       48       48                           controller number.
       49       49
       50       50                  MEMORY REQUIREMENTS:
       51       51                           For all of the routines that deal with listing/
       52       52                           displaying lines:
       53       53
       54       54                            ASL$LIST_ALL_CONTROLLERS
       55       55                            ASL$FIND_CONTROLLER
       56       56                            ASL$DISP_ONE_CONTROLLER
       57       57
       58       58                            The line record will be read into
       59       59                            data segment 1.  The name will be used by the
       60       60                            ASL$LIST_ALL_CONTROLLERS and ASL$FIND_CONTROLLER,
       61       61                            while the other info
       62       62                            will be used by the ASL$DISP_ONE_CONTROLLER routine.
       63       63        */
       64       64        /********************************************************************/
       65       65        /*   Include files   include files   include files   include files  */
       66       66        /********************************************************************/
       67       67        %INCLUDE AS_PERR_C;
       68      669        %INCLUDE AS_SUPER_C;
       69     1104        %INCLUDE AS_SUBS_C;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:18   
       70     2518        %INCLUDE AS_MAC_C;
       71     2598        %INCLUDE AS_ENTRIES_M;
       72     3648        %INCLUDE AS_SSUBS_C;
       73     3740        %INCLUDE B_ERRORS_C;
       74     4867        %INCLUDE CP_6_SUBS;
       75     5407        %INCLUDE KL_SUPER_C;
       76     8309        %INCLUDE XU_MACRO_C;
       77    11415        %INCLUDE XU_FORMAT_C;
       78    11577        %INCLUDE OCI_SUBS_C;
       79    11675        %INCLUDE AS_SUPER_R;
       80    14691        /********************************************************************/
       81    14692        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
       82    14693        /********************************************************************/
       83    14694        %ASB$PREC_HLP ;
       84    14697        %ASB$READ_HLP ;
       85    14700        %ASB$READ_HLP_SEQ ;
       86    14703        %ASH$ERROR ;
       87    14706        %ASA$ERROR ;
       88    14709        %ASL$FIND_CONTROLLER ;
       89    14712        %ASL$DISP_ONE_CONTROLLER ;
       90    14715        %ASB$WILD_MATCH ;
       91    14718    1   DCL X$FORMAT ENTRY(1) ;
       92    14719        /********************************************************************/
       93    14720        /*   Local based     local based     local based     local based    */
       94    14721        /********************************************************************/
       95    14722        %PARSE$OUT ( NAME = P$B, STCLASS = "BASED(NODE$)",
       96    14723                     NDTYPE=TYPE, NSUBLKS=NSUBLKS);
       97    14768        %PARSE$SYM ( NAME = P$S, STCLASS = BASED);
       98    14806        %KL_DREC ( NAME = LINE$DREC,
       99    14807                   STCLASS = "BASED(DSEG1$)",
      100    14808                   LAST = ";");
      101    14921        %KL_CONTROLLER ( NAME = KL$CONTROLLER,
      102    14922                         LVL = 1,
      103    14923                         LAST = ";",
      104    14924                         STCLASS = "BASED( CONT$ )" );
      105    15073        /********************************************************************/
      106    15074        /*   Auto data       auto data       auto data       auto data      */
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:19   
      107    15075        /********************************************************************/
      108    15076    1   DCL ALL_LINES         BIT(1);
      109    15077    1   DCL 1 BEGIN_KEY ,
      110    15078    1          2 COUNT        UBIN BYTE,
      111    15079    1          2 TEXT         CHAR(8);
      112    15080    1   DCL CONT$    PTR;
      113    15081    1   DCL 1 CONT_NAME,
      114    15082    1          2 COUNT        UBIN BYTE UNAL,
      115    15083    1          2 TEXT         CHAR(2) UNAL;
      116    15084    1   DCL CURRENT_LINE      CHAR(8);
      117    15085    1   DCL DISP              BIT(1);
      118    15086    1   DCL DISP_CONTROLLERS  SBIN;
      119    15087    1   DCL DISP_LINES        SBIN;
      120    15088    1   DCL 1 END_KEY ,
      121    15089    1          2 COUNT        UBIN BYTE,
      122    15090    1          2 TEXT         CHAR(8);
      123    15091    1   DCL I                 UBIN;
      124    15092    1   DCL J                 UBIN;
      125    15093    1   DCL JCL               BIT(1);
      126    15094    1   DCL 1 LINE_NAME,
      127    15095    1          2 COUNT        UBIN BYTE UNAL,
      128    15096    1          2 TEXT         CHAR(8) UNAL;
      129    15097    1   DCL NEW_LINE#         BIT(1);
      130    15098    1   DCL WILD_CARD         BIT(1);
      131    15099
      132    15100        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:20   
      133    15101        /********************************************************************/
      134    15102        /*   Constant data   constant data   constant data   constant data  */
      135    15103        /********************************************************************/
      136    15104    1   DCL LINE_STR          CHAR(0) CONSTANT INIT ('line');
      137    15105    1   DCL LINES_STR         CHAR(0) CONSTANT INIT ('lines');
      138    15106    1   DCL CONTROLLER_STR    CHAR(0) CONSTANT INIT ('controller');
      139    15107    1   DCL CONTROLLERS_STR   CHAR(0) CONSTANT INIT ('controllers');
      140    15108    1   DCL LIST_STR          CHAR(0) CONSTANT INIT ('listed');
      141    15109    1   DCL DISPLAY_STR       CHAR(0) CONSTANT INIT ('displayed');
      142    15110    1   DCL FOUND_STR         CHAR(0) CONSTANT INIT ('found');
      143    15111        %EJECT;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:21   
      144    15112        /********************************************************************/
      145    15113        /*   Procedure       procedure       procedure       procedure      */
      146    15114        /********************************************************************/
      147    15115    1   CODE = P_PCB.OUT$->P$B.SUBLK$(0)->P$B.CODE;

  15115  2 000002   000003 470400 xsym               LDP0    P_PCB+3
         2 000003   000003 471500                    LDP1    3,,PR0
         2 000004   100000 236100                    LDQ     0,,PR1
         2 000005   777777 376007                    ANQ     -1,DL
         2 000006   000000 756000 xsym               STQ     CODE

      148    15116    1   JCL = %NO#;

  15116  2 000007   200023 450100                    STZ     JCL,,AUTO

      149    15117    1   WILD_CARD = %NO#;

  15117  2 000010   200030 450100                    STZ     WILD_CARD,,AUTO

      150    15118    1   LINE_NAME.TEXT = '?';

  15118  2 000011   040100 100400                    MLR     fill='040'O
         2 000012   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000013   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      151    15119    1   LINE_NAME.COUNT = 1;

  15119  2 000014   001000 236003                    LDQ     512,DU
         2 000015   200024 552140                    STBQ    LINE_NAME,'40'O,AUTO

      152    15120    1   CONT_NAME.TEXT = '?';

  15120  2 000016   000001 236000 3                  LDQ     1
         2 000017   200010 552130                    STBQ    CONT_NAME,'30'O,AUTO

      153    15121    1   CONT_NAME.COUNT = 1;

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:22   
  15121  2 000020   001000 236003                    LDQ     512,DU
         2 000021   200010 552140                    STBQ    CONT_NAME,'40'O,AUTO

      154    15122    1   DISP_CONTROLLERS = 0;

  15122  2 000022   200014 450100                    STZ     DISP_CONTROLLERS,,AUTO

      155    15123    1   DISP_LINES = 0;

  15123  2 000023   200015 450100                    STZ     DISP_LINES,,AUTO

      156    15124
      157    15125    2   DO SELECT (CODE);

  15125  2 000024   000000 236000 xsym               LDQ     CODE
         2 000025   000022 116007                    CMPQ    18,DL
         2 000026   000037 602000 2                  TNC     s:15125+11
         2 000027   000042 600000 2                  TZE     s:15129
         2 000030   000144 116007                    CMPQ    100,DL
         2 000031   000034 602000 2                  TNC     s:15125+8
         2 000032   000045 600000 2                  TZE     s:15134
         2 000033   000160 710000 2                  TRA     s:15165
         2 000034   000124 116007                    CMPQ    84,DL
         2 000035   000160 601000 2                  TNZ     s:15165
         2 000036   000077 710000 2                  TRA     s:15143
         2 000037   000013 116007                    CMPQ    11,DL
         2 000040   000160 601000 2                  TNZ     s:15165
         2 000041   000077 710000 2                  TRA     s:15143

      158    15126
      159    15127    2      SELECT (%LIST_ALL_VAL);

      160    15128
      161    15129    2      DISP = %NO#;

  15129  2 000042   200013 450100                    STZ     DISP,,AUTO

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:23   
      162    15130    2      JCL = %NO#;

  15130  2 000043   200023 450100                    STZ     JCL,,AUTO
         2 000044   000160 710000 2                  TRA     s:15165

      163    15131
      164    15132    2      SELECT (%DISPLAY_ALL_VAL);

      165    15133
      166    15134    2      DISP = %YES#;

  15134  2 000045   400000 236003                    LDQ     -131072,DU
         2 000046   200013 756100                    STQ     DISP,,AUTO

      167    15135    2      IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS = 2 THEN

  15135  2 000047   000003 471500                    LDP1    3,,PR0
         2 000050   100001 220100                    LDX0    1,,PR1
         2 000051   000002 100003                    CMPX0   2,DU
         2 000052   000064 601000 2                  TNZ     s:15137

      168    15136    2         JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(1)->P$B.CODE = %JCL_VAL);

  15136  2 000053   100004 473500                    LDP3    4,,PR1
         2 000054   400000 221003                    LDX1    -131072,DU
         2 000055   300000 722100                    LXL2    0,,PR3
         2 000056   000001 102003                    CMPX2   1,DU
         2 000057   000061 600000 2                  TZE     s:15136+6
         2 000060   000000 221003                    LDX1    0,DU
         2 000061   000000 636011                    EAQ     0,X1
         2 000062   200023 756100                    STQ     JCL,,AUTO
         2 000063   000160 710000 2                  TRA     s:15165

      169    15137    2      ELSE IF P_PCB.OUT$->P$B.SUBLK$(0)->P$B.NSUBLKS > 0 THEN

  15137  2 000064   000000 100003                    CMPX0   0,DU
         2 000065   000160 600000 2                  TZE     s:15165
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:24   

      170    15138    2            JCL = ( P_PCB.OUT$->P$B.SUBLK$(0)->P$B.SUBLK$(0)->P$B.CODE = %JCL_VAL);

  15138  2 000066   100003 473500                    LDP3    3,,PR1
         2 000067   400000 221003                    LDX1    -131072,DU
         2 000070   300000 722100                    LXL2    0,,PR3
         2 000071   000001 102003                    CMPX2   1,DU
         2 000072   000074 600000 2                  TZE     s:15138+6
         2 000073   000000 221003                    LDX1    0,DU
         2 000074   000000 636011                    EAQ     0,X1
         2 000075   200023 756100                    STQ     JCL,,AUTO
         2 000076   000160 710000 2                  TRA     s:15165

      171    15139
      172    15140    2      SELECT ( %LIST_CONT_VAL,

      173    15141    2           %DISPLAY_CONT_VAL);
      174    15142
      175    15143    2      DISP = (CODE = %DISPLAY_CONT_VAL);

  15143  2 000077   400000 220003                    LDX0    -131072,DU
         2 000100   000124 116007                    CMPQ    84,DL
         2 000101   000103 600000 2                  TZE     s:15143+4
         2 000102   000000 220003                    LDX0    0,DU
         2 000103   000000 636010                    EAQ     0,X0
         2 000104   200013 756100                    STQ     DISP,,AUTO

      176    15144    3      DO I = 1 TO P_PCB.OUT$->P$B.NSUBLKS - 1;

  15144  2 000105   000001 235007                    LDA     1,DL
         2 000106   200021 755100                    STA     I,,AUTO
         2 000107   000153 710000 2                  TRA     s:15161+3

      177    15145    4         IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %LINE_NAME_WILD_VAL THEN DO;

  15145  2 000110   000003 470400 xsym               LDP0    P_PCB+3
         2 000111   200021 720100                    LXL0    I,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:25   
         2 000112   000003 471510                    LDP1    3,X0,PR0
         2 000113   100000 721100                    LXL1    0,,PR1
         2 000114   000353 101003                    CMPX1   235,DU
         2 000115   000130 601000 2                  TNZ     s:15150

      178    15146    4            LINE_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15146  2 000116   100004 236100                    LDQ     4,,PR1
         2 000117   000033 772000                    QRL     27
         2 000120   000000 622006                    EAX2    0,QL
         2 000121   040100 100540                    MLR     fill='040'O
         2 000122   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
         2 000123   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8

      179    15147    4            LINE_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15147  2 000124   000003 471510                    LDP1    3,X0,PR0
         2 000125   100004 236100                    LDQ     4,,PR1
         2 000126   200024 552140                    STBQ    LINE_NAME,'40'O,AUTO

      180    15148    4            END;  /*  Code = LINE_NAME_WILD  */

  15148  2 000127   000150 710000 2                  TRA     s:15161

      181    15149    3         ELSE
      182    15150    4           IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %CONTROLLER_NAME_WILD_VAL THEN DO;

  15150  2 000130   000347 101003                    CMPX1   231,DU
         2 000131   000144 601000 2                  TNZ     s:15155

      183    15151    4               CONT_NAME.TEXT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.TEXT;

  15151  2 000132   100004 236100                    LDQ     4,,PR1
         2 000133   000033 772000                    QRL     27
         2 000134   000000 622006                    EAX2    0,QL
         2 000135   040100 100540                    MLR     fill='040'O
         2 000136   100004 200012                    ADSC9   4,,PR1                   cn=1,n=*X2
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:26   
         2 000137   200010 200002                    ADSC9   CONT_NAME,,AUTO          cn=1,n=2

      184    15152    4               CONT_NAME.COUNT = P_PCB.OUT$->P$B.SUBLK$(I)->P$S.COUNT;

  15152  2 000140   000003 471510                    LDP1    3,X0,PR0
         2 000141   100004 236100                    LDQ     4,,PR1
         2 000142   200010 552140                    STBQ    CONT_NAME,'40'O,AUTO

      185    15153    4               END; /*  Code = CONTROLLER_NAME_WILD  */

  15153  2 000143   000150 710000 2                  TRA     s:15161

      186    15154    3            ELSE
      187    15155    4               IF P_PCB.OUT$->P$B.SUBLK$(I)->P$B.CODE = %JCL_VAL THEN DO;

  15155  2 000144   000001 101003                    CMPX1   1,DU
         2 000145   000150 601000 2                  TNZ     s:15161

      188    15156
      189    15157    4                  JCL = %YES#;

  15157  2 000146   400000 236003                    LDQ     -131072,DU
         2 000147   200023 756100                    STQ     JCL,,AUTO

      190    15158
      191    15159    4                  END; /*  Code = JCL_VAL  */

      192    15160
      193    15161    3         END;  /*  Do i  */

  15161  2 000150   200021 235100                    LDA     I,,AUTO
         2 000151   000001 035007                    ADLA    1,DL
         2 000152   200021 755100                    STA     I,,AUTO
         2 000153   000001 236100                    LDQ     1,,PR0
         2 000154   000022 772000                    QRL     18
         2 000155   200021 116100                    CMPQ    I,,AUTO
         2 000156   000160 600000 2                  TZE     s:15165
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:27   
         2 000157   000110 603000 2                  TRC     s:15145

      194    15162
      195    15163    2      END;  /*  Do case (code)  */

      196    15164
      197    15165    1   FDS.NVECS# = 0;

  15165  2 000160   000011 450000 xsym               STZ     FDS+9

      198    15166    2   IF JCL THEN DO;

  15166  2 000161   200023 234100                    SZN     JCL,,AUTO
         2 000162   000200 605000 2                  TPL     s:15171

      199    15167    2      CALL CONCAT (FMT_BUF, '%1/"', CONTROLLERS_STR, '%1/');

  15167  2 000163   000020 236000 1                  LDQ     FOUND_STR+2
         2 000164   000000 756000 xsym               STQ     FMT_BUF
         2 000165   040000 100400                    MLR     fill='040'O
         2 000166   000006 000013 1                  ADSC9   CONTROLLERS_STR          cn=0,n=11
         2 000167   000001 000013 xsym               ADSC9   FMT_BUF+1                cn=0,n=11
         2 000170   040000 100400                    MLR     fill='040'O
         2 000171   000020 000003 1                  ADSC9   FOUND_STR+2              cn=0,n=3
         2 000172   000003 600360 xsym               ADSC9   FMT_BUF+3                cn=3,n=240

      200    15168    2      FDS.FMT_.BOUND = LENGTHC (CONTROLLERS_STR) + 6;

  15168  2 000173   000000 236000 xsym               LDQ     FDS
         2 000174   177777 376007                    ANQ     65535,DL
         2 000175   000002 276000 3                  ORQ     2
         2 000176   000000 756000 xsym               STQ     FDS

      201    15169    2      END;  /*   Jcl   */

  15169  2 000177   000216 710000 2                  TRA     s:15174

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:28   
      202    15170    2   ELSE DO;

      203    15171    2      CALL CONCAT (FMT_BUF, '%1/', CONTROLLERS_STR, '%1/');

  15171  2 000200   000020 236000 1                  LDQ     FOUND_STR+2
         2 000201   000003 376000 3                  ANQ     3
         2 000202   000040 276007                    ORQ     32,DL
         2 000203   000000 756000 xsym               STQ     FMT_BUF
         2 000204   040000 100400                    MLR     fill='040'O
         2 000205   000006 000013 1                  ADSC9   CONTROLLERS_STR          cn=0,n=11
         2 000206   000000 600013 xsym               ADSC9   FMT_BUF                  cn=3,n=11
         2 000207   040000 100400                    MLR     fill='040'O
         2 000210   000020 000003 1                  ADSC9   FOUND_STR+2              cn=0,n=3
         2 000211   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      204    15172    2      FDS.FMT_.BOUND = LENGTHC (CONTROLLERS_STR) + 5;

  15172  2 000212   000000 236000 xsym               LDQ     FDS
         2 000213   177777 376007                    ANQ     65535,DL
         2 000214   000004 276003                    ORQ     4,DU
         2 000215   000000 756000 xsym               STQ     FDS

      205    15173    2      END;  /*  Not jcl  */

      206    15174    1   FDS.TABDFLT# = 10;

  15174  2 000216   000012 235007                    LDA     10,DL
         2 000217   000017 755000 xsym               STA     FDS+15

      207    15175    1   CALL X$FORMAT (FDS);

  15175  2 000220   000004 630400 3                  EPPR0   4
         2 000221   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000222   000000 701000 xent               TSX1    X$FORMAT
         2 000223   000000 011000                    NOP     0

      208    15176
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:29   
      209    15177    1   IF LINE_NAME.TEXT = '?' THEN

  15177  2 000224   040000 106500                    CMPC    fill='040'O
         2 000225   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000226   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000227   000233 601000 2                  TNZ     s:15180

      210    15178    1      ALL_LINES = %YES#;

  15178  2 000230   400000 236003                    LDQ     -131072,DU
         2 000231   200003 756100                    STQ     ALL_LINES,,AUTO
         2 000232   000301 710000 2                  TRA     s:15195

      211    15179    2   ELSE DO;

      212    15180    2      ALL_LINES = %NO#;

  15180  2 000233   200003 450100                    STZ     ALL_LINES,,AUTO

      213    15181    2      BEGIN_KEY.TEXT = ' ';

  15181  2 000234   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000235   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000236   200005 755100                    STA     BEGIN_KEY+1,,AUTO
         2 000237   200006 756100                    STQ     BEGIN_KEY+2,,AUTO

      214    15182    2      END_KEY.TEXT = ' ';

  15182  2 000240   000035 235000 xsym               LDA     B_VECTNIL+29
         2 000241   000035 236000 xsym               LDQ     B_VECTNIL+29
         2 000242   200017 755100                    STA     END_KEY+1,,AUTO
         2 000243   200020 756100                    STQ     END_KEY+2,,AUTO

      215    15183    3      CALL INDEX (I,'?',LINE_NAME.TEXT) WHENRETURN DO;

  15183  2 000244   000000 124500                    SCM     mask='000'O
         2 000245   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:30   
         2 000246   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000247   200021 000100                    ARG     I,,AUTO
         2 000250   000300 606400 2                  TTN     s:15191

      216    15184    3         BEGIN_KEY.TEXT = SUBSTR(LINE_NAME.TEXT,0,I);

  15184  2 000251   200021 720100                    LXL0    I,,AUTO
         2 000252   040100 100540                    MLR     fill='040'O
         2 000253   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000254   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8

      217    15185    3         BEGIN_KEY.COUNT = 8;

  15185  2 000255   010000 236003                    LDQ     4096,DU
         2 000256   200004 756100                    STQ     BEGIN_KEY,,AUTO

      218    15186    3         CALL CONCAT (END_KEY.TEXT,SUBSTR(LINE_NAME.TEXT,0,I),'~');

  15186  2 000257   040100 100540                    MLR     fill='040'O
         2 000260   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=*X0
         2 000261   200017 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000262   200021 236100                    LDQ     I,,AUTO
         2 000263   000010 116007                    CMPQ    8,DL
         2 000264   000272 603000 2                  TRC     s:15187
         2 000265   777767 621006                    EAX1    -9,QL
         2 000266   777777 661003                    ERX1    -1,DU
         2 000267   040146 100400                    MLR     fill='040'O
         2 000270   000005 000001 3                  ADSC9   5                        cn=0,n=1
         2 000271   200017 000011                    ADSC9   END_KEY+1,Q,AUTO         cn=0,n=*X1

      219    15187    3         END_KEY.COUNT = I + 1;

  15187  2 000272   000001 036007                    ADLQ    1,DL
         2 000273   000033 736000                    QLS     27
         2 000274   200016 756100                    STQ     END_KEY,,AUTO

      220    15188    3         WILD_CARD = %YES#;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:31   

  15188  2 000275   400000 236003                    LDQ     -131072,DU
         2 000276   200030 756100                    STQ     WILD_CARD,,AUTO

      221    15189    3         END;  /*  Whenreturn from index  */

  15189  2 000277   000301 710000 2                  TRA     s:15195

      222    15190    3      WHENALTRETURN DO;

      223    15191    3         WILD_CARD = %NO#;

  15191  2 000300   200030 450100                    STZ     WILD_CARD,,AUTO

      224    15192    3         END;  /* Whenaltreturn  */

      225    15193    2      END;  /*  Else  */

      226    15194
      227    15195    1   FDS.NVECS# = 0;

  15195  2 000301   000011 450000 xsym               STZ     FDS+9

      228    15196
      229    15197    2   IF ALL_LINES THEN DO;

  15197  2 000302   200003 234100                    SZN     ALL_LINES,,AUTO
         2 000303   000310 605000 2                  TPL     s:15200

      230    15198    2      USERS_KEY = '001000'O;     /* To precord to begin of :HLP */

  15198  2 000304   000000 100400                    MLR     fill='000'O
         2 000305   000033 000002 xsym               ADSC9   B_VECTNIL+27             cn=0,n=2
         2 000306   000000 000052 xsym               ADSC9   USERS_KEY                cn=0,n=42

      231    15199    2      END;  /*  ALL_LINES  */

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:32   
  15199  2 000307   000567 710000 2                  TRA     s:15286

      232    15200    2   ELSE IF WILD_CARD THEN DO;

  15200  2 000310   200030 234100                    SZN     WILD_CARD,,AUTO
         2 000311   000323 605000 2                  TPL     s:15205

      233    15201    2         CALL CONCAT (USERS_KEY.TXTC,BEGIN_KEY.TEXT,'*');

  15201  2 000312   040000 100500                    MLR     fill='040'O
         2 000313   200005 000010                    ADSC9   BEGIN_KEY+1,,AUTO        cn=0,n=8
         2 000314   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000315   040000 100400                    MLR     fill='040'O
         2 000316   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 000317   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      234    15202    2         USERS_KEY.COUNT = 9 ;

  15202  2 000320   011000 236003                    LDQ     4608,DU
         2 000321   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      235    15203    2         END; /*  WILD_CARD  */

  15203  2 000322   000567 710000 2                  TRA     s:15286

      236    15204    2      ELSE DO;  /*  Single line  */

      237    15205    2         CALL CONCAT (USERS_KEY.TXTC,LINE_NAME.TEXT,'*');

  15205  2 000323   040000 100500                    MLR     fill='040'O
         2 000324   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000325   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000326   040000 100400                    MLR     fill='040'O
         2 000327   000006 000001 3                  ADSC9   6                        cn=0,n=1
         2 000330   000002 200041 xsym               ADSC9   USERS_KEY+2              cn=1,n=33

      238    15206    2         USERS_KEY.COUNT = 9 ;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:33   

  15206  2 000331   011000 236003                    LDQ     4608,DU
         2 000332   000000 552040 xsym               STBQ    USERS_KEY,'40'O

      239    15207    2         I = DSEG1SIZE;

  15207  2 000333   000000 235000 xsym               LDA     DSEG1SIZE
         2 000334   200021 755100                    STA     I,,AUTO

      240    15208    2         CALL ASB$READ_HLP (DSEG1$,I,1)

  15208  2 000335   000007 236000 3                  LDQ     7
         2 000336   200034 756100                    STQ     WILD_CARD+4,,AUTO
         2 000337   200021 630500                    EPPR0   I,,AUTO
         2 000340   200033 450500                    STP0    WILD_CARD+3,,AUTO
         2 000341   000010 236000 3                  LDQ     8
         2 000342   200032 756100                    STQ     WILD_CARD+2,,AUTO
         2 000343   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000344   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000345   000000 701000 xent               TSX1    ASB$READ_HLP
         2 000346   000546 702000 2                  TSX2    s:15261

      241    15209    3         WHENRETURN DO;

      242    15210    4            IF LINE$DREC.ATYP ~= %KLAT_LINE# THEN DO;

  15210  2 000347   000000 470400 xsym               LDP0    DSEG1$
         2 000350   000000 236100                    LDQ     0,,PR0
         2 000351   777000 376003                    ANQ     -512,DU
         2 000352   005000 116003                    CMPQ    2560,DU
         2 000353   000364 600000 2                  TZE     s:15229

      243    15211    4               AS_FIELD1 = LINE_NAME;

  15211  2 000354   000000 100500                    MLR     fill='000'O
         2 000355   200024 000011                    ADSC9   LINE_NAME,,AUTO          cn=0,n=9
         2 000356   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:34   

      244    15212                    %SCREAM( ERR#=E$NOTLINE , LEVEL=ERROR, MID='L' );

  15224  2 000357   000011 630400 3                  EPPR0   9
         2 000360   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000361   000000 701000 xent               TSX1    ASH$ERROR
         2 000362   000000 011000                    NOP     0

      245    15227    4               RETURN ;

  15227  2 000363   000000 702200 xent               TSX2  ! X66_ARET

      246    15228    4               END ; /* Then do */
      247    15229    3            I = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;

  15229  2 000364   000017 235100                    LDA     15,,PR0
         2 000365   000020 035007                    ADLA    16,DL
         2 000366   200021 755100                    STA     I,,AUTO

      248    15230    3            CONT$ = DSEG1$;

  15230  2 000367   000000 236000 xsym               LDQ     DSEG1$
         2 000370   200007 756100                    STQ     CONT$,,AUTO

      249    15231    3            DISP_LINES = 1;

  15231  2 000371   000001 235007                    LDA     1,DL
         2 000372   200015 755100                    STA     DISP_LINES,,AUTO

      250    15232    4            DO FOREVER;

      251    15233    4              CALL ASL$FIND_CONTROLLER (DSEG1$, I, CONT_NAME, CONT$) ALTRET (FINISH_UP
             15233                        );

  15233  2 000373   200007 630500                    EPPR0   CONT$,,AUTO
         2 000374   200035 450500                    STP0    WILD_CARD+5,,AUTO
         2 000375   200010 631500                    EPPR1   CONT_NAME,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:35   
         2 000376   200034 451500                    STP1    WILD_CARD+4,,AUTO
         2 000377   200021 633500                    EPPR3   I,,AUTO
         2 000400   200033 453500                    STP3    WILD_CARD+3,,AUTO
         2 000401   000010 236000 3                  LDQ     8
         2 000402   200032 756100                    STQ     WILD_CARD+2,,AUTO
         2 000403   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000404   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000405   000000 701000 xent               TSX1    ASL$FIND_CONTROLLER
         2 000406   001054 702000 2                  TSX2    FINISH_UP

      252    15234    5               IF DISP AND DISP_CONTROLLERS = 0 THEN DO;

  15234  2 000407   200013 234100                    SZN     DISP,,AUTO
         2 000410   000506 605000 2                  TPL     s:15248
         2 000411   200014 235100                    LDA     DISP_CONTROLLERS,,AUTO
         2 000412   000506 601000 2                  TNZ     s:15248

      253    15235    6                  IF JCL THEN DO;

  15235  2 000413   200023 234100                    SZN     JCL,,AUTO
         2 000414   000441 605000 2                  TPL     s:15240

      254    15236    6                     CALL CONCAT (FMT_BUF, '%1/"   ', LINE_STR, '   ', LINE_NAME.TEXT,
             15236                              '%2/');

  15236  2 000415   040000 100400                    MLR     fill='040'O
         2 000416   000022 000007 1                  ADSC9   FOUND_STR+4              cn=0,n=7
         2 000417   000000 000007 xsym               ADSC9   FMT_BUF                  cn=0,n=7
         2 000420   040000 100400                    MLR     fill='040'O
         2 000421   000000 000004 1                  ADSC9   LINE_STR                 cn=0,n=4
         2 000422   000001 600004 xsym               ADSC9   FMT_BUF+1                cn=3,n=4
         2 000423   040000 100400                    MLR     fill='040'O
         2 000424   000023 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000425   000002 600004 xsym               ADSC9   FMT_BUF+2                cn=3,n=4
         2 000426   040000 100500                    MLR     fill='040'O
         2 000427   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000430   000003 600010 xsym               ADSC9   FMT_BUF+3                cn=3,n=8
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:36   
         2 000431   040000 100400                    MLR     fill='040'O
         2 000432   000024 000003 1                  ADSC9   FOUND_STR+6              cn=0,n=3
         2 000433   000005 600350 xsym               ADSC9   FMT_BUF+5                cn=3,n=232

      255    15237    6                     FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 21;

  15237  2 000434   000000 236000 xsym               LDQ     FDS
         2 000435   177777 376007                    ANQ     65535,DL
         2 000436   000012 276000 3                  ORQ     10
         2 000437   000000 756000 xsym               STQ     FDS

      256    15238    6                     END; /*  Jcl  */

  15238  2 000440   000464 710000 2                  TRA     s:15243

      257    15239    6                  ELSE DO;

      258    15240    6                     CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', LINE_NAME.TEXT,
             15240                              '%2/');

  15240  2 000441   040000 100400                    MLR     fill='040'O
         2 000442   000025 000006 1                  ADSC9   FOUND_STR+7              cn=0,n=6
         2 000443   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000444   040000 100400                    MLR     fill='040'O
         2 000445   000000 000004 1                  ADSC9   LINE_STR                 cn=0,n=4
         2 000446   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 000447   040000 100400                    MLR     fill='040'O
         2 000450   000023 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000451   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000452   040000 100500                    MLR     fill='040'O
         2 000453   200024 200010                    ADSC9   LINE_NAME,,AUTO          cn=1,n=8
         2 000454   000003 400010 xsym               ADSC9   FMT_BUF+3                cn=2,n=8
         2 000455   040000 100400                    MLR     fill='040'O
         2 000456   000024 000003 1                  ADSC9   FOUND_STR+6              cn=0,n=3
         2 000457   000005 400351 xsym               ADSC9   FMT_BUF+5                cn=2,n=233

      259    15241    6                     FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 20;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:37   

  15241  2 000460   000000 236000 xsym               LDQ     FDS
         2 000461   177777 376007                    ANQ     65535,DL
         2 000462   000006 276003                    ORQ     6,DU
         2 000463   000000 756000 xsym               STQ     FDS

      260    15242    6                     END; /*  Not jcl  */

      261    15243    5                  FDS.NVECS# = 0;

  15243  2 000464   000011 450000 xsym               STZ     FDS+9

      262    15244    5                  CALL X$FORMAT (FDS);

  15244  2 000465   000004 630400 3                  EPPR0   4
         2 000466   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000467   000000 701000 xent               TSX1    X$FORMAT
         2 000470   000000 011000                    NOP     0

      263    15245    5                  CALL ASL$DISP_ONE_CONTROLLER (CONT$, JCL, LINE_NAME.TEXT);

  15245  2 000471   200035 452500                    STP2    WILD_CARD+5,,AUTO
         2 000472   200035 236100                    LDQ     WILD_CARD+5,,AUTO
         2 000473   000013 036000 3                  ADLQ    11
         2 000474   200034 756100                    STQ     WILD_CARD+4,,AUTO
         2 000475   200023 630500                    EPPR0   JCL,,AUTO
         2 000476   200033 450500                    STP0    WILD_CARD+3,,AUTO
         2 000477   200007 631500                    EPPR1   CONT$,,AUTO
         2 000500   200032 451500                    STP1    WILD_CARD+2,,AUTO
         2 000501   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000502   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000503   000000 701000 xent               TSX1    ASL$DISP_ONE_CONTROLLER
         2 000504   000000 011000                    NOP     0

      264    15246    5                  END; /*  Disp  */

  15246  2 000505   000544 710000 2                  TRA     s:15257
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:38   

      265    15247    5               ELSE DO;

      266    15248    5                  FMT_BUF = '%1/   %A  %A  %A  %2D';

  15248  2 000506   040000 100400                    MLR     fill='040'O
         2 000507   000027 000025 1                  ADSC9   FOUND_STR+9              cn=0,n=21
         2 000510   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      267    15249    5                  FDS.FMT_.BOUND = 20;

  15249  2 000511   000000 236000 xsym               LDQ     FDS
         2 000512   177777 376007                    ANQ     65535,DL
         2 000513   000005 276003                    ORQ     5,DU
         2 000514   000000 756000 xsym               STQ     FDS

      268    15250    5                  FDS.NVECS# = 4;

  15250  2 000515   000004 235007                    LDA     4,DL
         2 000516   000011 755000 xsym               STA     FDS+9

      269    15251    5                  FMT_VEC (0) = VECTOR (LINE_STR);

  15251  2 000517   000014 237000 3                  LDAQ    12
         2 000520   000000 755000 xsym               STA     FMT_VEC
         2 000521   000001 756000 xsym               STQ     FMT_VEC+1

      270    15252    5                  FMT_VEC (1) = VECTOR (LINE_NAME.TEXT);

  15252  2 000522   000016 235000 3                  LDA     14
         2 000523   200032 452500                    STP2    WILD_CARD+2,,AUTO
         2 000524   200032 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000525   000013 036000 3                  ADLQ    11
         2 000526   000002 755000 xsym               STA     FMT_VEC+2
         2 000527   000003 756000 xsym               STQ     FMT_VEC+3

      271    15253    5                  FMT_VEC (2) = VECTOR (CONTROLLER_STR);
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:39   

  15253  2 000530   000020 237000 3                  LDAQ    16
         2 000531   000004 755000 xsym               STA     FMT_VEC+4
         2 000532   000005 756000 xsym               STQ     FMT_VEC+5

      272    15254    5                  FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);

  15254  2 000533   177640 235007                    LDA     65440,DL
         2 000534   200007 236100                    LDQ     CONT$,,AUTO
         2 000535   000002 036003                    ADLQ    2,DU
         2 000536   000006 755000 xsym               STA     FMT_VEC+6
         2 000537   000007 756000 xsym               STQ     FMT_VEC+7

      273    15255    5                  CALL X$FORMAT (FDS);

  15255  2 000540   000004 630400 3                  EPPR0   4
         2 000541   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000542   000000 701000 xent               TSX1    X$FORMAT
         2 000543   000000 011000                    NOP     0

      274    15256    5                  END; /*  ~ disp  */

      275    15257    4               DISP_CONTROLLERS = DISP_CONTROLLERS + 1;

  15257  2 000544   200014 054100                    AOS     DISP_CONTROLLERS,,AUTO

      276    15258    4               END; /*  Forever  */

  15258  2 000545   000373 710000 2                  TRA     s:15233

      277    15259    3            END;  /*  Whenreturn  */
      278    15260    3         WHENALTRETURN DO;

      279    15261    3            IF MERR_CODE.CODE = %E$NOKEY

  15261  2 000546   000000 236000 xsym               LDQ     ERR_CODE
         2 000547   377770 376007                    ANQ     131064,DL
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:40   
         2 000550   001020 116007                    CMPQ    528,DL
         2 000551   000562 601000 2                  TNZ     s:15281

      280    15262    4            THEN DO;

      281    15263    4               AS_FIELD1 = LINE_NAME;

  15263  2 000552   000000 100500                    MLR     fill='000'O
         2 000553   200024 000011                    ADSC9   LINE_NAME,,AUTO          cn=0,n=9
         2 000554   000000 000051 xsym               ADSC9   AS_FIELD1                cn=0,n=41

      282    15264                    %SCREAM( ERR#=E$LINE_NO_EXIST2, MID='L', LEVEL=ERROR );

  15276  2 000555   000017 630400 3                  EPPR0   15
         2 000556   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000557   000000 701000 xent               TSX1    ASH$ERROR
         2 000560   000000 011000                    NOP     0

      283    15279    4               END;  /*  Error = nokey  */

  15279  2 000561   000566 710000 2                  TRA     s:15284

      284    15280    4            ELSE DO;

      285    15281    4               CALL ASA$ERROR( USERS_KEY, E$UNABLE_TO_READ_HLP );

  15281  2 000562   000023 630400 3                  EPPR0   19
         2 000563   000020 631400 xsym               EPPR1   B_VECTNIL+16
         2 000564   000000 701000 xent               TSX1    ASA$ERROR
         2 000565   000000 011000                    NOP     0

      286    15282    4               END;  /* Error ~= nokey */

      287    15283    3            END;  /*  Whenaltreturn  */

      288    15284    2         GOTO FINISH_UP;

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:41   
  15284  2 000566   001054 710000 2                  TRA     FINISH_UP

      289    15285    2         END; /*  Else  */
      290    15286    1   CALL ASB$PREC_HLP ;

  15286  2 000567   000002 631400 xsym               EPPR1   B_VECTNIL+2
         2 000570   000000 701000 xent               TSX1    ASB$PREC_HLP
         2 000571   000000 011000                    NOP     0

      291    15287    2   DO FOREVER;

      292    15288
      293    15289    3      DO UNTIL LINE$DREC.ATYP = %KLAT_LINE# ;

      294    15290    3         I = DSEG1SIZE;

  15290  2 000572   000000 235000 xsym               LDA     DSEG1SIZE
         2 000573   200021 755100                    STA     I,,AUTO

      295    15291    3         CALL ASB$READ_HLP_SEQ(DSEG1$,I,1)

  15291  2 000574   000007 236000 3                  LDQ     7
         2 000575   200034 756100                    STQ     WILD_CARD+4,,AUTO
         2 000576   200021 630500                    EPPR0   I,,AUTO
         2 000577   200033 450500                    STP0    WILD_CARD+3,,AUTO
         2 000600   000010 236000 3                  LDQ     8
         2 000601   200032 756100                    STQ     WILD_CARD+2,,AUTO
         2 000602   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000603   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 000604   000000 701000 xent               TSX1    ASB$READ_HLP_SEQ
         2 000605   000607 702000 2                  TSX2    s:15293
         2 000606   000620 710000 2                  TRA     s:15296

      296    15292    4         WHENALTRETURN DO;

      297    15293    4            IF MERR_CODE.CODE ~= %E$EOF THEN CALL ASH$ERROR(MERR_CODE);

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:42   
  15293  2 000607   000000 236000 xsym               LDQ     ERR_CODE
         2 000610   377770 376007                    ANQ     131064,DL
         2 000611   000060 116007                    CMPQ    48,DL
         2 000612   000617 600000 2                  TZE     s:15294

  15293  2 000613   000025 630400 3                  EPPR0   21
         2 000614   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000615   000000 701000 xent               TSX1    ASH$ERROR
         2 000616   000000 011000                    NOP     0

      298    15294    4            GOTO FINISH_UP;

  15294  2 000617   001054 710000 2                  TRA     FINISH_UP

      299    15295    4            END;  /*  Whenaltreturn  */
      300    15296    3         END;  /*  Do until we find a line record  */

  15296  2 000620   000000 470400 xsym               LDP0    DSEG1$
         2 000621   000000 236100                    LDQ     0,,PR0
         2 000622   777000 376003                    ANQ     -512,DU
         2 000623   005000 116003                    CMPQ    2560,DU
         2 000624   000572 601000 2                  TNZ     s:15290

      301    15297    2      CALL INDEX (I,' ',SUBSTR(USERS_KEY.TXTC,0,8)) ;

  15297  2 000625   000000 124400                    SCM     mask='000'O
         2 000626   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000627   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
         2 000630   200021 000100                    ARG     I,,AUTO

      302    15298    2      IF I > 8 THEN I = 8;

  15298  2 000631   200021 235100                    LDA     I,,AUTO
         2 000632   000011 115007                    CMPA    9,DL
         2 000633   000636 602000 2                  TNC     s:15299

  15298  2 000634   000010 236007                    LDQ     8,DL
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:43   
         2 000635   200021 756100                    STQ     I,,AUTO

      303    15299    2      CURRENT_LINE = SUBSTR(USERS_KEY.TXTC,0,I);

  15299  2 000636   200021 720100                    LXL0    I,,AUTO
         2 000637   040100 100440                    MLR     fill='040'O
         2 000640   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=*X0
         2 000641   200011 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8

      304    15300    3      IF WILD_CARD THEN DO;

  15300  2 000642   200030 234100                    SZN     WILD_CARD,,AUTO
         2 000643   000673 605000 2                  TPL     s:15310

      305    15301    3         J = LINE_NAME.COUNT;

  15301  2 000644   200024 236100                    LDQ     LINE_NAME,,AUTO
         2 000645   000033 772000                    QRL     27
         2 000646   200022 756100                    STQ     J,,AUTO

      306    15302    3         CALL ASB$WILD_MATCH (I, CURRENT_LINE, J, LINE_NAME.TEXT)

  15302  2 000647   200036 452500                    STP2    WILD_CARD+6,,AUTO
         2 000650   200036 236100                    LDQ     WILD_CARD+6,,AUTO
         2 000651   000013 036000 3                  ADLQ    11
         2 000652   200035 756100                    STQ     WILD_CARD+5,,AUTO
         2 000653   200022 631500                    EPPR1   J,,AUTO
         2 000654   200034 451500                    STP1    WILD_CARD+4,,AUTO
         2 000655   200011 633500                    EPPR3   CURRENT_LINE,,AUTO
         2 000656   200033 453500                    STP3    WILD_CARD+3,,AUTO
         2 000657   200021 634500                    EPPR4   I,,AUTO
         2 000660   200032 454500                    STP4    WILD_CARD+2,,AUTO
         2 000661   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000662   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000663   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000664   000666 702000 2                  TSX2    s:15304
         2 000665   000673 710000 2                  TRA     s:15310
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:44   

      307    15303    4         WHENALTRETURN DO;

      308    15304    4            IF CURRENT_LINE > END_KEY.TEXT THEN

  15304  2 000666   040100 106500                    CMPC    fill='040'O
         2 000667   200017 000010                    ADSC9   END_KEY+1,,AUTO          cn=0,n=8
         2 000670   200011 000010                    ADSC9   CURRENT_LINE,,AUTO       cn=0,n=8
         2 000671   001054 602000 2                  TNC     FINISH_UP

      309    15305    4               GOTO FINISH_UP;
      310    15306    4            ELSE
      311    15307    4               GOTO END_FOREVER;

  15307  2 000672   001053 710000 2                  TRA     END_FOREVER

      312    15308    4            END;  /*  Whenaltreturn  */
      313    15309    3         END; /*  WILD_CARD  */

      314    15310    2      NEW_LINE# = %YES#;

  15310  2 000673   400000 236003                    LDQ     -131072,DU
         2 000674   200027 756100                    STQ     NEW_LINE#,,AUTO

      315    15311    2      DISP_LINES = DISP_LINES + 1;

  15311  2 000675   200015 054100                    AOS     DISP_LINES,,AUTO

      316    15312    2      I = SIZEW (LINE$DREC) + LINE$DREC.NWINFO;

  15312  2 000676   000000 470400 xsym               LDP0    DSEG1$
         2 000677   000017 235100                    LDA     15,,PR0
         2 000700   000020 035007                    ADLA    16,DL
         2 000701   200021 755100                    STA     I,,AUTO

      317    15313    2      CONT$ = DSEG1$;

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:45   
  15313  2 000702   000000 236000 xsym               LDQ     DSEG1$
         2 000703   200007 756100                    STQ     CONT$,,AUTO

      318    15314    3      DO FOREVER;

      319    15315    3         CALL ASL$FIND_CONTROLLER (DSEG1$, I, CONT_NAME, CONT$) ALTRET (END_FOREVER);

  15315  2 000704   200007 630500                    EPPR0   CONT$,,AUTO
         2 000705   200035 450500                    STP0    WILD_CARD+5,,AUTO
         2 000706   200010 631500                    EPPR1   CONT_NAME,,AUTO
         2 000707   200034 451500                    STP1    WILD_CARD+4,,AUTO
         2 000710   200021 633500                    EPPR3   I,,AUTO
         2 000711   200033 453500                    STP3    WILD_CARD+3,,AUTO
         2 000712   000010 236000 3                  LDQ     8
         2 000713   200032 756100                    STQ     WILD_CARD+2,,AUTO
         2 000714   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000715   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000716   000000 701000 xent               TSX1    ASL$FIND_CONTROLLER
         2 000717   001053 702000 2                  TSX2    END_FOREVER

      320    15316    4         IF DISP THEN DO;

  15316  2 000720   200013 234100                    SZN     DISP,,AUTO
         2 000721   001013 605000 2                  TPL     s:15333

      321    15317    5            IF NEW_LINE# THEN DO;

  15317  2 000722   200027 234100                    SZN     NEW_LINE#,,AUTO
         2 000723   001000 605000 2                  TPL     s:15330

      322    15318    5               NEW_LINE# = %NO#;

  15318  2 000724   200027 450100                    STZ     NEW_LINE#,,AUTO

      323    15319    6               IF JCL THEN DO;

  15319  2 000725   200023 234100                    SZN     JCL,,AUTO
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:46   
         2 000726   000753 605000 2                  TPL     s:15324

      324    15320    6                  CALL CONCAT (FMT_BUF, '%1/"   ', LINE_STR, '    ', SUBSTR(USERS_KEY.
             15320                           TXTC,0,8),'%2/');

  15320  2 000727   040000 100400                    MLR     fill='040'O
         2 000730   000022 000007 1                  ADSC9   FOUND_STR+4              cn=0,n=7
         2 000731   000000 000007 xsym               ADSC9   FMT_BUF                  cn=0,n=7
         2 000732   040000 100400                    MLR     fill='040'O
         2 000733   000000 000004 1                  ADSC9   LINE_STR                 cn=0,n=4
         2 000734   000001 600004 xsym               ADSC9   FMT_BUF+1                cn=3,n=4
         2 000735   040000 100400                    MLR     fill='040'O
         2 000736   000023 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000737   000002 600004 xsym               ADSC9   FMT_BUF+2                cn=3,n=4
         2 000740   040000 100400                    MLR     fill='040'O
         2 000741   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000742   000003 600010 xsym               ADSC9   FMT_BUF+3                cn=3,n=8
         2 000743   040000 100400                    MLR     fill='040'O
         2 000744   000024 000003 1                  ADSC9   FOUND_STR+6              cn=0,n=3
         2 000745   000005 600350 xsym               ADSC9   FMT_BUF+5                cn=3,n=232

      325    15321    6                  FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 21;

  15321  2 000746   000000 236000 xsym               LDQ     FDS
         2 000747   177777 376007                    ANQ     65535,DL
         2 000750   000012 276000 3                  ORQ     10
         2 000751   000000 756000 xsym               STQ     FDS

      326    15322    6                  END;  /*  Jcl  */

  15322  2 000752   000773 710000 2                  TRA     s:15327

      327    15323    6               ELSE DO;

      328    15324    6                  CALL CONCAT (FMT_BUF, '%1/   ', LINE_STR, '    ', SUBSTR(USERS_KEY.
             15324                           TXTC,0,8));

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:47   
  15324  2 000753   040000 100400                    MLR     fill='040'O
         2 000754   000025 000006 1                  ADSC9   FOUND_STR+7              cn=0,n=6
         2 000755   000000 000006 xsym               ADSC9   FMT_BUF                  cn=0,n=6
         2 000756   040000 100400                    MLR     fill='040'O
         2 000757   000000 000004 1                  ADSC9   LINE_STR                 cn=0,n=4
         2 000760   000001 400004 xsym               ADSC9   FMT_BUF+1                cn=2,n=4
         2 000761   040000 100400                    MLR     fill='040'O
         2 000762   000023 000004 1                  ADSC9   FOUND_STR+5              cn=0,n=4
         2 000763   000002 400004 xsym               ADSC9   FMT_BUF+2                cn=2,n=4
         2 000764   040000 100400                    MLR     fill='040'O
         2 000765   000000 200010 xsym               ADSC9   USERS_KEY                cn=1,n=8
         2 000766   000003 400361 xsym               ADSC9   FMT_BUF+3                cn=2,n=241

      329    15325    6                  FDS.FMT_.BOUND = LENGTHC(LINE_STR) + 17;

  15325  2 000767   000000 236000 xsym               LDQ     FDS
         2 000770   177777 376007                    ANQ     65535,DL
         2 000771   000026 276000 3                  ORQ     22
         2 000772   000000 756000 xsym               STQ     FDS

      330    15326    6                  END;  /*  Not jcl  */

      331    15327    5               FDS.NVECS# = 0;

  15327  2 000773   000011 450000 xsym               STZ     FDS+9

      332    15328    5               CALL X$FORMAT (FDS);

  15328  2 000774   000004 630400 3                  EPPR0   4
         2 000775   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000776   000000 701000 xent               TSX1    X$FORMAT
         2 000777   000000 011000                    NOP     0

      333    15329    5               END;  /*  DISP_CONTROLLER = 0  */

      334    15330    4            CALL ASL$DISP_ONE_CONTROLLER (CONT$, JCL, CURRENT_LINE);

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:48   
  15330  2 001000   200011 630500                    EPPR0   CURRENT_LINE,,AUTO
         2 001001   200034 450500                    STP0    WILD_CARD+4,,AUTO
         2 001002   200023 631500                    EPPR1   JCL,,AUTO
         2 001003   200033 451500                    STP1    WILD_CARD+3,,AUTO
         2 001004   200007 633500                    EPPR3   CONT$,,AUTO
         2 001005   200032 453500                    STP3    WILD_CARD+2,,AUTO
         2 001006   200032 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 001007   000021 631400 xsym               EPPR1   B_VECTNIL+17
         2 001010   000000 701000 xent               TSX1    ASL$DISP_ONE_CONTROLLER
         2 001011   000000 011000                    NOP     0

      335    15331    4            END;  /*  Disp  */

  15331  2 001012   001051 710000 2                  TRA     s:15342

      336    15332    4         ELSE DO;

      337    15333    4            FMT_BUF = '%1/   %A  %A  %A  %2D';

  15333  2 001013   040000 100400                    MLR     fill='040'O
         2 001014   000027 000025 1                  ADSC9   FOUND_STR+9              cn=0,n=21
         2 001015   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      338    15334    4            FDS.FMT_.BOUND = 20;

  15334  2 001016   000000 236000 xsym               LDQ     FDS
         2 001017   177777 376007                    ANQ     65535,DL
         2 001020   000005 276003                    ORQ     5,DU
         2 001021   000000 756000 xsym               STQ     FDS

      339    15335    4            FDS.NVECS# = 4;

  15335  2 001022   000004 235007                    LDA     4,DL
         2 001023   000011 755000 xsym               STA     FDS+9

      340    15336    4            FMT_VEC (0) = VECTOR (LINE_STR);

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:49   
  15336  2 001024   000014 237000 3                  LDAQ    12
         2 001025   000000 755000 xsym               STA     FMT_VEC
         2 001026   000001 756000 xsym               STQ     FMT_VEC+1

      341    15337    4            FMT_VEC (1) = VECTOR (CURRENT_LINE);

  15337  2 001027   000016 235000 3                  LDA     14
         2 001030   200032 452500                    STP2    WILD_CARD+2,,AUTO
         2 001031   200032 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001032   000011 036003                    ADLQ    9,DU
         2 001033   000002 755000 xsym               STA     FMT_VEC+2
         2 001034   000003 756000 xsym               STQ     FMT_VEC+3

      342    15338    4            FMT_VEC (2) = VECTOR (CONTROLLER_STR);

  15338  2 001035   000020 237000 3                  LDAQ    16
         2 001036   000004 755000 xsym               STA     FMT_VEC+4
         2 001037   000005 756000 xsym               STQ     FMT_VEC+5

      343    15339    4            FMT_VEC (3) = VECTOR (KL$CONTROLLER.CONT#);

  15339  2 001040   177640 235007                    LDA     65440,DL
         2 001041   200007 236100                    LDQ     CONT$,,AUTO
         2 001042   000002 036003                    ADLQ    2,DU
         2 001043   000006 755000 xsym               STA     FMT_VEC+6
         2 001044   000007 756000 xsym               STQ     FMT_VEC+7

      344    15340    4            CALL X$FORMAT (FDS);

  15340  2 001045   000004 630400 3                  EPPR0   4
         2 001046   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001047   000000 701000 xent               TSX1    X$FORMAT
         2 001050   000000 011000                    NOP     0

      345    15341    4            END;  /*  ~ disp  */

      346    15342    3         DISP_CONTROLLERS = DISP_CONTROLLERS + 1;
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:50   

  15342  2 001051   200014 054100                    AOS     DISP_CONTROLLERS,,AUTO

      347    15343    3         END;  /*  Forever  */

  15343  2 001052   000704 710000 2                  TRA     s:15315

      348    15344    2   END_FOREVER:
      349    15345    2      END;  /*  Do forever  */

  15345  2 001053   000572 710000 2     END_FOREVER  TRA     s:15290

      350    15346    1   FINISH_UP:
      351    15347    2   IF NOT DISP THEN DO;

  15347  2 001054   200013 234100       FINISH_UP    SZN     DISP,,AUTO
         2 001055   001072 604000 2                  TMI     s:15353

      352    15348    2      FMT_BUF = '%\%/';

  15348  2 001056   040000 100400                    MLR     fill='040'O
         2 001057   000036 000004 1                  ADSC9   FOUND_STR+16             cn=0,n=4
         2 001060   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      353    15349    2      FDS.FMT_.BOUND = 3;

  15349  2 001061   000000 236000 xsym               LDQ     FDS
         2 001062   177777 376007                    ANQ     65535,DL
         2 001063   600000 276007                    ORQ     -65536,DL
         2 001064   000000 756000 xsym               STQ     FDS

      354    15350    2      FDS.NVECS# = 0;

  15350  2 001065   000011 450000 xsym               STZ     FDS+9

      355    15351    2      CALL X$FORMAT(FDS);

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:51   
  15351  2 001066   000004 630400 3                  EPPR0   4
         2 001067   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001070   000000 701000 xent               TSX1    X$FORMAT
         2 001071   000000 011000                    NOP     0

      356    15352    2      END; /*  If not disp  */

      357    15353    2   IF NOT JCL THEN DO;

  15353  2 001072   200023 234100                    SZN     JCL,,AUTO
         2 001073   001202 604000 2                  TMI     s:15387

      358    15354    2      FMT_VEC(0) = VECTOR (DISP_LINES);

  15354  2 001074   777640 235007                    LDA     -96,DL
         2 001075   200032 452500                    STP2    WILD_CARD+2,,AUTO
         2 001076   200032 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001077   000015 036003                    ADLQ    13,DU
         2 001100   000000 755000 xsym               STA     FMT_VEC
         2 001101   000001 756000 xsym               STQ     FMT_VEC+1

      359    15355    2      IF DISP_LINES = 1 THEN

  15355  2 001102   200015 235100                    LDA     DISP_LINES,,AUTO
         2 001103   000001 115007                    CMPA    1,DL
         2 001104   001111 601000 2                  TNZ     s:15360

      360    15356    3      DO;

      361    15357    3         FMT_VEC(1) = VECTOR (LINE_STR);

  15357  2 001105   000014 237000 3                  LDAQ    12
         2 001106   000002 755000 xsym               STA     FMT_VEC+2
         2 001107   000003 756000 xsym               STQ     FMT_VEC+3

      362    15358    3         END; /*  DISP_LINES = 1  */

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:52   
  15358  2 001110   001114 710000 2                  TRA     s:15362

      363    15359    3      ELSE DO;

      364    15360    3         FMT_VEC(1) = VECTOR (LINES_STR);

  15360  2 001111   000030 237000 3                  LDAQ    24
         2 001112   000002 755000 xsym               STA     FMT_VEC+2
         2 001113   000003 756000 xsym               STQ     FMT_VEC+3

      365    15361    3         END; /*  DISP_LINES ~= 1  */

      366    15362    2      FMT_VEC(2) = VECTOR (FOUND_STR);

  15362  2 001114   000032 237000 3                  LDAQ    26
         2 001115   000004 755000 xsym               STA     FMT_VEC+4
         2 001116   000005 756000 xsym               STQ     FMT_VEC+5

      367    15363    2      FDS.NVECS# = 3;

  15363  2 001117   000003 235007                    LDA     3,DL
         2 001120   000011 755000 xsym               STA     FDS+9

      368    15364    2      FMT_BUF = '   %5D %A %A.';

  15364  2 001121   040000 100400                    MLR     fill='040'O
         2 001122   000037 000015 1                  ADSC9   FOUND_STR+17             cn=0,n=13
         2 001123   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      369    15365    2      FDS.FMT_.BOUND = 12;

  15365  2 001124   000000 236000 xsym               LDQ     FDS
         2 001125   177777 376007                    ANQ     65535,DL
         2 001126   000003 276003                    ORQ     3,DU
         2 001127   000000 756000 xsym               STQ     FDS

      370    15366    2      CALL X$FORMAT(FDS);
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:53   

  15366  2 001130   000004 630400 3                  EPPR0   4
         2 001131   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001132   000000 701000 xent               TSX1    X$FORMAT
         2 001133   000000 011000                    NOP     0

      371    15367    2      FMT_VEC(0) = VECTOR (DISP_CONTROLLERS);

  15367  2 001134   777640 235007                    LDA     -96,DL
         2 001135   200032 452500                    STP2    WILD_CARD+2,,AUTO
         2 001136   200032 236100                    LDQ     WILD_CARD+2,,AUTO
         2 001137   000014 036003                    ADLQ    12,DU
         2 001140   000000 755000 xsym               STA     FMT_VEC
         2 001141   000001 756000 xsym               STQ     FMT_VEC+1

      372    15368    2      IF DISP_CONTROLLERS = 1 THEN

  15368  2 001142   200014 235100                    LDA     DISP_CONTROLLERS,,AUTO
         2 001143   000001 115007                    CMPA    1,DL
         2 001144   001151 601000 2                  TNZ     s:15373

      373    15369    3      DO;

      374    15370    3         FMT_VEC(1) = VECTOR (CONTROLLER_STR);

  15370  2 001145   000020 237000 3                  LDAQ    16
         2 001146   000002 755000 xsym               STA     FMT_VEC+2
         2 001147   000003 756000 xsym               STQ     FMT_VEC+3

      375    15371    3         END; /*  DISP_CONTROLLERS = 1  */

  15371  2 001150   001154 710000 2                  TRA     s:15375

      376    15372    3      ELSE DO;

      377    15373    3         FMT_VEC(1) = VECTOR (CONTROLLERS_STR);

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:54   
  15373  2 001151   000034 237000 3                  LDAQ    28
         2 001152   000002 755000 xsym               STA     FMT_VEC+2
         2 001153   000003 756000 xsym               STQ     FMT_VEC+3

      378    15374    3         END; /*  DISP_CONTROLLERS ~= 1  */

      379    15375    2      IF DISP THEN

  15375  2 001154   200013 234100                    SZN     DISP,,AUTO
         2 001155   001162 605000 2                  TPL     s:15380

      380    15376    3      DO;

      381    15377    3         FMT_VEC(2) = VECTOR (DISPLAY_STR);

  15377  2 001156   000036 237000 3                  LDAQ    30
         2 001157   000004 755000 xsym               STA     FMT_VEC+4
         2 001160   000005 756000 xsym               STQ     FMT_VEC+5

      382    15378    3         END; /*  If disp  */

  15378  2 001161   001165 710000 2                  TRA     s:15382

      383    15379    3      ELSE DO;

      384    15380    3         FMT_VEC(2) = VECTOR (LIST_STR);

  15380  2 001162   000040 237000 3                  LDAQ    32
         2 001163   000004 755000 xsym               STA     FMT_VEC+4
         2 001164   000005 756000 xsym               STQ     FMT_VEC+5

      385    15381    3         END; /*  If ~ disp  */

      386    15382    2      FDS.NVECS# = 3;

  15382  2 001165   000003 235007                    LDA     3,DL
         2 001166   000011 755000 xsym               STA     FDS+9
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:55   

      387    15383    2      FMT_BUF = '   %5D %A %A.';

  15383  2 001167   040000 100400                    MLR     fill='040'O
         2 001170   000037 000015 1                  ADSC9   FOUND_STR+17             cn=0,n=13
         2 001171   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      388    15384    2      FDS.FMT_.BOUND = 12;

  15384  2 001172   000000 236000 xsym               LDQ     FDS
         2 001173   177777 376007                    ANQ     65535,DL
         2 001174   000003 276003                    ORQ     3,DU
         2 001175   000000 756000 xsym               STQ     FDS

      389    15385    2      CALL X$FORMAT(FDS);

  15385  2 001176   000004 630400 3                  EPPR0   4
         2 001177   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 001200   000000 701000 xent               TSX1    X$FORMAT
         2 001201   000000 011000                    NOP     0

      390    15386    2      END; /* Not jcl */

      391    15387    1   RETURN;

  15387  2 001202   000000 702200 xent               TSX2  ! X66_ARET
      392    15388    1   END ASL$LIST_ALL_CONTROLLERS;
      393    15389        %EOD;

PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:56   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   OCI_SUBS_C.:E05TOU  is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$LIST_ALL_CONTROLLERS.
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:57   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$LIST_ALL_CONTROLLERS

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/c CHAR(11)    r     1 CONTROLLERS_STR            3-0-0/c CHAR(10)    r     1 CONTROLLER_STR
    13-0-0/c CHAR(9)     r     1 DISPLAY_STR               16-0-0/c CHAR(5)     r     1 FOUND_STR
     1-0-0/c CHAR(5)     r     1 LINES_STR                  0-0-0/c CHAR(4)     r     1 LINE_STR
    11-0-0/c CHAR(6)     r     1 LIST_STR

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/b BIT         r     1 ALL_LINES                  4-0-0/w STRC(108)   r     1 BEGIN_KEY
     7-0-0/w PTR         r     1 CONT$                     10-0-0/c STRC(27)    r     1 CONT_NAME
    11-0-0/c CHAR(8)     r     1 CURRENT_LINE              13-0-0/b BIT         r     1 DISP
    14-0-0/w SBIN        r     1 DISP_CONTROLLERS          15-0-0/w SBIN        r     1 DISP_LINES
    16-0-0/w STRC(108)   r     1 END_KEY                   21-0-0/w UBIN        r     1 I
    22-0-0/w UBIN        r     1 J                         23-0-0/b BIT         r     1 JCL
    24-0-0/c STRC(81)    r     1 LINE_NAME                 27-0-0/b BIT         r     1 NEW_LINE#
    30-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(369)   r     1 AS_FIELD1                  0-0-0/w UBIN        r     1 CODE
     0-0-0/w PTR         r     1 DSEG1$                     0-0-0/w UBIN        r     1 DSEG1SIZE
     0-0-0/b STRC        r     1 ERR_CODE                   0-0-0/w STRC(1080)  r     1 FDS
     0-0-0/c CHAR(255)   r     1 FMT_BUF                    0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)
     0-0-0/b STRC        r     1 MERR_CODE                  0-0-0/w PTR         r     1 NODE$
     0-0-0/w STRC(504)   r     1 P_PCB                      0-0-0/c STRC(378)   r     1 USERS_KEY
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:58   

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL$CONTROLLER              0-0-0/w STRC(576)   r     1 LINE$DREC
     0-0-0/w STRC(144)   r     1 P$B                        0-0-0/w ASTR(153)   r     1 P$S


   Procedure ASL$LIST_ALL_CONTROLLERS requires 643 words for executable code.
   Procedure ASL$LIST_ALL_CONTROLLERS requires 32 words of local(AUTO) storage.
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:59   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:60   
          MINI XREF LISTING

ALL_LINES
     15076**DCL     15178<<ASSIGN  15180<<ASSIGN  15197>>IF
ASA$ERROR
     14707**DCL-ENT 15281--CALL
ASA_BRKS_LOC
     11839**DCL     11839--REDEF
ASB$PREC_HLP
     14695**DCL-ENT 15286--CALL
ASB$READ_HLP
     14698**DCL-ENT 15208--CALL
ASB$READ_HLP_SEQ
     14701**DCL-ENT 15291--CALL
ASB$WILD_MATCH
     14716**DCL-ENT 15302--CALL
ASH$ERROR
     14704**DCL-ENT 15224--CALL    15276--CALL    15293--CALL
ASL$DISP_ONE_CONTROLLER
     14713**DCL-ENT 15245--CALL    15330--CALL
ASL$FIND_CONTROLLER
     14710**DCL-ENT 15233--CALL    15315--CALL
AS_DEFAULT.BANNER_PERM
     12532**DCL     12533--REDEF
AS_DEFAULT.BUDGET.MACCT
     12437**DCL     12441--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12450**DCL     12453--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12433**DCL     12435--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12428**DCL     12430--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12548**DCL     12549--REDEF   12550--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:61   
AS_DEFAULT_DREC.PASSWORD
     13802**DCL     13806--REDEF
AS_DEFAULT_DREC.RENAME
     13825**DCL     13826--REDEF
AS_DFLT.BANNER_PERM
     12354**DCL     12355--REDEF
AS_DFLT.BUDGET.MACCT
     12259**DCL     12263--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12272**DCL     12275--REDEF
AS_DFLT.BUDGET.PACCUM
     12255**DCL     12257--REDEF
AS_DFLT.BUDGET.PMAXC
     12250**DCL     12252--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12370**DCL     12371--REDEF   12372--REDEF
AS_FE_MODE
     11705**DCL     11706--REDEF
AS_FIELD1
     11835**DCL     15211<<ASSIGN  15263<<ASSIGN
AS_MODE
     11702**DCL     11704--REDEF
AS_MOD_USER.ACCESS
     14567**DCL     14568--REDEF
AS_MOD_USER.BANNER
     14554**DCL     14555--REDEF
AS_MOD_USER.BANNER_PERM
     14556**DCL     14557--REDEF
AS_MOD_USER.BILL
     14562**DCL     14563--REDEF
AS_MOD_USER.CPROC
     14558**DCL     14559--REDEF
AS_MOD_USER.FEBILL
     14638**DCL     14639--REDEF
AS_MOD_USER.FECXTMEM
     14655**DCL     14656--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:62   
AS_MOD_USER.FEMINTS
     14640**DCL     14641--REDEF
AS_MOD_USER.FEMMEM
     14651**DCL     14652--REDEF
AS_MOD_USER.FEMTIME
     14649**DCL     14650--REDEF
AS_MOD_USER.FEPPRIV
     14646**DCL     14648--REDEF
AS_MOD_USER.FEPRIV
     14643**DCL     14645--REDEF
AS_MOD_USER.FORCE_BIT
     14552**DCL     14553--REDEF
AS_MOD_USER.KEY
     14634**DCL     14636--REDEF
AS_MOD_USER.LASTCPROC
     14560**DCL     14561--REDEF
AS_MOD_USER.LIMITS.DO_
     14608**DCL     14609--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14624**DCL     14625--REDEF
AS_MOD_USER.LIMITS.LO
     14604**DCL     14605--REDEF
AS_MOD_USER.LIMITS.MEM
     14600**DCL     14601--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14628**DCL     14629--REDEF
AS_MOD_USER.LIMITS.PDIS
     14616**DCL     14617--REDEF
AS_MOD_USER.LIMITS.PO
     14612**DCL     14613--REDEF
AS_MOD_USER.LIMITS.TDIS
     14620**DCL     14621--REDEF
AS_MOD_USER.LIMITS.TIME
     14596**DCL     14597--REDEF
AS_MOD_USER.MAXENQ
     14577**DCL     14578--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:63   
AS_MOD_USER.PERM_BIT
     14550**DCL     14551--REDEF
AS_MOD_USER.PPRIV
     14572**DCL     14574--REDEF
AS_MOD_USER.PRIOB
     14579**DCL     14580--REDEF
AS_MOD_USER.PRIV
     14569**DCL     14571--REDEF
AS_MOD_USER.QUAN
     14575**DCL     14576--REDEF
AS_MOD_USER.SETUP
     14548**DCL     14549--REDEF
AS_PROJECT.BANNER_PERM
     12888**DCL     12889--REDEF
AS_PROJECT.BUDGET.MACCT
     12793**DCL     12797--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12806**DCL     12809--REDEF
AS_PROJECT.BUDGET.PACCUM
     12789**DCL     12791--REDEF
AS_PROJECT.BUDGET.PMAXC
     12784**DCL     12786--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12904**DCL     12905--REDEF   12906--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     13066**DCL     13067--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12971**DCL     12975--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12984**DCL     12987--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12967**DCL     12969--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12962**DCL     12964--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     13082**DCL     13083--REDEF   13084--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:64   
AS_PROJECT_DFLT_DREC.PASSWORD
     14288**DCL     14292--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14311**DCL     14312--REDEF
AS_PROJECT_DREC.PASSWORD
     14126**DCL     14130--REDEF
AS_PROJECT_DREC.RENAME
     14149**DCL     14150--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12710**DCL     12711--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12615**DCL     12619--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12628**DCL     12631--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     12611**DCL     12613--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12606**DCL     12608--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12726**DCL     12727--REDEF   12728--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13964**DCL     13968--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13987**DCL     13988--REDEF
AS_USERS.BANNER_PERM
     12176**DCL     12177--REDEF
AS_USERS.BUDGET.MACCT
     12081**DCL     12085--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     12094**DCL     12097--REDEF
AS_USERS.BUDGET.PACCUM
     12077**DCL     12079--REDEF
AS_USERS.BUDGET.PMAXC
     12072**DCL     12074--REDEF
AS_USERS.SETUP_CHRA.TXT
     12192**DCL     12193--REDEF   12194--REDEF
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:65   
AS_USERS_CONSTANT.BANNER_PERM
     13244**DCL     13245--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13149**DCL     13153--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13162**DCL     13165--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13145**DCL     13147--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13140**DCL     13142--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13260**DCL     13261--REDEF   13262--REDEF
BEGIN_KEY.COUNT
     15078**DCL     15185<<ASSIGN
BEGIN_KEY.TEXT
     15079**DCL     15181<<ASSIGN  15184<<ASSIGN  15201>>CALLBLT
CODE
     11832**DCL     15115<<ASSIGN  15125>>DOSELCT 15143>>ASSIGN
CONT$
     15080**DCL     14939--IMP-PTR 15230<<ASSIGN  15233<>CALL    15245<>CALL    15254>>ASSIGN  15313<<ASSIGN
     15315<>CALL    15330<>CALL    15339>>ASSIGN
CONTROLLERS_STR
     15107**DCL     15167>>CALLBLT 15168--ASSIGN  15171>>CALLBLT 15172--ASSIGN  15373--ASSIGN
CONTROLLER_STR
     15106**DCL     15253--ASSIGN  15338--ASSIGN  15370--ASSIGN
CONT_NAME
     15081**DCL     15233<>CALL    15315<>CALL
CONT_NAME.COUNT
     15082**DCL     15121<<ASSIGN  15152<<ASSIGN
CONT_NAME.TEXT
     15083**DCL     15120<<ASSIGN  15151<<ASSIGN
CURRENT_LINE
     15084**DCL     15299<<ASSIGN  15302<>CALL    15304>>IF      15330<>CALL    15337--ASSIGN
DISP
     15085**DCL     15129<<ASSIGN  15134<<ASSIGN  15143<<ASSIGN  15234>>IF      15316>>IF      15347>>IF
     15375>>IF
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:66   
DISPLAY_STR
     15109**DCL     15377--ASSIGN
DISP_CONTROLLERS
     15086**DCL     15122<<ASSIGN  15234>>IF      15257<<ASSIGN  15257>>ASSIGN  15342<<ASSIGN  15342>>ASSIGN
     15367--ASSIGN  15368>>IF
DISP_LINES
     15087**DCL     15123<<ASSIGN  15231<<ASSIGN  15311<<ASSIGN  15311>>ASSIGN  15354--ASSIGN  15355>>IF
DSEG1$
     11840**DCL     14821--IMP-PTR 15208<>CALL    15210>>IF      15229>>ASSIGN  15230>>ASSIGN  15233<>CALL
     15289>>DOUNTIL 15291<>CALL    15312>>ASSIGN  15313>>ASSIGN  15315<>CALL
DSEG1SIZE
     11841**DCL     15207>>ASSIGN  15290>>ASSIGN
END_FOREVER
     15345**LABEL   15307--GOTO    15315--CALLALT
END_KEY.COUNT
     15089**DCL     15187<<ASSIGN
END_KEY.TEXT
     15090**DCL     15182<<ASSIGN  15186<<CALLBLT 15304>>IF
ERR_CODE
     11834**DCL     11835--REDEF
FDS
     11731**DCL     15175<>CALL    15244<>CALL    15255<>CALL    15328<>CALL    15340<>CALL    15351<>CALL
     15366<>CALL    15385<>CALL
FDS.FMT_.BOUND
     11736**DCL     15168<<ASSIGN  15172<<ASSIGN  15237<<ASSIGN  15241<<ASSIGN  15249<<ASSIGN  15321<<ASSIGN
     15325<<ASSIGN  15334<<ASSIGN  15349<<ASSIGN  15365<<ASSIGN  15384<<ASSIGN
FDS.NVECS#
     11759**DCL     15165<<ASSIGN  15195<<ASSIGN  15243<<ASSIGN  15250<<ASSIGN  15327<<ASSIGN  15335<<ASSIGN
     15350<<ASSIGN  15363<<ASSIGN  15382<<ASSIGN
FDS.TABDFLT#
     11797**DCL     15174<<ASSIGN
FINISH_UP
     15347**LABEL   15233--CALLALT 15284--GOTO    15294--GOTO    15305--GOTO
FMT_BUF
     11830**DCL     15167<<CALLBLT 15171<<CALLBLT 15236<<CALLBLT 15240<<CALLBLT 15248<<ASSIGN  15320<<CALLBLT
     15324<<CALLBLT 15333<<ASSIGN  15348<<ASSIGN  15364<<ASSIGN  15383<<ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:67   
FMT_VEC
     11830**DCL     15251<<ASSIGN  15252<<ASSIGN  15253<<ASSIGN  15254<<ASSIGN  15336<<ASSIGN  15337<<ASSIGN
     15338<<ASSIGN  15339<<ASSIGN  15354<<ASSIGN  15357<<ASSIGN  15360<<ASSIGN  15362<<ASSIGN  15367<<ASSIGN
     15370<<ASSIGN  15373<<ASSIGN  15377<<ASSIGN  15380<<ASSIGN
FOUND_STR
     15110**DCL     15362--ASSIGN
I
     15091**DCL     15144<<DOINDEX 15145>>IF      15146>>ASSIGN  15146>>ASSIGN  15147>>ASSIGN  15150>>IF
     15151>>ASSIGN  15151>>ASSIGN  15152>>ASSIGN  15155>>IF      15183<<CALLBLT 15184>>ASSIGN  15186>>CALLBLT
     15187>>ASSIGN  15207<<ASSIGN  15208<>CALL    15229<<ASSIGN  15233<>CALL    15290<<ASSIGN  15291<>CALL
     15297<<CALLBLT 15298>>IF      15298<<ASSIGN  15299>>ASSIGN  15302<>CALL    15312<<ASSIGN  15315<>CALL
J
     15092**DCL     15301<<ASSIGN  15302<>CALL
JCL
     15093**DCL     15116<<ASSIGN  15130<<ASSIGN  15136<<ASSIGN  15138<<ASSIGN  15157<<ASSIGN  15166>>IF
     15235>>IF      15245<>CALL    15319>>IF      15330<>CALL    15353>>IF
KL$CONTROLLER.CONT#
     15056**DCL     15254--ASSIGN  15339--ASSIGN
KL_DEFAULT.PASSWORD
     14450**DCL     14454--REDEF
KL_DEFAULT.RENAME
     14473**DCL     14474--REDEF
KL_DFLT.PASSWORD
     13640**DCL     13644--REDEF
KL_DFLT.RENAME
     13663**DCL     13664--REDEF
KL_DREC.PASSWORD
     13478**DCL     13482--REDEF
KL_DREC.RENAME
     13501**DCL     13502--REDEF
KL_DREC_CNT.PASSWORD
     13365**DCL     13369--REDEF
KL_DREC_CNT.RENAME
     13388**DCL     13389--REDEF
LINE$DREC
     14821**DCL     15229--ASSIGN  15312--ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:68   
LINE$DREC.ATYP
     14826**DCL     15210>>IF      15289>>DOUNTIL
LINE$DREC.NWINFO
     14919**DCL     15229>>ASSIGN  15312>>ASSIGN
LINE$DREC.PASSWORD
     14879**DCL     14883--REDEF
LINE$DREC.RENAME
     14902**DCL     14903--REDEF
LINES_STR
     15105**DCL     15360--ASSIGN
LINE_NAME
     15094**DCL     15211>>ASSIGN  15263>>ASSIGN
LINE_NAME.COUNT
     15095**DCL     15119<<ASSIGN  15147<<ASSIGN  15301>>ASSIGN
LINE_NAME.TEXT
     15096**DCL     15118<<ASSIGN  15146<<ASSIGN  15177>>IF      15183>>CALLBLT 15184>>ASSIGN  15186>>CALLBLT
     15205>>CALLBLT 15236>>CALLBLT 15240>>CALLBLT 15245<>CALL    15252--ASSIGN  15302<>CALL
LINE_STR
     15104**DCL     15236>>CALLBLT 15237--ASSIGN  15240>>CALLBLT 15241--ASSIGN  15251--ASSIGN  15320>>CALLBLT
     15321--ASSIGN  15324>>CALLBLT 15325--ASSIGN  15336--ASSIGN  15357--ASSIGN
LIST_STR
     15108**DCL     15380--ASSIGN
MERR_CODE
     11835**DCL     15293<>CALL
MERR_CODE.CODE
     11835**DCL     15261>>IF      15293>>IF
NEW_LINE#
     15097**DCL     15310<<ASSIGN  15317>>IF      15318<<ASSIGN
NODE$
     11832**DCL     14729--IMP-PTR
P$B.CODE
     14737**DCL     15115>>ASSIGN  15136>>ASSIGN  15138>>ASSIGN  15145>>IF      15150>>IF      15155>>IF
P$B.NSUBLKS
     14741**DCL     15135>>IF      15137>>IF      15144>>DOINDEX
P$B.SUBLK$
     14762**DCL     15115>>ASSIGN  15135>>IF      15136>>ASSIGN  15136>>ASSIGN  15137>>IF      15138>>ASSIGN
PL6.E3A0      #001=ASL$LIST_ALL_CONTROLLERS File=ASL$LIST_CONTROLLERS.:E05TSI    TUE 07/29/97 10:06 Page:69   
     15138>>ASSIGN  15145>>IF      15146>>ASSIGN  15146>>ASSIGN  15147>>ASSIGN  15150>>IF      15151>>ASSIGN
     15151>>ASSIGN  15152>>ASSIGN  15155>>IF
P$S.COUNT
     14798**DCL     14801--IMP-SIZ 15146>>ASSIGN  15147>>ASSIGN  15151>>ASSIGN  15152>>ASSIGN
P$S.TEXT
     14801**DCL     15146>>ASSIGN  15151>>ASSIGN
PROJ_KEY.TEXT
     11712**DCL     11712--REDEF
PROJ_KEY.TXT.PROJECT
     11712**DCL     11712--REDEF
P_PCB.OUT$
     11880**DCL     15115>>ASSIGN  15135>>IF      15136>>ASSIGN  15137>>IF      15138>>ASSIGN  15144>>DOINDEX
     15145>>IF      15146>>ASSIGN  15146>>ASSIGN  15147>>ASSIGN  15150>>IF      15151>>ASSIGN  15151>>ASSIGN
     15152>>ASSIGN  15155>>IF
REMEM_VAR
     11838**DCL     11838--REDEF
REM_FCMD
     11838**DCL     11839--REDEF
USERS_KEY
     11709**DCL     15198<<ASSIGN  15281<>CALL
USERS_KEY.COUNT
     11709**DCL     15202<<ASSIGN  15206<<ASSIGN
USERS_KEY.TEXT
     11709**DCL     11710--REDEF   11710--REDEF   11710--REDEF   11711--REDEF
USERS_KEY.TXTC
     11710**DCL     15201<<CALLBLT 15205<<CALLBLT 15297>>CALLBLT 15299>>ASSIGN  15320>>CALLBLT 15324>>CALLBLT
WILD_CARD
     15098**DCL     15117<<ASSIGN  15188<<ASSIGN  15191<<ASSIGN  15200>>IF      15300>>IF
X$FORMAT
     14718**DCL-ENT 15175--CALL    15244--CALL    15255--CALL    15328--CALL    15340--CALL    15351--CALL
     15366--CALL    15385--CALL

PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:70   
      394        1        /*T***********************************************************/
      395        2        /*T*                                                         */
      396        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      397        4        /*T*                                                         */
      398        5        /*T***********************************************************/
      399        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:71   
      400        7        /*M* ASL$FIND_CONTROLLER: Routine to find line controllers.*/
      401        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      402        9              ECU=3,CSU=3,SDI=3                                           */
      403       10        ASL$FIND_CONTROLLER: PROC (LINE$, SIZE, NAME, CONT$) ALTRET;
      404       11        /**********************************************************/
      405       12
      406       13        /*D* NAME:     ASL$FIND_CONTROLLER
      407       14             CALL:     CALL ASL$FIND_CONTROLLER (LINE$, SIZE, NAME, CONT$)
      408       15             INPUT:    LINE$  - Pointer to the line record in memory.
      409       16                       SIZE   - The size of the line record in words.
      410       17                       NAME   - The textc name of the sought controller.
      411       18             OUTPUT:   CONT$  - Returned pointer to the controller found.
      412       19             DESCRIPTION:  ASL$FIND_CONTROLLER is the routine to handle
      413       20                           the finding of controllers for the line in data
      414       21                           segment 1.  This routine will cycle through the
      415       22                           controllers in data segment 1, matching the
      416       23                           controller names against NAME if necessary
      417       24                           and then returning with CONT$ pointing at the
      418       25                           controller found or altreturning with CONT$ set
      419       26                           to NIL.
      420       27        */
      421       28        /********************************************************************/
      422       29        /*   Include files   include files   include files   include files  */
      423       30        /********************************************************************/
      424       31        %INCLUDE AS_PERR_C;
      425      633        %INCLUDE AS_SUPER_C;
      426     1068        %INCLUDE AS_SUBS_C;
      427     2482        %INCLUDE AS_MAC_C;
      428     2562        %INCLUDE AS_ENTRIES_M;
      429     3612        %INCLUDE AS_SSUBS_C;
      430     3704        %INCLUDE B_ERRORS_C;
      431     4831        %INCLUDE CP_6_SUBS;
      432     5371        %INCLUDE KL_SUPER_C;
      433     8273        %INCLUDE XU_MACRO_C;
      434    11379        %INCLUDE XU_FORMAT_C;
      435    11541        %INCLUDE AS_SUPER_R;
      436    14557        /********************************************************************/
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:72   
      437    14558        /*   Parameters      parameters      parameters      parameters     */
      438    14559        /********************************************************************/
      439    14560    1   DCL CONT$             PTR;
      440    14561    1   DCL LINE$             PTR;
      441    14562    1   DCL 1 NAME,
      442    14563    1          2 COUNT        UBIN BYTE UNAL,
      443    14564    1          2 TEXT         CHAR(2) CALIGNED;
      444    14565    1   DCL SIZE              UBIN;
      445    14566        /********************************************************************/
      446    14567        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      447    14568        /********************************************************************/
      448    14569        %ASH$ERROR ;
      449    14572        %ASB$WILD_MATCH ;
      450    14575        /********************************************************************/
      451    14576        /*   Local based     local based     local based     local based    */
      452    14577        /********************************************************************/
      453    14578    1   DCL 1 TEXT$C BASED ALIGNED,
      454    14579    1          2 CNT                 UBIN(9) UNAL ,
      455    14580    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      456    14581        %KL_DREC ( NAME = LINE$DREC,
      457    14582                   STCLASS = "BASED(DSEG1$)",
      458    14583                   LAST = ",");
      459    14696        %KL_LN3270 ( NAME = LN,
      460    14697                     LVL = 2,
      461    14698                     STCLASS = BASED);
      462    14840        %KL_CONTROLLER ( NAME = KL$CONTROLLER,
      463    14841                         LVL = 1,
      464    14842                         LAST = ";",
      465    14843                         STCLASS = "BASED( CONT$ )" );
      466    14992        /********************************************************************/
      467    14993        /*   Auto data       auto data       auto data       auto data      */
      468    14994        /********************************************************************/
      469    14995    1   DCL ALL               BIT(1);
      470    14996    1   DCL CONT#             UBIN;
      471    14997    1   DCL DEV$              PTR;
      472    14998    1   DCL DEV_SIZEW         SBIN WORD ;
      473    14999    1   DCL DEV_START$        PTR ;
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:73   
      474    15000    1   DCL DEV_STOP$         PTR ;
      475    15001    1   DCL DEVNUM            UBIN;
      476    15002    1   DCL I                 UBIN;
      477    15003    1   DCL TEMPCONT          CHAR(2);
      478    15004    1   DCL WILD_CARD         BIT(1);
      479    15005        /********************************************************************/
      480    15006        /*   Constant data   constant data   constant data   constant data  */
      481    15007        /********************************************************************/
      482    15008        %KL_CONTROLLER ( LVL = 1, STCLASS = CONSTANT );
      483    15157        %KL_LINEDEV    ( LVL = 1, STCLASS = CONSTANT );
      484    15306        /********************************************************************/
      485    15307        /*   Procedure       procedure       procedure       procedure      */
      486    15308        /********************************************************************/
      487    15309    1   DEV_START$ = PINCRW(ADDR(LINE$DREC.LN), SIZEW(LINE$DREC.LN) );
      488    15310    1   DEV_SIZEW = LINE$DREC.NWINFO - POFFW(DEV_START$,ADDR(LINE$DREC.LN));
      489    15311    1   DEV_STOP$ = PINCRW(DEV_START$, DEV_SIZEW);
      490    15312    1   ALL = %NO#;
      491    15313    1   WILD_CARD = %NO#;
      492    15314    1   IF CONT$ = LINE$ THEN
      493    15315    1      CONT$ = DEV_START$;
      494    15316    1   ELSE
      495    15317    1      CONT$ = PINCRW (CONT$, KL$CONTROLLER.BLKHDR.NSUBS*SIZEW(KL_LINEDEV)+SIZEW(
             15317               KL_CONTROLLER));
      496    15318    2   IF CONT$ >= DEV_STOP$ THEN DO;
      497    15319    2      CONT$ = ADDR (NIL);
      498    15320    2      ALTRETURN ;
      499    15321    2      END;  /*  CONT$ >= DEV_STOP$  */
      500    15322    1   IF NAME.TEXT = '?' THEN
      501    15323    1      ALL = %YES#;
      502    15324    2   ELSE DO;
      503    15325    2      CALL INDEX (I, '?', NAME.TEXT)
      504    15326    3      WHENRETURN DO;
      505    15327    3         WILD_CARD = %YES#;
      506    15328    3         END; /*  Whenreturn  */
      507    15329    3      WHENALTRETURN DO;
      508    15330    3         CALL CHARBIN( CONT#, NAME.TEXT );
      509    15331    3         END; /*  Whenaltreturn  */
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:74   
      510    15332    2      IF (WILD_CARD AND SUBSTR(NAME.TEXT,0,1) > '3' AND SUBSTR(NAME.TEXT,0,1)<='9') OR
      511    15333    3           (NOT WILD_CARD AND CONT# > 31) THEN DO;
      512    15334        /*E*  ERROR:  ASL-E$BAD_CONT_NUM-C
      513    15335              MESSAGE: Illegal CONTROLLER number.
      514    15336              MESSAGE1: A CONTROLLER number must be between 0 and 31.
      515    15337        */
      516    15338              %SCREAM( ERR#=E$BAD_CONT_NUM, LEVEL=ERROR, MID='L' );
      517    15353    3         CONT$ = ADDR (NIL);
      518    15354    3         ALTRETURN;
      519    15355    3         END;   /*  Bad controller number  */
      520    15356    2      END;  /*  Whenaltreturn  */
      521    15357                                                  /* Find controller info. */
      522    15358    2   DO WHILE CONT$ < DEV_STOP$;
      523    15359    3      IF WILD_CARD THEN DO;
      524    15360    3         CALL BINCHAR (TEMPCONT, KL$CONTROLLER.CONT#);
      525    15361    3         CALL ASB$WILD_MATCH (2, TEMPCONT, 2, NAME.TEXT) ALTRET (LOOP_END);
      526    15362    3         END;   /*  If WILD_CARD  */
      527    15363    2      ELSE IF NOT WILD_CARD AND NOT ALL THEN
      528    15364    2            IF KL$CONTROLLER.CONT# ~= CONT# THEN GOTO LOOP_END;
      529    15365    2      RETURN ;
      530    15366    2   LOOP_END:
      531    15367    2      DEV$ = PINCRW (CONT$, SIZEW (KL_CONTROLLER));
      532    15368    2      CONT$ = PINCRW (DEV$, KL$CONTROLLER.BLKHDR.NSUBS*SIZEW(KL_LINEDEV));
      533    15369    2      END; /*  Do while CONT$ < DEV_STOP$  */
      534    15370    1   CONT$ = ADDR(NIL);
      535    15371    1   ALTRETURN ;
      536    15372    1   END ASL$FIND_CONTROLLER;
      537    15373        %EOD;

PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:75   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_CONTROLLER.

   Procedure ASL$FIND_CONTROLLER requires 152 words for executable code.
   Procedure ASL$FIND_CONTROLLER requires 22 words of local(AUTO) storage.

PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:76   

 Object Unit name= ASL$FIND_CONTROLLER                        File name= ASL$LIST_CONTROLLERS.:E05TOU
 UTS= JUL 29 '97 10:08:22.68 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS      9     11  ASL$FIND_CONTROLLER
    2   Proc  even  none   152    230  ASL$FIND_CONTROLLER
    3  RoData even  none     5      5  ASL$FIND_CONTROLLER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes    yes     yes      Std        4  ASL$FIND_CONTROLLER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       2 ASH$ERROR
 yes     yes           Std       4 ASB$WILD_MATCH
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_AALT
                       nStd      0 X66_ARET
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:77   

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          DSEG1$                                B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:78   


      394        1        /*T***********************************************************/
      395        2        /*T*                                                         */
      396        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      397        4        /*T*                                                         */
      398        5        /*T***********************************************************/
      399        6        %EJECT;
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:79   
      400        7        /*M* ASL$FIND_CONTROLLER: Routine to find line controllers.*/
      401        8        /*X*  DMC,DMR,CCC,PLM=0,IND=3,CTI=5,DCI=6,IAD=0,DTI=0,IDT=0,ENI=3,
      402        9              ECU=3,CSU=3,SDI=3                                           */
      403       10        ASL$FIND_CONTROLLER: PROC (LINE$, SIZE, NAME, CONT$) ALTRET;

     10  2 000000   000000 700200 xent  ASL$FIND_CO* TSX0  ! X66_AUTO_4
         2 000001   000026 000004                    ZERO    22,4

      404       11        /**********************************************************/
      405       12
      406       13        /*D* NAME:     ASL$FIND_CONTROLLER
      407       14             CALL:     CALL ASL$FIND_CONTROLLER (LINE$, SIZE, NAME, CONT$)
      408       15             INPUT:    LINE$  - Pointer to the line record in memory.
      409       16                       SIZE   - The size of the line record in words.
      410       17                       NAME   - The textc name of the sought controller.
      411       18             OUTPUT:   CONT$  - Returned pointer to the controller found.
      412       19             DESCRIPTION:  ASL$FIND_CONTROLLER is the routine to handle
      413       20                           the finding of controllers for the line in data
      414       21                           segment 1.  This routine will cycle through the
      415       22                           controllers in data segment 1, matching the
      416       23                           controller names against NAME if necessary
      417       24                           and then returning with CONT$ pointing at the
      418       25                           controller found or altreturning with CONT$ set
      419       26                           to NIL.
      420       27        */
      421       28        /********************************************************************/
      422       29        /*   Include files   include files   include files   include files  */
      423       30        /********************************************************************/
      424       31        %INCLUDE AS_PERR_C;
      425      633        %INCLUDE AS_SUPER_C;
      426     1068        %INCLUDE AS_SUBS_C;
      427     2482        %INCLUDE AS_MAC_C;
      428     2562        %INCLUDE AS_ENTRIES_M;
      429     3612        %INCLUDE AS_SSUBS_C;
      430     3704        %INCLUDE B_ERRORS_C;
      431     4831        %INCLUDE CP_6_SUBS;
      432     5371        %INCLUDE KL_SUPER_C;
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:80   
      433     8273        %INCLUDE XU_MACRO_C;
      434    11379        %INCLUDE XU_FORMAT_C;
      435    11541        %INCLUDE AS_SUPER_R;
      436    14557        /********************************************************************/
      437    14558        /*   Parameters      parameters      parameters      parameters     */
      438    14559        /********************************************************************/
      439    14560    1   DCL CONT$             PTR;
      440    14561    1   DCL LINE$             PTR;
      441    14562    1   DCL 1 NAME,
      442    14563    1          2 COUNT        UBIN BYTE UNAL,
      443    14564    1          2 TEXT         CHAR(2) CALIGNED;
      444    14565    1   DCL SIZE              UBIN;
      445    14566        /********************************************************************/
      446    14567        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      447    14568        /********************************************************************/
      448    14569        %ASH$ERROR ;
      449    14572        %ASB$WILD_MATCH ;
      450    14575        /********************************************************************/
      451    14576        /*   Local based     local based     local based     local based    */
      452    14577        /********************************************************************/
      453    14578    1   DCL 1 TEXT$C BASED ALIGNED,
      454    14579    1          2 CNT                 UBIN(9) UNAL ,
      455    14580    1          2 TEXT                CHAR(TEXT$C.CNT) UNAL;
      456    14581        %KL_DREC ( NAME = LINE$DREC,
      457    14582                   STCLASS = "BASED(DSEG1$)",
      458    14583                   LAST = ",");
      459    14696        %KL_LN3270 ( NAME = LN,
      460    14697                     LVL = 2,
      461    14698                     STCLASS = BASED);
      462    14840        %KL_CONTROLLER ( NAME = KL$CONTROLLER,
      463    14841                         LVL = 1,
      464    14842                         LAST = ";",
      465    14843                         STCLASS = "BASED( CONT$ )" );
      466    14992        /********************************************************************/
      467    14993        /*   Auto data       auto data       auto data       auto data      */
      468    14994        /********************************************************************/
      469    14995    1   DCL ALL               BIT(1);
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:81   
      470    14996    1   DCL CONT#             UBIN;
      471    14997    1   DCL DEV$              PTR;
      472    14998    1   DCL DEV_SIZEW         SBIN WORD ;
      473    14999    1   DCL DEV_START$        PTR ;
      474    15000    1   DCL DEV_STOP$         PTR ;
      475    15001    1   DCL DEVNUM            UBIN;
      476    15002    1   DCL I                 UBIN;
      477    15003    1   DCL TEMPCONT          CHAR(2);
      478    15004    1   DCL WILD_CARD         BIT(1);
      479    15005        /********************************************************************/
      480    15006        /*   Constant data   constant data   constant data   constant data  */
      481    15007        /********************************************************************/
      482    15008        %KL_CONTROLLER ( LVL = 1, STCLASS = CONSTANT );
      483    15157        %KL_LINEDEV    ( LVL = 1, STCLASS = CONSTANT );
      484    15306        /********************************************************************/
      485    15307        /*   Procedure       procedure       procedure       procedure      */
      486    15308        /********************************************************************/
      487    15309    1   DEV_START$ = PINCRW(ADDR(LINE$DREC.LN), SIZEW(LINE$DREC.LN) );

  15309  2 000002   000000 236000 xsym               LDQ     DSEG1$
         2 000003   000023 036003                    ADLQ    19,DU
         2 000004   200013 756100                    STQ     DEV_START$,,AUTO

      488    15310    1   DEV_SIZEW = LINE$DREC.NWINFO - POFFW(DEV_START$,ADDR(LINE$DREC.LN));

  15310  2 000005   000000 236000 xsym               LDQ     DSEG1$
         2 000006   000020 036003                    ADLQ    16,DU
         2 000007   000022 772000                    QRL     18
         2 000010   200022 756100                    STQ     WILD_CARD+2,,AUTO
         2 000011   200013 236100                    LDQ     DEV_START$,,AUTO
         2 000012   000022 772000                    QRL     18
         2 000013   200022 136100                    SBLQ    WILD_CARD+2,,AUTO
         2 000014   200023 756100                    STQ     WILD_CARD+3,,AUTO
         2 000015   000000 470400 xsym               LDP0    DSEG1$
         2 000016   000017 236100                    LDQ     15,,PR0
         2 000017   200023 136100                    SBLQ    WILD_CARD+3,,AUTO
         2 000020   200012 756100                    STQ     DEV_SIZEW,,AUTO
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:82   

      489    15311    1   DEV_STOP$ = PINCRW(DEV_START$, DEV_SIZEW);

  15311  2 000021   000022 736000                    QLS     18
         2 000022   200013 036100                    ADLQ    DEV_START$,,AUTO
         2 000023   200014 756100                    STQ     DEV_STOP$,,AUTO

      490    15312    1   ALL = %NO#;

  15312  2 000024   200007 450100                    STZ     ALL,,AUTO

      491    15313    1   WILD_CARD = %NO#;

  15313  2 000025   200020 450100                    STZ     WILD_CARD,,AUTO

      492    15314    1   IF CONT$ = LINE$ THEN

  15314  2 000026   200006 471500                    LDP1    @CONT$,,AUTO
         2 000027   200003 473500                    LDP3    @LINE$,,AUTO
         2 000030   100000 236100                    LDQ     0,,PR1
         2 000031   300000 116100                    CMPQ    0,,PR3
         2 000032   000036 601000 2                  TNZ     s:15317

      493    15315    1      CONT$ = DEV_START$;

  15315  2 000033   200013 236100                    LDQ     DEV_START$,,AUTO
         2 000034   100000 756100                    STQ     0,,PR1
         2 000035   000050 710000 2                  TRA     s:15318

      494    15316    1   ELSE
      495    15317    1      CONT$ = PINCRW (CONT$, KL$CONTROLLER.BLKHDR.NSUBS*SIZEW(KL_LINEDEV)+SIZEW(
             15317               KL_CONTROLLER));

  15317  2 000036   100000 474500                    LDP4    0,,PR1
         2 000037   000100 101500                    MRL     fill='000'O
         2 000040   400000 200001                    ADSC9   0,,PR4                   cn=1,n=1
         2 000041   200022 000002                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=2
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:83   
         2 000042   200022 220100                    LDX0    WILD_CARD+2,,AUTO
         2 000043   100000 474500                    LDP4    0,,PR1
         2 000044   000000 635010                    EAA     0,X0
         2 000045   000020 771000                    ARL     16
         2 000046   400004 635505                    EPPR5   4,AL,PR4
         2 000047   100000 455500                    STP5    0,,PR1

      496    15318    2   IF CONT$ >= DEV_STOP$ THEN DO;

  15318  2 000050   100000 236100                    LDQ     0,,PR1
         2 000051   200014 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000052   000056 602000 2                  TNC     s:15322

      497    15319    2      CONT$ = ADDR (NIL);

  15319  2 000053   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000054   100000 756100                    STQ     0,,PR1

      498    15320    2      ALTRETURN ;

  15320  2 000055   000000 702200 xent               TSX2  ! X66_AALT

      499    15321    2      END;  /*  CONT$ >= DEV_STOP$  */
      500    15322    1   IF NAME.TEXT = '?' THEN

  15322  2 000056   200005 470500                    LDP0    @NAME,,AUTO
         2 000057   040000 106500                    CMPC    fill='040'O
         2 000060   000000 200002                    ADSC9   0,,PR0                   cn=1,n=2
         2 000061   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000062   000066 601000 2                  TNZ     s:15325

      501    15323    1      ALL = %YES#;

  15323  2 000063   400000 236003                    LDQ     -131072,DU
         2 000064   200007 756100                    STQ     ALL,,AUTO
         2 000065   000133 710000 2                  TRA     s:15358

PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:84   
      502    15324    2   ELSE DO;

      503    15325    2      CALL INDEX (I, '?', NAME.TEXT)

  15325  2 000066   000000 124500                    SCM     mask='000'O
         2 000067   000000 200002                    ADSC9   0,,PR0                   cn=1,n=2
         2 000070   000000 000001 3                  ADSC9   0                        cn=0,n=1
         2 000071   200016 000100                    ARG     I,,AUTO
         2 000072   000076 606400 2                  TTN     s:15330

      504    15326    3      WHENRETURN DO;

      505    15327    3         WILD_CARD = %YES#;

  15327  2 000073   400000 236003                    LDQ     -131072,DU
         2 000074   200020 756100                    STQ     WILD_CARD,,AUTO

      506    15328    3         END; /*  Whenreturn  */

  15328  2 000075   000104 710000 2                  TRA     s:15332

      507    15329    3      WHENALTRETURN DO;

      508    15330    3         CALL CHARBIN( CONT#, NAME.TEXT );

  15330  2 000076   200005 470500                    LDP0    @NAME,,AUTO
         2 000077   000100 305500                    DTB
         2 000100   000000 230002                    NDSC9   0,,PR0                   cn=1,s=nosgn,sf=0,n=2
         2 000101   200022 000010                    NDSC9   WILD_CARD+2,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000102   200023 235100                    LDA     WILD_CARD+3,,AUTO
         2 000103   200010 755100                    STA     CONT#,,AUTO

      509    15331    3         END; /*  Whenaltreturn  */

      510    15332    2      IF (WILD_CARD AND SUBSTR(NAME.TEXT,0,1) > '3' AND SUBSTR(NAME.TEXT,0,1)<='9') OR

  15332  2 000104   200020 234100                    SZN     WILD_CARD,,AUTO
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:85   
         2 000105   000116 605000 2                  TPL     s:15332+10
         2 000106   040100 106400                    CMPC    fill='040'O
         2 000107   000001 000001 3                  ADSC9   1                        cn=0,n=1
         2 000110   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 000111   000116 603000 2                  TRC     s:15332+10
         2 000112   040100 106400                    CMPC    fill='040'O
         2 000113   000002 000001 3                  ADSC9   2                        cn=0,n=1
         2 000114   000000 200001                    ADSC9   0,,PR0                   cn=1,n=1
         2 000115   000123 603000 2                  TRC     s:15350
         2 000116   200020 234100                    SZN     WILD_CARD,,AUTO
         2 000117   000133 604000 2                  TMI     s:15358
         2 000120   200010 235100                    LDA     CONT#,,AUTO
         2 000121   000040 115007                    CMPA    32,DL
         2 000122   000133 602000 2                  TNC     s:15358

      511    15333    3           (NOT WILD_CARD AND CONT# > 31) THEN DO;

      512    15334        /*E*  ERROR:  ASL-E$BAD_CONT_NUM-C
      513    15335              MESSAGE: Illegal CONTROLLER number.
      514    15336              MESSAGE1: A CONTROLLER number must be between 0 and 31.
      515    15337        */
      516    15338              %SCREAM( ERR#=E$BAD_CONT_NUM, LEVEL=ERROR, MID='L' );

  15350  2 000123   000003 630400 3                  EPPR0   3
         2 000124   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000125   000000 701000 xent               TSX1    ASH$ERROR
         2 000126   000000 011000                    NOP     0

      517    15353    3         CONT$ = ADDR (NIL);

  15353  2 000127   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000130   200006 470500                    LDP0    @CONT$,,AUTO
         2 000131   000000 756100                    STQ     0,,PR0

      518    15354    3         ALTRETURN;

  15354  2 000132   000000 702200 xent               TSX2  ! X66_AALT
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:86   

      519    15355    3         END;   /*  Bad controller number  */
      520    15356    2      END;  /*  Whenaltreturn  */
      521    15357                                                  /* Find controller info. */
      522    15358    2   DO WHILE CONT$ < DEV_STOP$;

  15358  2 000133   200006 471500                    LDP1    @CONT$,,AUTO
         2 000134   100000 236100                    LDQ     0,,PR1
         2 000135   200014 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000136   000224 603000 2                  TRC     s:15370

      523    15359    3      IF WILD_CARD THEN DO;

  15359  2 000137   200020 234100                    SZN     WILD_CARD,,AUTO
         2 000140   000171 605000 2                  TPL     s:15363

      524    15360    3         CALL BINCHAR (TEMPCONT, KL$CONTROLLER.CONT#);

  15360  2 000141   200006 470500                    LDP0    @CONT$,,AUTO
         2 000142   000000 471500                    LDP1    0,,PR0
         2 000143   000100 101500                    MRL     fill='000'O
         2 000144   100002 000001                    ADSC9   2,,PR1                   cn=0,n=1
         2 000145   200022 000004                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=4
         2 000146   200022 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000147   000000 235003                    LDA     0,DU
         2 000150   200024 757100                    STAQ    WILD_CARD+4,,AUTO
         2 000151   000100 301500                    BTD
         2 000152   200024 000010                    NDSC9   WILD_CARD+4,,AUTO        cn=0,s=lsgnf,sf=0,n=8
         2 000153   200017 030002                    NDSC9   TEMPCONT,,AUTO           cn=0,s=nosgn,sf=0,n=2

      525    15361    3         CALL ASB$WILD_MATCH (2, TEMPCONT, 2, NAME.TEXT) ALTRET (LOOP_END);

  15361  2 000154   200005 236100                    LDQ     @NAME,,AUTO
         2 000155   200000 036007                    ADLQ    65536,DL
         2 000156   000004 235000 3                  LDA     4
         2 000157   200024 757100                    STAQ    WILD_CARD+4,,AUTO
         2 000160   200017 631500                    EPPR1   TEMPCONT,,AUTO
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:87   
         2 000161   200023 451500                    STP1    WILD_CARD+3,,AUTO
         2 000162   000004 236000 3                  LDQ     4
         2 000163   200022 756100                    STQ     WILD_CARD+2,,AUTO
         2 000164   200022 630500                    EPPR0   WILD_CARD+2,,AUTO
         2 000165   000022 631400 xsym               EPPR1   B_VECTNIL+18
         2 000166   000000 701000 xent               TSX1    ASB$WILD_MATCH
         2 000167   000205 702000 2                  TSX2    LOOP_END

      526    15362    3         END;   /*  If WILD_CARD  */

  15362  2 000170   000204 710000 2                  TRA     s:15365

      527    15363    2      ELSE IF NOT WILD_CARD AND NOT ALL THEN

  15363  2 000171   000204 604000 2                  TMI     s:15365
         2 000172   200007 234100                    SZN     ALL,,AUTO
         2 000173   000204 604000 2                  TMI     s:15365

      528    15364    2            IF KL$CONTROLLER.CONT# ~= CONT# THEN GOTO LOOP_END;

  15364  2 000174   200006 470500                    LDP0    @CONT$,,AUTO
         2 000175   000000 471500                    LDP1    0,,PR0
         2 000176   000100 101500                    MRL     fill='000'O
         2 000177   100002 000001                    ADSC9   2,,PR1                   cn=0,n=1
         2 000200   200022 000004                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=4
         2 000201   200022 236100                    LDQ     WILD_CARD+2,,AUTO
         2 000202   200010 116100                    CMPQ    CONT#,,AUTO
         2 000203   000205 601000 2                  TNZ     LOOP_END

      529    15365    2      RETURN ;

  15365  2 000204   000000 702200 xent               TSX2  ! X66_ARET

      530    15366    2   LOOP_END:
      531    15367    2      DEV$ = PINCRW (CONT$, SIZEW (KL_CONTROLLER));

  15367  2 000205   200006 470500       LOOP_END     LDP0    @CONT$,,AUTO
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:88   
         2 000206   000000 236100                    LDQ     0,,PR0
         2 000207   000004 036003                    ADLQ    4,DU
         2 000210   200011 756100                    STQ     DEV$,,AUTO

      532    15368    2      CONT$ = PINCRW (DEV$, KL$CONTROLLER.BLKHDR.NSUBS*SIZEW(KL_LINEDEV));

  15368  2 000211   000000 471500                    LDP1    0,,PR0
         2 000212   000100 101500                    MRL     fill='000'O
         2 000213   100000 200001                    ADSC9   0,,PR1                   cn=1,n=1
         2 000214   200022 000002                    ADSC9   WILD_CARD+2,,AUTO        cn=0,n=2
         2 000215   200022 220100                    LDX0    WILD_CARD+2,,AUTO
         2 000216   000000 636010                    EAQ     0,X0
         2 000217   000002 736000                    QLS     2
         2 000220   200011 036100                    ADLQ    DEV$,,AUTO
         2 000221   000000 756100                    STQ     0,,PR0

      533    15369    2      END; /*  Do while CONT$ < DEV_STOP$  */

  15369  2 000222   200014 116100                    CMPQ    DEV_STOP$,,AUTO
         2 000223   000137 602000 2                  TNC     s:15359

      534    15370    1   CONT$ = ADDR(NIL);

  15370  2 000224   000001 236000 xsym               LDQ     B_VECTNIL+1
         2 000225   200006 470500                    LDP0    @CONT$,,AUTO
         2 000226   000000 756100                    STQ     0,,PR0

      535    15371    1   ALTRETURN ;

  15371  2 000227   000000 702200 xent               TSX2  ! X66_AALT
      536    15372    1   END ASL$FIND_CONTROLLER;
      537    15373        %EOD;

PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:89   
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$FIND_CONTROLLER.
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:90   

 **** Variables and constants ****

  ****  Section 001 RoData ASL$FIND_CONTROLLER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL_CONTROLLER              4-0-0/c STRC(144)   r     1 KL_LINEDEV

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     6-0-0/w PTR         r     1 @CONT$                     3-0-0/w PTR         r     1 @LINE$
     5-0-0/w PTR         r     1 @NAME                      4-0-0/w PTR         r     1 @SIZE
     7-0-0/b BIT         r     1 ALL                       10-0-0/w UBIN        r     1 CONT#
    *0-0-0/w PTR         r     1 CONT$                     11-0-0/w PTR         r     1 DEV$
    12-0-0/w SBIN        r     1 DEV_SIZEW                 13-0-0/w PTR         r     1 DEV_START$
    14-0-0/w PTR         r     1 DEV_STOP$                 16-0-0/w UBIN        r     1 I
    *0-0-0/w PTR         r     1 LINE$                     *0-0-0/c STRC(27)    r     1 NAME
    *0-0-0/w UBIN        r     1 SIZE                      17-0-0/c CHAR(2)     r     1 TEMPCONT
    20-0-0/b BIT         r     1 WILD_CARD

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 DSEG1$

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL$CONTROLLER              0-0-0/w STRC(684)   r     1 LINE$DREC
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:91   
     0-0-0/w ASTR(9)     r     1 TEXT$C


   Procedure ASL$FIND_CONTROLLER requires 152 words for executable code.
   Procedure ASL$FIND_CONTROLLER requires 22 words of local(AUTO) storage.
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:92   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:93   
          MINI XREF LISTING

ALL
     14995**DCL     15312<<ASSIGN  15323<<ASSIGN  15363>>IF
ASA_BRKS_LOC
     11705**DCL     11705--REDEF
ASB$WILD_MATCH
     14573**DCL-ENT 15361--CALL
ASH$ERROR
     14570**DCL-ENT 15350--CALL
AS_DEFAULT.BANNER_PERM
     12398**DCL     12399--REDEF
AS_DEFAULT.BUDGET.MACCT
     12303**DCL     12307--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     12316**DCL     12319--REDEF
AS_DEFAULT.BUDGET.PACCUM
     12299**DCL     12301--REDEF
AS_DEFAULT.BUDGET.PMAXC
     12294**DCL     12296--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     12414**DCL     12415--REDEF   12416--REDEF
AS_DEFAULT_DREC.PASSWORD
     13668**DCL     13672--REDEF
AS_DEFAULT_DREC.RENAME
     13691**DCL     13692--REDEF
AS_DFLT.BANNER_PERM
     12220**DCL     12221--REDEF
AS_DFLT.BUDGET.MACCT
     12125**DCL     12129--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     12138**DCL     12141--REDEF
AS_DFLT.BUDGET.PACCUM
     12121**DCL     12123--REDEF
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:94   
AS_DFLT.BUDGET.PMAXC
     12116**DCL     12118--REDEF
AS_DFLT.SETUP_CHRA.TXT
     12236**DCL     12237--REDEF   12238--REDEF
AS_FE_MODE
     11571**DCL     11572--REDEF
AS_MODE
     11568**DCL     11570--REDEF
AS_MOD_USER.ACCESS
     14433**DCL     14434--REDEF
AS_MOD_USER.BANNER
     14420**DCL     14421--REDEF
AS_MOD_USER.BANNER_PERM
     14422**DCL     14423--REDEF
AS_MOD_USER.BILL
     14428**DCL     14429--REDEF
AS_MOD_USER.CPROC
     14424**DCL     14425--REDEF
AS_MOD_USER.FEBILL
     14504**DCL     14505--REDEF
AS_MOD_USER.FECXTMEM
     14521**DCL     14522--REDEF
AS_MOD_USER.FEMINTS
     14506**DCL     14507--REDEF
AS_MOD_USER.FEMMEM
     14517**DCL     14518--REDEF
AS_MOD_USER.FEMTIME
     14515**DCL     14516--REDEF
AS_MOD_USER.FEPPRIV
     14512**DCL     14514--REDEF
AS_MOD_USER.FEPRIV
     14509**DCL     14511--REDEF
AS_MOD_USER.FORCE_BIT
     14418**DCL     14419--REDEF
AS_MOD_USER.KEY
     14500**DCL     14502--REDEF
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:95   
AS_MOD_USER.LASTCPROC
     14426**DCL     14427--REDEF
AS_MOD_USER.LIMITS.DO_
     14474**DCL     14475--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     14490**DCL     14491--REDEF
AS_MOD_USER.LIMITS.LO
     14470**DCL     14471--REDEF
AS_MOD_USER.LIMITS.MEM
     14466**DCL     14467--REDEF
AS_MOD_USER.LIMITS.MPRIO
     14494**DCL     14495--REDEF
AS_MOD_USER.LIMITS.PDIS
     14482**DCL     14483--REDEF
AS_MOD_USER.LIMITS.PO
     14478**DCL     14479--REDEF
AS_MOD_USER.LIMITS.TDIS
     14486**DCL     14487--REDEF
AS_MOD_USER.LIMITS.TIME
     14462**DCL     14463--REDEF
AS_MOD_USER.MAXENQ
     14443**DCL     14444--REDEF
AS_MOD_USER.PERM_BIT
     14416**DCL     14417--REDEF
AS_MOD_USER.PPRIV
     14438**DCL     14440--REDEF
AS_MOD_USER.PRIOB
     14445**DCL     14446--REDEF
AS_MOD_USER.PRIV
     14435**DCL     14437--REDEF
AS_MOD_USER.QUAN
     14441**DCL     14442--REDEF
AS_MOD_USER.SETUP
     14414**DCL     14415--REDEF
AS_PROJECT.BANNER_PERM
     12754**DCL     12755--REDEF
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:96   
AS_PROJECT.BUDGET.MACCT
     12659**DCL     12663--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12672**DCL     12675--REDEF
AS_PROJECT.BUDGET.PACCUM
     12655**DCL     12657--REDEF
AS_PROJECT.BUDGET.PMAXC
     12650**DCL     12652--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12770**DCL     12771--REDEF   12772--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12932**DCL     12933--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12837**DCL     12841--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12850**DCL     12853--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12833**DCL     12835--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12828**DCL     12830--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12948**DCL     12949--REDEF   12950--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     14154**DCL     14158--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     14177**DCL     14178--REDEF
AS_PROJECT_DREC.PASSWORD
     13992**DCL     13996--REDEF
AS_PROJECT_DREC.RENAME
     14015**DCL     14016--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12576**DCL     12577--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     12481**DCL     12485--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     12494**DCL     12497--REDEF
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:97   
AS_PROJ_ADMIN.BUDGET.PACCUM
     12477**DCL     12479--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     12472**DCL     12474--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12592**DCL     12593--REDEF   12594--REDEF
AS_PROJ_ADMIN_DREC.PASSWORD
     13830**DCL     13834--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13853**DCL     13854--REDEF
AS_USERS.BANNER_PERM
     12042**DCL     12043--REDEF
AS_USERS.BUDGET.MACCT
     11947**DCL     11951--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11960**DCL     11963--REDEF
AS_USERS.BUDGET.PACCUM
     11943**DCL     11945--REDEF
AS_USERS.BUDGET.PMAXC
     11938**DCL     11940--REDEF
AS_USERS.SETUP_CHRA.TXT
     12058**DCL     12059--REDEF   12060--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     13110**DCL     13111--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     13015**DCL     13019--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     13028**DCL     13031--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     13011**DCL     13013--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     13006**DCL     13008--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     13126**DCL     13127--REDEF   13128--REDEF
CONT#
     14996**DCL     15330<<CALLBLT 15332>>IF      15364>>IF
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:98   
CONT$
     14560**DCL        10--PROC    14858--IMP-PTR 15314>>IF      15315<<ASSIGN  15317<<ASSIGN  15317>>ASSIGN
     15317>>ASSIGN  15318>>IF      15319<<ASSIGN  15353<<ASSIGN  15358>>DOWHILE 15360>>CALLBLT 15364>>IF
     15367>>ASSIGN  15368<<ASSIGN  15368>>ASSIGN  15370<<ASSIGN
DEV$
     14997**DCL     15367<<ASSIGN  15368>>ASSIGN
DEV_SIZEW
     14998**DCL     15310<<ASSIGN  15311>>ASSIGN
DEV_START$
     14999**DCL     15309<<ASSIGN  15310>>ASSIGN  15311>>ASSIGN  15315>>ASSIGN
DEV_STOP$
     15000**DCL     15311<<ASSIGN  15318>>IF      15358>>DOWHILE
DSEG1$
     11706**DCL     14596--IMP-PTR 15309>>ASSIGN  15310>>ASSIGN  15310>>ASSIGN
ERR_CODE
     11700**DCL     11701--REDEF
I
     15002**DCL     15325<<CALLBLT
KL$CONTROLLER.BLKHDR.NSUBS
     14906**DCL     15317>>ASSIGN  15368>>ASSIGN
KL$CONTROLLER.CONT#
     14975**DCL     15360>>CALLBLT 15364>>IF
KL_CONTROLLER
     15023**DCL     15317--ASSIGN  15367--ASSIGN
KL_DEFAULT.PASSWORD
     14316**DCL     14320--REDEF
KL_DEFAULT.RENAME
     14339**DCL     14340--REDEF
KL_DFLT.PASSWORD
     13506**DCL     13510--REDEF
KL_DFLT.RENAME
     13529**DCL     13530--REDEF
KL_DREC.PASSWORD
     13344**DCL     13348--REDEF
KL_DREC.RENAME
     13367**DCL     13368--REDEF
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:99   
KL_DREC_CNT.PASSWORD
     13231**DCL     13235--REDEF
KL_DREC_CNT.RENAME
     13254**DCL     13255--REDEF
KL_LINEDEV
     15172**DCL     15317--ASSIGN  15368--ASSIGN
LINE$
     14561**DCL        10--PROC    15314>>IF
LINE$DREC.LN
     14715**DCL     15309--ASSIGN  15309--ASSIGN  15310--ASSIGN
LINE$DREC.NWINFO
     14694**DCL     15310>>ASSIGN
LINE$DREC.PASSWORD
     14654**DCL     14658--REDEF
LINE$DREC.RENAME
     14677**DCL     14678--REDEF
LOOP_END
     15367**LABEL   15361--CALLALT 15364--GOTO
NAME
     14562**DCL        10--PROC
NAME.TEXT
     14564**DCL     15322>>IF      15325>>CALLBLT 15330>>CALLBLT 15332>>IF      15332>>IF      15361<>CALL
PROJ_KEY.TEXT
     11578**DCL     11578--REDEF
PROJ_KEY.TXT.PROJECT
     11578**DCL     11578--REDEF
REMEM_VAR
     11704**DCL     11704--REDEF
REM_FCMD
     11704**DCL     11705--REDEF
SIZE
     14565**DCL        10--PROC
TEMPCONT
     15003**DCL     15360<<CALLBLT 15361<>CALL
TEXT$C.CNT
     14579**DCL     14580--IMP-SIZ
PL6.E3A0      #002=ASL$FIND_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI         TUE 07/29/97 10:08 Page:100  
USERS_KEY.TEXT
     11575**DCL     11576--REDEF   11576--REDEF   11576--REDEF   11577--REDEF
WILD_CARD
     15004**DCL     15313<<ASSIGN  15327<<ASSIGN  15332>>IF      15332>>IF      15359>>IF      15363>>IF

PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:101  
      538        1        /*T***********************************************************/
      539        2        /*T*                                                         */
      540        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      541        4        /*T*                                                         */
      542        5        /*T***********************************************************/
      543        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:102  
      544        7        ASL$DISP_ONE_CONTROLLER: PROC (CONTROLLER$, JCL, LINE_NAME);
      545        8        /**********************************************************/
      546        9
      547       10        /*D* NAME:     ASL$DISP_ONE_CONTROLLER
      548       11             CALL:     CALL ASL$DISP_ONE_CONTROLLER ( CONTROLLER$, JCL)
      549       12             INPUT:    CONTROLLER$ - Pointer to a kl_controller structure.
      550       13                       DISP   - bit set for display, not set for list.
      551       14                       JCL    - bit set for JCL type display.
      552       15                       LINE_NAME - NAME OF THE LINE THE CURRENT CONTROLLER
      553       16                                   BELONGS TO.
      554       17             OUTPUT:   Nothing is returned.
      555       18             DESCRIPTION:  ASL$DISP_ONE_CONTROLLER is the routine to handle
      556       19                           the list/display of a controller pointed at by
      557       20                           CONTROLLER$.  The output from this routine will
      558       21                           depened upon the setting of the JCL and DISP flags.
      559       22        */
      560       23        /********************************************************************/
      561       24        /*   Include files   include files   include files   include files  */
      562       25        /********************************************************************/
      563       26        %INCLUDE AS_PERR_C;
      564      628        %INCLUDE AS_SUPER_C;
      565     1063        %INCLUDE AS_SUBS_C;
      566     2477        %INCLUDE AS_MAC_C;
      567     2557        %INCLUDE AS_ENTRIES_M;
      568     3607        %INCLUDE AS_SSUBS_C;
      569     3699        %INCLUDE B_ERRORS_C;
      570     4826        %INCLUDE KL_SUPER_C;
      571     7728        %INCLUDE XU_MACRO_C;
      572    10834        %INCLUDE XU_FORMAT_C;
      573    10996        %INCLUDE AS_SUPER_R;
      574    14012        /********************************************************************/
      575    14013        /*   Parameters      parameters      parameters      parameters     */
      576    14014        /********************************************************************/
      577    14015    1   DCL CONTROLLER$       PTR;
      578    14016    1   DCL JCL               BIT(1);
      579    14017    1   DCL LINE_NAME         CHAR(8);
      580    14018        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:103  
      581    14019        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      582    14020        /********************************************************************/
      583    14021    1   DCL X$FORMAT ENTRY(1);
      584    14022        %ASB$WRITE_LO ;
      585    14025        /********************************************************************/
      586    14026        /*   Local based     local based     local based     local based    */
      587    14027        /********************************************************************/
      588    14028        %KL_CONTROLLER ( NAME = KL$CONTROLLER,
      589    14029                         LVL = 1,
      590    14030                         LAST = ";",
      591    14031                         STCLASS = "BASED( CONTROLLER$ )" );
      592    14180        %KL$UWORD      ( NAME=KL_UWORD, STCLASS=AUTO );
      593    14185        %KL$UBWORD     ( NAME=KL_UBWORD, STCLASS=AUTO );
      594    14195        /********************************************************************/
      595    14196        /*   Constant data   constant data   constant data   constant data  */
      596    14197        /********************************************************************/
      597    14198    1   DCL CONTROLLER_FMT_DISP    CHAR(0) CONSTANT INIT
      598    14199    1   ('%5-CONTROLLER %D%2/%10-COLUMNS = %D%27-ROWS = %D%42-TYPE = %D%57-# of DEVICES = %D
             14199        %2/');
      599    14200    1   DCL CONTROLLER_FMT_JCL     CHAR(0) CONSTANT INIT
      600    14201    1   ('CREATE CONTROLLER %D FOR LINE %A%/%5-COLUMNS = %D;%25-ROWS = %D;%40-TYPE = %D%/
             14201        END');
      601    14202        /********************************************************************/
      602    14203        /*   Procedure       procedure       procedure       procedure      */
      603    14204        /********************************************************************/
      604    14205                                        /* Display controller jcl. */
      605    14206    2   IF JCL THEN DO;
      606    14207    2      FMT_BUF = CONTROLLER_FMT_JCL;
      607    14208    2      FDS.FMT_.BOUND = SIZEV(CONTROLLER_FMT_JCL);
      608    14209    2      FDS.NVECS# = 5;
      609    14210    2      FMT_VEC(0) = VECTOR( KL$CONTROLLER.CONT# );
      610    14211    2      FMT_VEC(1) = VECTOR (LINE_NAME);
      611    14212    2      FMT_VEC(2) = VECTOR( KL$CONTROLLER.COLUMNS );
      612    14213    2      FMT_VEC(3) = VECTOR( KL$CONTROLLER.ROWS );
      613    14214    2      KL_UBWORD.NUM = KL$CONTROLLER.TYPE;
      614    14215    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;
      615    14216    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:104  
      616    14217    2      FMT_VEC(4) = VECTOR( KL_UWORD );
      617    14218    2      CALL X$FORMAT( FDS );
      618    14219    2      END; /*  Jcl  */
      619    14220                                        /* Display controller info. */
      620    14221    2   ELSE DO;
      621    14222    2      FMT_BUF = CONTROLLER_FMT_DISP;
      622    14223    2      FDS.FMT_.BOUND = SIZEV(CONTROLLER_FMT_DISP);
      623    14224    2      FDS.NVECS# = 5;
      624    14225    2      FMT_VEC(0) = VECTOR( KL$CONTROLLER.CONT# );
      625    14226    2      FMT_VEC(1) = VECTOR( KL$CONTROLLER.COLUMNS );
      626    14227    2      FMT_VEC(2) = VECTOR( KL$CONTROLLER.ROWS );
      627    14228    2      KL_UBWORD.NUM = KL$CONTROLLER.TYPE;
      628    14229    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;
      629    14230    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;
      630    14231    2      FMT_VEC(3) = VECTOR( KL_UWORD );
      631    14232    2      FMT_VEC(4) = VECTOR( KL$CONTROLLER.BLKHDR.NSUBS );
      632    14233    2      CALL X$FORMAT( FDS );
      633    14234    2      END; /*  Not jcl  */
      634    14235    1   RETURN;
      635    14236
      636    14237    1   END ASL$DISP_ONE_CONTROLLER;

PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:105  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_CONTROLLER.

   Procedure ASL$DISP_ONE_CONTROLLER requires 130 words for executable code.
   Procedure ASL$DISP_ONE_CONTROLLER requires 10 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_CONTROLLERS.:E05TSI    .

PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:106  

 Object Unit name= ASL$DISP_ONE_CONTROLLER                    File name= ASL$LIST_CONTROLLERS.:E05TOU
 UTS= JUL 29 '97 10:10:12.48 TUE                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$LO
    1  RoData even  UTS     44     54  ASL$DISP_ONE_CONTROLLER
    2   Proc  even  none   130    202  ASL$DISP_ONE_CONTROLLER
    3  RoData even  none     5      5  ASL$DISP_ONE_CONTROLLER

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     2      0   yes            yes      Std        3  ASL$DISP_ONE_CONTROLLER

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes          ~proc      0 XU_OUTPUT_OPTIONS
         yes           Std       1 X$FORMAT
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:107  

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
r    AS_MODE                          r    AS_FE_MODE                            M$LO
     FDS                                   FMT_BUF                               FMT_VEC
     ERR_CODE                              REMEM_VAR                             REM_FCMD
     ASA_BRKS_LOC                          B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:108  


      538        1        /*T***********************************************************/
      539        2        /*T*                                                         */
      540        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      541        4        /*T*                                                         */
      542        5        /*T***********************************************************/
      543        6        %EJECT;
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:109  
      544        7        ASL$DISP_ONE_CONTROLLER: PROC (CONTROLLER$, JCL, LINE_NAME);

      7  2 000000   000000 700200 xent  ASL$DISP_ON* TSX0  ! X66_AUTO_3
         2 000001   000012 000003                    ZERO    10,3

      545        8        /**********************************************************/
      546        9
      547       10        /*D* NAME:     ASL$DISP_ONE_CONTROLLER
      548       11             CALL:     CALL ASL$DISP_ONE_CONTROLLER ( CONTROLLER$, JCL)
      549       12             INPUT:    CONTROLLER$ - Pointer to a kl_controller structure.
      550       13                       DISP   - bit set for display, not set for list.
      551       14                       JCL    - bit set for JCL type display.
      552       15                       LINE_NAME - NAME OF THE LINE THE CURRENT CONTROLLER
      553       16                                   BELONGS TO.
      554       17             OUTPUT:   Nothing is returned.
      555       18             DESCRIPTION:  ASL$DISP_ONE_CONTROLLER is the routine to handle
      556       19                           the list/display of a controller pointed at by
      557       20                           CONTROLLER$.  The output from this routine will
      558       21                           depened upon the setting of the JCL and DISP flags.
      559       22        */
      560       23        /********************************************************************/
      561       24        /*   Include files   include files   include files   include files  */
      562       25        /********************************************************************/
      563       26        %INCLUDE AS_PERR_C;
      564      628        %INCLUDE AS_SUPER_C;
      565     1063        %INCLUDE AS_SUBS_C;
      566     2477        %INCLUDE AS_MAC_C;
      567     2557        %INCLUDE AS_ENTRIES_M;
      568     3607        %INCLUDE AS_SSUBS_C;
      569     3699        %INCLUDE B_ERRORS_C;
      570     4826        %INCLUDE KL_SUPER_C;
      571     7728        %INCLUDE XU_MACRO_C;
      572    10834        %INCLUDE XU_FORMAT_C;
      573    10996        %INCLUDE AS_SUPER_R;
      574    14012        /********************************************************************/
      575    14013        /*   Parameters      parameters      parameters      parameters     */
      576    14014        /********************************************************************/
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:110  
      577    14015    1   DCL CONTROLLER$       PTR;
      578    14016    1   DCL JCL               BIT(1);
      579    14017    1   DCL LINE_NAME         CHAR(8);
      580    14018        /********************************************************************/
      581    14019        /*   Entry dcls      entry dcls      entry dcls      entry dcls     */
      582    14020        /********************************************************************/
      583    14021    1   DCL X$FORMAT ENTRY(1);
      584    14022        %ASB$WRITE_LO ;
      585    14025        /********************************************************************/
      586    14026        /*   Local based     local based     local based     local based    */
      587    14027        /********************************************************************/
      588    14028        %KL_CONTROLLER ( NAME = KL$CONTROLLER,
      589    14029                         LVL = 1,
      590    14030                         LAST = ";",
      591    14031                         STCLASS = "BASED( CONTROLLER$ )" );
      592    14180        %KL$UWORD      ( NAME=KL_UWORD, STCLASS=AUTO );
      593    14185        %KL$UBWORD     ( NAME=KL_UBWORD, STCLASS=AUTO );
      594    14195        /********************************************************************/
      595    14196        /*   Constant data   constant data   constant data   constant data  */
      596    14197        /********************************************************************/
      597    14198    1   DCL CONTROLLER_FMT_DISP    CHAR(0) CONSTANT INIT
      598    14199    1  ('%5-CONTROLLER %D%2/%10-COLUMNS = %D%27-ROWS = %D%42-TYPE = %D%57-# of DEVICES = %D
             14199        %2/');
      599    14200    1   DCL CONTROLLER_FMT_JCL     CHAR(0) CONSTANT INIT
      600    14201    1   ('CREATE CONTROLLER %D FOR LINE %A%/%5-COLUMNS = %D;%25-ROWS = %D;%40-TYPE = %D%/
             14201        END');
      601    14202        /********************************************************************/
      602    14203        /*   Procedure       procedure       procedure       procedure      */
      603    14204        /********************************************************************/
      604    14205                                        /* Display controller jcl. */
      605    14206    2   IF JCL THEN DO;

  14206  2 000002   200004 470500                    LDP0    @JCL,,AUTO
         2 000003   000000 066500                    CMPB    filb='0'B
         2 000004   000000 000001                    BDSC    0,,PR0                   by=0,bit=0,n=1
         2 000005   000002 000022 xsym               BDSC    B_VECTNIL+2              by=0,bit=0,n=18
         2 000006   000103 600000 2                  TZE     s:14222
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:111  

      606    14207    2      FMT_BUF = CONTROLLER_FMT_JCL;

  14207  2 000007   040000 100400                    MLR     fill='040'O
         2 000010   000026 000125 1                  ADSC9   CONTROLLER_FMT_JCL       cn=0,n=85
         2 000011   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      607    14208    2      FDS.FMT_.BOUND = SIZEV(CONTROLLER_FMT_JCL);

  14208  2 000012   000000 236000 xsym               LDQ     FDS
         2 000013   177777 376007                    ANQ     65535,DL
         2 000014   000025 276003                    ORQ     21,DU
         2 000015   000000 756000 xsym               STQ     FDS

      608    14209    2      FDS.NVECS# = 5;

  14209  2 000016   000005 235007                    LDA     5,DL
         2 000017   000011 755000 xsym               STA     FDS+9

      609    14210    2      FMT_VEC(0) = VECTOR( KL$CONTROLLER.CONT# );

  14210  2 000020   200003 471500                    LDP1    @CONTROLLER$,,AUTO
         2 000021   100000 473500                    LDP3    0,,PR1
         2 000022   177640 235007                    LDA     65440,DL
         2 000023   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000024   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000025   000002 036003                    ADLQ    2,DU
         2 000026   000000 755000 xsym               STA     FMT_VEC
         2 000027   000001 756000 xsym               STQ     FMT_VEC+1

      610    14211    2      FMT_VEC(1) = VECTOR (LINE_NAME);

  14211  2 000030   000000 235000 3                  LDA     0
         2 000031   200005 236100                    LDQ     @LINE_NAME,,AUTO
         2 000032   000002 755000 xsym               STA     FMT_VEC+2
         2 000033   000003 756000 xsym               STQ     FMT_VEC+3

PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:112  
      611    14212    2      FMT_VEC(2) = VECTOR( KL$CONTROLLER.COLUMNS );

  14212  2 000034   100000 473500                    LDP3    0,,PR1
         2 000035   177640 235007                    LDA     65440,DL
         2 000036   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000037   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000040   000001 036000 3                  ADLQ    1
         2 000041   000004 755000 xsym               STA     FMT_VEC+4
         2 000042   000005 756000 xsym               STQ     FMT_VEC+5

      612    14213    2      FMT_VEC(3) = VECTOR( KL$CONTROLLER.ROWS );

  14213  2 000043   100000 473500                    LDP3    0,,PR1
         2 000044   177640 235007                    LDA     65440,DL
         2 000045   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000046   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000047   000002 036000 3                  ADLQ    2
         2 000050   000006 755000 xsym               STA     FMT_VEC+6
         2 000051   000007 756000 xsym               STQ     FMT_VEC+7

      613    14214    2      KL_UBWORD.NUM = KL$CONTROLLER.TYPE;

  14214  2 000052   100000 473500                    LDP3    0,,PR1
         2 000053   000100 100500                    MLR     fill='000'O
         2 000054   300003 000002                    ADSC9   3,,PR3                   cn=0,n=2
         2 000055   200007 400002                    ADSC9   KL_UBWORD,,AUTO          cn=2,n=2

      614    14215    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;

  14215  2 000056   200007 236100                    LDQ     KL_UBWORD,,AUTO
         2 000057   377000 376007                    ANQ     130560,DL
         2 000060   000001 772000                    QRL     1
         2 000061   200006 676100                    ERQ     KL_UWORD,,AUTO
         2 000062   000003 376000 3                  ANQ     3
         2 000063   200006 656100                    ERSQ    KL_UWORD,,AUTO

      615    14216    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:113  

  14216  2 000064   200007 236100                    LDQ     KL_UBWORD,,AUTO
         2 000065   200006 676100                    ERQ     KL_UWORD,,AUTO
         2 000066   000377 376007                    ANQ     255,DL
         2 000067   200006 656100                    ERSQ    KL_UWORD,,AUTO

      616    14217    2      FMT_VEC(4) = VECTOR( KL_UWORD );

  14217  2 000070   777640 235007                    LDA     -96,DL
         2 000071   200010 452500                    STP2    KL_UBWORD+1,,AUTO
         2 000072   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000073   000006 036003                    ADLQ    6,DU
         2 000074   000010 755000 xsym               STA     FMT_VEC+8
         2 000075   000011 756000 xsym               STQ     FMT_VEC+9

      617    14218    2      CALL X$FORMAT( FDS );

  14218  2 000076   000004 630400 3                  EPPR0   4
         2 000077   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000100   000000 701000 xent               TSX1    X$FORMAT
         2 000101   000000 011000                    NOP     0

      618    14219    2      END; /*  Jcl  */

  14219  2 000102   000201 710000 2                  TRA     s:14235

      619    14220                                        /* Display controller info. */
      620    14221    2   ELSE DO;

      621    14222    2      FMT_BUF = CONTROLLER_FMT_DISP;

  14222  2 000103   040000 100400                    MLR     fill='040'O
         2 000104   000000 000125 1                  ADSC9   CONTROLLER_FMT_DISP      cn=0,n=85
         2 000105   000000 000377 xsym               ADSC9   FMT_BUF                  cn=0,n=255

      622    14223    2      FDS.FMT_.BOUND = SIZEV(CONTROLLER_FMT_DISP);

PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:114  
  14223  2 000106   000000 236000 xsym               LDQ     FDS
         2 000107   177777 376007                    ANQ     65535,DL
         2 000110   000025 276003                    ORQ     21,DU
         2 000111   000000 756000 xsym               STQ     FDS

      623    14224    2      FDS.NVECS# = 5;

  14224  2 000112   000005 235007                    LDA     5,DL
         2 000113   000011 755000 xsym               STA     FDS+9

      624    14225    2      FMT_VEC(0) = VECTOR( KL$CONTROLLER.CONT# );

  14225  2 000114   200003 471500                    LDP1    @CONTROLLER$,,AUTO
         2 000115   100000 473500                    LDP3    0,,PR1
         2 000116   177640 235007                    LDA     65440,DL
         2 000117   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000120   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000121   000002 036003                    ADLQ    2,DU
         2 000122   000000 755000 xsym               STA     FMT_VEC
         2 000123   000001 756000 xsym               STQ     FMT_VEC+1

      625    14226    2      FMT_VEC(1) = VECTOR( KL$CONTROLLER.COLUMNS );

  14226  2 000124   100000 473500                    LDP3    0,,PR1
         2 000125   177640 235007                    LDA     65440,DL
         2 000126   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000127   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000130   000001 036000 3                  ADLQ    1
         2 000131   000002 755000 xsym               STA     FMT_VEC+2
         2 000132   000003 756000 xsym               STQ     FMT_VEC+3

      626    14227    2      FMT_VEC(2) = VECTOR( KL$CONTROLLER.ROWS );

  14227  2 000133   100000 473500                    LDP3    0,,PR1
         2 000134   177640 235007                    LDA     65440,DL
         2 000135   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000136   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:115  
         2 000137   000002 036000 3                  ADLQ    2
         2 000140   000004 755000 xsym               STA     FMT_VEC+4
         2 000141   000005 756000 xsym               STQ     FMT_VEC+5

      627    14228    2      KL_UBWORD.NUM = KL$CONTROLLER.TYPE;

  14228  2 000142   100000 473500                    LDP3    0,,PR1
         2 000143   000100 100500                    MLR     fill='000'O
         2 000144   300003 000002                    ADSC9   3,,PR3                   cn=0,n=2
         2 000145   200007 400002                    ADSC9   KL_UBWORD,,AUTO          cn=2,n=2

      628    14229    2      KL_UWORD.T = KL_UBWORD.REPLACE.T;

  14229  2 000146   200007 236100                    LDQ     KL_UBWORD,,AUTO
         2 000147   377000 376007                    ANQ     130560,DL
         2 000150   000001 772000                    QRL     1
         2 000151   200006 676100                    ERQ     KL_UWORD,,AUTO
         2 000152   000003 376000 3                  ANQ     3
         2 000153   200006 656100                    ERSQ    KL_UWORD,,AUTO

      629    14230    2      KL_UWORD.B = KL_UBWORD.REPLACE.B;

  14230  2 000154   200007 236100                    LDQ     KL_UBWORD,,AUTO
         2 000155   200006 676100                    ERQ     KL_UWORD,,AUTO
         2 000156   000377 376007                    ANQ     255,DL
         2 000157   200006 656100                    ERSQ    KL_UWORD,,AUTO

      630    14231    2      FMT_VEC(3) = VECTOR( KL_UWORD );

  14231  2 000160   777640 235007                    LDA     -96,DL
         2 000161   200010 452500                    STP2    KL_UBWORD+1,,AUTO
         2 000162   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000163   000006 036003                    ADLQ    6,DU
         2 000164   000006 755000 xsym               STA     FMT_VEC+6
         2 000165   000007 756000 xsym               STQ     FMT_VEC+7

      631    14232    2      FMT_VEC(4) = VECTOR( KL$CONTROLLER.BLKHDR.NSUBS );
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:116  

  14232  2 000166   100000 473500                    LDP3    0,,PR1
         2 000167   177640 235007                    LDA     65440,DL
         2 000170   200010 453500                    STP3    KL_UBWORD+1,,AUTO
         2 000171   200010 236100                    LDQ     KL_UBWORD+1,,AUTO
         2 000172   200000 036007                    ADLQ    65536,DL
         2 000173   000010 755000 xsym               STA     FMT_VEC+8
         2 000174   000011 756000 xsym               STQ     FMT_VEC+9

      632    14233    2      CALL X$FORMAT( FDS );

  14233  2 000175   000004 630400 3                  EPPR0   4
         2 000176   000017 631400 xsym               EPPR1   B_VECTNIL+15
         2 000177   000000 701000 xent               TSX1    X$FORMAT
         2 000200   000000 011000                    NOP     0

      633    14234    2      END; /*  Not jcl  */

      634    14235    1   RETURN;

  14235  2 000201   000000 702200 xent               TSX2  ! X66_ARET
      635    14236
      636    14237    1   END ASL$DISP_ONE_CONTROLLER;

PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:117  
--  Include file information  --

   AS_SUPER_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_FORMAT_C.:E05TOU  is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   KL_SUPER_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   AS_SSUBS_C.:E05TOU  is referenced.
   AS_ENTRIES_M.:E05TOU  is referenced.
   AS_MAC_C.:E05TOU  cannot be made into a system file and is referenced.
   AS_SUBS_C.:E05TOU  is referenced.
   AS_SUPER_C.:E05TOU  is referenced.
   AS_PERR_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is never referenced.
      No diagnostics issued in procedure ASL$DISP_ONE_CONTROLLER.
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:118  

 **** Variables and constants ****

  ****  Section 001 RoData ASL$DISP_ONE_CONTROLLER

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c CHAR(85)    r     1 CONTROLLER_FMT_DISP       26-0-0/c CHAR(85)    r     1 CONTROLLER_FMT_JCL

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CONTROLLER$               4-0-0/w PTR         r     1 @JCL
     5-0-0/w PTR         r     1 @LINE_NAME                *0-0-0/w PTR         r     1 CONTROLLER$
    *0-0-0/b BIT         r     1 JCL                        7-0-0/w STRC        r     1 KL_UBWORD
     6-0-0/w STRC        r     1 KL_UWORD                  *0-0-0/c CHAR(8)     r     1 LINE_NAME

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(1080)  r     1 FDS                        0-0-0/c CHAR(255)   r     1 FMT_BUF
     0-0-0/w STRC(72)    r     1 FMT_VEC(0:75)

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/c STRC(144)   r     1 KL$CONTROLLER


   Procedure ASL$DISP_ONE_CONTROLLER requires 130 words for executable code.
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:119  
   Procedure ASL$DISP_ONE_CONTROLLER requires 10 words of local(AUTO) storage.

    No errors detected in file ASL$LIST_CONTROLLERS.:E05TSI    .
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:120  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:121  
          MINI XREF LISTING

ASA_BRKS_LOC
     11160**DCL     11160--REDEF
AS_DEFAULT.BANNER_PERM
     11853**DCL     11854--REDEF
AS_DEFAULT.BUDGET.MACCT
     11758**DCL     11762--REDEF
AS_DEFAULT.BUDGET.MAX_PROJECTS
     11771**DCL     11774--REDEF
AS_DEFAULT.BUDGET.PACCUM
     11754**DCL     11756--REDEF
AS_DEFAULT.BUDGET.PMAXC
     11749**DCL     11751--REDEF
AS_DEFAULT.SETUP_CHRA.TXT
     11869**DCL     11870--REDEF   11871--REDEF
AS_DEFAULT_DREC.PASSWORD
     13123**DCL     13127--REDEF
AS_DEFAULT_DREC.RENAME
     13146**DCL     13147--REDEF
AS_DFLT.BANNER_PERM
     11675**DCL     11676--REDEF
AS_DFLT.BUDGET.MACCT
     11580**DCL     11584--REDEF
AS_DFLT.BUDGET.MAX_PROJECTS
     11593**DCL     11596--REDEF
AS_DFLT.BUDGET.PACCUM
     11576**DCL     11578--REDEF
AS_DFLT.BUDGET.PMAXC
     11571**DCL     11573--REDEF
AS_DFLT.SETUP_CHRA.TXT
     11691**DCL     11692--REDEF   11693--REDEF
AS_FE_MODE
     11026**DCL     11027--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:122  
AS_MODE
     11023**DCL     11025--REDEF
AS_MOD_USER.ACCESS
     13888**DCL     13889--REDEF
AS_MOD_USER.BANNER
     13875**DCL     13876--REDEF
AS_MOD_USER.BANNER_PERM
     13877**DCL     13878--REDEF
AS_MOD_USER.BILL
     13883**DCL     13884--REDEF
AS_MOD_USER.CPROC
     13879**DCL     13880--REDEF
AS_MOD_USER.FEBILL
     13959**DCL     13960--REDEF
AS_MOD_USER.FECXTMEM
     13976**DCL     13977--REDEF
AS_MOD_USER.FEMINTS
     13961**DCL     13962--REDEF
AS_MOD_USER.FEMMEM
     13972**DCL     13973--REDEF
AS_MOD_USER.FEMTIME
     13970**DCL     13971--REDEF
AS_MOD_USER.FEPPRIV
     13967**DCL     13969--REDEF
AS_MOD_USER.FEPRIV
     13964**DCL     13966--REDEF
AS_MOD_USER.FORCE_BIT
     13873**DCL     13874--REDEF
AS_MOD_USER.KEY
     13955**DCL     13957--REDEF
AS_MOD_USER.LASTCPROC
     13881**DCL     13882--REDEF
AS_MOD_USER.LIMITS.DO_
     13929**DCL     13930--REDEF
AS_MOD_USER.LIMITS.FPOOLS
     13945**DCL     13946--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:123  
AS_MOD_USER.LIMITS.LO
     13925**DCL     13926--REDEF
AS_MOD_USER.LIMITS.MEM
     13921**DCL     13922--REDEF
AS_MOD_USER.LIMITS.MPRIO
     13949**DCL     13950--REDEF
AS_MOD_USER.LIMITS.PDIS
     13937**DCL     13938--REDEF
AS_MOD_USER.LIMITS.PO
     13933**DCL     13934--REDEF
AS_MOD_USER.LIMITS.TDIS
     13941**DCL     13942--REDEF
AS_MOD_USER.LIMITS.TIME
     13917**DCL     13918--REDEF
AS_MOD_USER.MAXENQ
     13898**DCL     13899--REDEF
AS_MOD_USER.PERM_BIT
     13871**DCL     13872--REDEF
AS_MOD_USER.PPRIV
     13893**DCL     13895--REDEF
AS_MOD_USER.PRIOB
     13900**DCL     13901--REDEF
AS_MOD_USER.PRIV
     13890**DCL     13892--REDEF
AS_MOD_USER.QUAN
     13896**DCL     13897--REDEF
AS_MOD_USER.SETUP
     13869**DCL     13870--REDEF
AS_PROJECT.BANNER_PERM
     12209**DCL     12210--REDEF
AS_PROJECT.BUDGET.MACCT
     12114**DCL     12118--REDEF
AS_PROJECT.BUDGET.MAX_PROJECTS
     12127**DCL     12130--REDEF
AS_PROJECT.BUDGET.PACCUM
     12110**DCL     12112--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:124  
AS_PROJECT.BUDGET.PMAXC
     12105**DCL     12107--REDEF
AS_PROJECT.SETUP_CHRA.TXT
     12225**DCL     12226--REDEF   12227--REDEF
AS_PROJECT_DFLT.BANNER_PERM
     12387**DCL     12388--REDEF
AS_PROJECT_DFLT.BUDGET.MACCT
     12292**DCL     12296--REDEF
AS_PROJECT_DFLT.BUDGET.MAX_PROJECTS
     12305**DCL     12308--REDEF
AS_PROJECT_DFLT.BUDGET.PACCUM
     12288**DCL     12290--REDEF
AS_PROJECT_DFLT.BUDGET.PMAXC
     12283**DCL     12285--REDEF
AS_PROJECT_DFLT.SETUP_CHRA.TXT
     12403**DCL     12404--REDEF   12405--REDEF
AS_PROJECT_DFLT_DREC.PASSWORD
     13609**DCL     13613--REDEF
AS_PROJECT_DFLT_DREC.RENAME
     13632**DCL     13633--REDEF
AS_PROJECT_DREC.PASSWORD
     13447**DCL     13451--REDEF
AS_PROJECT_DREC.RENAME
     13470**DCL     13471--REDEF
AS_PROJ_ADMIN.BANNER_PERM
     12031**DCL     12032--REDEF
AS_PROJ_ADMIN.BUDGET.MACCT
     11936**DCL     11940--REDEF
AS_PROJ_ADMIN.BUDGET.MAX_PROJECTS
     11949**DCL     11952--REDEF
AS_PROJ_ADMIN.BUDGET.PACCUM
     11932**DCL     11934--REDEF
AS_PROJ_ADMIN.BUDGET.PMAXC
     11927**DCL     11929--REDEF
AS_PROJ_ADMIN.SETUP_CHRA.TXT
     12047**DCL     12048--REDEF   12049--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:125  
AS_PROJ_ADMIN_DREC.PASSWORD
     13285**DCL     13289--REDEF
AS_PROJ_ADMIN_DREC.RENAME
     13308**DCL     13309--REDEF
AS_USERS.BANNER_PERM
     11497**DCL     11498--REDEF
AS_USERS.BUDGET.MACCT
     11402**DCL     11406--REDEF
AS_USERS.BUDGET.MAX_PROJECTS
     11415**DCL     11418--REDEF
AS_USERS.BUDGET.PACCUM
     11398**DCL     11400--REDEF
AS_USERS.BUDGET.PMAXC
     11393**DCL     11395--REDEF
AS_USERS.SETUP_CHRA.TXT
     11513**DCL     11514--REDEF   11515--REDEF
AS_USERS_CONSTANT.BANNER_PERM
     12565**DCL     12566--REDEF
AS_USERS_CONSTANT.BUDGET.MACCT
     12470**DCL     12474--REDEF
AS_USERS_CONSTANT.BUDGET.MAX_PROJECTS
     12483**DCL     12486--REDEF
AS_USERS_CONSTANT.BUDGET.PACCUM
     12466**DCL     12468--REDEF
AS_USERS_CONSTANT.BUDGET.PMAXC
     12461**DCL     12463--REDEF
AS_USERS_CONSTANT.SETUP_CHRA.TXT
     12581**DCL     12582--REDEF   12583--REDEF
CONTROLLER$
     14015**DCL         7--PROC    14046--IMP-PTR 14210>>ASSIGN  14212>>ASSIGN  14213>>ASSIGN  14214>>ASSIGN
     14225>>ASSIGN  14226>>ASSIGN  14227>>ASSIGN  14228>>ASSIGN  14232>>ASSIGN
CONTROLLER_FMT_DISP
     14198**DCL     14222>>ASSIGN  14223--ASSIGN
CONTROLLER_FMT_JCL
     14200**DCL     14207>>ASSIGN  14208--ASSIGN
ERR_CODE
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:126  
     11155**DCL     11156--REDEF
FDS
     11052**DCL     14218<>CALL    14233<>CALL
FDS.FMT_.BOUND
     11057**DCL     14208<<ASSIGN  14223<<ASSIGN
FDS.NVECS#
     11080**DCL     14209<<ASSIGN  14224<<ASSIGN
FMT_BUF
     11151**DCL     14207<<ASSIGN  14222<<ASSIGN
FMT_VEC
     11151**DCL     14210<<ASSIGN  14211<<ASSIGN  14212<<ASSIGN  14213<<ASSIGN  14217<<ASSIGN  14225<<ASSIGN
     14226<<ASSIGN  14227<<ASSIGN  14231<<ASSIGN  14232<<ASSIGN
JCL
     14016**DCL         7--PROC    14206>>IF
KL$CONTROLLER.BLKHDR.NSUBS
     14094**DCL     14232--ASSIGN
KL$CONTROLLER.COLUMNS
     14171**DCL     14212--ASSIGN  14226--ASSIGN
KL$CONTROLLER.CONT#
     14163**DCL     14210--ASSIGN  14225--ASSIGN
KL$CONTROLLER.ROWS
     14167**DCL     14213--ASSIGN  14227--ASSIGN
KL$CONTROLLER.TYPE
     14177**DCL     14214>>ASSIGN  14228>>ASSIGN
KL_DEFAULT.PASSWORD
     13771**DCL     13775--REDEF
KL_DEFAULT.RENAME
     13794**DCL     13795--REDEF
KL_DFLT.PASSWORD
     12961**DCL     12965--REDEF
KL_DFLT.RENAME
     12984**DCL     12985--REDEF
KL_DREC.PASSWORD
     12799**DCL     12803--REDEF
KL_DREC.RENAME
     12822**DCL     12823--REDEF
PL6.E3A0      #003=ASL$DISP_ONE_CONTROLLER File=ASL$LIST_CONTROLLERS.:E05TSI     TUE 07/29/97 10:10 Page:127  
KL_DREC_CNT.PASSWORD
     12686**DCL     12690--REDEF
KL_DREC_CNT.RENAME
     12709**DCL     12710--REDEF
KL_UBWORD.NUM
     14188**DCL     14189--REDEF   14214<<ASSIGN  14228<<ASSIGN
KL_UBWORD.REPLACE.B
     14193**DCL     14216>>ASSIGN  14230>>ASSIGN
KL_UBWORD.REPLACE.T
     14191**DCL     14215>>ASSIGN  14229>>ASSIGN
KL_UWORD
     14181**DCL     14217--ASSIGN  14231--ASSIGN
KL_UWORD.B
     14183**DCL     14216<<ASSIGN  14230<<ASSIGN
KL_UWORD.T
     14182**DCL     14215<<ASSIGN  14229<<ASSIGN
LINE_NAME
     14017**DCL         7--PROC    14211--ASSIGN
PROJ_KEY.TEXT
     11033**DCL     11033--REDEF
PROJ_KEY.TXT.PROJECT
     11033**DCL     11033--REDEF
REMEM_VAR
     11159**DCL     11159--REDEF
REM_FCMD
     11159**DCL     11160--REDEF
USERS_KEY.TEXT
     11030**DCL     11031--REDEF   11031--REDEF   11031--REDEF   11032--REDEF
X$FORMAT
     14021**DCL-ENT 14218--CALL    14233--CALL
