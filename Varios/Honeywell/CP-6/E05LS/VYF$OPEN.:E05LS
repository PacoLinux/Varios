VERSION E05

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:1    
        1        1        /*M* VYF$OPEN - M$OPEN interface for LEMUR */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        VYF$OPEN:
       10       10            PROC( CURR_P$, TYPE, P_MODE, DEL ) ALTRET;
       11       11        %INCLUDE VY_INC_C;
       12     9187        %VY$NODE;

              9199    1   /*******************************************************************************
              9200    1   *                                                                              *
              9201    1   *                          VY$NODE                                                 *
              9202    1   *                                                                              *
              9203    1   *******************************************************************************/

              9219    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9220    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9221    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9222    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9223    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9224    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9225                              to list of file nodes for this node            */
              9226    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9227    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9227                  /* Head pointer to shared library list */
              9228    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9228                  /* Head pointer to list of shared libraries
              9229                                          which have been mapped to included libraries */
              9230    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9231    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9232    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9233    1         2 ADDR_START REDEF  ADDR_START_A,
              9234    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:2    
              9235    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9236    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9237    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9238    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9239    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9240    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9241    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9242    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9243    1         2 START_PAGE# REDEF START_PAGE#_A,
              9244    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9245    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9246    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9247    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9248    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9249    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9250    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9251    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9252    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9252                  /* Starting pointer for common sections for this node */
              9253    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9253                  /* Stopping pointer for common sections for this node */
              9254    1         2 L_START,
              9255    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9256    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9257    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9258    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9259    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9260    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9261    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9262    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9263    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9264    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9265    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9266    1         2 L_STOP,
              9267    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9268    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9269    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:3    
              9270    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9271    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9272    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9273    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9274    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9275    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9276    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9277    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9278    1         2 L_SIZE,
              9279    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9280    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9281    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9282    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9283    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9284    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9285    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9286    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9287    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9288    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9289    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9290    1         2 L_PREV_SIZE,
              9291    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9292    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9293    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9294    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9295    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9296    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9297    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9298    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9299    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9300    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9301    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
              9302    1         2 BIT_MAP                ALIGNED,
              9303    1           3 DATA                  ALIGNED,
              9304    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9305    1           3 RPROC                 ALIGNED,
              9306    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:4    
              9307    1           3 ROS                   ALIGNED,
              9308    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9309    1         2 L_SC_START,
              9310    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9311    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9312    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9313    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9314    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9315    1         2 L_SC_STOP,
              9316    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9317    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9318    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9319    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9320    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9321    1         2 PROMOTE_HEAD,
              9322    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9323    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9324    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9325    1         2 PROMOTE_TAIL,
              9326    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9327    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9328    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9329    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9330    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9331    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9332    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

       13     9336        %VY$LST;

              9348    1   /*******************************************************************************
              9349    1   *                                                                              *
              9350    1   *                          VY$LST                                                 *
              9351    1   *                                                                              *
              9352    1   *******************************************************************************/

              9357    1   DCL 1 VY$LST                        ALIGNED BASED,
              9358    1         2 LINK$        PTR,               /* Link to next item                  */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:5    
              9359    1         2 TYPE         UBIN( 18) UNAL,    /* Type                               */
              9360    1         2 SUB_TYPE     UBIN( 18) UNAL,    /* Sub-type                           */
              9361    1         2 OBJECT_NAME$ PTR,               /* Pointer to object unit name        */
              9362    1         2 SC_HEAD$     PTR,               /* Head pointer to section link list  */
              9363    1         2 SC_TAIL$     PTR,               /* Tail pointer to section link list  */
              9364    1         2 P,
              9365    1           3 NAME_       ALIGNED,
              9366    1             4 BOUND      UBIN(20)  UNAL,
              9367    1             4 FLAGSV     UBIN(11)  UNAL,
              9368    1             4 *          BIT(5)    UNAL,
              9369    1             4 NAME$      PTR,
              9370    1           3 ACCT_       ALIGNED,
              9371    1             4 BOUND      UBIN(20)  UNAL,
              9372    1             4 FLAGSV     UBIN(11)  UNAL,
              9373    1             4 *          BIT(5)    UNAL,
              9374    1             4 ACCT$      PTR,
              9375    1           3 PASS_       ALIGNED,
              9376    1             4 BOUND      UBIN(20)  UNAL,
              9377    1             4 FLAGSV     UBIN(11)  UNAL,
              9378    1             4 *          BIT(5)    UNAL,
              9379    1             4 PASS$      PTR,
              9380    1           3 SN_         ALIGNED,
              9381    1             4 BOUND      UBIN(20)  UNAL,
              9382    1             4 FLAGSV     UBIN(11)  UNAL,
              9383    1             4 *          BIT(5)    UNAL,
              9384    1             4 SN$        PTR,
              9385    1           3 WSN_        ALIGNED,
              9386    1             4 BOUND      UBIN(20)  UNAL,
              9387    1             4 FLAGSV     UBIN(11)  UNAL,
              9388    1             4 *          BIT(5)    UNAL,
              9389    1             4 WSN$       PTR,
              9390    1           3 B           ALIGNED,
              9391    1             4 RES        BIT(1)    UNAL,
              9392    1             4 ASN        BIT(1)    UNAL,
              9393    1             4 *          BIT(34)   UNAL,
              9394    1           3 RES         CHAR(4)   ALIGNED,
              9395    1           3 ASN         UBIN(36)  ALIGNED;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:6    
       14     9398        %VY$LLIST;

              9410    1   /*******************************************************************************
              9411    1   *                                                                              *
              9412    1   *                          VY$LLIST                                                *
              9413    1   *                                                                              *
              9414    1   *******************************************************************************/

              9419    1   DCL 1 VY$LLIST                BASED     ALIGNED,
              9420    1         2 LINK$                  PTR  ALIGNED,
              9421    1         2 ITEM$                  PTR  ALIGNED;
       15     9424        %T$C;

              9436    1   /*******************************************************************************
              9437    1   *                                                                              *
              9438    1   *                          T$C                                                 *
              9439    1   *                                                                              *
              9440    1   *******************************************************************************/

              9445    1   DCL 1 T$C           BASED     ALIGNED,  /* Text count                         */
              9446    1         2 COUNT        UBIN( 9) UNAL,
              9447    1         2 CHARS        CHAR( T$C.COUNT )   UNAL;
              9448    1   DCL 1 T$C_UNAL      BASED     UNAL,     /* Text count                         */
              9449    1         2 COUNT        UBIN( 9) UNAL,
              9450    1         2 CHARS        CHAR( T$C_UNAL.COUNT ) UNAL;
       16     9453        %VECTOR( NAME=ACCT_VECTOR, STCLASS=STATIC );

              9466    1   /*******************************************************************************
              9467    1   *                                                                              *
              9468    1   *                          TEMPLATE FOR 2-WORD NSA VECTOR                          *
              9469    1   *                                                                              *
              9470    1   *******************************************************************************/

              9475    1   DCL 1 ACCT_VECTOR STATIC ALIGNED,
              9476    1         2 VSIZE UBIN(20) UNAL,      /* Size field of vector               */
              9477    1         2 FLAGS BIT(9) UNAL,        /* FLAGS...                           */
              9478    1         2 V BIT(2) UNAL,            /* Vector type field                  */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:7    
              9479    1         2 Z5 BIT(5) UNAL,           /* Unused                             */
              9480    1         2 F,
              9481    1           3 BASE UBIN(20) UNAL,     /* Base for vector                    */
              9482    1           3 Z4 BIT(4) UNAL,         /* Unused                             */
              9483    1           3 SEGID UBIN(12) UNAL,    /* Segid                              */
              9484    1         2 P       REDEF     F,            /* To extract the pointer             */
              9485    1           3 POINTER          PTR UNAL;
       17     9488        %PLIST;
       18     9489        %F$DCB;
       19     9546        %PARSE$OUT( NAME=O$B, STCLASS="BASED");
       20     9591        %INCLUDE VY_PSUBS_C;
       21     9652        %B$TCB;
       22     9655        %B$ALT;
       23     9663        %FILE;
       24     9672        %INCLUDE B_ERRORS_C;
       25    10799    1   DCL M$OF DCB;
       26    10800    1   DCL M$RF DCB;
       27    10801    1   DCL M$LF DCB;
       28    10802    1   DCL M$SI DCB;
       29    10803    1   DCL M$LO DCB;
       30    10804    1   DCL M$DO DCB;
       31    10805    1   DCL M$EI DCB;
       32    10806        %FPT_OPEN( FPTN=VY_EI_FPT_OPEN,
       33    10807         DCB=M$EI,
       34    10808         ASN=FILE,
       35    10809         ORG=KEYED,
       36    10810         ACS=SEQUEN,
       37    10811         FUN=IN,
       38    10812         SCRUB=YES,
       39    10813         STCLASS="STATIC SYMDEF");
       40    10922        %FPT_OPEN( FPTN=VY_O_FPT_OPEN,
       41    10923         DCB=M$OF,
       42    10924         ASN=FILE,
       43    10925         ORG=KEYED,
       44    10926         ACS=DIRECT,
       45    10927         FUN=IN,
       46    10928         SCRUB=YES,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:8    
       47    10929         STCLASS="STATIC SYMDEF");
       48    11038        %FPT_OPEN( FPTN=VY_R_FPT_OPEN,
       49    11039         DCB=M$RF,
       50    11040         ASN=FILE,
       51    11041         ORG=KEYED,
       52    11042         ACS=DIRECT,
       53    11043         LSLIDE=10,
       54    11044         STCLASS="STATIC SYMDEF");
       55    11153        %FPT_FID (FPTN=ACCT_FID,
       56    11154         ACCT = ACCT_NAME,
       57    11155         SN = SN_NAME,
       58    11156         ASN = F.ASN,
       59    11157         RES = F.RES,
       60    11158         RESULTS = AFR);
       61    11181        %VLP_ACCT (FPTN = ACCT_NAME);
       62    11194        %VLP_SN (FPTN = SN_NAME,N=1);
       63    11207        %VLR_FID (FPTN = AFR);
       64    11226    1   DCL 1 F ALIGNED STATIC,
       65    11227    1         2 ASN UBIN(9) ALIGNED,
       66    11228    1         2 RES CHAR(4) ALIGNED;
       67    11229        %FPT_OPEN( FPTN=F$O, STCLASS="BASED(FPT$)");
       68    11338        %E;

             11346    1   /*******************************************************************************
             11347    1   *                                                                              *
             11348    1   *                          ENTRY                                                 *
             11349    1   *                                                                              *
             11350    1   *******************************************************************************/

       69    11354        %ENTRIES;
       70    11369    1   DCL VYF$CLOSE ENTRY(3);
       71    11370    1   DCL VYP$PAR ENTRY(3) ALTRET;
       72    11371    1   DCL VYS$LST ENTRY(6) ALTRET;
       73    11372        %U;

             11380    1   /*******************************************************************************
             11381    1   *                                                                              *
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:9    
             11382    1   *                          UBIN                                                 *
             11383    1   *                                                                              *
             11384    1   *******************************************************************************/

       74    11388        %INDEX;
       75    11398    1   DCL ANSWER UBIN(36) ALIGNED STATIC/*AUTO*/;
       76    11399    1   DCL ERR UBIN(36) ALIGNED STATIC/*AUTO*/;
       77    11400    1   DCL NCHARS UBIN(36) ALIGNED STATIC/*AUTO*/;
       78    11401    1   DCL WKSZ UBIN(36) ALIGNED STATIC/*AUTO*/;
       79    11402    1   DCL MODE UBIN(36);
       80    11403    1   DCL EX UBIN(36) ALIGNED STATIC/*AUTO*/;
       81    11404    1   DCL DCB# UBIN(36) ALIGNED STATIC/*AUTO*/;
       82    11405        %P;

             11413    1   /*******************************************************************************
             11414    1   *                                                                              *
             11415    1   *                          PARAMETERS                                              *
             11416    1   *                                                                              *
             11417    1   *******************************************************************************/

       83    11421    1   DCL CURR_P$ PTR;
       84    11422    1   DCL TYPE UBIN(36);
       85    11423    1   DCL P_MODE UBIN(36);
       86    11424    1   DCL DEL BIT(1) ALIGNED;
       87    11425        %PTR;

             11433    1   /*******************************************************************************
             11434    1   *                                                                              *
             11435    1   *                          PTR                                                 *
             11436    1   *                                                                              *
             11437    1   *******************************************************************************/

       88    11441    1   DCL WORK$ PTR ALIGNED STATIC/*AUTO*/;
       89    11442    1   DCL WHERE$ PTR ALIGNED STATIC/*AUTO*/;
       90    11443    1   DCL CURR$ PTR ALIGNED STATIC/*AUTO*/;
       91    11444    1   DCL DCB$ PTR ALIGNED STATIC/*AUTO*/;
       92    11445    1   DCL FPT$ PTR ALIGNED STATIC/*AUTO*/;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:10   
       93    11446    1   DCL SRCH_CURR$ PTR ALIGNED STATIC/*AUTO*/;
       94    11447    1   DCL VY_N_START_FID UBIN(36) ALIGNED SYMREF;
       95    11448        %C;

             11456    1   /*******************************************************************************
             11457    1   *                                                                              *
             11458    1   *                          CHAR                                                 *
             11459    1   *                                                                              *
             11460    1   *******************************************************************************/

       96    11464    1   DCL FILE_NAME CHAR(40) STATIC;
       97    11465
       98    11466
       99    11467        %FPT_WAIT(
      100    11468         FPTN=FPT_WAIT,
      101    11469         STCLASS=CONSTANT,
      102    11470         UNITS=60);
      103    11484        %INCLUDE CP_6_SUBS;
      104    12024        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:11   
      105    12025    2       DO CASE(TYPE);
      106    12026    2       CASE( 0/*@OF*/ );
      107    12027    2           FPT$ = ADDR( VY_O_FPT_OPEN );
      108    12028    2           DCB# = DCBNUM( M$OF );
      109    12029    2       CASE( 1/*@RF*/ );
      110    12030    2           FPT$ = ADDR( VY_R_FPT_OPEN );
      111    12031    2           DCB# = DCBNUM( M$RF );
      112    12032    3           IF MODE = 3/*@CREATE*/ THEN DO;
      113    12033    3               VY_R_FPT_OPEN.V.XTNSIZE# = 10;
      114    12034    3               VY_R_FPT_OPEN.V.IXTNSIZE# = 10;
      115    12035    3               END;
      116    12036    2       CASE( 2/*@LF*/ );
      117    12037    2           FPT$ = ADDR( VY_O_FPT_OPEN );
      118    12038    2           DCB# = DCBNUM( M$OF );
      119    12039    2       CASE( 3/*@SF*/ );
      120    12040    2           FPT$ = ADDR( VY_EI_FPT_OPEN );
      121    12041    2           DCB# = DCBNUM( M$EI );
      122    12042    2       CASE(ELSE);
      123    12043        /*E*  ERROR: VYF-E$INTERNAL_OPEN_TYPE_VY-0
      124    12044              MESSAGE: Internal link error. Bad type passed to VYF$OPEN: Type = %U1.
      125    12045              DESCRIPTION: Self-explanatory.
      126    12046        */
      127    12047                %NUMBER(
      128    12048                NUM1=TYPE, BASE1=10, SIZE1=12 );
      129    12065                %SCREAM(
      130    12066                ERR#=%E$INTERNAL_OPEN_TYPE_VY,
      131    12067                LEVEL=%@E$F_VY,
      132    12068                MID="'F'");
      133    12071    2           END;
      134    12072    2       IF DEL THEN DO;
      135    12073    2           MODE = 2;
      136    12074    2           EX = 2;
      137    12075    2           END;
      138    12076    2       ELSE DO;
      139    12077    3           DO CASE( P_MODE );
      140    12078    3           CASE(0);
      141    12079    3               MODE = 2;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:12   
      142    12080    3               EX = 2;
      143    12081    3           CASE( 1/*@C_ON_KEY_WORD*/ );
      144    12082    3               MODE = 3;
      145    12083    3               EX = 1;
      146    12084    3           CASE( 2/*@C_ADDTO_KEY_WORD*/,
      147    12085    3                  3/*@C_INTO_KEY_WORD*/ );
      148    12086    3               MODE = 3;
      149    12087    3               IF VY_COMMAND = 5/*@C_DELETE_KEY_WORD*/
      150    12088    3               THEN MODE = 1;
      151    12089    3               EX = 2;
      152    12090    3           CASE( 4/*@C_OVER_KEY_WORD*/ );
      153    12091    3               MODE = 3;
      154    12092    3               EX = 3;
      155    12093    3               END; /* Do case( P_MODE ); */
      156    12094    2           END; /* Else do; */
      157    12095    1   AGAIN:
      158    12096    1       F$O.V.DELETE# = DEL;
      159    12097    1       F$O.V.FUN# = MODE;
      160    12098    1       F$O.V.EXIST# = EX;
      161    12099    1       F$O.V.ORG# = 2/*@KEYED*/;
      162    12100    1       F$O.V.ACS# = 2/*@DIRECT*/;
      163    12101    1       F$O.V.SPARE# = 50;
      164    12102    1       F$O.V.INITZ.SCRUB# = '1'B/*@YES_B*/;
      165    12103    1       CURR$ = CURR_P$;
      166    12104    1       F$O.NAME_ = CURR$ -> VY$LST.P.NAME_;
      167    12105    1       F$O.ACCT_ = CURR$ -> VY$LST.P.ACCT_;
      168    12106    1       F$O.PASS_ = CURR$ -> VY$LST.P.PASS_;
      169    12107    1       F$O.SN_ = CURR$ -> VY$LST.P.SN_;
      170    12108    1       F$O.WSN_ = CURR$ -> VY$LST.P.WSN_;
      171    12109    2       IF TYPE = 0 AND VY_OD_SEARCH AND CURR$->VY$LST.P.ACCT_ = VECTOR (NIL) THEN DO;
      172    12110    2           SRCH_CURR$ = VY_SRCH_LST$;
      173    12111    2           ACCT_FID.TEXTFID_ = VECTOR (SRCH_CURR$->VY$LLIST.ITEM$->T$C.CHARS);
      174    12112    2           CALL M$FID (ACCT_FID) ALTRET (ACCT_FID_ERR);
      175    12113    2           IF AFR.ACCT THEN
      176    12114    2               F$O.ACCT_ = ACCT_FID.ACCT_;
      177    12115    2           IF AFR.SN THEN
      178    12116    2               F$O.SN_ = ACCT_FID.SN_;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:13   
      179    12117    2           END;
      180    12118    1       IF CURR$ -> VY$LST.P.B.ASN THEN F$O.V.ASN# = CURR$ -> VY$LST.P.ASN;
      181    12119    1       ELSE F$O.V.ASN# = 0;
      182    12120    1       IF CURR$ -> VY$LST.P.B.RES THEN F$O.V.RES# = CURR$ -> VY$LST.P.RES;
      183    12121    1       ELSE F$O.V.RES# = BINASC(0);
      184    12122    1   OPEN_FILE:
      185    12123
      186    12124    1       CALL M$OPEN( F$O ) ALTRET(ERROR);
      187    12125    1       IF (CURR$->VY$LST.LINK$ = ADDR(NIL)) AND (TYPE = 0 /*@OF*/) THEN
      188    12126    1           VY_OD_SEARCH = '0'B;
      189    12127    2       IF DEL THEN DO;
      190    12128        /*E*  ERROR: VYF-E$FILE_DELETED_VY-0
      191    12129              MESSAGE: ... File %FN deleted.
      192    12130              DESCRIPTION: Self-explanatory.
      193    12131        */
      194    12132    2           VY_FPT_ERRMSG.V.DCB# = DCB#;
      195    12133                %SCREAM( ERR#=%E$FILE_DELETED_VY, MID="'F'", LEVEL=0 );
      196    12136    2           RETURN;
      197    12137    2           END;
      198    12138        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:14   
      199    12139         /* Do some checks */
      200    12140    2       DO CASE( TYPE );
      201    12141    2       CASE(0/*@OF*/);
      202    12142    2           DCB$ = M$OF$;
      203    12143    2           GOTO CHECK_DCB;
      204    12144    2       CASE(2/*@LF*/);
      205    12145    2           DCB$ = M$LF$;
      206    12146    2   CHECK_DCB:
      207    12147    3           IF DCB$ -> F$DCB.ORG# ~= 2/*@KEYED*/ THEN DO;
      208    12148    3               VY_FPT_ERRMSG.V.DCB# = DCB#;
      209    12149        /*E*  ERROR: VYF-E$NOTKEYED_VY-0
      210    12150              MESSAGE: %FN is not a keyed file.
      211    12151              DESCRIPTION: Self-explanatory.
      212    12152        */
      213    12153                    %SCREAM( ERR#=%E$NOTKEYED_VY, MID="'F'" );
      214    12156    4               IF VY_ONLINE = 1/*@YES*/ THEN DO;
      215    12157    4                   CALL VYF$CLOSE( CURR$, TYPE, 2/*@SAVE*/ );
      216    12158    4                   GOTO TELL;
      217    12159    4                   END; /* Vy-online */
      218    12160    3               ELSE GOTO CHECK_MES;
      219    12161    3               END; /* If DCB.ORG */
      220    12162    2           END; /* Case */
      221    12163        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:15   
      222    12164    1       ACCT_VECTOR = F$O.ACCT_;
      223    12165    1       WORK$ = ACCT_VECTOR.P.POINTER;
      224    12166    1       WHERE$ = CURR$ -> VY$LST.P.NAME_.NAME$;
      225    12167    1       NCHARS = WHERE$ -> T$C.COUNT;
      226    12168    1       FILE_NAME = WHERE$ -> T$C.CHARS;
      227    12169    2       IF WORK$ ~= ADDR(NIL) THEN DO;
      228    12170    2           CALL INSERT( FILE_NAME, NCHARS, , '.', WORK$ -> F$ACCT_ );
      229    12171    2           CALL INDEX(NCHARS,' ',FILE_NAME);
      230    12172    2           END;
      231    12173    2       DO CASE( TYPE );
      232    12174    2       CASE( 0/*@OF*/, 2/*@LF*/, 3/*@SF*/ );
      233    12175    2           VY_OK.FILE.OFNAME.COUNT = NCHARS;
      234    12176    2           VY_OK.FILE.OFNAME.CHARS = FILE_NAME;
      235    12177    2       CASE( 1/*@RF*/ );
      236    12178    2           VY_OK.FILE.RFNAME.COUNT = NCHARS;
      237    12179    2           VY_OK.FILE.RFNAME.CHARS = FILE_NAME;
      238    12180    2           END;
      239    12181    1       RETURN;
      240    12182        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:16   
      241    12183    1   ERROR:;
      242    12184    1       ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/;
      243    12185    1       IF ERR = 100 THEN RETURN;
      244    12186    1       VY_FPT_ERRMSG.V.DCB# = DCB#;
      245    12187    2       IF ERR = 109 THEN DO;
      246    12188    3           IF VY_ONLINE = 1/*@YES*/ THEN DO; /*Online*/
      247    12189        /*E*  ERROR: VYF-E$FILEBUSY_VY-0
      248    12190              MESSAGE: %FN is busy. Do you wish to wait?
      249    12191              DESCRIPTION: Self-explanatory.
      250    12192        */
      251    12193                    %SCREAM( ERR#=%E$FILEBUSY_VY, MID="'F'" );
      252    12196    3               CALL VYY$YESNO( ANSWER );
      253    12197    4               IF ANSWER = 1/*@YES*/ THEN DO;
      254    12198    4                   CALL M$WAIT( FPT_WAIT );
      255    12199    4                   GOTO AGAIN;
      256    12200    4                   END; /* If/answer */
      257    12201    3               END; /* E$FILEBUSY - if/do */
      258    12202    3           ELSE DO; /*Batch - E$FILEBUSY/VY_ONLINE */
      259    12203        /*E*  ERROR: VYF-E$FILEBUSY_BATCH_VY-0
      260    12204              MESSAGE: %FN is busy.
      261    12205              DESCRIPTION: Self-explanatory.
      262    12206        */
      263    12207                    %SCREAM( ERR#=%E$FILEBUSY_BATCH_VY, MID="'F'" );
      264    12210    3               GOTO CHECK_MES;
      265    12211    3               END; /* Else - batch */
      266    12212    2           END;
      267    12213        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:17   
      268    12214         /* Here for file does not exist checking */
      269    12215    2       IF ERR = 113 THEN DO;
      270    12216    3           IF ( CURR$->VY$LST.P.ACCT_ ~= VECTOR (NIL) ) THEN DO;
      271    12217         /* Here => file does not exist */
      272    12218
      273    12219    3   NOFILE:
      274    12220
      275    12221        /*E*  ERROR: VYF-E$NOFILE_VY-0
      276    12222              MESSAGE: File %FN does not exist in DP#%SN.%AC.
      277    12223              DESCRIPTION: Object file does not exist; attempt to obtain correct
      278    12224                           file name if online.
      279    12225        */
      280    12226                    %SCREAM( ERR#=%E$NOFILE_VY, MID="'F'" );
      281    12229    3               GOTO TELL;
      282    12230    3               END;
      283    12231    3           IF (VY_OD_SEARCH) AND (SRCH_CURR$->VY$LLIST.LINK$~=ADDR(NIL)) THEN DO;
      284    12232    3               SRCH_CURR$ = SRCH_CURR$->VY$LLIST.LINK$;
      285    12233    3               ACCT_FID.TEXTFID_ = VECTOR (SRCH_CURR$->VY$LLIST.ITEM$->T$C.CHARS);
      286    12234    3               CALL M$FID (ACCT_FID) ALTRET (ACCT_FID_ERR);
      287    12235    3               IF AFR.ACCT THEN
      288    12236    3                   F$O.ACCT_ = ACCT_FID.ACCT_;
      289    12237    3               IF AFR.SN THEN
      290    12238    3                   F$O.SN_ = ACCT_FID.SN_;
      291    12239    3               GOTO OPEN_FILE;
      292    12240    3               END;
      293    12241    3           ELSE IF (VY_OD_SEARCH) THEN DO; /* File does not exist */
      294    12242         /*         VY_OD_SEARCH = '0'b;*/
      295    12243        /*E*  ERROR: VYF-E$NOSRCHFILE_VY-0
      296    12244              MESSAGE: File %U1 does not exist in any of the
      297    12245                       specified SRCH accounts.
      298    12246              DESCRIPTION: Self-explanatory.
      299    12247        */
      300    12248    3                   VY_EFIELD1.COUNT = CURR$->VY$LST.P.NAME_.NAME$->T$C.COUNT;
      301    12249    3                   VY_EFIELD1.CHARS = CURR$->VY$LST.P.NAME_.NAME$->T$C.CHARS;
      302    12250                        %SCREAM (ERR#=%E$NOSRCHFILE_VY, MID="'F'");
      303    12253    3                   END;
      304    12254    2               ELSE GOTO NOFILE;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:18   
      305    12255    2   TELL:   IF DEL THEN RETURN;
      306    12256    3           IF VY_ONLINE = 1/*@YES*/ THEN DO;
      307    12257         /* Set up for X$PARSE */
      308    12258    3               WKSZ = 256/4;
      309    12259    3               CALL VYP$PAR( 2, ADDR(VY_N_START_FID), WKSZ );
      310    12260    3               I = CURR$ -> VY$LST.TYPE;
      311    12261    3               J = CURR$ -> VY$LST.SUB_TYPE;
      312    12262    3               CALL VYS$LST( CURR$,
      313    12263    3                  VY_P_PCB_MAIN.OUT$ -> O$B.SUBLK$(0) -> O$B.SUBLK$(0),
      314    12264    3                  ADDR(NIL), I, J, -8 );
      315    12265    3               CALL VYF$FREE( 3/*@DS3*/, WKSZ, 1 );
      316    12266    3               GOTO AGAIN;
      317    12267    3               END; /* E$NOFILE - VY_ONLINE */
      318    12268    3           ELSE DO;
      319    12269    3   CHECK_MES:
      320    12270    4               IF VY_DO_PASS1 = 1/*@YES*/ THEN DO;
      321    12271    4                   VY_DO_PASS1 = 0/*@NO*/;
      322    12272        /*E*  ERROR: VYF-E$JUSTFILE_VY-0
      323    12273              MESSAGE: Processing continues only for file existence checking.
      324    12274              DESCRIPTION: Self-explanatory.
      325    12275        */
      326    12276                        %SCREAM(
      327    12277                        ERR#=%E$JUSTFILE_VY,
      328    12278                        LEVEL=%@E$I_VY,
      329    12279                        MID="'F'");
      330    12282    4                   END;
      331    12283    3               RETURN;
      332    12284    3               END;
      333    12285    2           END;
      334    12286    1       ELSE
      335    12287    2           IF ERR = 110 THEN DO;
      336    12288        /*E*  ERROR: VYF-E$ON_TO_EXISTS_VY-0
      337    12289              MESSAGE: 'ON/TO' illegal - file exists.
      338    12290              DESCRIPTION: Self-explanatory.
      339    12291        */
      340    12292                    %SCREAM(
      341    12293                    ERR#=%E$ON_TO_EXISTS_VY,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:19   
      342    12294                    MID="'F'",
      343    12295                    LEVEL=%@E$S_VY);
      344    12298    2               ALTRETURN;
      345    12299    2               END;
      346    12300    2           ELSE DO;
      347    12301    2               CALL VYE$ERRMSG;
      348    12302                    %ERROR_IT;
      349    12305    2               END;
      350    12306    1   ACCT_FID_ERR:
      351    12307        /*E*  ERROR: VYF-E$SRCH_FID_ERR_VY-0
      352    12308              MESSAGE: Search account %U1 can not be processed correctly.
      353    12309                       SRCH syntax:
      354    12310                            SR[CH] ([psn].ac1 [,[psn].ac2] ...)
      355    12311                            where psn is the pack set name (DP#...) and,
      356    12312                                  ac is the account name (8 characters from the
      357    12313                                     ASCII 7-bit set).
      358    12314              DESCRIPTION: Self-explanatory.
      359    12315        */
      360    12316    1       VY_EFIELD1.COUNT = SRCH_CURR$->VY$LLIST.ITEM$->T$C.COUNT;
      361    12317    1       VY_EFIELD1.CHARS = SRCH_CURR$->VY$LLIST.ITEM$->T$C.CHARS;
      362    12318            %SCREAM (ERR#=%E$SRCH_FID_ERR_VY ,MID="'F'");
      363    12321            %ERROR_IT;
      364    12324    1   END VYF$OPEN;
      365    12325        %EOD;

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:20   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYF$OPEN.

   Procedure VYF$OPEN requires 503 words for executable code.
   Procedure VYF$OPEN requires 16 words of local(AUTO) storage.

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:21   

 Object Unit name= VYF$OPEN                                   File name= VYF$OPEN.:E05TOU
 UTS= JUL 30 '97 08:53:48.04 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none   244    364  VYF$OPEN
    2   DCB   even  none     0      0  M$OF
    3   DCB   even  none     0      0  M$RF
    4   DCB   even  none     0      0  M$LF
    5   DCB   even  none     0      0  M$SI
    6   DCB   even  none     0      0  M$LO
    7   DCB   even  none     0      0  M$DO
    8   DCB   even  none     0      0  M$EI
    9  RoData even  UTS      6      6  VYF$OPEN
   10   Proc  even  none   503    767  VYF$OPEN
   11  RoData even  none    75    113  VYF$OPEN

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
    10      0   yes    yes     yes      Std        4  VYF$OPEN

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      2  VY_EI_FPT_OPEN                     1     74  VY_O_FPT_OPEN
    1    166  VY_R_FPT_OPEN
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:22   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       5 VYD$B2C
         yes           Std       3 VYF$CLOSE
 yes     yes           Std       3 VYP$PAR
 yes     yes           Std       6 VYS$LST
         yes           Std       3 VYF$FREE
         yes           Std       1 VYE$ERRMSG
         yes           Std       1 VYY$YESNO
         yes           Std       4 VYE$ERROR
                       nStd      0 X66_AUTO_4
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET
                       nStd      0 X66_AALT
                       nStd      0 X66_AUNWIND

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  VY_FPT_ERRMSG                         VY_P_PCB_MAIN
     VY_OK                                 B$TCB$                                VY_OD_SEARCH
     VY_SRCH_LST$                          VY_COMMAND                            VY_DO_PASS1
     VY_ERRORS                             VY_ONLINE                             VY_EFIELD1
     VY_UNWIND                             VY_PAR_UNWIND                         M$OF$
     M$LF$                                 M$OF                                  M$RF
     M$LF                                  M$SI                                  M$LO
     M$DO                                  M$EI                                  VY_N_START_FID
     B_VECTNIL
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:23   

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:24   


        1        1        /*M* VYF$OPEN - M$OPEN interface for LEMUR */
        2        2        /*T***********************************************************/
        3        3        /*T*                                                         */
        4        4        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
        5        5        /*T*                                                         */
        6        6        /*T***********************************************************/
        7        7        /*X* PLM=4,STI=0,IND=4,CTI=3,DCI=4,ECI=4,CSI=0,THI=0,DTI=0,ENI=4,
        8        8             CLM=0,SQB,NTB,MOC,CCI=3,NLB,MCL=0,EDMC*/
        9        9        VYF$OPEN:
       10       10            PROC( CURR_P$, TYPE, P_MODE, DEL ) ALTRET;

     10 10 000000   000000 700200 xent  VYF$OPEN     TSX0  ! X66_AUTO_4
        10 000001   000020 000004                    ZERO    16,4

       11       11        %INCLUDE VY_INC_C;
       12     9187        %VY$NODE;

              9199    1   /*******************************************************************************
              9200    1   *                                                                              *
              9201    1   *                          VY$NODE                                                *
              9202    1   *                                                                              *
              9203    1   *******************************************************************************/

              9219    1   DCL 1 VY$NODE      ALIGNED    BASED,
              9220    1         2 SON$ PTR /*(ADDR(NIL))*/, /* Son pointer                      */
              9221    1         2 BROTHER$ PTR /*(ADDR(NIL))*/, /* Brother pointer              */
              9222    1         2 FATHER$ PTR /*(ADDR(NIL))*/, /* Father pointer                */
              9223    1         2 PATH$ PTR /*(ADDR(NIL))*/, /* Path   pointer                  */
              9224    1         2 HEAD$       PTR /*(ADDR(NIL))*/, /* Head pointer to
              9225                              to list of file nodes for this node            */
              9226    1         2 TAIL$ PTR /*(ADDR(NIL))*/, /* Tail pointer to list            */
              9227    1         2 SHARED_LIB_HEAD$ PTR /*(ADDR(NIL))*/,
              9227                  /* Head pointer to shared library list */
              9228    1         2 LIB_HEAD$         PTR /*(ADDR(NIL))*/,
              9228                  /* Head pointer to list of shared libraries
              9229                                          which have been mapped to included libraries */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:25   
              9230    1         2 NUM          UBIN(36)  UNAL,    /* Node number                        */
              9231    1         2 DEPTH          UBIN(36)  UNAL,  /* Depth; ROOT=0*/
              9232    1         2 ADDR_START_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array            */
              9233    1         2 ADDR_START REDEF  ADDR_START_A,
              9234    1           3 RDATA       SBIN WORD,   /* First address for this node in data     */
              9235    1           3 RPROC       SBIN WORD,   /* First address for this node in proc     */
              9236    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9237    1         2 ADDR_STOP_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array            */
              9238    1         2 ADDR_STOP  REDEF  ADDR_STOP_A,
              9239    1           3 RDATA       SBIN WORD,        /* Last address for this node in data */
              9240    1           3 RPROC       SBIN WORD,        /* Last address for this node in proc */
              9241    1           3 ROS       SBIN WORD,          /* Last address for program in ros    */
              9242    1         2 START_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(0*3)*/, /* Array           */
              9243    1         2 START_PAGE# REDEF START_PAGE#_A,
              9244    1           3 RDATA       SBIN WORD,   /* First page    for this node in data     */
              9245    1           3 RPROC       SBIN WORD,   /* First page    for this node in proc     */
              9246    1           3 ROS       SBIN WORD,          /* First page   for program in ros    */
              9247    1         2 STOP_PAGE#_A(0:2/*@ROS*/) SBIN WORD /*(-1*3)*/, /* Array*/
              9248    1         2 STOP_PAGE#  REDEF STOP_PAGE#_A,
              9249    1           3 RDATA       SBIN WORD,   /* Last  page    for this node in data     */
              9250    1           3 RPROC       SBIN WORD,   /* Last  page    for this node in proc     */
              9251    1           3 ROS       SBIN WORD,          /* Last  page   for program in ros    */
              9252    1         2 START_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9252                  /* Starting pointer for common sections for this node */
              9253    1         2 STOP_SC_ALL$ PTR /*(ADDR(NIL))*/,
              9253                  /* Stopping pointer for common sections for this node */
              9254    1         2 L_START,
              9255    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9256    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9257    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9258    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9259    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9260    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9261    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9262    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9263    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9264    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:26   
              9265    1         2 L_START_A$(0:9)     REDEF L_START PTR,
              9266    1         2 L_STOP,
              9267    1           3 SN$ PTR /*(ADDR(NIL))*/, /* Segment definition names        */
              9268    1           3 DN$ PTR /*(ADDR(NIL))*/, /* Def names                       */
              9269    1           3 RN$ PTR /*(ADDR(NIL))*/, /* Ref names                       */
              9270    1           3 SC$ PTR /*(ADDR(NIL))*/, /* Sections                        */
              9271    1           3 ED$ PTR /*(ADDR(NIL))*/, /* Entry defs*/
              9272    1           3 ER$ PTR /*(ADDR(NIL))*/, /* Entry refs*/
              9273    1           3 DD$ PTR /*(ADDR(NIL))*/, /* Data defs                       */
              9274    1           3 DR$ PTR /*(ADDR(NIL))*/, /* Data refs                       */
              9275    1           3 SD$ PTR /*(ADDR(NIL))*/, /* Seg defs                        */
              9276    1           3 SR$ PTR /*(ADDR(NIL))*/, /* Seg refs                        */
              9277    1         2 L_STOP_A$(0:9) REDEF   L_STOP    PTR,
              9278    1         2 L_SIZE,
              9279    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9280    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9281    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9282    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9283    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9284    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9285    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9286    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9287    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9288    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9289    1         2 L_SIZE_A(0:9)  REDEF   L_SIZE    UBIN,
              9290    1         2 L_PREV_SIZE,
              9291    1           3 SN      UBIN /*(0)*/, /* Segment definition names           */
              9292    1           3 DN      UBIN /*(0)*/, /* Def names                          */
              9293    1           3 RN      UBIN /*(0)*/, /* Ref names                          */
              9294    1           3 SC      UBIN /*(0)*/, /* Sections                           */
              9295    1           3 ED      UBIN /*(0)*/, /* Entry defs*/
              9296    1           3 ER      UBIN /*(0)*/, /* Entry refs*/
              9297    1           3 DD      UBIN /*(0)*/, /* Data defs                          */
              9298    1           3 DR      UBIN /*(0)*/, /* Data refs                          */
              9299    1           3 SD      UBIN /*(0)*/, /* Seg defs                           */
              9300    1           3 SR      UBIN /*(0)*/, /* Seg refs                           */
              9301    1         2 L_PREV_SIZE_A(0:9)  REDEF   L_PREV_SIZE    UBIN,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:27   
              9302    1         2 BIT_MAP                ALIGNED,
              9303    1           3 DATA                  ALIGNED,
              9304    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9305    1           3 RPROC                 ALIGNED,
              9306    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9307    1           3 ROS                   ALIGNED,
              9308    1             4 BITS(0:255)          BIT(1)    UNAL /*('0'B*256)*/,
              9309    1         2 L_SC_START,
              9310    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9311    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9312    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9313    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9314    1         2 L_SC_START_A$(0:3)  REDEF L_SC_START PTR,
              9315    1         2 L_SC_STOP,
              9316    1           3 SC_BLK_COM$ PTR /*(ADDR(NIL))*/, /* Blank common            */
              9317    1           3 SC_ROOT_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Root labelled common */
              9318    1           3 SC_LBL_COM$ PTR /*(ADDR(NIL))*/, /* Labelled common         */
              9319    1           3 SC_DCB$ PTR /*(ADDR(NIL))*/, /* Dcbs                        */
              9320    1         2 L_SC_STOP_A$(0:3)   REDEF L_SC_STOP  PTR,
              9321    1         2 PROMOTE_HEAD,
              9322    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9323    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9324    1         2 PROMOTE_HEAD_A$(0:1) REDEF PROMOTE_HEAD     PTR,
              9325    1         2 PROMOTE_TAIL,
              9326    1           3 BLK_COM$              PTR /*(ADDR(NIL))*/,
              9327    1           3 LBL_COM$              PTR /*(ADDR(NIL))*/,
              9328    1         2 PROMOTE_TAIL_A$(0:1) REDEF PROMOTE_TAIL     PTR,
              9329    1         2 HAVE_ASL          BIT(1)    UNAL /*('0'B)*/,
              9330    1         2 ALL_BLK_COM          BIT(1)    UNAL /*('0'B)*/,
              9331    1         2 *                 BIT(34)   UNAL /*('0'B)*/,
              9332    1         2 BLANK_COMMON$     PTR       ALIGNED /*(ADDR(NIL))*/;

       13     9336        %VY$LST;

              9348    1   /*******************************************************************************
              9349    1   *                                                                              *
              9350    1   *                          VY$LST                                                 *
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:28   
              9351    1   *                                                                              *
              9352    1   *******************************************************************************/

              9357    1   DCL 1 VY$LST                        ALIGNED BASED,
              9358    1         2 LINK$        PTR,               /* Link to next item                  */
              9359    1         2 TYPE         UBIN( 18) UNAL,    /* Type                               */
              9360    1         2 SUB_TYPE     UBIN( 18) UNAL,    /* Sub-type                           */
              9361    1         2 OBJECT_NAME$ PTR,               /* Pointer to object unit name        */
              9362    1         2 SC_HEAD$     PTR,               /* Head pointer to section link list  */
              9363    1         2 SC_TAIL$     PTR,               /* Tail pointer to section link list  */
              9364    1         2 P,
              9365    1           3 NAME_       ALIGNED,
              9366    1             4 BOUND      UBIN(20)  UNAL,
              9367    1             4 FLAGSV     UBIN(11)  UNAL,
              9368    1             4 *          BIT(5)    UNAL,
              9369    1             4 NAME$      PTR,
              9370    1           3 ACCT_       ALIGNED,
              9371    1             4 BOUND      UBIN(20)  UNAL,
              9372    1             4 FLAGSV     UBIN(11)  UNAL,
              9373    1             4 *          BIT(5)    UNAL,
              9374    1             4 ACCT$      PTR,
              9375    1           3 PASS_       ALIGNED,
              9376    1             4 BOUND      UBIN(20)  UNAL,
              9377    1             4 FLAGSV     UBIN(11)  UNAL,
              9378    1             4 *          BIT(5)    UNAL,
              9379    1             4 PASS$      PTR,
              9380    1           3 SN_         ALIGNED,
              9381    1             4 BOUND      UBIN(20)  UNAL,
              9382    1             4 FLAGSV     UBIN(11)  UNAL,
              9383    1             4 *          BIT(5)    UNAL,
              9384    1             4 SN$        PTR,
              9385    1           3 WSN_        ALIGNED,
              9386    1             4 BOUND      UBIN(20)  UNAL,
              9387    1             4 FLAGSV     UBIN(11)  UNAL,
              9388    1             4 *          BIT(5)    UNAL,
              9389    1             4 WSN$       PTR,
              9390    1           3 B           ALIGNED,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:29   
              9391    1             4 RES        BIT(1)    UNAL,
              9392    1             4 ASN        BIT(1)    UNAL,
              9393    1             4 *          BIT(34)   UNAL,
              9394    1           3 RES         CHAR(4)   ALIGNED,
              9395    1           3 ASN         UBIN(36)  ALIGNED;
       14     9398        %VY$LLIST;

              9410    1   /*******************************************************************************
              9411    1   *                                                                              *
              9412    1   *                          VY$LLIST                                               *
              9413    1   *                                                                              *
              9414    1   *******************************************************************************/

              9419    1   DCL 1 VY$LLIST                BASED     ALIGNED,
              9420    1         2 LINK$                  PTR  ALIGNED,
              9421    1         2 ITEM$                  PTR  ALIGNED;
       15     9424        %T$C;

              9436    1   /*******************************************************************************
              9437    1   *                                                                              *
              9438    1   *                          T$C                                                 *
              9439    1   *                                                                              *
              9440    1   *******************************************************************************/

              9445    1   DCL 1 T$C           BASED     ALIGNED,  /* Text count                         */
              9446    1         2 COUNT        UBIN( 9) UNAL,
              9447    1         2 CHARS        CHAR( T$C.COUNT )   UNAL;
              9448    1   DCL 1 T$C_UNAL      BASED     UNAL,     /* Text count                         */
              9449    1         2 COUNT        UBIN( 9) UNAL,
              9450    1         2 CHARS        CHAR( T$C_UNAL.COUNT ) UNAL;
       16     9453        %VECTOR( NAME=ACCT_VECTOR, STCLASS=STATIC );

              9466    1   /*******************************************************************************
              9467    1   *                                                                              *
              9468    1   *                          TEMPLATE FOR 2-WORD NSA VECTOR                         *
              9469    1   *                                                                              *
              9470    1   *******************************************************************************/
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:30   

              9475    1   DCL 1 ACCT_VECTOR STATIC ALIGNED,
              9476    1         2 VSIZE UBIN(20) UNAL,      /* Size field of vector               */
              9477    1         2 FLAGS BIT(9) UNAL,        /* FLAGS...                           */
              9478    1         2 V BIT(2) UNAL,            /* Vector type field                  */
              9479    1         2 Z5 BIT(5) UNAL,           /* Unused                             */
              9480    1         2 F,
              9481    1           3 BASE UBIN(20) UNAL,     /* Base for vector                    */
              9482    1           3 Z4 BIT(4) UNAL,         /* Unused                             */
              9483    1           3 SEGID UBIN(12) UNAL,    /* Segid                              */
              9484    1         2 P       REDEF     F,            /* To extract the pointer             */
              9485    1           3 POINTER          PTR UNAL;
       17     9488        %PLIST;
       18     9489        %F$DCB;
       19     9546        %PARSE$OUT( NAME=O$B, STCLASS="BASED");
       20     9591        %INCLUDE VY_PSUBS_C;
       21     9652        %B$TCB;
       22     9655        %B$ALT;
       23     9663        %FILE;
       24     9672        %INCLUDE B_ERRORS_C;
       25    10799    1   DCL M$OF DCB;
       26    10800    1   DCL M$RF DCB;
       27    10801    1   DCL M$LF DCB;
       28    10802    1   DCL M$SI DCB;
       29    10803    1   DCL M$LO DCB;
       30    10804    1   DCL M$DO DCB;
       31    10805    1   DCL M$EI DCB;
       32    10806        %FPT_OPEN( FPTN=VY_EI_FPT_OPEN,
       33    10807         DCB=M$EI,
       34    10808         ASN=FILE,
       35    10809         ORG=KEYED,
       36    10810         ACS=SEQUEN,
       37    10811         FUN=IN,
       38    10812         SCRUB=YES,
       39    10813         STCLASS="STATIC SYMDEF");
       40    10922        %FPT_OPEN( FPTN=VY_O_FPT_OPEN,
       41    10923         DCB=M$OF,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:31   
       42    10924         ASN=FILE,
       43    10925         ORG=KEYED,
       44    10926         ACS=DIRECT,
       45    10927         FUN=IN,
       46    10928         SCRUB=YES,
       47    10929         STCLASS="STATIC SYMDEF");
       48    11038        %FPT_OPEN( FPTN=VY_R_FPT_OPEN,
       49    11039         DCB=M$RF,
       50    11040         ASN=FILE,
       51    11041         ORG=KEYED,
       52    11042         ACS=DIRECT,
       53    11043         LSLIDE=10,
       54    11044         STCLASS="STATIC SYMDEF");
       55    11153        %FPT_FID (FPTN=ACCT_FID,
       56    11154         ACCT = ACCT_NAME,
       57    11155         SN = SN_NAME,
       58    11156         ASN = F.ASN,
       59    11157         RES = F.RES,
       60    11158         RESULTS = AFR);
       61    11181        %VLP_ACCT (FPTN = ACCT_NAME);
       62    11194        %VLP_SN (FPTN = SN_NAME,N=1);
       63    11207        %VLR_FID (FPTN = AFR);
       64    11226    1   DCL 1 F ALIGNED STATIC,
       65    11227    1         2 ASN UBIN(9) ALIGNED,
       66    11228    1         2 RES CHAR(4) ALIGNED;
       67    11229        %FPT_OPEN( FPTN=F$O, STCLASS="BASED(FPT$)");
       68    11338        %E;

             11346    1   /*******************************************************************************
             11347    1   *                                                                              *
             11348    1   *                          ENTRY                                                 *
             11349    1   *                                                                              *
             11350    1   *******************************************************************************/

       69    11354        %ENTRIES;
       70    11369    1   DCL VYF$CLOSE ENTRY(3);
       71    11370    1   DCL VYP$PAR ENTRY(3) ALTRET;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:32   
       72    11371    1   DCL VYS$LST ENTRY(6) ALTRET;
       73    11372        %U;

             11380    1   /*******************************************************************************
             11381    1   *                                                                              *
             11382    1   *                          UBIN                                                 *
             11383    1   *                                                                              *
             11384    1   *******************************************************************************/

       74    11388        %INDEX;
       75    11398    1   DCL ANSWER UBIN(36) ALIGNED STATIC/*AUTO*/;
       76    11399    1   DCL ERR UBIN(36) ALIGNED STATIC/*AUTO*/;
       77    11400    1   DCL NCHARS UBIN(36) ALIGNED STATIC/*AUTO*/;
       78    11401    1   DCL WKSZ UBIN(36) ALIGNED STATIC/*AUTO*/;
       79    11402    1   DCL MODE UBIN(36);
       80    11403    1   DCL EX UBIN(36) ALIGNED STATIC/*AUTO*/;
       81    11404    1   DCL DCB# UBIN(36) ALIGNED STATIC/*AUTO*/;
       82    11405        %P;

             11413    1   /*******************************************************************************
             11414    1   *                                                                              *
             11415    1   *                          PARAMETERS                                             *
             11416    1   *                                                                              *
             11417    1   *******************************************************************************/

       83    11421    1   DCL CURR_P$ PTR;
       84    11422    1   DCL TYPE UBIN(36);
       85    11423    1   DCL P_MODE UBIN(36);
       86    11424    1   DCL DEL BIT(1) ALIGNED;
       87    11425        %PTR;

             11433    1   /*******************************************************************************
             11434    1   *                                                                              *
             11435    1   *                          PTR                                                 *
             11436    1   *                                                                              *
             11437    1   *******************************************************************************/

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:33   
       88    11441    1   DCL WORK$ PTR ALIGNED STATIC/*AUTO*/;
       89    11442    1   DCL WHERE$ PTR ALIGNED STATIC/*AUTO*/;
       90    11443    1   DCL CURR$ PTR ALIGNED STATIC/*AUTO*/;
       91    11444    1   DCL DCB$ PTR ALIGNED STATIC/*AUTO*/;
       92    11445    1   DCL FPT$ PTR ALIGNED STATIC/*AUTO*/;
       93    11446    1   DCL SRCH_CURR$ PTR ALIGNED STATIC/*AUTO*/;
       94    11447    1   DCL VY_N_START_FID UBIN(36) ALIGNED SYMREF;
       95    11448        %C;

             11456    1   /*******************************************************************************
             11457    1   *                                                                              *
             11458    1   *                          CHAR                                                 *
             11459    1   *                                                                              *
             11460    1   *******************************************************************************/

       96    11464    1   DCL FILE_NAME CHAR(40) STATIC;
       97    11465
       98    11466
       99    11467        %FPT_WAIT(
      100    11468         FPTN=FPT_WAIT,
      101    11469         STCLASS=CONSTANT,
      102    11470         UNITS=60);
      103    11484        %INCLUDE CP_6_SUBS;
      104    12024        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:34   
      105    12025    2       DO CASE(TYPE);

  12025 10 000002   200004 470500                    LDP0    @TYPE,,AUTO
        10 000003   000000 235100                    LDA     0,,PR0
        10 000004   000004 115007                    CMPA    4,DL
        10 000005   000007 602005 10                 TNC     s:12025+5,AL
        10 000006   000046 710000 10                 TRA     s:12054
        10 000007   000013 710000 10                 TRA     s:12027
        10 000010   000020 710000 10                 TRA     s:12030
        10 000011   000034 710000 10                 TRA     s:12037
        10 000012   000041 710000 10                 TRA     s:12040

      106    12026    2       CASE( 0/*@OF*/ );

      107    12027    2           FPT$ = ADDR( VY_O_FPT_OPEN );

  12027 10 000013   000000 236000 11                 LDQ     0
        10 000014   000350 756000 1                  STQ     FPT$

      108    12028    2           DCB# = DCBNUM( M$OF );

  12028 10 000015   000000 236007 xsym               LDQ     M$OF,DL
        10 000016   000343 756000 1                  STQ     DCB#
        10 000017   000065 710000 10                 TRA     s:12072

      109    12029    2       CASE( 1/*@RF*/ );

      110    12030    2           FPT$ = ADDR( VY_R_FPT_OPEN );

  12030 10 000020   000001 236000 11                 LDQ     1
        10 000021   000350 756000 1                  STQ     FPT$

      111    12031    2           DCB# = DCBNUM( M$RF );

  12031 10 000022   000000 236007 xsym               LDQ     M$RF,DL
        10 000023   000343 756000 1                  STQ     DCB#

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:35   
      112    12032    3           IF MODE = 3/*@CREATE*/ THEN DO;

  12032 10 000024   200007 235100                    LDA     MODE,,AUTO
        10 000025   000003 115007                    CMPA    3,DL
        10 000026   000065 601000 10                 TNZ     s:12072

      113    12033    3               VY_R_FPT_OPEN.V.XTNSIZE# = 10;

  12033 10 000027   000012 220003                    LDX0    10,DU
        10 000030   000242 440000 1                  SXL0    VY_R_FPT_OPEN+44

      114    12034    3               VY_R_FPT_OPEN.V.IXTNSIZE# = 10;

  12034 10 000031   000012 235007                    LDA     10,DL
        10 000032   000243 755000 1                  STA     VY_R_FPT_OPEN+45

      115    12035    3               END;

  12035 10 000033   000065 710000 10                 TRA     s:12072

      116    12036    2       CASE( 2/*@LF*/ );

      117    12037    2           FPT$ = ADDR( VY_O_FPT_OPEN );

  12037 10 000034   000000 236000 11                 LDQ     0
        10 000035   000350 756000 1                  STQ     FPT$

      118    12038    2           DCB# = DCBNUM( M$OF );

  12038 10 000036   000000 236007 xsym               LDQ     M$OF,DL
        10 000037   000343 756000 1                  STQ     DCB#
        10 000040   000065 710000 10                 TRA     s:12072

      119    12039    2       CASE( 3/*@SF*/ );

      120    12040    2           FPT$ = ADDR( VY_EI_FPT_OPEN );

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:36   
  12040 10 000041   000002 236000 11                 LDQ     2
        10 000042   000350 756000 1                  STQ     FPT$

      121    12041    2           DCB# = DCBNUM( M$EI );

  12041 10 000043   000000 236007 xsym               LDQ     M$EI,DL
        10 000044   000343 756000 1                  STQ     DCB#
        10 000045   000065 710000 10                 TRA     s:12072

      122    12042    2       CASE(ELSE);

      123    12043        /*E*  ERROR: VYF-E$INTERNAL_OPEN_TYPE_VY-0
      124    12044              MESSAGE: Internal link error. Bad type passed to VYF$OPEN: Type = %U1.
      125    12045              DESCRIPTION: Self-explanatory.
      126    12046        */
      127    12047                %NUMBER(
      128    12048                NUM1=TYPE, BASE1=10, SIZE1=12 );

  12054 10 000046   000003 236000 11                 LDQ     3
        10 000047   200014 756100                    STQ     MODE+5,,AUTO
        10 000050   200004 236100                    LDQ     @TYPE,,AUTO
        10 000051   000004 235000 11                 LDA     4
        10 000052   200012 757100                    STAQ    MODE+3,,AUTO
        10 000053   000006 237000 11                 LDAQ    6
        10 000054   200010 757100                    STAQ    MODE+1,,AUTO
        10 000055   200010 630500                    EPPR0   MODE+1,,AUTO
        10 000056   000023 631400 xsym               EPPR1   B_VECTNIL+19
        10 000057   000000 701000 xent               TSX1    VYD$B2C
        10 000060   000000 011000                    NOP     0

      129    12065                %SCREAM(
      130    12066                ERR#=%E$INTERNAL_OPEN_TYPE_VY,
      131    12067                LEVEL=%@E$F_VY,
      132    12068                MID="'F'");

  12069 10 000061   000012 630400 11                 EPPR0   10
        10 000062   000022 631400 xsym               EPPR1   B_VECTNIL+18
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:37   
        10 000063   000000 701000 xent               TSX1    VYE$ERROR
        10 000064   000000 011000                    NOP     0

      133    12071    2           END;

      134    12072    2       IF DEL THEN DO;

  12072 10 000065   200006 470500                    LDP0    @DEL,,AUTO
        10 000066   000000 234100                    SZN     0,,PR0
        10 000067   000074 605000 10                 TPL     s:12077

      135    12073    2           MODE = 2;

  12073 10 000070   000002 235007                    LDA     2,DL
        10 000071   200007 755100                    STA     MODE,,AUTO

      136    12074    2           EX = 2;

  12074 10 000072   000342 755000 1                  STA     EX

      137    12075    2           END;

  12075 10 000073   000134 710000 10                 TRA     AGAIN

      138    12076    2       ELSE DO;

      139    12077    3           DO CASE( P_MODE );

  12077 10 000074   200005 471500                    LDP1    @P_MODE,,AUTO
        10 000075   100000 235100                    LDA     0,,PR1
        10 000076   000005 115007                    CMPA    5,DL
        10 000077   000101 602005 10                 TNC     s:12077+5,AL
        10 000100   000134 710000 10                 TRA     AGAIN
        10 000101   000106 710000 10                 TRA     s:12079
        10 000102   000112 710000 10                 TRA     s:12082
        10 000103   000117 710000 10                 TRA     s:12086
        10 000104   000117 710000 10                 TRA     s:12086
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:38   
        10 000105   000131 710000 10                 TRA     s:12091

      140    12078    3           CASE(0);

      141    12079    3               MODE = 2;

  12079 10 000106   000002 236007                    LDQ     2,DL
        10 000107   200007 756100                    STQ     MODE,,AUTO

      142    12080    3               EX = 2;

  12080 10 000110   000342 756000 1                  STQ     EX
        10 000111   000134 710000 10                 TRA     AGAIN

      143    12081    3           CASE( 1/*@C_ON_KEY_WORD*/ );

      144    12082    3               MODE = 3;

  12082 10 000112   000003 236007                    LDQ     3,DL
        10 000113   200007 756100                    STQ     MODE,,AUTO

      145    12083    3               EX = 1;

  12083 10 000114   000001 235007                    LDA     1,DL
        10 000115   000342 755000 1                  STA     EX
        10 000116   000134 710000 10                 TRA     AGAIN

      146    12084    3           CASE( 2/*@C_ADDTO_KEY_WORD*/,

      147    12085    3                  3/*@C_INTO_KEY_WORD*/ );
      148    12086    3               MODE = 3;

  12086 10 000117   000003 236007                    LDQ     3,DL
        10 000120   200007 756100                    STQ     MODE,,AUTO

      149    12087    3               IF VY_COMMAND = 5/*@C_DELETE_KEY_WORD*/

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:39   
  12087 10 000121   000000 235000 xsym               LDA     VY_COMMAND
        10 000122   000005 115007                    CMPA    5,DL
        10 000123   000126 601000 10                 TNZ     s:12089

      150    12088    3               THEN MODE = 1;

  12088 10 000124   000001 235007                    LDA     1,DL
        10 000125   200007 755100                    STA     MODE,,AUTO

      151    12089    3               EX = 2;

  12089 10 000126   000002 235007                    LDA     2,DL
        10 000127   000342 755000 1                  STA     EX
        10 000130   000134 710000 10                 TRA     AGAIN

      152    12090    3           CASE( 4/*@C_OVER_KEY_WORD*/ );

      153    12091    3               MODE = 3;

  12091 10 000131   000003 236007                    LDQ     3,DL
        10 000132   200007 756100                    STQ     MODE,,AUTO

      154    12092    3               EX = 3;

  12092 10 000133   000342 756000 1                  STQ     EX

      155    12093    3               END; /* Do case( P_MODE ); */

      156    12094    2           END; /* Else do; */

      157    12095    1   AGAIN:
      158    12096    1       F$O.V.DELETE# = DEL;

  12096 10 000134   000350 470400 1     AGAIN        LDP0    FPT$
        10 000135   200006 471500                    LDP1    @DEL,,AUTO
        10 000136   100000 236100                    LDQ     0,,PR1
        10 000137   000025 772000                    QRL     21
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:40   
        10 000140   000044 676100                    ERQ     36,,PR0
        10 000141   040000 376007                    ANQ     16384,DL
        10 000142   000044 656100                    ERSQ    36,,PR0

      159    12097    1       F$O.V.FUN# = MODE;

  12097 10 000143   200007 236100                    LDQ     MODE,,AUTO
        10 000144   000011 736000                    QLS     9
        10 000145   000045 552110                    STBQ    37,'10'O,PR0

      160    12098    1       F$O.V.EXIST# = EX;

  12098 10 000146   000342 236000 1                  LDQ     EX
        10 000147   000007 736000                    QLS     7
        10 000150   000044 676100                    ERQ     36,,PR0
        10 000151   000600 376007                    ANQ     384,DL
        10 000152   000044 656100                    ERSQ    36,,PR0

      161    12099    1       F$O.V.ORG# = 2/*@KEYED*/;

  12099 10 000153   002000 236007                    LDQ     1024,DL
        10 000154   000046 552110                    STBQ    38,'10'O,PR0

      162    12100    1       F$O.V.ACS# = 2/*@DIRECT*/;

  12100 10 000155   000002 236007                    LDQ     2,DL
        10 000156   000046 552104                    STBQ    38,'04'O,PR0

      163    12101    1       F$O.V.SPARE# = 50;

  12101 10 000157   000062 220003                    LDX0    50,DU
        10 000160   000054 740100                    STX0    44,,PR0

      164    12102    1       F$O.V.INITZ.SCRUB# = '1'B/*@YES_B*/;

  12102 10 000161   400000 236007                    LDQ     -131072,DL
        10 000162   000044 256100                    ORSQ    36,,PR0
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:41   

      165    12103    1       CURR$ = CURR_P$;

  12103 10 000163   200003 473500                    LDP3    @CURR_P$,,AUTO
        10 000164   300000 236100                    LDQ     0,,PR3
        10 000165   000346 756000 1                  STQ     CURR$

      166    12104    1       F$O.NAME_ = CURR$ -> VY$LST.P.NAME_;

  12104 10 000166   000346 474400 1                  LDP4    CURR$
        10 000167   000100 100500                    MLR     fill='000'O
        10 000170   400005 000010                    ADSC9   5,,PR4                   cn=0,n=8
        10 000171   000006 000010                    ADSC9   6,,PR0                   cn=0,n=8

      167    12105    1       F$O.ACCT_ = CURR$ -> VY$LST.P.ACCT_;

  12105 10 000172   000346 474400 1                  LDP4    CURR$
        10 000173   000100 100500                    MLR     fill='000'O
        10 000174   400007 000010                    ADSC9   7,,PR4                   cn=0,n=8
        10 000175   000024 000010                    ADSC9   20,,PR0                  cn=0,n=8

      168    12106    1       F$O.PASS_ = CURR$ -> VY$LST.P.PASS_;

  12106 10 000176   000346 474400 1                  LDP4    CURR$
        10 000177   000100 100500                    MLR     fill='000'O
        10 000200   400011 000010                    ADSC9   9,,PR4                   cn=0,n=8
        10 000201   000010 000010                    ADSC9   8,,PR0                   cn=0,n=8

      169    12107    1       F$O.SN_ = CURR$ -> VY$LST.P.SN_;

  12107 10 000202   000346 474400 1                  LDP4    CURR$
        10 000203   000100 100500                    MLR     fill='000'O
        10 000204   400013 000010                    ADSC9   11,,PR4                  cn=0,n=8
        10 000205   000002 000010                    ADSC9   2,,PR0                   cn=0,n=8

      170    12108    1       F$O.WSN_ = CURR$ -> VY$LST.P.WSN_;

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:42   
  12108 10 000206   000346 474400 1                  LDP4    CURR$
        10 000207   000100 100500                    MLR     fill='000'O
        10 000210   400015 000010                    ADSC9   13,,PR4                  cn=0,n=8
        10 000211   000032 000010                    ADSC9   26,,PR0                  cn=0,n=8

      171    12109    2       IF TYPE = 0 AND VY_OD_SEARCH AND CURR$->VY$LST.P.ACCT_ = VECTOR (NIL) THEN DO;

  12109 10 000212   200004 474500                    LDP4    @TYPE,,AUTO
        10 000213   400000 235100                    LDA     0,,PR4
        10 000214   000260 601000 10                 TNZ     s:12118
        10 000215   000000 234000 xsym               SZN     VY_OD_SEARCH
        10 000216   000260 605000 10                 TPL     s:12118
        10 000217   000346 475400 1                  LDP5    CURR$
        10 000220   000000 106500                    CMPC    fill='000'O
        10 000221   500007 000010                    ADSC9   7,,PR5                   cn=0,n=8
        10 000222   000016 000010 11                 ADSC9   14                       cn=0,n=8
        10 000223   000260 601000 10                 TNZ     s:12118

      172    12110    2           SRCH_CURR$ = VY_SRCH_LST$;

  12110 10 000224   000000 236000 xsym               LDQ     VY_SRCH_LST$
        10 000225   000351 756000 1                  STQ     SRCH_CURR$

      173    12111    2           ACCT_FID.TEXTFID_ = VECTOR (SRCH_CURR$->VY$LLIST.ITEM$->T$C.CHARS);

  12111 10 000226   000351 476400 1                  LDP6    SRCH_CURR$
        10 000227   600001 477500                    LDP7    1,,PR6
        10 000230   700000 236100                    LDQ     0,,PR7
        10 000231   000033 772000                    QRL     27
        10 000232   000064 737000                    LLS     52
        10 000233   000140 135007                    SBLA    96,DL
        10 000234   200010 457500                    STP7    MODE+1,,AUTO
        10 000235   200010 236100                    LDQ     MODE+1,,AUTO
        10 000236   200000 036007                    ADLQ    65536,DL
        10 000237   000262 757000 1                  STAQ    ACCT_FID+2

      174    12112    2           CALL M$FID (ACCT_FID) ALTRET (ACCT_FID_ERR);
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:43   

  12112 10 000240   000260 630400 1                  EPPR0   ACCT_FID
        10 000241   420001 713400                    CLIMB   alt,+8193
        10 000242   404400 401760                    pmme    nvectors=10
        10 000243   000746 702000 10                 TSX2    ACCT_FID_ERR

      175    12113    2           IF AFR.ACCT THEN

  12113 10 000244   000316 236000 1                  LDQ     AFR
        10 000245   200000 316003                    CANQ    65536,DU
        10 000246   000252 600000 10                 TZE     s:12115

      176    12114    2               F$O.ACCT_ = ACCT_FID.ACCT_;

  12114 10 000247   000266 237000 1                  LDAQ    ACCT_FID+6
        10 000250   000350 470400 1                  LDP0    FPT$
        10 000251   000024 757100                    STAQ    20,,PR0

      177    12115    2           IF AFR.SN THEN

  12115 10 000252   000316 236000 1                  LDQ     AFR
        10 000253   040000 316003                    CANQ    16384,DU
        10 000254   000260 600000 10                 TZE     s:12118

      178    12116    2               F$O.SN_ = ACCT_FID.SN_;

  12116 10 000255   000272 237000 1                  LDAQ    ACCT_FID+10
        10 000256   000350 470400 1                  LDP0    FPT$
        10 000257   000002 757100                    STAQ    2,,PR0

      179    12117    2           END;

      180    12118    1       IF CURR$ -> VY$LST.P.B.ASN THEN F$O.V.ASN# = CURR$ -> VY$LST.P.ASN;

  12118 10 000260   000346 470400 1                  LDP0    CURR$
        10 000261   000017 236100                    LDQ     15,,PR0
        10 000262   200000 316003                    CANQ    65536,DU
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:44   
        10 000263   000270 600000 10                 TZE     s:12119

  12118 10 000264   000350 471400 1                  LDP1    FPT$
        10 000265   000021 236100                    LDQ     17,,PR0
        10 000266   100045 552104                    STBQ    37,'04'O,PR1
        10 000267   000273 710000 10                 TRA     s:12120

      181    12119    1       ELSE F$O.V.ASN# = 0;

  12119 10 000270   000350 471400 1                  LDP1    FPT$
        10 000271   000000 236003                    LDQ     0,DU
        10 000272   100045 552104                    STBQ    37,'04'O,PR1

      182    12120    1       IF CURR$ -> VY$LST.P.B.RES THEN F$O.V.RES# = CURR$ -> VY$LST.P.RES;

  12120 10 000273   000346 470400 1                  LDP0    CURR$
        10 000274   000017 234100                    SZN     15,,PR0
        10 000275   000301 605000 10                 TPL     s:12121

  12120 10 000276   000020 236100                    LDQ     16,,PR0
        10 000277   100050 756100                    STQ     40,,PR1
        10 000300   000303 710000 10                 TRA     OPEN_FILE

      183    12121    1       ELSE F$O.V.RES# = BINASC(0);

  12121 10 000301   000020 236000 11                 LDQ     16
        10 000302   100050 756100                    STQ     40,,PR1

      184    12122    1   OPEN_FILE:
      185    12123
      186    12124    1       CALL M$OPEN( F$O ) ALTRET(ERROR);

  12124 10 000303   000350 470400 1     OPEN_FILE    LDP0    FPT$
        10 000304   450000 713400                    CLIMB   alt,open
        10 000305   410400 401760                    pmme    nvectors=18
        10 000306   000472 702000 10                 TSX2    ERROR

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:45   
      187    12125    1       IF (CURR$->VY$LST.LINK$ = ADDR(NIL)) AND (TYPE = 0 /*@OF*/) THEN

  12125 10 000307   000346 470400 1                  LDP0    CURR$
        10 000310   000000 236100                    LDQ     0,,PR0
        10 000311   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000312   000317 601000 10                 TNZ     s:12127
        10 000313   200004 471500                    LDP1    @TYPE,,AUTO
        10 000314   100000 235100                    LDA     0,,PR1
        10 000315   000317 601000 10                 TNZ     s:12127

      188    12126    1           VY_OD_SEARCH = '0'B;

  12126 10 000316   000000 450000 xsym               STZ     VY_OD_SEARCH

      189    12127    2       IF DEL THEN DO;

  12127 10 000317   200006 471500                    LDP1    @DEL,,AUTO
        10 000320   100000 234100                    SZN     0,,PR1
        10 000321   000331 605000 10                 TPL     s:12140

      190    12128        /*E*  ERROR: VYF-E$FILE_DELETED_VY-0
      191    12129              MESSAGE: ... File %FN deleted.
      192    12130              DESCRIPTION: Self-explanatory.
      193    12131        */
      194    12132    2           VY_FPT_ERRMSG.V.DCB# = DCB#;

  12132 10 000322   000343 720000 1                  LXL0    DCB#
        10 000323   000026 740000 xsym               STX0    VY_FPT_ERRMSG+22

      195    12133                %SCREAM( ERR#=%E$FILE_DELETED_VY, MID="'F'", LEVEL=0 );

  12134 10 000324   000022 630400 11                 EPPR0   18
        10 000325   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000326   000000 701000 xent               TSX1    VYE$ERROR
        10 000327   000000 011000                    NOP     0

      196    12136    2           RETURN;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:46   

  12136 10 000330   000000 702200 xent               TSX2  ! X66_ARET

      197    12137    2           END;
      198    12138        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:47   
      199    12139         /* Do some checks */
      200    12140    2       DO CASE( TYPE );

  12140 10 000331   200004 473500                    LDP3    @TYPE,,AUTO
        10 000332   300000 235100                    LDA     0,,PR3
        10 000333   000003 115007                    CMPA    3,DL
        10 000334   000336 602005 10                 TNC     s:12140+5,AL
        10 000335   000376 710000 10                 TRA     s:12164
        10 000336   000341 710000 10                 TRA     s:12142
        10 000337   000376 710000 10                 TRA     s:12164
        10 000340   000344 710000 10                 TRA     s:12145

      201    12141    2       CASE(0/*@OF*/);

      202    12142    2           DCB$ = M$OF$;

  12142 10 000341   000000 236000 xsym               LDQ     M$OF$
        10 000342   000347 756000 1                  STQ     DCB$

      203    12143    2           GOTO CHECK_DCB;

  12143 10 000343   000346 710000 10                 TRA     CHECK_DCB

      204    12144    2       CASE(2/*@LF*/);

      205    12145    2           DCB$ = M$LF$;

  12145 10 000344   000000 236000 xsym               LDQ     M$LF$
        10 000345   000347 756000 1                  STQ     DCB$

      206    12146    2   CHECK_DCB:
      207    12147    3           IF DCB$ -> F$DCB.ORG# ~= 2/*@KEYED*/ THEN DO;

  12147 10 000346   000347 474400 1     CHECK_DCB    LDP4    DCB$
        10 000347   400032 236100                    LDQ     26,,PR4
        10 000350   777000 376003                    ANQ     -512,DU
        10 000351   002000 116003                    CMPQ    1024,DU
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:48   
        10 000352   000376 600000 10                 TZE     s:12164

      208    12148    3               VY_FPT_ERRMSG.V.DCB# = DCB#;

  12148 10 000353   000343 720000 1                  LXL0    DCB#
        10 000354   000026 740000 xsym               STX0    VY_FPT_ERRMSG+22

      209    12149        /*E*  ERROR: VYF-E$NOTKEYED_VY-0
      210    12150              MESSAGE: %FN is not a keyed file.
      211    12151              DESCRIPTION: Self-explanatory.
      212    12152        */
      213    12153                    %SCREAM( ERR#=%E$NOTKEYED_VY, MID="'F'" );

  12154 10 000355   000027 630400 11                 EPPR0   23
        10 000356   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000357   000000 701000 xent               TSX1    VYE$ERROR
        10 000360   000000 011000                    NOP     0

      214    12156    4               IF VY_ONLINE = 1/*@YES*/ THEN DO;

  12156 10 000361   000000 235000 xsym               LDA     VY_ONLINE
        10 000362   000001 115007                    CMPA    1,DL
        10 000363   000720 601000 10                 TNZ     CHECK_MES

      215    12157    4                   CALL VYF$CLOSE( CURR$, TYPE, 2/*@SAVE*/ );

  12157 10 000364   000033 236000 11                 LDQ     27
        10 000365   200012 756100                    STQ     MODE+3,,AUTO
        10 000366   200004 236100                    LDQ     @TYPE,,AUTO
        10 000367   000034 235000 11                 LDA     28
        10 000370   200010 757100                    STAQ    MODE+1,,AUTO
        10 000371   200010 630500                    EPPR0   MODE+1,,AUTO
        10 000372   000021 631400 xsym               EPPR1   B_VECTNIL+17
        10 000373   000000 701000 xent               TSX1    VYF$CLOSE
        10 000374   000000 011000                    NOP     0

      216    12158    4                   GOTO TELL;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:49   

  12158 10 000375   000635 710000 10                 TRA     TELL

      217    12159    4                   END; /* Vy-online */
      218    12160    3               ELSE GOTO CHECK_MES;
      219    12161    3               END; /* If DCB.ORG */
      220    12162    2           END; /* Case */

      221    12163        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:50   
      222    12164    1       ACCT_VECTOR = F$O.ACCT_;

  12164 10 000376   000350 474400 1                  LDP4    FPT$
        10 000377   400024 237100                    LDAQ    20,,PR4
        10 000400   000000 757000 1                  STAQ    ACCT_VECTOR

      223    12165    1       WORK$ = ACCT_VECTOR.P.POINTER;

  12165 10 000401   000001 236000 1                  LDQ     ACCT_VECTOR+1
        10 000402   000344 756000 1                  STQ     WORK$

      224    12166    1       WHERE$ = CURR$ -> VY$LST.P.NAME_.NAME$;

  12166 10 000403   000006 236100                    LDQ     6,,PR0
        10 000404   000345 756000 1                  STQ     WHERE$

      225    12167    1       NCHARS = WHERE$ -> T$C.COUNT;

  12167 10 000405   000345 475400 1                  LDP5    WHERE$
        10 000406   500000 236100                    LDQ     0,,PR5
        10 000407   000033 772000                    QRL     27
        10 000410   000340 756000 1                  STQ     NCHARS

      226    12168    1       FILE_NAME = WHERE$ -> T$C.CHARS;

  12168 10 000411   000000 620006                    EAX0    0,QL
        10 000412   040000 100540                    MLR     fill='040'O
        10 000413   500000 200010                    ADSC9   0,,PR5                   cn=1,n=*X0
        10 000414   000352 000050 1                  ADSC9   FILE_NAME                cn=0,n=40

      227    12169    2       IF WORK$ ~= ADDR(NIL) THEN DO;

  12169 10 000415   000344 236000 1                  LDQ     WORK$
        10 000416   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000417   000444 600000 10                 TZE     s:12173

      228    12170    2           CALL INSERT( FILE_NAME, NCHARS, , '.', WORK$ -> F$ACCT_ );
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:51   

  12170 10 000420   000340 721000 1                  LXL1    NCHARS
        10 000421   777727 621011                    EAX1    -41,X1
        10 000422   777777 661003                    ERX1    -1,DU
        10 000423   000340 235000 1                  LDA     NCHARS
        10 000424   040045 100400                    MLR     fill='040'O
        10 000425   000035 000001 11                 ADSC9   29                       cn=0,n=1
        10 000426   000352 000011 1                  ADSC9   FILE_NAME,A              cn=0,n=*X1
        10 000427   000340 236000 1                  LDQ     NCHARS
        10 000430   000047 116007                    CMPQ    39,DL
        10 000431   000440 603000 10                 TRC     s:12171
        10 000432   777730 622006                    EAX2    -40,QL
        10 000433   777777 662003                    ERX2    -1,DU
        10 000434   000344 476400 1                  LDP6    WORK$
        10 000435   040046 100500                    MLR     fill='040'O
        10 000436   600000 000010                    ADSC9   0,,PR6                   cn=0,n=8
        10 000437   000352 200012 1                  ADSC9   FILE_NAME,Q              cn=1,n=*X2

      229    12171    2           CALL INDEX(NCHARS,' ',FILE_NAME);

  12171 10 000440   000000 124400                    SCM     mask='000'O
        10 000441   000352 000050 1                  ADSC9   FILE_NAME                cn=0,n=40
        10 000442   000035 000001 xsym               ADSC9   B_VECTNIL+29             cn=0,n=1
        10 000443   000340 000000 1                  ARG     NCHARS

      230    12172    2           END;

      231    12173    2       DO CASE( TYPE );

  12173 10 000444   300000 235100                    LDA     0,,PR3
        10 000445   000004 115007                    CMPA    4,DL
        10 000446   000450 602005 10                 TNC     s:12173+4,AL
        10 000447   000471 710000 10                 TRA     s:12181
        10 000450   000454 710000 10                 TRA     s:12175
        10 000451   000463 710000 10                 TRA     s:12178
        10 000452   000454 710000 10                 TRA     s:12175
        10 000453   000454 710000 10                 TRA     s:12175
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:52   

      232    12174    2       CASE( 0/*@OF*/, 2/*@LF*/, 3/*@SF*/ );

      233    12175    2           VY_OK.FILE.OFNAME.COUNT = NCHARS;

  12175 10 000454   000340 236000 1                  LDQ     NCHARS
        10 000455   000033 736000                    QLS     27
        10 000456   000213 552040 xsym               STBQ    VY_OK+139,'40'O

      234    12176    2           VY_OK.FILE.OFNAME.CHARS = FILE_NAME;

  12176 10 000457   040000 100400                    MLR     fill='040'O
        10 000460   000352 000050 1                  ADSC9   FILE_NAME                cn=0,n=40
        10 000461   000213 200050 xsym               ADSC9   VY_OK+139                cn=1,n=40
        10 000462   000471 710000 10                 TRA     s:12181

      235    12177    2       CASE( 1/*@RF*/ );

      236    12178    2           VY_OK.FILE.RFNAME.COUNT = NCHARS;

  12178 10 000463   000340 236000 1                  LDQ     NCHARS
        10 000464   000033 736000                    QLS     27
        10 000465   000226 552040 xsym               STBQ    VY_OK+150,'40'O

      237    12179    2           VY_OK.FILE.RFNAME.CHARS = FILE_NAME;

  12179 10 000466   040000 100400                    MLR     fill='040'O
        10 000467   000352 000050 1                  ADSC9   FILE_NAME                cn=0,n=40
        10 000470   000226 200050 xsym               ADSC9   VY_OK+150                cn=1,n=40

      238    12180    2           END;

      239    12181    1       RETURN;

  12181 10 000471   000000 702200 xent               TSX2  ! X66_ARET

  12179 10 000472                       ERROR        null
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:53   
      240    12182        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:54   
      241    12183    1   ERROR:;
      242    12184    1       ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/;

  12184 10 000472   000000 470400 xsym               LDP0    B$TCB$
        10 000473   000000 471500                    LDP1    0,,PR0
        10 000474   100102 236100                    LDQ     66,,PR1
        10 000475   000003 772000                    QRL     3
        10 000476   037777 376007                    ANQ     16383,DL
        10 000477   000337 756000 1                  STQ     ERR

      243    12185    1       IF ERR = 100 THEN RETURN;

  12185 10 000500   000144 116007                    CMPQ    100,DL
        10 000501   000503 601000 10                 TNZ     s:12186

  12185 10 000502   000000 702200 xent               TSX2  ! X66_ARET

      244    12186    1       VY_FPT_ERRMSG.V.DCB# = DCB#;

  12186 10 000503   000343 720000 1                  LXL0    DCB#
        10 000504   000026 740000 xsym               STX0    VY_FPT_ERRMSG+22

      245    12187    2       IF ERR = 109 THEN DO;

  12187 10 000505   000155 116007                    CMPQ    109,DL
        10 000506   000536 601000 10                 TNZ     s:12215

      246    12188    3           IF VY_ONLINE = 1/*@YES*/ THEN DO; /*Online*/

  12188 10 000507   000000 235000 xsym               LDA     VY_ONLINE
        10 000510   000001 115007                    CMPA    1,DL
        10 000511   000531 601000 10                 TNZ     s:12208

      247    12189        /*E*  ERROR: VYF-E$FILEBUSY_VY-0
      248    12190              MESSAGE: %FN is busy. Do you wish to wait?
      249    12191              DESCRIPTION: Self-explanatory.
      250    12192        */
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:55   
      251    12193                    %SCREAM( ERR#=%E$FILEBUSY_VY, MID="'F'" );

  12194 10 000512   000037 630400 11                 EPPR0   31
        10 000513   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000514   000000 701000 xent               TSX1    VYE$ERROR
        10 000515   000000 011000                    NOP     0

      252    12196    3               CALL VYY$YESNO( ANSWER );

  12196 10 000516   000043 630400 11                 EPPR0   35
        10 000517   000017 631400 xsym               EPPR1   B_VECTNIL+15
        10 000520   000000 701000 xent               TSX1    VYY$YESNO
        10 000521   000000 011000                    NOP     0

      253    12197    4               IF ANSWER = 1/*@YES*/ THEN DO;

  12197 10 000522   000336 235000 1                  LDA     ANSWER
        10 000523   000001 115007                    CMPA    1,DL
        10 000524   000536 601000 10                 TNZ     s:12215

      254    12198    4                   CALL M$WAIT( FPT_WAIT );

  12198 10 000525   000000 630400 9                  EPPR0   FPT_WAIT
        10 000526   020006 713400                    CLIMB   8198
        10 000527   400400 401760                    pmme    nvectors=2

      255    12199    4                   GOTO AGAIN;

  12199 10 000530   000134 710000 10                 TRA     AGAIN

      256    12200    4                   END; /* If/answer */
      257    12201    3               END; /* E$FILEBUSY - if/do */
      258    12202    3           ELSE DO; /*Batch - E$FILEBUSY/VY_ONLINE */

      259    12203        /*E*  ERROR: VYF-E$FILEBUSY_BATCH_VY-0
      260    12204              MESSAGE: %FN is busy.
      261    12205              DESCRIPTION: Self-explanatory.
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:56   
      262    12206        */
      263    12207                    %SCREAM( ERR#=%E$FILEBUSY_BATCH_VY, MID="'F'" );

  12208 10 000531   000045 630400 11                 EPPR0   37
        10 000532   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000533   000000 701000 xent               TSX1    VYE$ERROR
        10 000534   000000 011000                    NOP     0

      264    12210    3               GOTO CHECK_MES;

  12210 10 000535   000720 710000 10                 TRA     CHECK_MES

      265    12211    3               END; /* Else - batch */
      266    12212    2           END;
      267    12213        %EJECT;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:57   
      268    12214         /* Here for file does not exist checking */
      269    12215    2       IF ERR = 113 THEN DO;

  12215 10 000536   000337 235000 1                  LDA     ERR
        10 000537   000161 115007                    CMPA    113,DL
        10 000540   000731 601000 10                 TNZ     s:12287

      270    12216    3           IF ( CURR$->VY$LST.P.ACCT_ ~= VECTOR (NIL) ) THEN DO;

  12216 10 000541   000346 470400 1                  LDP0    CURR$
        10 000542   000000 106500                    CMPC    fill='000'O
        10 000543   000007 000010                    ADSC9   7,,PR0                   cn=0,n=8
        10 000544   000016 000010 11                 ADSC9   14                       cn=0,n=8
        10 000545   000553 600000 10                 TZE     s:12231

      271    12217         /* Here => file does not exist */
      272    12218
      273    12219    3   NOFILE:
      274    12220
      275    12221        /*E*  ERROR: VYF-E$NOFILE_VY-0
      276    12222              MESSAGE: File %FN does not exist in DP#%SN.%AC.
      277    12223              DESCRIPTION: Object file does not exist; attempt to obtain correct
      278    12224                           file name if online.
      279    12225        */
      280    12226                    %SCREAM( ERR#=%E$NOFILE_VY, MID="'F'" );

  12227 10 000546   000052 630400 11    NOFILE       EPPR0   42
        10 000547   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000550   000000 701000 xent               TSX1    VYE$ERROR
        10 000551   000000 011000                    NOP     0

      281    12229    3               GOTO TELL;

  12229 10 000552   000635 710000 10                 TRA     TELL

      282    12230    3               END;
      283    12231    3           IF (VY_OD_SEARCH) AND (SRCH_CURR$->VY$LLIST.LINK$~=ADDR(NIL)) THEN DO;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:58   

  12231 10 000553   000000 234000 xsym               SZN     VY_OD_SEARCH
        10 000554   000615 605000 10                 TPL     s:12241
        10 000555   000351 471400 1                  LDP1    SRCH_CURR$
        10 000556   100000 236100                    LDQ     0,,PR1
        10 000557   000001 116000 xsym               CMPQ    B_VECTNIL+1
        10 000560   000615 600000 10                 TZE     s:12241

      284    12232    3               SRCH_CURR$ = SRCH_CURR$->VY$LLIST.LINK$;

  12232 10 000561   000351 756000 1                  STQ     SRCH_CURR$

      285    12233    3               ACCT_FID.TEXTFID_ = VECTOR (SRCH_CURR$->VY$LLIST.ITEM$->T$C.CHARS);

  12233 10 000562   000351 471400 1                  LDP1    SRCH_CURR$
        10 000563   100001 473500                    LDP3    1,,PR1
        10 000564   300000 236100                    LDQ     0,,PR3
        10 000565   000033 772000                    QRL     27
        10 000566   000064 737000                    LLS     52
        10 000567   000140 135007                    SBLA    96,DL
        10 000570   200010 453500                    STP3    MODE+1,,AUTO
        10 000571   200010 236100                    LDQ     MODE+1,,AUTO
        10 000572   200000 036007                    ADLQ    65536,DL
        10 000573   000262 757000 1                  STAQ    ACCT_FID+2

      286    12234    3               CALL M$FID (ACCT_FID) ALTRET (ACCT_FID_ERR);

  12234 10 000574   000260 630400 1                  EPPR0   ACCT_FID
        10 000575   420001 713400                    CLIMB   alt,+8193
        10 000576   404400 401760                    pmme    nvectors=10
        10 000577   000746 702000 10                 TSX2    ACCT_FID_ERR

      287    12235    3               IF AFR.ACCT THEN

  12235 10 000600   000316 236000 1                  LDQ     AFR
        10 000601   200000 316003                    CANQ    65536,DU
        10 000602   000606 600000 10                 TZE     s:12237
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:59   

      288    12236    3                   F$O.ACCT_ = ACCT_FID.ACCT_;

  12236 10 000603   000266 237000 1                  LDAQ    ACCT_FID+6
        10 000604   000350 470400 1                  LDP0    FPT$
        10 000605   000024 757100                    STAQ    20,,PR0

      289    12237    3               IF AFR.SN THEN

  12237 10 000606   000316 236000 1                  LDQ     AFR
        10 000607   040000 316003                    CANQ    16384,DU
        10 000610   000614 600000 10                 TZE     s:12239

      290    12238    3                   F$O.SN_ = ACCT_FID.SN_;

  12238 10 000611   000272 237000 1                  LDAQ    ACCT_FID+10
        10 000612   000350 470400 1                  LDP0    FPT$
        10 000613   000002 757100                    STAQ    2,,PR0

      291    12239    3               GOTO OPEN_FILE;

  12239 10 000614   000303 710000 10                 TRA     OPEN_FILE

      292    12240    3               END;
      293    12241    3           ELSE IF (VY_OD_SEARCH) THEN DO; /* File does not exist */

  12241 10 000615   000000 234000 xsym               SZN     VY_OD_SEARCH
        10 000616   000546 605000 10                 TPL     NOFILE

      294    12242         /*         VY_OD_SEARCH = '0'b;*/
      295    12243        /*E*  ERROR: VYF-E$NOSRCHFILE_VY-0
      296    12244              MESSAGE: File %U1 does not exist in any of the
      297    12245                       specified SRCH accounts.
      298    12246              DESCRIPTION: Self-explanatory.
      299    12247        */
      300    12248    3                   VY_EFIELD1.COUNT = CURR$->VY$LST.P.NAME_.NAME$->T$C.COUNT;

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:60   
  12248 10 000617   000006 471500                    LDP1    6,,PR0
        10 000620   100000 236100                    LDQ     0,,PR1
        10 000621   000000 552040 xsym               STBQ    VY_EFIELD1,'40'O

      301    12249    3                   VY_EFIELD1.CHARS = CURR$->VY$LST.P.NAME_.NAME$->T$C.CHARS;

  12249 10 000622   100000 236100                    LDQ     0,,PR1
        10 000623   000033 772000                    QRL     27
        10 000624   000000 620006                    EAX0    0,QL
        10 000625   040000 100540                    MLR     fill='040'O
        10 000626   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        10 000627   000000 200117 xsym               ADSC9   VY_EFIELD1               cn=1,n=79

      302    12250                        %SCREAM (ERR#=%E$NOSRCHFILE_VY, MID="'F'");

  12251 10 000630   000057 630400 11                 EPPR0   47
        10 000631   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000632   000000 701000 xent               TSX1    VYE$ERROR
        10 000633   000000 011000                    NOP     0

      303    12253    3                   END;

  12253 10 000634   000635 710000 10                 TRA     TELL

      304    12254    2               ELSE GOTO NOFILE;
      305    12255    2   TELL:   IF DEL THEN RETURN;

  12255 10 000635   200006 470500       TELL         LDP0    @DEL,,AUTO
        10 000636   000000 234100                    SZN     0,,PR0
        10 000637   000641 605000 10                 TPL     s:12256

  12255 10 000640   000000 702200 xent               TSX2  ! X66_ARET

      306    12256    3           IF VY_ONLINE = 1/*@YES*/ THEN DO;

  12256 10 000641   000000 235000 xsym               LDA     VY_ONLINE
        10 000642   000001 115007                    CMPA    1,DL
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:61   
        10 000643   000720 601000 10                 TNZ     CHECK_MES

      307    12257         /* Set up for X$PARSE */
      308    12258    3               WKSZ = 256/4;

  12258 10 000644   000100 236007                    LDQ     64,DL
        10 000645   000341 756000 1                  STQ     WKSZ

      309    12259    3               CALL VYP$PAR( 2, ADDR(VY_N_START_FID), WKSZ );

  12259 10 000646   000063 236000 11                 LDQ     51
        10 000647   200010 756100                    STQ     MODE+1,,AUTO
        10 000650   000064 236000 11                 LDQ     52
        10 000651   200013 756100                    STQ     MODE+4,,AUTO
        10 000652   200010 631500                    EPPR1   MODE+1,,AUTO
        10 000653   200012 451500                    STP1    MODE+3,,AUTO
        10 000654   000033 236000 11                 LDQ     27
        10 000655   200011 756100                    STQ     MODE+2,,AUTO
        10 000656   200011 630500                    EPPR0   MODE+2,,AUTO
        10 000657   000021 631400 xsym               EPPR1   B_VECTNIL+17
        10 000660   000000 701000 xent               TSX1    VYP$PAR
        10 000661   000000 011000                    NOP     0

      310    12260    3               I = CURR$ -> VY$LST.TYPE;

  12260 10 000662   000346 470400 1                  LDP0    CURR$
        10 000663   000001 236100                    LDQ     1,,PR0
        10 000664   000022 772000                    QRL     18
        10 000665   000332 756000 1                  STQ     I

      311    12261    3               J = CURR$ -> VY$LST.SUB_TYPE;

  12261 10 000666   000001 236100                    LDQ     1,,PR0
        10 000667   777777 376007                    ANQ     -1,DL
        10 000670   000333 756000 1                  STQ     J

      312    12262    3               CALL VYS$LST( CURR$,
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:62   

  12262 10 000671   000003 471400 xsym               LDP1    VY_P_PCB_MAIN+3
        10 000672   100003 473500                    LDP3    3,,PR1
        10 000673   000001 236000 xsym               LDQ     B_VECTNIL+1
        10 000674   200010 756100                    STQ     MODE+1,,AUTO
        10 000675   000066 237000 11                 LDAQ    54
        10 000676   200016 757100                    STAQ    MODE+7,,AUTO
        10 000677   000070 236000 11                 LDQ     56
        10 000700   200015 756100                    STQ     MODE+6,,AUTO
        10 000701   200010 634500                    EPPR4   MODE+1,,AUTO
        10 000702   200014 454500                    STP4    MODE+5,,AUTO
        10 000703   300003 635500                    EPPR5   3,,PR3
        10 000704   200013 455500                    STP5    MODE+4,,AUTO
        10 000705   000034 236000 11                 LDQ     28
        10 000706   200012 756100                    STQ     MODE+3,,AUTO
        10 000707   200012 630500                    EPPR0   MODE+3,,AUTO
        10 000710   000024 631400 xsym               EPPR1   B_VECTNIL+20
        10 000711   000000 701000 xent               TSX1    VYS$LST
        10 000712   000000 011000                    NOP     0

      313    12263    3                  VY_P_PCB_MAIN.OUT$ -> O$B.SUBLK$(0) -> O$B.SUBLK$(0),
      314    12264    3                  ADDR(NIL), I, J, -8 );
      315    12265    3               CALL VYF$FREE( 3/*@DS3*/, WKSZ, 1 );

  12265 10 000713   000071 630400 11                 EPPR0   57
        10 000714   000021 631400 xsym               EPPR1   B_VECTNIL+17
        10 000715   000000 701000 xent               TSX1    VYF$FREE
        10 000716   000000 011000                    NOP     0

      316    12266    3               GOTO AGAIN;

  12266 10 000717   000134 710000 10                 TRA     AGAIN

      317    12267    3               END; /* E$NOFILE - VY_ONLINE */
      318    12268    3           ELSE DO;

      319    12269    3   CHECK_MES:
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:63   
      320    12270    4               IF VY_DO_PASS1 = 1/*@YES*/ THEN DO;

  12270 10 000720   000000 235000 xsym  CHECK_MES    LDA     VY_DO_PASS1
        10 000721   000001 115007                    CMPA    1,DL
        10 000722   000730 601000 10                 TNZ     s:12283

      321    12271    4                   VY_DO_PASS1 = 0/*@NO*/;

  12271 10 000723   000000 450000 xsym               STZ     VY_DO_PASS1

      322    12272        /*E*  ERROR: VYF-E$JUSTFILE_VY-0
      323    12273              MESSAGE: Processing continues only for file existence checking.
      324    12274              DESCRIPTION: Self-explanatory.
      325    12275        */
      326    12276                        %SCREAM(
      327    12277                        ERR#=%E$JUSTFILE_VY,
      328    12278                        LEVEL=%@E$I_VY,
      329    12279                        MID="'F'");

  12280 10 000724   000075 630400 11                 EPPR0   61
        10 000725   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000726   000000 701000 xent               TSX1    VYE$ERROR
        10 000727   000000 011000                    NOP     0

      330    12282    4                   END;

      331    12283    3               RETURN;

  12283 10 000730   000000 702200 xent               TSX2  ! X66_ARET

      332    12284    3               END;
      333    12285    2           END;
      334    12286    1       ELSE
      335    12287    2           IF ERR = 110 THEN DO;

  12287 10 000731   000156 115007                    CMPA    110,DL
        10 000732   000740 601000 10                 TNZ     s:12301
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:64   

      336    12288        /*E*  ERROR: VYF-E$ON_TO_EXISTS_VY-0
      337    12289              MESSAGE: 'ON/TO' illegal - file exists.
      338    12290              DESCRIPTION: Self-explanatory.
      339    12291        */
      340    12292                    %SCREAM(
      341    12293                    ERR#=%E$ON_TO_EXISTS_VY,
      342    12294                    MID="'F'",
      343    12295                    LEVEL=%@E$S_VY);

  12296 10 000733   000102 630400 11                 EPPR0   66
        10 000734   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000735   000000 701000 xent               TSX1    VYE$ERROR
        10 000736   000000 011000                    NOP     0

      344    12298    2               ALTRETURN;

  12298 10 000737   000000 702200 xent               TSX2  ! X66_AALT

      345    12299    2               END;
      346    12300    2           ELSE DO;

      347    12301    2               CALL VYE$ERRMSG;

  12301 10 000740   000002 631400 xsym               EPPR1   B_VECTNIL+2
        10 000741   000000 701000 xent               TSX1    VYE$ERRMSG
        10 000742   000000 011000                    NOP     0

      348    12302                    %ERROR_IT;

  12303 10 000743   000000 237200 xsym               LDAQ  ! VY_UNWIND
        10 000744   000000 700200 xent               TSX0  ! X66_AUNWIND
        10 000745   000000 000200                    ZERO    0,128

      349    12305    2               END;
      350    12306    1   ACCT_FID_ERR:
      351    12307        /*E*  ERROR: VYF-E$SRCH_FID_ERR_VY-0
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:65   
      352    12308              MESSAGE: Search account %U1 can not be processed correctly.
      353    12309                       SRCH syntax:
      354    12310                            SR[CH] ([psn].ac1 [,[psn].ac2] ...)
      355    12311                            where psn is the pack set name (DP#...) and,
      356    12312                                  ac is the account name (8 characters from the
      357    12313                                     ASCII 7-bit set).
      358    12314              DESCRIPTION: Self-explanatory.
      359    12315        */
      360    12316    1       VY_EFIELD1.COUNT = SRCH_CURR$->VY$LLIST.ITEM$->T$C.COUNT;

  12316 10 000746   000351 470400 1     ACCT_FID_ERR LDP0    SRCH_CURR$
        10 000747   000001 471500                    LDP1    1,,PR0
        10 000750   100000 236100                    LDQ     0,,PR1
        10 000751   000000 552040 xsym               STBQ    VY_EFIELD1,'40'O

      361    12317    1       VY_EFIELD1.CHARS = SRCH_CURR$->VY$LLIST.ITEM$->T$C.CHARS;

  12317 10 000752   100000 236100                    LDQ     0,,PR1
        10 000753   000033 772000                    QRL     27
        10 000754   000000 620006                    EAX0    0,QL
        10 000755   040000 100540                    MLR     fill='040'O
        10 000756   100000 200010                    ADSC9   0,,PR1                   cn=1,n=*X0
        10 000757   000000 200117 xsym               ADSC9   VY_EFIELD1               cn=1,n=79

      362    12318            %SCREAM (ERR#=%E$SRCH_FID_ERR_VY ,MID="'F'");

  12319 10 000760   000107 630400 11                 EPPR0   71
        10 000761   000022 631400 xsym               EPPR1   B_VECTNIL+18
        10 000762   000000 701000 xent               TSX1    VYE$ERROR
        10 000763   000000 011000                    NOP     0

      363    12321            %ERROR_IT;

  12322 10 000764   000000 237200 xsym               LDAQ  ! VY_UNWIND
        10 000765   000000 700200 xent               TSX0  ! X66_AUNWIND
        10 000766   000000 000200                    ZERO    0,128
      364    12324    1   END VYF$OPEN;
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:66   
      365    12325        %EOD;

PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:67   
--  Include file information  --

   CP_6_SUBS.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   VY_PSUBS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYF$OPEN.
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:68   

 **** Variables and constants ****

  ****  Section 001  Data  VYF$OPEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   260-0-0/d STRC(864)   r     1 ACCT_FID                 310-0-0/c STRC(72)    r     1 ACCT_NAME
     0-0-0/w STRC(72)    r     1 ACCT_VECTOR              316-0-0/d STRC(324)   r     1 AFR
   336-0-0/w UBIN        r     1 ANSWER                   346-0-0/w PTR         r     1 CURR$
   343-0-0/w UBIN        r     1 DCB#                     347-0-0/w PTR         r     1 DCB$
   337-0-0/w UBIN        r     1 ERR                      342-0-0/w UBIN        r     1 EX
   330-0-0/w STRC(72)    r     1 F                        352-0-0/c CHAR(40)    r     1 FILE_NAME
   350-0-0/w PTR         r     1 FPT$                     332-0-0/w UBIN        r     1 I
   333-0-0/w UBIN        r     1 J                        340-0-0/w UBIN        r     1 NCHARS
   312-0-0/d STRC(90)    r     1 SN_NAME                  351-0-0/w PTR         r     1 SRCH_CURR$
     2-0-0/d STRC(2088)  r     1 VY_EI_FPT_OPEN            74-0-0/d STRC(2088)  r     1 VY_O_FPT_OPEN
   166-0-0/d STRC(2088)  r     1 VY_R_FPT_OPEN            345-0-0/w PTR         r     1 WHERE$
   341-0-0/w UBIN        r     1 WKSZ                     344-0-0/w PTR         r     1 WORK$

  ****  Section 009 RoData VYF$OPEN

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/d STRC(216)   r     1 FPT_WAIT

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     3-0-0/w PTR         r     1 @CURR_P$                   6-0-0/w PTR         r     1 @DEL
     5-0-0/w PTR         r     1 @P_MODE                    4-0-0/w PTR         r     1 @TYPE
    *0-0-0/w PTR         r     1 CURR_P$                   *0-0-0/w BIT         r     1 DEL
     7-0-0/w UBIN        r     1 MODE                      *0-0-0/w UBIN        r     1 P_MODE
    *0-0-0/w UBIN        r     1 TYPE
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:69   

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 M$LF$
     0-0-0/w PTR         r     1 M$OF$                      0-0-0/w UBIN        r     1 VY_COMMAND
     0-0-0/w UBIN        r     1 VY_DO_PASS1                0-0-0/w STRC(720)   r     1 VY_EFIELD1
     0-0-0/d STRC(936)   r     1 VY_FPT_ERRMSG              0-0-0/w UBIN        r     1 VY_N_START_FID
     0-0-0/b BIT         r     1 VY_OD_SEARCH               0-0-0/w STRC(5796)  r     1 VY_OK
     0-0-0/w UBIN        r     1 VY_ONLINE                  0-0-0/w STRC(504)   r     1 VY_P_PCB_MAIN
     0-0-0/w PTR         r     1 VY_SRCH_LST$               0-0-0/d REMB        r     1 VY_UNWIND

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/c CHAR(8)     r     1 F$ACCT_                    0-0-0/d ASTR(3528)  r     1 F$DCB
     0-0-0/c ASTR(9)     r     1 F$NAME_                    0-0-0/d STRC(2088)  r     1 F$O
     0-0-0N  NULL        r     1 M$EI                       0-0-0N  NULL        r     1 M$OF
     0-0-0N  NULL        r     1 M$RF                       0-0-0/w STRC(144)   r     1 O$B
     0-0-0/w ASTR(9)     r     1 T$C                        0-0-0/c ASTR(9)     r     1 T$C_UNAL
     0-0-0/w STRC(72)    r     1 VY$LLIST                   0-0-0/w STRC(648)   r     1 VY$LST


   Procedure VYF$OPEN requires 503 words for executable code.
   Procedure VYF$OPEN requires 16 words of local(AUTO) storage.
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:70   
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:71   
          MINI XREF LISTING

ACCT_FID
     11169**DCL     12112<>CALL    12234<>CALL
ACCT_FID.ACCT_
     11170**DCL     12114>>ASSIGN  12236>>ASSIGN
ACCT_FID.SN_
     11171**DCL     12116>>ASSIGN  12238>>ASSIGN
ACCT_FID.TEXTFID_
     11169**DCL     12111<<ASSIGN  12233<<ASSIGN
ACCT_FID.V
     11173**DCL     11169--DCLINIT
ACCT_FID_ERR
     12316**LABEL   12112--CALLALT 12234--CALLALT
ACCT_NAME
     11192**DCL     11170--DCLINIT
ACCT_VECTOR
      9475**DCL     12164<<ASSIGN
ACCT_VECTOR.F
      9480**DCL      9484--REDEF
ACCT_VECTOR.P.POINTER
      9485**DCL     12165>>ASSIGN
AFR
     11218**DCL     11173--DCLINIT
AFR.ACCT
     11218**DCL     12113>>IF      12235>>IF
AFR.SN
     11218**DCL     12115>>IF      12237>>IF
AGAIN
     12096**LABEL   12199--GOTO    12266--GOTO
ANSWER
     11398**DCL     12196<>CALL    12197>>IF
B$ALT.CODE
      9657**DCL      9657--REDEF    9658--REDEF    9658--REDEF
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:72   
B$ALT.ERR.ERR#
      9659**DCL      9659--REDEF   12184>>ASSIGN
B$ALT.EVID
      9658**DCL      9658--REDEF    9658--REDEF
B$TCB.ALT$
      9653**DCL     12184>>ASSIGN
B$TCB$
      5338**DCL     12184>>ASSIGN
CHECK_DCB
     12147**LABEL   12143--GOTO
CHECK_MES
     12270**LABEL   12160--GOTO    12210--GOTO
CURR$
     11443**DCL     12103<<ASSIGN  12104>>ASSIGN  12105>>ASSIGN  12106>>ASSIGN  12107>>ASSIGN  12108>>ASSIGN
     12109>>IF      12118>>IF      12118>>ASSIGN  12120>>IF      12120>>ASSIGN  12125>>IF      12157<>CALL
     12166>>ASSIGN  12216>>IF      12248>>ASSIGN  12249>>ASSIGN  12249>>ASSIGN  12260>>ASSIGN  12261>>ASSIGN
     12262<>CALL
CURR_P$
     11421**DCL         9--PROC    12103>>ASSIGN
DCB#
     11404**DCL     12028<<ASSIGN  12031<<ASSIGN  12038<<ASSIGN  12041<<ASSIGN  12132>>ASSIGN  12148>>ASSIGN
     12186>>ASSIGN
DCB$
     11444**DCL     12142<<ASSIGN  12145<<ASSIGN  12147>>IF
DEL
     11424**DCL         9--PROC    12072>>IF      12096>>ASSIGN  12127>>IF      12255>>IF
ERR
     11399**DCL     12184<<ASSIGN  12185>>IF      12187>>IF      12215>>IF      12287>>IF
ERROR
     12179**LABEL   12124--CALLALT
EX
     11403**DCL     12074<<ASSIGN  12080<<ASSIGN  12083<<ASSIGN  12089<<ASSIGN  12092<<ASSIGN  12098>>ASSIGN
F.ASN
     11227**DCL     11172--DCLINIT
F.RES
     11228**DCL     11172--DCLINIT
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:73   
F$ACCT_
      9667**DCL     12170>>CALLBLT
F$DCB.ACTPOS
      9522**DCL      9522--REDEF
F$DCB.ARS#
      9496**DCL      9496--REDEF
F$DCB.ATTR
      9515**DCL      9516--REDEF
F$DCB.BORROW
      9530**DCL      9530--REDEF    9530--REDEF    9530--REDEF
F$DCB.DCBNAME.L
      9544**DCL      9544--IMP-SIZ
F$DCB.EOMCHAR#
      9500**DCL      9500--REDEF
F$DCB.FLDID
      9525**DCL      9525--REDEF
F$DCB.FORM$
      9519**DCL      9519--REDEF
F$DCB.FSECT
      9535**DCL      9535--REDEF
F$DCB.FSN#
      9512**DCL      9512--REDEF    9512--REDEF    9513--REDEF
F$DCB.HEADER$
      9518**DCL      9518--REDEF
F$DCB.IXTNSIZE#
      9516**DCL      9516--REDEF
F$DCB.LASTSTA$
      9505**DCL      9505--REDEF
F$DCB.LVL
      9531**DCL      9531--REDEF
F$DCB.NAME#.C
      9506**DCL      9506--REDEF
F$DCB.NOEOF
      9528**DCL      9528--REDEF
F$DCB.NRECS#
      9517**DCL      9517--REDEF
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:74   
F$DCB.NRECX
      9536**DCL      9536--REDEF
F$DCB.OHDR
      9528**DCL      9528--REDEF
F$DCB.ORG#
      9511**DCL      9511--REDEF   12147>>IF
F$DCB.PRECNO
      9534**DCL      9534--REDEF
F$DCB.RCSZ
      9540**DCL      9540--REDEF
F$DCB.RES#
      9507**DCL      9507--REDEF
F$DCB.SETX
      9519**DCL      9519--REDEF
F$DCB.TAB$
      9519**DCL      9519--REDEF
F$DCB.TDA
      9533**DCL      9534--REDEF
F$DCB.WSN#
      9507**DCL      9507--REDEF
F$NAME_.COUNT
      9665**DCL      9666--IMP-SIZ
F$O
     11294**DCL     12124<>CALL
F$O.ACCT_
     11298**DCL     12105<<ASSIGN  12114<<ASSIGN  12164>>ASSIGN  12236<<ASSIGN
F$O.ACSVEH_
     11296**DCL     11297--REDEF
F$O.ALTKEYS_
     11302**DCL     11303--REDEF   11303--REDEF
F$O.HDR_
     11301**DCL     11302--REDEF
F$O.NAME_
     11295**DCL     12104<<ASSIGN
F$O.PASS_
     11296**DCL     12106<<ASSIGN
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:75   
F$O.SN_
     11294**DCL     12107<<ASSIGN  12116<<ASSIGN  12238<<ASSIGN
F$O.TAB_
     11300**DCL     11301--REDEF
F$O.UHL_
     11294**DCL     11295--REDEF   11295--REDEF
F$O.V.ACS#
     11314**DCL     12100<<ASSIGN
F$O.V.ASN#
     11313**DCL     12118<<ASSIGN  12119<<ASSIGN
F$O.V.DELETE#
     11305**DCL     12096<<ASSIGN
F$O.V.EXIST#
     11307**DCL     12098<<ASSIGN
F$O.V.FSN#
     11334**DCL     11334--REDEF   11334--REDEF
F$O.V.FUN#
     11313**DCL     12097<<ASSIGN
F$O.V.INITZ.SCRUB#
     11304**DCL     12102<<ASSIGN
F$O.V.ORG#
     11314**DCL     12099<<ASSIGN
F$O.V.RES#
     11318**DCL     12120<<ASSIGN  12121<<ASSIGN
F$O.V.SPARE#
     11321**DCL     12101<<ASSIGN
F$O.WSN_
     11300**DCL     11300--REDEF   12108<<ASSIGN
FILE_NAME
     11464**DCL     12168<<ASSIGN  12170<<CALLBLT 12171>>CALLBLT 12176>>ASSIGN  12179>>ASSIGN
FPT$
     11445**DCL     11294--IMP-PTR 12027<<ASSIGN  12030<<ASSIGN  12037<<ASSIGN  12040<<ASSIGN  12096>>ASSIGN
     12097>>ASSIGN  12098>>ASSIGN  12099>>ASSIGN  12100>>ASSIGN  12101>>ASSIGN  12102>>ASSIGN  12104>>ASSIGN
     12105>>ASSIGN  12106>>ASSIGN  12107>>ASSIGN  12108>>ASSIGN  12114>>ASSIGN  12116>>ASSIGN  12118>>ASSIGN
     12119>>ASSIGN  12120>>ASSIGN  12121>>ASSIGN  12124>>CALL    12164>>ASSIGN  12236>>ASSIGN  12238>>ASSIGN
FPT_WAIT
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:76   
     11481**DCL     12198<>CALL
FPT_WAIT.V
     11482**DCL     11481--DCLINIT
I
     11389**DCL     11390--REDEF   12260<<ASSIGN  12262<>CALL
J
     11391**DCL     11392--REDEF   12261<<ASSIGN  12262<>CALL
K
     11393**DCL     11394--REDEF
L
     11395**DCL     11396--REDEF
M$EI
     10805**DCL     12041>>ASSIGN
M$FID
      1671**DCL-ENT 12112--CALL    12234--CALL
M$LF$
      5756**DCL     12145>>ASSIGN
M$OF
     10799**DCL     12028>>ASSIGN  12038>>ASSIGN
M$OF$
      5755**DCL     12142>>ASSIGN
M$OPEN
      1608**DCL-ENT 12124--CALL
M$RF
     10800**DCL     12031>>ASSIGN
M$WAIT
      1666**DCL-ENT 12198--CALL
MODE
     11402**DCL     12032>>IF      12073<<ASSIGN  12079<<ASSIGN  12082<<ASSIGN  12086<<ASSIGN  12088<<ASSIGN
     12091<<ASSIGN  12097>>ASSIGN
NCHARS
     11400**DCL     12167<<ASSIGN  12170>>CALLBLT 12171<<CALLBLT 12175>>ASSIGN  12178>>ASSIGN
NOFILE
     12227**LABEL   12254--GOTO
O$B.SUBLK$
      9585**DCL     12262>>CALL    12262<>CALL
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:77   
OPEN_FILE
     12124**LABEL   12239--GOTO
P_MODE
     11423**DCL         9--PROC    12077>>DOCASE
SN_NAME
     11205**DCL     11171--DCLINIT
SRCH_CURR$
     11446**DCL     12110<<ASSIGN  12111>>ASSIGN  12111>>ASSIGN  12231>>IF      12232<<ASSIGN  12232>>ASSIGN
     12233>>ASSIGN  12233>>ASSIGN  12316>>ASSIGN  12317>>ASSIGN  12317>>ASSIGN
T$C.CHARS
      9447**DCL     12111--ASSIGN  12168>>ASSIGN  12233--ASSIGN  12249>>ASSIGN  12317>>ASSIGN
T$C.COUNT
      9446**DCL      9447--IMP-SIZ 12111>>ASSIGN  12167>>ASSIGN  12168>>ASSIGN  12233>>ASSIGN  12248>>ASSIGN
     12249>>ASSIGN  12316>>ASSIGN  12317>>ASSIGN
T$C_UNAL.COUNT
      9449**DCL      9450--IMP-SIZ
TELL
     12255**LABEL   12158--GOTO    12229--GOTO
TYPE
     11422**DCL         9--PROC    12025>>DOCASE  12054<>CALL    12109>>IF      12125>>IF      12140>>DOCASE
     12157<>CALL    12173>>DOCASE
VY$LLIST.ITEM$
      9421**DCL     12111>>ASSIGN  12111>>ASSIGN  12233>>ASSIGN  12233>>ASSIGN  12316>>ASSIGN  12317>>ASSIGN
     12317>>ASSIGN
VY$LLIST.LINK$
      9420**DCL     12231>>IF      12232>>ASSIGN
VY$LST.LINK$
      9358**DCL     12125>>IF
VY$LST.P.ACCT_
      9370**DCL     12105>>ASSIGN  12109>>IF      12216>>IF
VY$LST.P.ASN
      9395**DCL     12118>>ASSIGN
VY$LST.P.B.ASN
      9392**DCL     12118>>IF
VY$LST.P.B.RES
      9391**DCL     12120>>IF
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:78   
VY$LST.P.NAME_
      9365**DCL     12104>>ASSIGN
VY$LST.P.NAME_.NAME$
      9369**DCL     12166>>ASSIGN  12248>>ASSIGN  12249>>ASSIGN  12249>>ASSIGN
VY$LST.P.PASS_
      9375**DCL     12106>>ASSIGN
VY$LST.P.RES
      9394**DCL     12120>>ASSIGN
VY$LST.P.SN_
      9380**DCL     12107>>ASSIGN
VY$LST.P.WSN_
      9385**DCL     12108>>ASSIGN
VY$LST.SUB_TYPE
      9360**DCL     12261>>ASSIGN
VY$LST.TYPE
      9359**DCL     12260>>ASSIGN
VY$NODE.ADDR_START_A
      9232**DCL      9233--REDEF
VY$NODE.ADDR_STOP_A
      9237**DCL      9238--REDEF
VY$NODE.L_PREV_SIZE
      9290**DCL      9301--REDEF
VY$NODE.L_SC_START
      9309**DCL      9314--REDEF
VY$NODE.L_SC_STOP
      9315**DCL      9320--REDEF
VY$NODE.L_SIZE
      9278**DCL      9289--REDEF
VY$NODE.L_START
      9254**DCL      9265--REDEF
VY$NODE.L_STOP
      9266**DCL      9277--REDEF
VY$NODE.PROMOTE_HEAD
      9321**DCL      9324--REDEF
VY$NODE.PROMOTE_TAIL
      9325**DCL      9328--REDEF
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:79   
VY$NODE.START_PAGE#_A
      9242**DCL      9243--REDEF
VY$NODE.STOP_PAGE#_A
      9247**DCL      9248--REDEF
VYD$B2C
     11362**DCL-ENT 12054--CALL
VYE$ERRMSG
     11358**DCL-ENT 12301--CALL
VYE$ERROR
     11355**DCL-ENT 12069--CALL    12134--CALL    12154--CALL    12194--CALL    12208--CALL    12227--CALL
     12251--CALL    12280--CALL    12296--CALL    12319--CALL
VYF$CLOSE
     11369**DCL-ENT 12157--CALL
VYF$FREE
     11365**DCL-ENT 12265--CALL
VYP$PAR
     11370**DCL-ENT 12259--CALL
VYS$LST
     11371**DCL-ENT 12262--CALL
VYY$YESNO
     11367**DCL-ENT 12196--CALL
VY_BIAS.A
      5387**DCL      5387--REDEF
VY_CBUF.CHARS_A
      5378**DCL      5378--REDEF
VY_COMMAND
      5378**DCL     12087>>IF
VY_DO_PASS1
      5379**DCL     12270>>IF      12271<<ASSIGN
VY_EBUF.CHARS_A
      5679**DCL      5680--REDEF
VY_EFIELD1.CHARS
      5680**DCL      5680--REDEF   12249<<ASSIGN  12317<<ASSIGN
VY_EFIELD1.CHARS_A
      5680**DCL     12054<>CALL
VY_EFIELD1.COUNT
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:80   
      5680**DCL     12248<<ASSIGN  12316<<ASSIGN
VY_EFIELD2.CHARS
      5681**DCL      5681--REDEF
VY_EFIELD3.CHARS
      5682**DCL      5682--REDEF
VY_EI_FPT_OPEN
     10878**DCL     12040--ASSIGN
VY_EI_FPT_OPEN.ACSVEH_
     10880**DCL     10881--REDEF
VY_EI_FPT_OPEN.ALTKEYS_
     10886**DCL     10887--REDEF   10887--REDEF
VY_EI_FPT_OPEN.HDR_
     10885**DCL     10886--REDEF
VY_EI_FPT_OPEN.TAB_
     10884**DCL     10885--REDEF
VY_EI_FPT_OPEN.UHL_
     10878**DCL     10879--REDEF   10879--REDEF
VY_EI_FPT_OPEN.V
     10887**DCL     10878--DCLINIT
VY_EI_FPT_OPEN.V.FSN#
     10918**DCL     10918--REDEF   10918--REDEF
VY_EI_FPT_OPEN.WSN_
     10884**DCL     10884--REDEF
VY_ERRORS
      5383**DCL      5385--REDEF
VY_ERRORS.CONFLICT_A
      5384**DCL      5385--REDEF
VY_ERRORS.UNSAT_A
      5383**DCL      5384--REDEF
VY_FPT_ERRMSG.V.DCB#
      4810**DCL     12132<<ASSIGN  12148<<ASSIGN  12186<<ASSIGN
VY_IMAGE_DATA.CPAGE#_A
      5271**DCL      5272--REDEF
VY_IMAGE_DATA.NODE_A$
      5283**DCL      5284--REDEF
VY_IMAGE_DATA.START_A$
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:81   
      5275**DCL      5276--REDEF
VY_IMAGE_DATA.STOP_A$
      5279**DCL      5280--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5294**DCL      5295--REDEF
VY_IMAGE_PROC.NODE_A$
      5306**DCL      5307--REDEF
VY_IMAGE_PROC.START_A$
      5298**DCL      5299--REDEF
VY_IMAGE_PROC.STOP_A$
      5302**DCL      5303--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5317**DCL      5318--REDEF
VY_IMAGE_ROS.NODE_A$
      5329**DCL      5330--REDEF
VY_IMAGE_ROS.START_A$
      5321**DCL      5322--REDEF
VY_IMAGE_ROS.STOP_A$
      5325**DCL      5326--REDEF
VY_MAP_HDR.CHARS
      5744**DCL      5745--REDEF    5745--REDEF
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5073**DCL      5073--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5080**DCL      5080--REDEF
VY_MAP_LO_FPT_WRITE.STATION_
      5042**DCL      5042--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5049**DCL      5049--REDEF
VY_MBUF.CHARS
      5743**DCL      5744--REDEF    5744--REDEF
VY_M_VECTOR.F
      5112**DCL      5116--REDEF
VY_M_VECTOR_DP.F
      5147**DCL      5151--REDEF
VY_N_START_FID
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:82   
     11447**DCL     12259--CALL
VY_O.DUPL_ATTCH
      5525**DCL      5529--REDEF
VY_O.MAP_ATTCH
      5513**DCL      5524--REDEF
VY_O.PRIMARY_OPTION
      5507**DCL      5512--REDEF
VY_O.SEV_ATTCH
      5530**DCL      5532--REDEF
VY_OD.DUPL_ATTCH
      5669**DCL      5673--REDEF
VY_OD.MAP_ATTCH
      5657**DCL      5668--REDEF
VY_OD.PRIMARY_OPTION
      5651**DCL      5656--REDEF
VY_OD.SEV_ATTCH
      5674**DCL      5676--REDEF
VY_OD_SEARCH
      5374**DCL     12109>>IF      12126<<ASSIGN  12231>>IF      12241>>IF
VY_OK.FILE.OFNAME.CHARS
      5264**DCL     12176<<ASSIGN
VY_OK.FILE.OFNAME.COUNT
      5263**DCL     12175<<ASSIGN
VY_OK.FILE.RFNAME.CHARS
      5267**DCL     12179<<ASSIGN
VY_OK.FILE.RFNAME.COUNT
      5266**DCL     12178<<ASSIGN
VY_OL_KEY_BUF.FORM0
      5180**DCL      5183--REDEF    5190--REDEF
VY_ONLINE
      5389**DCL     12156>>IF      12188>>IF      12256>>IF
VY_OU_HEAD.REC_A
      5368**DCL      5369--REDEF
VY_O_FPT_OPEN
     10994**DCL     12027--ASSIGN  12037--ASSIGN
VY_O_FPT_OPEN.ACSVEH_
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:83   
     10996**DCL     10997--REDEF
VY_O_FPT_OPEN.ALTKEYS_
     11002**DCL     11003--REDEF   11003--REDEF
VY_O_FPT_OPEN.HDR_
     11001**DCL     11002--REDEF
VY_O_FPT_OPEN.TAB_
     11000**DCL     11001--REDEF
VY_O_FPT_OPEN.UHL_
     10994**DCL     10995--REDEF   10995--REDEF
VY_O_FPT_OPEN.V
     11003**DCL     10994--DCLINIT
VY_O_FPT_OPEN.V.FSN#
     11034**DCL     11034--REDEF   11034--REDEF
VY_O_FPT_OPEN.WSN_
     11000**DCL     11000--REDEF
VY_O_KEY_BUF.FORM0
      5157**DCL      5160--REDEF    5167--REDEF
VY_O_KEY_BUF_L.FORM0
      5203**DCL      5206--REDEF    5213--REDEF
VY_PAR_UNWIND
      5738**DCL      5738--REDEF
VY_PASS2_REF.OU.L_START
      5705**DCL      5706--REDEF
VY_PASS2_REF.OU.L_STOP
      5706**DCL      5707--REDEF
VY_PASS2_REF.OU.MAX
      5704**DCL      5705--REDEF
VY_PASS2_REF.OU.SIZE
      5707**DCL      5708--REDEF
VY_PASS2_REF.SAT.COUNT
      5711**DCL      5712--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5713**DCL      5714--REDEF
VY_PASS2_REF.SAT.L_START
      5709**DCL      5710--REDEF
VY_PASS2_REF.SAT.L_STOP
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:84   
      5710**DCL      5711--REDEF
VY_PASS2_REF.SAT.MAX
      5708**DCL      5709--REDEF
VY_PASS2_REF.UNSAT.L_START
      5715**DCL      5716--REDEF
VY_PASS2_REF.UNSAT.L_STOP
      5716**DCL      5717--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5717**DCL      5718--REDEF
VY_PASS2_REF.UNSAT.MAX
      5714**DCL      5715--REDEF
VY_PASS2_REF.UNSAT.PAGE#
      5719**DCL      5720--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5718**DCL      5719--REDEF
VY_PROGRAM_BIAS.A
      5386**DCL      5386--REDEF
VY_P_PCB_MAIN.OUT$
      4854**DCL     12262>>CALL
VY_RU_HEAD.DATA_SEGMENT
      5354**DCL      5354--REDEF
VY_RU_HEAD.L
      5350**DCL      5351--REDEF
VY_RU_HEAD.MAP_BITS
      5351**DCL      5353--REDEF
VY_RU_HEAD.PBIT
      5347**DCL      5347--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
      5364**DCL      5364--REDEF
VY_RU_HEAD_BUF.L
      5359**DCL      5360--REDEF
VY_RU_HEAD_BUF.MAP_BITS
      5361**DCL      5363--REDEF
VY_RU_HEAD_BUF.PBIT
      5356**DCL      5357--REDEF
VY_R_FPT_OPEN
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:85   
     11109**DCL     12030--ASSIGN
VY_R_FPT_OPEN.ACSVEH_
     11111**DCL     11112--REDEF
VY_R_FPT_OPEN.ALTKEYS_
     11117**DCL     11118--REDEF   11118--REDEF
VY_R_FPT_OPEN.HDR_
     11116**DCL     11117--REDEF
VY_R_FPT_OPEN.TAB_
     11115**DCL     11116--REDEF
VY_R_FPT_OPEN.UHL_
     11109**DCL     11110--REDEF   11110--REDEF
VY_R_FPT_OPEN.V
     11118**DCL     11109--DCLINIT
VY_R_FPT_OPEN.V.FSN#
     11149**DCL     11149--REDEF   11149--REDEF
VY_R_FPT_OPEN.V.IXTNSIZE#
     11137**DCL     12034<<ASSIGN
VY_R_FPT_OPEN.V.XTNSIZE#
     11137**DCL     12033<<ASSIGN
VY_R_FPT_OPEN.WSN_
     11115**DCL     11115--REDEF
VY_R_KEY_BUF.FORM0
      5226**DCL      5230--REDEF    5236--REDEF
VY_SI_KEY_BUF.KEY
      5734**DCL      5734--REDEF
VY_SPC.B$.MINE
      5729**DCL      5730--REDEF
VY_SPC.B$.NAME
      5726**DCL      5726--REDEF
VY_SPC.B$.SKIP
      5728**DCL      5729--REDEF
VY_SPC.B$.VALUE
      5727**DCL      5728--REDEF
VY_SPC.SEG.NAME
      5721**DCL      5722--REDEF
VY_SPC.SEG.VALUE
PL6.E3A0      #001=VYF$OPEN File=VYF$OPEN.:E05TSI                                WED 07/30/97 08:53 Page:86   
      5722**DCL      5723--REDEF
VY_SRCH_LST$
      5375**DCL     12110>>ASSIGN
VY_TSX0_OVERLAY.H
      5693**DCL      5694--REDEF
VY_UNWIND
      5738**DCL     12303>>UNWIND  12322>>UNWIND
WHERE$
     11442**DCL     12166<<ASSIGN  12167>>ASSIGN  12168>>ASSIGN  12168>>ASSIGN
WKSZ
     11401**DCL     12258<<ASSIGN  12259<>CALL    12265<>CALL
WORK$
     11441**DCL     12165<<ASSIGN  12169>>IF      12170>>CALLBLT

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:87   
      366        1        /*T***********************************************************/
      367        2        /*T*                                                         */
      368        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      369        4        /*T*                                                         */
      370        5        /*T***********************************************************/
      371        6        VYF$CLOSE:
      372        7            PROC( CURR_P$, TYPE, MODE );
      373        8        %INCLUDE VY_INC_C;
      374     9184        %B$TCB;
      375     9187        %B$ALT;
      376     9195        %F$DCB;
      377     9252        %INCLUDE B_ERRORS_C;
      378    10379        %INCLUDE VY_PSUBS_C;
      379    10440        %VY$LST;

             10452    1   /*******************************************************************************
             10453    1   *                                                                              *
             10454    1   *                          VY$LST                                                 *
             10455    1   *                                                                              *
             10456    1   *******************************************************************************/

             10461    1   DCL 1 VY$LST                        ALIGNED BASED,
             10462    1         2 LINK$        PTR,               /* Link to next item                  */
             10463    1         2 TYPE         UBIN( 18) UNAL,    /* Type                               */
             10464    1         2 SUB_TYPE     UBIN( 18) UNAL,    /* Sub-type                           */
             10465    1         2 OBJECT_NAME$ PTR,               /* Pointer to object unit name        */
             10466    1         2 SC_HEAD$     PTR,               /* Head pointer to section link list  */
             10467    1         2 SC_TAIL$     PTR,               /* Tail pointer to section link list  */
             10468    1         2 P,
             10469    1           3 NAME_       ALIGNED,
             10470    1             4 BOUND      UBIN(20)  UNAL,
             10471    1             4 FLAGSV     UBIN(11)  UNAL,
             10472    1             4 *          BIT(5)    UNAL,
             10473    1             4 NAME$      PTR,
             10474    1           3 ACCT_       ALIGNED,
             10475    1             4 BOUND      UBIN(20)  UNAL,
             10476    1             4 FLAGSV     UBIN(11)  UNAL,
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:88   
             10477    1             4 *          BIT(5)    UNAL,
             10478    1             4 ACCT$      PTR,
             10479    1           3 PASS_       ALIGNED,
             10480    1             4 BOUND      UBIN(20)  UNAL,
             10481    1             4 FLAGSV     UBIN(11)  UNAL,
             10482    1             4 *          BIT(5)    UNAL,
             10483    1             4 PASS$      PTR,
             10484    1           3 SN_         ALIGNED,
             10485    1             4 BOUND      UBIN(20)  UNAL,
             10486    1             4 FLAGSV     UBIN(11)  UNAL,
             10487    1             4 *          BIT(5)    UNAL,
             10488    1             4 SN$        PTR,
             10489    1           3 WSN_        ALIGNED,
             10490    1             4 BOUND      UBIN(20)  UNAL,
             10491    1             4 FLAGSV     UBIN(11)  UNAL,
             10492    1             4 *          BIT(5)    UNAL,
             10493    1             4 WSN$       PTR,
             10494    1           3 B           ALIGNED,
             10495    1             4 RES        BIT(1)    UNAL,
             10496    1             4 ASN        BIT(1)    UNAL,
             10497    1             4 *          BIT(34)   UNAL,
             10498    1           3 RES         CHAR(4)   ALIGNED,
             10499    1           3 ASN         UBIN(36)  ALIGNED;
      380    10502        %EJECT;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:89   
      381    10503        %FPT_CLOSE( FPTN=VY_O_FPT_CLOSE,
      382    10504         DCB=M$OF,
      383    10505         STCLASS="STATIC SYMDEF");
      384    10547        %FPT_CLOSE( FPTN=VY_R_FPT_CLOSE,
      385    10548         DCB=M$RF,
      386    10549         STCLASS="STATIC SYMDEF");
      387    10591        %FPT_CLOSE( FPTN=VY_EI_FPT_CLOSE,
      388    10592         DCB=M$EI,
      389    10593         STCLASS="STATIC SYMDEF");
      390    10635         /**/
      391    10636         /**/
      392    10637         /**/
      393    10638    1   DCL M$OF DCB;
      394    10639    1   DCL M$RF DCB;
      395    10640    1   DCL M$EI DCB;
      396    10641         /**/
      397    10642         /**/
      398    10643        %FPT_CLOSE( FPTN=F$C, STCLASS="BASED(FPT$)");
      399    10685        %E;

             10693    1   /*******************************************************************************
             10694    1   *                                                                              *
             10695    1   *                          ENTRY                                                 *
             10696    1   *                                                                              *
             10697    1   *******************************************************************************/

      400    10701        %ENTRIES;
      401    10716        %P;

             10724    1   /*******************************************************************************
             10725    1   *                                                                              *
             10726    1   *                          PARAMETERS                                              *
             10727    1   *                                                                              *
             10728    1   *******************************************************************************/

      402    10732        %U;

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:90   
             10740    1   /*******************************************************************************
             10741    1   *                                                                              *
             10742    1   *                          UBIN                                                 *
             10743    1   *                                                                              *
             10744    1   *******************************************************************************/

      403    10748    1   DCL ERR UBIN(36) ALIGNED STATIC/*AUTO*/;
      404    10749    1   DCL CURR_P$ PTR;
      405    10750    1   DCL TYPE UBIN(36);
      406    10751    1   DCL MODE UBIN(36);
      407    10752    1   DCL CURR$ PTR ALIGNED STATIC/*AUTO*/;
      408    10753    1   DCL FPT$ PTR ALIGNED STATIC/*AUTO*/;
      409    10754        %EJECT;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:91   
      410    10755    1       CURR$ = CURR_P$;
      411    10756    2       DO CASE(TYPE);
      412    10757    2       CASE( 0/*@OF*/ );
      413    10758    2           FPT$ = ADDR( VY_O_FPT_CLOSE );
      414    10759    2       CASE( 1/*@RF*/ );
      415    10760    2           FPT$ = ADDR( VY_R_FPT_CLOSE );
      416    10761    2           VY_R_FPT_CLOSE.V.OPER.RELG# = '1'B/*@TRUE_B*/;
      417    10762    2           VY_R_FPT_CLOSE.V.OPER.CHGATT# = '0'B/*@FALSE_B*/;
      418    10763    3           DO CASE( VY_COMMAND );
      419    10764    3           CASE( 3/*@C_COPY_KEY_WORD*/ );
      420    10765    3               CALL CHK_ATTR( 'LE' );
      421    10766    3           CASE( 4/*@C_EXTRACT_KEY_WORD*/ );
      422    10767    3               CALL CHK_ATTR( 'O ' );
      423    10768    3               END; /* Do case( VY_COMMAND ); */
      424    10769    2       CASE( 2/*@LF*/ );
      425    10770    2           FPT$ = ADDR( VY_O_FPT_CLOSE );
      426    10771    2       CASE( 3/*@SF*/ );
      427    10772    2           FPT$ = ADDR( VY_EI_FPT_CLOSE );
      428    10773    2       CASE(ELSE);
      429    10774        /*E*  ERROR: VYF-E$INTERNAL_CLOSE_TYPE_VY-0
      430    10775              MESSAGE: Internal link error. Bad type passed to VYF$CLOSE: Type = %U1.
      431    10776              DESCRIPTION: Self-explanatory.
      432    10777        */
      433    10778                %NUMBER(
      434    10779                NUM1=TYPE, BASE1=10, SIZE1=12 );
      435    10796                %SCREAM(
      436    10797                ERR#=%E$INTERNAL_CLOSE_TYPE_VY,
      437    10798                LEVEL=%@E$F_VY,
      438    10799                MID="'F'");
      439    10802    2           END;
      440    10803    1       F$C.NAME_ = CURR$ -> VY$LST.P.NAME_;
      441    10804    1       F$C.PASS_ = CURR$ -> VY$LST.P.PASS_;
      442    10805    1       F$C.SN_ = CURR$ -> VY$LST.P.SN_;
      443    10806    1       F$C.V.DISP# = MODE;
      444    10807    1       CALL M$CLOSE( F$C ) ALTRET(ERROR);
      445    10808    1       RETURN;
      446    10809    1   ERROR:;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:92   
      447    10810    1       ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/;
      448    10811    1       IF ERR = 150 THEN RETURN;
      449    10812    1       CALL M$MERC ALTRET( MERC_ERROR );
      450    10813    1       RETURN;
      451    10814    1   MERC_ERROR:
      452    10815    1       CALL VYE$MERC;
      453    10816        %EJECT;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:93   
      454    10817    1   CHK_ATTR: PROC( ATTR );
      455    10818    2   DCL ATTR CHAR(2) ALIGNED;
      456    10819         /**/
      457    10820         /**/
      458    10821    3       DO CASE( VY_ON_OVER );
      459    10822    3       CASE( 1/*@C_ON_KEY_WORD*/,
      460    10823    3          4/*@C_OVER_KEY_WORD*/ );
      461    10824    3   DO_TYPING:
      462    10825    3           VY_R_FPT_CLOSE.V.OPER.CHGATT# = '1'B/*@TRUE_B*/;
      463    10826    3           VY_R_FPT_CLOSE.V.TYPE# = ATTR;
      464    10827    3       CASE( 3/*@C_INTO_KEY_WORD*/,
      465    10828    3              2/*@C_ADDTO_KEY_WORD*/ );
      466    10829    3           IF ~M$RF$ -> F$DCB.FEXT THEN GOTO DO_TYPING;
      467    10830    3           END;
      468    10831    2   END CHK_ATTR;
      469    10832
      470    10833
      471    10834
      472    10835    1   END VYF$CLOSE;

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:94   
--  Include file information  --

   VY_PSUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYF$CLOSE.

   Procedure VYF$CLOSE requires 123 words for executable code.
   Procedure VYF$CLOSE requires 14 words of local(AUTO) storage.

    No errors detected in file VYF$OPEN.:E05TSI    .

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:95   

 Object Unit name= VYF$CLOSE                                  File name= VYF$OPEN.:E05TOU
 UTS= JUL 30 '97 08:54:56.92 WED                              Compiler= PL-6/E31         Sev=      00
 SharedLib= :SHARED_SYSTEM                                    Alt SharedLib=


    ****  Control sections  ****

 Sect   Type Bound  Init  Size OctSiz  Section name(segment info)
    0   DCB   even  none     0      0  M$UC
    1   Data  even  none    93    135  VYF$CLOSE
    2   DCB   even  none     0      0  M$OF
    3   DCB   even  none     0      0  M$RF
    4   DCB   even  none     0      0  M$EI
    5  RoData even  UTS      2      2  VYF$CLOSE
    6   Proc  even  none   123    173  VYF$CLOSE
    7  RoData even  none    16     20  VYF$CLOSE

    ****  Entry defs  ****

                              Check   Calling
                             calling  sequence
  Sect OctLoc Primary Altret sequence   type   Parms  Name
     6      0   yes            yes      Std        3  VYF$CLOSE

  ****  Data defs  ****

 Sect OctLoc  Name                           Sect OctLoc  Name
    1      0  VY_O_FPT_CLOSE                     1     36  VY_R_FPT_CLOSE
    1     74  VY_EI_FPT_CLOSE
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:96   

  ****  Entry refs  ****

         Check        Calling
        calling       sequence
Altret sequence SRef   type   Args  Name
         yes           Std       0 VYE$MERC
         yes           Std       5 VYD$B2C
         yes           Std       4 VYE$ERROR
                       nStd      0 X66_AUTO_3
                       Std       0 B_CONSPOOL_D
                       nStd      0 X66_ARET

  ****  Data refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     M$UC                                  B$TCB$                                VY_COMMAND
     VY_ON_OVER                            VY_ERRORS                             VY_EFIELD1
     VY_PAR_UNWIND                         M$RF$                                 M$OF
     M$RF                                  M$EI                                  B_VECTNIL

  ****  Segment refs  ****

  Flags:  r = read only, s = secondary
Flgs Name                             Flgs Name                             Flgs Name
     ISSID                                 NULLSID
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:97   


      366        1        /*T***********************************************************/
      367        2        /*T*                                                         */
      368        3        /*T* Copyright (c) Bull HN Information Systems Inc., 1997    */
      369        4        /*T*                                                         */
      370        5        /*T***********************************************************/
      371        6        VYF$CLOSE:
      372        7            PROC( CURR_P$, TYPE, MODE );

      7  6 000000   000000 700200 xent  VYF$CLOSE    TSX0  ! X66_AUTO_3
         6 000001   000016 000003                    ZERO    14,3

      373        8        %INCLUDE VY_INC_C;
      374     9184        %B$TCB;
      375     9187        %B$ALT;
      376     9195        %F$DCB;
      377     9252        %INCLUDE B_ERRORS_C;
      378    10379        %INCLUDE VY_PSUBS_C;
      379    10440        %VY$LST;

             10452    1   /*******************************************************************************
             10453    1   *                                                                              *
             10454    1   *                          VY$LST                                                 *
             10455    1   *                                                                              *
             10456    1   *******************************************************************************/

             10461    1   DCL 1 VY$LST                        ALIGNED BASED,
             10462    1         2 LINK$        PTR,               /* Link to next item                  */
             10463    1         2 TYPE         UBIN( 18) UNAL,    /* Type                               */
             10464    1         2 SUB_TYPE     UBIN( 18) UNAL,    /* Sub-type                           */
             10465    1         2 OBJECT_NAME$ PTR,               /* Pointer to object unit name        */
             10466    1         2 SC_HEAD$     PTR,               /* Head pointer to section link list  */
             10467    1         2 SC_TAIL$     PTR,               /* Tail pointer to section link list  */
             10468    1         2 P,
             10469    1           3 NAME_       ALIGNED,
             10470    1             4 BOUND      UBIN(20)  UNAL,
             10471    1             4 FLAGSV     UBIN(11)  UNAL,
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:98   
             10472    1             4 *          BIT(5)    UNAL,
             10473    1             4 NAME$      PTR,
             10474    1           3 ACCT_       ALIGNED,
             10475    1             4 BOUND      UBIN(20)  UNAL,
             10476    1             4 FLAGSV     UBIN(11)  UNAL,
             10477    1             4 *          BIT(5)    UNAL,
             10478    1             4 ACCT$      PTR,
             10479    1           3 PASS_       ALIGNED,
             10480    1             4 BOUND      UBIN(20)  UNAL,
             10481    1             4 FLAGSV     UBIN(11)  UNAL,
             10482    1             4 *          BIT(5)    UNAL,
             10483    1             4 PASS$      PTR,
             10484    1           3 SN_         ALIGNED,
             10485    1             4 BOUND      UBIN(20)  UNAL,
             10486    1             4 FLAGSV     UBIN(11)  UNAL,
             10487    1             4 *          BIT(5)    UNAL,
             10488    1             4 SN$        PTR,
             10489    1           3 WSN_        ALIGNED,
             10490    1             4 BOUND      UBIN(20)  UNAL,
             10491    1             4 FLAGSV     UBIN(11)  UNAL,
             10492    1             4 *          BIT(5)    UNAL,
             10493    1             4 WSN$       PTR,
             10494    1           3 B           ALIGNED,
             10495    1             4 RES        BIT(1)    UNAL,
             10496    1             4 ASN        BIT(1)    UNAL,
             10497    1             4 *          BIT(34)   UNAL,
             10498    1           3 RES         CHAR(4)   ALIGNED,
             10499    1           3 ASN         UBIN(36)  ALIGNED;
      380    10502        %EJECT;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:99   
      381    10503        %FPT_CLOSE( FPTN=VY_O_FPT_CLOSE,
      382    10504         DCB=M$OF,
      383    10505         STCLASS="STATIC SYMDEF");
      384    10547        %FPT_CLOSE( FPTN=VY_R_FPT_CLOSE,
      385    10548         DCB=M$RF,
      386    10549         STCLASS="STATIC SYMDEF");
      387    10591        %FPT_CLOSE( FPTN=VY_EI_FPT_CLOSE,
      388    10592         DCB=M$EI,
      389    10593         STCLASS="STATIC SYMDEF");
      390    10635         /**/
      391    10636         /**/
      392    10637         /**/
      393    10638    1   DCL M$OF DCB;
      394    10639    1   DCL M$RF DCB;
      395    10640    1   DCL M$EI DCB;
      396    10641         /**/
      397    10642         /**/
      398    10643        %FPT_CLOSE( FPTN=F$C, STCLASS="BASED(FPT$)");
      399    10685        %E;

             10693    1   /*******************************************************************************
             10694    1   *                                                                              *
             10695    1   *                          ENTRY                                                 *
             10696    1   *                                                                              *
             10697    1   *******************************************************************************/

      400    10701        %ENTRIES;
      401    10716        %P;

             10724    1   /*******************************************************************************
             10725    1   *                                                                              *
             10726    1   *                          PARAMETERS                                             *
             10727    1   *                                                                              *
             10728    1   *******************************************************************************/

      402    10732        %U;

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:100  
             10740    1   /*******************************************************************************
             10741    1   *                                                                              *
             10742    1   *                          UBIN                                                 *
             10743    1   *                                                                              *
             10744    1   *******************************************************************************/

      403    10748    1   DCL ERR UBIN(36) ALIGNED STATIC/*AUTO*/;
      404    10749    1   DCL CURR_P$ PTR;
      405    10750    1   DCL TYPE UBIN(36);
      406    10751    1   DCL MODE UBIN(36);
      407    10752    1   DCL CURR$ PTR ALIGNED STATIC/*AUTO*/;
      408    10753    1   DCL FPT$ PTR ALIGNED STATIC/*AUTO*/;
      409    10754        %EJECT;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:101  
      410    10755    1       CURR$ = CURR_P$;

  10755  6 000002   200003 470500                    LDP0    @CURR_P$,,AUTO
         6 000003   000000 236100                    LDQ     0,,PR0
         6 000004   000133 756000 1                  STQ     CURR$

      411    10756    2       DO CASE(TYPE);

  10756  6 000005   200004 471500                    LDP1    @TYPE,,AUTO
         6 000006   100000 235100                    LDA     0,,PR1
         6 000007   000004 115007                    CMPA    4,DL
         6 000010   000012 602005 6                  TNC     s:10756+5,AL
         6 000011   000060 710000 6                  TRA     s:10785
         6 000012   000016 710000 6                  TRA     s:10758
         6 000013   000021 710000 6                  TRA     s:10760
         6 000014   000052 710000 6                  TRA     s:10770
         6 000015   000055 710000 6                  TRA     s:10772

      412    10757    2       CASE( 0/*@OF*/ );

      413    10758    2           FPT$ = ADDR( VY_O_FPT_CLOSE );

  10758  6 000016   000000 236000 7                  LDQ     0
         6 000017   000134 756000 1                  STQ     FPT$
         6 000020   000077 710000 6                  TRA     s:10803

      414    10759    2       CASE( 1/*@RF*/ );

      415    10760    2           FPT$ = ADDR( VY_R_FPT_CLOSE );

  10760  6 000021   000001 236000 7                  LDQ     1
         6 000022   000134 756000 1                  STQ     FPT$

      416    10761    2           VY_R_FPT_CLOSE.V.OPER.RELG# = '1'B/*@TRUE_B*/;

  10761  6 000023   200000 236007                    LDQ     65536,DL
         6 000024   000070 256000 1                  ORSQ    VY_R_FPT_CLOSE+26
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:102  

      417    10762    2           VY_R_FPT_CLOSE.V.OPER.CHGATT# = '0'B/*@FALSE_B*/;

  10762  6 000025   000002 236000 7                  LDQ     2
         6 000026   000070 356000 1                  ANSQ    VY_R_FPT_CLOSE+26

      418    10763    3           DO CASE( VY_COMMAND );

  10763  6 000027   000000 235000 xsym               LDA     VY_COMMAND
         6 000030   000005 115007                    CMPA    5,DL
         6 000031   000033 602005 6                  TNC     s:10763+4,AL
         6 000032   000077 710000 6                  TRA     s:10803
         6 000033   000051 710000 6                  TRA     s:10768
         6 000034   000051 710000 6                  TRA     s:10768
         6 000035   000051 710000 6                  TRA     s:10768
         6 000036   000040 710000 6                  TRA     s:10765
         6 000037   000045 710000 6                  TRA     s:10767

      419    10764    3           CASE( 3/*@C_COPY_KEY_WORD*/ );

      420    10765    3               CALL CHK_ATTR( 'LE' );

  10765  6 000040   000003 236000 7                  LDQ     3
         6 000041   200007 756100                    STQ     @MODE+2,,AUTO
         6 000042   000143 701000 6                  TSX1    CHK_ATTR
         6 000043   000000 011000                    NOP     0
         6 000044   000077 710000 6                  TRA     s:10803

      421    10766    3           CASE( 4/*@C_EXTRACT_KEY_WORD*/ );

      422    10767    3               CALL CHK_ATTR( 'O ' );

  10767  6 000045   000004 236000 7                  LDQ     4
         6 000046   200007 756100                    STQ     @MODE+2,,AUTO
         6 000047   000143 701000 6                  TSX1    CHK_ATTR
         6 000050   000000 011000                    NOP     0

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:103  
      423    10768    3               END; /* Do case( VY_COMMAND ); */

  10768  6 000051   000077 710000 6                  TRA     s:10803

      424    10769    2       CASE( 2/*@LF*/ );

      425    10770    2           FPT$ = ADDR( VY_O_FPT_CLOSE );

  10770  6 000052   000000 236000 7                  LDQ     0
         6 000053   000134 756000 1                  STQ     FPT$
         6 000054   000077 710000 6                  TRA     s:10803

      426    10771    2       CASE( 3/*@SF*/ );

      427    10772    2           FPT$ = ADDR( VY_EI_FPT_CLOSE );

  10772  6 000055   000005 236000 7                  LDQ     5
         6 000056   000134 756000 1                  STQ     FPT$
         6 000057   000077 710000 6                  TRA     s:10803

      428    10773    2       CASE(ELSE);

      429    10774        /*E*  ERROR: VYF-E$INTERNAL_CLOSE_TYPE_VY-0
      430    10775              MESSAGE: Internal link error. Bad type passed to VYF$CLOSE: Type = %U1.
      431    10776              DESCRIPTION: Self-explanatory.
      432    10777        */
      433    10778                %NUMBER(
      434    10779                NUM1=TYPE, BASE1=10, SIZE1=12 );

  10785  6 000060   000006 236000 7                  LDQ     6
         6 000061   200014 756100                    STQ     @ATTR+5,,AUTO
         6 000062   200004 236100                    LDQ     @TYPE,,AUTO
         6 000063   000007 235000 7                  LDA     7
         6 000064   200012 757100                    STAQ    @ATTR+3,,AUTO
         6 000065   000010 237000 7                  LDAQ    8
         6 000066   200010 757100                    STAQ    @ATTR+1,,AUTO
         6 000067   200010 630500                    EPPR0   @ATTR+1,,AUTO
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:104  
         6 000070   000023 631400 xsym               EPPR1   B_VECTNIL+19
         6 000071   000000 701000 xent               TSX1    VYD$B2C
         6 000072   000000 011000                    NOP     0

      435    10796                %SCREAM(
      436    10797                ERR#=%E$INTERNAL_CLOSE_TYPE_VY,
      437    10798                LEVEL=%@E$F_VY,
      438    10799                MID="'F'");

  10800  6 000073   000014 630400 7                  EPPR0   12
         6 000074   000022 631400 xsym               EPPR1   B_VECTNIL+18
         6 000075   000000 701000 xent               TSX1    VYE$ERROR
         6 000076   000000 011000                    NOP     0

      439    10802    2           END;

      440    10803    1       F$C.NAME_ = CURR$ -> VY$LST.P.NAME_;

  10803  6 000077   000133 470400 1                  LDP0    CURR$
         6 000100   000134 471400 1                  LDP1    FPT$
         6 000101   000100 100500                    MLR     fill='000'O
         6 000102   000005 000010                    ADSC9   5,,PR0                   cn=0,n=8
         6 000103   100006 000010                    ADSC9   6,,PR1                   cn=0,n=8

      441    10804    1       F$C.PASS_ = CURR$ -> VY$LST.P.PASS_;

  10804  6 000104   000100 100500                    MLR     fill='000'O
         6 000105   000011 000010                    ADSC9   9,,PR0                   cn=0,n=8
         6 000106   100010 000010                    ADSC9   8,,PR1                   cn=0,n=8

      442    10805    1       F$C.SN_ = CURR$ -> VY$LST.P.SN_;

  10805  6 000107   000100 100500                    MLR     fill='000'O
         6 000110   000013 000010                    ADSC9   11,,PR0                  cn=0,n=8
         6 000111   100002 000010                    ADSC9   2,,PR1                   cn=0,n=8

      443    10806    1       F$C.V.DISP# = MODE;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:105  

  10806  6 000112   200005 473500                    LDP3    @MODE,,AUTO
         6 000113   300000 236100                    LDQ     0,,PR3
         6 000114   100032 552104                    STBQ    26,'04'O,PR1

      444    10807    1       CALL M$CLOSE( F$C ) ALTRET(ERROR);

  10807  6 000115   100000 630500                    EPPR0   0,,PR1
         6 000116   450001 713400                    CLIMB   alt,close
         6 000117   406000 401760                    pmme    nvectors=13
         6 000120   000122 702000 6                  TSX2    ERROR

      445    10808    1       RETURN;

  10808  6 000121   000000 702200 xent               TSX2  ! X66_ARET

  10806  6 000122                       ERROR        null
      446    10809    1   ERROR:;
      447    10810    1       ERR = B$TCB$ -> B$TCB.ALT$ -> B$ALT.ERR.ERR#/*@ALT_ERROR*/;

  10810  6 000122   000000 470400 xsym               LDP0    B$TCB$
         6 000123   000000 471500                    LDP1    0,,PR0
         6 000124   100102 236100                    LDQ     66,,PR1
         6 000125   000003 772000                    QRL     3
         6 000126   037777 376007                    ANQ     16383,DL
         6 000127   000132 756000 1                  STQ     ERR

      448    10811    1       IF ERR = 150 THEN RETURN;

  10811  6 000130   000226 116007                    CMPQ    150,DL
         6 000131   000133 601000 6                  TNZ     s:10812

  10811  6 000132   000000 702200 xent               TSX2  ! X66_ARET

      449    10812    1       CALL M$MERC ALTRET( MERC_ERROR );

  10812  6 000133   410007 713400                    CLIMB   alt,+4103
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:106  
         6 000134   000000 401760                    pmme    nvectors=0
         6 000135   000137 702000 6                  TSX2    MERC_ERROR

      450    10813    1       RETURN;

  10813  6 000136   000000 702200 xent               TSX2  ! X66_ARET

      451    10814    1   MERC_ERROR:
      452    10815    1       CALL VYE$MERC;

  10815  6 000137   000002 631400 xsym  MERC_ERROR   EPPR1   B_VECTNIL+2
         6 000140   000000 701000 xent               TSX1    VYE$MERC
         6 000141   000000 011000                    NOP     0
         6 000142   000172 710000 6                  TRA     s:10835

      453    10816        %EJECT;
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:107  
      454    10817    1   CHK_ATTR: PROC( ATTR );

  10817  6 000143   200006 741300       CHK_ATTR     STX1  ! @MODE+1,,AUTO

      455    10818    2   DCL ATTR CHAR(2) ALIGNED;
      456    10819         /**/
      457    10820         /**/
      458    10821    3       DO CASE( VY_ON_OVER );

  10821  6 000144   000000 235000 xsym               LDA     VY_ON_OVER
         6 000145   000005 115007                    CMPA    5,DL
         6 000146   000150 602005 6                  TNC     s:10821+4,AL
         6 000147   000170 710000 6                  TRA     s:10831
         6 000150   000170 710000 6                  TRA     s:10831
         6 000151   000155 710000 6                  TRA     DO_TYPING
         6 000152   000163 710000 6                  TRA     s:10829
         6 000153   000163 710000 6                  TRA     s:10829
         6 000154   000155 710000 6                  TRA     DO_TYPING

      459    10822    3       CASE( 1/*@C_ON_KEY_WORD*/,

      460    10823    3          4/*@C_OVER_KEY_WORD*/ );
      461    10824    3   DO_TYPING:
      462    10825    3           VY_R_FPT_CLOSE.V.OPER.CHGATT# = '1'B/*@TRUE_B*/;

  10825  6 000155   400000 236007       DO_TYPING    LDQ     -131072,DL
         6 000156   000070 256000 1                  ORSQ    VY_R_FPT_CLOSE+26

      463    10826    3           VY_R_FPT_CLOSE.V.TYPE# = ATTR;

  10826  6 000157   200007 470500                    LDP0    @ATTR,,AUTO
         6 000160   000000 220100                    LDX0    0,,PR0
         6 000161   000071 440000 1                  SXL0    VY_R_FPT_CLOSE+27
         6 000162   000170 710000 6                  TRA     s:10831

      464    10827    3       CASE( 3/*@C_INTO_KEY_WORD*/,

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:108  
      465    10828    3              2/*@C_ADDTO_KEY_WORD*/ );
      466    10829    3           IF ~M$RF$ -> F$DCB.FEXT THEN GOTO DO_TYPING;

  10829  6 000163   000000 470400 xsym               LDP0    M$RF$
         6 000164   000064 236100                    LDQ     52,,PR0
         6 000165   400000 376003                    ANQ     -131072,DU
         6 000166   400000 676003                    ERQ     -131072,DU
         6 000167   000155 601000 6                  TNZ     DO_TYPING

      467    10830    3           END;

      468    10831    2   END CHK_ATTR;

  10831  6 000170   200006 221300                    LDX1  ! @MODE+1,,AUTO
         6 000171   000001 702211                    TSX2  ! 1,X1

      469    10832
      470    10833
      471    10834
      472    10835    1   END VYF$CLOSE;

  10835  6 000172   000000 702200 xent               TSX2  ! X66_ARET

PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:109  
--  Include file information  --

   VY_PSUBS_C.:E05TOU  is referenced.
   B_ERRORS_C.:E05TOU  is referenced.
   B$OBJECT_C.:E05TOU  is referenced.
   VY_DCB_R.:E05TOU  cannot be made into a system file and is referenced.
   VY_DATA_R.:E05TOU  cannot be made into a system file and is referenced.
   XU_MACRO_C.:E05TOU  is referenced.
   VY_FIXED_R.:E05TOU  cannot be made into a system file and is referenced.
   CP_6.:E05TOU  cannot be made into a system file and is referenced.
   VY_MACRO_C.:E05TOU  is referenced.
   VY_PERR_C.:E05TOU  is referenced.
   VY_SUBS_C.:E05TOU  is referenced.
   VY_INC_NO_C.:E05TOU  is referenced.
   VY_SWITCH_C.:E05TOU  is referenced.
   VY_INC_C.:E05TOU  is referenced.
   B$JIT_C.:E05TOU  was found in the system file and is never referenced.
   CP_6_C.:E05TOU  was found in the system file and is referenced.
      No diagnostics issued in procedure VYF$CLOSE.
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:110  

 **** Variables and constants ****

  ****  Section 001  Data  VYF$CLOSE

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

   133-0-0/w PTR         r     1 CURR$                    132-0-0/w UBIN        r     1 ERR
   134-0-0/w PTR         r     1 FPT$                      74-0-0/d STRC(1080)  r     1 VY_EI_FPT_CLOSE
     0-0-0/d STRC(1080)  r     1 VY_O_FPT_CLOSE            36-0-0/d STRC(1080)  r     1 VY_R_FPT_CLOSE

  ****  Auto variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     7-0-0/w PTR         r     1 @ATTR                      3-0-0/w PTR         r     1 @CURR_P$
     5-0-0/w PTR         r     1 @MODE                      4-0-0/w PTR         r     1 @TYPE
    *0-0-0/w CHAR(2)     r     1 ATTR                      *0-0-0/w PTR         r     1 CURR_P$
    *0-0-0/w UBIN        r     1 MODE                      *0-0-0/w UBIN        r     1 TYPE

  ****  SYMREF variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w PTR         r     1 B$TCB$                     0-0-0/w PTR         r     1 M$RF$
     0-0-0/w UBIN        r     1 VY_COMMAND                 0-0-0/w STRC(720)   r     1 VY_EFIELD1
     0-0-0/w UBIN        r     1 VY_ON_OVER

  ****  BASED and DCB variables  ****

  ****  Scalars and arrays  ****
OctLoc.c.b A Datatyp(siz) R M Lvl/name                 OctLoc.c.b A Datatyp(siz) R M Lvl/name

     0-0-0/w STRC(2448)  r     1 B$ALT                      0-0-0/w STRC(144)   r     1 B$TCB
     0-0-0/d STRC(1080)  r     1 F$C                        0-0-0/d ASTR(3528)  r     1 F$DCB
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:111  
     0-0-0N  NULL        r     1 M$EI                       0-0-0N  NULL        r     1 M$OF
     0-0-0N  NULL        r     1 M$RF                       0-0-0/w STRC(648)   r     1 VY$LST


   Procedure VYF$CLOSE requires 123 words for executable code.
   Procedure VYF$CLOSE requires 14 words of local(AUTO) storage.

    No errors detected in file VYF$OPEN.:E05TSI    .
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:112  
          *** CROSS REFERENCE LISTING ***
**     DENOTES     IDENTIFIER DEFINITION
<<                 IDENTIFIER'S VALUE SET
>>                 IDENTIFIER'S VALUE USED
<>                 IDENTIFIER SET AND/OR USED
--                 IDENTIFIER REFERENCED
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:113  
          MINI XREF LISTING

ATTR IN PROCEDURE CHK_ATTR
     10818**DCL     10817--PROC    10826>>ASSIGN
B$ALT.CODE
      9189**DCL      9189--REDEF    9190--REDEF    9190--REDEF
B$ALT.ERR.ERR#
      9191**DCL      9191--REDEF   10810>>ASSIGN
B$ALT.EVID
      9190**DCL      9190--REDEF    9190--REDEF
B$TCB.ALT$
      9185**DCL     10810>>ASSIGN
B$TCB$
      5335**DCL     10810>>ASSIGN
CHK_ATTR
     10817**PROC    10765--CALL    10767--CALL
CURR$
     10752**DCL     10755<<ASSIGN  10803>>ASSIGN  10804>>ASSIGN  10805>>ASSIGN
CURR_P$
     10749**DCL         6--PROC    10755>>ASSIGN
DO_TYPING IN PROCEDURE CHK_ATTR
     10825**LABEL   10829--GOTO
ERR
     10748**DCL     10810<<ASSIGN  10811>>IF
ERROR
     10806**LABEL   10807--CALLALT
F$C
     10666**DCL     10807<>CALL
F$C.NAME_
     10667**DCL     10803<<ASSIGN
F$C.PASS_
     10668**DCL     10804<<ASSIGN
F$C.SN_
     10666**DCL     10666--REDEF   10805<<ASSIGN
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:114  
F$C.UTL_
     10667**DCL     10667--REDEF
F$C.V.DISP#
     10675**DCL     10806<<ASSIGN
F$C.V.EXPIRE#
     10681**DCL     10681--REDEF
F$C.V.TYPE#
     10679**DCL     10679--REDEF
F$C.V.XTNSIZE#
     10676**DCL     10676--REDEF   10678--REDEF
F$DCB.ACTPOS
      9228**DCL      9228--REDEF
F$DCB.ARS#
      9202**DCL      9202--REDEF
F$DCB.ATTR
      9221**DCL      9222--REDEF
F$DCB.BORROW
      9236**DCL      9236--REDEF    9236--REDEF    9236--REDEF
F$DCB.DCBNAME.L
      9250**DCL      9250--IMP-SIZ
F$DCB.EOMCHAR#
      9206**DCL      9206--REDEF
F$DCB.FEXT
      9232**DCL     10829>>IF
F$DCB.FLDID
      9231**DCL      9231--REDEF
F$DCB.FORM$
      9225**DCL      9225--REDEF
F$DCB.FSECT
      9241**DCL      9241--REDEF
F$DCB.FSN#
      9218**DCL      9218--REDEF    9218--REDEF    9219--REDEF
F$DCB.HEADER$
      9224**DCL      9224--REDEF
F$DCB.IXTNSIZE#
      9222**DCL      9222--REDEF
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:115  
F$DCB.LASTSTA$
      9211**DCL      9211--REDEF
F$DCB.LVL
      9237**DCL      9237--REDEF
F$DCB.NAME#.C
      9212**DCL      9212--REDEF
F$DCB.NOEOF
      9234**DCL      9234--REDEF
F$DCB.NRECS#
      9223**DCL      9223--REDEF
F$DCB.NRECX
      9242**DCL      9242--REDEF
F$DCB.OHDR
      9234**DCL      9234--REDEF
F$DCB.ORG#
      9217**DCL      9217--REDEF
F$DCB.PRECNO
      9240**DCL      9240--REDEF
F$DCB.RCSZ
      9246**DCL      9246--REDEF
F$DCB.RES#
      9213**DCL      9213--REDEF
F$DCB.SETX
      9225**DCL      9225--REDEF
F$DCB.TAB$
      9225**DCL      9225--REDEF
F$DCB.TDA
      9239**DCL      9240--REDEF
F$DCB.WSN#
      9213**DCL      9213--REDEF
FPT$
     10753**DCL     10666--IMP-PTR 10758<<ASSIGN  10760<<ASSIGN  10770<<ASSIGN  10772<<ASSIGN  10803>>ASSIGN
     10804>>ASSIGN  10805>>ASSIGN  10806>>ASSIGN  10807>>CALL
M$CLOSE
      1605**DCL-ENT 10807--CALL
M$MERC
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:116  
      1661**DCL-ENT 10812--CALL
M$RF$
      5752**DCL     10829>>IF
MERC_ERROR
     10815**LABEL   10812--CALLALT
MODE
     10751**DCL         6--PROC    10806>>ASSIGN
TYPE
     10750**DCL         6--PROC    10756>>DOCASE  10785<>CALL
VY$LST.P.NAME_
     10469**DCL     10803>>ASSIGN
VY$LST.P.PASS_
     10479**DCL     10804>>ASSIGN
VY$LST.P.SN_
     10484**DCL     10805>>ASSIGN
VYD$B2C
     10709**DCL-ENT 10785--CALL
VYE$ERROR
     10702**DCL-ENT 10800--CALL
VYE$MERC
     10704**DCL-ENT 10815--CALL
VY_BIAS.A
      5384**DCL      5384--REDEF
VY_CBUF.CHARS_A
      5375**DCL      5375--REDEF
VY_COMMAND
      5375**DCL     10763>>DOCASE
VY_EBUF.CHARS_A
      5676**DCL      5677--REDEF
VY_EFIELD1.CHARS
      5677**DCL      5677--REDEF
VY_EFIELD1.CHARS_A
      5677**DCL     10785<>CALL
VY_EFIELD2.CHARS
      5678**DCL      5678--REDEF
VY_EFIELD3.CHARS
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:117  
      5679**DCL      5679--REDEF
VY_EI_FPT_CLOSE
     10616**DCL     10772--ASSIGN
VY_EI_FPT_CLOSE.SN_
     10616**DCL     10616--REDEF
VY_EI_FPT_CLOSE.UTL_
     10617**DCL     10617--REDEF
VY_EI_FPT_CLOSE.V
     10621**DCL     10616--DCLINIT
VY_EI_FPT_CLOSE.V.EXPIRE#
     10631**DCL     10631--REDEF
VY_EI_FPT_CLOSE.V.TYPE#
     10629**DCL     10629--REDEF
VY_EI_FPT_CLOSE.V.XTNSIZE#
     10626**DCL     10626--REDEF   10628--REDEF
VY_ERRORS
      5380**DCL      5382--REDEF
VY_ERRORS.CONFLICT_A
      5381**DCL      5382--REDEF
VY_ERRORS.UNSAT_A
      5380**DCL      5381--REDEF
VY_IMAGE_DATA.CPAGE#_A
      5268**DCL      5269--REDEF
VY_IMAGE_DATA.NODE_A$
      5280**DCL      5281--REDEF
VY_IMAGE_DATA.START_A$
      5272**DCL      5273--REDEF
VY_IMAGE_DATA.STOP_A$
      5276**DCL      5277--REDEF
VY_IMAGE_PROC.CPAGE#_A
      5291**DCL      5292--REDEF
VY_IMAGE_PROC.NODE_A$
      5303**DCL      5304--REDEF
VY_IMAGE_PROC.START_A$
      5295**DCL      5296--REDEF
VY_IMAGE_PROC.STOP_A$
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:118  
      5299**DCL      5300--REDEF
VY_IMAGE_ROS.CPAGE#_A
      5314**DCL      5315--REDEF
VY_IMAGE_ROS.NODE_A$
      5326**DCL      5327--REDEF
VY_IMAGE_ROS.START_A$
      5318**DCL      5319--REDEF
VY_IMAGE_ROS.STOP_A$
      5322**DCL      5323--REDEF
VY_MAP_HDR.CHARS
      5741**DCL      5742--REDEF    5742--REDEF
VY_MAP_LIT_LO_FPT_WRITE.STATION_
      5070**DCL      5070--REDEF
VY_MAP_LIT_LO_FPT_WRITE.V.DVBYTE.VFC#
      5077**DCL      5077--REDEF
VY_MAP_LO_FPT_WRITE.STATION_
      5039**DCL      5039--REDEF
VY_MAP_LO_FPT_WRITE.V.DVBYTE.VFC#
      5046**DCL      5046--REDEF
VY_MBUF.CHARS
      5740**DCL      5741--REDEF    5741--REDEF
VY_M_VECTOR.F
      5109**DCL      5113--REDEF
VY_M_VECTOR_DP.F
      5144**DCL      5148--REDEF
VY_O.DUPL_ATTCH
      5522**DCL      5526--REDEF
VY_O.MAP_ATTCH
      5510**DCL      5521--REDEF
VY_O.PRIMARY_OPTION
      5504**DCL      5509--REDEF
VY_O.SEV_ATTCH
      5527**DCL      5529--REDEF
VY_OD.DUPL_ATTCH
      5666**DCL      5670--REDEF
VY_OD.MAP_ATTCH
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:119  
      5654**DCL      5665--REDEF
VY_OD.PRIMARY_OPTION
      5648**DCL      5653--REDEF
VY_OD.SEV_ATTCH
      5671**DCL      5673--REDEF
VY_OL_KEY_BUF.FORM0
      5177**DCL      5180--REDEF    5187--REDEF
VY_ON_OVER
      5375**DCL     10821>>DOCASE
VY_OU_HEAD.REC_A
      5365**DCL      5366--REDEF
VY_O_FPT_CLOSE
     10528**DCL     10758--ASSIGN  10770--ASSIGN
VY_O_FPT_CLOSE.SN_
     10528**DCL     10528--REDEF
VY_O_FPT_CLOSE.UTL_
     10529**DCL     10529--REDEF
VY_O_FPT_CLOSE.V
     10533**DCL     10528--DCLINIT
VY_O_FPT_CLOSE.V.EXPIRE#
     10543**DCL     10543--REDEF
VY_O_FPT_CLOSE.V.TYPE#
     10541**DCL     10541--REDEF
VY_O_FPT_CLOSE.V.XTNSIZE#
     10538**DCL     10538--REDEF   10540--REDEF
VY_O_KEY_BUF.FORM0
      5154**DCL      5157--REDEF    5164--REDEF
VY_O_KEY_BUF_L.FORM0
      5200**DCL      5203--REDEF    5210--REDEF
VY_PAR_UNWIND
      5735**DCL      5735--REDEF
VY_PASS2_REF.OU.L_START
      5702**DCL      5703--REDEF
VY_PASS2_REF.OU.L_STOP
      5703**DCL      5704--REDEF
VY_PASS2_REF.OU.MAX
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:120  
      5701**DCL      5702--REDEF
VY_PASS2_REF.OU.SIZE
      5704**DCL      5705--REDEF
VY_PASS2_REF.SAT.COUNT
      5708**DCL      5709--REDEF
VY_PASS2_REF.SAT.ENT_SIZE
      5710**DCL      5711--REDEF
VY_PASS2_REF.SAT.L_START
      5706**DCL      5707--REDEF
VY_PASS2_REF.SAT.L_STOP
      5707**DCL      5708--REDEF
VY_PASS2_REF.SAT.MAX
      5705**DCL      5706--REDEF
VY_PASS2_REF.UNSAT.L_START
      5712**DCL      5713--REDEF
VY_PASS2_REF.UNSAT.L_STOP
      5713**DCL      5714--REDEF
VY_PASS2_REF.UNSAT.L_WHERE
      5714**DCL      5715--REDEF
VY_PASS2_REF.UNSAT.MAX
      5711**DCL      5712--REDEF
VY_PASS2_REF.UNSAT.PAGE#
      5716**DCL      5717--REDEF
VY_PASS2_REF.UNSAT.SIZE
      5715**DCL      5716--REDEF
VY_PROGRAM_BIAS.A
      5383**DCL      5383--REDEF
VY_RU_HEAD.DATA_SEGMENT
      5351**DCL      5351--REDEF
VY_RU_HEAD.L
      5347**DCL      5348--REDEF
VY_RU_HEAD.MAP_BITS
      5348**DCL      5350--REDEF
VY_RU_HEAD.PBIT
      5344**DCL      5344--REDEF
VY_RU_HEAD_BUF.DATA_SEGMENT
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:121  
      5361**DCL      5361--REDEF
VY_RU_HEAD_BUF.L
      5356**DCL      5357--REDEF
VY_RU_HEAD_BUF.MAP_BITS
      5358**DCL      5360--REDEF
VY_RU_HEAD_BUF.PBIT
      5353**DCL      5354--REDEF
VY_R_FPT_CLOSE
     10572**DCL     10760--ASSIGN
VY_R_FPT_CLOSE.SN_
     10572**DCL     10572--REDEF
VY_R_FPT_CLOSE.UTL_
     10573**DCL     10573--REDEF
VY_R_FPT_CLOSE.V
     10577**DCL     10572--DCLINIT
VY_R_FPT_CLOSE.V.EXPIRE#
     10587**DCL     10587--REDEF
VY_R_FPT_CLOSE.V.OPER.CHGATT#
     10578**DCL     10762<<ASSIGN  10825<<ASSIGN
VY_R_FPT_CLOSE.V.OPER.RELG#
     10578**DCL     10761<<ASSIGN
VY_R_FPT_CLOSE.V.TYPE#
     10585**DCL     10585--REDEF   10826<<ASSIGN
VY_R_FPT_CLOSE.V.XTNSIZE#
     10582**DCL     10582--REDEF   10584--REDEF
VY_R_KEY_BUF.FORM0
      5223**DCL      5227--REDEF    5233--REDEF
VY_SI_KEY_BUF.KEY
      5731**DCL      5731--REDEF
VY_SPC.B$.MINE
      5726**DCL      5727--REDEF
VY_SPC.B$.NAME
      5723**DCL      5723--REDEF
VY_SPC.B$.SKIP
      5725**DCL      5726--REDEF
VY_SPC.B$.VALUE
PL6.E3A0      #002=VYF$CLOSE File=VYF$OPEN.:E05TSI                               WED 07/30/97 08:54 Page:122  
      5724**DCL      5725--REDEF
VY_SPC.SEG.NAME
      5718**DCL      5719--REDEF
VY_SPC.SEG.VALUE
      5719**DCL      5720--REDEF
VY_TSX0_OVERLAY.H
      5690**DCL      5691--REDEF
